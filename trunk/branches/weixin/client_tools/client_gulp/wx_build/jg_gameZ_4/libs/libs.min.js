var Laya=window.Laya=function(B$L,B$O){var B$r={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(B$O,B$J){return 1==arguments.length?B$r.__presubstr.call(this,B$O):B$r.__presubstr.call(this,B$O,0<B$J?B$J:this.length+B$J)},__init:function(B$O){B$O.forEach(function(B$O){B$O.__init$&&B$O.__init$()})},__isClass:function(B$O){return B$O&&(B$O.__isclass||B$O==Object||B$O==String||B$O==Array)},__newvec:function(B$O,B$J){var B$D=[];B$D.length=B$O;for(var B$p=0;B$p<B$O;B$p++)B$D[B$p]=B$J;return B$D},__extend:function(B$O,B$J){for(var B$D in B$J)if(B$J.hasOwnProperty(B$D)){var B$p=Object.getOwnPropertyDescriptor(B$J,B$D),B$m=B$p.get,B$C=B$p.set;B$m||B$C?B$m&&B$C?Object.defineProperty(B$O,B$D,B$p):(B$m&&Object.defineProperty(B$O,B$D,B$m),B$C&&Object.defineProperty(B$O,B$D,B$C)):B$O[B$D]=B$J[B$D]}function B$i(){B$r.un(this,"constructor",B$O)}B$i.prototype=B$J.prototype,B$O.prototype=new B$i,B$r.un(B$O.prototype,"__imps",B$r.__copy({},B$J.prototype.__imps))},__copy:function(B$O,B$J){if(!B$J)return null;for(var B$D in B$O=B$O||{},B$J)B$O[B$D]=B$J[B$D];return B$O},__package:function(B$O,B$J){if(!B$r.__packages[B$O]){B$r.__packages[B$O]=!0;var B$D=B$L,B$p=B$O.split(".");if(1<B$p.length)for(var B$m=0,B$C=B$p.length-1;B$m<B$C;B$m++){var B$i=B$D[B$p[B$m]];B$D=B$i||(B$D[B$p[B$m]]={})}B$D[B$p[B$p.length-1]]||(B$D[B$p[B$p.length-1]]=B$J||{})}},__hasOwnProperty:function(B$O,B$J){return B$J=B$J||this,Object.hasOwnProperty.call(B$J,B$O)||function B$O(B$J,B$D){if(Object.hasOwnProperty.call(B$D.prototype,B$J))return!0;var B$p=B$D.prototype.__super;return null==B$p?null:B$O(B$J,B$p)}(B$O,B$J.__class)},__typeof:function(B$O,B$J){if(!B$O||!B$J)return!1;if(B$J===String)return"string"==typeof B$O;if(B$J===Number)return"number"==typeof B$O;if(B$J.__interface__)B$J=B$J.__interface__;else if("string"!=typeof B$J)return B$O instanceof B$J;return B$O.__imps&&B$O.__imps[B$J]||B$O.__class==B$J},__as:function(B$O,B$J){return this.__typeof(B$O,B$J)?B$O:null},__int:function(B$O){return B$O?parseInt(B$O):0},interface:function(B$O,B$J){B$r.__package(B$O,{});var B$D=B$r.__internals,B$p=B$D[B$O]=B$D[B$O]||{self:B$O};if(B$J){var B$m=B$J.split(",");B$p.extend=[];for(var B$C=0;B$C<B$m.length;B$C++){var B$i=B$m[B$C];B$D[B$i]=B$D[B$i]||{self:B$i},B$p.extend.push(B$D[B$i])}}var B$k=B$L,B$_=B$O.split(".");for(B$C=0;B$C<B$_.length-1;B$C++)B$k=B$k[B$_[B$C]];B$k[B$_[B$_.length-1]]={__interface__:B$O}},class:function(B$O,B$J,B$D,B$p){if(B$D&&B$r.__extend(B$O,B$D),B$J)if(B$r.__package(B$J,B$O),B$r.__classmap[B$J]=B$O,0<B$J.indexOf(".")){if(0==B$J.indexOf("laya.")){var B$m=B$J.split(".");B$p=B$p||B$m[B$m.length-1],B$r[B$p]&&console.log("Warning!,this class["+B$p+"] already exist:",B$r[B$p]),B$r[B$p]=B$O}}else"Main"==B$J?B$L.Main=B$O:"MainWX"==B$J?B$L.MainWX=B$O:(B$r[B$J]&&console.log("Error!,this class["+B$J+"] already exist:",B$r[B$J]),B$r[B$J]=B$O);var B$C=B$r.un,B$i=B$O.prototype;B$C(B$i,"hasOwnProperty",B$r.__hasOwnProperty),B$C(B$i,"__class",B$O),B$C(B$i,"__super",B$D),B$C(B$i,"__className",B$J),B$C(B$O,"__super",B$D),B$C(B$O,"__className",B$J),B$C(B$O,"__isclass",!0),B$C(B$O,"super",function(B$O){this.__super.call(B$O)})},imps:function(B$O,B$J){if(!B$J)return null;var B$m=B$O.__imps||B$r.un(B$O,"__imps",{});function B$C(B$O){var B$J,B$D;if((B$J=B$r.__internals[B$O])&&(B$m[B$O]=!0,B$D=B$J.extend))for(var B$p=0;B$p<B$D.length;B$p++)B$C(B$D[B$p].self)}for(var B$D in B$J)B$C(B$D)},superSet:function(B$O,B$J,B$D,B$p){var B$m=B$O.prototype["_$set_"+B$D];B$m&&B$m.call(B$J,B$p)},superGet:function(B$O,B$J,B$D){var B$p=B$O.prototype["_$get_"+B$D];return B$p?B$p.call(B$J):null},getset:function(B$O,B$J,B$D,B$p,B$m){B$O?(B$p&&(B$J["_$GET_"+B$D]=B$p),B$m&&(B$J["_$SET_"+B$D]=B$m)):(B$p&&B$r.un(B$J,"_$get_"+B$D,B$p),B$m&&B$r.un(B$J,"_$set_"+B$D,B$m)),B$p&&B$m?Object.defineProperty(B$J,B$D,{get:B$p,set:B$m,enumerable:!1,configurable:!0}):(B$p&&Object.defineProperty(B$J,B$D,{get:B$p,enumerable:!1,configurable:!0}),B$m&&Object.defineProperty(B$J,B$D,{set:B$m,enumerable:!1,configurable:!0}))},static:function(B$D,B$p){for(var B$m=0,B$O=B$p.length;B$m<B$O;B$m+=2)if("length"==B$p[B$m])B$D.length=B$p[B$m+1].call(B$D);else{function B$J(){var B$J=B$p[B$m],B$O=B$p[B$m+1];Object.defineProperty(B$D,B$J,{get:function(){return delete this[B$J],this[B$J]=B$O.call(this)},set:function(B$O){delete this[B$J],this[B$J]=B$O},enumerable:!0,configurable:!0})}B$J()}},un:function(B$O,B$J,B$D){return B$D||(B$D=B$O[B$J]),B$r.__propun.value=B$D,Object.defineProperty(B$O,B$J,B$r.__propun),B$D},uns:function(B$J,B$O){B$O.forEach(function(B$O){B$r.un(B$J,B$O)})}};return B$L.console=B$L.console||{log:function(){}},B$L.trace=B$L.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),B$r}(window,document);!function(B$O,B$J,B$D){B$D.un,B$D.uns,B$D.static,B$D.class,B$D.getset,B$D.__newvec}(window,document,Laya),function(B$i,B$J,B$a){B$a.un,B$a.uns;var B$_=B$a.static,B$r=B$a.class,B$X=B$a.getset;B$a.__newvec;B$a.interface("laya.runtime.IMarket"),B$a.interface("laya.filters.IFilter"),B$a.interface("laya.display.ILayout"),B$a.interface("laya.resource.IDispose"),B$a.interface("laya.runtime.IPlatform"),B$a.interface("laya.resource.IDestroy"),B$a.interface("laya.runtime.IConchNode"),B$a.interface("laya.filters.IFilterAction"),B$a.interface("laya.runtime.ICPlatformClass"),B$a.interface("laya.resource.ICreateResource"),B$a.interface("laya.runtime.IConchRenderObject"),B$a.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var B$P=function(){function B$C(){}return B$r(B$C,"laya.utils.RunDriver"),B$C.FILTER_ACTIONS=[],B$C.pixelRatio=-1,B$C._charSizeTestDiv=null,B$C.now=function(){return Date.now()},B$C.getWindow=function(){return B$i},B$C.getPixelRatio=function(){if(B$C.pixelRatio<0){var B$O=B$l.context,B$J=B$O.backingStorePixelRatio||B$O.webkitBackingStorePixelRatio||B$O.mozBackingStorePixelRatio||B$O.msBackingStorePixelRatio||B$O.oBackingStorePixelRatio||B$O.backingStorePixelRatio||1;(B$C.pixelRatio=(B$l.window.devicePixelRatio||1)/B$J)<1&&(B$C.pixelRatio=1)}return B$C.pixelRatio},B$C.getIncludeStr=function(B$O){return null},B$C.createShaderCondition=function(B$O){var B$J="(function() {return "+B$O+";})";return B$a._runScript(B$J)},B$C.fontMap=[],B$C.measureText=function(B$O,B$J){var B$D=B$C.hanzi.test(B$O);if(B$D&&B$C.fontMap[B$J])return B$C.fontMap[B$J];var B$p=B$l.context;B$p.font=B$J;var B$m=B$p.measureText(B$O);return B$m||(B$m={width:16,height:16}),B$D&&(B$C.fontMap[B$J]=B$m),B$m},B$C.getWebGLContext=function(B$O){},B$C.beginFlush=function(){},B$C.endFinish=function(){},B$C.addToAtlas=null,B$C.flashFlushImage=function(B$O){},B$C.drawToCanvas=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$AO.create("2D"),B$k=new B$F(B$D,B$p,B$i);return B$R.renders[B$J]._fun(B$O,B$k,B$m,B$C),B$i},B$C.createParticleTemplate2D=null,B$C.createGLTextur=null,B$C.createWebGLContext2D=null,B$C.changeWebGLSize=function(B$O,B$J){},B$C.createRenderSprite=function(B$O,B$J){return new B$R(B$O,B$J)},B$C.createFilterAction=function(B$O){return new B$A},B$C.createGraphics=function(){return new B$Y},B$C.clear=function(B$O){B$N._context.ctx.clear()},B$C.cancelLoadByUrl=function(B$O){},B$C.clearAtlas=function(B$O){},B$C.isAtlas=function(B$O){return!1},B$C.addTextureToAtlas=function(B$O){},B$C.getTexturePixels=function(B$O,B$J,B$D,B$p,B$m){return null},B$C.skinAniSprite=function(){return null},B$C.update3DLoop=function(){},B$_(B$C,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),B$C}(),B$p=(B$X(1,B$a,"alertGlobalError",null,function(B$O){var B$C=0;B$l.window.onerror=B$O?function(B$O,B$J,B$D,B$p,B$m){B$C++<5&&B$m&&alert(B$m.stack||B$m)}:null}),B$a.init=function(B$O,B$J,B$D){for(var B$p=[],B$m=2,B$C=arguments.length;B$m<B$C;B$m++)B$p.push(arguments[B$m]);if(!B$a._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=B$a._arrayBufferSlice),B$a._isinit=!0,B$l.__init__(),B$j.__init__(),B$Y.__init__(),B$a.timer=new B$B,B$a.scaleTimer=new B$B,B$a.loader=new B$_O,B$K.__init__(),B$m=0;for(var B$i=B$p.length;B$m<B$i;B$m++)B$p[B$m].enable&&B$p[B$m].enable();return B$G.__init__(),B$k.__init__(),B$u.__init__(),B$x.beginCheck(),B$a._currentStage=B$a.stage=new B$yO,B$a.stage.conchModel&&B$a.stage.conchModel.setRootNode(),B$a._getUrlPath(),B$a.render=new B$N(0,0),B$a.stage.size(B$O,B$J),B$R.__init__(),B$H.__init__(),B$c.instance.__init__(B$a.stage,B$N.canvas),B$dO.__init__(),B$s.autoStopMusic=!0,B$z.__init__(),B$N.canvas}},B$a._getUrlPath=function(){var B$O=B$l.window.location,B$J=B$O.pathname;B$J=B$J&&":"==B$J.charAt(2)?B$J.substring(1):B$J,B$W.rootPath=B$W.basePath=B$W.getPath("file:"==B$O.protocol?B$J:B$O.protocol+"//"+B$O.host+B$O.pathname)},B$a._arrayBufferSlice=function(B$O,B$J){var B$D=new Uint8Array(this,B$O,B$J-B$O),B$p=new Uint8Array(B$D.length);return B$p.set(B$D),B$p.buffer},B$a._runScript=function(B$O){return B$l.window[B$a._evcode](B$O)},B$a.stage=null,B$a.timer=null,B$a.scaleTimer=null,B$a.loader=null,B$a.version="1.8.6",B$a.render=null,B$a._currentStage=null,B$a._isinit=!1,B$a.isDebug=!1,B$a.MiniAdpter={init:function(){B$i.navigator&&B$i.navigator.userAgent&&-1<B$i.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},B$_(B$a,["conchMarket",function(){return this.conchMarket=B$i.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=B$i.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function B$O(){}return B$r(B$O,"Config"),B$O.WebGLTextCacheCount=500,B$O.atlasEnable=!1,B$O.showCanvasMark=!1,B$O.animationInterval=50,B$O.isAntialias=!1,B$O.isAlpha=!1,B$O.premultipliedAlpha=!0,B$O.isStencil=!0,B$O.preserveDrawingBuffer=!1,B$O}()),B$L=function(){function B$L(){this._events=null}B$r(B$L,"laya.events.EventDispatcher");var B$O=B$L.prototype;return B$O.hasListener=function(B$O){return!!(this._events&&this._events[B$O])},B$O.event=function(B$O,B$J){if(!this._events||!this._events[B$O])return!1;var B$D=this._events[B$O];if(B$D.lock)B$D.queue||(B$D.queue=[]),B$D.queue.push(B$J);else{var B$p;for(B$D.lock=!0,B$D.cursor=B$D.head;B$D.cursor;)B$p=B$D.cursor,B$D.cursor=B$p.next,B$p.once&&B$L.delNode(B$D,B$p),null!=B$J?B$p.args?B$p.method.apply(B$p.caller,B$p.args.concat(B$J)):B$J instanceof Array?B$p.method.apply(B$p.caller,B$J):B$p.method.call(B$p.caller,B$J):B$p.method.apply(B$p.caller,B$p.args),B$p.once&&B$L.recoverHandler(B$p);B$D.lock=!1,!B$D.head&&this._events&&this._events[B$O]==B$D&&delete this._events[B$O],B$D.queue&&B$D.queue.length&&this.event(B$O,B$D.queue.shift())}return!0},B$O.on=function(B$O,B$J,B$D,B$p){return this._createListener(B$O,B$J,B$D,B$p,!1)},B$O.once=function(B$O,B$J,B$D,B$p){return this._createListener(B$O,B$J,B$D,B$p,!0)},B$O._createListener=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=!0),B$C&&this.off(B$O,B$J,B$D,B$m);var B$i=B$L.createHandler(B$J||this,B$D,B$p,B$m);this._events||(this._events={});var B$k=this._events,B$_=B$k[B$O];return B$_?B$_.tail?(B$i.prev=B$_.tail,B$_.tail.next=B$i,B$_.tail=B$i):B$_.head=B$_.tail=B$i:B$k[B$O]={head:B$i,tail:B$i,cursor:null,lock:!1},this},B$O.off=function(B$O,B$J,B$D,B$p){if(void 0===B$p&&(B$p=!1),!this._events||!this._events[B$O])return this;for(var B$m=this._events[B$O],B$C=B$m.head;B$C;){if((!B$J||B$C.caller===B$J)&&B$C.method===B$D&&(!B$p||B$C.once)){B$L.delNode(B$m,B$C),B$m.cursor==B$C&&(B$m.cursor=B$C.next),B$L.recoverHandler(B$C);break}B$C=B$C.next}return B$m.head||delete this._events[B$O],this},B$O.offAll=function(B$O){var B$J=this._events;if(!B$J)return this;if(B$O)this._recoverHandlers(B$J[B$O]),delete B$J[B$O];else{for(var B$D in B$J)this._recoverHandlers(B$J[B$D]);this._events=null}return this},B$O._recoverHandlers=function(B$O){if(B$O){for(var B$J=B$O.head;B$J;){B$L.delNode(B$O,B$J);var B$D=B$J.next;B$L.recoverHandler(B$J),B$J=B$D}B$O.cursor=null}},B$O.isMouseEvent=function(B$O){return B$L.MOUSE_EVENTS[B$O]},B$L.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},B$L.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},B$L.delNode=function(B$O,B$J){B$J.prev?B$J.prev.next=B$J.next:B$O.head=B$J.next,B$J.next?B$J.next.prev=B$J.prev:B$O.tail=B$J.prev},B$L.createHandler=function(B$O,B$J,B$D,B$p){var B$m=B$L._freeHandler;return B$m?(B$L._freeCount--,B$L._freeHandler=B$m.next,B$m.caller=B$O,B$m.method=B$J,B$m.args=B$D,B$m.once=B$p):B$m={caller:B$O,method:B$J,args:B$D,once:B$p},B$m.prev=B$m.next=null,B$m},B$L.recoverHandler=function(B$O){B$O.caller=B$O.method=B$O.args=B$O.prev=null,B$O.next=B$L._freeHandler,B$L._freeHandler=B$O,B$L._freeCount++},B$L._freeHandler=null,B$L._freeCount=0,B$L}(),B$v=function(){function B$m(B$O,B$J,B$D,B$p){this.once=!1,void(this._id=0)===B$p&&(B$p=!1),this.setTo(B$O,B$J,B$D,B$p)}B$r(B$m,"laya.utils.Handler");var B$O=B$m.prototype;return B$O.setTo=function(B$O,B$J,B$D,B$p){return this._id=B$m._gid++,this.caller=B$O,this.method=B$J,this.args=B$D,this.once=B$p,this},B$O.run=function(){if(null==this.method)return null;var B$O=this._id,B$J=this.method.apply(this.caller,this.args);return this._id===B$O&&this.once&&this.recover(),B$J},B$O.runWith=function(B$O){if(null==this.method)return null;var B$J=this._id;if(null==B$O)var B$D=this.method.apply(this.caller,this.args);else B$D=this.args||B$O.unshift?this.args?this.method.apply(this.caller,this.args.concat(B$O)):this.method.apply(this.caller,B$O):this.method.call(this.caller,B$O);return this._id===B$J&&this.once&&this.recover(),B$D},B$O.clear=function(){return this.caller=null,this.method=null,this.args=null,this},B$O.recover=function(){0<this._id&&(this._id=0,this.clear())},B$m.create=function(B$O,B$J,B$D,B$p){return void 0===B$p&&(B$p=!0),new B$m(B$O,B$J,B$D,B$p)},B$m._gid=1,B$m}(),B$g=function(){function B$O(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}B$r(B$O,"laya.display.BitmapFont");var B$J=B$O.prototype;return B$J.loadFont=function(B$O,B$J){this._path=B$O,this._complete=B$J,B$a.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],B$v.create(this,this.onLoaded))},B$J.onLoaded=function(){this.parseFont(B$kO.getRes(this._path),B$kO.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},B$J.parseFont=function(B$O,B$J){if(null!=B$O&&null!=B$J){this._texture=B$J;var B$D=B$O.getElementsByTagName("info");if(!B$D[0].getAttributeNode)return this.parseFont2(B$O,B$J);this.fontSize=parseInt(B$D[0].getAttributeNode("size").nodeValue);var B$p,B$m=B$D[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(B$m[0]),parseInt(B$m[1]),parseInt(B$m[2]),parseInt(B$m[3])],B$p=B$O.getElementsByTagName("char");var B$C=0;for(B$C=0;B$C<B$p.length;B$C++){var B$i=B$p[B$C],B$k=parseInt(B$i.getAttributeNode("id").nodeValue),B$_=parseInt(B$i.getAttributeNode("xoffset").nodeValue)/1,B$L=parseInt(B$i.getAttributeNode("yoffset").nodeValue)/1,B$r=parseInt(B$i.getAttributeNode("xadvance").nodeValue)/1,B$H=new B$t;B$H.x=parseInt(B$i.getAttributeNode("x").nodeValue),B$H.y=parseInt(B$i.getAttributeNode("y").nodeValue),B$H.width=parseInt(B$i.getAttributeNode("width").nodeValue),B$H.height=parseInt(B$i.getAttributeNode("height").nodeValue);var B$Y=B$rO.create(B$J,B$H.x,B$H.y,B$H.width,B$H.height,B$_,B$L);this._maxWidth=Math.max(this._maxWidth,B$r+this.letterSpacing),this._fontCharDic[B$k]=B$Y,this._fontWidthMap[B$k]=B$r}}},B$J.parseFont2=function(B$O,B$J){if(null!=B$O&&null!=B$J){this._texture=B$J;var B$D=B$O.getElementsByTagName("info");this.fontSize=parseInt(B$D[0].attributes.size.nodeValue);var B$p=B$D[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(B$p[0]),parseInt(B$p[1]),parseInt(B$p[2]),parseInt(B$p[3])];var B$m=B$O.getElementsByTagName("char"),B$C=0;for(B$C=0;B$C<B$m.length;B$C++){var B$i=B$m[B$C].attributes,B$k=parseInt(B$i.id.nodeValue),B$_=parseInt(B$i.xoffset.nodeValue)/1,B$L=parseInt(B$i.yoffset.nodeValue)/1,B$r=parseInt(B$i.xadvance.nodeValue)/1,B$H=new B$t;B$H.x=parseInt(B$i.x.nodeValue),B$H.y=parseInt(B$i.y.nodeValue),B$H.width=parseInt(B$i.width.nodeValue),B$H.height=parseInt(B$i.height.nodeValue);var B$Y=B$rO.create(B$J,B$H.x,B$H.y,B$H.width,B$H.height,B$_,B$L);this._maxWidth=Math.max(this._maxWidth,B$r+this.letterSpacing),this._fontCharDic[B$k]=B$Y,this._fontWidthMap[B$k]=B$r}}},B$J.getCharTexture=function(B$O){return this._fontCharDic[B$O.charCodeAt(0)]},B$J.destroy=function(){if(this._texture){for(var B$O in this._fontCharDic){var B$J=this._fontCharDic[B$O];B$J&&B$J.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},B$J.setSpaceWidth=function(B$O){this._spaceWidth=B$O},B$J.getCharWidth=function(B$O){var B$J=B$O.charCodeAt(0);return this._fontWidthMap[B$J]?this._fontWidthMap[B$J]+this.letterSpacing:" "==B$O?this._spaceWidth+this.letterSpacing:0},B$J.getTextWidth=function(B$O){for(var B$J=0,B$D=0,B$p=B$O.length;B$D<B$p;B$D++)B$J+=this.getCharWidth(B$O.charAt(B$D));return B$J},B$J.getMaxWidth=function(){return this._maxWidth},B$J.getMaxHeight=function(){return this.fontSize},B$J.drawText=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k=this.getTextWidth(B$O),B$_=0;"center"===B$m&&(B$_=(B$C-B$k)/2),"right"===B$m&&(B$_=B$C-B$k);for(var B$L=0,B$r=0,B$H=B$O.length;B$r<B$H;B$r++)(B$i=this.getCharTexture(B$O.charAt(B$r)))&&(B$J.graphics.drawTexture(B$i,B$D+B$L+B$_,B$p),B$L+=this.getCharWidth(B$O.charAt(B$r)))},B$O}(),B$k=function(){function B$D(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=B$D._TF_EMPTY}B$r(B$D,"laya.display.css.Style");var B$O=B$D.prototype;return B$O.getTransform=function(){return this._tf},B$O.setTransform=function(B$O){this._tf="none"!==B$O&&B$O?B$O:B$D._TF_EMPTY},B$O.setTranslateX=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.translateX=B$O},B$O.setTranslateY=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.translateY=B$O},B$O.setScaleX=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.scaleX=B$O},B$O.setScale=function(B$O,B$J){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.scaleX=B$O,this._tf.scaleY=B$J},B$O.setScaleY=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.scaleY=B$O},B$O.setRotate=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.rotate=B$O},B$O.setSkewX=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.skewX=B$O},B$O.setSkewY=function(B$O){this._tf===B$D._TF_EMPTY&&(this._tf=new B$m),this._tf.skewY=B$O},B$O.destroy=function(){this.scrollRect=null},B$O.render=function(B$O,B$J,B$D,B$p){},B$O.getCSSStyle=function(){return B$JO.EMPTY},B$O._enableLayout=function(){return!1},B$X(0,B$O,"scaleX",function(){return this._tf.scaleX},function(B$O){this.setScaleX(B$O)}),B$X(0,B$O,"transform",function(){return this.getTransform()},function(B$O){this.setTransform(B$O)}),B$X(0,B$O,"translateX",function(){return this._tf.translateX},function(B$O){this.setTranslateX(B$O)}),B$X(0,B$O,"translateY",function(){return this._tf.translateY},function(B$O){this.setTranslateY(B$O)}),B$X(0,B$O,"scaleY",function(){return this._tf.scaleY},function(B$O){this.setScaleY(B$O)}),B$X(0,B$O,"block",function(){return 0!=(1&this._type)}),B$X(0,B$O,"skewY",function(){return this._tf.skewY},function(B$O){this.setSkewY(B$O)}),B$X(0,B$O,"rotate",function(){return this._tf.rotate},function(B$O){this.setRotate(B$O)}),B$X(0,B$O,"skewX",function(){return this._tf.skewX},function(B$O){this.setSkewX(B$O)}),B$X(0,B$O,"paddingLeft",function(){return 0}),B$X(0,B$O,"paddingTop",function(){return 0}),B$X(0,B$O,"absolute",function(){return!0}),B$D.__init__=function(){B$D._TF_EMPTY=new B$m,B$D.EMPTY=new B$D},B$D.EMPTY=null,B$D._TF_EMPTY=null,B$D}(),B$G=function(){function B$J(B$O){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=B$T.create(B$J.defaultColor),this.family=B$J.defaultFamily,this.stroke=B$J._STROKE,this.size=B$J.defaultSize,B$O&&B$O!==B$J.EMPTY&&B$O.copyTo(this)}B$r(B$J,"laya.display.css.Font");var B$O=B$J.prototype;return B$O.set=function(B$O){this._text=null;for(var B$J=B$O.split(" "),B$D=0,B$p=B$J.length;B$D<B$p;B$D++){var B$m=B$J[B$D];switch(B$m){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<B$m.indexOf("px")&&(this.size=parseInt(B$m),this.family=B$J[B$D+1],B$D++)}},B$O.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},B$O.copyTo=function(B$O){B$O._type=this._type,B$O._text=this._text,B$O._weight=this._weight,B$O._color=this._color,B$O.family=this.family,B$O.stroke=this.stroke!=B$J._STROKE?this.stroke.slice():B$J._STROKE,B$O.indent=this.indent,B$O.size=this.size},B$X(0,B$O,"password",function(){return 0!=(1024&this._type)},function(B$O){B$O?this._type|=1024:this._type&=-1025}),B$X(0,B$O,"color",function(){return this._color.strColor},function(B$O){this._color=B$T.create(B$O)}),B$X(0,B$O,"italic",function(){return 0!=(512&this._type)},function(B$O){B$O?this._type|=512:this._type&=-513}),B$X(0,B$O,"bold",function(){return 0!=(2048&this._type)},function(B$O){B$O?this._type|=2048:this._type&=-2049}),B$X(0,B$O,"weight",function(){return""+this._weight},function(B$O){var B$J=0;switch(B$O){case"normal":break;case"bold":this.bold=!0,B$J=700;break;case"bolder":B$J=800;break;case"lighter":B$J=100;break;default:B$J=parseInt(B$O)}this._weight=B$J,this._text=null}),B$X(0,B$O,"decoration",function(){return this._decoration?this._decoration.value:null},function(B$O){var B$J=B$O.split(" ");switch(this._decoration||(this._decoration={}),B$J[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=B$J[0]}B$J[1]&&(this._decoration.color=B$T.create(B$J)),this._decoration.value=B$O}),B$J.__init__=function(){B$J.EMPTY=new B$J(null)},B$J.EMPTY=null,B$J.defaultColor="#000000",B$J.defaultSize=12,B$J.defaultFamily="Arial",B$J.defaultFont="12px Arial",B$J._STROKE=[0,"#000000"],B$J._ITALIC=512,B$J._PASSWORD=1024,B$J._BOLD=2048,B$J}(),B$m=function(){function B$O(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return B$r(B$O,"laya.display.css.TransformInfo"),B$O}(),B$Y=function(){function B$H(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,B$N.isConchNode){this._nativeObj=new B$i._conchGraphics,this.id=this._nativeObj.conchID}}B$r(B$H,"laya.display.Graphics");var B$O=B$H.prototype;return B$O.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},B$O.clear=function(B$O){void 0===B$O&&(B$O=!1);var B$J=0,B$D=0;if(B$O){var B$p=this._one;if(this._cmds){for(B$D=this._cmds.length,B$J=0;B$J<B$D;B$J++)!(B$p=this._cmds[B$J])||B$p.callee!==B$N._context._drawTexture&&B$p.callee!==B$N._context._drawTextureWithTransform||(B$p[0]=null,B$H._cache.push(B$p));this._cmds.length=0}else B$p&&(!B$p||B$p.callee!==B$N._context._drawTexture&&B$p.callee!==B$N._context._drawTextureWithTransform||(B$p[0]=null,B$H._cache.push(B$p)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(B$J=0,B$D=this._vectorgraphArray.length;B$J<B$D;B$J++)B$b.getInstance().deleteShape(this._vectorgraphArray[B$J]);this._vectorgraphArray.length=0}},B$O._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},B$O._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new B$D,this._graphicBounds._graphics=this)},B$O._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},B$O._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},B$O.getBounds=function(B$O){return void 0===B$O&&(B$O=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(B$O)},B$O.getBoundPoints=function(B$O){return void 0===B$O&&(B$O=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(B$O)},B$O._addCmd=function(B$O){this._cmds=this._cmds||[],B$O.callee=B$O.shift(),this._cmds.push(B$O)},B$O.setFilters=function(B$O){this._saveToCmd(B$N._context._setFilters,B$O)},B$O.drawTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$i&&(B$i=1),!B$O||B$i<.01)return null;B$p||(B$p=B$O.sourceWidth),B$m||(B$m=B$O.sourceHeight),B$i=B$i<0?0:1<B$i?1:B$i;var B$k,B$_=!B$N.isWebGL&&(B$l.onFirefox||B$l.onEdge||B$l.onIE||B$l.onSafari)?.5:0,B$L=B$p/B$O.sourceWidth,B$r=B$m/B$O.sourceHeight;return B$p=B$O.width*B$L,B$m=B$O.height*B$r,B$O.loaded&&(B$p<=0||B$m<=0)?null:(B$J+=B$O.offsetX*B$L,B$D+=B$O.offsetY*B$r,this._sp&&(this._sp._renderType|=512),B$J-=B$_,B$D-=B$_,B$p+=2*B$_,B$m+=2*B$_,B$H._cache.length?((B$k=B$H._cache.pop())[0]=B$O,B$k[1]=B$J,B$k[2]=B$D,B$k[3]=B$p,B$k[4]=B$m,B$k[5]=B$C,B$k[6]=B$i):B$k=[B$O,B$J,B$D,B$p,B$m,B$C,B$i],B$k.callee=B$C||1!=B$i?B$N._context._drawTextureWithTransform:B$N._context._drawTexture,null!=this._one||B$C||1!=B$i?this._saveToCmd(B$k.callee,B$k):(this._one=B$k,this._render=this._renderOneImg),B$O.loaded||B$O.once("loaded",this,this._textureLoaded,[B$O,B$k]),this._repaint(),B$k)},B$O.cleanByTexture=function(B$O,B$J,B$D,B$p,B$m){if(void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),!B$O)return this.clear();if(this._one&&this._render===this._renderOneImg){B$p||(B$p=B$O.sourceWidth),B$m||(B$m=B$O.sourceHeight);var B$C=B$p/B$O.sourceWidth,B$i=B$m/B$O.sourceHeight;B$p=B$O.width*B$C,B$m=B$O.height*B$i,B$J+=B$O.offsetX*B$C,B$D+=B$O.offsetY*B$i,this._one[0]=B$O,this._one[1]=B$J,this._one[2]=B$D,this._one[3]=B$p,this._one[4]=B$m,this._repaint()}else this.clear(),B$O&&this.drawTexture(B$O,B$J,B$D,B$p,B$m)},B$O.drawTextures=function(B$O,B$J){B$O&&this._saveToCmd(B$N._context._drawTextures,[B$O,B$J])},B$O.fillTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C="repeat"),B$O){var B$k=[B$O,B$J,B$D,B$p,B$m,B$C,B$i||B$e.EMPTY,{}];B$O.loaded||B$O.once("loaded",this,this._textureLoaded,[B$O,B$k]),this._saveToCmd(B$N._context._fillTexture,B$k)}},B$O._textureLoaded=function(B$O,B$J){B$J[3]=B$J[3]||B$O.width,B$J[4]=B$J[4]||B$O.height,this._repaint()},B$O.fillCircle=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$D.bitmap.enableMerageInAtlas=!1;var B$k=new Float32Array(2*(B$i+1)),B$_=new Float32Array(2*(B$i+1)),B$L=new Uint16Array(3*B$i),B$r=2*Math.PI/B$i,B$H=0;B$k[0]=B$p,B$k[1]=B$m,B$_[0]=B$p/B$D.width,B$_[1]=B$m/B$D.height;for(var B$Y=2,B$G=0;B$G<B$i;B$G++){var B$X=B$C*Math.cos(B$H)+B$p,B$c=B$C*Math.sin(B$H)+B$m;B$k[B$Y]=B$X,B$k[B$Y+1]=B$c,B$_[B$Y]=B$X/B$D.width,B$_[B$Y+1]=B$c/B$D.height,B$H+=B$r,B$Y+=2}for(B$G=B$Y=0;B$G<B$i;B$G++)B$L[B$Y++]=0,B$L[B$Y++]=B$G+1,B$L[B$Y++]=B$i+1<=B$G+2?1:B$G+2;this.drawTriangles(B$D,B$O,B$J,B$k,B$_,B$L)},B$O.drawTriangles=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){void 0===B$k&&(B$k=1),this._saveToCmd(B$N._context.drawTriangles,[B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L])},B$O._saveToCmd=function(B$O,B$J){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=B$J,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(B$J)),B$J.callee=B$O,this._repaint(),B$J},B$O.clipRect=function(B$O,B$J,B$D,B$p){this._saveToCmd(B$N._context._clipRect,[B$O,B$J,B$D,B$p])},B$O.fillText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){void 0===B$i&&(B$i=0),this._saveToCmd(B$N._context._fillText,[B$O,B$J,B$D,B$p||B$G.defaultFont,B$m,B$C])},B$O.fillBorderText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){this._saveToCmd(B$N._context._fillBorderText,[B$O,B$J,B$D,B$p||B$G.defaultFont,B$m,B$C,B$i,B$k])},B$O.strokeText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._saveToCmd(B$N._context._strokeText,[B$O,B$J,B$D,B$p||B$G.defaultFont,B$m,B$C,B$i])},B$O.alpha=function(B$O){B$O=B$O<0?0:1<B$O?1:B$O,this._saveToCmd(B$N._context._alpha,[B$O])},B$O.setAlpha=function(B$O){B$O=B$O<0?0:1<B$O?1:B$O,this._saveToCmd(B$N._context._setAlpha,[B$O])},B$O.transform=function(B$O,B$J,B$D){void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),this._saveToCmd(B$N._context._transform,[B$O,B$J,B$D])},B$O.rotate=function(B$O,B$J,B$D){void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),this._saveToCmd(B$N._context._rotate,[B$O,B$J,B$D])},B$O.scale=function(B$O,B$J,B$D,B$p){void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),this._saveToCmd(B$N._context._scale,[B$O,B$J,B$D,B$p])},B$O.translate=function(B$O,B$J){this._saveToCmd(B$N._context._translate,[B$O,B$J])},B$O.save=function(){this._saveToCmd(B$N._context._save,[])},B$O.restore=function(){this._saveToCmd(B$N._context._restore,[])},B$O.replaceText=function(B$O){this._repaint();var B$J=this._cmds;if(B$J){for(var B$D=B$J.length-1;-1<B$D;B$D--)if(this._isTextCmd(B$J[B$D].callee))return B$J[B$D][0].toUpperCase?B$J[B$D][0]=B$O:B$J[B$D][0].setText(B$O),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=B$O:this._one[0].setText(B$O),!0;return!1},B$O._isTextCmd=function(B$O){return B$O===B$N._context._fillText||B$O===B$N._context._fillBorderText||B$O===B$N._context._strokeText},B$O.replaceTextColor=function(B$O){this._repaint();var B$J=this._cmds;if(B$J)for(var B$D=B$J.length-1;-1<B$D;B$D--)this._isTextCmd(B$J[B$D].callee)&&(B$J[B$D][4]=B$O,B$J[B$D][0].toUpperCase||(B$J[B$D][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=B$O,this._one[0].toUpperCase||(this._one[0].changed=!0))},B$O.loadImage=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=this;void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0);var B$k=B$kO.getRes(B$O);function B$_(B$O){B$O&&(B$i.drawTexture(B$O,B$J,B$D,B$p,B$m),null!=B$C&&B$C.call(B$i._sp,B$O))}B$k?B$_(B$k):B$a.loader.load(B$O,B$v.create(null,B$_),null,"image")},B$O._renderEmpty=function(B$O,B$J,B$D,B$p){},B$O._renderAll=function(B$O,B$J,B$D,B$p){for(var B$m,B$C=this._cmds,B$i=0,B$k=B$C.length;B$i<B$k;B$i++)(B$m=B$C[B$i]).callee.call(B$J,B$D,B$p,B$m)},B$O._renderOne=function(B$O,B$J,B$D,B$p){this._one.callee.call(B$J,B$D,B$p,this._one)},B$O._renderOneImg=function(B$O,B$J,B$D,B$p){this._one.callee.call(B$J,B$D,B$p,this._one),2305!==B$O._renderType&&(B$O._renderType|=1)},B$O.drawLine=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=1);var B$i=0;B$N.isWebGL&&(B$i=B$b.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(B$i));var B$k=B$C%2==0?0:.5,B$_=[B$O+B$k,B$J+B$k,B$D+B$k,B$p+B$k,B$m,B$C,B$i];this._saveToCmd(B$N._context._drawLine,B$_)},B$O.drawLines=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=1);var B$C=0;if(B$D&&!(B$D.length<4)){B$N.isWebGL&&(B$C=B$b.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(B$C));var B$i=B$m%2==0?0:.5,B$k=[B$O+B$i,B$J+B$i,B$D,B$p,B$m,B$C];this._saveToCmd(B$N._context._drawLines,B$k)}},B$O.drawCurves=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=1);var B$C=[B$O,B$J,B$D,B$p,B$m];this._saveToCmd(B$N._context._drawCurves,B$C)},B$O.drawRect=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){void 0===B$i&&(B$i=1);var B$k=B$C?B$i/2:0,B$_=B$C?B$i:0,B$L=[B$O+B$k,B$J+B$k,B$D-B$_,B$p-B$_,B$m,B$C,B$i];this._saveToCmd(B$N._context._drawRect,B$L)},B$O.drawCircle=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=1);var B$i=B$m?B$C/2:0,B$k=0;B$N.isWebGL&&(B$k=B$b.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(B$k));var B$_=[B$O,B$J,B$D-B$i,B$p,B$m,B$C,B$k];this._saveToCmd(B$N._context._drawCircle,B$_)},B$O.drawPie=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){void 0===B$k&&(B$k=1);var B$_=B$i?B$k/2:0,B$L=B$i?B$k:0,B$r=0;B$N.isWebGL&&(B$r=B$b.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(B$r));var B$H=[B$O+B$_,B$J+B$_,B$D-B$L,B$p,B$m,B$C,B$i,B$k,B$r];B$H[3]=B$Q.toRadian(B$p),B$H[4]=B$Q.toRadian(B$m),this._saveToCmd(B$N._context._drawPie,B$H)},B$O.drawPoly=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=1);var B$i=0,B$k=!1;B$N.isWebGL&&(B$i=B$b.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(B$i),B$k=!(6<B$D.length));var B$_=B$m?B$C%2==0?0:.5:0,B$L=[B$O+B$_,B$J+B$_,B$D,B$p,B$m,B$C,B$i,B$k];this._saveToCmd(B$N._context._drawPoly,B$L)},B$O.drawPath=function(B$O,B$J,B$D,B$p,B$m){var B$C=[B$O,B$J,B$D,B$p,B$m];this._saveToCmd(B$N._context._drawPath,B$C)},B$X(0,B$O,"cmds",function(){return this._cmds},function(B$O){this._sp&&(this._sp._renderType|=512),this._cmds=B$O,this._render=this._renderAll,this._repaint()}),B$H.__init__=function(){if(B$N.isConchNode){for(var B$O=laya.display.Graphics.prototype,B$J=B$l.window.ConchGraphics.prototype,B$D=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],B$p=0,B$m=B$D.length;B$p<=B$m;B$p++){var B$C=B$D[B$p];B$O[B$C]=B$J[B$C]}B$O._saveToCmd=null,B$J.drawImageS&&(B$O.drawTextures=function(B$O,B$J){if(B$O&&B$O.loaded&&B$O.bitmap&&B$O.source){var B$D=B$O.uv,B$p=B$O.bitmap.width,B$m=B$O.bitmap.height;this.drawImageS(B$O.bitmap.source,B$D[0]*B$p,B$D[1]*B$m,(B$D[2]-B$D[0])*B$p,(B$D[5]-B$D[3])*B$m,B$O.offsetX,B$O.offsetY,B$O.width,B$O.height,B$J)}}),B$O.drawTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$i&&(B$i=1),B$O)if(B$O.loaded){if(B$O.loaded&&B$O.bitmap&&B$O.source&&(B$p||(B$p=B$O.sourceWidth),B$m||(B$m=B$O.sourceHeight),B$i=B$i<0?0:1<B$i?1:B$i,B$p=B$p-B$O.sourceWidth+B$O.width,B$m=B$m-B$O.sourceHeight+B$O.height,!(B$p<=0||B$m<=0))){B$J+=B$O.offsetX,B$D+=B$O.offsetY;var B$k=B$O.uv,B$_=B$O.bitmap.width,B$L=B$O.bitmap.height;B$k[4]<B$k[0]&&B$k[5]<B$k[1]?this.drawImageM(B$O.bitmap.source,B$k[4]*B$_,B$k[5]*B$L,(B$k[0]-B$k[4])*B$_,(B$k[1]-B$k[5])*B$L,B$J,B$D,B$p,B$m,B$C,B$i):this.drawImageM(B$O.bitmap.source,B$k[0]*B$_,B$k[1]*B$L,(B$k[2]-B$k[0])*B$_,(B$k[5]-B$k[3])*B$L,B$J,B$D,B$p,B$m,B$C,B$i),this._repaint()}}else B$O.once("loaded",this,function(){this.drawTexture(B$O,B$J,B$D,B$p,B$m,B$C)})},B$O.fillTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C="repeat"),B$O&&B$O.loaded){var B$k,B$_=B$N._context.ctx,B$L=B$O.bitmap.width,B$r=B$O.bitmap.height,B$H=B$O.uv;B$k=B$O.uv!=B$rO.DEF_UV?B$_.createPattern(B$O.bitmap.source,B$C,B$H[0]*B$L,B$H[1]*B$r,(B$H[2]-B$H[0])*B$L,(B$H[5]-B$H[3])*B$r):B$_.createPattern(B$O.bitmap.source,B$C);var B$Y=0,B$G=0;B$i&&(B$J+=B$i.x%B$O.width,B$D+=B$i.y%B$O.height,B$Y-=B$i.x%B$O.width,B$G-=B$i.y%B$O.height),this._fillImage(B$k,B$J,B$D,B$Y,B$G,B$p,B$m)}}}},B$H._cache=[],B$H}(),B$D=function(){function B$A(){this._cacheBoundsType=!1}B$r(B$A,"laya.display.GraphicsBounds");var B$O=B$A.prototype;return B$O.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},B$O.reset=function(){this._temp&&(this._temp.length=0)},B$O.getBounds=function(B$O){return void 0===B$O&&(B$O=!1),(!this._bounds||!this._temp||this._temp.length<1||B$O!=this._cacheBoundsType)&&(this._bounds=B$t._getWrapRec(this.getBoundPoints(B$O),this._bounds)),this._cacheBoundsType=B$O,this._bounds},B$O.getBoundPoints=function(B$O){return void 0===B$O&&(B$O=!1),(!this._temp||this._temp.length<1||B$O!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(B$O)),this._cacheBoundsType=B$O,this._rstBoundPoints=B$Q.copyArray(this._rstBoundPoints,this._temp)},B$O._getCmdPoints=function(B$O){void 0===B$O&&(B$O=!1);var B$J,B$D,B$p=B$N._context,B$m=this._graphics.cmds;if((B$J=this._temp||(this._temp=[])).length=0,B$m||null==this._graphics._one||(B$A._tempCmds.length=0,B$A._tempCmds.push(this._graphics._one),B$m=B$A._tempCmds),!B$m)return B$J;(B$D=B$A._tempMatrixArrays).length=0;var B$C=B$A._initMatrix;B$C.identity();for(var B$i,B$k,B$_=B$A._tempMatrix,B$L=NaN,B$r=NaN,B$H=NaN,B$Y=NaN,B$G=NaN,B$X=NaN,B$c=0,B$h=B$m.length;B$c<B$h;B$c++)if((B$i=B$m[B$c]).callee)switch(B$i.callee){case B$p._save:case 7:B$D.push(B$C),B$C=B$C.clone();break;case B$p._restore:case 8:B$C=B$D.pop();break;case B$p._scale:case 5:B$_.identity(),B$_.translate(-B$i[2],-B$i[3]),B$_.scale(B$i[0],B$i[1]),B$_.translate(B$i[2],B$i[3]),this._switchMatrix(B$C,B$_);break;case B$p._rotate:case 3:B$_.identity(),B$_.translate(-B$i[1],-B$i[2]),B$_.rotate(B$i[0]),B$_.translate(B$i[1],B$i[2]),this._switchMatrix(B$C,B$_);break;case B$p._translate:case 6:B$_.identity(),B$_.translate(B$i[0],B$i[1]),this._switchMatrix(B$C,B$_);break;case B$p._transform:case 4:B$_.identity(),B$_.translate(-B$i[1],-B$i[2]),B$_.concat(B$i[0]),B$_.translate(B$i[1],B$i[2]),this._switchMatrix(B$C,B$_);break;case 16:case 24:B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[0],B$i[1],B$i[2],B$i[3]),B$C);break;case 17:B$C.copyTo(B$_),B$_.concat(B$i[4]),B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[0],B$i[1],B$i[2],B$i[3]),B$_);break;case B$p._drawTexture:B$k=B$i[0],B$O?B$i[3]&&B$i[4]?B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$i[3],B$i[4]),B$C):(B$k=B$i[0],B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$k.width,B$k.height),B$C)):(B$L=(B$i[3]||B$k.sourceWidth)/B$k.width,B$r=(B$i[4]||B$k.sourceHeight)/B$k.height,B$H=B$L*B$k.sourceWidth,B$Y=B$r*B$k.sourceHeight,B$G=0<B$k.offsetX?B$k.offsetX:0,B$X=0<B$k.offsetY?B$k.offsetY:0,B$G*=B$L,B$X*=B$r,B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1]-B$G,B$i[2]-B$X,B$H,B$Y),B$C));break;case B$p._fillTexture:B$i[3]&&B$i[4]?B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$i[3],B$i[4]),B$C):(B$k=B$i[0],B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$k.width,B$k.height),B$C));break;case B$p._drawTextureWithTransform:var B$y;B$y=B$i[5]?(B$C.copyTo(B$_),B$_.concat(B$i[5]),B$_):B$C,B$O?B$i[3]&&B$i[4]?B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$i[3],B$i[4]),B$y):(B$k=B$i[0],B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1],B$i[2],B$k.width,B$k.height),B$y)):(B$k=B$i[0],B$L=(B$i[3]||B$k.sourceWidth)/B$k.width,B$r=(B$i[4]||B$k.sourceHeight)/B$k.height,B$H=B$L*B$k.sourceWidth,B$Y=B$r*B$k.sourceHeight,B$G=0<B$k.offsetX?B$k.offsetX:0,B$X=0<B$k.offsetY?B$k.offsetY:0,B$G*=B$L,B$X*=B$r,B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[1]-B$G,B$i[2]-B$X,B$H,B$Y),B$y));break;case B$p._drawRect:case 13:B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[0],B$i[1],B$i[2],B$i[3]),B$C);break;case B$p._drawCircle:case B$p._fillCircle:case 14:B$A._addPointArrToRst(B$J,B$t._getBoundPointS(B$i[0]-B$i[2],B$i[1]-B$i[2],B$i[2]+B$i[2],B$i[2]+B$i[2]),B$C);break;case B$p._drawLine:case 20:B$A._tempPoints.length=0;var B$v;B$v=.5*B$i[5],B$i[0]==B$i[2]?B$A._tempPoints.push(B$i[0]+B$v,B$i[1],B$i[2]+B$v,B$i[3],B$i[0]-B$v,B$i[1],B$i[2]-B$v,B$i[3]):B$i[1]==B$i[3]?B$A._tempPoints.push(B$i[0],B$i[1]+B$v,B$i[2],B$i[3]+B$v,B$i[0],B$i[1]-B$v,B$i[2],B$i[3]-B$v):B$A._tempPoints.push(B$i[0],B$i[1],B$i[2],B$i[3]),B$A._addPointArrToRst(B$J,B$A._tempPoints,B$C);break;case B$p._drawCurves:case 22:B$A._addPointArrToRst(B$J,B$q.I.getBezierPoints(B$i[2]),B$C,B$i[0],B$i[1]);break;case B$p._drawPoly:case B$p._drawLines:case 18:B$A._addPointArrToRst(B$J,B$i[2],B$C,B$i[0],B$i[1]);break;case B$p._drawPath:case 19:B$A._addPointArrToRst(B$J,this._getPathPoints(B$i[2]),B$C,B$i[0],B$i[1]);break;case B$p._drawPie:case 15:B$A._addPointArrToRst(B$J,this._getPiePoints(B$i[0],B$i[1],B$i[2],B$i[3],B$i[4]),B$C)}return 200<B$J.length?B$J=B$Q.copyArray(B$J,B$t._getWrapRec(B$J)._getBoundPoints()):8<B$J.length&&(B$J=B$d.scanPList(B$J)),B$J},B$O._switchMatrix=function(B$O,B$J){B$J.concat(B$O),B$J.copyTo(B$O)},B$O._getPiePoints=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$A._tempPoints;B$A._tempPoints.length=0,B$C.push(B$O,B$J);var B$i=(B$m-B$p)%(2*Math.PI)/10,B$k=NaN,B$_=B$p;for(B$k=0;B$k<=10;B$k++)B$C.push(B$O+B$D*Math.cos(B$_),B$J+B$D*Math.sin(B$_)),B$_+=B$i;return B$C},B$O._getPathPoints=function(B$O){var B$J,B$D,B$p=0,B$m=B$A._tempPoints;for(B$m.length=0,B$J=B$O.length,B$p=0;B$p<B$J;B$p++)1<(B$D=B$O[B$p]).length&&(B$m.push(B$D[1],B$D[2]),3<B$D.length&&B$m.push(B$D[3],B$D[4]));return B$m},B$A._addPointArrToRst=function(B$O,B$J,B$D,B$p,B$m){void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0);var B$C,B$i=0;for(B$C=B$J.length,B$i=0;B$i<B$C;B$i+=2)B$A._addPointToRst(B$O,B$J[B$i]+B$p,B$J[B$i+1]+B$m,B$D)},B$A._addPointToRst=function(B$O,B$J,B$D,B$p){var B$m=B$e.TEMP;B$m.setTo(B$J||0,B$D||0),B$p.transformPoint(B$m),B$O.push(B$m.x,B$m.y)},B$A._tempPoints=[],B$A._tempMatrixArrays=[],B$A._tempCmds=[],B$_(B$A,["_tempMatrix",function(){return this._tempMatrix=new B$E},"_initMatrix",function(){return this._initMatrix=new B$E}]),B$A}(),B$C=function(){function B$O(){}B$r(B$O,"laya.events.Event");var B$J=B$O.prototype;return B$J.setTo=function(B$O,B$J,B$D){return this.type=B$O,this.currentTarget=B$J,this.target=B$D,this},B$J.stopPropagation=function(){this._stoped=!0},B$X(0,B$J,"stageY",function(){return B$a.stage.mouseY}),B$X(0,B$J,"charCode",function(){return this.nativeEvent.charCode}),B$X(0,B$J,"touches",function(){var B$O=this.nativeEvent.touches;if(B$O)for(var B$J=B$a.stage,B$D=0,B$p=B$O.length;B$D<B$p;B$D++){var B$m=B$O[B$D],B$C=B$e.TEMP;B$C.setTo(B$m.clientX,B$m.clientY),B$J._canvasTransform.invertTransformPoint(B$C),B$J.transform.invertTransformPoint(B$C),B$m.stageX=B$C.x,B$m.stageY=B$C.y}return B$O}),B$X(0,B$J,"keyLocation",function(){return this.nativeEvent.keyLocation}),B$X(0,B$J,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),B$X(0,B$J,"altKey",function(){return this.nativeEvent.altKey}),B$X(0,B$J,"shiftKey",function(){return this.nativeEvent.shiftKey}),B$X(0,B$J,"stageX",function(){return B$a.stage.mouseX}),B$O.EMPTY=new B$O,B$O.MOUSE_DOWN="mousedown",B$O.MOUSE_UP="mouseup",B$O.CLICK="click",B$O.RIGHT_MOUSE_DOWN="rightmousedown",B$O.RIGHT_MOUSE_UP="rightmouseup",B$O.RIGHT_CLICK="rightclick",B$O.MOUSE_MOVE="mousemove",B$O.MOUSE_OVER="mouseover",B$O.MOUSE_OUT="mouseout",B$O.MOUSE_WHEEL="mousewheel",B$O.ROLL_OVER="mouseover",B$O.ROLL_OUT="mouseout",B$O.DOUBLE_CLICK="doubleclick",B$O.CHANGE="change",B$O.CHANGED="changed",B$O.RESIZE="resize",B$O.ADDED="added",B$O.REMOVED="removed",B$O.DISPLAY="display",B$O.UNDISPLAY="undisplay",B$O.ERROR="error",B$O.COMPLETE="complete",B$O.LOADED="loaded",B$O.INITED="inited",B$O.PROGRESS="progress",B$O.INPUT="input",B$O.RENDER="render",B$O.OPEN="open",B$O.MESSAGE="message",B$O.CLOSE="close",B$O.KEY_DOWN="keydown",B$O.KEY_PRESS="keypress",B$O.KEY_UP="keyup",B$O.FRAME="enterframe",B$O.DRAG_START="dragstart",B$O.DRAG_MOVE="dragmove",B$O.DRAG_END="dragend",B$O.ENTER="enter",B$O.SELECT="select",B$O.BLUR="blur",B$O.FOCUS="focus",B$O.VISIBILITY_CHANGE="visibilitychange",B$O.FOCUS_CHANGE="focuschange",B$O.PLAYED="played",B$O.PAUSED="paused",B$O.STOPPED="stopped",B$O.START="start",B$O.END="end",B$O.ENABLE_CHANGED="enablechanged",B$O.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",B$O.COMPONENT_ADDED="componentadded",B$O.COMPONENT_REMOVED="componentremoved",B$O.LAYER_CHANGED="layerchanged",B$O.HIERARCHY_LOADED="hierarchyloaded",B$O.RECOVERED="recovered",B$O.RELEASED="released",B$O.LINK="link",B$O.LABEL="label",B$O.FULL_SCREEN_CHANGE="fullscreenchange",B$O.DEVICE_LOST="devicelost",B$O.MESH_CHANGED="meshchanged",B$O.MATERIAL_CHANGED="materialchanged",B$O.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",B$O.ANIMATION_CHANGED="animationchanged",B$O.TRIGGER_ENTER="triggerenter",B$O.TRIGGER_STAY="triggerstay",B$O.TRIGGER_EXIT="triggerexit",B$O.TRAIL_FILTER_CHANGE="trailfilterchange",B$O.DOMINO_FILTER_CHANGE="dominofilterchange",B$O}(),B$H=(function(){function B$O(){}B$r(B$O,"laya.events.Keyboard"),B$O.NUMBER_0=48,B$O.NUMBER_1=49,B$O.NUMBER_2=50,B$O.NUMBER_3=51,B$O.NUMBER_4=52,B$O.NUMBER_5=53,B$O.NUMBER_6=54,B$O.NUMBER_7=55,B$O.NUMBER_8=56,B$O.NUMBER_9=57,B$O.A=65,B$O.B=66,B$O.C=67,B$O.D=68,B$O.E=69,B$O.F=70,B$O.G=71,B$O.H=72,B$O.I=73,B$O.J=74,B$O.K=75,B$O.L=76,B$O.M=77,B$O.N=78,B$O.O=79,B$O.P=80,B$O.Q=81,B$O.R=82,B$O.S=83,B$O.T=84,B$O.U=85,B$O.V=86,B$O.W=87,B$O.X=88,B$O.Y=89,B$O.Z=90,B$O.F1=112,B$O.F2=113,B$O.F3=114,B$O.F4=115,B$O.F5=116,B$O.F6=117,B$O.F7=118,B$O.F8=119,B$O.F9=120,B$O.F10=121,B$O.F11=122,B$O.F12=123,B$O.F13=124,B$O.F14=125,B$O.F15=126,B$O.NUMPAD=21,B$O.NUMPAD_0=96,B$O.NUMPAD_1=97,B$O.NUMPAD_2=98,B$O.NUMPAD_3=99,B$O.NUMPAD_4=100,B$O.NUMPAD_5=101,B$O.NUMPAD_6=102,B$O.NUMPAD_7=103,B$O.NUMPAD_8=104,B$O.NUMPAD_9=105,B$O.NUMPAD_ADD=107,B$O.NUMPAD_DECIMAL=110,B$O.NUMPAD_DIVIDE=111,B$O.NUMPAD_ENTER=108,B$O.NUMPAD_MULTIPLY=106,B$O.NUMPAD_SUBTRACT=109,B$O.SEMICOLON=186,B$O.EQUAL=187,B$O.COMMA=188,B$O.MINUS=189,B$O.PERIOD=190,B$O.SLASH=191,B$O.BACKQUOTE=192,B$O.LEFTBRACKET=219,B$O.BACKSLASH=220,B$O.RIGHTBRACKET=221,B$O.QUOTE=222,B$O.ALTERNATE=18,B$O.BACKSPACE=8,B$O.CAPS_LOCK=20,B$O.COMMAND=15,B$O.CONTROL=17,B$O.DELETE=46,B$O.ENTER=13,B$O.ESCAPE=27,B$O.PAGE_UP=33,B$O.PAGE_DOWN=34,B$O.END=35,B$O.HOME=36,B$O.LEFT=37,B$O.UP=38,B$O.RIGHT=39,B$O.DOWN=40,B$O.SHIFT=16,B$O.SPACE=32,B$O.TAB=9,B$O.INSERT=45}(),function(){function B$m(){}return B$r(B$m,"laya.events.KeyBoardManager"),B$m.__init__=function(){B$m._addEvent("keydown"),B$m._addEvent("keypress"),B$m._addEvent("keyup")},B$m._addEvent=function(B$J){B$l.document.addEventListener(B$J,function(B$O){laya.events.KeyBoardManager._dispatch(B$O,B$J)},!0)},B$m._dispatch=function(B$O,B$J){if(B$m.enabled){B$m._event._stoped=!1,B$m._event.nativeEvent=B$O,B$m._event.keyCode=B$O.keyCode||B$O.which||B$O.charCode,"keydown"===B$J?B$m._pressKeys[B$m._event.keyCode]=!0:"keyup"===B$J&&(B$m._pressKeys[B$m._event.keyCode]=null);for(var B$D=B$a.stage.focus&&null!=B$a.stage.focus.event&&B$a.stage.focus.displayedInStage?B$a.stage.focus:B$a.stage,B$p=B$D;B$p;)B$p.event(B$J,B$m._event.setTo(B$J,B$p,B$D)),B$p=B$p.parent}},B$m.hasKeyDown=function(B$O){return B$m._pressKeys[B$O]},B$m._pressKeys={},B$m.enabled=!0,B$_(B$m,["_event",function(){return this._event=new B$C}]),B$m}()),B$c=(function(){function B$O(){}B$r(B$O,"laya.events.KeyLocation"),B$O.STANDARD=0,B$O.LEFT=1,B$O.RIGHT=2,B$O.NUM_PAD=3}(),function(){function B$L(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=B$l.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new B$C,this._matrix=new B$E,this._point=new B$e,this._rect=new B$t,this._prePoint=new B$e,this._curTouchID=NaN}B$r(B$L,"laya.events.MouseManager");var B$O=B$L.prototype;return B$O.__init__=function(B$O,B$J){var B$D=this;this._stage=B$O;var B$p=this,B$m=this._eventList;B$J.oncontextmenu=function(B$O){if(B$L.enabled)return!1},B$J.addEventListener("mousedown",function(B$O){B$L.enabled&&(B$l.onIE||B$O.preventDefault(),B$m.push(B$O),B$p.mouseDownTime=B$l.now())}),B$J.addEventListener("mouseup",function(B$O){B$L.enabled&&(B$O.preventDefault(),B$m.push(B$O),B$p.mouseDownTime=-B$l.now())},!0),B$J.addEventListener("mousemove",function(B$O){if(B$L.enabled){B$O.preventDefault();var B$J=B$l.now();if(B$J-B$p._lastMoveTimer<10)return;B$p._lastMoveTimer=B$J,B$m.push(B$O)}},!0),B$J.addEventListener("mouseout",function(B$O){B$L.enabled&&B$m.push(B$O)}),B$J.addEventListener("mouseover",function(B$O){B$L.enabled&&B$m.push(B$O)}),B$J.addEventListener("touchstart",function(B$O){B$L.enabled&&(B$m.push(B$O),B$L._isFirstTouch||B$dO.isInputting||B$O.preventDefault(),B$p.mouseDownTime=B$l.now())}),B$J.addEventListener("touchend",function(B$O){B$L.enabled?(B$L._isFirstTouch||B$dO.isInputting||B$O.preventDefault(),B$L._isFirstTouch=!1,B$m.push(B$O),B$p.mouseDownTime=-B$l.now()):B$D._curTouchID=NaN},!0),B$J.addEventListener("touchmove",function(B$O){B$L.enabled&&(B$O.preventDefault(),B$m.push(B$O))},!0),B$J.addEventListener("touchcancel",function(B$O){B$L.enabled?(B$O.preventDefault(),B$m.push(B$O)):B$D._curTouchID=NaN},!0),B$J.addEventListener("mousewheel",function(B$O){B$L.enabled&&B$m.push(B$O)}),B$J.addEventListener("DOMMouseScroll",function(B$O){B$L.enabled&&B$m.push(B$O)})},B$O.initEvent=function(B$O,B$J){var B$D;this._event._stoped=!1,this._event.nativeEvent=B$J||B$O,this._target=null,this._point.setTo(B$O.pageX||B$O.clientX,B$O.pageY||B$O.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=B$O.identifier||0,this._tTouchID=this._event.touchId,(B$D=B$h.I._event)._stoped=!1,B$D.nativeEvent=this._event.nativeEvent,B$D.touchId=this._event.touchId},B$O.checkMouseWheel=function(B$O){this._event.delta=B$O.wheelDelta?.025*B$O.wheelDelta:-B$O.detail;for(var B$J=B$h.I.getLastOvers(),B$D=0,B$p=B$J.length;B$D<B$p;B$D++){var B$m=B$J[B$D];B$m.event("mousewheel",this._event.setTo("mousewheel",B$m,this._target))}},B$O.onMouseMove=function(B$O){B$h.I.onMouseMove(B$O,this._tTouchID)},B$O.onMouseDown=function(B$O){if(B$dO.isInputting&&B$a.stage.focus&&B$a.stage.focus.focus&&!B$a.stage.focus.contains(this._target)){var B$J=B$a.stage.focus._tf||B$a.stage.focus,B$D=B$O._tf||B$O;B$D instanceof laya.display.Input&&B$D.multiline==B$J.multiline?B$J._focusOut():B$J.focus=!1}B$h.I.onMouseDown(B$O,this._tTouchID,this._isLeftMouse)},B$O.onMouseUp=function(B$O){B$h.I.onMouseUp(B$O,this._tTouchID,this._isLeftMouse)},B$O.check=function(B$O,B$J,B$D,B$p){this._point.setTo(B$J,B$D),B$O.fromParentPoint(this._point),B$J=this._point.x,B$D=this._point.y;var B$m=B$O.scrollRect;if(B$m&&(this._rect.setTo(B$m.x,B$m.y,B$m.width,B$m.height),!this._rect.contains(B$J,B$D)))return!1;if(!this.disableMouseEvent){if(B$O.hitTestPrior&&!B$O.mouseThrough&&!this.hitTest(B$O,B$J,B$D))return!1;for(var B$C=B$O._childs.length-1;-1<B$C;B$C--){var B$i=B$O._childs[B$C];if(!B$i.destroyed&&B$i.mouseEnabled&&B$i.visible&&this.check(B$i,B$J,B$D,B$p))return!0}}var B$k=!(!B$O.hitTestPrior||B$O.mouseThrough||this.disableMouseEvent)||this.hitTest(B$O,B$J,B$D);return B$k?(this._target=B$O,B$p.call(this,B$O)):B$p===this.onMouseUp&&B$O===this._stage&&(this._target=this._stage,B$p.call(this,this._target)),B$k},B$O.hitTest=function(B$O,B$J,B$D){var B$p=!1;if(B$O.scrollRect&&(B$J-=B$O.scrollRect.x,B$D-=B$O.scrollRect.y),B$O.hitArea instanceof laya.utils.HitArea)return B$O.hitArea.isHit(B$J,B$D);if(0<B$O.width&&0<B$O.height||B$O.mouseThrough||B$O.hitArea)if(B$O.mouseThrough)B$p=B$O.getGraphicBounds().contains(B$J,B$D);else{var B$m=this._rect;B$O.hitArea?B$m=B$O.hitArea:B$m.setTo(0,0,B$O.width,B$O.height),B$p=B$m.contains(B$J,B$D)}return B$p},B$O.runEvent=function(){var B$O=this._eventList.length;if(B$O){this.mouseEventTime=B$l.now();var B$J,B$D=0,B$p=0,B$m=0;try{for(;B$D<B$O;){var B$C=this._eventList[B$D];switch("mousemove"!==B$C.type&&(this._prePoint.x=this._prePoint.y=-1e6),B$C.type){case"mousedown":this._touchIDs[0]=this._id++,B$L._isTouchRespond?B$L._isTouchRespond=!1:(this._isLeftMouse=0===B$C.button,this.initEvent(B$C),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===B$C.button,this.initEvent(B$C),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-B$C.clientX)+Math.abs(this._prePoint.y-B$C.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=B$C.clientX,this._prePoint.y=B$C.clientY,this.initEvent(B$C),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":B$L._isTouchRespond=!0,this._isLeftMouse=!0;var B$i=B$C.changedTouches;for(B$p=0,B$m=B$i.length;B$p<B$m;B$p++)B$J=B$i[B$p],(B$L.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=B$J.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[B$J.identifier]=this._id++,this.initEvent(B$J,B$C),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":B$L._isTouchRespond=!0,this._isLeftMouse=!0;var B$k=B$C.changedTouches;for(B$p=0,B$m=B$k.length;B$p<B$m;B$p++)if(B$J=B$k[B$p],B$L.multiTouchEnabled||B$J.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(B$J,B$C);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var B$_=B$C.changedTouches;for(B$p=0,B$m=B$_.length;B$p<B$m;B$p++)B$J=B$_[B$p],(B$L.multiTouchEnabled||B$J.identifier==this._curTouchID)&&(this.initEvent(B$J,B$C),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(B$C);break;case"mouseout":B$h.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}B$D++}}catch(B$O){throw this._eventList.length=0,B$O}this._eventList.length=0}},B$L.enabled=!0,B$L.multiTouchEnabled=!0,B$L._isTouchRespond=!1,B$L._isFirstTouch=!0,B$_(B$L,["instance",function(){return this.instance=new B$L}]),B$L}()),B$h=function(){function B$X(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new B$C}B$r(B$X,"laya.events.TouchManager");var B$O=B$X.prototype;return B$O._clearTempArrs=function(){B$X._oldArr.length=0,B$X._newArr.length=0,B$X._tEleArr.length=0},B$O.getTouchFromArr=function(B$O,B$J){var B$D,B$p,B$m=0;for(B$D=B$J.length,B$m=0;B$m<B$D;B$m++)if((B$p=B$J[B$m]).id==B$O)return B$p;return null},B$O.removeTouchFromArr=function(B$O,B$J){var B$D=0;for(B$D=B$J.length-1;0<=B$D;B$D--)B$J[B$D].id==B$O&&B$J.splice(B$D,1)},B$O.createTouchO=function(B$O,B$J){var B$D;return(B$D=B$Z.getItem("TouchData")||{}).id=B$J,B$D.tar=B$O,B$D},B$O.onMouseDown=function(B$O,B$J,B$D){var B$p,B$m,B$C,B$i;(void 0===B$D&&(B$D=!1),this.enable)&&(B$p=this.getTouchFromArr(B$J,this.preOvers),B$C=this.getEles(B$O,null,B$X._tEleArr),B$p?B$p.tar=B$O:(B$m=this.createTouchO(B$O,B$J),this.preOvers.push(B$m)),B$l.onMobile&&this.sendEvents(B$C,"mouseover",B$J),B$i=B$D?this.preDowns:this.preRightDowns,(B$p=this.getTouchFromArr(B$J,B$i))?B$p.tar=B$O:(B$m=this.createTouchO(B$O,B$J),B$i.push(B$m)),this.sendEvents(B$C,B$D?"mousedown":"rightmousedown",B$J),this._clearTempArrs())},B$O.sendEvents=function(B$O,B$J,B$D){void 0===B$D&&(B$D=0);var B$p,B$m,B$C,B$i=0;for(B$p=B$O.length,this._event._stoped=!1,B$m=B$O[0],B$i=0;B$i<B$p;B$i++){if((B$C=B$O[B$i]).destroyed)return;if(B$C.event(B$J,this._event.setTo(B$J,B$C,B$m)),this._event._stoped)break}},B$O.getEles=function(B$O,B$J,B$D){for(B$D?B$D.length=0:B$D=[];B$O&&B$O!=B$J;)B$D.push(B$O),B$O=B$O.parent;return B$D},B$O.checkMouseOutAndOverOfMove=function(B$O,B$J,B$D){if(void 0===B$D&&(B$D=0),B$J!=B$O){var B$p,B$m,B$C=0,B$i=0;if(B$J.contains(B$O))B$m=this.getEles(B$O,B$J,B$X._tEleArr),this.sendEvents(B$m,"mouseover",B$D);else if(B$O.contains(B$J))B$m=this.getEles(B$J,B$O,B$X._tEleArr),this.sendEvents(B$m,"mouseout",B$D);else{var B$k,B$_;(B$m=B$X._tEleArr).length=0,B$k=this.getEles(B$J,null,B$X._oldArr),B$_=this.getEles(B$O,null,B$X._newArr),B$i=B$k.length;var B$L=0;for(B$C=0;B$C<B$i;B$C++){if(B$p=B$k[B$C],0<=(B$L=B$_.indexOf(B$p))){B$_.splice(B$L,B$_.length-B$L);break}B$m.push(B$p)}0<B$m.length&&this.sendEvents(B$m,"mouseout",B$D),0<B$_.length&&this.sendEvents(B$_,"mouseover",B$D)}}},B$O.onMouseMove=function(B$O,B$J){var B$D,B$p;this.enable&&((B$D=this.getTouchFromArr(B$J,this.preOvers))?(this.checkMouseOutAndOverOfMove(B$O,B$D.tar),B$D.tar=B$O,B$p=this.getEles(B$O,null,B$X._tEleArr)):(B$p=this.getEles(B$O,null,B$X._tEleArr),this.sendEvents(B$p,"mouseover",B$J),this.preOvers.push(this.createTouchO(B$O,B$J))),this.sendEvents(B$p,"mousemove",B$J),this._clearTempArrs())},B$O.getLastOvers=function(){return(B$X._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,B$X._tEleArr):(B$X._tEleArr.push(B$a.stage),B$X._tEleArr)},B$O.stageMouseOut=function(){var B$O;B$O=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(B$O,"mouseout",0)},B$O.onMouseUp=function(B$O,B$J,B$D){if(void 0===B$D&&(B$D=!1),this.enable){var B$p,B$m,B$C,B$i,B$k,B$_,B$L=0,B$r=0,B$H=B$l.onMobile;if(B$m=this.getEles(B$O,null,B$X._tEleArr),this.sendEvents(B$m,B$D?"mouseup":"rightmouseup",B$J),B$_=B$D?this.preDowns:this.preRightDowns,B$p=this.getTouchFromArr(B$J,B$_)){var B$Y,B$G=B$l.now();if(B$Y=B$G-this._lastClickTime<300,this._lastClickTime=B$G,B$O==B$p.tar)B$k=B$m;else for(B$C=this.getEles(B$p.tar,null,B$X._oldArr),(B$k=B$X._newArr).length=0,B$r=B$C.length,B$L=0;B$L<B$r;B$L++)B$i=B$C[B$L],0<=B$m.indexOf(B$i)&&B$k.push(B$i);0<B$k.length&&this.sendEvents(B$k,B$D?"click":"rightclick",B$J),B$D&&B$Y&&this.sendEvents(B$k,"doubleclick",B$J),this.removeTouchFromArr(B$J,B$_),B$p.tar=null,B$Z.recover("TouchData",B$p)}else;(B$p=this.getTouchFromArr(B$J,this.preOvers))&&B$H&&((B$k=this.getEles(B$p.tar,null,B$k))&&0<B$k.length&&this.sendEvents(B$k,"mouseout",B$J),this.removeTouchFromArr(B$J,this.preOvers),B$p.tar=null,B$Z.recover("TouchData",B$p)),this._clearTempArrs()}},B$X._oldArr=[],B$X._newArr=[],B$X._tEleArr=[],B$_(B$X,["I",function(){return this.I=new B$X}]),B$X}(),B$y=function(){function B$O(){this._action=null}B$r(B$O,"laya.filters.Filter");var B$J=B$O.prototype;return B$a.imps(B$J,{"laya.filters.IFilter":!0}),B$J.callNative=function(B$O){},B$X(0,B$J,"type",function(){return-1}),B$X(0,B$J,"action",function(){return this._action}),B$O.BLUR=16,B$O.COLOR=32,B$O.GLOW=8,B$O._filterStart=null,B$O._filterEnd=null,B$O._EndTarget=null,B$O._recycleScope=null,B$O._filter=null,B$O._useSrc=null,B$O._endSrc=null,B$O._useOut=null,B$O._endOut=null,B$O}(),B$A=function(){function B$O(){this.data=null}B$r(B$O,"laya.filters.ColorFilterAction");var B$J=B$O.prototype;return B$a.imps(B$J,{"laya.filters.IFilterAction":!0}),B$J.apply=function(B$O){var B$J=B$O.ctx.ctx,B$D=B$O.ctx.ctx.canvas;if(0==B$D.width||0==B$D.height)return B$D;for(var B$p,B$m=B$J.getImageData(0,0,B$D.width,B$D.height),B$C=B$m.data,B$i=0,B$k=B$C.length;B$i<B$k;B$i+=4)B$p=this.getColor(B$C[B$i],B$C[B$i+1],B$C[B$i+2],B$C[B$i+3]),0!=B$C[B$i+3]&&(B$C[B$i]=B$p[0],B$C[B$i+1]=B$p[1],B$C[B$i+2]=B$p[2],B$C[B$i+3]=B$p[3]);return B$J.putImageData(B$m,0,0),B$O},B$J.getColor=function(B$O,B$J,B$D,B$p){var B$m=[];if(this.data._mat&&this.data._alpha){var B$C=this.data._mat,B$i=this.data._alpha;B$m[0]=B$C[0]*B$O+B$C[1]*B$J+B$C[2]*B$D+B$C[3]*B$p+B$i[0],B$m[1]=B$C[4]*B$O+B$C[5]*B$J+B$C[6]*B$D+B$C[7]*B$p+B$i[1],B$m[2]=B$C[8]*B$O+B$C[9]*B$J+B$C[10]*B$D+B$C[11]*B$p+B$i[2],B$m[3]=B$C[12]*B$O+B$C[13]*B$J+B$C[14]*B$D+B$C[15]*B$p+B$i[3]}return B$m},B$O}(),B$q=(function(){function B$O(){}B$r(B$O,"laya.maths.Arith"),B$O.formatR=function(B$O){return B$O>Math.PI&&(B$O-=2*Math.PI),B$O<-Math.PI&&(B$O+=2*Math.PI),B$O},B$O.isPOT=function(B$O,B$J){return 0<B$O&&0==(B$O&B$O-1)&&0<B$J&&0==(B$J&B$J-1)},B$O.setMatToArray=function(B$O,B$J){B$O.a,B$O.b,B$O.c,B$O.d,B$O.tx,B$O.ty,B$J[0]=B$O.a,B$J[1]=B$O.b,B$J[4]=B$O.c,B$J[5]=B$O.d,B$J[12]=B$O.tx,B$J[13]=B$O.ty}}(),function(){function B$O(){this._controlPoints=[new B$e,new B$e,new B$e],this._calFun=this.getPoint2}B$r(B$O,"laya.maths.Bezier");var B$J=B$O.prototype;return B$J._switchPoint=function(B$O,B$J){var B$D=this._controlPoints.shift();B$D.setTo(B$O,B$J),this._controlPoints.push(B$D)},B$J.getPoint2=function(B$O,B$J){var B$D=this._controlPoints[0],B$p=this._controlPoints[1],B$m=this._controlPoints[2],B$C=Math.pow(1-B$O,2)*B$D.x+2*B$O*(1-B$O)*B$p.x+Math.pow(B$O,2)*B$m.x,B$i=Math.pow(1-B$O,2)*B$D.y+2*B$O*(1-B$O)*B$p.y+Math.pow(B$O,2)*B$m.y;B$J.push(B$C,B$i)},B$J.getPoint3=function(B$O,B$J){var B$D=this._controlPoints[0],B$p=this._controlPoints[1],B$m=this._controlPoints[2],B$C=this._controlPoints[3],B$i=Math.pow(1-B$O,3)*B$D.x+3*B$p.x*B$O*(1-B$O)*(1-B$O)+3*B$m.x*B$O*B$O*(1-B$O)+B$C.x*Math.pow(B$O,3),B$k=Math.pow(1-B$O,3)*B$D.y+3*B$p.y*B$O*(1-B$O)*(1-B$O)+3*B$m.y*B$O*B$O*(1-B$O)+B$C.y*Math.pow(B$O,3);B$J.push(B$i,B$k)},B$J.insertPoints=function(B$O,B$J){var B$D,B$p=NaN;for(B$D=1/(B$O=0<B$O?B$O:5),B$p=0;B$p<=1;B$p+=B$D)this._calFun(B$p,B$J)},B$J.getBezierPoints=function(B$O,B$J,B$D){void 0===B$J&&(B$J=5),void 0===B$D&&(B$D=2);var B$p,B$m,B$C=0;if((B$p=B$O.length)<2*(B$D+1))return[];switch(B$m=[],B$D){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=B$D;)this._controlPoints.push(new B$e);for(B$C=0;B$C<2*B$D;B$C+=2)this._switchPoint(B$O[B$C],B$O[B$C+1]);for(B$C=2*B$D;B$C<B$p;B$C+=2)this._switchPoint(B$O[B$C],B$O[B$C+1]),B$C/2%B$D==0&&this.insertPoints(B$J,B$m);return B$m},B$_(B$O,["I",function(){return this.I=new B$O}]),B$O}()),B$d=function(){function B$L(){}return B$r(B$L,"laya.maths.GrahamScan"),B$L.multiply=function(B$O,B$J,B$D){return(B$O.x-B$D.x)*(B$J.y-B$D.y)-(B$J.x-B$D.x)*(B$O.y-B$D.y)},B$L.dis=function(B$O,B$J){return(B$O.x-B$J.x)*(B$O.x-B$J.x)+(B$O.y-B$J.y)*(B$O.y-B$J.y)},B$L._getPoints=function(B$O,B$J,B$D){for(void 0===B$J&&(B$J=!1),B$L._mPointList||(B$L._mPointList=[]);B$L._mPointList.length<B$O;)B$L._mPointList.push(new B$e);return B$D||(B$D=[]),B$D.length=0,B$J?B$L.getFrom(B$D,B$L._mPointList,B$O):B$L.getFromR(B$D,B$L._mPointList,B$O),B$D},B$L.getFrom=function(B$O,B$J,B$D){var B$p=0;for(B$p=0;B$p<B$D;B$p++)B$O.push(B$J[B$p]);return B$O},B$L.getFromR=function(B$O,B$J,B$D){var B$p=0;for(B$p=0;B$p<B$D;B$p++)B$O.push(B$J.pop());return B$O},B$L.pListToPointList=function(B$O,B$J){void 0===B$J&&(B$J=!1);var B$D=0,B$p=B$O.length/2,B$m=B$L._getPoints(B$p,B$J,B$L._tempPointList);for(B$D=0;B$D<B$p;B$D++)B$m[B$D].setTo(B$O[B$D+B$D],B$O[B$D+B$D+1]);return B$m},B$L.pointListToPlist=function(B$O){var B$J,B$D=0,B$p=B$O.length,B$m=B$L._temPList;for(B$D=B$m.length=0;B$D<B$p;B$D++)B$J=B$O[B$D],B$m.push(B$J.x,B$J.y);return B$m},B$L.scanPList=function(B$O){return B$Q.copyArray(B$O,B$L.pointListToPlist(B$L.scan(B$L.pListToPointList(B$O,!0))))},B$L.scan=function(B$O){var B$J,B$D,B$p,B$m=0,B$C=0,B$i=0,B$k=B$O.length,B$_={};for((B$D=B$L._temArr).length=0,B$m=(B$k=B$O.length)-1;0<=B$m;B$m--)B$p=(B$J=B$O[B$m]).x+"_"+B$J.y,B$_.hasOwnProperty(B$p)||(B$_[B$p]=!0,B$D.push(B$J));for(B$k=B$D.length,B$Q.copyArray(B$O,B$D),B$m=1;B$m<B$k;B$m++)(B$O[B$m].y<B$O[B$i].y||B$O[B$m].y==B$O[B$i].y&&B$O[B$m].x<B$O[B$i].x)&&(B$i=B$m);for(B$J=B$O[0],B$O[0]=B$O[B$i],B$O[B$i]=B$J,B$m=1;B$m<B$k-1;B$m++){for(B$C=(B$i=B$m)+1;B$C<B$k;B$C++)(0<B$L.multiply(B$O[B$C],B$O[B$i],B$O[0])||0==B$L.multiply(B$O[B$C],B$O[B$i],B$O[0])&&B$L.dis(B$O[0],B$O[B$C])<B$L.dis(B$O[0],B$O[B$i]))&&(B$i=B$C);B$J=B$O[B$m],B$O[B$m]=B$O[B$i],B$O[B$i]=B$J}if((B$D=B$L._temArr).length=0,B$O.length<3)return B$Q.copyArray(B$D,B$O);for(B$D.push(B$O[0],B$O[1],B$O[2]),B$m=3;B$m<B$k;B$m++){for(;2<=B$D.length&&0<=B$L.multiply(B$O[B$m],B$D[B$D.length-1],B$D[B$D.length-2]);)B$D.pop();B$O[B$m]&&B$D.push(B$O[B$m])}return B$D},B$L._mPointList=null,B$L._tempPointList=[],B$L._temPList=[],B$L._temArr=[],B$L}(),B$M=function(){function B$m(){}return B$r(B$m,"laya.maths.MathUtil"),B$m.subtractVector3=function(B$O,B$J,B$D){B$D[0]=B$O[0]-B$J[0],B$D[1]=B$O[1]-B$J[1],B$D[2]=B$O[2]-B$J[2]},B$m.lerp=function(B$O,B$J,B$D){return B$O*(1-B$D)+B$J*B$D},B$m.scaleVector3=function(B$O,B$J,B$D){B$D[0]=B$O[0]*B$J,B$D[1]=B$O[1]*B$J,B$D[2]=B$O[2]*B$J},B$m.lerpVector3=function(B$O,B$J,B$D,B$p){var B$m=B$O[0],B$C=B$O[1],B$i=B$O[2];B$p[0]=B$m+B$D*(B$J[0]-B$m),B$p[1]=B$C+B$D*(B$J[1]-B$C),B$p[2]=B$i+B$D*(B$J[2]-B$i)},B$m.lerpVector4=function(B$O,B$J,B$D,B$p){var B$m=B$O[0],B$C=B$O[1],B$i=B$O[2],B$k=B$O[3];B$p[0]=B$m+B$D*(B$J[0]-B$m),B$p[1]=B$C+B$D*(B$J[1]-B$C),B$p[2]=B$i+B$D*(B$J[2]-B$i),B$p[3]=B$k+B$D*(B$J[3]-B$k)},B$m.slerpQuaternionArray=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k,B$_,B$L,B$r,B$H,B$Y=B$O[B$J+0],B$G=B$O[B$J+1],B$X=B$O[B$J+2],B$c=B$O[B$J+3],B$h=B$D[B$p+0],B$y=B$D[B$p+1],B$v=B$D[B$p+2],B$A=B$D[B$p+3];return(B$_=B$Y*B$h+B$G*B$y+B$X*B$v+B$c*B$A)<0&&(B$_=-B$_,B$h=-B$h,B$y=-B$y,B$v=-B$v,B$A=-B$A),B$H=1e-6<1-B$_?(B$k=Math.acos(B$_),B$L=Math.sin(B$k),B$r=Math.sin((1-B$m)*B$k)/B$L,Math.sin(B$m*B$k)/B$L):(B$r=1-B$m,B$m),B$C[B$i+0]=B$r*B$Y+B$H*B$h,B$C[B$i+1]=B$r*B$G+B$H*B$y,B$C[B$i+2]=B$r*B$X+B$H*B$v,B$C[B$i+3]=B$r*B$c+B$H*B$A,B$C},B$m.getRotation=function(B$O,B$J,B$D,B$p){return Math.atan2(B$p-B$J,B$D-B$O)/Math.PI*180},B$m.sortBigFirst=function(B$O,B$J){return B$O==B$J?0:B$O<B$J?1:-1},B$m.sortSmallFirst=function(B$O,B$J){return B$O==B$J?0:B$O<B$J?-1:1},B$m.sortNumBigFirst=function(B$O,B$J){return parseFloat(B$J)-parseFloat(B$O)},B$m.sortNumSmallFirst=function(B$O,B$J){return parseFloat(B$O)-parseFloat(B$J)},B$m.sortByKey=function(B$D,B$O,B$J){var B$p;return void 0===B$O&&(B$O=!1),void 0===B$J&&(B$J=!0),B$p=B$O?B$J?B$m.sortNumBigFirst:B$m.sortBigFirst:B$J?B$m.sortNumSmallFirst:B$m.sortSmallFirst,function(B$O,B$J){return B$p(B$O[B$D],B$J[B$D])}},B$m}(),B$E=function(){function B$D(B$O,B$J,B$D,B$p,B$m,B$C){this.inPool=!1,this.bTransform=!1,void 0===B$O&&(B$O=1),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=1),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=0),this.a=B$O,this.b=B$J,this.c=B$D,this.d=B$p,this.tx=B$m,this.ty=B$C,this._checkTransform()}B$r(B$D,"laya.maths.Matrix");var B$O=B$D.prototype;return B$O.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},B$O._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},B$O.setTranslate=function(B$O,B$J){return this.tx=B$O,this.ty=B$J,this},B$O.translate=function(B$O,B$J){return this.tx+=B$O,this.ty+=B$J,this},B$O.scale=function(B$O,B$J){this.a*=B$O,this.d*=B$J,this.c*=B$O,this.b*=B$J,this.tx*=B$O,this.ty*=B$J,this.bTransform=!0},B$O.rotate=function(B$O){var B$J=Math.cos(B$O),B$D=Math.sin(B$O),B$p=this.a,B$m=this.c,B$C=this.tx;this.a=B$p*B$J-this.b*B$D,this.b=B$p*B$D+this.b*B$J,this.c=B$m*B$J-this.d*B$D,this.d=B$m*B$D+this.d*B$J,this.tx=B$C*B$J-this.ty*B$D,this.ty=B$C*B$D+this.ty*B$J,this.bTransform=!0},B$O.skew=function(B$O,B$J){var B$D=Math.tan(B$O),B$p=Math.tan(B$J),B$m=this.a,B$C=this.b;return this.a+=B$p*this.c,this.b+=B$p*this.d,this.c+=B$D*B$m,this.d+=B$D*B$C,this},B$O.invertTransformPoint=function(B$O){var B$J=this.a,B$D=this.b,B$p=this.c,B$m=this.d,B$C=this.tx,B$i=B$J*B$m-B$D*B$p,B$k=B$m/B$i,B$_=-B$D/B$i,B$L=-B$p/B$i,B$r=B$J/B$i,B$H=(B$p*this.ty-B$m*B$C)/B$i,B$Y=-(B$J*this.ty-B$D*B$C)/B$i;return B$O.setTo(B$k*B$O.x+B$L*B$O.y+B$H,B$_*B$O.x+B$r*B$O.y+B$Y)},B$O.transformPoint=function(B$O){return B$O.setTo(this.a*B$O.x+this.c*B$O.y+this.tx,this.b*B$O.x+this.d*B$O.y+this.ty)},B$O.transformPointN=function(B$O){return B$O.setTo(this.a*B$O.x+this.c*B$O.y,this.b*B$O.x+this.d*B$O.y)},B$O.transformPointArray=function(B$O,B$J){for(var B$D=B$O.length,B$p=0;B$p<B$D;B$p+=2){var B$m=B$O[B$p],B$C=B$O[B$p+1];B$J[B$p]=this.a*B$m+this.c*B$C+this.tx,B$J[B$p+1]=this.b*B$m+this.d*B$C+this.ty}return B$J},B$O.transformPointArrayScale=function(B$O,B$J){for(var B$D=B$O.length,B$p=0;B$p<B$D;B$p+=2){var B$m=B$O[B$p],B$C=B$O[B$p+1];B$J[B$p]=this.a*B$m+this.c*B$C,B$J[B$p+1]=this.b*B$m+this.d*B$C}return B$J},B$O.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},B$O.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},B$O.invert=function(){var B$O=this.a,B$J=this.b,B$D=this.c,B$p=this.d,B$m=this.tx,B$C=B$O*B$p-B$J*B$D;return this.a=B$p/B$C,this.b=-B$J/B$C,this.c=-B$D/B$C,this.d=B$O/B$C,this.tx=(B$D*this.ty-B$p*B$m)/B$C,this.ty=-(B$O*this.ty-B$J*B$m)/B$C,this},B$O.setTo=function(B$O,B$J,B$D,B$p,B$m,B$C){return this.a=B$O,this.b=B$J,this.c=B$D,this.d=B$p,this.tx=B$m,this.ty=B$C,this},B$O.concat=function(B$O){var B$J=this.a,B$D=this.c,B$p=this.tx;return this.a=B$J*B$O.a+this.b*B$O.c,this.b=B$J*B$O.b+this.b*B$O.d,this.c=B$D*B$O.a+this.d*B$O.c,this.d=B$D*B$O.b+this.d*B$O.d,this.tx=B$p*B$O.a+this.ty*B$O.c+B$O.tx,this.ty=B$p*B$O.b+this.ty*B$O.d+B$O.ty,this},B$O.scaleEx=function(B$O,B$J){var B$D=this.a,B$p=this.b,B$m=this.c,B$C=this.d;0!==B$p||0!==B$m?(this.a=B$O*B$D,this.b=B$O*B$p,this.c=B$J*B$m):(this.a=B$O*B$D,this.b=0*B$C,this.c=0*B$D),this.d=B$J*B$C,this.bTransform=!0},B$O.rotateEx=function(B$O){var B$J=Math.cos(B$O),B$D=Math.sin(B$O),B$p=this.a,B$m=this.b,B$C=this.c,B$i=this.d;0!==B$m||0!==B$C?(this.a=B$J*B$p+B$D*B$C,this.b=B$J*B$m+B$D*B$i,this.c=-B$D*B$p+B$J*B$C,this.d=-B$D*B$m+B$J*B$i):(this.a=B$J*B$p,this.b=B$D*B$i,this.c=-B$D*B$p,this.d=B$J*B$i),this.bTransform=!0},B$O.clone=function(){var B$O=B$D.create();return B$O.a=this.a,B$O.b=this.b,B$O.c=this.c,B$O.d=this.d,B$O.tx=this.tx,B$O.ty=this.ty,B$O.bTransform=this.bTransform,B$O},B$O.copyTo=function(B$O){return B$O.a=this.a,B$O.b=this.b,B$O.c=this.c,B$O.d=this.d,B$O.tx=this.tx,B$O.ty=this.ty,B$O.bTransform=this.bTransform,B$O},B$O.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},B$O.destroy=function(){if(!this.inPool){var B$O=B$D._cache;this.inPool=!0,B$O._length||(B$O._length=0),(B$O[B$O._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},B$D.mul=function(B$O,B$J,B$D){var B$p=B$O.a,B$m=B$O.b,B$C=B$O.c,B$i=B$O.d,B$k=B$O.tx,B$_=B$O.ty,B$L=B$J.a,B$r=B$J.b,B$H=B$J.c,B$Y=B$J.d,B$G=B$J.tx,B$X=B$J.ty;return 0!==B$r||0!==B$H?(B$D.a=B$p*B$L+B$m*B$H,B$D.b=B$p*B$r+B$m*B$Y,B$D.c=B$C*B$L+B$i*B$H,B$D.d=B$C*B$r+B$i*B$Y,B$D.tx=B$L*B$k+B$H*B$_+B$G,B$D.ty=B$r*B$k+B$Y*B$_+B$X):(B$D.a=B$p*B$L,B$D.b=B$m*B$Y,B$D.c=B$C*B$L,B$D.d=B$i*B$Y,B$D.tx=B$L*B$k+B$G,B$D.ty=B$Y*B$_+B$X),B$D},B$D.mul16=function(B$O,B$J,B$D){var B$p=B$O.a,B$m=B$O.b,B$C=B$O.c,B$i=B$O.d,B$k=B$O.tx,B$_=B$O.ty,B$L=B$J.a,B$r=B$J.b,B$H=B$J.c,B$Y=B$J.d,B$G=B$J.tx,B$X=B$J.ty;return 0!==B$r||0!==B$H?(B$D[0]=B$p*B$L+B$m*B$H,B$D[1]=B$p*B$r+B$m*B$Y,B$D[4]=B$C*B$L+B$i*B$H,B$D[5]=B$C*B$r+B$i*B$Y,B$D[12]=B$L*B$k+B$H*B$_+B$G,B$D[13]=B$r*B$k+B$Y*B$_+B$X):(B$D[0]=B$p*B$L,B$D[1]=B$m*B$Y,B$D[4]=B$C*B$L,B$D[5]=B$i*B$Y,B$D[12]=B$L*B$k+B$G,B$D[13]=B$Y*B$_+B$X),B$D},B$D.mulPre=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=B$O.a,B$L=B$O.b,B$r=B$O.c,B$H=B$O.d,B$Y=B$O.tx,B$G=B$O.ty;return 0!==B$D||0!==B$p?(B$k.a=B$_*B$J+B$L*B$p,B$k.b=B$_*B$D+B$L*B$m,B$k.c=B$r*B$J+B$H*B$p,B$k.d=B$r*B$D+B$H*B$m,B$k.tx=B$J*B$Y+B$p*B$G+B$C,B$k.ty=B$D*B$Y+B$m*B$G+B$i):(B$k.a=B$_*B$J,B$k.b=B$L*B$m,B$k.c=B$r*B$J,B$k.d=B$H*B$m,B$k.tx=B$J*B$Y+B$C,B$k.ty=B$m*B$G+B$i),B$k},B$D.mulPos=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=B$O.a,B$L=B$O.b,B$r=B$O.c,B$H=B$O.d,B$Y=B$O.tx,B$G=B$O.ty;return 0!==B$L||0!==B$r?(B$k.a=B$J*B$_+B$D*B$r,B$k.b=B$J*B$L+B$D*B$H,B$k.c=B$p*B$_+B$m*B$r,B$k.d=B$p*B$L+B$m*B$H,B$k.tx=B$_*B$C+B$r*B$i+B$Y,B$k.ty=B$L*B$C+B$H*B$i+B$G):(B$k.a=B$J*B$_,B$k.b=B$D*B$H,B$k.c=B$p*B$_,B$k.d=B$m*B$H,B$k.tx=B$_*B$C+B$Y,B$k.ty=B$H*B$i+B$G),B$k},B$D.preMul=function(B$O,B$J,B$D){var B$p=B$O.a,B$m=B$O.b,B$C=B$O.c,B$i=B$O.d,B$k=B$J.a,B$_=B$J.b,B$L=B$J.c,B$r=B$J.d,B$H=B$J.tx,B$Y=B$J.ty;return B$D.a=B$k*B$p,B$D.b=B$D.c=0,B$D.d=B$r*B$i,B$D.tx=B$H*B$p+B$O.tx,B$D.ty=B$Y*B$i+B$O.ty,0===B$_&&0===B$L&&0===B$m&&0===B$C||(B$D.a+=B$_*B$C,B$D.d+=B$L*B$m,B$D.b+=B$k*B$m+B$_*B$i,B$D.c+=B$L*B$p+B$r*B$C,B$D.tx+=B$Y*B$C,B$D.ty+=B$H*B$m),B$D},B$D.preMulXY=function(B$O,B$J,B$D,B$p){var B$m=B$O.a,B$C=B$O.b,B$i=B$O.c,B$k=B$O.d;return B$p.a=B$m,B$p.b=B$C,B$p.c=B$i,B$p.d=B$k,B$p.tx=B$J*B$m+B$O.tx+B$D*B$i,B$p.ty=B$D*B$k+B$O.ty+B$J*B$C,B$p},B$D.create=function(){var B$O=B$D._cache,B$J=B$O._length?B$O[--B$O._length]:new B$D;return B$J.inPool=!1,B$J},B$D.EMPTY=new B$D,B$D.TEMP=new B$D,B$D._cache=[],B$D}(),B$e=function(){function B$O(B$O,B$J){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),this.x=B$O,this.y=B$J}B$r(B$O,"laya.maths.Point");var B$J=B$O.prototype;return B$J.setTo=function(B$O,B$J){return this.x=B$O,this.y=B$J,this},B$J.distance=function(B$O,B$J){return Math.sqrt((this.x-B$O)*(this.x-B$O)+(this.y-B$J)*(this.y-B$J))},B$J.toString=function(){return this.x+","+this.y},B$J.normalize=function(){var B$O=Math.sqrt(this.x*this.x+this.y*this.y);if(0<B$O){var B$J=1/B$O;this.x*=B$J,this.y*=B$J}},B$O.TEMP=new B$O,B$O.EMPTY=new B$O,B$O}(),B$t=function(){function B$L(B$O,B$J,B$D,B$p){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),this.x=B$O,this.y=B$J,this.width=B$D,this.height=B$p}B$r(B$L,"laya.maths.Rectangle");var B$O=B$L.prototype;return B$O.setTo=function(B$O,B$J,B$D,B$p){return this.x=B$O,this.y=B$J,this.width=B$D,this.height=B$p,this},B$O.copyFrom=function(B$O){return this.x=B$O.x,this.y=B$O.y,this.width=B$O.width,this.height=B$O.height,this},B$O.contains=function(B$O,B$J){return!(this.width<=0||this.height<=0)&&(B$O>=this.x&&B$O<this.right&&B$J>=this.y&&B$J<this.bottom)},B$O.intersects=function(B$O){return!(B$O.x>this.x+this.width||B$O.x+B$O.width<this.x||B$O.y>this.y+this.height||B$O.y+B$O.height<this.y)},B$O.intersection=function(B$O,B$J){return this.intersects(B$O)?(B$J||(B$J=new B$L),B$J.x=Math.max(this.x,B$O.x),B$J.y=Math.max(this.y,B$O.y),B$J.width=Math.min(this.right,B$O.right)-B$J.x,B$J.height=Math.min(this.bottom,B$O.bottom)-B$J.y,B$J):null},B$O.union=function(B$O,B$J){return B$J||(B$J=new B$L),this.clone(B$J),B$O.width<=0||B$O.height<=0?B$J:(B$J.addPoint(B$O.x,B$O.y),B$J.addPoint(B$O.right,B$O.bottom),this)},B$O.clone=function(B$O){return B$O||(B$O=new B$L),B$O.x=this.x,B$O.y=this.y,B$O.width=this.width,B$O.height=this.height,B$O},B$O.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},B$O.equals=function(B$O){return!(!B$O||B$O.x!==this.x||B$O.y!==this.y||B$O.width!==this.width||B$O.height!==this.height)},B$O.addPoint=function(B$O,B$J){return this.x>B$O&&(this.width+=this.x-B$O,this.x=B$O),this.y>B$J&&(this.height+=this.y-B$J,this.y=B$J),this.width<B$O-this.x&&(this.width=B$O-this.x),this.height<B$J-this.y&&(this.height=B$J-this.y),this},B$O._getBoundPoints=function(){var B$O=B$L._temB;return(B$O.length=0)==this.width||0==this.height||B$O.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),B$O},B$O.isEmpty=function(){return this.width<=0||this.height<=0},B$X(0,B$O,"right",function(){return this.x+this.width}),B$X(0,B$O,"bottom",function(){return this.y+this.height}),B$L._getBoundPointS=function(B$O,B$J,B$D,B$p){var B$m=B$L._temA;return(B$m.length=0)==B$D||0==B$p||B$m.push(B$O,B$J,B$O+B$D,B$J,B$O,B$J+B$p,B$O+B$D,B$J+B$p),B$m},B$L._getWrapRec=function(B$O,B$J){if(!B$O||B$O.length<1)return B$J?B$J.setTo(0,0,0,0):B$L.TEMP.setTo(0,0,0,0);B$J=B$J||new B$L;var B$D,B$p,B$m,B$C,B$i,B$k=B$O.length,B$_=B$e.TEMP;for(B$m=B$i=-(B$p=B$C=99999),B$D=0;B$D<B$k;B$D+=2)B$_.x=B$O[B$D],B$_.y=B$O[B$D+1],B$p=B$p<B$_.x?B$p:B$_.x,B$C=B$C<B$_.y?B$C:B$_.y,B$m=B$m>B$_.x?B$m:B$_.x,B$i=B$i>B$_.y?B$i:B$_.y;return B$J.setTo(B$p,B$C,B$m-B$p,B$i-B$C)},B$L.EMPTY=new B$L,B$L.TEMP=new B$L,B$L._temB=[],B$L._temA=[],B$L}(),B$s=function(){function B$_(){}return B$r(B$_,"laya.media.SoundManager"),B$X(1,B$_,"useAudioMusic",function(){return B$_._useAudioMusic},function(B$O){B$_._useAudioMusic=B$O,B$_._musicClass=B$O?B$DO:null}),B$X(1,B$_,"autoStopMusic",function(){return B$_._autoStopMusic},function(B$O){B$a.stage.off("blur",null,B$_._stageOnBlur),B$a.stage.off("focus",null,B$_._stageOnFocus),B$a.stage.off("visibilitychange",null,B$_._visibilityChange),(B$_._autoStopMusic=B$O)&&(B$a.stage.on("blur",null,B$_._stageOnBlur),B$a.stage.on("focus",null,B$_._stageOnFocus),B$a.stage.on("visibilitychange",null,B$_._visibilityChange))}),B$X(1,B$_,"muted",function(){return B$_._muted},function(B$O){B$O!=B$_._muted&&(B$O&&B$_.stopAllSound(),B$_.musicMuted=B$O,B$_._muted=B$O)}),B$X(1,B$_,"musicMuted",function(){return B$_._musicMuted},function(B$O){B$O!=B$_._musicMuted&&(B$O?(B$_._tMusic&&B$_._musicChannel&&!B$_._musicChannel.isStopped?B$_._musicChannel.pause():B$_._musicChannel=null,B$_._musicMuted=B$O):(B$_._musicMuted=B$O,B$_._tMusic&&B$_._musicChannel&&B$_._musicChannel.resume()))}),B$X(1,B$_,"soundMuted",function(){return B$_._soundMuted},function(B$O){B$_._soundMuted=B$O}),B$_.addChannel=function(B$O){0<=B$_._channels.indexOf(B$O)||(B$_._channels.push(B$O),B$_.autoReleaseSound&&0!=B$_._notUsedCount&&B$_._notUsedUrls[B$O.url]&&(delete B$_._notUsedUrls[B$O.url],0==--B$_._notUsedCount&&B$a.timer.clear(B$_,B$_.disposeSoundIfNotUsed)))},B$_.removeChannel=function(B$O){var B$J=B$_._channels,B$D=B$J.indexOf(B$O);if(-1!=B$D&&(B$J.splice(B$D,1),B$_.autoReleaseSound)){var B$p=B$O.url,B$m=B$_.defaultIntervals[B$p]||2e4;if(0<B$m){var B$C=!0;for(B$D=B$J.length-1;0<=B$D;B$D--)if(B$J[B$D].url==B$p){B$C=!1;break}B$C&&(B$_._notUsedUrls[B$p]=Date.now()+B$m,0==B$_._notUsedCount++&&B$a.timer.loop(1e4,B$_,B$_.disposeSoundIfNotUsed))}}},B$_.disposeSoundIfNotUsed=function(){var B$O=B$_._notUsedUrls;if(0!=B$_._notUsedCount){var B$J=Date.now();for(var B$D in B$O)B$J>=B$O[B$D]&&(delete B$O[B$D],--B$_._notUsedCount,B$_.destroySound(B$D));if(0!=B$_._notUsedCount)return}B$a.timer.clear(B$_,B$_.disposeSoundIfNotUsed)},B$_._visibilityChange=function(){B$a.stage.isVisibility?B$_._stageOnFocus():B$_._stageOnBlur()},B$_._stageOnBlur=function(){B$_._isActive=!1,B$_._musicChannel&&(B$_._musicChannel.isStopped||(B$_._blurPaused=!0,B$_._musicChannel.pause())),B$_.stopAllSound(),B$a.stage.once("mousedown",null,B$_._stageOnFocus)},B$_._recoverWebAudio=function(){B$CO.ctx&&"running"!=B$CO.ctx.state&&B$CO.ctx.resume&&B$CO.ctx.resume()},B$_._stageOnFocus=function(){if(B$_._isActive=!0,B$_._recoverWebAudio(),B$a.stage.off("mousedown",null,B$_._stageOnFocus),B$_._blurPaused){var B$O=B$_._musicChannel;B$O&&B$_._music&&B$O.isStopped&&(B$_._blurPaused=!1,B$_._music._disposed?B$_.playMusic(B$O.url,B$O.loops,B$O.startHandler,B$O.completeHandler,B$O.startTime):B$O.audioBuffer?B$O.resume():B$_._music.play(B$O.startTime,B$O.loops,B$O.startHandler,B$O))}},B$_.playSound=function(B$O,B$J,B$D,B$p,B$m,B$C){if(void 0===B$J&&(B$J=1),void 0===B$C&&(B$C=0),!B$O)return null;if(B$_._muted)return null;if(B$_._recoverWebAudio(),B$O==B$_._tMusic){if(B$_._musicMuted)return null}else{if(!B$_._isActive)return null;if(B$_._soundMuted)return null}var B$i,B$k=B$_._pool[B$O];return B$m||(B$m=B$_._soundClass),B$k||((B$k=new B$m).load(B$O),B$_._pool[B$O]=B$k),(B$i=B$k.play(B$C,B$J,B$D))?(B$O==B$_._tMusic&&(B$_._music=B$k,B$_._isActive||(B$_._blurPaused=!0,B$i.pause())),B$i.url=B$O,B$i.volume=B$O==B$_._tMusic?B$_.musicVolume:B$_.soundVolume,B$i.completeHandler=B$p,B$i):null},B$_.destroySound=function(B$O){var B$J=B$_._pool[B$O];B$J&&(delete B$_._pool[B$O],B$J.dispose())},B$_.playMusic=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$J&&(B$J=0),void 0===B$m&&(B$m=0),B$_._tMusic=B$O,B$_._musicChannel&&B$_._musicChannel.stop(),B$_._musicChannel=B$_.playSound(B$O,B$J,B$D,B$p,null,B$m)},B$_.stopSound=function(B$O){for(var B$J,B$D=B$_._channels.length-1;0<=B$D;B$D--)(B$J=B$_._channels[B$D]).url==B$O&&B$J.stop()},B$_.stopAll=function(){B$_._tMusic=null;var B$O=0;for(B$O=B$_._channels.length-1;0<=B$O;B$O--)B$_._channels[B$O].stop()},B$_.stopAllSound=function(){var B$O,B$J=0;for(B$J=B$_._channels.length-1;0<=B$J;B$J--)(B$O=B$_._channels[B$J]).url!=B$_._tMusic&&B$O.stop()},B$_.stopMusic=function(){B$_._musicChannel&&B$_._musicChannel.stop(),B$_._tMusic=null},B$_.setSoundVolume=function(B$O,B$J){if(B$J)B$_._setVolume(B$J,B$O);else{B$_.soundVolume=B$O;var B$D,B$p=0;for(B$p=B$_._channels.length-1;0<=B$p;B$p--)(B$D=B$_._channels[B$p]).url!=B$_._tMusic&&(B$D.volume=B$O)}},B$_.setMusicVolume=function(B$O){B$_.musicVolume=B$O,B$_._setVolume(B$_._tMusic,B$O)},B$_._setVolume=function(B$O,B$J){for(var B$D,B$p=B$_._channels.length-1;0<=B$p;B$p--)(B$D=B$_._channels[B$p]).url==B$O&&(B$D.volume=B$J)},B$_.musicVolume=1,B$_.soundVolume=1,B$_.playbackRate=1,B$_._useAudioMusic=!0,B$_._muted=!1,B$_._soundMuted=!1,B$_._musicMuted=!1,B$_._tMusic=null,B$_._musicChannel=null,B$_._music=null,B$_._channels=[],B$_._autoStopMusic=!1,B$_._blurPaused=!1,B$_._isActive=!0,B$_._soundClass=null,B$_._musicClass=null,B$_.autoReleaseSound=!0,B$_._pool={},B$_.defaultIntervals={},B$_._notUsedUrls={},B$_._notUsedCount=0,B$_}(),B$z=function(){var B$O;function B$D(){}return B$r(B$D,"laya.net.LocalStorage"),B$D.__init__=function(){B$D._baseClass||(B$D._baseClass=B$O).init(),B$D.items=B$D._baseClass.items,B$D.support=B$D._baseClass.support},B$D.setItem=function(B$O,B$J){B$D._baseClass.setItem(B$O,B$J)},B$D.getItem=function(B$O){return B$D._baseClass.getItem(B$O)},B$D.setJSON=function(B$O,B$J){B$D._baseClass.setJSON(B$O,B$J)},B$D.getJSON=function(B$O){return B$D._baseClass.getJSON(B$O)},B$D.removeItem=function(B$O){B$D._baseClass.removeItem(B$O)},B$D.clear=function(){B$D._baseClass.clear()},B$D._baseClass=null,B$D.items=null,B$D.support=!1,B$D.__init$=function(){B$O=function(){function B$D(){}return B$r(B$D,""),B$D.init=function(){try{B$D.support=!0,B$D.items=B$i.localStorage,B$D.setItem("laya","1"),B$D.removeItem("laya")}catch(B$O){B$D.support=!1}B$D.support||console.log("LocalStorage is not supprot or browser is private mode.")},B$D.setItem=function(B$O,B$J){try{B$D.support&&B$D.items.setItem(B$O,B$J)}catch(B$O){console.warn("set localStorage failed",B$O)}},B$D.getItem=function(B$O){return B$D.support?B$D.items.getItem(B$O):null},B$D.setJSON=function(B$O,B$J){try{B$D.support&&B$D.items.setItem(B$O,JSON.stringify(B$J))}catch(B$O){console.warn("set localStorage failed",B$O)}},B$D.getJSON=function(B$O){return JSON.parse(B$D.support?B$D.items.getItem(B$O):null)},B$D.removeItem=function(B$O){B$D.support&&B$D.items.removeItem(B$O)},B$D.clear=function(){B$D.support&&B$D.items.clear()},B$D.items=null,B$D.support=!1,B$D}()},B$D}(),B$o=(function(){function B$p(){}B$r(B$p,"laya.net.ResourceVersion"),B$p.enable=function(B$O,B$J,B$D){void 0===B$D&&(B$D=2),laya.net.ResourceVersion.type=B$D,B$a.loader.load(B$O,B$v.create(null,B$p.onManifestLoaded,[B$J]),null,"json"),B$W.customFormat=B$p.addVersionPrefix},B$p.onManifestLoaded=function(B$O,B$J){B$p.manifest=B$J,B$O.run(),B$J||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},B$p.addVersionPrefix=function(B$O){return B$p.manifest&&B$p.manifest[B$O]?2==B$p.type?B$p.manifest[B$O]:B$p.manifest[B$O]+"/"+B$O:B$O},B$p.FOLDER_VERSION=1,B$p.FILENAME_VERSION=2,B$p.manifest=null,B$p.type=1}(),function(){function B$O(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}B$r(B$O,"laya.net.TTFLoader");var B$J=B$O.prototype;return B$J.load=function(B$O){var B$J=(this._url=B$O).split(".ttf")[0].split("/");this.fontName=B$J[B$J.length-1],B$l.window.conch?this._loadConch():B$l.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},B$J._loadConch=function(){this._http=new B$iO,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},B$J._onHttpLoaded=function(B$O){B$l.window.conch.setFontFaceFromBuffer(this.fontName,B$O),this._clearHttp(),this._complete()},B$J._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},B$J._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},B$J._complete=function(){B$a.timer.clear(this,this._complete),B$a.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},B$J._checkComplete=function(){B$P.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},B$J._loadWithFontFace=function(){var B$O=new B$l.window.FontFace(this.fontName,"url('"+this._url+"')");B$l.window.document.fonts.add(B$O);var B$J=this;B$O.loaded.then(function(){B$J._complete()}),B$O.load()},B$J._createDiv=function(){this._div=B$l.createElement("div"),this._div.innerHTML="laya";var B$O=this._div.style;B$O.fontFamily=this.fontName,B$O.position="absolute",B$O.left="-100px",B$O.top="-100px",B$l.document.body.appendChild(this._div)},B$J._loadWithCSS=function(){var B$O=this,B$J=B$l.createElement("style");B$J.type="text/css",B$l.document.body.appendChild(B$J),B$J.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=B$P.measureText("LayaTTFFont",this._fontTxt).width;var B$D=this;B$J.onload=function(){B$a.timer.once(1e4,B$D,B$O._complete)},B$a.timer.loop(20,this,this._checkComplete),this._createDiv()},B$O._testString="LayaTTFFont",B$O}()),B$W=function(){function B$p(B$O){this._url=null,this._path=null,this._url=B$p.formatURL(B$O),this._path=B$p.getPath(B$O)}B$r(B$p,"laya.net.URL");var B$O=B$p.prototype;return B$X(0,B$O,"path",function(){return this._path}),B$X(0,B$O,"url",function(){return this._url}),B$p.formatURL=function(B$O,B$J){if(!B$O)return"null path";if(0<B$O.indexOf(":"))return B$O;null!=B$p.customFormat&&(B$O=B$p.customFormat(B$O,B$J));var B$D=B$O.charAt(0);if("."===B$D)return B$p.formatRelativePath((B$J||B$p.basePath)+B$O);if("~"===B$D)return B$p.rootPath+B$O.substring(1);if("d"===B$D){if(0===B$O.indexOf("data:image"))return B$O}else if("/"===B$D)return B$O;return(B$J||B$p.basePath)+B$O},B$p.formatRelativePath=function(B$O){for(var B$J=B$O.split("/"),B$D=0,B$p=B$J.length;B$D<B$p;B$D++)".."==B$J[B$D]&&(B$J.splice(B$D-1,2),B$D-=2);return B$J.join("/")},B$p.isAbsolute=function(B$O){return 0<B$O.indexOf(":")||"/"==B$O.charAt(0)},B$p.getPath=function(B$O){var B$J=B$O.lastIndexOf("/");return 0<B$J?B$O.substr(0,B$J+1):""},B$p.getFileName=function(B$O){var B$J=B$O.lastIndexOf("/");return 0<B$J?B$O.substr(B$J+1):B$O},B$p.version={},B$p.basePath="",B$p.rootPath="",B$p.customFormat=function(B$O){var B$J=B$p.version[B$O];return!B$N.isConchApp&&B$J&&(B$O+="?v="+B$J),B$O},B$p}(),B$N=function(){function B$m(B$O,B$J){this._timeId=0;var B$D=B$m._mainCanvas.source.style;B$D.position="absolute",B$D.top=B$D.left="0px",B$D.background="#000000",B$m._mainCanvas.source.id="layaCanvas";var B$p=laya.renders.Render.isWebGL;B$m._mainCanvas.source.width=B$O,B$m._mainCanvas.source.height=B$J,B$p&&B$m.WebGL.init(B$m._mainCanvas,B$O,B$J),B$l.container.appendChild(B$m._mainCanvas.source),(B$m._context=new B$F(B$O,B$J,B$p?null:B$m._mainCanvas)).ctx.setIsMainContext(),B$l.window.requestAnimationFrame(function B$O(B$J){B$l.window.requestAnimationFrame(B$O);B$a.stage._loop()}),B$a.stage.on("visibilitychange",this,this._onVisibilitychange)}B$r(B$m,"laya.renders.Render");var B$O=B$m.prototype;return B$O._onVisibilitychange=function(){B$a.stage.isVisibility?0!=this._timeId&&B$l.window.clearInterval(this._timeId):this._timeId=B$l.window.setInterval(this._enterFrame,1e3)},B$O._enterFrame=function(B$O){B$a.stage._loop()},B$X(1,B$m,"context",function(){return B$m._context}),B$X(1,B$m,"canvas",function(){return B$m._mainCanvas.source}),B$m._context=null,B$m._mainCanvas=null,B$m.WebGL=null,B$m.isConchNode=!1,B$m.isConchApp=!1,B$m.isConchWebGL=!1,B$m.isWebGL=!1,B$m.is3DMode=!1,B$m.optimizeTextureMemory=function(B$O,B$J){return!0},B$m.__init$=function(){B$i.ConchRenderType=B$i.ConchRenderType||1,B$i.ConchRenderType|=B$i.conch?4:0,B$m.isConchNode=5==(5&B$i.ConchRenderType),B$m.isConchApp=4==(4&B$i.ConchRenderType),B$m.isConchWebGL=6==B$i.ConchRenderType},B$m}(),B$F=function(){function B$i(B$O,B$J,B$D){this.x=0,this.y=0,this._drawTexture=function(B$O,B$J,B$D){B$D[0].loaded&&this.ctx.drawTexture(B$D[0],B$D[1],B$D[2],B$D[3],B$D[4],B$O,B$J)},this._fillTexture=function(B$O,B$J,B$D){B$D[0].loaded&&this.ctx.fillTexture(B$D[0],B$D[1]+B$O,B$D[2]+B$J,B$D[3],B$D[4],B$D[5],B$D[6],B$D[7])},this._drawTextureWithTransform=function(B$O,B$J,B$D){B$D[0].loaded&&this.ctx.drawTextureWithTransform(B$D[0],B$D[1],B$D[2],B$D[3],B$D[4],B$D[5],B$O,B$J,B$D[6])},this._fillQuadrangle=function(B$O,B$J,B$D){this.ctx.fillQuadrangle(B$D[0],B$D[1],B$D[2],B$D[3],B$D[4])},this._drawRect=function(B$O,B$J,B$D){var B$p=this.ctx;null!=B$D[4]&&(B$p.fillStyle=B$D[4],B$p.fillRect(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3],null)),null!=B$D[5]&&(B$p.strokeStyle=B$D[5],B$p.lineWidth=B$D[6],B$p.strokeRect(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3],B$D[6]))},this._drawPie=function(B$O,B$J,B$D){var B$p=this.ctx;B$N.isWebGL&&B$p.setPathId(B$D[8]),B$p.beginPath(),B$N.isWebGL?(B$p.movePath(B$D[0]+B$O,B$D[1]+B$J),B$p.moveTo(0,0)):B$p.moveTo(B$O+B$D[0],B$J+B$D[1]),B$p.arc(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3],B$D[4]),B$p.closePath(),this._fillAndStroke(B$D[5],B$D[6],B$D[7],!0)},this._clipRect=function(B$O,B$J,B$D){this.ctx.clipRect(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3])},this._fillRect=function(B$O,B$J,B$D){this.ctx.fillRect(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3],B$D[4])},this._drawCircle=function(B$O,B$J,B$D){var B$p=this.ctx;B$N.isWebGL&&B$p.setPathId(B$D[6]),B$n.drawCall++,B$p.beginPath(),B$N.isWebGL&&B$p.movePath(B$D[0]+B$O,B$D[1]+B$J),B$p.arc(B$D[0]+B$O,B$D[1]+B$J,B$D[2],0,B$i.PI2),B$p.closePath(),this._fillAndStroke(B$D[3],B$D[4],B$D[5],!0)},this._fillCircle=function(B$O,B$J,B$D){B$n.drawCall++;var B$p=this.ctx;B$p.beginPath(),B$p.fillStyle=B$D[3],B$p.arc(B$D[0]+B$O,B$D[1]+B$J,B$D[2],0,B$i.PI2),B$p.fill()},this._setShader=function(B$O,B$J,B$D){this.ctx.setShader(B$D[0])},this._drawLine=function(B$O,B$J,B$D){var B$p=this.ctx;B$N.isWebGL&&B$p.setPathId(B$D[6]),B$p.beginPath(),B$p.strokeStyle=B$D[4],B$p.lineWidth=B$D[5],B$N.isWebGL?(B$p.movePath(B$O,B$J),B$p.moveTo(B$D[0],B$D[1]),B$p.lineTo(B$D[2],B$D[3])):(B$p.moveTo(B$O+B$D[0],B$J+B$D[1]),B$p.lineTo(B$O+B$D[2],B$J+B$D[3])),B$p.stroke()},this._drawLines=function(B$O,B$J,B$D){var B$p=this.ctx;B$N.isWebGL&&B$p.setPathId(B$D[5]),B$p.beginPath(),B$O+=B$D[0],B$J+=B$D[1],B$N.isWebGL&&B$p.movePath(B$O,B$J),B$p.strokeStyle=B$D[3],B$p.lineWidth=B$D[4];var B$m=B$D[2],B$C=2,B$i=B$m.length;if(B$N.isWebGL)for(B$p.moveTo(B$m[0],B$m[1]);B$C<B$i;)B$p.lineTo(B$m[B$C++],B$m[B$C++]);else for(B$p.moveTo(B$O+B$m[0],B$J+B$m[1]);B$C<B$i;)B$p.lineTo(B$O+B$m[B$C++],B$J+B$m[B$C++]);B$p.stroke()},this._drawLinesWebGL=function(B$O,B$J,B$D){this.ctx.drawLines(B$O+this.x+B$D[0],B$J+this.y+B$D[1],B$D[2],B$D[3],B$D[4])},this._drawCurves=function(B$O,B$J,B$D){this.ctx.drawCurves(B$O,B$J,B$D)},this._draw=function(B$O,B$J,B$D){B$D[0].call(null,this,B$O,B$J)},this._transformByMatrix=function(B$O,B$J,B$D){this.ctx.transformByMatrix(B$D[0])},this._setTransform=function(B$O,B$J,B$D){this.ctx.setTransform(B$D[0],B$D[1],B$D[2],B$D[3],B$D[4],B$D[5])},this._setTransformByMatrix=function(B$O,B$J,B$D){this.ctx.setTransformByMatrix(B$D[0])},this._save=function(B$O,B$J,B$D){this.ctx.save()},this._restore=function(B$O,B$J,B$D){this.ctx.restore()},this._translate=function(B$O,B$J,B$D){this.ctx.translate(B$D[0],B$D[1])},this._transform=function(B$O,B$J,B$D){this.ctx.translate(B$D[1]+B$O,B$D[2]+B$J);var B$p=B$D[0];this.ctx.transform(B$p.a,B$p.b,B$p.c,B$p.d,B$p.tx,B$p.ty),this.ctx.translate(-B$O-B$D[1],-B$J-B$D[2])},this._rotate=function(B$O,B$J,B$D){this.ctx.translate(B$D[1]+B$O,B$D[2]+B$J),this.ctx.rotate(B$D[0]),this.ctx.translate(-B$O-B$D[1],-B$J-B$D[2])},this._scale=function(B$O,B$J,B$D){this.ctx.translate(B$D[2]+B$O,B$D[3]+B$J),this.ctx.scale(B$D[0],B$D[1]),this.ctx.translate(-B$O-B$D[2],-B$J-B$D[3])},this._alpha=function(B$O,B$J,B$D){this.ctx.globalAlpha*=B$D[0]},this._setAlpha=function(B$O,B$J,B$D){this.ctx.globalAlpha=B$D[0]},this._fillText=function(B$O,B$J,B$D){this.ctx.fillText(B$D[0],B$D[1]+B$O,B$D[2]+B$J,B$D[3],B$D[4],B$D[5])},this._strokeText=function(B$O,B$J,B$D){this.ctx.strokeText(B$D[0],B$D[1]+B$O,B$D[2]+B$J,B$D[3],B$D[4],B$D[5],B$D[6])},this._fillBorderText=function(B$O,B$J,B$D){this.ctx.fillBorderText(B$D[0],B$D[1]+B$O,B$D[2]+B$J,B$D[3],B$D[4],B$D[5],B$D[6],B$D[7])},this._blendMode=function(B$O,B$J,B$D){this.ctx.globalCompositeOperation=B$D[0]},this._beginClip=function(B$O,B$J,B$D){this.ctx.beginClip&&this.ctx.beginClip(B$O+B$D[0],B$J+B$D[1],B$D[2],B$D[3])},this._setIBVB=function(B$O,B$J,B$D){this.ctx.setIBVB(B$D[0]+B$O,B$D[1]+B$J,B$D[2],B$D[3],B$D[4],B$D[5],B$D[6],B$D[7])},this._fillTrangles=function(B$O,B$J,B$D){this.ctx.fillTrangles(B$D[0],B$D[1]+B$O,B$D[2]+B$J,B$D[3],B$D[4])},this._drawPath=function(B$O,B$J,B$D){var B$p=this.ctx;B$N.isWebGL&&B$p.setPathId(-1),B$p.beginPath(),B$O+=B$D[0],B$J+=B$D[1],B$N.isWebGL&&B$p.movePath(B$O,B$J);for(var B$m=B$D[2],B$C=0,B$i=B$m.length;B$C<B$i;B$C++){var B$k=B$m[B$C];switch(B$k[0]){case"moveTo":B$N.isWebGL?B$p.moveTo(B$k[1],B$k[2]):B$p.moveTo(B$O+B$k[1],B$J+B$k[2]);break;case"lineTo":B$N.isWebGL?B$p.lineTo(B$k[1],B$k[2]):B$p.lineTo(B$O+B$k[1],B$J+B$k[2]);break;case"arcTo":B$N.isWebGL?B$p.arcTo(B$k[1],B$k[2],B$k[3],B$k[4],B$k[5]):B$p.arcTo(B$O+B$k[1],B$J+B$k[2],B$O+B$k[3],B$J+B$k[4],B$k[5]);break;case"closePath":B$p.closePath()}}var B$_=B$D[3];null!=B$_&&(B$p.fillStyle=B$_.fillStyle,B$p.fill());var B$L=B$D[4];null!=B$L&&(B$p.strokeStyle=B$L.strokeStyle,B$p.lineWidth=B$L.lineWidth||1,B$p.lineJoin=B$L.lineJoin,B$p.lineCap=B$L.lineCap,B$p.miterLimit=B$L.miterLimit,B$p.stroke())},this.drawPoly=function(B$O,B$J,B$D){this.ctx.drawPoly(B$O+this.x+B$D[0],B$J+this.y+B$D[1],B$D[2],B$D[3],B$D[4],B$D[5],B$D[6])},this._drawPoly=function(B$O,B$J,B$D){var B$p=this.ctx,B$m=B$D[2],B$C=2,B$i=B$m.length;if(B$N.isWebGL)for(B$p.setPathId(B$D[6]),B$p.beginPath(),B$O+=B$D[0],B$J+=B$D[1],B$p.movePath(B$O,B$J),B$p.moveTo(B$m[0],B$m[1]);B$C<B$i;)B$p.lineTo(B$m[B$C++],B$m[B$C++]);else for(B$p.beginPath(),B$O+=B$D[0],B$J+=B$D[1],B$p.moveTo(B$O+B$m[0],B$J+B$m[1]);B$C<B$i;)B$p.lineTo(B$O+B$m[B$C++],B$J+B$m[B$C++]);B$p.closePath(),this._fillAndStroke(B$D[3],B$D[4],B$D[5],B$D[7])},this._drawSkin=function(B$O,B$J,B$D){var B$p=B$D[0];if(B$p){var B$m=this.ctx;B$p.render(B$m,B$O,B$J)}},this._drawParticle=function(B$O,B$J,B$D){this.ctx.drawParticle(B$O+this.x,B$J+this.y,B$D[0])},this._setFilters=function(B$O,B$J,B$D){this.ctx.setFilters(B$D)},B$D?this.ctx=B$D.getContext("2d"):(B$D=B$AO.create("3D"),this.ctx=B$P.createWebGLContext2D(B$D),B$D._setContext(this.ctx)),B$D.size(B$O,B$J),this.canvas=B$D}B$r(B$i,"laya.renders.RenderContext");var B$O=B$i.prototype;return B$O.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},B$O.drawTexture=function(B$O,B$J,B$D,B$p,B$m){B$O.loaded&&this.ctx.drawTexture(B$O,B$J,B$D,B$p,B$m,this.x,this.y)},B$O._drawTextures=function(B$O,B$J,B$D){B$D[0].loaded&&this.ctx.drawTextures(B$D[0],B$D[1],B$O+this.x,B$J+this.y)},B$O.drawTextureWithTransform=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$O.loaded&&this.ctx.drawTextureWithTransform(B$O,B$J,B$D,B$p,B$m,B$C,this.x,this.y,B$i)},B$O.fillQuadrangle=function(B$O,B$J,B$D,B$p,B$m){this.ctx.fillQuadrangle(B$O,B$J,B$D,B$p,B$m)},B$O.drawCanvas=function(B$O,B$J,B$D,B$p,B$m){this.ctx.drawCanvas(B$O,B$J+this.x,B$D+this.y,B$p,B$m)},B$O.drawRect=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=1);var B$i=this.ctx;B$i.strokeStyle=B$m,B$i.lineWidth=B$C,B$i.strokeRect(B$O+this.x,B$J+this.y,B$D,B$p,B$C)},B$O._fillAndStroke=function(B$O,B$J,B$D,B$p){void 0===B$p&&(B$p=!1);var B$m=this.ctx;null!=B$O&&(B$m.fillStyle=B$O,B$N.isWebGL?B$m.fill(B$p):B$m.fill()),null!=B$J&&0<B$D&&(B$m.strokeStyle=B$J,B$m.lineWidth=B$D,B$m.stroke())},B$O.clipRect=function(B$O,B$J,B$D,B$p){this.ctx.clipRect(B$O+this.x,B$J+this.y,B$D,B$p)},B$O.fillRect=function(B$O,B$J,B$D,B$p,B$m){this.ctx.fillRect(B$O+this.x,B$J+this.y,B$D,B$p,B$m)},B$O.drawCircle=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=1),B$n.drawCall++;var B$C=this.ctx;B$C.beginPath(),B$C.strokeStyle=B$p,B$C.lineWidth=B$m,B$C.arc(B$O+this.x,B$J+this.y,B$D,0,B$i.PI2),B$C.stroke()},B$O.drawTriangles=function(B$O,B$J,B$D){if(B$N.isWebGL)this.ctx.drawTriangles(B$D[0],B$O+B$D[1],B$J+B$D[2],B$D[3],B$D[4],B$D[5],B$D[6],B$D[7],B$D[8],B$D[9]);else{var B$p=B$D[5],B$m=0,B$C=B$p.length,B$i=this.ctx;for(B$m=0;B$m<B$C;B$m+=3){var B$k=2*B$p[B$m],B$_=2*B$p[B$m+1],B$L=2*B$p[B$m+2];B$i.drawTriangle(B$D[0],B$D[3],B$D[4],B$k,B$_,B$L,B$D[6],!0)}}},B$O.fillCircle=function(B$O,B$J,B$D,B$p){B$n.drawCall++;var B$m=this.ctx;B$m.beginPath(),B$m.fillStyle=B$p,B$m.arc(B$O+this.x,B$J+this.y,B$D,0,B$i.PI2),B$m.fill()},B$O.setShader=function(B$O){this.ctx.setShader(B$O)},B$O.drawLine=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=1);var B$i=this.ctx;B$i.beginPath(),B$i.strokeStyle=B$m,B$i.lineWidth=B$C,B$i.moveTo(this.x+B$O,this.y+B$J),B$i.lineTo(this.x+B$D,this.y+B$p),B$i.stroke()},B$O.clear=function(){this.ctx.clear()},B$O.transformByMatrix=function(B$O){this.ctx.transformByMatrix(B$O)},B$O.setTransform=function(B$O,B$J,B$D,B$p,B$m,B$C){this.ctx.setTransform(B$O,B$J,B$D,B$p,B$m,B$C)},B$O.setTransformByMatrix=function(B$O){this.ctx.setTransformByMatrix(B$O)},B$O.save=function(){this.ctx.save()},B$O.restore=function(){this.ctx.restore()},B$O.translate=function(B$O,B$J){this.ctx.translate(B$O,B$J)},B$O.transform=function(B$O,B$J,B$D,B$p,B$m,B$C){this.ctx.transform(B$O,B$J,B$D,B$p,B$m,B$C)},B$O.rotate=function(B$O){this.ctx.rotate(B$O)},B$O.scale=function(B$O,B$J){this.ctx.scale(B$O,B$J)},B$O.alpha=function(B$O){this.ctx.globalAlpha*=B$O},B$O.setAlpha=function(B$O){this.ctx.globalAlpha=B$O},B$O.fillWords=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$C&&(B$C=0),this.ctx.fillWords(B$O,B$J,B$D,B$p,B$m,B$C)},B$O.fillBorderWords=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this.ctx.fillBorderWords(B$O,B$J,B$D,B$p,B$m,B$C,B$i)},B$O.fillText=function(B$O,B$J,B$D,B$p,B$m,B$C){this.ctx.fillText(B$O,B$J+this.x,B$D+this.y,B$p,B$m,B$C)},B$O.strokeText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this.ctx.strokeText(B$O,B$J+this.x,B$D+this.y,B$p,B$m,B$C,B$i)},B$O.blendMode=function(B$O){this.ctx.globalCompositeOperation=B$O},B$O.flush=function(){this.ctx.flush&&this.ctx.flush()},B$O.addRenderObject=function(B$O){this.ctx.addRenderObject(B$O)},B$O.beginClip=function(B$O,B$J,B$D,B$p){this.ctx.beginClip&&this.ctx.beginClip(B$O,B$J,B$D,B$p)},B$O.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},B$O.fillTrangles=function(B$O,B$J,B$D){this.ctx.fillTrangles(B$D[0],B$D[1],B$D[2],B$D[3],4<B$D.length?B$D[4]:null)},B$i.PI2=2*Math.PI,B$i}(),B$R=function(){function B$i(B$O,B$J){switch(this._next=B$J||B$i.NORENDER,B$O){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=B$y._filter);case 69905:return void(this._fun=B$i._initRenderFun)}this.onCreate(B$O)}B$r(B$i,"laya.renders.RenderSprite");var B$O=B$i.prototype;return B$O.onCreate=function(B$O){},B$O._style=function(B$O,B$J,B$D,B$p){B$O._style.render(B$O,B$J,B$D,B$p);var B$m=this._next;B$m._fun.call(B$m,B$O,B$J,B$D,B$p)},B$O._no=function(B$O,B$J,B$D,B$p){},B$O._custom=function(B$O,B$J,B$D,B$p){B$O.customRender(B$J,B$D,B$p);var B$m=B$O._style._tf;this._next._fun.call(this._next,B$O,B$J,B$D-B$m.translateX,B$p-B$m.translateY)},B$O._clip=function(B$O,B$J,B$D,B$p){var B$m=this._next;if(B$m!=B$i.NORENDER){var B$C=B$O._style.scrollRect;B$J.ctx.save(),B$J.ctx.clipRect(B$D,B$p,B$C.width,B$C.height),B$m._fun.call(B$m,B$O,B$J,B$D-B$C.x,B$p-B$C.y),B$J.ctx.restore()}},B$O._blend=function(B$O,B$J,B$D,B$p){var B$m=B$O._style;B$m.blendMode&&(B$J.ctx.globalCompositeOperation=B$m.blendMode);var B$C=this._next;B$C._fun.call(B$C,B$O,B$J,B$D,B$p),B$J.ctx.globalCompositeOperation="source-over"},B$O._mask=function(B$O,B$J,B$D,B$p){var B$m=this._next;B$m._fun.call(B$m,B$O,B$J,B$D,B$p);var B$C=B$O.mask;B$C&&(B$J.ctx.globalCompositeOperation="destination-in",(0<B$C.numChildren||!B$C.graphics._isOnlyOne())&&(B$C.cacheAsBitmap=!0),B$C.render(B$J,B$D-B$O.pivotX,B$p-B$O.pivotY)),B$J.ctx.globalCompositeOperation="source-over"},B$O._graphics=function(B$O,B$J,B$D,B$p){var B$m=B$O._style._tf;B$O._graphics&&B$O._graphics._render(B$O,B$J,B$D-B$m.translateX,B$p-B$m.translateY);var B$C=this._next;B$C._fun.call(B$C,B$O,B$J,B$D,B$p)},B$O._image=function(B$O,B$J,B$D,B$p){var B$m=B$O._style;B$J.ctx.drawTexture2(B$D,B$p,B$m._tf.translateX,B$m._tf.translateY,B$O.transform,B$m.alpha,B$m.blendMode,B$O._graphics._one)},B$O._image2=function(B$O,B$J,B$D,B$p){var B$m=B$O._style._tf;B$J.ctx.drawTexture2(B$D,B$p,B$m.translateX,B$m.translateY,B$O.transform,1,null,B$O._graphics._one)},B$O._alpha=function(B$O,B$J,B$D,B$p){var B$m;if(.01<(B$m=B$O._style.alpha)||B$O._needRepaint()){var B$C=B$J.ctx.globalAlpha;B$J.ctx.globalAlpha*=B$m;var B$i=this._next;B$i._fun.call(B$i,B$O,B$J,B$D,B$p),B$J.ctx.globalAlpha=B$C}},B$O._transform=function(B$O,B$J,B$D,B$p){var B$m=B$O.transform,B$C=this._next;B$m&&B$C!=B$i.NORENDER?(B$J.save(),B$J.transform(B$m.a,B$m.b,B$m.c,B$m.d,B$m.tx+B$D,B$m.ty+B$p),B$C._fun.call(B$C,B$O,B$J,0,0),B$J.restore()):B$C._fun.call(B$C,B$O,B$J,B$D,B$p)},B$O._childs=function(B$O,B$J,B$D,B$p){var B$m=B$O._style,B$C=B$m._tf;if(B$D=B$D-B$C.translateX+B$m.paddingLeft,B$p=B$p-B$C.translateY+B$m.paddingTop,B$m._calculation){var B$i=B$O._getWords();if(B$i){var B$k=B$m;B$k&&(B$k.stroke?B$J.fillBorderWords(B$i,B$D,B$p,B$k.font,B$k.color,B$k.strokeColor,B$k.stroke):B$J.fillWords(B$i,B$D,B$p,B$k.font,B$k.color,"none"!=B$k.textDecoration&&B$k.underLine?1:0))}}var B$_,B$L=B$O._childs,B$r=B$L.length;if(B$O.viewport||B$O.optimizeScrollRect&&B$O._style.scrollRect){var B$H=B$O.viewport||B$O._style.scrollRect,B$Y=B$H.x,B$G=B$H.y,B$X=B$H.right,B$c=B$H.bottom,B$h=NaN,B$y=NaN;for(B$v=0;B$v<B$r;++B$v)(B$_=B$L[B$v]).visible&&(B$h=B$_._x)<B$X&&B$h+B$_.width>B$Y&&(B$y=B$_._y)<B$c&&B$y+B$_.height>B$G&&B$_.render(B$J,B$D,B$p)}else for(var B$v=0;B$v<B$r;++B$v)(B$_=B$L[B$v])._style.visible&&B$_.render(B$J,B$D,B$p)},B$O._canvas=function(B$O,B$J,B$D,B$p){var B$m=B$O._$P.cacheCanvas;if(B$m){"bitmap"===B$m.type?B$n.canvasBitmap++:B$n.canvasNormal++;var B$C=B$m.ctx;if(B$O._needRepaint()||!B$C)this._canvas_repaint(B$O,B$J,B$D,B$p);else{var B$i=B$m._cacheRec;B$J.drawCanvas(B$C.canvas,B$D+B$i.x,B$p+B$i.y,B$i.width,B$i.height)}}else this._next._fun.call(this._next,B$O,B$J,B$D,B$p)},B$O._canvas_repaint=function(B$O,B$J,B$D,B$p){var B$m=B$O._$P.cacheCanvas,B$C=this._next;if(B$m){var B$i,B$k,B$_,B$L,B$r=B$m.ctx,B$H=B$O._needRepaint()||!B$r,B$Y=B$m.type;if("bitmap"===B$Y?B$n.canvasBitmap++:B$n.canvasNormal++,B$H){var B$G,B$X;B$m._cacheRec||(B$m._cacheRec=new B$t),B$N.isWebGL&&"bitmap"!==B$Y?B$m._cacheRec.setTo(-B$O.pivotX,-B$O.pivotY,1,1):((B$L=B$O.getSelfBounds()).x=B$L.x-B$O.pivotX,B$L.y=B$L.y-B$O.pivotY,B$L.x=B$L.x-16,B$L.y=B$L.y-16,B$L.width=B$L.width+32,B$L.height=B$L.height+32,B$L.x=Math.floor(B$L.x+B$D)-B$D,B$L.y=Math.floor(B$L.y+B$p)-B$p,B$L.width=Math.floor(B$L.width),B$L.height=Math.floor(B$L.height),B$m._cacheRec.copyFrom(B$L)),B$L=B$m._cacheRec;var B$c,B$h=B$N.isWebGL?1:B$l.pixelRatio*B$a.stage.clientScaleX,B$y=B$N.isWebGL?1:B$l.pixelRatio*B$a.stage.clientScaleY;if(!B$N.isWebGL){var B$v,B$A=1,B$q=1;for(B$v=B$O;B$v&&B$v!=B$a.stage;)B$A*=B$v.scaleX,B$q*=B$v.scaleY,B$v=B$v.parent;B$N.isWebGL?(B$A<1&&(B$h*=B$A),B$q<1&&(B$y*=B$q)):(1<B$A&&(B$h*=B$A),1<B$q&&(B$y*=B$q))}if(B$O.scrollRect){var B$d=B$O.scrollRect;B$L.x-=B$d.x,B$L.y-=B$d.y}if(B$G=B$L.width*B$h,B$X=B$L.height*B$y,B$k=B$L.x,B$_=B$L.y,B$N.isWebGL&&"bitmap"===B$Y&&(2048<B$G||2048<B$X))return console.warn("cache bitmap size larger than 2048,cache ignored"),B$m.ctx&&(B$Z.recover("RenderContext",B$m.ctx),B$m.ctx.canvas.size(0,0),B$m.ctx=null),void B$C._fun.call(B$C,B$O,B$J,B$D,B$p);if(B$r||(B$r=B$m.ctx=B$Z.getItem("RenderContext")||new B$F(B$G,B$X,B$AO.create("AUTO"))),B$r.ctx.sprite=B$O,(B$i=B$r.canvas).clear(),(B$i.width!=B$G||B$i.height!=B$X)&&B$i.size(B$G,B$X),"bitmap"===B$Y?B$i.context.asBitmap=!0:"normal"===B$Y&&(B$i.context.asBitmap=!1),1!=B$h||1!=B$y){var B$M=B$r.ctx;B$M.save(),B$M.scale(B$h,B$y),!B$N.isConchWebGL&&B$N.isConchApp&&(B$c=B$O._$P.cf)&&B$M.setFilterMatrix&&B$M.setFilterMatrix(B$c._mat,B$c._alpha),B$C._fun.call(B$C,B$O,B$r,-B$k,-B$_),B$M.restore(),B$N.isConchApp&&!B$N.isConchWebGL||B$O._applyFilters()}else B$M=B$r.ctx,!B$N.isConchWebGL&&B$N.isConchApp&&(B$c=B$O._$P.cf)&&B$M.setFilterMatrix&&B$M.setFilterMatrix(B$c._mat,B$c._alpha),B$C._fun.call(B$C,B$O,B$r,-B$k,-B$_),B$N.isConchApp&&!B$N.isConchWebGL||B$O._applyFilters();B$O._$P.staticCache&&(B$m.reCache=!1),B$n.canvasReCache++}else B$k=(B$L=B$m._cacheRec).x,B$_=B$L.y,B$i=B$r.canvas;B$J.drawCanvas(B$i,B$D+B$k,B$p+B$_,B$L.width,B$L.height)}else B$C._fun.call(B$C,B$O,B$r,B$D,B$p)},B$i.__init__=function(){var B$O,B$J,B$D=0;for(B$J=B$P.createRenderSprite(69905,null),B$O=B$i.renders.length=4096,B$D=0;B$D<B$O;B$D++)B$i.renders[B$D]=B$J;B$i.renders[0]=B$P.createRenderSprite(0,null),function(B$O,B$J){for(var B$D=0,B$p=0;B$p<B$O.length;B$p++)B$D|=B$O[B$p],B$i.renders[B$D]=B$J}([1,512,4,2],new B$i(1,null)),B$i.renders[513]=B$P.createRenderSprite(513,null),B$i.renders[517]=new B$i(517,null)},B$i._initRenderFun=function(B$O,B$J,B$D,B$p){var B$m=B$O._renderType;(B$i.renders[B$m]=B$i._getTypeRender(B$m))._fun(B$O,B$J,B$D,B$p)},B$i._getTypeRender=function(B$O){for(var B$J=null,B$D=2048;1<B$D;)B$D&B$O&&(B$J=B$P.createRenderSprite(B$D,B$J)),B$D>>=1;return B$J},B$i.IMAGE=1,B$i.ALPHA=2,B$i.TRANSFORM=4,B$i.BLEND=8,B$i.CANVAS=16,B$i.FILTERS=32,B$i.MASK=64,B$i.CLIP=128,B$i.STYLE=256,B$i.GRAPHICS=512,B$i.CUSTOM=1024,B$i.CHILDS=2048,B$i.INIT=69905,B$i.renders=[],B$i.NORENDER=new B$i(0,null),B$i}(),B$j=function(){function B$k(){this._repaint=!1}B$r(B$k,"laya.resource.Context");var B$O=B$k.prototype;return B$O.replaceReset=function(){var B$O,B$J,B$D=0;for(B$O=B$k.replaceKeys.length,B$D=0;B$D<B$O;B$D++)B$J=B$k.replaceKeys[B$D],this[B$k.newKeys[B$D]]=this[B$J]},B$O.replaceResotre=function(){this.__restore(),this.__reset()},B$O.setIsMainContext=function(){},B$O.drawTextures=function(B$O,B$J,B$D,B$p){B$n.drawCall+=B$J.length/2;for(var B$m=B$O.width,B$C=B$O.height,B$i=0,B$k=B$J.length;B$i<B$k;B$i+=2)this.drawTexture(B$O,B$J[B$i],B$J[B$i+1],B$m,B$C,B$D,B$p)},B$O.drawCanvas=function(B$O,B$J,B$D,B$p,B$m){B$n.drawCall++,this.drawImage(B$O.source,B$J,B$D,B$p,B$m)},B$O.fillRect=function(B$O,B$J,B$D,B$p,B$m){B$n.drawCall++,B$m&&(this.fillStyle=B$m),this.__fillRect(B$O,B$J,B$D,B$p)},B$O.fillText=function(B$O,B$J,B$D,B$p,B$m,B$C){B$n.drawCall++,3<arguments.length&&null!=B$p&&(this.font=B$p,this.fillStyle=B$m,this.textAlign=B$C,this.textBaseline="top"),this.__fillText(B$O,B$J,B$D)},B$O.fillBorderText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){B$n.drawCall++,this.font=B$p,this.fillStyle=B$m,this.textBaseline="top",this.strokeStyle=B$C,this.lineWidth=B$i,this.textAlign=B$k,this.__strokeText(B$O,B$J,B$D),this.__fillText(B$O,B$J,B$D)},B$O.strokeText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$n.drawCall++,3<arguments.length&&null!=B$p&&(this.font=B$p,this.strokeStyle=B$m,this.lineWidth=B$C,this.textAlign=B$i,this.textBaseline="top"),this.__strokeText(B$O,B$J,B$D)},B$O.transformByMatrix=function(B$O){this.transform(B$O.a,B$O.b,B$O.c,B$O.d,B$O.tx,B$O.ty)},B$O.setTransformByMatrix=function(B$O){this.setTransform(B$O.a,B$O.b,B$O.c,B$O.d,B$O.tx,B$O.ty)},B$O.clipRect=function(B$O,B$J,B$D,B$p){B$n.drawCall++,this.beginPath(),this.rect(B$O,B$J,B$D,B$p),this.clip()},B$O.drawTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$n.drawCall++;var B$k=B$O.uv,B$_=B$O.bitmap.width,B$L=B$O.bitmap.height;this.drawImage(B$O.source,B$k[0]*B$_,B$k[1]*B$L,(B$k[2]-B$k[0])*B$_,(B$k[5]-B$k[3])*B$L,B$J+B$C,B$D+B$i,B$p,B$m)},B$O.drawTextureWithTransform=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){B$n.drawCall++;var B$L=B$O.uv,B$r=B$O.bitmap.width,B$H=B$O.bitmap.height;this.save(),1!=B$_&&(this.globalAlpha*=B$_),B$C?(this.transform(B$C.a,B$C.b,B$C.c,B$C.d,B$C.tx+B$i,B$C.ty+B$k),this.drawImage(B$O.source,B$L[0]*B$r,B$L[1]*B$H,(B$L[2]-B$L[0])*B$r,(B$L[5]-B$L[3])*B$H,B$J,B$D,B$p,B$m)):this.drawImage(B$O.source,B$L[0]*B$r,B$L[1]*B$H,(B$L[2]-B$L[0])*B$r,(B$L[5]-B$L[3])*B$H,B$J+B$i,B$D+B$k,B$p,B$m),this.restore()},B$O.drawTexture2=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=B$k[0];if(B$_.loaded&&B$_.bitmap&&B$_.source){B$n.drawCall++;var B$L=1!==B$C;if(B$L){var B$r=this.globalAlpha;this.globalAlpha*=B$C}var B$H=B$_.uv,B$Y=B$_.bitmap.width,B$G=B$_.bitmap.height;B$m?(this.save(),this.transform(B$m.a,B$m.b,B$m.c,B$m.d,B$m.tx+B$O,B$m.ty+B$J),this.drawImage(B$_.source,B$H[0]*B$Y,B$H[1]*B$G,(B$H[2]-B$H[0])*B$Y,(B$H[5]-B$H[3])*B$G,B$k[1]-B$D,B$k[2]-B$p,B$k[3],B$k[4]),this.restore()):this.drawImage(B$_.source,B$H[0]*B$Y,B$H[1]*B$G,(B$H[2]-B$H[0])*B$Y,(B$H[5]-B$H[3])*B$G,B$k[1]-B$D+B$O,B$k[2]-B$p+B$J,B$k[3],B$k[4]),B$L&&(this.globalAlpha=B$r)}},B$O.fillTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){if(!B$k.pat){if(B$O.uv!=B$rO.DEF_UV){var B$_=new B$AO("2D");B$_.getContext("2d"),B$_.size(B$O.width,B$O.height),B$_.context.drawTexture(B$O,0,0,B$O.width,B$O.height,0,0),B$O=new B$rO(B$_)}B$k.pat=this.createPattern(B$O.bitmap.source,B$C)}var B$L=B$J,B$r=B$D,B$H=0,B$Y=0;B$i&&(B$L+=B$i.x%B$O.width,B$r+=B$i.y%B$O.height,B$H-=B$i.x%B$O.width,B$Y-=B$i.y%B$O.height),this.translate(B$L,B$r),this.fillRect(B$H,B$Y,B$p,B$m,B$k.pat),this.translate(-B$L,-B$r)},B$O.drawTriangle=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=B$O.bitmap,B$L=B$_.source,B$r=B$O.width,B$H=B$O.height,B$Y=B$_.width,B$G=B$_.height,B$X=B$D[B$p]*B$Y,B$c=B$D[B$m]*B$Y,B$h=B$D[B$C]*B$Y,B$y=B$D[B$p+1]*B$G,B$v=B$D[B$m+1]*B$G,B$A=B$D[B$C+1]*B$G,B$q=B$J[B$p],B$d=B$J[B$m],B$M=B$J[B$C],B$a=B$J[B$p+1],B$e=B$J[B$m+1],B$t=B$J[B$C+1];if(B$k){var B$z=(B$q+B$d+B$M)/3,B$g=(B$a+B$e+B$t)/3,B$s=B$q-B$z,B$P=B$a-B$g,B$E=Math.sqrt(B$s*B$s+B$P*B$P);B$q=B$z+B$s/B$E*(B$E+1),B$a=B$g+B$P/B$E*(B$E+1),B$P=B$e-B$g,B$d=B$z+(B$s=B$d-B$z)/(B$E=Math.sqrt(B$s*B$s+B$P*B$P))*(B$E+1),B$e=B$g+B$P/B$E*(B$E+1),B$P=B$t-B$g,B$M=B$z+(B$s=B$M-B$z)/(B$E=Math.sqrt(B$s*B$s+B$P*B$P))*(B$E+1),B$t=B$g+B$P/B$E*(B$E+1)}this.save(),B$i&&this.transform(B$i.a,B$i.b,B$i.c,B$i.d,B$i.tx,B$i.ty),this.beginPath(),this.moveTo(B$q,B$a),this.lineTo(B$d,B$e),this.lineTo(B$M,B$t),this.closePath(),this.clip();var B$o=1/(B$X*B$v+B$y*B$h+B$c*B$A-B$v*B$h-B$y*B$c-B$X*B$A),B$W=B$q*B$v+B$y*B$M+B$d*B$A-B$v*B$M-B$y*B$d-B$q*B$A,B$N=B$X*B$d+B$q*B$h+B$c*B$M-B$d*B$h-B$q*B$c-B$X*B$M,B$F=B$X*B$v*B$M+B$y*B$d*B$h+B$q*B$c*B$A-B$q*B$v*B$h-B$y*B$c*B$M-B$X*B$d*B$A,B$R=B$a*B$v+B$y*B$t+B$e*B$A-B$v*B$t-B$y*B$e-B$a*B$A,B$j=B$X*B$e+B$a*B$h+B$c*B$t-B$e*B$h-B$a*B$c-B$X*B$t,B$u=B$X*B$v*B$t+B$y*B$e*B$h+B$a*B$c*B$A-B$a*B$v*B$h-B$y*B$c*B$t-B$X*B$e*B$A;this.transform(B$W*B$o,B$R*B$o,B$N*B$o,B$j*B$o,B$F*B$o,B$u*B$o),this.drawImage(B$L,B$O.uv[0]*B$Y,B$O.uv[1]*B$G,B$r,B$H,B$O.uv[0]*B$Y,B$O.uv[1]*B$G,B$r,B$H),this.restore()},B$O.flush=function(){return 0},B$O.fillWords=function(B$O,B$J,B$D,B$p,B$m,B$C){B$p&&(this.font=B$p),B$m&&(this.fillStyle=B$m);this.textBaseline="top",this.textAlign="left";for(var B$i=0,B$k=B$O.length;B$i<B$k;B$i++){var B$_=B$O[B$i];if(this.__fillText(B$_.char,B$_.x+B$J,B$_.y+B$D),1===B$C){var B$L=B$_.height,B$r=.5*B$_.style.letterSpacing;B$r||(B$r=0),this.beginPath(),this.strokeStyle=B$m,this.lineWidth=1,this.moveTo(B$J+B$_.x-B$r+.5,B$D+B$_.y+B$L+.5),this.lineTo(B$J+B$_.x+B$_.width+B$r+.5,B$D+B$_.y+B$L+.5),this.stroke()}}},B$O.fillBorderWords=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$p&&(this.font=B$p),B$m&&(this.fillStyle=B$m),this.textBaseline="top",this.lineWidth=B$i,this.textAlign="left",this.strokeStyle=B$C;for(var B$k=0,B$_=B$O.length;B$k<B$_;B$k++){var B$L=B$O[B$k];this.__strokeText(B$L.char,B$L.x+B$J,B$L.y+B$D),this.__fillText(B$L.char,B$L.x+B$J,B$L.y+B$D)}},B$O.destroy=function(){this.canvas.width=this.canvas.height=0},B$O.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},B$O.drawCurves=function(B$O,B$J,B$D){this.beginPath(),this.strokeStyle=B$D[3],this.lineWidth=B$D[4];var B$p=B$D[2];B$O+=B$D[0],B$J+=B$D[1],this.moveTo(B$O+B$p[0],B$J+B$p[1]);for(var B$m=2,B$C=B$p.length;B$m<B$C;)this.quadraticCurveTo(B$O+B$p[B$m++],B$J+B$p[B$m++],B$O+B$p[B$m++],B$J+B$p[B$m++]);this.stroke()},B$k.__init__=function(B$J){var B$D=laya.resource.Context.prototype;if(!(B$J=B$J||CanvasRenderingContext2D.prototype).inited){B$J.inited=!0,B$J.__fillText=B$J.fillText,B$J.__fillRect=B$J.fillRect,B$J.__strokeText=B$J.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(B$O){B$J[B$O]=B$D[B$O]})}},B$k.replaceCanvasGetSet=function(B$O,B$J){var B$D=Object.getOwnPropertyDescriptor(B$O,B$J);if(!B$D||!B$D.configurable)return!1;var B$p,B$m={};for(B$p in B$D)"set"!=B$p&&(B$m[B$p]=B$D[B$p]);var B$C=B$D.set;return B$m.set=function(B$O){B$C.call(this,B$O);var B$J=this.getContext("2d");B$J&&"__reset"in B$J&&B$J.__reset()},Object.defineProperty(B$O,B$J,B$m),!0},B$k.replaceGetSet=function(B$O,B$J){var B$D=Object.getOwnPropertyDescriptor(B$O,B$J);if(!B$D||!B$D.configurable)return!1;var B$p,B$m={};for(B$p in B$D)"set"!=B$p&&(B$m[B$p]=B$D[B$p]);var B$C=B$D.set,B$i="___"+B$J+"__";return B$k.newKeys.push(B$i),B$m.set=function(B$O){B$O!=this[B$i]&&(this[B$i]=B$O,B$C.call(this,B$O))},Object.defineProperty(B$O,B$J,B$m),!0},B$k._default=new B$k,B$k.newKeys=[],B$_(B$k,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),B$k}(),B$u=function(){function B$C(B$O){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++B$C._uniqueIDCounter,this._name=B$O||"Content Manager",B$C._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,B$C._resourceManagers.push(this),this._resources=[],this._records={}}B$r(B$C,"laya.resource.ResourceManager");var B$O=B$C.prototype;return B$a.imps(B$O,{"laya.resource.IDispose":!0}),B$O.getResourceByIndex=function(B$O){return this._resources[B$O]},B$O.getResourcesLength=function(){return this._resources.length},B$O.addResource=function(B$O){return B$O.resourceManager&&B$O.resourceManager.removeResource(B$O),-1===this._resources.indexOf(B$O)&&((B$O._resourceManager=this)._resources.push(B$O),this.addRecord(B$O.uri,B$O.__className,B$O.memorySize),this.addSize(B$O.memorySize),!0)},B$O.removeResource=function(B$O){var B$J=this._resources.indexOf(B$O);return-1!==B$J&&(this._resources.splice(B$J,1),B$O._resourceManager=null,this._memorySize-=B$O.memorySize,this.addRecord(B$O.uri,B$O.__className,-B$O.memorySize),!0)},B$O.unload=function(){for(var B$O=this._resources.slice(0,this._resources.length),B$J=0;B$J<B$O.length;B$J++){B$O[B$J].destroy()}B$O.length=0},B$O.dispose=function(){if(this===B$C._systemResourceManager)throw new Error("systemResourceManager不能被释放！");B$C._resourceManagers.splice(B$C._resourceManagers.indexOf(this),1),B$C._isResourceManagersSorted=!1;for(var B$O=this._resources.slice(0,this._resources.length),B$J=0;B$J<B$O.length;B$J++){var B$D=B$O[B$J];B$D.resourceManager.removeResource(B$D),B$D.destroy()}B$O.length=0},B$O.addSize=function(B$O){B$O&&(this.autoRelease&&0<B$O&&this._memorySize+B$O>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=B$O)},B$O.addRecord=function(B$O,B$J,B$D){DEBUG&&B$D&&!B$O&&console.error(B$O,B$J,B$D),B$O&&(this._records.hasOwnProperty(B$J+"|"+B$O)||(this._records[B$J+"|"+B$O]=0),this._records[B$J+"|"+B$O]+=B$D,DEBUG&&this._records[B$J+"|"+B$O]<0&&console.error(B$O,B$J,this._records[B$J+"|"+B$O]))},B$O.garbageCollection=function(B$O){var B$J=this._resources;(B$J=B$J.slice()).sort(function(B$O,B$J){if(!B$O||!B$J)throw new Error("a或b不能为空！");return B$O.released&&B$J.released?0:B$O.released?1:B$J.released?-1:B$O._lastUseFrameCount-B$J._lastUseFrameCount});for(var B$D=B$n.loopCount,B$p=0,B$m=B$J.length;B$p<B$m;B$p++){var B$C=B$J[B$p];if(!(1<B$D-B$C._lastUseFrameCount))return void(this._memorySize>=B$O&&(this._isOverflow=!0));if(B$C.releaseResource(),this._memorySize<B$O)return void(this._isOverflow=!1)}},B$X(0,B$O,"id",function(){return this._id}),B$X(0,B$O,"name",function(){return this._name},function(B$O){!B$O&&""===B$O||this._name===B$O||(this._name=B$O,B$C._isResourceManagersSorted=!1)}),B$X(0,B$O,"memorySize",function(){return this._memorySize}),B$X(0,B$O,"records",function(){return this._records}),B$X(1,B$C,"systemResourceManager",function(){return B$C._systemResourceManager}),B$C.__init__=function(){B$C.currentResourceManager=B$C.systemResourceManager},B$C.getLoadedResourceManagerByIndex=function(B$O){return B$C._resourceManagers[B$O]},B$C.getLoadedResourceManagersCount=function(){return B$C._resourceManagers.length},B$C.recreateContentManagers=function(B$O){void 0===B$O&&(B$O=!1);for(var B$J=B$C.currentResourceManager,B$D=0;B$D<B$C._resourceManagers.length;B$D++){B$C.currentResourceManager=B$C._resourceManagers[B$D];for(var B$p=0;B$p<B$C.currentResourceManager._resources.length;B$p++)B$C.currentResourceManager._resources[B$p].releaseResource(B$O),B$C.currentResourceManager._resources[B$p].activeResource(B$O)}B$C.currentResourceManager=B$J},B$C.releaseContentManagers=function(B$O){void 0===B$O&&(B$O=!1);for(var B$J=B$C.currentResourceManager,B$D=0;B$D<B$C._resourceManagers.length;B$D++){B$C.currentResourceManager=B$C._resourceManagers[B$D];for(var B$p=0;B$p<B$C.currentResourceManager._resources.length;B$p++){var B$m=B$C.currentResourceManager._resources[B$p];!B$m.released&&B$m.releaseResource(B$O)}}B$C.currentResourceManager=B$J},B$C._uniqueIDCounter=0,B$C._isResourceManagersSorted=!1,B$C._resourceManagers=[],B$_(B$C,["_systemResourceManager",function(){return this._systemResourceManager=new B$C("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=B$C._systemResourceManager}]),B$C}(),B$l=(function(){function B$O(){}B$r(B$O,"laya.system.System"),B$O.changeDefinition=function(B$O,B$J){B$a[B$O]=B$J;var B$D=B$O+"=classObj";B$a._runScript(B$D)},B$O.__init__=function(){B$N.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function B$D(){}return B$r(B$D,"laya.utils.Browser"),B$X(1,B$D,"pixelRatio",function(){return B$D.__init__(),-1<B$D.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:B$P.getPixelRatio()}),B$X(1,B$D,"height",function(){return B$D.__init__(),(B$a.stage&&B$a.stage.canvasRotation?B$D.clientWidth:B$D.clientHeight)*B$D.pixelRatio}),B$X(1,B$D,"clientWidth",function(){return B$D.__init__(),B$D.window.innerWidth||B$D.document.body.clientWidth}),B$X(1,B$D,"window",function(){return B$D.__init__(),B$D._window}),B$X(1,B$D,"clientHeight",function(){return B$D.__init__(),B$D.window.innerHeight||B$D.document.body.clientHeight||B$D.document.documentElement.clientHeight}),B$X(1,B$D,"width",function(){return B$D.__init__(),(B$a.stage&&B$a.stage.canvasRotation?B$D.clientHeight:B$D.clientWidth)*B$D.pixelRatio}),B$X(1,B$D,"container",function(){return B$D.__init__(),B$D._container||((B$D._container=B$D.createElement("div")).id="layaContainer",B$D.document.body.appendChild(B$D._container)),B$D._container},function(B$O){B$D._container=B$O}),B$X(1,B$D,"document",function(){return B$D.__init__(),B$D._document}),B$D.__init__=function(){if(!B$D._window){B$D._window=B$P.getWindow(),B$D._document=B$D.window.document,B$D._window.addEventListener("message",function(B$O){laya.utils.Browser._onMessage(B$O)},!1),B$D.document.__createElement=B$D.document.createElement,B$i.requestAnimationFrame=B$i.requestAnimationFrame||B$i.webkitRequestAnimationFrame||B$i.mozRequestAnimationFrame||B$i.oRequestAnimationFrame||B$i.msRequestAnimationFrame||function(B$O){return B$i.setTimeout(B$O,1e3/60)};var B$O=B$i.document.body.style;B$O["-webkit-user-select"]="none",B$O["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",B$D.userAgent=B$D.window.navigator.userAgent,B$D.onIOS=!!(B$D.u=B$D.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),B$D.onMobile=-1<B$D.u.indexOf("Mobile"),B$D.onIPhone=-1<B$D.u.indexOf("iPhone"),B$D.onMac=-1<B$D.u.indexOf("Mac OS X"),B$D.onIPad=-1<B$D.u.indexOf("iPad"),B$D.onAndroid=-1<B$D.u.indexOf("Android")||-1<B$D.u.indexOf("Adr"),B$D.onWP=-1<B$D.u.indexOf("Windows Phone"),B$D.onQQBrowser=-1<B$D.u.indexOf("QQBrowser"),B$D.onMQQBrowser=-1<B$D.u.indexOf("MQQBrowser")||-1<B$D.u.indexOf("Mobile")&&-1<B$D.u.indexOf("QQ"),B$D.onIE=!!B$D.window.ActiveXObject||"ActiveXObject"in B$D.window,B$D.onWeiXin=-1<B$D.u.indexOf("MicroMessenger"),B$D.onPC=!B$D.onMobile,B$D.onSafari=-1<B$D.u.indexOf("Safari"),B$D.onFirefox=-1<B$D.u.indexOf("Firefox"),B$D.onEdge=-1<B$D.u.indexOf("Edge"),B$D.onMiniGame=-1<B$D.u.indexOf("MiniGame"),B$D.onLimixiu=-1<B$D.u.indexOf("limixiu"),B$D.httpProtocol="http:"==B$D.window.location.protocol,B$D.onMiniGame&&null==B$D.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),B$D.webAudioEnabled=!!(B$D.window.AudioContext||B$D.window.webkitAudioContext||B$D.window.mozAudioContext),B$D.soundType=B$D.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",B$mO=B$D.webAudioEnabled?B$CO:B$DO,B$D.webAudioEnabled&&B$CO.initWebAudio(),B$DO._initMusicAudio(),B$D.enableTouch="ontouchstart"in B$i||B$i.DocumentTouch&&B$J instanceof DocumentTouch,B$i.focus(),B$s._soundClass=B$mO,B$s._musicClass=B$DO,B$N._mainCanvas=B$N._mainCanvas||B$AO.create("2D"),B$D.canvas||(B$D.canvas=B$AO.create("2D"),B$D.context=B$D.canvas.getContext("2d"))}},B$D._onMessage=function(B$O){if(B$O.data&&"size"==B$O.data.name){if(B$D.window.innerWidth=B$O.data.width,B$D.window.innerHeight=B$O.data.height,B$D.window.__innerHeight=B$O.data.clientHeight,!B$D.document.createEvent)return void console.warn("no document.createEvent");var B$J=B$D.document.createEvent("HTMLEvents");return B$J.initEvent("resize",!1,!1),void B$D.window.dispatchEvent(B$J)}},B$D.createElement=function(B$O){return B$D.__init__(),B$D.document.__createElement(B$O)},B$D.getElementById=function(B$O){return B$D.__init__(),B$D.document.getElementById(B$O)},B$D.removeElement=function(B$O){B$O&&B$O.parentNode&&B$O.parentNode.removeChild(B$O)},B$D.now=function(){return B$P.now()},B$D._window=null,B$D._document=null,B$D._container=null,B$D.userAgent=null,B$D.u=null,B$D.onIOS=!1,B$D.onMac=!1,B$D.onMobile=!1,B$D.onIPhone=!1,B$D.onIPad=!1,B$D.onAndroid=!1,B$D.onWP=!1,B$D.onQQBrowser=!1,B$D.onMQQBrowser=!1,B$D.onSafari=!1,B$D.onFirefox=!1,B$D.onEdge=!1,B$D.onIE=!1,B$D.onWeiXin=!1,B$D.onMiniGame=!1,B$D.onLimixiu=!1,B$D.onPC=!1,B$D.httpProtocol=!1,B$D.webAudioEnabled=!1,B$D.soundType=null,B$D.enableTouch=!1,B$D.canvas=null,B$D.context=null,B$D.__init$=function(){},B$D}()),B$$=function(){function B$J(B$O){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,B$O?(this._u8d_=new Uint8Array(B$O),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}B$r(B$J,"laya.utils.Byte");var B$O=B$J.prototype;return B$O.___resizeBuffer=function(B$J){try{var B$O=new Uint8Array(B$J);null!=this._u8d_&&(this._u8d_.length<=B$J?B$O.set(this._u8d_):B$O.set(this._u8d_.subarray(0,B$J))),this._u8d_=B$O,this._d_=new DataView(B$O.buffer)}catch(B$O){throw"___resizeBuffer err:"+B$J}},B$O.getString=function(){return this.rUTF(this.getUint16())},B$O.getFloat32Array=function(B$O,B$J){var B$D=B$O+B$J;B$D=B$D>this._length?this._length:B$D;var B$p=new Float32Array(this._d_.buffer.slice(B$O,B$D));return this._pos_=B$D,B$p},B$O.getUint8Array=function(B$O,B$J){var B$D=B$O+B$J;B$D=B$D>this._length?this._length:B$D;var B$p=new Uint8Array(this._d_.buffer.slice(B$O,B$D));return this._pos_=B$D,B$p},B$O.getInt16Array=function(B$O,B$J){var B$D=B$O+B$J;B$D=B$D>this._length?this._length:B$D;var B$p=new Int16Array(this._d_.buffer.slice(B$O,B$D));return this._pos_=B$D,B$p},B$O.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var B$O=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,B$O},B$O.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var B$O=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,B$O},B$O.writeFloat32=function(B$O){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,B$O,this._xd_),this._pos_+=4},B$O.writeFloat64=function(B$O){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,B$O,this._xd_),this._pos_+=8},B$O.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var B$O=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,B$O},B$O.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var B$O=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,B$O},B$O.writeInt32=function(B$O){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,B$O,this._xd_),this._pos_+=4},B$O.writeUint32=function(B$O){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,B$O,this._xd_),this._pos_+=4},B$O.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var B$O=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,B$O},B$O.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var B$O=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,B$O},B$O.writeUint16=function(B$O){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,B$O,this._xd_),this._pos_+=2},B$O.writeInt16=function(B$O){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,B$O,this._xd_),this._pos_+=2},B$O.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},B$O.writeUint8=function(B$O){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,B$O),this._pos_++},B$O._getUInt8=function(B$O){return this._d_.getUint8(B$O)},B$O._getUint16=function(B$O){return this._d_.getUint16(B$O,this._xd_)},B$O._getMatrix=function(){return new B$E(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},B$O.rUTF=function(B$O){for(var B$J=[],B$D=this._pos_+B$O,B$p=0,B$m=0,B$C=0,B$i=String.fromCharCode,B$k=this._u8d_;this._pos_<B$D;)(B$p=B$k[this._pos_++])<128?0!=B$p&&B$J.push(B$i(B$p)):B$p<224?B$J.push(B$i((63&B$p)<<6|127&B$k[this._pos_++])):B$p<240?(B$m=B$k[this._pos_++],B$J.push(B$i((31&B$p)<<12|(127&B$m)<<6|127&B$k[this._pos_++]))):(B$m=B$k[this._pos_++],B$C=B$k[this._pos_++],B$J.push(B$i((15&B$p)<<18|(127&B$m)<<12|B$C<<6&127|127&B$k[this._pos_++]))),0;return B$J.join("")},B$O.getCustomString=function(B$O){for(var B$J=[],B$D=0,B$p=0,B$m=0,B$C=String.fromCharCode,B$i=this._u8d_;0<B$O;)if((B$p=B$i[this._pos_])<128)B$J.push(B$C(B$p)),this._pos_++,B$O--;else for(B$D=B$p-128,this._pos_++,B$O-=B$D;0<B$D;)B$p=B$i[this._pos_++],B$m=B$i[this._pos_++],B$J.push(B$C(B$m<<8|B$p)),B$D--;return B$J.join("")},B$O.clear=function(){this._pos_=0,this.length=0},B$O.__getBuffer=function(){return this._d_.buffer},B$O.writeUTFBytes=function(B$O){for(var B$J=0,B$D=(B$O+="").length;B$J<B$D;B$J++){var B$p=B$O.charCodeAt(B$J);B$p<=127?this.writeByte(B$p):B$p<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|B$p>>6,128|63&B$p],this._pos_),this._pos_+=2):B$p<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|B$p>>12,128|B$p>>6&63,128|63&B$p],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|B$p>>18,128|B$p>>12&63,128|B$p>>6&63,128|63&B$p],this._pos_),this._pos_+=4)}},B$O.writeUTFString=function(B$O){var B$J=this.pos;this.writeUint16(1),this.writeUTFBytes(B$O);var B$D=this.pos-B$J-2;if(65536<=B$D)throw"writeUTFString byte len more than 65536";this._d_.setUint16(B$J,B$D,this._xd_)},B$O.readUTFString=function(){return this.readUTFBytes(this.getUint16())},B$O.getUTFString=function(){return this.readUTFString()},B$O.readUTFBytes=function(B$O){if(void 0===B$O&&(B$O=-1),0==B$O)return"";var B$J=this.bytesAvailable;if(B$J<B$O)throw"readUTFBytes error - Out of bounds";return B$O=0<B$O?B$O:B$J,this.rUTF(B$O)},B$O.getUTFBytes=function(B$O){return void 0===B$O&&(B$O=-1),this.readUTFBytes(B$O)},B$O.writeByte=function(B$O){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,B$O),this._pos_+=1},B$O.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},B$O.getByte=function(){return this.readByte()},B$O.ensureWrite=function(B$O){this._length<B$O&&(this._length=B$O),this._allocated_<B$O&&(this.length=B$O)},B$O.writeArrayBuffer=function(B$O,B$J,B$D){if(void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),B$J<0||B$D<0)throw"writeArrayBuffer error - Out of bounds";0==B$D&&(B$D=B$O.byteLength-B$J),this.ensureWrite(this._pos_+B$D);var B$p=new Uint8Array(B$O);this._u8d_.set(B$p.subarray(B$J,B$J+B$D),this._pos_),this._pos_+=B$D},B$X(0,B$O,"buffer",function(){var B$O=this._d_.buffer;return B$O.byteLength==this.length?B$O:B$O.slice(0,this.length)}),B$X(0,B$O,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(B$O){this._xd_="littleEndian"==B$O}),B$X(0,B$O,"length",function(){return this._length},function(B$O){this._allocated_<B$O?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(B$O,2*this._allocated_))):this._allocated_>B$O&&this.___resizeBuffer(this._allocated_=B$O),this._length=B$O}),B$X(0,B$O,"pos",function(){return this._pos_},function(B$O){this._pos_=B$O}),B$X(0,B$O,"bytesAvailable",function(){return this._length-this._pos_}),B$J.getSystemEndian=function(){if(!B$J._sysEndian){var B$O=new ArrayBuffer(2);new DataView(B$O).setInt16(0,256,!0),B$J._sysEndian=256===new Int16Array(B$O)[0]?"littleEndian":"bigEndian"}return B$J._sysEndian},B$J.BIG_ENDIAN="bigEndian",B$J.LITTLE_ENDIAN="littleEndian",B$J._sysEndian=null,B$J}(),B$x=function(){function B$m(){}return B$r(B$m,"laya.utils.CacheManager"),B$m.regCacheByFunction=function(B$O,B$J){var B$D;B$m.unRegCacheByFunction(B$O,B$J),B$D={tryDispose:B$O,getCacheList:B$J},B$m._cacheList.push(B$D)},B$m.unRegCacheByFunction=function(B$O,B$J){var B$D,B$p=0;for(B$D=B$m._cacheList.length,B$p=0;B$p<B$D;B$p++)if(B$m._cacheList[B$p].tryDispose==B$O&&B$m._cacheList[B$p].getCacheList==B$J)return void B$m._cacheList.splice(B$p,1)},B$m.forceDispose=function(){var B$O=0,B$J=B$m._cacheList.length;for(B$O=0;B$O<B$J;B$O++)B$m._cacheList[B$O].tryDispose(!0)},B$m.beginCheck=function(B$O){void 0===B$O&&(B$O=15e3),B$a.timer.loop(B$O,null,B$m._checkLoop)},B$m.stopCheck=function(){B$a.timer.clear(null,B$m._checkLoop)},B$m._checkLoop=function(){var B$O=B$m._cacheList;if(!(B$O.length<1)){var B$J,B$D=B$l.now(),B$p=0;for(B$J=B$p=B$O.length;0<B$p&&(B$O[B$m._index=++B$m._index%B$J].tryDispose(!1),!(B$l.now()-B$D>B$m.loopTimeLimit));)B$p--}},B$m.loopTimeLimit=2,B$m._cacheList=[],B$m._index=0,B$m}(),B$V=function(){function B$G(){}return B$r(B$G,"laya.utils.ClassUtils"),B$G.regClass=function(B$O,B$J){B$G._classMap[B$O]=B$J},B$G.getRegClass=function(B$O){return B$G._classMap[B$O]},B$G.getInstance=function(B$O){var B$J=B$G.getClass(B$O);return B$J?new B$J:(console.warn("[error] Undefined class:",B$O),null)},B$G.createByJson=function(B$O,B$J,B$D,B$p,B$m){"string"==typeof B$O&&(B$O=JSON.parse(B$O));var B$C=B$O.props;if(!B$J&&!(B$J=B$m?B$m.runWith(B$O):B$G.getInstance(B$C.runtime||B$O.type)))return null;var B$i=B$O.child;if(B$i)for(var B$k=0,B$_=B$i.length;B$k<B$_;B$k++){var B$L=B$i[B$k];if("render"!==B$L.props.name&&"render"!==B$L.props.renderType||!B$J._$set_itemRender)if("Graphic"==B$L.type)B$G.addGraphicsToSprite(B$L,B$J);else if(B$G.isDrawType(B$L.type))B$G.addGraphicToSprite(B$L,B$J,!0);else{var B$r=B$G.createByJson(B$L,null,B$D,B$p,B$m);"Script"==B$L.type?B$r.hasOwnProperty("owner")?B$r.owner=B$J:B$r.hasOwnProperty("target")&&(B$r.target=B$J):"mask"==B$L.props.renderType?B$J.mask=B$r:B$J.addChild(B$r)}else B$J.itemRender=B$L}if(B$C)for(var B$H in B$C){var B$Y=B$C[B$H];"var"===B$H&&B$D?B$D[B$Y]=B$J:B$Y instanceof Array&&"function"==typeof B$J[B$H]?B$J[B$H].apply(B$J,B$Y):B$J[B$H]=B$Y}return B$p&&B$O.customProps&&B$p.runWith([B$J,B$O]),B$J.created&&B$J.created(),B$J},B$G.addGraphicsToSprite=function(B$O,B$J){var B$D;if((B$D=B$O.child)&&!(B$D.length<1)){var B$p;B$p=B$G._getGraphicsFromSprite(B$O,B$J);var B$m=0,B$C=0;B$O.props&&(B$m=B$G._getObjVar(B$O.props,"x",0),B$C=B$G._getObjVar(B$O.props,"y",0)),0!=B$m&&0!=B$C&&B$p.translate(B$m,B$C);var B$i,B$k=0;for(B$i=B$D.length,B$k=0;B$k<B$i;B$k++)B$G._addGraphicToGraphics(B$D[B$k],B$p);0!=B$m&&0!=B$C&&B$p.translate(-B$m,-B$C)}},B$G.addGraphicToSprite=function(B$O,B$J,B$D){var B$p;void 0===B$D&&(B$D=!1),B$p=B$D?B$G._getGraphicsFromSprite(B$O,B$J):B$J.graphics,B$G._addGraphicToGraphics(B$O,B$p)},B$G._getGraphicsFromSprite=function(B$O,B$J){var B$D,B$p;if(!B$O||!B$O.props)return B$J.graphics;switch(B$p=B$O.props.renderType){case"hit":case"unHit":var B$m;B$J.hitArea||(B$J.hitArea=new B$U),(B$m=B$J.hitArea)[B$p]||(B$m[B$p]=new B$Y),B$D=B$m[B$p]}return B$D||(B$D=B$J.graphics),B$D},B$G._getTransformData=function(B$O){var B$J;(B$O.hasOwnProperty("pivotX")||B$O.hasOwnProperty("pivotY"))&&(B$J=B$J||new B$E).translate(-B$G._getObjVar(B$O,"pivotX",0),-B$G._getObjVar(B$O,"pivotY",0));var B$D=B$G._getObjVar(B$O,"scaleX",1),B$p=B$G._getObjVar(B$O,"scaleY",1),B$m=B$G._getObjVar(B$O,"rotation",0);B$G._getObjVar(B$O,"skewX",0),B$G._getObjVar(B$O,"skewY",0);return 1==B$D&&1==B$p&&0==B$m||((B$J=B$J||new B$E).scale(B$D,B$p),B$J.rotate(.0174532922222222*B$m)),B$J},B$G._addGraphicToGraphics=function(B$O,B$J){var B$D,B$p;if((B$D=B$O.props)&&(B$p=B$G.DrawTypeDic[B$O.type])){var B$m,B$C;B$m=B$J;var B$i=B$G._getParams(B$D,B$p[1],B$p[2],B$p[3]);((B$C=B$G._tM)||1!=B$G._alpha)&&(B$m.save(),B$C&&B$m.transform(B$C),1!=B$G._alpha&&B$m.alpha(B$G._alpha)),B$m[B$p[0]].apply(B$m,B$i),(B$C||1!=B$G._alpha)&&B$m.restore()}},B$G._adptLineData=function(B$O){return B$O[2]=parseFloat(B$O[0])+parseFloat(B$O[2]),B$O[3]=parseFloat(B$O[1])+parseFloat(B$O[3]),B$O},B$G._adptTextureData=function(B$O){return B$O[0]=B$kO.getRes(B$O[0]),B$O},B$G._adptLinesData=function(B$O){return B$O[2]=B$G._getPointListByStr(B$O[2]),B$O},B$G.isDrawType=function(B$O){return"Image"!=B$O&&B$G.DrawTypeDic.hasOwnProperty(B$O)},B$G._getParams=function(B$O,B$J,B$D,B$p){var B$m;void 0===B$D&&(B$D=0),(B$m=B$G._temParam).length=B$J.length;var B$C,B$i,B$k=0;for(B$C=B$J.length,B$k=0;B$k<B$C;B$k++)B$m[B$k]=B$G._getObjVar(B$O,B$J[B$k][0],B$J[B$k][1]);return B$G._alpha=B$G._getObjVar(B$O,"alpha",1),B$i=B$G._getTransformData(B$O),B$G._tM=B$i?(B$D||(B$D=0),B$i.translate(B$m[B$D],B$m[B$D+1]),B$m[B$D]=B$m[B$D+1]=0,B$i):null,B$p&&B$G[B$p]&&(B$m=B$G[B$p](B$m)),B$m},B$G._getPointListByStr=function(B$O){var B$J,B$D,B$p=0;for(B$D=(B$J=B$O.split(",")).length,B$p=0;B$p<B$D;B$p++)B$J[B$p]=parseFloat(B$J[B$p]);return B$J},B$G._getObjVar=function(B$O,B$J,B$D){return B$O.hasOwnProperty(B$J)?B$O[B$J]:B$D},B$G._temParam=[],B$G._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},B$G.getClass=function(B$O){var B$J=B$G._classMap[B$O]||B$O;return"string"==typeof B$J?B$a.__classmap[B$J]:B$J},B$G._tM=null,B$G._alpha=NaN,B$_(B$G,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),B$G}(),B$T=function(){function B$C(B$O){if(this._color=[],"string"==typeof B$O){null===(this.strColor=B$O)&&(B$O="#000000"),"#"==B$O.charAt(0)&&(B$O=B$O.substr(1));var B$J=B$O.length;if(3==B$J||4==B$J){for(var B$D="",B$p=0;B$p<B$J;B$p++)B$D+=B$O[B$p]+B$O[B$p];B$O=B$D}var B$m=this.numColor=parseInt(B$O,16);if(8==B$O.length)return void(this._color=[parseInt(B$O.substr(0,2),16)/255,((16711680&B$m)>>16)/255,((65280&B$m)>>8)/255,(255&B$m)/255])}else B$m=this.numColor=B$O,this.strColor=B$Q.toHexColor(B$m);this._color=[((16711680&B$m)>>16)/255,((65280&B$m)>>8)/255,(255&B$m)/255,1],this._color.__id=++B$C._COLODID}return B$r(B$C,"laya.utils.Color"),B$C._initDefault=function(){for(var B$O in B$C._DEFAULT={},B$C._COLOR_MAP)B$C._SAVE[B$O]=B$C._DEFAULT[B$O]=new B$C(B$C._COLOR_MAP[B$O]);return B$C._DEFAULT},B$C._initSaveMap=function(){for(var B$O in B$C._SAVE_SIZE=0,B$C._SAVE={},B$C._DEFAULT)B$C._SAVE[B$O]=B$C._DEFAULT[B$O]},B$C.create=function(B$O){var B$J=B$C._SAVE[B$O+""];return null!=B$J?B$J:(B$C._SAVE_SIZE<1e3||B$C._initSaveMap(),B$C._SAVE[B$O+""]=new B$C(B$O))},B$C._SAVE={},B$C._SAVE_SIZE=0,B$C._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},B$C._DEFAULT=B$C._initDefault(),B$C._COLODID=1,B$C}(),B$I=(function(){function B$O(){this._values=[],this._keys=[]}B$r(B$O,"laya.utils.Dictionary");var B$J=B$O.prototype;B$J.set=function(B$O,B$J){var B$D=this.indexOf(B$O);0<=B$D?this._values[B$D]=B$J:(this._keys.push(B$O),this._values.push(B$J))},B$J.indexOf=function(B$O){var B$J=this._keys.indexOf(B$O);return 0<=B$J?B$J:(B$O="string"==typeof B$O?Number(B$O):"number"==typeof B$O?B$O.toString():B$O,this._keys.indexOf(B$O))},B$J.get=function(B$O){var B$J=this.indexOf(B$O);return B$J<0?null:this._values[B$J]},B$J.remove=function(B$O){var B$J=this.indexOf(B$O);return 0<=B$J&&(this._keys.splice(B$J,1),this._values.splice(B$J,1),!0)},B$J.clear=function(){this._values.length=0,this._keys.length=0},B$X(0,B$J,"values",function(){return this._values}),B$X(0,B$J,"keys",function(){return this._keys})}(),function(){function B$O(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}B$r(B$O,"laya.utils.Dragging");var B$J=B$O.prototype;return B$J.start=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){void 0===B$k&&(B$k=.92),this.clearTimer(),this.target=B$O,this.area=B$J,this.hasInertia=B$D,this.elasticDistance=B$J?B$p:0,this.elasticBackTime=B$m,this.data=B$C,this._disableMouseEvent=B$i,this.ratio=B$k,1!=B$O.globalScaleX||1!=B$O.globalScaleY?this._parent=B$O.parent:this._parent=B$a.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,B$a.stage.on("mouseup",this,this.onStageMouseUp),B$a.stage.on("mouseout",this,this.onStageMouseUp),B$a.timer.frameLoop(1,this,this.loop)},B$J.clearTimer=function(){B$a.timer.clear(this,this.loop),B$a.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},B$J.stop=function(){this._dragging&&(B$c.instance.disableMouseEvent=!1,B$a.stage.off("mouseup",this,this.onStageMouseUp),B$a.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},B$J.loop=function(){var B$O=this._parent.getMousePoint(),B$J=B$O.x,B$D=B$O.y,B$p=B$J-this._lastX,B$m=B$D-this._lastY;if(this._clickOnly){if(!(1<Math.abs(B$p*B$a.stage._canvasTransform.getScaleX())||1<Math.abs(B$m*B$a.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),B$c.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(B$p,B$m);0==B$p&&0==B$m||(this._lastX=B$J,this._lastY=B$D,this.target.x+=B$p*this._elasticRateX,this.target.y+=B$m*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},B$J.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var B$O=this.area.x-this.target.x;else B$O=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-B$O/this.elasticDistance),this.target.y<this.area.y)var B$J=this.area.y-this.target.y;else B$J=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-B$J/this.elasticDistance)}},B$J.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},B$J.onStageMouseUp=function(B$O){if(B$c.instance.disableMouseEvent=!1,B$a.stage.off("mouseup",this,this.onStageMouseUp),B$a.stage.off("mouseout",this,this.onStageMouseUp),B$a.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var B$J=this._offsets.length,B$D=Math.min(B$J,6),B$p=this._offsets.length-B$D,B$m=B$J-1;B$p<B$m;B$m--)this._offsetY+=this._offsets[B$m--],this._offsetX+=this._offsets[B$m];this._offsetX=this._offsetX/B$D*2,this._offsetY=this._offsetY/B$D*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),B$a.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},B$J.checkElastic=function(){var B$O=NaN,B$J=NaN;if(this.target.x<this.area.x?B$O=this.area.x:this.target.x>this.area.x+this.area.width&&(B$O=this.area.x+this.area.width),this.target.y<this.area.y?B$J=this.area.y:this.target.y>this.area.y+this.area.height&&(B$J=this.area.y+this.area.height),isNaN(B$O)&&isNaN(B$J))this.clear();else{var B$D={};isNaN(B$O)||(B$D.x=B$O),isNaN(B$J)||(B$D.y=B$J),this._tween=B$S.to(this.target,B$D,this.elasticBackTime,B$w.sineOut,B$v.create(this,this.clear),0,!1,!1)}},B$J.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(B$a.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},B$J.clear=function(){if(this.target){this.clearTimer();var B$O=this.target;this.target=null,this._parent=null,B$O.event("dragend",this.data)}},B$O}()),B$w=function(){function B$k(){}return B$r(B$k,"laya.utils.Ease"),B$k.linearNone=function(B$O,B$J,B$D,B$p){return B$D*B$O/B$p+B$J},B$k.linearIn=function(B$O,B$J,B$D,B$p){return B$D*B$O/B$p+B$J},B$k.linearInOut=function(B$O,B$J,B$D,B$p){return B$D*B$O/B$p+B$J},B$k.linearOut=function(B$O,B$J,B$D,B$p){return B$D*B$O/B$p+B$J},B$k.bounceIn=function(B$O,B$J,B$D,B$p){return B$D-B$k.bounceOut(B$p-B$O,0,B$D,B$p)+B$J},B$k.bounceInOut=function(B$O,B$J,B$D,B$p){return B$O<.5*B$p?.5*B$k.bounceIn(2*B$O,0,B$D,B$p)+B$J:.5*B$k.bounceOut(2*B$O-B$p,0,B$D,B$p)+.5*B$D+B$J},B$k.bounceOut=function(B$O,B$J,B$D,B$p){return(B$O/=B$p)<1/2.75?B$D*(7.5625*B$O*B$O)+B$J:B$O<2/2.75?B$D*(7.5625*(B$O-=1.5/2.75)*B$O+.75)+B$J:B$O<2.5/2.75?B$D*(7.5625*(B$O-=2.25/2.75)*B$O+.9375)+B$J:B$D*(7.5625*(B$O-=2.625/2.75)*B$O+.984375)+B$J},B$k.backIn=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=1.70158),B$D*(B$O/=B$p)*B$O*((B$m+1)*B$O-B$m)+B$J},B$k.backInOut=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=1.70158),(B$O/=.5*B$p)<1?.5*B$D*(B$O*B$O*((1+(B$m*=1.525))*B$O-B$m))+B$J:B$D/2*((B$O-=2)*B$O*((1+(B$m*=1.525))*B$O+B$m)+2)+B$J},B$k.backOut=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=1.70158),B$D*((B$O=B$O/B$p-1)*B$O*((B$m+1)*B$O+B$m)+1)+B$J},B$k.elasticIn=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i;return void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=0),0==B$O?B$J:1==(B$O/=B$p)?B$J+B$D:(B$C||(B$C=.3*B$p),B$i=!B$m||0<B$D&&B$m<B$D||B$D<0&&B$m<-B$D?(B$m=B$D,B$C/4):B$C/B$k.PI2*Math.asin(B$D/B$m),-B$m*Math.pow(2,10*(B$O-=1))*Math.sin((B$O*B$p-B$i)*B$k.PI2/B$C)+B$J)},B$k.elasticInOut=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i;return void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=0),0==B$O?B$J:2==(B$O/=.5*B$p)?B$J+B$D:(B$C||(B$C=B$p*(.3*1.5)),B$i=!B$m||0<B$D&&B$m<B$D||B$D<0&&B$m<-B$D?(B$m=B$D,B$C/4):B$C/B$k.PI2*Math.asin(B$D/B$m),B$O<1?B$m*Math.pow(2,10*(B$O-=1))*Math.sin((B$O*B$p-B$i)*B$k.PI2/B$C)*-.5+B$J:B$m*Math.pow(2,-10*(B$O-=1))*Math.sin((B$O*B$p-B$i)*B$k.PI2/B$C)*.5+B$D+B$J)},B$k.elasticOut=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i;return void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=0),0==B$O?B$J:1==(B$O/=B$p)?B$J+B$D:(B$C||(B$C=.3*B$p),B$i=!B$m||0<B$D&&B$m<B$D||B$D<0&&B$m<-B$D?(B$m=B$D,B$C/4):B$C/B$k.PI2*Math.asin(B$D/B$m),B$m*Math.pow(2,-10*B$O)*Math.sin((B$O*B$p-B$i)*B$k.PI2/B$C)+B$D+B$J)},B$k.strongIn=function(B$O,B$J,B$D,B$p){return B$D*(B$O/=B$p)*B$O*B$O*B$O*B$O+B$J},B$k.strongInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*B$D*B$O*B$O*B$O*B$O*B$O+B$J:.5*B$D*((B$O-=2)*B$O*B$O*B$O*B$O+2)+B$J},B$k.strongOut=function(B$O,B$J,B$D,B$p){return B$D*((B$O=B$O/B$p-1)*B$O*B$O*B$O*B$O+1)+B$J},B$k.sineInOut=function(B$O,B$J,B$D,B$p){return.5*-B$D*(Math.cos(Math.PI*B$O/B$p)-1)+B$J},B$k.sineIn=function(B$O,B$J,B$D,B$p){return-B$D*Math.cos(B$O/B$p*B$k.HALF_PI)+B$D+B$J},B$k.sineOut=function(B$O,B$J,B$D,B$p){return B$D*Math.sin(B$O/B$p*B$k.HALF_PI)+B$J},B$k.quintIn=function(B$O,B$J,B$D,B$p){return B$D*(B$O/=B$p)*B$O*B$O*B$O*B$O+B$J},B$k.quintInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*B$D*B$O*B$O*B$O*B$O*B$O+B$J:.5*B$D*((B$O-=2)*B$O*B$O*B$O*B$O+2)+B$J},B$k.quintOut=function(B$O,B$J,B$D,B$p){return B$D*((B$O=B$O/B$p-1)*B$O*B$O*B$O*B$O+1)+B$J},B$k.quartIn=function(B$O,B$J,B$D,B$p){return B$D*(B$O/=B$p)*B$O*B$O*B$O+B$J},B$k.quartInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*B$D*B$O*B$O*B$O*B$O+B$J:.5*-B$D*((B$O-=2)*B$O*B$O*B$O-2)+B$J},B$k.quartOut=function(B$O,B$J,B$D,B$p){return-B$D*((B$O=B$O/B$p-1)*B$O*B$O*B$O-1)+B$J},B$k.cubicIn=function(B$O,B$J,B$D,B$p){return B$D*(B$O/=B$p)*B$O*B$O+B$J},B$k.cubicInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*B$D*B$O*B$O*B$O+B$J:.5*B$D*((B$O-=2)*B$O*B$O+2)+B$J},B$k.cubicOut=function(B$O,B$J,B$D,B$p){return B$D*((B$O=B$O/B$p-1)*B$O*B$O+1)+B$J},B$k.quadIn=function(B$O,B$J,B$D,B$p){return B$D*(B$O/=B$p)*B$O+B$J},B$k.quadInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*B$D*B$O*B$O+B$J:.5*-B$D*(--B$O*(B$O-2)-1)+B$J},B$k.quadOut=function(B$O,B$J,B$D,B$p){return-B$D*(B$O/=B$p)*(B$O-2)+B$J},B$k.expoIn=function(B$O,B$J,B$D,B$p){return 0==B$O?B$J:B$D*Math.pow(2,10*(B$O/B$p-1))+B$J-.001*B$D},B$k.expoInOut=function(B$O,B$J,B$D,B$p){return 0==B$O?B$J:B$O==B$p?B$J+B$D:(B$O/=.5*B$p)<1?.5*B$D*Math.pow(2,10*(B$O-1))+B$J:.5*B$D*(2-Math.pow(2,-10*--B$O))+B$J},B$k.expoOut=function(B$O,B$J,B$D,B$p){return B$O==B$p?B$J+B$D:B$D*(1-Math.pow(2,-10*B$O/B$p))+B$J},B$k.circIn=function(B$O,B$J,B$D,B$p){return-B$D*(Math.sqrt(1-(B$O/=B$p)*B$O)-1)+B$J},B$k.circInOut=function(B$O,B$J,B$D,B$p){return(B$O/=.5*B$p)<1?.5*-B$D*(Math.sqrt(1-B$O*B$O)-1)+B$J:.5*B$D*(Math.sqrt(1-(B$O-=2)*B$O)+1)+B$J},B$k.circOut=function(B$O,B$J,B$D,B$p){return B$D*Math.sqrt(1-(B$O=B$O/B$p-1)*B$O)+B$J},B$k.HALF_PI=.5*Math.PI,B$k.PI2=2*Math.PI,B$k}(),B$U=function(){function B$H(){this._hit=null,this._unHit=null}B$r(B$H,"laya.utils.HitArea");var B$O=B$H.prototype;return B$O.isHit=function(B$O,B$J){return!!B$H.isHitGraphic(B$O,B$J,this.hit)&&!B$H.isHitGraphic(B$O,B$J,this.unHit)},B$O.contains=function(B$O,B$J){return this.isHit(B$O,B$J)},B$X(0,B$O,"hit",function(){return this._hit||(this._hit=new B$Y),this._hit},function(B$O){this._hit=B$O}),B$X(0,B$O,"unHit",function(){return this._unHit||(this._unHit=new B$Y),this._unHit},function(B$O){this._unHit=B$O}),B$H.isHitGraphic=function(B$O,B$J,B$D){if(!B$D)return!1;var B$p;if(!(B$p=B$D.cmds)&&B$D._one&&((B$p=B$H._cmds).length=1,B$p[0]=B$D._one),!B$p)return!1;var B$m,B$C,B$i=0;for(B$m=B$p.length,B$i=0;B$i<B$m;B$i++)if(B$C=B$p[B$i]){var B$k=B$N._context;switch(B$C.callee){case B$k._translate:case 6:B$O-=B$C[0],B$J-=B$C[1]}if(B$H.isHitCmd(B$O,B$J,B$C))return!0}return!1},B$H.isHitCmd=function(B$O,B$J,B$D){if(!B$D)return!1;var B$p=B$N._context,B$m=!1;switch(B$D.callee){case B$p._drawRect:case 13:B$H._rec.setTo(B$D[0],B$D[1],B$D[2],B$D[3]),B$m=B$H._rec.contains(B$O,B$J);break;case B$p._drawCircle:case B$p._fillCircle:case 14:B$m=(B$O-=B$D[0])*B$O+(B$J-=B$D[1])*B$J<B$D[2]*B$D[2];break;case B$p._drawPoly:case 18:B$O-=B$D[0],B$J-=B$D[1],B$m=B$H.ptInPolygon(B$O,B$J,B$D[2])}return B$m},B$H.ptInPolygon=function(B$O,B$J,B$D){var B$p;(B$p=B$H._ptPoint).setTo(B$O,B$J);var B$m,B$C=0,B$i=NaN,B$k=NaN,B$_=NaN,B$L=NaN;B$m=B$D.length;for(var B$r=0;B$r<B$m;B$r+=2){if(B$i=B$D[B$r],B$k=B$D[B$r+1],B$_=B$D[(B$r+2)%B$m],B$k!=(B$L=B$D[(B$r+3)%B$m]))if(!(B$p.y<Math.min(B$k,B$L)))if(!(B$p.y>=Math.max(B$k,B$L)))(B$p.y-B$k)*(B$_-B$i)/(B$L-B$k)+B$i>B$p.x&&B$C++}return B$C%2==1},B$H._cmds=[],B$_(B$H,["_rec",function(){return this._rec=new B$t},"_ptPoint",function(){return this._ptPoint=new B$e}]),B$H}(),B$Z=(function(){function B$m(B$O,B$J,B$D,B$p){this.char=B$O,this.charNum=B$O.charCodeAt(0),this._x=this._y=0,this.width=B$J,this.height=B$D,this.style=B$p,this.isWord=!B$m._isWordRegExp.test(B$O)}B$r(B$m,"laya.utils.HTMLChar");var B$O=B$m.prototype;B$a.imps(B$O,{"laya.display.ILayout":!0}),B$O.setSprite=function(B$O){this._sprite=B$O},B$O.getSprite=function(){return this._sprite},B$O._isChar=function(){return!0},B$O._getCSSStyle=function(){return this.style},B$X(0,B$O,"width",function(){return this._w},function(B$O){this._w=B$O}),B$X(0,B$O,"x",function(){return this._x},function(B$O){this._sprite&&(this._sprite.x=B$O),this._x=B$O}),B$X(0,B$O,"y",function(){return this._y},function(B$O){this._sprite&&(this._sprite.y=B$O),this._y=B$O}),B$X(0,B$O,"height",function(){return this._h},function(B$O){this._h=B$O}),B$m._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function B$J(){}B$r(B$J,"laya.utils.Log"),B$J.enable=function(){B$J._logdiv||(B$J._logdiv=B$l.window.document.createElement("div"),B$l.window.document.body.appendChild(B$J._logdiv),B$J._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},B$J.toggle=function(){var B$O=B$J._logdiv.style;"1px"==B$O.width?B$O.width=B$O.height="50%":B$O.width=B$O.height="1px"},B$J.print=function(B$O){B$J._logdiv&&(B$J.maxCount<=B$J._count&&B$J.clear(),B$J._count++,B$J._logdiv.innerText+=B$O+"\n",B$J._logdiv.scrollTop=B$J._logdiv.scrollHeight)},B$J.clear=function(){B$J._logdiv.innerText="",B$J._count=0},B$J._logdiv=null,B$J._count=0,B$J.maxCount=20}(),function(){function B$J(){}B$r(B$J,"laya.utils.Mouse"),B$X(1,B$J,"cursor",function(){return B$J._style.cursor},function(B$O){B$J._style.cursor=B$O}),B$J.hide=function(){"none"!=B$J.cursor&&(B$J._preCursor=B$J.cursor,B$J.cursor="none")},B$J.show=function(){"none"==B$J.cursor&&(B$J.cursor=B$J._preCursor?B$J._preCursor:"auto")},B$J._preCursor=null,B$_(B$J,["_style",function(){return this._style=B$l.document.body.style}])}(),function(){function B$C(){}return B$r(B$C,"laya.utils.Pool"),B$C.getPoolBySign=function(B$O){return B$C._poolDic[B$O]||(B$C._poolDic[B$O]=[])},B$C.clearBySign=function(B$O){B$C._poolDic[B$O]&&(B$C._poolDic[B$O].length=0)},B$C.recover=function(B$O,B$J){B$J.__InPool||(B$J.__InPool=!0,B$C.getPoolBySign(B$O).push(B$J))},B$C.getItemByClass=function(B$O,B$J){var B$D=B$C.getPoolBySign(B$O),B$p=B$D.length?B$D.pop():new B$J;return B$p.__InPool=!1,B$p},B$C.getItemByCreateFun=function(B$O,B$J,B$D){var B$p=B$C.getPoolBySign(B$O),B$m=B$p.length?B$p.pop():B$J.call(B$D);return B$m.__InPool=!1,B$m},B$C.getItem=function(B$O){var B$J=B$C.getPoolBySign(B$O),B$D=B$J.length?B$J.pop():null;return B$D&&(B$D.__InPool=!1),B$D},B$C._poolDic={},B$C.InPoolSign="__InPool",B$C}()),B$n=function(){function B$_(){}return B$r(B$_,"laya.utils.Stat"),B$X(1,B$_,"onclick",null,function(B$O){B$_._sp&&B$_._sp.on("click",B$_._sp,B$O),B$_._canvas&&(B$_._canvas.source.onclick=B$O,B$_._canvas.source.style.pointerEvents="")}),B$_.show=function(B$O,B$J,B$D){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),!B$N.isConchApp||B$N.isConchWebGL){if(B$N.isConchWebGL||B$l.onMiniGame||B$l.onLimixiu||(B$_._useCanvas=!0),B$_._show=!0,B$_._fpsData.length=60,B$_._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},B$_._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},B$_._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},B$_._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},B$N.isWebGL)if(B$_._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},B$N.is3DMode){if(B$_._view[0].title="FPS(3D)",B$_._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},B$_._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},B$_._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==B$D){var B$p=8;B$_._view[B$p++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},B$_._view[B$p++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},B$_._view[B$p++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==B$D){B$p=8;B$_._view[B$p++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},B$_._view[B$p++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else B$_._view[0].title="FPS(WebGL)",B$_._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else B$_._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};B$_._useCanvas?B$_.createUIPre(B$O,B$J):B$_.createUI(B$O,B$J),B$_.enable()}else B$l.window.conch.showFPS&&B$l.window.conch.showFPS(B$O,B$J)},B$_.createUIPre=function(B$O,B$J){var B$D=B$l.pixelRatio;B$_._width=170*B$D,B$_._vx=75*B$D,B$_._height=B$D*(12*B$_._view.length+3*B$D)+4,B$_._fontSize=12*B$D;for(var B$p=0;B$p<B$_._view.length;B$p++)B$_._view[B$p].x=4,B$_._view[B$p].y=B$p*B$_._fontSize+2*B$D;B$_._canvas||((B$_._canvas=new B$AO("2D")).size(B$_._width,B$_._height),(B$_._ctx=B$_._canvas.getContext("2d")).textBaseline="top",B$_._ctx.font=B$_._fontSize+"px Sans-serif",B$_._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+B$O+"px;top:"+B$J+"px;width:"+B$_._width/B$D+"px;height:"+B$_._height/B$D+"px;"),B$_._first=!0,B$_.loop(),B$_._first=!1,B$l.container.appendChild(B$_._canvas.source)},B$_.createUI=function(B$O,B$J){var B$D=B$_._sp,B$p=B$l.pixelRatio;B$D||(B$D=new B$HO,(B$_._leftText=new B$hO).pos(5,5),B$_._leftText.color="#ffffff",B$D.addChild(B$_._leftText),(B$_._txt=new B$hO).pos(80*B$p,5),B$_._txt.color="#ffffff",B$D.addChild(B$_._txt),B$_._sp=B$D),B$D.pos(B$O,B$J);for(var B$m="",B$C=0;B$C<B$_._view.length;B$C++){B$m+=B$_._view[B$C].title+"\n"}B$_._leftText.text=B$m;var B$i=170*B$p,B$k=B$p*(12*B$_._view.length+3*B$p)+4;B$_._txt.fontSize=B$_._fontSize*B$p,B$_._leftText.fontSize=B$_._fontSize*B$p,B$D.size(B$i,B$k),B$D.graphics.clear(),B$D.graphics.setAlpha(.5),B$D.graphics.drawRect(0,0,B$i,B$k,"#999999"),B$D.graphics.setAlpha(1),B$_.loop()},B$_.enable=function(){B$a.timer.frameLoop(1,B$_,B$_.loop)},B$_.hide=function(){B$_._show=!1,B$a.timer.clear(B$_,B$_.loop),B$_._canvas&&B$l.removeElement(B$_._canvas.source)},B$_.clear=function(){B$_.trianglesFaces=B$_.drawCall=B$_.shaderCall=B$_.spriteCount=B$_.spriteRenderUseCacheCount=B$_.treeNodeCollision=B$_.treeSpriteCollision=B$_.canvasNormal=B$_.canvasBitmap=B$_.canvasReCache=0},B$_.loop=function(){B$_._count++;var B$O=B$l.now();if(!(B$O-B$_._timer<1e3)){var B$J=B$_._count;if(B$_.FPS=Math.round(1e3*B$J/(B$O-B$_._timer)),B$_._show){B$_.trianglesFaces=Math.round(B$_.trianglesFaces/B$J),B$_.spriteCount=B$_._useCanvas?(B$_.drawCall=Math.round(B$_.drawCall/B$J)-2,B$_.shaderCall=Math.round(B$_.shaderCall/B$J),Math.round(B$_.spriteCount/B$J)-1):(B$_.drawCall=Math.round(B$_.drawCall/B$J)-2,B$_.shaderCall=Math.round(B$_.shaderCall/B$J)-4,Math.round(B$_.spriteCount/B$J)-4),B$_.spriteRenderUseCacheCount=Math.round(B$_.spriteRenderUseCacheCount/B$J),B$_.canvasNormal=Math.round(B$_.canvasNormal/B$J),B$_.canvasBitmap=Math.round(B$_.canvasBitmap/B$J),B$_.canvasReCache=Math.ceil(B$_.canvasReCache/B$J),B$_.treeNodeCollision=Math.round(B$_.treeNodeCollision/B$J),B$_.treeSpriteCollision=Math.round(B$_.treeSpriteCollision/B$J);var B$D=0<B$_.FPS?Math.floor(1e3/B$_.FPS).toString():" ";B$_._fpsStr=B$_.FPS+(B$_.renderSlow?" slow":"")+" "+B$D,B$_._spriteStr=B$_.spriteCount+(B$_.spriteRenderUseCacheCount?"/"+B$_.spriteRenderUseCacheCount:""),B$_._canvasStr=B$_.canvasReCache+"/"+B$_.canvasNormal+"/"+B$_.canvasBitmap,B$_.currentMemorySize=B$u.systemResourceManager.memorySize,B$_._useCanvas?B$_.renderInfoPre():B$_.renderInfo(),B$_.clear()}B$_._count=0,B$_._timer=B$O}},B$_.renderInfoPre=function(){if(B$_._canvas){var B$O=B$_._ctx;B$O.clearRect(B$_._first?0:B$_._vx,0,B$_._width,B$_._height);for(var B$J=B$N.WebGL.mainContext,B$D=0;B$D<B$_._view.length;B$D++){var B$p=B$_._view[B$D];B$_._first&&(B$O.fillStyle="white",B$O.fillText(B$p.title,B$p.x,B$p.y,null,null,null)),B$O.fillStyle=B$p.color;var B$m=-1;if((B$p=B$_._view[B$D]).varying){if(B$J)switch(B$p.varying){case 1:B$m=B$J.getParameter(B$J[B$p.value]);break;case 2:B$m=B$J.getExtension(B$p.value)}}else B$m=B$_[B$p.value];"M"==B$p.units&&(B$m=Math.floor(B$m/1048576*100)/100+" M"),"K"==B$p.units&&(B$m=Math.floor(B$m/1024*100)/100+" K"),"string"==B$p.units&&(B$m=B$m.match(/\d+\.?\d/i)),B$O.fillText(B$m+"",B$p.x+B$_._vx,B$p.y,null,null,null)}}},B$_.renderInfo=function(){for(var B$O="",B$J=B$N.WebGL.mainContext,B$D=0;B$D<B$_._view.length;B$D++){var B$p=B$_._view[B$D],B$m=-1;if(B$p.varying){if(B$J)switch(B$p.varying){case 1:B$m=B$J.getParameter(B$J[B$p.value]);break;case 2:B$m=B$J.getExtension(B$p.value)}}else B$m=B$_[B$p.value];"M"==B$p.units&&(B$m=Math.floor(B$m/1048576*100)/100+" M"),"K"==B$p.units&&(B$m=Math.floor(B$m/1024*100)/100+" K"),"string"==B$p.units&&(B$m=B$m.match(/\d+\.?\d/i)),B$O+=B$m+"\n"}B$_._txt.text=B$O},B$_.FPS=0,B$_.loopCount=0,B$_.shaderCall=0,B$_.drawCall=0,B$_.trianglesFaces=0,B$_.spriteCount=0,B$_.spriteRenderUseCacheCount=0,B$_.treeNodeCollision=0,B$_.treeSpriteCollision=0,B$_.canvasNormal=0,B$_.canvasBitmap=0,B$_.canvasReCache=0,B$_.renderSlow=!1,B$_.currentMemorySize=0,B$_._fpsStr=null,B$_._canvasStr=null,B$_._spriteStr=null,B$_._fpsData=[],B$_._timer=0,B$_._count=0,B$_._view=[],B$_._fontSize=12,B$_._txt=null,B$_._leftText=null,B$_._sp=null,B$_._show=!1,B$_._useCanvas=!1,B$_._canvas=null,B$_._ctx=null,B$_._first=!1,B$_._vx=NaN,B$_._width=0,B$_._height=100,B$_}(),B$B=(function(){function B$O(){this._strsToID={},this._idToStrs=[],this._length=0}B$r(B$O,"laya.utils.StringKey");var B$J=B$O.prototype;B$J.add=function(B$O){var B$J=this._strsToID[B$O];return null!=B$J?B$J:(this._idToStrs[this._length]=B$O,this._strsToID[B$O]=this._length++)},B$J.getID=function(B$O){var B$J=this._strsToID[B$O];return null==B$J?-1:B$J},B$J.getName=function(B$O){var B$J=this._idToStrs[B$O];return null==B$J?void 0:B$J}}(),function(){var B$L;function B$O(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}B$r(B$O,"laya.utils.Timer");var B$J=B$O.prototype;return B$J._init=function(){B$a.timer&&B$a.timer.frameLoop(1,this,this._update)},B$J._now=function(){return Date.now()},B$J._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var B$O=this.currFrame=this.currFrame+this.scale,B$J=this._now();this._delta=(B$J-this._lastTimer)*this.scale;var B$D=this.currTimer=this.currTimer+this._delta;B$a.isDebug&&6e4<Math.abs(B$J-this._lastTimer)&&console.error("系统时间错误！"+(B$J-this._lastTimer)),this._lastTimer=B$J;var B$p=this._handlers;for(B$i=this._count=0,B$k=B$p.length;B$i<B$k;B$i++)if(null!==(B$_=B$p[B$i]).method){var B$m=B$_.userFrame?B$O:B$D;if(B$m>=B$_.exeTime)if(B$_.repeat)if(B$_.jumpFrame)for(;B$m>=B$_.exeTime;)B$_.exeTime+=B$_.delay,B$_.run(!1);else B$_.exeTime+=B$_.delay,B$_.run(!1),B$m>B$_.exeTime&&(B$_.exeTime+=Math.ceil((B$m-B$_.exeTime)/B$_.delay)*B$_.delay);else B$_.run(!0)}else this._count++;(30<this._count||B$O%200==0)&&this._clearHandlers();for(var B$C=this._laters,B$i=0,B$k=B$C.length-1;B$i<=B$k;B$i++){var B$_=B$C[B$i];this._isIgnoreRecover(B$_)||(null!==B$_.method&&(delete this._map[B$_.key],B$_.run(!1)),this._recoverHandler(B$_)),B$i===B$k&&(B$k=B$C.length-1)}B$C.length=0}},B$J._clearHandlers=function(){for(var B$O=this._handlers,B$J=0,B$D=B$O.length;B$J<B$D;B$J++){var B$p=B$O[B$J];null!==B$p.method?this._temp.push(B$p):this._isIgnoreRecover(B$p)?this._temp.push(B$p):this._recoverHandler(B$p)}this._handlers=this._temp,this._temp=B$O,this._temp.length=0},B$J._recoverHandler=function(B$O){this._map[B$O.key]==B$O&&delete this._map[B$O.key],B$O.recover()},B$J._create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){if(!B$D)return B$m.apply(B$p,B$C),null;if(B$i){var B$_=this._getHandler(B$p,B$m);if(B$_)return B$_.repeat=B$J,B$_.userFrame=B$O,B$_.delay=B$D,B$_.ignoreRecover=B$k,B$_.caller=B$p,B$_.method=B$m,B$_.args=B$C,B$_.exeTime=B$D+(B$O?this.currFrame:this.currTimer+this._now()-this._lastTimer),B$_}return(B$_=B$L.create()).repeat=B$J,B$_.userFrame=B$O,B$_.delay=B$D,B$_.ignoreRecover=B$k,B$_.caller=B$p,B$_.method=B$m,B$_.args=B$C,B$_.exeTime=B$D+(B$O?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(B$_),this._handlers.push(B$_),B$_},B$J._indexHandler=function(B$O){var B$J=B$O.caller,B$D=B$O.method,B$p=B$J?B$J.$_GID||(B$J.$_GID=B$Q.getGID()):0,B$m=B$D.$_TID||(B$D.$_TID=this._mid++);B$O.key=B$p+"_"+B$m,this._map[B$O.key]=B$O},B$J.once=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=!0),this._create(!1,!1,B$O,B$J,B$D,B$p,B$m,!1)},B$J.loop=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){void 0===B$m&&(B$m=!0),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!1);var B$k=this._create(!1,!0,B$O,B$J,B$D,B$p,B$m,B$i);B$k&&(B$k.jumpFrame=B$C)},B$J.frameOnce=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=!0),this._create(!0,!1,B$O,B$J,B$D,B$p,B$m,!1)},B$J.frameLoop=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$m&&(B$m=!0),void 0===B$C&&(B$C=!1),this._create(!0,!0,B$O,B$J,B$D,B$p,B$m,B$C)},B$J.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+B$L._freeCount},B$J.clear=function(B$O,B$J){var B$D=this._getHandler(B$O,B$J);return!(!B$D||this._isIgnoreRecover(B$D))&&(delete this._map[B$D.key],B$D.key=null,B$D.clear(),!0)},B$J.clearAll=function(B$O){if(B$O)for(var B$J=0,B$D=this._handlers.length;B$J<B$D;B$J++){var B$p=this._handlers[B$J];B$p.caller===B$O&&(this._isIgnoreRecover(B$p)||(delete this._map[B$p.key],B$p.key=null,B$p.clear()))}},B$J._getHandler=function(B$O,B$J){var B$D=B$O?B$O.$_GID||(B$O.$_GID=B$Q.getGID()):0,B$p=B$J.$_TID||(B$J.$_TID=this._mid++);return this._map[B$D+"_"+B$p]},B$J._isIgnoreRecover=function(B$O){if(B$O.ignoreRecover||B$O.caller&&"IgnoreRecover"==B$O.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var B$J="";try{arguments.propertyIsEnumerable.caller}catch(B$O){B$J=B$O.stack}B$a.recordError("报错：核心定时器销毁忽略  "+B$J)}return!0}return!1},B$J.hasHandler=function(B$O,B$J){return this._map[B$O.$_GID+"_"+B$J.$_TID]},B$J.callLater=function(B$O,B$J,B$D){if(null==this._getHandler(B$O,B$J)){var B$p=B$L.create();B$p.caller=B$O,B$p.method=B$J,B$p.args=B$D,this._indexHandler(B$p),this._laters.push(B$p)}},B$J.runCallLater=function(B$O,B$J){var B$D=this._getHandler(B$O,B$J);B$D&&null!=B$D.method&&(this._isIgnoreRecover(B$D)||(delete this._map[B$D.key],B$D.run(!0)))},B$J.runTimer=function(B$O,B$J){this.runCallLater(B$O,B$J)},B$X(0,B$J,"delta",function(){return this._delta}),B$O.__init$=function(){B$L=function(){function B$J(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}B$r(B$J,"");var B$O=B$J.prototype;return B$O.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},B$O.recover=function(){this.clear(),this.args=B$J._freeHandler,B$J._freeHandler=this,B$J._freeCount++},B$O.run=function(B$O){var B$J=this.caller;if(B$J&&B$J.destroyed)return this.clear();var B$D=this.method,B$p=this.args;B$O&&this.clear(),null!=B$D&&(B$p?B$D.apply(B$J,B$p):B$D.call(B$J))},B$J._freeHandler=null,B$J._freeCount=0,B$J.create=function(){var B$O=B$J._freeHandler;return B$O?(B$J._freeHandler=B$O.args,--B$J._freeCount,B$O.args=null,B$O):new B$J},B$J}()},B$O}()),B$S=function(){function B$H(){this.gid=0}B$r(B$H,"laya.utils.Tween");var B$O=B$H.prototype;return B$O.to=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){return void 0===B$C&&(B$C=0),void 0===B$i&&(B$i=!1),this._create(B$O,B$J,B$D,B$p,B$m,B$C,B$i,!0,!1,!0)},B$O.from=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){return void 0===B$C&&(B$C=0),void 0===B$i&&(B$i=!1),this._create(B$O,B$J,B$D,B$p,B$m,B$C,B$i,!1,!1,!0)},B$O._create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){if(!B$O)throw new Error("Tween:target is null");this._target=B$O,this._duration=B$D,this._ease=B$p||B$J.ease||B$H.easeNone,this._complete=B$m||B$J.complete,this._delay=B$C,this._props=[],this._usedTimer=0,this._startTimer=B$l.now(),this._usedPool=B$_,this._delayParam=null,this.update=B$J.update;var B$r=B$O.$_GID||(B$O.$_GID=B$Q.getGID());return B$H.tweenMap[B$r]?(B$i&&B$H.clearTween(B$O),B$H.tweenMap[B$r].push(this)):B$H.tweenMap[B$r]=[this],B$L?B$C<=0?this.firstStart(B$O,B$J,B$k):(this._delayParam=[B$O,B$J,B$k],B$a.scaleTimer.once(B$C,this,this.firstStart,this._delayParam)):this._initProps(B$O,B$J,B$k),this},B$O.firstStart=function(B$O,B$J,B$D){this._delayParam=null,B$O.destroyed?this.clear():(this._initProps(B$O,B$J,B$D),this._beginLoop())},B$O._initProps=function(B$O,B$J,B$D){for(var B$p in B$J)if("number"==typeof B$O[B$p]){var B$m=B$D?B$O[B$p]:B$J[B$p],B$C=B$D?B$J[B$p]:B$O[B$p];this._props.push([B$p,B$m,B$C-B$m]),B$D||(B$O[B$p]=B$m)}},B$O._beginLoop=function(){B$a.scaleTimer.frameLoop(1,this,this._doEase)},B$O._doEase=function(){this._updateEase(B$l.now())},B$O._updateEase=function(B$O){var B$J=this._target;if(B$J){if(B$J.destroyed)return B$H.clearTween(B$J);var B$D=this._usedTimer=B$O-this._startTimer-this._delay;if(!(B$D<0)){if(B$D>=this._duration)return this.complete();for(var B$p=0<B$D?this._ease(B$D,0,1,this._duration):0,B$m=this._props,B$C=0,B$i=B$m.length;B$C<B$i;B$C++){var B$k=B$m[B$C];B$J[B$k[0]]=B$k[1]+B$p*B$k[2]}this.update&&this.update.run()}}},B$O.complete=function(){if(this._target){B$a.scaleTimer.runTimer(this,this.firstStart);for(var B$O=this._target,B$J=this._props,B$D=this._complete,B$p=0,B$m=B$J.length;B$p<B$m;B$p++){var B$C=B$J[B$p];B$O[B$C[0]]=B$C[1]+B$C[2]}this.update&&this.update.run(),this.clear(),B$D&&B$D.run()}},B$O.pause=function(){B$a.scaleTimer.clear(this,this._beginLoop),B$a.scaleTimer.clear(this,this._doEase),B$a.scaleTimer.clear(this,this.firstStart);var B$O;(B$O=B$l.now()-this._startTimer-this._delay)<0&&(this._usedTimer=B$O)},B$O.setStartTime=function(B$O){this._startTimer=B$O},B$O.clear=function(){this._target&&(this._remove(),this._clear())},B$O._clear=function(){this.pause(),B$a.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,B$Z.recover("tween",this))},B$O.recover=function(){this._usedPool=!0,this._clear()},B$O._remove=function(){var B$O=B$H.tweenMap[this._target.$_GID];if(B$O)for(var B$J=0,B$D=B$O.length;B$J<B$D;B$J++)if(B$O[B$J]===this){B$O.splice(B$J,1);break}},B$O.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=B$l.now(),this._delayParam)B$a.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var B$O=this._props,B$J=0,B$D=B$O.length;B$J<B$D;B$J++){var B$p=B$O[B$J];this._target[B$p[0]]=B$p[1]}B$a.scaleTimer.once(this._delay,this,this._beginLoop)}},B$O.resume=function(){this._usedTimer>=this._duration||(this._startTimer=B$l.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?B$a.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},B$X(0,B$O,"progress",null,function(B$O){var B$J=B$O*this._duration;this._startTimer=B$l.now()-this._delay-B$J}),B$H.to=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){return void 0===B$C&&(B$C=0),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=!0),B$Z.getItemByClass("tween",B$H)._create(B$O,B$J,B$D,B$p,B$m,B$C,B$i,!0,B$k,!0)},B$H.from=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){return void 0===B$C&&(B$C=0),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=!0),B$Z.getItemByClass("tween",B$H)._create(B$O,B$J,B$D,B$p,B$m,B$C,B$i,!1,B$k,!0)},B$H.clearAll=function(B$O){if(B$O&&B$O.$_GID){var B$J=B$H.tweenMap[B$O.$_GID];if(B$J){for(var B$D=0,B$p=B$J.length;B$D<B$p;B$D++)B$J[B$D]._clear();B$J.length=0}}},B$H.clear=function(B$O){B$O.clear()},B$H.clearTween=function(B$O){B$H.clearAll(B$O)},B$H.easeNone=function(B$O,B$J,B$D,B$p){return B$D*B$O/B$p+B$J},B$H.tweenMap={},B$H}(),B$Q=function(){function B$k(){}return B$r(B$k,"laya.utils.Utils"),B$k.toRadian=function(B$O){return B$O*B$k._pi2},B$k.toAngle=function(B$O){return B$O*B$k._pi},B$k.toHexColor=function(B$O){if(B$O<0||isNaN(B$O))return null;for(var B$J=B$O.toString(16);B$J.length<6;)B$J="0"+B$J;return"#"+B$J},B$k.getGID=function(){return B$k._gid++},B$k.concatArray=function(B$O,B$J){if(!B$J)return B$O;if(!B$O)return B$J;var B$D=0,B$p=B$J.length;for(B$D=0;B$D<B$p;B$D++)B$O.push(B$J[B$D]);return B$O},B$k.clearArray=function(B$O){return B$O&&(B$O.length=0),B$O},B$k.copyArray=function(B$O,B$J){if(B$O||(B$O=[]),!B$J)return B$O;B$O.length=B$J.length;var B$D=0,B$p=B$J.length;for(B$D=0;B$D<B$p;B$D++)B$O[B$D]=B$J[B$D];return B$O},B$k.getGlobalRecByPoints=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i;return B$C=new B$e(B$J,B$D),B$C=B$O.localToGlobal(B$C),B$i=new B$e(B$p,B$m),B$i=B$O.localToGlobal(B$i),B$t._getWrapRec([B$C.x,B$C.y,B$i.x,B$i.y])},B$k.getGlobalPosAndScale=function(B$O){return B$k.getGlobalRecByPoints(B$O,0,0,1,1)},B$k.bind=function(B$O,B$J){return B$O.bind(B$J)},B$k.measureText=function(B$O,B$J){return B$P.measureText(B$O,B$J)},B$k.contextMeasureText=function(B$O){var B$J=B$l.context.measureText(B$O);return B$J||(B$J={width:16,height:16}),B$J},B$k.updateOrder=function(B$O){if(!B$O||B$O.length<2)return!1;for(var B$J,B$D=1,B$p=0,B$m=B$O.length,B$C=NaN;B$D<B$m;){for(B$J=B$O[B$p=B$D],B$C=B$O[B$p]._zOrder;-1<--B$p&&B$O[B$p]._zOrder>B$C;)B$O[B$p+1]=B$O[B$p];B$O[B$p+1]=B$J,B$D++}var B$i=B$J.parent.conchModel;if(B$i)if(null!=B$i.updateZOrder)B$i.updateZOrder();else{for(B$D=0;B$D<B$m;B$D++)B$i.removeChild(B$O[B$D].conchModel);for(B$D=0;B$D<B$m;B$D++)B$i.addChildAt(B$O[B$D].conchModel,B$D)}return!0},B$k.transPointList=function(B$O,B$J,B$D){var B$p=0,B$m=B$O.length;for(B$p=0;B$p<B$m;B$p+=2)B$O[B$p]+=B$J,B$O[B$p+1]+=B$D},B$k.parseInt=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D=B$l.window.parseInt(B$O,B$J);return isNaN(B$D)?0:B$D},B$k.getFileExtension=function(B$O){B$k._extReg.lastIndex=B$O.lastIndexOf(".");var B$J=B$k._extReg.exec(B$O);return B$J&&1<B$J.length?B$J[1].toLowerCase():null},B$k.getTransformRelativeToWindow=function(B$O,B$J,B$D){var B$p=B$a.stage,B$m=laya.utils.Utils.getGlobalPosAndScale(B$O),B$C=B$p._canvasTransform.clone(),B$i=B$C.tx,B$k=B$C.ty;B$C.rotate(-Math.PI/180*B$a.stage.canvasDegree),B$C.scale(B$a.stage.clientScaleX,B$a.stage.clientScaleY);var B$_=B$a.stage.canvasDegree%180!=0,B$L=NaN,B$r=NaN;B$_?(B$L=B$D+B$m.y,B$r=B$J+B$m.x,B$L*=B$C.d,B$r*=B$C.a,90==B$a.stage.canvasDegree?(B$L=B$i-B$L,B$r+=B$k):(B$L+=B$i,B$r=B$k-B$r)):(B$L=B$J+B$m.x,B$r=B$D+B$m.y,B$L*=B$C.a,B$r*=B$C.d,B$L+=B$i,B$r+=B$k);var B$H=NaN,B$Y=NaN;return B$Y=B$_?(B$H=B$C.d*B$m.height,B$C.a*B$m.width):(B$H=B$C.a*B$m.width,B$C.d*B$m.height),{x:B$L,y:B$r,scaleX:B$H,scaleY:B$Y}},B$k.fitDOMElementInArea=function(B$O,B$J,B$D,B$p,B$m,B$C){B$O._fitLayaAirInitialized||(B$O._fitLayaAirInitialized=!0,B$O.style.transformOrigin=B$O.style.webKittransformOrigin="left top",B$O.style.position="absolute");var B$i=B$k.getTransformRelativeToWindow(B$J,B$D,B$p);B$O.style.transform=B$O.style.webkitTransform="scale("+B$i.scaleX+","+B$i.scaleY+") rotate("+B$a.stage.canvasDegree+"deg)",B$O.style.width=B$m+"px",B$O.style.height=B$C+"px",B$O.style.left=B$i.x+"px",B$O.style.top=B$i.y+"px"},B$k.isOkTextureList=function(B$O){if(!B$O)return!1;var B$J,B$D=0,B$p=B$O.length;for(B$D=0;B$D<B$p;B$D++)if(!(B$J=B$O[B$D])||!B$J.source)return!1;return!0},B$k.isOKCmdList=function(B$O){if(!B$O)return!1;var B$J,B$D,B$p=0,B$m=B$O.length,B$C=B$N._context;for(B$p=0;B$p<B$m;B$p++)switch((B$J=B$O[B$p]).callee){case B$C._drawTexture:case B$C._fillTexture:case B$C._drawTextureWithTransform:if(!(B$D=B$J[0])||!B$D.source)return!1}return!0},B$k._gid=1,B$k._pi=180/Math.PI,B$k._pi2=Math.PI/180,B$k._extReg=/\.(\w+)\??/g,B$k.parseXMLFromString=function(B$O){var B$J;if(B$O=B$O.replace(/>\s+</g,"><"),-1<(B$J=(new DOMParser).parseFromString(B$O,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(B$J.firstChild.firstChild.textContent);return B$J},B$k}(),B$b=function(){function B$O(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],B$N.isWebGL&&B$x.regCacheByFunction(B$Q.bind(this.startDispose,this),B$Q.bind(this.getCacheList,this))}B$r(B$O,"laya.utils.VectorGraphManager");var B$J=B$O.prototype;return B$J.getId=function(){return this._id++},B$J.addShape=function(B$O,B$J){this.shapeDic[B$O]=B$J,this.useDic[B$O]||(this.useDic[B$O]=!0)},B$J.addLine=function(B$O,B$J){this.shapeLineDic[B$O]=B$J,this.shapeLineDic[B$O]||(this.shapeLineDic[B$O]=!0)},B$J.getShape=function(B$O){this._checkKey&&null!=this.useDic[B$O]&&(this.useDic[B$O]=!0)},B$J.deleteShape=function(B$O){this.shapeDic[B$O]&&(this.shapeDic[B$O]=null,delete this.shapeDic[B$O]),this.shapeLineDic[B$O]&&(this.shapeLineDic[B$O]=null,delete this.shapeLineDic[B$O]),null!=this.useDic[B$O]&&delete this.useDic[B$O]},B$J.getCacheList=function(){var B$O,B$J=[];for(B$O in this.shapeDic)B$J.push(this.shapeDic[B$O]);for(B$O in this.shapeLineDic)B$J.push(this.shapeLineDic[B$O]);return B$J},B$J.startDispose=function(B$O){var B$J;for(B$J in this.useDic)this.useDic[B$J]=!1;this._checkKey=!0},B$J.endDispose=function(){if(this._checkKey){var B$O;for(B$O in this.useDic)this.useDic[B$O]||this.deleteShape(B$O);this._checkKey=!1}},B$O.getInstance=function(){return B$O.instance=B$O.instance||new B$O},B$O.instance=null,B$O}(),B$K=function(){function B$p(){this._obj=null,this._obj=B$p.supportWeakMap?new B$l.window.WeakMap:{},B$p.supportWeakMap||B$p._maps.push(this)}B$r(B$p,"laya.utils.WeakObject");var B$O=B$p.prototype;return B$O.set=function(B$O,B$J){if(null!=B$O)if(B$p.supportWeakMap){var B$D=B$O;"string"!=typeof B$O&&"number"!=typeof B$O||(B$D=B$p._keys[B$O])||(B$D=B$p._keys[B$O]={k:B$O}),this._obj.set(B$D,B$J)}else"string"==typeof B$O||"number"==typeof B$O?this._obj[B$O]=B$J:(B$O.$_GID||(B$O.$_GID=B$Q.getGID()),this._obj[B$O.$_GID]=B$J)},B$O.get=function(B$O){if(null==B$O)return null;if(B$p.supportWeakMap){var B$J="string"==typeof B$O||"number"==typeof B$O?B$p._keys[B$O]:B$O;return B$J?this._obj.get(B$J):null}return"string"==typeof B$O||"number"==typeof B$O?this._obj[B$O]:this._obj[B$O.$_GID]},B$O.del=function(B$O){if(null!=B$O)if(B$p.supportWeakMap){var B$J="string"==typeof B$O||"number"==typeof B$O?B$p._keys[B$O]:B$O;if(!B$J)return;this._obj.delete(B$J)}else"string"==typeof B$O||"number"==typeof B$O?delete this._obj[B$O]:delete this._obj[this._obj.$_GID]},B$O.has=function(B$O){if(null==B$O)return!1;if(B$p.supportWeakMap){var B$J="string"==typeof B$O||"number"==typeof B$O?B$p._keys[B$O]:B$O;return this._obj.has(B$J)}return"string"==typeof B$O||"number"==typeof B$O?null!=this._obj[B$O]:null!=this._obj[this._obj.$_GID]},B$p.__init__=function(){(B$p.supportWeakMap=null!=B$l.window.WeakMap)||B$a.timer.loop(B$p.delInterval,null,B$p.clearCache)},B$p.clearCache=function(){for(var B$O=0,B$J=B$p._maps.length;B$O<B$J;B$O++){B$p._maps[B$O]._obj={}}},B$p.supportWeakMap=!1,B$p.delInterval=3e5,B$p._keys={},B$p._maps=[],B$_(B$p,["I",function(){return this.I=new B$p}]),B$p}(),B$f=function(){function B$O(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}B$r(B$O,"laya.utils.WordText");var B$J=B$O.prototype;return B$J.setText=function(B$O){this.changed=!0,this._text=B$O},B$J.toString=function(){return this._text},B$J.charCodeAt=function(B$O){return this._text?this._text.charCodeAt(B$O):NaN},B$J.charAt=function(B$O){return this._text?this._text.charAt(B$O):null},B$X(0,B$J,"length",function(){return this._text?this._text.length:0}),B$O}(),B$OO=function(B$O){function B$i(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,B$i.__super.call(this),this._childs=B$i.ARRAY_EMPTY,this._$P=B$i.PROP_EMPTY,this.timer=B$a.scaleTimer,this.conchModel=B$N.isConchNode?this.createConchModel():null}B$r(B$i,"laya.display.Node",B$L);var B$J=B$i.prototype;return B$J._setBit=function(B$O,B$J){1==B$O&&(this._getBit(B$O)!=B$J&&this._updateDisplayedInstage());B$J?this._bits|=B$O:this._bits&=~B$O},B$J._getBit=function(B$O){return 0!=(this._bits&B$O)},B$J._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},B$J._setUpNoticeType=function(B$O){var B$J=this;for(B$J._setBit(B$O,!0),B$J=B$J.parent;B$J;){if(B$J._getBit(B$O))return;B$J._setBit(B$O,!0),B$J=B$J.parent}},B$J.on=function(B$O,B$J,B$D,B$p){return"display"!==B$O&&"undisplay"!==B$O||this._getBit(1)||this._setUpNoticeType(1),this._createListener(B$O,B$J,B$D,B$p,!1)},B$J.once=function(B$O,B$J,B$D,B$p){return"display"!==B$O&&"undisplay"!==B$O||this._getBit(1)||this._setUpNoticeType(1),this._createListener(B$O,B$J,B$D,B$p,!0)},B$J.createConchModel=function(){return null},B$J.destroy=function(B$O){void 0===B$O&&(B$O=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(B$O?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},B$J.destroyChildren=function(){if(this._childs)for(var B$O=this._childs.length-1;-1<B$O;B$O--)this._childs[B$O].destroy(!0)},B$J.addChild=function(B$O){if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),B$O._parent===this){var B$J=this.getChildIndex(B$O);B$J!==this._childs.length-1&&(this._childs.splice(B$J,1),this._childs.push(B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1)),this._childChanged())}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1),(B$O.parent=this)._childChanged();return B$O},B$J.addChildren=function(B$O){for(var B$J=arguments,B$D=0,B$p=B$J.length;B$D<B$p;)this.addChild(B$J[B$D++])},B$J.addChildAt=function(B$O,B$J){if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),0<=B$J&&B$J<=this._childs.length){if(B$O._parent===this){var B$D=this.getChildIndex(B$O);this._childs.splice(B$D,1),this._childs.splice(B$J,0,B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,B$J)),this._childChanged()}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(B$J,0,B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,B$J),B$O.parent=this;return B$O}throw new Error("appendChildAt:The index is out of bounds")},B$J.getChildIndex=function(B$O){return this._childs.indexOf(B$O)},B$J.getChildByName=function(B$O){var B$J=this._childs;if(B$J)for(var B$D=0,B$p=B$J.length;B$D<B$p;B$D++){var B$m=B$J[B$D];if(B$m.name===B$O)return B$m}return null},B$J._get$P=function(B$O){return this._$P[B$O]},B$J._set$P=function(B$O,B$J){return this.destroyed||(this._$P===B$i.PROP_EMPTY&&(this._$P={}),this._$P[B$O]=B$J),B$J},B$J.getChildAt=function(B$O){return this._childs[B$O]},B$J.setChildIndex=function(B$O,B$J){var B$D=this._childs;if(B$J<0||B$J>=B$D.length)throw new Error("setChildIndex:The index is out of bounds.");var B$p=this.getChildIndex(B$O);if(B$p<0)throw new Error("setChildIndex:node is must child of this object.");return B$D.splice(B$p,1),B$D.splice(B$J,0,B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,B$J)),this._childChanged(),B$O},B$J._childChanged=function(B$O){},B$J.removeChild=function(B$O){if(!this._childs)return B$O;var B$J=this._childs.indexOf(B$O);return this.removeChildAt(B$J)},B$J.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},B$J.removeChildByName=function(B$O){var B$J=this.getChildByName(B$O);return B$J&&this.removeChild(B$J),B$J},B$J.removeChildAt=function(B$O){var B$J=this.getChildAt(B$O);if(B$J){for(var B$D=this._childs.length-1,B$p=B$O;B$p<B$D;++B$p)this._childs[B$p]=this._childs[B$p+1];this._childs.length=B$D,this.conchModel&&this.conchModel.removeChild(B$J.conchModel),B$J.parent=null}return B$J},B$J.removeChildren=function(B$O,B$J){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=2147483647),this._childs&&0<this._childs.length){var B$D=this._childs;if(0===B$O&&B$C<=B$J){var B$p=B$D;this._childs=B$i.ARRAY_EMPTY}else B$p=B$D.splice(B$O,B$J-B$O);for(var B$m=0,B$C=B$p.length;B$m<B$C;B$m++)B$p[B$m].parent=null,this.conchModel&&this.conchModel.removeChild(B$p[B$m].conchModel)}return this},B$J.replaceChild=function(B$O,B$J){var B$D=this._childs.indexOf(B$J);return-1<B$D?(this._childs.splice(B$D,1,B$O),this.conchModel&&(this.conchModel.removeChild(B$J.conchModel),this.conchModel.addChildAt(B$O.conchModel,B$D)),B$J.parent=null,B$O.parent=this,B$O):null},B$J._updateDisplayedInstage=function(){var B$O;B$O=this;var B$J=B$a.stage;for(this._displayedInStage=!1;B$O;){if(B$O._getBit(1)){this._displayedInStage=B$O._displayedInStage;break}if(B$O==B$J||B$O._displayedInStage){this._displayedInStage=!0;break}B$O=B$O.parent}},B$J._setDisplay=function(B$O){this._displayedInStage!==B$O&&((this._displayedInStage=B$O)?this.event("display"):this.event("undisplay"))},B$J._displayChild=function(B$O,B$J){var B$D=B$O._childs;if(B$D)for(var B$p=0;B$p<B$D.length;B$p++){var B$m=B$D[B$p];B$m&&B$m._getBit(1)&&(0<B$m._childs.length?this._displayChild(B$m,B$J):B$m._setDisplay(B$J))}B$O._setDisplay(B$J)},B$J.contains=function(B$O){if(B$O===this)return!0;for(;B$O;){if(B$O.parent===this)return!0;B$O=B$O.parent}return!1},B$J.timerLoop=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$m&&(B$m=!0),void 0===B$C&&(B$C=!1),this.timer.loop(B$O,B$J,B$D,B$p,B$m,B$C)},B$J.timerOnce=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=!0),this.timer._create(!1,!1,B$O,B$J,B$D,B$p,B$m)},B$J.frameLoop=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=!0),this.timer._create(!0,!0,B$O,B$J,B$D,B$p,B$m)},B$J.frameOnce=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=!0),this.timer._create(!0,!1,B$O,B$J,B$D,B$p,B$m)},B$J.clearTimer=function(B$O,B$J){this.timer.clear(B$O,B$J)},B$X(0,B$J,"numChildren",function(){return this._childs.length}),B$X(0,B$J,"destroyed",function(){return this._destroyed}),B$X(0,B$J,"parent",function(){return this._parent},function(B$O){this._parent!==B$O&&(B$O?(this._parent=B$O,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),B$O.displayedInStage&&this._displayChild(this,!0)),B$O._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=B$O))}),B$X(0,B$J,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),B$i.ARRAY_EMPTY=[],B$i.PROP_EMPTY={},B$i.NOTICE_DISPLAY=1,B$i.MOUSEENABLE=2,B$i}(),B$JO=function(B$O){function B$Y(B$O){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,B$Y.__super.call(this),this._padding=B$Y._PADDING,this._spacing=B$Y._SPACING,this._aligns=B$Y._ALIGNS,this._font=B$G.EMPTY,this._ower=B$O}B$r(B$Y,"laya.display.css.CSSStyle",B$O);var B$J=B$Y.prototype;return B$J.destroy=function(){this._ower=null,this._font=null,this._rect=null},B$J.inherit=function(B$O){this._font=B$O._font,this._spacing=B$O._spacing===B$Y._SPACING?B$Y._SPACING:B$O._spacing.slice(),this.lineHeight=B$O.lineHeight},B$J._widthAuto=function(){return 0!=(262144&this._type)},B$J.widthed=function(B$O){return 0!=(8&this._type)},B$J._calculation=function(B$O,B$J){if(B$J.indexOf("%")<0)return!1;var B$p=this._ower,B$m=B$p.parent,B$C=this._rect;function B$i(B$O,B$J,B$D){return B$O*B$D[0]+B$J*B$D[1]+B$D[2]}function B$D(B$O){var B$J=B$m.width,B$D=B$p.width;B$C.width&&(B$p.width=B$i(B$J,B$D,B$C.width)),B$C.height&&(B$p.height=B$i(B$J,B$D,B$C.height)),B$C.left&&(B$p.x=B$i(B$J,B$D,B$C.left)),B$C.top&&(B$p.y=B$i(B$J,B$D,B$C.top))}null===B$C&&(B$m._getCSSStyle()._type|=524288,B$m.on("resize",this,B$D),this._rect=B$C={input:{}});var B$k=B$J.split(" ");return B$k[0]=parseFloat(B$k[0])/100,1==B$k.length?B$k[1]=B$k[2]=0:(B$k[1]=parseFloat(B$k[1])/100,B$k[2]=parseFloat(B$k[2])),B$C[B$O]=B$k,B$C.input[B$O]=B$J,B$D(),!0},B$J.heighted=function(B$O){return 0!=(8192&this._type)},B$J.size=function(B$O,B$J){var B$D=this._ower,B$p=!1;-1!==B$O&&B$O!=this._ower.width&&(this._type|=8,this._ower.width=B$O,B$p=!0),-1!==B$J&&B$J!=this._ower.height&&(this._type|=8192,this._ower.height=B$J,B$p=!0),B$p&&(B$D._layoutLater(),524288&this._type&&B$D.event("resize",this))},B$J._getAlign=function(){return this._aligns[0]},B$J._getValign=function(){return this._aligns[1]},B$J._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},B$J._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new B$G(this._font))},B$J.render=function(B$O,B$J,B$D,B$p){var B$m=B$O.width,B$C=B$O.height;B$D-=B$O.pivotX,B$p-=B$O.pivotY,this._bgground&&null!=this._bgground.color&&B$J.ctx.fillRect(B$D,B$p,B$m,B$C,this._bgground.color),this._border&&this._border.color&&B$J.drawRect(B$D,B$p,B$m,B$C,this._border.color.strColor,this._border.size)},B$J.getCSSStyle=function(){return this},B$J.cssText=function(B$O){this.attrs(B$Y.parseOneCSS(B$O,";"))},B$J.attrs=function(B$O){if(B$O)for(var B$J=0,B$D=B$O.length;B$J<B$D;B$J++){var B$p=B$O[B$J];this[B$p[0]]=B$p[1]}},B$J.setTransform=function(B$O){"none"===B$O?this._tf=B$k._TF_EMPTY:this.attrs(B$Y.parseOneCSS(B$O,","))},B$J.translate=function(B$O,B$J){this._tf===B$k._TF_EMPTY&&(this._tf=new B$m),this._tf.translateX=B$O,this._tf.translateY=B$J},B$J.scale=function(B$O,B$J){this._tf===B$k._TF_EMPTY&&(this._tf=new B$m),this._tf.scaleX=B$O,this._tf.scaleY=B$J},B$J._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},B$X(0,B$J,"block",B$O.prototype._$get_block,function(B$O){B$O?this._type|=1:this._type&=-2}),B$X(0,B$J,"valign",function(){return B$Y._valigndef[this._aligns[1]]},function(B$O){this._aligns===B$Y._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=B$Y._valigndef[B$O]}),B$X(0,B$J,"height",null,function(B$O){if(this._type|=8192,"string"==typeof B$O){if(this._calculation("height",B$O))return;B$O=parseInt(B$O)}this.size(-1,B$O)}),B$X(0,B$J,"width",null,function(B$O){if(this._type|=8,"string"==typeof B$O){var B$J=B$O.indexOf("auto");if(0<=B$J&&(this._type|=262144,B$O=B$O.substr(0,B$J)),this._calculation("width",B$O))return;B$O=parseInt(B$O)}this.size(B$O,-1)}),B$X(0,B$J,"fontWeight",function(){return this._font.weight},function(B$O){this._createFont().weight=B$O}),B$X(0,B$J,"left",null,function(B$O){var B$J=this._ower;if("string"==typeof B$O){if("center"===B$O?B$O="50% -50% 0":"right"===B$O&&(B$O="100% -100% 0"),this._calculation("left",B$O))return;B$O=parseInt(B$O)}B$J.x=B$O}),B$X(0,B$J,"_translate",null,function(B$O){this.translate(B$O[0],B$O[1])}),B$X(0,B$J,"absolute",function(){return 0!=(4&this._type)}),B$X(0,B$J,"top",null,function(B$O){var B$J=this._ower;if("string"==typeof B$O){if("middle"===B$O?B$O="50% -50% 0":"bottom"===B$O&&(B$O="100% -100% 0"),this._calculation("top",B$O))return;B$O=parseInt(B$O)}B$J.y=B$O}),B$X(0,B$J,"align",function(){return B$Y._aligndef[this._aligns[0]]},function(B$O){this._aligns===B$Y._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=B$Y._aligndef[B$O]}),B$X(0,B$J,"bold",function(){return this._font.bold},function(B$O){this._createFont().bold=B$O}),B$X(0,B$J,"padding",function(){return this._padding},function(B$O){this._padding=B$O}),B$X(0,B$J,"leading",function(){return this._spacing[1]},function(B$O){"string"==typeof B$O&&(B$O=parseInt(B$O+"")),this._spacing===B$Y._SPACING&&(this._spacing=[0,0]),this._spacing[1]=B$O}),B$X(0,B$J,"lineElement",function(){return 0!=(65536&this._type)},function(B$O){B$O?this._type|=65536:this._type&=-65537}),B$X(0,B$J,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(B$O){this.lineElement=!1,"right"===B$O?this._type|=32768:this._type&=-32769}),B$X(0,B$J,"textDecoration",function(){return this._font.decoration},function(B$O){this._createFont().decoration=B$O}),B$X(0,B$J,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(B$O){"nowrap"===B$O&&(this._type|=131072),"none"===B$O&&(this._type&=-131073)}),B$X(0,B$J,"background",null,function(B$O){B$O?(this._bgground||(this._bgground={}),this._bgground.color=B$O,this._ower.conchModel&&this._ower.conchModel.bgColor(B$O),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),B$X(0,B$J,"wordWrap",function(){return 0==(131072&this._type)},function(B$O){B$O?this._type&=-131073:this._type|=131072}),B$X(0,B$J,"color",function(){return this._font.color},function(B$O){this._createFont().color=B$O}),B$X(0,B$J,"password",function(){return this._font.password},function(B$O){this._createFont().password=B$O}),B$X(0,B$J,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(B$O){"none"===B$O?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=B$O),this._ower.conchModel&&this._ower.conchModel.bgColor(B$O),this._ower._renderType|=256}),B$X(0,B$J,"font",function(){return this._font.toString()},function(B$O){this._createFont().set(B$O)}),B$X(0,B$J,"weight",null,function(B$O){this._createFont().weight=B$O}),B$X(0,B$J,"letterSpacing",function(){return this._spacing[0]},function(B$O){"string"==typeof B$O&&(B$O=parseInt(B$O+"")),this._spacing===B$Y._SPACING&&(this._spacing=[0,0]),this._spacing[0]=B$O}),B$X(0,B$J,"fontSize",function(){return this._font.size},function(B$O){this._createFont().size=B$O}),B$X(0,B$J,"italic",function(){return this._font.italic},function(B$O){this._createFont().italic=B$O}),B$X(0,B$J,"fontFamily",function(){return this._font.family},function(B$O){this._createFont().family=B$O}),B$X(0,B$J,"stroke",function(){return this._font.stroke[0]},function(B$O){this._createFont().stroke===B$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=B$O}),B$X(0,B$J,"strokeColor",function(){return this._font.stroke[1]},function(B$O){this._createFont().stroke===B$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=B$O}),B$X(0,B$J,"border",function(){return this._border?this._border.value:""},function(B$O){if("none"!=B$O){this._border||(this._border={});var B$J=(this._border.value=B$O).split(" ");if(this._border.color=B$T.create(B$J[B$J.length-1]),1==B$J.length)return this._border.size=1,void(this._border.type="solid");var B$D=0;0<B$J[0].indexOf("px")?(this._border.size=parseInt(B$J[0]),B$D++):this._border.size=1,this._border.type=B$J[B$D],this._ower._renderType|=256}else this._border=null}),B$X(0,B$J,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(B$O){B$O?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==B$O?null:B$T.create(B$O),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),B$X(0,B$J,"position",function(){return 4&this._type?"absolute":""},function(B$O){"absolute"==B$O?this._type|=4:this._type&=-5}),B$X(0,B$J,"display",null,function(B$O){switch(B$O){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),B$X(0,B$J,"paddingLeft",function(){return this.padding[3]}),B$X(0,B$J,"paddingTop",function(){return this.padding[0]}),B$X(0,B$J,"_scale",null,function(B$O){this._ower.scale(B$O[0],B$O[1])}),B$X(0,B$J,"_rotate",null,function(B$O){this._ower.rotation=B$O}),B$Y.parseOneCSS=function(B$O,B$J){for(var B$D,B$p=[],B$m=B$O.split(B$J),B$C=0,B$i=B$m.length;B$C<B$i;B$C++){var B$k=B$m[B$C],B$_=B$k.indexOf(":"),B$L=B$k.substr(0,B$_).replace(/^\s+|\s+$/g,"");if(0!=B$L.length){var B$r=B$k.substr(B$_+1).replace(/^\s+|\s+$/g,""),B$H=[B$L,B$r];switch(B$L){case"italic":case"bold":B$H[1]="true"==B$r;break;case"line-height":B$H[0]="lineHeight",B$H[1]=parseInt(B$r);break;case"font-size":B$H[0]="fontSize",B$H[1]=parseInt(B$r);break;case"padding":1<(B$D=B$r.split(" ")).length||(B$D[1]=B$D[2]=B$D[3]=B$D[0]),B$H[1]=[parseInt(B$D[0]),parseInt(B$D[1]),parseInt(B$D[2]),parseInt(B$D[3])];break;case"rotate":B$H[0]="_rotate",B$H[1]=parseFloat(B$r);break;case"scale":B$D=B$r.split(" "),B$H[0]="_scale",B$H[1]=[parseFloat(B$D[0]),parseFloat(B$D[1])];break;case"translate":B$D=B$r.split(" "),B$H[0]="_translate",B$H[1]=[parseInt(B$D[0]),parseInt(B$D[1])];break;default:(B$H[0]=B$Y._CSSTOVALUE[B$L])||(B$H[0]=B$L)}B$p.push(B$H)}}return B$p},B$Y.parseCSS=function(B$O,B$J){for(var B$D;null!=(B$D=B$Y._parseCSSRegExp.exec(B$O));)B$Y.styleSheets[B$D[1]]=B$Y.parseOneCSS(B$D[2],";")},B$Y.EMPTY=new B$Y(null),B$Y._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},B$Y._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),B$Y._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},B$Y._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},B$Y.styleSheets={},B$Y.ALIGN_CENTER=1,B$Y.ALIGN_RIGHT=2,B$Y.VALIGN_MIDDLE=1,B$Y.VALIGN_BOTTOM=2,B$Y._CSS_BLOCK=1,B$Y._DISPLAY_NONE=2,B$Y._ABSOLUTE=4,B$Y._WIDTH_SET=8,B$Y._PADDING=[0,0,0,0],B$Y._RECT=[-1,-1,-1,-1],B$Y._SPACING=[0,0],B$Y._ALIGNS=[0,0,0],B$Y.ADDLAYOUTED=512,B$Y._NEWFONT=4096,B$Y._HEIGHT_SET=8192,B$Y._BACKGROUND_SET=16384,B$Y._FLOAT_RIGHT=32768,B$Y._LINE_ELEMENT=65536,B$Y._NOWARP=131072,B$Y._WIDTHAUTO=262144,B$Y._LISTERRESZIE=524288,B$Y}(B$k),B$DO=function(B$O){function B$i(){this.url=null,this.audio=null,this.loaded=!1,B$i.__super.call(this)}B$r(B$i,"laya.media.h5audio.AudioSound",B$L);var B$J=B$i.prototype;return B$J.dispose=function(){var B$O=B$i._audioCache[this.url];B$O&&(B$O.src="",delete B$i._audioCache[this.url])},B$J.load=function(B$O){var B$J;if(B$O=B$W.formatURL(B$O),(this.url=B$O)==B$s._tMusic?(B$i._initMusicAudio(),(B$J=B$i._musicAudio).src!=B$O&&(B$i._audioCache[B$J.src]=null,B$J=null)):B$J=B$i._audioCache[B$O],B$J&&2<=B$J.readyState)this.event("complete");else{B$J||(B$J=B$O==B$s._tMusic?(B$i._initMusicAudio(),B$i._musicAudio):B$l.createElement("audio"),(B$i._audioCache[B$O]=B$J).src=B$O),B$J.addEventListener("canplaythrough",B$p),B$J.addEventListener("error",B$m);var B$D=this;(this.audio=B$J).load?B$J.load():B$m()}function B$p(){B$C(),B$D.loaded=!0,B$D.event("complete")}function B$m(){B$J.load=null,B$C(),B$D.event("error")}function B$C(){B$J.removeEventListener("canplaythrough",B$p),B$J.removeEventListener("error",B$m)}},B$J.play=function(B$O,B$J,B$D){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),!this.url)return null;var B$p,B$m;if(!(B$p=this.url==B$s._tMusic?B$i._musicAudio:B$i._audioCache[this.url]))return null;B$m=B$Z.getItem("audio:"+this.url),B$N.isConchApp?B$m||((B$m=B$l.createElement("audio")).src=this.url):this.url==B$s._tMusic?(B$i._initMusicAudio(),(B$m=B$i._musicAudio).src=this.url):B$m=B$m||B$p.cloneNode(!0);var B$C=new B$YO(B$m);return B$C.url=this.url,B$C.loops=B$J,B$C.startTime=B$O,B$C.startHandler=B$D,B$C.play(!1),B$s.addChannel(B$C),B$C},B$X(0,B$J,"duration",function(){var B$O;return(B$O=B$i._audioCache[this.url])?B$O.duration:0}),B$i._initMusicAudio=function(){B$i._musicAudio||(B$i._musicAudio||(B$i._musicAudio=B$l.createElement("audio")),B$N.isConchApp||B$l.document.addEventListener("mousedown",B$i._makeMusicOK))},B$i._makeMusicOK=function(){B$l.document.removeEventListener("mousedown",B$i._makeMusicOK),B$i._musicAudio.src?B$i._musicAudio.play():(B$i._musicAudio.src="",B$i._musicAudio.load())},B$i._audioCache={},B$i._musicAudio=null,B$i}(),B$pO=function(B$O){function B$J(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,B$J.__super.call(this)}B$r(B$J,"laya.media.SoundChannel",B$L);var B$D=B$J.prototype;return B$D.play=function(){},B$D.stop=function(){},B$D.pause=function(){},B$D.resume=function(){},B$D.__runComplete=function(B$O){B$O&&B$O.run()},B$X(0,B$D,"volume",function(){return 1},function(B$O){}),B$X(0,B$D,"position",function(){return 0}),B$X(0,B$D,"duration",function(){return 0}),B$J}(),B$mO=function(B$O){function B$J(){B$J.__super.call(this)}B$r(B$J,"laya.media.Sound",B$L);var B$D=B$J.prototype;return B$D.load=function(B$O){},B$D.play=function(B$O,B$J,B$D){return void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),null},B$D.dispose=function(){},B$X(0,B$D,"duration",function(){return 0}),B$J}(),B$CO=function(B$O){function B$m(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,B$m.__super.call(this)}B$r(B$m,"laya.media.webaudio.WebAudioSound",B$L);var B$J=B$m.prototype;return B$J.load=function(B$O){this.url=B$O,this.audioBuffer=B$m._dataCache[B$O],this.audioBuffer?this._loaded(this.audioBuffer):(B$m.e.on("loaded:"+B$O,this,this._loaded),B$m.e.on("err:"+B$O,this,this._err),B$m.__loadingSound[B$O]||(B$m.__loadingSound[B$O]=!0,B$a.loader.load(B$O,B$v.create(this,this.onloaded),null,B$kO.BUFFER,4,!1,null,!0)))},B$J.onloaded=function(B$O){B$O||this._err(),this._disposed?this._removeLoadEvents():(this.data=B$O,B$m.buffs.push({buffer:this.data,url:this.url}),B$m.decode())},B$J._err=function(){if(this._removeLoadEvents(),B$m.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var B$O,B$J,B$D,B$p=0;for(B$O=(B$J=this.__toPlays).length,B$p=0;B$p<B$O;B$p++)(B$D=B$J[B$p])[3]&&!B$D[3].isStopped&&B$D[3].event("error");this.__toPlays.length=0}},B$J._loaded=function(B$O){this._removeLoadEvents(),this._disposed||(this.audioBuffer=B$O,this.loaded=!0,this.event("complete"))},B$J._removeLoadEvents=function(){B$m.e.off("loaded:"+this.url,this,this._loaded),B$m.e.off("err:"+this.url,this,this._err)},B$J.__playAfterLoaded=function(){if(this.__toPlays){var B$O,B$J,B$D,B$p=0;for(B$O=(B$J=this.__toPlays).length,B$p=0;B$p<B$O;B$p++)(B$D=B$J[B$p])[3]&&!B$D[3].isStopped&&this.play(B$D[0],B$D[1],B$D[2],B$D[3]);this.__toPlays.length=0}},B$J.play=function(B$O,B$J,B$D,B$p){return void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),B$p=B$p||new B$GO,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([B$O,B$J,B$D,B$p]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),B$p.url=this.url,B$p.loops=B$J,B$p.audioBuffer=this.audioBuffer,B$p.startTime=B$O,B$p.startHandler=B$D,B$p.play(!1),B$s.addChannel(B$p),B$p},B$J.dispose=function(){this._disposed=!0,delete B$m._dataCache[this.url],delete B$m.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},B$X(0,B$J,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),B$m.decode=function(){if(!(B$m.buffs.length<=0||B$m.isDecoding))if(B$m.isDecoding=!0,(B$m.tInfo=B$m.buffs.shift())&&B$m.tInfo.buffer&&B$m.tInfo.buffer.byteLength)try{B$m.ctx.decodeAudioData(B$m.tInfo.buffer,B$m._done,B$m._fail)}catch(B$O){console.error("decodeAudioData error  byteLength:"+B$m.tInfo.buffer.byteLength+"  url:"+B$m.tInfo.url)}else B$m._fail()},B$m._done=function(B$O){B$m.e.event("loaded:"+B$m.tInfo.url,B$O),B$m._dataCache[B$m.tInfo.url]=B$O,B$m.isDecoding=!1,B$m.decode()},B$m._fail=function(){B$m.e.event("err:"+B$m.tInfo.url,null),B$m.isDecoding=!1,B$m.decode()},B$m._playEmptySound=function(){if(null!=B$m.ctx){if(B$m._emptySource&&(B$m._emptySource.stop(),B$m._emptySource.disconnect(0),!B$GO._tryCleanFailed))try{B$m._emptySource.buffer=null}catch(B$O){B$GO._tryCleanFailed=!0}var B$O=B$m.ctx.createBufferSource();B$O.buffer=B$m._miniBuffer,B$O.connect(B$m.ctx.destination),B$O.start(0,0,0),B$m._emptySource=B$O}},B$m._unlock=function(){B$m._unlocked||(B$m._playEmptySound(),"running"==B$m.ctx.state?(B$l.document.removeEventListener("mousedown",B$m._unlock,!0),B$l.document.removeEventListener("touchend",B$m._unlock,!0),B$l.document.removeEventListener("touchstart",B$m._unlock,!0),B$m._unlocked=!0):"suspended"==B$m.ctx.state&&B$s._recoverWebAudio())},B$m.initWebAudio=function(){"running"!=B$m.ctx.state&&(B$m._unlock(),B$l.document.addEventListener("mousedown",B$m._unlock,!0),B$l.document.addEventListener("touchend",B$m._unlock,!0),B$l.document.addEventListener("touchstart",B$m._unlock,!0))},B$m._emptySource=null,B$m._dataCache={},B$m.buffs=[],B$m.isDecoding=!1,B$m._unlocked=!1,B$m.tInfo=null,B$m.__loadingSound={},B$_(B$m,["window",function(){return this.window=B$l.window},"webAudioEnabled",function(){return this.webAudioEnabled=B$m.window.AudioContext||B$m.window.webkitAudioContext||B$m.window.mozAudioContext},"ctx",function(){return this.ctx=B$m.webAudioEnabled?new(B$m.window.AudioContext||B$m.window.webkitAudioContext||B$m.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=B$m.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new B$L}]),B$m}(),B$iO=function(B$O){function B$J(){this._responseType=null,this._data=null,B$J.__super.call(this),this._http=new B$l.window.XMLHttpRequest}B$r(B$J,"laya.net.HttpRequest",B$L);var B$D=B$J.prototype;return B$D.send=function(B$O,B$J,B$D,B$p,B$m){void 0===B$D&&(B$D="get"),void 0===B$p&&(B$p="text"),this._responseType=B$p,this._data=null;var B$C=this,B$i=this._http;if(B$i.open(B$D,B$O,!0),B$m)for(var B$k=0;B$k<B$m.length;B$k++)B$i.setRequestHeader(B$m[B$k++],B$m[B$k]);else B$N.isConchApp||(B$J&&"string"!=typeof B$J?B$i.setRequestHeader("Content-Type","application/json"):B$i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));B$i.responseType="arraybuffer"!==B$p?"text":"arraybuffer",B$i.onerror=function(B$O){B$C._onError(B$O)},B$i.onabort=function(B$O){B$C._onAbort(B$O)},B$i.onprogress=function(B$O){B$C._onProgress(B$O)},B$i.onload=function(B$O){B$C._onLoad(B$O)},B$i.send(B$J)},B$D._onProgress=function(B$O){B$O&&B$O.lengthComputable&&this.event("progress",B$O.loaded/B$O.total)},B$D._onAbort=function(B$O){this.error("Request was aborted by user")},B$D._onError=function(B$O){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},B$D._onLoad=function(B$O){var B$J=this._http,B$D=void 0!==B$J.status?B$J.status:200;200===B$D||204===B$D||0===B$D?this.complete():this.error("["+B$J.status+"]"+B$J.statusText+":"+B$J.responseURL)},B$D.error=function(B$O){this.clear(),this.event("error",B$O)},B$D.complete=function(){this.clear();var B$J=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=B$Q.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(B$O){B$J=!1,this.error(B$O.message)}B$J&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},B$D.clear=function(){var B$O=this._http;B$O.onerror=B$O.onabort=B$O.onprogress=B$O.onload=null},B$X(0,B$D,"url",function(){return this._http.responseURL}),B$X(0,B$D,"http",function(){return this._http}),B$X(0,B$D,"data",function(){return this._data}),B$J}(),B$kO=function(B$O){function B$z(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,B$z.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}B$r(B$z,"laya.net.Loader",B$L);var B$J=B$z.prototype;return B$J.load=function(B$O,B$J,B$D,B$p,B$m){if(B$O&&""!=B$O||console.error("Loader 加载的url不合法 "+B$O),void 0===B$D&&(B$D=!0),void 0===B$m&&(B$m=!1),0===(this._url=B$O).indexOf("data:image")?this._type=B$J="image":this._type=B$J||(B$J=this.getTypeFromUrl(B$O)),this._cache=B$D,this._data=null,!B$m&&B$z.loadedMap[B$O])return this._data=B$z.loadedMap[B$O],this.event("progress",1),void this.event("complete",this._data);if(B$p&&B$z.setGroup(B$O,B$p),null!=B$z.parserMap[B$J])return this._customParse=!0,void(B$z.parserMap[B$J]instanceof laya.utils.Handler?B$z.parserMap[B$J].runWith(this):B$z.parserMap[B$J].call(null,this));if("image"===B$J||"htmlimage"===B$J||"nativeimage"===B$J)return this._loadImage(B$O);if("ttf"===B$J)return this._loadTTF(B$O);switch(B$J){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:B$J}B$z.preLoadedMap[B$O]?this.onLoaded(B$z.preLoadedMap[B$O]):B$i.resMgrLoad(B$O,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},B$J.getTypeFromUrl=function(B$O){var B$J=B$Q.getFileExtension(B$O);return B$J?B$z.typeMap[B$J]:(console.warn("Not recognize the resources suffix",B$O),"text")},B$J._loadTTF=function(B$O){B$O=B$W.formatURL(B$O);var B$J=new B$o;B$J.complete=B$v.create(this,this.onLoaded),B$J.load(B$O)},B$J._loadImage=function(B$O){B$i.imgMgrLoad(B$O,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},B$J._loadImageComplete=function(B$O,B$J,B$D){if(null!=B$D)if(B$D instanceof ArrayBuffer){var B$p=new DataView(B$D),B$m=new laya.webgl.resource.WebGLImage(new Uint8Array(B$D,8),B$O,0,!1,B$p.getUint32(0),B$p.getUint32(4));this.onLoaded(B$m)}else if(B$D instanceof B$rO)B$z.imgMgrSet[B$O]=B$J,B$i.imgMgrLock(B$O,B$z.imgMgrSet[B$O]),this._url=B$O,this.complete(B$D);else{var B$C=-1!=B$O.indexOf(".png",B$O.length-4)?6408:6407;B$m=new laya.webgl.resource.WebGLImage(B$D,B$O,B$C,!1,B$D.width,B$D.height);this.onLoaded(B$m)}else this.event("error","Load image failed")},B$J.imageCancel=function(B$O,B$J,B$D){B$i.imgMgrCancel(B$O,this._onImageCallback)},B$J._loadSound=function(B$O){var B$J=new B$s._soundClass,B$D=this;function B$p(){B$J.offAll()}B$J.on("complete",this,function(){B$p(),B$D.onLoaded(B$J)}),B$J.on("error",this,function(){B$p(),B$J.dispose(),B$D.event("error","Load sound failed")}),B$J.load(B$O)},B$J.onProgress=function(B$O){"atlas"===this._type?this.event("progress",.3*B$O):this.event("progress",B$O)},B$J.onError=function(B$O){this.event("error",B$O)},B$J._loadedComplete=function(B$O,B$J,B$D){if(null!=B$D)switch(this._type){case"atlas":case"plf":case"json":var B$p=new B$$(B$D);this.onLoaded(JSON.parse(B$p.readUTFBytes()));break;case"font":B$p=new B$$(B$D);this.onLoaded(B$Q.parseXMLFromString(B$p.readUTFBytes()));break;default:this.onLoaded(B$D)}else this.event("error",B$O)},B$J.onLoaded=function(B$O){var B$J=this._type;if("plf"==B$J)this.parsePLFData(B$O),this.complete(B$O);else if("image"===B$J){var B$D=new B$rO(B$O);B$D.url=this._url,this.complete(B$D)}else if("sound"===B$J||"htmlimage"===B$J||"nativeimage"===B$J)this.complete(B$O);else if("atlas"===B$J){if(!B$O.src&&!B$O._setContext){if(!this._data){if((this._data=B$O).meta&&B$O.meta.image)for(var B$p=B$O.meta.image.split(","),B$m=0<=this._url.indexOf("/")?"/":"\\",B$C=this._url.lastIndexOf(B$m),B$i=0<=B$C?this._url.substr(0,B$C+1):"",B$k=0,B$_=B$p.length;B$k<B$_;B$k++)B$p[B$k]=B$i+B$p[B$k];else B$p=[this._url.replace(".json",".png")];B$p.reverse(),B$O.toLoads=B$p,B$O.pics=[]}return this.event("progress",.3+1/B$p.length*.6),this._loadImage(B$p.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(B$O),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var B$L=this._data.frames,B$r=this._url.split("?")[0],B$H=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:B$r.substring(0,B$r.lastIndexOf("."))+"/",B$Y=this._data.pics,B$G=B$W.formatURL(this._url),B$X=B$z.atlasMap[B$G]||(B$z.atlasMap[B$G]=[]);B$X.dir=B$H;var B$c=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var B$h in B$c=parseFloat(this._data.meta.scale),B$L){var B$y,B$v=B$L[B$h],B$A=B$Y[B$v.frame.idx?B$v.frame.idx:0],B$q=B$W.formatURL(B$H+B$h);B$A.scaleRate=B$c,B$y=B$rO.create(B$A,B$v.frame.x,B$v.frame.y,B$v.frame.w,B$v.frame.h,B$v.spriteSourceSize.x,B$v.spriteSourceSize.y,B$v.sourceSize.w,B$v.sourceSize.h),B$z.cacheRes(B$q,B$y),B$z.keepCache(this._url,B$H+B$h),B$y.url=B$q,B$X.push(B$q)}else for(B$h in B$L)B$A=B$Y[(B$v=B$L[B$h]).frame.idx?B$v.frame.idx:0],B$q=B$W.formatURL(B$H+B$h),B$z.cacheRes(B$q,B$rO.create(B$A,B$v.frame.x,B$v.frame.y,B$v.frame.w,B$v.frame.h,B$v.spriteSourceSize.x,B$v.spriteSourceSize.y,B$v.sourceSize.w,B$v.sourceSize.h)),B$z.loadedMap[B$q].url=B$q,B$z.keepCache(this._url,B$H+B$h),B$X.push(B$q);delete this._data.pics,this.complete(this._data)}else if("font"==B$J){if(!B$O.src)return this._data=B$O,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var B$d=new B$g;B$d.parseFont(this._data,B$O);var B$M=this._url.split(".fnt")[0].split("/"),B$a=B$M[B$M.length-1];B$hO.registerBitmapFont(B$a,B$d),this._data=B$d,this.complete(this._data)}else if("pkm"==B$J){var B$e=B$MO.create(B$O,this._url),B$t=new B$rO(B$e);B$t.url=this._url,this.complete(B$t)}else this.complete(B$O)},B$J.parsePLFData=function(B$O){var B$J,B$D,B$p;for(B$J in B$O)switch(B$p=B$O[B$J],B$J){case"json":case"text":for(B$D in B$p)B$z.preLoadedMap[B$W.formatURL(B$D)]=B$p[B$D];break;default:for(B$D in B$p)B$z.preLoadedMap[B$W.formatURL(B$D)]=B$p[B$D]}},B$J.complete=function(B$O){this._data=B$O,this._customParse?this.event("loaded",B$O instanceof Array?[B$O]:B$O):(B$z._loaders.push(this),B$z._isWorking||B$z.checkNext())},B$J.endLoad=function(B$O){B$O&&(this._data=B$O),this._cache&&B$z.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},B$X(0,B$J,"url",function(){return this._url}),B$X(0,B$J,"data",function(){return this._data}),B$X(0,B$J,"cache",function(){return this._cache}),B$X(0,B$J,"type",function(){return this._type}),B$z.checkNext=function(){B$z._isWorking=!0;for(var B$O=B$l.now();B$z._startIndex<B$z._loaders.length;)if(B$l.now(),B$z._loaders[B$z._startIndex].endLoad(),B$z._startIndex++,B$l.now()-B$O>B$z.maxTimeOut)return console.warn("loader callback cost a long time:"+(B$l.now()-B$O)+" url="+B$z._loaders[B$z._startIndex-1].url),void B$a.timer.frameOnce(1,null,B$z.checkNext);B$z._loaders.length=0,B$z._startIndex=0,B$z._isWorking=!1},B$z.clearRes=function(B$O,B$J){if(null!=B$O){void 0===B$J&&(B$J=!1),B$O=B$W.formatURL(B$O);var B$D=B$z.getAtlas(B$O);if(B$D){for(var B$p=0,B$m=B$D.length;B$p<B$m;B$p++){var B$C=B$D[B$p],B$i=B$z.getRes(B$C);delete B$z.loadedMap[B$C],B$z.clearCache(B$O.substring(B$W.basePath.length),B$C.substring(B$W.basePath.length)),B$i&&B$i.destroy(B$J)}B$D.length=0,delete B$z.atlasMap[B$O],delete B$z.loadedMap[B$O]}else{var B$k=B$z.loadedMap[B$O];B$k&&(delete B$z.loadedMap[B$O],B$k instanceof laya.resource.Texture&&B$k.bitmap&&B$k.destroy(B$J))}}},B$z.clearTextureRes=function(B$O){B$O=B$W.formatURL(B$O);var B$J=laya.net.Loader.getAtlas(B$O),B$D=B$J&&0<B$J.length?laya.net.Loader.getRes(B$J[0]):laya.net.Loader.getRes(B$O);B$D&&B$D.bitmap&&(B$N.isConchApp&&!B$N.isConchWebGL?B$D.bitmap.source.releaseTexture&&B$D.bitmap.source.releaseTexture():null==B$D.bitmap._atlaser&&B$D.bitmap.releaseResource(!0))},B$z.getRes=function(B$O){return B$z.loadedMap[B$W.formatURL(B$O)]},B$z.getAtlas=function(B$O){return B$z.atlasMap[B$W.formatURL(B$O)]},B$z.cacheRes=function(B$O,B$J){B$O=B$W.formatURL(B$O),null!=B$z.loadedMap[B$O]?console.warn("Resources already exist,is repeated loading:",B$O):B$z.loadedMap[B$O]=B$J},B$z.setGroup=function(B$O,B$J){B$z.groupMap[B$J]||(B$z.groupMap[B$J]=[]),B$z.groupMap[B$J].push(B$O)},B$z.clearResByGroup=function(B$O){if(B$z.groupMap[B$O]){var B$J=B$z.groupMap[B$O],B$D=0,B$p=B$J.length;for(B$D=0;B$D<B$p;B$D++)B$z.clearRes(B$J[B$D]);B$J.length=0}},B$z.keepCache=function(B$O,B$J){if(B$O&&B$J){var B$D=B$z.cacheSet[B$J];B$D?-1==B$D.indexOf(B$O)&&B$D.push(B$O):B$z.cacheSet[B$J]=[B$O]}},B$z.clearCache=function(B$O,B$J){if(B$O&&B$J){var B$D=B$z.cacheSet[B$J];if(B$D){var B$p=B$D.indexOf(B$O);if(-1!==B$p){var B$m=B$D.length-1;0==B$m?(delete B$z.cacheSet[B$J],0<B$z.imgMgrSet[B$J]?B$i.imgMgrFree(B$J,B$z.imgMgrSet[B$J]):B$z.clearRes(B$J,!0)):(B$D[B$p]=B$D[B$m],B$D.length=B$m)}}}},B$z.saveObject=function(B$O,B$J,B$D){if(B$J&&B$O){var B$p=B$z.objectSet[B$O];B$p?(console.warn("Loader.saveObject: "+B$O),B$p[0]=B$J,B$p[1]=B$D):B$z.objectSet[B$O]=[B$J,B$D,[]]}},B$z.findObject=function(B$O){if(B$O){var B$J=B$z.objectSet[B$O];if(B$J)return B$J[0]}return null},B$z.keepObject=function(B$O,B$J){if(B$O&&B$J){var B$D=B$z.objectSet[B$J];B$D&&-1===B$D[2].indexOf(B$O)&&B$D[2].push(B$O)}},B$z.clearObject=function(B$O,B$J){if(B$O&&B$J){var B$D=B$z.objectSet[B$J];if(B$D){var B$p=B$D[2],B$m=B$p.indexOf(B$O);if(-1!==B$m){var B$C=B$p.length-1;0==B$C?(delete B$z.objectSet[B$J],B$D[1]&&B$D[1].call(null,B$D[0])):(B$p[B$m]=B$p[B$C],B$p.length=B$C)}}}},B$z.TEXT="text",B$z.JSON="json",B$z.XML="xml",B$z.BUFFER="arraybuffer",B$z.IMAGE="image",B$z.SOUND="sound",B$z.ATLAS="atlas",B$z.FONT="font",B$z.TTF="ttf",B$z.PLF="plf",B$z.PKM="pkm",B$z.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},B$z.parserMap={},B$z.groupMap={},B$z.maxTimeOut=100,B$z.loadedMap={},B$z.preLoadedMap={},B$z.atlasMap={},B$z._loaders=[],B$z._isWorking=!1,B$z._startIndex=0,B$z.imgCache={},B$z.cacheSet={},B$z.objectSet={},B$z.imgMgrSet={},B$z}(),B$_O=function(B$O){var B$Y;function B$G(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},B$G.__super.call(this);for(var B$O=0;B$O<this._maxPriority;B$O++)this._resInfos[B$O]=[]}B$r(B$G,"laya.net.LoaderManager",B$L);var B$J=B$G.prototype;return B$J.create=function(B$O,B$D,B$J,B$p,B$m,B$C,B$i,B$k){if(null==B$C&&(B$C=2),null==B$i&&(B$i=!0),B$O instanceof Array){var B$_=B$O,B$L=B$_.length,B$r=0;if(B$J)var B$H=B$v.create(B$J.caller,B$J.method,B$J.args,!1);for(var B$Y=0;B$Y<B$L;B$Y++){var B$G=B$_[B$Y];"string"==typeof B$G&&(B$G=B$_[B$Y]={url:B$G}),B$G.progress=0}for(B$Y=0;B$Y<B$L;B$Y++){B$G=B$_[B$Y];var B$X=B$J?B$v.create(null,B$y,[B$G],!1):null,B$c=B$J||B$D?B$v.create(null,B$h,[B$G]):null;this._create(B$G.url,B$c,B$X,B$G.clas||B$p,B$G.params||B$m,null!=B$G.priority&&0<=B$G.priority?B$G.priority:B$C,B$i,B$G.group||B$k)}function B$h(B$O,B$J){B$r++,B$O.progress=1,B$r===B$L&&B$D&&B$D.run()}function B$y(B$O,B$J){B$O.progress=B$J;for(var B$D=0,B$p=0;B$p<B$L;B$p++){B$D+=B$_[B$p].progress}var B$m=B$D/B$L;B$H.runWith(B$m)}return!0}return this._create(B$O,B$D,B$J,B$p,B$m,B$C,B$i,B$k)},B$J._create=function(B$J,B$D,B$O,B$p,B$m,B$C,B$i,B$k){B$J&&""!=B$J||console.error("加载的url不合法 "+B$J),null==B$C&&(B$C=2),null==B$i&&(B$i=!0);var B$_=B$W.formatURL(B$J),B$L=this.getRes(B$_);if(B$L)!B$L.hasOwnProperty("loaded")||B$L.loaded?(B$O&&B$O.runWith(1),B$D&&B$D.run()):B$D&&B$a.loader._createListener(B$J,B$D.caller,B$D.method,B$D.args,!0,!1);else{var B$r=B$Q.getFileExtension(B$J),B$H=B$G.createMap[B$r];if(!B$H)throw new Error("LoaderManager:unknown file("+B$J+") extension with: "+B$r+".");B$p||(B$p=B$H[0]);var B$Y=B$H[1];if("atlas"==B$r)this.load(B$J,B$D,B$O,B$Y,B$C,B$i);else{B$p===B$rO&&(B$Y="htmlimage"),(B$L=B$p?new B$p:null).hasOwnProperty("_loaded")&&(B$L._loaded=!1),B$L._setUrl(B$J),B$k&&B$L._setGroup(B$k),this._createLoad(B$L,B$J,B$v.create(null,function(B$O){B$L&&!B$L.destroyed&&B$O&&B$L.onAsynLoaded.call(B$L,B$J,B$O,B$m),B$D&&B$D.run();B$a.loader.event(B$J)}),B$O,B$Y,B$C,!1,B$k,!0),B$i&&this.cacheRes(B$_,B$L)}}return B$L},B$J.load=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){B$O&&""!=B$O||console.error("加载的url不合法 "+B$O);var B$_=this;if(null==B$m&&(B$m=2),null==B$C&&(B$C=!0),void 0===B$k&&(B$k=!1),B$O instanceof Array)return this._loadAssets(B$O,B$J,B$D,B$p,B$m,B$C,B$i);var B$L=B$kO.getRes(B$O);if(null!=B$L)B$a.timer.frameOnce(1,null,function(){B$D&&B$D.runWith(1),B$J&&B$J.runWith(B$L),B$_._loaderCount||B$_.event("complete")});else{var B$r=B$G._resMap[B$O];B$r?(B$J&&B$r._createListener("complete",B$J.caller,B$J.method,B$J.args,!1,!1),B$D&&B$r._createListener("progress",B$D.caller,B$D.method,B$D.args,!1,!1)):((B$r=this._infoPool.length?this._infoPool.pop():new B$Y).url=B$O,B$r.clas=null,B$r.type=B$p,B$r.cache=B$C,B$r.group=B$i,B$r.ignoreCache=B$k,B$r.priority=B$m,B$J&&B$r.on("complete",B$J.caller,B$J.method,B$J.args),B$D&&B$r.on("progress",B$D.caller,B$D.method,B$D.args),B$G._resMap[B$O]=B$r,B$m=B$m<this._maxPriority?0<=B$m?B$m:0:this._maxPriority-1,this._resInfos[B$m].push(B$r),this._next())}return this},B$J.cancel=function(B$O,B$J,B$D){if((B$k=B$G._resMap[B$O])&&(B$J&&B$k.off("complete",B$J.caller,B$J.method,B$J.once),B$D&&B$k.off("progress",B$D.caller,B$D.method,B$D.once),!B$k.hasListener("complete")&&!B$k.hasListener("progress"))){if(B$k.loader){var B$p=B$k.loader;B$p.imageCancel(B$O),B$p.offAll(),B$p._data=null,B$p._customParse=!1,this._loaders.push(B$p),this._loaderCount--,delete this._loaderMap[B$k.url]}for(var B$m=0;B$m<this._maxPriority;B$m++)for(var B$C=this._resInfos[B$m],B$i=B$C.length-1;-1<B$i;B$i--){var B$k;(B$k=B$C[B$i])&&B$k.url===B$O&&(B$C[B$i]=null,B$k.destroy(),B$k.offAll(),this._infoPool.push(B$k))}delete B$G._resMap[B$O],this._next()}},B$J._createLoad=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){var B$L=this;if(null==B$C&&(B$C=2),null==B$i&&(B$i=!0),void 0===B$_&&(B$_=!1),B$J instanceof Array)return this._loadAssets(B$J,B$D,B$p,B$m,B$C,B$i,B$k);var B$r=B$kO.getRes(B$J);if(null!=B$r)B$a.timer.frameOnce(1,null,function(){B$p&&B$p.runWith(1),B$D&&B$D.runWith(B$r),B$L._loaderCount||B$L.event("complete")});else{var B$H=B$G._resMap[B$J];B$H?(B$D&&B$H._createListener("complete",B$D.caller,B$D.method,B$D.args,!1,!1),B$p&&B$H._createListener("progress",B$p.caller,B$p.method,B$p.args,!1,!1)):((B$H=this._infoPool.length?this._infoPool.pop():new B$Y).url=B$J,B$H.clas=B$O,B$H.type=B$m,B$H.cache=B$i,B$H.group=B$k,B$H.ignoreCache=B$_,B$H.priority=B$C,B$D&&B$H.on("complete",B$D.caller,B$D.method,B$D.args),B$p&&B$H.on("progress",B$p.caller,B$p.method,B$p.args),B$G._resMap[B$J]=B$H,B$C=B$C<this._maxPriority?0<=B$C?B$C:0:this._maxPriority-1,this._resInfos[B$C].push(B$H),this._next())}return this},B$J._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var B$O=0;B$O<this._maxPriority;B$O++)for(var B$J=this._resInfos[B$O];0<B$J.length;){var B$D=B$J.shift();if(B$D)return this._doLoad(B$D)}this._loaderCount||this.event("complete")}},B$J._doLoad=function(B$J){var B$D=this._loaders.length?this._loaders.pop():new B$kO;this._loaderCount++,(this._loaderMap[B$J.url]=B$D).on("complete",null,B$m),B$D.on("progress",null,function(B$O){B$J.event("progress",B$O)}),B$D.on("error",null,function(B$O){B$m(null)}),B$J.loader=B$D;var B$p=this;function B$m(B$O){B$D.offAll(),B$D._data=null,B$D._customParse=!1,B$p._endLoad(B$J,B$O instanceof Array?[B$O]:B$O),B$p._loaders.push(B$D),B$p._loaderCount--,delete B$p._loaderMap[B$J.url],B$p._next()}B$D._class=B$J.clas,1<=B$J.priority?(B$D.priority=B$J.priority,B$D.realTime=!1):(B$D.priority=0,B$D.realTime=!0),B$D.load(B$J.url,B$J.type,B$J.cache,B$J.group,B$J.ignoreCache)},B$J._endLoad=function(B$O,B$J){var B$D=B$O.url;if(null==B$J){var B$p=this._failRes[B$D]||0;if(B$p<this.retryNum)return console.warn("[warn]Retry to load:",B$D),this._failRes[B$D]=B$p+1,void B$a.timer.once(this.retryDelay,this,this._addReTry,[B$O],!1);console.warn("[error]Failed to load:",B$D),this.event("error",B$D)}this._failRes[B$D]&&(this._failRes[B$D]=0),delete B$G._resMap[B$D],B$O.event("complete",B$J),B$O.destroy(),B$O.offAll(),this._infoPool.push(B$O)},B$J._addReTry=function(B$O){this._resInfos[this._maxPriority-1].push(B$O),this._next()},B$J.clearRes=function(B$O,B$J){void 0===B$J&&(B$J=!1),B$kO.clearRes(B$O,B$J)},B$J.getRes=function(B$O){return B$kO.getRes(B$O)},B$J.cacheRes=function(B$O,B$J){B$kO.cacheRes(B$O,B$J)},B$J.clearTextureRes=function(B$O){B$kO.clearTextureRes(B$O)},B$J.setGroup=function(B$O,B$J){B$kO.setGroup(B$O,B$J)},B$J.clearResByGroup=function(B$O){B$kO.clearResByGroup(B$O)},B$J.clearUnLoaded=function(){for(var B$O=0;B$O<this._maxPriority;B$O++){for(var B$J=this._resInfos[B$O],B$D=B$J.length-1;-1<B$D;B$D--){var B$p=B$J[B$D];B$p&&(B$p.destroy(),B$p.offAll(),this._infoPool.push(B$p))}B$J.length=0}this._loaderCount=0,B$G._resMap={}},B$J.cancelLoadByUrls=function(B$O){if(B$O)for(var B$J=0,B$D=B$O.length;B$J<B$D;B$J++)this.cancelLoadByUrl(B$O[B$J])},B$J.cancelLoadByUrl=function(B$O){for(var B$J=0;B$J<this._maxPriority;B$J++)for(var B$D=this._resInfos[B$J],B$p=B$D.length-1;-1<B$p;B$p--){var B$m=B$D[B$p];B$m&&B$m.url===B$O&&(B$D[B$p]=null,B$m.destroy(),B$m.offAll(),this._infoPool.push(B$m))}B$G._resMap[B$O]&&delete B$G._resMap[B$O]},B$J._loadAssets=function(B$O,B$D,B$i,B$J,B$p,B$m,B$C){null==B$p&&(B$p=2),null==B$m&&(B$m=!0);for(var B$k=B$O.length,B$_=0,B$L=0,B$r=[],B$H=!0,B$Y=0;B$Y<B$k;B$Y++){var B$G=B$O[B$Y];if(!B$G)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+B$O);"string"==typeof B$G&&(B$G={url:B$G,type:B$J,size:1,priority:B$p}),B$G.size||(B$G.size=1),B$G.progress=0,B$L+=B$G.size,B$r.push(B$G);var B$X=B$i?B$v.create(null,B$y,[B$G],!1):null,B$c=B$D||B$i?B$v.create(null,B$h,[B$G]):null;this.load(B$G.url,B$c,B$X,B$G.type,null!=B$G.priority&&0<=B$G.priority?B$G.priority:2,B$m,B$G.group||B$C)}function B$h(B$O,B$J){B$_++,B$O.progress=1,B$J||(B$H=!1),B$_===B$k&&B$D&&B$D.runWith(B$H)}function B$y(B$O,B$J){if(null!=B$i){B$O.progress=B$J;for(var B$D=0,B$p=0;B$p<B$r.length;B$p++){var B$m=B$r[B$p];B$D+=B$m.size*B$m.progress}var B$C=B$D/B$L;B$i.runWith(B$C)}}return this},B$G.cacheRes=function(B$O,B$J){B$kO.cacheRes(B$O,B$J)},B$G._resMap={},B$_(B$G,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),B$G.__init$=function(){B$Y=function(B$O){function B$J(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,B$J.__super.call(this)}return B$r(B$J,"",B$L),B$J.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},B$J}()},B$G}(),B$LO=(function(B$O){function B$m(B$O){B$m.__super.call(this),B$O||(B$O=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var B$J=0,B$D=0,B$p=0;B$p<20;B$p++)B$p%5!=4?this._mat[B$J++]=B$O[B$p]:this._alpha[B$D++]=B$O[B$p];this._action=B$P.createFilterAction(32),this._action.data=this}B$r(B$m,"laya.filters.ColorFilter",B$y);var B$J=B$m.prototype;B$a.imps(B$J,{"laya.filters.IFilter":!0}),B$J.callNative=function(B$O){B$O._$P.cf=this;B$O.conchModel&&B$O.conchModel.setFilterMatrix&&B$O.conchModel.setFilterMatrix(this._mat,this._alpha)},B$X(0,B$J,"type",function(){return 32}),B$X(0,B$J,"action",function(){return this._action})}(),function(B$O){function B$p(B$O,B$J,B$D){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===B$J&&(B$J=0),B$p.__super.call(this),this._byteClass=B$D||B$$,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,B$O&&0<B$J&&B$J<65535&&this.connect(B$O,B$J)}B$r(B$p,"laya.net.Socket",B$L);var B$J=B$p.prototype;B$J.connect=function(B$O,B$J){var B$D="ws://"+B$O+":"+B$J;B$D="https:"==B$l.window.location.protocol?"wss://"+B$O+":"+B$J:"ws://"+B$O+":"+B$J,this.connectByUrl(B$D)},B$J.connectByUrl=function(B$O){var B$J=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new B$l.window.WebSocket(B$O,this.protocols):this._socket=new B$l.window.WebSocket(B$O),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(B$O){B$J._onOpen(B$O)},this._socket.onmessage=function(B$O){B$J._onMessage(B$O)},this._socket.onclose=function(B$O){B$J._onClose(B$O)},this._socket.onerror=function(B$O){B$J._onError(B$O)}},B$J.cleanSocket=function(){try{this._socket.close()}catch(B$O){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},B$J.close=function(){if(null!=this._socket)try{this._socket.close()}catch(B$O){}},B$J._onOpen=function(B$O){this._connected=!0,this.event("open",B$O)},B$J._onMessage=function(B$O){if(B$O&&B$O.data){var B$J=B$O.data;if(this.disableInput&&B$J)this.event("message",B$J);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var B$D=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,B$J&&("string"==typeof B$J?this._input.writeUTFBytes(B$J):this._input.writeArrayBuffer(B$J),this._addInputPosition=this._input.pos,this._input.pos=B$D),this.event("message",B$J)}}},B$J._onClose=function(B$O){this._connected=!1,this.event("close",B$O)},B$J._onError=function(B$O){this.event("error",B$O)},B$J.send=function(B$O){this._socket.send(B$O)},B$J.flush=function(){if(this._output&&0<this._output.length){var B$J;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(B$O){B$J=B$O}this._output.endian=this.endian,this._output.clear(),B$J&&this.event("error",B$J)}},B$X(0,B$J,"input",function(){return this._input}),B$X(0,B$J,"output",function(){return this._output}),B$X(0,B$J,"connected",function(){return this._connected}),B$X(0,B$J,"endian",function(){return this._endian},function(B$O){this._endian=B$O,null!=this._input&&(this._input.endian=B$O),null!=this._output&&(this._output.endian=B$O)}),B$p.LITTLE_ENDIAN="littleEndian",B$p.BIG_ENDIAN="bigEndian"}(),function(B$O){function B$k(){B$k.__super.call(this),this._$1__id=++B$k._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(B$k._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,B$u.currentResourceManager&&B$u.currentResourceManager.addResource(this)}B$r(B$k,"laya.resource.Resource",B$L);var B$J=B$k.prototype;return B$a.imps(B$J,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),B$J._setUrl=function(B$O){var B$J;this._url!==B$O&&(this._url&&((B$J=B$k._urlResourcesMap[this._url]).splice(B$J.indexOf(this),1),0===B$J.length&&delete B$k._urlResourcesMap[this._url]),B$O&&((B$J=B$k._urlResourcesMap[B$O])||(B$k._urlResourcesMap[B$O]=B$J=[]),B$J.push(this)),this._url=B$O)},B$J._getGroup=function(){return this._group},B$J._setGroup=function(B$O){var B$J;this._group!==B$O&&(this._group&&((B$J=B$k._groupResourcesMap[this._group]).splice(B$J.indexOf(this),1),0===B$J.length&&delete B$k._groupResourcesMap[this._group]),B$O&&((B$J=B$k._groupResourcesMap[B$O])||(B$k._groupResourcesMap[B$O]=B$J=[]),B$J.push(this)),this._group=B$O)},B$J._addReference=function(){this._referenceCount++},B$J._removeReference=function(){this._referenceCount--},B$J._clearReference=function(){this._referenceCount=0},B$J._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},B$J.recreateResource=function(){this.completeCreate()},B$J.disposeResource=function(){},B$J.activeResource=function(B$O){void 0===B$O&&(B$O=!1),this._lastUseFrameCount=B$n.loopCount,!this._destroyed&&this.__loaded&&(this._released||B$O)&&this.recreateResource()},B$J.releaseResource=function(B$O){return void 0===B$O&&(B$O=!0),!(!B$O&&this.lock)&&(!(this._released&&!B$O)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},B$J.onAsynLoaded=function(B$O,B$J,B$D){throw new Error("Resource: must override this function!")},B$J.destroy=function(){var B$O;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete B$k._idResourcesMap[this.id],this._url&&((B$O=B$k._urlResourcesMap[this._url])&&(B$O.splice(B$O.indexOf(this),1),0===B$O.length&&delete B$k._urlResourcesMap[this.url]),B$kO.clearRes(this._url),this.__loaded||B$P.cancelLoadByUrl(this._url)),this._group&&((B$O=B$k._groupResourcesMap[this._group]).splice(B$O.indexOf(this),1),0===B$O.length&&delete B$k._groupResourcesMap[this.url]))},B$J.completeCreate=function(){this._released=!1,this.event("recovered",this)},B$J.dispose=function(){this.destroy()},B$X(0,B$J,"memorySize",function(){return this._memorySize},function(B$O){var B$J=B$O-this._memorySize;this._memorySize=B$O,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,B$J),this.resourceManager&&this.resourceManager.addSize(B$J)}),B$X(0,B$J,"_loaded",null,function(B$O){this.__loaded=B$O}),B$X(0,B$J,"loaded",function(){return this.__loaded}),B$X(0,B$J,"id",function(){return this._$1__id}),B$X(0,B$J,"destroyed",function(){return this._destroyed}),B$X(0,B$J,"group",function(){return this._getGroup()},function(B$O){this._setGroup(B$O)}),B$X(0,B$J,"resourceManager",function(){return this._resourceManager}),B$X(0,B$J,"url",function(){return this._url}),B$X(0,B$J,"released",function(){return this._released}),B$X(0,B$J,"referenceCount",function(){return this._referenceCount}),B$k.getResourceByID=function(B$O){return B$k._idResourcesMap[B$O]},B$k.getResourceByURL=function(B$O,B$J){return void 0===B$J&&(B$J=0),null==B$k._urlResourcesMap[B$O]?null:B$k._urlResourcesMap[B$O][B$J]},B$k.getResourceCountByURL=function(B$O){return B$k._urlResourcesMap[B$O].length},B$k.destroyUnusedResources=function(B$O){var B$J;if(B$O){var B$D=B$k._groupResourcesMap[B$O];if(B$D)for(var B$p=B$D.slice(),B$m=0,B$C=B$p.length;B$m<B$C;B$m++)(B$J=B$p[B$m]).lock||0!==B$J._referenceCount||B$J.destroy()}else for(var B$i in B$k._idResourcesMap)(B$J=B$k._idResourcesMap[B$i]).lock||0!==B$J._referenceCount||B$J.destroy()},B$k._uniqueIDCounter=0,B$k._idResourcesMap={},B$k._urlResourcesMap={},B$k._groupResourcesMap={},B$k}()),B$rO=function(B$O){function B$z(B$O,B$J){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,B$z.__super.call(this),B$O&&null!=B$O._addReference&&B$O._addReference(),this.setTo(B$O,B$J)}B$r(B$z,"laya.resource.Texture",B$L);var B$J=B$z.prototype;return B$J._setUrl=function(B$O){this.url=B$O},B$J.setTo=function(B$O,B$J){if(B$O instanceof B$i.HTMLElement){var B$D=B$AO.create("2D",B$O);this.bitmap=B$D}else this.bitmap=B$O;if(this.uv=B$J||B$z.DEF_UV,B$O){this._w=B$O.width,this._h=B$O.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var B$p=this;if(this._loaded)B$P.addToAtlas&&B$P.addToAtlas(B$p);else{var B$m=B$O;B$m instanceof laya.resource.HTMLImage&&B$m.image&&B$m.image.addEventListener("load",function(B$O){B$P.addToAtlas&&B$P.addToAtlas(B$p)},!1)}}},B$J.active=function(){this.bitmap&&this.bitmap.activeResource()},B$J.destroy=function(B$O){if(void 0===B$O&&(B$O=!1),this.alphaTexture&&(this.alphaTexture.destroy(B$O),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var B$J=this.bitmap;B$O?(B$N.isConchApp&&B$J.source&&B$J.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,B$J.dispose(),B$J._clearReference()):(B$J._removeReference(),0==B$J.referenceCount&&(B$N.isConchApp&&B$J.source&&B$J.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,B$J.dispose())),this.url&&this===B$a.loader.getRes(this.url)&&B$a.loader.clearRes(this.url,B$O),this._loaded=!1}},B$J.load=function(B$O){var B$J=this;this._loaded=!1,B$O=B$W.customFormat(B$O);var B$D=this.bitmap||(this.bitmap=B$MO.create(B$O));B$D.uri=B$O,B$D&&B$D._addReference();var B$p=this;B$D.onload=function(){B$D.onload=null,B$p._loaded=!0,B$J.sourceWidth=B$J._w=B$D.width,B$J.sourceHeight=B$J._h=B$D.height,B$p.event("loaded",this),B$P.addToAtlas&&B$P.addToAtlas(B$p)}},B$J.addTextureToAtlas=function(B$O){B$P.addTextureToAtlas(this)},B$J.getPixels=function(B$O,B$J,B$D,B$p){if(B$N.isConchApp){var B$m=this.bitmap;if(B$m.source&&B$m.source.getImageData){var B$C=B$m.source.getImageData(B$O,B$J,B$D,B$p),B$i=new Uint8Array(B$C);return Array.from(B$i)}return null}return B$N.isWebGL?B$P.getTexturePixels(this,B$O,B$J,B$D,B$p):(B$l.canvas.size(B$D,B$p),B$l.canvas.clear(),B$l.context.drawTexture(this,-B$O,-B$J,this.width,this.height,0,0),B$l.context.getImageData(0,0,B$D,B$p).data)},B$J.onAsynLoaded=function(B$O,B$J){if(B$J){if("function"!=typeof B$J._addReference)throw new Error("bitmap._addReference is not a function. "+B$J.className+" "+typeof B$J._addReference+" "+B$J.constructor);B$J._addReference()}this.setTo(B$J,this.uv),this._loaded&&this.event("loaded",this)},B$X(0,B$J,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),B$X(0,B$J,"loaded",function(){return this._loaded}),B$X(0,B$J,"released",function(){return!this.bitmap||this.bitmap.released}),B$X(0,B$J,"width",function(){return this._w?this._w:this.uv&&this.uv!==B$z.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(B$O){this._w=B$O,this.sourceWidth||(this.sourceWidth=B$O)}),B$X(0,B$J,"repeat",function(){return!B$N.isWebGL||!this.bitmap||this.bitmap.repeat},function(B$O){B$O&&B$N.isWebGL&&this.bitmap&&(this.bitmap.repeat=B$O)&&(this.bitmap.enableMerageInAtlas=!1)}),B$X(0,B$J,"height",function(){return this._h?this._h:this.uv&&this.uv!==B$z.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(B$O){this._h=B$O,this.sourceHeight||(this.sourceHeight=B$O)}),B$X(0,B$J,"isLinearSampling",function(){return!B$N.isWebGL||9728!=this.bitmap.minFifter},function(B$O){!B$O&&B$N.isWebGL&&(B$O||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),B$z.moveUV=function(B$O,B$J,B$D){for(var B$p=0;B$p<8;B$p+=2)B$D[B$p]+=B$O,B$D[B$p+1]+=B$J;return B$D},B$z.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){void 0===B$C&&(B$C=0),void 0===B$i&&(B$i=0),void 0===B$k&&(B$k=0),void 0===B$_&&(B$_=0);var B$L=B$O instanceof laya.resource.Texture,B$r=B$L?B$O.uv:B$z.DEF_UV,B$H=B$L?B$O.bitmap:B$O,B$Y=B$P.isAtlas(B$H);if(B$Y){var B$G=B$H._atlaser,B$X=B$O._atlasID;if(-1==B$X)throw new Error("create texture error");B$H=B$G._inAtlasTextureBitmapValue[B$X],B$r=B$G._inAtlasTextureOriUVValue[B$X]}var B$c=new B$z(B$H,null);B$H.width&&B$J+B$p>B$H.width&&(B$p=B$H.width-B$J),B$H.height&&B$D+B$m>B$H.height&&(B$m=B$H.height-B$D),B$c.width=B$p,B$c.height=B$m,B$c.offsetX=B$C,B$c.offsetY=B$i,B$c.sourceWidth=B$k||B$p,B$c.sourceHeight=B$_||B$m;var B$h=1/B$H.width,B$y=1/B$H.height;B$J*=B$h,B$D*=B$y,B$p*=B$h,B$m*=B$y;var B$v=B$c.uv[0],B$A=B$c.uv[1],B$q=B$c.uv[4],B$d=B$c.uv[5],B$M=B$q-B$v,B$a=B$d-B$A,B$e=B$z.moveUV(B$r[0],B$r[1],[B$J,B$D,B$J+B$p,B$D,B$J+B$p,B$D+B$m,B$J,B$D+B$m]);B$c.uv=[B$v+B$e[0]*B$M,B$A+B$e[1]*B$a,B$q-(1-B$e[2])*B$M,B$A+B$e[3]*B$a,B$q-(1-B$e[4])*B$M,B$d-(1-B$e[5])*B$a,B$v+B$e[6]*B$M,B$d-(1-B$e[7])*B$a],B$Y&&B$c.addTextureToAtlas();var B$t=B$H.scaleRate;return B$t&&1!=B$t?(B$c.sourceWidth/=B$t,B$c.sourceHeight/=B$t,B$c.width/=B$t,B$c.height/=B$t,B$c.scaleRate=B$t,B$c.offsetX/=B$t,B$c.offsetY/=B$t):B$c.scaleRate=1,B$c},B$z.createFromTexture=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$O.scaleRate;1!=B$C&&(B$J*=B$C,B$D*=B$C,B$p*=B$C,B$m*=B$C);var B$i=B$t.TEMP.setTo(B$J-B$O.offsetX,B$D-B$O.offsetY,B$p,B$m),B$k=B$i.intersection(B$z._rect1.setTo(0,0,B$O.width,B$O.height),B$z._rect2);if(!B$k)return null;var B$_=B$z.create(B$O,B$k.x,B$k.y,B$k.width,B$k.height,B$k.x-B$i.x,B$k.y-B$i.y,B$p,B$m);if(B$_.bitmap&&B$_.bitmap._removeReference)return B$_.bitmap._removeReference(),B$_;var B$L="bitmap:"+(B$_.bitmap?B$_.bitmap.constructor?B$_.bitmap.constructor.name:B$_.bitmap.__className:"")+", url:"+(B$O.url+" | "+(B$_.bitmap?B$_.bitmap.url:B$O.url))+", x="+B$J+",y="+B$D+",width="+B$p+",height="+B$m+", result="+(B$k?B$k.x+","+B$k.y+","+B$k.width+","+B$k.height:"null")+", rect="+B$i.x+","+B$i.y+","+B$i.width+","+B$i.height;throw new Error("报错：bitmap._removeReference is not a function  "+B$L)},B$z.DEF_UV=[0,0,1,0,1,1,0,1],B$z.INV_UV=[0,1,1,1,1,0,0,0],B$z._rect1=new B$t,B$z._rect2=new B$t,B$z}(),B$O=function(B$O){var B$k;function B$C(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,B$C.__super.call(this)}B$r(B$C,"laya.utils.TimeLine",B$L);var B$J=B$C.prototype;return B$J.to=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=0),this._create(B$O,B$J,B$D,B$p,B$m,!0)},B$J.from=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=0),this._create(B$O,B$J,B$D,B$p,B$m,!1)},B$J._create=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$Z.getItemByClass("tweenData",B$k);return B$i.isTo=B$C,B$i.type=0,B$i.target=B$O,B$i.duration=B$D,B$i.data=B$J,B$i.startTime=this._startTime+B$m,B$i.endTime=B$i.startTime+B$i.duration,B$i.ease=B$p,this._startTime=Math.max(B$i.endTime,this._startTime),this._tweenDataList.push(B$i),this._startTimeSort=!0,this._endTimeSort=!0,this},B$J.addLabel=function(B$O,B$J){var B$D=B$Z.getItemByClass("tweenData",B$k);return B$D.type=1,B$D.data=B$O,B$D.endTime=B$D.startTime=this._startTime+B$J,this._labelDic||(this._labelDic={}),this._labelDic[B$O]=B$D,this._tweenDataList.push(B$D),this},B$J.removeLabel=function(B$O){if(this._labelDic&&this._labelDic[B$O]){var B$J=this._labelDic[B$O];if(B$J){var B$D=this._tweenDataList.indexOf(B$J);-1<B$D&&this._tweenDataList.splice(B$D,1)}delete this._labelDic[B$O]}},B$J.gotoTime=function(B$O){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var B$J,B$D,B$p,B$m;for(var B$C in this._firstTweenDic)if(B$D=this._firstTweenDic[B$C])for(var B$i in B$D)B$D.diyTarget.hasOwnProperty(B$i)&&(B$D.diyTarget[B$i]=B$D[B$i]);for(B$C in this._tweenDic)(B$J=this._tweenDic[B$C]).clear(),delete this._tweenDic[B$C];if(this._index=0,this._gidIndex=0,this._currTime=B$O,this._lastTime=B$l.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=B$p=this._tweenDataList.concat(),B$p.sort(function(B$O,B$J){return B$O.endTime>B$J.endTime?1:B$O.endTime<B$J.endTime?-1:0})}else B$p=this._endTweenDataList;for(var B$k=0,B$_=B$p.length;B$k<B$_;B$k++)if(0==(B$m=B$p[B$k]).type){if(!(B$O>=B$m.endTime))break;this._index=Math.max(this._index,B$k+1);var B$L=B$m.data;if(B$m.isTo)for(var B$r in B$L)B$m.target[B$r]=B$L[B$r]}for(B$k=0,B$_=this._tweenDataList.length;B$k<B$_;B$k++)0==(B$m=this._tweenDataList[B$k]).type&&B$O>=B$m.startTime&&B$O<B$m.endTime&&(this._index=Math.max(this._index,B$k+1),this._gidIndex++,(B$J=B$Z.getItemByClass("tween",B$S))._create(B$m.target,B$m.data,B$m.duration,B$m.ease,B$v.create(this,this._animComplete,[this._gidIndex]),0,!1,B$m.isTo,!0,!1),B$J.setStartTime(this._currTime-(B$O-B$m.startTime)),B$J._updateEase(this._currTime),B$J.gid=this._gidIndex,this._tweenDic[this._gidIndex]=B$J)}},B$J.gotoLabel=function(B$O){if(null!=this._labelDic){var B$J=this._labelDic[B$O];B$J&&this.gotoTime(B$J.startTime)}},B$J.pause=function(){B$a.timer.clear(this,this._update)},B$J.resume=function(){this.play(this._currTime,this._loopKey)},B$J.play=function(B$O,B$J){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(B$O,B$J){return B$O.startTime>B$J.startTime?1:B$O.startTime<B$J.startTime?-1:0});for(var B$D=0,B$p=this._tweenDataList.length;B$D<B$p;B$D++){var B$m=this._tweenDataList[B$D];if(null!=B$m&&0==B$m.type){var B$C=B$m.target,B$i=B$C.$_GID||(B$C.$_GID=B$Q.getGID()),B$k=null;for(var B$_ in null==this._firstTweenDic[B$i]?((B$k={}).diyTarget=B$C,this._firstTweenDic[B$i]=B$k):B$k=this._firstTweenDic[B$i],B$m.data)null==B$k[B$_]&&(B$k[B$_]=B$C[B$_])}}}"string"==typeof B$O?this.gotoLabel(B$O):this.gotoTime(B$O),this._loopKey=B$J,this._lastTime=B$l.now(),B$a.timer.frameLoop(1,this,this._update)}},B$J._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var B$O in this._tweenDic)(B$J=this._tweenDic[B$O]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var B$J,B$D=B$l.now(),B$p=B$D-this._lastTime,B$m=this._currTime+=B$p*this.scale;for(B$O in this._lastTime=B$D,this._tweenDic)(B$J=this._tweenDic[B$O])._updateEase(B$m);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var B$C=this._tweenDataList[this._index];B$m>=B$C.startTime&&(this._index++,0==B$C.type?(this._gidIndex++,(B$J=B$Z.getItemByClass("tween",B$S))._create(B$C.target,B$C.data,B$C.duration,B$C.ease,B$v.create(this,this._animComplete,[this._gidIndex]),0,!1,B$C.isTo,!0,!1),B$J.setStartTime(B$m),B$J.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=B$J)._updateEase(B$m)):this.event("label",B$C.data))}},B$J._animComplete=function(B$O){this._tweenDic[B$O]&&delete this._tweenDic[B$O]},B$J._complete=function(){this.event("complete")},B$J.reset=function(){var B$O;if(this._labelDic)for(B$O in this._labelDic)delete this._labelDic[B$O];for(B$O in this._tweenDic)this._tweenDic[B$O].clear(),delete this._tweenDic[B$O];for(B$O in this._firstTweenDic)delete this._firstTweenDic[B$O];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var B$J,B$D=0;for(B$J=this._tweenDataList.length,B$D=0;B$D<B$J;B$D++)this._tweenDataList[B$D]&&this._tweenDataList[B$D].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,B$a.timer.clear(this,this._update)},B$J.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},B$X(0,B$J,"index",function(){return this._frameIndex},function(B$O){this._frameIndex=B$O,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),B$X(0,B$J,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),B$C.to=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=0),(new B$C).to(B$O,B$J,B$D,B$p,B$m)},B$C.from=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$m&&(B$m=0),(new B$C).from(B$O,B$J,B$D,B$p,B$m)},B$C.__init$=function(){B$k=function(){function B$O(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return B$r(B$O,""),B$O.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,B$Z.recover("tweenData",this)},B$O}()},B$C}(),B$HO=function(B$m){function B$D(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,B$D.__super.call(this),this._style=B$k.EMPTY}B$r(B$D,"laya.display.Sprite",B$m);var B$O=B$D.prototype;return B$a.imps(B$O,{"laya.display.ILayout":!0}),B$O.createConchModel=function(){return new ConchNode},B$O.destroy=function(B$O){if(void 0===B$O&&(B$O=!0),this._releaseMem(),!this._destroyed){this.filters=null;var B$J=this.mask;B$J&&(this.mask=null,B$J.destroy(B$O))}B$m.prototype.destroy.call(this,B$O),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},B$O.updateZOrder=function(){B$Q.updateOrder(this._childs)&&this.repaint()},B$O.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},B$O.setBounds=function(B$O){this._set$P("uBounds",B$O)},B$O.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new B$t),B$t._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},B$O.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new B$t),B$t._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},B$O._boundPointsToParent=function(B$O){void 0===B$O&&(B$O=!1);var B$J=0,B$D=0;this._style&&(B$J=this._style._tf.translateX,B$D=this._style._tf.translateY,B$O=B$O||0!==this._style._tf.rotate,this._style.scrollRect&&(B$J+=this._style.scrollRect.x,B$D+=this._style.scrollRect.y));var B$p=this._getBoundPointsM(B$O);if(!B$p||B$p.length<1)return B$p;if(8!=B$p.length&&(B$p=B$O?B$d.scanPList(B$p):B$t._getWrapRec(B$p,B$t.TEMP)._getBoundPoints()),!this.transform)return B$Q.transPointList(B$p,this._x-B$J,this._y-B$D),B$p;var B$m=B$e.TEMP,B$C=0,B$i=B$p.length;for(B$C=0;B$C<B$i;B$C+=2)B$m.x=B$p[B$C],B$m.y=B$p[B$C+1],this.toParentPoint(B$m),B$p[B$C]=B$m.x,B$p[B$C+1]=B$m.y;return B$p},B$O.getGraphicBounds=function(B$O){return void 0===B$O&&(B$O=!1),this._graphics?this._graphics.getBounds(B$O):B$t.TEMP.setTo(0,0,0,0)},B$O._getBoundPointsM=function(B$O){if(void 0===B$O&&(B$O=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var B$J=B$Q.clearArray(this._$P.temBM),B$D=B$t.TEMP;return B$D.copyFrom(this.scrollRect),B$Q.concatArray(B$J,B$D._getBoundPoints()),B$J}for(var B$p,B$m,B$C,B$i=this._graphics?this._graphics.getBoundPoints():B$Q.clearArray(this._$P.temBM),B$k=0,B$_=(B$C=this._childs).length;B$k<B$_;B$k++)(B$p=B$C[B$k])instanceof laya.display.Sprite&&1==B$p.visible&&(B$m=B$p._boundPointsToParent(B$O))&&(B$i=B$i?B$Q.concatArray(B$i,B$m):B$m);return B$i},B$O.getStyle=function(){return this._style===B$k.EMPTY&&(this._style=new B$k),this._style},B$O.setStyle=function(B$O){this._style=B$O},B$O._adjustTransform=function(){this._tfChanged=!1;var B$O,B$J=this._style._tf,B$D=B$J.scaleX,B$p=B$J.scaleY;if(B$J.rotate||1!==B$D||1!==B$p||B$J.skewX||B$J.skewY){(B$O=this._transform||(this._transform=B$E.create())).bTransform=!0;var B$m=.0174532922222222*(B$J.rotate-B$J.skewX),B$C=.0174532922222222*(B$J.rotate+B$J.skewY),B$i=Math.cos(B$C),B$k=Math.sin(B$C),B$_=Math.sin(B$m),B$L=Math.cos(B$m);return B$O.a=B$D*B$i,B$O.b=B$D*B$k,B$O.c=-B$p*B$_,B$O.d=B$p*B$L,B$O.tx=B$O.ty=0,B$O}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,B$O},B$O.pos=function(B$O,B$J,B$D){if(void 0===B$D&&(B$D=!1),this._x!==B$O||this._y!==B$J){if(this.destroyed)return this;if(B$D){this._x=B$O,this._y=B$J,this.conchModel&&this.conchModel.pos(this._x,this._y);var B$p=this._parent;B$p&&0===B$p._repaint&&(B$p._repaint=1,B$p.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=B$O,this.y=B$J}return this},B$O.pivot=function(B$O,B$J){return this.pivotX=B$O,this.pivotY=B$J,this},B$O.size=function(B$O,B$J){return this.width=B$O,this.height=B$J,this},B$O.scale=function(B$O,B$J,B$D){void 0===B$D&&(B$D=!1);var B$p=this.getStyle(),B$m=B$p._tf;if(B$m.scaleX!=B$O||B$m.scaleY!=B$J){if(this.destroyed)return this;if(B$D){B$p.setScale(B$O,B$J),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(B$O,B$J),this._renderType|=4;var B$C=this._parent;B$C&&0===B$C._repaint&&(B$C._repaint=1,B$C.parentRepaint())}else this.scaleX=B$O,this.scaleY=B$J}return this},B$O.skew=function(B$O,B$J){return this.skewX=B$O,this.skewY=B$J,this},B$O.render=function(B$O,B$J,B$D){B$n.spriteCount++,B$R.renders[this._renderType]._fun(this,B$O,B$J+this._x,B$D+this._y),this._repaint=0},B$O.drawToCanvas=function(B$O,B$J,B$D,B$p){if(B$N.isConchNode){var B$m=B$AO.create("2D");return new B$F(B$O,B$J,B$m).ctx.setCanvasType(1),this.conchModel.drawToCanvas(B$m.source,B$D,B$p),B$m}return B$P.drawToCanvas(this,this._renderType,B$O,B$J,B$D,B$p)},B$O.customRender=function(B$O,B$J,B$D){this._renderType|=1024},B$O._applyFilters=function(){var B$O;if(!B$N.isWebGL&&((B$O=this._$P.filters)&&!(B$O.length<1)))for(var B$J=0,B$D=B$O.length;B$J<B$D;B$J++)B$O[B$J].action.apply(this._$P.cacheCanvas)},B$O._isHaveGlowFilter=function(){var B$O,B$J=0;if(this.filters)for(B$J=0;B$J<this.filters.length;B$J++)if(8==this.filters[B$J].type)return!0;for(B$J=0,B$O=this._childs.length;B$J<B$O;B$J++)if(this._childs[B$J]._isHaveGlowFilter())return!0;return!1},B$O.localToGlobal=function(B$O,B$J){void 0===B$J&&(B$J=!1),!0===B$J&&(B$O=new B$e(B$O.x,B$O.y));for(var B$D=this;B$D&&B$D!=B$a.stage;)B$O=B$D.toParentPoint(B$O),B$D=B$D.parent;return B$O},B$O.globalToLocal=function(B$O,B$J){void 0===B$J&&(B$J=!1),B$J&&(B$O=new B$e(B$O.x,B$O.y));for(var B$D=this,B$p=[];B$D&&B$D!=B$a.stage;)B$p.push(B$D),B$D=B$D.parent;for(var B$m=B$p.length-1;0<=B$m;)B$O=(B$D=B$p[B$m]).fromParentPoint(B$O),B$m--;return B$O},B$O.toParentPoint=function(B$O){if(!B$O)return B$O;B$O.x-=this.pivotX,B$O.y-=this.pivotY,this.transform&&this._transform.transformPoint(B$O),B$O.x+=this._x,B$O.y+=this._y;var B$J=this._style.scrollRect;return B$J&&(B$O.x-=B$J.x,B$O.y-=B$J.y),B$O},B$O.fromParentPoint=function(B$O){if(!B$O)return B$O;B$O.x-=this._x,B$O.y-=this._y;var B$J=this._style.scrollRect;return B$J&&(B$O.x+=B$J.x,B$O.y+=B$J.y),this.transform&&this._transform.invertTransformPoint(B$O),B$O.x+=this.pivotX,B$O.y+=this.pivotY,B$O},B$O.on=function(B$O,B$J,B$D,B$p){return 1!==this._mouseEnableState&&this.isMouseEvent(B$O)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(B$O,B$J,B$D,B$p,!1)):B$m.prototype.on.call(this,B$O,B$J,B$D,B$p)},B$O.once=function(B$O,B$J,B$D,B$p){return 1!==this._mouseEnableState&&this.isMouseEvent(B$O)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(B$O,B$J,B$D,B$p,!0)):B$m.prototype.once.call(this,B$O,B$J,B$D,B$p)},B$O._$2__onDisplay=function(){if(1!==this._mouseEnableState){var B$O=this;for(B$O=B$O.parent;B$O&&1!==B$O._mouseEnableState&&!B$O._getBit(2);)B$O.mouseEnabled=!0,B$O._setBit(2,!0),B$O=B$O.parent}},B$O.loadImage=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=this;return void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),this.graphics.loadImage(B$O,B$J,B$D,B$p,B$m,function(B$O){B$i.destroyed||(B$i.size(B$J+(B$p||B$O.width),B$D+(B$m||B$O.height)),B$i.repaint(),B$C&&B$C.runWith(B$O))}),this},B$O.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},B$O._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},B$O._childChanged=function(B$O){this._childs.length?this._renderType|=2048:this._renderType&=-2049,B$O&&this._get$P("hasZorder")&&B$a.timer.callLater(this,this.updateZOrder),this.repaint()},B$O.parentRepaint=function(){var B$O=this._parent;B$O&&0===B$O._repaint&&(B$O._repaint=1,B$O.parentRepaint())},B$O.startDrag=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){void 0===B$J&&(B$J=!1),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=300),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=.92),this._$P.dragging||this._set$P("dragging",new B$I),this._$P.dragging.start(this,B$O,B$J,B$D,B$p,B$m,B$C,B$i)},B$O.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},B$O._releaseMem=function(){if(this._$P){var B$O=this._$P.cacheCanvas;B$O&&B$O.ctx&&(B$Z.recover("RenderContext",B$O.ctx),B$O.ctx.canvas.size(0,0),B$O.ctx=null);var B$J=this._$P._filterCache;B$J&&(B$J.destroy(),B$J.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},B$O._setDisplay=function(B$O){B$O||this._releaseMem(),B$m.prototype._setDisplay.call(this,B$O)},B$O.hitTestPoint=function(B$O,B$J){var B$D=this.globalToLocal(B$e.TEMP.setTo(B$O,B$J));return B$O=B$D.x,B$J=B$D.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?B$t.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(B$O,B$J)},B$O.getMousePoint=function(){return this.globalToLocal(B$e.TEMP.setTo(B$a.stage.mouseX,B$a.stage.mouseY))},B$O._getWords=function(){return null},B$O._addChildsToLayout=function(B$O){var B$J=this._getWords();if(null==B$J&&0==this._childs.length)return!1;if(B$J)for(var B$D=0,B$p=B$J.length;B$D<B$p;B$D++)B$O.push(B$J[B$D]);B$D=0;for(var B$m=this._childs.length;B$D<B$m;++B$D){var B$C=this._childs[B$D];B$C._style._enableLayout()&&B$C._addToLayout(B$O)}return!0},B$O._addToLayout=function(B$O){this._style.absolute||(this._style.block?B$O.push(this):this._addChildsToLayout(B$O)&&(this.x=this.y=0))},B$O._isChar=function(){return!1},B$O._getCSSStyle=function(){return this._style.getCSSStyle()},B$O._setAttributes=function(B$O,B$J){switch(B$O){case"x":this.x=parseFloat(B$J);break;case"y":this.y=parseFloat(B$J);break;case"width":this.width=parseFloat(B$J);break;case"height":this.height=parseFloat(B$J);break;default:this[B$O]=B$J}},B$O._layoutLater=function(){this.parent&&this.parent._layoutLater()},B$X(0,B$O,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(B$O){this._optimizeScrollRect!=B$O&&(this._optimizeScrollRect=B$O,this.conchModel&&this.conchModel.optimizeScrollRect(B$O))}),B$X(0,B$O,"customRenderEnable",null,function(B$O){if(B$O&&(this._renderType|=1024,B$N.isConchNode)){B$D.CustomList.push(this);var B$J=new B$AO("2d");B$J._setContext(new CanvasRenderingContext2D),this.customContext=new B$F(0,0,B$J),B$J.context.setCanvasType&&B$J.context.setCanvasType(2),this.conchModel.custom(B$J.context)}}),B$X(0,B$O,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(B$O){this.cacheAs=B$O?this._$P.hasFilter?"none":"normal":"none"}),B$X(0,B$O,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(B$O){var B$J=this._$P.cacheCanvas;if(B$O!==(B$J?B$J.type:"none")){if("none"!==B$O)this._getBit(1)||this._setUpNoticeType(1),B$J||(B$J=this._set$P("cacheCanvas",B$Z.getItemByClass("cacheCanvas",Object))),B$J.type=B$O,B$J.reCache=!0,this._renderType|=16,"bitmap"==B$O&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(B$J){var B$D=B$J;B$D&&B$D.ctx&&(B$Z.recover("RenderContext",B$D.ctx),B$D.ctx.canvas.size(0,0),B$D.ctx=null),B$Z.recover("cacheCanvas",B$J)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),B$X(0,B$O,"zOrder",function(){return this._zOrder},function(B$O){this._zOrder!=B$O&&(this._zOrder=B$O,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(B$O),this._parent&&(B$O&&this._parent._set$P("hasZorder",!0),B$a.timer.callLater(this._parent,this.updateZOrder)))}),B$X(0,B$O,"rotation",function(){return this._style._tf.rotate},function(B$O){var B$J=this.getStyle();if(B$J._tf.rotate!==B$O){B$J.setRotate(B$O),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(B$O),this._renderType|=4;var B$D=this._parent;B$D&&0===B$D._repaint&&(B$D._repaint=1,B$D.parentRepaint())}}),B$X(0,B$O,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(B$O){this._width!==B$O&&(this._width=B$O,this.conchModel&&this.conchModel.size(B$O,this._height),this.repaint())}),B$X(0,B$O,"x",function(){return this._x},function(B$O){if(this._x!==B$O){if(this.destroyed)return;this._x=B$O,this.conchModel&&this.conchModel.pos(B$O,this._y);var B$J=this._parent;B$J&&0===B$J._repaint&&(B$J._repaint=1,B$J.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),B$X(0,B$O,"globalScaleY",function(){for(var B$O=1,B$J=this;B$J&&B$J!==B$a.stage;)B$O*=B$J.scaleY,B$J=B$J.parent;return B$O}),B$X(0,B$O,"hitArea",function(){return this._$P.hitArea},function(B$O){this._set$P("hitArea",B$O)}),B$X(0,B$O,"staticCache",function(){return this._$P.staticCache},function(B$O){this._set$P("staticCache",B$O),B$O||this.reCache()}),B$X(0,B$O,"texture",function(){return this._texture},function(B$O){this._texture!=B$O&&(this._texture=B$O,this.graphics.cleanByTexture(B$O,0,0))}),B$X(0,B$O,"y",function(){return this._y},function(B$O){if(this._y!==B$O){if(this.destroyed)return;this._y=B$O,this.conchModel&&this.conchModel.pos(this._x,B$O);var B$J=this._parent;B$J&&0===B$J._repaint&&(B$J._repaint=1,B$J.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),B$X(0,B$O,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(B$O){this._height!==B$O&&(this._height=B$O,this.conchModel&&this.conchModel.size(this._width,B$O),this.repaint())}),B$X(0,B$O,"blendMode",function(){return this._style.blendMode},function(B$O){this.getStyle().blendMode=B$O,this.conchModel&&this.conchModel.blendMode(B$O),B$O&&"source-over"!=B$O?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),B$X(0,B$O,"scaleX",function(){return this._style._tf.scaleX},function(B$O){var B$J=this.getStyle();if(B$J._tf.scaleX!==B$O){B$J.setScaleX(B$O),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(B$O,B$J._tf.scaleY),this._renderType|=4;var B$D=this._parent;B$D&&0===B$D._repaint&&(B$D._repaint=1,B$D.parentRepaint())}}),B$X(0,B$O,"scaleY",function(){return this._style._tf.scaleY},function(B$O){var B$J=this.getStyle();if(B$J._tf.scaleY!==B$O){B$J.setScaleY(B$O),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(B$J._tf.scaleX,B$O),this._renderType|=4;var B$D=this._parent;B$D&&0===B$D._repaint&&(B$D._repaint=1,B$D.parentRepaint())}}),B$X(0,B$O,"stage",function(){return B$a.stage}),B$X(0,B$O,"skewX",function(){return this._style._tf.skewX},function(B$O){var B$J=this.getStyle();if(B$J._tf.skewX!==B$O){B$J.setSkewX(B$O),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(B$O,B$J._tf.skewY),this._renderType|=4;var B$D=this._parent;B$D&&0===B$D._repaint&&(B$D._repaint=1,B$D.parentRepaint())}}),B$X(0,B$O,"scrollRect",function(){return this._style.scrollRect},function(B$O){this.getStyle().scrollRect=B$O,this.repaint(),B$O?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(B$O.x,B$O.y,B$O.width,B$O.height)):(this._renderType&=-129,this.conchModel&&(B$D.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),B$X(0,B$O,"skewY",function(){return this._style._tf.skewY},function(B$O){var B$J=this.getStyle();if(B$J._tf.skewY!==B$O){B$J.setSkewY(B$O),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(B$J._tf.skewX,B$O),this._renderType|=4;var B$D=this._parent;B$D&&0===B$D._repaint&&(B$D._repaint=1,B$D.parentRepaint())}}),B$X(0,B$O,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(B$O){this._tfChanged=!1,(this._transform=B$O)&&(this._x=B$O.tx,this._y=B$O.ty,B$O.tx=B$O.ty=0,this.conchModel&&this.conchModel.transform(B$O.a,B$O.b,B$O.c,B$O.d,this._x,this._y)),B$O?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),B$X(0,B$O,"pivotX",function(){return this._style._tf.translateX},function(B$O){this.getStyle().setTranslateX(B$O),this.conchModel&&this.conchModel.pivot(B$O,this._style._tf.translateY),this.repaint()}),B$X(0,B$O,"pivotY",function(){return this._style._tf.translateY},function(B$O){this.getStyle().setTranslateY(B$O),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,B$O),this.repaint()}),B$X(0,B$O,"alpha",function(){return this._style.alpha},function(B$O){this._style&&this._style.alpha!==B$O&&(B$O=B$O<0?0:1<B$O?1:B$O,this.getStyle().alpha=B$O,this.conchModel&&this.conchModel.alpha(B$O),1!==B$O?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),B$X(0,B$O,"visible",function(){return this._style.visible},function(B$O){this._style&&this._style.visible!==B$O&&(this.getStyle().visible=B$O,this.conchModel&&this.conchModel.visible(B$O),this.parentRepaint())}),B$X(0,B$O,"graphics",function(){return this._graphics||(this.graphics=B$P.createGraphics())},function(B$O){this._graphics&&(this._graphics._sp=null),(this._graphics=B$O)?(this._renderType&=-2,this._renderType|=512,(B$O._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(B$D.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),B$X(0,B$O,"filters",function(){return this._$P.filters},function(B$O){B$O&&0===B$O.length&&(B$O=null),this._$P.filters!=B$O&&(this._set$P("filters",B$O?B$O.slice():null),B$N.isConchApp&&(this.conchModel&&(B$D.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),B$N.isWebGL&&(B$O&&B$O.length?this._renderType|=32:this._renderType&=-33),B$O&&0<B$O.length?(this._getBit(1)||this._setUpNoticeType(1),B$N.isWebGL&&1==B$O.length&&B$O[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(B$N.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),B$X(0,B$O,"parent",B$m.prototype._$get_parent,function(B$O){B$a.superSet(B$OO,this,"parent",B$O),B$O&&this._getBit(2)&&this._$2__onDisplay()}),B$X(0,B$O,"mask",function(){return this._$P._mask},function(B$O){B$O&&this.mask&&this.mask._$P.maskParent||(B$O?(this.cacheAs="bitmap",this._set$P("_mask",B$O),B$O._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",B$O),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(B$O?B$O.conchModel:null),this._renderType|=64,this.parentRepaint())}),B$X(0,B$O,"mouseEnabled",function(){return 1<this._mouseEnableState},function(B$O){this._mouseEnableState=B$O?2:1}),B$X(0,B$O,"globalScaleX",function(){for(var B$O=1,B$J=this;B$J&&B$J!==B$a.stage;)B$O*=B$J.scaleX,B$J=B$J.parent;return B$O}),B$X(0,B$O,"mouseX",function(){return this.getMousePoint().x}),B$X(0,B$O,"mouseY",function(){return this.getMousePoint().y}),B$D.fromImage=function(B$O){return(new B$D).loadImage(B$O)},B$D._cachePool=[],B$D.CustomList=[],B$_(B$D,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=B$i.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),B$D}(B$OO),B$YO=function(B$O){function B$J(B$O){this._audio=null,this._onEnd=null,this._resumePlay=null,B$J.__super.call(this),this._onEnd=B$Q.bind(this.__onEnd,this),this._resumePlay=B$Q.bind(this.__resumePlay,this),B$O.addEventListener("ended",this._onEnd),this._audio=B$O}B$r(B$J,"laya.media.h5audio.AudioSoundChannel",B$pO);var B$D=B$J.prototype;return B$D.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(B$a.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},B$D.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,B$l.container.appendChild(this._audio),this._audio.play()}catch(B$O){this.event("error")}},B$D.play=function(B$O){this.isStopped=!1;try{this._audio.playbackRate=B$s.playbackRate,this._audio.currentTime=this.startTime}catch(B$O){return void this._audio.addEventListener("canplay",this._resumePlay)}B$s.addChannel(this),B$l.container.appendChild(this._audio),!B$O&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},B$D.stop=function(){this.isStopped=!0,B$s.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&B$N.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),B$l.onIE||this._audio!=B$DO._musicAudio&&B$Z.recover("audio:"+this.url,this._audio),B$l.removeElement(this._audio),this._audio=null)},B$D.pause=function(){this.isStopped=!0,B$s.removeChannel(this),"pause"in this._audio&&this._audio.pause()},B$D.resume=function(){this._audio&&(this.isStopped=!1,B$s.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},B$X(0,B$D,"position",function(){return this._audio?this._audio.currentTime:0}),B$X(0,B$D,"duration",function(){return this._audio?this._audio.duration:0}),B$X(0,B$D,"volume",function(){return this._audio?this._audio.volume:1},function(B$O){this._audio&&(this._audio.volume=B$O)}),B$J}(),B$GO=function(B$O){function B$J(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=B$CO.ctx,B$J.__super.call(this),this._onPlayEnd=B$Q.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}B$r(B$J,"laya.media.webaudio.WebAudioSoundChannel",B$pO);var B$D=B$J.prototype;return B$D.play=function(B$O){if(B$s.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var B$J=this.context,B$D=this.gain,B$p=B$J.createBufferSource();(this.bufferSource=B$p).buffer=this.audioBuffer,B$p.connect(B$D),B$D&&B$D.disconnect(),B$D.connect(B$J.destination),B$p.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=B$l.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(B$p.loop=!0),B$p.playbackRate.setTargetAtTime?B$p.playbackRate.setTargetAtTime(B$s.playbackRate,this.context.currentTime,.1):B$p.playbackRate.value=B$s.playbackRate,B$p.start(0,this.startTime),!B$O&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},B$D.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(B$a.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},B$D._clearBufferSource=function(){if(this.bufferSource){var B$O=this.bufferSource;B$O.stop?B$O.stop(0):B$O.noteOff(0),B$O.disconnect(0),B$O.onended=null,B$J._tryCleanFailed||this._tryClearBuffer(B$O),this.bufferSource=null}},B$D._tryClearBuffer=function(B$O){try{B$O.buffer=null}catch(B$O){B$J._tryCleanFailed=!0}},B$D.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,B$s.removeChannel(this),this.startHandler=null,this.completeHandler=null},B$D.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,B$s.removeChannel(this)},B$D.resume=function(){this.startTime=this._pauseTime,this.play(!1)},B$X(0,B$D,"position",function(){return this.bufferSource?(B$l.now()-this._startTime)/1e3+this.startTime:0}),B$X(0,B$D,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),B$X(0,B$D,"volume",function(){return this._volume},function(B$O){this.isStopped||(this._volume=B$O,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(B$O,this.context.currentTime,.1):this.gain.gain.value=B$O)}),B$J._tryCleanFailed=!1,B$J}(),B$XO=function(B$O){function B$J(){B$J.__super.call(this),this._w=0,this._h=0}B$r(B$J,"laya.resource.Bitmap",B$LO);var B$D=B$J.prototype;return B$X(0,B$D,"width",function(){return this._w}),B$X(0,B$D,"height",function(){return this._h}),B$X(0,B$D,"source",function(){return this._source}),B$J}(),B$cO=function(B$J){function B$O(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,B$O.__super.call(this),this._interval=B$p.animationInterval,this._setUpNoticeType(1)}B$r(B$O,"laya.display.AnimationPlayerBase",B$J);var B$D=B$O.prototype;return B$D.play=function(B$O,B$J,B$D,B$p){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=!0),void 0===B$D&&(B$D=""),void 0===B$p&&(B$p=!0),this._isPlaying=!0,this.index="string"==typeof B$O?this._getFrameByLabel(B$O):B$O,this.loop=B$J,this._actionName=B$D,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},B$D._getFrameByLabel=function(B$O){var B$J=0;for(B$J=0;B$J<this._count;B$J++)if(this._labels[B$J]&&0<=this._labels[B$J].indexOf(B$O))return B$J;return 0},B$D._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},B$D._setControlNode=function(B$O){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=B$O)&&B$O!=this&&(B$O.on("display",this,this._checkResumePlaying),B$O.on("undisplay",this,this._checkResumePlaying))},B$D._setDisplay=function(B$O){B$J.prototype._setDisplay.call(this,B$O),this._checkResumePlaying()},B$D._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},B$D.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},B$D.addLabel=function(B$O,B$J){this._labels||(this._labels={}),this._labels[B$J]||(this._labels[B$J]=[]),this._labels[B$J].push(B$O)},B$D.removeLabel=function(B$O){if(B$O){if(this._labels)for(var B$J in this._labels)this._removeLabelFromLabelList(this._labels[B$J],B$O)}else this._labels=null},B$D._removeLabelFromLabelList=function(B$O,B$J){if(B$O)for(var B$D=B$O.length-1;0<=B$D;B$D--)B$O[B$D]==B$J&&B$O.splice(B$D,1)},B$D.gotoAndStop=function(B$O){this.index="string"==typeof B$O?this._getFrameByLabel(B$O):B$O,this.stop()},B$D._displayToIndex=function(B$O){},B$D.clear=function(){this.stop(),this._labels=null},B$X(0,B$D,"interval",function(){return this._interval},function(B$O){this._interval!=B$O&&(this._frameRateChanged=!0,this._interval=B$O,this._isPlaying&&0<B$O&&this.timerLoop(B$O,this,this._frameLoop,null,!0,!0))}),B$X(0,B$D,"isPlaying",function(){return this._isPlaying}),B$X(0,B$D,"index",function(){return this._index},function(B$O){if(this._index=B$O,this._displayToIndex(B$O),this._labels&&this._labels[B$O])for(var B$J=this._labels[B$O],B$D=0,B$p=B$J.length;B$D<B$p;B$D++)this.event("label",B$J[B$D])}),B$X(0,B$D,"count",function(){return this._count}),B$O.WRAP_POSITIVE=0,B$O.WRAP_REVERSE=1,B$O.WRAP_PINGPONG=2,B$O}(B$HO),B$hO=function(B$J){function B$G(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,B$G.__super.call(this),this.overflow=B$G.VISIBLE,this._style=new B$JO(this),this._style.wordWrap=!1}B$r(B$G,"laya.display.Text",B$J);var B$O=B$G.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._lines=null,this._words&&(this._words.length=0,this._words=null)},B$O._getBoundPointsM=function(B$O){void 0===B$O&&(B$O=!1);var B$J=B$t.TEMP;return B$J.setTo(0,0,this.width,this.height),B$J._getBoundPoints()},B$O.getGraphicBounds=function(B$O){void 0===B$O&&(B$O=!1);var B$J=B$t.TEMP;return B$J.setTo(0,0,this.width,this.height),B$J},B$O._getCSSStyle=function(){return this._style},B$O.lang=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r){if(B$O=B$G.langPacks&&B$G.langPacks[B$O]?B$G.langPacks[B$O]:B$O,arguments.length<2)this._text=B$O;else{for(var B$H=0,B$Y=arguments.length;B$H<B$Y;B$H++)B$O=B$O.replace("{"+B$H+"}",arguments[B$H+1]);this._text=B$O}},B$O._isPassWordMode=function(){var B$O=this._style.password;return"prompt"in this&&this.prompt==this._text&&(B$O=!1),B$O},B$O._getPassWordTxt=function(B$O){var B$J;B$J="";for(var B$D=B$O.length;0<B$D;B$D--)B$J+="●";return B$J},B$O.renderText=function(B$O,B$J){var B$D=this.graphics;B$D.clear(!0);var B$p=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(B$l.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);B$l.context.font=B$p;var B$m=this.padding,B$C=B$m[3],B$i="left",B$k=this._lines,B$_=this.leading+this._charSize.height,B$L=this._currBitmapFont;B$L&&(B$_=this.leading+B$L.getMaxHeight());var B$r=B$m[0];if(!B$L&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(B$i="right",B$C=this._width-B$m[1]):"center"==this.align&&(B$i="center",B$C=.5*this._width+B$m[3]-B$m[1])),0<this._height){var B$H=this._textHeight>this._height?"top":this.valign;"middle"===B$H?B$r=.5*(this._height-B$J*B$_)+B$m[0]-B$m[2]:"bottom"===B$H&&(B$r=this._height-B$J*B$_-B$m[2])}var B$Y=this._style;if(B$L&&B$L.autoScaleSize)var B$G=B$L.fontSize/this.fontSize;if(this._clipPoint)if(B$D.save(),B$L&&B$L.autoScaleSize){var B$X=0,B$c=0;B$X=this._width?this._width-B$m[3]-B$m[1]:this._textWidth,B$c=this._height?this._height-B$m[0]-B$m[2]:this._textHeight,B$X*=B$G,B$c*=B$G,B$D.clipRect(B$m[3],B$m[0],B$X,B$c)}else B$D.clipRect(B$m[3],B$m[0],this._width?this._width-B$m[3]-B$m[1]:this._textWidth,this._height?this._height-B$m[0]-B$m[2]:this._textHeight);var B$h=B$Y.password;"prompt"in this&&this.prompt==this._text&&(B$h=!1);for(var B$y=0,B$v=0,B$A=Math.min(this._lines.length,B$J+B$O)||1,B$q=B$O;B$q<B$A;B$q++){var B$d,B$M=B$k[B$q];if(B$h){var B$a=B$M.length;B$M="";for(var B$e=B$a;0<B$e;B$e--)B$M+="●"}if(B$y=B$C-(this._clipPoint?this._clipPoint.x:0),B$v=B$r+B$_*B$q-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(B$i,B$y,B$v,B$q),B$L){var B$t=this.width;B$L.autoScaleSize&&(B$t=this.width*B$G),B$L.drawText(B$M,this,B$y,B$v,this.align,B$t)}else B$N.isWebGL?(this._words||(this._words=[]),(B$d=this._words.length>B$q-B$O?this._words[B$q-B$O]:new B$f).setText(B$M)):B$d=B$M,B$Y.stroke?B$D.fillBorderText(B$d,B$y,B$v,B$p,this.color,B$Y.strokeColor,B$Y.stroke,B$i):B$D.fillText(B$d,B$y,B$v,B$p,this.color,B$i)}if(B$L&&B$L.autoScaleSize){var B$z=1/B$G;this.scale(B$z,B$z)}this._clipPoint&&B$D.restore(),this._startX=B$C,this._startY=B$r},B$O.drawUnderline=function(B$O,B$J,B$D,B$p){var B$m=this._lineWidths[B$p];switch(B$O){case"center":B$J-=B$m/2;break;case"right":B$J-=B$m}B$D+=this._charSize.height,this._graphics.drawLine(B$J,B$D,B$J+B$m,B$D,this.underlineColor||this.color,1)},B$O.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);B$l.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new B$e(0,0)):this._clipPoint=null;var B$O=this._lines.length;if(this.overflow!=B$G.VISIBLE){var B$J=this.overflow==B$G.HIDDEN?Math.floor:Math.ceil;B$O=Math.min(B$O,B$J((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var B$D=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(B$D,B$O),this.repaint()},B$O.evalTextSize=function(){var B$O,B$J=NaN;B$O=Math.max.apply(this,this._lineWidths),B$J=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],B$O==this._textWidth&&B$J==this._textHeight||(this._textWidth=B$O,this._textHeight=B$J,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},B$O.checkEnabledViewportOrNot=function(){return this.overflow==B$G.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},B$O.changeText=function(B$O){this._text!==B$O&&(this.lang(B$O+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},B$O.parseLines=function(B$O){var B$J=this.wordWrap||this.overflow==B$G.HIDDEN;if(B$J)var B$D=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var B$p=B$Q.contextMeasureText(B$G._testWord);B$N.isConchApp&&0===B$p.width&&0===B$p.height&&(B$p=B$Q.contextMeasureText("W")),this._charSize.width=B$p.width,this._charSize.height=B$p.height||this.fontSize}for(var B$m=B$O.replace(/\r\n/g,"\n").split("\n"),B$C=0,B$i=B$m.length;B$C<B$i;B$C++){var B$k=B$m[B$C];B$J?this.parseLine(B$k,B$D):(this._lineWidths.push(this.getTextWidth(B$k)),this._lines.push(B$k))}},B$O.parseLine=function(B$O,B$J){B$l.context;var B$D,B$p=this._lines,B$m=0,B$C=NaN,B$i=NaN,B$k=0;if((B$C=this.getTextWidth(B$O))<=B$J)return B$p.push(B$O),void this._lineWidths.push(B$C);B$C=this._charSize.width,0==(B$m=Math.floor(B$J/B$C))&&(B$m=1),B$i=B$C=this.getTextWidth(B$O.substring(0,B$m));for(var B$_=B$m,B$L=B$O.length;B$_<B$L;B$_++)if(B$J<(B$i+=B$C=this.getTextWidth(B$O.charAt(B$_))))if(this.wordWrap){var B$r=B$O.substring(B$k,B$_);if(B$r.charCodeAt(B$r.length-1)<255?(B$D=/(?:\w|-)+$/.exec(B$r))&&(B$_=B$D.index+B$k,0==B$D.index?B$_+=B$r.length:B$r=B$O.substring(B$k,B$_)):B$G.RightToLeft&&(B$D=/([\u0600-\u06FF])+$/.exec(B$r))&&(B$_=B$D.index+B$k,0==B$D.index?B$_+=B$r.length:B$r=B$O.substring(B$k,B$_)),B$p.push(B$r),this._lineWidths.push(B$i-B$C),!((B$k=B$_)+B$m<B$L)){B$p.push(B$O.substring(B$k,B$L)),this._lineWidths.push(this.getTextWidth(B$p[B$p.length-1])),B$k=-1;break}B$_+=B$m,B$i=B$C=this.getTextWidth(B$O.substring(B$k,B$_)),B$_--}else if(this.overflow==B$G.HIDDEN)return B$p.push(B$O.substring(0,B$_)),void this._lineWidths.push(this.getTextWidth(B$p[B$p.length-1]));this.wordWrap&&-1!=B$k&&(B$p.push(B$O.substring(B$k,B$L)),this._lineWidths.push(this.getTextWidth(B$p[B$p.length-1])))},B$O.getTextWidth=function(B$O){return this._currBitmapFont?this._currBitmapFont.getTextWidth(B$O):B$Q.contextMeasureText(B$O).width},B$O.getWordWrapWidth=function(){var B$O=this.padding,B$J=NaN;return(B$J=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(B$J=this.wordWrap?100:B$l.width),B$J<=0&&(B$J=100),B$J-B$O[3]-B$O[1]},B$O.getCharPoint=function(B$O,B$J){this._isChanged&&B$a.timer.runCallLater(this,this.typeset);for(var B$D=0,B$p=this._lines,B$m=0,B$C=0,B$i=B$p.length;B$C<B$i;B$C++){if(B$O<(B$D+=B$p[B$C].length)){var B$k=B$C;break}B$m=B$D}var B$_=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;B$l.context.font=B$_;var B$L=this.getTextWidth(this._text.substring(B$m,B$O));return(B$J||new B$e).setTo(this._startX+B$L-(this._clipPoint?this._clipPoint.x:0),this._startY+B$k*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},B$X(0,B$O,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(B$O){B$O!=this._width&&(B$a.superSet(B$HO,this,"width",B$O),this.isChanged=!0)}),B$X(0,B$O,"textWidth",function(){return this._isChanged&&B$a.timer.runCallLater(this,this.typeset),this._textWidth}),B$X(0,B$O,"height",function(){return this._height?this._height:this.textHeight},function(B$O){B$O!=this._height&&(B$a.superSet(B$HO,this,"height",B$O),this.isChanged=!0)}),B$X(0,B$O,"textHeight",function(){return this._isChanged&&B$a.timer.runCallLater(this,this.typeset),this._textHeight}),B$X(0,B$O,"padding",function(){return this._getCSSStyle().padding},function(B$O){this._getCSSStyle().padding=B$O,this.isChanged=!0}),B$X(0,B$O,"bold",function(){return this._getCSSStyle().bold},function(B$O){this._getCSSStyle().bold=B$O,this.isChanged=!0}),B$X(0,B$O,"text",function(){return this._text||""},function(B$O){this._text!==B$O&&(this.lang(B$O+""),this.isChanged=!0,this.event("change"))}),B$X(0,B$O,"color",function(){return this._getCSSStyle().color},function(B$O){this._getCSSStyle().color!=B$O&&(this._getCSSStyle().color=B$O,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),B$X(0,B$O,"font",function(){return this._getCSSStyle().fontFamily},function(B$O){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),B$G._bitmapFonts&&B$G._bitmapFonts[B$O]&&(this._currBitmapFont=B$G._bitmapFonts[B$O]),this._getCSSStyle().fontFamily=B$O,this.isChanged=!0}),B$X(0,B$O,"fontSize",function(){return this._getCSSStyle().fontSize},function(B$O){this._getCSSStyle().fontSize=B$O,this.isChanged=!0}),B$X(0,B$O,"italic",function(){return this._getCSSStyle().italic},function(B$O){this._getCSSStyle().italic=B$O,this.isChanged=!0}),B$X(0,B$O,"align",function(){return this._getCSSStyle().align},function(B$O){this._getCSSStyle().align=B$O,this.isChanged=!0}),B$X(0,B$O,"valign",function(){return this._getCSSStyle().valign},function(B$O){this._getCSSStyle().valign=B$O,this.isChanged=!0}),B$X(0,B$O,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(B$O){this._getCSSStyle().wordWrap=B$O,this.isChanged=!0}),B$X(0,B$O,"leading",function(){return this._getCSSStyle().leading},function(B$O){this._getCSSStyle().leading=B$O,this.isChanged=!0}),B$X(0,B$O,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(B$O){this._getCSSStyle().backgroundColor=B$O,this.isChanged=!0}),B$X(0,B$O,"borderColor",function(){return this._getCSSStyle().borderColor},function(B$O){this._getCSSStyle().borderColor=B$O,this.isChanged=!0}),B$X(0,B$O,"stroke",function(){return this._getCSSStyle().stroke},function(B$O){this._getCSSStyle().stroke=B$O,this.isChanged=!0}),B$X(0,B$O,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(B$O){this._getCSSStyle().strokeColor=B$O,this.isChanged=!0}),B$X(0,B$O,"isChanged",null,function(B$O){this._isChanged!==B$O&&(this._isChanged=B$O)&&B$a.timer.callLater(this,this.typeset)}),B$X(0,B$O,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(B$O){if(!(this.overflow!=B$G.SCROLL||this.textWidth<this._width)&&this._clipPoint){B$O=B$O<this.padding[3]?this.padding[3]:B$O;var B$J=this._textWidth-this._width;B$O=B$J<B$O?B$J:B$O;var B$D=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=B$O,this.renderText(this._lastVisibleLineIndex,B$D)}}),B$X(0,B$O,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(B$O){if(!(this.overflow!=B$G.SCROLL||this.textHeight<this._height)&&this._clipPoint){B$O=B$O<this.padding[0]?this.padding[0]:B$O;var B$J=this._textHeight-this._height,B$D=(B$O=B$J<B$O?B$J:B$O)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=B$D;var B$p=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=B$O,this.renderText(B$D,B$p)}}),B$X(0,B$O,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),B$X(0,B$O,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),B$X(0,B$O,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),B$X(0,B$O,"underlineColor",function(){return this._underlineColor},function(B$O){this._underlineColor=B$O,this._isChanged=!0,this.typeset()}),B$G.registerBitmapFont=function(B$O,B$J){B$G._bitmapFonts||(B$G._bitmapFonts={}),B$G._bitmapFonts[B$O]=B$J},B$G.unregisterBitmapFont=function(B$O,B$J){if(void 0===B$J&&(B$J=!0),B$G._bitmapFonts&&B$G._bitmapFonts[B$O]){var B$D=B$G._bitmapFonts[B$O];B$J&&B$D.destroy(),delete B$G._bitmapFonts[B$O]}},B$G.setTextRightToLeft=function(){var B$O;(B$O=B$l.canvas.source.style).display="none",B$O.position="absolute",B$O.direction="rtl",B$N._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,B$l.document.body.appendChild(B$l.canvas.source)},B$G.supportFont=function(B$O){B$l.context.font="10px sans-serif";var B$J=B$Q.contextMeasureText("abcji").width;B$l.context.font="10px "+B$O;var B$D=B$Q.contextMeasureText("abcji").width;return console.log(B$J,B$D),B$J!==B$D},B$G._testWord="游",B$G.langPacks=null,B$G.VISIBLE="visible",B$G.SCROLL="scroll",B$G.HIDDEN="hidden",B$G.CharacterCache=!0,B$G.RightToLeft=!1,B$G._bitmapFonts=null,B$_(B$G,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),B$G}(B$HO),B$yO=function(B$H){function B$i(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",B$i.__super.call(this),this.offset=new B$e,this._canvasTransform=new B$E,this._previousOrientation=B$l.window.orientation;var B$J=this;this.transform=B$E.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var B$O=B$l.window,B$D=this;B$O.addEventListener("focus",function(){B$J._isFocused=!0,B$D.event("focus"),B$D.event("focuschange")}),B$O.addEventListener("blur",function(){B$J._isFocused=!1,B$D.event("blur"),B$D.event("focuschange"),B$D._isInputting()&&(B$dO.inputElement.target.focus=!1)});var B$p="visibilityState",B$m="visibilitychange",B$C=B$O.document;void 0!==B$C.hidden?(B$m="visibilitychange",B$p="visibilityState"):void 0!==B$C.mozHidden?(B$m="mozvisibilitychange",B$p="mozVisibilityState"):void 0!==B$C.msHidden?(B$m="msvisibilitychange",B$p="msVisibilityState"):void 0!==B$C.webkitHidden&&(B$m="webkitvisibilitychange",B$p="webkitVisibilityState"),B$O.document.addEventListener(B$m,function(){"hidden"==B$l.document[B$p]?B$D._setStageVisible(!1):B$D._setStageVisible(!0)}),B$O.document.addEventListener("qbrowserVisibilityChange",function(B$O){B$D._setStageVisible(!B$O.hidden)}),B$O.addEventListener("resize",function(){var B$O=B$l.window.orientation;null!=B$O&&B$O!=B$J._previousOrientation&&B$D._isInputting()&&(B$dO.inputElement.target.focus=!1),B$J._previousOrientation=B$O,B$D._isInputting()||B$D._resetCanvas()}),B$O.addEventListener("orientationchange",function(B$O){B$D._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),B$l.onMobile&&this.on("mousedown",this,this._onmouseMove)}B$r(B$i,"laya.display.Stage",B$H);var B$O=B$i.prototype;return B$O._setStageVisible=function(B$O){this._isVisibility!=B$O&&(this._isVisibility=B$O,this._isVisibility||this._isInputting()&&(B$dO.inputElement.target.focus=!1),this.event("visibilitychange"))},B$O._isInputting=function(){return B$l.onMobile&&B$dO.isInputting},B$O._changeCanvasSize=function(){this.setScreenSize(B$l.clientWidth*B$l.pixelRatio,B$l.clientHeight*B$l.pixelRatio)},B$O._resetCanvas=function(){if(this.screenAdaptationEnabled){var B$O=B$N._mainCanvas;B$O.source.style;B$O.size(1,1),B$a.timer.once(100,this,this._changeCanvasSize)}},B$O.setScreenSize=function(B$O,B$J){var B$D=!1;if("none"!==this._screenMode&&(B$D=(B$O/B$J<1?"vertical":"horizontal")!==this._screenMode)){var B$p=B$J;B$J=B$O,B$O=B$p}this.canvasRotation=B$D;var B$m=B$N._mainCanvas,B$C=B$m.source.style,B$i=this._canvasTransform.identity(),B$k=this._scaleMode,B$_=B$O/this.designWidth,B$L=B$J/this.designHeight,B$r=this.designWidth,B$H=this.designHeight,B$Y=B$O,B$G=B$J,B$X=B$l.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,B$k){case"noscale":B$_=B$L=1,B$Y=this.designWidth,B$G=this.designHeight;break;case"showall":B$_=B$L=Math.min(B$_,B$L),B$r=B$Y=Math.round(this.designWidth*B$_),B$H=B$G=Math.round(this.designHeight*B$L);break;case"noborder":B$_=B$L=Math.max(B$_,B$L),B$Y=Math.round(this.designWidth*B$_),B$G=Math.round(this.designHeight*B$L);break;case"full":B$_=B$L=1,this._width=B$r=B$O,this._height=B$H=B$J;break;case"fixedwidth":B$L=B$_,this._height=B$H=Math.round(B$J/B$_);break;case"fixedheight":B$_=B$L,this._width=B$r=Math.round(B$O/B$L);break;case"fixedauto":B$O/B$J<this.designWidth/this.designHeight?(B$L=B$_,this._height=B$H=Math.round(B$J/B$_)):(B$_=B$L,this._width=B$r=Math.round(B$O/B$L))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,B$r=B$r+1&2147483646,B$H=B$H+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),B$_*=this.scaleX,B$L*=this.scaleY,1===B$_&&1===B$L?this.transform.identity():(this.transform.a=this._formatData(B$_/(B$Y/B$r)),this.transform.d=this._formatData(B$L/(B$G/B$H)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),B$m.size(B$r,B$H),B$P.changeWebGLSize(B$r,B$H),B$i.scale(B$Y/B$r/B$X,B$G/B$H/B$X),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(B$O-B$Y)/B$X:this.offset.x=.5*(B$O-B$Y)/B$X,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(B$J-B$G)/B$X:this.offset.y=.5*(B$J-B$G)/B$X,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),B$i.translate(this.offset.x,this.offset.y),this.canvasDegree=0,B$D&&("horizontal"===this._screenMode?(B$i.rotate(Math.PI/2),B$i.translate(B$J/B$X,0),this.canvasDegree=90):(B$i.rotate(-Math.PI/2),B$i.translate(0,B$O/B$X),this.canvasDegree=-90)),B$i.a=this._formatData(B$i.a),B$i.d=this._formatData(B$i.d),B$i.tx=this._formatData(B$i.tx),B$i.ty=this._formatData(B$i.ty),B$C.transformOrigin=B$C.webkitTransformOrigin=B$C.msTransformOrigin=B$C.mozTransformOrigin=B$C.oTransformOrigin="0px 0px 0px",B$C.transform=B$C.webkitTransform=B$C.msTransform=B$C.mozTransform=B$C.oTransform="matrix("+B$i.toString()+")",B$i.translate(parseInt(B$C.left)||0,parseInt(B$C.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},B$O._formatData=function(B$O){return Math.abs(B$O)<1e-6?0:Math.abs(1-B$O)<.001?0<B$O?1:-1:B$O},B$O.getMousePoint=function(){return B$e.TEMP.setTo(this.mouseX,this.mouseY)},B$O.repaint=function(){this._repaint=1},B$O.parentRepaint=function(){},B$O._loop=function(){return this.render(B$N.context,0,0),!0},B$O._onmouseMove=function(B$O){this._mouseMoveTime=B$l.now()},B$O.getTimeFromFrameStart=function(){return B$l.now()-this._frameStartTime},B$O.render=function(B$O,B$J,B$D){if("sleep"===this._frameRate&&!B$N.isConchApp){var B$p=B$l.now();if(!(1e3<=B$p-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(B$n.loopCount++,B$c.instance.runEvent(),B$a.timer._update()));this._frameStartTime=B$p}if(this._renderCount++,B$N.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=B$l.now();var B$m="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),B$C=this._renderCount%2==0;if(B$n.renderSlow=!B$m,B$m||B$C||B$N.isConchApp){var B$i;B$n.loopCount++,B$c.instance.runEvent(),B$a.timer._update(),B$P.update3DLoop();var B$k=0,B$_=0;if(B$N.isConchNode)for(B$k=0,B$_=this._scenes.length;B$k<B$_;B$k++)(B$i=this._scenes[B$k])&&B$i._updateSceneConch();else for(B$k=0,B$_=this._scenes.length;B$k<B$_;B$k++)(B$i=this._scenes[B$k])&&B$i._updateScene();if(B$N.isConchNode){var B$L=B$HO.CustomList;for(B$k=0,B$_=B$L.length;B$k<B$_;B$k++){var B$r=B$L[B$k];B$r.customRender(B$r.customContext,0,0)}return}}B$N.isConchNode||this.renderingEnabled&&(B$m||!B$C||B$N.isConchWebGL)&&(B$N.isWebGL?B$N.WebGL.mainContext&&!B$N.WebGL.mainContext.isContextLost()&&(B$O.clear(),B$H.prototype.render.call(this,B$O,B$J,B$D),B$n._show&&B$n._sp&&B$n._sp.render(B$O,B$J,B$D),B$P.clear(this._bgColor),B$P.beginFlush(),B$O.flush(),B$P.endFinish(),B$b.instance&&B$b.getInstance().endDispose()):(B$P.clear(this._bgColor),B$H.prototype.render.call(this,B$O,B$J,B$D),B$n._show&&B$n._sp&&B$n._sp.render(B$O,B$J,B$D)))}else this._renderCount%5==0&&(B$n.loopCount++,B$c.instance.runEvent(),B$a.timer._update())},B$O._requestFullscreen=function(){var B$O=B$l.document.documentElement;B$O.requestFullscreen?B$O.requestFullscreen():B$O.mozRequestFullScreen?B$O.mozRequestFullScreen():B$O.webkitRequestFullscreen?B$O.webkitRequestFullscreen():B$O.msRequestFullscreen&&B$O.msRequestFullscreen()},B$O._fullScreenChanged=function(){B$a.stage.event("fullscreenchange")},B$O.exitFullscreen=function(){var B$O=B$l.document;B$O.exitFullscreen?B$O.exitFullscreen():B$O.mozCancelFullScreen?B$O.mozCancelFullScreen():B$O.webkitExitFullscreen&&B$O.webkitExitFullscreen()},B$X(0,B$O,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),B$X(0,B$O,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),B$X(0,B$O,"frameRate",function(){return this._frameRate},function(B$O){if(this._frameRate=B$O,B$N.isConchApp)switch(this._frameRate){case"slow":B$l.window.conch&&B$l.window.conchConfig.setSlowFrame&&B$l.window.conchConfig.setSlowFrame(!0);break;case"fast":B$l.window.conch&&B$l.window.conchConfig.setSlowFrame&&B$l.window.conchConfig.setSlowFrame(!1);break;case"mouse":B$l.window.conch&&B$l.window.conchConfig.setMouseFrame&&B$l.window.conchConfig.setMouseFrame(2e3);break;case"sleep":B$l.window.conch&&B$l.window.conchConfig.setLimitFPS&&B$l.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),B$X(0,B$O,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),B$X(0,B$O,"width",B$H.prototype._$get_width,function(B$O){this.designWidth=B$O,B$a.superSet(B$HO,this,"width",B$O),B$a.timer.callLater(this,this._changeCanvasSize)}),B$X(0,B$O,"alignH",function(){return this._alignH},function(B$O){this._alignH=B$O,B$a.timer.callLater(this,this._changeCanvasSize)}),B$X(0,B$O,"isFocused",function(){return this._isFocused}),B$X(0,B$O,"height",B$H.prototype._$get_height,function(B$O){this.designHeight=B$O,B$a.superSet(B$HO,this,"height",B$O),B$a.timer.callLater(this,this._changeCanvasSize)}),B$X(0,B$O,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||B$E.create()},B$H.prototype._$set_transform),B$X(0,B$O,"isVisibility",function(){return this._isVisibility}),B$X(0,B$O,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),B$X(0,B$O,"scaleMode",function(){return this._scaleMode},function(B$O){this._scaleMode=B$O,B$a.timer.callLater(this,this._changeCanvasSize)}),B$X(0,B$O,"alignV",function(){return this._alignV},function(B$O){this._alignV=B$O,B$a.timer.callLater(this,this._changeCanvasSize)}),B$X(0,B$O,"bgColor",function(){return this._bgColor},function(B$O){this._bgColor=B$O,this.conchModel&&this.conchModel.bgColor(B$O),B$N.isWebGL&&(B$O?B$i._wgColor=B$T.create(B$O)._color:B$l.onMiniGame||(B$i._wgColor=null)),B$l.onLimixiu?B$i._wgColor=B$T.create(B$O)._color:B$N.canvas.style.background=B$O||"none"}),B$X(0,B$O,"mouseX",function(){return Math.round(B$c.instance.mouseX/this.clientScaleX)}),B$X(0,B$O,"mouseY",function(){return Math.round(B$c.instance.mouseY/this.clientScaleY)}),B$X(0,B$O,"screenMode",function(){return this._screenMode},function(B$O){this._screenMode=B$O}),B$X(0,B$O,"visible",B$H.prototype._$get_visible,function(B$O){this.visible!==B$O&&(B$a.superSet(B$HO,this,"visible",B$O),B$N._mainCanvas.source.style.visibility=B$O?"visible":"hidden")}),B$X(0,B$O,"fullScreenEnabled",null,function(B$O){var B$J=B$l.document,B$D=B$N.canvas;B$O?(B$D.addEventListener("mousedown",this._requestFullscreen),B$D.addEventListener("touchstart",this._requestFullscreen),B$J.addEventListener("fullscreenchange",this._fullScreenChanged),B$J.addEventListener("mozfullscreenchange",this._fullScreenChanged),B$J.addEventListener("webkitfullscreenchange",this._fullScreenChanged),B$J.addEventListener("msfullscreenchange",this._fullScreenChanged)):(B$D.removeEventListener("mousedown",this._requestFullscreen),B$D.removeEventListener("touchstart",this._requestFullscreen),B$J.removeEventListener("fullscreenchange",this._fullScreenChanged),B$J.removeEventListener("mozfullscreenchange",this._fullScreenChanged),B$J.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),B$J.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),B$i.SCALE_NOSCALE="noscale",B$i.SCALE_EXACTFIT="exactfit",B$i.SCALE_SHOWALL="showall",B$i.SCALE_NOBORDER="noborder",B$i.SCALE_FULL="full",B$i.SCALE_FIXED_WIDTH="fixedwidth",B$i.SCALE_FIXED_HEIGHT="fixedheight",B$i.SCALE_FIXED_AUTO="fixedauto",B$i.ALIGN_LEFT="left",B$i.ALIGN_RIGHT="right",B$i.ALIGN_CENTER="center",B$i.ALIGN_TOP="top",B$i.ALIGN_MIDDLE="middle",B$i.ALIGN_BOTTOM="bottom",B$i.SCREEN_NONE="none",B$i.SCREEN_HORIZONTAL="horizontal",B$i.SCREEN_VERTICAL="vertical",B$i.FRAME_FAST="fast",B$i.FRAME_SLOW="slow",B$i.FRAME_MOUSE="mouse",B$i.FRAME_SLEEP="sleep",B$i.FRAME_MOUSE_THREDHOLD=2e3,B$_(B$i,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),B$i}(B$HO),B$vO=(function(B$O){function B$J(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,B$J.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}B$r(B$J,"laya.media.SoundNode",B$HO);var B$D=B$J.prototype;B$D._onParentChange=function(){this.target=this.parent},B$D.play=function(B$O,B$J){void 0===B$O&&(B$O=1),isNaN(B$O)&&(B$O=1),this.url&&(this.stop(),this._channel=B$s.playSound(this.url,B$O,null,B$J))},B$D.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},B$D._setPlayAction=function(B$O,B$J,B$D,B$p){void 0===B$p&&(B$p=!0),this[B$D]&&B$O&&(B$p?B$O.on(B$J,this,this[B$D]):B$O.off(B$J,this,this[B$D]))},B$D._setPlayActions=function(B$O,B$J,B$D,B$p){if(void 0===B$p&&(B$p=!0),B$O&&B$J){var B$m,B$C=B$J.split(","),B$i=0;for(B$m=B$C.length,B$i=0;B$i<B$m;B$i++)this._setPlayAction(B$O,B$C[B$i],B$D,B$p)}},B$X(0,B$D,"playEvent",null,function(B$O){(this._playEvents=B$O)&&this._tar&&this._setPlayActions(this._tar,B$O,"play")}),B$X(0,B$D,"target",null,function(B$O){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=B$O,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),B$X(0,B$D,"stopEvent",null,function(B$O){(this._stopEvents=B$O)&&this._tar&&this._setPlayActions(this._tar,B$O,"stop")})}(),function(B$O){function B$J(){this._src=null,this._onload=null,this._onerror=null,B$J.__super.call(this)}B$r(B$J,"laya.resource.FileBitmap",B$XO);var B$D=B$J.prototype;return B$X(0,B$D,"src",function(){return this._src},function(B$O){this._src=B$O}),B$X(0,B$D,"onload",null,function(B$O){}),B$X(0,B$D,"onerror",null,function(B$O){}),B$J}()),B$AO=function(B$O){function B$D(B$O,B$J){this._is2D=!1,B$D.__super.call(this);var B$p=this;if(this._source=this,"2D"===B$O||"AUTO"===B$O&&!B$N.isWebGL){this._is2D=!0,this._source=B$J||B$l.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var B$m=this;B$m.getContext=function(B$O,B$J){if(B$p._ctx)return B$p._ctx;var B$D=B$p._ctx=B$p._source.getContext(B$O,B$J);return B$D&&(B$D._canvas=B$m,B$N.isFlash||B$l.onLimixiu||(B$D.size=function(B$O,B$J){})),B$D}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}B$r(B$D,"laya.resource.HTMLCanvas",B$XO);var B$J=B$D.prototype;return B$J.clear=function(){this._ctx&&this._ctx.clear()},B$J.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},B$J.release=function(){},B$J._setContext=function(B$O){this._ctx=B$O},B$J.getContext=function(B$O,B$J){return this._ctx?this._ctx:this._ctx=B$D._createContext(this)},B$J.getMemSize=function(){return 0},B$J.size=function(B$O,B$J){(this._w!=B$O||this._h!=B$J||this._source&&(this._source.width!=B$O||this._source.height!=B$J))&&(this._w=B$O,this._h=B$J,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(B$O,B$J),this._source&&(this._source.height=B$J,this._source.width=B$O))},B$J.getCanvas=function(){return this._source},B$J.toBase64=function(B$O,B$J,B$D){if(this._source)if(B$N.isConchApp&&this._source.toBase64)this._source.toBase64(B$O,B$J,B$D);else{var B$p=this._source.toDataURL(B$O,B$J);B$D.call(this,B$p)}},B$X(0,B$J,"context",function(){return this._ctx}),B$X(0,B$J,"asBitmap",null,function(B$O){}),B$D.create=function(B$O,B$J){return new B$D(B$O,B$J)},B$D.TYPE2D="2D",B$D.TYPE3D="3D",B$D.TYPEAUTO="AUTO",B$D._createContext=null,B$D}(),B$qO=(function(B$O){function B$_(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){throw B$_.__super.call(this),new Error("不允许new！")}B$r(B$_,"laya.resource.HTMLSubImage",B$XO),B$_.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){return void 0===B$k&&(B$k=!1),new B$_(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k)}}(),function(B$O){function B$H(){this._frames=null,this._url=null,B$H.__super.call(this),this._setControlNode(this)}B$r(B$H,"laya.display.Animation",B$O);var B$J=B$H.prototype;B$J.destroy=function(B$O){void 0===B$O&&(B$O=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,B$O),this._frames=null,this._labels=null},B$J.play=function(B$O,B$J,B$D,B$p){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=!0),void 0===B$D&&(B$D=""),void 0===B$p&&(B$p=!0),B$D&&this._setFramesFromCache(B$D,B$p),this._isPlaying=!0,this.index="string"==typeof B$O?this._getFrameByLabel(B$O):B$O,this.loop=B$J,this._actionName=B$D,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},B$J._setFramesFromCache=function(B$O,B$J){var B$D;return void 0===B$J&&(B$J=!1),this._url&&(B$O=this._url+"#"+B$O),B$O&&B$H.framesMap[B$O]?((B$D=B$H.framesMap[B$O])instanceof Array?(this._frames=B$H.framesMap[B$O],this._count=this._frames.length):(B$D.nodeRoot&&(B$H.framesMap[B$O]=this._parseGraphicAnimationByData(B$D),B$D=B$H.framesMap[B$O]),this._frames=B$D.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=B$D.interval),this._labels=this._copyLabels(B$D.labels)),!0):(B$J&&console.log("ani not found:",B$O),!1)},B$J._copyLabels=function(B$O){if(!B$O)return null;var B$J,B$D;for(B$D in B$J={},B$O)B$J[B$D]=B$Q.copyArray([],B$O[B$D]);return B$J},B$J._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&B$O.prototype._frameLoop.call(this)},B$J._displayToIndex=function(B$O){this._frames&&(this.graphics=this._frames[B$O])},B$J.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},B$J.loadImages=function(B$O,B$J){return void 0===B$J&&(B$J=""),this._url="",this._setFramesFromCache(B$J)||(this.frames=B$H.framesMap[B$J]?B$H.framesMap[B$J]:B$H.createFrames(B$O,B$J)),this},B$J.loadAtlas=function(B$J,B$D,B$p){void 0===B$p&&(B$p=""),this._url="";var B$m=this;function B$O(B$O){B$J===B$O&&(B$m.frames=B$H.framesMap[B$p]?B$H.framesMap[B$p]:B$H.createFrames(B$J,B$p),B$D&&B$D.run())}return B$m._setFramesFromCache(B$p)||(B$kO.getAtlas(B$J)?B$O(B$J):B$a.loader.load(B$J,B$v.create(null,B$O,[B$J]),null,"atlas")),this},B$J.loadAnimation=function(B$O,B$J,B$D){this._url=B$O;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,B$J&&B$J.run()):!B$D||B$kO.getAtlas(B$D)?this._loadAnimationData(B$O,B$J,B$D):B$a.loader.load(B$D,B$v.create(this,this._loadAnimationData,[B$O,B$J,B$D]),null,"atlas"),this},B$J._loadAnimationData=function(B$k,B$_,B$O){var B$L=this;if(!B$O||B$kO.getAtlas(B$O)){var B$r=this;B$kO.getRes(B$k)?B$J(B$k):B$a.loader.load(B$k,B$v.create(null,B$J,[B$k]),null,"json"),B$kO.clearRes(B$k)}else console.warn("atlas load fail:"+B$O);function B$J(B$O){if(B$kO.getRes(B$O)&&B$k===B$O){var B$J;if(B$H.framesMap[B$k+"#"])B$r._setFramesFromCache(B$L._actionName,!0),B$L.index=0,B$L._checkResumePlaying();else{var B$D=B$r._parseGraphicAnimation(B$kO.getRes(B$k));if(!B$D)return;var B$p,B$m=B$D.animationList,B$C=0,B$i=B$m.length;for(B$C=0;B$C<B$i;B$C++)B$J=B$m[B$C],B$H.framesMap[B$k+"#"+B$J.name]=B$J,B$p||(B$p=B$J);B$p&&(B$H.framesMap[B$k+"#"]=B$p,B$r._setFramesFromCache(B$L._actionName,!0),B$L.index=0),B$L._checkResumePlaying()}B$_&&B$_.run()}}},B$J._parseGraphicAnimation=function(B$O){return B$aO.parseAnimationData(B$O)},B$J._parseGraphicAnimationByData=function(B$O){return B$aO.parseAnimationByData(B$O)},B$X(0,B$J,"frames",function(){return this._frames},function(B$O){(this._frames=B$O)&&(this._count=B$O.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),B$X(0,B$J,"autoPlay",null,function(B$O){B$O?this.play():this.stop()}),B$X(0,B$J,"source",null,function(B$O){-1<B$O.indexOf(".ani")?this.loadAnimation(B$O):-1<B$O.indexOf(".json")||-1<B$O.indexOf("als")||-1<B$O.indexOf("atlas")?this.loadAtlas(B$O):this.loadImages(B$O.split(","))}),B$X(0,B$J,"autoAnimation",null,function(B$O){this.play(0,!0,B$O,!1)}),B$H.createFrames=function(B$O,B$J){var B$D,B$p,B$m=0,B$C=0;if("string"==typeof B$O){var B$i=B$kO.getAtlas(B$O);if(B$i&&B$i.length)for(B$D=[],B$m=0,B$C=B$i.length;B$m<B$C;B$m++)(B$p=new B$P.createGraphics).drawTexture(B$kO.getRes(B$i[B$m]),0,0),B$D.push(B$p)}else if(B$O instanceof Array)for(B$D=[],B$m=0,B$C=B$O.length;B$m<B$C;B$m++)(B$p=new B$P.createGraphics).loadImage(B$O[B$m],0,0),B$D.push(B$p);return B$J&&(B$H.framesMap[B$J]=B$D),B$D},B$H.clearCache=function(B$O){var B$J,B$D=B$H.framesMap,B$p=B$O+"#";for(B$J in B$D)B$J!==B$O&&0!=B$J.indexOf(B$p)||delete B$H.framesMap[B$J]},B$H.framesMap={}}(B$cO),function(B$O){function B$C(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,B$C.__super.call(this),null==B$C._sortIndexFun&&(B$C._sortIndexFun=B$M.sortByKey("index",!1,!0))}B$r(B$C,"laya.display.FrameAnimation",B$O);var B$J=B$C.prototype;return B$J._setUp=function(B$O,B$J){this._labels=null,this._animationNewFrames=null,this._targetDic=B$O,this._animationData=B$J,this.interval=1e3/B$J.frameRate,B$J.parsed?(this._count=B$J.count,this._labels=B$J.labels,this._animationNewFrames=B$J.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),B$J.parsed=!0,B$J.labels=this._labels,B$J.count=this._count,B$J.animationNewFrames=this._animationNewFrames},B$J.clear=function(){B$O.prototype.clear.call(this),this._targetDic=null,this._animationData=null},B$J._displayToIndex=function(B$O){if(this._animationData){B$O<0&&(B$O=0),B$O>this._count&&(B$O=this._count);var B$J=this._animationData.nodes,B$D=0,B$p=B$J.length;for(B$D=0;B$D<B$p;B$D++)this._displayNodeToFrame(B$J[B$D],B$O)}},B$J._displayNodeToFrame=function(B$O,B$J,B$D){B$D||(B$D=this._targetDic);var B$p=B$D[B$O.target];if(B$p){var B$m,B$C,B$i,B$k=B$O.frames,B$_=B$O.keys,B$L=0,B$r=B$_.length;for(B$L=0;B$L<B$r;B$L++)B$i=(B$C=B$k[B$m=B$_[B$L]]).length>B$J?B$C[B$J]:B$C[B$C.length-1],B$p[B$m]=B$i}},B$J._calculateDatas=function(){if(this._animationData){var B$O,B$J=this._animationData.nodes,B$D=0,B$p=B$J.length;for(B$D=this._count=0;B$D<B$p;B$D++)B$O=B$J[B$D],this._calculateNodeKeyFrames(B$O);this._count+=1}},B$J._calculateNodeKeyFrames=function(B$O){var B$J,B$D,B$p=B$O.keyframes,B$m=B$O.target;for(B$J in B$O.frames||(B$O.frames={}),B$O.keys?B$O.keys.length=0:B$O.keys=[],B$O.initValues||(B$O.initValues={}),B$p)B$D=B$p[B$J],B$O.frames[B$J]||(B$O.frames[B$J]=[]),this._targetDic&&this._targetDic[B$m]&&(B$O.initValues[B$J]=this._targetDic[B$m][B$J]),B$D.sort(B$C._sortIndexFun),B$O.keys.push(B$J),this._calculateNodePropFrames(B$D,B$O.frames[B$J],B$J,B$m)},B$J.resetToInitState=function(){if(this._targetDic&&this._animationData){var B$O,B$J,B$D=this._animationData.nodes,B$p=0,B$m=B$D.length;for(B$p=0;B$p<B$m;B$p++)if(B$J=(B$O=B$D[B$p]).initValues){var B$C,B$i=this._targetDic[B$O.target];if(B$i)for(B$C in B$J)B$i[B$C]=B$J[B$C]}}},B$J._calculateNodePropFrames=function(B$O,B$J,B$D,B$p){var B$m=0,B$C=B$O.length-1;if(0<B$C){for(B$J.length=B$O[B$C].index+1,B$m=0;B$m<B$C;B$m++)this._dealKeyFrame(B$O[B$m]),this._calculateFrameValues(B$O[B$m],B$O[B$m+1],B$J);this._dealKeyFrame(B$O[B$m])}0==B$C&&(B$J[B$O[0].index]=B$O[0].value,this._animationNewFrames&&(this._animationNewFrames[B$O[0].index]=!0))},B$J._dealKeyFrame=function(B$O){B$O.label&&""!=B$O.label&&this.addLabel(B$O.label,B$O.index)},B$J._calculateFrameValues=function(B$O,B$J,B$D){var B$p,B$m=0,B$C=B$O.index,B$i=B$J.index,B$k=B$O.value,B$_=B$J.value-B$O.value,B$L=B$i-B$C;if(B$i>this._count&&(this._count=B$i),B$O.tween)for(null==(B$p=B$w[B$O.tweenMethod])&&(B$p=B$w.linearNone),B$m=B$C;B$m<B$i;B$m++)B$D[B$m]=B$p(B$m-B$C,B$k,B$_,B$L),this._animationNewFrames&&(this._animationNewFrames[B$m]=!0);else for(B$m=B$C;B$m<B$i;B$m++)B$D[B$m]=B$k;this._animationNewFrames&&(this._animationNewFrames[B$O.index]=!0,this._animationNewFrames[B$J.index]=!0),B$D[B$J.index]=B$J.value},B$C._sortIndexFun=null,B$C}(B$cO)),B$dO=function(B$J){function B$m(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",B$m.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=B$hO.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}B$r(B$m,"laya.display.Input",B$J);var B$O=B$m.prototype;return B$O.setSelection=function(B$O,B$J){this.focus=!0,laya.display.Input.inputElement.selectionStart=B$O,laya.display.Input.inputElement.selectionEnd=B$J},B$O._onUnDisplay=function(B$O){this.focus=!1},B$O._onMouseDown=function(B$O){this.focus=!0},B$O._syncInputTransform=function(){var B$O=this.nativeInput,B$J=B$Q.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),B$D=this._width-this.padding[1]-this.padding[3],B$p=this._height-this.padding[0]-this.padding[2];B$N.isConchApp?(B$O.setScale(B$J.scaleX,B$J.scaleY),B$O.setSize(B$D,B$p),B$O.setPos(B$J.x,B$J.y)):(B$m.inputContainer.style.transform=B$m.inputContainer.style.webkitTransform="scale("+B$J.scaleX+","+B$J.scaleY+") rotate("+B$a.stage.canvasDegree+"deg)",B$O.style.width=B$D+"px",B$O.style.height=B$p+"px",B$m.inputContainer.style.left=B$J.x+"px",B$m.inputContainer.style.top=B$J.y+"px")},B$O.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},B$O._setInputMethod=function(){B$m.input.parentElement&&B$m.inputContainer.removeChild(B$m.input),B$m.area.parentElement&&B$m.inputContainer.removeChild(B$m.area),B$m.inputElement=this._multiline?B$m.area:B$m.input,B$m.inputContainer.appendChild(B$m.inputElement),B$hO.RightToLeft&&(B$m.inputElement.style.direction="rtl")},B$O._focusIn=function(){laya.display.Input.isInputting=!0;var B$O=this.nativeInput;this._focus=!0;var B$J=B$O.style;B$J.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),B$O.readOnly=!this._editable,B$N.isConchApp&&(B$O.setType(this._type),B$O.setForbidEdit(!this._editable)),B$O.maxLength=this._maxChars;this.padding;if(B$O.type=this._type,B$O.value=this._content,B$O.placeholder=this._prompt,B$a.stage.off("keydown",this,this._onKeyDown),B$a.stage.on("keydown",this,this._onKeyDown),(B$a.stage.focus=this).event("focus"),B$l.onPC&&B$O.focus(),!B$l.onMiniGame){this._text;this._text=null}this.typeset(),B$O.setColor(this._originColor),B$O.setFontSize(this.fontSize),B$O.setFontFace(B$l.onIPhone&&B$hO._fontFamilyMap[this.font]||this.font),B$N.isConchApp&&B$O.setMultiAble&&B$O.setMultiAble(this._multiline),B$J.lineHeight=this.leading+this.fontSize+"px",B$J.fontStyle=this.italic?"italic":"normal",B$J.fontWeight=this.bold?"bold":"normal",B$J.textAlign=this.align,B$J.padding="0 0",this._syncInputTransform(),!B$N.isConchApp&&B$l.onPC&&B$a.timer.frameLoop(1,this,this._syncInputTransform)},B$O._setPromptColor=function(){(B$m.promptStyleDOM=B$l.getElementById("promptStyle"))||((B$m.promptStyleDOM=B$l.createElement("style")).setAttribute("id","promptStyle"),B$l.document.head.appendChild(B$m.promptStyleDOM)),B$m.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},B$O._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(B$a.superSet(B$hO,this,"text",this._content),B$a.superSet(B$hO,this,"color",this._originColor)):(B$a.superSet(B$hO,this,"text",this._prompt),B$a.superSet(B$hO,this,"color",this._promptColor)),B$a.stage.off("keydown",this,this._onKeyDown),B$a.stage.focus=null,this.event("blur"),B$N.isConchApp&&this.nativeInput.blur(),B$l.onPC&&B$a.timer.clear(this,this._syncInputTransform)},B$O._onKeyDown=function(B$O){13===B$O.keyCode&&(B$l.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},B$O.changeText=function(B$O){this._content=B$O,this._focus?(this.nativeInput.value=B$O||"",this.event("change")):B$J.prototype.changeText.call(this,B$O)},B$X(0,B$O,"color",B$J.prototype._$get_color,function(B$O){this._focus&&this.nativeInput.setColor(B$O),B$a.superSet(B$hO,this,"color",this._content?B$O:this._promptColor),this._originColor=B$O}),B$X(0,B$O,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(B$O){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),B$X(0,B$O,"multiline",function(){return this._multiline},function(B$O){this._multiline=B$O,this.valign=B$O?"top":"middle"}),B$X(0,B$O,"maxChars",function(){return this._maxChars},function(B$O){B$O<=0&&(B$O=1e5),this._maxChars=B$O}),B$X(0,B$O,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(B$O){B$a.superSet(B$hO,this,"color",this._originColor),B$O+="",this._focus?(this.nativeInput.value=B$O||"",this.event("change")):(this._multiline||(B$O=B$O.replace(/\r?\n/g,"")),(this._content=B$O)?B$a.superSet(B$hO,this,"text",B$O):(B$a.superSet(B$hO,this,"text",this._prompt),B$a.superSet(B$hO,this,"color",this.promptColor)))}),B$X(0,B$O,"nativeInput",function(){return this._multiline?B$m.area:B$m.input}),B$X(0,B$O,"prompt",function(){return this._prompt},function(B$O){!this._text&&B$O&&B$a.superSet(B$hO,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?B$a.superSet(B$hO,this,"text",this._text==this._prompt?B$O:this._text):B$a.superSet(B$hO,this,"text",B$O),this._prompt=B$hO.langPacks&&B$hO.langPacks[B$O]?B$hO.langPacks[B$O]:B$O}),B$X(0,B$O,"focus",function(){return this._focus},function(B$O){var B$J=this.nativeInput;this._focus!==B$O&&(B$O?(B$J.target?B$J.target._focusOut():this._setInputMethod(),(B$J.target=this)._focusIn()):(B$J.target=null,this._focusOut(),B$l.document.body.scrollTop=0,B$J.blur(),B$N.isConchApp?B$J.setPos(-1e4,-1e4):B$m.inputContainer.contains(B$J)&&B$m.inputContainer.removeChild(B$J)))}),B$X(0,B$O,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(B$O){B$O?(-1<(B$O="[^"+B$O+"]").indexOf("^^")&&(B$O=B$O.replace("^^","")),this._restrictPattern=new RegExp(B$O,"g")):this._restrictPattern=null}),B$X(0,B$O,"editable",function(){return this._editable},function(B$O){this._editable=B$O,B$N.isConchApp&&B$m.input.setForbidEdit(!B$O)}),B$X(0,B$O,"promptColor",function(){return this._promptColor},function(B$O){this._promptColor=B$O,this._content||B$a.superSet(B$hO,this,"color",B$O)}),B$X(0,B$O,"type",function(){return this._type},function(B$O){this._getCSSStyle().password="password"==B$O,this._type=B$O,B$N.isConchApp&&this.nativeInput.setType(B$O)}),B$X(0,B$O,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(B$O){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),B$X(0,B$O,"asPassword",function(){return this._getCSSStyle().password},function(B$O){this._getCSSStyle().password=B$O,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),B$m.__init__=function(){B$m._createInputElement(),B$l.onMobile&&B$N.canvas.addEventListener(B$m.IOS_IFRAME?B$l.onMiniGame?"touchend":"click":"touchend",B$m._popupInputMethod)},B$m._popupInputMethod=function(B$O){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},B$m._createInputElement=function(){B$m._initInput(B$m.area=B$l.createElement("textarea")),B$m._initInput(B$m.input=B$l.createElement("input")),(B$m.inputContainer=B$l.createElement("div")).style.position="absolute",B$m.inputContainer.style.zIndex=1e5,B$l.container.appendChild(B$m.inputContainer),B$m.inputContainer.setPos=function(B$O,B$J){B$m.inputContainer.style.left=B$O+"px",B$m.inputContainer.style.top=B$J+"px"}},B$m._initInput=function(B$J){var B$O=B$J.style;B$O.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",B$O.resize="none",B$O.backgroundColor="transparent",B$O.border="none",B$O.outline="none",B$O.zIndex=1,B$J.addEventListener("input",B$m._processInputting),B$J.addEventListener("mousemove",B$m._stopEvent),B$J.addEventListener("mousedown",B$m._stopEvent),B$J.addEventListener("touchmove",B$m._stopEvent),B$J.setFontFace=function(B$O){B$J.style.fontFamily=B$O},B$N.isConchApp||(B$J.setColor=function(B$O){B$J.style.color=B$O},B$J.setFontSize=function(B$O){B$J.style.fontSize=B$O+"px"})},B$m._processInputting=function(B$O){var B$J=laya.display.Input.inputElement.target;if(B$J){var B$D=laya.display.Input.inputElement.value;B$J._restrictPattern&&(B$D=B$D.replace(/\u2006|\x27/g,""),B$J._restrictPattern.test(B$D)&&(B$D=B$D.replace(B$J._restrictPattern,""),laya.display.Input.inputElement.value=B$D)),B$J._text=B$D,B$J.event("input")}},B$m._stopEvent=function(B$O){"touchmove"==B$O.type&&B$O.preventDefault(),B$O.stopPropagation&&B$O.stopPropagation()},B$m.TYPE_TEXT="text",B$m.TYPE_PASSWORD="password",B$m.TYPE_EMAIL="email",B$m.TYPE_URL="url",B$m.TYPE_NUMBER="number",B$m.TYPE_RANGE="range",B$m.TYPE_DATE="date",B$m.TYPE_MONTH="month",B$m.TYPE_WEEK="week",B$m.TYPE_TIME="time",B$m.TYPE_DATE_TIME="datetime",B$m.TYPE_DATE_TIME_LOCAL="datetime-local",B$m.TYPE_SEARCH="search",B$m.input=null,B$m.area=null,B$m.inputElement=null,B$m.inputContainer=null,B$m.confirmButton=null,B$m.promptStyleDOM=null,B$m.inputHeight=45,B$m.isInputting=!1,B$m.stageMatrix=null,B$_(B$m,["IOS_IFRAME",function(){return this.IOS_IFRAME=B$l.onIOS&&B$l.window.top!=B$l.window.self}]),B$m}(B$hO),B$MO=function(B$O){function B$D(B$O,B$J){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,B$D.__super.call(this),B$O&&this._init_(B$O,B$J)}B$r(B$D,"laya.resource.HTMLImage",B$vO);var B$J=B$D.prototype;return B$J._init_=function(B$O,B$J){this._src=B$O,this._source=new B$l.window.Image,B$J&&(B$J.onload&&(this.onload=B$J.onload),B$J.onerror&&(this.onerror=B$J.onerror),B$J.onCreate&&B$J.onCreate(this)),0!=B$O.indexOf("data:image")&&(this._source.crossOrigin=""),B$O&&(this._source.src=B$O)},B$J.recreateResource=function(){var B$O=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var B$J=this;this._source=new B$l.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(B$J._needReleaseAgain)return B$J._needReleaseAgain=!1,B$J._source.onload=null,void(B$J._source=null);B$J._source.onload=null,B$J.memorySize=B$O._w*B$O._h*4,B$J._recreateLock=!1,B$J.completeCreate()},this._source.src=this._src}},B$J.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},B$J.onresize=function(){this._w=this._source.width,this._h=this._source.height},B$X(0,B$J,"onload",null,function(B$O){var B$J=this;this._onload=B$O,this._source&&(this._source.onload=null!=this._onload?function(){B$J.onresize(),B$J._onload()}:null)}),B$X(0,B$J,"onerror",null,function(B$O){var B$J=this;this._onerror=B$O,this._source&&(this._source.onerror=null!=this._onerror?function(){B$J._onerror()}:null)}),B$X(0,B$J,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(B$O){this._enableMerageInAtlas=B$O,B$N.isConchApp&&this._source&&(this._source.enableMerageInAtlas=B$O)}),B$D.create=function(B$O,B$J){return new B$D(B$O,B$J)},B$D}(),B$aO=(function(B$C){function B$O(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,B$O.__super.call(this)}B$r(B$O,"laya.display.EffectAnimation",B$C);var B$J=B$O.prototype;B$J._onOtherBegin=function(B$O){B$O!=this&&this.stop()},B$J.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},B$J._onPlayAction=function(){this.play(0,!1)},B$J.play=function(B$O,B$J,B$D,B$p){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=!0),void 0===B$D&&(B$D=""),void 0===B$p&&(B$p=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,B$O,B$J,B$D,B$p))},B$J._recordInitData=function(){if(this._aniKeys){var B$O,B$J,B$D=0;for(B$O=this._aniKeys.length,B$D=0;B$D<B$O;B$D++)B$J=this._aniKeys[B$D],this._initData[B$J]=this._target[B$J]}},B$J._displayToIndex=function(B$O){if(this._animationData){B$O<0&&(B$O=0),B$O>this._count&&(B$O=this._count);var B$J=this._animationData.nodes,B$D=0,B$p=B$J.length;for(B$p=1<B$p?1:B$p,B$D=0;B$D<B$p;B$D++)this._displayNodeToFrame(B$J[B$D],B$O)}},B$J._displayNodeToFrame=function(B$O,B$J,B$D){if(this._target){var B$p;B$p=this._target;var B$m,B$C,B$i,B$k,B$_=B$O.frames,B$L=B$O.keys,B$r=0,B$H=B$L.length;B$k=B$O.secondFrames;var B$Y,B$G,B$X,B$c,B$h=0;for(B$r=0;B$r<B$H;B$r++)B$C=B$_[B$m=B$L[B$r]],B$i=-1==(B$h=B$k[B$m])?this._initData[B$m]:B$J<B$h?(B$X=(B$G=B$O.keyframes[B$m])[0]).tween?(null==(B$Y=B$w[B$X.tweenMethod])&&(B$Y=B$w.linearNone),B$c=B$G[1],B$Y(B$J,this._initData[B$m],B$c.value-this._initData[B$m],B$c.index)):this._initData[B$m]:B$C.length>B$J?B$C[B$J]:B$C[B$C.length-1],B$p[B$m]=B$i}},B$J._calculateNodeKeyFrames=function(B$O){B$C.prototype._calculateNodeKeyFrames.call(this,B$O);var B$J,B$D,B$p,B$m=B$O.keyframes;B$O.target;for(B$J in B$p={},B$O.secondFrames=B$p,B$m)(B$D=B$m[B$J]).length<=1?B$p[B$J]=-1:B$p[B$J]=B$D[1].index},B$X(0,B$J,"target",function(){return this._target},function(B$O){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=B$O,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),B$X(0,B$J,"playEvent",null,function(B$O){(this._playEvents=B$O)&&this.addEvent()}),B$X(0,B$J,"effectData",null,function(B$O){var B$J;B$O&&((B$J=B$O.animations)&&B$J[0]&&(this._setUp({},B$J[0]),B$J[0].nodes&&B$J[0].nodes[0]&&(this._aniKeys=B$J[0].nodes[0].keys)))}),B$X(0,B$J,"effectClass",null,function(B$O){var B$J,B$D;(this._effectClass=B$V.getClass(B$O),this._effectClass)&&((B$J=this._effectClass.uiView)&&(B$D=B$J.animations)&&B$D[0]&&(this._setUp({},B$D[0]),B$D[0].nodes&&B$D[0].nodes[0]&&(this._aniKeys=B$D[0].nodes[0].keys)))}),B$O.EffectAnimationBegin="effectanimationbegin"}(B$qO),function(B$J){var B$g;function B$s(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,B$s.__super.call(this)}B$r(B$s,"laya.utils.GraphicAnimation",B$J);var B$O=B$s.prototype;return B$O._parseNodeList=function(B$O){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[B$O.compId]=B$O.props,B$O.compId&&this._nodeList.push(B$O.compId);var B$J=B$O.child;if(B$J){var B$D=0,B$p=B$J.length;for(B$D=0;B$D<B$p;B$D++)this._parseNodeList(B$J[B$D])}},B$O._calGraphicData=function(B$O){var B$J;if(this._setUp(null,B$O),this._createGraphicData(),this._nodeIDAniDic)for(B$J in this._nodeIDAniDic)this._nodeIDAniDic[B$J]=null},B$O._createGraphicData=function(){var B$O,B$J=[],B$D=0,B$p=this.count,B$m=this._animationNewFrames;for(B$m||(B$m=[]),B$D=0;B$D<B$p;B$D++)!B$m[B$D]&&B$O||(B$O=this._createFrameGraphic(B$D)),B$J.push(B$O);this._gList=B$J},B$O._createFrameGraphic=function(B$O){var B$J=B$P.createGraphics();return B$s._rootMatrix||(B$s._rootMatrix=new B$E),this._updateNodeGraphic(this._rootNode,B$O,B$s._rootMatrix,B$J),B$J},B$O._updateNodeGraphic=function(B$O,B$J,B$D,B$p,B$m){var B$C;void 0===B$m&&(B$m=1);var B$i,B$k,B$_,B$L=(B$C=this._nodeGDic[B$O.compId]=this._getNodeGraphicData(B$O.compId,B$J,this._nodeGDic[B$O.compId])).alpha*B$m;if(!(B$L<.01)&&(B$C.resultTransform||(B$C.resultTransform=B$E.create()),B$i=B$C.resultTransform,B$E.mul(B$C.transform,B$D,B$i),B$C.skin&&(B$k=this._getTextureByUrl(B$C.skin))&&(B$i._checkTransform()?(B$p.drawTexture(B$k,0,0,B$C.width,B$C.height,B$i,B$L),B$C.resultTransform=null):B$p.drawTexture(B$k,B$i.tx,B$i.ty,B$C.width,B$C.height,null,B$L)),B$_=B$O.child)){var B$r,B$H=0;for(B$r=B$_.length,B$H=0;B$H<B$r;B$H++)this._updateNodeGraphic(B$_[B$H],B$J,B$i,B$p,B$L)}},B$O._updateNoChilds=function(B$O,B$J){if(B$O.skin){var B$D=this._getTextureByUrl(B$O.skin);if(B$D){var B$p=B$O.transform;B$p._checkTransform();!B$p.bTransform?B$J.drawTexture(B$D,B$p.tx,B$p.ty,B$O.width,B$O.height,null,B$O.alpha):B$J.drawTexture(B$D,0,0,B$O.width,B$O.height,B$p.clone(),B$O.alpha)}}},B$O._updateNodeGraphic2=function(B$O,B$J,B$D){var B$p;if(B$p=this._nodeGDic[B$O.compId]=this._getNodeGraphicData(B$O.compId,B$J,this._nodeGDic[B$O.compId]),B$O.child){var B$m=B$p.transform;B$m._checkTransform();var B$C,B$i;B$i=(B$C=!B$m.bTransform)&&(0!=B$m.tx||0!=B$m.ty);var B$k,B$_,B$L;if((B$k=B$m.bTransform||1!=B$p.alpha)&&B$D.save(),1!=B$p.alpha&&B$D.alpha(B$p.alpha),B$C?B$i&&B$D.translate(B$m.tx,B$m.ty):B$D.transform(B$m.clone()),B$_=B$O.child,B$p.skin&&(B$L=this._getTextureByUrl(B$p.skin))&&B$D.drawTexture(B$L,0,0,B$p.width,B$p.height),B$_){var B$r,B$H=0;for(B$r=B$_.length,B$H=0;B$H<B$r;B$H++)this._updateNodeGraphic2(B$_[B$H],B$J,B$D)}B$k?B$D.restore():B$C?B$i&&B$D.translate(-B$m.tx,-B$m.ty):B$D.transform(B$m.clone().invert())}else this._updateNoChilds(B$p,B$D)},B$O._calculateNodeKeyFrames=function(B$O){B$J.prototype._calculateNodeKeyFrames.call(this,B$O),this._nodeIDAniDic[B$O.target]=B$O},B$O.getNodeDataByID=function(B$O){return this._nodeIDAniDic[B$O]},B$O._getParams=function(B$O,B$J,B$D,B$p){var B$m=B$s._temParam;B$m.length=B$J.length;var B$C=0,B$i=B$J.length;for(B$C=0;B$C<B$i;B$C++)B$m[B$C]=this._getObjVar(B$O,B$J[B$C][0],B$D,B$J[B$C][1],B$p);return B$m},B$O._getObjVar=function(B$O,B$J,B$D,B$p,B$m){if(B$O.hasOwnProperty(B$J)){var B$C=B$O[B$J];if(B$D>=B$C.length&&(B$D=B$C.length-1),null!=B$O[B$J][B$D])return B$O[B$J][B$D]}return B$m.hasOwnProperty(B$J)?B$m[B$J]:B$p},B$O._getNodeGraphicData=function(B$O,B$J,B$D){B$D||(B$D=B$g.create()),B$D.transform?B$D.transform.identity():B$D.transform=B$E.create();var B$p=this.getNodeDataByID(B$O);if(!B$p)return B$D;var B$m,B$C,B$i=B$p.frames,B$k=this._getParams(B$i,B$s._drawTextureCmd,B$J,this._nodeDefaultProps[B$O]),B$_=B$k[0],B$L=NaN,B$r=NaN,B$H=B$k[5],B$Y=B$k[6],B$G=B$k[13],B$X=B$k[14],B$c=B$k[7],B$h=B$k[8],B$y=B$k[9],B$v=B$k[11],B$A=B$k[12];B$L=B$k[3],B$r=B$k[4],0!=B$L&&0!=B$r||(B$_=null),-1==B$L&&(B$L=0),-1==B$r&&(B$r=0),B$D.skin=B$_,B$D.width=B$L,B$D.height=B$r,B$_&&((B$m=this._getTextureByUrl(B$_))?(B$L||(B$L=B$m.sourceWidth),B$r||(B$r=B$m.sourceHeight)):console.warn("lost skin:",B$_,",you may load pics first")),B$D.alpha=B$k[10],B$C=B$D.transform,0!=B$G&&(B$H=B$G*B$L),0!=B$X&&(B$Y=B$X*B$r),0==B$H&&0==B$Y||B$C.translate(-B$H,-B$Y);var B$q=null;if(B$y||1!==B$c||1!==B$h||B$v||B$A){(B$q=B$s._tempMt).identity(),B$q.bTransform=!0;var B$d=.0174532922222222*(B$y-B$v),B$M=.0174532922222222*(B$y+B$A),B$a=Math.cos(B$M),B$e=Math.sin(B$M),B$t=Math.sin(B$d),B$z=Math.cos(B$d);B$q.a=B$c*B$a,B$q.b=B$c*B$e,B$q.c=-B$h*B$t,B$q.d=B$h*B$z,B$q.tx=B$q.ty=0}return B$q&&(B$C=B$E.mul(B$C,B$q,B$C)),B$C.translate(B$k[1],B$k[2]),B$D},B$O._getTextureByUrl=function(B$O){return B$kO.getRes(B$O)},B$O.setAniData=function(B$O,B$J){if(B$O.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=B$O,this._parseNodeList(B$O);var B$D,B$p={},B$m=[],B$C=B$O.animations,B$i=0,B$k=B$C.length;for(B$i=0;B$i<B$k;B$i++)if(B$D=B$C[B$i],this._labels=null,(!B$J||B$J==B$D.name)&&B$D){try{this._calGraphicData(B$D)}catch(B$O){console.warn("parse animation fail:"+B$D.name+",empty animation created"),this._gList=[]}var B$_={};B$_.interval=1e3/B$D.frameRate,B$_.frames=this._gList,B$_.labels=this._labels,B$_.name=B$D.name,B$m.push(B$_),B$p[B$D.name]=B$_}this.animationList=B$m,this.animationDic=B$p}B$s._temParam.length=0},B$O.parseByData=function(B$O){var B$J,B$D;B$J=B$O.nodeRoot,B$D=B$O.aniO,delete B$O.nodeRoot,delete B$O.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=B$J,this._parseNodeList(B$J),this._labels=null;try{this._calGraphicData(B$D)}catch(B$O){console.warn("parse animation fail:"+B$D.name+",empty animation created"),this._gList=[]}var B$p=B$O;return B$p.interval=1e3/B$D.frameRate,B$p.frames=this._gList,B$p.labels=this._labels,B$p.name=B$D.name,B$p},B$O.setUpAniData=function(B$O){if(B$O.animations){var B$J,B$D={},B$p=[],B$m=B$O.animations,B$C=0,B$i=B$m.length;for(B$C=0;B$C<B$i;B$C++)if(B$J=B$m[B$C]){var B$k={};B$k.name=B$J.name,B$k.aniO=B$J,B$k.nodeRoot=B$O,B$p.push(B$k),B$D[B$J.name]=B$k}this.animationList=B$p,this.animationDic=B$D}},B$O._clear=function(){var B$O,B$J;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(B$O in this._nodeGDic)(B$J=this._nodeGDic[B$O])&&B$J.recover();this._nodeGDic=null},B$s.parseAnimationByData=function(B$O){var B$J;return B$s._I||(B$s._I=new B$s),B$J=B$s._I.parseByData(B$O),B$s._I._clear(),B$J},B$s.parseAnimationData=function(B$O){var B$J;return B$s._I||(B$s._I=new B$s),B$s._I.setUpAniData(B$O),(B$J={}).animationList=B$s._I.animationList,B$J.animationDic=B$s._I.animationDic,B$s._I._clear(),B$J},B$s._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],B$s._temParam=[],B$s._I=null,B$s._rootMatrix=null,B$_(B$s,["_tempMt",function(){return this._tempMt=new B$E}]),B$s.__init$=function(){B$g=function(){function B$O(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return B$r(B$O,""),B$O.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),B$Z.recover("GraphicNode",this)},B$O.create=function(){return B$Z.getItemByClass("GraphicNode",B$O)},B$O}()},B$s}(B$qO));B$a.__init([B$L,B$_O,B$N,B$l,B$B,B$z,B$O,B$aO])}(window,document,Laya),function(B$O,B$J,B$D){B$D.un,B$D.uns,B$D.static;var B$p=B$D.class;B$D.getset,B$D.__newvec;new(function(){function B$O(){}return B$p(B$O,"LayaMain"),B$O}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}}),function(B$O,B$J,B$M){B$M.un,B$M.uns;var B$i=B$M.static,B$Y=B$M.class,B$p=B$M.getset,B$C=B$M.__newvec,B$r=laya.maths.Arith,B$H=laya.maths.Bezier,B$D=laya.resource.Bitmap,B$G=laya.utils.Browser,B$_=laya.utils.Byte,B$X=laya.utils.Color,B$a=(laya.filters.ColorFilter,B$M.Config),B$m=laya.resource.Context,B$e=(laya.events.Event,laya.filters.Filter),B$k=laya.display.Graphics,B$L=laya.resource.HTMLCanvas,B$c=(laya.utils.HTMLChar,laya.resource.HTMLImage),B$h=laya.resource.HTMLSubImage,B$t=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),B$z=laya.maths.Point,B$g=laya.maths.Rectangle,B$y=laya.renders.Render,B$v=(laya.renders.RenderContext,laya.renders.RenderSprite),B$A=laya.resource.Resource,B$q=laya.resource.ResourceManager,B$d=laya.utils.RunDriver,B$s=laya.display.Sprite,B$P=laya.display.Stage,B$E=laya.utils.Stat,B$o=laya.utils.StringKey,B$W=(laya.display.css.Style,laya.system.System),B$N=laya.display.Text,B$F=laya.resource.Texture,B$R=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),B$j=laya.utils.VectorGraphManager;laya.utils.WordText;B$M.interface("laya.webgl.shapes.IShape"),B$M.interface("laya.webgl.submit.ISubmit"),B$M.interface("laya.webgl.text.ICharSegment"),B$M.interface("laya.webgl.canvas.save.ISaveData"),B$M.interface("laya.webgl.resource.IMergeAtlasBitmap"),B$M.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var B$u=function(){function B$O(){}B$Y(B$O,"laya.filters.webgl.FilterActionGL");var B$J=B$O.prototype;return B$M.imps(B$J,{"laya.filters.IFilterActionGL":!0}),B$J.setValue=function(B$O){},B$J.setValueMix=function(B$O){},B$J.apply3d=function(B$O,B$J,B$D,B$p,B$m){return null},B$J.apply=function(B$O){return null},B$p(0,B$J,"typeMix",function(){return 0}),B$O}(),B$l=function(){function B$O(){}return B$Y(B$O,"laya.webgl.shader.ShaderValue"),B$O}(),B$$=function(){var B$p,B$m;function B$O(B$O,B$J,B$D){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new B$m,void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),this._cells=null,this._rowInfo=null,this._init(B$O,B$J),this._atlasID=B$D}B$Y(B$O,"laya.webgl.atlas.AtlasGrid");var B$J=B$O.prototype;return B$J.getAltasID=function(){return this._atlasID},B$J.setAltasID=function(B$O){0<=B$O&&(this._atlasID=B$O)},B$J.addTex=function(B$O,B$J,B$D){var B$p=this._get(B$J,B$D);return 0==B$p.ret||(this._fill(B$p.x,B$p.y,B$J,B$D,B$O),this._texCount++),B$p},B$J._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},B$J._init=function(B$O,B$J){if(this._width=B$O,this._height=B$J,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=B$C(this._height);for(var B$D=0;B$D<this._height;B$D++)this._rowInfo[B$D]=new B$p;return this._clear(),!0},B$J._get=function(B$O,B$J){var B$D=new B$V;if(B$O>=this._failSize.width&&B$J>=this._failSize.height)return B$D;for(var B$p=-1,B$m=-1,B$C=this._width,B$i=this._height,B$k=this._cells,B$_=0;B$_<B$i;B$_++)if(!(this._rowInfo[B$_].spaceCount<B$O))for(var B$L=0;B$L<B$C;){var B$r=3*(B$_*B$C+B$L);if(0!=B$k[B$r]||B$k[1+B$r]<B$O||B$k[2+B$r]<B$J)B$L+=B$k[1+B$r];else{B$p=B$L,B$m=B$_;for(var B$H=0;B$H<B$O;B$H++)if(B$k[3*B$H+B$r+2]<B$J){B$p=-1;break}if(!(B$p<0))return B$D.ret=!0,B$D.x=B$p,B$D.y=B$m,B$D;B$L+=B$k[1+B$r]}}return B$D},B$J._fill=function(B$O,B$J,B$D,B$p,B$m){var B$C=this._width,B$i=this._height;this._check(B$O+B$D<=B$C&&B$J+B$p<=B$i);for(var B$k=B$J;B$k<B$p+B$J;++B$k){this._check(this._rowInfo[B$k].spaceCount>=B$D),this._rowInfo[B$k].spaceCount-=B$D;for(var B$_=0;B$_<B$D;B$_++){var B$L=3*(B$O+B$k*B$C+B$_);this._check(0==this._cells[B$L]),this._cells[B$L]=B$m,this._cells[1+B$L]=B$D,this._cells[2+B$L]=B$p}}if(0<B$O)for(B$k=0;B$k<B$p;++B$k){var B$r=0;for(B$_=B$O-1;0<=B$_&&0==this._cells[3*((B$J+B$k)*B$C+B$_)];--B$_,++B$r);for(B$_=B$r;0<B$_;--B$_)this._cells[3*((B$J+B$k)*B$C+B$O-B$_)+1]=B$_,this._check(0<B$_)}if(0<B$J)for(B$_=B$O;B$_<B$O+B$D;++B$_){for(B$r=0,B$k=B$J-1;0<=B$k&&0==this._cells[3*(B$_+B$k*B$C)];--B$k,B$r++);for(B$k=B$r;0<B$k;--B$k)this._cells[3*(B$_+(B$J-B$k)*B$C)+2]=B$k,this._check(0<B$k)}},B$J._check=function(B$O){0==B$O&&console.log("xtexMerger 错误啦")},B$J._clear=function(){for(var B$O=this._texCount=0;B$O<this._height;B$O++)this._rowInfo[B$O].spaceCount=this._width;for(var B$J=0;B$J<this._height;B$J++)for(var B$D=0;B$D<this._width;B$D++){var B$p=3*(B$J*this._width+B$D);this._cells[B$p]=0,this._cells[1+B$p]=this._width-B$D,this._cells[2+B$p]=this._width-B$J}this._failSize.width=this._width+1,this._failSize.height=this._height+1},B$O.__init$=function(){B$p=function(){function B$O(){this.spaceCount=0}return B$Y(B$O,""),B$O}(),B$m=function(){function B$O(){this.width=0,this.height=0}return B$Y(B$O,""),B$O}()},B$O}(),B$x=function(){function B$y(B$O,B$J,B$D,B$p){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=B$O,this._height=B$J,this._gridSize=B$D,this._maxAtlaserCount=B$p,this._gridNumX=B$O/B$D,this._gridNumY=B$J/B$D,this._curAtlasIndex=0,this._atlaserArray=[]}B$Y(B$y,"laya.webgl.atlas.AtlasResourceManager");var B$O=B$y.prototype;return B$O.setAtlasParam=function(B$O,B$J,B$D,B$p){if(1==this._setAtlasParam)return B$y._sid_=0,this._width=B$O,this._height=B$J,this._gridSize=B$D,this._maxAtlaserCount=B$p,this._gridNumX=B$O/B$D,this._gridNumY=B$J/B$D,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},B$O.pushData=function(B$O){var B$J,B$D=B$O.bitmap,B$p=-1,B$m=null,B$C=0,B$i=0;for(B$C=0,B$J=this._atlaserArray.length;B$C<B$J&&(B$i=(this._curAtlasIndex+B$C)%B$J,-1==(B$p=(B$m=this._atlaserArray[B$i]).findBitmapIsExist(B$D)));B$C++);if(-1!=B$p){var B$k=B$m.InAtlasWebGLImagesOffsetValue[B$p];return B$X=B$k[0],B$c=B$k[1],B$m.addToAtlas(B$O,B$X,B$c),!0}this._setAtlasParam=!1;for(var B$_=Math.ceil((B$O.bitmap.width+2)/this._gridSize),B$L=Math.ceil((B$O.bitmap.height+2)/this._gridSize),B$r=!1,B$H=0;B$H<2;B$H++){var B$Y=this._maxAtlaserCount;for(B$C=0;B$C<B$Y;B$C++){B$i=(this._curAtlasIndex+B$C)%B$Y,this._atlaserArray.length-1>=B$i||this._atlaserArray.push(new B$gO(this._gridNumX,this._gridNumY,this._width,this._height,B$y._sid_++));var B$G=this._atlaserArray[B$i],B$X=0,B$c=0,B$h=B$G.addTex(1,B$_,B$L);if(B$h.ret){B$X=B$h.x*this._gridSize+1,B$c=B$h.y*this._gridSize+1,B$D.lock=!0,B$G.addToAtlasTexture(B$D,B$X,B$c),B$G.addToAtlas(B$O,B$X,B$c),B$r=!0,this._curAtlasIndex=B$i;break}}if(B$r)break;this._atlaserArray.push(new B$gO(this._gridNumX,this._gridNumY,this._width,this._height,B$y._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return B$r||console.log(">>>AtlasManager pushData error"),B$r},B$O.addToAtlas=function(B$O){laya.webgl.atlas.AtlasResourceManager.instance.pushData(B$O)},B$O.garbageCollection=function(){if(!0===this._needGC){for(var B$O=this._atlaserArray.length-this._maxAtlaserCount,B$J=0;B$J<B$O;B$J++)this._atlaserArray[B$J].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+B$O),this._atlaserArray.splice(0,B$O),this._needGC=!1}return!0},B$O.freeAll=function(){for(var B$O=0,B$J=this._atlaserArray.length;B$O<B$J;B$O++)this._atlaserArray[B$O].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},B$O.getAtlaserCount=function(){return this._atlaserArray.length},B$O.getAtlaserByIndex=function(B$O){return this._atlaserArray[B$O]},B$p(1,B$y,"instance",function(){return B$y._Instance||(B$y._Instance=new B$y(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),B$y._Instance}),B$p(1,B$y,"enabled",function(){return B$a.atlasEnable}),B$p(1,B$y,"atlasLimitWidth",function(){return B$y._atlasLimitWidth},function(B$O){B$y._atlasLimitWidth=B$O}),B$p(1,B$y,"atlasLimitHeight",function(){return B$y._atlasLimitHeight},function(B$O){B$y._atlasLimitHeight=B$O}),B$y._enable=function(){B$a.atlasEnable=!0},B$y._disable=function(){B$a.atlasEnable=!1},B$y.__init__=function(){B$y.atlasTextureWidth=2048,B$y.atlasTextureHeight=2048,B$y.maxTextureCount=6,B$y.atlasLimitWidth=512,B$y.atlasLimitHeight=512},B$y._atlasLimitWidth=0,B$y._atlasLimitHeight=0,B$y.gridSize=16,B$y.atlasTextureWidth=0,B$y.atlasTextureHeight=0,B$y.maxTextureCount=0,B$y._atlasRestore=0,B$y.BOARDER_TYPE_NO=0,B$y.BOARDER_TYPE_RIGHT=1,B$y.BOARDER_TYPE_LEFT=2,B$y.BOARDER_TYPE_BOTTOM=4,B$y.BOARDER_TYPE_TOP=8,B$y.BOARDER_TYPE_ALL=15,B$y._sid_=0,B$y._Instance=null,B$y}(),B$V=function(){function B$O(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return B$Y(B$O,"laya.webgl.atlas.MergeFillInfo"),B$O}(),B$T=function(){function B$J(){}return B$Y(B$J,"laya.webgl.canvas.BlendMode"),B$J._init_=function(B$O){B$J.fns=[B$J.BlendNormal,B$J.BlendAdd,B$J.BlendMultiply,B$J.BlendScreen,B$J.BlendOverlay,B$J.BlendLight,B$J.BlendMask,B$J.BlendDestinationOut],B$J.targetFns=[B$J.BlendNormalTarget,B$J.BlendAddTarget,B$J.BlendMultiplyTarget,B$J.BlendScreenTarget,B$J.BlendOverlayTarget,B$J.BlendLightTarget,B$J.BlendMask,B$J.BlendDestinationOut]},B$J.BlendNormal=function(B$O){B$O.blendFunc(1,771)},B$J.BlendAdd=function(B$O){B$O.blendFunc(1,772)},B$J.BlendMultiply=function(B$O){B$O.blendFunc(774,771)},B$J.BlendScreen=function(B$O){B$O.blendFunc(1,1)},B$J.BlendOverlay=function(B$O){B$O.blendFunc(1,769)},B$J.BlendLight=function(B$O){B$O.blendFunc(1,1)},B$J.BlendNormalTarget=function(B$O){B$O.blendFunc(1,771)},B$J.BlendAddTarget=function(B$O){B$O.blendFunc(1,772)},B$J.BlendMultiplyTarget=function(B$O){B$O.blendFunc(774,771)},B$J.BlendScreenTarget=function(B$O){B$O.blendFunc(1,1)},B$J.BlendOverlayTarget=function(B$O){B$O.blendFunc(1,769)},B$J.BlendLightTarget=function(B$O){B$O.blendFunc(1,1)},B$J.BlendMask=function(B$O){B$O.blendFunc(0,770)},B$J.BlendDestinationOut=function(B$O){B$O.blendFunc(0,0)},B$J.activeBlendFunction=null,B$J.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],B$J.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},B$J.NORMAL="normal",B$J.ADD="add",B$J.MULTIPLY="multiply",B$J.SCREEN="screen",B$J.LIGHT="light",B$J.OVERLAY="overlay",B$J.DESTINATIONOUT="destination-out",B$J.fns=[],B$J.targetFns=[],B$J}(),B$I=function(){function B$D(B$O){this._color=B$X.create("black"),this.setValue(B$O)}B$Y(B$D,"laya.webgl.canvas.DrawStyle");var B$O=B$D.prototype;return B$O.setValue=function(B$O){if(B$O){if("string"==typeof B$O)return void(this._color=B$X.create(B$O));if(B$O instanceof laya.utils.Color)return void(this._color=B$O)}},B$O.reset=function(){this._color=B$X.create("black")},B$O.equal=function(B$O){return"string"==typeof B$O?this._color.strColor===B$O:B$O instanceof laya.utils.Color&&this._color.numColor===B$O.numColor},B$O.toColorStr=function(){return this._color.strColor},B$D.create=function(B$O){var B$J;if(B$O&&("string"==typeof B$O?B$J=B$X.create(B$O):B$O instanceof laya.utils.Color&&(B$J=B$O),B$J))return B$J._drawStyle||(B$J._drawStyle=new B$D(B$O));return laya.webgl.canvas.DrawStyle.DEFAULT},B$i(B$D,["DEFAULT",function(){return this.DEFAULT=new B$D("#000000")}]),B$D}(),B$w=function(){function B$O(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];B$qO.mainContext;this.ib=B$KO.create(35048),this.vb=B$fO.create(5)}B$Y(B$O,"laya.webgl.canvas.Path");var B$J=B$O.prototype;return B$J.addPoint=function(B$O,B$J){this.tempArray.push(B$O,B$J)},B$J.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},B$J.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},B$J.polygon=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i;return this.geomatrys.push(this._curGeomatry=B$i=new B$oO(B$O,B$J,B$D,B$p,B$m,B$C)),B$p||(B$i.fill=!1),null==B$C&&(B$i.borderWidth=0),B$i},B$J.setGeomtry=function(B$O){this.geomatrys.push(this._curGeomatry=B$O)},B$J.drawLine=function(B$O,B$J,B$D,B$p,B$m){var B$C;return this.closePath?this.geomatrys.push(this._curGeomatry=B$C=new B$EO(B$O,B$J,B$D,B$p,B$m)):this.geomatrys.push(this._curGeomatry=B$C=new B$PO(B$O,B$J,B$D,B$p,B$m)),B$C.fill=!1,B$C},B$J.update=function(){var B$O=this.ib._byteLength,B$J=this.geomatrys.length;this.offset=B$O;for(var B$D=this.geoStart;B$D<B$J;B$D++)this.geomatrys[B$D].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=B$J,this.count=(this.ib._byteLength-B$O)/B$cO.BYTES_PIDX},B$J.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},B$J.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},B$O}(),B$U=function(){function B$k(){}B$Y(B$k,"laya.webgl.canvas.save.SaveBase");var B$O=B$k.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!1},B$O.restore=function(B$O){this._dataObj[this._valueName]=this._value,(B$k._cache[B$k._cache._length++]=this)._newSubmit&&(B$O._curSubmit=B$CO.RENDERBASE,B$O._renderKey=0)},B$k._createArray=function(){var B$O=[];return B$O._length=0,B$O},B$k._init=function(){var B$O=B$k._namemap={};return B$O[1]="ALPHA",B$O[2]="fillStyle",B$O[8]="font",B$O[256]="lineWidth",B$O[512]="strokeStyle",B$O[8192]="_mergeID",B$O[1024]=B$O[2048]=B$O[4096]=[],B$O[16384]="textBaseline",B$O[32768]="textAlign",B$O[65536]="_nBlendType",B$O[1048576]="shader",B$O[2097152]="filters",B$O},B$k.save=function(B$O,B$J,B$D,B$p){if((B$O._saveMark._saveuse&B$J)!==B$J){B$O._saveMark._saveuse|=B$J;var B$m=B$k._cache,B$C=0<B$m._length?B$m[--B$m._length]:new B$k;B$C._value=B$D[B$C._valueName=B$k._namemap[B$J]],B$C._dataObj=B$D,B$C._newSubmit=B$p;var B$i=B$O._save;B$i[B$i._length++]=B$C}},B$k._cache=laya.webgl.canvas.save.SaveBase._createArray(),B$k._namemap=B$k._init(),B$k}(),B$Z=function(){function B$C(){this._clipRect=new B$g}B$Y(B$C,"laya.webgl.canvas.save.SaveClipRect");var B$O=B$C.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!1},B$O.restore=function(B$O){B$O._clipRect=this._clipSaveRect,(B$C._cache[B$C._cache._length++]=this)._submitScissor.submitLength=B$O._submits._length-this._submitScissor.submitIndex,B$O._curSubmit=B$CO.RENDERBASE,B$O._renderKey=0},B$C.save=function(B$O,B$J){if(131072!=(131072&B$O._saveMark._saveuse)){B$O._saveMark._saveuse|=131072;var B$D=B$C._cache,B$p=0<B$D._length?B$D[--B$D._length]:new B$C;B$p._clipSaveRect=B$O._clipRect,B$O._clipRect=B$p._clipRect.copyFrom(B$O._clipRect),B$p._submitScissor=B$J;var B$m=B$O._save;B$m[B$m._length++]=B$p}},B$i(B$C,["_cache",function(){return this._cache=B$U._createArray()}]),B$C}(),B$n=function(){function B$G(){this._contextX=0,this._contextY=0,this._clipRect=new B$g,this._rect=new B$g,this._matrix=new B$t}B$Y(B$G,"laya.webgl.canvas.save.SaveClipRectStencil");var B$O=B$G.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!1},B$O.restore=function(B$O){B$rO.restore(B$O,this._rect,this._saveMatrix,this._contextX,this._contextY),B$O._clipRect=this._clipSaveRect,B$O._curMat=this._saveMatrix,B$O._x=this._contextX,B$O._y=this._contextY,B$G._cache[B$G._cache._length++]=this,B$O._curSubmit=B$CO.RENDERBASE},B$G.save=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){if(262144!=(262144&B$O._saveMark._saveuse)){B$O._saveMark._saveuse|=262144;var B$r=B$G._cache,B$H=0<B$r._length?B$r[--B$r._length]:new B$G;B$H._clipSaveRect=B$O._clipRect,B$H._clipRect.setTo(B$i,B$k,B$_,B$L),B$O._clipRect=B$H._clipRect,B$H._rect.x=B$D,B$H._rect.y=B$p,B$H._rect.width=B$m,B$H._rect.height=B$C,B$H._contextX=B$O._x,B$H._contextY=B$O._y,B$H._saveMatrix=B$O._curMat,B$O._curMat.copyTo(B$H._matrix),B$O._curMat=B$H._matrix,B$H._submitStencil=B$J;var B$Y=B$O._save;B$Y[B$Y._length++]=B$H}},B$i(B$G,["_cache",function(){return this._cache=B$U._createArray()}]),B$G}(),B$B=function(){function B$p(){this._saveuse=0}B$Y(B$p,"laya.webgl.canvas.save.SaveMark");var B$O=B$p.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!0},B$O.restore=function(B$O){B$O._saveMark=this._preSaveMark,B$p._no[B$p._no._length++]=this},B$p.Create=function(B$O){var B$J=B$p._no,B$D=0<B$J._length?B$J[--B$J._length]:new B$p;return B$D._saveuse=0,B$D._preSaveMark=B$O._saveMark,B$O._saveMark=B$D},B$i(B$p,["_no",function(){return this._no=B$U._createArray()}]),B$p}(),B$S=function(){function B$C(){this._matrix=new B$t}B$Y(B$C,"laya.webgl.canvas.save.SaveTransform");var B$O=B$C.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!1},B$O.restore=function(B$O){B$O._curMat=this._savematrix,B$C._no[B$C._no._length++]=this},B$C.save=function(B$O){var B$J=B$O._saveMark;if(2048!=(2048&B$J._saveuse)){B$J._saveuse|=2048;var B$D=B$C._no,B$p=0<B$D._length?B$D[--B$D._length]:new B$C;B$p._savematrix=B$O._curMat,B$O._curMat=B$O._curMat.copyTo(B$p._matrix);var B$m=B$O._save;B$m[B$m._length++]=B$p}},B$i(B$C,["_no",function(){return this._no=B$U._createArray()}]),B$C}(),B$Q=function(){function B$m(){}B$Y(B$m,"laya.webgl.canvas.save.SaveTranslate");var B$O=B$m.prototype;return B$M.imps(B$O,{"laya.webgl.canvas.save.ISaveData":!0}),B$O.isSaveMark=function(){return!1},B$O.restore=function(B$O){B$O._curMat;B$O._x=this._x,B$O._y=this._y,B$m._no[B$m._no._length++]=this},B$m.save=function(B$O){var B$J=B$m._no,B$D=0<B$J._length?B$J[--B$J._length]:new B$m;B$D._x=B$O._x,B$D._y=B$O._y;var B$p=B$O._save;B$p[B$p._length++]=B$D},B$i(B$m,["_no",function(){return this._no=B$U._createArray()}]),B$m}(),B$b=function(){function B$O(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new B$g}B$Y(B$O,"laya.webgl.resource.RenderTargetMAX");var B$J=B$O.prototype;return B$J.setSP=function(B$O){this._sp=B$O},B$J.size=function(B$O,B$J){var B$D=this;this._width!==B$O||this._height!==B$J?(this.repaint=!0,this._width=B$O,this._height=B$J,this.target?this.target.size(B$O,B$J):this.target=B$jO.create(B$O,B$J),this.target.hasListener("recovered")||this.target.on("recovered",this,function(B$O){B$M.timer.callLater(B$D._sp,B$D._sp.repaint)})):this.target.size(B$O,B$J)},B$J._flushToTarget=function(B$O,B$J){if(!B$J._destroy){var B$D=B$vO.worldScissorTest,B$p=B$vO.worldClipRect;B$vO.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,B$vO.worldScissorTest=!1,B$qO.mainContext.disable(3089);var B$m=B$vO.worldAlpha,B$C=B$vO.worldMatrix4,B$i=B$vO.worldMatrix,B$k=B$vO.worldFilters,B$_=B$vO.worldShaderDefines;if(B$vO.worldMatrix=B$t.EMPTY,B$vO.restoreTempArray(),B$vO.worldMatrix4=B$vO.TEMPMAT4_ARRAY,B$vO.worldAlpha=1,B$vO.worldFilters=null,B$vO.worldShaderDefines=null,B$RO.activeShader=null,B$J.start(),B$a.showCanvasMark?B$J.clear(0,1,0,.3):B$J.clear(0,0,0,0),B$O.flush(),B$J.end(),B$RO.activeShader=null,B$vO.worldAlpha=B$m,B$vO.worldMatrix4=B$C,B$vO.worldMatrix=B$i,B$vO.worldFilters=B$k,B$vO.worldShaderDefines=B$_,B$vO.worldScissorTest=B$D){var B$L=B$vO.height-B$p.y-B$p.height;B$qO.mainContext.scissor(B$p.x,B$L,B$p.width,B$p.height),B$qO.mainContext.enable(3089)}B$vO.worldClipRect=B$p}},B$J.flush=function(B$O){this.repaint&&(this._flushToTarget(B$O,this.target),this.repaint=!1)},B$J.drawTo=function(B$O,B$J,B$D,B$p,B$m){B$O.drawTexture(this.target.getTexture(),B$J,B$D,B$p,B$m,0,0)},B$J.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},B$O}(),B$K=function(){function B$O(){this.ALPHA=1,this.shaderType=0,this.defines=new B$sO}return B$Y(B$O,"laya.webgl.shader.d2.Shader2D"),B$O.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},B$O.__init__=function(){var B$O,B$J;B$BO.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),B$BO.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),B$BO.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),B$BO.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),B$BO.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),B$BO.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),B$BO.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),B$BO.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),B$O="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",B$J='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',B$BO.preCompile2D(0,1,B$O,B$J,null),B$O="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",B$J='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',B$BO.preCompile2D(0,2,B$O,B$J,null),B$O="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",B$J="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",B$BO.preCompile2D(0,4,B$O,B$J,null),B$O="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",B$J='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',B$BO.preCompile2D(0,256,B$O,B$J,null),B$O="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",B$J="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",B$BO.preCompile2D(0,512,B$O,B$J,null)},B$O}(),B$f=function(){function B$J(B$O,B$J,B$D){this._value=0,this._name2int=B$O,this._int2name=B$J,this._int2nameMap=B$D}B$Y(B$J,"laya.webgl.shader.ShaderDefines");var B$O=B$J.prototype;return B$O.add=function(B$O){return"string"==typeof B$O&&(B$O=this._name2int[B$O]),this._value|=B$O,this._value},B$O.addInt=function(B$O){return this._value|=B$O,this._value},B$O.remove=function(B$O){return"string"==typeof B$O&&(B$O=this._name2int[B$O]),this._value&=~B$O,this._value},B$O.isDefine=function(B$O){return(this._value&B$O)===B$O},B$O.getValue=function(){return this._value},B$O.setValue=function(B$O){this._value=B$O},B$O.toNameDic=function(){var B$O=this._int2nameMap[this._value];return B$O||B$J._toText(this._value,this._int2name,this._int2nameMap)},B$J._reg=function(B$O,B$J,B$D,B$p){B$p[B$D[B$O]=B$J]=B$O},B$J._toText=function(B$O,B$J,B$D){var B$p=B$D[B$O];if(B$p)return B$p;for(var B$m={},B$C=1,B$i=0;B$i<32&&!(B$O<(B$C=1<<B$i));B$i++)if(B$O&B$C){var B$k=B$J[B$C];B$k&&(B$m[B$k]="")}return B$D[B$O]=B$m},B$J._toInt=function(B$O,B$J){for(var B$D=B$O.split("."),B$p=0,B$m=0,B$C=B$D.length;B$m<B$C;B$m++){var B$i=B$J[B$D[B$m]];if(!B$i)throw new Error("Defines to int err:"+B$O+"/"+B$D[B$m]);B$p|=B$i}return B$p},B$J}(),B$OO=function(){function B$i(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new B$t}B$Y(B$i,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var B$O=B$i.prototype;return B$O.init=function(B$O,B$J,B$D){if(B$J)this._vs=B$J;else{this._vs=[];var B$p=B$O.width,B$m=B$O.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(B$p,0,1,0,1,1,1,1),this._vs.push(B$p,B$m,1,1,1,1,1,1),this._vs.push(0,B$m,0,1,1,1,1,1)}B$D?this._ps=B$D:(B$i._defaultPS||(B$i._defaultPS=[]).push(0,1,3,3,1,2),this._ps=B$i._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=B$O},B$O.init2=function(B$O,B$J,B$D,B$p,B$m){this.transform&&(this.transform=null),B$D?this._ps=B$D:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=B$p,this._uvs=B$m,this.mEleNum=this._ps.length,this.mTexture=B$O,(B$y.isConchNode||B$y.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},B$O._initMyData=function(){var B$O=0,B$J=0,B$D=4*this._verticles.length;this._vs=B$i._tempVS;var B$p=!1;if(B$y.isConchNode||B$y.isConchApp?(this._vs.length=B$D,B$p=!0):this._vs.length<B$D&&(this._vs.length=B$D,B$p=!0),B$i._tVSLen=B$D,B$p)for(;B$O<B$D;)this._vs[B$O]=this._verticles[B$J],this._vs[B$O+1]=this._verticles[B$J+1],this._vs[B$O+2]=this._uvs[B$J],this._vs[B$O+3]=this._uvs[B$J+1],this._vs[B$O+4]=1,this._vs[B$O+5]=1,this._vs[B$O+6]=1,this._vs[B$O+7]=1,B$O+=8,B$J+=2;else for(;B$O<B$D;)this._vs[B$O]=this._verticles[B$J],this._vs[B$O+1]=this._verticles[B$J+1],this._vs[B$O+2]=this._uvs[B$J],this._vs[B$O+3]=this._uvs[B$J+1],B$O+=8,B$J+=2},B$O.getData2=function(B$O,B$J,B$D){var B$p;this.mVBBuffer=B$O,this.mIBBuffer=B$J,this._initMyData(),B$O.appendEx2(this._vs,Float32Array,B$i._tVSLen,4),this._indexStart=B$J._byteLength,(B$p=B$i._tempIB).length<this._ps.length&&(B$p.length=this._ps.length);for(var B$m=0,B$C=this._ps.length;B$m<B$C;B$m++)B$p[B$m]=this._ps[B$m]+B$D;B$J.appendEx2(B$p,Uint16Array,this._ps.length,2)},B$O.getData=function(B$O,B$J,B$D){if(this.mVBBuffer=B$O,this.mIBBuffer=B$J,B$O.append(this.mVBData),this._indexStart=B$J._byteLength,this.mIBData.start!=B$D){for(var B$p=0,B$m=this._ps.length;B$p<B$m;B$p++)this.mIBData[B$p]=this._ps[B$p]+B$D;this.mIBData.start=B$D}B$J.append(this.mIBData)},B$O.render=function(B$O,B$J,B$D){if(B$y.isWebGL&&this.mTexture){B$O._renderKey=0,B$O._shader2D.glTexture=null,B$JO.getInstance().addSkinMesh(this);var B$p=B$CO.createShape(B$O,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,B$eO.create(512,0));this.transform||(this.transform=B$t.EMPTY),this.transform.translate(B$J,B$D),B$t.mul(this.transform,B$O._curMat,this._tempMatrix),this.transform.translate(-B$J,-B$D);var B$m=B$p.shaderValue,B$C=B$m.u_mmat2||B$vO.getMatrArray();B$vO.mat2MatArray(this._tempMatrix,B$C),B$m.textureHost=this.mTexture,B$m.offsetX=0,B$m.offsetY=0,B$m.u_mmat2=B$C,B$m.ALPHA=B$O._shader2D.ALPHA,B$O._submits[B$O._submits._length++]=B$p}else B$y.isConchApp&&this.mTexture&&(this.transform||(this.transform=B$t.EMPTY),B$O.setSkinMesh&&B$O.setSkinMesh(B$J,B$D,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},B$i._tempVS=[],B$i._tempIB=[],B$i._defaultPS=null,B$i._tVSLen=0,B$i}(),B$JO=function(){function B$O(){this.ib=null,this.vb=null;B$qO.mainContext;this.ib=B$KO.create(35048),this.vb=B$fO.create(8)}B$Y(B$O,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var B$J=B$O.prototype;return B$J.addSkinMesh=function(B$O){B$O.getData2(this.vb,this.ib,this.vb._byteLength/32)},B$J.reset=function(){this.vb.clear(),this.ib.clear()},B$O.getInstance=function(){return B$O.instance=B$O.instance||new B$O},B$O.instance=null,B$O}(),B$DO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===B$_&&(B$_=0),this.x=B$O,this.y=B$J,this.width=B$D,this.height=B$p,this.edges=B$m,this.color=B$C,this.borderWidth=B$i,this.borderColor=B$k}B$Y(B$O,"laya.webgl.shapes.BasePoly");var B$J=B$O.prototype;return B$M.imps(B$J,{"laya.webgl.shapes.IShape":!0}),B$J.getData=function(B$O,B$J,B$D){},B$J.rebuild=function(B$O){},B$J.setMatrix=function(B$O){},B$J.needUpdate=function(B$O){return!0},B$J.sector=function(B$O,B$J,B$D){var B$p=this.x,B$m=this.y,B$C=this.edges,B$i=(this.r1-this.r0)/B$C,B$k=this.width,B$_=this.height,B$L=this.color,B$r=(B$L>>16&255)/255,B$H=(B$L>>8&255)/255,B$Y=(255&B$L)/255;B$O.push(B$p,B$m,B$r,B$H,B$Y);for(var B$G=0;B$G<B$C+1;B$G++)B$O.push(B$p+Math.sin(B$i*B$G+this.r0)*B$k,B$m+Math.cos(B$i*B$G+this.r0)*B$_),B$O.push(B$r,B$H,B$Y);for(B$G=0;B$G<B$C;B$G++)B$J.push(B$D,B$D+B$G+1,B$D+B$G+2)},B$J.createLine2=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k,B$_,B$L,B$r,B$H,B$Y,B$G,B$X,B$c,B$h,B$y,B$v,B$A,B$q,B$d,B$M,B$a,B$e,B$t,B$z=B$O.concat(),B$g=B$m,B$s=this.borderColor,B$P=(B$s>>16&255)/255,B$E=(B$s>>8&255)/255,B$o=(255&B$s)/255,B$W=B$z.length/2,B$N=B$p,B$F=B$D/2;B$_=B$z[0],B$L=B$z[1],B$c=B$_-(B$r=B$z[2]),B$X=(B$X=-(B$L-(B$H=B$z[3])))/(B$t=Math.sqrt(B$X*B$X+B$c*B$c))*B$F,B$c=B$c/B$t*B$F,B$g.push(B$_-B$X+this.x,B$L-B$c+this.y,B$P,B$E,B$o,B$_+B$X+this.x,B$L+B$c+this.y,B$P,B$E,B$o);for(var B$R=1;B$R<B$W-1;B$R++)B$_=B$z[2*(B$R-1)],B$L=B$z[2*(B$R-1)+1],B$r=B$z[2*B$R],B$H=B$z[2*B$R+1],B$Y=B$z[2*(B$R+1)],B$G=B$z[2*(B$R+1)+1],B$c=B$_-B$r,B$y=B$r-B$Y,B$q=(-(B$X=(B$X=-(B$L-B$H))/(B$t=Math.sqrt(B$X*B$X+B$c*B$c))*B$F)+B$_)*(-(B$c=B$c/B$t*B$F)+B$H)-(-B$X+B$r)*(-B$c+B$L),B$a=(-(B$h=(B$h=-(B$H-B$G))/(B$t=Math.sqrt(B$h*B$h+B$y*B$y))*B$F)+B$Y)*(-(B$y=B$y/B$t*B$F)+B$H)-(-B$h+B$r)*(-B$y+B$G),B$e=(B$v=-B$c+B$L-(-B$c+B$H))*(B$M=-B$h+B$r-(-B$h+B$Y))-(B$d=-B$y+B$G-(-B$y+B$H))*(B$A=-B$X+B$r-(-B$X+B$_)),Math.abs(B$e)<.1?(B$e+=10.1,B$g.push(B$r-B$X+this.x,B$H-B$c+this.y,B$P,B$E,B$o,B$r+B$X+this.x,B$H+B$c+this.y,B$P,B$E,B$o)):(((B$i=(B$A*B$a-B$M*B$q)/B$e)-B$r)*(B$i-B$r)+((B$k=(B$d*B$q-B$v*B$a)/B$e)-B$H)+(B$k-B$H),B$g.push(B$i+this.x,B$k+this.y,B$P,B$E,B$o,B$r-(B$i-B$r)+this.x,B$H-(B$k-B$H)+this.y,B$P,B$E,B$o));B$_=B$z[B$z.length-4],B$L=B$z[B$z.length-3],B$c=B$_-(B$r=B$z[B$z.length-2]),B$X=(B$X=-(B$L-(B$H=B$z[B$z.length-1])))/(B$t=Math.sqrt(B$X*B$X+B$c*B$c))*B$F,B$c=B$c/B$t*B$F,B$g.push(B$r-B$X+this.x,B$H-B$c+this.y,B$P,B$E,B$o,B$r+B$X+this.x,B$H+B$c+this.y,B$P,B$E,B$o);var B$j=B$C;for(B$R=1;B$R<B$j;B$R++)B$J.push(B$N+2*(B$R-1),B$N+2*(B$R-1)+1,B$N+2*B$R+1,B$N+2*B$R+1,B$N+2*B$R,B$N+2*(B$R-1));return B$g},B$J.createLine=function(B$O,B$J,B$D,B$p){var B$m=B$O.concat(),B$C=B$O,B$i=this.borderColor,B$k=(B$i>>16&255)/255,B$_=(B$i>>8&255)/255,B$L=(255&B$i)/255;B$m.splice(0,5);var B$r,B$H,B$Y,B$G,B$X,B$c,B$h,B$y,B$v,B$A,B$q,B$d,B$M,B$a,B$e,B$t,B$z,B$g,B$s,B$P,B$E=B$m.length/5,B$o=B$p,B$W=B$D/2;B$Y=B$m[0],B$G=B$m[1],B$A=B$Y-(B$X=B$m[5]),B$v=(B$v=-(B$G-(B$c=B$m[6])))/(B$P=Math.sqrt(B$v*B$v+B$A*B$A))*B$W,B$A=B$A/B$P*B$W,B$C.push(B$Y-B$v,B$G-B$A,B$k,B$_,B$L,B$Y+B$v,B$G+B$A,B$k,B$_,B$L);for(var B$N=1;B$N<B$E-1;B$N++)B$Y=B$m[5*(B$N-1)],B$G=B$m[5*(B$N-1)+1],B$X=B$m[5*B$N],B$c=B$m[5*B$N+1],B$h=B$m[5*(B$N+1)],B$y=B$m[5*(B$N+1)+1],B$A=B$Y-B$X,B$d=B$X-B$h,B$e=(-(B$v=(B$v=-(B$G-B$c))/(B$P=Math.sqrt(B$v*B$v+B$A*B$A))*B$W)+B$Y)*(-(B$A=B$A/B$P*B$W)+B$c)-(-B$v+B$X)*(-B$A+B$G),B$g=(-(B$q=(B$q=-(B$c-B$y))/(B$P=Math.sqrt(B$q*B$q+B$d*B$d))*B$W)+B$h)*(-(B$d=B$d/B$P*B$W)+B$c)-(-B$q+B$X)*(-B$d+B$y),B$s=(B$M=-B$A+B$G-(-B$A+B$c))*(B$z=-B$q+B$X-(-B$q+B$h))-(B$t=-B$d+B$y-(-B$d+B$c))*(B$a=-B$v+B$X-(-B$v+B$Y)),Math.abs(B$s)<.1?(B$s+=10.1,B$C.push(B$X-B$v,B$c-B$A,B$k,B$_,B$L,B$X+B$v,B$c+B$A,B$k,B$_,B$L)):(((B$r=(B$a*B$g-B$z*B$e)/B$s)-B$X)*(B$r-B$X)+((B$H=(B$t*B$e-B$M*B$g)/B$s)-B$c)+(B$H-B$c),B$C.push(B$r,B$H,B$k,B$_,B$L,B$X-(B$r-B$X),B$c-(B$H-B$c),B$k,B$_,B$L));B$Y=B$m[B$m.length-10],B$G=B$m[B$m.length-9],B$A=B$Y-(B$X=B$m[B$m.length-5]),B$v=(B$v=-(B$G-(B$c=B$m[B$m.length-4])))/(B$P=Math.sqrt(B$v*B$v+B$A*B$A))*B$W,B$A=B$A/B$P*B$W,B$C.push(B$X-B$v,B$c-B$A,B$k,B$_,B$L,B$X+B$v,B$c+B$A,B$k,B$_,B$L);var B$F=this.edges+1;for(B$N=1;B$N<B$F;B$N++)B$J.push(B$o+2*(B$N-1),B$o+2*(B$N-1)+1,B$o+2*B$N+1,B$o+2*B$N+1,B$o+2*B$N,B$o+2*(B$N-1));return B$C},B$J.createLoopLine=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$O.concat(),B$k=B$m||B$O,B$_=this.borderColor,B$L=(B$_>>16&255)/255,B$r=(B$_>>8&255)/255,B$H=(255&B$_)/255;B$i.splice(0,5);var B$Y=[B$i[0],B$i[1]],B$G=[B$i[B$i.length-5],B$i[B$i.length-4]],B$X=B$G[0]+.5*(B$Y[0]-B$G[0]),B$c=B$G[1]+.5*(B$Y[1]-B$G[1]);B$i.unshift(B$X,B$c,0,0,0),B$i.push(B$X,B$c,0,0,0);var B$h,B$y,B$v,B$A,B$q,B$d,B$M,B$a,B$e,B$t,B$z,B$g,B$s,B$P,B$E,B$o,B$W,B$N,B$F,B$R,B$j=B$i.length/5,B$u=B$p,B$l=B$D/2;B$v=B$i[0],B$A=B$i[1],B$t=B$v-(B$q=B$i[5]),B$e=(B$e=-(B$A-(B$d=B$i[6])))/(B$R=Math.sqrt(B$e*B$e+B$t*B$t))*B$l,B$t=B$t/B$R*B$l,B$k.push(B$v-B$e,B$A-B$t,B$L,B$r,B$H,B$v+B$e,B$A+B$t,B$L,B$r,B$H);for(var B$$=1;B$$<B$j-1;B$$++)B$v=B$i[5*(B$$-1)],B$A=B$i[5*(B$$-1)+1],B$q=B$i[5*B$$],B$d=B$i[5*B$$+1],B$M=B$i[5*(B$$+1)],B$a=B$i[5*(B$$+1)+1],B$t=B$v-B$q,B$g=B$q-B$M,B$E=(-(B$e=(B$e=-(B$A-B$d))/(B$R=Math.sqrt(B$e*B$e+B$t*B$t))*B$l)+B$v)*(-(B$t=B$t/B$R*B$l)+B$d)-(-B$e+B$q)*(-B$t+B$A),B$N=(-(B$z=(B$z=-(B$d-B$a))/(B$R=Math.sqrt(B$z*B$z+B$g*B$g))*B$l)+B$M)*(-(B$g=B$g/B$R*B$l)+B$d)-(-B$z+B$q)*(-B$g+B$a),B$F=(B$s=-B$t+B$A-(-B$t+B$d))*(B$W=-B$z+B$q-(-B$z+B$M))-(B$o=-B$g+B$a-(-B$g+B$d))*(B$P=-B$e+B$q-(-B$e+B$v)),Math.abs(B$F)<.1?(B$F+=10.1,B$k.push(B$q-B$e,B$d-B$t,B$L,B$r,B$H,B$q+B$e,B$d+B$t,B$L,B$r,B$H)):(((B$h=(B$P*B$N-B$W*B$E)/B$F)-B$q)*(B$h-B$q)+((B$y=(B$o*B$E-B$s*B$N)/B$F)-B$d)+(B$y-B$d),B$k.push(B$h,B$y,B$L,B$r,B$H,B$q-(B$h-B$q),B$d-(B$y-B$d),B$L,B$r,B$H));B$C&&(B$J=B$C);var B$x=this.edges+1;for(B$$=1;B$$<B$x;B$$++)B$J.push(B$u+2*(B$$-1),B$u+2*(B$$-1)+1,B$u+2*B$$+1,B$u+2*B$$+1,B$u+2*B$$,B$u+2*(B$$-1));return B$J.push(B$u+2*(B$$-1),B$u+2*(B$$-1)+1,B$u+1,B$u+1,B$u,B$u+2*(B$$-1)),B$k},B$O}(),B$pO=function(){function B$c(){}return B$Y(B$c,"laya.webgl.shapes.Earcut"),B$c.earcut=function(B$O,B$J,B$D){B$D=B$D||2;var B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r=B$J&&B$J.length,B$H=B$r?B$J[0]*B$D:B$O.length,B$Y=B$c.linkedList(B$O,0,B$H,B$D,!0),B$G=[];if(!B$Y)return B$G;if(B$r&&(B$Y=B$c.eliminateHoles(B$O,B$J,B$Y,B$D)),B$O.length>80*B$D){B$p=B$C=B$O[0],B$m=B$i=B$O[1];for(var B$X=B$D;B$X<B$H;B$X+=B$D)(B$k=B$O[B$X])<B$p&&(B$p=B$k),(B$_=B$O[B$X+1])<B$m&&(B$m=B$_),B$C<B$k&&(B$C=B$k),B$i<B$_&&(B$i=B$_);B$L=0!==(B$L=Math.max(B$C-B$p,B$i-B$m))?1/B$L:0}return B$c.earcutLinked(B$Y,B$G,B$D,B$p,B$m,B$L),B$G},B$c.linkedList=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i;if(B$m===0<B$c.signedArea(B$O,B$J,B$D,B$p))for(B$C=B$J;B$C<B$D;B$C+=B$p)B$i=B$c.insertNode(B$C,B$O[B$C],B$O[B$C+1],B$i);else for(B$C=B$D-B$p;B$J<=B$C;B$C-=B$p)B$i=B$c.insertNode(B$C,B$O[B$C],B$O[B$C+1],B$i);return B$i&&B$c.equals(B$i,B$i.next)&&(B$c.removeNode(B$i),B$i=B$i.next),B$i},B$c.filterPoints=function(B$O,B$J){if(!B$O)return B$O;B$J||(B$J=B$O);var B$D,B$p=B$O;do{if(B$D=!1,B$p.steiner||!B$c.equals(B$p,B$p.next)&&0!==B$c.area(B$p.prev,B$p,B$p.next))B$p=B$p.next;else{if(B$c.removeNode(B$p),(B$p=B$J=B$p.prev)===B$p.next)break;B$D=!0}}while(B$D||B$p!==B$J);return B$J},B$c.earcutLinked=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(B$O){!B$i&&B$C&&B$c.indexCurve(B$O,B$p,B$m,B$C);for(var B$k,B$_,B$L=B$O;B$O.prev!==B$O.next;)if(B$k=B$O.prev,B$_=B$O.next,B$C?B$c.isEarHashed(B$O,B$p,B$m,B$C):B$c.isEar(B$O))B$J.push(B$k.i/B$D),B$J.push(B$O.i/B$D),B$J.push(B$_.i/B$D),B$c.removeNode(B$O),B$O=B$_.next,B$L=B$_.next;else if((B$O=B$_)===B$L){B$i?1===B$i?(B$O=B$c.cureLocalIntersections(B$O,B$J,B$D),B$c.earcutLinked(B$O,B$J,B$D,B$p,B$m,B$C,2)):2===B$i&&B$c.splitEarcut(B$O,B$J,B$D,B$p,B$m,B$C):B$c.earcutLinked(B$c.filterPoints(B$O,null),B$J,B$D,B$p,B$m,B$C,1);break}}},B$c.isEar=function(B$O){var B$J=B$O.prev,B$D=B$O,B$p=B$O.next;if(0<=B$c.area(B$J,B$D,B$p))return!1;for(var B$m=B$O.next.next;B$m!==B$O.prev;){if(B$c.pointInTriangle(B$J.x,B$J.y,B$D.x,B$D.y,B$p.x,B$p.y,B$m.x,B$m.y)&&0<=B$c.area(B$m.prev,B$m,B$m.next))return!1;B$m=B$m.next}return!0},B$c.isEarHashed=function(B$O,B$J,B$D,B$p){var B$m=B$O.prev,B$C=B$O,B$i=B$O.next;if(0<=B$c.area(B$m,B$C,B$i))return!1;for(var B$k=B$m.x<B$C.x?B$m.x<B$i.x?B$m.x:B$i.x:B$C.x<B$i.x?B$C.x:B$i.x,B$_=B$m.y<B$C.y?B$m.y<B$i.y?B$m.y:B$i.y:B$C.y<B$i.y?B$C.y:B$i.y,B$L=B$m.x>B$C.x?B$m.x>B$i.x?B$m.x:B$i.x:B$C.x>B$i.x?B$C.x:B$i.x,B$r=B$m.y>B$C.y?B$m.y>B$i.y?B$m.y:B$i.y:B$C.y>B$i.y?B$C.y:B$i.y,B$H=B$c.zOrder(B$k,B$_,B$J,B$D,B$p),B$Y=B$c.zOrder(B$L,B$r,B$J,B$D,B$p),B$G=B$O.nextZ;B$G&&B$G.z<=B$Y;){if(B$G!==B$O.prev&&B$G!==B$O.next&&B$c.pointInTriangle(B$m.x,B$m.y,B$C.x,B$C.y,B$i.x,B$i.y,B$G.x,B$G.y)&&0<=B$c.area(B$G.prev,B$G,B$G.next))return!1;B$G=B$G.nextZ}for(B$G=B$O.prevZ;B$G&&B$G.z>=B$H;){if(B$G!==B$O.prev&&B$G!==B$O.next&&B$c.pointInTriangle(B$m.x,B$m.y,B$C.x,B$C.y,B$i.x,B$i.y,B$G.x,B$G.y)&&0<=B$c.area(B$G.prev,B$G,B$G.next))return!1;B$G=B$G.prevZ}return!0},B$c.cureLocalIntersections=function(B$O,B$J,B$D){var B$p=B$O;do{var B$m=B$p.prev,B$C=B$p.next.next;!B$c.equals(B$m,B$C)&&B$c.intersects(B$m,B$p,B$p.next,B$C)&&B$c.locallyInside(B$m,B$C)&&B$c.locallyInside(B$C,B$m)&&(B$J.push(B$m.i/B$D),B$J.push(B$p.i/B$D),B$J.push(B$C.i/B$D),B$c.removeNode(B$p),B$c.removeNode(B$p.next),B$p=B$O=B$C),B$p=B$p.next}while(B$p!==B$O);return B$p},B$c.splitEarcut=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$O;do{for(var B$k=B$i.next.next;B$k!==B$i.prev;){if(B$i.i!==B$k.i&&B$c.isValidDiagonal(B$i,B$k)){var B$_=B$c.splitPolygon(B$i,B$k);return B$i=B$c.filterPoints(B$i,B$i.next),B$_=B$c.filterPoints(B$_,B$_.next),B$c.earcutLinked(B$i,B$J,B$D,B$p,B$m,B$C),void B$c.earcutLinked(B$_,B$J,B$D,B$p,B$m,B$C)}B$k=B$k.next}B$i=B$i.next}while(B$i!==B$O)},B$c.eliminateHoles=function(B$O,B$J,B$D,B$p){var B$m,B$C,B$i,B$k,B$_,B$L=[];for(B$m=0,B$C=B$J.length;B$m<B$C;B$m++)B$i=B$J[B$m]*B$p,B$k=B$m<B$C-1?B$J[B$m+1]*B$p:B$O.length,(B$_=B$c.linkedList(B$O,B$i,B$k,B$p,!1))===B$_.next&&(B$_.steiner=!0),B$L.push(B$c.getLeftmost(B$_));for(B$L.sort(B$c.compareX),B$m=0;B$m<B$L.length;B$m++)B$c.eliminateHole(B$L[B$m],B$D),B$D=B$c.filterPoints(B$D,B$D.next);return B$D},B$c.compareX=function(B$O,B$J){return B$O.x-B$J.x},B$c.eliminateHole=function(B$O,B$J){if(B$J=B$c.findHoleBridge(B$O,B$J)){var B$D=B$c.splitPolygon(B$J,B$O);B$c.filterPoints(B$D,B$D.next)}},B$c.findHoleBridge=function(B$O,B$J){var B$D,B$p=B$J,B$m=B$O.x,B$C=B$O.y,B$i=-1/0;do{if(B$C<=B$p.y&&B$C>=B$p.next.y&&B$p.next.y!==B$p.y){var B$k=B$p.x+(B$C-B$p.y)*(B$p.next.x-B$p.x)/(B$p.next.y-B$p.y);if(B$k<=B$m&&B$i<B$k){if((B$i=B$k)===B$m){if(B$C===B$p.y)return B$p;if(B$C===B$p.next.y)return B$p.next}B$D=B$p.x<B$p.next.x?B$p:B$p.next}}B$p=B$p.next}while(B$p!==B$J);if(!B$D)return null;if(B$m===B$i)return B$D.prev;var B$_,B$L=B$D,B$r=B$D.x,B$H=B$D.y,B$Y=1/0;for(B$p=B$D.next;B$p!==B$L;)B$m>=B$p.x&&B$p.x>=B$r&&B$m!==B$p.x&&B$c.pointInTriangle(B$C<B$H?B$m:B$i,B$C,B$r,B$H,B$C<B$H?B$i:B$m,B$C,B$p.x,B$p.y)&&((B$_=Math.abs(B$C-B$p.y)/(B$m-B$p.x))<B$Y||B$_===B$Y&&B$p.x>B$D.x)&&B$c.locallyInside(B$p,B$O)&&(B$D=B$p,B$Y=B$_),B$p=B$p.next;return B$D},B$c.indexCurve=function(B$O,B$J,B$D,B$p){for(var B$m=B$O;null===B$m.z&&(B$m.z=B$c.zOrder(B$m.x,B$m.y,B$J,B$D,B$p)),B$m.prevZ=B$m.prev,B$m.nextZ=B$m.next,(B$m=B$m.next)!==B$O;);B$m.prevZ.nextZ=null,B$m.prevZ=null,B$c.sortLinked(B$m)},B$c.sortLinked=function(B$O){var B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L=1;do{for(B$D=B$O,B$C=B$O=null,B$i=0;B$D;){for(B$i++,B$p=B$D,B$J=B$k=0;B$J<B$L&&(B$k++,B$p=B$p.nextZ);B$J++);for(B$_=B$L;0<B$k||0<B$_&&B$p;)0!==B$k&&(0===B$_||!B$p||B$D.z<=B$p.z)?(B$D=(B$m=B$D).nextZ,B$k--):(B$p=(B$m=B$p).nextZ,B$_--),B$C?B$C.nextZ=B$m:B$O=B$m,B$m.prevZ=B$C,B$C=B$m;B$D=B$p}B$C.nextZ=null,B$L*=2}while(1<B$i);return B$O},B$c.zOrder=function(B$O,B$J,B$D,B$p,B$m){return(B$O=1431655765&((B$O=858993459&((B$O=252645135&((B$O=16711935&((B$O=32767*(B$O-B$D)*B$m)|B$O<<8))|B$O<<4))|B$O<<2))|B$O<<1))|(B$J=1431655765&((B$J=858993459&((B$J=252645135&((B$J=16711935&((B$J=32767*(B$J-B$p)*B$m)|B$J<<8))|B$J<<4))|B$J<<2))|B$J<<1))<<1},B$c.getLeftmost=function(B$O){for(var B$J=B$O,B$D=B$O;B$J.x<B$D.x&&(B$D=B$J),(B$J=B$J.next)!==B$O;);return B$D},B$c.pointInTriangle=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){return 0<=(B$m-B$i)*(B$J-B$k)-(B$O-B$i)*(B$C-B$k)&&0<=(B$O-B$i)*(B$p-B$k)-(B$D-B$i)*(B$J-B$k)&&0<=(B$D-B$i)*(B$C-B$k)-(B$m-B$i)*(B$p-B$k)},B$c.isValidDiagonal=function(B$O,B$J){return B$O.next.i!==B$J.i&&B$O.prev.i!==B$J.i&&!B$c.intersectsPolygon(B$O,B$J)&&B$c.locallyInside(B$O,B$J)&&B$c.locallyInside(B$J,B$O)&&B$c.middleInside(B$O,B$J)},B$c.area=function(B$O,B$J,B$D){return(B$J.y-B$O.y)*(B$D.x-B$J.x)-(B$J.x-B$O.x)*(B$D.y-B$J.y)},B$c.equals=function(B$O,B$J){return B$O.x===B$J.x&&B$O.y===B$J.y},B$c.intersects=function(B$O,B$J,B$D,B$p){return!!(B$c.equals(B$O,B$J)&&B$c.equals(B$D,B$p)||B$c.equals(B$O,B$p)&&B$c.equals(B$D,B$J))||0<B$c.area(B$O,B$J,B$D)!=0<B$c.area(B$O,B$J,B$p)&&0<B$c.area(B$D,B$p,B$O)!=0<B$c.area(B$D,B$p,B$J)},B$c.intersectsPolygon=function(B$O,B$J){var B$D=B$O;do{if(B$D.i!==B$O.i&&B$D.next.i!==B$O.i&&B$D.i!==B$J.i&&B$D.next.i!==B$J.i&&B$c.intersects(B$D,B$D.next,B$O,B$J))return!0;B$D=B$D.next}while(B$D!==B$O);return!1},B$c.locallyInside=function(B$O,B$J){return B$c.area(B$O.prev,B$O,B$O.next)<0?0<=B$c.area(B$O,B$J,B$O.next)&&0<=B$c.area(B$O,B$O.prev,B$J):B$c.area(B$O,B$J,B$O.prev)<0||B$c.area(B$O,B$O.next,B$J)<0},B$c.middleInside=function(B$O,B$J){for(var B$D=B$O,B$p=!1,B$m=(B$O.x+B$J.x)/2,B$C=(B$O.y+B$J.y)/2;B$D.y>B$C!=B$D.next.y>B$C&&B$D.next.y!==B$D.y&&B$m<(B$D.next.x-B$D.x)*(B$C-B$D.y)/(B$D.next.y-B$D.y)+B$D.x&&(B$p=!B$p),(B$D=B$D.next)!==B$O;);return B$p},B$c.splitPolygon=function(B$O,B$J){var B$D=new B$mO(B$O.i,B$O.x,B$O.y),B$p=new B$mO(B$J.i,B$J.x,B$J.y),B$m=B$O.next,B$C=B$J.prev;return(B$O.next=B$J).prev=B$O,(B$D.next=B$m).prev=B$D,(B$p.next=B$D).prev=B$p,(B$C.next=B$p).prev=B$C,B$p},B$c.insertNode=function(B$O,B$J,B$D,B$p){var B$m=new B$mO(B$O,B$J,B$D);return B$p?(B$m.next=B$p.next,(B$m.prev=B$p).next.prev=B$m,B$p.next=B$m):(B$m.prev=B$m).next=B$m,B$m},B$c.removeNode=function(B$O){B$O.next.prev=B$O.prev,B$O.prev.next=B$O.next,B$O.prevZ&&(B$O.prevZ.nextZ=B$O.nextZ),B$O.nextZ&&(B$O.nextZ.prevZ=B$O.prevZ)},B$c.signedArea=function(B$O,B$J,B$D,B$p){for(var B$m=0,B$C=B$J,B$i=B$D-B$p;B$C<B$D;B$C+=B$p)B$m+=(B$O[B$i]-B$O[B$C])*(B$O[B$C+1]+B$O[B$i+1]),B$i=B$C;return B$m},B$c}(),B$mO=function(){function B$O(B$O,B$J,B$D){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=B$O,this.x=B$J,this.y=B$D,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return B$Y(B$O,"laya.webgl.shapes.EarcutNode"),B$O}(),B$CO=(function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this.lineWidth=B$O,this.lineColor=B$J,this.lineAlpha=B$D,this.fillColor=B$p,this.fillAlpha=B$m,this.shape=B$i,this.fill=B$C}B$Y(B$O,"laya.webgl.shapes.GeometryData");var B$J=B$O.prototype;B$J.clone=function(){return new B$O(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},B$J.getIndexData=function(){return null},B$J.getVertexData=function(){return null},B$J.destroy=function(){this.shape=null}}(),function(){function B$O(B$O){if(B$O instanceof Float32Array)this.points=B$O;else if(B$O instanceof Array){B$O.length;this.points=new Float32Array(B$O)}}B$Y(B$O,"laya.webgl.shapes.Vertex");var B$J=B$O.prototype;B$M.imps(B$J,{"laya.webgl.shapes.IShape":!0}),B$J.getData=function(B$O,B$J,B$D){},B$J.needUpdate=function(B$O){return!1},B$J.rebuild=function(B$O){},B$J.setMatrix=function(B$O){}}(),function(){function B$_(B$O){void 0===B$O&&(B$O=1e4),this._renderType=B$O}B$Y(B$_,"laya.webgl.submit.Submit");var B$O=B$_.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O.releaseRender=function(){var B$O=B$_._cache;(B$O[B$O._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},B$O.getRenderType=function(){return this._renderType},B$O.renderSubmit=function(){if(0===this._numEle)return 1;var B$O=this.shaderValue.textureHost;if(B$O){var B$J=B$O.source;if(!B$O.bitmap||!B$J)return 1;this.shaderValue.texture=B$J,B$O.alphaTexture&&B$O.alphaTexture.source&&(this.shaderValue.texture1=B$O.alphaTexture.source)}this._vb.bind_upload(this._ib);var B$D=B$qO.mainContext;return this.shaderValue.upload(),B$T.activeBlendFunction!==this._blendFn&&(B$D.enable(3042),this._blendFn(B$D),B$T.activeBlendFunction=this._blendFn),B$E.drawCall++,B$E.trianglesFaces+=this._numEle/3,B$D.drawElements(4,this._numEle,5123,this._startIdx),1},B$_.__init__=function(){var B$O=B$_.RENDERBASE=new B$_(-1);B$O.shaderValue=new B$eO(0,0),B$O.shaderValue.ALPHA=-1234},B$_.createSubmit=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$_._cache._length?B$_._cache[--B$_._cache._length]:new B$_;null==B$D&&((B$D=B$C._selfVb||(B$C._selfVb=B$fO.create(-1))).clear(),B$p=0),B$C._ib=B$J,B$C._vb=B$D,B$C._startIdx=B$p*B$cO.BYTES_PIDX,B$C._numEle=0;var B$i=B$O._nBlendType;B$C._blendFn=B$O._targets?B$T.targetFns[B$i]:B$T.fns[B$i],B$C.shaderValue=B$m,B$C.shaderValue.setValue(B$O._shader2D);var B$k=B$O._shader2D.filters;return B$k&&B$C.shaderValue.setFilters(B$k),B$C},B$_.createShape=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$_._cache._length?B$_._cache[--B$_._cache._length]:new B$_;B$i._ib=B$J,B$i._vb=B$D,B$i._numEle=B$p,B$i._startIdx=B$m,B$i.shaderValue=B$C,B$i.shaderValue.setValue(B$O._shader2D);var B$k=B$O._nBlendType;return B$i._blendFn=B$O._targets?B$T.targetFns[B$k]:B$T.fns[B$k],B$i},B$_.TYPE_2D=1e4,B$_.TYPE_CANVAS=10003,B$_.TYPE_CMDSETRT=10004,B$_.TYPE_CUSTOM=10005,B$_.TYPE_BLURRT=10006,B$_.TYPE_CMDDESTORYPRERT=10007,B$_.TYPE_DISABLESTENCIL=10008,B$_.TYPE_OTHERIBVB=10009,B$_.TYPE_PRIMITIVE=10010,B$_.TYPE_RT=10011,B$_.TYPE_BLUR_RT=10012,B$_.TYPE_TARGET=10013,B$_.TYPE_CHANGE_VALUE=10014,B$_.TYPE_SHAPE=10015,B$_.TYPE_TEXTURE=10016,B$_.TYPE_FILLTEXTURE=10017,B$_.RENDERBASE=null,B$_._cache=((B$_._cache=[])._length=0,B$_._cache),B$_}()),B$iO=function(){function B$p(){this.fun=null,this.args=null}B$Y(B$p,"laya.webgl.submit.SubmitCMD");var B$O=B$p.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O.renderSubmit=function(){return this.fun.apply(null,this.args),1},B$O.getRenderType=function(){return 0},B$O.releaseRender=function(){var B$O=B$p._cache;B$O[B$O._length++]=this},B$p.create=function(B$O,B$J){var B$D=B$p._cache._length?B$p._cache[--B$p._cache._length]:new B$p;return B$D.fun=B$J,B$D.args=B$O,B$D},B$p._cache=((B$p._cache=[])._length=0,B$p._cache),B$p}(),B$kO=function(){function B$J(){this.variables={}}B$Y(B$J,"laya.webgl.submit.SubmitCMDScope");var B$O=B$J.prototype;return B$O.getValue=function(B$O){return this.variables[B$O]},B$O.addValue=function(B$O,B$J){return this.variables[B$O]=B$J},B$O.setValue=function(B$O,B$J){return this.variables.hasOwnProperty(B$O)?this.variables[B$O]=B$J:null},B$O.clear=function(){for(var B$O in this.variables)delete this.variables[B$O]},B$O.recycle=function(){this.clear(),B$J.POOL.push(this)},B$J.create=function(){var B$O=B$J.POOL.pop();return B$O||(B$O=new B$J),B$O},B$J.POOL=[],B$J}(),B$_O=function(){function B$H(){this.offset=0,this.startIndex=0,this._mat=B$t.create()}B$Y(B$H,"laya.webgl.submit.SubmitOtherIBVB");var B$O=B$H.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O.releaseRender=function(){var B$O=B$H._cache;(B$O[B$O._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},B$O.getRenderType=function(){return 10009},B$O.renderSubmit=function(){var B$O=this._shaderValue.textureHost;if(B$O){var B$J=B$O.source;if(!B$O.bitmap||!B$J)return 1;this._shaderValue.texture=B$J}this._vb.bind_upload(this._ib);var B$D=B$vO.worldMatrix4,B$p=B$t.TEMP;B$t.mulPre(this._mat,B$D[0],B$D[1],B$D[4],B$D[5],B$D[12],B$D[13],B$p);var B$m=B$vO.worldMatrix4=B$H.tempMatrix4;B$m[0]=B$p.a,B$m[1]=B$p.b,B$m[4]=B$p.c,B$m[5]=B$p.d,B$m[12]=B$p.tx,B$m[13]=B$p.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var B$C=B$qO.mainContext;return B$T.activeBlendFunction!==this._blendFn&&(B$C.enable(3042),this._blendFn(B$C),B$T.activeBlendFunction=this._blendFn),B$E.drawCall++,B$E.trianglesFaces+=this._numEle/3,B$C.drawElements(4,this._numEle,5123,this.startIndex),B$vO.worldMatrix4=B$D,B$RO.activeShader=null,1},B$H.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){void 0===B$_&&(B$_=0);var B$L=B$H._cache._length?B$H._cache[--B$H._cache._length]:new B$H;B$L._ib=B$D,B$L._vb=B$J,B$L._numEle=B$p,B$L._shader=B$m,B$L._shaderValue=B$C;var B$r=B$O._nBlendType;switch(B$L._blendFn=B$O._targets?B$T.targetFns[B$r]:B$T.fns[B$r],B$_){case 0:B$L.offset=0,B$L.startIndex=B$k/(B$cO.BYTES_PE*B$J.vertexStride)*1.5,B$L.startIndex*=B$cO.BYTES_PIDX;break;case 1:B$L.startIndex=B$i,B$L.offset=B$k}return B$L},B$H._cache=((B$H._cache=[])._length=0,B$H._cache),B$H.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B$H}(),B$LO=function(){function B$D(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new B$g,this.screenRect=new B$g}B$Y(B$D,"laya.webgl.submit.SubmitScissor");var B$O=B$D.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O._scissor=function(B$O,B$J,B$D,B$p){var B$m=B$vO.worldMatrix4,B$C=B$m[0],B$i=B$m[5],B$k=B$m[12],B$_=B$m[13];if(B$p*=B$i,(B$D*=B$C)<1||B$p<1)return!1;var B$L=(B$O=B$O*B$C+B$k)+B$D,B$r=(B$J=B$J*B$i+B$_)+B$p;B$O<0&&(B$D=B$L-(B$O=0)),B$J<0&&(B$p=B$r-(B$J=0));var B$H=B$vO.worldClipRect;if(B$O=Math.max(B$O,B$H.x),B$J=Math.max(B$J,B$H.y),B$D=Math.min(B$L,B$H.right)-B$O,B$p=Math.min(B$r,B$H.bottom)-B$J,B$D<1||B$p<1)return!1;var B$Y=B$vO.worldScissorTest;return this.screenRect.copyFrom(B$H),B$H.x=B$O,B$H.y=B$J,B$H.width=B$D,B$H.height=B$p,B$vO.worldScissorTest=!0,B$J=B$vO.height-B$J-B$p,B$qO.mainContext.scissor(B$O,B$J,B$D,B$p),B$qO.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),B$Y?(B$J=B$vO.height-this.screenRect.y-this.screenRect.height,B$qO.mainContext.scissor(this.screenRect.x,B$J,this.screenRect.width,this.screenRect.height),B$qO.mainContext.enable(3089)):(B$qO.mainContext.disable(3089),B$vO.worldScissorTest=!1),B$H.copyFrom(this.screenRect),!0},B$O._scissorWithTagart=function(B$O,B$J,B$D,B$p){if(B$D<1||B$p<1)return!1;var B$m=B$O+B$D,B$C=B$J+B$p;B$O<0&&(B$D=B$m-(B$O=0)),B$J<0&&(B$p=B$C-(B$J=0));var B$i=B$vO.worldClipRect;if(B$O=Math.max(B$O,B$i.x),B$J=Math.max(B$J,B$i.y),B$D=Math.min(B$m,B$i.right)-B$O,B$p=Math.min(B$C,B$i.bottom)-B$J,B$D<1||B$p<1)return!1;var B$k=B$vO.worldScissorTest;return this.screenRect.copyFrom(B$i),B$vO.worldScissorTest=!0,B$i.x=B$O,B$i.y=B$J,B$i.width=B$D,B$i.height=B$p,B$J=B$vO.height-B$J-B$p,B$qO.mainContext.scissor(B$O,B$J,B$D,B$p),B$qO.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),B$k?(B$J=B$vO.height-this.screenRect.y-this.screenRect.height,B$qO.mainContext.scissor(this.screenRect.x,B$J,this.screenRect.width,this.screenRect.height),B$qO.mainContext.enable(3089)):(B$qO.mainContext.disable(3089),B$vO.worldScissorTest=!1),B$i.copyFrom(this.screenRect),!0},B$O.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},B$O.getRenderType=function(){return 0},B$O.releaseRender=function(){var B$O=B$D._cache;(B$O[B$O._length++]=this).context=null},B$D.create=function(B$O){var B$J=B$D._cache._length?B$D._cache[--B$D._cache._length]:new B$D;return B$J.context=B$O,B$J},B$D._cache=((B$D._cache=[])._length=0,B$D._cache),B$D}(),B$rO=function(){function B$_(){this.step=0,this.blendMode=null,this.level=0}B$Y(B$_,"laya.webgl.submit.SubmitStencil");var B$O=B$_.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},B$O.getRenderType=function(){return 0},B$O.releaseRender=function(){var B$O=B$_._cache;B$O[B$O._length++]=this},B$O.do1=function(){var B$O=B$qO.mainContext;B$O.enable(2960),B$O.clear(1024),B$O.colorMask(!1,!1,!1,!1),B$O.stencilFunc(514,this.level,255),B$O.stencilOp(7680,7680,7682)},B$O.do2=function(){var B$O=B$qO.mainContext;B$O.stencilFunc(514,this.level+1,255),B$O.colorMask(!0,!0,!0,!0),B$O.stencilOp(7680,7680,7680)},B$O.do3=function(){var B$O=B$qO.mainContext;B$O.colorMask(!0,!0,!0,!0),B$O.stencilOp(7680,7680,7680),B$O.clear(1024),B$O.disable(2960)},B$O.do4=function(){var B$O=B$qO.mainContext;0==this.level&&(B$O.enable(2960),B$O.clear(1024)),B$O.colorMask(!1,!1,!1,!1),B$O.stencilFunc(519,0,255),B$O.stencilOp(7680,7680,7682)},B$O.do5=function(){var B$O=B$qO.mainContext;B$O.stencilFunc(514,this.level,255),B$O.colorMask(!0,!0,!0,!0),B$O.stencilOp(7680,7680,7680)},B$O.do6=function(){var B$O=B$qO.mainContext;B$T.targetFns[B$T.TOINT[this.blendMode]](B$O)},B$O.do7=function(){var B$O=B$qO.mainContext;B$O.colorMask(!1,!1,!1,!1),B$O.stencilOp(7680,7680,7683)},B$O.do8=function(){var B$O=B$qO.mainContext;B$O.colorMask(!0,!0,!0,!0),B$O.stencilFunc(514,this.level,255),B$O.stencilOp(7680,7680,7680)},B$_.restore=function(B$O,B$J,B$D,B$p,B$m){var B$C;if((B$O._renderKey=0)<B$_._mask&&B$_._mask--,0==B$_._mask)B$C=laya.webgl.submit.SubmitStencil.create(3),B$O.addRenderObject(B$C),B$O._curSubmit=B$CO.RENDERBASE;else{B$C=laya.webgl.submit.SubmitStencil.create(7),B$O.addRenderObject(B$C);var B$i=B$O._vb;B$i._byteLength;if(B$hO.fillRectImgVb(B$i,null,B$J.x,B$J.y,B$J.width,B$J.height,B$F.DEF_UV,B$D,B$p,B$m,0,0)){B$O._shader2D.glTexture=null;var B$k=B$O._curSubmit=B$CO.createSubmit(B$O,B$O._ib,B$i,(B$i._byteLength-64)/32*3,B$eO.create(2,0));B$k.shaderValue.ALPHA=1,B$O._submits[B$O._submits._length++]=B$k,B$O._curSubmit._numEle+=6,B$O._curSubmit=B$CO.RENDERBASE}else alert("clipRect calc stencil rect error");B$C=laya.webgl.submit.SubmitStencil.create(8),B$O.addRenderObject(B$C)}},B$_.restore2=function(B$O,B$J){var B$D;(B$O._renderKey=0)<B$_._mask&&B$_._mask--,0==B$_._mask?(B$D=laya.webgl.submit.SubmitStencil.create(3),B$O.addRenderObject(B$D),B$O._curSubmit=B$CO.RENDERBASE):(B$D=laya.webgl.submit.SubmitStencil.create(7),B$O.addRenderObject(B$D),B$O._submits[B$O._submits._length++]=B$J,B$D=laya.webgl.submit.SubmitStencil.create(8),B$O.addRenderObject(B$D))},B$_.create=function(B$O){var B$J=B$_._cache._length?B$_._cache[--B$_._cache._length]:new B$_;return 5==(B$J.step=B$O)&&++B$_._mask,B$J.level=B$_._mask,B$J},B$_._cache=((B$_._cache=[])._length=0,B$_._cache),B$_._mask=0,B$_}(),B$HO=function(){function B$k(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}B$Y(B$k,"laya.webgl.submit.SubmitTarget");var B$O=B$k.prototype;return B$M.imps(B$O,{"laya.webgl.submit.ISubmit":!0}),B$O.renderSubmit=function(){this._vb.bind_upload(this._ib);var B$O=this.scope.getValue(this.proName);return B$O&&(this.shaderValue.texture=B$O.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[B$O.width,B$O.height]),this.shaderValue.upload(),this.blend(),B$E.drawCall++,B$E.trianglesFaces+=this._numEle/3,B$qO.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},B$O.blend=function(){if(B$T.activeBlendFunction!==B$T.fns[this.blendType]){var B$O=B$qO.mainContext;B$O.enable(3042),B$T.fns[this.blendType](B$O),B$T.activeBlendFunction=B$T.fns[this.blendType]}},B$O.getRenderType=function(){return 0},B$O.releaseRender=function(){var B$O=B$k._cache;(B$O[B$O._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},B$k.create=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$k._cache._length?B$k._cache[--B$k._cache._length]:new B$k;return B$i._ib=B$J,B$i._vb=B$D,B$i.proName=B$C,B$i._startIdx=B$p*B$cO.BYTES_PIDX,B$i._numEle=0,B$i.blendType=B$O._nBlendType,B$i.shaderValue=B$m,B$i.shaderValue.setValue(B$O._shader2D),B$i},B$k._cache=((B$k._cache=[])._length=0,B$k._cache),B$k}(),B$YO=function(){function B$O(){this._sourceStr=null}B$Y(B$O,"laya.webgl.text.CharSegment");var B$J=B$O.prototype;return B$M.imps(B$J,{"laya.webgl.text.ICharSegment":!0}),B$J.textToSpit=function(B$O){this._sourceStr=B$O},B$J.getChar=function(B$O){return this._sourceStr.charAt(B$O)},B$J.getCharCode=function(B$O){return this._sourceStr.charCodeAt(B$O)},B$J.length=function(){return this._sourceStr.length},B$O}(),B$GO=function(){var B$O;function B$E(){}return B$Y(B$E,"laya.webgl.text.DrawText"),B$E.__init__=function(){B$E._charsTemp=new Array,B$E._drawValue=new B$O,B$E._charSeg=new B$YO},B$E.customCharSeg=function(B$O){B$E._charSeg=B$O},B$E.getChar=function(B$O,B$J,B$D){var B$p=B$UO.createOneChar(B$O,B$D);return-1!=B$J&&(B$E._charsCache[B$J]=B$p),B$p},B$E._drawSlow=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y,B$G,B$X){var B$c,B$h,B$y=B$E._drawValue.value(B$C,B$k,B$_,B$L,B$Y,B$G,B$X),B$v=0,B$A=0,B$q=B$E._charsTemp,B$d=0,B$M=NaN;if(B$p)for(B$q.length=B$p.length,B$v=0,B$A=B$p.length;B$v<B$A;B$v++)(B$h=B$p[B$v])&&(B$M=B$h.charNum+B$y.txtID,B$q[B$v]=B$c=B$E._charsCache[B$M]||B$E.getChar(B$h.char,B$M,B$y),B$c.active());else{var B$a=B$D instanceof laya.utils.WordText?B$D.toString():B$D;if(B$N.CharacterCache){B$E._charSeg.textToSpit(B$a);var B$e=B$E._charSeg.length();for(B$v=0,B$A=B$q.length=B$e;B$v<B$A;B$v++)B$M=B$E._charSeg.getCharCode(B$v)+B$y.txtID,B$q[B$v]=B$c=B$E._charsCache[B$M]||B$E.getChar(B$E._charSeg.getChar(B$v),B$M,B$y),B$c.active(),B$d+=B$c.cw}else B$q.length=0,(B$c=B$E.getChar(B$a,-1,B$y)).active(),B$d+=B$c.cw,B$q[0]=B$c}var B$t=0;null!==B$i&&"left"!==B$i&&(B$t=-("center"==B$i?B$d/2:B$d));var B$z,B$g,B$s=NaN,B$P=0;if(B$p)for(B$v=0,B$A=B$q.length;B$v<B$A;B$v++)B$c=B$q[B$v],B$h=B$p[B$v],B$c&&B$h&&!B$c.isSpace&&(B$s=B$c.borderSize,B$z=B$c.texture,B$J._drawText(B$z,B$r+B$t+B$h.x*B$Y-B$s,B$H+B$h.y*B$G-B$s,B$z.width,B$z.height,B$m,0,0,0,0));else{for(B$v=0,B$A=B$q.length;B$v<B$A;B$v++)(B$c=B$q[B$v])&&!B$c.isSpace&&(B$s=B$c.borderSize,B$z=B$c.texture,B$J._drawText(B$z,B$r+B$t-B$s,B$H-B$s,B$z.width,B$z.height,B$m,0,0,0,0),B$O&&((B$g=B$O[B$P++])||(B$g=B$O[B$P-1]=[]),B$g[0]=B$z,B$g[1]=B$t-B$s,B$g[2]=-B$s)),B$t+=B$c.cw;B$O&&(B$O.length=B$P)}},B$E._drawFast=function(B$O,B$J,B$D,B$p,B$m){for(var B$C,B$i,B$k=0,B$_=B$O.length;B$k<B$_;B$k++)(B$C=(B$i=B$O[B$k])[0]).active(),B$J._drawText(B$C,B$p+B$i[1],B$m+B$i[2],B$C.width,B$C.height,B$D,0,0,0,0)},B$E.drawText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H){if(void 0===B$H&&(B$H=0),!(B$J&&0===B$J.length||B$D&&0===B$D.length)){var B$Y=B$p.a,B$G=B$p.d;(0!==B$p.b||0!==B$p.c)&&(B$Y=B$G=1);var B$X=1!==B$Y||1!==B$G;if(B$X&&B$M.stage.transform){var B$c=B$M.stage.transform;B$X=B$c.a===B$Y&&B$c.d===B$G}else B$X=!1;if(B$X){var B$h=(B$p=B$p.copyTo(B$aO._tmpMatrix)).tx,B$y=B$p.ty;B$p.scale(1/B$Y,1/B$G),B$p._checkTransform(),B$L*=B$Y,B$r*=B$G,B$L+=B$h-B$p.tx,B$r+=B$y-B$p.ty}else B$Y=B$G=1;if(B$D)B$E._drawSlow(null,B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$Y,B$G,B$H);else{if(null===B$J.toUpperCase){var B$v=B$Y+1e5*B$G,B$A=B$J;return void(B$A.changed||B$A.id!==B$v?(B$A.id=B$v,B$A.changed=!1,B$E._drawSlow(B$A.save,B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$Y,B$G,B$H)):B$E._drawFast(B$A.save,B$O,B$p,B$L,B$r))}var B$q=B$J+B$m.toString()+B$i+B$k+B$_+B$Y+B$G+B$C,B$d=B$E._textsCache[B$q];B$N.CharacterCache?B$d?B$E._drawFast(B$d,B$O,B$p,B$L,B$r):(B$E._textsCache.__length||(B$E._textsCache.__length=0),B$E._textsCache.__length>B$a.WebGLTextCacheCount&&((B$E._textsCache={}).__length=0,B$E._curPoolIndex=0),B$E._textCachesPool[B$E._curPoolIndex]?(B$d=B$E._textsCache[B$q]=B$E._textCachesPool[B$E._curPoolIndex]).length=0:B$E._textCachesPool[B$E._curPoolIndex]=B$d=B$E._textsCache[B$q]=[],B$E._textsCache.__length++,B$E._curPoolIndex++,B$E._drawSlow(B$d,B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$Y,B$G,B$H)):B$E._drawSlow(B$d,B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$Y,B$G,B$H)}}},B$E._charsTemp=null,B$E._textCachesPool=[],B$E._curPoolIndex=0,B$E._charsCache={},B$E._textsCache={},B$E._drawValue=null,B$E.d=[],B$E._charSeg=null,B$E.__init$=function(){B$O=function(){function B$_(){}return B$Y(B$_,""),B$_.prototype.value=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this.font=B$O,this.fillColor=B$J,this.borderColor=B$D,this.lineWidth=B$p,this.scaleX=B$m,this.scaleY=B$C,this.underLine=B$i;var B$k=B$O.toString()+B$m+B$C+B$p+(B$J?B$J.toLowerCase():" ")+(B$D?B$D.toLowerCase():" ")+B$i;return this.txtID=B$_._keymap[B$k],this.txtID||(this.txtID=1e-7*++B$_._keymapCount,B$_._keymap[B$k]=this.txtID),this},B$_.clear=function(){B$_._keymap={},B$_._keymapCount=1},B$_._keymap={},B$_._keymapCount=1,B$_}()},B$E}(),B$XO=function(){function B$m(B$O){this._index=0,this._size=14,this._italic=-2,B$m._cache2=B$m._cache2||[],this.setFont(B$O||"14px Arial")}B$Y(B$m,"laya.webgl.text.FontInContext");var B$O=B$m.prototype;return B$O.setFont=function(B$O){var B$J=B$m._cache2[B$O];if(B$J)this._words=B$J[0],this._size=B$J[1];else{this._words=B$O.split(" ");for(var B$D=0,B$p=this._words.length;B$D<B$p;B$D++)if(0<this._words[B$D].indexOf("px")){this._index=B$D;break}this._size=parseInt(this._words[this._index]),B$m._cache2[B$O]=[this._words,this._size]}this._text=null,this._italic=-2},B$O.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},B$O.hasType=function(B$O){for(var B$J=0,B$D=this._words.length;B$J<B$D;B$J++)if(this._words[B$J]===B$O)return B$J;return-1},B$O.removeType=function(B$O){for(var B$J=0,B$D=this._words.length;B$J<B$D;B$J++)if(this._words[B$J]===B$O){this._words.splice(B$J,1),this._index>B$J&&this._index--;break}this._text=null,this._italic=-2},B$O.copyTo=function(B$O){return B$O._text=this._text,B$O._size=this._size,B$O._index=this._index,B$O._words=this._words.slice(),B$O._italic=-2,B$O},B$O.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},B$p(0,B$O,"size",function(){return this._size},function(B$O){this._size=B$O,this._words[this._index]=B$O+"px",this._text=null}),B$m.create=function(B$O){var B$J=B$m._cache[B$O];return B$J||(B$J=B$m._cache[B$O]=new B$m(B$O))},B$m.EMPTY=new B$m,B$m._cache={},B$m._cache2=null,B$m}(),B$cO=function(){function B$O(){}return B$Y(B$O,"laya.webgl.utils.CONST3D2D"),B$O.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B$O.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],B$O.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],B$O._TMPARRAY=[],B$O._OFFSETX=0,B$O._OFFSETY=0,B$i(B$O,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),B$O}(),B$hO=function(){function B$X(){}return B$Y(B$X,"laya.webgl.utils.GlUtils"),B$X.make2DProjection=function(B$O,B$J,B$D){return[2/B$O,0,0,0,0,-2/B$J,0,0,0,0,2/B$D,0,-1,1,0,1]},B$X.fillIBQuadrangle=function(B$O,B$J){if(65535/4<B$J)throw Error("IBQuadrangle count:"+B$J+" must<:"+Math.floor(65535/4));B$J=Math.floor(B$J),B$O._resizeBuffer(6*(B$J+1)*2,!1),B$O.byteLength=B$O.bufferLength;for(var B$D=B$O.getUint16Array(),B$p=0,B$m=0;B$m<B$J;B$m++)B$D[B$p++]=4*B$m,B$D[B$p++]=4*B$m+2,B$D[B$p++]=4*B$m+1,B$D[B$p++]=4*B$m,B$D[B$p++]=4*B$m+3,B$D[B$p++]=4*B$m+2;return B$O.setNeedUpload(),!0},B$X.expandIBQuadrangle=function(B$O,B$J){B$O.bufferLength>=6*B$J*2||B$X.fillIBQuadrangle(B$O,B$J)},B$X.mathCeilPowerOfTwo=function(B$O){return B$O--,B$O|=B$O>>1,B$O|=B$O>>2,B$O|=B$O>>4,B$O|=B$O>>8,B$O|=B$O>>16,++B$O},B$X.fillQuadrangleImgVb=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=16+(B$O._byteLength>>2);B$O.byteLength=B$_<<2;var B$L=B$O.getFloat32Array();B$L[(B$_-=16)+2]=B$m[0],B$L[B$_+3]=B$m[1],B$L[B$_+6]=B$m[2],B$L[B$_+7]=B$m[3],B$L[B$_+10]=B$m[4],B$L[B$_+11]=B$m[5],B$L[B$_+14]=B$m[6],B$L[B$_+15]=B$m[7];var B$r=B$C.a,B$H=B$C.b,B$Y=B$C.c,B$G=B$C.d;if(1!==B$r||0!==B$H||0!==B$Y||1!==B$G){B$C.bTransform=!0;var B$X=B$C.tx+B$i,B$c=B$C.ty+B$k;B$L[B$_]=(B$p[0]+B$J)*B$r+(B$p[1]+B$D)*B$Y+B$X,B$L[B$_+1]=(B$p[0]+B$J)*B$H+(B$p[1]+B$D)*B$G+B$c,B$L[B$_+4]=(B$p[2]+B$J)*B$r+(B$p[3]+B$D)*B$Y+B$X,B$L[B$_+5]=(B$p[2]+B$J)*B$H+(B$p[3]+B$D)*B$G+B$c,B$L[B$_+8]=(B$p[4]+B$J)*B$r+(B$p[5]+B$D)*B$Y+B$X,B$L[B$_+9]=(B$p[4]+B$J)*B$H+(B$p[5]+B$D)*B$G+B$c,B$L[B$_+12]=(B$p[6]+B$J)*B$r+(B$p[7]+B$D)*B$Y+B$X,B$L[B$_+13]=(B$p[6]+B$J)*B$H+(B$p[7]+B$D)*B$G+B$c}else B$C.bTransform=!1,B$J+=B$C.tx+B$i,B$D+=B$C.ty+B$k,B$L[B$_]=B$J+B$p[0],B$L[B$_+1]=B$D+B$p[1],B$L[B$_+4]=B$J+B$p[2],B$L[B$_+5]=B$D+B$p[3],B$L[B$_+8]=B$J+B$p[4],B$L[B$_+9]=B$D+B$p[5],B$L[B$_+12]=B$J+B$p[6],B$L[B$_+13]=B$D+B$p[7];return B$O._upload=!0},B$X.fillTranglesVB=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k=(B$O._byteLength>>2)+B$p.length;B$O.byteLength=B$k<<2;var B$_=B$O.getFloat32Array();B$k-=B$p.length;for(var B$L=B$p.length,B$r=B$m.a,B$H=B$m.b,B$Y=B$m.c,B$G=B$m.d,B$X=0;B$X<B$L;B$X+=4)if(B$_[B$k+B$X+2]=B$p[B$X+2],B$_[B$k+B$X+3]=B$p[B$X+3],1!==B$r||0!==B$H||0!==B$Y||1!==B$G){B$m.bTransform=!0;var B$c=B$m.tx+B$C,B$h=B$m.ty+B$i;B$_[B$k+B$X]=(B$p[B$X]+B$J)*B$r+(B$p[B$X+1]+B$D)*B$Y+B$c,B$_[B$k+B$X+1]=(B$p[B$X]+B$J)*B$H+(B$p[B$X+1]+B$D)*B$G+B$h}else B$m.bTransform=!1,B$J+=B$m.tx+B$C,B$D+=B$m.ty+B$i,B$_[B$k+B$X]=B$J+B$p[B$X],B$_[B$k+B$X+1]=B$D+B$p[B$X+1];return B$O._upload=!0},B$X.copyPreImgVb=function(B$O,B$J,B$D){var B$p=B$O._byteLength>>2;B$O.byteLength=B$p+16<<2;for(var B$m=B$O.getFloat32Array(),B$C=0,B$i=B$p-16;B$C<4;B$C++)B$m[B$p]=B$m[B$i]+B$J,++B$i,B$m[++B$p]=B$m[B$i]+B$D,++B$i,B$m[++B$p]=B$m[B$i],++B$i,B$m[++B$p]=B$m[B$i],++B$p,++B$i;B$O._upload=!0},B$X.fillRectImgVb=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y){void 0===B$Y&&(B$Y=!1);var B$G,B$X,B$c,B$h,B$y,B$v,B$A,B$q,B$d,B$M,B$a,B$e,B$t,B$z,B$g,B$s,B$P=1,B$E=B$k.a,B$o=B$k.b,B$W=B$k.c,B$N=B$k.d,B$F=B$J&&B$J.width<99999999;if(1!==B$E||0!==B$o||0!==B$W||1!==B$N?(B$k.bTransform=!0,0===B$o&&0===B$W&&(B$P=23,B$d=B$m+B$D,B$M=B$C+B$p,B$G=B$E*B$D+(B$a=B$k.tx+B$_),B$c=B$E*B$d+B$a,B$X=B$N*B$p+(B$e=B$k.ty+B$L),B$h=B$N*B$M+B$e)):(B$P=23,B$k.bTransform=!1,B$c=(B$G=B$D+B$k.tx+B$_)+B$m,B$h=(B$X=B$p+B$k.ty+B$L)+B$C),B$F&&(B$y=B$J.x,B$v=B$J.y,B$A=B$J.width+B$y,B$q=B$J.height+B$v),1!==B$P){if(Math.min(B$G,B$c)>=B$A)return!1;if(Math.min(B$X,B$h)>=B$q)return!1;if(Math.max(B$c,B$G)<=B$y)return!1;if(Math.max(B$h,B$X)<=B$v)return!1}var B$R=B$O._byteLength>>2;B$O.byteLength=16+B$R<<2;var B$j=B$O.getFloat32Array();switch(B$j[2+B$R]=B$i[0],B$j[3+B$R]=B$i[1],B$j[6+B$R]=B$i[2],B$j[7+B$R]=B$i[3],B$j[10+B$R]=B$i[4],B$j[11+B$R]=B$i[5],B$j[14+B$R]=B$i[6],B$j[15+B$R]=B$i[7],B$P){case 1:B$a=B$k.tx+B$_,B$e=B$k.ty+B$L;var B$u=B$E*B$D,B$l=B$W*B$p,B$$=B$N*B$p,B$x=B$o*B$D,B$V=B$E*(B$d=B$m+B$D),B$T=B$W*(B$M=B$C+B$p),B$I=B$N*B$M,B$w=B$o*B$d;B$Y?(B$t=B$u+B$l+B$a,B$g=Math.round(B$t)-B$t,B$z=B$$+B$x+B$e,B$s=Math.round(B$z)-B$z,B$j[B$R]=B$t+B$g,B$j[1+B$R]=B$z+B$s,B$j[4+B$R]=B$V+B$l+B$a+B$g,B$j[5+B$R]=B$$+B$w+B$e+B$s,B$j[8+B$R]=B$V+B$T+B$a+B$g,B$j[9+B$R]=B$I+B$w+B$e+B$s,B$j[12+B$R]=B$u+B$T+B$a+B$g,B$j[13+B$R]=B$I+B$x+B$e+B$s):(B$j[B$R]=B$u+B$l+B$a,B$j[1+B$R]=B$$+B$x+B$e,B$j[4+B$R]=B$V+B$l+B$a,B$j[5+B$R]=B$$+B$w+B$e,B$j[8+B$R]=B$V+B$T+B$a,B$j[9+B$R]=B$I+B$w+B$e,B$j[12+B$R]=B$u+B$T+B$a,B$j[13+B$R]=B$I+B$x+B$e);break;case 23:B$Y?(B$t=B$G+B$r,B$g=Math.round(B$t)-B$t,B$z=B$X,B$s=Math.round(B$z)-B$z,B$j[B$R]=B$t+B$g,B$j[1+B$R]=B$z+B$s,B$j[4+B$R]=B$c+B$r+B$g,B$j[5+B$R]=B$X+B$s,B$j[8+B$R]=B$c+B$g,B$j[9+B$R]=B$h+B$s,B$j[12+B$R]=B$G+B$g,B$j[13+B$R]=B$h+B$s):(B$j[B$R]=B$G+B$r,B$j[1+B$R]=B$X,B$j[4+B$R]=B$c+B$r,B$j[5+B$R]=B$X,B$j[8+B$R]=B$c,B$j[9+B$R]=B$h,B$j[12+B$R]=B$G,B$j[13+B$R]=B$h)}return B$O._upload=!0},B$X.fillLineVb=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=.5*B$i,B$L=B$X._fillLineArray,B$r=-(B$p-B$C),B$H=B$D-B$m,B$Y=Math.sqrt(B$r*B$r+B$H*B$H);B$r/=B$Y,B$H/=B$Y,B$r*=B$_,B$H*=B$_,B$L[0]=B$D-B$r,B$L[1]=B$p-B$H,B$L[4]=B$D+B$r,B$L[5]=B$p+B$H,B$L[8]=B$m+B$r,B$L[9]=B$C+B$H,B$L[12]=B$m-B$r,B$L[13]=B$C-B$H,B$k&&B$k.transformPointArray(B$L,B$L);var B$G=16+(B$O._byteLength>>2);return B$O.byteLength=B$G<<2,B$O.insertData(B$L,B$G-16),!0},B$X._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B$X}(),B$yO=(function(){function B$_(){}B$Y(B$_,"laya.webgl.utils.MatirxArray"),B$_.ArrayMul=function(B$O,B$J,B$D){if(B$O)if(B$J)for(var B$p=NaN,B$m=NaN,B$C=NaN,B$i=NaN,B$k=0;B$k<4;B$k++)B$p=B$O[B$k],B$m=B$O[B$k+4],B$C=B$O[B$k+8],B$i=B$O[B$k+12],B$D[B$k]=B$p*B$J[0]+B$m*B$J[1]+B$C*B$J[2]+B$i*B$J[3],B$D[B$k+4]=B$p*B$J[4]+B$m*B$J[5]+B$C*B$J[6]+B$i*B$J[7],B$D[B$k+8]=B$p*B$J[8]+B$m*B$J[9]+B$C*B$J[10]+B$i*B$J[11],B$D[B$k+12]=B$p*B$J[12]+B$m*B$J[13]+B$C*B$J[14]+B$i*B$J[15];else B$_.copyArray(B$O,B$D);else B$_.copyArray(B$J,B$D)},B$_.copyArray=function(B$O,B$J){if(B$O&&B$J)for(var B$D=0;B$D<B$O.length;B$D++)B$J[B$D]=B$O[B$D]}}(),function(){function B$J(B$O,B$J,B$D){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=B$O,this._vb=new B$fO(B$O,35048),B$J&&this._vb._resizeBuffer(B$J,!1),this._ib=new B$KO,B$D&&this._ib._resizeBuffer(B$D,!1)}B$Y(B$J,"laya.webgl.utils.Mesh2D");var B$O=B$J.prototype;return B$O.cloneWithNewVB=function(){var B$O=new B$J(this._stride,0,0);return B$O._ib=this._ib,B$O._quadNum=this._quadNum,B$O._attribInfo=this._attribInfo,B$O},B$O.cloneWithNewVBIB=function(){var B$O=new B$J(this._stride,0,0);return B$O._attribInfo=this._attribInfo,B$O},B$O.getVBW=function(){return this._vb.setNeedUpload(),this._vb},B$O.getVBR=function(){return this._vb},B$O.getIBR=function(){return this._ib},B$O.getIBW=function(){return this._ib.setNeedUpload(),this._ib},B$O.createQuadIB=function(B$O){this._quadNum=B$O,this._ib._resizeBuffer(6*B$O*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var B$J=this._ib.getUint16Array(),B$D=0,B$p=0,B$m=0;B$m<B$O;B$m++)B$J[B$D++]=B$p,B$J[B$D++]=B$p+2,B$J[B$D++]=B$p+1,B$J[B$D++]=B$p,B$J[B$D++]=B$p+3,B$J[B$D++]=B$p+2,B$p+=4;this._ib.setNeedUpload()},B$O.setAttributes=function(B$O){if(this._attribInfo=B$O,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},B$O.getEleNum=function(){return this._ib.getBuffer().byteLength/2},B$O.releaseMesh=function(){},B$O.destroy=function(){},B$O.clearVB=function(){this._vb.clear()},B$J._gvaoid=0,B$J}()),B$vO=function(){function B$m(){}return B$Y(B$m,"laya.webgl.utils.RenderState2D"),B$m.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},B$m.mat2MatArray=function(B$O,B$J){var B$D=B$O,B$p=B$J;return B$p[0]=B$D.a,B$p[1]=B$D.b,B$p[2]=B$m.EMPTYMAT4_ARRAY[2],B$p[3]=B$m.EMPTYMAT4_ARRAY[3],B$p[4]=B$D.c,B$p[5]=B$D.d,B$p[6]=B$m.EMPTYMAT4_ARRAY[6],B$p[7]=B$m.EMPTYMAT4_ARRAY[7],B$p[8]=B$m.EMPTYMAT4_ARRAY[8],B$p[9]=B$m.EMPTYMAT4_ARRAY[9],B$p[10]=B$m.EMPTYMAT4_ARRAY[10],B$p[11]=B$m.EMPTYMAT4_ARRAY[11],B$p[12]=B$D.tx,B$p[13]=B$D.ty,B$p[14]=B$m.EMPTYMAT4_ARRAY[14],B$p[15]=B$m.EMPTYMAT4_ARRAY[15],B$J},B$m.restoreTempArray=function(){B$m.TEMPMAT4_ARRAY[0]=1,B$m.TEMPMAT4_ARRAY[1]=0,B$m.TEMPMAT4_ARRAY[4]=0,B$m.TEMPMAT4_ARRAY[5]=1,B$m.TEMPMAT4_ARRAY[12]=0,B$m.TEMPMAT4_ARRAY[13]=0},B$m.clear=function(){B$m.worldScissorTest=!1,B$m.worldShaderDefines=null,B$m.worldFilters=null,B$m.worldAlpha=1,B$m.worldClipRect.x=B$m.worldClipRect.y=0,B$m.worldClipRect.width=B$m.width,B$m.worldClipRect.height=B$m.height,B$m.curRenderTarget=null},B$m._MAXSIZE=99999999,B$m.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B$m.worldMatrix4=B$m.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B$m.worldAlpha=1,B$m.worldScissorTest=!1,B$m.worldFilters=null,B$m.worldShaderDefines=null,B$m.curRenderTarget=null,B$m.width=0,B$m.height=0,B$i(B$m,["worldMatrix",function(){return this.worldMatrix=new B$t},"worldClipRect",function(){return this.worldClipRect=new B$g(0,0,99999999,99999999)}]),B$m}(),B$AO=function(){var B$v,B$D;function B$A(B$O,B$J,B$D,B$p,B$m){var B$C=this;function B$i(B$O){var B$J=[],B$D=new B$v(B$J);return B$C._compileToTree(B$D,B$O.split("\n"),0,B$J,B$m),B$D}var B$k=B$G.now();this._VS=B$i(B$J),this._PS=B$i(B$D),this._nameMap=B$p,2<B$G.now()-B$k&&console.log("ShaderCompile use time:"+(B$G.now()-B$k)+"  size:"+B$J.length+"/"+B$D.length)}B$Y(B$A,"laya.webgl.utils.ShaderCompile");var B$O=B$A.prototype;return B$O._compileToTree=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y=0,B$G=0,B$X=0,B$c=0;for(B$G=B$D;B$G<B$J.length;B$G++)if(!((B$k=B$J[B$G]).length<1)&&0!==(B$Y=B$k.indexOf("//"))){if(0<=B$Y&&(B$k=B$k.substr(0,B$Y)),B$C=B$H||new B$v(B$p),B$H=null,B$C.text=B$k,B$C.noCompile=!0,0<=(B$Y=B$k.indexOf("#"))){for(B$_="#",B$c=B$Y+1,B$X=B$k.length;B$c<B$X;B$c++){var B$h=B$k.charAt(B$c);if(" "===B$h||"\t"===B$h||"\r"===B$h||"\n"===B$h||"?"===B$h)break;B$_+=B$h}switch(B$C.name=B$_){case"#ifdef":case"#ifndef":if(B$C.src=B$k,B$C.noCompile=null!=B$k.match(/[!&|()=<>]/),B$C.noCompile?console.log("function():Boolean{return "+B$k.substr(B$Y+B$C.name.length)+"}"):(B$r=B$k.replace(/^\s*/,"").split(/\s+/),B$C.setCondition(B$r[1],"#ifdef"===B$_?1:2),B$C.text="//"+B$C.text),B$C.setParent(B$O),B$O=B$C,B$m)for(B$r=B$k.substr(B$c).split(B$A._splitToWordExps3),B$c=0;B$c<B$r.length;B$c++)(B$k=B$r[B$c]).length&&(B$m[B$k]=!0);continue;case"#if":if(B$C.src=B$k,B$C.noCompile=!0,B$C.setParent(B$O),B$O=B$C,B$m)for(B$r=B$k.substr(B$c).split(B$A._splitToWordExps3),B$c=0;B$c<B$r.length;B$c++)(B$k=B$r[B$c]).length&&"defined"!=B$k&&(B$m[B$k]=!0);continue;case"#else":B$C.src=B$k,B$i=(B$O=B$O.parent).childs[B$O.childs.length-1],B$C.noCompile=B$i.noCompile,B$C.noCompile||(B$C.condition=B$i.condition,B$C.conditionType=1==B$i.conditionType?2:1,B$C.text="//"+B$C.text+" "+B$i.text+" "+B$C.conditionType),B$C.setParent(B$O),B$O=B$C;continue;case"#endif":B$i=(B$O=B$O.parent).childs[B$O.childs.length-1],B$C.noCompile=B$i.noCompile,B$C.noCompile||(B$C.text="//"+B$C.text),B$C.setParent(B$O);continue;case"#include":B$r=B$A.splitToWords(B$k,null);var B$y=B$A.includes[B$r[1]];if(!B$y)throw"ShaderCompile error no this include file:"+B$r[1];if((B$Y=B$r[0].indexOf("?"))<0){B$C.setParent(B$O),B$k=B$y.getWith("with"==B$r[2]?B$r[3]:null),this._compileToTree(B$C,B$k.split("\n"),0,B$p,B$m),B$C.text="";continue}B$C.setCondition(B$r[0].substr(B$Y+1),1),B$C.text=B$y.getWith("with"==B$r[2]?B$r[3]:null);break;case"#import":B$L=(B$r=B$A.splitToWords(B$k,null))[1],B$p.push({node:B$C,file:B$A.includes[B$L],ofs:B$C.text.length});continue}}else{if((B$i=B$O.childs[B$O.childs.length-1])&&!B$i.name){0<B$p.length&&B$A.splitToWords(B$k,B$i),B$H=B$C,B$i.text+="\n"+B$k;continue}0<B$p.length&&B$A.splitToWords(B$k,B$C)}B$C.setParent(B$O)}},B$O.createShader=function(B$O,B$J,B$D){var B$p={},B$m="";if(B$O)for(var B$C in B$O)B$m+="#define "+B$C+"\n",B$p[B$C]=!0;var B$i=this._VS.toscript(B$p,[]),B$k=this._PS.toscript(B$p,[]);return(B$D||B$BO.create)(B$m+B$i.join("\n"),B$m+B$k.join("\n"),B$J,this._nameMap)},B$A._parseOne=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i={type:B$A.shaderParamsMap[B$D[B$p+1]],name:B$D[B$p+2],size:isNaN(parseInt(B$D[B$p+3]))?1:parseInt(B$D[B$p+3])};return B$C&&("attribute"==B$m?B$O.push(B$i):B$J.push(B$i)),":"==B$D[B$p+3]&&(B$i.type=B$D[B$p+4],B$p+=2),B$p+=2},B$A.addInclude=function(B$O,B$J){if(!B$J||0===B$J.length)throw new Error("add shader include file err:"+B$O);if(B$A.includes[B$O])throw new Error("add shader include file err, has add:"+B$O);B$A.includes[B$O]=new B$D(B$J)},B$A.preGetParams=function(B$O,B$J){var B$D=[B$O,B$J],B$p={},B$m=[],B$C=[],B$i={},B$k=[];B$p.attributes=B$m,B$p.uniforms=B$C,B$p.defines=B$i;for(var B$_=0,B$L=0,B$r=0;B$r<2;B$r++){B$D[B$r]=B$D[B$r].replace(B$A._removeAnnotation,"");var B$H,B$Y=B$D[B$r].match(B$A._reg);for(B$_=0,B$L=B$Y.length;B$_<B$L;B$_++){var B$G=B$Y[B$_];if("attribute"==B$G||"uniform"==B$G)B$_=B$A._parseOne(B$m,B$C,B$Y,B$_,B$G,!0);else{if("#define"==B$G){B$k[B$G=B$Y[++B$_]]=1;continue}if("#ifdef"==B$G){B$i[B$H=B$Y[++B$_]]=B$i[B$H]||[];for(B$_++;B$_<B$L;B$_++)if("attribute"==(B$G=B$Y[B$_])||"uniform"==B$G)B$_=B$A._parseOne(B$m,B$C,B$Y,B$_,B$G,B$k[B$H]);else if("#else"==B$G)for(B$_++;B$_<B$L;B$_++)if("attribute"==(B$G=B$Y[B$_])||"uniform"==B$G)B$_=B$A._parseOne(B$m,B$C,B$Y,B$_,B$G,!B$k[B$H]);else if("#endif"==B$G)break}}}}return B$p},B$A.splitToWords=function(B$O,B$J){for(var B$D,B$p,B$m=[],B$C=-1,B$i=0,B$k=B$O.length;B$i<B$k;B$i++)if(B$D=B$O.charAt(B$i),0<=" \t=+-*/&%!<>()'\",;".indexOf(B$D)){if(0<=B$C&&1<B$i-B$C&&(B$p=B$O.substr(B$C,B$i-B$C),B$m.push(B$p)),'"'==B$D||"'"==B$D){var B$_=B$O.indexOf(B$D,B$i+1);if(B$_<0)throw"Sharder err:"+B$O;B$m.push(B$O.substr(B$i+1,B$_-B$i-1)),B$i=B$_,B$C=-1;continue}"("==B$D&&B$J&&0<B$m.length&&(B$p=B$m[B$m.length-1]+";","vec4;main;".indexOf(B$p)<0&&(B$J.useFuns+=B$p)),B$C=-1}else B$C<0&&(B$C=B$i);return B$C<B$k&&1<B$k-B$C&&(B$p=B$O.substr(B$C,B$k-B$C),B$m.push(B$p)),B$m},B$A.IFDEF_NO=0,B$A.IFDEF_YES=1,B$A.IFDEF_ELSE=2,B$A.IFDEF_PARENT=3,B$A._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),B$A._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),B$A._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),B$A.includes={},B$i(B$A,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),B$A.__init$=function(){B$v=function(){function B$D(B$O){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=B$O}B$Y(B$D,"");var B$O=B$D.prototype;return B$O.setParent=function(B$O){B$O.childs.push(this),this.z=B$O.z+1,this.parent=B$O},B$O.setCondition=function(B$O,B$J){B$O&&(this.conditionType=B$J,B$O=B$O.replace(/(\s*$)/g,""),this.condition=function(){return this[B$O]},this.condition.__condition=B$O)},B$O.toscript=function(B$O,B$J){return this._toscript(B$O,B$J,++B$D.__id)},B$O._toscript=function(B$p,B$m,B$C){if(this.childs.length<1&&!this.text)return B$m;B$m.length;if(this.condition){var B$O=!!this.condition.call(B$p);if(2===this.conditionType&&(B$O=!B$O),!B$O)return B$m}if(this.text&&B$m.push(this.text),0<this.childs.length&&this.childs.forEach(function(B$O,B$J,B$D){B$O._toscript(B$p,B$m,B$C)}),0<this.includefiles.length&&0<this.useFuns.length)for(var B$J,B$D=0,B$i=this.includefiles.length;B$D<B$i;B$D++)this.includefiles[B$D].curUseID!=B$C&&0<(B$J=this.includefiles[B$D].file.getFunsScript(this.useFuns)).length&&(this.includefiles[B$D].curUseID=B$C,B$m[0]=B$J+B$m[0]);return B$m},B$D.__id=1,B$D}(),B$D=function(){function B$O(B$O){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=B$O;for(var B$J=0,B$D=0,B$p=0;!((B$J=B$O.indexOf("#begin",B$J))<0);){for(B$p=B$J+5;!((B$p=B$O.indexOf("#end",B$p))<0)&&"i"===B$O.charAt(B$p+4);)B$p+=5;if(B$p<0)throw"add include err,no #end:"+B$O;B$D=B$O.indexOf("\n",B$J);var B$m=B$A.splitToWords(B$O.substr(B$J,B$D-B$J),null);"code"==B$m[1]?this.codes[B$m[2]]=B$O.substr(B$D+1,B$p-B$D-1):"function"==B$m[1]&&(B$D=B$O.indexOf("function",B$J),B$D+="function".length,this.funs[B$m[3]]=B$O.substr(B$D+1,B$p-B$D-1),this.funnames+=B$m[3]+";"),B$J=B$p+1}}B$Y(B$O,"");var B$J=B$O.prototype;return B$J.getWith=function(B$O){var B$J=B$O?this.codes[B$O]:this.script;if(!B$J)throw"get with error:"+B$O;return B$J},B$J.getFunsScript=function(B$O){var B$J="";for(var B$D in this.funs)0<=B$O.indexOf(B$D+";")&&(B$J+=this.funs[B$D]);return B$J},B$O}()},B$A}(),B$qO=function(){function B$i(){}return B$Y(B$i,"laya.webgl.WebGL"),B$i._uint8ArraySlice=function(){for(var B$O=this.length,B$J=new Uint8Array(this.length),B$D=0;B$D<B$O;B$D++)B$J[B$D]=this[B$D];return B$J},B$i._float32ArraySlice=function(){for(var B$O=this.length,B$J=new Float32Array(this.length),B$D=0;B$D<B$O;B$D++)B$J[B$D]=this[B$D];return B$J},B$i._uint16ArraySlice=function(B$O){var B$J,B$D=arguments,B$p=0,B$m=0;if(0===B$D.length)for(B$p=this.length,B$J=new Uint16Array(B$p),B$m=0;B$m<B$p;B$m++)B$J[B$m]=this[B$m];else if(2===B$D.length){var B$C=B$D[0],B$i=B$D[1];if(B$C<B$i)for(B$p=B$i-B$C,B$J=new Uint16Array(B$p),B$m=B$C;B$m<B$i;B$m++)B$J[B$m-B$C]=this[B$m];else B$J=new Uint16Array(0)}return B$J},B$i.expandContext=function(){var B$O=B$m.prototype,B$J=CanvasRenderingContext2D.prototype;B$J.fillTrangles=B$O.fillTrangles,B$SO.__int__(null),B$J.setIBVB=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){void 0===B$_&&(B$_=0),void 0===B$L&&(B$L=0),null===B$D&&(this._ib=this._ib||B$KO.QuadrangleIB,B$D=this._ib,B$hO.expandIBQuadrangle(B$D,B$p._byteLength/64+8)),this._setIBVB(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L)},B$J.fillTrangles=function(B$O,B$J,B$D,B$p,B$m){this._curMat=this._curMat||B$t.create(),this._vb=this._vb||B$fO.create(),this._ib||(this._ib=B$KO.create(),B$hO.fillIBQuadrangle(this._ib,B$i/4));var B$C=this._vb,B$i=B$p.length>>4;B$hO.fillTranglesVB(B$C,B$J,B$D,B$p,B$m||this._curMat,0,0),B$hO.expandIBQuadrangle(this._ib,B$C._byteLength/64+8);var B$k=new B$eO(1,0);B$k.textureHost=B$O;var B$_=new B$bO("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");B$C._vertType=3,this._setIBVB(B$J,B$D,this._ib,B$C,6*B$i,B$m,B$_,B$k,0,0)}},B$i.enable=function(){if(B$G.__init__(),B$y.isConchApp&&!B$y.isConchWebGL)return B$d.skinAniSprite=function(){return new B$OO},B$i.expandContext(),!1;if(B$d.getWebGLContext=function(B$O){for(var B$J,B$D=["webgl","experimental-webgl","webkit-3d","moz-webgl"],B$p=0;B$p<B$D.length;B$p++){try{B$J=B$O.getContext(B$D[B$p],{stencil:B$a.isStencil,alpha:B$a.isAlpha,antialias:B$a.isAntialias,premultipliedAlpha:B$a.premultipliedAlpha,preserveDrawingBuffer:B$a.preserveDrawingBuffer})}catch(B$O){}if(B$J)return B$J}return null},null==(B$i.mainContext=B$i.mainContext||B$d.getWebGLContext(B$y._mainCanvas)))return!1;if(B$y.isWebGL)return!0;B$c.create=function(B$O,B$J){return new B$OJ(B$O,B$J)},B$h.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){return new B$nO(B$O,B$J,B$D,B$p,B$m,B$C,B$i)},B$y.WebGL=B$i,B$y.isWebGL=!0,B$GO.__init__(),B$d.createRenderSprite=function(B$O,B$J){return new B$tO(B$O,B$J)},B$d.createWebGLContext2D=function(B$O){return new B$aO(B$O)},B$d.changeWebGLSize=function(B$O,B$J){laya.webgl.WebGL.onStageResize(B$O,B$J)},B$d.createGraphics=function(){return new B$MO};var B$O=B$d.createFilterAction;return B$d.createFilterAction=B$O||function(B$O){return new B$zO},B$d.clear=function(B$O){B$vO.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var B$J=B$y.context.ctx,B$D=0==B$J._submits._length||B$a.preserveDrawingBuffer?B$X.create(B$O)._color:B$P._wgColor;B$D&&B$J.clearBG(B$D[0],B$D[1],B$D[2],B$D[3]),B$vO.clear()},B$d.addToAtlas=function(B$O,B$J){void 0===B$J&&(B$J=!1);var B$D=B$O.bitmap;B$y.optimizeTextureMemory(B$O.url,B$O)?B$M.__typeof(B$D,"laya.webgl.resource.IMergeAtlasBitmap")&&B$D.allowMerageInAtlas&&B$D.on("recovered",B$O,B$O.addTextureToAtlas):B$D.enableMerageInAtlas=!1},B$d.isAtlas=function(B$O){return B$O instanceof laya.webgl.atlas.AtlasWebGLCanvas},B$x._enable(),B$d.beginFlush=function(){for(var B$O=B$x.instance,B$J=B$O.getAtlaserCount(),B$D=0;B$D<B$J;B$D++){var B$p=B$O.getAtlaserByIndex(B$D).texture;B$p._flashCacheImageNeedFlush&&B$d.flashFlushImage(B$p)}},B$d.drawToCanvas=function(B$O,B$J,B$D,B$p,B$m,B$C){(B$D<=0||B$p<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),B$D|=0,B$p|=0,B$m|=0,B$C|=0;var B$i=B$jO.create(B$D,B$p,6408,5121,0,!1);B$i.start(),B$i.clear(0,0,0,0),B$y.context.clear(),B$v.renders[B$J]._fun(B$O,B$y.context,B$m,B$vO.height-B$p+B$C),B$y.context.flush(),B$i.end();var B$k=B$i.getData(0,0,B$D,B$p);if(B$i.recycle(),B$k.byteLength==B$D*B$p*4){var B$_=new B$wO;B$_._canvas=B$G.createElement("canvas"),B$_.size(B$D,B$p);var B$L=B$_._canvas.getContext("2d");B$G.canvas.size(B$D,B$p);var B$r=B$G.context,B$H=B$r.createImageData(B$D,B$p);return B$H.data.set(new Uint8ClampedArray(B$k.buffer)),B$_._imgData=B$H,B$r.putImageData(B$H,0,0),B$L.save(),B$L.translate(0,B$p),B$L.scale(1,-1),B$L.drawImage(B$G.canvas.source,0,0),B$L.restore(),B$_}console.log("drawToCanvas error: w:"+B$D+",h:"+B$p+",datalen:"+B$k.byteLength)},B$d.createFilterAction=function(B$O){var B$J;switch(B$O){case 32:B$J=new B$zO}return B$J},B$d.addTextureToAtlas=function(B$O){B$O._uvID++,B$x._atlasRestore++,B$O.bitmap.enableMerageInAtlas&&B$x.instance.addToAtlas(B$O)},B$d.getTexturePixels=function(B$O,B$J,B$D,B$p,B$m){B$y.context.ctx.clear();var B$C=new B$s;B$C.graphics.drawTexture(B$O,-B$J,-B$D);var B$i=B$jO.create(B$p,B$m);B$i.start(),B$i.clear(0,0,0,0),B$C.render(B$y.context,0,0),B$y.context.ctx.flush(),B$i.end();for(var B$k=B$i.getData(0,0,B$p,B$m),B$_=[],B$L=0,B$r=B$m-1;0<=B$r;B$r--)for(var B$H=0;B$H<B$p;B$H++)B$L=4*(B$r*B$p+B$H),B$_.push(B$k[B$L]),B$_.push(B$k[B$L+1]),B$_.push(B$k[B$L+2]),B$_.push(B$k[B$L+3]);return B$_},B$d.skinAniSprite=function(){return new B$OO},B$L.create=function(B$O,B$J){var B$D=new B$wO;return B$D._imgData=B$J,B$D.flipY=!1,B$D},B$e._filterStart=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$O.getValue("bounds"),B$i=B$jO.create(B$C.width,B$C.height);if(B$i.start(),B$i.clear(0,0,0,0),B$O.addValue("src",B$i),B$O.addValue("ScissorTest",B$vO.worldScissorTest),B$vO.worldScissorTest){var B$k=new B$g;B$k.copyFrom(B$D.ctx._clipRect),B$O.addValue("clipRect",B$k),B$vO.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},B$e._filterEnd=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$O.getValue("bounds");B$O.getValue("src").end();var B$i=B$jO.create(B$C.width,B$C.height);B$i.start(),B$i.clear(0,0,0,0),B$O.addValue("out",B$i),B$J._set$P("_filterCache",B$i),B$J._set$P("_isHaveGlowFilter",B$O.getValue("_isHaveGlowFilter"))},B$e._EndTarget=function(B$O,B$J){if(B$O.getValue("src").recycle(),B$O.getValue("out").end(),B$O.getValue("ScissorTest")){B$vO.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),B$J.ctx.save();var B$D=B$O.getValue("clipRect");B$J.ctx.clipRect(B$D.x,B$D.y,B$D.width,B$D.height)}},B$e._useSrc=function(B$O){var B$J=B$O.getValue("out");B$J.end(),(B$J=B$O.getValue("src")).start(),B$J.clear(0,0,0,0)},B$e._endSrc=function(B$O){B$O.getValue("src").end()},B$e._useOut=function(B$O){var B$J=B$O.getValue("src");B$J.end(),(B$J=B$O.getValue("out")).start(),B$J.clear(0,0,0,0)},B$e._endOut=function(B$O){B$O.getValue("out").end()},B$e._recycleScope=function(B$O){B$O.recycle()},B$e._filter=function(B$O,B$J,B$D,B$p){var B$m=this._next;if(B$m){var B$C,B$i,B$k=B$O.filters,B$_=B$k.length;if(1==B$_&&32==B$k[0].type)return B$J.ctx.save(),B$J.ctx.setFilters([B$k[0]]),B$m._fun.call(B$m,B$O,B$J,B$D,B$p),void B$J.ctx.restore();var B$L=B$kO.create(),B$r=B$z.TEMP,B$H=B$J.ctx._getTransformMatrix(),B$Y=B$t.create();B$H.copyTo(B$Y);var B$G=0,B$X=0,B$c=!1,B$h=B$O._$P._filterCache?B$O._$P._filterCache:null;if(!B$h||B$O._repaint){B$c=B$O._isHaveGlowFilter(),B$L.addValue("_isHaveGlowFilter",B$c),B$c&&(B$G=50,B$X=25),(B$i=new B$g).copyFrom(B$O.getSelfBounds()),B$i.x+=B$O.x,B$i.y+=B$O.y,B$i.x-=B$O.pivotX+4,B$i.y-=B$O.pivotY+4;var B$y=B$i.x,B$v=B$i.y;if(B$i.width+=B$G+8,B$i.height+=B$G+8,B$r.x=B$i.x*B$Y.a+B$i.y*B$Y.c,B$r.y=B$i.y*B$Y.d+B$i.x*B$Y.b,B$i.x=B$r.x,B$i.y=B$r.y,B$r.x=B$i.width*B$Y.a+B$i.height*B$Y.c,B$r.y=B$i.height*B$Y.d+B$i.width*B$Y.b,B$i.width=B$r.x,B$i.height=B$r.y,B$i.width<=0||B$i.height<=0)return;B$h&&B$h.recycle(),B$L.addValue("bounds",B$i);var B$A=B$iO.create([B$L,B$O,B$J,0,0],B$e._filterStart);B$J.addRenderObject(B$A),B$J.ctx._renderKey=0,B$J.ctx._shader2D.glTexture=null;var B$q=B$O.x-B$y+B$X,B$d=B$O.y-B$v+B$X;B$m._fun.call(B$m,B$O,B$J,B$q,B$d),B$A=B$iO.create([B$L,B$O,B$J,0,0],B$e._filterEnd),B$J.addRenderObject(B$A);for(var B$M=0;B$M<B$_;B$M++){0!=B$M&&(B$A=B$iO.create([B$L],B$e._useSrc),B$J.addRenderObject(B$A),B$C=B$eO.create(1,0),B$t.TEMP.identity(),B$J.ctx.drawTarget(B$L,0,0,B$i.width,B$i.height,B$t.TEMP,"out",B$C,null,B$T.TOINT.overlay),B$A=B$iO.create([B$L],B$e._useOut),B$J.addRenderObject(B$A)),B$k[B$M].action.apply3d(B$L,B$O,B$J,0,0)}B$A=B$iO.create([B$L,B$J],B$e._EndTarget),B$J.addRenderObject(B$A)}else{if((B$c=!!B$O._$P._isHaveGlowFilter&&B$O._$P._isHaveGlowFilter)&&(B$G=50,B$X=25),(B$i=B$O.getBounds()).width<=0||B$i.height<=0)return;B$i.width+=B$G,B$i.height+=B$G,B$r.x=B$i.x*B$Y.a+B$i.y*B$Y.c,B$r.y=B$i.y*B$Y.d+B$i.x*B$Y.b,B$i.x=B$r.x,B$i.y=B$r.y,B$r.x=B$i.width*B$Y.a+B$i.height*B$Y.c,B$r.y=B$i.height*B$Y.d+B$i.width*B$Y.b,B$i.width=B$r.x,B$i.height=B$r.y,B$L.addValue("out",B$h)}B$D=B$D-B$X-B$O.x,B$p=B$p-B$X-B$O.y,B$r.setTo(B$D,B$p),B$Y.transformPoint(B$r),B$D=B$r.x+B$i.x,B$p=B$r.y+B$i.y,B$C=B$eO.create(1,0),B$t.TEMP.identity(),B$J.ctx.drawTarget(B$L,B$D,B$p,B$i.width,B$i.height,B$t.TEMP,"out",B$C,null,B$T.TOINT.overlay),B$A=B$iO.create([B$L],B$e._recycleScope),B$J.addRenderObject(B$A),B$Y.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=B$i._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=B$i._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=B$i._uint8ArraySlice),!0},B$i.onStageResize=function(B$O,B$J){null!=B$i.mainContext&&(B$i.mainContext.viewport(0,0,B$O,B$J),B$vO.width=B$O,B$vO.height=B$J)},B$i.onInvalidGLRes=function(){B$x.instance.freeAll(),B$q.releaseContentManagers(!0),B$i.doNodeRepaint(B$M.stage),B$i.mainContext.viewport(0,0,B$vO.width,B$vO.height),B$M.stage.event("devicelost")},B$i.doNodeRepaint=function(B$O){0==B$O.numChildren&&B$O.repaint();for(var B$J=0;B$J<B$O.numChildren;B$J++)B$i.doNodeRepaint(B$O.getChildAt(B$J))},B$i.init=function(B$O,B$J,B$D){B$i.mainCanvas=B$O,B$L._createContext=function(B$O){return new B$aO(B$O)},B$wO._createContext=function(B$O){return new B$aO(B$O)};var B$p=laya.webgl.WebGL.mainContext;if(null!=B$p.getShaderPrecisionFormat){var B$m=B$p.getShaderPrecisionFormat(35633,36338),B$C=B$p.getShaderPrecisionFormat(35632,36338);B$i.shaderHighPrecision=!(!B$m.precision||!B$C.precision)}else B$i.shaderHighPrecision=!1;if(B$i.compressAstc=B$p.getExtension("WEBGL_compressed_texture_astc"),B$i.compressAtc=B$p.getExtension("WEBGL_compressed_texture_atc"),B$i.compressEtc=B$p.getExtension("WEBGL_compressed_texture_etc"),B$i.compressEtc1=B$p.getExtension("WEBGL_compressed_texture_etc1"),B$i.compressPvrtc=B$p.getExtension("WEBGL_compressed_texture_pvrtc"),B$i.compressS3tc=B$p.getExtension("WEBGL_compressed_texture_s3tc"),B$i.compressS3tc_srgb=B$p.getExtension("WEBGL_compressed_texture_s3tc_srgb"),B$i.compressAstc=B$i.compressAstc?B$i.compressAstc:{},B$i.compressAtc=B$i.compressAtc?B$i.compressAtc:{},B$i.compressEtc=B$i.compressEtc?B$i.compressEtc:{},B$i.compressEtc1=B$i.compressEtc1?B$i.compressEtc1:{},B$i.compressPvrtc=B$i.compressPvrtc?B$i.compressPvrtc:{},B$i.compressS3tc=B$i.compressS3tc?B$i.compressS3tc:{},B$i.compressS3tc_srgb=B$i.compressS3tc_srgb?B$i.compressS3tc_srgb:{},B$p.deleteTexture1=B$p.deleteTexture,B$p.deleteTexture=function(B$O){B$O==B$dO.curBindTexValue&&(B$dO.curBindTexValue=null),B$p.deleteTexture1(B$O)},B$i.onStageResize(B$J,B$D),null==B$i.mainContext)throw new Error("webGL getContext err!");B$W.__init__(),B$x.__init__(),B$sO.__init__(),B$CO.__init__(),B$aO.__init__(),B$eO.__init__(),B$K.__init__(),B$SO.__int__(B$p),B$T._init_(B$p),B$y.isConchApp&&conch.setOnInvalidGLRes(B$i.onInvalidGLRes)},B$i.mainCanvas=null,B$i.antialias=!0,B$i.shaderHighPrecision=!1,B$i._bg_null=[0,0,0,0],B$i}(),B$dO=function(){function B$p(){}return B$Y(B$p,"laya.webgl.WebGLContext"),B$p.UseProgram=function(B$O){return B$p._useProgram!==B$O&&(B$qO.mainContext.useProgram(B$O),B$p._useProgram=B$O,!0)},B$p.setDepthTest=function(B$O,B$J){B$J!==B$p._depthTest&&((B$p._depthTest=B$J)?B$O.enable(2929):B$O.disable(2929))},B$p.setDepthMask=function(B$O,B$J){B$J!==B$p._depthMask&&(B$p._depthMask=B$J,B$O.depthMask(B$J))},B$p.setDepthFunc=function(B$O,B$J){B$J!==B$p._depthFunc&&(B$p._depthFunc=B$J,B$O.depthFunc(B$J))},B$p.setBlend=function(B$O,B$J){B$J!==B$p._blend&&((B$p._blend=B$J)?B$O.enable(3042):B$O.disable(3042))},B$p.setBlendFunc=function(B$O,B$J,B$D){(B$J!==B$p._sFactor||B$D!==B$p._dFactor)&&(B$p._sFactor=B$J,B$p._dFactor=B$D,B$O.blendFunc(B$J,B$D))},B$p.setCullFace=function(B$O,B$J){B$J!==B$p._cullFace&&((B$p._cullFace=B$J)?B$O.enable(2884):B$O.disable(2884))},B$p.setFrontFace=function(B$O,B$J){B$J!==B$p._frontFace&&(B$p._frontFace=B$J,B$O.frontFace(B$J))},B$p.bindTexture=function(B$O,B$J,B$D){B$O.bindTexture(B$J,B$D),B$p.curBindTexTarget=B$J,B$p.curBindTexValue=B$D},B$p.DEPTH_BUFFER_BIT=256,B$p.STENCIL_BUFFER_BIT=1024,B$p.COLOR_BUFFER_BIT=16384,B$p.POINTS=0,B$p.LINES=1,B$p.LINE_LOOP=2,B$p.LINE_STRIP=3,B$p.TRIANGLES=4,B$p.TRIANGLE_STRIP=5,B$p.TRIANGLE_FAN=6,B$p.ZERO=0,B$p.ONE=1,B$p.SRC_COLOR=768,B$p.ONE_MINUS_SRC_COLOR=769,B$p.SRC_ALPHA=770,B$p.ONE_MINUS_SRC_ALPHA=771,B$p.DST_ALPHA=772,B$p.ONE_MINUS_DST_ALPHA=773,B$p.DST_COLOR=774,B$p.ONE_MINUS_DST_COLOR=775,B$p.SRC_ALPHA_SATURATE=776,B$p.FUNC_ADD=32774,B$p.BLEND_EQUATION=32777,B$p.BLEND_EQUATION_RGB=32777,B$p.BLEND_EQUATION_ALPHA=34877,B$p.FUNC_SUBTRACT=32778,B$p.FUNC_REVERSE_SUBTRACT=32779,B$p.BLEND_DST_RGB=32968,B$p.BLEND_SRC_RGB=32969,B$p.BLEND_DST_ALPHA=32970,B$p.BLEND_SRC_ALPHA=32971,B$p.CONSTANT_COLOR=32769,B$p.ONE_MINUS_CONSTANT_COLOR=32770,B$p.CONSTANT_ALPHA=32771,B$p.ONE_MINUS_CONSTANT_ALPHA=32772,B$p.BLEND_COLOR=32773,B$p.ARRAY_BUFFER=34962,B$p.ELEMENT_ARRAY_BUFFER=34963,B$p.ARRAY_BUFFER_BINDING=34964,B$p.ELEMENT_ARRAY_BUFFER_BINDING=34965,B$p.STREAM_DRAW=35040,B$p.STATIC_DRAW=35044,B$p.DYNAMIC_DRAW=35048,B$p.BUFFER_SIZE=34660,B$p.BUFFER_USAGE=34661,B$p.CURRENT_VERTEX_ATTRIB=34342,B$p.FRONT=1028,B$p.BACK=1029,B$p.CULL_FACE=2884,B$p.FRONT_AND_BACK=1032,B$p.BLEND=3042,B$p.DITHER=3024,B$p.STENCIL_TEST=2960,B$p.DEPTH_TEST=2929,B$p.SCISSOR_TEST=3089,B$p.POLYGON_OFFSET_FILL=32823,B$p.SAMPLE_ALPHA_TO_COVERAGE=32926,B$p.SAMPLE_COVERAGE=32928,B$p.NO_ERROR=0,B$p.INVALID_ENUM=1280,B$p.INVALID_VALUE=1281,B$p.INVALID_OPERATION=1282,B$p.OUT_OF_MEMORY=1285,B$p.CW=2304,B$p.CCW=2305,B$p.LINE_WIDTH=2849,B$p.ALIASED_POINT_SIZE_RANGE=33901,B$p.ALIASED_LINE_WIDTH_RANGE=33902,B$p.CULL_FACE_MODE=2885,B$p.FRONT_FACE=2886,B$p.DEPTH_RANGE=2928,B$p.DEPTH_WRITEMASK=2930,B$p.DEPTH_CLEAR_VALUE=2931,B$p.DEPTH_FUNC=2932,B$p.STENCIL_CLEAR_VALUE=2961,B$p.STENCIL_FUNC=2962,B$p.STENCIL_FAIL=2964,B$p.STENCIL_PASS_DEPTH_FAIL=2965,B$p.STENCIL_PASS_DEPTH_PASS=2966,B$p.STENCIL_REF=2967,B$p.STENCIL_VALUE_MASK=2963,B$p.STENCIL_WRITEMASK=2968,B$p.STENCIL_BACK_FUNC=34816,B$p.STENCIL_BACK_FAIL=34817,B$p.STENCIL_BACK_PASS_DEPTH_FAIL=34818,B$p.STENCIL_BACK_PASS_DEPTH_PASS=34819,B$p.STENCIL_BACK_REF=36003,B$p.STENCIL_BACK_VALUE_MASK=36004,B$p.STENCIL_BACK_WRITEMASK=36005,B$p.VIEWPORT=2978,B$p.SCISSOR_BOX=3088,B$p.COLOR_CLEAR_VALUE=3106,B$p.COLOR_WRITEMASK=3107,B$p.UNPACK_ALIGNMENT=3317,B$p.PACK_ALIGNMENT=3333,B$p.MAX_TEXTURE_SIZE=3379,B$p.MAX_VIEWPORT_DIMS=3386,B$p.SUBPIXEL_BITS=3408,B$p.RED_BITS=3410,B$p.GREEN_BITS=3411,B$p.BLUE_BITS=3412,B$p.ALPHA_BITS=3413,B$p.DEPTH_BITS=3414,B$p.STENCIL_BITS=3415,B$p.POLYGON_OFFSET_UNITS=10752,B$p.POLYGON_OFFSET_FACTOR=32824,B$p.TEXTURE_BINDING_2D=32873,B$p.SAMPLE_BUFFERS=32936,B$p.SAMPLES=32937,B$p.SAMPLE_COVERAGE_VALUE=32938,B$p.SAMPLE_COVERAGE_INVERT=32939,B$p.NUM_COMPRESSED_TEXTURE_FORMATS=34466,B$p.COMPRESSED_TEXTURE_FORMATS=34467,B$p.DONT_CARE=4352,B$p.FASTEST=4353,B$p.NICEST=4354,B$p.GENERATE_MIPMAP_HINT=33170,B$p.BYTE=5120,B$p.UNSIGNED_BYTE=5121,B$p.SHORT=5122,B$p.UNSIGNED_SHORT=5123,B$p.INT=5124,B$p.UNSIGNED_INT=5125,B$p.FLOAT=5126,B$p.DEPTH_COMPONENT=6402,B$p.ALPHA=6406,B$p.RGB=6407,B$p.RGBA=6408,B$p.LUMINANCE=6409,B$p.LUMINANCE_ALPHA=6410,B$p.UNSIGNED_SHORT_4_4_4_4=32819,B$p.UNSIGNED_SHORT_5_5_5_1=32820,B$p.UNSIGNED_SHORT_5_6_5=33635,B$p.FRAGMENT_SHADER=35632,B$p.VERTEX_SHADER=35633,B$p.MAX_VERTEX_ATTRIBS=34921,B$p.MAX_VERTEX_UNIFORM_VECTORS=36347,B$p.MAX_VARYING_VECTORS=36348,B$p.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,B$p.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,B$p.MAX_TEXTURE_IMAGE_UNITS=34930,B$p.MAX_FRAGMENT_UNIFORM_VECTORS=36349,B$p.SHADER_TYPE=35663,B$p.DELETE_STATUS=35712,B$p.LINK_STATUS=35714,B$p.VALIDATE_STATUS=35715,B$p.ATTACHED_SHADERS=35717,B$p.ACTIVE_UNIFORMS=35718,B$p.ACTIVE_ATTRIBUTES=35721,B$p.SHADING_LANGUAGE_VERSION=35724,B$p.CURRENT_PROGRAM=35725,B$p.NEVER=512,B$p.LESS=513,B$p.EQUAL=514,B$p.LEQUAL=515,B$p.GREATER=516,B$p.NOTEQUAL=517,B$p.GEQUAL=518,B$p.ALWAYS=519,B$p.KEEP=7680,B$p.REPLACE=7681,B$p.INCR=7682,B$p.DECR=7683,B$p.INVERT=5386,B$p.INCR_WRAP=34055,B$p.DECR_WRAP=34056,B$p.VENDOR=7936,B$p.RENDERER=7937,B$p.VERSION=7938,B$p.NEAREST=9728,B$p.LINEAR=9729,B$p.NEAREST_MIPMAP_NEAREST=9984,B$p.LINEAR_MIPMAP_NEAREST=9985,B$p.NEAREST_MIPMAP_LINEAR=9986,B$p.LINEAR_MIPMAP_LINEAR=9987,B$p.TEXTURE_MAG_FILTER=10240,B$p.TEXTURE_MIN_FILTER=10241,B$p.TEXTURE_WRAP_S=10242,B$p.TEXTURE_WRAP_T=10243,B$p.TEXTURE_2D=3553,B$p.TEXTURE=5890,B$p.TEXTURE_CUBE_MAP=34067,B$p.TEXTURE_BINDING_CUBE_MAP=34068,B$p.TEXTURE_CUBE_MAP_POSITIVE_X=34069,B$p.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,B$p.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,B$p.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,B$p.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,B$p.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,B$p.MAX_CUBE_MAP_TEXTURE_SIZE=34076,B$p.TEXTURE0=33984,B$p.TEXTURE1=33985,B$p.TEXTURE2=33986,B$p.TEXTURE3=33987,B$p.TEXTURE4=33988,B$p.TEXTURE5=33989,B$p.TEXTURE6=33990,B$p.TEXTURE7=33991,B$p.TEXTURE8=33992,B$p.TEXTURE9=33993,B$p.TEXTURE10=33994,B$p.TEXTURE11=33995,B$p.TEXTURE12=33996,B$p.TEXTURE13=33997,B$p.TEXTURE14=33998,B$p.TEXTURE15=33999,B$p.TEXTURE16=34e3,B$p.TEXTURE17=34001,B$p.TEXTURE18=34002,B$p.TEXTURE19=34003,B$p.TEXTURE20=34004,B$p.TEXTURE21=34005,B$p.TEXTURE22=34006,B$p.TEXTURE23=34007,B$p.TEXTURE24=34008,B$p.TEXTURE25=34009,B$p.TEXTURE26=34010,B$p.TEXTURE27=34011,B$p.TEXTURE28=34012,B$p.TEXTURE29=34013,B$p.TEXTURE30=34014,B$p.TEXTURE31=34015,B$p.ACTIVE_TEXTURE=34016,B$p.REPEAT=10497,B$p.CLAMP_TO_EDGE=33071,B$p.MIRRORED_REPEAT=33648,B$p.FLOAT_VEC2=35664,B$p.FLOAT_VEC3=35665,B$p.FLOAT_VEC4=35666,B$p.INT_VEC2=35667,B$p.INT_VEC3=35668,B$p.INT_VEC4=35669,B$p.BOOL=35670,B$p.BOOL_VEC2=35671,B$p.BOOL_VEC3=35672,B$p.BOOL_VEC4=35673,B$p.FLOAT_MAT2=35674,B$p.FLOAT_MAT3=35675,B$p.FLOAT_MAT4=35676,B$p.SAMPLER_2D=35678,B$p.SAMPLER_CUBE=35680,B$p.VERTEX_ATTRIB_ARRAY_ENABLED=34338,B$p.VERTEX_ATTRIB_ARRAY_SIZE=34339,B$p.VERTEX_ATTRIB_ARRAY_STRIDE=34340,B$p.VERTEX_ATTRIB_ARRAY_TYPE=34341,B$p.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,B$p.VERTEX_ATTRIB_ARRAY_POINTER=34373,B$p.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,B$p.COMPILE_STATUS=35713,B$p.LOW_FLOAT=36336,B$p.MEDIUM_FLOAT=36337,B$p.HIGH_FLOAT=36338,B$p.LOW_INT=36339,B$p.MEDIUM_INT=36340,B$p.HIGH_INT=36341,B$p.FRAMEBUFFER=36160,B$p.RENDERBUFFER=36161,B$p.RGBA4=32854,B$p.RGB5_A1=32855,B$p.RGB565=36194,B$p.DEPTH_COMPONENT16=33189,B$p.STENCIL_INDEX=6401,B$p.STENCIL_INDEX8=36168,B$p.DEPTH_STENCIL=34041,B$p.RENDERBUFFER_WIDTH=36162,B$p.RENDERBUFFER_HEIGHT=36163,B$p.RENDERBUFFER_INTERNAL_FORMAT=36164,B$p.RENDERBUFFER_RED_SIZE=36176,B$p.RENDERBUFFER_GREEN_SIZE=36177,B$p.RENDERBUFFER_BLUE_SIZE=36178,B$p.RENDERBUFFER_ALPHA_SIZE=36179,B$p.RENDERBUFFER_DEPTH_SIZE=36180,B$p.RENDERBUFFER_STENCIL_SIZE=36181,B$p.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,B$p.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,B$p.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,B$p.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,B$p.COLOR_ATTACHMENT0=36064,B$p.DEPTH_ATTACHMENT=36096,B$p.STENCIL_ATTACHMENT=36128,B$p.DEPTH_STENCIL_ATTACHMENT=33306,B$p.NONE=0,B$p.FRAMEBUFFER_COMPLETE=36053,B$p.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,B$p.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,B$p.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,B$p.FRAMEBUFFER_UNSUPPORTED=36061,B$p.FRAMEBUFFER_BINDING=36006,B$p.RENDERBUFFER_BINDING=36007,B$p.MAX_RENDERBUFFER_SIZE=34024,B$p.INVALID_FRAMEBUFFER_OPERATION=1286,B$p.UNPACK_FLIP_Y_WEBGL=37440,B$p.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,B$p.CONTEXT_LOST_WEBGL=37442,B$p.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,B$p.BROWSER_DEFAULT_WEBGL=37444,B$p._useProgram=null,B$p._depthTest=!0,B$p._depthMask=!0,B$p._blend=!1,B$p._cullFace=!1,B$p.curBindTexTarget=null,B$p.curBindTexValue=null,B$i(B$p,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),B$p}(),B$MO=function(B$O){function B$J(){B$J.__super.call(this)}B$Y(B$J,"laya.webgl.display.GraphicsGL",B$k);var B$D=B$J.prototype;return B$D.setShader=function(B$O){this._saveToCmd(B$y.context._setShader,[B$O])},B$D.setIBVB=function(B$O,B$J,B$D,B$p,B$m,B$C){this._saveToCmd(B$y.context._setIBVB,[B$O,B$J,B$D,B$p,B$m,B$C])},B$D.drawParticle=function(B$O,B$J,B$D){var B$p=B$d.createParticleTemplate2D(B$D);B$p.x=B$O,B$p.y=B$J,this._saveToCmd(B$y.context._drawParticle,[B$p])},B$J}(),B$aO=function(B$O){var B$D;function B$$(B$O){this._x=0,this._y=0,this._id=++B$$._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,B$$.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=B$$.MAXCLIPRECT,this.mOutPoint,this._canvas=B$O,this._canvas._addReference(),B$$._contextcount++,B$y.isFlash?(this._ib=B$KO.create(35044),B$hO.fillIBQuadrangle(this._ib,16)):this._ib=B$KO.QuadrangleIB,this.clear()}B$Y(B$$,"laya.webgl.canvas.WebGLContext2D",B$m);var B$J=B$$.prototype;return B$J.setIsMainContext=function(){this._isMain=!0},B$J.clearBG=function(B$O,B$J,B$D,B$p){var B$m=B$qO.mainContext;B$m.clearColor(B$O,B$J,B$D,B$p),B$m.clear(16384)},B$J._getSubmits=function(){return this._submits},B$J._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var B$O=0,B$J=this._submits._length;B$O<B$J;B$O++)this._submits[B$O].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},B$J.destroy=function(){--B$$._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=B$KO.QuadrangleIB&&this._ib.releaseResource()},B$J.clear=function(){this._submits||(this._other=B$D.DEFAULT,this._curMat=B$t.create(),this._vb=B$fO.create(-1),this._submits=[],this._save=[B$B.Create(this)],this._save.length=10,this._shader2D=new B$K,this._triangleMesh=B$FO.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=B$D.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=B$$.MAXCLIPRECT,this._curSubmit=B$CO.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=B$I.DEFAULT;for(var B$O=0,B$J=this._submits._length;B$O<B$J;B$O++)this._submits[B$O].releaseRender(),this._submits[B$O]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},B$J.size=function(B$O,B$J){if(this._width!=B$O||this._height!=B$J)if(0==B$O||0==B$J){0!=this._vb._byteLength&&(this._width=B$O,this._height=B$J,this._vb.clear(),this._vb.upload());for(var B$D=0,B$p=this._submits._length;B$D<B$p;B$D++)this._submits[B$D].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=B$O,this._height=B$J,this._targets&&this._targets.size(B$O,B$J),this._canvas.memorySize-=this._canvas.memorySize;0===B$O&&0===B$J&&this._releaseMem()},B$J._getTransformMatrix=function(){return this._curMat},B$J.translate=function(B$O,B$J){0===B$O&&0===B$J||(B$Q.save(this),this._curMat.bTransform&&(B$S.save(this),this._curMat.transformPointN(B$z.TEMP.setTo(B$O,B$J)),B$O=B$z.TEMP.x,B$J=B$z.TEMP.y),this._x+=B$O,this._y+=B$J)},B$J.save=function(){this._save[this._save._length++]=B$B.Create(this)},B$J.restore=function(){var B$O=this._save._length;if(!(B$O<1))for(var B$J=B$O-1;0<=B$J;B$J--){var B$D=this._save[B$J];if(B$D.restore(this),B$D.isSaveMark())return void(this._save._length=B$J)}},B$J._fillText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){void 0===B$L&&(B$L=0);var B$r=this._shader2D,B$H=this._curSubmit.shaderValue,B$Y=B$m?B$XO.create(B$m):this._other.font;if(B$x.enabled)B$r.ALPHA!==B$H.ALPHA&&(B$r.glTexture=null),B$GO.drawText(this,B$O,B$J,this._curMat,B$Y,B$_||this._other.textAlign,B$C,B$i,B$k,B$D,B$p,B$L);else{this._shader2D.defines.getValue();var B$G=B$C?B$X.create(B$C)._color:B$r.colorAdd;B$r.ALPHA===B$H.ALPHA&&B$G===B$r.colorAdd&&B$H.colorAdd===B$r.colorAdd||(B$r.glTexture=null,B$r.colorAdd=B$G),B$GO.drawText(this,B$O,B$J,this._curMat,B$Y,B$_||this._other.textAlign,B$C,B$i,B$k,B$D,B$p,B$L)}},B$J.fillWords=function(B$O,B$J,B$D,B$p,B$m,B$C){this._fillText(null,B$O,B$J,B$D,B$p,B$m,null,-1,null,B$C)},B$J.fillBorderWords=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._fillBorderText(null,B$O,B$J,B$D,B$p,B$m,B$C,B$i,null)},B$J.fillText=function(B$O,B$J,B$D,B$p,B$m,B$C){this._fillText(B$O,null,B$J,B$D,B$p,B$m,null,-1,B$C)},B$J.strokeText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._fillText(B$O,null,B$J,B$D,B$p,null,B$m,B$C||1,B$i)},B$J.fillBorderText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){this._fillBorderText(B$O,null,B$J,B$D,B$p,B$m,B$C,B$i,B$k)},B$J._fillBorderText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){if(!B$x.enabled)return this._fillText(B$O,B$J,B$D,B$p,B$m,null,B$i,B$k||1,B$_),void this._fillText(B$O,B$J,B$D,B$p,B$m,B$C,null,-1,B$_);var B$L=this._shader2D,B$r=this._curSubmit.shaderValue;B$L.ALPHA!==B$r.ALPHA&&(B$L.glTexture=null);var B$H=B$m?(B$$._fontTemp.setFont(B$m),B$$._fontTemp):this._other.font;B$GO.drawText(this,B$O,B$J,this._curMat,B$H,B$_||this._other.textAlign,B$C,B$i,B$k||1,B$D,B$p,0)},B$J.fillRect=function(B$O,B$J,B$D,B$p,B$m){var B$C=this._vb;if(B$hO.fillRectImgVb(B$C,this._clipRect,B$O,B$J,B$D,B$p,B$F.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var B$i=this._shader2D.fillStyle;B$m&&(this._shader2D.fillStyle=B$I.create(B$m));var B$k=this._shader2D,B$_=this._curSubmit.shaderValue;if(B$k.fillStyle!==B$_.fillStyle||B$k.ALPHA!==B$_.ALPHA){B$k.glTexture=null;var B$L=this._curSubmit=B$CO.createSubmit(this,this._ib,B$C,(B$C._byteLength-64)/32*3,B$eO.create(2,0));B$L.shaderValue.color=B$k.fillStyle._color._color,B$L.shaderValue.ALPHA=B$k.ALPHA,this._submits[this._submits._length++]=B$L}this._curSubmit._numEle+=6,this._shader2D.fillStyle=B$i}},B$J.fillTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){if(B$O.loaded&&B$O.bitmap&&B$O.source){var B$_=this._vb,B$L=B$O.bitmap.width,B$r=B$O.bitmap.height,B$H=B$O.uv,B$Y=B$i.x%B$O.width,B$G=B$i.y%B$O.height;if(B$L!=B$k.w||B$r!=B$k.h){if(!B$k.w&&!B$k.h)switch(B$k.oy=B$k.ox=0,B$C){case"repeat":B$k.width=B$p,B$k.height=B$m;break;case"repeat-x":B$k.width=B$p,B$G<0?B$O.height+B$G>B$m?B$k.height=B$m:B$k.height=B$O.height+B$G:(B$k.oy=B$G,B$O.height+B$G>B$m?B$k.height=B$m-B$G:B$k.height=B$O.height);break;case"repeat-y":B$Y<0?B$O.width+B$Y>B$p?B$k.width=B$p:B$k.width=B$O.width+B$Y:(B$k.ox=B$Y,B$O.width+B$Y>B$p?B$k.width=B$p-B$Y:B$k.width=B$O.width),B$k.height=B$m;break;case"no-repeat":B$Y<0?B$O.width+B$Y>B$p?B$k.width=B$p:B$k.width=B$O.width+B$Y:(B$k.ox=B$Y,B$O.width+B$Y>B$p?B$k.width=B$p-B$Y:B$k.width=B$O.width),B$G<0?B$O.height+B$G>B$m?B$k.height=B$m:B$k.height=B$O.height+B$G:(B$k.oy=B$G,B$O.height+B$G>B$m?B$k.height=B$m-B$G:B$k.height=B$O.height);break;default:B$k.width=B$p,B$k.height=B$m}B$k.w=B$L,B$k.h=B$r,B$k.uv=[0,0,B$k.width/B$L,0,B$k.width/B$L,B$k.height/B$r,0,B$k.height/B$r]}if(B$J+=B$k.ox,B$D+=B$k.oy,B$Y-=B$k.ox,B$G-=B$k.oy,B$hO.fillRectImgVb(B$_,this._clipRect,B$J,B$D,B$k.width,B$k.height,B$k.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var B$X=B$NO.create(this,this._ib,B$_,(B$_._byteLength-64)/32*3,B$eO.create(256,0)),B$c=(this._submits[this._submits._length++]=B$X).shaderValue;B$c.textureHost=B$O;var B$h=B$H[0]*B$L,B$y=B$H[1]*B$r,B$v=(B$H[2]-B$H[0])*B$L,B$A=(B$H[5]-B$H[3])*B$r,B$q=-B$Y/B$L,B$d=-B$G/B$r;B$c.u_TexRange[0]=B$h/B$L,B$c.u_TexRange[1]=B$v/B$L,B$c.u_TexRange[2]=B$y/B$r,B$c.u_TexRange[3]=B$A/B$r,B$c.u_offset[0]=B$q,B$c.u_offset[1]=B$d,B$x.enabled&&!this._isMain&&B$X.addTexture(B$O,(B$_._byteLength>>2)-16),(this._curSubmit=B$X)._renderType=10017,B$X._numEle+=6}}else this.sprite&&B$M.timer.callLater(this,this._repaintSprite)},B$J.setShader=function(B$O){B$U.save(this,1048576,this._shader2D,!0),this._shader2D.shader=B$O},B$J.setFilters=function(B$O){B$U.save(this,2097152,this._shader2D,!0),this._shader2D.filters=B$O,this._curSubmit=B$CO.RENDERBASE,this._renderKey=0,this._drawCount++},B$J.drawTexture=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._drawTextureM(B$O,B$J,B$D,B$p,B$m,B$C,B$i,null,1)},B$J.addTextureVb=function(B$O,B$J,B$D){var B$p=this._curSubmit._vb||this._vb,B$m=B$p._byteLength>>2;B$p.byteLength=B$m+16<<2;for(var B$C=B$p.getFloat32Array(),B$i=0;B$i<16;B$i+=4)B$C[B$m++]=B$O[B$i]+B$J,B$C[B$m++]=B$O[B$i+1]+B$D,B$C[B$m++]=B$O[B$i+2],B$C[B$m++]=B$O[B$i+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),B$p._upload=!0},B$J.willDrawTexture=function(B$O,B$J){if(!(B$O.loaded&&B$O.bitmap&&B$O.source))return this.sprite&&B$M.timer.callLater(this,this._repaintSprite),0;var B$D=B$O.bitmap,B$p=B$D.id+this._shader2D.ALPHA*B$J+10016;if(B$p==this._renderKey)return B$p;var B$m=this._shader2D,B$C=B$m.ALPHA,B$i=this._curSubmit.shaderValue;B$m.ALPHA*=B$J,this._renderKey=B$p,this._drawCount++,B$m.glTexture=B$D;var B$k=this._vb,B$_=null,B$L=B$k._byteLength/32*3,B$r=B$i.textureHost&&B$i.textureHost==B$O&&B$i.textureHost.alphaTexture==B$O.alphaTexture;return B$_=B$NO.create(this,this._ib,B$k,B$L,B$eO.create(1,0)),(this._submits[this._submits._length++]=B$_).shaderValue.textureHost=B$O,B$_._renderType=10016,B$_._preIsSameTextureShader=10016===this._curSubmit._renderType&&B$m.ALPHA===B$i.ALPHA&&B$r,this._curSubmit=B$_,B$m.ALPHA=B$C,B$p},B$J.drawTextures=function(B$O,B$J,B$D,B$p){if(B$O.loaded&&B$O.bitmap&&B$O.source){var B$m=this._clipRect;if(this._clipRect=B$$.MAXCLIPRECT,this._drawTextureM(B$O,B$J[0],B$J[1],B$O.width,B$O.height,B$D,B$p,null,1)){if(this._clipRect=B$m,B$E.drawCall++,!(B$J.length<4)){for(var B$C=this._curSubmit._vb||this._vb,B$i=this._curMat.a,B$k=this._curMat.d,B$_=2,B$L=B$J.length;B$_<B$L;B$_+=2)B$hO.copyPreImgVb(B$C,(B$J[B$_]-B$J[B$_-2])*B$i,(B$J[B$_+1]-B$J[B$_-1])*B$k),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&B$M.timer.callLater(this,this._repaintSprite)},B$J._drawTextureM=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){if(!B$O.loaded||!B$O.source)return this.sprite&&B$M.timer.callLater(this,this._repaintSprite),!1;var B$L=this._curSubmit._vb||this._vb,B$r=B$O.bitmap;B$J+=B$C,B$D+=B$i,this._drawCount++;var B$H=B$r.id+this._shader2D.ALPHA*B$_+10016;if(B$H!=this._renderKey){this._renderKey=B$H;var B$Y=this._curSubmit.shaderValue,B$G=this._shader2D,B$X=B$G.ALPHA;B$G.ALPHA*=B$_,B$G.glTexture=B$r;var B$c=this._vb,B$h=null,B$y=B$c._byteLength/32*3,B$v=B$Y.textureHost&&B$Y.textureHost==B$O&&B$Y.textureHost.alphaTexture==B$O.alphaTexture;B$h=B$NO.create(this,this._ib,B$c,B$y,B$eO.create(1,0)),(this._submits[this._submits._length++]=B$h).shaderValue.textureHost=B$O,B$h._renderType=10016,B$h._preIsSameTextureShader=10016===this._curSubmit._renderType&&B$G.ALPHA===B$Y.ALPHA&&B$v,this._curSubmit=B$h,B$L=this._curSubmit._vb||this._vb,B$G.ALPHA=B$X}return!!B$hO.fillRectImgVb(B$L,this._clipRect,B$J,B$D,B$p||B$O.width,B$m||B$O.height,B$O.uv,B$k||this._curMat,this._x,this._y,0,0)&&(B$x.enabled&&!this._isMain&&this._curSubmit.addTexture(B$O,(B$L._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},B$J._repaintSprite=function(){this.sprite&&this.sprite.repaint()},B$J._drawText=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){var B$r=B$O.bitmap;this._drawCount++;var B$H=B$r.id+this._shader2D.ALPHA+10016;if(B$H!=this._renderKey){this._renderKey=B$H;var B$Y=this._curSubmit.shaderValue,B$G=this._shader2D;B$G.glTexture=B$r;var B$X=this._vb,B$c=null,B$h=B$X._byteLength/32*3,B$y=B$Y.textureHost&&B$Y.textureHost==B$O&&B$Y.textureHost.alphaTexture==B$O.alphaTexture;(B$c=B$x.enabled?B$NO.create(this,this._ib,B$X,B$h,B$eO.create(1,0)):B$NO.create(this,this._ib,B$X,B$h,B$QO.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&B$G.ALPHA===B$Y.ALPHA&&B$y,(this._submits[this._submits._length++]=B$c).shaderValue.textureHost=B$O,B$c._renderType=10016,this._curSubmit=B$c}B$O.active();var B$v=this._curSubmit._vb||this._vb;B$hO.fillRectImgVb(B$v,this._clipRect,B$J+B$i,B$D+B$k,B$p||B$O.width,B$m||B$O.height,B$O.uv,B$C||this._curMat,this._x,this._y,B$_,B$L,!0)&&(B$x.enabled&&!this._isMain&&this._curSubmit.addTexture(B$O,(B$v._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},B$J.drawTextureWithTransform=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){if(B$C){var B$L=this._curMat,B$r=this._x,B$H=this._y;(0!==B$i||0!==B$k)&&(this._x=B$i*B$L.a+B$k*B$L.c,this._y=B$k*B$L.d+B$i*B$L.b),B$C&&B$L.bTransform?(B$t.mul(B$C,B$L,B$$._tmpMatrix),(B$C=B$$._tmpMatrix)._checkTransform()):(this._x+=B$L.tx,this._y+=B$L.ty),this._drawTextureM(B$O,B$J,B$D,B$p,B$m,0,0,B$C,B$_),this._x=B$r,this._y=B$H}else this._drawTextureM(B$O,B$J,B$D,B$p,B$m,B$i,B$k,null,B$_)},B$J.fillQuadrangle=function(B$O,B$J,B$D,B$p,B$m){var B$C=this._curSubmit,B$i=this._vb,B$k=this._shader2D,B$_=B$C.shaderValue;if(this._renderKey=0,B$O.bitmap){var B$L=B$O.bitmap;B$k.glTexture==B$L&&B$k.ALPHA===B$_.ALPHA||(B$k.glTexture=B$L,(B$C=this._curSubmit=B$CO.createSubmit(this,this._ib,B$i,B$i._byteLength/32*3,B$eO.create(1,0))).shaderValue.glTexture=B$L,this._submits[this._submits._length++]=B$C),B$hO.fillQuadrangleImgVb(B$i,B$J,B$D,B$p,B$O.uv,B$m||this._curMat,this._x,this._y)}else B$C.shaderValue.fillStyle&&B$C.shaderValue.fillStyle.equal(B$O)&&B$k.ALPHA===B$_.ALPHA||(B$k.glTexture=null,(B$C=this._curSubmit=B$CO.createSubmit(this,this._ib,B$i,B$i._byteLength/32*3,B$eO.create(2,0))).shaderValue.defines.add(2),B$C.shaderValue.fillStyle=B$I.create(B$O),this._submits[this._submits._length++]=B$C),B$hO.fillQuadrangleImgVb(B$i,B$J,B$D,B$p,B$F.DEF_UV,B$m||this._curMat,this._x,this._y);B$C._numEle+=6},B$J.drawTexture2=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){if(0!=B$C){var B$_=this._curMat;if(this._x=B$O*B$_.a+B$J*B$_.c,this._y=B$J*B$_.d+B$O*B$_.b,B$m&&(B$m=B$_.bTransform||B$m.bTransform?(B$t.mul(B$m,B$_,B$$._tmpMatrix),B$$._tmpMatrix):(this._x+=B$m.tx+B$_.tx,this._y+=B$m.ty+B$_.ty,B$t.EMPTY)),1!==B$C||B$i){var B$L=this._shader2D.ALPHA,B$r=this._nBlendType;this._shader2D.ALPHA=B$C,B$i&&(this._nBlendType=B$T.TOINT(B$i)),this._drawTextureM(B$k[0],B$k[1]-B$D,B$k[2]-B$p,B$k[3],B$k[4],0,0,B$m,1),this._shader2D.ALPHA=B$L,this._nBlendType=B$r}else this._drawTextureM(B$k[0],B$k[1]-B$D,B$k[2]-B$p,B$k[3],B$k[4],0,0,B$m,1);this._x=this._y=0}},B$J.drawCanvas=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$O.context;if(this._renderKey=0,B$C._targets)this._submits[this._submits._length++]=B$WO.create(B$C,0,null),this._curSubmit=B$CO.RENDERBASE,B$C._targets.drawTo(this,B$J,B$D,B$p,B$m);else{var B$i=this._submits[this._submits._length++]=B$WO.create(B$C,this._shader2D.ALPHA,this._shader2D.filters),B$k=B$p/B$O.width,B$_=B$m/B$O.height,B$L=B$i._matrix;this._curMat.copyTo(B$L),1!=B$k&&1!=B$_&&B$L.scale(B$k,B$_);var B$r=B$L.tx,B$H=B$L.ty;B$L.tx=B$L.ty=0,B$L.transformPoint(B$z.TEMP.setTo(B$J,B$D)),B$L.translate(B$z.TEMP.x+B$r,B$z.TEMP.y+B$H),this._curSubmit=B$CO.RENDERBASE}B$a.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=B$C._targets?"yellow":"green",this.strokeRect(B$J-1,B$D-1,B$p+2,B$m+2,1),this.strokeRect(B$J,B$D,B$p,B$m,1),this.restore())},B$J.drawTarget=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){void 0===B$L&&(B$L=-1);var B$r=this._vb;if(B$hO.fillRectImgVb(B$r,this._clipRect,B$J,B$D,B$p,B$m,B$_||B$F.DEF_UV,B$C||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var B$H=this._curSubmit=B$HO.create(this,this._ib,B$r,(B$r._byteLength-64)/32*3,B$k,B$i);B$H.blendType=-1==B$L?this._nBlendType:B$L,B$H.scope=B$O,this._submits[this._submits._length++]=B$H,this._curSubmit._numEle+=6}},B$J.mixRGBandAlpha=function(B$O){return this._mixRGBandAlpha(B$O,this._shader2D.ALPHA)},B$J._mixRGBandAlpha=function(B$O,B$J){var B$D=(4278190080&B$O)>>>24;return 0!=B$D?B$D*=B$J:B$D=255*B$J,16777215&B$O|B$D<<24},B$J.drawTriangles=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){if(!B$O.loaded||!B$O.source)return this.sprite&&B$M.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;B$O.bitmap;var B$r=this._mixRGBandAlpha(4294967295,B$k),B$H=(B$p.length,B$C.length);this._renderKey=-1;var B$Y=this._curSubmit=B$NO.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,B$eO.create(1,0));return B$Y.shaderValue.textureHost=B$O,B$Y._renderType=10016,this._submits[this._submits._length++]=B$Y,B$i?(B$$._tmpMatrix.a=B$i.a,B$$._tmpMatrix.b=B$i.b,B$$._tmpMatrix.c=B$i.c,B$$._tmpMatrix.d=B$i.d,B$$._tmpMatrix.tx=B$i.tx+B$J,B$$._tmpMatrix.ty=B$i.ty+B$D,B$t.mul(B$$._tmpMatrix,this._curMat,B$$._tmpMatrix)):(B$$._tmpMatrix.a=this._curMat.a,B$$._tmpMatrix.b=this._curMat.b,B$$._tmpMatrix.c=this._curMat.c,B$$._tmpMatrix.d=this._curMat.d,B$$._tmpMatrix.tx=this._curMat.tx+B$J,B$$._tmpMatrix.ty=this._curMat.ty+B$D),this._triangleMesh.addData(B$p,B$m,B$C,B$$._tmpMatrix,B$r,this),this._curSubmit._numEle+=B$H,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},B$J.transform=function(B$O,B$J,B$D,B$p,B$m,B$C){B$S.save(this),B$t.mul(B$t.TEMP.setTo(B$O,B$J,B$D,B$p,B$m,B$C),this._curMat,this._curMat),this._curMat._checkTransform()},B$J.setTransformByMatrix=function(B$O){B$O.copyTo(this._curMat)},B$J.transformByMatrix=function(B$O){B$S.save(this),B$t.mul(B$O,this._curMat,this._curMat),this._curMat._checkTransform()},B$J.rotate=function(B$O){B$S.save(this),this._curMat.rotateEx(B$O)},B$J.scale=function(B$O,B$J){B$S.save(this),this._curMat.scaleEx(B$O,B$J)},B$J.clipRect=function(B$O,B$J,B$D,B$p){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var B$m=B$rO.create(4);this.addRenderObject(B$m);var B$C=this._vb,B$i=B$C._byteLength>>2;if(B$hO.fillRectImgVb(B$C,null,B$O,B$J,B$D,B$p,B$F.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var B$k=this._curSubmit=B$CO.createSubmit(this,this._ib,B$C,(B$C._byteLength-64)/32*3,B$eO.create(2,0));B$k.shaderValue.ALPHA=1,this._submits[this._submits._length++]=B$k,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var B$_=B$rO.create(5);this.addRenderObject(B$_);var B$L=B$C.getFloat32Array(),B$r=Math.min(Math.min(Math.min(B$L[0+B$i],B$L[4+B$i]),B$L[8+B$i]),B$L[12+B$i]),B$H=Math.max(Math.max(Math.max(B$L[0+B$i],B$L[4+B$i]),B$L[8+B$i]),B$L[12+B$i]),B$Y=Math.min(Math.min(Math.min(B$L[1+B$i],B$L[5+B$i]),B$L[9+B$i]),B$L[13+B$i]),B$G=Math.max(Math.max(Math.max(B$L[1+B$i],B$L[5+B$i]),B$L[9+B$i]),B$L[13+B$i]);B$n.save(this,B$_,B$O,B$J,B$D,B$p,B$r,B$Y,B$H-B$r,B$G-B$Y),this._curSubmit=B$CO.RENDERBASE}else{B$D*=this._curMat.a,B$p*=this._curMat.d;var B$X=B$z.TEMP;this._curMat.transformPoint(B$X.setTo(B$O,B$J)),B$D<0&&(B$X.x=B$X.x+B$D,B$D=-B$D),B$p<0&&(B$X.y=B$X.y+B$p,B$p=-B$p),this._renderKey=0;var B$c=this._curSubmit=B$LO.create(this);(this._submits[this._submits._length++]=B$c).submitIndex=this._submits._length,B$c.submitLength=9999999,B$Z.save(this,B$c);var B$h=this._clipRect,B$y=B$h.x,B$v=B$h.y,B$A=B$X.x+B$D,B$q=B$X.y+B$p;B$y<B$X.x&&(B$h.x=B$X.x),B$v<B$X.y&&(B$h.y=B$X.y),B$h.width=Math.min(B$A,B$y+B$h.width)-B$h.x,B$h.height=Math.min(B$q,B$v+B$h.height)-B$h.y,this._shader2D.glTexture=null,B$c.clipRect.copyFrom(B$h),this._curSubmit=B$CO.RENDERBASE}},B$J.setIBVB=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r){if(void 0===B$_&&(B$_=0),void 0===B$L&&(B$L=0),void 0===B$r&&(B$r=0),null===B$D){if(B$y.isFlash){var B$H=B$p;B$H._selfIB||(B$H._selfIB=B$KO.create(35044)),B$H._selfIB.clear(),B$D=B$H._selfIB}else B$D=this._ib;B$hO.expandIBQuadrangle(B$D,B$p._byteLength/(4*B$p.vertexStride*4))}if(!B$k||!B$i)throw Error("setIBVB must input:shader shaderValues");var B$Y=B$_O.create(this,B$p,B$D,B$m,B$i,B$k,B$_,B$L,B$r);B$C||(B$C=B$t.EMPTY),B$C.translate(B$O,B$J),B$t.mul(B$C,this._curMat,B$Y._mat),B$C.translate(-B$O,-B$J),this._submits[this._submits._length++]=B$Y,this._curSubmit=B$CO.RENDERBASE,this._renderKey=0},B$J.addRenderObject=function(B$O){this._submits[this._submits._length++]=B$O},B$J.fillTrangles=function(B$O,B$J,B$D,B$p,B$m){var B$C=this._curSubmit,B$i=this._vb,B$k=this._shader2D,B$_=B$C.shaderValue,B$L=B$p.length>>4,B$r=B$O.bitmap;this._renderKey=0,B$k.glTexture==B$r&&B$k.ALPHA===B$_.ALPHA||((B$C=this._curSubmit=B$CO.createSubmit(this,this._ib,B$i,B$i._byteLength/32*3,B$eO.create(1,0))).shaderValue.textureHost=B$O,this._submits[this._submits._length++]=B$C),B$hO.fillTranglesVB(B$i,B$J,B$D,B$p,B$m||this._curMat,this._x,this._y),B$C._numEle+=6*B$L},B$J.submitElement=function(B$O,B$J){var B$D=this._submits;for(B$J<0&&(B$J=B$D._length);B$O<B$J;)B$O+=B$D[B$O].renderSubmit()},B$J.finish=function(){B$qO.mainContext.finish()},B$J.flush=function(){var B$O=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(B$O>this._ib.bufferLength/12&&B$hO.expandIBQuadrangle(this._ib,B$O),!this._isMain&&B$x.enabled&&B$x._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=B$x._atlasRestore;for(var B$J=this._submits,B$D=0,B$p=B$J._length;B$D<B$p;B$D++){var B$m=B$J[B$D];10016===B$m.getRenderType()&&B$m.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),B$JO.instance&&B$JO.getInstance().reset();var B$C;for(B$D=0,B$C=this.meshlist.length;B$D<B$C;B$D++){var B$i=this.meshlist[B$D];B$i.canReuse?B$i.releaseMesh():B$i.destroy()}return this.meshlist.length=0,this._curSubmit=B$CO.RENDERBASE,this._renderKey=0,this._triangleMesh=B$FO.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},B$J.setPathId=function(B$O){if(this.mId=B$O,-1!=this.mId){this.mHaveKey=!1;var B$J=B$j.getInstance();B$J.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,B$J.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},B$J.movePath=function(B$O,B$J){var B$D=B$O,B$p=B$J;B$O=this._curMat.a*B$D+this._curMat.c*B$p+this._curMat.tx,B$J=this._curMat.b*B$D+this._curMat.d*B$p+this._curMat.ty,this.mX+=B$O,this.mY+=B$J},B$J.beginPath=function(){var B$O=this._getPath();B$O.tempArray.length=0,B$O.closePath=!1,this.mX=0,this.mY=0},B$J.closePath=function(){this._path.closePath=!0},B$J.fill=function(B$O){void 0===B$O&&(B$O=!1);var B$J=this._getPath();this.drawPoly(0,0,B$J.tempArray,this.fillStyle._color.numColor,0,0,B$O)},B$J.stroke=function(){var B$O=this._getPath();if(0<this.lineWidth){if(-1==this.mId)B$O.drawLine(0,0,B$O.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var B$J=B$j.getInstance().shapeLineDic[this.mId];B$J.rebuild(B$O.tempArray),B$O.setGeomtry(B$J)}else B$j.getInstance().addLine(this.mId,B$O.drawLine(0,0,B$O.tempArray,this.lineWidth,this.strokeStyle._color.numColor));B$O.update();var B$D=[this.mX,this.mY],B$p=B$CO.createShape(this,B$O.ib,B$O.vb,B$O.count,B$O.offset,B$eO.create(4,0));B$p.shaderValue.ALPHA=this._shader2D.ALPHA,B$p.shaderValue.u_pos=B$D,B$p.shaderValue.u_mmat2=B$vO.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=B$p,this._renderKey=-1}},B$J.line=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=this._curSubmit,B$k=this._vb;if(B$hO.fillLineVb(B$k,this._clipRect,B$O,B$J,B$D,B$p,B$m,B$C)){this._renderKey=0;var B$_=this._shader2D,B$L=B$i.shaderValue;B$_.strokeStyle===B$L.strokeStyle&&B$_.ALPHA===B$L.ALPHA||(B$_.glTexture=null,(B$i=this._curSubmit=B$CO.createSubmit(this,this._ib,B$k,(B$k._byteLength-64)/32*3,B$eO.create(2,0))).shaderValue.strokeStyle=B$_.strokeStyle,B$i.shaderValue.mainID=2,B$i.shaderValue.ALPHA=B$_.ALPHA,this._submits[this._submits._length++]=B$i),B$i._numEle+=6}},B$J.moveTo=function(B$O,B$J,B$D){void 0===B$D&&(B$D=!0);var B$p=this._getPath();if(B$D){var B$m=B$O,B$C=B$J;B$O=this._curMat.a*B$m+this._curMat.c*B$C,B$J=this._curMat.b*B$m+this._curMat.d*B$C}B$p.addPoint(B$O,B$J)},B$J.lineTo=function(B$O,B$J,B$D){void 0===B$D&&(B$D=!0);var B$p=this._getPath();if(B$D){var B$m=B$O,B$C=B$J;B$O=this._curMat.a*B$m+this._curMat.c*B$C,B$J=this._curMat.b*B$m+this._curMat.d*B$C}B$p.addPoint(B$O,B$J)},B$J.drawCurves=function(B$O,B$J,B$D){this.setPathId(-1),this.beginPath(),this.strokeStyle=B$D[3],this.lineWidth=B$D[4];var B$p=B$D[2];B$O+=B$D[0],B$J+=B$D[1],this.movePath(B$O,B$J),this.moveTo(B$p[0],B$p[1]);for(var B$m=2,B$C=B$p.length;B$m<B$C;)this.quadraticCurveTo(B$p[B$m++],B$p[B$m++],B$p[B$m++],B$p[B$m++]);this.stroke()},B$J.arcTo=function(B$O,B$J,B$D,B$p,B$m){if(-1==this.mId||!this.mHaveKey){var B$C=0,B$i=0,B$k=0,B$_=this._getPath();this._curMat.copyTo(B$$._tmpMatrix),B$$._tmpMatrix.tx=B$$._tmpMatrix.ty=0,B$$._tempPoint.setTo(B$_.getEndPointX(),B$_.getEndPointY()),B$$._tmpMatrix.invertTransformPoint(B$$._tempPoint);var B$L=B$$._tempPoint.x-B$O,B$r=B$$._tempPoint.y-B$J,B$H=Math.sqrt(B$L*B$L+B$r*B$r);if(!(B$H<=1e-6)){var B$Y=B$L/B$H,B$G=B$r/B$H,B$X=B$D-B$O,B$c=B$p-B$J,B$h=B$X*B$X+B$c*B$c,B$y=Math.sqrt(B$h);if(!(B$y<=1e-6)){var B$v=B$X/B$y,B$A=B$c/B$y,B$q=B$Y+B$v,B$d=B$G+B$A,B$M=Math.sqrt(B$q*B$q+B$d*B$d);if(!(B$M<=1e-6)){var B$a=B$q/B$M,B$e=B$d/B$M,B$t=Math.acos(B$a*B$Y+B$e*B$G),B$z=Math.PI/2-B$t,B$g=(B$H=B$m/Math.tan(B$z))*B$Y+B$O,B$s=B$H*B$G+B$J,B$P=Math.sqrt(B$H*B$H+B$m*B$m),B$E=B$O+B$a*B$P,B$o=B$J+B$e*B$P,B$W=0,B$N=0;if(0<=B$Y*B$A-B$G*B$v){var B$F=2*B$z/B$$.SEGNUM;B$W=Math.sin(B$F),B$N=Math.cos(B$F)}else B$F=2*-B$z/B$$.SEGNUM,B$W=Math.sin(B$F),B$N=Math.cos(B$F);B$i=this._curMat.a*B$g+this._curMat.c*B$s,B$k=this._curMat.b*B$g+this._curMat.d*B$s,B$i==this._path.getEndPointX()&&B$k==this._path.getEndPointY()||B$_.addPoint(B$i,B$k);var B$R=B$g-B$E,B$j=B$s-B$o;for(B$C=0;B$C<B$$.SEGNUM;B$C++){var B$u=B$R*B$N+B$j*B$W,B$l=-B$R*B$W+B$j*B$N;B$i=B$u+B$E,B$k=B$l+B$o,B$O=this._curMat.a*B$i+this._curMat.c*B$k,B$k=B$J=this._curMat.b*B$i+this._curMat.d*B$k,(B$i=B$O)==this._path.getEndPointX()&&B$k==this._path.getEndPointY()||B$_.addPoint(B$i,B$k),B$R=B$u,B$j=B$l}}}}}},B$J.arc=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!0),-1!=this.mId){var B$k=B$j.getInstance().shapeDic[this.mId];if(B$k&&this.mHaveKey&&!B$k.needUpdate(this._curMat))return;B$J=B$O=0}var B$_,B$L=0,B$r=0,B$H=0,B$Y=0,B$G=0,B$X=0,B$c=0;if(B$r=B$m-B$p,B$C)if(Math.abs(B$r)>=2*Math.PI)B$r=2*-Math.PI;else for(;0<B$r;)B$r-=2*Math.PI;else if(Math.abs(B$r)>=2*Math.PI)B$r=2*Math.PI;else for(;B$r<0;)B$r+=2*Math.PI;B$_=B$r/(B$c=B$D<101?Math.max(10,B$r*B$D/5):B$D<201?Math.max(10,B$r*B$D/20):Math.max(10,B$r*B$D/40))/2,B$H=Math.abs(4/3*(1-Math.cos(B$_))/Math.sin(B$_)),B$C&&(B$H=-B$H);var B$h=this._getPath(),B$y=NaN,B$v=NaN;for(B$X=0;B$X<=B$c;B$X++)B$L=B$p+B$r*(B$X/B$c),B$Y=B$O+Math.cos(B$L)*B$D,B$G=B$J+Math.sin(B$L)*B$D,B$i&&(B$y=B$Y,B$v=B$G,B$Y=this._curMat.a*B$y+this._curMat.c*B$v,B$G=this._curMat.b*B$y+this._curMat.d*B$v),B$Y==this._path.getEndPointX()&&B$G==this._path.getEndPointY()||B$h.addPoint(B$Y,B$G);B$Y=B$O+Math.cos(B$m)*B$D,B$G=B$J+Math.sin(B$m)*B$D,B$i&&(B$y=B$Y,B$v=B$G,B$Y=this._curMat.a*B$y+this._curMat.c*B$v,B$G=this._curMat.b*B$y+this._curMat.d*B$v),B$Y==this._path.getEndPointX()&&B$G==this._path.getEndPointY()||B$h.addPoint(B$Y,B$G)},B$J.quadraticCurveTo=function(B$O,B$J,B$D,B$p){var B$m=B$H.I,B$C=B$D,B$i=B$p;B$D=this._curMat.a*B$C+this._curMat.c*B$i,B$p=this._curMat.b*B$C+this._curMat.d*B$i,B$C=B$O,B$i=B$J,B$O=this._curMat.a*B$C+this._curMat.c*B$i,B$J=this._curMat.b*B$C+this._curMat.d*B$i;for(var B$k=B$m.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),B$O,B$J,B$D,B$p],30,2),B$_=0,B$L=B$k.length/2;B$_<B$L;B$_++)this.lineTo(B$k[2*B$_],B$k[2*B$_+1],!1);this.lineTo(B$D,B$p,!1)},B$J.rect=function(B$O,B$J,B$D,B$p){this._other=this._other.make(),this._other.path||(this._other.path=new B$w),this._other.path.rect(B$O,B$J,B$D,B$p)},B$J.strokeRect=function(B$O,B$J,B$D,B$p,B$m){var B$C=.5*B$m;this.line(B$O-B$C,B$J,B$O+B$D+B$C,B$J,B$m,this._curMat),this.line(B$O+B$D,B$J,B$O+B$D,B$J+B$p,B$m,this._curMat),this.line(B$O,B$J,B$O,B$J+B$p,B$m,this._curMat),this.line(B$O-B$C,B$J+B$p,B$O+B$D+B$C,B$J+B$p,B$m,this._curMat)},B$J.clip=function(){},B$J.drawPoly=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){void 0===B$i&&(B$i=!1),this._renderKey=0,this._shader2D.glTexture=null;var B$k=this._getPath();if(-1==this.mId)B$k.polygon(B$O,B$J,B$D,B$p,B$m||1,B$C);else if(this.mHaveKey){var B$_=B$j.getInstance().shapeDic[this.mId];B$_.setMatrix(this._curMat),B$_.rebuild(B$k.tempArray),B$k.setGeomtry(B$_)}else{var B$L=B$k.polygon(B$O,B$J,B$D,B$p,B$m||1,B$C);B$j.getInstance().addShape(this.mId,B$L),B$L.setMatrix(this._curMat)}B$k.update();var B$r,B$H=[this.mX,this.mY];if((B$r=B$CO.createShape(this,B$k.ib,B$k.vb,B$k.count,B$k.offset,B$eO.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,B$r.shaderValue.u_pos=B$H,B$r.shaderValue.u_mmat2=B$vO.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=B$r,0<B$m){if(this.mHaveLineKey){var B$Y=B$j.getInstance().shapeLineDic[this.mId];B$Y.rebuild(B$k.tempArray),B$k.setGeomtry(B$Y)}else B$j.getInstance().addShape(this.mId,B$k.drawLine(B$O,B$J,B$D,B$m,B$C));B$k.update(),(B$r=B$CO.createShape(this,B$k.ib,B$k.vb,B$k.count,B$k.offset,B$eO.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,B$r.shaderValue.u_mmat2=B$vO.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=B$r}},B$J.drawParticle=function(B$O,B$J,B$D){B$D.x=B$O,B$D.y=B$J,this._submits[this._submits._length++]=B$D},B$J._getPath=function(){return this._path||(this._path=new B$w)},B$p(0,B$J,"globalCompositeOperation",function(){return B$T.NAMES[this._nBlendType]},function(B$O){var B$J=B$T.TOINT[B$O];null==B$J||this._nBlendType===B$J||(B$U.save(this,65536,this,!0),this._curSubmit=B$CO.RENDERBASE,this._renderKey=0,this._nBlendType=B$J)}),B$p(0,B$J,"strokeStyle",function(){return this._shader2D.strokeStyle},function(B$O){this._shader2D.strokeStyle.equal(B$O)||(B$U.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=B$I.create(B$O))}),B$p(0,B$J,"globalAlpha",function(){return this._shader2D.ALPHA},function(B$O){(B$O=Math.floor(1e3*B$O)/1e3)!=this._shader2D.ALPHA&&(B$U.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=B$O)}),B$p(0,B$J,"asBitmap",null,function(B$O){if(B$O){if(this._targets||(this._targets=new B$b),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),B$p(0,B$J,"fillStyle",function(){return this._shader2D.fillStyle},function(B$O){this._shader2D.fillStyle.equal(B$O)||(B$U.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=B$I.create(B$O))}),B$p(0,B$J,"textAlign",function(){return this._other.textAlign},function(B$O){this._other.textAlign===B$O||(this._other=this._other.make(),B$U.save(this,32768,this._other,!1),this._other.textAlign=B$O)}),B$p(0,B$J,"lineWidth",function(){return this._other.lineWidth},function(B$O){this._other.lineWidth===B$O||(this._other=this._other.make(),B$U.save(this,256,this._other,!1),this._other.lineWidth=B$O)}),B$p(0,B$J,"textBaseline",function(){return this._other.textBaseline},function(B$O){this._other.textBaseline===B$O||(this._other=this._other.make(),B$U.save(this,16384,this._other,!1),this._other.textBaseline=B$O)}),B$p(0,B$J,"font",null,function(B$O){B$O!=this._other.font.toString()&&(this._other=this._other.make(),B$U.save(this,8,this._other,!1),this._other.font===B$XO.EMPTY?this._other.font=new B$XO(B$O):this._other.font.setFont(B$O))}),B$$.__init__=function(){B$D.DEFAULT=new B$D},B$$._tempPoint=new B$z,B$$._SUBMITVBSIZE=32e3,B$$._MAXSIZE=99999999,B$$._RECTVBSIZE=16,B$$.MAXCLIPRECT=new B$g(0,0,99999999,99999999),B$$._COUNT=0,B$$._tmpMatrix=new B$t,B$$.SEGNUM=32,B$$._contextcount=0,B$i(B$$,["_fontTemp",function(){return this._fontTemp=new B$XO},"_drawStyleTemp",function(){return this._drawStyleTemp=new B$I(null)}]),B$$.__init$=function(){B$D=function(){function B$O(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=B$XO.EMPTY}B$Y(B$O,"");var B$J=B$O.prototype;return B$J.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=B$XO.EMPTY},B$J.make=function(){return this===B$O.DEFAULT?new B$O:this},B$O.DEFAULT=null,B$O}()},B$$}(),B$eO=function(B$O){function B$p(B$O,B$J){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,B$p.__super.call(this),this.defines=new B$sO,this.position=B$p._POSITION,this.mainID=B$O,this.subID=B$J,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=B$O|B$J,this._inClassCache=B$p._cache[this._cacheID],0<B$O&&!this._inClassCache&&(this._inClassCache=B$p._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}B$Y(B$p,"laya.webgl.shader.d2.value.Value2D",B$l);var B$J=B$p.prototype;return B$J.setValue=function(B$O){},B$J.refresh=function(){var B$O=this.size;return B$O[0]=B$vO.width,B$O[1]=B$vO.height,this.alpha=this.ALPHA*B$vO.worldAlpha,this.mmat=B$vO.worldMatrix4,this},B$J._ShaderWithCompile=function(){return B$BO.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,B$bO.create)},B$J._withWorldShaderDefines=function(){var B$O=B$vO.worldShaderDefines,B$J=B$BO.sharders[this.mainID|this.defines._value|B$O.getValue()];if(!B$J){var B$D,B$p={};for(B$D in this.defines.toNameDic())B$p[B$D]="";for(B$D in B$O.toNameDic())B$p[B$D]="";B$J=B$BO.withCompile2D(0,this.mainID,B$p,this.mainID|this.defines._value|B$O.getValue(),B$bO.create)}var B$m=B$vO.worldFilters;if(!B$m)return B$J;for(var B$C,B$i=B$m.length,B$k=0;B$k<B$i;B$k++)(B$C=B$m[B$k])&&B$C.action.setValue(this);return B$J},B$J.upload=function(){var B$O=B$vO;this.alpha=this.ALPHA*B$O.worldAlpha,B$vO.worldMatrix4!==B$vO.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),B$qO.shaderHighPrecision&&this.defines.add(1024);var B$J,B$D=B$O.worldShaderDefines?this._withWorldShaderDefines():B$BO.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=B$O.width,this.size[1]=B$O.height,this.mmat=B$O.worldMatrix4,B$RO.activeShader!==B$D?B$D._shaderValueWidth!==B$O.width||B$D._shaderValueHeight!==B$O.height?(B$D._shaderValueWidth=B$O.width,B$D._shaderValueHeight=B$O.height):B$J=B$D._params2dQuick2||B$D._make2dQuick2():B$D._shaderValueWidth!==B$O.width||B$D._shaderValueHeight!==B$O.height?(B$D._shaderValueWidth=B$O.width,B$D._shaderValueHeight=B$O.height):B$J=B$D._params2dQuick1||B$D._make2dQuick1(),B$D.upload(this,B$J)},B$J.setFilters=function(B$O){if(this.filters=B$O)for(var B$J,B$D=B$O.length,B$p=0;B$p<B$D;B$p++)(B$J=B$O[B$p])&&(this.defines.add(B$J.type),B$J.action.setValue(this))},B$J.clear=function(){this.defines.setValue(this.subID)},B$J.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},B$p._initone=function(B$O,B$J){B$p._typeClass[B$O]=B$J,B$p._cache[B$O]=[],B$p._cache[B$O]._length=0},B$p.__init__=function(){B$p._POSITION=[2,5126,!1,4*B$cO.BYTES_PE,0],B$p._TEXCOORD=[2,5126,!1,4*B$cO.BYTES_PE,2*B$cO.BYTES_PE],B$p._initone(2,B$$O),B$p._initone(4,B$TO),B$p._initone(256,B$xO),B$p._initone(512,B$lO),B$p._initone(1,B$VO),B$p._initone(65,B$QO),B$p._initone(9,B$VO)},B$p.create=function(B$O,B$J){var B$D=B$p._cache[B$O|B$J];return B$D._length?B$D[--B$D._length]:new B$p._typeClass[B$O|B$J](B$J)},B$p._POSITION=null,B$p._TEXCOORD=null,B$p._cache=[],B$p._typeClass=[],B$p.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],B$p}(),B$tO=function(B$O){function B$h(B$O,B$J){B$h.__super.call(this,B$O,B$J)}B$Y(B$h,"laya.webgl.utils.RenderSprite3D",B$v);var B$J=B$h.prototype;return B$J.onCreate=function(B$O){switch(B$O){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},B$J._mask=function(B$O,B$J,B$D,B$p){var B$m,B$C,B$i=this._next,B$k=B$O.mask;if(B$k){B$J.ctx.save();var B$_=B$J.ctx.globalCompositeOperation,B$L=new B$g;if(B$L.copyFrom(B$k.getBounds()),B$L.width=Math.round(B$L.width),B$L.height=Math.round(B$L.height),B$L.x=Math.round(B$L.x),B$L.y=Math.round(B$L.y),0<B$L.width&&0<B$L.height){var B$r=B$O._style._tf,B$H=B$kO.create();B$H.addValue("bounds",B$L),B$m=B$iO.create([B$H,B$J],laya.webgl.utils.RenderSprite3D.tmpTarget),B$J.addRenderObject(B$m),B$k.render(B$J,-B$L.x,-B$L.y),B$m=B$iO.create([B$H],laya.webgl.utils.RenderSprite3D.endTmpTarget),B$J.addRenderObject(B$m),B$J.ctx.save(),B$J.clipRect(B$D-B$r.translateX+B$L.x,B$p-B$r.translateY+B$L.y,B$L.width,B$L.height),B$i._fun.call(B$i,B$O,B$J,B$D,B$p),B$J.ctx.restore(),B$C=B$rO.create(6),B$_=B$J.ctx.globalCompositeOperation,B$C.blendMode="mask",B$J.addRenderObject(B$C),B$t.TEMP.identity();var B$Y=B$eO.create(1,0),B$G=B$F.INV_UV,B$X=B$L.width,B$c=B$L.height;(B$L.width<32||B$L.height<32)&&((B$G=B$h.tempUV)[0]=0,B$G[1]=0,B$G[2]=32<=B$L.width?1:B$L.width/32,B$G[3]=0,B$G[4]=32<=B$L.width?1:B$L.width/32,B$G[5]=32<=B$L.height?1:B$L.height/32,B$G[6]=0,B$G[7]=32<=B$L.height?1:B$L.height/32,B$L.width=32<=B$L.width?B$L.width:32,B$L.height=32<=B$L.height?B$L.height:32,B$G[1]*=-1,B$G[3]*=-1,B$G[5]*=-1,B$G[7]*=-1,B$G[1]+=1,B$G[3]+=1,B$G[5]+=1,B$G[7]+=1),B$J.ctx.drawTarget(B$H,B$D+B$L.x-B$r.translateX,B$p+B$L.y-B$r.translateY,B$X,B$c,B$t.TEMP,"tmpTarget",B$Y,B$G,6),B$m=B$iO.create([B$H],laya.webgl.utils.RenderSprite3D.recycleTarget),B$J.addRenderObject(B$m),(B$C=B$rO.create(6)).blendMode=B$_,B$J.addRenderObject(B$C)}B$J.ctx.restore()}else B$i._fun.call(B$i,B$O,B$J,B$D,B$p)},B$J._blend=function(B$O,B$J,B$D,B$p){var B$m=B$O._style,B$C=this._next;B$m.blendMode?(B$J.ctx.save(),B$J.ctx.globalCompositeOperation=B$m.blendMode,B$C._fun.call(B$C,B$O,B$J,B$D,B$p),B$J.ctx.restore()):B$C._fun.call(B$C,B$O,B$J,B$D,B$p)},B$J._transform=function(B$O,B$J,B$D,B$p){var B$m=B$O.transform,B$C=this._next;if(B$m&&B$C!=B$v.NORENDER){var B$i=B$J.ctx;B$O._style;B$m.tx=B$D,B$m.ty=B$p;var B$k=B$i._getTransformMatrix(),B$_=B$k.clone();B$t.mul(B$m,B$k,B$k),B$k._checkTransform(),B$m.tx=B$m.ty=0,B$C._fun.call(B$C,B$O,B$J,0,0),B$_.copyTo(B$k),B$_.destroy()}else B$C._fun.call(B$C,B$O,B$J,B$D,B$p)},B$h.tmpTarget=function(B$O,B$J){var B$D=B$O.getValue("bounds"),B$p=B$jO.create(B$D.width,B$D.height);B$p.start(),B$p.clear(0,0,0,0),B$O.addValue("tmpTarget",B$p)},B$h.endTmpTarget=function(B$O){B$O.getValue("tmpTarget").end()},B$h.recycleTarget=function(B$O){B$O.getValue("tmpTarget").recycle(),B$O.recycle()},B$i(B$h,["tempUV",function(){return this.tempUV=new Array(8)}]),B$h}(),B$zO=function(B$O){function B$J(){this.data=null,B$J.__super.call(this)}B$Y(B$J,"laya.filters.webgl.ColorFilterActionGL",B$u);var B$D=B$J.prototype;return B$M.imps(B$D,{"laya.filters.IFilterActionGL":!0}),B$D.setValue=function(B$O){B$O.colorMat=this.data._mat,B$O.colorAlpha=this.data._alpha},B$D.apply3d=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$O.getValue("bounds"),B$i=B$eO.create(1,0);B$i.setFilters([this.data]);var B$k=B$t.TEMP;B$k.identity(),B$D.ctx.drawTarget(B$O,0,0,B$C.width,B$C.height,B$k,"src",B$i)},B$J}(),B$gO=function(B$O){function B$C(B$O,B$J,B$D,B$p,B$m){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,B$C.__super.call(this,B$O,B$J,B$m),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new B$IO,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=B$D,this._atlasCanvas.height=B$p,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}B$Y(B$C,"laya.webgl.atlas.Atlaser",B$$);var B$J=B$C.prototype;return B$J.computeUVinAtlasTexture=function(B$O,B$J,B$D,B$p){var B$m=B$x.atlasTextureWidth,B$C=B$x.atlasTextureHeight,B$i=B$D/B$m,B$k=B$p/B$C,B$_=(B$D+B$O.bitmap.width)/B$m,B$L=(B$p+B$O.bitmap.height)/B$C,B$r=B$O.bitmap.width/B$m,B$H=B$O.bitmap.height/B$C;B$O.uv=[B$i+B$J[0]*B$r,B$k+B$J[1]*B$H,B$_-(1-B$J[2])*B$r,B$k+B$J[3]*B$H,B$_-(1-B$J[4])*B$r,B$L-(1-B$J[5])*B$H,B$i+B$J[6]*B$r,B$L-(1-B$J[7])*B$H]},B$J.findBitmapIsExist=function(B$O){if(B$O instanceof laya.webgl.resource.WebGLImage){var B$J=B$O,B$D=B$J.url,B$p=this._InAtlasWebGLImagesKey[B$D||B$J.id];if(B$p)return B$p.offsetInfoID}return-1},B$J.addToAtlasTexture=function(B$O,B$J,B$D){if(B$O instanceof laya.webgl.resource.WebGLImage){var B$p=B$O,B$m=B$p.url;this._InAtlasWebGLImagesKey[B$m||B$p.id]={bitmap:B$O,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([B$J,B$D])}this._atlasCanvas.texSubImage2D(B$J,B$D,B$O.atlasSource),B$O.clearAtlasSource()},B$J.addToAtlas=function(B$O,B$J,B$D){B$O._atlasID=this._inAtlasTextureKey.length;var B$p=B$O.uv.slice(),B$m=B$O.bitmap;this._inAtlasTextureKey.push(B$O),this._inAtlasTextureOriUVValue.push(B$p),this._inAtlasTextureBitmapValue.push(B$m),this.computeUVinAtlasTexture(B$O,B$p,B$J,B$D),B$O.bitmap=this._atlasCanvas},B$J.clear=function(){for(var B$O=0,B$J=this._inAtlasTextureKey.length;B$O<B$J;B$O++)this._inAtlasTextureKey[B$O].bitmap=this._inAtlasTextureBitmapValue[B$O],this._inAtlasTextureKey[B$O].uv=this._inAtlasTextureOriUVValue[B$O],this._inAtlasTextureKey[B$O]._atlasID=-1,this._inAtlasTextureKey[B$O].bitmap.lock=!1,this._inAtlasTextureKey[B$O].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},B$J.dispose=function(){this.clear(),this._atlasCanvas.destroy()},B$p(0,B$J,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),B$p(0,B$J,"texture",function(){return this._atlasCanvas}),B$p(0,B$J,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),B$C}(),B$sO=function(B$O){function B$D(){B$D.__super.call(this,B$D.__name2int,B$D.__int2name,B$D.__int2nameMap)}return B$Y(B$D,"laya.webgl.shader.d2.ShaderDefines2D",B$f),B$D.__init__=function(){B$D.reg("TEXTURE2D",1),B$D.reg("COLOR2D",2),B$D.reg("PRIMITIVE",4),B$D.reg("GLOW_FILTER",8),B$D.reg("BLUR_FILTER",16),B$D.reg("COLOR_FILTER",32),B$D.reg("COLOR_ADD",64),B$D.reg("WORLDMAT",128),B$D.reg("FILLTEXTURE",256),B$D.reg("FSHIGHPRECISION",1024),B$D.reg("TXTALPHA",2048),B$D.reg("TXTCOMPRESS",4096)},B$D.reg=function(B$O,B$J){B$f._reg(B$O,B$J,B$D.__name2int,B$D.__int2name)},B$D.toText=function(B$O,B$J,B$D){return B$f._toText(B$O,B$J,B$D)},B$D.toInt=function(B$O){return B$f._toInt(B$O,B$D.__name2int)},B$D.TEXTURE2D=1,B$D.COLOR2D=2,B$D.PRIMITIVE=4,B$D.FILTERGLOW=8,B$D.FILTERBLUR=16,B$D.FILTERCOLOR=32,B$D.COLORADD=64,B$D.WORLDMAT=128,B$D.FILLTEXTURE=256,B$D.SKINMESH=512,B$D.SHADERDEFINE_FSHIGHPRECISION=1024,B$D.TXTALPHA=2048,B$D.TXTCOMPRESS=4096,B$D.__name2int={},B$D.__int2name=[],B$D.__int2nameMap=[],B$D}(),B$PO=(function(B$O){function B$k(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$k.__super.call(this,B$O,B$J,B$D,B$p,40,B$m,B$C,B$i)}B$Y(B$k,"laya.webgl.shapes.Ellipse",B$DO)}(),function(B$O){function B$C(B$O,B$J,B$D,B$p,B$m){this._points=[],this.rebuild(B$D),B$C.__super.call(this,B$O,B$J,0,0,0,B$m,B$p,B$m,0)}B$Y(B$C,"laya.webgl.shapes.Line",B$DO);var B$J=B$C.prototype;return B$J.rebuild=function(B$O){var B$J=B$O.length;B$J!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(B$J/2-1)),this.mFloat32Array=new Float32Array(5*B$J)),this._points.length=0;for(var B$D=NaN,B$p=NaN,B$m=-1,B$C=-1,B$i=B$O.length/2,B$k=0;B$k<B$i;B$k++)B$D=B$O[2*B$k],B$p=B$O[2*B$k+1],(.01<Math.abs(B$m-B$D)||.01<Math.abs(B$C-B$p))&&this._points.push(B$D,B$p),B$m=B$D,B$C=B$p},B$J.getData=function(B$O,B$J,B$D){var B$p=[],B$m=[];0<this.borderWidth&&this.createLine2(this._points,B$p,this.borderWidth,B$D,B$m,this._points.length/2),this.mUint16Array.set(B$p,0),this.mFloat32Array.set(B$m,0),B$O.append(this.mUint16Array),B$J.append(this.mFloat32Array)},B$C}()),B$EO=function(B$O){function B$H(B$O,B$J,B$D,B$p,B$m){this._points=[];for(var B$C=NaN,B$i=NaN,B$k=-1,B$_=-1,B$L=B$D.length/2-1,B$r=0;B$r<B$L;B$r++)B$C=B$D[2*B$r],B$i=B$D[2*B$r+1],(.01<Math.abs(B$k-B$C)||.01<Math.abs(B$_-B$i))&&this._points.push(B$C,B$i),B$k=B$C,B$_=B$i;B$C=B$D[2*B$L],B$i=B$D[2*B$L+1],B$k=this._points[0],B$_=this._points[1],(.01<Math.abs(B$k-B$C)||.01<Math.abs(B$_-B$i))&&this._points.push(B$C,B$i),B$H.__super.call(this,B$O,B$J,0,0,this._points.length/2,0,B$p,B$m)}B$Y(B$H,"laya.webgl.shapes.LoopLine",B$DO);var B$J=B$H.prototype;return B$J.getData=function(B$O,B$J,B$D){if(0<this.borderWidth){for(var B$p=this.color,B$m=(B$p>>16&255)/255,B$C=(B$p>>8&255)/255,B$i=(255&B$p)/255,B$k=[],B$_=0,B$L=0,B$r=[],B$H=Math.floor(this._points.length/2),B$Y=0;B$Y<B$H;B$Y++)B$_=this._points[2*B$Y],B$L=this._points[2*B$Y+1],B$k.push(this.x+B$_,this.y+B$L,B$m,B$C,B$i);this.createLoopLine(B$k,B$r,this.borderWidth,B$D+B$k.length/5),B$O.append(new Uint16Array(B$r)),B$J.append(new Float32Array(B$k))}},B$J.createLoopLine=function(B$O,B$J,B$D,B$p,B$m,B$C){B$O.length;var B$i=B$O.concat(),B$k=B$m||B$O,B$_=this.borderColor,B$L=(B$_>>16&255)/255,B$r=(B$_>>8&255)/255,B$H=(255&B$_)/255,B$Y=[B$i[0],B$i[1]],B$G=[B$i[B$i.length-5],B$i[B$i.length-4]],B$X=B$G[0]+.5*(B$Y[0]-B$G[0]),B$c=B$G[1]+.5*(B$Y[1]-B$G[1]);B$i.unshift(B$X,B$c,0,0,0),B$i.push(B$X,B$c,0,0,0);var B$h,B$y,B$v,B$A,B$q,B$d,B$M,B$a,B$e,B$t,B$z,B$g,B$s,B$P,B$E,B$o,B$W,B$N,B$F,B$R,B$j=B$i.length/5,B$u=B$p,B$l=B$D/2;B$v=B$i[0],B$A=B$i[1],B$t=B$v-(B$q=B$i[5]),B$e=(B$e=-(B$A-(B$d=B$i[6])))/(B$R=Math.sqrt(B$e*B$e+B$t*B$t))*B$l,B$t=B$t/B$R*B$l,B$k.push(B$v-B$e,B$A-B$t,B$L,B$r,B$H,B$v+B$e,B$A+B$t,B$L,B$r,B$H);for(var B$$=1;B$$<B$j-1;B$$++)B$v=B$i[5*(B$$-1)],B$A=B$i[5*(B$$-1)+1],B$q=B$i[5*B$$],B$d=B$i[5*B$$+1],B$M=B$i[5*(B$$+1)],B$a=B$i[5*(B$$+1)+1],B$t=B$v-B$q,B$g=B$q-B$M,B$E=(-(B$e=(B$e=-(B$A-B$d))/(B$R=Math.sqrt(B$e*B$e+B$t*B$t))*B$l)+B$v)*(-(B$t=B$t/B$R*B$l)+B$d)-(-B$e+B$q)*(-B$t+B$A),B$N=(-(B$z=(B$z=-(B$d-B$a))/(B$R=Math.sqrt(B$z*B$z+B$g*B$g))*B$l)+B$M)*(-(B$g=B$g/B$R*B$l)+B$d)-(-B$z+B$q)*(-B$g+B$a),B$F=(B$s=-B$t+B$A-(-B$t+B$d))*(B$W=-B$z+B$q-(-B$z+B$M))-(B$o=-B$g+B$a-(-B$g+B$d))*(B$P=-B$e+B$q-(-B$e+B$v)),Math.abs(B$F)<.1?(B$F+=10.1,B$k.push(B$q-B$e,B$d-B$t,B$L,B$r,B$H,B$q+B$e,B$d+B$t,B$L,B$r,B$H)):(((B$h=(B$P*B$N-B$W*B$E)/B$F)-B$q)*(B$h-B$q)+((B$y=(B$o*B$E-B$s*B$N)/B$F)-B$d)+(B$y-B$d),B$k.push(B$h,B$y,B$L,B$r,B$H,B$q-(B$h-B$q),B$d-(B$y-B$d),B$L,B$r,B$H));B$C&&(B$J=B$C);var B$x=this.edges+1;for(B$$=1;B$$<B$x;B$$++)B$J.push(B$u+2*(B$$-1),B$u+2*(B$$-1)+1,B$u+2*B$$+1,B$u+2*B$$+1,B$u+2*B$$,B$u+2*(B$$-1));return B$J.push(B$u+2*(B$$-1),B$u+2*(B$$-1)+1,B$u+1,B$u+1,B$u,B$u+2*(B$$-1)),B$k},B$H}(),B$oO=function(B$O){function B$i(B$O,B$J,B$D,B$p,B$m,B$C){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=B$t.create(),this._points=B$D.slice(0,B$D.length),B$i.__super.call(this,B$O,B$J,0,0,this._points.length/2,B$p,B$m,B$C)}B$Y(B$i,"laya.webgl.shapes.Polygon",B$DO);var B$J=B$i.prototype;return B$J.rebuild=function(B$O){this._repaint||(this._points.length=0,this._points=this._points.concat(B$O))},B$J.setMatrix=function(B$O){B$O.copyTo(this._mat)},B$J.needUpdate=function(B$O){return this._repaint=this._mat.a==B$O.a&&this._mat.b==B$O.b&&this._mat.c==B$O.c&&this._mat.d==B$O.d&&this._mat.tx==B$O.tx&&this._mat.ty==B$O.ty,!this._repaint},B$J.getData=function(B$O,B$J,B$D){var B$p,B$m=0,B$C=this._points,B$i=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=B$D){for(this._start=B$D,B$p=[],B$i=this.earcutTriangles.length,B$m=0;B$m<B$i;B$m++)B$p.push(this.earcutTriangles[B$m]+B$D);this.mUint16Array=new Uint16Array(B$p)}}else{this._start=B$D,B$p=[];var B$k=[],B$_=[],B$L=this.color,B$r=(B$L>>16&255)/255,B$H=(B$L>>8&255)/255,B$Y=(255&B$L)/255;for(B$i=Math.floor(B$C.length/2),B$m=0;B$m<B$i;B$m++)B$k.push(this.x+B$C[2*B$m],this.y+B$C[2*B$m+1],B$r,B$H,B$Y),B$_.push(this.x+B$C[2*B$m],this.y+B$C[2*B$m+1]);for(this.earcutTriangles=B$pO.earcut(B$_,null,2),B$i=this.earcutTriangles.length,B$m=0;B$m<B$i;B$m++)B$p.push(this.earcutTriangles[B$m]+B$D);this.mUint16Array=new Uint16Array(B$p),this.mFloat32Array=new Float32Array(B$k)}B$O.append(this.mUint16Array),B$J.append(this.mFloat32Array)},B$i}(),B$WO=function(B$O){function B$C(){this._matrix=new B$t,this._matrix4=B$cO.defaultMatrix4.concat(),B$C.__super.call(this,1e4),this.shaderValue=new B$eO(0,0)}B$Y(B$C,"laya.webgl.submit.SubmitCanvas",B$CO);var B$J=B$C.prototype;return B$J.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var B$O=B$vO.worldAlpha,B$J=B$vO.worldMatrix4,B$D=B$vO.worldMatrix,B$p=B$vO.worldFilters,B$m=B$vO.worldShaderDefines,B$C=this.shaderValue,B$i=this._matrix,B$k=this._matrix4,B$_=B$t.TEMP;return B$t.mul(B$i,B$D,B$_),B$k[0]=B$_.a,B$k[1]=B$_.b,B$k[4]=B$_.c,B$k[5]=B$_.d,B$k[12]=B$_.tx,B$k[13]=B$_.ty,B$vO.worldMatrix=B$_.clone(),B$vO.worldMatrix4=B$k,B$vO.worldAlpha=B$vO.worldAlpha*B$C.alpha,B$C.filters&&B$C.filters.length&&(B$vO.worldFilters=B$C.filters,B$vO.worldShaderDefines=B$C.defines),this._ctx_src.flush(),B$vO.worldAlpha=B$O,B$vO.worldMatrix4=B$J,B$vO.worldMatrix.destroy(),B$vO.worldMatrix=B$D,B$vO.worldFilters=B$p,B$vO.worldShaderDefines=B$m,1},B$J.releaseRender=function(){var B$O=B$C._cache;this._ctx_src=null,B$O[B$O._length++]=this},B$J.getRenderType=function(){return 10003},B$C.create=function(B$O,B$J,B$D){var B$p=B$C._cache._length?B$C._cache[--B$C._cache._length]:new B$C;B$p._ctx_src=B$O;var B$m=B$p.shaderValue;return B$m.alpha=B$J,B$m.defines.setValue(0),B$D&&B$D.length&&B$m.setFilters(B$D),B$p},B$C._cache=((B$C._cache=[])._length=0,B$C._cache),B$C}(),B$NO=function(B$O){function B$L(B$O){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===B$O&&(B$O=1e4),B$L.__super.call(this,B$O)}B$Y(B$L,"laya.webgl.submit.SubmitTexture",B$CO);var B$J=B$L.prototype;return B$J.releaseRender=function(){var B$O=B$L._cache;(B$O[B$O._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},B$J.addTexture=function(B$O,B$J){this._texsID[this._texs.length]=B$O._uvID,this._texs.push(B$O),this._vbPos.push(B$J)},B$J.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var B$O=this.shaderValue.textureHost.bitmap;if(null!==B$O)for(var B$J=this._vb.getFloat32Array(),B$D=0,B$p=this._texs.length;B$D<B$p;B$D++){var B$m=this._texs[B$D];B$m.active();var B$C=B$m.uv;if(this._texsID[B$D]!==B$m._uvID){this._texsID[B$D]=B$m._uvID;var B$i=this._vbPos[B$D];B$J[B$i+2]=B$C[0],B$J[B$i+3]=B$C[1],B$J[B$i+6]=B$C[2],B$J[B$i+7]=B$C[3],B$J[B$i+10]=B$C[4],B$J[B$i+11]=B$C[5],B$J[B$i+14]=B$C[6],B$J[B$i+15]=B$C[7],this._vb.setNeedUpload()}B$m.bitmap!==B$O&&(this._isSameTexture=!1)}}},B$J.renderSubmit=function(){if(0===this._numEle)return B$L._shaderSet=!1,1;var B$O=this.shaderValue.textureHost;if(B$O){var B$J=B$O.source;if(!B$O.bitmap||!B$J)return B$L._shaderSet=!1,1;this.shaderValue.texture=B$J,B$O.alphaTexture&&B$O.alphaTexture.source&&(this.shaderValue.texture1=B$O.alphaTexture.source)}this._vb.bind_upload(this._ib);var B$D=B$qO.mainContext;if(B$T.activeBlendFunction!==this._blendFn&&(B$D.enable(3042),this._blendFn(B$D),B$T.activeBlendFunction=this._blendFn),B$E.drawCall++,B$E.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&B$RO.activeShader&&B$L._shaderSet?(B$RO.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&B$RO.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),B$L._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var B$p=B$O.bitmap,B$m=0,B$C=B$RO.activeShader,B$i=0,B$k=this._texs.length;B$i<B$k;B$i++){var B$_=this._texs[B$i];B$_.bitmap===B$p&&B$i+1!==B$k||(B$C.uploadTexture2D(B$_.source),B$D.drawElements(4,6*(B$i-B$m+1),5123,this._startIdx+6*B$m*B$cO.BYTES_PIDX),B$p=B$_.bitmap,B$m=B$i)}else B$D.drawElements(4,this._numEle,5123,this._startIdx);return 1},B$L.create=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$L._cache._length?B$L._cache[--B$L._cache._length]:new B$L;null==B$D&&((B$D=B$C._selfVb||(B$C._selfVb=B$fO.create(-1))).clear(),B$p=0),B$C._ib=B$J,B$C._vb=B$D,B$C._startIdx=B$p*B$cO.BYTES_PIDX,B$C._numEle=0;var B$i=B$O._nBlendType;B$C._blendFn=B$O._targets?B$T.targetFns[B$i]:B$T.fns[B$i],B$C.shaderValue=B$m,B$C.shaderValue.setValue(B$O._shader2D);var B$k=B$O._shader2D.filters;return B$k&&B$C.shaderValue.setFilters(B$k),B$C},B$L._cache=((B$L._cache=[])._length=0,B$L._cache),B$L._shaderSet=!0,B$L}(),B$FO=function(B$O){function B$y(){B$y.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}B$Y(B$y,"laya.webgl.utils.MeshTexture",B$yO);var B$J=B$y.prototype;return B$J.addData=function(B$O,B$J,B$D,B$p,B$m,B$C){for(var B$i=B$O.length/2,B$k=this._vb.needSize(B$i*B$y.const_stride)>>2,B$_=this._vb.getFloat32Array(),B$L=0,B$r=0;B$r<B$i;B$r++){var B$H=B$O[B$L],B$Y=B$O[B$L+1],B$G=B$H*B$p.a+B$Y*B$p.c+B$p.tx,B$X=B$H*B$p.b+B$Y*B$p.d+B$p.ty;B$_[B$k++]=B$G,B$_[B$k++]=B$X,B$_[B$k++]=B$J[B$L],B$_[B$k++]=B$J[B$L+1],B$L+=2}this._vb.setNeedUpload();var B$c=this.vertNum;if(0<B$c){(B$i=B$D.length)>B$y.tmpIdx.length&&(B$y.tmpIdx=new Uint16Array(B$i));for(var B$h=0;B$h<B$i;B$h++)B$y.tmpIdx[B$h]=B$D[B$h]+B$c;this._ib.appendU16Array(B$y.tmpIdx,B$D.length)}else this._ib.append(B$D);this._ib.setNeedUpload(),this.vertNum+=B$i,this.indexNum+=B$D.length},B$J.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},B$J.destroy=function(){this._ib.destroy(),this._vb.destroy()},B$y.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new B$y},B$y.const_stride=16,B$y._POOL=[],B$i(B$y,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),B$y}(),B$RO=function(B$O){function B$J(){B$J.__super.call(this),this.lock=!0}return B$Y(B$J,"laya.webgl.shader.BaseShader",B$A),B$J.activeShader=null,B$J.bindShader=null,B$J}(),B$jO=function(B$J){function B$r(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===B$D&&(B$D=6408),void 0===B$p&&(B$p=5121),void 0===B$m&&(B$m=34041),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=-1),void 0===B$_&&(B$_=-1),this._type=1,this._w=B$O,this._h=B$J,this._surfaceFormat=B$D,this._surfaceType=B$p,this._depthStencilFormat=B$m,B$y.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=B$C,this._repeat=B$i,this._minFifter=B$k,this._magFifter=B$_,this._createWebGLRenderTarget(),this.bitmap.lock=!0,B$r.__super.call(this,this.bitmap,B$F.INV_UV)}B$Y(B$r,"laya.webgl.resource.RenderTarget2D",B$J);var B$O=B$r.prototype;return B$M.imps(B$O,{"laya.resource.IDispose":!0}),B$O.getType=function(){return this._type},B$O.getTexture=function(){return this},B$O.size=function(B$O,B$J){this._w==B$O&&this._h==B$J||(this._w=B$O,this._h=B$J,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},B$O.release=function(){this.destroy()},B$O.recycle=function(){B$r.POOL.push(this)},B$O.start=function(){var B$O=B$qO.mainContext;return this._preRenderTarget=B$vO.curRenderTarget,B$vO.curRenderTarget=this,B$O.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(B$O.viewport(0,0,this._w,this._h),this._svWidth=B$vO.width,this._svHeight=B$vO.height,B$vO.width=this._w,B$vO.height=this._h,B$RO.activeShader=null),this},B$O.clear=function(B$O,B$J,B$D,B$p){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=1);var B$m=B$qO.mainContext;B$m.clearColor(B$O,B$J,B$D,B$p);var B$C=16384;switch(this._depthStencilFormat){case 33189:B$C|=256;break;case 36168:B$C|=1024;break;case 34041:B$C|=256,B$C|=1024}B$m.clear(B$C)},B$O.end=function(){var B$O=B$qO.mainContext;B$O.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,B$vO.curRenderTarget=this._preRenderTarget,1==this._type?(B$O.viewport(0,0,this._svWidth,this._svHeight),B$vO.width=this._svWidth,B$vO.height=this._svHeight,B$RO.activeShader=null):B$O.viewport(0,0,B$M.stage.width,B$M.stage.height)},B$O.getData=function(B$O,B$J,B$D,B$p){var B$m=B$qO.mainContext;if(B$m.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===B$m.checkFramebufferStatus(36160)))return B$m.bindFramebuffer(36160,null),null;var B$C=new Uint8Array(this._w*this._h*4);return B$m.readPixels(B$O,B$J,B$D,B$p,this._surfaceFormat,this._surfaceType,B$C),B$m.bindFramebuffer(36160,null),B$C},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,B$J.prototype.destroy.call(this))},B$O.dispose=function(){},B$O._createWebGLRenderTarget=function(){this.bitmap=new B$ZO(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(B$O){this.event("recovered")})},B$p(0,B$O,"surfaceFormat",function(){return this._surfaceFormat}),B$p(0,B$O,"magFifter",function(){return this._magFifter}),B$p(0,B$O,"surfaceType",function(){return this._surfaceType}),B$p(0,B$O,"mipMap",function(){return this._mipMap}),B$p(0,B$O,"depthStencilFormat",function(){return this._depthStencilFormat}),B$p(0,B$O,"minFifter",function(){return this._minFifter}),B$p(0,B$O,"source",function(){return this._alreadyResolved?B$M.superGet(B$F,this,"source"):null}),B$r.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){void 0===B$D&&(B$D=6408),void 0===B$p&&(B$p=5121),void 0===B$m&&(B$m=34041),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=-1),void 0===B$_&&(B$_=-1);var B$L=B$r.POOL.pop();return B$L||(B$L=new B$r(B$O,B$J)),B$L.bitmap&&B$L._w==B$O&&B$L._h==B$J&&B$L._surfaceFormat==B$D&&B$L._surfaceType==B$p&&B$L._depthStencilFormat==B$m&&B$L._mipMap==B$C&&B$L._repeat==B$i&&B$L._minFifter==B$k&&B$L._magFifter==B$_||(B$L._w=B$O,B$L._h=B$J,B$L._surfaceFormat=B$D,B$L._surfaceType=B$p,B$L._depthStencilFormat=B$m,B$y.isConchWebGL&&34041===B$L._depthStencilFormat&&(B$L._depthStencilFormat=33189),B$L._mipMap=B$C,B$L._repeat=B$i,B$L._minFifter=B$k,B$L._magFifter=B$_,B$L.release(),B$L._createWebGLRenderTarget()),B$L},B$r.TYPE2D=1,B$r.TYPE3D=2,B$r.POOL=[],B$r}(B$F),B$uO=function(B$O){function B$J(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,B$J.__super.call(this),B$J._gl=B$qO.mainContext}B$Y(B$J,"laya.webgl.utils.Buffer",B$A);var B$D=B$J.prototype;return B$D._bind=function(){this.activeResource(),B$J._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(B$J._bindVertexBuffer=this._glBuffer),B$J._gl.bindBuffer(this._bufferType,B$J._bindActive[this._bufferType]=this._glBuffer),B$RO.activeShader=null)},B$D.recreateResource=function(){this._glBuffer||(this._glBuffer=B$J._gl.createBuffer()),this.completeCreate()},B$D.disposeResource=function(){this._glBuffer&&(B$qO.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},B$p(0,B$D,"bufferUsage",function(){return this._bufferUsage}),B$J._gl=null,B$J._bindActive={},B$J._bindVertexBuffer=null,B$J._enableAtributes=[],B$J}(),B$lO=function(B$O){function B$D(B$O){this.texcoord=null,this.offsetX=300,this.offsetY=0,B$D.__super.call(this,512,0);var B$J=8*B$cO.BYTES_PE;this.position=[2,5126,!1,B$J,0],this.texcoord=[2,5126,!1,B$J,2*B$cO.BYTES_PE],this.color=[4,5126,!1,B$J,4*B$cO.BYTES_PE]}return B$Y(B$D,"laya.webgl.shader.d2.skinAnishader.SkinSV",B$eO),B$D}(),B$$O=function(B$O){function B$J(B$O){B$J.__super.call(this,2,0),this.color=[]}return B$Y(B$J,"laya.webgl.shader.d2.value.Color2dSV",B$eO),B$J.prototype.setValue=function(B$O){B$O.fillStyle&&(this.color=B$O.fillStyle._color._color),B$O.strokeStyle&&(this.color=B$O.strokeStyle._color._color)},B$J}(),B$xO=function(B$O){function B$J(B$O){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=B$eO._TEXCOORD,B$J.__super.call(this,256,0)}B$Y(B$J,"laya.webgl.shader.d2.value.FillTextureSV",B$eO);var B$D=B$J.prototype;return B$D.setValue=function(B$O){this.ALPHA=B$O.ALPHA,B$O.filters&&this.setFilters(B$O.filters)},B$D.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},B$J}(),B$VO=function(B$O){function B$J(B$O){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=B$eO._TEXCOORD,void 0===B$O&&(B$O=0),B$J.__super.call(this,1,B$O)}B$Y(B$J,"laya.webgl.shader.d2.value.TextureSV",B$eO);var B$D=B$J.prototype;return B$D.setValue=function(B$O){this.ALPHA=B$O.ALPHA,B$O.filters&&this.setFilters(B$O.filters)},B$D.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},B$J}(),B$TO=function(B$O){function B$J(B$O){this.a_color=null,this.u_pos=[0,0],B$J.__super.call(this,4,0),this.position=[2,5126,!1,5*B$cO.BYTES_PE,0],this.a_color=[3,5126,!1,5*B$cO.BYTES_PE,2*B$cO.BYTES_PE]}return B$Y(B$J,"laya.webgl.shader.d2.value.PrimitiveSV",B$eO),B$J}(),B$IO=function(B$O){function B$J(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,B$J.__super.call(this)}B$Y(B$J,"laya.webgl.atlas.AtlasWebGLCanvas",B$O);var B$D=B$J.prototype;return B$D.recreateResource=function(){var B$O=B$qO.mainContext,B$J=this._source=B$O.createTexture(),B$D=B$dO.curBindTexTarget,B$p=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,B$J),B$O.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),B$O.texParameteri(3553,10241,9729),B$O.texParameteri(3553,10240,9729),B$O.texParameteri(3553,10242,33071),B$O.texParameteri(3553,10243,33071),B$D&&B$p&&B$dO.bindTexture(B$O,B$D,B$p),this.memorySize=this._w*this._h*4,this.completeCreate()},B$D.disposeResource=function(){this._source&&(B$qO.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},B$D.texSubImage2D=function(B$O,B$J,B$D){if(B$y.isFlash){this._flashCacheImage||(this._flashCacheImage=B$c.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var B$p=B$D.bitmapdata;this._flashCacheImage._image.copyPixels(B$p,0,0,B$p.width,B$p.height,B$O,B$J),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var B$m=B$qO.mainContext,B$C=B$dO.curBindTexTarget,B$i=B$dO.curBindTexValue;B$dO.bindTexture(B$m,3553,this._source),B$m.pixelStorei(37441,!0),0<=B$O-1&&B$m.texSubImage2D(3553,0,B$O-1,B$J,6408,5121,B$D),B$O+1<=this._w&&B$m.texSubImage2D(3553,0,B$O+1,B$J,6408,5121,B$D),0<=B$J-1&&B$m.texSubImage2D(3553,0,B$O,B$J-1,6408,5121,B$D),B$J+1<=this._h&&B$m.texSubImage2D(3553,0,B$O,B$J+1,6408,5121,B$D),B$m.texSubImage2D(3553,0,B$O,B$J,6408,5121,B$D),B$m.pixelStorei(37441,!1),B$C&&B$i&&B$dO.bindTexture(B$m,B$C,B$i)}},B$D.texSubImage2DPixel=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$qO.mainContext,B$i=B$dO.curBindTexTarget,B$k=B$dO.curBindTexValue;B$dO.bindTexture(B$C,3553,this._source);var B$_=new Uint8Array(B$m.data);B$C.pixelStorei(37441,!0),B$C.texSubImage2D(3553,0,B$O,B$J,B$D,B$p,6408,5121,B$_),B$C.pixelStorei(37441,!1),B$i&&B$k&&B$dO.bindTexture(B$C,B$i,B$k)},B$p(0,B$D,"width",B$O.prototype._$get_width,function(B$O){this._w=B$O}),B$p(0,B$D,"height",B$O.prototype._$get_height,function(B$O){this._h=B$O}),B$J}(B$D),B$wO=function(B$O){function B$m(){this.flipY=!0,this.alwaysChange=!1,B$m.__super.call(this)}B$Y(B$m,"laya.webgl.resource.WebGLCanvas",B$D);var B$J=B$m.prototype;return B$J.getCanvas=function(){return this._canvas},B$J.clear=function(){this._ctx&&this._ctx.clear()},B$J.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},B$J._setContext=function(B$O){this._ctx=B$O},B$J.getContext=function(B$O,B$J){return this._ctx?this._ctx:this._ctx=B$m._createContext(this)},B$J.size=function(B$O,B$J){this._w==B$O&&this._h==B$J||(this._w=B$O,this._h=B$J,this._ctx&&this._ctx.size(B$O,B$J),this._canvas&&(this._canvas.height=B$J,this._canvas.width=B$O))},B$J.activeResource=function(B$O){void 0===B$O&&(B$O=!1),this._source||this.recreateResource()},B$J.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},B$J.disposeResource=function(){this._source&&!this.iscpuSource&&(B$qO.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},B$J.createWebGlTexture=function(){var B$O=B$qO.mainContext;this._canvas;var B$J=this._source=B$O.createTexture();this.iscpuSource=!1;var B$D=B$dO.curBindTexTarget,B$p=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,B$J),B$O.pixelStorei(37440,this.flipY?1:0),B$m.premulAlpha&&B$O.pixelStorei(37441,!0),B$O.texImage2D(3553,0,6408,6408,5121,this._imgData),B$m.premulAlpha&&B$O.pixelStorei(37441,!1),B$O.texParameteri(3553,10240,9729),B$O.texParameteri(3553,10241,9729),B$O.texParameteri(3553,10242,33071),B$O.texParameteri(3553,10243,33071),B$O.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,B$D&&B$p&&B$dO.bindTexture(B$O,B$D,B$p)},B$J.reloadCanvasData=function(){var B$O=B$qO.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var B$J=B$dO.curBindTexTarget,B$D=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,this._source),B$m.premulAlpha&&B$O.pixelStorei(37441,!0),B$O.texImage2D(3553,0,6408,6408,5121,this._imgData),B$m.premulAlpha&&B$O.pixelStorei(37441,!1),B$O.pixelStorei(37440,0),B$J&&B$D&&B$dO.bindTexture(B$O,B$J,B$D)},B$J.texSubImage2D=function(B$O,B$J,B$D){var B$p=B$qO.mainContext,B$m=B$dO.curBindTexTarget,B$C=B$dO.curBindTexValue;B$dO.bindTexture(B$p,3553,this._source),B$p.pixelStorei(37441,!0),B$p.texSubImage2D(3553,0,B$J,B$D,6408,5121,B$O._source),B$p.pixelStorei(37441,!1),B$m&&B$C&&B$dO.bindTexture(B$p,B$m,B$C)},B$J.toBase64=function(B$O,B$J,B$D){var B$p=null;this._canvas&&(B$p=this._canvas.toDataURL(B$O,B$J)),B$D.call(this,B$p)},B$p(0,B$J,"context",function(){return this._ctx}),B$p(0,B$J,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),B$p(0,B$J,"asBitmap",null,function(B$O){this._ctx&&(this._ctx.asBitmap=B$O)}),B$m._createContext=null,B$m.premulAlpha=!1,B$m}(),B$UO=function(B$O){function B$C(B$O,B$J){this.CborderSize=12,B$C.__super.call(this),this.char=B$O,this.isSpace=" "===B$O,this.xs=B$J.scaleX,this.ys=B$J.scaleY,this.font=B$J.font.toString(),this.fontSize=B$J.font.size,this.fillColor=B$J.fillColor,this.borderColor=B$J.borderColor,this.lineWidth=B$J.lineWidth,this.underLine=B$J.underLine;var B$D,B$p=B$y.isConchApp;B$p?((B$D=ConchTextCanvas)._source=ConchTextCanvas,B$D._source.canvas=ConchTextCanvas):B$D=B$G.canvas.source,this.canvas=B$D,this._enableMerageInAtlas=!0,this._ctx=B$p?B$D:this.canvas.getContext("2d",void 0);var B$m=B$R.measureText(this.char,this.font);this.cw=B$m.width*this.xs,this.ch=(B$m.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new B$F(this)}B$Y(B$C,"laya.webgl.resource.WebGLCharImage",B$D);var B$J=B$C.prototype;return B$M.imps(B$J,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),B$J.active=function(){this.texture.active()},B$J.recreateResource=function(){var B$O=B$y.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),B$O){var B$J=this.fontSize;1==this.xs&&1==this.ys||(B$J=parseInt(B$J*(this.xs>this.ys?this.xs:this.ys)+""));var B$D="normal 100 "+this.font;B$D=B$D.replace(B$C._fontSizeReg,B$J),this.borderColor&&(B$D+=" 1 "+this.borderColor),this._ctx.font=B$D,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,B$N.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var B$p=this._ctx.measureText(this.char);B$p||(B$p={width:16});var B$m=B$p.width+1;this._ctx.lineTo(B$m,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},B$J.onresize=function(B$O,B$J){this._w=B$O,this._h=B$J,this._allowMerageInAtlas=!0},B$J.clearAtlasSource=function(){},B$p(0,B$J,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),B$p(0,B$J,"atlasSource",function(){return this.canvas}),B$p(0,B$J,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(B$O){this._enableMerageInAtlas=B$O}),B$C.createOneChar=function(B$O,B$J){return new B$C(B$O,B$J)},B$C._fontSizeReg=new RegExp("\\d+(?=px)","g"),B$C}(),B$ZO=function(B$O){function B$L(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){void 0===B$D&&(B$D=6408),void 0===B$p&&(B$p=5121),void 0===B$m&&(B$m=34041),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=-1),void 0===B$_&&(B$_=1),B$L.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=B$O,this._h=B$J,this._surfaceFormat=B$D,this._surfaceType=B$p,this._depthStencilFormat=B$m,this._mipMap=B$C,this._repeat=B$i,this._minFifter=B$k,this._magFifter=B$_}B$Y(B$L,"laya.webgl.resource.WebGLRenderTarget",B$D);var B$J=B$L.prototype;return B$J.recreateResource=function(){var B$O=B$qO.mainContext;this._frameBuffer||(this._frameBuffer=B$O.createFramebuffer()),this._source||(this._source=B$O.createTexture());var B$J=B$dO.curBindTexTarget,B$D=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,this._source),B$O.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var B$p=this._minFifter,B$m=this._magFifter,B$C=this._repeat?10497:33071,B$i=B$r.isPOT(this._w,this._h);if(B$i?(this._mipMap?-1!==B$p||(B$p=9987):-1!==B$p||(B$p=9729),-1!==B$m||(B$m=9729),B$O.texParameteri(3553,10241,B$p),B$O.texParameteri(3553,10240,B$m),B$O.texParameteri(3553,10242,B$C),B$O.texParameteri(3553,10243,B$C),this._mipMap&&B$O.generateMipmap(3553)):(-1!==B$p||(B$p=9729),-1!==B$m||(B$m=9729),B$O.texParameteri(3553,10241,B$p),B$O.texParameteri(3553,10240,B$m),B$O.texParameteri(3553,10242,33071),B$O.texParameteri(3553,10243,33071)),B$O.bindFramebuffer(36160,this._frameBuffer),B$O.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=B$O.createRenderbuffer()),B$O.bindRenderbuffer(36161,this._depthStencilBuffer),B$O.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:B$O.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:B$O.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:B$O.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}B$O.bindFramebuffer(36160,null),B$J&&B$D&&B$dO.bindTexture(B$O,B$J,B$D),B$O.bindRenderbuffer(36161,null),B$i&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},B$J.disposeResource=function(){this._frameBuffer&&(B$qO.mainContext.deleteTexture(this._source),B$qO.mainContext.deleteFramebuffer(this._frameBuffer),B$qO.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},B$p(0,B$J,"depthStencilBuffer",function(){return this._depthStencilBuffer}),B$p(0,B$J,"frameBuffer",function(){return this._frameBuffer}),B$L}(),B$nO=function(B$O){function B$k(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this.offsetX=0,this.offsetY=0,B$k.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=B$C,this.canvas=B$O,this._ctx=B$O.getContext("2d",void 0),this._w=B$p,this._h=B$m,this.offsetX=B$J,this.offsetY=B$D,this.src=B$i,this._enableMerageInAtlas=!0,B$x.enabled&&this._w<B$x.atlasLimitWidth&&this._h<B$x.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}B$Y(B$k,"laya.webgl.resource.WebGLSubImage",B$D);var B$J=B$k.prototype;return B$M.imps(B$J,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),B$J.size=function(B$O,B$J){this._w=B$O,this._h=B$J,this._ctx&&this._ctx.size(B$O,B$J),this.canvas&&(this.canvas.height=B$J,this.canvas.width=B$O)},B$J.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},B$J.createWebGlTexture=function(){var B$O=B$qO.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var B$J=this._source=B$O.createTexture(),B$D=B$dO.curBindTexTarget,B$p=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,B$J),B$O.pixelStorei(37441,!0),B$O.texImage2D(3553,0,6408,6408,5121,this.canvas),B$O.pixelStorei(37441,!1);var B$m=this.minFifter,B$C=this.magFifter,B$i=this.repeat?10497:33071,B$k=B$r.isPOT(this.width,this.height);B$k?(this.mipmap?-1!==B$m||(B$m=9987):-1!==B$m||(B$m=9729),-1!==B$C||(B$C=9729),B$O.texParameteri(3553,10240,B$C),B$O.texParameteri(3553,10241,B$m),B$O.texParameteri(3553,10242,B$i),B$O.texParameteri(3553,10243,B$i),this.mipmap&&B$O.generateMipmap(3553)):(-1!==B$m||(B$m=9729),-1!==B$C||(B$C=9729),B$O.texParameteri(3553,10241,B$m),B$O.texParameteri(3553,10240,B$C),B$O.texParameteri(3553,10242,33071),B$O.texParameteri(3553,10243,33071)),B$D&&B$p&&B$dO.bindTexture(B$O,B$D,B$p),this.canvas=null,B$k&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},B$J.disposeResource=function(){B$x.enabled&&this._allowMerageInAtlas||!this._source||(B$qO.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},B$J.clearAtlasSource=function(){},B$p(0,B$J,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),B$p(0,B$J,"atlasSource",function(){return this.canvas}),B$p(0,B$J,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(B$O){this._allowMerageInAtlas=B$O}),B$k}(),B$BO=function(B$O){function B$L(B$O,B$J,B$D,B$p){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,B$L.__super.call(this),!B$O||!B$J)throw"Shader Error";this._id=++B$L._count,this._vs=B$O,this._ps=B$J,this._nameMap=B$p||{},null!=B$D&&(B$L.sharders[B$D]=this)}B$Y(B$L,"laya.webgl.shader.Shader",B$RO);var B$J=B$L.prototype;return B$J.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},B$J.disposeResource=function(){B$qO.mainContext.deleteShader(this._vshader),B$qO.mainContext.deleteShader(this._pshader),B$qO.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},B$J._compile=function(){if(!B$qO.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var B$O=[this._vs,this._ps],B$J=B$qO.mainContext;if(this._program=B$J.createProgram(),this._vshader=B$L._createShader(B$J,B$O[0],35633),this._pshader=B$L._createShader(B$J,B$O[1],35632),B$J.attachShader(this._program,this._vshader),B$J.attachShader(this._program,this._pshader),B$J.linkProgram(this._program),!B$y.isConchApp&&!B$J.getProgramParameter(this._program,35714))throw B$J.getProgramInfoLog(this._program);var B$D,B$p,B$m=0,B$C=0;for(B$C=B$y.isConchApp?B$J.getProgramParameterEx(this._vs,this._ps,"",35721):B$J.getProgramParameter(this._program,35721),B$m=0;B$m<B$C;B$m++){var B$i=null;B$D={vartype:"attribute",glfun:null,ivartype:0,attrib:B$i=B$y.isConchApp?B$J.getActiveAttribEx(this._vs,this._ps,"",B$m):B$J.getActiveAttrib(this._program,B$m),location:B$J.getAttribLocation(this._program,B$i.name),name:B$i.name,type:B$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(B$D)}var B$k=0;for(B$k=B$y.isConchApp?B$J.getProgramParameterEx(this._vs,this._ps,"",35718):B$J.getProgramParameter(this._program,35718),B$m=0;B$m<B$k;B$m++){var B$_=null;B$_=B$y.isConchApp?B$J.getActiveUniformEx(this._vs,this._ps,"",B$m):B$J.getActiveUniform(this._program,B$m),0<(B$D={vartype:"uniform",glfun:null,ivartype:1,attrib:B$i,location:B$J.getUniformLocation(this._program,B$_.name),name:B$_.name,type:B$_.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(B$D.name=B$D.name.substr(0,B$D.name.length-3),B$D.isArray=!0,B$D.location=B$J.getUniformLocation(this._program,B$D.name)),this._params.push(B$D)}for(B$m=0,B$p=this._params.length;B$m<B$p;B$m++)if((B$D=this._params[B$m]).indexOfParams=B$m,B$D.index=1,B$D.value=[B$D.location,null],B$D.codename=B$D.name,B$D.name=this._nameMap[B$D.codename]?this._nameMap[B$D.codename]:B$D.codename,(this._paramsMap[B$D.name]=B$D)._this=this,B$D.uploadedValue=[],"attribute"!==B$D.vartype)switch(B$D.type){case 5124:B$D.fun=B$D.isArray?this._uniform1iv:this._uniform1i;break;case 5126:B$D.fun=B$D.isArray?this._uniform1fv:this._uniform1f;break;case 35664:B$D.fun=B$D.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:B$D.fun=B$D.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:B$D.fun=B$D.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:B$D.fun=this._uniform_sampler2D;break;case 35680:B$D.fun=this._uniform_samplerCube;break;case 35676:B$D.glfun=B$J.uniformMatrix4fv,B$D.fun=this._uniformMatrix4fv;break;case 35670:B$D.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else B$D.fun=this._attribute}},B$J.getUniform=function(B$O){return this._paramsMap[B$O]},B$J._attribute=function(B$O,B$J){var B$D=B$qO.mainContext,B$p=B$uO._enableAtributes,B$m=B$O.location;return B$p[B$m]||B$D.enableVertexAttribArray(B$m),B$D.vertexAttribPointer(B$m,B$J[0],B$J[1],B$J[2],B$J[3],B$J[4]+this._offset),B$p[B$m]=B$uO._bindVertexBuffer,1},B$J._uniform1f=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J?(B$qO.mainContext.uniform1f(B$O.location,B$D[0]=B$J),1):0},B$J._uniform1fv=function(B$O,B$J){if(B$J.length<4){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$qO.mainContext.uniform1fv(B$O.location,B$J),B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3],1):0}return B$qO.mainContext.uniform1fv(B$O.location,B$J),1},B$J._uniform_vec2=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]?(B$qO.mainContext.uniform2f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1]),1):0},B$J._uniform_vec2v=function(B$O,B$J){if(B$J.length<2){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$qO.mainContext.uniform2fv(B$O.location,B$J),B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3],1):0}return B$qO.mainContext.uniform2fv(B$O.location,B$J),1},B$J._uniform_vec3=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]?(B$qO.mainContext.uniform3f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2]),1):0},B$J._uniform_vec3v=function(B$O,B$J){return B$qO.mainContext.uniform3fv(B$O.location,B$J),1},B$J._uniform_vec4=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$qO.mainContext.uniform4f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3]),1):0},B$J._uniform_vec4v=function(B$O,B$J){return B$qO.mainContext.uniform4fv(B$O.location,B$J),1},B$J._uniformMatrix2fv=function(B$O,B$J){return B$qO.mainContext.uniformMatrix2fv(B$O.location,!1,B$J),1},B$J._uniformMatrix3fv=function(B$O,B$J){return B$qO.mainContext.uniformMatrix3fv(B$O.location,!1,B$J),1},B$J._uniformMatrix4fv=function(B$O,B$J){return B$qO.mainContext.uniformMatrix4fv(B$O.location,!1,B$J),1},B$J._uniform1i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J?(B$qO.mainContext.uniform1i(B$O.location,B$D[0]=B$J),1):0},B$J._uniform1iv=function(B$O,B$J){return B$qO.mainContext.uniform1iv(B$O.location,B$J),1},B$J._uniform_ivec2=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]?(B$qO.mainContext.uniform2i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1]),1):0},B$J._uniform_ivec2v=function(B$O,B$J){return B$qO.mainContext.uniform2iv(B$O.location,B$J),1},B$J._uniform_vec3i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]?(B$qO.mainContext.uniform3i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2]),1):0},B$J._uniform_vec3vi=function(B$O,B$J){return B$qO.mainContext.uniform3iv(B$O.location,B$J),1},B$J._uniform_vec4i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$qO.mainContext.uniform4i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3]),1):0},B$J._uniform_vec4vi=function(B$O,B$J){return B$qO.mainContext.uniform4iv(B$O.location,B$J),1},B$J._uniform_sampler2D=function(B$O,B$J){var B$D=B$qO.mainContext,B$p=B$O.uploadedValue;return null==B$p[0]?(B$p[0]=this._curActTexIndex,B$D.uniform1i(B$O.location,this._curActTexIndex),B$D.activeTexture(B$L._TEXTURES[this._curActTexIndex]),B$dO.bindTexture(B$D,3553,B$J),this._curActTexIndex++,1):(B$D.activeTexture(B$L._TEXTURES[B$p[0]]),B$dO.bindTexture(B$D,3553,B$J),0)},B$J._uniform_samplerCube=function(B$O,B$J){var B$D=B$qO.mainContext,B$p=B$O.uploadedValue;return null==B$p[0]?(B$p[0]=this._curActTexIndex,B$D.uniform1i(B$O.location,this._curActTexIndex),B$D.activeTexture(B$L._TEXTURES[this._curActTexIndex]),B$dO.bindTexture(B$D,34067,B$J),this._curActTexIndex++,1):(B$D.activeTexture(B$L._TEXTURES[B$p[0]]),B$dO.bindTexture(B$D,34067,B$J),0)},B$J._noSetValue=function(B$O){console.log("no....:"+B$O.name)},B$J.uploadOne=function(B$O,B$J){this.activeResource(),B$dO.UseProgram(this._program);var B$D=this._paramsMap[B$O];B$D.fun.call(this,B$D,B$J)},B$J.uploadTexture2D=function(B$O){B$E.shaderCall++;var B$J=B$qO.mainContext;B$J.activeTexture(33984),B$dO.bindTexture(B$J,3553,B$O)},B$J.uploadTexture2D1=function(B$O){B$E.shaderCall++;var B$J=B$qO.mainContext;B$J.activeTexture(33985),B$dO.bindTexture(B$J,3553,B$O)},B$J.upload=function(B$O,B$J){B$RO.activeShader=B$RO.bindShader=this,this._lastUseFrameCount===B$E.loopCount||this.activeResource(),B$dO.UseProgram(this._program),this._reCompile?(B$J=this._params,this._reCompile=!1):B$J=B$J||this._params;B$qO.mainContext;for(var B$D,B$p,B$m=B$J.length,B$C=0,B$i=0;B$i<B$m;B$i++)null!==(B$p=B$O[(B$D=B$J[B$i]).name])&&(B$C+=B$D.fun.call(this,B$D,B$p));B$E.shaderCall+=B$C},B$J.uploadArray=function(B$O,B$J,B$D){B$RO.activeShader=this,(B$RO.bindShader=this).activeResource(),B$dO.UseProgram(this._program);this._params;for(var B$p,B$m,B$C=0,B$i=B$J-2;0<=B$i;B$i-=2)(B$m=this._paramsMap[B$O[B$i]])&&null!=(B$p=B$O[B$i+1])&&(B$D&&B$D[B$m.name]&&B$D[B$m.name].bind(),B$C+=B$m.fun.call(this,B$m,B$p));B$E.shaderCall+=B$C},B$J.getParams=function(){return this._params},B$L.getShader=function(B$O){return B$L.sharders[B$O]},B$L.create=function(B$O,B$J,B$D,B$p){return new B$L(B$O,B$J,B$D,B$p)},B$L.withCompile=function(B$O,B$J,B$D,B$p){if(B$D&&B$L.sharders[B$D])return B$L.sharders[B$D];var B$m=B$L._preCompileShader[2e-4*B$O];if(!B$m)throw new Error("withCompile shader err!"+B$O);return B$m.createShader(B$J,B$D,B$p)},B$L.withCompile2D=function(B$O,B$J,B$D,B$p,B$m){if(B$p&&B$L.sharders[B$p])return B$L.sharders[B$p];var B$C=B$L._preCompileShader[2e-4*B$O+B$J];if(!B$C)throw new Error("withCompile shader err!"+B$O+" "+B$J);return B$C.createShader(B$D,B$p,B$m)},B$L.addInclude=function(B$O,B$J){B$AO.addInclude(B$O,B$J)},B$L.preCompile=function(B$O,B$J,B$D,B$p){var B$m=2e-4*B$O;B$L._preCompileShader[B$m]=new B$AO(B$m,B$J,B$D,B$p)},B$L.preCompile2D=function(B$O,B$J,B$D,B$p,B$m){var B$C=2e-4*B$O+B$J;B$L._preCompileShader[B$C]=new B$AO(B$C,B$D,B$p,B$m)},B$L._createShader=function(B$O,B$J,B$D){var B$p=B$O.createShader(B$D);return B$O.shaderSource(B$p,B$J),B$O.compileShader(B$p),B$p},B$L._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],B$L._count=0,B$L._preCompileShader={},B$L.SHADERNAME2ID=2e-4,B$L.sharders=((B$L.sharders=[]).length=32,B$L.sharders),B$i(B$L,["nameKey",function(){return this.nameKey=new B$o}]),B$L}(),B$SO=function(B$O){function B$J(){this._maxsize=0,this._upload=!0,this._uploadSize=0,B$J.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}B$Y(B$J,"laya.webgl.utils.Buffer2D",B$O);var B$D=B$J.prototype;return B$D.needSize=function(B$O){var B$J=this._byteLength;if(B$O){var B$D=this._byteLength+B$O;B$D<=this._buffer.byteLength||this._resizeBuffer(B$D<<1,!0),this._byteLength=B$D}return B$J},B$D._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),B$E.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,B$uO._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),B$uO._gl.bufferSubData(this._bufferType,0,this._buffer)},B$D._bufferSubData=function(B$O,B$J,B$D){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),this._maxsize=Math.max(this._maxsize,this._byteLength),B$E.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,B$uO._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),B$J||B$D){var B$p=this._buffer.slice(B$J,B$D);B$uO._gl.bufferSubData(this._bufferType,B$O,B$p)}else B$uO._gl.bufferSubData(this._bufferType,B$O,this._buffer)},B$D._checkArrayUse=function(){},B$D._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},B$D._bind_subUpload=function(B$O,B$J,B$D){return void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(B$O,B$J,B$D),!0)},B$D._resizeBuffer=function(B$O,B$J){if(B$O<this._buffer.byteLength)return this;if(this.memorySize=B$O,B$J&&this._buffer&&0<this._buffer.byteLength){var B$D=new ArrayBuffer(B$O);new Uint8Array(B$D).set(new Uint8Array(this._buffer),0),this._buffer=B$D}else this._buffer=new ArrayBuffer(B$O);return this._checkArrayUse(),this._upload=!0,this},B$D.append=function(B$O){this._upload=!0;var B$J,B$D;B$J=B$O.byteLength,B$O instanceof Uint8Array?(this._resizeBuffer(this._byteLength+B$J,!0),B$D=new Uint8Array(this._buffer,this._byteLength)):B$O instanceof Uint16Array?(this._resizeBuffer(this._byteLength+B$J,!0),B$D=new Uint16Array(this._buffer,this._byteLength)):B$O instanceof Float32Array&&(this._resizeBuffer(this._byteLength+B$J,!0),B$D=new Float32Array(this._buffer,this._byteLength)),B$D.set(B$O,0),this._byteLength+=B$J,this._checkArrayUse()},B$D.appendU16Array=function(B$O,B$J){this._resizeBuffer(this._byteLength+2*B$J,!0);for(var B$D=new Uint16Array(this._buffer,this._byteLength,B$J),B$p=0;B$p<B$J;B$p++)B$D[B$p]=B$O[B$p];this._byteLength+=2*B$J,this._checkArrayUse()},B$D.appendEx=function(B$O,B$J){this._upload=!0;var B$D;B$D=B$O.byteLength,this._resizeBuffer(this._byteLength+B$D,!0),new B$J(this._buffer,this._byteLength).set(B$O,0),this._byteLength+=B$D,this._checkArrayUse()},B$D.appendEx2=function(B$O,B$J,B$D,B$p){void 0===B$p&&(B$p=1),this._upload=!0;var B$m,B$C;B$m=B$D*B$p,this._resizeBuffer(this._byteLength+B$m,!0),B$C=new B$J(this._buffer,this._byteLength);var B$i=0;for(B$i=0;B$i<B$D;B$i++)B$C[B$i]=B$O[B$i];this._byteLength+=B$m,this._checkArrayUse()},B$D.getBuffer=function(){return this._buffer},B$D.setNeedUpload=function(){this._upload=!0},B$D.getNeedUpload=function(){return this._upload},B$D.upload=function(){var B$O=this._bind_upload();return B$uO._gl.bindBuffer(this._bufferType,null),B$uO._bindActive[this._bufferType]=null,B$RO.activeShader=null,B$O},B$D.subUpload=function(B$O,B$J,B$D){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0);var B$p=this._bind_subUpload();return B$uO._gl.bindBuffer(this._bufferType,null),B$uO._bindActive[this._bufferType]=null,B$RO.activeShader=null,B$p},B$D.disposeResource=function(){B$O.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},B$D.clear=function(){this._byteLength=0,this._upload=!0},B$p(0,B$D,"bufferLength",function(){return this._buffer.byteLength}),B$p(0,B$D,"byteLength",null,function(B$O){this._byteLength!==B$O&&(B$O<=this._buffer.byteLength||this._resizeBuffer(2*B$O+256,!0),this._byteLength=B$O)}),B$J.__int__=function(B$O){B$KO.QuadrangleIB=B$KO.create(35044),B$hO.fillIBQuadrangle(B$KO.QuadrangleIB,16)},B$J.FLOAT32=4,B$J.SHORT=2,B$J}(B$uO),B$QO=(function(B$J){function B$D(B$O){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,B$D.__super.call(this,9)}B$Y(B$D,"laya.webgl.shader.d2.value.GlowSV",B$J);var B$O=B$D.prototype;B$O.setValue=function(B$O){B$J.prototype.setValue.call(this,B$O)},B$O.clear=function(){B$J.prototype.clear.call(this)}}(B$VO),function(B$O){function B$J(B$O){B$J.__super.call(this,64),this.defines.add(64)}B$Y(B$J,"laya.webgl.shader.d2.value.TextSV",B$O);var B$D=B$J.prototype;return B$D.release=function(){(B$J.pool[B$J._length++]=this).clear()},B$D.clear=function(){B$O.prototype.clear.call(this)},B$J.create=function(){return B$J._length?B$J.pool[--B$J._length]:new B$J(null)},B$J.pool=[],B$J._length=0,B$J}(B$VO)),B$bO=function(B$O){function B$m(B$O,B$J,B$D,B$p){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,B$m.__super.call(this,B$O,B$J,B$D,B$p)}B$Y(B$m,"laya.webgl.shader.d2.Shader2X",B$O);var B$J=B$m.prototype;return B$J.upload2dQuick1=function(B$O){this.upload(B$O,this._params2dQuick1||this._make2dQuick1())},B$J._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var B$O,B$J=this._params,B$D=0,B$p=B$J.length;B$D<B$p;B$D++)B$O=B$J[B$D],(B$y.isFlash||"size"!==B$O.name&&"position"!==B$O.name&&"texcoord"!==B$O.name)&&this._params2dQuick1.push(B$O)}return this._params2dQuick1},B$J.disposeResource=function(){B$O.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},B$J.upload2dQuick2=function(B$O){this.upload(B$O,this._params2dQuick2||this._make2dQuick2())},B$J._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var B$O,B$J=this._params,B$D=0,B$p=B$J.length;B$D<B$p;B$D++)B$O=B$J[B$D],(B$y.isFlash||"size"!==B$O.name)&&this._params2dQuick2.push(B$O)}return this._params2dQuick2},B$m.create=function(B$O,B$J,B$D,B$p){return new B$m(B$O,B$J,B$D,B$p)},B$m}(B$BO),B$KO=function(B$O){function B$J(B$O){this._uint8Array=null,this._uint16Array=null,void 0===B$O&&(B$O=35044),B$J.__super.call(this),this._bufferUsage=B$O,this._bufferType=34963,B$y.isFlash||(this._buffer=new ArrayBuffer(8))}B$Y(B$J,"laya.webgl.utils.IndexBuffer2D",B$SO);var B$D=B$J.prototype;return B$D._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},B$D.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},B$D.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},B$D.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},B$J.QuadrangleIB=null,B$J.create=function(B$O){return void 0===B$O&&(B$O=35044),new B$J(B$O)},B$J}(),B$fO=function(B$O){function B$D(B$O,B$J){this._floatArray32=null,this._vertexStride=0,B$D.__super.call(this),this._vertexStride=B$O,this._bufferUsage=B$J,this._bufferType=34962,B$y.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}B$Y(B$D,"laya.webgl.utils.VertexBuffer2D",B$O);var B$J=B$D.prototype;return B$J.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},B$J.bind=function(B$O){B$O&&B$O._bind(),this._bind()},B$J.insertData=function(B$O,B$J){this.getFloat32Array().set(B$O,B$J),this._upload=!0},B$J.bind_upload=function(B$O){B$O._bind_upload()||B$O._bind(),this._bind_upload()||this._bind()},B$J._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},B$J.disposeResource=function(){B$O.prototype.disposeResource.call(this)},B$J.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},B$p(0,B$J,"vertexStride",function(){return this._vertexStride}),B$D.create=function(B$O,B$J){return void 0===B$J&&(B$J=35048),new B$D(B$O,B$J)},B$D}(B$SO),B$OJ=function(B$O){function B$k(B$O,B$J,B$D,B$p,B$m,B$C){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===B$D&&(B$D=6408),void 0===B$p&&(B$p=!0),B$k.__super.call(this,B$O,B$J),B$O){if(this._format=B$D,this._mipmap=B$p,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof B$O)this._url=B$O,this._src=B$O,this._image=new B$G.window.Image,B$J&&(B$J.onload&&(this.onload=B$J.onload),B$J.onerror&&(this.onerror=B$J.onerror),B$J.onCreate&&B$J.onCreate(this)),this._image.crossOrigin=B$O&&0==B$O.indexOf("data:")?null:"",B$O&&(this._image.src=B$O);else if(B$O instanceof ArrayBuffer){this._src=B$J,this._url=this._src;var B$i=new B$_(B$O);B$i.readUTFBytes(4),B$i.readUTFBytes(2),B$i.getInt16();B$i.endian="bigEndian",this._w=B$i.getInt16(),this._h=B$i.getInt16();B$i.getInt16(),B$i.getInt16();this._image=new Uint8Array(B$O,B$i.pos),this._format=B$qO.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,B$x.enabled&&this._w<B$x.atlasLimitWidth&&this._h<B$x.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(B$O instanceof Uint8Array))return this._src=B$J,this._url=this._src,this._image=B$O.source||B$O,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=B$J,this._url=this._src,this._w=B$m,this._h=B$C,this._image=B$O,this._format=0===B$D?B$O.byteLength/(B$m*B$C)==4?6408:6407:B$D}this._$5__enableMerageInAtlas=!0}}B$Y(B$k,"laya.webgl.resource.WebGLImage",B$c);var B$J=B$k.prototype;return B$M.imps(B$J,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),B$J._init_=function(B$O,B$J){},B$J._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var B$O=B$qO.mainContext,B$J=this._source=B$O.createTexture(),B$D=B$dO.curBindTexTarget,B$p=B$dO.curBindTexValue;B$dO.bindTexture(B$O,3553,B$J);var B$m=this.minFifter,B$C=this.magFifter,B$i=this.repeat?10497:33071,B$k=B$r.isPOT(this._w,this._h),B$_=!1;switch(B$k?(this.mipmap?-1!==B$m||(B$m=9987):-1!==B$m||(B$m=9729),-1!==B$C||(B$C=9729),B$O.texParameteri(3553,10241,B$m),B$O.texParameteri(3553,10240,B$C),B$O.texParameteri(3553,10242,B$i),B$O.texParameteri(3553,10243,B$i),this.mipmap&&B$O.generateMipmap(3553)):(-1!==B$m||(B$m=9729),-1!==B$C||(B$C=9729),B$O.texParameteri(3553,10241,B$m),B$O.texParameteri(3553,10240,B$C),B$O.texParameteri(3553,10242,33071),B$O.texParameteri(3553,10243,33071)),B$O.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&B$O.pixelStorei(B$O.UNPACK_ALIGNMENT,1),B$O.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&B$O.pixelStorei(B$O.UNPACK_ALIGNMENT,1),B$O.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:B$_=!0,B$O.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case B$qO.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:B$_=!0,B$O.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}B$O.pixelStorei(37441,!1),B$D&&B$p&&B$dO.bindTexture(B$O,B$D,B$p),this.uri||(this.uri=this._url),B$_?this.memorySize=this._image.length:B$k&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},B$J.recreateResource=function(){var B$O=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var B$J=this;this._image=new B$G.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(B$J._needReleaseAgain)return B$J._needReleaseAgain=!1,B$J._image.onload=null,void(B$J._image=null);B$J._allowMerageInAtlas&&B$J._enableMerageInAtlas?(B$O.memorySize=0,B$O._recreateLock=!1):B$J._createWebGlTexture(),B$J.completeCreate()},this._image.src=this._src}},B$J.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&B$qO.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},B$J.onresize=function(){this._w=this._image.width,this._h=this._image.height,B$x.enabled&&this._w<B$x.atlasLimitWidth&&this._h<B$x.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},B$J.clearAtlasSource=function(){this._image=null},B$p(0,B$J,"format",function(){return this._format}),B$p(0,B$J,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(B$O){this._$5__enableMerageInAtlas=B$O}),B$p(0,B$J,"mipmap",function(){return this._mipmap}),B$p(0,B$J,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),B$p(0,B$J,"atlasSource",function(){return this._image}),B$p(0,B$J,"onload",null,function(B$O){var B$J=this;this._onload=B$O,this._image&&(this._image.onload=null!=this._onload?function(){B$J.onresize(),B$J._onload()}:null)}),B$p(0,B$J,"onerror",null,function(B$O){var B$J=this;this._onerror=B$O,this._image&&(this._image.onerror=null!=this._onerror?function(){B$J._onerror()}:null)}),B$k}();B$M.__init([B$GO,B$$,B$aO,B$AO])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}}),function(B$C,B$O,B$p){B$p.un,B$p.uns;var B$m=B$p.static,B$i=B$p.class,B$k=B$p.getset,B$_=(B$p.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),B$X=laya.utils.ClassUtils,B$H=(laya.events.Event,laya.utils.HTMLChar),B$L=laya.net.Loader,B$r=(laya.display.Node,laya.maths.Rectangle),B$Y=laya.renders.Render,B$G=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),B$c=laya.utils.Stat,B$R=laya.display.Text,B$h=laya.resource.Texture,B$y=laya.net.URL,B$v=laya.utils.Utils,B$A=function(){function B$G(){}return B$i(B$G,"laya.html.utils.HTMLParse"),B$G.parse=function(B$O,B$J,B$D){B$J=(B$J="<root>"+(B$J=B$J.replace(/<br>/g,"<br/>"))+"</root>").replace(B$G.spacePattern,B$G.char255);var B$p=B$v.parseXMLFromString(B$J);B$G._parseXML(B$O,B$p.childNodes[0].childNodes,B$D)},B$G._parseXML=function(B$O,B$J,B$D,B$p){var B$m=0,B$C=0;if(B$J.join||B$J.item)for(B$m=0,B$C=B$J.length;B$m<B$C;++B$m)B$G._parseXML(B$O,B$J[B$m],B$D,B$p);else{var B$i,B$k,B$_;if(3==B$J.nodeType)return void(B$O instanceof laya.html.dom.HTMLDivElement?(null==B$J.nodeName&&(B$J.nodeName="#text"),B$k=B$J.nodeName.toLowerCase(),0<(B$_=B$J.textContent.replace(/^\s+|\s+$/g,"")).length&&(B$i=B$X.getInstance(B$k))&&(B$O.addChild(B$i),B$i.innerTEXT=B$_.replace(B$G.char255AndOneSpacePattern," "))):0<(B$_=B$J.textContent.replace(/^\s+|\s+$/g,"")).length&&(B$O.innerTEXT=B$_.replace(B$G.char255AndOneSpacePattern," ")));if("#comment"==(B$k=B$J.nodeName.toLowerCase()))return;if(B$i=B$X.getInstance(B$k)){(B$i=B$O.addChild(B$i)).URI=B$D,B$i.href=B$p;var B$L=B$J.attributes;if(B$L&&0<B$L.length)for(B$m=0,B$C=B$L.length;B$m<B$C;++B$m){var B$r=B$L[B$m],B$H=B$r.nodeName,B$Y=B$r.value;B$i._setAttributes(B$H,B$Y)}B$G._parseXML(B$i,B$J.childNodes,B$D,B$i.href)}else B$G._parseXML(B$O,B$J.childNodes,B$D,B$p)}},B$G.char255=String.fromCharCode(255),B$G.spacePattern=/&nbsp;|&#160;/g,B$G.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),B$G}(),B$q=function(){function B$F(){}return B$i(B$F,"laya.html.utils.Layout"),B$F.later=function(B$O){null==B$F._will&&(B$F._will=[],B$p.stage.frameLoop(1,null,function(){if(!(B$F._will.length<1)){for(var B$O=0;B$O<B$F._will.length;B$O++)laya.html.utils.Layout.layout(B$F._will[B$O]);B$F._will.length=0}})),B$F._will.push(B$O)},B$F.layout=function(B$O){if(!B$O||!B$O._style)return null;if(0==(512&B$O._style._type))return null;B$O.getStyle()._type&=-513;var B$J=B$F._multiLineLayout(B$O);return B$Y.isConchApp&&B$O.layaoutCallNative&&B$O.layaoutCallNative(),B$J},B$F._multiLineLayout=function(B$O){if(B$R.RightToLeft)return B$F._multiLineLayout2(B$O);var B$J=new Array;B$O._addChildsToLayout(B$J);var B$D,B$p,B$m,B$C,B$i,B$k=0,B$_=B$J.length,B$L=B$O._getCSSStyle(),B$r=B$L.letterSpacing,B$H=B$L.leading,B$Y=B$L.lineHeight,B$G=B$L._widthAuto()||!B$L.wordWrap,B$X=B$G?999999:B$O.width,B$c=(B$O.height,0),B$h=B$L.italic?B$L.fontSize/3:0,B$y=B$L._getAlign(),B$v=B$L._getValign(),B$A=0!==B$v||0!==B$y||0!=B$Y,B$q=0,B$d=0,B$M=0,B$a=0,B$e=new Array,B$t=B$e[0]=new B$j,B$z=!1,B$g=!1;B$t.h=0,B$L.italic&&(B$X-=B$L.fontSize/3);var B$s=0,B$P=!0;function B$E(){B$t.y=B$d,B$d+=B$t.h+B$H,0==B$t.h&&(B$d+=B$Y),B$t.mWidth=B$s,B$s=0,B$t=new B$j,B$e.push(B$t),B$t.h=0,B$z=!(B$P=!(B$q=0))}for(B$k=0;B$k<B$_;B$k++)if(null!=(B$D=B$J[B$k]))if(B$P=!1,B$D instanceof laya.html.dom.HTMLBrElement)B$E(),B$t.y=B$d;else{if(B$D._isChar()){if((B$C=B$D).isWord)B$z=B$g||"\n"===B$C.char,B$t.wordStartIndex=B$t.elements.length;else{if(B$M=B$C.width+B$C.style.letterSpacin,0<B$e.length&&B$X<B$q+B$M&&0<B$t.wordStartIndex){var B$o;B$o=B$t.elements.length-B$t.wordStartIndex+1,B$t.elements.length=B$t.wordStartIndex,B$k-=B$o,B$E();continue}B$z=!1,B$s+=B$C.width}B$M=B$C.width+B$r,B$a=B$C.height,B$g=!1,(B$z=B$z||B$X<B$q+B$M)&&B$E(),B$t.minTextHeight=Math.min(B$t.minTextHeight,B$D.height)}else B$p=B$D._getCSSStyle(),B$i=B$D,B$m=B$p.padding,0===B$p._getCssFloat()||(B$A=!0),B$z=B$g||B$p.lineElement,B$M=B$i.width*B$i._style._tf.scaleX+B$m[1]+B$m[3]+B$r,B$a=B$i.height*B$i._style._tf.scaleY+B$m[0]+B$m[2],B$g=B$p.lineElement,(B$z=B$z||B$X<B$q+B$M&&B$p.wordWrap)&&B$E();B$t.elements.push(B$D),B$t.h=Math.max(B$t.h,B$a),B$D.x=B$q,B$D.y=B$d,B$q+=B$M,B$t.w=B$q-B$r,B$t.y=B$d,B$c=Math.max(B$q+B$h,B$c)}else B$P||(B$q+=B$F.DIV_ELEMENT_PADDING),B$t.wordStartIndex=B$t.elements.length;if(B$d=B$t.y+B$t.h,B$A){var B$W=0,B$N=B$X;for(B$G&&0<B$O.width&&(B$N=B$O.width),B$k=0,B$_=B$e.length;B$k<B$_;B$k++)B$e[B$k].updatePos(0,B$N,B$k,B$W,B$y,B$v,B$Y),B$W+=Math.max(B$Y,B$e[B$k].h+B$H);B$d=B$W}return B$G&&(B$O.width=B$c),B$d>B$O.height&&(B$O.height=B$d),[B$c,B$d]},B$F._multiLineLayout2=function(B$O){var B$J=new Array;B$O._addChildsToLayout(B$J);var B$D,B$p,B$m,B$C,B$i,B$k=0,B$_=B$J.length,B$L=B$O._getCSSStyle(),B$r=B$L.letterSpacing,B$H=B$L.leading,B$Y=B$L.lineHeight,B$G=B$L._widthAuto()||!B$L.wordWrap,B$X=B$G?999999:B$O.width,B$c=(B$O.height,0),B$h=B$L.italic?B$L.fontSize/3:0,B$y=2-B$L._getAlign(),B$v=B$L._getValign(),B$A=0!==B$v||0!=B$y||0!=B$Y,B$q=0,B$d=0,B$M=0,B$a=0,B$e=new Array,B$t=B$e[0]=new B$j,B$z=!1,B$g=!1;B$t.h=0,B$L.italic&&(B$X-=B$L.fontSize/3);var B$s=0,B$P=!0;function B$E(){B$t.y=B$d,B$d+=B$t.h+B$H,0==B$t.h&&(B$d+=B$Y),B$t.mWidth=B$s,B$s=0,B$t=new B$j,B$e.push(B$t),B$t.h=0,B$z=!(B$P=!(B$q=0))}for(B$k=0;B$k<B$_;B$k++)if(null!=(B$D=B$J[B$k]))if(B$P=!1,B$D instanceof laya.html.dom.HTMLBrElement)B$E(),B$t.y=B$d;else{if(B$D._isChar()){if((B$C=B$D).isWord)B$z=B$g||"\n"===B$C.char,B$t.wordStartIndex=B$t.elements.length;else{if(0<B$e.length&&B$X<B$q+B$M&&0<B$t.wordStartIndex){var B$o;B$o=B$t.elements.length-B$t.wordStartIndex+1,B$t.elements.length=B$t.wordStartIndex,B$k-=B$o,B$E();continue}B$z=!1,B$s+=B$C.width}B$M=B$C.width+B$r,B$a=B$C.height,B$g=!1,(B$z=B$z||B$X<B$q+B$M)&&B$E(),B$t.minTextHeight=Math.min(B$t.minTextHeight,B$D.height)}else B$p=B$D._getCSSStyle(),B$i=B$D,B$m=B$p.padding,0===B$p._getCssFloat()||(B$A=!0),B$z=B$g||B$p.lineElement,B$M=B$i.width*B$i._style._tf.scaleX+B$m[1]+B$m[3]+B$r,B$a=B$i.height*B$i._style._tf.scaleY+B$m[0]+B$m[2],B$g=B$p.lineElement,(B$z=B$z||B$X<B$q+B$M&&B$p.wordWrap)&&B$E();B$t.elements.push(B$D),B$t.h=Math.max(B$t.h,B$a),B$D.x=B$q,B$D.y=B$d,B$q+=B$M,B$t.w=B$q-B$r,B$t.y=B$d,B$c=Math.max(B$q+B$h,B$c)}else B$P||(B$q+=B$F.DIV_ELEMENT_PADDING),B$t.wordStartIndex=B$t.elements.length;if(B$d=B$t.y+B$t.h,B$A){var B$W=0,B$N=B$X;for(B$k=0,B$_=B$e.length;B$k<B$_;B$k++)B$e[B$k].updatePos(0,B$N,B$k,B$W,B$y,B$v,B$Y),B$W+=Math.max(B$Y,B$e[B$k].h+B$H);B$d=B$W}for(B$G&&(B$O.width=B$c),B$d>B$O.height&&(B$O.height=B$d),B$k=0,B$_=B$e.length;B$k<B$_;B$k++)B$e[B$k].revertOrder(B$X);return[B$c,B$d]},B$F._will=null,B$F.DIV_ELEMENT_PADDING=0,B$F}(),B$j=function(){function B$O(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}B$i(B$O,"laya.html.utils.LayoutLine");var B$J=B$O.prototype;return B$J.updatePos=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k,B$_=0;0<this.elements.length&&(B$_=(B$k=this.elements[this.elements.length-1]).x+B$k.width-this.elements[0].x);var B$L=0,B$r=NaN;1===B$m&&(B$L=(B$J-B$_)/2),2===B$m&&(B$L=B$J-B$_),0===B$i||0!=B$C||(B$C=1);for(var B$H=0,B$Y=this.elements.length;B$H<B$Y;B$H++){var B$G=(B$k=this.elements[B$H])._getCSSStyle();switch(0!==B$L&&(B$k.x+=B$L),B$G._getValign()){case 0:B$k.y=B$p;break;case 1:var B$X=0;99999!=this.minTextHeight&&(B$X=this.minTextHeight);var B$c=(B$X+B$i)/2;B$c=Math.max(B$c,this.h),B$r=(laya.html.dom.HTMLImageElement,B$p+B$c-B$k.height),B$k.y=B$r;break;case 2:B$k.y=B$p+(B$i-B$k.height)}}},B$J.revertOrder=function(B$O){var B$J;if(0<this.elements.length){var B$D,B$p=0;for(B$D=this.elements.length,B$p=0;B$p<B$D;B$p++)(B$J=this.elements[B$p]).x=B$O-B$J.x-B$J.width}},B$O}(),B$d=function(B$D){function B$J(){this.URI=null,this._href=null,B$J.__super.call(this),this._text=B$J._EMPTYTEXT,this.setStyle(new B$_(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}B$i(B$J,"laya.html.dom.HTMLElement",B$D);var B$O=B$J.prototype;return B$O.layaoutCallNative=function(){var B$O=0;if(this._childs&&0<(B$O=this._childs.length))for(var B$J=0;B$J<B$O;B$J++)this._childs[B$J].layaoutCallNative&&this._childs[B$J].layaoutCallNative();var B$D=this._getWords();B$D?laya.html.dom.HTMLElement.fillWords(this,B$D,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},B$O.appendChild=function(B$O){return this.addChild(B$O)},B$O._getWords2=function(){var B$O=this._text.text;if(!B$O||0===B$O.length)return null;var B$J,B$D,B$p=0,B$m=0;if(this._text.drawWords)B$D=this._text.drawWords;else{for(B$m=(B$J=B$O.split(" ")).length-1,B$D=[],B$p=0;B$p<B$m;B$p++)B$D.push(B$J[B$p]," ");0<=B$m&&B$D.push(B$J[B$m]),this._text.drawWords=B$D}var B$C,B$i=this._text.words;if(B$i&&B$i.length===B$D.length)return B$i;null===B$i&&(this._text.words=B$i=[]),B$i.length=B$D.length;var B$k=this.style,B$_=B$k.font;for(B$p=0,B$m=B$D.length;B$p<B$m;B$p++){B$C=B$v.measureText(B$D[B$p],B$_);var B$L=B$i[B$p]=new B$H(B$D[B$p],B$C.width,B$C.height||B$k.fontSize,B$k);if(1<B$L.char.length&&(B$L.charNum=B$L.char),this.href){var B$r=new B$G;this.addChild(B$r),B$L.setSprite(B$r)}}return B$i},B$O._getWords=function(){if(!B$R.CharacterCache)return this._getWords2();var B$O=this._text.text;if(!B$O||0===B$O.length)return null;var B$J,B$D=this._text.words;if(B$D&&B$D.length===B$O.length)return B$D;null===B$D&&(this._text.words=B$D=[]),B$D.length=B$O.length;for(var B$p=this.style,B$m=B$p.font,B$C=0,B$i=B$O.length;B$C<B$i;B$C++)if(B$J=B$v.measureText(B$O.charAt(B$C),B$m)){var B$k=B$D[B$C]=new B$H(B$O.charAt(B$C),B$J.width,B$J.height||B$p.fontSize,B$p);if(this.href){var B$_=new B$G;this.addChild(B$_),B$k.setSprite(B$_)}}else console.warn("_getWords size is null"+B$O.charAt(B$C),B$m);return B$D},B$O.showLinkSprite=function(){var B$O=this._text.words;if(B$O)for(var B$J,B$D,B$p=[],B$m=0;B$m<B$O.length;B$m++)B$D=B$O[B$m],(B$J=new B$G).graphics.drawRect(0,0,B$D.width,B$D.height,"#ff0000"),B$J.width=B$D.width,B$J.height=B$D.height,this.addChild(B$J),B$p.push(B$J)},B$O._layoutLater=function(){var B$O=this.style;512&B$O._type||(B$O.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&B$O.block?(B$q.later(this),B$O._type|=512):this.parent&&this.parent._layoutLater())},B$O._setAttributes=function(B$O,B$J){switch(B$O){case"style":return void this.style.cssText(B$J);case"class":return void(this.className=B$J)}B$D.prototype._setAttributes.call(this,B$O,B$J)},B$O.updateHref=function(){if(null!=this._href){var B$O=this._getWords();if(B$O)for(var B$J,B$D,B$p=0;B$p<B$O.length;B$p++)(B$D=(B$J=B$O[B$p]).getSprite())&&(B$D.size(B$J.width,B$J.height),B$D.on("click",this,this.onLinkHandler))}},B$O.onLinkHandler=function(B$O){switch(B$O.type){case"click":for(var B$J=this;B$J;)B$J.event("link",[this.href]),B$J=B$J.parent}},B$O.formatURL=function(B$O){return this.URI?B$y.formatURL(B$O,this.URI?this.URI.path:null):B$O},B$k(0,B$O,"href",function(){return this._href},function(B$O){null!=(this._href=B$O)&&(this._getCSSStyle().underLine=1,this.updateHref())}),B$k(0,B$O,"color",null,function(B$O){this.style.color=B$O}),B$k(0,B$O,"onClick",null,function(B$O){B$p._runScript("fn=function(event){"+B$O+";}"),this.on("click",this,void 0)}),B$k(0,B$O,"id",null,function(B$O){B$M.document.setElementById(B$O,this)}),B$k(0,B$O,"innerTEXT",function(){return this._text.text},function(B$O){this.text=B$O}),B$k(0,B$O,"style",function(){return this._style}),B$k(0,B$O,"text",function(){return this._text.text},function(B$O){this._text==B$J._EMPTYTEXT?this._text={text:B$O,words:null}:(this._text.text=B$O,this._text.words&&(this._text.words.length=0)),B$Y.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),B$k(0,B$O,"parent",B$D.prototype._$get_parent,function(B$O){if(B$O instanceof laya.html.dom.HTMLElement){var B$J=B$O;this.URI||(this.URI=B$J.URI),this.style.inherit(B$J.style)}B$p.superSet(B$G,this,"parent",B$O)}),B$k(0,B$O,"className",null,function(B$O){this.style.attrs(B$M.document.styleSheets["."+B$O])}),B$J.fillWords=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$O.graphics.clear();for(var B$k=0,B$_=B$J.length;B$k<B$_;B$k++){var B$L=B$J[B$k];B$O.graphics.fillText(B$L.char,B$L.x+B$D,B$L.y+B$p,B$m,B$C,"left",B$i)}},B$J._EMPTYTEXT={text:null,words:null},B$J}(B$G),B$J=(function(B$O){function B$J(){B$J.__super.call(this),this.style.lineElement=!0,this.style.block=!0}B$i(B$J,"laya.html.dom.HTMLBrElement",B$d)}(),function(B$O){function B$J(){this.contextHeight=NaN,this.contextWidth=NaN,B$J.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}B$i(B$J,"laya.html.dom.HTMLDivElement",B$O);var B$D=B$J.prototype;return B$D.appendHTML=function(B$O){B$A.parse(this,B$O,this.URI),this.layout()},B$D._addChildsToLayout=function(B$J){var B$O=this._getWords();if(null==B$O&&0==this._childs.length)return!1;B$O&&B$O.forEach(function(B$O){B$J.push(B$O)});for(var B$D=!0,B$p=0,B$m=this._childs.length;B$p<B$m;B$p++){var B$C=this._childs[B$p];B$D?B$D=!1:B$J.push(null),B$C._addToLayout(B$J)}return!0},B$D._addToLayout=function(B$O){this.layout()},B$D.layout=function(){if(this.style){this.style._type|=512;var B$O=B$q.layout(this);if(B$O){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new B$r);var B$J=this._$P.mHtmlBounds;B$J.x=B$J.y=0,B$J.width=this.contextWidth=B$O[0],B$J.height=this.contextHeight=B$O[1],this.setBounds(B$J)}}},B$k(0,B$D,"height",function(){return this._height?this._height:this.contextHeight},B$O.prototype._$set_height),B$k(0,B$D,"innerHTML",null,function(B$O){this.destroyChildren(),this.appendHTML(B$O)}),B$k(0,B$D,"width",function(){return this._width?this._width:this.contextWidth},function(B$O){var B$J=!1;B$J=0===B$O?B$O!=this._width:B$O!=this.width,B$p.superSet(B$d,this,"width",B$O),B$J&&this.layout()}),B$J}(B$d)),B$M=function(B$O){function B$J(){this.all=new Array,this.styleSheets=B$_.styleSheets,B$J.__super.call(this)}B$i(B$J,"laya.html.dom.HTMLDocument",B$d);var B$D=B$J.prototype;return B$D.getElementById=function(B$O){return this.all[B$O]},B$D.setElementById=function(B$O,B$J){this.all[B$O]=B$J},B$m(B$J,["document",function(){return this.document=new B$J}]),B$J}();(function(B$O){function B$J(){this._tex=null,this._url=null,this._renderArgs=[],B$J.__super.call(this),this.style.block=!0}B$i(B$J,"laya.html.dom.HTMLImageElement",B$d);var B$D=B$J.prototype;B$D._addToLayout=function(B$O){!this._style.absolute&&B$O.push(this)},B$D.render=function(B$O,B$J,B$D){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(B$c.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,B$O.ctx.drawTexture2(B$J,B$D,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},B$D.layaoutCallNative=function(){var B$O=0;if(this._childs&&0<(B$O=this._childs.length))for(var B$J=0;B$J<B$O;B$J++)this._childs[B$J].layaoutCallNative&&this._childs[B$J].layaoutCallNative()},B$k(0,B$D,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(B$O){this._width!==B$O&&(this._width=B$O,this._style.width=B$O,this.repaint())}),B$k(0,B$D,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(B$O){this._height!==B$O&&(this._height=B$O,this._style.height=B$O,this.repaint())}),B$D.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),B$L.clearCache(this,this._url),this._tex=null),B$d.prototype.destroy.call(this)},B$D.onloaded=function(){var B$O=this._style;B$O&&!B$O.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),B$O&&!B$O.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),B$Y.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},B$D._loadImageComplete=function(B$O,B$J,B$D){if(!this._destroyed)if(null!=B$D)if(B$D instanceof ArrayBuffer){var B$p=new DataView(B$D);new laya.webgl.resource.WebGLImage(new Uint8Array(B$D,8),B$O,0,!1,B$p.getUint32(0),B$p.getUint32(4));this.onloaded()}else if(B$D instanceof B$h)B$L.imgMgrSet[B$O]=B$J,B$C.imgMgrLock(B$O,B$L.imgMgrSet[B$O]),this._url=B$O,this._tex=B$D,B$L.keepCache(this,B$O),B$L.cacheRes(B$O,this._tex),this.onloaded();else{var B$m=-1!=B$O.indexOf(".png",B$O.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(B$D,B$O,B$m,!1,B$D.width,B$D.height);this.onloaded()}else this.event("error","Load image failed")},B$k(0,B$D,"src",null,function(B$O){(B$O=this.formatURL(B$O),this._url!=B$O)&&(null!=this._tex&&(B$L.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=B$O,(this._tex=B$L.getRes(B$O))?(B$L.keepCache(this,B$O),this.onloaded()):B$C.imgMgrLoad(B$O,this._loadImageComplete.bind(this),2,!1))})})(),function(B$O){function B$J(){this.type=null,B$J.__super.call(this),this.visible=!1}B$i(B$J,"laya.html.dom.HTMLLinkElement",B$O);var B$D=B$J.prototype;B$D._onload=function(B$O){switch(this.type){case"text/css":B$_.parseCSS(B$O,this.URI)}},B$k(0,B$D,"href",B$O.prototype._$get_href,function(B$O){var B$J=this;B$O=this.formatURL(B$O),this.URI=new B$y(B$O);var B$D=new B$L;B$D.once("complete",null,function(B$O){B$J._onload(B$O)}),B$D.load(B$O,"text")}),B$J._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(B$d),function(B$O){function B$J(){B$J.__super.call(this),this.visible=!1}B$i(B$J,"laya.html.dom.HTMLStyleElement",B$O),B$k(0,B$J.prototype,"text",B$O.prototype._$get_text,function(B$O){B$_.parseCSS(B$O,null)})}(B$d),function(B$O){function B$J(){B$J.__super.call(this),this._getCSSStyle().valign="middle"}B$i(B$J,"laya.html.dom.HTMLIframeElement",B$O),B$k(0,B$J.prototype,"href",B$O.prototype._$get_href,function(B$D){var B$p=this;B$D=this.formatURL(B$D);var B$O=new B$L;B$O.once("complete",null,function(B$O){var B$J=B$p.URI;B$p.URI=new B$y(B$D),B$p.innerHTML=B$O,!B$J||(B$p.URI=B$J)}),B$O.load(B$D,"text")})}(B$J)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}}),function(B$m,B$O,B$c){B$c.un,B$c.uns;var B$p=B$c.static,B$C=B$c.class,B$i=B$c.getset,B$D=(B$c.__newvec,laya.display.Animation),B$h=(laya.utils.Browser,laya.utils.ClassUtils),B$k=laya.filters.ColorFilter,B$_=laya.utils.Ease,B$L=laya.events.Event,B$r=(laya.events.EventDispatcher,laya.display.css.Font),B$H=laya.display.FrameAnimation,B$J=laya.display.Graphics,B$Y=laya.utils.Handler,B$G=laya.display.Input,B$v=laya.net.Loader,B$X=(laya.display.Node,laya.maths.Point),B$y=laya.maths.Rectangle,B$A=laya.renders.Render,B$q=laya.display.Sprite,B$d=laya.display.Text,B$M=laya.resource.Texture,B$a=laya.utils.Tween,B$e=laya.utils.Utils,B$t=laya.utils.WeakObject;B$c.interface("laya.ui.IItem"),B$c.interface("laya.ui.ISelect"),B$c.interface("laya.ui.IRender"),B$c.interface("laya.ui.IComponent"),B$c.interface("laya.ui.IBox","IComponent");var B$z=function(){function B$O(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return B$C(B$O,"laya.ui.LayoutStyle"),B$p(B$O,["EMPTY",function(){return this.EMPTY=new B$O}]),B$O}(),B$g=function(){function B$O(){}return B$C(B$O,"laya.ui.Styles"),B$O.labelColor="#000000",B$O.buttonStateNum=3,B$O.scrollBarMinNum=15,B$O.scrollBarDelayTime=500,B$p(B$O,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),B$O}(),B$s=function(){function B$m(){}return B$C(B$m,"laya.ui.UIUtils"),B$m.fillArray=function(B$O,B$J,B$D){var B$p=B$O.concat();if(B$J)for(var B$m=B$J.split(","),B$C=0,B$i=Math.min(B$p.length,B$m.length);B$C<B$i;B$C++){var B$k=B$m[B$C];B$p[B$C]="true"==B$k||"false"!=B$k&&B$k,null!=B$D&&(B$p[B$C]=B$D(B$k))}return B$p},B$m.toColor=function(B$O){return B$e.toHexColor(B$O)},B$m.gray=function(B$O,B$J){void 0===B$J&&(B$J=!0),B$J?B$m.addFilter(B$O,B$m.grayFilter):B$m.clearFilter(B$O,B$k)},B$m.addFilter=function(B$O,B$J){var B$D=B$O.filters||[];B$D.push(B$J),B$O.filters=B$D},B$m.clearFilter=function(B$O,B$J){var B$D=B$O.filters;if(null!=B$D&&0<B$D.length){for(var B$p=B$D.length-1;-1<B$p;B$p--){var B$m=B$D[B$p];B$c.__typeof(B$m,B$J)&&B$D.splice(B$p,1)}B$O.filters=B$D}},B$m._getReplaceStr=function(B$O){return B$m.escapeSequence[B$O]},B$m.adptString=function(B$O){return B$O.replace(/\\(\w)/g,B$m._getReplaceStr)},B$m.getBindFun=function(B$O){var B$J=B$m._funMap.get(B$O);if(null==B$J){var B$D='"'+B$O+'"',B$p="(function(data){if(data==null)return;with(data){try{\nreturn "+(B$D=B$D.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";B$J=B$c._runScript(B$p),B$m._funMap.set(B$O,B$J)}return B$J},B$p(B$m,["grayFilter",function(){return this.grayFilter=new B$k([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new B$t}]),B$m}(),B$P=function(){function B$O(){}return B$C(B$O,"UIConfig"),B$O.touchScrollEnable=!0,B$O.mouseWheelEnable=!0,B$O.showButtons=!0,B$O.popupBgColor="#000000",B$O.popupBgAlpha=.5,B$O.closeDialogOnSide=!0,B$O}(),B$E=function(B$D){function B$y(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,B$y.__super.call(this),this._weakKeys=[]}B$C(B$y,"laya.ui.AutoBitmap",B$D);var B$O=B$y.prototype;return B$O.destroy=function(){if(B$v.clearObject(this,this._weakKey),this._weakKeys){for(var B$O=0,B$J=this._weakKeys.length;B$O<B$J;++B$O)B$v.clearObject(this,this._weakKeys[B$O]);this._weakKeys=null}B$D.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},B$O._setChanged=function(){this._isChanged||(this._isChanged=!0,B$c.timer.callLater(this,this.changeSource))},B$O.changeSource=function(){this._isChanged=!1;var B$O=this._source;if(B$O&&B$O.bitmap){var B$J=this.width,B$D=this.height,B$p=this._sizeGrid,B$m=B$O.sourceWidth,B$C=B$O.sourceHeight;if(!B$p||B$m===B$J&&B$C===B$D)this.cleanByTexture(B$O,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,B$J,B$D);else{B$v.clearObject(this,this._weakKey),B$O.$_GID||(B$O.$_GID=B$e.getGID());var B$i=B$O.$_GID+"."+B$J+"."+B$D+"."+B$p.join("."),B$k=B$v.findObject(B$i);if(B$e.isOKCmdList(B$k))return this._weakKey=B$i,B$v.keepObject(this,this._weakKey),void(this.cmds=B$k);this.clear();var B$_,B$L,B$r=B$p[0],B$H=B$p[1],B$Y=B$p[2],B$G=B$p[3],B$X=B$p[4],B$c=!1;if(B$J==B$m&&(B$G=B$H=0),B$D==B$C&&(B$r=B$Y=0),B$J<B$G+B$H){var B$h=B$J;B$c=!0,B$J=B$G+B$H,this.save(),this.clipRect(0,0,B$h,B$D)}B$G&&B$r&&(B$_=B$y.getTexture(B$O,0,0,B$G,B$r),B$L=this._weakKeys[0],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[0]=B$_.weakKey),this.drawTexture(B$_,0,0,B$G,B$r)):(B$v.clearObject(this,B$L),this._weakKeys[0]="")),B$H&&B$r&&(B$_=B$y.getTexture(B$O,B$m-B$H,0,B$H,B$r),B$L=this._weakKeys[1],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[1]=B$_.weakKey),this.drawTexture(B$_,B$J-B$H,0,B$H,B$r)):(B$v.clearObject(this,B$L),this._weakKeys[1]="")),B$G&&B$Y&&(B$_=B$y.getTexture(B$O,0,B$C-B$Y,B$G,B$Y),B$L=this._weakKeys[2],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[2]=B$_.weakKey),this.drawTexture(B$_,0,B$D-B$Y,B$G,B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[2]="")),B$H&&B$Y&&(B$_=B$y.getTexture(B$O,B$m-B$H,B$C-B$Y,B$H,B$Y),B$L=this._weakKeys[3],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[3]=B$_.weakKey),this.drawTexture(B$_,B$J-B$H,B$D-B$Y,B$H,B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[3]="")),B$r&&(B$_=B$y.getTexture(B$O,B$G,0,B$m-B$G-B$H,B$r),B$L=this._weakKeys[4],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[4]=B$_.weakKey),this.drawBitmap(B$X,B$_,B$G,0,B$J-B$G-B$H,B$r)):(B$v.clearObject(this,B$L),this._weakKeys[4]="")),B$Y&&(B$_=B$y.getTexture(B$O,B$G,B$C-B$Y,B$m-B$G-B$H,B$Y),B$L=this._weakKeys[5],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[5]=B$_.weakKey),this.drawBitmap(B$X,B$_,B$G,B$D-B$Y,B$J-B$G-B$H,B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[5]="")),B$G&&(B$_=B$y.getTexture(B$O,0,B$r,B$G,B$C-B$r-B$Y),B$L=this._weakKeys[6],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[6]=B$_.weakKey),this.drawBitmap(B$X,B$_,0,B$r,B$G,B$D-B$r-B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[6]="")),B$H&&(B$_=B$y.getTexture(B$O,B$m-B$H,B$r,B$H,B$C-B$r-B$Y),B$L=this._weakKeys[7],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[7]=B$_.weakKey),this.drawBitmap(B$X,B$_,B$J-B$H,B$r,B$H,B$D-B$r-B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[7]="")),B$_=B$y.getTexture(B$O,B$G,B$r,B$m-B$G-B$H,B$C-B$r-B$Y),B$L=this._weakKeys[8],B$_?(B$L!=B$_.weakKey&&(B$v.clearObject(this,B$L),B$v.keepObject(this,B$_.weakKey),this._weakKeys[8]=B$_.weakKey),this.drawBitmap(B$X,B$_,B$G,B$r,B$J-B$G-B$H,B$D-B$r-B$Y)):(B$v.clearObject(this,B$L),this._weakKeys[8]=""),B$c&&this.restore(),this.autoCacheCmd&&!B$A.isConchApp&&(B$v.saveObject(B$i,this.cmds,null),this._weakKey=B$i,B$v.keepObject(this,this._weakKey))}this._repaint()}},B$O.drawBitmap=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=0),B$m<.1||B$C<.1||(!B$O||B$J.width==B$m&&B$J.height==B$C?this.drawTexture(B$J,B$D,B$p,B$m,B$C):this.fillTexture(B$J,B$D,B$p,B$m,B$C))},B$O.clear=function(B$O){void 0===B$O&&(B$O=!0),B$D.prototype.clear.call(this,!1)},B$i(0,B$O,"sizeGrid",function(){return this._sizeGrid},function(B$O){this._sizeGrid=B$O,this._setChanged()}),B$i(0,B$O,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(B$O){this._width!=B$O&&(this._width=B$O,this._setChanged())}),B$i(0,B$O,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(B$O){this._height!=B$O&&(this._height=B$O,this._setChanged())}),B$i(0,B$O,"source",function(){return this._source},function(B$O){B$O?(this._source=B$O,this._setChanged()):(this._source=null,this.clear())}),B$y.getTexture=function(B$O,B$J,B$D,B$p,B$m){B$p<=0&&(B$p=1),B$m<=0&&(B$m=1),B$O.$_GID||(B$O.$_GID=B$e.getGID());var B$C=B$O.$_GID+"."+B$J+"."+B$D+"."+B$p+"."+B$m,B$i=B$v.findObject(B$C);if((!B$i||!B$i.source)&&(B$i=B$M.createFromTexture(B$O,B$J,B$D,B$p,B$m))){if(B$O.alphaTexture){var B$k=B$O.width/B$O.alphaTexture.width;B$i.alphaTexture=B$M.createFromTexture(B$O.alphaTexture,B$J/B$k,B$D/B$k,B$p/B$k,B$m/B$k)}B$v.saveObject(B$C,B$i),B$i.weakKey=B$C}return B$i},B$y}(B$J),B$o=(function(B$O){function B$J(){B$J.__super.call(this)}B$C(B$J,"laya.ui.UIEvent",B$L),B$J.SHOW_TIP="showtip",B$J.HIDE_TIP="hidetip"}(),function(B$J){function B$O(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,B$O.__super.call(this),this._layout=B$z.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}B$C(B$O,"laya.ui.Component",B$J);var B$D=B$O.prototype;return B$c.imps(B$D,{"laya.ui.IComponent":!0}),B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},B$D.preinitialize=function(){},B$D.createChildren=function(){},B$D.initialize=function(){},B$D.callLater=function(B$O,B$J){B$c.timer.callLater(this,B$O,B$J)},B$D.runCallLater=function(B$O){B$c.timer.runCallLater(this,B$O)},B$D.commitMeasure=function(){},B$D.changeSize=function(){this.event("resize")},B$D.getLayout=function(){return this._layout===B$z.EMPTY&&(this._layout=new B$z),this._layout},B$D._setLayoutEnabled=function(B$O){this._layout&&this._layout.enable!=B$O&&(this._layout.enable=B$O,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},B$D.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},B$D.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},B$D.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},B$D.resetLayoutX=function(){var B$O=this._layout;if(isNaN(B$O.anchorX)||(this.pivotX=B$O.anchorX*this.width),this.layoutEnabled){var B$J=this.parent;B$J&&(isNaN(B$O.centerX)?isNaN(B$O.left)?isNaN(B$O.right)||(this.x=Math.round(B$J.width-this.displayWidth-B$O.right+this.pivotX*this.scaleX)):(this.x=Math.round(B$O.left+this.pivotX*this.scaleX),isNaN(B$O.right)||(this.width=(B$J._width-B$O.left-B$O.right)/(this.scaleX||.01))):this.x=Math.round(.5*(B$J.width-this.displayWidth)+B$O.centerX+this.pivotX*this.scaleX))}},B$D.resetLayoutY=function(){var B$O=this._layout;if(isNaN(B$O.anchorY)||(this.pivotY=B$O.anchorY*this.height),this.layoutEnabled){var B$J=this.parent;B$J&&(isNaN(B$O.centerY)?isNaN(B$O.top)?isNaN(B$O.bottom)||(this.y=Math.round(B$J.height-this.displayHeight-B$O.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(B$O.top+this.pivotY*this.scaleY),isNaN(B$O.bottom)||(this.height=(B$J._height-B$O.top-B$O.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(B$J.height-this.displayHeight)+B$O.centerY+this.pivotY*this.scaleY))}},B$D.onMouseOver=function(B$O){B$c.stage.event("showtip",this._toolTip)},B$D.onMouseOut=function(B$O){B$c.stage.event("hidetip",this._toolTip)},B$i(0,B$D,"displayWidth",function(){return this.width*this.scaleX}),B$i(0,B$D,"width",function(){return this._width?this._width:this.measureWidth},function(B$O){this._width!=B$O&&(this._width=B$O,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),B$i(0,B$D,"measureWidth",function(){var B$O=0;this.commitMeasure();for(var B$J=this.numChildren-1;-1<B$J;B$J--){var B$D=this.getChildAt(B$J);B$D.visible&&(B$O=Math.max(B$D.x+B$D.width*B$D.scaleX,B$O))}return B$O}),B$i(0,B$D,"displayHeight",function(){return this.height*this.scaleY}),B$i(0,B$D,"height",function(){return this._height?this._height:this.measureHeight},function(B$O){this._height!=B$O&&(this._height=B$O,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),B$i(0,B$D,"dataSource",function(){return this._dataSource},function(B$O){for(var B$J in this._dataSource=B$O,this._dataSource)this.hasOwnProperty(B$J)&&"function"!=typeof this[B$J]&&(this[B$J]=this._dataSource[B$J])}),B$i(0,B$D,"scaleY",B$J.prototype._$get_scaleY,function(B$O){B$c.superGet(B$q,this,"scaleY")!=B$O&&(B$c.superSet(B$q,this,"scaleY",B$O),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),B$i(0,B$D,"measureHeight",function(){var B$O=0;this.commitMeasure();for(var B$J=this.numChildren-1;-1<B$J;B$J--){var B$D=this.getChildAt(B$J);B$D.visible&&(B$O=Math.max(B$D.y+B$D.height*B$D.scaleY,B$O))}return B$O}),B$i(0,B$D,"scaleX",B$J.prototype._$get_scaleX,function(B$O){B$c.superGet(B$q,this,"scaleX")!=B$O&&(B$c.superSet(B$q,this,"scaleX",B$O),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),B$i(0,B$D,"top",function(){return this._layout.top},function(B$O){B$O!=this._layout.top&&(this.getLayout().top=B$O,this._setLayoutEnabled(!0)),this.resetLayoutY()}),B$i(0,B$D,"bottom",function(){return this._layout.bottom},function(B$O){B$O!=this._layout.bottom&&(this.getLayout().bottom=B$O,this._setLayoutEnabled(!0)),this.resetLayoutY()}),B$i(0,B$D,"left",function(){return this._layout.left},function(B$O){B$O!=this._layout.left&&(this.getLayout().left=B$O,this._setLayoutEnabled(!0)),this.resetLayoutX()}),B$i(0,B$D,"right",function(){return this._layout.right},function(B$O){B$O!=this._layout.right&&(this.getLayout().right=B$O,this._setLayoutEnabled(!0)),this.resetLayoutX()}),B$i(0,B$D,"centerX",function(){return this._layout.centerX},function(B$O){B$O!=this._layout.centerX&&(this.getLayout().centerX=B$O,this._setLayoutEnabled(!0)),this.resetLayoutX()}),B$i(0,B$D,"centerY",function(){return this._layout.centerY},function(B$O){B$O!=this._layout.centerY&&(this.getLayout().centerY=B$O,this._setLayoutEnabled(!0)),this.resetLayoutY()}),B$i(0,B$D,"anchorX",function(){return this._layout.anchorX},function(B$O){B$O!=this._layout.anchorX&&(this.getLayout().anchorX=B$O,this._setLayoutEnabled(!0)),this.resetLayoutX()}),B$i(0,B$D,"anchorY",function(){return this._layout.anchorY},function(B$O){B$O!=this._layout.anchorY&&(this.getLayout().anchorY=B$O,this._setLayoutEnabled(!0)),this.resetLayoutY()}),B$i(0,B$D,"tag",function(){return this._tag},function(B$O){this._tag=B$O}),B$i(0,B$D,"toolTip",function(){return this._toolTip},function(B$O){this._toolTip!=B$O&&(null!=(this._toolTip=B$O)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),B$i(0,B$D,"comXml",function(){return this._comXml},function(B$O){this._comXml=B$O}),B$i(0,B$D,"gray",function(){return this._gray},function(B$O){B$O!==this._gray&&(this._gray=B$O,B$s.gray(this,B$O))}),B$i(0,B$D,"disabled",function(){return this._disabled},function(B$O){B$O!==this._disabled&&(this.gray=this._disabled=B$O,this.mouseEnabled=!B$O)}),B$O}(B$q)),B$W=function(B$O){function B$J(){this.lockLayer=null,this.popupEffect=function(B$O){B$O.scale(1,1),B$a.from(B$O,{x:B$c.stage.width/2,y:B$c.stage.height/2,scaleX:0,scaleY:0},300,B$_.backOut,B$Y.create(this,this.doOpen,[B$O]))},this.closeEffect=function(B$O,B$J){B$a.to(B$O,{x:B$c.stage.width/2,y:B$c.stage.height/2,scaleX:0,scaleY:0},300,B$_.strongOut,B$Y.create(this,this.doClose,[B$O,B$J]))},B$J.__super.call(this),this.maskLayer=new B$q,this.popupEffectHandler=B$Y.create(this,this.popupEffect,null,!1),this.closeEffectHandler=B$Y.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,B$c.stage.addChild(this),B$c.stage.on("resize",this,this._onResize),B$P.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}B$C(B$J,"laya.ui.DialogManager",B$q);var B$D=B$J.prototype;return B$D._closeOnSide=function(){var B$O=this.getChildAt(this.numChildren-1);B$O instanceof laya.ui.Dialog&&B$O.close("side")},B$D.setLockView=function(B$O){this.lockLayer||(this.lockLayer=new B$N,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(B$c.stage.width,B$c.stage.height)),this.lockLayer.removeChildren(),B$O&&(B$O.centerX=B$O.centerY=0,this.lockLayer.addChild(B$O))},B$D._onResize=function(B$O){var B$J=this.maskLayer.width=B$c.stage.width,B$D=this.maskLayer.height=B$c.stage.height;this.lockLayer&&this.lockLayer.size(B$J,B$D),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,B$J,B$D,B$P.popupBgColor),this.maskLayer.alpha=B$P.popupBgAlpha;for(var B$p=this.numChildren-1;-1<B$p;B$p--){var B$m=this.getChildAt(B$p);B$m.popupCenter&&this._centerDialog(B$m)}},B$D._centerDialog=function(B$O){B$O.x=Math.round((B$c.stage.width-B$O.width>>1)+B$O.pivotX),B$O.y=Math.round((B$c.stage.height-B$O.height>>1)+B$O.pivotY)},B$D.open=function(B$O,B$J,B$D){void 0===B$J&&(B$J=!1),void 0===B$D&&(B$D=!1),B$J&&this._closeAll(),B$O.popupCenter&&this._centerDialog(B$O),this.addChild(B$O),(B$O.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),B$D&&null!=B$O.popupEffect?B$O.popupEffect.runWith(B$O):this.doOpen(B$O),this.event("open")},B$D.doOpen=function(B$O){B$O.onOpened()},B$D.lock=function(B$O){this.lockLayer&&(B$O?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},B$D.close=function(B$O,B$J,B$D){void 0===B$D&&(B$D=!1),B$D&&null!=B$O.closeEffect?B$O.closeEffect.runWith([B$O,B$J]):this.doClose(B$O,B$J),this.event("close")},B$D.doClose=function(B$O,B$J){B$O.removeSelf(),B$O.isModal&&this._checkMask(),B$O.closeHandler&&B$O.closeHandler.runWith(B$J),B$O.onClosed(B$J)},B$D.closeAll=function(){this._closeAll(),this.event("close")},B$D._closeAll=function(){for(var B$O=this.numChildren-1;-1<B$O;B$O--){var B$J=this.getChildAt(B$O);B$J&&null!=B$J.close&&this.doClose(B$J)}},B$D.getDialogsByGroup=function(B$O){for(var B$J=[],B$D=this.numChildren-1;-1<B$D;B$D--){var B$p=this.getChildAt(B$D);B$p&&B$p.group===B$O&&B$J.push(B$p)}return B$J},B$D.closeByGroup=function(B$O){for(var B$J=[],B$D=this.numChildren-1;-1<B$D;B$D--){var B$p=this.getChildAt(B$D);B$p&&B$p.group===B$O&&(B$p.close(),B$J.push(B$p))}return B$J},B$D._checkMask=function(){this.maskLayer.removeSelf();for(var B$O=this.numChildren-1;-1<B$O;B$O--){var B$J=this.getChildAt(B$O);if(B$J&&B$J.isModal)return void this.addChildAt(this.maskLayer,B$O)}},B$J}(),B$N=function(B$O){function B$J(){B$J.__super.call(this)}B$C(B$J,"laya.ui.Box",B$O);var B$D=B$J.prototype;return B$c.imps(B$D,{"laya.ui.IBox":!0}),B$i(0,B$D,"dataSource",B$O.prototype._$get_dataSource,function(B$O){for(var B$J in this._dataSource=B$O){var B$D=this.getChildByName(B$J);B$D?B$D.dataSource=B$O[B$J]:this.hasOwnProperty(B$J)&&"function"!=typeof this[B$J]&&(this[B$J]=B$O[B$J])}}),B$J}(B$o),B$F=function(B$J){function B$D(B$O,B$J){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,B$D.__super.call(this),this._labelColors=B$g.buttonLabelColors,this._stateNum=B$g.buttonStateNum,void 0===B$J&&(B$J=""),this.skin=B$O,this.label=B$J}B$C(B$D,"laya.ui.Button",B$J);var B$O=B$D.prototype;return B$c.imps(B$O,{"laya.ui.ISelect":!0}),B$O.destroy=function(B$O){this.clearEvent(),B$v.clearCache(this,this._skin),B$v.clearObject(this,this._weakKey),void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(B$O),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},B$O.clearEvent=function(){this._skin&&B$m.atalsNotify&&B$m.atalsNotify.off(this._skin,this,this._setBtnSource)},B$O.createChildren=function(){this.graphics=this._bitmap=new B$E},B$O.createText=function(){this._text||(this._text=new B$d,this._text.overflow=B$d.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},B$O.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},B$O.onMouse=function(B$O){if(!1!==this.toggle||!this._selected)return"click"===B$O.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=B$D.stateMap[B$O.type]))},B$O.changeClips=function(){var B$O=B$v.getRes(this._skin);if(B$O)if(this._skin&&""!=this._skin){B$v.clearObject(this,this._weakKey);var B$J=B$O.sourceWidth,B$D=B$O.sourceHeight/this._stateNum;B$O.$_GID||(B$O.$_GID=B$e.getGID());var B$p=B$O.$_GID+"-"+this._stateNum,B$m=B$v.findObject(B$p);if(B$e.isOkTextureList(B$m)||(B$m=null),B$m)this._weakKey=B$p,B$v.keepObject(this,this._weakKey),this._sources=B$m;else{if(this._sources=[],1===this._stateNum)this._sources.push(B$O);else for(var B$C=0;B$C<this._stateNum;B$C++){var B$i=B$M.createFromTexture(B$O,0,B$D*B$C,B$J,B$D);if(B$O.alphaTexture){var B$k=B$O.width/B$O.alphaTexture.width;B$i.alphaTexture=B$M.createFromTexture(B$O.alphaTexture,0/B$k,B$D*B$C/B$k,B$J/B$k,B$D/B$k)}this._sources.push(B$i)}B$v.saveObject(B$p,this._sources),this._weakKey=B$p,B$v.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||B$J,this._bitmap.height=this._height||B$D,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=B$J)}else console.warn("lose skin ",this._skin,this.name,this.__className)},B$O.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var B$O=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[B$O]),this.label&&(this._text.color=this._labelColors[B$O],this._strokeColors&&(this._text.strokeColor=this._strokeColors[B$O]))},B$O._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},B$i(0,B$O,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(B$O){this.createText(),this._text.strokeColor=B$O}),B$i(0,B$O,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){if(this._skin!=B$O)if(this.clearEvent(),B$v.clearCache(this,this._skin),this._skin=B$O,B$v.keepCache(this,this._skin),B$v.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var B$J=B$m.resAtalsObj&&B$m.resAtalsObj[this._skin];B$J?(B$m.atalsNotify&&B$m.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=B$J.sourceW),0==this.height&&(this.height=B$J.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),B$O._setBtnSource=function(B$O,B$J){B$O===this._skin&&B$J&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},B$i(0,B$O,"state",function(){return this._state},function(B$O){this._state!=B$O&&(this._state=B$O,this._setStateChanged())}),B$i(0,B$O,"text",function(){return this.createText(),this._text}),B$i(0,B$O,"stateNum",function(){return this._stateNum},function(B$O){"string"==typeof B$O&&(B$O=parseInt(B$O)),this._stateNum!=B$O&&(this._stateNum=B$O<1?1:3<B$O?3:B$O,this.callLater(this.changeClips))}),B$i(0,B$O,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(B$O){this._strokeColors=B$s.fillArray(B$g.buttonLabelColors,B$O,String),this._setStateChanged()}),B$i(0,B$O,"labelColors",function(){return this._labelColors.join(",")},function(B$O){this._labelColors=B$s.fillArray(B$g.buttonLabelColors,B$O,String),this._setStateChanged()}),B$i(0,B$O,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),B$i(0,B$O,"label",function(){return this._text?this._text.text:null},function(B$O){(this._text||B$O)&&(this.createText(),this._text.text!=B$O&&(B$O&&!this._text.parent&&this.addChild(this._text),this._text.text=(B$O+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),B$i(0,B$O,"selected",function(){return this._selected},function(B$O){this._selected!=B$O&&(this._selected=B$O,this.state=this._selected?2:0,this.event("change"))}),B$i(0,B$O,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(B$O){this.createText(),this._text.padding=B$s.fillArray(B$g.labelPadding,B$O,Number)}),B$i(0,B$O,"labelSize",function(){return this.createText(),this._text.fontSize},function(B$O){this.createText(),this._text.fontSize=B$O}),B$i(0,B$O,"labelStroke",function(){return this.createText(),this._text.stroke},function(B$O){this.createText(),this._text.stroke=B$O}),B$i(0,B$O,"labelBold",function(){return this.createText(),this._text.bold},function(B$O){this.createText(),this._text.bold=B$O}),B$i(0,B$O,"labelFont",function(){return this.createText(),this._text.font},function(B$O){this.createText(),this._text.font=B$O}),B$i(0,B$O,"labelAlign",function(){return this.createText(),this._text.align},function(B$O){this.createText(),this._text.align=B$O}),B$i(0,B$O,"clickHandler",function(){return this._clickHandler},function(B$O){this._clickHandler=B$O}),B$i(0,B$O,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(B$O){this._bitmap.sizeGrid=B$s.fillArray(B$g.defaultSizeGrid,B$O,Number)}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$o,this,"width",B$O),this._autoSize&&(this._bitmap.width=B$O,this._text&&(this._text.width=B$O))}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$o,this,"height",B$O),this._autoSize&&(this._bitmap.height=B$O,this._text&&(this._text.height=B$O))}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)||"string"==typeof B$O?this.label=B$O+"":B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(B$O){this._bitmap._offset=B$O?B$s.fillArray([1,1],B$O,Number):[]}),B$p(B$D,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),B$D}(B$o),B$R=function(B$J){function B$p(B$O,B$J,B$D){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,B$p.__super.call(this),void 0===B$J&&(B$J=1),void 0===B$D&&(B$D=1),this._clipX=B$J,this._clipY=B$D,this.skin=B$O}B$C(B$p,"laya.ui.Clip",B$J);var B$O=B$p.prototype;return B$O.destroy=function(B$O){this.clearEvent(),B$v.clearCache(this,this._skin),B$v.clearObject(this,this._weakKey),void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,!0),(this._complete||this._progress)&&B$c.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null,this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},B$O.dispose=function(){this.destroy(!0),B$c.loader.clearRes(this._skin)},B$O.createChildren=function(){this.graphics=this._bitmap=new B$E},B$O._onDisplay=function(B$O){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},B$O.changeClip=function(){if(this._clipChanged=!1,this._skin){var B$O=B$v.getRes(this._skin);if(B$O)this.loadComplete(this._skin,B$O);else{if(B$m.resAtalsObj&&B$m.resAtalsObj[this._skin])return;(this._complete||this._progress)&&B$c.loader.cancel(this._skin,this._complete,this._progress),this._complete=B$Y.create(this,this.loadComplete,[this._skin],!1),this._progress=null,B$c.loader.load(this._skin,this._complete,this._progress)}}},B$O.loadComplete=function(B$O,B$J){if(B$O===this._skin&&B$J){B$v.clearObject(this,this._weakKey);var B$D=this._clipWidth||Math.ceil(B$J.sourceWidth/this._clipX),B$p=this._clipHeight||Math.ceil(B$J.sourceHeight/this._clipY),B$m=this._skin+B$D+B$p,B$C=B$v.findObject(B$m);if(B$e.isOkTextureList(B$C)||(B$C=null),B$C)this._weakKey=B$m,B$v.keepObject(this,this._weakKey),this._sources=B$C;else{this._sources=[];for(var B$i=0;B$i<this._clipY;B$i++)for(var B$k=0;B$k<this._clipX;B$k++){var B$_=B$M.createFromTexture(B$J,B$D*B$k,B$p*B$i,B$D,B$p);if(B$J.alphaTexture){var B$L=B$J.width/B$J.alphaTexture.width;B$_.alphaTexture=B$M.createFromTexture(B$J.alphaTexture,B$D*B$k/B$L,B$p*B$i/B$L,B$D/B$L,B$p/B$L)}this._sources.push(B$_)}B$v.saveObject(B$m,this._sources),this._weakKey=B$m,B$v.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},B$O.play=function(B$O,B$J){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=-1),this._isPlaying=!0,this.index=B$O,this._toIndex=B$J,this._index++,B$c.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},B$O._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},B$O.stop=function(){this._isPlaying=!1,B$c.timer.clear(this,this._loop),this.event("complete")},B$O._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},B$i(0,B$O,"interval",function(){return this._interval},function(B$O){this._interval!=B$O&&(this._interval=B$O,this._isPlaying&&this.play())}),B$O.clearEvent=function(){this._skin&&B$m.atalsNotify&&B$m.atalsNotify.off(this._skin,this,this._setBtnSource)},B$i(0,B$O,"skin",function(){return this._skin},function(B$O){if(this._skin!=B$O)if(this.clearEvent(),B$v.clearCache(this,this._skin),this._skin=B$O){B$v.keepCache(this,this._skin);var B$J=B$v.getRes(B$O),B$D=B$m.resAtalsObj&&B$m.resAtalsObj[this._skin];!B$J&&B$D?B$m.atalsNotify&&B$m.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),B$O._setBtnSource=function(B$O,B$J){B$O===this._skin&&B$J&&(this.loadComplete(B$O,B$J),this.clearEvent())},B$i(0,B$O,"sources",function(){return this._sources},function(B$O){this._sources=B$O,this.index=this._index,this.event("loaded")}),B$i(0,B$O,"clipX",function(){return this._clipX},function(B$O){this._clipX=B$O||1,this._setClipChanged()}),B$i(0,B$O,"clipY",function(){return this._clipY},function(B$O){this._clipY=B$O||1,this._setClipChanged()}),B$i(0,B$O,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),B$i(0,B$O,"clipWidth",function(){return this._clipWidth},function(B$O){this._clipWidth=B$O,this._setClipChanged()}),B$i(0,B$O,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(B$O){this._bitmap.sizeGrid=B$s.fillArray(B$g.defaultSizeGrid,B$O,Number)}),B$i(0,B$O,"group",function(){return this._group},function(B$O){B$O&&this._skin&&B$v.setGroup(this._skin,B$O),this._group=B$O}),B$i(0,B$O,"clipHeight",function(){return this._clipHeight},function(B$O){this._clipHeight=B$O,this._setClipChanged()}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$o,this,"width",B$O),this._bitmap.width=B$O}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$o,this,"height",B$O),this._bitmap.height=B$O}),B$i(0,B$O,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),B$i(0,B$O,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),B$i(0,B$O,"index",function(){return this._index},function(B$O){this._index=B$O,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[B$O]),this.event("change")}),B$i(0,B$O,"autoPlay",function(){return this._autoPlay},function(B$O){this._autoPlay!=B$O&&((this._autoPlay=B$O)?this.play():this.stop())}),B$i(0,B$O,"isPlaying",function(){return this._isPlaying},function(B$O){this._isPlaying=B$O}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)&&Math.floor(B$O)==B$O||"string"==typeof B$O?this.index=parseInt(B$O):B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"bitmap",function(){return this._bitmap}),B$p}(B$o),B$j=function(B$J){function B$O(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,B$O.__super.call(this)}B$C(B$O,"laya.ui.ColorPicker",B$J);var B$D=B$O.prototype;return B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._colorPanel&&this._colorPanel.destroy(B$O),this._colorButton&&this._colorButton.destroy(B$O),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},B$D.createChildren=function(){this.addChild(this._colorButton=new B$F),this._colorPanel=new B$N,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new B$q),this._colorPanel.addChild(this._colorBlock=new B$q),this._colorPanel.addChild(this._colorInput=new B$G)},B$D.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},B$D.onPanelMouseDown=function(B$O){B$O.stopPropagation()},B$D.changePanel=function(){this._panelChanged=!1;var B$O=this._colorPanel.graphics;B$O.clear(),B$O.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(B$O=this._colorTiles.graphics).clear();for(var B$J=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],B$D=0;B$D<12;B$D++)for(var B$p=0;B$p<20;B$p++){var B$m=0;B$m=0===B$p?B$J[B$D]:1===B$p?0:51*(((3*B$D+B$p/6)%3<<0)+3*(B$D/6<<0))<<16|B$p%6*51<<8|(B$D<<0)%6*51;var B$C=B$s.toColor(B$m);this._colors.push(B$C);var B$i=B$p*this._gridSize,B$k=B$D*this._gridSize;B$O.drawRect(B$i,B$k,this._gridSize,this._gridSize,B$C,"#000000")}},B$D.onColorButtonClick=function(B$O){this._colorPanel.parent?this.close():this.open()},B$D.open=function(){var B$O=this.localToGlobal(new B$X),B$J=B$O.x+this._colorPanel.width<=B$c.stage.width?B$O.x:B$c.stage.width-this._colorPanel.width,B$D=B$O.y+this._colorButton.height;B$D=B$D+this._colorPanel.height<=B$c.stage.height?B$D:B$O.y-this._colorPanel.height,this._colorPanel.pos(B$J,B$D),this._colorPanel.zOrder=1001,B$c._currentStage.addChild(this._colorPanel),B$c.stage.on("mousedown",this,this.removeColorBox)},B$D.close=function(){B$c.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},B$D.removeColorBox=function(B$O){this.close()},B$D.onColorFieldKeyDown=function(B$O){13==B$O.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),B$O.stopPropagation())},B$D.onColorInputChange=function(B$O){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},B$D.onColorTilesClick=function(B$O){this.selectedColor=this.getColorByMouse(),this.close()},B$D.onColorTilesMouseMove=function(B$O){this._colorInput.focus=!1;var B$J=this.getColorByMouse();this._colorInput.text=B$J,this.drawBlock(B$J)},B$D.getColorByMouse=function(){var B$O=this._colorTiles.getMousePoint(),B$J=Math.floor(B$O.x/this._gridSize),B$D=Math.floor(B$O.y/this._gridSize);return this._colors[20*B$D+B$J]},B$D.drawBlock=function(B$O){var B$J=this._colorBlock.graphics;B$J.clear();var B$D=B$O||"#ffffff";B$J.drawRect(0,0,50,20,B$D,this._borderColor),B$O||B$J.drawLine(0,0,50,20,"#ff0000")},B$D.changeColor=function(){var B$O=this.graphics;B$O.clear();var B$J=this._selectedColor||"#000000";B$O.drawRect(0,0,this._colorButton.width,this._colorButton.height,B$J)},B$D._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},B$i(0,B$D,"inputBgColor",function(){return this._inputBgColor},function(B$O){this._inputBgColor=B$O,this._setPanelChanged()}),B$i(0,B$D,"selectedColor",function(){return this._selectedColor},function(B$O){this._selectedColor!=B$O&&(this._selectedColor=this._colorInput.text=B$O,this.drawBlock(B$O),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",B$L.EMPTY.setTo("change",this,this)))}),B$i(0,B$D,"skin",function(){return this._colorButton.skin},function(B$O){this._colorButton.skin=B$O,this.changeColor()}),B$i(0,B$D,"bgColor",function(){return this._bgColor},function(B$O){this._bgColor=B$O,this._setPanelChanged()}),B$i(0,B$D,"borderColor",function(){return this._borderColor},function(B$O){this._borderColor=B$O,this._setPanelChanged()}),B$i(0,B$D,"inputColor",function(){return this._inputColor},function(B$O){this._inputColor=B$O,this._setPanelChanged()}),B$O}(B$o),B$u=function(B$J){function B$D(B$O,B$J){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,B$D.__super.call(this),this._itemColors=B$g.comboBoxItemColors,this.skin=B$O,this.labels=B$J}B$C(B$D,"laya.ui.ComboBox",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._button&&this._button.destroy(B$O),this._list&&this._list.destroy(B$O),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},B$O.createChildren=function(){this.addChild(this._button=new B$F),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},B$O._createList=function(){this._list=new B$n,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},B$O._setListEvent=function(B$O){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=B$Y.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},B$O.onListDown=function(B$O){B$O.stopPropagation()},B$O.onScrollBarDown=function(B$O){B$O.stopPropagation()},B$O.onButtonMouseDown=function(B$O){this.callLater(this.switchTo,[!this._isOpen])},B$O.changeList=function(){this._listChanged=!1;var B$O=this.width-2,B$J=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:B$O,height:this._itemHeight,fontSize:this._itemSize,color:B$J}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},B$O.onlistItemMouse=function(B$O,B$J){var B$D=B$O.type;if("mouseover"===B$D||"mouseout"===B$D){if(this._isCustomList)return;var B$p=this._list.getCell(B$J);if(!B$p)return;var B$m=B$p.getChildByName("label");B$m&&("mouseover"===B$D?(B$m.bgColor=this._itemColors[0],B$m.color=this._itemColors[1]):(B$m.bgColor=null,B$m.color=this._itemColors[2]))}else"click"===B$D&&(this.selectedIndex=B$J,this.isOpen=!1)},B$O.switchTo=function(B$O){this.isOpen=B$O},B$O.changeOpen=function(){this.isOpen=!this._isOpen},B$O.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var B$O=this._list.graphics;B$O.clear(),B$O.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var B$J=this._list.array||[],B$D=B$J.length=0,B$p=this._labels.length;B$D<B$p;B$D++)B$J.push({label:this._labels[B$D]});this._list.height=this._listHeight,this._list.array=B$J},B$O.changeSelected=function(){this._button.label=this.selectedLabel},B$O._onStageMouseWheel=function(B$O){this._list&&!this._list.contains(B$O.target)&&this.removeList(null)},B$O.removeList=function(B$O){B$c.stage.off("mousedown",this,this.removeList),B$c.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},B$i(0,B$O,"selectedIndex",function(){return this._selectedIndex},function(B$O){this._selectedIndex!=B$O&&(this._selectedIndex=B$O,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[B$L.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),B$i(0,B$O,"measureHeight",function(){return this._button.height}),B$i(0,B$O,"skin",function(){return this._button.skin},function(B$O){this._button.skin!=B$O&&(this._button.skin=B$O,this._listChanged=!0)}),B$i(0,B$O,"measureWidth",function(){return this._button.width}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$o,this,"width",B$O),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),B$i(0,B$O,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(B$O){this.selectedIndex=this._labels.indexOf(B$O)}),B$i(0,B$O,"labels",function(){return this._labels.join(",")},function(B$O){0<this._labels.length&&(this.selectedIndex=-1),B$O?this._labels=B$O.split(","):this._labels.length=0,this._itemChanged=!0}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$o,this,"height",B$O),this._button.height=this._height}),B$i(0,B$O,"selectHandler",function(){return this._selectHandler},function(B$O){this._selectHandler=B$O}),B$i(0,B$O,"visibleNum",function(){return this._visibleNum},function(B$O){this._visibleNum=B$O,this._listChanged=!0}),B$i(0,B$O,"labelBold",function(){return this._button.text.bold},function(B$O){this._button.text.bold=B$O}),B$i(0,B$O,"itemColors",function(){return String(this._itemColors)},function(B$O){this._itemColors=B$s.fillArray(this._itemColors,B$O,String),this._listChanged=!0}),B$i(0,B$O,"itemSize",function(){return this._itemSize},function(B$O){this._itemSize=B$O,this._listChanged=!0}),B$i(0,B$O,"scrollBar",function(){return this.list.scrollBar}),B$i(0,B$O,"isOpen",function(){return this._isOpen},function(B$O){if(this._isOpen!=B$O)if(this._isOpen=B$O,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var B$J=this.localToGlobal(B$X.TEMP.setTo(0,0)),B$D=B$J.y+this._button.height;B$D=B$D+this._listHeight<=B$c.stage.height?B$D:B$J.y-this._listHeight,this._list.pos(B$J.x,B$D),this._list.zOrder=1001,B$c._currentStage.addChild(this._list),B$c.stage.once("mousedown",this,this.removeList),B$c.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),B$i(0,B$O,"scrollBarSkin",function(){return this._scrollBarSkin},function(B$O){this._scrollBarSkin=B$O}),B$i(0,B$O,"sizeGrid",function(){return this._button.sizeGrid},function(B$O){this._button.sizeGrid=B$O}),B$i(0,B$O,"button",function(){return this._button}),B$i(0,B$O,"list",function(){return this._list||this._createList(),this._list},function(B$O){B$O&&(B$O.removeSelf(),this._isCustomList=!0,this._list=B$O,this._setListEvent(B$O),this._itemHeight=B$O.getCell(0).height+B$O.spaceY)}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)&&Math.floor(B$O)==B$O||"string"==typeof B$O?this.selectedIndex=parseInt(B$O):B$O instanceof Array?this.labels=B$O.join(","):B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"labelColors",function(){return this._button.labelColors},function(B$O){this._button.labelColors!=B$O&&(this._button.labelColors=B$O)}),B$i(0,B$O,"labelPadding",function(){return this._button.text.padding.join(",")},function(B$O){this._button.text.padding=B$s.fillArray(B$g.labelPadding,B$O,Number)}),B$i(0,B$O,"labelSize",function(){return this._button.text.fontSize},function(B$O){this._button.text.fontSize=B$O}),B$i(0,B$O,"labelFont",function(){return this._button.text.font},function(B$O){this._button.text.font=B$O}),B$i(0,B$O,"stateNum",function(){return this._button.stateNum},function(B$O){this._button.stateNum=B$O}),B$D}(B$o),B$l=function(B$J){function B$D(B$O){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,B$D.__super.call(this),this._showButtons=B$P.showButtons,this._touchScrollEnable=B$P.touchScrollEnable,this._mouseWheelEnable=B$P.mouseWheelEnable,this.skin=B$O,this.max=1}B$C(B$D,"laya.ui.ScrollBar",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),this.stopScroll(),this.target=null,B$J.prototype.destroy.call(this,B$O),this.upButton&&this.upButton.destroy(B$O),this.downButton&&this.downButton.destroy(B$O),this.slider&&this.slider.destroy(B$O),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},B$O.createChildren=function(){this.addChild(this.slider=new B$$),this.addChild(this.upButton=new B$F),this.addChild(this.downButton=new B$F)},B$O.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},B$O.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},B$O.onButtonMouseDown=function(B$O){var B$J=B$O.currentTarget===this.upButton;this.slide(B$J),B$c.timer.once(B$g.scrollBarDelayTime,this,this.startLoop,[B$J]),B$c.stage.once("mouseup",this,this.onStageMouseUp)},B$O.startLoop=function(B$O){B$c.timer.frameLoop(1,this,this.slide,[B$O])},B$O.slide=function(B$O){B$O?this.value-=this._scrollSize:this.value+=this._scrollSize},B$O.onStageMouseUp=function(B$O){B$c.timer.clear(this,this.startLoop),B$c.timer.clear(this,this.slide)},B$O.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},B$O.changeSize=function(){B$J.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},B$O.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},B$O.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},B$O.setScroll=function(B$O,B$J,B$D){this.runCallLater(this.changeSize),this.slider.setSlider(B$O,B$J,B$D),this.slider.bar.visible=0<B$J,!this._hide&&this.autoHide&&(this.visible=!1)},B$O.onTargetMouseWheel=function(B$O){this.value-=B$O.delta*this._scrollSize,this.target=this._target},B$O.onTargetMouseDown=function(B$O){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new B$X),this._lastPoint.setTo(B$c.stage.mouseX,B$c.stage.mouseY),B$c.timer.clear(this,this.tweenMove),B$a.clearTween(this),B$c.stage.once("mouseup",this,this.onStageMouseUp2),B$c.stage.once("mouseout",this,this.onStageMouseUp2),B$c.timer.frameLoop(1,this,this.loop)},B$O.loop=function(){var B$O=B$c.stage.mouseY,B$J=B$c.stage.mouseX;if(this._lastOffset=this.isVertical?B$O-this._lastPoint.y:B$J-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?B$c.stage._canvasTransform.getScaleY():B$c.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=B$J,this._lastPoint.y=B$O,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},B$O.onStageMouseUp2=function(B$O){if(B$c.stage.off("mouseup",this,this.onStageMouseUp2),B$c.stage.off("mouseout",this,this.onStageMouseUp2),B$c.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?B$a.to(this,{value:this.min},this.elasticBackTime,B$_.sineOut,B$Y.create(this,this.elasticOver)):this._value>this.max&&B$a.to(this,{value:this.max},this.elasticBackTime,B$_.sineOut,B$Y.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?B$c.stage.mouseY-this._lastPoint.y:B$c.stage.mouseX-this._lastPoint.x);for(var B$J=0,B$D=Math.min(this._offsets.length,3),B$p=0;B$p<B$D;B$p++)B$J+=this._offsets[this._offsets.length-1-B$p];if(this._lastOffset=B$J/B$D,(B$J=Math.abs(this._lastOffset))<2)return void this.event("end");60<B$J&&(this._lastOffset=0<this._lastOffset?60:-60);var B$m=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));B$c.timer.frameLoop(1,this,this.tweenMove,[B$m])}},B$O.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&B$a.to(this,{alpha:0},500),this.event("end")},B$O.tweenMove=function(B$O){this._lastOffset*=this.rollRatio;var B$J=NaN;if(0<B$O&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,B$J=.5*-(this.min-B$O-this.value),this._lastOffset>B$J&&(this._lastOffset=B$J)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,B$J=.5*-(this.max+B$O-this.value),this._lastOffset<B$J&&(this._lastOffset=B$J))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(B$c.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?B$a.to(this,{value:this.min},this.elasticBackTime,B$_.sineOut,B$Y.create(this,this.elasticOver)):this._value>this.max?B$a.to(this,{value:this.max},this.elasticBackTime,B$_.sineOut,B$Y.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&B$a.to(this,{alpha:0},500)}},B$O.stopScroll=function(){this.onStageMouseUp2(null),B$c.timer.clear(this,this.tweenMove),B$a.clearTween(this)},B$i(0,B$O,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){this._skin!=B$O&&(this._skin=B$O,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),B$i(0,B$O,"max",function(){return this.slider.max},function(B$O){this.slider.max=B$O}),B$i(0,B$O,"showButtons",function(){return this._showButtons},function(B$O){this._showButtons=B$O,this.callLater(this.changeScrollBar)}),B$i(0,B$O,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),B$i(0,B$O,"min",function(){return this.slider.min},function(B$O){this.slider.min=B$O}),B$i(0,B$O,"value",function(){return this._value},function(B$O){B$O!==this._value&&(this._value=B$O,this._isElastic||(this.slider._value!=B$O&&(this.slider._value=B$O,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),B$i(0,B$O,"isVertical",function(){return this.slider.isVertical},function(B$O){this.slider.isVertical=B$O}),B$i(0,B$O,"sizeGrid",function(){return this.slider.sizeGrid},function(B$O){this.slider.sizeGrid=B$O}),B$i(0,B$O,"scrollSize",function(){return this._scrollSize},function(B$O){this._scrollSize=B$O}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)||"string"==typeof B$O?this.value=Number(B$O):B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"thumbPercent",function(){return this._thumbPercent},function(B$O){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),B$O=1<=B$O?.99:B$O,this._thumbPercent=B$O,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*B$O,B$g.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*B$O,B$g.scrollBarMinNum))}),B$i(0,B$O,"target",function(){return this._target},function(B$O){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=B$O)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),B$i(0,B$O,"hide",function(){return this._hide},function(B$O){this._hide=B$O,this.visible=!B$O}),B$i(0,B$O,"touchScrollEnable",function(){return this._touchScrollEnable},function(B$O){this._touchScrollEnable=B$O,this.target=this._target}),B$i(0,B$O,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(B$O){this._mouseWheelEnable=B$O,this.target=this._target}),B$i(0,B$O,"tick",function(){return this.slider.tick},function(B$O){this.slider.tick=B$O}),B$D}(B$o),B$$=function(B$J){function B$D(B$O){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,B$D.__super.call(this),this.skin=B$O}B$C(B$D,"laya.ui.Slider",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._bg&&this._bg.destroy(B$O),this._bar&&this._bar.destroy(B$O),this._progress&&this._progress.destroy(B$O),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},B$O.createChildren=function(){this.addChild(this._bg=new B$x),this.addChild(this._bar=new B$F)},B$O.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},B$O.onBarMouseDown=function(B$O){this._globalSacle||(this._globalSacle=new B$X),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=B$c.stage.mouseX,this._ty=B$c.stage.mouseY,B$c.stage.on("mousemove",this,this.mouseMove),B$c.stage.once("mouseup",this,this.mouseUp),B$c.stage.once("mouseout",this,this.mouseUp),this.showValueText()},B$O.showValueText=function(){if(this.showLabel){var B$O=laya.ui.Slider.label;this.addChild(B$O),B$O.textField.changeText(this._value+""),this.isVertical?(B$O.x=this._bar.x+20,B$O.y=.5*(this._bar.height-B$O.height)+this._bar.y):(B$O.y=this._bar.y-20,B$O.x=.5*(this._bar.width-B$O.width)+this._bar.x)}},B$O.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},B$O.mouseUp=function(B$O){B$c.stage.off("mousemove",this,this.mouseMove),B$c.stage.off("mouseup",this,this.mouseUp),B$c.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},B$O.mouseMove=function(B$O){var B$J=this._value;this.isVertical?(this._bar.y+=(B$c.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(B$c.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=B$c.stage.mouseX,this._ty=B$c.stage.mouseY;var B$D=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*B$D)/B$D,this._value!=B$J&&this.sendChangeEvent(),this.showValueText()},B$O.sendChangeEvent=function(B$O){void 0===B$O&&(B$O="change"),this.event(B$O),this.changeHandler&&this.changeHandler.runWith(this._value)},B$O.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},B$O.changeSize=function(){B$J.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},B$O.setSlider=function(B$O,B$J,B$D){this._value=-1,this._min=B$O,this._max=B$O<B$J?B$J:B$O,this.value=B$D<B$O?B$O:B$J<B$D?B$J:B$D},B$O.changeValue=function(){var B$O=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*B$O)/B$O,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var B$J=this._max-this._min;0===B$J&&(B$J=1),this.isVertical?(this._bar.y=(this._value-this._min)/B$J*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/B$J*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},B$O.onBgMouseDown=function(B$O){var B$J=this._bg.getMousePoint();this.isVertical?this.value=B$J.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=B$J.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},B$i(0,B$O,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){if(this._skin!=B$O){this._skin=B$O,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var B$J=this._skin.replace(".png","$progress.png");B$v.getRes(B$J)&&(this._progress||(this.addChild(this._progress=new B$x),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=B$J),this.setBarPoint(),this.callLater(this.changeValue)}}),B$i(0,B$O,"allowClickBack",function(){return this._allowClickBack},function(B$O){this._allowClickBack!=B$O&&((this._allowClickBack=B$O)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),B$i(0,B$O,"max",function(){return this._max},function(B$O){this._max!=B$O&&(this._max=B$O,this.callLater(this.changeValue))}),B$i(0,B$O,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),B$i(0,B$O,"tick",function(){return this._tick},function(B$O){this._tick!=B$O&&(this._tick=B$O,this.callLater(this.changeValue))}),B$i(0,B$O,"sizeGrid",function(){return this._bg.sizeGrid},function(B$O){this._bg.sizeGrid=B$O,this._bar.sizeGrid=B$O,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),B$i(0,B$O,"min",function(){return this._min},function(B$O){this._min!=B$O&&(this._min=B$O,this.callLater(this.changeValue))}),B$i(0,B$O,"value",function(){return this._value},function(B$O){if(this._value!=B$O){var B$J=this._value;this._value=B$O,this.changeValue(),this._value!=B$J&&this.sendChangeEvent()}}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)||"string"==typeof B$O?this.value=Number(B$O):B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"bar",function(){return this._bar}),B$p(B$D,["label",function(){return this.label=new B$V}]),B$D}(B$o),B$x=function(B$J){function B$D(B$O){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,B$D.__super.call(this),this.skin=B$O}B$C(B$D,"laya.ui.Image",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,!0),(this._complete||this._progress)&&B$c.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null,this._bitmap&&this._bitmap.destroy(),this._bitmap=null,B$v.clearCache(this,this._skin),this.clearEvent()},B$O.dispose=function(){this.destroy(!0),B$v.clearCache(this,this._skin),this.clearEvent()},B$O.createChildren=function(){this.graphics=this._bitmap=new B$E},B$O.setSource=function(B$O,B$J){B$O===this._skin&&B$J&&(this.source=B$J,this.onCompResize(),this.clearEvent())},B$O.clearEvent=function(){this._skin&&B$m.atalsNotify&&B$m.atalsNotify.off(this._skin,this,this.setSource)},B$i(0,B$O,"source",function(){return this._bitmap.source},function(B$O){this._bitmap&&(this._bitmap.source=B$O,this.event("loaded"),this.repaint())}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"string"==typeof(this._dataSource=B$O)?this.skin=B$O:B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"measureHeight",function(){return this._bitmap.height}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){if(this._skin!=B$O)if(B$v.clearCache(this,this._skin),this.clearEvent(),this._skin=B$O){B$v.keepCache(this,this._skin);var B$J=B$v.getRes(B$O),B$D=B$m.resAtalsObj&&B$m.resAtalsObj[this._skin];B$J?(this.source=B$J,this.onCompResize()):B$D?(B$m.atalsNotify&&B$m.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=B$D.sourceW),0==this.height&&(this.height=B$D.sourceH)):((this._complete||this._progress)&&B$c.loader.cancel(this._skin,this._complete,this._progress),this._complete=B$Y.create(this,this.setSource,[this._skin],!1),this._progress=null,B$c.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),B$i(0,B$O,"group",function(){return this._group},function(B$O){B$O&&this._skin&&B$v.setGroup(this._skin,B$O),this._group=B$O}),B$i(0,B$O,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(B$O){this._bitmap.sizeGrid=B$s.fillArray(B$g.defaultSizeGrid,B$O,Number)}),B$i(0,B$O,"measureWidth",function(){return this._bitmap.width}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$o,this,"width",B$O),this._bitmap.width=0==B$O?1e-7:B$O}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$o,this,"height",B$O),this._bitmap.height=0==B$O?1e-7:B$O}),B$D}(B$o),B$V=function(B$J){function B$D(B$O){this._tf=null,B$D.__super.call(this),void 0===B$O&&(B$O=""),B$r.defaultColor=B$g.labelColor,this.text=B$O}B$C(B$D,"laya.ui.Label",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._tf=null},B$O.createChildren=function(){this.addChild(this._tf=new B$d)},B$O.changeText=function(B$O){this._tf.changeText(B$O)},B$i(0,B$O,"padding",function(){return this._tf.padding.join(",")},function(B$O){this._tf.padding=B$s.fillArray(B$g.labelPadding,B$O,Number)}),B$i(0,B$O,"bold",function(){return this._tf.bold},function(B$O){this._tf.bold=B$O}),B$i(0,B$O,"align",function(){return this._tf.align},function(B$O){this._tf.align=B$O}),B$i(0,B$O,"text",function(){return this._tf.text},function(B$O){this._tf.text!=B$O&&(B$O&&(B$O=B$s.adptString(B$O+"")),this._tf.text=B$O,this.event("change"),this._width&&this._height||this.onCompResize())}),B$i(0,B$O,"italic",function(){return this._tf.italic},function(B$O){this._tf.italic=B$O}),B$i(0,B$O,"wordWrap",function(){return this._tf.wordWrap},function(B$O){this._tf.wordWrap=B$O}),B$i(0,B$O,"font",function(){return this._tf.font},function(B$O){this._tf.font=B$O}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)||"string"==typeof B$O?this.text=B$O+"":B$c.superSet(B$o,this,"dataSource",B$O)}),B$i(0,B$O,"color",function(){return this._tf.color},function(B$O){this._tf.color=B$O}),B$i(0,B$O,"valign",function(){return this._tf.valign},function(B$O){this._tf.valign=B$O}),B$i(0,B$O,"leading",function(){return this._tf.leading},function(B$O){this._tf.leading=B$O}),B$i(0,B$O,"fontSize",function(){return this._tf.fontSize},function(B$O){this._tf.fontSize=B$O}),B$i(0,B$O,"bgColor",function(){return this._tf.bgColor},function(B$O){this._tf.bgColor=B$O}),B$i(0,B$O,"borderColor",function(){return this._tf.borderColor},function(B$O){this._tf.borderColor=B$O}),B$i(0,B$O,"stroke",function(){return this._tf.stroke},function(B$O){this._tf.stroke=B$O}),B$i(0,B$O,"strokeColor",function(){return this._tf.strokeColor},function(B$O){this._tf.strokeColor=B$O}),B$i(0,B$O,"textField",function(){return this._tf}),B$i(0,B$O,"measureWidth",function(){return this._tf.width}),B$i(0,B$O,"measureHeight",function(){return this._tf.height}),B$i(0,B$O,"width",function(){return this._width||this._tf.text?B$c.superGet(B$o,this,"width"):0},function(B$O){B$c.superSet(B$o,this,"width",B$O),this._tf.width=B$O}),B$i(0,B$O,"height",function(){return this._height||this._tf.text?B$c.superGet(B$o,this,"height"):0},function(B$O){B$c.superSet(B$o,this,"height",B$O),this._tf.height=B$O}),B$i(0,B$O,"overflow",function(){return this._tf.overflow},function(B$O){this._tf.overflow=B$O}),B$i(0,B$O,"underline",function(){return this._tf.underline},function(B$O){this._tf.underline=B$O}),B$i(0,B$O,"underlineColor",function(){return this._tf.underlineColor},function(B$O){this._tf.underlineColor=B$O}),B$D}(B$o),B$T=function(B$J){function B$D(B$O){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,B$D.__super.call(this),this.skin=B$O}B$C(B$D,"laya.ui.ProgressBar",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._bg&&this._bg.destroy(B$O),this._bar&&this._bar.destroy(B$O),this._bg=this._bar=null,this.changeHandler=null},B$O.createChildren=function(){this.addChild(this._bg=new B$x),this.addChild(this._bar=new B$x)},B$O.changeValue=function(){if(this.sizeGrid){var B$O=this.sizeGrid.split(","),B$J=Number(B$O[3]),B$D=Number(B$O[1]),B$p=(this.width-B$J-B$D)*this._value;this._bar.width=B$J+B$D+B$p,this._bar.visible=this._bar.width>B$J+B$D}else this._bar.width=this.width*this._value},B$i(0,B$O,"measureHeight",function(){return this._bg.height}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){this._skin!=B$O&&(this._skin=B$O,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),B$i(0,B$O,"measureWidth",function(){return this._bg.width}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$o,this,"height",B$O),this._bg.height=this._height,this._bar.height=this._height}),B$i(0,B$O,"bar",function(){return this._bar}),B$i(0,B$O,"value",function(){return this._value},function(B$O){this._value!=B$O&&(B$O=1<B$O?1:B$O<0?0:B$O,this._value=B$O,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(B$O))}),B$i(0,B$O,"bg",function(){return this._bg}),B$i(0,B$O,"sizeGrid",function(){return this._bg.sizeGrid},function(B$O){this._bg.sizeGrid=this._bar.sizeGrid=B$O}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$o,this,"width",B$O),this._bg.width=this._width,this.callLater(this.changeValue)}),B$i(0,B$O,"dataSource",B$J.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)||"string"==typeof B$O?this.value=Number(B$O):B$c.superSet(B$o,this,"dataSource",B$O)}),B$D}(B$o),B$I=(function(B$O){function B$D(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,B$D.__super.call(this),this._tipBox=new B$o,this._tipBox.addChild(this._tipText=new B$d),this._tipText.x=this._tipText.y=5,this._tipText.color=B$D.tipTextColor,this._defaultTipHandler=this._showDefaultTip,B$c.stage.on("showtip",this,this._onStageShowTip),B$c.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}B$C(B$D,"laya.ui.TipManager",B$o);var B$J=B$D.prototype;B$J._onStageHideTip=function(B$O){B$c.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},B$J._onStageShowTip=function(B$O){B$c.timer.once(B$D.tipDelay,this,this._showTip,[B$O],!0)},B$J._showTip=function(B$O){if("string"==typeof B$O){var B$J=String(B$O);Boolean(B$J)&&this._defaultTipHandler(B$J)}else B$O instanceof laya.utils.Handler?B$O.run():"function"==typeof B$O&&B$O.apply();B$c.stage.on("mousemove",this,this._onStageMouseMove),B$c.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},B$J._onStageMouseDown=function(B$O){this.closeAll()},B$J._onStageMouseMove=function(B$O){this._showToStage(this,B$D.offsetX,B$D.offsetY)},B$J._showToStage=function(B$O,B$J,B$D){void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0);var B$p=B$O.getBounds();B$O.x=B$c.stage.mouseX+B$J,B$O.y=B$c.stage.mouseY+B$D,B$O.x+B$p.width>B$c.stage.width&&(B$O.x-=B$p.width+B$J),B$O.y+B$p.height>B$c.stage.height&&(B$O.y-=B$p.height+B$D)},B$J.closeAll=function(){B$c.timer.clear(this,this._showTip),B$c.stage.off("mousemove",this,this._onStageMouseMove),B$c.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},B$J.showDislayTip=function(B$O){this.addChild(B$O),this._showToStage(this),B$c._currentStage.addChild(this)},B$J._showDefaultTip=function(B$O){this._tipText.text=B$O;var B$J=this._tipBox.graphics;B$J.clear(),B$J.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,B$D.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),B$c._currentStage.addChild(this)},B$i(0,B$J,"defaultTipHandler",function(){return this._defaultTipHandler},function(B$O){this._defaultTipHandler=B$O}),B$D.offsetX=10,B$D.offsetY=15,B$D.tipTextColor="#ffffff",B$D.tipBackColor="#111111",B$D.tipDelay=200}(),function(B$O){var B$G;function B$X(){this._idMap=null,this._aniList=null,this._watchMap={},B$X.__super.call(this)}B$C(B$X,"laya.ui.View",B$N);var B$J=B$X.prototype;return B$J.createView=function(B$O){if(B$O.animations&&!this._idMap&&(this._idMap={}),B$X.createComp(B$O,this,this),B$O.animations){var B$J,B$D,B$p=[],B$m=B$O.animations,B$C=0,B$i=B$m.length;for(B$C=0;B$C<B$i;B$C++){switch(B$J=new B$H,B$D=B$m[B$C],B$J._setUp(this._idMap,B$D),(this[B$D.name]=B$J)._setControlNode(this),B$D.action){case 1:B$J.play(0,!1);break;case 2:B$J.play(0,!0)}B$p.push(B$J)}this._aniList=B$p}0<this._width&&null==B$O.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},B$J.onEvent=function(B$O,B$J){},B$J.loadUI=function(B$O){var B$J=B$X.uiMap[B$O];B$J&&this.createView(B$J)},B$J.destroy=function(B$O){void 0===B$O&&(B$O=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,B$O)},B$J.changeData=function(B$O){var B$J=this._watchMap[B$O];if(B$J){console.log("change",B$O);for(var B$D=0,B$p=B$J.length;B$D<B$p;B$D++){B$J[B$D].exe(this)}}},B$X._regs=function(){for(var B$O in B$X.uiClassMap)B$h.regClass(B$O,B$X.uiClassMap[B$O])},B$X.createComp=function(B$O,B$J,B$D,B$p){if(!(B$J=B$J||B$X.getCompInstance(B$O)))return console.warn("can not create:"+B$O.type),null;var B$m=B$O.child;if(B$m)for(var B$C=B$J instanceof laya.ui.List,B$i=0,B$k=B$m.length;B$i<B$k;B$i++){var B$_=B$m[B$i];if(!B$J.hasOwnProperty("itemRender")||"render"!=B$_.props.name&&"render"!==B$_.props.renderType)if("Graphic"==B$_.type)B$h.addGraphicsToSprite(B$_,B$J);else if(B$h.isDrawType(B$_.type))B$h.addGraphicToSprite(B$_,B$J,!0);else{if(B$C){var B$L=[],B$r=B$X.createComp(B$_,null,B$D,B$L);B$L.length&&(B$r._$bindData=B$L)}else B$r=B$X.createComp(B$_,null,B$D,B$p);"Script"==B$_.type?"owner"in B$r?B$r.owner=B$J:"target"in B$r&&(B$r.target=B$J):"mask"==B$_.props.renderType||"mask"==B$_.props.name?B$J.mask=B$r:B$r instanceof laya.display.Sprite&&B$J.addChild(B$r)}else B$J.itemRender=B$_}var B$H=B$O.props;for(var B$Y in B$H){var B$G=B$H[B$Y];B$X.eventDic[B$Y]?B$G&&B$D&&B$J.on(B$Y,B$D,B$D.onEvent,[B$G]):B$X.setCompValue(B$J,B$Y,B$G,B$D,B$p)}return B$c.__typeof(B$J,"laya.ui.IItem")&&B$J.initItems(),B$O.compId&&B$D&&B$D._idMap&&(B$D._idMap[B$O.compId]=B$J),B$J},B$X.setCompValue=function(B$O,B$J,B$D,B$p,B$m){if("string"==typeof B$D&&-1<B$D.indexOf("${")){if(B$X._sheet||(B$X._sheet=B$h.getClass("laya.data.Table")),!B$X._sheet)return void console.warn("Can not find class Sheet");if(B$m)B$m.push(B$O,B$J,B$D);else if(B$p){-1==B$D.indexOf("].")&&(B$D=B$D.replace(".","[0]."));var B$C,B$i,B$k=new B$G(B$O,B$J,B$D);B$k.exe(B$p);for(var B$_=B$D.replace(/\[.*?\]\./g,".");null!=(B$C=B$X._parseWatchData.exec(B$_));){for(var B$L=B$C[1];null!=(B$i=B$X._parseKeyWord.exec(B$L));){var B$r=B$i[0],B$H=B$p._watchMap[B$r]||(B$p._watchMap[B$r]=[]);B$H.push(B$k),B$X._sheet.I.notifer.on(B$r,B$p,B$p.changeData,[B$r])}(B$H=B$p._watchMap[B$L]||(B$p._watchMap[B$L]=[])).push(B$k),B$X._sheet.I.notifer.on(B$L,B$p,B$p.changeData,[B$L])}}}else if("var"===B$J&&B$p)B$p[B$D]=B$O;else if("onClick"==B$J){var B$Y=B$c._runScript("(function(){"+B$D+"})");B$O.on("click",B$p,B$Y)}else B$O[B$J]="true"===B$D||"false"!==B$D&&B$D},B$X.getCompInstance=function(B$O){var B$J,B$D=B$O.props?B$O.props.runtime:null;return B$J=B$D?B$X.viewClassMap[B$D]||B$X.uiClassMap[B$D]||B$c.__classmap[B$D]:B$X.uiClassMap[B$O.type],B$O.props&&B$O.props.hasOwnProperty("renderType")&&"instance"==B$O.props.renderType?B$J.instance:B$J?new B$J:null},B$X.regComponent=function(B$O,B$J){B$X.uiClassMap[B$O]=B$J,B$h.regClass(B$O,B$J)},B$X.regViewRuntime=function(B$O,B$J){B$X.viewClassMap[B$O]=B$J},B$X.uiMap={},B$X.viewClassMap={},B$X._sheet=null,B$p(B$X,["uiClassMap",function(){return this.uiClassMap={ViewStack:B$OO,LinkButton:B$F,TextArea:B$LO,ColorPicker:B$j,Box:B$N,Button:B$F,CheckBox:B$w,Clip:B$R,ComboBox:B$u,Component:B$o,HScrollBar:B$B,HSlider:B$Q,Image:B$x,Label:B$V,List:B$n,Panel:B$S,ProgressBar:B$T,Radio:B$K,RadioGroup:B$kO,ScrollBar:B$l,Slider:B$$,Tab:B$_O,TextInput:B$DO,View:B$X,VScrollBar:B$JO,VSlider:B$pO,Tree:B$f,HBox:B$CO,VBox:B$iO,Sprite:B$q,Animation:B$D,Text:B$d,FontClip:B$Z}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),B$X.__init$=function(){B$X._regs(),B$G=function(){function B$O(B$O,B$J,B$D){this.comp=null,this.prop=null,this.value=null,this.comp=B$O,this.prop=B$J,this.value=B$D}return B$C(B$O,""),B$O.prototype.exe=function(B$O){var B$J=B$s.getBindFun(this.value);this.comp[this.prop]=B$J.call(this,B$O)},B$O}()},B$X}()),B$w=function(B$O){function B$D(B$O,B$J){void 0===B$J&&(B$J=""),B$D.__super.call(this,B$O,B$J)}B$C(B$D,"laya.ui.CheckBox",B$O);var B$J=B$D.prototype;return B$J.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},B$J.initialize=function(){B$O.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},B$i(0,B$J,"dataSource",B$O.prototype._$get_dataSource,function(B$O){"boolean"==typeof(this._dataSource=B$O)?this.selected=B$O:"string"==typeof B$O?this.selected="true"===B$O:B$c.superSet(B$F,this,"dataSource",B$O)}),B$D}(B$F),B$U=function(B$O){function B$J(){this._space=0,this._align="none",this._itemChanged=!1,B$J.__super.call(this)}B$C(B$J,"laya.ui.LayoutBox",B$N);var B$D=B$J.prototype;return B$D.addChild=function(B$O){return B$O.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,B$O)},B$D.onResize=function(B$O){this._setItemChanged()},B$D.addChildAt=function(B$O,B$J){return B$O.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,B$O,B$J)},B$D.removeChild=function(B$O){return B$O.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,B$O)},B$D.removeChildAt=function(B$O){return this.getChildAt(B$O).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,B$O)},B$D.refresh=function(){this._setItemChanged()},B$D.changeItems=function(){this._itemChanged=!1},B$D.sortItem=function(B$O){B$O&&B$O.sort(function(B$O,B$J){return B$O.y-B$J.y})},B$D._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},B$i(0,B$D,"space",function(){return this._space},function(B$O){this._space=B$O,this._setItemChanged()}),B$i(0,B$D,"align",function(){return this._align},function(B$O){this._align=B$O,this._setItemChanged()}),B$J}(),B$Z=function(B$J){function B$D(B$O,B$J){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,B$D.__super.call(this),B$O&&(this.skin=B$O),B$J&&(this.sheet=B$J)}B$C(B$D,"laya.ui.FontClip",B$J);var B$O=B$D.prototype;return B$O.createChildren=function(){this._bitmap=new B$E,this.on("loaded",this,this._onClipLoaded)},B$O._onClipLoaded=function(){this.callLater(this.changeValue)},B$O.changeValue=function(){var B$O;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),B$O=this._sources[0]))){var B$J="horizontal"===this._direction;B$J?(this._wordsW=this._valueArr.length*(B$O.sourceWidth+this.spaceX),this._wordsH=B$O.sourceHeight):(this._wordsW=B$O.sourceWidth,this._wordsH=(B$O.sourceHeight+this.spaceY)*this._valueArr.length);var B$D=0;if(this._width)switch(this._align){case"center":B$D=.5*(this._width-this._wordsW);break;case"right":B$D=this._width-this._wordsW;break;default:B$D=0}for(var B$p=0,B$m=this._valueArr.length;B$p<B$m;B$p++){var B$C=this._indexMap[this._valueArr.charAt(B$p)];this.sources[B$C]&&(B$O=this.sources[B$C],B$J?this.graphics.drawTexture(B$O,B$D+B$p*(B$O.sourceWidth+this.spaceX),0,B$O.sourceWidth,B$O.sourceHeight):this.graphics.drawTexture(B$O,0+B$D,B$p*(B$O.sourceHeight+this.spaceY),B$O.sourceWidth,B$O.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),B$J.prototype.destroy.call(this,B$O)},B$i(0,B$O,"sheet",function(){return this._sheet},function(B$O){B$O+="";var B$J=(this._sheet=B$O).split(" ");this._clipX=String(B$J[0]).length,this.clipY=B$J.length,this._indexMap={};for(var B$D=0;B$D<this._clipY;B$D++)for(var B$p=B$J[B$D].split(""),B$m=0,B$C=B$p.length;B$m<B$C;B$m++)this._indexMap[B$p[B$m]]=B$D*this._clipX+B$m}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$R,this,"height",B$O),this.callLater(this.changeValue)}),B$i(0,B$O,"direction",function(){return this._direction},function(B$O){this._direction=B$O,this.callLater(this.changeValue)}),B$i(0,B$O,"value",function(){return this._valueArr?this._valueArr:""},function(B$O){B$O+="",this._valueArr=B$O,this.callLater(this.changeValue)}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$R,this,"width",B$O),this.callLater(this.changeValue)}),B$i(0,B$O,"spaceX",function(){return this._spaceX},function(B$O){this._spaceX=B$O,"horizontal"===this._direction&&this.callLater(this.changeValue)}),B$i(0,B$O,"spaceY",function(){return this._spaceY},function(B$O){this._spaceY=B$O,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),B$i(0,B$O,"align",function(){return this._align},function(B$O){this._align=B$O,this.callLater(this.changeValue)}),B$i(0,B$O,"measureWidth",function(){return this._wordsW}),B$i(0,B$O,"measureHeight",function(){return this._wordsH}),B$D}(B$R),B$n=function(B$O){function B$J(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new B$X,B$J.__super.call(this)}B$C(B$J,"laya.ui.List",B$O);var B$D=B$J.prototype;return B$c.imps(B$D,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),this._content&&this._content.destroy(B$O),this._scrollBar&&this._scrollBar.destroy(B$O),laya.ui.Component.prototype.destroy.call(this,B$O),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},B$D.createChildren=function(){this.addChild(this._content=new B$N)},B$D.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=B$c.superGet(B$N,this,"cacheAs")),B$c.superSet(B$N,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},B$D.onScrollEnd=function(){B$c.superSet(B$N,this,"cacheAs",this._$P.cacheAs)},B$D._removePreScrollBar=function(){var B$O=this.removeChildByName("scrollBar");B$O&&B$O.destroy(!0)},B$D.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var B$O=this._getOneCell(),B$J=B$O.width+this._spaceX||1,B$D=B$O.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/B$J):Math.ceil(this._width/B$J)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/B$D):Math.round(this._height/B$D));var B$p=this._width?this._width:B$J*this.repeatX-this._spaceX,B$m=this._height?this._height:B$D*this.repeatY-this._spaceY;this._cellSize=this._isVertical?B$D:B$J,this._cellOffset=this._isVertical?B$D*Math.max(this._repeatY2,this._repeatY)-B$m-this._spaceY:B$J*Math.max(this._repeatX2,this._repeatX)-B$p-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=B$m:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=B$p),this.setContentSize(B$p,B$m);var B$C=this._isVertical?this.repeatX:this.repeatY,B$i=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,B$C,B$i),this._createdLine=B$i,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},B$D._getOneCell=function(){if(0===this._cells.length){var B$O=this.createItem();if(this._offset.setTo(B$O.x,B$O.y),this.cacheContent)return B$O;this._cells.push(B$O)}return this._cells[0]},B$D._createItems=function(B$O,B$J,B$D){var B$p=this._content,B$m=this._getOneCell(),B$C=B$m.width+this._spaceX,B$i=B$m.height+this._spaceY;if(this.cacheContent){var B$k=new B$N;B$k.cacheAsBitmap=!0,B$k.pos((this._isVertical?0:B$O)*B$C,(this._isVertical?B$O:0)*B$i),this._content.addChild(B$k),this._content.optimizeScrollRect=!0,B$p=B$k}else{for(var B$_=[],B$L=this._cells.length-1;-1<B$L;B$L--){var B$r=this._cells[B$L];B$r.removeSelf(),B$_.push(B$r)}this._cells.length=0}for(var B$H=B$O;B$H<B$D;B$H++)for(var B$Y=0;B$Y<B$J;B$Y++)(B$m=B$_&&B$_.length?B$_.pop():this.createItem()).x=(this._isVertical?B$Y:B$H)*B$C-B$p.x,B$m.y=(this._isVertical?B$H:B$Y)*B$i-B$p.y,B$m.name="item"+(B$H*B$J+B$Y),B$p.addChild(B$m),this.addCell(B$m)},B$D.createItem=function(){var B$O=[];if("function"==typeof this._itemRender)var B$J=new this._itemRender;else B$J=B$I.createComp(this._itemRender,null,null,B$O);if(0==B$O.length&&B$J._watchMap){var B$D=B$J._watchMap;for(var B$p in B$D)for(var B$m=B$D[B$p],B$C=0;B$C<B$m.length;B$C++){var B$i=B$m[B$C];B$O.push(B$i.comp,B$i.prop,B$i.value)}}return B$O.length&&(B$J._$bindData=B$O),B$J},B$D.addCell=function(B$O){B$O.on("click",this,this.onCellMouse),B$O.on("rightclick",this,this.onCellMouse),B$O.on("mouseover",this,this.onCellMouse),B$O.on("mouseout",this,this.onCellMouse),B$O.on("mousedown",this,this.onCellMouse),B$O.on("mouseup",this,this.onCellMouse),this._cells.push(B$O)},B$D.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var B$O=0,B$J=B$O=0;B$J<1e4;B$J++){var B$D=this.getChildByName("item"+B$J);if(!B$D)break;this.addCell(B$D),B$O++}this.repeatY=B$O}},B$D.setContentSize=function(B$O,B$J){this._content.width=B$O,this._content.height=B$J,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new B$y),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,B$O,B$J),this._content.scrollRect=this._content.scrollRect),this.event("resize")},B$D.onCellMouse=function(B$O){"mousedown"===B$O.type&&(this._isMoved=!1);var B$J=B$O.currentTarget,B$D=this._startIndex+this._cells.indexOf(B$J);B$D<0||("click"===B$O.type||"rightclick"===B$O.type?this.selectEnable&&!this._isMoved?this.selectedIndex=B$D:this.changeCellState(B$J,!0,0):"mouseover"!==B$O.type&&"mouseout"!==B$O.type||this._selectedIndex===B$D||this.changeCellState(B$J,"mouseover"===B$O.type,0),this.mouseHandler&&this.mouseHandler.runWith([B$O,B$D]))},B$D.changeCellState=function(B$O,B$J,B$D){var B$p=B$O.getChildByName("selectBox");B$p&&(this.selectEnable=!0,B$p.visible=B$J,B$p.index=B$D)},B$D.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},B$D.onScrollBarChange=function(B$O){this.runCallLater(this.changeCells);var B$J=this._scrollBar.value,B$D=this._isVertical?this.repeatX:this.repeatY,B$p=this._isVertical?this.repeatY:this.repeatX,B$m=Math.floor(B$J/this._cellSize);if(this.cacheContent)B$i=B$p+1,this._createdLine-B$m<B$i&&(this._createItems(this._createdLine,B$D,this._createdLine+B$i),this.renderItems(this._createdLine*B$D,0),this._createdLine+=B$i);else{var B$C=B$m*B$D,B$i=0;if(B$C>this._startIndex){B$i=B$C-this._startIndex;var B$k=!0,B$_=this._startIndex+B$D*(B$p+1);this._isMoved=!0}else B$C<this._startIndex&&(B$i=this._startIndex-B$C,B$k=!1,B$_=this._startIndex-1,this._isMoved=!0);for(var B$L=0;B$L<B$i;B$L++){if(B$k){var B$r=this._cells.shift();this._cells[this._cells.length]=B$r;var B$H=B$_+B$L}else B$r=this._cells.pop(),this._cells.unshift(B$r),B$H=B$_-B$L;var B$Y=Math.floor(B$H/B$D)*this._cellSize;this._isVertical?B$r.y=B$Y:B$r.x=B$Y,this.renderItem(B$r,B$H)}this._startIndex=B$C,this.changeSelectStatus()}var B$G=this._content.scrollRect;this._isVertical?(B$G.y=B$J-this._offset.y,B$G.x=-this._offset.x):(B$G.y=-this._offset.y,B$G.x=B$J-this._offset.x),this._content.scrollRect=B$G},B$D.posCell=function(B$O,B$J){if(this._scrollBar){var B$D=this._isVertical?this.repeatX:this.repeatY,B$p=(this._isVertical?this.repeatY:this.repeatX,Math.floor(B$J/B$D)*this._cellSize);this._isVertical?B$O.y=B$p:B$O.x=B$p}},B$D.changeSelectStatus=function(){for(var B$O=0,B$J=this._cells.length;B$O<B$J;B$O++)this.changeCellState(this._cells[B$O],this._selectedIndex===this._startIndex+B$O,1)},B$D.renderItems=function(B$O,B$J){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0);for(var B$D=B$O,B$p=B$J||this._cells.length;B$D<B$p;B$D++)this.renderItem(this._cells[B$D],this._startIndex+B$D);this.changeSelectStatus()},B$D.renderItem=function(B$O,B$J){this._array&&0<=B$J&&B$J<this._array.length?(B$O.visible=!0,B$O._$bindData?(B$O._dataSource=this._array[B$J],this._bindData(B$O,this._array[B$J])):B$O.dataSource=this._array[B$J],this.cacheContent||this.posCell(B$O,B$J),this.hasListener("render")&&this.event("render",[B$O,B$J]),this.renderHandler&&this.renderHandler.runWith([B$O,B$J])):(B$O.visible=!1,B$O.dataSource=null)},B$D._bindData=function(B$O,B$J){for(var B$D=B$O._$bindData,B$p=0,B$m=B$D.length;B$p<B$m;B$p++){var B$C=B$D[B$p++],B$i=B$D[B$p++],B$k=B$D[B$p],B$_=B$s.getBindFun(B$k);B$C[B$i]=B$_.call(this,B$J)}},B$D.refresh=function(){this.array=this._array},B$D.getItem=function(B$O){return-1<B$O&&B$O<this._array.length?this._array[B$O]:null},B$D.changeItem=function(B$O,B$J){-1<B$O&&B$O<this._array.length&&(this._array[B$O]=B$J,B$O>=this._startIndex&&B$O<this._startIndex+this._cells.length&&this.renderItem(this.getCell(B$O),B$O))},B$D.setItem=function(B$O,B$J){this.changeItem(B$O,B$J)},B$D.addItem=function(B$O){this._array.push(B$O),this.array=this._array},B$D.addItemAt=function(B$O,B$J){this._array.splice(B$J,0,B$O),this.array=this._array},B$D.deleteItem=function(B$O){this._array.splice(B$O,1),this.array=this._array},B$D.getCell=function(B$O){return this.runCallLater(this.changeCells),-1<B$O&&this._cells?this._cells[(B$O-this._startIndex)%this._cells.length]:null},B$D.scrollTo=function(B$O){if(this._scrollBar){var B$J=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(B$O/B$J)*this._cellSize}else this.startIndex=B$O},B$D.tweenTo=function(B$O,B$J,B$D){if(void 0===B$J&&(B$J=200),this._scrollBar){var B$p=this._isVertical?this.repeatX:this.repeatY;B$a.to(this._scrollBar,{value:Math.floor(B$O/B$p)*this._cellSize},B$J,null,B$D,0,!0)}else this.startIndex=B$O,B$D&&B$D.run()},B$D._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},B$D.commitMeasure=function(){this.runCallLater(this.changeCells)},B$i(0,B$D,"cacheAs",B$O.prototype._$get_cacheAs,function(B$O){B$c.superSet(B$N,this,"cacheAs",B$O),this._scrollBar&&(this._$P.cacheAs=null,"none"!==B$O?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),B$i(0,B$D,"content",function(){return this._content}),B$i(0,B$D,"height",B$O.prototype._$get_height,function(B$O){B$O!=this._height&&(B$c.superSet(B$N,this,"height",B$O),this._setCellChanged())}),B$i(0,B$D,"itemRender",function(){return this._itemRender},function(B$O){if(this._itemRender!=B$O){this._itemRender=B$O;for(var B$J=this._cells.length-1;-1<B$J;B$J--)this._cells[B$J].destroy();this._cells.length=0,this._setCellChanged()}}),B$i(0,B$D,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(B$O){this._removePreScrollBar();var B$J=new B$JO;B$J.name="scrollBar",B$J.right=0,B$O&&" "!=B$O&&(B$J.skin=B$O),this.scrollBar=B$J,this.addChild(B$J),this._setCellChanged()}),B$i(0,B$D,"page",function(){return this._page},function(B$O){this._page=B$O,this._array&&(this._page=0<B$O?B$O:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),B$i(0,B$D,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(B$O){this._removePreScrollBar();var B$J=new B$B;B$J.name="scrollBar",B$J.bottom=0,B$O&&" "!=B$O&&(B$J.skin=B$O),this.scrollBar=B$J,this.addChild(B$J),this._setCellChanged()}),B$i(0,B$D,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(B$O){this._repeatX=B$O,this._setCellChanged()}),B$i(0,B$D,"scrollBar",function(){return this._scrollBar},function(B$O){this._scrollBar!=B$O&&(this._scrollBar=B$O)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),B$i(0,B$D,"width",B$O.prototype._$get_width,function(B$O){B$O!=this._width&&(B$c.superSet(B$N,this,"width",B$O),this._setCellChanged())}),B$i(0,B$D,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(B$O){this._repeatY=B$O,this._setCellChanged()}),B$i(0,B$D,"spaceX",function(){return this._spaceX},function(B$O){this._spaceX=B$O,this._setCellChanged()}),B$i(0,B$D,"spaceY",function(){return this._spaceY},function(B$O){this._spaceY=B$O,this._setCellChanged()}),B$i(0,B$D,"selectedIndex",function(){return this._selectedIndex},function(B$O){this._selectedIndex!=B$O&&(this._selectedIndex=B$O,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(B$O),this.startIndex=this._startIndex)}),B$i(0,B$D,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(B$O){this.selectedIndex=this._array.indexOf(B$O)}),B$i(0,B$D,"length",function(){return this._array?this._array.length:0}),B$i(0,B$D,"selection",function(){return this.getCell(this._selectedIndex)},function(B$O){this.selectedIndex=this._startIndex+this._cells.indexOf(B$O)}),B$i(0,B$D,"startIndex",function(){return this._startIndex},function(B$O){this._startIndex=0<B$O?B$O:0,this.callLater(this.renderItems)}),B$i(0,B$D,"array",function(){return this._array},function(B$O){this.runCallLater(this.changeCells),this._array=B$O||[];var B$J=this._array.length;if(this.totalPage=Math.ceil(B$J/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<B$J?this._selectedIndex:B$J-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var B$D=this._isVertical?this.repeatX:this.repeatY,B$p=this._isVertical?this.repeatY:this.repeatX,B$m=Math.ceil(B$J/B$D);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=B$p/B$m,this._scrollBar.setScroll(0,(B$m-B$p)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),B$i(0,B$D,"dataSource",B$O.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)&&Math.floor(B$O)==B$O||"string"==typeof B$O?this.selectedIndex=parseInt(B$O):B$O instanceof Array?this.array=B$O:B$c.superSet(B$N,this,"dataSource",B$O)}),B$i(0,B$D,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),B$J}(B$N),B$B=function(B$O){function B$J(){B$J.__super.call(this)}return B$C(B$J,"laya.ui.HScrollBar",B$O),B$J.prototype.initialize=function(){B$O.prototype.initialize.call(this),this.slider.isVertical=!1},B$J}(B$l),B$S=function(B$O){function B$J(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,B$J.__super.call(this),this.width=this.height=100}B$C(B$J,"laya.ui.Panel",B$O);var B$D=B$J.prototype;return B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),laya.ui.Component.prototype.destroy.call(this,B$O),this._content&&this._content.destroy(B$O),this._vScrollBar&&this._vScrollBar.destroy(B$O),this._hScrollBar&&this._hScrollBar.destroy(B$O),this._vScrollBar=null,this._hScrollBar=null,this._content=null},B$D.destroyChildren=function(){this._content.destroyChildren()},B$D.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new B$N)},B$D.addChild=function(B$O){return B$O.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(B$O)},B$D.onResize=function(){this._setScrollChanged()},B$D.addChildAt=function(B$O,B$J){return B$O.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(B$O,B$J)},B$D.removeChild=function(B$O){return B$O.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(B$O)},B$D.removeChildAt=function(B$O){return this.getChildAt(B$O).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(B$O)},B$D.removeChildren=function(B$O,B$J){return void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=2147483647),this._content.removeChildren(B$O,B$J),this._setScrollChanged(),this},B$D.getChildAt=function(B$O){return this._content.getChildAt(B$O)},B$D.getChildByName=function(B$O){return this._content.getChildByName(B$O)},B$D.getChildIndex=function(B$O){return this._content.getChildIndex(B$O)},B$D.changeScroll=function(){this._scrollChanged=!1;var B$O=this.contentWidth||1,B$J=this.contentHeight||1,B$D=this._vScrollBar,B$p=this._hScrollBar,B$m=B$D&&B$J>this._height,B$C=B$p&&B$O>this._width,B$i=B$m?this._width-B$D.width:this._width,B$k=B$C?this._height-B$p.height:this._height;B$D&&(B$D.x=this._width-B$D.width,B$D.y=0,B$D.height=this._height-(B$C?B$p.height:0),B$D.scrollSize=Math.max(.033*this._height,1),B$D.thumbPercent=B$k/B$J,B$D.setScroll(0,B$J-B$k,B$D.value)),B$p&&(B$p.x=0,B$p.y=this._height-B$p.height,B$p.width=this._width-(B$m?B$D.width:0),B$p.scrollSize=Math.max(.033*this._width,1),B$p.thumbPercent=B$i/B$O,B$p.setScroll(0,B$O-B$i,B$p.value))},B$D.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},B$D.setContentSize=function(B$O,B$J){var B$D=this._content;B$D.width=B$O,B$D.height=B$J,B$D.scrollRect||(B$D.scrollRect=new B$y),B$D.scrollRect.setTo(0,0,B$O,B$J),B$D.scrollRect=B$D.scrollRect},B$D.onScrollBarChange=function(B$O){var B$J=this._content.scrollRect;if(B$J){var B$D=Math.round(B$O.value);B$O.isVertical?B$J.y=B$D:B$J.x=B$D,this._content.scrollRect=B$J}},B$D.scrollTo=function(B$O,B$J){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),this.vScrollBar&&(this.vScrollBar.value=B$J),this.hScrollBar&&(this.hScrollBar.value=B$O)},B$D.refresh=function(){this.changeScroll()},B$D.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=B$c.superGet(B$N,this,"cacheAs")),B$c.superSet(B$N,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},B$D.onScrollEnd=function(){B$c.superSet(B$N,this,"cacheAs",this._$P.cacheAs)},B$D._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},B$i(0,B$D,"numChildren",function(){return this._content.numChildren}),B$i(0,B$D,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(B$O){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new B$B),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=B$O}),B$i(0,B$D,"contentWidth",function(){for(var B$O=0,B$J=this._content.numChildren-1;-1<B$J;B$J--){var B$D=this._content.getChildAt(B$J);B$O=Math.max(B$D.x+B$D.width*B$D.scaleX,B$O)}return B$O}),B$i(0,B$D,"contentHeight",function(){for(var B$O=0,B$J=this._content.numChildren-1;-1<B$J;B$J--){var B$D=this._content.getChildAt(B$J);B$O=Math.max(B$D.y+B$D.height*B$D.scaleY,B$O)}return B$O}),B$i(0,B$D,"width",B$O.prototype._$get_width,function(B$O){B$c.superSet(B$N,this,"width",B$O),this._setScrollChanged()}),B$i(0,B$D,"hScrollBar",function(){return this._hScrollBar}),B$i(0,B$D,"content",function(){return this._content}),B$i(0,B$D,"height",B$O.prototype._$get_height,function(B$O){B$c.superSet(B$N,this,"height",B$O),this._setScrollChanged()}),B$i(0,B$D,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(B$O){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new B$JO),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=B$O}),B$i(0,B$D,"vScrollBar",function(){return this._vScrollBar}),B$i(0,B$D,"cacheAs",B$O.prototype._$get_cacheAs,function(B$O){B$c.superSet(B$N,this,"cacheAs",B$O),this._$P.cacheAs=null,"none"!==B$O?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),B$J}(B$N),B$Q=function(B$O){function B$J(B$O){B$J.__super.call(this,B$O),this.isVertical=!1}return B$C(B$J,"laya.ui.HSlider",B$$),B$J}(),B$b=function(B$O){function B$D(B$O,B$J){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,B$D.__super.call(this),this.skin=B$J,this.labels=B$O}B$C(B$D,"laya.ui.UIGroup",B$O);var B$J=B$D.prototype;return B$c.imps(B$J,{"laya.ui.IItem":!0}),B$J.preinitialize=function(){this.mouseEnabled=!0},B$J.destroy=function(B$O){void 0===B$O&&(B$O=!0),laya.ui.Component.prototype.destroy.call(this,B$O),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},B$J.addItem=function(B$O,B$J){void 0===B$J&&(B$J=!0);var B$D=B$O,B$p=this._items.length;if(B$D.name="item"+B$p,this.addChild(B$D),this.initItems(),B$J&&0<B$p){var B$m=this._items[B$p-1];"horizontal"==this._direction?B$D.x=B$m.x+B$m.width+this._space:B$D.y=B$m.y+B$m.height+this._space}else B$J&&(B$D.x=0,B$D.y=0);return B$p},B$J.delItem=function(B$O,B$J){void 0===B$J&&(B$J=!0);var B$D=this._items.indexOf(B$O);if(-1!=B$D){var B$p=B$O;this.removeChild(B$p);for(var B$m=B$D+1,B$C=this._items.length;B$m<B$C;B$m++){var B$i=this._items[B$m];B$i.name="item"+(B$m-1),B$J&&("horizontal"==this._direction?B$i.x-=B$p.width+this._space:B$i.y-=B$p.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var B$k;B$k=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=B$k}}},B$J.initItems=function(){this._items||(this._items=[]);for(var B$O=this._items.length=0;B$O<1e4;B$O++){var B$J=this.getChildByName("item"+B$O);if(null==B$J)break;this._items.push(B$J),B$J.selected=B$O===this._selectedIndex,B$J.clickHandler=B$Y.create(this,this.itemClick,[B$O],!1)}},B$J.itemClick=function(B$O){this.selectedIndex=B$O},B$J.setSelect=function(B$O,B$J){this._items&&-1<B$O&&B$O<this._items.length&&(this._items[B$O].selected=B$J)},B$J.createItem=function(B$O,B$J){return null},B$J.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var B$O=0,B$J=0,B$D=this._items.length;B$J<B$D;B$J++){var B$p=this._items[B$J];this._skin&&(B$p.skin=this._skin),this._labelColors&&(B$p.labelColors=this._labelColors),this._labelSize&&(B$p.labelSize=this._labelSize),this._labelStroke&&(B$p.labelStroke=this._labelStroke),this._labelStrokeColor&&(B$p.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(B$p.strokeColors=this._strokeColors),this._labelBold&&(B$p.labelBold=this._labelBold),this._labelPadding&&(B$p.labelPadding=this._labelPadding),this._labelAlign&&(B$p.labelAlign=this._labelAlign),this._stateNum&&(B$p.stateNum=this._stateNum),this._labelFont&&(B$p.labelFont=this._labelFont),"horizontal"===this._direction?(B$p.y=0,B$p.x=B$O,B$O+=B$p.width+this._space):(B$p.x=0,B$p.y=B$O,B$O+=B$p.height+this._space)}this.changeSize()},B$J.commitMeasure=function(){this.runCallLater(this.changeLabels)},B$J._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},B$i(0,B$J,"labelStrokeColor",function(){return this._labelStrokeColor},function(B$O){this._labelStrokeColor!=B$O&&(this._labelStrokeColor=B$O,this._setLabelChanged())}),B$i(0,B$J,"skin",function(){return this._skin},function(B$O){this._skin!=B$O&&(this._skin=B$O,this._setLabelChanged())}),B$i(0,B$J,"selectedIndex",function(){return this._selectedIndex},function(B$O){this._selectedIndex!=B$O&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=B$O,this.setSelect(B$O,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),B$i(0,B$J,"labels",function(){return this._labels},function(B$O){if(this._labels!=B$O){if(this._labels=B$O,this.removeChildren(),this._setLabelChanged(),this._labels)for(var B$J=this._labels.split(","),B$D=0,B$p=B$J.length;B$D<B$p;B$D++){var B$m=this.createItem(this._skin,B$J[B$D]);B$m.name="item"+B$D,this.addChild(B$m)}this.initItems()}}),B$i(0,B$J,"strokeColors",function(){return this._strokeColors},function(B$O){this._strokeColors!=B$O&&(this._strokeColors=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelColors",function(){return this._labelColors},function(B$O){this._labelColors!=B$O&&(this._labelColors=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelStroke",function(){return this._labelStroke},function(B$O){this._labelStroke!=B$O&&(this._labelStroke=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelSize",function(){return this._labelSize},function(B$O){this._labelSize!=B$O&&(this._labelSize=B$O,this._setLabelChanged())}),B$i(0,B$J,"stateNum",function(){return this._stateNum},function(B$O){this._stateNum!=B$O&&(this._stateNum=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelBold",function(){return this._labelBold},function(B$O){this._labelBold!=B$O&&(this._labelBold=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelFont",function(){return this._labelFont},function(B$O){this._labelFont!=B$O&&(this._labelFont=B$O,this._setLabelChanged())}),B$i(0,B$J,"labelPadding",function(){return this._labelPadding},function(B$O){this._labelPadding!=B$O&&(this._labelPadding=B$O,this._setLabelChanged())}),B$i(0,B$J,"direction",function(){return this._direction},function(B$O){this._direction=B$O,this._setLabelChanged()}),B$i(0,B$J,"space",function(){return this._space},function(B$O){this._space=B$O,this._setLabelChanged()}),B$i(0,B$J,"items",function(){return this._items}),B$i(0,B$J,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(B$O){this.selectedIndex=this._items.indexOf(B$O)}),B$i(0,B$J,"dataSource",B$O.prototype._$get_dataSource,function(B$O){"number"==typeof(this._dataSource=B$O)&&Math.floor(B$O)==B$O||"string"==typeof B$O?this.selectedIndex=parseInt(B$O):B$O instanceof Array?this.labels=B$O.join(","):B$c.superSet(B$N,this,"dataSource",B$O)}),B$D}(B$N),B$K=function(B$J){function B$D(B$O,B$J){this._value=null,void 0===B$J&&(B$J=""),B$D.__super.call(this,B$O,B$J)}B$C(B$D,"laya.ui.Radio",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._value=null},B$O.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},B$O.initialize=function(){B$J.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},B$O.onClick=function(B$O){this.selected=!0},B$i(0,B$O,"value",function(){return null!=this._value?this._value:this.label},function(B$O){this._value=B$O}),B$D}(B$F),B$f=function(B$O){function B$J(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,B$J.__super.call(this),this.width=this.height=200}B$C(B$J,"laya.ui.Tree",B$O);var B$D=B$J.prototype;return B$c.imps(B$D,{"laya.ui.IRender":!0}),B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),laya.ui.Component.prototype.destroy.call(this,B$O),this._list&&this._list.destroy(B$O),this._list=null,this._source=null,this._renderHandler=null},B$D.createChildren=function(){this.addChild(this._list=new B$n),this._list.renderHandler=B$Y.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},B$D.onListChange=function(B$O){this.event("change")},B$D.getArray=function(){var B$O,B$J=[];for(var B$D in this._source)B$O=this._source[B$D],this.getParentOpenStatus(B$O)&&(B$O.x=this._spaceLeft*this.getDepth(B$O),B$J.push(B$O));return B$J},B$D.getDepth=function(B$O,B$J){return void 0===B$J&&(B$J=0),null==B$O.nodeParent?B$J:this.getDepth(B$O.nodeParent,B$J+1)},B$D.getParentOpenStatus=function(B$O){var B$J=B$O.nodeParent;return null==B$J||!!B$J.isOpen&&(null==B$J.nodeParent||this.getParentOpenStatus(B$J))},B$D.renderItem=function(B$O,B$J){var B$D=B$O.dataSource;if(B$D){B$O.left=B$D.x;var B$p=B$O.getChildByName("arrow");B$p&&(B$D.hasChild?(B$p.visible=!0,B$p.index=B$D.isOpen?1:0,B$p.tag=B$J,B$p.off("click",this,this.onArrowClick),B$p.on("click",this,this.onArrowClick)):B$p.visible=!1);var B$m=B$O.getChildByName("folder");B$m&&(2==B$m.clipY?B$m.index=B$D.isDirectory?0:1:B$m.index=B$D.isDirectory?B$D.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([B$O,B$J])}},B$D.onArrowClick=function(B$O){var B$J=B$O.currentTarget.tag;this._list.array[B$J].isOpen=!this._list.array[B$J].isOpen,this.event("open"),this._list.array=this.getArray()},B$D.setItemState=function(B$O,B$J){this._list.array[B$O]&&(this._list.array[B$O].isOpen=B$J,this._list.array=this.getArray())},B$D.fresh=function(){this._list.array=this.getArray(),this.repaint()},B$D.parseXml=function(B$O,B$J,B$D,B$p){var B$m,B$C=B$O.childNodes,B$i=B$C.length;if(!B$p){B$m={};var B$k,B$_=B$O.attributes;for(var B$L in B$_){var B$r=(B$k=B$_[B$L]).nodeName,B$H=B$k.nodeValue;B$m[B$r]="true"==B$H||"false"!=B$H&&B$H}B$m.nodeParent=B$D,0<B$i&&(B$m.isDirectory=!0),B$m.hasChild=0<B$i,B$J.push(B$m)}for(var B$Y=0;B$Y<B$i;B$Y++){var B$G=B$C[B$Y];this.parseXml(B$G,B$J,B$m,!1)}},B$D.parseOpenStatus=function(B$O,B$J){for(var B$D=0,B$p=B$J.length;B$D<B$p;B$D++){var B$m=B$J[B$D];if(B$m.isDirectory)for(var B$C=0,B$i=B$O.length;B$C<B$i;B$C++){var B$k=B$O[B$C];if(B$k.isDirectory&&this.isSameParent(B$k,B$m)&&B$m.label==B$k.label){B$m.isOpen=B$k.isOpen;break}}}},B$D.isSameParent=function(B$O,B$J){return null==B$O.nodeParent&&null==B$J.nodeParent||null!=B$O.nodeParent&&null!=B$J.nodeParent&&(B$O.nodeParent.label==B$J.nodeParent.label&&this.isSameParent(B$O.nodeParent,B$J.nodeParent))},B$D.filter=function(B$O){if(Boolean(B$O)){var B$J=[];this.getFilterSource(this._source,B$J,B$O),this._list.array=B$J}else this._list.array=this.getArray()},B$D.getFilterSource=function(B$O,B$J,B$D){var B$p;for(var B$m in B$D=B$D.toLocaleLowerCase(),B$O)!(B$p=B$O[B$m]).isDirectory&&-1<String(B$p.label).toLowerCase().indexOf(B$D)&&(B$p.x=0,B$J.push(B$p)),B$p.child&&0<B$p.child.length&&this.getFilterSource(B$p.child,B$J,B$D)},B$i(0,B$D,"spaceBottom",function(){return this._list.spaceY},function(B$O){this._list.spaceY=B$O}),B$i(0,B$D,"keepStatus",function(){return this._keepStatus},function(B$O){this._keepStatus=B$O}),B$i(0,B$D,"itemRender",function(){return this._list.itemRender},function(B$O){this._list.itemRender=B$O}),B$i(0,B$D,"array",function(){return this._list.array},function(B$O){this._keepStatus&&this._list.array&&B$O&&this.parseOpenStatus(this._list.array,B$O),this._source=B$O,this._list.array=this.getArray()}),B$i(0,B$D,"mouseHandler",function(){return this._list.mouseHandler},function(B$O){this._list.mouseHandler=B$O}),B$i(0,B$D,"dataSource",B$O.prototype._$get_dataSource,function(B$O){this._dataSource=B$O,B$c.superSet(B$N,this,"dataSource",B$O)}),B$i(0,B$D,"source",function(){return this._source}),B$i(0,B$D,"scrollBar",function(){return this._list.scrollBar}),B$i(0,B$D,"list",function(){return this._list}),B$i(0,B$D,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(B$O){this._list.vScrollBarSkin=B$O}),B$i(0,B$D,"renderHandler",function(){return this._renderHandler},function(B$O){this._renderHandler=B$O}),B$i(0,B$D,"selectedIndex",function(){return this._list.selectedIndex},function(B$O){this._list.selectedIndex=B$O}),B$i(0,B$D,"spaceLeft",function(){return this._spaceLeft},function(B$O){this._spaceLeft=B$O}),B$i(0,B$D,"selectedItem",function(){return this._list.selectedItem},function(B$O){this._list.selectedItem=B$O}),B$i(0,B$D,"width",B$O.prototype._$get_width,function(B$O){B$c.superSet(B$N,this,"width",B$O),this._list.width=B$O}),B$i(0,B$D,"height",B$O.prototype._$get_height,function(B$O){B$c.superSet(B$N,this,"height",B$O),this._list.height=B$O}),B$i(0,B$D,"xml",null,function(B$O){var B$J=[];this.parseXml(B$O.childNodes[0],B$J,null,!0),this.array=B$J}),B$i(0,B$D,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),B$J}(B$N),B$OO=function(B$O){function B$J(){this._items=null,this._selectedIndex=0,B$J.__super.call(this),this._setIndexHandler=B$Y.create(this,this.setIndex,null,!1)}B$C(B$J,"laya.ui.ViewStack",B$O);var B$D=B$J.prototype;return B$c.imps(B$D,{"laya.ui.IItem":!0}),B$D.setItems=function(B$O){this.removeChildren();for(var B$J=0,B$D=0,B$p=B$O.length;B$D<B$p;B$D++){var B$m=B$O[B$D];B$m&&(B$m.name="item"+B$J,this.addChild(B$m),B$J++)}this.initItems()},B$D.addItem=function(B$O){B$O.name="item"+this._items.length,this.addChild(B$O),this.initItems()},B$D.initItems=function(){this._items=[];for(var B$O=0;B$O<1e4;B$O++){var B$J=this.getChildByName("item"+B$O);if(null==B$J)break;this._items.push(B$J),B$J.visible=B$O==this._selectedIndex}},B$D.setSelect=function(B$O,B$J){this._items&&-1<B$O&&B$O<this._items.length&&(this._items[B$O].visible=B$J)},B$D.setIndex=function(B$O){this.selectedIndex=B$O},B$i(0,B$D,"dataSource",B$O.prototype._$get_dataSource,function(B$O){if("number"==typeof(this._dataSource=B$O)&&Math.floor(B$O)==B$O||"string"==typeof B$O)this.selectedIndex=parseInt(B$O);else for(var B$J in this._dataSource)this.hasOwnProperty(B$J)&&(this[B$J]=this._dataSource[B$J])}),B$i(0,B$D,"selectedIndex",function(){return this._selectedIndex},function(B$O){this._selectedIndex!=B$O&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=B$O,this.setSelect(this._selectedIndex,!0))}),B$i(0,B$D,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(B$O){this.selectedIndex=this._items.indexOf(B$O)}),B$i(0,B$D,"items",function(){return this._items}),B$i(0,B$D,"setIndexHandler",function(){return this._setIndexHandler},function(B$O){this._setIndexHandler=B$O}),B$J}(B$N),B$JO=function(B$O){function B$J(){B$J.__super.call(this)}return B$C(B$J,"laya.ui.VScrollBar",B$l),B$J}(),B$DO=function(B$J){function B$D(B$O){this._bg=null,this._skin=null,B$D.__super.call(this),void 0===B$O&&(B$O=""),this.text=B$O,this.skin=this.skin}B$C(B$D,"laya.ui.TextInput",B$J);var B$O=B$D.prototype;return B$O.preinitialize=function(){this.mouseEnabled=!0},B$O.destroy=function(B$O){B$v.clearCache(this,this._skin),void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._bg&&this._bg.destroy(),this._bg=null},B$O.createChildren=function(){this.addChild(this._tf=new B$G),this._tf.padding=B$g.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},B$O._onFocus=function(){this.event("focus",this)},B$O._onBlur=function(){this.event("blur",this)},B$O._onInput=function(){this.event("input",this)},B$O._onEnter=function(){this.event("enter",this)},B$O.initialize=function(){this.width=128,this.height=22},B$O.select=function(){this._tf.select()},B$O.setSelection=function(B$O,B$J){this._tf.setSelection(B$O,B$J)},B$i(0,B$O,"text",B$J.prototype._$get_text,function(B$O){this._tf.text!=B$O&&(B$O+="",this._tf.text=B$O,this.event("change"))}),B$i(0,B$O,"bg",function(){return this._bg},function(B$O){this.graphics=this._bg=B$O}),B$i(0,B$O,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(B$O){this._tf.inputElementYAdjuster=B$O}),B$i(0,B$O,"multiline",function(){return this._tf.multiline},function(B$O){this._tf.multiline=B$O}),B$i(0,B$O,"skin",function(){return this._skin},function(B$O){this._skin!=B$O&&(B$v.clearCache(this,this._skin),this._skin=B$O,this._bg||(this.graphics=this._bg=new B$E),B$v.keepCache(this,this._skin),this._bg.source=B$v.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),B$i(0,B$O,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(B$O){this._bg||(this.graphics=this._bg=new B$E),this._bg.sizeGrid=B$s.fillArray(B$g.defaultSizeGrid,B$O,Number)}),B$i(0,B$O,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(B$O){this._tf.inputElementXAdjuster=B$O}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$V,this,"width",B$O),this._bg&&(this._bg.width=B$O)}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$V,this,"height",B$O),this._bg&&(this._bg.height=B$O)}),B$i(0,B$O,"editable",function(){return this._tf.editable},function(B$O){this._tf.editable=B$O}),B$i(0,B$O,"restrict",function(){return this._tf.restrict},function(B$O){this._tf.restrict=B$O}),B$i(0,B$O,"prompt",function(){return this._tf.prompt},function(B$O){this._tf.prompt=B$O}),B$i(0,B$O,"promptColor",function(){return this._tf.promptColor},function(B$O){this._tf.promptColor=B$O}),B$i(0,B$O,"maxChars",function(){return this._tf.maxChars},function(B$O){this._tf.maxChars=B$O}),B$i(0,B$O,"focus",function(){return this._tf.focus},function(B$O){this._tf.focus=B$O}),B$i(0,B$O,"type",function(){return this._tf.type},function(B$O){this._tf.type=B$O}),B$i(0,B$O,"asPassword",function(){return this._tf.asPassword},function(B$O){this._tf.asPassword=B$O}),B$D}(B$V),B$pO=function(B$O){function B$J(){B$J.__super.call(this)}return B$C(B$J,"laya.ui.VSlider",B$$),B$J}(),B$mO=function(B$O){function B$p(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,B$p.__super.call(this)}B$C(B$p,"laya.ui.Dialog",B$O);var B$J=B$p.prototype;return B$J.initialize=function(){this.popupEffect=B$p.manager.popupEffectHandler,this.closeEffect=B$p.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},B$J._dealDragArea=function(){var B$O=this.getChildByName("drag");B$O&&(this.dragArea=B$O.x+","+B$O.y+","+B$O.width+","+B$O.height,B$O.removeSelf())},B$J._onClick=function(B$O){var B$J=B$O.target;if(B$J)switch(B$J.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(B$J.name)}},B$J.show=function(B$O,B$J){void 0===B$O&&(B$O=!1),void 0===B$J&&(B$J=!0),this._open(!1,B$O,B$J)},B$J.popup=function(B$O,B$J){void 0===B$O&&(B$O=!1),void 0===B$J&&(B$J=!0),this._open(!0,B$O,B$J)},B$J._open=function(B$O,B$J,B$D){B$p.manager.lock(!1),this.isModal=B$O,B$p.manager.open(this,B$J,B$D)},B$J.onOpened=function(){},B$J.close=function(B$O,B$J){void 0===B$J&&(B$J=!0),B$p.manager.close(this,B$O,B$J)},B$J.onClosed=function(B$O){},B$J._onMouseDown=function(B$O){var B$J=this.getMousePoint();this._dragArea.contains(B$J.x,B$J.y)?this.startDrag():this.stopDrag()},B$i(0,B$J,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(B$O){if(B$O){var B$J=B$s.fillArray([0,0,0,0],B$O,Number);this._dragArea=new B$y(B$J[0],B$J[1],B$J[2],B$J[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),B$i(0,B$J,"isPopup",function(){return null!=this.parent}),B$i(0,B$J,"zOrder",B$O.prototype._$get_zOrder,function(B$O){B$c.superSet(B$I,this,"zOrder",B$O),B$p.manager._checkMask()}),B$i(1,B$p,"manager",function(){return B$p._manager=B$p._manager||new B$W},function(B$O){B$p._manager=B$O}),B$p.setLockView=function(B$O){B$p.manager.setLockView(B$O)},B$p.lock=function(B$O){B$p.manager.lock(B$O)},B$p.closeAll=function(){B$p.manager.closeAll()},B$p.getDialogsByGroup=function(B$O){return B$p.manager.getDialogsByGroup(B$O)},B$p.closeByGroup=function(B$O){return B$p.manager.closeByGroup(B$O)},B$p.CLOSE="close",B$p.CANCEL="cancel",B$p.SURE="sure",B$p.NO="no",B$p.OK="ok",B$p.YES="yes",B$p._manager=null,B$p}(B$I),B$CO=function(B$O){function B$J(){B$J.__super.call(this)}B$C(B$J,"laya.ui.HBox",B$O);var B$D=B$J.prototype;return B$D.sortItem=function(B$O){B$O&&B$O.sort(function(B$O,B$J){return B$O.x-B$J.x})},B$D.changeItems=function(){this._itemChanged=!1;for(var B$O=[],B$J=0,B$D=0,B$p=this.numChildren;B$D<B$p;B$D++){var B$m=this.getChildAt(B$D);B$m&&B$m.layoutEnabled&&(B$O.push(B$m),B$J=this._height?this._height:Math.max(B$J,B$m.height*B$m.scaleY))}this.sortItem(B$O);var B$C=0;for(B$D=0,B$p=B$O.length;B$D<B$p;B$D++)(B$m=B$O[B$D]).x=B$C,B$C+=B$m.width*B$m.scaleX+this._space,"top"==this._align?B$m.y=0:"middle"==this._align?B$m.y=.5*(B$J-B$m.height*B$m.scaleY):"bottom"==this._align&&(B$m.y=B$J-B$m.height*B$m.scaleY);this.changeSize()},B$i(0,B$D,"height",B$O.prototype._$get_height,function(B$O){this._height!=B$O&&(B$c.superSet(B$U,this,"height",B$O),this.callLater(this.changeItems))}),B$J.NONE="none",B$J.TOP="top",B$J.MIDDLE="middle",B$J.BOTTOM="bottom",B$J}(B$U),B$iO=function(B$O){function B$J(){B$J.__super.call(this)}B$C(B$J,"laya.ui.VBox",B$O);var B$D=B$J.prototype;return B$D.changeItems=function(){this._itemChanged=!1;for(var B$O=[],B$J=0,B$D=0,B$p=this.numChildren;B$D<B$p;B$D++){var B$m=this.getChildAt(B$D);B$m&&B$m.layoutEnabled&&(B$O.push(B$m),B$J=this._width?this._width:Math.max(B$J,B$m.width*B$m.scaleX))}this.sortItem(B$O);var B$C=0;for(B$D=0,B$p=B$O.length;B$D<B$p;B$D++)(B$m=B$O[B$D]).y=B$C,B$C+=B$m.height*B$m.scaleY+this._space,"left"==this._align?B$m.x=0:"center"==this._align?B$m.x=.5*(B$J-B$m.width*B$m.scaleX):"right"==this._align&&(B$m.x=B$J-B$m.width*B$m.scaleX);this.changeSize()},B$i(0,B$D,"width",B$O.prototype._$get_width,function(B$O){this._width!=B$O&&(B$c.superSet(B$U,this,"width",B$O),this.callLater(this.changeItems))}),B$J.NONE="none",B$J.LEFT="left",B$J.CENTER="center",B$J.RIGHT="right",B$J}(B$U),B$kO=function(B$O){function B$J(){B$J.__super.call(this)}return B$C(B$J,"laya.ui.RadioGroup",B$b),B$J.prototype.createItem=function(B$O,B$J){return new B$K(B$O,B$J)},B$J}(),B$_O=function(B$O){function B$J(){B$J.__super.call(this)}return B$C(B$J,"laya.ui.Tab",B$b),B$J.prototype.createItem=function(B$O,B$J){return new B$F(B$O,B$J)},B$J}(),B$LO=function(B$J){function B$D(B$O){this._vScrollBar=null,this._hScrollBar=null,void 0===B$O&&(B$O=""),B$D.__super.call(this,B$O)}B$C(B$D,"laya.ui.TextArea",B$J);var B$O=B$D.prototype;return B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},B$O.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},B$O.onVBarChanged=function(B$O){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},B$O.onHBarChanged=function(B$O){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},B$O.changeScroll=function(){var B$O=this._vScrollBar&&0<this._tf.maxScrollY,B$J=this._hScrollBar&&0<this._tf.maxScrollX,B$D=B$O?this._width-this._vScrollBar.width:this._width,B$p=B$J?this._height-this._hScrollBar.height:this._height,B$m=this._tf.padding||B$g.labelPadding;this._tf.width=B$D,this._tf.height=B$p,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-B$m[2],this._vScrollBar.y=B$m[1],this._vScrollBar.height=this._height-(B$J?this._hScrollBar.height:0)-B$m[1]-B$m[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=B$p/Math.max(this._tf.textHeight,B$p),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=B$O),this._hScrollBar&&(this._hScrollBar.x=B$m[0],this._hScrollBar.y=this._height-this._hScrollBar.height-B$m[3],this._hScrollBar.width=this._width-(B$O?this._vScrollBar.width:0)-B$m[0]-B$m[2],this._hScrollBar.scrollSize=Math.max(.033*B$D,1),this._hScrollBar.thumbPercent=B$D/Math.max(this._tf.textWidth,B$D),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=B$J)},B$O.scrollTo=function(B$O){this.commitMeasure(),this._tf.scrollY=B$O},B$i(0,B$O,"scrollY",function(){return this._tf.scrollY}),B$i(0,B$O,"width",B$J.prototype._$get_width,function(B$O){B$c.superSet(B$DO,this,"width",B$O),this.callLater(this.changeScroll)}),B$i(0,B$O,"hScrollBar",function(){return this._hScrollBar}),B$i(0,B$O,"height",B$J.prototype._$get_height,function(B$O){B$c.superSet(B$DO,this,"height",B$O),this.callLater(this.changeScroll)}),B$i(0,B$O,"maxScrollX",function(){return this._tf.maxScrollX}),B$i(0,B$O,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(B$O){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new B$JO),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=B$O}),B$i(0,B$O,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(B$O){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new B$B),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=B$O}),B$i(0,B$O,"vScrollBar",function(){return this._vScrollBar}),B$i(0,B$O,"maxScrollY",function(){return this._tf.maxScrollY}),B$i(0,B$O,"scrollX",function(){return this._tf.scrollX}),B$D}(B$DO);!function(B$O){function B$J(){this._uiView=null,this.isCloseOther=!1,B$J.__super.call(this)}B$C(B$J,"laya.ui.AsynDialog",B$mO);var B$D=B$J.prototype;B$D.createView=function(B$O){this._uiView=B$O},B$D._open=function(B$O,B$J,B$D){this.isModal=B$O,this.isCloseOther=B$J,B$mO.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},B$D.onCreated=function(){this.createUI(),this.onOpen()},B$D.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},B$D.onOpen=function(){B$mO.manager.open(this,this.isCloseOther),B$mO.manager.lock(!1)},B$D.close=function(B$O,B$J){void 0===B$J&&(B$J=!0),B$mO.manager.close(this),this.onClose()},B$D.onClose=function(){},B$D.destroy=function(B$O){void 0===B$O&&(B$O=!0),laya.ui.View.prototype.destroy.call(this,B$O),this._uiView=null,this.onDestroy()},B$D.onDestroy=function(){}}();B$c.__init([B$I])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}}),function(B$Y,B$O,B$d){B$d.un,B$d.uns;var B$H=B$d.static,B$G=B$d.class,B$X=B$d.getset,B$p=B$d.__newvec,B$q=laya.maths.Arith,B$i=laya.webgl.atlas.AtlasResourceManager,B$D=laya.webgl.shader.BaseShader,B$o=laya.utils.Browser,B$k=laya.webgl.utils.Buffer,B$M=laya.utils.Byte,B$m=laya.utils.ClassUtils,B$_=B$d.Config,B$C=(laya.events.Event,laya.events.EventDispatcher),B$g=laya.utils.Handler,B$y=laya.net.Loader,B$J=laya.net.LoaderManager,B$L=(laya.maths.MathUtil,laya.display.Node),B$c=laya.renders.Render,B$r=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),B$h=laya.resource.Resource,B$v=laya.utils.RunDriver,B$A=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),B$a=laya.display.Sprite,B$e=laya.utils.Stat,B$t=laya.utils.StringKey,B$s=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),B$z=laya.utils.Utils,B$P=laya.webgl.WebGL,B$E=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;B$d.interface("laya.d3.core.IClone"),B$d.interface("laya.d3.graphics.IVertex"),B$d.interface("laya.d3.core.render.IUpdate"),B$d.interface("laya.d3.core.scene.ITreeNode"),B$d.interface("laya.d3.core.render.IRenderable");(function(){function B$F(){}B$G(B$F,"laya.d3.animation.AnimationClipParser01"),B$F.READ_DATA=function(){B$F._DATA.offset=B$F._reader.getUint32(),B$F._DATA.size=B$F._reader.getUint32()},B$F.READ_BLOCK=function(){for(var B$O=B$F._BLOCK.count=B$F._reader.getUint16(),B$J=B$F._BLOCK.blockStarts=[],B$D=B$F._BLOCK.blockLengths=[],B$p=0;B$p<B$O;B$p++)B$J.push(B$F._reader.getUint32()),B$D.push(B$F._reader.getUint32())},B$F.READ_STRINGS=function(){var B$O=B$F._reader.getUint32(),B$J=B$F._reader.getUint16(),B$D=B$F._reader.pos;B$F._reader.pos=B$O+B$F._DATA.offset;for(var B$p=0;B$p<B$J;B$p++)B$F._strings[B$p]=B$F._reader.readUTFString();B$F._reader.pos=B$D},B$F.parse=function(B$O,B$J){B$F._animationClip=B$O;(B$F._reader=B$J).__getBuffer();B$F.READ_DATA(),B$F.READ_BLOCK(),B$F.READ_STRINGS();for(var B$D=0,B$p=B$F._BLOCK.count;B$D<B$p;B$D++){var B$m=B$J.getUint16(),B$C=B$F._strings[B$m],B$i=B$F["READ_"+B$C];if(null==B$i)throw new Error("model file err,no this function:"+B$m+" "+B$C);B$i.call()}},B$F.READ_ANIMATIONS=function(){var B$O,B$J=0,B$D=0,B$p=B$F._reader,B$m=B$p.__getBuffer(),B$C=[],B$i=B$p.getUint8();for(B$C.length=B$i,B$J=0;B$J<B$i;B$J++)B$C[B$J]=B$p.getUint16();var B$k=[],B$_=B$p.getUint16();for(B$k.length=B$_,B$J=0;B$J<B$_;B$J++)B$k[B$J]=B$p.getFloat32();var B$L=B$F._animationClip;B$L.name=B$F._strings[B$p.getUint16()];var B$r=B$L._duration=B$p.getFloat32();B$L.islooping=!!B$p.getByte(),B$L._frameRate=B$p.getInt16();var B$H=B$p.getInt16(),B$Y=B$L._nodes=new Array;B$Y.length=B$H,(B$L._publicClipDatas=[]).length=B$H;var B$G=B$L._nodesMap={},B$X=0,B$c=0;for(B$J=0;B$J<B$H;B$J++){B$O=B$Y[B$J]=new B$T;var B$h=B$p.getUint16(),B$y=B$O.path=[];for(B$y.length=B$h,B$D=0;B$D<B$h;B$D++)B$y[B$D]=B$F._strings[B$p.getUint16()];var B$v=B$y.join("/"),B$A=B$G[B$v];B$A||(B$G[B$v]=B$A=[]),B$A.push(B$O);var B$q=B$p.getInt16();-1!==B$q&&(B$O.componentType=B$F._strings[B$q]);var B$d=B$x._propertyIndexDic[B$F._strings[B$p.getUint16()]];if(null==B$d)throw new Error("AnimationClipParser01:unknown property name.");var B$M=B$d<4,B$a=!B$M||B$M&&""===B$y[0];(B$O._cacheProperty=B$a)?B$X++:B$c++,B$O.propertyNameID=B$d;var B$e=B$C[B$p.getUint8()];B$O.keyFrameWidth=B$e/4;var B$t=B$O.keyFrames=[],B$z=B$t.length=B$p.getUint16(),B$g=null,B$s=NaN;for(B$D=0;B$D<B$z;B$D++){var B$P=B$t[B$D]=new B$V;B$s=B$P.startTime=B$k[B$p.getUint16()];var B$E=B$p.pos;B$P.inTangent=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$E=B$p.pos,B$P.outTangent=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$E=B$p.pos,B$P.data=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$g&&(B$g.next=B$P,B$g.duration=B$s-B$g.startTime),B$g=B$P}B$P.next=null,B$P.duration=B$r-B$s}var B$o=B$L._nodeToCachePropertyMap=new Int32Array(B$H),B$W=B$L._cachePropertyMap=new Int32Array(B$X),B$N=B$L._unCachePropertyMap=new Int32Array(B$c);for(B$X=B$c=0,B$J=0;B$J<B$H;B$J++)(B$O=B$Y[B$J])._cacheProperty?(B$o[B$J]=B$X,B$W[B$X++]=B$J):B$N[B$c++]=B$J},B$F._animationClip=null,B$F._reader=null,B$F._strings=[],B$H(B$F,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function B$l(){}B$G(B$l,"laya.d3.animation.AnimationClipParser02"),B$l.READ_DATA=function(){B$l._DATA.offset=B$l._reader.getUint32(),B$l._DATA.size=B$l._reader.getUint32()},B$l.READ_BLOCK=function(){for(var B$O=B$l._BLOCK.count=B$l._reader.getUint16(),B$J=B$l._BLOCK.blockStarts=[],B$D=B$l._BLOCK.blockLengths=[],B$p=0;B$p<B$O;B$p++)B$J.push(B$l._reader.getUint32()),B$D.push(B$l._reader.getUint32())},B$l.READ_STRINGS=function(){var B$O=B$l._reader.getUint32(),B$J=B$l._reader.getUint16(),B$D=B$l._reader.pos;B$l._reader.pos=B$O+B$l._DATA.offset;for(var B$p=0;B$p<B$J;B$p++)B$l._strings[B$p]=B$l._reader.readUTFString();B$l._reader.pos=B$D},B$l.parse=function(B$O,B$J){B$l._animationClip=B$O;(B$l._reader=B$J).__getBuffer();B$l.READ_DATA(),B$l.READ_BLOCK(),B$l.READ_STRINGS();for(var B$D=0,B$p=B$l._BLOCK.count;B$D<B$p;B$D++){var B$m=B$J.getUint16(),B$C=B$l._strings[B$m],B$i=B$l["READ_"+B$C];if(null==B$i)throw new Error("model file err,no this function:"+B$m+" "+B$C);B$i.call()}},B$l.READ_ANIMATIONS=function(){var B$O,B$J=0,B$D=0,B$p=B$l._reader,B$m=B$p.__getBuffer(),B$C=[],B$i=B$p.getUint8();for(B$C.length=B$i,B$J=0;B$J<B$i;B$J++)B$C[B$J]=B$p.getUint16();var B$k=[],B$_=B$p.getUint16();for(B$k.length=B$_,B$J=0;B$J<B$_;B$J++)B$k[B$J]=B$p.getFloat32();var B$L=B$l._animationClip;B$L.name=B$l._strings[B$p.getUint16()];var B$r=B$L._duration=B$p.getFloat32();B$L.islooping=!!B$p.getByte(),B$L._frameRate=B$p.getInt16();var B$H=B$p.getInt16(),B$Y=B$L._nodes=new Array;B$Y.length=B$H,(B$L._publicClipDatas=[]).length=B$H;var B$G=B$L._nodesMap={},B$X=0,B$c=0;for(B$J=0;B$J<B$H;B$J++){B$O=B$Y[B$J]=new B$T;var B$h=B$p.getUint16(),B$y=B$O.path=[];for(B$y.length=B$h,B$D=0;B$D<B$h;B$D++)B$y[B$D]=B$l._strings[B$p.getUint16()];var B$v=B$y.join("/"),B$A=B$G[B$v];B$A||(B$G[B$v]=B$A=[]),B$A.push(B$O);var B$q=B$p.getInt16();-1!==B$q&&(B$O.componentType=B$l._strings[B$q]);var B$d=B$x._propertyIndexDic[B$l._strings[B$p.getUint16()]];if(null==B$d)throw new Error("AnimationClipParser02:unknown property name.");var B$M=B$d<4,B$a=!B$M||B$M&&""===B$y[0];(B$O._cacheProperty=B$a)?B$X++:B$c++,B$O.propertyNameID=B$d;var B$e=B$C[B$p.getUint8()];B$O.keyFrameWidth=B$e/4;var B$t=B$O.keyFrames=[],B$z=B$t.length=B$p.getUint16(),B$g=null,B$s=NaN;for(B$D=0;B$D<B$z;B$D++){var B$P=B$t[B$D]=new B$V;B$s=B$P.startTime=B$k[B$p.getUint16()];var B$E=B$p.pos;B$P.inTangent=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$E=B$p.pos,B$P.outTangent=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$E=B$p.pos,B$P.data=new Float32Array(B$m.slice(B$E,B$E+B$e)),B$p.pos+=B$e,B$g&&(B$g.next=B$P,B$g.duration=B$s-B$g.startTime),B$g=B$P}B$P.next=null,B$P.duration=B$r-B$s}var B$o=B$p.getUint16();for(B$J=0;B$J<B$o;B$J++){var B$W,B$N=new B$$;B$N.time=B$p.getFloat32(),B$N.eventName=B$l._strings[B$p.getUint16()];var B$F=B$p.getUint16();for(0<B$F&&(B$N.params=B$W=[]),B$D=0;B$D<B$F;B$D++){switch(B$p.getByte()){case 0:B$W.push(!!B$p.getByte());break;case 1:B$W.push(B$p.getInt32());break;case 2:B$W.push(B$p.getFloat32());break;case 3:B$W.push(B$l._strings[B$p.getUint16()]);break;default:throw new Error("unknown type.")}}B$L.addEvent(B$N)}var B$R=B$L._nodeToCachePropertyMap=new Int32Array(B$H),B$j=B$L._cachePropertyMap=new Int32Array(B$X),B$u=B$L._unCachePropertyMap=new Int32Array(B$c);for(B$X=B$c=0,B$J=0;B$J<B$H;B$J++)(B$O=B$Y[B$J])._cacheProperty?(B$R[B$J]=B$X,B$j[B$X++]=B$J):B$u[B$c++]=B$J},B$l._animationClip=null,B$l._reader=null,B$l._strings=[],B$H(B$l,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var B$$=function(){function B$O(){this.time=NaN,this.eventName=null,this.params=null}return B$G(B$O,"laya.d3.animation.AnimationEvent"),B$O}(),B$x=function(){function B$p(){this._childs=[],this.transform=new B$vJ(this)}B$G(B$p,"laya.d3.animation.AnimationNode");var B$O=B$p.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.addChild=function(B$O){B$O._parent=this,B$O.transform.setParent(this.transform),this._childs.push(B$O)},B$O.removeChild=function(B$O){var B$J=this._childs.indexOf(B$O);-1!==B$J&&this._childs.splice(B$J,1)},B$O.getChildByName=function(B$O){for(var B$J=0,B$D=this._childs.length;B$J<B$D;B$J++){var B$p=this._childs[B$J];if(B$p.name===B$O)return B$p}return null},B$O.getChildByIndex=function(B$O){return this._childs[B$O]},B$O.getChildCount=function(){return this._childs.length},B$O.cloneTo=function(B$O){var B$J=B$O;B$J.name=this.name;for(var B$D=0,B$p=this._childs.length;B$D<B$p;B$D++){var B$m=this._childs[B$D],B$C=B$m.clone();B$J.addChild(B$C);var B$i=B$m.transform,B$k=B$C.transform;B$k.setLocalPosition(B$i.getLocalPosition()),B$k.setLocalRotation(B$i.getLocalRotation()),B$k.setLocalScale(B$i.getLocalScale()),B$k._localRotationEuler=B$i._localRotationEuler,B$k._setWorldMatrixIgnoreUpdate(B$i.getWorldMatrix())}},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$p.__init__=function(){B$p.registerAnimationNodeProperty("localPosition",B$p._getLocalPosition,B$p._setLocalPosition),B$p.registerAnimationNodeProperty("localRotation",B$p._getLocalRotation,B$p._setLocalRotation),B$p.registerAnimationNodeProperty("localScale",B$p._getLocalScale,B$p._setLocalScale),B$p.registerAnimationNodeProperty("localRotationEuler",B$p._getLocalRotationEuler,B$p._setLocalRotationEuler),B$p.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",B$p._getParticleRenderSharedMaterialTintColor,B$p._setParticleRenderSharedMaterialTintColor),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",B$p._getMeshRenderSharedMaterialTilingOffset,B$p._setMeshRenderSharedMaterialTilingOffset),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",B$p._getMeshRenderSharedMaterialAlbedo,B$p._setMeshRenderSharedMaterialAlbedo),B$p.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",B$p._getSkinnedMeshRenderSharedMaterialTilingOffset,B$p._setSkinnedMeshRenderSharedMaterialTilingOffset),B$p.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",B$p._getSkinnedMeshRenderSharedMaterialAlbedo,B$p._setSkinnedMeshRenderSharedMaterialAlbedo),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",B$p._getMeshRenderSharedMaterialAlbedo,B$p._setMeshRenderSharedMaterialAlbedo),B$p.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",B$p._getSkinnedMeshRenderSharedMaterialAlbedo,B$p._setSkinnedMeshRenderSharedMaterialAlbedo),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",B$p._getMeshRenderSharedMaterialIntensity,B$p._setMeshRenderSharedMaterialIntensity),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",B$p._getMeshRenderSharedMaterialAlpha,B$p._setMeshRenderSharedMaterialAlpha),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",B$p._getMeshRenderSharedMaterialAlphaColor,B$p._setMeshRenderSharedMaterialAlphaColor),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",B$p._getMeshRenderSharedMaterialBaseColor,B$p._setMeshRenderSharedMaterialBaseColor),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",B$p._getMeshRenderSharedMaterialDissolve,B$p._setMeshRenderSharedMaterialDissolve),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",B$p._getMeshRenderSharedMaterialDissolveSpeed,B$p._setMeshRenderSharedMaterialDissolveSpeed),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",B$p._getMeshRenderSharedMaterialMMultiplier,B$p._setMeshRenderSharedMaterialMMultiplier),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",B$p._getMeshRenderSharedMaterialBaseScrollSpeedX,B$p._setMeshRenderSharedMaterialBaseScrollSpeedX),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",B$p._getMeshRenderSharedMaterialBaseScrollSpeedY,B$p._setMeshRenderSharedMaterialBaseScrollSpeedY),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",B$p._getMeshRenderSharedMaterialSecondScrollSpeedX,B$p._setMeshRenderSharedMaterialSecondScrollSpeedX),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",B$p._getMeshRenderSharedMaterialSecondScrollSpeedY,B$p._setMeshRenderSharedMaterialSecondScrollSpeedY),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",B$p._getMeshRenderSharedMaterialDetailTilingOffset,B$p._setMeshRenderSharedMaterialDetailTilingOffset),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",B$p._getMeshRenderSharedMaterialDissolveTilingOffset,B$p._setMeshRenderSharedMaterialDissolveTilingOffset),B$p.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",B$p._getMeshRenderSharedMaterialMaskTilingOffset,B$p._setMeshRenderSharedMaterialMaskTilingOffset)},B$p.registerAnimationNodeProperty=function(B$O,B$J,B$D){if(B$p._propertyIndexDic[B$O])throw new Error("AnimationNode: this propertyName has registered.");B$p._propertyIndexDic[B$O]=B$p._propertyIDCounter,B$p._propertyGetFuncs[B$p._propertyIDCounter]=B$J,B$p._propertySetFuncs[B$p._propertyIDCounter]=B$D,B$p._propertyIDCounter++},B$p._getLocalPosition=function(B$O,B$J){return B$O?B$O.transform.getLocalPosition():B$J._transform.localPosition.elements},B$p._setLocalPosition=function(B$O,B$J,B$D){if(B$O)B$O.transform.setLocalPosition(B$D);else{var B$p=B$J._transform,B$m=B$p.localPosition;B$m.elements=B$D,B$p.localPosition=B$m}},B$p._getLocalRotation=function(B$O,B$J){return B$O?B$O.transform.getLocalRotation():B$J._transform.localRotation.elements},B$p._setLocalRotation=function(B$O,B$J,B$D){if(B$O)B$O.transform.setLocalRotation(B$D);else{var B$p=B$J._transform,B$m=B$p.localRotation;B$m.elements=B$D,B$p.localRotation=B$m}},B$p._getLocalScale=function(B$O,B$J){return B$O?B$O.transform.getLocalScale():B$J._transform.localScale.elements},B$p._setLocalScale=function(B$O,B$J,B$D){if(B$O)B$O.transform.setLocalScale(B$D);else{var B$p=B$J._transform,B$m=B$p.localScale;B$m.elements=B$D,B$p.localScale=B$m}},B$p._getLocalRotationEuler=function(B$O,B$J){return B$O?B$O.transform.getLocalRotationEuler():B$J._transform.localRotationEuler.elements},B$p._setLocalRotationEuler=function(B$O,B$J,B$D){if(B$O)B$O.transform.setLocalRotationEuler(B$D);else{var B$p=B$J._transform,B$m=B$p.localRotationEuler;B$m.elements=B$D,B$p.localRotationEuler=B$m}},B$p._getMeshRenderSharedMaterialTilingOffset=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return B$J.meshRender.sharedMaterial.tilingOffset.elements},B$p._setMeshRenderSharedMaterialTilingOffset=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).tilingOffset).elements=B$D,B$p.tilingOffset=B$m)}else(B$m=(B$p=B$J.meshRender.material).tilingOffset).elements=B$D,B$p.tilingOffset=B$m},B$p._getMeshRenderSharedMaterialAlbedo=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.albedoColor.elements:null}return B$J.meshRender.sharedMaterial.albedoColor.elements},B$p._setMeshRenderSharedMaterialAlbedo=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).albedoColor).elements=B$D,B$p.albedoColor=B$m)}else(B$m=(B$p=B$J.meshRender.material).albedoColor).elements=B$D,B$p.albedoColor=B$m},B$p._getSkinnedMeshRenderSharedMaterialTilingOffset=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return B$J.skinnedMeshRender.sharedMaterial.tilingOffset.elements},B$p._setSkinnedMeshRenderSharedMaterialTilingOffset=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.skinnedMeshRender.material).tilingOffset).elements=B$D,B$p.tilingOffset=B$m)}else(B$m=(B$p=B$J.skinnedMeshRender.material).tilingOffset).elements=B$D,B$p.tilingOffset=B$m},B$p._getSkinnedMeshRenderSharedMaterialAlbedo=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return B$J.skinnedMeshRender.sharedMaterial.albedoColor.elements},B$p._setSkinnedMeshRenderSharedMaterialAlbedo=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.skinnedMeshRender.material).albedoColor).elements=B$D,B$p.albedoColor=B$m)}else(B$m=(B$p=B$J.skinnedMeshRender.material).albedoColor).elements=B$D,B$p.albedoColor=B$m},B$p._getParticleRenderSharedMaterialTintColor=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.particleRender.sharedMaterial.tintColor.elements:null}return B$J.particleRender.sharedMaterial.tintColor.elements},B$p._setParticleRenderSharedMaterialTintColor=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.particleRender.material).tintColor).elements=B$D,B$p.tintColor=B$m)}else(B$m=(B$p=B$J.particleRender.material).tintColor).elements=B$D,B$p.tintColor=B$m},B$p._getMeshRenderSharedMaterialAlphaColor=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.alphaColor.elements:null}return B$J.meshRender.sharedMaterial.alphaColor.elements},B$p._setMeshRenderSharedMaterialAlphaColor=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).alphaColor).elements=B$D,B$p.alphaColor=B$m)}else(B$m=(B$p=B$J.meshRender.material).alphaColor).elements=B$D,B$p.alphaColor=B$m},B$p._getMeshRenderSharedMaterialBaseColor=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.baseColor.elements:null}return B$J.meshRender.sharedMaterial.baseColor.elements},B$p._setMeshRenderSharedMaterialBaseColor=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).baseColor).elements=B$D,B$p.baseColor=B$m)}else(B$m=(B$p=B$J.meshRender.material).baseColor).elements=B$D,B$p.baseColor=B$m},B$p._getMeshRenderSharedMaterialDissolve=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.dissolve:0}return B$J.meshRender.sharedMaterial.dissolve},B$p._setMeshRenderSharedMaterialDissolve=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.dissolve=B$D[0])}else B$J.meshRender.material.dissolve=B$D[0]},B$p._getMeshRenderSharedMaterialDissolveSpeed=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.dissolveSpeed:0}return B$J.meshRender.sharedMaterial.dissolveSpeed},B$p._setMeshRenderSharedMaterialDissolveSpeed=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.dissolveSpeed=B$D[0])}else B$J.meshRender.material.dissolveSpeed=B$D[0]},B$p._getMeshRenderSharedMaterialMMultiplier=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.mMultiplier:0}return B$J.meshRender.sharedMaterial.mMultiplier},B$p._setMeshRenderSharedMaterialMMultiplier=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.mMultiplier=B$D[0])}else B$J.meshRender.material.mMultiplier=B$D[0]},B$p._getMeshRenderSharedMaterialBaseScrollSpeedX=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return B$J.meshRender.sharedMaterial.baseScrollSpeedX},B$p._setMeshRenderSharedMaterialBaseScrollSpeedX=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.baseScrollSpeedX=B$D[0])}else B$J.meshRender.material.baseScrollSpeedX=B$D[0]},B$p._getMeshRenderSharedMaterialBaseScrollSpeedY=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return B$J.meshRender.sharedMaterial.baseScrollSpeedY},B$p._setMeshRenderSharedMaterialBaseScrollSpeedY=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.baseScrollSpeedY=B$D[0])}else B$J.meshRender.material.baseScrollSpeedY=B$D[0]},B$p._getMeshRenderSharedMaterialSecondScrollSpeedX=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return B$J.meshRender.sharedMaterial.secondScrollSpeedX},B$p._setMeshRenderSharedMaterialSecondScrollSpeedX=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.secondScrollSpeedX=B$D[0])}else B$J.meshRender.material.secondScrollSpeedX=B$D[0]},B$p._getMeshRenderSharedMaterialSecondScrollSpeedY=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return B$J.meshRender.sharedMaterial.secondScrollSpeedY},B$p._setMeshRenderSharedMaterialSecondScrollSpeedY=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.secondScrollSpeedY=B$D[0])}else B$J.meshRender.material.secondScrollSpeedY=B$D[0]},B$p._getMeshRenderSharedMaterialAlpha=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.alpha:0}return B$J.meshRender.sharedMaterial.alpha},B$p._setMeshRenderSharedMaterialAlpha=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.alpha=B$D[0])}else B$J.meshRender.material.alpha=B$D[0]},B$p._getMeshRenderSharedMaterialIntensity=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.intensity:0}return B$J.meshRender.sharedMaterial.intensity},B$p._setMeshRenderSharedMaterialIntensity=function(B$O,B$J,B$D){if(B$O){var B$p=B$O.transform._entity;B$p&&(B$p.owner.meshRender.material.intensity=B$D[0])}else B$J.meshRender.material.intensity=B$D[0]},B$p._getMeshRenderSharedMaterialDetailTilingOffset=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return B$J.meshRender.sharedMaterial.detailTilingOffset.elements},B$p._setMeshRenderSharedMaterialDetailTilingOffset=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).detailTilingOffset).elements=B$D,B$p.detailTilingOffset=B$m)}else(B$m=(B$p=B$J.meshRender.material).detailTilingOffset).elements=B$D,B$p.detailTilingOffset=B$m},B$p._getMeshRenderSharedMaterialDissolveTilingOffset=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return B$J.meshRender.sharedMaterial.dissolveTilingOffset.elements},B$p._setMeshRenderSharedMaterialDissolveTilingOffset=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).dissolveTilingOffset).elements=B$D,B$p.dissolveTilingOffset=B$m)}else(B$m=(B$p=B$J.meshRender.material).dissolveTilingOffset).elements=B$D,B$p.dissolveTilingOffset=B$m},B$p._getMeshRenderSharedMaterialMaskTilingOffset=function(B$O,B$J){if(B$O){var B$D=B$O.transform._entity;return B$D?B$D.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return B$J.meshRender.sharedMaterial.maskTilingOffset.elements},B$p._setMeshRenderSharedMaterialMaskTilingOffset=function(B$O,B$J,B$D){var B$p,B$m;if(B$O){var B$C=B$O.transform._entity;B$C&&((B$m=(B$p=B$C.owner.meshRender.material).maskTilingOffset).elements=B$D,B$p.maskTilingOffset=B$m)}else(B$m=(B$p=B$J.meshRender.material).maskTilingOffset).elements=B$D,B$p.maskTilingOffset=B$m},B$p._propertyIDCounter=0,B$p._propertyIndexDic={},B$p._propertySetFuncs=[],B$p._propertyGetFuncs=[],B$p}(),B$V=function(){function B$O(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return B$G(B$O,"laya.d3.animation.Keyframe"),B$O}(),B$T=function(){function B$O(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return B$G(B$O,"laya.d3.animation.KeyframeNode"),B$O}(),B$W=(function(){function B$O(){this._tempVector30=new B$iJ,this._tempVector31=new B$iJ,this._tempVector32=new B$iJ,this._a=new B$iJ,this._b=new B$iJ,this._c=new B$iJ,this._d=new B$iJ}B$G(B$O,"laya.d3.core.glitter.SplineCurvePositionVelocity");var B$J=B$O.prototype;B$J.Init=function(B$O,B$J,B$D,B$p){B$O.cloneTo(this._d),B$J.cloneTo(this._c),B$iJ.scale(B$O,2,this._a),B$iJ.scale(B$D,2,this._tempVector30),B$iJ.subtract(this._a,this._tempVector30,this._a),B$iJ.add(this._a,B$J,this._a),B$iJ.add(this._a,B$p,this._a),B$iJ.scale(B$D,3,this._b),B$iJ.scale(B$O,3,this._tempVector30),B$iJ.subtract(this._b,this._tempVector30,this._b),B$iJ.subtract(this._b,B$p,this._b),B$iJ.scale(B$J,2,this._tempVector30),B$iJ.subtract(this._b,this._tempVector30,this._b)},B$J.Slerp=function(B$O,B$J){B$iJ.scale(this._a,B$O*B$O*B$O,this._tempVector30),B$iJ.scale(this._b,B$O*B$O,this._tempVector31),B$iJ.scale(this._c,B$O,this._tempVector32),B$iJ.add(this._tempVector30,this._tempVector31,B$J),B$iJ.add(B$J,this._tempVector32,B$J),B$iJ.add(B$J,this._d,B$J)}}(),function(){function B$j(B$O,B$J,B$D,B$p){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=B$O,this._h=B$J,this._minHeight=B$D,this._maxHeight=B$p}B$G(B$j,"laya.d3.core.HeightMap");var B$O=B$j.prototype;B$O._inBounds=function(B$O,B$J){return 0<=B$O&&B$O<this._h&&0<=B$J&&B$J<this._w},B$O.getHeight=function(B$O,B$J){return this._inBounds(B$O,B$J)?this._datas[B$O][B$J]:NaN},B$X(0,B$O,"width",function(){return this._w}),B$X(0,B$O,"height",function(){return this._h}),B$X(0,B$O,"maxHeight",function(){return this._maxHeight}),B$X(0,B$O,"minHeight",function(){return this._minHeight}),B$j.creatFromMesh=function(B$O,B$J,B$D,B$p){for(var B$m=[],B$C=[],B$i=B$O.getSubMeshCount(),B$k=0;B$k<B$i;B$k++){for(var B$_=B$O.getSubMesh(B$k),B$L=B$_._getVertexBuffer(),B$r=B$L.getData(),B$H=[],B$Y=0;B$Y<B$r.length;B$Y+=B$L.vertexDeclaration.vertexStride/4){var B$G=new B$iJ(B$r[B$Y+0],B$r[B$Y+1],B$r[B$Y+2]);B$H.push(B$G)}B$m.push(B$H);var B$X=B$_._getIndexBuffer();B$C.push(B$X.getData())}var B$c=B$O.boundingBox,B$h=B$c.min.x,B$y=B$c.min.z,B$v=B$c.max.x,B$A=B$c.max.z,B$q=B$c.min.y,B$d=B$c.max.y,B$M=B$v-B$h,B$a=B$A-B$y,B$e=B$p.elements[0]=B$M/(B$J-1),B$t=B$p.elements[1]=B$a/(B$D-1),B$z=new B$j(B$J,B$D,B$q,B$d),B$g=B$j._tempRay,B$s=B$g.direction.elements;B$s[0]=0,B$s[1]=-1,B$s[2]=0;var B$P=B$d+.1;B$g.origin.elements[1]=B$P;for(var B$E=0;B$E<B$D;B$E++){var B$o=B$y+B$E*B$t;B$z._datas[B$E]=[];for(var B$W=0;B$W<B$J;B$W++){var B$N=B$h+B$W*B$e,B$F=B$g.origin.elements;B$F[0]=B$N,B$F[2]=B$o;var B$R=B$j._getPosition(B$g,B$m,B$C);B$z._datas[B$E][B$W]=B$R===Number.MAX_VALUE?NaN:B$P-B$R}}return B$z},B$j.createFromImage=function(B$O,B$J,B$D){for(var B$p=B$O.width,B$m=B$O.height,B$C=new B$j(B$p,B$m,B$J,B$D),B$i=(B$D-B$J)/254,B$k=B$O.getPixels(),B$_=0,B$L=0;B$L<B$m;B$L++)for(var B$r=B$C._datas[B$L]=[],B$H=0;B$H<B$p;B$H++){var B$Y=B$k[B$_++],B$G=B$k[B$_++],B$X=B$k[B$_++],B$c=B$k[B$_++];B$r[B$H]=255==B$Y&&255==B$G&&255==B$X&&255==B$c?NaN:(B$Y+B$G+B$X)/3*B$i+B$J}return B$C},B$j._getPosition=function(B$O,B$J,B$D){for(var B$p=Number.MAX_VALUE,B$m=0;B$m<B$J.length;B$m++)for(var B$C=B$J[B$m],B$i=B$D[B$m],B$k=0;B$k<B$i.length;B$k+=3){var B$_=B$C[B$i[B$k+0]],B$L=B$C[B$i[B$k+1]],B$r=B$C[B$i[B$k+2]],B$H=B$XJ.rayIntersectsTriangle(B$O,B$_,B$L,B$r);!isNaN(B$H)&&B$H<B$p&&(B$p=B$H)}return B$p},B$H(B$j,["_tempRay",function(){return this._tempRay=new B$mJ(new B$iJ,new B$iJ)}])}(),function(){function B$m(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}B$G(B$m,"laya.d3.core.Layer");var B$O=B$m.prototype;return B$O._binarySearchIndex=function(){for(var B$O=0,B$J=B$m._collsionTestList.length-1,B$D=0;B$O<=B$J;){B$D=Math.floor((B$O+B$J)/2);var B$p=B$m._collsionTestList[B$D];if(B$p==this._number)return B$D;B$p>this._number?B$J=B$D-1:B$O=B$D+1}return B$O},B$O._addCollider=function(B$O){0===this._colliders.length&&B$m._collsionTestList.splice(this._binarySearchIndex(),0,this._number),B$O._isRigidbody?(this._colliders.unshift(B$O),this._nonRigidbodyOffset++):this._colliders.push(B$O)},B$O._removeCollider=function(B$O){var B$J=this._colliders.indexOf(B$O);B$J<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(B$J,1),0===this._colliders.length&&B$m._collsionTestList.splice(B$m._collsionTestList.indexOf(this._number),1)},B$X(0,B$O,"number",function(){return this._number}),B$X(0,B$O,"visible",function(){return this._visible},function(B$O){this._visible=B$O,B$m._visibleLayers=B$O?B$m._visibleLayers|this.mask:B$m._visibleLayers&~this.mask}),B$X(0,B$O,"mask",function(){return this._mask}),B$X(1,B$m,"visibleLayers",function(){return B$m._visibleLayers},function(B$O){B$m._visibleLayers=B$O;for(var B$J=0,B$D=B$m._layerList.length;B$J<B$D;B$J++){var B$p=B$m._layerList[B$J];B$p._visible=0!=(B$p._mask&B$m._visibleLayers)}}),B$m.__init__=function(){B$m._layerList.length=31;for(var B$O=0;B$O<31;B$O++){var B$J=new B$m;B$m._layerList[B$O]=B$J,0===B$O?(B$J.name="Default Layer",B$J.visible=!0):(B$J.name="Layer-"+B$O,B$J.visible=!1),B$J._number=B$O,B$J._mask=Math.pow(2,B$O)}B$m.currentCreationLayer=B$m._layerList[0]},B$m.getLayerByNumber=function(B$O){if(B$O<0||30<B$O)throw new Error("无法返回指定Layer，该number超出范围！");return B$m._layerList[B$O]},B$m.getLayerByName=function(B$O){for(var B$J=0;B$J<31;B$J++)if(B$m._layerList[B$J].name===B$O)return B$m._layerList[B$J];throw new Error("无法返回指定Layer,该name不存在")},B$m.isVisible=function(B$O){return 0!=(B$O&B$m._currentCameraCullingMask&B$m._visibleLayers)},B$m._layerList=[],B$m._visibleLayers=2147483647,B$m._collsionTestList=[],B$m._currentCameraCullingMask=2147483647,B$m.maxCount=31,B$m.currentCreationLayer=null,B$m}()),B$N=(function(){function B$O(B$O,B$J,B$D){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=B$O,this._minCount=B$J,this._maxCount=B$D}B$G(B$O,"laya.d3.core.particleShuriKen.module.Burst");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.cloneTo=function(B$O){var B$J=B$O;B$J._time=this._time,B$J._minCount=this._minCount,B$J._maxCount=this._maxCount},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"time",function(){return this._time}),B$X(0,B$J,"minCount",function(){return this._minCount}),B$X(0,B$J,"maxCount",function(){return this._maxCount})}(),function(){function B$O(B$O){this._color=null,this.enbale=!1,this._color=B$O}B$G(B$O,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var B$J=B$O.prototype;B$J.cloneTo=function(B$O){var B$J=B$O;this._color.cloneTo(B$J._color),B$J.enbale=this.enbale},B$J.clone=function(){var B$O;switch(this._color.type){case 0:B$O=B$R.createByConstant(this._color.constant.clone());break;case 1:B$O=B$R.createByGradient(this._color.gradient.clone());break;case 2:B$O=B$R.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:B$O=B$R.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var B$J=new this.constructor(B$O);return B$J.enbale=this.enbale,B$J},B$X(0,B$J,"color",function(){return this._color})}(),function(){function B$O(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}B$G(B$O,"laya.d3.core.particleShuriKen.module.Emission");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),B$J._destroy=function(){this._bursts=null,this._destroyed=!0},B$J.getBurstsCount=function(){return this._bursts.length},B$J.getBurstByIndex=function(B$O){return this._bursts[B$O]},B$J.addBurst=function(B$O){var B$J=this._bursts.length;if(0<B$J)for(var B$D=0;B$D<B$J;B$D++)this._bursts[B$D].time>B$O.time&&this._bursts.splice(B$D,0,B$O);this._bursts.push(B$O)},B$J.removeBurst=function(B$O){var B$J=this._bursts.indexOf(B$O);-1!==B$J&&this._bursts.splice(B$J,1)},B$J.removeBurstByIndex=function(B$O){this._bursts.splice(B$O,1)},B$J.clearBurst=function(){this._bursts.length=0},B$J.cloneTo=function(B$O){var B$J=B$O,B$D=B$J._bursts;B$D.length=this._bursts.length;for(var B$p=0,B$m=this._bursts.length;B$p<B$m;B$p++){var B$C=B$D[B$p];B$C?this._bursts[B$p].cloneTo(B$C):B$D[B$p]=this._bursts[B$p].clone()}B$J._emissionRate=this._emissionRate,B$J.enbale=this.enbale},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"destroyed",function(){return this._destroyed}),B$X(0,B$J,"emissionRate",function(){return this._emissionRate},function(B$O){if(B$O<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=B$O})}(),function(){function B$p(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}B$G(B$p,"laya.d3.core.particleShuriKen.module.FrameOverTime");var B$O=B$p.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,B$J._constant=this._constant,this._overTime.cloneTo(B$J._overTime),B$J._constantMin=this._constantMin,B$J._constantMax=this._constantMax,this._overTimeMin.cloneTo(B$J._overTimeMin),this._overTimeMax.cloneTo(B$J._overTimeMax)},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"frameOverTimeData",function(){return this._overTime}),B$X(0,B$O,"constant",function(){return this._constant}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"frameOverTimeDataMin",function(){return this._overTimeMin}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"frameOverTimeDataMax",function(){return this._overTimeMax}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$p.createByConstant=function(B$O){var B$J=new B$p;return B$J._type=0,B$J._constant=B$O,B$J},B$p.createByOverTime=function(B$O){var B$J=new B$p;return B$J._type=1,B$J._overTime=B$O,B$J},B$p.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$p;return B$D._type=2,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$p.createByRandomTwoOverTime=function(B$O,B$J){var B$D=new B$p;return B$D._type=3,B$D._overTimeMin=B$O,B$D._overTimeMax=B$J,B$D},B$p}()),B$F=function(){function B$L(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}B$G(B$L,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var B$O=B$L.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,B$J._separateAxes=this._separateAxes,B$J._constant=this._constant,this._constantSeparate.cloneTo(B$J._constantSeparate),this._gradient.cloneTo(B$J._gradient),this._gradientX.cloneTo(B$J._gradientX),this._gradientY.cloneTo(B$J._gradientY),this._gradientZ.cloneTo(B$J._gradientZ),B$J._constantMin=this._constantMin,B$J._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(B$J._constantMinSeparate),this._constantMaxSeparate.cloneTo(B$J._constantMaxSeparate),this._gradientMin.cloneTo(B$J._gradientMin),this._gradientMax.cloneTo(B$J._gradientMax),this._gradientXMin.cloneTo(B$J._gradientXMin),this._gradientXMax.cloneTo(B$J._gradientXMax),this._gradientYMin.cloneTo(B$J._gradientYMin),this._gradientYMax.cloneTo(B$J._gradientYMax),this._gradientZMin.cloneTo(B$J._gradientZMin),this._gradientZMax.cloneTo(B$J._gradientZMax)},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"gradientZ",function(){return this._gradientZ}),B$X(0,B$O,"constant",function(){return this._constant}),B$X(0,B$O,"gradient",function(){return this._gradient}),B$X(0,B$O,"separateAxes",function(){return this._separateAxes}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"constantSeparate",function(){return this._constantSeparate}),B$X(0,B$O,"gradientX",function(){return this._gradientX}),B$X(0,B$O,"gradientY",function(){return this._gradientY}),B$X(0,B$O,"gradientW",function(){return this._gradientW}),B$X(0,B$O,"gradientMin",function(){return this._gradientMin}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"gradientMax",function(){return this._gradientMax}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$X(0,B$O,"gradientWMin",function(){return this._gradientWMin}),B$X(0,B$O,"constantMinSeparate",function(){return this._constantMinSeparate}),B$X(0,B$O,"constantMaxSeparate",function(){return this._constantMaxSeparate}),B$X(0,B$O,"gradientXMin",function(){return this._gradientXMin}),B$X(0,B$O,"gradientXMax",function(){return this._gradientXMax}),B$X(0,B$O,"gradientWMax",function(){return this._gradientWMax}),B$X(0,B$O,"gradientYMin",function(){return this._gradientYMin}),B$X(0,B$O,"gradientYMax",function(){return this._gradientYMax}),B$X(0,B$O,"gradientZMin",function(){return this._gradientZMin}),B$X(0,B$O,"gradientZMax",function(){return this._gradientZMax}),B$L.createByConstant=function(B$O){var B$J=new B$L;return B$J._type=0,B$J._separateAxes=!1,B$J._constant=B$O,B$J},B$L.createByConstantSeparate=function(B$O){var B$J=new B$L;return B$J._type=0,B$J._separateAxes=!0,B$J._constantSeparate=B$O,B$J},B$L.createByGradient=function(B$O){var B$J=new B$L;return B$J._type=1,B$J._separateAxes=!1,B$J._gradient=B$O,B$J},B$L.createByGradientSeparate=function(B$O,B$J,B$D,B$p){var B$m=new B$L;return B$m._type=1,B$m._separateAxes=!0,B$m._gradientX=B$O,B$m._gradientY=B$J,B$m._gradientZ=B$D,B$m._gradientW=B$p,B$m},B$L.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$L;return B$D._type=2,B$D._separateAxes=!1,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$L.createByRandomTwoConstantSeparate=function(B$O,B$J){var B$D=new B$L;return B$D._type=2,B$D._separateAxes=!0,B$D._constantMinSeparate=B$O,B$D._constantMaxSeparate=B$J,B$D},B$L.createByRandomTwoGradient=function(B$O,B$J){var B$D=new B$L;return B$D._type=3,B$D._separateAxes=!1,B$D._gradientMin=B$O,B$D._gradientMax=B$J,B$D},B$L.createByRandomTwoGradientSeparate=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){var B$_=new B$L;return B$_._type=3,B$_._separateAxes=!0,B$_._gradientXMin=B$O,B$_._gradientXMax=B$J,B$_._gradientYMin=B$D,B$_._gradientYMax=B$p,B$_._gradientZMin=B$m,B$_._gradientZMax=B$C,B$_._gradientWMin=B$i,B$_._gradientWMax=B$k,B$_},B$L}(),B$R=function(){function B$p(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}B$G(B$p,"laya.d3.core.particleShuriKen.module.GradientColor");var B$O=B$p.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,this._constant.cloneTo(B$J._constant),this._constantMin.cloneTo(B$J._constantMin),this._constantMax.cloneTo(B$J._constantMax),this._gradient.cloneTo(B$J._gradient),this._gradientMin.cloneTo(B$J._gradientMin),this._gradientMax.cloneTo(B$J._gradientMax)},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"gradient",function(){return this._gradient}),B$X(0,B$O,"constant",function(){return this._constant}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"gradientMin",function(){return this._gradientMin}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"gradientMax",function(){return this._gradientMax}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$p.createByConstant=function(B$O){var B$J=new B$p;return B$J._type=0,B$J._constant=B$O,B$J},B$p.createByGradient=function(B$O){var B$J=new B$p;return B$J._type=1,B$J._gradient=B$O,B$J},B$p.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$p;return B$D._type=2,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$p.createByRandomTwoGradient=function(B$O,B$J){var B$D=new B$p;return B$D._type=3,B$D._gradientMin=B$O,B$D._gradientMax=B$J,B$D},B$p}(),B$j=(function(){function B$O(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}B$G(B$O,"laya.d3.core.particleShuriKen.module.GradientDataColor");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.addAlpha=function(B$O,B$J){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==B$O&&(B$O=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=B$O,this._alphaElements[this._alphaCurrentLength++]=B$J):DEBUG},B$J.addRGB=function(B$O,B$J){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==B$O&&(B$O=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=B$O,this._rgbElements[this._rgbCurrentLength++]=B$J.x,this._rgbElements[this._rgbCurrentLength++]=B$J.y,this._rgbElements[this._rgbCurrentLength++]=B$J.z):DEBUG},B$J.cloneTo=function(B$O){var B$J=B$O,B$D=0,B$p=0;B$J._alphaCurrentLength=this._alphaCurrentLength;var B$m=B$J._alphaElements;for(B$m.length=this._alphaElements.length,B$D=0,B$p=this._alphaElements.length;B$D<B$p;B$D++)B$m[B$D]=this._alphaElements[B$D];B$J._rgbCurrentLength=this._rgbCurrentLength;var B$C=B$J._rgbElements;for(B$C.length=this._rgbElements.length,B$D=0,B$p=this._rgbElements.length;B$D<B$p;B$D++)B$C[B$D]=this._rgbElements[B$D]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),B$X(0,B$J,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function B$O(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}B$G(B$O,"laya.d3.core.particleShuriKen.module.GradientDataInt");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.add=function(B$O,B$J){this._currentLength<8?(6===this._currentLength&&1!==B$O&&(B$O=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=B$O,this._elements[this._currentLength++]=B$J):console.log("Warning:data count must lessEqual than 4")},B$J.cloneTo=function(B$O){var B$J=B$O;B$J._currentLength=this._currentLength;var B$D=B$J._elements;B$D.length=this._elements.length;for(var B$p=0,B$m=this._elements.length;B$p<B$m;B$p++)B$D[B$p]=this._elements[B$p]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"gradientCount",function(){return this._currentLength/2})}(),function(){function B$O(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}B$G(B$O,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.add=function(B$O,B$J){this._currentLength<8?(6===this._currentLength&&1!==B$O&&(B$O=1,DEBUG),this._elements[this._currentLength++]=B$O,this._elements[this._currentLength++]=B$J):DEBUG},B$J.getKeyByIndex=function(B$O){return this._elements[2*B$O]},B$J.getValueByIndex=function(B$O){return this._elements[2*B$O+1]},B$J.getAverageValue=function(){for(var B$O=0,B$J=this._currentLength-2;B$O<B$J;B$O+=2){this._elements[B$O+1];this._elements[B$O+3],this._elements[B$O+2]-this._elements[B$O]}return 0},B$J.cloneTo=function(B$O){var B$J=B$O;B$J._currentLength=this._currentLength;var B$D=B$J._elements;B$D.length=this._elements.length;for(var B$p=0,B$m=this._elements.length;B$p<B$m;B$p++)B$D[B$p]=this._elements[B$p]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"gradientCount",function(){return this._currentLength/2})}(),function(){function B$O(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}B$G(B$O,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.add=function(B$O,B$J){this._currentLength<8?(6===this._currentLength&&1!==B$O&&(B$O=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=B$O,this._elements[this._currentLength++]=B$J.x,this._elements[this._currentLength++]=B$J.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},B$J.cloneTo=function(B$O){var B$J=B$O;B$J._currentLength=this._currentLength;var B$D=B$J._elements;B$D.length=this._elements.length;for(var B$p=0,B$m=this._elements.length;B$p<B$m;B$p++)B$D[B$p]=this._elements[B$p]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"gradientCount",function(){return this._currentLength/3})}(),function(){function B$k(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}B$G(B$k,"laya.d3.core.particleShuriKen.module.GradientSize");var B$O=B$k.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.getMaxSizeInGradient=function(){var B$O=0,B$J=0,B$D=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(B$O=0,B$J=this._gradientX.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientX.getValueByIndex(B$O));for(B$O=0,B$J=this._gradientY.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientY.getValueByIndex(B$O))}else for(B$O=0,B$J=this._gradient.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradient.getValueByIndex(B$O));break;case 1:B$D=this._separateAxes?(B$D=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),B$D=Math.max(B$D,this._constantMinSeparate.y),Math.max(B$D,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(B$O=0,B$J=this._gradientXMin.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientXMin.getValueByIndex(B$O));for(B$O=0,B$J=this._gradientXMax.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientXMax.getValueByIndex(B$O));for(B$O=0,B$J=this._gradientYMin.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientYMin.getValueByIndex(B$O));for(B$O=0,B$J=this._gradientZMax.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientZMax.getValueByIndex(B$O))}else{for(B$O=0,B$J=this._gradientMin.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientMin.getValueByIndex(B$O));for(B$O=0,B$J=this._gradientMax.gradientCount;B$O<B$J;B$O++)B$D=Math.max(B$D,this._gradientMax.getValueByIndex(B$O))}}return B$D},B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,B$J._separateAxes=this._separateAxes,this._gradient.cloneTo(B$J._gradient),this._gradientX.cloneTo(B$J._gradientX),this._gradientY.cloneTo(B$J._gradientY),this._gradientZ.cloneTo(B$J._gradientZ),B$J._constantMin=this._constantMin,B$J._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(B$J._constantMinSeparate),this._constantMaxSeparate.cloneTo(B$J._constantMaxSeparate),this._gradientMin.cloneTo(B$J._gradientMin),this._gradientMax.cloneTo(B$J._gradientMax),this._gradientXMin.cloneTo(B$J._gradientXMin),this._gradientXMax.cloneTo(B$J._gradientXMax),this._gradientYMin.cloneTo(B$J._gradientYMin),this._gradientYMax.cloneTo(B$J._gradientYMax),this._gradientZMin.cloneTo(B$J._gradientZMin),this._gradientZMax.cloneTo(B$J._gradientZMax)},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"gradientZ",function(){return this._gradientZ}),B$X(0,B$O,"gradient",function(){return this._gradient}),B$X(0,B$O,"separateAxes",function(){return this._separateAxes}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"gradientMin",function(){return this._gradientMin}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"gradientX",function(){return this._gradientX}),B$X(0,B$O,"gradientY",function(){return this._gradientY}),B$X(0,B$O,"gradientMax",function(){return this._gradientMax}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$X(0,B$O,"constantMinSeparate",function(){return this._constantMinSeparate}),B$X(0,B$O,"constantMaxSeparate",function(){return this._constantMaxSeparate}),B$X(0,B$O,"gradientXMin",function(){return this._gradientXMin}),B$X(0,B$O,"gradientXMax",function(){return this._gradientXMax}),B$X(0,B$O,"gradientYMin",function(){return this._gradientYMin}),B$X(0,B$O,"gradientYMax",function(){return this._gradientYMax}),B$X(0,B$O,"gradientZMin",function(){return this._gradientZMin}),B$X(0,B$O,"gradientZMax",function(){return this._gradientZMax}),B$k.createByGradient=function(B$O){var B$J=new B$k;return B$J._type=0,B$J._separateAxes=!1,B$J._gradient=B$O,B$J},B$k.createByGradientSeparate=function(B$O,B$J,B$D){var B$p=new B$k;return B$p._type=0,B$p._separateAxes=!0,B$p._gradientX=B$O,B$p._gradientY=B$J,B$p._gradientZ=B$D,B$p},B$k.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$k;return B$D._type=1,B$D._separateAxes=!1,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$k.createByRandomTwoConstantSeparate=function(B$O,B$J){var B$D=new B$k;return B$D._type=1,B$D._separateAxes=!0,B$D._constantMinSeparate=B$O,B$D._constantMaxSeparate=B$J,B$D},B$k.createByRandomTwoGradient=function(B$O,B$J){var B$D=new B$k;return B$D._type=2,B$D._separateAxes=!1,B$D._gradientMin=B$O,B$D._gradientMax=B$J,B$D},B$k.createByRandomTwoGradientSeparate=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=new B$k;return B$i._type=2,B$i._separateAxes=!0,B$i._gradientXMin=B$O,B$i._gradientXMax=B$J,B$i._gradientYMin=B$D,B$i._gradientYMax=B$p,B$i._gradientZMin=B$m,B$i._gradientZMax=B$C,B$i},B$k}()),B$u=function(){function B$k(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}B$G(B$k,"laya.d3.core.particleShuriKen.module.GradientVelocity");var B$O=B$k.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,this._constant.cloneTo(B$J._constant),this._gradientX.cloneTo(B$J._gradientX),this._gradientY.cloneTo(B$J._gradientY),this._gradientZ.cloneTo(B$J._gradientZ),this._constantMin.cloneTo(B$J._constantMin),this._constantMax.cloneTo(B$J._constantMax),this._gradientXMin.cloneTo(B$J._gradientXMin),this._gradientXMax.cloneTo(B$J._gradientXMax),this._gradientYMin.cloneTo(B$J._gradientYMin),this._gradientYMax.cloneTo(B$J._gradientYMax),this._gradientZMin.cloneTo(B$J._gradientZMin),this._gradientZMax.cloneTo(B$J._gradientZMax)},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"gradientZ",function(){return this._gradientZ}),B$X(0,B$O,"constant",function(){return this._constant}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"gradientXMax",function(){return this._gradientXMax}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"gradientX",function(){return this._gradientX}),B$X(0,B$O,"gradientY",function(){return this._gradientY}),B$X(0,B$O,"gradientXMin",function(){return this._gradientXMin}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$X(0,B$O,"gradientYMin",function(){return this._gradientYMin}),B$X(0,B$O,"gradientYMax",function(){return this._gradientYMax}),B$X(0,B$O,"gradientZMin",function(){return this._gradientZMin}),B$X(0,B$O,"gradientZMax",function(){return this._gradientZMax}),B$k.createByConstant=function(B$O){var B$J=new B$k;return B$J._type=0,B$J._constant=B$O,B$J},B$k.createByGradient=function(B$O,B$J,B$D){var B$p=new B$k;return B$p._type=1,B$p._gradientX=B$O,B$p._gradientY=B$J,B$p._gradientZ=B$D,B$p},B$k.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$k;return B$D._type=2,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$k.createByRandomTwoGradient=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=new B$k;return B$i._type=3,B$i._gradientXMin=B$O,B$i._gradientXMax=B$J,B$i._gradientYMin=B$D,B$i._gradientYMax=B$p,B$i._gradientZMin=B$m,B$i._gradientZMax=B$C,B$i},B$k}(),B$l=(function(){function B$O(B$O){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=B$O}B$G(B$O,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.cloneTo=function(B$O){var B$J=B$O;this._angularVelocity.cloneTo(B$J._angularVelocity),B$J.enbale=this.enbale},B$J.clone=function(){var B$O;switch(this._angularVelocity.type){case 0:B$O=this._angularVelocity.separateAxes?B$F.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):B$F.createByConstant(this._angularVelocity.constant);break;case 1:B$O=this._angularVelocity.separateAxes?B$F.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):B$F.createByGradient(this._angularVelocity.gradient.clone());break;case 2:B$O=this._angularVelocity.separateAxes?B$F.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):B$F.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:B$O=this._angularVelocity.separateAxes?B$F.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):B$F.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var B$J=new this.constructor(B$O);return B$J.enbale=this.enbale,B$J},B$X(0,B$J,"angularVelocity",function(){return this._angularVelocity})}(),function(){function B$O(){this.enable=!1,this.randomDirection=!1}B$G(B$O,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J._getShapeBoundBox=function(B$O){throw new Error("BaseShape: must override it.")},B$J._getSpeedBoundBox=function(B$O){throw new Error("BaseShape: must override it.")},B$J.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){throw new Error("BaseShape: must override it.")},B$J._calculateProceduralBounds=function(B$O,B$J,B$D){this._getShapeBoundBox(B$O);var B$p=B$O.min,B$m=B$O.max;B$iJ.multiply(B$p,B$J,B$p),B$iJ.multiply(B$m,B$J,B$m);var B$C=new B$SO(new B$iJ,new B$iJ);this.randomDirection?(B$C.min=new B$iJ(-1,-1,-1),B$C.max=new B$iJ(1,1,1)):this._getSpeedBoundBox(B$C);var B$i=new B$SO(new B$iJ,new B$iJ),B$k=B$i.min,B$_=B$i.max;B$iJ.scale(B$C.min,B$D.y,B$k),B$iJ.scale(B$C.max,B$D.y,B$_),B$iJ.add(B$O.min,B$k,B$k),B$iJ.add(B$O.max,B$_,B$_),B$iJ.min(B$O.min,B$k,B$O.min),B$iJ.max(B$O.max,B$k,B$O.max);var B$L=new B$SO(new B$iJ,new B$iJ),B$r=B$L.min,B$H=B$L.max;B$iJ.scale(B$C.min,B$D.x,B$r),B$iJ.scale(B$C.max,B$D.x,B$H),B$iJ.min(B$L.min,B$H,B$k),B$iJ.max(B$L.min,B$H,B$_),B$iJ.min(B$O.min,B$k,B$O.min),B$iJ.max(B$O.max,B$k,B$O.max)},B$J.cloneTo=function(B$O){B$O.enable=this.enable},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$O}()),B$I=function(){function B$C(){}return B$G(B$C,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),B$C._randomPointUnitArcCircle=function(B$O,B$J,B$D){var B$p=B$J.elements,B$m=NaN;B$m=B$D?B$D.getFloat()*B$O:Math.random()*B$O,B$p[0]=Math.cos(B$m),B$p[1]=Math.sin(B$m)},B$C._randomPointInsideUnitArcCircle=function(B$O,B$J,B$D){var B$p=B$J.elements;B$C._randomPointUnitArcCircle(B$O,B$J,B$D);var B$m=NaN;B$m=B$D?Math.pow(B$D.getFloat(),.5):Math.pow(Math.random(),.5),B$p[0]=B$p[0]*B$m,B$p[1]=B$p[1]*B$m},B$C._randomPointUnitCircle=function(B$O,B$J){var B$D=B$O.elements,B$p=NaN;B$p=B$J?B$J.getFloat()*Math.PI*2:Math.random()*Math.PI*2,B$D[0]=Math.cos(B$p),B$D[1]=Math.sin(B$p)},B$C._randomPointInsideUnitCircle=function(B$O,B$J){var B$D=B$O.elements;B$C._randomPointUnitCircle(B$O);var B$p=NaN;B$p=B$J?Math.pow(B$J.getFloat(),.5):Math.pow(Math.random(),.5),B$D[0]=B$D[0]*B$p,B$D[1]=B$D[1]*B$p},B$C._randomPointUnitSphere=function(B$O,B$J){var B$D=B$O.elements,B$p=NaN,B$m=NaN;B$m=B$J?(B$p=B$D[2]=2*B$J.getFloat()-1,B$J.getFloat()*Math.PI*2):(B$p=B$D[2]=2*Math.random()-1,Math.random()*Math.PI*2);var B$C=Math.sqrt(1-B$p*B$p);B$D[0]=B$C*Math.cos(B$m),B$D[1]=B$C*Math.sin(B$m)},B$C._randomPointInsideUnitSphere=function(B$O,B$J){var B$D=B$O.elements;B$C._randomPointUnitSphere(B$O);var B$p=NaN;B$p=B$J?Math.pow(B$J.getFloat(),1/3):Math.pow(Math.random(),1/3),B$D[0]=B$D[0]*B$p,B$D[1]=B$D[1]*B$p,B$D[2]=B$D[2]*B$p},B$C._randomPointInsideHalfUnitBox=function(B$O,B$J){var B$D=B$O.elements;B$J?(B$D[0]=B$J.getFloat()-.5,B$D[1]=B$J.getFloat()-.5,B$D[2]=B$J.getFloat()-.5):(B$D[0]=Math.random()-.5,B$D[1]=Math.random()-.5,B$D[2]=Math.random()-.5)},B$C}(),B$w=(function(){function B$O(B$O){this._size=null,this.enbale=!1,this._size=B$O}B$G(B$O,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.cloneTo=function(B$O){var B$J=B$O;this._size.cloneTo(B$J._size),B$J.enbale=this.enbale},B$J.clone=function(){var B$O;switch(this._size.type){case 0:B$O=this._size.separateAxes?B$j.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):B$j.createByGradient(this._size.gradient.clone());break;case 1:B$O=this._size.separateAxes?B$j.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):B$j.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:B$O=this._size.separateAxes?B$j.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):B$j.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var B$J=new this.constructor(B$O);return B$J.enbale=this.enbale,B$J},B$X(0,B$J,"size",function(){return this._size})}(),function(){function B$p(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}B$G(B$p,"laya.d3.core.particleShuriKen.module.StartFrame");var B$O=B$p.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.cloneTo=function(B$O){var B$J=B$O;B$J._type=this._type,B$J._constant=this._constant,B$J._constantMin=this._constantMin,B$J._constantMax=this._constantMax},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$O,"constant",function(){return this._constant}),B$X(0,B$O,"type",function(){return this._type}),B$X(0,B$O,"constantMin",function(){return this._constantMin}),B$X(0,B$O,"constantMax",function(){return this._constantMax}),B$p.createByConstant=function(B$O){var B$J=new B$p;return B$J._type=0,B$J._constant=B$O,B$J},B$p.createByRandomTwoConstant=function(B$O,B$J){var B$D=new B$p;return B$D._type=1,B$D._constantMin=B$O,B$D._constantMax=B$J,B$D},B$p}()),B$U=(function(){function B$O(B$O,B$J){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new B$CJ(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=B$O,this._startFrame=B$J}B$G(B$O,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.cloneTo=function(B$O){var B$J=B$O;this.tiles.cloneTo(B$J.tiles),B$J.type=this.type,B$J.randomRow=this.randomRow,this._frame.cloneTo(B$J._frame),this._startFrame.cloneTo(B$J._startFrame),B$J.cycles=this.cycles,B$J.enableUVChannels=this.enableUVChannels,B$J.enable=this.enable},B$J.clone=function(){var B$O,B$J;switch(this._frame.type){case 0:B$O=B$N.createByConstant(this._frame.constant);break;case 1:B$O=B$N.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:B$O=B$N.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:B$O=B$N.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:B$J=B$w.createByConstant(this._startFrame.constant);break;case 1:B$J=B$w.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var B$D=new this.constructor(B$O,B$J);return this.tiles.cloneTo(B$D.tiles),B$D.type=this.type,B$D.randomRow=this.randomRow,B$D.cycles=this.cycles,B$D.enableUVChannels=this.enableUVChannels,B$D.enable=this.enable,B$D},B$X(0,B$J,"frame",function(){return this._frame}),B$X(0,B$J,"startFrame",function(){return this._startFrame})}(),function(){function B$O(B$O){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=B$O}B$G(B$O,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.cloneTo=function(B$O){var B$J=B$O;this._velocity.cloneTo(B$J._velocity),B$J.enbale=this.enbale,B$J.space=this.space},B$J.clone=function(){var B$O;switch(this._velocity.type){case 0:B$O=B$u.createByConstant(this._velocity.constant.clone());break;case 1:B$O=B$u.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:B$O=B$u.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:B$O=B$u.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var B$J=new this.constructor(B$O);return B$J.enbale=this.enbale,B$J.space=this.space,B$J},B$X(0,B$J,"velocity",function(){return this._velocity})}(),function(){function B$O(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new B$YJ,this._vb=B$lJ.create(B$O._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=B$uJ.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=B$RJ.nameKey.getID("LINE"),this._shaderCompile=B$eJ._preCompileShader[this._sharderNameID]}B$G(B$O,"laya.d3.core.PhasorSpriter3D");var B$J=B$O.prototype;return B$J.line=function(B$O,B$J,B$D,B$p){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(B$O.x,B$O.y,B$O.z,B$J.x,B$J.y,B$J.z,B$J.w),this.addVertex(B$D.x,B$D.y,B$D.z,B$p.x,B$p.y,B$p.z,B$p.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},B$J.circle=function(B$O,B$J,B$D,B$p,B$m,B$C){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*B$J,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/B$J,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*B$O,Math.cos(this._tempNumver0)*B$O,0,B$D,B$p,B$m,B$C),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},B$J.plane=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=B$p/2,this._tempNumver1=B$m/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(B$O-this._tempNumver0,B$J+this._tempNumver1,B$D,B$C,B$i,B$k,B$_),this.addVertex(B$O+this._tempNumver0,B$J+this._tempNumver1,B$D,B$C,B$i,B$k,B$_),this.addVertex(B$O-this._tempNumver0,B$J-this._tempNumver1,B$D,B$C,B$i,B$k,B$_),this.addVertex(B$O+this._tempNumver0,B$J-this._tempNumver1,B$D,B$C,B$i,B$k,B$_),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},B$J.box=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=B$p/2,this._tempNumver1=B$m/2,this._tempNumver2=B$C/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(B$O-this._tempNumver0,B$J+this._tempNumver1,B$D+this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O+this._tempNumver0,B$J+this._tempNumver1,B$D+this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O-this._tempNumver0,B$J-this._tempNumver1,B$D+this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O+this._tempNumver0,B$J-this._tempNumver1,B$D+this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O+this._tempNumver0,B$J+this._tempNumver1,B$D-this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O-this._tempNumver0,B$J+this._tempNumver1,B$D-this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O+this._tempNumver0,B$J-this._tempNumver1,B$D-this._tempNumver2,B$i,B$k,B$_,B$L),this.addVertex(B$O-this._tempNumver0,B$J-this._tempNumver1,B$D-this._tempNumver2,B$i,B$k,B$_,B$L),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},B$J.cone=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*B$D+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*B$D>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/B$D,this.addVertexIndex(0,B$J,0,B$p,B$m,B$C,B$i,this._tempUint0),this.addVertexIndex(0,0,0,B$p,B$m,B$C,B$i,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<B$D;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(B$O*this._tempNumver2,0,B$O*this._tempNumver3,B$p,B$m,B$C,B$i,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==B$D-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(B$O*this._tempNumver2,0,B$O*this._tempNumver3,B$p,B$m,B$C,B$i,this._tempUint0+(this._tempInt0+B$D)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==B$D-1?this.addIndexes(this._tempUint1+B$D+2):this.addIndexes(this._tempUint1+this._tempInt0+B$D+1),this.addIndexes(this._tempUint1+this._tempInt0+B$D),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},B$J.boundingBoxLine=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(B$O,B$m,B$C,B$i,B$k,B$_,B$L),this.addVertex(B$p,B$m,B$C,B$i,B$k,B$_,B$L),this.addVertex(B$O,B$J,B$C,B$i,B$k,B$_,B$L),this.addVertex(B$p,B$J,B$C,B$i,B$k,B$_,B$L),this.addVertex(B$p,B$m,B$D,B$i,B$k,B$_,B$L),this.addVertex(B$O,B$m,B$D,B$i,B$k,B$_,B$L),this.addVertex(B$p,B$J,B$D,B$i,B$k,B$_,B$L),this.addVertex(B$O,B$J,B$D,B$i,B$k,B$_,B$L),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},B$J.addVertex=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=B$O,this._vbData[this._posInVBData+1]=B$J,this._vbData[this._posInVBData+2]=B$D,this._vbData[this._posInVBData+3]=B$p,this._vbData[this._posInVBData+4]=B$m,this._vbData[this._posInVBData+5]=B$C,this._vbData[this._posInVBData+6]=B$i,this._posInVBData+=this._floatSizePerVer,this},B$J.addVertexIndex=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){return this._hasBegun||this.addVertexIndexException(),this._vbData[B$k]=B$O,this._vbData[B$k+1]=B$J,this._vbData[B$k+2]=B$D,this._vbData[B$k+3]=B$p,this._vbData[B$k+4]=B$m,this._vbData[B$k+5]=B$C,this._vbData[B$k+6]=B$i,(B$k+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=B$k),this},B$J.addIndexes=function(B$O){var B$J=arguments;this._hasBegun||this.addVertexIndexException();for(var B$D=0;B$D<B$J.length;B$D++)this._ibData[this._posInIBData]=B$J[B$D],this._posInIBData++;return this},B$J.begin=function(B$O,B$J){return this._hasBegun&&this.beginException0(),1!==B$O&&4!==B$O&&this.beginException1(),this._primitiveType=B$O,this._camera=B$J,this._hasBegun=!0,this},B$J.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},B$J.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(B$O._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),B$e.drawCall++,B$P.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},B$J.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},B$J.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},B$J.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},B$J.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},B$J.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},B$J.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(28,[new B$iO(0,"vector3",0),new B$iO(12,"vector4",1)])}]),B$O}()),B$Z=function(){function B$O(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++B$O._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new B$YJ}B$G(B$O,"laya.d3.core.render.RenderElement");var B$J=B$O.prototype;return B$J.getDynamicBatchBakedVertexs=function(B$O){for(var B$J=this._renderObj._getVertexBuffer(B$O),B$D=B$J.getData().slice(),B$p=B$J.vertexDeclaration,B$m=B$p.getVertexElementByUsage(0).offset/4,B$C=B$p.getVertexElementByUsage(3).offset/4,B$i=this._sprite3D.transform,B$k=B$i.worldMatrix,B$_=B$i.rotation,B$L=B$p.vertexStride/4,B$r=0,B$H=B$D.length;B$r<B$H;B$r+=B$L){var B$Y=B$r+B$m,B$G=B$r+B$C;B$hJ.transformVector3ArrayToVector3ArrayCoordinate(B$D,B$Y,B$k,B$D,B$Y),B$hJ.transformVector3ArrayByQuat(B$D,B$G,B$_,B$D,B$G)}return B$D},B$J.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},B$J._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},B$X(0,B$J,"id",function(){return this._id}),B$X(0,B$J,"renderObj",function(){return this._renderObj},function(B$O){this._renderObj!==B$O&&(this._renderObj=B$O)}),B$O._uniqueIDCounter=0,B$O}(),B$n=function(){function B$J(B$O){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++B$J._uniqueIDCounter,this._needSort=!1,this._scene=B$O,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}B$G(B$J,"laya.d3.core.render.RenderQueue");var B$O=B$J.prototype;return B$O._sortOpaqueFunc=function(B$O,B$J){if(B$O._render&&B$J._render){var B$D=B$O._material.renderQueue-B$J._material.renderQueue;return 0==B$D?B$O._render._distanceForSort-B$J._render._distanceForSort:B$D}return 0},B$O._sortAlphaFunc=function(B$O,B$J){if(B$O._render&&B$J._render){var B$D=B$O._material.renderQueue-B$J._material.renderQueue;return 0==B$D?B$J._render._distanceForSort-B$O._render._distanceForSort:B$D}return 0},B$O._begainRenderElement=function(B$O,B$J,B$D){return!!B$J._beforeRender(B$O)},B$O._sortAlpha=function(B$O){B$J._cameraPosition=B$O,this._finalElements.sort(this._sortAlphaFunc)},B$O._sortOpaque=function(B$O){B$J._cameraPosition=B$O,this._finalElements.sort(this._sortOpaqueFunc)},B$O._preRender=function(B$O){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},B$O._render=function(B$O,B$J){for(var B$D,B$p,B$m,B$C,B$i,B$k,B$_=B$e.loopCount,B$L=this._scene,B$r=B$O.camera,B$H=(B$r.id,!1),B$Y=0,B$G=this._finalElements.length;B$Y<B$G;B$Y++){var B$X,B$c,B$h,B$y=this._finalElements[B$Y];if(null!=B$y._onPreRenderFunction&&B$y._onPreRenderFunction.call(B$y._sprite3D,B$O),0===B$y._type){if(B$O.owner=B$h=B$y._sprite3D,B$O.renderElement=B$y,B$h._preRenderUpdateComponents(B$O),B$X=B$y.renderObj,B$c=B$y._material,this._begainRenderElement(B$O,B$X,B$c)){if(B$D=B$X._getVertexBuffers(),!(B$m=(B$p=B$X._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[B$p.id]){this._errorRecord[B$p.id]=1;var B$v="vertexBuffer:"+("("+B$p._destroyed+","+B$p._released+","+B$p._referenceCount+","+B$p._buffer+")")+", material:"+(B$c?B$c.__className+"("+B$c._destroyed+","+B$c._released+")":"null")+", owner:"+(B$h?B$h.__className+"("+B$h._destroyed+","+B$h._activeInHierarchy+","+B$h._displayedInStage+")":"null")+", renderObj:"+(B$X?B$X.__className+"("+B$X._destroyed+","+B$X._released+","+B$X._referenceCount+")":"")+", parent:, url:"+(B$h?B$h.url:"")+", disposeStack:"+B$p.disposeStack;B$d.recordError("报错：unknown vertexDeclaration  "+B$v)}continue}if(B$H=(B$C=B$O._shader=B$c._getShader(B$L._shaderDefineValue,B$m.shaderDefineValue,B$h._shaderDefineValue)).bind()||B$_!==B$C._uploadLoopCount,B$D){if(B$C._uploadVertexBuffer!==B$D||B$H){for(var B$A=0;B$A<B$D.length;B$A++){var B$q=B$D[B$A];B$C.uploadAttributesX(B$q.vertexDeclaration.shaderValues.data,B$q)}B$C._uploadVertexBuffer=B$D}}else(B$C._uploadVertexBuffer!==B$p||B$H)&&(B$C.uploadAttributes(B$m.shaderValues.data,null),B$C._uploadVertexBuffer=B$p);(B$C._uploadScene!==B$L||B$H)&&(B$C.uploadSceneUniforms(B$L._shaderValues.data),B$C._uploadScene=B$L),(B$r!==B$C._uploadCamera||B$C._uploadSprite3D!==B$h||B$H)&&(B$C.uploadSpriteUniforms(B$h._shaderValues.data),B$C._uploadSprite3D=B$h),(B$r!==B$C._uploadCamera||B$H)&&(B$C.uploadCameraUniforms(B$r._shaderValues.data),B$C._uploadCamera=B$r),(B$C._uploadMaterial!==B$c||B$H)&&(B$c._upload(),B$C._uploadMaterial=B$c),B$i!==B$c?(B$c._setRenderStateBlendDepth(),B$c._setRenderStateFrontFace(B$J,B$h.transform),B$i=B$c,B$k=B$h):B$k!==B$h&&(B$c._setRenderStateFrontFace(B$J,B$h.transform),B$k=B$h),B$X._render(B$O),B$C._uploadLoopCount=B$_}B$h._postRenderUpdateComponents(B$O)}else if(2===B$y._type){B$y.renderObj;B$O.owner=B$h=B$y._sprite3D,B$O.renderElement=B$y,B$O._batchIndexStart=B$y._tempBatchIndexStart,B$O._batchIndexEnd=B$y._tempBatchIndexEnd,B$X=B$y.renderObj,B$c=B$y._material,this._begainRenderElement(B$O,B$X,B$c)&&(B$m=(B$p=B$X._getVertexBuffer(0)).vertexDeclaration,B$H=(B$C=B$O._shader=B$c._getShader(B$L._shaderDefineValue,B$m.shaderDefineValue,B$h._shaderDefineValue)).bind()||B$_!==B$C._uploadLoopCount,(B$C._uploadVertexBuffer!==B$p||B$H)&&(B$C.uploadAttributes(B$m.shaderValues.data,null),B$C._uploadVertexBuffer=B$p),(B$C._uploadScene!==B$L||B$H)&&(B$C.uploadSceneUniforms(B$L._shaderValues.data),B$C._uploadScene=B$L),(B$r!==B$C._uploadCamera||B$C._uploadSprite3D!==B$h||B$H)&&(B$C.uploadSpriteUniforms(B$h._shaderValues.data),B$C._uploadSprite3D=B$h),(B$r!==B$C._uploadCamera||B$H)&&(B$C.uploadCameraUniforms(B$r._shaderValues.data),B$C._uploadCamera=B$r),(B$C._uploadMaterial!==B$c||B$H)&&(B$c._upload(),B$C._uploadMaterial=B$c),B$i!==B$c?(B$c._setRenderStateBlendDepth(),B$c._setRenderStateFrontFace(B$J,B$h.transform),B$i=B$c,B$k=B$h):B$k!==B$h&&(B$c._setRenderStateFrontFace(B$J,B$h.transform),B$k=B$h),B$X._render(B$O),B$C._uploadLoopCount=B$_)}}},B$O._renderShadow=function(B$O,B$J){for(var B$D,B$p,B$m,B$C,B$i,B$k=B$e.loopCount,B$_=this._scene,B$L=B$O.camera,B$r=!1,B$H=0,B$Y=this._finalElements.length;B$H<B$Y;B$H++){var B$G,B$X,B$c,B$h=this._finalElements[B$H];0===B$h._type&&(B$O.owner=B$c=B$h._sprite3D,B$J||B$c._projectionViewWorldUpdateCamera===B$L&&B$c._projectionViewWorldUpdateLoopCount===B$e.loopCount||(B$c._render._renderUpdate(B$O._projectionViewMatrix),B$c._projectionViewWorldUpdateLoopCount=B$e.loopCount,B$c._projectionViewWorldUpdateCamera=B$L),B$O.renderElement=B$h,B$c._preRenderUpdateComponents(B$O),B$G=B$h.renderObj,B$X=B$h._material,this._begainRenderElement(B$O,B$G,null)&&(B$p=(B$D=B$G._getVertexBuffer(0)).vertexDeclaration,B$r=(B$m=B$O._shader=B$X._getShader(B$_._shaderDefineValue,B$p.shaderDefineValue,B$c._shaderDefineValue)).bind()||B$k!==B$m._uploadLoopCount,(B$m._uploadVertexBuffer!==B$D||B$r)&&(B$m.uploadAttributes(B$p.shaderValues.data,null),B$m._uploadVertexBuffer=B$D),(B$L!==B$m._uploadCamera||B$m._uploadSprite3D!==B$c||B$r)&&(B$m.uploadSpriteUniforms(B$c._shaderValues.data),B$m._uploadSprite3D=B$c),(B$L!==B$m._uploadCamera||B$r)&&(B$m.uploadCameraUniforms(B$L._shaderValues.data),B$m._uploadCamera=B$L),(B$m._uploadMaterial!==B$X||B$r)&&(B$X._upload(),B$m._uploadMaterial=B$X),B$m._uploadRenderElement,B$C!==B$X?(B$X._setRenderStateFrontFace(!1,B$c.transform),B$C=B$X,B$i=B$c):B$i!==B$c&&(B$X._setRenderStateFrontFace(!1,B$c.transform),B$i=B$c),B$G._render(B$O),B$m._uploadLoopCount=B$k),B$c._postRenderUpdateComponents(B$O))}},B$O._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},B$O._addRenderElement=function(B$O){this._renderElements.push(B$O),this._needSort=!0},B$O._addDynamicBatchElement=function(B$O){this._dynamicBatchCombineRenderElements.push(B$O)},B$X(0,B$O,"id",function(){return this._id}),B$J._uniqueIDCounter=0,B$J._cameraPosition=null,B$J}(),B$B=function(){function B$O(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return B$G(B$O,"laya.d3.core.render.RenderState"),B$O.clientWidth=0,B$O.clientHeight=0,B$O}(),B$S=function(){function B$i(B$O,B$J){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new B$bO(new B$iJ,0),this._corners=[new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ],this._boundingBoxCenter=new B$iJ,this._children=B$p(8),this._objects=[],this._tempBoundBoxCorners=[new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ],this._scene=B$O,this._currentDepth=B$J}B$G(B$i,"laya.d3.core.scene.OctreeNode");var B$O=B$i.prototype;return B$d.imps(B$O,{"laya.d3.core.scene.ITreeNode":!0}),B$O.init=function(B$O,B$J){var B$D=new B$iJ,B$p=new B$iJ;B$iJ.scale(B$J,-.5,B$D),B$iJ.scale(B$J,.5,B$p),B$iJ.add(B$D,B$O,B$D),B$iJ.add(B$p,B$O,B$p),this.exactBox=new B$SO(B$D,B$p),this.relaxBox=new B$SO(B$D,B$p)},B$O.addTreeNode=function(B$O){1===Collision.boxContainsBox(this._relaxBox,B$O.boundingBox)?this.addNodeDown(B$O,0):this.addObject(B$O)},B$O.addChild=function(B$O){var B$J=this._children[B$O];if(null==B$J){B$J=new B$i(this._scene,this._currentDepth+1),(this._children[B$O]=B$J)._parent=this,B$iJ.subtract(this._exactBox.max,this._exactBox.min,B$i.tempSize),B$iJ.multiply(B$i.tempSize,B$i._octreeSplit[B$O],B$i.tempCenter),B$iJ.add(this._exactBox.min,B$i.tempCenter,B$i.tempCenter),B$iJ.scale(B$i.tempSize,.25,B$i.tempSize);var B$D=new B$iJ,B$p=new B$iJ;B$iJ.subtract(B$i.tempCenter,B$i.tempSize,B$D),B$iJ.add(B$i.tempCenter,B$i.tempSize,B$p),B$J.exactBox=new B$SO(B$D,B$p),B$iJ.scale(B$i.tempSize,B$i.relax,B$i.tempSize);var B$m=new B$iJ,B$C=new B$iJ;B$iJ.subtract(B$i.tempCenter,B$i.tempSize,B$m),B$iJ.add(B$i.tempCenter,B$i.tempSize,B$C),B$J.relaxBox=new B$SO(B$m,B$C)}return B$J},B$O.addObject=function(B$O){(B$O._treeNode=this)._objects.push(B$O)},B$O.removeObject=function(B$O){if(B$O._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var B$J=this._objects.indexOf(B$O);return-1!==B$J&&(this._objects.splice(B$J,1),!0)},B$O.clearObject=function(){this._objects.length=0},B$O.addNodeUp=function(B$O,B$J){this._parent&&1!==Collision.boxContainsBox(this._exactBox,B$O.boundingBox)?this._parent.addNodeUp(B$O,B$J-1):this.addNodeDown(B$O,B$J)},B$O.addNodeDown=function(B$O,B$J){if(B$J<this._scene.treeLevel){var B$D=this.inChildIndex(B$O.boundingBoxCenter),B$p=this.addChild(B$D);1===Collision.boxContainsBox(B$p._relaxBox,B$O.boundingBox)?B$p.addNodeDown(B$O,++B$J):this.addObject(B$O)}else this.addObject(B$O)},B$O.inChildIndex=function(B$O){return 4*(B$O.z<this._boundingBoxCenter.z?0:1)+2*(B$O.y<this._boundingBoxCenter.y?0:1)+(B$O.x<this._boundingBoxCenter.x?0:1)},B$O.updateObject=function(B$O){1===Collision.boxContainsBox(this._relaxBox,B$O.boundingBox)?(this.removeObject(B$O),B$O._treeNode=null,this.addNodeDown(B$O,this._currentDepth)):this._parent&&(this.removeObject(B$O),B$O._treeNode=null,this._parent.addNodeUp(B$O,this._currentDepth-1))},B$O.cullingObjects=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i=0,B$k=0,B$_=0,B$L=this._scene._dynamicBatchManager;for(B$i=0,B$C=this._objects.length;B$i<B$C;B$i++){var B$r=this._objects[B$i];if(B$W.isVisible(B$r._owner.layer.mask)&&B$r.enable){if(B$J&&(B$e.treeSpriteCollision+=1,0===B$O.containsBoundSphere(B$r.boundingSphere)))continue;B$r._renderUpdate(B$m),B$r._distanceForSort=B$iJ.distance(B$r.boundingSphere.center,B$p)+B$r.sortingFudge;var B$H=B$r._renderElements;for(B$k=0,B$_=B$H.length;B$k<B$_;B$k++){var B$Y=B$H[B$k],B$G=B$Y._staticBatch;if(B$G&&B$G._material===B$Y._material)B$G._addBatchRenderElement(B$Y);else{var B$X=B$Y.renderObj;B$X.triangleCount<10&&1===B$X._vertexBufferCount&&B$X._getIndexBuffer()&&B$Y._material.renderQueue<2&&B$Y._canDynamicBatch&&!B$r._owner.isStatic?B$L._addPrepareRenderElement(B$Y):this._scene.getRenderQueue(B$Y._material.renderQueue)._addRenderElement(B$Y)}}}}for(B$i=0;B$i<8;B$i++){var B$c=this._children[B$i];if(null!=B$c){var B$h=B$J;if(B$J){var B$y=B$O.containsBoundBox(B$c._relaxBox);if(B$e.treeNodeCollision+=1,0===B$y)continue;B$h=2===B$y}B$c.cullingObjects(B$O,B$h,B$D,B$p,B$m)}}},B$O.cullingShadowObjects=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i=0,B$k=0,B$_=0;this._scene._dynamicBatchManager;for(B$i=0,B$C=this._objects.length;B$i<B$C;B$i++){var B$L=this._objects[B$i];if(B$L.castShadow&&B$W.isVisible(B$L._owner.layer.mask)&&B$L.enable){if(B$D&&0===B$O[0].containsBoundSphere(B$L.boundingSphere))continue;for(var B$r=1,B$H=B$O.length;B$r<B$H;B$r++){var B$Y=B$J[B$r-1];if(0!==B$O[B$r].containsBoundSphere(B$L.boundingSphere)){var B$G=B$L._renderElements;for(B$k=0,B$_=B$G.length;B$k<B$_;B$k++)B$Y._addRenderElement(B$G[B$k])}}}}for(B$i=0;B$i<8;B$i++){var B$X=this._children[B$i];if(null!=B$X){var B$c=B$D;if(B$D){var B$h=B$O[0].containsBoundBox(B$X._relaxBox);if(0===B$h)continue;B$c=2===B$h}B$X.cullingShadowObjects(B$O,B$J,B$c,B$p,B$m)}}},B$O.cullingShadowObjectsOnePSSM=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k=B$J[0],B$_=0,B$L=0,B$r=0;for(B$_=0,B$i=this._objects.length;B$_<B$i;B$_++){var B$H=this._objects[B$_];if(B$H.castShadow&&B$W.isVisible(B$H._owner.layer.mask)&&B$H.enable){if(B$p&&0===B$O.containsBoundSphere(B$H.boundingSphere))continue;B$H._renderUpdate(B$D);var B$Y=B$H._renderElements;for(B$L=0,B$r=B$Y.length;B$L<B$r;B$L++)B$k._addRenderElement(B$Y[B$L])}}for(B$_=0;B$_<8;B$_++){var B$G=this._children[B$_];if(null!=B$G){var B$X=B$p;if(B$p){var B$c=B$O.containsBoundBox(B$G._relaxBox);if(0===B$c)continue;B$X=2===B$c}B$G.cullingShadowObjectsOnePSSM(B$O,B$J,B$D,B$X,B$m,B$C)}}},B$O.renderBoudingBox=function(B$O){this._renderBoudingBox(B$O);for(var B$J=0;B$J<8;++B$J){var B$D=this._children[B$J];B$D&&B$D.renderBoudingBox(B$O)}},B$O.buildAllChild=function(B$O){if(B$O<this._scene.treeLevel)for(var B$J=0;B$J<8;B$J++){this.addChild(B$J).buildAllChild(B$O+1)}},B$O._renderBoudingBox=function(B$O){},B$X(0,B$O,"exactBox",function(){return this._exactBox},function(B$O){this._exactBox=B$O,B$iJ.add(B$O.min,B$O.max,this._boundingBoxCenter),B$iJ.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),B$X(0,B$O,"relaxBox",function(){return this._relaxBox},function(B$O){(this._relaxBox=B$O).getCorners(this._corners),B$bO.createfromPoints(this._corners,this._boundingSphere)}),B$i.debugMode=!1,B$i.relax=1.15,B$i.CHILDNUM=8,B$H(B$i,["tempVector0",function(){return this.tempVector0=new B$iJ},"tempSize",function(){return this.tempSize=new B$iJ},"tempCenter",function(){return this.tempCenter=new B$iJ},"_octreeSplit",function(){return this._octreeSplit=[new B$iJ(.25,.25,.25),new B$iJ(.75,.25,.25),new B$iJ(.25,.75,.25),new B$iJ(.75,.75,.25),new B$iJ(.25,.25,.75),new B$iJ(.75,.25,.75),new B$iJ(.25,.75,.75),new B$iJ(.75,.75,.75)]}]),B$i}(),B$Q=(function(){function B$O(){}B$G(B$O,"laya.d3.core.scene.SceneManager")}(),function(){function B$O(B$O,B$J,B$D,B$p){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===B$O&&(B$O=1),void 0===B$J&&(B$J=1),void 0===B$D&&(B$D=1),void 0===B$p&&(B$p=1),this._r=B$O,this._g=B$J,this._b=B$D,this._a=B$p}return B$G(B$O,"laya.d3.core.trail.module.Color",null,"Color$1"),B$O.prototype.cloneTo=function(B$O){B$O._r=this._r,B$O._g=this._g,B$O._b=this._b,B$O._a=this._a},B$H(B$O,["RED",function(){return this.RED=new B$O(1,0,0,1)},"GREEN",function(){return this.GREEN=new B$O(0,1,0,1)},"BLUE",function(){return this.BLUE=new B$O(0,0,1,1)},"CYAN",function(){return this.CYAN=new B$O(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new B$O(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new B$O(1,0,1,1)},"GRAY",function(){return this.GRAY=new B$O(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new B$O(1,1,1,1)},"BLACK",function(){return this.BLACK=new B$O(0,0,0,1)}]),B$O}()),B$b=(function(){function B$O(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}B$G(B$O,"laya.d3.core.trail.module.Gradient");var B$J=B$O.prototype;B$J.setKeys=function(B$O,B$J){var B$D,B$p;this._colorKeys=B$O;for(var B$m=this.index=0;B$m<B$O.length;B$m++){var B$C=(B$D=B$O[B$m]).color;this._colorKeyData[this.index++]=B$C._r,this._colorKeyData[this.index++]=B$C._g,this._colorKeyData[this.index++]=B$C._b,this._colorKeyData[this.index++]=B$D.time}this._alphaKeys=B$J;for(var B$i=this.index=0;B$i<B$J.length;B$i++)B$p=B$J[B$i],this._alphaKeyData[this.index++]=B$p.alpha,this._alphaKeyData[this.index++]=B$p.time},B$J.cloneTo=function(B$O){var B$J=0,B$D=0,B$p=this.colorKeys,B$m=[];for(B$J=0,B$D=B$p.length;B$J<B$D;B$J++){var B$C=new B$K;B$p[B$J].cloneTo(B$C),B$m.push(B$C)}var B$i=this.alphaKeys,B$k=[];for(B$J=0,B$D=B$i.length;B$J<B$D;B$J++){var B$_=new B$b;B$i[B$J].cloneTo(B$_),B$k.push(B$_)}B$O.setKeys(B$m,B$k)},B$X(0,B$J,"mode",function(){return this._mode},function(B$O){this._mode=B$O}),B$X(0,B$J,"colorKeys",function(){return this._colorKeys},function(B$O){this._colorKeys=B$O;for(var B$J=this.index=0;B$J<B$O.length;B$J++){var B$D=B$O[B$J],B$p=B$D.color;this._colorKeyData[this.index++]=B$p._r,this._colorKeyData[this.index++]=B$p._g,this._colorKeyData[this.index++]=B$p._b,this._colorKeyData[this.index++]=B$D.time}}),B$X(0,B$J,"alphaKeys",function(){return this._alphaKeys},function(B$O){this._alphaKeys=B$O;for(var B$J=this.index=0;B$J<B$O.length;B$J++){var B$D=B$O[B$J];this._alphaKeyData[this.index++]=B$D.alpha,this._alphaKeyData[this.index++]=B$D.time}})}(),function(){function B$O(B$O,B$J){this._alpha=NaN,this._time=NaN,void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),this._alpha=B$O,this._time=B$J}B$G(B$O,"laya.d3.core.trail.module.GradientAlphaKey");var B$J=B$O.prototype;return B$J.cloneTo=function(B$O){B$O.alpha=this.alpha,B$O.time=this.time},B$X(0,B$J,"alpha",function(){return this._alpha},function(B$O){this._alpha=B$O}),B$X(0,B$J,"time",function(){return this._time},function(B$O){this._time=B$O}),B$O}()),B$K=function(){function B$O(B$O,B$J){this._color=null,this._time=NaN,void 0===B$J&&(B$J=0),this._color=B$O||new B$Q,this._time=B$J}B$G(B$O,"laya.d3.core.trail.module.GradientColorKey");var B$J=B$O.prototype;return B$J.cloneTo=function(B$O){this.color.cloneTo(B$O.color),B$O.time=this.time},B$X(0,B$J,"color",function(){return this._color},function(B$O){this._color=B$O}),B$X(0,B$J,"time",function(){return this._time},function(B$O){this._time=B$O}),B$O}(),B$f=(function(){function B$O(){}B$G(B$O,"laya.d3.core.trail.module.GradientMode"),B$O.Blend=0,B$O.Fixed=1}(),function(){function B$O(){}B$G(B$O,"laya.d3.core.trail.module.TextureMode"),B$O.Stretch=0,B$O.Tile=1}(),function(){function B$O(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}B$G(B$O,"laya.d3.core.trail.module.TrailKeyFrame"),B$O.prototype.cloneTo=function(B$O){B$O.time=this.time,B$O.inTangent=this.inTangent,B$O.outTangent=this.outTangent,B$O.value=this.value}}(),function(){function B$J(B$O){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new B$iJ,this._curPosition=new B$iJ,this._delVector3=new B$iJ,this._lastFixedVertexPosition=new B$iJ,this._pointAtoBVector3=new B$iJ,this._pointA=new B$iJ,this._pointB=new B$iJ,this._owner=B$O,this._id=B$J.renderElementCount++,0==this._id?B$O._owner.transform.position.cloneTo(this._lastPosition):B$O._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new B$lJ(B$f.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new B$lJ(B$f.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}B$G(B$J,"laya.d3.core.trail.TrailRenderElement");var B$O=B$J.prototype;B$d.imps(B$O,{"laya.d3.core.render.IRenderable":!0}),B$O._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},B$O._addTrailByFirstPosition=function(B$O,B$J){B$iJ.subtract(B$J,B$O,this._delVector3),B$iJ.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),B$iJ.normalize(this._pointAtoBVector3,this._pointAtoBVector3),B$iJ.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(B$O),B$O.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},B$O._addTrailByNextPosition=function(B$O){B$iJ.subtract(B$O,this._lastFixedVertexPosition,this._delVector3),B$iJ.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),B$iJ.normalize(this._pointAtoBVector3,this._pointAtoBVector3),B$iJ.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=B$iJ.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=B$KO.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(B$O),B$O.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(B$O),this._virtualVerticesCount=2)},B$O._updateVerticesByPosition=function(B$O){this._pointe=B$O.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},B$O._updateVertexBuffer2=function(){var B$O,B$J=0,B$D=0,B$p=0;for(B$p=0,B$O=(this._verticesCount+this._virtualVerticesCount)/2;B$p<B$O;B$p++)B$D=0==this._owner.textureMode?(this._VerticesToTailLength[B$p]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[B$p],this._vertices2[B$J++]=1-B$D,this._vertices2[B$J++]=1-B$D;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},B$O._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},B$O._updateDisappear=function(){var B$O,B$J=0;for(B$J=this._curDisappearIndex,B$O=(this._verticesCount+this._virtualVerticesCount)/2;B$J<B$O;B$J++)this._owner._curtime-this._everyGroupVertexBirthTime[B$J]>=this._owner.time+B$KO.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},B$O._beforeRender=function(B$O){return this._camera=B$O.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),B$iJ.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},B$O._render=function(B$O){this._isDead||(B$P.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),B$e.drawCall++,B$e.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},B$O._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),0===B$O?this._vertexBuffer1:1===B$O?this._vertexBuffer2:null},B$O._getVertexBuffers=function(){return this._vertexBuffers},B$O._getIndexBuffer=function(){return null},B$O.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},B$O._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},B$X(0,B$O,"_vertexBufferCount",function(){return this._vertexBuffers.length}),B$X(0,B$O,"triangleCount",function(){return 0}),B$J.renderElementCount=0}(),function(){function B$O(){}B$G(B$O,"laya.d3.core.trail.VertexTrail");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration1}),B$X(1,B$O,"vertexDeclaration1",function(){return B$O._vertexDeclaration1}),B$X(1,B$O,"vertexDeclaration2",function(){return B$O._vertexDeclaration2}),B$H(B$O,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new B$CO(32,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",41),new B$iO(24,"single",33),new B$iO(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new B$CO(4,[new B$iO(0,"single",38)])}]),B$O}()),B$OO=function(){function B$q(B$O){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=B$O}B$G(B$q,"laya.d3.graphics.DynamicBatch");var B$O=B$q.prototype;return B$d.imps(B$O,{"laya.d3.core.render.IRenderable":!0}),B$O._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),0===B$O?this._vertexBuffer:null},B$O._getIndexBuffer=function(){return this._indexBuffer},B$O._getCombineRenderElementFromPool=function(B$O,B$J,B$D){var B$p=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return B$p||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=B$p=new B$Z,B$p._sprite3D=new B$nJ),B$p._sprite3D._render._renderUpdate(B$D),B$p},B$O._getRenderElement=function(B$O,B$J,B$D){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*B$q.maxVertexCount),this._indexDatas=new Uint16Array(B$q.maxIndexCount),this._vertexBuffer=B$lJ.create(this._vertexDeclaration,B$q.maxVertexCount,35048),this._indexBuffer=B$uJ.create("ushort",B$q.maxIndexCount,35048));for(var B$p=this._merageElements.length=0,B$m=0,B$C=0,B$i=this._combineRenderElements.length;B$C<B$i;B$C++){var B$k=this._combineRenderElements[B$C],B$_=B$k.getDynamicBatchBakedVertexs(0),B$L=B$k.getBakedIndices(),B$r=B$k._sprite3D.transform._isFrontFaceInvert,B$H=B$p/(this._vertexDeclaration.vertexStride/4),B$Y=B$m,B$G=B$Y+B$L.length;B$k._tempBatchIndexStart=B$Y,B$k._tempBatchIndexEnd=B$G,this._indexDatas.set(B$L,B$m);var B$X=0;if(B$r)for(B$X=B$Y;B$X<B$G;B$X+=3){this._indexDatas[B$X]=B$H+this._indexDatas[B$X];var B$c=this._indexDatas[B$X+1],B$h=this._indexDatas[B$X+2];this._indexDatas[B$X+1]=B$H+B$h,this._indexDatas[B$X+2]=B$H+B$c}else for(B$X=B$Y;B$X<B$G;B$X+=3)this._indexDatas[B$X]=B$H+this._indexDatas[B$X],this._indexDatas[B$X+1]=B$H+this._indexDatas[B$X+1],this._indexDatas[B$X+2]=B$H+this._indexDatas[B$X+2];B$m+=B$L.length,this._vertexDatas.set(B$_,B$p),B$p+=B$_.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),B$C=this._combineRenderElementPoolIndex=0,B$i=this._materials.length;B$C<B$i;B$C++){var B$y=this._getCombineRenderElementFromPool(B$O,B$J,B$D);B$y._type=2,B$y._staticBatch=null;var B$v=(B$y.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[B$C]]._tempBatchIndexStart,B$A=B$C+1===this._materialToRenderElementsOffsets.length?B$m:this._combineRenderElements[this._materialToRenderElementsOffsets[B$C+1]]._tempBatchIndexStart;B$y._tempBatchIndexStart=B$v,B$y._tempBatchIndexEnd=B$A,B$y._material=this._materials[B$C],this._merageElements.push(B$y)}},B$O._addCombineRenderObjTest=function(B$O){var B$J=B$O.renderObj,B$D=this._currentCombineIndexCount+B$J._getIndexBuffer().indexCount,B$p=this._currentCombineVertexCount+B$J._getVertexBuffer().vertexCount;return!(B$q.maxVertexCount<B$p||B$q.maxIndexCount<B$D)},B$O._addCombineRenderObj=function(B$O){var B$J=B$O.renderObj;this._combineRenderElements.push(B$O),this._currentCombineIndexCount=this._currentCombineIndexCount+B$J._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+B$J._getVertexBuffer().vertexCount},B$O._addCombineMaterial=function(B$O){this._materials.push(B$O)},B$O._addMaterialToRenderElementOffset=function(B$O){this._materialToRenderElementsOffsets.push(B$O)},B$O._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},B$O._addToRenderQueue=function(B$O,B$J,B$D,B$p){this._getRenderElement(B$J,B$D,B$p);for(var B$m=0,B$C=this._materials.length;B$m<B$C;B$m++)B$O.getRenderQueue(this._materials[B$m].renderQueue)._addDynamicBatchElement(this._merageElements[B$m])},B$O._beforeRender=function(B$O){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},B$O._render=function(B$O){var B$J=B$O._batchIndexEnd-B$O._batchIndexStart;B$P.mainContext.drawElements(4,B$J,5123,2*B$O._batchIndexStart),B$e.drawCall++,B$e.trianglesFaces+=B$J/3},B$O._getVertexBuffers=function(){return null},B$X(0,B$O,"_vertexBufferCount",function(){return 1}),B$X(0,B$O,"triangleCount",function(){return this._indexBuffer.indexCount/3}),B$X(0,B$O,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),B$q.maxVertexCount=2e4,B$q.maxIndexCount=4e4,B$q.maxCombineTriangleCount=10,B$q}(),B$JO=function(){function B$q(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}B$G(B$q,"laya.d3.graphics.DynamicBatchManager");var B$O=B$q.prototype;return B$O.getDynamicBatch=function(B$O,B$J){var B$D,B$p=B$O.id.toString()+B$J;return this._dynamicBatches[B$p]?B$D=this._dynamicBatches[B$p]:this._dynamicBatches[B$p]=B$D=new B$OO(B$O),B$D},B$O._garbageCollection=function(){for(var B$O in this._dynamicBatches)0===this._dynamicBatches[B$O].combineRenderElementsCount&&delete this._dynamicBatches[B$O]},B$O._addPrepareRenderElement=function(B$O){this._prepareDynamicBatchCombineElements.push(B$O)},B$O._finishCombineDynamicBatch=function(B$O){var B$J,B$D,B$p;this._prepareDynamicBatchCombineElements.sort(B$q._sortPrepareDynamicBatch);for(var B$m,B$C,B$i,B$k,B$_,B$L=-1,B$r=!0,B$H=0,B$Y=-1,B$G=0,B$X=this._prepareDynamicBatchCombineElements.length;B$G<B$X;B$G++){var B$c=(B$C=this._prepareDynamicBatchCombineElements[B$G]).renderObj._getVertexBuffer(0).vertexDeclaration,B$h=B$D!==B$c;B$h&&(B$H=0,B$D=B$c);var B$y=B$H!==B$L;if(B$y&&(B$L=B$H),(B$h||B$y)&&(B$i=this.getDynamicBatch(B$c,B$H),B$J=null),B$r)if(B$i._addCombineRenderObjTest(B$C)){if(B$J!==(B$m=B$C._material))B$k&&(B$O.getRenderQueue(B$_._material.renderQueue)._addRenderElement(B$_),B$_=B$k=null,B$Y=-1),B$k=B$m,B$Y=B$i.combineRenderElementsCount,B$_=B$C,B$J=B$m;else if(B$k){var B$v=B$_.renderObj,B$A=B$C.renderObj;B$v._getVertexBuffer().vertexCount+B$A._getVertexBuffer().vertexCount>B$OO.maxVertexCount||B$v._getIndexBuffer().indexCount+B$A._getIndexBuffer().indexCount>B$OO.maxIndexCount?(B$O.getRenderQueue(B$_._material.renderQueue)._addRenderElement(B$_),B$k=B$m,B$Y=B$i.combineRenderElementsCount,B$_=B$C):(B$i._addCombineMaterial(B$k),B$i._addMaterialToRenderElementOffset(B$Y),B$i._addCombineRenderObj(B$_),B$_=B$k=null,B$Y=-1,B$i._addCombineRenderObj(B$C))}else B$i._addCombineRenderObj(B$C);B$r=!0}else B$k&&(B$O.getRenderQueue(B$_._material.renderQueue)._addRenderElement(B$_),B$_=B$k=null,B$Y=-1),B$H++,B$r=!1;else B$p=this._prepareDynamicBatchCombineElements[B$G-1],B$i._addMaterialToRenderElementOffset(B$i.combineRenderElementsCount),B$J=B$p._material,B$i._addCombineMaterial(B$J),B$i._addCombineRenderObj(B$p),B$r=!0,B$J!==(B$m=B$C._material)?(B$k=B$m,B$Y=B$i.combineRenderElementsCount,B$_=B$C):B$i._addCombineRenderObj(B$C),B$J=B$m}B$k&&(B$O.getRenderQueue(B$_._material.renderQueue)._addRenderElement(B$_),B$_=B$k=null,B$Y=-1),this._prepareDynamicBatchCombineElements.length=0},B$O._clearRenderElements=function(){for(var B$O in this._dynamicBatches)this._dynamicBatches[B$O]._clearRenderElements()},B$O._addToRenderQueue=function(B$O,B$J,B$D,B$p){for(var B$m in this._dynamicBatches){var B$C=this._dynamicBatches[B$m];0<B$C.combineRenderElementsCount&&B$C._addToRenderQueue(B$O,B$J,B$D,B$p)}},B$O.dispose=function(){this._dynamicBatches=null},B$q._sortPrepareDynamicBatch=function(B$O,B$J){return B$O._mainSortID-B$J._mainSortID},B$q}(),B$DO=function(){function B$O(){}return B$G(B$O,"laya.d3.graphics.FrustumCulling"),B$O.renderShadowObjectCulling=function(B$O,B$J,B$D,B$p,B$m){var B$C=0,B$i=0,B$k=0,B$_=0;for(B$C=0,B$k=B$D.length;B$C<B$k;B$C++){var B$L=B$D[B$C];B$L&&B$L._clearRenderElements()}var B$r,B$H,B$Y,B$G=B$O._cullingRenders;if(1<B$m){for(B$C=0,B$k=B$O._cullingRendersLength;B$C<B$k;B$C++)if((B$r=B$G[B$C]).castShadow&&B$W.isVisible(B$r._owner.layer.mask)&&B$r.enable)for(var B$X=1,B$c=B$J.length;B$X<B$c;B$X++)if(B$H=B$D[B$X-1],0!==B$J[B$X].containsBoundSphere(B$r.boundingSphere))for(B$i=0,B$_=(B$Y=B$r._renderElements).length;B$i<B$_;B$i++)B$H._addRenderElement(B$Y[B$i])}else for(B$C=0,B$k=B$O._cullingRendersLength;B$C<B$k;B$C++)if((B$r=B$G[B$C]).castShadow&&B$W.isVisible(B$r._owner.layer.mask)&&B$r.enable&&0!==B$J[0].containsBoundSphere(B$r.boundingSphere))for(B$r._renderUpdate(B$p),B$H=B$D[0],B$i=0,B$_=(B$Y=B$r._renderElements).length;B$i<B$_;B$i++)B$H._addRenderElement(B$Y[B$i])},B$O.renderShadowObjectCullingOctree=function(B$O,B$J,B$D,B$p,B$m){for(var B$C=0,B$i=B$D.length;B$C<B$i;B$C++){var B$k=B$D[B$C];B$k&&B$k._clearRenderElements()}1<B$m?B$O.treeRoot.cullingShadowObjects(B$J,B$D,!0,0,B$O):B$O.treeRoot.cullingShadowObjectsOnePSSM(B$J[0],B$D,B$p,!0,0,B$O)},B$O.renderObjectCulling=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=0,B$k=0,B$_=0,B$L=0,B$r=B$J._quenes,B$H=B$J._dynamicBatchManager,B$Y=B$J._cullingRenders;for(B$i=0,B$k=B$r.length;B$i<B$k;B$i++){var B$G=B$r[B$i];B$G&&B$G._clearRenderElements()}var B$X=B$pO._staticBatchManagers;for(B$i=0,B$k=B$X.length;B$i<B$k;B$i++)B$X[B$i]._clearRenderElements();B$H._clearRenderElements();var B$c=B$D.transform.position;for(B$i=0,B$k=B$J._cullingRendersLength;B$i<B$k;B$i++){var B$h=B$Y[B$i];if(B$W.isVisible(B$h._owner.layer.mask)&&B$h.enable&&0!==B$O.containsBoundSphere(B$h.boundingSphere)&&B$h._renderUpdate(B$C)){B$h._distanceForSort=B$iJ.distance(B$h.boundingSphere.center,B$c)+B$h.sortingFudge;var B$y=B$h._renderElements;for(B$_=0,B$L=B$y.length;B$_<B$L;B$_++){var B$v=B$y[B$_],B$A=B$v._staticBatch;if(B$A&&B$A._material===B$v._material)B$A._addBatchRenderElement(B$v);else{var B$q=B$v.renderObj;B$q.triangleCount<10&&1===B$q._vertexBufferCount&&B$q._getIndexBuffer()&&B$v._material.renderQueue<2&&B$v._canDynamicBatch&&!B$h._owner.isStatic?B$H._addPrepareRenderElement(B$v):B$J.getRenderQueue(B$v._material.renderQueue)._addRenderElement(B$v)}}}}for(B$i=0,B$k=B$X.length;B$i<B$k;B$i++)B$X[B$i]._addToRenderQueue(B$J,B$p,B$m,B$C);B$H._finishCombineDynamicBatch(B$J),B$H._addToRenderQueue(B$J,B$p,B$m,B$C)},B$O.renderObjectCullingOctree=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=0,B$k=0,B$_=B$J._quenes,B$L=B$J._dynamicBatchManager;for(B$i=0,B$k=B$_.length;B$i<B$k;B$i++){var B$r=B$_[B$i];B$r&&B$r._clearRenderElements()}var B$H=B$pO._staticBatchManagers;for(B$i=0,B$k=B$H.length;B$i<B$k;B$i++)B$H[B$i]._clearRenderElements();for(B$L._clearRenderElements(),B$J._cullingRenders.length=0,B$J.treeRoot.cullingObjects(B$O,!0,0,B$D.transform.position,B$C),B$i=0,B$k=B$H.length;B$i<B$k;B$i++)B$H[B$i]._addToRenderQueue(B$J,B$p,B$m,B$C);B$L._finishCombineDynamicBatch(B$J),B$L._addToRenderQueue(B$J,B$p,B$m,B$C)},B$O.renderObjectCullingNoBoundFrustum=function(B$O,B$J,B$D,B$p,B$m){var B$C=0,B$i=0,B$k=0,B$_=0,B$L=B$O._quenes,B$r=B$O._dynamicBatchManager,B$H=B$O._cullingRenders;for(B$C=0,B$i=B$L.length;B$C<B$i;B$C++){var B$Y=B$L[B$C];B$Y&&B$Y._clearRenderElements()}var B$G=B$pO._staticBatchManagers;for(B$C=0,B$i=B$G.length;B$C<B$i;B$C++)B$G[B$C]._clearRenderElements();B$r._clearRenderElements();var B$X=B$J.transform.position;for(B$C=0,B$i=B$O._cullingRendersLength;B$C<B$i;B$C++){var B$c=B$H[B$C];if(B$W.isVisible(B$c._owner.layer.mask)&&B$c.enable){B$c._renderUpdate(B$m),B$c._distanceForSort=B$iJ.distance(B$c.boundingSphere.center,B$X)+B$c.sortingFudge;var B$h=B$c._renderElements;for(B$k=0,B$_=B$h.length;B$k<B$_;B$k++){var B$y=B$h[B$k],B$v=B$y._staticBatch;if(B$v&&B$v._material===B$y._material)B$v._addBatchRenderElement(B$y);else{var B$A=B$y.renderObj;B$A.triangleCount<10&&1===B$A._vertexBufferCount&&B$A._getIndexBuffer()&&B$y._material.renderQueue<2&&B$y._canDynamicBatch&&!B$c._owner.isStatic?B$r._addPrepareRenderElement(B$y):B$O.getRenderQueue(B$y._material.renderQueue)._addRenderElement(B$y)}}}}for(B$C=0,B$i=B$G.length;B$C<B$i;B$C++)B$G[B$C]._addToRenderQueue(B$O,B$D,B$p,B$m);B$r._finishCombineDynamicBatch(B$O),B$r._addToRenderQueue(B$O,B$D,B$p,B$m)},B$O}(),B$pO=function(){function B$C(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}B$G(B$C,"laya.d3.graphics.StaticBatchManager");var B$O=B$C.prototype;return B$O._finishInit=function(){for(var B$O in this._staticBatches)this._staticBatches[B$O]._finishInit();this._initBatchRenderElements.length=0},B$O._initStaticBatchs=function(B$O){throw new Error("StaticBatchManager:must override this function.")},B$O._addInitBatchSprite=function(B$O){for(var B$J=B$O._render._renderElements,B$D=0,B$p=B$J.length;B$D<B$p;B$D++)this._initBatchRenderElements.push(B$J[B$D])},B$O._clearRenderElements=function(){for(var B$O in this._staticBatches)this._staticBatches[B$O]._clearRenderElements()},B$O._garbageCollection=function(B$O){var B$J=B$O._staticBatch,B$D=B$J._initBatchRenderElements,B$p=B$D.indexOf(B$O);B$D.splice(B$p,1),0===B$D.length&&(B$J.dispose(),delete this._staticBatches[B$J._key])},B$O._addToRenderQueue=function(B$O,B$J,B$D,B$p){for(var B$m in this._staticBatches){var B$C=this._staticBatches[B$m];0<B$C._batchRenderElements.length&&B$C._updateToRenderQueue(B$O,B$p)}},B$O.dispose=function(){this._staticBatches=null},B$C._addToStaticBatchQueue=function(B$O){B$O instanceof laya.d3.core.RenderableSprite3D&&B$O._addToInitStaticBatchManager();for(var B$J=0,B$D=B$O.numChildren;B$J<B$D;B$J++)B$C._addToStaticBatchQueue(B$O._childs[B$J])},B$C.combine=function(B$O,B$J){var B$D,B$p=0,B$m=0;if(B$J)for(B$p=0,B$m=B$J.length;B$p<B$m;B$p++){B$J[B$p]._addToInitStaticBatchManager()}else B$O&&B$C._addToStaticBatchQueue(B$O);for(B$p=0,B$m=B$C._staticBatchManagers.length;B$p<B$m;B$p++)(B$D=B$C._staticBatchManagers[B$p])._initStaticBatchs(B$O),B$D._finishInit()},B$C._staticBatchManagers=[],B$C}(),B$mO=function(){function B$O(B$O,B$J,B$D){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=B$O,this._manager=B$J,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=B$D}B$G(B$O,"laya.d3.graphics.StaticBatch");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),B$J._binarySearch=function(B$O){for(var B$J=0,B$D=this._batchRenderElements.length-1,B$p=0;B$J<=B$D;)B$p=Math.floor((B$J+B$D)/2),this._compareBatchRenderElement(this._batchRenderElements[B$p],B$O)?B$D=B$p-1:B$J=B$p+1;return B$J},B$J._compareBatchRenderElement=function(B$O,B$J){throw new Error("StaticBatch:must override this function.")},B$J._getVertexDecLightMap=function(B$O){return B$O===B$uO.vertexDeclaration?B$WO.vertexDeclaration:B$O===B$jO.vertexDeclaration?B$oO.vertexDeclaration:B$O===B$tO.vertexDeclaration?B$qO.vertexDeclaration:B$O===B$VO.vertexDeclaration?null:B$O===B$cO.vertexDeclaration?B$hO.vertexDeclaration:B$O===B$$O.vertexDeclaration?B$FO.vertexDeclaration:B$O===B$PO.vertexDeclaration?B$EO.vertexDeclaration:B$O===B$lO.vertexDeclaration?B$NO.vertexDeclaration:B$O===B$jO.vertexDeclaration?B$oO.vertexDeclaration:B$O===B$zO.vertexDeclaration?B$dO.vertexDeclaration:B$O===B$VO.vertexDeclaration?null:B$O===B$cO.vertexDeclaration?B$hO.vertexDeclaration:B$O===B$xO.vertexDeclaration?B$RO.vertexDeclaration:B$O===B$PO.vertexDeclaration?B$EO.vertexDeclaration:B$O},B$J._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},B$J._addBatchRenderElement=function(B$O){this._batchRenderElements.splice(this._binarySearch(B$O),0,B$O)},B$J._updateToRenderQueue=function(B$O,B$J){this._combineRenderElementPoolIndex=0,this._getRenderElement(B$O.getRenderQueue(this._material.renderQueue)._renderElements,B$O,B$J)},B$J._getRenderElement=function(B$O,B$J,B$D){throw new Error("StaticBatch:must override this function.")},B$J._finishInit=function(){throw new Error("StaticBatch:must override this function.")},B$J._clearRenderElements=function(){this._batchRenderElements.length=0},B$J.dispose=function(){},B$J._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),null},B$J._getIndexBuffer=function(){return null},B$J._beforeRender=function(B$O){return!0},B$J._render=function(B$O){},B$J._getVertexBuffers=function(){return null},B$X(0,B$J,"_vertexBufferCount",function(){return 1}),B$X(0,B$J,"triangleCount",function(){return 0}),B$O.combine=function(B$O){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),B$pO.combine(B$O)},B$O.maxBatchVertexCount=65535,B$O}(),B$CO=function(){function B$i(B$O,B$J){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++B$i._uniqueIDCounter,this._id>B$i.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",B$i.maxVertexDeclaration);this._shaderValues=new B$YJ,this._vertexElementsDic={},this._vertexStride=B$O,this._vertexElements=B$J;for(var B$D=0;B$D<B$J.length;B$D++){var B$p=B$J[B$D],B$m=B$p.elementUsage;this._vertexElementsDic[B$m]=B$p;var B$C=[B$i._getTypeSize(B$p.elementFormat)/4,5126,!1,this._vertexStride,B$p.offset];switch(this._shaderValues.setValue(B$m,B$C),B$m){case 1:this._addShaderDefine(B$eJ.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(B$eJ.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(B$eJ.SHADERDEFINE_UV1)}}}B$G(B$i,"laya.d3.graphics.VertexDeclaration");var B$O=B$i.prototype;return B$O._addShaderDefine=function(B$O){this._shaderDefineValue|=B$O},B$O._removeShaderDefine=function(B$O){this._shaderDefineValue&=~B$O},B$O.getVertexElements=function(){return this._vertexElements.slice()},B$O.getVertexElementByUsage=function(B$O){return this._vertexElementsDic[B$O]},B$O.unBinding=function(){},B$X(0,B$O,"shaderDefineValue",function(){return this._shaderDefineValue}),B$X(0,B$O,"id",function(){return this._id}),B$X(0,B$O,"vertexStride",function(){return this._vertexStride}),B$X(0,B$O,"shaderValues",function(){return this._shaderValues}),B$i._getTypeSize=function(B$O){switch(B$O){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},B$i.getVertexStride=function(B$O){for(var B$J=0,B$D=0;B$D<B$O.Length;B$D++){var B$p=B$O[B$D],B$m=B$p.offset+B$i._getTypeSize(B$p.elementFormat);B$J<B$m&&(B$J=B$m)}return B$J},B$i._maxVertexDeclarationBit=1e3,B$i._uniqueIDCounter=1,B$H(B$i,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),B$i}(),B$iO=function(){function B$O(B$O,B$J,B$D){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=B$O,this.elementFormat=B$J,this.elementUsage=B$D}return B$G(B$O,"laya.d3.graphics.VertexElement"),B$O}(),B$kO=(function(){function B$O(){}B$G(B$O,"laya.d3.graphics.VertexElementFormat"),B$O.Single="single",B$O.Vector2="vector2",B$O.Vector3="vector3",B$O.Vector4="vector4",B$O.Color="color",B$O.Byte4="byte4",B$O.Short2="short2",B$O.Short4="short4",B$O.NormalizedShort2="normalizedshort2",B$O.NormalizedShort4="normalizedshort4",B$O.HalfVector2="halfvector2",B$O.HalfVector4="halfvector4"}(),function(){function B$O(){}B$G(B$O,"laya.d3.graphics.VertexElementUsage"),B$O.POSITION0=0,B$O.COLOR0=1,B$O.TEXTURECOORDINATE0=2,B$O.NORMAL0=3,B$O.BINORMAL0=4,B$O.TANGENT0=5,B$O.BLENDINDICES0=6,B$O.BLENDWEIGHT0=7,B$O.DEPTH0=8,B$O.FOG0=9,B$O.POINTSIZE0=10,B$O.SAMPLE0=11,B$O.TESSELLATEFACTOR0=12,B$O.COLOR1=13,B$O.NEXTTEXTURECOORDINATE0=14,B$O.TEXTURECOORDINATE1=15,B$O.NEXTTEXTURECOORDINATE1=16,B$O.CORNERTEXTURECOORDINATE0=17,B$O.VELOCITY0=18,B$O.STARTCOLOR0=19,B$O.STARTSIZE=20,B$O.AGEADDSCALE0=21,B$O.STARTROTATION=22,B$O.ENDCOLOR0=23,B$O.STARTLIFETIME=24,B$O.TIME0=33,B$O.SHAPEPOSITIONSTARTLIFETIME=30,B$O.DIRECTIONTIME=32,B$O.SIZEROTATION0=27,B$O.RADIUS0=28,B$O.RADIAN0=29,B$O.STARTSPEED=31,B$O.RANDOM0=34,B$O.RANDOM1=35,B$O.SIMULATIONWORLDPOSTION=36,B$O.SIMULATIONWORLDROTATION=37,B$O.TEXTURECOORDINATE0X=38,B$O.TEXTURECOORDINATE0X1=39,B$O.TEXTURECOORDINATE0Y=40,B$O.OFFSETVECTOR=41}(),function(){function B$O(B$O,B$J,B$D){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=B$O,this._textureCoordinate0=B$J,this._time=B$D}B$G(B$O,"laya.d3.graphics.VertexGlitter");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate0}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"time",function(){return this._time}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(24,[new B$iO(0,"vector3",0),new B$iO(12,"vector2",2),new B$iO(20,"single",33)])}])}(),function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=B$O,this._position=B$J,this._velocity=B$D,this._startColor=B$p,this._endColor=B$m,this._sizeRotation=B$C,this._radius=B$i,this._radian=B$k,this._ageAddScale=B$_,this._time=B$L}B$G(B$O,"laya.d3.graphics.VertexParticle");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"endColor",function(){return this._endColor}),B$X(0,B$J,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),B$X(0,B$J,"sizeRotation",function(){return this._sizeRotation}),B$X(0,B$J,"velocity",function(){return this._velocity}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"startColor",function(){return this._startColor}),B$X(0,B$J,"radius",function(){return this._radius}),B$X(0,B$J,"radian",function(){return this._radian}),B$X(0,B$J,"ageAddScale",function(){return this._ageAddScale}),B$X(0,B$J,"time",function(){return this._time}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(116,[new B$iO(0,"vector4",17),new B$iO(16,"vector3",0),new B$iO(28,"vector3",18),new B$iO(40,"vector4",19),new B$iO(56,"vector4",23),new B$iO(72,"vector3",27),new B$iO(84,"vector2",28),new B$iO(92,"vector4",29),new B$iO(108,"single",24),new B$iO(112,"single",33)])}])}(),function(){function B$O(B$O){this._position=null,this._position=B$O}B$G(B$O,"laya.d3.graphics.VertexPosition");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(12,[new B$iO(0,"vector3",0)])}]),B$O}()),B$_O=function(){function B$O(B$O,B$J){this._position=null,this._normal=null,this._position=B$O,this._normal=B$J}B$G(B$O,"laya.d3.graphics.VertexPositionNormal");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(24,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3)])}]),B$O}(),B$LO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._color=null,this._position=B$O,this._normal=B$J,this._color=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColor");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(40,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1)])}]),B$O}(),B$rO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._blendIndex=B$p,this._blendWeight=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorSkin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(72,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6)])}]),B$O}(),B$HO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._tangent=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(88,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6),new B$iO(72,"vector4",5)])}]),B$O}(),B$YO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._tangent=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(84,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6),new B$iO(72,"vector3",5)])}]),B$O}(),B$GO=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._tangent=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(56,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector4",5)])}]),B$O}(),B$XO=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._tangent=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(52,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector3",5)])}]),B$O}(),B$cO=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(48,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2)])}]),B$O}(),B$hO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(56,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15)])}]),B$O}(),B$yO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._blendIndex=B$C,this._blendWeight=B$i}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(88,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15),new B$iO(56,"vector4",7),new B$iO(72,"vector4",6)])}]),B$O}(),B$vO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._tangent=B$C,this._blendIndex=B$i,this._blendWeight=B$k}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(104,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15),new B$iO(56,"vector4",7),new B$iO(72,"vector4",6),new B$iO(88,"vector4",5)])}]),B$O}(),B$AO=function(){function B$O(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$J.VertexPositionNormalColorTexture0SkinTangent=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._tangent=B$C,this._blendIndex=B$i,this._blendWeight=B$k},B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(100,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15),new B$iO(56,"vector4",7),new B$iO(72,"vector4",6),new B$iO(88,"vector3",5)])}]),B$O}(),B$qO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._tangent=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(72,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15),new B$iO(56,"vector4",5)])}]),B$O}(),B$dO=function(){function B$O(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$J.VertexPositionNormalColorTexture0Tangent=function(B$O,B$J,B$D,B$p,B$m,B$C){this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._tangent=B$C},B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(68,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector2",15),new B$iO(56,"vector3",5)])}]),B$O}(),B$MO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(80,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector4",7),new B$iO(64,"vector4",6)])}]),B$O}(),B$aO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p,this._tangent=B$m,this._blendIndex=B$C,this._blendWeight=B$i}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(96,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector4",7),new B$iO(64,"vector4",6),new B$iO(80,"vector4",5)])}]),B$O}(),B$eO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p,this._tangent=B$m,this._blendIndex=B$C,this._blendWeight=B$i}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(92,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector4",7),new B$iO(64,"vector4",6),new B$iO(80,"vector3",5)])}]),B$O}(),B$tO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p,this._tangent=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(64,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector4",5)])}]),B$O}(),B$zO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._color=B$D,this._textureCoordinate=B$p,this._tangent=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"color",function(){return this._color}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(60,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",1),new B$iO(40,"vector2",2),new B$iO(48,"vector3",5)])}]),B$O}(),B$gO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._tangent=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNormalSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(40,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector4",5)])}]),B$O}(),B$sO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._tangent=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(36,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector3",5)])}]),B$O}(),B$PO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(32,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2)])}]),B$O}(),B$EO=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(40,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15)])}]),B$O}(),B$oO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(72,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6)])}]),B$O}(),B$WO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p,this._tangent=B$m,this._blendIndex=B$C,this._blendWeight=B$i}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(88,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6),new B$iO(72,"vector4",5)])}]),B$O}(),B$NO=function(){function B$O(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$J.VertexPositionNormalTexture0SkinTangent=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p,this._tangent=B$m,this._blendIndex=B$C,this._blendWeight=B$i},B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(84,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15),new B$iO(40,"vector4",7),new B$iO(56,"vector4",6),new B$iO(72,"vector3",5)])}]),B$O}(),B$FO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p,this._tangent=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(56,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15),new B$iO(40,"vector4",5)])}]),B$O}(),B$RO=function(){function B$O(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$J.VertexPositionNormalTexture0Tangent=function(B$O,B$J,B$D,B$p,B$m){this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$D,this._textureCoordinate1=B$p,this._tangent=B$m},B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(52,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15),new B$iO(40,"vector3",5)])}]),B$O}(),B$jO=function(){function B$O(B$O,B$J,B$D,B$p,B$m){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D,this._blendIndex=B$p,this._blendWeight=B$m}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTextureSkin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(64,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector4",7),new B$iO(48,"vector4",6)])}]),B$O}(),B$uO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D,this._tangent=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(80,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector4",7),new B$iO(48,"vector4",6),new B$iO(64,"vector4",5)])}]),B$O}(),B$lO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D,this._tangent=B$p,this._blendIndex=B$m,this._blendWeight=B$C}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(76,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector4",7),new B$iO(48,"vector4",6),new B$iO(64,"vector3",5)])}]),B$O}(),B$$O=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D,this._tangent=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(48,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector4",5)])}]),B$O}(),B$xO=function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D,this._tangent=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionNormalTextureTangent");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(44,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector3",5)])}]),B$O}(),B$VO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNTBTexture");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(56,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector3",5),new B$iO(36,"vector3",4),new B$iO(48,"vector2",2)])}]),B$O}(),B$TO=function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=B$O,this._normal=B$J,this._textureCoordinate0=B$p,this._textureCoordinate1=B$m,this._tangent=B$C,B$D=B$D,this._blendIndex=B$i,this._blendWeight=B$k}B$G(B$O,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"tangent",function(){return this._tangent}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(0,B$J,"textureCoordinate1",function(){return this._textureCoordinate1}),B$X(0,B$J,"blendIndex",function(){return this._blendIndex}),B$X(0,B$J,"blendWeight",function(){return this._blendWeight}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(96,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector3",5),new B$iO(36,"vector3",4),new B$iO(48,"vector2",2),new B$iO(56,"vector2",15),new B$iO(64,"vector4",7),new B$iO(80,"vector4",6)])}]),B$O}(),B$IO=function(){function B$O(B$O,B$J,B$D){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=B$O,this._normal=B$J,this._textureCoordinate=B$D}B$G(B$O,"laya.d3.graphics.VertexPositionNTBTextureSkin");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"textureCoordinate",function(){return this._textureCoordinate}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(88,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector3",5),new B$iO(36,"vector3",4),new B$iO(48,"vector2",2),new B$iO(56,"vector4",7),new B$iO(72,"vector4",6)])}]),B$O}(),B$wO=(function(){function B$O(B$O,B$J,B$D,B$p){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=B$O,this._normal=B$J,this._textureCoord0=B$D,this._textureCoord1=B$p}B$G(B$O,"laya.d3.graphics.VertexPositionTerrain");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"normal",function(){return this._normal}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoord0",function(){return this._textureCoord0}),B$X(0,B$J,"textureCoord1",function(){return this._textureCoord1}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(40,[new B$iO(0,"vector3",0),new B$iO(12,"vector3",3),new B$iO(24,"vector2",2),new B$iO(32,"vector2",15)])}])}(),function(){function B$O(B$O,B$J){this._position=null,this._textureCoordinate0=null,this._position=B$O,this._textureCoordinate0=B$J}B$G(B$O,"laya.d3.graphics.VertexPositionTexture0");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"position",function(){return this._position}),B$X(0,B$J,"textureCoordinate0",function(){return this._textureCoordinate0}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(20,[new B$iO(0,"vector3",0),new B$iO(12,"vector2",2)])}]),B$O}()),B$UO=(function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y,B$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=B$O,this._positionStartLifeTime=B$J,this._velocity=B$D,this._startColor=B$p,this._startSize=B$m,this._startRotation0=B$C,this._startRotation1=B$i,this._startRotation2=B$k,this._startLifeTime=B$_,this._time=B$L,this._startSpeed=B$r,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=B$G}B$G(B$O,"laya.d3.graphics.VertexShurikenParticleBillboard");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),B$X(0,B$J,"random1",function(){return this._randoms1}),B$X(0,B$J,"startRotation2",function(){return this._startRotation2}),B$X(0,B$J,"positionStartLifeTime",function(){return this._positionStartLifeTime}),B$X(0,B$J,"velocity",function(){return this._velocity}),B$X(0,B$J,"random0",function(){return this._randoms0}),B$X(0,B$J,"startSize",function(){return this._startSize}),B$X(0,B$J,"startColor",function(){return this._startColor}),B$X(0,B$J,"startRotation0",function(){return this._startRotation0}),B$X(0,B$J,"startRotation1",function(){return this._startRotation1}),B$X(0,B$J,"startLifeTime",function(){return this._startLifeTime}),B$X(0,B$J,"time",function(){return this._time}),B$X(0,B$J,"startSpeed",function(){return this._startSpeed}),B$X(0,B$J,"simulationWorldPostion",function(){return this._simulationWorldPostion}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(152,[new B$iO(0,"vector4",17),new B$iO(16,"vector4",30),new B$iO(32,"vector4",32),new B$iO(48,"vector4",19),new B$iO(64,"vector3",20),new B$iO(76,"vector3",22),new B$iO(88,"single",31),new B$iO(92,"vector4",34),new B$iO(108,"vector4",35),new B$iO(124,"vector3",36),new B$iO(136,"vector4",37)])}])}(),function(){function B$O(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y,B$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=B$O,this._positionStartLifeTime=B$J,this._velocity=B$D,this._startColor=B$p,this._startSize=B$m,this._startRotation0=B$C,this._startRotation1=B$i,this._startRotation2=B$k,this._startLifeTime=B$_,this._time=B$L,this._startSpeed=B$r,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=B$G}B$G(B$O,"laya.d3.graphics.VertexShurikenParticleMesh");var B$J=B$O.prototype;B$d.imps(B$J,{"laya.d3.graphics.IVertex":!0}),B$X(0,B$J,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),B$X(0,B$J,"velocity",function(){return this._velocity}),B$X(0,B$J,"position",function(){return this._positionStartLifeTime}),B$X(0,B$J,"random0",function(){return this._randoms0}),B$X(0,B$J,"startSize",function(){return this._startSize}),B$X(0,B$J,"startColor",function(){return this._startColor}),B$X(0,B$J,"startRotation0",function(){return this._startRotation0}),B$X(0,B$J,"startRotation1",function(){return this._startRotation1}),B$X(0,B$J,"random1",function(){return this._randoms1}),B$X(0,B$J,"startRotation2",function(){return this._startRotation2}),B$X(0,B$J,"startLifeTime",function(){return this._startLifeTime}),B$X(0,B$J,"time",function(){return this._time}),B$X(0,B$J,"startSpeed",function(){return this._startSpeed}),B$X(0,B$J,"simulationWorldPostion",function(){return this._simulationWorldPostion}),B$X(0,B$J,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$X(1,B$O,"vertexDeclaration",function(){return B$O._vertexDeclaration}),B$H(B$O,["_vertexDeclaration",function(){return this._vertexDeclaration=new B$CO(172,[new B$iO(0,"vector3",0),new B$iO(12,"vector4",1),new B$iO(28,"vector2",2),new B$iO(36,"vector4",30),new B$iO(52,"vector4",32),new B$iO(68,"vector4",19),new B$iO(84,"vector3",20),new B$iO(96,"vector3",22),new B$iO(108,"single",31),new B$iO(112,"vector4",34),new B$iO(128,"vector4",35),new B$iO(144,"vector3",36),new B$iO(156,"vector4",37)])}])}(),function(){function B$A(B$O,B$J,B$D,B$p,B$m,B$C){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=B$D,this._materials=B$p,this._subMeshes=B$m,this._materialMap=B$C,this._version=B$J,this._onLoaded(B$O)}B$G(B$A,"laya.d3.loaders.LoadModelV01");var B$O=B$A.prototype;return B$O._onLoaded=function(B$O){this._readData=B$O,this.READ_BLOCK();for(var B$J=0;B$J<this._BLOCK.count;B$J++){var B$D=this._readData.getUint16(),B$p=this._strings[B$D],B$m=this["READ_"+B$p];if(null==B$m)throw new Error("model file err,no this function:"+B$D+" "+B$p);if(!B$m.call(this))break}return this._mesh},B$O.onError=function(){},B$O._readString=function(){return this._strings[this._readData.getUint16()]},B$O.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},B$O.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},B$O.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var B$O=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var B$J=0;B$J<this._STRINGS.size;B$J++)this._strings[B$J]=this._readData.readUTFString();return this._readData.pos=B$O,!0},B$O.READ_MATERIAL=function(){var B$O=this._readData.getUint16(),B$J=(this._readString(),this._readString());return this._materials[B$O]="null"!==B$J?B$y.getRes(this._materialMap[B$J]):new B$sJ,!0},B$O.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var B$O,B$J=this._readData.__getBuffer(),B$D=0,B$p=this._readData.getUint32(),B$m=this._readData.getUint32(),B$C=(new Float32Array(B$J.slice(B$p+this._DATA.offset,B$p+this._DATA.offset+B$m)),this._readData.getUint32()),B$i=this._readData.getUint32(),B$k=new Float32Array(B$J.slice(B$C+this._DATA.offset,B$C+this._DATA.offset+B$i));for(this.mesh._inverseBindPoses=[],B$D=0,B$O=B$k.length;B$D<B$O;B$D+=16){var B$_=new B$OJ(B$k[B$D+0],B$k[B$D+1],B$k[B$D+2],B$k[B$D+3],B$k[B$D+4],B$k[B$D+5],B$k[B$D+6],B$k[B$D+7],B$k[B$D+8],B$k[B$D+9],B$k[B$D+10],B$k[B$D+11],B$k[B$D+12],B$k[B$D+13],B$k[B$D+14],B$k[B$D+15]);this.mesh._inverseBindPoses.push(B$_)}break;default:throw new Error("LoadModel:unknown version.")}return!0},B$O.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var B$O=this._readString();this._shaderAttributes=B$O.match(B$A._attrReg);var B$J=this._readData.getUint32(),B$D=this._readData.getUint32(),B$p=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),B$m=this._readData.getUint32(),B$C=this._readData.getUint32(),B$i=this._readData.getUint32(),B$k=this._readData.__getBuffer(),B$_=new B$LJ(this._mesh),B$L=this._getVertexDeclaration(),B$r=B$lJ.create(B$L,B$m/B$L.vertexStride,35044,!0),B$H=B$p+this._DATA.offset,B$Y=B$k.slice(B$H,B$H+B$m);B$r.setData(new Float32Array(B$Y));for(var B$G=(B$_._vertexBuffer=B$r).vertexDeclaration.getVertexElements(),B$X=0;B$X<B$G.length;B$X++)B$_._bufferUsage[B$G[B$X].elementUsage]=B$r;var B$c=B$uJ.create("ushort",B$D/2,35044,!0),B$h=B$J+this._DATA.offset,B$y=B$k.slice(B$h,B$h+B$D);B$c.setData(new Uint16Array(B$y)),B$_._indexBuffer=B$c;var B$v=B$k.slice(B$C+this._DATA.offset,B$C+this._DATA.offset+B$i);return B$_._boneIndicesList[0]=new Uint8Array(B$v),this._subMeshes.push(B$_),!0},B$O.READ_DATAAREA=function(){return!1},B$O._getVertexDeclaration=function(){for(var B$O,B$J=!1,B$D=!1,B$p=!1,B$m=!1,B$C=!1,B$i=!1,B$k=!1,B$_=!1,B$L=!1,B$r=0;B$r<this._shaderAttributes.length;B$r+=8)switch(this._shaderAttributes[B$r]){case"POSITION":B$J=!0;break;case"NORMAL":B$D=!0;break;case"COLOR":B$p=!0;break;case"UV":B$m=!0;break;case"UV1":B$C=!0;break;case"BLENDWEIGHT":B$k=!0;break;case"BLENDINDICES":B$_=!0;break;case"TANGENT":B$i=!0;break;case"BINORMAL":B$L=!0}return B$J&&B$D&&B$p&&B$m&&B$C&&B$k&&B$_&&B$i?B$O=B$AO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$C&&B$k&&B$_?B$O=B$yO.vertexDeclaration:B$J&&B$D&&B$m&&B$C&&B$k&&B$_&&B$i?B$O=B$NO.vertexDeclaration:B$J&&B$D&&B$m&&B$C&&B$k&&B$_?B$O=B$oO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$k&&B$_&&B$i?B$O=B$eO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$k&&B$_?B$O=B$MO.vertexDeclaration:B$J&&B$D&&B$i&&B$L&&B$m&&B$k&&B$_?B$O=B$IO.vertexDeclaration:B$J&&B$D&&B$m&&B$k&&B$_&&B$i?B$O=B$lO.vertexDeclaration:B$J&&B$D&&B$m&&B$k&&B$_?B$O=B$jO.vertexDeclaration:B$J&&B$D&&B$p&&B$k&&B$_&&B$i?B$O=B$YO.vertexDeclaration:B$J&&B$D&&B$p&&B$k&&B$_?B$O=B$rO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$C&&B$i?B$O=B$dO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$C?B$O=B$hO.vertexDeclaration:B$J&&B$D&&B$m&&B$C&&B$i?B$O=B$RO.vertexDeclaration:B$J&&B$D&&B$m&&B$C?B$O=B$EO.vertexDeclaration:B$J&&B$D&&B$p&&B$m&&B$i?B$O=B$zO.vertexDeclaration:B$J&&B$D&&B$m&&B$i&&B$L?B$O=B$VO.vertexDeclaration:B$J&&B$D&&B$p&&B$m?B$O=B$cO.vertexDeclaration:B$J&&B$D&&B$m&&B$i?B$O=B$xO.vertexDeclaration:B$J&&B$D&&B$m?B$O=B$PO.vertexDeclaration:B$J&&B$D&&B$p&&B$i?B$O=B$XO.vertexDeclaration:B$J&&B$D&&B$p&&(B$O=B$LO.vertexDeclaration),B$O},B$X(0,B$O,"mesh",function(){return this._mesh}),B$A._attrReg=new RegExp("(\\w+)|([:,;])","g"),B$A}()),B$ZO=function(){function B$a(){}return B$G(B$a,"laya.d3.loaders.LoadModelV02"),B$a.parse=function(B$O,B$J,B$D,B$p,B$m,B$C){B$a._mesh=B$D,B$a._materials=B$p,B$a._subMeshes=B$m,B$a._materialMap=B$C,B$a._version=B$J,B$a._readData=B$O,B$a.READ_DATA(),B$a.READ_BLOCK(),B$a.READ_STRINGS();for(var B$i=0,B$k=B$a._BLOCK.count;B$i<B$k;B$i++){B$a._readData.pos=B$a._BLOCK.blockStarts[B$i];var B$_=B$a._readData.getUint16(),B$L=B$a._strings[B$_],B$r=B$a["READ_"+B$L];if(null==B$r)throw new Error("model file err,no this function:"+B$_+" "+B$L);B$r.call()}B$a._strings.length=0,B$a._readData=null,B$a._version=null,B$a._mesh=null,B$a._materials=null,B$a._subMeshes=null,B$a._materialMap=null},B$a._readString=function(){return B$a._strings[B$a._readData.getUint16()]},B$a.READ_DATA=function(){B$a._DATA.offset=B$a._readData.getUint32(),B$a._DATA.size=B$a._readData.getUint32()},B$a.READ_BLOCK=function(){for(var B$O=B$a._BLOCK.count=B$a._readData.getUint16(),B$J=B$a._BLOCK.blockStarts=[],B$D=B$a._BLOCK.blockLengths=[],B$p=0;B$p<B$O;B$p++)B$J.push(B$a._readData.getUint32()),B$D.push(B$a._readData.getUint32())},B$a.READ_STRINGS=function(){var B$O=B$a._readData.getUint32(),B$J=B$a._readData.getUint16(),B$D=B$a._readData.pos;B$a._readData.pos=B$O+B$a._DATA.offset;for(var B$p=0;B$p<B$J;B$p++)B$a._strings[B$p]=B$a._readData.readUTFString();B$a._readData.pos=B$D},B$a.READ_MATERIAL=function(){B$a._readString(),B$a._readString();var B$O=B$a._readString();return""!==B$O&&B$a._materials.push(B$y.getRes(B$a._materialMap[B$O])),!0},B$a.READ_MESH=function(){B$a._readString();var B$O,B$J=B$a._readData.__getBuffer(),B$D=0,B$p=B$a._readData.getInt16(),B$m=B$a._DATA.offset;for(B$D=0;B$D<B$p;B$D++){var B$C=B$m+B$a._readData.getUint32(),B$i=B$a._readData.getUint32(),B$k=new Float32Array(B$J.slice(B$C,B$C+B$i)),B$_=B$a._readString().match(B$a._attrReg),B$L=B$a._getVertexDeclaration(B$_),B$r=B$lJ.create(B$L,4*B$k.length/B$L.vertexStride,35044,!0);B$r.setData(B$k),B$a._mesh._vertexBuffers.push(B$r)}var B$H=B$m+B$a._readData.getUint32(),B$Y=B$a._readData.getUint32(),B$G=new Uint16Array(B$J.slice(B$H,B$H+B$Y)),B$X=B$uJ.create("ushort",B$Y/2,35044,!0);B$X.setData(B$G),B$a._mesh._indexBuffer=B$X;var B$c=B$a._mesh._boneNames=[],B$h=B$a._readData.getUint16();for(B$c.length=B$h,B$D=0;B$D<B$h;B$D++)B$c[B$D]=B$a._strings[B$a._readData.getUint16()];var B$y=B$a._readData.getUint32(),B$v=B$a._readData.getUint32(),B$A=(new Float32Array(B$J.slice(B$m+B$y,B$m+B$y+B$v)),B$a._readData.getUint32()),B$q=B$a._readData.getUint32(),B$d=new Float32Array(B$J.slice(B$m+B$A,B$m+B$A+B$q));for(B$a._mesh._inverseBindPoses=[],B$D=0,B$O=B$d.length;B$D<B$O;B$D+=16){var B$M=new B$OJ(B$d[B$D+0],B$d[B$D+1],B$d[B$D+2],B$d[B$D+3],B$d[B$D+4],B$d[B$D+5],B$d[B$D+6],B$d[B$D+7],B$d[B$D+8],B$d[B$D+9],B$d[B$D+10],B$d[B$D+11],B$d[B$D+12],B$d[B$D+13],B$d[B$D+14],B$d[B$D+15]);B$a._mesh._inverseBindPoses.push(B$M)}return B$a._mesh._skinnedDatas=new Float32Array(16*B$d.length),!0},B$a.READ_SUBMESH=function(){var B$O=B$a._readData.__getBuffer(),B$J=new B$LJ(B$a._mesh),B$D=B$a._readData.getInt16(),B$p=B$a._readData.getUint32(),B$m=B$a._readData.getUint32();B$J._vertexBuffer=B$a._mesh._vertexBuffers[B$D],B$J._vertexStart=B$p,B$J._vertexCount=B$m;var B$C=B$a._readData.getUint32(),B$i=B$a._readData.getUint32(),B$k=B$a._mesh._indexBuffer;B$J._indexBuffer=B$k,B$J._indexStart=B$C,B$J._indexCount=B$i,B$J._indices=new Uint16Array(B$k.getData().buffer,2*B$C,B$i);var B$_=B$a._DATA.offset,B$L=B$J._subIndexBufferStart,B$r=B$J._subIndexBufferCount,B$H=B$J._boneIndicesList,B$Y=B$a._readData.getUint16();B$L.length=B$Y,B$r.length=B$Y,B$H.length=B$Y;for(var B$G=0;B$G<B$Y;B$G++){B$L[B$G]=B$a._readData.getUint32(),B$r[B$G]=B$a._readData.getUint32();var B$X=B$a._readData.getUint32(),B$c=B$a._readData.getUint32();B$J._boneIndicesList[B$G]=new Uint8Array(B$O.slice(B$_+B$X,B$_+B$X+B$c))}return B$a._subMeshes.push(B$J),!0},B$a._getVertexDeclaration=function(B$O){for(var B$J,B$D=!1,B$p=!1,B$m=!1,B$C=!1,B$i=!1,B$k=!1,B$_=!1,B$L=!1,B$r=!1,B$H=0;B$H<B$O.length;B$H++)switch(B$O[B$H]){case"POSITION":B$D=!0;break;case"NORMAL":B$p=!0;break;case"COLOR":B$m=!0;break;case"UV":B$C=!0;break;case"UV1":B$i=!0;break;case"BLENDWEIGHT":B$_=!0;break;case"BLENDINDICES":B$L=!0;break;case"TANGENT":B$k=!0;break;case"BINORMAL":B$r=!0}return B$D&&B$p&&B$m&&B$C&&B$i&&B$_&&B$L&&B$k?B$J=B$AO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$i&&B$_&&B$L?B$J=B$yO.vertexDeclaration:B$D&&B$p&&B$C&&B$i&&B$_&&B$L&&B$k?B$J=B$NO.vertexDeclaration:B$D&&B$p&&B$C&&B$i&&B$_&&B$L?B$J=B$oO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$_&&B$L&&B$k?B$J=B$eO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$_&&B$L?B$J=B$MO.vertexDeclaration:B$D&&B$p&&B$C&&B$_&&B$L&&B$k?B$J=B$lO.vertexDeclaration:B$D&&B$p&&B$C&&B$_&&B$L?B$J=B$jO.vertexDeclaration:B$D&&B$p&&B$m&&B$_&&B$L&&B$k?B$J=B$YO.vertexDeclaration:B$D&&B$p&&B$m&&B$_&&B$L?B$J=B$rO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$i&&B$k?B$J=B$dO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$i?B$J=B$hO.vertexDeclaration:B$D&&B$p&&B$C&&B$i&&B$k?B$J=B$RO.vertexDeclaration:B$D&&B$p&&B$C&&B$i?B$J=B$EO.vertexDeclaration:B$D&&B$p&&B$m&&B$C&&B$k?B$J=B$zO.vertexDeclaration:B$D&&B$p&&B$C&&B$k&&B$r?B$J=B$VO.vertexDeclaration:B$D&&B$p&&B$m&&B$C?B$J=B$cO.vertexDeclaration:B$D&&B$p&&B$C&&B$k?B$J=B$xO.vertexDeclaration:B$D&&B$p&&B$C?B$J=B$PO.vertexDeclaration:B$D&&B$p&&B$m&&B$k?B$J=B$XO.vertexDeclaration:B$D&&B$p&&B$m&&(B$J=B$LO.vertexDeclaration),B$J},B$a._attrReg=new RegExp("(\\w+)|([:,;])","g"),B$a._strings=[],B$a._readData=null,B$a._version=null,B$a._mesh=null,B$a._materials=null,B$a._subMeshes=null,B$a._materialMap=null,B$H(B$a,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),B$a}(),B$nO=function(){function B$M(){}return B$G(B$M,"laya.d3.loaders.LoadModelV03"),B$M.parse=function(B$O,B$J,B$D,B$p,B$m){B$M._mesh=B$D,B$M._subMeshes=B$p,B$M._materialMap=B$m,B$M._version=B$J,B$M._readData=B$O,B$M.READ_DATA(),B$M.READ_BLOCK(),B$M.READ_STRINGS();for(var B$C=0,B$i=B$M._BLOCK.count;B$C<B$i;B$C++){B$M._readData.pos=B$M._BLOCK.blockStarts[B$C];var B$k=B$M._readData.getUint16(),B$_=B$M._strings[B$k],B$L=B$M["READ_"+B$_];if(null==B$L)throw new Error("model file err,no this function:"+B$k+" "+B$_);B$L.call()}B$M._strings.length=0,B$M._readData=null,B$M._version=null,B$M._mesh=null,B$M._subMeshes=null,B$M._materialMap=null},B$M._readString=function(){return B$M._strings[B$M._readData.getUint16()]},B$M.READ_DATA=function(){B$M._DATA.offset=B$M._readData.getUint32(),B$M._DATA.size=B$M._readData.getUint32()},B$M.READ_BLOCK=function(){for(var B$O=B$M._BLOCK.count=B$M._readData.getUint16(),B$J=B$M._BLOCK.blockStarts=[],B$D=B$M._BLOCK.blockLengths=[],B$p=0;B$p<B$O;B$p++)B$J.push(B$M._readData.getUint32()),B$D.push(B$M._readData.getUint32())},B$M.READ_STRINGS=function(){var B$O=B$M._readData.getUint32(),B$J=B$M._readData.getUint16(),B$D=B$M._readData.pos;B$M._readData.pos=B$O+B$M._DATA.offset;for(var B$p=0;B$p<B$J;B$p++)B$M._strings[B$p]=B$M._readData.readUTFString();B$M._readData.pos=B$D},B$M.READ_MESH=function(){var B$O,B$J=B$M._readString(),B$D=B$M._readData.__getBuffer(),B$p=0,B$m=B$M._readData.getInt16(),B$C=B$M._DATA.offset;for(B$p=0;B$p<B$m;B$p++){var B$i,B$k=B$C+B$M._readData.getUint32(),B$_=B$M._readData.getUint32(),B$L=new Float32Array(B$D.slice(B$k,B$k+B$_)),B$r=B$M._readString();switch(B$M._version){case"LAYAMODEL:03":B$i=B$M._vertexDeclarationMap_Discard[B$r];break;case"LAYAMODEL:0301":B$i=B$M._vertexDeclarationMap[B$r];break;default:throw new Error("LoadModelV03: unknown version.")}if(!B$i)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+B$M._version+"  bufferAttribute="+B$r+"  name="+B$J+"  url="+(B$M._mesh?B$M._mesh.url:"null"));var B$H=B$lJ.create(B$i,4*B$L.length/B$i.vertexStride,35044,!0,B$M._mesh._url+"_"+B$p);B$H.setData(B$L),B$M._mesh._vertexBuffers.push(B$H)}var B$Y=B$C+B$M._readData.getUint32(),B$G=B$M._readData.getUint32(),B$X=new Uint16Array(B$D.slice(B$Y,B$Y+B$G)),B$c=B$uJ.create("ushort",B$G/2,35044,!0,B$M._mesh._url);B$c.setData(B$X),B$M._mesh._indexBuffer=B$c;var B$h=B$M._mesh._boneNames=[],B$y=B$M._readData.getUint16();for(B$h.length=B$y,B$p=0;B$p<B$y;B$p++)B$h[B$p]=B$M._strings[B$M._readData.getUint16()];B$M._readData.pos+=8;var B$v=B$M._readData.getUint32(),B$A=B$M._readData.getUint32(),B$q=new Float32Array(B$D.slice(B$C+B$v,B$C+B$v+B$A));for(B$M._mesh._inverseBindPoses=[],B$p=0,B$O=B$q.length;B$p<B$O;B$p+=16){var B$d=new B$OJ(B$q[B$p+0],B$q[B$p+1],B$q[B$p+2],B$q[B$p+3],B$q[B$p+4],B$q[B$p+5],B$q[B$p+6],B$q[B$p+7],B$q[B$p+8],B$q[B$p+9],B$q[B$p+10],B$q[B$p+11],B$q[B$p+12],B$q[B$p+13],B$q[B$p+14],B$q[B$p+15]);B$M._mesh._inverseBindPoses.push(B$d)}return B$M._mesh._skinnedDatas=new Float32Array(16*B$q.length),!0},B$M.READ_SUBMESH=function(){var B$O=B$M._readData.__getBuffer(),B$J=new B$LJ(B$M._mesh),B$D=B$M._readData.getInt16(),B$p=B$M._readData.getUint32(),B$m=B$M._readData.getUint32();B$J._vertexBuffer=B$M._mesh._vertexBuffers[B$D],B$J._vertexStart=B$p,B$J._vertexCount=B$m;var B$C=B$M._readData.getUint32(),B$i=B$M._readData.getUint32(),B$k=B$M._mesh._indexBuffer;B$J._indexBuffer=B$k,B$J._indexStart=B$C,B$J._indexCount=B$i,B$J._indices=new Uint16Array(B$k.getData().buffer,2*B$C,B$i);var B$_=B$M._DATA.offset,B$L=B$J._subIndexBufferStart,B$r=B$J._subIndexBufferCount,B$H=B$J._boneIndicesList,B$Y=B$M._readData.getUint16();B$L.length=B$Y,B$r.length=B$Y,B$H.length=B$Y;for(var B$G=0;B$G<B$Y;B$G++){B$L[B$G]=B$M._readData.getUint32(),B$r[B$G]=B$M._readData.getUint32();var B$X=B$M._readData.getUint32(),B$c=B$M._readData.getUint32();B$H[B$G]=new Uint8Array(B$O.slice(B$_+B$X,B$_+B$X+B$c))}return B$M._subMeshes.push(B$J),!0},B$M._strings=[],B$M._readData=null,B$M._version=null,B$M._mesh=null,B$M._subMeshes=null,B$M._materialMap=null,B$H(B$M,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":B$AO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":B$yO.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":B$TO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":B$NO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":B$oO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":B$eO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":B$MO.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":B$lO.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":B$jO.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":B$YO.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":B$rO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":B$dO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":B$hO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":B$RO.vertexDeclaration,"POSITION,NORMAL,UV,UV1":B$EO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":B$zO.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":B$VO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":B$cO.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":B$xO.vertexDeclaration,"POSITION,NORMAL,UV":B$PO.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":B$XO.vertexDeclaration,"POSITION,NORMAL,COLOR":B$LO.vertexDeclaration,"POSITION,NORMAL,TANGENT":B$sO.vertexDeclaration,"POSITION,NORMAL":B$_O.vertexDeclaration,"POSITION,UV":B$wO.vertexDeclaration,POSITION:B$kO.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":B$vO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":B$yO.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":B$TO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":B$WO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":B$oO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":B$aO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":B$MO.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":B$uO.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":B$jO.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":B$HO.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":B$rO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":B$qO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":B$hO.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":B$FO.vertexDeclaration,"POSITION,NORMAL,UV,UV1":B$EO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":B$tO.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":B$VO.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":B$cO.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":B$$O.vertexDeclaration,"POSITION,NORMAL,UV":B$PO.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":B$GO.vertexDeclaration,"POSITION,NORMAL,COLOR":B$LO.vertexDeclaration,"POSITION,NORMAL,TANGENT":B$gO.vertexDeclaration,"POSITION,NORMAL":B$_O.vertexDeclaration,"POSITION,UV":B$wO.vertexDeclaration,POSITION:B$kO.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),B$M}(),B$BO=function(){function B$k(){}return B$G(B$k,"laya.d3.loaders.MeshReader"),B$k.read=function(B$O,B$J,B$D,B$p,B$m){var B$C=new B$M(B$O);B$C.pos=0;var B$i=B$C.readUTFString();switch(B$i){case"LAYAMODEL:01":case"LAYASKINANI:01":B$k._readVersion01(B$C,B$i,B$J,B$D,B$p,B$m);break;case"LAYAMODEL:02":B$ZO.parse(B$C,B$i,B$J,B$D,B$p,B$m);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":B$nO.parse(B$C,B$i,B$J,B$p,B$m);break;default:throw new Error("MeshReader: unknown mesh version.")}B$J._setSubMeshes(B$p)},B$k._readVersion01=function(B$O,B$J,B$D,B$p,B$m,B$C){new B$UO(B$O,B$J,B$D,B$p,B$m,B$C)},B$k}(),B$SO=function(){function B$O(B$O,B$J){this.min=null,this.max=null,this.min=B$O,this.max=B$J}B$G(B$O,"laya.d3.math.BoundBox");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.getCorners=function(B$O){B$O.length=8;var B$J=this.min.elements,B$D=this.max.elements,B$p=B$J[0],B$m=B$J[1],B$C=B$J[2],B$i=B$D[0],B$k=B$D[1],B$_=B$D[2];B$O[0]=new B$iJ(B$p,B$k,B$_),B$O[1]=new B$iJ(B$i,B$k,B$_),B$O[2]=new B$iJ(B$i,B$m,B$_),B$O[3]=new B$iJ(B$p,B$m,B$_),B$O[4]=new B$iJ(B$p,B$k,B$C),B$O[5]=new B$iJ(B$i,B$k,B$C),B$O[6]=new B$iJ(B$i,B$m,B$C),B$O[7]=new B$iJ(B$p,B$m,B$C)},B$J.toDefault=function(){this.min.toDefault(),this.max.toDefault()},B$J.cloneTo=function(B$O){var B$J=B$O;this.min.cloneTo(B$J.min),this.max.cloneTo(B$J.max)},B$J.clone=function(){var B$O=new this.constructor(new B$iJ,new B$iJ);return this.cloneTo(B$O),B$O},B$O.createfromPoints=function(B$O,B$J){if(null==B$O)throw new Error("points");var B$D=B$J.min,B$p=B$J.max,B$m=B$D.elements;B$m[0]=Number.MAX_VALUE,B$m[1]=Number.MAX_VALUE,B$m[2]=Number.MAX_VALUE;var B$C=B$p.elements;B$C[0]=-Number.MAX_VALUE,B$C[1]=-Number.MAX_VALUE,B$C[2]=-Number.MAX_VALUE;for(var B$i=0,B$k=B$O.length;B$i<B$k;++B$i)B$iJ.min(B$D,B$O[B$i],B$D),B$iJ.max(B$p,B$O[B$i],B$p)},B$O.merge=function(B$O,B$J,B$D){B$iJ.min(B$O.min,B$J.min,B$D.min),B$iJ.max(B$O.max,B$J.max,B$D.max)},B$O}(),B$QO=function(){function B$L(B$O){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=B$O,this._near=new B$JJ(new B$iJ),this._far=new B$JJ(new B$iJ),this._left=new B$JJ(new B$iJ),this._right=new B$JJ(new B$iJ),this._top=new B$JJ(new B$iJ),this._bottom=new B$JJ(new B$iJ),B$L._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}B$G(B$L,"laya.d3.math.BoundFrustum");var B$O=B$L.prototype;return B$O.equalsBoundFrustum=function(B$O){return this._matrix.equalsOtherMatrix(B$O.matrix)},B$O.equalsObj=function(B$O){if(B$O instanceof laya.d3.math.BoundFrustum){var B$J=B$O;return this.equalsBoundFrustum(B$J)}return!1},B$O.getPlane=function(B$O){switch(B$O){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},B$O.getCorners=function(B$O){B$L._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(B$O[0]),B$L._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(B$O[1]),B$L._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(B$O[2]),B$L._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(B$O[3]),B$L._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(B$O[4]),B$L._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(B$O[5]),B$L._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(B$O[6]),B$L._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(B$O[7])},B$O.containsPoint=function(B$O){for(var B$J=B$JJ.PlaneIntersectionType_Front,B$D=B$JJ.PlaneIntersectionType_Front,B$p=0;B$p<6;B$p++){switch(B$p){case 0:B$D=Collision.intersectsPlaneAndPoint(this._near,B$O);break;case 1:B$D=Collision.intersectsPlaneAndPoint(this._far,B$O);break;case 2:B$D=Collision.intersectsPlaneAndPoint(this._left,B$O);break;case 3:B$D=Collision.intersectsPlaneAndPoint(this._right,B$O);break;case 4:B$D=Collision.intersectsPlaneAndPoint(this._top,B$O);break;case 5:B$D=Collision.intersectsPlaneAndPoint(this._bottom,B$O)}switch(B$D){case B$JJ.PlaneIntersectionType_Back:return 0;case B$JJ.PlaneIntersectionType_Intersecting:B$J=B$JJ.PlaneIntersectionType_Intersecting}}switch(B$J){case B$JJ.PlaneIntersectionType_Intersecting:return 2;default:return 1}},B$O.containsBoundBox=function(B$O){for(var B$J,B$D=B$L._tempV30,B$p=B$L._tempV31,B$m=1,B$C=0;B$C<6;B$C++){if(B$J=this.getPlane(B$C),this._getBoxToPlanePVertexNVertex(B$O,B$J.normal,B$D,B$p),Collision.intersectsPlaneAndPoint(B$J,B$D)===B$JJ.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(B$J,B$p)===B$JJ.PlaneIntersectionType_Back&&(B$m=2)}return B$m},B$O.containsBoundSphere=function(B$O){for(var B$J=B$JJ.PlaneIntersectionType_Front,B$D=B$JJ.PlaneIntersectionType_Front,B$p=0;B$p<6;B$p++){switch(B$p){case 0:B$D=Collision.intersectsPlaneAndSphere(this._near,B$O);break;case 1:B$D=Collision.intersectsPlaneAndSphere(this._far,B$O);break;case 2:B$D=Collision.intersectsPlaneAndSphere(this._left,B$O);break;case 3:B$D=Collision.intersectsPlaneAndSphere(this._right,B$O);break;case 4:B$D=Collision.intersectsPlaneAndSphere(this._top,B$O);break;case 5:B$D=Collision.intersectsPlaneAndSphere(this._bottom,B$O)}switch(B$D){case B$JJ.PlaneIntersectionType_Back:return 0;case B$JJ.PlaneIntersectionType_Intersecting:B$J=B$JJ.PlaneIntersectionType_Intersecting}}switch(B$J){case B$JJ.PlaneIntersectionType_Intersecting:return 2;default:return 1}},B$O._getBoxToPlanePVertexNVertex=function(B$O,B$J,B$D,B$p){var B$m=B$O.min,B$C=B$m.elements,B$i=B$O.max,B$k=B$i.elements,B$_=B$J.elements,B$L=B$_[0],B$r=B$_[1],B$H=B$_[2];B$m.cloneTo(B$D);var B$Y=B$D.elements;0<=B$L&&(B$Y[0]=B$k[0]),0<=B$r&&(B$Y[1]=B$k[1]),0<=B$H&&(B$Y[2]=B$k[2]),B$i.cloneTo(B$p);var B$G=B$p.elements;0<=B$L&&(B$G[0]=B$C[0]),0<=B$r&&(B$G[1]=B$C[1]),0<=B$H&&(B$G[2]=B$C[2])},B$X(0,B$O,"top",function(){return this._top}),B$X(0,B$O,"matrix",function(){return this._matrix},function(B$O){this._matrix=B$O,B$L._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),B$X(0,B$O,"near",function(){return this._near}),B$X(0,B$O,"far",function(){return this._far}),B$X(0,B$O,"left",function(){return this._left}),B$X(0,B$O,"right",function(){return this._right}),B$X(0,B$O,"bottom",function(){return this._bottom}),B$L._getPlanesFromMatrix=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k=B$O.elements,B$_=B$k[0],B$L=B$k[1],B$r=B$k[2],B$H=B$k[3],B$Y=B$k[4],B$G=B$k[5],B$X=B$k[6],B$c=B$k[7],B$h=B$k[8],B$y=B$k[9],B$v=B$k[10],B$A=B$k[11],B$q=B$k[12],B$d=B$k[13],B$M=B$k[14],B$a=B$k[15],B$e=B$J.normal.elements;B$e[0]=B$H+B$r,B$e[1]=B$c+B$X,B$e[2]=B$A+B$v,B$J.distance=B$a+B$M,B$J.normalize();var B$t=B$D.normal.elements;B$t[0]=B$H-B$r,B$t[1]=B$c-B$X,B$t[2]=B$A-B$v,B$D.distance=B$a-B$M,B$D.normalize();var B$z=B$p.normal.elements;B$z[0]=B$H+B$_,B$z[1]=B$c+B$Y,B$z[2]=B$A+B$h,B$p.distance=B$a+B$q,B$p.normalize();var B$g=B$m.normal.elements;B$g[0]=B$H-B$_,B$g[1]=B$c-B$Y,B$g[2]=B$A-B$h,B$m.distance=B$a-B$q,B$m.normalize();var B$s=B$C.normal.elements;B$s[0]=B$H-B$L,B$s[1]=B$c-B$G,B$s[2]=B$A-B$y,B$C.distance=B$a-B$d,B$C.normalize();var B$P=B$i.normal.elements;B$P[0]=B$H+B$L,B$P[1]=B$c+B$G,B$P[2]=B$A+B$y,B$i.distance=B$a+B$d,B$i.normalize()},B$L._get3PlaneInterPoint=function(B$O,B$J,B$D){var B$p=B$O.normal,B$m=B$J.normal,B$C=B$D.normal;B$iJ.cross(B$m,B$C,B$L._tempV30),B$iJ.cross(B$C,B$p,B$L._tempV31),B$iJ.cross(B$p,B$m,B$L._tempV32);var B$i=B$iJ.dot(B$p,B$L._tempV30),B$k=B$iJ.dot(B$m,B$L._tempV31),B$_=B$iJ.dot(B$C,B$L._tempV32);return B$iJ.scale(B$L._tempV30,-B$O.distance/B$i,B$L._tempV33),B$iJ.scale(B$L._tempV31,-B$J.distance/B$k,B$L._tempV34),B$iJ.scale(B$L._tempV32,-B$D.distance/B$_,B$L._tempV35),B$iJ.add(B$L._tempV33,B$L._tempV34,B$L._tempV36),B$iJ.add(B$L._tempV35,B$L._tempV36,B$L._tempV37),B$L._tempV37},B$H(B$L,["_tempV30",function(){return this._tempV30=new B$iJ},"_tempV31",function(){return this._tempV31=new B$iJ},"_tempV32",function(){return this._tempV32=new B$iJ},"_tempV33",function(){return this._tempV33=new B$iJ},"_tempV34",function(){return this._tempV34=new B$iJ},"_tempV35",function(){return this._tempV35=new B$iJ},"_tempV36",function(){return this._tempV36=new B$iJ},"_tempV37",function(){return this._tempV37=new B$iJ}]),B$L}(),B$bO=function(){function B$r(B$O,B$J){this.center=null,this.radius=NaN,this.center=B$O,this.radius=B$J}B$G(B$r,"laya.d3.math.BoundSphere");var B$O=B$r.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.toDefault=function(){this.center.toDefault(),this.radius=0},B$O.intersectsRayDistance=function(B$O){return Collision.intersectsRayAndSphereRD(B$O,this)},B$O.intersectsRayPoint=function(B$O,B$J){return Collision.intersectsRayAndSphereRP(B$O,this,B$J)},B$O.cloneTo=function(B$O){var B$J=B$O;this.center.cloneTo(B$J.center),B$J.radius=this.radius},B$O.clone=function(){var B$O=new this.constructor(new B$iJ,new B$iJ);return this.cloneTo(B$O),B$O},B$r.createFromSubPoints=function(B$O,B$J,B$D,B$p){if(null==B$O)throw new Error("points");if(B$J<0||B$J>=B$O.length)throw new Error("start"+B$J+"Must be in the range [0, "+(B$O.length-1)+"]");if(B$D<0||B$J+B$D>B$O.length)throw new Error("count"+B$D+"Must be in the range <= "+B$O.length+"}");var B$m=B$J+B$D,B$C=B$r._tempVector3;B$C.elements[0]=0,B$C.elements[1]=0,B$C.elements[2]=0;for(var B$i=B$J;B$i<B$m;++B$i)B$iJ.add(B$O[B$i],B$C,B$C);var B$k=B$p.center;B$iJ.scale(B$C,1/B$D,B$k);var B$_=0;for(B$i=B$J;B$i<B$m;++B$i){var B$L=B$iJ.distanceSquared(B$k,B$O[B$i]);B$_<B$L&&(B$_=B$L)}B$p.radius=Math.sqrt(B$_)},B$r.createfromPoints=function(B$O,B$J){if(null==B$O)throw new Error("points");B$r.createFromSubPoints(B$O,0,B$O.length,B$J)},B$H(B$r,["_tempVector3",function(){return this._tempVector3=new B$iJ}]),B$r}(),B$KO=(function(){function B$O(){}B$G(B$O,"laya.d3.math.ContainmentType"),B$O.Disjoint=0,B$O.Contains=1,B$O.Intersects=2}(),function(){function B$D(){}return B$G(B$D,"laya.d3.math.MathUtils3D"),B$D.isZero=function(B$O){return Math.abs(B$O)<B$D.zeroTolerance},B$D.nearEqual=function(B$O,B$J){return!!B$D.isZero(B$O-B$J)},B$D.fastInvSqrt=function(B$O){return B$D.isZero(B$O)?B$O:1/Math.sqrt(B$O)},B$H(B$D,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),B$D}()),B$fO=function(){function B$_(){var B$O=this.elements=new Float32Array(9);B$O[0]=1,B$O[1]=0,B$O[2]=0,B$O[3]=0,B$O[4]=1,B$O[5]=0,B$O[6]=0,B$O[7]=0,B$O[8]=1}B$G(B$_,"laya.d3.math.Matrix3x3");var B$O=B$_.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.determinant=function(){var B$O=this.elements,B$J=B$O[0],B$D=B$O[1],B$p=B$O[2],B$m=B$O[3],B$C=B$O[4],B$i=B$O[5],B$k=B$O[6],B$_=B$O[7],B$L=B$O[8];return B$J*(B$L*B$C-B$i*B$_)+B$D*(-B$L*B$m+B$i*B$k)+B$p*(B$_*B$m-B$C*B$k)},B$O.translate=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements,B$m=B$O.elements,B$C=B$p[0],B$i=B$p[1],B$k=B$p[2],B$_=B$p[3],B$L=B$p[4],B$r=B$p[5],B$H=B$p[6],B$Y=B$p[7],B$G=B$p[8],B$X=B$m[0],B$c=B$m[1];B$D[0]=B$C,B$D[1]=B$i,B$D[2]=B$k,B$D[3]=B$_,B$D[4]=B$L,B$D[5]=B$r,B$D[6]=B$X*B$C+B$c*B$_+B$H,B$D[7]=B$X*B$i+B$c*B$L+B$Y,B$D[8]=B$X*B$k+B$c*B$r+B$G},B$O.rotate=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=B$p[4],B$L=B$p[5],B$r=B$p[6],B$H=B$p[7],B$Y=B$p[8],B$G=Math.sin(B$O),B$X=Math.cos(B$O);B$D[0]=B$X*B$m+B$G*B$k,B$D[1]=B$X*B$C+B$G*B$_,B$D[2]=B$X*B$i+B$G*B$L,B$D[3]=B$X*B$k-B$G*B$m,B$D[4]=B$X*B$_-B$G*B$C,B$D[5]=B$X*B$L-B$G*B$i,B$D[6]=B$r,B$D[7]=B$H,B$D[8]=B$Y},B$O.scale=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements,B$m=B$O.elements,B$C=B$m[0],B$i=B$m[1];B$D[0]=B$C*B$p[0],B$D[1]=B$C*B$p[1],B$D[2]=B$C*B$p[2],B$D[3]=B$i*B$p[3],B$D[4]=B$i*B$p[4],B$D[5]=B$i*B$p[5],B$D[6]=B$p[6],B$D[7]=B$p[7],B$D[8]=B$p[8]},B$O.invert=function(B$O){var B$J=B$O.elements,B$D=this.elements,B$p=B$D[0],B$m=B$D[1],B$C=B$D[2],B$i=B$D[3],B$k=B$D[4],B$_=B$D[5],B$L=B$D[6],B$r=B$D[7],B$H=B$D[8],B$Y=B$H*B$k-B$_*B$r,B$G=-B$H*B$i+B$_*B$L,B$X=B$r*B$i-B$k*B$L,B$c=B$p*B$Y+B$m*B$G+B$C*B$X;B$c||(B$O=null),B$c=1/B$c,B$J[0]=B$Y*B$c,B$J[1]=(-B$H*B$m+B$C*B$r)*B$c,B$J[2]=(B$_*B$m-B$C*B$k)*B$c,B$J[3]=B$G*B$c,B$J[4]=(B$H*B$p-B$C*B$L)*B$c,B$J[5]=(-B$_*B$p+B$C*B$i)*B$c,B$J[6]=B$X*B$c,B$J[7]=(-B$r*B$p+B$m*B$L)*B$c,B$J[8]=(B$k*B$p-B$m*B$i)*B$c},B$O.transpose=function(B$O){var B$J=B$O.elements,B$D=this.elements;if(B$O===this){var B$p=B$D[1],B$m=B$D[2],B$C=B$D[5];B$J[1]=B$D[3],B$J[2]=B$D[6],B$J[3]=B$p,B$J[5]=B$D[7],B$J[6]=B$m,B$J[7]=B$C}else B$J[0]=B$D[0],B$J[1]=B$D[3],B$J[2]=B$D[6],B$J[3]=B$D[1],B$J[4]=B$D[4],B$J[5]=B$D[7],B$J[6]=B$D[2],B$J[7]=B$D[5],B$J[8]=B$D[8]},B$O.identity=function(){var B$O=this.elements;B$O[0]=1,B$O[1]=0,B$O[2]=0,B$O[3]=0,B$O[4]=1,B$O[5]=0,B$O[6]=0,B$O[7]=0,B$O[8]=1},B$O.cloneTo=function(B$O){var B$J,B$D,B$p;if((B$D=this.elements)!==(B$p=B$O.elements))for(B$J=0;B$J<9;++B$J)B$p[B$J]=B$D[B$J]},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$_.createFromTranslation=function(B$O,B$J){B$J.elements;var B$D=B$O.elements;B$J[0]=1,B$J[1]=0,B$J[2]=0,B$J[3]=0,B$J[4]=1,B$J[5]=0,B$J[6]=B$D[0],B$J[7]=B$D[1],B$J[8]=1},B$_.createFromRotation=function(B$O,B$J){var B$D=B$J.elements,B$p=Math.sin(B$O),B$m=Math.cos(B$O);B$D[0]=B$m,B$D[1]=B$p,B$D[2]=0,B$D[3]=-B$p,B$D[4]=B$m,B$D[5]=0,B$D[6]=0,B$D[7]=0,B$D[8]=1},B$_.createFromScaling=function(B$O,B$J){var B$D=B$J.elements,B$p=B$O.elements;B$D[0]=B$p[0],B$D[1]=0,B$D[2]=0,B$D[3]=0,B$D[4]=B$p[1],B$D[5]=0,B$D[6]=0,B$D[7]=0,B$D[8]=1},B$_.createFromMatrix4x4=function(B$O,B$J){B$J[0]=B$O[0],B$J[1]=B$O[1],B$J[2]=B$O[2],B$J[3]=B$O[4],B$J[4]=B$O[5],B$J[5]=B$O[6],B$J[6]=B$O[8],B$J[7]=B$O[9],B$J[8]=B$O[10]},B$_.multiply=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements,B$i=B$m[0],B$k=B$m[1],B$_=B$m[2],B$L=B$m[3],B$r=B$m[4],B$H=B$m[5],B$Y=B$m[6],B$G=B$m[7],B$X=B$m[8],B$c=B$C[0],B$h=B$C[1],B$y=B$C[2],B$v=B$C[3],B$A=B$C[4],B$q=B$C[5],B$d=B$C[6],B$M=B$C[7],B$a=B$C[8];B$p[0]=B$c*B$i+B$h*B$L+B$y*B$Y,B$p[1]=B$c*B$k+B$h*B$r+B$y*B$G,B$p[2]=B$c*B$_+B$h*B$H+B$y*B$X,B$p[3]=B$v*B$i+B$A*B$L+B$q*B$Y,B$p[4]=B$v*B$k+B$A*B$r+B$q*B$G,B$p[5]=B$v*B$_+B$A*B$H+B$q*B$X,B$p[6]=B$d*B$i+B$M*B$L+B$a*B$Y,B$p[7]=B$d*B$k+B$M*B$r+B$a*B$G,B$p[8]=B$d*B$_+B$M*B$H+B$a*B$X},B$_.lookAt=function(B$O,B$J,B$D,B$p){B$iJ.subtract(B$O,B$J,B$_._tempV30),B$iJ.normalize(B$_._tempV30,B$_._tempV30),B$iJ.cross(B$D,B$_._tempV30,B$_._tempV31),B$iJ.normalize(B$_._tempV31,B$_._tempV31),B$iJ.cross(B$_._tempV30,B$_._tempV31,B$_._tempV32);var B$m=B$_._tempV30.elements,B$C=B$_._tempV31.elements,B$i=B$_._tempV32.elements,B$k=B$p.elements;B$k[0]=B$C[0],B$k[3]=B$C[1],B$k[6]=B$C[2],B$k[1]=B$i[0],B$k[4]=B$i[1],B$k[7]=B$i[2],B$k[2]=B$m[0],B$k[5]=B$m[1],B$k[8]=B$m[2]},B$_.DEFAULT=new B$_,B$H(B$_,["_tempV30",function(){return this._tempV30=new B$iJ},"_tempV31",function(){return this._tempV31=new B$iJ},"_tempV32",function(){return this._tempV32=new B$iJ}]),B$_}(),B$OJ=function(){function B$t(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H,B$Y,B$G,B$X,B$c){void 0===B$O&&(B$O=1),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=1),void 0===B$i&&(B$i=0),void 0===B$k&&(B$k=0),void 0===B$_&&(B$_=0),void 0===B$L&&(B$L=0),void 0===B$r&&(B$r=1),void 0===B$H&&(B$H=0),void 0===B$Y&&(B$Y=0),void 0===B$G&&(B$G=0),void 0===B$X&&(B$X=0),void 0===B$c&&(B$c=1);var B$h=this.elements=new Float32Array(16);B$h[0]=B$O,B$h[1]=B$J,B$h[2]=B$D,B$h[3]=B$p,B$h[4]=B$m,B$h[5]=B$C,B$h[6]=B$i,B$h[7]=B$k,B$h[8]=B$_,B$h[9]=B$L,B$h[10]=B$r,B$h[11]=B$H,B$h[12]=B$Y,B$h[13]=B$G,B$h[14]=B$X,B$h[15]=B$c}B$G(B$t,"laya.d3.math.Matrix4x4");var B$O=B$t.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.getElementByRowColumn=function(B$O,B$J){if(B$O<0||3<B$O)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(B$J<0||3<B$J)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*B$O+B$J]},B$O.setElementByRowColumn=function(B$O,B$J,B$D){if(B$O<0||3<B$O)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(B$J<0||3<B$J)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*B$O+B$J]=B$D},B$O.equalsOtherMatrix=function(B$O){var B$J=this.elements,B$D=B$O.elements;return B$KO.nearEqual(B$J[0],B$D[0])&&B$KO.nearEqual(B$J[1],B$D[1])&&B$KO.nearEqual(B$J[2],B$D[2])&&B$KO.nearEqual(B$J[3],B$D[3])&&B$KO.nearEqual(B$J[4],B$D[4])&&B$KO.nearEqual(B$J[5],B$D[5])&&B$KO.nearEqual(B$J[6],B$D[6])&&B$KO.nearEqual(B$J[7],B$D[7])&&B$KO.nearEqual(B$J[8],B$D[8])&&B$KO.nearEqual(B$J[9],B$D[9])&&B$KO.nearEqual(B$J[10],B$D[10])&&B$KO.nearEqual(B$J[11],B$D[11])&&B$KO.nearEqual(B$J[12],B$D[12])&&B$KO.nearEqual(B$J[13],B$D[13])&&B$KO.nearEqual(B$J[14],B$D[14])&&B$KO.nearEqual(B$J[15],B$D[15])},B$O.decomposeTransRotScale=function(B$O,B$J,B$D){var B$p=B$t._tempMatrix4x4;return this.decomposeTransRotMatScale(B$O,B$p,B$D)?(B$DJ.createFromMatrix4x4(B$p,B$J),!0):(B$J.identity(),!1)},B$O.decomposeTransRotMatScale=function(B$O,B$J,B$D){var B$p=this.elements,B$m=B$O.elements,B$C=B$J.elements,B$i=B$D.elements;B$m[0]=B$p[12],B$m[1]=B$p[13],B$m[2]=B$p[14];var B$k=B$p[0],B$_=B$p[1],B$L=B$p[2],B$r=B$p[4],B$H=B$p[5],B$Y=B$p[6],B$G=B$p[8],B$X=B$p[9],B$c=B$p[10],B$h=B$i[0]=Math.sqrt(B$k*B$k+B$_*B$_+B$L*B$L),B$y=B$i[1]=Math.sqrt(B$r*B$r+B$H*B$H+B$Y*B$Y),B$v=B$i[2]=Math.sqrt(B$G*B$G+B$X*B$X+B$c*B$c);if(B$KO.isZero(B$h)||B$KO.isZero(B$y)||B$KO.isZero(B$v))return B$C[1]=B$C[2]=B$C[3]=B$C[4]=B$C[6]=B$C[7]=B$C[8]=B$C[9]=B$C[11]=B$C[12]=B$C[13]=B$C[14]=0,B$C[0]=B$C[5]=B$C[10]=B$C[15]=1,!1;var B$A=B$t._tempVector0,B$q=B$A.elements;B$q[0]=B$G/B$v,B$q[1]=B$X/B$v,B$q[2]=B$c/B$v;var B$d=B$t._tempVector1,B$M=B$d.elements;B$M[0]=B$k/B$h,B$M[1]=B$_/B$h,B$M[2]=B$L/B$h;var B$a=B$t._tempVector2;B$iJ.cross(B$A,B$d,B$a);var B$e=B$t._tempVector1;return B$iJ.cross(B$a,B$A,B$e),B$C[3]=B$C[7]=B$C[11]=B$C[12]=B$C[13]=B$C[14]=0,B$C[15]=1,B$C[0]=B$e.x,B$C[1]=B$e.y,B$C[2]=B$e.z,B$C[4]=B$a.x,B$C[5]=B$a.y,B$C[6]=B$a.z,B$C[8]=B$A.x,B$C[9]=B$A.y,B$C[10]=B$A.z,B$C[0]*B$k+B$C[1]*B$_+B$C[2]*B$L<0&&(B$i[0]=-B$h),B$C[4]*B$r+B$C[5]*B$H+B$C[6]*B$Y<0&&(B$i[1]=-B$y),B$C[8]*B$G+B$C[9]*B$X+B$C[10]*B$c<0&&(B$i[2]=-B$v),!0},B$O.decomposeYawPitchRoll=function(B$O){var B$J=B$O.elements,B$D=Math.asin(-this.elements[9]);B$J[1]=B$D,Math.cos(B$D)>B$KO.zeroTolerance?(B$J[2]=Math.atan2(this.elements[1],this.elements[5]),B$J[0]=Math.atan2(this.elements[8],this.elements[10])):(B$J[2]=Math.atan2(-this.elements[4],this.elements[0]),B$J[0]=0)},B$O.normalize=function(){var B$O=this.elements,B$J=B$O[0],B$D=B$O[1],B$p=B$O[2],B$m=Math.sqrt(B$J*B$J+B$D*B$D+B$p*B$p);if(!B$m)return B$O[0]=0,B$O[1]=0,void(B$O[2]=0);1!=B$m&&(B$m=1/B$m,B$O[0]=B$J*B$m,B$O[1]=B$D*B$m,B$O[2]=B$p*B$m)},B$O.transpose=function(){var B$O,B$J;return B$J=(B$O=this.elements)[1],B$O[1]=B$O[4],B$O[4]=B$J,B$J=B$O[2],B$O[2]=B$O[8],B$O[8]=B$J,B$J=B$O[3],B$O[3]=B$O[12],B$O[12]=B$J,B$J=B$O[6],B$O[6]=B$O[9],B$O[9]=B$J,B$J=B$O[7],B$O[7]=B$O[13],B$O[13]=B$J,B$J=B$O[11],B$O[11]=B$O[14],B$O[14]=B$J,this},B$O.invert=function(B$O){var B$J=this.elements,B$D=B$O.elements,B$p=B$J[0],B$m=B$J[1],B$C=B$J[2],B$i=B$J[3],B$k=B$J[4],B$_=B$J[5],B$L=B$J[6],B$r=B$J[7],B$H=B$J[8],B$Y=B$J[9],B$G=B$J[10],B$X=B$J[11],B$c=B$J[12],B$h=B$J[13],B$y=B$J[14],B$v=B$J[15],B$A=B$p*B$_-B$m*B$k,B$q=B$p*B$L-B$C*B$k,B$d=B$p*B$r-B$i*B$k,B$M=B$m*B$L-B$C*B$_,B$a=B$m*B$r-B$i*B$_,B$e=B$C*B$r-B$i*B$L,B$t=B$H*B$h-B$Y*B$c,B$z=B$H*B$y-B$G*B$c,B$g=B$H*B$v-B$X*B$c,B$s=B$Y*B$y-B$G*B$h,B$P=B$Y*B$v-B$X*B$h,B$E=B$G*B$v-B$X*B$y,B$o=B$A*B$E-B$q*B$P+B$d*B$s+B$M*B$g-B$a*B$z+B$e*B$t;0!==Math.abs(B$o)&&(B$o=1/B$o,B$D[0]=(B$_*B$E-B$L*B$P+B$r*B$s)*B$o,B$D[1]=(B$C*B$P-B$m*B$E-B$i*B$s)*B$o,B$D[2]=(B$h*B$e-B$y*B$a+B$v*B$M)*B$o,B$D[3]=(B$G*B$a-B$Y*B$e-B$X*B$M)*B$o,B$D[4]=(B$L*B$g-B$k*B$E-B$r*B$z)*B$o,B$D[5]=(B$p*B$E-B$C*B$g+B$i*B$z)*B$o,B$D[6]=(B$y*B$d-B$c*B$e-B$v*B$q)*B$o,B$D[7]=(B$H*B$e-B$G*B$d+B$X*B$q)*B$o,B$D[8]=(B$k*B$P-B$_*B$g+B$r*B$t)*B$o,B$D[9]=(B$m*B$g-B$p*B$P-B$i*B$t)*B$o,B$D[10]=(B$c*B$a-B$h*B$d+B$v*B$A)*B$o,B$D[11]=(B$Y*B$d-B$H*B$a-B$X*B$A)*B$o,B$D[12]=(B$_*B$z-B$k*B$s-B$L*B$t)*B$o,B$D[13]=(B$p*B$s-B$m*B$z+B$C*B$t)*B$o,B$D[14]=(B$h*B$q-B$c*B$M-B$y*B$A)*B$o,B$D[15]=(B$H*B$M-B$Y*B$q+B$G*B$A)*B$o)},B$O.identity=function(){var B$O=this.elements;B$O[1]=B$O[2]=B$O[3]=B$O[4]=B$O[6]=B$O[7]=B$O[8]=B$O[9]=B$O[11]=B$O[12]=B$O[13]=B$O[14]=0,B$O[0]=B$O[5]=B$O[10]=B$O[15]=1},B$O.cloneTo=function(B$O){var B$J,B$D,B$p;if((B$D=this.elements)!==(B$p=B$O.elements))for(B$J=0;B$J<16;++B$J)B$p[B$J]=B$D[B$J]},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$O.getTranslationVector=function(B$O){var B$J=this.elements,B$D=B$O.elements;B$D[0]=B$J[12],B$D[1]=B$J[13],B$D[2]=B$J[14]},B$O.setTranslationVector=function(B$O){var B$J=this.elements,B$D=B$O.elements;B$J[12]=B$D[0],B$J[13]=B$D[1],B$J[14]=B$D[2]},B$O.getForward=function(B$O){var B$J=this.elements,B$D=B$O.elements;B$D[0]=-B$J[8],B$D[1]=-B$J[9],B$D[2]=-B$J[10]},B$O.setForward=function(B$O){var B$J=this.elements,B$D=B$O.elements;B$J[8]=-B$D[0],B$J[9]=-B$D[1],B$J[10]=-B$D[2]},B$t.createRotationX=function(B$O,B$J){var B$D=B$J.elements,B$p=Math.sin(B$O),B$m=Math.cos(B$O);B$D[1]=B$D[2]=B$D[3]=B$D[4]=B$D[7]=B$D[8]=B$D[11]=B$D[12]=B$D[13]=B$D[14]=0,B$D[0]=B$D[15]=1,B$D[5]=B$D[10]=B$m,B$D[6]=B$p,B$D[9]=-B$p},B$t.createRotationY=function(B$O,B$J){var B$D=B$J.elements,B$p=Math.sin(B$O),B$m=Math.cos(B$O);B$D[1]=B$D[3]=B$D[4]=B$D[6]=B$D[7]=B$D[9]=B$D[11]=B$D[12]=B$D[13]=B$D[14]=0,B$D[5]=B$D[15]=1,B$D[0]=B$D[10]=B$m,B$D[2]=-B$p,B$D[8]=B$p},B$t.createRotationZ=function(B$O,B$J){var B$D=B$J.elements,B$p=Math.sin(B$O),B$m=Math.cos(B$O);B$D[2]=B$D[3]=B$D[6]=B$D[7]=B$D[8]=B$D[9]=B$D[11]=B$D[12]=B$D[13]=B$D[14]=0,B$D[10]=B$D[15]=1,B$D[0]=B$D[5]=B$m,B$D[1]=B$p,B$D[4]=-B$p},B$t.createRotationYawPitchRoll=function(B$O,B$J,B$D,B$p){B$DJ.createFromYawPitchRoll(B$O,B$J,B$D,B$t._tempQuaternion),B$t.createRotationQuaternion(B$t._tempQuaternion,B$p)},B$t.createRotationAxis=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=Math.cos(B$J),B$_=Math.sin(B$J),B$L=B$m*B$m,B$r=B$C*B$C,B$H=B$i*B$i,B$Y=B$m*B$C,B$G=B$m*B$i,B$X=B$C*B$i,B$c=B$D.elements;B$c[3]=B$c[7]=B$c[11]=B$c[12]=B$c[13]=B$c[14]=0,B$c[15]=1,B$c[0]=B$L+B$k*(1-B$L),B$c[1]=B$Y-B$k*B$Y+B$_*B$i,B$c[2]=B$G-B$k*B$G-B$_*B$C,B$c[4]=B$Y-B$k*B$Y-B$_*B$i,B$c[5]=B$r+B$k*(1-B$r),B$c[6]=B$X-B$k*B$X+B$_*B$m,B$c[8]=B$G-B$k*B$G+B$_*B$C,B$c[9]=B$X-B$k*B$X-B$_*B$m,B$c[10]=B$H+B$k*(1-B$H)},B$t.createRotationQuaternion=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0],B$C=B$D[1],B$i=B$D[2],B$k=B$D[3],B$_=B$m*B$m,B$L=B$C*B$C,B$r=B$i*B$i,B$H=B$m*B$C,B$Y=B$i*B$k,B$G=B$i*B$m,B$X=B$C*B$k,B$c=B$C*B$i,B$h=B$m*B$k;B$p[3]=B$p[7]=B$p[11]=B$p[12]=B$p[13]=B$p[14]=0,B$p[15]=1,B$p[0]=1-2*(B$L+B$r),B$p[1]=2*(B$H+B$Y),B$p[2]=2*(B$G-B$X),B$p[4]=2*(B$H-B$Y),B$p[5]=1-2*(B$r+B$_),B$p[6]=2*(B$c+B$h),B$p[8]=2*(B$G+B$X),B$p[9]=2*(B$c-B$h),B$p[10]=1-2*(B$L+B$_)},B$t.createTranslate=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;B$p[4]=B$p[8]=B$p[1]=B$p[9]=B$p[2]=B$p[6]=B$p[3]=B$p[7]=B$p[11]=0,B$p[0]=B$p[5]=B$p[10]=B$p[15]=1,B$p[12]=B$D[0],B$p[13]=B$D[1],B$p[14]=B$D[2]},B$t.createScaling=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;B$p[0]=B$D[0],B$p[5]=B$D[1],B$p[10]=B$D[2],B$p[1]=B$p[4]=B$p[8]=B$p[12]=B$p[9]=B$p[13]=B$p[2]=B$p[6]=B$p[14]=B$p[3]=B$p[7]=B$p[11]=0,B$p[15]=1},B$t.multiply=function(B$O,B$J,B$D){var B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r;for(B$m=B$D.elements,B$C=B$O.elements,B$m===(B$i=B$J.elements)&&(B$i=B$i.slice()),B$p=0;B$p<4;B$p++)B$k=B$C[B$p],B$_=B$C[B$p+4],B$L=B$C[B$p+8],B$r=B$C[B$p+12],B$m[B$p]=B$k*B$i[0]+B$_*B$i[1]+B$L*B$i[2]+B$r*B$i[3],B$m[B$p+4]=B$k*B$i[4]+B$_*B$i[5]+B$L*B$i[6]+B$r*B$i[7],B$m[B$p+8]=B$k*B$i[8]+B$_*B$i[9]+B$L*B$i[10]+B$r*B$i[11],B$m[B$p+12]=B$k*B$i[12]+B$_*B$i[13]+B$L*B$i[14]+B$r*B$i[15]},B$t.createFromQuaternion=function(B$O,B$J){var B$D=B$J.elements,B$p=B$O.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=B$m+B$m,B$L=B$C+B$C,B$r=B$i+B$i,B$H=B$m*B$_,B$Y=B$C*B$_,B$G=B$C*B$L,B$X=B$i*B$_,B$c=B$i*B$L,B$h=B$i*B$r,B$y=B$k*B$_,B$v=B$k*B$L,B$A=B$k*B$r;B$D[0]=1-B$G-B$h,B$D[1]=B$Y+B$A,B$D[2]=B$X-B$v,B$D[3]=0,B$D[4]=B$Y-B$A,B$D[5]=1-B$H-B$h,B$D[6]=B$c+B$y,B$D[7]=0,B$D[8]=B$X+B$v,B$D[9]=B$c-B$y,B$D[10]=1-B$H-B$G,B$D[11]=0,B$D[12]=0,B$D[13]=0,B$D[14]=0,B$D[15]=1},B$t.createAffineTransformation=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements,B$C=B$J.elements,B$i=B$D.elements,B$k=B$p.elements,B$_=B$C[0],B$L=B$C[1],B$r=B$C[2],B$H=B$C[3],B$Y=B$_+B$_,B$G=B$L+B$L,B$X=B$r+B$r,B$c=B$_*B$Y,B$h=B$_*B$G,B$y=B$_*B$X,B$v=B$L*B$G,B$A=B$L*B$X,B$q=B$r*B$X,B$d=B$H*B$Y,B$M=B$H*B$G,B$a=B$H*B$X,B$e=B$i[0],B$t=B$i[1],B$z=B$i[2];B$k[0]=(1-(B$v+B$q))*B$e,B$k[1]=(B$h+B$a)*B$e,B$k[2]=(B$y-B$M)*B$e,B$k[3]=0,B$k[4]=(B$h-B$a)*B$t,B$k[5]=(1-(B$c+B$q))*B$t,B$k[6]=(B$A+B$d)*B$t,B$k[7]=0,B$k[8]=(B$y+B$M)*B$z,B$k[9]=(B$A-B$d)*B$z,B$k[10]=(1-(B$c+B$v))*B$z,B$k[11]=0,B$k[12]=B$m[0],B$k[13]=B$m[1],B$k[14]=B$m[2],B$k[15]=1},B$t.createLookAt=function(B$O,B$J,B$D,B$p){var B$m=B$p.elements,B$C=B$t._tempVector0,B$i=B$t._tempVector1,B$k=B$t._tempVector2;B$iJ.subtract(B$O,B$J,B$k),B$iJ.normalize(B$k,B$k),B$iJ.cross(B$D,B$k,B$C),B$iJ.normalize(B$C,B$C),B$iJ.cross(B$k,B$C,B$i),B$p.identity(),B$m[0]=B$C.x,B$m[4]=B$C.y,B$m[8]=B$C.z,B$m[1]=B$i.x,B$m[5]=B$i.y,B$m[9]=B$i.z,B$m[2]=B$k.x,B$m[6]=B$k.y,B$m[10]=B$k.z,B$m[12]=-B$iJ.dot(B$C,B$O),B$m[13]=-B$iJ.dot(B$i,B$O),B$m[14]=-B$iJ.dot(B$k,B$O)},B$t.createPerspective=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$m.elements,B$i=1/Math.tan(B$O/2),B$k=1/(B$D-B$p);B$C[0]=B$i/B$J,B$C[5]=B$i,B$C[10]=(B$p+B$D)*B$k,B$C[11]=-1,B$C[14]=2*B$p*B$D*B$k,B$C[1]=B$C[2]=B$C[3]=B$C[4]=B$C[6]=B$C[7]=B$C[8]=B$C[9]=B$C[12]=B$C[13]=B$C[15]=0},B$t.createOrthoOffCenterRH=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k=B$i.elements,B$_=1/(B$O-B$J),B$L=1/(B$D-B$p),B$r=1/(B$m-B$C);B$k[1]=B$k[2]=B$k[3]=B$k[4]=B$k[6]=B$k[7]=B$k[8]=B$k[9]=B$k[11]=0,B$k[15]=1,B$k[0]=-2*B$_,B$k[5]=-2*B$L,B$k[10]=2*B$r,B$k[12]=(B$O+B$J)*B$_,B$k[13]=(B$p+B$D)*B$L,B$k[14]=(B$C+B$m)*B$r},B$t.translation=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;B$p[0]=B$p[5]=B$p[10]=B$p[15]=1,B$p[12]=B$D[0],B$p[13]=B$D[1],B$p[14]=B$D[2]},B$H(B$t,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new B$t},"_tempVector0",function(){return this._tempVector0=new B$iJ},"_tempVector1",function(){return this._tempVector1=new B$iJ},"_tempVector2",function(){return this._tempVector2=new B$iJ},"_tempQuaternion",function(){return this._tempQuaternion=new B$DJ},"DEFAULT",function(){return this.DEFAULT=new B$t},"ZERO",function(){return this.ZERO=new B$t(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),B$t}(),B$JJ=(function(){function B$A(B$O,B$J){this.extents=null,this.transformation=null,this.extents=B$O,this.transformation=B$J}B$G(B$A,"laya.d3.math.OrientedBoundBox");var B$O=B$A.prototype;B$O.getCorners=function(B$O){var B$J=B$A._tempV30.elements,B$D=B$A._tempV31.elements,B$p=B$A._tempV32.elements,B$m=this.extents.elements;B$J[0]=B$m[0],B$J[1]=B$J[2]=0,B$D[1]=B$m[1],B$D[0]=B$D[2]=0,B$p[2]=B$m[2],B$p[0]=B$p[1]=0,B$iJ.TransformNormal(B$A._tempV30,this.transformation,B$A._tempV30),B$iJ.TransformNormal(B$A._tempV31,this.transformation,B$A._tempV31),B$iJ.TransformNormal(B$A._tempV32,this.transformation,B$A._tempV32);var B$C=B$A._tempV33;this.transformation.getTranslationVector(B$C),B$O.length=8,B$iJ.add(B$C,B$A._tempV30,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV32,B$O[0]),B$iJ.add(B$C,B$A._tempV30,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV32,B$O[1]),B$iJ.subtract(B$C,B$A._tempV30,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV32,B$O[2]),B$iJ.subtract(B$C,B$A._tempV30,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV32,B$O[3]),B$iJ.add(B$C,B$A._tempV30,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV32,B$O[4]),B$iJ.add(B$C,B$A._tempV30,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV32,B$O[5]),B$iJ.subtract(B$C,B$A._tempV30,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV32,B$O[6]),B$iJ.subtract(B$C,B$A._tempV30,B$A._tempV34),B$iJ.subtract(B$A._tempV34,B$A._tempV31,B$A._tempV34),B$iJ.add(B$A._tempV34,B$A._tempV32,B$O[7])},B$O.transform=function(B$O){B$OJ.multiply(this.transformation,B$O,this.transformation)},B$O.scale=function(B$O){B$iJ.multiply(this.extents,B$O,this.extents)},B$O.translate=function(B$O){this.transformation.getTranslationVector(B$A._tempV30),B$iJ.add(B$A._tempV30,B$O,B$A._tempV31),this.transformation.setTranslationVector(B$A._tempV31)},B$O.Size=function(B$O){B$iJ.scale(this.extents,2,B$O)},B$O.getSize=function(B$O){var B$J=this.extents.elements;B$A._tempV30.x=B$J[0],B$A._tempV31.y=B$J[1],B$A._tempV32.z=B$J[2],B$iJ.TransformNormal(B$A._tempV30,this.transformation,B$A._tempV30),B$iJ.TransformNormal(B$A._tempV31,this.transformation,B$A._tempV31),B$iJ.TransformNormal(B$A._tempV31,this.transformation,B$A._tempV32);var B$D=B$O.elements;B$D[0]=B$iJ.scalarLength(B$A._tempV30),B$D[1]=B$iJ.scalarLength(B$A._tempV31),B$D[2]=B$iJ.scalarLength(B$A._tempV32)},B$O.getSizeSquared=function(B$O){var B$J=this.extents.elements;B$A._tempV30.x=B$J[0],B$A._tempV31.y=B$J[1],B$A._tempV32.z=B$J[2],B$iJ.TransformNormal(B$A._tempV30,this.transformation,B$A._tempV30),B$iJ.TransformNormal(B$A._tempV31,this.transformation,B$A._tempV31),B$iJ.TransformNormal(B$A._tempV31,this.transformation,B$A._tempV32);var B$D=B$O.elements;B$D[0]=B$iJ.scalarLengthSquared(B$A._tempV30),B$D[1]=B$iJ.scalarLengthSquared(B$A._tempV31),B$D[2]=B$iJ.scalarLengthSquared(B$A._tempV32)},B$O.getCenter=function(B$O){this.transformation.getTranslationVector(B$O)},B$O.containsPoint=function(B$O){var B$J=this.extents.elements,B$D=B$J[0],B$p=B$J[1],B$m=B$J[2];this.transformation.invert(B$A._tempM0),B$iJ.transformCoordinate(B$O,B$A._tempM0,B$A._tempV30);var B$C=B$A._tempV30.elements,B$i=Math.abs(B$C[0]),B$k=Math.abs(B$C[1]),B$_=Math.abs(B$C[2]);return B$KO.nearEqual(B$i,B$D)&&B$KO.nearEqual(B$k,B$p)&&B$KO.nearEqual(B$_,B$m)?2:B$i<B$D&&B$k<B$p&&B$_<B$m?1:0},B$O.containsPoints=function(B$O){var B$J=this.extents.elements,B$D=B$J[0],B$p=B$J[1],B$m=B$J[2];this.transformation.invert(B$A._tempM0);for(var B$C=!0,B$i=!1,B$k=0;B$k<B$O.length;B$k++){B$iJ.transformCoordinate(B$O[B$k],B$A._tempM0,B$A._tempV30);var B$_=B$A._tempV30.elements,B$L=Math.abs(B$_[0]),B$r=Math.abs(B$_[1]),B$H=Math.abs(B$_[2]);B$KO.nearEqual(B$L,B$D)&&B$KO.nearEqual(B$r,B$p)&&B$KO.nearEqual(B$H,B$m)&&(B$i=!0),B$L<B$D&&B$r<B$p&&B$H<B$m?B$i=!0:B$C=!1}return B$C?1:B$i?2:0},B$O.containsSphere=function(B$O,B$J){void 0===B$J&&(B$J=!1);var B$D=this.extents.elements,B$p=B$D[0],B$m=B$D[1],B$C=B$D[2],B$i=B$O.radius;this.transformation.invert(B$A._tempM0),B$iJ.transformCoordinate(B$O.center,B$A._tempM0,B$A._tempV30);var B$k=NaN;if(B$k=B$J?B$i:(B$iJ.scale(B$iJ.UnitX,B$i,B$A._tempV31),B$iJ.TransformNormal(B$A._tempV31,B$A._tempM0,B$A._tempV31),B$iJ.scalarLength(B$A._tempV31)),B$iJ.scale(this.extents,-1,B$A._tempV32),B$iJ.Clamp(B$A._tempV30,B$A._tempV32,this.extents,B$A._tempV33),B$k*B$k<B$iJ.distanceSquared(B$A._tempV30,B$A._tempV33))return 0;var B$_=B$A._tempV30.elements,B$L=B$_[0],B$r=B$_[1],B$H=B$_[2],B$Y=B$A._tempV32.elements,B$G=B$Y[0],B$X=B$Y[1],B$c=B$Y[2];return B$G+B$k<=B$L&&B$L<=B$p-B$k&&B$k<B$p-B$G&&B$X+B$k<=B$r&&B$r<=B$m-B$k&&B$k<B$m-B$X&&B$c+B$k<=B$H&&B$H<=B$C-B$k&&B$k<B$C-B$c?1:2},B$O.containsOrientedBoundBox=function(B$O){var B$J=0,B$D=0;B$O.getCorners(B$A._corners);var B$p=this.containsPoints(B$A._corners);if(0!=B$p)return B$p;var B$m=this.extents.elements;B$O.extents.cloneTo(B$A._tempV35);var B$C=B$A._tempV35.elements;B$A._getRows(this.transformation,B$A._rows1),B$A._getRows(B$O.transformation,B$A._rows2);var B$i=NaN;for(B$J=0;B$J<4;B$J++)for(B$D=0;B$D<4;B$D++)3==B$J||3==B$D?(B$A._tempM0.setElementByRowColumn(B$J,B$D,0),B$A._tempM1.setElementByRowColumn(B$J,B$D,0)):(B$i=B$iJ.dot(B$A._rows1[B$J],B$A._rows2[B$D]),B$A._tempM0.setElementByRowColumn(B$J,B$D,B$i),B$A._tempM1.setElementByRowColumn(B$J,B$D,Math.abs(B$i)));B$O.getCenter(B$A._tempV34),this.getCenter(B$A._tempV36),B$iJ.subtract(B$A._tempV34,B$A._tempV36,B$A._tempV30);var B$k=B$A._tempV31.elements;B$k[0]=B$iJ.dot(B$A._tempV30,B$A._rows1[0]),B$k[1]=B$iJ.dot(B$A._tempV30,B$A._rows1[1]),B$k[2]=B$iJ.dot(B$A._tempV30,B$A._rows1[2]);var B$_=B$A._tempV32.elements,B$L=B$A._tempV33.elements;for(B$J=0;B$J<3;B$J++)if(B$_[0]=B$A._tempM1.getElementByRowColumn(B$J,0),B$_[1]=B$A._tempM1.getElementByRowColumn(B$J,1),B$_[2]=B$A._tempM1.getElementByRowColumn(B$J,2),B$m[B$J]+B$iJ.dot(B$A._tempV35,B$A._tempV32)<Math.abs(B$k[B$J]))return 0;for(B$D=0;B$D<3;B$D++)if(B$_[0]=B$A._tempM1.getElementByRowColumn(0,B$D),B$_[1]=B$A._tempM1.getElementByRowColumn(1,B$D),B$_[2]=B$A._tempM1.getElementByRowColumn(2,B$D),B$L[0]=B$A._tempM0.getElementByRowColumn(0,B$D),B$L[1]=B$A._tempM0.getElementByRowColumn(1,B$D),B$L[2]=B$A._tempM0.getElementByRowColumn(2,B$D),B$iJ.dot(this.extents,B$A._tempV32)+B$C[B$D]<Math.abs(B$iJ.dot(B$A._tempV31,B$A._tempV33)))return 0;for(B$J=0;B$J<3;B$J++)for(B$D=0;B$D<3;B$D++){var B$r=(B$J+1)%3,B$H=(B$J+2)%3,B$Y=(B$D+1)%3,B$G=(B$D+2)%3;if(B$m[B$r]*B$A._tempM1.getElementByRowColumn(B$H,B$D)+B$m[B$H]*B$A._tempM1.getElementByRowColumn(B$r,B$D)+(B$C[B$Y]*B$A._tempM1.getElementByRowColumn(B$J,B$G)+B$C[B$G]*B$A._tempM1.getElementByRowColumn(B$J,B$Y))<Math.abs(B$k[B$H]*B$A._tempM0.getElementByRowColumn(B$r,B$D)-B$k[B$r]*B$A._tempM0.getElementByRowColumn(B$H,B$D)))return 0}return 2},B$O.containsLine=function(B$O,B$J){B$A._corners[0]=B$O,B$A._corners[1]=B$J;var B$D=this.containsPoints(B$A._corners);if(0!=B$D)return B$D;var B$p=this.extents.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2];this.transformation.invert(B$A._tempM0),B$iJ.transformCoordinate(B$O,B$A._tempM0,B$A._tempV30),B$iJ.transformCoordinate(B$J,B$A._tempM0,B$A._tempV31),B$iJ.add(B$A._tempV30,B$A._tempV31,B$A._tempV32),B$iJ.scale(B$A._tempV32,.5,B$A._tempV32),B$iJ.subtract(B$A._tempV30,B$A._tempV32,B$A._tempV33);var B$k=B$A._tempV33.elements,B$_=B$k[0],B$L=B$k[1],B$r=B$k[2],B$H=B$A._tempV34.elements,B$Y=B$H[0]=Math.abs(B$k[0]),B$G=B$H[1]=Math.abs(B$k[1]),B$X=B$H[2]=Math.abs(B$k[2]),B$c=B$A._tempV32.elements,B$h=B$c[0],B$y=B$c[1],B$v=B$c[2];return Math.abs(B$h)>B$m+B$Y?0:Math.abs(B$y)>B$C+B$G?0:Math.abs(B$v)>B$i+B$X?0:Math.abs(B$y*B$r-B$v*B$L)>B$C*B$X+B$i*B$G?0:Math.abs(B$h*B$r-B$v*B$_)>B$m*B$X+B$i*B$Y?0:Math.abs(B$h*B$L-B$y*B$_)>B$m*B$G+B$C*B$Y?0:2},B$O.containsBoundBox=function(B$O){var B$J=0,B$D=0,B$p=B$O.min,B$m=B$O.max;B$O.getCorners(B$A._corners);var B$C=this.containsPoints(B$A._corners);if(0!=B$C)return B$C;B$iJ.subtract(B$m,B$p,B$A._tempV30),B$iJ.scale(B$A._tempV30,.5,B$A._tempV30),B$iJ.add(B$p,B$A._tempV30,B$A._tempV30),B$iJ.subtract(B$m,B$A._tempV30,B$A._tempV31);var B$i=this.extents.elements,B$k=B$A._tempV31.elements;B$A._getRows(this.transformation,B$A._rows1),this.transformation.invert(B$A._tempM0);for(B$J=0;B$J<3;B$J++)for(B$D=0;B$D<3;B$D++)B$A._tempM1.setElementByRowColumn(B$J,B$D,Math.abs(B$A._tempM0.getElementByRowColumn(B$J,B$D)));this.getCenter(B$A._tempV35),B$iJ.subtract(B$A._tempV30,B$A._tempV35,B$A._tempV32);var B$_=B$A._tempV31.elements;B$_[0]=B$iJ.dot(B$A._tempV32,B$A._rows1[0]),B$_[1]=B$iJ.dot(B$A._tempV32,B$A._rows1[1]),B$_[2]=B$iJ.dot(B$A._tempV32,B$A._rows1[2]);var B$L=B$A._tempV33.elements,B$r=B$A._tempV34.elements;for(B$J=0;B$J<3;B$J++)if(B$L[0]=B$A._tempM1.getElementByRowColumn(B$J,0),B$L[1]=B$A._tempM1.getElementByRowColumn(B$J,1),B$L[2]=B$A._tempM1.getElementByRowColumn(B$J,2),B$i[B$J]+B$iJ.dot(B$A._tempV31,B$A._tempV33)<Math.abs(B$_[B$J]))return 0;for(B$D=0;B$D<3;B$D++)if(B$L[0]=B$A._tempM1.getElementByRowColumn(0,B$D),B$L[1]=B$A._tempM1.getElementByRowColumn(1,B$D),B$L[2]=B$A._tempM1.getElementByRowColumn(2,B$D),B$r[0]=B$A._tempM0.getElementByRowColumn(0,B$D),B$r[1]=B$A._tempM0.getElementByRowColumn(1,B$D),B$r[2]=B$A._tempM0.getElementByRowColumn(2,B$D),B$iJ.dot(this.extents,B$A._tempV33)+B$k[B$D]<Math.abs(B$iJ.dot(B$A._tempV31,B$A._tempV34)))return 0;for(B$J=0;B$J<3;B$J++)for(B$D=0;B$D<3;B$D++){var B$H=(B$J+1)%3,B$Y=(B$J+2)%3,B$G=(B$D+1)%3,B$X=(B$D+2)%3;if(B$i[B$H]*B$A._tempM1.getElementByRowColumn(B$Y,B$D)+B$i[B$Y]*B$A._tempM1.getElementByRowColumn(B$H,B$D)+(B$k[B$G]*B$A._tempM1.getElementByRowColumn(B$J,B$X)+B$k[B$X]*B$A._tempM1.getElementByRowColumn(B$J,B$G))<Math.abs(B$_[B$Y]*B$A._tempM0.getElementByRowColumn(B$H,B$D)-B$_[B$H]*B$A._tempM0.getElementByRowColumn(B$Y,B$D)))return 0}return 2},B$O.intersectsRay=function(B$O,B$J){B$iJ.scale(this.extents,-1,B$A._tempV30),this.transformation.invert(B$A._tempM0),B$iJ.TransformNormal(B$O.direction,B$A._tempM0,B$A._ray.direction),B$iJ.transformCoordinate(B$O.origin,B$A._tempM0,B$A._ray.origin),B$A._boxBound1.min=B$A._tempV30,B$A._boxBound1.max=this.extents;var B$D=Collision.intersectsRayAndBoxRP(B$A._ray,B$A._boxBound1,B$J);return-1!==B$D&&B$iJ.transformCoordinate(B$J,this.transformation,B$J),B$D},B$O._getLocalCorners=function(B$O){B$O.length=8;var B$J=this.extents.elements;B$A._tempV30.x=B$J[0],B$A._tempV31.y=B$J[1],B$A._tempV32.z=B$J[2],B$iJ.add(B$A._tempV30,B$A._tempV31,B$A._tempV33),B$iJ.add(B$A._tempV33,B$A._tempV32,B$O[0]),B$iJ.add(B$A._tempV30,B$A._tempV31,B$A._tempV33),B$iJ.subtract(B$A._tempV33,B$A._tempV32,B$O[1]),B$iJ.subtract(B$A._tempV31,B$A._tempV30,B$A._tempV33),B$iJ.subtract(B$A._tempV33,B$A._tempV30,B$O[2]),B$iJ.subtract(B$A._tempV31,B$A._tempV30,B$A._tempV33),B$iJ.add(B$A._tempV33,B$A._tempV32,B$O[3]),B$iJ.subtract(B$A._tempV30,B$A._tempV31,B$A._tempV33),B$iJ.add(B$A._tempV33,B$A._tempV32,B$O[4]),B$iJ.subtract(B$A._tempV30,B$A._tempV31,B$A._tempV33),B$iJ.subtract(B$A._tempV33,B$A._tempV32,B$O[5]),B$iJ.scale(B$O[0],-1,B$O[6]),B$iJ.subtract(B$A._tempV32,B$A._tempV30,B$A._tempV33),B$iJ.subtract(B$A._tempV33,B$A._tempV31,B$O[7])},B$O.equals=function(B$O){return this.extents==B$O.extents&&this.transformation==B$O.transformation},B$O.cloneTo=function(B$O){var B$J=B$O;this.extents.cloneTo(B$J.extents),this.transformation.cloneTo(B$J.transformation)},B$A.createByBoundBox=function(B$O,B$J){var B$D=B$O.min,B$p=B$O.max;B$iJ.subtract(B$p,B$D,B$A._tempV30),B$iJ.scale(B$A._tempV30,.5,B$A._tempV30),B$iJ.add(B$D,B$A._tempV30,B$A._tempV31),B$iJ.subtract(B$p,B$A._tempV31,B$A._tempV32),B$OJ.translation(B$A._tempV31,B$A._tempM0);var B$m=B$A._tempV32.clone(),B$C=B$A._tempM0.clone();B$J.extents=B$m,B$J.transformation=B$C},B$A.createByMinAndMaxVertex=function(B$O,B$J){return B$iJ.subtract(B$J,B$O,B$A._tempV30),B$iJ.scale(B$A._tempV30,.5,B$A._tempV30),B$iJ.add(B$O,B$A._tempV30,B$A._tempV31),B$iJ.subtract(B$J,B$A._tempV31,B$A._tempV32),B$OJ.translation(B$A._tempV31,B$A._tempM0),new B$A(B$A._tempV32,B$A._tempM0)},B$A._getRows=function(B$O,B$J){B$J.length=3;var B$D=B$O.elements,B$p=B$J[0].elements;B$p[0]=B$D[0],B$p[1]=B$D[1],B$p[2]=B$D[2];var B$m=B$J[1].elements;B$m[0]=B$D[4],B$m[1]=B$D[5],B$m[2]=B$D[6];var B$C=B$J[2].elements;B$C[0]=B$D[8],B$C[1]=B$D[9],B$C[2]=B$D[10]},B$A.getObbtoObbMatrix4x4=function(B$O,B$J,B$D,B$p){var B$m=B$O.transformation,B$C=B$J.transformation;if(B$D){B$A._getRows(B$m,B$A._rows1),B$A._getRows(B$C,B$A._rows2);for(var B$i=0;B$i<3;B$i++)for(var B$k=0;B$k<3;B$k++)B$p.setElementByRowColumn(B$i,B$k,B$iJ.dot(B$A._rows2[B$i],B$A._rows1[B$k]));B$J.getCenter(B$A._tempV30),B$O.getCenter(B$A._tempV31),B$iJ.subtract(B$A._tempV30,B$A._tempV31,B$A._tempV32);var B$_=B$p.elements;B$_[12]=B$iJ.dot(B$A._tempV32,B$A._rows1[0]),B$_[13]=B$iJ.dot(B$A._tempV32,B$A._rows1[1]),B$_[14]=B$iJ.dot(B$A._tempV32,B$A._rows1[2]),B$_[15]=1}else B$m.invert(B$A._tempM0),B$OJ.multiply(B$C,B$A._tempM0,B$p)},B$A.merge=function(B$O,B$J,B$D){var B$p=B$O.extents,B$m=B$O.transformation;B$A.getObbtoObbMatrix4x4(B$O,B$J,B$D,B$A._tempM0),B$J._getLocalCorners(B$A._corners),B$iJ.transformCoordinate(B$A._corners[0],B$A._tempM0,B$A._corners[0]),B$iJ.transformCoordinate(B$A._corners[1],B$A._tempM0,B$A._corners[1]),B$iJ.transformCoordinate(B$A._corners[2],B$A._tempM0,B$A._corners[2]),B$iJ.transformCoordinate(B$A._corners[3],B$A._tempM0,B$A._corners[3]),B$iJ.transformCoordinate(B$A._corners[4],B$A._tempM0,B$A._corners[4]),B$iJ.transformCoordinate(B$A._corners[5],B$A._tempM0,B$A._corners[5]),B$iJ.transformCoordinate(B$A._corners[6],B$A._tempM0,B$A._corners[6]),B$iJ.transformCoordinate(B$A._corners[7],B$A._tempM0,B$A._corners[7]),B$iJ.scale(B$p,-1,B$A._boxBound1.min),B$p.cloneTo(B$A._boxBound1.max),B$SO.createfromPoints(B$A._corners,B$A._boxBound2),B$SO.merge(B$A._boxBound2,B$A._boxBound1,B$A._boxBound3);var B$C=B$A._boxBound3.min,B$i=B$A._boxBound3.max;B$iJ.subtract(B$i,B$C,B$A._tempV30),B$iJ.scale(B$A._tempV30,.5,B$A._tempV30),B$iJ.add(B$C,B$A._tempV30,B$A._tempV32),B$iJ.subtract(B$i,B$A._tempV32,B$p),B$iJ.transformCoordinate(B$A._tempV32,B$m,B$A._tempV33)},B$H(B$A,["_tempV30",function(){return this._tempV30=new B$iJ},"_tempV31",function(){return this._tempV31=new B$iJ},"_tempV32",function(){return this._tempV32=new B$iJ},"_tempV33",function(){return this._tempV33=new B$iJ},"_tempV34",function(){return this._tempV34=new B$iJ},"_tempV35",function(){return this._tempV35=new B$iJ},"_tempV36",function(){return this._tempV36=new B$iJ},"_tempM0",function(){return this._tempM0=new B$OJ},"_tempM1",function(){return this._tempM1=new B$OJ},"_corners",function(){return this._corners=[new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ]},"_rows1",function(){return this._rows1=[new B$iJ,new B$iJ,new B$iJ]},"_rows2",function(){return this._rows2=[new B$iJ,new B$iJ,new B$iJ]},"_ray",function(){return this._ray=new B$mJ(new B$iJ,new B$iJ)},"_boxBound1",function(){return this._boxBound1=new B$SO(new B$iJ,new B$iJ)},"_boxBound2",function(){return this._boxBound2=new B$SO(new B$iJ,new B$iJ)},"_boxBound3",function(){return this._boxBound3=new B$SO(new B$iJ,new B$iJ)}])}(),function(){function B$d(B$O,B$J){this.normal=null,this.distance=NaN,void 0===B$J&&(B$J=0),this.normal=B$O,this.distance=B$J}return B$G(B$d,"laya.d3.math.Plane"),B$d.prototype.normalize=function(){var B$O=this.normal.elements,B$J=B$O[0],B$D=B$O[1],B$p=B$O[2],B$m=1/Math.sqrt(B$J*B$J+B$D*B$D+B$p*B$p);B$O[0]=B$J*B$m,B$O[1]=B$D*B$m,B$O[2]=B$p*B$m,this.distance*=B$m},B$d.createPlaneBy3P=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$J.elements,B$C=B$D.elements,B$i=B$m[0]-B$p[0],B$k=B$m[1]-B$p[1],B$_=B$m[2]-B$p[2],B$L=B$C[0]-B$p[0],B$r=B$C[1]-B$p[1],B$H=B$C[2]-B$p[2],B$Y=B$k*B$H-B$_*B$r,B$G=B$_*B$L-B$i*B$H,B$X=B$i*B$r-B$k*B$L,B$c=1/Math.sqrt(B$Y*B$Y+B$G*B$G+B$X*B$X),B$h=B$Y*B$c,B$y=B$G*B$c,B$v=B$X*B$c,B$A=B$d._TEMPVec3.elements;B$A[0]=B$h,B$A[1]=B$y,B$A[2]=B$v;var B$q=-(B$h*B$p[0]+B$y*B$p[1]+B$v*B$p[2]);return new B$d(B$d._TEMPVec3,B$q)},B$d.PlaneIntersectionType_Back=0,B$d.PlaneIntersectionType_Front=1,B$d.PlaneIntersectionType_Intersecting=2,B$H(B$d,["_TEMPVec3",function(){return this._TEMPVec3=new B$iJ}]),B$d}()),B$DJ=function(){function B$m(B$O,B$J,B$D,B$p){this.elements=new Float32Array(4),void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=1),this.elements[0]=B$O,this.elements[1]=B$J,this.elements[2]=B$D,this.elements[3]=B$p}B$G(B$m,"laya.d3.math.Quaternion");var B$O=B$m.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.scaling=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements;B$D[0]=B$p[0]*B$O,B$D[1]=B$p[1]*B$O,B$D[2]=B$p[2]*B$O,B$D[3]=B$p[3]*B$O},B$O.normalize=function(B$O){var B$J=B$O.elements,B$D=this.elements,B$p=B$D[0],B$m=B$D[1],B$C=B$D[2],B$i=B$D[3],B$k=B$p*B$p+B$m*B$m+B$C*B$C+B$i*B$i;0<B$k&&(B$k=1/Math.sqrt(B$k),B$J[0]=B$p*B$k,B$J[1]=B$m*B$k,B$J[2]=B$C*B$k,B$J[3]=B$i*B$k)},B$O.length=function(){var B$O=this.elements,B$J=B$O[0],B$D=B$O[1],B$p=B$O[2],B$m=B$O[3];return Math.sqrt(B$J*B$J+B$D*B$D+B$p*B$p+B$m*B$m)},B$O.rotateX=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements;B$O*=.5;var B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=Math.sin(B$O),B$L=Math.cos(B$O);B$D[0]=B$m*B$L+B$k*B$_,B$D[1]=B$C*B$L+B$i*B$_,B$D[2]=B$i*B$L-B$C*B$_,B$D[3]=B$k*B$L-B$m*B$_},B$O.rotateY=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements;B$O*=.5;var B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=Math.sin(B$O),B$L=Math.cos(B$O);B$D[0]=B$m*B$L-B$i*B$_,B$D[1]=B$C*B$L+B$k*B$_,B$D[2]=B$i*B$L+B$m*B$_,B$D[3]=B$k*B$L-B$C*B$_},B$O.rotateZ=function(B$O,B$J){var B$D=B$J.elements,B$p=this.elements;B$O*=.5;var B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=Math.sin(B$O),B$L=Math.cos(B$O);B$D[0]=B$m*B$L+B$C*B$_,B$D[1]=B$C*B$L-B$m*B$_,B$D[2]=B$i*B$L+B$k*B$_,B$D[3]=B$k*B$L-B$i*B$_},B$O.getYawPitchRoll=function(B$O){B$iJ.transformQuat(B$iJ.ForwardRH,this,B$m.TEMPVector31),B$iJ.transformQuat(B$iJ.Up,this,B$m.TEMPVector32);var B$J=B$m.TEMPVector32.elements;B$m.angleTo(B$iJ.ZERO,B$m.TEMPVector31,B$m.TEMPVector33);var B$D=B$m.TEMPVector33.elements;B$D[0]==Math.PI/2?(B$D[1]=B$m.arcTanAngle(B$J[2],B$J[0]),B$D[2]=0):B$D[0]==-Math.PI/2?(B$D[1]=B$m.arcTanAngle(-B$J[2],-B$J[0]),B$D[2]=0):(B$OJ.createRotationY(-B$D[1],B$m.TEMPMatrix0),B$OJ.createRotationX(-B$D[0],B$m.TEMPMatrix1),B$iJ.transformCoordinate(B$m.TEMPVector32,B$m.TEMPMatrix0,B$m.TEMPVector32),B$iJ.transformCoordinate(B$m.TEMPVector32,B$m.TEMPMatrix1,B$m.TEMPVector32),B$D[2]=B$m.arcTanAngle(B$J[1],-B$J[0])),B$D[1]<=-Math.PI&&(B$D[1]=Math.PI),B$D[2]<=-Math.PI&&(B$D[2]=Math.PI),B$D[1]>=Math.PI&&B$D[2]>=Math.PI&&(B$D[1]=0,B$D[2]=0,B$D[0]=Math.PI-B$D[0]);var B$p=B$O.elements;B$p[0]=B$D[1],B$p[1]=B$D[0],B$p[2]=B$D[2]},B$O.invert=function(B$O){var B$J=B$O.elements,B$D=this.elements,B$p=B$D[0],B$m=B$D[1],B$C=B$D[2],B$i=B$D[3],B$k=B$p*B$p+B$m*B$m+B$C*B$C+B$i*B$i,B$_=B$k?1/B$k:0;B$J[0]=-B$p*B$_,B$J[1]=-B$m*B$_,B$J[2]=-B$C*B$_,B$J[3]=B$i*B$_},B$O.identity=function(){var B$O=this.elements;B$O[0]=0,B$O[1]=0,B$O[2]=0,B$O[3]=1},B$O.fromArray=function(B$O,B$J){void 0===B$J&&(B$J=0),this.elements[0]=B$O[B$J+0],this.elements[1]=B$O[B$J+1],this.elements[2]=B$O[B$J+2],this.elements[3]=B$O[B$J+3]},B$O.cloneTo=function(B$O){var B$J,B$D,B$p;if((B$D=this.elements)!==(B$p=B$O.elements))for(B$J=0;B$J<4;++B$J)B$p[B$J]=B$D[B$J]},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$O.equals=function(B$O){var B$J=this.elements,B$D=B$O.elements;return B$KO.nearEqual(B$J[0],B$D[0])&&B$KO.nearEqual(B$J[1],B$D[1])&&B$KO.nearEqual(B$J[2],B$D[2])&&B$KO.nearEqual(B$J[3],B$D[3])},B$O.lengthSquared=function(){var B$O=this.elements[0],B$J=this.elements[1],B$D=this.elements[2],B$p=this.elements[3];return B$O*B$O+B$J*B$J+B$D*B$D+B$p*B$p},B$X(0,B$O,"x",function(){return this.elements[0]}),B$X(0,B$O,"y",function(){return this.elements[1]}),B$X(0,B$O,"z",function(){return this.elements[2]}),B$X(0,B$O,"w",function(){return this.elements[3]}),B$m.createFromYawPitchRoll=function(B$O,B$J,B$D,B$p){var B$m=.5*B$D,B$C=.5*B$J,B$i=.5*B$O,B$k=Math.sin(B$m),B$_=Math.cos(B$m),B$L=Math.sin(B$C),B$r=Math.cos(B$C),B$H=Math.sin(B$i),B$Y=Math.cos(B$i),B$G=B$p.elements;B$G[0]=B$Y*B$L*B$_+B$H*B$r*B$k,B$G[1]=B$H*B$r*B$_-B$Y*B$L*B$k,B$G[2]=B$Y*B$r*B$k-B$H*B$L*B$_,B$G[3]=B$Y*B$r*B$_+B$H*B$L*B$k},B$m.multiply=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$J.elements,B$C=B$D.elements,B$i=B$p[0],B$k=B$p[1],B$_=B$p[2],B$L=B$p[3],B$r=B$m[0],B$H=B$m[1],B$Y=B$m[2],B$G=B$m[3],B$X=B$k*B$Y-B$_*B$H,B$c=B$_*B$r-B$i*B$Y,B$h=B$i*B$H-B$k*B$r,B$y=B$i*B$r+B$k*B$H+B$_*B$Y;B$C[0]=B$i*B$G+B$r*B$L+B$X,B$C[1]=B$k*B$G+B$H*B$L+B$c,B$C[2]=B$_*B$G+B$Y*B$L+B$h,B$C[3]=B$L*B$G-B$y},B$m.arcTanAngle=function(B$O,B$J){return 0==B$O?1==B$J?Math.PI/2:-Math.PI/2:0<B$O?Math.atan(B$J/B$O):B$O<0?0<B$J?Math.atan(B$J/B$O)+Math.PI:Math.atan(B$J/B$O)-Math.PI:0},B$m.angleTo=function(B$O,B$J,B$D){B$iJ.subtract(B$J,B$O,B$m.TEMPVector30),B$iJ.normalize(B$m.TEMPVector30,B$m.TEMPVector30),B$D.elements[0]=Math.asin(B$m.TEMPVector30.y),B$D.elements[1]=B$m.arcTanAngle(-B$m.TEMPVector30.z,-B$m.TEMPVector30.x)},B$m.createFromAxisAngle=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements;B$J*=.5;var B$C=Math.sin(B$J);B$p[0]=B$C*B$m[0],B$p[1]=B$C*B$m[1],B$p[2]=B$C*B$m[2],B$p[3]=Math.cos(B$J)},B$m.createFromMatrix3x3=function(B$O,B$J){var B$D,B$p=B$J.elements,B$m=B$O.elements,B$C=B$m[0]+B$m[4]+B$m[8];if(0<B$C)B$D=Math.sqrt(B$C+1),B$p[3]=.5*B$D,B$D=.5/B$D,B$p[0]=(B$m[5]-B$m[7])*B$D,B$p[1]=(B$m[6]-B$m[2])*B$D,B$p[2]=(B$m[1]-B$m[3])*B$D;else{var B$i=0;B$m[4]>B$m[0]&&(B$i=1),B$m[8]>B$m[3*B$i+B$i]&&(B$i=2);var B$k=(B$i+1)%3,B$_=(B$i+2)%3;B$D=Math.sqrt(B$m[3*B$i+B$i]-B$m[3*B$k+B$k]-B$m[3*B$_+B$_]+1),B$p[B$i]=.5*B$D,B$D=.5/B$D,B$p[3]=(B$m[3*B$k+B$_]-B$m[3*B$_+B$k])*B$D,B$p[B$k]=(B$m[3*B$k+B$i]+B$m[3*B$i+B$k])*B$D,B$p[B$_]=(B$m[3*B$_+B$i]+B$m[3*B$i+B$_])*B$D}},B$m.createFromMatrix4x4=function(B$O,B$J){var B$D,B$p,B$m=B$O.elements,B$C=B$J.elements,B$i=B$m[0]+B$m[5]+B$m[10];0<B$i?(B$D=Math.sqrt(B$i+1),B$C[3]=.5*B$D,B$D=.5/B$D,B$C[0]=(B$m[6]-B$m[9])*B$D,B$C[1]=(B$m[8]-B$m[2])*B$D,B$C[2]=(B$m[1]-B$m[4])*B$D):B$m[0]>=B$m[5]&&B$m[0]>=B$m[10]?(B$p=.5/(B$D=Math.sqrt(1+B$m[0]-B$m[5]-B$m[10])),B$C[0]=.5*B$D,B$C[1]=(B$m[1]+B$m[4])*B$p,B$C[2]=(B$m[2]+B$m[8])*B$p,B$C[3]=(B$m[6]-B$m[9])*B$p):B$m[5]>B$m[10]?(B$p=.5/(B$D=Math.sqrt(1+B$m[5]-B$m[0]-B$m[10])),B$C[0]=(B$m[4]+B$m[1])*B$p,B$C[1]=.5*B$D,B$C[2]=(B$m[9]+B$m[6])*B$p,B$C[3]=(B$m[8]-B$m[2])*B$p):(B$p=.5/(B$D=Math.sqrt(1+B$m[10]-B$m[0]-B$m[5])),B$C[0]=(B$m[8]+B$m[2])*B$p,B$C[1]=(B$m[9]+B$m[6])*B$p,B$C[2]=.5*B$D,B$C[3]=(B$m[1]-B$m[4])*B$p)},B$m.slerp=function(B$O,B$J,B$D,B$p){var B$m,B$C,B$i,B$k,B$_,B$L=B$O.elements,B$r=B$J.elements,B$H=B$p.elements,B$Y=B$L[0],B$G=B$L[1],B$X=B$L[2],B$c=B$L[3],B$h=B$r[0],B$y=B$r[1],B$v=B$r[2],B$A=B$r[3];return(B$C=B$Y*B$h+B$G*B$y+B$X*B$v+B$c*B$A)<0&&(B$C=-B$C,B$h=-B$h,B$y=-B$y,B$v=-B$v,B$A=-B$A),B$_=1e-6<1-B$C?(B$m=Math.acos(B$C),B$i=Math.sin(B$m),B$k=Math.sin((1-B$D)*B$m)/B$i,Math.sin(B$D*B$m)/B$i):(B$k=1-B$D,B$D),B$H[0]=B$k*B$Y+B$_*B$h,B$H[1]=B$k*B$G+B$_*B$y,B$H[2]=B$k*B$X+B$_*B$v,B$H[3]=B$k*B$c+B$_*B$A,B$H},B$m.lerp=function(B$O,B$J,B$D,B$p){var B$m=B$p.elements,B$C=B$O.elements,B$i=B$J.elements,B$k=B$C[0],B$_=B$C[1],B$L=B$C[2],B$r=B$C[3];B$m[0]=B$k+B$D*(B$i[0]-B$k),B$m[1]=B$_+B$D*(B$i[1]-B$_),B$m[2]=B$L+B$D*(B$i[2]-B$L),B$m[3]=B$r+B$D*(B$i[3]-B$r)},B$m.add=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]+B$C[0],B$p[1]=B$m[1]+B$C[1],B$p[2]=B$m[2]+B$C[2],B$p[3]=B$m[3]+B$C[3]},B$m.dot=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;return B$D[0]*B$p[0]+B$D[1]*B$p[1]+B$D[2]*B$p[2]+B$D[3]*B$p[3]},B$m.rotationLookAt=function(B$O,B$J,B$D){B$m.lookAt(B$iJ.ZERO,B$O,B$J,B$D)},B$m.lookAt=function(B$O,B$J,B$D,B$p){B$fO.lookAt(B$O,B$J,B$D,B$m._tempMatrix3x3),B$m.rotationMatrix(B$m._tempMatrix3x3,B$p)},B$m.invert=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$O.lengthSquared();B$KO.isZero(B$m)||(B$m=1/B$m,B$p[0]=-B$D[0]*B$m,B$p[1]=-B$D[1]*B$m,B$p[2]=-B$D[2]*B$m,B$p[3]=B$D[3]*B$m)},B$m.rotationMatrix=function(B$O,B$J){var B$D=B$O.elements,B$p=B$D[0],B$m=B$D[1],B$C=B$D[2],B$i=B$D[3],B$k=B$D[4],B$_=B$D[5],B$L=B$D[6],B$r=B$D[7],B$H=B$D[8],B$Y=B$J.elements,B$G=NaN,B$X=NaN,B$c=B$p+B$k+B$H;0<B$c?(B$G=Math.sqrt(B$c+1),B$Y[3]=.5*B$G,B$G=.5/B$G,B$Y[0]=(B$_-B$r)*B$G,B$Y[1]=(B$L-B$C)*B$G,B$Y[2]=(B$m-B$i)*B$G):B$k<=B$p&&B$H<=B$p?(B$X=.5/(B$G=Math.sqrt(1+B$p-B$k-B$H)),B$Y[0]=.5*B$G,B$Y[1]=(B$m+B$i)*B$X,B$Y[2]=(B$C+B$L)*B$X,B$Y[3]=(B$_-B$r)*B$X):B$H<B$k?(B$X=.5/(B$G=Math.sqrt(1+B$k-B$p-B$H)),B$Y[0]=(B$i+B$m)*B$X,B$Y[1]=.5*B$G,B$Y[2]=(B$r+B$_)*B$X,B$Y[3]=(B$L-B$C)*B$X):(B$X=.5/(B$G=Math.sqrt(1+B$H-B$p-B$k)),B$Y[0]=(B$L+B$C)*B$X,B$Y[1]=(B$r+B$_)*B$X,B$Y[2]=.5*B$G,B$Y[3]=(B$m-B$i)*B$X)},B$m.DEFAULT=new B$m,B$H(B$m,["TEMPVector30",function(){return this.TEMPVector30=new B$iJ},"TEMPVector31",function(){return this.TEMPVector31=new B$iJ},"TEMPVector32",function(){return this.TEMPVector32=new B$iJ},"TEMPVector33",function(){return this.TEMPVector33=new B$iJ},"TEMPMatrix0",function(){return this.TEMPMatrix0=new B$OJ},"TEMPMatrix1",function(){return this.TEMPMatrix1=new B$OJ},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new B$fO},"NAN",function(){return this.NAN=new B$m(NaN,NaN,NaN,NaN)}]),B$m}(),B$pJ=function(){function B$O(B$O){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=B$O,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}B$G(B$O,"laya.d3.math.Rand");var B$J=B$O.prototype;return B$J.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},B$J.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},B$J.getSignedFloat=function(){return 2*this.getFloat()-1},B$X(0,B$J,"seed",function(){return this.seeds[0]},function(B$O){this.seeds[0]=B$O,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),B$O.getFloatFromInt=function(B$O){return 1/8388607*(8388607&B$O)},B$O.getByteFromInt=function(B$O){return(8388607&B$O)>>>15},B$O}(),B$mJ=(function(){function B$m(B$O){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(B$O instanceof Array)||4!==B$O.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|B$O[0],this._state0L=0|B$O[1],this._state1U=0|B$O[2],this._state1L=0|B$O[3]}B$G(B$m,"laya.d3.math.RandX");var B$O=B$m.prototype;B$O.randomint=function(){var B$O=this._state0U,B$J=this._state0L,B$D=this._state1U,B$p=this._state1L,B$m=(B$p>>>0)+(B$J>>>0),B$C=B$D+B$O+(B$m/2>>>31)>>>0,B$i=B$m>>>0,B$k=0,B$_=0;B$k=(B$O^=B$k=B$O<<23|(-512&B$J)>>>9)^(this._state0U=B$D),B$_=(B$J^=B$_=B$J<<23)^(this._state0L=B$p);B$k^=B$O>>>18,B$_^=B$J>>>18|(262143&B$O)<<14;return B$k^=B$D>>>5,B$_^=B$p>>>5|(31&B$D)<<27,this._state1U=B$k,this._state1L=B$_,[B$C,B$i]},B$O.random=function(){var B$O=this.randomint(),B$J=B$O[0],B$D=1023<<20|B$J>>>12,B$p=0|(B$O[1]>>>12|(4095&B$J)<<20);return B$m._CONVERTION_BUFFER.setUint32(0,B$D,!1),B$m._CONVERTION_BUFFER.setUint32(4,B$p,!1),B$pJ._CONVERTION_BUFFER.getFloat64(0,!1)-1},B$H(B$m,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new B$pJ([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function B$O(B$O,B$J){this.origin=null,this.direction=null,this.origin=B$O,this.direction=B$J}return B$G(B$O,"laya.d3.math.Ray"),B$O}()),B$CJ=function(){function B$O(B$O,B$J){this.elements=new Float32Array(2),void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0);var B$D=this.elements;B$D[0]=B$O,B$D[1]=B$J}B$G(B$O,"laya.d3.math.Vector2");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.fromArray=function(B$O,B$J){void 0===B$J&&(B$J=0),this.elements[0]=B$O[B$J+0],this.elements[1]=B$O[B$J+1]},B$J.cloneTo=function(B$O){var B$J=B$O.elements,B$D=this.elements;B$J[0]=B$D[0],B$J[1]=B$D[1]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"x",function(){return this.elements[0]},function(B$O){this.elements[0]=B$O}),B$X(0,B$J,"y",function(){return this.elements[1]},function(B$O){this.elements[1]=B$O}),B$O.scale=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements;B$p[0]=B$m[0]*B$J,B$p[1]=B$m[1]*B$J},B$H(B$O,["ZERO",function(){return this.ZERO=new B$O(0,0)},"ONE",function(){return this.ONE=new B$O(1,1)}]),B$O}(),B$iJ=function(){function B$r(B$O,B$J,B$D){this.elements=new Float32Array(3),void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0);var B$p=this.elements;B$p[0]=B$O,B$p[1]=B$J,B$p[2]=B$D}B$G(B$r,"laya.d3.math.Vector3");var B$O=B$r.prototype;return B$d.imps(B$O,{"laya.d3.core.IClone":!0}),B$O.fromArray=function(B$O,B$J){void 0===B$J&&(B$J=0),this.elements[0]=B$O[B$J+0],this.elements[1]=B$O[B$J+1],this.elements[2]=B$O[B$J+2]},B$O.cloneTo=function(B$O){var B$J=B$O.elements,B$D=this.elements;B$J[0]=B$D[0],B$J[1]=B$D[1],B$J[2]=B$D[2]},B$O.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$O.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},B$O.reset=function(B$O,B$J,B$D){this.elements[0]=B$O,this.elements[1]=B$J,this.elements[2]=B$D},B$X(0,B$O,"x",function(){return this.elements[0]},function(B$O){this.elements[0]=B$O}),B$X(0,B$O,"y",function(){return this.elements[1]},function(B$O){this.elements[1]=B$O}),B$X(0,B$O,"z",function(){return this.elements[2]},function(B$O){this.elements[2]=B$O}),B$r.distanceSquared=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0]-B$p[0],B$C=B$D[1]-B$p[1],B$i=B$D[2]-B$p[2];return B$m*B$m+B$C*B$C+B$i*B$i},B$r.distance=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0]-B$p[0],B$C=B$D[1]-B$p[1],B$i=B$D[2]-B$p[2];return Math.sqrt(B$m*B$m+B$C*B$C+B$i*B$i)},B$r.min=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=Math.min(B$m[0],B$C[0]),B$p[1]=Math.min(B$m[1],B$C[1]),B$p[2]=Math.min(B$m[2],B$C[2])},B$r.max=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=Math.max(B$m[0],B$C[0]),B$p[1]=Math.max(B$m[1],B$C[1]),B$p[2]=Math.max(B$m[2],B$C[2])},B$r.transformQuat=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements,B$i=B$m[0],B$k=B$m[1],B$_=B$m[2],B$L=B$C[0],B$r=B$C[1],B$H=B$C[2],B$Y=B$C[3],B$G=B$Y*B$i+B$r*B$_-B$H*B$k,B$X=B$Y*B$k+B$H*B$i-B$L*B$_,B$c=B$Y*B$_+B$L*B$k-B$r*B$i,B$h=-B$L*B$i-B$r*B$k-B$H*B$_;B$p[0]=B$G*B$Y+B$h*-B$L+B$X*-B$H-B$c*-B$r,B$p[1]=B$X*B$Y+B$h*-B$r+B$c*-B$L-B$G*-B$H,B$p[2]=B$c*B$Y+B$h*-B$H+B$G*-B$r-B$X*-B$L},B$r.scalarLength=function(B$O){var B$J=B$O.elements,B$D=B$J[0],B$p=B$J[1],B$m=B$J[2];return Math.sqrt(B$D*B$D+B$p*B$p+B$m*B$m)},B$r.scalarLengthSquared=function(B$O){var B$J=B$O.elements,B$D=B$J[0],B$p=B$J[1],B$m=B$J[2];return B$D*B$D+B$p*B$p+B$m*B$m},B$r.normalize=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0],B$C=B$D[1],B$i=B$D[2],B$k=B$m*B$m+B$C*B$C+B$i*B$i;0<B$k&&(B$k=1/Math.sqrt(B$k),B$p[0]=B$D[0]*B$k,B$p[1]=B$D[1]*B$k,B$p[2]=B$D[2]*B$k)},B$r.multiply=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]*B$C[0],B$p[1]=B$m[1]*B$C[1],B$p[2]=B$m[2]*B$C[2]},B$r.scale=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements;B$p[0]=B$m[0]*B$J,B$p[1]=B$m[1]*B$J,B$p[2]=B$m[2]*B$J},B$r.lerp=function(B$O,B$J,B$D,B$p){var B$m=B$p.elements,B$C=B$O.elements,B$i=B$J.elements,B$k=B$C[0],B$_=B$C[1],B$L=B$C[2];B$m[0]=B$k+B$D*(B$i[0]-B$k),B$m[1]=B$_+B$D*(B$i[1]-B$_),B$m[2]=B$L+B$D*(B$i[2]-B$L)},B$r.transformV3ToV3=function(B$O,B$J,B$D){var B$p=B$r._tempVector4;B$r.transformV3ToV4(B$O,B$J,B$p);var B$m=B$p.elements,B$C=B$D.elements;B$C[0]=B$m[0],B$C[1]=B$m[1],B$C[2]=B$m[2]},B$r.transformV3ToV4=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$J.elements,B$_=B$D.elements;B$_[0]=B$m*B$k[0]+B$C*B$k[4]+B$i*B$k[8]+B$k[12],B$_[1]=B$m*B$k[1]+B$C*B$k[5]+B$i*B$k[9]+B$k[13],B$_[2]=B$m*B$k[2]+B$C*B$k[6]+B$i*B$k[10]+B$k[14],B$_[3]=B$m*B$k[3]+B$C*B$k[7]+B$i*B$k[11]+B$k[15]},B$r.TransformNormal=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$J.elements,B$_=B$D.elements;B$_[0]=B$m*B$k[0]+B$C*B$k[4]+B$i*B$k[8],B$_[1]=B$m*B$k[1]+B$C*B$k[5]+B$i*B$k[9],B$_[2]=B$m*B$k[2]+B$C*B$k[6]+B$i*B$k[10]},B$r.transformCoordinate=function(B$O,B$J,B$D){var B$p=B$r._tempVector4.elements,B$m=B$O.elements,B$C=B$m[0],B$i=B$m[1],B$k=B$m[2],B$_=B$J.elements;B$p[0]=B$C*B$_[0]+B$i*B$_[4]+B$k*B$_[8]+B$_[12],B$p[1]=B$C*B$_[1]+B$i*B$_[5]+B$k*B$_[9]+B$_[13],B$p[2]=B$C*B$_[2]+B$i*B$_[6]+B$k*B$_[10]+B$_[14],B$p[3]=1/(B$C*B$_[3]+B$i*B$_[7]+B$k*B$_[11]+B$_[15]);var B$L=B$D.elements;B$L[0]=B$p[0]*B$p[3],B$L[1]=B$p[1]*B$p[3],B$L[2]=B$p[2]*B$p[3]},B$r.Clamp=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements,B$C=B$m[0],B$i=B$m[1],B$k=B$m[2],B$_=B$J.elements,B$L=B$_[0],B$r=B$_[1],B$H=B$_[2],B$Y=B$D.elements,B$G=B$Y[0],B$X=B$Y[1],B$c=B$Y[2],B$h=B$p.elements;B$C=(B$C=B$G<B$C?B$G:B$C)<B$L?B$L:B$C,B$i=(B$i=B$X<B$i?B$X:B$i)<B$r?B$r:B$i,B$k=(B$k=B$c<B$k?B$c:B$k)<B$H?B$H:B$k,B$h[0]=B$C,B$h[1]=B$i,B$h[2]=B$k},B$r.add=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]+B$C[0],B$p[1]=B$m[1]+B$C[1],B$p[2]=B$m[2]+B$C[2]},B$r.subtract=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]-B$C[0],B$p[1]=B$m[1]-B$C[1],B$p[2]=B$m[2]-B$C[2]},B$r.cross=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$J.elements,B$C=B$D.elements,B$i=B$p[0],B$k=B$p[1],B$_=B$p[2],B$L=B$m[0],B$r=B$m[1],B$H=B$m[2];B$C[0]=B$k*B$H-B$_*B$r,B$C[1]=B$_*B$L-B$i*B$H,B$C[2]=B$i*B$r-B$k*B$L},B$r.dot=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;return B$D[0]*B$p[0]+B$D[1]*B$p[1]+B$D[2]*B$p[2]},B$r.equals=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;return B$KO.nearEqual(Math.abs(B$D[0]),Math.abs(B$p[0]))&&B$KO.nearEqual(Math.abs(B$D[1]),Math.abs(B$p[1]))&&B$KO.nearEqual(Math.abs(B$D[2]),Math.abs(B$p[2]))},B$r.ZERO=new B$r(0,0,0),B$r.ONE=new B$r(1,1,1),B$r.NegativeUnitX=new B$r(-1,0,0),B$r.UnitX=new B$r(1,0,0),B$r.UnitY=new B$r(0,1,0),B$r.UnitZ=new B$r(0,0,1),B$r.ForwardRH=new B$r(0,0,-1),B$r.ForwardLH=new B$r(0,0,1),B$r.Up=new B$r(0,1,0),B$r.NAN=new B$r(NaN,NaN,NaN),B$H(B$r,["_tempVector4",function(){return this._tempVector4=new B$kJ}]),B$r}(),B$kJ=function(){function B$O(B$O,B$J,B$D,B$p){this.elements=new Float32Array(4),void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=0);var B$m=this.elements;B$m[0]=B$O,B$m[1]=B$J,B$m[2]=B$D,B$m[3]=B$p}B$G(B$O,"laya.d3.math.Vector4");var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J.fromArray=function(B$O,B$J){void 0===B$J&&(B$J=0),this.elements[0]=B$O[B$J+0],this.elements[1]=B$O[B$J+1],this.elements[2]=B$O[B$J+2],this.elements[3]=B$O[B$J+3]},B$J.cloneTo=function(B$O){var B$J=B$O.elements,B$D=this.elements;B$J[0]=B$D[0],B$J[1]=B$D[1],B$J[2]=B$D[2],B$J[3]=B$D[3]},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$J.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},B$J.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},B$X(0,B$J,"x",function(){return this.elements[0]},function(B$O){this.elements[0]=B$O}),B$X(0,B$J,"y",function(){return this.elements[1]},function(B$O){this.elements[1]=B$O}),B$X(0,B$J,"z",function(){return this.elements[2]},function(B$O){this.elements[2]=B$O}),B$X(0,B$J,"w",function(){return this.elements[3]},function(B$O){this.elements[3]=B$O}),B$O.lerp=function(B$O,B$J,B$D,B$p){var B$m=B$p.elements,B$C=B$O.elements,B$i=B$J.elements,B$k=B$C[0],B$_=B$C[1],B$L=B$C[2],B$r=B$C[3];B$m[0]=B$k+B$D*(B$i[0]-B$k),B$m[1]=B$_+B$D*(B$i[1]-B$_),B$m[2]=B$L+B$D*(B$i[2]-B$L),B$m[3]=B$r+B$D*(B$i[3]-B$r)},B$O.transformByM4x4=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$p[0],B$C=B$p[1],B$i=B$p[2],B$k=B$p[3],B$_=B$J.elements,B$L=B$D.elements;B$L[0]=B$m*B$_[0]+B$C*B$_[4]+B$i*B$_[8]+B$k*B$_[12],B$L[1]=B$m*B$_[1]+B$C*B$_[5]+B$i*B$_[9]+B$k*B$_[13],B$L[2]=B$m*B$_[2]+B$C*B$_[6]+B$i*B$_[10]+B$k*B$_[14],B$L[3]=B$m*B$_[3]+B$C*B$_[7]+B$i*B$_[11]+B$k*B$_[15]},B$O.equals=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;return B$KO.nearEqual(Math.abs(B$D[0]),Math.abs(B$p[0]))&&B$KO.nearEqual(Math.abs(B$D[1]),Math.abs(B$p[1]))&&B$KO.nearEqual(Math.abs(B$D[2]),Math.abs(B$p[2]))&&B$KO.nearEqual(Math.abs(B$D[3]),Math.abs(B$p[3]))},B$O.normalize=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$O.length();0<B$m&&(B$p[0]=B$D[0]*B$m,B$p[1]=B$D[1]*B$m,B$p[2]=B$D[2]*B$m,B$p[3]=B$D[3]*B$m)},B$O.add=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]+B$C[0],B$p[1]=B$m[1]+B$C[1],B$p[2]=B$m[2]+B$C[2],B$p[3]=B$m[3]+B$C[3]},B$O.subtract=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]-B$C[0],B$p[1]=B$m[1]-B$C[1],B$p[2]=B$m[2]-B$C[2],B$p[3]=B$m[3]-B$C[3]},B$O.multiply=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=B$m[0]*B$C[0],B$p[1]=B$m[1]*B$C[1],B$p[2]=B$m[2]*B$C[2],B$p[3]=B$m[3]*B$C[3]},B$O.scale=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements;B$p[0]=B$m[0]*B$J,B$p[1]=B$m[1]*B$J,B$p[2]=B$m[2]*B$J,B$p[3]=B$m[3]*B$J},B$O.Clamp=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements,B$C=B$m[0],B$i=B$m[1],B$k=B$m[2],B$_=B$m[3],B$L=B$J.elements,B$r=B$L[0],B$H=B$L[1],B$Y=B$L[2],B$G=B$L[3],B$X=B$D.elements,B$c=B$X[0],B$h=B$X[1],B$y=B$X[2],B$v=B$X[3],B$A=B$p.elements;B$C=(B$C=B$c<B$C?B$c:B$C)<B$r?B$r:B$C,B$i=(B$i=B$h<B$i?B$h:B$i)<B$H?B$H:B$i,B$k=(B$k=B$y<B$k?B$y:B$k)<B$Y?B$Y:B$k,B$_=(B$_=B$v<B$_?B$v:B$_)<B$G?B$G:B$_,B$A[0]=B$C,B$A[1]=B$i,B$A[2]=B$k,B$A[3]=B$_},B$O.distanceSquared=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0]-B$p[0],B$C=B$D[1]-B$p[1],B$i=B$D[2]-B$p[2],B$k=B$D[3]-B$p[3];return B$m*B$m+B$C*B$C+B$i*B$i+B$k*B$k},B$O.distance=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements,B$m=B$D[0]-B$p[0],B$C=B$D[1]-B$p[1],B$i=B$D[2]-B$p[2],B$k=B$D[3]-B$p[3];return Math.sqrt(B$m*B$m+B$C*B$C+B$i*B$i+B$k*B$k)},B$O.dot=function(B$O,B$J){var B$D=B$O.elements,B$p=B$J.elements;return B$D[0]*B$p[0]+B$D[1]*B$p[1]+B$D[2]*B$p[2]+B$D[3]*B$p[3]},B$O.min=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=Math.min(B$m[0],B$C[0]),B$p[1]=Math.min(B$m[1],B$C[1]),B$p[2]=Math.min(B$m[2],B$C[2]),B$p[3]=Math.min(B$m[3],B$C[3])},B$O.max=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J.elements;B$p[0]=Math.max(B$m[0],B$C[0]),B$p[1]=Math.max(B$m[1],B$C[1]),B$p[2]=Math.max(B$m[2],B$C[2]),B$p[3]=Math.max(B$m[3],B$C[3])},B$H(B$O,["ZERO",function(){return this.ZERO=new B$O},"ONE",function(){return this.ONE=new B$O(1,1,1,1)},"UnitX",function(){return this.UnitX=new B$O(1,0,0,0)},"UnitY",function(){return this.UnitY=new B$O(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new B$O(0,0,1,0)},"UnitW",function(){return this.UnitW=new B$O(0,0,0,1)}]),B$O}(),B$_J=function(){function B$C(B$O,B$J,B$D,B$p){this.minDepth=0,this.maxDepth=1,this.x=B$O,this.y=B$J,this.width=B$D,this.height=B$p}B$G(B$C,"laya.d3.math.Viewport");var B$O=B$C.prototype;return B$O.project=function(B$O,B$J,B$D){B$iJ.transformV3ToV3(B$O,B$J,B$D);var B$p=B$O.elements,B$m=B$J.elements,B$C=B$D.elements,B$i=B$p[0]*B$m[3]+B$p[1]*B$m[7]+B$p[2]*B$m[11]+B$m[15];1!==B$i&&(B$C[0]=B$C[0]/B$i,B$C[1]=B$C[1]/B$i,B$C[2]=B$C[2]/B$i),B$C[0]=.5*(B$C[0]+1)*this.width+this.x,B$C[1]=.5*(1-B$C[1])*this.height+this.y,B$C[2]=B$C[2]*(this.maxDepth-this.minDepth)+this.minDepth},B$O.unprojectFromMat=function(B$O,B$J,B$D){var B$p=B$O.elements,B$m=B$J.elements,B$C=B$D.elements;B$C[0]=(B$p[0]-this.x)/this.width*2-1,B$C[1]=-((B$p[1]-this.y)/this.height*2-1);var B$i=(this.maxDepth-this.minDepth)/2;B$C[2]=(B$p[2]-this.minDepth-B$i)/B$i;var B$k=B$C[0]*B$m[3]+B$C[1]*B$m[7]+B$C[2]*B$m[11]+B$m[15];B$iJ.transformV3ToV3(B$D,B$J,B$D),1!==B$k&&(B$C[0]=B$C[0]/B$k,B$C[1]=B$C[1]/B$k,B$C[2]=B$C[2]/B$k)},B$O.unprojectFromWVP=function(B$O,B$J,B$D,B$p,B$m){B$OJ.multiply(B$J,B$D,B$C._tempMatrix4x4),B$p&&B$OJ.multiply(B$C._tempMatrix4x4,B$p,B$C._tempMatrix4x4),B$C._tempMatrix4x4.invert(B$C._tempMatrix4x4),this.unprojectFromMat(B$O,B$C._tempMatrix4x4,B$m)},B$H(B$C,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new B$OJ}]),B$C}(),B$LJ=function(){function B$s(B$O){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=B$O,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}B$G(B$s,"laya.d3.resource.models.SubMesh");var B$O=B$s.prototype;return B$d.imps(B$O,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),B$O._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),0===B$O?this._vertexBuffer:null},B$O._getIndexBuffer=function(){return this._indexBuffer},B$O._getStaticBatchBakedVertexs=function(B$O,B$J){var B$D,B$p,B$m=this._vertexBuffer,B$C=B$m.vertexDeclaration,B$i=B$C.getVertexElementByUsage(0).offset/4,B$k=B$C.getVertexElementByUsage(3).offset/4,B$_=B$J.meshRender.lightmapScaleOffset,B$L=0,B$r=0,B$H=0,B$Y=0,B$G=0,B$X=0;if(B$_)if(B$p=B$C.getVertexElementByUsage(15))B$H=B$C.vertexStride/4,B$D=0<this._vertexCount?B$m.getData().slice(this._vertexStart*B$H,(this._vertexStart+this._vertexCount)*B$H):B$m.getData().slice(),B$Y=B$p.offset/4;else{B$H=(B$X=B$C.vertexStride/4)+2,B$D=this._vertexCount?new Float32Array(this._vertexCount*(B$m.vertexDeclaration.vertexStride/4+2)):new Float32Array(B$m.vertexCount*(B$m.vertexDeclaration.vertexStride/4+2)),B$Y=(B$G=B$C.getVertexElementByUsage(2).offset/4)+2;var B$c=B$m.getData();for(B$L=0,B$r=B$c.length/B$X;B$L<B$r;B$L++){var B$h=0;B$h=0<this._vertexCount?(this._vertexStart+B$L)*B$X:B$L*B$X;var B$y=B$L*B$H,B$v=0;for(B$v=0;B$v<B$Y;B$v++)B$D[B$y+B$v]=B$c[B$h+B$v];for(B$v=B$Y;B$v<B$X;B$v++)B$D[B$y+B$v+2]=B$c[B$h+B$v]}}else B$H=B$C.vertexStride/4,B$D=this._vertexCount?B$m.getData().slice(this._vertexStart*B$H,(this._vertexStart+this._vertexCount)*B$H):B$m.getData().slice();if(B$O){var B$A=B$O.worldMatrix,B$q=B$s._tempMatrix4x40;B$A.invert(B$q);var B$d=B$s._tempMatrix4x41,B$M=B$J.transform.worldMatrix;B$OJ.multiply(B$q,B$M,B$d)}else B$d=B$J.transform.worldMatrix;var B$a=B$s._tempQuaternion0;for(B$d.decomposeTransRotScale(B$s._tempVector30,B$a,B$s._tempVector31),B$L=0,B$r=B$D.length/B$H;B$L<B$r;B$L++){var B$e=B$L*B$H+B$i,B$t=B$L*B$H+B$k;if(B$hJ.transformVector3ArrayToVector3ArrayCoordinate(B$D,B$e,B$d,B$D,B$e),B$hJ.transformVector3ArrayByQuat(B$D,B$t,B$a,B$D,B$t),B$_){var B$z=B$L*B$H+B$Y;if(B$p)B$hJ.transformLightingMapTexcoordByUV1Array(B$D,B$z,B$_,B$D,B$z);else{var B$g=B$L*B$X+B$G;B$hJ.transformLightingMapTexcoordByUV0Array(B$c,B$g,B$_,B$D,B$z)}}}return B$D},B$O._getVertexBuffers=function(){return null},B$O._beforeRender=function(B$O){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},B$O._render=function(B$O){var B$J,B$D=0,B$p=B$O.renderElement;if(1<this._indexCount){var B$m=this._boneIndicesList.length;if(1<B$m){for(var B$C=0;B$C<B$m;B$C++)(B$J=B$p._skinAnimationDatas||this._skinAnimationDatas)&&(B$p._shaderValue.setValue(0,B$J[B$C]),B$O._shader.uploadRenderElementUniforms(B$p._shaderValue.data)),B$P.mainContext.drawElements(4,this._subIndexBufferCount[B$C],5123,2*this._subIndexBufferStart[B$C]);B$e.drawCall+=B$m}else(B$J=B$p._skinAnimationDatas||this._skinAnimationDatas)&&(B$p._shaderValue.setValue(0,B$J[0]),B$O._shader.uploadRenderElementUniforms(B$p._shaderValue.data)),B$P.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),B$e.drawCall++;B$D=this._indexCount}else B$D=this._indexBuffer.indexCount,(B$J=B$p._skinAnimationDatas||this._skinAnimationDatas)&&(B$p._shaderValue.setValue(0,B$J[0]),B$O._shader.uploadRenderElementUniforms(B$p._shaderValue.data)),B$P.mainContext.drawElements(4,B$D,5123,0),B$e.drawCall++;B$e.trianglesFaces+=B$D/3},B$O.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},B$O.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},B$X(0,B$O,"_vertexBufferCount",function(){return 1}),B$X(0,B$O,"triangleCount",function(){return this._indexBuffer.indexCount/3}),B$H(B$s,["_tempVector30",function(){return this._tempVector30=new B$iJ},"_tempVector31",function(){return this._tempVector31=new B$iJ},"_tempQuaternion0",function(){return this._tempQuaternion0=new B$DJ},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new B$OJ},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new B$OJ}]),B$s}(),B$rJ=function(){function B$O(B$O){this.defineCounter=0,this.defines=null,B$O?(this.defineCounter=B$O.defineCounter,this.defines=B$O.defines.slice()):(this.defineCounter=0,this.defines=[])}return B$G(B$O,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),B$O.prototype.registerDefine=function(B$O){var B$J=Math.pow(2,this.defineCounter++);return this.defines[B$J]=B$O,B$J},B$O}(),B$HJ=function(){function B$O(){}return B$G(B$O,"laya.d3.shader.ShaderInit3D"),B$O.__init__=function(){var B$O,B$J;B$eJ._globalRegDefine("HIGHPRECISION",B$eJ.SHADERDEFINE_HIGHPRECISION),B$eJ._globalRegDefine("FOG",B$eJ.SHADERDEFINE_FOG),B$eJ._globalRegDefine("DIRECTIONLIGHT",B$eJ.SHADERDEFINE_DIRECTIONLIGHT),B$eJ._globalRegDefine("POINTLIGHT",B$eJ.SHADERDEFINE_POINTLIGHT),B$eJ._globalRegDefine("SPOTLIGHT",B$eJ.SHADERDEFINE_SPOTLIGHT),B$eJ._globalRegDefine("UV",B$eJ.SHADERDEFINE_UV0),B$eJ._globalRegDefine("COLOR",B$eJ.SHADERDEFINE_COLOR),B$eJ._globalRegDefine("UV1",B$eJ.SHADERDEFINE_UV1),B$eJ._globalRegDefine("CASTSHADOW",B$GJ.SHADERDEFINE_CAST_SHADOW),B$eJ._globalRegDefine("SHADOWMAP_PSSM1",B$GJ.SHADERDEFINE_SHADOW_PSSM1),B$eJ._globalRegDefine("SHADOWMAP_PSSM2",B$GJ.SHADERDEFINE_SHADOW_PSSM2),B$eJ._globalRegDefine("SHADOWMAP_PSSM3",B$GJ.SHADERDEFINE_SHADOW_PSSM3),B$eJ._globalRegDefine("SHADOWMAP_PCF_NO",B$GJ.SHADERDEFINE_SHADOW_PCF_NO),B$eJ._globalRegDefine("SHADOWMAP_PCF1",B$GJ.SHADERDEFINE_SHADOW_PCF1),B$eJ._globalRegDefine("SHADOWMAP_PCF2",B$GJ.SHADERDEFINE_SHADOW_PCF2),B$eJ._globalRegDefine("SHADOWMAP_PCF3",B$GJ.SHADERDEFINE_SHADOW_PCF3),B$eJ._globalRegDefine("DEPTHFOG",B$eJ.SAHDERDEFINE_DEPTHFOG),B$RJ.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),B$RJ.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),B$O={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},B$J={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var B$D=B$RJ.nameKey.add("SIMPLE");shaderCompile=B$eJ.add(B$D,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',B$O,B$J),B$jJ.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),B$jJ.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),B$jJ.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),B$jJ.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),B$jJ.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),B$jJ.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),B$jJ.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),B$jJ.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),B$jJ.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},B$O}(),B$YJ=function(){function B$O(){this._data=null,this._data=[]}B$G(B$O,"laya.d3.shader.ValusArray");var B$J=B$O.prototype;return B$J.setValue=function(B$O,B$J){this._data[B$O]=B$J},B$X(0,B$J,"data",function(){return this._data}),B$O}(),B$GJ=function(){function B$O(){}return B$O.SHADERDEFINE_RECEIVE_SHADOW=1,B$O.SHADERDEFINE_CAST_SHADOW=512,B$O.SHADERDEFINE_SHADOW_PSSM1=1024,B$O.SHADERDEFINE_SHADOW_PSSM2=2048,B$O.SHADERDEFINE_SHADOW_PSSM3=4096,B$O.SHADERDEFINE_SHADOW_PCF_NO=8192,B$O.SHADERDEFINE_SHADOW_PCF1=16384,B$O.SHADERDEFINE_SHADOW_PCF2=32768,B$O.SHADERDEFINE_SHADOW_PCF3=65536,B$O.MAX_PSSM_COUNT=3,B$O}(),B$XJ=function(){function B$n(){}return B$G(B$n,"laya.d3.utils.Picker"),B$n.calculateCursorRay=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$O.elements[0],B$k=B$O.elements[1],B$_=B$n._tempVector30,B$L=B$_.elements;B$L[0]=B$i,B$L[1]=B$k,B$L[2]=B$J.minDepth;var B$r=B$n._tempVector31,B$H=B$r.elements;B$H[0]=B$i,B$H[1]=B$k,B$H[2]=B$J.maxDepth;var B$Y=B$C.origin,B$G=B$n._tempVector32;B$J.unprojectFromWVP(B$_,B$D,B$p,B$m,B$Y),B$J.unprojectFromWVP(B$r,B$D,B$p,B$m,B$G);var B$X=B$C.direction.elements;B$X[0]=B$G.x-B$Y.x,B$X[1]=B$G.y-B$Y.y,B$X[2]=B$G.z-B$Y.z,B$iJ.normalize(B$C.direction,B$C.direction)},B$n.rayIntersectsPositionsAndIndices=function(B$O,B$J,B$D,B$p,B$m){for(var B$C=B$D.vertexStride/4,B$i=B$D.getVertexElementByUsage(0).offset/4,B$k=Number.MAX_VALUE,B$_=-1,B$L=-1,B$r=-1,B$H=0;B$H<B$p.length;B$H+=3){var B$Y=B$n._tempVector35,B$G=B$Y.elements,B$X=B$p[B$H]*B$C,B$c=B$X+B$i;B$G[0]=B$J[B$c],B$G[1]=B$J[1+B$c],B$G[2]=B$J[2+B$c];var B$h=B$n._tempVector36,B$y=B$h.elements,B$v=B$p[B$H+1]*B$C,B$A=B$v+B$i;B$y[0]=B$J[B$A],B$y[1]=B$J[1+B$A],B$y[2]=B$J[2+B$A];var B$q=B$n._tempVector37,B$d=B$q.elements,B$M=B$p[B$H+2]*B$C,B$a=B$M+B$i;B$d[0]=B$J[B$a],B$d[1]=B$J[1+B$a],B$d[2]=B$J[2+B$a];var B$e=laya.d3.utils.Picker.rayIntersectsTriangle(B$O,B$Y,B$h,B$q);!isNaN(B$e)&&B$e<B$k&&(B$k=B$e,B$_=B$X,B$L=B$v,B$r=B$M)}if(B$k===Number.MAX_VALUE)return B$m.position.toDefault(),B$m.distance=Number.MAX_VALUE,B$m.trianglePositions[0].toDefault(),B$m.trianglePositions[1].toDefault(),B$m.trianglePositions[2].toDefault(),B$m.triangleNormals[0].toDefault(),B$m.triangleNormals[1].toDefault(),B$m.triangleNormals[2].toDefault(),!1;B$m.distance=B$k,B$iJ.scale(B$O.direction,B$k,B$m.position),B$iJ.add(B$O.origin,B$m.position,B$m.position);var B$t=B$m.trianglePositions,B$z=B$t[0],B$g=B$t[1],B$s=B$t[2],B$P=B$z.elements,B$E=B$g.elements,B$o=B$s.elements,B$W=B$_+B$i;B$P[0]=B$J[B$W],B$P[1]=B$J[B$W+1],B$P[2]=B$J[B$W+2];var B$N=B$L+B$i;B$E[0]=B$J[B$N],B$E[1]=B$J[B$N+1],B$E[2]=B$J[B$N+2];var B$F=B$r+B$i;B$o[0]=B$J[B$F],B$o[1]=B$J[B$F+1],B$o[2]=B$J[B$F+2];var B$R=B$D.getVertexElementByUsage(3);if(B$R){var B$j=B$R.offset/4,B$u=B$m.triangleNormals,B$l=B$u[0],B$$=B$u[1],B$x=B$u[2],B$V=B$l.elements,B$T=B$$.elements,B$I=B$x.elements,B$w=B$_+B$j;B$V[0]=B$J[B$w],B$V[1]=B$J[B$w+1],B$V[2]=B$J[B$w+2];var B$U=B$L+B$j;B$T[0]=B$J[B$U],B$T[1]=B$J[B$U+1],B$T[2]=B$J[B$U+2];var B$Z=B$r+B$j;B$I[0]=B$J[B$Z],B$I[1]=B$J[B$Z+1],B$I[2]=B$J[B$Z+2]}return!0},B$n.rayIntersectsTriangle=function(B$O,B$J,B$D,B$p){var B$m=B$n._tempVector30,B$C=B$n._tempVector31;B$iJ.subtract(B$D,B$J,B$m),B$iJ.subtract(B$p,B$J,B$C);var B$i,B$k=B$n._tempVector32;if(B$iJ.cross(B$O.direction,B$C,B$k),(B$i=B$iJ.dot(B$m,B$k))>-Number.MIN_VALUE&&B$i<Number.MIN_VALUE)return Number.NaN;var B$_,B$L=1/B$i,B$r=B$n._tempVector33;if(B$iJ.subtract(B$O.origin,B$J,B$r),B$_=B$iJ.dot(B$r,B$k),(B$_*=B$L)<0||1<B$_)return Number.NaN;var B$H,B$Y,B$G=B$n._tempVector34;return B$iJ.cross(B$r,B$m,B$G),B$H=B$iJ.dot(B$O.direction,B$G),(B$H*=B$L)<0||1<B$_+B$H?Number.NaN:(B$Y=B$iJ.dot(B$C,B$G),(B$Y*=B$L)<0?Number.NaN:B$Y)},B$H(B$n,["_tempVector30",function(){return this._tempVector30=new B$iJ},"_tempVector31",function(){return this._tempVector31=new B$iJ},"_tempVector32",function(){return this._tempVector32=new B$iJ},"_tempVector33",function(){return this._tempVector33=new B$iJ},"_tempVector34",function(){return this._tempVector34=new B$iJ},"_tempVector35",function(){return this._tempVector35=new B$iJ},"_tempVector36",function(){return this._tempVector36=new B$iJ},"_tempVector37",function(){return this._tempVector37=new B$iJ}]),B$n}(),B$cJ=(function(){function B$O(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new B$iJ,new B$iJ,new B$iJ],this.trianglePositions.length=3,this.triangleNormals=[new B$iJ,new B$iJ,new B$iJ],this.triangleNormals.length=3,this.position=new B$iJ}B$G(B$O,"laya.d3.utils.RaycastHit"),B$O.prototype.cloneTo=function(B$O){B$O.distance=this.distance,this.trianglePositions[0].cloneTo(B$O.trianglePositions[0]),this.trianglePositions[1].cloneTo(B$O.trianglePositions[1]),this.trianglePositions[2].cloneTo(B$O.trianglePositions[2]),this.triangleNormals[0].cloneTo(B$O.triangleNormals[0]),this.triangleNormals[1].cloneTo(B$O.triangleNormals[1]),this.triangleNormals[2].cloneTo(B$O.triangleNormals[2]),this.position.cloneTo(B$O.position),B$O.sprite3D=this.sprite3D}}(),function(){function B$O(B$O,B$J){this._width=0,this._height=0,this._width=B$O,this._height=B$J}B$G(B$O,"laya.d3.utils.Size");var B$J=B$O.prototype;return B$X(0,B$J,"width",function(){return-1===this._width?B$B.clientWidth:this._width}),B$X(0,B$J,"height",function(){return-1===this._height?B$B.clientHeight:this._height}),B$X(1,B$O,"fullScreen",function(){return new B$O(-1,-1)}),B$O}()),B$hJ=function(){function B$W(){}return B$G(B$W,"laya.d3.utils.Utils3D"),B$W._rotationTransformScaleSkinAnimation=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H){var B$Y,B$G,B$X,B$c,B$h,B$y=B$W._tempArray16_0,B$v=B$W._tempArray16_1,B$A=B$W._tempArray16_2,B$q=B$p+B$p,B$d=B$m+B$m,B$M=B$C+B$C,B$a=B$p*B$q,B$e=B$m*B$q,B$t=B$m*B$d,B$z=B$C*B$q,B$g=B$C*B$d,B$s=B$C*B$M,B$P=B$i*B$q,B$E=B$i*B$d,B$o=B$i*B$M;for(B$y[15]=1,B$y[0]=1-B$t-B$s,B$y[1]=B$e+B$o,B$y[2]=B$z-B$E,B$y[4]=B$e-B$o,B$y[5]=1-B$a-B$s,B$y[6]=B$g+B$P,B$y[8]=B$z+B$E,B$y[9]=B$g-B$P,B$y[10]=1-B$a-B$t,B$v[15]=1,B$v[0]=B$k,B$v[5]=B$_,B$v[10]=B$L,B$Y=0;B$Y<4;B$Y++)B$G=B$y[B$Y],B$X=B$y[B$Y+4],B$c=B$y[B$Y+8],B$h=B$y[B$Y+12],B$A[B$Y]=B$G,B$A[B$Y+4]=B$X,B$A[B$Y+8]=B$c,B$A[B$Y+12]=B$G*B$O+B$X*B$J+B$c*B$D+B$h;for(B$Y=0;B$Y<4;B$Y++)B$G=B$A[B$Y],B$X=B$A[B$Y+4],B$c=B$A[B$Y+8],B$h=B$A[B$Y+12],B$r[B$Y+B$H]=B$G*B$v[0]+B$X*B$v[1]+B$c*B$v[2]+B$h*B$v[3],B$r[B$Y+B$H+4]=B$G*B$v[4]+B$X*B$v[5]+B$c*B$v[6]+B$h*B$v[7],B$r[B$Y+B$H+8]=B$G*B$v[8]+B$X*B$v[9]+B$c*B$v[10]+B$h*B$v[11],B$r[B$Y+B$H+12]=B$G*B$v[12]+B$X*B$v[13]+B$c*B$v[14]+B$h*B$v[15]},B$W._createNodeByJson=function(B$O,B$J,B$D,B$p){if(!B$D)switch(B$J.type){case"Sprite3D":B$D=new B$FJ;break;case"MeshSprite3D":B$D=new B$nJ;break;case"SkinnedMeshSprite3D":B$D=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":B$D=new ShuriKenParticle3D;break;case"TrailSprite3D":B$D=new TrailSprite3D;break;case"Terrain":B$D=new Terrain;break;case"Camera":B$D=new B$ZJ;break;case"DirectionLight":B$D=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var B$m=B$J.props;if(B$m)for(var B$C in B$m)B$D[B$C]=B$m[B$C];var B$i=B$J.customProps;B$i&&(B$D instanceof laya.d3.core.Sprite3D?(B$D._parseBaseCustomProps(B$i),B$D._parseCustomProps(B$O,B$p,B$i,B$J),B$D._parseCustomComponent(B$O,B$p,B$J.components)):B$D._parseCustomProps(B$O,B$p,B$i,B$J));var B$k=B$J.child;if(B$k)for(var B$_=0,B$L=B$k.length;B$_<B$L;B$_++){var B$r=B$W._createNodeByJson(B$O,B$k[B$_],null,B$p);B$D.addChild(B$r)}return B$D},B$W._computeBoneAndAnimationDatasByBindPoseMatrxix=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k,B$_=0,B$L=0,B$r=B$O.length;for(B$i=0;B$i<B$r;B$_+=B$O[B$i].keyframeWidth,B$L+=16,B$i++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(B$J[B$_+0],B$J[B$_+1],B$J[B$_+2],B$J[B$_+3],B$J[B$_+4],B$J[B$_+5],B$J[B$_+6],B$J[B$_+7],B$J[B$_+8],B$J[B$_+9],B$p,B$L),0!=B$i&&(B$k=16*B$O[B$i].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(B$p,B$k,B$p,B$L,B$p,B$L));var B$H=B$D.length;for(B$i=0;B$i<B$H;B$i++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(B$p,16*B$C[B$i],B$D[B$i],B$m,16*B$i)},B$W._computeAnimationDatasByArrayAndMatrixFast=function(B$O,B$J,B$D,B$p){for(var B$m=0,B$C=B$O.length;B$m<B$C;B$m++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(B$J,16*B$p[B$m],B$O[B$m],B$D,16*B$m)},B$W._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i,B$k=0,B$_=0,B$L=B$O.length;for(B$C=0;B$C<B$L;B$k+=B$O[B$C].keyframeWidth,B$_+=16,B$C++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(B$J[B$k+7],B$J[B$k+8],B$J[B$k+9],B$J[B$k+3],B$J[B$k+4],B$J[B$k+5],B$J[B$k+6],B$J[B$k+0],B$J[B$k+1],B$J[B$k+2],B$p,B$_),0!=B$C&&(B$i=16*B$O[B$C].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(B$p,B$i,B$p,B$_,B$p,B$_));var B$r=B$D.length;for(B$C=0;B$C<B$r;B$C++){var B$H=16*B$C;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(B$p,B$H,B$D[B$C],B$m,B$H)}},B$W._computeAnimationDatasByArrayAndMatrixFastOld=function(B$O,B$J,B$D){for(var B$p=B$O.length,B$m=0;B$m<B$p;B$m++){var B$C=16*B$m;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(B$J,B$C,B$O[B$m],B$D,B$C)}},B$W._computeRootAnimationData=function(B$O,B$J,B$D){for(var B$p=0,B$m=0,B$C=0,B$i=B$O.length;B$p<B$i;B$m+=B$O[B$p].keyframeWidth,B$C+=16,B$p++)laya.d3.utils.Utils3D.createAffineTransformationArray(B$J[B$m+0],B$J[B$m+1],B$J[B$m+2],B$J[B$m+3],B$J[B$m+4],B$J[B$m+5],B$J[B$m+6],B$J[B$m+7],B$J[B$m+8],B$J[B$m+9],B$D,B$C)},B$W.transformVector3ArrayByQuat=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$D.elements,B$i=B$O[B$J],B$k=B$O[B$J+1],B$_=B$O[B$J+2],B$L=B$C[0],B$r=B$C[1],B$H=B$C[2],B$Y=B$C[3],B$G=B$Y*B$i+B$r*B$_-B$H*B$k,B$X=B$Y*B$k+B$H*B$i-B$L*B$_,B$c=B$Y*B$_+B$L*B$k-B$r*B$i,B$h=-B$L*B$i-B$r*B$k-B$H*B$_;B$p[B$m]=B$G*B$Y+B$h*-B$L+B$X*-B$H-B$c*-B$r,B$p[B$m+1]=B$X*B$Y+B$h*-B$r+B$c*-B$L-B$G*-B$H,B$p[B$m+2]=B$c*B$Y+B$h*-B$H+B$G*-B$r-B$X*-B$L},B$W.mulMatrixByArray=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k,B$_,B$L,B$r;if(B$m===B$D){for(B$D=B$W._tempArray16_3,B$i=0;B$i<16;++B$i)B$D[B$i]=B$m[B$C+B$i];B$p=0}for(B$i=0;B$i<4;B$i++)B$k=B$O[B$J+B$i],B$_=B$O[B$J+B$i+4],B$L=B$O[B$J+B$i+8],B$r=B$O[B$J+B$i+12],B$m[B$C+B$i]=B$k*B$D[B$p+0]+B$_*B$D[B$p+1]+B$L*B$D[B$p+2]+B$r*B$D[B$p+3],B$m[B$C+B$i+4]=B$k*B$D[B$p+4]+B$_*B$D[B$p+5]+B$L*B$D[B$p+6]+B$r*B$D[B$p+7],B$m[B$C+B$i+8]=B$k*B$D[B$p+8]+B$_*B$D[B$p+9]+B$L*B$D[B$p+10]+B$r*B$D[B$p+11],B$m[B$C+B$i+12]=B$k*B$D[B$p+12]+B$_*B$D[B$p+13]+B$L*B$D[B$p+14]+B$r*B$D[B$p+15]},B$W.mulMatrixByArrayFast=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k,B$_,B$L,B$r;for(B$i=0;B$i<4;B$i++)B$k=B$O[B$J+B$i],B$_=B$O[B$J+B$i+4],B$L=B$O[B$J+B$i+8],B$r=B$O[B$J+B$i+12],B$m[B$C+B$i]=B$k*B$D[B$p+0]+B$_*B$D[B$p+1]+B$L*B$D[B$p+2]+B$r*B$D[B$p+3],B$m[B$C+B$i+4]=B$k*B$D[B$p+4]+B$_*B$D[B$p+5]+B$L*B$D[B$p+6]+B$r*B$D[B$p+7],B$m[B$C+B$i+8]=B$k*B$D[B$p+8]+B$_*B$D[B$p+9]+B$L*B$D[B$p+10]+B$r*B$D[B$p+11],B$m[B$C+B$i+12]=B$k*B$D[B$p+12]+B$_*B$D[B$p+13]+B$L*B$D[B$p+14]+B$r*B$D[B$p+15]},B$W.mulMatrixByArrayAndMatrixFast=function(B$O,B$J,B$D,B$p,B$m){var B$C,B$i,B$k,B$_,B$L,B$r=B$D.elements,B$H=B$r[0],B$Y=B$r[1],B$G=B$r[2],B$X=B$r[3],B$c=B$r[4],B$h=B$r[5],B$y=B$r[6],B$v=B$r[7],B$A=B$r[8],B$q=B$r[9],B$d=B$r[10],B$M=B$r[11],B$a=B$r[12],B$e=B$r[13],B$t=B$r[14],B$z=B$r[15],B$g=B$J,B$s=B$J+4,B$P=B$J+8,B$E=B$J+12,B$o=B$m,B$W=B$m+4,B$N=B$m+8,B$F=B$m+12;for(B$C=0;B$C<4;B$C++)B$i=B$O[B$g+B$C],B$k=B$O[B$s+B$C],B$_=B$O[B$P+B$C],B$L=B$O[B$E+B$C],B$p[B$o+B$C]=B$i*B$H+B$k*B$Y+B$_*B$G+B$L*B$X,B$p[B$W+B$C]=B$i*B$c+B$k*B$h+B$_*B$y+B$L*B$v,B$p[B$N+B$C]=B$i*B$A+B$k*B$q+B$_*B$d+B$L*B$M,B$p[B$F+B$C]=B$i*B$a+B$k*B$e+B$_*B$t+B$L*B$z},B$W.createAffineTransformationArray=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H){var B$Y=B$p+B$p,B$G=B$m+B$m,B$X=B$C+B$C,B$c=B$p*B$Y,B$h=B$p*B$G,B$y=B$p*B$X,B$v=B$m*B$G,B$A=B$m*B$X,B$q=B$C*B$X,B$d=B$i*B$Y,B$M=B$i*B$G,B$a=B$i*B$X;B$r[B$H+0]=(1-(B$v+B$q))*B$k,B$r[B$H+1]=(B$h+B$a)*B$k,B$r[B$H+2]=(B$y-B$M)*B$k,B$r[B$H+3]=0,B$r[B$H+4]=(B$h-B$a)*B$_,B$r[B$H+5]=(1-(B$c+B$q))*B$_,B$r[B$H+6]=(B$A+B$d)*B$_,B$r[B$H+7]=0,B$r[B$H+8]=(B$y+B$M)*B$L,B$r[B$H+9]=(B$A-B$d)*B$L,B$r[B$H+10]=(1-(B$c+B$v))*B$L,B$r[B$H+11]=0,B$r[B$H+12]=B$O,B$r[B$H+13]=B$J,B$r[B$H+14]=B$D,B$r[B$H+15]=1},B$W.transformVector3ArrayToVector3ArrayCoordinate=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$W._tempArray4_0,B$i=B$O[B$J+0],B$k=B$O[B$J+1],B$_=B$O[B$J+2],B$L=B$D.elements;B$C[0]=B$i*B$L[0]+B$k*B$L[4]+B$_*B$L[8]+B$L[12],B$C[1]=B$i*B$L[1]+B$k*B$L[5]+B$_*B$L[9]+B$L[13],B$C[2]=B$i*B$L[2]+B$k*B$L[6]+B$_*B$L[10]+B$L[14],B$C[3]=1/(B$i*B$L[3]+B$k*B$L[7]+B$_*B$L[11]+B$L[15]),B$p[B$m+0]=B$C[0]*B$C[3],B$p[B$m+1]=B$C[1]*B$C[3],B$p[B$m+2]=B$C[2]*B$C[3]},B$W.transformLightingMapTexcoordByUV0Array=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$D.elements;B$p[B$m+0]=B$O[B$J+0]*B$C[0]+B$C[2],B$p[B$m+1]=(B$O[B$J+1]-1)*B$C[1]+B$C[3]},B$W.transformLightingMapTexcoordByUV1Array=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$D.elements;B$p[B$m+0]=B$O[B$J+0]*B$C[0]+B$C[2],B$p[B$m+1]=1+B$O[B$J+1]*B$C[1]+B$C[3]},B$W.getURLVerion=function(B$O){var B$J=B$O.indexOf("?");return 0<=B$J?B$O.substr(B$J):null},B$W._quaternionCreateFromYawPitchRollArray=function(B$O,B$J,B$D,B$p){var B$m=.5*B$D,B$C=.5*B$J,B$i=.5*B$O,B$k=Math.sin(B$m),B$_=Math.cos(B$m),B$L=Math.sin(B$C),B$r=Math.cos(B$C),B$H=Math.sin(B$i),B$Y=Math.cos(B$i);B$p[0]=B$Y*B$L*B$_+B$H*B$r*B$k,B$p[1]=B$H*B$r*B$_-B$Y*B$L*B$k,B$p[2]=B$Y*B$r*B$k-B$H*B$L*B$_,B$p[3]=B$Y*B$r*B$_+B$H*B$L*B$k},B$W._createAffineTransformationArray=function(B$O,B$J,B$D,B$p){var B$m=B$J[0],B$C=B$J[1],B$i=B$J[2],B$k=B$J[3],B$_=B$m+B$m,B$L=B$C+B$C,B$r=B$i+B$i,B$H=B$m*B$_,B$Y=B$m*B$L,B$G=B$m*B$r,B$X=B$C*B$L,B$c=B$C*B$r,B$h=B$i*B$r,B$y=B$k*B$_,B$v=B$k*B$L,B$A=B$k*B$r,B$q=B$D[0],B$d=B$D[1],B$M=B$D[2];B$p[0]=(1-(B$X+B$h))*B$q,B$p[1]=(B$Y+B$A)*B$q,B$p[2]=(B$G-B$v)*B$q,B$p[3]=0,B$p[4]=(B$Y-B$A)*B$d,B$p[5]=(1-(B$H+B$h))*B$d,B$p[6]=(B$c+B$y)*B$d,B$p[7]=0,B$p[8]=(B$G+B$v)*B$M,B$p[9]=(B$c-B$y)*B$M,B$p[10]=(1-(B$H+B$X))*B$M,B$p[11]=0,B$p[12]=B$O[0],B$p[13]=B$O[1],B$p[14]=B$O[2],B$p[15]=1},B$W._mulMatrixArray=function(B$O,B$J,B$D,B$p){var B$m,B$C,B$i,B$k,B$_,B$L=B$J.elements,B$r=B$L[0],B$H=B$L[1],B$Y=B$L[2],B$G=B$L[3],B$X=B$L[4],B$c=B$L[5],B$h=B$L[6],B$y=B$L[7],B$v=B$L[8],B$A=B$L[9],B$q=B$L[10],B$d=B$L[11],B$M=B$L[12],B$a=B$L[13],B$e=B$L[14],B$t=B$L[15],B$z=B$p,B$g=B$p+4,B$s=B$p+8,B$P=B$p+12;for(B$m=0;B$m<4;B$m++)B$C=B$O[B$m],B$i=B$O[B$m+4],B$k=B$O[B$m+8],B$_=B$O[B$m+12],B$D[B$z+B$m]=B$C*B$r+B$i*B$H+B$k*B$Y+B$_*B$G,B$D[B$g+B$m]=B$C*B$X+B$i*B$c+B$k*B$h+B$_*B$y,B$D[B$s+B$m]=B$C*B$v+B$i*B$A+B$k*B$q+B$_*B$d,B$D[B$P+B$m]=B$C*B$M+B$i*B$a+B$k*B$e+B$_*B$t},B$W.getYawPitchRoll=function(B$O,B$J){B$W.transformQuat(B$iJ.ForwardRH,B$O,B$DJ.TEMPVector31),B$W.transformQuat(B$iJ.Up,B$O,B$DJ.TEMPVector32);var B$D=B$DJ.TEMPVector32.elements;B$W.angleTo(B$iJ.ZERO,B$DJ.TEMPVector31,B$DJ.TEMPVector33);var B$p=B$DJ.TEMPVector33.elements;B$p[0]==Math.PI/2?(B$p[1]=B$W.arcTanAngle(B$D[2],B$D[0]),B$p[2]=0):B$p[0]==-Math.PI/2?(B$p[1]=B$W.arcTanAngle(-B$D[2],-B$D[0]),B$p[2]=0):(B$OJ.createRotationY(-B$p[1],B$DJ.TEMPMatrix0),B$OJ.createRotationX(-B$p[0],B$DJ.TEMPMatrix1),B$iJ.transformCoordinate(B$DJ.TEMPVector32,B$DJ.TEMPMatrix0,B$DJ.TEMPVector32),B$iJ.transformCoordinate(B$DJ.TEMPVector32,B$DJ.TEMPMatrix1,B$DJ.TEMPVector32),B$p[2]=B$W.arcTanAngle(B$D[1],-B$D[0])),B$p[1]<=-Math.PI&&(B$p[1]=Math.PI),B$p[2]<=-Math.PI&&(B$p[2]=Math.PI),B$p[1]>=Math.PI&&B$p[2]>=Math.PI&&(B$p[1]=0,B$p[2]=0,B$p[0]=Math.PI-B$p[0]),B$J[0]=B$p[1],B$J[1]=B$p[0],B$J[2]=B$p[2]},B$W.arcTanAngle=function(B$O,B$J){return 0==B$O?1==B$J?Math.PI/2:-Math.PI/2:0<B$O?Math.atan(B$J/B$O):B$O<0?0<B$J?Math.atan(B$J/B$O)+Math.PI:Math.atan(B$J/B$O)-Math.PI:0},B$W.angleTo=function(B$O,B$J,B$D){B$iJ.subtract(B$J,B$O,B$DJ.TEMPVector30),B$iJ.normalize(B$DJ.TEMPVector30,B$DJ.TEMPVector30),B$D.elements[0]=Math.asin(B$DJ.TEMPVector30.y),B$D.elements[1]=B$W.arcTanAngle(-B$DJ.TEMPVector30.z,-B$DJ.TEMPVector30.x)},B$W.transformQuat=function(B$O,B$J,B$D){var B$p=B$D.elements,B$m=B$O.elements,B$C=B$J,B$i=B$m[0],B$k=B$m[1],B$_=B$m[2],B$L=B$C[0],B$r=B$C[1],B$H=B$C[2],B$Y=B$C[3],B$G=B$Y*B$i+B$r*B$_-B$H*B$k,B$X=B$Y*B$k+B$H*B$i-B$L*B$_,B$c=B$Y*B$_+B$L*B$k-B$r*B$i,B$h=-B$L*B$i-B$r*B$k-B$H*B$_;B$p[0]=B$G*B$Y+B$h*-B$L+B$X*-B$H-B$c*-B$r,B$p[1]=B$X*B$Y+B$h*-B$r+B$c*-B$L-B$G*-B$H,B$p[2]=B$c*B$Y+B$h*-B$H+B$G*-B$r-B$X*-B$L},B$W.quaterionNormalize=function(B$O,B$J){var B$D=B$O[0],B$p=B$O[1],B$m=B$O[2],B$C=B$O[3],B$i=B$D*B$D+B$p*B$p+B$m*B$m+B$C*B$C;0<B$i&&(B$i=1/Math.sqrt(B$i),B$J[0]=B$D*B$i,B$J[1]=B$p*B$i,B$J[2]=B$m*B$i,B$J[3]=B$C*B$i)},B$W.matrix4x4MultiplyFFF=function(B$O,B$J,B$D){var B$p,B$m,B$C,B$i,B$k;if(B$D===B$J)for(B$J=new Float32Array(16),B$p=0;B$p<16;++B$p)B$J[B$p]=B$D[B$p];for(B$p=0;B$p<4;B$p++)B$m=B$O[B$p],B$C=B$O[B$p+4],B$i=B$O[B$p+8],B$k=B$O[B$p+12],B$D[B$p]=B$m*B$J[0]+B$C*B$J[1]+B$i*B$J[2]+B$k*B$J[3],B$D[B$p+4]=B$m*B$J[4]+B$C*B$J[5]+B$i*B$J[6]+B$k*B$J[7],B$D[B$p+8]=B$m*B$J[8]+B$C*B$J[9]+B$i*B$J[10]+B$k*B$J[11],B$D[B$p+12]=B$m*B$J[12]+B$C*B$J[13]+B$i*B$J[14]+B$k*B$J[15]},B$W.matrix4x4MultiplyMFM=function(B$O,B$J,B$D){B$W.matrix4x4MultiplyFFF(B$O.elements,B$J,B$D.elements)},B$H(B$W,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new B$iJ},"_tempVector3_1",function(){return this._tempVector3_1=new B$iJ},"_tempVector3_2",function(){return this._tempVector3_2=new B$iJ},"_tempVector3_3",function(){return this._tempVector3_3=new B$iJ},"_tempVector3_4",function(){return this._tempVector3_4=new B$iJ},"_tempVector3_5",function(){return this._tempVector3_5=new B$iJ},"_tempVector3_6",function(){return this._tempVector3_6=new B$iJ},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),B$W}(),B$yJ=function(){function B$E(){}return B$G(B$E,"Laya3D"),B$E._cancelLoadByUrl=function(B$O){B$d.loader.cancelLoadByUrl(B$O),B$E._innerFirstLevelLoaderManager.cancelLoadByUrl(B$O),B$E._innerSecondLevelLoaderManager.cancelLoadByUrl(B$O),B$E._innerThirdLevelLoaderManager.cancelLoadByUrl(B$O),B$E._innerFourthLevelLoaderManager.cancelLoadByUrl(B$O)},B$E._changeWebGLSize=function(B$O,B$J){B$P.onStageResize(B$O,B$J),B$B.clientWidth=B$O,B$B.clientHeight=B$J},B$E.__init__=function(){var B$O=B$J.createMap;B$O.lh=[B$FJ,"SPRITE3DHIERARCHY"],B$O.ls=[B$NJ,"SPRITE3DHIERARCHY"],B$O.lm=[B$VJ,"MESH"],B$O.lmat=[B$jJ,"MATERIAL"],B$O.jpg=[B$IJ,"nativeimage"],B$O.jpeg=[B$IJ,"nativeimage"],B$O.png=[B$IJ,"nativeimage"],B$O.pkm=[B$IJ,"arraybuffer"],B$O.raw=[B$$J,"arraybuffer"],B$O.mipmaps=[B$$J,"arraybuffer"],B$y.parserMap.SPRITE3DHIERARCHY=B$E._loadHierarchy,B$y.parserMap.MESH=B$E._loadMesh,B$y.parserMap.MATERIAL=B$E._loadMaterial,B$y.parserMap.TEXTURECUBE=B$E._loadTextureCube,B$y.parserMap.TERRAIN=B$E._loadTerrain,B$E._innerFirstLevelLoaderManager.on("error",null,B$E._eventLoadManagerError),B$E._innerSecondLevelLoaderManager.on("error",null,B$E._eventLoadManagerError),B$E._innerThirdLevelLoaderManager.on("error",null,B$E._eventLoadManagerError),B$E._innerFourthLevelLoaderManager.on("error",null,B$E._eventLoadManagerError)},B$E.READ_BLOCK=function(){return B$E._readData.pos+=4,!0},B$E.READ_DATA=function(){return B$E._DATA.offset=B$E._readData.getUint32(),B$E._DATA.size=B$E._readData.getUint32(),!0},B$E.READ_STRINGS=function(){var B$O=[],B$J={offset:0,size:0};B$J.offset=B$E._readData.getUint16(),B$J.size=B$E._readData.getUint16();B$E._readData.pos;B$E._readData.pos=B$J.offset+B$E._DATA.offset;for(var B$D=0;B$D<B$J.size;B$D++){var B$p=B$E._readData.readUTFString();-1===B$p.lastIndexOf(".lmat")&&-1===B$p.lastIndexOf(".lpbr")||B$O.push(B$p)}return B$O},B$E.formatRelativePath=function(B$O,B$J){var B$D;if("."===B$J.charAt(0)){for(var B$p=(B$O+B$J).split("/"),B$m=0,B$C=B$p.length;B$m<B$C;B$m++)if(".."==B$p[B$m]){var B$i=B$m-1;0<B$i&&".."!==B$p[B$i]&&(B$p.splice(B$i,2),B$m-=2)}B$D=B$p.join("/")}else B$D=B$O+B$J;return null!=B$s.customFormat&&(B$D=B$s.customFormat(B$D,null)),B$D},B$E._eventLoadManagerError=function(B$O){B$d.loader.event("error",B$O)},B$E._addHierarchyInnerUrls=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i=B$E.formatRelativePath(B$p,B$m);B$D&&(B$i+=B$D),B$O.push({url:B$i,clas:B$C}),B$J[B$m]=B$i},B$E._getSprite3DHierarchyInnerUrls=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){var B$k,B$_=0,B$L=0;switch(B$O.type){case"Scene":var B$r=B$O.customProps.lightmaps;for(B$_=0,B$L=B$r.length;B$_<B$L;B$_++){var B$H=B$r[B$_].replace(".exr",".png");B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$H,B$IJ)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var B$Y;if(B$O.instanceParams)(B$Y=B$O.instanceParams.loadPath)&&B$E._addHierarchyInnerUrls(B$J,B$m,B$C,B$i,B$Y,B$VJ);else{(B$Y=(B$k=B$O.customProps).meshPath)&&B$E._addHierarchyInnerUrls(B$J,B$m,B$C,B$i,B$Y,B$VJ);var B$G=B$k.materials;if(B$G)for(B$_=0,B$L=B$G.length;B$_<B$L;B$_++){for(var B$X=B$G[B$_],B$c=B$X.type.split("."),B$h=B$o.window,B$y=0,B$v=B$c.length;B$y<B$v;++B$y){B$h=B$h[this.clasPaths[B$y]]}if("function"!=typeof B$h)throw"_getSprite3DHierarchyInnerUrls 错误: "+B$X.type+" 不是类";B$E._addHierarchyInnerUrls(B$D,B$m,B$C,B$i,B$X.path,B$h)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var B$A=(B$k=B$O.customProps).meshPath;B$A&&B$E._addHierarchyInnerUrls(B$J,B$m,B$C,B$i,B$A,B$VJ);var B$q=B$k.material;if(B$q){B$c=B$q.type.split("."),B$h=B$o.window;for(B$y=0,B$v=B$c.length;B$y<B$v;++B$y){B$h=B$h[this.clasPaths[B$y]]}B$E._addHierarchyInnerUrls(B$D,B$m,B$C,B$i,B$q.path,B$h)}else{var B$d=B$k.materialPath;if(B$d)B$E._addHierarchyInnerUrls(B$D,B$m,B$C,B$i,B$d,ShurikenParticleMaterial);else{var B$M=B$k.texturePath;B$M&&B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$M,B$IJ)}}break;case"Terrain":B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$O.customProps.dataPath,TerrainRes)}var B$a=B$O.components;for(var B$e in B$a){var B$t=B$a[B$e];switch(B$e){case"Animator":var B$z=B$t.avatarPath;if(B$z)B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$z,Avatar);else{var B$g=B$t.avatar;B$g&&B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$g.path,Avatar)}var B$s=B$t.clipPaths;for(B$_=0,B$L=B$s.length;B$_<B$L;B$_++)B$E._addHierarchyInnerUrls(B$p,B$m,B$C,B$i,B$s[B$_],AnimationClip)}}var B$P=B$O.child;for(B$_=0,B$L=B$P.length;B$_<B$L;B$_++)B$E._getSprite3DHierarchyInnerUrls(B$P[B$_],B$J,B$D,B$p,B$m,B$C,B$i)},B$E._loadHierarchy=function(B$O){B$O.on("loaded",null,B$E._onHierarchylhLoaded,[B$O,B$O._class._getGroup()]),B$O.load(B$O.url,"json",!1,null,!0)},B$E._onHierarchylhLoaded=function(B$O,B$J,B$D){if(B$O._class.destroyed)B$O.endLoad();else{var B$p=B$O.url,B$m=B$hJ.getURLVerion(B$p),B$C=B$s.getPath(B$p),B$i=[],B$k=[],B$_=[],B$L={};B$E._getSprite3DHierarchyInnerUrls(B$D,B$i,B$k,B$_,B$L,B$m,B$C);var B$r=B$i.length+B$k.length+B$_.length,B$H=B$r+1,B$Y=1/B$H;if(B$E._onProcessChange(B$O,0,B$Y,1),0<B$_.length){var B$G=B$r/B$H,B$X=B$g.create(null,B$E._onProcessChange,[B$O,B$Y,B$G],!1);B$E._innerFourthLevelLoaderManager.create(B$_,B$g.create(null,B$E._onHierarchyInnerForthLevResouLoaded,[B$O,B$J,B$X,B$D,B$L,B$i,B$k,B$Y+B$G*B$_.length,B$G]),B$X,null,null,1,!0,B$J)}else B$E._onHierarchyInnerForthLevResouLoaded(B$O,B$J,null,B$D,B$L,B$i,B$k,B$Y,B$G)}},B$E._onHierarchyInnerForthLevResouLoaded=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){if(B$O._class.destroyed)B$O.endLoad();else if(B$D&&B$D.recover(),0<B$i.length){var B$L=B$g.create(null,B$E._onProcessChange,[B$O,B$k,B$_],!1);B$E._innerSecondLevelLoaderManager.create(B$i,B$g.create(null,B$E._onHierarchyInnerSecondLevResouLoaded,[B$O,B$J,B$L,B$p,B$m,B$C,B$k+B$_*B$i.length,B$_]),B$D,null,null,1,!0,B$J)}else B$E._onHierarchyInnerSecondLevResouLoaded(B$O,B$J,null,B$p,B$m,B$C,B$k,B$_)},B$E._onHierarchyInnerSecondLevResouLoaded=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k){if(B$O._class.destroyed)B$O.endLoad();else if(B$D&&B$D.recover(),0<B$C.length){var B$_=B$g.create(null,B$E._onProcessChange,[B$O,B$i,B$k],!1);B$E._innerFirstLevelLoaderManager.create(B$C,B$g.create(null,B$E._onHierarchyInnerFirstLevResouLoaded,[B$O,B$_,B$p,B$m]),B$D,null,null,1,!0,B$J)}else B$E._onHierarchyInnerFirstLevResouLoaded(B$O,null,B$p,B$m)},B$E._onHierarchyInnerFirstLevResouLoaded=function(B$O,B$J,B$D,B$p){B$J&&B$J.recover(),B$O.endLoad([B$D,B$p])},B$E._loadTerrain=function(B$O){B$O.on("loaded",null,B$E._onTerrainLtLoaded,[B$O,B$O._class._getGroup()]),B$O.load(B$O.url,"json",!1,null,!0)},B$E._onTerrainLtLoaded=function(B$O,B$J,B$D){if(B$O._class.destroyed)B$O.endLoad();else{var B$p,B$m,B$C=B$O.url,B$i=B$hJ.getURLVerion(B$C),B$k=B$s.getPath(B$C),B$_=[],B$L={},B$r=0,B$H=0,B$Y=B$D.heightData;B$p=B$Y.url,B$m=B$E.formatRelativePath(B$k,B$p),B$i&&(B$m+=B$i),B$p=B$L[B$p]=B$m;var B$G=B$D.detailTexture;for(B$r=0,B$H=B$G.length;B$r<B$H;B$r++)B$_.push({url:B$G[B$r].diffuse});var B$X=B$D.normalMap;for(B$r=0,B$H=B$X.length;B$r<B$H;B$r++)B$_.push({url:B$X[B$r]});var B$c=B$D.alphaMap;for(B$r=0,B$H=B$c.length;B$r<B$H;B$r++)B$_.push({url:B$c[B$r],params:[!1,!1,6408,!0]});for(B$r=0,B$H=B$_.length;B$r<B$H;B$r++){var B$h=B$_[B$r].url;B$m=B$E.formatRelativePath(B$k,B$h),B$i&&(B$m+=B$i),B$_[B$r].url=B$m,B$L[B$h]=B$m}var B$y=B$_.length,B$v=B$y+2,B$A=1/B$v;B$E._onProcessChange(B$O,0,B$A,1);var B$q={heightMapLoaded:!1,texturesLoaded:!1},B$d=B$g.create(null,B$E._onProcessChange,[B$O,B$A,B$A],!1);B$E._innerFourthLevelLoaderManager.create(B$p,B$g.create(null,B$E._onTerrainHeightMapLoaded,[B$O,B$d,B$D,B$L,B$q]),B$d,null,[B$Y.numX,B$Y.numZ,B$Y.bitType,B$Y.value],1,!0,B$J);var B$M=B$g.create(null,B$E._onProcessChange,[B$O,2*B$A,B$y/B$v],!1);B$E._innerFourthLevelLoaderManager.create(B$_,B$g.create(null,B$E._onTerrainTexturesLoaded,[B$O,B$M,B$D,B$L,B$q]),B$M,null,null,1,!0,B$J)}},B$E._onTerrainHeightMapLoaded=function(B$O,B$J,B$D,B$p,B$m){B$m.heightMapLoaded=!0,B$m.texturesLoaded&&(B$O.endLoad([B$D,B$p]),B$J.recover())},B$E._onTerrainTexturesLoaded=function(B$O,B$J,B$D,B$p,B$m){B$m.texturesLoaded=!0,B$m.heightMapLoaded&&(B$O.endLoad([B$D,B$p]),B$J.recover())},B$E._loadMesh=function(B$O){B$O.on("loaded",null,B$E._onMeshLmLoaded,[B$O,B$O._class._getGroup()]),B$O.load(B$O.url,"arraybuffer",!1,null,!0)},B$E._onMeshLmLoaded=function(B$O,B$J,B$D){if(B$O._class.destroyed)B$O.endLoad();else{var B$p,B$m,B$C,B$i=B$O.url,B$k=B$hJ.getURLVerion(B$i),B$_=B$s.getPath(B$i),B$L={},B$r=0,B$H=0;switch((B$E._readData=new B$M(B$D)).pos=0,B$E._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var B$Y=B$E._readData.getUint32();B$E._readData.pos=B$E._readData.pos+4,B$H=B$E._readData.getUint16(),B$E._readData.pos=B$E._readData.pos+8*B$H;var B$G=B$E._readData.getUint32();for(B$H=B$E._readData.getUint16(),B$E._readData.pos=B$Y+B$G,B$p=[],B$r=0;B$r<B$H;B$r++){var B$X=B$E._readData.readUTFString();-1!==B$X.lastIndexOf(".lmat")&&B$p.push(B$X)}break;default:for(B$E.READ_BLOCK(),B$r=0;B$r<2;B$r++){var B$c=B$E._readData.getUint16(),B$h=B$E._strings[B$c],B$y=B$E["READ_"+B$h];if(null==B$y)throw new Error("model file err,no this function:"+B$c+" "+B$h);1===B$r?B$p=B$y.call():B$y.call()}}for(B$r=0,B$C=B$p.length;B$r<B$C;B$r++){var B$v=B$p[B$r];B$m=B$E.formatRelativePath(B$_,B$v),B$k&&(B$m+=B$k),B$p[B$r]=B$m,B$L[B$v]=B$m}if(0<B$p.length){B$E._onProcessChange(B$O,0,.5,1);var B$A=B$g.create(null,B$E._onProcessChange,[B$O,.5,.5],!1);B$E._innerSecondLevelLoaderManager.create(B$p,B$g.create(null,B$E._onMeshMateialLoaded,[B$O,B$A,B$D,B$L]),B$A,null,null,1,!0,B$J)}else B$O.endLoad([B$D,B$L])}},B$E._onMeshMateialLoaded=function(B$O,B$J,B$D,B$p){B$O.endLoad([B$D,B$p]),B$J.recover()},B$E._getMaterialTexturePath=function(B$O,B$J,B$D){var B$p=B$O.length-4;return B$O.indexOf(".dds")!=B$p&&B$O.indexOf(".tga")!=B$p&&B$O.indexOf(".exr")!=B$p&&B$O.indexOf(".DDS")!=B$p&&B$O.indexOf(".TGA")!=B$p&&B$O.indexOf(".EXR")!=B$p||(B$O=B$O.substr(0,B$p)+".png"),B$O=B$E.formatRelativePath(B$D,B$O),B$J&&(B$O+=B$J),B$O},B$E._loadMaterial=function(B$O){B$O.on("loaded",null,B$E._onMaterilLmatLoaded,[B$O,B$O._class._getGroup()]),B$O.load(B$O.url,"json",!1,null,!0)},B$E._onMaterilLmatLoaded=function(B$O,B$J,B$D){if(B$O._class.destroyed)B$O.endLoad();else{var B$p,B$m=B$O.url,B$C=B$hJ.getURLVerion(B$m),B$i=B$s.getPath(B$m),B$k=[],B$_={},B$L=B$D.customProps,B$r=B$D.version;if(B$r)switch(B$r){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var B$H=B$D.props.textures,B$Y=0,B$G=B$H.length;B$Y<B$G;B$Y++){var B$X=B$H[B$Y],B$c=B$X.path;if(B$c){var B$h=B$c.length-4;B$c.indexOf(".exr")!=B$h&&B$c.indexOf(".EXR")!=B$h||(B$c=B$c.substr(0,B$h)+".png"),B$p=B$E.formatRelativePath(B$i,B$c),B$C&&(B$p+=B$C),B$k.push({url:B$p,params:B$X.params}),B$_[B$c]=B$p}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var B$y=B$L.diffuseTexture.texture2D;if(B$y&&(B$p=B$E._getMaterialTexturePath(B$y,B$C,B$i),B$k.push(B$p),B$_[B$y]=B$p),B$L.normalTexture){var B$v=B$L.normalTexture.texture2D;B$v&&(B$p=B$E._getMaterialTexturePath(B$v,B$C,B$i),B$k.push(B$p),B$_[B$v]=B$p)}if(B$L.specularTexture){var B$A=B$L.specularTexture.texture2D;B$A&&(B$p=B$E._getMaterialTexturePath(B$A,B$C,B$i),B$k.push(B$p),B$_[B$A]=B$p)}if(B$L.emissiveTexture){var B$q=B$L.emissiveTexture.texture2D;B$q&&(B$p=B$E._getMaterialTexturePath(B$q,B$C,B$i),B$k.push(B$p),B$_[B$q]=B$p)}if(B$L.ambientTexture){var B$d=B$L.ambientTexture.texture2D;B$d&&(B$p=B$E._getMaterialTexturePath(B$d,B$C,B$i),B$k.push(B$p),B$_[B$d]=B$p)}if(B$L.reflectTexture){var B$M=B$L.reflectTexture.texture2D;B$M&&(B$p=B$E._getMaterialTexturePath(B$M,B$C,B$i),B$k.push(B$p),B$_[B$M]=B$p)}}var B$a=B$k.length,B$e=B$a+1,B$t=1/B$e;if(B$E._onProcessChange(B$O,0,B$t,1),0<B$a){var B$z=B$g.create(null,B$E._onProcessChange,[B$O,B$t,B$a/B$e],!1);B$E._innerFourthLevelLoaderManager.create(B$k,B$g.create(null,B$E._onMateialTexturesLoaded,[B$O,B$z,B$D,B$_]),B$z,B$IJ,null,1,!0,B$J)}else B$E._onMateialTexturesLoaded(B$O,null,B$D,null)}},B$E._onMateialTexturesLoaded=function(B$O,B$J,B$D,B$p){B$O.endLoad([B$D,B$p]),B$J&&B$J.recover()},B$E._loadTextureCube=function(B$O){B$O.on("loaded",null,B$E._onTextureCubeLtcLoaded,[B$O]),B$O.load(B$O.url,"json",!1,null,!0)},B$E._onTextureCubeLtcLoaded=function(B$O,B$J){if(B$O._class.destroyed)B$O.endLoad();else{var B$D=B$s.getPath(B$O.url),B$p=[B$E.formatRelativePath(B$D,B$J.px),B$E.formatRelativePath(B$D,B$J.nx),B$E.formatRelativePath(B$D,B$J.py),B$E.formatRelativePath(B$D,B$J.ny),B$E.formatRelativePath(B$D,B$J.pz),B$E.formatRelativePath(B$D,B$J.nz)];B$E._onProcessChange(B$O,0,1/7,1);var B$m=B$g.create(null,B$E._onProcessChange,[B$O,1/7,6/7],!1);B$E._innerFourthLevelLoaderManager.load(B$p,B$g.create(null,B$E._onTextureCubeImagesLoaded,[B$O,B$p,B$m]),B$m,"nativeimage")}},B$E._onTextureCubeImagesLoaded=function(B$O,B$J,B$D){var B$p=[];B$p.length=6;for(var B$m=0;B$m<6;B$m++){var B$C=B$J[B$m];B$p[B$m]=B$y.getRes(B$C),B$y.clearRes(B$C)}B$O.endLoad(B$p),B$D.recover()},B$E._onProcessChange=function(B$O,B$J,B$D,B$p){(B$p=B$J+B$p*B$D)<1&&B$O.event("progress",B$p)},B$E.init=function(B$O,B$J,B$D,B$p,B$m,B$C){if(void 0===B$D&&(B$D=!1),void 0===B$p&&(B$p=!1),void 0===B$m&&(B$m=!0),void 0===B$C&&(B$C=!0),B$v.update3DLoop=function(){},B$v.cancelLoadByUrl=function(B$O){B$E._cancelLoadByUrl(B$O)},B$_.isAntialias=B$D,B$_.isAlpha=B$p,B$_.premultipliedAlpha=B$m,B$_.isStencil=B$C,!B$P.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");B$v.changeWebGLSize=B$E._changeWebGLSize,B$c.is3DMode=!0,B$d.init(B$O,B$J),B$W.__init__(),B$HJ.__init__(),B$nJ.__init__(),B$x.__init__(),B$E.__init__(),B$i.maxTextureCount=2,(B$E.debugMode||B$S.debugMode)&&(B$E._debugPhasorSprite=new B$U)},B$E.HIERARCHY="SPRITE3DHIERARCHY",B$E.MESH="MESH",B$E.MATERIAL="MATERIAL",B$E.PBRMATERIAL="PBRMTL",B$E.TEXTURECUBE="TEXTURECUBE",B$E.TERRAIN="TERRAIN",B$E._readData=null,B$E._debugPhasorSprite=null,B$E.debugMode=!1,B$H(B$E,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new B$J},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new B$J},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new B$J},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new B$J}]),B$E}(),B$vJ=function(B$O){function B$m(B$O){B$m.__super.call(this),this._owner=B$O,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}B$G(B$m,"laya.d3.animation.AnimationTransform3D",B$C);var B$J=B$m.prototype;return B$J._getlocalMatrix=function(){return this._localUpdate&&(B$hJ._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},B$J._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldTransform()}},B$J._setWorldMatrixAndUpdate=function(B$O){if(this._worldMatrix=B$O,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var B$J=this._getlocalMatrix(),B$D=0;B$D<16;++B$D)this._worldMatrix[B$D]=B$J[B$D];else B$hJ.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},B$J._setWorldMatrixNoUpdate=function(B$O){this._worldMatrix=B$O},B$J._setWorldMatrixIgnoreUpdate=function(B$O){this._worldMatrix=B$O,this._worldUpdate=!1},B$J.getLocalPosition=function(){return this._localPosition},B$J.setLocalPosition=function(B$O){if(this._parent)this._localPosition=B$O,this._localUpdate=!0,this._onWorldTransform();else{var B$J=this._entity.owner._transform,B$D=this._entity.localPosition,B$p=B$D.elements;B$p[0]=B$O[0],B$p[1]=B$O[1],B$p[2]=B$O[2],B$J.localPosition=B$D}},B$J.getLocalRotation=function(){if(this._localQuaternionUpdate){var B$O=this._localRotationEuler;B$hJ._quaternionCreateFromYawPitchRollArray(B$O[1]/B$m._angleToRandin,B$O[0]/B$m._angleToRandin,B$O[2]/B$m._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},B$J.setLocalRotation=function(B$O){if(this._parent)this._localRotation=B$O,B$hJ.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var B$J=this._entity.owner._transform,B$D=this._entity.localRotation,B$p=B$D.elements;B$p[0]=B$O[0],B$p[1]=B$O[1],B$p[2]=B$O[2],B$p[3]=B$O[3],B$J.localRotation=B$D}},B$J.getLocalScale=function(){return this._localScale},B$J.setLocalScale=function(B$O){if(this._parent)this._localScale=B$O,this._localUpdate=!0,this._onWorldTransform();else{var B$J=this._entity.owner._transform,B$D=this._entity.localScale,B$p=B$D.elements;B$p[0]=B$O[0],B$p[1]=B$O[1],B$p[2]=B$O[2],B$J.localScale=B$D}},B$J.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){B$hJ.getYawPitchRoll(this._localRotation,B$m._tempVector3);var B$O=B$m._tempVector3,B$J=this._localRotationEuler;B$J[0]=B$O[1]*B$m._angleToRandin,B$J[1]=B$O[0]*B$m._angleToRandin,B$J[2]=B$O[2]*B$m._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},B$J.setLocalRotationEuler=function(B$O){if(this._parent)B$hJ._quaternionCreateFromYawPitchRollArray(B$O[1]/B$m._angleToRandin,B$O[0]/B$m._angleToRandin,B$O[2]/B$m._angleToRandin,this._localRotation),this._localRotationEuler=B$O,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var B$J=this._entity.owner._transform,B$D=this._entity.localRotationEuler,B$p=B$D.elements;B$p[0]=B$O[0],B$p[1]=B$O[1],B$p[2]=B$O[2],B$J.localRotationEuler=B$D}},B$J.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)B$hJ.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var B$O=this._getlocalMatrix(),B$J=0;B$J<16;++B$J)this._worldMatrix[B$J]=B$O[B$J];this._worldUpdate=!1}return this._worldMatrix},B$J.setParent=function(B$O){if(this._parent!==B$O){if(this._parent){var B$J=this._parent._childs,B$D=B$J.indexOf(this);B$J.splice(B$D,1)}B$O&&(B$O._childs.push(this),B$O&&this._onWorldTransform()),this._parent=B$O}},B$H(B$m,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),B$m}(),B$AJ=function(B$O){function B$J(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,B$J.__super.call(this),this._destroyed=!1,this._id=B$J._uniqueIDCounter,B$J._uniqueIDCounter++}B$G(B$J,"laya.d3.component.Component3D",B$C);var B$D=B$J.prototype;return B$d.imps(B$D,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),B$D._initialize=function(B$O){this._owner=B$O,this._enable=!0,this.started=!1,this._load(B$O)},B$D._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},B$D._load=function(B$O){},B$D._start=function(B$O){},B$D._update=function(B$O){},B$D._lateUpdate=function(B$O){},B$D._preRenderUpdate=function(B$O){},B$D._postRenderUpdate=function(B$O){},B$D._unload=function(B$O){this.offAll()},B$D._cloneTo=function(B$O){},B$X(0,B$D,"id",function(){return this._id}),B$X(0,B$D,"destroyed",function(){return this._destroyed}),B$X(0,B$D,"owner",function(){return this._owner}),B$X(0,B$D,"enable",function(){return this._enable},function(B$O){this._enable!==B$O&&(this._enable=B$O,this.event("enablechanged",this._enable))}),B$X(0,B$D,"isSingleton",function(){return B$J._isSingleton}),B$J._isSingleton=!0,B$J._uniqueIDCounter=1,B$J}(),B$qJ=function(B$O){function B$J(){this._destroyed=!1,B$J.__super.call(this),this._destroyed=!1}B$G(B$J,"laya.d3.core.GeometryFilter",B$C);var B$D=B$J.prototype;return B$d.imps(B$D,{"laya.resource.IDestroy":!0}),B$D._destroy=function(){this.offAll(),this._destroyed=!0},B$X(0,B$D,"_isAsyncLoaded",function(){return!0}),B$X(0,B$D,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),B$X(0,B$D,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),B$X(0,B$D,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),B$X(0,B$D,"destroyed",function(){return this._destroyed}),B$J}(),B$dJ=function(B$O){function B$p(B$O){B$p.__super.call(this),this._id=++B$p._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new B$SO(new B$iJ,new B$iJ),this._boundingBoxCenter=new B$iJ,this._boundingSphere=new B$bO(new B$iJ,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=B$O,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}B$G(B$p,"laya.d3.core.render.BaseRender",B$C);var B$J=B$p.prototype;return B$d.imps(B$J,{"laya.resource.IDestroy":!0}),B$J._changeMaterialReference=function(B$O,B$J){B$O&&B$O._removeReference(),B$J._addReference()},B$J._getInstanceMaterial=function(B$O,B$J){var B$D=new B$O.constructor;return B$O.cloneTo(B$D),B$D.name=B$D.name+"(Instance)",this._materialsInstance[B$J]=!0,this._changeMaterialReference(this._materials[B$J],B$D),this._materials[B$J]=B$D},B$J._setShaderValuelightMap=function(B$O){this._setShaderValueTexture(3,B$O)},B$J._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},B$J._renderRenderableBoundBox=function(){var B$O=B$yJ._debugPhasorSprite,B$J=this.boundingBox,B$D=B$p._tempBoundBoxCorners;B$J.getCorners(B$D),B$O.line(B$D[0],B$p._greenColor,B$D[1],B$p._greenColor),B$O.line(B$D[2],B$p._greenColor,B$D[3],B$p._greenColor),B$O.line(B$D[4],B$p._greenColor,B$D[5],B$p._greenColor),B$O.line(B$D[6],B$p._greenColor,B$D[7],B$p._greenColor),B$O.line(B$D[0],B$p._greenColor,B$D[3],B$p._greenColor),B$O.line(B$D[1],B$p._greenColor,B$D[2],B$p._greenColor),B$O.line(B$D[2],B$p._greenColor,B$D[6],B$p._greenColor),B$O.line(B$D[3],B$p._greenColor,B$D[7],B$p._greenColor),B$O.line(B$D[0],B$p._greenColor,B$D[4],B$p._greenColor),B$O.line(B$D[1],B$p._greenColor,B$D[5],B$p._greenColor),B$O.line(B$D[4],B$p._greenColor,B$D[7],B$p._greenColor),B$O.line(B$D[5],B$p._greenColor,B$D[6],B$p._greenColor)},B$J._calculateBoundingSphere=function(){throw"BaseRender: must override it."},B$J._calculateBoundingBox=function(){throw"BaseRender: must override it."},B$J._setShaderValueTexture=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J)},B$J._setShaderValueMatrix4x4=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J?B$J.elements:null)},B$J._setShaderValueColor=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J?B$J.elements:null)},B$J._setShaderValueBuffer=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J)},B$J._setShaderValueInt=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J)},B$J._setShaderValueBool=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J)},B$J._setShaderValueNumber=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J)},B$J._setShaderValueVector2=function(B$O,B$J){this._owner._shaderValues.setValue(B$O,B$J?B$J.elements:null)},B$J._addShaderDefine=function(B$O){this._owner._shaderDefineValue|=B$O},B$J._removeShaderDefine=function(B$O){this._owner._shaderDefineValue&=~B$O},B$J._renderUpdate=function(B$O){return!0},B$J._applyLightMapParams=function(){if(0<=this._lightmapIndex){var B$O=this._owner.scene;if(B$O){var B$J=B$O.getlightmaps()[this._lightmapIndex];B$J?(this._addShaderDefine(B$UJ.SAHDERDEFINE_LIGHTMAP),B$J.loaded?this._setShaderValuelightMap(B$J):B$J.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(B$UJ.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(B$UJ.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(B$UJ.SAHDERDEFINE_LIGHTMAP)},B$J._updateOctreeNode=function(){var B$O=this._treeNode;B$O&&this._octreeNodeNeedChange&&(B$O.updateObject(this),this._octreeNodeNeedChange=!1)},B$J._destroy=function(){this.offAll();var B$O=0,B$J=0;for(B$O=0,B$J=this._renderElements.length;B$O<B$J;B$O++)this._renderElements[B$O]._destroy();for(B$O=0,B$J=this._materials.length;B$O<B$J;B$O++)this._materials[B$O]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},B$X(0,B$J,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),B$X(0,B$J,"id",function(){return this._id}),B$X(0,B$J,"material",function(){var B$O=this._materials[0];if(B$O&&!this._materialsInstance[0]){var B$J=this._getInstanceMaterial(B$O,0);this.event("materialchanged",[this,0,B$J])}return this._materials[0]},function(B$O){this.sharedMaterial=B$O}),B$X(0,B$J,"sharedMaterial",function(){return this._materials[0]},function(B$O){var B$J=this._materials[0];B$J!==B$O&&(this._materials[0]=B$O,this._materialsInstance[0]=!1,this._changeMaterialReference(B$J,B$O),this.event("materialchanged",[this,0,B$O]))}),B$X(0,B$J,"lightmapIndex",function(){return this._lightmapIndex},function(B$O){this._lightmapIndex=B$O,this._applyLightMapParams()}),B$X(0,B$J,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(B$O){this._lightmapScaleOffset=B$O,this._setShaderValueColor(2,B$O),this._addShaderDefine(B$UJ.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),B$X(0,B$J,"enable",function(){return this._enable},function(B$O){this._enable=B$O,this.event("enablechanged",[this,B$O])}),B$X(0,B$J,"materials",function(){for(var B$O=0,B$J=this._materials.length;B$O<B$J;B$O++)if(!this._materialsInstance[B$O]){var B$D=this._getInstanceMaterial(this._materials[B$O],B$O);this.event("materialchanged",[this,B$O,B$D])}return this._materials.slice()},function(B$O){this.sharedMaterials=B$O}),B$X(0,B$J,"sharedMaterials",function(){return this._materials.slice()},function(B$O){if(!B$O)throw new Error("MeshRender: shadredMaterials value can't be null.");var B$J=B$O.length;this._materialsInstance.length=B$J;for(var B$D=0;B$D<B$J;B$D++){var B$p=this._materials[B$D];B$p!==B$O[B$D]&&(this._materialsInstance[B$D]=!1,this._changeMaterialReference(B$p,B$O[B$D]),this.event("materialchanged",[this,B$D,B$O[B$D]]))}this._materials=B$O}),B$X(0,B$J,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),B$X(0,B$J,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var B$O=this.boundingBox;B$iJ.add(B$O.min,B$O.max,this._boundingBoxCenter),B$iJ.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),B$X(0,B$J,"receiveShadow",function(){return this._receiveShadow},function(B$O){this._receiveShadow!==B$O&&((this._receiveShadow=B$O)?this._addShaderDefine(B$GJ.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(B$GJ.SHADERDEFINE_RECEIVE_SHADOW))}),B$X(0,B$J,"destroyed",function(){return this._destroyed}),B$p._uniqueIDCounter=0,B$H(B$p,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ,new B$iJ]},"_greenColor",function(){return this._greenColor=new B$kJ(0,1,0,1)}]),B$p}(),B$MJ=function(B$O){function B$k(B$O){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,B$k.__super.call(this),this._localPosition=new B$iJ,this._localRotation=new B$DJ(0,0,0,1),this._localScale=new B$iJ(1,1,1),this._localRotationEuler=new B$iJ,this._localMatrix=new B$OJ,this._position=new B$iJ,this._rotation=new B$DJ(0,0,0,1),this._scale=new B$iJ(1,1,1),this._worldMatrix=new B$OJ,this._forward=new B$iJ,this._up=new B$iJ,this._right=new B$iJ,this._owner=B$O,this._childs=[]}B$G(B$k,"laya.d3.core.Transform3D",B$C);var B$J=B$k.prototype;return B$J._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)B$OJ.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var B$O=B$k._tempVector30;B$iJ.multiply(this.pivot,this._localScale,B$O);var B$J=B$k._tempVector31;B$iJ.subtract(B$O,this.pivot,B$J);var B$D=B$k._tempVector32,B$p=this.localRotation;B$iJ.transformQuat(B$O,B$p,B$D),B$iJ.subtract(B$D,B$O,B$D);var B$m=B$k._tempVector33;B$iJ.subtract(this._localPosition,B$J,B$m),B$iJ.subtract(B$m,B$D,B$m),B$OJ.createAffineTransformation(B$m,B$p,this._localScale,this._localMatrix)}},B$J._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldPositionRotationTransform()}},B$J._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldPositionScaleTransform()}},B$J._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldPositionTransform()}},B$J._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldPositionRotationTransform()}},B$J._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldPositionScaleTransform()}},B$J._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._onWorldTransform()}},B$J.translate=function(B$O,B$J){void 0===B$J&&(B$J=!0),B$J?(B$OJ.createFromQuaternion(this.localRotation,B$k._tempMatrix0),B$iJ.transformCoordinate(B$O,B$k._tempMatrix0,B$k._tempVector30),B$iJ.add(this.localPosition,B$k._tempVector30,this._localPosition),this.localPosition=this._localPosition):(B$iJ.add(this.position,B$O,this._position),this.position=this._position)},B$J.rotate=function(B$O,B$J,B$D){var B$p;void 0===B$J&&(B$J=!0),void 0===B$D&&(B$D=!0),B$p=B$D?B$O:(B$iJ.scale(B$O,Math.PI/180,B$k._tempVector30),B$k._tempVector30),B$DJ.createFromYawPitchRoll(B$p.y,B$p.x,B$p.z,B$k._tempQuaternion0),B$J?(B$DJ.multiply(this._localRotation,B$k._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(B$DJ.multiply(B$k._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},B$J.lookAt=function(B$O,B$J,B$D){void 0===B$D&&(B$D=!1);var B$p,B$m=B$O.elements;if(B$D){if(B$p=this._localPosition.elements,Math.abs(B$p[0]-B$m[0])<B$KO.zeroTolerance&&Math.abs(B$p[1]-B$m[1])<B$KO.zeroTolerance&&Math.abs(B$p[2]-B$m[2])<B$KO.zeroTolerance)return;B$DJ.lookAt(this._localPosition,B$O,B$J,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var B$C=this.position;if(B$p=B$C.elements,Math.abs(B$p[0]-B$m[0])<B$KO.zeroTolerance&&Math.abs(B$p[1]-B$m[1])<B$KO.zeroTolerance&&Math.abs(B$p[2]-B$m[2])<B$KO.zeroTolerance)return;B$DJ.lookAt(B$C,B$O,B$J,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},B$X(0,B$J,"_isFrontFaceInvert",function(){var B$O=this.scale,B$J=B$O.x<0;return B$O.y<0&&(B$J=!B$J),B$O.z<0&&(B$J=!B$J),B$J}),B$X(0,B$J,"owner",function(){return this._owner}),B$X(0,B$J,"localRotation",function(){if(this._localQuaternionUpdate){var B$O=this._localRotationEuler.elements;B$DJ.createFromYawPitchRoll(B$O[1]/B$k._angleToRandin,B$O[0]/B$k._angleToRandin,B$O[2]/B$k._angleToRandin,this._localRotation)}return this._localRotation},function(B$O){this._localRotation=B$O,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),B$X(0,B$J,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?B$OJ.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(B$O){null===this._parent?B$O.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),B$OJ.multiply(this._localMatrix,B$O,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=B$O,this._worldUpdate=!1}),B$X(0,B$J,"worldNeedUpdate",function(){return this._worldUpdate}),B$X(0,B$J,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(B$O){this._localMatrix=B$O,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),B$X(0,B$J,"dummy",function(){return this._dummy},function(B$O){this._dummy!==B$O&&(this._dummy&&(this._dummy._entity=null),B$O&&(B$O._entity=this),this._dummy=B$O)}),B$X(0,B$J,"localPosition",function(){return this._localPosition},function(B$O){this._localPosition=B$O,this._localUpdate=!0,this._onWorldPositionTransform()}),B$X(0,B$J,"position",function(){if(this._positionUpdate){if(null!=this._parent){var B$O=this._parent.position;B$iJ.multiply(this._localPosition,this._parent.scale,B$k._tempVector30),B$iJ.transformQuat(B$k._tempVector30,this._parent.rotation,B$k._tempVector30),B$iJ.add(B$O,B$k._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(B$O){if(null!=this._parent){B$iJ.subtract(B$O,this._parent.position,this._localPosition);var B$J=this._parent.scale.elements,B$D=B$J[0],B$p=B$J[1],B$m=B$J[2];if(1!==B$D||1!==B$p||1!==B$m){var B$C=B$k._tempVector30,B$i=B$C.elements;B$i[0]=1/B$D,B$i[1]=1/B$p,B$i[2]=1/B$m,B$iJ.multiply(this._localPosition,B$C,this._localPosition)}this._parent.rotation.invert(B$k._tempQuaternion0),B$iJ.transformQuat(this._localPosition,B$k._tempQuaternion0,this._localPosition)}else B$O.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=B$O,this._positionUpdate=!1}),B$X(0,B$J,"localScale",function(){return this._localScale},function(B$O){this._localScale=B$O,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),B$X(0,B$J,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(B$k._tempVector30);var B$O=B$k._tempVector30.elements,B$J=this._localRotationEuler.elements;B$J[0]=B$O[1]*B$k._angleToRandin,B$J[1]=B$O[0]*B$k._angleToRandin,B$J[2]=B$O[2]*B$k._angleToRandin}return this._localRotationEuler},function(B$O){this._localRotationEuler=B$O,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),B$X(0,B$J,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?B$DJ.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(B$O){null!=this._parent?(this._parent.rotation.invert(B$k._tempQuaternion0),B$DJ.multiply(B$O,B$k._tempQuaternion0,this._localRotation)):B$O.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=B$O,this._rotationUpdate=!1}),B$X(0,B$J,"scale",function(){return this._scaleUpdate&&(null!==this._parent?B$iJ.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(B$O){if(null!==this._parent){var B$J=this._parent.scale.elements,B$D=B$k._tempVector30.elements;B$D[0]=1/B$J[0],B$D[1]=1/B$J[1],B$D[2]=1/B$J[2],B$iJ.multiply(B$O,B$k._tempVector30,this._localScale)}else B$O.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=B$O,this._scaleUpdate=!1}),B$X(0,B$J,"rotationEuler",null,function(B$O){B$DJ.createFromYawPitchRoll(B$O.y,B$O.x,B$O.z,this._rotation),this.rotation=this._rotation}),B$X(0,B$J,"forward",function(){var B$O=this.worldMatrix.elements;return this._forward.elements[0]=-B$O[8],this._forward.elements[1]=-B$O[9],this._forward.elements[2]=-B$O[10],this._forward}),B$X(0,B$J,"up",function(){var B$O=this.worldMatrix.elements;return this._up.elements[0]=B$O[4],this._up.elements[1]=B$O[5],this._up.elements[2]=B$O[6],this._up}),B$X(0,B$J,"right",function(){var B$O=this.worldMatrix.elements;return this._right.elements[0]=B$O[0],this._right.elements[1]=B$O[1],this._right.elements[2]=B$O[2],this._right}),B$X(0,B$J,"parent",function(){return this._parent},function(B$O){if(this._parent!==B$O){if(this._parent){var B$J=this._parent._childs,B$D=B$J.indexOf(this);B$J.splice(B$D,1)}B$O&&(B$O._childs.push(this),B$O&&this._onWorldTransform()),this._parent=B$O}}),B$H(B$k,["_tempVector30",function(){return this._tempVector30=new B$iJ},"_tempVector31",function(){return this._tempVector31=new B$iJ},"_tempVector32",function(){return this._tempVector32=new B$iJ},"_tempVector33",function(){return this._tempVector33=new B$iJ},"_tempQuaternion0",function(){return this._tempQuaternion0=new B$DJ},"_tempMatrix0",function(){return this._tempMatrix0=new B$OJ},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),B$k}(),B$aJ=(function(B$O){function B$J(){this._rotation=0,this._matNeedUpdte=!1,B$J.__super.call(this),this._matrix=new B$OJ,this._offset=new B$CJ,this._tiling=new B$CJ(1,1)}B$G(B$J,"laya.d3.core.TransformUV",B$C);var B$D=B$J.prototype;B$d.imps(B$D,{"laya.d3.core.IClone":!0}),B$D._updateMatrix=function(){B$J._tempOffsetV3.elements[0]=this._offset.x,B$J._tempOffsetV3.elements[1]=this._offset.y,B$DJ.createFromYawPitchRoll(0,0,this._rotation,B$J._tempRotationQua),B$J._tempTitlingV3.elements[0]=this._tiling.x,B$J._tempTitlingV3.elements[1]=this._tiling.y,B$OJ.createAffineTransformation(B$J._tempOffsetV3,B$J._tempRotationQua,B$J._tempTitlingV3,this._matrix)},B$D.cloneTo=function(B$O){B$O._matrix=this._matrix.clone(),B$O._offset=this._offset.clone(),B$O._rotation=this._rotation,B$O._tiling=this._tiling.clone()},B$D.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$D,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),B$X(0,B$D,"tiling",function(){return this._tiling},function(B$O){this._tiling=B$O,this._matNeedUpdte=!0}),B$X(0,B$D,"offset",function(){return this._offset},function(B$O){this._offset=B$O,this._matNeedUpdte=!0}),B$X(0,B$D,"rotation",function(){return this._rotation},function(B$O){this._rotation=B$O,this._matNeedUpdte=!0}),B$H(B$J,["_tempOffsetV3",function(){return this._tempOffsetV3=new B$iJ(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new B$DJ},"_tempTitlingV3",function(){return this._tempTitlingV3=new B$iJ(1,1,1)}])}(),function(B$D){function B$O(){this.x=NaN,this.y=NaN,this.z=NaN,B$O.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}B$G(B$O,"laya.d3.core.particleShuriKen.module.shape.BoxShape",B$D);var B$J=B$O.prototype;B$J._getShapeBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=.5*-this.x,B$J[1]=.5*-this.y,B$J[2]=.5*-this.z;var B$D=B$O.max.elements;B$D[0]=.5*this.x,B$D[1]=.5*this.y,B$D[2]=.5*this.z},B$J._getSpeedBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=0,B$J[1]=0,B$J[2]=0;var B$D=B$O.max.elements;B$D[0]=0,B$D[1]=1,B$D[2]=0},B$J.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements,B$C=B$J.elements;B$D?(B$D.seed=B$p[16],B$I._randomPointInsideHalfUnitBox(B$O,B$D),B$p[16]=B$D.seed):B$I._randomPointInsideHalfUnitBox(B$O),B$m[0]=this.x*B$m[0],B$m[1]=this.y*B$m[1],B$m[2]=this.z*B$m[2],this.randomDirection?B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J):(B$C[0]=0,B$C[1]=0,B$C[2]=1)},B$J.cloneTo=function(B$O){B$D.prototype.cloneTo.call(this,B$O);var B$J=B$O;B$J.x=this.x,B$J.y=this.y,B$J.z=this.z,B$J.randomDirection=this.randomDirection}}(B$l),function(B$D){function B$i(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,B$i.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}B$G(B$i,"laya.d3.core.particleShuriKen.module.shape.CircleShape",B$D);var B$O=B$i.prototype;B$O._getShapeBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[2]=-this.radius,B$J[1]=0;var B$D=B$O.max.elements;B$D[0]=B$D[2]=this.radius,B$D[1]=0},B$O._getSpeedBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[1]=-1,B$J[2]=0;var B$D=B$O.max.elements;B$D[0]=B$D[1]=1,B$D[2]=0},B$O.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements,B$C=B$i._tempPositionPoint.elements;B$D?(B$D.seed=B$p[16],this.emitFromEdge?B$I._randomPointUnitArcCircle(this.arc,B$i._tempPositionPoint,B$D):B$I._randomPointInsideUnitArcCircle(this.arc,B$i._tempPositionPoint,B$D),B$p[16]=B$D.seed):this.emitFromEdge?B$I._randomPointUnitArcCircle(this.arc,B$i._tempPositionPoint):B$I._randomPointInsideUnitArcCircle(this.arc,B$i._tempPositionPoint),B$m[0]=-B$C[0],B$m[1]=B$C[1],B$m[2]=0,B$iJ.scale(B$O,this.radius,B$O),this.randomDirection?B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J):B$O.cloneTo(B$J)},B$O.cloneTo=function(B$O){B$D.prototype.cloneTo.call(this,B$O);var B$J=B$O;B$J.radius=this.radius,B$J.arc=this.arc,B$J.emitFromEdge=this.emitFromEdge,B$J.randomDirection=this.randomDirection},B$H(B$i,["_tempPositionPoint",function(){return this._tempPositionPoint=new B$CJ}])}(B$l),function(B$D){function B$Y(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,B$Y.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}B$G(B$Y,"laya.d3.core.particleShuriKen.module.shape.ConeShape",B$D);var B$O=B$Y.prototype;B$O._getShapeBoundBox=function(B$O){var B$J=this.radius+this.length*Math.sin(this.angle),B$D=this.length*Math.cos(this.angle),B$p=B$O.min.elements;B$p[0]=B$p[1]=-B$J,B$p[2]=0;var B$m=B$O.max.elements;B$m[0]=B$m[1]=B$J,B$m[2]=B$D},B$O._getSpeedBoundBox=function(B$O){var B$J=Math.sin(this.angle),B$D=B$O.min.elements;B$D[0]=B$D[1]=-B$J,B$D[2]=0;var B$p=B$O.max.elements;B$p[0]=B$D[1]=B$J,B$p[2]=1},B$O.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){var B$m,B$C=B$O.elements,B$i=B$J.elements,B$k=B$Y._tempPositionPoint.elements,B$_=NaN,B$L=NaN,B$r=Math.cos(this.angle),B$H=Math.sin(this.angle);switch(this.emitType){case 0:B$D?(B$D.seed=B$p[16],B$I._randomPointInsideUnitCircle(B$Y._tempPositionPoint,B$D),B$p[16]=B$D.seed):B$I._randomPointInsideUnitCircle(B$Y._tempPositionPoint),B$_=B$k[0],B$L=B$k[1],B$C[0]=B$_*this.radius,B$C[1]=B$L*this.radius,B$C[2]=0,this.randomDirection?(B$D?(B$D.seed=B$p[17],B$I._randomPointInsideUnitCircle(B$Y._tempDirectionPoint,B$D),B$p[17]=B$D.seed):B$I._randomPointInsideUnitCircle(B$Y._tempDirectionPoint),B$m=B$Y._tempDirectionPoint.elements,B$i[0]=B$m[0]*B$H,B$i[1]=B$m[1]*B$H):(B$i[0]=B$_*B$H,B$i[1]=B$L*B$H),B$i[2]=B$r;break;case 1:B$D?(B$D.seed=B$p[16],B$I._randomPointUnitCircle(B$Y._tempPositionPoint,B$D),B$p[16]=B$D.seed):B$I._randomPointUnitCircle(B$Y._tempPositionPoint),B$_=B$k[0],B$L=B$k[1],B$C[0]=B$_*this.radius,B$C[1]=B$L*this.radius,B$C[2]=0,this.randomDirection?(B$D?(B$D.seed=B$p[17],B$I._randomPointInsideUnitCircle(B$Y._tempDirectionPoint,B$D),B$p[17]=B$D.seed):B$I._randomPointInsideUnitCircle(B$Y._tempDirectionPoint),B$m=B$Y._tempDirectionPoint.elements,B$i[0]=B$m[0]*B$H,B$i[1]=B$m[1]*B$H):(B$i[0]=B$_*B$H,B$i[1]=B$L*B$H),B$i[2]=B$r;break;case 2:B$D?(B$D.seed=B$p[16],B$I._randomPointInsideUnitCircle(B$Y._tempPositionPoint,B$D)):B$I._randomPointInsideUnitCircle(B$Y._tempPositionPoint),B$_=B$k[0],B$L=B$k[1],B$C[0]=B$_*this.radius,B$C[1]=B$L*this.radius,B$i[B$C[2]=0]=B$_*B$H,B$i[1]=B$L*B$H,B$i[2]=B$r,B$iJ.normalize(B$J,B$J),B$D?(B$iJ.scale(B$J,this.length*B$D.getFloat(),B$J),B$p[16]=B$D.seed):B$iJ.scale(B$J,this.length*Math.random(),B$J),B$iJ.add(B$O,B$J,B$O),this.randomDirection&&(B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J));break;case 3:B$D?(B$D.seed=B$p[16],B$I._randomPointUnitCircle(B$Y._tempPositionPoint,B$D)):B$I._randomPointUnitCircle(B$Y._tempPositionPoint),B$_=B$k[0],B$L=B$k[1],B$C[0]=B$_*this.radius,B$C[1]=B$L*this.radius,B$i[B$C[2]=0]=B$_*B$H,B$i[1]=B$L*B$H,B$i[2]=B$r,B$iJ.normalize(B$J,B$J),B$D?(B$iJ.scale(B$J,this.length*B$D.getFloat(),B$J),B$p[16]=B$D.seed):B$iJ.scale(B$J,this.length*Math.random(),B$J),B$iJ.add(B$O,B$J,B$O),this.randomDirection&&(B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J));break;default:throw new Error("ConeShape:emitType is invalid.")}},B$O.cloneTo=function(B$O){B$D.prototype.cloneTo.call(this,B$O);var B$J=B$O;B$J.angle=this.angle,B$J.radius=this.radius,B$J.length=this.length,B$J.emitType=this.emitType,B$J.randomDirection=this.randomDirection},B$H(B$Y,["_tempPositionPoint",function(){return this._tempPositionPoint=new B$CJ},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new B$CJ}])}(B$l),function(B$D){function B$O(){this.radius=NaN,this.emitFromShell=!1,B$O.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}B$G(B$O,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",B$D);var B$J=B$O.prototype;B$J._getShapeBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[1]=B$J[2]=-this.radius;var B$D=B$O.max.elements;B$D[0]=B$D[1]=this.radius,B$D[2]=0},B$J._getSpeedBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[1]=-1,B$J[2]=0;var B$D=B$O.max.elements;B$D[0]=B$D[1]=B$D[2]=1},B$J.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){var B$m=B$O.elements;B$D?(B$D.seed=B$p[16],this.emitFromShell?B$I._randomPointUnitSphere(B$O,B$D):B$I._randomPointInsideUnitSphere(B$O,B$D),B$p[16]=B$D.seed):this.emitFromShell?B$I._randomPointUnitSphere(B$O):B$I._randomPointInsideUnitSphere(B$O),B$iJ.scale(B$O,this.radius,B$O);var B$C=B$m[2];B$C<0&&(B$m[2]=-1*B$C),this.randomDirection?B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J):B$O.cloneTo(B$J)},B$J.cloneTo=function(B$O){B$D.prototype.cloneTo.call(this,B$O);var B$J=B$O;B$J.radius=this.radius,B$J.emitFromShell=this.emitFromShell,B$J.randomDirection=this.randomDirection}}(B$l),function(B$D){function B$O(){this.radius=NaN,this.emitFromShell=!1,B$O.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}B$G(B$O,"laya.d3.core.particleShuriKen.module.shape.SphereShape",B$D);var B$J=B$O.prototype;B$J._getShapeBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[1]=B$J[2]=-this.radius;var B$D=B$O.max.elements;B$D[0]=B$D[1]=B$D[2]=this.radius},B$J._getSpeedBoundBox=function(B$O){var B$J=B$O.min.elements;B$J[0]=B$J[1]=B$J[2]=-1;var B$D=B$O.max.elements;B$D[0]=B$D[1]=B$D[2]=1},B$J.generatePositionAndDirection=function(B$O,B$J,B$D,B$p){B$D?(B$D.seed=B$p[16],this.emitFromShell?B$I._randomPointUnitSphere(B$O,B$D):B$I._randomPointInsideUnitSphere(B$O,B$D),B$p[16]=B$D.seed):this.emitFromShell?B$I._randomPointUnitSphere(B$O):B$I._randomPointInsideUnitSphere(B$O),B$iJ.scale(B$O,this.radius,B$O),this.randomDirection?B$D?(B$D.seed=B$p[17],B$I._randomPointUnitSphere(B$J,B$D),B$p[17]=B$D.seed):B$I._randomPointUnitSphere(B$J):B$O.cloneTo(B$J)},B$J.cloneTo=function(B$O){B$D.prototype.cloneTo.call(this,B$O);var B$J=B$O;B$J.radius=this.radius,B$J.emitFromShell=this.emitFromShell,B$J.randomDirection=this.randomDirection}}(B$l),function(B$O){function B$J(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,B$J.__super.call(this)}return B$G(B$J,"laya.d3.core.render.SubMeshRenderElement",B$Z),B$J}()),B$eJ=function(B$O){function B$h(B$O,B$J,B$D,B$p,B$m,B$C){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=B$O,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[B$GJ.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[B$UJ.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[B$UJ.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[B$sJ.SHADERDEFINE_ALPHATEST]="ALPHATEST";B$h.__super.call(this,B$O,B$J,B$D,null,{}),this._attributeMap=B$p;var B$i;for(B$i in B$m){var B$k=B$m[B$i];switch(B$k[1]){case 0:this._renderElementUniformMap[B$i]=B$k[0];break;case 1:this._materialUniformMap[B$i]=B$k[0];break;case 2:this._spriteUniformMap[B$i]=B$k[0];break;case 3:this._cameraUniformMap[B$i]=B$k[0];break;case 4:this._sceneUniformMap[B$i]=B$k[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}B$G(B$h,"laya.d3.shader.ShaderCompile3D",B$A);var B$J=B$h.prototype;return B$J._definesToNameDic=function(B$O,B$J){for(var B$D={},B$p=1,B$m=0;B$m<32&&!(B$O<(B$p=1<<B$m));B$m++)if(B$O&B$p){var B$C=B$J[B$p];B$C&&(B$D[B$C]="")}return B$D},B$J.withCompile=function(B$O,B$J,B$D,B$p){var B$m,B$C,B$i;if(B$C=this.sharders[B$O])if(B$i=B$C[B$J]){if(B$m=B$i[B$D])return B$m}else B$i=B$C[B$J]=[];else B$i=(B$C=this.sharders[B$O]=[])[B$J]=[];var B$k,B$_=this._definesToNameDic(B$O,B$h._globalInt2name),B$L=this._definesToNameDic(B$J,this._spriteInt2name),B$r=this._definesToNameDic(B$D,this._materialInt2name),B$H={},B$Y="";if(B$_)for(B$k in B$_)B$Y+="#define "+B$k+"\n",B$H[B$k]=!0;if(B$L)for(B$k in B$L)B$Y+="#define "+B$k+"\n",B$H[B$k]=!0;if(B$r)for(B$k in B$r)B$Y+="#define "+B$k+"\n",B$H[B$k]=!0;var B$G=B$RJ.nameKey.getName(this._name)+" compile ("+B$O+","+B$J+","+B$D+")",B$X=this._VS.toscript(B$H,[]),B$c=this._PS.toscript(B$H,[]);B$o.now();if(B$m=B$RJ.create(B$Y+B$X.join("\n"),B$Y+B$c.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,B$p,B$G),B$i[B$D]=B$m,laya.d3.shader.ShaderCompile3D.debugMode)B$o.now();return B$m},B$J.precompileShaderWithShaderDefine=function(B$O,B$J,B$D){this.withCompile(B$O,B$J,B$D,!0)},B$J.addMaterialDefines=function(B$O){var B$J=B$O.defines;for(var B$D in B$J){var B$p=B$J[B$D],B$m=parseInt(B$D);this._materialInt2name[B$m]=B$p,this._materialName2Int[B$p]=B$m}},B$J.addSpriteDefines=function(B$O){var B$J=B$O.defines;for(var B$D in B$J){var B$p=B$J[B$D],B$m=parseInt(B$D);this._spriteInt2name[B$m]=B$p,this._spriteName2Int[B$p]=B$m}},B$J.getMaterialDefineByName=function(B$O){return this._materialName2Int[B$O]},B$J.registerMaterialDefine=function(B$O){var B$J=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[B$J]=B$O,this._materialName2Int[B$O]=B$J},B$J.registerSpriteDefine=function(B$O){var B$J=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[B$J]=B$O,this._spriteName2Int[B$O]=B$J},B$h._globalRegDefine=function(B$O,B$J){B$h._globalInt2name[B$J]=B$O},B$h.add=function(B$O,B$J,B$D,B$p,B$m){return laya.d3.shader.ShaderCompile3D._preCompileShader[B$O]=new B$h(B$O,B$J,B$D,B$p,B$m,B$A.includes)},B$h.get=function(B$O){return laya.d3.shader.ShaderCompile3D._preCompileShader[B$RJ.nameKey.getID(B$O)]},B$h._preCompileShader={},B$h._globalInt2name=[],B$h.debugMode=!1,B$h.SHADERDEFINE_HIGHPRECISION=1,B$h.SHADERDEFINE_FOG=4,B$h.SHADERDEFINE_DIRECTIONLIGHT=8,B$h.SHADERDEFINE_POINTLIGHT=16,B$h.SHADERDEFINE_SPOTLIGHT=32,B$h.SHADERDEFINE_UV0=64,B$h.SHADERDEFINE_COLOR=128,B$h.SHADERDEFINE_UV1=256,B$h.SAHDERDEFINE_DEPTHFOG=131072,B$h}(),B$tJ=function(B$O){function B$X(){B$X.__super.call(this)}B$G(B$X,"laya.d3.graphics.MeshSprite3DStaticBatchManager",B$pO);var B$J=B$X.prototype;return B$J._getStaticBatch=function(B$O,B$J,B$D,B$p){var B$m,B$C;return B$C=B$O?B$O.id.toString()+B$D.id.toString()+B$J.id.toString()+B$p.toString():B$D.id.toString()+B$J.id.toString()+B$p.toString(),this._staticBatches[B$C]?B$m=this._staticBatches[B$C]:this._staticBatches[B$C]=B$m=new B$zJ(B$C,this,B$O,B$J,B$D),B$m},B$J._initStaticBatchs=function(B$O){var B$J,B$D;this._initBatchRenderElements.sort(B$X._sortPrepareStaticBatch);for(var B$p,B$m=!1,B$C=0,B$i=0,B$k=this._initBatchRenderElements.length;B$i<B$k;B$i++){var B$_,B$L=this._initBatchRenderElements[B$i],B$r=B$L.renderObj._getVertexBuffer(0);B$L._sprite3D;if(B$D===B$r.vertexDeclaration&&B$J===B$L._material)if(B$m)B$p._addCombineBatchRenderObjTest(B$L)?(B$_=B$L._staticBatch)!==B$p&&(B$_&&B$_._deleteCombineBatchRenderObj(B$L),B$p._addCombineBatchRenderObj(B$L)):(B$m=!1,B$C++);else{var B$H=this._initBatchRenderElements[B$i-1],B$Y=B$H.renderObj,B$G=B$L.renderObj;B$m=!(65535<B$Y._getVertexBuffer().vertexCount+B$G._getVertexBuffer().vertexCount)&&(B$p=this._getStaticBatch(B$O,B$D,B$J,B$C),(B$_=B$H._staticBatch)!==B$p&&(B$_&&B$_._deleteCombineBatchRenderObj(B$H),B$p._addCombineBatchRenderObj(B$H)),(B$_=B$L._staticBatch)!==B$p&&(B$_&&B$_._deleteCombineBatchRenderObj(B$L),B$p._addCombineBatchRenderObj(B$L)),!0)}else B$m=!1,B$C=0;B$J=B$L._material,B$D=B$r.vertexDeclaration}},B$X._sortPrepareStaticBatch=function(B$O,B$J){var B$D=B$O._render,B$p=B$J._render,B$m=B$D.lightmapIndex-B$p.lightmapIndex;if(0!=B$m)return B$m;var B$C=B$D.receiveShadow-B$p.receiveShadow;if(0!=B$C)return B$C;var B$i=B$O._mainSortID-B$J._mainSortID;return 0==B$i?B$O.renderObj.triangleCount-B$J.renderObj.triangleCount:B$i},B$X}(),B$zJ=function(B$O){function B$C(B$O,B$J,B$D,B$p,B$m){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,B$C.__super.call(this,B$O,B$J,B$D),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=B$p,this._material=B$m}B$G(B$C,"laya.d3.graphics.SubMeshStaticBatch",B$mO);var B$J=B$C.prototype;return B$J._compareBatchRenderElement=function(B$O,B$J){return B$O._batchIndexStart>B$J._batchIndexStart},B$J._addCombineBatchRenderObjTest=function(B$O){var B$J=B$O.renderObj._vertexCount;return!(65535<(0<B$J?this._currentCombineVertexCount+B$J:this._currentCombineVertexCount+B$O.renderObj._getVertexBuffer().vertexCount))},B$J._addCombineBatchRenderObj=function(B$O){var B$J=B$O.renderObj,B$D=B$J._vertexCount;this._initBatchRenderElements.push(B$O),B$O._staticBatch=this,0<B$D?(this._currentCombineIndexCount+=B$J._indexCount,this._currentCombineVertexCount+=B$D):(this._currentCombineIndexCount=this._currentCombineIndexCount+B$J._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+B$J._getVertexBuffer().vertexCount),this._needFinishCombine=!0},B$J._deleteCombineBatchRenderObj=function(B$O){var B$J=B$O.renderObj,B$D=this._initBatchRenderElements.indexOf(B$O);if(-1!==B$D){this._initBatchRenderElements.splice(B$D,1),B$O._staticBatch=null;var B$p=B$J._vertexCount;0<B$p?(this._currentCombineIndexCount=this._currentCombineIndexCount-B$J._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-B$p):(this._currentCombineIndexCount=this._currentCombineIndexCount-B$J._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-B$J._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},B$J._finishInit=function(){if(this._needFinishCombine){var B$O=0,B$J=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var B$D=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),B$p=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=B$lJ.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=B$uJ.create("ushort",this._currentCombineIndexCount,35044);for(var B$m=0,B$C=this._initBatchRenderElements.length;B$m<B$C;B$m++){var B$i=this._initBatchRenderElements[B$m],B$k=B$i.renderObj,B$_=B$k._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,B$i._sprite3D),B$L=B$k.getIndices(),B$r=B$i._sprite3D.transform._isFrontFaceInvert,B$H=B$O/(this._vertexDeclaration.vertexStride/4)-B$k._vertexStart,B$Y=B$J,B$G=B$Y+B$L.length;B$i._batchIndexStart=B$Y,B$i._batchIndexEnd=B$G,B$p.set(B$L,B$J);var B$X=0;if(B$r)for(B$X=B$Y;B$X<B$G;B$X+=3){B$p[B$X]=B$H+B$p[B$X];var B$c=B$p[B$X+1],B$h=B$p[B$X+2];B$p[B$X+1]=B$H+B$h,B$p[B$X+2]=B$H+B$c}else for(B$X=B$Y;B$X<B$G;B$X+=3)B$p[B$X]=B$H+B$p[B$X],B$p[B$X+1]=B$H+B$p[B$X+1],B$p[B$X+2]=B$H+B$p[B$X+2];B$J+=B$L.length,B$D.set(B$_,B$O),B$O+=B$_.length}this._vertexBuffer.setData(B$D),this._indexBuffer.setData(B$p),this._needFinishCombine=!1}},B$J._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new B$aJ)},B$J._getRenderElement=function(B$O,B$J,B$D){for(var B$p,B$m,B$C=this._batchRenderElements.length,B$i=!0,B$k=0;B$k<B$C;B$k++){var B$_,B$L,B$r=(B$m=this._batchRenderElements[B$k])._sprite3D._render;if(0!==B$k&&(B$i=(B$_=(B$p=this._batchRenderElements[B$k-1])._sprite3D._render).lightmapIndex!==B$r.lightmapIndex||B$_.receiveShadow!==B$r.receiveShadow||B$p._batchIndexEnd!==B$m._batchIndexStart),B$i){(B$L=this._getCombineRenderElementFromPool()).renderObj=this,B$L._material=this._material,B$L._batchIndexStart=B$m._batchIndexStart,B$L._batchIndexEnd=B$m._batchIndexEnd;var B$H=B$r.lightmapIndex,B$Y=B$H+1,B$G=this._batchOwnerIndices[B$Y];B$G||(B$G=this._batchOwnerIndices[B$Y]=[]);var B$X,B$c=B$G[B$m._render.receiveShadow?1:0];void 0===B$c?(B$G[B$r.receiveShadow?1:0]=this._batchOwners.length,(B$X=new B$nJ(null,"StaticBatchMeshSprite3D"))._scene=B$J,B$X._transform=this._rootOwner?this._rootOwner._transform:null,B$X._render.lightmapIndex=B$H,B$X._render.receiveShadow=B$m._render.receiveShadow,this._batchOwners.push(B$X)):B$X=this._batchOwners[B$c],B$X._render._renderUpdate(B$D),B$L._sprite3D=B$X,B$O.push(B$L)}else B$L._batchIndexEnd=B$m._batchIndexEnd}},B$J._beforeRender=function(B$O){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},B$J._render=function(B$O){var B$J=B$O.renderElement,B$D=B$J._batchIndexStart,B$p=B$J._batchIndexEnd-B$D;B$P.mainContext.drawElements(4,B$p,5123,2*B$D),B$e.drawCall++,B$e.trianglesFaces+=B$p/3},B$J.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},B$J._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),this._vertexBuffer},B$C}(),B$gJ=function(B$O){function B$J(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,B$J.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}B$G(B$J,"laya.d3.core.ComponentNode",B$L);var B$D=B$J.prototype;return B$D.addComponent=function(B$O){var B$J,B$D=this._componentsMap.indexOf(B$O);if(-1===B$D)B$J=[],this._componentsMap.push(B$O),this._typeComponentsIndices.push(B$J);else if(B$J=this._typeComponentsIndices[B$D],this._components[B$J[0]].isSingleton)throw new Error("无法单实例创建"+B$O+"组件，"+B$O+"组件已存在！");var B$p=B$m.getInstance(B$O);return B$J.push(this._components.length),this._components.push(B$p),B$p instanceof laya.d3.component.Script&&this._scripts.push(B$p),B$p._initialize(this),B$p},B$D._removeComponent=function(B$O,B$J){var B$D=this._typeComponentsIndices[B$O],B$p=B$D[B$J],B$m=this._components[B$p];this._components.splice(B$p,1),B$m instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(B$m),1),B$D.splice(B$J,1),0===B$D.length&&(this._typeComponentsIndices.splice(B$O,1),this._componentsMap.splice(B$O,1));for(var B$C=0,B$i=this._componentsMap.length;B$C<B$i;B$C++)for(var B$k=(B$D=this._typeComponentsIndices[B$C]).length-1;0<=B$k;B$k--){var B$_=B$D[B$k];if(!(B$p<B$_))break;B$D[B$k]=--B$_}B$m._destroy()},B$D.getComponentByType=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D=this._componentsMap.indexOf(B$O);return-1===B$D?null:this._components[this._typeComponentsIndices[B$D][B$J]]},B$D.getComponentsByType=function(B$O,B$J){var B$D=this._componentsMap.indexOf(B$O);if(-1!==B$D){var B$p=this._typeComponentsIndices[B$D],B$m=B$p.length;B$J.length=B$m;for(var B$C=0;B$C<B$m;B$C++)B$J[B$C]=this._components[B$p[B$C]]}else B$J.length=0},B$D.getComponentByIndex=function(B$O){return this._components[B$O]},B$D.removeComponentByType=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D=this._componentsMap.indexOf(B$O);-1!==B$D&&this._removeComponent(B$D,B$J)},B$D.removeComponentsByType=function(B$O){var B$J=this._componentsMap.indexOf(B$O);if(-1!==B$J)for(var B$D=this._typeComponentsIndices[B$J],B$p=0,B$m=B$D.length;B$p<B$m;B$D.length<B$m?B$m--:B$p++)this._removeComponent(B$J,B$p)},B$D.removeAllComponent=function(){for(var B$O=0,B$J=this._componentsMap.length;B$O<B$J;this._componentsMap.length<B$J?B$J--:B$O++)this.removeComponentsByType(this._componentsMap[B$O])},B$D._updateComponents=function(B$O){for(var B$J=0,B$D=this._components.length;B$J<B$D;B$J++){var B$p=this._components[B$J];!B$p.started&&(B$p._start(B$O),B$p.started=!0),B$p.enable&&B$p._update(B$O)}},B$D._lateUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._lateUpdate(B$O)}},B$D._preRenderUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._preRenderUpdate(B$O)}},B$D._postRenderUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._postRenderUpdate(B$O)}},B$J}(),B$sJ=function(B$p){function B$O(){B$O.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new B$YJ,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new B$kJ(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}B$G(B$O,"laya.d3.core.material.BaseMaterial",B$p);var B$J=B$O.prototype;return B$d.imps(B$J,{"laya.d3.core.IClone":!0}),B$J._addShaderDefine=function(B$O){this._shaderDefineValue|=B$O},B$J._removeShaderDefine=function(B$O){this._shaderDefineValue&=~B$O},B$J._addDisablePublicShaderDefine=function(B$O){this._disablePublicShaderDefine|=B$O},B$J._removeDisablePublicShaderDefine=function(B$O){this._disablePublicShaderDefine&=~B$O},B$J._setBuffer=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J),this._values[B$O]=B$J},B$J._getBuffer=function(B$O){return this._values[B$O]},B$J._setMatrix4x4=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J?B$J.elements:null),this._values[B$O]=B$J},B$J._getMatrix4x4=function(B$O){return this._values[B$O]},B$J._setInt=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J),this._values[B$O]=B$J},B$J._getInt=function(B$O){return this._values[B$O]},B$J._setNumber=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J),this._values[B$O]=B$J},B$J._getNumber=function(B$O){return this._values[B$O]},B$J._setBool=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J),this._values[B$O]=B$J},B$J._getBool=function(B$O){return this._values[B$O]},B$J._setVector2=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J?B$J.elements:null),this._values[B$O]=B$J},B$J._getVector2=function(B$O){return this._values[B$O]},B$J._setColor=function(B$O,B$J){this._shaderValues.setValue(B$O,B$J?B$J.elements:null),this._values[B$O]=B$J},B$J._getColor=function(B$O){return this._values[B$O]},B$J._setTexture=function(B$O,B$J){var B$D=this._values[B$O];this._values[B$O]=B$J,this._shaderValues.setValue(B$O,B$J),0<this.referenceCount&&(B$D&&B$D._removeReference(),B$J&&B$J._addReference())},B$J._getTexture=function(B$O){return this._values[B$O]},B$J._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},B$J._getShader=function(B$O,B$J,B$D){var B$p=(B$O|B$J)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(B$p,B$D,this._shaderDefineValue),this._shader},B$J._setRenderStateBlendDepth=function(){var B$O=B$P.mainContext;switch(B$E.setDepthMask(B$O,this.depthWrite),0===this.depthTest?B$E.setDepthTest(B$O,!1):(B$E.setDepthTest(B$O,!0),B$E.setDepthFunc(B$O,this.depthTest)),this.blend){case 0:B$E.setBlend(B$O,!1);break;case 1:B$E.setBlend(B$O,!0),B$E.setBlendFunc(B$O,this.srcBlend,this.dstBlend);break;case 2:B$E.setBlend(B$O,!0)}},B$J._setRenderStateFrontFace=function(B$O,B$J){var B$D=B$P.mainContext,B$p=0;switch(this.cull){case 0:B$E.setCullFace(B$D,!1);break;case 1:B$E.setCullFace(B$D,!0),B$p=B$O?B$J&&B$J._isFrontFaceInvert?2305:2304:B$J&&B$J._isFrontFaceInvert?2304:2305,B$E.setFrontFace(B$D,B$p);break;case 2:B$E.setCullFace(B$D,!0),B$p=B$O?B$J&&B$J._isFrontFaceInvert?2304:2305:B$J&&B$J._isFrontFaceInvert?2305:2304,B$E.setFrontFace(B$D,B$p)}},B$J.onAsynLoaded=function(B$O,B$J,B$D){var B$p=B$J[0],B$m=B$J[1];switch(B$p.version){case"LAYAMATERIAL:01":var B$C=0,B$i=0,B$k=B$p.props;for(var B$_ in B$k)switch(B$_){case"vectors":var B$L=B$k[B$_];for(B$C=0,B$i=B$L.length;B$C<B$i;B$C++){var B$r=B$L[B$C],B$H=B$r.value;switch(B$H.length){case 2:this[B$r.name]=new B$CJ(B$H[0],B$H[1]);break;case 3:this[B$r.name]=new B$iJ(B$H[0],B$H[1],B$H[2]);break;case 4:this[B$r.name]=new B$kJ(B$H[0],B$H[1],B$H[2],B$H[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var B$Y=B$k[B$_];for(B$C=0,B$i=B$Y.length;B$C<B$i;B$C++){var B$G=B$Y[B$C],B$X=B$G.path;B$X&&(this[B$G.name]=B$y.getRes(B$m[B$X]))}break;case"defines":var B$c=B$k[B$_];for(B$C=0,B$i=B$c.length;B$C<B$i;B$C++){var B$h=this._shaderCompile.getMaterialDefineByName(B$c[B$C]);this._addShaderDefine(B$h)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[B$_]=B$k[B$_];break;case"renderQueue":switch(B$k[B$_]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[B$_]=B$k[B$_]}break;case"LAYAMATERIAL:02":for(B$_ in B$k=B$p.props)switch(B$_){case"vectors":for(B$C=0,B$i=(B$L=B$k[B$_]).length;B$C<B$i;B$C++)switch((B$H=(B$r=B$L[B$C]).value).length){case 2:this[B$r.name]=new B$CJ(B$H[0],B$H[1]);break;case 3:this[B$r.name]=new B$iJ(B$H[0],B$H[1],B$H[2]);break;case 4:this[B$r.name]=new B$kJ(B$H[0],B$H[1],B$H[2],B$H[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(B$C=0,B$i=(B$Y=B$k[B$_]).length;B$C<B$i;B$C++)(B$X=(B$G=B$Y[B$C]).path)&&(this[B$G.name]=B$y.getRes(B$m[B$X]));break;case"defines":for(B$C=0,B$i=(B$c=B$k[B$_]).length;B$C<B$i;B$C++)B$h=this._shaderCompile.getMaterialDefineByName(B$c[B$C]),this._addShaderDefine(B$h);break;default:this[B$_]=B$k[B$_]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},B$J._addReference=function(){B$p.prototype._addReference.call(this);for(var B$O=0,B$J=this._values.length;B$O<B$J;B$O++){var B$D=this._values[B$O];B$D&&B$D instanceof laya.d3.resource.BaseTexture&&B$D._addReference()}},B$J._removeReference=function(){B$p.prototype._removeReference.call(this);for(var B$O=0,B$J=this._values.length;B$O<B$J;B$O++){var B$D=this._values[B$O];B$D&&B$D instanceof laya.d3.resource.BaseTexture&&B$D._removeReference()}},B$J.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},B$J.setShaderName=function(B$O){var B$J=B$RJ.nameKey.getID(B$O);if(-1===B$J)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=B$eJ._preCompileShader[B$J]},B$J.cloneTo=function(B$O){var B$J=B$O;B$J.name=this.name,B$J.cull=this.cull,B$J.blend=this.blend,B$J.srcBlend=this.srcBlend,B$J.dstBlend=this.dstBlend,B$J.srcBlendRGB=this.srcBlendRGB,B$J.dstBlendRGB=this.dstBlendRGB,B$J.srcBlendAlpha=this.srcBlendAlpha,B$J.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(B$J.blendConstColor),B$J.blendEquation=this.blendEquation,B$J.blendEquationRGB=this.blendEquationRGB,B$J.blendEquationAlpha=this.blendEquationAlpha,B$J.depthTest=this.depthTest,B$J.depthWrite=this.depthWrite,B$J.renderQueue=this.renderQueue,B$J._shader=this._shader,B$J._disablePublicShaderDefine=this._disablePublicShaderDefine,B$J._shaderDefineValue=this._shaderDefineValue;var B$D,B$p=0,B$m=B$J._shaderValues;B$J._shaderValues.data.length=this._shaderValues.data.length;var B$C=this._values.length,B$i=B$J._values;for(B$p=0,B$D=B$i.length=B$C;B$p<B$D;B$p++){var B$k=this._values[B$p];if(B$k)if("number"==typeof B$k)B$i[B$p]=B$k,B$m.data[B$p]=B$k;else if("number"==typeof B$k&&Math.floor(B$k)==B$k)B$i[B$p]=B$k,B$m.data[B$p]=B$k;else if("boolean"==typeof B$k)B$i[B$p]=B$k,B$m.data[B$p]=B$k;else if(B$k instanceof laya.d3.math.Vector2){var B$_=B$i[B$p]||(B$i[B$p]=new B$CJ);B$k.cloneTo(B$_),B$m.data[B$p]=B$_.elements}else if(B$k instanceof laya.d3.math.Vector3){var B$L=B$i[B$p]||(B$i[B$p]=new B$iJ);B$k.cloneTo(B$L),B$m.data[B$p]=B$L.elements}else if(B$k instanceof laya.d3.math.Vector4){var B$r=B$i[B$p]||(B$i[B$p]=new B$kJ);B$k.cloneTo(B$r),B$m.data[B$p]=B$r.elements}else if(B$k instanceof laya.d3.math.Matrix4x4){var B$H=B$i[B$p]||(B$i[B$p]=new B$OJ);B$k.cloneTo(B$H),B$m.data[B$p]=B$H.elements}else B$k instanceof laya.d3.resource.BaseTexture&&(B$i[B$p]=B$k,B$m.data[B$p]=B$k)}},B$J.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$X(0,B$J,"alphaTestValue",function(){return this._getNumber(0)},function(B$O){this._setNumber(0,B$O)}),B$X(0,B$J,"alphaTest",function(){return this._alphaTest},function(B$O){(this._alphaTest=B$O)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),B$O.__init__=function(){B$O.SHADERDEFINE_ALPHATEST=B$O.shaderDefines.registerDefine("ALPHATEST")},B$O.RENDERQUEUE_OPAQUE=2e3,B$O.RENDERQUEUE_ALPHATEST=2450,B$O.RENDERQUEUE_TRANSPARENT=3e3,B$O.CULL_NONE=0,B$O.CULL_FRONT=1,B$O.CULL_BACK=2,B$O.BLEND_DISABLE=0,B$O.BLEND_ENABLE_ALL=1,B$O.BLEND_ENABLE_SEPERATE=2,B$O.BLENDPARAM_ZERO=0,B$O.BLENDPARAM_ONE=1,B$O.BLENDPARAM_SRC_COLOR=768,B$O.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,B$O.BLENDPARAM_DST_COLOR=774,B$O.BLENDPARAM_ONE_MINUS_DST_COLOR=775,B$O.BLENDPARAM_SRC_ALPHA=770,B$O.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,B$O.BLENDPARAM_DST_ALPHA=772,B$O.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,B$O.BLENDPARAM_SRC_ALPHA_SATURATE=776,B$O.BLENDEQUATION_ADD=0,B$O.BLENDEQUATION_SUBTRACT=1,B$O.BLENDEQUATION_REVERSE_SUBTRACT=2,B$O.DEPTHTEST_OFF=0,B$O.DEPTHTEST_NEVER=512,B$O.DEPTHTEST_LESS=513,B$O.DEPTHTEST_EQUAL=514,B$O.DEPTHTEST_LEQUAL=515,B$O.DEPTHTEST_GREATER=516,B$O.DEPTHTEST_NOTEQUAL=517,B$O.DEPTHTEST_GEQUAL=518,B$O.DEPTHTEST_ALWAYS=519,B$O.SHADERDEFINE_ALPHATEST=1,B$O.ALPHATESTVALUE=0,B$H(B$O,["shaderDefines",function(){return this.shaderDefines=new B$rJ}]),B$O}(B$h),B$PJ=function(B$O){function B$J(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,B$J.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}B$G(B$J,"laya.d3.resource.BaseTexture",B$h);var B$D=B$J.prototype;return B$X(0,B$D,"width",function(){return this._width}),B$X(0,B$D,"repeat",function(){return this._repeat},function(B$O){if(this._repeat!==B$O&&(this._repeat=B$O,this._source)){var B$J=B$P.mainContext;B$E.bindTexture(B$J,this._type,this._source),B$q.isPOT(this._width,this._height)&&this._repeat?(B$J.texParameteri(this._type,10242,10497),B$J.texParameteri(this._type,10243,10497)):(B$J.texParameteri(this._type,10242,33071),B$J.texParameteri(this._type,10243,33071))}}),B$X(0,B$D,"height",function(){return this._height}),B$X(0,B$D,"magFifter",function(){return this._magFifter},function(B$O){(this._magFifter=B$O)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(B$O)}),B$X(0,B$D,"wrapModeV",function(){return this._wrapModeV}),B$X(0,B$D,"size",function(){return this._size}),B$X(0,B$D,"wrapModeU",function(){return this._wrapModeU}),B$X(0,B$D,"mipmap",function(){return this._mipmap},function(B$O){this._mipmap=B$O,this._mipmap!=B$O&&this._conchTexture&&this._conchTexture.setMipMap(B$O)}),B$X(0,B$D,"minFifter",function(){return this._minFifter},function(B$O){this._minFifter=B$O,this._minFifter!=B$O&&this._conchTexture&&this._conchTexture.setMinFifter(B$O)}),B$X(0,B$D,"format",function(){return this._format}),B$X(0,B$D,"source",function(){return this.activeResource(),this._source}),B$X(0,B$D,"defaulteTexture",function(){return B$TJ.grayTexture}),B$J.WARPMODE_REPEAT=0,B$J.WARPMODE_CLAMP=1,B$J}(),B$EJ=function(B$O){function B$J(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,B$J.__super.call(this),this._boundingBoxCorners=B$p(8,null)}B$G(B$J,"laya.d3.resource.models.BaseMesh",B$h);var B$D=B$J.prototype;return B$D._getPositions=function(){throw new Error("未Override,请重载该属性！")},B$D._generateBoundingObject=function(){this._boundingSphere=new B$bO(new B$iJ,0),B$bO.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new B$SO(new B$iJ,new B$iJ),B$SO.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},B$D.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},B$D.getRenderElement=function(B$O){throw new Error("未Override,请重载该属性！")},B$X(0,B$D,"subMeshCount",function(){return this._subMeshCount}),B$X(0,B$D,"boundingBox",function(){return this._boundingBox}),B$X(0,B$D,"boundingBoxCorners",function(){return this._boundingBoxCorners}),B$X(0,B$D,"boundingSphere",function(){return this._boundingSphere}),B$J}(),B$oJ=(function(B$O){function B$J(){B$J.__super.call(this)}B$G(B$J,"laya.d3.component.Script",B$AJ);var B$D=B$J.prototype;B$D.onTriggerEnter=function(B$O){},B$D.onTriggerExit=function(B$O){},B$D.onTriggerStay=function(B$O){},B$X(0,B$D,"isSingleton",function(){return B$J._isSingleton}),B$J._isSingleton=!1}(),function(B$O){function B$J(B$O){this._owner=null,this._sharedMesh=null,B$J.__super.call(this),this._owner=B$O}B$G(B$J,"laya.d3.core.MeshFilter",B$O);var B$D=B$J.prototype;return B$D._sharedMeshLoaded=function(){this.event("loaded")},B$D._destroy=function(){B$O.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},B$X(0,B$D,"sharedMesh",function(){return this._sharedMesh},function(B$O){var B$J=this._sharedMesh;B$J&&B$J._removeReference(),(this._sharedMesh=B$O)._addReference(),this.event("meshchanged",[this,B$J,B$O]),B$O.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),B$X(0,B$D,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),B$X(0,B$D,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),B$X(0,B$D,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),B$X(0,B$D,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),B$J}(B$qJ)),B$WJ=function(B$O){function B$J(B$O){B$J.__super.call(this,B$O),B$O.meshFilter.on("meshchanged",this,this._onMeshChanged)}B$G(B$J,"laya.d3.core.MeshRender",B$dJ);var B$D=B$J.prototype;return B$D._onMeshChanged=function(B$O,B$J,B$D){B$D.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:B$D.once("loaded",this,this._onMeshLoaed)},B$D._onMeshLoaed=function(B$O,B$J){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},B$D._calculateBoundingSphereByInitSphere=function(B$O){var B$J=NaN,B$D=this._owner.transform,B$p=B$D.scale.elements,B$m=Math.abs(B$p[0]),B$C=Math.abs(B$p[1]),B$i=Math.abs(B$p[2]);B$J=B$C<=B$m&&B$i<=B$m?B$m:B$i<=B$C?B$C:B$i,B$iJ.transformCoordinate(B$O.center,B$D.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=B$O.radius*B$J},B$D._calculateBoundBoxByInitCorners=function(B$O){for(var B$J=this._owner.transform.worldMatrix,B$D=0;B$D<8;B$D++)B$iJ.transformCoordinate(B$O[B$D],B$J,B$dJ._tempBoundBoxCorners[B$D]);B$SO.createfromPoints(B$dJ._tempBoundBoxCorners,this._boundingBox)},B$D._calculateBoundingSphere=function(){var B$O=this._owner.meshFilter.sharedMesh;null==B$O||null==B$O.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(B$O.boundingSphere)},B$D._calculateBoundingBox=function(){var B$O=this._owner.meshFilter.sharedMesh;null==B$O||null==B$O.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(B$O.boundingBoxCorners)},B$D._renderUpdate=function(B$O){var B$J=this._owner.transform;if(B$J){this._setShaderValueMatrix4x4(0,B$J.worldMatrix);var B$D=this._owner.getProjectionViewWorldMatrix(B$O);this._setShaderValueMatrix4x4(1,B$D)}else this._setShaderValueMatrix4x4(0,B$OJ.DEFAULT),this._setShaderValueMatrix4x4(1,B$O);return B$yJ.debugMode&&this._renderRenderableBoundBox(),!0},B$J}(),B$NJ=function(B$J){function B$p(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,B$p.__super.call(this),this._renderState=new B$B,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new B$YJ,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new B$JO,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new B$iJ(.7,.7,.7),this.ambientColor=new B$iJ(.212,.227,.259),B$P.shaderHighPrecision&&this.addShaderDefine(B$eJ.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}B$G(B$p,"laya.d3.core.scene.Scene",B$J);var B$O=B$p.prototype;return B$d.imps(B$O,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),B$O._setUrl=function(B$O){this._url=B$O},B$O._getGroup=function(){return this._group},B$O._setGroup=function(B$O){this._group=B$O},B$O._display=function(){B$d.stage._scenes.push(this),B$d.stage._scenes.sort(B$p._sortScenes);for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++){var B$D=this._childs[B$O];B$D.active&&B$D._activeHierarchy()}},B$O._unDisplay=function(){var B$O=B$d.stage._scenes;B$O.splice(B$O.indexOf(this),1);for(var B$J=0,B$D=this._childs.length;B$J<B$D;B$J++){var B$p=this._childs[B$J];B$p.active&&B$p._inActiveHierarchy()}},B$O._addChild3D=function(B$O){B$O.transform._onWorldTransform(),B$O._setBelongScene(this),this.displayedInStage&&B$O.active&&B$O._activeHierarchy()},B$O._removeChild3D=function(B$O){B$O.transform.parent=null,this.displayedInStage&&B$O.active&&B$O._inActiveHierarchy(),B$O._setUnBelongScene()},B$O.initOctree=function(B$O,B$J,B$D,B$p,B$m){void 0===B$m&&(B$m=6),this.treeSize=new B$iJ(B$O,B$J,B$D),this.treeLevel=B$m,this.treeRoot=new B$S(this,0),this.treeRoot.init(B$p,this.treeSize)},B$O._prepareUpdateToRenderState=function(B$O,B$J){B$J.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,B$J.scene=this},B$O._prepareSceneToRender=function(B$O){var B$J=this._lights.length;if(0<B$J)for(var B$D=0,B$p=0;B$p<B$J&&!(this._lights[B$p]._prepareToScene(B$O)&&++B$D>=this._enableLightCount);B$p++);},B$O._updateChilds=function(B$O){for(var B$J=0,B$D=this._childs.length;B$J<B$D;++B$J)this._childs[B$J]._update(B$O)},B$O._preRenderScene=function(B$O,B$J,B$D){var B$p,B$m=B$J._viewMatrix,B$C=B$J._projectionMatrix,B$i=B$J._projectionViewMatrix,B$k=0,B$_=B$J.camera;for(B$_.useOcclusionCulling?this.treeRoot?B$DO.renderObjectCullingOctree(B$D,this,B$_,B$m,B$C,B$i):B$DO.renderObjectCulling(B$D,this,B$_,B$m,B$C,B$i):B$DO.renderObjectCullingNoBoundFrustum(this,B$_,B$m,B$C,B$i),B$k=0,B$p=this._quenes.length;B$k<B$p;B$k++)this._quenes[B$k]&&this._quenes[B$k]._preRender(B$J)},B$O._clear=function(B$O,B$J){var B$D=B$J._viewport,B$p=B$J.camera,B$m=B$D.x,B$C=B$p.renderTargetSize.height-B$D.y-B$D.height,B$i=B$D.width,B$k=B$D.height;B$O.viewport(B$m,B$C,B$i,B$k);var B$_=256,B$L=B$p.renderTarget;switch(B$p.clearFlag){case 0:var B$r=B$p.clearColor;if(B$r){B$O.enable(3089),B$O.scissor(B$m,B$C,B$i,B$k);var B$H=B$r.elements;B$O.clearColor(B$H[0],B$H[1],B$H[2],B$H[3]),B$_|=16384}if(B$L)switch(B$r||(B$_=16384),B$L.depthStencilFormat){case 33189:B$_|=256;break;case 36168:B$_|=1024;break;case 34041:B$_|=256,B$_|=1024}B$O.clear(B$_),B$r&&B$O.disable(3089);break;case 1:case 2:if(B$L)switch(B$_=16384,B$L.depthStencilFormat){case 33189:B$_|=256;break;case 36168:B$_|=1024;break;case 34041:B$_|=256,B$_|=1024}B$O.clear(B$_);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},B$O._renderScene=function(B$O,B$J){var B$D,B$p,B$m=B$J.camera,B$C=0;for(B$C=0;B$C<2;B$C++)(B$p=this._quenes[B$C])&&(B$m.renderTarget?B$p._render(B$J,!0):B$p._render(B$J,!1));if(1===B$m.clearFlag){var B$i=B$m.sky;B$i&&(B$E.setCullFace(B$O,!1),B$E.setDepthFunc(B$O,515),B$E.setDepthMask(B$O,!1),B$i._render(B$J),B$E.setDepthFunc(B$O,513),B$E.setDepthMask(B$O,!0))}for(B$C=2,B$D=this._quenes.length;B$C<B$D;B$C++)(B$p=this._quenes[B$C])&&(B$p._sortAlpha(B$J.camera.transform.position),B$m.renderTarget?B$p._render(B$J,!0):B$p._render(B$J,!1))},B$O._set3DRenderConfig=function(B$O){B$O.disable(3042),B$E._blend=!1,B$O.blendFunc(770,771),B$E._sFactor=770,B$E._dFactor=771,B$O.disable(2929),B$E._depthTest=!1,B$O.enable(2884),B$E._cullFace=!0,B$O.depthMask(1),B$E._depthMask=!0,B$O.frontFace(2304),B$E._frontFace=2304},B$O._set2DRenderConfig=function(B$O){B$E.setBlend(B$O,!0),B$E.setBlendFunc(B$O,1,771),B$E.setDepthTest(B$O,!1),B$E.setCullFace(B$O,!1),B$E.setDepthMask(B$O,!0),B$E.setFrontFace(B$O,2305),B$O.viewport(0,0,B$r.width,B$r.height)},B$O._parseCustomProps=function(B$O,B$J,B$D,B$p){var B$m=B$p.customProps.lightmaps,B$C=B$m.length,B$i=this._lightmaps;B$i.length=B$C;for(var B$k=0;B$k<B$C;B$k++)B$i[B$k]=B$y.getRes(B$J[B$m[B$k].replace(".exr",".png")]);this.setlightmaps(B$i);var B$_=B$p.customProps.ambientColor;B$_&&(this.ambientColor=new B$iJ(B$_[0],B$_[1],B$_[2]));var B$L=B$p.customProps.fogColor;B$L&&(this.fogColor=new B$iJ(B$L[0],B$L[1],B$L[2]))},B$O._addLight=function(B$O){this._lights.indexOf(B$O)<0&&this._lights.push(B$O)},B$O._removeLight=function(B$O){var B$J=this._lights.indexOf(B$O);0<=B$J&&this._lights.splice(B$J,1)},B$O._updateScene=function(){var B$O=this._renderState;this._prepareUpdateToRenderState(B$P.mainContext,B$O),this._updateComponents(B$O),this._updateChilds(B$O),this._lateUpdateComponents(B$O),this._time+=B$O.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},B$O._updateSceneConch=function(){var B$O=this._renderState;this._prepareUpdateToRenderState(B$P.mainContext,B$O),this._updateComponents(B$O),this._lateUpdateComponents(B$O),this._prepareSceneToRender(B$O);for(var B$J=0,B$D=this._cameraPool.length;B$J<B$D;B$J++){var B$p=this._cameraPool[B$J];(B$O.camera=B$p)._prepareCameraToRender()}},B$O._preRenderShadow=function(B$O,B$J,B$D,B$p,B$m){this.treeRoot?B$DO.renderShadowObjectCullingOctree(this,B$J,B$D,B$p,B$m):B$DO.renderShadowObjectCulling(this,B$J,B$D,B$p,B$m);for(var B$C=0,B$i=B$D.length;B$C<B$i;B$C++)B$D[B$C]&&B$D[B$C]._preRender(B$O)},B$O._renderShadowMap=function(B$O,B$J,B$D){var B$p=this.parallelSplitShadowMaps[0];B$p._calcAllLightCameraInfo(B$D);var B$m,B$C,B$i,B$k=B$p.PSSMNum;if(this._preRenderShadow(B$J,B$p._lightCulling,B$p._shadowQuenes,B$p._lightVPMatrix[0],B$k),this.addShaderDefine(B$GJ.SHADERDEFINE_CAST_SHADOW),1<B$k)for(var B$_=0;B$_<B$k;B$_++)B$m=B$p.getRenderTarget(B$_+1),B$p.beginRenderTarget(B$_+1),B$O.clearColor(1,1,1,1),B$O.clear(16640),B$O.viewport(0,0,B$m.width,B$m.height),B$J.camera=B$i=B$p.getLightCamera(B$_),B$i._prepareCameraToRender(),B$i._prepareCameraViewProject(B$i.viewMatrix,B$i.projectionMatrix),B$J._projectionViewMatrix=B$p._lightVPMatrix[B$_+1],(B$C=B$p._shadowQuenes[B$_])._preRender(B$J),B$C._renderShadow(B$J,!1),B$p.endRenderTarget(B$_+1);else B$m=B$p.getRenderTarget(1),B$p.beginRenderTarget(1),B$O.clearColor(1,1,1,1),B$O.clear(16640),B$O.viewport(0,0,B$m.width,B$m.height),B$J.camera=B$i=B$p.getLightCamera(0),B$i._prepareCameraToRender(),B$i._prepareCameraViewProject(B$i.viewMatrix,B$i.projectionMatrix),B$J._projectionViewMatrix=B$p._lightVPMatrix[0],(B$C=B$p._shadowQuenes[0])._preRender(B$J),B$C._renderShadow(B$J,!0),B$p.endRenderTarget(1);this.removeShaderDefine(B$GJ.SHADERDEFINE_CAST_SHADOW)},B$O.addTreeNode=function(B$O){this.treeRoot.addTreeNode(B$O)},B$O.removeTreeNode=function(B$O){this.treeSize&&B$O._treeNode&&B$O._treeNode.removeObject(B$O)},B$O.setlightmaps=function(B$O){this._lightmaps=B$O;for(var B$J=0,B$D=this._renderableSprite3Ds.length;B$J<B$D;B$J++)this._renderableSprite3Ds[B$J]._render._applyLightMapParams()},B$O.getlightmaps=function(){return this._lightmaps},B$O.addChildAt=function(B$O,B$J){if(!(B$O instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(B$O&&B$O.__className));if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),0<=B$J&&B$J<=this._childs.length){if(B$O._parent===this){var B$D=this.getChildIndex(B$O);this._childs.splice(B$D,1),this._childs.splice(B$J,0,B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,B$J)),this._childChanged()}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(B$J,0,B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,B$J),(B$O.parent=this)._addChild3D(B$O);return B$O}throw new Error("appendChildAt:The index is out of bounds")},B$O.addChild=function(B$O){if(!(B$O instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),B$O._parent===this){var B$J=this.getChildIndex(B$O);B$J!==this._childs.length-1&&(this._childs.splice(B$J,1),this._childs.push(B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1)),this._childChanged())}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1),(B$O.parent=this)._childChanged(),this._addChild3D(B$O);return B$O},B$O.removeChildAt=function(B$O){var B$J=this.getChildAt(B$O);return B$J&&(this._removeChild3D(B$J),this._childs.splice(B$O,1),this.conchModel&&this.conchModel.removeChild(B$J.conchModel),B$J.parent=null),B$J},B$O.removeChildren=function(B$O,B$J){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=2147483647),this._childs&&0<this._childs.length){var B$D=this._childs;if(0===B$O&&B$C<=B$J){var B$p=B$D;this._childs=B$L.ARRAY_EMPTY}else B$p=B$D.splice(B$O,B$J-B$O);for(var B$m=0,B$C=B$p.length;B$m<B$C;B$m++)this._removeChild3D(B$p[B$m]),B$p[B$m].parent=null,this.conchModel&&this.conchModel.removeChild(B$p[B$m].conchModel)}return this},B$O.addFrustumCullingObject=function(B$O){this.treeRoot?this.addTreeNode(B$O):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(B$O):this._cullingRenders[this._cullingRendersLength]=B$O,B$O._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},B$O.removeFrustumCullingObject=function(B$O){if(this.treeRoot)this.removeTreeNode(B$O);else{this._cullingRendersLength--;var B$J=B$O._indexInSceneFrustumCullingObjects;if(B$J!==this._cullingRendersLength){var B$D=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[B$J]=B$D)._indexInSceneFrustumCullingObjects=B$J,B$O._indexInSceneFrustumCullingObjects=-1}}},B$O.getRenderQueue=function(B$O){return B$O<3e3?this._quenes[1]||(this._quenes[1]=new B$n(this)):this._quenes[2]||(this._quenes[2]=new B$n(this))},B$O.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new B$n(this)},B$O.addShaderDefine=function(B$O){this._shaderDefineValue|=B$O},B$O.removeShaderDefine=function(B$O){this._shaderDefineValue&=~B$O},B$O.addScript=function(B$O){return this._addComponent(B$O)},B$O.getScriptByType=function(B$O,B$J){return void 0===B$J&&(B$J=0),this._getComponentByType(B$O,B$J)},B$O.getScriptsByType=function(B$O,B$J){this._getComponentsByType(B$O,B$J)},B$O.getScriptByIndex=function(B$O){return this._getComponentByIndex(B$O)},B$O.removeScriptByType=function(B$O,B$J){void 0===B$J&&(B$J=0),this._removeComponentByType(B$O,B$J)},B$O.removeScriptsByType=function(B$O){this._removeComponentByType(B$O)},B$O.removeAllScript=function(){this._removeAllComponent()},B$O.render=function(B$O,B$J,B$D){(B$c._context.ctx._renderKey=0)<this._childs.length&&B$O.addRenderObject(this)},B$O.renderSubmit=function(){var B$O=B$P.mainContext,B$J=this._renderState;this._set3DRenderConfig(B$O),this._prepareSceneToRender(this._renderState);var B$D,B$p=0,B$m=0;if(B$yJ.debugMode||B$S.debugMode)for(B$p=0,B$m=this._cameraPool.length;B$p<B$m;B$p++)B$D=this._cameraPool[B$p],B$yJ._debugPhasorSprite.begin(1,B$D),B$D.activeInHierarchy&&B$D._renderCamera(B$O,B$J,this),B$yJ._debugPhasorSprite.end();else for(B$p=0,B$m=this._cameraPool.length;B$p<B$m;B$p++)(B$D=this._cameraPool[B$p]).activeInHierarchy&&B$D._renderCamera(B$O,B$J,this);return this._set2DRenderConfig(B$O),1},B$O.onAsynLoaded=function(B$O,B$J,B$D){var B$p=B$J[0];if("Scene"!==B$p.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var B$m=B$J[1];B$hJ._createNodeByJson(this,B$p,this,B$m),this.event("hierarchyloaded",[this]),this.__loaded=!0},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),this.destroyed||(B$J.prototype.destroy.call(this,B$O),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,B$y.clearRes(this.url),this.loaded||B$yJ._cancelLoadByUrl(this.url))},B$O.getRenderType=function(){return 0},B$O.releaseRender=function(){},B$O._addComponent=function(B$O){var B$J,B$D=this._componentsMap.indexOf(B$O);if(-1===B$D)B$J=[],this._componentsMap.push(B$O),this._typeComponentsIndices.push(B$J);else if(B$J=this._typeComponentsIndices[B$D],this._components[B$J[0]].isSingleton)throw new Error("无法单实例创建"+B$O+"组件，"+B$O+"组件已存在！");var B$p=B$m.getInstance(B$O);B$J.push(this._components.length),this._components.push(B$p);return B$p._initialize(this),B$p},B$O._removeComponent=function(B$O,B$J){var B$D=this._typeComponentsIndices[B$O],B$p=B$D[B$J],B$m=this._components[B$p];this._components.splice(B$p,1),B$D.splice(B$J,1),0===B$D.length&&(this._typeComponentsIndices.splice(B$O,1),this._componentsMap.splice(B$O,1));for(var B$C=0,B$i=this._componentsMap.length;B$C<B$i;B$C++)for(var B$k=(B$D=this._typeComponentsIndices[B$C]).length-1;0<=B$k;B$k--){var B$_=B$D[B$k];if(!(B$p<B$_))break;B$D[B$k]=--B$_}B$m._destroy()},B$O._getComponentByType=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D=this._componentsMap.indexOf(B$O);return-1===B$D?null:this._components[this._typeComponentsIndices[B$D][B$J]]},B$O._getComponentsByType=function(B$O,B$J){var B$D=this._componentsMap.indexOf(B$O);if(-1!==B$D){var B$p=this._typeComponentsIndices[B$D],B$m=B$p.length;B$J.length=B$m;for(var B$C=0;B$C<B$m;B$C++)B$J[B$C]=this._components[B$p[B$C]]}else B$J.length=0},B$O._getComponentByIndex=function(B$O){return this._components[B$O]},B$O._removeComponentByType=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D=this._componentsMap.indexOf(B$O);-1!==B$D&&this._removeComponent(B$D,B$J)},B$O._removeComponentsByType=function(B$O){var B$J=this._componentsMap.indexOf(B$O);if(-1!==B$J)for(var B$D=this._typeComponentsIndices[B$J],B$p=0,B$m=B$D.length;B$p<B$m;B$D.length<B$m?B$m--:B$p++)this._removeComponent(B$J,B$p)},B$O._removeAllComponent=function(){for(var B$O=0,B$J=this._componentsMap.length;B$O<B$J;this._componentsMap.length<B$J?B$J--:B$O++)this._removeComponentsByType(this._componentsMap[B$O])},B$O._updateComponents=function(B$O){for(var B$J=0,B$D=this._components.length;B$J<B$D;B$J++){var B$p=this._components[B$J];!B$p.started&&(B$p._start(B$O),B$p.started=!0),B$p.enable&&B$p._update(B$O)}},B$O._lateUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._lateUpdate(B$O)}},B$O._preRenderUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._preRenderUpdate(B$O)}},B$O._postRenderUpdateComponents=function(B$O){for(var B$J=0;B$J<this._components.length;B$J++){var B$D=this._components[B$J];!B$D.started&&(B$D._start(B$O),B$D.started=!0),B$D.enable&&B$D._postRenderUpdate(B$O)}},B$X(0,B$O,"_loaded",null,function(B$O){this.__loaded=B$O}),B$X(0,B$O,"fogColor",function(){return this._fogColor},function(B$O){this._fogColor=B$O,this._shaderValues.setValue(0,B$O.elements)}),B$X(0,B$O,"enableFog",function(){return this._enableFog},function(B$O){this._enableFog!==B$O&&((this._enableFog=B$O)?(this.addShaderDefine(B$eJ.SHADERDEFINE_FOG),this.removeShaderDefine(B$eJ.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(B$eJ.SHADERDEFINE_FOG))}),B$X(0,B$O,"url",function(){return this._url}),B$X(0,B$O,"loaded",function(){return this.__loaded}),B$X(0,B$O,"enableDepthFog",function(){return this._enableDepthFog},function(B$O){this._enableDepthFog!=B$O&&((this._enableDepthFog=B$O)?(this.addShaderDefine(B$eJ.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(B$eJ.SHADERDEFINE_FOG)):this.removeShaderDefine(B$eJ.SAHDERDEFINE_DEPTHFOG))}),B$X(0,B$O,"fogStart",function(){return this._fogStart},function(B$O){this._fogStart=B$O,this._shaderValues.setValue(1,B$O)}),B$X(0,B$O,"fogRange",function(){return this._fogRange},function(B$O){this._fogRange=B$O,this._shaderValues.setValue(2,B$O)}),B$X(0,B$O,"ambientColor",function(){return this._ambientColor},function(B$O){this._ambientColor=B$O,this._shaderValues.setValue(21,B$O.elements)}),B$X(0,B$O,"scene",function(){return this}),B$X(0,B$O,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),B$p._sortScenes=function(B$O,B$J){if(B$O.parent!==B$d.stage||B$J.parent!==B$d.stage)return B$O.parent!==B$d.stage&&B$J.parent!==B$d.stage?B$p._sortScenes(B$O.parent,B$J.parent):B$O.parent===B$d.stage?-1:1;var B$D=B$d.stage._childs;return B$D.indexOf(B$O)-B$D.indexOf(B$J)},B$p.load=function(B$O){return B$d.loader.create(B$O,null,null,B$p)},B$p.FOGCOLOR=0,B$p.FOGSTART=1,B$p.FOGRANGE=2,B$p.LIGHTDIRECTION=3,B$p.LIGHTDIRCOLOR=4,B$p.POINTLIGHTPOS=5,B$p.POINTLIGHTRANGE=6,B$p.POINTLIGHTATTENUATION=7,B$p.POINTLIGHTCOLOR=8,B$p.SPOTLIGHTPOS=9,B$p.SPOTLIGHTDIRECTION=10,B$p.SPOTLIGHTSPOT=11,B$p.SPOTLIGHTRANGE=12,B$p.SPOTLIGHTATTENUATION=13,B$p.SPOTLIGHTCOLOR=14,B$p.SHADOWDISTANCE=15,B$p.SHADOWLIGHTVIEWPROJECT=16,B$p.SHADOWMAPPCFOFFSET=17,B$p.SHADOWMAPTEXTURE1=18,B$p.SHADOWMAPTEXTURE2=19,B$p.SHADOWMAPTEXTURE3=20,B$p.AMBIENTCOLOR=21,B$p.TIME=22,B$p}(B$a),B$FJ=function(B$O){function B$J(B$O){B$J.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new B$OJ,this._shaderValues=new B$YJ,this._colliders=[],this._id=++B$J._uniqueIDCounter,this._transform=new B$MJ(this),this.name=B$O||"Sprite3D-"+B$J._nameNumberCounter++,this.layer=B$W.currentCreationLayer,this.active=!0}B$G(B$J,"laya.d3.core.Sprite3D",B$gJ);var B$D=B$J.prototype;return B$d.imps(B$D,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),B$D._setUrl=function(B$O){this._url=B$O},B$D._getGroup=function(){return this._group},B$D._setGroup=function(B$O){this._group=B$O},B$D._addChild3D=function(B$O){B$O.transform.parent=this.transform,this._hierarchyAnimator&&(!B$O._hierarchyAnimator&&B$O._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(B$O,!0,[B$O.name])),this._scene&&(B$O._setBelongScene(this._scene),this._activeInHierarchy&&B$O._active&&B$O._activeHierarchy())},B$D._removeChild3D=function(B$O){B$O.transform.parent=null,this._scene&&(this._activeInHierarchy&&B$O._active&&B$O._inActiveHierarchy(),B$O._setUnBelongScene()),this._hierarchyAnimator&&(B$O._hierarchyAnimator==this._hierarchyAnimator&&B$O._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(B$O,!1,[B$O.name]))},B$D._parseBaseCustomProps=function(B$O){var B$J=this.transform.localPosition;B$O.translate?(B$J.fromArray(B$O.translate),B$J.x*=100,B$J.y*=100,B$J.z*=100):B$J.elements.fill(0),this.transform.localPosition=B$J;var B$D=this.transform.localRotation;B$O.rotation?B$D.fromArray(B$O.rotation):B$D.fromArray([0,0,0,-1]),this.transform.localRotation=B$D;var B$p=this.transform.localScale;B$O.scale?B$p.fromArray(B$O.scale):B$p.elements.fill(1),this.transform.localScale=B$p;var B$m=B$O.layer;null!=B$m&&(this.layer=B$W.getLayerByNumber(B$m))},B$D._parseCustomComponent=function(B$O,B$J,B$D){for(var B$p in B$D){var B$m=B$D[B$p];switch(B$p){case"Animator":var B$C=this.addComponent(Animator);if(B$m.avatarPath)B$C.avatar=B$y.getRes(B$J[B$m.avatarPath]);else{var B$i=B$m.avatar;if(B$i){B$C.avatar=B$y.getRes(B$J[B$i.path]);var B$k=B$i.linkSprites;B$k&&B$O.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[B$C,B$k])}}for(var B$_=B$m.clipPaths,B$L=B$_.length,B$r=0;B$r<B$L;B$r++)B$C.addClip(B$y.getRes(B$J[B$_[B$r]]));B$C.clip=B$y.getRes(B$J[B$_[0]]);var B$H=B$m.playOnWake;void 0!==B$H&&(B$C.playOnWake=B$H);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var B$Y=this.addComponent(SphereCollider);B$Y.isTrigger=B$m.isTrigger;var B$G=B$Y.center;B$G.fromArray(B$m.center),B$Y.center=B$G,B$Y.radius=B$m.radius;break;case"BoxCollider":var B$X=this.addComponent(BoxCollider);B$X.isTrigger=B$m.isTrigger,B$X.center.fromArray(B$m.center);var B$c=B$X.size;B$c.fromArray(B$m.size),B$X.size=B$c;break;case"MeshCollider":this.addComponent(MeshCollider)}}},B$D._onRootNodeHierarchyLoaded=function(B$O,B$J){for(var B$D in B$J){for(var B$p=this,B$m=B$J[B$D],B$C=0,B$i=B$m.length;B$C<B$i;B$C++){var B$k=B$m[B$C];if(""===B$k)break;if(!(B$p=B$p.getChildByName(B$k)))break}B$p&&B$O.linkSprite3DToAvatarNode(B$D,B$p)}},B$D._setHierarchyAnimator=function(B$O,B$J){this._changeHierarchyAnimator(B$O);for(var B$D=0,B$p=this._childs.length;B$D<B$p;B$D++){var B$m=this._childs[B$D];B$m._hierarchyAnimator==B$J&&B$m._setHierarchyAnimator(B$O,B$J)}},B$D._clearHierarchyAnimator=function(B$O,B$J){this._changeHierarchyAnimator(B$J);for(var B$D=0,B$p=this._childs.length;B$D<B$p;B$D++){var B$m=this._childs[B$D];B$m._hierarchyAnimator==B$O&&B$m._clearHierarchyAnimator(B$O,B$J)}},B$D._getAnimatorToLinkSprite3D=function(B$O,B$J,B$D){var B$p=this.getComponentByType(Animator);if(B$p&&(B$p.avatar?B$p.avatar._version||B$O._setAnimatorToLinkAvatar(B$p,B$J):B$O._setAnimatorToLinkSprite3DNoAvatar(B$p,B$J,B$D)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){B$D.unshift(this._parent.name);var B$m=this._parent;B$m._hierarchyAnimator&&B$m._getAnimatorToLinkSprite3D(B$O,B$J,B$D)}},B$D._setAnimatorToLinkSprite3DNoAvatar=function(B$O,B$J,B$D){var B$p=0,B$m=0;for(B$p=0,B$m=B$O.getClipCount();B$p<B$m;B$p++)B$O._handleSpriteOwnersBySprite(B$p,B$J,B$D,this);for(B$p=0,B$m=this._childs.length;B$p<B$m;B$p++){var B$C=this._childs[B$p],B$i=B$D.length;B$D.push(B$C.name),B$C._setAnimatorToLinkSprite3DNoAvatar(B$O,B$J,B$D),B$D.splice(B$i,1)}},B$D._changeHierarchyAnimator=function(B$O){this._hierarchyAnimator=B$O},B$D._isLinkSpriteToAnimationNode=function(B$O,B$J,B$D){var B$p=B$O._avatarNodes.indexOf(B$J),B$m=B$O._cacheSpriteToNodesMap;if(B$D)this._transform.dummy=B$J.transform,B$O._cacheNodesToSpriteMap[B$p]=B$m.length,B$m.push(B$p);else{this._transform.dummy=null;var B$C=B$O._cacheNodesToSpriteMap[B$p];B$O._cacheNodesToSpriteMap[B$p]=null,B$m.splice(B$C,1)}},B$D._setBelongScene=function(B$O){this._scene=B$O;for(var B$J=0,B$D=this._childs.length;B$J<B$D;B$J++)this._childs[B$J]._setBelongScene(B$O)},B$D._setUnBelongScene=function(){this._scene=null;for(var B$O=0,B$J=this._childs.length;B$O<B$J;B$O++)this._childs[B$O]._setUnBelongScene()},B$D._activeHierarchy=function(){var B$O=0,B$J=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),B$O=0,B$J=this._colliders.length;B$O<B$J;B$O++)this._layer._addCollider(this._colliders[B$O]);for(this.event("activeinhierarchychanged",!0),B$O=0,B$J=this._childs.length;B$O<B$J;B$O++){var B$D=this._childs[B$O];B$D._active&&B$D._activeHierarchy()}},B$D._inActiveHierarchy=function(){var B$O=0,B$J=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),B$O=0,B$J=this._colliders.length;B$O<B$J;B$O++){var B$D=this._colliders[B$O];B$D._clearCollsionMap(),this._layer._removeCollider(B$D)}for(this.event("activeinhierarchychanged",!1),B$O=0,B$J=this._childs.length;B$O<B$J;B$O++){var B$p=this._childs[B$O];B$p._active&&B$p._inActiveHierarchy()}},B$D.addComponent=function(B$O){var B$J,B$D=this._componentsMap.indexOf(B$O);if(-1===B$D)B$J=[],this._componentsMap.push(B$O),this._typeComponentsIndices.push(B$J);else if(B$J=this._typeComponentsIndices[B$D],this._components[B$J[0]].isSingleton)throw new Error("无法单实例创建"+B$O+"组件，"+B$O+"组件已存在！");var B$p=B$m.getInstance(B$O);return B$J.push(this._components.length),this._components.push(B$p),B$p instanceof laya.d3.component.Script&&this._scripts.push(B$p),B$p._initialize(this),B$p},B$D._removeComponent=function(B$O,B$J){var B$D,B$p=0,B$m=this._typeComponentsIndices[B$O],B$C=B$m[B$J],B$i=this._components[B$C];for(B$i instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(B$i),1),B$m.splice(B$J,1),0===B$m.length&&(this._typeComponentsIndices.splice(B$O,1),this._componentsMap.splice(B$O,1)),B$p=0,B$D=this._componentsMap.length;B$p<B$D;B$p++)for(var B$k=(B$m=this._typeComponentsIndices[B$p]).length-1;0<=B$k;B$k--){var B$_=B$m[B$k];if(!(B$C<B$_))break;B$m[B$k]=--B$_}B$i._destroy()},B$D._clearSelfRenderObjects=function(){},B$D._addSelfRenderObjects=function(){},B$D._parseCustomProps=function(B$O,B$J,B$D,B$p){},B$D._updateChilds=function(B$O){var B$J=this._childs.length;if(0!==B$J)for(var B$D=0;B$D<B$J;++B$D)this._childs[B$D]._update(B$O)},B$D._getSortID=function(B$O,B$J){return 1e3*B$J.id+B$O._getVertexBuffer().vertexDeclaration.id},B$D._update=function(B$O){(B$O.owner=this)._activeInHierarchy&&(this._updateComponents(B$O),this._lateUpdateComponents(B$O),B$e.spriteCount++,this._childs.length&&this._updateChilds(B$O))},B$D.getProjectionViewWorldMatrix=function(B$O){return B$OJ.multiply(B$O,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},B$D.loadHierarchy=function(B$O){this.addChild(laya.d3.core.Sprite3D.load(B$O))},B$D.addChildAt=function(B$O,B$J){if(!(B$O instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),0<=B$J&&B$J<=this._childs.length){if(B$O._parent===this){var B$D=this.getChildIndex(B$O);this._childs.splice(B$D,1),this._childs.splice(B$J,0,B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,B$J)),this._childChanged()}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(B$J,0,B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,B$J),(B$O.parent=this)._addChild3D(B$O);return B$O}throw new Error("appendChildAt:The index is out of bounds")},B$D.addChild=function(B$O){if(!(B$O instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!B$O||this.destroyed||B$O===this)return B$O;if(B$O.zOrder&&this._set$P("hasZorder",!0),B$O._parent===this){var B$J=this.getChildIndex(B$O);B$J!==this._childs.length-1&&(this._childs.splice(B$J,1),this._childs.push(B$O),this.conchModel&&(this.conchModel.removeChild(B$O.conchModel),this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1)),this._childChanged())}else B$O.parent&&B$O.parent.removeChild(B$O),this._childs===B$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(B$O),this.conchModel&&this.conchModel.addChildAt(B$O.conchModel,this._childs.length-1),(B$O.parent=this)._childChanged(),this._addChild3D(B$O);return B$O},B$D.removeChildAt=function(B$O){var B$J=this.getChildAt(B$O);return B$J&&(this._removeChild3D(B$J),this._childs.splice(B$O,1),this.conchModel&&this.conchModel.removeChild(B$J.conchModel),B$J.parent=null),B$J},B$D.removeChildren=function(B$O,B$J){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=2147483647),this._childs&&0<this._childs.length){var B$D=this._childs;if(0===B$O&&B$C<=B$J){var B$p=B$D;this._childs=B$L.ARRAY_EMPTY}else B$p=B$D.splice(B$O,B$J-B$O);for(var B$m=0,B$C=B$p.length;B$m<B$C;B$m++)this._removeChild3D(B$p[B$m]),B$p[B$m].parent=null,this.conchModel&&this.conchModel.removeChild(B$p[B$m].conchModel)}return this},B$D.onAsynLoaded=function(B$O,B$J,B$D){var B$p=B$J[0];if("Sprite3D"!==B$p.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var B$m=B$J[1];B$hJ._createNodeByJson(this,B$p,this,B$m),this.event("hierarchyloaded",[this]),this.__loaded=!0},B$D.cloneTo=function(B$O){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var B$J=B$O;B$J.name=this.name,B$J._destroyed=this._destroyed,B$J.timer=this.timer,B$J._$P=this._$P,B$J.active=this._active;var B$D=B$J.transform.localPosition;this.transform.localPosition.cloneTo(B$D),B$J.transform.localPosition=B$D;var B$p=B$J.transform.localRotation;this.transform.localRotation.cloneTo(B$p),B$J.transform.localRotation=B$p;var B$m=B$J.transform.localScale;this.transform.localScale.cloneTo(B$m),B$J.transform.localScale=B$m,B$J.isStatic=this.isStatic;var B$C=0,B$i=0;for(B$C=0,B$i=this._componentsMap.length;B$C<B$i;B$C++){var B$k=B$J.addComponent(this._componentsMap[B$C]);this._components[B$C]._cloneTo(B$k)}for(B$C=0,B$i=this._childs.length;B$C<B$i;B$C++)B$J.addChild(this._childs[B$C].clone());var B$_=B$J.getComponentByType(Animator);if(B$_){var B$L=B$_._linkSpritesData;if(B$L)for(var B$r in B$L){for(var B$H=B$L[B$r],B$Y=B$J,B$G=0,B$X=B$H.length;B$G<B$X&&(B$Y=B$Y.getChildByName(B$H[B$G]));B$G++);if(B$Y){var B$c=B$_._avatarNodeMap[B$r];B$Y._isLinkSpriteToAnimationNode(B$_,B$c,!0)}}}},B$D.clone=function(){var B$O=new this.constructor;return this.cloneTo(B$O),B$O},B$D.destroy=function(B$O){if(void 0===B$O&&(B$O=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,B$O);var B$J,B$D=0;for(B$D=0,B$J=this._components.length;B$D<B$J;B$D++)this._components[B$D]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,B$y.clearRes(this.url),this.loaded||B$yJ._cancelLoadByUrl(this.url)}},B$D._handleSpriteToAvatar=function(B$O,B$J){B$O._avatarNodes;var B$D=B$O._avatarNodeMap[this.name];B$D&&B$D.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(B$O,B$D,B$J)},B$D._setAnimatorToLinkAvatar=function(B$O,B$J){this._handleSpriteToAvatar(B$O,B$J);for(var B$D=0,B$p=this._childs.length;B$D<B$p;B$D++){this._childs[B$D]._setAnimatorToLinkAvatar(B$O,B$J)}},B$X(0,B$D,"activeInHierarchy",function(){return this._activeInHierarchy}),B$X(0,B$D,"_loaded",null,function(B$O){this.__loaded=B$O}),B$X(0,B$D,"active",function(){return this._active},function(B$O){this._active!==B$O&&(this._active=B$O,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(B$O?this._activeHierarchy():this._inActiveHierarchy()))}),B$X(0,B$D,"componentsCount",function(){return this._components.length}),B$X(0,B$D,"loaded",function(){return this.__loaded}),B$X(0,B$D,"id",function(){return this._id}),B$X(0,B$D,"url",function(){return this._url}),B$X(0,B$D,"layer",function(){return this._layer},function(B$O){if(this._layer!==B$O){if(!B$O)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var B$J=0,B$D=this._colliders.length;if(this._layer)for(B$J=0;B$J<B$D;B$J++)this._layer._removeCollider(this._colliders[B$J]);for(B$J=0;B$J<B$D;B$J++)B$O._addCollider(this._colliders[B$J])}this._layer=B$O,this.event("layerchanged",B$O)}}),B$X(0,B$D,"scene",function(){return this._scene}),B$X(0,B$D,"transform",function(){return this._transform}),B$J.instantiate=function(B$O,B$J,B$D,B$p,B$m){void 0===B$D&&(B$D=!0);var B$C=B$O.clone();B$J&&B$J.addChild(B$C);var B$i=B$C.transform;if(B$D){var B$k=B$i.worldMatrix;B$O.transform.worldMatrix.cloneTo(B$k),B$i.worldMatrix=B$k}else B$p&&(B$i.position=B$p),B$m&&(B$i.rotation=B$m);return B$C},B$J.load=function(B$O){return B$d.loader.create(B$O,null,null,B$J)},B$J.WORLDMATRIX=0,B$J.MVPMATRIX=1,B$J._uniqueIDCounter=0,B$J._nameNumberCounter=0,B$J}(),B$RJ=function(B$O){function B$r(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],B$r.__super.call(this),!B$O||!B$J)throw"Shader Error";this._id=++B$r._count,this._vs=B$O,this._ps=B$J,this._attributeMap=B$D,this._sceneUniformMap=B$p,this._cameraUniformMap=B$m,this._spriteUniformMap=B$C,this._materialUniformMap=B$i,this._renderElementUniformMap=B$k,this._precompile=B$_,this._define=B$L,this._precompile&&B$r.extCompileObj&&B$r.extCompileFunc?B$r.extCompileFunc.call(B$r.extCompileObj,B$O,B$J,B$L):this.recreateResource()}B$G(B$r,"laya.d3.shader.Shader3D",B$D);var B$J=B$r.prototype;return B$J.recreateResource=function(){B$o.now();this._compile(),this.completeCreate(),this.memorySize=0},B$J.disposeResource=function(){B$P.mainContext.deleteShader(this._vshader),B$P.mainContext.deleteShader(this._pshader),B$P.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},B$J._compile=function(){if(!B$P.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var B$O=[this._vs,this._ps],B$J=B$P.mainContext;if(this._program=B$J.createProgram(),this._vshader=B$r._createShader(B$J,B$O[0],35633),this._pshader=B$r._createShader(B$J,B$O[1],35632),B$J.attachShader(this._program,this._vshader),B$J.attachShader(this._program,this._pshader),B$J.linkProgram(this._program),!B$c.isConchApp&&B$eJ.debugMode&&!B$J.getProgramParameter(this._program,35714))throw B$J.getProgramInfoLog(this._program);var B$D,B$p=0,B$m=0,B$C=0;for(B$C=B$c.isConchApp?B$J.getProgramParameterEx(this._vs,this._ps,"",35721):B$J.getProgramParameter(this._program,35721),B$p=0;B$p<B$C;B$p++){var B$i=null;B$D={vartype:"attribute",ivartype:0,attrib:B$i=B$c.isConchApp?B$J.getActiveAttribEx(this._vs,this._ps,"",B$p):B$J.getActiveAttrib(this._program,B$p),location:B$J.getAttribLocation(this._program,B$i.name),name:B$i.name,type:B$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(B$D)}var B$k=0;for(B$k=B$c.isConchApp?B$J.getProgramParameterEx(this._vs,this._ps,"",35718):B$J.getProgramParameter(this._program,35718),B$p=0;B$p<B$k;B$p++){var B$_=null;B$_=B$c.isConchApp?B$J.getActiveUniformEx(this._vs,this._ps,"",B$p):B$J.getActiveUniform(this._program,B$p),0<(B$D={vartype:"uniform",ivartype:1,attrib:B$i,location:B$J.getUniformLocation(this._program,B$_.name),name:B$_.name,type:B$_.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(B$D.name=B$D.name.substr(0,B$D.name.length-3),B$D.isArray=!0,B$D.location=B$J.getUniformLocation(this._program,B$D.name)),this._uniformParams.push(B$D)}for(B$p=0,B$m=this._attributeParams.length;B$p<B$m;B$p++)(B$D=this._attributeParams[B$p]).indexOfParams=B$p,B$D.index=1,B$D.value=[B$D.location,null],B$D.codename=B$D.name,B$D.name=null!=this._attributeMap[B$D.codename]?this._attributeMap[B$D.codename]:B$D.codename,this._attributeParamsMap.push(B$D.name),this._attributeParamsMap.push(B$D),B$D._this=this,B$D.uploadedValue=[],B$D.fun=this._attribute;for(B$p=0,B$m=this._uniformParams.length;B$p<B$m;B$p++)switch((B$D=this._uniformParams[B$p]).indexOfParams=B$p,B$D.index=1,B$D.value=[B$D.location,null],B$D.codename=B$D.name,null!=this._sceneUniformMap[B$D.codename]?(B$D.name=this._sceneUniformMap[B$D.codename],this._sceneUniformParamsMap.push(B$D.name),this._sceneUniformParamsMap.push(B$D)):null!=this._cameraUniformMap[B$D.codename]?(B$D.name=this._cameraUniformMap[B$D.codename],this._cameraUniformParamsMap.push(B$D.name),this._cameraUniformParamsMap.push(B$D)):null!=this._spriteUniformMap[B$D.codename]?(B$D.name=this._spriteUniformMap[B$D.codename],this._spriteUniformParamsMap.push(B$D.name),this._spriteUniformParamsMap.push(B$D)):null!=this._materialUniformMap[B$D.codename]?(B$D.name=this._materialUniformMap[B$D.codename],this._materialUniformParamsMap.push(B$D.name),this._materialUniformParamsMap.push(B$D)):null!=this._renderElementUniformMap[B$D.codename]?(B$D.name=this._renderElementUniformMap[B$D.codename],this._renderElementUniformParamsMap.push(B$D.name),this._renderElementUniformParamsMap.push(B$D)):console.log("Shader:can't find uinform name:"+B$D.codename+" in shader file."),B$D._this=this,B$D.uploadedValue=[],B$D.type){case 5124:B$D.fun=B$D.isArray?this._uniform1iv:this._uniform1i;break;case 5126:B$D.fun=B$D.isArray?this._uniform1fv:this._uniform1f;break;case 35664:B$D.fun=B$D.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:B$D.fun=B$D.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:B$D.fun=B$D.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:B$D.fun=this._uniform_sampler2D;break;case 35680:B$D.fun=this._uniform_samplerCube;break;case 35676:B$D.fun=this._uniformMatrix4fv;break;case 35670:B$D.fun=this._uniform1i;break;case 35674:B$D.fun=this._uinformMatrix2fv;break;case 35675:B$D.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},B$J._attribute=function(B$O,B$J){var B$D=B$P.mainContext,B$p=B$k._enableAtributes,B$m=B$O.location;return B$p[B$m]||B$D.enableVertexAttribArray(B$m),B$D.vertexAttribPointer(B$m,B$J[0],B$J[1],B$J[2],B$J[3],B$J[4]),B$p[B$m]=B$k._bindVertexBuffer,1},B$J._uniform1f=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J?(B$P.mainContext.uniform1f(B$O.location,B$D[0]=B$J),1):0},B$J._uniform1fv=function(B$O,B$J){if(B$J.length<4){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$P.mainContext.uniform1fv(B$O.location,B$J),B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3],1):0}return B$P.mainContext.uniform1fv(B$O.location,B$J),1},B$J._uniform_vec2=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]?(B$P.mainContext.uniform2f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1]),1):0},B$J._uniform_vec2v=function(B$O,B$J){if(B$J.length<2){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$P.mainContext.uniform2fv(B$O.location,B$J),B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3],1):0}return B$P.mainContext.uniform2fv(B$O.location,B$J),1},B$J._uniform_vec3=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]?(B$P.mainContext.uniform3f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2]),1):0},B$J._uniform_vec3v=function(B$O,B$J){return B$P.mainContext.uniform3fv(B$O.location,B$J),1},B$J._uniform_vec4=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$P.mainContext.uniform4f(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3]),1):0},B$J._uniform_vec4v=function(B$O,B$J){return B$P.mainContext.uniform4fv(B$O.location,B$J),1},B$J._uniformMatrix2fv=function(B$O,B$J){return B$P.mainContext.uniformMatrix2fv(B$O.location,!1,B$J),1},B$J._uniformMatrix3fv=function(B$O,B$J){return B$P.mainContext.uniformMatrix3fv(B$O.location,!1,B$J),1},B$J._uniformMatrix4fv=function(B$O,B$J){return B$P.mainContext.uniformMatrix4fv(B$O.location,!1,B$J),1},B$J._uinformMatrix2fv=function(B$O,B$J){return B$P.mainContext.uniformMatrix2fv(B$O.location,!1,B$J),1},B$J._uinformMatrix3fv=function(B$O,B$J){return B$P.mainContext.uniformMatrix3fv(B$O.location,!1,B$J),1},B$J._uniform1i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J?(B$P.mainContext.uniform1i(B$O.location,B$D[0]=B$J),1):0},B$J._uniform1iv=function(B$O,B$J){return B$P.mainContext.uniform1iv(B$O.location,B$J),1},B$J._uniform_ivec2=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]?(B$P.mainContext.uniform2i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1]),1):0},B$J._uniform_ivec2v=function(B$O,B$J){return B$P.mainContext.uniform2iv(B$O.location,B$J),1},B$J._uniform_vec3i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]?(B$P.mainContext.uniform3i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2]),1):0},B$J._uniform_vec3vi=function(B$O,B$J){return B$P.mainContext.uniform3iv(B$O.location,B$J),1},B$J._uniform_vec4i=function(B$O,B$J){var B$D=B$O.uploadedValue;return B$D[0]!==B$J[0]||B$D[1]!==B$J[1]||B$D[2]!==B$J[2]||B$D[3]!==B$J[3]?(B$P.mainContext.uniform4i(B$O.location,B$D[0]=B$J[0],B$D[1]=B$J[1],B$D[2]=B$J[2],B$D[3]=B$J[3]),1):0},B$J._uniform_vec4vi=function(B$O,B$J){return B$P.mainContext.uniform4iv(B$O.location,B$J),1},B$J._uniform_sampler2D=function(B$O,B$J){var B$D=B$J.source||B$J.defaulteTexture.source,B$p=B$P.mainContext,B$m=B$O.uploadedValue;if(null!=B$m[0])return B$p.activeTexture(B$r._TEXTURES[B$m[0]]),B$D&&B$E.bindTexture(B$p,3553,B$D),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return B$m[0]=this._curActTexIndex,B$p.uniform1i(B$O.location,this._curActTexIndex),B$p.activeTexture(B$r._TEXTURES[this._curActTexIndex]),B$D&&B$E.bindTexture(B$p,3553,B$D),this._curActTexIndex++,1},B$J._uniform_samplerCube=function(B$O,B$J){var B$D=B$J.source||B$J.defaulteTexture.source,B$p=B$P.mainContext,B$m=B$O.uploadedValue;if(null!=B$m[0])return B$p.activeTexture(B$r._TEXTURES[B$m[0]]),B$D?B$E.bindTexture(B$p,34067,B$D):B$E.bindTexture(B$p,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return B$m[0]=this._curActTexIndex,B$p.uniform1i(B$O.location,this._curActTexIndex),B$p.activeTexture(B$r._TEXTURES[this._curActTexIndex]),B$D?B$E.bindTexture(B$p,34067,B$D):B$E.bindTexture(B$p,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},B$J._noSetValue=function(B$O){console.log("no....:"+B$O.name)},B$J.bind=function(){return B$D.activeShader=this,(B$D.bindShader=this).activeResource(),B$E.UseProgram(this._program)},B$J.uploadAttributes=function(B$O,B$J){for(var B$D,B$p,B$m=0,B$C=0,B$i=this._attributeParamsMap.length;B$C<B$i;B$C+=2)B$p=this._attributeParamsMap[B$C+1],null!=(B$D=B$O[this._attributeParamsMap[B$C]])&&(B$J&&B$J[B$p.name]&&B$J[B$p.name].bind(),B$m+=B$p.fun.call(this,B$p,B$D));B$e.shaderCall+=B$m},B$J.uploadAttributesX=function(B$O,B$J){for(var B$D,B$p,B$m=0,B$C=0,B$i=this._attributeParamsMap.length;B$C<B$i;B$C+=2)B$p=this._attributeParamsMap[B$C+1],null!=(B$D=B$O[this._attributeParamsMap[B$C]])&&(B$J._bind(),B$m+=B$p.fun.call(this,B$p,B$D));B$e.shaderCall+=B$m},B$J.uploadSceneUniforms=function(B$O){for(var B$J,B$D,B$p=0,B$m=0,B$C=this._sceneUniformParamsMap.length;B$m<B$C;B$m+=2)B$D=this._sceneUniformParamsMap[B$m+1],null!=(B$J=B$O[this._sceneUniformParamsMap[B$m]])&&(B$p+=B$D.fun.call(this,B$D,B$J));B$e.shaderCall+=B$p},B$J.uploadCameraUniforms=function(B$O){for(var B$J,B$D,B$p=0,B$m=0,B$C=this._cameraUniformParamsMap.length;B$m<B$C;B$m+=2)B$D=this._cameraUniformParamsMap[B$m+1],null!=(B$J=B$O[this._cameraUniformParamsMap[B$m]])&&(B$p+=B$D.fun.call(this,B$D,B$J));B$e.shaderCall+=B$p},B$J.uploadSpriteUniforms=function(B$O){for(var B$J,B$D,B$p=0,B$m=0,B$C=this._spriteUniformParamsMap.length;B$m<B$C;B$m+=2)B$D=this._spriteUniformParamsMap[B$m+1],null!=(B$J=B$O[this._spriteUniformParamsMap[B$m]])&&(B$p+=B$D.fun.call(this,B$D,B$J));B$e.shaderCall+=B$p},B$J.uploadMaterialUniforms=function(B$O){for(var B$J,B$D,B$p=0,B$m=0,B$C=this._materialUniformParamsMap.length;B$m<B$C;B$m+=2)B$D=this._materialUniformParamsMap[B$m+1],null!=(B$J=B$O[this._materialUniformParamsMap[B$m]])&&(B$p+=B$D.fun.call(this,B$D,B$J));B$e.shaderCall+=B$p},B$J.uploadRenderElementUniforms=function(B$O){for(var B$J,B$D,B$p=0,B$m=0,B$C=this._renderElementUniformParamsMap.length;B$m<B$C;B$m+=2)B$D=this._renderElementUniformParamsMap[B$m+1],null!=(B$J=B$O[this._renderElementUniformParamsMap[B$m]])&&(B$p+=B$D.fun.call(this,B$D,B$J));B$e.shaderCall+=B$p},B$r.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return new B$r(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L)},B$r.addInclude=function(B$O,B$J){B$A.addInclude(B$O,B$J)},B$r._createShader=function(B$O,B$J,B$D){var B$p=B$O.createShader(B$D);if(B$O.shaderSource(B$p,B$J),B$O.compileShader(B$p),B$eJ.debugMode&&!B$O.getShaderParameter(B$p,35713))throw B$O.getShaderInfoLog(B$p);return B$p},B$r.PERIOD_RENDERELEMENT=0,B$r.PERIOD_MATERIAL=1,B$r.PERIOD_SPRITE=2,B$r.PERIOD_CAMERA=3,B$r.PERIOD_SCENE=4,B$r._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],B$r._count=0,B$r._preCompile=!1,B$r.extCompileFunc=null,B$r.extCompileObj=null,B$H(B$r,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new B$t}]),B$r}(),B$jJ=function(B$k){function B$_(){this._transformUV=null,B$_.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new B$iJ(.6,.6,.6)),this._setColor(10,new B$iJ(1,1,1)),this._setColor(11,new B$kJ(1,1,1,8)),this._setColor(12,new B$iJ(1,1,1)),this._setColor(7,new B$kJ(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new B$kJ(1,1,0,0)),this.renderMode=1}B$G(B$_,"laya.d3.core.material.StandardMaterial",B$k);var B$O=B$_.prototype;return B$O.disableLight=function(){this._addDisablePublicShaderDefine(B$eJ.SHADERDEFINE_POINTLIGHT|B$eJ.SHADERDEFINE_SPOTLIGHT|B$eJ.SHADERDEFINE_DIRECTIONLIGHT)},B$O.disableFog=function(){this._addDisablePublicShaderDefine(B$eJ.SHADERDEFINE_FOG)},B$O.onAsynLoaded=function(B$O,B$J,B$D){var B$p=B$J[0];if(B$p.version)B$k.prototype.onAsynLoaded.call(this,B$O,B$J,B$D);else{var B$m=B$J[1],B$C=B$p.props;for(var B$i in B$C)this[B$i]=B$C[B$i];B$_._parseStandardMaterial(B$m,this,B$p),this._endLoaded()}},B$O.cloneTo=function(B$O){B$k.prototype.cloneTo.call(this,B$O);var B$J=B$O;this._transformUV&&(B$J._transformUV=this._transformUV.clone())},B$X(0,B$O,"ambientColor",function(){return this._getColor(9)},function(B$O){this._setColor(9,B$O)}),B$X(0,B$O,"ambientTexture",function(){return this._getTexture(5)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,B$O)}),B$X(0,B$O,"renderMode",null,function(B$O){switch(B$O){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(B$_.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(B$O)}),B$X(0,B$O,"reflectColor",function(){return this._getColor(12)},function(B$O){this._setColor(12,B$O)}),B$X(0,B$O,"tilingOffset",function(){return this._getColor(15)},function(B$O){if(B$O){var B$J=B$O.elements;1!=B$J[0]||1!=B$J[1]||0!=B$J[2]||0!=B$J[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,B$O)}),B$X(0,B$O,"albedo",function(){return this._getColor(7)},function(B$O){this._setColor(7,B$O)}),B$X(0,B$O,"diffuseColor",function(){return this._getColor(10)},function(B$O){this._setColor(10,B$O)}),B$X(0,B$O,"albedoColor",function(){return this._getColor(7)},function(B$O){this._setColor(7,B$O)}),B$X(0,B$O,"specularColor",function(){return this._getColor(11)},function(B$O){this._setColor(11,B$O)}),B$X(0,B$O,"diffuseTexture",function(){return this._getTexture(1)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,B$O)}),B$X(0,B$O,"normalTexture",function(){return this._getTexture(2)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,B$O)}),B$X(0,B$O,"specularTexture",function(){return this._getTexture(3)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,B$O)}),B$X(0,B$O,"emissiveTexture",function(){return this._getTexture(4)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,B$O)}),B$X(0,B$O,"reflectTexture",function(){return this._getTexture(6)},function(B$O){B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,B$O)}),B$X(0,B$O,"transformUV",function(){return this._transformUV},function(B$O){this._transformUV=B$O,this._setMatrix4x4(13,B$O.matrix),B$O?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,B$O.matrix.elements,0)}),B$_.__init__=function(){B$_.SHADERDEFINE_DIFFUSEMAP=B$_.shaderDefines.registerDefine("DIFFUSEMAP"),B$_.SHADERDEFINE_NORMALMAP=B$_.shaderDefines.registerDefine("NORMALMAP"),B$_.SHADERDEFINE_SPECULARMAP=B$_.shaderDefines.registerDefine("SPECULARMAP"),B$_.SHADERDEFINE_EMISSIVEMAP=B$_.shaderDefines.registerDefine("EMISSIVEMAP"),B$_.SHADERDEFINE_AMBIENTMAP=B$_.shaderDefines.registerDefine("AMBIENTMAP"),B$_.SHADERDEFINE_REFLECTMAP=B$_.shaderDefines.registerDefine("REFLECTMAP"),B$_.SHADERDEFINE_UVTRANSFORM=B$_.shaderDefines.registerDefine("UVTRANSFORM"),B$_.SHADERDEFINE_TILINGOFFSET=B$_.shaderDefines.registerDefine("TILINGOFFSET"),B$_.SHADERDEFINE_ADDTIVEFOG=B$_.shaderDefines.registerDefine("ADDTIVEFOG")},B$_.load=function(B$O){return B$d.loader.create(B$O,null,null,B$_)},B$_._parseStandardMaterial=function(B$O,B$J,B$D){var B$p=B$D.customProps,B$m=B$p.ambientColor;B$J.ambientColor=new B$iJ(B$m[0],B$m[1],B$m[2]);var B$C=B$p.diffuseColor;B$J.diffuseColor=new B$iJ(B$C[0],B$C[1],B$C[2]);var B$i=B$p.specularColor;B$J.specularColor=new B$kJ(B$i[0],B$i[1],B$i[2],B$i[3]);var B$k=B$p.reflectColor;B$J.reflectColor=new B$iJ(B$k[0],B$k[1],B$k[2]);var B$_=B$p.albedoColor;B$_&&(B$J.albedo=new B$kJ(B$_[0],B$_[1],B$_[2],B$_[3]));var B$L=B$p.diffuseTexture.texture2D;B$L&&(B$J.diffuseTexture=B$y.getRes(B$O[B$L]));var B$r=B$p.normalTexture.texture2D;B$r&&(B$J.normalTexture=B$y.getRes(B$O[B$r]));var B$H=B$p.specularTexture.texture2D;B$H&&(B$J.specularTexture=B$y.getRes(B$O[B$H]));var B$Y=B$p.emissiveTexture.texture2D;B$Y&&(B$J.emissiveTexture=B$y.getRes(B$O[B$Y]));var B$G=B$p.ambientTexture.texture2D;B$G&&(B$J.ambientTexture=B$y.getRes(B$O[B$G]));var B$X=B$p.reflectTexture.texture2D;B$X&&(B$J.reflectTexture=B$y.getRes(B$O[B$X]))},B$_.RENDERMODE_OPAQUE=1,B$_.RENDERMODE_OPAQUEDOUBLEFACE=2,B$_.RENDERMODE_CUTOUT=3,B$_.RENDERMODE_CUTOUTDOUBLEFACE=4,B$_.RENDERMODE_TRANSPARENT=13,B$_.RENDERMODE_TRANSPARENTDOUBLEFACE=14,B$_.RENDERMODE_ADDTIVE=15,B$_.RENDERMODE_ADDTIVEDOUBLEFACE=16,B$_.RENDERMODE_DEPTHREAD_TRANSPARENT=5,B$_.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,B$_.RENDERMODE_DEPTHREAD_ADDTIVE=7,B$_.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,B$_.RENDERMODE_NONDEPTH_TRANSPARENT=9,B$_.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,B$_.RENDERMODE_NONDEPTH_ADDTIVE=11,B$_.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,B$_.SHADERDEFINE_DIFFUSEMAP=0,B$_.SHADERDEFINE_NORMALMAP=0,B$_.SHADERDEFINE_SPECULARMAP=0,B$_.SHADERDEFINE_EMISSIVEMAP=0,B$_.SHADERDEFINE_AMBIENTMAP=0,B$_.SHADERDEFINE_REFLECTMAP=0,B$_.SHADERDEFINE_UVTRANSFORM=0,B$_.SHADERDEFINE_TILINGOFFSET=0,B$_.SHADERDEFINE_ADDTIVEFOG=0,B$_.DIFFUSETEXTURE=1,B$_.NORMALTEXTURE=2,B$_.SPECULARTEXTURE=3,B$_.EMISSIVETEXTURE=4,B$_.AMBIENTTEXTURE=5,B$_.REFLECTTEXTURE=6,B$_.ALBEDO=7,B$_.UVANIAGE=8,B$_.MATERIALAMBIENT=9,B$_.MATERIALDIFFUSE=10,B$_.MATERIALSPECULAR=11,B$_.MATERIALREFLECT=12,B$_.UVMATRIX=13,B$_.UVAGE=14,B$_.TILINGOFFSET=15,B$H(B$_,["defaultMaterial",function(){var B$O=new B$_;return B$O.lock=!0,this.defaultMaterial=B$O},"shaderDefines",function(){return this.shaderDefines=new B$rJ(B$sJ.shaderDefines)}]),B$_}(B$sJ),B$uJ=function(B$O){function B$i(B$O,B$J,B$D,B$p,B$m){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===B$D&&(B$D=35044),void 0===B$p&&(B$p=!1),B$i.__super.call(this),this._indexType=B$O,this._indexCount=B$J,this._bufferUsage=B$D,this._bufferType=34963,this._canRead=B$p;var B$C;if("ushort"==B$O)this._indexTypeByteCount=2;else{if("ubyte"!=B$O)throw new Error("unidentification index type.");this._indexTypeByteCount=1}B$C=this._indexTypeByteCount*B$J,this._byteLength=B$C,this._bind(),B$k._gl.bufferData(this._bufferType,B$C,this._bufferUsage),this.uri=B$m,B$p?("ushort"==B$O?this._buffer=new Uint16Array(B$J):"ubyte"==B$O&&(this._buffer=new Uint8Array(B$J)),this.memorySize=2*B$C):this.memorySize=B$C}B$G(B$i,"laya.d3.graphics.IndexBuffer3D",B$O);var B$J=B$i.prototype;return B$J.setData=function(B$O,B$J,B$D,B$p){void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=4294967295);var B$m=0;if("ushort"==this._indexType?(B$m=2,0===B$D&&4294967295===B$p||(B$O=new Uint16Array(B$O.buffer,B$D*B$m,B$p))):"ubyte"==this._indexType&&(B$m=1,0===B$D&&4294967295===B$p||(B$O=new Uint8Array(B$O.buffer,B$D*B$m,B$p))),this._bind(),B$k._gl.bufferSubData(this._bufferType,B$J*B$m,B$O),this._canRead)if(0!==B$J||0!==B$D||4294967295!==B$p){var B$C=this._buffer.length-B$J;B$C<B$p&&(B$p=B$C);for(var B$i=0;B$i<B$p;B$i++)this._buffer[B$J+B$i]=B$O[B$i]}else this._buffer=B$O},B$J.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},B$J.disposeResource=function(){B$O.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},B$X(0,B$J,"indexType",function(){return this._indexType}),B$X(0,B$J,"indexTypeByteCount",function(){return this._indexTypeByteCount}),B$X(0,B$J,"indexCount",function(){return this._indexCount}),B$X(0,B$J,"canRead",function(){return this._canRead}),B$i.INDEXTYPE_UBYTE="ubyte",B$i.INDEXTYPE_USHORT="ushort",B$i.create=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$D&&(B$D=35044),void 0===B$p&&(B$p=!1),new B$i(B$O,B$J,B$D,B$p,B$m)},B$i}(B$k),B$lJ=function(B$C){function B$i(B$O,B$J,B$D,B$p,B$m){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===B$p&&(B$p=!1),B$i.__super.call(this),this._vertexDeclaration=B$O,this._vertexCount=B$J,this._bufferUsage=B$D,this._bufferType=34962,this._canRead=B$p,this.uri=B$m,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*B$J,this._bind(),B$k._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),B$p&&(this._buffer=new Float32Array(this._byteLength/4))}B$G(B$i,"laya.d3.graphics.VertexBuffer3D",B$C);var B$O=B$i.prototype;return B$O.bindWithIndexBuffer=function(B$O){B$O&&B$O._bind(),this._bind()},B$O.setData=function(B$O,B$J,B$D,B$p){if(void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=4294967295),0===B$D&&4294967295===B$p||(B$O=new Float32Array(B$O.buffer,4*B$D,B$p)),this._bind(),B$k._gl.bufferSubData(this._bufferType,4*B$J,B$O),this._canRead)if(0!==B$J||0!==B$D||4294967295!==B$p){var B$m=this._buffer.length-B$J;B$m<B$p&&(B$p=B$m);for(var B$C=0;B$C<B$p;B$C++)this._buffer[B$J+B$C]=B$O[B$C]}else this._buffer=B$O},B$O.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},B$O.disposeResource=function(){for(var B$O=B$P.mainContext,B$J=this._vertexDeclaration.getVertexElements(),B$D=B$k._enableAtributes,B$p=0,B$m=B$J.length;B$p<B$m;B$p++)B$D[B$p]===this._glBuffer&&(B$O.disableVertexAttribArray(B$p),B$D[B$p]=null);B$C.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},B$X(0,B$O,"vertexDeclaration",function(){return this._vertexDeclaration}),B$X(0,B$O,"vertexCount",function(){return this._vertexCount}),B$X(0,B$O,"canRead",function(){return this._canRead}),B$i.create=function(B$O,B$J,B$D,B$p,B$m){return void 0===B$D&&(B$D=35044),void 0===B$p&&(B$p=!1),new B$i(B$O,B$J,B$D,B$p,B$m)},B$i}(B$k),B$$J=function(B$O){function B$A(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,B$A.__super.call(this),this._type=3553}B$G(B$A,"laya.d3.resource.DataTexture2D",B$PJ);var B$J=B$A.prototype;return B$J.genDebugMipmaps=function(){var B$O=[];return B$O.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),B$O.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),B$O.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),B$O.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),B$O.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),B$O.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),B$O.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),B$O.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),B$O.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),B$O.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),B$O},B$J._onTextureLoaded=function(B$O){},B$J._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var B$O=B$P.mainContext,B$J=this._source=B$O.createTexture(),B$D=this._width,B$p=this._height,B$m=B$E.curBindTexTarget,B$C=B$E.curBindTexValue,B$i=!1;if(B$E.bindTexture(B$O,this._type,B$J),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var B$k=0;B$O.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var B$_=0;B$_<this._mipmaps.length;B$_++){if(this._mipmaps[B$_].byteLength!=B$L*B$r*4)throw"mipmap size error  level:"+B$_;B$O.texSubImage2D(this._type,0,B$A.simLodRect[B$k++],B$A.simLodRect[B$k++],B$A.simLodRect[B$k++],B$A.simLodRect[B$k++],6408,5121,new Uint8Array(this._mipmaps[B$_]))}this.minFifter=9729,this.magFifter=9729}else{var B$L=this._width,B$r=this._height;for(B$k=0,B$O.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),B$_=0;B$_<this._mipmaps.length;B$_++){if(this._mipmaps[B$_].byteLength!=B$L*B$r*4)throw"mipmap size error  level:"+B$_;B$O.texImage2D(this._type,B$_,6408,B$L,B$r,0,6408,5121,new Uint8Array(this._mipmaps[B$_])),(B$L/=2)<1&&(B$L=1),(B$r/=2)<1&&(B$r=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&B$O.pixelStorei(B$O.UNPACK_ALIGNMENT,1),B$O.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var B$H=0,B$Y=!1,B$G=!1;this._buffer.byteLength==4*B$D*B$p?(B$H=6408,B$Y=!0):this._buffer.byteLength==3*B$D*B$p?(B$H=6407,B$G=!0):B$H=this._format,B$Y||B$G?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),B$G&&B$O.pixelStorei(B$O.UNPACK_ALIGNMENT,1),B$O.texImage2D(this._type,0,B$H,B$D,B$p,0,B$H,5121,this._buffer)):B$O&&B$H==B$O.ALPHA?(B$O.texImage2D(3553,0,B$H,B$D,B$p,0,B$H,B$O.UNSIGNED_BYTE,this._buffer),B$i=!0):0!=B$H&&(B$O.compressedTexImage2D(3553,0,B$H,B$D,B$p,0,this._buffer),B$i=!0)}var B$X=this._minFifter,B$c=this._magFifter,B$h=0==this._wrapModeU?10497:33071,B$y=0==this._wrapModeV?10497:33071,B$v=B$q.isPOT(B$D,B$p);B$v?(this._mipmap||this._mipmaps?-1!==B$X||(B$X=9987):-1!==B$X||(B$X=9729),-1!==B$c||(B$c=9729),B$O.texParameteri(this._type,10241,B$X),B$O.texParameteri(this._type,10240,B$c),B$O.texParameteri(this._type,10242,B$h),B$O.texParameteri(this._type,10243,B$y),this._mipmap&&B$O.generateMipmap(this._type)):(-1!==B$X||(B$X=9729),-1!==B$c||(B$c=9729),B$O.texParameteri(this._type,10241,B$X),B$O.texParameteri(this._type,10240,B$c),B$O.texParameteri(this._type,10242,33071),B$O.texParameteri(this._type,10243,33071)),B$m&&B$C&&B$E.bindTexture(B$O,B$m,B$C),this.memorySize=B$i?this._buffer.length:B$v?B$D*B$p*4*(1+1/3):B$D*B$p*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},B$J.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},B$J.onAsynLoaded=function(B$O,B$J,B$D){var B$p;B$D&&(B$p=B$D[0].call(this,B$J)),B$p&&(this._width=B$p.width,this._height=B$p.height,this._buffer=B$p.data),this._src=B$O,this._size=new B$cJ(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},B$J.getPixels=function(){return new Uint8Array(this._buffer)},B$J.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(B$P.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},B$X(0,B$J,"src",function(){return this._src}),B$A.create=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){if(void 0===B$p&&(B$p=9729),void 0===B$m&&(B$m=9729),void 0===B$C&&(B$C=!0),!B$O||B$O.byteLength<B$J*B$D*4)throw"DataTexture2D create error";var B$k=new B$A;return B$k.uri=B$i,B$k._buffer=B$O,B$k._width=B$J,B$k._height=B$D,B$k._mipmap=B$C,B$k._magFifter=B$p,B$k._minFifter=B$m,B$k._size=new B$cJ(B$k._width,B$k._height),B$k._conchTexture?alert("怎么给runtime传递datatexture数据"):B$k.activeResource(),B$k},B$A.load=function(B$O,B$J,B$D,B$p,B$m){if(void 0===B$J&&(B$J=0),void 0===B$D&&(B$D=0),void 0===B$p&&(B$p=9729),void 0===B$m&&(B$m=9729),"mipmaps"===B$z.getFileExtension(B$O)){var B$C=B$d.loader.create(B$O,null,null,B$A,[function(B$O){this._mipmaps=[];var B$J=new Uint32Array(B$O);this._width=B$J[0];var B$D=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,B$D=1024),this._width!=B$D)throw"现在只支持512x256的环境贴图。当前的是"+B$J[0];this._height=B$J[1];for(var B$p=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,B$m=this._height,B$C=8;;){var B$i=B$p*B$m*4;if(B$C+B$i>B$O.byteLength)throw"load mipmaps data size error ";var B$k=new Uint8Array(B$O,B$C,B$i);if(this._mipmaps.push(B$k),B$C+=B$i,1==B$p&&1==B$m)break;(B$p/=2)<1&&(B$p=1),(B$m/=2)<1&&(B$m=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){B$C.simLodInfo=new Float32Array(40);for(var B$i=0;B$i<B$C.simLodInfo.length;)B$C.simLodInfo[B$i]=(B$A.simLodRect[B$i]+.5)/1024,B$i++,B$C.simLodInfo[B$i]=(B$A.simLodRect[B$i]+.5)/256,B$i++,B$C.simLodInfo[B$i]=Math.max(B$A.simLodRect[B$i]-1,.1)/1024,B$i++,B$C.simLodInfo[B$i]=Math.max(B$A.simLodRect[B$i]-1.5,.1)/256,B$i++}return B$C}if("number"==typeof B$J)return B$d.loader.create(B$O,null,null,B$A,[function(B$O){return this._width=B$J,this._height=B$D,this._buffer=B$O,null}]);if("function"==typeof B$J)return B$d.loader.create(B$O,null,null,B$A,[B$J]);throw new Error("unknown params.")},B$A.lodasatlas=!1,B$H(B$A,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),B$A}(),B$xJ=function(B$O){function B$J(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,B$J.__super.call(this)}B$G(B$J,"laya.d3.resource.models.PrimitiveMesh",B$EJ);var B$D=B$J.prototype;return B$d.imps(B$D,{"laya.d3.core.render.IRenderable":!0}),B$D._getVertexBuffer=function(B$O){return void 0===B$O&&(B$O=0),0===B$O?this._vertexBuffer:null},B$D._getVertexBuffers=function(){return null},B$D._getIndexBuffer=function(){return this._indexBuffer},B$D._getPositions=function(){var B$O,B$J=[],B$D=this._vertexBuffer.vertexDeclaration.getVertexElements(),B$p=0;for(B$p=0;B$p<B$D.length;B$p++){var B$m=B$D[B$p];if("vector3"===B$m.elementFormat&&0===B$m.elementUsage){B$O=B$m;break}}var B$C=this._vertexBuffer.getData();for(B$p=0;B$p<B$C.length;B$p+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var B$i=B$p+B$O.offset/4,B$k=new B$iJ(B$C[B$i+0],B$C[B$i+1],B$C[B$i+2]);B$J.push(B$k)}return B$J},B$D.getRenderElement=function(B$O){return this},B$D.getRenderElementsCount=function(){return 1},B$D.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},B$D._beforeRender=function(B$O){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},B$D._render=function(B$O){B$P.mainContext.drawElements(4,this._numberIndices,5123,0),B$e.drawCall++,B$e.trianglesFaces+=this._numberIndices/3},B$X(0,B$D,"_vertexBufferCount",function(){return 1}),B$X(0,B$D,"triangleCount",function(){return this._indexBuffer.indexCount/3}),B$J}(),B$VJ=function(B$O){function B$J(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,B$J.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}B$G(B$J,"laya.d3.resource.models.Mesh",B$EJ);var B$D=B$J.prototype;return B$D._getPositions=function(){var B$O,B$J,B$D,B$p,B$m,B$C=[],B$i=0,B$k=0,B$_=0;if(0!==this._vertexBuffers.length){var B$L=this._vertexBuffers.length;for(B$i=0;B$i<B$L;B$i++){for(B$D=(B$O=this._vertexBuffers[B$i]).vertexDeclaration.getVertexElements(),B$k=0;B$k<B$D.length;B$k++)if("vector3"===(B$p=B$D[B$k]).elementFormat&&0===B$p.elementUsage){B$J=B$p;break}for(B$m=B$O.getData(),B$k=0;B$k<B$m.length;B$k+=B$O.vertexDeclaration.vertexStride/4)B$_=B$k+B$J.offset/4,B$C.push(new B$iJ(B$m[B$_+0],B$m[B$_+1],B$m[B$_+2]))}}else{var B$r=this._subMeshes.length;for(B$i=0;B$i<B$r;B$i++){for(B$D=(B$O=this._subMeshes[B$i]._getVertexBuffer()).vertexDeclaration.getVertexElements(),B$k=0;B$k<B$D.length;B$k++)if("vector3"===(B$p=B$D[B$k]).elementFormat&&0===B$p.elementUsage){B$J=B$p;break}for(B$m=B$O.getData(),B$k=0;B$k<B$m.length;B$k+=B$O.vertexDeclaration.vertexStride/4)B$_=B$k+B$J.offset/4,B$C.push(new B$iJ(B$m[B$_+0],B$m[B$_+1],B$m[B$_+2]))}}return B$C},B$D._setSubMeshes=function(B$O){this._subMeshes=B$O,this._subMeshCount=B$O.length;for(var B$J=0;B$J<this._subMeshCount;B$J++)B$O[B$J]._indexInMesh=B$J;this._positions=this._getPositions(),this._generateBoundingObject()},B$D.onAsynLoaded=function(B$O,B$J,B$D){var B$p=B$J[0],B$m=B$J[1];B$BO.read(B$p,this,this._materials,this._subMeshes,B$m),this.completeCreate(),this._endLoaded()},B$D.getSubMesh=function(B$O){return this._subMeshes[B$O]},B$D.getSubMeshCount=function(){return this._subMeshes.length},B$D.getRenderElementsCount=function(){return this._subMeshes.length},B$D.getRenderElement=function(B$O){return this._subMeshes[B$O]},B$D.disposeResource=function(){for(var B$O=0;B$O<this._subMeshes.length;B$O++)this._subMeshes[B$O].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},B$X(0,B$D,"materials",function(){return this._materials.slice()}),B$X(0,B$D,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),B$J.load=function(B$O){return B$d.loader.create(B$O,null,null,B$J)},B$J}(),B$TJ=(function(B$O){function B$L(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===B$D&&(B$D=6408),void 0===B$p&&(B$p=5121),void 0===B$m&&(B$m=33189),void 0===B$C&&(B$C=!1),void 0===B$i&&(B$i=!1),void 0===B$k&&(B$k=-1),void 0===B$_&&(B$_=-1),B$L.__super.call(this),this._type=3553,this._width=B$O,this._height=B$J,this._size=new B$cJ(B$O,B$J),this._surfaceFormat=B$D,this._surfaceType=B$p,this._depthStencilFormat=B$m,B$c.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=B$C,this._repeat=B$i,this._minFifter=B$k,this._magFifter=B$_,this.activeResource(),this._alreadyResolved=!0}B$G(B$L,"laya.d3.resource.RenderTexture",B$PJ);var B$J=B$L.prototype;B$J.recreateResource=function(){var B$O=B$P.mainContext;this._frameBuffer=B$O.createFramebuffer(),this._source=B$O.createTexture();var B$J=B$E.curBindTexTarget,B$D=B$E.curBindTexValue;B$E.bindTexture(B$O,this._type,this._source),B$O.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var B$p=this._minFifter,B$m=this._magFifter,B$C=this._repeat?10497:33071;if(B$q.isPOT(this._width,this._height)?(this._mipmap?-1!==B$p||(B$p=9987):-1!==B$p||(B$p=9729),-1!==B$m||(B$m=9729),B$O.texParameteri(this._type,10241,B$p),B$O.texParameteri(this._type,10240,B$m),B$O.texParameteri(this._type,10242,B$C),B$O.texParameteri(this._type,10243,B$C),this._mipmap&&B$O.generateMipmap(this._type)):(-1!==B$p||(B$p=9729),-1!==B$m||(B$m=9729),B$O.texParameteri(this._type,10241,B$p),B$O.texParameteri(this._type,10240,B$m),B$O.texParameteri(this._type,10242,33071),B$O.texParameteri(this._type,10243,33071)),B$J&&B$D&&B$E.bindTexture(B$O,B$J,B$D),B$O.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=B$O.createRenderbuffer(),B$O.bindRenderbuffer(36161,this._depthStencilBuffer),B$O.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),B$O.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:B$O.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:B$O.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:B$O.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}B$O.framebufferTexture2D(36160,36064,3553,this._source,0),B$O.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},B$J.start=function(){B$P.mainContext.bindFramebuffer(36160,this.frameBuffer),(B$L._currentRenderTarget=this)._alreadyResolved=!1},B$J.end=function(){B$P.mainContext.bindFramebuffer(36160,null),B$L._currentRenderTarget=null,this._alreadyResolved=!0},B$J.getData=function(B$O,B$J,B$D,B$p){var B$m=B$P.mainContext;if(B$m.bindFramebuffer(36160,this._frameBuffer),!(36053===B$m.checkFramebufferStatus(36160)))return B$m.bindFramebuffer(36160,null),null;var B$C=new Uint8Array(this._width*this._height*4);return B$m.readPixels(B$O,B$J,B$D,B$p,this._surfaceFormat,this._surfaceType,B$C),B$m.bindFramebuffer(36160,null),B$C},B$J.disposeResource=function(){if(this._frameBuffer){var B$O=B$P.mainContext;B$O.deleteTexture(this._source),B$O.deleteFramebuffer(this._frameBuffer),B$O.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},B$X(0,B$J,"surfaceFormat",function(){return this._surfaceFormat}),B$X(0,B$J,"surfaceType",function(){return this._surfaceType}),B$X(0,B$J,"depthStencilFormat",function(){return this._depthStencilFormat}),B$X(0,B$J,"source",function(){return this._alreadyResolved?B$d.superGet(B$PJ,this,"source"):null}),B$X(0,B$J,"depthStencilBuffer",function(){return this._depthStencilBuffer}),B$X(0,B$J,"frameBuffer",function(){return this._frameBuffer}),B$L._currentRenderTarget=null}(),function(B$O){function B$J(B$O){this._color=null,this._pixels=null,B$J.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new B$cJ(this.width,this.height),this._color=B$O,this._pixels=new Uint8Array([255*B$O.x,255*B$O.y,255*B$O.z,255*B$O.w]),this.uri="SolidColorTexture2D_"+this.id}B$G(B$J,"laya.d3.resource.SolidColorTexture2D",B$PJ);var B$D=B$J.prototype;return B$D._createWebGlTexture=function(){var B$O=B$P.mainContext,B$J=this._source=B$O.createTexture(),B$D=this._width,B$p=this._height,B$m=B$E.curBindTexTarget,B$C=B$E.curBindTexValue;B$E.bindTexture(B$O,this._type,B$J),B$O.texImage2D(this._type,0,6408,B$D,B$p,0,6408,5121,this._pixels);var B$i=this._minFifter,B$k=this._magFifter,B$_=this._repeat?10497:33071,B$L=B$q.isPOT(B$D,B$p);B$L?(this._mipmap?-1!==B$i||(B$i=9987):-1!==B$i||(B$i=9729),-1!==B$k||(B$k=9729),B$O.texParameteri(this._type,10241,B$i),B$O.texParameteri(this._type,10240,B$k),B$O.texParameteri(this._type,10242,B$_),B$O.texParameteri(this._type,10243,B$_),this._mipmap&&B$O.generateMipmap(this._type)):(-1!==B$i||(B$i=9729),-1!==B$k||(B$k=9729),B$O.texParameteri(this._type,10241,B$i),B$O.texParameteri(this._type,10240,B$k),B$O.texParameteri(this._type,10242,33071),B$O.texParameteri(this._type,10243,33071)),B$m&&B$C&&B$E.bindTexture(B$O,B$m,B$C),this.memorySize=B$L?B$D*B$p*4*(1+1/3):B$D*B$p*4},B$D.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},B$D.disposeResource=function(){this._source&&(B$P.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},B$H(B$J,["magentaTexture",function(){var B$O=new B$J(new B$kJ(1,0,1,1));return B$O.lock=!0,this.magentaTexture=B$O},"grayTexture",function(){var B$O=new B$J(new B$kJ(.5,.5,.5,1));return B$O.lock=!0,this.grayTexture=B$O}]),B$J}()),B$IJ=function(B$O){function B$m(B$O,B$J,B$D,B$p){this._canRead=!1,this._image=null,this._pixels=null,void 0===B$O&&(B$O=!1),void 0===B$J&&(B$J=!0),void 0===B$D&&(B$D=6408),void 0===B$p&&(B$p=!0),B$m.__super.call(this),this._type=3553,this._repeat=B$J,this._canRead=B$O,this._format=B$D,this._mipmap=B$p}B$G(B$m,"laya.d3.resource.Texture2D",B$PJ);var B$J=B$m.prototype;return B$J._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var B$O=B$P.mainContext,B$J=this._source=B$O.createTexture(),B$D=this._width,B$p=this._height,B$m=B$E.curBindTexTarget,B$C=B$E.curBindTexValue;switch(B$E.bindTexture(B$O,this._type,B$J),this._format){case 6407:case 6408:this._canRead?B$O.texImage2D(this._type,0,this._format,B$D,B$p,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?B$O.texImage2D(this._type,0,this._image._format,B$D,B$p,0,this._image._format,5121,this._image.atlasSource):B$O.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case B$P.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:B$O.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var B$i=this._minFifter,B$k=this._magFifter,B$_=this._repeat?10497:33071,B$L=0==this._wrapModeU?10497:33071,B$r=0==this._wrapModeV?10497:33071,B$H=B$q.isPOT(B$D,B$p);B$H?(this._mipmap?-1!==B$i||(B$i=9987):-1!==B$i||(B$i=9729),-1!==B$k||(B$k=9729),B$O.texParameteri(this._type,10241,B$i),B$O.texParameteri(this._type,10240,B$k),B$O.texParameteri(this._type,10242,B$_),B$O.texParameteri(this._type,10243,B$_),B$O.texParameteri(this._type,10242,B$L),B$O.texParameteri(this._type,10243,B$r),this._mipmap&&B$O.generateMipmap(this._type)):(-1!==B$i||(B$i=9729),-1!==B$k||(B$k=9729),B$O.texParameteri(this._type,10241,B$i),B$O.texParameteri(this._type,10240,B$k),B$O.texParameteri(this._type,10242,33071),B$O.texParameteri(this._type,10243,33071)),B$m&&B$C&&B$E.bindTexture(B$O,B$m,B$C),this._image.onload=null,this._image=null,this.memorySize=B$H?B$D*B$p*4*(1+1/3):B$D*B$p*4},B$J.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},B$J.onAsynLoaded=function(B$O,B$J,B$D){if(B$D){var B$p=B$D[0];void 0!==B$p&&(this._canRead=B$p);var B$m=B$D[1];void 0!==B$m&&(this._repeat=B$m);var B$C=B$D[2];void 0!==B$C&&(this._format=B$C);var B$i=B$D[3];void 0!==B$i&&(this._mipmap=B$i);var B$k=B$D.wrapModeU;void 0!==B$k&&(this._wrapModeU=B$k);var B$_=B$D.wrapModeV;void 0!==B$_&&(this._wrapModeV=B$_)}switch(this._format){case 6407:case 6408:var B$L=(this._image=B$J).width,B$r=B$J.height;this._width=B$L,this._height=B$r,this._size=new B$cJ(B$L,B$r),this._canRead&&(B$c.isConchApp?B$J instanceof B$Y.HTMLElement&&(this._pixels=new Uint8Array(B$J.getImageData(0,0,B$L,B$r))):(B$o.canvas.size(B$L,B$r),B$o.canvas.clear(),B$o.context.drawImage(B$J,0,0,B$L,B$r),this._pixels=new Uint8Array(B$o.context.getImageData(0,0,B$L,B$r).data.buffer)));break;case B$P.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var B$H=new B$M(B$J);B$H.readUTFBytes(4),B$H.readUTFBytes(2),B$H.getInt16();B$H.endian="bigEndian",this._width=B$H.getInt16(),this._height=B$H.getInt16(),this._size=new B$cJ(this._width,this._height);B$H.getInt16(),B$H.getInt16();this._image=new Uint8Array(B$J,B$H.pos)}this.recreateResource(),this._endLoaded()},B$J.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},B$J.disposeResource=function(){this._source&&(B$P.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},B$X(0,B$J,"_src",function(){return this.url}),B$X(0,B$J,"src",function(){return this.url}),B$m.load=function(B$O){return B$d.loader.create(B$O,null,null,B$m)},B$m}(),B$wJ=function(B$J){function B$D(B$O,B$J){B$D.__super.call(this),void 0===B$O&&(B$O=.3),void 0===B$J&&(B$J=1e3),this._tempVector3=new B$iJ,this._position=new B$iJ,this._up=new B$iJ,this._forward=new B$iJ,this._right=new B$iJ,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=B$cJ.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=B$O,this._farPlane=B$J,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),B$d.stage.on("resize",this,this._onScreenSizeChanged)}B$G(B$D,"laya.d3.core.BaseCamera",B$J);var B$O=B$D.prototype;return B$O._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var B$O=this.scene._cameraPool,B$J=B$O.length-1,B$D=0;B$D<B$J;B$D++)if(B$O[B$D].renderingOrder>B$O[B$J].renderingOrder){var B$p=B$O[B$D];B$O[B$D]=B$O[B$J],B$O[B$J]=B$p}},B$O._calculateProjectionMatrix=function(){},B$O._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},B$O._prepareCameraToRender=function(){B$W._currentCameraCullingMask=this.cullingMask;var B$O=this._shaderValues;B$O.setValue(0,this.transform.position.elements),B$O.setValue(5,this.forward.elements),B$O.setValue(6,this.up.elements)},B$O._prepareCameraViewProject=function(B$O,B$J){var B$D=this._shaderValues;B$D.setValue(1,B$O.elements),B$D.setValue(2,B$J.elements)},B$O._renderCamera=function(B$O,B$J,B$D){},B$O.addLayer=function(B$O){29!==B$O.number&&30!=B$O.number&&(this.cullingMask=this.cullingMask|B$O.mask)},B$O.removeLayer=function(B$O){29!==B$O.number&&30!=B$O.number&&(this.cullingMask=this.cullingMask&~B$O.mask)},B$O.addAllLayers=function(){this.cullingMask=2147483647},B$O.removeAllLayers=function(){this.cullingMask=0|B$W.getLayerByNumber(29).mask|B$W.getLayerByNumber(30).mask},B$O.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},B$O.moveForward=function(B$O){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=B$O,this.transform.translate(this._tempVector3)},B$O.moveRight=function(B$O){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=B$O,this.transform.translate(this._tempVector3)},B$O.moveVertical=function(B$O){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=B$O,this.transform.translate(this._tempVector3,!1)},B$O._addSelfRenderObjects=function(){var B$O=this.scene._cameraPool,B$J=B$O.length;if(0<B$J){for(var B$D=B$J-1;0<=B$D;B$D--)if(this.renderingOrder<=B$O[B$D].renderingOrder){B$O.splice(B$D+1,0,this);break}}else B$O.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},B$O._clearSelfRenderObjects=function(){var B$O=this.scene._cameraPool;B$O.splice(B$O.indexOf(this),1)},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,B$d.stage.off("resize",this,this._onScreenSizeChanged),B$J.prototype.destroy.call(this,B$O)},B$X(0,B$O,"sky",function(){return this._sky},function(B$O){(this._sky=B$O)._ownerCamera=this}),B$X(0,B$O,"forward",function(){var B$O=this.transform.worldMatrix.elements,B$J=this._forward.elements;return B$J[0]=-B$O[8],B$J[1]=-B$O[9],B$J[2]=-B$O[10],this._forward}),B$X(0,B$O,"position",function(){var B$O=this.transform.worldMatrix.elements,B$J=this._position.elements;return B$J[0]=B$O[12],B$J[1]=B$O[13],B$J[2]=B$O[14],this._position}),B$X(0,B$O,"renderTarget",function(){return this._renderTarget},function(B$O){null!=(this._renderTarget=B$O)&&(this._renderTargetSize=B$O.size)}),B$X(0,B$O,"up",function(){var B$O=this.transform.worldMatrix.elements,B$J=this._up.elements;return B$J[0]=B$O[4],B$J[1]=B$O[5],B$J[2]=B$O[6],this._up}),B$X(0,B$O,"right",function(){var B$O=this.transform.worldMatrix.elements,B$J=this._right.elements;return B$J[0]=B$O[0],B$J[1]=B$O[1],B$J[2]=B$O[2],this._right}),B$X(0,B$O,"renderTargetSize",function(){return this._renderTargetSize},function(B$O){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"fieldOfView",function(){return this._fieldOfView},function(B$O){this._fieldOfView=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"nearPlane",function(){return this._nearPlane},function(B$O){this._nearPlane=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"farPlane",function(){return this._farPlane},function(B$O){this._farPlane=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"orthographic",function(){return this._orthographic},function(B$O){this._orthographic=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(B$O){this._orthographicVerticalSize=B$O,this._calculateProjectionMatrix()}),B$X(0,B$O,"renderingOrder",function(){return this._renderingOrder},function(B$O){this._renderingOrder=B$O,this._sortCamerasByRenderingOrder()}),B$D.CAMERAPOS=0,B$D.VIEWMATRIX=1,B$D.PROJECTMATRIX=2,B$D.VPMATRIX=3,B$D.VPMATRIX_NO_TRANSLATE=4,B$D.CAMERADIRECTION=5,B$D.CAMERAUP=6,B$D.ENVIRONMENTDIFFUSE=7,B$D.ENVIRONMENTSPECULAR=8,B$D.SIMLODINFO=9,B$D.DIFFUSEIRRADMATR=10,B$D.DIFFUSEIRRADMATG=11,B$D.DIFFUSEIRRADMATB=12,B$D.HDREXPOSURE=13,B$D.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",B$D.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",B$D.CLEARFLAG_SOLIDCOLOR=0,B$D.CLEARFLAG_SKY=1,B$D.CLEARFLAG_DEPTHONLY=2,B$D.CLEARFLAG_NONE=3,B$H(B$D,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new B$OJ(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new B$OJ},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new B$OJ}]),B$D}(B$FJ),B$UJ=function(B$D){function B$J(B$O){this._render=null,this._geometryFilter=null,B$J.__super.call(this,B$O)}B$G(B$J,"laya.d3.core.RenderableSprite3D",B$D);var B$O=B$J.prototype;return B$O._addToInitStaticBatchManager=function(){},B$O._setBelongScene=function(B$O){B$D.prototype._setBelongScene.call(this,B$O),B$O._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},B$O._setUnBelongScene=function(){var B$O=this._scene._renderableSprite3Ds,B$J=B$O.indexOf(this);B$O.splice(B$J,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),B$D.prototype._setUnBelongScene.call(this)},B$O._update=function(B$O){(B$O.owner=this)._activeInHierarchy&&(this._updateComponents(B$O),this._render._updateOctreeNode(),this._lateUpdateComponents(B$O),B$e.spriteCount++,this._childs.length&&this._updateChilds(B$O))},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$D.prototype.destroy.call(this,B$O),this._render._destroy(),this._render=null},B$J.__init__=function(){B$J.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=B$J.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),B$J.SAHDERDEFINE_LIGHTMAP=B$J.shaderDefines.registerDefine("LIGHTMAP")},B$J.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,B$J.SAHDERDEFINE_LIGHTMAP=4,B$J.LIGHTMAPSCALEOFFSET=2,B$J.LIGHTMAP=3,B$H(B$J,["shaderDefines",function(){return this.shaderDefines=new B$rJ}]),B$J}(B$FJ),B$ZJ=(function(B$O){function B$p(B$O,B$J,B$D){this._long=NaN,this._width=NaN,this._height=NaN,void 0===B$O&&(B$O=1),void 0===B$J&&(B$J=1),void 0===B$D&&(B$D=1),B$p.__super.call(this),this._long=B$O,this._width=B$J,this._height=B$D,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}B$G(B$p,"laya.d3.resource.models.BoxMesh",B$xJ);var B$J=B$p.prototype;B$J.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var B$O=B$PO.vertexDeclaration,B$J=(B$O.vertexStride,this._long/2),B$D=this._height/2,B$p=this._width/2,B$m=new Float32Array([-B$J,B$D,-B$p,0,1,0,0,0,B$J,B$D,-B$p,0,1,0,1,0,B$J,B$D,B$p,0,1,0,1,1,-B$J,B$D,B$p,0,1,0,0,1,-B$J,-B$D,-B$p,0,-1,0,0,1,B$J,-B$D,-B$p,0,-1,0,1,1,B$J,-B$D,B$p,0,-1,0,1,0,-B$J,-B$D,B$p,0,-1,0,0,0,-B$J,B$D,-B$p,-1,0,0,0,0,-B$J,B$D,B$p,-1,0,0,1,0,-B$J,-B$D,B$p,-1,0,0,1,1,-B$J,-B$D,-B$p,-1,0,0,0,1,B$J,B$D,-B$p,1,0,0,1,0,B$J,B$D,B$p,1,0,0,0,0,B$J,-B$D,B$p,1,0,0,0,1,B$J,-B$D,-B$p,1,0,0,1,1,-B$J,B$D,B$p,0,0,1,0,0,B$J,B$D,B$p,0,0,1,1,0,B$J,-B$D,B$p,0,0,1,1,1,-B$J,-B$D,B$p,0,0,1,0,1,-B$J,B$D,-B$p,0,0,-1,1,0,B$J,B$D,-B$p,0,0,-1,0,0,B$J,-B$D,-B$p,0,0,-1,0,1,-B$J,-B$D,-B$p,0,0,-1,1,1]),B$C=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new B$lJ(B$O,this._numberVertices,35044,!0),this._indexBuffer=new B$uJ("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(B$m),this._indexBuffer.setData(B$C),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},B$X(0,B$J,"long",function(){return this._long},function(B$O){this._long!==B$O&&(this._long=B$O,this.releaseResource(),this.activeResource())}),B$X(0,B$J,"width",function(){return this._width},function(B$O){this._width!==B$O&&(this._width=B$O,this.releaseResource(),this.activeResource())}),B$X(0,B$J,"height",function(){return this._height},function(B$O){this._height!==B$O&&(this._height=B$O,this.releaseResource(),this.activeResource())})}(),function(B$O){function B$i(B$O,B$J,B$D){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=.3),void 0===B$D&&(B$D=1e3),this._viewMatrix=new B$OJ,this._projectionMatrix=new B$OJ,this._projectionViewMatrix=new B$OJ,this._viewport=new B$_J(0,0,0,0),this._normalizedViewport=new B$_J(0,0,1,1),this._aspectRatio=B$O,this._boundFrustumUpdate=!0,this._boundFrustum=new B$QO(B$OJ.DEFAULT),B$i.__super.call(this,B$J,B$D),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}B$G(B$i,"laya.d3.core.Camera",B$wJ);var B$J=B$i.prototype;return B$J._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},B$J._parseCustomProps=function(B$O,B$J,B$D,B$p){var B$m=B$D.clearColor;this.clearColor=new B$kJ(B$m[0],B$m[1],B$m[2],B$m[3]);var B$C=B$D.viewport;this.normalizedViewport=new B$_J(B$C[0],B$C[1],B$C[2],B$C[3])},B$J._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var B$O=this.orthographicVerticalSize*this.aspectRatio*.5,B$J=.5*this.orthographicVerticalSize;B$OJ.createOrthoOffCenterRH(-B$O,B$O,-B$J,B$J,this.nearPlane,this.farPlane,this._projectionMatrix)}else B$OJ.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},B$J._update=function(B$O){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,B$O)},B$J._renderCamera=function(B$O,B$J,B$D){var B$p,B$m;B$D.parallelSplitShadowMaps[0]&&B$D._renderShadowMap(B$O,B$J,this),(B$J.camera=this)._prepareCameraToRender(),B$D._preRenderUpdateComponents(B$J),B$p=B$J._viewMatrix=this.viewMatrix;var B$C=this._renderTarget;B$C?(B$C.start(),B$OJ.multiply(B$wJ._invertYScaleMatrix,this._projectionMatrix,B$wJ._invertYProjectionMatrix),B$OJ.multiply(B$wJ._invertYScaleMatrix,this.projectionViewMatrix,B$wJ._invertYProjectionViewMatrix),B$m=B$J._projectionMatrix=B$wJ._invertYProjectionMatrix,B$J._projectionViewMatrix=B$wJ._invertYProjectionViewMatrix):(B$m=B$J._projectionMatrix=this._projectionMatrix,B$J._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(B$p,B$m),B$J._viewport=this.viewport,B$D._preRenderScene(B$O,B$J,this.boundFrustum),B$D._clear(B$O,B$J),B$D._renderScene(B$O,B$J),B$D._postRenderUpdateComponents(B$J),B$C&&B$C.end()},B$J.viewportPointToRay=function(B$O,B$J){B$XJ.calculateCursorRay(B$O,this.viewport,this._projectionMatrix,this.viewMatrix,null,B$J)},B$J.normalizedViewportPointToRay=function(B$O,B$J){var B$D=B$i._tempVector20,B$p=this.viewport,B$m=B$O.elements,B$C=B$D.elements;B$C[0]=B$m[0]*B$p.width,B$C[1]=B$m[1]*B$p.height,B$XJ.calculateCursorRay(B$D,this.viewport,this._projectionMatrix,this.viewMatrix,null,B$J)},B$J.worldToViewportPoint=function(B$O,B$J){B$OJ.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(B$O,this._projectionViewMatrix,B$J);var B$D=B$J.elements;B$D[0]=B$D[0]/B$d.stage.clientScaleX,B$D[1]=B$D[1]/B$d.stage.clientScaleY},B$J.worldToNormalizedViewportPoint=function(B$O,B$J){B$OJ.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(B$O,this._projectionViewMatrix,B$J);var B$D=B$J.elements;B$D[0]=B$D[0]/B$d.stage.clientScaleX,B$D[1]=B$D[1]/B$d.stage.clientScaleY},B$J.convertScreenCoordToOrthographicCoord=function(B$O,B$J){if(this._orthographic){var B$D=B$B.clientWidth,B$p=B$B.clientHeight,B$m=this.orthographicVerticalSize*this.aspectRatio/B$D,B$C=this.orthographicVerticalSize/B$p,B$i=B$O.elements,B$k=B$J.elements;return B$k[0]=(-B$D/2+B$i[0])*B$m,B$k[1]=(B$p/2-B$i[1])*B$C,B$k[2]=(this.nearPlane-this.farPlane)*(B$i[2]+1)/2-this.nearPlane,B$iJ.transformCoordinate(B$J,this.transform.worldMatrix,B$J),!0}return!1},B$X(0,B$J,"projectionViewMatrix",function(){return B$OJ.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),B$X(0,B$J,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var B$O=this.viewport;return B$O.width/B$O.height},function(B$O){if(B$O<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=B$O,this._calculateProjectionMatrix()}),B$X(0,B$J,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),B$X(0,B$J,"needViewport",function(){var B$O=this.normalizedViewport;return 0===B$O.x&&0===B$O.y&&1===B$O.width&&1===B$O.height}),B$X(0,B$J,"viewport",function(){if(this._viewportExpressedInClipSpace){var B$O=this._normalizedViewport,B$J=this.renderTargetSize,B$D=B$J.width,B$p=B$J.height;this._viewport.x=B$O.x*B$D,this._viewport.y=B$O.y*B$p,this._viewport.width=B$O.width*B$D,this._viewport.height=B$O.height*B$p}return this._viewport},function(B$O){if(null!=this.renderTarget&&(B$O.x<0||B$O.y<0||0==B$O.width||0==B$O.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=B$O,this._calculateProjectionMatrix()}),B$X(0,B$J,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var B$O=this._viewport,B$J=this.renderTargetSize,B$D=B$J.width,B$p=B$J.height;this._normalizedViewport.x=B$O.x/B$D,this._normalizedViewport.y=B$O.y/B$p,this._normalizedViewport.width=B$O.width/B$D,this._normalizedViewport.height=B$O.height/B$p}return this._normalizedViewport},function(B$O){B$O.x<0&&(B$O.x=0,console.warn("Camera: viewport.x must large than 0.0.")),B$O.y<0&&(B$O.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<B$O.x+B$O.width&&(B$O.width=1-B$O.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<B$O.y+B$O.height&&(B$O.height=1-B$O.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=B$O,this._calculateProjectionMatrix()}),B$X(0,B$J,"projectionMatrix",function(){return this._projectionMatrix},function(B$O){this._projectionMatrix=B$O,this._useUserProjectionMatrix=!0}),B$X(0,B$J,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),B$H(B$i,["_tempVector20",function(){return this._tempVector20=new B$CJ}]),B$i}()),B$nJ=function(B$D){function B$p(B$O,B$J){B$p.__super.call(this,B$J),this._geometryFilter=new B$oJ(this),this._render=new B$WJ(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),B$O&&(this._geometryFilter.sharedMesh=B$O)instanceof laya.d3.resource.models.Mesh&&(B$O.loaded?this._render.sharedMaterials=B$O.materials:B$O.once("loaded",this,this._applyMeshMaterials))}B$G(B$p,"laya.d3.core.MeshSprite3D",B$D);var B$O=B$p.prototype;return B$O._changeRenderObjectByMesh=function(B$O){var B$J=this._render._renderElements,B$D=B$J[B$O];B$D||(B$D=B$J[B$O]=new B$aJ),B$D._render=this._render;var B$p=this._render.sharedMaterials[B$O];B$p||(B$p=B$jJ.defaultMaterial);var B$m=this._geometryFilter.sharedMesh.getRenderElement(B$O);return B$D._mainSortID=this._getSortID(B$m,B$p),B$D._sprite3D=this,B$D.renderObj=B$m,B$D._material=B$p,B$D},B$O._changeRenderObjectByMaterial=function(B$O,B$J){var B$D=this._render._renderElements[B$O];B$J||(B$J=B$jJ.defaultMaterial);var B$p=this._geometryFilter.sharedMesh.getRenderElement(B$O);return B$D._mainSortID=this._getSortID(B$p,B$J),B$D._sprite3D=this,B$D.renderObj=B$p,B$D._material=B$J,B$D},B$O._changeRenderObjectsByMesh=function(){var B$O=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=B$O;for(var B$J=0;B$J<B$O;B$J++)this._changeRenderObjectByMesh(B$J)},B$O._onMeshChanged=function(B$O){var B$J=B$O.sharedMesh;B$J.loaded?this._changeRenderObjectsByMesh():B$J.once("loaded",this,this._onMeshLoaded)},B$O._onMeshLoaded=function(B$O){B$O===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},B$O._onMaterialChanged=function(B$O,B$J,B$D){B$J<this._render._renderElements.length&&this._changeRenderObjectByMaterial(B$J,B$D)},B$O._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},B$O._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},B$O._parseCustomProps=function(B$O,B$J,B$D,B$p){var B$m=this.meshRender,B$C=B$D.lightmapIndex;null!=B$C&&(B$m.lightmapIndex=B$C);var B$i,B$k,B$_=B$D.lightmapScaleOffset;if(B$_&&(B$m.lightmapScaleOffset=new B$kJ(B$_[0],B$_[1],B$_[2],B$_[3])),B$p.instanceParams)(B$i=B$p.instanceParams.loadPath)&&(B$k=B$y.getRes(B$J[B$i]),(this.meshFilter.sharedMesh=B$k).loaded?B$m.sharedMaterials=B$k.materials:B$k.once("loaded",this,this._applyMeshMaterials));else{(B$i=B$D.meshPath)&&(B$k=B$y.getRes(B$J[B$i]),this.meshFilter.sharedMesh=B$k);var B$L=B$D.materials;if(B$L){var B$r=B$m.sharedMaterials,B$H=B$L.length;B$r.length=B$H;for(var B$Y=0;B$Y<B$H;B$Y++)B$r[B$Y]=B$y.getRes(B$J[B$L[B$Y].path]);B$m.sharedMaterials=B$r}}},B$O._applyMeshMaterials=function(B$O){for(var B$J=this._render.sharedMaterials,B$D=B$O.materials,B$p=0,B$m=B$D.length;B$p<B$m;B$p++)B$J[B$p]||(B$J[B$p]=B$D[B$p]);this._render.sharedMaterials=B$J},B$O._addToInitStaticBatchManager=function(){B$p._staticBatchManager._addInitBatchSprite(this)},B$O.cloneTo=function(B$O){var B$J=B$O;B$J._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var B$D=this._render,B$p=B$J._render;B$p.enable=B$D.enable,B$p.sharedMaterials=B$D.sharedMaterials,B$p.castShadow=B$D.castShadow;var B$m=B$D.lightmapScaleOffset;B$m&&(B$p.lightmapScaleOffset=B$m.clone()),B$p.lightmapIndex=B$D.lightmapIndex,B$p.receiveShadow=B$D.receiveShadow,B$p.sortingFudge=B$D.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,B$O)},B$O.destroy=function(B$O){if(void 0===B$O&&(B$O=!0),!this.destroyed){var B$J=this.meshFilter.sharedMesh;null!=B$J&&(B$J.loaded||B$J.off("loaded",this,this._applyMeshMaterials)),B$D.prototype.destroy.call(this,B$O),this._geometryFilter._destroy()}},B$X(0,B$O,"meshFilter",function(){return this._geometryFilter}),B$X(0,B$O,"meshRender",function(){return this._render}),B$p.__init__=function(){B$pO._staticBatchManagers.push(B$p._staticBatchManager)},B$p.load=function(B$O){return B$d.loader.create(B$O,null,null,B$p)},B$H(B$p,["_staticBatchManager",function(){return this._staticBatchManager=new B$tJ}]),B$p}(B$UJ)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}}),function(B$O,B$J,B$mO){B$mO.un,B$mO.uns;var B$D=B$mO.static,B$p=B$mO.class,B$C=B$mO.getset,B$c=B$mO.__newvec,B$k=laya.maths.Bezier,B$H=laya.utils.Browser,B$PO=laya.utils.Byte,B$m=(laya.events.Event,laya.events.EventDispatcher),B$i=laya.display.Graphics,B$_=(laya.resource.HTMLCanvas,laya.utils.Handler),B$L=laya.net.Loader,B$Y=laya.maths.MathUtil,B$EO=laya.maths.Matrix,B$h=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),B$r=(laya.renders.RenderContext,laya.resource.Resource),B$G=laya.utils.RunDriver,B$CO=laya.display.Sprite,B$X=laya.utils.Stat,B$oO=laya.resource.Texture,B$y=(laya.net.URL,laya.utils.Utils),B$E=function(){function B$O(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return B$p(B$O,"laya.ani.AnimationContent"),B$O}(),B$o=function(){function B$O(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return B$p(B$O,"laya.ani.AnimationNodeContent"),B$O}(),B$A=function(){function B$O(){}return B$p(B$O,"laya.ani.AnimationParser01"),B$O.parse=function(B$O,B$J){var B$D=B$J.__getBuffer(),B$p=0,B$m=0,B$C=0,B$i=0,B$k=0,B$_=0,B$L=0,B$r=B$J.readUTFString();B$O._aniClassName=B$r;var B$H,B$Y=B$J.readUTFString().split("\n"),B$G=B$J.getUint8(),B$X=B$J.getUint32(),B$c=B$J.getUint32();0<B$X&&(B$H=B$D.slice(B$X,B$c));var B$h=new B$PO(B$H);for(0<B$c&&(B$O._publicExtData=B$D.slice(B$c,B$D.byteLength)),B$O._useParent=!!B$J.getUint8(),B$O._anis.length=B$G,B$p=0;B$p<B$G;B$p++){var B$y=B$O._anis[B$p]=new B$E;B$y.nodes=new Array;var B$v=B$y.name=B$Y[B$J.getUint16()];B$O._aniMap[B$v]=B$p,B$y.bone3DMap={},B$y.playTime=B$J.getFloat32(),B$y.playTime<=0&&console.error("播放时间不能为0  url="+B$O.url+" name="+B$y.name);var B$A=B$y.nodes.length=B$J.getUint8();for(B$m=B$y.totalKeyframeDatasLength=0;B$m<B$A;B$m++){var B$q=B$y.nodes[B$m]=new B$o;B$q.childs=[];var B$d=B$J.getInt16();0<=B$d&&(B$q.name=B$Y[B$d],B$y.bone3DMap[B$q.name]=B$m),B$q.keyFrame=new Array,B$q.parentIndex=B$J.getInt16(),-1==B$q.parentIndex?B$q.parent=null:B$q.parent=B$y.nodes[B$q.parentIndex],B$q.lerpType=B$J.getUint8();var B$M=B$J.getUint32();B$h.pos=B$M;var B$a=B$q.keyframeWidth=B$h.getUint16();if(B$y.totalKeyframeDatasLength+=B$a,0===B$q.lerpType||1===B$q.lerpType)for(B$q.interpolationMethod=[],B$q.interpolationMethod.length=B$a,B$C=0;B$C<B$a;B$C++)B$q.interpolationMethod[B$C]=B$F.interpolation[B$h.getUint8()];null!=B$q.parent&&B$q.parent.childs.push(B$q);var B$e=B$J.getUint16();0<B$e&&(B$q.extenData=B$D.slice(B$J.pos,B$J.pos+B$e),B$J.pos+=B$e);var B$t,B$z=B$J.getUint16(),B$g=0;for(B$C=0,B$i=B$q.keyFrame.length=B$z;B$C<B$i;B$C++){if((B$t=B$q.keyFrame[B$C]=new B$W).duration=B$J.getFloat32(),B$t.startTime=B$g,2===B$q.lerpType){B$t.interpolationData=[];var B$s,B$P=B$J.getUint8();switch(B$s=B$J.getFloat32()){case 254:for(B$t.interpolationData.length=B$a,B$L=0;B$L<B$a;B$L++)B$t.interpolationData[B$L]=0;break;case 255:for(B$t.interpolationData.length=B$a,B$L=0;B$L<B$a;B$L++)B$t.interpolationData[B$L]=5;break;default:for(B$t.interpolationData.push(B$s),B$_=1;B$_<B$P;B$_++)B$t.interpolationData.push(B$J.getFloat32())}}for(B$t.data=new Float32Array(B$a),B$k=0;B$k<B$a;B$k++)B$t.data[B$k]=B$J.getFloat32(),-1e-8<B$t.data[B$k]&&B$t.data[B$k]<1e-8&&(B$t.data[B$k]=0);B$g+=B$t.duration}B$t.startTime=B$y.playTime,B$q.playTime=B$y.playTime,B$O._calculateKeyFrame(B$q,B$z,B$a)}}},B$O}(),B$q=function(){function B$d(){}return B$p(B$d,"laya.ani.AnimationParser02"),B$d.READ_DATA=function(){B$d._DATA.offset=B$d._reader.getUint32(),B$d._DATA.size=B$d._reader.getUint32()},B$d.READ_BLOCK=function(){for(var B$O=B$d._BLOCK.count=B$d._reader.getUint16(),B$J=B$d._BLOCK.blockStarts=[],B$D=B$d._BLOCK.blockLengths=[],B$p=0;B$p<B$O;B$p++)B$J.push(B$d._reader.getUint32()),B$D.push(B$d._reader.getUint32())},B$d.READ_STRINGS=function(){var B$O=B$d._reader.getUint32(),B$J=B$d._reader.getUint16(),B$D=B$d._reader.pos;B$d._reader.pos=B$O+B$d._DATA.offset;for(var B$p=0;B$p<B$J;B$p++)B$d._strings[B$p]=B$d._reader.readUTFString();B$d._reader.pos=B$D},B$d.parse=function(B$O,B$J){B$d._templet=B$O;(B$d._reader=B$J).__getBuffer();B$d.READ_DATA(),B$d.READ_BLOCK(),B$d.READ_STRINGS();for(var B$D=0,B$p=B$d._BLOCK.count;B$D<B$p;B$D++){var B$m=B$J.getUint16(),B$C=B$d._strings[B$m],B$i=B$d["READ_"+B$C];if(null==B$i)throw new Error("model file err,no this function:"+B$m+" "+B$C);B$i.call()}},B$d.READ_ANIMATIONS=function(){var B$O=B$d._reader,B$J=B$O.__getBuffer(),B$D=0,B$p=0,B$m=0,B$C=0,B$i=B$O.getUint16(),B$k=[];for(B$k.length=B$i,B$D=0;B$D<B$i;B$D++)B$k[B$D]=B$F.interpolation[B$O.getByte()];var B$_=B$O.getUint8();for(B$d._templet._anis.length=B$_,B$D=0;B$D<B$_;B$D++){var B$L=B$d._templet._anis[B$D]={};B$L.nodes=new Array;var B$r=B$L.name=B$d._strings[B$O.getUint16()];B$d._templet._aniMap[B$r]=B$D,B$L.bone3DMap={},B$L.playTime=B$O.getFloat32();var B$H=B$L.nodes.length=B$O.getInt16();for(B$p=B$L.totalKeyframeDatasLength=0;B$p<B$H;B$p++){var B$Y=B$L.nodes[B$p]={};B$Y.keyframeWidth=B$i,B$Y.childs=[];var B$G=B$O.getUint16();0<=B$G&&(B$Y.name=B$d._strings[B$G],B$L.bone3DMap[B$Y.name]=B$p),B$Y.keyFrame=new Array,B$Y.parentIndex=B$O.getInt16(),-1==B$Y.parentIndex?B$Y.parent=null:B$Y.parent=B$L.nodes[B$Y.parentIndex],B$L.totalKeyframeDatasLength+=B$i,B$Y.interpolationMethod=B$k,null!=B$Y.parent&&B$Y.parent.childs.push(B$Y);var B$X=B$O.getUint16(),B$c=null,B$h=null;for(B$m=0,B$C=B$Y.keyFrame.length=B$X;B$m<B$C;B$m++){(B$c=B$Y.keyFrame[B$m]={}).startTime=B$O.getFloat32(),B$h&&(B$h.duration=B$c.startTime-B$h.startTime);var B$y=B$d._DATA.offset,B$v=B$O.getUint32(),B$A=4*B$i,B$q=B$J.slice(B$y+B$v,B$y+B$v+B$A);B$c.data=new Float32Array(B$q),B$h=B$c}B$c.duration=0,B$Y.playTime=B$L.playTime,B$d._templet._calculateKeyFrame(B$Y,B$X,B$i)}}},B$d._templet=null,B$d._reader=null,B$d._strings=[],B$D(B$d,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),B$d}(),B$WO=(function(){function B$O(){}B$p(B$O,"laya.ani.AnimationState"),B$O.stopped=0,B$O.paused=1,B$O.playing=2}(),function(){function B$m(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new B$UO,this.resultMatrix=new B$EO,this._children=[]}B$p(B$m,"laya.ani.bone.Bone");var B$O=B$m.prototype;return B$O.setTempMatrix=function(B$O){this._tempMatrix=B$O;var B$J,B$D=0;for(B$D=0,B$J=this._children.length;B$D<B$J;B$D++)this._children[B$D].setTempMatrix(this._tempMatrix)},B$O.update=function(B$O){var B$J;if(this.rotation=this.transform.skX,B$O)B$J=this.resultTransform.getMatrix(),B$EO.mul(B$J,B$O,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)B$J=this.resultTransform.getMatrix(),B$EO.mul(B$J,this.parentBone.resultMatrix,this.resultMatrix);else{var B$D=this.parentBone,B$p=NaN,B$m=NaN,B$C=NaN,B$i=this.parentBone.resultMatrix;B$J=this.resultTransform.getMatrix();var B$k=B$i.a*B$J.tx+B$i.c*B$J.ty+B$i.tx,B$_=B$i.b*B$J.tx+B$i.d*B$J.ty+B$i.ty,B$L=new B$EO;this.inheritRotation?(B$p=Math.atan2(B$D.resultMatrix.b,B$D.resultMatrix.a),B$m=Math.cos(B$p),B$C=Math.sin(B$p),B$L.setTo(B$m,B$C,-B$C,B$m,0,0),B$EO.mul(this._tempMatrix,B$L,B$EO.TEMP),B$EO.TEMP.copyTo(B$L),B$J=this.resultTransform.getMatrix(),B$EO.mul(B$J,B$L,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,B$J=this.resultTransform.getMatrix(),B$EO.TEMP.identity(),B$EO.TEMP.d=this.d,B$EO.mul(B$J,B$EO.TEMP,this.resultMatrix)),this.resultMatrix.tx=B$k,this.resultMatrix.ty=B$_}else(B$J=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var B$r,B$H=0;for(B$H=0,B$r=this._children.length;B$H<B$r;B$H++)this._children[B$H].update()},B$O.updateChild=function(){var B$O,B$J=0;for(B$J=0,B$O=this._children.length;B$J<B$O;B$J++)this._children[B$J].update()},B$O.setRotation=function(B$O){this._sprite&&(this._sprite.rotation=180*B$O/Math.PI)},B$O.updateDraw=function(B$O,B$J){B$m.ShowBones&&!B$m.ShowBones[this.name]||(this._sprite||(this._sprite=new B$CO,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),B$mO.stage.addChild(this._sprite)),this._sprite.x=B$O+this.resultMatrix.tx,this._sprite.y=B$J+this.resultMatrix.ty);var B$D,B$p=0;for(B$p=0,B$D=this._children.length;B$p<B$D;B$p++)this._children[B$p].updateDraw(B$O,B$J)},B$O.addChild=function(B$O){this._children.push(B$O),B$O.parentBone=this},B$O.findBone=function(B$O){if(this.name==B$O)return this;var B$J,B$D,B$p=0;for(B$p=0,B$J=this._children.length;B$p<B$J;B$p++)if(B$D=this._children[B$p].findBone(B$O))return B$D;return null},B$O.localToWorld=function(B$O){var B$J=B$O[0],B$D=B$O[1];B$O[0]=B$J*this.resultMatrix.a+B$D*this.resultMatrix.c+this.resultMatrix.tx,B$O[1]=B$J*this.resultMatrix.b+B$D*this.resultMatrix.d+this.resultMatrix.ty},B$m.ShowBones={},B$m}()),B$NO=function(){function B$c(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}B$p(B$c,"laya.ani.bone.BoneSlot");var B$O=B$c.prototype;return B$O.showSlotData=function(B$O,B$J){void 0===B$J&&(B$J=!0),this.currSlotData=B$O,B$J&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},B$O.showDisplayByName=function(B$O){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(B$O))},B$O.replaceDisplayByName=function(B$O,B$J){if(this.currSlotData){var B$D;B$D=this.currSlotData.getDisplayByName(B$O);var B$p;B$p=this.currSlotData.getDisplayByName(B$J),this.replaceDisplayByIndex(B$D,B$p)}},B$O.replaceDisplayByIndex=function(B$O,B$J){this.currSlotData&&(this._replaceDic[B$O]=B$J,this.displayIndex==B$O&&this.showDisplayByIndex(B$O))},B$O.showDisplayByIndex=function(B$O){if(null!=this._replaceDic[B$O]&&(B$O=this._replaceDic[B$O]),this.currSlotData&&-1<B$O&&B$O<this.currSlotData.displayArr.length){if(this.displayIndex=B$O,this.currDisplayData=this.currSlotData.displayArr[B$O],this.currDisplayData){var B$J=this.currDisplayData.name;this.currTexture=this.templet.getTexture(B$J),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!B$h.isConchApp||B$h.isConchApp&&"0.9.15"<B$CO.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},B$O.replaceSkin=function(B$O){this._diyTexture=B$O,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},B$O.setParentMatrix=function(B$O){this._parentMatrix=B$O},B$O.draw=function(B$O,B$J,B$D,B$p){if(void 0===B$D&&(B$D=!1),void 0===B$p&&(B$p=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var B$m,B$C=this.currTexture;switch(this._diyTexture&&(B$C=this._diyTexture),this.currDisplayData.type){case 0:if(B$O){var B$i=this.getDisplayMatrix();if(this._parentMatrix){var B$k=!1;if(B$i){var B$_;if(B$EO.mul(B$i,this._parentMatrix,B$EO.TEMP),B$_=B$D?(null==this._resultMatrix&&(this._resultMatrix=new B$EO),this._resultMatrix):new B$EO,!B$h.isWebGL&&this.currDisplayData.uvs||B$h.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var B$L=B$c._tempMatrix;B$L.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(B$L.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(B$k=!0,B$L.rotate(-Math.PI/2)),B$EO.mul(B$L,B$EO.TEMP,B$_)}else B$EO.TEMP.copyTo(B$_);B$k?B$O.drawTexture(B$C,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,B$_):B$O.drawTexture(B$C,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,B$_)}}}break;case 1:if(null==(B$m=B$D?(null==this._skinSprite&&(this._skinSprite=B$c.createSkinMesh()),this._skinSprite):B$c.createSkinMesh()))return;var B$r;if(null==this.currDisplayData.bones){var B$H,B$Y=this.currDisplayData.weights;this.deformData&&(B$Y=this.deformData),B$H=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=B$a.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=B$a.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=B$Y;this.currDisplayData.triangles.length;B$r=this.currDisplayData.triangles,B$m.init2(B$C,null,B$r,this._mVerticleArr,B$H);var B$G,B$X=this.getDisplayMatrix();if(this._parentMatrix)if(B$X)B$EO.mul(B$X,this._parentMatrix,B$EO.TEMP),B$G=B$D?(null==this._resultMatrix&&(this._resultMatrix=new B$EO),this._resultMatrix):new B$EO,B$EO.TEMP.copyTo(B$G),B$m.transform=B$G}else this.skinMesh(B$J,B$m,B$p);B$O.drawSkin(B$m);break;case 2:if(null==(B$m=B$D?(null==this._skinSprite&&(this._skinSprite=B$c.createSkinMesh()),this._skinSprite):B$c.createSkinMesh()))return;this.skinMesh(B$J,B$m,B$p),B$O.drawSkin(B$m)}}},B$O.skinMesh=function(B$O,B$J,B$D){var B$p,B$m=this.currTexture,B$C=this.currDisplayData.bones;B$p=this._diyTexture?(B$m=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=B$a.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=B$a.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var B$i,B$k,B$_=this.currDisplayData.weights,B$L=this.currDisplayData.triangles,B$r=0,B$H=0,B$Y=0,B$G=NaN,B$X=NaN,B$c=0,B$h=0,B$y=[],B$v=0,B$A=0;if(this.deformData&&0<this.deformData.length){var B$q=0;for(B$v=0,B$A=B$C.length;B$v<B$A;){for(B$Y=B$C[B$v++]+B$v,B$H=B$r=0;B$v<B$Y;B$v++)B$k=B$O[B$C[B$v]],B$G=B$_[B$c]+this.deformData[B$q++],B$X=B$_[B$c+1]+this.deformData[B$q++],B$h=B$_[B$c+2],B$r+=(B$G*B$k.a+B$X*B$k.c+B$k.tx)*B$h,B$H+=(B$G*B$k.b+B$X*B$k.d+B$k.ty)*B$h,B$c+=3;B$y.push(B$r,B$H)}}else for(B$v=0,B$A=B$C.length;B$v<B$A;){for(B$Y=B$C[B$v++]+B$v,B$H=B$r=0;B$v<B$Y;B$v++)B$k=B$O[B$C[B$v]],B$G=B$_[B$c],B$X=B$_[B$c+1],B$h=B$_[B$c+2],B$r+=(B$G*B$k.a+B$X*B$k.c+B$k.tx)*B$h,B$H+=(B$G*B$k.b+B$X*B$k.d+B$k.ty)*B$h,B$c+=3;B$y.push(B$r,B$H)}this._mVerticleArr=B$y,B$i=B$L,B$J.init2(B$m,null,B$i,this._mVerticleArr,B$p)},B$O.drawBonePoint=function(B$O){B$O&&this._parentMatrix&&B$O.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},B$O.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},B$O.getMatrix=function(){return this._resultMatrix},B$O.copy=function(){var B$O=new B$c;return B$O.type="copy",B$O.name=this.name,B$O.attachmentName=this.attachmentName,B$O.srcDisplayIndex=this.srcDisplayIndex,B$O.parent=this.parent,B$O.displayIndex=this.displayIndex,B$O.templet=this.templet,B$O.currSlotData=this.currSlotData,B$O.currTexture=this.currTexture,B$O.currDisplayData=this.currDisplayData,B$O},B$c.createSkinMesh=function(){return B$h.isWebGL||B$h.isConchApp?B$G.skinAniSprite():(B$h.isWebGL,null)},B$D(B$c,["_tempMatrix",function(){return this._tempMatrix=new B$EO}]),B$c}(),B$FO=function(){function B$O(){this.skinName=null,this.deformSlotDataList=[]}return B$p(B$O,"laya.ani.bone.DeformAniData"),B$O}(),B$RO=function(){function B$O(){this.deformSlotDisplayList=[]}return B$p(B$O,"laya.ani.bone.DeformSlotData"),B$O}(),B$jO=function(){function B$O(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}B$p(B$O,"laya.ani.bone.DeformSlotDisplayData");var B$J=B$O.prototype;return B$J.binarySearch1=function(B$O,B$J){var B$D=0,B$p=B$O.length-2;if(0==B$p)return 1;for(var B$m=B$p>>>1;;){if(B$O[Math.floor(B$m+1)]<=B$J?B$D=B$m+1:B$p=B$m,B$D==B$p)return B$D+1;B$m=B$D+B$p>>>1}return 0},B$J.apply=function(B$O,B$J,B$D){if(void 0===B$D&&(B$D=1),B$O+=.05,!(this.timeList.length<=0)){var B$p=0;if(!(B$O<this.timeList[0])){var B$m=this.vectices[0].length,B$C=[],B$i=this.binarySearch1(this.timeList,B$O);if(this.frameIndex=B$i,B$O>=this.timeList[this.timeList.length-1]){var B$k=this.vectices[this.vectices.length-1];if(B$D<1)for(B$p=0;B$p<B$m;B$p++)B$C[B$p]+=(B$k[B$p]-B$C[B$p])*B$D;else for(B$p=0;B$p<B$m;B$p++)B$C[B$p]=B$k[B$p];this.deformData=B$C}else{this.tweenKeyList[this.frameIndex];var B$_=this.vectices[this.frameIndex-1],B$L=this.vectices[this.frameIndex],B$r=this.timeList[this.frameIndex-1],B$H=this.timeList[this.frameIndex];B$D=this.tweenKeyList[B$i-1]?(B$O-B$r)/(B$H-B$r):0;var B$Y=NaN;for(B$p=0;B$p<B$m;B$p++)B$Y=B$_[B$p],B$C[B$p]=B$Y+(B$L[B$p]-B$Y)*B$D;this.deformData=B$C}}}},B$O}(),B$uO=function(){function B$O(){this.time=NaN,this.drawOrder=[]}return B$p(B$O,"laya.ani.bone.DrawOrderData"),B$O}(),B$lO=function(){function B$O(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return B$p(B$O,"laya.ani.bone.EventData"),B$O}(),B$v=function(){function B$pO(B$O,B$J){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=B$O,this._targetBone=B$J[B$O.targetBoneIndex],this.isSpine=B$O.isSpine,null==this._bones&&(this._bones=[]);for(var B$D=this._bones.length=0,B$p=B$O.boneIndexs.length;B$D<B$p;B$D++)this._bones.push(B$J[B$O.boneIndexs[B$D]]);this.name=B$O.name,this.mix=B$O.mix,this.bendDirection=B$O.bendDirection}B$p(B$pO,"laya.ani.bone.IkConstraint");var B$O=B$pO.prototype;return B$O.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},B$O._applyIk1=function(B$O,B$J,B$D,B$p){var B$m=B$O.parentBone,B$C=1/(B$m.resultMatrix.a*B$m.resultMatrix.d-B$m.resultMatrix.b*B$m.resultMatrix.c),B$i=B$J-B$m.resultMatrix.tx,B$k=B$D-B$m.resultMatrix.ty,B$_=(B$i*B$m.resultMatrix.d-B$k*B$m.resultMatrix.c)*B$C-B$O.transform.x,B$L=(B$k*B$m.resultMatrix.a-B$i*B$m.resultMatrix.b)*B$C-B$O.transform.y,B$r=Math.atan2(B$L,B$_)*B$pO.radDeg-0-B$O.transform.skX;B$O.transform.scX<0&&(B$r+=180),180<B$r?B$r-=360:B$r<-180&&(B$r+=360),B$O.transform.skX=B$O.transform.skY=B$O.transform.skX+B$r*B$p,B$O.update()},B$O.updatePos=function(B$O,B$J){this._sp&&this._sp.pos(B$O,B$J)},B$O._applyIk2=function(B$O,B$J,B$D,B$p,B$m,B$C){if(0!=B$C){var B$i=B$O.resultTransform.x,B$k=B$O.resultTransform.y,B$_=B$O.transform.scX,B$L=B$O.transform.scY,B$r=B$J.transform.scX,B$H=0,B$Y=0,B$G=0;B$G=B$_<0?(B$_=-B$_,B$H=180,-1):(B$H=0,1),B$L<0&&(B$L=-B$L,B$G=-B$G),B$Y=B$r<0?(B$r=-B$r,180):0;var B$X=B$J.resultTransform.x,B$c=NaN,B$h=NaN,B$y=NaN,B$v=B$O.resultMatrix.a,B$A=B$O.resultMatrix.c,B$q=B$O.resultMatrix.b,B$d=B$O.resultMatrix.d,B$M=Math.abs(B$_-B$L)<=1e-4;B$y=B$M?(B$h=B$v*B$X+B$A*(B$c=B$J.resultTransform.y)+B$O.resultMatrix.tx,B$q*B$X+B$d*B$c+B$O.resultMatrix.ty):(B$c=0,B$h=B$v*B$X+B$O.resultMatrix.tx,B$q*B$X+B$O.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new B$CO,B$mO.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(B$D,B$p,15,"#ffff00"),this._sp.graphics.drawCircle(B$h,B$y,15,"#ff00ff")),B$O.setRotation(Math.atan2(B$y-B$O.resultMatrix.ty,B$h-B$O.resultMatrix.tx));var B$a=B$O.parentBone;B$v=B$a.resultMatrix.a,B$A=B$a.resultMatrix.c,B$q=B$a.resultMatrix.b;var B$e=1/(B$v*(B$d=B$a.resultMatrix.d)-B$A*B$q),B$t=B$D-B$a.resultMatrix.tx,B$z=B$p-B$a.resultMatrix.ty,B$g=(B$t*B$d-B$z*B$A)*B$e-B$i,B$s=(B$z*B$v-B$t*B$q)*B$e-B$k,B$P=((B$t=B$h-B$a.resultMatrix.tx)*B$d-(B$z=B$y-B$a.resultMatrix.ty)*B$A)*B$e-B$i,B$E=(B$z*B$v-B$t*B$q)*B$e-B$k,B$o=Math.sqrt(B$P*B$P+B$E*B$E),B$W=B$J.length*B$r,B$N=NaN,B$F=NaN;if(B$M){var B$R=(B$g*B$g+B$s*B$s-B$o*B$o-(B$W*=B$_)*B$W)/(2*B$o*B$W);B$R<-1?B$R=-1:1<B$R&&(B$R=1),B$F=Math.acos(B$R)*B$m,B$v=B$o+B$W*B$R,B$A=B$W*Math.sin(B$F),B$N=Math.atan2(B$s*B$v-B$g*B$A,B$g*B$v+B$s*B$A)}else{var B$j=(B$v=B$_*B$W)*B$v,B$u=(B$A=B$L*B$W)*B$A,B$l=B$g*B$g+B$s*B$s,B$$=Math.atan2(B$s,B$g),B$x=-2*B$u*B$o,B$V=B$u-B$j;if(0<(B$d=B$x*B$x-4*B$V*(B$q=B$u*B$o*B$o+B$j*B$l-B$j*B$u))){var B$T=Math.sqrt(B$d);B$x<0&&(B$T=-B$T);var B$I=(B$T=-(B$x+B$T)/2)/B$V,B$w=B$q/B$T,B$U=Math.abs(B$I)<Math.abs(B$w)?B$I:B$w;B$U*B$U<=B$l&&(B$z=Math.sqrt(B$l-B$U*B$U)*B$m,B$N=B$$-Math.atan2(B$z,B$U),B$F=Math.atan2(B$z/B$L,(B$U-B$o)/B$_))}var B$Z=0,B$n=Number.MAX_VALUE,B$B=0,B$S=0,B$Q=0,B$b=0,B$K=0,B$f=0;B$b<(B$d=(B$t=B$o+B$v)*B$t)&&(B$Q=0,B$b=B$d,B$K=B$t),(B$d=(B$t=B$o-B$v)*B$t)<B$n&&(B$Z=Math.PI,B$n=B$d,B$B=B$t);var B$OO=Math.acos(-B$v*B$o/(B$j-B$u));(B$d=(B$t=B$v*Math.cos(B$OO)+B$o)*B$t+(B$z=B$A*Math.sin(B$OO))*B$z)<B$n&&(B$Z=B$OO,B$n=B$d,B$B=B$t,B$S=B$z),B$b<B$d&&(B$Q=B$OO,B$b=B$d,B$K=B$t,B$f=B$z),B$F=B$l<=(B$n+B$b)/2?(B$N=B$$-Math.atan2(B$S*B$m,B$B),B$Z*B$m):(B$N=B$$-Math.atan2(B$f*B$m,B$K),B$Q*B$m)}var B$JO=Math.atan2(B$c,B$X)*B$G,B$DO=B$O.resultTransform.skX;180<(B$N=(B$N-B$JO)*B$pO.radDeg+B$H-B$DO)?B$N-=360:B$N<-180&&(B$N+=360),B$O.resultTransform.x=B$i,B$O.resultTransform.y=B$k,B$O.resultTransform.skX=B$O.resultTransform.skY=B$DO+B$N*B$C,B$DO=B$J.resultTransform.skX,180<(B$F=((B$F+B$JO)*B$pO.radDeg-0)*B$G+B$Y-(B$DO%=360))?B$F-=360:B$F<-180&&(B$F+=360),B$J.resultTransform.x=B$X,B$J.resultTransform.y=B$c,B$J.resultTransform.skX=B$J.resultTransform.skY=B$J.resultTransform.skY+B$F*B$C,B$O.update()}},B$O._applyIk3=function(B$O,B$J,B$D,B$p,B$m,B$C){if(0!=B$C){var B$i,B$k,B$_=B$J.resultMatrix.a*B$J.length,B$L=B$J.resultMatrix.b*B$J.length,B$r=B$_*B$_+B$L*B$L,B$H=Math.sqrt(B$r),B$Y=B$O.resultMatrix.tx,B$G=B$O.resultMatrix.ty,B$X=B$J.resultMatrix.tx,B$c=B$J.resultMatrix.ty,B$h=B$X-B$Y,B$y=B$c-B$G,B$v=B$h*B$h+B$y*B$y,B$A=Math.sqrt(B$v),B$q=(B$h=B$D-B$O.resultMatrix.tx)*B$h+(B$y=B$p-B$O.resultMatrix.ty)*B$y,B$d=Math.sqrt(B$q);if(B$H+B$A<=B$d||B$d+B$H<=B$A||B$d+B$A<=B$H){var B$M=NaN;B$X=B$Y+(B$M=B$H+B$A<=B$d?1:-1)*(B$D-B$Y)*B$A/B$d,B$c=B$G+B$M*(B$p-B$G)*B$A/B$d}else{var B$a=(B$v-B$r+B$q)/(2*B$q),B$e=Math.sqrt(B$v-B$a*B$a*B$q)/B$d,B$t=B$Y+B$h*B$a,B$z=B$G+B$y*B$a,B$g=-B$y*B$e,B$s=B$h*B$e;B$c=0<B$m?(B$X=B$t-B$g,B$z-B$s):(B$X=B$t+B$g,B$z+B$s)}B$i=B$X,B$k=B$c,this.isDebug&&(this._sp||(this._sp=new B$CO,B$mO.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(B$Y,B$G,15,"#ff00ff"),this._sp.graphics.drawCircle(B$D,B$p,15,"#ffff00"),this._sp.graphics.drawCircle(B$i,B$k,15,"#ff00ff"));var B$P,B$E;B$P=Math.atan2(B$k-B$O.resultMatrix.ty,B$i-B$O.resultMatrix.tx),B$O.setRotation(B$P),(B$E=B$pO._tempMatrix).identity(),B$E.rotate(B$P),B$E.scale(B$O.resultMatrix.getScaleX(),B$O.resultMatrix.getScaleY()),B$E.translate(B$O.resultMatrix.tx,B$O.resultMatrix.ty),B$E.copyTo(B$O.resultMatrix),B$O.updateChild();var B$o,B$W;B$o=Math.atan2(B$p-B$k,B$D-B$i),B$J.setRotation(B$o),(B$W=B$pO._tempMatrix).identity(),B$W.rotate(B$o),B$W.scale(B$J.resultMatrix.getScaleX(),B$J.resultMatrix.getScaleY()),B$W.translate(B$i,B$k),B$E.copyTo(B$J.resultMatrix),B$J.updateChild()}},B$D(B$pO,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new B$EO}]),B$pO}(),B$$O=function(){function B$O(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return B$p(B$O,"laya.ani.bone.IkConstraintData"),B$O}(),B$d=function(){function B$W(B$O,B$J){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=B$O,this.position=B$O.position,this.spacing=B$O.spacing,this.rotateMix=B$O.rotateMix,this.translateMix=B$O.translateMix,this.bones=[];for(var B$D=this.data.bones,B$p=0,B$m=B$D.length;B$p<B$m;B$p++)this.bones.push(B$J[B$D[B$p]])}B$p(B$W,"laya.ani.bone.PathConstraint");var B$O=B$W.prototype;return B$O.apply=function(B$O,B$J){if(this.target){var B$D=this.translateMix,B$p=this.translateMix,B$m=0<B$p,B$C=this.data.spacingMode,B$i="length"==B$C,B$k=this.data.rotateMode,B$_="tangent"==B$k,B$L="chainScale"==B$k,B$r=[],B$H=this.bones.length,B$Y=B$_?B$H:B$H+1,B$G=[];(this._spaces=B$G)[0]=this.position;var B$X=this.spacing;if(B$L||B$i)for(var B$c=0,B$h=B$Y-1;B$c<B$h;){var B$y=this.bones[B$c],B$v=B$y.length,B$A=B$v*B$y.resultMatrix.a,B$q=B$v*B$y.resultMatrix.b;B$v=Math.sqrt(B$A*B$A+B$q*B$q),B$L&&(B$r[B$c]=B$v),B$G[++B$c]=B$i?Math.max(0,B$v+B$X):B$X}else for(B$c=1;B$c<B$Y;B$c++)B$G[B$c]=B$X;var B$d=this.computeWorldPositions(this.target,B$O,B$J,B$Y,B$_,"percent"==this.data.positionMode,"percent"==B$C);if(this._debugKey){for(B$c=0;B$c<B$d.length;B$c++)B$J.drawCircle(B$d[B$c++],B$d[B$c++],5,"#00ff00");var B$M=[];for(B$c=0;B$c<B$d.length;B$c++)B$M.push(B$d[B$c++],B$d[B$c++]);B$J.drawLines(0,0,B$M,"#ff0000")}var B$a=B$d[0],B$e=B$d[1],B$t=this.data.offsetRotation,B$z="chain"==B$k&&0==B$t,B$g=NaN;for(B$c=0,B$g=3;B$c<B$H;B$c++,B$g+=3){(B$y=this.bones[B$c]).resultMatrix.tx+=(B$a-B$y.resultMatrix.tx)*B$D,B$y.resultMatrix.ty+=(B$e-B$y.resultMatrix.ty)*B$D;var B$s=(B$A=B$d[B$g])-B$a,B$P=(B$q=B$d[B$g+1])-B$e;if(B$L&&0!=(B$v=B$r[B$c])){var B$E=(Math.sqrt(B$s*B$s+B$P*B$P)/B$v-1)*B$p+1;B$y.resultMatrix.a*=B$E,B$y.resultMatrix.c*=B$E}if(B$a=B$A,B$e=B$q,B$m){var B$o=B$y.resultMatrix.a,B$W=B$y.resultMatrix.c,B$N=B$y.resultMatrix.b,B$F=B$y.resultMatrix.d,B$R=NaN,B$j=NaN,B$u=NaN;B$R=B$_?B$d[B$g-1]:0==B$G[B$c+1]?B$d[B$g+2]:Math.atan2(B$P,B$s),B$R-=Math.atan2(B$N,B$o)-B$t/180*Math.PI,B$z&&(B$j=Math.cos(B$R),B$u=Math.sin(B$R),B$a+=((B$v=B$y.length)*(B$j*B$o-B$u*B$N)-B$s)*B$p,B$e+=(B$v*(B$u*B$o+B$j*B$N)-B$P)*B$p),B$R>Math.PI?B$R-=2*Math.PI:B$R<-Math.PI&&(B$R+=2*Math.PI),B$R*=B$p,B$j=Math.cos(B$R),B$u=Math.sin(B$R),B$y.resultMatrix.a=B$j*B$o-B$u*B$N,B$y.resultMatrix.c=B$j*B$W-B$u*B$F,B$y.resultMatrix.b=B$u*B$o+B$j*B$N,B$y.resultMatrix.d=B$u*B$W+B$j*B$F}}}},B$O.computeWorldVertices2=function(B$O,B$J,B$D,B$p,B$m,B$C){var B$i,B$k,B$_=B$O.currDisplayData.bones,B$L=B$O.currDisplayData.weights,B$r=B$O.currDisplayData.triangles,B$H=0,B$Y=0,B$G=0,B$X=0,B$c=0,B$h=0,B$y=0,B$v=0,B$A=0,B$q=0,B$d=0;if(null!=B$_){for(B$H=0;B$H<B$D;B$H+=2)B$Y+=(B$X=B$_[B$Y])+1,B$G+=B$X;var B$M=B$J;for(B$c=B$C,B$h=3*B$G;B$c<B$p;B$c+=2){for(B$v=B$y=0,B$X=B$_[B$Y++],B$X+=B$Y;B$Y<B$X;B$Y++,B$h+=3){B$i=B$M[B$_[B$Y]].resultMatrix,B$A=B$L[B$h],B$q=B$L[B$h+1];var B$a=B$L[B$h+2];B$y+=(B$A*B$i.a+B$q*B$i.c+B$i.tx)*B$a,B$v+=(B$A*B$i.b+B$q*B$i.d+B$i.ty)*B$a}B$m[B$c]=B$y,B$m[B$c+1]=B$v}}else{var B$e,B$t;if(B$r||(B$r=B$L),B$O.deformData&&(B$r=B$O.deformData),B$e=B$O.parent,B$J)for(B$d=B$J.length,B$H=0;B$H<B$d;B$H++)if(B$J[B$H].name==B$e){B$k=B$J[B$H];break}B$k&&(B$t=B$k.resultMatrix),B$t||(B$t=B$W._tempMt);var B$z=B$t.tx,B$g=B$t.ty,B$s=B$t.a,B$P=B$t.b,B$E=B$t.c,B$o=B$t.d;for(B$k&&(B$o*=B$k.d),B$Y=B$D,B$c=B$C;B$c<B$p;B$Y+=2,B$c+=2)B$A=B$r[B$Y],B$q=B$r[B$Y+1],B$m[B$c]=B$A*B$s+B$q*B$P+B$z,B$m[B$c+1]=-(B$A*B$E+B$q*B$o+B$g)}},B$O.computeWorldPositions=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i){B$O.currDisplayData.bones,B$O.currDisplayData.weights,B$O.currDisplayData.triangles;var B$k=[],B$_=0,B$L=B$O.currDisplayData.verLen,B$r=this.position,B$H=this._spaces,B$Y=[],B$G=[],B$X=B$L/6,B$c=-1,B$h=NaN,B$y=0,B$v=0,B$A=NaN,B$q=NaN,B$d=NaN,B$M=NaN;if(B$X--,B$L-=4,this.computeWorldVertices2(B$O,B$J,2,B$L,B$k,0),this._debugKey)for(B$_=0;B$_<B$k.length;)B$D.drawCircle(B$k[B$_++],B$k[B$_++],10,"#ff0000");B$Y=B$k,this._curves.length=B$X;var B$a=this._curves,B$e=B$Y[B$h=0],B$t=B$Y[1],B$z=0,B$g=0,B$s=0,B$P=0,B$E=0,B$o=0,B$W=NaN,B$N=NaN,B$F=NaN,B$R=NaN,B$j=NaN,B$u=NaN,B$l=NaN,B$$=NaN,B$x=0;for(B$_=0,B$x=2;B$_<B$X;B$_++,B$x+=6)B$z=B$Y[B$x],B$g=B$Y[B$x+1],B$s=B$Y[B$x+2],B$P=B$Y[B$x+3],B$j=2*(B$W=.1875*(B$e-2*B$z+B$s))+(B$F=.09375*(3*(B$z-B$s)-B$e+(B$E=B$Y[B$x+4]))),B$u=2*(B$N=.1875*(B$t-2*B$g+B$P))+(B$R=.09375*(3*(B$g-B$P)-B$t+(B$o=B$Y[B$x+5]))),B$l=.75*(B$z-B$e)+B$W+.16666667*B$F,B$$=.75*(B$g-B$t)+B$N+.16666667*B$R,B$h+=Math.sqrt(B$l*B$l+B$$*B$$),B$l+=B$j,B$$+=B$u,B$j+=B$F,B$u+=B$R,B$h+=Math.sqrt(B$l*B$l+B$$*B$$),B$l+=B$j,B$$+=B$u,B$h+=Math.sqrt(B$l*B$l+B$$*B$$),B$l+=B$j+B$F,B$$+=B$u+B$R,B$h+=Math.sqrt(B$l*B$l+B$$*B$$),B$a[B$_]=B$h,B$e=B$E,B$t=B$o;if(B$C&&(B$r*=B$h),B$i)for(B$_=0;B$_<B$p;B$_++)B$H[B$_]*=B$h;var B$V=this._segments,B$T=0,B$I=0;for(B$I=B$v=B$y=B$_=0;B$_<B$p;B$_++,B$y+=3)if((B$A=B$r+=B$q=B$H[B$_])<0)this.addBeforePosition(B$A,B$Y,0,B$G,B$y);else if(B$h<B$A)this.addAfterPosition(B$A-B$h,B$Y,B$L-4,B$G,B$y);else{for(;;B$v++)if(!((B$M=B$a[B$v])<B$A)){0==B$v?B$A/=B$M:B$A=(B$A-(B$d=B$a[B$v-1]))/(B$M-B$d);break}if(B$v!=B$c){var B$w=6*(B$c=B$v);for(B$e=B$Y[B$w],B$t=B$Y[B$w+1],B$z=B$Y[B$w+2],B$g=B$Y[B$w+3],B$s=B$Y[B$w+4],B$P=B$Y[B$w+5],B$j=2*(B$W=.03*(B$e-2*B$z+B$s))+(B$F=.006*(3*(B$z-B$s)-B$e+(B$E=B$Y[B$w+6]))),B$u=2*(B$N=.03*(B$t-2*B$g+B$P))+(B$R=.006*(3*(B$g-B$P)-B$t+(B$o=B$Y[B$w+7]))),B$l=.3*(B$z-B$e)+B$W+.16666667*B$F,B$$=.3*(B$g-B$t)+B$N+.16666667*B$R,B$T=Math.sqrt(B$l*B$l+B$$*B$$),B$V[0]=B$T,B$w=1;B$w<8;B$w++)B$l+=B$j,B$$+=B$u,B$j+=B$F,B$u+=B$R,B$T+=Math.sqrt(B$l*B$l+B$$*B$$),B$V[B$w]=B$T;B$l+=B$j,B$$+=B$u,B$T+=Math.sqrt(B$l*B$l+B$$*B$$),B$V[8]=B$T,B$l+=B$j+B$F,B$$+=B$u+B$R,B$T+=Math.sqrt(B$l*B$l+B$$*B$$),B$V[9]=B$T,B$I=0}for(B$A*=B$T;;B$I++)if(!((B$M=B$V[B$I])<B$A)){0==B$I?B$A/=B$M:B$A=B$I+(B$A-(B$d=B$V[B$I-1]))/(B$M-B$d);break}this.addCurvePosition(.1*B$A,B$e,B$t,B$z,B$g,B$s,B$P,B$E,B$o,B$G,B$y,B$m||0<B$_&&0==B$q)}return B$G},B$O.addBeforePosition=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$J[B$D],B$i=B$J[B$D+1],B$k=B$J[B$D+2]-B$C,B$_=B$J[B$D+3]-B$i,B$L=Math.atan2(B$_,B$k);B$p[B$m]=B$C+B$O*Math.cos(B$L),B$p[B$m+1]=B$i+B$O*Math.sin(B$L),B$p[B$m+2]=B$L},B$O.addAfterPosition=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$J[B$D+2],B$i=B$J[B$D+3],B$k=B$C-B$J[B$D],B$_=B$i-B$J[B$D+1],B$L=Math.atan2(B$_,B$k);B$p[B$m]=B$C+B$O*Math.cos(B$L),B$p[B$m+1]=B$i+B$O*Math.sin(B$L),B$p[B$m+2]=B$L},B$O.addCurvePosition=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r,B$H){0==B$O&&(B$O=1e-4);var B$Y=B$O*B$O,B$G=B$Y*B$O,B$X=1-B$O,B$c=B$X*B$X,B$h=B$c*B$X,B$y=B$X*B$O,B$v=3*B$y,B$A=B$X*B$v,B$q=B$v*B$O,B$d=B$J*B$h+B$p*B$A+B$C*B$q+B$k*B$G,B$M=B$D*B$h+B$m*B$A+B$i*B$q+B$_*B$G;B$L[B$r]=B$d,B$L[B$r+1]=B$M,B$L[B$r+2]=B$H?Math.atan2(B$M-(B$D*B$c+B$m*B$y*2+B$i*B$Y),B$d-(B$J*B$c+B$p*B$y*2+B$C*B$Y)):0},B$W.NONE=-1,B$W.BEFORE=-2,B$W.AFTER=-3,B$D(B$W,["_tempMt",function(){return this._tempMt=new B$EO}]),B$W}(),B$xO=function(){function B$O(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return B$p(B$O,"laya.ani.bone.PathConstraintData"),B$O}(),B$VO=function(){function B$O(){this.name=null,this.slotArr=[]}return B$p(B$O,"laya.ani.bone.SkinData"),B$O}(),B$TO=function(){function B$O(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}B$p(B$O,"laya.ani.bone.SkinSlotDisplayData");var B$J=B$O.prototype;return B$J.createTexture=function(B$O){return this.texture||(this.texture=new B$oO(B$O.bitmap,this.uvs),B$O.bitmap.alphaTexture&&(this.texture.alphaTexture=new B$oO(B$O.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=B$O.height,this.texture.height=B$O.width,this.texture.offsetX=-B$O.offsetX,this.texture.offsetY=-B$O.offsetY,this.texture.sourceWidth=B$O.sourceHeight,this.texture.sourceHeight=B$O.sourceWidth):(this.texture.width=B$O.width,this.texture.height=B$O.height,this.texture.offsetX=-B$O.offsetX,this.texture.offsetY=-B$O.offsetY,this.texture.sourceWidth=B$O.sourceWidth,this.texture.sourceHeight=B$O.sourceHeight),B$h.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},B$J.destory=function(){this.texture&&this.texture.destroy()},B$O}(),B$IO=function(){function B$O(){this.name=null,this.displayArr=[]}return B$p(B$O,"laya.ani.bone.SlotData"),B$O.prototype.getDisplayByName=function(B$O){for(var B$J=0,B$D=this.displayArr.length;B$J<B$D;B$J++)if(this.displayArr[B$J].attachmentName==B$O)return B$J;return-1},B$O}(),B$M=function(){function B$O(B$O,B$J){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=B$c(2,0),this._data=B$O,null==this._bones&&(this._bones=[]),this.target=B$J[B$O.targetIndex];var B$D,B$p=0;for(B$p=0,B$D=B$O.boneIndexs.length;B$p<B$D;B$p++)this._bones.push(B$J[B$O.boneIndexs[B$p]]);this.rotateMix=B$O.rotateMix,this.translateMix=B$O.translateMix,this.scaleMix=B$O.scaleMix,this.shearMix=B$O.shearMix}return B$p(B$O,"laya.ani.bone.TfConstraint"),B$O.prototype.apply=function(){for(var B$O,B$J=this.target.resultMatrix.a,B$D=this.target.resultMatrix.b,B$p=this.target.resultMatrix.c,B$m=this.target.resultMatrix.d,B$C=0,B$i=this._bones.length;B$C<B$i;B$C++){if(B$O=this._bones[B$C],0<this.rotateMix){var B$k=B$O.resultMatrix.a,B$_=B$O.resultMatrix.b,B$L=B$O.resultMatrix.c,B$r=B$O.resultMatrix.d,B$H=Math.atan2(B$p,B$J)-Math.atan2(B$L,B$k)+this._data.offsetRotation*Math.PI/180;B$H>Math.PI?B$H-=2*Math.PI:B$H<-Math.PI&&(B$H+=2*Math.PI),B$H*=this.rotateMix;var B$Y=Math.cos(B$H),B$G=Math.sin(B$H);B$O.resultMatrix.a=B$Y*B$k-B$G*B$L,B$O.resultMatrix.b=B$Y*B$_-B$G*B$r,B$O.resultMatrix.c=B$G*B$k+B$Y*B$L,B$O.resultMatrix.d=B$G*B$_+B$Y*B$r}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),B$O.resultMatrix.tx+=(this._temp[0]-B$O.resultMatrix.tx)*this.translateMix,B$O.resultMatrix.ty+=(this._temp[1]-B$O.resultMatrix.ty)*this.translateMix,B$O.updateChild()),0<this.scaleMix){var B$X=Math.sqrt(B$O.resultMatrix.a*B$O.resultMatrix.a+B$O.resultMatrix.c*B$O.resultMatrix.c),B$c=Math.sqrt(B$J*B$J+B$p*B$p),B$h=1e-5<B$X?(B$X+(B$c-B$X+this._data.offsetScaleX)*this.scaleMix)/B$X:0;B$O.resultMatrix.a*=B$h,B$O.resultMatrix.c*=B$h,B$X=Math.sqrt(B$O.resultMatrix.b*B$O.resultMatrix.b+B$O.resultMatrix.d*B$O.resultMatrix.d),B$c=Math.sqrt(B$D*B$D+B$m*B$m),B$h=1e-5<B$X?(B$X+(B$c-B$X+this._data.offsetScaleY)*this.scaleMix)/B$X:0,B$O.resultMatrix.b*=B$h,B$O.resultMatrix.d*=B$h}if(0<this.shearMix){B$_=B$O.resultMatrix.b,B$r=B$O.resultMatrix.d;var B$y=Math.atan2(B$r,B$_);(B$H=Math.atan2(B$m,B$D)-Math.atan2(B$p,B$J)-(B$y-Math.atan2(B$O.resultMatrix.c,B$O.resultMatrix.a)))>Math.PI?B$H-=2*Math.PI:B$H<-Math.PI&&(B$H+=2*Math.PI),B$H=B$y+(B$H+this._data.offsetShearY*Math.PI/180)*this.shearMix,B$h=Math.sqrt(B$_*B$_+B$r*B$r),B$O.resultMatrix.b=Math.cos(B$H)*B$h,B$O.resultMatrix.d=Math.sin(B$H)*B$h}}},B$O}(),B$wO=function(){function B$O(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return B$p(B$O,"laya.ani.bone.TfConstraintData"),B$O}(),B$UO=function(){function B$O(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}B$p(B$O,"laya.ani.bone.Transform");var B$J=B$O.prototype;return B$J.initData=function(B$O){null!=B$O.x&&(this.x=B$O.x),null!=B$O.y&&(this.y=B$O.y),null!=B$O.skX&&(this.skX=B$O.skX),null!=B$O.skY&&(this.skY=B$O.skY),null!=B$O.scX&&(this.scX=B$O.scX),null!=B$O.scY&&(this.scY=B$O.scY)},B$J.getMatrix=function(){var B$O;return(B$O=this.mMatrix?this.mMatrix:this.mMatrix=new B$EO).identity(),B$O.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(B$O,this.skewX*Math.PI/180,this.skewY*Math.PI/180),B$O.rotate(this.skX*Math.PI/180),B$O.translate(this.x,this.y),B$O},B$J.skew=function(B$O,B$J,B$D){var B$p=Math.sin(B$D),B$m=Math.cos(B$D),B$C=Math.sin(B$J),B$i=Math.cos(B$J);return B$O.setTo(B$O.a*B$i-B$O.b*B$p,B$O.a*B$C+B$O.b*B$m,B$O.c*B$i-B$O.d*B$p,B$O.c*B$C+B$O.d*B$m,B$O.tx*B$i-B$O.ty*B$p,B$O.tx*B$C+B$O.ty*B$m),B$O},B$O}(),B$a=function(){function B$O(){}return B$p(B$O,"laya.ani.bone.UVTools"),B$O.getRelativeUV=function(B$O,B$J,B$D){var B$p=B$O[0],B$m=B$O[2]-B$O[0],B$C=B$O[1],B$i=B$O[5]-B$O[1];B$D||(B$D=[]),B$D.length=B$J.length;var B$k,B$_=0;B$k=B$D.length;var B$L=1/B$m,B$r=1/B$i;for(B$_=0;B$_<B$k;B$_+=2)B$D[B$_]=(B$J[B$_]-B$p)*B$L,B$D[B$_+1]=(B$J[B$_+1]-B$C)*B$r;return B$D},B$O.getAbsoluteUV=function(B$O,B$J,B$D){if(0==B$O[0]&&0==B$O[1]&&1==B$O[4]&&1==B$O[5])return B$D?(B$y.copyArray(B$D,B$J),B$D):B$J;var B$p=B$O[0],B$m=B$O[2]-B$O[0],B$C=B$O[1],B$i=B$O[5]-B$O[1];B$D||(B$D=[]),B$D.length=B$J.length;var B$k,B$_=0;for(B$k=B$D.length,B$_=0;B$_<B$k;B$_+=2)B$D[B$_]=B$J[B$_]*B$m+B$p,B$D[B$_+1]=B$J[B$_+1]*B$i+B$C;return B$D},B$O}(),B$W=function(){function B$O(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return B$p(B$O,"laya.ani.KeyFramesContent"),B$O}(),B$e=function(){function B$r(){}return B$p(B$r,"laya.ani.math.BezierLerp"),B$r.getBezierRate=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$r._getBezierParamKey(B$J,B$D,B$p,B$m),B$i=100*B$C+B$O;if(B$r._bezierResultCache[B$i])return B$r._bezierResultCache[B$i];var B$k,B$_=B$r._getBezierPoints(B$J,B$D,B$p,B$m,B$C),B$L=0;for(B$k=B$_.length,B$L=0;B$L<B$k;B$L+=2)if(B$O<=B$_[B$L])return B$r._bezierResultCache[B$i]=B$_[B$L+1],B$_[B$L+1];return B$r._bezierResultCache[B$i]=1},B$r._getBezierParamKey=function(B$O,B$J,B$D,B$p){return 100*(100*(100*(100*B$O+B$J)+B$D)+B$p)},B$r._getBezierPoints=function(B$O,B$J,B$D,B$p,B$m){return B$r._bezierPointsCache[B$m]?B$r._bezierPointsCache[B$m]:(B$C=[0,0,B$O,B$J,B$D,B$p,1,1],B$i=(new B$k).getBezierPoints(B$C,100,3),B$r._bezierPointsCache[B$m]=B$i);var B$C,B$i},B$r._bezierResultCache={},B$r._bezierPointsCache={},B$r}(),B$t=function(B$O){function B$J(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,B$J.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}B$p(B$J,"laya.ani.AnimationPlayer",B$m);var B$D=B$J.prototype;return B$mO.imps(B$D,{"laya.resource.IDestroy":!0}),B$D._onTempletLoadedComputeFullKeyframeIndices=function(B$O,B$J,B$D){this._templet===B$D&&this._cachePlayRate===B$O&&this._cacheFrameRate===B$J&&this._computeFullKeyframeIndices()},B$D._computeFullKeyframeIndices=function(){for(var B$O=this._fullFrames=[],B$J=this._templet,B$D=this._cacheFrameRateInterval*this._cachePlayRate,B$p=0,B$m=B$J.getAnimationCount();B$p<B$m;B$p++){for(var B$C=[],B$i=0,B$k=B$J.getAnimation(B$p).nodes.length;B$i<B$k;B$i++){for(var B$_=B$J.getAnimation(B$p).nodes[B$i],B$L=Math.floor(B$_.playTime/B$D+.01),B$r=new Uint16Array(B$L+1),B$H=-1,B$Y=0,B$G=B$_.keyFrame.length;B$Y<B$G;B$Y++){var B$X=B$_.keyFrame[B$Y],B$c=B$X.startTime,B$h=B$c+B$X.duration+B$D;do{for(var B$y=Math.floor(B$c/B$D+.5),B$v=B$H+1;B$v<B$y;B$v++)B$r[B$v]=B$Y;B$r[B$H=B$y]=B$Y,B$c+=B$D}while(B$c<=B$h)}B$C.push(B$r)}B$O.push(B$C)}},B$D._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},B$D._calculatePlayDuration=function(){if(0!==this.state){var B$O=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=B$O),this._playEnd>B$O&&(this._playEnd=B$O),this._playDuration=this._playEnd-this._playStart}},B$D._setPlayParams=function(B$O,B$J){this._currentTime=B$O,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/B$J+.01),0),this._currentFrameTime=this._currentKeyframeIndex*B$J},B$D._setPlayParamsWhenStop=function(B$O,B$J){this._currentTime=B$O,this._currentKeyframeIndex=Math.max(Math.floor(B$O/B$J+.01),0),this._currentFrameTime=this._currentKeyframeIndex*B$J,this._currentAnimationClipIndex=-1},B$D._update=function(B$O){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var B$J=this._cacheFrameRateInterval*this._cachePlayRate,B$D=0;this._startUpdateLoopCount!==B$X.loopCount&&(B$D=B$O*this.playbackRate,this._elapsedPlaybackTime+=B$D);var B$p=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=B$p)return this._setPlayParamsWhenStop(B$p,B$J),void this.event("stopped");if(B$D+=this._currentTime,0<B$p)if(B$p<=B$D)do{if(B$D-=B$p,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(B$p,B$J),this._stopWhenCircleFinish=!1,void this.event("stopped");B$D<B$p&&(this._setPlayParams(B$D,B$J),this.event("complete"))}while(B$p<=B$D);else this._setPlayParams(B$D,B$J);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(B$p,B$J),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},B$D._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},B$D.play=function(B$O,B$J,B$D,B$p,B$m){if(void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=1),void 0===B$D&&(B$D=2147483647),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(B$D<0||B$p<0||B$m<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==B$m&&B$m<B$p)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=B$J,this._overallDuration=B$D,this._playStart=B$p,this._playEnd=B$m,this._paused=!1,this._currentAnimationClipIndex=B$O,this._currentKeyframeIndex=0,this._startUpdateLoopCount=B$X.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},B$D.playByFrame=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$O&&(B$O=0),void 0===B$J&&(B$J=1),void 0===B$D&&(B$D=2147483647),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=30);var B$i=1e3/B$C;this.play(B$O,B$J,B$D,B$p*B$i,B$m*B$i)},B$D.stop=function(B$O){void 0===B$O&&(B$O=!0),B$O?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},B$C(0,B$D,"playEnd",function(){return this._playEnd}),B$C(0,B$D,"templet",function(){return this._templet},function(B$O){0===!this.state&&this.stop(!0),this._templet!==B$O&&((this._templet=B$O).loaded?this._computeFullKeyframeIndices():B$O.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),B$C(0,B$D,"playStart",function(){return this._playStart}),B$C(0,B$D,"playDuration",function(){return this._playDuration}),B$C(0,B$D,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),B$C(0,B$D,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),B$C(0,B$D,"overallDuration",function(){return this._overallDuration}),B$C(0,B$D,"currentFrameTime",function(){return this._currentFrameTime}),B$C(0,B$D,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),B$C(0,B$D,"currentPlayTime",function(){return this._currentTime+this._playStart}),B$C(0,B$D,"cachePlayRate",function(){return this._cachePlayRate},function(B$O){this._cachePlayRate!==B$O&&(this._cachePlayRate=B$O,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[B$O,this._cacheFrameRate])))}),B$C(0,B$D,"cacheFrameRate",function(){return this._cacheFrameRate},function(B$O){this._cacheFrameRate!==B$O&&(this._cacheFrameRate=B$O,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,B$O])))}),B$C(0,B$D,"currentTime",null,function(B$O){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(B$O<this._playStart||B$O>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=B$X.loopCount;var B$J=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=B$O,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/B$J),0),this._currentFrameTime=this._currentKeyframeIndex*B$J}}),B$C(0,B$D,"paused",function(){return this._paused},function(B$O){(this._paused=B$O)&&this.event("paused")}),B$C(0,B$D,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),B$C(0,B$D,"destroyed",function(){return this._destroyed}),B$J}(),B$N=function(B$O){function B$J(){B$J.__super.call(this),B$h.isConchNode&&(this.drawSkin=function(B$O){B$O.transform||(B$O.transform=B$EO.EMPTY),this._addCmd([B$O]),this.setSkinMesh&&this.setSkinMesh(B$O._ps,B$O.mVBData,B$O.mEleNum,0,B$O.mTexture,B$O.transform)})}return B$p(B$J,"laya.ani.GraphicsAni",B$i),B$J.prototype.drawSkin=function(B$O){var B$J=[B$O];this._saveToCmd(B$h._context._drawSkin,B$J)},B$J.create=function(){return B$J._caches.pop()||new B$J},B$J.recycle=function(B$O){B$O.clear(),B$J._caches.push(B$O)},B$J._caches=[],B$J}(),B$F=function(B$O){function B$v(){this._aniMap={},this.unfixedLastAniIndex=-1,B$v.__super.call(this),this._anis=new Array}B$p(B$v,"laya.ani.AnimationTemplet",B$r);var B$J=B$v.prototype;return B$J.parse=function(B$O){var B$J=new B$PO(B$O);this._aniVersion=B$J.readUTFString(),B$A.parse(this,B$J)},B$J._calculateKeyFrame=function(B$O,B$J,B$D){var B$p=B$O.keyFrame;B$p[B$J]=B$p[0];for(var B$m=0;B$m<B$J;B$m++){var B$C=B$p[B$m];B$C.nextData=0===B$C.duration?B$C.data:B$p[B$m+1].data}B$p.length--},B$J.onAsynLoaded=function(B$O,B$J,B$D){var B$p=new B$PO(B$J);switch(this._aniVersion=B$p.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":B$q.parse(this,B$p);break;default:B$A.parse(this,B$p)}this._endLoaded()},B$J.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},B$J.getAnimationCount=function(){return this._anis.length},B$J.getAnimation=function(B$O){return this._anis[B$O]},B$J.getAniDuration=function(B$O){return this._anis[B$O].playTime},B$J.getNodes=function(B$O){return this._anis[B$O].nodes},B$J.getNodeIndexWithName=function(B$O,B$J){return this._anis[B$O].bone3DMap[B$J]},B$J.getNodeCount=function(B$O){return this._anis[B$O].nodes.length},B$J.getTotalkeyframesLength=function(B$O){return this._anis[B$O].totalKeyframeDatasLength},B$J.getPublicExtData=function(){return this._publicExtData},B$J.getAnimationDataWithCache=function(B$O,B$J,B$D,B$p){var B$m=B$J[B$D];if(B$m){var B$C=B$m[B$O];return B$C?B$C[B$p]:null}return null},B$J.setAnimationDataWithCache=function(B$O,B$J,B$D,B$p,B$m){var B$C=B$J[B$D]||(B$J[B$D]={});(B$C[B$O]||(B$C[B$O]=[]))[B$p]=B$m},B$J.getOriginalData=function(B$O,B$J,B$D,B$p,B$m){for(var B$C=this._anis[B$O].nodes,B$i=0,B$k=0,B$_=B$C.length,B$L=0;B$k<B$_;B$k++){var B$r,B$H=B$C[B$k];B$r=B$H.keyFrame[B$D[B$k][B$p]],B$H.dataOffset=B$L;var B$Y=B$m-B$r.startTime,B$G=B$H.lerpType;if(B$G)switch(B$G){case 0:case 1:for(B$i=0;B$i<B$H.keyframeWidth;)B$i+=B$H.interpolationMethod[B$i](B$H,B$i,B$J,B$L+B$i,B$r.data,B$Y,null,B$r.duration,B$r.nextData);break;case 2:var B$X=B$r.interpolationData,B$c=B$X.length,B$h=0;for(B$i=0;B$i<B$c;){var B$y=B$X[B$i];switch(B$y){case 6:case 7:B$i+=B$v.interpolation[B$y](B$H,B$h,B$J,B$L+B$h,B$r.data,B$Y,null,B$r.duration,B$r.nextData,B$X,B$i+1);break;default:B$i+=B$v.interpolation[B$y](B$H,B$h,B$J,B$L+B$h,B$r.data,B$Y,null,B$r.duration,B$r.nextData)}B$h++}}else for(B$i=0;B$i<B$H.keyframeWidth;)B$i+=B$H.interpolationMethod[B$i](B$H,B$i,B$J,B$L+B$i,B$r.data,B$Y,null,B$r.duration,B$r.nextData);B$L+=B$H.keyframeWidth}},B$J.getNodesCurrentFrameIndex=function(B$O,B$J){var B$D=this._anis[B$O].nodes;B$O!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(B$D.length),this.unfixedCurrentTimes=new Float32Array(B$D.length),this.unfixedLastAniIndex=B$O);for(var B$p=0,B$m=B$D.length;B$p<B$m;B$p++){var B$C=B$D[B$p];for(B$J<this.unfixedCurrentTimes[B$p]&&(this.unfixedCurrentFrameIndexes[B$p]=0),this.unfixedCurrentTimes[B$p]=B$J;this.unfixedCurrentFrameIndexes[B$p]<B$C.keyFrame.length&&!(B$C.keyFrame[this.unfixedCurrentFrameIndexes[B$p]].startTime>this.unfixedCurrentTimes[B$p]);)this.unfixedCurrentFrameIndexes[B$p]++;this.unfixedCurrentFrameIndexes[B$p]--}return this.unfixedCurrentFrameIndexes},B$J.getOriginalDataUnfixedRate=function(B$O,B$J,B$D){var B$p=this._anis[B$O].nodes;B$O!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(B$p.length),this.unfixedCurrentTimes=new Float32Array(B$p.length),this.unfixedKeyframes=B$c(B$p.length),this.unfixedLastAniIndex=B$O);for(var B$m=0,B$C=0,B$i=B$p.length,B$k=0;B$C<B$i;B$C++){var B$_=B$p[B$C];for(B$D<this.unfixedCurrentTimes[B$C]&&(this.unfixedCurrentFrameIndexes[B$C]=0),this.unfixedCurrentTimes[B$C]=B$D;this.unfixedCurrentFrameIndexes[B$C]<B$_.keyFrame.length&&!(B$_.keyFrame[this.unfixedCurrentFrameIndexes[B$C]].startTime>this.unfixedCurrentTimes[B$C]);)this.unfixedKeyframes[B$C]=B$_.keyFrame[this.unfixedCurrentFrameIndexes[B$C]],this.unfixedCurrentFrameIndexes[B$C]++;var B$L=this.unfixedKeyframes[B$C];B$_.dataOffset=B$k;var B$r=B$D-B$L.startTime;if(B$_.lerpType)switch(B$_.lerpType){case 0:case 1:for(B$m=0;B$m<B$_.keyframeWidth;)B$m+=B$_.interpolationMethod[B$m](B$_,B$m,B$J,B$k+B$m,B$L.data,B$r,null,B$L.duration,B$L.nextData);break;case 2:var B$H=B$L.interpolationData,B$Y=B$H.length,B$G=0;for(B$m=0;B$m<B$Y;){var B$X=B$H[B$m];switch(B$X){case 6:case 7:B$m+=B$v.interpolation[B$X](B$_,B$G,B$J,B$k+B$G,B$L.data,B$r,null,B$L.duration,B$L.nextData,B$H,B$m+1);break;default:B$m+=B$v.interpolation[B$X](B$_,B$G,B$J,B$k+B$G,B$L.data,B$r,null,B$L.duration,B$L.nextData)}B$G++}}else for(B$m=0;B$m<B$_.keyframeWidth;)B$m+=B$_.interpolationMethod[B$m](B$_,B$m,B$J,B$k+B$m,B$L.data,B$r,null,B$L.duration,B$L.nextData);B$k+=B$_.keyframeWidth}},B$v._LinearInterpolation_0=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){var B$r=0===B$k?0:B$C/B$k;return B$D[B$p]=(1-B$r)*B$m[B$J]+B$r*B$_[B$J],1},B$v._QuaternionInterpolation_1=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){var B$r=0===B$k?0:B$C/B$k;return B$Y.slerpQuaternionArray(B$m,B$J,B$_,B$J,B$r,B$D,B$p),4},B$v._AngleInterpolation_2=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return 0},B$v._RadiansInterpolation_3=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return 0},B$v._Matrix4x4Interpolation_4=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){for(var B$r=0;B$r<16;B$r++,B$J++)B$D[B$p+B$r]=B$m[B$J]+B$C*B$i[B$J];return 16},B$v._NoInterpolation_5=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L){return B$D[B$p]=B$m[B$J],1},B$v._BezierInterpolation_6=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r){return void 0===B$r&&(B$r=0),B$D[B$p]=B$m[B$J]+(B$_[B$J]-B$m[B$J])*B$e.getBezierRate(B$C/B$k,B$L[B$r],B$L[B$r+1],B$L[B$r+2],B$L[B$r+3]),5},B$v._BezierInterpolation_7=function(B$O,B$J,B$D,B$p,B$m,B$C,B$i,B$k,B$_,B$L,B$r){return void 0===B$r&&(B$r=0),B$D[B$p]=B$L[B$r+4]+B$L[B$r+5]*B$e.getBezierRate((.001*B$C+B$L[B$r+6])/B$L[B$r+7],B$L[B$r],B$L[B$r+1],B$L[B$r+2],B$L[B$r+3]),9},B$v.load=function(B$O){return B$mO.loader.create(B$O,null,null,B$v)},B$v.interpolation=[B$v._LinearInterpolation_0,B$v._QuaternionInterpolation_1,B$v._AngleInterpolation_2,B$v._RadiansInterpolation_3,B$v._Matrix4x4Interpolation_4,B$v._NoInterpolation_5,B$v._BezierInterpolation_6,B$v._BezierInterpolation_7],B$v}(),B$z=function(B$J){function B$D(B$O,B$J){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,B$D.__super.call(this),void 0===B$J&&(B$J=0),B$O&&this.init(B$O,B$J)}B$p(B$D,"laya.ani.bone.Skeleton",B$J);var B$O=B$D.prototype;return B$O.init=function(B$O,B$J){void 0===B$J&&(B$J=0);var B$D,B$p,B$m,B$C=0,B$i=0;if(1==B$J)for(this._graphicsCache=[],B$C=0,B$i=B$O.getAnimationCount();B$C<B$i;B$C++)this._graphicsCache.push([]);if(this._yReverseMatrix=B$O.yReverseMatrix,this._aniMode=B$J,this._templet=B$O,this._player=new B$t,this._player.cacheFrameRate=B$O.rate,this._player.templet=B$O,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=B$O.mBoneArr,this._rootBone=B$O.mRootBone,this._aniSectionDic=B$O.aniSectionDic,0<B$O.ikArr.length)for(this._ikArr=[],B$C=0,B$i=B$O.ikArr.length;B$C<B$i;B$C++)this._ikArr.push(new B$v(B$O.ikArr[B$C],this._boneList));if(0<B$O.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),B$C=0,B$i=B$O.pathArr.length;B$C<B$i;B$C++)B$D=B$O.pathArr[B$C],B$p=new B$d(B$D,this._boneList),(B$m=this._boneSlotDic[B$D.name])&&((B$p=new B$d(B$D,this._boneList)).target=B$m),this._pathDic[B$D.name]=B$p;if(0<B$O.tfArr.length)for(this._tfArr=[],B$C=0,B$i=B$O.tfArr.length;B$C<B$i;B$C++)this._tfArr.push(new B$M(B$O.tfArr[B$C],this._boneList));if(0<B$O.skinDataArray.length){var B$k=this._templet.skinDataArray[this._skinIndex];this._skinName=B$k.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},B$O.load=function(B$O,B$J,B$D){},B$O._onLoaded=function(){},B$O._parseComplete=function(){var B$O=B$g.TEMPLET_DICTIONARY[this._aniPath];B$O&&(this.init(B$O,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},B$O._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},B$O._onPlay=function(){this.event("played")},B$O._onStop=function(){var B$O,B$J=this._templet.eventAniArr[this._aniClipIndex];if(B$J&&this._eventIndex<B$J.length)for(;this._eventIndex<B$J.length;this._eventIndex++)(B$O=B$J[this._eventIndex]).time>=this._player.playStart&&B$O.time<=this._player.playEnd&&this.event("label",B$O);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},B$O._onPause=function(){this.event("paused")},B$O._parseSrcBoneMatrix=function(){var B$O=0,B$J=0;for(B$J=this._templet.srcBoneMatrixArr.length,B$O=0;B$O<B$J;B$O++)this._boneMatrixArray.push(new B$EO);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var B$D,B$p,B$m=this._templet.boneSlotArray;for(B$O=0,B$J=B$m.length;B$O<B$J;B$O++)B$D=B$m[B$O],null==(B$p=this._bindBoneBoneSlotDic[B$D.parent])&&(this._bindBoneBoneSlotDic[B$D.parent]=B$p=[]),this._boneSlotDic[B$D.name]=B$D=B$D.copy(),B$p.push(B$D),this._boneSlotArray.push(B$D)}},B$O._emitMissedEvents=function(B$O,B$J,B$D){void 0===B$D&&(B$D=0);var B$p=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(B$p){var B$m,B$C,B$i=0;for(B$m=B$p.length,B$i=B$D;B$i<B$m;B$i++)(B$C=B$p[B$i]).time>=this._player.playStart&&B$C.time<=this._player.playEnd&&this.event("label",B$C)}},B$O._update=function(B$O){if(void 0===B$O&&(B$O=!0),!(this._pause||B$O&&this._indexControl)){var B$J=this.timer.currTimer,B$D=this._player.currentKeyframeIndex,B$p=B$J-this._lastTime;if(B$O?this._player._update(B$p):B$D=-1,this._lastTime=B$J,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<B$p&&this._clipIndex==B$D&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var B$m;this._lastUpdateAniClipIndex=this._aniClipIndex,B$D>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var B$C,B$i=this._templet.eventAniArr[this._aniClipIndex];if(B$i&&this._eventIndex<B$i.length&&((B$m=B$i[this._eventIndex]).time>=this._player.playStart&&B$m.time<=this._player.playEnd?this._player.currentPlayTime>=B$m.time&&(this.event("label",B$m),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(B$C=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=B$C&&(this.graphics=B$C));var B$k=0,B$_=0;for(B$_=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,B$_-1)&&0<B$_;)B$_--;if(B$_<this._clipIndex)for(B$k=B$_;B$k<this._clipIndex;B$k++)this._createGraphics(B$k)}else if(1==this._aniMode){if(B$C=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=B$C&&(this.graphics=B$C));for(B$_=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,B$_-1)&&0<B$_;)B$_--;if(B$_<this._clipIndex)for(B$k=B$_;B$k<this._clipIndex;B$k++)this._createGraphics(B$k)}this._createGraphics()}}},B$O._createGraphics=function(B$O){void 0===B$O&&(B$O=-1),-1==B$O&&(B$O=this._clipIndex);var B$J,B$D,B$p=B$O*this._player.cacheFrameRateInterval,B$m=this._templet.drawOrderAniArr[this._aniClipIndex];if(B$m&&0<B$m.length)for(this._drawOrderIndex=0,B$J=B$m[this._drawOrderIndex];B$p>=B$J.time&&(this._drawOrder=B$J.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=B$m.length));)B$J=B$m[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=B$N.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=B$N.create(),B$D=this.graphics;var B$C=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],B$O,B$p);var B$i,B$k,B$_,B$L,B$r=this._aniSectionDic[this._aniClipIndex],B$H=0,B$Y=0,B$G=0,B$X=0,B$c=0,B$h=this._templet.srcBoneMatrixArr.length;for(B$c=B$r[B$Y=0];B$Y<B$h;B$Y++)B$L=this._boneList[B$Y],B$_=this._templet.srcBoneMatrixArr[B$Y],B$L.resultTransform.scX=B$_.scX*this._curOriginalData[B$H++],B$L.resultTransform.skX=B$_.skX+this._curOriginalData[B$H++],B$L.resultTransform.skY=B$_.skY+this._curOriginalData[B$H++],B$L.resultTransform.scY=B$_.scY*this._curOriginalData[B$H++],B$L.resultTransform.x=B$_.x+this._curOriginalData[B$H++],B$L.resultTransform.y=B$_.y+this._curOriginalData[B$H++],8===this._templet.tMatrixDataLen&&(B$L.resultTransform.skewX=B$_.skewX+this._curOriginalData[B$H++],B$L.resultTransform.skewY=B$_.skewY+this._curOriginalData[B$H++]);var B$y,B$v={},B$A={};for(B$c+=B$r[1];B$Y<B$c;B$Y++)B$v[(B$y=B$C[B$Y]).name]=this._curOriginalData[B$H++],B$A[B$y.name]=this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++];var B$q,B$d,B$M={},B$a={};for(B$c+=B$r[2];B$Y<B$c;B$Y++)B$M[(B$y=B$C[B$Y]).name]=this._curOriginalData[B$H++],B$a[B$y.name]=this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++],this._curOriginalData[B$H++];if(this._pathDic)for(B$c+=B$r[3];B$Y<B$c;B$Y++){if(B$y=B$C[B$Y],B$q=this._pathDic[B$y.name])switch(new B$PO(B$y.extenData).getByte()){case 1:B$q.position=this._curOriginalData[B$H++];break;case 2:B$q.spacing=this._curOriginalData[B$H++];break;case 3:B$q.rotateMix=this._curOriginalData[B$H++],B$q.translateMix=this._curOriginalData[B$H++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(B$EO.TEMP.identity()),this._ikArr)for(B$Y=0,B$c=this._ikArr.length;B$Y<B$c;B$Y++)B$d=this._ikArr[B$Y],B$M.hasOwnProperty(B$d.name)&&(B$d.bendDirection=B$M[B$d.name]),B$a.hasOwnProperty(B$d.name)&&(B$d.mix=B$a[B$d.name]),B$d.apply();if(this._pathDic)for(var B$e in this._pathDic)(B$q=this._pathDic[B$e]).apply(this._boneList,B$D);if(this._tfArr)for(B$Y=0,B$X=this._tfArr.length;B$Y<B$X;B$Y++)this._tfArr[B$Y].apply();for(B$Y=0,B$X=this._boneList.length;B$Y<B$X;B$Y++)if(B$L=this._boneList[B$Y],B$k=this._bindBoneBoneSlotDic[B$L.name],B$L.resultMatrix.copyTo(this._boneMatrixArray[B$Y]),B$k)for(B$G=0,B$c=B$k.length;B$G<B$c;B$G++)(B$i=B$k[B$G])&&B$i.setParentMatrix(B$L.resultMatrix);var B$t,B$z,B$g,B$s,B$P={},B$E=this._templet.deformAniArr;if(B$E&&0<B$E.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,B$Y=0,B$c=this._boneSlotArray.length;B$Y<B$c;B$Y++)(B$i=this._boneSlotArray[B$Y]).deformData=null;var B$o,B$W=B$E[this._aniClipIndex];for(B$o in B$t=B$W.default,this._setDeform(B$t,B$P,this._boneSlotArray,B$p),B$W)"default"!=B$o&&B$o!=this._skinName&&(B$t=B$W[B$o],this._setDeform(B$t,B$P,this._boneSlotArray,B$p));B$t=B$W[this._skinName],this._setDeform(B$t,B$P,this._boneSlotArray,B$p)}if(this._drawOrder)for(B$Y=0,B$c=this._drawOrder.length;B$Y<B$c;B$Y++)B$z=B$v[(B$i=this._boneSlotArray[this._drawOrder[B$Y]]).name],B$g=B$A[B$i.name],isNaN(B$g)||(B$D.save(),B$D.alpha(B$g)),isNaN(B$z)||-2==B$z||(this._templet.attachmentNames?B$i.showDisplayByName(this._templet.attachmentNames[B$z]):B$i.showDisplayByIndex(B$z)),B$P[this._drawOrder[B$Y]]?(B$s=B$P[this._drawOrder[B$Y]],B$i.currDisplayData&&B$s[B$i.currDisplayData.attachmentName]?B$i.deformData=B$s[B$i.currDisplayData.attachmentName]:B$i.deformData=null):B$i.deformData=null,isNaN(B$g)?B$i.draw(B$D,this._boneMatrixArray,2==this._aniMode):B$i.draw(B$D,this._boneMatrixArray,2==this._aniMode,B$g),isNaN(B$g)||B$D.restore();else for(B$Y=0,B$c=this._boneSlotArray.length;B$Y<B$c;B$Y++)B$z=B$v[(B$i=this._boneSlotArray[B$Y]).name],B$g=B$A[B$i.name],isNaN(B$g)||(B$D.save(),B$D.alpha(B$g)),isNaN(B$z)||-2==B$z||(this._templet.attachmentNames?B$i.showDisplayByName(this._templet.attachmentNames[B$z]):B$i.showDisplayByIndex(B$z)),B$P[B$Y]?(B$s=B$P[B$Y],B$i.currDisplayData&&B$s[B$i.currDisplayData.attachmentName]?B$i.deformData=B$s[B$i.currDisplayData.attachmentName]:B$i.deformData=null):B$i.deformData=null,isNaN(B$g)?B$i.draw(B$D,this._boneMatrixArray,2==this._aniMode):B$i.draw(B$D,this._boneMatrixArray,2==this._aniMode,B$g),isNaN(B$g)||B$D.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,B$O,B$D):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,B$O,B$D)},B$O._setDeform=function(B$O,B$J,B$D,B$p){if(B$O){var B$m,B$C,B$i,B$k=0,B$_=0,B$L=0;if(B$O)for(B$k=0,B$_=B$O.deformSlotDataList.length;B$k<B$_;B$k++)for(B$m=B$O.deformSlotDataList[B$k],B$L=0;B$L<B$m.deformSlotDisplayList.length;B$L++)B$i=B$D[(B$C=B$m.deformSlotDisplayList[B$L]).slotIndex],B$C.apply(B$p,B$i),B$J[B$C.slotIndex]||(B$J[B$C.slotIndex]={}),B$J[B$C.slotIndex][B$C.attachment]=B$C.deformData}},B$O.getAnimNum=function(){return this._templet.getAnimationCount()},B$O.getAniNameByIndex=function(B$O){return this._templet.getAniNameByIndex(B$O)},B$O.getSlotByName=function(B$O){return this._boneSlotDic[B$O]},B$O.showSkinByName=function(B$O,B$J){void 0===B$J&&(B$J=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(B$O),B$J)},B$O.showSkinByIndex=function(B$O,B$J){void 0===B$J&&(B$J=!0);for(var B$D=0;B$D<this._boneSlotArray.length;B$D++)this._boneSlotArray[B$D].showSlotData(null,B$J);if(this._templet.showSkinByIndex(this._boneSlotDic,B$O,B$J)){var B$p=this._templet.skinDataArray[B$O];this._skinIndex=B$O,this._skinName=B$p.name}this._clearCache()},B$O.showSlotSkinByIndex=function(B$O,B$J){if(0!=this._aniMode){var B$D=this.getSlotByName(B$O);B$D&&B$D.showDisplayByIndex(B$J),this._clearCache()}},B$O.showSlotSkinByName=function(B$O,B$J){if(0!=this._aniMode){var B$D=this.getSlotByName(B$O);B$D&&B$D.showDisplayByName(B$J),this._clearCache()}},B$O.replaceSlotSkinName=function(B$O,B$J,B$D){if(0!=this._aniMode){var B$p=this.getSlotByName(B$O);B$p&&B$p.replaceDisplayByName(B$J,B$D),this._clearCache()}},B$O.replaceSlotSkinByIndex=function(B$O,B$J,B$D){if(0!=this._aniMode){var B$p=this.getSlotByName(B$O);B$p&&B$p.replaceDisplayByIndex(B$J,B$D),this._clearCache()}},B$O.setSlotSkin=function(B$O,B$J){if(0!=this._aniMode){var B$D=this.getSlotByName(B$O);B$D&&B$D.replaceSkin(B$J),this._clearCache()}},B$O._clearCache=function(){if(1==this._aniMode)for(var B$O=0,B$J=this._graphicsCache.length;B$O<B$J;B$O++){for(var B$D=0,B$p=this._graphicsCache[B$O].length;B$D<B$p;B$D++){var B$m=this._graphicsCache[B$O][B$D];B$m!=this.graphics&&B$N.recycle(B$m)}this._graphicsCache[B$O].length=0}},B$O.play=function(B$O,B$J,B$D,B$p,B$m,B$C){void 0===B$D&&(B$D=!0),void 0===B$p&&(B$p=0),void 0===B$m&&(B$m=0),void 0===B$C&&(B$C=!0),this._indexControl=!1;var B$i=-1,B$k=NaN;if(B$k=B$J?2147483647:0,"string"==typeof B$O)for(var B$_=0,B$L=this._templet.getAnimationCount();B$_<B$L;B$_++){var B$r=this._templet.getAnimation(B$_);if(B$r&&B$O==B$r.name){B$i=B$_;break}}else B$i=B$O;-1<B$i&&B$i<this.getAnimNum()&&(this._aniClipIndex=B$i,(B$D||this._pause||this._currAniIndex!=B$i)&&(this._currAniIndex=B$i,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(B$i)),this._drawOrder=null,this._eventIndex=0,this._player.play(B$i,this._player.playbackRate,B$k,B$p,B$m),B$C&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=B$H.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},B$O.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},B$O.playbackRate=function(B$O){this._player&&(this._player.playbackRate=B$O)},B$O.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},B$O.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=B$H.now(),this.timer.frameLoop(1,this,this._update,null,!0))},B$O._getGrahicsDataWithCache=function(B$O,B$J){return this._graphicsCache[B$O][B$J]},B$O._setGrahicsDataWithCache=function(B$O,B$J,B$D){this._graphicsCache[B$O][B$J]=B$D},B$O.destroy=function(B$O){void 0===B$O&&(B$O=!0),B$J.prototype.destroy.call(this,B$O),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},B$C(0,B$O,"url",function(){return this._aniPath},function(B$O){this.load(B$O)}),B$C(0,B$O,"index",function(){return this._index},function(B$O){this.player&&(this._index=B$O,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),B$C(0,B$O,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),B$C(0,B$O,"templet",function(){return this._templet}),B$C(0,B$O,"player",function(){return this._player}),B$D.useSimpleMeshInCanvas=!1,B$D}(B$CO),B$g=function(B$J){function B$m(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,B$m.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}B$p(B$m,"laya.ani.bone.Templet",B$J);var B$O=B$m.prototype;return B$O.getLoadList=function(){return this._loadList},B$O.loadAni=function(B$O){this._skBufferUrl=B$O,B$mO.loader.load(B$O,B$_.create(this,this.onComplete),null,"arraybuffer")},B$O.onComplete=function(B$O){if(this._isDestroyed)this.destroy();else{var B$J=B$L.getRes(this._skBufferUrl);B$J?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,B$J)):this.event("error","load failed:"+this._skBufferUrl)}},B$O.parseData=function(B$O,B$J,B$D){void 0===B$D&&(B$D=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=B$O,this._mainTexture&&B$h.isWebGL&&B$O.bitmap&&(B$O.bitmap.enableMerageInAtlas=!1),this._rate=B$D,this.parse(B$J)},B$O.buildArmature=function(B$O){return void 0===B$O&&(B$O=0),new B$z(this,B$O)},B$O.parse=function(B$O){B$J.prototype.parse.call(this,B$O),this._endLoaded(),this._aniVersion!=B$m.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+B$m.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},B$O._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var B$O=0;this._loadList=[];var B$J,B$D=new B$PO(this.getPublicExtData()),B$p=0,B$m=0,B$C=0,B$i=B$D.getInt32(),B$k=B$D.readUTFString(),B$_=B$k.split("\n");for(B$O=0;B$O<B$i;B$O++)B$J=this._path+B$_[2*B$O],B$k=B$_[2*B$O+1],B$D.getFloat32(),B$D.getFloat32(),B$p=B$D.getFloat32(),B$m=B$D.getFloat32(),B$C=B$D.getFloat32(),isNaN(B$C)?0:B$C,B$C=B$D.getFloat32(),isNaN(B$C)?0:B$C,B$C=B$D.getFloat32(),isNaN(B$C)?B$p:B$C,B$C=B$D.getFloat32(),isNaN(B$C)?B$m:B$C,-1==this._loadList.indexOf(B$J)&&this._loadList.push(B$J);this.event("inited",this)}},B$O._textureComplete=function(){for(var B$O,B$J,B$D=0,B$p=this._loadList.length;B$D<B$p;B$D++)B$J=this._loadList[B$D],B$O=this._textureDic[B$J]=B$L.getRes(B$J),B$h.isWebGL&&B$O&&B$O.bitmap&&(B$O.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},B$O._parsePublicExtData=function(){var B$O=0,B$J=0,B$D=0,B$p=0,B$m=0;for(B$O=0,B$m=this.getAnimationCount();B$O<B$m;B$O++)this._graphicsCache.push([]);var B$C;B$C="Dragon"!=this._aniClassName;var B$i,B$k,B$_=new B$PO(this.getPublicExtData()),B$L=0,B$r=0,B$H=0,B$Y=0,B$G=0,B$X=0,B$c=0,B$h=0,B$y=0,B$v=B$_.getInt32(),B$A=B$_.readUTFString(),B$q=B$A.split("\n");for(B$O=0;B$O<B$v;B$O++){if(B$i=this._mainTexture,B$k=this._path+B$q[2*B$O],B$A=B$q[2*B$O+1],null==this._mainTexture&&(B$i=this._textureDic[B$k]),!B$i)return this.event("error",this),void(this.isParseFail=!0);B$L=B$_.getFloat32(),B$r=B$_.getFloat32(),B$H=B$_.getFloat32(),B$Y=B$_.getFloat32(),B$y=B$_.getFloat32(),B$G=isNaN(B$y)?0:B$y,B$y=B$_.getFloat32(),B$X=isNaN(B$y)?0:B$y,B$y=B$_.getFloat32(),B$c=isNaN(B$y)?B$H:B$y,B$y=B$_.getFloat32(),B$h=isNaN(B$y)?B$Y:B$y,this.subTextureDic[B$A]=B$oO.create(B$i,B$L,B$r,B$H,B$Y,-B$G,-B$X,B$c,B$h),B$i.alphaTexture&&(this.subTextureDic[B$A].alphaTexture=B$oO.create(B$i.alphaTexture,B$L,B$r,B$H,B$Y,-B$G,-B$X,B$c,B$h))}this._mainTexture=B$i;var B$d,B$M,B$a,B$e,B$t,B$z=B$_.getUint16();for(B$O=0;B$O<B$z;B$O++)(B$d=[]).push(B$_.getUint16()),B$d.push(B$_.getUint16()),B$d.push(B$_.getUint16()),B$d.push(B$_.getUint16()),this.aniSectionDic[B$O]=B$d;var B$g,B$s=B$_.getInt16(),B$P={};for(B$O=0;B$O<B$s;B$O++)B$M=new B$WO,0==B$O?B$g=B$M:B$M.root=B$g,B$M.d=B$C?-1:1,B$e=B$_.readUTFString(),B$t=B$_.readUTFString(),B$M.length=B$_.getFloat32(),1==B$_.getByte()&&(B$M.inheritRotation=!1),1==B$_.getByte()&&(B$M.inheritScale=!1),B$M.name=B$e,B$t&&((B$a=B$P[B$t])?B$a.addChild(B$M):this.mRootBone=B$M),B$P[B$e]=B$M,this.mBoneArr.push(B$M);this.tMatrixDataLen=B$_.getUint16();var B$E,B$o,B$W=B$_.getUint16(),B$N=Math.floor(B$W/this.tMatrixDataLen),B$F=this.srcBoneMatrixArr;for(B$O=0;B$O<B$N;B$O++)(B$E=new B$UO).scX=B$_.getFloat32(),B$E.skX=B$_.getFloat32(),B$E.skY=B$_.getFloat32(),B$E.scY=B$_.getFloat32(),B$E.x=B$_.getFloat32(),B$E.y=B$_.getFloat32(),8===this.tMatrixDataLen&&(B$E.skewX=B$_.getFloat32(),B$E.skewY=B$_.getFloat32()),B$F.push(B$E),(B$M=this.mBoneArr[B$O]).transform=B$E;var B$R,B$j=B$_.getUint16(),B$u=0;for(B$O=0;B$O<B$j;B$O++){for(B$o=new B$$O,B$u=B$_.getUint16(),B$J=0;B$J<B$u;B$J++)B$o.boneNames.push(B$_.readUTFString()),B$o.boneIndexs.push(B$_.getInt16());B$o.name=B$_.readUTFString(),B$o.targetBoneName=B$_.readUTFString(),B$o.targetBoneIndex=B$_.getInt16(),B$o.bendDirection=B$_.getFloat32(),B$o.mix=B$_.getFloat32(),B$o.isSpine=B$C,this.ikArr.push(B$o)}var B$l,B$$=B$_.getUint16(),B$x=0;for(B$O=0;B$O<B$$;B$O++){for(B$R=new B$wO,B$x=B$_.getUint16(),B$J=0;B$J<B$x;B$J++)B$R.boneIndexs.push(B$_.getInt16());B$R.name=B$_.getUTFString(),B$R.targetIndex=B$_.getInt16(),B$R.rotateMix=B$_.getFloat32(),B$R.translateMix=B$_.getFloat32(),B$R.scaleMix=B$_.getFloat32(),B$R.shearMix=B$_.getFloat32(),B$R.offsetRotation=B$_.getFloat32(),B$R.offsetX=B$_.getFloat32(),B$R.offsetY=B$_.getFloat32(),B$R.offsetScaleX=B$_.getFloat32(),B$R.offsetScaleY=B$_.getFloat32(),B$R.offsetShearY=B$_.getFloat32(),this.tfArr.push(B$R)}var B$V=B$_.getUint16(),B$T=0;for(B$O=0;B$O<B$V;B$O++){for((B$l=new B$xO).name=B$_.readUTFString(),B$T=B$_.getUint16(),B$J=0;B$J<B$T;B$J++)B$l.bones.push(B$_.getInt16());B$l.target=B$_.readUTFString(),B$l.positionMode=B$_.readUTFString(),B$l.spacingMode=B$_.readUTFString(),B$l.rotateMode=B$_.readUTFString(),B$l.offsetRotation=B$_.getFloat32(),B$l.position=B$_.getFloat32(),B$l.spacing=B$_.getFloat32(),B$l.rotateMix=B$_.getFloat32(),B$l.translateMix=B$_.getFloat32(),this.pathArr.push(B$l)}var B$I,B$w,B$U,B$Z,B$n,B$B=0,B$S=0,B$Q=0,B$b=NaN,B$K=0,B$f=B$_.getInt16();for(B$O=0;B$O<B$f;B$O++){var B$OO=B$_.getUint8(),B$JO={};this.deformAniArr.push(B$JO);for(var B$DO=0;B$DO<B$OO;B$DO++)for((B$I=new B$FO).skinName=B$_.getUTFString(),B$JO[B$I.skinName]=B$I,B$B=B$_.getInt16(),B$J=0;B$J<B$B;B$J++)for(B$w=new B$RO,B$I.deformSlotDataList.push(B$w),B$S=B$_.getInt16(),B$D=0;B$D<B$S;B$D++)for(B$U=new B$jO,B$w.deformSlotDisplayList.push(B$U),B$U.slotIndex=B$_.getInt16(),B$U.attachment=B$_.getUTFString(),B$Q=B$_.getInt16(),B$p=0;B$p<B$Q;B$p++)for(1==B$_.getByte()?B$U.tweenKeyList.push(!0):B$U.tweenKeyList.push(!1),B$b=B$_.getFloat32(),B$U.timeList.push(B$b),B$Z=[],B$U.vectices.push(B$Z),B$K=B$_.getInt16(),B$m=0;B$m<B$K;B$m++)B$Z.push(B$_.getFloat32())}var B$pO,B$mO,B$CO=B$_.getInt16(),B$iO=0,B$kO=0;for(B$O=0;B$O<B$CO;B$O++){for(B$iO=B$_.getInt16(),B$n=[],B$J=0;B$J<B$iO;B$J++){for((B$pO=new B$uO).time=B$_.getFloat32(),B$kO=B$_.getInt16(),B$D=0;B$D<B$kO;B$D++)B$pO.drawOrder.push(B$_.getInt16());B$n.push(B$pO)}this.drawOrderAniArr.push(B$n)}var B$_O,B$LO=B$_.getInt16(),B$rO=0;for(B$O=0;B$O<B$LO;B$O++){for(B$rO=B$_.getInt16(),B$mO=[],B$J=0;B$J<B$rO;B$J++)(B$_O=new B$lO).name=B$_.getUTFString(),B$_O.intValue=B$_.getInt32(),B$_O.floatValue=B$_.getFloat32(),B$_O.stringValue=B$_.getUTFString(),B$_O.time=B$_.getFloat32(),B$mO.push(B$_O);this.eventAniArr.push(B$mO)}var B$HO=B$_.getInt16();if(0<B$HO)for(this.attachmentNames=[],B$O=0;B$O<B$HO;B$O++)this.attachmentNames.push(B$_.getUTFString());var B$YO,B$GO,B$XO=B$_.getInt16();for(B$O=0;B$O<B$XO;B$O++)(B$YO=new B$NO).name=B$_.readUTFString(),B$YO.parent=B$_.readUTFString(),B$YO.attachmentName=B$_.readUTFString(),B$YO.srcDisplayIndex=B$YO.displayIndex=B$_.getInt16(),(B$YO.templet=this).boneSlotDic[B$YO.name]=B$YO,null==(B$GO=this.bindBoneBoneSlotDic[B$YO.parent])&&(this.bindBoneBoneSlotDic[B$YO.parent]=B$GO=[]),B$GO.push(B$YO),this.boneSlotArray.push(B$YO);var B$cO,B$hO,B$yO,B$vO=B$_.readUTFString().split("\n"),B$AO=0,B$qO=B$_.getUint8(),B$dO=0,B$MO=0,B$aO=0,B$eO=0,B$tO=0,B$zO=0,B$gO=0;for(B$O=0;B$O<B$qO;B$O++){for((B$cO=new B$VO).name=B$vO[B$AO++],B$dO=B$_.getUint8(),B$J=0;B$J<B$dO;B$J++){for((B$hO=new B$IO).name=B$vO[B$AO++],B$YO=this.boneSlotDic[B$hO.name],B$MO=B$_.getUint8(),B$D=0;B$D<B$MO;B$D++){if(B$yO=new B$TO,this.skinSlotDisplayDataArr.push(B$yO),B$yO.name=B$vO[B$AO++],B$yO.attachmentName=B$vO[B$AO++],B$yO.transform=new B$UO,B$yO.transform.scX=B$_.getFloat32(),B$yO.transform.skX=B$_.getFloat32(),B$yO.transform.skY=B$_.getFloat32(),B$yO.transform.scY=B$_.getFloat32(),B$yO.transform.x=B$_.getFloat32(),B$yO.transform.y=B$_.getFloat32(),B$hO.displayArr.push(B$yO),B$yO.width=B$_.getFloat32(),B$yO.height=B$_.getFloat32(),B$yO.type=B$_.getUint8(),B$yO.verLen=B$_.getUint16(),0<(B$s=B$_.getUint16()))for(B$yO.bones=[],B$p=0;B$p<B$s;B$p++){var B$sO=B$_.getUint16();B$yO.bones.push(B$sO)}if(0<(B$aO=B$_.getUint16()))for(B$yO.uvs=[],B$p=0;B$p<B$aO;B$p++)B$yO.uvs.push(B$_.getFloat32());if(0<(B$eO=B$_.getUint16()))for(B$yO.weights=[],B$p=0;B$p<B$eO;B$p++)B$yO.weights.push(B$_.getFloat32());if(0<(B$tO=B$_.getUint16()))for(B$yO.triangles=[],B$p=0;B$p<B$tO;B$p++)B$yO.triangles.push(B$_.getUint16());if(0<(B$zO=B$_.getUint16()))for(B$yO.vertices=[],B$p=0;B$p<B$zO;B$p++)B$yO.vertices.push(B$_.getFloat32());if(0<(B$gO=B$_.getUint16()))for(B$yO.lengths=[],B$p=0;B$p<B$gO;B$p++)B$yO.lengths.push(B$_.getFloat32())}B$cO.slotArr.push(B$hO)}this.skinDic[B$cO.name]=B$cO,this.skinDataArray.push(B$cO)}1==B$_.getUint8()?(this.yReverseMatrix=new B$EO(1,0,0,-1,0,0),B$g&&B$g.setTempMatrix(this.yReverseMatrix)):B$g&&B$g.setTempMatrix(new B$EO),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},B$O.getTexture=function(B$O){var B$J=this.subTextureDic[B$O];return B$J||(B$J=this.subTextureDic[B$O.substr(0,B$O.length-1)]),null==B$J?this._mainTexture:B$J},B$O.showSkinByIndex=function(B$O,B$J,B$D){if(void 0===B$D&&(B$D=!0),B$J<0&&B$J>=this.skinDataArray.length)return!1;var B$p,B$m,B$C=0,B$i=0,B$k=this.skinDataArray[B$J];if(B$k){for(B$C=0,B$i=B$k.slotArr.length;B$C<B$i;B$C++)(B$m=B$k.slotArr[B$C])&&(B$p=B$O[B$m.name])&&(B$p.showSlotData(B$m,B$D),B$D&&"undefined"!=B$p.attachmentName&&"null"!=B$p.attachmentName?B$p.showDisplayByName(B$p.attachmentName):B$p.showDisplayByIndex(B$p.displayIndex));return!0}return!1},B$O.getSkinIndexByName=function(B$O){for(var B$J=0,B$D=this.skinDataArray.length;B$J<B$D;B$J++)if(this.skinDataArray[B$J].name==B$O)return B$J;return-1},B$O.getGrahicsDataWithCache=function(B$O,B$J){return this._graphicsCache[B$O][B$J]},B$O.setGrahicsDataWithCache=function(B$O,B$J,B$D){this._graphicsCache[B$O][B$J]=B$D},B$O.destroy=function(){var B$O;for(var B$J in this._isDestroyed=!0,this.subTextureDic)(B$O=this.subTextureDic[B$J])&&B$O.destroy();for(B$J in this._textureDic)(B$O=this._textureDic[B$J])&&B$O.destroy();for(var B$D=0,B$p=this.skinSlotDisplayDataArr.length;B$D<B$p;B$D++)this.skinSlotDisplayDataArr[B$D].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete B$m.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},B$O.getAniNameByIndex=function(B$O){var B$J=this.getAnimation(B$O);return B$J?B$J.name:null},B$C(0,B$O,"rate",function(){return this._rate},function(B$O){this._rate=B$O}),B$m.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",B$m.TEMPLET_DICTIONARY=null,B$m}(B$F)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(B$O,B$J){"use strict";for(var B$D in Object.defineProperty(B$J,"__esModule",{value:!0}),Laya){var B$p=Laya[B$D];B$p&&B$p.__isclass&&(B$J[B$D]=B$p)}});