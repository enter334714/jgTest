var Laya=window.Laya=function($I,$d){var $b={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($d,$t){return 1==arguments.length?$b.__presubstr.call(this,$d):$b.__presubstr.call(this,$d,0<$t?$t:this.length+$t);},__init:function($d){$d.forEach(function($d){$d.__init$&&$d.__init$();});},__isClass:function($d){return $d&&($d.__isclass||$d==Object||$d==String||$d==Array);},__newvec:function($d,$t){var $l=[];$l.length=$d;for(var $k=0;$k<$d;$k++)$l[$k]=$t;return $l;},__extend:function($d,$t){for(var $l in $t)if($t.hasOwnProperty($l)){var $k=Object.getOwnPropertyDescriptor($t,$l),$W=$k.get,$i=$k.set;$W||$i?$W&&$i?Object.defineProperty($d,$l,$k):($W&&Object.defineProperty($d,$l,$W),$i&&Object.defineProperty($d,$l,$i)):$d[$l]=$t[$l];}function $A(){$b.un(this,"constructor",$d);}$A.prototype=$t.prototype,$d.prototype=new $A(),$b.un($d.prototype,"__imps",$b.__copy({},$t.prototype.__imps));},__copy:function($d,$t){if(!$t)return null;for(var $l in $d=$d||{},$t)$d[$l]=$t[$l];return $d;},__package:function($d,$t){if(!$b.__packages[$d]){$b.__packages[$d]=!0;var $l=$I,$k=$d.split(".");if(1<$k.length)for(var $W=0,$i=$k.length-1;$W<$i;$W++){var $A=$l[$k[$W]];$l=$A||($l[$k[$W]]={});}$l[$k[$k.length-1]]||($l[$k[$k.length-1]]=$t||{});}},__hasOwnProperty:function($d,$t){return $t=$t||this,Object.hasOwnProperty.call($t,$d)||function $d($t,$l){if(Object.hasOwnProperty.call($l.prototype,$t))return!0;var $k=$l.prototype.__super;return null==$k?null:$d($t,$k);}($d,$t.__class);},__typeof:function($d,$t){if(!$d||!$t)return!1;if($t===String)return"string"==typeof $d;if($t===Number)return"number"==typeof $d;if($t.__interface__)$t=$t.__interface__;else if("string"!=typeof $t)return $d instanceof $t;return $d.__imps&&$d.__imps[$t]||$d.__class==$t;},__as:function($d,$t){return this.__typeof($d,$t)?$d:null;},__int:function($d){return $d?parseInt($d):0;},interface:function($d,$t){$b.__package($d,{});var $l=$b.__internals,$k=$l[$d]=$l[$d]||{self:$d};if($t){var $W=$t.split(",");$k.extend=[];for(var $i=0;$i<$W.length;$i++){var $A=$W[$i];$l[$A]=$l[$A]||{self:$A},$k.extend.push($l[$A]);}}var $B=$I,$o=$d.split(".");for($i=0;$i<$o.length-1;$i++)$B=$B[$o[$i]];$B[$o[$o.length-1]]={__interface__:$d};},class:function($d,$t,$l,$k){if($l&&$b.__extend($d,$l),$t)if($b.__package($t,$d),$b.__classmap[$t]=$d,0<$t.indexOf(".")){if(0==$t.indexOf("laya.")){var $W=$t.split(".");$k=$k||$W[$W.length-1],$b[$k]&&console.log("Warning!,this class["+$k+"] already exist:",$b[$k]),$b[$k]=$d;}}else"Main"==$t?$I.Main=$d:"MainWX"==$t?$I.MainWX=$d:($b[$t]&&console.log("Error!,this class["+$t+"] already exist:",$b[$t]),$b[$t]=$d);var $i=$b.un,$A=$d.prototype;$i($A,"hasOwnProperty",$b.__hasOwnProperty),$i($A,"__class",$d),$i($A,"__super",$l),$i($A,"__className",$t),$i($d,"__super",$l),$i($d,"__className",$t),$i($d,"__isclass",!0),$i($d,"super",function($d){this.__super.call($d);});},imps:function($d,$t){if(!$t)return null;var $W=$d.__imps||$b.un($d,"__imps",{});function $i($d){var $t,$l;if(($t=$b.__internals[$d])&&($W[$d]=!0,$l=$t.extend))for(var $k=0;$k<$l.length;$k++)$i($l[$k].self);}for(var $l in $t)$i($l);},superSet:function($d,$t,$l,$k){var $W=$d.prototype["_$set_"+$l];$W&&$W.call($t,$k);},superGet:function($d,$t,$l){var $k=$d.prototype["_$get_"+$l];return $k?$k.call($t):null;},getset:function($d,$t,$l,$k,$W){$d?($k&&($t["_$GET_"+$l]=$k),$W&&($t["_$SET_"+$l]=$W)):($k&&$b.un($t,"_$get_"+$l,$k),$W&&$b.un($t,"_$set_"+$l,$W)),$k&&$W?Object.defineProperty($t,$l,{get:$k,set:$W,enumerable:!1,configurable:!0}):($k&&Object.defineProperty($t,$l,{get:$k,enumerable:!1,configurable:!0}),$W&&Object.defineProperty($t,$l,{set:$W,enumerable:!1,configurable:!0}));},static:function($l,$k){for(var $W=0,$d=$k.length;$W<$d;$W+=2)if("length"==$k[$W])$l.length=$k[$W+1].call($l);else{function $t(){var $t=$k[$W],$d=$k[$W+1];Object.defineProperty($l,$t,{get:function(){return delete this[$t],this[$t]=$d.call(this);},set:function($d){delete this[$t],this[$t]=$d;},enumerable:!0,configurable:!0});}$t();}},un:function($d,$t,$l){return $l||($l=$d[$t]),$b.__propun.value=$l,Object.defineProperty($d,$t,$b.__propun),$l;},uns:function($t,$d){$d.forEach(function($d){$b.un($t,$d);});}};return $I.console=$I.console||{log:function(){}},$I.trace=$I.console.log,Error.prototype.throwError=function(){throw arguments;},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$b;}(window,document);!function($d,$t,$l){$l.un,$l.uns,$l.static,$l.class,$l.getset,$l.__newvec;}(window,document,Laya),function($A,$t,$q){$q.un,$q.uns;var $o=$q.static,$w=$q.class,$b=$q.getset;$q.__newvec;$q.interface("laya.runtime.IMarket"),$q.interface("laya.filters.IFilter"),$q.interface("laya.display.ILayout"),$q.interface("laya.resource.IDispose"),$q.interface("laya.runtime.IPlatform"),$q.interface("laya.resource.IDestroy"),$q.interface("laya.runtime.IConchNode"),$q.interface("laya.filters.IFilterAction"),$q.interface("laya.runtime.ICPlatformClass"),$q.interface("laya.resource.ICreateResource"),$q.interface("laya.runtime.IConchRenderObject"),$q.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $r=function(){function $i(){}return $w($i,"laya.utils.RunDriver"),$i.FILTER_ACTIONS=[],$i.pixelRatio=-1,$i._charSizeTestDiv=null,$i.now=function(){return Date.now();},$i.getWindow=function(){return $A;},$i.getPixelRatio=function(){if($i.pixelRatio<0){var $d=$V.context,$t=$d.backingStorePixelRatio||$d.webkitBackingStorePixelRatio||$d.mozBackingStorePixelRatio||$d.msBackingStorePixelRatio||$d.oBackingStorePixelRatio||$d.backingStorePixelRatio||1;($i.pixelRatio=($V.window.devicePixelRatio||1)/$t)<1&&($i.pixelRatio=1);}return $i.pixelRatio;},$i.getIncludeStr=function($d){return null;},$i.createShaderCondition=function($d){var $t="(function() {return "+$d+";})";return $q._runScript($t);},$i.fontMap=[],$i.measureText=function($d,$t){var $l=$i.hanzi.test($d);if($l&&$i.fontMap[$t])return $i.fontMap[$t];var $k=$V.context;$k.font=$t;var $W=$k.measureText($d);return $W||($W={width:16,height:16}),$l&&($i.fontMap[$t]=$W),$W;},$i.getWebGLContext=function($d){},$i.beginFlush=function(){},$i.endFinish=function(){},$i.addToAtlas=null,$i.flashFlushImage=function($d){},$i.drawToCanvas=function($d,$t,$l,$k,$W,$i){var $A=$gd.create("2D"),$B=new $x($l,$k,$A);return $n.renders[$t]._fun($d,$B,$W,$i),$A;},$i.createParticleTemplate2D=null,$i.createGLTextur=null,$i.createWebGLContext2D=null,$i.changeWebGLSize=function($d,$t){},$i.createRenderSprite=function($d,$t){return new $n($d,$t);},$i.createFilterAction=function($d){return new $g();},$i.createGraphics=function(){return new $J();},$i.clear=function($d){$K._context.ctx.clear();},$i.cancelLoadByUrl=function($d){},$i.clearAtlas=function($d){},$i.isAtlas=function($d){return!1;},$i.addTextureToAtlas=function($d){},$i.getTexturePixels=function($d,$t,$l,$k,$W){return null;},$i.skinAniSprite=function(){return null;},$i.update3DLoop=function(){},$o($i,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$");}]),$i;}(),$k=($b(1,$q,"alertGlobalError",null,function($d){var $i=0;$V.window.onerror=$d?function($d,$t,$l,$k,$W){$i++<5&&$W&&alert($W.stack||$W);}:null;}),$q.init=function($d,$t,$l){for(var $k=[],$W=2,$i=arguments.length;$W<$i;$W++)$k.push(arguments[$W]);if(!$q._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$q._arrayBufferSlice),$q._isinit=!0,$V.__init__(),$Q.__init__(),$J.__init__(),$q.timer=new $m(),$q.scaleTimer=new $m(),$q.loader=new $od(),$_.__init__(),$W=0;for(var $A=$k.length;$W<$A;$W++)$k[$W].enable&&$k[$W].enable();return $c.__init__(),$B.__init__(),$y.__init__(),$U.beginCheck(),$q._currentStage=$q.stage=new $zd(),$q.stage.conchModel&&$q.stage.conchModel.setRootNode(),$q._getUrlPath(),$q.render=new $K(0,0),$q.stage.size($d,$t),$n.__init__(),$f.__init__(),$Y.instance.__init__($q.stage,$K.canvas),$Rd.__init__(),$T.autoStopMusic=!0,$p.__init__(),$K.canvas;}},$q._getUrlPath=function(){var $d=$V.window.location,$t=$d.pathname;$t=$t&&":"==$t.charAt(2)?$t.substring(1):$t,$C.rootPath=$C.basePath=$C.getPath("file:"==$d.protocol?$t:$d.protocol+"//"+$d.host+$d.pathname);},$q._arrayBufferSlice=function($d,$t){var $l=new Uint8Array(this,$d,$t-$d),$k=new Uint8Array($l.length);return $k.set($l),$k.buffer;},$q._runScript=function($d){return $V.window[$q._evcode]($d);},$q.stage=null,$q.timer=null,$q.scaleTimer=null,$q.loader=null,$q.version="1.8.6",$q.render=null,$q._currentStage=null,$q._isinit=!1,$q.isDebug=!1,$q.MiniAdpter={init:function(){$A.navigator&&$A.navigator.userAgent&&-1<$A.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0");}},$o($q,["conchMarket",function(){return this.conchMarket=$A.conch?conchMarket:null;},"PlatformClass",function(){return this.PlatformClass=$A.PlatformClass;},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al";}]),function(){function $d(){}return $w($d,"Config"),$d.WebGLTextCacheCount=500,$d.atlasEnable=!1,$d.showCanvasMark=!1,$d.animationInterval=50,$d.isAntialias=!1,$d.isAlpha=!1,$d.premultipliedAlpha=!0,$d.isStencil=!0,$d.preserveDrawingBuffer=!1,$d;}()),$I=function(){function $I(){this._events=null;}$w($I,"laya.events.EventDispatcher");var $d=$I.prototype;return $d.hasListener=function($d){return!!(this._events&&this._events[$d]);},$d.getListener=function($d){return this._events?this._events[$d]:null;},$d.event=function($d,$t){if(!this._events||!this._events[$d])return!1;var $l=this._events[$d];if($l.lock)$l.queue||($l.queue=[]),$l.queue.push($t);else{var $k;for($l.lock=!0,$l.cursor=$l.head;$l.cursor;)($k=$l.cursor).recover?($l.head=$l.tail=$l.cursor=null,console.error("node is recover："+$k.id)):($l.cursor=$k.next,$k.once&&$I.delNode($l,$k),$k.method&&(null!=$t?$k.args?$k.method.apply($k.caller,$k.args.concat($t)):$t instanceof Array?$k.method.apply($k.caller,$t):$k.caller?$k.method.call($k.caller,$t):$q.recordError("事件派发错误","node.caller:"+$k.caller+"node.method:"+$k.method+"data:"+$t+"node.prev"+$k.prev):$k.method.apply($k.caller,$k.args)),$k.once&&$I.recoverHandler($k));$l.lock=!1,!$l.head&&this._events&&this._events[$d]==$l&&delete this._events[$d],$l.queue&&$l.queue.length&&this.event($d,$l.queue.shift());}return!0;},$d.on=function($d,$t,$l,$k){return this._createListener($d,$t,$l,$k,!1);},$d.once=function($d,$t,$l,$k){return this._createListener($d,$t,$l,$k,!0);},$d._createListener=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=!0),$i&&this.off($d,$t,$l,$W);var $A=$I.createHandler($t||this,$l,$k,$W);this._events||(this._events={});var $B=this._events,$o=$B[$d];return $o?$o.tail?($A.prev=$o.tail,$o.tail.next=$A,$o.tail=$A):$o.head=$o.tail=$A:$B[$d]={head:$A,tail:$A,cursor:null,lock:!1},this;},$d.off=function($d,$t,$l,$k){if(void 0===$k&&($k=!1),!this._events||!this._events[$d])return this;for(var $W=this._events[$d],$i=$W.head;$i;){if((!$t||$i.caller===$t)&&$i.method===$l&&(!$k||$i.once)){$I.delNode($W,$i),$W.cursor==$i&&($W.cursor=$i.next),$I.recoverHandler($i);break;}$i=$i.next;}return this;},$d.offAll=function($d){var $t=this._events;if(!$t)return this;if($d)this._recoverHandlers($t[$d]),delete $t[$d];else{for(var $l in $t)this._recoverHandlers($t[$l]);this._events=null;}return this;},$d._recoverHandlers=function($d){if($d){for(var $t=$d.head;$t;){$I.delNode($d,$t);var $l=$t.next;$I.recoverHandler($t),$t=$l;}$d.cursor=null;}},$d.isMouseEvent=function($d){return $I.MOUSE_EVENTS[$d];},$I.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$I.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0});},$I.delNode=function($d,$t){$t.prev?$t.prev.next=$t.next:$d.head=$t.next,$t.next?$t.next.prev=$t.prev:$d.tail=$t.prev;},$I.createHandler=function($d,$t,$l,$k){var $W=500<$I._freeHandler.length?$I._freeHandler.shift():null;if($W){if($W.recover)$W.recover=!1,$W.caller=$d,$W.method=$t,$W.args=$l,$W.once=$k;else{var $i="";try{arguments.propertyIsEnumerable.caller;}catch($d){$i=$d.stack;}var $A=$W.caller?($W.caller.__proto__&&$W.caller.__proto__.constructor&&$W.caller.__proto__.constructor.name)+"|"+$W.caller.__className+"|"+$W.caller.name:"",$B=$W.method?$W.method.name:"";$q.recordError("EventDispatcher重复创建","caller="+$A+"  method="+$B+"  stack="+$i),$W={id:++$I._nodeCount,caller:$d,method:$t,args:$l,once:$k,recover:!1};}}else $W={id:++$I._nodeCount,caller:$d,method:$t,args:$l,once:$k,recover:!1};return $W.prev=$W.next=null,$W;},$I.recoverHandler=function($d){if($d.recover){if($I._errorCount<5){$I._errorCount++;var $t="";try{arguments.propertyIsEnumerable.caller;}catch($d){$t=$d.stack;}var $l=$d.caller?($d.caller.__proto__&&$d.caller.__proto__.constructor&&$d.caller.__proto__.constructor.name)+"|"+$d.caller.__className+"|"+$d.caller.name:"",$k=$d.method?$d.method.name:"";$q.recordError("EventDispatcher重复回收","id="+$d.id+"  caller="+$l+"  method="+$k+"  stack="+$t);}$d.caller=$d.method=$d.args=$d.prev=null;}else $d.recover=!0,$d.caller=$d.method=$d.args=$d.prev=$d.next=null,$I._freeHandler&&$I._freeHandler.length<3e3&&$I._freeHandler.push($d);},$I._freeHandler=[],$I._nodeCount=0,$I._errorCount=0,$I;}(),$e=function(){function $W($d,$t,$l,$k){this.once=!1,void(this._id=0)===$k&&($k=!1),this.setTo($d,$t,$l,$k);}$w($W,"laya.utils.Handler");var $d=$W.prototype;return $d.setTo=function($d,$t,$l,$k){return this._id=$W._gid++,this.caller=$d,this.method=$t,this.args=$l,this.once=$k,this;},$d.run=function(){if(null==this.method)return null;var $d=this._id,$t=this.method.apply(this.caller,this.args);return this._id===$d&&this.once&&this.recover(),$t;},$d.runWith=function($d){if(null==this.method)return null;var $t=this._id;if(null==$d)var $l=this.method.apply(this.caller,this.args);else $l=this.args||$d.unshift?this.args?this.method.apply(this.caller,this.args.concat($d)):this.method.apply(this.caller,$d):this.method.call(this.caller,$d);return this._id===$t&&this.once&&this.recover(),$l;},$d.clear=function(){return this.caller=null,this.method=null,this.args=null,this;},$d.recover=function(){0<this._id&&(this._id=0,this.clear());},$W.create=function($d,$t,$l,$k){return void 0===$k&&($k=!0),new $W($d,$t,$l,$k);},$W._gid=1,$W;}(),$M=function(){function $d(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0;}$w($d,"laya.display.BitmapFont");var $t=$d.prototype;return $t.loadFont=function($d,$t){this._path=$d,this._complete=$t,$q.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$e.create(this,this.onLoaded));},$t.onLoaded=function(){this.parseFont($Bd.getRes(this._path),$Bd.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null);},$t.parseFont=function($d,$t){if(null!=$d&&null!=$t){this._texture=$t;var $l=$d.getElementsByTagName("info");if(!$l[0].getAttributeNode)return this.parseFont2($d,$t);this.fontSize=parseInt($l[0].getAttributeNode("size").nodeValue);var $k,$W=$l[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($W[0]),parseInt($W[1]),parseInt($W[2]),parseInt($W[3])],$k=$d.getElementsByTagName("char");var $i=0;for($i=0;$i<$k.length;$i++){var $A=$k[$i],$B=parseInt($A.getAttributeNode("id").nodeValue),$o=parseInt($A.getAttributeNode("xoffset").nodeValue)/1,$I=parseInt($A.getAttributeNode("yoffset").nodeValue)/1,$b=parseInt($A.getAttributeNode("xadvance").nodeValue)/1,$f=new $$();$f.x=parseInt($A.getAttributeNode("x").nodeValue),$f.y=parseInt($A.getAttributeNode("y").nodeValue),$f.width=parseInt($A.getAttributeNode("width").nodeValue),$f.height=parseInt($A.getAttributeNode("height").nodeValue);var $J=$bd.create($t,$f.x,$f.y,$f.width,$f.height,$o,$I);this._maxWidth=Math.max(this._maxWidth,$b+this.letterSpacing),this._fontCharDic[$B]=$J,this._fontWidthMap[$B]=$b;}}},$t.parseFont2=function($d,$t){if(null!=$d&&null!=$t){this._texture=$t;var $l=$d.getElementsByTagName("info");this.fontSize=parseInt($l[0].attributes.size.nodeValue);var $k=$l[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($k[0]),parseInt($k[1]),parseInt($k[2]),parseInt($k[3])];var $W=$d.getElementsByTagName("char"),$i=0;for($i=0;$i<$W.length;$i++){var $A=$W[$i].attributes,$B=parseInt($A.id.nodeValue),$o=parseInt($A.xoffset.nodeValue)/1,$I=parseInt($A.yoffset.nodeValue)/1,$b=parseInt($A.xadvance.nodeValue)/1,$f=new $$();$f.x=parseInt($A.x.nodeValue),$f.y=parseInt($A.y.nodeValue),$f.width=parseInt($A.width.nodeValue),$f.height=parseInt($A.height.nodeValue);var $J=$bd.create($t,$f.x,$f.y,$f.width,$f.height,$o,$I);this._maxWidth=Math.max(this._maxWidth,$b+this.letterSpacing),this._fontCharDic[$B]=$J,this._fontWidthMap[$B]=$b;}}},$t.getCharTexture=function($d){return this._fontCharDic[$d.charCodeAt(0)];},$t.destroy=function(){if(this._texture){for(var $d in this._fontCharDic){var $t=this._fontCharDic[$d];$t&&$t.destroy();}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null;}},$t.setSpaceWidth=function($d){this._spaceWidth=$d;},$t.getCharWidth=function($d){var $t=$d.charCodeAt(0);return this._fontWidthMap[$t]?this._fontWidthMap[$t]+this.letterSpacing:" "==$d?this._spaceWidth+this.letterSpacing:0;},$t.getTextWidth=function($d){for(var $t=0,$l=0,$k=$d.length;$l<$k;$l++)$t+=this.getCharWidth($d.charAt($l));return $t;},$t.getMaxWidth=function(){return this._maxWidth;},$t.getMaxHeight=function(){return this.fontSize;},$t.drawText=function($d,$t,$l,$k,$W,$i){var $A,$B=this.getTextWidth($d),$o=0;"center"===$W&&($o=($i-$B)/2),"right"===$W&&($o=$i-$B);for(var $I=0,$b=0,$f=$d.length;$b<$f;$b++)($A=this.getCharTexture($d.charAt($b)))&&($t.graphics.drawTexture($A,$l+$I+$o,$k),$I+=this.getCharWidth($d.charAt($b)));},$d;}(),$B=function(){function $l(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$l._TF_EMPTY;}$w($l,"laya.display.css.Style");var $d=$l.prototype;return $d.getTransform=function(){return this._tf;},$d.setTransform=function($d){this._tf="none"!==$d&&$d?$d:$l._TF_EMPTY;},$d.setTranslateX=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.translateX=$d;},$d.setTranslateY=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.translateY=$d;},$d.setScaleX=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.scaleX=$d;},$d.setScale=function($d,$t){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.scaleX=$d,this._tf.scaleY=$t;},$d.setScaleY=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.scaleY=$d;},$d.setRotate=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.rotate=$d;},$d.setSkewX=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.skewX=$d;},$d.setSkewY=function($d){this._tf===$l._TF_EMPTY&&(this._tf=new $W()),this._tf.skewY=$d;},$d.destroy=function(){this.scrollRect=null;},$d.render=function($d,$t,$l,$k){},$d.getCSSStyle=function(){return $td.EMPTY;},$d._enableLayout=function(){return!1;},$b(0,$d,"scaleX",function(){return this._tf.scaleX;},function($d){this.setScaleX($d);}),$b(0,$d,"transform",function(){return this.getTransform();},function($d){this.setTransform($d);}),$b(0,$d,"translateX",function(){return this._tf.translateX;},function($d){this.setTranslateX($d);}),$b(0,$d,"translateY",function(){return this._tf.translateY;},function($d){this.setTranslateY($d);}),$b(0,$d,"scaleY",function(){return this._tf.scaleY;},function($d){this.setScaleY($d);}),$b(0,$d,"block",function(){return 0!=(1&this._type);}),$b(0,$d,"skewY",function(){return this._tf.skewY;},function($d){this.setSkewY($d);}),$b(0,$d,"rotate",function(){return this._tf.rotate;},function($d){this.setRotate($d);}),$b(0,$d,"skewX",function(){return this._tf.skewX;},function($d){this.setSkewX($d);}),$b(0,$d,"paddingLeft",function(){return 0;}),$b(0,$d,"paddingTop",function(){return 0;}),$b(0,$d,"absolute",function(){return!0;}),$l.__init__=function(){$l._TF_EMPTY=new $W(),$l.EMPTY=new $l();},$l.EMPTY=null,$l._TF_EMPTY=null,$l;}(),$c=function(){function $t($d){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$N.create($t.defaultColor),this.family=$t.defaultFamily,this.stroke=$t._STROKE,this.size=$t.defaultSize,$d&&$d!==$t.EMPTY&&$d.copyTo(this);}$w($t,"laya.display.css.Font");var $d=$t.prototype;return $d.set=function($d){this._text=null;for(var $t=$d.split(" "),$l=0,$k=$t.length;$l<$k;$l++){var $W=$t[$l];switch($W){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue;}0<$W.indexOf("px")&&(this.size=parseInt($W),this.family=$t[$l+1],$l++);}},$d.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family;},$d.copyTo=function($d){$d._type=this._type,$d._text=this._text,$d._weight=this._weight,$d._color=this._color,$d.family=this.family,$d.stroke=this.stroke!=$t._STROKE?this.stroke.slice():$t._STROKE,$d.indent=this.indent,$d.size=this.size;},$b(0,$d,"password",function(){return 0!=(1024&this._type);},function($d){$d?this._type|=1024:this._type&=-1025;}),$b(0,$d,"color",function(){return this._color.strColor;},function($d){this._color=$N.create($d);}),$b(0,$d,"italic",function(){return 0!=(512&this._type);},function($d){$d?this._type|=512:this._type&=-513;}),$b(0,$d,"bold",function(){return 0!=(2048&this._type);},function($d){$d?this._type|=2048:this._type&=-2049;}),$b(0,$d,"weight",function(){return""+this._weight;},function($d){var $t=0;switch($d){case"normal":break;case"bold":this.bold=!0,$t=700;break;case"bolder":$t=800;break;case"lighter":$t=100;break;default:$t=parseInt($d);}this._weight=$t,this._text=null;}),$b(0,$d,"decoration",function(){return this._decoration?this._decoration.value:null;},function($d){var $t=$d.split(" ");switch(this._decoration||(this._decoration={}),$t[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$t[0];}$t[1]&&(this._decoration.color=$N.create($t)),this._decoration.value=$d;}),$t.__init__=function(){$t.EMPTY=new $t(null);},$t.EMPTY=null,$t.defaultColor="#000000",$t.defaultSize=12,$t.defaultFamily="Arial",$t.defaultFont="12px Arial",$t._STROKE=[0,"#000000"],$t._ITALIC=512,$t._PASSWORD=1024,$t._BOLD=2048,$t;}(),$W=function(){function $d(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0;}return $w($d,"laya.display.css.TransformInfo"),$d;}(),$J=function(){function $f(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$K.isConchNode){this._nativeObj=new $A._conchGraphics(),this.id=this._nativeObj.conchID;}}$w($f,"laya.display.Graphics");var $d=$f.prototype;return $d.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null;},$d.clear=function($d){void 0===$d&&($d=!1);var $t=0,$l=0;if($d){var $k=this._one;if(this._cmds){for($l=this._cmds.length,$t=0;$t<$l;$t++)!($k=this._cmds[$t])||$k.callee!==$K._context._drawTexture&&$k.callee!==$K._context._drawTextureWithTransform||($k[0]=null,$f._cache.push($k));this._cmds.length=0;}else $k&&(!$k||$k.callee!==$K._context._drawTexture&&$k.callee!==$K._context._drawTextureWithTransform||($k[0]=null,$f._cache.push($k)));}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($t=0,$l=this._vectorgraphArray.length;$t<$l;$t++)$a.getInstance().deleteShape(this._vectorgraphArray[$t]);this._vectorgraphArray.length=0;}},$d._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset();},$d._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $l(),this._graphicBounds._graphics=this);},$d._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint();},$d._isOnlyOne=function(){return!this._cmds||0===this._cmds.length;},$d.getBounds=function($d){return void 0===$d&&($d=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($d);},$d.getBoundPoints=function($d){return void 0===$d&&($d=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($d);},$d._addCmd=function($d){this._cmds=this._cmds||[],$d.callee=$d.shift(),this._cmds.push($d);},$d.setFilters=function($d){this._saveToCmd($K._context._setFilters,$d);},$d.drawTexture=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$A&&($A=1),!$d||$A<.01)return null;$k||($k=$d.sourceWidth),$W||($W=$d.sourceHeight),$A=$A<0?0:1<$A?1:$A;var $B,$o=!$K.isWebGL&&($V.onFirefox||$V.onEdge||$V.onIE||$V.onSafari)?.5:0,$I=$k/$d.sourceWidth,$b=$W/$d.sourceHeight;return $k=$d.width*$I,$W=$d.height*$b,$d.loaded&&($k<=0||$W<=0)?null:($t+=$d.offsetX*$I,$l+=$d.offsetY*$b,this._sp&&(this._sp._renderType|=512),$t-=$o,$l-=$o,$k+=2*$o,$W+=2*$o,$f._cache.length?(($B=$f._cache.pop())[0]=$d,$B[1]=$t,$B[2]=$l,$B[3]=$k,$B[4]=$W,$B[5]=$i,$B[6]=$A):$B=[$d,$t,$l,$k,$W,$i,$A],$B.callee=$i||1!=$A?$K._context._drawTextureWithTransform:$K._context._drawTexture,null!=this._one||$i||1!=$A?this._saveToCmd($B.callee,$B):(this._one=$B,this._render=this._renderOneImg),$d.loaded||$d.once("loaded",this,this._textureLoaded,[$d,$B]),this._repaint(),$B);},$d.cleanByTexture=function($d,$t,$l,$k,$W){if(void 0===$k&&($k=0),void 0===$W&&($W=0),!$d)return this.clear();if(this._one&&this._render===this._renderOneImg){$k||($k=$d.sourceWidth),$W||($W=$d.sourceHeight);var $i=$k/$d.sourceWidth,$A=$W/$d.sourceHeight;$k=$d.width*$i,$W=$d.height*$A,$t+=$d.offsetX*$i,$l+=$d.offsetY*$A,this._one[0]=$d,this._one[1]=$t,this._one[2]=$l,this._one[3]=$k,this._one[4]=$W,this._repaint();}else this.clear(),$d&&this.drawTexture($d,$t,$l,$k,$W);},$d.drawTextures=function($d,$t){$d&&this._saveToCmd($K._context._drawTextures,[$d,$t]);},$d.fillTexture=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$i&&($i="repeat"),$d){var $B=[$d,$t,$l,$k,$W,$i,$A||$L.EMPTY,{}];$d.loaded||$d.once("loaded",this,this._textureLoaded,[$d,$B]),this._saveToCmd($K._context._fillTexture,$B);}},$d._textureLoaded=function($d,$t){$t[3]=$t[3]||$d.width,$t[4]=$t[4]||$d.height,this._repaint();},$d.fillCircle=function($d,$t,$l,$k,$W,$i,$A){$l.bitmap.enableMerageInAtlas=!1;var $B=new Float32Array(2*($A+1)),$o=new Float32Array(2*($A+1)),$I=new Uint16Array(3*$A),$b=2*Math.PI/$A,$f=0;$B[0]=$k,$B[1]=$W,$o[0]=$k/$l.width,$o[1]=$W/$l.height;for(var $J=2,$c=0;$c<$A;$c++){var $Y=$i*Math.cos($f)+$k,$w=$i*Math.sin($f)+$W;$B[$J]=$Y,$B[$J+1]=$w,$o[$J]=$Y/$l.width,$o[$J+1]=$w/$l.height,$f+=$b,$J+=2;}for($c=$J=0;$c<$A;$c++)$I[$J++]=0,$I[$J++]=$c+1,$I[$J++]=$A+1<=$c+2?1:$c+2;this.drawTriangles($l,$d,$t,$B,$o,$I);},$d.drawTriangles=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){void 0===$B&&($B=1),this._saveToCmd($K._context.drawTriangles,[$d,$t,$l,$k,$W,$i,$A,$B,$o,$I]);},$d._saveToCmd=function($d,$t){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$t,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($t)),$t.callee=$d,this._repaint(),$t;},$d.clipRect=function($d,$t,$l,$k){this._saveToCmd($K._context._clipRect,[$d,$t,$l,$k]);},$d.fillText=function($d,$t,$l,$k,$W,$i,$A){void 0===$A&&($A=0),this._saveToCmd($K._context._fillText,[$d,$t,$l,$k||$c.defaultFont,$W,$i]);},$d.fillBorderText=function($d,$t,$l,$k,$W,$i,$A,$B){this._saveToCmd($K._context._fillBorderText,[$d,$t,$l,$k||$c.defaultFont,$W,$i,$A,$B]);},$d.strokeText=function($d,$t,$l,$k,$W,$i,$A){this._saveToCmd($K._context._strokeText,[$d,$t,$l,$k||$c.defaultFont,$W,$i,$A]);},$d.alpha=function($d){$d=$d<0?0:1<$d?1:$d,this._saveToCmd($K._context._alpha,[$d]);},$d.setAlpha=function($d){$d=$d<0?0:1<$d?1:$d,this._saveToCmd($K._context._setAlpha,[$d]);},$d.transform=function($d,$t,$l){void 0===$t&&($t=0),void 0===$l&&($l=0),this._saveToCmd($K._context._transform,[$d,$t,$l]);},$d.rotate=function($d,$t,$l){void 0===$t&&($t=0),void 0===$l&&($l=0),this._saveToCmd($K._context._rotate,[$d,$t,$l]);},$d.scale=function($d,$t,$l,$k){void 0===$l&&($l=0),void 0===$k&&($k=0),this._saveToCmd($K._context._scale,[$d,$t,$l,$k]);},$d.translate=function($d,$t){this._saveToCmd($K._context._translate,[$d,$t]);},$d.save=function(){this._saveToCmd($K._context._save,[]);},$d.restore=function(){this._saveToCmd($K._context._restore,[]);},$d.replaceText=function($d){this._repaint();var $t=this._cmds;if($t){for(var $l=$t.length-1;-1<$l;$l--)if(this._isTextCmd($t[$l].callee))return $t[$l][0].toUpperCase?$t[$l][0]=$d:$t[$l][0].setText($d),!0;}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$d:this._one[0].setText($d),!0;return!1;},$d._isTextCmd=function($d){return $d===$K._context._fillText||$d===$K._context._fillBorderText||$d===$K._context._strokeText;},$d.replaceTextColor=function($d){this._repaint();var $t=this._cmds;if($t)for(var $l=$t.length-1;-1<$l;$l--)this._isTextCmd($t[$l].callee)&&($t[$l][4]=$d,$t[$l][0].toUpperCase||($t[$l][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$d,this._one[0].toUpperCase||(this._one[0].changed=!0));},$d.loadImage=function($d,$t,$l,$k,$W,$i){var $A=this;void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),void 0===$W&&($W=0);var $B=$Bd.getRes($d);function $o($d){$d&&($A.drawTexture($d,$t,$l,$k,$W),null!=$i&&$i.call($A._sp,$d));}$B?$o($B):$q.loader.load($d,$e.create(null,$o),null,"image");},$d._renderEmpty=function($d,$t,$l,$k){},$d._renderAll=function($d,$t,$l,$k){for(var $W,$i=this._cmds,$A=0,$B=$i.length;$A<$B;$A++)($W=$i[$A]).callee.call($t,$l,$k,$W);},$d._renderOne=function($d,$t,$l,$k){this._one.callee.call($t,$l,$k,this._one);},$d._renderOneImg=function($d,$t,$l,$k){this._one.callee.call($t,$l,$k,this._one),2305!==$d._renderType&&($d._renderType|=1);},$d.drawLine=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=1);var $A=0;$K.isWebGL&&($A=$a.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($A));var $B=$i%2==0?0:.5,$o=[$d+$B,$t+$B,$l+$B,$k+$B,$W,$i,$A];this._saveToCmd($K._context._drawLine,$o);},$d.drawLines=function($d,$t,$l,$k,$W){void 0===$W&&($W=1);var $i=0;if($l&&!($l.length<4)){$K.isWebGL&&($i=$a.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($i));var $A=$W%2==0?0:.5,$B=[$d+$A,$t+$A,$l,$k,$W,$i];this._saveToCmd($K._context._drawLines,$B);}},$d.drawCurves=function($d,$t,$l,$k,$W){void 0===$W&&($W=1);var $i=[$d,$t,$l,$k,$W];this._saveToCmd($K._context._drawCurves,$i);},$d.drawRect=function($d,$t,$l,$k,$W,$i,$A){void 0===$A&&($A=1);var $B=$i?$A/2:0,$o=$i?$A:0,$I=[$d+$B,$t+$B,$l-$o,$k-$o,$W,$i,$A];this._saveToCmd($K._context._drawRect,$I);},$d.drawCircle=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=1);var $A=$W?$i/2:0,$B=0;$K.isWebGL&&($B=$a.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($B));var $o=[$d,$t,$l-$A,$k,$W,$i,$B];this._saveToCmd($K._context._drawCircle,$o);},$d.drawPie=function($d,$t,$l,$k,$W,$i,$A,$B){void 0===$B&&($B=1);var $o=$A?$B/2:0,$I=$A?$B:0,$b=0;$K.isWebGL&&($b=$a.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($b));var $f=[$d+$o,$t+$o,$l-$I,$k,$W,$i,$A,$B,$b];$f[3]=$F.toRadian($k),$f[4]=$F.toRadian($W),this._saveToCmd($K._context._drawPie,$f);},$d.drawPoly=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=1);var $A=0,$B=!1;$K.isWebGL&&($A=$a.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($A),$B=!(6<$l.length));var $o=$W?$i%2==0?0:.5:0,$I=[$d+$o,$t+$o,$l,$k,$W,$i,$A,$B];this._saveToCmd($K._context._drawPoly,$I);},$d.drawPath=function($d,$t,$l,$k,$W){var $i=[$d,$t,$l,$k,$W];this._saveToCmd($K._context._drawPath,$i);},$b(0,$d,"cmds",function(){return this._cmds;},function($d){this._sp&&(this._sp._renderType|=512),this._cmds=$d,this._render=this._renderAll,this._repaint();}),$f.__init__=function(){if($K.isConchNode){for(var $d=laya.display.Graphics.prototype,$t=$V.window.ConchGraphics.prototype,$l=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$k=0,$W=$l.length;$k<=$W;$k++){var $i=$l[$k];$d[$i]=$t[$i];}$d._saveToCmd=null,$t.drawImageS&&($d.drawTextures=function($d,$t){if($d&&$d.loaded&&$d.bitmap&&$d.source){var $l=$d.uv,$k=$d.bitmap.width,$W=$d.bitmap.height;this.drawImageS($d.bitmap.source,$l[0]*$k,$l[1]*$W,($l[2]-$l[0])*$k,($l[5]-$l[3])*$W,$d.offsetX,$d.offsetY,$d.width,$d.height,$t);}}),$d.drawTexture=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$A&&($A=1),$d)if($d.loaded){if($d.loaded&&$d.bitmap&&$d.source&&($k||($k=$d.sourceWidth),$W||($W=$d.sourceHeight),$A=$A<0?0:1<$A?1:$A,$k=$k-$d.sourceWidth+$d.width,$W=$W-$d.sourceHeight+$d.height,!($k<=0||$W<=0))){$t+=$d.offsetX,$l+=$d.offsetY;var $B=$d.uv,$o=$d.bitmap.width,$I=$d.bitmap.height;$B[4]<$B[0]&&$B[5]<$B[1]?this.drawImageM($d.bitmap.source,$B[4]*$o,$B[5]*$I,($B[0]-$B[4])*$o,($B[1]-$B[5])*$I,$t,$l,$k,$W,$i,$A):this.drawImageM($d.bitmap.source,$B[0]*$o,$B[1]*$I,($B[2]-$B[0])*$o,($B[5]-$B[3])*$I,$t,$l,$k,$W,$i,$A),this._repaint();}}else $d.once("loaded",this,function(){this.drawTexture($d,$t,$l,$k,$W,$i);});},$d.fillTexture=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$i&&($i="repeat"),$d&&$d.loaded){var $B,$o=$K._context.ctx,$I=$d.bitmap.width,$b=$d.bitmap.height,$f=$d.uv;$B=$d.uv!=$bd.DEF_UV?$o.createPattern($d.bitmap.source,$i,$f[0]*$I,$f[1]*$b,($f[2]-$f[0])*$I,($f[5]-$f[3])*$b):$o.createPattern($d.bitmap.source,$i);var $J=0,$c=0;$A&&($t+=$A.x%$d.width,$l+=$A.y%$d.height,$J-=$A.x%$d.width,$c-=$A.y%$d.height),this._fillImage($B,$t,$l,$J,$c,$k,$W);}};}},$f._cache=[],$f;}(),$l=function(){function $g(){this._cacheBoundsType=!1;}$w($g,"laya.display.GraphicsBounds");var $d=$g.prototype;return $d.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null;},$d.reset=function(){this._temp&&(this._temp.length=0);},$d.getBounds=function($d){return void 0===$d&&($d=!1),(!this._bounds||!this._temp||this._temp.length<1||$d!=this._cacheBoundsType)&&(this._bounds=$$._getWrapRec(this.getBoundPoints($d),this._bounds)),this._cacheBoundsType=$d,this._bounds;},$d.getBoundPoints=function($d){return void 0===$d&&($d=!1),(!this._temp||this._temp.length<1||$d!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($d)),this._cacheBoundsType=$d,this._rstBoundPoints=$F.copyArray(this._rstBoundPoints,this._temp);},$d._getCmdPoints=function($d){void 0===$d&&($d=!1);var $t,$l,$k=$K._context,$W=this._graphics.cmds;if(($t=this._temp||(this._temp=[])).length=0,$W||null==this._graphics._one||($g._tempCmds.length=0,$g._tempCmds.push(this._graphics._one),$W=$g._tempCmds),!$W)return $t;($l=$g._tempMatrixArrays).length=0;var $i=$g._initMatrix;$i.identity();for(var $A,$B,$o=$g._tempMatrix,$I=NaN,$b=NaN,$f=NaN,$J=NaN,$c=NaN,$Y=NaN,$w=0,$D=$W.length;$w<$D;$w++)if(($A=$W[$w]).callee)switch($A.callee){case $k._save:case 7:$l.push($i),$i=$i.clone();break;case $k._restore:case 8:$i=$l.pop();break;case $k._scale:case 5:$o.identity(),$o.translate(-$A[2],-$A[3]),$o.scale($A[0],$A[1]),$o.translate($A[2],$A[3]),this._switchMatrix($i,$o);break;case $k._rotate:case 3:$o.identity(),$o.translate(-$A[1],-$A[2]),$o.rotate($A[0]),$o.translate($A[1],$A[2]),this._switchMatrix($i,$o);break;case $k._translate:case 6:$o.identity(),$o.translate($A[0],$A[1]),this._switchMatrix($i,$o);break;case $k._transform:case 4:$o.identity(),$o.translate(-$A[1],-$A[2]),$o.concat($A[0]),$o.translate($A[1],$A[2]),this._switchMatrix($i,$o);break;case 16:case 24:$g._addPointArrToRst($t,$$._getBoundPointS($A[0],$A[1],$A[2],$A[3]),$i);break;case 17:$i.copyTo($o),$o.concat($A[4]),$g._addPointArrToRst($t,$$._getBoundPointS($A[0],$A[1],$A[2],$A[3]),$o);break;case $k._drawTexture:$B=$A[0],$d?$A[3]&&$A[4]?$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$A[3],$A[4]),$i):($B=$A[0],$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$B.width,$B.height),$i)):($I=($A[3]||$B.sourceWidth)/$B.width,$b=($A[4]||$B.sourceHeight)/$B.height,$f=$I*$B.sourceWidth,$J=$b*$B.sourceHeight,$c=0<$B.offsetX?$B.offsetX:0,$Y=0<$B.offsetY?$B.offsetY:0,$c*=$I,$Y*=$b,$g._addPointArrToRst($t,$$._getBoundPointS($A[1]-$c,$A[2]-$Y,$f,$J),$i));break;case $k._fillTexture:$A[3]&&$A[4]?$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$A[3],$A[4]),$i):($B=$A[0],$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$B.width,$B.height),$i));break;case $k._drawTextureWithTransform:var $z;$z=$A[5]?($i.copyTo($o),$o.concat($A[5]),$o):$i,$d?$A[3]&&$A[4]?$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$A[3],$A[4]),$z):($B=$A[0],$g._addPointArrToRst($t,$$._getBoundPointS($A[1],$A[2],$B.width,$B.height),$z)):($B=$A[0],$I=($A[3]||$B.sourceWidth)/$B.width,$b=($A[4]||$B.sourceHeight)/$B.height,$f=$I*$B.sourceWidth,$J=$b*$B.sourceHeight,$c=0<$B.offsetX?$B.offsetX:0,$Y=0<$B.offsetY?$B.offsetY:0,$c*=$I,$Y*=$b,$g._addPointArrToRst($t,$$._getBoundPointS($A[1]-$c,$A[2]-$Y,$f,$J),$z));break;case $k._drawRect:case 13:$g._addPointArrToRst($t,$$._getBoundPointS($A[0],$A[1],$A[2],$A[3]),$i);break;case $k._drawCircle:case $k._fillCircle:case 14:$g._addPointArrToRst($t,$$._getBoundPointS($A[0]-$A[2],$A[1]-$A[2],$A[2]+$A[2],$A[2]+$A[2]),$i);break;case $k._drawLine:case 20:$g._tempPoints.length=0;var $e;$e=.5*$A[5],$A[0]==$A[2]?$g._tempPoints.push($A[0]+$e,$A[1],$A[2]+$e,$A[3],$A[0]-$e,$A[1],$A[2]-$e,$A[3]):$A[1]==$A[3]?$g._tempPoints.push($A[0],$A[1]+$e,$A[2],$A[3]+$e,$A[0],$A[1]-$e,$A[2],$A[3]-$e):$g._tempPoints.push($A[0],$A[1],$A[2],$A[3]),$g._addPointArrToRst($t,$g._tempPoints,$i);break;case $k._drawCurves:case 22:$g._addPointArrToRst($t,$H.I.getBezierPoints($A[2]),$i,$A[0],$A[1]);break;case $k._drawPoly:case $k._drawLines:case 18:$g._addPointArrToRst($t,$A[2],$i,$A[0],$A[1]);break;case $k._drawPath:case 19:$g._addPointArrToRst($t,this._getPathPoints($A[2]),$i,$A[0],$A[1]);break;case $k._drawPie:case 15:$g._addPointArrToRst($t,this._getPiePoints($A[0],$A[1],$A[2],$A[3],$A[4]),$i);}return 200<$t.length?$t=$F.copyArray($t,$$._getWrapRec($t)._getBoundPoints()):8<$t.length&&($t=$R.scanPList($t)),$t;},$d._switchMatrix=function($d,$t){$t.concat($d),$t.copyTo($d);},$d._getPiePoints=function($d,$t,$l,$k,$W){var $i=$g._tempPoints;$g._tempPoints.length=0,$i.push($d,$t);var $A=($W-$k)%(2*Math.PI)/10,$B=NaN,$o=$k;for($B=0;$B<=10;$B++)$i.push($d+$l*Math.cos($o),$t+$l*Math.sin($o)),$o+=$A;return $i;},$d._getPathPoints=function($d){var $t,$l,$k=0,$W=$g._tempPoints;for($W.length=0,$t=$d.length,$k=0;$k<$t;$k++)1<($l=$d[$k]).length&&($W.push($l[1],$l[2]),3<$l.length&&$W.push($l[3],$l[4]));return $W;},$g._addPointArrToRst=function($d,$t,$l,$k,$W){void 0===$k&&($k=0),void 0===$W&&($W=0);var $i,$A=0;for($i=$t.length,$A=0;$A<$i;$A+=2)$g._addPointToRst($d,$t[$A]+$k,$t[$A+1]+$W,$l);},$g._addPointToRst=function($d,$t,$l,$k){var $W=$L.TEMP;$W.setTo($t||0,$l||0),$k.transformPoint($W),$d.push($W.x,$W.y);},$g._tempPoints=[],$g._tempMatrixArrays=[],$g._tempCmds=[],$o($g,["_tempMatrix",function(){return this._tempMatrix=new $S();},"_initMatrix",function(){return this._initMatrix=new $S();}]),$g;}(),$i=function(){function $d(){}$w($d,"laya.events.Event");var $t=$d.prototype;return $t.setTo=function($d,$t,$l){return this.type=$d,this.currentTarget=$t,this.target=$l,this;},$t.stopPropagation=function(){this._stoped=!0;},$b(0,$t,"stageY",function(){return $q.stage.mouseY;}),$b(0,$t,"charCode",function(){return this.nativeEvent.charCode;}),$b(0,$t,"touches",function(){var $d=this.nativeEvent.touches;if($d)for(var $t=$q.stage,$l=0,$k=$d.length;$l<$k;$l++){var $W=$d[$l],$i=$L.TEMP;$i.setTo($W.clientX,$W.clientY),$t._canvasTransform.invertTransformPoint($i),$t.transform.invertTransformPoint($i),$W.stageX=$i.x,$W.stageY=$i.y;}return $d;}),$b(0,$t,"keyLocation",function(){return this.nativeEvent.keyLocation;}),$b(0,$t,"ctrlKey",function(){return this.nativeEvent.ctrlKey;}),$b(0,$t,"altKey",function(){return this.nativeEvent.altKey;}),$b(0,$t,"shiftKey",function(){return this.nativeEvent.shiftKey;}),$b(0,$t,"stageX",function(){return $q.stage.mouseX;}),$d.EMPTY=new $d(),$d.MOUSE_DOWN="mousedown",$d.MOUSE_UP="mouseup",$d.CLICK="click",$d.RIGHT_MOUSE_DOWN="rightmousedown",$d.RIGHT_MOUSE_UP="rightmouseup",$d.RIGHT_CLICK="rightclick",$d.MOUSE_MOVE="mousemove",$d.MOUSE_OVER="mouseover",$d.MOUSE_OUT="mouseout",$d.MOUSE_WHEEL="mousewheel",$d.ROLL_OVER="mouseover",$d.ROLL_OUT="mouseout",$d.DOUBLE_CLICK="doubleclick",$d.CHANGE="change",$d.CHANGED="changed",$d.RESIZE="resize",$d.ADDED="added",$d.REMOVED="removed",$d.DISPLAY="display",$d.UNDISPLAY="undisplay",$d.ERROR="error",$d.COMPLETE="complete",$d.LOADED="loaded",$d.INITED="inited",$d.PROGRESS="progress",$d.INPUT="input",$d.RENDER="render",$d.OPEN="open",$d.MESSAGE="message",$d.CLOSE="close",$d.KEY_DOWN="keydown",$d.KEY_PRESS="keypress",$d.KEY_UP="keyup",$d.FRAME="enterframe",$d.DRAG_START="dragstart",$d.DRAG_MOVE="dragmove",$d.DRAG_END="dragend",$d.ENTER="enter",$d.SELECT="select",$d.BLUR="blur",$d.FOCUS="focus",$d.VISIBILITY_CHANGE="visibilitychange",$d.FOCUS_CHANGE="focuschange",$d.PLAYED="played",$d.PAUSED="paused",$d.STOPPED="stopped",$d.START="start",$d.END="end",$d.ENABLE_CHANGED="enablechanged",$d.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$d.COMPONENT_ADDED="componentadded",$d.COMPONENT_REMOVED="componentremoved",$d.LAYER_CHANGED="layerchanged",$d.HIERARCHY_LOADED="hierarchyloaded",$d.RECOVERED="recovered",$d.RELEASED="released",$d.LINK="link",$d.LABEL="label",$d.FULL_SCREEN_CHANGE="fullscreenchange",$d.DEVICE_LOST="devicelost",$d.MESH_CHANGED="meshchanged",$d.MATERIAL_CHANGED="materialchanged",$d.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$d.ANIMATION_CHANGED="animationchanged",$d.TRIGGER_ENTER="triggerenter",$d.TRIGGER_STAY="triggerstay",$d.TRIGGER_EXIT="triggerexit",$d.TRAIL_FILTER_CHANGE="trailfilterchange",$d.DOMINO_FILTER_CHANGE="dominofilterchange",$d;}(),$f=(function(){function $d(){}$w($d,"laya.events.Keyboard"),$d.NUMBER_0=48,$d.NUMBER_1=49,$d.NUMBER_2=50,$d.NUMBER_3=51,$d.NUMBER_4=52,$d.NUMBER_5=53,$d.NUMBER_6=54,$d.NUMBER_7=55,$d.NUMBER_8=56,$d.NUMBER_9=57,$d.A=65,$d.B=66,$d.C=67,$d.D=68,$d.E=69,$d.F=70,$d.G=71,$d.H=72,$d.I=73,$d.J=74,$d.K=75,$d.L=76,$d.M=77,$d.N=78,$d.O=79,$d.P=80,$d.Q=81,$d.R=82,$d.S=83,$d.T=84,$d.U=85,$d.V=86,$d.W=87,$d.X=88,$d.Y=89,$d.Z=90,$d.F1=112,$d.F2=113,$d.F3=114,$d.F4=115,$d.F5=116,$d.F6=117,$d.F7=118,$d.F8=119,$d.F9=120,$d.F10=121,$d.F11=122,$d.F12=123,$d.F13=124,$d.F14=125,$d.F15=126,$d.NUMPAD=21,$d.NUMPAD_0=96,$d.NUMPAD_1=97,$d.NUMPAD_2=98,$d.NUMPAD_3=99,$d.NUMPAD_4=100,$d.NUMPAD_5=101,$d.NUMPAD_6=102,$d.NUMPAD_7=103,$d.NUMPAD_8=104,$d.NUMPAD_9=105,$d.NUMPAD_ADD=107,$d.NUMPAD_DECIMAL=110,$d.NUMPAD_DIVIDE=111,$d.NUMPAD_ENTER=108,$d.NUMPAD_MULTIPLY=106,$d.NUMPAD_SUBTRACT=109,$d.SEMICOLON=186,$d.EQUAL=187,$d.COMMA=188,$d.MINUS=189,$d.PERIOD=190,$d.SLASH=191,$d.BACKQUOTE=192,$d.LEFTBRACKET=219,$d.BACKSLASH=220,$d.RIGHTBRACKET=221,$d.QUOTE=222,$d.ALTERNATE=18,$d.BACKSPACE=8,$d.CAPS_LOCK=20,$d.COMMAND=15,$d.CONTROL=17,$d.DELETE=46,$d.ENTER=13,$d.ESCAPE=27,$d.PAGE_UP=33,$d.PAGE_DOWN=34,$d.END=35,$d.HOME=36,$d.LEFT=37,$d.UP=38,$d.RIGHT=39,$d.DOWN=40,$d.SHIFT=16,$d.SPACE=32,$d.TAB=9,$d.INSERT=45;}(),function(){function $W(){}return $w($W,"laya.events.KeyBoardManager"),$W.__init__=function(){$W._addEvent("keydown"),$W._addEvent("keypress"),$W._addEvent("keyup");},$W._addEvent=function($t){$V.document.addEventListener($t,function($d){laya.events.KeyBoardManager._dispatch($d,$t);},!0);},$W._dispatch=function($d,$t){if($W.enabled){$W._event._stoped=!1,$W._event.nativeEvent=$d,$W._event.keyCode=$d.keyCode||$d.which||$d.charCode,"keydown"===$t?$W._pressKeys[$W._event.keyCode]=!0:"keyup"===$t&&($W._pressKeys[$W._event.keyCode]=null);for(var $l=$q.stage.focus&&null!=$q.stage.focus.event&&$q.stage.focus.displayedInStage?$q.stage.focus:$q.stage,$k=$l;$k;)$k.event($t,$W._event.setTo($t,$k,$l)),$k=$k.parent;}},$W.hasKeyDown=function($d){return $W._pressKeys[$d];},$W._pressKeys={},$W.enabled=!0,$o($W,["_event",function(){return this._event=new $i();}]),$W;}()),$Y=(function(){function $d(){}$w($d,"laya.events.KeyLocation"),$d.STANDARD=0,$d.LEFT=1,$d.RIGHT=2,$d.NUM_PAD=3;}(),function(){function $b(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$V.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $i(),this._matrix=new $S(),this._point=new $L(),this._rect=new $$(),this._prePoint=new $L(),this._curTouchID=NaN;}$w($b,"laya.events.MouseManager");var $d=$b.prototype;return $d.__init__=function($d,$t){var $l=this;this._stage=$d;var $k=this,$W=this._eventList;$t.oncontextmenu=function($d){if($b.enabled)return!1;},$t.addEventListener("mousedown",function($d){$b.enabled&&($V.onIE||$d.preventDefault(),$W.push($d),$k.mouseDownTime=$V.now());}),$t.addEventListener("mouseup",function($d){$b.enabled&&($d.preventDefault(),$W.push($d),$k.mouseDownTime=-$V.now());},!0),$t.addEventListener("mousemove",function($d){if($b.enabled){$d.preventDefault();var $t=$V.now();if($t-$k._lastMoveTimer<10)return;$k._lastMoveTimer=$t,$W.push($d);}},!0),$t.addEventListener("mouseout",function($d){$b.enabled&&$W.push($d);}),$t.addEventListener("mouseover",function($d){$b.enabled&&$W.push($d);}),$t.addEventListener("touchstart",function($d){$b.enabled&&($W.push($d),$b._isFirstTouch||$Rd.isInputting||$d.preventDefault(),$k.mouseDownTime=$V.now());}),$t.addEventListener("touchend",function($d){$b.enabled?($b._isFirstTouch||$Rd.isInputting||$d.preventDefault(),$b._isFirstTouch=!1,$W.push($d),$k.mouseDownTime=-$V.now()):$l._curTouchID=NaN;},!0),$t.addEventListener("touchmove",function($d){$b.enabled&&($d.preventDefault(),$W.push($d));},!0),$t.addEventListener("touchcancel",function($d){$b.enabled?($d.preventDefault(),$W.push($d)):$l._curTouchID=NaN;},!0),$t.addEventListener("mousewheel",function($d){$b.enabled&&$W.push($d);}),$t.addEventListener("DOMMouseScroll",function($d){$b.enabled&&$W.push($d);});},$d.initEvent=function($d,$t){var $l;this._event._stoped=!1,this._event.nativeEvent=$t||$d,this._target=null,this._point.setTo($d.pageX||$d.clientX,$d.pageY||$d.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$d.identifier||0,this._tTouchID=this._event.touchId,($l=$D.I._event)._stoped=!1,$l.nativeEvent=this._event.nativeEvent,$l.touchId=this._event.touchId;},$d.checkMouseWheel=function($d){this._event.delta=$d.wheelDelta?.025*$d.wheelDelta:-$d.detail;for(var $t=$D.I.getLastOvers(),$l=0,$k=$t.length;$l<$k;$l++){var $W=$t[$l];$W.event("mousewheel",this._event.setTo("mousewheel",$W,this._target));}},$d.onMouseMove=function($d){$D.I.onMouseMove($d,this._tTouchID);},$d.onMouseDown=function($d){if($Rd.isInputting&&$q.stage.focus&&$q.stage.focus.focus&&!$q.stage.focus.contains(this._target)){var $t=$q.stage.focus._tf||$q.stage.focus,$l=$d._tf||$d;$l instanceof laya.display.Input&&$l.multiline==$t.multiline?$t._focusOut():$t.focus=!1;}$D.I.onMouseDown($d,this._tTouchID,this._isLeftMouse);},$d.onMouseUp=function($d){$D.I.onMouseUp($d,this._tTouchID,this._isLeftMouse);},$d.check=function($d,$t,$l,$k){this._point.setTo($t,$l),$d.fromParentPoint(this._point),$t=this._point.x,$l=this._point.y;var $W=$d.scrollRect;if($W&&(this._rect.setTo($W.x,$W.y,$W.width,$W.height),!this._rect.contains($t,$l)))return!1;if(!this.disableMouseEvent){if($d.hitTestPrior&&!$d.mouseThrough&&!this.hitTest($d,$t,$l))return!1;for(var $i=$d._childs.length-1;-1<$i;$i--){var $A=$d._childs[$i];if(!$A.destroyed&&$A.mouseEnabled&&$A.visible&&this.check($A,$t,$l,$k))return!0;}}var $B=!(!$d.hitTestPrior||$d.mouseThrough||this.disableMouseEvent)||this.hitTest($d,$t,$l);return $B?(this._target=$d,$k.call(this,$d)):$k===this.onMouseUp&&$d===this._stage&&(this._target=this._stage,$k.call(this,this._target)),$B;},$d.hitTest=function($d,$t,$l){var $k=!1;if($d.scrollRect&&($t-=$d.scrollRect.x,$l-=$d.scrollRect.y),$d.hitArea instanceof laya.utils.HitArea)return $d.hitArea.isHit($t,$l);if(0<$d.width&&0<$d.height||$d.mouseThrough||$d.hitArea)if($d.mouseThrough)$k=$d.getGraphicBounds().contains($t,$l);else{var $W=this._rect;$d.hitArea?$W=$d.hitArea:$W.setTo(0,0,$d.width,$d.height),$k=$W.contains($t,$l);}return $k;},$d.runEvent=function(){var $d=this._eventList.length;if($d){var $t=this;$t.mouseEventTime=$V.now();var $l,$k=0,$W=0,$i=0;try{for(;$k<$d;){var $A=this._eventList[$k];switch("mousemove"!==$A.type&&(this._prePoint.x=this._prePoint.y=-1e6),$A.type){case"mousedown":this._touchIDs[0]=this._id++,$b._isTouchRespond?$b._isTouchRespond=!1:($t._isLeftMouse=0===$A.button,$t.initEvent($A),$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseDown));break;case"mouseup":$t._isLeftMouse=0===$A.button,$t.initEvent($A),$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$A.clientX)+Math.abs(this._prePoint.y-$A.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$A.clientX,this._prePoint.y=$A.clientY,$t.initEvent($A),$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseMove));break;case"touchstart":$b._isTouchRespond=!0,$t._isLeftMouse=!0;var $B=$A.changedTouches;for($W=0,$i=$B.length;$W<$i;$W++)$l=$B[$W],($b.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$l.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$l.identifier]=this._id++,$t.initEvent($l,$A),$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseDown));break;case"touchend":case"touchcancel":$b._isTouchRespond=!0,$t._isLeftMouse=!0;var $o=$A.changedTouches;for($W=0,$i=$o.length;$W<$i;$W++)if($l=$o[$W],$b.multiTouchEnabled||$l.identifier==this._curTouchID){this._curTouchID=NaN,$t.initEvent($l,$A);$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseUp)||$t.onMouseUp(null);}break;case"touchmove":var $I=$A.changedTouches;for($W=0,$i=$I.length;$W<$i;$W++)$l=$I[$W],($b.multiTouchEnabled||$l.identifier==this._curTouchID)&&($t.initEvent($l,$A),$t.check($t._stage,$t.mouseX,$t.mouseY,$t.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$t.checkMouseWheel($A);break;case"mouseout":$D.I.stageMouseOut();break;case"mouseover":$t._stage.event("mouseover",$t._event.setTo("mouseover",$t._stage,$t._stage));}$k++;}}catch($d){throw this._eventList.length=0,$d;}this._eventList.length=0;}},$b.enabled=!0,$b.multiTouchEnabled=!0,$b._isTouchRespond=!1,$b._isFirstTouch=!0,$o($b,["instance",function(){return this.instance=new $b();}]),$b;}()),$D=function(){function $Y(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $i();}$w($Y,"laya.events.TouchManager");var $d=$Y.prototype;return $d._clearTempArrs=function(){$Y._oldArr.length=0,$Y._newArr.length=0,$Y._tEleArr.length=0;},$d.getTouchFromArr=function($d,$t){var $l,$k,$W=0;for($l=$t.length,$W=0;$W<$l;$W++)if(($k=$t[$W]).id==$d)return $k;return null;},$d.removeTouchFromArr=function($d,$t){var $l=0;for($l=$t.length-1;0<=$l;$l--)$t[$l].id==$d&&$t.splice($l,1);},$d.createTouchO=function($d,$t){var $l;return($l=$P.getItem("TouchData")||{}).id=$t,$l.tar=$d,$l;},$d.onMouseDown=function($d,$t,$l){var $k,$W,$i,$A;(void 0===$l&&($l=!1),this.enable)&&($k=this.getTouchFromArr($t,this.preOvers),$i=this.getEles($d,null,$Y._tEleArr),$k?$k.tar=$d:($W=this.createTouchO($d,$t),this.preOvers.push($W)),$V.onMobile&&this.sendEvents($i,"mouseover",$t),$A=$l?this.preDowns:this.preRightDowns,($k=this.getTouchFromArr($t,$A))?$k.tar=$d:($W=this.createTouchO($d,$t),$A.push($W)),this.sendEvents($i,$l?"mousedown":"rightmousedown",$t),this._clearTempArrs());},$d.sendEvents=function($d,$t,$l){void 0===$l&&($l=0);var $k,$W,$i,$A=0;for($k=$d.length,this._event._stoped=!1,$W=$d[0],$A=0;$A<$k;$A++){if(($i=$d[$A]).destroyed)return;if($i.event($t,this._event.setTo($t,$i,$W)),this._event._stoped)break;}},$d.getEles=function($d,$t,$l){for($l?$l.length=0:$l=[];$d&&$d!=$t;)$l.push($d),$d=$d.parent;return $l;},$d.checkMouseOutAndOverOfMove=function($d,$t,$l){if(void 0===$l&&($l=0),$t!=$d){var $k,$W,$i=0,$A=0;if($t.contains($d))$W=this.getEles($d,$t,$Y._tEleArr),this.sendEvents($W,"mouseover",$l);else if($d.contains($t))$W=this.getEles($t,$d,$Y._tEleArr),this.sendEvents($W,"mouseout",$l);else{var $B,$o;($W=$Y._tEleArr).length=0,$B=this.getEles($t,null,$Y._oldArr),$o=this.getEles($d,null,$Y._newArr),$A=$B.length;var $I=0;for($i=0;$i<$A;$i++){if($k=$B[$i],0<=($I=$o.indexOf($k))){$o.splice($I,$o.length-$I);break;}$W.push($k);}0<$W.length&&this.sendEvents($W,"mouseout",$l),0<$o.length&&this.sendEvents($o,"mouseover",$l);}}},$d.onMouseMove=function($d,$t){var $l,$k;this.enable&&(($l=this.getTouchFromArr($t,this.preOvers))?(this.checkMouseOutAndOverOfMove($d,$l.tar),$l.tar=$d,$k=this.getEles($d,null,$Y._tEleArr)):($k=this.getEles($d,null,$Y._tEleArr),this.sendEvents($k,"mouseover",$t),this.preOvers.push(this.createTouchO($d,$t))),this.sendEvents($k,"mousemove",$t),this._clearTempArrs());},$d.getLastOvers=function(){return($Y._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$Y._tEleArr):($Y._tEleArr.push($q.stage),$Y._tEleArr);},$d.stageMouseOut=function(){var $d;$d=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($d,"mouseout",0);},$d.onMouseUp=function($d,$t,$l){if(void 0===$l&&($l=!1),this.enable){var $k,$W,$i,$A,$B,$o,$I=0,$b=0,$f=$V.onMobile;if($W=this.getEles($d,null,$Y._tEleArr),this.sendEvents($W,$l?"mouseup":"rightmouseup",$t),$o=$l?this.preDowns:this.preRightDowns,$k=this.getTouchFromArr($t,$o)){var $J,$c=$V.now();if($J=$c-this._lastClickTime<300,this._lastClickTime=$c,$d==$k.tar)$B=$W;else for($i=this.getEles($k.tar,null,$Y._oldArr),($B=$Y._newArr).length=0,$b=$i.length,$I=0;$I<$b;$I++)$A=$i[$I],0<=$W.indexOf($A)&&$B.push($A);0<$B.length&&this.sendEvents($B,$l?"click":"rightclick",$t),$l&&$J&&this.sendEvents($B,"doubleclick",$t),this.removeTouchFromArr($t,$o),$k.tar=null,$P.recover("TouchData",$k);}else;($k=this.getTouchFromArr($t,this.preOvers))&&$f&&(($B=this.getEles($k.tar,null,$B))&&0<$B.length&&this.sendEvents($B,"mouseout",$t),this.removeTouchFromArr($t,this.preOvers),$k.tar=null,$P.recover("TouchData",$k)),this._clearTempArrs();}},$Y._oldArr=[],$Y._newArr=[],$Y._tEleArr=[],$o($Y,["I",function(){return this.I=new $Y();}]),$Y;}(),$z=function(){function $d(){this._action=null;}$w($d,"laya.filters.Filter");var $t=$d.prototype;return $q.imps($t,{"laya.filters.IFilter":!0}),$t.callNative=function($d){},$b(0,$t,"type",function(){return-1;}),$b(0,$t,"action",function(){return this._action;}),$d.BLUR=16,$d.COLOR=32,$d.GLOW=8,$d._filterStart=null,$d._filterEnd=null,$d._EndTarget=null,$d._recycleScope=null,$d._filter=null,$d._useSrc=null,$d._endSrc=null,$d._useOut=null,$d._endOut=null,$d;}(),$g=function(){function $d(){this.data=null;}$w($d,"laya.filters.ColorFilterAction");var $t=$d.prototype;return $q.imps($t,{"laya.filters.IFilterAction":!0}),$t.apply=function($d){var $t=$d.ctx.ctx,$l=$d.ctx.ctx.canvas;if(0==$l.width||0==$l.height)return $l;for(var $k,$W=$t.getImageData(0,0,$l.width,$l.height),$i=$W.data,$A=0,$B=$i.length;$A<$B;$A+=4)$k=this.getColor($i[$A],$i[$A+1],$i[$A+2],$i[$A+3]),0!=$i[$A+3]&&($i[$A]=$k[0],$i[$A+1]=$k[1],$i[$A+2]=$k[2],$i[$A+3]=$k[3]);return $t.putImageData($W,0,0),$d;},$t.getColor=function($d,$t,$l,$k){var $W=[];if(this.data._mat&&this.data._alpha){var $i=this.data._mat,$A=this.data._alpha;$W[0]=$i[0]*$d+$i[1]*$t+$i[2]*$l+$i[3]*$k+$A[0],$W[1]=$i[4]*$d+$i[5]*$t+$i[6]*$l+$i[7]*$k+$A[1],$W[2]=$i[8]*$d+$i[9]*$t+$i[10]*$l+$i[11]*$k+$A[2],$W[3]=$i[12]*$d+$i[13]*$t+$i[14]*$l+$i[15]*$k+$A[3];}return $W;},$d;}(),$H=(function(){function $d(){}$w($d,"laya.maths.Arith"),$d.formatR=function($d){return $d>Math.PI&&($d-=2*Math.PI),$d<-Math.PI&&($d+=2*Math.PI),$d;},$d.isPOT=function($d,$t){return 0<$d&&0==($d&$d-1)&&0<$t&&0==($t&$t-1);},$d.setMatToArray=function($d,$t){$d.a,$d.b,$d.c,$d.d,$d.tx,$d.ty,$t[0]=$d.a,$t[1]=$d.b,$t[4]=$d.c,$t[5]=$d.d,$t[12]=$d.tx,$t[13]=$d.ty;};}(),function(){function $d(){this._controlPoints=[new $L(),new $L(),new $L()],this._calFun=this.getPoint2;}$w($d,"laya.maths.Bezier");var $t=$d.prototype;return $t._switchPoint=function($d,$t){var $l=this._controlPoints.shift();$l.setTo($d,$t),this._controlPoints.push($l);},$t.getPoint2=function($d,$t){var $l=this._controlPoints[0],$k=this._controlPoints[1],$W=this._controlPoints[2],$i=Math.pow(1-$d,2)*$l.x+2*$d*(1-$d)*$k.x+Math.pow($d,2)*$W.x,$A=Math.pow(1-$d,2)*$l.y+2*$d*(1-$d)*$k.y+Math.pow($d,2)*$W.y;$t.push($i,$A);},$t.getPoint3=function($d,$t){var $l=this._controlPoints[0],$k=this._controlPoints[1],$W=this._controlPoints[2],$i=this._controlPoints[3],$A=Math.pow(1-$d,3)*$l.x+3*$k.x*$d*(1-$d)*(1-$d)+3*$W.x*$d*$d*(1-$d)+$i.x*Math.pow($d,3),$B=Math.pow(1-$d,3)*$l.y+3*$k.y*$d*(1-$d)*(1-$d)+3*$W.y*$d*$d*(1-$d)+$i.y*Math.pow($d,3);$t.push($A,$B);},$t.insertPoints=function($d,$t){var $l,$k=NaN;for($l=1/($d=0<$d?$d:5),$k=0;$k<=1;$k+=$l)this._calFun($k,$t);},$t.getBezierPoints=function($d,$t,$l){void 0===$t&&($t=5),void 0===$l&&($l=2);var $k,$W,$i=0;if(($k=$d.length)<2*($l+1))return[];switch($W=[],$l){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[];}for(;this._controlPoints.length<=$l;)this._controlPoints.push(new $L());for($i=0;$i<2*$l;$i+=2)this._switchPoint($d[$i],$d[$i+1]);for($i=2*$l;$i<$k;$i+=2)this._switchPoint($d[$i],$d[$i+1]),$i/2%$l==0&&this.insertPoints($t,$W);return $W;},$o($d,["I",function(){return this.I=new $d();}]),$d;}()),$R=function(){function $I(){}return $w($I,"laya.maths.GrahamScan"),$I.multiply=function($d,$t,$l){return($d.x-$l.x)*($t.y-$l.y)-($t.x-$l.x)*($d.y-$l.y);},$I.dis=function($d,$t){return($d.x-$t.x)*($d.x-$t.x)+($d.y-$t.y)*($d.y-$t.y);},$I._getPoints=function($d,$t,$l){for(void 0===$t&&($t=!1),$I._mPointList||($I._mPointList=[]);$I._mPointList.length<$d;)$I._mPointList.push(new $L());return $l||($l=[]),$l.length=0,$t?$I.getFrom($l,$I._mPointList,$d):$I.getFromR($l,$I._mPointList,$d),$l;},$I.getFrom=function($d,$t,$l){var $k=0;for($k=0;$k<$l;$k++)$d.push($t[$k]);return $d;},$I.getFromR=function($d,$t,$l){var $k=0;for($k=0;$k<$l;$k++)$d.push($t.pop());return $d;},$I.pListToPointList=function($d,$t){void 0===$t&&($t=!1);var $l=0,$k=$d.length/2,$W=$I._getPoints($k,$t,$I._tempPointList);for($l=0;$l<$k;$l++)$W[$l].setTo($d[$l+$l],$d[$l+$l+1]);return $W;},$I.pointListToPlist=function($d){var $t,$l=0,$k=$d.length,$W=$I._temPList;for($l=$W.length=0;$l<$k;$l++)$t=$d[$l],$W.push($t.x,$t.y);return $W;},$I.scanPList=function($d){return $F.copyArray($d,$I.pointListToPlist($I.scan($I.pListToPointList($d,!0))));},$I.scan=function($d){var $t,$l,$k,$W=0,$i=0,$A=0,$B=$d.length,$o={};for(($l=$I._temArr).length=0,$W=($B=$d.length)-1;0<=$W;$W--)$k=($t=$d[$W]).x+"_"+$t.y,$o.hasOwnProperty($k)||($o[$k]=!0,$l.push($t));for($B=$l.length,$F.copyArray($d,$l),$W=1;$W<$B;$W++)($d[$W].y<$d[$A].y||$d[$W].y==$d[$A].y&&$d[$W].x<$d[$A].x)&&($A=$W);for($t=$d[0],$d[0]=$d[$A],$d[$A]=$t,$W=1;$W<$B-1;$W++){for($i=($A=$W)+1;$i<$B;$i++)(0<$I.multiply($d[$i],$d[$A],$d[0])||0==$I.multiply($d[$i],$d[$A],$d[0])&&$I.dis($d[0],$d[$i])<$I.dis($d[0],$d[$A]))&&($A=$i);$t=$d[$W],$d[$W]=$d[$A],$d[$A]=$t;}if(($l=$I._temArr).length=0,$d.length<3)return $F.copyArray($l,$d);for($l.push($d[0],$d[1],$d[2]),$W=3;$W<$B;$W++){for(;2<=$l.length&&0<=$I.multiply($d[$W],$l[$l.length-1],$l[$l.length-2]);)$l.pop();$d[$W]&&$l.push($d[$W]);}return $l;},$I._mPointList=null,$I._tempPointList=[],$I._temPList=[],$I._temArr=[],$I;}(),$G=function(){function $W(){}return $w($W,"laya.maths.MathUtil"),$W.subtractVector3=function($d,$t,$l){$l[0]=$d[0]-$t[0],$l[1]=$d[1]-$t[1],$l[2]=$d[2]-$t[2];},$W.lerp=function($d,$t,$l){return $d*(1-$l)+$t*$l;},$W.scaleVector3=function($d,$t,$l){$l[0]=$d[0]*$t,$l[1]=$d[1]*$t,$l[2]=$d[2]*$t;},$W.lerpVector3=function($d,$t,$l,$k){var $W=$d[0],$i=$d[1],$A=$d[2];$k[0]=$W+$l*($t[0]-$W),$k[1]=$i+$l*($t[1]-$i),$k[2]=$A+$l*($t[2]-$A);},$W.lerpVector4=function($d,$t,$l,$k){var $W=$d[0],$i=$d[1],$A=$d[2],$B=$d[3];$k[0]=$W+$l*($t[0]-$W),$k[1]=$i+$l*($t[1]-$i),$k[2]=$A+$l*($t[2]-$A),$k[3]=$B+$l*($t[3]-$B);},$W.slerpQuaternionArray=function($d,$t,$l,$k,$W,$i,$A){var $B,$o,$I,$b,$f,$J=$d[$t+0],$c=$d[$t+1],$Y=$d[$t+2],$w=$d[$t+3],$D=$l[$k+0],$z=$l[$k+1],$e=$l[$k+2],$g=$l[$k+3];return($o=$J*$D+$c*$z+$Y*$e+$w*$g)<0&&($o=-$o,$D=-$D,$z=-$z,$e=-$e,$g=-$g),$f=1e-6<1-$o?($B=Math.acos($o),$I=Math.sin($B),$b=Math.sin((1-$W)*$B)/$I,Math.sin($W*$B)/$I):($b=1-$W,$W),$i[$A+0]=$b*$J+$f*$D,$i[$A+1]=$b*$c+$f*$z,$i[$A+2]=$b*$Y+$f*$e,$i[$A+3]=$b*$w+$f*$g,$i;},$W.getRotation=function($d,$t,$l,$k){return Math.atan2($k-$t,$l-$d)/Math.PI*180;},$W.sortBigFirst=function($d,$t){return $d==$t?0:$d<$t?1:-1;},$W.sortSmallFirst=function($d,$t){return $d==$t?0:$d<$t?-1:1;},$W.sortNumBigFirst=function($d,$t){return parseFloat($t)-parseFloat($d);},$W.sortNumSmallFirst=function($d,$t){return parseFloat($d)-parseFloat($t);},$W.sortByKey=function($l,$d,$t){var $k;return void 0===$d&&($d=!1),void 0===$t&&($t=!0),$k=$d?$t?$W.sortNumBigFirst:$W.sortBigFirst:$t?$W.sortNumSmallFirst:$W.sortSmallFirst,function($d,$t){return $k($d[$l],$t[$l]);};},$W;}(),$S=function(){function $l($d,$t,$l,$k,$W,$i){this.inPool=!1,this.bTransform=!1,void 0===$d&&($d=1),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=1),void 0===$W&&($W=0),void 0===$i&&($i=0),this.a=$d,this.b=$t,this.c=$l,this.d=$k,this.tx=$W,this.ty=$i,this._checkTransform();}$w($l,"laya.maths.Matrix");var $d=$l.prototype;return $d.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this;},$d._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d;},$d.setTranslate=function($d,$t){return this.tx=$d,this.ty=$t,this;},$d.translate=function($d,$t){return this.tx+=$d,this.ty+=$t,this;},$d.scale=function($d,$t){this.a*=$d,this.d*=$t,this.c*=$d,this.b*=$t,this.tx*=$d,this.ty*=$t,this.bTransform=!0;},$d.rotate=function($d){var $t=Math.cos($d),$l=Math.sin($d),$k=this.a,$W=this.c,$i=this.tx;this.a=$k*$t-this.b*$l,this.b=$k*$l+this.b*$t,this.c=$W*$t-this.d*$l,this.d=$W*$l+this.d*$t,this.tx=$i*$t-this.ty*$l,this.ty=$i*$l+this.ty*$t,this.bTransform=!0;},$d.skew=function($d,$t){var $l=Math.tan($d),$k=Math.tan($t),$W=this.a,$i=this.b;return this.a+=$k*this.c,this.b+=$k*this.d,this.c+=$l*$W,this.d+=$l*$i,this;},$d.invertTransformPoint=function($d){var $t=this.a,$l=this.b,$k=this.c,$W=this.d,$i=this.tx,$A=$t*$W-$l*$k,$B=$W/$A,$o=-$l/$A,$I=-$k/$A,$b=$t/$A,$f=($k*this.ty-$W*$i)/$A,$J=-($t*this.ty-$l*$i)/$A;return $d.setTo($B*$d.x+$I*$d.y+$f,$o*$d.x+$b*$d.y+$J);},$d.transformPoint=function($d){return $d.setTo(this.a*$d.x+this.c*$d.y+this.tx,this.b*$d.x+this.d*$d.y+this.ty);},$d.transformPointN=function($d){return $d.setTo(this.a*$d.x+this.c*$d.y,this.b*$d.x+this.d*$d.y);},$d.transformPointArray=function($d,$t){for(var $l=$d.length,$k=0;$k<$l;$k+=2){var $W=$d[$k],$i=$d[$k+1];$t[$k]=this.a*$W+this.c*$i+this.tx,$t[$k+1]=this.b*$W+this.d*$i+this.ty;}return $t;},$d.transformPointArrayScale=function($d,$t){for(var $l=$d.length,$k=0;$k<$l;$k+=2){var $W=$d[$k],$i=$d[$k+1];$t[$k]=this.a*$W+this.c*$i,$t[$k+1]=this.b*$W+this.d*$i;}return $t;},$d.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b);},$d.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d);},$d.invert=function(){var $d=this.a,$t=this.b,$l=this.c,$k=this.d,$W=this.tx,$i=$d*$k-$t*$l;return this.a=$k/$i,this.b=-$t/$i,this.c=-$l/$i,this.d=$d/$i,this.tx=($l*this.ty-$k*$W)/$i,this.ty=-($d*this.ty-$t*$W)/$i,this;},$d.setTo=function($d,$t,$l,$k,$W,$i){return this.a=$d,this.b=$t,this.c=$l,this.d=$k,this.tx=$W,this.ty=$i,this;},$d.concat=function($d){var $t=this.a,$l=this.c,$k=this.tx;return this.a=$t*$d.a+this.b*$d.c,this.b=$t*$d.b+this.b*$d.d,this.c=$l*$d.a+this.d*$d.c,this.d=$l*$d.b+this.d*$d.d,this.tx=$k*$d.a+this.ty*$d.c+$d.tx,this.ty=$k*$d.b+this.ty*$d.d+$d.ty,this;},$d.scaleEx=function($d,$t){var $l=this.a,$k=this.b,$W=this.c,$i=this.d;0!==$k||0!==$W?(this.a=$d*$l,this.b=$d*$k,this.c=$t*$W):(this.a=$d*$l,this.b=0*$i,this.c=0*$l),this.d=$t*$i,this.bTransform=!0;},$d.rotateEx=function($d){var $t=Math.cos($d),$l=Math.sin($d),$k=this.a,$W=this.b,$i=this.c,$A=this.d;0!==$W||0!==$i?(this.a=$t*$k+$l*$i,this.b=$t*$W+$l*$A,this.c=-$l*$k+$t*$i,this.d=-$l*$W+$t*$A):(this.a=$t*$k,this.b=$l*$A,this.c=-$l*$k,this.d=$t*$A),this.bTransform=!0;},$d.clone=function(){var $d=$l.create();return $d.a=this.a,$d.b=this.b,$d.c=this.c,$d.d=this.d,$d.tx=this.tx,$d.ty=this.ty,$d.bTransform=this.bTransform,$d;},$d.copyTo=function($d){return $d.a=this.a,$d.b=this.b,$d.c=this.c,$d.d=this.d,$d.tx=this.tx,$d.ty=this.ty,$d.bTransform=this.bTransform,$d;},$d.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty;},$d.destroy=function(){if(!this.inPool){var $d=$l._cache;this.inPool=!0,$d._length||($d._length=0),($d[$d._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1;}},$l.mul=function($d,$t,$l){var $k=$d.a,$W=$d.b,$i=$d.c,$A=$d.d,$B=$d.tx,$o=$d.ty,$I=$t.a,$b=$t.b,$f=$t.c,$J=$t.d,$c=$t.tx,$Y=$t.ty;return 0!==$b||0!==$f?($l.a=$k*$I+$W*$f,$l.b=$k*$b+$W*$J,$l.c=$i*$I+$A*$f,$l.d=$i*$b+$A*$J,$l.tx=$I*$B+$f*$o+$c,$l.ty=$b*$B+$J*$o+$Y):($l.a=$k*$I,$l.b=$W*$J,$l.c=$i*$I,$l.d=$A*$J,$l.tx=$I*$B+$c,$l.ty=$J*$o+$Y),$l;},$l.mul16=function($d,$t,$l){var $k=$d.a,$W=$d.b,$i=$d.c,$A=$d.d,$B=$d.tx,$o=$d.ty,$I=$t.a,$b=$t.b,$f=$t.c,$J=$t.d,$c=$t.tx,$Y=$t.ty;return 0!==$b||0!==$f?($l[0]=$k*$I+$W*$f,$l[1]=$k*$b+$W*$J,$l[4]=$i*$I+$A*$f,$l[5]=$i*$b+$A*$J,$l[12]=$I*$B+$f*$o+$c,$l[13]=$b*$B+$J*$o+$Y):($l[0]=$k*$I,$l[1]=$W*$J,$l[4]=$i*$I,$l[5]=$A*$J,$l[12]=$I*$B+$c,$l[13]=$J*$o+$Y),$l;},$l.mulPre=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=$d.a,$I=$d.b,$b=$d.c,$f=$d.d,$J=$d.tx,$c=$d.ty;return 0!==$l||0!==$k?($B.a=$o*$t+$I*$k,$B.b=$o*$l+$I*$W,$B.c=$b*$t+$f*$k,$B.d=$b*$l+$f*$W,$B.tx=$t*$J+$k*$c+$i,$B.ty=$l*$J+$W*$c+$A):($B.a=$o*$t,$B.b=$I*$W,$B.c=$b*$t,$B.d=$f*$W,$B.tx=$t*$J+$i,$B.ty=$W*$c+$A),$B;},$l.mulPos=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=$d.a,$I=$d.b,$b=$d.c,$f=$d.d,$J=$d.tx,$c=$d.ty;return 0!==$I||0!==$b?($B.a=$t*$o+$l*$b,$B.b=$t*$I+$l*$f,$B.c=$k*$o+$W*$b,$B.d=$k*$I+$W*$f,$B.tx=$o*$i+$b*$A+$J,$B.ty=$I*$i+$f*$A+$c):($B.a=$t*$o,$B.b=$l*$f,$B.c=$k*$o,$B.d=$W*$f,$B.tx=$o*$i+$J,$B.ty=$f*$A+$c),$B;},$l.preMul=function($d,$t,$l){var $k=$d.a,$W=$d.b,$i=$d.c,$A=$d.d,$B=$t.a,$o=$t.b,$I=$t.c,$b=$t.d,$f=$t.tx,$J=$t.ty;return $l.a=$B*$k,$l.b=$l.c=0,$l.d=$b*$A,$l.tx=$f*$k+$d.tx,$l.ty=$J*$A+$d.ty,0===$o&&0===$I&&0===$W&&0===$i||($l.a+=$o*$i,$l.d+=$I*$W,$l.b+=$B*$W+$o*$A,$l.c+=$I*$k+$b*$i,$l.tx+=$J*$i,$l.ty+=$f*$W),$l;},$l.preMulXY=function($d,$t,$l,$k){var $W=$d.a,$i=$d.b,$A=$d.c,$B=$d.d;return $k.a=$W,$k.b=$i,$k.c=$A,$k.d=$B,$k.tx=$t*$W+$d.tx+$l*$A,$k.ty=$l*$B+$d.ty+$t*$i,$k;},$l.create=function(){var $d=$l._cache,$t=$d._length?$d[--$d._length]:new $l();return $t.inPool=!1,$t;},$l.EMPTY=new $l(),$l.TEMP=new $l(),$l._cache=[],$l;}(),$L=function(){function $d($d,$t){void 0===$d&&($d=0),void 0===$t&&($t=0),this.x=$d,this.y=$t;}$w($d,"laya.maths.Point");var $t=$d.prototype;return $t.setTo=function($d,$t){return this.x=$d,this.y=$t,this;},$t.distance=function($d,$t){return Math.sqrt((this.x-$d)*(this.x-$d)+(this.y-$t)*(this.y-$t));},$t.toString=function(){return this.x+","+this.y;},$t.normalize=function(){var $d=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$d){var $t=1/$d;this.x*=$t,this.y*=$t;}},$d.TEMP=new $d(),$d.EMPTY=new $d(),$d;}(),$$=function(){function $I($d,$t,$l,$k){void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),this.x=$d,this.y=$t,this.width=$l,this.height=$k;}$w($I,"laya.maths.Rectangle");var $d=$I.prototype;return $d.setTo=function($d,$t,$l,$k){return this.x=$d,this.y=$t,this.width=$l,this.height=$k,this;},$d.copyFrom=function($d){return this.x=$d.x,this.y=$d.y,this.width=$d.width,this.height=$d.height,this;},$d.contains=function($d,$t){return!(this.width<=0||this.height<=0)&&$d>=this.x&&$d<this.right&&$t>=this.y&&$t<this.bottom;},$d.intersects=function($d){return!($d.x>this.x+this.width||$d.x+$d.width<this.x||$d.y>this.y+this.height||$d.y+$d.height<this.y);},$d.intersection=function($d,$t){return this.intersects($d)?($t||($t=new $I()),$t.x=Math.max(this.x,$d.x),$t.y=Math.max(this.y,$d.y),$t.width=Math.min(this.right,$d.right)-$t.x,$t.height=Math.min(this.bottom,$d.bottom)-$t.y,$t):null;},$d.union=function($d,$t){return $t||($t=new $I()),this.clone($t),$d.width<=0||$d.height<=0?$t:($t.addPoint($d.x,$d.y),$t.addPoint($d.right,$d.bottom),this);},$d.clone=function($d){return $d||($d=new $I()),$d.x=this.x,$d.y=this.y,$d.width=this.width,$d.height=this.height,$d;},$d.toString=function(){return this.x+","+this.y+","+this.width+","+this.height;},$d.equals=function($d){return!(!$d||$d.x!==this.x||$d.y!==this.y||$d.width!==this.width||$d.height!==this.height);},$d.addPoint=function($d,$t){return this.x>$d&&(this.width+=this.x-$d,this.x=$d),this.y>$t&&(this.height+=this.y-$t,this.y=$t),this.width<$d-this.x&&(this.width=$d-this.x),this.height<$t-this.y&&(this.height=$t-this.y),this;},$d._getBoundPoints=function(){var $d=$I._temB;return($d.length=0)==this.width||0==this.height||$d.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$d;},$d.isEmpty=function(){return this.width<=0||this.height<=0;},$b(0,$d,"right",function(){return this.x+this.width;}),$b(0,$d,"bottom",function(){return this.y+this.height;}),$I._getBoundPointS=function($d,$t,$l,$k){var $W=$I._temA;return($W.length=0)==$l||0==$k||$W.push($d,$t,$d+$l,$t,$d,$t+$k,$d+$l,$t+$k),$W;},$I._getWrapRec=function($d,$t){if(!$d||$d.length<1)return $t?$t.setTo(0,0,0,0):$I.TEMP.setTo(0,0,0,0);$t=$t||new $I();var $l,$k,$W,$i,$A,$B=$d.length,$o=$L.TEMP;for($W=$A=-($k=$i=99999),$l=0;$l<$B;$l+=2)$o.x=$d[$l],$o.y=$d[$l+1],$k=$k<$o.x?$k:$o.x,$i=$i<$o.y?$i:$o.y,$W=$W>$o.x?$W:$o.x,$A=$A>$o.y?$A:$o.y;return $t.setTo($k,$i,$W-$k,$A-$i);},$I.EMPTY=new $I(),$I.TEMP=new $I(),$I._temB=[],$I._temA=[],$I;}(),$T=function(){function $o(){}return $w($o,"laya.media.SoundManager"),$b(1,$o,"useAudioMusic",function(){return $o._useAudioMusic;},function($d){$o._useAudioMusic=$d,$o._musicClass=$d?$ld:null;}),$b(1,$o,"autoStopMusic",function(){return $o._autoStopMusic;},function($d){$q.stage.off("blur",null,$o._stageOnBlur),$q.stage.off("focus",null,$o._stageOnFocus),$q.stage.off("visibilitychange",null,$o._visibilityChange),($o._autoStopMusic=$d)&&($q.stage.on("blur",null,$o._stageOnBlur),$q.stage.on("focus",null,$o._stageOnFocus),$q.stage.on("visibilitychange",null,$o._visibilityChange));}),$b(1,$o,"muted",function(){return $o._muted;},function($d){$d!=$o._muted&&($d&&$o.stopAllSound(),$o.musicMuted=$d,$o._muted=$d);}),$b(1,$o,"musicMuted",function(){return $o._musicMuted;},function($d){$d!=$o._musicMuted&&($d?($o._tMusic&&$o._musicChannel&&!$o._musicChannel.isStopped?$o._musicChannel.pause():$o._musicChannel=null,$o._musicMuted=$d):($o._musicMuted=$d,$o._tMusic&&$o._musicChannel&&$o._musicChannel.resume()));}),$b(1,$o,"soundMuted",function(){return $o._soundMuted;},function($d){$o._soundMuted=$d;}),$o.addChannel=function($d){0<=$o._channels.indexOf($d)||($o._channels.push($d),$o.autoReleaseSound&&0!=$o._notUsedCount&&$o._notUsedUrls[$d.url]&&(delete $o._notUsedUrls[$d.url],0==--$o._notUsedCount&&$q.timer.clear($o,$o.disposeSoundIfNotUsed)));},$o.removeChannel=function($d){var $t=$o._channels,$l=$t.indexOf($d);if(-1!=$l&&($t.splice($l,1),$o.autoReleaseSound)){var $k=$d.url,$W=$o.defaultIntervals[$k]||2e4;if(0<$W){var $i=!0;for($l=$t.length-1;0<=$l;$l--)if($t[$l].url==$k){$i=!1;break;}$i&&($o._notUsedUrls[$k]=Date.now()+$W,0==$o._notUsedCount++&&$q.timer.loop(1e4,$o,$o.disposeSoundIfNotUsed));}}},$o.disposeSoundIfNotUsed=function(){var $d=$o._notUsedUrls;if(0!=$o._notUsedCount){var $t=Date.now();for(var $l in $d)$t>=$d[$l]&&(delete $d[$l],--$o._notUsedCount,$o.destroySound($l));if(0!=$o._notUsedCount)return;}$q.timer.clear($o,$o.disposeSoundIfNotUsed);},$o._visibilityChange=function(){$q.stage.isVisibility?$o._stageOnFocus():$o._stageOnBlur();},$o._stageOnBlur=function(){$o._isActive=!1,$o._musicChannel&&($o._musicChannel.isStopped||($o._blurPaused=!0,$o._musicChannel.pause())),$o.stopAllSound(),$q.stage.once("mousedown",null,$o._stageOnFocus);},$o._recoverWebAudio=function(){$id.ctx&&"running"!=$id.ctx.state&&$id.ctx.resume&&$id.ctx.resume();},$o._stageOnFocus=function(){if($o._isActive=!0,$o._recoverWebAudio(),$q.stage.off("mousedown",null,$o._stageOnFocus),$o._blurPaused){var $d=$o._musicChannel;$d&&$o._music&&$d.isStopped&&($o._blurPaused=!1,$o._music._disposed?$o.playMusic($d.url,$d.loops,$d.startHandler,$d.completeHandler,$d.startTime):$d.audioBuffer?$d.resume():$o._music.play($d.startTime,$d.loops,$d.startHandler,$d));}},$o.playSound=function($d,$t,$l,$k,$W,$i){if(void 0===$t&&($t=1),void 0===$i&&($i=0),!$d)return null;if($o._muted)return null;if($o._recoverWebAudio(),$d==$o._tMusic){if($o._musicMuted)return null;}else{if(!$o._isActive)return null;if($o._soundMuted)return null;}var $A,$B=$o._pool[$d];return $W||($W=$o._soundClass),$B||(($B=new $W()).load($d),$o._pool[$d]=$B),($A=$B.play($i,$t,$l))?($d==$o._tMusic&&($o._music=$B,$o._isActive||($o._blurPaused=!0,$A.pause())),$A.url=$d,$A.volume=$d==$o._tMusic?$o.musicVolume:$o.soundVolume,$A.completeHandler=$k,$A):null;},$o.destroySound=function($d){var $t=$o._pool[$d];$t&&(delete $o._pool[$d],$t.dispose());},$o.playMusic=function($d,$t,$l,$k,$W){return void 0===$t&&($t=0),void 0===$W&&($W=0),$o._tMusic=$d,$o._musicChannel&&$o._musicChannel.stop(),$o._musicChannel=$o.playSound($d,$t,$l,$k,null,$W);},$o.stopSound=function($d){for(var $t,$l=$o._channels.length-1;0<=$l;$l--)($t=$o._channels[$l]).url==$d&&$t.stop();},$o.stopAll=function(){$o._tMusic=null;var $d=0;for($d=$o._channels.length-1;0<=$d;$d--)$o._channels[$d].stop();},$o.stopAllSound=function(){var $d,$t=0;for($t=$o._channels.length-1;0<=$t;$t--)($d=$o._channels[$t]).url!=$o._tMusic&&$d.stop();},$o.stopMusic=function(){$o._musicChannel&&$o._musicChannel.stop(),$o._tMusic=null;},$o.setSoundVolume=function($d,$t){if($t)$o._setVolume($t,$d);else{$o.soundVolume=$d;var $l,$k=0;for($k=$o._channels.length-1;0<=$k;$k--)($l=$o._channels[$k]).url!=$o._tMusic&&($l.volume=$d);}},$o.setMusicVolume=function($d){$o.musicVolume=$d,$o._setVolume($o._tMusic,$d);},$o._setVolume=function($d,$t){for(var $l,$k=$o._channels.length-1;0<=$k;$k--)($l=$o._channels[$k]).url==$d&&($l.volume=$t);},$o.musicVolume=1,$o.soundVolume=1,$o.playbackRate=1,$o._useAudioMusic=!0,$o._muted=!1,$o._soundMuted=!1,$o._musicMuted=!1,$o._tMusic=null,$o._musicChannel=null,$o._music=null,$o._channels=[],$o._autoStopMusic=!1,$o._blurPaused=!1,$o._isActive=!0,$o._soundClass=null,$o._musicClass=null,$o.autoReleaseSound=!0,$o._pool={},$o.defaultIntervals={},$o._notUsedUrls={},$o._notUsedCount=0,$o;}(),$p=function(){var $d;function $l(){}return $w($l,"laya.net.LocalStorage"),$l.__init__=function(){$l._baseClass||($l._baseClass=$d).init(),$l.items=$l._baseClass.items,$l.support=$l._baseClass.support;},$l.setItem=function($d,$t){$l._baseClass.setItem($d,$t);},$l.getItem=function($d){return $l._baseClass.getItem($d);},$l.setJSON=function($d,$t){$l._baseClass.setJSON($d,$t);},$l.getJSON=function($d){return $l._baseClass.getJSON($d);},$l.removeItem=function($d){$l._baseClass.removeItem($d);},$l.clear=function(){$l._baseClass.clear();},$l._baseClass=null,$l.items=null,$l.support=!1,$l.__init$=function(){$d=function(){function $l(){}return $w($l,""),$l.init=function(){try{$l.support=!0,$l.items=$A.localStorage,$l.setItem("laya","1"),$l.removeItem("laya");}catch($d){$l.support=!1;}$l.support||console.log("LocalStorage is not supprot or browser is private mode.");},$l.setItem=function($d,$t){try{$l.support&&$l.items.setItem($d,$t);}catch($d){console.warn("set localStorage failed",$d);}},$l.getItem=function($d){return $l.support?$l.items.getItem($d):null;},$l.setJSON=function($d,$t){try{$l.support&&$l.items.setItem($d,JSON.stringify($t));}catch($d){console.warn("set localStorage failed",$d);}},$l.getJSON=function($d){return JSON.parse($l.support?$l.items.getItem($d):null);},$l.removeItem=function($d){$l.support&&$l.items.removeItem($d);},$l.clear=function(){$l.support&&$l.items.clear();},$l.items=null,$l.support=!1,$l;}();},$l;}(),$j=(function(){function $k(){}$w($k,"laya.net.ResourceVersion"),$k.enable=function($d,$t,$l){void 0===$l&&($l=2),laya.net.ResourceVersion.type=$l,$q.loader.load($d,$e.create(null,$k.onManifestLoaded,[$t]),null,"json"),$C.customFormat=$k.addVersionPrefix;},$k.onManifestLoaded=function($d,$t){$k.manifest=$t,$d.run(),$t||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");},$k.addVersionPrefix=function($d){return $k.manifest&&$k.manifest[$d]?2==$k.type?$k.manifest[$d]:$k.manifest[$d]+"/"+$d:$d;},$k.FOLDER_VERSION=1,$k.FILENAME_VERSION=2,$k.manifest=null,$k.type=1;}(),function(){function $d(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null;}$w($d,"laya.net.TTFLoader");var $t=$d.prototype;return $t.load=function($d){var $t=(this._url=$d).split(".ttf")[0].split("/");this.fontName=$t[$t.length-1],$V.window.conch?this._loadConch():$V.window.FontFace?this._loadWithFontFace():this._loadWithCSS();},$t._loadConch=function(){this._http=new $Ad(),this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer");},$t._onHttpLoaded=function($d){$V.window.conch.setFontFaceFromBuffer(this.fontName,$d),this._clearHttp(),this._complete();},$t._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null);},$t._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null);},$t._complete=function(){$q.timer.clear(this,this._complete),$q.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null);},$t._checkComplete=function(){$r.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete();},$t._loadWithFontFace=function(){var $d=new $V.window.FontFace(this.fontName,"url('"+this._url+"')");$V.window.document.fonts.add($d);var $t=this;$d.loaded.then(function(){$t._complete();}),$d.load();},$t._createDiv=function(){this._div=$V.createElement("div"),this._div.innerHTML="laya";var $d=this._div.style;$d.fontFamily=this.fontName,$d.position="absolute",$d.left="-100px",$d.top="-100px",$V.document.body.appendChild(this._div);},$t._loadWithCSS=function(){var $d=this,$t=$V.createElement("style");$t.type="text/css",$V.document.body.appendChild($t),$t.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$r.measureText("LayaTTFFont",this._fontTxt).width;var $l=this;$t.onload=function(){$q.timer.once(1e4,$l,$d._complete);},$q.timer.loop(20,this,this._checkComplete),this._createDiv();},$d._testString="LayaTTFFont",$d;}()),$C=function(){function $k($d){this._url=null,this._path=null,this._url=$k.formatURL($d),this._path=$k.getPath($d);}$w($k,"laya.net.URL");var $d=$k.prototype;return $b(0,$d,"path",function(){return this._path;}),$b(0,$d,"url",function(){return this._url;}),$k.formatURL=function($d,$t){if(!$d)return"null path";if(0<$d.indexOf(":"))return $d;null!=$k.customFormat&&($d=$k.customFormat($d,$t));var $l=$d.charAt(0);if("."===$l)return $k.formatRelativePath(($t||$k.basePath)+$d);if("~"===$l)return $k.rootPath+$d.substring(1);if("d"===$l){if(0===$d.indexOf("data:image"))return $d;}else if("/"===$l)return $d;return($t||$k.basePath)+$d;},$k.formatRelativePath=function($d){for(var $t=$d.split("/"),$l=0,$k=$t.length;$l<$k;$l++)".."==$t[$l]&&($t.splice($l-1,2),$l-=2);return $t.join("/");},$k.isAbsolute=function($d){return 0<$d.indexOf(":")||"/"==$d.charAt(0);},$k.getPath=function($d){var $t=$d.lastIndexOf("/");return 0<$t?$d.substr(0,$t+1):"";},$k.getFileName=function($d){var $t=$d.lastIndexOf("/");return 0<$t?$d.substr($t+1):$d;},$k.version={},$k.basePath="",$k.rootPath="",$k.customFormat=function($d){var $t=$k.version[$d];return!$K.isConchApp&&$t&&($d+="?v="+$t),$d;},$k;}(),$K=function(){function $W($d,$t){this._timeId=0;var $l=$W._mainCanvas.source.style;$l.position="absolute",$l.top=$l.left="0px",$l.background="#000000",$W._mainCanvas.source.id="layaCanvas";var $k=laya.renders.Render.isWebGL;$W._mainCanvas.source.width=$d,$W._mainCanvas.source.height=$t,$k&&$W.WebGL.init($W._mainCanvas,$d,$t),$V.container.appendChild($W._mainCanvas.source),($W._context=new $x($d,$t,$k?null:$W._mainCanvas)).ctx.setIsMainContext(),$V.window.requestAnimationFrame(function $d($t){$V.window.requestAnimationFrame($d);$q.stage._loop();}),$q.stage.on("visibilitychange",this,this._onVisibilitychange);}$w($W,"laya.renders.Render");var $d=$W.prototype;return $d._onVisibilitychange=function(){$q.stage.isVisibility?0!=this._timeId&&$V.window.clearInterval(this._timeId):this._timeId=$V.window.setInterval(this._enterFrame,1e3);},$d._enterFrame=function($d){$q.stage._loop();},$b(1,$W,"context",function(){return $W._context;}),$b(1,$W,"canvas",function(){return $W._mainCanvas.source;}),$W._context=null,$W._mainCanvas=null,$W.WebGL=null,$W.isConchNode=!1,$W.isConchApp=!1,$W.isConchWebGL=!1,$W.isWebGL=!1,$W.is3DMode=!1,$W.optimizeTextureMemory=function($d,$t){return!0;},$W.__init$=function(){$A.ConchRenderType=$A.ConchRenderType||1,$A.ConchRenderType|=$A.conch?4:0,$W.isConchNode=5==(5&$A.ConchRenderType),$W.isConchApp=4==(4&$A.ConchRenderType),$W.isConchWebGL=6==$A.ConchRenderType;},$W;}(),$x=function(){function $A($d,$t,$l){this.x=0,this.y=0,this._drawTexture=function($d,$t,$l){$l[0].loaded&&this.ctx.drawTexture($l[0],$l[1],$l[2],$l[3],$l[4],$d,$t);},this._fillTexture=function($d,$t,$l){$l[0].loaded&&this.ctx.fillTexture($l[0],$l[1]+$d,$l[2]+$t,$l[3],$l[4],$l[5],$l[6],$l[7]);},this._drawTextureWithTransform=function($d,$t,$l){$l[0].loaded&&this.ctx.drawTextureWithTransform($l[0],$l[1],$l[2],$l[3],$l[4],$l[5],$d,$t,$l[6]);},this._fillQuadrangle=function($d,$t,$l){this.ctx.fillQuadrangle($l[0],$l[1],$l[2],$l[3],$l[4]);},this._drawRect=function($d,$t,$l){var $k=this.ctx;null!=$l[4]&&($k.fillStyle=$l[4],$k.fillRect($d+$l[0],$t+$l[1],$l[2],$l[3],null)),null!=$l[5]&&($k.strokeStyle=$l[5],$k.lineWidth=$l[6],$k.strokeRect($d+$l[0],$t+$l[1],$l[2],$l[3],$l[6]));},this._drawPie=function($d,$t,$l){var $k=this.ctx;$K.isWebGL&&$k.setPathId($l[8]),$k.beginPath(),$K.isWebGL?($k.movePath($l[0]+$d,$l[1]+$t),$k.moveTo(0,0)):$k.moveTo($d+$l[0],$t+$l[1]),$k.arc($d+$l[0],$t+$l[1],$l[2],$l[3],$l[4]),$k.closePath(),this._fillAndStroke($l[5],$l[6],$l[7],!0);},this._clipRect=function($d,$t,$l){this.ctx.clipRect($d+$l[0],$t+$l[1],$l[2],$l[3]);},this._fillRect=function($d,$t,$l){this.ctx.fillRect($d+$l[0],$t+$l[1],$l[2],$l[3],$l[4]);},this._drawCircle=function($d,$t,$l){var $k=this.ctx;$K.isWebGL&&$k.setPathId($l[6]),$X.drawCall++,$k.beginPath(),$K.isWebGL&&$k.movePath($l[0]+$d,$l[1]+$t),$k.arc($l[0]+$d,$l[1]+$t,$l[2],0,$A.PI2),$k.closePath(),this._fillAndStroke($l[3],$l[4],$l[5],!0);},this._fillCircle=function($d,$t,$l){$X.drawCall++;var $k=this.ctx;$k.beginPath(),$k.fillStyle=$l[3],$k.arc($l[0]+$d,$l[1]+$t,$l[2],0,$A.PI2),$k.fill();},this._setShader=function($d,$t,$l){this.ctx.setShader($l[0]);},this._drawLine=function($d,$t,$l){var $k=this.ctx;$K.isWebGL&&$k.setPathId($l[6]),$k.beginPath(),$k.strokeStyle=$l[4],$k.lineWidth=$l[5],$K.isWebGL?($k.movePath($d,$t),$k.moveTo($l[0],$l[1]),$k.lineTo($l[2],$l[3])):($k.moveTo($d+$l[0],$t+$l[1]),$k.lineTo($d+$l[2],$t+$l[3])),$k.stroke();},this._drawLines=function($d,$t,$l){var $k=this.ctx;$K.isWebGL&&$k.setPathId($l[5]),$k.beginPath(),$d+=$l[0],$t+=$l[1],$K.isWebGL&&$k.movePath($d,$t),$k.strokeStyle=$l[3],$k.lineWidth=$l[4];var $W=$l[2],$i=2,$A=$W.length;if($K.isWebGL)for($k.moveTo($W[0],$W[1]);$i<$A;)$k.lineTo($W[$i++],$W[$i++]);else for($k.moveTo($d+$W[0],$t+$W[1]);$i<$A;)$k.lineTo($d+$W[$i++],$t+$W[$i++]);$k.stroke();},this._drawLinesWebGL=function($d,$t,$l){this.ctx.drawLines($d+this.x+$l[0],$t+this.y+$l[1],$l[2],$l[3],$l[4]);},this._drawCurves=function($d,$t,$l){this.ctx.drawCurves($d,$t,$l);},this._draw=function($d,$t,$l){$l[0].call(null,this,$d,$t);},this._transformByMatrix=function($d,$t,$l){this.ctx.transformByMatrix($l[0]);},this._setTransform=function($d,$t,$l){this.ctx.setTransform($l[0],$l[1],$l[2],$l[3],$l[4],$l[5]);},this._setTransformByMatrix=function($d,$t,$l){this.ctx.setTransformByMatrix($l[0]);},this._save=function($d,$t,$l){this.ctx.save();},this._restore=function($d,$t,$l){this.ctx.restore();},this._translate=function($d,$t,$l){this.ctx.translate($l[0],$l[1]);},this._transform=function($d,$t,$l){this.ctx.translate($l[1]+$d,$l[2]+$t);var $k=$l[0];this.ctx.transform($k.a,$k.b,$k.c,$k.d,$k.tx,$k.ty),this.ctx.translate(-$d-$l[1],-$t-$l[2]);},this._rotate=function($d,$t,$l){this.ctx.translate($l[1]+$d,$l[2]+$t),this.ctx.rotate($l[0]),this.ctx.translate(-$d-$l[1],-$t-$l[2]);},this._scale=function($d,$t,$l){this.ctx.translate($l[2]+$d,$l[3]+$t),this.ctx.scale($l[0],$l[1]),this.ctx.translate(-$d-$l[2],-$t-$l[3]);},this._alpha=function($d,$t,$l){this.ctx.globalAlpha*=$l[0];},this._setAlpha=function($d,$t,$l){this.ctx.globalAlpha=$l[0];},this._fillText=function($d,$t,$l){this.ctx.fillText($l[0],$l[1]+$d,$l[2]+$t,$l[3],$l[4],$l[5]);},this._strokeText=function($d,$t,$l){this.ctx.strokeText($l[0],$l[1]+$d,$l[2]+$t,$l[3],$l[4],$l[5],$l[6]);},this._fillBorderText=function($d,$t,$l){this.ctx.fillBorderText($l[0],$l[1]+$d,$l[2]+$t,$l[3],$l[4],$l[5],$l[6],$l[7]);},this._blendMode=function($d,$t,$l){this.ctx.globalCompositeOperation=$l[0];},this._beginClip=function($d,$t,$l){this.ctx.beginClip&&this.ctx.beginClip($d+$l[0],$t+$l[1],$l[2],$l[3]);},this._setIBVB=function($d,$t,$l){this.ctx.setIBVB($l[0]+$d,$l[1]+$t,$l[2],$l[3],$l[4],$l[5],$l[6],$l[7]);},this._fillTrangles=function($d,$t,$l){this.ctx.fillTrangles($l[0],$l[1]+$d,$l[2]+$t,$l[3],$l[4]);},this._drawPath=function($d,$t,$l){var $k=this.ctx;$K.isWebGL&&$k.setPathId(-1),$k.beginPath(),$d+=$l[0],$t+=$l[1],$K.isWebGL&&$k.movePath($d,$t);for(var $W=$l[2],$i=0,$A=$W.length;$i<$A;$i++){var $B=$W[$i];switch($B[0]){case"moveTo":$K.isWebGL?$k.moveTo($B[1],$B[2]):$k.moveTo($d+$B[1],$t+$B[2]);break;case"lineTo":$K.isWebGL?$k.lineTo($B[1],$B[2]):$k.lineTo($d+$B[1],$t+$B[2]);break;case"arcTo":$K.isWebGL?$k.arcTo($B[1],$B[2],$B[3],$B[4],$B[5]):$k.arcTo($d+$B[1],$t+$B[2],$d+$B[3],$t+$B[4],$B[5]);break;case"closePath":$k.closePath();}}var $o=$l[3];null!=$o&&($k.fillStyle=$o.fillStyle,$k.fill());var $I=$l[4];null!=$I&&($k.strokeStyle=$I.strokeStyle,$k.lineWidth=$I.lineWidth||1,$k.lineJoin=$I.lineJoin,$k.lineCap=$I.lineCap,$k.miterLimit=$I.miterLimit,$k.stroke());},this.drawPoly=function($d,$t,$l){this.ctx.drawPoly($d+this.x+$l[0],$t+this.y+$l[1],$l[2],$l[3],$l[4],$l[5],$l[6]);},this._drawPoly=function($d,$t,$l){var $k=this.ctx,$W=$l[2],$i=2,$A=$W.length;if($K.isWebGL)for($k.setPathId($l[6]),$k.beginPath(),$d+=$l[0],$t+=$l[1],$k.movePath($d,$t),$k.moveTo($W[0],$W[1]);$i<$A;)$k.lineTo($W[$i++],$W[$i++]);else for($k.beginPath(),$d+=$l[0],$t+=$l[1],$k.moveTo($d+$W[0],$t+$W[1]);$i<$A;)$k.lineTo($d+$W[$i++],$t+$W[$i++]);$k.closePath(),this._fillAndStroke($l[3],$l[4],$l[5],$l[7]);},this._drawSkin=function($d,$t,$l){var $k=$l[0];if($k){var $W=this.ctx;$k.render($W,$d,$t);}},this._drawParticle=function($d,$t,$l){this.ctx.drawParticle($d+this.x,$t+this.y,$l[0]);},this._setFilters=function($d,$t,$l){this.ctx.setFilters($l);},$l?this.ctx=$l.getContext("2d"):($l=$gd.create("3D"),this.ctx=$r.createWebGLContext2D($l),$l._setContext(this.ctx)),$l.size($d,$t),this.canvas=$l;}$w($A,"laya.renders.RenderContext");var $d=$A.prototype;return $d.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null);},$d.drawTexture=function($d,$t,$l,$k,$W){$d.loaded&&this.ctx.drawTexture($d,$t,$l,$k,$W,this.x,this.y);},$d._drawTextures=function($d,$t,$l){$l[0].loaded&&this.ctx.drawTextures($l[0],$l[1],$d+this.x,$t+this.y);},$d.drawTextureWithTransform=function($d,$t,$l,$k,$W,$i,$A){$d.loaded&&this.ctx.drawTextureWithTransform($d,$t,$l,$k,$W,$i,this.x,this.y,$A);},$d.fillQuadrangle=function($d,$t,$l,$k,$W){this.ctx.fillQuadrangle($d,$t,$l,$k,$W);},$d.drawCanvas=function($d,$t,$l,$k,$W){this.ctx.drawCanvas($d,$t+this.x,$l+this.y,$k,$W);},$d.drawRect=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=1);var $A=this.ctx;$A.strokeStyle=$W,$A.lineWidth=$i,$A.strokeRect($d+this.x,$t+this.y,$l,$k,$i);},$d._fillAndStroke=function($d,$t,$l,$k){void 0===$k&&($k=!1);var $W=this.ctx;null!=$d&&($W.fillStyle=$d,$K.isWebGL?$W.fill($k):$W.fill()),null!=$t&&0<$l&&($W.strokeStyle=$t,$W.lineWidth=$l,$W.stroke());},$d.clipRect=function($d,$t,$l,$k){this.ctx.clipRect($d+this.x,$t+this.y,$l,$k);},$d.fillRect=function($d,$t,$l,$k,$W){this.ctx.fillRect($d+this.x,$t+this.y,$l,$k,$W);},$d.drawCircle=function($d,$t,$l,$k,$W){void 0===$W&&($W=1),$X.drawCall++;var $i=this.ctx;$i.beginPath(),$i.strokeStyle=$k,$i.lineWidth=$W,$i.arc($d+this.x,$t+this.y,$l,0,$A.PI2),$i.stroke();},$d.drawTriangles=function($d,$t,$l){if($K.isWebGL)this.ctx.drawTriangles($l[0],$d+$l[1],$t+$l[2],$l[3],$l[4],$l[5],$l[6],$l[7],$l[8],$l[9]);else{var $k=$l[5],$W=0,$i=$k.length,$A=this.ctx;for($W=0;$W<$i;$W+=3){var $B=2*$k[$W],$o=2*$k[$W+1],$I=2*$k[$W+2];$A.drawTriangle($l[0],$l[3],$l[4],$B,$o,$I,$l[6],!0);}}},$d.fillCircle=function($d,$t,$l,$k){$X.drawCall++;var $W=this.ctx;$W.beginPath(),$W.fillStyle=$k,$W.arc($d+this.x,$t+this.y,$l,0,$A.PI2),$W.fill();},$d.setShader=function($d){this.ctx.setShader($d);},$d.drawLine=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=1);var $A=this.ctx;$A.beginPath(),$A.strokeStyle=$W,$A.lineWidth=$i,$A.moveTo(this.x+$d,this.y+$t),$A.lineTo(this.x+$l,this.y+$k),$A.stroke();},$d.clear=function(){this.ctx.clear();},$d.transformByMatrix=function($d){this.ctx.transformByMatrix($d);},$d.setTransform=function($d,$t,$l,$k,$W,$i){this.ctx.setTransform($d,$t,$l,$k,$W,$i);},$d.setTransformByMatrix=function($d){this.ctx.setTransformByMatrix($d);},$d.save=function(){this.ctx.save();},$d.restore=function(){this.ctx.restore();},$d.translate=function($d,$t){this.ctx.translate($d,$t);},$d.transform=function($d,$t,$l,$k,$W,$i){this.ctx.transform($d,$t,$l,$k,$W,$i);},$d.rotate=function($d){this.ctx.rotate($d);},$d.scale=function($d,$t){this.ctx.scale($d,$t);},$d.alpha=function($d){this.ctx.globalAlpha*=$d;},$d.setAlpha=function($d){this.ctx.globalAlpha=$d;},$d.fillWords=function($d,$t,$l,$k,$W,$i){void 0===$i&&($i=0),this.ctx.fillWords($d,$t,$l,$k,$W,$i);},$d.fillBorderWords=function($d,$t,$l,$k,$W,$i,$A){this.ctx.fillBorderWords($d,$t,$l,$k,$W,$i,$A);},$d.fillText=function($d,$t,$l,$k,$W,$i){this.ctx.fillText($d,$t+this.x,$l+this.y,$k,$W,$i);},$d.strokeText=function($d,$t,$l,$k,$W,$i,$A){this.ctx.strokeText($d,$t+this.x,$l+this.y,$k,$W,$i,$A);},$d.blendMode=function($d){this.ctx.globalCompositeOperation=$d;},$d.flush=function(){this.ctx.flush&&this.ctx.flush();},$d.addRenderObject=function($d){this.ctx.addRenderObject($d);},$d.beginClip=function($d,$t,$l,$k){this.ctx.beginClip&&this.ctx.beginClip($d,$t,$l,$k);},$d.endClip=function(){this.ctx.endClip&&this.ctx.endClip();},$d.fillTrangles=function($d,$t,$l){this.ctx.fillTrangles($l[0],$l[1],$l[2],$l[3],4<$l.length?$l[4]:null);},$A.PI2=2*Math.PI,$A;}(),$n=function(){function $A($d,$t){switch(this._next=$t||$A.NORENDER,$d){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$z._filter);case 69905:return void(this._fun=$A._initRenderFun);}this.onCreate($d);}$w($A,"laya.renders.RenderSprite");var $d=$A.prototype;return $d.onCreate=function($d){},$d._style=function($d,$t,$l,$k){$d._style.render($d,$t,$l,$k);var $W=this._next;$W._fun.call($W,$d,$t,$l,$k);},$d._no=function($d,$t,$l,$k){},$d._custom=function($d,$t,$l,$k){$d.customRender($t,$l,$k);var $W=$d._style._tf;this._next._fun.call(this._next,$d,$t,$l-$W.translateX,$k-$W.translateY);},$d._clip=function($d,$t,$l,$k){var $W=this._next;if($W!=$A.NORENDER){var $i=$d._style.scrollRect;$t.ctx.save(),$t.ctx.clipRect($l,$k,$i.width,$i.height),$W._fun.call($W,$d,$t,$l-$i.x,$k-$i.y),$t.ctx.restore();}},$d._blend=function($d,$t,$l,$k){var $W=$d._style;$W.blendMode&&($t.ctx.globalCompositeOperation=$W.blendMode);var $i=this._next;$i._fun.call($i,$d,$t,$l,$k),$t.ctx.globalCompositeOperation="source-over";},$d._mask=function($d,$t,$l,$k){var $W=this._next;$W._fun.call($W,$d,$t,$l,$k);var $i=$d.mask;$i&&($t.ctx.globalCompositeOperation="destination-in",(0<$i.numChildren||!$i.graphics._isOnlyOne())&&($i.cacheAsBitmap=!0),$i.render($t,$l-$d.pivotX,$k-$d.pivotY)),$t.ctx.globalCompositeOperation="source-over";},$d._graphics=function($d,$t,$l,$k){var $W=$d._style._tf;$d._graphics&&$d._graphics._render($d,$t,$l-$W.translateX,$k-$W.translateY);var $i=this._next;$i._fun.call($i,$d,$t,$l,$k);},$d._image=function($d,$t,$l,$k){var $W=$d._style;$t.ctx.drawTexture2($l,$k,$W._tf.translateX,$W._tf.translateY,$d.transform,$W.alpha,$W.blendMode,$d._graphics._one);},$d._image2=function($d,$t,$l,$k){var $W=$d._style._tf;$t.ctx.drawTexture2($l,$k,$W.translateX,$W.translateY,$d.transform,1,null,$d._graphics._one);},$d._alpha=function($d,$t,$l,$k){var $W;if(.01<($W=$d._style.alpha)||$d._needRepaint()){var $i=$t.ctx.globalAlpha;$t.ctx.globalAlpha*=$W;var $A=this._next;$A._fun.call($A,$d,$t,$l,$k),$t.ctx.globalAlpha=$i;}},$d._transform=function($d,$t,$l,$k){var $W=$d.transform,$i=this._next;$W&&$i!=$A.NORENDER?($t.save(),$t.transform($W.a,$W.b,$W.c,$W.d,$W.tx+$l,$W.ty+$k),$i._fun.call($i,$d,$t,0,0),$t.restore()):$i._fun.call($i,$d,$t,$l,$k);},$d._childs=function($d,$t,$l,$k){var $W=$d._style,$i=$W._tf;if($l=$l-$i.translateX+$W.paddingLeft,$k=$k-$i.translateY+$W.paddingTop,$W._calculation){var $A=$d._getWords();if($A){var $B=$W;$B&&($B.stroke?$t.fillBorderWords($A,$l,$k,$B.font,$B.color,$B.strokeColor,$B.stroke):$t.fillWords($A,$l,$k,$B.font,$B.color,"none"!=$B.textDecoration&&$B.underLine?1:0));}}var $o,$I=$d._childs,$b=$I.length;if($d.viewport||$d.optimizeScrollRect&&$d._style.scrollRect){var $f=$d.viewport||$d._style.scrollRect,$J=$f.x,$c=$f.y,$Y=$f.right,$w=$f.bottom,$D=NaN,$z=NaN;for($e=0;$e<$b;++$e)($o=$I[$e]).visible&&($D=$o._x)<$Y&&$D+$o.width>$J&&($z=$o._y)<$w&&$z+$o.height>$c&&$o.render($t,$l,$k);}else for(var $e=0;$e<$b;++$e)($o=$I[$e])._style.visible&&$o.render($t,$l,$k);},$d._canvas=function($d,$t,$l,$k){var $W=$d._$P.cacheCanvas;if($W){"bitmap"===$W.type?$X.canvasBitmap++:$X.canvasNormal++;var $i=$W.ctx;if($d._needRepaint()||!$i)this._canvas_repaint($d,$t,$l,$k);else{var $A=$W._cacheRec;$t.drawCanvas($i.canvas,$l+$A.x,$k+$A.y,$A.width,$A.height);}}else this._next._fun.call(this._next,$d,$t,$l,$k);},$d._canvas_repaint=function($d,$t,$l,$k){var $W=$d._$P.cacheCanvas,$i=this._next;if($W){var $A,$B,$o,$I,$b=$W.ctx,$f=$d._needRepaint()||!$b,$J=$W.type;if("bitmap"===$J?$X.canvasBitmap++:$X.canvasNormal++,$f){var $c,$Y;$W._cacheRec||($W._cacheRec=new $$()),$K.isWebGL&&"bitmap"!==$J?$W._cacheRec.setTo(-$d.pivotX,-$d.pivotY,1,1):(($I=$d.getSelfBounds()).x=$I.x-$d.pivotX,$I.y=$I.y-$d.pivotY,$I.x=$I.x-16,$I.y=$I.y-16,$I.width=$I.width+32,$I.height=$I.height+32,$I.x=Math.floor($I.x+$l)-$l,$I.y=Math.floor($I.y+$k)-$k,$I.width=Math.floor($I.width),$I.height=Math.floor($I.height),$W._cacheRec.copyFrom($I)),$I=$W._cacheRec;var $w,$D=$K.isWebGL?1:$V.pixelRatio*$q.stage.clientScaleX,$z=$K.isWebGL?1:$V.pixelRatio*$q.stage.clientScaleY;if(!$K.isWebGL){var $e,$g=1,$H=1;for($e=$d;$e&&$e!=$q.stage;)$g*=$e.scaleX,$H*=$e.scaleY,$e=$e.parent;$K.isWebGL?($g<1&&($D*=$g),$H<1&&($z*=$H)):(1<$g&&($D*=$g),1<$H&&($z*=$H));}if($d.scrollRect){var $R=$d.scrollRect;$I.x-=$R.x,$I.y-=$R.y;}if($c=$I.width*$D,$Y=$I.height*$z,$B=$I.x,$o=$I.y,$K.isWebGL&&"bitmap"===$J&&(2048<$c||2048<$Y))return console.warn("cache bitmap size larger than 2048,cache ignored"),$W.ctx&&($P.recover("RenderContext",$W.ctx),$W.ctx.canvas.size(0,0),$W.ctx=null),void $i._fun.call($i,$d,$t,$l,$k);if($b||($b=$W.ctx=$P.getItem("RenderContext")||new $x($c,$Y,$gd.create("AUTO"))),$b.ctx.sprite=$d,($A=$b.canvas).clear(),($A.width!=$c||$A.height!=$Y)&&$A.size($c,$Y),"bitmap"===$J?$A.context.asBitmap=!0:"normal"===$J&&($A.context.asBitmap=!1),1!=$D||1!=$z){var $G=$b.ctx;$G.save(),$G.scale($D,$z),!$K.isConchWebGL&&$K.isConchApp&&($w=$d._$P.cf)&&$G.setFilterMatrix&&$G.setFilterMatrix($w._mat,$w._alpha),$i._fun.call($i,$d,$b,-$B,-$o),$G.restore(),$K.isConchApp&&!$K.isConchWebGL||$d._applyFilters();}else $G=$b.ctx,!$K.isConchWebGL&&$K.isConchApp&&($w=$d._$P.cf)&&$G.setFilterMatrix&&$G.setFilterMatrix($w._mat,$w._alpha),$i._fun.call($i,$d,$b,-$B,-$o),$K.isConchApp&&!$K.isConchWebGL||$d._applyFilters();$d._$P.staticCache&&($W.reCache=!1),$X.canvasReCache++;}else $B=($I=$W._cacheRec).x,$o=$I.y,$A=$b.canvas;$t.drawCanvas($A,$l+$B,$k+$o,$I.width,$I.height);}else $i._fun.call($i,$d,$b,$l,$k);},$A.__init__=function(){var $d,$t,$l=0;for($t=$r.createRenderSprite(69905,null),$d=$A.renders.length=4096,$l=0;$l<$d;$l++)$A.renders[$l]=$t;$A.renders[0]=$r.createRenderSprite(0,null),function($d,$t){for(var $l=0,$k=0;$k<$d.length;$k++)$l|=$d[$k],$A.renders[$l]=$t;}([1,512,4,2],new $A(1,null)),$A.renders[513]=$r.createRenderSprite(513,null),$A.renders[517]=new $A(517,null);},$A._initRenderFun=function($d,$t,$l,$k){var $W=$d._renderType;($A.renders[$W]=$A._getTypeRender($W))._fun($d,$t,$l,$k);},$A._getTypeRender=function($d){for(var $t=null,$l=2048;1<$l;)$l&$d&&($t=$r.createRenderSprite($l,$t)),$l>>=1;return $t;},$A.IMAGE=1,$A.ALPHA=2,$A.TRANSFORM=4,$A.BLEND=8,$A.CANVAS=16,$A.FILTERS=32,$A.MASK=64,$A.CLIP=128,$A.STYLE=256,$A.GRAPHICS=512,$A.CUSTOM=1024,$A.CHILDS=2048,$A.INIT=69905,$A.renders=[],$A.NORENDER=new $A(0,null),$A;}(),$Q=function(){function $B(){this._repaint=!1;}$w($B,"laya.resource.Context");var $d=$B.prototype;return $d.replaceReset=function(){var $d,$t,$l=0;for($d=$B.replaceKeys.length,$l=0;$l<$d;$l++)$t=$B.replaceKeys[$l],this[$B.newKeys[$l]]=this[$t];},$d.replaceResotre=function(){this.__restore(),this.__reset();},$d.setIsMainContext=function(){},$d.drawTextures=function($d,$t,$l,$k){$X.drawCall+=$t.length/2;for(var $W=$d.width,$i=$d.height,$A=0,$B=$t.length;$A<$B;$A+=2)this.drawTexture($d,$t[$A],$t[$A+1],$W,$i,$l,$k);},$d.drawCanvas=function($d,$t,$l,$k,$W){$X.drawCall++,this.drawImage($d.source,$t,$l,$k,$W);},$d.fillRect=function($d,$t,$l,$k,$W){$X.drawCall++,$W&&(this.fillStyle=$W),this.__fillRect($d,$t,$l,$k);},$d.fillText=function($d,$t,$l,$k,$W,$i){$X.drawCall++,3<arguments.length&&null!=$k&&(this.font=$k,this.fillStyle=$W,this.textAlign=$i,this.textBaseline="top"),this.__fillText($d,$t,$l);},$d.fillBorderText=function($d,$t,$l,$k,$W,$i,$A,$B){$X.drawCall++,this.font=$k,this.fillStyle=$W,this.textBaseline="top",this.strokeStyle=$i,this.lineWidth=$A,this.textAlign=$B,this.__strokeText($d,$t,$l),this.__fillText($d,$t,$l);},$d.strokeText=function($d,$t,$l,$k,$W,$i,$A){$X.drawCall++,3<arguments.length&&null!=$k&&(this.font=$k,this.strokeStyle=$W,this.lineWidth=$i,this.textAlign=$A,this.textBaseline="top"),this.__strokeText($d,$t,$l);},$d.transformByMatrix=function($d){this.transform($d.a,$d.b,$d.c,$d.d,$d.tx,$d.ty);},$d.setTransformByMatrix=function($d){this.setTransform($d.a,$d.b,$d.c,$d.d,$d.tx,$d.ty);},$d.clipRect=function($d,$t,$l,$k){$X.drawCall++,this.beginPath(),this.rect($d,$t,$l,$k),this.clip();},$d.drawTexture=function($d,$t,$l,$k,$W,$i,$A){$X.drawCall++;var $B=$d.uv,$o=$d.bitmap.width,$I=$d.bitmap.height;this.drawImage($d.source,$B[0]*$o,$B[1]*$I,($B[2]-$B[0])*$o,($B[5]-$B[3])*$I,$t+$i,$l+$A,$k,$W);},$d.drawTextureWithTransform=function($d,$t,$l,$k,$W,$i,$A,$B,$o){$X.drawCall++;var $I=$d.uv,$b=$d.bitmap.width,$f=$d.bitmap.height;this.save(),1!=$o&&(this.globalAlpha*=$o),$i?(this.transform($i.a,$i.b,$i.c,$i.d,$i.tx+$A,$i.ty+$B),this.drawImage($d.source,$I[0]*$b,$I[1]*$f,($I[2]-$I[0])*$b,($I[5]-$I[3])*$f,$t,$l,$k,$W)):this.drawImage($d.source,$I[0]*$b,$I[1]*$f,($I[2]-$I[0])*$b,($I[5]-$I[3])*$f,$t+$A,$l+$B,$k,$W),this.restore();},$d.drawTexture2=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=$B[0];if($o.loaded&&$o.bitmap&&$o.source){$X.drawCall++;var $I=1!==$i;if($I){var $b=this.globalAlpha;this.globalAlpha*=$i;}var $f=$o.uv,$J=$o.bitmap.width,$c=$o.bitmap.height;$W?(this.save(),this.transform($W.a,$W.b,$W.c,$W.d,$W.tx+$d,$W.ty+$t),this.drawImage($o.source,$f[0]*$J,$f[1]*$c,($f[2]-$f[0])*$J,($f[5]-$f[3])*$c,$B[1]-$l,$B[2]-$k,$B[3],$B[4]),this.restore()):this.drawImage($o.source,$f[0]*$J,$f[1]*$c,($f[2]-$f[0])*$J,($f[5]-$f[3])*$c,$B[1]-$l+$d,$B[2]-$k+$t,$B[3],$B[4]),$I&&(this.globalAlpha=$b);}},$d.fillTexture=function($d,$t,$l,$k,$W,$i,$A,$B){if(!$B.pat){if($d.uv!=$bd.DEF_UV){var $o=new $gd("2D");$o.getContext("2d"),$o.size($d.width,$d.height),$o.context.drawTexture($d,0,0,$d.width,$d.height,0,0),$d=new $bd($o);}$B.pat=this.createPattern($d.bitmap.source,$i);}var $I=$t,$b=$l,$f=0,$J=0;$A&&($I+=$A.x%$d.width,$b+=$A.y%$d.height,$f-=$A.x%$d.width,$J-=$A.y%$d.height),this.translate($I,$b),this.fillRect($f,$J,$k,$W,$B.pat),this.translate(-$I,-$b);},$d.drawTriangle=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=$d.bitmap,$I=$o.source,$b=$d.width,$f=$d.height,$J=$o.width,$c=$o.height,$Y=$l[$k]*$J,$w=$l[$W]*$J,$D=$l[$i]*$J,$z=$l[$k+1]*$c,$e=$l[$W+1]*$c,$g=$l[$i+1]*$c,$H=$t[$k],$R=$t[$W],$G=$t[$i],$q=$t[$k+1],$L=$t[$W+1],$$=$t[$i+1];if($B){var $p=($H+$R+$G)/3,$M=($q+$L+$$)/3,$T=$H-$p,$r=$q-$M,$S=Math.sqrt($T*$T+$r*$r);$H=$p+$T/$S*($S+1),$q=$M+$r/$S*($S+1),$r=$L-$M,$R=$p+($T=$R-$p)/($S=Math.sqrt($T*$T+$r*$r))*($S+1),$L=$M+$r/$S*($S+1),$r=$$-$M,$G=$p+($T=$G-$p)/($S=Math.sqrt($T*$T+$r*$r))*($S+1),$$=$M+$r/$S*($S+1);}this.save(),$A&&this.transform($A.a,$A.b,$A.c,$A.d,$A.tx,$A.ty),this.beginPath(),this.moveTo($H,$q),this.lineTo($R,$L),this.lineTo($G,$$),this.closePath(),this.clip();var $j=1/($Y*$e+$z*$D+$w*$g-$e*$D-$z*$w-$Y*$g),$C=$H*$e+$z*$G+$R*$g-$e*$G-$z*$R-$H*$g,$K=$Y*$R+$H*$D+$w*$G-$R*$D-$H*$w-$Y*$G,$x=$Y*$e*$G+$z*$R*$D+$H*$w*$g-$H*$e*$D-$z*$w*$G-$Y*$R*$g,$n=$q*$e+$z*$$+$L*$g-$e*$$-$z*$L-$q*$g,$Q=$Y*$L+$q*$D+$w*$$-$L*$D-$q*$w-$Y*$$,$y=$Y*$e*$$+$z*$L*$D+$q*$w*$g-$q*$e*$D-$z*$w*$$-$Y*$L*$g;this.transform($C*$j,$n*$j,$K*$j,$Q*$j,$x*$j,$y*$j),this.drawImage($I,$d.uv[0]*$J,$d.uv[1]*$c,$b,$f,$d.uv[0]*$J,$d.uv[1]*$c,$b,$f),this.restore();},$d.flush=function(){return 0;},$d.fillWords=function($d,$t,$l,$k,$W,$i){$k&&(this.font=$k),$W&&(this.fillStyle=$W);this.textBaseline="top",this.textAlign="left";for(var $A=0,$B=$d.length;$A<$B;$A++){var $o=$d[$A];if(this.__fillText($o.char,$o.x+$t,$o.y+$l),1===$i){var $I=$o.height,$b=.5*$o.style.letterSpacing;$b||($b=0),this.beginPath(),this.strokeStyle=$W,this.lineWidth=1,this.moveTo($t+$o.x-$b+.5,$l+$o.y+$I+.5),this.lineTo($t+$o.x+$o.width+$b+.5,$l+$o.y+$I+.5),this.stroke();}}},$d.fillBorderWords=function($d,$t,$l,$k,$W,$i,$A){$k&&(this.font=$k),$W&&(this.fillStyle=$W),this.textBaseline="top",this.lineWidth=$A,this.textAlign="left",this.strokeStyle=$i;for(var $B=0,$o=$d.length;$B<$o;$B++){var $I=$d[$B];this.__strokeText($I.char,$I.x+$t,$I.y+$l),this.__fillText($I.char,$I.x+$t,$I.y+$l);}},$d.destroy=function(){this.canvas.width=this.canvas.height=0;},$d.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1;},$d.drawCurves=function($d,$t,$l){this.beginPath(),this.strokeStyle=$l[3],this.lineWidth=$l[4];var $k=$l[2];$d+=$l[0],$t+=$l[1],this.moveTo($d+$k[0],$t+$k[1]);for(var $W=2,$i=$k.length;$W<$i;)this.quadraticCurveTo($d+$k[$W++],$t+$k[$W++],$d+$k[$W++],$t+$k[$W++]);this.stroke();},$B.__init__=function($t){var $l=laya.resource.Context.prototype;if(!($t=$t||CanvasRenderingContext2D.prototype).inited){$t.inited=!0,$t.__fillText=$t.fillText,$t.__fillRect=$t.fillRect,$t.__strokeText=$t.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($d){$t[$d]=$l[$d];});}},$B.replaceCanvasGetSet=function($d,$t){var $l=Object.getOwnPropertyDescriptor($d,$t);if(!$l||!$l.configurable)return!1;var $k,$W={};for($k in $l)"set"!=$k&&($W[$k]=$l[$k]);var $i=$l.set;return $W.set=function($d){$i.call(this,$d);var $t=this.getContext("2d");$t&&"__reset"in $t&&$t.__reset();},Object.defineProperty($d,$t,$W),!0;},$B.replaceGetSet=function($d,$t){var $l=Object.getOwnPropertyDescriptor($d,$t);if(!$l||!$l.configurable)return!1;var $k,$W={};for($k in $l)"set"!=$k&&($W[$k]=$l[$k]);var $i=$l.set,$A="___"+$t+"__";return $B.newKeys.push($A),$W.set=function($d){$d!=this[$A]&&(this[$A]=$d,$i.call(this,$d));},Object.defineProperty($d,$t,$W),!0;},$B._default=new $B(),$B.newKeys=[],$o($B,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"];}]),$B;}(),$y=function(){function $i($d){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$i._uniqueIDCounter,this._name=$d||"Content Manager",$i._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$i._resourceManagers.push(this),this._resources=[],this._records={};}$w($i,"laya.resource.ResourceManager");var $d=$i.prototype;return $q.imps($d,{"laya.resource.IDispose":!0}),$d.getResourceByIndex=function($d){return this._resources[$d];},$d.getResourcesLength=function(){return this._resources.length;},$d.addResource=function($d){return $d.resourceManager&&$d.resourceManager.removeResource($d),-1===this._resources.indexOf($d)&&(($d._resourceManager=this)._resources.push($d),this.addRecord($d.uri,$d.__className,$d.memorySize),this.addSize($d.memorySize),!0);},$d.removeResource=function($d){var $t=this._resources.indexOf($d);return-1!==$t&&(this._resources.splice($t,1),$d._resourceManager=null,this._memorySize-=$d.memorySize,this.addRecord($d.uri,$d.__className,-$d.memorySize),!0);},$d.unload=function(){for(var $d=this._resources.slice(0,this._resources.length),$t=0;$t<$d.length;$t++){$d[$t].destroy();}$d.length=0;},$d.dispose=function(){if(this===$i._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$i._resourceManagers.splice($i._resourceManagers.indexOf(this),1),$i._isResourceManagersSorted=!1;for(var $d=this._resources.slice(0,this._resources.length),$t=0;$t<$d.length;$t++){var $l=$d[$t];$l.resourceManager.removeResource($l),$l.destroy();}$d.length=0;},$d.addSize=function($d){$d&&(this.autoRelease&&0<$d&&this._memorySize+$d>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$d);},$d.addRecord=function($d,$t,$l){DEBUG&&$l&&!$d&&console.error($d,$t,$l);},$d.garbageCollection=function($d){var $t=this._resources;($t=$t.slice()).sort(function($d,$t){if(!$d||!$t)throw new Error("a或b不能为空！");return $d.released&&$t.released?0:$d.released?1:$t.released?-1:$d._lastUseFrameCount-$t._lastUseFrameCount;});for(var $l=$X.loopCount,$k=0,$W=$t.length;$k<$W;$k++){var $i=$t[$k];if(!(1<$l-$i._lastUseFrameCount))return void(this._memorySize>=$d&&(this._isOverflow=!0));if($i.releaseResource(),this._memorySize<$d)return void(this._isOverflow=!1);}},$b(0,$d,"id",function(){return this._id;}),$b(0,$d,"name",function(){return this._name;},function($d){!$d&&""===$d||this._name===$d||(this._name=$d,$i._isResourceManagersSorted=!1);}),$b(0,$d,"memorySize",function(){return this._memorySize;}),$b(0,$d,"records",function(){return this._records;}),$b(1,$i,"systemResourceManager",function(){return $i._systemResourceManager;}),$i.__init__=function(){$i.currentResourceManager=$i.systemResourceManager;},$i.getLoadedResourceManagerByIndex=function($d){return $i._resourceManagers[$d];},$i.getLoadedResourceManagersCount=function(){return $i._resourceManagers.length;},$i.recreateContentManagers=function($d){void 0===$d&&($d=!1);for(var $t=$i.currentResourceManager,$l=0;$l<$i._resourceManagers.length;$l++){$i.currentResourceManager=$i._resourceManagers[$l];for(var $k=0;$k<$i.currentResourceManager._resources.length;$k++)$i.currentResourceManager._resources[$k].releaseResource($d),$i.currentResourceManager._resources[$k].activeResource($d);}$i.currentResourceManager=$t;},$i.releaseContentManagers=function($d){void 0===$d&&($d=!1);for(var $t=$i.currentResourceManager,$l=0;$l<$i._resourceManagers.length;$l++){$i.currentResourceManager=$i._resourceManagers[$l];for(var $k=0;$k<$i.currentResourceManager._resources.length;$k++){var $W=$i.currentResourceManager._resources[$k];!$W.released&&$W.releaseResource($d);}}$i.currentResourceManager=$t;},$i._uniqueIDCounter=0,$i._isResourceManagersSorted=!1,$i._resourceManagers=[],$o($i,["_systemResourceManager",function(){return this._systemResourceManager=new $i("System Resource Manager");},"currentResourceManager",function(){return this.currentResourceManager=$i._systemResourceManager;}]),$i;}(),$V=(function(){function $d(){}$w($d,"laya.system.System"),$d.changeDefinition=function($d,$t){$q[$d]=$t;var $l=$d+"=classObj";$q._runScript($l);},$d.__init__=function(){$K.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice());};}(),function(){function $l(){}return $w($l,"laya.utils.Browser"),$b(1,$l,"pixelRatio",function(){return $l.__init__(),-1<$l.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$r.getPixelRatio();}),$b(1,$l,"height",function(){return $l.__init__(),($q.stage&&$q.stage.canvasRotation?$l.clientWidth:$l.clientHeight)*$l.pixelRatio;}),$b(1,$l,"clientWidth",function(){return $l.__init__(),$l.window.innerWidth||$l.document.body.clientWidth;}),$b(1,$l,"window",function(){return $l.__init__(),$l._window;}),$b(1,$l,"clientHeight",function(){return $l.__init__(),$l.window.innerHeight||$l.document.body.clientHeight||$l.document.documentElement.clientHeight;}),$b(1,$l,"width",function(){return $l.__init__(),($q.stage&&$q.stage.canvasRotation?$l.clientHeight:$l.clientWidth)*$l.pixelRatio;}),$b(1,$l,"container",function(){return $l.__init__(),$l._container||(($l._container=$l.createElement("div")).id="layaContainer",$l.document.body.appendChild($l._container)),$l._container;},function($d){$l._container=$d;}),$b(1,$l,"document",function(){return $l.__init__(),$l._document;}),$l.__init__=function(){if(!$l._window){$l._window=$r.getWindow(),$l._document=$l.window.document,$l._window.addEventListener("message",function($d){laya.utils.Browser._onMessage($d);},!1),$l.document.__createElement=$l.document.createElement,$A.requestAnimationFrame=$A.requestAnimationFrame||$A.webkitRequestAnimationFrame||$A.mozRequestAnimationFrame||$A.oRequestAnimationFrame||$A.msRequestAnimationFrame||function($d){return $A.setTimeout($d,1e3/60);};var $d=$A.document.body.style;$d["-webkit-user-select"]="none",$d["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$l.userAgent=$l.window.navigator.userAgent,$l.onIOS=!!($l.u=$l.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$l.onMobile=-1<$l.u.indexOf("Mobile"),$l.onIPhone=-1<$l.u.indexOf("iPhone"),$l.onMac=-1<$l.u.indexOf("Mac OS X"),$l.onIPad=-1<$l.u.indexOf("iPad"),$l.onAndroid=-1<$l.u.indexOf("Android")||-1<$l.u.indexOf("Adr"),$l.onWP=-1<$l.u.indexOf("Windows Phone"),$l.onQQBrowser=-1<$l.u.indexOf("QQBrowser"),$l.onMQQBrowser=-1<$l.u.indexOf("MQQBrowser")||-1<$l.u.indexOf("Mobile")&&-1<$l.u.indexOf("QQ"),$l.onIE=!!$l.window.ActiveXObject||"ActiveXObject"in $l.window,$l.onWeiXin=-1<$l.u.indexOf("MicroMessenger"),$l.onPC=!$l.onMobile,$l.onSafari=-1<$l.u.indexOf("Safari"),$l.onFirefox=-1<$l.u.indexOf("Firefox"),$l.onEdge=-1<$l.u.indexOf("Edge"),$l.onMiniGame=-1<$l.u.indexOf("MiniGame"),$l.onLimixiu=-1<$l.u.indexOf("limixiu"),$l.httpProtocol="http:"==$l.window.location.protocol,$l.onMiniGame&&null==$l.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$l.webAudioEnabled=!!($l.window.AudioContext||$l.window.webkitAudioContext||$l.window.mozAudioContext),$l.soundType=$l.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$Wd=$l.webAudioEnabled?$id:$ld,$l.webAudioEnabled&&$id.initWebAudio(),$ld._initMusicAudio(),$l.enableTouch="ontouchstart"in $A||$A.DocumentTouch&&$t instanceof DocumentTouch,$A.focus(),$T._soundClass=$Wd,$T._musicClass=$ld,$K._mainCanvas=$K._mainCanvas||$gd.create("2D"),$l.canvas||($l.canvas=$gd.create("2D"),$l.context=$l.canvas.getContext("2d"));}},$l._onMessage=function($d){if($d.data&&"size"==$d.data.name){if($l.window.innerWidth=$d.data.width,$l.window.innerHeight=$d.data.height,$l.window.__innerHeight=$d.data.clientHeight,!$l.document.createEvent)return void console.warn("no document.createEvent");var $t=$l.document.createEvent("HTMLEvents");return $t.initEvent("resize",!1,!1),void $l.window.dispatchEvent($t);}},$l.createElement=function($d){return $l.__init__(),$l.document.__createElement($d);},$l.getElementById=function($d){return $l.__init__(),$l.document.getElementById($d);},$l.removeElement=function($d){$d&&$d.parentNode&&$d.parentNode.removeChild($d);},$l.now=function(){return $r.now();},$l._window=null,$l._document=null,$l._container=null,$l.userAgent=null,$l.u=null,$l.onIOS=!1,$l.onMac=!1,$l.onMobile=!1,$l.onIPhone=!1,$l.onIPad=!1,$l.onAndroid=!1,$l.onWP=!1,$l.onQQBrowser=!1,$l.onMQQBrowser=!1,$l.onSafari=!1,$l.onFirefox=!1,$l.onEdge=!1,$l.onIE=!1,$l.onWeiXin=!1,$l.onMiniGame=!1,$l.onLimixiu=!1,$l.onPC=!1,$l.httpProtocol=!1,$l.webAudioEnabled=!1,$l.soundType=null,$l.enableTouch=!1,$l.canvas=null,$l.context=null,$l.__init$=function(){},$l;}()),$Z=function(){function $t($d){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$d?(this._u8d_=new Uint8Array($d),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_);}$w($t,"laya.utils.Byte");var $d=$t.prototype;return $d.___resizeBuffer=function($t){try{var $d=new Uint8Array($t);null!=this._u8d_&&(this._u8d_.length<=$t?$d.set(this._u8d_):$d.set(this._u8d_.subarray(0,$t))),this._u8d_=$d,this._d_=new DataView($d.buffer);}catch($d){throw"___resizeBuffer err:"+$t;}},$d.getString=function(){return this.rUTF(this.getUint16());},$d.getFloat32Array=function($d,$t){var $l=$d+$t;$l=$l>this._length?this._length:$l;var $k=new Float32Array(this._d_.buffer.slice($d,$l));return this._pos_=$l,$k;},$d.getUint8Array=function($d,$t){var $l=$d+$t;$l=$l>this._length?this._length:$l;var $k=new Uint8Array(this._d_.buffer.slice($d,$l));return this._pos_=$l,$k;},$d.getInt16Array=function($d,$t){var $l=$d+$t;$l=$l>this._length?this._length:$l;var $k=new Int16Array(this._d_.buffer.slice($d,$l));return this._pos_=$l,$k;},$d.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $d=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$d;},$d.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $d=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$d;},$d.writeFloat32=function($d){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$d,this._xd_),this._pos_+=4;},$d.writeFloat64=function($d){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$d,this._xd_),this._pos_+=8;},$d.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $d=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$d;},$d.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $d=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$d;},$d.writeInt32=function($d){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$d,this._xd_),this._pos_+=4;},$d.writeUint32=function($d){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$d,this._xd_),this._pos_+=4;},$d.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $d=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$d;},$d.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $d=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$d;},$d.writeUint16=function($d){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$d,this._xd_),this._pos_+=2;},$d.writeInt16=function($d){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$d,this._xd_),this._pos_+=2;},$d.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++);},$d.writeUint8=function($d){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$d),this._pos_++;},$d._getUInt8=function($d){return this._d_.getUint8($d);},$d._getUint16=function($d){return this._d_.getUint16($d,this._xd_);},$d._getMatrix=function(){return new $S(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());},$d.rUTF=function($d){for(var $t=[],$l=this._pos_+$d,$k=0,$W=0,$i=0,$A=String.fromCharCode,$B=this._u8d_;this._pos_<$l;)($k=$B[this._pos_++])<128?0!=$k&&$t.push($A($k)):$k<224?$t.push($A((63&$k)<<6|127&$B[this._pos_++])):$k<240?($W=$B[this._pos_++],$t.push($A((31&$k)<<12|(127&$W)<<6|127&$B[this._pos_++]))):($W=$B[this._pos_++],$i=$B[this._pos_++],$t.push($A((15&$k)<<18|(127&$W)<<12|$i<<6&127|127&$B[this._pos_++]))),0;return $t.join("");},$d.getCustomString=function($d){for(var $t=[],$l=0,$k=0,$W=0,$i=String.fromCharCode,$A=this._u8d_;0<$d;)if(($k=$A[this._pos_])<128)$t.push($i($k)),this._pos_++,$d--;else for($l=$k-128,this._pos_++,$d-=$l;0<$l;)$k=$A[this._pos_++],$W=$A[this._pos_++],$t.push($i($W<<8|$k)),$l--;return $t.join("");},$d.clear=function(){this._pos_=0,this.length=0;},$d.__getBuffer=function(){return this._d_.buffer;},$d.writeUTFBytes=function($d){for(var $t=0,$l=($d+="").length;$t<$l;$t++){var $k=$d.charCodeAt($t);$k<=127?this.writeByte($k):$k<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$k>>6,128|63&$k],this._pos_),this._pos_+=2):$k<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$k>>12,128|$k>>6&63,128|63&$k],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$k>>18,128|$k>>12&63,128|$k>>6&63,128|63&$k],this._pos_),this._pos_+=4);}},$d.writeUTFString=function($d){var $t=this.pos;this.writeUint16(1),this.writeUTFBytes($d);var $l=this.pos-$t-2;if(65536<=$l)throw"writeUTFString byte len more than 65536";this._d_.setUint16($t,$l,this._xd_);},$d.readUTFString=function(){return this.readUTFBytes(this.getUint16());},$d.getUTFString=function(){return this.readUTFString();},$d.readUTFBytes=function($d){if(void 0===$d&&($d=-1),0==$d)return"";var $t=this.bytesAvailable;if($t<$d)throw"readUTFBytes error - Out of bounds";return $d=0<$d?$d:$t,this.rUTF($d);},$d.getUTFBytes=function($d){return void 0===$d&&($d=-1),this.readUTFBytes($d);},$d.writeByte=function($d){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$d),this._pos_+=1;},$d.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++);},$d.getByte=function(){return this.readByte();},$d.ensureWrite=function($d){this._length<$d&&(this._length=$d),this._allocated_<$d&&(this.length=$d);},$d.writeArrayBuffer=function($d,$t,$l){if(void 0===$t&&($t=0),void 0===$l&&($l=0),$t<0||$l<0)throw"writeArrayBuffer error - Out of bounds";0==$l&&($l=$d.byteLength-$t),this.ensureWrite(this._pos_+$l);var $k=new Uint8Array($d);this._u8d_.set($k.subarray($t,$t+$l),this._pos_),this._pos_+=$l;},$b(0,$d,"buffer",function(){var $d=this._d_.buffer;return $d.byteLength==this.length?$d:$d.slice(0,this.length);}),$b(0,$d,"endian",function(){return this._xd_?"littleEndian":"bigEndian";},function($d){this._xd_="littleEndian"==$d;}),$b(0,$d,"length",function(){return this._length;},function($d){this._allocated_<$d?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($d,2*this._allocated_))):this._allocated_>$d&&this.___resizeBuffer(this._allocated_=$d),this._length=$d;}),$b(0,$d,"pos",function(){return this._pos_;},function($d){this._pos_=$d;}),$b(0,$d,"bytesAvailable",function(){return this._length-this._pos_;}),$t.getSystemEndian=function(){if(!$t._sysEndian){var $d=new ArrayBuffer(2);new DataView($d).setInt16(0,256,!0),$t._sysEndian=256===new Int16Array($d)[0]?"littleEndian":"bigEndian";}return $t._sysEndian;},$t.BIG_ENDIAN="bigEndian",$t.LITTLE_ENDIAN="littleEndian",$t._sysEndian=null,$t;}(),$U=function(){function $W(){}return $w($W,"laya.utils.CacheManager"),$W.regCacheByFunction=function($d,$t){var $l;$W.unRegCacheByFunction($d,$t),$l={tryDispose:$d,getCacheList:$t},$W._cacheList.push($l);},$W.unRegCacheByFunction=function($d,$t){var $l,$k=0;for($l=$W._cacheList.length,$k=0;$k<$l;$k++)if($W._cacheList[$k].tryDispose==$d&&$W._cacheList[$k].getCacheList==$t)return void $W._cacheList.splice($k,1);},$W.forceDispose=function(){var $d=0,$t=$W._cacheList.length;for($d=0;$d<$t;$d++)$W._cacheList[$d].tryDispose(!0);},$W.beginCheck=function($d){void 0===$d&&($d=15e3),$q.timer.loop($d,null,$W._checkLoop);},$W.stopCheck=function(){$q.timer.clear(null,$W._checkLoop);},$W._checkLoop=function(){var $d=$W._cacheList;if(!($d.length<1)){var $t,$l=$V.now(),$k=0;for($t=$k=$d.length;0<$k&&($d[$W._index=++$W._index%$t].tryDispose(!1),!($V.now()-$l>$W.loopTimeLimit));)$k--;}},$W.loopTimeLimit=2,$W._cacheList=[],$W._index=0,$W;}(),$E=function(){function $c(){}return $w($c,"laya.utils.ClassUtils"),$c.regClass=function($d,$t){$c._classMap[$d]=$t;},$c.getRegClass=function($d){return $c._classMap[$d];},$c.getInstance=function($d){var $t=$c.getClass($d);return $t?new $t():(console.warn("[error] Undefined class:",$d),null);},$c.createByJson=function($d,$t,$l,$k,$W){"string"==typeof $d&&($d=JSON.parse($d));var $i=$d.props;if(!$t&&!($t=$W?$W.runWith($d):$c.getInstance($i.runtime||$d.type)))return null;var $A=$d.child;if($A)for(var $B=0,$o=$A.length;$B<$o;$B++){var $I=$A[$B];if("render"!==$I.props.name&&"render"!==$I.props.renderType||!$t._$set_itemRender){if("Graphic"==$I.type)$c.addGraphicsToSprite($I,$t);else if($c.isDrawType($I.type))$c.addGraphicToSprite($I,$t,!0);else{var $b=$c.createByJson($I,null,$l,$k,$W);"Script"==$I.type?$b.hasOwnProperty("owner")?$b.owner=$t:$b.hasOwnProperty("target")&&($b.target=$t):"mask"==$I.props.renderType?$t.mask=$b:$t.addChild($b);}}else $t.itemRender=$I;}if($i)for(var $f in $i){var $J=$i[$f];"var"===$f&&$l?$l[$J]=$t:$J instanceof Array&&"function"==typeof $t[$f]?$t[$f].apply($t,$J):$t[$f]=$J;}return $k&&$d.customProps&&$k.runWith([$t,$d]),$t.created&&$t.created(),$t;},$c.addGraphicsToSprite=function($d,$t){var $l;if(($l=$d.child)&&!($l.length<1)){var $k;$k=$c._getGraphicsFromSprite($d,$t);var $W=0,$i=0;$d.props&&($W=$c._getObjVar($d.props,"x",0),$i=$c._getObjVar($d.props,"y",0)),0!=$W&&0!=$i&&$k.translate($W,$i);var $A,$B=0;for($A=$l.length,$B=0;$B<$A;$B++)$c._addGraphicToGraphics($l[$B],$k);0!=$W&&0!=$i&&$k.translate(-$W,-$i);}},$c.addGraphicToSprite=function($d,$t,$l){var $k;void 0===$l&&($l=!1),$k=$l?$c._getGraphicsFromSprite($d,$t):$t.graphics,$c._addGraphicToGraphics($d,$k);},$c._getGraphicsFromSprite=function($d,$t){var $l,$k;if(!$d||!$d.props)return $t.graphics;switch($k=$d.props.renderType){case"hit":case"unHit":var $W;$t.hitArea||($t.hitArea=new $s()),($W=$t.hitArea)[$k]||($W[$k]=new $J()),$l=$W[$k];}return $l||($l=$t.graphics),$l;},$c._getTransformData=function($d){var $t;($d.hasOwnProperty("pivotX")||$d.hasOwnProperty("pivotY"))&&($t=$t||new $S()).translate(-$c._getObjVar($d,"pivotX",0),-$c._getObjVar($d,"pivotY",0));var $l=$c._getObjVar($d,"scaleX",1),$k=$c._getObjVar($d,"scaleY",1),$W=$c._getObjVar($d,"rotation",0);$c._getObjVar($d,"skewX",0),$c._getObjVar($d,"skewY",0);return 1==$l&&1==$k&&0==$W||(($t=$t||new $S()).scale($l,$k),$t.rotate(.0174532922222222*$W)),$t;},$c._addGraphicToGraphics=function($d,$t){var $l,$k;if(($l=$d.props)&&($k=$c.DrawTypeDic[$d.type])){var $W,$i;$W=$t;var $A=$c._getParams($l,$k[1],$k[2],$k[3]);(($i=$c._tM)||1!=$c._alpha)&&($W.save(),$i&&$W.transform($i),1!=$c._alpha&&$W.alpha($c._alpha)),$W[$k[0]].apply($W,$A),($i||1!=$c._alpha)&&$W.restore();}},$c._adptLineData=function($d){return $d[2]=parseFloat($d[0])+parseFloat($d[2]),$d[3]=parseFloat($d[1])+parseFloat($d[3]),$d;},$c._adptTextureData=function($d){return $d[0]=$Bd.getRes($d[0]),$d;},$c._adptLinesData=function($d){return $d[2]=$c._getPointListByStr($d[2]),$d;},$c.isDrawType=function($d){return"Image"!=$d&&$c.DrawTypeDic.hasOwnProperty($d);},$c._getParams=function($d,$t,$l,$k){var $W;void 0===$l&&($l=0),($W=$c._temParam).length=$t.length;var $i,$A,$B=0;for($i=$t.length,$B=0;$B<$i;$B++)$W[$B]=$c._getObjVar($d,$t[$B][0],$t[$B][1]);return $c._alpha=$c._getObjVar($d,"alpha",1),$A=$c._getTransformData($d),$c._tM=$A?($l||($l=0),$A.translate($W[$l],$W[$l+1]),$W[$l]=$W[$l+1]=0,$A):null,$k&&$c[$k]&&($W=$c[$k]($W)),$W;},$c._getPointListByStr=function($d){var $t,$l,$k=0;for($l=($t=$d.split(",")).length,$k=0;$k<$l;$k++)$t[$k]=parseFloat($t[$k]);return $t;},$c._getObjVar=function($d,$t,$l){return $d.hasOwnProperty($t)?$d[$t]:$l;},$c._temParam=[],$c._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$c.getClass=function($d){var $t=$c._classMap[$d]||$d;return"string"==typeof $t?$q.__classmap[$t]:$t;},$c._tM=null,$c._alpha=NaN,$o($c,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};}]),$c;}(),$N=function(){function $i($d){if(this._color=[],"string"==typeof $d){null===(this.strColor=$d)&&($d="#000000"),"#"==$d.charAt(0)&&($d=$d.substr(1));var $t=$d.length;if(3==$t||4==$t){for(var $l="",$k=0;$k<$t;$k++)$l+=$d[$k]+$d[$k];$d=$l;}var $W=this.numColor=parseInt($d,16);if(8==$d.length)return void(this._color=[parseInt($d.substr(0,2),16)/255,((16711680&$W)>>16)/255,((65280&$W)>>8)/255,(255&$W)/255]);}else $W=this.numColor=$d,this.strColor=$F.toHexColor($W);this._color=[((16711680&$W)>>16)/255,((65280&$W)>>8)/255,(255&$W)/255,1],this._color.__id=++$i._COLODID;}return $w($i,"laya.utils.Color"),$i._initDefault=function(){for(var $d in $i._DEFAULT={},$i._COLOR_MAP)$i._SAVE[$d]=$i._DEFAULT[$d]=new $i($i._COLOR_MAP[$d]);return $i._DEFAULT;},$i._initSaveMap=function(){for(var $d in $i._SAVE_SIZE=0,$i._SAVE={},$i._DEFAULT)$i._SAVE[$d]=$i._DEFAULT[$d];},$i.create=function($d){var $t=$i._SAVE[$d+""];return null!=$t?$t:($i._SAVE_SIZE<1e3||$i._initSaveMap(),$i._SAVE[$d+""]=new $i($d));},$i._SAVE={},$i._SAVE_SIZE=0,$i._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$i._DEFAULT=$i._initDefault(),$i._COLODID=1,$i;}(),$u=(function(){function $d(){this._values=[],this._keys=[];}$w($d,"laya.utils.Dictionary");var $t=$d.prototype;$t.set=function($d,$t){var $l=this.indexOf($d);0<=$l?this._values[$l]=$t:(this._keys.push($d),this._values.push($t));},$t.indexOf=function($d){var $t=this._keys.indexOf($d);return 0<=$t?$t:($d="string"==typeof $d?Number($d):"number"==typeof $d?$d.toString():$d,this._keys.indexOf($d));},$t.get=function($d){var $t=this.indexOf($d);return $t<0?null:this._values[$t];},$t.remove=function($d){var $t=this.indexOf($d);return 0<=$t&&(this._keys.splice($t,1),this._values.splice($t,1),!0);},$t.clear=function(){this._values.length=0,this._keys.length=0;},$b(0,$t,"values",function(){return this._values;}),$b(0,$t,"keys",function(){return this._keys;});}(),function(){function $d(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0;}$w($d,"laya.utils.Dragging");var $t=$d.prototype;return $t.start=function($d,$t,$l,$k,$W,$i,$A,$B){void 0===$B&&($B=.92),this.clearTimer(),this.target=$d,this.area=$t,this.hasInertia=$l,this.elasticDistance=$t?$k:0,this.elasticBackTime=$W,this.data=$i,this._disableMouseEvent=$A,this.ratio=$B,1!=$d.globalScaleX||1!=$d.globalScaleY?this._parent=$d.parent:this._parent=$q.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$q.stage.on("mouseup",this,this.onStageMouseUp),$q.stage.on("mouseout",this,this.onStageMouseUp),$q.timer.frameLoop(1,this,this.loop);},$t.clearTimer=function(){$q.timer.clear(this,this.loop),$q.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null);},$t.stop=function(){this._dragging&&($Y.instance.disableMouseEvent=!1,$q.stage.off("mouseup",this,this.onStageMouseUp),$q.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear());},$t.loop=function(){var $d=this._parent.getMousePoint(),$t=$d.x,$l=$d.y,$k=$t-this._lastX,$W=$l-this._lastY;if(this._clickOnly){if(!(1<Math.abs($k*$q.stage._canvasTransform.getScaleX())||1<Math.abs($W*$q.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$Y.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1);}else this._offsets.push($k,$W);0==$k&&0==$W||(this._lastX=$t,this._lastY=$l,this.target.x+=$k*this._elasticRateX,this.target.y+=$W*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data));},$t.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $d=this.area.x-this.target.x;else $d=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$d/this.elasticDistance),this.target.y<this.area.y)var $t=this.area.y-this.target.y;else $t=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$t/this.elasticDistance);}},$t.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height);},$t.onStageMouseUp=function($d){if($Y.instance.disableMouseEvent=!1,$q.stage.off("mouseup",this,this.onStageMouseUp),$q.stage.off("mouseout",this,this.onStageMouseUp),$q.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $t=this._offsets.length,$l=Math.min($t,6),$k=this._offsets.length-$l,$W=$t-1;$k<$W;$W--)this._offsetY+=this._offsets[$W--],this._offsetX+=this._offsets[$W];this._offsetX=this._offsetX/$l*2,this._offsetY=this._offsetY/$l*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$q.timer.frameLoop(1,this,this.tweenMove);}else 0<this.elasticDistance?this.checkElastic():this.clear();},$t.checkElastic=function(){var $d=NaN,$t=NaN;if(this.target.x<this.area.x?$d=this.area.x:this.target.x>this.area.x+this.area.width&&($d=this.area.x+this.area.width),this.target.y<this.area.y?$t=this.area.y:this.target.y>this.area.y+this.area.height&&($t=this.area.y+this.area.height),isNaN($d)&&isNaN($t))this.clear();else{var $l={};isNaN($d)||($l.x=$d),isNaN($t)||($l.y=$t),this._tween=$O.to(this.target,$l,this.elasticBackTime,$h.sineOut,$e.create(this,this.clear),0,!1,!1);}},$t.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($q.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear());},$t.clear=function(){if(this.target){this.clearTimer();var $d=this.target;this.target=null,this._parent=null,$d.event("dragend",this.data);}},$d;}()),$h=function(){function $B(){}return $w($B,"laya.utils.Ease"),$B.linearNone=function($d,$t,$l,$k){return $l*$d/$k+$t;},$B.linearIn=function($d,$t,$l,$k){return $l*$d/$k+$t;},$B.linearInOut=function($d,$t,$l,$k){return $l*$d/$k+$t;},$B.linearOut=function($d,$t,$l,$k){return $l*$d/$k+$t;},$B.bounceIn=function($d,$t,$l,$k){return $l-$B.bounceOut($k-$d,0,$l,$k)+$t;},$B.bounceInOut=function($d,$t,$l,$k){return $d<.5*$k?.5*$B.bounceIn(2*$d,0,$l,$k)+$t:.5*$B.bounceOut(2*$d-$k,0,$l,$k)+.5*$l+$t;},$B.bounceOut=function($d,$t,$l,$k){return($d/=$k)<1/2.75?$l*(7.5625*$d*$d)+$t:$d<2/2.75?$l*(7.5625*($d-=1.5/2.75)*$d+.75)+$t:$d<2.5/2.75?$l*(7.5625*($d-=2.25/2.75)*$d+.9375)+$t:$l*(7.5625*($d-=2.625/2.75)*$d+.984375)+$t;},$B.backIn=function($d,$t,$l,$k,$W){return void 0===$W&&($W=1.70158),$l*($d/=$k)*$d*(($W+1)*$d-$W)+$t;},$B.backInOut=function($d,$t,$l,$k,$W){return void 0===$W&&($W=1.70158),($d/=.5*$k)<1?.5*$l*($d*$d*((1+($W*=1.525))*$d-$W))+$t:$l/2*(($d-=2)*$d*((1+($W*=1.525))*$d+$W)+2)+$t;},$B.backOut=function($d,$t,$l,$k,$W){return void 0===$W&&($W=1.70158),$l*(($d=$d/$k-1)*$d*(($W+1)*$d+$W)+1)+$t;},$B.elasticIn=function($d,$t,$l,$k,$W,$i){var $A;return void 0===$W&&($W=0),void 0===$i&&($i=0),0==$d?$t:1==($d/=$k)?$t+$l:($i||($i=.3*$k),$A=!$W||0<$l&&$W<$l||$l<0&&$W<-$l?($W=$l,$i/4):$i/$B.PI2*Math.asin($l/$W),-$W*Math.pow(2,10*($d-=1))*Math.sin(($d*$k-$A)*$B.PI2/$i)+$t);},$B.elasticInOut=function($d,$t,$l,$k,$W,$i){var $A;return void 0===$W&&($W=0),void 0===$i&&($i=0),0==$d?$t:2==($d/=.5*$k)?$t+$l:($i||($i=$k*(.3*1.5)),$A=!$W||0<$l&&$W<$l||$l<0&&$W<-$l?($W=$l,$i/4):$i/$B.PI2*Math.asin($l/$W),$d<1?$W*Math.pow(2,10*($d-=1))*Math.sin(($d*$k-$A)*$B.PI2/$i)*-.5+$t:$W*Math.pow(2,-10*($d-=1))*Math.sin(($d*$k-$A)*$B.PI2/$i)*.5+$l+$t);},$B.elasticOut=function($d,$t,$l,$k,$W,$i){var $A;return void 0===$W&&($W=0),void 0===$i&&($i=0),0==$d?$t:1==($d/=$k)?$t+$l:($i||($i=.3*$k),$A=!$W||0<$l&&$W<$l||$l<0&&$W<-$l?($W=$l,$i/4):$i/$B.PI2*Math.asin($l/$W),$W*Math.pow(2,-10*$d)*Math.sin(($d*$k-$A)*$B.PI2/$i)+$l+$t);},$B.strongIn=function($d,$t,$l,$k){return $l*($d/=$k)*$d*$d*$d*$d+$t;},$B.strongInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*$l*$d*$d*$d*$d*$d+$t:.5*$l*(($d-=2)*$d*$d*$d*$d+2)+$t;},$B.strongOut=function($d,$t,$l,$k){return $l*(($d=$d/$k-1)*$d*$d*$d*$d+1)+$t;},$B.sineInOut=function($d,$t,$l,$k){return .5*-$l*(Math.cos(Math.PI*$d/$k)-1)+$t;},$B.sineIn=function($d,$t,$l,$k){return-$l*Math.cos($d/$k*$B.HALF_PI)+$l+$t;},$B.sineOut=function($d,$t,$l,$k){return $l*Math.sin($d/$k*$B.HALF_PI)+$t;},$B.quintIn=function($d,$t,$l,$k){return $l*($d/=$k)*$d*$d*$d*$d+$t;},$B.quintInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*$l*$d*$d*$d*$d*$d+$t:.5*$l*(($d-=2)*$d*$d*$d*$d+2)+$t;},$B.quintOut=function($d,$t,$l,$k){return $l*(($d=$d/$k-1)*$d*$d*$d*$d+1)+$t;},$B.quartIn=function($d,$t,$l,$k){return $l*($d/=$k)*$d*$d*$d+$t;},$B.quartInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*$l*$d*$d*$d*$d+$t:.5*-$l*(($d-=2)*$d*$d*$d-2)+$t;},$B.quartOut=function($d,$t,$l,$k){return-$l*(($d=$d/$k-1)*$d*$d*$d-1)+$t;},$B.cubicIn=function($d,$t,$l,$k){return $l*($d/=$k)*$d*$d+$t;},$B.cubicInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*$l*$d*$d*$d+$t:.5*$l*(($d-=2)*$d*$d+2)+$t;},$B.cubicOut=function($d,$t,$l,$k){return $l*(($d=$d/$k-1)*$d*$d+1)+$t;},$B.quadIn=function($d,$t,$l,$k){return $l*($d/=$k)*$d+$t;},$B.quadInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*$l*$d*$d+$t:.5*-$l*(--$d*($d-2)-1)+$t;},$B.quadOut=function($d,$t,$l,$k){return-$l*($d/=$k)*($d-2)+$t;},$B.expoIn=function($d,$t,$l,$k){return 0==$d?$t:$l*Math.pow(2,10*($d/$k-1))+$t-.001*$l;},$B.expoInOut=function($d,$t,$l,$k){return 0==$d?$t:$d==$k?$t+$l:($d/=.5*$k)<1?.5*$l*Math.pow(2,10*($d-1))+$t:.5*$l*(2-Math.pow(2,-10*--$d))+$t;},$B.expoOut=function($d,$t,$l,$k){return $d==$k?$t+$l:$l*(1-Math.pow(2,-10*$d/$k))+$t;},$B.circIn=function($d,$t,$l,$k){return-$l*(Math.sqrt(1-($d/=$k)*$d)-1)+$t;},$B.circInOut=function($d,$t,$l,$k){return($d/=.5*$k)<1?.5*-$l*(Math.sqrt(1-$d*$d)-1)+$t:.5*$l*(Math.sqrt(1-($d-=2)*$d)+1)+$t;},$B.circOut=function($d,$t,$l,$k){return $l*Math.sqrt(1-($d=$d/$k-1)*$d)+$t;},$B.HALF_PI=.5*Math.PI,$B.PI2=2*Math.PI,$B;}(),$s=function(){function $f(){this._hit=null,this._unHit=null;}$w($f,"laya.utils.HitArea");var $d=$f.prototype;return $d.isHit=function($d,$t){return!!$f.isHitGraphic($d,$t,this.hit)&&!$f.isHitGraphic($d,$t,this.unHit);},$d.contains=function($d,$t){return this.isHit($d,$t);},$b(0,$d,"hit",function(){return this._hit||(this._hit=new $J()),this._hit;},function($d){this._hit=$d;}),$b(0,$d,"unHit",function(){return this._unHit||(this._unHit=new $J()),this._unHit;},function($d){this._unHit=$d;}),$f.isHitGraphic=function($d,$t,$l){if(!$l)return!1;var $k;if(!($k=$l.cmds)&&$l._one&&(($k=$f._cmds).length=1,$k[0]=$l._one),!$k)return!1;var $W,$i,$A=0;for($W=$k.length,$A=0;$A<$W;$A++)if($i=$k[$A]){var $B=$K._context;switch($i.callee){case $B._translate:case 6:$d-=$i[0],$t-=$i[1];}if($f.isHitCmd($d,$t,$i))return!0;}return!1;},$f.isHitCmd=function($d,$t,$l){if(!$l)return!1;var $k=$K._context,$W=!1;switch($l.callee){case $k._drawRect:case 13:$f._rec.setTo($l[0],$l[1],$l[2],$l[3]),$W=$f._rec.contains($d,$t);break;case $k._drawCircle:case $k._fillCircle:case 14:$W=($d-=$l[0])*$d+($t-=$l[1])*$t<$l[2]*$l[2];break;case $k._drawPoly:case 18:$d-=$l[0],$t-=$l[1],$W=$f.ptInPolygon($d,$t,$l[2]);}return $W;},$f.ptInPolygon=function($d,$t,$l){var $k;($k=$f._ptPoint).setTo($d,$t);var $W,$i=0,$A=NaN,$B=NaN,$o=NaN,$I=NaN;$W=$l.length;for(var $b=0;$b<$W;$b+=2){if($A=$l[$b],$B=$l[$b+1],$o=$l[($b+2)%$W],$B!=($I=$l[($b+3)%$W]))if(!($k.y<Math.min($B,$I)))if(!($k.y>=Math.max($B,$I)))($k.y-$B)*($o-$A)/($I-$B)+$A>$k.x&&$i++;}return $i%2==1;},$f._cmds=[],$o($f,["_rec",function(){return this._rec=new $$();},"_ptPoint",function(){return this._ptPoint=new $L();}]),$f;}(),$P=(function(){function $W($d,$t,$l,$k){this.char=$d,this.charNum=$d.charCodeAt(0),this._x=this._y=0,this.width=$t,this.height=$l,this.style=$k,this.isWord=!$W._isWordRegExp.test($d);}$w($W,"laya.utils.HTMLChar");var $d=$W.prototype;$q.imps($d,{"laya.display.ILayout":!0}),$d.setSprite=function($d){this._sprite=$d;},$d.getSprite=function(){return this._sprite;},$d._isChar=function(){return!0;},$d._getCSSStyle=function(){return this.style;},$b(0,$d,"width",function(){return this._w;},function($d){this._w=$d;}),$b(0,$d,"x",function(){return this._x;},function($d){this._sprite&&(this._sprite.x=$d),this._x=$d;}),$b(0,$d,"y",function(){return this._y;},function($d){this._sprite&&(this._sprite.y=$d),this._y=$d;}),$b(0,$d,"height",function(){return this._h;},function($d){this._h=$d;}),$W._isWordRegExp=new RegExp("[\\w.]","");}(),function(){function $t(){}$w($t,"laya.utils.Log"),$t.enable=function(){$t._logdiv||($t._logdiv=$V.window.document.createElement("div"),$V.window.document.body.appendChild($t._logdiv),$t._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;");},$t.toggle=function(){var $d=$t._logdiv.style;"1px"==$d.width?$d.width=$d.height="50%":$d.width=$d.height="1px";},$t.print=function($d){$t._logdiv&&($t.maxCount<=$t._count&&$t.clear(),$t._count++,$t._logdiv.innerText+=$d+"\n",$t._logdiv.scrollTop=$t._logdiv.scrollHeight);},$t.clear=function(){$t._logdiv.innerText="",$t._count=0;},$t._logdiv=null,$t._count=0,$t.maxCount=20;}(),function(){function $t(){}$w($t,"laya.utils.Mouse"),$b(1,$t,"cursor",function(){return $t._style.cursor;},function($d){$t._style.cursor=$d;}),$t.hide=function(){"none"!=$t.cursor&&($t._preCursor=$t.cursor,$t.cursor="none");},$t.show=function(){"none"==$t.cursor&&($t.cursor=$t._preCursor?$t._preCursor:"auto");},$t._preCursor=null,$o($t,["_style",function(){return this._style=$V.document.body.style;}]);}(),function(){function $i(){}return $w($i,"laya.utils.Pool"),$i.getPoolBySign=function($d){return $i._poolDic[$d]||($i._poolDic[$d]=[]);},$i.clearBySign=function($d){$i._poolDic[$d]&&($i._poolDic[$d].length=0);},$i.recover=function($d,$t){$t.__InPool||($t.__InPool=!0,$i.getPoolBySign($d).push($t));},$i.getItemByClass=function($d,$t){var $l=$i.getPoolBySign($d),$k=$l.length?$l.pop():new $t();return $k.__InPool=!1,$k;},$i.getItemByCreateFun=function($d,$t,$l){var $k=$i.getPoolBySign($d),$W=$k.length?$k.pop():$t.call($l);return $W.__InPool=!1,$W;},$i.getItem=function($d){var $t=$i.getPoolBySign($d),$l=$t.length?$t.pop():null;return $l&&($l.__InPool=!1),$l;},$i._poolDic={},$i.InPoolSign="__InPool",$i;}()),$X=function(){function $o(){}return $w($o,"laya.utils.Stat"),$b(1,$o,"onclick",null,function($d){$o._sp&&$o._sp.on("click",$o._sp,$d),$o._canvas&&($o._canvas.source.onclick=$d,$o._canvas.source.style.pointerEvents="");}),$o.show=function($d,$t,$l){if(void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),!$K.isConchApp||$K.isConchWebGL){if($K.isConchWebGL||$V.onMiniGame||$V.onLimixiu||($o._useCanvas=!0),$o._show=!0,$o._fpsData.length=60,$o._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$o._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$o._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$o._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$K.isWebGL){if($o._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$K.is3DMode){if($o._view[0].title="FPS(3D)",$o._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$o._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$o._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$l){var $k=8;$o._view[$k++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$o._view[$k++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$o._view[$k++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1};}else if(2==$l){$k=8;$o._view[$k++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$o._view[$k++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$o._view[$k++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$o._view[$k++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$o._view[$k++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$o._view[$k++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$o._view[$k++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2};}}else $o._view[0].title="FPS(WebGL)",$o._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};}else $o._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$o._useCanvas?$o.createUIPre($d,$t):$o.createUI($d,$t),$o.enable();}else $V.window.conch.showFPS&&$V.window.conch.showFPS($d,$t);},$o.createUIPre=function($d,$t){var $l=$V.pixelRatio;$o._width=170*$l,$o._vx=75*$l,$o._height=$l*(12*$o._view.length+3*$l)+4,$o._fontSize=12*$l;for(var $k=0;$k<$o._view.length;$k++)$o._view[$k].x=4,$o._view[$k].y=$k*$o._fontSize+2*$l;$o._canvas||(($o._canvas=new $gd("2D")).size($o._width,$o._height),($o._ctx=$o._canvas.getContext("2d")).textBaseline="top",$o._ctx.font=$o._fontSize+"px Sans-serif",$o._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$d+"px;top:"+$t+"px;width:"+$o._width/$l+"px;height:"+$o._height/$l+"px;"),$o._first=!0,$o.loop(),$o._first=!1,$V.container.appendChild($o._canvas.source);},$o.createUI=function($d,$t){var $l=$o._sp,$k=$V.pixelRatio;$l||($l=new $fd(),($o._leftText=new $Dd()).pos(5,5),$o._leftText.color="#ffffff",$l.addChild($o._leftText),($o._txt=new $Dd()).pos(80*$k,5),$o._txt.color="#ffffff",$l.addChild($o._txt),$o._sp=$l),$l.pos($d,$t);for(var $W="",$i=0;$i<$o._view.length;$i++){$W+=$o._view[$i].title+"\n";}$o._leftText.text=$W;var $A=170*$k,$B=$k*(12*$o._view.length+3*$k)+4;$o._txt.fontSize=$o._fontSize*$k,$o._leftText.fontSize=$o._fontSize*$k,$l.size($A,$B),$l.graphics.clear(),$l.graphics.setAlpha(.5),$l.graphics.drawRect(0,0,$A,$B,"#999999"),$l.graphics.setAlpha(1),$o.loop();},$o.enable=function(){$q.timer.frameLoop(1,$o,$o.loop);},$o.hide=function(){$o._show=!1,$q.timer.clear($o,$o.loop),$o._canvas&&$V.removeElement($o._canvas.source);},$o.clear=function(){$o.trianglesFaces=$o.drawCall=$o.shaderCall=$o.spriteCount=$o.spriteRenderUseCacheCount=$o.treeNodeCollision=$o.treeSpriteCollision=$o.canvasNormal=$o.canvasBitmap=$o.canvasReCache=0;},$o.loop=function(){$o._count++;var $d=$V.now();if(!($d-$o._timer<1e3)){var $t=$o._count;if($o.FPS=Math.round(1e3*$t/($d-$o._timer)),$o._show){$o.trianglesFaces=Math.round($o.trianglesFaces/$t),$o.spriteCount=$o._useCanvas?($o.drawCall=Math.round($o.drawCall/$t)-2,$o.shaderCall=Math.round($o.shaderCall/$t),Math.round($o.spriteCount/$t)-1):($o.drawCall=Math.round($o.drawCall/$t)-2,$o.shaderCall=Math.round($o.shaderCall/$t)-4,Math.round($o.spriteCount/$t)-4),$o.spriteRenderUseCacheCount=Math.round($o.spriteRenderUseCacheCount/$t),$o.canvasNormal=Math.round($o.canvasNormal/$t),$o.canvasBitmap=Math.round($o.canvasBitmap/$t),$o.canvasReCache=Math.ceil($o.canvasReCache/$t),$o.treeNodeCollision=Math.round($o.treeNodeCollision/$t),$o.treeSpriteCollision=Math.round($o.treeSpriteCollision/$t);var $l=0<$o.FPS?Math.floor(1e3/$o.FPS).toString():" ";$o._fpsStr=$o.FPS+($o.renderSlow?" slow":"")+" "+$l,$o._spriteStr=$o.spriteCount+($o.spriteRenderUseCacheCount?"/"+$o.spriteRenderUseCacheCount:""),$o._canvasStr=$o.canvasReCache+"/"+$o.canvasNormal+"/"+$o.canvasBitmap,$o.currentMemorySize=$y.systemResourceManager.memorySize,$o._useCanvas?$o.renderInfoPre():$o.renderInfo(),$o.clear();}$o._count=0,$o._timer=$d;}},$o.renderInfoPre=function(){if($o._canvas){var $d=$o._ctx;$d.clearRect($o._first?0:$o._vx,0,$o._width,$o._height);for(var $t=$K.WebGL.mainContext,$l=0;$l<$o._view.length;$l++){var $k=$o._view[$l];$o._first&&($d.fillStyle="white",$d.fillText($k.title,$k.x,$k.y,null,null,null)),$d.fillStyle=$k.color;var $W=-1;if(($k=$o._view[$l]).varying){if($t)switch($k.varying){case 1:$W=$t.getParameter($t[$k.value]);break;case 2:$W=$t.getExtension($k.value);}}else $W=$o[$k.value];"M"==$k.units&&($W=Math.floor($W/1048576*100)/100+" M"),"K"==$k.units&&($W=Math.floor($W/1024*100)/100+" K"),"string"==$k.units&&($W=$W.match(/\d+\.?\d/i)),$d.fillText($W+"",$k.x+$o._vx,$k.y,null,null,null);}}},$o.renderInfo=function(){for(var $d="",$t=$K.WebGL.mainContext,$l=0;$l<$o._view.length;$l++){var $k=$o._view[$l],$W=-1;if($k.varying){if($t)switch($k.varying){case 1:$W=$t.getParameter($t[$k.value]);break;case 2:$W=$t.getExtension($k.value);}}else $W=$o[$k.value];"M"==$k.units&&($W=Math.floor($W/1048576*100)/100+" M"),"K"==$k.units&&($W=Math.floor($W/1024*100)/100+" K"),"string"==$k.units&&($W=$W.match(/\d+\.?\d/i)),$d+=$W+"\n";}$o._txt.text=$d;},$o.FPS=0,$o.loopCount=0,$o.shaderCall=0,$o.drawCall=0,$o.trianglesFaces=0,$o.spriteCount=0,$o.spriteRenderUseCacheCount=0,$o.treeNodeCollision=0,$o.treeSpriteCollision=0,$o.canvasNormal=0,$o.canvasBitmap=0,$o.canvasReCache=0,$o.renderSlow=!1,$o.currentMemorySize=0,$o._fpsStr=null,$o._canvasStr=null,$o._spriteStr=null,$o._fpsData=[],$o._timer=0,$o._count=0,$o._view=[],$o._fontSize=12,$o._txt=null,$o._leftText=null,$o._sp=null,$o._show=!1,$o._useCanvas=!1,$o._canvas=null,$o._ctx=null,$o._first=!1,$o._vx=NaN,$o._width=0,$o._height=100,$o;}(),$m=(function(){function $d(){this._strsToID={},this._idToStrs=[],this._length=0;}$w($d,"laya.utils.StringKey");var $t=$d.prototype;$t.add=function($d){var $t=this._strsToID[$d];return null!=$t?$t:(this._idToStrs[this._length]=$d,this._strsToID[$d]=this._length++);},$t.getID=function($d){var $t=this._strsToID[$d];return null==$t?-1:$t;},$t.getName=function($d){var $t=this._idToStrs[$d];return null==$t?void 0:$t;};}(),function(){var $I;function $d(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init();}$w($d,"laya.utils.Timer");var $t=$d.prototype;return $t._init=function(){$q.timer&&$q.timer.frameLoop(1,this,this._update);},$t._now=function(){return Date.now();},$t._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $d=this.currFrame=this.currFrame+this.scale,$t=this._now();this._delta=($t-this._lastTimer)*this.scale;var $l=this.currTimer=this.currTimer+this._delta;$q.isDebug&&6e4<Math.abs($t-this._lastTimer)&&console.error("系统时间错误！"+($t-this._lastTimer)),this._lastTimer=$t;var $k=this._handlers;for($A=this._count=0,$B=$k.length;$A<$B;$A++)if(null!==($o=$k[$A]).method){var $W=$o.userFrame?$d:$l;if($W>=$o.exeTime)if($o.repeat){if($o.jumpFrame)for(;$W>=$o.exeTime;)$o.exeTime+=$o.delay,$o.run(!1);else $o.exeTime+=$o.delay,$o.run(!1),$W>$o.exeTime&&($o.exeTime+=Math.ceil(($W-$o.exeTime)/$o.delay)*$o.delay);}else $o.run(!0);}else this._count++;(30<this._count||$d%200==0)&&this._clearHandlers();for(var $i=this._laters,$A=0,$B=$i.length-1;$A<=$B;$A++){var $o=$i[$A];this._isIgnoreRecover($o)||(null!==$o.method&&(delete this._map[$o.key],$o.run(!1)),this._recoverHandler($o)),$A===$B&&($B=$i.length-1);}$i.length=0;}},$t._clearHandlers=function(){for(var $d=this._handlers,$t=0,$l=$d.length;$t<$l;$t++){var $k=$d[$t];null!==$k.method?this._temp.push($k):this._isIgnoreRecover($k)?this._temp.push($k):this._recoverHandler($k);}this._handlers=this._temp,this._temp=$d,this._temp.length=0;},$t._recoverHandler=function($d){this._map[$d.key]==$d&&delete this._map[$d.key],$d.recover();},$t._create=function($d,$t,$l,$k,$W,$i,$A,$B){if(!$l)return $W.apply($k,$i),null;if($A){var $o=this._getHandler($k,$W);if($o)return $o.repeat=$t,$o.userFrame=$d,$o.delay=$l,$o.ignoreRecover=$B,$o.caller=$k,$o.method=$W,$o.args=$i,$o.exeTime=$l+($d?this.currFrame:this.currTimer+this._now()-this._lastTimer),$o;}return($o=$I.create()).repeat=$t,$o.userFrame=$d,$o.delay=$l,$o.ignoreRecover=$B,$o.caller=$k,$o.method=$W,$o.args=$i,$o.exeTime=$l+($d?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($o),this._handlers.push($o),$o;},$t._indexHandler=function($d){var $t=$d.caller,$l=$d.method,$k=$t?$t.$_GID||($t.$_GID=$F.getGID()):0,$W=$l.$_TID||($l.$_TID=this._mid++);$d.key=$k+"_"+$W,this._map[$d.key]=$d;},$t.once=function($d,$t,$l,$k,$W){void 0===$W&&($W=!0),this._create(!1,!1,$d,$t,$l,$k,$W,!1);},$t.loop=function($d,$t,$l,$k,$W,$i,$A){void 0===$W&&($W=!0),void 0===$i&&($i=!1),void 0===$A&&($A=!1);var $B=this._create(!1,!0,$d,$t,$l,$k,$W,$A);$B&&($B.jumpFrame=$i);},$t.frameOnce=function($d,$t,$l,$k,$W){void 0===$W&&($W=!0),this._create(!0,!1,$d,$t,$l,$k,$W,!1);},$t.frameLoop=function($d,$t,$l,$k,$W,$i){void 0===$W&&($W=!0),void 0===$i&&($i=!1),this._create(!0,!0,$d,$t,$l,$k,$W,$i);},$t.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$I._freeCount;},$t.clear=function($d,$t){var $l=this._getHandler($d,$t);return!(!$l||this._isIgnoreRecover($l))&&(delete this._map[$l.key],$l.key=null,$l.clear(),!0);},$t.clearAll=function($d){if($d)for(var $t=0,$l=this._handlers.length;$t<$l;$t++){var $k=this._handlers[$t];$k.caller===$d&&(this._isIgnoreRecover($k)||(delete this._map[$k.key],$k.key=null,$k.clear()));}},$t._getHandler=function($d,$t){var $l=$d?$d.$_GID||($d.$_GID=$F.getGID()):0,$k=$t.$_TID||($t.$_TID=this._mid++);return this._map[$l+"_"+$k];},$t._isIgnoreRecover=function($d){if($d.ignoreRecover||$d.caller&&"IgnoreRecover"==$d.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $t="";try{arguments.propertyIsEnumerable.caller;}catch($d){$t=$d.stack;}$q.recordError("报错：核心定时器销毁忽略  "+$t);}return!0;}return!1;},$t.hasHandler=function($d,$t){return this._map[$d.$_GID+"_"+$t.$_TID];},$t.callLater=function($d,$t,$l){if(null==this._getHandler($d,$t)){var $k=$I.create();$k.caller=$d,$k.method=$t,$k.args=$l,this._indexHandler($k),this._laters.push($k);}},$t.runCallLater=function($d,$t){var $l=this._getHandler($d,$t);$l&&null!=$l.method&&(this._isIgnoreRecover($l)||(delete this._map[$l.key],$l.run(!0)));},$t.runTimer=function($d,$t){this.runCallLater($d,$t);},$b(0,$t,"delta",function(){return this._delta;}),$d.__init$=function(){$I=function(){function $t(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1;}$w($t,"");var $d=$t.prototype;return $d.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1;},$d.recover=function(){this.clear(),this.args=$t._freeHandler,$t._freeHandler=this,$t._freeCount++;},$d.run=function($d){var $t=this.caller;if($t&&$t.destroyed)return this.clear();var $l=this.method,$k=this.args;$d&&this.clear(),null!=$l&&($k?$l.apply($t,$k):$l.call($t));},$t._freeHandler=null,$t._freeCount=0,$t.create=function(){var $d=$t._freeHandler;return $d?($t._freeHandler=$d.args,--$t._freeCount,$d.args=null,$d):new $t();},$t;}();},$d;}()),$O=function(){function $f(){this.gid=0;}$w($f,"laya.utils.Tween");var $d=$f.prototype;return $d.to=function($d,$t,$l,$k,$W,$i,$A){return void 0===$i&&($i=0),void 0===$A&&($A=!1),this._create($d,$t,$l,$k,$W,$i,$A,!0,!1,!0);},$d.from=function($d,$t,$l,$k,$W,$i,$A){return void 0===$i&&($i=0),void 0===$A&&($A=!1),this._create($d,$t,$l,$k,$W,$i,$A,!1,!1,!0);},$d._create=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){if(!$d)throw new Error("Tween:target is null");this._target=$d,this._duration=$l,this._ease=$k||$t.ease||$f.easeNone,this._complete=$W||$t.complete,this._delay=$i,this._props=[],this._usedTimer=0,this._startTimer=$V.now(),this._usedPool=$o,this._delayParam=null,this.update=$t.update;var $b=$d.$_GID||($d.$_GID=$F.getGID());return $f.tweenMap[$b]?($A&&$f.clearTween($d),$f.tweenMap[$b].push(this)):$f.tweenMap[$b]=[this],$I?$i<=0?this.firstStart($d,$t,$B):(this._delayParam=[$d,$t,$B],$q.scaleTimer.once($i,this,this.firstStart,this._delayParam)):this._initProps($d,$t,$B),this;},$d.firstStart=function($d,$t,$l){this._delayParam=null,$d.destroyed?this.clear():(this._initProps($d,$t,$l),this._beginLoop());},$d._initProps=function($d,$t,$l){for(var $k in $t)if("number"==typeof $d[$k]){var $W=$l?$d[$k]:$t[$k],$i=$l?$t[$k]:$d[$k];this._props.push([$k,$W,$i-$W]),$l||($d[$k]=$W);}},$d._beginLoop=function(){$q.scaleTimer.frameLoop(1,this,this._doEase);},$d._doEase=function(){this._updateEase($V.now());},$d._updateEase=function($d){var $t=this._target;if($t){if($t.destroyed)return $f.clearTween($t);var $l=this._usedTimer=$d-this._startTimer-this._delay;if(!($l<0)){if($l>=this._duration)return this.complete();for(var $k=0<$l?this._ease($l,0,1,this._duration):0,$W=this._props,$i=0,$A=$W.length;$i<$A;$i++){var $B=$W[$i];$t[$B[0]]=$B[1]+$k*$B[2];}this.update&&this.update.run();}}},$d.complete=function(){if(this._target){$q.scaleTimer.runTimer(this,this.firstStart);for(var $d=this._target,$t=this._props,$l=this._complete,$k=0,$W=$t.length;$k<$W;$k++){var $i=$t[$k];$d[$i[0]]=$i[1]+$i[2];}this.update&&this.update.run(),this.clear(),$l&&$l.run();}},$d.pause=function(){$q.scaleTimer.clear(this,this._beginLoop),$q.scaleTimer.clear(this,this._doEase),$q.scaleTimer.clear(this,this.firstStart);var $d;($d=$V.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$d);},$d.setStartTime=function($d){this._startTimer=$d;},$d.clear=function(){this._target&&(this._remove(),this._clear());},$d._clear=function(){this.pause(),$q.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$P.recover("tween",this));},$d.recover=function(){this._usedPool=!0,this._clear();},$d._remove=function(){var $d=$f.tweenMap[this._target.$_GID];if($d)for(var $t=0,$l=$d.length;$t<$l;$t++)if($d[$t]===this){$d.splice($t,1);break;}},$d.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$V.now(),this._delayParam)$q.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $d=this._props,$t=0,$l=$d.length;$t<$l;$t++){var $k=$d[$t];this._target[$k[0]]=$k[1];}$q.scaleTimer.once(this._delay,this,this._beginLoop);}},$d.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$V.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$q.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop());},$b(0,$d,"progress",null,function($d){var $t=$d*this._duration;this._startTimer=$V.now()-this._delay-$t;}),$f.to=function($d,$t,$l,$k,$W,$i,$A,$B){return void 0===$i&&($i=0),void 0===$A&&($A=!1),void 0===$B&&($B=!0),$P.getItemByClass("tween",$f)._create($d,$t,$l,$k,$W,$i,$A,!0,$B,!0);},$f.from=function($d,$t,$l,$k,$W,$i,$A,$B){return void 0===$i&&($i=0),void 0===$A&&($A=!1),void 0===$B&&($B=!0),$P.getItemByClass("tween",$f)._create($d,$t,$l,$k,$W,$i,$A,!1,$B,!0);},$f.clearAll=function($d){if($d&&$d.$_GID){var $t=$f.tweenMap[$d.$_GID];if($t){for(var $l=0,$k=$t.length;$l<$k;$l++)$t[$l]._clear();$t.length=0;}}},$f.clear=function($d){$d.clear();},$f.clearTween=function($d){$f.clearAll($d);},$f.easeNone=function($d,$t,$l,$k){return $l*$d/$k+$t;},$f.tweenMap={},$f;}(),$F=function(){function $B(){}return $w($B,"laya.utils.Utils"),$B.toRadian=function($d){return $d*$B._pi2;},$B.toAngle=function($d){return $d*$B._pi;},$B.toHexColor=function($d){if($d<0||isNaN($d))return null;for(var $t=$d.toString(16);$t.length<6;)$t="0"+$t;return"#"+$t;},$B.getGID=function(){return $B._gid++;},$B.concatArray=function($d,$t){if(!$t)return $d;if(!$d)return $t;var $l=0,$k=$t.length;for($l=0;$l<$k;$l++)$d.push($t[$l]);return $d;},$B.clearArray=function($d){return $d&&($d.length=0),$d;},$B.copyArray=function($d,$t){if($d||($d=[]),!$t)return $d;$d.length=$t.length;var $l=0,$k=$t.length;for($l=0;$l<$k;$l++)$d[$l]=$t[$l];return $d;},$B.getGlobalRecByPoints=function($d,$t,$l,$k,$W){var $i,$A;return $i=new $L($t,$l),$i=$d.localToGlobal($i),$A=new $L($k,$W),$A=$d.localToGlobal($A),$$._getWrapRec([$i.x,$i.y,$A.x,$A.y]);},$B.getGlobalPosAndScale=function($d){return $B.getGlobalRecByPoints($d,0,0,1,1);},$B.bind=function($d,$t){return $d.bind($t);},$B.measureText=function($d,$t){return $r.measureText($d,$t);},$B.contextMeasureText=function($d){var $t=$V.context.measureText($d);return $t||($t={width:16,height:16}),$t;},$B.updateOrder=function($d){if(!$d||$d.length<2)return!1;for(var $t,$l=1,$k=0,$W=$d.length,$i=NaN;$l<$W;){for($t=$d[$k=$l],$i=$d[$k]._zOrder;-1<--$k&&$d[$k]._zOrder>$i;)$d[$k+1]=$d[$k];$d[$k+1]=$t,$l++;}var $A=$t.parent.conchModel;if($A)if(null!=$A.updateZOrder)$A.updateZOrder();else{for($l=0;$l<$W;$l++)$A.removeChild($d[$l].conchModel);for($l=0;$l<$W;$l++)$A.addChildAt($d[$l].conchModel,$l);}return!0;},$B.transPointList=function($d,$t,$l){var $k=0,$W=$d.length;for($k=0;$k<$W;$k+=2)$d[$k]+=$t,$d[$k+1]+=$l;},$B.parseInt=function($d,$t){void 0===$t&&($t=0);var $l=$V.window.parseInt($d,$t);return isNaN($l)?0:$l;},$B.getFileExtension=function($d){$B._extReg.lastIndex=$d.lastIndexOf(".");var $t=$B._extReg.exec($d);return $t&&1<$t.length?$t[1].toLowerCase():null;},$B.getTransformRelativeToWindow=function($d,$t,$l){var $k=$q.stage,$W=laya.utils.Utils.getGlobalPosAndScale($d),$i=$k._canvasTransform.clone(),$A=$i.tx,$B=$i.ty;$i.rotate(-Math.PI/180*$q.stage.canvasDegree),$i.scale($q.stage.clientScaleX,$q.stage.clientScaleY);var $o=$q.stage.canvasDegree%180!=0,$I=NaN,$b=NaN;$o?($I=$l+$W.y,$b=$t+$W.x,$I*=$i.d,$b*=$i.a,90==$q.stage.canvasDegree?($I=$A-$I,$b+=$B):($I+=$A,$b=$B-$b)):($I=$t+$W.x,$b=$l+$W.y,$I*=$i.a,$b*=$i.d,$I+=$A,$b+=$B);var $f=NaN,$J=NaN;return $J=$o?($f=$i.d*$W.height,$i.a*$W.width):($f=$i.a*$W.width,$i.d*$W.height),{x:$I,y:$b,scaleX:$f,scaleY:$J};},$B.fitDOMElementInArea=function($d,$t,$l,$k,$W,$i){$d._fitLayaAirInitialized||($d._fitLayaAirInitialized=!0,$d.style.transformOrigin=$d.style.webKittransformOrigin="left top",$d.style.position="absolute");var $A=$B.getTransformRelativeToWindow($t,$l,$k);$d.style.transform=$d.style.webkitTransform="scale("+$A.scaleX+","+$A.scaleY+") rotate("+$q.stage.canvasDegree+"deg)",$d.style.width=$W+"px",$d.style.height=$i+"px",$d.style.left=$A.x+"px",$d.style.top=$A.y+"px";},$B.isOkTextureList=function($d){if(!$d)return!1;var $t,$l=0,$k=$d.length;for($l=0;$l<$k;$l++)if(!($t=$d[$l])||!$t.source)return!1;return!0;},$B.isOKCmdList=function($d){if(!$d)return!1;var $t,$l,$k=0,$W=$d.length,$i=$K._context;for($k=0;$k<$W;$k++)switch(($t=$d[$k]).callee){case $i._drawTexture:case $i._fillTexture:case $i._drawTextureWithTransform:if(!($l=$t[0])||!$l.source)return!1;}return!0;},$B._gid=1,$B._pi=180/Math.PI,$B._pi2=Math.PI/180,$B._extReg=/\.(\w+)\??/g,$B.parseXMLFromString=function($d){var $t;if($d=$d.replace(/>\s+</g,"><"),-1<($t=new DOMParser().parseFromString($d,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($t.firstChild.firstChild.textContent);return $t;},$B;}(),$a=function(){function $d(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$K.isWebGL&&$U.regCacheByFunction($F.bind(this.startDispose,this),$F.bind(this.getCacheList,this));}$w($d,"laya.utils.VectorGraphManager");var $t=$d.prototype;return $t.getId=function(){return this._id++;},$t.addShape=function($d,$t){this.shapeDic[$d]=$t,this.useDic[$d]||(this.useDic[$d]=!0);},$t.addLine=function($d,$t){this.shapeLineDic[$d]=$t,this.shapeLineDic[$d]||(this.shapeLineDic[$d]=!0);},$t.getShape=function($d){this._checkKey&&null!=this.useDic[$d]&&(this.useDic[$d]=!0);},$t.deleteShape=function($d){this.shapeDic[$d]&&(this.shapeDic[$d]=null,delete this.shapeDic[$d]),this.shapeLineDic[$d]&&(this.shapeLineDic[$d]=null,delete this.shapeLineDic[$d]),null!=this.useDic[$d]&&delete this.useDic[$d];},$t.getCacheList=function(){var $d,$t=[];for($d in this.shapeDic)$t.push(this.shapeDic[$d]);for($d in this.shapeLineDic)$t.push(this.shapeLineDic[$d]);return $t;},$t.startDispose=function($d){var $t;for($t in this.useDic)this.useDic[$t]=!1;this._checkKey=!0;},$t.endDispose=function(){if(this._checkKey){var $d;for($d in this.useDic)this.useDic[$d]||this.deleteShape($d);this._checkKey=!1;}},$d.getInstance=function(){return $d.instance=$d.instance||new $d();},$d.instance=null,$d;}(),$_=function(){function $k(){this._obj=null,this._obj=$k.supportWeakMap?new $V.window.WeakMap():{},$k.supportWeakMap||$k._maps.push(this);}$w($k,"laya.utils.WeakObject");var $d=$k.prototype;return $d.set=function($d,$t){if(null!=$d)if($k.supportWeakMap){var $l=$d;"string"!=typeof $d&&"number"!=typeof $d||($l=$k._keys[$d])||($l=$k._keys[$d]={k:$d}),this._obj.set($l,$t);}else"string"==typeof $d||"number"==typeof $d?this._obj[$d]=$t:($d.$_GID||($d.$_GID=$F.getGID()),this._obj[$d.$_GID]=$t);},$d.get=function($d){if(null==$d)return null;if($k.supportWeakMap){var $t="string"==typeof $d||"number"==typeof $d?$k._keys[$d]:$d;return $t?this._obj.get($t):null;}return"string"==typeof $d||"number"==typeof $d?this._obj[$d]:this._obj[$d.$_GID];},$d.del=function($d){if(null!=$d)if($k.supportWeakMap){var $t="string"==typeof $d||"number"==typeof $d?$k._keys[$d]:$d;if(!$t)return;this._obj.delete($t);}else"string"==typeof $d||"number"==typeof $d?delete this._obj[$d]:delete this._obj[this._obj.$_GID];},$d.has=function($d){if(null==$d)return!1;if($k.supportWeakMap){var $t="string"==typeof $d||"number"==typeof $d?$k._keys[$d]:$d;return this._obj.has($t);}return"string"==typeof $d||"number"==typeof $d?null!=this._obj[$d]:null!=this._obj[this._obj.$_GID];},$k.__init__=function(){($k.supportWeakMap=null!=$V.window.WeakMap)||$q.timer.loop($k.delInterval,null,$k.clearCache);},$k.clearCache=function(){for(var $d=0,$t=$k._maps.length;$d<$t;$d++){$k._maps[$d]._obj={};}},$k.supportWeakMap=!1,$k.delInterval=3e5,$k._keys={},$k._maps=[],$o($k,["I",function(){return this.I=new $k();}]),$k;}(),$v=function(){function $d(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null;}$w($d,"laya.utils.WordText");var $t=$d.prototype;return $t.setText=function($d){this.changed=!0,this._text=$d;},$t.toString=function(){return this._text;},$t.charCodeAt=function($d){return this._text?this._text.charCodeAt($d):NaN;},$t.charAt=function($d){return this._text?this._text.charAt($d):null;},$b(0,$t,"length",function(){return this._text?this._text.length:0;}),$d;}(),$dd=function($d){function $A(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$A.__super.call(this),this._childs=$A.ARRAY_EMPTY,this._$P=$A.PROP_EMPTY,this.timer=$q.scaleTimer,this.conchModel=$K.isConchNode?this.createConchModel():null;}$w($A,"laya.display.Node",$I);var $t=$A.prototype;return $t._setBit=function($d,$t){1==$d&&this._getBit($d)!=$t&&this._updateDisplayedInstage();$t?this._bits|=$d:this._bits&=~$d;},$t._getBit=function($d){return 0!=(this._bits&$d);},$t._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1);},$t._setUpNoticeType=function($d){var $t=this;for($t._setBit($d,!0),$t=$t.parent;$t;){if($t._getBit($d))return;$t._setBit($d,!0),$t=$t.parent;}},$t.on=function($d,$t,$l,$k){return"display"!==$d&&"undisplay"!==$d||this._getBit(1)||this._setUpNoticeType(1),this._createListener($d,$t,$l,$k,!1);},$t.once=function($d,$t,$l,$k){return"display"!==$d&&"undisplay"!==$d||this._getBit(1)||this._setUpNoticeType(1),this._createListener($d,$t,$l,$k,!0);},$t.createConchModel=function(){return null;},$t.destroy=function($d){void 0===$d&&($d=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($d?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this);},$t.destroyChildren=function(){if(this._childs)for(var $d=this._childs.length-1;-1<$d;$d--)this._childs[$d].destroy(!0);},$t.addChild=function($d){if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),$d._parent===this){var $t=this.getChildIndex($d);$t!==this._childs.length-1&&(this._childs.splice($t,1),this._childs.push($d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,this._childs.length-1)),this._childChanged());}else $d.parent&&$d.parent.removeChild($d),this._childs===$A.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,this._childs.length-1),($d.parent=this)._childChanged();return $d;},$t.addChildren=function($d){for(var $t=arguments,$l=0,$k=$t.length;$l<$k;)this.addChild($t[$l++]);},$t.addChildAt=function($d,$t){if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),0<=$t&&$t<=this._childs.length){if($d._parent===this){var $l=this.getChildIndex($d);this._childs.splice($l,1),this._childs.splice($t,0,$d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,$t)),this._childChanged();}else $d.parent&&$d.parent.removeChild($d),this._childs===$A.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($t,0,$d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,$t),$d.parent=this;return $d;}throw new Error("appendChildAt:The index is out of bounds");},$t.getChildIndex=function($d){return this._childs.indexOf($d);},$t.getChildByName=function($d){var $t=this._childs;if($t)for(var $l=0,$k=$t.length;$l<$k;$l++){var $W=$t[$l];if($W.name===$d)return $W;}return null;},$t._get$P=function($d){return this._$P[$d];},$t._set$P=function($d,$t){return this.destroyed||(this._$P===$A.PROP_EMPTY&&(this._$P={}),this._$P[$d]=$t),$t;},$t.getChildAt=function($d){return this._childs[$d];},$t.setChildIndex=function($d,$t){var $l=this._childs;if($t<0||$t>=$l.length)throw new Error("setChildIndex:The index is out of bounds.");var $k=this.getChildIndex($d);if($k<0)throw new Error("setChildIndex:node is must child of this object.");return $l.splice($k,1),$l.splice($t,0,$d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,$t)),this._childChanged(),$d;},$t._childChanged=function($d){},$t.removeChild=function($d){if(!this._childs)return $d;var $t=this._childs.indexOf($d);return this.removeChildAt($t);},$t.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this;},$t.removeChildByName=function($d){var $t=this.getChildByName($d);return $t&&this.removeChild($t),$t;},$t.removeChildAt=function($d){var $t=this.getChildAt($d);if($t){for(var $l=this._childs.length-1,$k=$d;$k<$l;++$k)this._childs[$k]=this._childs[$k+1];this._childs.length=$l,this.conchModel&&this.conchModel.removeChild($t.conchModel),$t.parent=null;}return $t;},$t.removeChildren=function($d,$t){if(void 0===$d&&($d=0),void 0===$t&&($t=2147483647),this._childs&&0<this._childs.length){var $l=this._childs;if(0===$d&&$i<=$t){var $k=$l;this._childs=$A.ARRAY_EMPTY;}else $k=$l.splice($d,$t-$d);for(var $W=0,$i=$k.length;$W<$i;$W++)$k[$W].parent=null,this.conchModel&&this.conchModel.removeChild($k[$W].conchModel);}return this;},$t.replaceChild=function($d,$t){var $l=this._childs.indexOf($t);return-1<$l?(this._childs.splice($l,1,$d),this.conchModel&&(this.conchModel.removeChild($t.conchModel),this.conchModel.addChildAt($d.conchModel,$l)),$t.parent=null,$d.parent=this,$d):null;},$t._updateDisplayedInstage=function(){var $d;$d=this;var $t=$q.stage;for(this._displayedInStage=!1;$d;){if($d._getBit(1)){this._displayedInStage=$d._displayedInStage;break;}if($d==$t||$d._displayedInStage){this._displayedInStage=!0;break;}$d=$d.parent;}},$t._setDisplay=function($d){this._displayedInStage!==$d&&((this._displayedInStage=$d)?this.event("display"):this.event("undisplay"));},$t._displayChild=function($d,$t){var $l=$d._childs;if($l)for(var $k=0;$k<$l.length;$k++){var $W=$l[$k];$W&&$W._getBit(1)&&(0<$W._childs.length?this._displayChild($W,$t):$W._setDisplay($t));}$d._setDisplay($t);},$t.contains=function($d){if($d===this)return!0;for(;$d;){if($d.parent===this)return!0;$d=$d.parent;}return!1;},$t.timerLoop=function($d,$t,$l,$k,$W,$i){void 0===$W&&($W=!0),void 0===$i&&($i=!1),this.timer.loop($d,$t,$l,$k,$W,$i);},$t.timerOnce=function($d,$t,$l,$k,$W){void 0===$W&&($W=!0),this.timer._create(!1,!1,$d,$t,$l,$k,$W);},$t.frameLoop=function($d,$t,$l,$k,$W){void 0===$W&&($W=!0),this.timer._create(!0,!0,$d,$t,$l,$k,$W);},$t.frameOnce=function($d,$t,$l,$k,$W){void 0===$W&&($W=!0),this.timer._create(!0,!1,$d,$t,$l,$k,$W);},$t.clearTimer=function($d,$t){this.timer.clear($d,$t);},$b(0,$t,"numChildren",function(){return this._childs.length;}),$b(0,$t,"destroyed",function(){return this._destroyed;}),$b(0,$t,"parent",function(){return this._parent;},function($d){this._parent!==$d&&($d?(this._parent=$d,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$d.displayedInStage&&this._displayChild(this,!0)),$d._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$d));}),$b(0,$t,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage;}),$A.ARRAY_EMPTY=[],$A.PROP_EMPTY={},$A.NOTICE_DISPLAY=1,$A.MOUSEENABLE=2,$A;}(),$td=function($d){function $J($d){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$J.__super.call(this),this._padding=$J._PADDING,this._spacing=$J._SPACING,this._aligns=$J._ALIGNS,this._font=$c.EMPTY,this._ower=$d;}$w($J,"laya.display.css.CSSStyle",$d);var $t=$J.prototype;return $t.destroy=function(){this._ower=null,this._font=null,this._rect=null;},$t.inherit=function($d){this._font=$d._font,this._spacing=$d._spacing===$J._SPACING?$J._SPACING:$d._spacing.slice(),this.lineHeight=$d.lineHeight;},$t._widthAuto=function(){return 0!=(262144&this._type);},$t.widthed=function($d){return 0!=(8&this._type);},$t._calculation=function($d,$t){if($t.indexOf("%")<0)return!1;var $k=this._ower,$W=$k.parent,$i=this._rect;function $A($d,$t,$l){return $d*$l[0]+$t*$l[1]+$l[2];}function $l($d){var $t=$W.width,$l=$k.width;$i.width&&($k.width=$A($t,$l,$i.width)),$i.height&&($k.height=$A($t,$l,$i.height)),$i.left&&($k.x=$A($t,$l,$i.left)),$i.top&&($k.y=$A($t,$l,$i.top));}null===$i&&($W._getCSSStyle()._type|=524288,$W.on("resize",this,$l),this._rect=$i={input:{}});var $B=$t.split(" ");return $B[0]=parseFloat($B[0])/100,1==$B.length?$B[1]=$B[2]=0:($B[1]=parseFloat($B[1])/100,$B[2]=parseFloat($B[2])),$i[$d]=$B,$i.input[$d]=$t,$l(),!0;},$t.heighted=function($d){return 0!=(8192&this._type);},$t.size=function($d,$t){var $l=this._ower,$k=!1;-1!==$d&&$d!=this._ower.width&&(this._type|=8,this._ower.width=$d,$k=!0),-1!==$t&&$t!=this._ower.height&&(this._type|=8192,this._ower.height=$t,$k=!0),$k&&($l._layoutLater(),524288&this._type&&$l.event("resize",this));},$t._getAlign=function(){return this._aligns[0];},$t._getValign=function(){return this._aligns[1];},$t._getCssFloat=function(){return 0!=(32768&this._type)?32768:0;},$t._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $c(this._font));},$t.render=function($d,$t,$l,$k){var $W=$d.width,$i=$d.height;$l-=$d.pivotX,$k-=$d.pivotY,this._bgground&&null!=this._bgground.color&&$t.ctx.fillRect($l,$k,$W,$i,this._bgground.color),this._border&&this._border.color&&$t.drawRect($l,$k,$W,$i,this._border.color.strColor,this._border.size);},$t.getCSSStyle=function(){return this;},$t.cssText=function($d){this.attrs($J.parseOneCSS($d,";"));},$t.attrs=function($d){if($d)for(var $t=0,$l=$d.length;$t<$l;$t++){var $k=$d[$t];this[$k[0]]=$k[1];}},$t.setTransform=function($d){"none"===$d?this._tf=$B._TF_EMPTY:this.attrs($J.parseOneCSS($d,","));},$t.translate=function($d,$t){this._tf===$B._TF_EMPTY&&(this._tf=new $W()),this._tf.translateX=$d,this._tf.translateY=$t;},$t.scale=function($d,$t){this._tf===$B._TF_EMPTY&&(this._tf=new $W()),this._tf.scaleX=$d,this._tf.scaleY=$t;},$t._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type);},$b(0,$t,"block",$d.prototype._$get_block,function($d){$d?this._type|=1:this._type&=-2;}),$b(0,$t,"valign",function(){return $J._valigndef[this._aligns[1]];},function($d){this._aligns===$J._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$J._valigndef[$d];}),$b(0,$t,"height",null,function($d){if(this._type|=8192,"string"==typeof $d){if(this._calculation("height",$d))return;$d=parseInt($d);}this.size(-1,$d);}),$b(0,$t,"width",null,function($d){if(this._type|=8,"string"==typeof $d){var $t=$d.indexOf("auto");if(0<=$t&&(this._type|=262144,$d=$d.substr(0,$t)),this._calculation("width",$d))return;$d=parseInt($d);}this.size($d,-1);}),$b(0,$t,"fontWeight",function(){return this._font.weight;},function($d){this._createFont().weight=$d;}),$b(0,$t,"left",null,function($d){var $t=this._ower;if("string"==typeof $d){if("center"===$d?$d="50% -50% 0":"right"===$d&&($d="100% -100% 0"),this._calculation("left",$d))return;$d=parseInt($d);}$t.x=$d;}),$b(0,$t,"_translate",null,function($d){this.translate($d[0],$d[1]);}),$b(0,$t,"absolute",function(){return 0!=(4&this._type);}),$b(0,$t,"top",null,function($d){var $t=this._ower;if("string"==typeof $d){if("middle"===$d?$d="50% -50% 0":"bottom"===$d&&($d="100% -100% 0"),this._calculation("top",$d))return;$d=parseInt($d);}$t.y=$d;}),$b(0,$t,"align",function(){return $J._aligndef[this._aligns[0]];},function($d){this._aligns===$J._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$J._aligndef[$d];}),$b(0,$t,"bold",function(){return this._font.bold;},function($d){this._createFont().bold=$d;}),$b(0,$t,"padding",function(){return this._padding;},function($d){this._padding=$d;}),$b(0,$t,"leading",function(){return this._spacing[1];},function($d){"string"==typeof $d&&($d=parseInt($d+"")),this._spacing===$J._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$d;}),$b(0,$t,"lineElement",function(){return 0!=(65536&this._type);},function($d){$d?this._type|=65536:this._type&=-65537;}),$b(0,$t,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left";},function($d){this.lineElement=!1,"right"===$d?this._type|=32768:this._type&=-32769;}),$b(0,$t,"textDecoration",function(){return this._font.decoration;},function($d){this._createFont().decoration=$d;}),$b(0,$t,"whiteSpace",function(){return 131072&this._type?"nowrap":"";},function($d){"nowrap"===$d&&(this._type|=131072),"none"===$d&&(this._type&=-131073);}),$b(0,$t,"background",null,function($d){$d?(this._bgground||(this._bgground={}),this._bgground.color=$d,this._ower.conchModel&&this._ower.conchModel.bgColor($d),this._type|=16384,this._ower._renderType|=256):this._bgground=null;}),$b(0,$t,"wordWrap",function(){return 0==(131072&this._type);},function($d){$d?this._type&=-131073:this._type|=131072;}),$b(0,$t,"color",function(){return this._font.color;},function($d){this._createFont().color=$d;}),$b(0,$t,"password",function(){return this._font.password;},function($d){this._createFont().password=$d;}),$b(0,$t,"backgroundColor",function(){return this._bgground?this._bgground.color:null;},function($d){"none"===$d?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$d),this._ower.conchModel&&this._ower.conchModel.bgColor($d),this._ower._renderType|=256;}),$b(0,$t,"font",function(){return this._font.toString();},function($d){this._createFont().set($d);}),$b(0,$t,"weight",null,function($d){this._createFont().weight=$d;}),$b(0,$t,"letterSpacing",function(){return this._spacing[0];},function($d){"string"==typeof $d&&($d=parseInt($d+"")),this._spacing===$J._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$d;}),$b(0,$t,"fontSize",function(){return this._font.size;},function($d){this._createFont().size=$d;}),$b(0,$t,"italic",function(){return this._font.italic;},function($d){this._createFont().italic=$d;}),$b(0,$t,"fontFamily",function(){return this._font.family;},function($d){this._createFont().family=$d;}),$b(0,$t,"stroke",function(){return this._font.stroke[0];},function($d){this._createFont().stroke===$c._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$d;}),$b(0,$t,"strokeColor",function(){return this._font.stroke[1];},function($d){this._createFont().stroke===$c._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$d;}),$b(0,$t,"border",function(){return this._border?this._border.value:"";},function($d){if("none"!=$d){this._border||(this._border={});var $t=(this._border.value=$d).split(" ");if(this._border.color=$N.create($t[$t.length-1]),1==$t.length)return this._border.size=1,void(this._border.type="solid");var $l=0;0<$t[0].indexOf("px")?(this._border.size=parseInt($t[0]),$l++):this._border.size=1,this._border.type=$t[$l],this._ower._renderType|=256;}else this._border=null;}),$b(0,$t,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null;},function($d){$d?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$d?null:$N.create($d),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null;}),$b(0,$t,"position",function(){return 4&this._type?"absolute":"";},function($d){"absolute"==$d?this._type|=4:this._type&=-5;}),$b(0,$t,"display",null,function($d){switch($d){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater();}}),$b(0,$t,"paddingLeft",function(){return this.padding[3];}),$b(0,$t,"paddingTop",function(){return this.padding[0];}),$b(0,$t,"_scale",null,function($d){this._ower.scale($d[0],$d[1]);}),$b(0,$t,"_rotate",null,function($d){this._ower.rotation=$d;}),$J.parseOneCSS=function($d,$t){for(var $l,$k=[],$W=$d.split($t),$i=0,$A=$W.length;$i<$A;$i++){var $B=$W[$i],$o=$B.indexOf(":"),$I=$B.substr(0,$o).replace(/^\s+|\s+$/g,"");if(0!=$I.length){var $b=$B.substr($o+1).replace(/^\s+|\s+$/g,""),$f=[$I,$b];switch($I){case"italic":case"bold":$f[1]="true"==$b;break;case"line-height":$f[0]="lineHeight",$f[1]=parseInt($b);break;case"font-size":$f[0]="fontSize",$f[1]=parseInt($b);break;case"padding":1<($l=$b.split(" ")).length||($l[1]=$l[2]=$l[3]=$l[0]),$f[1]=[parseInt($l[0]),parseInt($l[1]),parseInt($l[2]),parseInt($l[3])];break;case"rotate":$f[0]="_rotate",$f[1]=parseFloat($b);break;case"scale":$l=$b.split(" "),$f[0]="_scale",$f[1]=[parseFloat($l[0]),parseFloat($l[1])];break;case"translate":$l=$b.split(" "),$f[0]="_translate",$f[1]=[parseInt($l[0]),parseInt($l[1])];break;default:($f[0]=$J._CSSTOVALUE[$I])||($f[0]=$I);}$k.push($f);}}return $k;},$J.parseCSS=function($d,$t){for(var $l;null!=($l=$J._parseCSSRegExp.exec($d));)$J.styleSheets[$l[1]]=$J.parseOneCSS($l[2],";");},$J.EMPTY=new $J(null),$J._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$J._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$J._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$J._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$J.styleSheets={},$J.ALIGN_CENTER=1,$J.ALIGN_RIGHT=2,$J.VALIGN_MIDDLE=1,$J.VALIGN_BOTTOM=2,$J._CSS_BLOCK=1,$J._DISPLAY_NONE=2,$J._ABSOLUTE=4,$J._WIDTH_SET=8,$J._PADDING=[0,0,0,0],$J._RECT=[-1,-1,-1,-1],$J._SPACING=[0,0],$J._ALIGNS=[0,0,0],$J.ADDLAYOUTED=512,$J._NEWFONT=4096,$J._HEIGHT_SET=8192,$J._BACKGROUND_SET=16384,$J._FLOAT_RIGHT=32768,$J._LINE_ELEMENT=65536,$J._NOWARP=131072,$J._WIDTHAUTO=262144,$J._LISTERRESZIE=524288,$J;}($B),$ld=function($d){function $A(){this.url=null,this.audio=null,this.loaded=!1,$A.__super.call(this);}$w($A,"laya.media.h5audio.AudioSound",$I);var $t=$A.prototype;return $t.dispose=function(){var $d=$A._audioCache[this.url];$d&&($d.src="",delete $A._audioCache[this.url]);},$t.load=function($d){var $t;if($d=$C.formatURL($d),(this.url=$d)==$T._tMusic?($A._initMusicAudio(),($t=$A._musicAudio).src!=$d&&($A._audioCache[$t.src]=null,$t=null)):$t=$A._audioCache[$d],$t&&2<=$t.readyState)this.event("complete");else{$t||($t=$d==$T._tMusic?($A._initMusicAudio(),$A._musicAudio):$V.createElement("audio"),($A._audioCache[$d]=$t).src=$d),$t.addEventListener("canplaythrough",$k),$t.addEventListener("error",$W);var $l=this;(this.audio=$t).load?$t.load():$W();}function $k(){$i(),$l.loaded=!0,$l.event("complete");}function $W(){$t.load=null,$i(),$l.event("error");}function $i(){$t.removeEventListener("canplaythrough",$k),$t.removeEventListener("error",$W);}},$t.play=function($d,$t,$l){if(void 0===$d&&($d=0),void 0===$t&&($t=0),!this.url)return null;var $k,$W;if(!($k=this.url==$T._tMusic?$A._musicAudio:$A._audioCache[this.url]))return null;$W=$P.getItem("audio:"+this.url),$K.isConchApp?$W||(($W=$V.createElement("audio")).src=this.url):this.url==$T._tMusic?($A._initMusicAudio(),($W=$A._musicAudio).src=this.url):$W=$W||$k.cloneNode(!0);var $i=new $Jd($W);return $i.url=this.url,$i.loops=$t,$i.startTime=$d,$i.startHandler=$l,$i.play(!1),$T.addChannel($i),$i;},$b(0,$t,"duration",function(){var $d;return($d=$A._audioCache[this.url])?$d.duration:0;}),$A._initMusicAudio=function(){$A._musicAudio||($A._musicAudio||($A._musicAudio=$V.createElement("audio")),$K.isConchApp||$V.document.addEventListener("mousedown",$A._makeMusicOK));},$A._makeMusicOK=function(){$V.document.removeEventListener("mousedown",$A._makeMusicOK),$A._musicAudio.src?$A._musicAudio.play():($A._musicAudio.src="",$A._musicAudio.load());},$A._audioCache={},$A._musicAudio=null,$A;}(),$kd=function($d){function $t(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$t.__super.call(this);}$w($t,"laya.media.SoundChannel",$I);var $l=$t.prototype;return $l.play=function(){},$l.stop=function(){},$l.pause=function(){},$l.resume=function(){},$l.__runComplete=function($d){$d&&$d.run();},$b(0,$l,"volume",function(){return 1;},function($d){}),$b(0,$l,"position",function(){return 0;}),$b(0,$l,"duration",function(){return 0;}),$t;}(),$Wd=function($d){function $t(){$t.__super.call(this);}$w($t,"laya.media.Sound",$I);var $l=$t.prototype;return $l.load=function($d){},$l.play=function($d,$t,$l){return void 0===$d&&($d=0),void 0===$t&&($t=0),null;},$l.dispose=function(){},$b(0,$l,"duration",function(){return 0;}),$t;}(),$id=function($d){function $W(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$W.__super.call(this);}$w($W,"laya.media.webaudio.WebAudioSound",$I);var $t=$W.prototype;return $t.load=function($d){this.url=$d,this.audioBuffer=$W._dataCache[$d],this.audioBuffer?this._loaded(this.audioBuffer):($W.e.on("loaded:"+$d,this,this._loaded),$W.e.on("err:"+$d,this,this._err),$W.__loadingSound[$d]||($W.__loadingSound[$d]=!0,$q.loader.load($d,$e.create(this,this.onloaded),null,$Bd.BUFFER,4,!1,null,!0)));},$t.onloaded=function($d){$d||this._err(),this._disposed?this._removeLoadEvents():(this.data=$d,$W.buffs.push({buffer:this.data,url:this.url}),$W.decode());},$t._err=function(){if(this._removeLoadEvents(),$W.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $d,$t,$l,$k=0;for($d=($t=this.__toPlays).length,$k=0;$k<$d;$k++)($l=$t[$k])[3]&&!$l[3].isStopped&&$l[3].event("error");this.__toPlays.length=0;}},$t._loaded=function($d){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$d,this.loaded=!0,this.event("complete"));},$t._removeLoadEvents=function(){$W.e.off("loaded:"+this.url,this,this._loaded),$W.e.off("err:"+this.url,this,this._err);},$t.__playAfterLoaded=function(){if(this.__toPlays){var $d,$t,$l,$k=0;for($d=($t=this.__toPlays).length,$k=0;$k<$d;$k++)($l=$t[$k])[3]&&!$l[3].isStopped&&this.play($l[0],$l[1],$l[2],$l[3]);this.__toPlays.length=0;}},$t.play=function($d,$t,$l,$k){return void 0===$d&&($d=0),void 0===$t&&($t=0),$k=$k||new $cd(),this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$d,$t,$l,$k]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$k.url=this.url,$k.loops=$t,$k.audioBuffer=this.audioBuffer,$k.startTime=$d,$k.startHandler=$l,$k.play(!1),$T.addChannel($k),$k;},$t.dispose=function(){this._disposed=!0,delete $W._dataCache[this.url],delete $W.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[];},$b(0,$t,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$W.decode=function(){if(!($W.buffs.length<=0||$W.isDecoding))if($W.isDecoding=!0,($W.tInfo=$W.buffs.shift())&&$W.tInfo.buffer&&$W.tInfo.buffer.byteLength)try{$W.ctx.decodeAudioData($W.tInfo.buffer,$W._done,$W._fail);}catch($d){console.error("decodeAudioData error  byteLength:"+$W.tInfo.buffer.byteLength+"  url:"+$W.tInfo.url);}else $W._fail();},$W._done=function($d){$W.e.event("loaded:"+$W.tInfo.url,$d),$W._dataCache[$W.tInfo.url]=$d,$W.isDecoding=!1,$W.decode();},$W._fail=function(){$W.e.event("err:"+$W.tInfo.url,null),$W.isDecoding=!1,$W.decode();},$W._playEmptySound=function(){if(null!=$W.ctx){if($W._emptySource&&($W._emptySource.stop(),$W._emptySource.disconnect(0),!$cd._tryCleanFailed))try{$W._emptySource.buffer=null;}catch($d){$cd._tryCleanFailed=!0;}var $d=$W.ctx.createBufferSource();$d.buffer=$W._miniBuffer,$d.connect($W.ctx.destination),$d.start(0,0,0),$W._emptySource=$d;}},$W._unlock=function(){$W._unlocked||($W._playEmptySound(),"running"==$W.ctx.state?($V.document.removeEventListener("mousedown",$W._unlock,!0),$V.document.removeEventListener("touchend",$W._unlock,!0),$V.document.removeEventListener("touchstart",$W._unlock,!0),$W._unlocked=!0):"suspended"==$W.ctx.state&&$T._recoverWebAudio());},$W.initWebAudio=function(){"running"!=$W.ctx.state&&($W._unlock(),$V.document.addEventListener("mousedown",$W._unlock,!0),$V.document.addEventListener("touchend",$W._unlock,!0),$V.document.addEventListener("touchstart",$W._unlock,!0));},$W._emptySource=null,$W._dataCache={},$W.buffs=[],$W.isDecoding=!1,$W._unlocked=!1,$W.tInfo=null,$W.__loadingSound={},$o($W,["window",function(){return this.window=$V.window;},"webAudioEnabled",function(){return this.webAudioEnabled=$W.window.AudioContext||$W.window.webkitAudioContext||$W.window.mozAudioContext;},"ctx",function(){return this.ctx=$W.webAudioEnabled?new($W.window.AudioContext||$W.window.webkitAudioContext||$W.window.mozAudioContext)():void 0;},"_miniBuffer",function(){return this._miniBuffer=$W.ctx.createBuffer(1,1,22050);},"e",function(){return this.e=new $I();}]),$W;}(),$Ad=function($d){function $t(){this._responseType=null,this._data=null,$t.__super.call(this),this._http=new $V.window.XMLHttpRequest();}$w($t,"laya.net.HttpRequest",$I);var $l=$t.prototype;return $l.send=function($d,$t,$l,$k,$W){void 0===$l&&($l="get"),void 0===$k&&($k="text"),this._responseType=$k,this._data=null;var $i=this,$A=this._http;if($A.open($l,$d,!0),$W)for(var $B=0;$B<$W.length;$B++)$A.setRequestHeader($W[$B++],$W[$B]);else $K.isConchApp||($t&&"string"!=typeof $t?$A.setRequestHeader("Content-Type","application/json"):$A.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$A.responseType="arraybuffer"!==$k?"text":"arraybuffer",$A.onerror=function($d){$i._onError($d);},$A.onabort=function($d){$i._onAbort($d);},$A.onprogress=function($d){$i._onProgress($d);},$A.onload=function($d){$i._onLoad($d);},$A.send($t);},$l._onProgress=function($d){$d&&$d.lengthComputable&&this.event("progress",$d.loaded/$d.total);},$l._onAbort=function($d){this.error("Request was aborted by user");},$l._onError=function($d){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText);},$l._onLoad=function($d){var $t=this._http,$l=void 0!==$t.status?$t.status:200;200===$l||204===$l||0===$l?this.complete():this.error("["+$t.status+"]"+$t.statusText+":"+$t.responseURL);},$l.error=function($d){this.clear(),this.event("error",$d);},$l.complete=function(){this.clear();var $t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$F.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText;}catch($d){$t=!1,this.error($d.message);}$t&&this.event("complete",this._data instanceof Array?[this._data]:this._data);},$l.clear=function(){var $d=this._http;$d.onerror=$d.onabort=$d.onprogress=$d.onload=null;},$b(0,$l,"url",function(){return this._http.responseURL;}),$b(0,$l,"http",function(){return this._http;}),$b(0,$l,"data",function(){return this._data;}),$t;}(),$Bd=function($d){function $p(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$p.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1;}$w($p,"laya.net.Loader",$I);var $t=$p.prototype;return $t.load=function($d,$t,$l,$k,$W){if($d&&""!=$d||console.error("Loader 加载的url不合法 "+$d),void 0===$l&&($l=!0),void 0===$W&&($W=!1),0===(this._url=$d).indexOf("data:image")?this._type=$t="image":this._type=$t||($t=this.getTypeFromUrl($d)),this._cache=$l,this._data=null,!$W&&$p.loadedMap[$d])return this._data=$p.loadedMap[$d],this.event("progress",1),void this.event("complete",this._data);if($k&&$p.setGroup($d,$k),null!=$p.parserMap[$t])return this._customParse=!0,void($p.parserMap[$t]instanceof laya.utils.Handler?$p.parserMap[$t].runWith(this):$p.parserMap[$t].call(null,this));if("image"===$t||"htmlimage"===$t||"nativeimage"===$t)return this._loadImage($d);if("ttf"===$t)return this._loadTTF($d);switch($t){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$t;}$p.preLoadedMap[$d]?this.onLoaded($p.preLoadedMap[$d]):$A.resMgrLoad($d,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime);},$t.getTypeFromUrl=function($d){var $t=$F.getFileExtension($d);return $t?$p.typeMap[$t]:(console.warn("Not recognize the resources suffix",$d),"text");},$t._loadTTF=function($d){$d=$C.formatURL($d);var $t=new $j();$t.complete=$e.create(this,this.onLoaded),$t.load($d);},$t._loadImage=function($d){$A.imgMgrLoad($d,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime);},$t._loadImageComplete=function($d,$t,$l){if(null!=$l){if($l instanceof ArrayBuffer){var $k=new DataView($l),$W=new laya.webgl.resource.WebGLImage(new Uint8Array($l,8),$d,0,!1,$k.getUint32(0),$k.getUint32(4));this.onLoaded($W);}else if($l instanceof $bd)$p.imgMgrSet[$d]=$t,$A.imgMgrLock($d,$p.imgMgrSet[$d]),this._url=$d,this.complete($l);else{var $i=-1!=$d.indexOf(".png",$d.length-4)?6408:6407;$W=new laya.webgl.resource.WebGLImage($l,$d,$i,!1,$l.width,$l.height);this.onLoaded($W);}}else this.event("error","Load image failed");},$t.imageCancel=function($d,$t,$l){$A.imgMgrCancel&&$A.imgMgrCancel($d,this._onImageCallback);},$t._loadSound=function($d){var $t=new $T._soundClass(),$l=this;function $k(){$t.offAll();}$t.on("complete",this,function(){$k(),$l.onLoaded($t);}),$t.on("error",this,function(){$k(),$t.dispose(),$l.event("error","Load sound failed");}),$t.load($d);},$t.onProgress=function($d){"atlas"===this._type?this.event("progress",.3*$d):this.event("progress",$d);},$t.onError=function($d){this.event("error",$d);},$t._loadedComplete=function($d,$t,$l){if(null!=$l)switch(this._type){case"atlas":case"plf":case"json":var $k=new $Z($l);this.onLoaded(JSON.parse($k.readUTFBytes()));break;case"font":$k=new $Z($l);this.onLoaded($F.parseXMLFromString($k.readUTFBytes()));break;default:this.onLoaded($l);}else this.event("error",$d);},$t.onLoaded=function($d){var $t=this._type;if("plf"==$t)this.parsePLFData($d),this.complete($d);else if("image"===$t){var $l=new $bd($d);$l.url=this._url,this.complete($l);}else if("sound"===$t||"htmlimage"===$t||"nativeimage"===$t)this.complete($d);else if("atlas"===$t){if(!$d.src&&!$d._setContext){if(!this._data){if((this._data=$d).meta&&$d.meta.image)for(var $k=$d.meta.image.split(","),$W=0<=this._url.indexOf("/")?"/":"\\",$i=this._url.lastIndexOf($W),$A=0<=$i?this._url.substr(0,$i+1):"",$B=0,$o=$k.length;$B<$o;$B++)$k[$B]=$A+$k[$B];else $k=[this._url.replace(".json",".png")];$k.reverse(),$d.toLoads=$k,$d.pics=[];}return this.event("progress",.3+1/$k.length*.6),this._loadImage($k.pop());}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($d),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $I=this._data.frames,$b=this._url.split("?")[0],$f=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$b.substring(0,$b.lastIndexOf("."))+"/",$J=this._data.pics,$c=$C.formatURL(this._url),$Y=$p.atlasMap[$c]||($p.atlasMap[$c]=[]);$Y.dir=$f;var $w=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $D in $w=parseFloat(this._data.meta.scale),$I){var $z,$e=$I[$D],$g=$J[$e.frame.idx?$e.frame.idx:0],$H=$C.formatURL($f+$D);$g.scaleRate=$w,$z=$bd.create($g,$e.frame.x,$e.frame.y,$e.frame.w,$e.frame.h,$e.spriteSourceSize.x,$e.spriteSourceSize.y,$e.sourceSize.w,$e.sourceSize.h),$p.cacheRes($H,$z),$p.keepCache(this._url,$f+$D),$z.url=$H,$Y.push($H);}else for($D in $I)$g=$J[($e=$I[$D]).frame.idx?$e.frame.idx:0],$H=$C.formatURL($f+$D),$p.cacheRes($H,$bd.create($g,$e.frame.x,$e.frame.y,$e.frame.w,$e.frame.h,$e.spriteSourceSize.x,$e.spriteSourceSize.y,$e.sourceSize.w,$e.sourceSize.h)),$p.loadedMap[$H].url=$H,$p.keepCache(this._url,$f+$D),$Y.push($H);delete this._data.pics,this.complete(this._data);}else if("font"==$t){if(!$d.src)return this._data=$d,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $R=new $M();$R.parseFont(this._data,$d);var $G=this._url.split(".fnt")[0].split("/"),$q=$G[$G.length-1];$Dd.registerBitmapFont($q,$R),this._data=$R,this.complete(this._data);}else if("pkm"==$t){var $L=$Gd.create($d,this._url),$$=new $bd($L);$$.url=this._url,this.complete($$);}else this.complete($d);},$t.parsePLFData=function($d){var $t,$l,$k;for($t in $d)switch($k=$d[$t],$t){case"json":case"text":for($l in $k)$p.preLoadedMap[$C.formatURL($l)]=$k[$l];break;default:for($l in $k)$p.preLoadedMap[$C.formatURL($l)]=$k[$l];}},$t.complete=function($d){this._data=$d,this._customParse?this.event("loaded",$d instanceof Array?[$d]:$d):($p._loaders.push(this),$p._isWorking||$p.checkNext());},$t.endLoad=function($d){$d&&(this._data=$d),this._cache&&$p.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data);},$b(0,$t,"url",function(){return this._url;}),$b(0,$t,"data",function(){return this._data;}),$b(0,$t,"cache",function(){return this._cache;}),$b(0,$t,"type",function(){return this._type;}),$p.checkNext=function(){$p._isWorking=!0;for(var $d=$V.now();$p._startIndex<$p._loaders.length;)if($V.now(),$p._loaders[$p._startIndex].endLoad(),$p._startIndex++,$V.now()-$d>$p.maxTimeOut)return console.warn("loader callback cost a long time:"+($V.now()-$d)+" url="+$p._loaders[$p._startIndex-1].url),void $q.timer.frameOnce(1,null,$p.checkNext);$p._loaders.length=0,$p._startIndex=0,$p._isWorking=!1;},$p.clearRes=function($d,$t){if(null!=$d){void 0===$t&&($t=!1),$d=$C.formatURL($d);var $l=$p.getAtlas($d);if($l){for(var $k=0,$W=$l.length;$k<$W;$k++){var $i=$l[$k],$A=$p.getRes($i);delete $p.loadedMap[$i],$p.clearCache($d.substring($C.basePath.length),$i.substring($C.basePath.length)),$A&&$A.destroy($t);}$l.length=0,delete $p.atlasMap[$d],delete $p.loadedMap[$d];}else{var $B=$p.loadedMap[$d];$B&&(delete $p.loadedMap[$d],$B instanceof laya.resource.Texture&&$B.bitmap&&$B.destroy($t));}}},$p.clearTextureRes=function($d){$d=$C.formatURL($d);var $t=laya.net.Loader.getAtlas($d),$l=$t&&0<$t.length?laya.net.Loader.getRes($t[0]):laya.net.Loader.getRes($d);$l&&$l.bitmap&&($K.isConchApp&&!$K.isConchWebGL?$l.bitmap.source.releaseTexture&&$l.bitmap.source.releaseTexture():null==$l.bitmap._atlaser&&$l.bitmap.releaseResource(!0));},$p.getRes=function($d){return $p.loadedMap[$C.formatURL($d)];},$p.getAtlas=function($d){return $p.atlasMap[$C.formatURL($d)];},$p.cacheRes=function($d,$t){$d=$C.formatURL($d),null!=$p.loadedMap[$d]?console.warn("Resources already exist,is repeated loading:",$d):$p.loadedMap[$d]=$t;},$p.setGroup=function($d,$t){$p.groupMap[$t]||($p.groupMap[$t]=[]),$p.groupMap[$t].push($d);},$p.clearResByGroup=function($d){if($p.groupMap[$d]){var $t=$p.groupMap[$d],$l=0,$k=$t.length;for($l=0;$l<$k;$l++)$p.clearRes($t[$l]);$t.length=0;}},$p.keepCache=function($d,$t){if($d&&$t){var $l=$p.cacheSet[$t];$l?-1==$l.indexOf($d)&&$l.push($d):$p.cacheSet[$t]=[$d];}},$p.clearCache=function($d,$t){if($d&&$t){var $l=$p.cacheSet[$t];if($l){var $k=$l.indexOf($d);if(-1!==$k){var $W=$l.length-1;0==$W?(delete $p.cacheSet[$t],0<$p.imgMgrSet[$t]?$A.imgMgrFree($t,$p.imgMgrSet[$t]):$p.clearRes($t,!0)):($l[$k]=$l[$W],$l.length=$W);}}}},$p.saveObject=function($d,$t,$l){if($t&&$d){var $k=$p.objectSet[$d];$k?(console.warn("Loader.saveObject: "+$d),$k[0]=$t,$k[1]=$l):$p.objectSet[$d]=[$t,$l,[]];}},$p.findObject=function($d){if($d){var $t=$p.objectSet[$d];if($t)return $t[0];}return null;},$p.keepObject=function($d,$t){if($d&&$t){var $l=$p.objectSet[$t];$l&&-1===$l[2].indexOf($d)&&$l[2].push($d);}},$p.clearObject=function($d,$t){if($d&&$t){var $l=$p.objectSet[$t];if($l){var $k=$l[2],$W=$k.indexOf($d);if(-1!==$W){var $i=$k.length-1;0==$i?(delete $p.objectSet[$t],$l[1]&&$l[1].call(null,$l[0])):($k[$W]=$k[$i],$k.length=$i);}}}},$p.TEXT="text",$p.JSON="json",$p.XML="xml",$p.BUFFER="arraybuffer",$p.IMAGE="image",$p.SOUND="sound",$p.ATLAS="atlas",$p.FONT="font",$p.TTF="ttf",$p.PLF="plf",$p.PKM="pkm",$p.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$p.parserMap={},$p.groupMap={},$p.maxTimeOut=100,$p.loadedMap={},$p.preLoadedMap={},$p.atlasMap={},$p._loaders=[],$p._isWorking=!1,$p._startIndex=0,$p.imgCache={},$p.cacheSet={},$p.objectSet={},$p.imgMgrSet={},$p;}(),$od=function($d){var $J;function $c(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$c.__super.call(this);for(var $d=0;$d<this._maxPriority;$d++)this._resInfos[$d]=[];}$w($c,"laya.net.LoaderManager",$I);var $t=$c.prototype;return $t.create=function($d,$l,$t,$k,$W,$i,$A,$B){if(null==$i&&($i=2),null==$A&&($A=!0),$d instanceof Array){var $o=$d,$I=$o.length,$b=0;if($t)var $f=$e.create($t.caller,$t.method,$t.args,!1);for(var $J=0;$J<$I;$J++){var $c=$o[$J];"string"==typeof $c&&($c=$o[$J]={url:$c}),$c.progress=0;}for($J=0;$J<$I;$J++){$c=$o[$J];var $Y=$t?$e.create(null,$z,[$c],!1):null,$w=$t||$l?$e.create(null,$D,[$c]):null;this._create($c.url,$w,$Y,$c.clas||$k,$c.params||$W,null!=$c.priority&&0<=$c.priority?$c.priority:$i,$A,$c.group||$B);}function $D($d,$t){$b++,$d.progress=1,$b===$I&&$l&&$l.run();}function $z($d,$t){$d.progress=$t;for(var $l=0,$k=0;$k<$I;$k++){$l+=$o[$k].progress;}var $W=$l/$I;$f.runWith($W);}return!0;}return this._create($d,$l,$t,$k,$W,$i,$A,$B);},$t._create=function($t,$l,$d,$k,$W,$i,$A,$B){$t&&""!=$t||console.error("加载的url不合法 "+$t),null==$i&&($i=2),null==$A&&($A=!0);var $o=$C.formatURL($t),$I=this.getRes($o);if($I)!$I.hasOwnProperty("loaded")||$I.loaded?($d&&$d.runWith(1),$l&&$l.run()):$l&&$q.loader._createListener($t,$l.caller,$l.method,$l.args,!0,!1);else{var $b=$F.getFileExtension($t),$f=$c.createMap[$b];if(!$f)throw new Error("LoaderManager:unknown file("+$t+") extension with: "+$b+".");$k||($k=$f[0]);var $J=$f[1];if("atlas"==$b)this.load($t,$l,$d,$J,$i,$A);else{$k===$bd&&($J="htmlimage"),($I=$k?new $k():null).hasOwnProperty("_loaded")&&($I._loaded=!1),$I._setUrl($t),$B&&$I._setGroup($B),this._createLoad($I,$t,$e.create(null,function($d){$I&&!$I.destroyed&&$d&&$I.onAsynLoaded.call($I,$t,$d,$W),$l&&$l.run();$q.loader.event($t);}),$d,$J,$i,!1,$B,!0),$A&&this.cacheRes($o,$I);}}return $I;},$t.load=function($d,$t,$l,$k,$W,$i,$A,$B){$d&&""!=$d||console.error("加载的url不合法 "+$d);var $o=this;if(null==$W&&($W=2),null==$i&&($i=!0),void 0===$B&&($B=!1),$d instanceof Array)return this._loadAssets($d,$t,$l,$k,$W,$i,$A);var $I=$Bd.getRes($d);if(null!=$I)$q.timer.frameOnce(1,null,function(){$l&&$l.runWith(1),$t&&$t.runWith($I),$o._loaderCount||$o.event("complete");});else{var $b=$c._resMap[$d];$b?($t&&$b._createListener("complete",$t.caller,$t.method,$t.args,!1,!1),$l&&$b._createListener("progress",$l.caller,$l.method,$l.args,!1,!1)):(($b=this._infoPool.length?this._infoPool.pop():new $J()).url=$d,$b.clas=null,$b.type=$k,$b.cache=$i,$b.group=$A,$b.ignoreCache=$B,$b.priority=$W,$t&&$b.on("complete",$t.caller,$t.method,$t.args),$l&&$b.on("progress",$l.caller,$l.method,$l.args),$c._resMap[$d]=$b,$W=$W<this._maxPriority?0<=$W?$W:0:this._maxPriority-1,this._resInfos[$W].push($b),this._next());}return this;},$t.cancel=function($d,$t,$l){if($I=$c._resMap[$d]){$t&&$I.off("complete",$t.caller,$t.method,!1),$l&&$I.off("progress",$l.caller,$l.method,!1);var $k=$I.getListener("complete"),$W=$I.getListener("progress");if(!($k&&$k.head||$W&&$W.head)){if($I.loader){var $i=$I.loader;$i.imageCancel($d),$i.offAll(),$i._data=null,$i._customParse=!1,$i._url=null,$i._class=null,$i._type=null,this._loaders.push($i),this._loaderCount--,delete this._loaderMap[$I.url];}for(var $A=0;$A<this._maxPriority;$A++)for(var $B=this._resInfos[$A],$o=$B.length-1;-1<$o;$o--){var $I;($I=$B[$o])&&$I.url===$d&&($B[$o]=null,$I.destroy(),$I.offAll(),this._infoPool.push($I));}delete $c._resMap[$d],this._next();}}},$t._createLoad=function($d,$t,$l,$k,$W,$i,$A,$B,$o){var $I=this;if(null==$i&&($i=2),null==$A&&($A=!0),void 0===$o&&($o=!1),$t instanceof Array)return this._loadAssets($t,$l,$k,$W,$i,$A,$B);var $b=$Bd.getRes($t);if(null!=$b)$q.timer.frameOnce(1,null,function(){$k&&$k.runWith(1),$l&&$l.runWith($b),$I._loaderCount||$I.event("complete");});else{var $f=$c._resMap[$t];$f?($l&&$f._createListener("complete",$l.caller,$l.method,$l.args,!1,!1),$k&&$f._createListener("progress",$k.caller,$k.method,$k.args,!1,!1)):(($f=this._infoPool.length?this._infoPool.pop():new $J()).url=$t,$f.clas=$d,$f.type=$W,$f.cache=$A,$f.group=$B,$f.ignoreCache=$o,$f.priority=$i,$l&&$f.on("complete",$l.caller,$l.method,$l.args),$k&&$f.on("progress",$k.caller,$k.method,$k.args),$c._resMap[$t]=$f,$i=$i<this._maxPriority?0<=$i?$i:0:this._maxPriority-1,this._resInfos[$i].push($f),this._next());}return this;},$t._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $d=0;$d<this._maxPriority;$d++)for(var $t=this._resInfos[$d];0<$t.length;){var $l=$t.shift();if($l)return this._doLoad($l);}this._loaderCount||this.event("complete");}},$t._doLoad=function($t){var $l=this._loaders.length?this._loaders.pop():new $Bd();this._loaderCount++,(this._loaderMap[$t.url]=$l).on("complete",null,$W),$l.on("progress",null,function($d){$t.event("progress",$d);}),$l.on("error",null,function($d){$W(null);}),$t.loader=$l;var $k=this;function $W($d){$l.offAll(),$l._data=null,$l._customParse=!1,$l._url=null,$l._class=null,$l._type=null,$k._loaders.push($l),$k._loaderCount--,delete $k._loaderMap[$t.url],$k._endLoad($t,$d instanceof Array?[$d]:$d),$k._next();}$l._class=$t.clas,1<=$t.priority?($l.priority=$t.priority,$l.realTime=!1):($l.priority=0,$l.realTime=!0),$l.load($t.url,$t.type,$t.cache,$t.group,$t.ignoreCache);},$t._endLoad=function($d,$t){var $l=$d.url;if(null==$t){var $k=this._failRes[$l]||0;if($k<this.retryNum)return console.warn("[warn]Retry to load:",$l),this._failRes[$l]=$k+1,void $q.timer.once(this.retryDelay,this,this._addReTry,[$d],!1);console.warn("[error]Failed to load:",$l),this.event("error",$l);}this._failRes[$l]&&(this._failRes[$l]=0),delete $c._resMap[$l],$d.event("complete",$t),$d.destroy(),$d.offAll(),this._infoPool.push($d);},$t._addReTry=function($d){this._resInfos[this._maxPriority-1].push($d),this._next();},$t.clearRes=function($d,$t){void 0===$t&&($t=!1),$Bd.clearRes($d,$t);},$t.getRes=function($d){return $Bd.getRes($d);},$t.cacheRes=function($d,$t){$Bd.cacheRes($d,$t);},$t.clearTextureRes=function($d){$Bd.clearTextureRes($d);},$t.setGroup=function($d,$t){$Bd.setGroup($d,$t);},$t.clearResByGroup=function($d){$Bd.clearResByGroup($d);},$t.clearUnLoaded=function(){for(var $d=0;$d<this._maxPriority;$d++){for(var $t=this._resInfos[$d],$l=$t.length-1;-1<$l;$l--){var $k=$t[$l];$k&&($k.destroy(),$k.offAll(),this._infoPool.push($k));}$t.length=0;}this._loaderCount=0,$c._resMap={};},$t.cancelLoadByUrls=function($d){if($d)for(var $t=0,$l=$d.length;$t<$l;$t++)this.cancelLoadByUrl($d[$t]);},$t.cancelLoadByUrl=function($d){for(var $t=0;$t<this._maxPriority;$t++)for(var $l=this._resInfos[$t],$k=$l.length-1;-1<$k;$k--){var $W=$l[$k];$W&&$W.url===$d&&($l[$k]=null,$W.destroy(),$W.offAll(),this._infoPool.push($W));}$c._resMap[$d]&&delete $c._resMap[$d];},$t._loadAssets=function($d,$l,$A,$t,$k,$W,$i){null==$k&&($k=2),null==$W&&($W=!0);for(var $B=$d.length,$o=0,$I=0,$b=[],$f=!0,$J=0;$J<$B;$J++){var $c=$d[$J];if(!$c)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$d);"string"==typeof $c&&($c={url:$c,type:$t,size:1,priority:$k}),$c.size||($c.size=1),$c.progress=0,$I+=$c.size,$b.push($c);var $Y=$A?$e.create(null,$z,[$c],!1):null,$w=$l||$A?$e.create(null,$D,[$c]):null;this.load($c.url,$w,$Y,$c.type,null!=$c.priority&&0<=$c.priority?$c.priority:2,$W,$c.group||$i);}function $D($d,$t){$o++,$d.progress=1,$t||($f=!1),$o===$B&&$l&&$l.runWith($f);}function $z($d,$t){if(null!=$A){$d.progress=$t;for(var $l=0,$k=0;$k<$b.length;$k++){var $W=$b[$k];$l+=$W.size*$W.progress;}var $i=$l/$I;$A.runWith($i);}}return this;},$c.cacheRes=function($d,$t){$Bd.cacheRes($d,$t);},$c._resMap={},$o($c,["createMap",function(){return this.createMap={atlas:[null,"atlas"]};}]),$c.__init$=function(){$J=function($d){function $t(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$t.__super.call(this);}return $w($t,"",$I),$t.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1;},$t;}();},$c;}(),$Id=(function($d){function $W($d){$W.__super.call(this),$d||($d=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $t=0,$l=0,$k=0;$k<20;$k++)$k%5!=4?this._mat[$t++]=$d[$k]:this._alpha[$l++]=$d[$k];this._action=$r.createFilterAction(32),this._action.data=this;}$w($W,"laya.filters.ColorFilter",$z);var $t=$W.prototype;$q.imps($t,{"laya.filters.IFilter":!0}),$t.callNative=function($d){$d._$P.cf=this;$d.conchModel&&$d.conchModel.setFilterMatrix&&$d.conchModel.setFilterMatrix(this._mat,this._alpha);},$b(0,$t,"type",function(){return 32;}),$b(0,$t,"action",function(){return this._action;});}(),function($d){function $k($d,$t,$l){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$t&&($t=0),$k.__super.call(this),this._byteClass=$l||$Z,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$d&&0<$t&&$t<65535&&this.connect($d,$t);}$w($k,"laya.net.Socket",$I);var $t=$k.prototype;$t.connect=function($d,$t){var $l="ws://"+$d+":"+$t;$l="https:"==$V.window.location.protocol?"wss://"+$d+":"+$t:"ws://"+$d+":"+$t,this.connectByUrl($l);},$t.connectByUrl=function($d){var $t=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $V.window.WebSocket($d,this.protocols):this._socket=new $V.window.WebSocket($d),this._socket.binaryType="arraybuffer",this._output=new this._byteClass(),this._output.endian=this.endian,this._input=new this._byteClass(),this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($d){$t._onOpen($d);},this._socket.onmessage=function($d){$t._onMessage($d);},this._socket.onclose=function($d){$t._onClose($d);},this._socket.onerror=function($d){$t._onError($d);};},$t.cleanSocket=function(){try{this._socket.close();}catch($d){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null;},$t.close=function(){if(null!=this._socket)try{this._socket.close();}catch($d){}},$t._onOpen=function($d){this._connected=!0,this.event("open",$d);},$t._onMessage=function($d){if($d&&$d.data){var $t=$d.data;if(this.disableInput&&$t)this.event("message",$t);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $l=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$t&&("string"==typeof $t?this._input.writeUTFBytes($t):this._input.writeArrayBuffer($t),this._addInputPosition=this._input.pos,this._input.pos=$l),this.event("message",$t);}}},$t._onClose=function($d){this._connected=!1,this.event("close",$d);},$t._onError=function($d){this.event("error",$d);},$t.send=function($d){this._socket.send($d);},$t.flush=function(){if(this._output&&0<this._output.length){var $t;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length));}catch($d){$t=$d;}this._output.endian=this.endian,this._output.clear(),$t&&this.event("error",$t);}},$b(0,$t,"input",function(){return this._input;}),$b(0,$t,"output",function(){return this._output;}),$b(0,$t,"connected",function(){return this._connected;}),$b(0,$t,"endian",function(){return this._endian;},function($d){this._endian=$d,null!=this._input&&(this._input.endian=$d),null!=this._output&&(this._output.endian=$d);}),$k.LITTLE_ENDIAN="littleEndian",$k.BIG_ENDIAN="bigEndian";}(),function($d){function $B(){$B.__super.call(this),this._$1__id=++$B._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($B._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$y.currentResourceManager&&$y.currentResourceManager.addResource(this);}$w($B,"laya.resource.Resource",$I);var $t=$B.prototype;return $q.imps($t,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$t._setUrl=function($d){var $t;this._url!==$d&&(this._url&&(($t=$B._urlResourcesMap[this._url]).splice($t.indexOf(this),1),0===$t.length&&delete $B._urlResourcesMap[this._url]),$d&&(($t=$B._urlResourcesMap[$d])||($B._urlResourcesMap[$d]=$t=[]),$t.push(this)),this._url=$d);},$t._getGroup=function(){return this._group;},$t._setGroup=function($d){var $t;this._group!==$d&&(this._group&&(($t=$B._groupResourcesMap[this._group]).splice($t.indexOf(this),1),0===$t.length&&delete $B._groupResourcesMap[this._group]),$d&&(($t=$B._groupResourcesMap[$d])||($B._groupResourcesMap[$d]=$t=[]),$t.push(this)),this._group=$d);},$t._addReference=function(){this._referenceCount++;},$t._removeReference=function(){this._referenceCount--;},$t._clearReference=function(){this._referenceCount=0;},$t._endLoaded=function(){this.__loaded=!0,this.event("loaded",this);},$t.recreateResource=function(){this.completeCreate();},$t.disposeResource=function(){},$t.activeResource=function($d){void 0===$d&&($d=!1),this._lastUseFrameCount=$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||$d)&&this.recreateResource();},$t.releaseResource=function($d){return void 0===$d&&($d=!0),!(!$d&&this.lock)&&!(this._released&&!$d)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0);},$t.onAsynLoaded=function($d,$t,$l){throw new Error("Resource: must override this function!");},$t.destroy=function(){var $d;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $B._idResourcesMap[this.id],this._url&&(($d=$B._urlResourcesMap[this._url])&&($d.splice($d.indexOf(this),1),0===$d.length&&delete $B._urlResourcesMap[this.url]),$Bd.clearRes(this._url),this.__loaded||$r.cancelLoadByUrl(this._url)),this._group&&(($d=$B._groupResourcesMap[this._group]).splice($d.indexOf(this),1),0===$d.length&&delete $B._groupResourcesMap[this.url]));},$t.completeCreate=function(){this._released=!1,this.event("recovered",this);},$t.dispose=function(){this.destroy();},$b(0,$t,"memorySize",function(){return this._memorySize;},function($d){var $t=$d-this._memorySize;this._memorySize=$d,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$t),this.resourceManager&&this.resourceManager.addSize($t);}),$b(0,$t,"_loaded",null,function($d){this.__loaded=$d;}),$b(0,$t,"loaded",function(){return this.__loaded;}),$b(0,$t,"id",function(){return this._$1__id;}),$b(0,$t,"destroyed",function(){return this._destroyed;}),$b(0,$t,"group",function(){return this._getGroup();},function($d){this._setGroup($d);}),$b(0,$t,"resourceManager",function(){return this._resourceManager;}),$b(0,$t,"url",function(){return this._url;}),$b(0,$t,"released",function(){return this._released;}),$b(0,$t,"referenceCount",function(){return this._referenceCount;}),$B.getResourceByID=function($d){return $B._idResourcesMap[$d];},$B.getResourceByURL=function($d,$t){return void 0===$t&&($t=0),null==$B._urlResourcesMap[$d]?null:$B._urlResourcesMap[$d][$t];},$B.getResourceCountByURL=function($d){return $B._urlResourcesMap[$d].length;},$B.destroyUnusedResources=function($d){var $t;if($d){var $l=$B._groupResourcesMap[$d];if($l)for(var $k=$l.slice(),$W=0,$i=$k.length;$W<$i;$W++)($t=$k[$W]).lock||0!==$t._referenceCount||$t.destroy();}else for(var $A in $B._idResourcesMap)($t=$B._idResourcesMap[$A]).lock||0!==$t._referenceCount||$t.destroy();},$B._uniqueIDCounter=0,$B._idResourcesMap={},$B._urlResourcesMap={},$B._groupResourcesMap={},$B;}()),$bd=function($d){function $p($d,$t){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$p.__super.call(this),$d&&null!=$d._addReference&&$d._addReference(),this.setTo($d,$t);}$w($p,"laya.resource.Texture",$I);var $t=$p.prototype;return $t._setUrl=function($d){this.url=$d;},$t.setTo=function($d,$t){if($d instanceof $A.HTMLElement){var $l=$gd.create("2D",$d);this.bitmap=$l;}else this.bitmap=$d;if(this.uv=$t||$p.DEF_UV,$d){this._w=$d.width,this._h=$d.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $k=this;if(this._loaded)$r.addToAtlas&&$r.addToAtlas($k);else{var $W=$d;$W instanceof laya.resource.HTMLImage&&$W.image&&$W.image.addEventListener("load",function($d){$r.addToAtlas&&$r.addToAtlas($k);},!1);}}},$t.active=function(){this.bitmap&&this.bitmap.activeResource();},$t.destroy=function($d){if(void 0===$d&&($d=!1),this.alphaTexture&&(this.alphaTexture.destroy($d),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $t=this.bitmap;$d?($K.isConchApp&&$t.source&&$t.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$t.dispose(),$t._clearReference()):($t._removeReference(),0==$t.referenceCount&&($K.isConchApp&&$t.source&&$t.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$t.dispose())),this.url&&this===$q.loader.getRes(this.url)&&$q.loader.clearRes(this.url,$d),this._loaded=!1;}},$t.load=function($d){var $t=this;this._loaded=!1,$d=$C.customFormat($d);var $l=this.bitmap||(this.bitmap=$Gd.create($d));$l.uri=$d,$l&&$l._addReference();var $k=this;$l.onload=function(){$l.onload=null,$k._loaded=!0,$t.sourceWidth=$t._w=$l.width,$t.sourceHeight=$t._h=$l.height,$k.event("loaded",this),$r.addToAtlas&&$r.addToAtlas($k);};},$t.addTextureToAtlas=function($d){$r.addTextureToAtlas(this);},$t.getPixels=function($d,$t,$l,$k){if($K.isConchApp){var $W=this.bitmap;if($W.source&&$W.source.getImageData){var $i=$W.source.getImageData($d,$t,$l,$k),$A=new Uint8Array($i);return Array.from($A);}return null;}return $K.isWebGL?$r.getTexturePixels(this,$d,$t,$l,$k):($V.canvas.size($l,$k),$V.canvas.clear(),$V.context.drawTexture(this,-$d,-$t,this.width,this.height,0,0),$V.context.getImageData(0,0,$l,$k).data);},$t.onAsynLoaded=function($d,$t){if($t){if("function"!=typeof $t._addReference)throw new Error("bitmap._addReference is not a function. "+$t.className+" "+typeof $t._addReference+" "+$t.constructor);$t._addReference();}this.setTo($t,this.uv),this._loaded&&this.event("loaded",this);},$b(0,$t,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null;}),$b(0,$t,"loaded",function(){return this._loaded;}),$b(0,$t,"released",function(){return!this.bitmap||this.bitmap.released;}),$b(0,$t,"width",function(){return this._w?this._w:this.uv&&this.uv!==$p.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width;},function($d){this._w=$d,this.sourceWidth||(this.sourceWidth=$d);}),$b(0,$t,"repeat",function(){return!$K.isWebGL||!this.bitmap||this.bitmap.repeat;},function($d){$d&&$K.isWebGL&&this.bitmap&&(this.bitmap.repeat=$d)&&(this.bitmap.enableMerageInAtlas=!1);}),$b(0,$t,"height",function(){return this._h?this._h:this.uv&&this.uv!==$p.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height;},function($d){this._h=$d,this.sourceHeight||(this.sourceHeight=$d);}),$b(0,$t,"isLinearSampling",function(){return!$K.isWebGL||9728!=this.bitmap.minFifter;},function($d){!$d&&$K.isWebGL&&($d||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1));}),$p.moveUV=function($d,$t,$l){for(var $k=0;$k<8;$k+=2)$l[$k]+=$d,$l[$k+1]+=$t;return $l;},$p.create=function($d,$t,$l,$k,$W,$i,$A,$B,$o){void 0===$i&&($i=0),void 0===$A&&($A=0),void 0===$B&&($B=0),void 0===$o&&($o=0);var $I=$d instanceof laya.resource.Texture,$b=$I?$d.uv:$p.DEF_UV,$f=$I?$d.bitmap:$d,$J=$r.isAtlas($f);if($J){var $c=$f._atlaser,$Y=$d._atlasID;if(-1==$Y)throw new Error("create texture error");$f=$c._inAtlasTextureBitmapValue[$Y],$b=$c._inAtlasTextureOriUVValue[$Y];}var $w=new $p($f,null);$f.width&&$t+$k>$f.width&&($k=$f.width-$t),$f.height&&$l+$W>$f.height&&($W=$f.height-$l),$w.width=$k,$w.height=$W,$w.offsetX=$i,$w.offsetY=$A,$w.sourceWidth=$B||$k,$w.sourceHeight=$o||$W;var $D=1/$f.width,$z=1/$f.height;$t*=$D,$l*=$z,$k*=$D,$W*=$z;var $e=$w.uv[0],$g=$w.uv[1],$H=$w.uv[4],$R=$w.uv[5],$G=$H-$e,$q=$R-$g,$L=$p.moveUV($b[0],$b[1],[$t,$l,$t+$k,$l,$t+$k,$l+$W,$t,$l+$W]);$w.uv=[$e+$L[0]*$G,$g+$L[1]*$q,$H-(1-$L[2])*$G,$g+$L[3]*$q,$H-(1-$L[4])*$G,$R-(1-$L[5])*$q,$e+$L[6]*$G,$R-(1-$L[7])*$q],$J&&$w.addTextureToAtlas();var $$=$f.scaleRate;return $$&&1!=$$?($w.sourceWidth/=$$,$w.sourceHeight/=$$,$w.width/=$$,$w.height/=$$,$w.scaleRate=$$,$w.offsetX/=$$,$w.offsetY/=$$):$w.scaleRate=1,$w;},$p.createFromTexture=function($d,$t,$l,$k,$W){var $i=$d.scaleRate;1!=$i&&($t*=$i,$l*=$i,$k*=$i,$W*=$i);var $A=$$.TEMP.setTo($t-$d.offsetX,$l-$d.offsetY,$k,$W),$B=$A.intersection($p._rect1.setTo(0,0,$d.width,$d.height),$p._rect2);if(!$B)return null;var $o=$p.create($d,$B.x,$B.y,$B.width,$B.height,$B.x-$A.x,$B.y-$A.y,$k,$W);if($o.bitmap&&$o.bitmap._removeReference)return $o.bitmap._removeReference(),$o;var $I="bitmap:"+($o.bitmap?$o.bitmap.constructor?$o.bitmap.constructor.name:$o.bitmap.__className:"")+", url:"+($d.url+" | "+($o.bitmap?$o.bitmap.url:$d.url))+", x="+$t+",y="+$l+",width="+$k+",height="+$W+", result="+($B?$B.x+","+$B.y+","+$B.width+","+$B.height:"null")+", rect="+$A.x+","+$A.y+","+$A.width+","+$A.height;throw new Error("报错：bitmap._removeReference is not a function  "+$I);},$p.DEF_UV=[0,0,1,0,1,1,0,1],$p.INV_UV=[0,1,1,1,1,0,0,0],$p._rect1=new $$(),$p._rect2=new $$(),$p;}(),$d=function($d){var $B;function $i(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$i.__super.call(this);}$w($i,"laya.utils.TimeLine",$I);var $t=$i.prototype;return $t.to=function($d,$t,$l,$k,$W){return void 0===$W&&($W=0),this._create($d,$t,$l,$k,$W,!0);},$t.from=function($d,$t,$l,$k,$W){return void 0===$W&&($W=0),this._create($d,$t,$l,$k,$W,!1);},$t._create=function($d,$t,$l,$k,$W,$i){var $A=$P.getItemByClass("tweenData",$B);return $A.isTo=$i,$A.type=0,$A.target=$d,$A.duration=$l,$A.data=$t,$A.startTime=this._startTime+$W,$A.endTime=$A.startTime+$A.duration,$A.ease=$k,this._startTime=Math.max($A.endTime,this._startTime),this._tweenDataList.push($A),this._startTimeSort=!0,this._endTimeSort=!0,this;},$t.addLabel=function($d,$t){var $l=$P.getItemByClass("tweenData",$B);return $l.type=1,$l.data=$d,$l.endTime=$l.startTime=this._startTime+$t,this._labelDic||(this._labelDic={}),this._labelDic[$d]=$l,this._tweenDataList.push($l),this;},$t.removeLabel=function($d){if(this._labelDic&&this._labelDic[$d]){var $t=this._labelDic[$d];if($t){var $l=this._tweenDataList.indexOf($t);-1<$l&&this._tweenDataList.splice($l,1);}delete this._labelDic[$d];}},$t.gotoTime=function($d){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $t,$l,$k,$W;for(var $i in this._firstTweenDic)if($l=this._firstTweenDic[$i])for(var $A in $l)$l.diyTarget.hasOwnProperty($A)&&($l.diyTarget[$A]=$l[$A]);for($i in this._tweenDic)($t=this._tweenDic[$i]).clear(),delete this._tweenDic[$i];if(this._index=0,this._gidIndex=0,this._currTime=$d,this._lastTime=$V.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$k=this._tweenDataList.concat(),$k.sort(function($d,$t){return $d.endTime>$t.endTime?1:$d.endTime<$t.endTime?-1:0;});}else $k=this._endTweenDataList;for(var $B=0,$o=$k.length;$B<$o;$B++)if(0==($W=$k[$B]).type){if(!($d>=$W.endTime))break;this._index=Math.max(this._index,$B+1);var $I=$W.data;if($W.isTo)for(var $b in $I)$W.target[$b]=$I[$b];}for($B=0,$o=this._tweenDataList.length;$B<$o;$B++)0==($W=this._tweenDataList[$B]).type&&$d>=$W.startTime&&$d<$W.endTime&&(this._index=Math.max(this._index,$B+1),this._gidIndex++,($t=$P.getItemByClass("tween",$O))._create($W.target,$W.data,$W.duration,$W.ease,$e.create(this,this._animComplete,[this._gidIndex]),0,!1,$W.isTo,!0,!1),$t.setStartTime(this._currTime-($d-$W.startTime)),$t._updateEase(this._currTime),$t.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$t);}},$t.gotoLabel=function($d){if(null!=this._labelDic){var $t=this._labelDic[$d];$t&&this.gotoTime($t.startTime);}},$t.pause=function(){$q.timer.clear(this,this._update);},$t.resume=function(){this.play(this._currTime,this._loopKey);},$t.play=function($d,$t){if(void 0===$d&&($d=0),void 0===$t&&($t=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($d,$t){return $d.startTime>$t.startTime?1:$d.startTime<$t.startTime?-1:0;});for(var $l=0,$k=this._tweenDataList.length;$l<$k;$l++){var $W=this._tweenDataList[$l];if(null!=$W&&0==$W.type){var $i=$W.target,$A=$i.$_GID||($i.$_GID=$F.getGID()),$B=null;for(var $o in null==this._firstTweenDic[$A]?(($B={}).diyTarget=$i,this._firstTweenDic[$A]=$B):$B=this._firstTweenDic[$A],$W.data)null==$B[$o]&&($B[$o]=$i[$o]);}}}"string"==typeof $d?this.gotoLabel($d):this.gotoTime($d),this._loopKey=$t,this._lastTime=$V.now(),$q.timer.frameLoop(1,this,this._update);}},$t._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $d in this._tweenDic)($t=this._tweenDic[$d]).complete();return this._complete(),void this.pause();}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0);}var $t,$l=$V.now(),$k=$l-this._lastTime,$W=this._currTime+=$k*this.scale;for($d in this._lastTime=$l,this._tweenDic)($t=this._tweenDic[$d])._updateEase($W);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $i=this._tweenDataList[this._index];$W>=$i.startTime&&(this._index++,0==$i.type?(this._gidIndex++,($t=$P.getItemByClass("tween",$O))._create($i.target,$i.data,$i.duration,$i.ease,$e.create(this,this._animComplete,[this._gidIndex]),0,!1,$i.isTo,!0,!1),$t.setStartTime($W),$t.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$t)._updateEase($W)):this.event("label",$i.data));}},$t._animComplete=function($d){this._tweenDic[$d]&&delete this._tweenDic[$d];},$t._complete=function(){this.event("complete");},$t.reset=function(){var $d;if(this._labelDic)for($d in this._labelDic)delete this._labelDic[$d];for($d in this._tweenDic)this._tweenDic[$d].clear(),delete this._tweenDic[$d];for($d in this._firstTweenDic)delete this._firstTweenDic[$d];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $t,$l=0;for($t=this._tweenDataList.length,$l=0;$l<$t;$l++)this._tweenDataList[$l]&&this._tweenDataList[$l].destroy();}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$q.timer.clear(this,this._update);},$t.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null;},$b(0,$t,"index",function(){return this._frameIndex;},function($d){this._frameIndex=$d,this.gotoTime(this._frameIndex/this._frameRate*1e3);}),$b(0,$t,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total;}),$i.to=function($d,$t,$l,$k,$W){return void 0===$W&&($W=0),new $i().to($d,$t,$l,$k,$W);},$i.from=function($d,$t,$l,$k,$W){return void 0===$W&&($W=0),new $i().from($d,$t,$l,$k,$W);},$i.__init$=function(){$B=function(){function $d(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null;}return $w($d,""),$d.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$P.recover("tweenData",this);},$d;}();},$i;}(),$fd=function($W){function $l(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$l.__super.call(this),this._style=$B.EMPTY;}$w($l,"laya.display.Sprite",$W);var $d=$l.prototype;return $q.imps($d,{"laya.display.ILayout":!0}),$d.createConchModel=function(){return new ConchNode();},$d.destroy=function($d){if(void 0===$d&&($d=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $t=this.mask;$t&&(this.mask=null,$t.destroy($d));}$W.prototype.destroy.call(this,$d),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null;},$d.updateZOrder=function(){$F.updateOrder(this._childs)&&this.repaint();},$d.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1;},$d.setBounds=function($d){this._set$P("uBounds",$d);},$d.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $$()),$$._getWrapRec(this._boundPointsToParent(),this._$P.mBounds);},$d.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $$()),$$._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds));},$d._boundPointsToParent=function($d){void 0===$d&&($d=!1);var $t=0,$l=0;this._style&&($t=this._style._tf.translateX,$l=this._style._tf.translateY,$d=$d||0!==this._style._tf.rotate,this._style.scrollRect&&($t+=this._style.scrollRect.x,$l+=this._style.scrollRect.y));var $k=this._getBoundPointsM($d);if(!$k||$k.length<1)return $k;if(8!=$k.length&&($k=$d?$R.scanPList($k):$$._getWrapRec($k,$$.TEMP)._getBoundPoints()),!this.transform)return $F.transPointList($k,this._x-$t,this._y-$l),$k;var $W=$L.TEMP,$i=0,$A=$k.length;for($i=0;$i<$A;$i+=2)$W.x=$k[$i],$W.y=$k[$i+1],this.toParentPoint($W),$k[$i]=$W.x,$k[$i+1]=$W.y;return $k;},$d.getGraphicBounds=function($d){return void 0===$d&&($d=!1),this._graphics?this._graphics.getBounds($d):$$.TEMP.setTo(0,0,0,0);},$d._getBoundPointsM=function($d){if(void 0===$d&&($d=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $t=$F.clearArray(this._$P.temBM),$l=$$.TEMP;return $l.copyFrom(this.scrollRect),$F.concatArray($t,$l._getBoundPoints()),$t;}for(var $k,$W,$i,$A=this._graphics?this._graphics.getBoundPoints():$F.clearArray(this._$P.temBM),$B=0,$o=($i=this._childs).length;$B<$o;$B++)($k=$i[$B])instanceof laya.display.Sprite&&1==$k.visible&&($W=$k._boundPointsToParent($d))&&($A=$A?$F.concatArray($A,$W):$W);return $A;},$d.getStyle=function(){return this._style===$B.EMPTY&&(this._style=new $B()),this._style;},$d.setStyle=function($d){this._style=$d;},$d._adjustTransform=function(){this._tfChanged=!1;var $d,$t=this._style._tf,$l=$t.scaleX,$k=$t.scaleY;if($t.rotate||1!==$l||1!==$k||$t.skewX||$t.skewY){($d=this._transform||(this._transform=$S.create())).bTransform=!0;var $W=.0174532922222222*($t.rotate-$t.skewX),$i=.0174532922222222*($t.rotate+$t.skewY),$A=Math.cos($i),$B=Math.sin($i),$o=Math.sin($W),$I=Math.cos($W);return $d.a=$l*$A,$d.b=$l*$B,$d.c=-$k*$o,$d.d=$k*$I,$d.tx=$d.ty=0,$d;}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$d;},$d.pos=function($d,$t,$l){if(void 0===$l&&($l=!1),this._x!==$d||this._y!==$t){if(this.destroyed)return this;if($l){this._x=$d,this._y=$t,this.conchModel&&this.conchModel.pos(this._x,this._y);var $k=this._parent;$k&&0===$k._repaint&&($k._repaint=1,$k.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}else this.x=$d,this.y=$t;}return this;},$d.pivot=function($d,$t){return this.pivotX=$d,this.pivotY=$t,this;},$d.size=function($d,$t){return this.width=$d,this.height=$t,this;},$d.scale=function($d,$t,$l){void 0===$l&&($l=!1);var $k=this.getStyle(),$W=$k._tf;if($W.scaleX!=$d||$W.scaleY!=$t){if(this.destroyed)return this;if($l){$k.setScale($d,$t),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($d,$t),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}else this.scaleX=$d,this.scaleY=$t;}return this;},$d.skew=function($d,$t){return this.skewX=$d,this.skewY=$t,this;},$d.render=function($d,$t,$l){$X.spriteCount++,$n.renders[this._renderType]._fun(this,$d,$t+this._x,$l+this._y),this._repaint=0;},$d.drawToCanvas=function($d,$t,$l,$k){if($K.isConchNode){var $W=$gd.create("2D");return new $x($d,$t,$W).ctx.setCanvasType(1),this.conchModel.drawToCanvas($W.source,$l,$k),$W;}return $r.drawToCanvas(this,this._renderType,$d,$t,$l,$k);},$d.customRender=function($d,$t,$l){this._renderType|=1024;},$d._applyFilters=function(){var $d;if(!$K.isWebGL&&($d=this._$P.filters)&&!($d.length<1))for(var $t=0,$l=$d.length;$t<$l;$t++)$d[$t].action.apply(this._$P.cacheCanvas);},$d._isHaveGlowFilter=function(){var $d,$t=0;if(this.filters)for($t=0;$t<this.filters.length;$t++)if(8==this.filters[$t].type)return!0;for($t=0,$d=this._childs.length;$t<$d;$t++)if(this._childs[$t]._isHaveGlowFilter())return!0;return!1;},$d.localToGlobal=function($d,$t){void 0===$t&&($t=!1),!0===$t&&($d=new $L($d.x,$d.y));for(var $l=this;$l&&$l!=$q.stage;)$d=$l.toParentPoint($d),$l=$l.parent;return $d;},$d.globalToLocal=function($d,$t){void 0===$t&&($t=!1),$t&&($d=new $L($d.x,$d.y));for(var $l=this,$k=[];$l&&$l!=$q.stage;)$k.push($l),$l=$l.parent;for(var $W=$k.length-1;0<=$W;)$d=($l=$k[$W]).fromParentPoint($d),$W--;return $d;},$d.toParentPoint=function($d){if(!$d)return $d;$d.x-=this.pivotX,$d.y-=this.pivotY,this.transform&&this._transform.transformPoint($d),$d.x+=this._x,$d.y+=this._y;var $t=this._style.scrollRect;return $t&&($d.x-=$t.x,$d.y-=$t.y),$d;},$d.fromParentPoint=function($d){if(!$d)return $d;$d.x-=this._x,$d.y-=this._y;var $t=this._style.scrollRect;return $t&&($d.x+=$t.x,$d.y+=$t.y),this.transform&&this._transform.invertTransformPoint($d),$d.x+=this.pivotX,$d.y+=this.pivotY,$d;},$d.on=function($d,$t,$l,$k){return 1!==this._mouseEnableState&&this.isMouseEvent($d)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($d,$t,$l,$k,!1)):$W.prototype.on.call(this,$d,$t,$l,$k);},$d.once=function($d,$t,$l,$k){return 1!==this._mouseEnableState&&this.isMouseEvent($d)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($d,$t,$l,$k,!0)):$W.prototype.once.call(this,$d,$t,$l,$k);},$d._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $d=this;for($d=$d.parent;$d&&1!==$d._mouseEnableState&&!$d._getBit(2);)$d.mouseEnabled=!0,$d._setBit(2,!0),$d=$d.parent;}},$d.loadImage=function($d,$t,$l,$k,$W,$i){var $A=this;return void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),void 0===$W&&($W=0),this.graphics.loadImage($d,$t,$l,$k,$W,function($d){$A.destroyed||($A.size($t+($k||$d.width),$l+($W||$d.height)),$A.repaint(),$i&&$i.runWith($d));}),this;},$d.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint();},$d._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache;},$d._childChanged=function($d){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$d&&this._get$P("hasZorder")&&$q.timer.callLater(this,this.updateZOrder),this.repaint();},$d.parentRepaint=function(){var $d=this._parent;$d&&0===$d._repaint&&($d._repaint=1,$d.parentRepaint());},$d.startDrag=function($d,$t,$l,$k,$W,$i,$A){void 0===$t&&($t=!1),void 0===$l&&($l=0),void 0===$k&&($k=300),void 0===$i&&($i=!1),void 0===$A&&($A=.92),this._$P.dragging||this._set$P("dragging",new $u()),this._$P.dragging.start(this,$d,$t,$l,$k,$W,$i,$A);},$d.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop();},$d._releaseMem=function(){if(this._$P){var $d=this._$P.cacheCanvas;$d&&$d.ctx&&($P.recover("RenderContext",$d.ctx),$d.ctx.canvas.size(0,0),$d.ctx=null);var $t=this._$P._filterCache;$t&&($t.destroy(),$t.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null;}},$d._setDisplay=function($d){$d||this._releaseMem(),$W.prototype._setDisplay.call(this,$d);},$d.hitTestPoint=function($d,$t){var $l=this.globalToLocal($L.TEMP.setTo($d,$t));return $d=$l.x,$t=$l.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$$.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($d,$t);},$d.getMousePoint=function(){return this.globalToLocal($L.TEMP.setTo($q.stage.mouseX,$q.stage.mouseY));},$d._getWords=function(){return null;},$d._addChildsToLayout=function($d){var $t=this._getWords();if(null==$t&&0==this._childs.length)return!1;if($t)for(var $l=0,$k=$t.length;$l<$k;$l++)$d.push($t[$l]);$l=0;for(var $W=this._childs.length;$l<$W;++$l){var $i=this._childs[$l];$i._style._enableLayout()&&$i._addToLayout($d);}return!0;},$d._addToLayout=function($d){this._style.absolute||(this._style.block?$d.push(this):this._addChildsToLayout($d)&&(this.x=this.y=0));},$d._isChar=function(){return!1;},$d._getCSSStyle=function(){return this._style.getCSSStyle();},$d._setAttributes=function($d,$t){switch($d){case"x":this.x=parseFloat($t);break;case"y":this.y=parseFloat($t);break;case"width":this.width=parseFloat($t);break;case"height":this.height=parseFloat($t);break;default:this[$d]=$t;}},$d._layoutLater=function(){this.parent&&this.parent._layoutLater();},$b(0,$d,"optimizeScrollRect",function(){return this._optimizeScrollRect;},function($d){this._optimizeScrollRect!=$d&&(this._optimizeScrollRect=$d,this.conchModel&&this.conchModel.optimizeScrollRect($d));}),$b(0,$d,"customRenderEnable",null,function($d){if($d&&(this._renderType|=1024,$K.isConchNode)){$l.CustomList.push(this);var $t=new $gd("2d");$t._setContext(new CanvasRenderingContext2D()),this.customContext=new $x(0,0,$t),$t.context.setCanvasType&&$t.context.setCanvasType(2),this.conchModel.custom($t.context);}}),$b(0,$d,"cacheAsBitmap",function(){return"none"!==this.cacheAs;},function($d){this.cacheAs=$d?this._$P.hasFilter?"none":"normal":"none";}),$b(0,$d,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type;},function($d){var $t=this._$P.cacheCanvas;if($d!==($t?$t.type:"none")){if("none"!==$d)this._getBit(1)||this._setUpNoticeType(1),$t||($t=this._set$P("cacheCanvas",$P.getItemByClass("cacheCanvas",Object))),$t.type=$d,$t.reCache=!0,this._renderType|=16,"bitmap"==$d&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($t){var $l=$t;$l&&$l.ctx&&($P.recover("RenderContext",$l.ctx),$l.ctx.canvas.size(0,0),$l.ctx=null),$P.recover("cacheCanvas",$t);}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0);}this.repaint();}}),$b(0,$d,"zOrder",function(){return this._zOrder;},function($d){this._zOrder!=$d&&(this._zOrder=$d,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($d),this._parent&&($d&&this._parent._set$P("hasZorder",!0),$q.timer.callLater(this._parent,this.updateZOrder)));}),$b(0,$d,"rotation",function(){return this._style._tf.rotate;},function($d){var $t=this.getStyle();if($t._tf.rotate!==$d){$t.setRotate($d),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($d),this._renderType|=4;var $l=this._parent;$l&&0===$l._repaint&&($l._repaint=1,$l.parentRepaint());}}),$b(0,$d,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($d){this._width!==$d&&(this._width=$d,this.conchModel&&this.conchModel.size($d,this._height),this.repaint());}),$b(0,$d,"x",function(){return this._x;},function($d){if(this._x!==$d){if(this.destroyed)return;this._x=$d,this.conchModel&&this.conchModel.pos($d,this._y);var $t=this._parent;$t&&0===$t._repaint&&($t._repaint=1,$t.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$b(0,$d,"globalScaleY",function(){for(var $d=1,$t=this;$t&&$t!==$q.stage;)$d*=$t.scaleY,$t=$t.parent;return $d;}),$b(0,$d,"hitArea",function(){return this._$P.hitArea;},function($d){this._set$P("hitArea",$d);}),$b(0,$d,"staticCache",function(){return this._$P.staticCache;},function($d){this._set$P("staticCache",$d),$d||this.reCache();}),$b(0,$d,"texture",function(){return this._texture;},function($d){this._texture!=$d&&(this._texture=$d,this.graphics.cleanByTexture($d,0,0));}),$b(0,$d,"y",function(){return this._y;},function($d){if(this._y!==$d){if(this.destroyed)return;this._y=$d,this.conchModel&&this.conchModel.pos(this._x,$d);var $t=this._parent;$t&&0===$t._repaint&&($t._repaint=1,$t.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$b(0,$d,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($d){this._height!==$d&&(this._height=$d,this.conchModel&&this.conchModel.size(this._width,$d),this.repaint());}),$b(0,$d,"blendMode",function(){return this._style.blendMode;},function($d){this.getStyle().blendMode=$d,this.conchModel&&this.conchModel.blendMode($d),$d&&"source-over"!=$d?this._renderType|=8:this._renderType&=-9,this.parentRepaint();}),$b(0,$d,"scaleX",function(){return this._style._tf.scaleX;},function($d){var $t=this.getStyle();if($t._tf.scaleX!==$d){$t.setScaleX($d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($d,$t._tf.scaleY),this._renderType|=4;var $l=this._parent;$l&&0===$l._repaint&&($l._repaint=1,$l.parentRepaint());}}),$b(0,$d,"scaleY",function(){return this._style._tf.scaleY;},function($d){var $t=this.getStyle();if($t._tf.scaleY!==$d){$t.setScaleY($d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($t._tf.scaleX,$d),this._renderType|=4;var $l=this._parent;$l&&0===$l._repaint&&($l._repaint=1,$l.parentRepaint());}}),$b(0,$d,"stage",function(){return $q.stage;}),$b(0,$d,"skewX",function(){return this._style._tf.skewX;},function($d){var $t=this.getStyle();if($t._tf.skewX!==$d){$t.setSkewX($d),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($d,$t._tf.skewY),this._renderType|=4;var $l=this._parent;$l&&0===$l._repaint&&($l._repaint=1,$l.parentRepaint());}}),$b(0,$d,"scrollRect",function(){return this._style.scrollRect;},function($d){this.getStyle().scrollRect=$d,this.repaint(),$d?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($d.x,$d.y,$d.width,$d.height)):(this._renderType&=-129,this.conchModel&&($l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)));}),$b(0,$d,"skewY",function(){return this._style._tf.skewY;},function($d){var $t=this.getStyle();if($t._tf.skewY!==$d){$t.setSkewY($d),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($t._tf.skewX,$d),this._renderType|=4;var $l=this._parent;$l&&0===$l._repaint&&($l._repaint=1,$l.parentRepaint());}}),$b(0,$d,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform;},function($d){this._tfChanged=!1,(this._transform=$d)&&(this._x=$d.tx,this._y=$d.ty,$d.tx=$d.ty=0,this.conchModel&&this.conchModel.transform($d.a,$d.b,$d.c,$d.d,this._x,this._y)),$d?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint();}),$b(0,$d,"pivotX",function(){return this._style._tf.translateX;},function($d){this.getStyle().setTranslateX($d),this.conchModel&&this.conchModel.pivot($d,this._style._tf.translateY),this.repaint();}),$b(0,$d,"pivotY",function(){return this._style._tf.translateY;},function($d){this.getStyle().setTranslateY($d),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$d),this.repaint();}),$b(0,$d,"alpha",function(){return this._style.alpha;},function($d){this._style&&this._style.alpha!==$d&&($d=$d<0?0:1<$d?1:$d,this.getStyle().alpha=$d,this.conchModel&&this.conchModel.alpha($d),1!==$d?this._renderType|=2:this._renderType&=-3,this.parentRepaint());}),$b(0,$d,"visible",function(){return this._style.visible;},function($d){this._style&&this._style.visible!==$d&&(this.getStyle().visible=$d,this.conchModel&&this.conchModel.visible($d),this.parentRepaint());}),$b(0,$d,"graphics",function(){return this._graphics||(this.graphics=$r.createGraphics());},function($d){this._graphics&&(this._graphics._sp=null),(this._graphics=$d)?(this._renderType&=-2,this._renderType|=512,($d._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint();}),$b(0,$d,"filters",function(){return this._$P.filters;},function($d){$d&&0===$d.length&&($d=null),this._$P.filters!=$d&&(this._set$P("filters",$d?$d.slice():null),$K.isConchApp&&(this.conchModel&&($l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$K.isWebGL&&($d&&$d.length?this._renderType|=32:this._renderType&=-33),$d&&0<$d.length?(this._getBit(1)||this._setUpNoticeType(1),$K.isWebGL&&1==$d.length&&$d[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($K.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint());}),$b(0,$d,"parent",$W.prototype._$get_parent,function($d){$q.superSet($dd,this,"parent",$d),$d&&this._getBit(2)&&this._$2__onDisplay();}),$b(0,$d,"mask",function(){return this._$P._mask;},function($d){$d&&this.mask&&this.mask._$P.maskParent||($d?(this.cacheAs="bitmap",this._set$P("_mask",$d),$d._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$d),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($d?$d.conchModel:null),this._renderType|=64,this.parentRepaint());}),$b(0,$d,"mouseEnabled",function(){return 1<this._mouseEnableState;},function($d){this._mouseEnableState=$d?2:1;}),$b(0,$d,"globalScaleX",function(){for(var $d=1,$t=this;$t&&$t!==$q.stage;)$d*=$t.scaleX,$t=$t.parent;return $d;}),$b(0,$d,"mouseX",function(){return this.getMousePoint().x;}),$b(0,$d,"mouseY",function(){return this.getMousePoint().y;}),$l.fromImage=function($d){return new $l().loadImage($d);},$l._cachePool=[],$l.CustomList=[],$o($l,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$A.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):"";}]),$l;}($dd),$Jd=function($d){function $t($d){this._audio=null,this._onEnd=null,this._resumePlay=null,$t.__super.call(this),this._onEnd=$F.bind(this.__onEnd,this),this._resumePlay=$F.bind(this.__resumePlay,this),$d.addEventListener("ended",this._onEnd),this._audio=$d;}$w($t,"laya.media.h5audio.AudioSoundChannel",$kd);var $l=$t.prototype;return $l.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$l.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$V.container.appendChild(this._audio),this._audio.play();}catch($d){this.event("error");}},$l.play=function($d){this.isStopped=!1;try{this._audio.playbackRate=$T.playbackRate,this._audio.currentTime=this.startTime;}catch($d){return void this._audio.addEventListener("canplay",this._resumePlay);}$T.addChannel(this),$V.container.appendChild(this._audio),!$d&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play();},$l.stop=function(){this.isStopped=!0,$T.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$K.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$V.onIE||this._audio!=$ld._musicAudio&&$P.recover("audio:"+this.url,this._audio),$V.removeElement(this._audio),this._audio=null);},$l.pause=function(){this.isStopped=!0,$T.removeChannel(this),"pause"in this._audio&&this._audio.pause();},$l.resume=function(){this._audio&&(this.isStopped=!1,$T.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play());},$b(0,$l,"position",function(){return this._audio?this._audio.currentTime:0;}),$b(0,$l,"duration",function(){return this._audio?this._audio.duration:0;}),$b(0,$l,"volume",function(){return this._audio?this._audio.volume:1;},function($d){this._audio&&(this._audio.volume=$d);}),$t;}(),$cd=function($d){function $t(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$id.ctx,$t.__super.call(this),this._onPlayEnd=$F.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode();}$w($t,"laya.media.webaudio.WebAudioSoundChannel",$kd);var $l=$t.prototype;return $l.play=function($d){if($T.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $t=this.context,$l=this.gain,$k=$t.createBufferSource();(this.bufferSource=$k).buffer=this.audioBuffer,$k.connect($l),$l&&$l.disconnect(),$l.connect($t.destination),$k.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$V.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($k.loop=!0),$k.playbackRate.setTargetAtTime?$k.playbackRate.setTargetAtTime($T.playbackRate,this.context.currentTime,.1):$k.playbackRate.value=$T.playbackRate,$k.start(0,this.startTime),!$d&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0;}},$l.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$l._clearBufferSource=function(){if(this.bufferSource){var $d=this.bufferSource;$d.stop?$d.stop(0):$d.noteOff(0),$d.disconnect(0),$d.onended=null,$t._tryCleanFailed||this._tryClearBuffer($d),this.bufferSource=null;}},$l._tryClearBuffer=function($d){try{$d.buffer=null;}catch($d){$t._tryCleanFailed=!0;}},$l.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$T.removeChannel(this),this.startHandler=null,this.completeHandler=null;},$l.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$T.removeChannel(this);},$l.resume=function(){this.startTime=this._pauseTime,this.play(!1);},$b(0,$l,"position",function(){return this.bufferSource?($V.now()-this._startTime)/1e3+this.startTime:0;}),$b(0,$l,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$b(0,$l,"volume",function(){return this._volume;},function($d){this.isStopped||(this._volume=$d,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($d,this.context.currentTime,.1):this.gain.gain.value=$d);}),$t._tryCleanFailed=!1,$t;}(),$Yd=function($d){function $t(){$t.__super.call(this),this._w=0,this._h=0;}$w($t,"laya.resource.Bitmap",$Id);var $l=$t.prototype;return $b(0,$l,"width",function(){return this._w;}),$b(0,$l,"height",function(){return this._h;}),$b(0,$l,"source",function(){return this._source;}),$t;}(),$wd=function($t){function $d(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$d.__super.call(this),this._interval=$k.animationInterval,this._setUpNoticeType(1);}$w($d,"laya.display.AnimationPlayerBase",$t);var $l=$d.prototype;return $l.play=function($d,$t,$l,$k){void 0===$d&&($d=0),void 0===$t&&($t=!0),void 0===$l&&($l=""),void 0===$k&&($k=!0),this._isPlaying=!0,this.index="string"==typeof $d?this._getFrameByLabel($d):$d,this.loop=$t,this._actionName=$l,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$l._getFrameByLabel=function($d){var $t=0;for($t=0;$t<this._count;$t++)if(this._labels[$t]&&0<=this._labels[$t].indexOf($d))return $t;return 0;},$l._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete");}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete");}this.index=this._index;},$l._setControlNode=function($d){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$d)&&$d!=this&&($d.on("display",this,this._checkResumePlaying),$d.on("undisplay",this,this._checkResumePlaying));},$l._setDisplay=function($d){$t.prototype._setDisplay.call(this,$d),this._checkResumePlaying();},$l._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop));},$l.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop);},$l.addLabel=function($d,$t){this._labels||(this._labels={}),this._labels[$t]||(this._labels[$t]=[]),this._labels[$t].push($d);},$l.removeLabel=function($d){if($d){if(this._labels)for(var $t in this._labels)this._removeLabelFromLabelList(this._labels[$t],$d);}else this._labels=null;},$l._removeLabelFromLabelList=function($d,$t){if($d)for(var $l=$d.length-1;0<=$l;$l--)$d[$l]==$t&&$d.splice($l,1);},$l.gotoAndStop=function($d){this.index="string"==typeof $d?this._getFrameByLabel($d):$d,this.stop();},$l._displayToIndex=function($d){},$l.clear=function(){this.stop(),this._labels=null;},$b(0,$l,"interval",function(){return this._interval;},function($d){this._interval!=$d&&(this._frameRateChanged=!0,this._interval=$d,this._isPlaying&&0<$d&&this.timerLoop($d,this,this._frameLoop,null,!0,!0));}),$b(0,$l,"isPlaying",function(){return this._isPlaying;}),$b(0,$l,"index",function(){return this._index;},function($d){if(this._index=$d,this._displayToIndex($d),this._labels&&this._labels[$d])for(var $t=this._labels[$d],$l=0,$k=$t.length;$l<$k;$l++)this.event("label",$t[$l]);}),$b(0,$l,"count",function(){return this._count;}),$d.WRAP_POSITIVE=0,$d.WRAP_REVERSE=1,$d.WRAP_PINGPONG=2,$d;}($fd),$Dd=function($t){function $c(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$c.__super.call(this),this.overflow=$c.VISIBLE,this._style=new $td(this),this._style.wordWrap=!1;}$w($c,"laya.display.Text",$t);var $d=$c.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._lines=null,this._words&&(this._words.length=0,this._words=null);},$d._getBoundPointsM=function($d){void 0===$d&&($d=!1);var $t=$$.TEMP;return $t.setTo(0,0,this.width,this.height),$t._getBoundPoints();},$d.getGraphicBounds=function($d){void 0===$d&&($d=!1);var $t=$$.TEMP;return $t.setTo(0,0,this.width,this.height),$t;},$d._getCSSStyle=function(){return this._style;},$d.lang=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b){if($d=$c.langPacks&&$c.langPacks[$d]?$c.langPacks[$d]:$d,arguments.length<2)this._text=$d;else{for(var $f=0,$J=arguments.length;$f<$J;$f++)$d=$d.replace("{"+$f+"}",arguments[$f+1]);this._text=$d;}},$d._isPassWordMode=function(){var $d=this._style.password;return"prompt"in this&&this.prompt==this._text&&($d=!1),$d;},$d._getPassWordTxt=function($d){var $t;$t="";for(var $l=$d.length;0<$l;$l--)$t+="●";return $t;},$d.renderText=function($d,$t){var $l=this.graphics;$l.clear(!0);var $k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($V.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$V.context.font=$k;var $W=this.padding,$i=$W[3],$A="left",$B=this._lines,$o=this.leading+this._charSize.height,$I=this._currBitmapFont;$I&&($o=this.leading+$I.getMaxHeight());var $b=$W[0];if(!$I&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($A="right",$i=this._width-$W[1]):"center"==this.align&&($A="center",$i=.5*this._width+$W[3]-$W[1])),0<this._height){var $f=this._textHeight>this._height?"top":this.valign;"middle"===$f?$b=.5*(this._height-$t*$o)+$W[0]-$W[2]:"bottom"===$f&&($b=this._height-$t*$o-$W[2]);}var $J=this._style;if($I&&$I.autoScaleSize)var $c=$I.fontSize/this.fontSize;if(this._clipPoint)if($l.save(),$I&&$I.autoScaleSize){var $Y=0,$w=0;$Y=this._width?this._width-$W[3]-$W[1]:this._textWidth,$w=this._height?this._height-$W[0]-$W[2]:this._textHeight,$Y*=$c,$w*=$c,$l.clipRect($W[3],$W[0],$Y,$w);}else $l.clipRect($W[3],$W[0],this._width?this._width-$W[3]-$W[1]:this._textWidth,this._height?this._height-$W[0]-$W[2]:this._textHeight);var $D=$J.password;"prompt"in this&&this.prompt==this._text&&($D=!1);for(var $z=0,$e=0,$g=Math.min(this._lines.length,$t+$d)||1,$H=$d;$H<$g;$H++){var $R,$G=$B[$H];if($D){var $q=$G.length;$G="";for(var $L=$q;0<$L;$L--)$G+="●";}if($z=$i-(this._clipPoint?this._clipPoint.x:0),$e=$b+$o*$H-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($A,$z,$e,$H),$I){var $$=this.width;$I.autoScaleSize&&($$=this.width*$c),$I.drawText($G,this,$z,$e,this.align,$$);}else $K.isWebGL?(this._words||(this._words=[]),($R=this._words.length>$H-$d?this._words[$H-$d]:new $v()).setText($G)):$R=$G,$J.stroke?$l.fillBorderText($R,$z,$e,$k,this.color,$J.strokeColor,$J.stroke,$A):$l.fillText($R,$z,$e,$k,this.color,$A);}if($I&&$I.autoScaleSize){var $p=1/$c;this.scale($p,$p);}this._clipPoint&&$l.restore(),this._startX=$i,this._startY=$b;},$d.drawUnderline=function($d,$t,$l,$k){var $W=this._lineWidths[$k];switch($d){case"center":$t-=$W/2;break;case"right":$t-=$W;}$l+=this._charSize.height,this._graphics.drawLine($t,$l,$t+$W,$l,this.underlineColor||this.color,1);},$d.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$V.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $L(0,0)):this._clipPoint=null;var $d=this._lines.length;if(this.overflow!=$c.VISIBLE){var $t=this.overflow==$c.HIDDEN?Math.floor:Math.ceil;$d=Math.min($d,$t((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)));}var $l=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($l,$d),this.repaint();},$d.evalTextSize=function(){var $d,$t=NaN;$d=Math.max.apply(this,this._lineWidths),$t=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$d==this._textWidth&&$t==this._textHeight||(this._textWidth=$d,this._textHeight=$t,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight));},$d.checkEnabledViewportOrNot=function(){return this.overflow==$c.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height);},$d.changeText=function($d){this._text!==$d&&(this.lang($d+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset());},$d.parseLines=function($d){var $t=this.wordWrap||this.overflow==$c.HIDDEN;if($t)var $l=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $k=$F.contextMeasureText($c._testWord);$K.isConchApp&&0===$k.width&&0===$k.height&&($k=$F.contextMeasureText("W")),this._charSize.width=$k.width,this._charSize.height=$k.height||this.fontSize;}for(var $W=$d.replace(/\r\n/g,"\n").split("\n"),$i=0,$A=$W.length;$i<$A;$i++){var $B=$W[$i];$t?this.parseLine($B,$l):(this._lineWidths.push(this.getTextWidth($B)),this._lines.push($B));}},$d.parseLine=function($d,$t){$V.context;var $l,$k=this._lines,$W=0,$i=NaN,$A=NaN,$B=0;if(($i=this.getTextWidth($d))<=$t)return $k.push($d),void this._lineWidths.push($i);$i=this._charSize.width,0==($W=Math.floor($t/$i))&&($W=1),$A=$i=this.getTextWidth($d.substring(0,$W));for(var $o=$W,$I=$d.length;$o<$I;$o++)if($t<($A+=$i=this.getTextWidth($d.charAt($o))))if(this.wordWrap){var $b=$d.substring($B,$o);if($b.charCodeAt($b.length-1)<255?($l=/(?:\w|-)+$/.exec($b))&&($o=$l.index+$B,0==$l.index?$o+=$b.length:$b=$d.substring($B,$o)):$c.RightToLeft&&($l=/([\u0600-\u06FF])+$/.exec($b))&&($o=$l.index+$B,0==$l.index?$o+=$b.length:$b=$d.substring($B,$o)),$k.push($b),this._lineWidths.push($A-$i),!(($B=$o)+$W<$I)){$k.push($d.substring($B,$I)),this._lineWidths.push(this.getTextWidth($k[$k.length-1])),$B=-1;break;}$o+=$W,$A=$i=this.getTextWidth($d.substring($B,$o)),$o--;}else if(this.overflow==$c.HIDDEN)return $k.push($d.substring(0,$o)),void this._lineWidths.push(this.getTextWidth($k[$k.length-1]));this.wordWrap&&-1!=$B&&($k.push($d.substring($B,$I)),this._lineWidths.push(this.getTextWidth($k[$k.length-1])));},$d.getTextWidth=function($d){return this._currBitmapFont?this._currBitmapFont.getTextWidth($d):$F.contextMeasureText($d).width;},$d.getWordWrapWidth=function(){var $d=this.padding,$t=NaN;return($t=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($t=this.wordWrap?100:$V.width),$t<=0&&($t=100),$t-$d[3]-$d[1];},$d.getCharPoint=function($d,$t){this._isChanged&&$q.timer.runCallLater(this,this.typeset);for(var $l=0,$k=this._lines,$W=0,$i=0,$A=$k.length;$i<$A;$i++){if($d<($l+=$k[$i].length)){var $B=$i;break;}$W=$l;}var $o=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$V.context.font=$o;var $I=this.getTextWidth(this._text.substring($W,$d));return($t||new $L()).setTo(this._startX+$I-(this._clipPoint?this._clipPoint.x:0),this._startY+$B*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0));},$b(0,$d,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3];},function($d){$d!=this._width&&($q.superSet($fd,this,"width",$d),this.isChanged=!0);}),$b(0,$d,"textWidth",function(){return this._isChanged&&$q.timer.runCallLater(this,this.typeset),this._textWidth;}),$b(0,$d,"height",function(){return this._height?this._height:this.textHeight;},function($d){$d!=this._height&&($q.superSet($fd,this,"height",$d),this.isChanged=!0);}),$b(0,$d,"textHeight",function(){return this._isChanged&&$q.timer.runCallLater(this,this.typeset),this._textHeight;}),$b(0,$d,"padding",function(){return this._getCSSStyle().padding;},function($d){this._getCSSStyle().padding=$d,this.isChanged=!0;}),$b(0,$d,"bold",function(){return this._getCSSStyle().bold;},function($d){this._getCSSStyle().bold=$d,this.isChanged=!0;}),$b(0,$d,"text",function(){return this._text||"";},function($d){this._text!==$d&&(this.lang($d+""),this.isChanged=!0,this.event("change"));}),$b(0,$d,"color",function(){return this._getCSSStyle().color;},function($d){this._getCSSStyle().color!=$d&&(this._getCSSStyle().color=$d,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0);}),$b(0,$d,"font",function(){return this._getCSSStyle().fontFamily;},function($d){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$c._bitmapFonts&&$c._bitmapFonts[$d]&&(this._currBitmapFont=$c._bitmapFonts[$d]),this._getCSSStyle().fontFamily=$d,this.isChanged=!0;}),$b(0,$d,"fontSize",function(){return this._getCSSStyle().fontSize;},function($d){this._getCSSStyle().fontSize=$d,this.isChanged=!0;}),$b(0,$d,"italic",function(){return this._getCSSStyle().italic;},function($d){this._getCSSStyle().italic=$d,this.isChanged=!0;}),$b(0,$d,"align",function(){return this._getCSSStyle().align;},function($d){this._getCSSStyle().align=$d,this.isChanged=!0;}),$b(0,$d,"valign",function(){return this._getCSSStyle().valign;},function($d){this._getCSSStyle().valign=$d,this.isChanged=!0;}),$b(0,$d,"wordWrap",function(){return this._getCSSStyle().wordWrap;},function($d){this._getCSSStyle().wordWrap=$d,this.isChanged=!0;}),$b(0,$d,"leading",function(){return this._getCSSStyle().leading;},function($d){this._getCSSStyle().leading=$d,this.isChanged=!0;}),$b(0,$d,"bgColor",function(){return this._getCSSStyle().backgroundColor;},function($d){this._getCSSStyle().backgroundColor=$d,this.isChanged=!0;}),$b(0,$d,"borderColor",function(){return this._getCSSStyle().borderColor;},function($d){this._getCSSStyle().borderColor=$d,this.isChanged=!0;}),$b(0,$d,"stroke",function(){return this._getCSSStyle().stroke;},function($d){this._getCSSStyle().stroke=$d,this.isChanged=!0;}),$b(0,$d,"strokeColor",function(){return this._getCSSStyle().strokeColor;},function($d){this._getCSSStyle().strokeColor=$d,this.isChanged=!0;}),$b(0,$d,"isChanged",null,function($d){this._isChanged!==$d&&(this._isChanged=$d)&&$q.timer.callLater(this,this.typeset);}),$b(0,$d,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0;},function($d){if(!(this.overflow!=$c.SCROLL||this.textWidth<this._width)&&this._clipPoint){$d=$d<this.padding[3]?this.padding[3]:$d;var $t=this._textWidth-this._width;$d=$t<$d?$t:$d;var $l=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$d,this.renderText(this._lastVisibleLineIndex,$l);}}),$b(0,$d,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0;},function($d){if(!(this.overflow!=$c.SCROLL||this.textHeight<this._height)&&this._clipPoint){$d=$d<this.padding[0]?this.padding[0]:$d;var $t=this._textHeight-this._height,$l=($d=$t<$d?$t:$d)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$l;var $k=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$d,this.renderText($l,$k);}}),$b(0,$d,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width;}),$b(0,$d,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height;}),$b(0,$d,"lines",function(){return this._isChanged&&this.typeset(),this._lines;}),$b(0,$d,"underlineColor",function(){return this._underlineColor;},function($d){this._underlineColor=$d,this._isChanged=!0,this.typeset();}),$c.registerBitmapFont=function($d,$t){$c._bitmapFonts||($c._bitmapFonts={}),$c._bitmapFonts[$d]=$t;},$c.unregisterBitmapFont=function($d,$t){if(void 0===$t&&($t=!0),$c._bitmapFonts&&$c._bitmapFonts[$d]){var $l=$c._bitmapFonts[$d];$t&&$l.destroy(),delete $c._bitmapFonts[$d];}},$c.setTextRightToLeft=function(){var $d;($d=$V.canvas.source.style).display="none",$d.position="absolute",$d.direction="rtl",$K._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$V.document.body.appendChild($V.canvas.source);},$c.supportFont=function($d){$V.context.font="10px sans-serif";var $t=$F.contextMeasureText("abcji").width;$V.context.font="10px "+$d;var $l=$F.contextMeasureText("abcji").width;return console.log($t,$l),$t!==$l;},$c._testWord="游",$c.langPacks=null,$c.VISIBLE="visible",$c.SCROLL="scroll",$c.HIDDEN="hidden",$c.CharacterCache=!0,$c.RightToLeft=!1,$c._bitmapFonts=null,$o($c,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"};}]),$c;}($fd),$zd=function($f){function $A(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$A.__super.call(this),this.offset=new $L(),this._canvasTransform=new $S(),this._previousOrientation=$V.window.orientation;var $t=this;this.transform=$S.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $d=$V.window,$l=this;$d.addEventListener("focus",function(){$t._isFocused=!0,$l.event("focus"),$l.event("focuschange");}),$d.addEventListener("blur",function(){$t._isFocused=!1,$l.event("blur"),$l.event("focuschange"),$l._isInputting()&&($Rd.inputElement.target.focus=!1);});var $k="visibilityState",$W="visibilitychange",$i=$d.document;void 0!==$i.hidden?($W="visibilitychange",$k="visibilityState"):void 0!==$i.mozHidden?($W="mozvisibilitychange",$k="mozVisibilityState"):void 0!==$i.msHidden?($W="msvisibilitychange",$k="msVisibilityState"):void 0!==$i.webkitHidden&&($W="webkitvisibilitychange",$k="webkitVisibilityState"),$d.document.addEventListener($W,function(){"hidden"==$V.document[$k]?$l._setStageVisible(!1):$l._setStageVisible(!0);}),$d.document.addEventListener("qbrowserVisibilityChange",function($d){$l._setStageVisible(!$d.hidden);}),$d.addEventListener("resize",function(){var $d=$V.window.orientation;null!=$d&&$d!=$t._previousOrientation&&$l._isInputting()&&($Rd.inputElement.target.focus=!1),$t._previousOrientation=$d,$l._isInputting()||$l._resetCanvas();}),$d.addEventListener("orientationchange",function($d){$l._resetCanvas();}),this.on("mousemove",this,this._onmouseMove),$V.onMobile&&this.on("mousedown",this,this._onmouseMove);}$w($A,"laya.display.Stage",$f);var $d=$A.prototype;return $d._setStageVisible=function($d){this._isVisibility!=$d&&(this._isVisibility=$d,this._isVisibility||this._isInputting()&&($Rd.inputElement.target.focus=!1),this.event("visibilitychange"));},$d._isInputting=function(){return $V.onMobile&&$Rd.isInputting;},$d._changeCanvasSize=function(){this.setScreenSize($V.clientWidth*$V.pixelRatio,$V.clientHeight*$V.pixelRatio);},$d._resetCanvas=function(){if(this.screenAdaptationEnabled){var $d=$K._mainCanvas;$d.source.style;$d.size(1,1),$q.timer.once(100,this,this._changeCanvasSize);}},$d.setScreenSize=function($d,$t){var $l=!1;if("none"!==this._screenMode&&($l=($d/$t<1?"vertical":"horizontal")!==this._screenMode)){var $k=$t;$t=$d,$d=$k;}this.canvasRotation=$l;var $W=$K._mainCanvas,$i=$W.source.style,$A=this._canvasTransform.identity(),$B=this._scaleMode,$o=$d/this.designWidth,$I=$t/this.designHeight,$b=this.designWidth,$f=this.designHeight,$J=$d,$c=$t,$Y=$V.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$B){case"noscale":$o=$I=1,$J=this.designWidth,$c=this.designHeight;break;case"showall":$o=$I=Math.min($o,$I),$b=$J=Math.round(this.designWidth*$o),$f=$c=Math.round(this.designHeight*$I);break;case"noborder":$o=$I=Math.max($o,$I),$J=Math.round(this.designWidth*$o),$c=Math.round(this.designHeight*$I);break;case"full":$o=$I=1,this._width=$b=$d,this._height=$f=$t;break;case"fixedwidth":$I=$o,this._height=$f=Math.round($t/$o);break;case"fixedheight":$o=$I,this._width=$b=Math.round($d/$I);break;case"fixedauto":$d/$t<this.designWidth/this.designHeight?($I=$o,this._height=$f=Math.round($t/$o)):($o=$I,this._width=$b=Math.round($d/$I));}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$b=$b+1&2147483646,$f=$f+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$o*=this.scaleX,$I*=this.scaleY,1===$o&&1===$I?this.transform.identity():(this.transform.a=this._formatData($o/($J/$b)),this.transform.d=this._formatData($I/($c/$f)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$W.size($b,$f),$r.changeWebGLSize($b,$f),$A.scale($J/$b/$Y,$c/$f/$Y),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($d-$J)/$Y:this.offset.x=.5*($d-$J)/$Y,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($t-$c)/$Y:this.offset.y=.5*($t-$c)/$Y,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$A.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$l&&("horizontal"===this._screenMode?($A.rotate(Math.PI/2),$A.translate($t/$Y,0),this.canvasDegree=90):($A.rotate(-Math.PI/2),$A.translate(0,$d/$Y),this.canvasDegree=-90)),$A.a=this._formatData($A.a),$A.d=this._formatData($A.d),$A.tx=this._formatData($A.tx),$A.ty=this._formatData($A.ty),$i.transformOrigin=$i.webkitTransformOrigin=$i.msTransformOrigin=$i.mozTransformOrigin=$i.oTransformOrigin="0px 0px 0px",$i.transform=$i.webkitTransform=$i.msTransform=$i.mozTransform=$i.oTransform="matrix("+$A.toString()+")",$A.translate(parseInt($i.left)||0,parseInt($i.top)||0),this.visible=!0,this._repaint=1,this.event("resize");},$d._formatData=function($d){return Math.abs($d)<1e-6?0:Math.abs(1-$d)<.001?0<$d?1:-1:$d;},$d.getMousePoint=function(){return $L.TEMP.setTo(this.mouseX,this.mouseY);},$d.repaint=function(){this._repaint=1;},$d.parentRepaint=function(){},$d._loop=function(){return this.render($K.context,0,0),!0;},$d._onmouseMove=function($d){this._mouseMoveTime=$V.now();},$d.getTimeFromFrameStart=function(){return $V.now()-this._frameStartTime;},$d.render=function($d,$t,$l){if("sleep"===this._frameRate&&!$K.isConchApp){var $k=$V.now();if(!(1e3<=$k-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($X.loopCount++,$Y.instance.runEvent(),$q.timer._update()));this._frameStartTime=$k;}if(this._renderCount++,$K.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$V.now();var $W="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$i=this._renderCount%2==0;if($X.renderSlow=!$W,$W||$i||$K.isConchApp){var $A;$X.loopCount++,$Y.instance.runEvent(),$q.timer._update(),$r.update3DLoop();var $B=0,$o=0;if($K.isConchNode)for($B=0,$o=this._scenes.length;$B<$o;$B++)($A=this._scenes[$B])&&$A._updateSceneConch();else for($B=0,$o=this._scenes.length;$B<$o;$B++)($A=this._scenes[$B])&&$A._updateScene();if($K.isConchNode){var $I=$fd.CustomList;for($B=0,$o=$I.length;$B<$o;$B++){var $b=$I[$B];$b.customRender($b.customContext,0,0);}return;}}$K.isConchNode||this.renderingEnabled&&($W||!$i||$K.isConchWebGL)&&($K.isWebGL?$K.WebGL.mainContext&&!$K.WebGL.mainContext.isContextLost()&&($d.clear(),$f.prototype.render.call(this,$d,$t,$l),$X._show&&$X._sp&&$X._sp.render($d,$t,$l),$r.clear(this._bgColor),$r.beginFlush(),$d.flush(),$r.endFinish(),$a.instance&&$a.getInstance().endDispose()):($r.clear(this._bgColor),$f.prototype.render.call(this,$d,$t,$l),$X._show&&$X._sp&&$X._sp.render($d,$t,$l)));}else this._renderCount%5==0&&($X.loopCount++,$Y.instance.runEvent(),$q.timer._update());},$d._requestFullscreen=function(){var $d=$V.document.documentElement;$d.requestFullscreen?$d.requestFullscreen():$d.mozRequestFullScreen?$d.mozRequestFullScreen():$d.webkitRequestFullscreen?$d.webkitRequestFullscreen():$d.msRequestFullscreen&&$d.msRequestFullscreen();},$d._fullScreenChanged=function(){$q.stage.event("fullscreenchange");},$d.exitFullscreen=function(){var $d=$V.document;$d.exitFullscreen?$d.exitFullscreen():$d.mozCancelFullScreen?$d.mozCancelFullScreen():$d.webkitExitFullscreen&&$d.webkitExitFullscreen();},$b(0,$d,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1;}),$b(0,$d,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight;}),$b(0,$d,"frameRate",function(){return this._frameRate;},function($d){if(this._frameRate=$d,$K.isConchApp)switch(this._frameRate){case"slow":$V.window.conch&&$V.window.conchConfig.setSlowFrame&&$V.window.conchConfig.setSlowFrame(!0);break;case"fast":$V.window.conch&&$V.window.conchConfig.setSlowFrame&&$V.window.conchConfig.setSlowFrame(!1);break;case"mouse":$V.window.conch&&$V.window.conchConfig.setMouseFrame&&$V.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$V.window.conch&&$V.window.conchConfig.setLimitFPS&&$V.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.");}}),$b(0,$d,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1;}),$b(0,$d,"width",$f.prototype._$get_width,function($d){this.designWidth=$d,$q.superSet($fd,this,"width",$d),$q.timer.callLater(this,this._changeCanvasSize);}),$b(0,$d,"alignH",function(){return this._alignH;},function($d){this._alignH=$d,$q.timer.callLater(this,this._changeCanvasSize);}),$b(0,$d,"isFocused",function(){return this._isFocused;}),$b(0,$d,"height",$f.prototype._$get_height,function($d){this.designHeight=$d,$q.superSet($fd,this,"height",$d),$q.timer.callLater(this,this._changeCanvasSize);}),$b(0,$d,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$S.create();},$f.prototype._$set_transform),$b(0,$d,"isVisibility",function(){return this._isVisibility;}),$b(0,$d,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth;}),$b(0,$d,"scaleMode",function(){return this._scaleMode;},function($d){this._scaleMode=$d,$q.timer.callLater(this,this._changeCanvasSize);}),$b(0,$d,"alignV",function(){return this._alignV;},function($d){this._alignV=$d,$q.timer.callLater(this,this._changeCanvasSize);}),$b(0,$d,"bgColor",function(){return this._bgColor;},function($d){this._bgColor=$d,this.conchModel&&this.conchModel.bgColor($d),$K.isWebGL&&($d?$A._wgColor=$N.create($d)._color:$V.onMiniGame||($A._wgColor=null)),$V.onLimixiu?$A._wgColor=$N.create($d)._color:$K.canvas.style.background=$d||"none";}),$b(0,$d,"mouseX",function(){return Math.round($Y.instance.mouseX/this.clientScaleX);}),$b(0,$d,"mouseY",function(){return Math.round($Y.instance.mouseY/this.clientScaleY);}),$b(0,$d,"screenMode",function(){return this._screenMode;},function($d){this._screenMode=$d;}),$b(0,$d,"visible",$f.prototype._$get_visible,function($d){this.visible!==$d&&($q.superSet($fd,this,"visible",$d),$K._mainCanvas.source.style.visibility=$d?"visible":"hidden");}),$b(0,$d,"fullScreenEnabled",null,function($d){var $t=$V.document,$l=$K.canvas;$d?($l.addEventListener("mousedown",this._requestFullscreen),$l.addEventListener("touchstart",this._requestFullscreen),$t.addEventListener("fullscreenchange",this._fullScreenChanged),$t.addEventListener("mozfullscreenchange",this._fullScreenChanged),$t.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$t.addEventListener("msfullscreenchange",this._fullScreenChanged)):($l.removeEventListener("mousedown",this._requestFullscreen),$l.removeEventListener("touchstart",this._requestFullscreen),$t.removeEventListener("fullscreenchange",this._fullScreenChanged),$t.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$t.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$t.removeEventListener("msfullscreenchange",this._fullScreenChanged));}),$A.SCALE_NOSCALE="noscale",$A.SCALE_EXACTFIT="exactfit",$A.SCALE_SHOWALL="showall",$A.SCALE_NOBORDER="noborder",$A.SCALE_FULL="full",$A.SCALE_FIXED_WIDTH="fixedwidth",$A.SCALE_FIXED_HEIGHT="fixedheight",$A.SCALE_FIXED_AUTO="fixedauto",$A.ALIGN_LEFT="left",$A.ALIGN_RIGHT="right",$A.ALIGN_CENTER="center",$A.ALIGN_TOP="top",$A.ALIGN_MIDDLE="middle",$A.ALIGN_BOTTOM="bottom",$A.SCREEN_NONE="none",$A.SCREEN_HORIZONTAL="horizontal",$A.SCREEN_VERTICAL="vertical",$A.FRAME_FAST="fast",$A.FRAME_SLOW="slow",$A.FRAME_MOUSE="mouse",$A.FRAME_SLEEP="sleep",$A.FRAME_MOUSE_THREDHOLD=2e3,$o($A,["_wgColor",function(){return this._wgColor=[0,0,0,1];}]),$A;}($fd),$ed=(function($d){function $t(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$t.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange);}$w($t,"laya.media.SoundNode",$fd);var $l=$t.prototype;$l._onParentChange=function(){this.target=this.parent;},$l.play=function($d,$t){void 0===$d&&($d=1),isNaN($d)&&($d=1),this.url&&(this.stop(),this._channel=$T.playSound(this.url,$d,null,$t));},$l.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null;},$l._setPlayAction=function($d,$t,$l,$k){void 0===$k&&($k=!0),this[$l]&&$d&&($k?$d.on($t,this,this[$l]):$d.off($t,this,this[$l]));},$l._setPlayActions=function($d,$t,$l,$k){if(void 0===$k&&($k=!0),$d&&$t){var $W,$i=$t.split(","),$A=0;for($W=$i.length,$A=0;$A<$W;$A++)this._setPlayAction($d,$i[$A],$l,$k);}},$b(0,$l,"playEvent",null,function($d){(this._playEvents=$d)&&this._tar&&this._setPlayActions(this._tar,$d,"play");}),$b(0,$l,"target",null,function($d){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$d,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0));}),$b(0,$l,"stopEvent",null,function($d){(this._stopEvents=$d)&&this._tar&&this._setPlayActions(this._tar,$d,"stop");});}(),function($d){function $t(){this._src=null,this._onload=null,this._onerror=null,$t.__super.call(this);}$w($t,"laya.resource.FileBitmap",$Yd);var $l=$t.prototype;return $b(0,$l,"src",function(){return this._src;},function($d){this._src=$d;}),$b(0,$l,"onload",null,function($d){}),$b(0,$l,"onerror",null,function($d){}),$t;}()),$gd=function($d){function $l($d,$t){this._is2D=!1,$l.__super.call(this);var $k=this;if(this._source=this,"2D"===$d||"AUTO"===$d&&!$K.isWebGL){this._is2D=!0,this._source=$t||$V.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $W=this;$W.getContext=function($d,$t){if($k._ctx)return $k._ctx;var $l=$k._ctx=$k._source.getContext($d,$t);return $l&&($l._canvas=$W,$K.isFlash||$V.onLimixiu||($l.size=function($d,$t){})),$l;};}this.uri="HTMLCanvas_"+this.id,this.lock=!0;}$w($l,"laya.resource.HTMLCanvas",$Yd);var $t=$l.prototype;return $t.clear=function(){this._ctx&&this._ctx.clear();},$t.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$t.release=function(){},$t._setContext=function($d){this._ctx=$d;},$t.getContext=function($d,$t){return this._ctx?this._ctx:this._ctx=$l._createContext(this);},$t.getMemSize=function(){return 0;},$t.size=function($d,$t){(this._w!=$d||this._h!=$t||this._source&&(this._source.width!=$d||this._source.height!=$t))&&(this._w=$d,this._h=$t,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($d,$t),this._source&&(this._source.height=$t,this._source.width=$d));},$t.getCanvas=function(){return this._source;},$t.toBase64=function($d,$t,$l){if(this._source)if($K.isConchApp&&this._source.toBase64)this._source.toBase64($d,$t,$l);else{var $k=this._source.toDataURL($d,$t);$l.call(this,$k);}},$b(0,$t,"context",function(){return this._ctx;}),$b(0,$t,"asBitmap",null,function($d){}),$l.create=function($d,$t){return new $l($d,$t);},$l.TYPE2D="2D",$l.TYPE3D="3D",$l.TYPEAUTO="AUTO",$l._createContext=null,$l;}(),$Hd=(function($d){function $o($d,$t,$l,$k,$W,$i,$A,$B){throw $o.__super.call(this),new Error("不允许new！");}$w($o,"laya.resource.HTMLSubImage",$Yd),$o.create=function($d,$t,$l,$k,$W,$i,$A,$B){return void 0===$B&&($B=!1),new $o($d,$t,$l,$k,$W,$i,$A,$B);};}(),function($d){function $f(){this._frames=null,this._url=null,$f.__super.call(this),this._setControlNode(this);}$w($f,"laya.display.Animation",$d);var $t=$f.prototype;$t.destroy=function($d){void 0===$d&&($d=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$d),this._frames=null,this._labels=null;},$t.play=function($d,$t,$l,$k){void 0===$d&&($d=0),void 0===$t&&($t=!0),void 0===$l&&($l=""),void 0===$k&&($k=!0),$l&&this._setFramesFromCache($l,$k),this._isPlaying=!0,this.index="string"==typeof $d?this._getFrameByLabel($d):$d,this.loop=$t,this._actionName=$l,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$t._setFramesFromCache=function($d,$t){var $l;return void 0===$t&&($t=!1),this._url&&($d=this._url+"#"+$d),$d&&$f.framesMap[$d]?(($l=$f.framesMap[$d])instanceof Array?(this._frames=$f.framesMap[$d],this._count=this._frames.length):($l.nodeRoot&&($f.framesMap[$d]=this._parseGraphicAnimationByData($l),$l=$f.framesMap[$d]),this._frames=$l.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$l.interval),this._labels=this._copyLabels($l.labels)),!0):($t&&console.log("ani not found:",$d),!1);},$t._copyLabels=function($d){if(!$d)return null;var $t,$l;for($l in $t={},$d)$t[$l]=$F.copyArray([],$d[$l]);return $t;},$t._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$d.prototype._frameLoop.call(this);},$t._displayToIndex=function($d){this._frames&&(this.graphics=this._frames[$d]);},$t.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null;},$t.loadImages=function($d,$t){return void 0===$t&&($t=""),this._url="",this._setFramesFromCache($t)||(this.frames=$f.framesMap[$t]?$f.framesMap[$t]:$f.createFrames($d,$t)),this;},$t.loadAtlas=function($t,$l,$k){void 0===$k&&($k=""),this._url="";var $W=this;function $d($d){$t===$d&&($W.frames=$f.framesMap[$k]?$f.framesMap[$k]:$f.createFrames($t,$k),$l&&$l.run());}return $W._setFramesFromCache($k)||($Bd.getAtlas($t)?$d($t):$q.loader.load($t,$e.create(null,$d,[$t]),null,"atlas")),this;},$t.loadAnimation=function($d,$t,$l){this._url=$d;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$t&&$t.run()):!$l||$Bd.getAtlas($l)?this._loadAnimationData($d,$t,$l):$q.loader.load($l,$e.create(this,this._loadAnimationData,[$d,$t,$l]),null,"atlas"),this;},$t._loadAnimationData=function($B,$o,$d){var $I=this;if(!$d||$Bd.getAtlas($d)){var $b=this;$Bd.getRes($B)?$t($B):$q.loader.load($B,$e.create(null,$t,[$B]),null,"json"),$Bd.clearRes($B);}else console.warn("atlas load fail:"+$d);function $t($d){if($Bd.getRes($d)&&$B===$d){var $t;if($f.framesMap[$B+"#"])$b._setFramesFromCache($I._actionName,!0),$I.index=0,$I._checkResumePlaying();else{var $l=$b._parseGraphicAnimation($Bd.getRes($B));if(!$l)return;var $k,$W=$l.animationList,$i=0,$A=$W.length;for($i=0;$i<$A;$i++)$t=$W[$i],$f.framesMap[$B+"#"+$t.name]=$t,$k||($k=$t);$k&&($f.framesMap[$B+"#"]=$k,$b._setFramesFromCache($I._actionName,!0),$I.index=0),$I._checkResumePlaying();}$o&&$o.run();}}},$t._parseGraphicAnimation=function($d){return $qd.parseAnimationData($d);},$t._parseGraphicAnimationByData=function($d){return $qd.parseAnimationByData($d);},$b(0,$t,"frames",function(){return this._frames;},function($d){(this._frames=$d)&&(this._count=$d.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index);}),$b(0,$t,"autoPlay",null,function($d){$d?this.play():this.stop();}),$b(0,$t,"source",null,function($d){-1<$d.indexOf(".ani")?this.loadAnimation($d):-1<$d.indexOf(".json")||-1<$d.indexOf("als")||-1<$d.indexOf("atlas")?this.loadAtlas($d):this.loadImages($d.split(","));}),$b(0,$t,"autoAnimation",null,function($d){this.play(0,!0,$d,!1);}),$f.createFrames=function($d,$t){var $l,$k,$W=0,$i=0;if("string"==typeof $d){var $A=$Bd.getAtlas($d);if($A&&$A.length)for($l=[],$W=0,$i=$A.length;$W<$i;$W++)($k=new $r.createGraphics()).drawTexture($Bd.getRes($A[$W]),0,0),$l.push($k);}else if($d instanceof Array)for($l=[],$W=0,$i=$d.length;$W<$i;$W++)($k=new $r.createGraphics()).loadImage($d[$W],0,0),$l.push($k);return $t&&($f.framesMap[$t]=$l),$l;},$f.clearCache=function($d){var $t,$l=$f.framesMap,$k=$d+"#";for($t in $l)$t!==$d&&0!=$t.indexOf($k)||delete $f.framesMap[$t];},$f.framesMap={};}($wd),function($d){function $i(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$i.__super.call(this),null==$i._sortIndexFun&&($i._sortIndexFun=$G.sortByKey("index",!1,!0));}$w($i,"laya.display.FrameAnimation",$d);var $t=$i.prototype;return $t._setUp=function($d,$t){this._labels=null,this._animationNewFrames=null,this._targetDic=$d,this._animationData=$t,this.interval=1e3/$t.frameRate,$t.parsed?(this._count=$t.count,this._labels=$t.labels,this._animationNewFrames=$t.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$t.parsed=!0,$t.labels=this._labels,$t.count=this._count,$t.animationNewFrames=this._animationNewFrames;},$t.clear=function(){$d.prototype.clear.call(this),this._targetDic=null,this._animationData=null;},$t._displayToIndex=function($d){if(this._animationData){$d<0&&($d=0),$d>this._count&&($d=this._count);var $t=this._animationData.nodes,$l=0,$k=$t.length;for($l=0;$l<$k;$l++)this._displayNodeToFrame($t[$l],$d);}},$t._displayNodeToFrame=function($d,$t,$l){$l||($l=this._targetDic);var $k=$l[$d.target];if($k){var $W,$i,$A,$B=$d.frames,$o=$d.keys,$I=0,$b=$o.length;for($I=0;$I<$b;$I++)$A=($i=$B[$W=$o[$I]]).length>$t?$i[$t]:$i[$i.length-1],$k[$W]=$A;}},$t._calculateDatas=function(){if(this._animationData){var $d,$t=this._animationData.nodes,$l=0,$k=$t.length;for($l=this._count=0;$l<$k;$l++)$d=$t[$l],this._calculateNodeKeyFrames($d);this._count+=1;}},$t._calculateNodeKeyFrames=function($d){var $t,$l,$k=$d.keyframes,$W=$d.target;for($t in $d.frames||($d.frames={}),$d.keys?$d.keys.length=0:$d.keys=[],$d.initValues||($d.initValues={}),$k)$l=$k[$t],$d.frames[$t]||($d.frames[$t]=[]),this._targetDic&&this._targetDic[$W]&&($d.initValues[$t]=this._targetDic[$W][$t]),$l.sort($i._sortIndexFun),$d.keys.push($t),this._calculateNodePropFrames($l,$d.frames[$t],$t,$W);},$t.resetToInitState=function(){if(this._targetDic&&this._animationData){var $d,$t,$l=this._animationData.nodes,$k=0,$W=$l.length;for($k=0;$k<$W;$k++)if($t=($d=$l[$k]).initValues){var $i,$A=this._targetDic[$d.target];if($A)for($i in $t)$A[$i]=$t[$i];}}},$t._calculateNodePropFrames=function($d,$t,$l,$k){var $W=0,$i=$d.length-1;if(0<$i){for($t.length=$d[$i].index+1,$W=0;$W<$i;$W++)this._dealKeyFrame($d[$W]),this._calculateFrameValues($d[$W],$d[$W+1],$t);this._dealKeyFrame($d[$W]);}0==$i&&($t[$d[0].index]=$d[0].value,this._animationNewFrames&&(this._animationNewFrames[$d[0].index]=!0));},$t._dealKeyFrame=function($d){$d.label&&""!=$d.label&&this.addLabel($d.label,$d.index);},$t._calculateFrameValues=function($d,$t,$l){var $k,$W=0,$i=$d.index,$A=$t.index,$B=$d.value,$o=$t.value-$d.value,$I=$A-$i;if($A>this._count&&(this._count=$A),$d.tween)for(null==($k=$h[$d.tweenMethod])&&($k=$h.linearNone),$W=$i;$W<$A;$W++)$l[$W]=$k($W-$i,$B,$o,$I),this._animationNewFrames&&(this._animationNewFrames[$W]=!0);else for($W=$i;$W<$A;$W++)$l[$W]=$B;this._animationNewFrames&&(this._animationNewFrames[$d.index]=!0,this._animationNewFrames[$t.index]=!0),$l[$t.index]=$t.value;},$i._sortIndexFun=null,$i;}($wd)),$Rd=function($t){function $W(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$W.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$Dd.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay);}$w($W,"laya.display.Input",$t);var $d=$W.prototype;return $d.setSelection=function($d,$t){this.focus=!0,laya.display.Input.inputElement.selectionStart=$d,laya.display.Input.inputElement.selectionEnd=$t;},$d._onUnDisplay=function($d){this.focus=!1;},$d._onMouseDown=function($d){this.focus=!0;},$d._syncInputTransform=function(){var $d=this.nativeInput,$t=$F.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$l=this._width-this.padding[1]-this.padding[3],$k=this._height-this.padding[0]-this.padding[2];$K.isConchApp?($d.setScale($t.scaleX,$t.scaleY),$d.setSize($l,$k),$d.setPos($t.x,$t.y)):($W.iframeInput&&$W._showIOSInput(),$W.inputContainer.style.transform=$W.inputContainer.style.webkitTransform="scale("+$t.scaleX+","+$t.scaleY+") rotate("+$q.stage.canvasDegree+"deg)",$d.style.width=$l+"px",$d.style.height=$k+"px",$W.inputContainer.style.left=$t.x+"px",$W.inputContainer.style.top=$t.y+"px");},$d.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select();},$d._setInputMethod=function(){$W.input.parentElement&&$W.inputContainer.removeChild($W.input),$W.area.parentElement&&$W.inputContainer.removeChild($W.area),$W.inputElement=this.nativeInput,$W.inputContainer.appendChild($W.inputElement),$Dd.RightToLeft&&($W.inputElement.style.direction="rtl");},$d._focusIn=function(){laya.display.Input.isInputting=!0;var $d=this.nativeInput;this._focus=!0;var $t=$d.style;$t.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$d.readOnly=!this._editable,$K.isConchApp&&($d.setType(this._type),$d.setForbidEdit(!this._editable)),$d.maxLength=this._maxChars;this.padding;if($d.type=this._type,$d.value=this._content,$d.placeholder=this._prompt,$q.stage.off("keydown",this,this._onKeyDown),$q.stage.on("keydown",this,this._onKeyDown),($q.stage.focus=this).event("focus"),$V.onPC&&$d.focus(),!$V.onMiniGame){this._text;this._text=null;}this.typeset(),$d.setColor(this._originColor),$d.setFontSize(this.fontSize),$d.setFontFace($V.onIPhone&&$Dd._fontFamilyMap[this.font]||this.font),$K.isConchApp&&$d.setMultiAble&&$d.setMultiAble(this._multiline),$t.lineHeight=this.leading+this.fontSize+"px",$t.fontStyle=this.italic?"italic":"normal",$t.fontWeight=this.bold?"bold":"normal",$t.textAlign=this.align,$t.padding="0 0",this._syncInputTransform(),!$K.isConchApp&&$V.onPC&&$q.timer.frameLoop(1,this,this._syncInputTransform);},$d._setPromptColor=function(){($W.promptStyleDOM=$V.getElementById("promptStyle"))||(($W.promptStyleDOM=$V.createElement("style")).setAttribute("id","promptStyle"),$V.document.head.appendChild($W.promptStyleDOM)),$W.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}";},$d._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($q.superSet($Dd,this,"text",this._content),$q.superSet($Dd,this,"color",this._originColor)):($q.superSet($Dd,this,"text",this._prompt),$q.superSet($Dd,this,"color",this._promptColor)),$q.stage.off("keydown",this,this._onKeyDown),$q.stage.focus=null,this.event("blur"),$K.isConchApp&&this.nativeInput.blur(),$V.onPC&&$q.timer.clear(this,this._syncInputTransform);},$d._onKeyDown=function($d){13===$d.keyCode&&($V.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"));},$d.changeText=function($d){this._content=$d,this._focus?(this.nativeInput.value=$d||"",this.event("change")):$t.prototype.changeText.call(this,$d);},$b(0,$d,"color",$t.prototype._$get_color,function($d){this._focus&&this.nativeInput.setColor($d),$q.superSet($Dd,this,"color",this._content?$d:this._promptColor),this._originColor=$d;}),$b(0,$d,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0;},function($d){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");}),$b(0,$d,"multiline",function(){return this._multiline;},function($d){this._multiline=$d,this.valign=$d?"top":"middle";}),$b(0,$d,"maxChars",function(){return this._maxChars;},function($d){$d<=0&&($d=1e5),this._maxChars=$d;}),$b(0,$d,"text",function(){return this._focus?this.nativeInput.value:this._content||"";},function($d){$q.superSet($Dd,this,"color",this._originColor),$d+="",this._focus?(this.nativeInput.value=$d||"",this.event("change")):(this._multiline||($d=$d.replace(/\r?\n/g,"")),(this._content=$d)?$q.superSet($Dd,this,"text",$d):($q.superSet($Dd,this,"text",this._prompt),$q.superSet($Dd,this,"color",this.promptColor)));}),$b(0,$d,"nativeInput",function(){return $W.iframeInput?$W.iframeInput:this._multiline?$W.area:$W.input;}),$b(0,$d,"prompt",function(){return this._prompt;},function($d){!this._text&&$d&&$q.superSet($Dd,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$q.superSet($Dd,this,"text",this._text==this._prompt?$d:this._text):$q.superSet($Dd,this,"text",$d),this._prompt=$Dd.langPacks&&$Dd.langPacks[$d]?$Dd.langPacks[$d]:$d;}),$b(0,$d,"focus",function(){return this._focus;},function($d){var $t=this.nativeInput;this._focus!==$d&&($d?($t.target?$t.target._focusOut():this._setInputMethod(),($t.target=this)._focusIn()):($t.target=null,this._focusOut(),$V.document.body.scrollTop=0,$t.blur(),$K.isConchApp?$t.setPos(-1e4,-1e4):$W.inputContainer.contains($t)&&$W.inputContainer.removeChild($t)));}),$b(0,$d,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:"";},function($d){$d?(-1<($d="[^"+$d+"]").indexOf("^^")&&($d=$d.replace("^^","")),this._restrictPattern=new RegExp($d,"g")):this._restrictPattern=null;}),$b(0,$d,"editable",function(){return this._editable;},function($d){this._editable=$d,$K.isConchApp&&$W.input.setForbidEdit(!$d);}),$b(0,$d,"promptColor",function(){return this._promptColor;},function($d){this._promptColor=$d,this._content||$q.superSet($Dd,this,"color",$d);}),$b(0,$d,"type",function(){return this._type;},function($d){this._getCSSStyle().password="password"==$d,this._type=$d,$K.isConchApp&&this.nativeInput.setType($d);}),$b(0,$d,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0;},function($d){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");}),$b(0,$d,"asPassword",function(){return this._getCSSStyle().password;},function($d){this._getCSSStyle().password=$d,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0;}),$W.__init__=function(){$W._createInputElement(),$V.onMobile&&$K.canvas.addEventListener($W.IOS_IFRAME?$V.onMiniGame?"touchend":"click":"touchend",$W._popupInputMethod);},$W._popupInputMethod=function($d){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus();},$W._createInputElement=function(){$W._initInput($W.area=$V.createElement("textarea")),$W._initInput($W.input=$V.createElement("input")),$W._createIOSInputElement(),($W.inputContainer=$V.createElement("div")).style.position="absolute",$W.inputContainer.style.zIndex=1e5,$V.container.appendChild($W.inputContainer),$W.inputContainer.setPos=function($d,$t){$W.inputContainer.style.left=$d+"px",$W.inputContainer.style.top=$t+"px";};},$W._createIOSInputElement=function(){if($W.IS_IOS){if($V.getElementById("inputIframe"))return;var $t=$V.createElement("iframe");$t.id="inputIframe",$t.onload=function(){$t.style="position: none; width: 0%; height: 0%;";var $d=$t.contentDocument.getElementsByTagName("input");$d=$d?$d[0]:null,($W.iframeInput=$d)&&$W._initInput($d);},$V.container.appendChild($t),$t.src="./input.html";}},$W._reLoadIOSInputElement=function(){var $d=$V.getElementById("inputIframe");$d&&($W.iframeInput.target&&($W.iframeInput.target.focus=!1),$W.iframeInput.onblur=null,$W.iframeInput.onload=null,$d.src="./input.html");},$W._showIOSInput=function(){$V.getElementById("inputIframe")&&($W.iframeInput.value=$W.iframeInput.target.text,$W.iframeInput.onblur=function(){$W._reLoadIOSInputElement();});},$W._initInput=function($t){var $d=$t.style;$d.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$d.resize="none",$d.backgroundColor="transparent",$d.border="none",$d.outline="none",$d.zIndex=1,$t.addEventListener("input",$W._processInputting),$t.addEventListener("mousemove",$W._stopEvent),$t.addEventListener("mousedown",$W._stopEvent),$t.addEventListener("touchmove",$W._stopEvent),$t.setFontFace=function($d){$t.style.fontFamily=$d;},$K.isConchApp||($t.setColor=function($d){$t.style.color=$d;},$t.setFontSize=function($d){$t.style.fontSize=$d+"px";});},$W._processInputting=function($d){var $t=laya.display.Input.inputElement.target;if($t){var $l=laya.display.Input.inputElement.value;$t._restrictPattern&&($l=$l.replace(/\u2006|\x27/g,""),$t._restrictPattern.test($l)&&($l=$l.replace($t._restrictPattern,""),laya.display.Input.inputElement.value=$l)),$t._text=$l,$t.event("input");}},$W._stopEvent=function($d){"touchmove"==$d.type&&$d.preventDefault(),$d.stopPropagation&&$d.stopPropagation();},$W.TYPE_TEXT="text",$W.TYPE_PASSWORD="password",$W.TYPE_EMAIL="email",$W.TYPE_URL="url",$W.TYPE_NUMBER="number",$W.TYPE_RANGE="range",$W.TYPE_DATE="date",$W.TYPE_MONTH="month",$W.TYPE_WEEK="week",$W.TYPE_TIME="time",$W.TYPE_DATE_TIME="datetime",$W.TYPE_DATE_TIME_LOCAL="datetime-local",$W.TYPE_SEARCH="search",$W.input=null,$W.area=null,$W.inputElement=null,$W.inputContainer=null,$W.confirmButton=null,$W.promptStyleDOM=null,$W.inputHeight=45,$W.isInputting=!1,$W.stageMatrix=null,$o($W,["IOS_IFRAME",function(){return this.IOS_IFRAME=$V.onIOS&&$V.window.top!=$V.window.self;}]),$o($W,["IS_IOS",function(){return this.IS_IOS=!1;}]),$W;}($Dd),$Gd=function($d){function $l($d,$t){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$l.__super.call(this),$d&&this._init_($d,$t);}$w($l,"laya.resource.HTMLImage",$ed);var $t=$l.prototype;return $t._init_=function($d,$t){this._src=$d,this._source=new $V.window.Image(),$t&&($t.onload&&(this.onload=$t.onload),$t.onerror&&(this.onerror=$t.onerror),$t.onCreate&&$t.onCreate(this)),0!=$d.indexOf("data:image")&&(this._source.crossOrigin=""),$d&&(this._source.src=$d);},$t.recreateResource=function(){var $d=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate();}else{this._recreateLock=!0;var $t=this;this._source=new $V.window.Image(),this._source.crossOrigin="",this._source.onload=function(){if($t._needReleaseAgain)return $t._needReleaseAgain=!1,$t._source.onload=null,void($t._source=null);$t._source.onload=null,$t.memorySize=$d._w*$d._h*4,$t._recreateLock=!1,$t.completeCreate();},this._source.src=this._src;}},$t.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0);},$t.onresize=function(){this._w=this._source.width,this._h=this._source.height;},$b(0,$t,"onload",null,function($d){var $t=this;this._onload=$d,this._source&&(this._source.onload=null!=this._onload?function(){$t.onresize(),$t._onload();}:null);}),$b(0,$t,"onerror",null,function($d){var $t=this;this._onerror=$d,this._source&&(this._source.onerror=null!=this._onerror?function(){$t._onerror();}:null);}),$b(0,$t,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($d){this._enableMerageInAtlas=$d,$K.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$d);}),$l.create=function($d,$t){return new $l($d,$t);},$l;}(),$qd=(function($i){function $d(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$d.__super.call(this);}$w($d,"laya.display.EffectAnimation",$i);var $t=$d.prototype;$t._onOtherBegin=function($d){$d!=this&&this.stop();},$t.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction));},$t._onPlayAction=function(){this.play(0,!1);},$t.play=function($d,$t,$l,$k){void 0===$d&&($d=0),void 0===$t&&($t=!0),void 0===$l&&($l=""),void 0===$k&&($k=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$d,$t,$l,$k));},$t._recordInitData=function(){if(this._aniKeys){var $d,$t,$l=0;for($d=this._aniKeys.length,$l=0;$l<$d;$l++)$t=this._aniKeys[$l],this._initData[$t]=this._target[$t];}},$t._displayToIndex=function($d){if(this._animationData){$d<0&&($d=0),$d>this._count&&($d=this._count);var $t=this._animationData.nodes,$l=0,$k=$t.length;for($k=1<$k?1:$k,$l=0;$l<$k;$l++)this._displayNodeToFrame($t[$l],$d);}},$t._displayNodeToFrame=function($d,$t,$l){if(this._target){var $k;$k=this._target;var $W,$i,$A,$B,$o=$d.frames,$I=$d.keys,$b=0,$f=$I.length;$B=$d.secondFrames;var $J,$c,$Y,$w,$D=0;for($b=0;$b<$f;$b++)$i=$o[$W=$I[$b]],$A=-1==($D=$B[$W])?this._initData[$W]:$t<$D?($Y=($c=$d.keyframes[$W])[0]).tween?(null==($J=$h[$Y.tweenMethod])&&($J=$h.linearNone),$w=$c[1],$J($t,this._initData[$W],$w.value-this._initData[$W],$w.index)):this._initData[$W]:$i.length>$t?$i[$t]:$i[$i.length-1],$k[$W]=$A;}},$t._calculateNodeKeyFrames=function($d){$i.prototype._calculateNodeKeyFrames.call(this,$d);var $t,$l,$k,$W=$d.keyframes;$d.target;for($t in $k={},$d.secondFrames=$k,$W)($l=$W[$t]).length<=1?$k[$t]=-1:$k[$t]=$l[1].index;},$b(0,$t,"target",function(){return this._target;},function($d){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$d,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent();}),$b(0,$t,"playEvent",null,function($d){(this._playEvents=$d)&&this.addEvent();}),$b(0,$t,"effectData",null,function($d){var $t;$d&&($t=$d.animations)&&$t[0]&&(this._setUp({},$t[0]),$t[0].nodes&&$t[0].nodes[0]&&(this._aniKeys=$t[0].nodes[0].keys));}),$b(0,$t,"effectClass",null,function($d){var $t,$l;(this._effectClass=$E.getClass($d),this._effectClass)&&($t=this._effectClass.uiView)&&($l=$t.animations)&&$l[0]&&(this._setUp({},$l[0]),$l[0].nodes&&$l[0].nodes[0]&&(this._aniKeys=$l[0].nodes[0].keys));}),$d.EffectAnimationBegin="effectanimationbegin";}($Hd),function($t){var $M;function $T(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$T.__super.call(this);}$w($T,"laya.utils.GraphicAnimation",$t);var $d=$T.prototype;return $d._parseNodeList=function($d){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$d.compId]=$d.props,$d.compId&&this._nodeList.push($d.compId);var $t=$d.child;if($t){var $l=0,$k=$t.length;for($l=0;$l<$k;$l++)this._parseNodeList($t[$l]);}},$d._calGraphicData=function($d){var $t;if(this._setUp(null,$d),this._createGraphicData(),this._nodeIDAniDic)for($t in this._nodeIDAniDic)this._nodeIDAniDic[$t]=null;},$d._createGraphicData=function(){var $d,$t=[],$l=0,$k=this.count,$W=this._animationNewFrames;for($W||($W=[]),$l=0;$l<$k;$l++)!$W[$l]&&$d||($d=this._createFrameGraphic($l)),$t.push($d);this._gList=$t;},$d._createFrameGraphic=function($d){var $t=$r.createGraphics();return $T._rootMatrix||($T._rootMatrix=new $S()),this._updateNodeGraphic(this._rootNode,$d,$T._rootMatrix,$t),$t;},$d._updateNodeGraphic=function($d,$t,$l,$k,$W){var $i;void 0===$W&&($W=1);var $A,$B,$o,$I=($i=this._nodeGDic[$d.compId]=this._getNodeGraphicData($d.compId,$t,this._nodeGDic[$d.compId])).alpha*$W;if(!($I<.01)&&($i.resultTransform||($i.resultTransform=$S.create()),$A=$i.resultTransform,$S.mul($i.transform,$l,$A),$i.skin&&($B=this._getTextureByUrl($i.skin))&&($A._checkTransform()?($k.drawTexture($B,0,0,$i.width,$i.height,$A,$I),$i.resultTransform=null):$k.drawTexture($B,$A.tx,$A.ty,$i.width,$i.height,null,$I)),$o=$d.child)){var $b,$f=0;for($b=$o.length,$f=0;$f<$b;$f++)this._updateNodeGraphic($o[$f],$t,$A,$k,$I);}},$d._updateNoChilds=function($d,$t){if($d.skin){var $l=this._getTextureByUrl($d.skin);if($l){var $k=$d.transform;$k._checkTransform();!$k.bTransform?$t.drawTexture($l,$k.tx,$k.ty,$d.width,$d.height,null,$d.alpha):$t.drawTexture($l,0,0,$d.width,$d.height,$k.clone(),$d.alpha);}}},$d._updateNodeGraphic2=function($d,$t,$l){var $k;if($k=this._nodeGDic[$d.compId]=this._getNodeGraphicData($d.compId,$t,this._nodeGDic[$d.compId]),$d.child){var $W=$k.transform;$W._checkTransform();var $i,$A;$A=($i=!$W.bTransform)&&(0!=$W.tx||0!=$W.ty);var $B,$o,$I;if(($B=$W.bTransform||1!=$k.alpha)&&$l.save(),1!=$k.alpha&&$l.alpha($k.alpha),$i?$A&&$l.translate($W.tx,$W.ty):$l.transform($W.clone()),$o=$d.child,$k.skin&&($I=this._getTextureByUrl($k.skin))&&$l.drawTexture($I,0,0,$k.width,$k.height),$o){var $b,$f=0;for($b=$o.length,$f=0;$f<$b;$f++)this._updateNodeGraphic2($o[$f],$t,$l);}$B?$l.restore():$i?$A&&$l.translate(-$W.tx,-$W.ty):$l.transform($W.clone().invert());}else this._updateNoChilds($k,$l);},$d._calculateNodeKeyFrames=function($d){$t.prototype._calculateNodeKeyFrames.call(this,$d),this._nodeIDAniDic[$d.target]=$d;},$d.getNodeDataByID=function($d){return this._nodeIDAniDic[$d];},$d._getParams=function($d,$t,$l,$k){var $W=$T._temParam;$W.length=$t.length;var $i=0,$A=$t.length;for($i=0;$i<$A;$i++)$W[$i]=this._getObjVar($d,$t[$i][0],$l,$t[$i][1],$k);return $W;},$d._getObjVar=function($d,$t,$l,$k,$W){if($d.hasOwnProperty($t)){var $i=$d[$t];if($l>=$i.length&&($l=$i.length-1),null!=$d[$t][$l])return $d[$t][$l];}return $W.hasOwnProperty($t)?$W[$t]:$k;},$d._getNodeGraphicData=function($d,$t,$l){$l||($l=$M.create()),$l.transform?$l.transform.identity():$l.transform=$S.create();var $k=this.getNodeDataByID($d);if(!$k)return $l;var $W,$i,$A=$k.frames,$B=this._getParams($A,$T._drawTextureCmd,$t,this._nodeDefaultProps[$d]),$o=$B[0],$I=NaN,$b=NaN,$f=$B[5],$J=$B[6],$c=$B[13],$Y=$B[14],$w=$B[7],$D=$B[8],$z=$B[9],$e=$B[11],$g=$B[12];$I=$B[3],$b=$B[4],0!=$I&&0!=$b||($o=null),-1==$I&&($I=0),-1==$b&&($b=0),$l.skin=$o,$l.width=$I,$l.height=$b,$o&&(($W=this._getTextureByUrl($o))?($I||($I=$W.sourceWidth),$b||($b=$W.sourceHeight)):console.warn("lost skin:",$o,",you may load pics first")),$l.alpha=$B[10],$i=$l.transform,0!=$c&&($f=$c*$I),0!=$Y&&($J=$Y*$b),0==$f&&0==$J||$i.translate(-$f,-$J);var $H=null;if($z||1!==$w||1!==$D||$e||$g){($H=$T._tempMt).identity(),$H.bTransform=!0;var $R=.0174532922222222*($z-$e),$G=.0174532922222222*($z+$g),$q=Math.cos($G),$L=Math.sin($G),$$=Math.sin($R),$p=Math.cos($R);$H.a=$w*$q,$H.b=$w*$L,$H.c=-$D*$$,$H.d=$D*$p,$H.tx=$H.ty=0;}return $H&&($i=$S.mul($i,$H,$i)),$i.translate($B[1],$B[2]),$l;},$d._getTextureByUrl=function($d){return $Bd.getRes($d);},$d.setAniData=function($d,$t){if($d.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$d,this._parseNodeList($d);var $l,$k={},$W=[],$i=$d.animations,$A=0,$B=$i.length;for($A=0;$A<$B;$A++)if($l=$i[$A],this._labels=null,(!$t||$t==$l.name)&&$l){try{this._calGraphicData($l);}catch($d){console.warn("parse animation fail:"+$l.name+",empty animation created"),this._gList=[];}var $o={};$o.interval=1e3/$l.frameRate,$o.frames=this._gList,$o.labels=this._labels,$o.name=$l.name,$W.push($o),$k[$l.name]=$o;}this.animationList=$W,this.animationDic=$k;}$T._temParam.length=0;},$d.parseByData=function($d){var $t,$l;$t=$d.nodeRoot,$l=$d.aniO,delete $d.nodeRoot,delete $d.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$t,this._parseNodeList($t),this._labels=null;try{this._calGraphicData($l);}catch($d){console.warn("parse animation fail:"+$l.name+",empty animation created"),this._gList=[];}var $k=$d;return $k.interval=1e3/$l.frameRate,$k.frames=this._gList,$k.labels=this._labels,$k.name=$l.name,$k;},$d.setUpAniData=function($d){if($d.animations){var $t,$l={},$k=[],$W=$d.animations,$i=0,$A=$W.length;for($i=0;$i<$A;$i++)if($t=$W[$i]){var $B={};$B.name=$t.name,$B.aniO=$t,$B.nodeRoot=$d,$k.push($B),$l[$t.name]=$B;}this.animationList=$k,this.animationDic=$l;}},$d._clear=function(){var $d,$t;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($d in this._nodeGDic)($t=this._nodeGDic[$d])&&$t.recover();this._nodeGDic=null;},$T.parseAnimationByData=function($d){var $t;return $T._I||($T._I=new $T()),$t=$T._I.parseByData($d),$T._I._clear(),$t;},$T.parseAnimationData=function($d){var $t;return $T._I||($T._I=new $T()),$T._I.setUpAniData($d),($t={}).animationList=$T._I.animationList,$t.animationDic=$T._I.animationDic,$T._I._clear(),$t;},$T._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$T._temParam=[],$T._I=null,$T._rootMatrix=null,$o($T,["_tempMt",function(){return this._tempMt=new $S();}]),$T.__init$=function(){$M=function(){function $d(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1;}return $w($d,""),$d.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$P.recover("GraphicNode",this);},$d.create=function(){return $P.getItemByClass("GraphicNode",$d);},$d;}();},$T;}($Hd));$q.__init([$I,$od,$K,$V,$m,$p,$d,$qd]);}(window,document,Laya),function($d,$t,$l){$l.un,$l.uns,$l.static;var $k=$l.class;$l.getset,$l.__newvec;new(function(){function $d(){}return $k($d,"LayaMain"),$d;}())();}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}}),function($d,$t,$G){$G.un,$G.uns;var $A=$G.static,$J=$G.class,$k=$G.getset,$i=$G.__newvec,$b=laya.maths.Arith,$f=laya.maths.Bezier,$l=laya.resource.Bitmap,$c=laya.utils.Browser,$o=laya.utils.Byte,$Y=laya.utils.Color,$q=(laya.filters.ColorFilter,$G.Config),$W=laya.resource.Context,$L=(laya.events.Event,laya.filters.Filter),$B=laya.display.Graphics,$I=laya.resource.HTMLCanvas,$w=(laya.utils.HTMLChar,laya.resource.HTMLImage),$D=laya.resource.HTMLSubImage,$$=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$p=laya.maths.Point,$M=laya.maths.Rectangle,$z=laya.renders.Render,$e=(laya.renders.RenderContext,laya.renders.RenderSprite),$g=laya.resource.Resource,$H=laya.resource.ResourceManager,$R=laya.utils.RunDriver,$T=laya.display.Sprite,$r=laya.display.Stage,$S=laya.utils.Stat,$j=laya.utils.StringKey,$C=(laya.display.css.Style,laya.system.System),$K=laya.display.Text,$x=laya.resource.Texture,$n=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$Q=laya.utils.VectorGraphManager;laya.utils.WordText;$G.interface("laya.webgl.shapes.IShape"),$G.interface("laya.webgl.submit.ISubmit"),$G.interface("laya.webgl.text.ICharSegment"),$G.interface("laya.webgl.canvas.save.ISaveData"),$G.interface("laya.webgl.resource.IMergeAtlasBitmap"),$G.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $y=function(){function $d(){}$J($d,"laya.filters.webgl.FilterActionGL");var $t=$d.prototype;return $G.imps($t,{"laya.filters.IFilterActionGL":!0}),$t.setValue=function($d){},$t.setValueMix=function($d){},$t.apply3d=function($d,$t,$l,$k,$W){return null;},$t.apply=function($d){return null;},$k(0,$t,"typeMix",function(){return 0;}),$d;}(),$V=function(){function $d(){}return $J($d,"laya.webgl.shader.ShaderValue"),$d;}(),$Z=function(){var $k,$W;function $d($d,$t,$l){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $W(),void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),this._cells=null,this._rowInfo=null,this._init($d,$t),this._atlasID=$l;}$J($d,"laya.webgl.atlas.AtlasGrid");var $t=$d.prototype;return $t.getAltasID=function(){return this._atlasID;},$t.setAltasID=function($d){0<=$d&&(this._atlasID=$d);},$t.addTex=function($d,$t,$l){var $k=this._get($t,$l);return 0==$k.ret||(this._fill($k.x,$k.y,$t,$l,$d),this._texCount++),$k;},$t._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null);},$t._init=function($d,$t){if(this._width=$d,this._height=$t,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$i(this._height);for(var $l=0;$l<this._height;$l++)this._rowInfo[$l]=new $k();return this._clear(),!0;},$t._get=function($d,$t){var $l=new $E();if($d>=this._failSize.width&&$t>=this._failSize.height)return $l;for(var $k=-1,$W=-1,$i=this._width,$A=this._height,$B=this._cells,$o=0;$o<$A;$o++)if(!(this._rowInfo[$o].spaceCount<$d))for(var $I=0;$I<$i;){var $b=3*($o*$i+$I);if(0!=$B[$b]||$B[1+$b]<$d||$B[2+$b]<$t)$I+=$B[1+$b];else{$k=$I,$W=$o;for(var $f=0;$f<$d;$f++)if($B[3*$f+$b+2]<$t){$k=-1;break;}if(!($k<0))return $l.ret=!0,$l.x=$k,$l.y=$W,$l;$I+=$B[1+$b];}}return $l;},$t._fill=function($d,$t,$l,$k,$W){var $i=this._width,$A=this._height;this._check($d+$l<=$i&&$t+$k<=$A);for(var $B=$t;$B<$k+$t;++$B){this._check(this._rowInfo[$B].spaceCount>=$l),this._rowInfo[$B].spaceCount-=$l;for(var $o=0;$o<$l;$o++){var $I=3*($d+$B*$i+$o);this._check(0==this._cells[$I]),this._cells[$I]=$W,this._cells[1+$I]=$l,this._cells[2+$I]=$k;}}if(0<$d)for($B=0;$B<$k;++$B){var $b=0;for($o=$d-1;0<=$o&&0==this._cells[3*(($t+$B)*$i+$o)];--$o,++$b);for($o=$b;0<$o;--$o)this._cells[3*(($t+$B)*$i+$d-$o)+1]=$o,this._check(0<$o);}if(0<$t)for($o=$d;$o<$d+$l;++$o){for($b=0,$B=$t-1;0<=$B&&0==this._cells[3*($o+$B*$i)];--$B,$b++);for($B=$b;0<$B;--$B)this._cells[3*($o+($t-$B)*$i)+2]=$B,this._check(0<$B);}},$t._check=function($d){0==$d&&console.log("xtexMerger 错误啦");},$t._clear=function(){for(var $d=this._texCount=0;$d<this._height;$d++)this._rowInfo[$d].spaceCount=this._width;for(var $t=0;$t<this._height;$t++)for(var $l=0;$l<this._width;$l++){var $k=3*($t*this._width+$l);this._cells[$k]=0,this._cells[1+$k]=this._width-$l,this._cells[2+$k]=this._width-$t;}this._failSize.width=this._width+1,this._failSize.height=this._height+1;},$d.__init$=function(){$k=function(){function $d(){this.spaceCount=0;}return $J($d,""),$d;}(),$W=function(){function $d(){this.width=0,this.height=0;}return $J($d,""),$d;}();},$d;}(),$U=function(){function $z($d,$t,$l,$k){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$d,this._height=$t,this._gridSize=$l,this._maxAtlaserCount=$k,this._gridNumX=$d/$l,this._gridNumY=$t/$l,this._curAtlasIndex=0,this._atlaserArray=[];}$J($z,"laya.webgl.atlas.AtlasResourceManager");var $d=$z.prototype;return $d.setAtlasParam=function($d,$t,$l,$k){if(1==this._setAtlasParam)return $z._sid_=0,this._width=$d,this._height=$t,this._gridSize=$l,this._maxAtlaserCount=$k,this._gridNumX=$d/$l,this._gridNumY=$t/$l,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1;},$d.pushData=function($d){var $t,$l=$d.bitmap,$k=-1,$W=null,$i=0,$A=0;for($i=0,$t=this._atlaserArray.length;$i<$t&&($A=(this._curAtlasIndex+$i)%$t,-1==($k=($W=this._atlaserArray[$A]).findBitmapIsExist($l)));$i++);if(-1!=$k){var $B=$W.InAtlasWebGLImagesOffsetValue[$k];return $Y=$B[0],$w=$B[1],$W.addToAtlas($d,$Y,$w),!0;}this._setAtlasParam=!1;for(var $o=Math.ceil(($d.bitmap.width+2)/this._gridSize),$I=Math.ceil(($d.bitmap.height+2)/this._gridSize),$b=!1,$f=0;$f<2;$f++){var $J=this._maxAtlaserCount;for($i=0;$i<$J;$i++){$A=(this._curAtlasIndex+$i)%$J,this._atlaserArray.length-1>=$A||this._atlaserArray.push(new $Md(this._gridNumX,this._gridNumY,this._width,this._height,$z._sid_++));var $c=this._atlaserArray[$A],$Y=0,$w=0,$D=$c.addTex(1,$o,$I);if($D.ret){$Y=$D.x*this._gridSize+1,$w=$D.y*this._gridSize+1,$l.lock=!0,$c.addToAtlasTexture($l,$Y,$w),$c.addToAtlas($d,$Y,$w),$b=!0,this._curAtlasIndex=$A;break;}}if($b)break;this._atlaserArray.push(new $Md(this._gridNumX,this._gridNumY,this._width,this._height,$z._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1;}return $b||console.log(">>>AtlasManager pushData error"),$b;},$d.addToAtlas=function($d){laya.webgl.atlas.AtlasResourceManager.instance.pushData($d);},$d.garbageCollection=function(){if(!0===this._needGC){for(var $d=this._atlaserArray.length-this._maxAtlaserCount,$t=0;$t<$d;$t++)this._atlaserArray[$t].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$d),this._atlaserArray.splice(0,$d),this._needGC=!1;}return!0;},$d.freeAll=function(){for(var $d=0,$t=this._atlaserArray.length;$d<$t;$d++)this._atlaserArray[$d].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0;},$d.getAtlaserCount=function(){return this._atlaserArray.length;},$d.getAtlaserByIndex=function($d){return this._atlaserArray[$d];},$k(1,$z,"instance",function(){return $z._Instance||($z._Instance=new $z(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$z._Instance;}),$k(1,$z,"enabled",function(){return $q.atlasEnable;}),$k(1,$z,"atlasLimitWidth",function(){return $z._atlasLimitWidth;},function($d){$z._atlasLimitWidth=$d;}),$k(1,$z,"atlasLimitHeight",function(){return $z._atlasLimitHeight;},function($d){$z._atlasLimitHeight=$d;}),$z._enable=function(){$q.atlasEnable=!0;},$z._disable=function(){$q.atlasEnable=!1;},$z.__init__=function(){$z.atlasTextureWidth=2048,$z.atlasTextureHeight=2048,$z.maxTextureCount=6,$z.atlasLimitWidth=512,$z.atlasLimitHeight=512;},$z._atlasLimitWidth=0,$z._atlasLimitHeight=0,$z.gridSize=16,$z.atlasTextureWidth=0,$z.atlasTextureHeight=0,$z.maxTextureCount=0,$z._atlasRestore=0,$z.BOARDER_TYPE_NO=0,$z.BOARDER_TYPE_RIGHT=1,$z.BOARDER_TYPE_LEFT=2,$z.BOARDER_TYPE_BOTTOM=4,$z.BOARDER_TYPE_TOP=8,$z.BOARDER_TYPE_ALL=15,$z._sid_=0,$z._Instance=null,$z;}(),$E=function(){function $d(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0;}return $J($d,"laya.webgl.atlas.MergeFillInfo"),$d;}(),$N=function(){function $t(){}return $J($t,"laya.webgl.canvas.BlendMode"),$t._init_=function($d){$t.fns=[$t.BlendNormal,$t.BlendAdd,$t.BlendMultiply,$t.BlendScreen,$t.BlendOverlay,$t.BlendLight,$t.BlendMask,$t.BlendDestinationOut],$t.targetFns=[$t.BlendNormalTarget,$t.BlendAddTarget,$t.BlendMultiplyTarget,$t.BlendScreenTarget,$t.BlendOverlayTarget,$t.BlendLightTarget,$t.BlendMask,$t.BlendDestinationOut];},$t.BlendNormal=function($d){$d.blendFunc(1,771);},$t.BlendAdd=function($d){$d.blendFunc(1,772);},$t.BlendMultiply=function($d){$d.blendFunc(774,771);},$t.BlendScreen=function($d){$d.blendFunc(1,1);},$t.BlendOverlay=function($d){$d.blendFunc(1,769);},$t.BlendLight=function($d){$d.blendFunc(1,1);},$t.BlendNormalTarget=function($d){$d.blendFunc(1,771);},$t.BlendAddTarget=function($d){$d.blendFunc(1,772);},$t.BlendMultiplyTarget=function($d){$d.blendFunc(774,771);},$t.BlendScreenTarget=function($d){$d.blendFunc(1,1);},$t.BlendOverlayTarget=function($d){$d.blendFunc(1,769);},$t.BlendLightTarget=function($d){$d.blendFunc(1,1);},$t.BlendMask=function($d){$d.blendFunc(0,770);},$t.BlendDestinationOut=function($d){$d.blendFunc(0,0);},$t.activeBlendFunction=null,$t.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$t.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$t.NORMAL="normal",$t.ADD="add",$t.MULTIPLY="multiply",$t.SCREEN="screen",$t.LIGHT="light",$t.OVERLAY="overlay",$t.DESTINATIONOUT="destination-out",$t.fns=[],$t.targetFns=[],$t;}(),$u=function(){function $l($d){this._color=$Y.create("black"),this.setValue($d);}$J($l,"laya.webgl.canvas.DrawStyle");var $d=$l.prototype;return $d.setValue=function($d){if($d){if("string"==typeof $d)return void(this._color=$Y.create($d));if($d instanceof laya.utils.Color)return void(this._color=$d);}},$d.reset=function(){this._color=$Y.create("black");},$d.equal=function($d){return"string"==typeof $d?this._color.strColor===$d:$d instanceof laya.utils.Color&&this._color.numColor===$d.numColor;},$d.toColorStr=function(){return this._color.strColor;},$l.create=function($d){var $t;if($d&&("string"==typeof $d?$t=$Y.create($d):$d instanceof laya.utils.Color&&($t=$d),$t))return $t._drawStyle||($t._drawStyle=new $l($d));return laya.webgl.canvas.DrawStyle.DEFAULT;},$A($l,["DEFAULT",function(){return this.DEFAULT=new $l("#000000");}]),$l;}(),$h=function(){function $d(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$Hd.mainContext;this.ib=$_d.create(35048),this.vb=$vd.create(5);}$J($d,"laya.webgl.canvas.Path");var $t=$d.prototype;return $t.addPoint=function($d,$t){this.tempArray.push($d,$t);},$t.getEndPointX=function(){return this.tempArray[this.tempArray.length-2];},$t.getEndPointY=function(){return this.tempArray[this.tempArray.length-1];},$t.polygon=function($d,$t,$l,$k,$W,$i){var $A;return this.geomatrys.push(this._curGeomatry=$A=new $jd($d,$t,$l,$k,$W,$i)),$k||($A.fill=!1),null==$i&&($A.borderWidth=0),$A;},$t.setGeomtry=function($d){this.geomatrys.push(this._curGeomatry=$d);},$t.drawLine=function($d,$t,$l,$k,$W){var $i;return this.closePath?this.geomatrys.push(this._curGeomatry=$i=new $Sd($d,$t,$l,$k,$W)):this.geomatrys.push(this._curGeomatry=$i=new $rd($d,$t,$l,$k,$W)),$i.fill=!1,$i;},$t.update=function(){var $d=this.ib._byteLength,$t=this.geomatrys.length;this.offset=$d;for(var $l=this.geoStart;$l<$t;$l++)this.geomatrys[$l].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$t,this.count=(this.ib._byteLength-$d)/$wd.BYTES_PIDX;},$t.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0;},$t.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null;},$d;}(),$s=function(){function $B(){}$J($B,"laya.webgl.canvas.save.SaveBase");var $d=$B.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!1;},$d.restore=function($d){this._dataObj[this._valueName]=this._value,($B._cache[$B._cache._length++]=this)._newSubmit&&($d._curSubmit=$id.RENDERBASE,$d._renderKey=0);},$B._createArray=function(){var $d=[];return $d._length=0,$d;},$B._init=function(){var $d=$B._namemap={};return $d[1]="ALPHA",$d[2]="fillStyle",$d[8]="font",$d[256]="lineWidth",$d[512]="strokeStyle",$d[8192]="_mergeID",$d[1024]=$d[2048]=$d[4096]=[],$d[16384]="textBaseline",$d[32768]="textAlign",$d[65536]="_nBlendType",$d[1048576]="shader",$d[2097152]="filters",$d;},$B.save=function($d,$t,$l,$k){if(($d._saveMark._saveuse&$t)!==$t){$d._saveMark._saveuse|=$t;var $W=$B._cache,$i=0<$W._length?$W[--$W._length]:new $B();$i._value=$l[$i._valueName=$B._namemap[$t]],$i._dataObj=$l,$i._newSubmit=$k;var $A=$d._save;$A[$A._length++]=$i;}},$B._cache=laya.webgl.canvas.save.SaveBase._createArray(),$B._namemap=$B._init(),$B;}(),$P=function(){function $i(){this._clipRect=new $M();}$J($i,"laya.webgl.canvas.save.SaveClipRect");var $d=$i.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!1;},$d.restore=function($d){$d._clipRect=this._clipSaveRect,($i._cache[$i._cache._length++]=this)._submitScissor.submitLength=$d._submits._length-this._submitScissor.submitIndex,$d._curSubmit=$id.RENDERBASE,$d._renderKey=0;},$i.save=function($d,$t){if(131072!=(131072&$d._saveMark._saveuse)){$d._saveMark._saveuse|=131072;var $l=$i._cache,$k=0<$l._length?$l[--$l._length]:new $i();$k._clipSaveRect=$d._clipRect,$d._clipRect=$k._clipRect.copyFrom($d._clipRect),$k._submitScissor=$t;var $W=$d._save;$W[$W._length++]=$k;}},$A($i,["_cache",function(){return this._cache=$s._createArray();}]),$i;}(),$X=function(){function $c(){this._contextX=0,this._contextY=0,this._clipRect=new $M(),this._rect=new $M(),this._matrix=new $$();}$J($c,"laya.webgl.canvas.save.SaveClipRectStencil");var $d=$c.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!1;},$d.restore=function($d){$bd.restore($d,this._rect,this._saveMatrix,this._contextX,this._contextY),$d._clipRect=this._clipSaveRect,$d._curMat=this._saveMatrix,$d._x=this._contextX,$d._y=this._contextY,$c._cache[$c._cache._length++]=this,$d._curSubmit=$id.RENDERBASE;},$c.save=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){if(262144!=(262144&$d._saveMark._saveuse)){$d._saveMark._saveuse|=262144;var $b=$c._cache,$f=0<$b._length?$b[--$b._length]:new $c();$f._clipSaveRect=$d._clipRect,$f._clipRect.setTo($A,$B,$o,$I),$d._clipRect=$f._clipRect,$f._rect.x=$l,$f._rect.y=$k,$f._rect.width=$W,$f._rect.height=$i,$f._contextX=$d._x,$f._contextY=$d._y,$f._saveMatrix=$d._curMat,$d._curMat.copyTo($f._matrix),$d._curMat=$f._matrix,$f._submitStencil=$t;var $J=$d._save;$J[$J._length++]=$f;}},$A($c,["_cache",function(){return this._cache=$s._createArray();}]),$c;}(),$m=function(){function $k(){this._saveuse=0;}$J($k,"laya.webgl.canvas.save.SaveMark");var $d=$k.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!0;},$d.restore=function($d){$d._saveMark=this._preSaveMark,$k._no[$k._no._length++]=this;},$k.Create=function($d){var $t=$k._no,$l=0<$t._length?$t[--$t._length]:new $k();return $l._saveuse=0,$l._preSaveMark=$d._saveMark,$d._saveMark=$l;},$A($k,["_no",function(){return this._no=$s._createArray();}]),$k;}(),$O=function(){function $i(){this._matrix=new $$();}$J($i,"laya.webgl.canvas.save.SaveTransform");var $d=$i.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!1;},$d.restore=function($d){$d._curMat=this._savematrix,$i._no[$i._no._length++]=this;},$i.save=function($d){var $t=$d._saveMark;if(2048!=(2048&$t._saveuse)){$t._saveuse|=2048;var $l=$i._no,$k=0<$l._length?$l[--$l._length]:new $i();$k._savematrix=$d._curMat,$d._curMat=$d._curMat.copyTo($k._matrix);var $W=$d._save;$W[$W._length++]=$k;}},$A($i,["_no",function(){return this._no=$s._createArray();}]),$i;}(),$F=function(){function $W(){}$J($W,"laya.webgl.canvas.save.SaveTranslate");var $d=$W.prototype;return $G.imps($d,{"laya.webgl.canvas.save.ISaveData":!0}),$d.isSaveMark=function(){return!1;},$d.restore=function($d){$d._curMat;$d._x=this._x,$d._y=this._y,$W._no[$W._no._length++]=this;},$W.save=function($d){var $t=$W._no,$l=0<$t._length?$t[--$t._length]:new $W();$l._x=$d._x,$l._y=$d._y;var $k=$d._save;$k[$k._length++]=$l;},$A($W,["_no",function(){return this._no=$s._createArray();}]),$W;}(),$a=function(){function $d(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $M();}$J($d,"laya.webgl.resource.RenderTargetMAX");var $t=$d.prototype;return $t.setSP=function($d){this._sp=$d;},$t.size=function($d,$t){var $l=this;this._width!==$d||this._height!==$t?(this.repaint=!0,this._width=$d,this._height=$t,this.target?this.target.size($d,$t):this.target=$Qd.create($d,$t),this.target.hasListener("recovered")||this.target.on("recovered",this,function($d){$G.timer.callLater($l._sp,$l._sp.repaint);})):this.target.size($d,$t);},$t._flushToTarget=function($d,$t){if(!$t._destroy){var $l=$ed.worldScissorTest,$k=$ed.worldClipRect;$ed.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$ed.worldScissorTest=!1,$Hd.mainContext.disable(3089);var $W=$ed.worldAlpha,$i=$ed.worldMatrix4,$A=$ed.worldMatrix,$B=$ed.worldFilters,$o=$ed.worldShaderDefines;if($ed.worldMatrix=$$.EMPTY,$ed.restoreTempArray(),$ed.worldMatrix4=$ed.TEMPMAT4_ARRAY,$ed.worldAlpha=1,$ed.worldFilters=null,$ed.worldShaderDefines=null,$nd.activeShader=null,$t.start(),$q.showCanvasMark?$t.clear(0,1,0,.3):$t.clear(0,0,0,0),$d.flush(),$t.end(),$nd.activeShader=null,$ed.worldAlpha=$W,$ed.worldMatrix4=$i,$ed.worldMatrix=$A,$ed.worldFilters=$B,$ed.worldShaderDefines=$o,$ed.worldScissorTest=$l){var $I=$ed.height-$k.y-$k.height;$Hd.mainContext.scissor($k.x,$I,$k.width,$k.height),$Hd.mainContext.enable(3089);}$ed.worldClipRect=$k;}},$t.flush=function($d){this.repaint&&(this._flushToTarget($d,this.target),this.repaint=!1);},$t.drawTo=function($d,$t,$l,$k,$W){$d.drawTexture(this.target.getTexture(),$t,$l,$k,$W,0,0);},$t.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null);},$d;}(),$_=function(){function $d(){this.ALPHA=1,this.shaderType=0,this.defines=new $Td();}return $J($d,"laya.webgl.shader.d2.Shader2D"),$d.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null;},$d.__init__=function(){var $d,$t;$md.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$md.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$md.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$md.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$md.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$md.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$md.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$md.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$d="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$t='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$md.preCompile2D(0,1,$d,$t,null),$d="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$t='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$md.preCompile2D(0,2,$d,$t,null),$d="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$t="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$md.preCompile2D(0,4,$d,$t,null),$d="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$t='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$md.preCompile2D(0,256,$d,$t,null),$d="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$t="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$md.preCompile2D(0,512,$d,$t,null);},$d;}(),$v=function(){function $t($d,$t,$l){this._value=0,this._name2int=$d,this._int2name=$t,this._int2nameMap=$l;}$J($t,"laya.webgl.shader.ShaderDefines");var $d=$t.prototype;return $d.add=function($d){return"string"==typeof $d&&($d=this._name2int[$d]),this._value|=$d,this._value;},$d.addInt=function($d){return this._value|=$d,this._value;},$d.remove=function($d){return"string"==typeof $d&&($d=this._name2int[$d]),this._value&=~$d,this._value;},$d.isDefine=function($d){return(this._value&$d)===$d;},$d.getValue=function(){return this._value;},$d.setValue=function($d){this._value=$d;},$d.toNameDic=function(){var $d=this._int2nameMap[this._value];return $d||$t._toText(this._value,this._int2name,this._int2nameMap);},$t._reg=function($d,$t,$l,$k){$k[$l[$d]=$t]=$d;},$t._toText=function($d,$t,$l){var $k=$l[$d];if($k)return $k;for(var $W={},$i=1,$A=0;$A<32&&!($d<($i=1<<$A));$A++)if($d&$i){var $B=$t[$i];$B&&($W[$B]="");}return $l[$d]=$W;},$t._toInt=function($d,$t){for(var $l=$d.split("."),$k=0,$W=0,$i=$l.length;$W<$i;$W++){var $A=$t[$l[$W]];if(!$A)throw new Error("Defines to int err:"+$d+"/"+$l[$W]);$k|=$A;}return $k;},$t;}(),$dd=function(){function $A(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $$();}$J($A,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $d=$A.prototype;return $d.init=function($d,$t,$l){if($t)this._vs=$t;else{this._vs=[];var $k=$d.width,$W=$d.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($k,0,1,0,1,1,1,1),this._vs.push($k,$W,1,1,1,1,1,1),this._vs.push(0,$W,0,1,1,1,1,1);}$l?this._ps=$l:($A._defaultPS||($A._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$A._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$d;},$d.init2=function($d,$t,$l,$k,$W){this.transform&&(this.transform=null),$l?this._ps=$l:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$k,this._uvs=$W,this.mEleNum=this._ps.length,this.mTexture=$d,($z.isConchNode||$z.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs));},$d._initMyData=function(){var $d=0,$t=0,$l=4*this._verticles.length;this._vs=$A._tempVS;var $k=!1;if($z.isConchNode||$z.isConchApp?(this._vs.length=$l,$k=!0):this._vs.length<$l&&(this._vs.length=$l,$k=!0),$A._tVSLen=$l,$k)for(;$d<$l;)this._vs[$d]=this._verticles[$t],this._vs[$d+1]=this._verticles[$t+1],this._vs[$d+2]=this._uvs[$t],this._vs[$d+3]=this._uvs[$t+1],this._vs[$d+4]=1,this._vs[$d+5]=1,this._vs[$d+6]=1,this._vs[$d+7]=1,$d+=8,$t+=2;else for(;$d<$l;)this._vs[$d]=this._verticles[$t],this._vs[$d+1]=this._verticles[$t+1],this._vs[$d+2]=this._uvs[$t],this._vs[$d+3]=this._uvs[$t+1],$d+=8,$t+=2;},$d.getData2=function($d,$t,$l){var $k;this.mVBBuffer=$d,this.mIBBuffer=$t,this._initMyData(),$d.appendEx2(this._vs,Float32Array,$A._tVSLen,4),this._indexStart=$t._byteLength,($k=$A._tempIB).length<this._ps.length&&($k.length=this._ps.length);for(var $W=0,$i=this._ps.length;$W<$i;$W++)$k[$W]=this._ps[$W]+$l;$t.appendEx2($k,Uint16Array,this._ps.length,2);},$d.getData=function($d,$t,$l){if(this.mVBBuffer=$d,this.mIBBuffer=$t,$d.append(this.mVBData),this._indexStart=$t._byteLength,this.mIBData.start!=$l){for(var $k=0,$W=this._ps.length;$k<$W;$k++)this.mIBData[$k]=this._ps[$k]+$l;this.mIBData.start=$l;}$t.append(this.mIBData);},$d.render=function($d,$t,$l){if($z.isWebGL&&this.mTexture){$d._renderKey=0,$d._shader2D.glTexture=null,$td.getInstance().addSkinMesh(this);var $k=$id.createShape($d,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$Ld.create(512,0));this.transform||(this.transform=$$.EMPTY),this.transform.translate($t,$l),$$.mul(this.transform,$d._curMat,this._tempMatrix),this.transform.translate(-$t,-$l);var $W=$k.shaderValue,$i=$W.u_mmat2||$ed.getMatrArray();$ed.mat2MatArray(this._tempMatrix,$i),$W.textureHost=this.mTexture,$W.offsetX=0,$W.offsetY=0,$W.u_mmat2=$i,$W.ALPHA=$d._shader2D.ALPHA,$d._submits[$d._submits._length++]=$k;}else $z.isConchApp&&this.mTexture&&(this.transform||(this.transform=$$.EMPTY),$d.setSkinMesh&&$d.setSkinMesh($t,$l,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform));},$A._tempVS=[],$A._tempIB=[],$A._defaultPS=null,$A._tVSLen=0,$A;}(),$td=function(){function $d(){this.ib=null,this.vb=null;$Hd.mainContext;this.ib=$_d.create(35048),this.vb=$vd.create(8);}$J($d,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $t=$d.prototype;return $t.addSkinMesh=function($d){$d.getData2(this.vb,this.ib,this.vb._byteLength/32);},$t.reset=function(){this.vb.clear(),this.ib.clear();},$d.getInstance=function(){return $d.instance=$d.instance||new $d();},$d.instance=null,$d;}(),$ld=function(){function $d($d,$t,$l,$k,$W,$i,$A,$B,$o){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$o&&($o=0),this.x=$d,this.y=$t,this.width=$l,this.height=$k,this.edges=$W,this.color=$i,this.borderWidth=$A,this.borderColor=$B;}$J($d,"laya.webgl.shapes.BasePoly");var $t=$d.prototype;return $G.imps($t,{"laya.webgl.shapes.IShape":!0}),$t.getData=function($d,$t,$l){},$t.rebuild=function($d){},$t.setMatrix=function($d){},$t.needUpdate=function($d){return!0;},$t.sector=function($d,$t,$l){var $k=this.x,$W=this.y,$i=this.edges,$A=(this.r1-this.r0)/$i,$B=this.width,$o=this.height,$I=this.color,$b=($I>>16&255)/255,$f=($I>>8&255)/255,$J=(255&$I)/255;$d.push($k,$W,$b,$f,$J);for(var $c=0;$c<$i+1;$c++)$d.push($k+Math.sin($A*$c+this.r0)*$B,$W+Math.cos($A*$c+this.r0)*$o),$d.push($b,$f,$J);for($c=0;$c<$i;$c++)$t.push($l,$l+$c+1,$l+$c+2);},$t.createLine2=function($d,$t,$l,$k,$W,$i){var $A,$B,$o,$I,$b,$f,$J,$c,$Y,$w,$D,$z,$e,$g,$H,$R,$G,$q,$L,$$,$p=$d.concat(),$M=$W,$T=this.borderColor,$r=($T>>16&255)/255,$S=($T>>8&255)/255,$j=(255&$T)/255,$C=$p.length/2,$K=$k,$x=$l/2;$o=$p[0],$I=$p[1],$w=$o-($b=$p[2]),$Y=($Y=-($I-($f=$p[3])))/($$=Math.sqrt($Y*$Y+$w*$w))*$x,$w=$w/$$*$x,$M.push($o-$Y+this.x,$I-$w+this.y,$r,$S,$j,$o+$Y+this.x,$I+$w+this.y,$r,$S,$j);for(var $n=1;$n<$C-1;$n++)$o=$p[2*($n-1)],$I=$p[2*($n-1)+1],$b=$p[2*$n],$f=$p[2*$n+1],$J=$p[2*($n+1)],$c=$p[2*($n+1)+1],$w=$o-$b,$z=$b-$J,$H=(-($Y=($Y=-($I-$f))/($$=Math.sqrt($Y*$Y+$w*$w))*$x)+$o)*(-($w=$w/$$*$x)+$f)-(-$Y+$b)*(-$w+$I),$q=(-($D=($D=-($f-$c))/($$=Math.sqrt($D*$D+$z*$z))*$x)+$J)*(-($z=$z/$$*$x)+$f)-(-$D+$b)*(-$z+$c),$L=($e=-$w+$I-(-$w+$f))*($G=-$D+$b-(-$D+$J))-($R=-$z+$c-(-$z+$f))*($g=-$Y+$b-(-$Y+$o)),Math.abs($L)<.1?($L+=10.1,$M.push($b-$Y+this.x,$f-$w+this.y,$r,$S,$j,$b+$Y+this.x,$f+$w+this.y,$r,$S,$j)):((($A=($g*$q-$G*$H)/$L)-$b)*($A-$b)+(($B=($R*$H-$e*$q)/$L)-$f)+($B-$f),$M.push($A+this.x,$B+this.y,$r,$S,$j,$b-($A-$b)+this.x,$f-($B-$f)+this.y,$r,$S,$j));$o=$p[$p.length-4],$I=$p[$p.length-3],$w=$o-($b=$p[$p.length-2]),$Y=($Y=-($I-($f=$p[$p.length-1])))/($$=Math.sqrt($Y*$Y+$w*$w))*$x,$w=$w/$$*$x,$M.push($b-$Y+this.x,$f-$w+this.y,$r,$S,$j,$b+$Y+this.x,$f+$w+this.y,$r,$S,$j);var $Q=$i;for($n=1;$n<$Q;$n++)$t.push($K+2*($n-1),$K+2*($n-1)+1,$K+2*$n+1,$K+2*$n+1,$K+2*$n,$K+2*($n-1));return $M;},$t.createLine=function($d,$t,$l,$k){var $W=$d.concat(),$i=$d,$A=this.borderColor,$B=($A>>16&255)/255,$o=($A>>8&255)/255,$I=(255&$A)/255;$W.splice(0,5);var $b,$f,$J,$c,$Y,$w,$D,$z,$e,$g,$H,$R,$G,$q,$L,$$,$p,$M,$T,$r,$S=$W.length/5,$j=$k,$C=$l/2;$J=$W[0],$c=$W[1],$g=$J-($Y=$W[5]),$e=($e=-($c-($w=$W[6])))/($r=Math.sqrt($e*$e+$g*$g))*$C,$g=$g/$r*$C,$i.push($J-$e,$c-$g,$B,$o,$I,$J+$e,$c+$g,$B,$o,$I);for(var $K=1;$K<$S-1;$K++)$J=$W[5*($K-1)],$c=$W[5*($K-1)+1],$Y=$W[5*$K],$w=$W[5*$K+1],$D=$W[5*($K+1)],$z=$W[5*($K+1)+1],$g=$J-$Y,$R=$Y-$D,$L=(-($e=($e=-($c-$w))/($r=Math.sqrt($e*$e+$g*$g))*$C)+$J)*(-($g=$g/$r*$C)+$w)-(-$e+$Y)*(-$g+$c),$M=(-($H=($H=-($w-$z))/($r=Math.sqrt($H*$H+$R*$R))*$C)+$D)*(-($R=$R/$r*$C)+$w)-(-$H+$Y)*(-$R+$z),$T=($G=-$g+$c-(-$g+$w))*($p=-$H+$Y-(-$H+$D))-($$=-$R+$z-(-$R+$w))*($q=-$e+$Y-(-$e+$J)),Math.abs($T)<.1?($T+=10.1,$i.push($Y-$e,$w-$g,$B,$o,$I,$Y+$e,$w+$g,$B,$o,$I)):((($b=($q*$M-$p*$L)/$T)-$Y)*($b-$Y)+(($f=($$*$L-$G*$M)/$T)-$w)+($f-$w),$i.push($b,$f,$B,$o,$I,$Y-($b-$Y),$w-($f-$w),$B,$o,$I));$J=$W[$W.length-10],$c=$W[$W.length-9],$g=$J-($Y=$W[$W.length-5]),$e=($e=-($c-($w=$W[$W.length-4])))/($r=Math.sqrt($e*$e+$g*$g))*$C,$g=$g/$r*$C,$i.push($Y-$e,$w-$g,$B,$o,$I,$Y+$e,$w+$g,$B,$o,$I);var $x=this.edges+1;for($K=1;$K<$x;$K++)$t.push($j+2*($K-1),$j+2*($K-1)+1,$j+2*$K+1,$j+2*$K+1,$j+2*$K,$j+2*($K-1));return $i;},$t.createLoopLine=function($d,$t,$l,$k,$W,$i){var $A=$d.concat(),$B=$W||$d,$o=this.borderColor,$I=($o>>16&255)/255,$b=($o>>8&255)/255,$f=(255&$o)/255;$A.splice(0,5);var $J=[$A[0],$A[1]],$c=[$A[$A.length-5],$A[$A.length-4]],$Y=$c[0]+.5*($J[0]-$c[0]),$w=$c[1]+.5*($J[1]-$c[1]);$A.unshift($Y,$w,0,0,0),$A.push($Y,$w,0,0,0);var $D,$z,$e,$g,$H,$R,$G,$q,$L,$$,$p,$M,$T,$r,$S,$j,$C,$K,$x,$n,$Q=$A.length/5,$y=$k,$V=$l/2;$e=$A[0],$g=$A[1],$$=$e-($H=$A[5]),$L=($L=-($g-($R=$A[6])))/($n=Math.sqrt($L*$L+$$*$$))*$V,$$=$$/$n*$V,$B.push($e-$L,$g-$$,$I,$b,$f,$e+$L,$g+$$,$I,$b,$f);for(var $Z=1;$Z<$Q-1;$Z++)$e=$A[5*($Z-1)],$g=$A[5*($Z-1)+1],$H=$A[5*$Z],$R=$A[5*$Z+1],$G=$A[5*($Z+1)],$q=$A[5*($Z+1)+1],$$=$e-$H,$M=$H-$G,$S=(-($L=($L=-($g-$R))/($n=Math.sqrt($L*$L+$$*$$))*$V)+$e)*(-($$=$$/$n*$V)+$R)-(-$L+$H)*(-$$+$g),$K=(-($p=($p=-($R-$q))/($n=Math.sqrt($p*$p+$M*$M))*$V)+$G)*(-($M=$M/$n*$V)+$R)-(-$p+$H)*(-$M+$q),$x=($T=-$$+$g-(-$$+$R))*($C=-$p+$H-(-$p+$G))-($j=-$M+$q-(-$M+$R))*($r=-$L+$H-(-$L+$e)),Math.abs($x)<.1?($x+=10.1,$B.push($H-$L,$R-$$,$I,$b,$f,$H+$L,$R+$$,$I,$b,$f)):((($D=($r*$K-$C*$S)/$x)-$H)*($D-$H)+(($z=($j*$S-$T*$K)/$x)-$R)+($z-$R),$B.push($D,$z,$I,$b,$f,$H-($D-$H),$R-($z-$R),$I,$b,$f));$i&&($t=$i);var $U=this.edges+1;for($Z=1;$Z<$U;$Z++)$t.push($y+2*($Z-1),$y+2*($Z-1)+1,$y+2*$Z+1,$y+2*$Z+1,$y+2*$Z,$y+2*($Z-1));return $t.push($y+2*($Z-1),$y+2*($Z-1)+1,$y+1,$y+1,$y,$y+2*($Z-1)),$B;},$d;}(),$kd=function(){function $w(){}return $J($w,"laya.webgl.shapes.Earcut"),$w.earcut=function($d,$t,$l){$l=$l||2;var $k,$W,$i,$A,$B,$o,$I,$b=$t&&$t.length,$f=$b?$t[0]*$l:$d.length,$J=$w.linkedList($d,0,$f,$l,!0),$c=[];if(!$J)return $c;if($b&&($J=$w.eliminateHoles($d,$t,$J,$l)),$d.length>80*$l){$k=$i=$d[0],$W=$A=$d[1];for(var $Y=$l;$Y<$f;$Y+=$l)($B=$d[$Y])<$k&&($k=$B),($o=$d[$Y+1])<$W&&($W=$o),$i<$B&&($i=$B),$A<$o&&($A=$o);$I=0!==($I=Math.max($i-$k,$A-$W))?1/$I:0;}return $w.earcutLinked($J,$c,$l,$k,$W,$I),$c;},$w.linkedList=function($d,$t,$l,$k,$W){var $i,$A;if($W===0<$w.signedArea($d,$t,$l,$k))for($i=$t;$i<$l;$i+=$k)$A=$w.insertNode($i,$d[$i],$d[$i+1],$A);else for($i=$l-$k;$t<=$i;$i-=$k)$A=$w.insertNode($i,$d[$i],$d[$i+1],$A);return $A&&$w.equals($A,$A.next)&&($w.removeNode($A),$A=$A.next),$A;},$w.filterPoints=function($d,$t){if(!$d)return $d;$t||($t=$d);var $l,$k=$d;do{if($l=!1,$k.steiner||!$w.equals($k,$k.next)&&0!==$w.area($k.prev,$k,$k.next))$k=$k.next;else{if($w.removeNode($k),($k=$t=$k.prev)===$k.next)break;$l=!0;}}while($l||$k!==$t);return $t;},$w.earcutLinked=function($d,$t,$l,$k,$W,$i,$A){if($d){!$A&&$i&&$w.indexCurve($d,$k,$W,$i);for(var $B,$o,$I=$d;$d.prev!==$d.next;)if($B=$d.prev,$o=$d.next,$i?$w.isEarHashed($d,$k,$W,$i):$w.isEar($d))$t.push($B.i/$l),$t.push($d.i/$l),$t.push($o.i/$l),$w.removeNode($d),$d=$o.next,$I=$o.next;else if(($d=$o)===$I){$A?1===$A?($d=$w.cureLocalIntersections($d,$t,$l),$w.earcutLinked($d,$t,$l,$k,$W,$i,2)):2===$A&&$w.splitEarcut($d,$t,$l,$k,$W,$i):$w.earcutLinked($w.filterPoints($d,null),$t,$l,$k,$W,$i,1);break;}}},$w.isEar=function($d){var $t=$d.prev,$l=$d,$k=$d.next;if(0<=$w.area($t,$l,$k))return!1;for(var $W=$d.next.next;$W!==$d.prev;){if($w.pointInTriangle($t.x,$t.y,$l.x,$l.y,$k.x,$k.y,$W.x,$W.y)&&0<=$w.area($W.prev,$W,$W.next))return!1;$W=$W.next;}return!0;},$w.isEarHashed=function($d,$t,$l,$k){var $W=$d.prev,$i=$d,$A=$d.next;if(0<=$w.area($W,$i,$A))return!1;for(var $B=$W.x<$i.x?$W.x<$A.x?$W.x:$A.x:$i.x<$A.x?$i.x:$A.x,$o=$W.y<$i.y?$W.y<$A.y?$W.y:$A.y:$i.y<$A.y?$i.y:$A.y,$I=$W.x>$i.x?$W.x>$A.x?$W.x:$A.x:$i.x>$A.x?$i.x:$A.x,$b=$W.y>$i.y?$W.y>$A.y?$W.y:$A.y:$i.y>$A.y?$i.y:$A.y,$f=$w.zOrder($B,$o,$t,$l,$k),$J=$w.zOrder($I,$b,$t,$l,$k),$c=$d.nextZ;$c&&$c.z<=$J;){if($c!==$d.prev&&$c!==$d.next&&$w.pointInTriangle($W.x,$W.y,$i.x,$i.y,$A.x,$A.y,$c.x,$c.y)&&0<=$w.area($c.prev,$c,$c.next))return!1;$c=$c.nextZ;}for($c=$d.prevZ;$c&&$c.z>=$f;){if($c!==$d.prev&&$c!==$d.next&&$w.pointInTriangle($W.x,$W.y,$i.x,$i.y,$A.x,$A.y,$c.x,$c.y)&&0<=$w.area($c.prev,$c,$c.next))return!1;$c=$c.prevZ;}return!0;},$w.cureLocalIntersections=function($d,$t,$l){var $k=$d;do{var $W=$k.prev,$i=$k.next.next;!$w.equals($W,$i)&&$w.intersects($W,$k,$k.next,$i)&&$w.locallyInside($W,$i)&&$w.locallyInside($i,$W)&&($t.push($W.i/$l),$t.push($k.i/$l),$t.push($i.i/$l),$w.removeNode($k),$w.removeNode($k.next),$k=$d=$i),$k=$k.next;}while($k!==$d);return $k;},$w.splitEarcut=function($d,$t,$l,$k,$W,$i){var $A=$d;do{for(var $B=$A.next.next;$B!==$A.prev;){if($A.i!==$B.i&&$w.isValidDiagonal($A,$B)){var $o=$w.splitPolygon($A,$B);return $A=$w.filterPoints($A,$A.next),$o=$w.filterPoints($o,$o.next),$w.earcutLinked($A,$t,$l,$k,$W,$i),void $w.earcutLinked($o,$t,$l,$k,$W,$i);}$B=$B.next;}$A=$A.next;}while($A!==$d);},$w.eliminateHoles=function($d,$t,$l,$k){var $W,$i,$A,$B,$o,$I=[];for($W=0,$i=$t.length;$W<$i;$W++)$A=$t[$W]*$k,$B=$W<$i-1?$t[$W+1]*$k:$d.length,($o=$w.linkedList($d,$A,$B,$k,!1))===$o.next&&($o.steiner=!0),$I.push($w.getLeftmost($o));for($I.sort($w.compareX),$W=0;$W<$I.length;$W++)$w.eliminateHole($I[$W],$l),$l=$w.filterPoints($l,$l.next);return $l;},$w.compareX=function($d,$t){return $d.x-$t.x;},$w.eliminateHole=function($d,$t){if($t=$w.findHoleBridge($d,$t)){var $l=$w.splitPolygon($t,$d);$w.filterPoints($l,$l.next);}},$w.findHoleBridge=function($d,$t){var $l,$k=$t,$W=$d.x,$i=$d.y,$A=-1/0;do{if($i<=$k.y&&$i>=$k.next.y&&$k.next.y!==$k.y){var $B=$k.x+($i-$k.y)*($k.next.x-$k.x)/($k.next.y-$k.y);if($B<=$W&&$A<$B){if(($A=$B)===$W){if($i===$k.y)return $k;if($i===$k.next.y)return $k.next;}$l=$k.x<$k.next.x?$k:$k.next;}}$k=$k.next;}while($k!==$t);if(!$l)return null;if($W===$A)return $l.prev;var $o,$I=$l,$b=$l.x,$f=$l.y,$J=1/0;for($k=$l.next;$k!==$I;)$W>=$k.x&&$k.x>=$b&&$W!==$k.x&&$w.pointInTriangle($i<$f?$W:$A,$i,$b,$f,$i<$f?$A:$W,$i,$k.x,$k.y)&&(($o=Math.abs($i-$k.y)/($W-$k.x))<$J||$o===$J&&$k.x>$l.x)&&$w.locallyInside($k,$d)&&($l=$k,$J=$o),$k=$k.next;return $l;},$w.indexCurve=function($d,$t,$l,$k){for(var $W=$d;null===$W.z&&($W.z=$w.zOrder($W.x,$W.y,$t,$l,$k)),$W.prevZ=$W.prev,$W.nextZ=$W.next,($W=$W.next)!==$d;);$W.prevZ.nextZ=null,$W.prevZ=null,$w.sortLinked($W);},$w.sortLinked=function($d){var $t,$l,$k,$W,$i,$A,$B,$o,$I=1;do{for($l=$d,$i=$d=null,$A=0;$l;){for($A++,$k=$l,$t=$B=0;$t<$I&&($B++,$k=$k.nextZ);$t++);for($o=$I;0<$B||0<$o&&$k;)0!==$B&&(0===$o||!$k||$l.z<=$k.z)?($l=($W=$l).nextZ,$B--):($k=($W=$k).nextZ,$o--),$i?$i.nextZ=$W:$d=$W,$W.prevZ=$i,$i=$W;$l=$k;}$i.nextZ=null,$I*=2;}while(1<$A);return $d;},$w.zOrder=function($d,$t,$l,$k,$W){return($d=1431655765&(($d=858993459&(($d=252645135&(($d=16711935&(($d=32767*($d-$l)*$W)|$d<<8))|$d<<4))|$d<<2))|$d<<1))|($t=1431655765&(($t=858993459&(($t=252645135&(($t=16711935&(($t=32767*($t-$k)*$W)|$t<<8))|$t<<4))|$t<<2))|$t<<1))<<1;},$w.getLeftmost=function($d){for(var $t=$d,$l=$d;$t.x<$l.x&&($l=$t),($t=$t.next)!==$d;);return $l;},$w.pointInTriangle=function($d,$t,$l,$k,$W,$i,$A,$B){return 0<=($W-$A)*($t-$B)-($d-$A)*($i-$B)&&0<=($d-$A)*($k-$B)-($l-$A)*($t-$B)&&0<=($l-$A)*($i-$B)-($W-$A)*($k-$B);},$w.isValidDiagonal=function($d,$t){return $d.next.i!==$t.i&&$d.prev.i!==$t.i&&!$w.intersectsPolygon($d,$t)&&$w.locallyInside($d,$t)&&$w.locallyInside($t,$d)&&$w.middleInside($d,$t);},$w.area=function($d,$t,$l){return($t.y-$d.y)*($l.x-$t.x)-($t.x-$d.x)*($l.y-$t.y);},$w.equals=function($d,$t){return $d.x===$t.x&&$d.y===$t.y;},$w.intersects=function($d,$t,$l,$k){return!!($w.equals($d,$t)&&$w.equals($l,$k)||$w.equals($d,$k)&&$w.equals($l,$t))||0<$w.area($d,$t,$l)!=0<$w.area($d,$t,$k)&&0<$w.area($l,$k,$d)!=0<$w.area($l,$k,$t);},$w.intersectsPolygon=function($d,$t){var $l=$d;do{if($l.i!==$d.i&&$l.next.i!==$d.i&&$l.i!==$t.i&&$l.next.i!==$t.i&&$w.intersects($l,$l.next,$d,$t))return!0;$l=$l.next;}while($l!==$d);return!1;},$w.locallyInside=function($d,$t){return $w.area($d.prev,$d,$d.next)<0?0<=$w.area($d,$t,$d.next)&&0<=$w.area($d,$d.prev,$t):$w.area($d,$t,$d.prev)<0||$w.area($d,$d.next,$t)<0;},$w.middleInside=function($d,$t){for(var $l=$d,$k=!1,$W=($d.x+$t.x)/2,$i=($d.y+$t.y)/2;$l.y>$i!=$l.next.y>$i&&$l.next.y!==$l.y&&$W<($l.next.x-$l.x)*($i-$l.y)/($l.next.y-$l.y)+$l.x&&($k=!$k),($l=$l.next)!==$d;);return $k;},$w.splitPolygon=function($d,$t){var $l=new $Wd($d.i,$d.x,$d.y),$k=new $Wd($t.i,$t.x,$t.y),$W=$d.next,$i=$t.prev;return($d.next=$t).prev=$d,($l.next=$W).prev=$l,($k.next=$l).prev=$k,($i.next=$k).prev=$i,$k;},$w.insertNode=function($d,$t,$l,$k){var $W=new $Wd($d,$t,$l);return $k?($W.next=$k.next,($W.prev=$k).next.prev=$W,$k.next=$W):($W.prev=$W).next=$W,$W;},$w.removeNode=function($d){$d.next.prev=$d.prev,$d.prev.next=$d.next,$d.prevZ&&($d.prevZ.nextZ=$d.nextZ),$d.nextZ&&($d.nextZ.prevZ=$d.prevZ);},$w.signedArea=function($d,$t,$l,$k){for(var $W=0,$i=$t,$A=$l-$k;$i<$l;$i+=$k)$W+=($d[$A]-$d[$i])*($d[$i+1]+$d[$A+1]),$A=$i;return $W;},$w;}(),$Wd=function(){function $d($d,$t,$l){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$d,this.x=$t,this.y=$l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}return $J($d,"laya.webgl.shapes.EarcutNode"),$d;}(),$id=(function(){function $d($d,$t,$l,$k,$W,$i,$A){this.lineWidth=$d,this.lineColor=$t,this.lineAlpha=$l,this.fillColor=$k,this.fillAlpha=$W,this.shape=$A,this.fill=$i;}$J($d,"laya.webgl.shapes.GeometryData");var $t=$d.prototype;$t.clone=function(){return new $d(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape);},$t.getIndexData=function(){return null;},$t.getVertexData=function(){return null;},$t.destroy=function(){this.shape=null;};}(),function(){function $d($d){if($d instanceof Float32Array)this.points=$d;else if($d instanceof Array){$d.length;this.points=new Float32Array($d);}}$J($d,"laya.webgl.shapes.Vertex");var $t=$d.prototype;$G.imps($t,{"laya.webgl.shapes.IShape":!0}),$t.getData=function($d,$t,$l){},$t.needUpdate=function($d){return!1;},$t.rebuild=function($d){},$t.setMatrix=function($d){};}(),function(){function $o($d){void 0===$d&&($d=1e4),this._renderType=$d;}$J($o,"laya.webgl.submit.Submit");var $d=$o.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d.releaseRender=function(){var $d=$o._cache;($d[$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$d.getRenderType=function(){return this._renderType;},$d.renderSubmit=function(){if(0===this._numEle)return 1;var $d=this.shaderValue.textureHost;if($d){var $t=$d.source;if(!$d.bitmap||!$t)return 1;this.shaderValue.texture=$t,$d.alphaTexture&&$d.alphaTexture.source&&(this.shaderValue.texture1=$d.alphaTexture.source);}this._vb.bind_upload(this._ib);var $l=$Hd.mainContext;return this.shaderValue.upload(),$N.activeBlendFunction!==this._blendFn&&($l.enable(3042),this._blendFn($l),$N.activeBlendFunction=this._blendFn),$S.drawCall++,$S.trianglesFaces+=this._numEle/3,$l.drawElements(4,this._numEle,5123,this._startIdx),1;},$o.__init__=function(){var $d=$o.RENDERBASE=new $o(-1);$d.shaderValue=new $Ld(0,0),$d.shaderValue.ALPHA=-1234;},$o.createSubmit=function($d,$t,$l,$k,$W){var $i=$o._cache._length?$o._cache[--$o._cache._length]:new $o();null==$l&&(($l=$i._selfVb||($i._selfVb=$vd.create(-1))).clear(),$k=0),$i._ib=$t,$i._vb=$l,$i._startIdx=$k*$wd.BYTES_PIDX,$i._numEle=0;var $A=$d._nBlendType;$i._blendFn=$d._targets?$N.targetFns[$A]:$N.fns[$A],$i.shaderValue=$W,$i.shaderValue.setValue($d._shader2D);var $B=$d._shader2D.filters;return $B&&$i.shaderValue.setFilters($B),$i;},$o.createShape=function($d,$t,$l,$k,$W,$i){var $A=$o._cache._length?$o._cache[--$o._cache._length]:new $o();$A._ib=$t,$A._vb=$l,$A._numEle=$k,$A._startIdx=$W,$A.shaderValue=$i,$A.shaderValue.setValue($d._shader2D);var $B=$d._nBlendType;return $A._blendFn=$d._targets?$N.targetFns[$B]:$N.fns[$B],$A;},$o.TYPE_2D=1e4,$o.TYPE_CANVAS=10003,$o.TYPE_CMDSETRT=10004,$o.TYPE_CUSTOM=10005,$o.TYPE_BLURRT=10006,$o.TYPE_CMDDESTORYPRERT=10007,$o.TYPE_DISABLESTENCIL=10008,$o.TYPE_OTHERIBVB=10009,$o.TYPE_PRIMITIVE=10010,$o.TYPE_RT=10011,$o.TYPE_BLUR_RT=10012,$o.TYPE_TARGET=10013,$o.TYPE_CHANGE_VALUE=10014,$o.TYPE_SHAPE=10015,$o.TYPE_TEXTURE=10016,$o.TYPE_FILLTEXTURE=10017,$o.RENDERBASE=null,$o._cache=(($o._cache=[])._length=0,$o._cache),$o;}()),$Ad=function(){function $k(){this.fun=null,this.args=null;}$J($k,"laya.webgl.submit.SubmitCMD");var $d=$k.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d.renderSubmit=function(){return this.fun.apply(null,this.args),1;},$d.getRenderType=function(){return 0;},$d.releaseRender=function(){var $d=$k._cache;$d[$d._length++]=this;},$k.create=function($d,$t){var $l=$k._cache._length?$k._cache[--$k._cache._length]:new $k();return $l.fun=$t,$l.args=$d,$l;},$k._cache=(($k._cache=[])._length=0,$k._cache),$k;}(),$Bd=function(){function $t(){this.variables={};}$J($t,"laya.webgl.submit.SubmitCMDScope");var $d=$t.prototype;return $d.getValue=function($d){return this.variables[$d];},$d.addValue=function($d,$t){return this.variables[$d]=$t;},$d.setValue=function($d,$t){return this.variables.hasOwnProperty($d)?this.variables[$d]=$t:null;},$d.clear=function(){for(var $d in this.variables)delete this.variables[$d];},$d.recycle=function(){this.clear(),$t.POOL.push(this);},$t.create=function(){var $d=$t.POOL.pop();return $d||($d=new $t()),$d;},$t.POOL=[],$t;}(),$od=function(){function $f(){this.offset=0,this.startIndex=0,this._mat=$$.create();}$J($f,"laya.webgl.submit.SubmitOtherIBVB");var $d=$f.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d.releaseRender=function(){var $d=$f._cache;($d[$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$d.getRenderType=function(){return 10009;},$d.renderSubmit=function(){var $d=this._shaderValue.textureHost;if($d){var $t=$d.source;if(!$d.bitmap||!$t)return 1;this._shaderValue.texture=$t;}this._vb.bind_upload(this._ib);var $l=$ed.worldMatrix4,$k=$$.TEMP;$$.mulPre(this._mat,$l[0],$l[1],$l[4],$l[5],$l[12],$l[13],$k);var $W=$ed.worldMatrix4=$f.tempMatrix4;$W[0]=$k.a,$W[1]=$k.b,$W[4]=$k.c,$W[5]=$k.d,$W[12]=$k.tx,$W[13]=$k.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $i=$Hd.mainContext;return $N.activeBlendFunction!==this._blendFn&&($i.enable(3042),this._blendFn($i),$N.activeBlendFunction=this._blendFn),$S.drawCall++,$S.trianglesFaces+=this._numEle/3,$i.drawElements(4,this._numEle,5123,this.startIndex),$ed.worldMatrix4=$l,$nd.activeShader=null,1;},$f.create=function($d,$t,$l,$k,$W,$i,$A,$B,$o){void 0===$o&&($o=0);var $I=$f._cache._length?$f._cache[--$f._cache._length]:new $f();$I._ib=$l,$I._vb=$t,$I._numEle=$k,$I._shader=$W,$I._shaderValue=$i;var $b=$d._nBlendType;switch($I._blendFn=$d._targets?$N.targetFns[$b]:$N.fns[$b],$o){case 0:$I.offset=0,$I.startIndex=$B/($wd.BYTES_PE*$t.vertexStride)*1.5,$I.startIndex*=$wd.BYTES_PIDX;break;case 1:$I.startIndex=$A,$I.offset=$B;}return $I;},$f._cache=(($f._cache=[])._length=0,$f._cache),$f.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$f;}(),$Id=function(){function $l(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $M(),this.screenRect=new $M();}$J($l,"laya.webgl.submit.SubmitScissor");var $d=$l.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d._scissor=function($d,$t,$l,$k){var $W=$ed.worldMatrix4,$i=$W[0],$A=$W[5],$B=$W[12],$o=$W[13];if($k*=$A,($l*=$i)<1||$k<1)return!1;var $I=($d=$d*$i+$B)+$l,$b=($t=$t*$A+$o)+$k;$d<0&&($l=$I-($d=0)),$t<0&&($k=$b-($t=0));var $f=$ed.worldClipRect;if($d=Math.max($d,$f.x),$t=Math.max($t,$f.y),$l=Math.min($I,$f.right)-$d,$k=Math.min($b,$f.bottom)-$t,$l<1||$k<1)return!1;var $J=$ed.worldScissorTest;return this.screenRect.copyFrom($f),$f.x=$d,$f.y=$t,$f.width=$l,$f.height=$k,$ed.worldScissorTest=!0,$t=$ed.height-$t-$k,$Hd.mainContext.scissor($d,$t,$l,$k),$Hd.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$J?($t=$ed.height-this.screenRect.y-this.screenRect.height,$Hd.mainContext.scissor(this.screenRect.x,$t,this.screenRect.width,this.screenRect.height),$Hd.mainContext.enable(3089)):($Hd.mainContext.disable(3089),$ed.worldScissorTest=!1),$f.copyFrom(this.screenRect),!0;},$d._scissorWithTagart=function($d,$t,$l,$k){if($l<1||$k<1)return!1;var $W=$d+$l,$i=$t+$k;$d<0&&($l=$W-($d=0)),$t<0&&($k=$i-($t=0));var $A=$ed.worldClipRect;if($d=Math.max($d,$A.x),$t=Math.max($t,$A.y),$l=Math.min($W,$A.right)-$d,$k=Math.min($i,$A.bottom)-$t,$l<1||$k<1)return!1;var $B=$ed.worldScissorTest;return this.screenRect.copyFrom($A),$ed.worldScissorTest=!0,$A.x=$d,$A.y=$t,$A.width=$l,$A.height=$k,$t=$ed.height-$t-$k,$Hd.mainContext.scissor($d,$t,$l,$k),$Hd.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$B?($t=$ed.height-this.screenRect.y-this.screenRect.height,$Hd.mainContext.scissor(this.screenRect.x,$t,this.screenRect.width,this.screenRect.height),$Hd.mainContext.enable(3089)):($Hd.mainContext.disable(3089),$ed.worldScissorTest=!1),$A.copyFrom(this.screenRect),!0;},$d.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1;},$d.getRenderType=function(){return 0;},$d.releaseRender=function(){var $d=$l._cache;($d[$d._length++]=this).context=null;},$l.create=function($d){var $t=$l._cache._length?$l._cache[--$l._cache._length]:new $l();return $t.context=$d,$t;},$l._cache=(($l._cache=[])._length=0,$l._cache),$l;}(),$bd=function(){function $o(){this.step=0,this.blendMode=null,this.level=0;}$J($o,"laya.webgl.submit.SubmitStencil");var $d=$o.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8();}return 1;},$d.getRenderType=function(){return 0;},$d.releaseRender=function(){var $d=$o._cache;$d[$d._length++]=this;},$d.do1=function(){var $d=$Hd.mainContext;$d.enable(2960),$d.clear(1024),$d.colorMask(!1,!1,!1,!1),$d.stencilFunc(514,this.level,255),$d.stencilOp(7680,7680,7682);},$d.do2=function(){var $d=$Hd.mainContext;$d.stencilFunc(514,this.level+1,255),$d.colorMask(!0,!0,!0,!0),$d.stencilOp(7680,7680,7680);},$d.do3=function(){var $d=$Hd.mainContext;$d.colorMask(!0,!0,!0,!0),$d.stencilOp(7680,7680,7680),$d.clear(1024),$d.disable(2960);},$d.do4=function(){var $d=$Hd.mainContext;0==this.level&&($d.enable(2960),$d.clear(1024)),$d.colorMask(!1,!1,!1,!1),$d.stencilFunc(519,0,255),$d.stencilOp(7680,7680,7682);},$d.do5=function(){var $d=$Hd.mainContext;$d.stencilFunc(514,this.level,255),$d.colorMask(!0,!0,!0,!0),$d.stencilOp(7680,7680,7680);},$d.do6=function(){var $d=$Hd.mainContext;$N.targetFns[$N.TOINT[this.blendMode]]($d);},$d.do7=function(){var $d=$Hd.mainContext;$d.colorMask(!1,!1,!1,!1),$d.stencilOp(7680,7680,7683);},$d.do8=function(){var $d=$Hd.mainContext;$d.colorMask(!0,!0,!0,!0),$d.stencilFunc(514,this.level,255),$d.stencilOp(7680,7680,7680);},$o.restore=function($d,$t,$l,$k,$W){var $i;if(($d._renderKey=0)<$o._mask&&$o._mask--,0==$o._mask)$i=laya.webgl.submit.SubmitStencil.create(3),$d.addRenderObject($i),$d._curSubmit=$id.RENDERBASE;else{$i=laya.webgl.submit.SubmitStencil.create(7),$d.addRenderObject($i);var $A=$d._vb;$A._byteLength;if($Dd.fillRectImgVb($A,null,$t.x,$t.y,$t.width,$t.height,$x.DEF_UV,$l,$k,$W,0,0)){$d._shader2D.glTexture=null;var $B=$d._curSubmit=$id.createSubmit($d,$d._ib,$A,($A._byteLength-64)/32*3,$Ld.create(2,0));$B.shaderValue.ALPHA=1,$d._submits[$d._submits._length++]=$B,$d._curSubmit._numEle+=6,$d._curSubmit=$id.RENDERBASE;}else alert("clipRect calc stencil rect error");$i=laya.webgl.submit.SubmitStencil.create(8),$d.addRenderObject($i);}},$o.restore2=function($d,$t){var $l;($d._renderKey=0)<$o._mask&&$o._mask--,0==$o._mask?($l=laya.webgl.submit.SubmitStencil.create(3),$d.addRenderObject($l),$d._curSubmit=$id.RENDERBASE):($l=laya.webgl.submit.SubmitStencil.create(7),$d.addRenderObject($l),$d._submits[$d._submits._length++]=$t,$l=laya.webgl.submit.SubmitStencil.create(8),$d.addRenderObject($l));},$o.create=function($d){var $t=$o._cache._length?$o._cache[--$o._cache._length]:new $o();return 5==($t.step=$d)&&++$o._mask,$t.level=$o._mask,$t;},$o._cache=(($o._cache=[])._length=0,$o._cache),$o._mask=0,$o;}(),$fd=function(){function $B(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null;}$J($B,"laya.webgl.submit.SubmitTarget");var $d=$B.prototype;return $G.imps($d,{"laya.webgl.submit.ISubmit":!0}),$d.renderSubmit=function(){this._vb.bind_upload(this._ib);var $d=this.scope.getValue(this.proName);return $d&&(this.shaderValue.texture=$d.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$d.width,$d.height]),this.shaderValue.upload(),this.blend(),$S.drawCall++,$S.trianglesFaces+=this._numEle/3,$Hd.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1;},$d.blend=function(){if($N.activeBlendFunction!==$N.fns[this.blendType]){var $d=$Hd.mainContext;$d.enable(3042),$N.fns[this.blendType]($d),$N.activeBlendFunction=$N.fns[this.blendType];}},$d.getRenderType=function(){return 0;},$d.releaseRender=function(){var $d=$B._cache;($d[$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$B.create=function($d,$t,$l,$k,$W,$i){var $A=$B._cache._length?$B._cache[--$B._cache._length]:new $B();return $A._ib=$t,$A._vb=$l,$A.proName=$i,$A._startIdx=$k*$wd.BYTES_PIDX,$A._numEle=0,$A.blendType=$d._nBlendType,$A.shaderValue=$W,$A.shaderValue.setValue($d._shader2D),$A;},$B._cache=(($B._cache=[])._length=0,$B._cache),$B;}(),$Jd=function(){function $d(){this._sourceStr=null;}$J($d,"laya.webgl.text.CharSegment");var $t=$d.prototype;return $G.imps($t,{"laya.webgl.text.ICharSegment":!0}),$t.textToSpit=function($d){this._sourceStr=$d;},$t.getChar=function($d){return this._sourceStr.charAt($d);},$t.getCharCode=function($d){return this._sourceStr.charCodeAt($d);},$t.length=function(){return this._sourceStr.length;},$d;}(),$cd=function(){var $d;function $S(){}return $J($S,"laya.webgl.text.DrawText"),$S.__init__=function(){$S._charsTemp=new Array(),$S._drawValue=new $d(),$S._charSeg=new $Jd();},$S.customCharSeg=function($d){$S._charSeg=$d;},$S.getChar=function($d,$t,$l){var $k=$sd.createOneChar($d,$l);return-1!=$t&&($S._charsCache[$t]=$k),$k;},$S._drawSlow=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f,$J,$c,$Y){var $w,$D,$z=$S._drawValue.value($i,$B,$o,$I,$J,$c,$Y),$e=0,$g=0,$H=$S._charsTemp,$R=0,$G=NaN;if($k)for($H.length=$k.length,$e=0,$g=$k.length;$e<$g;$e++)($D=$k[$e])&&($G=$D.charNum+$z.txtID,$H[$e]=$w=$S._charsCache[$G]||$S.getChar($D.char,$G,$z),$w.active());else{var $q=$l instanceof laya.utils.WordText?$l.toString():$l;if($K.CharacterCache){$S._charSeg.textToSpit($q);var $L=$S._charSeg.length();for($e=0,$g=$H.length=$L;$e<$g;$e++)$G=$S._charSeg.getCharCode($e)+$z.txtID,$H[$e]=$w=$S._charsCache[$G]||$S.getChar($S._charSeg.getChar($e),$G,$z),$w.active(),$R+=$w.cw;}else $H.length=0,($w=$S.getChar($q,-1,$z)).active(),$R+=$w.cw,$H[0]=$w;}var $$=0;null!==$A&&"left"!==$A&&($$=-("center"==$A?$R/2:$R));var $p,$M,$T=NaN,$r=0;if($k)for($e=0,$g=$H.length;$e<$g;$e++)$w=$H[$e],$D=$k[$e],$w&&$D&&!$w.isSpace&&($T=$w.borderSize,$p=$w.texture,$t._drawText($p,$b+$$+$D.x*$J-$T,$f+$D.y*$c-$T,$p.width,$p.height,$W,0,0,0,0));else{for($e=0,$g=$H.length;$e<$g;$e++)($w=$H[$e])&&!$w.isSpace&&($T=$w.borderSize,$p=$w.texture,$t._drawText($p,$b+$$-$T,$f-$T,$p.width,$p.height,$W,0,0,0,0),$d&&(($M=$d[$r++])||($M=$d[$r-1]=[]),$M[0]=$p,$M[1]=$$-$T,$M[2]=-$T)),$$+=$w.cw;$d&&($d.length=$r);}},$S._drawFast=function($d,$t,$l,$k,$W){for(var $i,$A,$B=0,$o=$d.length;$B<$o;$B++)($i=($A=$d[$B])[0]).active(),$t._drawText($i,$k+$A[1],$W+$A[2],$i.width,$i.height,$l,0,0,0,0);},$S.drawText=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f){if(void 0===$f&&($f=0),!($t&&0===$t.length||$l&&0===$l.length)){var $J=$k.a,$c=$k.d;(0!==$k.b||0!==$k.c)&&($J=$c=1);var $Y=1!==$J||1!==$c;if($Y&&$G.stage.transform){var $w=$G.stage.transform;$Y=$w.a===$J&&$w.d===$c;}else $Y=!1;if($Y){var $D=($k=$k.copyTo($qd._tmpMatrix)).tx,$z=$k.ty;$k.scale(1/$J,1/$c),$k._checkTransform(),$I*=$J,$b*=$c,$I+=$D-$k.tx,$b+=$z-$k.ty;}else $J=$c=1;if($l)$S._drawSlow(null,$d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$J,$c,$f);else{if(null===$t.toUpperCase){var $e=$J+1e5*$c,$g=$t;return void($g.changed||$g.id!==$e?($g.id=$e,$g.changed=!1,$S._drawSlow($g.save,$d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$J,$c,$f)):$S._drawFast($g.save,$d,$k,$I,$b));}var $H=$t+$W.toString()+$A+$B+$o+$J+$c+$i,$R=$S._textsCache[$H];$K.CharacterCache?$R?$S._drawFast($R,$d,$k,$I,$b):($S._textsCache.__length||($S._textsCache.__length=0),$S._textsCache.__length>$q.WebGLTextCacheCount&&(($S._textsCache={}).__length=0,$S._curPoolIndex=0),$S._textCachesPool[$S._curPoolIndex]?($R=$S._textsCache[$H]=$S._textCachesPool[$S._curPoolIndex]).length=0:$S._textCachesPool[$S._curPoolIndex]=$R=$S._textsCache[$H]=[],$S._textsCache.__length++,$S._curPoolIndex++,$S._drawSlow($R,$d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$J,$c,$f)):$S._drawSlow($R,$d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$J,$c,$f);}}},$S._charsTemp=null,$S._textCachesPool=[],$S._curPoolIndex=0,$S._charsCache={},$S._textsCache={},$S._drawValue=null,$S.d=[],$S._charSeg=null,$S.__init$=function(){$d=function(){function $o(){}return $J($o,""),$o.prototype.value=function($d,$t,$l,$k,$W,$i,$A){this.font=$d,this.fillColor=$t,this.borderColor=$l,this.lineWidth=$k,this.scaleX=$W,this.scaleY=$i,this.underLine=$A;var $B=$d.toString()+$W+$i+$k+($t?$t.toLowerCase():" ")+($l?$l.toLowerCase():" ")+$A;return this.txtID=$o._keymap[$B],this.txtID||(this.txtID=1e-7*++$o._keymapCount,$o._keymap[$B]=this.txtID),this;},$o.clear=function(){$o._keymap={},$o._keymapCount=1;},$o._keymap={},$o._keymapCount=1,$o;}();},$S;}(),$Yd=function(){function $W($d){this._index=0,this._size=14,this._italic=-2,$W._cache2=$W._cache2||[],this.setFont($d||"14px Arial");}$J($W,"laya.webgl.text.FontInContext");var $d=$W.prototype;return $d.setFont=function($d){var $t=$W._cache2[$d];if($t)this._words=$t[0],this._size=$t[1];else{this._words=$d.split(" ");for(var $l=0,$k=this._words.length;$l<$k;$l++)if(0<this._words[$l].indexOf("px")){this._index=$l;break;}this._size=parseInt(this._words[this._index]),$W._cache2[$d]=[this._words,this._size];}this._text=null,this._italic=-2;},$d.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic;},$d.hasType=function($d){for(var $t=0,$l=this._words.length;$t<$l;$t++)if(this._words[$t]===$d)return $t;return-1;},$d.removeType=function($d){for(var $t=0,$l=this._words.length;$t<$l;$t++)if(this._words[$t]===$d){this._words.splice($t,1),this._index>$t&&this._index--;break;}this._text=null,this._italic=-2;},$d.copyTo=function($d){return $d._text=this._text,$d._size=this._size,$d._index=this._index,$d._words=this._words.slice(),$d._italic=-2,$d;},$d.toString=function(){return this._text?this._text:this._text=this._words.join(" ");},$k(0,$d,"size",function(){return this._size;},function($d){this._size=$d,this._words[this._index]=$d+"px",this._text=null;}),$W.create=function($d){var $t=$W._cache[$d];return $t||($t=$W._cache[$d]=new $W($d));},$W.EMPTY=new $W(),$W._cache={},$W._cache2=null,$W;}(),$wd=function(){function $d(){}return $J($d,"laya.webgl.utils.CONST3D2D"),$d.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$d.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$d.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$d._TMPARRAY=[],$d._OFFSETX=0,$d._OFFSETY=0,$A($d,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT;},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT;}]),$d;}(),$Dd=function(){function $Y(){}return $J($Y,"laya.webgl.utils.GlUtils"),$Y.make2DProjection=function($d,$t,$l){return[2/$d,0,0,0,0,-2/$t,0,0,0,0,2/$l,0,-1,1,0,1];},$Y.fillIBQuadrangle=function($d,$t){if(65535/4<$t)throw Error("IBQuadrangle count:"+$t+" must<:"+Math.floor(65535/4));$t=Math.floor($t),$d._resizeBuffer(6*($t+1)*2,!1),$d.byteLength=$d.bufferLength;for(var $l=$d.getUint16Array(),$k=0,$W=0;$W<$t;$W++)$l[$k++]=4*$W,$l[$k++]=4*$W+2,$l[$k++]=4*$W+1,$l[$k++]=4*$W,$l[$k++]=4*$W+3,$l[$k++]=4*$W+2;return $d.setNeedUpload(),!0;},$Y.expandIBQuadrangle=function($d,$t){$d.bufferLength>=6*$t*2||$Y.fillIBQuadrangle($d,$t);},$Y.mathCeilPowerOfTwo=function($d){return $d--,$d|=$d>>1,$d|=$d>>2,$d|=$d>>4,$d|=$d>>8,$d|=$d>>16,++$d;},$Y.fillQuadrangleImgVb=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=16+($d._byteLength>>2);$d.byteLength=$o<<2;var $I=$d.getFloat32Array();$I[($o-=16)+2]=$W[0],$I[$o+3]=$W[1],$I[$o+6]=$W[2],$I[$o+7]=$W[3],$I[$o+10]=$W[4],$I[$o+11]=$W[5],$I[$o+14]=$W[6],$I[$o+15]=$W[7];var $b=$i.a,$f=$i.b,$J=$i.c,$c=$i.d;if(1!==$b||0!==$f||0!==$J||1!==$c){$i.bTransform=!0;var $Y=$i.tx+$A,$w=$i.ty+$B;$I[$o]=($k[0]+$t)*$b+($k[1]+$l)*$J+$Y,$I[$o+1]=($k[0]+$t)*$f+($k[1]+$l)*$c+$w,$I[$o+4]=($k[2]+$t)*$b+($k[3]+$l)*$J+$Y,$I[$o+5]=($k[2]+$t)*$f+($k[3]+$l)*$c+$w,$I[$o+8]=($k[4]+$t)*$b+($k[5]+$l)*$J+$Y,$I[$o+9]=($k[4]+$t)*$f+($k[5]+$l)*$c+$w,$I[$o+12]=($k[6]+$t)*$b+($k[7]+$l)*$J+$Y,$I[$o+13]=($k[6]+$t)*$f+($k[7]+$l)*$c+$w;}else $i.bTransform=!1,$t+=$i.tx+$A,$l+=$i.ty+$B,$I[$o]=$t+$k[0],$I[$o+1]=$l+$k[1],$I[$o+4]=$t+$k[2],$I[$o+5]=$l+$k[3],$I[$o+8]=$t+$k[4],$I[$o+9]=$l+$k[5],$I[$o+12]=$t+$k[6],$I[$o+13]=$l+$k[7];return $d._upload=!0;},$Y.fillTranglesVB=function($d,$t,$l,$k,$W,$i,$A){var $B=($d._byteLength>>2)+$k.length;$d.byteLength=$B<<2;var $o=$d.getFloat32Array();$B-=$k.length;for(var $I=$k.length,$b=$W.a,$f=$W.b,$J=$W.c,$c=$W.d,$Y=0;$Y<$I;$Y+=4)if($o[$B+$Y+2]=$k[$Y+2],$o[$B+$Y+3]=$k[$Y+3],1!==$b||0!==$f||0!==$J||1!==$c){$W.bTransform=!0;var $w=$W.tx+$i,$D=$W.ty+$A;$o[$B+$Y]=($k[$Y]+$t)*$b+($k[$Y+1]+$l)*$J+$w,$o[$B+$Y+1]=($k[$Y]+$t)*$f+($k[$Y+1]+$l)*$c+$D;}else $W.bTransform=!1,$t+=$W.tx+$i,$l+=$W.ty+$A,$o[$B+$Y]=$t+$k[$Y],$o[$B+$Y+1]=$l+$k[$Y+1];return $d._upload=!0;},$Y.copyPreImgVb=function($d,$t,$l){var $k=$d._byteLength>>2;$d.byteLength=$k+16<<2;for(var $W=$d.getFloat32Array(),$i=0,$A=$k-16;$i<4;$i++)$W[$k]=$W[$A]+$t,++$A,$W[++$k]=$W[$A]+$l,++$A,$W[++$k]=$W[$A],++$A,$W[++$k]=$W[$A],++$k,++$A;$d._upload=!0;},$Y.fillRectImgVb=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f,$J){void 0===$J&&($J=!1);var $c,$Y,$w,$D,$z,$e,$g,$H,$R,$G,$q,$L,$$,$p,$M,$T,$r=1,$S=$B.a,$j=$B.b,$C=$B.c,$K=$B.d,$x=$t&&$t.width<99999999;if(1!==$S||0!==$j||0!==$C||1!==$K?($B.bTransform=!0,0===$j&&0===$C&&($r=23,$R=$W+$l,$G=$i+$k,$c=$S*$l+($q=$B.tx+$o),$w=$S*$R+$q,$Y=$K*$k+($L=$B.ty+$I),$D=$K*$G+$L)):($r=23,$B.bTransform=!1,$w=($c=$l+$B.tx+$o)+$W,$D=($Y=$k+$B.ty+$I)+$i),$x&&($z=$t.x,$e=$t.y,$g=$t.width+$z,$H=$t.height+$e),1!==$r){if(Math.min($c,$w)>=$g)return!1;if(Math.min($Y,$D)>=$H)return!1;if(Math.max($w,$c)<=$z)return!1;if(Math.max($D,$Y)<=$e)return!1;}var $n=$d._byteLength>>2;$d.byteLength=16+$n<<2;var $Q=$d.getFloat32Array();switch($Q[2+$n]=$A[0],$Q[3+$n]=$A[1],$Q[6+$n]=$A[2],$Q[7+$n]=$A[3],$Q[10+$n]=$A[4],$Q[11+$n]=$A[5],$Q[14+$n]=$A[6],$Q[15+$n]=$A[7],$r){case 1:$q=$B.tx+$o,$L=$B.ty+$I;var $y=$S*$l,$V=$C*$k,$Z=$K*$k,$U=$j*$l,$E=$S*($R=$W+$l),$N=$C*($G=$i+$k),$u=$K*$G,$h=$j*$R;$J?($$=$y+$V+$q,$M=Math.round($$)-$$,$p=$Z+$U+$L,$T=Math.round($p)-$p,$Q[$n]=$$+$M,$Q[1+$n]=$p+$T,$Q[4+$n]=$E+$V+$q+$M,$Q[5+$n]=$Z+$h+$L+$T,$Q[8+$n]=$E+$N+$q+$M,$Q[9+$n]=$u+$h+$L+$T,$Q[12+$n]=$y+$N+$q+$M,$Q[13+$n]=$u+$U+$L+$T):($Q[$n]=$y+$V+$q,$Q[1+$n]=$Z+$U+$L,$Q[4+$n]=$E+$V+$q,$Q[5+$n]=$Z+$h+$L,$Q[8+$n]=$E+$N+$q,$Q[9+$n]=$u+$h+$L,$Q[12+$n]=$y+$N+$q,$Q[13+$n]=$u+$U+$L);break;case 23:$J?($$=$c+$b,$M=Math.round($$)-$$,$p=$Y,$T=Math.round($p)-$p,$Q[$n]=$$+$M,$Q[1+$n]=$p+$T,$Q[4+$n]=$w+$b+$M,$Q[5+$n]=$Y+$T,$Q[8+$n]=$w+$M,$Q[9+$n]=$D+$T,$Q[12+$n]=$c+$M,$Q[13+$n]=$D+$T):($Q[$n]=$c+$b,$Q[1+$n]=$Y,$Q[4+$n]=$w+$b,$Q[5+$n]=$Y,$Q[8+$n]=$w,$Q[9+$n]=$D,$Q[12+$n]=$c,$Q[13+$n]=$D);}return $d._upload=!0;},$Y.fillLineVb=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=.5*$A,$I=$Y._fillLineArray,$b=-($k-$i),$f=$l-$W,$J=Math.sqrt($b*$b+$f*$f);$b/=$J,$f/=$J,$b*=$o,$f*=$o,$I[0]=$l-$b,$I[1]=$k-$f,$I[4]=$l+$b,$I[5]=$k+$f,$I[8]=$W+$b,$I[9]=$i+$f,$I[12]=$W-$b,$I[13]=$i-$f,$B&&$B.transformPointArray($I,$I);var $c=16+($d._byteLength>>2);return $d.byteLength=$c<<2,$d.insertData($I,$c-16),!0;},$Y._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$Y;}(),$zd=(function(){function $o(){}$J($o,"laya.webgl.utils.MatirxArray"),$o.ArrayMul=function($d,$t,$l){if($d){if($t)for(var $k=NaN,$W=NaN,$i=NaN,$A=NaN,$B=0;$B<4;$B++)$k=$d[$B],$W=$d[$B+4],$i=$d[$B+8],$A=$d[$B+12],$l[$B]=$k*$t[0]+$W*$t[1]+$i*$t[2]+$A*$t[3],$l[$B+4]=$k*$t[4]+$W*$t[5]+$i*$t[6]+$A*$t[7],$l[$B+8]=$k*$t[8]+$W*$t[9]+$i*$t[10]+$A*$t[11],$l[$B+12]=$k*$t[12]+$W*$t[13]+$i*$t[14]+$A*$t[15];else $o.copyArray($d,$l);}else $o.copyArray($t,$l);},$o.copyArray=function($d,$t){if($d&&$t)for(var $l=0;$l<$d.length;$l++)$t[$l]=$d[$l];};}(),function(){function $t($d,$t,$l){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$d,this._vb=new $vd($d,35048),$t&&this._vb._resizeBuffer($t,!1),this._ib=new $_d(),$l&&this._ib._resizeBuffer($l,!1);}$J($t,"laya.webgl.utils.Mesh2D");var $d=$t.prototype;return $d.cloneWithNewVB=function(){var $d=new $t(this._stride,0,0);return $d._ib=this._ib,$d._quadNum=this._quadNum,$d._attribInfo=this._attribInfo,$d;},$d.cloneWithNewVBIB=function(){var $d=new $t(this._stride,0,0);return $d._attribInfo=this._attribInfo,$d;},$d.getVBW=function(){return this._vb.setNeedUpload(),this._vb;},$d.getVBR=function(){return this._vb;},$d.getIBR=function(){return this._ib;},$d.getIBW=function(){return this._ib.setNeedUpload(),this._ib;},$d.createQuadIB=function($d){this._quadNum=$d,this._ib._resizeBuffer(6*$d*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $t=this._ib.getUint16Array(),$l=0,$k=0,$W=0;$W<$d;$W++)$t[$l++]=$k,$t[$l++]=$k+2,$t[$l++]=$k+1,$t[$l++]=$k,$t[$l++]=$k+3,$t[$l++]=$k+2,$k+=4;this._ib.setNeedUpload();},$d.setAttributes=function($d){if(this._attribInfo=$d,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!";},$d.getEleNum=function(){return this._ib.getBuffer().byteLength/2;},$d.releaseMesh=function(){},$d.destroy=function(){},$d.clearVB=function(){this._vb.clear();},$t._gvaoid=0,$t;}()),$ed=function(){function $W(){}return $J($W,"laya.webgl.utils.RenderState2D"),$W.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];},$W.mat2MatArray=function($d,$t){var $l=$d,$k=$t;return $k[0]=$l.a,$k[1]=$l.b,$k[2]=$W.EMPTYMAT4_ARRAY[2],$k[3]=$W.EMPTYMAT4_ARRAY[3],$k[4]=$l.c,$k[5]=$l.d,$k[6]=$W.EMPTYMAT4_ARRAY[6],$k[7]=$W.EMPTYMAT4_ARRAY[7],$k[8]=$W.EMPTYMAT4_ARRAY[8],$k[9]=$W.EMPTYMAT4_ARRAY[9],$k[10]=$W.EMPTYMAT4_ARRAY[10],$k[11]=$W.EMPTYMAT4_ARRAY[11],$k[12]=$l.tx,$k[13]=$l.ty,$k[14]=$W.EMPTYMAT4_ARRAY[14],$k[15]=$W.EMPTYMAT4_ARRAY[15],$t;},$W.restoreTempArray=function(){$W.TEMPMAT4_ARRAY[0]=1,$W.TEMPMAT4_ARRAY[1]=0,$W.TEMPMAT4_ARRAY[4]=0,$W.TEMPMAT4_ARRAY[5]=1,$W.TEMPMAT4_ARRAY[12]=0,$W.TEMPMAT4_ARRAY[13]=0;},$W.clear=function(){$W.worldScissorTest=!1,$W.worldShaderDefines=null,$W.worldFilters=null,$W.worldAlpha=1,$W.worldClipRect.x=$W.worldClipRect.y=0,$W.worldClipRect.width=$W.width,$W.worldClipRect.height=$W.height,$W.curRenderTarget=null;},$W._MAXSIZE=99999999,$W.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$W.worldMatrix4=$W.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$W.worldAlpha=1,$W.worldScissorTest=!1,$W.worldFilters=null,$W.worldShaderDefines=null,$W.curRenderTarget=null,$W.width=0,$W.height=0,$A($W,["worldMatrix",function(){return this.worldMatrix=new $$();},"worldClipRect",function(){return this.worldClipRect=new $M(0,0,99999999,99999999);}]),$W;}(),$gd=function(){var $e,$l;function $g($d,$t,$l,$k,$W){var $i=this;function $A($d){var $t=[],$l=new $e($t);return $i._compileToTree($l,$d.split("\n"),0,$t,$W),$l;}var $B=$c.now();this._VS=$A($t),this._PS=$A($l),this._nameMap=$k,2<$c.now()-$B&&console.log("ShaderCompile use time:"+($c.now()-$B)+"  size:"+$t.length+"/"+$l.length);}$J($g,"laya.webgl.utils.ShaderCompile");var $d=$g.prototype;return $d._compileToTree=function($d,$t,$l,$k,$W){var $i,$A,$B,$o,$I,$b,$f,$J=0,$c=0,$Y=0,$w=0;for($c=$l;$c<$t.length;$c++)if(!(($B=$t[$c]).length<1)&&0!==($J=$B.indexOf("//"))){if(0<=$J&&($B=$B.substr(0,$J)),$i=$f||new $e($k),$f=null,$i.text=$B,$i.noCompile=!0,0<=($J=$B.indexOf("#"))){for($o="#",$w=$J+1,$Y=$B.length;$w<$Y;$w++){var $D=$B.charAt($w);if(" "===$D||"\t"===$D||"\r"===$D||"\n"===$D||"?"===$D)break;$o+=$D;}switch($i.name=$o){case"#ifdef":case"#ifndef":if($i.src=$B,$i.noCompile=null!=$B.match(/[!&|()=<>]/),$i.noCompile?console.log("function():Boolean{return "+$B.substr($J+$i.name.length)+"}"):($b=$B.replace(/^\s*/,"").split(/\s+/),$i.setCondition($b[1],"#ifdef"===$o?1:2),$i.text="//"+$i.text),$i.setParent($d),$d=$i,$W)for($b=$B.substr($w).split($g._splitToWordExps3),$w=0;$w<$b.length;$w++)($B=$b[$w]).length&&($W[$B]=!0);continue;case"#if":if($i.src=$B,$i.noCompile=!0,$i.setParent($d),$d=$i,$W)for($b=$B.substr($w).split($g._splitToWordExps3),$w=0;$w<$b.length;$w++)($B=$b[$w]).length&&"defined"!=$B&&($W[$B]=!0);continue;case"#else":$i.src=$B,$A=($d=$d.parent).childs[$d.childs.length-1],$i.noCompile=$A.noCompile,$i.noCompile||($i.condition=$A.condition,$i.conditionType=1==$A.conditionType?2:1,$i.text="//"+$i.text+" "+$A.text+" "+$i.conditionType),$i.setParent($d),$d=$i;continue;case"#endif":$A=($d=$d.parent).childs[$d.childs.length-1],$i.noCompile=$A.noCompile,$i.noCompile||($i.text="//"+$i.text),$i.setParent($d);continue;case"#include":$b=$g.splitToWords($B,null);var $z=$g.includes[$b[1]];if(!$z)throw"ShaderCompile error no this include file:"+$b[1];if(($J=$b[0].indexOf("?"))<0){$i.setParent($d),$B=$z.getWith("with"==$b[2]?$b[3]:null),this._compileToTree($i,$B.split("\n"),0,$k,$W),$i.text="";continue;}$i.setCondition($b[0].substr($J+1),1),$i.text=$z.getWith("with"==$b[2]?$b[3]:null);break;case"#import":$I=($b=$g.splitToWords($B,null))[1],$k.push({node:$i,file:$g.includes[$I],ofs:$i.text.length});continue;}}else{if(($A=$d.childs[$d.childs.length-1])&&!$A.name){0<$k.length&&$g.splitToWords($B,$A),$f=$i,$A.text+="\n"+$B;continue;}0<$k.length&&$g.splitToWords($B,$i);}$i.setParent($d);}},$d.createShader=function($d,$t,$l){var $k={},$W="";if($d)for(var $i in $d)$W+="#define "+$i+"\n",$k[$i]=!0;var $A=this._VS.toscript($k,[]),$B=this._PS.toscript($k,[]);return($l||$md.create)($W+$A.join("\n"),$W+$B.join("\n"),$t,this._nameMap);},$g._parseOne=function($d,$t,$l,$k,$W,$i){var $A={type:$g.shaderParamsMap[$l[$k+1]],name:$l[$k+2],size:isNaN(parseInt($l[$k+3]))?1:parseInt($l[$k+3])};return $i&&("attribute"==$W?$d.push($A):$t.push($A)),":"==$l[$k+3]&&($A.type=$l[$k+4],$k+=2),$k+=2;},$g.addInclude=function($d,$t){if(!$t||0===$t.length)throw new Error("add shader include file err:"+$d);if($g.includes[$d])throw new Error("add shader include file err, has add:"+$d);$g.includes[$d]=new $l($t);},$g.preGetParams=function($d,$t){var $l=[$d,$t],$k={},$W=[],$i=[],$A={},$B=[];$k.attributes=$W,$k.uniforms=$i,$k.defines=$A;for(var $o=0,$I=0,$b=0;$b<2;$b++){$l[$b]=$l[$b].replace($g._removeAnnotation,"");var $f,$J=$l[$b].match($g._reg);for($o=0,$I=$J.length;$o<$I;$o++){var $c=$J[$o];if("attribute"==$c||"uniform"==$c)$o=$g._parseOne($W,$i,$J,$o,$c,!0);else{if("#define"==$c){$B[$c=$J[++$o]]=1;continue;}if("#ifdef"==$c){$A[$f=$J[++$o]]=$A[$f]||[];for($o++;$o<$I;$o++)if("attribute"==($c=$J[$o])||"uniform"==$c)$o=$g._parseOne($W,$i,$J,$o,$c,$B[$f]);else if("#else"==$c)for($o++;$o<$I;$o++)if("attribute"==($c=$J[$o])||"uniform"==$c)$o=$g._parseOne($W,$i,$J,$o,$c,!$B[$f]);else if("#endif"==$c)break;}}}}return $k;},$g.splitToWords=function($d,$t){for(var $l,$k,$W=[],$i=-1,$A=0,$B=$d.length;$A<$B;$A++)if($l=$d.charAt($A),0<=" \t=+-*/&%!<>()'\",;".indexOf($l)){if(0<=$i&&1<$A-$i&&($k=$d.substr($i,$A-$i),$W.push($k)),'"'==$l||"'"==$l){var $o=$d.indexOf($l,$A+1);if($o<0)throw"Sharder err:"+$d;$W.push($d.substr($A+1,$o-$A-1)),$A=$o,$i=-1;continue;}"("==$l&&$t&&0<$W.length&&($k=$W[$W.length-1]+";","vec4;main;".indexOf($k)<0&&($t.useFuns+=$k)),$i=-1;}else $i<0&&($i=$A);return $i<$B&&1<$B-$i&&($k=$d.substr($i,$B-$i),$W.push($k)),$W;},$g.IFDEF_NO=0,$g.IFDEF_YES=1,$g.IFDEF_ELSE=2,$g.IFDEF_PARENT=3,$g._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$g._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$g._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$g.includes={},$A($g,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g");}]),$g.__init$=function(){$e=function(){function $l($d){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$d;}$J($l,"");var $d=$l.prototype;return $d.setParent=function($d){$d.childs.push(this),this.z=$d.z+1,this.parent=$d;},$d.setCondition=function($d,$t){$d&&(this.conditionType=$t,$d=$d.replace(/(\s*$)/g,""),this.condition=function(){return this[$d];},this.condition.__condition=$d);},$d.toscript=function($d,$t){return this._toscript($d,$t,++$l.__id);},$d._toscript=function($k,$W,$i){if(this.childs.length<1&&!this.text)return $W;$W.length;if(this.condition){var $d=!!this.condition.call($k);if(2===this.conditionType&&($d=!$d),!$d)return $W;}if(this.text&&$W.push(this.text),0<this.childs.length&&this.childs.forEach(function($d,$t,$l){$d._toscript($k,$W,$i);}),0<this.includefiles.length&&0<this.useFuns.length)for(var $t,$l=0,$A=this.includefiles.length;$l<$A;$l++)this.includefiles[$l].curUseID!=$i&&0<($t=this.includefiles[$l].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$l].curUseID=$i,$W[0]=$t+$W[0]);return $W;},$l.__id=1,$l;}(),$l=function(){function $d($d){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$d;for(var $t=0,$l=0,$k=0;!(($t=$d.indexOf("#begin",$t))<0);){for($k=$t+5;!(($k=$d.indexOf("#end",$k))<0)&&"i"===$d.charAt($k+4);)$k+=5;if($k<0)throw"add include err,no #end:"+$d;$l=$d.indexOf("\n",$t);var $W=$g.splitToWords($d.substr($t,$l-$t),null);"code"==$W[1]?this.codes[$W[2]]=$d.substr($l+1,$k-$l-1):"function"==$W[1]&&($l=$d.indexOf("function",$t),$l+="function".length,this.funs[$W[3]]=$d.substr($l+1,$k-$l-1),this.funnames+=$W[3]+";"),$t=$k+1;}}$J($d,"");var $t=$d.prototype;return $t.getWith=function($d){var $t=$d?this.codes[$d]:this.script;if(!$t)throw"get with error:"+$d;return $t;},$t.getFunsScript=function($d){var $t="";for(var $l in this.funs)0<=$d.indexOf($l+";")&&($t+=this.funs[$l]);return $t;},$d;}();},$g;}(),$Hd=function(){function $A(){}return $J($A,"laya.webgl.WebGL"),$A._uint8ArraySlice=function(){for(var $d=this.length,$t=new Uint8Array(this.length),$l=0;$l<$d;$l++)$t[$l]=this[$l];return $t;},$A._float32ArraySlice=function(){for(var $d=this.length,$t=new Float32Array(this.length),$l=0;$l<$d;$l++)$t[$l]=this[$l];return $t;},$A._uint16ArraySlice=function($d){var $t,$l=arguments,$k=0,$W=0;if(0===$l.length)for($k=this.length,$t=new Uint16Array($k),$W=0;$W<$k;$W++)$t[$W]=this[$W];else if(2===$l.length){var $i=$l[0],$A=$l[1];if($i<$A)for($k=$A-$i,$t=new Uint16Array($k),$W=$i;$W<$A;$W++)$t[$W-$i]=this[$W];else $t=new Uint16Array(0);}return $t;},$A.expandContext=function(){var $d=$W.prototype,$t=CanvasRenderingContext2D.prototype;$t.fillTrangles=$d.fillTrangles,$Od.__int__(null),$t.setIBVB=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){void 0===$o&&($o=0),void 0===$I&&($I=0),null===$l&&(this._ib=this._ib||$_d.QuadrangleIB,$l=this._ib,$Dd.expandIBQuadrangle($l,$k._byteLength/64+8)),this._setIBVB($d,$t,$l,$k,$W,$i,$A,$B,$o,$I);},$t.fillTrangles=function($d,$t,$l,$k,$W){this._curMat=this._curMat||$$.create(),this._vb=this._vb||$vd.create(),this._ib||(this._ib=$_d.create(),$Dd.fillIBQuadrangle(this._ib,$A/4));var $i=this._vb,$A=$k.length>>4;$Dd.fillTranglesVB($i,$t,$l,$k,$W||this._curMat,0,0),$Dd.expandIBQuadrangle(this._ib,$i._byteLength/64+8);var $B=new $Ld(1,0);$B.textureHost=$d;var $o=new $ad("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$i._vertType=3,this._setIBVB($t,$l,this._ib,$i,6*$A,$W,$o,$B,0,0);};},$A.enable=function(){if($c.__init__(),$z.isConchApp&&!$z.isConchWebGL)return $R.skinAniSprite=function(){return new $dd();},$A.expandContext(),!1;if($R.getWebGLContext=function($d){for(var $t,$l=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$k=0;$k<$l.length;$k++){try{$t=$d.getContext($l[$k],{stencil:$q.isStencil,alpha:$q.isAlpha,antialias:$q.isAntialias,premultipliedAlpha:$q.premultipliedAlpha,preserveDrawingBuffer:$q.preserveDrawingBuffer});}catch($d){}if($t)return $t;}return null;},null==($A.mainContext=$A.mainContext||$R.getWebGLContext($z._mainCanvas)))return!1;if($z.isWebGL)return!0;$w.create=function($d,$t){return new $dt($d,$t);},$D.create=function($d,$t,$l,$k,$W,$i,$A){return new $Xd($d,$t,$l,$k,$W,$i,$A);},$z.WebGL=$A,$z.isWebGL=!0,$cd.__init__(),$R.createRenderSprite=function($d,$t){return new $$d($d,$t);},$R.createWebGLContext2D=function($d){return new $qd($d);},$R.changeWebGLSize=function($d,$t){laya.webgl.WebGL.onStageResize($d,$t);},$R.createGraphics=function(){return new $Gd();};var $d=$R.createFilterAction;return $R.createFilterAction=$d||function($d){return new $pd();},$R.clear=function($d){$ed.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $t=$z.context.ctx,$l=0==$t._submits._length||$q.preserveDrawingBuffer?$Y.create($d)._color:$r._wgColor;$l&&$t.clearBG($l[0],$l[1],$l[2],$l[3]),$ed.clear();},$R.addToAtlas=function($d,$t){void 0===$t&&($t=!1);var $l=$d.bitmap;$z.optimizeTextureMemory($d.url,$d)?$G.__typeof($l,"laya.webgl.resource.IMergeAtlasBitmap")&&$l.allowMerageInAtlas&&$l.on("recovered",$d,$d.addTextureToAtlas):$l.enableMerageInAtlas=!1;},$R.isAtlas=function($d){return $d instanceof laya.webgl.atlas.AtlasWebGLCanvas;},$U._enable(),$R.beginFlush=function(){for(var $d=$U.instance,$t=$d.getAtlaserCount(),$l=0;$l<$t;$l++){var $k=$d.getAtlaserByIndex($l).texture;$k._flashCacheImageNeedFlush&&$R.flashFlushImage($k);}},$R.drawToCanvas=function($d,$t,$l,$k,$W,$i){($l<=0||$k<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$l|=0,$k|=0,$W|=0,$i|=0;var $A=$Qd.create($l,$k,6408,5121,0,!1);$A.start(),$A.clear(0,0,0,0),$z.context.clear(),$e.renders[$t]._fun($d,$z.context,$W,$ed.height-$k+$i),$z.context.flush(),$A.end();var $B=$A.getData(0,0,$l,$k);if($A.recycle(),$B.byteLength==$l*$k*4){var $o=new $hd();$o._canvas=$c.createElement("canvas"),$o.size($l,$k);var $I=$o._canvas.getContext("2d");$c.canvas.size($l,$k);var $b=$c.context,$f=$b.createImageData($l,$k);return $f.data.set(new Uint8ClampedArray($B.buffer)),$o._imgData=$f,$b.putImageData($f,0,0),$I.save(),$I.translate(0,$k),$I.scale(1,-1),$I.drawImage($c.canvas.source,0,0),$I.restore(),$o;}console.log("drawToCanvas error: w:"+$l+",h:"+$k+",datalen:"+$B.byteLength);},$R.createFilterAction=function($d){var $t;switch($d){case 32:$t=new $pd();}return $t;},$R.addTextureToAtlas=function($d){$d._uvID++,$U._atlasRestore++,$d.bitmap.enableMerageInAtlas&&$U.instance.addToAtlas($d);},$R.getTexturePixels=function($d,$t,$l,$k,$W){$z.context.ctx.clear();var $i=new $T();$i.graphics.drawTexture($d,-$t,-$l);var $A=$Qd.create($k,$W);$A.start(),$A.clear(0,0,0,0),$i.render($z.context,0,0),$z.context.ctx.flush(),$A.end();for(var $B=$A.getData(0,0,$k,$W),$o=[],$I=0,$b=$W-1;0<=$b;$b--)for(var $f=0;$f<$k;$f++)$I=4*($b*$k+$f),$o.push($B[$I]),$o.push($B[$I+1]),$o.push($B[$I+2]),$o.push($B[$I+3]);return $o;},$R.skinAniSprite=function(){return new $dd();},$I.create=function($d,$t){var $l=new $hd();return $l._imgData=$t,$l.flipY=!1,$l;},$L._filterStart=function($d,$t,$l,$k,$W){var $i=$d.getValue("bounds"),$A=$Qd.create($i.width,$i.height);if($A.start(),$A.clear(0,0,0,0),$d.addValue("src",$A),$d.addValue("ScissorTest",$ed.worldScissorTest),$ed.worldScissorTest){var $B=new $M();$B.copyFrom($l.ctx._clipRect),$d.addValue("clipRect",$B),$ed.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089);}},$L._filterEnd=function($d,$t,$l,$k,$W){var $i=$d.getValue("bounds");$d.getValue("src").end();var $A=$Qd.create($i.width,$i.height);$A.start(),$A.clear(0,0,0,0),$d.addValue("out",$A),$t._set$P("_filterCache",$A),$t._set$P("_isHaveGlowFilter",$d.getValue("_isHaveGlowFilter"));},$L._EndTarget=function($d,$t){if($d.getValue("src").recycle(),$d.getValue("out").end(),$d.getValue("ScissorTest")){$ed.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$t.ctx.save();var $l=$d.getValue("clipRect");$t.ctx.clipRect($l.x,$l.y,$l.width,$l.height);}},$L._useSrc=function($d){var $t=$d.getValue("out");$t.end(),($t=$d.getValue("src")).start(),$t.clear(0,0,0,0);},$L._endSrc=function($d){$d.getValue("src").end();},$L._useOut=function($d){var $t=$d.getValue("src");$t.end(),($t=$d.getValue("out")).start(),$t.clear(0,0,0,0);},$L._endOut=function($d){$d.getValue("out").end();},$L._recycleScope=function($d){$d.recycle();},$L._filter=function($d,$t,$l,$k){var $W=this._next;if($W){var $i,$A,$B=$d.filters,$o=$B.length;if(1==$o&&32==$B[0].type)return $t.ctx.save(),$t.ctx.setFilters([$B[0]]),$W._fun.call($W,$d,$t,$l,$k),void $t.ctx.restore();var $I=$Bd.create(),$b=$p.TEMP,$f=$t.ctx._getTransformMatrix(),$J=$$.create();$f.copyTo($J);var $c=0,$Y=0,$w=!1,$D=$d._$P._filterCache?$d._$P._filterCache:null;if(!$D||$d._repaint){$w=$d._isHaveGlowFilter(),$I.addValue("_isHaveGlowFilter",$w),$w&&($c=50,$Y=25),($A=new $M()).copyFrom($d.getSelfBounds()),$A.x+=$d.x,$A.y+=$d.y,$A.x-=$d.pivotX+4,$A.y-=$d.pivotY+4;var $z=$A.x,$e=$A.y;if($A.width+=$c+8,$A.height+=$c+8,$b.x=$A.x*$J.a+$A.y*$J.c,$b.y=$A.y*$J.d+$A.x*$J.b,$A.x=$b.x,$A.y=$b.y,$b.x=$A.width*$J.a+$A.height*$J.c,$b.y=$A.height*$J.d+$A.width*$J.b,$A.width=$b.x,$A.height=$b.y,$A.width<=0||$A.height<=0)return;$D&&$D.recycle(),$I.addValue("bounds",$A);var $g=$Ad.create([$I,$d,$t,0,0],$L._filterStart);$t.addRenderObject($g),$t.ctx._renderKey=0,$t.ctx._shader2D.glTexture=null;var $H=$d.x-$z+$Y,$R=$d.y-$e+$Y;$W._fun.call($W,$d,$t,$H,$R),$g=$Ad.create([$I,$d,$t,0,0],$L._filterEnd),$t.addRenderObject($g);for(var $G=0;$G<$o;$G++){0!=$G&&($g=$Ad.create([$I],$L._useSrc),$t.addRenderObject($g),$i=$Ld.create(1,0),$$.TEMP.identity(),$t.ctx.drawTarget($I,0,0,$A.width,$A.height,$$.TEMP,"out",$i,null,$N.TOINT.overlay),$g=$Ad.create([$I],$L._useOut),$t.addRenderObject($g)),$B[$G].action.apply3d($I,$d,$t,0,0);}$g=$Ad.create([$I,$t],$L._EndTarget),$t.addRenderObject($g);}else{if(($w=!!$d._$P._isHaveGlowFilter&&$d._$P._isHaveGlowFilter)&&($c=50,$Y=25),($A=$d.getBounds()).width<=0||$A.height<=0)return;$A.width+=$c,$A.height+=$c,$b.x=$A.x*$J.a+$A.y*$J.c,$b.y=$A.y*$J.d+$A.x*$J.b,$A.x=$b.x,$A.y=$b.y,$b.x=$A.width*$J.a+$A.height*$J.c,$b.y=$A.height*$J.d+$A.width*$J.b,$A.width=$b.x,$A.height=$b.y,$I.addValue("out",$D);}$l=$l-$Y-$d.x,$k=$k-$Y-$d.y,$b.setTo($l,$k),$J.transformPoint($b),$l=$b.x+$A.x,$k=$b.y+$A.y,$i=$Ld.create(1,0),$$.TEMP.identity(),$t.ctx.drawTarget($I,$l,$k,$A.width,$A.height,$$.TEMP,"out",$i,null,$N.TOINT.overlay),$g=$Ad.create([$I],$L._recycleScope),$t.addRenderObject($g),$J.destroy();}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$A._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$A._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$A._uint8ArraySlice),!0;},$A.onStageResize=function($d,$t){null!=$A.mainContext&&($A.mainContext.viewport(0,0,$d,$t),$ed.width=$d,$ed.height=$t);},$A.onInvalidGLRes=function(){$U.instance.freeAll(),$H.releaseContentManagers(!0),$A.doNodeRepaint($G.stage),$A.mainContext.viewport(0,0,$ed.width,$ed.height),$G.stage.event("devicelost");},$A.doNodeRepaint=function($d){0==$d.numChildren&&$d.repaint();for(var $t=0;$t<$d.numChildren;$t++)$A.doNodeRepaint($d.getChildAt($t));},$A.init=function($d,$t,$l){$A.mainCanvas=$d,$I._createContext=function($d){return new $qd($d);},$hd._createContext=function($d){return new $qd($d);};var $k=laya.webgl.WebGL.mainContext;if(null!=$k.getShaderPrecisionFormat){var $W=$k.getShaderPrecisionFormat(35633,36338),$i=$k.getShaderPrecisionFormat(35632,36338);$A.shaderHighPrecision=!(!$W.precision||!$i.precision);}else $A.shaderHighPrecision=!1;if($A.compressAstc=$k.getExtension("WEBGL_compressed_texture_astc"),$A.compressAtc=$k.getExtension("WEBGL_compressed_texture_atc"),$A.compressEtc=$k.getExtension("WEBGL_compressed_texture_etc"),$A.compressEtc1=$k.getExtension("WEBGL_compressed_texture_etc1"),$A.compressPvrtc=$k.getExtension("WEBGL_compressed_texture_pvrtc"),$A.compressS3tc=$k.getExtension("WEBGL_compressed_texture_s3tc"),$A.compressS3tc_srgb=$k.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$A.compressAstc=$A.compressAstc?$A.compressAstc:{},$A.compressAtc=$A.compressAtc?$A.compressAtc:{},$A.compressEtc=$A.compressEtc?$A.compressEtc:{},$A.compressEtc1=$A.compressEtc1?$A.compressEtc1:{},$A.compressPvrtc=$A.compressPvrtc?$A.compressPvrtc:{},$A.compressS3tc=$A.compressS3tc?$A.compressS3tc:{},$A.compressS3tc_srgb=$A.compressS3tc_srgb?$A.compressS3tc_srgb:{},$k.deleteTexture1=$k.deleteTexture,$k.deleteTexture=function($d){$d==$Rd.curBindTexValue&&($Rd.curBindTexValue=null),$k.deleteTexture1($d);},$A.onStageResize($t,$l),null==$A.mainContext)throw new Error("webGL getContext err!");$C.__init__(),$U.__init__(),$Td.__init__(),$id.__init__(),$qd.__init__(),$Ld.__init__(),$_.__init__(),$Od.__int__($k),$N._init_($k),$z.isConchApp&&conch.setOnInvalidGLRes($A.onInvalidGLRes);},$A.mainCanvas=null,$A.antialias=!0,$A.shaderHighPrecision=!1,$A._bg_null=[0,0,0,0],$A;}(),$Rd=function(){function $k(){}return $J($k,"laya.webgl.WebGLContext"),$k.UseProgram=function($d){return $k._useProgram!==$d&&($Hd.mainContext.useProgram($d),$k._useProgram=$d,!0);},$k.setDepthTest=function($d,$t){$t!==$k._depthTest&&(($k._depthTest=$t)?$d.enable(2929):$d.disable(2929));},$k.setDepthMask=function($d,$t){$t!==$k._depthMask&&($k._depthMask=$t,$d.depthMask($t));},$k.setDepthFunc=function($d,$t){$t!==$k._depthFunc&&($k._depthFunc=$t,$d.depthFunc($t));},$k.setBlend=function($d,$t){$t!==$k._blend&&(($k._blend=$t)?$d.enable(3042):$d.disable(3042));},$k.setBlendFunc=function($d,$t,$l){($t!==$k._sFactor||$l!==$k._dFactor)&&($k._sFactor=$t,$k._dFactor=$l,$d.blendFunc($t,$l));},$k.setCullFace=function($d,$t){$t!==$k._cullFace&&(($k._cullFace=$t)?$d.enable(2884):$d.disable(2884));},$k.setFrontFace=function($d,$t){$t!==$k._frontFace&&($k._frontFace=$t,$d.frontFace($t));},$k.bindTexture=function($d,$t,$l){$d.bindTexture($t,$l),$k.curBindTexTarget=$t,$k.curBindTexValue=$l;},$k.DEPTH_BUFFER_BIT=256,$k.STENCIL_BUFFER_BIT=1024,$k.COLOR_BUFFER_BIT=16384,$k.POINTS=0,$k.LINES=1,$k.LINE_LOOP=2,$k.LINE_STRIP=3,$k.TRIANGLES=4,$k.TRIANGLE_STRIP=5,$k.TRIANGLE_FAN=6,$k.ZERO=0,$k.ONE=1,$k.SRC_COLOR=768,$k.ONE_MINUS_SRC_COLOR=769,$k.SRC_ALPHA=770,$k.ONE_MINUS_SRC_ALPHA=771,$k.DST_ALPHA=772,$k.ONE_MINUS_DST_ALPHA=773,$k.DST_COLOR=774,$k.ONE_MINUS_DST_COLOR=775,$k.SRC_ALPHA_SATURATE=776,$k.FUNC_ADD=32774,$k.BLEND_EQUATION=32777,$k.BLEND_EQUATION_RGB=32777,$k.BLEND_EQUATION_ALPHA=34877,$k.FUNC_SUBTRACT=32778,$k.FUNC_REVERSE_SUBTRACT=32779,$k.BLEND_DST_RGB=32968,$k.BLEND_SRC_RGB=32969,$k.BLEND_DST_ALPHA=32970,$k.BLEND_SRC_ALPHA=32971,$k.CONSTANT_COLOR=32769,$k.ONE_MINUS_CONSTANT_COLOR=32770,$k.CONSTANT_ALPHA=32771,$k.ONE_MINUS_CONSTANT_ALPHA=32772,$k.BLEND_COLOR=32773,$k.ARRAY_BUFFER=34962,$k.ELEMENT_ARRAY_BUFFER=34963,$k.ARRAY_BUFFER_BINDING=34964,$k.ELEMENT_ARRAY_BUFFER_BINDING=34965,$k.STREAM_DRAW=35040,$k.STATIC_DRAW=35044,$k.DYNAMIC_DRAW=35048,$k.BUFFER_SIZE=34660,$k.BUFFER_USAGE=34661,$k.CURRENT_VERTEX_ATTRIB=34342,$k.FRONT=1028,$k.BACK=1029,$k.CULL_FACE=2884,$k.FRONT_AND_BACK=1032,$k.BLEND=3042,$k.DITHER=3024,$k.STENCIL_TEST=2960,$k.DEPTH_TEST=2929,$k.SCISSOR_TEST=3089,$k.POLYGON_OFFSET_FILL=32823,$k.SAMPLE_ALPHA_TO_COVERAGE=32926,$k.SAMPLE_COVERAGE=32928,$k.NO_ERROR=0,$k.INVALID_ENUM=1280,$k.INVALID_VALUE=1281,$k.INVALID_OPERATION=1282,$k.OUT_OF_MEMORY=1285,$k.CW=2304,$k.CCW=2305,$k.LINE_WIDTH=2849,$k.ALIASED_POINT_SIZE_RANGE=33901,$k.ALIASED_LINE_WIDTH_RANGE=33902,$k.CULL_FACE_MODE=2885,$k.FRONT_FACE=2886,$k.DEPTH_RANGE=2928,$k.DEPTH_WRITEMASK=2930,$k.DEPTH_CLEAR_VALUE=2931,$k.DEPTH_FUNC=2932,$k.STENCIL_CLEAR_VALUE=2961,$k.STENCIL_FUNC=2962,$k.STENCIL_FAIL=2964,$k.STENCIL_PASS_DEPTH_FAIL=2965,$k.STENCIL_PASS_DEPTH_PASS=2966,$k.STENCIL_REF=2967,$k.STENCIL_VALUE_MASK=2963,$k.STENCIL_WRITEMASK=2968,$k.STENCIL_BACK_FUNC=34816,$k.STENCIL_BACK_FAIL=34817,$k.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$k.STENCIL_BACK_PASS_DEPTH_PASS=34819,$k.STENCIL_BACK_REF=36003,$k.STENCIL_BACK_VALUE_MASK=36004,$k.STENCIL_BACK_WRITEMASK=36005,$k.VIEWPORT=2978,$k.SCISSOR_BOX=3088,$k.COLOR_CLEAR_VALUE=3106,$k.COLOR_WRITEMASK=3107,$k.UNPACK_ALIGNMENT=3317,$k.PACK_ALIGNMENT=3333,$k.MAX_TEXTURE_SIZE=3379,$k.MAX_VIEWPORT_DIMS=3386,$k.SUBPIXEL_BITS=3408,$k.RED_BITS=3410,$k.GREEN_BITS=3411,$k.BLUE_BITS=3412,$k.ALPHA_BITS=3413,$k.DEPTH_BITS=3414,$k.STENCIL_BITS=3415,$k.POLYGON_OFFSET_UNITS=10752,$k.POLYGON_OFFSET_FACTOR=32824,$k.TEXTURE_BINDING_2D=32873,$k.SAMPLE_BUFFERS=32936,$k.SAMPLES=32937,$k.SAMPLE_COVERAGE_VALUE=32938,$k.SAMPLE_COVERAGE_INVERT=32939,$k.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$k.COMPRESSED_TEXTURE_FORMATS=34467,$k.DONT_CARE=4352,$k.FASTEST=4353,$k.NICEST=4354,$k.GENERATE_MIPMAP_HINT=33170,$k.BYTE=5120,$k.UNSIGNED_BYTE=5121,$k.SHORT=5122,$k.UNSIGNED_SHORT=5123,$k.INT=5124,$k.UNSIGNED_INT=5125,$k.FLOAT=5126,$k.DEPTH_COMPONENT=6402,$k.ALPHA=6406,$k.RGB=6407,$k.RGBA=6408,$k.LUMINANCE=6409,$k.LUMINANCE_ALPHA=6410,$k.UNSIGNED_SHORT_4_4_4_4=32819,$k.UNSIGNED_SHORT_5_5_5_1=32820,$k.UNSIGNED_SHORT_5_6_5=33635,$k.FRAGMENT_SHADER=35632,$k.VERTEX_SHADER=35633,$k.MAX_VERTEX_ATTRIBS=34921,$k.MAX_VERTEX_UNIFORM_VECTORS=36347,$k.MAX_VARYING_VECTORS=36348,$k.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$k.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$k.MAX_TEXTURE_IMAGE_UNITS=34930,$k.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$k.SHADER_TYPE=35663,$k.DELETE_STATUS=35712,$k.LINK_STATUS=35714,$k.VALIDATE_STATUS=35715,$k.ATTACHED_SHADERS=35717,$k.ACTIVE_UNIFORMS=35718,$k.ACTIVE_ATTRIBUTES=35721,$k.SHADING_LANGUAGE_VERSION=35724,$k.CURRENT_PROGRAM=35725,$k.NEVER=512,$k.LESS=513,$k.EQUAL=514,$k.LEQUAL=515,$k.GREATER=516,$k.NOTEQUAL=517,$k.GEQUAL=518,$k.ALWAYS=519,$k.KEEP=7680,$k.REPLACE=7681,$k.INCR=7682,$k.DECR=7683,$k.INVERT=5386,$k.INCR_WRAP=34055,$k.DECR_WRAP=34056,$k.VENDOR=7936,$k.RENDERER=7937,$k.VERSION=7938,$k.NEAREST=9728,$k.LINEAR=9729,$k.NEAREST_MIPMAP_NEAREST=9984,$k.LINEAR_MIPMAP_NEAREST=9985,$k.NEAREST_MIPMAP_LINEAR=9986,$k.LINEAR_MIPMAP_LINEAR=9987,$k.TEXTURE_MAG_FILTER=10240,$k.TEXTURE_MIN_FILTER=10241,$k.TEXTURE_WRAP_S=10242,$k.TEXTURE_WRAP_T=10243,$k.TEXTURE_2D=3553,$k.TEXTURE=5890,$k.TEXTURE_CUBE_MAP=34067,$k.TEXTURE_BINDING_CUBE_MAP=34068,$k.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$k.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$k.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$k.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$k.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$k.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$k.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$k.TEXTURE0=33984,$k.TEXTURE1=33985,$k.TEXTURE2=33986,$k.TEXTURE3=33987,$k.TEXTURE4=33988,$k.TEXTURE5=33989,$k.TEXTURE6=33990,$k.TEXTURE7=33991,$k.TEXTURE8=33992,$k.TEXTURE9=33993,$k.TEXTURE10=33994,$k.TEXTURE11=33995,$k.TEXTURE12=33996,$k.TEXTURE13=33997,$k.TEXTURE14=33998,$k.TEXTURE15=33999,$k.TEXTURE16=34e3,$k.TEXTURE17=34001,$k.TEXTURE18=34002,$k.TEXTURE19=34003,$k.TEXTURE20=34004,$k.TEXTURE21=34005,$k.TEXTURE22=34006,$k.TEXTURE23=34007,$k.TEXTURE24=34008,$k.TEXTURE25=34009,$k.TEXTURE26=34010,$k.TEXTURE27=34011,$k.TEXTURE28=34012,$k.TEXTURE29=34013,$k.TEXTURE30=34014,$k.TEXTURE31=34015,$k.ACTIVE_TEXTURE=34016,$k.REPEAT=10497,$k.CLAMP_TO_EDGE=33071,$k.MIRRORED_REPEAT=33648,$k.FLOAT_VEC2=35664,$k.FLOAT_VEC3=35665,$k.FLOAT_VEC4=35666,$k.INT_VEC2=35667,$k.INT_VEC3=35668,$k.INT_VEC4=35669,$k.BOOL=35670,$k.BOOL_VEC2=35671,$k.BOOL_VEC3=35672,$k.BOOL_VEC4=35673,$k.FLOAT_MAT2=35674,$k.FLOAT_MAT3=35675,$k.FLOAT_MAT4=35676,$k.SAMPLER_2D=35678,$k.SAMPLER_CUBE=35680,$k.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$k.VERTEX_ATTRIB_ARRAY_SIZE=34339,$k.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$k.VERTEX_ATTRIB_ARRAY_TYPE=34341,$k.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$k.VERTEX_ATTRIB_ARRAY_POINTER=34373,$k.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$k.COMPILE_STATUS=35713,$k.LOW_FLOAT=36336,$k.MEDIUM_FLOAT=36337,$k.HIGH_FLOAT=36338,$k.LOW_INT=36339,$k.MEDIUM_INT=36340,$k.HIGH_INT=36341,$k.FRAMEBUFFER=36160,$k.RENDERBUFFER=36161,$k.RGBA4=32854,$k.RGB5_A1=32855,$k.RGB565=36194,$k.DEPTH_COMPONENT16=33189,$k.STENCIL_INDEX=6401,$k.STENCIL_INDEX8=36168,$k.DEPTH_STENCIL=34041,$k.RENDERBUFFER_WIDTH=36162,$k.RENDERBUFFER_HEIGHT=36163,$k.RENDERBUFFER_INTERNAL_FORMAT=36164,$k.RENDERBUFFER_RED_SIZE=36176,$k.RENDERBUFFER_GREEN_SIZE=36177,$k.RENDERBUFFER_BLUE_SIZE=36178,$k.RENDERBUFFER_ALPHA_SIZE=36179,$k.RENDERBUFFER_DEPTH_SIZE=36180,$k.RENDERBUFFER_STENCIL_SIZE=36181,$k.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$k.COLOR_ATTACHMENT0=36064,$k.DEPTH_ATTACHMENT=36096,$k.STENCIL_ATTACHMENT=36128,$k.DEPTH_STENCIL_ATTACHMENT=33306,$k.NONE=0,$k.FRAMEBUFFER_COMPLETE=36053,$k.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$k.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$k.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$k.FRAMEBUFFER_UNSUPPORTED=36061,$k.FRAMEBUFFER_BINDING=36006,$k.RENDERBUFFER_BINDING=36007,$k.MAX_RENDERBUFFER_SIZE=34024,$k.INVALID_FRAMEBUFFER_OPERATION=1286,$k.UNPACK_FLIP_Y_WEBGL=37440,$k.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$k.CONTEXT_LOST_WEBGL=37442,$k.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$k.BROWSER_DEFAULT_WEBGL=37444,$k._useProgram=null,$k._depthTest=!0,$k._depthMask=!0,$k._blend=!1,$k._cullFace=!1,$k.curBindTexTarget=null,$k.curBindTexValue=null,$A($k,["_depthFunc",function(){return this._depthFunc=513;},"_sFactor",function(){return this._sFactor=1;},"_dFactor",function(){return this._dFactor=0;},"_frontFace",function(){return this._frontFace=2305;}]),$k;}(),$Gd=function($d){function $t(){$t.__super.call(this);}$J($t,"laya.webgl.display.GraphicsGL",$B);var $l=$t.prototype;return $l.setShader=function($d){this._saveToCmd($z.context._setShader,[$d]);},$l.setIBVB=function($d,$t,$l,$k,$W,$i){this._saveToCmd($z.context._setIBVB,[$d,$t,$l,$k,$W,$i]);},$l.drawParticle=function($d,$t,$l){var $k=$R.createParticleTemplate2D($l);$k.x=$d,$k.y=$t,this._saveToCmd($z.context._drawParticle,[$k]);},$t;}(),$qd=function($d){var $l;function $Z($d){this._x=0,this._y=0,this._id=++$Z._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$Z.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$Z.MAXCLIPRECT,this.mOutPoint,this._canvas=$d,this._canvas._addReference(),$Z._contextcount++,$z.isFlash?(this._ib=$_d.create(35044),$Dd.fillIBQuadrangle(this._ib,16)):this._ib=$_d.QuadrangleIB,this.clear();}$J($Z,"laya.webgl.canvas.WebGLContext2D",$W);var $t=$Z.prototype;return $t.setIsMainContext=function(){this._isMain=!0;},$t.clearBG=function($d,$t,$l,$k){var $W=$Hd.mainContext;$W.clearColor($d,$t,$l,$k),$W.clear(16384);},$t._getSubmits=function(){return this._submits;},$t._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $d=0,$t=this._submits._length;$d<$t;$d++)this._submits[$d].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null);}},$t.destroy=function(){--$Z._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$_d.QuadrangleIB&&this._ib.releaseResource();},$t.clear=function(){this._submits||(this._other=$l.DEFAULT,this._curMat=$$.create(),this._vb=$vd.create(-1),this._submits=[],this._save=[$m.Create(this)],this._save.length=10,this._shader2D=new $_(),this._triangleMesh=$xd.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$l.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$Z.MAXCLIPRECT,this._curSubmit=$id.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$u.DEFAULT;for(var $d=0,$t=this._submits._length;$d<$t;$d++)this._submits[$d].releaseRender(),this._submits[$d]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1;},$t.size=function($d,$t){if(this._width!=$d||this._height!=$t)if(0==$d||0==$t){0!=this._vb._byteLength&&(this._width=$d,this._height=$t,this._vb.clear(),this._vb.upload());for(var $l=0,$k=this._submits._length;$l<$k;$l++)this._submits[$l].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null;}else this._width=$d,this._height=$t,this._targets&&this._targets.size($d,$t),this._canvas.memorySize-=this._canvas.memorySize;0===$d&&0===$t&&this._releaseMem();},$t._getTransformMatrix=function(){return this._curMat;},$t.translate=function($d,$t){0===$d&&0===$t||($F.save(this),this._curMat.bTransform&&($O.save(this),this._curMat.transformPointN($p.TEMP.setTo($d,$t)),$d=$p.TEMP.x,$t=$p.TEMP.y),this._x+=$d,this._y+=$t);},$t.save=function(){this._save[this._save._length++]=$m.Create(this);},$t.restore=function(){var $d=this._save._length;if(!($d<1))for(var $t=$d-1;0<=$t;$t--){var $l=this._save[$t];if($l.restore(this),$l.isSaveMark())return void(this._save._length=$t);}},$t._fillText=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){void 0===$I&&($I=0);var $b=this._shader2D,$f=this._curSubmit.shaderValue,$J=$W?$Yd.create($W):this._other.font;if($U.enabled)$b.ALPHA!==$f.ALPHA&&($b.glTexture=null),$cd.drawText(this,$d,$t,this._curMat,$J,$o||this._other.textAlign,$i,$A,$B,$l,$k,$I);else{this._shader2D.defines.getValue();var $c=$i?$Y.create($i)._color:$b.colorAdd;$b.ALPHA===$f.ALPHA&&$c===$b.colorAdd&&$f.colorAdd===$b.colorAdd||($b.glTexture=null,$b.colorAdd=$c),$cd.drawText(this,$d,$t,this._curMat,$J,$o||this._other.textAlign,$i,$A,$B,$l,$k,$I);}},$t.fillWords=function($d,$t,$l,$k,$W,$i){this._fillText(null,$d,$t,$l,$k,$W,null,-1,null,$i);},$t.fillBorderWords=function($d,$t,$l,$k,$W,$i,$A){this._fillBorderText(null,$d,$t,$l,$k,$W,$i,$A,null);},$t.fillText=function($d,$t,$l,$k,$W,$i){this._fillText($d,null,$t,$l,$k,$W,null,-1,$i);},$t.strokeText=function($d,$t,$l,$k,$W,$i,$A){this._fillText($d,null,$t,$l,$k,null,$W,$i||1,$A);},$t.fillBorderText=function($d,$t,$l,$k,$W,$i,$A,$B){this._fillBorderText($d,null,$t,$l,$k,$W,$i,$A,$B);},$t._fillBorderText=function($d,$t,$l,$k,$W,$i,$A,$B,$o){if(!$U.enabled)return this._fillText($d,$t,$l,$k,$W,null,$A,$B||1,$o),void this._fillText($d,$t,$l,$k,$W,$i,null,-1,$o);var $I=this._shader2D,$b=this._curSubmit.shaderValue;$I.ALPHA!==$b.ALPHA&&($I.glTexture=null);var $f=$W?($Z._fontTemp.setFont($W),$Z._fontTemp):this._other.font;$cd.drawText(this,$d,$t,this._curMat,$f,$o||this._other.textAlign,$i,$A,$B||1,$l,$k,0);},$t.fillRect=function($d,$t,$l,$k,$W){var $i=this._vb;if($Dd.fillRectImgVb($i,this._clipRect,$d,$t,$l,$k,$x.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $A=this._shader2D.fillStyle;$W&&(this._shader2D.fillStyle=$u.create($W));var $B=this._shader2D,$o=this._curSubmit.shaderValue;if($B.fillStyle!==$o.fillStyle||$B.ALPHA!==$o.ALPHA){$B.glTexture=null;var $I=this._curSubmit=$id.createSubmit(this,this._ib,$i,($i._byteLength-64)/32*3,$Ld.create(2,0));$I.shaderValue.color=$B.fillStyle._color._color,$I.shaderValue.ALPHA=$B.ALPHA,this._submits[this._submits._length++]=$I;}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$A;}},$t.fillTexture=function($d,$t,$l,$k,$W,$i,$A,$B){if($d.loaded&&$d.bitmap&&$d.source){var $o=this._vb,$I=$d.bitmap.width,$b=$d.bitmap.height,$f=$d.uv,$J=$A.x%$d.width,$c=$A.y%$d.height;if($I!=$B.w||$b!=$B.h){if(!$B.w&&!$B.h)switch($B.oy=$B.ox=0,$i){case"repeat":$B.width=$k,$B.height=$W;break;case"repeat-x":$B.width=$k,$c<0?$d.height+$c>$W?$B.height=$W:$B.height=$d.height+$c:($B.oy=$c,$d.height+$c>$W?$B.height=$W-$c:$B.height=$d.height);break;case"repeat-y":$J<0?$d.width+$J>$k?$B.width=$k:$B.width=$d.width+$J:($B.ox=$J,$d.width+$J>$k?$B.width=$k-$J:$B.width=$d.width),$B.height=$W;break;case"no-repeat":$J<0?$d.width+$J>$k?$B.width=$k:$B.width=$d.width+$J:($B.ox=$J,$d.width+$J>$k?$B.width=$k-$J:$B.width=$d.width),$c<0?$d.height+$c>$W?$B.height=$W:$B.height=$d.height+$c:($B.oy=$c,$d.height+$c>$W?$B.height=$W-$c:$B.height=$d.height);break;default:$B.width=$k,$B.height=$W;}$B.w=$I,$B.h=$b,$B.uv=[0,0,$B.width/$I,0,$B.width/$I,$B.height/$b,0,$B.height/$b];}if($t+=$B.ox,$l+=$B.oy,$J-=$B.ox,$c-=$B.oy,$Dd.fillRectImgVb($o,this._clipRect,$t,$l,$B.width,$B.height,$B.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $Y=$Kd.create(this,this._ib,$o,($o._byteLength-64)/32*3,$Ld.create(256,0)),$w=(this._submits[this._submits._length++]=$Y).shaderValue;$w.textureHost=$d;var $D=$f[0]*$I,$z=$f[1]*$b,$e=($f[2]-$f[0])*$I,$g=($f[5]-$f[3])*$b,$H=-$J/$I,$R=-$c/$b;$w.u_TexRange[0]=$D/$I,$w.u_TexRange[1]=$e/$I,$w.u_TexRange[2]=$z/$b,$w.u_TexRange[3]=$g/$b,$w.u_offset[0]=$H,$w.u_offset[1]=$R,$U.enabled&&!this._isMain&&$Y.addTexture($d,($o._byteLength>>2)-16),(this._curSubmit=$Y)._renderType=10017,$Y._numEle+=6;}}else this.sprite&&$G.timer.callLater(this,this._repaintSprite);},$t.setShader=function($d){$s.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$d;},$t.setFilters=function($d){$s.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$d,this._curSubmit=$id.RENDERBASE,this._renderKey=0,this._drawCount++;},$t.drawTexture=function($d,$t,$l,$k,$W,$i,$A){this._drawTextureM($d,$t,$l,$k,$W,$i,$A,null,1);},$t.addTextureVb=function($d,$t,$l){var $k=this._curSubmit._vb||this._vb,$W=$k._byteLength>>2;$k.byteLength=$W+16<<2;for(var $i=$k.getFloat32Array(),$A=0;$A<16;$A+=4)$i[$W++]=$d[$A]+$t,$i[$W++]=$d[$A+1]+$l,$i[$W++]=$d[$A+2],$i[$W++]=$d[$A+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$k._upload=!0;},$t.willDrawTexture=function($d,$t){if(!($d.loaded&&$d.bitmap&&$d.source))return this.sprite&&$G.timer.callLater(this,this._repaintSprite),0;var $l=$d.bitmap,$k=$l.id+this._shader2D.ALPHA*$t+10016;if($k==this._renderKey)return $k;var $W=this._shader2D,$i=$W.ALPHA,$A=this._curSubmit.shaderValue;$W.ALPHA*=$t,this._renderKey=$k,this._drawCount++,$W.glTexture=$l;var $B=this._vb,$o=null,$I=$B._byteLength/32*3,$b=$A.textureHost&&$A.textureHost==$d&&$A.textureHost.alphaTexture==$d.alphaTexture;return $o=$Kd.create(this,this._ib,$B,$I,$Ld.create(1,0)),(this._submits[this._submits._length++]=$o).shaderValue.textureHost=$d,$o._renderType=10016,$o._preIsSameTextureShader=10016===this._curSubmit._renderType&&$W.ALPHA===$A.ALPHA&&$b,this._curSubmit=$o,$W.ALPHA=$i,$k;},$t.drawTextures=function($d,$t,$l,$k){if($d.loaded&&$d.bitmap&&$d.source){var $W=this._clipRect;if(this._clipRect=$Z.MAXCLIPRECT,this._drawTextureM($d,$t[0],$t[1],$d.width,$d.height,$l,$k,null,1)){if(this._clipRect=$W,$S.drawCall++,!($t.length<4)){for(var $i=this._curSubmit._vb||this._vb,$A=this._curMat.a,$B=this._curMat.d,$o=2,$I=$t.length;$o<$I;$o+=2)$Dd.copyPreImgVb($i,($t[$o]-$t[$o-2])*$A,($t[$o+1]-$t[$o-1])*$B),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);}}else alert("drawTextures err");}else this.sprite&&$G.timer.callLater(this,this._repaintSprite);},$t._drawTextureM=function($d,$t,$l,$k,$W,$i,$A,$B,$o){if(!$d.loaded||!$d.source)return this.sprite&&$G.timer.callLater(this,this._repaintSprite),!1;var $I=this._curSubmit._vb||this._vb,$b=$d.bitmap;$t+=$i,$l+=$A,this._drawCount++;var $f=$b.id+this._shader2D.ALPHA*$o+10016;if($f!=this._renderKey){this._renderKey=$f;var $J=this._curSubmit.shaderValue,$c=this._shader2D,$Y=$c.ALPHA;$c.ALPHA*=$o,$c.glTexture=$b;var $w=this._vb,$D=null,$z=$w._byteLength/32*3,$e=$J.textureHost&&$J.textureHost==$d&&$J.textureHost.alphaTexture==$d.alphaTexture;$D=$Kd.create(this,this._ib,$w,$z,$Ld.create(1,0)),(this._submits[this._submits._length++]=$D).shaderValue.textureHost=$d,$D._renderType=10016,$D._preIsSameTextureShader=10016===this._curSubmit._renderType&&$c.ALPHA===$J.ALPHA&&$e,this._curSubmit=$D,$I=this._curSubmit._vb||this._vb,$c.ALPHA=$Y;}return!!$Dd.fillRectImgVb($I,this._clipRect,$t,$l,$k||$d.width,$W||$d.height,$d.uv,$B||this._curMat,this._x,this._y,0,0)&&($U.enabled&&!this._isMain&&this._curSubmit.addTexture($d,($I._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0);},$t._repaintSprite=function(){this.sprite&&this.sprite.repaint();},$t._drawText=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){var $b=$d.bitmap;this._drawCount++;var $f=$b.id+this._shader2D.ALPHA+10016;if($f!=this._renderKey){this._renderKey=$f;var $J=this._curSubmit.shaderValue,$c=this._shader2D;$c.glTexture=$b;var $Y=this._vb,$w=null,$D=$Y._byteLength/32*3,$z=$J.textureHost&&$J.textureHost==$d&&$J.textureHost.alphaTexture==$d.alphaTexture;($w=$U.enabled?$Kd.create(this,this._ib,$Y,$D,$Ld.create(1,0)):$Kd.create(this,this._ib,$Y,$D,$Fd.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$c.ALPHA===$J.ALPHA&&$z,(this._submits[this._submits._length++]=$w).shaderValue.textureHost=$d,$w._renderType=10016,this._curSubmit=$w;}$d.active();var $e=this._curSubmit._vb||this._vb;$Dd.fillRectImgVb($e,this._clipRect,$t+$A,$l+$B,$k||$d.width,$W||$d.height,$d.uv,$i||this._curMat,this._x,this._y,$o,$I,!0)&&($U.enabled&&!this._isMain&&this._curSubmit.addTexture($d,($e._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle));},$t.drawTextureWithTransform=function($d,$t,$l,$k,$W,$i,$A,$B,$o){if($i){var $I=this._curMat,$b=this._x,$f=this._y;(0!==$A||0!==$B)&&(this._x=$A*$I.a+$B*$I.c,this._y=$B*$I.d+$A*$I.b),$i&&$I.bTransform?($$.mul($i,$I,$Z._tmpMatrix),($i=$Z._tmpMatrix)._checkTransform()):(this._x+=$I.tx,this._y+=$I.ty),this._drawTextureM($d,$t,$l,$k,$W,0,0,$i,$o),this._x=$b,this._y=$f;}else this._drawTextureM($d,$t,$l,$k,$W,$A,$B,null,$o);},$t.fillQuadrangle=function($d,$t,$l,$k,$W){var $i=this._curSubmit,$A=this._vb,$B=this._shader2D,$o=$i.shaderValue;if(this._renderKey=0,$d.bitmap){var $I=$d.bitmap;$B.glTexture==$I&&$B.ALPHA===$o.ALPHA||($B.glTexture=$I,($i=this._curSubmit=$id.createSubmit(this,this._ib,$A,$A._byteLength/32*3,$Ld.create(1,0))).shaderValue.glTexture=$I,this._submits[this._submits._length++]=$i),$Dd.fillQuadrangleImgVb($A,$t,$l,$k,$d.uv,$W||this._curMat,this._x,this._y);}else $i.shaderValue.fillStyle&&$i.shaderValue.fillStyle.equal($d)&&$B.ALPHA===$o.ALPHA||($B.glTexture=null,($i=this._curSubmit=$id.createSubmit(this,this._ib,$A,$A._byteLength/32*3,$Ld.create(2,0))).shaderValue.defines.add(2),$i.shaderValue.fillStyle=$u.create($d),this._submits[this._submits._length++]=$i),$Dd.fillQuadrangleImgVb($A,$t,$l,$k,$x.DEF_UV,$W||this._curMat,this._x,this._y);$i._numEle+=6;},$t.drawTexture2=function($d,$t,$l,$k,$W,$i,$A,$B){if(0!=$i){var $o=this._curMat;if(this._x=$d*$o.a+$t*$o.c,this._y=$t*$o.d+$d*$o.b,$W&&($W=$o.bTransform||$W.bTransform?($$.mul($W,$o,$Z._tmpMatrix),$Z._tmpMatrix):(this._x+=$W.tx+$o.tx,this._y+=$W.ty+$o.ty,$$.EMPTY)),1!==$i||$A){var $I=this._shader2D.ALPHA,$b=this._nBlendType;this._shader2D.ALPHA=$i,$A&&(this._nBlendType=$N.TOINT($A)),this._drawTextureM($B[0],$B[1]-$l,$B[2]-$k,$B[3],$B[4],0,0,$W,1),this._shader2D.ALPHA=$I,this._nBlendType=$b;}else this._drawTextureM($B[0],$B[1]-$l,$B[2]-$k,$B[3],$B[4],0,0,$W,1);this._x=this._y=0;}},$t.drawCanvas=function($d,$t,$l,$k,$W){var $i=$d.context;if(this._renderKey=0,$i._targets)this._submits[this._submits._length++]=$Cd.create($i,0,null),this._curSubmit=$id.RENDERBASE,$i._targets.drawTo(this,$t,$l,$k,$W);else{var $A=this._submits[this._submits._length++]=$Cd.create($i,this._shader2D.ALPHA,this._shader2D.filters),$B=$k/$d.width,$o=$W/$d.height,$I=$A._matrix;this._curMat.copyTo($I),1!=$B&&1!=$o&&$I.scale($B,$o);var $b=$I.tx,$f=$I.ty;$I.tx=$I.ty=0,$I.transformPoint($p.TEMP.setTo($t,$l)),$I.translate($p.TEMP.x+$b,$p.TEMP.y+$f),this._curSubmit=$id.RENDERBASE;}$q.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$i._targets?"yellow":"green",this.strokeRect($t-1,$l-1,$k+2,$W+2,1),this.strokeRect($t,$l,$k,$W,1),this.restore());},$t.drawTarget=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){void 0===$I&&($I=-1);var $b=this._vb;if($Dd.fillRectImgVb($b,this._clipRect,$t,$l,$k,$W,$o||$x.DEF_UV,$i||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $f=this._curSubmit=$fd.create(this,this._ib,$b,($b._byteLength-64)/32*3,$B,$A);$f.blendType=-1==$I?this._nBlendType:$I,$f.scope=$d,this._submits[this._submits._length++]=$f,this._curSubmit._numEle+=6;}},$t.mixRGBandAlpha=function($d){return this._mixRGBandAlpha($d,this._shader2D.ALPHA);},$t._mixRGBandAlpha=function($d,$t){var $l=(4278190080&$d)>>>24;return 0!=$l?$l*=$t:$l=255*$t,16777215&$d|$l<<24;},$t.drawTriangles=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){if(!$d.loaded||!$d.source)return this.sprite&&$G.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$d.bitmap;var $b=this._mixRGBandAlpha(4294967295,$B),$f=($k.length,$i.length);this._renderKey=-1;var $J=this._curSubmit=$Kd.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$Ld.create(1,0));return $J.shaderValue.textureHost=$d,$J._renderType=10016,this._submits[this._submits._length++]=$J,$A?($Z._tmpMatrix.a=$A.a,$Z._tmpMatrix.b=$A.b,$Z._tmpMatrix.c=$A.c,$Z._tmpMatrix.d=$A.d,$Z._tmpMatrix.tx=$A.tx+$t,$Z._tmpMatrix.ty=$A.ty+$l,$$.mul($Z._tmpMatrix,this._curMat,$Z._tmpMatrix)):($Z._tmpMatrix.a=this._curMat.a,$Z._tmpMatrix.b=this._curMat.b,$Z._tmpMatrix.c=this._curMat.c,$Z._tmpMatrix.d=this._curMat.d,$Z._tmpMatrix.tx=this._curMat.tx+$t,$Z._tmpMatrix.ty=this._curMat.ty+$l),this._triangleMesh.addData($k,$W,$i,$Z._tmpMatrix,$b,this),this._curSubmit._numEle+=$f,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0;},$t.transform=function($d,$t,$l,$k,$W,$i){$O.save(this),$$.mul($$.TEMP.setTo($d,$t,$l,$k,$W,$i),this._curMat,this._curMat),this._curMat._checkTransform();},$t.setTransformByMatrix=function($d){$d.copyTo(this._curMat);},$t.transformByMatrix=function($d){$O.save(this),$$.mul($d,this._curMat,this._curMat),this._curMat._checkTransform();},$t.rotate=function($d){$O.save(this),this._curMat.rotateEx($d);},$t.scale=function($d,$t){$O.save(this),this._curMat.scaleEx($d,$t);},$t.clipRect=function($d,$t,$l,$k){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $W=$bd.create(4);this.addRenderObject($W);var $i=this._vb,$A=$i._byteLength>>2;if($Dd.fillRectImgVb($i,null,$d,$t,$l,$k,$x.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $B=this._curSubmit=$id.createSubmit(this,this._ib,$i,($i._byteLength-64)/32*3,$Ld.create(2,0));$B.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$B,this._curSubmit._numEle+=6;}else alert("clipRect calc stencil rect error");var $o=$bd.create(5);this.addRenderObject($o);var $I=$i.getFloat32Array(),$b=Math.min(Math.min(Math.min($I[0+$A],$I[4+$A]),$I[8+$A]),$I[12+$A]),$f=Math.max(Math.max(Math.max($I[0+$A],$I[4+$A]),$I[8+$A]),$I[12+$A]),$J=Math.min(Math.min(Math.min($I[1+$A],$I[5+$A]),$I[9+$A]),$I[13+$A]),$c=Math.max(Math.max(Math.max($I[1+$A],$I[5+$A]),$I[9+$A]),$I[13+$A]);$X.save(this,$o,$d,$t,$l,$k,$b,$J,$f-$b,$c-$J),this._curSubmit=$id.RENDERBASE;}else{$l*=this._curMat.a,$k*=this._curMat.d;var $Y=$p.TEMP;this._curMat.transformPoint($Y.setTo($d,$t)),$l<0&&($Y.x=$Y.x+$l,$l=-$l),$k<0&&($Y.y=$Y.y+$k,$k=-$k),this._renderKey=0;var $w=this._curSubmit=$Id.create(this);(this._submits[this._submits._length++]=$w).submitIndex=this._submits._length,$w.submitLength=9999999,$P.save(this,$w);var $D=this._clipRect,$z=$D.x,$e=$D.y,$g=$Y.x+$l,$H=$Y.y+$k;$z<$Y.x&&($D.x=$Y.x),$e<$Y.y&&($D.y=$Y.y),$D.width=Math.min($g,$z+$D.width)-$D.x,$D.height=Math.min($H,$e+$D.height)-$D.y,this._shader2D.glTexture=null,$w.clipRect.copyFrom($D),this._curSubmit=$id.RENDERBASE;}},$t.setIBVB=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b){if(void 0===$o&&($o=0),void 0===$I&&($I=0),void 0===$b&&($b=0),null===$l){if($z.isFlash){var $f=$k;$f._selfIB||($f._selfIB=$_d.create(35044)),$f._selfIB.clear(),$l=$f._selfIB;}else $l=this._ib;$Dd.expandIBQuadrangle($l,$k._byteLength/(4*$k.vertexStride*4));}if(!$B||!$A)throw Error("setIBVB must input:shader shaderValues");var $J=$od.create(this,$k,$l,$W,$A,$B,$o,$I,$b);$i||($i=$$.EMPTY),$i.translate($d,$t),$$.mul($i,this._curMat,$J._mat),$i.translate(-$d,-$t),this._submits[this._submits._length++]=$J,this._curSubmit=$id.RENDERBASE,this._renderKey=0;},$t.addRenderObject=function($d){this._submits[this._submits._length++]=$d;},$t.fillTrangles=function($d,$t,$l,$k,$W){var $i=this._curSubmit,$A=this._vb,$B=this._shader2D,$o=$i.shaderValue,$I=$k.length>>4,$b=$d.bitmap;this._renderKey=0,$B.glTexture==$b&&$B.ALPHA===$o.ALPHA||(($i=this._curSubmit=$id.createSubmit(this,this._ib,$A,$A._byteLength/32*3,$Ld.create(1,0))).shaderValue.textureHost=$d,this._submits[this._submits._length++]=$i),$Dd.fillTranglesVB($A,$t,$l,$k,$W||this._curMat,this._x,this._y),$i._numEle+=6*$I;},$t.submitElement=function($d,$t){var $l=this._submits;for($t<0&&($t=$l._length);$d<$t;)$d+=$l[$d].renderSubmit();},$t.finish=function(){$Hd.mainContext.finish();},$t.flush=function(){var $d=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($d>this._ib.bufferLength/12&&$Dd.expandIBQuadrangle(this._ib,$d),!this._isMain&&$U.enabled&&$U._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$U._atlasRestore;for(var $t=this._submits,$l=0,$k=$t._length;$l<$k;$l++){var $W=$t[$l];10016===$W.getRenderType()&&$W.checkTexture();}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$td.instance&&$td.getInstance().reset();var $i;for($l=0,$i=this.meshlist.length;$l<$i;$l++){var $A=this.meshlist[$l];$A.canReuse?$A.releaseMesh():$A.destroy();}return this.meshlist.length=0,this._curSubmit=$id.RENDERBASE,this._renderKey=0,this._triangleMesh=$xd.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length;},$t.setPathId=function($d){if(this.mId=$d,-1!=this.mId){this.mHaveKey=!1;var $t=$Q.getInstance();$t.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$t.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0);}},$t.movePath=function($d,$t){var $l=$d,$k=$t;$d=this._curMat.a*$l+this._curMat.c*$k+this._curMat.tx,$t=this._curMat.b*$l+this._curMat.d*$k+this._curMat.ty,this.mX+=$d,this.mY+=$t;},$t.beginPath=function(){var $d=this._getPath();$d.tempArray.length=0,$d.closePath=!1,this.mX=0,this.mY=0;},$t.closePath=function(){this._path.closePath=!0;},$t.fill=function($d){void 0===$d&&($d=!1);var $t=this._getPath();this.drawPoly(0,0,$t.tempArray,this.fillStyle._color.numColor,0,0,$d);},$t.stroke=function(){var $d=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$d.drawLine(0,0,$d.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $t=$Q.getInstance().shapeLineDic[this.mId];$t.rebuild($d.tempArray),$d.setGeomtry($t);}else $Q.getInstance().addLine(this.mId,$d.drawLine(0,0,$d.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$d.update();var $l=[this.mX,this.mY],$k=$id.createShape(this,$d.ib,$d.vb,$d.count,$d.offset,$Ld.create(4,0));$k.shaderValue.ALPHA=this._shader2D.ALPHA,$k.shaderValue.u_pos=$l,$k.shaderValue.u_mmat2=$ed.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$k,this._renderKey=-1;}},$t.line=function($d,$t,$l,$k,$W,$i){var $A=this._curSubmit,$B=this._vb;if($Dd.fillLineVb($B,this._clipRect,$d,$t,$l,$k,$W,$i)){this._renderKey=0;var $o=this._shader2D,$I=$A.shaderValue;$o.strokeStyle===$I.strokeStyle&&$o.ALPHA===$I.ALPHA||($o.glTexture=null,($A=this._curSubmit=$id.createSubmit(this,this._ib,$B,($B._byteLength-64)/32*3,$Ld.create(2,0))).shaderValue.strokeStyle=$o.strokeStyle,$A.shaderValue.mainID=2,$A.shaderValue.ALPHA=$o.ALPHA,this._submits[this._submits._length++]=$A),$A._numEle+=6;}},$t.moveTo=function($d,$t,$l){void 0===$l&&($l=!0);var $k=this._getPath();if($l){var $W=$d,$i=$t;$d=this._curMat.a*$W+this._curMat.c*$i,$t=this._curMat.b*$W+this._curMat.d*$i;}$k.addPoint($d,$t);},$t.lineTo=function($d,$t,$l){void 0===$l&&($l=!0);var $k=this._getPath();if($l){var $W=$d,$i=$t;$d=this._curMat.a*$W+this._curMat.c*$i,$t=this._curMat.b*$W+this._curMat.d*$i;}$k.addPoint($d,$t);},$t.drawCurves=function($d,$t,$l){this.setPathId(-1),this.beginPath(),this.strokeStyle=$l[3],this.lineWidth=$l[4];var $k=$l[2];$d+=$l[0],$t+=$l[1],this.movePath($d,$t),this.moveTo($k[0],$k[1]);for(var $W=2,$i=$k.length;$W<$i;)this.quadraticCurveTo($k[$W++],$k[$W++],$k[$W++],$k[$W++]);this.stroke();},$t.arcTo=function($d,$t,$l,$k,$W){if(-1==this.mId||!this.mHaveKey){var $i=0,$A=0,$B=0,$o=this._getPath();this._curMat.copyTo($Z._tmpMatrix),$Z._tmpMatrix.tx=$Z._tmpMatrix.ty=0,$Z._tempPoint.setTo($o.getEndPointX(),$o.getEndPointY()),$Z._tmpMatrix.invertTransformPoint($Z._tempPoint);var $I=$Z._tempPoint.x-$d,$b=$Z._tempPoint.y-$t,$f=Math.sqrt($I*$I+$b*$b);if(!($f<=1e-6)){var $J=$I/$f,$c=$b/$f,$Y=$l-$d,$w=$k-$t,$D=$Y*$Y+$w*$w,$z=Math.sqrt($D);if(!($z<=1e-6)){var $e=$Y/$z,$g=$w/$z,$H=$J+$e,$R=$c+$g,$G=Math.sqrt($H*$H+$R*$R);if(!($G<=1e-6)){var $q=$H/$G,$L=$R/$G,$$=Math.acos($q*$J+$L*$c),$p=Math.PI/2-$$,$M=($f=$W/Math.tan($p))*$J+$d,$T=$f*$c+$t,$r=Math.sqrt($f*$f+$W*$W),$S=$d+$q*$r,$j=$t+$L*$r,$C=0,$K=0;if(0<=$J*$g-$c*$e){var $x=2*$p/$Z.SEGNUM;$C=Math.sin($x),$K=Math.cos($x);}else $x=2*-$p/$Z.SEGNUM,$C=Math.sin($x),$K=Math.cos($x);$A=this._curMat.a*$M+this._curMat.c*$T,$B=this._curMat.b*$M+this._curMat.d*$T,$A==this._path.getEndPointX()&&$B==this._path.getEndPointY()||$o.addPoint($A,$B);var $n=$M-$S,$Q=$T-$j;for($i=0;$i<$Z.SEGNUM;$i++){var $y=$n*$K+$Q*$C,$V=-$n*$C+$Q*$K;$A=$y+$S,$B=$V+$j,$d=this._curMat.a*$A+this._curMat.c*$B,$B=$t=this._curMat.b*$A+this._curMat.d*$B,($A=$d)==this._path.getEndPointX()&&$B==this._path.getEndPointY()||$o.addPoint($A,$B),$n=$y,$Q=$V;}}}}}},$t.arc=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$i&&($i=!1),void 0===$A&&($A=!0),-1!=this.mId){var $B=$Q.getInstance().shapeDic[this.mId];if($B&&this.mHaveKey&&!$B.needUpdate(this._curMat))return;$t=$d=0;}var $o,$I=0,$b=0,$f=0,$J=0,$c=0,$Y=0,$w=0;if($b=$W-$k,$i){if(Math.abs($b)>=2*Math.PI)$b=2*-Math.PI;else for(;0<$b;)$b-=2*Math.PI;}else if(Math.abs($b)>=2*Math.PI)$b=2*Math.PI;else for(;$b<0;)$b+=2*Math.PI;$o=$b/($w=$l<101?Math.max(10,$b*$l/5):$l<201?Math.max(10,$b*$l/20):Math.max(10,$b*$l/40))/2,$f=Math.abs(4/3*(1-Math.cos($o))/Math.sin($o)),$i&&($f=-$f);var $D=this._getPath(),$z=NaN,$e=NaN;for($Y=0;$Y<=$w;$Y++)$I=$k+$b*($Y/$w),$J=$d+Math.cos($I)*$l,$c=$t+Math.sin($I)*$l,$A&&($z=$J,$e=$c,$J=this._curMat.a*$z+this._curMat.c*$e,$c=this._curMat.b*$z+this._curMat.d*$e),$J==this._path.getEndPointX()&&$c==this._path.getEndPointY()||$D.addPoint($J,$c);$J=$d+Math.cos($W)*$l,$c=$t+Math.sin($W)*$l,$A&&($z=$J,$e=$c,$J=this._curMat.a*$z+this._curMat.c*$e,$c=this._curMat.b*$z+this._curMat.d*$e),$J==this._path.getEndPointX()&&$c==this._path.getEndPointY()||$D.addPoint($J,$c);},$t.quadraticCurveTo=function($d,$t,$l,$k){var $W=$f.I,$i=$l,$A=$k;$l=this._curMat.a*$i+this._curMat.c*$A,$k=this._curMat.b*$i+this._curMat.d*$A,$i=$d,$A=$t,$d=this._curMat.a*$i+this._curMat.c*$A,$t=this._curMat.b*$i+this._curMat.d*$A;for(var $B=$W.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$d,$t,$l,$k],30,2),$o=0,$I=$B.length/2;$o<$I;$o++)this.lineTo($B[2*$o],$B[2*$o+1],!1);this.lineTo($l,$k,!1);},$t.rect=function($d,$t,$l,$k){this._other=this._other.make(),this._other.path||(this._other.path=new $h()),this._other.path.rect($d,$t,$l,$k);},$t.strokeRect=function($d,$t,$l,$k,$W){var $i=.5*$W;this.line($d-$i,$t,$d+$l+$i,$t,$W,this._curMat),this.line($d+$l,$t,$d+$l,$t+$k,$W,this._curMat),this.line($d,$t,$d,$t+$k,$W,this._curMat),this.line($d-$i,$t+$k,$d+$l+$i,$t+$k,$W,this._curMat);},$t.clip=function(){},$t.drawPoly=function($d,$t,$l,$k,$W,$i,$A){void 0===$A&&($A=!1),this._renderKey=0,this._shader2D.glTexture=null;var $B=this._getPath();if(-1==this.mId)$B.polygon($d,$t,$l,$k,$W||1,$i);else if(this.mHaveKey){var $o=$Q.getInstance().shapeDic[this.mId];$o.setMatrix(this._curMat),$o.rebuild($B.tempArray),$B.setGeomtry($o);}else{var $I=$B.polygon($d,$t,$l,$k,$W||1,$i);$Q.getInstance().addShape(this.mId,$I),$I.setMatrix(this._curMat);}$B.update();var $b,$f=[this.mX,this.mY];if(($b=$id.createShape(this,$B.ib,$B.vb,$B.count,$B.offset,$Ld.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$b.shaderValue.u_pos=$f,$b.shaderValue.u_mmat2=$ed.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$b,0<$W){if(this.mHaveLineKey){var $J=$Q.getInstance().shapeLineDic[this.mId];$J.rebuild($B.tempArray),$B.setGeomtry($J);}else $Q.getInstance().addShape(this.mId,$B.drawLine($d,$t,$l,$W,$i));$B.update(),($b=$id.createShape(this,$B.ib,$B.vb,$B.count,$B.offset,$Ld.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$b.shaderValue.u_mmat2=$ed.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$b;}},$t.drawParticle=function($d,$t,$l){$l.x=$d,$l.y=$t,this._submits[this._submits._length++]=$l;},$t._getPath=function(){return this._path||(this._path=new $h());},$k(0,$t,"globalCompositeOperation",function(){return $N.NAMES[this._nBlendType];},function($d){var $t=$N.TOINT[$d];null==$t||this._nBlendType===$t||($s.save(this,65536,this,!0),this._curSubmit=$id.RENDERBASE,this._renderKey=0,this._nBlendType=$t);}),$k(0,$t,"strokeStyle",function(){return this._shader2D.strokeStyle;},function($d){this._shader2D.strokeStyle.equal($d)||($s.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$u.create($d));}),$k(0,$t,"globalAlpha",function(){return this._shader2D.ALPHA;},function($d){($d=Math.floor(1e3*$d)/1e3)!=this._shader2D.ALPHA&&($s.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$d);}),$k(0,$t,"asBitmap",null,function($d){if($d){if(this._targets||(this._targets=new $a()),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height);}else this._targets=null;}),$k(0,$t,"fillStyle",function(){return this._shader2D.fillStyle;},function($d){this._shader2D.fillStyle.equal($d)||($s.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$u.create($d));}),$k(0,$t,"textAlign",function(){return this._other.textAlign;},function($d){this._other.textAlign===$d||(this._other=this._other.make(),$s.save(this,32768,this._other,!1),this._other.textAlign=$d);}),$k(0,$t,"lineWidth",function(){return this._other.lineWidth;},function($d){this._other.lineWidth===$d||(this._other=this._other.make(),$s.save(this,256,this._other,!1),this._other.lineWidth=$d);}),$k(0,$t,"textBaseline",function(){return this._other.textBaseline;},function($d){this._other.textBaseline===$d||(this._other=this._other.make(),$s.save(this,16384,this._other,!1),this._other.textBaseline=$d);}),$k(0,$t,"font",null,function($d){$d!=this._other.font.toString()&&(this._other=this._other.make(),$s.save(this,8,this._other,!1),this._other.font===$Yd.EMPTY?this._other.font=new $Yd($d):this._other.font.setFont($d));}),$Z.__init__=function(){$l.DEFAULT=new $l();},$Z._tempPoint=new $p(),$Z._SUBMITVBSIZE=32e3,$Z._MAXSIZE=99999999,$Z._RECTVBSIZE=16,$Z.MAXCLIPRECT=new $M(0,0,99999999,99999999),$Z._COUNT=0,$Z._tmpMatrix=new $$(),$Z.SEGNUM=32,$Z._contextcount=0,$A($Z,["_fontTemp",function(){return this._fontTemp=new $Yd();},"_drawStyleTemp",function(){return this._drawStyleTemp=new $u(null);}]),$Z.__init$=function(){$l=function(){function $d(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$Yd.EMPTY;}$J($d,"");var $t=$d.prototype;return $t.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$Yd.EMPTY;},$t.make=function(){return this===$d.DEFAULT?new $d():this;},$d.DEFAULT=null,$d;}();},$Z;}(),$Ld=function($d){function $k($d,$t){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$k.__super.call(this),this.defines=new $Td(),this.position=$k._POSITION,this.mainID=$d,this.subID=$t,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$d|$t,this._inClassCache=$k._cache[this._cacheID],0<$d&&!this._inClassCache&&(this._inClassCache=$k._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear();}$J($k,"laya.webgl.shader.d2.value.Value2D",$V);var $t=$k.prototype;return $t.setValue=function($d){},$t.refresh=function(){var $d=this.size;return $d[0]=$ed.width,$d[1]=$ed.height,this.alpha=this.ALPHA*$ed.worldAlpha,this.mmat=$ed.worldMatrix4,this;},$t._ShaderWithCompile=function(){return $md.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$ad.create);},$t._withWorldShaderDefines=function(){var $d=$ed.worldShaderDefines,$t=$md.sharders[this.mainID|this.defines._value|$d.getValue()];if(!$t){var $l,$k={};for($l in this.defines.toNameDic())$k[$l]="";for($l in $d.toNameDic())$k[$l]="";$t=$md.withCompile2D(0,this.mainID,$k,this.mainID|this.defines._value|$d.getValue(),$ad.create);}var $W=$ed.worldFilters;if(!$W)return $t;for(var $i,$A=$W.length,$B=0;$B<$A;$B++)($i=$W[$B])&&$i.action.setValue(this);return $t;},$t.upload=function(){var $d=$ed;this.alpha=this.ALPHA*$d.worldAlpha,$ed.worldMatrix4!==$ed.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$Hd.shaderHighPrecision&&this.defines.add(1024);var $t,$l=$d.worldShaderDefines?this._withWorldShaderDefines():$md.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$d.width,this.size[1]=$d.height,this.mmat=$d.worldMatrix4,$nd.activeShader!==$l?$l._shaderValueWidth!==$d.width||$l._shaderValueHeight!==$d.height?($l._shaderValueWidth=$d.width,$l._shaderValueHeight=$d.height):$t=$l._params2dQuick2||$l._make2dQuick2():$l._shaderValueWidth!==$d.width||$l._shaderValueHeight!==$d.height?($l._shaderValueWidth=$d.width,$l._shaderValueHeight=$d.height):$t=$l._params2dQuick1||$l._make2dQuick1(),$l.upload(this,$t);},$t.setFilters=function($d){if(this.filters=$d)for(var $t,$l=$d.length,$k=0;$k<$l;$k++)($t=$d[$k])&&(this.defines.add($t.type),$t.action.setValue(this));},$t.clear=function(){this.defines.setValue(this.subID);},$t.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear();},$k._initone=function($d,$t){$k._typeClass[$d]=$t,$k._cache[$d]=[],$k._cache[$d]._length=0;},$k.__init__=function(){$k._POSITION=[2,5126,!1,4*$wd.BYTES_PE,0],$k._TEXCOORD=[2,5126,!1,4*$wd.BYTES_PE,2*$wd.BYTES_PE],$k._initone(2,$Zd),$k._initone(4,$Nd),$k._initone(256,$Ud),$k._initone(512,$Vd),$k._initone(1,$Ed),$k._initone(65,$Fd),$k._initone(9,$Ed);},$k.create=function($d,$t){var $l=$k._cache[$d|$t];return $l._length?$l[--$l._length]:new $k._typeClass[$d|$t]($t);},$k._POSITION=null,$k._TEXCOORD=null,$k._cache=[],$k._typeClass=[],$k.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$k;}(),$$d=function($d){function $D($d,$t){$D.__super.call(this,$d,$t);}$J($D,"laya.webgl.utils.RenderSprite3D",$e);var $t=$D.prototype;return $t.onCreate=function($d){switch($d){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform);}},$t._mask=function($d,$t,$l,$k){var $W,$i,$A=this._next,$B=$d.mask;if($B){$t.ctx.save();var $o=$t.ctx.globalCompositeOperation,$I=new $M();if($I.copyFrom($B.getBounds()),$I.width=Math.round($I.width),$I.height=Math.round($I.height),$I.x=Math.round($I.x),$I.y=Math.round($I.y),0<$I.width&&0<$I.height){var $b=$d._style._tf,$f=$Bd.create();$f.addValue("bounds",$I),$W=$Ad.create([$f,$t],laya.webgl.utils.RenderSprite3D.tmpTarget),$t.addRenderObject($W),$B.render($t,-$I.x,-$I.y),$W=$Ad.create([$f],laya.webgl.utils.RenderSprite3D.endTmpTarget),$t.addRenderObject($W),$t.ctx.save(),$t.clipRect($l-$b.translateX+$I.x,$k-$b.translateY+$I.y,$I.width,$I.height),$A._fun.call($A,$d,$t,$l,$k),$t.ctx.restore(),$i=$bd.create(6),$o=$t.ctx.globalCompositeOperation,$i.blendMode="mask",$t.addRenderObject($i),$$.TEMP.identity();var $J=$Ld.create(1,0),$c=$x.INV_UV,$Y=$I.width,$w=$I.height;($I.width<32||$I.height<32)&&(($c=$D.tempUV)[0]=0,$c[1]=0,$c[2]=32<=$I.width?1:$I.width/32,$c[3]=0,$c[4]=32<=$I.width?1:$I.width/32,$c[5]=32<=$I.height?1:$I.height/32,$c[6]=0,$c[7]=32<=$I.height?1:$I.height/32,$I.width=32<=$I.width?$I.width:32,$I.height=32<=$I.height?$I.height:32,$c[1]*=-1,$c[3]*=-1,$c[5]*=-1,$c[7]*=-1,$c[1]+=1,$c[3]+=1,$c[5]+=1,$c[7]+=1),$t.ctx.drawTarget($f,$l+$I.x-$b.translateX,$k+$I.y-$b.translateY,$Y,$w,$$.TEMP,"tmpTarget",$J,$c,6),$W=$Ad.create([$f],laya.webgl.utils.RenderSprite3D.recycleTarget),$t.addRenderObject($W),($i=$bd.create(6)).blendMode=$o,$t.addRenderObject($i);}$t.ctx.restore();}else $A._fun.call($A,$d,$t,$l,$k);},$t._blend=function($d,$t,$l,$k){var $W=$d._style,$i=this._next;$W.blendMode?($t.ctx.save(),$t.ctx.globalCompositeOperation=$W.blendMode,$i._fun.call($i,$d,$t,$l,$k),$t.ctx.restore()):$i._fun.call($i,$d,$t,$l,$k);},$t._transform=function($d,$t,$l,$k){var $W=$d.transform,$i=this._next;if($W&&$i!=$e.NORENDER){var $A=$t.ctx;$d._style;$W.tx=$l,$W.ty=$k;var $B=$A._getTransformMatrix(),$o=$B.clone();$$.mul($W,$B,$B),$B._checkTransform(),$W.tx=$W.ty=0,$i._fun.call($i,$d,$t,0,0),$o.copyTo($B),$o.destroy();}else $i._fun.call($i,$d,$t,$l,$k);},$D.tmpTarget=function($d,$t){var $l=$d.getValue("bounds"),$k=$Qd.create($l.width,$l.height);$k.start(),$k.clear(0,0,0,0),$d.addValue("tmpTarget",$k);},$D.endTmpTarget=function($d){$d.getValue("tmpTarget").end();},$D.recycleTarget=function($d){$d.getValue("tmpTarget").recycle(),$d.recycle();},$A($D,["tempUV",function(){return this.tempUV=new Array(8);}]),$D;}(),$pd=function($d){function $t(){this.data=null,$t.__super.call(this);}$J($t,"laya.filters.webgl.ColorFilterActionGL",$y);var $l=$t.prototype;return $G.imps($l,{"laya.filters.IFilterActionGL":!0}),$l.setValue=function($d){$d.colorMat=this.data._mat,$d.colorAlpha=this.data._alpha;},$l.apply3d=function($d,$t,$l,$k,$W){var $i=$d.getValue("bounds"),$A=$Ld.create(1,0);$A.setFilters([this.data]);var $B=$$.TEMP;$B.identity(),$l.ctx.drawTarget($d,0,0,$i.width,$i.height,$B,"src",$A);},$t;}(),$Md=function($d){function $i($d,$t,$l,$k,$W){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$i.__super.call(this,$d,$t,$W),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $ud(),this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$l,this._atlasCanvas.height=$k,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0;}$J($i,"laya.webgl.atlas.Atlaser",$Z);var $t=$i.prototype;return $t.computeUVinAtlasTexture=function($d,$t,$l,$k){var $W=$U.atlasTextureWidth,$i=$U.atlasTextureHeight,$A=$l/$W,$B=$k/$i,$o=($l+$d.bitmap.width)/$W,$I=($k+$d.bitmap.height)/$i,$b=$d.bitmap.width/$W,$f=$d.bitmap.height/$i;$d.uv=[$A+$t[0]*$b,$B+$t[1]*$f,$o-(1-$t[2])*$b,$B+$t[3]*$f,$o-(1-$t[4])*$b,$I-(1-$t[5])*$f,$A+$t[6]*$b,$I-(1-$t[7])*$f];},$t.findBitmapIsExist=function($d){if($d instanceof laya.webgl.resource.WebGLImage){var $t=$d,$l=$t.url,$k=this._InAtlasWebGLImagesKey[$l||$t.id];if($k)return $k.offsetInfoID;}return-1;},$t.addToAtlasTexture=function($d,$t,$l){if($d instanceof laya.webgl.resource.WebGLImage){var $k=$d,$W=$k.url;this._InAtlasWebGLImagesKey[$W||$k.id]={bitmap:$d,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$t,$l]);}this._atlasCanvas.texSubImage2D($t,$l,$d.atlasSource),$d.clearAtlasSource();},$t.addToAtlas=function($d,$t,$l){$d._atlasID=this._inAtlasTextureKey.length;var $k=$d.uv.slice(),$W=$d.bitmap;this._inAtlasTextureKey.push($d),this._inAtlasTextureOriUVValue.push($k),this._inAtlasTextureBitmapValue.push($W),this.computeUVinAtlasTexture($d,$k,$t,$l),$d.bitmap=this._atlasCanvas;},$t.clear=function(){for(var $d=0,$t=this._inAtlasTextureKey.length;$d<$t;$d++)this._inAtlasTextureKey[$d].bitmap=this._inAtlasTextureBitmapValue[$d],this._inAtlasTextureKey[$d].uv=this._inAtlasTextureOriUVValue[$d],this._inAtlasTextureKey[$d]._atlasID=-1,this._inAtlasTextureKey[$d].bitmap.lock=!1,this._inAtlasTextureKey[$d].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0;},$t.dispose=function(){this.clear(),this._atlasCanvas.destroy();},$k(0,$t,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue;}),$k(0,$t,"texture",function(){return this._atlasCanvas;}),$k(0,$t,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey;}),$i;}(),$Td=function($d){function $l(){$l.__super.call(this,$l.__name2int,$l.__int2name,$l.__int2nameMap);}return $J($l,"laya.webgl.shader.d2.ShaderDefines2D",$v),$l.__init__=function(){$l.reg("TEXTURE2D",1),$l.reg("COLOR2D",2),$l.reg("PRIMITIVE",4),$l.reg("GLOW_FILTER",8),$l.reg("BLUR_FILTER",16),$l.reg("COLOR_FILTER",32),$l.reg("COLOR_ADD",64),$l.reg("WORLDMAT",128),$l.reg("FILLTEXTURE",256),$l.reg("FSHIGHPRECISION",1024),$l.reg("TXTALPHA",2048),$l.reg("TXTCOMPRESS",4096);},$l.reg=function($d,$t){$v._reg($d,$t,$l.__name2int,$l.__int2name);},$l.toText=function($d,$t,$l){return $v._toText($d,$t,$l);},$l.toInt=function($d){return $v._toInt($d,$l.__name2int);},$l.TEXTURE2D=1,$l.COLOR2D=2,$l.PRIMITIVE=4,$l.FILTERGLOW=8,$l.FILTERBLUR=16,$l.FILTERCOLOR=32,$l.COLORADD=64,$l.WORLDMAT=128,$l.FILLTEXTURE=256,$l.SKINMESH=512,$l.SHADERDEFINE_FSHIGHPRECISION=1024,$l.TXTALPHA=2048,$l.TXTCOMPRESS=4096,$l.__name2int={},$l.__int2name=[],$l.__int2nameMap=[],$l;}(),$rd=(function($d){function $B($d,$t,$l,$k,$W,$i,$A){$B.__super.call(this,$d,$t,$l,$k,40,$W,$i,$A);}$J($B,"laya.webgl.shapes.Ellipse",$ld);}(),function($d){function $i($d,$t,$l,$k,$W){this._points=[],this.rebuild($l),$i.__super.call(this,$d,$t,0,0,0,$W,$k,$W,0);}$J($i,"laya.webgl.shapes.Line",$ld);var $t=$i.prototype;return $t.rebuild=function($d){var $t=$d.length;$t!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($t/2-1)),this.mFloat32Array=new Float32Array(5*$t)),this._points.length=0;for(var $l=NaN,$k=NaN,$W=-1,$i=-1,$A=$d.length/2,$B=0;$B<$A;$B++)$l=$d[2*$B],$k=$d[2*$B+1],(.01<Math.abs($W-$l)||.01<Math.abs($i-$k))&&this._points.push($l,$k),$W=$l,$i=$k;},$t.getData=function($d,$t,$l){var $k=[],$W=[];0<this.borderWidth&&this.createLine2(this._points,$k,this.borderWidth,$l,$W,this._points.length/2),this.mUint16Array.set($k,0),this.mFloat32Array.set($W,0),$d.append(this.mUint16Array),$t.append(this.mFloat32Array);},$i;}()),$Sd=function($d){function $f($d,$t,$l,$k,$W){this._points=[];for(var $i=NaN,$A=NaN,$B=-1,$o=-1,$I=$l.length/2-1,$b=0;$b<$I;$b++)$i=$l[2*$b],$A=$l[2*$b+1],(.01<Math.abs($B-$i)||.01<Math.abs($o-$A))&&this._points.push($i,$A),$B=$i,$o=$A;$i=$l[2*$I],$A=$l[2*$I+1],$B=this._points[0],$o=this._points[1],(.01<Math.abs($B-$i)||.01<Math.abs($o-$A))&&this._points.push($i,$A),$f.__super.call(this,$d,$t,0,0,this._points.length/2,0,$k,$W);}$J($f,"laya.webgl.shapes.LoopLine",$ld);var $t=$f.prototype;return $t.getData=function($d,$t,$l){if(0<this.borderWidth){for(var $k=this.color,$W=($k>>16&255)/255,$i=($k>>8&255)/255,$A=(255&$k)/255,$B=[],$o=0,$I=0,$b=[],$f=Math.floor(this._points.length/2),$J=0;$J<$f;$J++)$o=this._points[2*$J],$I=this._points[2*$J+1],$B.push(this.x+$o,this.y+$I,$W,$i,$A);this.createLoopLine($B,$b,this.borderWidth,$l+$B.length/5),$d.append(new Uint16Array($b)),$t.append(new Float32Array($B));}},$t.createLoopLine=function($d,$t,$l,$k,$W,$i){$d.length;var $A=$d.concat(),$B=$W||$d,$o=this.borderColor,$I=($o>>16&255)/255,$b=($o>>8&255)/255,$f=(255&$o)/255,$J=[$A[0],$A[1]],$c=[$A[$A.length-5],$A[$A.length-4]],$Y=$c[0]+.5*($J[0]-$c[0]),$w=$c[1]+.5*($J[1]-$c[1]);$A.unshift($Y,$w,0,0,0),$A.push($Y,$w,0,0,0);var $D,$z,$e,$g,$H,$R,$G,$q,$L,$$,$p,$M,$T,$r,$S,$j,$C,$K,$x,$n,$Q=$A.length/5,$y=$k,$V=$l/2;$e=$A[0],$g=$A[1],$$=$e-($H=$A[5]),$L=($L=-($g-($R=$A[6])))/($n=Math.sqrt($L*$L+$$*$$))*$V,$$=$$/$n*$V,$B.push($e-$L,$g-$$,$I,$b,$f,$e+$L,$g+$$,$I,$b,$f);for(var $Z=1;$Z<$Q-1;$Z++)$e=$A[5*($Z-1)],$g=$A[5*($Z-1)+1],$H=$A[5*$Z],$R=$A[5*$Z+1],$G=$A[5*($Z+1)],$q=$A[5*($Z+1)+1],$$=$e-$H,$M=$H-$G,$S=(-($L=($L=-($g-$R))/($n=Math.sqrt($L*$L+$$*$$))*$V)+$e)*(-($$=$$/$n*$V)+$R)-(-$L+$H)*(-$$+$g),$K=(-($p=($p=-($R-$q))/($n=Math.sqrt($p*$p+$M*$M))*$V)+$G)*(-($M=$M/$n*$V)+$R)-(-$p+$H)*(-$M+$q),$x=($T=-$$+$g-(-$$+$R))*($C=-$p+$H-(-$p+$G))-($j=-$M+$q-(-$M+$R))*($r=-$L+$H-(-$L+$e)),Math.abs($x)<.1?($x+=10.1,$B.push($H-$L,$R-$$,$I,$b,$f,$H+$L,$R+$$,$I,$b,$f)):((($D=($r*$K-$C*$S)/$x)-$H)*($D-$H)+(($z=($j*$S-$T*$K)/$x)-$R)+($z-$R),$B.push($D,$z,$I,$b,$f,$H-($D-$H),$R-($z-$R),$I,$b,$f));$i&&($t=$i);var $U=this.edges+1;for($Z=1;$Z<$U;$Z++)$t.push($y+2*($Z-1),$y+2*($Z-1)+1,$y+2*$Z+1,$y+2*$Z+1,$y+2*$Z,$y+2*($Z-1));return $t.push($y+2*($Z-1),$y+2*($Z-1)+1,$y+1,$y+1,$y,$y+2*($Z-1)),$B;},$f;}(),$jd=function($d){function $A($d,$t,$l,$k,$W,$i){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$$.create(),this._points=$l.slice(0,$l.length),$A.__super.call(this,$d,$t,0,0,this._points.length/2,$k,$W,$i);}$J($A,"laya.webgl.shapes.Polygon",$ld);var $t=$A.prototype;return $t.rebuild=function($d){this._repaint||(this._points.length=0,this._points=this._points.concat($d));},$t.setMatrix=function($d){$d.copyTo(this._mat);},$t.needUpdate=function($d){return this._repaint=this._mat.a==$d.a&&this._mat.b==$d.b&&this._mat.c==$d.c&&this._mat.d==$d.d&&this._mat.tx==$d.tx&&this._mat.ty==$d.ty,!this._repaint;},$t.getData=function($d,$t,$l){var $k,$W=0,$i=this._points,$A=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$l){for(this._start=$l,$k=[],$A=this.earcutTriangles.length,$W=0;$W<$A;$W++)$k.push(this.earcutTriangles[$W]+$l);this.mUint16Array=new Uint16Array($k);}}else{this._start=$l,$k=[];var $B=[],$o=[],$I=this.color,$b=($I>>16&255)/255,$f=($I>>8&255)/255,$J=(255&$I)/255;for($A=Math.floor($i.length/2),$W=0;$W<$A;$W++)$B.push(this.x+$i[2*$W],this.y+$i[2*$W+1],$b,$f,$J),$o.push(this.x+$i[2*$W],this.y+$i[2*$W+1]);for(this.earcutTriangles=$kd.earcut($o,null,2),$A=this.earcutTriangles.length,$W=0;$W<$A;$W++)$k.push(this.earcutTriangles[$W]+$l);this.mUint16Array=new Uint16Array($k),this.mFloat32Array=new Float32Array($B);}$d.append(this.mUint16Array),$t.append(this.mFloat32Array);},$A;}(),$Cd=function($d){function $i(){this._matrix=new $$(),this._matrix4=$wd.defaultMatrix4.concat(),$i.__super.call(this,1e4),this.shaderValue=new $Ld(0,0);}$J($i,"laya.webgl.submit.SubmitCanvas",$id);var $t=$i.prototype;return $t.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $d=$ed.worldAlpha,$t=$ed.worldMatrix4,$l=$ed.worldMatrix,$k=$ed.worldFilters,$W=$ed.worldShaderDefines,$i=this.shaderValue,$A=this._matrix,$B=this._matrix4,$o=$$.TEMP;return $$.mul($A,$l,$o),$B[0]=$o.a,$B[1]=$o.b,$B[4]=$o.c,$B[5]=$o.d,$B[12]=$o.tx,$B[13]=$o.ty,$ed.worldMatrix=$o.clone(),$ed.worldMatrix4=$B,$ed.worldAlpha=$ed.worldAlpha*$i.alpha,$i.filters&&$i.filters.length&&($ed.worldFilters=$i.filters,$ed.worldShaderDefines=$i.defines),this._ctx_src.flush(),$ed.worldAlpha=$d,$ed.worldMatrix4=$t,$ed.worldMatrix.destroy(),$ed.worldMatrix=$l,$ed.worldFilters=$k,$ed.worldShaderDefines=$W,1;},$t.releaseRender=function(){var $d=$i._cache;this._ctx_src=null,$d[$d._length++]=this;},$t.getRenderType=function(){return 10003;},$i.create=function($d,$t,$l){var $k=$i._cache._length?$i._cache[--$i._cache._length]:new $i();$k._ctx_src=$d;var $W=$k.shaderValue;return $W.alpha=$t,$W.defines.setValue(0),$l&&$l.length&&$W.setFilters($l),$k;},$i._cache=(($i._cache=[])._length=0,$i._cache),$i;}(),$Kd=function($d){function $I($d){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array(),this._texsID=new Array(),this._vbPos=new Array(),void 0===$d&&($d=1e4),$I.__super.call(this,$d);}$J($I,"laya.webgl.submit.SubmitTexture",$id);var $t=$I.prototype;return $t.releaseRender=function(){var $d=$I._cache;($d[$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0;},$t.addTexture=function($d,$t){this._texsID[this._texs.length]=$d._uvID,this._texs.push($d),this._vbPos.push($t);},$t.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $d=this.shaderValue.textureHost.bitmap;if(null!==$d)for(var $t=this._vb.getFloat32Array(),$l=0,$k=this._texs.length;$l<$k;$l++){var $W=this._texs[$l];$W.active();var $i=$W.uv;if(this._texsID[$l]!==$W._uvID){this._texsID[$l]=$W._uvID;var $A=this._vbPos[$l];$t[$A+2]=$i[0],$t[$A+3]=$i[1],$t[$A+6]=$i[2],$t[$A+7]=$i[3],$t[$A+10]=$i[4],$t[$A+11]=$i[5],$t[$A+14]=$i[6],$t[$A+15]=$i[7],this._vb.setNeedUpload();}$W.bitmap!==$d&&(this._isSameTexture=!1);}}},$t.renderSubmit=function(){if(0===this._numEle)return $I._shaderSet=!1,1;var $d=this.shaderValue.textureHost;if($d){var $t=$d.source;if(!$d.bitmap||!$t)return $I._shaderSet=!1,1;this.shaderValue.texture=$t,$d.alphaTexture&&$d.alphaTexture.source&&(this.shaderValue.texture1=$d.alphaTexture.source);}this._vb.bind_upload(this._ib);var $l=$Hd.mainContext;if($N.activeBlendFunction!==this._blendFn&&($l.enable(3042),this._blendFn($l),$N.activeBlendFunction=this._blendFn),$S.drawCall++,$S.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$nd.activeShader&&$I._shaderSet?($nd.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$nd.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$I._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $k=$d.bitmap,$W=0,$i=$nd.activeShader,$A=0,$B=this._texs.length;$A<$B;$A++){var $o=this._texs[$A];$o.bitmap===$k&&$A+1!==$B||($i.uploadTexture2D($o.source),$l.drawElements(4,6*($A-$W+1),5123,this._startIdx+6*$W*$wd.BYTES_PIDX),$k=$o.bitmap,$W=$A);}else $l.drawElements(4,this._numEle,5123,this._startIdx);return 1;},$I.create=function($d,$t,$l,$k,$W){var $i=$I._cache._length?$I._cache[--$I._cache._length]:new $I();null==$l&&(($l=$i._selfVb||($i._selfVb=$vd.create(-1))).clear(),$k=0),$i._ib=$t,$i._vb=$l,$i._startIdx=$k*$wd.BYTES_PIDX,$i._numEle=0;var $A=$d._nBlendType;$i._blendFn=$d._targets?$N.targetFns[$A]:$N.fns[$A],$i.shaderValue=$W,$i.shaderValue.setValue($d._shader2D);var $B=$d._shader2D.filters;return $B&&$i.shaderValue.setFilters($B),$i;},$I._cache=(($I._cache=[])._length=0,$I._cache),$I._shaderSet=!0,$I;}(),$xd=function($d){function $z(){$z.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo);}$J($z,"laya.webgl.utils.MeshTexture",$zd);var $t=$z.prototype;return $t.addData=function($d,$t,$l,$k,$W,$i){for(var $A=$d.length/2,$B=this._vb.needSize($A*$z.const_stride)>>2,$o=this._vb.getFloat32Array(),$I=0,$b=0;$b<$A;$b++){var $f=$d[$I],$J=$d[$I+1],$c=$f*$k.a+$J*$k.c+$k.tx,$Y=$f*$k.b+$J*$k.d+$k.ty;$o[$B++]=$c,$o[$B++]=$Y,$o[$B++]=$t[$I],$o[$B++]=$t[$I+1],$I+=2;}this._vb.setNeedUpload();var $w=this.vertNum;if(0<$w){($A=$l.length)>$z.tmpIdx.length&&($z.tmpIdx=new Uint16Array($A));for(var $D=0;$D<$A;$D++)$z.tmpIdx[$D]=$l[$D]+$w;this._ib.appendU16Array($z.tmpIdx,$l.length);}else this._ib.append($l);this._ib.setNeedUpload(),this.vertNum+=$A,this.indexNum+=$l.length;},$t.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this);},$t.destroy=function(){this._ib.destroy(),this._vb.destroy();},$z.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $z();},$z.const_stride=16,$z._POOL=[],$A($z,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8];},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4);}]),$z;}(),$nd=function($d){function $t(){$t.__super.call(this),this.lock=!0;}return $J($t,"laya.webgl.shader.BaseShader",$g),$t.activeShader=null,$t.bindShader=null,$t;}(),$Qd=function($t){function $b($d,$t,$l,$k,$W,$i,$A,$B,$o){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$l&&($l=6408),void 0===$k&&($k=5121),void 0===$W&&($W=34041),void 0===$i&&($i=!1),void 0===$A&&($A=!1),void 0===$B&&($B=-1),void 0===$o&&($o=-1),this._type=1,this._w=$d,this._h=$t,this._surfaceFormat=$l,this._surfaceType=$k,this._depthStencilFormat=$W,$z.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$i,this._repeat=$A,this._minFifter=$B,this._magFifter=$o,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$b.__super.call(this,this.bitmap,$x.INV_UV);}$J($b,"laya.webgl.resource.RenderTarget2D",$t);var $d=$b.prototype;return $G.imps($d,{"laya.resource.IDispose":!0}),$d.getType=function(){return this._type;},$d.getTexture=function(){return this;},$d.size=function($d,$t){this._w==$d&&this._h==$t||(this._w=$d,this._h=$t,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget());},$d.release=function(){this.destroy();},$d.recycle=function(){$b.POOL.push(this);},$d.start=function(){var $d=$Hd.mainContext;return this._preRenderTarget=$ed.curRenderTarget,$ed.curRenderTarget=this,$d.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($d.viewport(0,0,this._w,this._h),this._svWidth=$ed.width,this._svHeight=$ed.height,$ed.width=this._w,$ed.height=this._h,$nd.activeShader=null),this;},$d.clear=function($d,$t,$l,$k){void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=1);var $W=$Hd.mainContext;$W.clearColor($d,$t,$l,$k);var $i=16384;switch(this._depthStencilFormat){case 33189:$i|=256;break;case 36168:$i|=1024;break;case 34041:$i|=256,$i|=1024;}$W.clear($i);},$d.end=function(){var $d=$Hd.mainContext;$d.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$ed.curRenderTarget=this._preRenderTarget,1==this._type?($d.viewport(0,0,this._svWidth,this._svHeight),$ed.width=this._svWidth,$ed.height=this._svHeight,$nd.activeShader=null):$d.viewport(0,0,$G.stage.width,$G.stage.height);},$d.getData=function($d,$t,$l,$k){var $W=$Hd.mainContext;if($W.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$W.checkFramebufferStatus(36160)))return $W.bindFramebuffer(36160,null),null;var $i=new Uint8Array(this._w*this._h*4);return $W.readPixels($d,$t,$l,$k,this._surfaceFormat,this._surfaceType,$i),$W.bindFramebuffer(36160,null),$i;},$d.destroy=function($d){void 0===$d&&($d=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$t.prototype.destroy.call(this));},$d.dispose=function(){},$d._createWebGLRenderTarget=function(){this.bitmap=new $Pd(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($d){this.event("recovered");});},$k(0,$d,"surfaceFormat",function(){return this._surfaceFormat;}),$k(0,$d,"magFifter",function(){return this._magFifter;}),$k(0,$d,"surfaceType",function(){return this._surfaceType;}),$k(0,$d,"mipMap",function(){return this._mipMap;}),$k(0,$d,"depthStencilFormat",function(){return this._depthStencilFormat;}),$k(0,$d,"minFifter",function(){return this._minFifter;}),$k(0,$d,"source",function(){return this._alreadyResolved?$G.superGet($x,this,"source"):null;}),$b.create=function($d,$t,$l,$k,$W,$i,$A,$B,$o){void 0===$l&&($l=6408),void 0===$k&&($k=5121),void 0===$W&&($W=34041),void 0===$i&&($i=!1),void 0===$A&&($A=!1),void 0===$B&&($B=-1),void 0===$o&&($o=-1);var $I=$b.POOL.pop();return $I||($I=new $b($d,$t)),$I.bitmap&&$I._w==$d&&$I._h==$t&&$I._surfaceFormat==$l&&$I._surfaceType==$k&&$I._depthStencilFormat==$W&&$I._mipMap==$i&&$I._repeat==$A&&$I._minFifter==$B&&$I._magFifter==$o||($I._w=$d,$I._h=$t,$I._surfaceFormat=$l,$I._surfaceType=$k,$I._depthStencilFormat=$W,$z.isConchWebGL&&34041===$I._depthStencilFormat&&($I._depthStencilFormat=33189),$I._mipMap=$i,$I._repeat=$A,$I._minFifter=$B,$I._magFifter=$o,$I.release(),$I._createWebGLRenderTarget()),$I;},$b.TYPE2D=1,$b.TYPE3D=2,$b.POOL=[],$b;}($x),$yd=function($d){function $t(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$t.__super.call(this),$t._gl=$Hd.mainContext;}$J($t,"laya.webgl.utils.Buffer",$g);var $l=$t.prototype;return $l._bind=function(){this.activeResource(),$t._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($t._bindVertexBuffer=this._glBuffer),$t._gl.bindBuffer(this._bufferType,$t._bindActive[this._bufferType]=this._glBuffer),$nd.activeShader=null);},$l.recreateResource=function(){this._glBuffer||(this._glBuffer=$t._gl.createBuffer()),this.completeCreate();},$l.disposeResource=function(){this._glBuffer&&($Hd.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0;},$k(0,$l,"bufferUsage",function(){return this._bufferUsage;}),$t._gl=null,$t._bindActive={},$t._bindVertexBuffer=null,$t._enableAtributes=[],$t;}(),$Vd=function($d){function $l($d){this.texcoord=null,this.offsetX=300,this.offsetY=0,$l.__super.call(this,512,0);var $t=8*$wd.BYTES_PE;this.position=[2,5126,!1,$t,0],this.texcoord=[2,5126,!1,$t,2*$wd.BYTES_PE],this.color=[4,5126,!1,$t,4*$wd.BYTES_PE];}return $J($l,"laya.webgl.shader.d2.skinAnishader.SkinSV",$Ld),$l;}(),$Zd=function($d){function $t($d){$t.__super.call(this,2,0),this.color=[];}return $J($t,"laya.webgl.shader.d2.value.Color2dSV",$Ld),$t.prototype.setValue=function($d){$d.fillStyle&&(this.color=$d.fillStyle._color._color),$d.strokeStyle&&(this.color=$d.strokeStyle._color._color);},$t;}(),$Ud=function($d){function $t($d){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$Ld._TEXCOORD,$t.__super.call(this,256,0);}$J($t,"laya.webgl.shader.d2.value.FillTextureSV",$Ld);var $l=$t.prototype;return $l.setValue=function($d){this.ALPHA=$d.ALPHA,$d.filters&&this.setFilters($d.filters);},$l.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$t;}(),$Ed=function($d){function $t($d){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$Ld._TEXCOORD,void 0===$d&&($d=0),$t.__super.call(this,1,$d);}$J($t,"laya.webgl.shader.d2.value.TextureSV",$Ld);var $l=$t.prototype;return $l.setValue=function($d){this.ALPHA=$d.ALPHA,$d.filters&&this.setFilters($d.filters);},$l.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$t;}(),$Nd=function($d){function $t($d){this.a_color=null,this.u_pos=[0,0],$t.__super.call(this,4,0),this.position=[2,5126,!1,5*$wd.BYTES_PE,0],this.a_color=[3,5126,!1,5*$wd.BYTES_PE,2*$wd.BYTES_PE];}return $J($t,"laya.webgl.shader.d2.value.PrimitiveSV",$Ld),$t;}(),$ud=function($d){function $t(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$t.__super.call(this);}$J($t,"laya.webgl.atlas.AtlasWebGLCanvas",$d);var $l=$t.prototype;return $l.recreateResource=function(){var $d=$Hd.mainContext,$t=this._source=$d.createTexture(),$l=$Rd.curBindTexTarget,$k=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,$t),$d.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$d.texParameteri(3553,10241,9729),$d.texParameteri(3553,10240,9729),$d.texParameteri(3553,10242,33071),$d.texParameteri(3553,10243,33071),$l&&$k&&$Rd.bindTexture($d,$l,$k),this.memorySize=this._w*this._h*4,this.completeCreate();},$l.disposeResource=function(){this._source&&($Hd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$l.texSubImage2D=function($d,$t,$l){if($z.isFlash){this._flashCacheImage||(this._flashCacheImage=$w.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $k=$l.bitmapdata;this._flashCacheImage._image.copyPixels($k,0,0,$k.width,$k.height,$d,$t),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0);}else{var $W=$Hd.mainContext,$i=$Rd.curBindTexTarget,$A=$Rd.curBindTexValue;$Rd.bindTexture($W,3553,this._source),$W.pixelStorei(37441,!0),0<=$d-1&&$W.texSubImage2D(3553,0,$d-1,$t,6408,5121,$l),$d+1<=this._w&&$W.texSubImage2D(3553,0,$d+1,$t,6408,5121,$l),0<=$t-1&&$W.texSubImage2D(3553,0,$d,$t-1,6408,5121,$l),$t+1<=this._h&&$W.texSubImage2D(3553,0,$d,$t+1,6408,5121,$l),$W.texSubImage2D(3553,0,$d,$t,6408,5121,$l),$W.pixelStorei(37441,!1),$i&&$A&&$Rd.bindTexture($W,$i,$A);}},$l.texSubImage2DPixel=function($d,$t,$l,$k,$W){var $i=$Hd.mainContext,$A=$Rd.curBindTexTarget,$B=$Rd.curBindTexValue;$Rd.bindTexture($i,3553,this._source);var $o=new Uint8Array($W.data);$i.pixelStorei(37441,!0),$i.texSubImage2D(3553,0,$d,$t,$l,$k,6408,5121,$o),$i.pixelStorei(37441,!1),$A&&$B&&$Rd.bindTexture($i,$A,$B);},$k(0,$l,"width",$d.prototype._$get_width,function($d){this._w=$d;}),$k(0,$l,"height",$d.prototype._$get_height,function($d){this._h=$d;}),$t;}($l),$hd=function($d){function $W(){this.flipY=!0,this.alwaysChange=!1,$W.__super.call(this);}$J($W,"laya.webgl.resource.WebGLCanvas",$l);var $t=$W.prototype;return $t.getCanvas=function(){return this._canvas;},$t.clear=function(){this._ctx&&this._ctx.clear();},$t.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$t._setContext=function($d){this._ctx=$d;},$t.getContext=function($d,$t){return this._ctx?this._ctx:this._ctx=$W._createContext(this);},$t.size=function($d,$t){this._w==$d&&this._h==$t||(this._w=$d,this._h=$t,this._ctx&&this._ctx.size($d,$t),this._canvas&&(this._canvas.height=$t,this._canvas.width=$d));},$t.activeResource=function($d){void 0===$d&&($d=!1),this._source||this.recreateResource();},$t.recreateResource=function(){this.createWebGlTexture(),this.completeCreate();},$t.disposeResource=function(){this._source&&!this.iscpuSource&&($Hd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$t.createWebGlTexture=function(){var $d=$Hd.mainContext;this._canvas;var $t=this._source=$d.createTexture();this.iscpuSource=!1;var $l=$Rd.curBindTexTarget,$k=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,$t),$d.pixelStorei(37440,this.flipY?1:0),$W.premulAlpha&&$d.pixelStorei(37441,!0),$d.texImage2D(3553,0,6408,6408,5121,this._imgData),$W.premulAlpha&&$d.pixelStorei(37441,!1),$d.texParameteri(3553,10240,9729),$d.texParameteri(3553,10241,9729),$d.texParameteri(3553,10242,33071),$d.texParameteri(3553,10243,33071),$d.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$l&&$k&&$Rd.bindTexture($d,$l,$k);},$t.reloadCanvasData=function(){var $d=$Hd.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $t=$Rd.curBindTexTarget,$l=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,this._source),$W.premulAlpha&&$d.pixelStorei(37441,!0),$d.texImage2D(3553,0,6408,6408,5121,this._imgData),$W.premulAlpha&&$d.pixelStorei(37441,!1),$d.pixelStorei(37440,0),$t&&$l&&$Rd.bindTexture($d,$t,$l);},$t.texSubImage2D=function($d,$t,$l){var $k=$Hd.mainContext,$W=$Rd.curBindTexTarget,$i=$Rd.curBindTexValue;$Rd.bindTexture($k,3553,this._source),$k.pixelStorei(37441,!0),$k.texSubImage2D(3553,0,$t,$l,6408,5121,$d._source),$k.pixelStorei(37441,!1),$W&&$i&&$Rd.bindTexture($k,$W,$i);},$t.toBase64=function($d,$t,$l){var $k=null;this._canvas&&($k=this._canvas.toDataURL($d,$t)),$l.call(this,$k);},$k(0,$t,"context",function(){return this._ctx;}),$k(0,$t,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source;}),$k(0,$t,"asBitmap",null,function($d){this._ctx&&(this._ctx.asBitmap=$d);}),$W._createContext=null,$W.premulAlpha=!1,$W;}(),$sd=function($d){function $i($d,$t){this.CborderSize=12,$i.__super.call(this),this.char=$d,this.isSpace=" "===$d,this.xs=$t.scaleX,this.ys=$t.scaleY,this.font=$t.font.toString(),this.fontSize=$t.font.size,this.fillColor=$t.fillColor,this.borderColor=$t.borderColor,this.lineWidth=$t.lineWidth,this.underLine=$t.underLine;var $l,$k=$z.isConchApp;$k?(($l=ConchTextCanvas)._source=ConchTextCanvas,$l._source.canvas=ConchTextCanvas):$l=$c.canvas.source,this.canvas=$l,this._enableMerageInAtlas=!0,this._ctx=$k?$l:this.canvas.getContext("2d",void 0);var $W=$n.measureText(this.char,this.font);this.cw=$W.width*this.xs,this.ch=($W.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $x(this);}$J($i,"laya.webgl.resource.WebGLCharImage",$l);var $t=$i.prototype;return $G.imps($t,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$t.active=function(){this.texture.active();},$t.recreateResource=function(){var $d=$z.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$d){var $t=this.fontSize;1==this.xs&&1==this.ys||($t=parseInt($t*(this.xs>this.ys?this.xs:this.ys)+""));var $l="normal 100 "+this.font;$l=$l.replace($i._fontSizeReg,$t),this.borderColor&&($l+=" 1 "+this.borderColor),this._ctx.font=$l,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null);}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$K.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $k=this._ctx.measureText(this.char);$k||($k={width:16});var $W=$k.width+1;this._ctx.lineTo($W,this.fontSize+1),this._ctx.stroke();}this._ctx.restore();}this.borderSize=this.CborderSize,this.completeCreate();},$t.onresize=function($d,$t){this._w=$d,this._h=$t,this._allowMerageInAtlas=!0;},$t.clearAtlasSource=function(){},$k(0,$t,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$k(0,$t,"atlasSource",function(){return this.canvas;}),$k(0,$t,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($d){this._enableMerageInAtlas=$d;}),$i.createOneChar=function($d,$t){return new $i($d,$t);},$i._fontSizeReg=new RegExp("\\d+(?=px)","g"),$i;}(),$Pd=function($d){function $I($d,$t,$l,$k,$W,$i,$A,$B,$o){void 0===$l&&($l=6408),void 0===$k&&($k=5121),void 0===$W&&($W=34041),void 0===$i&&($i=!1),void 0===$A&&($A=!1),void 0===$B&&($B=-1),void 0===$o&&($o=1),$I.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$d,this._h=$t,this._surfaceFormat=$l,this._surfaceType=$k,this._depthStencilFormat=$W,this._mipMap=$i,this._repeat=$A,this._minFifter=$B,this._magFifter=$o;}$J($I,"laya.webgl.resource.WebGLRenderTarget",$l);var $t=$I.prototype;return $t.recreateResource=function(){var $d=$Hd.mainContext;this._frameBuffer||(this._frameBuffer=$d.createFramebuffer()),this._source||(this._source=$d.createTexture());var $t=$Rd.curBindTexTarget,$l=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,this._source),$d.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $k=this._minFifter,$W=this._magFifter,$i=this._repeat?10497:33071,$A=$b.isPOT(this._w,this._h);if($A?(this._mipMap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$W||($W=9729),$d.texParameteri(3553,10241,$k),$d.texParameteri(3553,10240,$W),$d.texParameteri(3553,10242,$i),$d.texParameteri(3553,10243,$i),this._mipMap&&$d.generateMipmap(3553)):(-1!==$k||($k=9729),-1!==$W||($W=9729),$d.texParameteri(3553,10241,$k),$d.texParameteri(3553,10240,$W),$d.texParameteri(3553,10242,33071),$d.texParameteri(3553,10243,33071)),$d.bindFramebuffer(36160,this._frameBuffer),$d.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$d.createRenderbuffer()),$d.bindRenderbuffer(36161,this._depthStencilBuffer),$d.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$d.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$d.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$d.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$d.bindFramebuffer(36160,null),$t&&$l&&$Rd.bindTexture($d,$t,$l),$d.bindRenderbuffer(36161,null),$A&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate();},$t.disposeResource=function(){this._frameBuffer&&($Hd.mainContext.deleteTexture(this._source),$Hd.mainContext.deleteFramebuffer(this._frameBuffer),$Hd.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null);},$k(0,$t,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$k(0,$t,"frameBuffer",function(){return this._frameBuffer;}),$I;}(),$Xd=function($d){function $B($d,$t,$l,$k,$W,$i,$A){this.offsetX=0,this.offsetY=0,$B.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$i,this.canvas=$d,this._ctx=$d.getContext("2d",void 0),this._w=$k,this._h=$W,this.offsetX=$t,this.offsetY=$l,this.src=$A,this._enableMerageInAtlas=!0,$U.enabled&&this._w<$U.atlasLimitWidth&&this._h<$U.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}$J($B,"laya.webgl.resource.WebGLSubImage",$l);var $t=$B.prototype;return $G.imps($t,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$t.size=function($d,$t){this._w=$d,this._h=$t,this._ctx&&this._ctx.size($d,$t),this.canvas&&(this.canvas.height=$t,this.canvas.width=$d);},$t.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate();},$t.createWebGlTexture=function(){var $d=$Hd.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $t=this._source=$d.createTexture(),$l=$Rd.curBindTexTarget,$k=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,$t),$d.pixelStorei(37441,!0),$d.texImage2D(3553,0,6408,6408,5121,this.canvas),$d.pixelStorei(37441,!1);var $W=this.minFifter,$i=this.magFifter,$A=this.repeat?10497:33071,$B=$b.isPOT(this.width,this.height);$B?(this.mipmap?-1!==$W||($W=9987):-1!==$W||($W=9729),-1!==$i||($i=9729),$d.texParameteri(3553,10240,$i),$d.texParameteri(3553,10241,$W),$d.texParameteri(3553,10242,$A),$d.texParameteri(3553,10243,$A),this.mipmap&&$d.generateMipmap(3553)):(-1!==$W||($W=9729),-1!==$i||($i=9729),$d.texParameteri(3553,10241,$W),$d.texParameteri(3553,10240,$i),$d.texParameteri(3553,10242,33071),$d.texParameteri(3553,10243,33071)),$l&&$k&&$Rd.bindTexture($d,$l,$k),this.canvas=null,$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4;},$t.disposeResource=function(){$U.enabled&&this._allowMerageInAtlas||!this._source||($Hd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$t.clearAtlasSource=function(){},$k(0,$t,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$k(0,$t,"atlasSource",function(){return this.canvas;}),$k(0,$t,"enableMerageInAtlas",function(){return this._allowMerageInAtlas;},function($d){this._allowMerageInAtlas=$d;}),$B;}(),$md=function($d){function $I($d,$t,$l,$k){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$I.__super.call(this),!$d||!$t)throw"Shader Error";this._id=++$I._count,this._vs=$d,this._ps=$t,this._nameMap=$k||{},null!=$l&&($I.sharders[$l]=this);}$J($I,"laya.webgl.shader.Shader",$nd);var $t=$I.prototype;return $t.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0;},$t.disposeResource=function(){$Hd.mainContext.deleteShader(this._vshader),$Hd.mainContext.deleteShader(this._pshader),$Hd.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0;},$t._compile=function(){if(!$Hd.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $d=[this._vs,this._ps],$t=$Hd.mainContext;if(this._program=$t.createProgram(),this._vshader=$I._createShader($t,$d[0],35633),this._pshader=$I._createShader($t,$d[1],35632),$t.attachShader(this._program,this._vshader),$t.attachShader(this._program,this._pshader),$t.linkProgram(this._program),!$z.isConchApp&&!$t.getProgramParameter(this._program,35714))throw $t.getProgramInfoLog(this._program);var $l,$k,$W=0,$i=0;for($i=$z.isConchApp?$t.getProgramParameterEx(this._vs,this._ps,"",35721):$t.getProgramParameter(this._program,35721),$W=0;$W<$i;$W++){var $A=null;$l={vartype:"attribute",glfun:null,ivartype:0,attrib:$A=$z.isConchApp?$t.getActiveAttribEx(this._vs,this._ps,"",$W):$t.getActiveAttrib(this._program,$W),location:$t.getAttribLocation(this._program,$A.name),name:$A.name,type:$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($l);}var $B=0;for($B=$z.isConchApp?$t.getProgramParameterEx(this._vs,this._ps,"",35718):$t.getProgramParameter(this._program,35718),$W=0;$W<$B;$W++){var $o=null;$o=$z.isConchApp?$t.getActiveUniformEx(this._vs,this._ps,"",$W):$t.getActiveUniform(this._program,$W),0<($l={vartype:"uniform",glfun:null,ivartype:1,attrib:$A,location:$t.getUniformLocation(this._program,$o.name),name:$o.name,type:$o.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($l.name=$l.name.substr(0,$l.name.length-3),$l.isArray=!0,$l.location=$t.getUniformLocation(this._program,$l.name)),this._params.push($l);}for($W=0,$k=this._params.length;$W<$k;$W++)if(($l=this._params[$W]).indexOfParams=$W,$l.index=1,$l.value=[$l.location,null],$l.codename=$l.name,$l.name=this._nameMap[$l.codename]?this._nameMap[$l.codename]:$l.codename,(this._paramsMap[$l.name]=$l)._this=this,$l.uploadedValue=[],"attribute"!==$l.vartype)switch($l.type){case 5124:$l.fun=$l.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$l.fun=$l.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$l.fun=$l.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$l.fun=$l.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$l.fun=$l.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$l.fun=this._uniform_sampler2D;break;case 35680:$l.fun=this._uniform_samplerCube;break;case 35676:$l.glfun=$t.uniformMatrix4fv,$l.fun=this._uniformMatrix4fv;break;case 35670:$l.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!");}else $l.fun=this._attribute;}},$t.getUniform=function($d){return this._paramsMap[$d];},$t._attribute=function($d,$t){var $l=$Hd.mainContext,$k=$yd._enableAtributes,$W=$d.location;return $k[$W]||$l.enableVertexAttribArray($W),$l.vertexAttribPointer($W,$t[0],$t[1],$t[2],$t[3],$t[4]+this._offset),$k[$W]=$yd._bindVertexBuffer,1;},$t._uniform1f=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t?($Hd.mainContext.uniform1f($d.location,$l[0]=$t),1):0;},$t._uniform1fv=function($d,$t){if($t.length<4){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($Hd.mainContext.uniform1fv($d.location,$t),$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3],1):0;}return $Hd.mainContext.uniform1fv($d.location,$t),1;},$t._uniform_vec2=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]?($Hd.mainContext.uniform2f($d.location,$l[0]=$t[0],$l[1]=$t[1]),1):0;},$t._uniform_vec2v=function($d,$t){if($t.length<2){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($Hd.mainContext.uniform2fv($d.location,$t),$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3],1):0;}return $Hd.mainContext.uniform2fv($d.location,$t),1;},$t._uniform_vec3=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]?($Hd.mainContext.uniform3f($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2]),1):0;},$t._uniform_vec3v=function($d,$t){return $Hd.mainContext.uniform3fv($d.location,$t),1;},$t._uniform_vec4=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($Hd.mainContext.uniform4f($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3]),1):0;},$t._uniform_vec4v=function($d,$t){return $Hd.mainContext.uniform4fv($d.location,$t),1;},$t._uniformMatrix2fv=function($d,$t){return $Hd.mainContext.uniformMatrix2fv($d.location,!1,$t),1;},$t._uniformMatrix3fv=function($d,$t){return $Hd.mainContext.uniformMatrix3fv($d.location,!1,$t),1;},$t._uniformMatrix4fv=function($d,$t){return $Hd.mainContext.uniformMatrix4fv($d.location,!1,$t),1;},$t._uniform1i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t?($Hd.mainContext.uniform1i($d.location,$l[0]=$t),1):0;},$t._uniform1iv=function($d,$t){return $Hd.mainContext.uniform1iv($d.location,$t),1;},$t._uniform_ivec2=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]?($Hd.mainContext.uniform2i($d.location,$l[0]=$t[0],$l[1]=$t[1]),1):0;},$t._uniform_ivec2v=function($d,$t){return $Hd.mainContext.uniform2iv($d.location,$t),1;},$t._uniform_vec3i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]?($Hd.mainContext.uniform3i($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2]),1):0;},$t._uniform_vec3vi=function($d,$t){return $Hd.mainContext.uniform3iv($d.location,$t),1;},$t._uniform_vec4i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($Hd.mainContext.uniform4i($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3]),1):0;},$t._uniform_vec4vi=function($d,$t){return $Hd.mainContext.uniform4iv($d.location,$t),1;},$t._uniform_sampler2D=function($d,$t){var $l=$Hd.mainContext,$k=$d.uploadedValue;return null==$k[0]?($k[0]=this._curActTexIndex,$l.uniform1i($d.location,this._curActTexIndex),$l.activeTexture($I._TEXTURES[this._curActTexIndex]),$Rd.bindTexture($l,3553,$t),this._curActTexIndex++,1):($l.activeTexture($I._TEXTURES[$k[0]]),$Rd.bindTexture($l,3553,$t),0);},$t._uniform_samplerCube=function($d,$t){var $l=$Hd.mainContext,$k=$d.uploadedValue;return null==$k[0]?($k[0]=this._curActTexIndex,$l.uniform1i($d.location,this._curActTexIndex),$l.activeTexture($I._TEXTURES[this._curActTexIndex]),$Rd.bindTexture($l,34067,$t),this._curActTexIndex++,1):($l.activeTexture($I._TEXTURES[$k[0]]),$Rd.bindTexture($l,34067,$t),0);},$t._noSetValue=function($d){console.log("no....:"+$d.name);},$t.uploadOne=function($d,$t){this.activeResource(),$Rd.UseProgram(this._program);var $l=this._paramsMap[$d];$l.fun.call(this,$l,$t);},$t.uploadTexture2D=function($d){$S.shaderCall++;var $t=$Hd.mainContext;$t.activeTexture(33984),$Rd.bindTexture($t,3553,$d);},$t.uploadTexture2D1=function($d){$S.shaderCall++;var $t=$Hd.mainContext;$t.activeTexture(33985),$Rd.bindTexture($t,3553,$d);},$t.upload=function($d,$t){$nd.activeShader=$nd.bindShader=this,this._lastUseFrameCount===$S.loopCount||this.activeResource(),$Rd.UseProgram(this._program),this._reCompile?($t=this._params,this._reCompile=!1):$t=$t||this._params;$Hd.mainContext;for(var $l,$k,$W=$t.length,$i=0,$A=0;$A<$W;$A++)null!==($k=$d[($l=$t[$A]).name])&&($i+=$l.fun.call(this,$l,$k));$S.shaderCall+=$i;},$t.uploadArray=function($d,$t,$l){$nd.activeShader=this,($nd.bindShader=this).activeResource(),$Rd.UseProgram(this._program);this._params;for(var $k,$W,$i=0,$A=$t-2;0<=$A;$A-=2)($W=this._paramsMap[$d[$A]])&&null!=($k=$d[$A+1])&&($l&&$l[$W.name]&&$l[$W.name].bind(),$i+=$W.fun.call(this,$W,$k));$S.shaderCall+=$i;},$t.getParams=function(){return this._params;},$I.getShader=function($d){return $I.sharders[$d];},$I.create=function($d,$t,$l,$k){return new $I($d,$t,$l,$k);},$I.withCompile=function($d,$t,$l,$k){if($l&&$I.sharders[$l])return $I.sharders[$l];var $W=$I._preCompileShader[2e-4*$d];if(!$W)throw new Error("withCompile shader err!"+$d);return $W.createShader($t,$l,$k);},$I.withCompile2D=function($d,$t,$l,$k,$W){if($k&&$I.sharders[$k])return $I.sharders[$k];var $i=$I._preCompileShader[2e-4*$d+$t];if(!$i)throw new Error("withCompile shader err!"+$d+" "+$t);return $i.createShader($l,$k,$W);},$I.addInclude=function($d,$t){$gd.addInclude($d,$t);},$I.preCompile=function($d,$t,$l,$k){var $W=2e-4*$d;$I._preCompileShader[$W]=new $gd($W,$t,$l,$k);},$I.preCompile2D=function($d,$t,$l,$k,$W){var $i=2e-4*$d+$t;$I._preCompileShader[$i]=new $gd($i,$l,$k,$W);},$I._createShader=function($d,$t,$l){var $k=$d.createShader($l);return $d.shaderSource($k,$t),$d.compileShader($k),$k;},$I._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$I._count=0,$I._preCompileShader={},$I.SHADERNAME2ID=2e-4,$I.sharders=(($I.sharders=[]).length=32,$I.sharders),$A($I,["nameKey",function(){return this.nameKey=new $j();}]),$I;}(),$Od=function($d){function $t(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$t.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id;}$J($t,"laya.webgl.utils.Buffer2D",$d);var $l=$t.prototype;return $l.needSize=function($d){var $t=this._byteLength;if($d){var $l=this._byteLength+$d;$l<=this._buffer.byteLength||this._resizeBuffer($l<<1,!0),this._byteLength=$l;}return $t;},$l._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$S.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$yd._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$yd._gl.bufferSubData(this._bufferType,0,this._buffer);},$l._bufferSubData=function($d,$t,$l){if(void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$S.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$yd._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$t||$l){var $k=this._buffer.slice($t,$l);$yd._gl.bufferSubData(this._bufferType,$d,$k);}else $yd._gl.bufferSubData(this._bufferType,$d,this._buffer);},$l._checkArrayUse=function(){},$l._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0);},$l._bind_subUpload=function($d,$t,$l){return void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($d,$t,$l),!0);},$l._resizeBuffer=function($d,$t){if($d<this._buffer.byteLength)return this;if(this.memorySize=$d,$t&&this._buffer&&0<this._buffer.byteLength){var $l=new ArrayBuffer($d);new Uint8Array($l).set(new Uint8Array(this._buffer),0),this._buffer=$l;}else this._buffer=new ArrayBuffer($d);return this._checkArrayUse(),this._upload=!0,this;},$l.append=function($d){this._upload=!0;var $t,$l;$t=$d.byteLength,$d instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$t,!0),$l=new Uint8Array(this._buffer,this._byteLength)):$d instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$t,!0),$l=new Uint16Array(this._buffer,this._byteLength)):$d instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$t,!0),$l=new Float32Array(this._buffer,this._byteLength)),$l.set($d,0),this._byteLength+=$t,this._checkArrayUse();},$l.appendU16Array=function($d,$t){this._resizeBuffer(this._byteLength+2*$t,!0);for(var $l=new Uint16Array(this._buffer,this._byteLength,$t),$k=0;$k<$t;$k++)$l[$k]=$d[$k];this._byteLength+=2*$t,this._checkArrayUse();},$l.appendEx=function($d,$t){this._upload=!0;var $l;$l=$d.byteLength,this._resizeBuffer(this._byteLength+$l,!0),new $t(this._buffer,this._byteLength).set($d,0),this._byteLength+=$l,this._checkArrayUse();},$l.appendEx2=function($d,$t,$l,$k){void 0===$k&&($k=1),this._upload=!0;var $W,$i;$W=$l*$k,this._resizeBuffer(this._byteLength+$W,!0),$i=new $t(this._buffer,this._byteLength);var $A=0;for($A=0;$A<$l;$A++)$i[$A]=$d[$A];this._byteLength+=$W,this._checkArrayUse();},$l.getBuffer=function(){return this._buffer;},$l.setNeedUpload=function(){this._upload=!0;},$l.getNeedUpload=function(){return this._upload;},$l.upload=function(){var $d=this._bind_upload();return $yd._gl.bindBuffer(this._bufferType,null),$yd._bindActive[this._bufferType]=null,$nd.activeShader=null,$d;},$l.subUpload=function($d,$t,$l){void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0);var $k=this._bind_subUpload();return $yd._gl.bindBuffer(this._bufferType,null),$yd._bindActive[this._bufferType]=null,$nd.activeShader=null,$k;},$l.disposeResource=function(){$d.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0;},$l.clear=function(){this._byteLength=0,this._upload=!0;},$k(0,$l,"bufferLength",function(){return this._buffer.byteLength;}),$k(0,$l,"byteLength",null,function($d){this._byteLength!==$d&&($d<=this._buffer.byteLength||this._resizeBuffer(2*$d+256,!0),this._byteLength=$d);}),$t.__int__=function($d){$_d.QuadrangleIB=$_d.create(35044),$Dd.fillIBQuadrangle($_d.QuadrangleIB,16);},$t.FLOAT32=4,$t.SHORT=2,$t;}($yd),$Fd=(function($t){function $l($d){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$l.__super.call(this,9);}$J($l,"laya.webgl.shader.d2.value.GlowSV",$t);var $d=$l.prototype;$d.setValue=function($d){$t.prototype.setValue.call(this,$d);},$d.clear=function(){$t.prototype.clear.call(this);};}($Ed),function($d){function $t($d){$t.__super.call(this,64),this.defines.add(64);}$J($t,"laya.webgl.shader.d2.value.TextSV",$d);var $l=$t.prototype;return $l.release=function(){($t.pool[$t._length++]=this).clear();},$l.clear=function(){$d.prototype.clear.call(this);},$t.create=function(){return $t._length?$t.pool[--$t._length]:new $t(null);},$t.pool=[],$t._length=0,$t;}($Ed)),$ad=function($d){function $W($d,$t,$l,$k){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$W.__super.call(this,$d,$t,$l,$k);}$J($W,"laya.webgl.shader.d2.Shader2X",$d);var $t=$W.prototype;return $t.upload2dQuick1=function($d){this.upload($d,this._params2dQuick1||this._make2dQuick1());},$t._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $d,$t=this._params,$l=0,$k=$t.length;$l<$k;$l++)$d=$t[$l],($z.isFlash||"size"!==$d.name&&"position"!==$d.name&&"texcoord"!==$d.name)&&this._params2dQuick1.push($d);}return this._params2dQuick1;},$t.disposeResource=function(){$d.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null;},$t.upload2dQuick2=function($d){this.upload($d,this._params2dQuick2||this._make2dQuick2());},$t._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $d,$t=this._params,$l=0,$k=$t.length;$l<$k;$l++)$d=$t[$l],($z.isFlash||"size"!==$d.name)&&this._params2dQuick2.push($d);}return this._params2dQuick2;},$W.create=function($d,$t,$l,$k){return new $W($d,$t,$l,$k);},$W;}($md),$_d=function($d){function $t($d){this._uint8Array=null,this._uint16Array=null,void 0===$d&&($d=35044),$t.__super.call(this),this._bufferUsage=$d,this._bufferType=34963,$z.isFlash||(this._buffer=new ArrayBuffer(8));}$J($t,"laya.webgl.utils.IndexBuffer2D",$Od);var $l=$t.prototype;return $l._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer));},$l.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer));},$l.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer));},$l.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null;},$t.QuadrangleIB=null,$t.create=function($d){return void 0===$d&&($d=35044),new $t($d);},$t;}(),$vd=function($d){function $l($d,$t){this._floatArray32=null,this._vertexStride=0,$l.__super.call(this),this._vertexStride=$d,this._bufferUsage=$t,this._bufferType=34962,$z.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array();}$J($l,"laya.webgl.utils.VertexBuffer2D",$d);var $t=$l.prototype;return $t.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer));},$t.bind=function($d){$d&&$d._bind(),this._bind();},$t.insertData=function($d,$t){this.getFloat32Array().set($d,$t),this._upload=!0;},$t.bind_upload=function($d){$d._bind_upload()||$d._bind(),this._bind_upload()||this._bind();},$t._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));},$t.disposeResource=function(){$d.prototype.disposeResource.call(this);},$t.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null;},$k(0,$t,"vertexStride",function(){return this._vertexStride;}),$l.create=function($d,$t){return void 0===$t&&($t=35048),new $l($d,$t);},$l;}($Od),$dt=function($d){function $B($d,$t,$l,$k,$W,$i){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$l&&($l=6408),void 0===$k&&($k=!0),$B.__super.call(this,$d,$t),$d){if(this._format=$l,this._mipmap=$k,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $d)this._url=$d,this._src=$d,this._image=new $c.window.Image(),$t&&($t.onload&&(this.onload=$t.onload),$t.onerror&&(this.onerror=$t.onerror),$t.onCreate&&$t.onCreate(this)),this._image.crossOrigin=$d&&0==$d.indexOf("data:")?null:"",$d&&(this._image.src=$d);else if($d instanceof ArrayBuffer){this._src=$t,this._url=this._src;var $A=new $o($d);$A.readUTFBytes(4),$A.readUTFBytes(2),$A.getInt16();$A.endian="bigEndian",this._w=$A.getInt16(),this._h=$A.getInt16();$A.getInt16(),$A.getInt16();this._image=new Uint8Array($d,$A.pos),this._format=$Hd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$U.enabled&&this._w<$U.atlasLimitWidth&&this._h<$U.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}else{if(!($d instanceof Uint8Array))return this._src=$t,this._url=this._src,this._image=$d.source||$d,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$t,this._url=this._src,this._w=$W,this._h=$i,this._image=$d,this._format=0===$l?$d.byteLength/($W*$i)==4?6408:6407:$l;}this._$5__enableMerageInAtlas=!0;}}$J($B,"laya.webgl.resource.WebGLImage",$w);var $t=$B.prototype;return $G.imps($t,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$t._init_=function($d,$t){},$t._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $d=$Hd.mainContext,$t=this._source=$d.createTexture(),$l=$Rd.curBindTexTarget,$k=$Rd.curBindTexValue;$Rd.bindTexture($d,3553,$t);var $W=this.minFifter,$i=this.magFifter,$A=this.repeat?10497:33071,$B=$b.isPOT(this._w,this._h),$o=!1;switch($B?(this.mipmap?-1!==$W||($W=9987):-1!==$W||($W=9729),-1!==$i||($i=9729),$d.texParameteri(3553,10241,$W),$d.texParameteri(3553,10240,$i),$d.texParameteri(3553,10242,$A),$d.texParameteri(3553,10243,$A),this.mipmap&&$d.generateMipmap(3553)):(-1!==$W||($W=9729),-1!==$i||($i=9729),$d.texParameteri(3553,10241,$W),$d.texParameteri(3553,10240,$i),$d.texParameteri(3553,10242,33071),$d.texParameteri(3553,10243,33071)),$d.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$d.pixelStorei($d.UNPACK_ALIGNMENT,1),$d.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$d.pixelStorei($d.UNPACK_ALIGNMENT,1),$d.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$o=!0,$d.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $Hd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$o=!0,$d.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}$d.pixelStorei(37441,!1),$l&&$k&&$Rd.bindTexture($d,$l,$k),this.uri||(this.uri=this._url),$o?this.memorySize=this._image.length:$B&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1;},$t.recreateResource=function(){var $d=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;var $t=this;this._image=new $c.window.Image(),this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($t._needReleaseAgain)return $t._needReleaseAgain=!1,$t._image.onload=null,void($t._image=null);$t._allowMerageInAtlas&&$t._enableMerageInAtlas?($d.memorySize=0,$d._recreateLock=!1):$t._createWebGlTexture(),$t.completeCreate();},this._image.src=this._src;}},$t.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$Hd.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0;},$t.onresize=function(){this._w=this._image.width,this._h=this._image.height,$U.enabled&&this._w<$U.atlasLimitWidth&&this._h<$U.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;},$t.clearAtlasSource=function(){this._image=null;},$k(0,$t,"format",function(){return this._format;}),$k(0,$t,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas;},function($d){this._$5__enableMerageInAtlas=$d;}),$k(0,$t,"mipmap",function(){return this._mipmap;}),$k(0,$t,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$k(0,$t,"atlasSource",function(){return this._image;}),$k(0,$t,"onload",null,function($d){var $t=this;this._onload=$d,this._image&&(this._image.onload=null!=this._onload?function(){$t.onresize(),$t._onload();}:null);}),$k(0,$t,"onerror",null,function($d){var $t=this;this._onerror=$d,this._image&&(this._image.onerror=null!=this._onerror?function(){$t._onerror();}:null);}),$B;}();$G.__init([$cd,$Z,$qd,$gd]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}}),function($i,$d,$k){$k.un,$k.uns;var $W=$k.static,$A=$k.class,$B=$k.getset,$o=($k.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$Y=laya.utils.ClassUtils,$f=(laya.events.Event,laya.utils.HTMLChar),$I=laya.net.Loader,$b=(laya.display.Node,laya.maths.Rectangle),$J=laya.renders.Render,$c=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$w=laya.utils.Stat,$n=laya.display.Text,$D=laya.resource.Texture,$z=laya.net.URL,$e=laya.utils.Utils,$g=function(){function $c(){}return $A($c,"laya.html.utils.HTMLParse"),$c.parse=function($d,$t,$l){$t=($t="<root>"+($t=$t.replace(/<br>/g,"<br/>"))+"</root>").replace($c.spacePattern,$c.char255);var $k=$e.parseXMLFromString($t);$c._parseXML($d,$k.childNodes[0].childNodes,$l);},$c._parseXML=function($d,$t,$l,$k){var $W=0,$i=0;if($t.join||$t.item)for($W=0,$i=$t.length;$W<$i;++$W)$c._parseXML($d,$t[$W],$l,$k);else{var $A,$B,$o;if(3==$t.nodeType)return void($d instanceof laya.html.dom.HTMLDivElement?(null==$t.nodeName&&($t.nodeName="#text"),$B=$t.nodeName.toLowerCase(),0<($o=$t.textContent.replace(/^\s+|\s+$/g,"")).length&&($A=$Y.getInstance($B))&&($d.addChild($A),$A.innerTEXT=$o.replace($c.char255AndOneSpacePattern," "))):0<($o=$t.textContent.replace(/^\s+|\s+$/g,"")).length&&($d.innerTEXT=$o.replace($c.char255AndOneSpacePattern," ")));if("#comment"==($B=$t.nodeName.toLowerCase()))return;if($A=$Y.getInstance($B)){($A=$d.addChild($A)).URI=$l,$A.href=$k;var $I=$t.attributes;if($I&&0<$I.length)for($W=0,$i=$I.length;$W<$i;++$W){var $b=$I[$W],$f=$b.nodeName,$J=$b.value;$A._setAttributes($f,$J);}$c._parseXML($A,$t.childNodes,$l,$A.href);}else $c._parseXML($d,$t.childNodes,$l,$k);}},$c.char255=String.fromCharCode(255),$c.spacePattern=/&nbsp;|&#160;/g,$c.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$c;}(),$H=function(){function $x(){}return $A($x,"laya.html.utils.Layout"),$x.later=function($d){null==$x._will&&($x._will=[],$k.stage.frameLoop(1,null,function(){if(!($x._will.length<1)){for(var $d=0;$d<$x._will.length;$d++)laya.html.utils.Layout.layout($x._will[$d]);$x._will.length=0;}})),$x._will.push($d);},$x.layout=function($d){if(!$d||!$d._style)return null;if(0==(512&$d._style._type))return null;$d.getStyle()._type&=-513;var $t=$x._multiLineLayout($d);return $J.isConchApp&&$d.layaoutCallNative&&$d.layaoutCallNative(),$t;},$x._multiLineLayout=function($d){if($n.RightToLeft)return $x._multiLineLayout2($d);var $t=new Array();$d._addChildsToLayout($t);var $l,$k,$W,$i,$A,$B=0,$o=$t.length,$I=$d._getCSSStyle(),$b=$I.letterSpacing,$f=$I.leading,$J=$I.lineHeight,$c=$I._widthAuto()||!$I.wordWrap,$Y=$c?999999:$d.width,$w=($d.height,0),$D=$I.italic?$I.fontSize/3:0,$z=$I._getAlign(),$e=$I._getValign(),$g=0!==$e||0!==$z||0!=$J,$H=0,$R=0,$G=0,$q=0,$L=new Array(),$$=$L[0]=new $Q(),$p=!1,$M=!1;$$.h=0,$I.italic&&($Y-=$I.fontSize/3);var $T=0,$r=!0;function $S(){$$.y=$R,$R+=$$.h+$f,0==$$.h&&($R+=$J),$$.mWidth=$T,$T=0,$$=new $Q(),$L.push($$),$$.h=0,$p=!($r=!($H=0));}for($B=0;$B<$o;$B++)if(null!=($l=$t[$B])){if($r=!1,$l instanceof laya.html.dom.HTMLBrElement)$S(),$$.y=$R;else{if($l._isChar()){if(($i=$l).isWord)$p=$M||"\n"===$i.char,$$.wordStartIndex=$$.elements.length;else{if($G=$i.width+$i.style.letterSpacin,0<$L.length&&$Y<$H+$G&&0<$$.wordStartIndex){var $j;$j=$$.elements.length-$$.wordStartIndex+1,$$.elements.length=$$.wordStartIndex,$B-=$j,$S();continue;}$p=!1,$T+=$i.width;}$G=$i.width+$b,$q=$i.height,$M=!1,($p=$p||$Y<$H+$G)&&$S(),$$.minTextHeight=Math.min($$.minTextHeight,$l.height);}else $k=$l._getCSSStyle(),$A=$l,$W=$k.padding,0===$k._getCssFloat()||($g=!0),$p=$M||$k.lineElement,$G=$A.width*$A._style._tf.scaleX+$W[1]+$W[3]+$b,$q=$A.height*$A._style._tf.scaleY+$W[0]+$W[2],$M=$k.lineElement,($p=$p||$Y<$H+$G&&$k.wordWrap)&&$S();$$.elements.push($l),$$.h=Math.max($$.h,$q),$l.x=$H,$l.y=$R,$H+=$G,$$.w=$H-$b,$$.y=$R,$w=Math.max($H+$D,$w);}}else $r||($H+=$x.DIV_ELEMENT_PADDING),$$.wordStartIndex=$$.elements.length;if($R=$$.y+$$.h,$g){var $C=0,$K=$Y;for($c&&0<$d.width&&($K=$d.width),$B=0,$o=$L.length;$B<$o;$B++)$L[$B].updatePos(0,$K,$B,$C,$z,$e,$J),$C+=Math.max($J,$L[$B].h+$f);$R=$C;}return $c&&($d.width=$w),$R>$d.height&&($d.height=$R),[$w,$R];},$x._multiLineLayout2=function($d){var $t=new Array();$d._addChildsToLayout($t);var $l,$k,$W,$i,$A,$B=0,$o=$t.length,$I=$d._getCSSStyle(),$b=$I.letterSpacing,$f=$I.leading,$J=$I.lineHeight,$c=$I._widthAuto()||!$I.wordWrap,$Y=$c?999999:$d.width,$w=($d.height,0),$D=$I.italic?$I.fontSize/3:0,$z=2-$I._getAlign(),$e=$I._getValign(),$g=0!==$e||0!=$z||0!=$J,$H=0,$R=0,$G=0,$q=0,$L=new Array(),$$=$L[0]=new $Q(),$p=!1,$M=!1;$$.h=0,$I.italic&&($Y-=$I.fontSize/3);var $T=0,$r=!0;function $S(){$$.y=$R,$R+=$$.h+$f,0==$$.h&&($R+=$J),$$.mWidth=$T,$T=0,$$=new $Q(),$L.push($$),$$.h=0,$p=!($r=!($H=0));}for($B=0;$B<$o;$B++)if(null!=($l=$t[$B])){if($r=!1,$l instanceof laya.html.dom.HTMLBrElement)$S(),$$.y=$R;else{if($l._isChar()){if(($i=$l).isWord)$p=$M||"\n"===$i.char,$$.wordStartIndex=$$.elements.length;else{if(0<$L.length&&$Y<$H+$G&&0<$$.wordStartIndex){var $j;$j=$$.elements.length-$$.wordStartIndex+1,$$.elements.length=$$.wordStartIndex,$B-=$j,$S();continue;}$p=!1,$T+=$i.width;}$G=$i.width+$b,$q=$i.height,$M=!1,($p=$p||$Y<$H+$G)&&$S(),$$.minTextHeight=Math.min($$.minTextHeight,$l.height);}else $k=$l._getCSSStyle(),$A=$l,$W=$k.padding,0===$k._getCssFloat()||($g=!0),$p=$M||$k.lineElement,$G=$A.width*$A._style._tf.scaleX+$W[1]+$W[3]+$b,$q=$A.height*$A._style._tf.scaleY+$W[0]+$W[2],$M=$k.lineElement,($p=$p||$Y<$H+$G&&$k.wordWrap)&&$S();$$.elements.push($l),$$.h=Math.max($$.h,$q),$l.x=$H,$l.y=$R,$H+=$G,$$.w=$H-$b,$$.y=$R,$w=Math.max($H+$D,$w);}}else $r||($H+=$x.DIV_ELEMENT_PADDING),$$.wordStartIndex=$$.elements.length;if($R=$$.y+$$.h,$g){var $C=0,$K=$Y;for($B=0,$o=$L.length;$B<$o;$B++)$L[$B].updatePos(0,$K,$B,$C,$z,$e,$J),$C+=Math.max($J,$L[$B].h+$f);$R=$C;}for($c&&($d.width=$w),$R>$d.height&&($d.height=$R),$B=0,$o=$L.length;$B<$o;$B++)$L[$B].revertOrder($Y);return[$w,$R];},$x._will=null,$x.DIV_ELEMENT_PADDING=0,$x;}(),$Q=function(){function $d(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array();}$A($d,"laya.html.utils.LayoutLine");var $t=$d.prototype;return $t.updatePos=function($d,$t,$l,$k,$W,$i,$A){var $B,$o=0;0<this.elements.length&&($o=($B=this.elements[this.elements.length-1]).x+$B.width-this.elements[0].x);var $I=0,$b=NaN;1===$W&&($I=($t-$o)/2),2===$W&&($I=$t-$o),0===$A||0!=$i||($i=1);for(var $f=0,$J=this.elements.length;$f<$J;$f++){var $c=($B=this.elements[$f])._getCSSStyle();switch(0!==$I&&($B.x+=$I),$c._getValign()){case 0:$B.y=$k;break;case 1:var $Y=0;99999!=this.minTextHeight&&($Y=this.minTextHeight);var $w=($Y+$A)/2;$w=Math.max($w,this.h),$b=(laya.html.dom.HTMLImageElement,$k+$w-$B.height),$B.y=$b;break;case 2:$B.y=$k+($A-$B.height);}}},$t.revertOrder=function($d){var $t;if(0<this.elements.length){var $l,$k=0;for($l=this.elements.length,$k=0;$k<$l;$k++)($t=this.elements[$k]).x=$d-$t.x-$t.width;}},$d;}(),$R=function($l){function $t(){this.URI=null,this._href=null,$t.__super.call(this),this._text=$t._EMPTYTEXT,this.setStyle(new $o(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0;}$A($t,"laya.html.dom.HTMLElement",$l);var $d=$t.prototype;return $d.layaoutCallNative=function(){var $d=0;if(this._childs&&0<($d=this._childs.length))for(var $t=0;$t<$d;$t++)this._childs[$t].layaoutCallNative&&this._childs[$t].layaoutCallNative();var $l=this._getWords();$l?laya.html.dom.HTMLElement.fillWords(this,$l,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear();},$d.appendChild=function($d){return this.addChild($d);},$d._getWords2=function(){var $d=this._text.text;if(!$d||0===$d.length)return null;var $t,$l,$k=0,$W=0;if(this._text.drawWords)$l=this._text.drawWords;else{for($W=($t=$d.split(" ")).length-1,$l=[],$k=0;$k<$W;$k++)$l.push($t[$k]," ");0<=$W&&$l.push($t[$W]),this._text.drawWords=$l;}var $i,$A=this._text.words;if($A&&$A.length===$l.length)return $A;null===$A&&(this._text.words=$A=[]),$A.length=$l.length;var $B=this.style,$o=$B.font;for($k=0,$W=$l.length;$k<$W;$k++){$i=$e.measureText($l[$k],$o);var $I=$A[$k]=new $f($l[$k],$i.width,$i.height||$B.fontSize,$B);if(1<$I.char.length&&($I.charNum=$I.char),this.href){var $b=new $c();this.addChild($b),$I.setSprite($b);}}return $A;},$d._getWords=function(){if(!$n.CharacterCache)return this._getWords2();var $d=this._text.text;if(!$d||0===$d.length)return null;var $t,$l=this._text.words;if($l&&$l.length===$d.length)return $l;null===$l&&(this._text.words=$l=[]),$l.length=$d.length;for(var $k=this.style,$W=$k.font,$i=0,$A=$d.length;$i<$A;$i++)if($t=$e.measureText($d.charAt($i),$W)){var $B=$l[$i]=new $f($d.charAt($i),$t.width,$t.height||$k.fontSize,$k);if(this.href){var $o=new $c();this.addChild($o),$B.setSprite($o);}}else console.warn("_getWords size is null"+$d.charAt($i),$W);return $l;},$d.showLinkSprite=function(){var $d=this._text.words;if($d)for(var $t,$l,$k=[],$W=0;$W<$d.length;$W++)$l=$d[$W],($t=new $c()).graphics.drawRect(0,0,$l.width,$l.height,"#ff0000"),$t.width=$l.width,$t.height=$l.height,this.addChild($t),$k.push($t);},$d._layoutLater=function(){var $d=this.style;512&$d._type||($d.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$d.block?($H.later(this),$d._type|=512):this.parent&&this.parent._layoutLater());},$d._setAttributes=function($d,$t){switch($d){case"style":return void this.style.cssText($t);case"class":return void(this.className=$t);}$l.prototype._setAttributes.call(this,$d,$t);},$d.updateHref=function(){if(null!=this._href){var $d=this._getWords();if($d)for(var $t,$l,$k=0;$k<$d.length;$k++)($l=($t=$d[$k]).getSprite())&&($l.size($t.width,$t.height),$l.on("click",this,this.onLinkHandler));}},$d.onLinkHandler=function($d){switch($d.type){case"click":for(var $t=this;$t;)$t.event("link",[this.href]),$t=$t.parent;}},$d.formatURL=function($d){return this.URI?$z.formatURL($d,this.URI?this.URI.path:null):$d;},$B(0,$d,"href",function(){return this._href;},function($d){null!=(this._href=$d)&&(this._getCSSStyle().underLine=1,this.updateHref());}),$B(0,$d,"color",null,function($d){this.style.color=$d;}),$B(0,$d,"onClick",null,function($d){$k._runScript("fn=function(event){"+$d+";}"),this.on("click",this,void 0);}),$B(0,$d,"id",null,function($d){$G.document.setElementById($d,this);}),$B(0,$d,"innerTEXT",function(){return this._text.text;},function($d){this.text=$d;}),$B(0,$d,"style",function(){return this._style;}),$B(0,$d,"text",function(){return this._text.text;},function($d){this._text==$t._EMPTYTEXT?this._text={text:$d,words:null}:(this._text.text=$d,this._text.words&&(this._text.words.length=0)),$J.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref();}),$B(0,$d,"parent",$l.prototype._$get_parent,function($d){if($d instanceof laya.html.dom.HTMLElement){var $t=$d;this.URI||(this.URI=$t.URI),this.style.inherit($t.style);}$k.superSet($c,this,"parent",$d);}),$B(0,$d,"className",null,function($d){this.style.attrs($G.document.styleSheets["."+$d]);}),$t.fillWords=function($d,$t,$l,$k,$W,$i,$A){$d.graphics.clear();for(var $B=0,$o=$t.length;$B<$o;$B++){var $I=$t[$B];$d.graphics.fillText($I.char,$I.x+$l,$I.y+$k,$W,$i,"left",$A);}},$t._EMPTYTEXT={text:null,words:null},$t;}($c),$t=(function($d){function $t(){$t.__super.call(this),this.style.lineElement=!0,this.style.block=!0;}$A($t,"laya.html.dom.HTMLBrElement",$R);}(),function($d){function $t(){this.contextHeight=NaN,this.contextWidth=NaN,$t.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200;}$A($t,"laya.html.dom.HTMLDivElement",$d);var $l=$t.prototype;return $l.appendHTML=function($d){$g.parse(this,$d,this.URI),this.layout();},$l._addChildsToLayout=function($t){var $d=this._getWords();if(null==$d&&0==this._childs.length)return!1;$d&&$d.forEach(function($d){$t.push($d);});for(var $l=!0,$k=0,$W=this._childs.length;$k<$W;$k++){var $i=this._childs[$k];$l?$l=!1:$t.push(null),$i._addToLayout($t);}return!0;},$l._addToLayout=function($d){this.layout();},$l.layout=function(){if(this.style){this.style._type|=512;var $d=$H.layout(this);if($d){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $b());var $t=this._$P.mHtmlBounds;$t.x=$t.y=0,$t.width=this.contextWidth=$d[0],$t.height=this.contextHeight=$d[1],this.setBounds($t);}}},$B(0,$l,"height",function(){return this._height?this._height:this.contextHeight;},$d.prototype._$set_height),$B(0,$l,"innerHTML",null,function($d){this.destroyChildren(),this.appendHTML($d);}),$B(0,$l,"width",function(){return this._width?this._width:this.contextWidth;},function($d){var $t=!1;$t=0===$d?$d!=this._width:$d!=this.width,$k.superSet($R,this,"width",$d),$t&&this.layout();}),$t;}($R)),$G=function($d){function $t(){this.all=new Array(),this.styleSheets=$o.styleSheets,$t.__super.call(this);}$A($t,"laya.html.dom.HTMLDocument",$R);var $l=$t.prototype;return $l.getElementById=function($d){return this.all[$d];},$l.setElementById=function($d,$t){this.all[$d]=$t;},$W($t,["document",function(){return this.document=new $t();}]),$t;}();(function($d){function $t(){this._tex=null,this._url=null,this._renderArgs=[],$t.__super.call(this),this.style.block=!0;}$A($t,"laya.html.dom.HTMLImageElement",$R);var $l=$t.prototype;$l._addToLayout=function($d){!this._style.absolute&&$d.push(this);},$l.render=function($d,$t,$l){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($w.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$d.ctx.drawTexture2($t,$l,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs));},$l.layaoutCallNative=function(){var $d=0;if(this._childs&&0<($d=this._childs.length))for(var $t=0;$t<$d;$t++)this._childs[$t].layaoutCallNative&&this._childs[$t].layaoutCallNative();},$B(0,$l,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($d){this._width!==$d&&(this._width=$d,this._style.width=$d,this.repaint());}),$B(0,$l,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($d){this._height!==$d&&(this._height=$d,this._style.height=$d,this.repaint());}),$l.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$I.clearCache(this,this._url),this._tex=null),$R.prototype.destroy.call(this);},$l.onloaded=function(){var $d=this._style;$d&&!$d.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$d&&!$d.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$J.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint();},$l._loadImageComplete=function($d,$t,$l){if(!this._destroyed)if(null!=$l){if($l instanceof ArrayBuffer){var $k=new DataView($l);new laya.webgl.resource.WebGLImage(new Uint8Array($l,8),$d,0,!1,$k.getUint32(0),$k.getUint32(4));this.onloaded();}else if($l instanceof $D)$I.imgMgrSet[$d]=$t,$i.imgMgrLock($d,$I.imgMgrSet[$d]),this._url=$d,this._tex=$l,$I.keepCache(this,$d),$I.cacheRes($d,this._tex),this.onloaded();else{var $W=-1!=$d.indexOf(".png",$d.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($l,$d,$W,!1,$l.width,$l.height);this.onloaded();}}else this.event("error","Load image failed");},$B(0,$l,"src",null,function($d){($d=this.formatURL($d),this._url!=$d)&&(null!=this._tex&&($I.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$d,(this._tex=$I.getRes($d))?($I.keepCache(this,$d),this.onloaded()):$i.imgMgrLoad($d,this._loadImageComplete.bind(this),2,!1));});})(),function($d){function $t(){this.type=null,$t.__super.call(this),this.visible=!1;}$A($t,"laya.html.dom.HTMLLinkElement",$d);var $l=$t.prototype;$l._onload=function($d){switch(this.type){case"text/css":$o.parseCSS($d,this.URI);}},$B(0,$l,"href",$d.prototype._$get_href,function($d){var $t=this;$d=this.formatURL($d),this.URI=new $z($d);var $l=new $I();$l.once("complete",null,function($d){$t._onload($d);}),$l.load($d,"text");}),$t._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g");}($R),function($d){function $t(){$t.__super.call(this),this.visible=!1;}$A($t,"laya.html.dom.HTMLStyleElement",$d),$B(0,$t.prototype,"text",$d.prototype._$get_text,function($d){$o.parseCSS($d,null);});}($R),function($d){function $t(){$t.__super.call(this),this._getCSSStyle().valign="middle";}$A($t,"laya.html.dom.HTMLIframeElement",$d),$B(0,$t.prototype,"href",$d.prototype._$get_href,function($l){var $k=this;$l=this.formatURL($l);var $d=new $I();$d.once("complete",null,function($d){var $t=$k.URI;$k.URI=new $z($l),$k.innerHTML=$d,!$t||($k.URI=$t);}),$d.load($l,"text");});}($t);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}}),function($W,$d,$w){$w.un,$w.uns;var $k=$w.static,$i=$w.class,$A=$w.getset,$l=($w.__newvec,laya.display.Animation),$D=(laya.utils.Browser,laya.utils.ClassUtils),$B=laya.filters.ColorFilter,$o=laya.utils.Ease,$I=laya.events.Event,$b=(laya.events.EventDispatcher,laya.display.css.Font),$f=laya.display.FrameAnimation,$t=laya.display.Graphics,$J=laya.utils.Handler,$c=laya.display.Input,$e=laya.net.Loader,$Y=(laya.display.Node,laya.maths.Point),$z=laya.maths.Rectangle,$g=laya.renders.Render,$H=laya.display.Sprite,$R=laya.display.Text,$G=laya.resource.Texture,$q=laya.utils.Tween,$L=laya.utils.Utils,$$=laya.utils.WeakObject;$w.interface("laya.ui.IItem"),$w.interface("laya.ui.ISelect"),$w.interface("laya.ui.IRender"),$w.interface("laya.ui.IComponent"),$w.interface("laya.ui.IBox","IComponent");var $p=function(){function $d(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN;}return $i($d,"laya.ui.LayoutStyle"),$k($d,["EMPTY",function(){return this.EMPTY=new $d();}]),$d;}(),$M=function(){function $d(){}return $i($d,"laya.ui.Styles"),$d.labelColor="#000000",$d.buttonStateNum=3,$d.scrollBarMinNum=15,$d.scrollBarDelayTime=500,$k($d,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0];},"labelPadding",function(){return this.labelPadding=[2,2,2,2];},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3];},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"];},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"];}]),$d;}(),$T=function(){function $W(){}return $i($W,"laya.ui.UIUtils"),$W.fillArray=function($d,$t,$l){var $k=$d.concat();if($t)for(var $W=$t.split(","),$i=0,$A=Math.min($k.length,$W.length);$i<$A;$i++){var $B=$W[$i];$k[$i]="true"==$B||"false"!=$B&&$B,null!=$l&&($k[$i]=$l($B));}return $k;},$W.toColor=function($d){return $L.toHexColor($d);},$W.gray=function($d,$t){void 0===$t&&($t=!0),$t?$W.addFilter($d,$W.grayFilter):$W.clearFilter($d,$B);},$W.addFilter=function($d,$t){var $l=$d.filters||[];$l.push($t),$d.filters=$l;},$W.clearFilter=function($d,$t){var $l=$d.filters;if(null!=$l&&0<$l.length){for(var $k=$l.length-1;-1<$k;$k--){var $W=$l[$k];$w.__typeof($W,$t)&&$l.splice($k,1);}$d.filters=$l;}},$W._getReplaceStr=function($d){return $W.escapeSequence[$d];},$W.adptString=function($d){return $d.replace(/\\(\w)/g,$W._getReplaceStr);},$W.getBindFun=function($d){var $t=$W._funMap.get($d);if(null==$t){var $l='"'+$d+'"',$k="(function(data){if(data==null)return;with(data){try{\nreturn "+($l=$l.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$t=$w._runScript($k),$W._funMap.set($d,$t);}return $t;},$k($W,["grayFilter",function(){return this.grayFilter=new $B([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]);},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"};},"_funMap",function(){return this._funMap=new $$();}]),$W;}(),$r=function(){function $d(){}return $i($d,"UIConfig"),$d.touchScrollEnable=!0,$d.mouseWheelEnable=!0,$d.showButtons=!0,$d.popupBgColor="#000000",$d.popupBgAlpha=.5,$d.closeDialogOnSide=!0,$d;}(),$S=function($l){function $z(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$z.__super.call(this),this._weakKeys=[];}$i($z,"laya.ui.AutoBitmap",$l);var $d=$z.prototype;return $d.destroy=function(){if($e.clearObject(this,this._weakKey),this._weakKeys){for(var $d=0,$t=this._weakKeys.length;$d<$t;++$d)$e.clearObject(this,this._weakKeys[$d]);this._weakKeys=null;}$l.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null;},$d._setChanged=function(){this._isChanged||(this._isChanged=!0,$w.timer.callLater(this,this.changeSource));},$d.changeSource=function(){this._isChanged=!1;var $d=this._source;if($d&&$d.bitmap){var $t=this.width,$l=this.height,$k=this._sizeGrid,$W=$d.sourceWidth,$i=$d.sourceHeight;if(!$k||$W===$t&&$i===$l)this.cleanByTexture($d,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$t,$l);else{$e.clearObject(this,this._weakKey),$d.$_GID||($d.$_GID=$L.getGID());var $A=$d.$_GID+"."+$t+"."+$l+"."+$k.join("."),$B=$e.findObject($A);if($L.isOKCmdList($B))return this._weakKey=$A,$e.keepObject(this,this._weakKey),void(this.cmds=$B);this.clear();var $o,$I,$b=$k[0],$f=$k[1],$J=$k[2],$c=$k[3],$Y=$k[4],$w=!1;if($t==$W&&($c=$f=0),$l==$i&&($b=$J=0),$t<$c+$f){var $D=$t;$w=!0,$t=$c+$f,this.save(),this.clipRect(0,0,$D,$l);}$c&&$b&&($o=$z.getTexture($d,0,0,$c,$b),$I=this._weakKeys[0],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[0]=$o.weakKey),this.drawTexture($o,0,0,$c,$b)):($e.clearObject(this,$I),this._weakKeys[0]="")),$f&&$b&&($o=$z.getTexture($d,$W-$f,0,$f,$b),$I=this._weakKeys[1],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[1]=$o.weakKey),this.drawTexture($o,$t-$f,0,$f,$b)):($e.clearObject(this,$I),this._weakKeys[1]="")),$c&&$J&&($o=$z.getTexture($d,0,$i-$J,$c,$J),$I=this._weakKeys[2],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[2]=$o.weakKey),this.drawTexture($o,0,$l-$J,$c,$J)):($e.clearObject(this,$I),this._weakKeys[2]="")),$f&&$J&&($o=$z.getTexture($d,$W-$f,$i-$J,$f,$J),$I=this._weakKeys[3],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[3]=$o.weakKey),this.drawTexture($o,$t-$f,$l-$J,$f,$J)):($e.clearObject(this,$I),this._weakKeys[3]="")),$b&&($o=$z.getTexture($d,$c,0,$W-$c-$f,$b),$I=this._weakKeys[4],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[4]=$o.weakKey),this.drawBitmap($Y,$o,$c,0,$t-$c-$f,$b)):($e.clearObject(this,$I),this._weakKeys[4]="")),$J&&($o=$z.getTexture($d,$c,$i-$J,$W-$c-$f,$J),$I=this._weakKeys[5],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[5]=$o.weakKey),this.drawBitmap($Y,$o,$c,$l-$J,$t-$c-$f,$J)):($e.clearObject(this,$I),this._weakKeys[5]="")),$c&&($o=$z.getTexture($d,0,$b,$c,$i-$b-$J),$I=this._weakKeys[6],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[6]=$o.weakKey),this.drawBitmap($Y,$o,0,$b,$c,$l-$b-$J)):($e.clearObject(this,$I),this._weakKeys[6]="")),$f&&($o=$z.getTexture($d,$W-$f,$b,$f,$i-$b-$J),$I=this._weakKeys[7],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[7]=$o.weakKey),this.drawBitmap($Y,$o,$t-$f,$b,$f,$l-$b-$J)):($e.clearObject(this,$I),this._weakKeys[7]="")),$o=$z.getTexture($d,$c,$b,$W-$c-$f,$i-$b-$J),$I=this._weakKeys[8],$o?($I!=$o.weakKey&&($e.clearObject(this,$I),$e.keepObject(this,$o.weakKey),this._weakKeys[8]=$o.weakKey),this.drawBitmap($Y,$o,$c,$b,$t-$c-$f,$l-$b-$J)):($e.clearObject(this,$I),this._weakKeys[8]=""),$w&&this.restore(),this.autoCacheCmd&&!$g.isConchApp&&($e.saveObject($A,this.cmds,null),this._weakKey=$A,$e.keepObject(this,this._weakKey));}this._repaint();}},$d.drawBitmap=function($d,$t,$l,$k,$W,$i){void 0===$W&&($W=0),void 0===$i&&($i=0),$W<.1||$i<.1||(!$d||$t.width==$W&&$t.height==$i?this.drawTexture($t,$l,$k,$W,$i):this.fillTexture($t,$l,$k,$W,$i));},$d.clear=function($d){void 0===$d&&($d=!0),$l.prototype.clear.call(this,!1);},$A(0,$d,"sizeGrid",function(){return this._sizeGrid;},function($d){this._sizeGrid=$d,this._setChanged();}),$A(0,$d,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0;},function($d){this._width!=$d&&(this._width=$d,this._setChanged());}),$A(0,$d,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0;},function($d){this._height!=$d&&(this._height=$d,this._setChanged());}),$A(0,$d,"source",function(){return this._source;},function($d){$d?(this._source=$d,this._setChanged()):(this._source=null,this.clear());}),$z.getTexture=function($d,$t,$l,$k,$W){$k<=0&&($k=1),$W<=0&&($W=1),$d.$_GID||($d.$_GID=$L.getGID());var $i=$d.$_GID+"."+$t+"."+$l+"."+$k+"."+$W,$A=$e.findObject($i);if((!$A||!$A.source)&&($A=$G.createFromTexture($d,$t,$l,$k,$W))){if($d.alphaTexture){var $B=$d.width/$d.alphaTexture.width;$A.alphaTexture=$G.createFromTexture($d.alphaTexture,$t/$B,$l/$B,$k/$B,$W/$B);}$e.saveObject($i,$A),$A.weakKey=$i;}return $A;},$z;}($t),$j=(function($d){function $t(){$t.__super.call(this);}$i($t,"laya.ui.UIEvent",$I),$t.SHOW_TIP="showtip",$t.HIDE_TIP="hidetip";}(),function($t){function $d(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$d.__super.call(this),this._layout=$p.EMPTY,this.preinitialize(),this.createChildren(),this.initialize();}$i($d,"laya.ui.Component",$t);var $l=$d.prototype;return $w.imps($l,{"laya.ui.IComponent":!0}),$l.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null;},$l.preinitialize=function(){},$l.createChildren=function(){},$l.initialize=function(){},$l.callLater=function($d,$t){$w.timer.callLater(this,$d,$t);},$l.runCallLater=function($d){$w.timer.runCallLater(this,$d);},$l.commitMeasure=function(){},$l.changeSize=function(){this.event("resize");},$l.getLayout=function(){return this._layout===$p.EMPTY&&(this._layout=new $p()),this._layout;},$l._setLayoutEnabled=function($d){this._layout&&this._layout.enable!=$d&&(this._layout.enable=$d,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded());},$l.onRemoved=function(){this.parent.off("resize",this,this.onCompResize);},$l.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY();},$l.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY());},$l.resetLayoutX=function(){var $d=this._layout;if(isNaN($d.anchorX)||(this.pivotX=$d.anchorX*this.width),this.layoutEnabled){var $t=this.parent;$t&&(isNaN($d.centerX)?isNaN($d.left)?isNaN($d.right)||(this.x=Math.round($t.width-this.displayWidth-$d.right+this.pivotX*this.scaleX)):(this.x=Math.round($d.left+this.pivotX*this.scaleX),isNaN($d.right)||(this.width=($t._width-$d.left-$d.right)/(this.scaleX||.01))):this.x=Math.round(.5*($t.width-this.displayWidth)+$d.centerX+this.pivotX*this.scaleX));}},$l.resetLayoutY=function(){var $d=this._layout;if(isNaN($d.anchorY)||(this.pivotY=$d.anchorY*this.height),this.layoutEnabled){var $t=this.parent;$t&&(isNaN($d.centerY)?isNaN($d.top)?isNaN($d.bottom)||(this.y=Math.round($t.height-this.displayHeight-$d.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($d.top+this.pivotY*this.scaleY),isNaN($d.bottom)||(this.height=($t._height-$d.top-$d.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($t.height-this.displayHeight)+$d.centerY+this.pivotY*this.scaleY));}},$l.onMouseOver=function($d){$w.stage.event("showtip",this._toolTip);},$l.onMouseOut=function($d){$w.stage.event("hidetip",this._toolTip);},$A(0,$l,"displayWidth",function(){return this.width*this.scaleX;}),$A(0,$l,"width",function(){return this._width?this._width:this.measureWidth;},function($d){this._width!=$d&&(this._width=$d,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX());}),$A(0,$l,"measureWidth",function(){var $d=0;this.commitMeasure();for(var $t=this.numChildren-1;-1<$t;$t--){var $l=this.getChildAt($t);$l.visible&&($d=Math.max($l.x+$l.width*$l.scaleX,$d));}return $d;}),$A(0,$l,"displayHeight",function(){return this.height*this.scaleY;}),$A(0,$l,"height",function(){return this._height?this._height:this.measureHeight;},function($d){this._height!=$d&&(this._height=$d,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY());}),$A(0,$l,"dataSource",function(){return this._dataSource;},function($d){for(var $t in this._dataSource=$d,this._dataSource)this.hasOwnProperty($t)&&"function"!=typeof this[$t]&&(this[$t]=this._dataSource[$t]);}),$A(0,$l,"scaleY",$t.prototype._$get_scaleY,function($d){$w.superGet($H,this,"scaleY")!=$d&&($w.superSet($H,this,"scaleY",$d),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY());}),$A(0,$l,"measureHeight",function(){var $d=0;this.commitMeasure();for(var $t=this.numChildren-1;-1<$t;$t--){var $l=this.getChildAt($t);$l.visible&&($d=Math.max($l.y+$l.height*$l.scaleY,$d));}return $d;}),$A(0,$l,"scaleX",$t.prototype._$get_scaleX,function($d){$w.superGet($H,this,"scaleX")!=$d&&($w.superSet($H,this,"scaleX",$d),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX());}),$A(0,$l,"top",function(){return this._layout.top;},function($d){$d!=this._layout.top&&(this.getLayout().top=$d,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$A(0,$l,"bottom",function(){return this._layout.bottom;},function($d){$d!=this._layout.bottom&&(this.getLayout().bottom=$d,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$A(0,$l,"left",function(){return this._layout.left;},function($d){$d!=this._layout.left&&(this.getLayout().left=$d,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$A(0,$l,"right",function(){return this._layout.right;},function($d){$d!=this._layout.right&&(this.getLayout().right=$d,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$A(0,$l,"centerX",function(){return this._layout.centerX;},function($d){$d!=this._layout.centerX&&(this.getLayout().centerX=$d,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$A(0,$l,"centerY",function(){return this._layout.centerY;},function($d){$d!=this._layout.centerY&&(this.getLayout().centerY=$d,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$A(0,$l,"anchorX",function(){return this._layout.anchorX;},function($d){$d!=this._layout.anchorX&&(this.getLayout().anchorX=$d,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$A(0,$l,"anchorY",function(){return this._layout.anchorY;},function($d){$d!=this._layout.anchorY&&(this.getLayout().anchorY=$d,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$A(0,$l,"tag",function(){return this._tag;},function($d){this._tag=$d;}),$A(0,$l,"toolTip",function(){return this._toolTip;},function($d){this._toolTip!=$d&&(null!=(this._toolTip=$d)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)));}),$A(0,$l,"comXml",function(){return this._comXml;},function($d){this._comXml=$d;}),$A(0,$l,"gray",function(){return this._gray;},function($d){$d!==this._gray&&(this._gray=$d,$T.gray(this,$d));}),$A(0,$l,"disabled",function(){return this._disabled;},function($d){$d!==this._disabled&&(this.gray=this._disabled=$d,this.mouseEnabled=!$d);}),$d;}($H)),$C=function($d){function $t(){this.lockLayer=null,this.popupEffect=function($d){$d.scale(1,1),$q.from($d,{x:$w.stage.width/2,y:$w.stage.height/2,scaleX:0,scaleY:0},300,$o.backOut,$J.create(this,this.doOpen,[$d]));},this.closeEffect=function($d,$t){$q.to($d,{x:$w.stage.width/2,y:$w.stage.height/2,scaleX:0,scaleY:0},300,$o.strongOut,$J.create(this,this.doClose,[$d,$t]));},$t.__super.call(this),this.maskLayer=new $H(),this.popupEffectHandler=$J.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$J.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$w.stage.addChild(this),$w.stage.on("resize",this,this._onResize),$r.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null);}$i($t,"laya.ui.DialogManager",$H);var $l=$t.prototype;return $l._closeOnSide=function(){var $d=this.getChildAt(this.numChildren-1);$d instanceof laya.ui.Dialog&&$d.close("side");},$l.setLockView=function($d){this.lockLayer||(this.lockLayer=new $K(),this.lockLayer.mouseEnabled=!0,this.lockLayer.size($w.stage.width,$w.stage.height)),this.lockLayer.removeChildren(),$d&&($d.centerX=$d.centerY=0,this.lockLayer.addChild($d));},$l._onResize=function($d){var $t=this.maskLayer.width=$w.stage.width,$l=this.maskLayer.height=$w.stage.height;this.lockLayer&&this.lockLayer.size($t,$l),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$t,$l,$r.popupBgColor),this.maskLayer.alpha=$r.popupBgAlpha;for(var $k=this.numChildren-1;-1<$k;$k--){var $W=this.getChildAt($k);$W.popupCenter&&this._centerDialog($W);}},$l._centerDialog=function($d){$d.x=Math.round(($w.stage.width-$d.width>>1)+$d.pivotX),$d.y=Math.round(($w.stage.height-$d.height>>1)+$d.pivotY);},$l.open=function($d,$t,$l){void 0===$t&&($t=!1),void 0===$l&&($l=!1),$t&&this._closeAll(),$d.popupCenter&&this._centerDialog($d),this.addChild($d),($d.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$l&&null!=$d.popupEffect?$d.popupEffect.runWith($d):this.doOpen($d),this.event("open");},$l.doOpen=function($d){$d.onOpened();},$l.lock=function($d){this.lockLayer&&($d?this.addChild(this.lockLayer):this.lockLayer.removeSelf());},$l.close=function($d,$t,$l){void 0===$l&&($l=!1),$l&&null!=$d.closeEffect?$d.closeEffect.runWith([$d,$t]):this.doClose($d,$t),this.event("close");},$l.doClose=function($d,$t){$d.removeSelf(),$d.isModal&&this._checkMask(),$d.closeHandler&&$d.closeHandler.runWith($t),$d.onClosed($t);},$l.closeAll=function(){this._closeAll(),this.event("close");},$l._closeAll=function(){for(var $d=this.numChildren-1;-1<$d;$d--){var $t=this.getChildAt($d);$t&&null!=$t.close&&this.doClose($t);}},$l.getDialogsByGroup=function($d){for(var $t=[],$l=this.numChildren-1;-1<$l;$l--){var $k=this.getChildAt($l);$k&&$k.group===$d&&$t.push($k);}return $t;},$l.closeByGroup=function($d){for(var $t=[],$l=this.numChildren-1;-1<$l;$l--){var $k=this.getChildAt($l);$k&&$k.group===$d&&($k.close(),$t.push($k));}return $t;},$l._checkMask=function(){this.maskLayer.removeSelf();for(var $d=this.numChildren-1;-1<$d;$d--){var $t=this.getChildAt($d);if($t&&$t.isModal)return void this.addChildAt(this.maskLayer,$d);}},$t;}(),$K=function($d){function $t(){$t.__super.call(this);}$i($t,"laya.ui.Box",$d);var $l=$t.prototype;return $w.imps($l,{"laya.ui.IBox":!0}),$A(0,$l,"dataSource",$d.prototype._$get_dataSource,function($d){for(var $t in this._dataSource=$d){var $l=this.getChildByName($t);$l?$l.dataSource=$d[$t]:this.hasOwnProperty($t)&&"function"!=typeof this[$t]&&(this[$t]=$d[$t]);}}),$t;}($j),$x=function($t){function $l($d,$t){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$l.__super.call(this),this._labelColors=$M.buttonLabelColors,this._stateNum=$M.buttonStateNum,void 0===$t&&($t=""),this.skin=$d,this.label=$t;}$i($l,"laya.ui.Button",$t);var $d=$l.prototype;return $w.imps($d,{"laya.ui.ISelect":!0}),$d.destroy=function($d){this.clearEvent(),$e.clearCache(this,this._skin),$e.clearObject(this,this._weakKey),void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($d),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null;},$d.clearEvent=function(){this._skin&&$W.atalsNotify&&$W.atalsNotify.off(this._skin,this,this._setBtnSource);},$d.createChildren=function(){this.graphics=this._bitmap=new $S();},$d.createText=function(){this._text||(this._text=new $R(),this._text.overflow=$R.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height);},$d.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1);},$d.onMouse=function($d){if(!1!==this.toggle||!this._selected)return"click"===$d.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$l.stateMap[$d.type]));},$d.changeClips=function(){var $d=$e.getRes(this._skin);if($d)if(this._skin&&""!=this._skin){$e.clearObject(this,this._weakKey);var $t=$d.sourceWidth,$l=$d.sourceHeight/this._stateNum;$d.$_GID||($d.$_GID=$L.getGID());var $k=$d.$_GID+"-"+this._stateNum,$W=$e.findObject($k);if($L.isOkTextureList($W)||($W=null),$W)this._weakKey=$k,$e.keepObject(this,this._weakKey),this._sources=$W;else{if(this._sources=[],1===this._stateNum)this._sources.push($d);else for(var $i=0;$i<this._stateNum;$i++){var $A=$G.createFromTexture($d,0,$l*$i,$t,$l);if($d.alphaTexture){var $B=$d.width/$d.alphaTexture.width;$A.alphaTexture=$G.createFromTexture($d.alphaTexture,0/$B,$l*$i/$B,$t/$B,$l/$B);}this._sources.push($A);}$e.saveObject($k,this._sources),this._weakKey=$k,$e.keepObject(this,this._weakKey);}this._autoSize?(this._bitmap.width=this._width||$t,this._bitmap.height=this._height||$l,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$t);}else console.warn("lose skin ",this._skin,this.name,this.__className);},$d.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $d=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$d]),this.label&&(this._text.color=this._labelColors[$d],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$d]));},$d._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState));},$A(0,$d,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor;},function($d){this.createText(),this._text.strokeColor=$d;}),$A(0,$d,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height;}),$A(0,$d,"skin",function(){return this._skin;},function($d){if(this._skin!=$d)if(this.clearEvent(),$e.clearCache(this,this._skin),this._skin=$d,$e.keepCache(this,this._skin),$e.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $t=$W.resAtalsObj&&$W.resAtalsObj[this._skin];$t?($W.atalsNotify&&$W.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$t.sourceW),0==this.height&&(this.height=$t.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className);}}),$d._setBtnSource=function($d,$t){$d===this._skin&&$t&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent());},$A(0,$d,"state",function(){return this._state;},function($d){this._state!=$d&&(this._state=$d,this._setStateChanged());}),$A(0,$d,"text",function(){return this.createText(),this._text;}),$A(0,$d,"stateNum",function(){return this._stateNum;},function($d){"string"==typeof $d&&($d=parseInt($d)),this._stateNum!=$d&&(this._stateNum=$d<1?1:3<$d?3:$d,this.callLater(this.changeClips));}),$A(0,$d,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):"";},function($d){this._strokeColors=$T.fillArray($M.buttonLabelColors,$d,String),this._setStateChanged();}),$A(0,$d,"labelColors",function(){return this._labelColors.join(",");},function($d){this._labelColors=$T.fillArray($M.buttonLabelColors,$d,String),this._setStateChanged();}),$A(0,$d,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0));}),$A(0,$d,"label",function(){return this._text?this._text.text:null;},function($d){(this._text||$d)&&(this.createText(),this._text.text!=$d&&($d&&!this._text.parent&&this.addChild(this._text),this._text.text=($d+"").replace(/\\n/g,"\n"),this._setStateChanged()));}),$A(0,$d,"selected",function(){return this._selected;},function($d){this._selected!=$d&&(this._selected=$d,this.state=this._selected?2:0,this.event("change"));}),$A(0,$d,"labelPadding",function(){return this.createText(),this._text.padding.join(",");},function($d){this.createText(),this._text.padding=$T.fillArray($M.labelPadding,$d,Number);}),$A(0,$d,"labelSize",function(){return this.createText(),this._text.fontSize;},function($d){this.createText(),this._text.fontSize=$d;}),$A(0,$d,"labelStroke",function(){return this.createText(),this._text.stroke;},function($d){this.createText(),this._text.stroke=$d;}),$A(0,$d,"labelBold",function(){return this.createText(),this._text.bold;},function($d){this.createText(),this._text.bold=$d;}),$A(0,$d,"labelFont",function(){return this.createText(),this._text.font;},function($d){this.createText(),this._text.font=$d;}),$A(0,$d,"labelAlign",function(){return this.createText(),this._text.align;},function($d){this.createText(),this._text.align=$d;}),$A(0,$d,"clickHandler",function(){return this._clickHandler;},function($d){this._clickHandler=$d;}),$A(0,$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($d){this._bitmap.sizeGrid=$T.fillArray($M.defaultSizeGrid,$d,Number);}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($j,this,"width",$d),this._autoSize&&(this._bitmap.width=$d,this._text&&(this._text.width=$d));}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($j,this,"height",$d),this._autoSize&&(this._bitmap.height=$d,this._text&&(this._text.height=$d));}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)||"string"==typeof $d?this.label=$d+"":$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null;},function($d){this._bitmap._offset=$d?$T.fillArray([1,1],$d,Number):[];}),$k($l,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0};}]),$l;}($j),$n=function($t){function $k($d,$t,$l){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$k.__super.call(this),void 0===$t&&($t=1),void 0===$l&&($l=1),this._clipX=$t,this._clipY=$l,this.skin=$d;}$i($k,"laya.ui.Clip",$t);var $d=$k.prototype;return $d.destroy=function($d){this.clearEvent(),this.clearLoad(),$e.clearCache(this,this._skin),$e.clearObject(this,this._weakKey),void 0===$d&&($d=!0),$t.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null;},$d.dispose=function(){this.destroy(!0),$w.loader.clearRes(this._skin);},$d.createChildren=function(){this.graphics=this._bitmap=new $S();},$d._onDisplay=function($d){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play();},$d.changeClip=function(){if(this._clipChanged=!1,this._skin){var $d=$e.getRes(this._skin);if($d)this.loadComplete(this._skin,$d);else{if($W.resAtalsObj&&$W.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$J.create(this,this.loadComplete,[this._skin]),this._progress=null,$w.loader.load(this._skin,this._complete,this._progress);}}},$d.loadComplete=function($d,$t){if($d===this._skin&&$t){$e.clearObject(this,this._weakKey);var $l=this._clipWidth||Math.ceil($t.sourceWidth/this._clipX),$k=this._clipHeight||Math.ceil($t.sourceHeight/this._clipY),$W=this._skin+$l+$k,$i=$e.findObject($W);if($L.isOkTextureList($i)||($i=null),$i)this._weakKey=$W,$e.keepObject(this,this._weakKey),this._sources=$i;else{this._sources=[];for(var $A=0;$A<this._clipY;$A++)for(var $B=0;$B<this._clipX;$B++){var $o=$G.createFromTexture($t,$l*$B,$k*$A,$l,$k);if($t.alphaTexture){var $I=$t.width/$t.alphaTexture.width;$o.alphaTexture=$G.createFromTexture($t.alphaTexture,$l*$B/$I,$k*$A/$I,$l/$I,$k/$I);}this._sources.push($o);}$e.saveObject($W,this._sources),this._weakKey=$W,$e.keepObject(this,this._weakKey);}this.index=this._index,this.event("loaded"),this.onCompResize();}},$d.play=function($d,$t){void 0===$d&&($d=0),void 0===$t&&($t=-1),this._isPlaying=!0,this.index=$d,this._toIndex=$t,this._index++,$w.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay);},$d._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index);},$d.stop=function(){this._isPlaying=!1,$w.timer.clear(this,this._loop),this.event("complete");},$d._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip));},$A(0,$d,"interval",function(){return this._interval;},function($d){this._interval!=$d&&(this._interval=$d,this._isPlaying&&this.play());}),$d.clearEvent=function(){this._skin&&$W.atalsNotify&&$W.atalsNotify.off(this._skin,this,this._setBtnSource);},$d.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$w.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$A(0,$d,"skin",function(){return this._skin;},function($d){if(this._skin!=$d)if(this.clearLoad(),this.clearEvent(),$e.clearCache(this,this._skin),this._skin=$d){$e.keepCache(this,this._skin);var $t=$e.getRes($d),$l=$W.resAtalsObj&&$W.resAtalsObj[this._skin];!$t&&$l?$W.atalsNotify&&$W.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged();}else this._bitmap.source=null;}),$d._setBtnSource=function($d,$t){$d===this._skin&&$t&&(this.loadComplete($d,$t),this.clearEvent());},$A(0,$d,"sources",function(){return this._sources;},function($d){this._sources=$d,this.index=this._index,this.event("loaded");}),$A(0,$d,"clipX",function(){return this._clipX;},function($d){this._clipX=$d||1,this._setClipChanged();}),$A(0,$d,"clipY",function(){return this._clipY;},function($d){this._clipY=$d||1,this._setClipChanged();}),$A(0,$d,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0;}),$A(0,$d,"clipWidth",function(){return this._clipWidth;},function($d){this._clipWidth=$d,this._setClipChanged();}),$A(0,$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($d){this._bitmap.sizeGrid=$T.fillArray($M.defaultSizeGrid,$d,Number);}),$A(0,$d,"group",function(){return this._group;},function($d){$d&&this._skin&&$e.setGroup(this._skin,$d),this._group=$d;}),$A(0,$d,"clipHeight",function(){return this._clipHeight;},function($d){this._clipHeight=$d,this._setClipChanged();}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($j,this,"width",$d),this._bitmap.width=$d;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($j,this,"height",$d),this._bitmap.height=$d;}),$A(0,$d,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width;}),$A(0,$d,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height;}),$A(0,$d,"index",function(){return this._index;},function($d){this._index=$d,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$d]),this.event("change");}),$A(0,$d,"autoPlay",function(){return this._autoPlay;},function($d){this._autoPlay!=$d&&((this._autoPlay=$d)?this.play():this.stop());}),$A(0,$d,"isPlaying",function(){return this._isPlaying;},function($d){this._isPlaying=$d;}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)&&Math.floor($d)==$d||"string"==typeof $d?this.index=parseInt($d):$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"bitmap",function(){return this._bitmap;}),$k;}($j),$Q=function($t){function $d(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$d.__super.call(this);}$i($d,"laya.ui.ColorPicker",$t);var $l=$d.prototype;return $l.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._colorPanel&&this._colorPanel.destroy($d),this._colorButton&&this._colorButton.destroy($d),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null;},$l.createChildren=function(){this.addChild(this._colorButton=new $x()),this._colorPanel=new $K(),this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $H()),this._colorPanel.addChild(this._colorBlock=new $H()),this._colorPanel.addChild(this._colorInput=new $c());},$l.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor;},$l.onPanelMouseDown=function($d){$d.stopPropagation();},$l.changePanel=function(){this._panelChanged=!1;var $d=this._colorPanel.graphics;$d.clear(),$d.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($d=this._colorTiles.graphics).clear();for(var $t=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$l=0;$l<12;$l++)for(var $k=0;$k<20;$k++){var $W=0;$W=0===$k?$t[$l]:1===$k?0:51*(((3*$l+$k/6)%3<<0)+3*($l/6<<0))<<16|$k%6*51<<8|($l<<0)%6*51;var $i=$T.toColor($W);this._colors.push($i);var $A=$k*this._gridSize,$B=$l*this._gridSize;$d.drawRect($A,$B,this._gridSize,this._gridSize,$i,"#000000");}},$l.onColorButtonClick=function($d){this._colorPanel.parent?this.close():this.open();},$l.open=function(){var $d=this.localToGlobal(new $Y()),$t=$d.x+this._colorPanel.width<=$w.stage.width?$d.x:$w.stage.width-this._colorPanel.width,$l=$d.y+this._colorButton.height;$l=$l+this._colorPanel.height<=$w.stage.height?$l:$d.y-this._colorPanel.height,this._colorPanel.pos($t,$l),this._colorPanel.zOrder=1001,$w._currentStage.addChild(this._colorPanel),$w.stage.on("mousedown",this,this.removeColorBox);},$l.close=function(){$w.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf();},$l.removeColorBox=function($d){this.close();},$l.onColorFieldKeyDown=function($d){13==$d.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$d.stopPropagation());},$l.onColorInputChange=function($d){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF");},$l.onColorTilesClick=function($d){this.selectedColor=this.getColorByMouse(),this.close();},$l.onColorTilesMouseMove=function($d){this._colorInput.focus=!1;var $t=this.getColorByMouse();this._colorInput.text=$t,this.drawBlock($t);},$l.getColorByMouse=function(){var $d=this._colorTiles.getMousePoint(),$t=Math.floor($d.x/this._gridSize),$l=Math.floor($d.y/this._gridSize);return this._colors[20*$l+$t];},$l.drawBlock=function($d){var $t=this._colorBlock.graphics;$t.clear();var $l=$d||"#ffffff";$t.drawRect(0,0,50,20,$l,this._borderColor),$d||$t.drawLine(0,0,50,20,"#ff0000");},$l.changeColor=function(){var $d=this.graphics;$d.clear();var $t=this._selectedColor||"#000000";$d.drawRect(0,0,this._colorButton.width,this._colorButton.height,$t);},$l._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel));},$A(0,$l,"inputBgColor",function(){return this._inputBgColor;},function($d){this._inputBgColor=$d,this._setPanelChanged();}),$A(0,$l,"selectedColor",function(){return this._selectedColor;},function($d){this._selectedColor!=$d&&(this._selectedColor=this._colorInput.text=$d,this.drawBlock($d),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$I.EMPTY.setTo("change",this,this)));}),$A(0,$l,"skin",function(){return this._colorButton.skin;},function($d){this._colorButton.skin=$d,this.changeColor();}),$A(0,$l,"bgColor",function(){return this._bgColor;},function($d){this._bgColor=$d,this._setPanelChanged();}),$A(0,$l,"borderColor",function(){return this._borderColor;},function($d){this._borderColor=$d,this._setPanelChanged();}),$A(0,$l,"inputColor",function(){return this._inputColor;},function($d){this._inputColor=$d,this._setPanelChanged();}),$d;}($j),$y=function($t){function $l($d,$t){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$l.__super.call(this),this._itemColors=$M.comboBoxItemColors,this.skin=$d,this.labels=$t;}$i($l,"laya.ui.ComboBox",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._button&&this._button.destroy($d),this._list&&this._list.destroy($d),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null;},$d.createChildren=function(){this.addChild(this._button=new $x()),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown);},$d._createList=function(){this._list=new $X(),this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list);},$d._setListEvent=function($d){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$J.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown);},$d.onListDown=function($d){$d.stopPropagation();},$d.onScrollBarDown=function($d){$d.stopPropagation();},$d.onButtonMouseDown=function($d){this.callLater(this.switchTo,[!this._isOpen]);},$d.changeList=function(){this._listChanged=!1;var $d=this.width-2,$t=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$d,height:this._itemHeight,fontSize:this._itemSize,color:$t}}]},this._list.repeatY=this._visibleNum,this._list.refresh();},$d.onlistItemMouse=function($d,$t){var $l=$d.type;if("mouseover"===$l||"mouseout"===$l){if(this._isCustomList)return;var $k=this._list.getCell($t);if(!$k)return;var $W=$k.getChildByName("label");$W&&("mouseover"===$l?($W.bgColor=this._itemColors[0],$W.color=this._itemColors[1]):($W.bgColor=null,$W.color=this._itemColors[2]));}else"click"===$l&&(this.selectedIndex=$t,this.isOpen=!1);},$d.switchTo=function($d){this.isOpen=$d;},$d.changeOpen=function(){this.isOpen=!this._isOpen;},$d.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $d=this._list.graphics;$d.clear(),$d.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);}for(var $t=this._list.array||[],$l=$t.length=0,$k=this._labels.length;$l<$k;$l++)$t.push({label:this._labels[$l]});this._list.height=this._listHeight,this._list.array=$t;},$d.changeSelected=function(){this._button.label=this.selectedLabel;},$d._onStageMouseWheel=function($d){this._list&&!this._list.contains($d.target)&&this.removeList(null);},$d.removeList=function($d){$w.stage.off("mousedown",this,this.removeList),$w.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1;},$A(0,$d,"selectedIndex",function(){return this._selectedIndex;},function($d){this._selectedIndex!=$d&&(this._selectedIndex=$d,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$I.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex));}),$A(0,$d,"measureHeight",function(){return this._button.height;}),$A(0,$d,"skin",function(){return this._button.skin;},function($d){this._button.skin!=$d&&(this._button.skin=$d,this._listChanged=!0);}),$A(0,$d,"measureWidth",function(){return this._button.width;}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($j,this,"width",$d),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0;}),$A(0,$d,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null;},function($d){this.selectedIndex=this._labels.indexOf($d);}),$A(0,$d,"labels",function(){return this._labels.join(",");},function($d){0<this._labels.length&&(this.selectedIndex=-1),$d?this._labels=$d.split(","):this._labels.length=0,this._itemChanged=!0;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($j,this,"height",$d),this._button.height=this._height;}),$A(0,$d,"selectHandler",function(){return this._selectHandler;},function($d){this._selectHandler=$d;}),$A(0,$d,"visibleNum",function(){return this._visibleNum;},function($d){this._visibleNum=$d,this._listChanged=!0;}),$A(0,$d,"labelBold",function(){return this._button.text.bold;},function($d){this._button.text.bold=$d;}),$A(0,$d,"itemColors",function(){return String(this._itemColors);},function($d){this._itemColors=$T.fillArray(this._itemColors,$d,String),this._listChanged=!0;}),$A(0,$d,"itemSize",function(){return this._itemSize;},function($d){this._itemSize=$d,this._listChanged=!0;}),$A(0,$d,"scrollBar",function(){return this.list.scrollBar;}),$A(0,$d,"isOpen",function(){return this._isOpen;},function($d){if(this._isOpen!=$d)if(this._isOpen=$d,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $t=this.localToGlobal($Y.TEMP.setTo(0,0)),$l=$t.y+this._button.height;$l=$l+this._listHeight<=$w.stage.height?$l:$t.y-this._listHeight,this._list.pos($t.x,$l),this._list.zOrder=1001,$w._currentStage.addChild(this._list),$w.stage.once("mousedown",this,this.removeList),$w.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex;}else this._list&&this._list.removeSelf();}),$A(0,$d,"scrollBarSkin",function(){return this._scrollBarSkin;},function($d){this._scrollBarSkin=$d;}),$A(0,$d,"sizeGrid",function(){return this._button.sizeGrid;},function($d){this._button.sizeGrid=$d;}),$A(0,$d,"button",function(){return this._button;}),$A(0,$d,"list",function(){return this._list||this._createList(),this._list;},function($d){$d&&($d.removeSelf(),this._isCustomList=!0,this._list=$d,this._setListEvent($d),this._itemHeight=$d.getCell(0).height+$d.spaceY);}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)&&Math.floor($d)==$d||"string"==typeof $d?this.selectedIndex=parseInt($d):$d instanceof Array?this.labels=$d.join(","):$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"labelColors",function(){return this._button.labelColors;},function($d){this._button.labelColors!=$d&&(this._button.labelColors=$d);}),$A(0,$d,"labelPadding",function(){return this._button.text.padding.join(",");},function($d){this._button.text.padding=$T.fillArray($M.labelPadding,$d,Number);}),$A(0,$d,"labelSize",function(){return this._button.text.fontSize;},function($d){this._button.text.fontSize=$d;}),$A(0,$d,"labelFont",function(){return this._button.text.font;},function($d){this._button.text.font=$d;}),$A(0,$d,"stateNum",function(){return this._button.stateNum;},function($d){this._button.stateNum=$d;}),$l;}($j),$V=function($t){function $l($d){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$l.__super.call(this),this._showButtons=$r.showButtons,this._touchScrollEnable=$r.touchScrollEnable,this._mouseWheelEnable=$r.mouseWheelEnable,this.skin=$d,this.max=1;}$i($l,"laya.ui.ScrollBar",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),this.stopScroll(),this.target=null,$t.prototype.destroy.call(this,$d),this.upButton&&this.upButton.destroy($d),this.downButton&&this.downButton.destroy($d),this.slider&&this.slider.destroy($d),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null;},$d.createChildren=function(){this.addChild(this.slider=new $Z()),this.addChild(this.upButton=new $x()),this.addChild(this.downButton=new $x());},$d.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown);},$d.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value);},$d.onButtonMouseDown=function($d){var $t=$d.currentTarget===this.upButton;this.slide($t),$w.timer.once($M.scrollBarDelayTime,this,this.startLoop,[$t]),$w.stage.once("mouseup",this,this.onStageMouseUp);},$d.startLoop=function($d){$w.timer.frameLoop(1,this,this.slide,[$d]);},$d.slide=function($d){$d?this.value-=this._scrollSize:this.value+=this._scrollSize;},$d.onStageMouseUp=function($d){$w.timer.clear(this,this.startLoop),$w.timer.clear(this,this.slide);},$d.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint();},$d.changeSize=function(){$t.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value);},$d.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition();},$d.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width;},$d.setScroll=function($d,$t,$l){this.runCallLater(this.changeSize),this.slider.setSlider($d,$t,$l),this.slider.bar.visible=0<$t,!this._hide&&this.autoHide&&(this.visible=!1);},$d.onTargetMouseWheel=function($d){this.value-=$d.delta*this._scrollSize,this.target=this._target;},$d.onTargetMouseDown=function($d){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $Y()),this._lastPoint.setTo($w.stage.mouseX,$w.stage.mouseY),$w.timer.clear(this,this.tweenMove),$q.clearTween(this),$w.stage.once("mouseup",this,this.onStageMouseUp2),$w.stage.once("mouseout",this,this.onStageMouseUp2),$w.timer.frameLoop(1,this,this.loop);},$d.loop=function(){var $d=$w.stage.mouseY,$t=$w.stage.mouseX;if(this._lastOffset=this.isVertical?$d-this._lastPoint.y:$t-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$w.stage._canvasTransform.getScaleY():$w.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start");}this._offsets.push(this._lastOffset),this._lastPoint.x=$t,this._lastPoint.y=$d,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset);},$d.onStageMouseUp2=function($d){if($w.stage.off("mouseup",this,this.onStageMouseUp2),$w.stage.off("mouseout",this,this.onStageMouseUp2),$w.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$q.to(this,{value:this.min},this.elasticBackTime,$o.sineOut,$J.create(this,this.elasticOver)):this._value>this.max&&$q.to(this,{value:this.max},this.elasticBackTime,$o.sineOut,$J.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$w.stage.mouseY-this._lastPoint.y:$w.stage.mouseX-this._lastPoint.x);for(var $t=0,$l=Math.min(this._offsets.length,3),$k=0;$k<$l;$k++)$t+=this._offsets[this._offsets.length-1-$k];if(this._lastOffset=$t/$l,($t=Math.abs(this._lastOffset))<2)return void this.event("end");60<$t&&(this._lastOffset=0<this._lastOffset?60:-60);var $W=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$w.timer.frameLoop(1,this,this.tweenMove,[$W]);}},$d.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$q.to(this,{alpha:0},500),this.event("end");},$d.tweenMove=function($d){this._lastOffset*=this.rollRatio;var $t=NaN;if(0<$d&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$t=.5*-(this.min-$d-this.value),this._lastOffset>$t&&(this._lastOffset=$t)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$t=.5*-(this.max+$d-this.value),this._lastOffset<$t&&(this._lastOffset=$t))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($w.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$q.to(this,{value:this.min},this.elasticBackTime,$o.sineOut,$J.create(this,this.elasticOver)):this._value>this.max?$q.to(this,{value:this.max},this.elasticBackTime,$o.sineOut,$J.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$q.to(this,{alpha:0},500);}},$d.stopScroll=function(){this.onStageMouseUp2(null),$w.timer.clear(this,this.tweenMove),$q.clearTween(this);},$A(0,$d,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height;}),$A(0,$d,"skin",function(){return this._skin;},function($d){this._skin!=$d&&(this._skin=$d,this.slider.skin=this._skin,this.callLater(this.changeScrollBar));}),$A(0,$d,"max",function(){return this.slider.max;},function($d){this.slider.max=$d;}),$A(0,$d,"showButtons",function(){return this._showButtons;},function($d){this._showButtons=$d,this.callLater(this.changeScrollBar);}),$A(0,$d,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100;}),$A(0,$d,"min",function(){return this.slider.min;},function($d){this.slider.min=$d;}),$A(0,$d,"value",function(){return this._value;},function($d){$d!==this._value&&(this._value=$d,this._isElastic||(this.slider._value!=$d&&(this.slider._value=$d,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value));}),$A(0,$d,"isVertical",function(){return this.slider.isVertical;},function($d){this.slider.isVertical=$d;}),$A(0,$d,"sizeGrid",function(){return this.slider.sizeGrid;},function($d){this.slider.sizeGrid=$d;}),$A(0,$d,"scrollSize",function(){return this._scrollSize;},function($d){this._scrollSize=$d;}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)||"string"==typeof $d?this.value=Number($d):$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"thumbPercent",function(){return this._thumbPercent;},function($d){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$d=1<=$d?.99:$d,this._thumbPercent=$d,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$d,$M.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$d,$M.scrollBarMinNum));}),$A(0,$d,"target",function(){return this._target;},function($d){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$d)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown));}),$A(0,$d,"hide",function(){return this._hide;},function($d){this._hide=$d,this.visible=!$d;}),$A(0,$d,"touchScrollEnable",function(){return this._touchScrollEnable;},function($d){this._touchScrollEnable=$d,this.target=this._target;}),$A(0,$d,"mouseWheelEnable",function(){return this._mouseWheelEnable;},function($d){this._mouseWheelEnable=$d,this.target=this._target;}),$A(0,$d,"tick",function(){return this.slider.tick;},function($d){this.slider.tick=$d;}),$l;}($j),$Z=function($t){function $l($d){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$l.__super.call(this),this.skin=$d;}$i($l,"laya.ui.Slider",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._bg&&this._bg.destroy($d),this._bar&&this._bar.destroy($d),this._progress&&this._progress.destroy($d),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null;},$d.createChildren=function(){this.addChild(this._bg=new $U()),this.addChild(this._bar=new $x());},$d.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0;},$d.onBarMouseDown=function($d){this._globalSacle||(this._globalSacle=new $Y()),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$w.stage.mouseX,this._ty=$w.stage.mouseY,$w.stage.on("mousemove",this,this.mouseMove),$w.stage.once("mouseup",this,this.mouseUp),$w.stage.once("mouseout",this,this.mouseUp),this.showValueText();},$d.showValueText=function(){if(this.showLabel){var $d=laya.ui.Slider.label;this.addChild($d),$d.textField.changeText(this._value+""),this.isVertical?($d.x=this._bar.x+20,$d.y=.5*(this._bar.height-$d.height)+this._bar.y):($d.y=this._bar.y-20,$d.x=.5*(this._bar.width-$d.width)+this._bar.x);}},$d.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf();},$d.mouseUp=function($d){$w.stage.off("mousemove",this,this.mouseMove),$w.stage.off("mouseup",this,this.mouseUp),$w.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText();},$d.mouseMove=function($d){var $t=this._value;this.isVertical?(this._bar.y+=($w.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($w.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$w.stage.mouseX,this._ty=$w.stage.mouseY;var $l=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$l)/$l,this._value!=$t&&this.sendChangeEvent(),this.showValueText();},$d.sendChangeEvent=function($d){void 0===$d&&($d="change"),this.event($d),this.changeHandler&&this.changeHandler.runWith(this._value);},$d.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height));},$d.changeSize=function(){$t.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue();},$d.setSlider=function($d,$t,$l){this._value=-1,this._min=$d,this._max=$d<$t?$t:$d,this.value=$l<$d?$d:$t<$l?$t:$l;},$d.changeValue=function(){var $d=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$d)/$d,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $t=this._max-this._min;0===$t&&($t=1),this.isVertical?(this._bar.y=(this._value-this._min)/$t*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$t*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width));},$d.onBgMouseDown=function($d){var $t=this._bg.getMousePoint();this.isVertical?this.value=$t.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$t.x/(this.width-this._bar.width)*(this._max-this._min)+this._min;},$A(0,$d,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height);}),$A(0,$d,"skin",function(){return this._skin;},function($d){if(this._skin!=$d){this._skin=$d,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $t=this._skin.replace(".png","$progress.png");$e.getRes($t)&&(this._progress||(this.addChild(this._progress=new $U()),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$t),this.setBarPoint(),this.callLater(this.changeValue);}}),$A(0,$d,"allowClickBack",function(){return this._allowClickBack;},function($d){this._allowClickBack!=$d&&((this._allowClickBack=$d)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown));}),$A(0,$d,"max",function(){return this._max;},function($d){this._max!=$d&&(this._max=$d,this.callLater(this.changeValue));}),$A(0,$d,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width);}),$A(0,$d,"tick",function(){return this._tick;},function($d){this._tick!=$d&&(this._tick=$d,this.callLater(this.changeValue));}),$A(0,$d,"sizeGrid",function(){return this._bg.sizeGrid;},function($d){this._bg.sizeGrid=$d,this._bar.sizeGrid=$d,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid);}),$A(0,$d,"min",function(){return this._min;},function($d){this._min!=$d&&(this._min=$d,this.callLater(this.changeValue));}),$A(0,$d,"value",function(){return this._value;},function($d){if(this._value!=$d){var $t=this._value;this._value=$d,this.changeValue(),this._value!=$t&&this.sendChangeEvent();}}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)||"string"==typeof $d?this.value=Number($d):$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"bar",function(){return this._bar;}),$k($l,["label",function(){return this.label=new $E();}]),$l;}($j),$U=function($t){function $l($d){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$l.__super.call(this),this.skin=$d;}$i($l,"laya.ui.Image",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$e.clearCache(this,this._skin);},$d.dispose=function(){this.destroy(!0),$e.clearCache(this,this._skin),this.clearEvent();},$d.createChildren=function(){this.graphics=this._bitmap=new $S();},$d.setSource=function($d,$t){this.destroyed||$d===this._skin&&$t&&(this.source=$t,this.onCompResize(),this.clearEvent());},$d.clearEvent=function(){this._skin&&$W.atalsNotify&&$W.atalsNotify.off(this._skin,this,this.setSource);},$d.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$w.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$A(0,$d,"source",function(){return this._bitmap.source;},function($d){this._bitmap&&(this._bitmap.source=$d,this.event("loaded"),this.repaint());}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"string"==typeof(this._dataSource=$d)?this.skin=$d:$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"measureHeight",function(){return this._bitmap.height;}),$A(0,$d,"skin",function(){return this._skin;},function($d){if(this._skin!=$d)if($e.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$d){$e.keepCache(this,this._skin);var $t=$e.getRes($d),$l=$W.resAtalsObj&&$W.resAtalsObj[this._skin];$t?(this.source=$t,this.onCompResize()):$l?($W.atalsNotify&&$W.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$l.sourceW),0==this.height&&(this.height=$l.sourceH)):(this._complete=$J.create(this,this.setSource,[this._skin]),this._progress=null,$w.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group));}else this.source=null;}),$A(0,$d,"group",function(){return this._group;},function($d){$d&&this._skin&&$e.setGroup(this._skin,$d),this._group=$d;}),$A(0,$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($d){this._bitmap.sizeGrid=$T.fillArray($M.defaultSizeGrid,$d,Number);}),$A(0,$d,"measureWidth",function(){return this._bitmap.width;}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($j,this,"width",$d),this._bitmap.width=0==$d?1e-7:$d;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($j,this,"height",$d),this._bitmap.height=0==$d?1e-7:$d;}),$l;}($j),$E=function($t){function $l($d){this._tf=null,$l.__super.call(this),void 0===$d&&($d=""),$b.defaultColor=$M.labelColor,this.text=$d;}$i($l,"laya.ui.Label",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._tf=null;},$d.createChildren=function(){this.addChild(this._tf=new $R());},$d.changeText=function($d){this._tf.changeText($d);},$A(0,$d,"padding",function(){return this._tf.padding.join(",");},function($d){this._tf.padding=$T.fillArray($M.labelPadding,$d,Number);}),$A(0,$d,"bold",function(){return this._tf.bold;},function($d){this._tf.bold=$d;}),$A(0,$d,"align",function(){return this._tf.align;},function($d){this._tf.align=$d;}),$A(0,$d,"text",function(){return this._tf.text;},function($d){this._tf.text!=$d&&($d&&($d=$T.adptString($d+"")),this._tf.text=$d,this.event("change"),this._width&&this._height||this.onCompResize());}),$A(0,$d,"italic",function(){return this._tf.italic;},function($d){this._tf.italic=$d;}),$A(0,$d,"wordWrap",function(){return this._tf.wordWrap;},function($d){this._tf.wordWrap=$d;}),$A(0,$d,"font",function(){return this._tf.font;},function($d){this._tf.font=$d;}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)||"string"==typeof $d?this.text=$d+"":$w.superSet($j,this,"dataSource",$d);}),$A(0,$d,"color",function(){return this._tf.color;},function($d){this._tf.color=$d;}),$A(0,$d,"valign",function(){return this._tf.valign;},function($d){this._tf.valign=$d;}),$A(0,$d,"leading",function(){return this._tf.leading;},function($d){this._tf.leading=$d;}),$A(0,$d,"fontSize",function(){return this._tf.fontSize;},function($d){this._tf.fontSize=$d;}),$A(0,$d,"bgColor",function(){return this._tf.bgColor;},function($d){this._tf.bgColor=$d;}),$A(0,$d,"borderColor",function(){return this._tf.borderColor;},function($d){this._tf.borderColor=$d;}),$A(0,$d,"stroke",function(){return this._tf.stroke;},function($d){this._tf.stroke=$d;}),$A(0,$d,"strokeColor",function(){return this._tf.strokeColor;},function($d){this._tf.strokeColor=$d;}),$A(0,$d,"textField",function(){return this._tf;}),$A(0,$d,"measureWidth",function(){return this._tf.width;}),$A(0,$d,"measureHeight",function(){return this._tf.height;}),$A(0,$d,"width",function(){return this._width||this._tf.text?$w.superGet($j,this,"width"):0;},function($d){$w.superSet($j,this,"width",$d),this._tf.width=$d;}),$A(0,$d,"height",function(){return this._height||this._tf.text?$w.superGet($j,this,"height"):0;},function($d){$w.superSet($j,this,"height",$d),this._tf.height=$d;}),$A(0,$d,"overflow",function(){return this._tf.overflow;},function($d){this._tf.overflow=$d;}),$A(0,$d,"underline",function(){return this._tf.underline;},function($d){this._tf.underline=$d;}),$A(0,$d,"underlineColor",function(){return this._tf.underlineColor;},function($d){this._tf.underlineColor=$d;}),$l;}($j),$N=function($t){function $l($d){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$l.__super.call(this),this.skin=$d;}$i($l,"laya.ui.ProgressBar",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._bg&&this._bg.destroy($d),this._bar&&this._bar.destroy($d),this._bg=this._bar=null,this.changeHandler=null;},$d.createChildren=function(){this.addChild(this._bg=new $U()),this.addChild(this._bar=new $U());},$d.changeValue=function(){if(this.sizeGrid){var $d=this.sizeGrid.split(","),$t=Number($d[3]),$l=Number($d[1]),$k=(this.width-$t-$l)*this._value;this._bar.width=$t+$l+$k,this._bar.visible=this._bar.width>$t+$l;}else this._bar.width=this.width*this._value;},$A(0,$d,"measureHeight",function(){return this._bg.height;}),$A(0,$d,"skin",function(){return this._skin;},function($d){this._skin!=$d&&(this._skin=$d,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue));}),$A(0,$d,"measureWidth",function(){return this._bg.width;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($j,this,"height",$d),this._bg.height=this._height,this._bar.height=this._height;}),$A(0,$d,"bar",function(){return this._bar;}),$A(0,$d,"value",function(){return this._value;},function($d){this._value!=$d&&($d=1<$d?1:$d<0?0:$d,this._value=$d,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($d));}),$A(0,$d,"bg",function(){return this._bg;}),$A(0,$d,"sizeGrid",function(){return this._bg.sizeGrid;},function($d){this._bg.sizeGrid=this._bar.sizeGrid=$d;}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($j,this,"width",$d),this._bg.width=this._width,this.callLater(this.changeValue);}),$A(0,$d,"dataSource",$t.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)||"string"==typeof $d?this.value=Number($d):$w.superSet($j,this,"dataSource",$d);}),$l;}($j),$u=(function($d){function $l(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$l.__super.call(this),this._tipBox=new $j(),this._tipBox.addChild(this._tipText=new $R()),this._tipText.x=this._tipText.y=5,this._tipText.color=$l.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$w.stage.on("showtip",this,this._onStageShowTip),$w.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100;}$i($l,"laya.ui.TipManager",$j);var $t=$l.prototype;$t._onStageHideTip=function($d){$w.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf();},$t._onStageShowTip=function($d){$w.timer.once($l.tipDelay,this,this._showTip,[$d],!0);},$t._showTip=function($d){if("string"==typeof $d){var $t=String($d);Boolean($t)&&this._defaultTipHandler($t);}else $d instanceof laya.utils.Handler?$d.run():"function"==typeof $d&&$d.apply();$w.stage.on("mousemove",this,this._onStageMouseMove),$w.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null);},$t._onStageMouseDown=function($d){this.closeAll();},$t._onStageMouseMove=function($d){this._showToStage(this,$l.offsetX,$l.offsetY);},$t._showToStage=function($d,$t,$l){void 0===$t&&($t=0),void 0===$l&&($l=0);var $k=$d.getBounds();$d.x=$w.stage.mouseX+$t,$d.y=$w.stage.mouseY+$l,$d.x+$k.width>$w.stage.width&&($d.x-=$k.width+$t),$d.y+$k.height>$w.stage.height&&($d.y-=$k.height+$l);},$t.closeAll=function(){$w.timer.clear(this,this._showTip),$w.stage.off("mousemove",this,this._onStageMouseMove),$w.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren();},$t.showDislayTip=function($d){this.addChild($d),this._showToStage(this),$w._currentStage.addChild(this);},$t._showDefaultTip=function($d){this._tipText.text=$d;var $t=this._tipBox.graphics;$t.clear(),$t.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$l.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$w._currentStage.addChild(this);},$A(0,$t,"defaultTipHandler",function(){return this._defaultTipHandler;},function($d){this._defaultTipHandler=$d;}),$l.offsetX=10,$l.offsetY=15,$l.tipTextColor="#ffffff",$l.tipBackColor="#111111",$l.tipDelay=200;}(),function($d){var $c;function $Y(){this._idMap=null,this._aniList=null,this._watchMap={},$Y.__super.call(this);}$i($Y,"laya.ui.View",$K);var $t=$Y.prototype;return $t.createView=function($d){if($d.animations&&!this._idMap&&(this._idMap={}),$Y.createComp($d,this,this),$d.animations){var $t,$l,$k=[],$W=$d.animations,$i=0,$A=$W.length;for($i=0;$i<$A;$i++){switch($t=new $f(),$l=$W[$i],$t._setUp(this._idMap,$l),(this[$l.name]=$t)._setControlNode(this),$l.action){case 1:$t.play(0,!1);break;case 2:$t.play(0,!0);}$k.push($t);}this._aniList=$k;}0<this._width&&null==$d.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0);},$t.onEvent=function($d,$t){},$t.loadUI=function($d){var $t=$Y.uiMap[$d];$t&&this.createView($t);},$t.destroy=function($d){void 0===$d&&($d=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$d);},$t.changeData=function($d){var $t=this._watchMap[$d];if($t){console.log("change",$d);for(var $l=0,$k=$t.length;$l<$k;$l++){$t[$l].exe(this);}}},$Y._regs=function(){for(var $d in $Y.uiClassMap)$D.regClass($d,$Y.uiClassMap[$d]);},$Y.createComp=function($d,$t,$l,$k){if(!($t=$t||$Y.getCompInstance($d)))return console.warn("can not create:"+$d.type),null;var $W=$d.child;if($W)for(var $i=$t instanceof laya.ui.List,$A=0,$B=$W.length;$A<$B;$A++){var $o=$W[$A];if(!$t.hasOwnProperty("itemRender")||"render"!=$o.props.name&&"render"!==$o.props.renderType){if("Graphic"==$o.type)$D.addGraphicsToSprite($o,$t);else if($D.isDrawType($o.type))$D.addGraphicToSprite($o,$t,!0);else{if($i){var $I=[],$b=$Y.createComp($o,null,$l,$I);$I.length&&($b._$bindData=$I);}else $b=$Y.createComp($o,null,$l,$k);"Script"==$o.type?"owner"in $b?$b.owner=$t:"target"in $b&&($b.target=$t):"mask"==$o.props.renderType||"mask"==$o.props.name?$t.mask=$b:$b instanceof laya.display.Sprite&&$t.addChild($b);}}else $t.itemRender=$o;}var $f=$d.props;for(var $J in $f){var $c=$f[$J];$Y.eventDic[$J]?$c&&$l&&$t.on($J,$l,$l.onEvent,[$c]):$Y.setCompValue($t,$J,$c,$l,$k);}return $w.__typeof($t,"laya.ui.IItem")&&$t.initItems(),$d.compId&&$l&&$l._idMap&&($l._idMap[$d.compId]=$t),$t;},$Y.setCompValue=function($d,$t,$l,$k,$W){if("string"==typeof $l&&-1<$l.indexOf("${")){if($Y._sheet||($Y._sheet=$D.getClass("laya.data.Table")),!$Y._sheet)return void console.warn("Can not find class Sheet");if($W)$W.push($d,$t,$l);else if($k){-1==$l.indexOf("].")&&($l=$l.replace(".","[0]."));var $i,$A,$B=new $c($d,$t,$l);$B.exe($k);for(var $o=$l.replace(/\[.*?\]\./g,".");null!=($i=$Y._parseWatchData.exec($o));){for(var $I=$i[1];null!=($A=$Y._parseKeyWord.exec($I));){var $b=$A[0],$f=$k._watchMap[$b]||($k._watchMap[$b]=[]);$f.push($B),$Y._sheet.I.notifer.on($b,$k,$k.changeData,[$b]);}($f=$k._watchMap[$I]||($k._watchMap[$I]=[])).push($B),$Y._sheet.I.notifer.on($I,$k,$k.changeData,[$I]);}}}else if("var"===$t&&$k)$k[$l]=$d;else if("onClick"==$t){var $J=$w._runScript("(function(){"+$l+"})");$d.on("click",$k,$J);}else $d[$t]="true"===$l||"false"!==$l&&$l;},$Y.getCompInstance=function($d){var $t,$l=$d.props?$d.props.runtime:null;return $t=$l?$Y.viewClassMap[$l]||$Y.uiClassMap[$l]||$w.__classmap[$l]:$Y.uiClassMap[$d.type],$d.props&&$d.props.hasOwnProperty("renderType")&&"instance"==$d.props.renderType?$t.instance:$t?new $t():null;},$Y.regComponent=function($d,$t){$Y.uiClassMap[$d]=$t,$D.regClass($d,$t);},$Y.regViewRuntime=function($d,$t){$Y.viewClassMap[$d]=$t;},$Y.uiMap={},$Y.viewClassMap={},$Y._sheet=null,$k($Y,["uiClassMap",function(){return this.uiClassMap={ViewStack:$dd,LinkButton:$x,TextArea:$Id,ColorPicker:$Q,Box:$K,Button:$x,CheckBox:$h,Clip:$n,ComboBox:$y,Component:$j,HScrollBar:$m,HSlider:$F,Image:$U,Label:$E,List:$X,Panel:$O,ProgressBar:$N,Radio:$_,RadioGroup:$Bd,ScrollBar:$V,Slider:$Z,Tab:$od,TextInput:$ld,View:$Y,VScrollBar:$td,VSlider:$kd,Tree:$v,HBox:$id,VBox:$Ad,Sprite:$H,Animation:$l,Text:$R,FontClip:$P};},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0};},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g;},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;}]),$Y.__init$=function(){$Y._regs(),$c=function(){function $d($d,$t,$l){this.comp=null,this.prop=null,this.value=null,this.comp=$d,this.prop=$t,this.value=$l;}return $i($d,""),$d.prototype.exe=function($d){var $t=$T.getBindFun(this.value);this.comp[this.prop]=$t.call(this,$d);},$d;}();},$Y;}()),$h=function($d){function $l($d,$t){void 0===$t&&($t=""),$l.__super.call(this,$d,$t);}$i($l,"laya.ui.CheckBox",$d);var $t=$l.prototype;return $t.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1;},$t.initialize=function(){$d.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0;},$A(0,$t,"dataSource",$d.prototype._$get_dataSource,function($d){"boolean"==typeof(this._dataSource=$d)?this.selected=$d:"string"==typeof $d?this.selected="true"===$d:$w.superSet($x,this,"dataSource",$d);}),$l;}($x),$s=function($d){function $t(){this._space=0,this._align="none",this._itemChanged=!1,$t.__super.call(this);}$i($t,"laya.ui.LayoutBox",$K);var $l=$t.prototype;return $l.addChild=function($d){return $d.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$d);},$l.onResize=function($d){this._setItemChanged();},$l.addChildAt=function($d,$t){return $d.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$d,$t);},$l.removeChild=function($d){return $d.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$d);},$l.removeChildAt=function($d){return this.getChildAt($d).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$d);},$l.refresh=function(){this._setItemChanged();},$l.changeItems=function(){this._itemChanged=!1;},$l.sortItem=function($d){$d&&$d.sort(function($d,$t){return $d.y-$t.y;});},$l._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems));},$A(0,$l,"space",function(){return this._space;},function($d){this._space=$d,this._setItemChanged();}),$A(0,$l,"align",function(){return this._align;},function($d){this._align=$d,this._setItemChanged();}),$t;}(),$P=function($t){function $l($d,$t){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$l.__super.call(this),$d&&(this.skin=$d),$t&&(this.sheet=$t);}$i($l,"laya.ui.FontClip",$t);var $d=$l.prototype;return $d.createChildren=function(){this._bitmap=new $S(),this.on("loaded",this,this._onClipLoaded);},$d._onClipLoaded=function(){this.callLater(this.changeValue);},$d.changeValue=function(){var $d;if(this._sources&&this._valueArr&&(this.graphics.clear(!0),$d=this._sources[0])){var $t="horizontal"===this._direction;$t?(this._wordsW=this._valueArr.length*($d.sourceWidth+this.spaceX),this._wordsH=$d.sourceHeight):(this._wordsW=$d.sourceWidth,this._wordsH=($d.sourceHeight+this.spaceY)*this._valueArr.length);var $l=0;if(this._width)switch(this._align){case"center":$l=.5*(this._width-this._wordsW);break;case"right":$l=this._width-this._wordsW;break;default:$l=0;}for(var $k=0,$W=this._valueArr.length;$k<$W;$k++){var $i=this._indexMap[this._valueArr.charAt($k)];this.sources[$i]&&($d=this.sources[$i],$t?this.graphics.drawTexture($d,$l+$k*($d.sourceWidth+this.spaceX),0,$d.sourceWidth,$d.sourceHeight):this.graphics.drawTexture($d,0+$l,$k*($d.sourceHeight+this.spaceY),$d.sourceWidth,$d.sourceHeight));}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize));}},$d.destroy=function($d){void 0===$d&&($d=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$t.prototype.destroy.call(this,$d);},$A(0,$d,"sheet",function(){return this._sheet;},function($d){$d+="";var $t=(this._sheet=$d).split(" ");this._clipX=String($t[0]).length,this.clipY=$t.length,this._indexMap={};for(var $l=0;$l<this._clipY;$l++)for(var $k=$t[$l].split(""),$W=0,$i=$k.length;$W<$i;$W++)this._indexMap[$k[$W]]=$l*this._clipX+$W;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($n,this,"height",$d),this.callLater(this.changeValue);}),$A(0,$d,"direction",function(){return this._direction;},function($d){this._direction=$d,this.callLater(this.changeValue);}),$A(0,$d,"value",function(){return this._valueArr?this._valueArr:"";},function($d){$d+="",this._valueArr=$d,this.callLater(this.changeValue);}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($n,this,"width",$d),this.callLater(this.changeValue);}),$A(0,$d,"spaceX",function(){return this._spaceX;},function($d){this._spaceX=$d,"horizontal"===this._direction&&this.callLater(this.changeValue);}),$A(0,$d,"spaceY",function(){return this._spaceY;},function($d){this._spaceY=$d,"horizontal"!==this._direction&&this.callLater(this.changeValue);}),$A(0,$d,"align",function(){return this._align;},function($d){this._align=$d,this.callLater(this.changeValue);}),$A(0,$d,"measureWidth",function(){return this._wordsW;}),$A(0,$d,"measureHeight",function(){return this._wordsH;}),$l;}($n),$X=function($d){function $t(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $Y(),$t.__super.call(this);}$i($t,"laya.ui.List",$d);var $l=$t.prototype;return $w.imps($l,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$l.destroy=function($d){void 0===$d&&($d=!0),this._content&&this._content.destroy($d),this._scrollBar&&this._scrollBar.destroy($d),laya.ui.Component.prototype.destroy.call(this,$d),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null;},$l.createChildren=function(){this.addChild(this._content=new $K());},$l.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$w.superGet($K,this,"cacheAs")),$w.superSet($K,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd);},$l.onScrollEnd=function(){$w.superSet($K,this,"cacheAs",this._$P.cacheAs);},$l._removePreScrollBar=function(){var $d=this.removeChildByName("scrollBar");$d&&$d.destroy(!0);},$l.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $d=this._getOneCell(),$t=$d.width+this._spaceX||1,$l=$d.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$t):Math.ceil(this._width/$t)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$l):Math.round(this._height/$l));var $k=this._width?this._width:$t*this.repeatX-this._spaceX,$W=this._height?this._height:$l*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$l:$t,this._cellOffset=this._isVertical?$l*Math.max(this._repeatY2,this._repeatY)-$W-this._spaceY:$t*Math.max(this._repeatX2,this._repeatX)-$k-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$W:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$k),this.setContentSize($k,$W);var $i=this._isVertical?this.repeatX:this.repeatY,$A=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$i,$A),this._createdLine=$A,this._array&&(this.array=this._array,this.runCallLater(this.renderItems));}},$l._getOneCell=function(){if(0===this._cells.length){var $d=this.createItem();if(this._offset.setTo($d.x,$d.y),this.cacheContent)return $d;this._cells.push($d);}return this._cells[0];},$l._createItems=function($d,$t,$l){var $k=this._content,$W=this._getOneCell(),$i=$W.width+this._spaceX,$A=$W.height+this._spaceY;if(this.cacheContent){var $B=new $K();$B.cacheAsBitmap=!0,$B.pos((this._isVertical?0:$d)*$i,(this._isVertical?$d:0)*$A),this._content.addChild($B),this._content.optimizeScrollRect=!0,$k=$B;}else{for(var $o=[],$I=this._cells.length-1;-1<$I;$I--){var $b=this._cells[$I];$b.removeSelf(),$o.push($b);}this._cells.length=0;}for(var $f=$d;$f<$l;$f++)for(var $J=0;$J<$t;$J++)($W=$o&&$o.length?$o.pop():this.createItem()).x=(this._isVertical?$J:$f)*$i-$k.x,$W.y=(this._isVertical?$f:$J)*$A-$k.y,$W.name="item"+($f*$t+$J),$k.addChild($W),this.addCell($W);},$l.createItem=function(){var $d=[];if("function"==typeof this._itemRender)var $t=new this._itemRender();else $t=$u.createComp(this._itemRender,null,null,$d);if(0==$d.length&&$t._watchMap){var $l=$t._watchMap;for(var $k in $l)for(var $W=$l[$k],$i=0;$i<$W.length;$i++){var $A=$W[$i];$d.push($A.comp,$A.prop,$A.value);}}return $d.length&&($t._$bindData=$d),$t;},$l.addCell=function($d){$d.on("click",this,this.onCellMouse),$d.on("rightclick",this,this.onCellMouse),$d.on("mouseover",this,this.onCellMouse),$d.on("mouseout",this,this.onCellMouse),$d.on("mousedown",this,this.onCellMouse),$d.on("mouseup",this,this.onCellMouse),this._cells.push($d);},$l.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $d=0,$t=$d=0;$t<1e4;$t++){var $l=this.getChildByName("item"+$t);if(!$l)break;this.addCell($l),$d++;}this.repeatY=$d;}},$l.setContentSize=function($d,$t){this._content.width=$d,this._content.height=$t,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $z()),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$d,$t),this._content.scrollRect=this._content.scrollRect),this.event("resize");},$l.onCellMouse=function($d){"mousedown"===$d.type&&(this._isMoved=!1);var $t=$d.currentTarget,$l=this._startIndex+this._cells.indexOf($t);$l<0||("click"===$d.type||"rightclick"===$d.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$l:this.changeCellState($t,!0,0):"mouseover"!==$d.type&&"mouseout"!==$d.type||this._selectedIndex===$l||this.changeCellState($t,"mouseover"===$d.type,0),this.mouseHandler&&this.mouseHandler.runWith([$d,$l]));},$l.changeCellState=function($d,$t,$l){var $k=$d.getChildByName("selectBox");$k&&(this.selectEnable=!0,$k.visible=$t,$k.index=$l);},$l.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange);},$l.onScrollBarChange=function($d){this.runCallLater(this.changeCells);var $t=this._scrollBar.value,$l=this._isVertical?this.repeatX:this.repeatY,$k=this._isVertical?this.repeatY:this.repeatX,$W=Math.floor($t/this._cellSize);if(this.cacheContent)$A=$k+1,this._createdLine-$W<$A&&(this._createItems(this._createdLine,$l,this._createdLine+$A),this.renderItems(this._createdLine*$l,0),this._createdLine+=$A);else{var $i=$W*$l,$A=0;if($i>this._startIndex){$A=$i-this._startIndex;var $B=!0,$o=this._startIndex+$l*($k+1);this._isMoved=!0;}else $i<this._startIndex&&($A=this._startIndex-$i,$B=!1,$o=this._startIndex-1,this._isMoved=!0);for(var $I=0;$I<$A;$I++){if($B){var $b=this._cells.shift();this._cells[this._cells.length]=$b;var $f=$o+$I;}else $b=this._cells.pop(),this._cells.unshift($b),$f=$o-$I;var $J=Math.floor($f/$l)*this._cellSize;this._isVertical?$b.y=$J:$b.x=$J,this.renderItem($b,$f);}this._startIndex=$i,this.changeSelectStatus();}var $c=this._content.scrollRect;this._isVertical?($c.y=$t-this._offset.y,$c.x=-this._offset.x):($c.y=-this._offset.y,$c.x=$t-this._offset.x),this._content.scrollRect=$c;},$l.posCell=function($d,$t){if(this._scrollBar){var $l=this._isVertical?this.repeatX:this.repeatY,$k=(this._isVertical?this.repeatY:this.repeatX,Math.floor($t/$l)*this._cellSize);this._isVertical?$d.y=$k:$d.x=$k;}},$l.changeSelectStatus=function(){for(var $d=0,$t=this._cells.length;$d<$t;$d++)this.changeCellState(this._cells[$d],this._selectedIndex===this._startIndex+$d,1);},$l.renderItems=function($d,$t){void 0===$d&&($d=0),void 0===$t&&($t=0);for(var $l=$d,$k=$t||this._cells.length;$l<$k;$l++)this.renderItem(this._cells[$l],this._startIndex+$l);this.changeSelectStatus(),this._twDone=!0;},$l.renderItem=function($d,$t){this._array&&0<=$t&&$t<this._array.length?($d.visible=!0,$d._$bindData?($d._dataSource=this._array[$t],this._bindData($d,this._array[$t])):$d.dataSource=this._array[$t],this.cacheContent||this.posCell($d,$t),this.hasListener("render")&&this.event("render",[$d,$t]),this.renderHandler&&this.renderHandler.runWith([$d,$t]),this.renderTwHandler&&this.renderTwHandler.runWith([$d,$t])):($d.visible=!1,$d.dataSource=null);},$l._bindData=function($d,$t){for(var $l=$d._$bindData,$k=0,$W=$l.length;$k<$W;$k++){var $i=$l[$k++],$A=$l[$k++],$B=$l[$k],$o=$T.getBindFun($B);$i[$A]=$o.call(this,$t);}},$l.refresh=function(){this.array=this._array;},$l.getItem=function($d){return-1<$d&&$d<this._array.length?this._array[$d]:null;},$l.changeItem=function($d,$t){-1<$d&&$d<this._array.length&&(this._array[$d]=$t,$d>=this._startIndex&&$d<this._startIndex+this._cells.length&&this.renderItem(this.getCell($d),$d));},$l.setItem=function($d,$t){this.changeItem($d,$t);},$l.addItem=function($d){this._array.push($d),this.array=this._array;},$l.addItemAt=function($d,$t){this._array.splice($t,0,$d),this.array=this._array;},$l.deleteItem=function($d){this._array.splice($d,1),this.array=this._array;},$l.getCell=function($d){return this.runCallLater(this.changeCells),-1<$d&&this._cells?this._cells[($d-this._startIndex)%this._cells.length]:null;},$l.scrollTo=function($d){if(this._scrollBar){var $t=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($d/$t)*this._cellSize;}else this.startIndex=$d;},$l.tweenTo=function($d,$t,$l){if(void 0===$t&&($t=200),this._scrollBar){var $k=this._isVertical?this.repeatX:this.repeatY;$q.to(this._scrollBar,{value:Math.floor($d/$k)*this._cellSize},$t,null,$l,0,!0);}else this.startIndex=$d,$l&&$l.run();},$l._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells));},$l.commitMeasure=function(){this.runCallLater(this.changeCells);},$A(0,$l,"cacheAs",$d.prototype._$get_cacheAs,function($d){$w.superSet($K,this,"cacheAs",$d),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$d?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart));}),$A(0,$l,"content",function(){return this._content;}),$A(0,$l,"height",$d.prototype._$get_height,function($d){$d!=this._height&&($w.superSet($K,this,"height",$d),this._setCellChanged());}),$A(0,$l,"itemRender",function(){return this._itemRender;},function($d){if(this._itemRender!=$d){this._itemRender=$d;for(var $t=this._cells.length-1;-1<$t;$t--)this._cells[$t].destroy();this._cells.length=0,this._setCellChanged();}}),$A(0,$l,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($d){this._removePreScrollBar();var $t=new $td();$t.name="scrollBar",$t.right=0,$d&&" "!=$d&&($t.skin=$d),this.scrollBar=$t,this.addChild($t),this._setCellChanged();}),$A(0,$l,"page",function(){return this._page;},function($d){this._page=$d,this._array&&(this._page=0<$d?$d:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY);}),$A(0,$l,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($d){this._removePreScrollBar();var $t=new $m();$t.name="scrollBar",$t.bottom=0,$d&&" "!=$d&&($t.skin=$d),this.scrollBar=$t,this.addChild($t),this._setCellChanged();}),$A(0,$l,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1;},function($d){this._repeatX=$d,this._setCellChanged();}),$A(0,$l,"scrollBar",function(){return this._scrollBar;},function($d){this._scrollBar!=$d&&(this._scrollBar=$d)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange));}),$A(0,$l,"width",$d.prototype._$get_width,function($d){$d!=this._width&&($w.superSet($K,this,"width",$d),this._setCellChanged());}),$A(0,$l,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1;},function($d){this._repeatY=$d,this._setCellChanged();}),$A(0,$l,"spaceX",function(){return this._spaceX;},function($d){this._spaceX=$d,this._setCellChanged();}),$A(0,$l,"spaceY",function(){return this._spaceY;},function($d){this._spaceY=$d,this._setCellChanged();}),$A(0,$l,"selectedIndex",function(){return this._selectedIndex;},function($d){this._selectedIndex!=$d&&(this._selectedIndex=$d,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($d),this.startIndex=this._startIndex);}),$A(0,$l,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null;},function($d){this.selectedIndex=this._array.indexOf($d);}),$A(0,$l,"length",function(){return this._array?this._array.length:0;}),$A(0,$l,"selection",function(){return this.getCell(this._selectedIndex);},function($d){this.selectedIndex=this._startIndex+this._cells.indexOf($d);}),$A(0,$l,"startIndex",function(){return this._startIndex;},function($d){this._startIndex=0<$d?$d:0,this.callLater(this.renderItems);}),$A(0,$l,"twSwitch",function(){return this._twSwitch;},function($d){this._twSwitch=$d;}),$A(0,$l,"twDone",function(){return this._twDone;},function($d){this._twDone=$d;}),$A(0,$l,"array",function(){return this._array;},function($d){this.runCallLater(this.changeCells),this._array=$d||[];var $t=this._array.length;if(this.totalPage=Math.ceil($t/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$t?this._selectedIndex:$t-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $l=this._isVertical?this.repeatX:this.repeatY,$k=this._isVertical?this.repeatY:this.repeatX,$W=Math.ceil($t/$l);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$k/$W,this._scrollBar.setScroll(0,($W-$k)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content;}}),$A(0,$l,"dataSource",$d.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)&&Math.floor($d)==$d||"string"==typeof $d?this.selectedIndex=parseInt($d):$d instanceof Array?this.array=$d:$w.superSet($K,this,"dataSource",$d);}),$A(0,$l,"cells",function(){return this.runCallLater(this.changeCells),this._cells;}),$t;}($K),$m=function($d){function $t(){$t.__super.call(this);}return $i($t,"laya.ui.HScrollBar",$d),$t.prototype.initialize=function(){$d.prototype.initialize.call(this),this.slider.isVertical=!1;},$t;}($V),$O=function($d){function $t(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$t.__super.call(this),this.width=this.height=100;}$i($t,"laya.ui.Panel",$d);var $l=$t.prototype;return $l.destroy=function($d){void 0===$d&&($d=!0),laya.ui.Component.prototype.destroy.call(this,$d),this._content&&this._content.destroy($d),this._vScrollBar&&this._vScrollBar.destroy($d),this._hScrollBar&&this._hScrollBar.destroy($d),this._vScrollBar=null,this._hScrollBar=null,this._content=null;},$l.destroyChildren=function(){this._content.destroyChildren();},$l.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $K());},$l.addChild=function($d){return $d.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($d);},$l.onResize=function(){this._setScrollChanged();},$l.addChildAt=function($d,$t){return $d.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($d,$t);},$l.removeChild=function($d){return $d.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($d);},$l.removeChildAt=function($d){return this.getChildAt($d).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($d);},$l.removeChildren=function($d,$t){return void 0===$d&&($d=0),void 0===$t&&($t=2147483647),this._content.removeChildren($d,$t),this._setScrollChanged(),this;},$l.getChildAt=function($d){return this._content.getChildAt($d);},$l.getChildByName=function($d){return this._content.getChildByName($d);},$l.getChildIndex=function($d){return this._content.getChildIndex($d);},$l.changeScroll=function(){this._scrollChanged=!1;var $d=this.contentWidth||1,$t=this.contentHeight||1,$l=this._vScrollBar,$k=this._hScrollBar,$W=$l&&$t>this._height,$i=$k&&$d>this._width,$A=$W?this._width-$l.width:this._width,$B=$i?this._height-$k.height:this._height;$l&&($l.x=this._width-$l.width,$l.y=0,$l.height=this._height-($i?$k.height:0),$l.scrollSize=Math.max(.033*this._height,1),$l.thumbPercent=$B/$t,$l.setScroll(0,$t-$B,$l.value)),$k&&($k.x=0,$k.y=this._height-$k.height,$k.width=this._width-($W?$l.width:0),$k.scrollSize=Math.max(.033*this._width,1),$k.thumbPercent=$A/$d,$k.setScroll(0,$d-$A,$k.value));},$l.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height);},$l.setContentSize=function($d,$t){var $l=this._content;$l.width=$d,$l.height=$t,$l.scrollRect||($l.scrollRect=new $z()),$l.scrollRect.setTo(0,0,$d,$t),$l.scrollRect=$l.scrollRect;},$l.onScrollBarChange=function($d){var $t=this._content.scrollRect;if($t){var $l=Math.round($d.value);$d.isVertical?$t.y=$l:$t.x=$l,this._content.scrollRect=$t;}},$l.scrollTo=function($d,$t){void 0===$d&&($d=0),void 0===$t&&($t=0),this.vScrollBar&&(this.vScrollBar.value=$t),this.hScrollBar&&(this.hScrollBar.value=$d);},$l.refresh=function(){this.changeScroll();},$l.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$w.superGet($K,this,"cacheAs")),$w.superSet($K,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd);},$l.onScrollEnd=function(){$w.superSet($K,this,"cacheAs",this._$P.cacheAs);},$l._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll));},$A(0,$l,"numChildren",function(){return this._content.numChildren;}),$A(0,$l,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($d){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $m()),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$d;}),$A(0,$l,"contentWidth",function(){for(var $d=0,$t=this._content.numChildren-1;-1<$t;$t--){var $l=this._content.getChildAt($t);$d=Math.max($l.x+$l.width*$l.scaleX,$d);}return $d;}),$A(0,$l,"contentHeight",function(){for(var $d=0,$t=this._content.numChildren-1;-1<$t;$t--){var $l=this._content.getChildAt($t);$d=Math.max($l.y+$l.height*$l.scaleY,$d);}return $d;}),$A(0,$l,"width",$d.prototype._$get_width,function($d){$w.superSet($K,this,"width",$d),this._setScrollChanged();}),$A(0,$l,"hScrollBar",function(){return this._hScrollBar;}),$A(0,$l,"content",function(){return this._content;}),$A(0,$l,"height",$d.prototype._$get_height,function($d){$w.superSet($K,this,"height",$d),this._setScrollChanged();}),$A(0,$l,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($d){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $td()),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$d;}),$A(0,$l,"vScrollBar",function(){return this._vScrollBar;}),$A(0,$l,"cacheAs",$d.prototype._$get_cacheAs,function($d){$w.superSet($K,this,"cacheAs",$d),this._$P.cacheAs=null,"none"!==$d?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart));}),$t;}($K),$F=function($d){function $t($d){$t.__super.call(this,$d),this.isVertical=!1;}return $i($t,"laya.ui.HSlider",$Z),$t;}(),$a=function($d){function $l($d,$t){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$l.__super.call(this),this.skin=$t,this.labels=$d;}$i($l,"laya.ui.UIGroup",$d);var $t=$l.prototype;return $w.imps($t,{"laya.ui.IItem":!0}),$t.preinitialize=function(){this.mouseEnabled=!0;},$t.destroy=function($d){void 0===$d&&($d=!0),laya.ui.Component.prototype.destroy.call(this,$d),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null;},$t.addItem=function($d,$t){void 0===$t&&($t=!0);var $l=$d,$k=this._items.length;if($l.name="item"+$k,this.addChild($l),this.initItems(),$t&&0<$k){var $W=this._items[$k-1];"horizontal"==this._direction?$l.x=$W.x+$W.width+this._space:$l.y=$W.y+$W.height+this._space;}else $t&&($l.x=0,$l.y=0);return $k;},$t.delItem=function($d,$t){void 0===$t&&($t=!0);var $l=this._items.indexOf($d);if(-1!=$l){var $k=$d;this.removeChild($k);for(var $W=$l+1,$i=this._items.length;$W<$i;$W++){var $A=this._items[$W];$A.name="item"+($W-1),$t&&("horizontal"==this._direction?$A.x-=$k.width+this._space:$A.y-=$k.height+this._space);}if(this.initItems(),-1<this._selectedIndex){var $B;$B=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$B;}}},$t.initItems=function(){this._items||(this._items=[]);for(var $d=this._items.length=0;$d<1e4;$d++){var $t=this.getChildByName("item"+$d);if(null==$t)break;this._items.push($t),$t.selected=$d===this._selectedIndex,$t.clickHandler=$J.create(this,this.itemClick,[$d],!1);}},$t.itemClick=function($d){this.selectedIndex=$d;},$t.setSelect=function($d,$t){this._items&&-1<$d&&$d<this._items.length&&(this._items[$d].selected=$t);},$t.createItem=function($d,$t){return null;},$t.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $d=0,$t=0,$l=this._items.length;$t<$l;$t++){var $k=this._items[$t];this._skin&&($k.skin=this._skin),this._labelColors&&($k.labelColors=this._labelColors),this._labelSize&&($k.labelSize=this._labelSize),this._labelStroke&&($k.labelStroke=this._labelStroke),this._labelStrokeColor&&($k.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($k.strokeColors=this._strokeColors),this._labelBold&&($k.labelBold=this._labelBold),this._labelPadding&&($k.labelPadding=this._labelPadding),this._labelAlign&&($k.labelAlign=this._labelAlign),this._stateNum&&($k.stateNum=this._stateNum),this._labelFont&&($k.labelFont=this._labelFont),"horizontal"===this._direction?($k.y=0,$k.x=$d,$d+=$k.width+this._space):($k.x=0,$k.y=$d,$d+=$k.height+this._space);}this.changeSize();},$t.commitMeasure=function(){this.runCallLater(this.changeLabels);},$t._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels));},$A(0,$t,"labelStrokeColor",function(){return this._labelStrokeColor;},function($d){this._labelStrokeColor!=$d&&(this._labelStrokeColor=$d,this._setLabelChanged());}),$A(0,$t,"skin",function(){return this._skin;},function($d){this._skin!=$d&&(this._skin=$d,this._setLabelChanged());}),$A(0,$t,"selectedIndex",function(){return this._selectedIndex;},function($d){this._selectedIndex!=$d&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$d,this.setSelect($d,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex));}),$A(0,$t,"labels",function(){return this._labels;},function($d){if(this._labels!=$d){if(this._labels=$d,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $t=this._labels.split(","),$l=0,$k=$t.length;$l<$k;$l++){var $W=this.createItem(this._skin,$t[$l]);$W.name="item"+$l,this.addChild($W);}this.initItems();}}),$A(0,$t,"strokeColors",function(){return this._strokeColors;},function($d){this._strokeColors!=$d&&(this._strokeColors=$d,this._setLabelChanged());}),$A(0,$t,"labelColors",function(){return this._labelColors;},function($d){this._labelColors!=$d&&(this._labelColors=$d,this._setLabelChanged());}),$A(0,$t,"labelStroke",function(){return this._labelStroke;},function($d){this._labelStroke!=$d&&(this._labelStroke=$d,this._setLabelChanged());}),$A(0,$t,"labelSize",function(){return this._labelSize;},function($d){this._labelSize!=$d&&(this._labelSize=$d,this._setLabelChanged());}),$A(0,$t,"stateNum",function(){return this._stateNum;},function($d){this._stateNum!=$d&&(this._stateNum=$d,this._setLabelChanged());}),$A(0,$t,"labelBold",function(){return this._labelBold;},function($d){this._labelBold!=$d&&(this._labelBold=$d,this._setLabelChanged());}),$A(0,$t,"labelFont",function(){return this._labelFont;},function($d){this._labelFont!=$d&&(this._labelFont=$d,this._setLabelChanged());}),$A(0,$t,"labelPadding",function(){return this._labelPadding;},function($d){this._labelPadding!=$d&&(this._labelPadding=$d,this._setLabelChanged());}),$A(0,$t,"direction",function(){return this._direction;},function($d){this._direction=$d,this._setLabelChanged();}),$A(0,$t,"space",function(){return this._space;},function($d){this._space=$d,this._setLabelChanged();}),$A(0,$t,"items",function(){return this._items;}),$A(0,$t,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($d){this.selectedIndex=this._items.indexOf($d);}),$A(0,$t,"dataSource",$d.prototype._$get_dataSource,function($d){"number"==typeof(this._dataSource=$d)&&Math.floor($d)==$d||"string"==typeof $d?this.selectedIndex=parseInt($d):$d instanceof Array?this.labels=$d.join(","):$w.superSet($K,this,"dataSource",$d);}),$l;}($K),$_=function($t){function $l($d,$t){this._value=null,void 0===$t&&($t=""),$l.__super.call(this,$d,$t);}$i($l,"laya.ui.Radio",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._value=null;},$d.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1;},$d.initialize=function(){$t.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick);},$d.onClick=function($d){this.selected=!0;},$A(0,$d,"value",function(){return null!=this._value?this._value:this.label;},function($d){this._value=$d;}),$l;}($x),$v=function($d){function $t(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$t.__super.call(this),this.width=this.height=200;}$i($t,"laya.ui.Tree",$d);var $l=$t.prototype;return $w.imps($l,{"laya.ui.IRender":!0}),$l.destroy=function($d){void 0===$d&&($d=!0),laya.ui.Component.prototype.destroy.call(this,$d),this._list&&this._list.destroy($d),this._list=null,this._source=null,this._renderHandler=null;},$l.createChildren=function(){this.addChild(this._list=new $X()),this._list.renderHandler=$J.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange);},$l.onListChange=function($d){this.event("change");},$l.getArray=function(){var $d,$t=[];for(var $l in this._source)$d=this._source[$l],this.getParentOpenStatus($d)&&($d.x=this._spaceLeft*this.getDepth($d),$t.push($d));return $t;},$l.getDepth=function($d,$t){return void 0===$t&&($t=0),null==$d.nodeParent?$t:this.getDepth($d.nodeParent,$t+1);},$l.getParentOpenStatus=function($d){var $t=$d.nodeParent;return null==$t||!!$t.isOpen&&(null==$t.nodeParent||this.getParentOpenStatus($t));},$l.renderItem=function($d,$t){var $l=$d.dataSource;if($l){$d.left=$l.x;var $k=$d.getChildByName("arrow");$k&&($l.hasChild?($k.visible=!0,$k.index=$l.isOpen?1:0,$k.tag=$t,$k.off("click",this,this.onArrowClick),$k.on("click",this,this.onArrowClick)):$k.visible=!1);var $W=$d.getChildByName("folder");$W&&(2==$W.clipY?$W.index=$l.isDirectory?0:1:$W.index=$l.isDirectory?$l.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$d,$t]);}},$l.onArrowClick=function($d){var $t=$d.currentTarget.tag;this._list.array[$t].isOpen=!this._list.array[$t].isOpen,this.event("open"),this._list.array=this.getArray();},$l.setItemState=function($d,$t){this._list.array[$d]&&(this._list.array[$d].isOpen=$t,this._list.array=this.getArray());},$l.fresh=function(){this._list.array=this.getArray(),this.repaint();},$l.parseXml=function($d,$t,$l,$k){var $W,$i=$d.childNodes,$A=$i.length;if(!$k){$W={};var $B,$o=$d.attributes;for(var $I in $o){var $b=($B=$o[$I]).nodeName,$f=$B.nodeValue;$W[$b]="true"==$f||"false"!=$f&&$f;}$W.nodeParent=$l,0<$A&&($W.isDirectory=!0),$W.hasChild=0<$A,$t.push($W);}for(var $J=0;$J<$A;$J++){var $c=$i[$J];this.parseXml($c,$t,$W,!1);}},$l.parseOpenStatus=function($d,$t){for(var $l=0,$k=$t.length;$l<$k;$l++){var $W=$t[$l];if($W.isDirectory)for(var $i=0,$A=$d.length;$i<$A;$i++){var $B=$d[$i];if($B.isDirectory&&this.isSameParent($B,$W)&&$W.label==$B.label){$W.isOpen=$B.isOpen;break;}}}},$l.isSameParent=function($d,$t){return null==$d.nodeParent&&null==$t.nodeParent||null!=$d.nodeParent&&null!=$t.nodeParent&&$d.nodeParent.label==$t.nodeParent.label&&this.isSameParent($d.nodeParent,$t.nodeParent);},$l.filter=function($d){if(Boolean($d)){var $t=[];this.getFilterSource(this._source,$t,$d),this._list.array=$t;}else this._list.array=this.getArray();},$l.getFilterSource=function($d,$t,$l){var $k;for(var $W in $l=$l.toLocaleLowerCase(),$d)!($k=$d[$W]).isDirectory&&-1<String($k.label).toLowerCase().indexOf($l)&&($k.x=0,$t.push($k)),$k.child&&0<$k.child.length&&this.getFilterSource($k.child,$t,$l);},$A(0,$l,"spaceBottom",function(){return this._list.spaceY;},function($d){this._list.spaceY=$d;}),$A(0,$l,"keepStatus",function(){return this._keepStatus;},function($d){this._keepStatus=$d;}),$A(0,$l,"itemRender",function(){return this._list.itemRender;},function($d){this._list.itemRender=$d;}),$A(0,$l,"array",function(){return this._list.array;},function($d){this._keepStatus&&this._list.array&&$d&&this.parseOpenStatus(this._list.array,$d),this._source=$d,this._list.array=this.getArray();}),$A(0,$l,"mouseHandler",function(){return this._list.mouseHandler;},function($d){this._list.mouseHandler=$d;}),$A(0,$l,"dataSource",$d.prototype._$get_dataSource,function($d){this._dataSource=$d,$w.superSet($K,this,"dataSource",$d);}),$A(0,$l,"source",function(){return this._source;}),$A(0,$l,"scrollBar",function(){return this._list.scrollBar;}),$A(0,$l,"list",function(){return this._list;}),$A(0,$l,"scrollBarSkin",function(){return this._list.vScrollBarSkin;},function($d){this._list.vScrollBarSkin=$d;}),$A(0,$l,"renderHandler",function(){return this._renderHandler;},function($d){this._renderHandler=$d;}),$A(0,$l,"selectedIndex",function(){return this._list.selectedIndex;},function($d){this._list.selectedIndex=$d;}),$A(0,$l,"spaceLeft",function(){return this._spaceLeft;},function($d){this._spaceLeft=$d;}),$A(0,$l,"selectedItem",function(){return this._list.selectedItem;},function($d){this._list.selectedItem=$d;}),$A(0,$l,"width",$d.prototype._$get_width,function($d){$w.superSet($K,this,"width",$d),this._list.width=$d;}),$A(0,$l,"height",$d.prototype._$get_height,function($d){$w.superSet($K,this,"height",$d),this._list.height=$d;}),$A(0,$l,"xml",null,function($d){var $t=[];this.parseXml($d.childNodes[0],$t,null,!0),this.array=$t;}),$A(0,$l,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null;}),$t;}($K),$dd=function($d){function $t(){this._items=null,this._selectedIndex=0,$t.__super.call(this),this._setIndexHandler=$J.create(this,this.setIndex,null,!1);}$i($t,"laya.ui.ViewStack",$d);var $l=$t.prototype;return $w.imps($l,{"laya.ui.IItem":!0}),$l.setItems=function($d){this.removeChildren();for(var $t=0,$l=0,$k=$d.length;$l<$k;$l++){var $W=$d[$l];$W&&($W.name="item"+$t,this.addChild($W),$t++);}this.initItems();},$l.addItem=function($d){$d.name="item"+this._items.length,this.addChild($d),this.initItems();},$l.initItems=function(){this._items=[];for(var $d=0;$d<1e4;$d++){var $t=this.getChildByName("item"+$d);if(null==$t)break;this._items.push($t),$t.visible=$d==this._selectedIndex;}},$l.setSelect=function($d,$t){this._items&&-1<$d&&$d<this._items.length&&(this._items[$d].visible=$t);},$l.setIndex=function($d){this.selectedIndex=$d;},$A(0,$l,"dataSource",$d.prototype._$get_dataSource,function($d){if("number"==typeof(this._dataSource=$d)&&Math.floor($d)==$d||"string"==typeof $d)this.selectedIndex=parseInt($d);else for(var $t in this._dataSource)this.hasOwnProperty($t)&&(this[$t]=this._dataSource[$t]);}),$A(0,$l,"selectedIndex",function(){return this._selectedIndex;},function($d){this._selectedIndex!=$d&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$d,this.setSelect(this._selectedIndex,!0));}),$A(0,$l,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($d){this.selectedIndex=this._items.indexOf($d);}),$A(0,$l,"items",function(){return this._items;}),$A(0,$l,"setIndexHandler",function(){return this._setIndexHandler;},function($d){this._setIndexHandler=$d;}),$t;}($K),$td=function($d){function $t(){$t.__super.call(this);}return $i($t,"laya.ui.VScrollBar",$V),$t;}(),$ld=function($t){function $l($d){this._bg=null,this._skin=null,$l.__super.call(this),void 0===$d&&($d=""),this.text=$d,this.skin=this.skin;}$i($l,"laya.ui.TextInput",$t);var $d=$l.prototype;return $d.preinitialize=function(){this.mouseEnabled=!0;},$d.destroy=function($d){$e.clearCache(this,this._skin),void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._bg&&this._bg.destroy(),this._bg=null;},$d.createChildren=function(){this.addChild(this._tf=new $c()),this._tf.padding=$M.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus);},$d._onFocus=function(){this.event("focus",this);},$d._onBlur=function(){this.event("blur",this);},$d._onInput=function(){this.event("input",this);},$d._onEnter=function(){this.event("enter",this);},$d.initialize=function(){this.width=128,this.height=22;},$d.select=function(){this._tf.select();},$d.setSelection=function($d,$t){this._tf.setSelection($d,$t);},$A(0,$d,"text",$t.prototype._$get_text,function($d){this._tf.text!=$d&&($d+="",this._tf.text=$d,this.event("change"));}),$A(0,$d,"bg",function(){return this._bg;},function($d){this.graphics=this._bg=$d;}),$A(0,$d,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster;},function($d){this._tf.inputElementYAdjuster=$d;}),$A(0,$d,"multiline",function(){return this._tf.multiline;},function($d){this._tf.multiline=$d;}),$A(0,$d,"skin",function(){return this._skin;},function($d){this._skin!=$d&&($e.clearCache(this,this._skin),this._skin=$d,this._bg||(this.graphics=this._bg=new $S()),$e.keepCache(this,this._skin),this._bg.source=$e.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height));}),$A(0,$d,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null;},function($d){this._bg||(this.graphics=this._bg=new $S()),this._bg.sizeGrid=$T.fillArray($M.defaultSizeGrid,$d,Number);}),$A(0,$d,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster;},function($d){this._tf.inputElementXAdjuster=$d;}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($E,this,"width",$d),this._bg&&(this._bg.width=$d);}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($E,this,"height",$d),this._bg&&(this._bg.height=$d);}),$A(0,$d,"editable",function(){return this._tf.editable;},function($d){this._tf.editable=$d;}),$A(0,$d,"restrict",function(){return this._tf.restrict;},function($d){this._tf.restrict=$d;}),$A(0,$d,"prompt",function(){return this._tf.prompt;},function($d){this._tf.prompt=$d;}),$A(0,$d,"promptColor",function(){return this._tf.promptColor;},function($d){this._tf.promptColor=$d;}),$A(0,$d,"maxChars",function(){return this._tf.maxChars;},function($d){this._tf.maxChars=$d;}),$A(0,$d,"focus",function(){return this._tf.focus;},function($d){this._tf.focus=$d;}),$A(0,$d,"type",function(){return this._tf.type;},function($d){this._tf.type=$d;}),$A(0,$d,"asPassword",function(){return this._tf.asPassword;},function($d){this._tf.asPassword=$d;}),$l;}($E),$kd=function($d){function $t(){$t.__super.call(this);}return $i($t,"laya.ui.VSlider",$Z),$t;}(),$Wd=function($d){function $k(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$k.__super.call(this);}$i($k,"laya.ui.Dialog",$d);var $t=$k.prototype;return $t.initialize=function(){this.popupEffect=$k.manager.popupEffectHandler,this.closeEffect=$k.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick);},$t._dealDragArea=function(){var $d=this.getChildByName("drag");$d&&(this.dragArea=$d.x+","+$d.y+","+$d.width+","+$d.height,$d.removeSelf());},$t._onClick=function($d){var $t=$d.target;if($t)switch($t.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($t.name);}},$t.show=function($d,$t){void 0===$d&&($d=!1),void 0===$t&&($t=!0),this._open(!1,$d,$t);},$t.popup=function($d,$t){void 0===$d&&($d=!1),void 0===$t&&($t=!0),this._open(!0,$d,$t);},$t._open=function($d,$t,$l){$k.manager.lock(!1),this.isModal=$d,$k.manager.open(this,$t,$l);},$t.onOpened=function(){},$t.close=function($d,$t){void 0===$t&&($t=!0),$k.manager.close(this,$d,$t);},$t.onClosed=function($d){},$t._onMouseDown=function($d){var $t=this.getMousePoint();this._dragArea.contains($t.x,$t.y)?this.startDrag():this.stopDrag();},$A(0,$t,"dragArea",function(){return this._dragArea?this._dragArea.toString():null;},function($d){if($d){var $t=$T.fillArray([0,0,0,0],$d,Number);this._dragArea=new $z($t[0],$t[1],$t[2],$t[3]),this.on("mousedown",this,this._onMouseDown);}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown);}),$A(0,$t,"isPopup",function(){return null!=this.parent;}),$A(0,$t,"zOrder",$d.prototype._$get_zOrder,function($d){$w.superSet($u,this,"zOrder",$d),$k.manager._checkMask();}),$A(1,$k,"manager",function(){return $k._manager=$k._manager||new $C();},function($d){$k._manager=$d;}),$k.setLockView=function($d){$k.manager.setLockView($d);},$k.lock=function($d){$k.manager.lock($d);},$k.closeAll=function(){$k.manager.closeAll();},$k.getDialogsByGroup=function($d){return $k.manager.getDialogsByGroup($d);},$k.closeByGroup=function($d){return $k.manager.closeByGroup($d);},$k.CLOSE="close",$k.CANCEL="cancel",$k.SURE="sure",$k.NO="no",$k.OK="ok",$k.YES="yes",$k._manager=null,$k;}($u),$id=function($d){function $t(){$t.__super.call(this);}$i($t,"laya.ui.HBox",$d);var $l=$t.prototype;return $l.sortItem=function($d){$d&&$d.sort(function($d,$t){return $d.x-$t.x;});},$l.changeItems=function(){this._itemChanged=!1;for(var $d=[],$t=0,$l=0,$k=this.numChildren;$l<$k;$l++){var $W=this.getChildAt($l);$W&&$W.layoutEnabled&&($d.push($W),$t=this._height?this._height:Math.max($t,$W.height*$W.scaleY));}this.sortItem($d);var $i=0;for($l=0,$k=$d.length;$l<$k;$l++)($W=$d[$l]).x=$i,$i+=$W.width*$W.scaleX+this._space,"top"==this._align?$W.y=0:"middle"==this._align?$W.y=.5*($t-$W.height*$W.scaleY):"bottom"==this._align&&($W.y=$t-$W.height*$W.scaleY);this.changeSize();},$A(0,$l,"height",$d.prototype._$get_height,function($d){this._height!=$d&&($w.superSet($s,this,"height",$d),this.callLater(this.changeItems));}),$t.NONE="none",$t.TOP="top",$t.MIDDLE="middle",$t.BOTTOM="bottom",$t;}($s),$Ad=function($d){function $t(){$t.__super.call(this);}$i($t,"laya.ui.VBox",$d);var $l=$t.prototype;return $l.changeItems=function(){this._itemChanged=!1;for(var $d=[],$t=0,$l=0,$k=this.numChildren;$l<$k;$l++){var $W=this.getChildAt($l);$W&&$W.layoutEnabled&&($d.push($W),$t=this._width?this._width:Math.max($t,$W.width*$W.scaleX));}this.sortItem($d);var $i=0;for($l=0,$k=$d.length;$l<$k;$l++)($W=$d[$l]).y=$i,$i+=$W.height*$W.scaleY+this._space,"left"==this._align?$W.x=0:"center"==this._align?$W.x=.5*($t-$W.width*$W.scaleX):"right"==this._align&&($W.x=$t-$W.width*$W.scaleX);this.changeSize();},$A(0,$l,"width",$d.prototype._$get_width,function($d){this._width!=$d&&($w.superSet($s,this,"width",$d),this.callLater(this.changeItems));}),$t.NONE="none",$t.LEFT="left",$t.CENTER="center",$t.RIGHT="right",$t;}($s),$Bd=function($d){function $t(){$t.__super.call(this);}return $i($t,"laya.ui.RadioGroup",$a),$t.prototype.createItem=function($d,$t){return new $_($d,$t);},$t;}(),$od=function($d){function $t(){$t.__super.call(this);}return $i($t,"laya.ui.Tab",$a),$t.prototype.createItem=function($d,$t){return new $x($d,$t);},$t;}(),$Id=function($t){function $l($d){this._vScrollBar=null,this._hScrollBar=null,void 0===$d&&($d=""),$l.__super.call(this,$d);}$i($l,"laya.ui.TextArea",$t);var $d=$l.prototype;return $d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null;},$d.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0;},$d.onVBarChanged=function($d){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value);},$d.onHBarChanged=function($d){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value);},$d.changeScroll=function(){var $d=this._vScrollBar&&0<this._tf.maxScrollY,$t=this._hScrollBar&&0<this._tf.maxScrollX,$l=$d?this._width-this._vScrollBar.width:this._width,$k=$t?this._height-this._hScrollBar.height:this._height,$W=this._tf.padding||$M.labelPadding;this._tf.width=$l,this._tf.height=$k,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$W[2],this._vScrollBar.y=$W[1],this._vScrollBar.height=this._height-($t?this._hScrollBar.height:0)-$W[1]-$W[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$k/Math.max(this._tf.textHeight,$k),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$d),this._hScrollBar&&(this._hScrollBar.x=$W[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$W[3],this._hScrollBar.width=this._width-($d?this._vScrollBar.width:0)-$W[0]-$W[2],this._hScrollBar.scrollSize=Math.max(.033*$l,1),this._hScrollBar.thumbPercent=$l/Math.max(this._tf.textWidth,$l),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$t);},$d.scrollTo=function($d){this.commitMeasure(),this._tf.scrollY=$d;},$A(0,$d,"scrollY",function(){return this._tf.scrollY;}),$A(0,$d,"width",$t.prototype._$get_width,function($d){$w.superSet($ld,this,"width",$d),this.callLater(this.changeScroll);}),$A(0,$d,"hScrollBar",function(){return this._hScrollBar;}),$A(0,$d,"height",$t.prototype._$get_height,function($d){$w.superSet($ld,this,"height",$d),this.callLater(this.changeScroll);}),$A(0,$d,"maxScrollX",function(){return this._tf.maxScrollX;}),$A(0,$d,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($d){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $td()),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$d;}),$A(0,$d,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($d){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $m()),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$d;}),$A(0,$d,"vScrollBar",function(){return this._vScrollBar;}),$A(0,$d,"maxScrollY",function(){return this._tf.maxScrollY;}),$A(0,$d,"scrollX",function(){return this._tf.scrollX;}),$l;}($ld);!function($d){function $t(){this._uiView=null,this.isCloseOther=!1,$t.__super.call(this);}$i($t,"laya.ui.AsynDialog",$Wd);var $l=$t.prototype;$l.createView=function($d){this._uiView=$d;},$l._open=function($d,$t,$l){this.isModal=$d,this.isCloseOther=$t,$Wd.manager.lock(!0),this._uiView?this.onCreated():this.onOpen();},$l.onCreated=function(){this.createUI(),this.onOpen();},$l.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea();},$l.onOpen=function(){$Wd.manager.open(this,this.isCloseOther),$Wd.manager.lock(!1);},$l.close=function($d,$t){void 0===$t&&($t=!0),$Wd.manager.close(this),this.onClose();},$l.onClose=function(){},$l.destroy=function($d){void 0===$d&&($d=!0),laya.ui.View.prototype.destroy.call(this,$d),this._uiView=null,this.onDestroy();},$l.onDestroy=function(){};}();$w.__init([$u]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}}),function($J,$d,$R){$R.un,$R.uns;var $f=$R.static,$c=$R.class,$Y=$R.getset,$k=$R.__newvec,$H=laya.maths.Arith,$A=laya.webgl.atlas.AtlasResourceManager,$l=laya.webgl.shader.BaseShader,$j=laya.utils.Browser,$B=laya.webgl.utils.Buffer,$G=laya.utils.Byte,$W=laya.utils.ClassUtils,$o=$R.Config,$i=(laya.events.Event,laya.events.EventDispatcher),$M=laya.utils.Handler,$z=laya.net.Loader,$t=laya.net.LoaderManager,$I=(laya.maths.MathUtil,laya.display.Node),$w=laya.renders.Render,$b=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$D=laya.resource.Resource,$e=laya.utils.RunDriver,$g=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$q=laya.display.Sprite,$L=laya.utils.Stat,$$=laya.utils.StringKey,$T=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$p=laya.utils.Utils,$r=laya.webgl.WebGL,$S=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$R.interface("laya.d3.core.IClone"),$R.interface("laya.d3.graphics.IVertex"),$R.interface("laya.d3.core.render.IUpdate"),$R.interface("laya.d3.core.scene.ITreeNode"),$R.interface("laya.d3.core.render.IRenderable");(function(){function $x(){}$c($x,"laya.d3.animation.AnimationClipParser01"),$x.READ_DATA=function(){$x._DATA.offset=$x._reader.getUint32(),$x._DATA.size=$x._reader.getUint32();},$x.READ_BLOCK=function(){for(var $d=$x._BLOCK.count=$x._reader.getUint16(),$t=$x._BLOCK.blockStarts=[],$l=$x._BLOCK.blockLengths=[],$k=0;$k<$d;$k++)$t.push($x._reader.getUint32()),$l.push($x._reader.getUint32());},$x.READ_STRINGS=function(){var $d=$x._reader.getUint32(),$t=$x._reader.getUint16(),$l=$x._reader.pos;$x._reader.pos=$d+$x._DATA.offset;for(var $k=0;$k<$t;$k++)$x._strings[$k]=$x._reader.readUTFString();$x._reader.pos=$l;},$x.parse=function($d,$t){$x._animationClip=$d;($x._reader=$t).__getBuffer();$x.READ_DATA(),$x.READ_BLOCK(),$x.READ_STRINGS();for(var $l=0,$k=$x._BLOCK.count;$l<$k;$l++){var $W=$t.getUint16(),$i=$x._strings[$W],$A=$x["READ_"+$i];if(null==$A)throw new Error("model file err,no this function:"+$W+" "+$i);$A.call();}},$x.READ_ANIMATIONS=function(){var $d,$t=0,$l=0,$k=$x._reader,$W=$k.__getBuffer(),$i=[],$A=$k.getUint8();for($i.length=$A,$t=0;$t<$A;$t++)$i[$t]=$k.getUint16();var $B=[],$o=$k.getUint16();for($B.length=$o,$t=0;$t<$o;$t++)$B[$t]=$k.getFloat32();var $I=$x._animationClip;$I.name=$x._strings[$k.getUint16()];var $b=$I._duration=$k.getFloat32();$I.islooping=!!$k.getByte(),$I._frameRate=$k.getInt16();var $f=$k.getInt16(),$J=$I._nodes=new Array();$J.length=$f,($I._publicClipDatas=[]).length=$f;var $c=$I._nodesMap={},$Y=0,$w=0;for($t=0;$t<$f;$t++){$d=$J[$t]=new $N();var $D=$k.getUint16(),$z=$d.path=[];for($z.length=$D,$l=0;$l<$D;$l++)$z[$l]=$x._strings[$k.getUint16()];var $e=$z.join("/"),$g=$c[$e];$g||($c[$e]=$g=[]),$g.push($d);var $H=$k.getInt16();-1!==$H&&($d.componentType=$x._strings[$H]);var $R=$U._propertyIndexDic[$x._strings[$k.getUint16()]];if(null==$R)throw new Error("AnimationClipParser01:unknown property name.");var $G=$R<4,$q=!$G||$G&&""===$z[0];($d._cacheProperty=$q)?$Y++:$w++,$d.propertyNameID=$R;var $L=$i[$k.getUint8()];$d.keyFrameWidth=$L/4;var $$=$d.keyFrames=[],$p=$$.length=$k.getUint16(),$M=null,$T=NaN;for($l=0;$l<$p;$l++){var $r=$$[$l]=new $E();$T=$r.startTime=$B[$k.getUint16()];var $S=$k.pos;$r.inTangent=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$S=$k.pos,$r.outTangent=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$S=$k.pos,$r.data=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$M&&($M.next=$r,$M.duration=$T-$M.startTime),$M=$r;}$r.next=null,$r.duration=$b-$T;}var $j=$I._nodeToCachePropertyMap=new Int32Array($f),$C=$I._cachePropertyMap=new Int32Array($Y),$K=$I._unCachePropertyMap=new Int32Array($w);for($Y=$w=0,$t=0;$t<$f;$t++)($d=$J[$t])._cacheProperty?($j[$t]=$Y,$C[$Y++]=$t):$K[$w++]=$t;},$x._animationClip=null,$x._reader=null,$x._strings=[],$f($x,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);})(),function(){function $V(){}$c($V,"laya.d3.animation.AnimationClipParser02"),$V.READ_DATA=function(){$V._DATA.offset=$V._reader.getUint32(),$V._DATA.size=$V._reader.getUint32();},$V.READ_BLOCK=function(){for(var $d=$V._BLOCK.count=$V._reader.getUint16(),$t=$V._BLOCK.blockStarts=[],$l=$V._BLOCK.blockLengths=[],$k=0;$k<$d;$k++)$t.push($V._reader.getUint32()),$l.push($V._reader.getUint32());},$V.READ_STRINGS=function(){var $d=$V._reader.getUint32(),$t=$V._reader.getUint16(),$l=$V._reader.pos;$V._reader.pos=$d+$V._DATA.offset;for(var $k=0;$k<$t;$k++)$V._strings[$k]=$V._reader.readUTFString();$V._reader.pos=$l;},$V.parse=function($d,$t){$V._animationClip=$d;($V._reader=$t).__getBuffer();$V.READ_DATA(),$V.READ_BLOCK(),$V.READ_STRINGS();for(var $l=0,$k=$V._BLOCK.count;$l<$k;$l++){var $W=$t.getUint16(),$i=$V._strings[$W],$A=$V["READ_"+$i];if(null==$A)throw new Error("model file err,no this function:"+$W+" "+$i);$A.call();}},$V.READ_ANIMATIONS=function(){var $d,$t=0,$l=0,$k=$V._reader,$W=$k.__getBuffer(),$i=[],$A=$k.getUint8();for($i.length=$A,$t=0;$t<$A;$t++)$i[$t]=$k.getUint16();var $B=[],$o=$k.getUint16();for($B.length=$o,$t=0;$t<$o;$t++)$B[$t]=$k.getFloat32();var $I=$V._animationClip;$I.name=$V._strings[$k.getUint16()];var $b=$I._duration=$k.getFloat32();$I.islooping=!!$k.getByte(),$I._frameRate=$k.getInt16();var $f=$k.getInt16(),$J=$I._nodes=new Array();$J.length=$f,($I._publicClipDatas=[]).length=$f;var $c=$I._nodesMap={},$Y=0,$w=0;for($t=0;$t<$f;$t++){$d=$J[$t]=new $N();var $D=$k.getUint16(),$z=$d.path=[];for($z.length=$D,$l=0;$l<$D;$l++)$z[$l]=$V._strings[$k.getUint16()];var $e=$z.join("/"),$g=$c[$e];$g||($c[$e]=$g=[]),$g.push($d);var $H=$k.getInt16();-1!==$H&&($d.componentType=$V._strings[$H]);var $R=$U._propertyIndexDic[$V._strings[$k.getUint16()]];if(null==$R)throw new Error("AnimationClipParser02:unknown property name.");var $G=$R<4,$q=!$G||$G&&""===$z[0];($d._cacheProperty=$q)?$Y++:$w++,$d.propertyNameID=$R;var $L=$i[$k.getUint8()];$d.keyFrameWidth=$L/4;var $$=$d.keyFrames=[],$p=$$.length=$k.getUint16(),$M=null,$T=NaN;for($l=0;$l<$p;$l++){var $r=$$[$l]=new $E();$T=$r.startTime=$B[$k.getUint16()];var $S=$k.pos;$r.inTangent=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$S=$k.pos,$r.outTangent=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$S=$k.pos,$r.data=new Float32Array($W.slice($S,$S+$L)),$k.pos+=$L,$M&&($M.next=$r,$M.duration=$T-$M.startTime),$M=$r;}$r.next=null,$r.duration=$b-$T;}var $j=$k.getUint16();for($t=0;$t<$j;$t++){var $C,$K=new $Z();$K.time=$k.getFloat32(),$K.eventName=$V._strings[$k.getUint16()];var $x=$k.getUint16();for(0<$x&&($K.params=$C=[]),$l=0;$l<$x;$l++){switch($k.getByte()){case 0:$C.push(!!$k.getByte());break;case 1:$C.push($k.getInt32());break;case 2:$C.push($k.getFloat32());break;case 3:$C.push($V._strings[$k.getUint16()]);break;default:throw new Error("unknown type.");}}$I.addEvent($K);}var $n=$I._nodeToCachePropertyMap=new Int32Array($f),$Q=$I._cachePropertyMap=new Int32Array($Y),$y=$I._unCachePropertyMap=new Int32Array($w);for($Y=$w=0,$t=0;$t<$f;$t++)($d=$J[$t])._cacheProperty?($n[$t]=$Y,$Q[$Y++]=$t):$y[$w++]=$t;},$V._animationClip=null,$V._reader=null,$V._strings=[],$f($V,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);}();var $Z=function(){function $d(){this.time=NaN,this.eventName=null,this.params=null;}return $c($d,"laya.d3.animation.AnimationEvent"),$d;}(),$U=function(){function $k(){this._childs=[],this.transform=new $et(this);}$c($k,"laya.d3.animation.AnimationNode");var $d=$k.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.addChild=function($d){$d._parent=this,$d.transform.setParent(this.transform),this._childs.push($d);},$d.removeChild=function($d){var $t=this._childs.indexOf($d);-1!==$t&&this._childs.splice($t,1);},$d.getChildByName=function($d){for(var $t=0,$l=this._childs.length;$t<$l;$t++){var $k=this._childs[$t];if($k.name===$d)return $k;}return null;},$d.getChildByIndex=function($d){return this._childs[$d];},$d.getChildCount=function(){return this._childs.length;},$d.cloneTo=function($d){var $t=$d;$t.name=this.name;for(var $l=0,$k=this._childs.length;$l<$k;$l++){var $W=this._childs[$l],$i=$W.clone();$t.addChild($i);var $A=$W.transform,$B=$i.transform;$B.setLocalPosition($A.getLocalPosition()),$B.setLocalRotation($A.getLocalRotation()),$B.setLocalScale($A.getLocalScale()),$B._localRotationEuler=$A._localRotationEuler,$B._setWorldMatrixIgnoreUpdate($A.getWorldMatrix());}},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$k.__init__=function(){$k.registerAnimationNodeProperty("localPosition",$k._getLocalPosition,$k._setLocalPosition),$k.registerAnimationNodeProperty("localRotation",$k._getLocalRotation,$k._setLocalRotation),$k.registerAnimationNodeProperty("localScale",$k._getLocalScale,$k._setLocalScale),$k.registerAnimationNodeProperty("localRotationEuler",$k._getLocalRotationEuler,$k._setLocalRotationEuler),$k.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$k._getParticleRenderSharedMaterialTintColor,$k._setParticleRenderSharedMaterialTintColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$k._getMeshRenderSharedMaterialTilingOffset,$k._setMeshRenderSharedMaterialTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$k._getMeshRenderSharedMaterialAlbedo,$k._setMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$k._getSkinnedMeshRenderSharedMaterialTilingOffset,$k._setSkinnedMeshRenderSharedMaterialTilingOffset),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$k._getSkinnedMeshRenderSharedMaterialAlbedo,$k._setSkinnedMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$k._getMeshRenderSharedMaterialAlbedo,$k._setMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$k._getSkinnedMeshRenderSharedMaterialAlbedo,$k._setSkinnedMeshRenderSharedMaterialAlbedo),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$k._getMeshRenderSharedMaterialIntensity,$k._setMeshRenderSharedMaterialIntensity),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$k._getMeshRenderSharedMaterialAlpha,$k._setMeshRenderSharedMaterialAlpha),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$k._getMeshRenderSharedMaterialAlphaColor,$k._setMeshRenderSharedMaterialAlphaColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$k._getMeshRenderSharedMaterialBaseColor,$k._setMeshRenderSharedMaterialBaseColor),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$k._getMeshRenderSharedMaterialDissolve,$k._setMeshRenderSharedMaterialDissolve),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$k._getMeshRenderSharedMaterialDissolveSpeed,$k._setMeshRenderSharedMaterialDissolveSpeed),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$k._getMeshRenderSharedMaterialMMultiplier,$k._setMeshRenderSharedMaterialMMultiplier),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$k._getMeshRenderSharedMaterialBaseScrollSpeedX,$k._setMeshRenderSharedMaterialBaseScrollSpeedX),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$k._getMeshRenderSharedMaterialBaseScrollSpeedY,$k._setMeshRenderSharedMaterialBaseScrollSpeedY),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$k._getMeshRenderSharedMaterialSecondScrollSpeedX,$k._setMeshRenderSharedMaterialSecondScrollSpeedX),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$k._getMeshRenderSharedMaterialSecondScrollSpeedY,$k._setMeshRenderSharedMaterialSecondScrollSpeedY),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$k._getMeshRenderSharedMaterialDetailTilingOffset,$k._setMeshRenderSharedMaterialDetailTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$k._getMeshRenderSharedMaterialDissolveTilingOffset,$k._setMeshRenderSharedMaterialDissolveTilingOffset),$k.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$k._getMeshRenderSharedMaterialMaskTilingOffset,$k._setMeshRenderSharedMaterialMaskTilingOffset);},$k.registerAnimationNodeProperty=function($d,$t,$l){if($k._propertyIndexDic[$d])throw new Error("AnimationNode: this propertyName has registered.");$k._propertyIndexDic[$d]=$k._propertyIDCounter,$k._propertyGetFuncs[$k._propertyIDCounter]=$t,$k._propertySetFuncs[$k._propertyIDCounter]=$l,$k._propertyIDCounter++;},$k._getLocalPosition=function($d,$t){return $d?$d.transform.getLocalPosition():$t._transform.localPosition.elements;},$k._setLocalPosition=function($d,$t,$l){if($d)$d.transform.setLocalPosition($l);else{var $k=$t._transform,$W=$k.localPosition;$W.elements=$l,$k.localPosition=$W;}},$k._getLocalRotation=function($d,$t){return $d?$d.transform.getLocalRotation():$t._transform.localRotation.elements;},$k._setLocalRotation=function($d,$t,$l){if($d)$d.transform.setLocalRotation($l);else{var $k=$t._transform,$W=$k.localRotation;$W.elements=$l,$k.localRotation=$W;}},$k._getLocalScale=function($d,$t){return $d?$d.transform.getLocalScale():$t._transform.localScale.elements;},$k._setLocalScale=function($d,$t,$l){if($d)$d.transform.setLocalScale($l);else{var $k=$t._transform,$W=$k.localScale;$W.elements=$l,$k.localScale=$W;}},$k._getLocalRotationEuler=function($d,$t){return $d?$d.transform.getLocalRotationEuler():$t._transform.localRotationEuler.elements;},$k._setLocalRotationEuler=function($d,$t,$l){if($d)$d.transform.setLocalRotationEuler($l);else{var $k=$t._transform,$W=$k.localRotationEuler;$W.elements=$l,$k.localRotationEuler=$W;}},$k._getMeshRenderSharedMaterialTilingOffset=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.tilingOffset.elements:null;}return $t.meshRender.sharedMaterial.tilingOffset.elements;},$k._setMeshRenderSharedMaterialTilingOffset=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).tilingOffset).elements=$l,$k.tilingOffset=$W);}else($W=($k=$t.meshRender.material).tilingOffset).elements=$l,$k.tilingOffset=$W;},$k._getMeshRenderSharedMaterialAlbedo=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.albedoColor.elements:null;}return $t.meshRender.sharedMaterial.albedoColor.elements;},$k._setMeshRenderSharedMaterialAlbedo=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).albedoColor).elements=$l,$k.albedoColor=$W);}else($W=($k=$t.meshRender.material).albedoColor).elements=$l,$k.albedoColor=$W;},$k._getSkinnedMeshRenderSharedMaterialTilingOffset=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null;}return $t.skinnedMeshRender.sharedMaterial.tilingOffset.elements;},$k._setSkinnedMeshRenderSharedMaterialTilingOffset=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.skinnedMeshRender.material).tilingOffset).elements=$l,$k.tilingOffset=$W);}else($W=($k=$t.skinnedMeshRender.material).tilingOffset).elements=$l,$k.tilingOffset=$W;},$k._getSkinnedMeshRenderSharedMaterialAlbedo=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null;}return $t.skinnedMeshRender.sharedMaterial.albedoColor.elements;},$k._setSkinnedMeshRenderSharedMaterialAlbedo=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.skinnedMeshRender.material).albedoColor).elements=$l,$k.albedoColor=$W);}else($W=($k=$t.skinnedMeshRender.material).albedoColor).elements=$l,$k.albedoColor=$W;},$k._getParticleRenderSharedMaterialTintColor=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.particleRender.sharedMaterial.tintColor.elements:null;}return $t.particleRender.sharedMaterial.tintColor.elements;},$k._setParticleRenderSharedMaterialTintColor=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.particleRender.material).tintColor).elements=$l,$k.tintColor=$W);}else($W=($k=$t.particleRender.material).tintColor).elements=$l,$k.tintColor=$W;},$k._getMeshRenderSharedMaterialAlphaColor=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.alphaColor.elements:null;}return $t.meshRender.sharedMaterial.alphaColor.elements;},$k._setMeshRenderSharedMaterialAlphaColor=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).alphaColor).elements=$l,$k.alphaColor=$W);}else($W=($k=$t.meshRender.material).alphaColor).elements=$l,$k.alphaColor=$W;},$k._getMeshRenderSharedMaterialBaseColor=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.baseColor.elements:null;}return $t.meshRender.sharedMaterial.baseColor.elements;},$k._setMeshRenderSharedMaterialBaseColor=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).baseColor).elements=$l,$k.baseColor=$W);}else($W=($k=$t.meshRender.material).baseColor).elements=$l,$k.baseColor=$W;},$k._getMeshRenderSharedMaterialDissolve=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.dissolve:0;}return $t.meshRender.sharedMaterial.dissolve;},$k._setMeshRenderSharedMaterialDissolve=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.dissolve=$l[0]);}else $t.meshRender.material.dissolve=$l[0];},$k._getMeshRenderSharedMaterialDissolveSpeed=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.dissolveSpeed:0;}return $t.meshRender.sharedMaterial.dissolveSpeed;},$k._setMeshRenderSharedMaterialDissolveSpeed=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.dissolveSpeed=$l[0]);}else $t.meshRender.material.dissolveSpeed=$l[0];},$k._getMeshRenderSharedMaterialMMultiplier=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.mMultiplier:0;}return $t.meshRender.sharedMaterial.mMultiplier;},$k._setMeshRenderSharedMaterialMMultiplier=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.mMultiplier=$l[0]);}else $t.meshRender.material.mMultiplier=$l[0];},$k._getMeshRenderSharedMaterialBaseScrollSpeedX=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.baseScrollSpeedX:0;}return $t.meshRender.sharedMaterial.baseScrollSpeedX;},$k._setMeshRenderSharedMaterialBaseScrollSpeedX=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.baseScrollSpeedX=$l[0]);}else $t.meshRender.material.baseScrollSpeedX=$l[0];},$k._getMeshRenderSharedMaterialBaseScrollSpeedY=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.baseScrollSpeedY:0;}return $t.meshRender.sharedMaterial.baseScrollSpeedY;},$k._setMeshRenderSharedMaterialBaseScrollSpeedY=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.baseScrollSpeedY=$l[0]);}else $t.meshRender.material.baseScrollSpeedY=$l[0];},$k._getMeshRenderSharedMaterialSecondScrollSpeedX=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.secondScrollSpeedX:0;}return $t.meshRender.sharedMaterial.secondScrollSpeedX;},$k._setMeshRenderSharedMaterialSecondScrollSpeedX=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.secondScrollSpeedX=$l[0]);}else $t.meshRender.material.secondScrollSpeedX=$l[0];},$k._getMeshRenderSharedMaterialSecondScrollSpeedY=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.secondScrollSpeedY:0;}return $t.meshRender.sharedMaterial.secondScrollSpeedY;},$k._setMeshRenderSharedMaterialSecondScrollSpeedY=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.secondScrollSpeedY=$l[0]);}else $t.meshRender.material.secondScrollSpeedY=$l[0];},$k._getMeshRenderSharedMaterialAlpha=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.alpha:0;}return $t.meshRender.sharedMaterial.alpha;},$k._setMeshRenderSharedMaterialAlpha=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.alpha=$l[0]);}else $t.meshRender.material.alpha=$l[0];},$k._getMeshRenderSharedMaterialIntensity=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.intensity:0;}return $t.meshRender.sharedMaterial.intensity;},$k._setMeshRenderSharedMaterialIntensity=function($d,$t,$l){if($d){var $k=$d.transform._entity;$k&&($k.owner.meshRender.material.intensity=$l[0]);}else $t.meshRender.material.intensity=$l[0];},$k._getMeshRenderSharedMaterialDetailTilingOffset=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null;}return $t.meshRender.sharedMaterial.detailTilingOffset.elements;},$k._setMeshRenderSharedMaterialDetailTilingOffset=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).detailTilingOffset).elements=$l,$k.detailTilingOffset=$W);}else($W=($k=$t.meshRender.material).detailTilingOffset).elements=$l,$k.detailTilingOffset=$W;},$k._getMeshRenderSharedMaterialDissolveTilingOffset=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null;}return $t.meshRender.sharedMaterial.dissolveTilingOffset.elements;},$k._setMeshRenderSharedMaterialDissolveTilingOffset=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).dissolveTilingOffset).elements=$l,$k.dissolveTilingOffset=$W);}else($W=($k=$t.meshRender.material).dissolveTilingOffset).elements=$l,$k.dissolveTilingOffset=$W;},$k._getMeshRenderSharedMaterialMaskTilingOffset=function($d,$t){if($d){var $l=$d.transform._entity;return $l?$l.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null;}return $t.meshRender.sharedMaterial.maskTilingOffset.elements;},$k._setMeshRenderSharedMaterialMaskTilingOffset=function($d,$t,$l){var $k,$W;if($d){var $i=$d.transform._entity;$i&&(($W=($k=$i.owner.meshRender.material).maskTilingOffset).elements=$l,$k.maskTilingOffset=$W);}else($W=($k=$t.meshRender.material).maskTilingOffset).elements=$l,$k.maskTilingOffset=$W;},$k._propertyIDCounter=0,$k._propertyIndexDic={},$k._propertySetFuncs=[],$k._propertyGetFuncs=[],$k;}(),$E=function(){function $d(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null;}return $c($d,"laya.d3.animation.Keyframe"),$d;}(),$N=function(){function $d(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null;}return $c($d,"laya.d3.animation.KeyframeNode"),$d;}(),$C=(function(){function $d(){this._tempVector30=new $At(),this._tempVector31=new $At(),this._tempVector32=new $At(),this._a=new $At(),this._b=new $At(),this._c=new $At(),this._d=new $At();}$c($d,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $t=$d.prototype;$t.Init=function($d,$t,$l,$k){$d.cloneTo(this._d),$t.cloneTo(this._c),$At.scale($d,2,this._a),$At.scale($l,2,this._tempVector30),$At.subtract(this._a,this._tempVector30,this._a),$At.add(this._a,$t,this._a),$At.add(this._a,$k,this._a),$At.scale($l,3,this._b),$At.scale($d,3,this._tempVector30),$At.subtract(this._b,this._tempVector30,this._b),$At.subtract(this._b,$k,this._b),$At.scale($t,2,this._tempVector30),$At.subtract(this._b,this._tempVector30,this._b);},$t.Slerp=function($d,$t){$At.scale(this._a,$d*$d*$d,this._tempVector30),$At.scale(this._b,$d*$d,this._tempVector31),$At.scale(this._c,$d,this._tempVector32),$At.add(this._tempVector30,this._tempVector31,$t),$At.add($t,this._tempVector32,$t),$At.add($t,this._d,$t);};}(),function(){function $Q($d,$t,$l,$k){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$d,this._h=$t,this._minHeight=$l,this._maxHeight=$k;}$c($Q,"laya.d3.core.HeightMap");var $d=$Q.prototype;$d._inBounds=function($d,$t){return 0<=$d&&$d<this._h&&0<=$t&&$t<this._w;},$d.getHeight=function($d,$t){return this._inBounds($d,$t)?this._datas[$d][$t]:NaN;},$Y(0,$d,"width",function(){return this._w;}),$Y(0,$d,"height",function(){return this._h;}),$Y(0,$d,"maxHeight",function(){return this._maxHeight;}),$Y(0,$d,"minHeight",function(){return this._minHeight;}),$Q.creatFromMesh=function($d,$t,$l,$k){for(var $W=[],$i=[],$A=$d.getSubMeshCount(),$B=0;$B<$A;$B++){for(var $o=$d.getSubMesh($B),$I=$o._getVertexBuffer(),$b=$I.getData(),$f=[],$J=0;$J<$b.length;$J+=$I.vertexDeclaration.vertexStride/4){var $c=new $At($b[$J+0],$b[$J+1],$b[$J+2]);$f.push($c);}$W.push($f);var $Y=$o._getIndexBuffer();$i.push($Y.getData());}var $w=$d.boundingBox,$D=$w.min.x,$z=$w.min.z,$e=$w.max.x,$g=$w.max.z,$H=$w.min.y,$R=$w.max.y,$G=$e-$D,$q=$g-$z,$L=$k.elements[0]=$G/($t-1),$$=$k.elements[1]=$q/($l-1),$p=new $Q($t,$l,$H,$R),$M=$Q._tempRay,$T=$M.direction.elements;$T[0]=0,$T[1]=-1,$T[2]=0;var $r=$R+.1;$M.origin.elements[1]=$r;for(var $S=0;$S<$l;$S++){var $j=$z+$S*$$;$p._datas[$S]=[];for(var $C=0;$C<$t;$C++){var $K=$D+$C*$L,$x=$M.origin.elements;$x[0]=$K,$x[2]=$j;var $n=$Q._getPosition($M,$W,$i);$p._datas[$S][$C]=$n===Number.MAX_VALUE?NaN:$r-$n;}}return $p;},$Q.createFromImage=function($d,$t,$l){for(var $k=$d.width,$W=$d.height,$i=new $Q($k,$W,$t,$l),$A=($l-$t)/254,$B=$d.getPixels(),$o=0,$I=0;$I<$W;$I++)for(var $b=$i._datas[$I]=[],$f=0;$f<$k;$f++){var $J=$B[$o++],$c=$B[$o++],$Y=$B[$o++],$w=$B[$o++];$b[$f]=255==$J&&255==$c&&255==$Y&&255==$w?NaN:($J+$c+$Y)/3*$A+$t;}return $i;},$Q._getPosition=function($d,$t,$l){for(var $k=Number.MAX_VALUE,$W=0;$W<$t.length;$W++)for(var $i=$t[$W],$A=$l[$W],$B=0;$B<$A.length;$B+=3){var $o=$i[$A[$B+0]],$I=$i[$A[$B+1]],$b=$i[$A[$B+2]],$f=$Yt.rayIntersectsTriangle($d,$o,$I,$b);!isNaN($f)&&$f<$k&&($k=$f);}return $k;},$f($Q,["_tempRay",function(){return this._tempRay=new $Wt(new $At(),new $At());}]);}(),function(){function $W(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[];}$c($W,"laya.d3.core.Layer");var $d=$W.prototype;return $d._binarySearchIndex=function(){for(var $d=0,$t=$W._collsionTestList.length-1,$l=0;$d<=$t;){$l=Math.floor(($d+$t)/2);var $k=$W._collsionTestList[$l];if($k==this._number)return $l;$k>this._number?$t=$l-1:$d=$l+1;}return $d;},$d._addCollider=function($d){0===this._colliders.length&&$W._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$d._isRigidbody?(this._colliders.unshift($d),this._nonRigidbodyOffset++):this._colliders.push($d);},$d._removeCollider=function($d){var $t=this._colliders.indexOf($d);$t<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($t,1),0===this._colliders.length&&$W._collsionTestList.splice($W._collsionTestList.indexOf(this._number),1);},$Y(0,$d,"number",function(){return this._number;}),$Y(0,$d,"visible",function(){return this._visible;},function($d){this._visible=$d,$W._visibleLayers=$d?$W._visibleLayers|this.mask:$W._visibleLayers&~this.mask;}),$Y(0,$d,"mask",function(){return this._mask;}),$Y(1,$W,"visibleLayers",function(){return $W._visibleLayers;},function($d){$W._visibleLayers=$d;for(var $t=0,$l=$W._layerList.length;$t<$l;$t++){var $k=$W._layerList[$t];$k._visible=0!=($k._mask&$W._visibleLayers);}}),$W.__init__=function(){$W._layerList.length=31;for(var $d=0;$d<31;$d++){var $t=new $W();$W._layerList[$d]=$t,0===$d?($t.name="Default Layer",$t.visible=!0):($t.name="Layer-"+$d,$t.visible=!1),$t._number=$d,$t._mask=Math.pow(2,$d);}$W.currentCreationLayer=$W._layerList[0];},$W.getLayerByNumber=function($d){if($d<0||30<$d)throw new Error("无法返回指定Layer，该number超出范围！");return $W._layerList[$d];},$W.getLayerByName=function($d){for(var $t=0;$t<31;$t++)if($W._layerList[$t].name===$d)return $W._layerList[$t];throw new Error("无法返回指定Layer,该name不存在");},$W.isVisible=function($d){return 0!=($d&$W._currentCameraCullingMask&$W._visibleLayers);},$W._layerList=[],$W._visibleLayers=2147483647,$W._collsionTestList=[],$W._currentCameraCullingMask=2147483647,$W.maxCount=31,$W.currentCreationLayer=null,$W;}()),$K=(function(){function $d($d,$t,$l){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$d,this._minCount=$t,this._maxCount=$l;}$c($d,"laya.d3.core.particleShuriKen.module.Burst");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.cloneTo=function($d){var $t=$d;$t._time=this._time,$t._minCount=this._minCount,$t._maxCount=this._maxCount;},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"time",function(){return this._time;}),$Y(0,$t,"minCount",function(){return this._minCount;}),$Y(0,$t,"maxCount",function(){return this._maxCount;});}(),function(){function $d($d){this._color=null,this.enbale=!1,this._color=$d;}$c($d,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $t=$d.prototype;$t.cloneTo=function($d){var $t=$d;this._color.cloneTo($t._color),$t.enbale=this.enbale;},$t.clone=function(){var $d;switch(this._color.type){case 0:$d=$n.createByConstant(this._color.constant.clone());break;case 1:$d=$n.createByGradient(this._color.gradient.clone());break;case 2:$d=$n.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$d=$n.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone());}var $t=new this.constructor($d);return $t.enbale=this.enbale,$t;},$Y(0,$t,"color",function(){return this._color;});}(),function(){function $d(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[];}$c($d,"laya.d3.core.particleShuriKen.module.Emission");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$t._destroy=function(){this._bursts=null,this._destroyed=!0;},$t.getBurstsCount=function(){return this._bursts.length;},$t.getBurstByIndex=function($d){return this._bursts[$d];},$t.addBurst=function($d){var $t=this._bursts.length;if(0<$t)for(var $l=0;$l<$t;$l++)this._bursts[$l].time>$d.time&&this._bursts.splice($l,0,$d);this._bursts.push($d);},$t.removeBurst=function($d){var $t=this._bursts.indexOf($d);-1!==$t&&this._bursts.splice($t,1);},$t.removeBurstByIndex=function($d){this._bursts.splice($d,1);},$t.clearBurst=function(){this._bursts.length=0;},$t.cloneTo=function($d){var $t=$d,$l=$t._bursts;$l.length=this._bursts.length;for(var $k=0,$W=this._bursts.length;$k<$W;$k++){var $i=$l[$k];$i?this._bursts[$k].cloneTo($i):$l[$k]=this._bursts[$k].clone();}$t._emissionRate=this._emissionRate,$t.enbale=this.enbale;},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"destroyed",function(){return this._destroyed;}),$Y(0,$t,"emissionRate",function(){return this._emissionRate;},function($d){if($d<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$d;});}(),function(){function $k(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null;}$c($k,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $d=$k.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($d){var $t=$d;$t._type=this._type,$t._constant=this._constant,this._overTime.cloneTo($t._overTime),$t._constantMin=this._constantMin,$t._constantMax=this._constantMax,this._overTimeMin.cloneTo($t._overTimeMin),this._overTimeMax.cloneTo($t._overTimeMax);},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"frameOverTimeData",function(){return this._overTime;}),$Y(0,$d,"constant",function(){return this._constant;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"frameOverTimeDataMin",function(){return this._overTimeMin;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"frameOverTimeDataMax",function(){return this._overTimeMax;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$k.createByConstant=function($d){var $t=new $k();return $t._type=0,$t._constant=$d,$t;},$k.createByOverTime=function($d){var $t=new $k();return $t._type=1,$t._overTime=$d,$t;},$k.createByRandomTwoConstant=function($d,$t){var $l=new $k();return $l._type=2,$l._constantMin=$d,$l._constantMax=$t,$l;},$k.createByRandomTwoOverTime=function($d,$t){var $l=new $k();return $l._type=3,$l._overTimeMin=$d,$l._overTimeMax=$t,$l;},$k;}()),$x=function(){function $I(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null;}$c($I,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $d=$I.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($d){var $t=$d;$t._type=this._type,$t._separateAxes=this._separateAxes,$t._constant=this._constant,this._constantSeparate.cloneTo($t._constantSeparate),this._gradient.cloneTo($t._gradient),this._gradientX.cloneTo($t._gradientX),this._gradientY.cloneTo($t._gradientY),this._gradientZ.cloneTo($t._gradientZ),$t._constantMin=this._constantMin,$t._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($t._constantMinSeparate),this._constantMaxSeparate.cloneTo($t._constantMaxSeparate),this._gradientMin.cloneTo($t._gradientMin),this._gradientMax.cloneTo($t._gradientMax),this._gradientXMin.cloneTo($t._gradientXMin),this._gradientXMax.cloneTo($t._gradientXMax),this._gradientYMin.cloneTo($t._gradientYMin),this._gradientYMax.cloneTo($t._gradientYMax),this._gradientZMin.cloneTo($t._gradientZMin),this._gradientZMax.cloneTo($t._gradientZMax);},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"gradientZ",function(){return this._gradientZ;}),$Y(0,$d,"constant",function(){return this._constant;}),$Y(0,$d,"gradient",function(){return this._gradient;}),$Y(0,$d,"separateAxes",function(){return this._separateAxes;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"constantSeparate",function(){return this._constantSeparate;}),$Y(0,$d,"gradientX",function(){return this._gradientX;}),$Y(0,$d,"gradientY",function(){return this._gradientY;}),$Y(0,$d,"gradientW",function(){return this._gradientW;}),$Y(0,$d,"gradientMin",function(){return this._gradientMin;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"gradientMax",function(){return this._gradientMax;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$Y(0,$d,"gradientWMin",function(){return this._gradientWMin;}),$Y(0,$d,"constantMinSeparate",function(){return this._constantMinSeparate;}),$Y(0,$d,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$Y(0,$d,"gradientXMin",function(){return this._gradientXMin;}),$Y(0,$d,"gradientXMax",function(){return this._gradientXMax;}),$Y(0,$d,"gradientWMax",function(){return this._gradientWMax;}),$Y(0,$d,"gradientYMin",function(){return this._gradientYMin;}),$Y(0,$d,"gradientYMax",function(){return this._gradientYMax;}),$Y(0,$d,"gradientZMin",function(){return this._gradientZMin;}),$Y(0,$d,"gradientZMax",function(){return this._gradientZMax;}),$I.createByConstant=function($d){var $t=new $I();return $t._type=0,$t._separateAxes=!1,$t._constant=$d,$t;},$I.createByConstantSeparate=function($d){var $t=new $I();return $t._type=0,$t._separateAxes=!0,$t._constantSeparate=$d,$t;},$I.createByGradient=function($d){var $t=new $I();return $t._type=1,$t._separateAxes=!1,$t._gradient=$d,$t;},$I.createByGradientSeparate=function($d,$t,$l,$k){var $W=new $I();return $W._type=1,$W._separateAxes=!0,$W._gradientX=$d,$W._gradientY=$t,$W._gradientZ=$l,$W._gradientW=$k,$W;},$I.createByRandomTwoConstant=function($d,$t){var $l=new $I();return $l._type=2,$l._separateAxes=!1,$l._constantMin=$d,$l._constantMax=$t,$l;},$I.createByRandomTwoConstantSeparate=function($d,$t){var $l=new $I();return $l._type=2,$l._separateAxes=!0,$l._constantMinSeparate=$d,$l._constantMaxSeparate=$t,$l;},$I.createByRandomTwoGradient=function($d,$t){var $l=new $I();return $l._type=3,$l._separateAxes=!1,$l._gradientMin=$d,$l._gradientMax=$t,$l;},$I.createByRandomTwoGradientSeparate=function($d,$t,$l,$k,$W,$i,$A,$B){var $o=new $I();return $o._type=3,$o._separateAxes=!0,$o._gradientXMin=$d,$o._gradientXMax=$t,$o._gradientYMin=$l,$o._gradientYMax=$k,$o._gradientZMin=$W,$o._gradientZMax=$i,$o._gradientWMin=$A,$o._gradientWMax=$B,$o;},$I;}(),$n=function(){function $k(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null;}$c($k,"laya.d3.core.particleShuriKen.module.GradientColor");var $d=$k.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($d){var $t=$d;$t._type=this._type,this._constant.cloneTo($t._constant),this._constantMin.cloneTo($t._constantMin),this._constantMax.cloneTo($t._constantMax),this._gradient.cloneTo($t._gradient),this._gradientMin.cloneTo($t._gradientMin),this._gradientMax.cloneTo($t._gradientMax);},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"gradient",function(){return this._gradient;}),$Y(0,$d,"constant",function(){return this._constant;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"gradientMin",function(){return this._gradientMin;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"gradientMax",function(){return this._gradientMax;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$k.createByConstant=function($d){var $t=new $k();return $t._type=0,$t._constant=$d,$t;},$k.createByGradient=function($d){var $t=new $k();return $t._type=1,$t._gradient=$d,$t;},$k.createByRandomTwoConstant=function($d,$t){var $l=new $k();return $l._type=2,$l._constantMin=$d,$l._constantMax=$t,$l;},$k.createByRandomTwoGradient=function($d,$t){var $l=new $k();return $l._type=3,$l._gradientMin=$d,$l._gradientMax=$t,$l;},$k;}(),$Q=(function(){function $d(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16);}$c($d,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.addAlpha=function($d,$t){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$d&&($d=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$d,this._alphaElements[this._alphaCurrentLength++]=$t):DEBUG;},$t.addRGB=function($d,$t){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$d&&($d=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$d,this._rgbElements[this._rgbCurrentLength++]=$t.x,this._rgbElements[this._rgbCurrentLength++]=$t.y,this._rgbElements[this._rgbCurrentLength++]=$t.z):DEBUG;},$t.cloneTo=function($d){var $t=$d,$l=0,$k=0;$t._alphaCurrentLength=this._alphaCurrentLength;var $W=$t._alphaElements;for($W.length=this._alphaElements.length,$l=0,$k=this._alphaElements.length;$l<$k;$l++)$W[$l]=this._alphaElements[$l];$t._rgbCurrentLength=this._rgbCurrentLength;var $i=$t._rgbElements;for($i.length=this._rgbElements.length,$l=0,$k=this._rgbElements.length;$l<$k;$l++)$i[$l]=this._rgbElements[$l];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"alphaGradientCount",function(){return this._alphaCurrentLength/2;}),$Y(0,$t,"rgbGradientCount",function(){return this._rgbCurrentLength/4;});}(),function(){function $d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$c($d,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.add=function($d,$t){this._currentLength<8?(6===this._currentLength&&1!==$d&&($d=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$d,this._elements[this._currentLength++]=$t):console.log("Warning:data count must lessEqual than 4");},$t.cloneTo=function($d){var $t=$d;$t._currentLength=this._currentLength;var $l=$t._elements;$l.length=this._elements.length;for(var $k=0,$W=this._elements.length;$k<$W;$k++)$l[$k]=this._elements[$k];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$c($d,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.add=function($d,$t){this._currentLength<8?(6===this._currentLength&&1!==$d&&($d=1,DEBUG),this._elements[this._currentLength++]=$d,this._elements[this._currentLength++]=$t):DEBUG;},$t.getKeyByIndex=function($d){return this._elements[2*$d];},$t.getValueByIndex=function($d){return this._elements[2*$d+1];},$t.getAverageValue=function(){for(var $d=0,$t=this._currentLength-2;$d<$t;$d+=2){this._elements[$d+1];this._elements[$d+3],this._elements[$d+2]-this._elements[$d];}return 0;},$t.cloneTo=function($d){var $t=$d;$t._currentLength=this._currentLength;var $l=$t._elements;$l.length=this._elements.length;for(var $k=0,$W=this._elements.length;$k<$W;$k++)$l[$k]=this._elements[$k];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12);}$c($d,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.add=function($d,$t){this._currentLength<8?(6===this._currentLength&&1!==$d&&($d=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$d,this._elements[this._currentLength++]=$t.x,this._elements[this._currentLength++]=$t.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4");},$t.cloneTo=function($d){var $t=$d;$t._currentLength=this._currentLength;var $l=$t._elements;$l.length=this._elements.length;for(var $k=0,$W=this._elements.length;$k<$W;$k++)$l[$k]=this._elements[$k];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"gradientCount",function(){return this._currentLength/3;});}(),function(){function $B(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$c($B,"laya.d3.core.particleShuriKen.module.GradientSize");var $d=$B.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.getMaxSizeInGradient=function(){var $d=0,$t=0,$l=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($d=0,$t=this._gradientX.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientX.getValueByIndex($d));for($d=0,$t=this._gradientY.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientY.getValueByIndex($d));}else for($d=0,$t=this._gradient.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradient.getValueByIndex($d));break;case 1:$l=this._separateAxes?($l=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$l=Math.max($l,this._constantMinSeparate.y),Math.max($l,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($d=0,$t=this._gradientXMin.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientXMin.getValueByIndex($d));for($d=0,$t=this._gradientXMax.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientXMax.getValueByIndex($d));for($d=0,$t=this._gradientYMin.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientYMin.getValueByIndex($d));for($d=0,$t=this._gradientZMax.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientZMax.getValueByIndex($d));}else{for($d=0,$t=this._gradientMin.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientMin.getValueByIndex($d));for($d=0,$t=this._gradientMax.gradientCount;$d<$t;$d++)$l=Math.max($l,this._gradientMax.getValueByIndex($d));}}return $l;},$d.cloneTo=function($d){var $t=$d;$t._type=this._type,$t._separateAxes=this._separateAxes,this._gradient.cloneTo($t._gradient),this._gradientX.cloneTo($t._gradientX),this._gradientY.cloneTo($t._gradientY),this._gradientZ.cloneTo($t._gradientZ),$t._constantMin=this._constantMin,$t._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($t._constantMinSeparate),this._constantMaxSeparate.cloneTo($t._constantMaxSeparate),this._gradientMin.cloneTo($t._gradientMin),this._gradientMax.cloneTo($t._gradientMax),this._gradientXMin.cloneTo($t._gradientXMin),this._gradientXMax.cloneTo($t._gradientXMax),this._gradientYMin.cloneTo($t._gradientYMin),this._gradientYMax.cloneTo($t._gradientYMax),this._gradientZMin.cloneTo($t._gradientZMin),this._gradientZMax.cloneTo($t._gradientZMax);},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"gradientZ",function(){return this._gradientZ;}),$Y(0,$d,"gradient",function(){return this._gradient;}),$Y(0,$d,"separateAxes",function(){return this._separateAxes;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"gradientMin",function(){return this._gradientMin;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"gradientX",function(){return this._gradientX;}),$Y(0,$d,"gradientY",function(){return this._gradientY;}),$Y(0,$d,"gradientMax",function(){return this._gradientMax;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$Y(0,$d,"constantMinSeparate",function(){return this._constantMinSeparate;}),$Y(0,$d,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$Y(0,$d,"gradientXMin",function(){return this._gradientXMin;}),$Y(0,$d,"gradientXMax",function(){return this._gradientXMax;}),$Y(0,$d,"gradientYMin",function(){return this._gradientYMin;}),$Y(0,$d,"gradientYMax",function(){return this._gradientYMax;}),$Y(0,$d,"gradientZMin",function(){return this._gradientZMin;}),$Y(0,$d,"gradientZMax",function(){return this._gradientZMax;}),$B.createByGradient=function($d){var $t=new $B();return $t._type=0,$t._separateAxes=!1,$t._gradient=$d,$t;},$B.createByGradientSeparate=function($d,$t,$l){var $k=new $B();return $k._type=0,$k._separateAxes=!0,$k._gradientX=$d,$k._gradientY=$t,$k._gradientZ=$l,$k;},$B.createByRandomTwoConstant=function($d,$t){var $l=new $B();return $l._type=1,$l._separateAxes=!1,$l._constantMin=$d,$l._constantMax=$t,$l;},$B.createByRandomTwoConstantSeparate=function($d,$t){var $l=new $B();return $l._type=1,$l._separateAxes=!0,$l._constantMinSeparate=$d,$l._constantMaxSeparate=$t,$l;},$B.createByRandomTwoGradient=function($d,$t){var $l=new $B();return $l._type=2,$l._separateAxes=!1,$l._gradientMin=$d,$l._gradientMax=$t,$l;},$B.createByRandomTwoGradientSeparate=function($d,$t,$l,$k,$W,$i){var $A=new $B();return $A._type=2,$A._separateAxes=!0,$A._gradientXMin=$d,$A._gradientXMax=$t,$A._gradientYMin=$l,$A._gradientYMax=$k,$A._gradientZMin=$W,$A._gradientZMax=$i,$A;},$B;}()),$y=function(){function $B(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$c($B,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $d=$B.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($d){var $t=$d;$t._type=this._type,this._constant.cloneTo($t._constant),this._gradientX.cloneTo($t._gradientX),this._gradientY.cloneTo($t._gradientY),this._gradientZ.cloneTo($t._gradientZ),this._constantMin.cloneTo($t._constantMin),this._constantMax.cloneTo($t._constantMax),this._gradientXMin.cloneTo($t._gradientXMin),this._gradientXMax.cloneTo($t._gradientXMax),this._gradientYMin.cloneTo($t._gradientYMin),this._gradientYMax.cloneTo($t._gradientYMax),this._gradientZMin.cloneTo($t._gradientZMin),this._gradientZMax.cloneTo($t._gradientZMax);},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"gradientZ",function(){return this._gradientZ;}),$Y(0,$d,"constant",function(){return this._constant;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"gradientXMax",function(){return this._gradientXMax;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"gradientX",function(){return this._gradientX;}),$Y(0,$d,"gradientY",function(){return this._gradientY;}),$Y(0,$d,"gradientXMin",function(){return this._gradientXMin;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$Y(0,$d,"gradientYMin",function(){return this._gradientYMin;}),$Y(0,$d,"gradientYMax",function(){return this._gradientYMax;}),$Y(0,$d,"gradientZMin",function(){return this._gradientZMin;}),$Y(0,$d,"gradientZMax",function(){return this._gradientZMax;}),$B.createByConstant=function($d){var $t=new $B();return $t._type=0,$t._constant=$d,$t;},$B.createByGradient=function($d,$t,$l){var $k=new $B();return $k._type=1,$k._gradientX=$d,$k._gradientY=$t,$k._gradientZ=$l,$k;},$B.createByRandomTwoConstant=function($d,$t){var $l=new $B();return $l._type=2,$l._constantMin=$d,$l._constantMax=$t,$l;},$B.createByRandomTwoGradient=function($d,$t,$l,$k,$W,$i){var $A=new $B();return $A._type=3,$A._gradientXMin=$d,$A._gradientXMax=$t,$A._gradientYMin=$l,$A._gradientYMax=$k,$A._gradientZMin=$W,$A._gradientZMax=$i,$A;},$B;}(),$V=(function(){function $d($d){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$d;}$c($d,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.cloneTo=function($d){var $t=$d;this._angularVelocity.cloneTo($t._angularVelocity),$t.enbale=this.enbale;},$t.clone=function(){var $d;switch(this._angularVelocity.type){case 0:$d=this._angularVelocity.separateAxes?$x.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$x.createByConstant(this._angularVelocity.constant);break;case 1:$d=this._angularVelocity.separateAxes?$x.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$x.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$d=this._angularVelocity.separateAxes?$x.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$x.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$d=this._angularVelocity.separateAxes?$x.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$x.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone());}var $t=new this.constructor($d);return $t.enbale=this.enbale,$t;},$Y(0,$t,"angularVelocity",function(){return this._angularVelocity;});}(),function(){function $d(){this.enable=!1,this.randomDirection=!1;}$c($d,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.IClone":!0}),$t._getShapeBoundBox=function($d){throw new Error("BaseShape: must override it.");},$t._getSpeedBoundBox=function($d){throw new Error("BaseShape: must override it.");},$t.generatePositionAndDirection=function($d,$t,$l,$k){throw new Error("BaseShape: must override it.");},$t._calculateProceduralBounds=function($d,$t,$l){this._getShapeBoundBox($d);var $k=$d.min,$W=$d.max;$At.multiply($k,$t,$k),$At.multiply($W,$t,$W);var $i=new $Od(new $At(),new $At());this.randomDirection?($i.min=new $At(-1,-1,-1),$i.max=new $At(1,1,1)):this._getSpeedBoundBox($i);var $A=new $Od(new $At(),new $At()),$B=$A.min,$o=$A.max;$At.scale($i.min,$l.y,$B),$At.scale($i.max,$l.y,$o),$At.add($d.min,$B,$B),$At.add($d.max,$o,$o),$At.min($d.min,$B,$d.min),$At.max($d.max,$B,$d.max);var $I=new $Od(new $At(),new $At()),$b=$I.min,$f=$I.max;$At.scale($i.min,$l.x,$b),$At.scale($i.max,$l.x,$f),$At.min($I.min,$f,$B),$At.max($I.min,$f,$o),$At.min($d.min,$B,$d.min),$At.max($d.max,$B,$d.max);},$t.cloneTo=function($d){$d.enable=this.enable;},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$d;}()),$u=function(){function $i(){}return $c($i,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$i._randomPointUnitArcCircle=function($d,$t,$l){var $k=$t.elements,$W=NaN;$W=$l?$l.getFloat()*$d:Math.random()*$d,$k[0]=Math.cos($W),$k[1]=Math.sin($W);},$i._randomPointInsideUnitArcCircle=function($d,$t,$l){var $k=$t.elements;$i._randomPointUnitArcCircle($d,$t,$l);var $W=NaN;$W=$l?Math.pow($l.getFloat(),.5):Math.pow(Math.random(),.5),$k[0]=$k[0]*$W,$k[1]=$k[1]*$W;},$i._randomPointUnitCircle=function($d,$t){var $l=$d.elements,$k=NaN;$k=$t?$t.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$l[0]=Math.cos($k),$l[1]=Math.sin($k);},$i._randomPointInsideUnitCircle=function($d,$t){var $l=$d.elements;$i._randomPointUnitCircle($d);var $k=NaN;$k=$t?Math.pow($t.getFloat(),.5):Math.pow(Math.random(),.5),$l[0]=$l[0]*$k,$l[1]=$l[1]*$k;},$i._randomPointUnitSphere=function($d,$t){var $l=$d.elements,$k=NaN,$W=NaN;$W=$t?($k=$l[2]=2*$t.getFloat()-1,$t.getFloat()*Math.PI*2):($k=$l[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $i=Math.sqrt(1-$k*$k);$l[0]=$i*Math.cos($W),$l[1]=$i*Math.sin($W);},$i._randomPointInsideUnitSphere=function($d,$t){var $l=$d.elements;$i._randomPointUnitSphere($d);var $k=NaN;$k=$t?Math.pow($t.getFloat(),1/3):Math.pow(Math.random(),1/3),$l[0]=$l[0]*$k,$l[1]=$l[1]*$k,$l[2]=$l[2]*$k;},$i._randomPointInsideHalfUnitBox=function($d,$t){var $l=$d.elements;$t?($l[0]=$t.getFloat()-.5,$l[1]=$t.getFloat()-.5,$l[2]=$t.getFloat()-.5):($l[0]=Math.random()-.5,$l[1]=Math.random()-.5,$l[2]=Math.random()-.5);},$i;}(),$h=(function(){function $d($d){this._size=null,this.enbale=!1,this._size=$d;}$c($d,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.cloneTo=function($d){var $t=$d;this._size.cloneTo($t._size),$t.enbale=this.enbale;},$t.clone=function(){var $d;switch(this._size.type){case 0:$d=this._size.separateAxes?$Q.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$Q.createByGradient(this._size.gradient.clone());break;case 1:$d=this._size.separateAxes?$Q.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$Q.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$d=this._size.separateAxes?$Q.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$Q.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone());}var $t=new this.constructor($d);return $t.enbale=this.enbale,$t;},$Y(0,$t,"size",function(){return this._size;});}(),function(){function $k(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN;}$c($k,"laya.d3.core.particleShuriKen.module.StartFrame");var $d=$k.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($d){var $t=$d;$t._type=this._type,$t._constant=this._constant,$t._constantMin=this._constantMin,$t._constantMax=this._constantMax;},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$d,"constant",function(){return this._constant;}),$Y(0,$d,"type",function(){return this._type;}),$Y(0,$d,"constantMin",function(){return this._constantMin;}),$Y(0,$d,"constantMax",function(){return this._constantMax;}),$k.createByConstant=function($d){var $t=new $k();return $t._type=0,$t._constant=$d,$t;},$k.createByRandomTwoConstant=function($d,$t){var $l=new $k();return $l._type=1,$l._constantMin=$d,$l._constantMax=$t,$l;},$k;}()),$s=(function(){function $d($d,$t){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $it(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$d,this._startFrame=$t;}$c($d,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.cloneTo=function($d){var $t=$d;this.tiles.cloneTo($t.tiles),$t.type=this.type,$t.randomRow=this.randomRow,this._frame.cloneTo($t._frame),this._startFrame.cloneTo($t._startFrame),$t.cycles=this.cycles,$t.enableUVChannels=this.enableUVChannels,$t.enable=this.enable;},$t.clone=function(){var $d,$t;switch(this._frame.type){case 0:$d=$K.createByConstant(this._frame.constant);break;case 1:$d=$K.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$d=$K.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$d=$K.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone());}switch(this._startFrame.type){case 0:$t=$h.createByConstant(this._startFrame.constant);break;case 1:$t=$h.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax);}var $l=new this.constructor($d,$t);return this.tiles.cloneTo($l.tiles),$l.type=this.type,$l.randomRow=this.randomRow,$l.cycles=this.cycles,$l.enableUVChannels=this.enableUVChannels,$l.enable=this.enable,$l;},$Y(0,$t,"frame",function(){return this._frame;}),$Y(0,$t,"startFrame",function(){return this._startFrame;});}(),function(){function $d($d){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$d;}$c($d,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $t=$d.prototype;$R.imps($t,{"laya.d3.core.IClone":!0}),$t.cloneTo=function($d){var $t=$d;this._velocity.cloneTo($t._velocity),$t.enbale=this.enbale,$t.space=this.space;},$t.clone=function(){var $d;switch(this._velocity.type){case 0:$d=$y.createByConstant(this._velocity.constant.clone());break;case 1:$d=$y.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$d=$y.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$d=$y.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone());}var $t=new this.constructor($d);return $t.enbale=this.enbale,$t.space=this.space,$t;},$Y(0,$t,"velocity",function(){return this._velocity;});}(),function(){function $d(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $Jt(),this._vb=$Vt.create($d._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$yt.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$nt.nameKey.getID("LINE"),this._shaderCompile=$Lt._preCompileShader[this._sharderNameID];}$c($d,"laya.d3.core.PhasorSpriter3D");var $t=$d.prototype;return $t.line=function($d,$t,$l,$k){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($d.x,$d.y,$d.z,$t.x,$t.y,$t.z,$t.w),this.addVertex($l.x,$l.y,$l.z,$k.x,$k.y,$k.z,$k.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this;},$t.circle=function($d,$t,$l,$k,$W,$i){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$t,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$t,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$d,Math.cos(this._tempNumver0)*$d,0,$l,$k,$W,$i),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this;},$t.plane=function($d,$t,$l,$k,$W,$i,$A,$B,$o){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$k/2,this._tempNumver1=$W/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($d-this._tempNumver0,$t+this._tempNumver1,$l,$i,$A,$B,$o),this.addVertex($d+this._tempNumver0,$t+this._tempNumver1,$l,$i,$A,$B,$o),this.addVertex($d-this._tempNumver0,$t-this._tempNumver1,$l,$i,$A,$B,$o),this.addVertex($d+this._tempNumver0,$t-this._tempNumver1,$l,$i,$A,$B,$o),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this;},$t.box=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$k/2,this._tempNumver1=$W/2,this._tempNumver2=$i/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($d-this._tempNumver0,$t+this._tempNumver1,$l+this._tempNumver2,$A,$B,$o,$I),this.addVertex($d+this._tempNumver0,$t+this._tempNumver1,$l+this._tempNumver2,$A,$B,$o,$I),this.addVertex($d-this._tempNumver0,$t-this._tempNumver1,$l+this._tempNumver2,$A,$B,$o,$I),this.addVertex($d+this._tempNumver0,$t-this._tempNumver1,$l+this._tempNumver2,$A,$B,$o,$I),this.addVertex($d+this._tempNumver0,$t+this._tempNumver1,$l-this._tempNumver2,$A,$B,$o,$I),this.addVertex($d-this._tempNumver0,$t+this._tempNumver1,$l-this._tempNumver2,$A,$B,$o,$I),this.addVertex($d+this._tempNumver0,$t-this._tempNumver1,$l-this._tempNumver2,$A,$B,$o,$I),this.addVertex($d-this._tempNumver0,$t-this._tempNumver1,$l-this._tempNumver2,$A,$B,$o,$I),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this;},$t.cone=function($d,$t,$l,$k,$W,$i,$A){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$l+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$l>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$l,this.addVertexIndex(0,$t,0,$k,$W,$i,$A,this._tempUint0),this.addVertexIndex(0,0,0,$k,$W,$i,$A,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$l;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($d*this._tempNumver2,0,$d*this._tempNumver3,$k,$W,$i,$A,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$l-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($d*this._tempNumver2,0,$d*this._tempNumver3,$k,$W,$i,$A,this._tempUint0+(this._tempInt0+$l)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$l-1?this.addIndexes(this._tempUint1+$l+2):this.addIndexes(this._tempUint1+this._tempInt0+$l+1),this.addIndexes(this._tempUint1+this._tempInt0+$l),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this;},$t.boundingBoxLine=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($d,$W,$i,$A,$B,$o,$I),this.addVertex($k,$W,$i,$A,$B,$o,$I),this.addVertex($d,$t,$i,$A,$B,$o,$I),this.addVertex($k,$t,$i,$A,$B,$o,$I),this.addVertex($k,$W,$l,$A,$B,$o,$I),this.addVertex($d,$W,$l,$A,$B,$o,$I),this.addVertex($k,$t,$l,$A,$B,$o,$I),this.addVertex($d,$t,$l,$A,$B,$o,$I),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this;},$t.addVertex=function($d,$t,$l,$k,$W,$i,$A){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$d,this._vbData[this._posInVBData+1]=$t,this._vbData[this._posInVBData+2]=$l,this._vbData[this._posInVBData+3]=$k,this._vbData[this._posInVBData+4]=$W,this._vbData[this._posInVBData+5]=$i,this._vbData[this._posInVBData+6]=$A,this._posInVBData+=this._floatSizePerVer,this;},$t.addVertexIndex=function($d,$t,$l,$k,$W,$i,$A,$B){return this._hasBegun||this.addVertexIndexException(),this._vbData[$B]=$d,this._vbData[$B+1]=$t,this._vbData[$B+2]=$l,this._vbData[$B+3]=$k,this._vbData[$B+4]=$W,this._vbData[$B+5]=$i,this._vbData[$B+6]=$A,($B+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$B),this;},$t.addIndexes=function($d){var $t=arguments;this._hasBegun||this.addVertexIndexException();for(var $l=0;$l<$t.length;$l++)this._ibData[this._posInIBData]=$t[$l],this._posInIBData++;return this;},$t.begin=function($d,$t){return this._hasBegun&&this.beginException0(),1!==$d&&4!==$d&&this.beginException1(),this._primitiveType=$d,this._camera=$t,this._hasBegun=!0,this;},$t.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this;},$t.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($d._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$L.drawCall++,$r.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0);},$t.addVertexIndexException=function(){throw new Error("请先调用begin()函数");},$t.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！");},$t.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！");},$t.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！");},$t.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！");},$t.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！");},$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(28,[new $Ad(0,"vector3",0),new $Ad(12,"vector4",1)]);}]),$d;}()),$P=function(){function $d(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$d._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $Jt();}$c($d,"laya.d3.core.render.RenderElement");var $t=$d.prototype;return $t.getDynamicBatchBakedVertexs=function($d){for(var $t=this._renderObj._getVertexBuffer($d),$l=$t.getData().slice(),$k=$t.vertexDeclaration,$W=$k.getVertexElementByUsage(0).offset/4,$i=$k.getVertexElementByUsage(3).offset/4,$A=this._sprite3D.transform,$B=$A.worldMatrix,$o=$A.rotation,$I=$k.vertexStride/4,$b=0,$f=$l.length;$b<$f;$b+=$I){var $J=$b+$W,$c=$b+$i;$Dt.transformVector3ArrayToVector3ArrayCoordinate($l,$J,$B,$l,$J),$Dt.transformVector3ArrayByQuat($l,$c,$o,$l,$c);}return $l;},$t.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData();},$t._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this);},$Y(0,$t,"id",function(){return this._id;}),$Y(0,$t,"renderObj",function(){return this._renderObj;},function($d){this._renderObj!==$d&&(this._renderObj=$d);}),$d._uniqueIDCounter=0,$d;}(),$X=function(){function $t($d){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$t._uniqueIDCounter,this._needSort=!1,this._scene=$d,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={};}$c($t,"laya.d3.core.render.RenderQueue");var $d=$t.prototype;return $d._sortOpaqueFunc=function($d,$t){if($d._render&&$t._render){var $l=$d._material.renderQueue-$t._material.renderQueue;return 0==$l?$d._render._distanceForSort-$t._render._distanceForSort:$l;}return 0;},$d._sortAlphaFunc=function($d,$t){if($d._render&&$t._render){var $l=$d._material.renderQueue-$t._material.renderQueue;return 0==$l?$t._render._distanceForSort-$d._render._distanceForSort:$l;}return 0;},$d._begainRenderElement=function($d,$t,$l){return!!$t._beforeRender($d);},$d._sortAlpha=function($d){$t._cameraPosition=$d,this._finalElements.sort(this._sortAlphaFunc);},$d._sortOpaque=function($d){$t._cameraPosition=$d,this._finalElements.sort(this._sortOpaqueFunc);},$d._preRender=function($d){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements);},$d._render=function($d,$t){for(var $l,$k,$W,$i,$A,$B,$o=$L.loopCount,$I=this._scene,$b=$d.camera,$f=($b.id,!1),$J=0,$c=this._finalElements.length;$J<$c;$J++){var $Y,$w,$D,$z=this._finalElements[$J];if(null!=$z._onPreRenderFunction&&$z._onPreRenderFunction.call($z._sprite3D,$d),0===$z._type){if($d.owner=$D=$z._sprite3D,$d.renderElement=$z,$D._preRenderUpdateComponents($d),$Y=$z.renderObj,$w=$z._material,this._begainRenderElement($d,$Y,$w)){if($l=$Y._getVertexBuffers(),!($W=($k=$Y._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$k.id]){this._errorRecord[$k.id]=1;var $e="vertexBuffer:"+("("+$k._destroyed+","+$k._released+","+$k._referenceCount+","+$k._buffer+")")+", material:"+($w?$w.__className+"("+$w._destroyed+","+$w._released+")":"null")+", owner:"+($D?$D.__className+"("+$D._destroyed+","+$D._activeInHierarchy+","+$D._displayedInStage+")":"null")+", renderObj:"+($Y?$Y.__className+"("+$Y._destroyed+","+$Y._released+","+$Y._referenceCount+")":"")+", parent:, url:"+($D?$D.url:"")+", disposeStack:"+$k.disposeStack;$R.recordError("报错：unknown vertexDeclaration  "+$e);}continue;}if($f=($i=$d._shader=$w._getShader($I._shaderDefineValue,$W.shaderDefineValue,$D._shaderDefineValue)).bind()||$o!==$i._uploadLoopCount,$l){if($i._uploadVertexBuffer!==$l||$f){for(var $g=0;$g<$l.length;$g++){var $H=$l[$g];$i.uploadAttributesX($H.vertexDeclaration.shaderValues.data,$H);}$i._uploadVertexBuffer=$l;}}else($i._uploadVertexBuffer!==$k||$f)&&($i.uploadAttributes($W.shaderValues.data,null),$i._uploadVertexBuffer=$k);($i._uploadScene!==$I||$f)&&($i.uploadSceneUniforms($I._shaderValues.data),$i._uploadScene=$I),($b!==$i._uploadCamera||$i._uploadSprite3D!==$D||$f)&&($i.uploadSpriteUniforms($D._shaderValues.data),$i._uploadSprite3D=$D),($b!==$i._uploadCamera||$f)&&($i.uploadCameraUniforms($b._shaderValues.data),$i._uploadCamera=$b),($i._uploadMaterial!==$w||$f)&&($w._upload(),$i._uploadMaterial=$w),$A!==$w?($w._setRenderStateBlendDepth(),$w._setRenderStateFrontFace($t,$D.transform),$A=$w,$B=$D):$B!==$D&&($w._setRenderStateFrontFace($t,$D.transform),$B=$D),$Y._render($d),$i._uploadLoopCount=$o;}$D._postRenderUpdateComponents($d);}else if(2===$z._type){$z.renderObj;$d.owner=$D=$z._sprite3D,$d.renderElement=$z,$d._batchIndexStart=$z._tempBatchIndexStart,$d._batchIndexEnd=$z._tempBatchIndexEnd,$Y=$z.renderObj,$w=$z._material,this._begainRenderElement($d,$Y,$w)&&($W=($k=$Y._getVertexBuffer(0)).vertexDeclaration,$f=($i=$d._shader=$w._getShader($I._shaderDefineValue,$W.shaderDefineValue,$D._shaderDefineValue)).bind()||$o!==$i._uploadLoopCount,($i._uploadVertexBuffer!==$k||$f)&&($i.uploadAttributes($W.shaderValues.data,null),$i._uploadVertexBuffer=$k),($i._uploadScene!==$I||$f)&&($i.uploadSceneUniforms($I._shaderValues.data),$i._uploadScene=$I),($b!==$i._uploadCamera||$i._uploadSprite3D!==$D||$f)&&($i.uploadSpriteUniforms($D._shaderValues.data),$i._uploadSprite3D=$D),($b!==$i._uploadCamera||$f)&&($i.uploadCameraUniforms($b._shaderValues.data),$i._uploadCamera=$b),($i._uploadMaterial!==$w||$f)&&($w._upload(),$i._uploadMaterial=$w),$A!==$w?($w._setRenderStateBlendDepth(),$w._setRenderStateFrontFace($t,$D.transform),$A=$w,$B=$D):$B!==$D&&($w._setRenderStateFrontFace($t,$D.transform),$B=$D),$Y._render($d),$i._uploadLoopCount=$o);}}},$d._renderShadow=function($d,$t){for(var $l,$k,$W,$i,$A,$B=$L.loopCount,$o=this._scene,$I=$d.camera,$b=!1,$f=0,$J=this._finalElements.length;$f<$J;$f++){var $c,$Y,$w,$D=this._finalElements[$f];0===$D._type&&($d.owner=$w=$D._sprite3D,$t||$w._projectionViewWorldUpdateCamera===$I&&$w._projectionViewWorldUpdateLoopCount===$L.loopCount||($w._render._renderUpdate($d._projectionViewMatrix),$w._projectionViewWorldUpdateLoopCount=$L.loopCount,$w._projectionViewWorldUpdateCamera=$I),$d.renderElement=$D,$w._preRenderUpdateComponents($d),$c=$D.renderObj,$Y=$D._material,this._begainRenderElement($d,$c,null)&&($k=($l=$c._getVertexBuffer(0)).vertexDeclaration,$b=($W=$d._shader=$Y._getShader($o._shaderDefineValue,$k.shaderDefineValue,$w._shaderDefineValue)).bind()||$B!==$W._uploadLoopCount,($W._uploadVertexBuffer!==$l||$b)&&($W.uploadAttributes($k.shaderValues.data,null),$W._uploadVertexBuffer=$l),($I!==$W._uploadCamera||$W._uploadSprite3D!==$w||$b)&&($W.uploadSpriteUniforms($w._shaderValues.data),$W._uploadSprite3D=$w),($I!==$W._uploadCamera||$b)&&($W.uploadCameraUniforms($I._shaderValues.data),$W._uploadCamera=$I),($W._uploadMaterial!==$Y||$b)&&($Y._upload(),$W._uploadMaterial=$Y),$W._uploadRenderElement,$i!==$Y?($Y._setRenderStateFrontFace(!1,$w.transform),$i=$Y,$A=$w):$A!==$w&&($Y._setRenderStateFrontFace(!1,$w.transform),$A=$w),$c._render($d),$W._uploadLoopCount=$B),$w._postRenderUpdateComponents($d));}},$d._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0;},$d._addRenderElement=function($d){this._renderElements.push($d),this._needSort=!0;},$d._addDynamicBatchElement=function($d){this._dynamicBatchCombineRenderElements.push($d);},$Y(0,$d,"id",function(){return this._id;}),$t._uniqueIDCounter=0,$t._cameraPosition=null,$t;}(),$m=function(){function $d(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null;}return $c($d,"laya.d3.core.render.RenderState"),$d.clientWidth=0,$d.clientHeight=0,$d;}(),$O=function(){function $A($d,$t){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $ad(new $At(),0),this._corners=[new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At()],this._boundingBoxCenter=new $At(),this._children=$k(8),this._objects=[],this._tempBoundBoxCorners=[new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At()],this._scene=$d,this._currentDepth=$t;}$c($A,"laya.d3.core.scene.OctreeNode");var $d=$A.prototype;return $R.imps($d,{"laya.d3.core.scene.ITreeNode":!0}),$d.init=function($d,$t){var $l=new $At(),$k=new $At();$At.scale($t,-.5,$l),$At.scale($t,.5,$k),$At.add($l,$d,$l),$At.add($k,$d,$k),this.exactBox=new $Od($l,$k),this.relaxBox=new $Od($l,$k);},$d.addTreeNode=function($d){1===Collision.boxContainsBox(this._relaxBox,$d.boundingBox)?this.addNodeDown($d,0):this.addObject($d);},$d.addChild=function($d){var $t=this._children[$d];if(null==$t){$t=new $A(this._scene,this._currentDepth+1),(this._children[$d]=$t)._parent=this,$At.subtract(this._exactBox.max,this._exactBox.min,$A.tempSize),$At.multiply($A.tempSize,$A._octreeSplit[$d],$A.tempCenter),$At.add(this._exactBox.min,$A.tempCenter,$A.tempCenter),$At.scale($A.tempSize,.25,$A.tempSize);var $l=new $At(),$k=new $At();$At.subtract($A.tempCenter,$A.tempSize,$l),$At.add($A.tempCenter,$A.tempSize,$k),$t.exactBox=new $Od($l,$k),$At.scale($A.tempSize,$A.relax,$A.tempSize);var $W=new $At(),$i=new $At();$At.subtract($A.tempCenter,$A.tempSize,$W),$At.add($A.tempCenter,$A.tempSize,$i),$t.relaxBox=new $Od($W,$i);}return $t;},$d.addObject=function($d){($d._treeNode=this)._objects.push($d);},$d.removeObject=function($d){if($d._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $t=this._objects.indexOf($d);return-1!==$t&&(this._objects.splice($t,1),!0);},$d.clearObject=function(){this._objects.length=0;},$d.addNodeUp=function($d,$t){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$d.boundingBox)?this._parent.addNodeUp($d,$t-1):this.addNodeDown($d,$t);},$d.addNodeDown=function($d,$t){if($t<this._scene.treeLevel){var $l=this.inChildIndex($d.boundingBoxCenter),$k=this.addChild($l);1===Collision.boxContainsBox($k._relaxBox,$d.boundingBox)?$k.addNodeDown($d,++$t):this.addObject($d);}else this.addObject($d);},$d.inChildIndex=function($d){return 4*($d.z<this._boundingBoxCenter.z?0:1)+2*($d.y<this._boundingBoxCenter.y?0:1)+($d.x<this._boundingBoxCenter.x?0:1);},$d.updateObject=function($d){1===Collision.boxContainsBox(this._relaxBox,$d.boundingBox)?(this.removeObject($d),$d._treeNode=null,this.addNodeDown($d,this._currentDepth)):this._parent&&(this.removeObject($d),$d._treeNode=null,this._parent.addNodeUp($d,this._currentDepth-1));},$d.cullingObjects=function($d,$t,$l,$k,$W){var $i,$A=0,$B=0,$o=0,$I=this._scene._dynamicBatchManager;for($A=0,$i=this._objects.length;$A<$i;$A++){var $b=this._objects[$A];if($C.isVisible($b._owner.layer.mask)&&$b.enable){if($t&&($L.treeSpriteCollision+=1,0===$d.containsBoundSphere($b.boundingSphere)))continue;$b._renderUpdate($W),$b._distanceForSort=$At.distance($b.boundingSphere.center,$k)+$b.sortingFudge;var $f=$b._renderElements;for($B=0,$o=$f.length;$B<$o;$B++){var $J=$f[$B],$c=$J._staticBatch;if($c&&$c._material===$J._material)$c._addBatchRenderElement($J);else{var $Y=$J.renderObj;$Y.triangleCount<10&&1===$Y._vertexBufferCount&&$Y._getIndexBuffer()&&$J._material.renderQueue<2&&$J._canDynamicBatch&&!$b._owner.isStatic?$I._addPrepareRenderElement($J):this._scene.getRenderQueue($J._material.renderQueue)._addRenderElement($J);}}}}for($A=0;$A<8;$A++){var $w=this._children[$A];if(null!=$w){var $D=$t;if($t){var $z=$d.containsBoundBox($w._relaxBox);if($L.treeNodeCollision+=1,0===$z)continue;$D=2===$z;}$w.cullingObjects($d,$D,$l,$k,$W);}}},$d.cullingShadowObjects=function($d,$t,$l,$k,$W){var $i,$A=0,$B=0,$o=0;this._scene._dynamicBatchManager;for($A=0,$i=this._objects.length;$A<$i;$A++){var $I=this._objects[$A];if($I.castShadow&&$C.isVisible($I._owner.layer.mask)&&$I.enable){if($l&&0===$d[0].containsBoundSphere($I.boundingSphere))continue;for(var $b=1,$f=$d.length;$b<$f;$b++){var $J=$t[$b-1];if(0!==$d[$b].containsBoundSphere($I.boundingSphere)){var $c=$I._renderElements;for($B=0,$o=$c.length;$B<$o;$B++)$J._addRenderElement($c[$B]);}}}}for($A=0;$A<8;$A++){var $Y=this._children[$A];if(null!=$Y){var $w=$l;if($l){var $D=$d[0].containsBoundBox($Y._relaxBox);if(0===$D)continue;$w=2===$D;}$Y.cullingShadowObjects($d,$t,$w,$k,$W);}}},$d.cullingShadowObjectsOnePSSM=function($d,$t,$l,$k,$W,$i){var $A,$B=$t[0],$o=0,$I=0,$b=0;for($o=0,$A=this._objects.length;$o<$A;$o++){var $f=this._objects[$o];if($f.castShadow&&$C.isVisible($f._owner.layer.mask)&&$f.enable){if($k&&0===$d.containsBoundSphere($f.boundingSphere))continue;$f._renderUpdate($l);var $J=$f._renderElements;for($I=0,$b=$J.length;$I<$b;$I++)$B._addRenderElement($J[$I]);}}for($o=0;$o<8;$o++){var $c=this._children[$o];if(null!=$c){var $Y=$k;if($k){var $w=$d.containsBoundBox($c._relaxBox);if(0===$w)continue;$Y=2===$w;}$c.cullingShadowObjectsOnePSSM($d,$t,$l,$Y,$W,$i);}}},$d.renderBoudingBox=function($d){this._renderBoudingBox($d);for(var $t=0;$t<8;++$t){var $l=this._children[$t];$l&&$l.renderBoudingBox($d);}},$d.buildAllChild=function($d){if($d<this._scene.treeLevel)for(var $t=0;$t<8;$t++){this.addChild($t).buildAllChild($d+1);}},$d._renderBoudingBox=function($d){},$Y(0,$d,"exactBox",function(){return this._exactBox;},function($d){this._exactBox=$d,$At.add($d.min,$d.max,this._boundingBoxCenter),$At.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter);}),$Y(0,$d,"relaxBox",function(){return this._relaxBox;},function($d){(this._relaxBox=$d).getCorners(this._corners),$ad.createfromPoints(this._corners,this._boundingSphere);}),$A.debugMode=!1,$A.relax=1.15,$A.CHILDNUM=8,$f($A,["tempVector0",function(){return this.tempVector0=new $At();},"tempSize",function(){return this.tempSize=new $At();},"tempCenter",function(){return this.tempCenter=new $At();},"_octreeSplit",function(){return this._octreeSplit=[new $At(.25,.25,.25),new $At(.75,.25,.25),new $At(.25,.75,.25),new $At(.75,.75,.25),new $At(.25,.25,.75),new $At(.75,.25,.75),new $At(.25,.75,.75),new $At(.75,.75,.75)];}]),$A;}(),$F=(function(){function $d(){}$c($d,"laya.d3.core.scene.SceneManager");}(),function(){function $d($d,$t,$l,$k){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$d&&($d=1),void 0===$t&&($t=1),void 0===$l&&($l=1),void 0===$k&&($k=1),this._r=$d,this._g=$t,this._b=$l,this._a=$k;}return $c($d,"laya.d3.core.trail.module.Color",null,"Color$1"),$d.prototype.cloneTo=function($d){$d._r=this._r,$d._g=this._g,$d._b=this._b,$d._a=this._a;},$f($d,["RED",function(){return this.RED=new $d(1,0,0,1);},"GREEN",function(){return this.GREEN=new $d(0,1,0,1);},"BLUE",function(){return this.BLUE=new $d(0,0,1,1);},"CYAN",function(){return this.CYAN=new $d(0,1,1,1);},"YELLOW",function(){return this.YELLOW=new $d(1,.92,.016,1);},"MAGENTA",function(){return this.MAGENTA=new $d(1,0,1,1);},"GRAY",function(){return this.GRAY=new $d(.5,.5,.5,1);},"WHITE",function(){return this.WHITE=new $d(1,1,1,1);},"BLACK",function(){return this.BLACK=new $d(0,0,0,1);}]),$d;}()),$a=(function(){function $d(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[];}$c($d,"laya.d3.core.trail.module.Gradient");var $t=$d.prototype;$t.setKeys=function($d,$t){var $l,$k;this._colorKeys=$d;for(var $W=this.index=0;$W<$d.length;$W++){var $i=($l=$d[$W]).color;this._colorKeyData[this.index++]=$i._r,this._colorKeyData[this.index++]=$i._g,this._colorKeyData[this.index++]=$i._b,this._colorKeyData[this.index++]=$l.time;}this._alphaKeys=$t;for(var $A=this.index=0;$A<$t.length;$A++)$k=$t[$A],this._alphaKeyData[this.index++]=$k.alpha,this._alphaKeyData[this.index++]=$k.time;},$t.cloneTo=function($d){var $t=0,$l=0,$k=this.colorKeys,$W=[];for($t=0,$l=$k.length;$t<$l;$t++){var $i=new $_();$k[$t].cloneTo($i),$W.push($i);}var $A=this.alphaKeys,$B=[];for($t=0,$l=$A.length;$t<$l;$t++){var $o=new $a();$A[$t].cloneTo($o),$B.push($o);}$d.setKeys($W,$B);},$Y(0,$t,"mode",function(){return this._mode;},function($d){this._mode=$d;}),$Y(0,$t,"colorKeys",function(){return this._colorKeys;},function($d){this._colorKeys=$d;for(var $t=this.index=0;$t<$d.length;$t++){var $l=$d[$t],$k=$l.color;this._colorKeyData[this.index++]=$k._r,this._colorKeyData[this.index++]=$k._g,this._colorKeyData[this.index++]=$k._b,this._colorKeyData[this.index++]=$l.time;}}),$Y(0,$t,"alphaKeys",function(){return this._alphaKeys;},function($d){this._alphaKeys=$d;for(var $t=this.index=0;$t<$d.length;$t++){var $l=$d[$t];this._alphaKeyData[this.index++]=$l.alpha,this._alphaKeyData[this.index++]=$l.time;}});}(),function(){function $d($d,$t){this._alpha=NaN,this._time=NaN,void 0===$d&&($d=0),void 0===$t&&($t=0),this._alpha=$d,this._time=$t;}$c($d,"laya.d3.core.trail.module.GradientAlphaKey");var $t=$d.prototype;return $t.cloneTo=function($d){$d.alpha=this.alpha,$d.time=this.time;},$Y(0,$t,"alpha",function(){return this._alpha;},function($d){this._alpha=$d;}),$Y(0,$t,"time",function(){return this._time;},function($d){this._time=$d;}),$d;}()),$_=function(){function $d($d,$t){this._color=null,this._time=NaN,void 0===$t&&($t=0),this._color=$d||new $F(),this._time=$t;}$c($d,"laya.d3.core.trail.module.GradientColorKey");var $t=$d.prototype;return $t.cloneTo=function($d){this.color.cloneTo($d.color),$d.time=this.time;},$Y(0,$t,"color",function(){return this._color;},function($d){this._color=$d;}),$Y(0,$t,"time",function(){return this._time;},function($d){this._time=$d;}),$d;}(),$v=(function(){function $d(){}$c($d,"laya.d3.core.trail.module.GradientMode"),$d.Blend=0,$d.Fixed=1;}(),function(){function $d(){}$c($d,"laya.d3.core.trail.module.TextureMode"),$d.Stretch=0,$d.Tile=1;}(),function(){function $d(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN;}$c($d,"laya.d3.core.trail.module.TrailKeyFrame"),$d.prototype.cloneTo=function($d){$d.time=this.time,$d.inTangent=this.inTangent,$d.outTangent=this.outTangent,$d.value=this.value;};}(),function(){function $t($d){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $At(),this._curPosition=new $At(),this._delVector3=new $At(),this._lastFixedVertexPosition=new $At(),this._pointAtoBVector3=new $At(),this._pointA=new $At(),this._pointB=new $At(),this._owner=$d,this._id=$t.renderElementCount++,0==this._id?$d._owner.transform.position.cloneTo(this._lastPosition):$d._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $Vt($v.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $Vt($v.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2);}$c($t,"laya.d3.core.trail.TrailRenderElement");var $d=$t.prototype;$R.imps($d,{"laya.d3.core.render.IRenderable":!0}),$d._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1);},$d._addTrailByFirstPosition=function($d,$t){$At.subtract($t,$d,this._delVector3),$At.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$At.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$At.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($d),$d.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0;},$d._addTrailByNextPosition=function($d){$At.subtract($d,this._lastFixedVertexPosition,this._delVector3),$At.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$At.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$At.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$At.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$_d.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($d),$d.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($d),this._virtualVerticesCount=2);},$d._updateVerticesByPosition=function($d){this._pointe=$d.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0;},$d._updateVertexBuffer2=function(){var $d,$t=0,$l=0,$k=0;for($k=0,$d=(this._verticesCount+this._virtualVerticesCount)/2;$k<$d;$k++)$l=0==this._owner.textureMode?(this._VerticesToTailLength[$k]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$k],this._vertices2[$t++]=1-$l,this._vertices2[$t++]=1-$l;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount);},$d._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0;},$d._updateDisappear=function(){var $d,$t=0;for($t=this._curDisappearIndex,$d=(this._verticesCount+this._virtualVerticesCount)/2;$t<$d;$t++)this._owner._curtime-this._everyGroupVertexBirthTime[$t]>=this._owner.time+$_d.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0));},$d._beforeRender=function($d){return this._camera=$d.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$At.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0));},$d._render=function($d){this._isDead||($r.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$L.drawCall++,$L.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2);},$d._getVertexBuffer=function($d){return void 0===$d&&($d=0),0===$d?this._vertexBuffer1:1===$d?this._vertexBuffer2:null;},$d._getVertexBuffers=function(){return this._vertexBuffers;},$d._getIndexBuffer=function(){return null;},$d.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition);},$d._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null;},$Y(0,$d,"_vertexBufferCount",function(){return this._vertexBuffers.length;}),$Y(0,$d,"triangleCount",function(){return 0;}),$t.renderElementCount=0;}(),function(){function $d(){}$c($d,"laya.d3.core.trail.VertexTrail");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration1;}),$Y(1,$d,"vertexDeclaration1",function(){return $d._vertexDeclaration1;}),$Y(1,$d,"vertexDeclaration2",function(){return $d._vertexDeclaration2;}),$f($d,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $id(32,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",41),new $Ad(24,"single",33),new $Ad(28,"single",40)]);},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $id(4,[new $Ad(0,"single",38)]);}]),$d;}()),$dd=function(){function $H($d){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$d;}$c($H,"laya.d3.graphics.DynamicBatch");var $d=$H.prototype;return $R.imps($d,{"laya.d3.core.render.IRenderable":!0}),$d._getVertexBuffer=function($d){return void 0===$d&&($d=0),0===$d?this._vertexBuffer:null;},$d._getIndexBuffer=function(){return this._indexBuffer;},$d._getCombineRenderElementFromPool=function($d,$t,$l){var $k=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $k||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$k=new $P(),$k._sprite3D=new $Xt()),$k._sprite3D._render._renderUpdate($l),$k;},$d._getRenderElement=function($d,$t,$l){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$H.maxVertexCount),this._indexDatas=new Uint16Array($H.maxIndexCount),this._vertexBuffer=$Vt.create(this._vertexDeclaration,$H.maxVertexCount,35048),this._indexBuffer=$yt.create("ushort",$H.maxIndexCount,35048));for(var $k=this._merageElements.length=0,$W=0,$i=0,$A=this._combineRenderElements.length;$i<$A;$i++){var $B=this._combineRenderElements[$i],$o=$B.getDynamicBatchBakedVertexs(0),$I=$B.getBakedIndices(),$b=$B._sprite3D.transform._isFrontFaceInvert,$f=$k/(this._vertexDeclaration.vertexStride/4),$J=$W,$c=$J+$I.length;$B._tempBatchIndexStart=$J,$B._tempBatchIndexEnd=$c,this._indexDatas.set($I,$W);var $Y=0;if($b)for($Y=$J;$Y<$c;$Y+=3){this._indexDatas[$Y]=$f+this._indexDatas[$Y];var $w=this._indexDatas[$Y+1],$D=this._indexDatas[$Y+2];this._indexDatas[$Y+1]=$f+$D,this._indexDatas[$Y+2]=$f+$w;}else for($Y=$J;$Y<$c;$Y+=3)this._indexDatas[$Y]=$f+this._indexDatas[$Y],this._indexDatas[$Y+1]=$f+this._indexDatas[$Y+1],this._indexDatas[$Y+2]=$f+this._indexDatas[$Y+2];$W+=$I.length,this._vertexDatas.set($o,$k),$k+=$o.length;}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$i=this._combineRenderElementPoolIndex=0,$A=this._materials.length;$i<$A;$i++){var $z=this._getCombineRenderElementFromPool($d,$t,$l);$z._type=2,$z._staticBatch=null;var $e=($z.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$i]]._tempBatchIndexStart,$g=$i+1===this._materialToRenderElementsOffsets.length?$W:this._combineRenderElements[this._materialToRenderElementsOffsets[$i+1]]._tempBatchIndexStart;$z._tempBatchIndexStart=$e,$z._tempBatchIndexEnd=$g,$z._material=this._materials[$i],this._merageElements.push($z);}},$d._addCombineRenderObjTest=function($d){var $t=$d.renderObj,$l=this._currentCombineIndexCount+$t._getIndexBuffer().indexCount,$k=this._currentCombineVertexCount+$t._getVertexBuffer().vertexCount;return!($H.maxVertexCount<$k||$H.maxIndexCount<$l);},$d._addCombineRenderObj=function($d){var $t=$d.renderObj;this._combineRenderElements.push($d),this._currentCombineIndexCount=this._currentCombineIndexCount+$t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$t._getVertexBuffer().vertexCount;},$d._addCombineMaterial=function($d){this._materials.push($d);},$d._addMaterialToRenderElementOffset=function($d){this._materialToRenderElementsOffsets.push($d);},$d._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0;},$d._addToRenderQueue=function($d,$t,$l,$k){this._getRenderElement($t,$l,$k);for(var $W=0,$i=this._materials.length;$W<$i;$W++)$d.getRenderQueue(this._materials[$W].renderQueue)._addDynamicBatchElement(this._merageElements[$W]);},$d._beforeRender=function($d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$d._render=function($d){var $t=$d._batchIndexEnd-$d._batchIndexStart;$r.mainContext.drawElements(4,$t,5123,2*$d._batchIndexStart),$L.drawCall++,$L.trianglesFaces+=$t/3;},$d._getVertexBuffers=function(){return null;},$Y(0,$d,"_vertexBufferCount",function(){return 1;}),$Y(0,$d,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$Y(0,$d,"combineRenderElementsCount",function(){return this._combineRenderElements.length;}),$H.maxVertexCount=2e4,$H.maxIndexCount=4e4,$H.maxCombineTriangleCount=10,$H;}(),$td=function(){function $H(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[];}$c($H,"laya.d3.graphics.DynamicBatchManager");var $d=$H.prototype;return $d.getDynamicBatch=function($d,$t){var $l,$k=$d.id.toString()+$t;return this._dynamicBatches[$k]?$l=this._dynamicBatches[$k]:this._dynamicBatches[$k]=$l=new $dd($d),$l;},$d._garbageCollection=function(){for(var $d in this._dynamicBatches)0===this._dynamicBatches[$d].combineRenderElementsCount&&delete this._dynamicBatches[$d];},$d._addPrepareRenderElement=function($d){this._prepareDynamicBatchCombineElements.push($d);},$d._finishCombineDynamicBatch=function($d){var $t,$l,$k;this._prepareDynamicBatchCombineElements.sort($H._sortPrepareDynamicBatch);for(var $W,$i,$A,$B,$o,$I=-1,$b=!0,$f=0,$J=-1,$c=0,$Y=this._prepareDynamicBatchCombineElements.length;$c<$Y;$c++){var $w=($i=this._prepareDynamicBatchCombineElements[$c]).renderObj._getVertexBuffer(0).vertexDeclaration,$D=$l!==$w;$D&&($f=0,$l=$w);var $z=$f!==$I;if($z&&($I=$f),($D||$z)&&($A=this.getDynamicBatch($w,$f),$t=null),$b){if($A._addCombineRenderObjTest($i)){if($t!==($W=$i._material))$B&&($d.getRenderQueue($o._material.renderQueue)._addRenderElement($o),$o=$B=null,$J=-1),$B=$W,$J=$A.combineRenderElementsCount,$o=$i,$t=$W;else if($B){var $e=$o.renderObj,$g=$i.renderObj;$e._getVertexBuffer().vertexCount+$g._getVertexBuffer().vertexCount>$dd.maxVertexCount||$e._getIndexBuffer().indexCount+$g._getIndexBuffer().indexCount>$dd.maxIndexCount?($d.getRenderQueue($o._material.renderQueue)._addRenderElement($o),$B=$W,$J=$A.combineRenderElementsCount,$o=$i):($A._addCombineMaterial($B),$A._addMaterialToRenderElementOffset($J),$A._addCombineRenderObj($o),$o=$B=null,$J=-1,$A._addCombineRenderObj($i));}else $A._addCombineRenderObj($i);$b=!0;}else $B&&($d.getRenderQueue($o._material.renderQueue)._addRenderElement($o),$o=$B=null,$J=-1),$f++,$b=!1;}else $k=this._prepareDynamicBatchCombineElements[$c-1],$A._addMaterialToRenderElementOffset($A.combineRenderElementsCount),$t=$k._material,$A._addCombineMaterial($t),$A._addCombineRenderObj($k),$b=!0,$t!==($W=$i._material)?($B=$W,$J=$A.combineRenderElementsCount,$o=$i):$A._addCombineRenderObj($i),$t=$W;}$B&&($d.getRenderQueue($o._material.renderQueue)._addRenderElement($o),$o=$B=null,$J=-1),this._prepareDynamicBatchCombineElements.length=0;},$d._clearRenderElements=function(){for(var $d in this._dynamicBatches)this._dynamicBatches[$d]._clearRenderElements();},$d._addToRenderQueue=function($d,$t,$l,$k){for(var $W in this._dynamicBatches){var $i=this._dynamicBatches[$W];0<$i.combineRenderElementsCount&&$i._addToRenderQueue($d,$t,$l,$k);}},$d.dispose=function(){this._dynamicBatches=null;},$H._sortPrepareDynamicBatch=function($d,$t){return $d._mainSortID-$t._mainSortID;},$H;}(),$ld=function(){function $d(){}return $c($d,"laya.d3.graphics.FrustumCulling"),$d.renderShadowObjectCulling=function($d,$t,$l,$k,$W){var $i=0,$A=0,$B=0,$o=0;for($i=0,$B=$l.length;$i<$B;$i++){var $I=$l[$i];$I&&$I._clearRenderElements();}var $b,$f,$J,$c=$d._cullingRenders;if(1<$W){for($i=0,$B=$d._cullingRendersLength;$i<$B;$i++)if(($b=$c[$i]).castShadow&&$C.isVisible($b._owner.layer.mask)&&$b.enable)for(var $Y=1,$w=$t.length;$Y<$w;$Y++)if($f=$l[$Y-1],0!==$t[$Y].containsBoundSphere($b.boundingSphere))for($A=0,$o=($J=$b._renderElements).length;$A<$o;$A++)$f._addRenderElement($J[$A]);}else for($i=0,$B=$d._cullingRendersLength;$i<$B;$i++)if(($b=$c[$i]).castShadow&&$C.isVisible($b._owner.layer.mask)&&$b.enable&&0!==$t[0].containsBoundSphere($b.boundingSphere))for($b._renderUpdate($k),$f=$l[0],$A=0,$o=($J=$b._renderElements).length;$A<$o;$A++)$f._addRenderElement($J[$A]);},$d.renderShadowObjectCullingOctree=function($d,$t,$l,$k,$W){for(var $i=0,$A=$l.length;$i<$A;$i++){var $B=$l[$i];$B&&$B._clearRenderElements();}1<$W?$d.treeRoot.cullingShadowObjects($t,$l,!0,0,$d):$d.treeRoot.cullingShadowObjectsOnePSSM($t[0],$l,$k,!0,0,$d);},$d.renderObjectCulling=function($d,$t,$l,$k,$W,$i){var $A=0,$B=0,$o=0,$I=0,$b=$t._quenes,$f=$t._dynamicBatchManager,$J=$t._cullingRenders;for($A=0,$B=$b.length;$A<$B;$A++){var $c=$b[$A];$c&&$c._clearRenderElements();}var $Y=$kd._staticBatchManagers;for($A=0,$B=$Y.length;$A<$B;$A++)$Y[$A]._clearRenderElements();$f._clearRenderElements();var $w=$l.transform.position;for($A=0,$B=$t._cullingRendersLength;$A<$B;$A++){var $D=$J[$A];if($C.isVisible($D._owner.layer.mask)&&$D.enable&&0!==$d.containsBoundSphere($D.boundingSphere)&&$D._renderUpdate($i)){$D._distanceForSort=$At.distance($D.boundingSphere.center,$w)+$D.sortingFudge;var $z=$D._renderElements;for($o=0,$I=$z.length;$o<$I;$o++){var $e=$z[$o],$g=$e._staticBatch;if($g&&$g._material===$e._material)$g._addBatchRenderElement($e);else{var $H=$e.renderObj;$H.triangleCount<10&&1===$H._vertexBufferCount&&$H._getIndexBuffer()&&$e._material.renderQueue<2&&$e._canDynamicBatch&&!$D._owner.isStatic?$f._addPrepareRenderElement($e):$t.getRenderQueue($e._material.renderQueue)._addRenderElement($e);}}}}for($A=0,$B=$Y.length;$A<$B;$A++)$Y[$A]._addToRenderQueue($t,$k,$W,$i);$f._finishCombineDynamicBatch($t),$f._addToRenderQueue($t,$k,$W,$i);},$d.renderObjectCullingOctree=function($d,$t,$l,$k,$W,$i){var $A=0,$B=0,$o=$t._quenes,$I=$t._dynamicBatchManager;for($A=0,$B=$o.length;$A<$B;$A++){var $b=$o[$A];$b&&$b._clearRenderElements();}var $f=$kd._staticBatchManagers;for($A=0,$B=$f.length;$A<$B;$A++)$f[$A]._clearRenderElements();for($I._clearRenderElements(),$t._cullingRenders.length=0,$t.treeRoot.cullingObjects($d,!0,0,$l.transform.position,$i),$A=0,$B=$f.length;$A<$B;$A++)$f[$A]._addToRenderQueue($t,$k,$W,$i);$I._finishCombineDynamicBatch($t),$I._addToRenderQueue($t,$k,$W,$i);},$d.renderObjectCullingNoBoundFrustum=function($d,$t,$l,$k,$W){var $i=0,$A=0,$B=0,$o=0,$I=$d._quenes,$b=$d._dynamicBatchManager,$f=$d._cullingRenders;for($i=0,$A=$I.length;$i<$A;$i++){var $J=$I[$i];$J&&$J._clearRenderElements();}var $c=$kd._staticBatchManagers;for($i=0,$A=$c.length;$i<$A;$i++)$c[$i]._clearRenderElements();$b._clearRenderElements();var $Y=$t.transform.position;for($i=0,$A=$d._cullingRendersLength;$i<$A;$i++){var $w=$f[$i];if($C.isVisible($w._owner.layer.mask)&&$w.enable){$w._renderUpdate($W),$w._distanceForSort=$At.distance($w.boundingSphere.center,$Y)+$w.sortingFudge;var $D=$w._renderElements;for($B=0,$o=$D.length;$B<$o;$B++){var $z=$D[$B],$e=$z._staticBatch;if($e&&$e._material===$z._material)$e._addBatchRenderElement($z);else{var $g=$z.renderObj;$g.triangleCount<10&&1===$g._vertexBufferCount&&$g._getIndexBuffer()&&$z._material.renderQueue<2&&$z._canDynamicBatch&&!$w._owner.isStatic?$b._addPrepareRenderElement($z):$d.getRenderQueue($z._material.renderQueue)._addRenderElement($z);}}}}for($i=0,$A=$c.length;$i<$A;$i++)$c[$i]._addToRenderQueue($d,$l,$k,$W);$b._finishCombineDynamicBatch($d),$b._addToRenderQueue($d,$l,$k,$W);},$d;}(),$kd=function(){function $i(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={};}$c($i,"laya.d3.graphics.StaticBatchManager");var $d=$i.prototype;return $d._finishInit=function(){for(var $d in this._staticBatches)this._staticBatches[$d]._finishInit();this._initBatchRenderElements.length=0;},$d._initStaticBatchs=function($d){throw new Error("StaticBatchManager:must override this function.");},$d._addInitBatchSprite=function($d){for(var $t=$d._render._renderElements,$l=0,$k=$t.length;$l<$k;$l++)this._initBatchRenderElements.push($t[$l]);},$d._clearRenderElements=function(){for(var $d in this._staticBatches)this._staticBatches[$d]._clearRenderElements();},$d._garbageCollection=function($d){var $t=$d._staticBatch,$l=$t._initBatchRenderElements,$k=$l.indexOf($d);$l.splice($k,1),0===$l.length&&($t.dispose(),delete this._staticBatches[$t._key]);},$d._addToRenderQueue=function($d,$t,$l,$k){for(var $W in this._staticBatches){var $i=this._staticBatches[$W];0<$i._batchRenderElements.length&&$i._updateToRenderQueue($d,$k);}},$d.dispose=function(){this._staticBatches=null;},$i._addToStaticBatchQueue=function($d){$d instanceof laya.d3.core.RenderableSprite3D&&$d._addToInitStaticBatchManager();for(var $t=0,$l=$d.numChildren;$t<$l;$t++)$i._addToStaticBatchQueue($d._childs[$t]);},$i.combine=function($d,$t){var $l,$k=0,$W=0;if($t)for($k=0,$W=$t.length;$k<$W;$k++){$t[$k]._addToInitStaticBatchManager();}else $d&&$i._addToStaticBatchQueue($d);for($k=0,$W=$i._staticBatchManagers.length;$k<$W;$k++)($l=$i._staticBatchManagers[$k])._initStaticBatchs($d),$l._finishInit();},$i._staticBatchManagers=[],$i;}(),$Wd=function(){function $d($d,$t,$l){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$d,this._manager=$t,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$l;}$c($d,"laya.d3.graphics.StaticBatch");var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$t._binarySearch=function($d){for(var $t=0,$l=this._batchRenderElements.length-1,$k=0;$t<=$l;)$k=Math.floor(($t+$l)/2),this._compareBatchRenderElement(this._batchRenderElements[$k],$d)?$l=$k-1:$t=$k+1;return $t;},$t._compareBatchRenderElement=function($d,$t){throw new Error("StaticBatch:must override this function.");},$t._getVertexDecLightMap=function($d){return $d===$yd.vertexDeclaration?$Cd.vertexDeclaration:$d===$Qd.vertexDeclaration?$jd.vertexDeclaration:$d===$$d.vertexDeclaration?$Hd.vertexDeclaration:$d===$Ed.vertexDeclaration?null:$d===$wd.vertexDeclaration?$Dd.vertexDeclaration:$d===$Zd.vertexDeclaration?$xd.vertexDeclaration:$d===$rd.vertexDeclaration?$Sd.vertexDeclaration:$d===$Vd.vertexDeclaration?$Kd.vertexDeclaration:$d===$Qd.vertexDeclaration?$jd.vertexDeclaration:$d===$pd.vertexDeclaration?$Rd.vertexDeclaration:$d===$Ed.vertexDeclaration?null:$d===$wd.vertexDeclaration?$Dd.vertexDeclaration:$d===$Ud.vertexDeclaration?$nd.vertexDeclaration:$d===$rd.vertexDeclaration?$Sd.vertexDeclaration:$d;},$t._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.");},$t._addBatchRenderElement=function($d){this._batchRenderElements.splice(this._binarySearch($d),0,$d);},$t._updateToRenderQueue=function($d,$t){this._combineRenderElementPoolIndex=0,this._getRenderElement($d.getRenderQueue(this._material.renderQueue)._renderElements,$d,$t);},$t._getRenderElement=function($d,$t,$l){throw new Error("StaticBatch:must override this function.");},$t._finishInit=function(){throw new Error("StaticBatch:must override this function.");},$t._clearRenderElements=function(){this._batchRenderElements.length=0;},$t.dispose=function(){},$t._getVertexBuffer=function($d){return void 0===$d&&($d=0),null;},$t._getIndexBuffer=function(){return null;},$t._beforeRender=function($d){return!0;},$t._render=function($d){},$t._getVertexBuffers=function(){return null;},$Y(0,$t,"_vertexBufferCount",function(){return 1;}),$Y(0,$t,"triangleCount",function(){return 0;}),$d.combine=function($d){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$kd.combine($d);},$d.maxBatchVertexCount=65535,$d;}(),$id=function(){function $A($d,$t){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$A._uniqueIDCounter,this._id>$A.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$A.maxVertexDeclaration);this._shaderValues=new $Jt(),this._vertexElementsDic={},this._vertexStride=$d,this._vertexElements=$t;for(var $l=0;$l<$t.length;$l++){var $k=$t[$l],$W=$k.elementUsage;this._vertexElementsDic[$W]=$k;var $i=[$A._getTypeSize($k.elementFormat)/4,5126,!1,this._vertexStride,$k.offset];switch(this._shaderValues.setValue($W,$i),$W){case 1:this._addShaderDefine($Lt.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($Lt.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($Lt.SHADERDEFINE_UV1);}}}$c($A,"laya.d3.graphics.VertexDeclaration");var $d=$A.prototype;return $d._addShaderDefine=function($d){this._shaderDefineValue|=$d;},$d._removeShaderDefine=function($d){this._shaderDefineValue&=~$d;},$d.getVertexElements=function(){return this._vertexElements.slice();},$d.getVertexElementByUsage=function($d){return this._vertexElementsDic[$d];},$d.unBinding=function(){},$Y(0,$d,"shaderDefineValue",function(){return this._shaderDefineValue;}),$Y(0,$d,"id",function(){return this._id;}),$Y(0,$d,"vertexStride",function(){return this._vertexStride;}),$Y(0,$d,"shaderValues",function(){return this._shaderValues;}),$A._getTypeSize=function($d){switch($d){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8;}return 0;},$A.getVertexStride=function($d){for(var $t=0,$l=0;$l<$d.Length;$l++){var $k=$d[$l],$W=$k.offset+$A._getTypeSize($k.elementFormat);$t<$W&&($t=$W);}return $t;},$A._maxVertexDeclarationBit=1e3,$A._uniqueIDCounter=1,$f($A,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647);}]),$A;}(),$Ad=function(){function $d($d,$t,$l){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$d,this.elementFormat=$t,this.elementUsage=$l;}return $c($d,"laya.d3.graphics.VertexElement"),$d;}(),$Bd=(function(){function $d(){}$c($d,"laya.d3.graphics.VertexElementFormat"),$d.Single="single",$d.Vector2="vector2",$d.Vector3="vector3",$d.Vector4="vector4",$d.Color="color",$d.Byte4="byte4",$d.Short2="short2",$d.Short4="short4",$d.NormalizedShort2="normalizedshort2",$d.NormalizedShort4="normalizedshort4",$d.HalfVector2="halfvector2",$d.HalfVector4="halfvector4";}(),function(){function $d(){}$c($d,"laya.d3.graphics.VertexElementUsage"),$d.POSITION0=0,$d.COLOR0=1,$d.TEXTURECOORDINATE0=2,$d.NORMAL0=3,$d.BINORMAL0=4,$d.TANGENT0=5,$d.BLENDINDICES0=6,$d.BLENDWEIGHT0=7,$d.DEPTH0=8,$d.FOG0=9,$d.POINTSIZE0=10,$d.SAMPLE0=11,$d.TESSELLATEFACTOR0=12,$d.COLOR1=13,$d.NEXTTEXTURECOORDINATE0=14,$d.TEXTURECOORDINATE1=15,$d.NEXTTEXTURECOORDINATE1=16,$d.CORNERTEXTURECOORDINATE0=17,$d.VELOCITY0=18,$d.STARTCOLOR0=19,$d.STARTSIZE=20,$d.AGEADDSCALE0=21,$d.STARTROTATION=22,$d.ENDCOLOR0=23,$d.STARTLIFETIME=24,$d.TIME0=33,$d.SHAPEPOSITIONSTARTLIFETIME=30,$d.DIRECTIONTIME=32,$d.SIZEROTATION0=27,$d.RADIUS0=28,$d.RADIAN0=29,$d.STARTSPEED=31,$d.RANDOM0=34,$d.RANDOM1=35,$d.SIMULATIONWORLDPOSTION=36,$d.SIMULATIONWORLDROTATION=37,$d.TEXTURECOORDINATE0X=38,$d.TEXTURECOORDINATE0X1=39,$d.TEXTURECOORDINATE0Y=40,$d.OFFSETVECTOR=41;}(),function(){function $d($d,$t,$l){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$d,this._textureCoordinate0=$t,this._time=$l;}$c($d,"laya.d3.graphics.VertexGlitter");var $t=$d.prototype;$R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate0;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"time",function(){return this._time;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(24,[new $Ad(0,"vector3",0),new $Ad(12,"vector2",2),new $Ad(20,"single",33)]);}]);}(),function(){function $d($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$d,this._position=$t,this._velocity=$l,this._startColor=$k,this._endColor=$W,this._sizeRotation=$i,this._radius=$A,this._radian=$B,this._ageAddScale=$o,this._time=$I;}$c($d,"laya.d3.graphics.VertexParticle");var $t=$d.prototype;$R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"endColor",function(){return this._endColor;}),$Y(0,$t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$Y(0,$t,"sizeRotation",function(){return this._sizeRotation;}),$Y(0,$t,"velocity",function(){return this._velocity;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"startColor",function(){return this._startColor;}),$Y(0,$t,"radius",function(){return this._radius;}),$Y(0,$t,"radian",function(){return this._radian;}),$Y(0,$t,"ageAddScale",function(){return this._ageAddScale;}),$Y(0,$t,"time",function(){return this._time;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(116,[new $Ad(0,"vector4",17),new $Ad(16,"vector3",0),new $Ad(28,"vector3",18),new $Ad(40,"vector4",19),new $Ad(56,"vector4",23),new $Ad(72,"vector3",27),new $Ad(84,"vector2",28),new $Ad(92,"vector4",29),new $Ad(108,"single",24),new $Ad(112,"single",33)]);}]);}(),function(){function $d($d){this._position=null,this._position=$d;}$c($d,"laya.d3.graphics.VertexPosition");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(12,[new $Ad(0,"vector3",0)]);}]),$d;}()),$od=function(){function $d($d,$t){this._position=null,this._normal=null,this._position=$d,this._normal=$t;}$c($d,"laya.d3.graphics.VertexPositionNormal");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(24,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3)]);}]),$d;}(),$Id=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._color=null,this._position=$d,this._normal=$t,this._color=$l;}$c($d,"laya.d3.graphics.VertexPositionNormalColor");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(40,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1)]);}]),$d;}(),$bd=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$d,this._normal=$t,this._color=$l,this._blendIndex=$k,this._blendWeight=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalColorSkin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(72,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6)]);}]),$d;}(),$fd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._tangent=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(88,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6),new $Ad(72,"vector4",5)]);}]),$d;}(),$Jd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._tangent=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(84,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6),new $Ad(72,"vector3",5)]);}]),$d;}(),$cd=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._tangent=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(56,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector4",5)]);}]),$d;}(),$Yd=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._tangent=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(52,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector3",5)]);}]),$d;}(),$wd=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(48,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2)]);}]),$d;}(),$Dd=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(56,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15)]);}]),$d;}(),$zd=function(){function $d($d,$t,$l,$k,$W,$i,$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._blendIndex=$i,this._blendWeight=$A;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(88,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15),new $Ad(56,"vector4",7),new $Ad(72,"vector4",6)]);}]),$d;}(),$ed=function(){function $d($d,$t,$l,$k,$W,$i,$A,$B){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._tangent=$i,this._blendIndex=$A,this._blendWeight=$B;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(104,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15),new $Ad(56,"vector4",7),new $Ad(72,"vector4",6),new $Ad(88,"vector4",5)]);}]),$d;}(),$gd=function(){function $d(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$t.VertexPositionNormalColorTexture0SkinTangent=function($d,$t,$l,$k,$W,$i,$A,$B){this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._tangent=$i,this._blendIndex=$A,this._blendWeight=$B;},$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(100,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15),new $Ad(56,"vector4",7),new $Ad(72,"vector4",6),new $Ad(88,"vector3",5)]);}]),$d;}(),$Hd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._tangent=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(72,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15),new $Ad(56,"vector4",5)]);}]),$d;}(),$Rd=function(){function $d(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$t.VertexPositionNormalColorTexture0Tangent=function($d,$t,$l,$k,$W,$i){this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._tangent=$i;},$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(68,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector2",15),new $Ad(56,"vector3",5)]);}]),$d;}(),$Gd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(80,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector4",7),new $Ad(64,"vector4",6)]);}]),$d;}(),$qd=function(){function $d($d,$t,$l,$k,$W,$i,$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k,this._tangent=$W,this._blendIndex=$i,this._blendWeight=$A;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(96,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector4",7),new $Ad(64,"vector4",6),new $Ad(80,"vector4",5)]);}]),$d;}(),$Ld=function(){function $d($d,$t,$l,$k,$W,$i,$A){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k,this._tangent=$W,this._blendIndex=$i,this._blendWeight=$A;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(92,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector4",7),new $Ad(64,"vector4",6),new $Ad(80,"vector3",5)]);}]),$d;}(),$$d=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k,this._tangent=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(64,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector4",5)]);}]),$d;}(),$pd=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$d,this._normal=$t,this._color=$l,this._textureCoordinate=$k,this._tangent=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"color",function(){return this._color;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(60,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",1),new $Ad(40,"vector2",2),new $Ad(48,"vector3",5)]);}]),$d;}(),$Md=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._tangent=null,this._position=$d,this._normal=$t,this._tangent=$l;}$c($d,"laya.d3.graphics.VertexPositionNormalSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(40,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector4",5)]);}]),$d;}(),$Td=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._tangent=null,this._position=$d,this._normal=$t,this._tangent=$l;}$c($d,"laya.d3.graphics.VertexPositionNormalTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(36,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector3",5)]);}]),$d;}(),$rd=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(32,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2)]);}]),$d;}(),$Sd=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(40,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15)]);}]),$d;}(),$jd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(72,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6)]);}]),$d;}(),$Cd=function(){function $d($d,$t,$l,$k,$W,$i,$A){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k,this._tangent=$W,this._blendIndex=$i,this._blendWeight=$A;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(88,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6),new $Ad(72,"vector4",5)]);}]),$d;}(),$Kd=function(){function $d(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$t.VertexPositionNormalTexture0SkinTangent=function($d,$t,$l,$k,$W,$i,$A){this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k,this._tangent=$W,this._blendIndex=$i,this._blendWeight=$A;},$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(84,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15),new $Ad(40,"vector4",7),new $Ad(56,"vector4",6),new $Ad(72,"vector3",5)]);}]),$d;}(),$xd=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k,this._tangent=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(56,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15),new $Ad(40,"vector4",5)]);}]),$d;}(),$nd=function(){function $d(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$c($d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$t.VertexPositionNormalTexture0Tangent=function($d,$t,$l,$k,$W){this._position=$d,this._normal=$t,this._textureCoordinate0=$l,this._textureCoordinate1=$k,this._tangent=$W;},$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(52,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15),new $Ad(40,"vector3",5)]);}]),$d;}(),$Qd=function(){function $d($d,$t,$l,$k,$W){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l,this._blendIndex=$k,this._blendWeight=$W;}$c($d,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(64,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector4",7),new $Ad(48,"vector4",6)]);}]),$d;}(),$yd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l,this._tangent=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(80,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector4",7),new $Ad(48,"vector4",6),new $Ad(64,"vector4",5)]);}]),$d;}(),$Vd=function(){function $d($d,$t,$l,$k,$W,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l,this._tangent=$k,this._blendIndex=$W,this._blendWeight=$i;}$c($d,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(76,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector4",7),new $Ad(48,"vector4",6),new $Ad(64,"vector3",5)]);}]),$d;}(),$Zd=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l,this._tangent=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(48,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector4",5)]);}]),$d;}(),$Ud=function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l,this._tangent=$k;}$c($d,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(44,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector3",5)]);}]),$d;}(),$Ed=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l;}$c($d,"laya.d3.graphics.VertexPositionNTBTexture");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(56,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector3",5),new $Ad(36,"vector3",4),new $Ad(48,"vector2",2)]);}]),$d;}(),$Nd=function(){function $d($d,$t,$l,$k,$W,$i,$A,$B){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$d,this._normal=$t,this._textureCoordinate0=$k,this._textureCoordinate1=$W,this._tangent=$i,$l=$l,this._blendIndex=$A,this._blendWeight=$B;}$c($d,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"tangent",function(){return this._tangent;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(0,$t,"textureCoordinate1",function(){return this._textureCoordinate1;}),$Y(0,$t,"blendIndex",function(){return this._blendIndex;}),$Y(0,$t,"blendWeight",function(){return this._blendWeight;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(96,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector3",5),new $Ad(36,"vector3",4),new $Ad(48,"vector2",2),new $Ad(56,"vector2",15),new $Ad(64,"vector4",7),new $Ad(80,"vector4",6)]);}]),$d;}(),$ud=function(){function $d($d,$t,$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$d,this._normal=$t,this._textureCoordinate=$l;}$c($d,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"textureCoordinate",function(){return this._textureCoordinate;}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(88,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector3",5),new $Ad(36,"vector3",4),new $Ad(48,"vector2",2),new $Ad(56,"vector4",7),new $Ad(72,"vector4",6)]);}]),$d;}(),$hd=(function(){function $d($d,$t,$l,$k){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$d,this._normal=$t,this._textureCoord0=$l,this._textureCoord1=$k;}$c($d,"laya.d3.graphics.VertexPositionTerrain");var $t=$d.prototype;$R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"normal",function(){return this._normal;}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoord0",function(){return this._textureCoord0;}),$Y(0,$t,"textureCoord1",function(){return this._textureCoord1;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(40,[new $Ad(0,"vector3",0),new $Ad(12,"vector3",3),new $Ad(24,"vector2",2),new $Ad(32,"vector2",15)]);}]);}(),function(){function $d($d,$t){this._position=null,this._textureCoordinate0=null,this._position=$d,this._textureCoordinate0=$t;}$c($d,"laya.d3.graphics.VertexPositionTexture0");var $t=$d.prototype;return $R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"position",function(){return this._position;}),$Y(0,$t,"textureCoordinate0",function(){return this._textureCoordinate0;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(20,[new $Ad(0,"vector3",0),new $Ad(12,"vector2",2)]);}]),$d;}()),$sd=(function(){function $d($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f,$J,$c){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$d,this._positionStartLifeTime=$t,this._velocity=$l,this._startColor=$k,this._startSize=$W,this._startRotation0=$i,this._startRotation1=$A,this._startRotation2=$B,this._startLifeTime=$o,this._time=$I,this._startSpeed=$b,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$c;}$c($d,"laya.d3.graphics.VertexShurikenParticleBillboard");var $t=$d.prototype;$R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$Y(0,$t,"random1",function(){return this._randoms1;}),$Y(0,$t,"startRotation2",function(){return this._startRotation2;}),$Y(0,$t,"positionStartLifeTime",function(){return this._positionStartLifeTime;}),$Y(0,$t,"velocity",function(){return this._velocity;}),$Y(0,$t,"random0",function(){return this._randoms0;}),$Y(0,$t,"startSize",function(){return this._startSize;}),$Y(0,$t,"startColor",function(){return this._startColor;}),$Y(0,$t,"startRotation0",function(){return this._startRotation0;}),$Y(0,$t,"startRotation1",function(){return this._startRotation1;}),$Y(0,$t,"startLifeTime",function(){return this._startLifeTime;}),$Y(0,$t,"time",function(){return this._time;}),$Y(0,$t,"startSpeed",function(){return this._startSpeed;}),$Y(0,$t,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(152,[new $Ad(0,"vector4",17),new $Ad(16,"vector4",30),new $Ad(32,"vector4",32),new $Ad(48,"vector4",19),new $Ad(64,"vector3",20),new $Ad(76,"vector3",22),new $Ad(88,"single",31),new $Ad(92,"vector4",34),new $Ad(108,"vector4",35),new $Ad(124,"vector3",36),new $Ad(136,"vector4",37)]);}]);}(),function(){function $d($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f,$J,$c){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$d,this._positionStartLifeTime=$t,this._velocity=$l,this._startColor=$k,this._startSize=$W,this._startRotation0=$i,this._startRotation1=$A,this._startRotation2=$B,this._startLifeTime=$o,this._time=$I,this._startSpeed=$b,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$c;}$c($d,"laya.d3.graphics.VertexShurikenParticleMesh");var $t=$d.prototype;$R.imps($t,{"laya.d3.graphics.IVertex":!0}),$Y(0,$t,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$Y(0,$t,"velocity",function(){return this._velocity;}),$Y(0,$t,"position",function(){return this._positionStartLifeTime;}),$Y(0,$t,"random0",function(){return this._randoms0;}),$Y(0,$t,"startSize",function(){return this._startSize;}),$Y(0,$t,"startColor",function(){return this._startColor;}),$Y(0,$t,"startRotation0",function(){return this._startRotation0;}),$Y(0,$t,"startRotation1",function(){return this._startRotation1;}),$Y(0,$t,"random1",function(){return this._randoms1;}),$Y(0,$t,"startRotation2",function(){return this._startRotation2;}),$Y(0,$t,"startLifeTime",function(){return this._startLifeTime;}),$Y(0,$t,"time",function(){return this._time;}),$Y(0,$t,"startSpeed",function(){return this._startSpeed;}),$Y(0,$t,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$Y(0,$t,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$Y(1,$d,"vertexDeclaration",function(){return $d._vertexDeclaration;}),$f($d,["_vertexDeclaration",function(){return this._vertexDeclaration=new $id(172,[new $Ad(0,"vector3",0),new $Ad(12,"vector4",1),new $Ad(28,"vector2",2),new $Ad(36,"vector4",30),new $Ad(52,"vector4",32),new $Ad(68,"vector4",19),new $Ad(84,"vector3",20),new $Ad(96,"vector3",22),new $Ad(108,"single",31),new $Ad(112,"vector4",34),new $Ad(128,"vector4",35),new $Ad(144,"vector3",36),new $Ad(156,"vector4",37)]);}]);}(),function(){function $g($d,$t,$l,$k,$W,$i){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$l,this._materials=$k,this._subMeshes=$W,this._materialMap=$i,this._version=$t,this._onLoaded($d);}$c($g,"laya.d3.loaders.LoadModelV01");var $d=$g.prototype;return $d._onLoaded=function($d){this._readData=$d,this.READ_BLOCK();for(var $t=0;$t<this._BLOCK.count;$t++){var $l=this._readData.getUint16(),$k=this._strings[$l],$W=this["READ_"+$k];if(null==$W)throw new Error("model file err,no this function:"+$l+" "+$k);if(!$W.call(this))break;}return this._mesh;},$d.onError=function(){},$d._readString=function(){return this._strings[this._readData.getUint16()];},$d.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0;},$d.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0;},$d.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $d=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $t=0;$t<this._STRINGS.size;$t++)this._strings[$t]=this._readData.readUTFString();return this._readData.pos=$d,!0;},$d.READ_MATERIAL=function(){var $d=this._readData.getUint16(),$t=(this._readString(),this._readString());return this._materials[$d]="null"!==$t?$z.getRes(this._materialMap[$t]):new $Tt(),!0;},$d.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $d,$t=this._readData.__getBuffer(),$l=0,$k=this._readData.getUint32(),$W=this._readData.getUint32(),$i=(new Float32Array($t.slice($k+this._DATA.offset,$k+this._DATA.offset+$W)),this._readData.getUint32()),$A=this._readData.getUint32(),$B=new Float32Array($t.slice($i+this._DATA.offset,$i+this._DATA.offset+$A));for(this.mesh._inverseBindPoses=[],$l=0,$d=$B.length;$l<$d;$l+=16){var $o=new $dt($B[$l+0],$B[$l+1],$B[$l+2],$B[$l+3],$B[$l+4],$B[$l+5],$B[$l+6],$B[$l+7],$B[$l+8],$B[$l+9],$B[$l+10],$B[$l+11],$B[$l+12],$B[$l+13],$B[$l+14],$B[$l+15]);this.mesh._inverseBindPoses.push($o);}break;default:throw new Error("LoadModel:unknown version.");}return!0;},$d.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $d=this._readString();this._shaderAttributes=$d.match($g._attrReg);var $t=this._readData.getUint32(),$l=this._readData.getUint32(),$k=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$W=this._readData.getUint32(),$i=this._readData.getUint32(),$A=this._readData.getUint32(),$B=this._readData.__getBuffer(),$o=new $It(this._mesh),$I=this._getVertexDeclaration(),$b=$Vt.create($I,$W/$I.vertexStride,35044,!0),$f=$k+this._DATA.offset,$J=$B.slice($f,$f+$W);$b.setData(new Float32Array($J));for(var $c=($o._vertexBuffer=$b).vertexDeclaration.getVertexElements(),$Y=0;$Y<$c.length;$Y++)$o._bufferUsage[$c[$Y].elementUsage]=$b;var $w=$yt.create("ushort",$l/2,35044,!0),$D=$t+this._DATA.offset,$z=$B.slice($D,$D+$l);$w.setData(new Uint16Array($z)),$o._indexBuffer=$w;var $e=$B.slice($i+this._DATA.offset,$i+this._DATA.offset+$A);return $o._boneIndicesList[0]=new Uint8Array($e),this._subMeshes.push($o),!0;},$d.READ_DATAAREA=function(){return!1;},$d._getVertexDeclaration=function(){for(var $d,$t=!1,$l=!1,$k=!1,$W=!1,$i=!1,$A=!1,$B=!1,$o=!1,$I=!1,$b=0;$b<this._shaderAttributes.length;$b+=8)switch(this._shaderAttributes[$b]){case"POSITION":$t=!0;break;case"NORMAL":$l=!0;break;case"COLOR":$k=!0;break;case"UV":$W=!0;break;case"UV1":$i=!0;break;case"BLENDWEIGHT":$B=!0;break;case"BLENDINDICES":$o=!0;break;case"TANGENT":$A=!0;break;case"BINORMAL":$I=!0;}return $t&&$l&&$k&&$W&&$i&&$B&&$o&&$A?$d=$gd.vertexDeclaration:$t&&$l&&$k&&$W&&$i&&$B&&$o?$d=$zd.vertexDeclaration:$t&&$l&&$W&&$i&&$B&&$o&&$A?$d=$Kd.vertexDeclaration:$t&&$l&&$W&&$i&&$B&&$o?$d=$jd.vertexDeclaration:$t&&$l&&$k&&$W&&$B&&$o&&$A?$d=$Ld.vertexDeclaration:$t&&$l&&$k&&$W&&$B&&$o?$d=$Gd.vertexDeclaration:$t&&$l&&$A&&$I&&$W&&$B&&$o?$d=$ud.vertexDeclaration:$t&&$l&&$W&&$B&&$o&&$A?$d=$Vd.vertexDeclaration:$t&&$l&&$W&&$B&&$o?$d=$Qd.vertexDeclaration:$t&&$l&&$k&&$B&&$o&&$A?$d=$Jd.vertexDeclaration:$t&&$l&&$k&&$B&&$o?$d=$bd.vertexDeclaration:$t&&$l&&$k&&$W&&$i&&$A?$d=$Rd.vertexDeclaration:$t&&$l&&$k&&$W&&$i?$d=$Dd.vertexDeclaration:$t&&$l&&$W&&$i&&$A?$d=$nd.vertexDeclaration:$t&&$l&&$W&&$i?$d=$Sd.vertexDeclaration:$t&&$l&&$k&&$W&&$A?$d=$pd.vertexDeclaration:$t&&$l&&$W&&$A&&$I?$d=$Ed.vertexDeclaration:$t&&$l&&$k&&$W?$d=$wd.vertexDeclaration:$t&&$l&&$W&&$A?$d=$Ud.vertexDeclaration:$t&&$l&&$W?$d=$rd.vertexDeclaration:$t&&$l&&$k&&$A?$d=$Yd.vertexDeclaration:$t&&$l&&$k&&($d=$Id.vertexDeclaration),$d;},$Y(0,$d,"mesh",function(){return this._mesh;}),$g._attrReg=new RegExp("(\\w+)|([:,;])","g"),$g;}()),$Pd=function(){function $q(){}return $c($q,"laya.d3.loaders.LoadModelV02"),$q.parse=function($d,$t,$l,$k,$W,$i){$q._mesh=$l,$q._materials=$k,$q._subMeshes=$W,$q._materialMap=$i,$q._version=$t,$q._readData=$d,$q.READ_DATA(),$q.READ_BLOCK(),$q.READ_STRINGS();for(var $A=0,$B=$q._BLOCK.count;$A<$B;$A++){$q._readData.pos=$q._BLOCK.blockStarts[$A];var $o=$q._readData.getUint16(),$I=$q._strings[$o],$b=$q["READ_"+$I];if(null==$b)throw new Error("model file err,no this function:"+$o+" "+$I);$b.call();}$q._strings.length=0,$q._readData=null,$q._version=null,$q._mesh=null,$q._materials=null,$q._subMeshes=null,$q._materialMap=null;},$q._readString=function(){return $q._strings[$q._readData.getUint16()];},$q.READ_DATA=function(){$q._DATA.offset=$q._readData.getUint32(),$q._DATA.size=$q._readData.getUint32();},$q.READ_BLOCK=function(){for(var $d=$q._BLOCK.count=$q._readData.getUint16(),$t=$q._BLOCK.blockStarts=[],$l=$q._BLOCK.blockLengths=[],$k=0;$k<$d;$k++)$t.push($q._readData.getUint32()),$l.push($q._readData.getUint32());},$q.READ_STRINGS=function(){var $d=$q._readData.getUint32(),$t=$q._readData.getUint16(),$l=$q._readData.pos;$q._readData.pos=$d+$q._DATA.offset;for(var $k=0;$k<$t;$k++)$q._strings[$k]=$q._readData.readUTFString();$q._readData.pos=$l;},$q.READ_MATERIAL=function(){$q._readString(),$q._readString();var $d=$q._readString();return""!==$d&&$q._materials.push($z.getRes($q._materialMap[$d])),!0;},$q.READ_MESH=function(){$q._readString();var $d,$t=$q._readData.__getBuffer(),$l=0,$k=$q._readData.getInt16(),$W=$q._DATA.offset;for($l=0;$l<$k;$l++){var $i=$W+$q._readData.getUint32(),$A=$q._readData.getUint32(),$B=new Float32Array($t.slice($i,$i+$A)),$o=$q._readString().match($q._attrReg),$I=$q._getVertexDeclaration($o),$b=$Vt.create($I,4*$B.length/$I.vertexStride,35044,!0);$b.setData($B),$q._mesh._vertexBuffers.push($b);}var $f=$W+$q._readData.getUint32(),$J=$q._readData.getUint32(),$c=new Uint16Array($t.slice($f,$f+$J)),$Y=$yt.create("ushort",$J/2,35044,!0);$Y.setData($c),$q._mesh._indexBuffer=$Y;var $w=$q._mesh._boneNames=[],$D=$q._readData.getUint16();for($w.length=$D,$l=0;$l<$D;$l++)$w[$l]=$q._strings[$q._readData.getUint16()];var $z=$q._readData.getUint32(),$e=$q._readData.getUint32(),$g=(new Float32Array($t.slice($W+$z,$W+$z+$e)),$q._readData.getUint32()),$H=$q._readData.getUint32(),$R=new Float32Array($t.slice($W+$g,$W+$g+$H));for($q._mesh._inverseBindPoses=[],$l=0,$d=$R.length;$l<$d;$l+=16){var $G=new $dt($R[$l+0],$R[$l+1],$R[$l+2],$R[$l+3],$R[$l+4],$R[$l+5],$R[$l+6],$R[$l+7],$R[$l+8],$R[$l+9],$R[$l+10],$R[$l+11],$R[$l+12],$R[$l+13],$R[$l+14],$R[$l+15]);$q._mesh._inverseBindPoses.push($G);}return $q._mesh._skinnedDatas=new Float32Array(16*$R.length),!0;},$q.READ_SUBMESH=function(){var $d=$q._readData.__getBuffer(),$t=new $It($q._mesh),$l=$q._readData.getInt16(),$k=$q._readData.getUint32(),$W=$q._readData.getUint32();$t._vertexBuffer=$q._mesh._vertexBuffers[$l],$t._vertexStart=$k,$t._vertexCount=$W;var $i=$q._readData.getUint32(),$A=$q._readData.getUint32(),$B=$q._mesh._indexBuffer;$t._indexBuffer=$B,$t._indexStart=$i,$t._indexCount=$A,$t._indices=new Uint16Array($B.getData().buffer,2*$i,$A);var $o=$q._DATA.offset,$I=$t._subIndexBufferStart,$b=$t._subIndexBufferCount,$f=$t._boneIndicesList,$J=$q._readData.getUint16();$I.length=$J,$b.length=$J,$f.length=$J;for(var $c=0;$c<$J;$c++){$I[$c]=$q._readData.getUint32(),$b[$c]=$q._readData.getUint32();var $Y=$q._readData.getUint32(),$w=$q._readData.getUint32();$t._boneIndicesList[$c]=new Uint8Array($d.slice($o+$Y,$o+$Y+$w));}return $q._subMeshes.push($t),!0;},$q._getVertexDeclaration=function($d){for(var $t,$l=!1,$k=!1,$W=!1,$i=!1,$A=!1,$B=!1,$o=!1,$I=!1,$b=!1,$f=0;$f<$d.length;$f++)switch($d[$f]){case"POSITION":$l=!0;break;case"NORMAL":$k=!0;break;case"COLOR":$W=!0;break;case"UV":$i=!0;break;case"UV1":$A=!0;break;case"BLENDWEIGHT":$o=!0;break;case"BLENDINDICES":$I=!0;break;case"TANGENT":$B=!0;break;case"BINORMAL":$b=!0;}return $l&&$k&&$W&&$i&&$A&&$o&&$I&&$B?$t=$gd.vertexDeclaration:$l&&$k&&$W&&$i&&$A&&$o&&$I?$t=$zd.vertexDeclaration:$l&&$k&&$i&&$A&&$o&&$I&&$B?$t=$Kd.vertexDeclaration:$l&&$k&&$i&&$A&&$o&&$I?$t=$jd.vertexDeclaration:$l&&$k&&$W&&$i&&$o&&$I&&$B?$t=$Ld.vertexDeclaration:$l&&$k&&$W&&$i&&$o&&$I?$t=$Gd.vertexDeclaration:$l&&$k&&$i&&$o&&$I&&$B?$t=$Vd.vertexDeclaration:$l&&$k&&$i&&$o&&$I?$t=$Qd.vertexDeclaration:$l&&$k&&$W&&$o&&$I&&$B?$t=$Jd.vertexDeclaration:$l&&$k&&$W&&$o&&$I?$t=$bd.vertexDeclaration:$l&&$k&&$W&&$i&&$A&&$B?$t=$Rd.vertexDeclaration:$l&&$k&&$W&&$i&&$A?$t=$Dd.vertexDeclaration:$l&&$k&&$i&&$A&&$B?$t=$nd.vertexDeclaration:$l&&$k&&$i&&$A?$t=$Sd.vertexDeclaration:$l&&$k&&$W&&$i&&$B?$t=$pd.vertexDeclaration:$l&&$k&&$i&&$B&&$b?$t=$Ed.vertexDeclaration:$l&&$k&&$W&&$i?$t=$wd.vertexDeclaration:$l&&$k&&$i&&$B?$t=$Ud.vertexDeclaration:$l&&$k&&$i?$t=$rd.vertexDeclaration:$l&&$k&&$W&&$B?$t=$Yd.vertexDeclaration:$l&&$k&&$W&&($t=$Id.vertexDeclaration),$t;},$q._attrReg=new RegExp("(\\w+)|([:,;])","g"),$q._strings=[],$q._readData=null,$q._version=null,$q._mesh=null,$q._materials=null,$q._subMeshes=null,$q._materialMap=null,$f($q,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$q;}(),$Xd=function(){function $G(){}return $c($G,"laya.d3.loaders.LoadModelV03"),$G.parse=function($d,$t,$l,$k,$W){$G._mesh=$l,$G._subMeshes=$k,$G._materialMap=$W,$G._version=$t,$G._readData=$d,$G.READ_DATA(),$G.READ_BLOCK(),$G.READ_STRINGS();for(var $i=0,$A=$G._BLOCK.count;$i<$A;$i++){$G._readData.pos=$G._BLOCK.blockStarts[$i];var $B=$G._readData.getUint16(),$o=$G._strings[$B],$I=$G["READ_"+$o];if(null==$I)throw new Error("model file err,no this function:"+$B+" "+$o);$I.call();}$G._strings.length=0,$G._readData=null,$G._version=null,$G._mesh=null,$G._subMeshes=null,$G._materialMap=null;},$G._readString=function(){return $G._strings[$G._readData.getUint16()];},$G.READ_DATA=function(){$G._DATA.offset=$G._readData.getUint32(),$G._DATA.size=$G._readData.getUint32();},$G.READ_BLOCK=function(){for(var $d=$G._BLOCK.count=$G._readData.getUint16(),$t=$G._BLOCK.blockStarts=[],$l=$G._BLOCK.blockLengths=[],$k=0;$k<$d;$k++)$t.push($G._readData.getUint32()),$l.push($G._readData.getUint32());},$G.READ_STRINGS=function(){var $d=$G._readData.getUint32(),$t=$G._readData.getUint16(),$l=$G._readData.pos;$G._readData.pos=$d+$G._DATA.offset;for(var $k=0;$k<$t;$k++)$G._strings[$k]=$G._readData.readUTFString();$G._readData.pos=$l;},$G.READ_MESH=function(){var $d,$t=$G._readString(),$l=$G._readData.__getBuffer(),$k=0,$W=$G._readData.getInt16(),$i=$G._DATA.offset;for($k=0;$k<$W;$k++){var $A,$B=$i+$G._readData.getUint32(),$o=$G._readData.getUint32(),$I=new Float32Array($l.slice($B,$B+$o)),$b=$G._readString();switch($G._version){case"LAYAMODEL:03":$A=$G._vertexDeclarationMap_Discard[$b];break;case"LAYAMODEL:0301":$A=$G._vertexDeclarationMap[$b];break;default:throw new Error("LoadModelV03: unknown version.");}if(!$A)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$G._version+"  bufferAttribute="+$b+"  name="+$t+"  url="+($G._mesh?$G._mesh.url:"null"));var $f=$Vt.create($A,4*$I.length/$A.vertexStride,35044,!0,$G._mesh._url+"_"+$k);$f.setData($I),$G._mesh._vertexBuffers.push($f);}var $J=$i+$G._readData.getUint32(),$c=$G._readData.getUint32(),$Y=new Uint16Array($l.slice($J,$J+$c)),$w=$yt.create("ushort",$c/2,35044,!0,$G._mesh._url);$w.setData($Y),$G._mesh._indexBuffer=$w;var $D=$G._mesh._boneNames=[],$z=$G._readData.getUint16();for($D.length=$z,$k=0;$k<$z;$k++)$D[$k]=$G._strings[$G._readData.getUint16()];$G._readData.pos+=8;var $e=$G._readData.getUint32(),$g=$G._readData.getUint32(),$H=new Float32Array($l.slice($i+$e,$i+$e+$g));for($G._mesh._inverseBindPoses=[],$k=0,$d=$H.length;$k<$d;$k+=16){var $R=new $dt($H[$k+0],$H[$k+1],$H[$k+2],$H[$k+3],$H[$k+4],$H[$k+5],$H[$k+6],$H[$k+7],$H[$k+8],$H[$k+9],$H[$k+10],$H[$k+11],$H[$k+12],$H[$k+13],$H[$k+14],$H[$k+15]);$G._mesh._inverseBindPoses.push($R);}return $G._mesh._skinnedDatas=new Float32Array(16*$H.length),!0;},$G.READ_SUBMESH=function(){var $d=$G._readData.__getBuffer(),$t=new $It($G._mesh),$l=$G._readData.getInt16(),$k=$G._readData.getUint32(),$W=$G._readData.getUint32();$t._vertexBuffer=$G._mesh._vertexBuffers[$l],$t._vertexStart=$k,$t._vertexCount=$W;var $i=$G._readData.getUint32(),$A=$G._readData.getUint32(),$B=$G._mesh._indexBuffer;$t._indexBuffer=$B,$t._indexStart=$i,$t._indexCount=$A,$t._indices=new Uint16Array($B.getData().buffer,2*$i,$A);var $o=$G._DATA.offset,$I=$t._subIndexBufferStart,$b=$t._subIndexBufferCount,$f=$t._boneIndicesList,$J=$G._readData.getUint16();$I.length=$J,$b.length=$J,$f.length=$J;for(var $c=0;$c<$J;$c++){$I[$c]=$G._readData.getUint32(),$b[$c]=$G._readData.getUint32();var $Y=$G._readData.getUint32(),$w=$G._readData.getUint32();$f[$c]=new Uint8Array($d.slice($o+$Y,$o+$Y+$w));}return $G._subMeshes.push($t),!0;},$G._strings=[],$G._readData=null,$G._version=null,$G._mesh=null,$G._subMeshes=null,$G._materialMap=null,$f($G,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$gd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$zd.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$Nd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Kd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$jd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Ld.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Gd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Vd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Qd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$Jd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$bd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$Rd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$Dd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$nd.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Sd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$pd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$wd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Ud.vertexDeclaration,"POSITION,NORMAL,UV":$rd.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$Yd.vertexDeclaration,"POSITION,NORMAL,COLOR":$Id.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Td.vertexDeclaration,"POSITION,NORMAL":$od.vertexDeclaration,"POSITION,UV":$hd.vertexDeclaration,POSITION:$Bd.vertexDeclaration};},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$zd.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$Nd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Cd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$jd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$qd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Gd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$yd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Qd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$fd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$bd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$Hd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$Dd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$xd.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Sd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$$d.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$wd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Zd.vertexDeclaration,"POSITION,NORMAL,UV":$rd.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$cd.vertexDeclaration,"POSITION,NORMAL,COLOR":$Id.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Md.vertexDeclaration,"POSITION,NORMAL":$od.vertexDeclaration,"POSITION,UV":$hd.vertexDeclaration,POSITION:$Bd.vertexDeclaration};},"_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$G;}(),$md=function(){function $B(){}return $c($B,"laya.d3.loaders.MeshReader"),$B.read=function($d,$t,$l,$k,$W){var $i=new $G($d);$i.pos=0;var $A=$i.readUTFString();switch($A){case"LAYAMODEL:01":case"LAYASKINANI:01":$B._readVersion01($i,$A,$t,$l,$k,$W);break;case"LAYAMODEL:02":$Pd.parse($i,$A,$t,$l,$k,$W);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$Xd.parse($i,$A,$t,$k,$W);break;default:throw new Error("MeshReader: unknown mesh version.");}$t._setSubMeshes($k);},$B._readVersion01=function($d,$t,$l,$k,$W,$i){new $sd($d,$t,$l,$k,$W,$i);},$B;}(),$Od=function(){function $d($d,$t){this.min=null,this.max=null,this.min=$d,this.max=$t;}$c($d,"laya.d3.math.BoundBox");var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.IClone":!0}),$t.getCorners=function($d){$d.length=8;var $t=this.min.elements,$l=this.max.elements,$k=$t[0],$W=$t[1],$i=$t[2],$A=$l[0],$B=$l[1],$o=$l[2];$d[0]=new $At($k,$B,$o),$d[1]=new $At($A,$B,$o),$d[2]=new $At($A,$W,$o),$d[3]=new $At($k,$W,$o),$d[4]=new $At($k,$B,$i),$d[5]=new $At($A,$B,$i),$d[6]=new $At($A,$W,$i),$d[7]=new $At($k,$W,$i);},$t.toDefault=function(){this.min.toDefault(),this.max.toDefault();},$t.cloneTo=function($d){var $t=$d;this.min.cloneTo($t.min),this.max.cloneTo($t.max);},$t.clone=function(){var $d=new this.constructor(new $At(),new $At());return this.cloneTo($d),$d;},$d.createfromPoints=function($d,$t){if(null==$d)throw new Error("points");var $l=$t.min,$k=$t.max,$W=$l.elements;$W[0]=Number.MAX_VALUE,$W[1]=Number.MAX_VALUE,$W[2]=Number.MAX_VALUE;var $i=$k.elements;$i[0]=-Number.MAX_VALUE,$i[1]=-Number.MAX_VALUE,$i[2]=-Number.MAX_VALUE;for(var $A=0,$B=$d.length;$A<$B;++$A)$At.min($l,$d[$A],$l),$At.max($k,$d[$A],$k);},$d.merge=function($d,$t,$l){$At.min($d.min,$t.min,$l.min),$At.max($d.max,$t.max,$l.max);},$d;}(),$Fd=function(){function $I($d){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$d,this._near=new $tt(new $At()),this._far=new $tt(new $At()),this._left=new $tt(new $At()),this._right=new $tt(new $At()),this._top=new $tt(new $At()),this._bottom=new $tt(new $At()),$I._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}$c($I,"laya.d3.math.BoundFrustum");var $d=$I.prototype;return $d.equalsBoundFrustum=function($d){return this._matrix.equalsOtherMatrix($d.matrix);},$d.equalsObj=function($d){if($d instanceof laya.d3.math.BoundFrustum){var $t=$d;return this.equalsBoundFrustum($t);}return!1;},$d.getPlane=function($d){switch($d){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null;}},$d.getCorners=function($d){$I._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($d[0]),$I._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($d[1]),$I._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($d[2]),$I._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($d[3]),$I._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($d[4]),$I._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($d[5]),$I._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($d[6]),$I._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($d[7]);},$d.containsPoint=function($d){for(var $t=$tt.PlaneIntersectionType_Front,$l=$tt.PlaneIntersectionType_Front,$k=0;$k<6;$k++){switch($k){case 0:$l=Collision.intersectsPlaneAndPoint(this._near,$d);break;case 1:$l=Collision.intersectsPlaneAndPoint(this._far,$d);break;case 2:$l=Collision.intersectsPlaneAndPoint(this._left,$d);break;case 3:$l=Collision.intersectsPlaneAndPoint(this._right,$d);break;case 4:$l=Collision.intersectsPlaneAndPoint(this._top,$d);break;case 5:$l=Collision.intersectsPlaneAndPoint(this._bottom,$d);}switch($l){case $tt.PlaneIntersectionType_Back:return 0;case $tt.PlaneIntersectionType_Intersecting:$t=$tt.PlaneIntersectionType_Intersecting;}}switch($t){case $tt.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$d.containsBoundBox=function($d){for(var $t,$l=$I._tempV30,$k=$I._tempV31,$W=1,$i=0;$i<6;$i++){if($t=this.getPlane($i),this._getBoxToPlanePVertexNVertex($d,$t.normal,$l,$k),Collision.intersectsPlaneAndPoint($t,$l)===$tt.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($t,$k)===$tt.PlaneIntersectionType_Back&&($W=2);}return $W;},$d.containsBoundSphere=function($d){for(var $t=$tt.PlaneIntersectionType_Front,$l=$tt.PlaneIntersectionType_Front,$k=0;$k<6;$k++){switch($k){case 0:$l=Collision.intersectsPlaneAndSphere(this._near,$d);break;case 1:$l=Collision.intersectsPlaneAndSphere(this._far,$d);break;case 2:$l=Collision.intersectsPlaneAndSphere(this._left,$d);break;case 3:$l=Collision.intersectsPlaneAndSphere(this._right,$d);break;case 4:$l=Collision.intersectsPlaneAndSphere(this._top,$d);break;case 5:$l=Collision.intersectsPlaneAndSphere(this._bottom,$d);}switch($l){case $tt.PlaneIntersectionType_Back:return 0;case $tt.PlaneIntersectionType_Intersecting:$t=$tt.PlaneIntersectionType_Intersecting;}}switch($t){case $tt.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$d._getBoxToPlanePVertexNVertex=function($d,$t,$l,$k){var $W=$d.min,$i=$W.elements,$A=$d.max,$B=$A.elements,$o=$t.elements,$I=$o[0],$b=$o[1],$f=$o[2];$W.cloneTo($l);var $J=$l.elements;0<=$I&&($J[0]=$B[0]),0<=$b&&($J[1]=$B[1]),0<=$f&&($J[2]=$B[2]),$A.cloneTo($k);var $c=$k.elements;0<=$I&&($c[0]=$i[0]),0<=$b&&($c[1]=$i[1]),0<=$f&&($c[2]=$i[2]);},$Y(0,$d,"top",function(){return this._top;}),$Y(0,$d,"matrix",function(){return this._matrix;},function($d){this._matrix=$d,$I._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}),$Y(0,$d,"near",function(){return this._near;}),$Y(0,$d,"far",function(){return this._far;}),$Y(0,$d,"left",function(){return this._left;}),$Y(0,$d,"right",function(){return this._right;}),$Y(0,$d,"bottom",function(){return this._bottom;}),$I._getPlanesFromMatrix=function($d,$t,$l,$k,$W,$i,$A){var $B=$d.elements,$o=$B[0],$I=$B[1],$b=$B[2],$f=$B[3],$J=$B[4],$c=$B[5],$Y=$B[6],$w=$B[7],$D=$B[8],$z=$B[9],$e=$B[10],$g=$B[11],$H=$B[12],$R=$B[13],$G=$B[14],$q=$B[15],$L=$t.normal.elements;$L[0]=$f+$b,$L[1]=$w+$Y,$L[2]=$g+$e,$t.distance=$q+$G,$t.normalize();var $$=$l.normal.elements;$$[0]=$f-$b,$$[1]=$w-$Y,$$[2]=$g-$e,$l.distance=$q-$G,$l.normalize();var $p=$k.normal.elements;$p[0]=$f+$o,$p[1]=$w+$J,$p[2]=$g+$D,$k.distance=$q+$H,$k.normalize();var $M=$W.normal.elements;$M[0]=$f-$o,$M[1]=$w-$J,$M[2]=$g-$D,$W.distance=$q-$H,$W.normalize();var $T=$i.normal.elements;$T[0]=$f-$I,$T[1]=$w-$c,$T[2]=$g-$z,$i.distance=$q-$R,$i.normalize();var $r=$A.normal.elements;$r[0]=$f+$I,$r[1]=$w+$c,$r[2]=$g+$z,$A.distance=$q+$R,$A.normalize();},$I._get3PlaneInterPoint=function($d,$t,$l){var $k=$d.normal,$W=$t.normal,$i=$l.normal;$At.cross($W,$i,$I._tempV30),$At.cross($i,$k,$I._tempV31),$At.cross($k,$W,$I._tempV32);var $A=$At.dot($k,$I._tempV30),$B=$At.dot($W,$I._tempV31),$o=$At.dot($i,$I._tempV32);return $At.scale($I._tempV30,-$d.distance/$A,$I._tempV33),$At.scale($I._tempV31,-$t.distance/$B,$I._tempV34),$At.scale($I._tempV32,-$l.distance/$o,$I._tempV35),$At.add($I._tempV33,$I._tempV34,$I._tempV36),$At.add($I._tempV35,$I._tempV36,$I._tempV37),$I._tempV37;},$f($I,["_tempV30",function(){return this._tempV30=new $At();},"_tempV31",function(){return this._tempV31=new $At();},"_tempV32",function(){return this._tempV32=new $At();},"_tempV33",function(){return this._tempV33=new $At();},"_tempV34",function(){return this._tempV34=new $At();},"_tempV35",function(){return this._tempV35=new $At();},"_tempV36",function(){return this._tempV36=new $At();},"_tempV37",function(){return this._tempV37=new $At();}]),$I;}(),$ad=function(){function $b($d,$t){this.center=null,this.radius=NaN,this.center=$d,this.radius=$t;}$c($b,"laya.d3.math.BoundSphere");var $d=$b.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.toDefault=function(){this.center.toDefault(),this.radius=0;},$d.intersectsRayDistance=function($d){return Collision.intersectsRayAndSphereRD($d,this);},$d.intersectsRayPoint=function($d,$t){return Collision.intersectsRayAndSphereRP($d,this,$t);},$d.cloneTo=function($d){var $t=$d;this.center.cloneTo($t.center),$t.radius=this.radius;},$d.clone=function(){var $d=new this.constructor(new $At(),new $At());return this.cloneTo($d),$d;},$b.createFromSubPoints=function($d,$t,$l,$k){if(null==$d)throw new Error("points");if($t<0||$t>=$d.length)throw new Error("start"+$t+"Must be in the range [0, "+($d.length-1)+"]");if($l<0||$t+$l>$d.length)throw new Error("count"+$l+"Must be in the range <= "+$d.length+"}");var $W=$t+$l,$i=$b._tempVector3;$i.elements[0]=0,$i.elements[1]=0,$i.elements[2]=0;for(var $A=$t;$A<$W;++$A)$At.add($d[$A],$i,$i);var $B=$k.center;$At.scale($i,1/$l,$B);var $o=0;for($A=$t;$A<$W;++$A){var $I=$At.distanceSquared($B,$d[$A]);$o<$I&&($o=$I);}$k.radius=Math.sqrt($o);},$b.createfromPoints=function($d,$t){if(null==$d)throw new Error("points");$b.createFromSubPoints($d,0,$d.length,$t);},$f($b,["_tempVector3",function(){return this._tempVector3=new $At();}]),$b;}(),$_d=(function(){function $d(){}$c($d,"laya.d3.math.ContainmentType"),$d.Disjoint=0,$d.Contains=1,$d.Intersects=2;}(),function(){function $l(){}return $c($l,"laya.d3.math.MathUtils3D"),$l.isZero=function($d){return Math.abs($d)<$l.zeroTolerance;},$l.nearEqual=function($d,$t){return!!$l.isZero($d-$t);},$l.fastInvSqrt=function($d){return $l.isZero($d)?$d:1/Math.sqrt($d);},$f($l,["zeroTolerance",function(){return this.zeroTolerance=1e-6;},"MaxValue",function(){return this.MaxValue=340282347e30;},"MinValue",function(){return this.MinValue=-340282347e30;}]),$l;}()),$vd=function(){function $o(){var $d=this.elements=new Float32Array(9);$d[0]=1,$d[1]=0,$d[2]=0,$d[3]=0,$d[4]=1,$d[5]=0,$d[6]=0,$d[7]=0,$d[8]=1;}$c($o,"laya.d3.math.Matrix3x3");var $d=$o.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.determinant=function(){var $d=this.elements,$t=$d[0],$l=$d[1],$k=$d[2],$W=$d[3],$i=$d[4],$A=$d[5],$B=$d[6],$o=$d[7],$I=$d[8];return $t*($I*$i-$A*$o)+$l*(-$I*$W+$A*$B)+$k*($o*$W-$i*$B);},$d.translate=function($d,$t){var $l=$t.elements,$k=this.elements,$W=$d.elements,$i=$k[0],$A=$k[1],$B=$k[2],$o=$k[3],$I=$k[4],$b=$k[5],$f=$k[6],$J=$k[7],$c=$k[8],$Y=$W[0],$w=$W[1];$l[0]=$i,$l[1]=$A,$l[2]=$B,$l[3]=$o,$l[4]=$I,$l[5]=$b,$l[6]=$Y*$i+$w*$o+$f,$l[7]=$Y*$A+$w*$I+$J,$l[8]=$Y*$B+$w*$b+$c;},$d.rotate=function($d,$t){var $l=$t.elements,$k=this.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=$k[4],$I=$k[5],$b=$k[6],$f=$k[7],$J=$k[8],$c=Math.sin($d),$Y=Math.cos($d);$l[0]=$Y*$W+$c*$B,$l[1]=$Y*$i+$c*$o,$l[2]=$Y*$A+$c*$I,$l[3]=$Y*$B-$c*$W,$l[4]=$Y*$o-$c*$i,$l[5]=$Y*$I-$c*$A,$l[6]=$b,$l[7]=$f,$l[8]=$J;},$d.scale=function($d,$t){var $l=$t.elements,$k=this.elements,$W=$d.elements,$i=$W[0],$A=$W[1];$l[0]=$i*$k[0],$l[1]=$i*$k[1],$l[2]=$i*$k[2],$l[3]=$A*$k[3],$l[4]=$A*$k[4],$l[5]=$A*$k[5],$l[6]=$k[6],$l[7]=$k[7],$l[8]=$k[8];},$d.invert=function($d){var $t=$d.elements,$l=this.elements,$k=$l[0],$W=$l[1],$i=$l[2],$A=$l[3],$B=$l[4],$o=$l[5],$I=$l[6],$b=$l[7],$f=$l[8],$J=$f*$B-$o*$b,$c=-$f*$A+$o*$I,$Y=$b*$A-$B*$I,$w=$k*$J+$W*$c+$i*$Y;$w||($d=null),$w=1/$w,$t[0]=$J*$w,$t[1]=(-$f*$W+$i*$b)*$w,$t[2]=($o*$W-$i*$B)*$w,$t[3]=$c*$w,$t[4]=($f*$k-$i*$I)*$w,$t[5]=(-$o*$k+$i*$A)*$w,$t[6]=$Y*$w,$t[7]=(-$b*$k+$W*$I)*$w,$t[8]=($B*$k-$W*$A)*$w;},$d.transpose=function($d){var $t=$d.elements,$l=this.elements;if($d===this){var $k=$l[1],$W=$l[2],$i=$l[5];$t[1]=$l[3],$t[2]=$l[6],$t[3]=$k,$t[5]=$l[7],$t[6]=$W,$t[7]=$i;}else $t[0]=$l[0],$t[1]=$l[3],$t[2]=$l[6],$t[3]=$l[1],$t[4]=$l[4],$t[5]=$l[7],$t[6]=$l[2],$t[7]=$l[5],$t[8]=$l[8];},$d.identity=function(){var $d=this.elements;$d[0]=1,$d[1]=0,$d[2]=0,$d[3]=0,$d[4]=1,$d[5]=0,$d[6]=0,$d[7]=0,$d[8]=1;},$d.cloneTo=function($d){var $t,$l,$k;if(($l=this.elements)!==($k=$d.elements))for($t=0;$t<9;++$t)$k[$t]=$l[$t];},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$o.createFromTranslation=function($d,$t){$t.elements;var $l=$d.elements;$t[0]=1,$t[1]=0,$t[2]=0,$t[3]=0,$t[4]=1,$t[5]=0,$t[6]=$l[0],$t[7]=$l[1],$t[8]=1;},$o.createFromRotation=function($d,$t){var $l=$t.elements,$k=Math.sin($d),$W=Math.cos($d);$l[0]=$W,$l[1]=$k,$l[2]=0,$l[3]=-$k,$l[4]=$W,$l[5]=0,$l[6]=0,$l[7]=0,$l[8]=1;},$o.createFromScaling=function($d,$t){var $l=$t.elements,$k=$d.elements;$l[0]=$k[0],$l[1]=0,$l[2]=0,$l[3]=0,$l[4]=$k[1],$l[5]=0,$l[6]=0,$l[7]=0,$l[8]=1;},$o.createFromMatrix4x4=function($d,$t){$t[0]=$d[0],$t[1]=$d[1],$t[2]=$d[2],$t[3]=$d[4],$t[4]=$d[5],$t[5]=$d[6],$t[6]=$d[8],$t[7]=$d[9],$t[8]=$d[10];},$o.multiply=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements,$A=$W[0],$B=$W[1],$o=$W[2],$I=$W[3],$b=$W[4],$f=$W[5],$J=$W[6],$c=$W[7],$Y=$W[8],$w=$i[0],$D=$i[1],$z=$i[2],$e=$i[3],$g=$i[4],$H=$i[5],$R=$i[6],$G=$i[7],$q=$i[8];$k[0]=$w*$A+$D*$I+$z*$J,$k[1]=$w*$B+$D*$b+$z*$c,$k[2]=$w*$o+$D*$f+$z*$Y,$k[3]=$e*$A+$g*$I+$H*$J,$k[4]=$e*$B+$g*$b+$H*$c,$k[5]=$e*$o+$g*$f+$H*$Y,$k[6]=$R*$A+$G*$I+$q*$J,$k[7]=$R*$B+$G*$b+$q*$c,$k[8]=$R*$o+$G*$f+$q*$Y;},$o.lookAt=function($d,$t,$l,$k){$At.subtract($d,$t,$o._tempV30),$At.normalize($o._tempV30,$o._tempV30),$At.cross($l,$o._tempV30,$o._tempV31),$At.normalize($o._tempV31,$o._tempV31),$At.cross($o._tempV30,$o._tempV31,$o._tempV32);var $W=$o._tempV30.elements,$i=$o._tempV31.elements,$A=$o._tempV32.elements,$B=$k.elements;$B[0]=$i[0],$B[3]=$i[1],$B[6]=$i[2],$B[1]=$A[0],$B[4]=$A[1],$B[7]=$A[2],$B[2]=$W[0],$B[5]=$W[1],$B[8]=$W[2];},$o.DEFAULT=new $o(),$f($o,["_tempV30",function(){return this._tempV30=new $At();},"_tempV31",function(){return this._tempV31=new $At();},"_tempV32",function(){return this._tempV32=new $At();}]),$o;}(),$dt=function(){function $$($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f,$J,$c,$Y,$w){void 0===$d&&($d=1),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$i&&($i=1),void 0===$A&&($A=0),void 0===$B&&($B=0),void 0===$o&&($o=0),void 0===$I&&($I=0),void 0===$b&&($b=1),void 0===$f&&($f=0),void 0===$J&&($J=0),void 0===$c&&($c=0),void 0===$Y&&($Y=0),void 0===$w&&($w=1);var $D=this.elements=new Float32Array(16);$D[0]=$d,$D[1]=$t,$D[2]=$l,$D[3]=$k,$D[4]=$W,$D[5]=$i,$D[6]=$A,$D[7]=$B,$D[8]=$o,$D[9]=$I,$D[10]=$b,$D[11]=$f,$D[12]=$J,$D[13]=$c,$D[14]=$Y,$D[15]=$w;}$c($$,"laya.d3.math.Matrix4x4");var $d=$$.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.getElementByRowColumn=function($d,$t){if($d<0||3<$d)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($t<0||3<$t)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$d+$t];},$d.setElementByRowColumn=function($d,$t,$l){if($d<0||3<$d)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($t<0||3<$t)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$d+$t]=$l;},$d.equalsOtherMatrix=function($d){var $t=this.elements,$l=$d.elements;return $_d.nearEqual($t[0],$l[0])&&$_d.nearEqual($t[1],$l[1])&&$_d.nearEqual($t[2],$l[2])&&$_d.nearEqual($t[3],$l[3])&&$_d.nearEqual($t[4],$l[4])&&$_d.nearEqual($t[5],$l[5])&&$_d.nearEqual($t[6],$l[6])&&$_d.nearEqual($t[7],$l[7])&&$_d.nearEqual($t[8],$l[8])&&$_d.nearEqual($t[9],$l[9])&&$_d.nearEqual($t[10],$l[10])&&$_d.nearEqual($t[11],$l[11])&&$_d.nearEqual($t[12],$l[12])&&$_d.nearEqual($t[13],$l[13])&&$_d.nearEqual($t[14],$l[14])&&$_d.nearEqual($t[15],$l[15]);},$d.decomposeTransRotScale=function($d,$t,$l){var $k=$$._tempMatrix4x4;return this.decomposeTransRotMatScale($d,$k,$l)?($lt.createFromMatrix4x4($k,$t),!0):($t.identity(),!1);},$d.decomposeTransRotMatScale=function($d,$t,$l){var $k=this.elements,$W=$d.elements,$i=$t.elements,$A=$l.elements;$W[0]=$k[12],$W[1]=$k[13],$W[2]=$k[14];var $B=$k[0],$o=$k[1],$I=$k[2],$b=$k[4],$f=$k[5],$J=$k[6],$c=$k[8],$Y=$k[9],$w=$k[10],$D=$A[0]=Math.sqrt($B*$B+$o*$o+$I*$I),$z=$A[1]=Math.sqrt($b*$b+$f*$f+$J*$J),$e=$A[2]=Math.sqrt($c*$c+$Y*$Y+$w*$w);if($_d.isZero($D)||$_d.isZero($z)||$_d.isZero($e))return $i[1]=$i[2]=$i[3]=$i[4]=$i[6]=$i[7]=$i[8]=$i[9]=$i[11]=$i[12]=$i[13]=$i[14]=0,$i[0]=$i[5]=$i[10]=$i[15]=1,!1;var $g=$$._tempVector0,$H=$g.elements;$H[0]=$c/$e,$H[1]=$Y/$e,$H[2]=$w/$e;var $R=$$._tempVector1,$G=$R.elements;$G[0]=$B/$D,$G[1]=$o/$D,$G[2]=$I/$D;var $q=$$._tempVector2;$At.cross($g,$R,$q);var $L=$$._tempVector1;return $At.cross($q,$g,$L),$i[3]=$i[7]=$i[11]=$i[12]=$i[13]=$i[14]=0,$i[15]=1,$i[0]=$L.x,$i[1]=$L.y,$i[2]=$L.z,$i[4]=$q.x,$i[5]=$q.y,$i[6]=$q.z,$i[8]=$g.x,$i[9]=$g.y,$i[10]=$g.z,$i[0]*$B+$i[1]*$o+$i[2]*$I<0&&($A[0]=-$D),$i[4]*$b+$i[5]*$f+$i[6]*$J<0&&($A[1]=-$z),$i[8]*$c+$i[9]*$Y+$i[10]*$w<0&&($A[2]=-$e),!0;},$d.decomposeYawPitchRoll=function($d){var $t=$d.elements,$l=Math.asin(-this.elements[9]);$t[1]=$l,Math.cos($l)>$_d.zeroTolerance?($t[2]=Math.atan2(this.elements[1],this.elements[5]),$t[0]=Math.atan2(this.elements[8],this.elements[10])):($t[2]=Math.atan2(-this.elements[4],this.elements[0]),$t[0]=0);},$d.normalize=function(){var $d=this.elements,$t=$d[0],$l=$d[1],$k=$d[2],$W=Math.sqrt($t*$t+$l*$l+$k*$k);if(!$W)return $d[0]=0,$d[1]=0,void($d[2]=0);1!=$W&&($W=1/$W,$d[0]=$t*$W,$d[1]=$l*$W,$d[2]=$k*$W);},$d.transpose=function(){var $d,$t;return $t=($d=this.elements)[1],$d[1]=$d[4],$d[4]=$t,$t=$d[2],$d[2]=$d[8],$d[8]=$t,$t=$d[3],$d[3]=$d[12],$d[12]=$t,$t=$d[6],$d[6]=$d[9],$d[9]=$t,$t=$d[7],$d[7]=$d[13],$d[13]=$t,$t=$d[11],$d[11]=$d[14],$d[14]=$t,this;},$d.invert=function($d){var $t=this.elements,$l=$d.elements,$k=$t[0],$W=$t[1],$i=$t[2],$A=$t[3],$B=$t[4],$o=$t[5],$I=$t[6],$b=$t[7],$f=$t[8],$J=$t[9],$c=$t[10],$Y=$t[11],$w=$t[12],$D=$t[13],$z=$t[14],$e=$t[15],$g=$k*$o-$W*$B,$H=$k*$I-$i*$B,$R=$k*$b-$A*$B,$G=$W*$I-$i*$o,$q=$W*$b-$A*$o,$L=$i*$b-$A*$I,$$=$f*$D-$J*$w,$p=$f*$z-$c*$w,$M=$f*$e-$Y*$w,$T=$J*$z-$c*$D,$r=$J*$e-$Y*$D,$S=$c*$e-$Y*$z,$j=$g*$S-$H*$r+$R*$T+$G*$M-$q*$p+$L*$$;0!==Math.abs($j)&&($j=1/$j,$l[0]=($o*$S-$I*$r+$b*$T)*$j,$l[1]=($i*$r-$W*$S-$A*$T)*$j,$l[2]=($D*$L-$z*$q+$e*$G)*$j,$l[3]=($c*$q-$J*$L-$Y*$G)*$j,$l[4]=($I*$M-$B*$S-$b*$p)*$j,$l[5]=($k*$S-$i*$M+$A*$p)*$j,$l[6]=($z*$R-$w*$L-$e*$H)*$j,$l[7]=($f*$L-$c*$R+$Y*$H)*$j,$l[8]=($B*$r-$o*$M+$b*$$)*$j,$l[9]=($W*$M-$k*$r-$A*$$)*$j,$l[10]=($w*$q-$D*$R+$e*$g)*$j,$l[11]=($J*$R-$f*$q-$Y*$g)*$j,$l[12]=($o*$p-$B*$T-$I*$$)*$j,$l[13]=($k*$T-$W*$p+$i*$$)*$j,$l[14]=($D*$H-$w*$G-$z*$g)*$j,$l[15]=($f*$G-$J*$H+$c*$g)*$j);},$d.identity=function(){var $d=this.elements;$d[1]=$d[2]=$d[3]=$d[4]=$d[6]=$d[7]=$d[8]=$d[9]=$d[11]=$d[12]=$d[13]=$d[14]=0,$d[0]=$d[5]=$d[10]=$d[15]=1;},$d.cloneTo=function($d){var $t,$l,$k;if(($l=this.elements)!==($k=$d.elements))for($t=0;$t<16;++$t)$k[$t]=$l[$t];},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$d.getTranslationVector=function($d){var $t=this.elements,$l=$d.elements;$l[0]=$t[12],$l[1]=$t[13],$l[2]=$t[14];},$d.setTranslationVector=function($d){var $t=this.elements,$l=$d.elements;$t[12]=$l[0],$t[13]=$l[1],$t[14]=$l[2];},$d.getForward=function($d){var $t=this.elements,$l=$d.elements;$l[0]=-$t[8],$l[1]=-$t[9],$l[2]=-$t[10];},$d.setForward=function($d){var $t=this.elements,$l=$d.elements;$t[8]=-$l[0],$t[9]=-$l[1],$t[10]=-$l[2];},$$.createRotationX=function($d,$t){var $l=$t.elements,$k=Math.sin($d),$W=Math.cos($d);$l[1]=$l[2]=$l[3]=$l[4]=$l[7]=$l[8]=$l[11]=$l[12]=$l[13]=$l[14]=0,$l[0]=$l[15]=1,$l[5]=$l[10]=$W,$l[6]=$k,$l[9]=-$k;},$$.createRotationY=function($d,$t){var $l=$t.elements,$k=Math.sin($d),$W=Math.cos($d);$l[1]=$l[3]=$l[4]=$l[6]=$l[7]=$l[9]=$l[11]=$l[12]=$l[13]=$l[14]=0,$l[5]=$l[15]=1,$l[0]=$l[10]=$W,$l[2]=-$k,$l[8]=$k;},$$.createRotationZ=function($d,$t){var $l=$t.elements,$k=Math.sin($d),$W=Math.cos($d);$l[2]=$l[3]=$l[6]=$l[7]=$l[8]=$l[9]=$l[11]=$l[12]=$l[13]=$l[14]=0,$l[10]=$l[15]=1,$l[0]=$l[5]=$W,$l[1]=$k,$l[4]=-$k;},$$.createRotationYawPitchRoll=function($d,$t,$l,$k){$lt.createFromYawPitchRoll($d,$t,$l,$$._tempQuaternion),$$.createRotationQuaternion($$._tempQuaternion,$k);},$$.createRotationAxis=function($d,$t,$l){var $k=$d.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=Math.cos($t),$o=Math.sin($t),$I=$W*$W,$b=$i*$i,$f=$A*$A,$J=$W*$i,$c=$W*$A,$Y=$i*$A,$w=$l.elements;$w[3]=$w[7]=$w[11]=$w[12]=$w[13]=$w[14]=0,$w[15]=1,$w[0]=$I+$B*(1-$I),$w[1]=$J-$B*$J+$o*$A,$w[2]=$c-$B*$c-$o*$i,$w[4]=$J-$B*$J-$o*$A,$w[5]=$b+$B*(1-$b),$w[6]=$Y-$B*$Y+$o*$W,$w[8]=$c-$B*$c+$o*$i,$w[9]=$Y-$B*$Y-$o*$W,$w[10]=$f+$B*(1-$f);},$$.createRotationQuaternion=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0],$i=$l[1],$A=$l[2],$B=$l[3],$o=$W*$W,$I=$i*$i,$b=$A*$A,$f=$W*$i,$J=$A*$B,$c=$A*$W,$Y=$i*$B,$w=$i*$A,$D=$W*$B;$k[3]=$k[7]=$k[11]=$k[12]=$k[13]=$k[14]=0,$k[15]=1,$k[0]=1-2*($I+$b),$k[1]=2*($f+$J),$k[2]=2*($c-$Y),$k[4]=2*($f-$J),$k[5]=1-2*($b+$o),$k[6]=2*($w+$D),$k[8]=2*($c+$Y),$k[9]=2*($w-$D),$k[10]=1-2*($I+$o);},$$.createTranslate=function($d,$t){var $l=$d.elements,$k=$t.elements;$k[4]=$k[8]=$k[1]=$k[9]=$k[2]=$k[6]=$k[3]=$k[7]=$k[11]=0,$k[0]=$k[5]=$k[10]=$k[15]=1,$k[12]=$l[0],$k[13]=$l[1],$k[14]=$l[2];},$$.createScaling=function($d,$t){var $l=$d.elements,$k=$t.elements;$k[0]=$l[0],$k[5]=$l[1],$k[10]=$l[2],$k[1]=$k[4]=$k[8]=$k[12]=$k[9]=$k[13]=$k[2]=$k[6]=$k[14]=$k[3]=$k[7]=$k[11]=0,$k[15]=1;},$$.multiply=function($d,$t,$l){var $k,$W,$i,$A,$B,$o,$I,$b;for($W=$l.elements,$i=$d.elements,$W===($A=$t.elements)&&($A=$A.slice()),$k=0;$k<4;$k++)$B=$i[$k],$o=$i[$k+4],$I=$i[$k+8],$b=$i[$k+12],$W[$k]=$B*$A[0]+$o*$A[1]+$I*$A[2]+$b*$A[3],$W[$k+4]=$B*$A[4]+$o*$A[5]+$I*$A[6]+$b*$A[7],$W[$k+8]=$B*$A[8]+$o*$A[9]+$I*$A[10]+$b*$A[11],$W[$k+12]=$B*$A[12]+$o*$A[13]+$I*$A[14]+$b*$A[15];},$$.createFromQuaternion=function($d,$t){var $l=$t.elements,$k=$d.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=$W+$W,$I=$i+$i,$b=$A+$A,$f=$W*$o,$J=$i*$o,$c=$i*$I,$Y=$A*$o,$w=$A*$I,$D=$A*$b,$z=$B*$o,$e=$B*$I,$g=$B*$b;$l[0]=1-$c-$D,$l[1]=$J+$g,$l[2]=$Y-$e,$l[3]=0,$l[4]=$J-$g,$l[5]=1-$f-$D,$l[6]=$w+$z,$l[7]=0,$l[8]=$Y+$e,$l[9]=$w-$z,$l[10]=1-$f-$c,$l[11]=0,$l[12]=0,$l[13]=0,$l[14]=0,$l[15]=1;},$$.createAffineTransformation=function($d,$t,$l,$k){var $W=$d.elements,$i=$t.elements,$A=$l.elements,$B=$k.elements,$o=$i[0],$I=$i[1],$b=$i[2],$f=$i[3],$J=$o+$o,$c=$I+$I,$Y=$b+$b,$w=$o*$J,$D=$o*$c,$z=$o*$Y,$e=$I*$c,$g=$I*$Y,$H=$b*$Y,$R=$f*$J,$G=$f*$c,$q=$f*$Y,$L=$A[0],$$=$A[1],$p=$A[2];$B[0]=(1-($e+$H))*$L,$B[1]=($D+$q)*$L,$B[2]=($z-$G)*$L,$B[3]=0,$B[4]=($D-$q)*$$,$B[5]=(1-($w+$H))*$$,$B[6]=($g+$R)*$$,$B[7]=0,$B[8]=($z+$G)*$p,$B[9]=($g-$R)*$p,$B[10]=(1-($w+$e))*$p,$B[11]=0,$B[12]=$W[0],$B[13]=$W[1],$B[14]=$W[2],$B[15]=1;},$$.createLookAt=function($d,$t,$l,$k){var $W=$k.elements,$i=$$._tempVector0,$A=$$._tempVector1,$B=$$._tempVector2;$At.subtract($d,$t,$B),$At.normalize($B,$B),$At.cross($l,$B,$i),$At.normalize($i,$i),$At.cross($B,$i,$A),$k.identity(),$W[0]=$i.x,$W[4]=$i.y,$W[8]=$i.z,$W[1]=$A.x,$W[5]=$A.y,$W[9]=$A.z,$W[2]=$B.x,$W[6]=$B.y,$W[10]=$B.z,$W[12]=-$At.dot($i,$d),$W[13]=-$At.dot($A,$d),$W[14]=-$At.dot($B,$d);},$$.createPerspective=function($d,$t,$l,$k,$W){var $i=$W.elements,$A=1/Math.tan($d/2),$B=1/($l-$k);$i[0]=$A/$t,$i[5]=$A,$i[10]=($k+$l)*$B,$i[11]=-1,$i[14]=2*$k*$l*$B,$i[1]=$i[2]=$i[3]=$i[4]=$i[6]=$i[7]=$i[8]=$i[9]=$i[12]=$i[13]=$i[15]=0;},$$.createOrthoOffCenterRH=function($d,$t,$l,$k,$W,$i,$A){var $B=$A.elements,$o=1/($d-$t),$I=1/($l-$k),$b=1/($W-$i);$B[1]=$B[2]=$B[3]=$B[4]=$B[6]=$B[7]=$B[8]=$B[9]=$B[11]=0,$B[15]=1,$B[0]=-2*$o,$B[5]=-2*$I,$B[10]=2*$b,$B[12]=($d+$t)*$o,$B[13]=($k+$l)*$I,$B[14]=($i+$W)*$b;},$$.translation=function($d,$t){var $l=$d.elements,$k=$t.elements;$k[0]=$k[5]=$k[10]=$k[15]=1,$k[12]=$l[0],$k[13]=$l[1],$k[14]=$l[2];},$f($$,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $$();},"_tempVector0",function(){return this._tempVector0=new $At();},"_tempVector1",function(){return this._tempVector1=new $At();},"_tempVector2",function(){return this._tempVector2=new $At();},"_tempQuaternion",function(){return this._tempQuaternion=new $lt();},"DEFAULT",function(){return this.DEFAULT=new $$();},"ZERO",function(){return this.ZERO=new $$(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);}]),$$;}(),$tt=(function(){function $g($d,$t){this.extents=null,this.transformation=null,this.extents=$d,this.transformation=$t;}$c($g,"laya.d3.math.OrientedBoundBox");var $d=$g.prototype;$d.getCorners=function($d){var $t=$g._tempV30.elements,$l=$g._tempV31.elements,$k=$g._tempV32.elements,$W=this.extents.elements;$t[0]=$W[0],$t[1]=$t[2]=0,$l[1]=$W[1],$l[0]=$l[2]=0,$k[2]=$W[2],$k[0]=$k[1]=0,$At.TransformNormal($g._tempV30,this.transformation,$g._tempV30),$At.TransformNormal($g._tempV31,this.transformation,$g._tempV31),$At.TransformNormal($g._tempV32,this.transformation,$g._tempV32);var $i=$g._tempV33;this.transformation.getTranslationVector($i),$d.length=8,$At.add($i,$g._tempV30,$g._tempV34),$At.add($g._tempV34,$g._tempV31,$g._tempV34),$At.add($g._tempV34,$g._tempV32,$d[0]),$At.add($i,$g._tempV30,$g._tempV34),$At.add($g._tempV34,$g._tempV31,$g._tempV34),$At.subtract($g._tempV34,$g._tempV32,$d[1]),$At.subtract($i,$g._tempV30,$g._tempV34),$At.add($g._tempV34,$g._tempV31,$g._tempV34),$At.subtract($g._tempV34,$g._tempV32,$d[2]),$At.subtract($i,$g._tempV30,$g._tempV34),$At.add($g._tempV34,$g._tempV31,$g._tempV34),$At.add($g._tempV34,$g._tempV32,$d[3]),$At.add($i,$g._tempV30,$g._tempV34),$At.subtract($g._tempV34,$g._tempV31,$g._tempV34),$At.add($g._tempV34,$g._tempV32,$d[4]),$At.add($i,$g._tempV30,$g._tempV34),$At.subtract($g._tempV34,$g._tempV31,$g._tempV34),$At.subtract($g._tempV34,$g._tempV32,$d[5]),$At.subtract($i,$g._tempV30,$g._tempV34),$At.subtract($g._tempV34,$g._tempV31,$g._tempV34),$At.subtract($g._tempV34,$g._tempV32,$d[6]),$At.subtract($i,$g._tempV30,$g._tempV34),$At.subtract($g._tempV34,$g._tempV31,$g._tempV34),$At.add($g._tempV34,$g._tempV32,$d[7]);},$d.transform=function($d){$dt.multiply(this.transformation,$d,this.transformation);},$d.scale=function($d){$At.multiply(this.extents,$d,this.extents);},$d.translate=function($d){this.transformation.getTranslationVector($g._tempV30),$At.add($g._tempV30,$d,$g._tempV31),this.transformation.setTranslationVector($g._tempV31);},$d.Size=function($d){$At.scale(this.extents,2,$d);},$d.getSize=function($d){var $t=this.extents.elements;$g._tempV30.x=$t[0],$g._tempV31.y=$t[1],$g._tempV32.z=$t[2],$At.TransformNormal($g._tempV30,this.transformation,$g._tempV30),$At.TransformNormal($g._tempV31,this.transformation,$g._tempV31),$At.TransformNormal($g._tempV31,this.transformation,$g._tempV32);var $l=$d.elements;$l[0]=$At.scalarLength($g._tempV30),$l[1]=$At.scalarLength($g._tempV31),$l[2]=$At.scalarLength($g._tempV32);},$d.getSizeSquared=function($d){var $t=this.extents.elements;$g._tempV30.x=$t[0],$g._tempV31.y=$t[1],$g._tempV32.z=$t[2],$At.TransformNormal($g._tempV30,this.transformation,$g._tempV30),$At.TransformNormal($g._tempV31,this.transformation,$g._tempV31),$At.TransformNormal($g._tempV31,this.transformation,$g._tempV32);var $l=$d.elements;$l[0]=$At.scalarLengthSquared($g._tempV30),$l[1]=$At.scalarLengthSquared($g._tempV31),$l[2]=$At.scalarLengthSquared($g._tempV32);},$d.getCenter=function($d){this.transformation.getTranslationVector($d);},$d.containsPoint=function($d){var $t=this.extents.elements,$l=$t[0],$k=$t[1],$W=$t[2];this.transformation.invert($g._tempM0),$At.transformCoordinate($d,$g._tempM0,$g._tempV30);var $i=$g._tempV30.elements,$A=Math.abs($i[0]),$B=Math.abs($i[1]),$o=Math.abs($i[2]);return $_d.nearEqual($A,$l)&&$_d.nearEqual($B,$k)&&$_d.nearEqual($o,$W)?2:$A<$l&&$B<$k&&$o<$W?1:0;},$d.containsPoints=function($d){var $t=this.extents.elements,$l=$t[0],$k=$t[1],$W=$t[2];this.transformation.invert($g._tempM0);for(var $i=!0,$A=!1,$B=0;$B<$d.length;$B++){$At.transformCoordinate($d[$B],$g._tempM0,$g._tempV30);var $o=$g._tempV30.elements,$I=Math.abs($o[0]),$b=Math.abs($o[1]),$f=Math.abs($o[2]);$_d.nearEqual($I,$l)&&$_d.nearEqual($b,$k)&&$_d.nearEqual($f,$W)&&($A=!0),$I<$l&&$b<$k&&$f<$W?$A=!0:$i=!1;}return $i?1:$A?2:0;},$d.containsSphere=function($d,$t){void 0===$t&&($t=!1);var $l=this.extents.elements,$k=$l[0],$W=$l[1],$i=$l[2],$A=$d.radius;this.transformation.invert($g._tempM0),$At.transformCoordinate($d.center,$g._tempM0,$g._tempV30);var $B=NaN;if($B=$t?$A:($At.scale($At.UnitX,$A,$g._tempV31),$At.TransformNormal($g._tempV31,$g._tempM0,$g._tempV31),$At.scalarLength($g._tempV31)),$At.scale(this.extents,-1,$g._tempV32),$At.Clamp($g._tempV30,$g._tempV32,this.extents,$g._tempV33),$B*$B<$At.distanceSquared($g._tempV30,$g._tempV33))return 0;var $o=$g._tempV30.elements,$I=$o[0],$b=$o[1],$f=$o[2],$J=$g._tempV32.elements,$c=$J[0],$Y=$J[1],$w=$J[2];return $c+$B<=$I&&$I<=$k-$B&&$B<$k-$c&&$Y+$B<=$b&&$b<=$W-$B&&$B<$W-$Y&&$w+$B<=$f&&$f<=$i-$B&&$B<$i-$w?1:2;},$d.containsOrientedBoundBox=function($d){var $t=0,$l=0;$d.getCorners($g._corners);var $k=this.containsPoints($g._corners);if(0!=$k)return $k;var $W=this.extents.elements;$d.extents.cloneTo($g._tempV35);var $i=$g._tempV35.elements;$g._getRows(this.transformation,$g._rows1),$g._getRows($d.transformation,$g._rows2);var $A=NaN;for($t=0;$t<4;$t++)for($l=0;$l<4;$l++)3==$t||3==$l?($g._tempM0.setElementByRowColumn($t,$l,0),$g._tempM1.setElementByRowColumn($t,$l,0)):($A=$At.dot($g._rows1[$t],$g._rows2[$l]),$g._tempM0.setElementByRowColumn($t,$l,$A),$g._tempM1.setElementByRowColumn($t,$l,Math.abs($A)));$d.getCenter($g._tempV34),this.getCenter($g._tempV36),$At.subtract($g._tempV34,$g._tempV36,$g._tempV30);var $B=$g._tempV31.elements;$B[0]=$At.dot($g._tempV30,$g._rows1[0]),$B[1]=$At.dot($g._tempV30,$g._rows1[1]),$B[2]=$At.dot($g._tempV30,$g._rows1[2]);var $o=$g._tempV32.elements,$I=$g._tempV33.elements;for($t=0;$t<3;$t++)if($o[0]=$g._tempM1.getElementByRowColumn($t,0),$o[1]=$g._tempM1.getElementByRowColumn($t,1),$o[2]=$g._tempM1.getElementByRowColumn($t,2),$W[$t]+$At.dot($g._tempV35,$g._tempV32)<Math.abs($B[$t]))return 0;for($l=0;$l<3;$l++)if($o[0]=$g._tempM1.getElementByRowColumn(0,$l),$o[1]=$g._tempM1.getElementByRowColumn(1,$l),$o[2]=$g._tempM1.getElementByRowColumn(2,$l),$I[0]=$g._tempM0.getElementByRowColumn(0,$l),$I[1]=$g._tempM0.getElementByRowColumn(1,$l),$I[2]=$g._tempM0.getElementByRowColumn(2,$l),$At.dot(this.extents,$g._tempV32)+$i[$l]<Math.abs($At.dot($g._tempV31,$g._tempV33)))return 0;for($t=0;$t<3;$t++)for($l=0;$l<3;$l++){var $b=($t+1)%3,$f=($t+2)%3,$J=($l+1)%3,$c=($l+2)%3;if($W[$b]*$g._tempM1.getElementByRowColumn($f,$l)+$W[$f]*$g._tempM1.getElementByRowColumn($b,$l)+($i[$J]*$g._tempM1.getElementByRowColumn($t,$c)+$i[$c]*$g._tempM1.getElementByRowColumn($t,$J))<Math.abs($B[$f]*$g._tempM0.getElementByRowColumn($b,$l)-$B[$b]*$g._tempM0.getElementByRowColumn($f,$l)))return 0;}return 2;},$d.containsLine=function($d,$t){$g._corners[0]=$d,$g._corners[1]=$t;var $l=this.containsPoints($g._corners);if(0!=$l)return $l;var $k=this.extents.elements,$W=$k[0],$i=$k[1],$A=$k[2];this.transformation.invert($g._tempM0),$At.transformCoordinate($d,$g._tempM0,$g._tempV30),$At.transformCoordinate($t,$g._tempM0,$g._tempV31),$At.add($g._tempV30,$g._tempV31,$g._tempV32),$At.scale($g._tempV32,.5,$g._tempV32),$At.subtract($g._tempV30,$g._tempV32,$g._tempV33);var $B=$g._tempV33.elements,$o=$B[0],$I=$B[1],$b=$B[2],$f=$g._tempV34.elements,$J=$f[0]=Math.abs($B[0]),$c=$f[1]=Math.abs($B[1]),$Y=$f[2]=Math.abs($B[2]),$w=$g._tempV32.elements,$D=$w[0],$z=$w[1],$e=$w[2];return Math.abs($D)>$W+$J?0:Math.abs($z)>$i+$c?0:Math.abs($e)>$A+$Y?0:Math.abs($z*$b-$e*$I)>$i*$Y+$A*$c?0:Math.abs($D*$b-$e*$o)>$W*$Y+$A*$J?0:Math.abs($D*$I-$z*$o)>$W*$c+$i*$J?0:2;},$d.containsBoundBox=function($d){var $t=0,$l=0,$k=$d.min,$W=$d.max;$d.getCorners($g._corners);var $i=this.containsPoints($g._corners);if(0!=$i)return $i;$At.subtract($W,$k,$g._tempV30),$At.scale($g._tempV30,.5,$g._tempV30),$At.add($k,$g._tempV30,$g._tempV30),$At.subtract($W,$g._tempV30,$g._tempV31);var $A=this.extents.elements,$B=$g._tempV31.elements;$g._getRows(this.transformation,$g._rows1),this.transformation.invert($g._tempM0);for($t=0;$t<3;$t++)for($l=0;$l<3;$l++)$g._tempM1.setElementByRowColumn($t,$l,Math.abs($g._tempM0.getElementByRowColumn($t,$l)));this.getCenter($g._tempV35),$At.subtract($g._tempV30,$g._tempV35,$g._tempV32);var $o=$g._tempV31.elements;$o[0]=$At.dot($g._tempV32,$g._rows1[0]),$o[1]=$At.dot($g._tempV32,$g._rows1[1]),$o[2]=$At.dot($g._tempV32,$g._rows1[2]);var $I=$g._tempV33.elements,$b=$g._tempV34.elements;for($t=0;$t<3;$t++)if($I[0]=$g._tempM1.getElementByRowColumn($t,0),$I[1]=$g._tempM1.getElementByRowColumn($t,1),$I[2]=$g._tempM1.getElementByRowColumn($t,2),$A[$t]+$At.dot($g._tempV31,$g._tempV33)<Math.abs($o[$t]))return 0;for($l=0;$l<3;$l++)if($I[0]=$g._tempM1.getElementByRowColumn(0,$l),$I[1]=$g._tempM1.getElementByRowColumn(1,$l),$I[2]=$g._tempM1.getElementByRowColumn(2,$l),$b[0]=$g._tempM0.getElementByRowColumn(0,$l),$b[1]=$g._tempM0.getElementByRowColumn(1,$l),$b[2]=$g._tempM0.getElementByRowColumn(2,$l),$At.dot(this.extents,$g._tempV33)+$B[$l]<Math.abs($At.dot($g._tempV31,$g._tempV34)))return 0;for($t=0;$t<3;$t++)for($l=0;$l<3;$l++){var $f=($t+1)%3,$J=($t+2)%3,$c=($l+1)%3,$Y=($l+2)%3;if($A[$f]*$g._tempM1.getElementByRowColumn($J,$l)+$A[$J]*$g._tempM1.getElementByRowColumn($f,$l)+($B[$c]*$g._tempM1.getElementByRowColumn($t,$Y)+$B[$Y]*$g._tempM1.getElementByRowColumn($t,$c))<Math.abs($o[$J]*$g._tempM0.getElementByRowColumn($f,$l)-$o[$f]*$g._tempM0.getElementByRowColumn($J,$l)))return 0;}return 2;},$d.intersectsRay=function($d,$t){$At.scale(this.extents,-1,$g._tempV30),this.transformation.invert($g._tempM0),$At.TransformNormal($d.direction,$g._tempM0,$g._ray.direction),$At.transformCoordinate($d.origin,$g._tempM0,$g._ray.origin),$g._boxBound1.min=$g._tempV30,$g._boxBound1.max=this.extents;var $l=Collision.intersectsRayAndBoxRP($g._ray,$g._boxBound1,$t);return-1!==$l&&$At.transformCoordinate($t,this.transformation,$t),$l;},$d._getLocalCorners=function($d){$d.length=8;var $t=this.extents.elements;$g._tempV30.x=$t[0],$g._tempV31.y=$t[1],$g._tempV32.z=$t[2],$At.add($g._tempV30,$g._tempV31,$g._tempV33),$At.add($g._tempV33,$g._tempV32,$d[0]),$At.add($g._tempV30,$g._tempV31,$g._tempV33),$At.subtract($g._tempV33,$g._tempV32,$d[1]),$At.subtract($g._tempV31,$g._tempV30,$g._tempV33),$At.subtract($g._tempV33,$g._tempV30,$d[2]),$At.subtract($g._tempV31,$g._tempV30,$g._tempV33),$At.add($g._tempV33,$g._tempV32,$d[3]),$At.subtract($g._tempV30,$g._tempV31,$g._tempV33),$At.add($g._tempV33,$g._tempV32,$d[4]),$At.subtract($g._tempV30,$g._tempV31,$g._tempV33),$At.subtract($g._tempV33,$g._tempV32,$d[5]),$At.scale($d[0],-1,$d[6]),$At.subtract($g._tempV32,$g._tempV30,$g._tempV33),$At.subtract($g._tempV33,$g._tempV31,$d[7]);},$d.equals=function($d){return this.extents==$d.extents&&this.transformation==$d.transformation;},$d.cloneTo=function($d){var $t=$d;this.extents.cloneTo($t.extents),this.transformation.cloneTo($t.transformation);},$g.createByBoundBox=function($d,$t){var $l=$d.min,$k=$d.max;$At.subtract($k,$l,$g._tempV30),$At.scale($g._tempV30,.5,$g._tempV30),$At.add($l,$g._tempV30,$g._tempV31),$At.subtract($k,$g._tempV31,$g._tempV32),$dt.translation($g._tempV31,$g._tempM0);var $W=$g._tempV32.clone(),$i=$g._tempM0.clone();$t.extents=$W,$t.transformation=$i;},$g.createByMinAndMaxVertex=function($d,$t){return $At.subtract($t,$d,$g._tempV30),$At.scale($g._tempV30,.5,$g._tempV30),$At.add($d,$g._tempV30,$g._tempV31),$At.subtract($t,$g._tempV31,$g._tempV32),$dt.translation($g._tempV31,$g._tempM0),new $g($g._tempV32,$g._tempM0);},$g._getRows=function($d,$t){$t.length=3;var $l=$d.elements,$k=$t[0].elements;$k[0]=$l[0],$k[1]=$l[1],$k[2]=$l[2];var $W=$t[1].elements;$W[0]=$l[4],$W[1]=$l[5],$W[2]=$l[6];var $i=$t[2].elements;$i[0]=$l[8],$i[1]=$l[9],$i[2]=$l[10];},$g.getObbtoObbMatrix4x4=function($d,$t,$l,$k){var $W=$d.transformation,$i=$t.transformation;if($l){$g._getRows($W,$g._rows1),$g._getRows($i,$g._rows2);for(var $A=0;$A<3;$A++)for(var $B=0;$B<3;$B++)$k.setElementByRowColumn($A,$B,$At.dot($g._rows2[$A],$g._rows1[$B]));$t.getCenter($g._tempV30),$d.getCenter($g._tempV31),$At.subtract($g._tempV30,$g._tempV31,$g._tempV32);var $o=$k.elements;$o[12]=$At.dot($g._tempV32,$g._rows1[0]),$o[13]=$At.dot($g._tempV32,$g._rows1[1]),$o[14]=$At.dot($g._tempV32,$g._rows1[2]),$o[15]=1;}else $W.invert($g._tempM0),$dt.multiply($i,$g._tempM0,$k);},$g.merge=function($d,$t,$l){var $k=$d.extents,$W=$d.transformation;$g.getObbtoObbMatrix4x4($d,$t,$l,$g._tempM0),$t._getLocalCorners($g._corners),$At.transformCoordinate($g._corners[0],$g._tempM0,$g._corners[0]),$At.transformCoordinate($g._corners[1],$g._tempM0,$g._corners[1]),$At.transformCoordinate($g._corners[2],$g._tempM0,$g._corners[2]),$At.transformCoordinate($g._corners[3],$g._tempM0,$g._corners[3]),$At.transformCoordinate($g._corners[4],$g._tempM0,$g._corners[4]),$At.transformCoordinate($g._corners[5],$g._tempM0,$g._corners[5]),$At.transformCoordinate($g._corners[6],$g._tempM0,$g._corners[6]),$At.transformCoordinate($g._corners[7],$g._tempM0,$g._corners[7]),$At.scale($k,-1,$g._boxBound1.min),$k.cloneTo($g._boxBound1.max),$Od.createfromPoints($g._corners,$g._boxBound2),$Od.merge($g._boxBound2,$g._boxBound1,$g._boxBound3);var $i=$g._boxBound3.min,$A=$g._boxBound3.max;$At.subtract($A,$i,$g._tempV30),$At.scale($g._tempV30,.5,$g._tempV30),$At.add($i,$g._tempV30,$g._tempV32),$At.subtract($A,$g._tempV32,$k),$At.transformCoordinate($g._tempV32,$W,$g._tempV33);},$f($g,["_tempV30",function(){return this._tempV30=new $At();},"_tempV31",function(){return this._tempV31=new $At();},"_tempV32",function(){return this._tempV32=new $At();},"_tempV33",function(){return this._tempV33=new $At();},"_tempV34",function(){return this._tempV34=new $At();},"_tempV35",function(){return this._tempV35=new $At();},"_tempV36",function(){return this._tempV36=new $At();},"_tempM0",function(){return this._tempM0=new $dt();},"_tempM1",function(){return this._tempM1=new $dt();},"_corners",function(){return this._corners=[new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At()];},"_rows1",function(){return this._rows1=[new $At(),new $At(),new $At()];},"_rows2",function(){return this._rows2=[new $At(),new $At(),new $At()];},"_ray",function(){return this._ray=new $Wt(new $At(),new $At());},"_boxBound1",function(){return this._boxBound1=new $Od(new $At(),new $At());},"_boxBound2",function(){return this._boxBound2=new $Od(new $At(),new $At());},"_boxBound3",function(){return this._boxBound3=new $Od(new $At(),new $At());}]);}(),function(){function $R($d,$t){this.normal=null,this.distance=NaN,void 0===$t&&($t=0),this.normal=$d,this.distance=$t;}return $c($R,"laya.d3.math.Plane"),$R.prototype.normalize=function(){var $d=this.normal.elements,$t=$d[0],$l=$d[1],$k=$d[2],$W=1/Math.sqrt($t*$t+$l*$l+$k*$k);$d[0]=$t*$W,$d[1]=$l*$W,$d[2]=$k*$W,this.distance*=$W;},$R.createPlaneBy3P=function($d,$t,$l){var $k=$d.elements,$W=$t.elements,$i=$l.elements,$A=$W[0]-$k[0],$B=$W[1]-$k[1],$o=$W[2]-$k[2],$I=$i[0]-$k[0],$b=$i[1]-$k[1],$f=$i[2]-$k[2],$J=$B*$f-$o*$b,$c=$o*$I-$A*$f,$Y=$A*$b-$B*$I,$w=1/Math.sqrt($J*$J+$c*$c+$Y*$Y),$D=$J*$w,$z=$c*$w,$e=$Y*$w,$g=$R._TEMPVec3.elements;$g[0]=$D,$g[1]=$z,$g[2]=$e;var $H=-($D*$k[0]+$z*$k[1]+$e*$k[2]);return new $R($R._TEMPVec3,$H);},$R.PlaneIntersectionType_Back=0,$R.PlaneIntersectionType_Front=1,$R.PlaneIntersectionType_Intersecting=2,$f($R,["_TEMPVec3",function(){return this._TEMPVec3=new $At();}]),$R;}()),$lt=function(){function $W($d,$t,$l,$k){this.elements=new Float32Array(4),void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=1),this.elements[0]=$d,this.elements[1]=$t,this.elements[2]=$l,this.elements[3]=$k;}$c($W,"laya.d3.math.Quaternion");var $d=$W.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.scaling=function($d,$t){var $l=$t.elements,$k=this.elements;$l[0]=$k[0]*$d,$l[1]=$k[1]*$d,$l[2]=$k[2]*$d,$l[3]=$k[3]*$d;},$d.normalize=function($d){var $t=$d.elements,$l=this.elements,$k=$l[0],$W=$l[1],$i=$l[2],$A=$l[3],$B=$k*$k+$W*$W+$i*$i+$A*$A;0<$B&&($B=1/Math.sqrt($B),$t[0]=$k*$B,$t[1]=$W*$B,$t[2]=$i*$B,$t[3]=$A*$B);},$d.length=function(){var $d=this.elements,$t=$d[0],$l=$d[1],$k=$d[2],$W=$d[3];return Math.sqrt($t*$t+$l*$l+$k*$k+$W*$W);},$d.rotateX=function($d,$t){var $l=$t.elements,$k=this.elements;$d*=.5;var $W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=Math.sin($d),$I=Math.cos($d);$l[0]=$W*$I+$B*$o,$l[1]=$i*$I+$A*$o,$l[2]=$A*$I-$i*$o,$l[3]=$B*$I-$W*$o;},$d.rotateY=function($d,$t){var $l=$t.elements,$k=this.elements;$d*=.5;var $W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=Math.sin($d),$I=Math.cos($d);$l[0]=$W*$I-$A*$o,$l[1]=$i*$I+$B*$o,$l[2]=$A*$I+$W*$o,$l[3]=$B*$I-$i*$o;},$d.rotateZ=function($d,$t){var $l=$t.elements,$k=this.elements;$d*=.5;var $W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=Math.sin($d),$I=Math.cos($d);$l[0]=$W*$I+$i*$o,$l[1]=$i*$I-$W*$o,$l[2]=$A*$I+$B*$o,$l[3]=$B*$I-$A*$o;},$d.getYawPitchRoll=function($d){$At.transformQuat($At.ForwardRH,this,$W.TEMPVector31),$At.transformQuat($At.Up,this,$W.TEMPVector32);var $t=$W.TEMPVector32.elements;$W.angleTo($At.ZERO,$W.TEMPVector31,$W.TEMPVector33);var $l=$W.TEMPVector33.elements;$l[0]==Math.PI/2?($l[1]=$W.arcTanAngle($t[2],$t[0]),$l[2]=0):$l[0]==-Math.PI/2?($l[1]=$W.arcTanAngle(-$t[2],-$t[0]),$l[2]=0):($dt.createRotationY(-$l[1],$W.TEMPMatrix0),$dt.createRotationX(-$l[0],$W.TEMPMatrix1),$At.transformCoordinate($W.TEMPVector32,$W.TEMPMatrix0,$W.TEMPVector32),$At.transformCoordinate($W.TEMPVector32,$W.TEMPMatrix1,$W.TEMPVector32),$l[2]=$W.arcTanAngle($t[1],-$t[0])),$l[1]<=-Math.PI&&($l[1]=Math.PI),$l[2]<=-Math.PI&&($l[2]=Math.PI),$l[1]>=Math.PI&&$l[2]>=Math.PI&&($l[1]=0,$l[2]=0,$l[0]=Math.PI-$l[0]);var $k=$d.elements;$k[0]=$l[1],$k[1]=$l[0],$k[2]=$l[2];},$d.invert=function($d){var $t=$d.elements,$l=this.elements,$k=$l[0],$W=$l[1],$i=$l[2],$A=$l[3],$B=$k*$k+$W*$W+$i*$i+$A*$A,$o=$B?1/$B:0;$t[0]=-$k*$o,$t[1]=-$W*$o,$t[2]=-$i*$o,$t[3]=$A*$o;},$d.identity=function(){var $d=this.elements;$d[0]=0,$d[1]=0,$d[2]=0,$d[3]=1;},$d.fromArray=function($d,$t){void 0===$t&&($t=0),this.elements[0]=$d[$t+0],this.elements[1]=$d[$t+1],this.elements[2]=$d[$t+2],this.elements[3]=$d[$t+3];},$d.cloneTo=function($d){var $t,$l,$k;if(($l=this.elements)!==($k=$d.elements))for($t=0;$t<4;++$t)$k[$t]=$l[$t];},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$d.equals=function($d){var $t=this.elements,$l=$d.elements;return $_d.nearEqual($t[0],$l[0])&&$_d.nearEqual($t[1],$l[1])&&$_d.nearEqual($t[2],$l[2])&&$_d.nearEqual($t[3],$l[3]);},$d.lengthSquared=function(){var $d=this.elements[0],$t=this.elements[1],$l=this.elements[2],$k=this.elements[3];return $d*$d+$t*$t+$l*$l+$k*$k;},$Y(0,$d,"x",function(){return this.elements[0];}),$Y(0,$d,"y",function(){return this.elements[1];}),$Y(0,$d,"z",function(){return this.elements[2];}),$Y(0,$d,"w",function(){return this.elements[3];}),$W.createFromYawPitchRoll=function($d,$t,$l,$k){var $W=.5*$l,$i=.5*$t,$A=.5*$d,$B=Math.sin($W),$o=Math.cos($W),$I=Math.sin($i),$b=Math.cos($i),$f=Math.sin($A),$J=Math.cos($A),$c=$k.elements;$c[0]=$J*$I*$o+$f*$b*$B,$c[1]=$f*$b*$o-$J*$I*$B,$c[2]=$J*$b*$B-$f*$I*$o,$c[3]=$J*$b*$o+$f*$I*$B;},$W.multiply=function($d,$t,$l){var $k=$d.elements,$W=$t.elements,$i=$l.elements,$A=$k[0],$B=$k[1],$o=$k[2],$I=$k[3],$b=$W[0],$f=$W[1],$J=$W[2],$c=$W[3],$Y=$B*$J-$o*$f,$w=$o*$b-$A*$J,$D=$A*$f-$B*$b,$z=$A*$b+$B*$f+$o*$J;$i[0]=$A*$c+$b*$I+$Y,$i[1]=$B*$c+$f*$I+$w,$i[2]=$o*$c+$J*$I+$D,$i[3]=$I*$c-$z;},$W.arcTanAngle=function($d,$t){return 0==$d?1==$t?Math.PI/2:-Math.PI/2:0<$d?Math.atan($t/$d):$d<0?0<$t?Math.atan($t/$d)+Math.PI:Math.atan($t/$d)-Math.PI:0;},$W.angleTo=function($d,$t,$l){$At.subtract($t,$d,$W.TEMPVector30),$At.normalize($W.TEMPVector30,$W.TEMPVector30),$l.elements[0]=Math.asin($W.TEMPVector30.y),$l.elements[1]=$W.arcTanAngle(-$W.TEMPVector30.z,-$W.TEMPVector30.x);},$W.createFromAxisAngle=function($d,$t,$l){var $k=$l.elements,$W=$d.elements;$t*=.5;var $i=Math.sin($t);$k[0]=$i*$W[0],$k[1]=$i*$W[1],$k[2]=$i*$W[2],$k[3]=Math.cos($t);},$W.createFromMatrix3x3=function($d,$t){var $l,$k=$t.elements,$W=$d.elements,$i=$W[0]+$W[4]+$W[8];if(0<$i)$l=Math.sqrt($i+1),$k[3]=.5*$l,$l=.5/$l,$k[0]=($W[5]-$W[7])*$l,$k[1]=($W[6]-$W[2])*$l,$k[2]=($W[1]-$W[3])*$l;else{var $A=0;$W[4]>$W[0]&&($A=1),$W[8]>$W[3*$A+$A]&&($A=2);var $B=($A+1)%3,$o=($A+2)%3;$l=Math.sqrt($W[3*$A+$A]-$W[3*$B+$B]-$W[3*$o+$o]+1),$k[$A]=.5*$l,$l=.5/$l,$k[3]=($W[3*$B+$o]-$W[3*$o+$B])*$l,$k[$B]=($W[3*$B+$A]+$W[3*$A+$B])*$l,$k[$o]=($W[3*$o+$A]+$W[3*$A+$o])*$l;}},$W.createFromMatrix4x4=function($d,$t){var $l,$k,$W=$d.elements,$i=$t.elements,$A=$W[0]+$W[5]+$W[10];0<$A?($l=Math.sqrt($A+1),$i[3]=.5*$l,$l=.5/$l,$i[0]=($W[6]-$W[9])*$l,$i[1]=($W[8]-$W[2])*$l,$i[2]=($W[1]-$W[4])*$l):$W[0]>=$W[5]&&$W[0]>=$W[10]?($k=.5/($l=Math.sqrt(1+$W[0]-$W[5]-$W[10])),$i[0]=.5*$l,$i[1]=($W[1]+$W[4])*$k,$i[2]=($W[2]+$W[8])*$k,$i[3]=($W[6]-$W[9])*$k):$W[5]>$W[10]?($k=.5/($l=Math.sqrt(1+$W[5]-$W[0]-$W[10])),$i[0]=($W[4]+$W[1])*$k,$i[1]=.5*$l,$i[2]=($W[9]+$W[6])*$k,$i[3]=($W[8]-$W[2])*$k):($k=.5/($l=Math.sqrt(1+$W[10]-$W[0]-$W[5])),$i[0]=($W[8]+$W[2])*$k,$i[1]=($W[9]+$W[6])*$k,$i[2]=.5*$l,$i[3]=($W[1]-$W[4])*$k);},$W.slerp=function($d,$t,$l,$k){var $W,$i,$A,$B,$o,$I=$d.elements,$b=$t.elements,$f=$k.elements,$J=$I[0],$c=$I[1],$Y=$I[2],$w=$I[3],$D=$b[0],$z=$b[1],$e=$b[2],$g=$b[3];return($i=$J*$D+$c*$z+$Y*$e+$w*$g)<0&&($i=-$i,$D=-$D,$z=-$z,$e=-$e,$g=-$g),$o=1e-6<1-$i?($W=Math.acos($i),$A=Math.sin($W),$B=Math.sin((1-$l)*$W)/$A,Math.sin($l*$W)/$A):($B=1-$l,$l),$f[0]=$B*$J+$o*$D,$f[1]=$B*$c+$o*$z,$f[2]=$B*$Y+$o*$e,$f[3]=$B*$w+$o*$g,$f;},$W.lerp=function($d,$t,$l,$k){var $W=$k.elements,$i=$d.elements,$A=$t.elements,$B=$i[0],$o=$i[1],$I=$i[2],$b=$i[3];$W[0]=$B+$l*($A[0]-$B),$W[1]=$o+$l*($A[1]-$o),$W[2]=$I+$l*($A[2]-$I),$W[3]=$b+$l*($A[3]-$b);},$W.add=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]+$i[0],$k[1]=$W[1]+$i[1],$k[2]=$W[2]+$i[2],$k[3]=$W[3]+$i[3];},$W.dot=function($d,$t){var $l=$d.elements,$k=$t.elements;return $l[0]*$k[0]+$l[1]*$k[1]+$l[2]*$k[2]+$l[3]*$k[3];},$W.rotationLookAt=function($d,$t,$l){$W.lookAt($At.ZERO,$d,$t,$l);},$W.lookAt=function($d,$t,$l,$k){$vd.lookAt($d,$t,$l,$W._tempMatrix3x3),$W.rotationMatrix($W._tempMatrix3x3,$k);},$W.invert=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$d.lengthSquared();$_d.isZero($W)||($W=1/$W,$k[0]=-$l[0]*$W,$k[1]=-$l[1]*$W,$k[2]=-$l[2]*$W,$k[3]=$l[3]*$W);},$W.rotationMatrix=function($d,$t){var $l=$d.elements,$k=$l[0],$W=$l[1],$i=$l[2],$A=$l[3],$B=$l[4],$o=$l[5],$I=$l[6],$b=$l[7],$f=$l[8],$J=$t.elements,$c=NaN,$Y=NaN,$w=$k+$B+$f;0<$w?($c=Math.sqrt($w+1),$J[3]=.5*$c,$c=.5/$c,$J[0]=($o-$b)*$c,$J[1]=($I-$i)*$c,$J[2]=($W-$A)*$c):$B<=$k&&$f<=$k?($Y=.5/($c=Math.sqrt(1+$k-$B-$f)),$J[0]=.5*$c,$J[1]=($W+$A)*$Y,$J[2]=($i+$I)*$Y,$J[3]=($o-$b)*$Y):$f<$B?($Y=.5/($c=Math.sqrt(1+$B-$k-$f)),$J[0]=($A+$W)*$Y,$J[1]=.5*$c,$J[2]=($b+$o)*$Y,$J[3]=($I-$i)*$Y):($Y=.5/($c=Math.sqrt(1+$f-$k-$B)),$J[0]=($I+$i)*$Y,$J[1]=($b+$o)*$Y,$J[2]=.5*$c,$J[3]=($W-$A)*$Y);},$W.DEFAULT=new $W(),$f($W,["TEMPVector30",function(){return this.TEMPVector30=new $At();},"TEMPVector31",function(){return this.TEMPVector31=new $At();},"TEMPVector32",function(){return this.TEMPVector32=new $At();},"TEMPVector33",function(){return this.TEMPVector33=new $At();},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $dt();},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $dt();},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $vd();},"NAN",function(){return this.NAN=new $W(NaN,NaN,NaN,NaN);}]),$W;}(),$kt=function(){function $d($d){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$d,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}$c($d,"laya.d3.math.Rand");var $t=$d.prototype;return $t.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3];},$t.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607);},$t.getSignedFloat=function(){return 2*this.getFloat()-1;},$Y(0,$t,"seed",function(){return this.seeds[0];},function($d){this.seeds[0]=$d,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}),$d.getFloatFromInt=function($d){return 1/8388607*(8388607&$d);},$d.getByteFromInt=function($d){return(8388607&$d)>>>15;},$d;}(),$Wt=(function(){function $W($d){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($d instanceof Array)||4!==$d.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$d[0],this._state0L=0|$d[1],this._state1U=0|$d[2],this._state1L=0|$d[3];}$c($W,"laya.d3.math.RandX");var $d=$W.prototype;$d.randomint=function(){var $d=this._state0U,$t=this._state0L,$l=this._state1U,$k=this._state1L,$W=($k>>>0)+($t>>>0),$i=$l+$d+($W/2>>>31)>>>0,$A=$W>>>0,$B=0,$o=0;$B=($d^=$B=$d<<23|(-512&$t)>>>9)^(this._state0U=$l),$o=($t^=$o=$t<<23)^(this._state0L=$k);$B^=$d>>>18,$o^=$t>>>18|(262143&$d)<<14;return $B^=$l>>>5,$o^=$k>>>5|(31&$l)<<27,this._state1U=$B,this._state1L=$o,[$i,$A];},$d.random=function(){var $d=this.randomint(),$t=$d[0],$l=1023<<20|$t>>>12,$k=0|($d[1]>>>12|(4095&$t)<<20);return $W._CONVERTION_BUFFER.setUint32(0,$l,!1),$W._CONVERTION_BUFFER.setUint32(4,$k,!1),$kt._CONVERTION_BUFFER.getFloat64(0,!1)-1;},$f($W,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8));},"defaultRand",function(){return this.defaultRand=new $kt([0,Date.now()/65536,0,Date.now()%65536]);}]);}(),function(){function $d($d,$t){this.origin=null,this.direction=null,this.origin=$d,this.direction=$t;}return $c($d,"laya.d3.math.Ray"),$d;}()),$it=function(){function $d($d,$t){this.elements=new Float32Array(2),void 0===$d&&($d=0),void 0===$t&&($t=0);var $l=this.elements;$l[0]=$d,$l[1]=$t;}$c($d,"laya.d3.math.Vector2");var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.IClone":!0}),$t.fromArray=function($d,$t){void 0===$t&&($t=0),this.elements[0]=$d[$t+0],this.elements[1]=$d[$t+1];},$t.cloneTo=function($d){var $t=$d.elements,$l=this.elements;$t[0]=$l[0],$t[1]=$l[1];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"x",function(){return this.elements[0];},function($d){this.elements[0]=$d;}),$Y(0,$t,"y",function(){return this.elements[1];},function($d){this.elements[1]=$d;}),$d.scale=function($d,$t,$l){var $k=$l.elements,$W=$d.elements;$k[0]=$W[0]*$t,$k[1]=$W[1]*$t;},$f($d,["ZERO",function(){return this.ZERO=new $d(0,0);},"ONE",function(){return this.ONE=new $d(1,1);}]),$d;}(),$At=function(){function $b($d,$t,$l){this.elements=new Float32Array(3),void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0);var $k=this.elements;$k[0]=$d,$k[1]=$t,$k[2]=$l;}$c($b,"laya.d3.math.Vector3");var $d=$b.prototype;return $R.imps($d,{"laya.d3.core.IClone":!0}),$d.fromArray=function($d,$t){void 0===$t&&($t=0),this.elements[0]=$d[$t+0],this.elements[1]=$d[$t+1],this.elements[2]=$d[$t+2];},$d.cloneTo=function($d){var $t=$d.elements,$l=this.elements;$t[0]=$l[0],$t[1]=$l[1],$t[2]=$l[2];},$d.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$d.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0;},$d.reset=function($d,$t,$l){this.elements[0]=$d,this.elements[1]=$t,this.elements[2]=$l;},$Y(0,$d,"x",function(){return this.elements[0];},function($d){this.elements[0]=$d;}),$Y(0,$d,"y",function(){return this.elements[1];},function($d){this.elements[1]=$d;}),$Y(0,$d,"z",function(){return this.elements[2];},function($d){this.elements[2]=$d;}),$b.distanceSquared=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0]-$k[0],$i=$l[1]-$k[1],$A=$l[2]-$k[2];return $W*$W+$i*$i+$A*$A;},$b.distance=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0]-$k[0],$i=$l[1]-$k[1],$A=$l[2]-$k[2];return Math.sqrt($W*$W+$i*$i+$A*$A);},$b.min=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=Math.min($W[0],$i[0]),$k[1]=Math.min($W[1],$i[1]),$k[2]=Math.min($W[2],$i[2]);},$b.max=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=Math.max($W[0],$i[0]),$k[1]=Math.max($W[1],$i[1]),$k[2]=Math.max($W[2],$i[2]);},$b.transformQuat=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements,$A=$W[0],$B=$W[1],$o=$W[2],$I=$i[0],$b=$i[1],$f=$i[2],$J=$i[3],$c=$J*$A+$b*$o-$f*$B,$Y=$J*$B+$f*$A-$I*$o,$w=$J*$o+$I*$B-$b*$A,$D=-$I*$A-$b*$B-$f*$o;$k[0]=$c*$J+$D*-$I+$Y*-$f-$w*-$b,$k[1]=$Y*$J+$D*-$b+$w*-$I-$c*-$f,$k[2]=$w*$J+$D*-$f+$c*-$b-$Y*-$I;},$b.scalarLength=function($d){var $t=$d.elements,$l=$t[0],$k=$t[1],$W=$t[2];return Math.sqrt($l*$l+$k*$k+$W*$W);},$b.scalarLengthSquared=function($d){var $t=$d.elements,$l=$t[0],$k=$t[1],$W=$t[2];return $l*$l+$k*$k+$W*$W;},$b.normalize=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0],$i=$l[1],$A=$l[2],$B=$W*$W+$i*$i+$A*$A;0<$B&&($B=1/Math.sqrt($B),$k[0]=$l[0]*$B,$k[1]=$l[1]*$B,$k[2]=$l[2]*$B);},$b.multiply=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]*$i[0],$k[1]=$W[1]*$i[1],$k[2]=$W[2]*$i[2];},$b.scale=function($d,$t,$l){var $k=$l.elements,$W=$d.elements;$k[0]=$W[0]*$t,$k[1]=$W[1]*$t,$k[2]=$W[2]*$t;},$b.lerp=function($d,$t,$l,$k){var $W=$k.elements,$i=$d.elements,$A=$t.elements,$B=$i[0],$o=$i[1],$I=$i[2];$W[0]=$B+$l*($A[0]-$B),$W[1]=$o+$l*($A[1]-$o),$W[2]=$I+$l*($A[2]-$I);},$b.transformV3ToV3=function($d,$t,$l){var $k=$b._tempVector4;$b.transformV3ToV4($d,$t,$k);var $W=$k.elements,$i=$l.elements;$i[0]=$W[0],$i[1]=$W[1],$i[2]=$W[2];},$b.transformV3ToV4=function($d,$t,$l){var $k=$d.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=$t.elements,$o=$l.elements;$o[0]=$W*$B[0]+$i*$B[4]+$A*$B[8]+$B[12],$o[1]=$W*$B[1]+$i*$B[5]+$A*$B[9]+$B[13],$o[2]=$W*$B[2]+$i*$B[6]+$A*$B[10]+$B[14],$o[3]=$W*$B[3]+$i*$B[7]+$A*$B[11]+$B[15];},$b.TransformNormal=function($d,$t,$l){var $k=$d.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=$t.elements,$o=$l.elements;$o[0]=$W*$B[0]+$i*$B[4]+$A*$B[8],$o[1]=$W*$B[1]+$i*$B[5]+$A*$B[9],$o[2]=$W*$B[2]+$i*$B[6]+$A*$B[10];},$b.transformCoordinate=function($d,$t,$l){var $k=$b._tempVector4.elements,$W=$d.elements,$i=$W[0],$A=$W[1],$B=$W[2],$o=$t.elements;$k[0]=$i*$o[0]+$A*$o[4]+$B*$o[8]+$o[12],$k[1]=$i*$o[1]+$A*$o[5]+$B*$o[9]+$o[13],$k[2]=$i*$o[2]+$A*$o[6]+$B*$o[10]+$o[14],$k[3]=1/($i*$o[3]+$A*$o[7]+$B*$o[11]+$o[15]);var $I=$l.elements;$I[0]=$k[0]*$k[3],$I[1]=$k[1]*$k[3],$I[2]=$k[2]*$k[3];},$b.Clamp=function($d,$t,$l,$k){var $W=$d.elements,$i=$W[0],$A=$W[1],$B=$W[2],$o=$t.elements,$I=$o[0],$b=$o[1],$f=$o[2],$J=$l.elements,$c=$J[0],$Y=$J[1],$w=$J[2],$D=$k.elements;$i=($i=$c<$i?$c:$i)<$I?$I:$i,$A=($A=$Y<$A?$Y:$A)<$b?$b:$A,$B=($B=$w<$B?$w:$B)<$f?$f:$B,$D[0]=$i,$D[1]=$A,$D[2]=$B;},$b.add=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]+$i[0],$k[1]=$W[1]+$i[1],$k[2]=$W[2]+$i[2];},$b.subtract=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]-$i[0],$k[1]=$W[1]-$i[1],$k[2]=$W[2]-$i[2];},$b.cross=function($d,$t,$l){var $k=$d.elements,$W=$t.elements,$i=$l.elements,$A=$k[0],$B=$k[1],$o=$k[2],$I=$W[0],$b=$W[1],$f=$W[2];$i[0]=$B*$f-$o*$b,$i[1]=$o*$I-$A*$f,$i[2]=$A*$b-$B*$I;},$b.dot=function($d,$t){var $l=$d.elements,$k=$t.elements;return $l[0]*$k[0]+$l[1]*$k[1]+$l[2]*$k[2];},$b.equals=function($d,$t){var $l=$d.elements,$k=$t.elements;return $_d.nearEqual(Math.abs($l[0]),Math.abs($k[0]))&&$_d.nearEqual(Math.abs($l[1]),Math.abs($k[1]))&&$_d.nearEqual(Math.abs($l[2]),Math.abs($k[2]));},$b.ZERO=new $b(0,0,0),$b.ONE=new $b(1,1,1),$b.NegativeUnitX=new $b(-1,0,0),$b.UnitX=new $b(1,0,0),$b.UnitY=new $b(0,1,0),$b.UnitZ=new $b(0,0,1),$b.ForwardRH=new $b(0,0,-1),$b.ForwardLH=new $b(0,0,1),$b.Up=new $b(0,1,0),$b.NAN=new $b(NaN,NaN,NaN),$f($b,["_tempVector4",function(){return this._tempVector4=new $Bt();}]),$b;}(),$Bt=function(){function $d($d,$t,$l,$k){this.elements=new Float32Array(4),void 0===$d&&($d=0),void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=0);var $W=this.elements;$W[0]=$d,$W[1]=$t,$W[2]=$l,$W[3]=$k;}$c($d,"laya.d3.math.Vector4");var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.IClone":!0}),$t.fromArray=function($d,$t){void 0===$t&&($t=0),this.elements[0]=$d[$t+0],this.elements[1]=$d[$t+1],this.elements[2]=$d[$t+2],this.elements[3]=$d[$t+3];},$t.cloneTo=function($d){var $t=$d.elements,$l=this.elements;$t[0]=$l[0],$t[1]=$l[1],$t[2]=$l[2],$t[3]=$l[3];},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);},$t.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;},$Y(0,$t,"x",function(){return this.elements[0];},function($d){this.elements[0]=$d;}),$Y(0,$t,"y",function(){return this.elements[1];},function($d){this.elements[1]=$d;}),$Y(0,$t,"z",function(){return this.elements[2];},function($d){this.elements[2]=$d;}),$Y(0,$t,"w",function(){return this.elements[3];},function($d){this.elements[3]=$d;}),$d.lerp=function($d,$t,$l,$k){var $W=$k.elements,$i=$d.elements,$A=$t.elements,$B=$i[0],$o=$i[1],$I=$i[2],$b=$i[3];$W[0]=$B+$l*($A[0]-$B),$W[1]=$o+$l*($A[1]-$o),$W[2]=$I+$l*($A[2]-$I),$W[3]=$b+$l*($A[3]-$b);},$d.transformByM4x4=function($d,$t,$l){var $k=$d.elements,$W=$k[0],$i=$k[1],$A=$k[2],$B=$k[3],$o=$t.elements,$I=$l.elements;$I[0]=$W*$o[0]+$i*$o[4]+$A*$o[8]+$B*$o[12],$I[1]=$W*$o[1]+$i*$o[5]+$A*$o[9]+$B*$o[13],$I[2]=$W*$o[2]+$i*$o[6]+$A*$o[10]+$B*$o[14],$I[3]=$W*$o[3]+$i*$o[7]+$A*$o[11]+$B*$o[15];},$d.equals=function($d,$t){var $l=$d.elements,$k=$t.elements;return $_d.nearEqual(Math.abs($l[0]),Math.abs($k[0]))&&$_d.nearEqual(Math.abs($l[1]),Math.abs($k[1]))&&$_d.nearEqual(Math.abs($l[2]),Math.abs($k[2]))&&$_d.nearEqual(Math.abs($l[3]),Math.abs($k[3]));},$d.normalize=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$d.length();0<$W&&($k[0]=$l[0]*$W,$k[1]=$l[1]*$W,$k[2]=$l[2]*$W,$k[3]=$l[3]*$W);},$d.add=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]+$i[0],$k[1]=$W[1]+$i[1],$k[2]=$W[2]+$i[2],$k[3]=$W[3]+$i[3];},$d.subtract=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]-$i[0],$k[1]=$W[1]-$i[1],$k[2]=$W[2]-$i[2],$k[3]=$W[3]-$i[3];},$d.multiply=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=$W[0]*$i[0],$k[1]=$W[1]*$i[1],$k[2]=$W[2]*$i[2],$k[3]=$W[3]*$i[3];},$d.scale=function($d,$t,$l){var $k=$l.elements,$W=$d.elements;$k[0]=$W[0]*$t,$k[1]=$W[1]*$t,$k[2]=$W[2]*$t,$k[3]=$W[3]*$t;},$d.Clamp=function($d,$t,$l,$k){var $W=$d.elements,$i=$W[0],$A=$W[1],$B=$W[2],$o=$W[3],$I=$t.elements,$b=$I[0],$f=$I[1],$J=$I[2],$c=$I[3],$Y=$l.elements,$w=$Y[0],$D=$Y[1],$z=$Y[2],$e=$Y[3],$g=$k.elements;$i=($i=$w<$i?$w:$i)<$b?$b:$i,$A=($A=$D<$A?$D:$A)<$f?$f:$A,$B=($B=$z<$B?$z:$B)<$J?$J:$B,$o=($o=$e<$o?$e:$o)<$c?$c:$o,$g[0]=$i,$g[1]=$A,$g[2]=$B,$g[3]=$o;},$d.distanceSquared=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0]-$k[0],$i=$l[1]-$k[1],$A=$l[2]-$k[2],$B=$l[3]-$k[3];return $W*$W+$i*$i+$A*$A+$B*$B;},$d.distance=function($d,$t){var $l=$d.elements,$k=$t.elements,$W=$l[0]-$k[0],$i=$l[1]-$k[1],$A=$l[2]-$k[2],$B=$l[3]-$k[3];return Math.sqrt($W*$W+$i*$i+$A*$A+$B*$B);},$d.dot=function($d,$t){var $l=$d.elements,$k=$t.elements;return $l[0]*$k[0]+$l[1]*$k[1]+$l[2]*$k[2]+$l[3]*$k[3];},$d.min=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=Math.min($W[0],$i[0]),$k[1]=Math.min($W[1],$i[1]),$k[2]=Math.min($W[2],$i[2]),$k[3]=Math.min($W[3],$i[3]);},$d.max=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t.elements;$k[0]=Math.max($W[0],$i[0]),$k[1]=Math.max($W[1],$i[1]),$k[2]=Math.max($W[2],$i[2]),$k[3]=Math.max($W[3],$i[3]);},$f($d,["ZERO",function(){return this.ZERO=new $d();},"ONE",function(){return this.ONE=new $d(1,1,1,1);},"UnitX",function(){return this.UnitX=new $d(1,0,0,0);},"UnitY",function(){return this.UnitY=new $d(0,1,0,0);},"UnitZ",function(){return this.UnitZ=new $d(0,0,1,0);},"UnitW",function(){return this.UnitW=new $d(0,0,0,1);}]),$d;}(),$ot=function(){function $i($d,$t,$l,$k){this.minDepth=0,this.maxDepth=1,this.x=$d,this.y=$t,this.width=$l,this.height=$k;}$c($i,"laya.d3.math.Viewport");var $d=$i.prototype;return $d.project=function($d,$t,$l){$At.transformV3ToV3($d,$t,$l);var $k=$d.elements,$W=$t.elements,$i=$l.elements,$A=$k[0]*$W[3]+$k[1]*$W[7]+$k[2]*$W[11]+$W[15];1!==$A&&($i[0]=$i[0]/$A,$i[1]=$i[1]/$A,$i[2]=$i[2]/$A),$i[0]=.5*($i[0]+1)*this.width+this.x,$i[1]=.5*(1-$i[1])*this.height+this.y,$i[2]=$i[2]*(this.maxDepth-this.minDepth)+this.minDepth;},$d.unprojectFromMat=function($d,$t,$l){var $k=$d.elements,$W=$t.elements,$i=$l.elements;$i[0]=($k[0]-this.x)/this.width*2-1,$i[1]=-(($k[1]-this.y)/this.height*2-1);var $A=(this.maxDepth-this.minDepth)/2;$i[2]=($k[2]-this.minDepth-$A)/$A;var $B=$i[0]*$W[3]+$i[1]*$W[7]+$i[2]*$W[11]+$W[15];$At.transformV3ToV3($l,$t,$l),1!==$B&&($i[0]=$i[0]/$B,$i[1]=$i[1]/$B,$i[2]=$i[2]/$B);},$d.unprojectFromWVP=function($d,$t,$l,$k,$W){$dt.multiply($t,$l,$i._tempMatrix4x4),$k&&$dt.multiply($i._tempMatrix4x4,$k,$i._tempMatrix4x4),$i._tempMatrix4x4.invert($i._tempMatrix4x4),this.unprojectFromMat($d,$i._tempMatrix4x4,$W);},$f($i,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $dt();}]),$i;}(),$It=function(){function $T($d){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$d,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[];}$c($T,"laya.d3.resource.models.SubMesh");var $d=$T.prototype;return $R.imps($d,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$d._getVertexBuffer=function($d){return void 0===$d&&($d=0),0===$d?this._vertexBuffer:null;},$d._getIndexBuffer=function(){return this._indexBuffer;},$d._getStaticBatchBakedVertexs=function($d,$t){var $l,$k,$W=this._vertexBuffer,$i=$W.vertexDeclaration,$A=$i.getVertexElementByUsage(0).offset/4,$B=$i.getVertexElementByUsage(3).offset/4,$o=$t.meshRender.lightmapScaleOffset,$I=0,$b=0,$f=0,$J=0,$c=0,$Y=0;if($o){if($k=$i.getVertexElementByUsage(15))$f=$i.vertexStride/4,$l=0<this._vertexCount?$W.getData().slice(this._vertexStart*$f,(this._vertexStart+this._vertexCount)*$f):$W.getData().slice(),$J=$k.offset/4;else{$f=($Y=$i.vertexStride/4)+2,$l=this._vertexCount?new Float32Array(this._vertexCount*($W.vertexDeclaration.vertexStride/4+2)):new Float32Array($W.vertexCount*($W.vertexDeclaration.vertexStride/4+2)),$J=($c=$i.getVertexElementByUsage(2).offset/4)+2;var $w=$W.getData();for($I=0,$b=$w.length/$Y;$I<$b;$I++){var $D=0;$D=0<this._vertexCount?(this._vertexStart+$I)*$Y:$I*$Y;var $z=$I*$f,$e=0;for($e=0;$e<$J;$e++)$l[$z+$e]=$w[$D+$e];for($e=$J;$e<$Y;$e++)$l[$z+$e+2]=$w[$D+$e];}}}else $f=$i.vertexStride/4,$l=this._vertexCount?$W.getData().slice(this._vertexStart*$f,(this._vertexStart+this._vertexCount)*$f):$W.getData().slice();if($d){var $g=$d.worldMatrix,$H=$T._tempMatrix4x40;$g.invert($H);var $R=$T._tempMatrix4x41,$G=$t.transform.worldMatrix;$dt.multiply($H,$G,$R);}else $R=$t.transform.worldMatrix;var $q=$T._tempQuaternion0;for($R.decomposeTransRotScale($T._tempVector30,$q,$T._tempVector31),$I=0,$b=$l.length/$f;$I<$b;$I++){var $L=$I*$f+$A,$$=$I*$f+$B;if($Dt.transformVector3ArrayToVector3ArrayCoordinate($l,$L,$R,$l,$L),$Dt.transformVector3ArrayByQuat($l,$$,$q,$l,$$),$o){var $p=$I*$f+$J;if($k)$Dt.transformLightingMapTexcoordByUV1Array($l,$p,$o,$l,$p);else{var $M=$I*$Y+$c;$Dt.transformLightingMapTexcoordByUV0Array($w,$M,$o,$l,$p);}}}return $l;},$d._getVertexBuffers=function(){return null;},$d._beforeRender=function($d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$d._render=function($d){var $t,$l=0,$k=$d.renderElement;if(1<this._indexCount){var $W=this._boneIndicesList.length;if(1<$W){for(var $i=0;$i<$W;$i++)($t=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$t[$i]),$d._shader.uploadRenderElementUniforms($k._shaderValue.data)),$r.mainContext.drawElements(4,this._subIndexBufferCount[$i],5123,2*this._subIndexBufferStart[$i]);$L.drawCall+=$W;}else($t=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$t[0]),$d._shader.uploadRenderElementUniforms($k._shaderValue.data)),$r.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$L.drawCall++;$l=this._indexCount;}else $l=this._indexBuffer.indexCount,($t=$k._skinAnimationDatas||this._skinAnimationDatas)&&($k._shaderValue.setValue(0,$t[0]),$d._shader.uploadRenderElementUniforms($k._shaderValue.data)),$r.mainContext.drawElements(4,$l,5123,0),$L.drawCall++;$L.trianglesFaces+=$l/3;},$d.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData();},$d.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null;},$Y(0,$d,"_vertexBufferCount",function(){return 1;}),$Y(0,$d,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$f($T,["_tempVector30",function(){return this._tempVector30=new $At();},"_tempVector31",function(){return this._tempVector31=new $At();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $lt();},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $dt();},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $dt();}]),$T;}(),$bt=function(){function $d($d){this.defineCounter=0,this.defines=null,$d?(this.defineCounter=$d.defineCounter,this.defines=$d.defines.slice()):(this.defineCounter=0,this.defines=[]);}return $c($d,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$d.prototype.registerDefine=function($d){var $t=Math.pow(2,this.defineCounter++);return this.defines[$t]=$d,$t;},$d;}(),$ft=function(){function $d(){}return $c($d,"laya.d3.shader.ShaderInit3D"),$d.__init__=function(){var $d,$t;$Lt._globalRegDefine("HIGHPRECISION",$Lt.SHADERDEFINE_HIGHPRECISION),$Lt._globalRegDefine("FOG",$Lt.SHADERDEFINE_FOG),$Lt._globalRegDefine("DIRECTIONLIGHT",$Lt.SHADERDEFINE_DIRECTIONLIGHT),$Lt._globalRegDefine("POINTLIGHT",$Lt.SHADERDEFINE_POINTLIGHT),$Lt._globalRegDefine("SPOTLIGHT",$Lt.SHADERDEFINE_SPOTLIGHT),$Lt._globalRegDefine("UV",$Lt.SHADERDEFINE_UV0),$Lt._globalRegDefine("COLOR",$Lt.SHADERDEFINE_COLOR),$Lt._globalRegDefine("UV1",$Lt.SHADERDEFINE_UV1),$Lt._globalRegDefine("CASTSHADOW",$ct.SHADERDEFINE_CAST_SHADOW),$Lt._globalRegDefine("SHADOWMAP_PSSM1",$ct.SHADERDEFINE_SHADOW_PSSM1),$Lt._globalRegDefine("SHADOWMAP_PSSM2",$ct.SHADERDEFINE_SHADOW_PSSM2),$Lt._globalRegDefine("SHADOWMAP_PSSM3",$ct.SHADERDEFINE_SHADOW_PSSM3),$Lt._globalRegDefine("SHADOWMAP_PCF_NO",$ct.SHADERDEFINE_SHADOW_PCF_NO),$Lt._globalRegDefine("SHADOWMAP_PCF1",$ct.SHADERDEFINE_SHADOW_PCF1),$Lt._globalRegDefine("SHADOWMAP_PCF2",$ct.SHADERDEFINE_SHADOW_PCF2),$Lt._globalRegDefine("SHADOWMAP_PCF3",$ct.SHADERDEFINE_SHADOW_PCF3),$Lt._globalRegDefine("DEPTHFOG",$Lt.SAHDERDEFINE_DEPTHFOG),$nt.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$nt.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$d={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$t={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $l=$nt.nameKey.add("SIMPLE");shaderCompile=$Lt.add($l,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$d,$t),$Qt.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$Qt.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$Qt.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$Qt.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$Qt.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$Qt.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$Qt.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$Qt.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$Qt.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG");},$d;}(),$Jt=function(){function $d(){this._data=null,this._data=[];}$c($d,"laya.d3.shader.ValusArray");var $t=$d.prototype;return $t.setValue=function($d,$t){this._data[$d]=$t;},$Y(0,$t,"data",function(){return this._data;}),$d;}(),$ct=function(){function $d(){}return $d.SHADERDEFINE_RECEIVE_SHADOW=1,$d.SHADERDEFINE_CAST_SHADOW=512,$d.SHADERDEFINE_SHADOW_PSSM1=1024,$d.SHADERDEFINE_SHADOW_PSSM2=2048,$d.SHADERDEFINE_SHADOW_PSSM3=4096,$d.SHADERDEFINE_SHADOW_PCF_NO=8192,$d.SHADERDEFINE_SHADOW_PCF1=16384,$d.SHADERDEFINE_SHADOW_PCF2=32768,$d.SHADERDEFINE_SHADOW_PCF3=65536,$d.MAX_PSSM_COUNT=3,$d;}(),$Yt=function(){function $X(){}return $c($X,"laya.d3.utils.Picker"),$X.calculateCursorRay=function($d,$t,$l,$k,$W,$i){var $A=$d.elements[0],$B=$d.elements[1],$o=$X._tempVector30,$I=$o.elements;$I[0]=$A,$I[1]=$B,$I[2]=$t.minDepth;var $b=$X._tempVector31,$f=$b.elements;$f[0]=$A,$f[1]=$B,$f[2]=$t.maxDepth;var $J=$i.origin,$c=$X._tempVector32;$t.unprojectFromWVP($o,$l,$k,$W,$J),$t.unprojectFromWVP($b,$l,$k,$W,$c);var $Y=$i.direction.elements;$Y[0]=$c.x-$J.x,$Y[1]=$c.y-$J.y,$Y[2]=$c.z-$J.z,$At.normalize($i.direction,$i.direction);},$X.rayIntersectsPositionsAndIndices=function($d,$t,$l,$k,$W){for(var $i=$l.vertexStride/4,$A=$l.getVertexElementByUsage(0).offset/4,$B=Number.MAX_VALUE,$o=-1,$I=-1,$b=-1,$f=0;$f<$k.length;$f+=3){var $J=$X._tempVector35,$c=$J.elements,$Y=$k[$f]*$i,$w=$Y+$A;$c[0]=$t[$w],$c[1]=$t[1+$w],$c[2]=$t[2+$w];var $D=$X._tempVector36,$z=$D.elements,$e=$k[$f+1]*$i,$g=$e+$A;$z[0]=$t[$g],$z[1]=$t[1+$g],$z[2]=$t[2+$g];var $H=$X._tempVector37,$R=$H.elements,$G=$k[$f+2]*$i,$q=$G+$A;$R[0]=$t[$q],$R[1]=$t[1+$q],$R[2]=$t[2+$q];var $L=laya.d3.utils.Picker.rayIntersectsTriangle($d,$J,$D,$H);!isNaN($L)&&$L<$B&&($B=$L,$o=$Y,$I=$e,$b=$G);}if($B===Number.MAX_VALUE)return $W.position.toDefault(),$W.distance=Number.MAX_VALUE,$W.trianglePositions[0].toDefault(),$W.trianglePositions[1].toDefault(),$W.trianglePositions[2].toDefault(),$W.triangleNormals[0].toDefault(),$W.triangleNormals[1].toDefault(),$W.triangleNormals[2].toDefault(),!1;$W.distance=$B,$At.scale($d.direction,$B,$W.position),$At.add($d.origin,$W.position,$W.position);var $$=$W.trianglePositions,$p=$$[0],$M=$$[1],$T=$$[2],$r=$p.elements,$S=$M.elements,$j=$T.elements,$C=$o+$A;$r[0]=$t[$C],$r[1]=$t[$C+1],$r[2]=$t[$C+2];var $K=$I+$A;$S[0]=$t[$K],$S[1]=$t[$K+1],$S[2]=$t[$K+2];var $x=$b+$A;$j[0]=$t[$x],$j[1]=$t[$x+1],$j[2]=$t[$x+2];var $n=$l.getVertexElementByUsage(3);if($n){var $Q=$n.offset/4,$y=$W.triangleNormals,$V=$y[0],$Z=$y[1],$U=$y[2],$E=$V.elements,$N=$Z.elements,$u=$U.elements,$h=$o+$Q;$E[0]=$t[$h],$E[1]=$t[$h+1],$E[2]=$t[$h+2];var $s=$I+$Q;$N[0]=$t[$s],$N[1]=$t[$s+1],$N[2]=$t[$s+2];var $P=$b+$Q;$u[0]=$t[$P],$u[1]=$t[$P+1],$u[2]=$t[$P+2];}return!0;},$X.rayIntersectsTriangle=function($d,$t,$l,$k){var $W=$X._tempVector30,$i=$X._tempVector31;$At.subtract($l,$t,$W),$At.subtract($k,$t,$i);var $A,$B=$X._tempVector32;if($At.cross($d.direction,$i,$B),($A=$At.dot($W,$B))>-Number.MIN_VALUE&&$A<Number.MIN_VALUE)return Number.NaN;var $o,$I=1/$A,$b=$X._tempVector33;if($At.subtract($d.origin,$t,$b),$o=$At.dot($b,$B),($o*=$I)<0||1<$o)return Number.NaN;var $f,$J,$c=$X._tempVector34;return $At.cross($b,$W,$c),$f=$At.dot($d.direction,$c),($f*=$I)<0||1<$o+$f?Number.NaN:($J=$At.dot($i,$c),($J*=$I)<0?Number.NaN:$J);},$f($X,["_tempVector30",function(){return this._tempVector30=new $At();},"_tempVector31",function(){return this._tempVector31=new $At();},"_tempVector32",function(){return this._tempVector32=new $At();},"_tempVector33",function(){return this._tempVector33=new $At();},"_tempVector34",function(){return this._tempVector34=new $At();},"_tempVector35",function(){return this._tempVector35=new $At();},"_tempVector36",function(){return this._tempVector36=new $At();},"_tempVector37",function(){return this._tempVector37=new $At();}]),$X;}(),$wt=(function(){function $d(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $At(),new $At(),new $At()],this.trianglePositions.length=3,this.triangleNormals=[new $At(),new $At(),new $At()],this.triangleNormals.length=3,this.position=new $At();}$c($d,"laya.d3.utils.RaycastHit"),$d.prototype.cloneTo=function($d){$d.distance=this.distance,this.trianglePositions[0].cloneTo($d.trianglePositions[0]),this.trianglePositions[1].cloneTo($d.trianglePositions[1]),this.trianglePositions[2].cloneTo($d.trianglePositions[2]),this.triangleNormals[0].cloneTo($d.triangleNormals[0]),this.triangleNormals[1].cloneTo($d.triangleNormals[1]),this.triangleNormals[2].cloneTo($d.triangleNormals[2]),this.position.cloneTo($d.position),$d.sprite3D=this.sprite3D;};}(),function(){function $d($d,$t){this._width=0,this._height=0,this._width=$d,this._height=$t;}$c($d,"laya.d3.utils.Size");var $t=$d.prototype;return $Y(0,$t,"width",function(){return-1===this._width?$m.clientWidth:this._width;}),$Y(0,$t,"height",function(){return-1===this._height?$m.clientHeight:this._height;}),$Y(1,$d,"fullScreen",function(){return new $d(-1,-1);}),$d;}()),$Dt=function(){function $C(){}return $c($C,"laya.d3.utils.Utils3D"),$C._rotationTransformScaleSkinAnimation=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f){var $J,$c,$Y,$w,$D,$z=$C._tempArray16_0,$e=$C._tempArray16_1,$g=$C._tempArray16_2,$H=$k+$k,$R=$W+$W,$G=$i+$i,$q=$k*$H,$L=$W*$H,$$=$W*$R,$p=$i*$H,$M=$i*$R,$T=$i*$G,$r=$A*$H,$S=$A*$R,$j=$A*$G;for($z[15]=1,$z[0]=1-$$-$T,$z[1]=$L+$j,$z[2]=$p-$S,$z[4]=$L-$j,$z[5]=1-$q-$T,$z[6]=$M+$r,$z[8]=$p+$S,$z[9]=$M-$r,$z[10]=1-$q-$$,$e[15]=1,$e[0]=$B,$e[5]=$o,$e[10]=$I,$J=0;$J<4;$J++)$c=$z[$J],$Y=$z[$J+4],$w=$z[$J+8],$D=$z[$J+12],$g[$J]=$c,$g[$J+4]=$Y,$g[$J+8]=$w,$g[$J+12]=$c*$d+$Y*$t+$w*$l+$D;for($J=0;$J<4;$J++)$c=$g[$J],$Y=$g[$J+4],$w=$g[$J+8],$D=$g[$J+12],$b[$J+$f]=$c*$e[0]+$Y*$e[1]+$w*$e[2]+$D*$e[3],$b[$J+$f+4]=$c*$e[4]+$Y*$e[5]+$w*$e[6]+$D*$e[7],$b[$J+$f+8]=$c*$e[8]+$Y*$e[9]+$w*$e[10]+$D*$e[11],$b[$J+$f+12]=$c*$e[12]+$Y*$e[13]+$w*$e[14]+$D*$e[15];},$C._createNodeByJson=function($d,$t,$l,$k){if(!$l)switch($t.type){case"Sprite3D":$l=new $xt();break;case"MeshSprite3D":$l=new $Xt();break;case"SkinnedMeshSprite3D":$l=new SkinnedMeshSprite3D();break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$l=new ShuriKenParticle3D();break;case"TrailSprite3D":$l=new TrailSprite3D();break;case"Terrain":$l=new Terrain();break;case"Camera":$l=new $Pt();break;case"DirectionLight":$l=new DirectionLight();break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.");}var $W=$t.props;if($W)for(var $i in $W)$l[$i]=$W[$i];var $A=$t.customProps;$A&&($l instanceof laya.d3.core.Sprite3D?($l._parseBaseCustomProps($A),$l._parseCustomProps($d,$k,$A,$t),$l._parseCustomComponent($d,$k,$t.components)):$l._parseCustomProps($d,$k,$A,$t));var $B=$t.child;if($B)for(var $o=0,$I=$B.length;$o<$I;$o++){var $b=$C._createNodeByJson($d,$B[$o],null,$k);$l.addChild($b);}return $l;},$C._computeBoneAndAnimationDatasByBindPoseMatrxix=function($d,$t,$l,$k,$W,$i){var $A,$B,$o=0,$I=0,$b=$d.length;for($A=0;$A<$b;$o+=$d[$A].keyframeWidth,$I+=16,$A++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($t[$o+0],$t[$o+1],$t[$o+2],$t[$o+3],$t[$o+4],$t[$o+5],$t[$o+6],$t[$o+7],$t[$o+8],$t[$o+9],$k,$I),0!=$A&&($B=16*$d[$A].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($k,$B,$k,$I,$k,$I));var $f=$l.length;for($A=0;$A<$f;$A++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($k,16*$i[$A],$l[$A],$W,16*$A);},$C._computeAnimationDatasByArrayAndMatrixFast=function($d,$t,$l,$k){for(var $W=0,$i=$d.length;$W<$i;$W++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($t,16*$k[$W],$d[$W],$l,16*$W);},$C._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($d,$t,$l,$k,$W){var $i,$A,$B=0,$o=0,$I=$d.length;for($i=0;$i<$I;$B+=$d[$i].keyframeWidth,$o+=16,$i++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($t[$B+7],$t[$B+8],$t[$B+9],$t[$B+3],$t[$B+4],$t[$B+5],$t[$B+6],$t[$B+0],$t[$B+1],$t[$B+2],$k,$o),0!=$i&&($A=16*$d[$i].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($k,$A,$k,$o,$k,$o));var $b=$l.length;for($i=0;$i<$b;$i++){var $f=16*$i;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($k,$f,$l[$i],$W,$f);}},$C._computeAnimationDatasByArrayAndMatrixFastOld=function($d,$t,$l){for(var $k=$d.length,$W=0;$W<$k;$W++){var $i=16*$W;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($t,$i,$d[$W],$l,$i);}},$C._computeRootAnimationData=function($d,$t,$l){for(var $k=0,$W=0,$i=0,$A=$d.length;$k<$A;$W+=$d[$k].keyframeWidth,$i+=16,$k++)laya.d3.utils.Utils3D.createAffineTransformationArray($t[$W+0],$t[$W+1],$t[$W+2],$t[$W+3],$t[$W+4],$t[$W+5],$t[$W+6],$t[$W+7],$t[$W+8],$t[$W+9],$l,$i);},$C.transformVector3ArrayByQuat=function($d,$t,$l,$k,$W){var $i=$l.elements,$A=$d[$t],$B=$d[$t+1],$o=$d[$t+2],$I=$i[0],$b=$i[1],$f=$i[2],$J=$i[3],$c=$J*$A+$b*$o-$f*$B,$Y=$J*$B+$f*$A-$I*$o,$w=$J*$o+$I*$B-$b*$A,$D=-$I*$A-$b*$B-$f*$o;$k[$W]=$c*$J+$D*-$I+$Y*-$f-$w*-$b,$k[$W+1]=$Y*$J+$D*-$b+$w*-$I-$c*-$f,$k[$W+2]=$w*$J+$D*-$f+$c*-$b-$Y*-$I;},$C.mulMatrixByArray=function($d,$t,$l,$k,$W,$i){var $A,$B,$o,$I,$b;if($W===$l){for($l=$C._tempArray16_3,$A=0;$A<16;++$A)$l[$A]=$W[$i+$A];$k=0;}for($A=0;$A<4;$A++)$B=$d[$t+$A],$o=$d[$t+$A+4],$I=$d[$t+$A+8],$b=$d[$t+$A+12],$W[$i+$A]=$B*$l[$k+0]+$o*$l[$k+1]+$I*$l[$k+2]+$b*$l[$k+3],$W[$i+$A+4]=$B*$l[$k+4]+$o*$l[$k+5]+$I*$l[$k+6]+$b*$l[$k+7],$W[$i+$A+8]=$B*$l[$k+8]+$o*$l[$k+9]+$I*$l[$k+10]+$b*$l[$k+11],$W[$i+$A+12]=$B*$l[$k+12]+$o*$l[$k+13]+$I*$l[$k+14]+$b*$l[$k+15];},$C.mulMatrixByArrayFast=function($d,$t,$l,$k,$W,$i){var $A,$B,$o,$I,$b;for($A=0;$A<4;$A++)$B=$d[$t+$A],$o=$d[$t+$A+4],$I=$d[$t+$A+8],$b=$d[$t+$A+12],$W[$i+$A]=$B*$l[$k+0]+$o*$l[$k+1]+$I*$l[$k+2]+$b*$l[$k+3],$W[$i+$A+4]=$B*$l[$k+4]+$o*$l[$k+5]+$I*$l[$k+6]+$b*$l[$k+7],$W[$i+$A+8]=$B*$l[$k+8]+$o*$l[$k+9]+$I*$l[$k+10]+$b*$l[$k+11],$W[$i+$A+12]=$B*$l[$k+12]+$o*$l[$k+13]+$I*$l[$k+14]+$b*$l[$k+15];},$C.mulMatrixByArrayAndMatrixFast=function($d,$t,$l,$k,$W){var $i,$A,$B,$o,$I,$b=$l.elements,$f=$b[0],$J=$b[1],$c=$b[2],$Y=$b[3],$w=$b[4],$D=$b[5],$z=$b[6],$e=$b[7],$g=$b[8],$H=$b[9],$R=$b[10],$G=$b[11],$q=$b[12],$L=$b[13],$$=$b[14],$p=$b[15],$M=$t,$T=$t+4,$r=$t+8,$S=$t+12,$j=$W,$C=$W+4,$K=$W+8,$x=$W+12;for($i=0;$i<4;$i++)$A=$d[$M+$i],$B=$d[$T+$i],$o=$d[$r+$i],$I=$d[$S+$i],$k[$j+$i]=$A*$f+$B*$J+$o*$c+$I*$Y,$k[$C+$i]=$A*$w+$B*$D+$o*$z+$I*$e,$k[$K+$i]=$A*$g+$B*$H+$o*$R+$I*$G,$k[$x+$i]=$A*$q+$B*$L+$o*$$+$I*$p;},$C.createAffineTransformationArray=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f){var $J=$k+$k,$c=$W+$W,$Y=$i+$i,$w=$k*$J,$D=$k*$c,$z=$k*$Y,$e=$W*$c,$g=$W*$Y,$H=$i*$Y,$R=$A*$J,$G=$A*$c,$q=$A*$Y;$b[$f+0]=(1-($e+$H))*$B,$b[$f+1]=($D+$q)*$B,$b[$f+2]=($z-$G)*$B,$b[$f+3]=0,$b[$f+4]=($D-$q)*$o,$b[$f+5]=(1-($w+$H))*$o,$b[$f+6]=($g+$R)*$o,$b[$f+7]=0,$b[$f+8]=($z+$G)*$I,$b[$f+9]=($g-$R)*$I,$b[$f+10]=(1-($w+$e))*$I,$b[$f+11]=0,$b[$f+12]=$d,$b[$f+13]=$t,$b[$f+14]=$l,$b[$f+15]=1;},$C.transformVector3ArrayToVector3ArrayCoordinate=function($d,$t,$l,$k,$W){var $i=$C._tempArray4_0,$A=$d[$t+0],$B=$d[$t+1],$o=$d[$t+2],$I=$l.elements;$i[0]=$A*$I[0]+$B*$I[4]+$o*$I[8]+$I[12],$i[1]=$A*$I[1]+$B*$I[5]+$o*$I[9]+$I[13],$i[2]=$A*$I[2]+$B*$I[6]+$o*$I[10]+$I[14],$i[3]=1/($A*$I[3]+$B*$I[7]+$o*$I[11]+$I[15]),$k[$W+0]=$i[0]*$i[3],$k[$W+1]=$i[1]*$i[3],$k[$W+2]=$i[2]*$i[3];},$C.transformLightingMapTexcoordByUV0Array=function($d,$t,$l,$k,$W){var $i=$l.elements;$k[$W+0]=$d[$t+0]*$i[0]+$i[2],$k[$W+1]=($d[$t+1]-1)*$i[1]+$i[3];},$C.transformLightingMapTexcoordByUV1Array=function($d,$t,$l,$k,$W){var $i=$l.elements;$k[$W+0]=$d[$t+0]*$i[0]+$i[2],$k[$W+1]=1+$d[$t+1]*$i[1]+$i[3];},$C.getURLVerion=function($d){var $t=$d.indexOf("?");return 0<=$t?$d.substr($t):null;},$C._quaternionCreateFromYawPitchRollArray=function($d,$t,$l,$k){var $W=.5*$l,$i=.5*$t,$A=.5*$d,$B=Math.sin($W),$o=Math.cos($W),$I=Math.sin($i),$b=Math.cos($i),$f=Math.sin($A),$J=Math.cos($A);$k[0]=$J*$I*$o+$f*$b*$B,$k[1]=$f*$b*$o-$J*$I*$B,$k[2]=$J*$b*$B-$f*$I*$o,$k[3]=$J*$b*$o+$f*$I*$B;},$C._createAffineTransformationArray=function($d,$t,$l,$k){var $W=$t[0],$i=$t[1],$A=$t[2],$B=$t[3],$o=$W+$W,$I=$i+$i,$b=$A+$A,$f=$W*$o,$J=$W*$I,$c=$W*$b,$Y=$i*$I,$w=$i*$b,$D=$A*$b,$z=$B*$o,$e=$B*$I,$g=$B*$b,$H=$l[0],$R=$l[1],$G=$l[2];$k[0]=(1-($Y+$D))*$H,$k[1]=($J+$g)*$H,$k[2]=($c-$e)*$H,$k[3]=0,$k[4]=($J-$g)*$R,$k[5]=(1-($f+$D))*$R,$k[6]=($w+$z)*$R,$k[7]=0,$k[8]=($c+$e)*$G,$k[9]=($w-$z)*$G,$k[10]=(1-($f+$Y))*$G,$k[11]=0,$k[12]=$d[0],$k[13]=$d[1],$k[14]=$d[2],$k[15]=1;},$C._mulMatrixArray=function($d,$t,$l,$k){var $W,$i,$A,$B,$o,$I=$t.elements,$b=$I[0],$f=$I[1],$J=$I[2],$c=$I[3],$Y=$I[4],$w=$I[5],$D=$I[6],$z=$I[7],$e=$I[8],$g=$I[9],$H=$I[10],$R=$I[11],$G=$I[12],$q=$I[13],$L=$I[14],$$=$I[15],$p=$k,$M=$k+4,$T=$k+8,$r=$k+12;for($W=0;$W<4;$W++)$i=$d[$W],$A=$d[$W+4],$B=$d[$W+8],$o=$d[$W+12],$l[$p+$W]=$i*$b+$A*$f+$B*$J+$o*$c,$l[$M+$W]=$i*$Y+$A*$w+$B*$D+$o*$z,$l[$T+$W]=$i*$e+$A*$g+$B*$H+$o*$R,$l[$r+$W]=$i*$G+$A*$q+$B*$L+$o*$$;},$C.getYawPitchRoll=function($d,$t){$C.transformQuat($At.ForwardRH,$d,$lt.TEMPVector31),$C.transformQuat($At.Up,$d,$lt.TEMPVector32);var $l=$lt.TEMPVector32.elements;$C.angleTo($At.ZERO,$lt.TEMPVector31,$lt.TEMPVector33);var $k=$lt.TEMPVector33.elements;$k[0]==Math.PI/2?($k[1]=$C.arcTanAngle($l[2],$l[0]),$k[2]=0):$k[0]==-Math.PI/2?($k[1]=$C.arcTanAngle(-$l[2],-$l[0]),$k[2]=0):($dt.createRotationY(-$k[1],$lt.TEMPMatrix0),$dt.createRotationX(-$k[0],$lt.TEMPMatrix1),$At.transformCoordinate($lt.TEMPVector32,$lt.TEMPMatrix0,$lt.TEMPVector32),$At.transformCoordinate($lt.TEMPVector32,$lt.TEMPMatrix1,$lt.TEMPVector32),$k[2]=$C.arcTanAngle($l[1],-$l[0])),$k[1]<=-Math.PI&&($k[1]=Math.PI),$k[2]<=-Math.PI&&($k[2]=Math.PI),$k[1]>=Math.PI&&$k[2]>=Math.PI&&($k[1]=0,$k[2]=0,$k[0]=Math.PI-$k[0]),$t[0]=$k[1],$t[1]=$k[0],$t[2]=$k[2];},$C.arcTanAngle=function($d,$t){return 0==$d?1==$t?Math.PI/2:-Math.PI/2:0<$d?Math.atan($t/$d):$d<0?0<$t?Math.atan($t/$d)+Math.PI:Math.atan($t/$d)-Math.PI:0;},$C.angleTo=function($d,$t,$l){$At.subtract($t,$d,$lt.TEMPVector30),$At.normalize($lt.TEMPVector30,$lt.TEMPVector30),$l.elements[0]=Math.asin($lt.TEMPVector30.y),$l.elements[1]=$C.arcTanAngle(-$lt.TEMPVector30.z,-$lt.TEMPVector30.x);},$C.transformQuat=function($d,$t,$l){var $k=$l.elements,$W=$d.elements,$i=$t,$A=$W[0],$B=$W[1],$o=$W[2],$I=$i[0],$b=$i[1],$f=$i[2],$J=$i[3],$c=$J*$A+$b*$o-$f*$B,$Y=$J*$B+$f*$A-$I*$o,$w=$J*$o+$I*$B-$b*$A,$D=-$I*$A-$b*$B-$f*$o;$k[0]=$c*$J+$D*-$I+$Y*-$f-$w*-$b,$k[1]=$Y*$J+$D*-$b+$w*-$I-$c*-$f,$k[2]=$w*$J+$D*-$f+$c*-$b-$Y*-$I;},$C.quaterionNormalize=function($d,$t){var $l=$d[0],$k=$d[1],$W=$d[2],$i=$d[3],$A=$l*$l+$k*$k+$W*$W+$i*$i;0<$A&&($A=1/Math.sqrt($A),$t[0]=$l*$A,$t[1]=$k*$A,$t[2]=$W*$A,$t[3]=$i*$A);},$C.matrix4x4MultiplyFFF=function($d,$t,$l){var $k,$W,$i,$A,$B;if($l===$t)for($t=new Float32Array(16),$k=0;$k<16;++$k)$t[$k]=$l[$k];for($k=0;$k<4;$k++)$W=$d[$k],$i=$d[$k+4],$A=$d[$k+8],$B=$d[$k+12],$l[$k]=$W*$t[0]+$i*$t[1]+$A*$t[2]+$B*$t[3],$l[$k+4]=$W*$t[4]+$i*$t[5]+$A*$t[6]+$B*$t[7],$l[$k+8]=$W*$t[8]+$i*$t[9]+$A*$t[10]+$B*$t[11],$l[$k+12]=$W*$t[12]+$i*$t[13]+$A*$t[14]+$B*$t[15];},$C.matrix4x4MultiplyMFM=function($d,$t,$l){$C.matrix4x4MultiplyFFF($d.elements,$t,$l.elements);},$f($C,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"};},"_tempVector3_0",function(){return this._tempVector3_0=new $At();},"_tempVector3_1",function(){return this._tempVector3_1=new $At();},"_tempVector3_2",function(){return this._tempVector3_2=new $At();},"_tempVector3_3",function(){return this._tempVector3_3=new $At();},"_tempVector3_4",function(){return this._tempVector3_4=new $At();},"_tempVector3_5",function(){return this._tempVector3_5=new $At();},"_tempVector3_6",function(){return this._tempVector3_6=new $At();},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4);},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16);},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16);},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16);},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16);}]),$C;}(),$zt=function(){function $S(){}return $c($S,"Laya3D"),$S._cancelLoadByUrl=function($d){$R.loader.cancelLoadByUrl($d),$S._innerFirstLevelLoaderManager.cancelLoadByUrl($d),$S._innerSecondLevelLoaderManager.cancelLoadByUrl($d),$S._innerThirdLevelLoaderManager.cancelLoadByUrl($d),$S._innerFourthLevelLoaderManager.cancelLoadByUrl($d);},$S._changeWebGLSize=function($d,$t){$r.onStageResize($d,$t),$m.clientWidth=$d,$m.clientHeight=$t;},$S.__init__=function(){var $d=$t.createMap;$d.lh=[$xt,"SPRITE3DHIERARCHY"],$d.ls=[$Kt,"SPRITE3DHIERARCHY"],$d.lm=[$Et,"MESH"],$d.lmat=[$Qt,"MATERIAL"],$d.jpg=[$ut,"nativeimage"],$d.jpeg=[$ut,"nativeimage"],$d.png=[$ut,"nativeimage"],$d.pkm=[$ut,"arraybuffer"],$d.raw=[$Zt,"arraybuffer"],$d.mipmaps=[$Zt,"arraybuffer"],$z.parserMap.SPRITE3DHIERARCHY=$S._loadHierarchy,$z.parserMap.MESH=$S._loadMesh,$z.parserMap.MATERIAL=$S._loadMaterial,$z.parserMap.TEXTURECUBE=$S._loadTextureCube,$z.parserMap.TERRAIN=$S._loadTerrain,$S._innerFirstLevelLoaderManager.on("error",null,$S._eventLoadManagerError),$S._innerSecondLevelLoaderManager.on("error",null,$S._eventLoadManagerError),$S._innerThirdLevelLoaderManager.on("error",null,$S._eventLoadManagerError),$S._innerFourthLevelLoaderManager.on("error",null,$S._eventLoadManagerError);},$S.READ_BLOCK=function(){return $S._readData.pos+=4,!0;},$S.READ_DATA=function(){return $S._DATA.offset=$S._readData.getUint32(),$S._DATA.size=$S._readData.getUint32(),!0;},$S.READ_STRINGS=function(){var $d=[],$t={offset:0,size:0};$t.offset=$S._readData.getUint16(),$t.size=$S._readData.getUint16();$S._readData.pos;$S._readData.pos=$t.offset+$S._DATA.offset;for(var $l=0;$l<$t.size;$l++){var $k=$S._readData.readUTFString();-1===$k.lastIndexOf(".lmat")&&-1===$k.lastIndexOf(".lpbr")||$d.push($k);}return $d;},$S.formatRelativePath=function($d,$t){var $l;if("."===$t.charAt(0)){for(var $k=($d+$t).split("/"),$W=0,$i=$k.length;$W<$i;$W++)if(".."==$k[$W]){var $A=$W-1;0<$A&&".."!==$k[$A]&&($k.splice($A,2),$W-=2);}$l=$k.join("/");}else $l=$d+$t;return null!=$T.customFormat&&($l=$T.customFormat($l,null)),$l;},$S._eventLoadManagerError=function($d){$R.loader.event("error",$d);},$S._addHierarchyInnerUrls=function($d,$t,$l,$k,$W,$i){var $A=$S.formatRelativePath($k,$W);$l&&($A+=$l),$d.push({url:$A,clas:$i}),$t[$W]=$A;},$S._getSprite3DHierarchyInnerUrls=function($d,$t,$l,$k,$W,$i,$A){var $B,$o=0,$I=0;switch($d.type){case"Scene":var $b=$d.customProps.lightmaps;for($o=0,$I=$b.length;$o<$I;$o++){var $f=$b[$o].replace(".exr",".png");$S._addHierarchyInnerUrls($k,$W,$i,$A,$f,$ut);}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $J;if($d.instanceParams)($J=$d.instanceParams.loadPath)&&$S._addHierarchyInnerUrls($t,$W,$i,$A,$J,$Et);else{($J=($B=$d.customProps).meshPath)&&$S._addHierarchyInnerUrls($t,$W,$i,$A,$J,$Et);var $c=$B.materials;if($c)for($o=0,$I=$c.length;$o<$I;$o++){for(var $Y=$c[$o],$w=$Y.type.split("."),$D=$j.window,$z=0,$e=$w.length;$z<$e;++$z){$D=$D[this.clasPaths[$z]];}if("function"!=typeof $D)throw"_getSprite3DHierarchyInnerUrls 错误: "+$Y.type+" 不是类";$S._addHierarchyInnerUrls($l,$W,$i,$A,$Y.path,$D);}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $g=($B=$d.customProps).meshPath;$g&&$S._addHierarchyInnerUrls($t,$W,$i,$A,$g,$Et);var $H=$B.material;if($H){$w=$H.type.split("."),$D=$j.window;for($z=0,$e=$w.length;$z<$e;++$z){$D=$D[this.clasPaths[$z]];}$S._addHierarchyInnerUrls($l,$W,$i,$A,$H.path,$D);}else{var $R=$B.materialPath;if($R)$S._addHierarchyInnerUrls($l,$W,$i,$A,$R,ShurikenParticleMaterial);else{var $G=$B.texturePath;$G&&$S._addHierarchyInnerUrls($k,$W,$i,$A,$G,$ut);}}break;case"Terrain":$S._addHierarchyInnerUrls($k,$W,$i,$A,$d.customProps.dataPath,TerrainRes);}var $q=$d.components;for(var $L in $q){var $$=$q[$L];switch($L){case"Animator":var $p=$$.avatarPath;if($p)$S._addHierarchyInnerUrls($k,$W,$i,$A,$p,Avatar);else{var $M=$$.avatar;$M&&$S._addHierarchyInnerUrls($k,$W,$i,$A,$M.path,Avatar);}var $T=$$.clipPaths;for($o=0,$I=$T.length;$o<$I;$o++)$S._addHierarchyInnerUrls($k,$W,$i,$A,$T[$o],AnimationClip);}}var $r=$d.child;for($o=0,$I=$r.length;$o<$I;$o++)$S._getSprite3DHierarchyInnerUrls($r[$o],$t,$l,$k,$W,$i,$A);},$S._loadHierarchy=function($d){$d.on("loaded",null,$S._onHierarchylhLoaded,[$d,$d._class._getGroup()]),$d.load($d.url,"json",!1,null,!0);},$S._onHierarchylhLoaded=function($d,$t,$l){if($d._class.destroyed)$d.endLoad();else{var $k=$d.url,$W=$Dt.getURLVerion($k),$i=$T.getPath($k),$A=[],$B=[],$o=[],$I={};$S._getSprite3DHierarchyInnerUrls($l,$A,$B,$o,$I,$W,$i);var $b=$A.length+$B.length+$o.length,$f=$b+1,$J=1/$f;if($S._onProcessChange($d,0,$J,1),0<$o.length){var $c=$b/$f,$Y=$M.create(null,$S._onProcessChange,[$d,$J,$c],!1);$S._innerFourthLevelLoaderManager.create($o,$M.create(null,$S._onHierarchyInnerForthLevResouLoaded,[$d,$t,$Y,$l,$I,$A,$B,$J+$c*$o.length,$c]),$Y,null,null,1,!0,$t);}else $S._onHierarchyInnerForthLevResouLoaded($d,$t,null,$l,$I,$A,$B,$J,$c);}},$S._onHierarchyInnerForthLevResouLoaded=function($d,$t,$l,$k,$W,$i,$A,$B,$o){if($d._class.destroyed)$d.endLoad();else if($l&&$l.recover(),0<$A.length){var $I=$M.create(null,$S._onProcessChange,[$d,$B,$o],!1);$S._innerSecondLevelLoaderManager.create($A,$M.create(null,$S._onHierarchyInnerSecondLevResouLoaded,[$d,$t,$I,$k,$W,$i,$B+$o*$A.length,$o]),$l,null,null,1,!0,$t);}else $S._onHierarchyInnerSecondLevResouLoaded($d,$t,null,$k,$W,$i,$B,$o);},$S._onHierarchyInnerSecondLevResouLoaded=function($d,$t,$l,$k,$W,$i,$A,$B){if($d._class.destroyed)$d.endLoad();else if($l&&$l.recover(),0<$i.length){var $o=$M.create(null,$S._onProcessChange,[$d,$A,$B],!1);$S._innerFirstLevelLoaderManager.create($i,$M.create(null,$S._onHierarchyInnerFirstLevResouLoaded,[$d,$o,$k,$W]),$l,null,null,1,!0,$t);}else $S._onHierarchyInnerFirstLevResouLoaded($d,null,$k,$W);},$S._onHierarchyInnerFirstLevResouLoaded=function($d,$t,$l,$k){$t&&$t.recover(),$d.endLoad([$l,$k]);},$S._loadTerrain=function($d){$d.on("loaded",null,$S._onTerrainLtLoaded,[$d,$d._class._getGroup()]),$d.load($d.url,"json",!1,null,!0);},$S._onTerrainLtLoaded=function($d,$t,$l){if($d._class.destroyed)$d.endLoad();else{var $k,$W,$i=$d.url,$A=$Dt.getURLVerion($i),$B=$T.getPath($i),$o=[],$I={},$b=0,$f=0,$J=$l.heightData;$k=$J.url,$W=$S.formatRelativePath($B,$k),$A&&($W+=$A),$k=$I[$k]=$W;var $c=$l.detailTexture;for($b=0,$f=$c.length;$b<$f;$b++)$o.push({url:$c[$b].diffuse});var $Y=$l.normalMap;for($b=0,$f=$Y.length;$b<$f;$b++)$o.push({url:$Y[$b]});var $w=$l.alphaMap;for($b=0,$f=$w.length;$b<$f;$b++)$o.push({url:$w[$b],params:[!1,!1,6408,!0]});for($b=0,$f=$o.length;$b<$f;$b++){var $D=$o[$b].url;$W=$S.formatRelativePath($B,$D),$A&&($W+=$A),$o[$b].url=$W,$I[$D]=$W;}var $z=$o.length,$e=$z+2,$g=1/$e;$S._onProcessChange($d,0,$g,1);var $H={heightMapLoaded:!1,texturesLoaded:!1},$R=$M.create(null,$S._onProcessChange,[$d,$g,$g],!1);$S._innerFourthLevelLoaderManager.create($k,$M.create(null,$S._onTerrainHeightMapLoaded,[$d,$R,$l,$I,$H]),$R,null,[$J.numX,$J.numZ,$J.bitType,$J.value],1,!0,$t);var $G=$M.create(null,$S._onProcessChange,[$d,2*$g,$z/$e],!1);$S._innerFourthLevelLoaderManager.create($o,$M.create(null,$S._onTerrainTexturesLoaded,[$d,$G,$l,$I,$H]),$G,null,null,1,!0,$t);}},$S._onTerrainHeightMapLoaded=function($d,$t,$l,$k,$W){$W.heightMapLoaded=!0,$W.texturesLoaded&&($d.endLoad([$l,$k]),$t.recover());},$S._onTerrainTexturesLoaded=function($d,$t,$l,$k,$W){$W.texturesLoaded=!0,$W.heightMapLoaded&&($d.endLoad([$l,$k]),$t.recover());},$S._loadMesh=function($d){$d.on("loaded",null,$S._onMeshLmLoaded,[$d,$d._class._getGroup()]),$d.load($d.url,"arraybuffer",!1,null,!0);},$S._onMeshLmLoaded=function($d,$t,$l){if($d._class.destroyed)$d.endLoad();else{var $k,$W,$i,$A=$d.url,$B=$Dt.getURLVerion($A),$o=$T.getPath($A),$I={},$b=0,$f=0;switch(($S._readData=new $G($l)).pos=0,$S._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $J=$S._readData.getUint32();$S._readData.pos=$S._readData.pos+4,$f=$S._readData.getUint16(),$S._readData.pos=$S._readData.pos+8*$f;var $c=$S._readData.getUint32();for($f=$S._readData.getUint16(),$S._readData.pos=$J+$c,$k=[],$b=0;$b<$f;$b++){var $Y=$S._readData.readUTFString();-1!==$Y.lastIndexOf(".lmat")&&$k.push($Y);}break;default:for($S.READ_BLOCK(),$b=0;$b<2;$b++){var $w=$S._readData.getUint16(),$D=$S._strings[$w],$z=$S["READ_"+$D];if(null==$z)throw new Error("model file err,no this function:"+$w+" "+$D);1===$b?$k=$z.call():$z.call();}}for($b=0,$i=$k.length;$b<$i;$b++){var $e=$k[$b];$W=$S.formatRelativePath($o,$e),$B&&($W+=$B),$k[$b]=$W,$I[$e]=$W;}if(0<$k.length){$S._onProcessChange($d,0,.5,1);var $g=$M.create(null,$S._onProcessChange,[$d,.5,.5],!1);$S._innerSecondLevelLoaderManager.create($k,$M.create(null,$S._onMeshMateialLoaded,[$d,$g,$l,$I]),$g,null,null,1,!0,$t);}else $d.endLoad([$l,$I]);}},$S._onMeshMateialLoaded=function($d,$t,$l,$k){$d.endLoad([$l,$k]),$t.recover();},$S._getMaterialTexturePath=function($d,$t,$l){var $k=$d.length-4;return $d.indexOf(".dds")!=$k&&$d.indexOf(".tga")!=$k&&$d.indexOf(".exr")!=$k&&$d.indexOf(".DDS")!=$k&&$d.indexOf(".TGA")!=$k&&$d.indexOf(".EXR")!=$k||($d=$d.substr(0,$k)+".png"),$d=$S.formatRelativePath($l,$d),$t&&($d+=$t),$d;},$S._loadMaterial=function($d){$d.on("loaded",null,$S._onMaterilLmatLoaded,[$d,$d._class._getGroup()]),$d.load($d.url,"json",!1,null,!0);},$S._onMaterilLmatLoaded=function($d,$t,$l){if($d._class.destroyed)$d.endLoad();else{var $k,$W=$d.url,$i=$Dt.getURLVerion($W),$A=$T.getPath($W),$B=[],$o={},$I=$l.customProps,$b=$l.version;if($b)switch($b){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $f=$l.props.textures,$J=0,$c=$f.length;$J<$c;$J++){var $Y=$f[$J],$w=$Y.path;if($w){var $D=$w.length-4;$w.indexOf(".exr")!=$D&&$w.indexOf(".EXR")!=$D||($w=$w.substr(0,$D)+".png"),$k=$S.formatRelativePath($A,$w),$i&&($k+=$i),$B.push({url:$k,params:$Y.params}),$o[$w]=$k;}}break;default:throw new Error("Laya3D:unkonwn version.");}else{var $z=$I.diffuseTexture.texture2D;if($z&&($k=$S._getMaterialTexturePath($z,$i,$A),$B.push($k),$o[$z]=$k),$I.normalTexture){var $e=$I.normalTexture.texture2D;$e&&($k=$S._getMaterialTexturePath($e,$i,$A),$B.push($k),$o[$e]=$k);}if($I.specularTexture){var $g=$I.specularTexture.texture2D;$g&&($k=$S._getMaterialTexturePath($g,$i,$A),$B.push($k),$o[$g]=$k);}if($I.emissiveTexture){var $H=$I.emissiveTexture.texture2D;$H&&($k=$S._getMaterialTexturePath($H,$i,$A),$B.push($k),$o[$H]=$k);}if($I.ambientTexture){var $R=$I.ambientTexture.texture2D;$R&&($k=$S._getMaterialTexturePath($R,$i,$A),$B.push($k),$o[$R]=$k);}if($I.reflectTexture){var $G=$I.reflectTexture.texture2D;$G&&($k=$S._getMaterialTexturePath($G,$i,$A),$B.push($k),$o[$G]=$k);}}var $q=$B.length,$L=$q+1,$$=1/$L;if($S._onProcessChange($d,0,$$,1),0<$q){var $p=$M.create(null,$S._onProcessChange,[$d,$$,$q/$L],!1);$S._innerFourthLevelLoaderManager.create($B,$M.create(null,$S._onMateialTexturesLoaded,[$d,$p,$l,$o]),$p,$ut,null,1,!0,$t);}else $S._onMateialTexturesLoaded($d,null,$l,null);}},$S._onMateialTexturesLoaded=function($d,$t,$l,$k){$d.endLoad([$l,$k]),$t&&$t.recover();},$S._loadTextureCube=function($d){$d.on("loaded",null,$S._onTextureCubeLtcLoaded,[$d]),$d.load($d.url,"json",!1,null,!0);},$S._onTextureCubeLtcLoaded=function($d,$t){if($d._class.destroyed)$d.endLoad();else{var $l=$T.getPath($d.url),$k=[$S.formatRelativePath($l,$t.px),$S.formatRelativePath($l,$t.nx),$S.formatRelativePath($l,$t.py),$S.formatRelativePath($l,$t.ny),$S.formatRelativePath($l,$t.pz),$S.formatRelativePath($l,$t.nz)];$S._onProcessChange($d,0,1/7,1);var $W=$M.create(null,$S._onProcessChange,[$d,1/7,6/7],!1);$S._innerFourthLevelLoaderManager.load($k,$M.create(null,$S._onTextureCubeImagesLoaded,[$d,$k,$W]),$W,"nativeimage");}},$S._onTextureCubeImagesLoaded=function($d,$t,$l){var $k=[];$k.length=6;for(var $W=0;$W<6;$W++){var $i=$t[$W];$k[$W]=$z.getRes($i),$z.clearRes($i);}$d.endLoad($k),$l.recover();},$S._onProcessChange=function($d,$t,$l,$k){($k=$t+$k*$l)<1&&$d.event("progress",$k);},$S.init=function($d,$t,$l,$k,$W,$i){if(void 0===$l&&($l=!1),void 0===$k&&($k=!1),void 0===$W&&($W=!0),void 0===$i&&($i=!0),$e.update3DLoop=function(){},$e.cancelLoadByUrl=function($d){$S._cancelLoadByUrl($d);},$o.isAntialias=$l,$o.isAlpha=$k,$o.premultipliedAlpha=$W,$o.isStencil=$i,!$r.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$e.changeWebGLSize=$S._changeWebGLSize,$w.is3DMode=!0,$R.init($d,$t),$C.__init__(),$ft.__init__(),$Xt.__init__(),$U.__init__(),$S.__init__(),$A.maxTextureCount=2,($S.debugMode||$O.debugMode)&&($S._debugPhasorSprite=new $s());},$S.HIERARCHY="SPRITE3DHIERARCHY",$S.MESH="MESH",$S.MATERIAL="MATERIAL",$S.PBRMATERIAL="PBRMTL",$S.TEXTURECUBE="TEXTURECUBE",$S.TERRAIN="TERRAIN",$S._readData=null,$S._debugPhasorSprite=null,$S.debugMode=!1,$f($S,["_DATA",function(){return this._DATA={offset:0,size:0};},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"];},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $t();},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $t();},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $t();},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $t();}]),$S;}(),$et=function($d){function $W($d){$W.__super.call(this),this._owner=$d,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0;}$c($W,"laya.d3.animation.AnimationTransform3D",$i);var $t=$W.prototype;return $t._getlocalMatrix=function(){return this._localUpdate&&($Dt._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix;},$t._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldTransform();}},$t._setWorldMatrixAndUpdate=function($d){if(this._worldMatrix=$d,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $t=this._getlocalMatrix(),$l=0;$l<16;++$l)this._worldMatrix[$l]=$t[$l];else $Dt.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1;},$t._setWorldMatrixNoUpdate=function($d){this._worldMatrix=$d;},$t._setWorldMatrixIgnoreUpdate=function($d){this._worldMatrix=$d,this._worldUpdate=!1;},$t.getLocalPosition=function(){return this._localPosition;},$t.setLocalPosition=function($d){if(this._parent)this._localPosition=$d,this._localUpdate=!0,this._onWorldTransform();else{var $t=this._entity.owner._transform,$l=this._entity.localPosition,$k=$l.elements;$k[0]=$d[0],$k[1]=$d[1],$k[2]=$d[2],$t.localPosition=$l;}},$t.getLocalRotation=function(){if(this._localQuaternionUpdate){var $d=this._localRotationEuler;$Dt._quaternionCreateFromYawPitchRollArray($d[1]/$W._angleToRandin,$d[0]/$W._angleToRandin,$d[2]/$W._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1;}return this._localRotation;},$t.setLocalRotation=function($d){if(this._parent)this._localRotation=$d,$Dt.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $t=this._entity.owner._transform,$l=this._entity.localRotation,$k=$l.elements;$k[0]=$d[0],$k[1]=$d[1],$k[2]=$d[2],$k[3]=$d[3],$t.localRotation=$l;}},$t.getLocalScale=function(){return this._localScale;},$t.setLocalScale=function($d){if(this._parent)this._localScale=$d,this._localUpdate=!0,this._onWorldTransform();else{var $t=this._entity.owner._transform,$l=this._entity.localScale,$k=$l.elements;$k[0]=$d[0],$k[1]=$d[1],$k[2]=$d[2],$t.localScale=$l;}},$t.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$Dt.getYawPitchRoll(this._localRotation,$W._tempVector3);var $d=$W._tempVector3,$t=this._localRotationEuler;$t[0]=$d[1]*$W._angleToRandin,$t[1]=$d[0]*$W._angleToRandin,$t[2]=$d[2]*$W._angleToRandin,this._locaEulerlUpdate=!1;}return this._localRotationEuler;},$t.setLocalRotationEuler=function($d){if(this._parent)$Dt._quaternionCreateFromYawPitchRollArray($d[1]/$W._angleToRandin,$d[0]/$W._angleToRandin,$d[2]/$W._angleToRandin,this._localRotation),this._localRotationEuler=$d,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $t=this._entity.owner._transform,$l=this._entity.localRotationEuler,$k=$l.elements;$k[0]=$d[0],$k[1]=$d[1],$k[2]=$d[2],$t.localRotationEuler=$l;}},$t.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$Dt.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $d=this._getlocalMatrix(),$t=0;$t<16;++$t)this._worldMatrix[$t]=$d[$t];this._worldUpdate=!1;}return this._worldMatrix;},$t.setParent=function($d){if(this._parent!==$d){if(this._parent){var $t=this._parent._childs,$l=$t.indexOf(this);$t.splice($l,1);}$d&&($d._childs.push(this),$d&&this._onWorldTransform()),this._parent=$d;}},$f($W,["_tempVector3",function(){return this._tempVector3=new Float32Array(3);},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$W;}(),$gt=function($d){function $t(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$t.__super.call(this),this._destroyed=!1,this._id=$t._uniqueIDCounter,$t._uniqueIDCounter++;}$c($t,"laya.d3.component.Component3D",$i);var $l=$t.prototype;return $R.imps($l,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$l._initialize=function($d){this._owner=$d,this._enable=!0,this.started=!1,this._load($d);},$l._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0;},$l._load=function($d){},$l._start=function($d){},$l._update=function($d){},$l._lateUpdate=function($d){},$l._preRenderUpdate=function($d){},$l._postRenderUpdate=function($d){},$l._unload=function($d){this.offAll();},$l._cloneTo=function($d){},$Y(0,$l,"id",function(){return this._id;}),$Y(0,$l,"destroyed",function(){return this._destroyed;}),$Y(0,$l,"owner",function(){return this._owner;}),$Y(0,$l,"enable",function(){return this._enable;},function($d){this._enable!==$d&&(this._enable=$d,this.event("enablechanged",this._enable));}),$Y(0,$l,"isSingleton",function(){return $t._isSingleton;}),$t._isSingleton=!0,$t._uniqueIDCounter=1,$t;}(),$Ht=function($d){function $t(){this._destroyed=!1,$t.__super.call(this),this._destroyed=!1;}$c($t,"laya.d3.core.GeometryFilter",$i);var $l=$t.prototype;return $R.imps($l,{"laya.resource.IDestroy":!0}),$l._destroy=function(){this.offAll(),this._destroyed=!0;},$Y(0,$l,"_isAsyncLoaded",function(){return!0;}),$Y(0,$l,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.");}),$Y(0,$l,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.");}),$Y(0,$l,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.");}),$Y(0,$l,"destroyed",function(){return this._destroyed;}),$t;}(),$Rt=function($d){function $k($d){$k.__super.call(this),this._id=++$k._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $Od(new $At(),new $At()),this._boundingBoxCenter=new $At(),this._boundingSphere=new $ad(new $At(),0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$d,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange);}$c($k,"laya.d3.core.render.BaseRender",$i);var $t=$k.prototype;return $R.imps($t,{"laya.resource.IDestroy":!0}),$t._changeMaterialReference=function($d,$t){$d&&$d._removeReference(),$t._addReference();},$t._getInstanceMaterial=function($d,$t){var $l=new $d.constructor();return $d.cloneTo($l),$l.name=$l.name+"(Instance)",this._materialsInstance[$t]=!0,this._changeMaterialReference(this._materials[$t],$l),this._materials[$t]=$l;},$t._setShaderValuelightMap=function($d){this._setShaderValueTexture(3,$d);},$t._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0;},$t._renderRenderableBoundBox=function(){var $d=$zt._debugPhasorSprite,$t=this.boundingBox,$l=$k._tempBoundBoxCorners;$t.getCorners($l),$d.line($l[0],$k._greenColor,$l[1],$k._greenColor),$d.line($l[2],$k._greenColor,$l[3],$k._greenColor),$d.line($l[4],$k._greenColor,$l[5],$k._greenColor),$d.line($l[6],$k._greenColor,$l[7],$k._greenColor),$d.line($l[0],$k._greenColor,$l[3],$k._greenColor),$d.line($l[1],$k._greenColor,$l[2],$k._greenColor),$d.line($l[2],$k._greenColor,$l[6],$k._greenColor),$d.line($l[3],$k._greenColor,$l[7],$k._greenColor),$d.line($l[0],$k._greenColor,$l[4],$k._greenColor),$d.line($l[1],$k._greenColor,$l[5],$k._greenColor),$d.line($l[4],$k._greenColor,$l[7],$k._greenColor),$d.line($l[5],$k._greenColor,$l[6],$k._greenColor);},$t._calculateBoundingSphere=function(){throw"BaseRender: must override it.";},$t._calculateBoundingBox=function(){throw"BaseRender: must override it.";},$t._setShaderValueTexture=function($d,$t){this._owner._shaderValues.setValue($d,$t);},$t._setShaderValueMatrix4x4=function($d,$t){this._owner._shaderValues.setValue($d,$t?$t.elements:null);},$t._setShaderValueColor=function($d,$t){this._owner._shaderValues.setValue($d,$t?$t.elements:null);},$t._setShaderValueBuffer=function($d,$t){this._owner._shaderValues.setValue($d,$t);},$t._setShaderValueInt=function($d,$t){this._owner._shaderValues.setValue($d,$t);},$t._setShaderValueBool=function($d,$t){this._owner._shaderValues.setValue($d,$t);},$t._setShaderValueNumber=function($d,$t){this._owner._shaderValues.setValue($d,$t);},$t._setShaderValueVector2=function($d,$t){this._owner._shaderValues.setValue($d,$t?$t.elements:null);},$t._addShaderDefine=function($d){this._owner._shaderDefineValue|=$d;},$t._removeShaderDefine=function($d){this._owner._shaderDefineValue&=~$d;},$t._renderUpdate=function($d){return!0;},$t._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $d=this._owner.scene;if($d){var $t=$d.getlightmaps()[this._lightmapIndex];$t?(this._addShaderDefine($st.SAHDERDEFINE_LIGHTMAP),$t.loaded?this._setShaderValuelightMap($t):$t.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($st.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($st.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($st.SAHDERDEFINE_LIGHTMAP);},$t._updateOctreeNode=function(){var $d=this._treeNode;$d&&this._octreeNodeNeedChange&&($d.updateObject(this),this._octreeNodeNeedChange=!1);},$t._destroy=function(){this.offAll();var $d=0,$t=0;for($d=0,$t=this._renderElements.length;$d<$t;$d++)this._renderElements[$d]._destroy();for($d=0,$t=this._materials.length;$d<$t;$d++)this._materials[$d]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0;},$Y(0,$t,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere;}),$Y(0,$t,"id",function(){return this._id;}),$Y(0,$t,"material",function(){var $d=this._materials[0];if($d&&!this._materialsInstance[0]){var $t=this._getInstanceMaterial($d,0);this.event("materialchanged",[this,0,$t]);}return this._materials[0];},function($d){this.sharedMaterial=$d;}),$Y(0,$t,"sharedMaterial",function(){return this._materials[0];},function($d){var $t=this._materials[0];$t!==$d&&(this._materials[0]=$d,this._materialsInstance[0]=!1,this._changeMaterialReference($t,$d),this.event("materialchanged",[this,0,$d]));}),$Y(0,$t,"lightmapIndex",function(){return this._lightmapIndex;},function($d){this._lightmapIndex=$d,this._applyLightMapParams();}),$Y(0,$t,"lightmapScaleOffset",function(){return this._lightmapScaleOffset;},function($d){this._lightmapScaleOffset=$d,this._setShaderValueColor(2,$d),this._addShaderDefine($st.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);}),$Y(0,$t,"enable",function(){return this._enable;},function($d){this._enable=$d,this.event("enablechanged",[this,$d]);}),$Y(0,$t,"materials",function(){for(var $d=0,$t=this._materials.length;$d<$t;$d++)if(!this._materialsInstance[$d]){var $l=this._getInstanceMaterial(this._materials[$d],$d);this.event("materialchanged",[this,$d,$l]);}return this._materials.slice();},function($d){this.sharedMaterials=$d;}),$Y(0,$t,"sharedMaterials",function(){return this._materials.slice();},function($d){if(!$d)throw new Error("MeshRender: shadredMaterials value can't be null.");var $t=$d.length;this._materialsInstance.length=$t;for(var $l=0;$l<$t;$l++){var $k=this._materials[$l];$k!==$d[$l]&&(this._materialsInstance[$l]=!1,this._changeMaterialReference($k,$d[$l]),this.event("materialchanged",[this,$l,$d[$l]]));}this._materials=$d;}),$Y(0,$t,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox;}),$Y(0,$t,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $d=this.boundingBox;$At.add($d.min,$d.max,this._boundingBoxCenter),$At.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1;}return this._boundingBoxCenter;}),$Y(0,$t,"receiveShadow",function(){return this._receiveShadow;},function($d){this._receiveShadow!==$d&&((this._receiveShadow=$d)?this._addShaderDefine($ct.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($ct.SHADERDEFINE_RECEIVE_SHADOW));}),$Y(0,$t,"destroyed",function(){return this._destroyed;}),$k._uniqueIDCounter=0,$f($k,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At(),new $At()];},"_greenColor",function(){return this._greenColor=new $Bt(0,1,0,1);}]),$k;}(),$Gt=function($d){function $B($d){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$B.__super.call(this),this._localPosition=new $At(),this._localRotation=new $lt(0,0,0,1),this._localScale=new $At(1,1,1),this._localRotationEuler=new $At(),this._localMatrix=new $dt(),this._position=new $At(),this._rotation=new $lt(0,0,0,1),this._scale=new $At(1,1,1),this._worldMatrix=new $dt(),this._forward=new $At(),this._up=new $At(),this._right=new $At(),this._owner=$d,this._childs=[];}$c($B,"laya.d3.core.Transform3D",$i);var $t=$B.prototype;return $t._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$dt.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $d=$B._tempVector30;$At.multiply(this.pivot,this._localScale,$d);var $t=$B._tempVector31;$At.subtract($d,this.pivot,$t);var $l=$B._tempVector32,$k=this.localRotation;$At.transformQuat($d,$k,$l),$At.subtract($l,$d,$l);var $W=$B._tempVector33;$At.subtract(this._localPosition,$t,$W),$At.subtract($W,$l,$W),$dt.createAffineTransformation($W,$k,this._localScale,this._localMatrix);}},$t._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldPositionRotationTransform();}},$t._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldPositionScaleTransform();}},$t._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldPositionTransform();}},$t._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldPositionRotationTransform();}},$t._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldPositionScaleTransform();}},$t._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._onWorldTransform();}},$t.translate=function($d,$t){void 0===$t&&($t=!0),$t?($dt.createFromQuaternion(this.localRotation,$B._tempMatrix0),$At.transformCoordinate($d,$B._tempMatrix0,$B._tempVector30),$At.add(this.localPosition,$B._tempVector30,this._localPosition),this.localPosition=this._localPosition):($At.add(this.position,$d,this._position),this.position=this._position);},$t.rotate=function($d,$t,$l){var $k;void 0===$t&&($t=!0),void 0===$l&&($l=!0),$k=$l?$d:($At.scale($d,Math.PI/180,$B._tempVector30),$B._tempVector30),$lt.createFromYawPitchRoll($k.y,$k.x,$k.z,$B._tempQuaternion0),$t?($lt.multiply(this._localRotation,$B._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($lt.multiply($B._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation);},$t.lookAt=function($d,$t,$l){void 0===$l&&($l=!1);var $k,$W=$d.elements;if($l){if($k=this._localPosition.elements,Math.abs($k[0]-$W[0])<$_d.zeroTolerance&&Math.abs($k[1]-$W[1])<$_d.zeroTolerance&&Math.abs($k[2]-$W[2])<$_d.zeroTolerance)return;$lt.lookAt(this._localPosition,$d,$t,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation;}else{var $i=this.position;if($k=$i.elements,Math.abs($k[0]-$W[0])<$_d.zeroTolerance&&Math.abs($k[1]-$W[1])<$_d.zeroTolerance&&Math.abs($k[2]-$W[2])<$_d.zeroTolerance)return;$lt.lookAt($i,$d,$t,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation;}},$Y(0,$t,"_isFrontFaceInvert",function(){var $d=this.scale,$t=$d.x<0;return $d.y<0&&($t=!$t),$d.z<0&&($t=!$t),$t;}),$Y(0,$t,"owner",function(){return this._owner;}),$Y(0,$t,"localRotation",function(){if(this._localQuaternionUpdate){var $d=this._localRotationEuler.elements;$lt.createFromYawPitchRoll($d[1]/$B._angleToRandin,$d[0]/$B._angleToRandin,$d[2]/$B._angleToRandin,this._localRotation);}return this._localRotation;},function($d){this._localRotation=$d,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$Y(0,$t,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$dt.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix;},function($d){null===this._parent?$d.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$dt.multiply(this._localMatrix,$d,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$d,this._worldUpdate=!1;}),$Y(0,$t,"worldNeedUpdate",function(){return this._worldUpdate;}),$Y(0,$t,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix;},function($d){this._localMatrix=$d,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform();}),$Y(0,$t,"dummy",function(){return this._dummy;},function($d){this._dummy!==$d&&(this._dummy&&(this._dummy._entity=null),$d&&($d._entity=this),this._dummy=$d);}),$Y(0,$t,"localPosition",function(){return this._localPosition;},function($d){this._localPosition=$d,this._localUpdate=!0,this._onWorldPositionTransform();}),$Y(0,$t,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $d=this._parent.position;$At.multiply(this._localPosition,this._parent.scale,$B._tempVector30),$At.transformQuat($B._tempVector30,this._parent.rotation,$B._tempVector30),$At.add($d,$B._tempVector30,this._position);}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1;}return this._position;},function($d){if(null!=this._parent){$At.subtract($d,this._parent.position,this._localPosition);var $t=this._parent.scale.elements,$l=$t[0],$k=$t[1],$W=$t[2];if(1!==$l||1!==$k||1!==$W){var $i=$B._tempVector30,$A=$i.elements;$A[0]=1/$l,$A[1]=1/$k,$A[2]=1/$W,$At.multiply(this._localPosition,$i,this._localPosition);}this._parent.rotation.invert($B._tempQuaternion0),$At.transformQuat(this._localPosition,$B._tempQuaternion0,this._localPosition);}else $d.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$d,this._positionUpdate=!1;}),$Y(0,$t,"localScale",function(){return this._localScale;},function($d){this._localScale=$d,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform();}),$Y(0,$t,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($B._tempVector30);var $d=$B._tempVector30.elements,$t=this._localRotationEuler.elements;$t[0]=$d[1]*$B._angleToRandin,$t[1]=$d[0]*$B._angleToRandin,$t[2]=$d[2]*$B._angleToRandin;}return this._localRotationEuler;},function($d){this._localRotationEuler=$d,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$Y(0,$t,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$lt.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation;},function($d){null!=this._parent?(this._parent.rotation.invert($B._tempQuaternion0),$lt.multiply($d,$B._tempQuaternion0,this._localRotation)):$d.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$d,this._rotationUpdate=!1;}),$Y(0,$t,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$At.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale;},function($d){if(null!==this._parent){var $t=this._parent.scale.elements,$l=$B._tempVector30.elements;$l[0]=1/$t[0],$l[1]=1/$t[1],$l[2]=1/$t[2],$At.multiply($d,$B._tempVector30,this._localScale);}else $d.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$d,this._scaleUpdate=!1;}),$Y(0,$t,"rotationEuler",null,function($d){$lt.createFromYawPitchRoll($d.y,$d.x,$d.z,this._rotation),this.rotation=this._rotation;}),$Y(0,$t,"forward",function(){var $d=this.worldMatrix.elements;return this._forward.elements[0]=-$d[8],this._forward.elements[1]=-$d[9],this._forward.elements[2]=-$d[10],this._forward;}),$Y(0,$t,"up",function(){var $d=this.worldMatrix.elements;return this._up.elements[0]=$d[4],this._up.elements[1]=$d[5],this._up.elements[2]=$d[6],this._up;}),$Y(0,$t,"right",function(){var $d=this.worldMatrix.elements;return this._right.elements[0]=$d[0],this._right.elements[1]=$d[1],this._right.elements[2]=$d[2],this._right;}),$Y(0,$t,"parent",function(){return this._parent;},function($d){if(this._parent!==$d){if(this._parent){var $t=this._parent._childs,$l=$t.indexOf(this);$t.splice($l,1);}$d&&($d._childs.push(this),$d&&this._onWorldTransform()),this._parent=$d;}}),$f($B,["_tempVector30",function(){return this._tempVector30=new $At();},"_tempVector31",function(){return this._tempVector31=new $At();},"_tempVector32",function(){return this._tempVector32=new $At();},"_tempVector33",function(){return this._tempVector33=new $At();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $lt();},"_tempMatrix0",function(){return this._tempMatrix0=new $dt();},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$B;}(),$qt=(function($d){function $t(){this._rotation=0,this._matNeedUpdte=!1,$t.__super.call(this),this._matrix=new $dt(),this._offset=new $it(),this._tiling=new $it(1,1);}$c($t,"laya.d3.core.TransformUV",$i);var $l=$t.prototype;$R.imps($l,{"laya.d3.core.IClone":!0}),$l._updateMatrix=function(){$t._tempOffsetV3.elements[0]=this._offset.x,$t._tempOffsetV3.elements[1]=this._offset.y,$lt.createFromYawPitchRoll(0,0,this._rotation,$t._tempRotationQua),$t._tempTitlingV3.elements[0]=this._tiling.x,$t._tempTitlingV3.elements[1]=this._tiling.y,$dt.createAffineTransformation($t._tempOffsetV3,$t._tempRotationQua,$t._tempTitlingV3,this._matrix);},$l.cloneTo=function($d){$d._matrix=this._matrix.clone(),$d._offset=this._offset.clone(),$d._rotation=this._rotation,$d._tiling=this._tiling.clone();},$l.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$l,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix;}),$Y(0,$l,"tiling",function(){return this._tiling;},function($d){this._tiling=$d,this._matNeedUpdte=!0;}),$Y(0,$l,"offset",function(){return this._offset;},function($d){this._offset=$d,this._matNeedUpdte=!0;}),$Y(0,$l,"rotation",function(){return this._rotation;},function($d){this._rotation=$d,this._matNeedUpdte=!0;}),$f($t,["_tempOffsetV3",function(){return this._tempOffsetV3=new $At(0,0,0);},"_tempRotationQua",function(){return this._tempRotationQua=new $lt();},"_tempTitlingV3",function(){return this._tempTitlingV3=new $At(1,1,1);}]);}(),function($l){function $d(){this.x=NaN,this.y=NaN,this.z=NaN,$d.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1;}$c($d,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$l);var $t=$d.prototype;$t._getShapeBoundBox=function($d){var $t=$d.min.elements;$t[0]=.5*-this.x,$t[1]=.5*-this.y,$t[2]=.5*-this.z;var $l=$d.max.elements;$l[0]=.5*this.x,$l[1]=.5*this.y,$l[2]=.5*this.z;},$t._getSpeedBoundBox=function($d){var $t=$d.min.elements;$t[0]=0,$t[1]=0,$t[2]=0;var $l=$d.max.elements;$l[0]=0,$l[1]=1,$l[2]=0;},$t.generatePositionAndDirection=function($d,$t,$l,$k){var $W=$d.elements,$i=$t.elements;$l?($l.seed=$k[16],$u._randomPointInsideHalfUnitBox($d,$l),$k[16]=$l.seed):$u._randomPointInsideHalfUnitBox($d),$W[0]=this.x*$W[0],$W[1]=this.y*$W[1],$W[2]=this.z*$W[2],this.randomDirection?$l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t):($i[0]=0,$i[1]=0,$i[2]=1);},$t.cloneTo=function($d){$l.prototype.cloneTo.call(this,$d);var $t=$d;$t.x=this.x,$t.y=this.y,$t.z=this.z,$t.randomDirection=this.randomDirection;};}($V),function($l){function $A(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$A.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1;}$c($A,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$l);var $d=$A.prototype;$d._getShapeBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[2]=-this.radius,$t[1]=0;var $l=$d.max.elements;$l[0]=$l[2]=this.radius,$l[1]=0;},$d._getSpeedBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[1]=-1,$t[2]=0;var $l=$d.max.elements;$l[0]=$l[1]=1,$l[2]=0;},$d.generatePositionAndDirection=function($d,$t,$l,$k){var $W=$d.elements,$i=$A._tempPositionPoint.elements;$l?($l.seed=$k[16],this.emitFromEdge?$u._randomPointUnitArcCircle(this.arc,$A._tempPositionPoint,$l):$u._randomPointInsideUnitArcCircle(this.arc,$A._tempPositionPoint,$l),$k[16]=$l.seed):this.emitFromEdge?$u._randomPointUnitArcCircle(this.arc,$A._tempPositionPoint):$u._randomPointInsideUnitArcCircle(this.arc,$A._tempPositionPoint),$W[0]=-$i[0],$W[1]=$i[1],$W[2]=0,$At.scale($d,this.radius,$d),this.randomDirection?$l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t):$d.cloneTo($t);},$d.cloneTo=function($d){$l.prototype.cloneTo.call(this,$d);var $t=$d;$t.radius=this.radius,$t.arc=this.arc,$t.emitFromEdge=this.emitFromEdge,$t.randomDirection=this.randomDirection;},$f($A,["_tempPositionPoint",function(){return this._tempPositionPoint=new $it();}]);}($V),function($l){function $J(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$J.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1;}$c($J,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$l);var $d=$J.prototype;$d._getShapeBoundBox=function($d){var $t=this.radius+this.length*Math.sin(this.angle),$l=this.length*Math.cos(this.angle),$k=$d.min.elements;$k[0]=$k[1]=-$t,$k[2]=0;var $W=$d.max.elements;$W[0]=$W[1]=$t,$W[2]=$l;},$d._getSpeedBoundBox=function($d){var $t=Math.sin(this.angle),$l=$d.min.elements;$l[0]=$l[1]=-$t,$l[2]=0;var $k=$d.max.elements;$k[0]=$l[1]=$t,$k[2]=1;},$d.generatePositionAndDirection=function($d,$t,$l,$k){var $W,$i=$d.elements,$A=$t.elements,$B=$J._tempPositionPoint.elements,$o=NaN,$I=NaN,$b=Math.cos(this.angle),$f=Math.sin(this.angle);switch(this.emitType){case 0:$l?($l.seed=$k[16],$u._randomPointInsideUnitCircle($J._tempPositionPoint,$l),$k[16]=$l.seed):$u._randomPointInsideUnitCircle($J._tempPositionPoint),$o=$B[0],$I=$B[1],$i[0]=$o*this.radius,$i[1]=$I*this.radius,$i[2]=0,this.randomDirection?($l?($l.seed=$k[17],$u._randomPointInsideUnitCircle($J._tempDirectionPoint,$l),$k[17]=$l.seed):$u._randomPointInsideUnitCircle($J._tempDirectionPoint),$W=$J._tempDirectionPoint.elements,$A[0]=$W[0]*$f,$A[1]=$W[1]*$f):($A[0]=$o*$f,$A[1]=$I*$f),$A[2]=$b;break;case 1:$l?($l.seed=$k[16],$u._randomPointUnitCircle($J._tempPositionPoint,$l),$k[16]=$l.seed):$u._randomPointUnitCircle($J._tempPositionPoint),$o=$B[0],$I=$B[1],$i[0]=$o*this.radius,$i[1]=$I*this.radius,$i[2]=0,this.randomDirection?($l?($l.seed=$k[17],$u._randomPointInsideUnitCircle($J._tempDirectionPoint,$l),$k[17]=$l.seed):$u._randomPointInsideUnitCircle($J._tempDirectionPoint),$W=$J._tempDirectionPoint.elements,$A[0]=$W[0]*$f,$A[1]=$W[1]*$f):($A[0]=$o*$f,$A[1]=$I*$f),$A[2]=$b;break;case 2:$l?($l.seed=$k[16],$u._randomPointInsideUnitCircle($J._tempPositionPoint,$l)):$u._randomPointInsideUnitCircle($J._tempPositionPoint),$o=$B[0],$I=$B[1],$i[0]=$o*this.radius,$i[1]=$I*this.radius,$A[$i[2]=0]=$o*$f,$A[1]=$I*$f,$A[2]=$b,$At.normalize($t,$t),$l?($At.scale($t,this.length*$l.getFloat(),$t),$k[16]=$l.seed):$At.scale($t,this.length*Math.random(),$t),$At.add($d,$t,$d),this.randomDirection&&($l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t));break;case 3:$l?($l.seed=$k[16],$u._randomPointUnitCircle($J._tempPositionPoint,$l)):$u._randomPointUnitCircle($J._tempPositionPoint),$o=$B[0],$I=$B[1],$i[0]=$o*this.radius,$i[1]=$I*this.radius,$A[$i[2]=0]=$o*$f,$A[1]=$I*$f,$A[2]=$b,$At.normalize($t,$t),$l?($At.scale($t,this.length*$l.getFloat(),$t),$k[16]=$l.seed):$At.scale($t,this.length*Math.random(),$t),$At.add($d,$t,$d),this.randomDirection&&($l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t));break;default:throw new Error("ConeShape:emitType is invalid.");}},$d.cloneTo=function($d){$l.prototype.cloneTo.call(this,$d);var $t=$d;$t.angle=this.angle,$t.radius=this.radius,$t.length=this.length,$t.emitType=this.emitType,$t.randomDirection=this.randomDirection;},$f($J,["_tempPositionPoint",function(){return this._tempPositionPoint=new $it();},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $it();}]);}($V),function($l){function $d(){this.radius=NaN,this.emitFromShell=!1,$d.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$c($d,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$l);var $t=$d.prototype;$t._getShapeBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[1]=$t[2]=-this.radius;var $l=$d.max.elements;$l[0]=$l[1]=this.radius,$l[2]=0;},$t._getSpeedBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[1]=-1,$t[2]=0;var $l=$d.max.elements;$l[0]=$l[1]=$l[2]=1;},$t.generatePositionAndDirection=function($d,$t,$l,$k){var $W=$d.elements;$l?($l.seed=$k[16],this.emitFromShell?$u._randomPointUnitSphere($d,$l):$u._randomPointInsideUnitSphere($d,$l),$k[16]=$l.seed):this.emitFromShell?$u._randomPointUnitSphere($d):$u._randomPointInsideUnitSphere($d),$At.scale($d,this.radius,$d);var $i=$W[2];$i<0&&($W[2]=-1*$i),this.randomDirection?$l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t):$d.cloneTo($t);},$t.cloneTo=function($d){$l.prototype.cloneTo.call(this,$d);var $t=$d;$t.radius=this.radius,$t.emitFromShell=this.emitFromShell,$t.randomDirection=this.randomDirection;};}($V),function($l){function $d(){this.radius=NaN,this.emitFromShell=!1,$d.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$c($d,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$l);var $t=$d.prototype;$t._getShapeBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[1]=$t[2]=-this.radius;var $l=$d.max.elements;$l[0]=$l[1]=$l[2]=this.radius;},$t._getSpeedBoundBox=function($d){var $t=$d.min.elements;$t[0]=$t[1]=$t[2]=-1;var $l=$d.max.elements;$l[0]=$l[1]=$l[2]=1;},$t.generatePositionAndDirection=function($d,$t,$l,$k){$l?($l.seed=$k[16],this.emitFromShell?$u._randomPointUnitSphere($d,$l):$u._randomPointInsideUnitSphere($d,$l),$k[16]=$l.seed):this.emitFromShell?$u._randomPointUnitSphere($d):$u._randomPointInsideUnitSphere($d),$At.scale($d,this.radius,$d),this.randomDirection?$l?($l.seed=$k[17],$u._randomPointUnitSphere($t,$l),$k[17]=$l.seed):$u._randomPointUnitSphere($t):$d.cloneTo($t);},$t.cloneTo=function($d){$l.prototype.cloneTo.call(this,$d);var $t=$d;$t.radius=this.radius,$t.emitFromShell=this.emitFromShell,$t.randomDirection=this.randomDirection;};}($V),function($d){function $t(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$t.__super.call(this);}return $c($t,"laya.d3.core.render.SubMeshRenderElement",$P),$t;}()),$Lt=function($d){function $D($d,$t,$l,$k,$W,$i){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$d,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$ct.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$st.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$st.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$Tt.SHADERDEFINE_ALPHATEST]="ALPHATEST";$D.__super.call(this,$d,$t,$l,null,{}),this._attributeMap=$k;var $A;for($A in $W){var $B=$W[$A];switch($B[1]){case 0:this._renderElementUniformMap[$A]=$B[0];break;case 1:this._materialUniformMap[$A]=$B[0];break;case 2:this._spriteUniformMap[$A]=$B[0];break;case 3:this._cameraUniformMap[$A]=$B[0];break;case 4:this._sceneUniformMap[$A]=$B[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.");}}}$c($D,"laya.d3.shader.ShaderCompile3D",$g);var $t=$D.prototype;return $t._definesToNameDic=function($d,$t){for(var $l={},$k=1,$W=0;$W<32&&!($d<($k=1<<$W));$W++)if($d&$k){var $i=$t[$k];$i&&($l[$i]="");}return $l;},$t.withCompile=function($d,$t,$l,$k){var $W,$i,$A;if($i=this.sharders[$d]){if($A=$i[$t]){if($W=$A[$l])return $W;}else $A=$i[$t]=[];}else $A=($i=this.sharders[$d]=[])[$t]=[];var $B,$o=this._definesToNameDic($d,$D._globalInt2name),$I=this._definesToNameDic($t,this._spriteInt2name),$b=this._definesToNameDic($l,this._materialInt2name),$f={},$J="";if($o)for($B in $o)$J+="#define "+$B+"\n",$f[$B]=!0;if($I)for($B in $I)$J+="#define "+$B+"\n",$f[$B]=!0;if($b)for($B in $b)$J+="#define "+$B+"\n",$f[$B]=!0;var $c=$nt.nameKey.getName(this._name)+" compile ("+$d+","+$t+","+$l+")",$Y=this._VS.toscript($f,[]),$w=this._PS.toscript($f,[]);$j.now();if($W=$nt.create($J+$Y.join("\n"),$J+$w.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$k,$c),$A[$l]=$W,laya.d3.shader.ShaderCompile3D.debugMode)$j.now();return $W;},$t.precompileShaderWithShaderDefine=function($d,$t,$l){this.withCompile($d,$t,$l,!0);},$t.addMaterialDefines=function($d){var $t=$d.defines;for(var $l in $t){var $k=$t[$l],$W=parseInt($l);this._materialInt2name[$W]=$k,this._materialName2Int[$k]=$W;}},$t.addSpriteDefines=function($d){var $t=$d.defines;for(var $l in $t){var $k=$t[$l],$W=parseInt($l);this._spriteInt2name[$W]=$k,this._spriteName2Int[$k]=$W;}},$t.getMaterialDefineByName=function($d){return this._materialName2Int[$d];},$t.registerMaterialDefine=function($d){var $t=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$t]=$d,this._materialName2Int[$d]=$t;},$t.registerSpriteDefine=function($d){var $t=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$t]=$d,this._spriteName2Int[$d]=$t;},$D._globalRegDefine=function($d,$t){$D._globalInt2name[$t]=$d;},$D.add=function($d,$t,$l,$k,$W){return laya.d3.shader.ShaderCompile3D._preCompileShader[$d]=new $D($d,$t,$l,$k,$W,$g.includes);},$D.get=function($d){return laya.d3.shader.ShaderCompile3D._preCompileShader[$nt.nameKey.getID($d)];},$D._preCompileShader={},$D._globalInt2name=[],$D.debugMode=!1,$D.SHADERDEFINE_HIGHPRECISION=1,$D.SHADERDEFINE_FOG=4,$D.SHADERDEFINE_DIRECTIONLIGHT=8,$D.SHADERDEFINE_POINTLIGHT=16,$D.SHADERDEFINE_SPOTLIGHT=32,$D.SHADERDEFINE_UV0=64,$D.SHADERDEFINE_COLOR=128,$D.SHADERDEFINE_UV1=256,$D.SAHDERDEFINE_DEPTHFOG=131072,$D;}(),$$t=function($d){function $Y(){$Y.__super.call(this);}$c($Y,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$kd);var $t=$Y.prototype;return $t._getStaticBatch=function($d,$t,$l,$k){var $W,$i;return $i=$d?$d.id.toString()+$l.id.toString()+$t.id.toString()+$k.toString():$l.id.toString()+$t.id.toString()+$k.toString(),this._staticBatches[$i]?$W=this._staticBatches[$i]:this._staticBatches[$i]=$W=new $pt($i,this,$d,$t,$l),$W;},$t._initStaticBatchs=function($d){var $t,$l;this._initBatchRenderElements.sort($Y._sortPrepareStaticBatch);for(var $k,$W=!1,$i=0,$A=0,$B=this._initBatchRenderElements.length;$A<$B;$A++){var $o,$I=this._initBatchRenderElements[$A],$b=$I.renderObj._getVertexBuffer(0);$I._sprite3D;if($l===$b.vertexDeclaration&&$t===$I._material){if($W)$k._addCombineBatchRenderObjTest($I)?($o=$I._staticBatch)!==$k&&($o&&$o._deleteCombineBatchRenderObj($I),$k._addCombineBatchRenderObj($I)):($W=!1,$i++);else{var $f=this._initBatchRenderElements[$A-1],$J=$f.renderObj,$c=$I.renderObj;$W=!(65535<$J._getVertexBuffer().vertexCount+$c._getVertexBuffer().vertexCount)&&($k=this._getStaticBatch($d,$l,$t,$i),($o=$f._staticBatch)!==$k&&($o&&$o._deleteCombineBatchRenderObj($f),$k._addCombineBatchRenderObj($f)),($o=$I._staticBatch)!==$k&&($o&&$o._deleteCombineBatchRenderObj($I),$k._addCombineBatchRenderObj($I)),!0);}}else $W=!1,$i=0;$t=$I._material,$l=$b.vertexDeclaration;}},$Y._sortPrepareStaticBatch=function($d,$t){var $l=$d._render,$k=$t._render,$W=$l.lightmapIndex-$k.lightmapIndex;if(0!=$W)return $W;var $i=$l.receiveShadow-$k.receiveShadow;if(0!=$i)return $i;var $A=$d._mainSortID-$t._mainSortID;return 0==$A?$d.renderObj.triangleCount-$t.renderObj.triangleCount:$A;},$Y;}(),$pt=function($d){function $i($d,$t,$l,$k,$W){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$i.__super.call(this,$d,$t,$l),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$k,this._material=$W;}$c($i,"laya.d3.graphics.SubMeshStaticBatch",$Wd);var $t=$i.prototype;return $t._compareBatchRenderElement=function($d,$t){return $d._batchIndexStart>$t._batchIndexStart;},$t._addCombineBatchRenderObjTest=function($d){var $t=$d.renderObj._vertexCount;return!(65535<(0<$t?this._currentCombineVertexCount+$t:this._currentCombineVertexCount+$d.renderObj._getVertexBuffer().vertexCount));},$t._addCombineBatchRenderObj=function($d){var $t=$d.renderObj,$l=$t._vertexCount;this._initBatchRenderElements.push($d),$d._staticBatch=this,0<$l?(this._currentCombineIndexCount+=$t._indexCount,this._currentCombineVertexCount+=$l):(this._currentCombineIndexCount=this._currentCombineIndexCount+$t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$t._getVertexBuffer().vertexCount),this._needFinishCombine=!0;},$t._deleteCombineBatchRenderObj=function($d){var $t=$d.renderObj,$l=this._initBatchRenderElements.indexOf($d);if(-1!==$l){this._initBatchRenderElements.splice($l,1),$d._staticBatch=null;var $k=$t._vertexCount;0<$k?(this._currentCombineIndexCount=this._currentCombineIndexCount-$t._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$k):(this._currentCombineIndexCount=this._currentCombineIndexCount-$t._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$t._getVertexBuffer().vertexCount),this._needFinishCombine=!0;}},$t._finishInit=function(){if(this._needFinishCombine){var $d=0,$t=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $l=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$k=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$Vt.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$yt.create("ushort",this._currentCombineIndexCount,35044);for(var $W=0,$i=this._initBatchRenderElements.length;$W<$i;$W++){var $A=this._initBatchRenderElements[$W],$B=$A.renderObj,$o=$B._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$A._sprite3D),$I=$B.getIndices(),$b=$A._sprite3D.transform._isFrontFaceInvert,$f=$d/(this._vertexDeclaration.vertexStride/4)-$B._vertexStart,$J=$t,$c=$J+$I.length;$A._batchIndexStart=$J,$A._batchIndexEnd=$c,$k.set($I,$t);var $Y=0;if($b)for($Y=$J;$Y<$c;$Y+=3){$k[$Y]=$f+$k[$Y];var $w=$k[$Y+1],$D=$k[$Y+2];$k[$Y+1]=$f+$D,$k[$Y+2]=$f+$w;}else for($Y=$J;$Y<$c;$Y+=3)$k[$Y]=$f+$k[$Y],$k[$Y+1]=$f+$k[$Y+1],$k[$Y+2]=$f+$k[$Y+2];$t+=$I.length,$l.set($o,$d),$d+=$o.length;}this._vertexBuffer.setData($l),this._indexBuffer.setData($k),this._needFinishCombine=!1;}},$t._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $qt());},$t._getRenderElement=function($d,$t,$l){for(var $k,$W,$i=this._batchRenderElements.length,$A=!0,$B=0;$B<$i;$B++){var $o,$I,$b=($W=this._batchRenderElements[$B])._sprite3D._render;if(0!==$B&&($A=($o=($k=this._batchRenderElements[$B-1])._sprite3D._render).lightmapIndex!==$b.lightmapIndex||$o.receiveShadow!==$b.receiveShadow||$k._batchIndexEnd!==$W._batchIndexStart),$A){($I=this._getCombineRenderElementFromPool()).renderObj=this,$I._material=this._material,$I._batchIndexStart=$W._batchIndexStart,$I._batchIndexEnd=$W._batchIndexEnd;var $f=$b.lightmapIndex,$J=$f+1,$c=this._batchOwnerIndices[$J];$c||($c=this._batchOwnerIndices[$J]=[]);var $Y,$w=$c[$W._render.receiveShadow?1:0];void 0===$w?($c[$b.receiveShadow?1:0]=this._batchOwners.length,($Y=new $Xt(null,"StaticBatchMeshSprite3D"))._scene=$t,$Y._transform=this._rootOwner?this._rootOwner._transform:null,$Y._render.lightmapIndex=$f,$Y._render.receiveShadow=$W._render.receiveShadow,this._batchOwners.push($Y)):$Y=this._batchOwners[$w],$Y._render._renderUpdate($l),$I._sprite3D=$Y,$d.push($I);}else $I._batchIndexEnd=$W._batchIndexEnd;}},$t._beforeRender=function($d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$t._render=function($d){var $t=$d.renderElement,$l=$t._batchIndexStart,$k=$t._batchIndexEnd-$l;$r.mainContext.drawElements(4,$k,5123,2*$l),$L.drawCall++,$L.trianglesFaces+=$k/3;},$t.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy();},$t._getVertexBuffer=function($d){return void 0===$d&&($d=0),this._vertexBuffer;},$i;}(),$Mt=function($d){function $t(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$t.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[];}$c($t,"laya.d3.core.ComponentNode",$I);var $l=$t.prototype;return $l.addComponent=function($d){var $t,$l=this._componentsMap.indexOf($d);if(-1===$l)$t=[],this._componentsMap.push($d),this._typeComponentsIndices.push($t);else if($t=this._typeComponentsIndices[$l],this._components[$t[0]].isSingleton)throw new Error("无法单实例创建"+$d+"组件，"+$d+"组件已存在！");var $k=$W.getInstance($d);return $t.push(this._components.length),this._components.push($k),$k instanceof laya.d3.component.Script&&this._scripts.push($k),$k._initialize(this),$k;},$l._removeComponent=function($d,$t){var $l=this._typeComponentsIndices[$d],$k=$l[$t],$W=this._components[$k];this._components.splice($k,1),$W instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($W),1),$l.splice($t,1),0===$l.length&&(this._typeComponentsIndices.splice($d,1),this._componentsMap.splice($d,1));for(var $i=0,$A=this._componentsMap.length;$i<$A;$i++)for(var $B=($l=this._typeComponentsIndices[$i]).length-1;0<=$B;$B--){var $o=$l[$B];if(!($k<$o))break;$l[$B]=--$o;}$W._destroy();},$l.getComponentByType=function($d,$t){void 0===$t&&($t=0);var $l=this._componentsMap.indexOf($d);return-1===$l?null:this._components[this._typeComponentsIndices[$l][$t]];},$l.getComponentsByType=function($d,$t){var $l=this._componentsMap.indexOf($d);if(-1!==$l){var $k=this._typeComponentsIndices[$l],$W=$k.length;$t.length=$W;for(var $i=0;$i<$W;$i++)$t[$i]=this._components[$k[$i]];}else $t.length=0;},$l.getComponentByIndex=function($d){return this._components[$d];},$l.removeComponentByType=function($d,$t){void 0===$t&&($t=0);var $l=this._componentsMap.indexOf($d);-1!==$l&&this._removeComponent($l,$t);},$l.removeComponentsByType=function($d){var $t=this._componentsMap.indexOf($d);if(-1!==$t)for(var $l=this._typeComponentsIndices[$t],$k=0,$W=$l.length;$k<$W;$l.length<$W?$W--:$k++)this._removeComponent($t,$k);},$l.removeAllComponent=function(){for(var $d=0,$t=this._componentsMap.length;$d<$t;this._componentsMap.length<$t?$t--:$d++)this.removeComponentsByType(this._componentsMap[$d]);},$l._updateComponents=function($d){for(var $t=0,$l=this._components.length;$t<$l;$t++){var $k=this._components[$t];!$k.started&&($k._start($d),$k.started=!0),$k.enable&&$k._update($d);}},$l._lateUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._lateUpdate($d);}},$l._preRenderUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._preRenderUpdate($d);}},$l._postRenderUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._postRenderUpdate($d);}},$t;}(),$Tt=function($k){function $d(){$d.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $Jt(),this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $Bt(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0;}$c($d,"laya.d3.core.material.BaseMaterial",$k);var $t=$d.prototype;return $R.imps($t,{"laya.d3.core.IClone":!0}),$t._addShaderDefine=function($d){this._shaderDefineValue|=$d;},$t._removeShaderDefine=function($d){this._shaderDefineValue&=~$d;},$t._addDisablePublicShaderDefine=function($d){this._disablePublicShaderDefine|=$d;},$t._removeDisablePublicShaderDefine=function($d){this._disablePublicShaderDefine&=~$d;},$t._setBuffer=function($d,$t){this._shaderValues.setValue($d,$t),this._values[$d]=$t;},$t._getBuffer=function($d){return this._values[$d];},$t._setMatrix4x4=function($d,$t){this._shaderValues.setValue($d,$t?$t.elements:null),this._values[$d]=$t;},$t._getMatrix4x4=function($d){return this._values[$d];},$t._setInt=function($d,$t){this._shaderValues.setValue($d,$t),this._values[$d]=$t;},$t._getInt=function($d){return this._values[$d];},$t._setNumber=function($d,$t){this._shaderValues.setValue($d,$t),this._values[$d]=$t;},$t._getNumber=function($d){return this._values[$d];},$t._setBool=function($d,$t){this._shaderValues.setValue($d,$t),this._values[$d]=$t;},$t._getBool=function($d){return this._values[$d];},$t._setVector2=function($d,$t){this._shaderValues.setValue($d,$t?$t.elements:null),this._values[$d]=$t;},$t._getVector2=function($d){return this._values[$d];},$t._setColor=function($d,$t){this._shaderValues.setValue($d,$t?$t.elements:null),this._values[$d]=$t;},$t._getColor=function($d){return this._values[$d];},$t._setTexture=function($d,$t){var $l=this._values[$d];this._values[$d]=$t,this._shaderValues.setValue($d,$t),0<this.referenceCount&&($l&&$l._removeReference(),$t&&$t._addReference());},$t._getTexture=function($d){return this._values[$d];},$t._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data);},$t._getShader=function($d,$t,$l){var $k=($d|$t)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($k,$l,this._shaderDefineValue),this._shader;},$t._setRenderStateBlendDepth=function(){var $d=$r.mainContext;switch($S.setDepthMask($d,this.depthWrite),0===this.depthTest?$S.setDepthTest($d,!1):($S.setDepthTest($d,!0),$S.setDepthFunc($d,this.depthTest)),this.blend){case 0:$S.setBlend($d,!1);break;case 1:$S.setBlend($d,!0),$S.setBlendFunc($d,this.srcBlend,this.dstBlend);break;case 2:$S.setBlend($d,!0);}},$t._setRenderStateFrontFace=function($d,$t){var $l=$r.mainContext,$k=0;switch(this.cull){case 0:$S.setCullFace($l,!1);break;case 1:$S.setCullFace($l,!0),$k=$d?$t&&$t._isFrontFaceInvert?2305:2304:$t&&$t._isFrontFaceInvert?2304:2305,$S.setFrontFace($l,$k);break;case 2:$S.setCullFace($l,!0),$k=$d?$t&&$t._isFrontFaceInvert?2304:2305:$t&&$t._isFrontFaceInvert?2305:2304,$S.setFrontFace($l,$k);}},$t.onAsynLoaded=function($d,$t,$l){var $k=$t[0],$W=$t[1];switch($k.version){case"LAYAMATERIAL:01":var $i=0,$A=0,$B=$k.props;for(var $o in $B)switch($o){case"vectors":var $I=$B[$o];for($i=0,$A=$I.length;$i<$A;$i++){var $b=$I[$i],$f=$b.value;switch($f.length){case 2:this[$b.name]=new $it($f[0],$f[1]);break;case 3:this[$b.name]=new $At($f[0],$f[1],$f[2]);break;case 4:this[$b.name]=new $Bt($f[0],$f[1],$f[2],$f[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}}break;case"textures":var $J=$B[$o];for($i=0,$A=$J.length;$i<$A;$i++){var $c=$J[$i],$Y=$c.path;$Y&&(this[$c.name]=$z.getRes($W[$Y]));}break;case"defines":var $w=$B[$o];for($i=0,$A=$w.length;$i<$A;$i++){var $D=this._shaderCompile.getMaterialDefineByName($w[$i]);this._addShaderDefine($D);}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$o]=$B[$o];break;case"renderQueue":switch($B[$o]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3;}break;default:this[$o]=$B[$o];}break;case"LAYAMATERIAL:02":for($o in $B=$k.props)switch($o){case"vectors":for($i=0,$A=($I=$B[$o]).length;$i<$A;$i++)switch(($f=($b=$I[$i]).value).length){case 2:this[$b.name]=new $it($f[0],$f[1]);break;case 3:this[$b.name]=new $At($f[0],$f[1],$f[2]);break;case 4:this[$b.name]=new $Bt($f[0],$f[1],$f[2],$f[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}break;case"textures":for($i=0,$A=($J=$B[$o]).length;$i<$A;$i++)($Y=($c=$J[$i]).path)&&(this[$c.name]=$z.getRes($W[$Y]));break;case"defines":for($i=0,$A=($w=$B[$o]).length;$i<$A;$i++)$D=this._shaderCompile.getMaterialDefineByName($w[$i]),this._addShaderDefine($D);break;default:this[$o]=$B[$o];}break;default:throw new Error("BaseMaterial:unkonwn version.");}this._endLoaded();},$t._addReference=function(){$k.prototype._addReference.call(this);for(var $d=0,$t=this._values.length;$d<$t;$d++){var $l=this._values[$d];$l&&$l instanceof laya.d3.resource.BaseTexture&&$l._addReference();}},$t._removeReference=function(){$k.prototype._removeReference.call(this);for(var $d=0,$t=this._values.length;$d<$t;$d++){var $l=this._values[$d];$l&&$l instanceof laya.d3.resource.BaseTexture&&$l._removeReference();}},$t.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null;},$t.setShaderName=function($d){var $t=$nt.nameKey.getID($d);if(-1===$t)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$Lt._preCompileShader[$t];},$t.cloneTo=function($d){var $t=$d;$t.name=this.name,$t.cull=this.cull,$t.blend=this.blend,$t.srcBlend=this.srcBlend,$t.dstBlend=this.dstBlend,$t.srcBlendRGB=this.srcBlendRGB,$t.dstBlendRGB=this.dstBlendRGB,$t.srcBlendAlpha=this.srcBlendAlpha,$t.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($t.blendConstColor),$t.blendEquation=this.blendEquation,$t.blendEquationRGB=this.blendEquationRGB,$t.blendEquationAlpha=this.blendEquationAlpha,$t.depthTest=this.depthTest,$t.depthWrite=this.depthWrite,$t.renderQueue=this.renderQueue,$t._shader=this._shader,$t._disablePublicShaderDefine=this._disablePublicShaderDefine,$t._shaderDefineValue=this._shaderDefineValue;var $l,$k=0,$W=$t._shaderValues;$t._shaderValues.data.length=this._shaderValues.data.length;var $i=this._values.length,$A=$t._values;for($k=0,$l=$A.length=$i;$k<$l;$k++){var $B=this._values[$k];if($B)if("number"==typeof $B)$A[$k]=$B,$W.data[$k]=$B;else if("number"==typeof $B&&Math.floor($B)==$B)$A[$k]=$B,$W.data[$k]=$B;else if("boolean"==typeof $B)$A[$k]=$B,$W.data[$k]=$B;else if($B instanceof laya.d3.math.Vector2){var $o=$A[$k]||($A[$k]=new $it());$B.cloneTo($o),$W.data[$k]=$o.elements;}else if($B instanceof laya.d3.math.Vector3){var $I=$A[$k]||($A[$k]=new $At());$B.cloneTo($I),$W.data[$k]=$I.elements;}else if($B instanceof laya.d3.math.Vector4){var $b=$A[$k]||($A[$k]=new $Bt());$B.cloneTo($b),$W.data[$k]=$b.elements;}else if($B instanceof laya.d3.math.Matrix4x4){var $f=$A[$k]||($A[$k]=new $dt());$B.cloneTo($f),$W.data[$k]=$f.elements;}else $B instanceof laya.d3.resource.BaseTexture&&($A[$k]=$B,$W.data[$k]=$B);}},$t.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$Y(0,$t,"alphaTestValue",function(){return this._getNumber(0);},function($d){this._setNumber(0,$d);}),$Y(0,$t,"alphaTest",function(){return this._alphaTest;},function($d){(this._alphaTest=$d)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST);}),$d.__init__=function(){$d.SHADERDEFINE_ALPHATEST=$d.shaderDefines.registerDefine("ALPHATEST");},$d.RENDERQUEUE_OPAQUE=2e3,$d.RENDERQUEUE_ALPHATEST=2450,$d.RENDERQUEUE_TRANSPARENT=3e3,$d.CULL_NONE=0,$d.CULL_FRONT=1,$d.CULL_BACK=2,$d.BLEND_DISABLE=0,$d.BLEND_ENABLE_ALL=1,$d.BLEND_ENABLE_SEPERATE=2,$d.BLENDPARAM_ZERO=0,$d.BLENDPARAM_ONE=1,$d.BLENDPARAM_SRC_COLOR=768,$d.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$d.BLENDPARAM_DST_COLOR=774,$d.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$d.BLENDPARAM_SRC_ALPHA=770,$d.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$d.BLENDPARAM_DST_ALPHA=772,$d.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$d.BLENDPARAM_SRC_ALPHA_SATURATE=776,$d.BLENDEQUATION_ADD=0,$d.BLENDEQUATION_SUBTRACT=1,$d.BLENDEQUATION_REVERSE_SUBTRACT=2,$d.DEPTHTEST_OFF=0,$d.DEPTHTEST_NEVER=512,$d.DEPTHTEST_LESS=513,$d.DEPTHTEST_EQUAL=514,$d.DEPTHTEST_LEQUAL=515,$d.DEPTHTEST_GREATER=516,$d.DEPTHTEST_NOTEQUAL=517,$d.DEPTHTEST_GEQUAL=518,$d.DEPTHTEST_ALWAYS=519,$d.SHADERDEFINE_ALPHATEST=1,$d.ALPHATESTVALUE=0,$f($d,["shaderDefines",function(){return this.shaderDefines=new $bt();}]),$d;}($D),$rt=function($d){function $t(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$t.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1;}$c($t,"laya.d3.resource.BaseTexture",$D);var $l=$t.prototype;return $Y(0,$l,"width",function(){return this._width;}),$Y(0,$l,"repeat",function(){return this._repeat;},function($d){if(this._repeat!==$d&&(this._repeat=$d,this._source)){var $t=$r.mainContext;$S.bindTexture($t,this._type,this._source),$H.isPOT(this._width,this._height)&&this._repeat?($t.texParameteri(this._type,10242,10497),$t.texParameteri(this._type,10243,10497)):($t.texParameteri(this._type,10242,33071),$t.texParameteri(this._type,10243,33071));}}),$Y(0,$l,"height",function(){return this._height;}),$Y(0,$l,"magFifter",function(){return this._magFifter;},function($d){(this._magFifter=$d)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($d);}),$Y(0,$l,"wrapModeV",function(){return this._wrapModeV;}),$Y(0,$l,"size",function(){return this._size;}),$Y(0,$l,"wrapModeU",function(){return this._wrapModeU;}),$Y(0,$l,"mipmap",function(){return this._mipmap;},function($d){this._mipmap=$d,this._mipmap!=$d&&this._conchTexture&&this._conchTexture.setMipMap($d);}),$Y(0,$l,"minFifter",function(){return this._minFifter;},function($d){this._minFifter=$d,this._minFifter!=$d&&this._conchTexture&&this._conchTexture.setMinFifter($d);}),$Y(0,$l,"format",function(){return this._format;}),$Y(0,$l,"source",function(){return this.activeResource(),this._source;}),$Y(0,$l,"defaulteTexture",function(){return $Nt.grayTexture;}),$t.WARPMODE_REPEAT=0,$t.WARPMODE_CLAMP=1,$t;}(),$St=function($d){function $t(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$t.__super.call(this),this._boundingBoxCorners=$k(8,null);}$c($t,"laya.d3.resource.models.BaseMesh",$D);var $l=$t.prototype;return $l._getPositions=function(){throw new Error("未Override,请重载该属性！");},$l._generateBoundingObject=function(){this._boundingSphere=new $ad(new $At(),0),$ad.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $Od(new $At(),new $At()),$Od.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners);},$l.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！");},$l.getRenderElement=function($d){throw new Error("未Override,请重载该属性！");},$Y(0,$l,"subMeshCount",function(){return this._subMeshCount;}),$Y(0,$l,"boundingBox",function(){return this._boundingBox;}),$Y(0,$l,"boundingBoxCorners",function(){return this._boundingBoxCorners;}),$Y(0,$l,"boundingSphere",function(){return this._boundingSphere;}),$t;}(),$jt=(function($d){function $t(){$t.__super.call(this);}$c($t,"laya.d3.component.Script",$gt);var $l=$t.prototype;$l.onTriggerEnter=function($d){},$l.onTriggerExit=function($d){},$l.onTriggerStay=function($d){},$Y(0,$l,"isSingleton",function(){return $t._isSingleton;}),$t._isSingleton=!1;}(),function($d){function $t($d){this._owner=null,this._sharedMesh=null,$t.__super.call(this),this._owner=$d;}$c($t,"laya.d3.core.MeshFilter",$d);var $l=$t.prototype;return $l._sharedMeshLoaded=function(){this.event("loaded");},$l._destroy=function(){$d.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null);},$Y(0,$l,"sharedMesh",function(){return this._sharedMesh;},function($d){var $t=this._sharedMesh;$t&&$t._removeReference(),(this._sharedMesh=$d)._addReference(),this.event("meshchanged",[this,$t,$d]),$d.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded);}),$Y(0,$l,"_isAsyncLoaded",function(){return this._sharedMesh.loaded;}),$Y(0,$l,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners;}),$Y(0,$l,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere;}),$Y(0,$l,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox;}),$t;}($Ht)),$Ct=function($d){function $t($d){$t.__super.call(this,$d),$d.meshFilter.on("meshchanged",this,this._onMeshChanged);}$c($t,"laya.d3.core.MeshRender",$Rt);var $l=$t.prototype;return $l._onMeshChanged=function($d,$t,$l){$l.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$l.once("loaded",this,this._onMeshLoaed);},$l._onMeshLoaed=function($d,$t){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0;},$l._calculateBoundingSphereByInitSphere=function($d){var $t=NaN,$l=this._owner.transform,$k=$l.scale.elements,$W=Math.abs($k[0]),$i=Math.abs($k[1]),$A=Math.abs($k[2]);$t=$i<=$W&&$A<=$W?$W:$A<=$i?$i:$A,$At.transformCoordinate($d.center,$l.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$d.radius*$t;},$l._calculateBoundBoxByInitCorners=function($d){for(var $t=this._owner.transform.worldMatrix,$l=0;$l<8;$l++)$At.transformCoordinate($d[$l],$t,$Rt._tempBoundBoxCorners[$l]);$Od.createfromPoints($Rt._tempBoundBoxCorners,this._boundingBox);},$l._calculateBoundingSphere=function(){var $d=this._owner.meshFilter.sharedMesh;null==$d||null==$d.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($d.boundingSphere);},$l._calculateBoundingBox=function(){var $d=this._owner.meshFilter.sharedMesh;null==$d||null==$d.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($d.boundingBoxCorners);},$l._renderUpdate=function($d){var $t=this._owner.transform;if($t){this._setShaderValueMatrix4x4(0,$t.worldMatrix);var $l=this._owner.getProjectionViewWorldMatrix($d);this._setShaderValueMatrix4x4(1,$l);}else this._setShaderValueMatrix4x4(0,$dt.DEFAULT),this._setShaderValueMatrix4x4(1,$d);return $zt.debugMode&&this._renderRenderableBoundBox(),!0;},$t;}(),$Kt=function($t){function $k(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$k.__super.call(this),this._renderState=new $m(),this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $Jt(),this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $td(),this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $At(.7,.7,.7),this.ambientColor=new $At(.212,.227,.259),$r.shaderHighPrecision&&this.addShaderDefine($Lt.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[];}$c($k,"laya.d3.core.scene.Scene",$t);var $d=$k.prototype;return $R.imps($d,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$d._setUrl=function($d){this._url=$d;},$d._getGroup=function(){return this._group;},$d._setGroup=function($d){this._group=$d;},$d._display=function(){$R.stage._scenes.push(this),$R.stage._scenes.sort($k._sortScenes);for(var $d=0,$t=this._childs.length;$d<$t;$d++){var $l=this._childs[$d];$l.active&&$l._activeHierarchy();}},$d._unDisplay=function(){var $d=$R.stage._scenes;$d.splice($d.indexOf(this),1);for(var $t=0,$l=this._childs.length;$t<$l;$t++){var $k=this._childs[$t];$k.active&&$k._inActiveHierarchy();}},$d._addChild3D=function($d){$d.transform._onWorldTransform(),$d._setBelongScene(this),this.displayedInStage&&$d.active&&$d._activeHierarchy();},$d._removeChild3D=function($d){$d.transform.parent=null,this.displayedInStage&&$d.active&&$d._inActiveHierarchy(),$d._setUnBelongScene();},$d.initOctree=function($d,$t,$l,$k,$W){void 0===$W&&($W=6),this.treeSize=new $At($d,$t,$l),this.treeLevel=$W,this.treeRoot=new $O(this,0),this.treeRoot.init($k,this.treeSize);},$d._prepareUpdateToRenderState=function($d,$t){$t.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$t.scene=this;},$d._prepareSceneToRender=function($d){var $t=this._lights.length;if(0<$t)for(var $l=0,$k=0;$k<$t&&!(this._lights[$k]._prepareToScene($d)&&++$l>=this._enableLightCount);$k++);},$d._updateChilds=function($d){for(var $t=0,$l=this._childs.length;$t<$l;++$t)this._childs[$t]._update($d);},$d._preRenderScene=function($d,$t,$l){var $k,$W=$t._viewMatrix,$i=$t._projectionMatrix,$A=$t._projectionViewMatrix,$B=0,$o=$t.camera;for($o.useOcclusionCulling?this.treeRoot?$ld.renderObjectCullingOctree($l,this,$o,$W,$i,$A):$ld.renderObjectCulling($l,this,$o,$W,$i,$A):$ld.renderObjectCullingNoBoundFrustum(this,$o,$W,$i,$A),$B=0,$k=this._quenes.length;$B<$k;$B++)this._quenes[$B]&&this._quenes[$B]._preRender($t);},$d._clear=function($d,$t){var $l=$t._viewport,$k=$t.camera,$W=$l.x,$i=$k.renderTargetSize.height-$l.y-$l.height,$A=$l.width,$B=$l.height;$d.viewport($W,$i,$A,$B);var $o=256,$I=$k.renderTarget;switch($k.clearFlag){case 0:var $b=$k.clearColor;if($b){$d.enable(3089),$d.scissor($W,$i,$A,$B);var $f=$b.elements;$d.clearColor($f[0],$f[1],$f[2],$f[3]),$o|=16384;}if($I)switch($b||($o=16384),$I.depthStencilFormat){case 33189:$o|=256;break;case 36168:$o|=1024;break;case 34041:$o|=256,$o|=1024;}$d.clear($o),$b&&$d.disable(3089);break;case 1:case 2:if($I)switch($o=16384,$I.depthStencilFormat){case 33189:$o|=256;break;case 36168:$o|=1024;break;case 34041:$o|=256,$o|=1024;}$d.clear($o);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.");}},$d._renderScene=function($d,$t){var $l,$k,$W=$t.camera,$i=0;for($i=0;$i<2;$i++)($k=this._quenes[$i])&&($W.renderTarget?$k._render($t,!0):$k._render($t,!1));if(1===$W.clearFlag){var $A=$W.sky;$A&&($S.setCullFace($d,!1),$S.setDepthFunc($d,515),$S.setDepthMask($d,!1),$A._render($t),$S.setDepthFunc($d,513),$S.setDepthMask($d,!0));}for($i=2,$l=this._quenes.length;$i<$l;$i++)($k=this._quenes[$i])&&($k._sortAlpha($t.camera.transform.position),$W.renderTarget?$k._render($t,!0):$k._render($t,!1));},$d._set3DRenderConfig=function($d){$d.disable(3042),$S._blend=!1,$d.blendFunc(770,771),$S._sFactor=770,$S._dFactor=771,$d.disable(2929),$S._depthTest=!1,$d.enable(2884),$S._cullFace=!0,$d.depthMask(1),$S._depthMask=!0,$d.frontFace(2304),$S._frontFace=2304;},$d._set2DRenderConfig=function($d){$S.setBlend($d,!0),$S.setBlendFunc($d,1,771),$S.setDepthTest($d,!1),$S.setCullFace($d,!1),$S.setDepthMask($d,!0),$S.setFrontFace($d,2305),$d.viewport(0,0,$b.width,$b.height);},$d._parseCustomProps=function($d,$t,$l,$k){var $W=$k.customProps.lightmaps,$i=$W.length,$A=this._lightmaps;$A.length=$i;for(var $B=0;$B<$i;$B++)$A[$B]=$z.getRes($t[$W[$B].replace(".exr",".png")]);this.setlightmaps($A);var $o=$k.customProps.ambientColor;$o&&(this.ambientColor=new $At($o[0],$o[1],$o[2]));var $I=$k.customProps.fogColor;$I&&(this.fogColor=new $At($I[0],$I[1],$I[2]));},$d._addLight=function($d){this._lights.indexOf($d)<0&&this._lights.push($d);},$d._removeLight=function($d){var $t=this._lights.indexOf($d);0<=$t&&this._lights.splice($t,1);},$d._updateScene=function(){var $d=this._renderState;this._prepareUpdateToRenderState($r.mainContext,$d),this._updateComponents($d),this._updateChilds($d),this._lateUpdateComponents($d),this._time+=$d.elapsedTime/1e3,this._shaderValues.setValue(22,this._time);},$d._updateSceneConch=function(){var $d=this._renderState;this._prepareUpdateToRenderState($r.mainContext,$d),this._updateComponents($d),this._lateUpdateComponents($d),this._prepareSceneToRender($d);for(var $t=0,$l=this._cameraPool.length;$t<$l;$t++){var $k=this._cameraPool[$t];($d.camera=$k)._prepareCameraToRender();}},$d._preRenderShadow=function($d,$t,$l,$k,$W){this.treeRoot?$ld.renderShadowObjectCullingOctree(this,$t,$l,$k,$W):$ld.renderShadowObjectCulling(this,$t,$l,$k,$W);for(var $i=0,$A=$l.length;$i<$A;$i++)$l[$i]&&$l[$i]._preRender($d);},$d._renderShadowMap=function($d,$t,$l){var $k=this.parallelSplitShadowMaps[0];$k._calcAllLightCameraInfo($l);var $W,$i,$A,$B=$k.PSSMNum;if(this._preRenderShadow($t,$k._lightCulling,$k._shadowQuenes,$k._lightVPMatrix[0],$B),this.addShaderDefine($ct.SHADERDEFINE_CAST_SHADOW),1<$B)for(var $o=0;$o<$B;$o++)$W=$k.getRenderTarget($o+1),$k.beginRenderTarget($o+1),$d.clearColor(1,1,1,1),$d.clear(16640),$d.viewport(0,0,$W.width,$W.height),$t.camera=$A=$k.getLightCamera($o),$A._prepareCameraToRender(),$A._prepareCameraViewProject($A.viewMatrix,$A.projectionMatrix),$t._projectionViewMatrix=$k._lightVPMatrix[$o+1],($i=$k._shadowQuenes[$o])._preRender($t),$i._renderShadow($t,!1),$k.endRenderTarget($o+1);else $W=$k.getRenderTarget(1),$k.beginRenderTarget(1),$d.clearColor(1,1,1,1),$d.clear(16640),$d.viewport(0,0,$W.width,$W.height),$t.camera=$A=$k.getLightCamera(0),$A._prepareCameraToRender(),$A._prepareCameraViewProject($A.viewMatrix,$A.projectionMatrix),$t._projectionViewMatrix=$k._lightVPMatrix[0],($i=$k._shadowQuenes[0])._preRender($t),$i._renderShadow($t,!0),$k.endRenderTarget(1);this.removeShaderDefine($ct.SHADERDEFINE_CAST_SHADOW);},$d.addTreeNode=function($d){this.treeRoot.addTreeNode($d);},$d.removeTreeNode=function($d){this.treeSize&&$d._treeNode&&$d._treeNode.removeObject($d);},$d.setlightmaps=function($d){this._lightmaps=$d;for(var $t=0,$l=this._renderableSprite3Ds.length;$t<$l;$t++)this._renderableSprite3Ds[$t]._render._applyLightMapParams();},$d.getlightmaps=function(){return this._lightmaps;},$d.addChildAt=function($d,$t){if(!($d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($d&&$d.__className));if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),0<=$t&&$t<=this._childs.length){if($d._parent===this){var $l=this.getChildIndex($d);this._childs.splice($l,1),this._childs.splice($t,0,$d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,$t)),this._childChanged();}else $d.parent&&$d.parent.removeChild($d),this._childs===$I.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($t,0,$d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,$t),($d.parent=this)._addChild3D($d);return $d;}throw new Error("appendChildAt:The index is out of bounds");},$d.addChild=function($d){if(!($d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),$d._parent===this){var $t=this.getChildIndex($d);$t!==this._childs.length-1&&(this._childs.splice($t,1),this._childs.push($d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,this._childs.length-1)),this._childChanged());}else $d.parent&&$d.parent.removeChild($d),this._childs===$I.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,this._childs.length-1),($d.parent=this)._childChanged(),this._addChild3D($d);return $d;},$d.removeChildAt=function($d){var $t=this.getChildAt($d);return $t&&(this._removeChild3D($t),this._childs.splice($d,1),this.conchModel&&this.conchModel.removeChild($t.conchModel),$t.parent=null),$t;},$d.removeChildren=function($d,$t){if(void 0===$d&&($d=0),void 0===$t&&($t=2147483647),this._childs&&0<this._childs.length){var $l=this._childs;if(0===$d&&$i<=$t){var $k=$l;this._childs=$I.ARRAY_EMPTY;}else $k=$l.splice($d,$t-$d);for(var $W=0,$i=$k.length;$W<$i;$W++)this._removeChild3D($k[$W]),$k[$W].parent=null,this.conchModel&&this.conchModel.removeChild($k[$W].conchModel);}return this;},$d.addFrustumCullingObject=function($d){this.treeRoot?this.addTreeNode($d):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($d):this._cullingRenders[this._cullingRendersLength]=$d,$d._indexInSceneFrustumCullingObjects=this._cullingRendersLength++);},$d.removeFrustumCullingObject=function($d){if(this.treeRoot)this.removeTreeNode($d);else{this._cullingRendersLength--;var $t=$d._indexInSceneFrustumCullingObjects;if($t!==this._cullingRendersLength){var $l=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$t]=$l)._indexInSceneFrustumCullingObjects=$t,$d._indexInSceneFrustumCullingObjects=-1;}}},$d.getRenderQueue=function($d){return $d<3e3?this._quenes[1]||(this._quenes[1]=new $X(this)):this._quenes[2]||(this._quenes[2]=new $X(this));},$d.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $X(this);},$d.addShaderDefine=function($d){this._shaderDefineValue|=$d;},$d.removeShaderDefine=function($d){this._shaderDefineValue&=~$d;},$d.addScript=function($d){return this._addComponent($d);},$d.getScriptByType=function($d,$t){return void 0===$t&&($t=0),this._getComponentByType($d,$t);},$d.getScriptsByType=function($d,$t){this._getComponentsByType($d,$t);},$d.getScriptByIndex=function($d){return this._getComponentByIndex($d);},$d.removeScriptByType=function($d,$t){void 0===$t&&($t=0),this._removeComponentByType($d,$t);},$d.removeScriptsByType=function($d){this._removeComponentByType($d);},$d.removeAllScript=function(){this._removeAllComponent();},$d.render=function($d,$t,$l){($w._context.ctx._renderKey=0)<this._childs.length&&$d.addRenderObject(this);},$d.renderSubmit=function(){var $d=$r.mainContext,$t=this._renderState;this._set3DRenderConfig($d),this._prepareSceneToRender(this._renderState);var $l,$k=0,$W=0;if($zt.debugMode||$O.debugMode)for($k=0,$W=this._cameraPool.length;$k<$W;$k++)$l=this._cameraPool[$k],$zt._debugPhasorSprite.begin(1,$l),$l.activeInHierarchy&&$l._renderCamera($d,$t,this),$zt._debugPhasorSprite.end();else for($k=0,$W=this._cameraPool.length;$k<$W;$k++)($l=this._cameraPool[$k]).activeInHierarchy&&$l._renderCamera($d,$t,this);return this._set2DRenderConfig($d),1;},$d.onAsynLoaded=function($d,$t,$l){var $k=$t[0];if("Scene"!==$k.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $W=$t[1];$Dt._createNodeByJson(this,$k,this,$W),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$d.destroy=function($d){void 0===$d&&($d=!0),this.destroyed||($t.prototype.destroy.call(this,$d),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$z.clearRes(this.url),this.loaded||$zt._cancelLoadByUrl(this.url));},$d.getRenderType=function(){return 0;},$d.releaseRender=function(){},$d._addComponent=function($d){var $t,$l=this._componentsMap.indexOf($d);if(-1===$l)$t=[],this._componentsMap.push($d),this._typeComponentsIndices.push($t);else if($t=this._typeComponentsIndices[$l],this._components[$t[0]].isSingleton)throw new Error("无法单实例创建"+$d+"组件，"+$d+"组件已存在！");var $k=$W.getInstance($d);$t.push(this._components.length),this._components.push($k);return $k._initialize(this),$k;},$d._removeComponent=function($d,$t){var $l=this._typeComponentsIndices[$d],$k=$l[$t],$W=this._components[$k];this._components.splice($k,1),$l.splice($t,1),0===$l.length&&(this._typeComponentsIndices.splice($d,1),this._componentsMap.splice($d,1));for(var $i=0,$A=this._componentsMap.length;$i<$A;$i++)for(var $B=($l=this._typeComponentsIndices[$i]).length-1;0<=$B;$B--){var $o=$l[$B];if(!($k<$o))break;$l[$B]=--$o;}$W._destroy();},$d._getComponentByType=function($d,$t){void 0===$t&&($t=0);var $l=this._componentsMap.indexOf($d);return-1===$l?null:this._components[this._typeComponentsIndices[$l][$t]];},$d._getComponentsByType=function($d,$t){var $l=this._componentsMap.indexOf($d);if(-1!==$l){var $k=this._typeComponentsIndices[$l],$W=$k.length;$t.length=$W;for(var $i=0;$i<$W;$i++)$t[$i]=this._components[$k[$i]];}else $t.length=0;},$d._getComponentByIndex=function($d){return this._components[$d];},$d._removeComponentByType=function($d,$t){void 0===$t&&($t=0);var $l=this._componentsMap.indexOf($d);-1!==$l&&this._removeComponent($l,$t);},$d._removeComponentsByType=function($d){var $t=this._componentsMap.indexOf($d);if(-1!==$t)for(var $l=this._typeComponentsIndices[$t],$k=0,$W=$l.length;$k<$W;$l.length<$W?$W--:$k++)this._removeComponent($t,$k);},$d._removeAllComponent=function(){for(var $d=0,$t=this._componentsMap.length;$d<$t;this._componentsMap.length<$t?$t--:$d++)this._removeComponentsByType(this._componentsMap[$d]);},$d._updateComponents=function($d){for(var $t=0,$l=this._components.length;$t<$l;$t++){var $k=this._components[$t];!$k.started&&($k._start($d),$k.started=!0),$k.enable&&$k._update($d);}},$d._lateUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._lateUpdate($d);}},$d._preRenderUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._preRenderUpdate($d);}},$d._postRenderUpdateComponents=function($d){for(var $t=0;$t<this._components.length;$t++){var $l=this._components[$t];!$l.started&&($l._start($d),$l.started=!0),$l.enable&&$l._postRenderUpdate($d);}},$Y(0,$d,"_loaded",null,function($d){this.__loaded=$d;}),$Y(0,$d,"fogColor",function(){return this._fogColor;},function($d){this._fogColor=$d,this._shaderValues.setValue(0,$d.elements);}),$Y(0,$d,"enableFog",function(){return this._enableFog;},function($d){this._enableFog!==$d&&((this._enableFog=$d)?(this.addShaderDefine($Lt.SHADERDEFINE_FOG),this.removeShaderDefine($Lt.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($Lt.SHADERDEFINE_FOG));}),$Y(0,$d,"url",function(){return this._url;}),$Y(0,$d,"loaded",function(){return this.__loaded;}),$Y(0,$d,"enableDepthFog",function(){return this._enableDepthFog;},function($d){this._enableDepthFog!=$d&&((this._enableDepthFog=$d)?(this.addShaderDefine($Lt.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($Lt.SHADERDEFINE_FOG)):this.removeShaderDefine($Lt.SAHDERDEFINE_DEPTHFOG));}),$Y(0,$d,"fogStart",function(){return this._fogStart;},function($d){this._fogStart=$d,this._shaderValues.setValue(1,$d);}),$Y(0,$d,"fogRange",function(){return this._fogRange;},function($d){this._fogRange=$d,this._shaderValues.setValue(2,$d);}),$Y(0,$d,"ambientColor",function(){return this._ambientColor;},function($d){this._ambientColor=$d,this._shaderValues.setValue(21,$d.elements);}),$Y(0,$d,"scene",function(){return this;}),$Y(0,$d,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice();}),$k._sortScenes=function($d,$t){if($d.parent!==$R.stage||$t.parent!==$R.stage)return $d.parent!==$R.stage&&$t.parent!==$R.stage?$k._sortScenes($d.parent,$t.parent):$d.parent===$R.stage?-1:1;var $l=$R.stage._childs;return $l.indexOf($d)-$l.indexOf($t);},$k.load=function($d){return $R.loader.create($d,null,null,$k);},$k.FOGCOLOR=0,$k.FOGSTART=1,$k.FOGRANGE=2,$k.LIGHTDIRECTION=3,$k.LIGHTDIRCOLOR=4,$k.POINTLIGHTPOS=5,$k.POINTLIGHTRANGE=6,$k.POINTLIGHTATTENUATION=7,$k.POINTLIGHTCOLOR=8,$k.SPOTLIGHTPOS=9,$k.SPOTLIGHTDIRECTION=10,$k.SPOTLIGHTSPOT=11,$k.SPOTLIGHTRANGE=12,$k.SPOTLIGHTATTENUATION=13,$k.SPOTLIGHTCOLOR=14,$k.SHADOWDISTANCE=15,$k.SHADOWLIGHTVIEWPROJECT=16,$k.SHADOWMAPPCFOFFSET=17,$k.SHADOWMAPTEXTURE1=18,$k.SHADOWMAPTEXTURE2=19,$k.SHADOWMAPTEXTURE3=20,$k.AMBIENTCOLOR=21,$k.TIME=22,$k;}($q),$xt=function($d){function $t($d){$t.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $dt(),this._shaderValues=new $Jt(),this._colliders=[],this._id=++$t._uniqueIDCounter,this._transform=new $Gt(this),this.name=$d||"Sprite3D-"+$t._nameNumberCounter++,this.layer=$C.currentCreationLayer,this.active=!0;}$c($t,"laya.d3.core.Sprite3D",$Mt);var $l=$t.prototype;return $R.imps($l,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$l._setUrl=function($d){this._url=$d;},$l._getGroup=function(){return this._group;},$l._setGroup=function($d){this._group=$d;},$l._addChild3D=function($d){$d.transform.parent=this.transform,this._hierarchyAnimator&&(!$d._hierarchyAnimator&&$d._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($d,!0,[$d.name])),this._scene&&($d._setBelongScene(this._scene),this._activeInHierarchy&&$d._active&&$d._activeHierarchy());},$l._removeChild3D=function($d){$d.transform.parent=null,this._scene&&(this._activeInHierarchy&&$d._active&&$d._inActiveHierarchy(),$d._setUnBelongScene()),this._hierarchyAnimator&&($d._hierarchyAnimator==this._hierarchyAnimator&&$d._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($d,!1,[$d.name]));},$l._parseBaseCustomProps=function($d){var $t=this.transform.localPosition;$d.translate?($t.fromArray($d.translate),$t.x*=100,$t.y*=100,$t.z*=100):$t.elements.fill(0),this.transform.localPosition=$t;var $l=this.transform.localRotation;$d.rotation?$l.fromArray($d.rotation):$l.fromArray([0,0,0,-1]),this.transform.localRotation=$l;var $k=this.transform.localScale;$d.scale?$k.fromArray($d.scale):$k.elements.fill(1),this.transform.localScale=$k;var $W=$d.layer;null!=$W&&(this.layer=$C.getLayerByNumber($W));},$l._parseCustomComponent=function($d,$t,$l){for(var $k in $l){var $W=$l[$k];switch($k){case"Animator":var $i=this.addComponent(Animator);if($W.avatarPath)$i.avatar=$z.getRes($t[$W.avatarPath]);else{var $A=$W.avatar;if($A){$i.avatar=$z.getRes($t[$A.path]);var $B=$A.linkSprites;$B&&$d.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$i,$B]);}}for(var $o=$W.clipPaths,$I=$o.length,$b=0;$b<$I;$b++)$i.addClip($z.getRes($t[$o[$b]]));$i.clip=$z.getRes($t[$o[0]]);var $f=$W.playOnWake;void 0!==$f&&($i.playOnWake=$f);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $J=this.addComponent(SphereCollider);$J.isTrigger=$W.isTrigger;var $c=$J.center;$c.fromArray($W.center),$J.center=$c,$J.radius=$W.radius;break;case"BoxCollider":var $Y=this.addComponent(BoxCollider);$Y.isTrigger=$W.isTrigger,$Y.center.fromArray($W.center);var $w=$Y.size;$w.fromArray($W.size),$Y.size=$w;break;case"MeshCollider":this.addComponent(MeshCollider);}}},$l._onRootNodeHierarchyLoaded=function($d,$t){for(var $l in $t){for(var $k=this,$W=$t[$l],$i=0,$A=$W.length;$i<$A;$i++){var $B=$W[$i];if(""===$B)break;if(!($k=$k.getChildByName($B)))break;}$k&&$d.linkSprite3DToAvatarNode($l,$k);}},$l._setHierarchyAnimator=function($d,$t){this._changeHierarchyAnimator($d);for(var $l=0,$k=this._childs.length;$l<$k;$l++){var $W=this._childs[$l];$W._hierarchyAnimator==$t&&$W._setHierarchyAnimator($d,$t);}},$l._clearHierarchyAnimator=function($d,$t){this._changeHierarchyAnimator($t);for(var $l=0,$k=this._childs.length;$l<$k;$l++){var $W=this._childs[$l];$W._hierarchyAnimator==$d&&$W._clearHierarchyAnimator($d,$t);}},$l._getAnimatorToLinkSprite3D=function($d,$t,$l){var $k=this.getComponentByType(Animator);if($k&&($k.avatar?$k.avatar._version||$d._setAnimatorToLinkAvatar($k,$t):$d._setAnimatorToLinkSprite3DNoAvatar($k,$t,$l)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$l.unshift(this._parent.name);var $W=this._parent;$W._hierarchyAnimator&&$W._getAnimatorToLinkSprite3D($d,$t,$l);}},$l._setAnimatorToLinkSprite3DNoAvatar=function($d,$t,$l){var $k=0,$W=0;for($k=0,$W=$d.getClipCount();$k<$W;$k++)$d._handleSpriteOwnersBySprite($k,$t,$l,this);for($k=0,$W=this._childs.length;$k<$W;$k++){var $i=this._childs[$k],$A=$l.length;$l.push($i.name),$i._setAnimatorToLinkSprite3DNoAvatar($d,$t,$l),$l.splice($A,1);}},$l._changeHierarchyAnimator=function($d){this._hierarchyAnimator=$d;},$l._isLinkSpriteToAnimationNode=function($d,$t,$l){var $k=$d._avatarNodes.indexOf($t),$W=$d._cacheSpriteToNodesMap;if($l)this._transform.dummy=$t.transform,$d._cacheNodesToSpriteMap[$k]=$W.length,$W.push($k);else{this._transform.dummy=null;var $i=$d._cacheNodesToSpriteMap[$k];$d._cacheNodesToSpriteMap[$k]=null,$W.splice($i,1);}},$l._setBelongScene=function($d){this._scene=$d;for(var $t=0,$l=this._childs.length;$t<$l;$t++)this._childs[$t]._setBelongScene($d);},$l._setUnBelongScene=function(){this._scene=null;for(var $d=0,$t=this._childs.length;$d<$t;$d++)this._childs[$d]._setUnBelongScene();},$l._activeHierarchy=function(){var $d=0,$t=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$d=0,$t=this._colliders.length;$d<$t;$d++)this._layer._addCollider(this._colliders[$d]);for(this.event("activeinhierarchychanged",!0),$d=0,$t=this._childs.length;$d<$t;$d++){var $l=this._childs[$d];$l._active&&$l._activeHierarchy();}},$l._inActiveHierarchy=function(){var $d=0,$t=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$d=0,$t=this._colliders.length;$d<$t;$d++){var $l=this._colliders[$d];$l._clearCollsionMap(),this._layer._removeCollider($l);}for(this.event("activeinhierarchychanged",!1),$d=0,$t=this._childs.length;$d<$t;$d++){var $k=this._childs[$d];$k._active&&$k._inActiveHierarchy();}},$l.addComponent=function($d){var $t,$l=this._componentsMap.indexOf($d);if(-1===$l)$t=[],this._componentsMap.push($d),this._typeComponentsIndices.push($t);else if($t=this._typeComponentsIndices[$l],this._components[$t[0]].isSingleton)throw new Error("无法单实例创建"+$d+"组件，"+$d+"组件已存在！");var $k=$W.getInstance($d);return $t.push(this._components.length),this._components.push($k),$k instanceof laya.d3.component.Script&&this._scripts.push($k),$k._initialize(this),$k;},$l._removeComponent=function($d,$t){var $l,$k=0,$W=this._typeComponentsIndices[$d],$i=$W[$t],$A=this._components[$i];for($A instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($A),1),$W.splice($t,1),0===$W.length&&(this._typeComponentsIndices.splice($d,1),this._componentsMap.splice($d,1)),$k=0,$l=this._componentsMap.length;$k<$l;$k++)for(var $B=($W=this._typeComponentsIndices[$k]).length-1;0<=$B;$B--){var $o=$W[$B];if(!($i<$o))break;$W[$B]=--$o;}$A._destroy();},$l._clearSelfRenderObjects=function(){},$l._addSelfRenderObjects=function(){},$l._parseCustomProps=function($d,$t,$l,$k){},$l._updateChilds=function($d){var $t=this._childs.length;if(0!==$t)for(var $l=0;$l<$t;++$l)this._childs[$l]._update($d);},$l._getSortID=function($d,$t){return 1e3*$t.id+$d._getVertexBuffer().vertexDeclaration.id;},$l._update=function($d){($d.owner=this)._activeInHierarchy&&(this._updateComponents($d),this._lateUpdateComponents($d),$L.spriteCount++,this._childs.length&&this._updateChilds($d));},$l.getProjectionViewWorldMatrix=function($d){return $dt.multiply($d,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix;},$l.loadHierarchy=function($d){this.addChild(laya.d3.core.Sprite3D.load($d));},$l.addChildAt=function($d,$t){if(!($d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),0<=$t&&$t<=this._childs.length){if($d._parent===this){var $l=this.getChildIndex($d);this._childs.splice($l,1),this._childs.splice($t,0,$d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,$t)),this._childChanged();}else $d.parent&&$d.parent.removeChild($d),this._childs===$I.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($t,0,$d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,$t),($d.parent=this)._addChild3D($d);return $d;}throw new Error("appendChildAt:The index is out of bounds");},$l.addChild=function($d){if(!($d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$d||this.destroyed||$d===this)return $d;if($d.zOrder&&this._set$P("hasZorder",!0),$d._parent===this){var $t=this.getChildIndex($d);$t!==this._childs.length-1&&(this._childs.splice($t,1),this._childs.push($d),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($d.conchModel,this._childs.length-1)),this._childChanged());}else $d.parent&&$d.parent.removeChild($d),this._childs===$I.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($d),this.conchModel&&this.conchModel.addChildAt($d.conchModel,this._childs.length-1),($d.parent=this)._childChanged(),this._addChild3D($d);return $d;},$l.removeChildAt=function($d){var $t=this.getChildAt($d);return $t&&(this._removeChild3D($t),this._childs.splice($d,1),this.conchModel&&this.conchModel.removeChild($t.conchModel),$t.parent=null),$t;},$l.removeChildren=function($d,$t){if(void 0===$d&&($d=0),void 0===$t&&($t=2147483647),this._childs&&0<this._childs.length){var $l=this._childs;if(0===$d&&$i<=$t){var $k=$l;this._childs=$I.ARRAY_EMPTY;}else $k=$l.splice($d,$t-$d);for(var $W=0,$i=$k.length;$W<$i;$W++)this._removeChild3D($k[$W]),$k[$W].parent=null,this.conchModel&&this.conchModel.removeChild($k[$W].conchModel);}return this;},$l.onAsynLoaded=function($d,$t,$l){var $k=$t[0];if("Sprite3D"!==$k.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $W=$t[1];$Dt._createNodeByJson(this,$k,this,$W),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$l.cloneTo=function($d){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $t=$d;$t.name=this.name,$t._destroyed=this._destroyed,$t.timer=this.timer,$t._$P=this._$P,$t.active=this._active;var $l=$t.transform.localPosition;this.transform.localPosition.cloneTo($l),$t.transform.localPosition=$l;var $k=$t.transform.localRotation;this.transform.localRotation.cloneTo($k),$t.transform.localRotation=$k;var $W=$t.transform.localScale;this.transform.localScale.cloneTo($W),$t.transform.localScale=$W,$t.isStatic=this.isStatic;var $i=0,$A=0;for($i=0,$A=this._componentsMap.length;$i<$A;$i++){var $B=$t.addComponent(this._componentsMap[$i]);this._components[$i]._cloneTo($B);}for($i=0,$A=this._childs.length;$i<$A;$i++)$t.addChild(this._childs[$i].clone());var $o=$t.getComponentByType(Animator);if($o){var $I=$o._linkSpritesData;if($I)for(var $b in $I){for(var $f=$I[$b],$J=$t,$c=0,$Y=$f.length;$c<$Y&&($J=$J.getChildByName($f[$c]));$c++);if($J){var $w=$o._avatarNodeMap[$b];$J._isLinkSpriteToAnimationNode($o,$w,!0);}}}},$l.clone=function(){var $d=new this.constructor();return this.cloneTo($d),$d;},$l.destroy=function($d){if(void 0===$d&&($d=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$d);var $t,$l=0;for($l=0,$t=this._components.length;$l<$t;$l++)this._components[$l]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$z.clearRes(this.url),this.loaded||$zt._cancelLoadByUrl(this.url);}},$l._handleSpriteToAvatar=function($d,$t){$d._avatarNodes;var $l=$d._avatarNodeMap[this.name];$l&&$l.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($d,$l,$t);},$l._setAnimatorToLinkAvatar=function($d,$t){this._handleSpriteToAvatar($d,$t);for(var $l=0,$k=this._childs.length;$l<$k;$l++){this._childs[$l]._setAnimatorToLinkAvatar($d,$t);}},$Y(0,$l,"activeInHierarchy",function(){return this._activeInHierarchy;}),$Y(0,$l,"_loaded",null,function($d){this.__loaded=$d;}),$Y(0,$l,"active",function(){return this._active;},function($d){this._active!==$d&&(this._active=$d,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($d?this._activeHierarchy():this._inActiveHierarchy()));}),$Y(0,$l,"componentsCount",function(){return this._components.length;}),$Y(0,$l,"loaded",function(){return this.__loaded;}),$Y(0,$l,"id",function(){return this._id;}),$Y(0,$l,"url",function(){return this._url;}),$Y(0,$l,"layer",function(){return this._layer;},function($d){if(this._layer!==$d){if(!$d)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $t=0,$l=this._colliders.length;if(this._layer)for($t=0;$t<$l;$t++)this._layer._removeCollider(this._colliders[$t]);for($t=0;$t<$l;$t++)$d._addCollider(this._colliders[$t]);}this._layer=$d,this.event("layerchanged",$d);}}),$Y(0,$l,"scene",function(){return this._scene;}),$Y(0,$l,"transform",function(){return this._transform;}),$t.instantiate=function($d,$t,$l,$k,$W){void 0===$l&&($l=!0);var $i=$d.clone();$t&&$t.addChild($i);var $A=$i.transform;if($l){var $B=$A.worldMatrix;$d.transform.worldMatrix.cloneTo($B),$A.worldMatrix=$B;}else $k&&($A.position=$k),$W&&($A.rotation=$W);return $i;},$t.load=function($d){return $R.loader.create($d,null,null,$t);},$t.WORLDMATRIX=0,$t.MVPMATRIX=1,$t._uniqueIDCounter=0,$t._nameNumberCounter=0,$t;}(),$nt=function($d){function $b($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$b.__super.call(this),!$d||!$t)throw"Shader Error";this._id=++$b._count,this._vs=$d,this._ps=$t,this._attributeMap=$l,this._sceneUniformMap=$k,this._cameraUniformMap=$W,this._spriteUniformMap=$i,this._materialUniformMap=$A,this._renderElementUniformMap=$B,this._precompile=$o,this._define=$I,this._precompile&&$b.extCompileObj&&$b.extCompileFunc?$b.extCompileFunc.call($b.extCompileObj,$d,$t,$I):this.recreateResource();}$c($b,"laya.d3.shader.Shader3D",$l);var $t=$b.prototype;return $t.recreateResource=function(){$j.now();this._compile(),this.completeCreate(),this.memorySize=0;},$t.disposeResource=function(){$r.mainContext.deleteShader(this._vshader),$r.mainContext.deleteShader(this._pshader),$r.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0;},$t._compile=function(){if(!$r.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $d=[this._vs,this._ps],$t=$r.mainContext;if(this._program=$t.createProgram(),this._vshader=$b._createShader($t,$d[0],35633),this._pshader=$b._createShader($t,$d[1],35632),$t.attachShader(this._program,this._vshader),$t.attachShader(this._program,this._pshader),$t.linkProgram(this._program),!$w.isConchApp&&$Lt.debugMode&&!$t.getProgramParameter(this._program,35714))throw $t.getProgramInfoLog(this._program);var $l,$k=0,$W=0,$i=0;for($i=$w.isConchApp?$t.getProgramParameterEx(this._vs,this._ps,"",35721):$t.getProgramParameter(this._program,35721),$k=0;$k<$i;$k++){var $A=null;$l={vartype:"attribute",ivartype:0,attrib:$A=$w.isConchApp?$t.getActiveAttribEx(this._vs,this._ps,"",$k):$t.getActiveAttrib(this._program,$k),location:$t.getAttribLocation(this._program,$A.name),name:$A.name,type:$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($l);}var $B=0;for($B=$w.isConchApp?$t.getProgramParameterEx(this._vs,this._ps,"",35718):$t.getProgramParameter(this._program,35718),$k=0;$k<$B;$k++){var $o=null;$o=$w.isConchApp?$t.getActiveUniformEx(this._vs,this._ps,"",$k):$t.getActiveUniform(this._program,$k),0<($l={vartype:"uniform",ivartype:1,attrib:$A,location:$t.getUniformLocation(this._program,$o.name),name:$o.name,type:$o.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($l.name=$l.name.substr(0,$l.name.length-3),$l.isArray=!0,$l.location=$t.getUniformLocation(this._program,$l.name)),this._uniformParams.push($l);}for($k=0,$W=this._attributeParams.length;$k<$W;$k++)($l=this._attributeParams[$k]).indexOfParams=$k,$l.index=1,$l.value=[$l.location,null],$l.codename=$l.name,$l.name=null!=this._attributeMap[$l.codename]?this._attributeMap[$l.codename]:$l.codename,this._attributeParamsMap.push($l.name),this._attributeParamsMap.push($l),$l._this=this,$l.uploadedValue=[],$l.fun=this._attribute;for($k=0,$W=this._uniformParams.length;$k<$W;$k++)switch(($l=this._uniformParams[$k]).indexOfParams=$k,$l.index=1,$l.value=[$l.location,null],$l.codename=$l.name,null!=this._sceneUniformMap[$l.codename]?($l.name=this._sceneUniformMap[$l.codename],this._sceneUniformParamsMap.push($l.name),this._sceneUniformParamsMap.push($l)):null!=this._cameraUniformMap[$l.codename]?($l.name=this._cameraUniformMap[$l.codename],this._cameraUniformParamsMap.push($l.name),this._cameraUniformParamsMap.push($l)):null!=this._spriteUniformMap[$l.codename]?($l.name=this._spriteUniformMap[$l.codename],this._spriteUniformParamsMap.push($l.name),this._spriteUniformParamsMap.push($l)):null!=this._materialUniformMap[$l.codename]?($l.name=this._materialUniformMap[$l.codename],this._materialUniformParamsMap.push($l.name),this._materialUniformParamsMap.push($l)):null!=this._renderElementUniformMap[$l.codename]?($l.name=this._renderElementUniformMap[$l.codename],this._renderElementUniformParamsMap.push($l.name),this._renderElementUniformParamsMap.push($l)):console.log("Shader:can't find uinform name:"+$l.codename+" in shader file."),$l._this=this,$l.uploadedValue=[],$l.type){case 5124:$l.fun=$l.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$l.fun=$l.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$l.fun=$l.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$l.fun=$l.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$l.fun=$l.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$l.fun=this._uniform_sampler2D;break;case 35680:$l.fun=this._uniform_samplerCube;break;case 35676:$l.fun=this._uniformMatrix4fv;break;case 35670:$l.fun=this._uniform1i;break;case 35674:$l.fun=this._uinformMatrix2fv;break;case 35675:$l.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!");}}},$t._attribute=function($d,$t){var $l=$r.mainContext,$k=$B._enableAtributes,$W=$d.location;return $k[$W]||$l.enableVertexAttribArray($W),$l.vertexAttribPointer($W,$t[0],$t[1],$t[2],$t[3],$t[4]),$k[$W]=$B._bindVertexBuffer,1;},$t._uniform1f=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t?($r.mainContext.uniform1f($d.location,$l[0]=$t),1):0;},$t._uniform1fv=function($d,$t){if($t.length<4){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($r.mainContext.uniform1fv($d.location,$t),$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3],1):0;}return $r.mainContext.uniform1fv($d.location,$t),1;},$t._uniform_vec2=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]?($r.mainContext.uniform2f($d.location,$l[0]=$t[0],$l[1]=$t[1]),1):0;},$t._uniform_vec2v=function($d,$t){if($t.length<2){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($r.mainContext.uniform2fv($d.location,$t),$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3],1):0;}return $r.mainContext.uniform2fv($d.location,$t),1;},$t._uniform_vec3=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]?($r.mainContext.uniform3f($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2]),1):0;},$t._uniform_vec3v=function($d,$t){return $r.mainContext.uniform3fv($d.location,$t),1;},$t._uniform_vec4=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($r.mainContext.uniform4f($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3]),1):0;},$t._uniform_vec4v=function($d,$t){return $r.mainContext.uniform4fv($d.location,$t),1;},$t._uniformMatrix2fv=function($d,$t){return $r.mainContext.uniformMatrix2fv($d.location,!1,$t),1;},$t._uniformMatrix3fv=function($d,$t){return $r.mainContext.uniformMatrix3fv($d.location,!1,$t),1;},$t._uniformMatrix4fv=function($d,$t){return $r.mainContext.uniformMatrix4fv($d.location,!1,$t),1;},$t._uinformMatrix2fv=function($d,$t){return $r.mainContext.uniformMatrix2fv($d.location,!1,$t),1;},$t._uinformMatrix3fv=function($d,$t){return $r.mainContext.uniformMatrix3fv($d.location,!1,$t),1;},$t._uniform1i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t?($r.mainContext.uniform1i($d.location,$l[0]=$t),1):0;},$t._uniform1iv=function($d,$t){return $r.mainContext.uniform1iv($d.location,$t),1;},$t._uniform_ivec2=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]?($r.mainContext.uniform2i($d.location,$l[0]=$t[0],$l[1]=$t[1]),1):0;},$t._uniform_ivec2v=function($d,$t){return $r.mainContext.uniform2iv($d.location,$t),1;},$t._uniform_vec3i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]?($r.mainContext.uniform3i($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2]),1):0;},$t._uniform_vec3vi=function($d,$t){return $r.mainContext.uniform3iv($d.location,$t),1;},$t._uniform_vec4i=function($d,$t){var $l=$d.uploadedValue;return $l[0]!==$t[0]||$l[1]!==$t[1]||$l[2]!==$t[2]||$l[3]!==$t[3]?($r.mainContext.uniform4i($d.location,$l[0]=$t[0],$l[1]=$t[1],$l[2]=$t[2],$l[3]=$t[3]),1):0;},$t._uniform_vec4vi=function($d,$t){return $r.mainContext.uniform4iv($d.location,$t),1;},$t._uniform_sampler2D=function($d,$t){var $l=$t.source||$t.defaulteTexture.source,$k=$r.mainContext,$W=$d.uploadedValue;if(null!=$W[0])return $k.activeTexture($b._TEXTURES[$W[0]]),$l&&$S.bindTexture($k,3553,$l),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $W[0]=this._curActTexIndex,$k.uniform1i($d.location,this._curActTexIndex),$k.activeTexture($b._TEXTURES[this._curActTexIndex]),$l&&$S.bindTexture($k,3553,$l),this._curActTexIndex++,1;},$t._uniform_samplerCube=function($d,$t){var $l=$t.source||$t.defaulteTexture.source,$k=$r.mainContext,$W=$d.uploadedValue;if(null!=$W[0])return $k.activeTexture($b._TEXTURES[$W[0]]),$l?$S.bindTexture($k,34067,$l):$S.bindTexture($k,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $W[0]=this._curActTexIndex,$k.uniform1i($d.location,this._curActTexIndex),$k.activeTexture($b._TEXTURES[this._curActTexIndex]),$l?$S.bindTexture($k,34067,$l):$S.bindTexture($k,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1;},$t._noSetValue=function($d){console.log("no....:"+$d.name);},$t.bind=function(){return $l.activeShader=this,($l.bindShader=this).activeResource(),$S.UseProgram(this._program);},$t.uploadAttributes=function($d,$t){for(var $l,$k,$W=0,$i=0,$A=this._attributeParamsMap.length;$i<$A;$i+=2)$k=this._attributeParamsMap[$i+1],null!=($l=$d[this._attributeParamsMap[$i]])&&($t&&$t[$k.name]&&$t[$k.name].bind(),$W+=$k.fun.call(this,$k,$l));$L.shaderCall+=$W;},$t.uploadAttributesX=function($d,$t){for(var $l,$k,$W=0,$i=0,$A=this._attributeParamsMap.length;$i<$A;$i+=2)$k=this._attributeParamsMap[$i+1],null!=($l=$d[this._attributeParamsMap[$i]])&&($t._bind(),$W+=$k.fun.call(this,$k,$l));$L.shaderCall+=$W;},$t.uploadSceneUniforms=function($d){for(var $t,$l,$k=0,$W=0,$i=this._sceneUniformParamsMap.length;$W<$i;$W+=2)$l=this._sceneUniformParamsMap[$W+1],null!=($t=$d[this._sceneUniformParamsMap[$W]])&&($k+=$l.fun.call(this,$l,$t));$L.shaderCall+=$k;},$t.uploadCameraUniforms=function($d){for(var $t,$l,$k=0,$W=0,$i=this._cameraUniformParamsMap.length;$W<$i;$W+=2)$l=this._cameraUniformParamsMap[$W+1],null!=($t=$d[this._cameraUniformParamsMap[$W]])&&($k+=$l.fun.call(this,$l,$t));$L.shaderCall+=$k;},$t.uploadSpriteUniforms=function($d){for(var $t,$l,$k=0,$W=0,$i=this._spriteUniformParamsMap.length;$W<$i;$W+=2)$l=this._spriteUniformParamsMap[$W+1],null!=($t=$d[this._spriteUniformParamsMap[$W]])&&($k+=$l.fun.call(this,$l,$t));$L.shaderCall+=$k;},$t.uploadMaterialUniforms=function($d){for(var $t,$l,$k=0,$W=0,$i=this._materialUniformParamsMap.length;$W<$i;$W+=2)$l=this._materialUniformParamsMap[$W+1],null!=($t=$d[this._materialUniformParamsMap[$W]])&&($k+=$l.fun.call(this,$l,$t));$L.shaderCall+=$k;},$t.uploadRenderElementUniforms=function($d){for(var $t,$l,$k=0,$W=0,$i=this._renderElementUniformParamsMap.length;$W<$i;$W+=2)$l=this._renderElementUniformParamsMap[$W+1],null!=($t=$d[this._renderElementUniformParamsMap[$W]])&&($k+=$l.fun.call(this,$l,$t));$L.shaderCall+=$k;},$b.create=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return new $b($d,$t,$l,$k,$W,$i,$A,$B,$o,$I);},$b.addInclude=function($d,$t){$g.addInclude($d,$t);},$b._createShader=function($d,$t,$l){var $k=$d.createShader($l);if($d.shaderSource($k,$t),$d.compileShader($k),$Lt.debugMode&&!$d.getShaderParameter($k,35713))throw $d.getShaderInfoLog($k);return $k;},$b.PERIOD_RENDERELEMENT=0,$b.PERIOD_MATERIAL=1,$b.PERIOD_SPRITE=2,$b.PERIOD_CAMERA=3,$b.PERIOD_SCENE=4,$b._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$b._count=0,$b._preCompile=!1,$b.extCompileFunc=null,$b.extCompileObj=null,$f($b,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"nameKey",function(){return this.nameKey=new $$();}]),$b;}(),$Qt=function($B){function $o(){this._transformUV=null,$o.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $At(.6,.6,.6)),this._setColor(10,new $At(1,1,1)),this._setColor(11,new $Bt(1,1,1,8)),this._setColor(12,new $At(1,1,1)),this._setColor(7,new $Bt(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $Bt(1,1,0,0)),this.renderMode=1;}$c($o,"laya.d3.core.material.StandardMaterial",$B);var $d=$o.prototype;return $d.disableLight=function(){this._addDisablePublicShaderDefine($Lt.SHADERDEFINE_POINTLIGHT|$Lt.SHADERDEFINE_SPOTLIGHT|$Lt.SHADERDEFINE_DIRECTIONLIGHT);},$d.disableFog=function(){this._addDisablePublicShaderDefine($Lt.SHADERDEFINE_FOG);},$d.onAsynLoaded=function($d,$t,$l){var $k=$t[0];if($k.version)$B.prototype.onAsynLoaded.call(this,$d,$t,$l);else{var $W=$t[1],$i=$k.props;for(var $A in $i)this[$A]=$i[$A];$o._parseStandardMaterial($W,this,$k),this._endLoaded();}},$d.cloneTo=function($d){$B.prototype.cloneTo.call(this,$d);var $t=$d;this._transformUV&&($t._transformUV=this._transformUV.clone());},$Y(0,$d,"ambientColor",function(){return this._getColor(9);},function($d){this._setColor(9,$d);}),$Y(0,$d,"ambientTexture",function(){return this._getTexture(5);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$d);}),$Y(0,$d,"renderMode",null,function($d){switch($d){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($o.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.");}this._conchMaterial&&this._conchMaterial.setRenderMode($d);}),$Y(0,$d,"reflectColor",function(){return this._getColor(12);},function($d){this._setColor(12,$d);}),$Y(0,$d,"tilingOffset",function(){return this._getColor(15);},function($d){if($d){var $t=$d.elements;1!=$t[0]||1!=$t[1]||0!=$t[2]||0!=$t[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$d);}),$Y(0,$d,"albedo",function(){return this._getColor(7);},function($d){this._setColor(7,$d);}),$Y(0,$d,"diffuseColor",function(){return this._getColor(10);},function($d){this._setColor(10,$d);}),$Y(0,$d,"albedoColor",function(){return this._getColor(7);},function($d){this._setColor(7,$d);}),$Y(0,$d,"specularColor",function(){return this._getColor(11);},function($d){this._setColor(11,$d);}),$Y(0,$d,"diffuseTexture",function(){return this._getTexture(1);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$d);}),$Y(0,$d,"normalTexture",function(){return this._getTexture(2);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$d);}),$Y(0,$d,"specularTexture",function(){return this._getTexture(3);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$d);}),$Y(0,$d,"emissiveTexture",function(){return this._getTexture(4);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$d);}),$Y(0,$d,"reflectTexture",function(){return this._getTexture(6);},function($d){$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$d);}),$Y(0,$d,"transformUV",function(){return this._transformUV;},function($d){this._transformUV=$d,this._setMatrix4x4(13,$d.matrix),$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$d.matrix.elements,0);}),$o.__init__=function(){$o.SHADERDEFINE_DIFFUSEMAP=$o.shaderDefines.registerDefine("DIFFUSEMAP"),$o.SHADERDEFINE_NORMALMAP=$o.shaderDefines.registerDefine("NORMALMAP"),$o.SHADERDEFINE_SPECULARMAP=$o.shaderDefines.registerDefine("SPECULARMAP"),$o.SHADERDEFINE_EMISSIVEMAP=$o.shaderDefines.registerDefine("EMISSIVEMAP"),$o.SHADERDEFINE_AMBIENTMAP=$o.shaderDefines.registerDefine("AMBIENTMAP"),$o.SHADERDEFINE_REFLECTMAP=$o.shaderDefines.registerDefine("REFLECTMAP"),$o.SHADERDEFINE_UVTRANSFORM=$o.shaderDefines.registerDefine("UVTRANSFORM"),$o.SHADERDEFINE_TILINGOFFSET=$o.shaderDefines.registerDefine("TILINGOFFSET"),$o.SHADERDEFINE_ADDTIVEFOG=$o.shaderDefines.registerDefine("ADDTIVEFOG");},$o.load=function($d){return $R.loader.create($d,null,null,$o);},$o._parseStandardMaterial=function($d,$t,$l){var $k=$l.customProps,$W=$k.ambientColor;$t.ambientColor=new $At($W[0],$W[1],$W[2]);var $i=$k.diffuseColor;$t.diffuseColor=new $At($i[0],$i[1],$i[2]);var $A=$k.specularColor;$t.specularColor=new $Bt($A[0],$A[1],$A[2],$A[3]);var $B=$k.reflectColor;$t.reflectColor=new $At($B[0],$B[1],$B[2]);var $o=$k.albedoColor;$o&&($t.albedo=new $Bt($o[0],$o[1],$o[2],$o[3]));var $I=$k.diffuseTexture.texture2D;$I&&($t.diffuseTexture=$z.getRes($d[$I]));var $b=$k.normalTexture.texture2D;$b&&($t.normalTexture=$z.getRes($d[$b]));var $f=$k.specularTexture.texture2D;$f&&($t.specularTexture=$z.getRes($d[$f]));var $J=$k.emissiveTexture.texture2D;$J&&($t.emissiveTexture=$z.getRes($d[$J]));var $c=$k.ambientTexture.texture2D;$c&&($t.ambientTexture=$z.getRes($d[$c]));var $Y=$k.reflectTexture.texture2D;$Y&&($t.reflectTexture=$z.getRes($d[$Y]));},$o.RENDERMODE_OPAQUE=1,$o.RENDERMODE_OPAQUEDOUBLEFACE=2,$o.RENDERMODE_CUTOUT=3,$o.RENDERMODE_CUTOUTDOUBLEFACE=4,$o.RENDERMODE_TRANSPARENT=13,$o.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$o.RENDERMODE_ADDTIVE=15,$o.RENDERMODE_ADDTIVEDOUBLEFACE=16,$o.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$o.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$o.RENDERMODE_DEPTHREAD_ADDTIVE=7,$o.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$o.RENDERMODE_NONDEPTH_TRANSPARENT=9,$o.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$o.RENDERMODE_NONDEPTH_ADDTIVE=11,$o.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$o.SHADERDEFINE_DIFFUSEMAP=0,$o.SHADERDEFINE_NORMALMAP=0,$o.SHADERDEFINE_SPECULARMAP=0,$o.SHADERDEFINE_EMISSIVEMAP=0,$o.SHADERDEFINE_AMBIENTMAP=0,$o.SHADERDEFINE_REFLECTMAP=0,$o.SHADERDEFINE_UVTRANSFORM=0,$o.SHADERDEFINE_TILINGOFFSET=0,$o.SHADERDEFINE_ADDTIVEFOG=0,$o.DIFFUSETEXTURE=1,$o.NORMALTEXTURE=2,$o.SPECULARTEXTURE=3,$o.EMISSIVETEXTURE=4,$o.AMBIENTTEXTURE=5,$o.REFLECTTEXTURE=6,$o.ALBEDO=7,$o.UVANIAGE=8,$o.MATERIALAMBIENT=9,$o.MATERIALDIFFUSE=10,$o.MATERIALSPECULAR=11,$o.MATERIALREFLECT=12,$o.UVMATRIX=13,$o.UVAGE=14,$o.TILINGOFFSET=15,$f($o,["defaultMaterial",function(){var $d=new $o();return $d.lock=!0,this.defaultMaterial=$d;},"shaderDefines",function(){return this.shaderDefines=new $bt($Tt.shaderDefines);}]),$o;}($Tt),$yt=function($d){function $A($d,$t,$l,$k,$W){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$l&&($l=35044),void 0===$k&&($k=!1),$A.__super.call(this),this._indexType=$d,this._indexCount=$t,this._bufferUsage=$l,this._bufferType=34963,this._canRead=$k;var $i;if("ushort"==$d)this._indexTypeByteCount=2;else{if("ubyte"!=$d)throw new Error("unidentification index type.");this._indexTypeByteCount=1;}$i=this._indexTypeByteCount*$t,this._byteLength=$i,this._bind(),$B._gl.bufferData(this._bufferType,$i,this._bufferUsage),this.uri=$W,$k?("ushort"==$d?this._buffer=new Uint16Array($t):"ubyte"==$d&&(this._buffer=new Uint8Array($t)),this.memorySize=2*$i):this.memorySize=$i;}$c($A,"laya.d3.graphics.IndexBuffer3D",$d);var $t=$A.prototype;return $t.setData=function($d,$t,$l,$k){void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=4294967295);var $W=0;if("ushort"==this._indexType?($W=2,0===$l&&4294967295===$k||($d=new Uint16Array($d.buffer,$l*$W,$k))):"ubyte"==this._indexType&&($W=1,0===$l&&4294967295===$k||($d=new Uint8Array($d.buffer,$l*$W,$k))),this._bind(),$B._gl.bufferSubData(this._bufferType,$t*$W,$d),this._canRead)if(0!==$t||0!==$l||4294967295!==$k){var $i=this._buffer.length-$t;$i<$k&&($k=$i);for(var $A=0;$A<$k;$A++)this._buffer[$t+$A]=$d[$A];}else this._buffer=$d;},$t.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$t.disposeResource=function(){$d.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0;},$Y(0,$t,"indexType",function(){return this._indexType;}),$Y(0,$t,"indexTypeByteCount",function(){return this._indexTypeByteCount;}),$Y(0,$t,"indexCount",function(){return this._indexCount;}),$Y(0,$t,"canRead",function(){return this._canRead;}),$A.INDEXTYPE_UBYTE="ubyte",$A.INDEXTYPE_USHORT="ushort",$A.create=function($d,$t,$l,$k,$W){return void 0===$l&&($l=35044),void 0===$k&&($k=!1),new $A($d,$t,$l,$k,$W);},$A;}($B),$Vt=function($i){function $A($d,$t,$l,$k,$W){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$k&&($k=!1),$A.__super.call(this),this._vertexDeclaration=$d,this._vertexCount=$t,this._bufferUsage=$l,this._bufferType=34962,this._canRead=$k,this.uri=$W,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$t,this._bind(),$B._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$k&&(this._buffer=new Float32Array(this._byteLength/4));}$c($A,"laya.d3.graphics.VertexBuffer3D",$i);var $d=$A.prototype;return $d.bindWithIndexBuffer=function($d){$d&&$d._bind(),this._bind();},$d.setData=function($d,$t,$l,$k){if(void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=4294967295),0===$l&&4294967295===$k||($d=new Float32Array($d.buffer,4*$l,$k)),this._bind(),$B._gl.bufferSubData(this._bufferType,4*$t,$d),this._canRead)if(0!==$t||0!==$l||4294967295!==$k){var $W=this._buffer.length-$t;$W<$k&&($k=$W);for(var $i=0;$i<$k;$i++)this._buffer[$t+$i]=$d[$i];}else this._buffer=$d;},$d.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$d.disposeResource=function(){for(var $d=$r.mainContext,$t=this._vertexDeclaration.getVertexElements(),$l=$B._enableAtributes,$k=0,$W=$t.length;$k<$W;$k++)$l[$k]===this._glBuffer&&($d.disableVertexAttribArray($k),$l[$k]=null);$i.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0;},$Y(0,$d,"vertexDeclaration",function(){return this._vertexDeclaration;}),$Y(0,$d,"vertexCount",function(){return this._vertexCount;}),$Y(0,$d,"canRead",function(){return this._canRead;}),$A.create=function($d,$t,$l,$k,$W){return void 0===$l&&($l=35044),void 0===$k&&($k=!1),new $A($d,$t,$l,$k,$W);},$A;}($B),$Zt=function($d){function $g(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$g.__super.call(this),this._type=3553;}$c($g,"laya.d3.resource.DataTexture2D",$rt);var $t=$g.prototype;return $t.genDebugMipmaps=function(){var $d=[];return $d.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$d.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$d.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$d.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$d.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$d.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$d.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$d.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$d.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$d.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$d;},$t._onTextureLoaded=function($d){},$t._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $d=$r.mainContext,$t=this._source=$d.createTexture(),$l=this._width,$k=this._height,$W=$S.curBindTexTarget,$i=$S.curBindTexValue,$A=!1;if($S.bindTexture($d,this._type,$t),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $B=0;$d.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $o=0;$o<this._mipmaps.length;$o++){if(this._mipmaps[$o].byteLength!=$I*$b*4)throw"mipmap size error  level:"+$o;$d.texSubImage2D(this._type,0,$g.simLodRect[$B++],$g.simLodRect[$B++],$g.simLodRect[$B++],$g.simLodRect[$B++],6408,5121,new Uint8Array(this._mipmaps[$o]));}this.minFifter=9729,this.magFifter=9729;}else{var $I=this._width,$b=this._height;for($B=0,$d.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$o=0;$o<this._mipmaps.length;$o++){if(this._mipmaps[$o].byteLength!=$I*$b*4)throw"mipmap size error  level:"+$o;$d.texImage2D(this._type,$o,6408,$I,$b,0,6408,5121,new Uint8Array(this._mipmaps[$o])),($I/=2)<1&&($I=1),($b/=2)<1&&($b=1),this.minFifter=9987,this.magFifter=9729;}}this.mipmap=!1;}else if(this._image)6407==this._format&&$d.pixelStorei($d.UNPACK_ALIGNMENT,1),$d.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $f=0,$J=!1,$c=!1;this._buffer.byteLength==4*$l*$k?($f=6408,$J=!0):this._buffer.byteLength==3*$l*$k?($f=6407,$c=!0):$f=this._format,$J||$c?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$c&&$d.pixelStorei($d.UNPACK_ALIGNMENT,1),$d.texImage2D(this._type,0,$f,$l,$k,0,$f,5121,this._buffer)):$d&&$f==$d.ALPHA?($d.texImage2D(3553,0,$f,$l,$k,0,$f,$d.UNSIGNED_BYTE,this._buffer),$A=!0):0!=$f&&($d.compressedTexImage2D(3553,0,$f,$l,$k,0,this._buffer),$A=!0);}var $Y=this._minFifter,$w=this._magFifter,$D=0==this._wrapModeU?10497:33071,$z=0==this._wrapModeV?10497:33071,$e=$H.isPOT($l,$k);$e?(this._mipmap||this._mipmaps?-1!==$Y||($Y=9987):-1!==$Y||($Y=9729),-1!==$w||($w=9729),$d.texParameteri(this._type,10241,$Y),$d.texParameteri(this._type,10240,$w),$d.texParameteri(this._type,10242,$D),$d.texParameteri(this._type,10243,$z),this._mipmap&&$d.generateMipmap(this._type)):(-1!==$Y||($Y=9729),-1!==$w||($w=9729),$d.texParameteri(this._type,10241,$Y),$d.texParameteri(this._type,10240,$w),$d.texParameteri(this._type,10242,33071),$d.texParameteri(this._type,10243,33071)),$W&&$i&&$S.bindTexture($d,$W,$i),this.memorySize=$A?this._buffer.length:$e?$l*$k*4*(1+1/3):$l*$k*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1;},$t.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;}},$t.onAsynLoaded=function($d,$t,$l){var $k;$l&&($k=$l[0].call(this,$t)),$k&&(this._width=$k.width,this._height=$k.height,this._buffer=$k.data),this._src=$d,this._size=new $wt(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded();},$t.getPixels=function(){return new Uint8Array(this._buffer);},$t.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($r.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0);},$Y(0,$t,"src",function(){return this._src;}),$g.create=function($d,$t,$l,$k,$W,$i,$A){if(void 0===$k&&($k=9729),void 0===$W&&($W=9729),void 0===$i&&($i=!0),!$d||$d.byteLength<$t*$l*4)throw"DataTexture2D create error";var $B=new $g();return $B.uri=$A,$B._buffer=$d,$B._width=$t,$B._height=$l,$B._mipmap=$i,$B._magFifter=$k,$B._minFifter=$W,$B._size=new $wt($B._width,$B._height),$B._conchTexture?alert("怎么给runtime传递datatexture数据"):$B.activeResource(),$B;},$g.load=function($d,$t,$l,$k,$W){if(void 0===$t&&($t=0),void 0===$l&&($l=0),void 0===$k&&($k=9729),void 0===$W&&($W=9729),"mipmaps"===$p.getFileExtension($d)){var $i=$R.loader.create($d,null,null,$g,[function($d){this._mipmaps=[];var $t=new Uint32Array($d);this._width=$t[0];var $l=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$l=1024),this._width!=$l)throw"现在只支持512x256的环境贴图。当前的是"+$t[0];this._height=$t[1];for(var $k=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$W=this._height,$i=8;;){var $A=$k*$W*4;if($i+$A>$d.byteLength)throw"load mipmaps data size error ";var $B=new Uint8Array($d,$i,$A);if(this._mipmaps.push($B),$i+=$A,1==$k&&1==$W)break;($k/=2)<1&&($k=1),($W/=2)<1&&($W=1);}return null;}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$i.simLodInfo=new Float32Array(40);for(var $A=0;$A<$i.simLodInfo.length;)$i.simLodInfo[$A]=($g.simLodRect[$A]+.5)/1024,$A++,$i.simLodInfo[$A]=($g.simLodRect[$A]+.5)/256,$A++,$i.simLodInfo[$A]=Math.max($g.simLodRect[$A]-1,.1)/1024,$A++,$i.simLodInfo[$A]=Math.max($g.simLodRect[$A]-1.5,.1)/256,$A++;}return $i;}if("number"==typeof $t)return $R.loader.create($d,null,null,$g,[function($d){return this._width=$t,this._height=$l,this._buffer=$d,null;}]);if("function"==typeof $t)return $R.loader.create($d,null,null,$g,[$t]);throw new Error("unknown params.");},$g.lodasatlas=!1,$f($g,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1]);}]),$g;}(),$Ut=function($d){function $t(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$t.__super.call(this);}$c($t,"laya.d3.resource.models.PrimitiveMesh",$St);var $l=$t.prototype;return $R.imps($l,{"laya.d3.core.render.IRenderable":!0}),$l._getVertexBuffer=function($d){return void 0===$d&&($d=0),0===$d?this._vertexBuffer:null;},$l._getVertexBuffers=function(){return null;},$l._getIndexBuffer=function(){return this._indexBuffer;},$l._getPositions=function(){var $d,$t=[],$l=this._vertexBuffer.vertexDeclaration.getVertexElements(),$k=0;for($k=0;$k<$l.length;$k++){var $W=$l[$k];if("vector3"===$W.elementFormat&&0===$W.elementUsage){$d=$W;break;}}var $i=this._vertexBuffer.getData();for($k=0;$k<$i.length;$k+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $A=$k+$d.offset/4,$B=new $At($i[$A+0],$i[$A+1],$i[$A+2]);$t.push($B);}return $t;},$l.getRenderElement=function($d){return this;},$l.getRenderElementsCount=function(){return 1;},$l.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0;},$l._beforeRender=function($d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$l._render=function($d){$r.mainContext.drawElements(4,this._numberIndices,5123,0),$L.drawCall++,$L.trianglesFaces+=this._numberIndices/3;},$Y(0,$l,"_vertexBufferCount",function(){return 1;}),$Y(0,$l,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$t;}(),$Et=function($d){function $t(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$t.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[];}$c($t,"laya.d3.resource.models.Mesh",$St);var $l=$t.prototype;return $l._getPositions=function(){var $d,$t,$l,$k,$W,$i=[],$A=0,$B=0,$o=0;if(0!==this._vertexBuffers.length){var $I=this._vertexBuffers.length;for($A=0;$A<$I;$A++){for($l=($d=this._vertexBuffers[$A]).vertexDeclaration.getVertexElements(),$B=0;$B<$l.length;$B++)if("vector3"===($k=$l[$B]).elementFormat&&0===$k.elementUsage){$t=$k;break;}for($W=$d.getData(),$B=0;$B<$W.length;$B+=$d.vertexDeclaration.vertexStride/4)$o=$B+$t.offset/4,$i.push(new $At($W[$o+0],$W[$o+1],$W[$o+2]));}}else{var $b=this._subMeshes.length;for($A=0;$A<$b;$A++){for($l=($d=this._subMeshes[$A]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$B=0;$B<$l.length;$B++)if("vector3"===($k=$l[$B]).elementFormat&&0===$k.elementUsage){$t=$k;break;}for($W=$d.getData(),$B=0;$B<$W.length;$B+=$d.vertexDeclaration.vertexStride/4)$o=$B+$t.offset/4,$i.push(new $At($W[$o+0],$W[$o+1],$W[$o+2]));}}return $i;},$l._setSubMeshes=function($d){this._subMeshes=$d,this._subMeshCount=$d.length;for(var $t=0;$t<this._subMeshCount;$t++)$d[$t]._indexInMesh=$t;this._positions=this._getPositions(),this._generateBoundingObject();},$l.onAsynLoaded=function($d,$t,$l){var $k=$t[0],$W=$t[1];$md.read($k,this,this._materials,this._subMeshes,$W),this.completeCreate(),this._endLoaded();},$l.getSubMesh=function($d){return this._subMeshes[$d];},$l.getSubMeshCount=function(){return this._subMeshes.length;},$l.getRenderElementsCount=function(){return this._subMeshes.length;},$l.getRenderElement=function($d){return this._subMeshes[$d];},$l.disposeResource=function(){for(var $d=0;$d<this._subMeshes.length;$d++)this._subMeshes[$d].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null;},$Y(0,$l,"materials",function(){return this._materials.slice();}),$Y(0,$l,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses;}),$t.load=function($d){return $R.loader.create($d,null,null,$t);},$t;}(),$Nt=(function($d){function $I($d,$t,$l,$k,$W,$i,$A,$B,$o){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$l&&($l=6408),void 0===$k&&($k=5121),void 0===$W&&($W=33189),void 0===$i&&($i=!1),void 0===$A&&($A=!1),void 0===$B&&($B=-1),void 0===$o&&($o=-1),$I.__super.call(this),this._type=3553,this._width=$d,this._height=$t,this._size=new $wt($d,$t),this._surfaceFormat=$l,this._surfaceType=$k,this._depthStencilFormat=$W,$w.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$i,this._repeat=$A,this._minFifter=$B,this._magFifter=$o,this.activeResource(),this._alreadyResolved=!0;}$c($I,"laya.d3.resource.RenderTexture",$rt);var $t=$I.prototype;$t.recreateResource=function(){var $d=$r.mainContext;this._frameBuffer=$d.createFramebuffer(),this._source=$d.createTexture();var $t=$S.curBindTexTarget,$l=$S.curBindTexValue;$S.bindTexture($d,this._type,this._source),$d.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $k=this._minFifter,$W=this._magFifter,$i=this._repeat?10497:33071;if($H.isPOT(this._width,this._height)?(this._mipmap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$W||($W=9729),$d.texParameteri(this._type,10241,$k),$d.texParameteri(this._type,10240,$W),$d.texParameteri(this._type,10242,$i),$d.texParameteri(this._type,10243,$i),this._mipmap&&$d.generateMipmap(this._type)):(-1!==$k||($k=9729),-1!==$W||($W=9729),$d.texParameteri(this._type,10241,$k),$d.texParameteri(this._type,10240,$W),$d.texParameteri(this._type,10242,33071),$d.texParameteri(this._type,10243,33071)),$t&&$l&&$S.bindTexture($d,$t,$l),$d.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$d.createRenderbuffer(),$d.bindRenderbuffer(36161,this._depthStencilBuffer),$d.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$d.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$d.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$d.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$d.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$d.framebufferTexture2D(36160,36064,3553,this._source,0),$d.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate();},$t.start=function(){$r.mainContext.bindFramebuffer(36160,this.frameBuffer),($I._currentRenderTarget=this)._alreadyResolved=!1;},$t.end=function(){$r.mainContext.bindFramebuffer(36160,null),$I._currentRenderTarget=null,this._alreadyResolved=!0;},$t.getData=function($d,$t,$l,$k){var $W=$r.mainContext;if($W.bindFramebuffer(36160,this._frameBuffer),!(36053===$W.checkFramebufferStatus(36160)))return $W.bindFramebuffer(36160,null),null;var $i=new Uint8Array(this._width*this._height*4);return $W.readPixels($d,$t,$l,$k,this._surfaceFormat,this._surfaceType,$i),$W.bindFramebuffer(36160,null),$i;},$t.disposeResource=function(){if(this._frameBuffer){var $d=$r.mainContext;$d.deleteTexture(this._source),$d.deleteFramebuffer(this._frameBuffer),$d.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0;}},$Y(0,$t,"surfaceFormat",function(){return this._surfaceFormat;}),$Y(0,$t,"surfaceType",function(){return this._surfaceType;}),$Y(0,$t,"depthStencilFormat",function(){return this._depthStencilFormat;}),$Y(0,$t,"source",function(){return this._alreadyResolved?$R.superGet($rt,this,"source"):null;}),$Y(0,$t,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$Y(0,$t,"frameBuffer",function(){return this._frameBuffer;}),$I._currentRenderTarget=null;}(),function($d){function $t($d){this._color=null,this._pixels=null,$t.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $wt(this.width,this.height),this._color=$d,this._pixels=new Uint8Array([255*$d.x,255*$d.y,255*$d.z,255*$d.w]),this.uri="SolidColorTexture2D_"+this.id;}$c($t,"laya.d3.resource.SolidColorTexture2D",$rt);var $l=$t.prototype;return $l._createWebGlTexture=function(){var $d=$r.mainContext,$t=this._source=$d.createTexture(),$l=this._width,$k=this._height,$W=$S.curBindTexTarget,$i=$S.curBindTexValue;$S.bindTexture($d,this._type,$t),$d.texImage2D(this._type,0,6408,$l,$k,0,6408,5121,this._pixels);var $A=this._minFifter,$B=this._magFifter,$o=this._repeat?10497:33071,$I=$H.isPOT($l,$k);$I?(this._mipmap?-1!==$A||($A=9987):-1!==$A||($A=9729),-1!==$B||($B=9729),$d.texParameteri(this._type,10241,$A),$d.texParameteri(this._type,10240,$B),$d.texParameteri(this._type,10242,$o),$d.texParameteri(this._type,10243,$o),this._mipmap&&$d.generateMipmap(this._type)):(-1!==$A||($A=9729),-1!==$B||($B=9729),$d.texParameteri(this._type,10241,$A),$d.texParameteri(this._type,10240,$B),$d.texParameteri(this._type,10242,33071),$d.texParameteri(this._type,10243,33071)),$W&&$i&&$S.bindTexture($d,$W,$i),this.memorySize=$I?$l*$k*4*(1+1/3):$l*$k*4;},$l.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$l.disposeResource=function(){this._source&&($r.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$f($t,["magentaTexture",function(){var $d=new $t(new $Bt(1,0,1,1));return $d.lock=!0,this.magentaTexture=$d;},"grayTexture",function(){var $d=new $t(new $Bt(.5,.5,.5,1));return $d.lock=!0,this.grayTexture=$d;}]),$t;}()),$ut=function($d){function $W($d,$t,$l,$k){this._canRead=!1,this._image=null,this._pixels=null,void 0===$d&&($d=!1),void 0===$t&&($t=!0),void 0===$l&&($l=6408),void 0===$k&&($k=!0),$W.__super.call(this),this._type=3553,this._repeat=$t,this._canRead=$d,this._format=$l,this._mipmap=$k;}$c($W,"laya.d3.resource.Texture2D",$rt);var $t=$W.prototype;return $t._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $d=$r.mainContext,$t=this._source=$d.createTexture(),$l=this._width,$k=this._height,$W=$S.curBindTexTarget,$i=$S.curBindTexValue;switch($S.bindTexture($d,this._type,$t),this._format){case 6407:case 6408:this._canRead?$d.texImage2D(this._type,0,this._format,$l,$k,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$d.texImage2D(this._type,0,this._image._format,$l,$k,0,this._image._format,5121,this._image.atlasSource):$d.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $r.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$d.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}var $A=this._minFifter,$B=this._magFifter,$o=this._repeat?10497:33071,$I=0==this._wrapModeU?10497:33071,$b=0==this._wrapModeV?10497:33071,$f=$H.isPOT($l,$k);$f?(this._mipmap?-1!==$A||($A=9987):-1!==$A||($A=9729),-1!==$B||($B=9729),$d.texParameteri(this._type,10241,$A),$d.texParameteri(this._type,10240,$B),$d.texParameteri(this._type,10242,$o),$d.texParameteri(this._type,10243,$o),$d.texParameteri(this._type,10242,$I),$d.texParameteri(this._type,10243,$b),this._mipmap&&$d.generateMipmap(this._type)):(-1!==$A||($A=9729),-1!==$B||($B=9729),$d.texParameteri(this._type,10241,$A),$d.texParameteri(this._type,10240,$B),$d.texParameteri(this._type,10242,33071),$d.texParameteri(this._type,10243,33071)),$W&&$i&&$S.bindTexture($d,$W,$i),this._image.onload=null,this._image=null,this.memorySize=$f?$l*$k*4*(1+1/3):$l*$k*4;},$t.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$t.onAsynLoaded=function($d,$t,$l){if($l){var $k=$l[0];void 0!==$k&&(this._canRead=$k);var $W=$l[1];void 0!==$W&&(this._repeat=$W);var $i=$l[2];void 0!==$i&&(this._format=$i);var $A=$l[3];void 0!==$A&&(this._mipmap=$A);var $B=$l.wrapModeU;void 0!==$B&&(this._wrapModeU=$B);var $o=$l.wrapModeV;void 0!==$o&&(this._wrapModeV=$o);}switch(this._format){case 6407:case 6408:var $I=(this._image=$t).width,$b=$t.height;this._width=$I,this._height=$b,this._size=new $wt($I,$b),this._canRead&&($w.isConchApp?$t instanceof $J.HTMLElement&&(this._pixels=new Uint8Array($t.getImageData(0,0,$I,$b))):($j.canvas.size($I,$b),$j.canvas.clear(),$j.context.drawImage($t,0,0,$I,$b),this._pixels=new Uint8Array($j.context.getImageData(0,0,$I,$b).data.buffer)));break;case $r.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $f=new $G($t);$f.readUTFBytes(4),$f.readUTFBytes(2),$f.getInt16();$f.endian="bigEndian",this._width=$f.getInt16(),this._height=$f.getInt16(),this._size=new $wt(this._width,this._height);$f.getInt16(),$f.getInt16();this._image=new Uint8Array($t,$f.pos);}this.recreateResource(),this._endLoaded();},$t.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.");},$t.disposeResource=function(){this._source&&($r.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0);},$Y(0,$t,"_src",function(){return this.url;}),$Y(0,$t,"src",function(){return this.url;}),$W.load=function($d){return $R.loader.create($d,null,null,$W);},$W;}(),$ht=function($t){function $l($d,$t){$l.__super.call(this),void 0===$d&&($d=.3),void 0===$t&&($t=1e3),this._tempVector3=new $At(),this._position=new $At(),this._up=new $At(),this._forward=new $At(),this._right=new $At(),this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$wt.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$d,this._farPlane=$t,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$R.stage.on("resize",this,this._onScreenSizeChanged);}$c($l,"laya.d3.core.BaseCamera",$t);var $d=$l.prototype;return $d._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $d=this.scene._cameraPool,$t=$d.length-1,$l=0;$l<$t;$l++)if($d[$l].renderingOrder>$d[$t].renderingOrder){var $k=$d[$l];$d[$l]=$d[$t],$d[$t]=$k;}},$d._calculateProjectionMatrix=function(){},$d._onScreenSizeChanged=function(){this._calculateProjectionMatrix();},$d._prepareCameraToRender=function(){$C._currentCameraCullingMask=this.cullingMask;var $d=this._shaderValues;$d.setValue(0,this.transform.position.elements),$d.setValue(5,this.forward.elements),$d.setValue(6,this.up.elements);},$d._prepareCameraViewProject=function($d,$t){var $l=this._shaderValues;$l.setValue(1,$d.elements),$l.setValue(2,$t.elements);},$d._renderCamera=function($d,$t,$l){},$d.addLayer=function($d){29!==$d.number&&30!=$d.number&&(this.cullingMask=this.cullingMask|$d.mask);},$d.removeLayer=function($d){29!==$d.number&&30!=$d.number&&(this.cullingMask=this.cullingMask&~$d.mask);},$d.addAllLayers=function(){this.cullingMask=2147483647;},$d.removeAllLayers=function(){this.cullingMask=0|$C.getLayerByNumber(29).mask|$C.getLayerByNumber(30).mask;},$d.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix();},$d.moveForward=function($d){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$d,this.transform.translate(this._tempVector3);},$d.moveRight=function($d){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$d,this.transform.translate(this._tempVector3);},$d.moveVertical=function($d){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$d,this.transform.translate(this._tempVector3,!1);},$d._addSelfRenderObjects=function(){var $d=this.scene._cameraPool,$t=$d.length;if(0<$t){for(var $l=$t-1;0<=$l;$l--)if(this.renderingOrder<=$d[$l].renderingOrder){$d.splice($l+1,0,this);break;}}else $d.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel);},$d._clearSelfRenderObjects=function(){var $d=this.scene._cameraPool;$d.splice($d.indexOf(this),1);},$d.destroy=function($d){void 0===$d&&($d=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$R.stage.off("resize",this,this._onScreenSizeChanged),$t.prototype.destroy.call(this,$d);},$Y(0,$d,"sky",function(){return this._sky;},function($d){(this._sky=$d)._ownerCamera=this;}),$Y(0,$d,"forward",function(){var $d=this.transform.worldMatrix.elements,$t=this._forward.elements;return $t[0]=-$d[8],$t[1]=-$d[9],$t[2]=-$d[10],this._forward;}),$Y(0,$d,"position",function(){var $d=this.transform.worldMatrix.elements,$t=this._position.elements;return $t[0]=$d[12],$t[1]=$d[13],$t[2]=$d[14],this._position;}),$Y(0,$d,"renderTarget",function(){return this._renderTarget;},function($d){null!=(this._renderTarget=$d)&&(this._renderTargetSize=$d.size);}),$Y(0,$d,"up",function(){var $d=this.transform.worldMatrix.elements,$t=this._up.elements;return $t[0]=$d[4],$t[1]=$d[5],$t[2]=$d[6],this._up;}),$Y(0,$d,"right",function(){var $d=this.transform.worldMatrix.elements,$t=this._right.elements;return $t[0]=$d[0],$t[1]=$d[1],$t[2]=$d[2],this._right;}),$Y(0,$d,"renderTargetSize",function(){return this._renderTargetSize;},function($d){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"fieldOfView",function(){return this._fieldOfView;},function($d){this._fieldOfView=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"nearPlane",function(){return this._nearPlane;},function($d){this._nearPlane=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"farPlane",function(){return this._farPlane;},function($d){this._farPlane=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"orthographic",function(){return this._orthographic;},function($d){this._orthographic=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"orthographicVerticalSize",function(){return this._orthographicVerticalSize;},function($d){this._orthographicVerticalSize=$d,this._calculateProjectionMatrix();}),$Y(0,$d,"renderingOrder",function(){return this._renderingOrder;},function($d){this._renderingOrder=$d,this._sortCamerasByRenderingOrder();}),$l.CAMERAPOS=0,$l.VIEWMATRIX=1,$l.PROJECTMATRIX=2,$l.VPMATRIX=3,$l.VPMATRIX_NO_TRANSLATE=4,$l.CAMERADIRECTION=5,$l.CAMERAUP=6,$l.ENVIRONMENTDIFFUSE=7,$l.ENVIRONMENTSPECULAR=8,$l.SIMLODINFO=9,$l.DIFFUSEIRRADMATR=10,$l.DIFFUSEIRRADMATG=11,$l.DIFFUSEIRRADMATB=12,$l.HDREXPOSURE=13,$l.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$l.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$l.CLEARFLAG_SOLIDCOLOR=0,$l.CLEARFLAG_SKY=1,$l.CLEARFLAG_DEPTHONLY=2,$l.CLEARFLAG_NONE=3,$f($l,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $dt(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1);},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $dt();},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $dt();}]),$l;}($xt),$st=function($l){function $t($d){this._render=null,this._geometryFilter=null,$t.__super.call(this,$d);}$c($t,"laya.d3.core.RenderableSprite3D",$l);var $d=$t.prototype;return $d._addToInitStaticBatchManager=function(){},$d._setBelongScene=function($d){$l.prototype._setBelongScene.call(this,$d),$d._renderableSprite3Ds.push(this),this._render._applyLightMapParams();},$d._setUnBelongScene=function(){var $d=this._scene._renderableSprite3Ds,$t=$d.indexOf(this);$d.splice($t,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$l.prototype._setUnBelongScene.call(this);},$d._update=function($d){($d.owner=this)._activeInHierarchy&&(this._updateComponents($d),this._render._updateOctreeNode(),this._lateUpdateComponents($d),$L.spriteCount++,this._childs.length&&this._updateChilds($d));},$d.destroy=function($d){void 0===$d&&($d=!0),$l.prototype.destroy.call(this,$d),this._render._destroy(),this._render=null;},$t.__init__=function(){$t.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$t.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$t.SAHDERDEFINE_LIGHTMAP=$t.shaderDefines.registerDefine("LIGHTMAP");},$t.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$t.SAHDERDEFINE_LIGHTMAP=4,$t.LIGHTMAPSCALEOFFSET=2,$t.LIGHTMAP=3,$f($t,["shaderDefines",function(){return this.shaderDefines=new $bt();}]),$t;}($xt),$Pt=(function($d){function $k($d,$t,$l){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$d&&($d=1),void 0===$t&&($t=1),void 0===$l&&($l=1),$k.__super.call(this),this._long=$d,this._width=$t,this._height=$l,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$c($k,"laya.d3.resource.models.BoxMesh",$Ut);var $t=$k.prototype;$t.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $d=$rd.vertexDeclaration,$t=($d.vertexStride,this._long/2),$l=this._height/2,$k=this._width/2,$W=new Float32Array([-$t,$l,-$k,0,1,0,0,0,$t,$l,-$k,0,1,0,1,0,$t,$l,$k,0,1,0,1,1,-$t,$l,$k,0,1,0,0,1,-$t,-$l,-$k,0,-1,0,0,1,$t,-$l,-$k,0,-1,0,1,1,$t,-$l,$k,0,-1,0,1,0,-$t,-$l,$k,0,-1,0,0,0,-$t,$l,-$k,-1,0,0,0,0,-$t,$l,$k,-1,0,0,1,0,-$t,-$l,$k,-1,0,0,1,1,-$t,-$l,-$k,-1,0,0,0,1,$t,$l,-$k,1,0,0,1,0,$t,$l,$k,1,0,0,0,0,$t,-$l,$k,1,0,0,0,1,$t,-$l,-$k,1,0,0,1,1,-$t,$l,$k,0,0,1,0,0,$t,$l,$k,0,0,1,1,0,$t,-$l,$k,0,0,1,1,1,-$t,-$l,$k,0,0,1,0,1,-$t,$l,-$k,0,0,-1,1,0,$t,$l,-$k,0,0,-1,0,0,$t,-$l,-$k,0,0,-1,0,1,-$t,-$l,-$k,0,0,-1,1,1]),$i=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $Vt($d,this._numberVertices,35044,!0),this._indexBuffer=new $yt("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($W),this._indexBuffer.setData($i),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$Y(0,$t,"long",function(){return this._long;},function($d){this._long!==$d&&(this._long=$d,this.releaseResource(),this.activeResource());}),$Y(0,$t,"width",function(){return this._width;},function($d){this._width!==$d&&(this._width=$d,this.releaseResource(),this.activeResource());}),$Y(0,$t,"height",function(){return this._height;},function($d){this._height!==$d&&(this._height=$d,this.releaseResource(),this.activeResource());});}(),function($d){function $W($d,$t,$l,$k){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$d&&($d=10),void 0===$t&&($t=10),void 0===$l&&($l=10),void 0===$k&&($k=10),$W.__super.call(this),this._long=$d,this._width=$t,this._stacks=$l,this._slices=$k,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$c($W,"laya.d3.resource.models.PlaneMesh",$Ut);var $t=$W.prototype;$t.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $d=new Uint16Array(this._numberIndices),$t=$rd.vertexDeclaration,$l=$t.vertexStride/4,$k=new Float32Array(this._numberVertices*$l),$W=this._long/2,$i=this._width/2,$A=this._long/this._stacks,$B=this._width/this._slices,$o=0,$I=0;$I<=this._slices;$I++)for(var $b=0;$b<=this._stacks;$b++)$k[$o++]=$b*$A-$W,$k[$o++]=0,$k[$o++]=$I*$B-$i,$k[$o++]=0,$k[$o++]=1,$k[$o++]=0,$k[$o++]=1*$b/this._stacks,$k[$o++]=1*$I/this._slices;var $f=0;for($I=0;$I<this._slices;$I++)for($b=0;$b<this._stacks;$b++)$d[$f++]=($I+1)*(this._stacks+1)+$b,$d[$f++]=$I*(this._stacks+1)+$b,$d[$f++]=($I+1)*(this._stacks+1)+$b+1,$d[$f++]=$I*(this._stacks+1)+$b,$d[$f++]=$I*(this._stacks+1)+$b+1,$d[$f++]=($I+1)*(this._stacks+1)+$b+1;this._vertexBuffer=new $Vt($t,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $yt("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($k),this._indexBuffer.setData($d),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$Y(0,$t,"long",function(){return this._long;},function($d){this._long!==$d&&(this._long=$d,this.releaseResource(),this.activeResource());}),$Y(0,$t,"width",function(){return this._width;},function($d){this._width!==$d&&(this._width=$d,this.releaseResource(),this.activeResource());}),$Y(0,$t,"stacks",function(){return this._stacks;},function($d){this._stacks!==$d&&(this._stacks=$d,this.releaseResource(),this.activeResource());}),$Y(0,$t,"slices",function(){return this._slices;},function($d){this._slices!==$d&&(this._slices=$d,this.releaseResource(),this.activeResource());});}(),function($d){function $A($d,$t,$l){void 0===$d&&($d=0),void 0===$t&&($t=.3),void 0===$l&&($l=1e3),this._viewMatrix=new $dt(),this._projectionMatrix=new $dt(),this._projectionViewMatrix=new $dt(),this._viewport=new $ot(0,0,0,0),this._normalizedViewport=new $ot(0,0,1,1),this._aspectRatio=$d,this._boundFrustumUpdate=!0,this._boundFrustum=new $Fd($dt.DEFAULT),$A.__super.call(this,$t,$l),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged);}$c($A,"laya.d3.core.Camera",$ht);var $t=$A.prototype;return $t._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0;},$t._parseCustomProps=function($d,$t,$l,$k){var $W=$l.clearColor;this.clearColor=new $Bt($W[0],$W[1],$W[2],$W[3]);var $i=$l.viewport;this.normalizedViewport=new $ot($i[0],$i[1],$i[2],$i[3]);},$t._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $d=this.orthographicVerticalSize*this.aspectRatio*.5,$t=.5*this.orthographicVerticalSize;$dt.createOrthoOffCenterRH(-$d,$d,-$t,$t,this.nearPlane,this.farPlane,this._projectionMatrix);}else $dt.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0;},$t._update=function($d){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$d);},$t._renderCamera=function($d,$t,$l){var $k,$W;$l.parallelSplitShadowMaps[0]&&$l._renderShadowMap($d,$t,this),($t.camera=this)._prepareCameraToRender(),$l._preRenderUpdateComponents($t),$k=$t._viewMatrix=this.viewMatrix;var $i=this._renderTarget;$i?($i.start(),$dt.multiply($ht._invertYScaleMatrix,this._projectionMatrix,$ht._invertYProjectionMatrix),$dt.multiply($ht._invertYScaleMatrix,this.projectionViewMatrix,$ht._invertYProjectionViewMatrix),$W=$t._projectionMatrix=$ht._invertYProjectionMatrix,$t._projectionViewMatrix=$ht._invertYProjectionViewMatrix):($W=$t._projectionMatrix=this._projectionMatrix,$t._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($k,$W),$t._viewport=this.viewport,$l._preRenderScene($d,$t,this.boundFrustum),$l._clear($d,$t),$l._renderScene($d,$t),$l._postRenderUpdateComponents($t),$i&&$i.end();},$t.viewportPointToRay=function($d,$t){$Yt.calculateCursorRay($d,this.viewport,this._projectionMatrix,this.viewMatrix,null,$t);},$t.normalizedViewportPointToRay=function($d,$t){var $l=$A._tempVector20,$k=this.viewport,$W=$d.elements,$i=$l.elements;$i[0]=$W[0]*$k.width,$i[1]=$W[1]*$k.height,$Yt.calculateCursorRay($l,this.viewport,this._projectionMatrix,this.viewMatrix,null,$t);},$t.worldToViewportPoint=function($d,$t){$dt.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($d,this._projectionViewMatrix,$t);var $l=$t.elements;$l[0]=$l[0]/$R.stage.clientScaleX,$l[1]=$l[1]/$R.stage.clientScaleY;},$t.worldToNormalizedViewportPoint=function($d,$t){$dt.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($d,this._projectionViewMatrix,$t);var $l=$t.elements;$l[0]=$l[0]/$R.stage.clientScaleX,$l[1]=$l[1]/$R.stage.clientScaleY;},$t.convertScreenCoordToOrthographicCoord=function($d,$t){if(this._orthographic){var $l=$m.clientWidth,$k=$m.clientHeight,$W=this.orthographicVerticalSize*this.aspectRatio/$l,$i=this.orthographicVerticalSize/$k,$A=$d.elements,$B=$t.elements;return $B[0]=(-$l/2+$A[0])*$W,$B[1]=($k/2-$A[1])*$i,$B[2]=(this.nearPlane-this.farPlane)*($A[2]+1)/2-this.nearPlane,$At.transformCoordinate($t,this.transform.worldMatrix,$t),!0;}return!1;},$Y(0,$t,"projectionViewMatrix",function(){return $dt.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix;}),$Y(0,$t,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $d=this.viewport;return $d.width/$d.height;},function($d){if($d<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$d,this._calculateProjectionMatrix();}),$Y(0,$t,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum;}),$Y(0,$t,"needViewport",function(){var $d=this.normalizedViewport;return 0===$d.x&&0===$d.y&&1===$d.width&&1===$d.height;}),$Y(0,$t,"viewport",function(){if(this._viewportExpressedInClipSpace){var $d=this._normalizedViewport,$t=this.renderTargetSize,$l=$t.width,$k=$t.height;this._viewport.x=$d.x*$l,this._viewport.y=$d.y*$k,this._viewport.width=$d.width*$l,this._viewport.height=$d.height*$k;}return this._viewport;},function($d){if(null!=this.renderTarget&&($d.x<0||$d.y<0||0==$d.width||0==$d.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$d,this._calculateProjectionMatrix();}),$Y(0,$t,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $d=this._viewport,$t=this.renderTargetSize,$l=$t.width,$k=$t.height;this._normalizedViewport.x=$d.x/$l,this._normalizedViewport.y=$d.y/$k,this._normalizedViewport.width=$d.width/$l,this._normalizedViewport.height=$d.height/$k;}return this._normalizedViewport;},function($d){$d.x<0&&($d.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$d.y<0&&($d.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$d.x+$d.width&&($d.width=1-$d.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$d.y+$d.height&&($d.height=1-$d.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$d,this._calculateProjectionMatrix();}),$Y(0,$t,"projectionMatrix",function(){return this._projectionMatrix;},function($d){this._projectionMatrix=$d,this._useUserProjectionMatrix=!0;}),$Y(0,$t,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix;}),$f($A,["_tempVector20",function(){return this._tempVector20=new $it();}]),$A;}()),$Xt=function($l){function $k($d,$t){$k.__super.call(this,$t),this._geometryFilter=new $jt(this),this._render=new $Ct(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$d&&(this._geometryFilter.sharedMesh=$d)instanceof laya.d3.resource.models.Mesh&&($d.loaded?this._render.sharedMaterials=$d.materials:$d.once("loaded",this,this._applyMeshMaterials));}$c($k,"laya.d3.core.MeshSprite3D",$l);var $d=$k.prototype;return $d._changeRenderObjectByMesh=function($d){var $t=this._render._renderElements,$l=$t[$d];$l||($l=$t[$d]=new $qt()),$l._render=this._render;var $k=this._render.sharedMaterials[$d];$k||($k=$Qt.defaultMaterial);var $W=this._geometryFilter.sharedMesh.getRenderElement($d);return $l._mainSortID=this._getSortID($W,$k),$l._sprite3D=this,$l.renderObj=$W,$l._material=$k,$l;},$d._changeRenderObjectByMaterial=function($d,$t){var $l=this._render._renderElements[$d];$t||($t=$Qt.defaultMaterial);var $k=this._geometryFilter.sharedMesh.getRenderElement($d);return $l._mainSortID=this._getSortID($k,$t),$l._sprite3D=this,$l.renderObj=$k,$l._material=$t,$l;},$d._changeRenderObjectsByMesh=function(){var $d=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$d;for(var $t=0;$t<$d;$t++)this._changeRenderObjectByMesh($t);},$d._onMeshChanged=function($d){var $t=$d.sharedMesh;$t.loaded?this._changeRenderObjectsByMesh():$t.once("loaded",this,this._onMeshLoaded);},$d._onMeshLoaded=function($d){$d===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh();},$d._onMaterialChanged=function($d,$t,$l){$t<this._render._renderElements.length&&this._changeRenderObjectByMaterial($t,$l);},$d._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render);},$d._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render);},$d._parseCustomProps=function($d,$t,$l,$k){var $W=this.meshRender,$i=$l.lightmapIndex;null!=$i&&($W.lightmapIndex=$i);var $A,$B,$o=$l.lightmapScaleOffset;if($o&&($W.lightmapScaleOffset=new $Bt($o[0],$o[1],$o[2],$o[3])),$k.instanceParams)($A=$k.instanceParams.loadPath)&&($B=$z.getRes($t[$A]),(this.meshFilter.sharedMesh=$B).loaded?$W.sharedMaterials=$B.materials:$B.once("loaded",this,this._applyMeshMaterials));else{($A=$l.meshPath)&&($B=$z.getRes($t[$A]),this.meshFilter.sharedMesh=$B);var $I=$l.materials;if($I){var $b=$W.sharedMaterials,$f=$I.length;$b.length=$f;for(var $J=0;$J<$f;$J++)$b[$J]=$z.getRes($t[$I[$J].path]);$W.sharedMaterials=$b;}}},$d._applyMeshMaterials=function($d){for(var $t=this._render.sharedMaterials,$l=$d.materials,$k=0,$W=$l.length;$k<$W;$k++)$t[$k]||($t[$k]=$l[$k]);this._render.sharedMaterials=$t;},$d._addToInitStaticBatchManager=function(){$k._staticBatchManager._addInitBatchSprite(this);},$d.cloneTo=function($d){var $t=$d;$t._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $l=this._render,$k=$t._render;$k.enable=$l.enable,$k.sharedMaterials=$l.sharedMaterials,$k.castShadow=$l.castShadow;var $W=$l.lightmapScaleOffset;$W&&($k.lightmapScaleOffset=$W.clone()),$k.lightmapIndex=$l.lightmapIndex,$k.receiveShadow=$l.receiveShadow,$k.sortingFudge=$l.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$d);},$d.destroy=function($d){if(void 0===$d&&($d=!0),!this.destroyed){var $t=this.meshFilter.sharedMesh;null!=$t&&($t.loaded||$t.off("loaded",this,this._applyMeshMaterials)),$l.prototype.destroy.call(this,$d),this._geometryFilter._destroy();}},$Y(0,$d,"meshFilter",function(){return this._geometryFilter;}),$Y(0,$d,"meshRender",function(){return this._render;}),$k.__init__=function(){$kd._staticBatchManagers.push($k._staticBatchManager);},$k.load=function($d){return $R.loader.create($d,null,null,$k);},$f($k,["_staticBatchManager",function(){return this._staticBatchManager=new $$t();}]),$k;}($st);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}}),function($d,$t,$Wd){$Wd.un,$Wd.uns;var $l=$Wd.static,$k=$Wd.class,$i=$Wd.getset,$w=$Wd.__newvec,$B=laya.maths.Bezier,$f=laya.utils.Browser,$rd=laya.utils.Byte,$W=(laya.events.Event,laya.events.EventDispatcher),$A=laya.display.Graphics,$o=(laya.resource.HTMLCanvas,laya.utils.Handler),$I=laya.net.Loader,$J=laya.maths.MathUtil,$Sd=laya.maths.Matrix,$D=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$b=(laya.renders.RenderContext,laya.resource.Resource),$c=laya.utils.RunDriver,$id=laya.display.Sprite,$Y=laya.utils.Stat,$jd=laya.resource.Texture,$z=(laya.net.URL,laya.utils.Utils),$S=function(){function $d(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0;}return $k($d,"laya.ani.AnimationContent"),$d;}(),$j=function(){function $d(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0;}return $k($d,"laya.ani.AnimationNodeContent"),$d;}(),$g=function(){function $d(){}return $k($d,"laya.ani.AnimationParser01"),$d.parse=function($d,$t){var $l=$t.__getBuffer(),$k=0,$W=0,$i=0,$A=0,$B=0,$o=0,$I=0,$b=$t.readUTFString();$d._aniClassName=$b;var $f,$J=$t.readUTFString().split("\n"),$c=$t.getUint8(),$Y=$t.getUint32(),$w=$t.getUint32();0<$Y&&($f=$l.slice($Y,$w));var $D=new $rd($f);for(0<$w&&($d._publicExtData=$l.slice($w,$l.byteLength)),$d._useParent=!!$t.getUint8(),$d._anis.length=$c,$k=0;$k<$c;$k++){var $z=$d._anis[$k]=new $S();$z.nodes=new Array();var $e=$z.name=$J[$t.getUint16()];$d._aniMap[$e]=$k,$z.bone3DMap={},$z.playTime=$t.getFloat32(),$z.playTime<=0&&console.error("播放时间不能为0  url="+$d.url+" name="+$z.name);var $g=$z.nodes.length=$t.getUint8();for($W=$z.totalKeyframeDatasLength=0;$W<$g;$W++){var $H=$z.nodes[$W]=new $j();$H.childs=[];var $R=$t.getInt16();0<=$R&&($H.name=$J[$R],$z.bone3DMap[$H.name]=$W),$H.keyFrame=new Array(),$H.parentIndex=$t.getInt16(),-1==$H.parentIndex?$H.parent=null:$H.parent=$z.nodes[$H.parentIndex],$H.lerpType=$t.getUint8();var $G=$t.getUint32();$D.pos=$G;var $q=$H.keyframeWidth=$D.getUint16();if($z.totalKeyframeDatasLength+=$q,0===$H.lerpType||1===$H.lerpType)for($H.interpolationMethod=[],$H.interpolationMethod.length=$q,$i=0;$i<$q;$i++)$H.interpolationMethod[$i]=$x.interpolation[$D.getUint8()];null!=$H.parent&&$H.parent.childs.push($H);var $L=$t.getUint16();0<$L&&($H.extenData=$l.slice($t.pos,$t.pos+$L),$t.pos+=$L);var $$,$p=$t.getUint16(),$M=0;for($i=0,$A=$H.keyFrame.length=$p;$i<$A;$i++){if(($$=$H.keyFrame[$i]=new $C()).duration=$t.getFloat32(),$$.startTime=$M,2===$H.lerpType){$$.interpolationData=[];var $T,$r=$t.getUint8();switch($T=$t.getFloat32()){case 254:for($$.interpolationData.length=$q,$I=0;$I<$q;$I++)$$.interpolationData[$I]=0;break;case 255:for($$.interpolationData.length=$q,$I=0;$I<$q;$I++)$$.interpolationData[$I]=5;break;default:for($$.interpolationData.push($T),$o=1;$o<$r;$o++)$$.interpolationData.push($t.getFloat32());}}for($$.data=new Float32Array($q),$B=0;$B<$q;$B++)$$.data[$B]=$t.getFloat32(),-1e-8<$$.data[$B]&&$$.data[$B]<1e-8&&($$.data[$B]=0);$M+=$$.duration;}$$.startTime=$z.playTime,$H.playTime=$z.playTime,$d._calculateKeyFrame($H,$p,$q);}}},$d;}(),$H=function(){function $R(){}return $k($R,"laya.ani.AnimationParser02"),$R.READ_DATA=function(){$R._DATA.offset=$R._reader.getUint32(),$R._DATA.size=$R._reader.getUint32();},$R.READ_BLOCK=function(){for(var $d=$R._BLOCK.count=$R._reader.getUint16(),$t=$R._BLOCK.blockStarts=[],$l=$R._BLOCK.blockLengths=[],$k=0;$k<$d;$k++)$t.push($R._reader.getUint32()),$l.push($R._reader.getUint32());},$R.READ_STRINGS=function(){var $d=$R._reader.getUint32(),$t=$R._reader.getUint16(),$l=$R._reader.pos;$R._reader.pos=$d+$R._DATA.offset;for(var $k=0;$k<$t;$k++)$R._strings[$k]=$R._reader.readUTFString();$R._reader.pos=$l;},$R.parse=function($d,$t){$R._templet=$d;($R._reader=$t).__getBuffer();$R.READ_DATA(),$R.READ_BLOCK(),$R.READ_STRINGS();for(var $l=0,$k=$R._BLOCK.count;$l<$k;$l++){var $W=$t.getUint16(),$i=$R._strings[$W],$A=$R["READ_"+$i];if(null==$A)throw new Error("model file err,no this function:"+$W+" "+$i);$A.call();}},$R.READ_ANIMATIONS=function(){var $d=$R._reader,$t=$d.__getBuffer(),$l=0,$k=0,$W=0,$i=0,$A=$d.getUint16(),$B=[];for($B.length=$A,$l=0;$l<$A;$l++)$B[$l]=$x.interpolation[$d.getByte()];var $o=$d.getUint8();for($R._templet._anis.length=$o,$l=0;$l<$o;$l++){var $I=$R._templet._anis[$l]={};$I.nodes=new Array();var $b=$I.name=$R._strings[$d.getUint16()];$R._templet._aniMap[$b]=$l,$I.bone3DMap={},$I.playTime=$d.getFloat32();var $f=$I.nodes.length=$d.getInt16();for($k=$I.totalKeyframeDatasLength=0;$k<$f;$k++){var $J=$I.nodes[$k]={};$J.keyframeWidth=$A,$J.childs=[];var $c=$d.getUint16();0<=$c&&($J.name=$R._strings[$c],$I.bone3DMap[$J.name]=$k),$J.keyFrame=new Array(),$J.parentIndex=$d.getInt16(),-1==$J.parentIndex?$J.parent=null:$J.parent=$I.nodes[$J.parentIndex],$I.totalKeyframeDatasLength+=$A,$J.interpolationMethod=$B,null!=$J.parent&&$J.parent.childs.push($J);var $Y=$d.getUint16(),$w=null,$D=null;for($W=0,$i=$J.keyFrame.length=$Y;$W<$i;$W++){($w=$J.keyFrame[$W]={}).startTime=$d.getFloat32(),$D&&($D.duration=$w.startTime-$D.startTime);var $z=$R._DATA.offset,$e=$d.getUint32(),$g=4*$A,$H=$t.slice($z+$e,$z+$e+$g);$w.data=new Float32Array($H),$D=$w;}$w.duration=0,$J.playTime=$I.playTime,$R._templet._calculateKeyFrame($J,$Y,$A);}}},$R._templet=null,$R._reader=null,$R._strings=[],$l($R,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$R;}(),$Cd=(function(){function $d(){}$k($d,"laya.ani.AnimationState"),$d.stopped=0,$d.paused=1,$d.playing=2;}(),function(){function $W(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $sd(),this.resultMatrix=new $Sd(),this._children=[];}$k($W,"laya.ani.bone.Bone");var $d=$W.prototype;return $d.setTempMatrix=function($d){this._tempMatrix=$d;var $t,$l=0;for($l=0,$t=this._children.length;$l<$t;$l++)this._children[$l].setTempMatrix(this._tempMatrix);},$d.update=function($d){var $t;if(this.rotation=this.transform.skX,$d)$t=this.resultTransform.getMatrix(),$Sd.mul($t,$d,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone){if(this.inheritRotation&&this.inheritScale)$t=this.resultTransform.getMatrix(),$Sd.mul($t,this.parentBone.resultMatrix,this.resultMatrix);else{var $l=this.parentBone,$k=NaN,$W=NaN,$i=NaN,$A=this.parentBone.resultMatrix;$t=this.resultTransform.getMatrix();var $B=$A.a*$t.tx+$A.c*$t.ty+$A.tx,$o=$A.b*$t.tx+$A.d*$t.ty+$A.ty,$I=new $Sd();this.inheritRotation?($k=Math.atan2($l.resultMatrix.b,$l.resultMatrix.a),$W=Math.cos($k),$i=Math.sin($k),$I.setTo($W,$i,-$i,$W,0,0),$Sd.mul(this._tempMatrix,$I,$Sd.TEMP),$Sd.TEMP.copyTo($I),$t=this.resultTransform.getMatrix(),$Sd.mul($t,$I,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$t=this.resultTransform.getMatrix(),$Sd.TEMP.identity(),$Sd.TEMP.d=this.d,$Sd.mul($t,$Sd.TEMP,this.resultMatrix)),this.resultMatrix.tx=$B,this.resultMatrix.ty=$o;}}else($t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $b,$f=0;for($f=0,$b=this._children.length;$f<$b;$f++)this._children[$f].update();},$d.updateChild=function(){var $d,$t=0;for($t=0,$d=this._children.length;$t<$d;$t++)this._children[$t].update();},$d.setRotation=function($d){this._sprite&&(this._sprite.rotation=180*$d/Math.PI);},$d.updateDraw=function($d,$t){$W.ShowBones&&!$W.ShowBones[this.name]||(this._sprite||(this._sprite=new $id(),this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$Wd.stage.addChild(this._sprite)),this._sprite.x=$d+this.resultMatrix.tx,this._sprite.y=$t+this.resultMatrix.ty);var $l,$k=0;for($k=0,$l=this._children.length;$k<$l;$k++)this._children[$k].updateDraw($d,$t);},$d.addChild=function($d){this._children.push($d),$d.parentBone=this;},$d.findBone=function($d){if(this.name==$d)return this;var $t,$l,$k=0;for($k=0,$t=this._children.length;$k<$t;$k++)if($l=this._children[$k].findBone($d))return $l;return null;},$d.localToWorld=function($d){var $t=$d[0],$l=$d[1];$d[0]=$t*this.resultMatrix.a+$l*this.resultMatrix.c+this.resultMatrix.tx,$d[1]=$t*this.resultMatrix.b+$l*this.resultMatrix.d+this.resultMatrix.ty;},$W.ShowBones={},$W;}()),$Kd=function(){function $w(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null;}$k($w,"laya.ani.bone.BoneSlot");var $d=$w.prototype;return $d.showSlotData=function($d,$t){void 0===$t&&($t=!0),this.currSlotData=$d,$t&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null;},$d.showDisplayByName=function($d){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($d));},$d.replaceDisplayByName=function($d,$t){if(this.currSlotData){var $l;$l=this.currSlotData.getDisplayByName($d);var $k;$k=this.currSlotData.getDisplayByName($t),this.replaceDisplayByIndex($l,$k);}},$d.replaceDisplayByIndex=function($d,$t){this.currSlotData&&(this._replaceDic[$d]=$t,this.displayIndex==$d&&this.showDisplayByIndex($d));},$d.showDisplayByIndex=function($d){if(null!=this._replaceDic[$d]&&($d=this._replaceDic[$d]),this.currSlotData&&-1<$d&&$d<this.currSlotData.displayArr.length){if(this.displayIndex=$d,this.currDisplayData=this.currSlotData.displayArr[$d],this.currDisplayData){var $t=this.currDisplayData.name;this.currTexture=this.templet.getTexture($t),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$D.isConchApp||$D.isConchApp&&"0.9.15"<$id.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture));}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null;},$d.replaceSkin=function($d){this._diyTexture=$d,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null);},$d.setParentMatrix=function($d){this._parentMatrix=$d;},$d.draw=function($d,$t,$l,$k){if(void 0===$l&&($l=!1),void 0===$k&&($k=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $W,$i=this.currTexture;switch(this._diyTexture&&($i=this._diyTexture),this.currDisplayData.type){case 0:if($d){var $A=this.getDisplayMatrix();if(this._parentMatrix){var $B=!1;if($A){var $o;if($Sd.mul($A,this._parentMatrix,$Sd.TEMP),$o=$l?(null==this._resultMatrix&&(this._resultMatrix=new $Sd()),this._resultMatrix):new $Sd(),!$D.isWebGL&&this.currDisplayData.uvs||$D.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $I=$w._tempMatrix;$I.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($I.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($B=!0,$I.rotate(-Math.PI/2)),$Sd.mul($I,$Sd.TEMP,$o);}else $Sd.TEMP.copyTo($o);$B?$d.drawTexture($i,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$o):$d.drawTexture($i,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$o);}}}break;case 1:if(null==($W=$l?(null==this._skinSprite&&(this._skinSprite=$w.createSkinMesh()),this._skinSprite):$w.createSkinMesh()))return;var $b;if(null==this.currDisplayData.bones){var $f,$J=this.currDisplayData.weights;this.deformData&&($J=this.deformData),$f=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$J;this.currDisplayData.triangles.length;$b=this.currDisplayData.triangles,$W.init2($i,null,$b,this._mVerticleArr,$f);var $c,$Y=this.getDisplayMatrix();if(this._parentMatrix)if($Y)$Sd.mul($Y,this._parentMatrix,$Sd.TEMP),$c=$l?(null==this._resultMatrix&&(this._resultMatrix=new $Sd()),this._resultMatrix):new $Sd(),$Sd.TEMP.copyTo($c),$W.transform=$c;}else this.skinMesh($t,$W,$k);$d.drawSkin($W);break;case 2:if(null==($W=$l?(null==this._skinSprite&&(this._skinSprite=$w.createSkinMesh()),this._skinSprite):$w.createSkinMesh()))return;this.skinMesh($t,$W,$k),$d.drawSkin($W);}}},$d.skinMesh=function($d,$t,$l){var $k,$W=this.currTexture,$i=this.currDisplayData.bones;$k=this._diyTexture?($W=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $A,$B,$o=this.currDisplayData.weights,$I=this.currDisplayData.triangles,$b=0,$f=0,$J=0,$c=NaN,$Y=NaN,$w=0,$D=0,$z=[],$e=0,$g=0;if(this.deformData&&0<this.deformData.length){var $H=0;for($e=0,$g=$i.length;$e<$g;){for($J=$i[$e++]+$e,$f=$b=0;$e<$J;$e++)$B=$d[$i[$e]],$c=$o[$w]+this.deformData[$H++],$Y=$o[$w+1]+this.deformData[$H++],$D=$o[$w+2],$b+=($c*$B.a+$Y*$B.c+$B.tx)*$D,$f+=($c*$B.b+$Y*$B.d+$B.ty)*$D,$w+=3;$z.push($b,$f);}}else for($e=0,$g=$i.length;$e<$g;){for($J=$i[$e++]+$e,$f=$b=0;$e<$J;$e++)$B=$d[$i[$e]],$c=$o[$w],$Y=$o[$w+1],$D=$o[$w+2],$b+=($c*$B.a+$Y*$B.c+$B.tx)*$D,$f+=($c*$B.b+$Y*$B.d+$B.ty)*$D,$w+=3;$z.push($b,$f);}this._mVerticleArr=$z,$A=$I,$t.init2($W,null,$A,this._mVerticleArr,$k);},$d.drawBonePoint=function($d){$d&&this._parentMatrix&&$d.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000");},$d.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null;},$d.getMatrix=function(){return this._resultMatrix;},$d.copy=function(){var $d=new $w();return $d.type="copy",$d.name=this.name,$d.attachmentName=this.attachmentName,$d.srcDisplayIndex=this.srcDisplayIndex,$d.parent=this.parent,$d.displayIndex=this.displayIndex,$d.templet=this.templet,$d.currSlotData=this.currSlotData,$d.currTexture=this.currTexture,$d.currDisplayData=this.currDisplayData,$d;},$w.createSkinMesh=function(){return $D.isWebGL||$D.isConchApp?$c.skinAniSprite():($D.isWebGL,null);},$l($w,["_tempMatrix",function(){return this._tempMatrix=new $Sd();}]),$w;}(),$xd=function(){function $d(){this.skinName=null,this.deformSlotDataList=[];}return $k($d,"laya.ani.bone.DeformAniData"),$d;}(),$nd=function(){function $d(){this.deformSlotDisplayList=[];}return $k($d,"laya.ani.bone.DeformSlotData"),$d;}(),$Qd=function(){function $d(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[];}$k($d,"laya.ani.bone.DeformSlotDisplayData");var $t=$d.prototype;return $t.binarySearch1=function($d,$t){var $l=0,$k=$d.length-2;if(0==$k)return 1;for(var $W=$k>>>1;;){if($d[Math.floor($W+1)]<=$t?$l=$W+1:$k=$W,$l==$k)return $l+1;$W=$l+$k>>>1;}return 0;},$t.apply=function($d,$t,$l){if(void 0===$l&&($l=1),$d+=.05,!(this.timeList.length<=0)){var $k=0;if(!($d<this.timeList[0])){var $W=this.vectices[0].length,$i=[],$A=this.binarySearch1(this.timeList,$d);if(this.frameIndex=$A,$d>=this.timeList[this.timeList.length-1]){var $B=this.vectices[this.vectices.length-1];if($l<1)for($k=0;$k<$W;$k++)$i[$k]+=($B[$k]-$i[$k])*$l;else for($k=0;$k<$W;$k++)$i[$k]=$B[$k];this.deformData=$i;}else{this.tweenKeyList[this.frameIndex];var $o=this.vectices[this.frameIndex-1],$I=this.vectices[this.frameIndex],$b=this.timeList[this.frameIndex-1],$f=this.timeList[this.frameIndex];$l=this.tweenKeyList[$A-1]?($d-$b)/($f-$b):0;var $J=NaN;for($k=0;$k<$W;$k++)$J=$o[$k],$i[$k]=$J+($I[$k]-$J)*$l;this.deformData=$i;}}}},$d;}(),$yd=function(){function $d(){this.time=NaN,this.drawOrder=[];}return $k($d,"laya.ani.bone.DrawOrderData"),$d;}(),$Vd=function(){function $d(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN;}return $k($d,"laya.ani.bone.EventData"),$d;}(),$e=function(){function $kd($d,$t){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$d,this._targetBone=$t[$d.targetBoneIndex],this.isSpine=$d.isSpine,null==this._bones&&(this._bones=[]);for(var $l=this._bones.length=0,$k=$d.boneIndexs.length;$l<$k;$l++)this._bones.push($t[$d.boneIndexs[$l]]);this.name=$d.name,this.mix=$d.mix,this.bendDirection=$d.bendDirection;}$k($kd,"laya.ani.bone.IkConstraint");var $d=$kd.prototype;return $d.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix);}},$d._applyIk1=function($d,$t,$l,$k){var $W=$d.parentBone,$i=1/($W.resultMatrix.a*$W.resultMatrix.d-$W.resultMatrix.b*$W.resultMatrix.c),$A=$t-$W.resultMatrix.tx,$B=$l-$W.resultMatrix.ty,$o=($A*$W.resultMatrix.d-$B*$W.resultMatrix.c)*$i-$d.transform.x,$I=($B*$W.resultMatrix.a-$A*$W.resultMatrix.b)*$i-$d.transform.y,$b=Math.atan2($I,$o)*$kd.radDeg-0-$d.transform.skX;$d.transform.scX<0&&($b+=180),180<$b?$b-=360:$b<-180&&($b+=360),$d.transform.skX=$d.transform.skY=$d.transform.skX+$b*$k,$d.update();},$d.updatePos=function($d,$t){this._sp&&this._sp.pos($d,$t);},$d._applyIk2=function($d,$t,$l,$k,$W,$i){if(0!=$i){var $A=$d.resultTransform.x,$B=$d.resultTransform.y,$o=$d.transform.scX,$I=$d.transform.scY,$b=$t.transform.scX,$f=0,$J=0,$c=0;$c=$o<0?($o=-$o,$f=180,-1):($f=0,1),$I<0&&($I=-$I,$c=-$c),$J=$b<0?($b=-$b,180):0;var $Y=$t.resultTransform.x,$w=NaN,$D=NaN,$z=NaN,$e=$d.resultMatrix.a,$g=$d.resultMatrix.c,$H=$d.resultMatrix.b,$R=$d.resultMatrix.d,$G=Math.abs($o-$I)<=1e-4;$z=$G?($D=$e*$Y+$g*($w=$t.resultTransform.y)+$d.resultMatrix.tx,$H*$Y+$R*$w+$d.resultMatrix.ty):($w=0,$D=$e*$Y+$d.resultMatrix.tx,$H*$Y+$d.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $id(),$Wd.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($l,$k,15,"#ffff00"),this._sp.graphics.drawCircle($D,$z,15,"#ff00ff")),$d.setRotation(Math.atan2($z-$d.resultMatrix.ty,$D-$d.resultMatrix.tx));var $q=$d.parentBone;$e=$q.resultMatrix.a,$g=$q.resultMatrix.c,$H=$q.resultMatrix.b;var $L=1/($e*($R=$q.resultMatrix.d)-$g*$H),$$=$l-$q.resultMatrix.tx,$p=$k-$q.resultMatrix.ty,$M=($$*$R-$p*$g)*$L-$A,$T=($p*$e-$$*$H)*$L-$B,$r=(($$=$D-$q.resultMatrix.tx)*$R-($p=$z-$q.resultMatrix.ty)*$g)*$L-$A,$S=($p*$e-$$*$H)*$L-$B,$j=Math.sqrt($r*$r+$S*$S),$C=$t.length*$b,$K=NaN,$x=NaN;if($G){var $n=($M*$M+$T*$T-$j*$j-($C*=$o)*$C)/(2*$j*$C);$n<-1?$n=-1:1<$n&&($n=1),$x=Math.acos($n)*$W,$e=$j+$C*$n,$g=$C*Math.sin($x),$K=Math.atan2($T*$e-$M*$g,$M*$e+$T*$g);}else{var $Q=($e=$o*$C)*$e,$y=($g=$I*$C)*$g,$V=$M*$M+$T*$T,$Z=Math.atan2($T,$M),$U=-2*$y*$j,$E=$y-$Q;if(0<($R=$U*$U-4*$E*($H=$y*$j*$j+$Q*$V-$Q*$y))){var $N=Math.sqrt($R);$U<0&&($N=-$N);var $u=($N=-($U+$N)/2)/$E,$h=$H/$N,$s=Math.abs($u)<Math.abs($h)?$u:$h;$s*$s<=$V&&($p=Math.sqrt($V-$s*$s)*$W,$K=$Z-Math.atan2($p,$s),$x=Math.atan2($p/$I,($s-$j)/$o));}var $P=0,$X=Number.MAX_VALUE,$m=0,$O=0,$F=0,$a=0,$_=0,$v=0;$a<($R=($$=$j+$e)*$$)&&($F=0,$a=$R,$_=$$),($R=($$=$j-$e)*$$)<$X&&($P=Math.PI,$X=$R,$m=$$);var $dd=Math.acos(-$e*$j/($Q-$y));($R=($$=$e*Math.cos($dd)+$j)*$$+($p=$g*Math.sin($dd))*$p)<$X&&($P=$dd,$X=$R,$m=$$,$O=$p),$a<$R&&($F=$dd,$a=$R,$_=$$,$v=$p),$x=$V<=($X+$a)/2?($K=$Z-Math.atan2($O*$W,$m),$P*$W):($K=$Z-Math.atan2($v*$W,$_),$F*$W);}var $td=Math.atan2($w,$Y)*$c,$ld=$d.resultTransform.skX;180<($K=($K-$td)*$kd.radDeg+$f-$ld)?$K-=360:$K<-180&&($K+=360),$d.resultTransform.x=$A,$d.resultTransform.y=$B,$d.resultTransform.skX=$d.resultTransform.skY=$ld+$K*$i,$ld=$t.resultTransform.skX,180<($x=(($x+$td)*$kd.radDeg-0)*$c+$J-($ld%=360))?$x-=360:$x<-180&&($x+=360),$t.resultTransform.x=$Y,$t.resultTransform.y=$w,$t.resultTransform.skX=$t.resultTransform.skY=$t.resultTransform.skY+$x*$i,$d.update();}},$d._applyIk3=function($d,$t,$l,$k,$W,$i){if(0!=$i){var $A,$B,$o=$t.resultMatrix.a*$t.length,$I=$t.resultMatrix.b*$t.length,$b=$o*$o+$I*$I,$f=Math.sqrt($b),$J=$d.resultMatrix.tx,$c=$d.resultMatrix.ty,$Y=$t.resultMatrix.tx,$w=$t.resultMatrix.ty,$D=$Y-$J,$z=$w-$c,$e=$D*$D+$z*$z,$g=Math.sqrt($e),$H=($D=$l-$d.resultMatrix.tx)*$D+($z=$k-$d.resultMatrix.ty)*$z,$R=Math.sqrt($H);if($f+$g<=$R||$R+$f<=$g||$R+$g<=$f){var $G=NaN;$Y=$J+($G=$f+$g<=$R?1:-1)*($l-$J)*$g/$R,$w=$c+$G*($k-$c)*$g/$R;}else{var $q=($e-$b+$H)/(2*$H),$L=Math.sqrt($e-$q*$q*$H)/$R,$$=$J+$D*$q,$p=$c+$z*$q,$M=-$z*$L,$T=$D*$L;$w=0<$W?($Y=$$-$M,$p-$T):($Y=$$+$M,$p+$T);}$A=$Y,$B=$w,this.isDebug&&(this._sp||(this._sp=new $id(),$Wd.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($J,$c,15,"#ff00ff"),this._sp.graphics.drawCircle($l,$k,15,"#ffff00"),this._sp.graphics.drawCircle($A,$B,15,"#ff00ff"));var $r,$S;$r=Math.atan2($B-$d.resultMatrix.ty,$A-$d.resultMatrix.tx),$d.setRotation($r),($S=$kd._tempMatrix).identity(),$S.rotate($r),$S.scale($d.resultMatrix.getScaleX(),$d.resultMatrix.getScaleY()),$S.translate($d.resultMatrix.tx,$d.resultMatrix.ty),$S.copyTo($d.resultMatrix),$d.updateChild();var $j,$C;$j=Math.atan2($k-$B,$l-$A),$t.setRotation($j),($C=$kd._tempMatrix).identity(),$C.rotate($j),$C.scale($t.resultMatrix.getScaleX(),$t.resultMatrix.getScaleY()),$C.translate($A,$B),$S.copyTo($t.resultMatrix),$t.updateChild();}},$l($kd,["radDeg",function(){return this.radDeg=180/Math.PI;},"degRad",function(){return this.degRad=Math.PI/180;},"_tempMatrix",function(){return this._tempMatrix=new $Sd();}]),$kd;}(),$Zd=function(){function $d(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[];}return $k($d,"laya.ani.bone.IkConstraintData"),$d;}(),$R=function(){function $C($d,$t){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$d,this.position=$d.position,this.spacing=$d.spacing,this.rotateMix=$d.rotateMix,this.translateMix=$d.translateMix,this.bones=[];for(var $l=this.data.bones,$k=0,$W=$l.length;$k<$W;$k++)this.bones.push($t[$l[$k]]);}$k($C,"laya.ani.bone.PathConstraint");var $d=$C.prototype;return $d.apply=function($d,$t){if(this.target){var $l=this.translateMix,$k=this.translateMix,$W=0<$k,$i=this.data.spacingMode,$A="length"==$i,$B=this.data.rotateMode,$o="tangent"==$B,$I="chainScale"==$B,$b=[],$f=this.bones.length,$J=$o?$f:$f+1,$c=[];(this._spaces=$c)[0]=this.position;var $Y=this.spacing;if($I||$A)for(var $w=0,$D=$J-1;$w<$D;){var $z=this.bones[$w],$e=$z.length,$g=$e*$z.resultMatrix.a,$H=$e*$z.resultMatrix.b;$e=Math.sqrt($g*$g+$H*$H),$I&&($b[$w]=$e),$c[++$w]=$A?Math.max(0,$e+$Y):$Y;}else for($w=1;$w<$J;$w++)$c[$w]=$Y;var $R=this.computeWorldPositions(this.target,$d,$t,$J,$o,"percent"==this.data.positionMode,"percent"==$i);if(this._debugKey){for($w=0;$w<$R.length;$w++)$t.drawCircle($R[$w++],$R[$w++],5,"#00ff00");var $G=[];for($w=0;$w<$R.length;$w++)$G.push($R[$w++],$R[$w++]);$t.drawLines(0,0,$G,"#ff0000");}var $q=$R[0],$L=$R[1],$$=this.data.offsetRotation,$p="chain"==$B&&0==$$,$M=NaN;for($w=0,$M=3;$w<$f;$w++,$M+=3){($z=this.bones[$w]).resultMatrix.tx+=($q-$z.resultMatrix.tx)*$l,$z.resultMatrix.ty+=($L-$z.resultMatrix.ty)*$l;var $T=($g=$R[$M])-$q,$r=($H=$R[$M+1])-$L;if($I&&0!=($e=$b[$w])){var $S=(Math.sqrt($T*$T+$r*$r)/$e-1)*$k+1;$z.resultMatrix.a*=$S,$z.resultMatrix.c*=$S;}if($q=$g,$L=$H,$W){var $j=$z.resultMatrix.a,$C=$z.resultMatrix.c,$K=$z.resultMatrix.b,$x=$z.resultMatrix.d,$n=NaN,$Q=NaN,$y=NaN;$n=$o?$R[$M-1]:0==$c[$w+1]?$R[$M+2]:Math.atan2($r,$T),$n-=Math.atan2($K,$j)-$$/180*Math.PI,$p&&($Q=Math.cos($n),$y=Math.sin($n),$q+=(($e=$z.length)*($Q*$j-$y*$K)-$T)*$k,$L+=($e*($y*$j+$Q*$K)-$r)*$k),$n>Math.PI?$n-=2*Math.PI:$n<-Math.PI&&($n+=2*Math.PI),$n*=$k,$Q=Math.cos($n),$y=Math.sin($n),$z.resultMatrix.a=$Q*$j-$y*$K,$z.resultMatrix.c=$Q*$C-$y*$x,$z.resultMatrix.b=$y*$j+$Q*$K,$z.resultMatrix.d=$y*$C+$Q*$x;}}}},$d.computeWorldVertices2=function($d,$t,$l,$k,$W,$i){var $A,$B,$o=$d.currDisplayData.bones,$I=$d.currDisplayData.weights,$b=$d.currDisplayData.triangles,$f=0,$J=0,$c=0,$Y=0,$w=0,$D=0,$z=0,$e=0,$g=0,$H=0,$R=0;if(null!=$o){for($f=0;$f<$l;$f+=2)$J+=($Y=$o[$J])+1,$c+=$Y;var $G=$t;for($w=$i,$D=3*$c;$w<$k;$w+=2){for($e=$z=0,$Y=$o[$J++],$Y+=$J;$J<$Y;$J++,$D+=3){$A=$G[$o[$J]].resultMatrix,$g=$I[$D],$H=$I[$D+1];var $q=$I[$D+2];$z+=($g*$A.a+$H*$A.c+$A.tx)*$q,$e+=($g*$A.b+$H*$A.d+$A.ty)*$q;}$W[$w]=$z,$W[$w+1]=$e;}}else{var $L,$$;if($b||($b=$I),$d.deformData&&($b=$d.deformData),$L=$d.parent,$t)for($R=$t.length,$f=0;$f<$R;$f++)if($t[$f].name==$L){$B=$t[$f];break;}$B&&($$=$B.resultMatrix),$$||($$=$C._tempMt);var $p=$$.tx,$M=$$.ty,$T=$$.a,$r=$$.b,$S=$$.c,$j=$$.d;for($B&&($j*=$B.d),$J=$l,$w=$i;$w<$k;$J+=2,$w+=2)$g=$b[$J],$H=$b[$J+1],$W[$w]=$g*$T+$H*$r+$p,$W[$w+1]=-($g*$S+$H*$j+$M);}},$d.computeWorldPositions=function($d,$t,$l,$k,$W,$i,$A){$d.currDisplayData.bones,$d.currDisplayData.weights,$d.currDisplayData.triangles;var $B=[],$o=0,$I=$d.currDisplayData.verLen,$b=this.position,$f=this._spaces,$J=[],$c=[],$Y=$I/6,$w=-1,$D=NaN,$z=0,$e=0,$g=NaN,$H=NaN,$R=NaN,$G=NaN;if($Y--,$I-=4,this.computeWorldVertices2($d,$t,2,$I,$B,0),this._debugKey)for($o=0;$o<$B.length;)$l.drawCircle($B[$o++],$B[$o++],10,"#ff0000");$J=$B,this._curves.length=$Y;var $q=this._curves,$L=$J[$D=0],$$=$J[1],$p=0,$M=0,$T=0,$r=0,$S=0,$j=0,$C=NaN,$K=NaN,$x=NaN,$n=NaN,$Q=NaN,$y=NaN,$V=NaN,$Z=NaN,$U=0;for($o=0,$U=2;$o<$Y;$o++,$U+=6)$p=$J[$U],$M=$J[$U+1],$T=$J[$U+2],$r=$J[$U+3],$Q=2*($C=.1875*($L-2*$p+$T))+($x=.09375*(3*($p-$T)-$L+($S=$J[$U+4]))),$y=2*($K=.1875*($$-2*$M+$r))+($n=.09375*(3*($M-$r)-$$+($j=$J[$U+5]))),$V=.75*($p-$L)+$C+.16666667*$x,$Z=.75*($M-$$)+$K+.16666667*$n,$D+=Math.sqrt($V*$V+$Z*$Z),$V+=$Q,$Z+=$y,$Q+=$x,$y+=$n,$D+=Math.sqrt($V*$V+$Z*$Z),$V+=$Q,$Z+=$y,$D+=Math.sqrt($V*$V+$Z*$Z),$V+=$Q+$x,$Z+=$y+$n,$D+=Math.sqrt($V*$V+$Z*$Z),$q[$o]=$D,$L=$S,$$=$j;if($i&&($b*=$D),$A)for($o=0;$o<$k;$o++)$f[$o]*=$D;var $E=this._segments,$N=0,$u=0;for($u=$e=$z=$o=0;$o<$k;$o++,$z+=3)if(($g=$b+=$H=$f[$o])<0)this.addBeforePosition($g,$J,0,$c,$z);else if($D<$g)this.addAfterPosition($g-$D,$J,$I-4,$c,$z);else{for(;;$e++)if(!(($G=$q[$e])<$g)){0==$e?$g/=$G:$g=($g-($R=$q[$e-1]))/($G-$R);break;}if($e!=$w){var $h=6*($w=$e);for($L=$J[$h],$$=$J[$h+1],$p=$J[$h+2],$M=$J[$h+3],$T=$J[$h+4],$r=$J[$h+5],$Q=2*($C=.03*($L-2*$p+$T))+($x=.006*(3*($p-$T)-$L+($S=$J[$h+6]))),$y=2*($K=.03*($$-2*$M+$r))+($n=.006*(3*($M-$r)-$$+($j=$J[$h+7]))),$V=.3*($p-$L)+$C+.16666667*$x,$Z=.3*($M-$$)+$K+.16666667*$n,$N=Math.sqrt($V*$V+$Z*$Z),$E[0]=$N,$h=1;$h<8;$h++)$V+=$Q,$Z+=$y,$Q+=$x,$y+=$n,$N+=Math.sqrt($V*$V+$Z*$Z),$E[$h]=$N;$V+=$Q,$Z+=$y,$N+=Math.sqrt($V*$V+$Z*$Z),$E[8]=$N,$V+=$Q+$x,$Z+=$y+$n,$N+=Math.sqrt($V*$V+$Z*$Z),$E[9]=$N,$u=0;}for($g*=$N;;$u++)if(!(($G=$E[$u])<$g)){0==$u?$g/=$G:$g=$u+($g-($R=$E[$u-1]))/($G-$R);break;}this.addCurvePosition(.1*$g,$L,$$,$p,$M,$T,$r,$S,$j,$c,$z,$W||0<$o&&0==$H);}return $c;},$d.addBeforePosition=function($d,$t,$l,$k,$W){var $i=$t[$l],$A=$t[$l+1],$B=$t[$l+2]-$i,$o=$t[$l+3]-$A,$I=Math.atan2($o,$B);$k[$W]=$i+$d*Math.cos($I),$k[$W+1]=$A+$d*Math.sin($I),$k[$W+2]=$I;},$d.addAfterPosition=function($d,$t,$l,$k,$W){var $i=$t[$l+2],$A=$t[$l+3],$B=$i-$t[$l],$o=$A-$t[$l+1],$I=Math.atan2($o,$B);$k[$W]=$i+$d*Math.cos($I),$k[$W+1]=$A+$d*Math.sin($I),$k[$W+2]=$I;},$d.addCurvePosition=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b,$f){0==$d&&($d=1e-4);var $J=$d*$d,$c=$J*$d,$Y=1-$d,$w=$Y*$Y,$D=$w*$Y,$z=$Y*$d,$e=3*$z,$g=$Y*$e,$H=$e*$d,$R=$t*$D+$k*$g+$i*$H+$B*$c,$G=$l*$D+$W*$g+$A*$H+$o*$c;$I[$b]=$R,$I[$b+1]=$G,$I[$b+2]=$f?Math.atan2($G-($l*$w+$W*$z*2+$A*$J),$R-($t*$w+$k*$z*2+$i*$J)):0;},$C.NONE=-1,$C.BEFORE=-2,$C.AFTER=-3,$l($C,["_tempMt",function(){return this._tempMt=new $Sd();}]),$C;}(),$Ud=function(){function $d(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[];}return $k($d,"laya.ani.bone.PathConstraintData"),$d;}(),$Ed=function(){function $d(){this.name=null,this.slotArr=[];}return $k($d,"laya.ani.bone.SkinData"),$d;}(),$Nd=function(){function $d(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0;}$k($d,"laya.ani.bone.SkinSlotDisplayData");var $t=$d.prototype;return $t.createTexture=function($d){return this.texture||(this.texture=new $jd($d.bitmap,this.uvs),$d.bitmap.alphaTexture&&(this.texture.alphaTexture=new $jd($d.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$d.height,this.texture.height=$d.width,this.texture.offsetX=-$d.offsetX,this.texture.offsetY=-$d.offsetY,this.texture.sourceWidth=$d.sourceHeight,this.texture.sourceHeight=$d.sourceWidth):(this.texture.width=$d.width,this.texture.height=$d.height,this.texture.offsetX=-$d.offsetX,this.texture.offsetY=-$d.offsetY,this.texture.sourceWidth=$d.sourceWidth,this.texture.sourceHeight=$d.sourceHeight),$D.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture;},$t.destory=function(){this.texture&&this.texture.destroy();},$d;}(),$ud=function(){function $d(){this.name=null,this.displayArr=[];}return $k($d,"laya.ani.bone.SlotData"),$d.prototype.getDisplayByName=function($d){for(var $t=0,$l=this.displayArr.length;$t<$l;$t++)if(this.displayArr[$t].attachmentName==$d)return $t;return-1;},$d;}(),$G=function(){function $d($d,$t){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$w(2,0),this._data=$d,null==this._bones&&(this._bones=[]),this.target=$t[$d.targetIndex];var $l,$k=0;for($k=0,$l=$d.boneIndexs.length;$k<$l;$k++)this._bones.push($t[$d.boneIndexs[$k]]);this.rotateMix=$d.rotateMix,this.translateMix=$d.translateMix,this.scaleMix=$d.scaleMix,this.shearMix=$d.shearMix;}return $k($d,"laya.ani.bone.TfConstraint"),$d.prototype.apply=function(){for(var $d,$t=this.target.resultMatrix.a,$l=this.target.resultMatrix.b,$k=this.target.resultMatrix.c,$W=this.target.resultMatrix.d,$i=0,$A=this._bones.length;$i<$A;$i++){if($d=this._bones[$i],0<this.rotateMix){var $B=$d.resultMatrix.a,$o=$d.resultMatrix.b,$I=$d.resultMatrix.c,$b=$d.resultMatrix.d,$f=Math.atan2($k,$t)-Math.atan2($I,$B)+this._data.offsetRotation*Math.PI/180;$f>Math.PI?$f-=2*Math.PI:$f<-Math.PI&&($f+=2*Math.PI),$f*=this.rotateMix;var $J=Math.cos($f),$c=Math.sin($f);$d.resultMatrix.a=$J*$B-$c*$I,$d.resultMatrix.b=$J*$o-$c*$b,$d.resultMatrix.c=$c*$B+$J*$I,$d.resultMatrix.d=$c*$o+$J*$b;}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$d.resultMatrix.tx+=(this._temp[0]-$d.resultMatrix.tx)*this.translateMix,$d.resultMatrix.ty+=(this._temp[1]-$d.resultMatrix.ty)*this.translateMix,$d.updateChild()),0<this.scaleMix){var $Y=Math.sqrt($d.resultMatrix.a*$d.resultMatrix.a+$d.resultMatrix.c*$d.resultMatrix.c),$w=Math.sqrt($t*$t+$k*$k),$D=1e-5<$Y?($Y+($w-$Y+this._data.offsetScaleX)*this.scaleMix)/$Y:0;$d.resultMatrix.a*=$D,$d.resultMatrix.c*=$D,$Y=Math.sqrt($d.resultMatrix.b*$d.resultMatrix.b+$d.resultMatrix.d*$d.resultMatrix.d),$w=Math.sqrt($l*$l+$W*$W),$D=1e-5<$Y?($Y+($w-$Y+this._data.offsetScaleY)*this.scaleMix)/$Y:0,$d.resultMatrix.b*=$D,$d.resultMatrix.d*=$D;}if(0<this.shearMix){$o=$d.resultMatrix.b,$b=$d.resultMatrix.d;var $z=Math.atan2($b,$o);($f=Math.atan2($W,$l)-Math.atan2($k,$t)-($z-Math.atan2($d.resultMatrix.c,$d.resultMatrix.a)))>Math.PI?$f-=2*Math.PI:$f<-Math.PI&&($f+=2*Math.PI),$f=$z+($f+this._data.offsetShearY*Math.PI/180)*this.shearMix,$D=Math.sqrt($o*$o+$b*$b),$d.resultMatrix.b=Math.cos($f)*$D,$d.resultMatrix.d=Math.sin($f)*$D;}}},$d;}(),$hd=function(){function $d(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[];}return $k($d,"laya.ani.bone.TfConstraintData"),$d;}(),$sd=function(){function $d(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null;}$k($d,"laya.ani.bone.Transform");var $t=$d.prototype;return $t.initData=function($d){null!=$d.x&&(this.x=$d.x),null!=$d.y&&(this.y=$d.y),null!=$d.skX&&(this.skX=$d.skX),null!=$d.skY&&(this.skY=$d.skY),null!=$d.scX&&(this.scX=$d.scX),null!=$d.scY&&(this.scY=$d.scY);},$t.getMatrix=function(){var $d;return($d=this.mMatrix?this.mMatrix:this.mMatrix=new $Sd()).identity(),$d.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($d,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$d.rotate(this.skX*Math.PI/180),$d.translate(this.x,this.y),$d;},$t.skew=function($d,$t,$l){var $k=Math.sin($l),$W=Math.cos($l),$i=Math.sin($t),$A=Math.cos($t);return $d.setTo($d.a*$A-$d.b*$k,$d.a*$i+$d.b*$W,$d.c*$A-$d.d*$k,$d.c*$i+$d.d*$W,$d.tx*$A-$d.ty*$k,$d.tx*$i+$d.ty*$W),$d;},$d;}(),$q=function(){function $d(){}return $k($d,"laya.ani.bone.UVTools"),$d.getRelativeUV=function($d,$t,$l){var $k=$d[0],$W=$d[2]-$d[0],$i=$d[1],$A=$d[5]-$d[1];$l||($l=[]),$l.length=$t.length;var $B,$o=0;$B=$l.length;var $I=1/$W,$b=1/$A;for($o=0;$o<$B;$o+=2)$l[$o]=($t[$o]-$k)*$I,$l[$o+1]=($t[$o+1]-$i)*$b;return $l;},$d.getAbsoluteUV=function($d,$t,$l){if(0==$d[0]&&0==$d[1]&&1==$d[4]&&1==$d[5])return $l?($z.copyArray($l,$t),$l):$t;var $k=$d[0],$W=$d[2]-$d[0],$i=$d[1],$A=$d[5]-$d[1];$l||($l=[]),$l.length=$t.length;var $B,$o=0;for($B=$l.length,$o=0;$o<$B;$o+=2)$l[$o]=$t[$o]*$W+$k,$l[$o+1]=$t[$o+1]*$A+$i;return $l;},$d;}(),$C=function(){function $d(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null;}return $k($d,"laya.ani.KeyFramesContent"),$d;}(),$L=function(){function $b(){}return $k($b,"laya.ani.math.BezierLerp"),$b.getBezierRate=function($d,$t,$l,$k,$W){var $i=$b._getBezierParamKey($t,$l,$k,$W),$A=100*$i+$d;if($b._bezierResultCache[$A])return $b._bezierResultCache[$A];var $B,$o=$b._getBezierPoints($t,$l,$k,$W,$i),$I=0;for($B=$o.length,$I=0;$I<$B;$I+=2)if($d<=$o[$I])return $b._bezierResultCache[$A]=$o[$I+1],$o[$I+1];return $b._bezierResultCache[$A]=1;},$b._getBezierParamKey=function($d,$t,$l,$k){return 100*(100*(100*(100*$d+$t)+$l)+$k);},$b._getBezierPoints=function($d,$t,$l,$k,$W){return $b._bezierPointsCache[$W]?$b._bezierPointsCache[$W]:($i=[0,0,$d,$t,$l,$k,1,1],$A=new $B().getBezierPoints($i,100,3),$b._bezierPointsCache[$W]=$A);var $i,$A;},$b._bezierResultCache={},$b._bezierPointsCache={},$b;}(),$$=function($d){function $t(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$t.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1;}$k($t,"laya.ani.AnimationPlayer",$W);var $l=$t.prototype;return $Wd.imps($l,{"laya.resource.IDestroy":!0}),$l._onTempletLoadedComputeFullKeyframeIndices=function($d,$t,$l){this._templet===$l&&this._cachePlayRate===$d&&this._cacheFrameRate===$t&&this._computeFullKeyframeIndices();},$l._computeFullKeyframeIndices=function(){for(var $d=this._fullFrames=[],$t=this._templet,$l=this._cacheFrameRateInterval*this._cachePlayRate,$k=0,$W=$t.getAnimationCount();$k<$W;$k++){for(var $i=[],$A=0,$B=$t.getAnimation($k).nodes.length;$A<$B;$A++){for(var $o=$t.getAnimation($k).nodes[$A],$I=Math.floor($o.playTime/$l+.01),$b=new Uint16Array($I+1),$f=-1,$J=0,$c=$o.keyFrame.length;$J<$c;$J++){var $Y=$o.keyFrame[$J],$w=$Y.startTime,$D=$w+$Y.duration+$l;do{for(var $z=Math.floor($w/$l+.5),$e=$f+1;$e<$z;$e++)$b[$e]=$J;$b[$f=$z]=$J,$w+=$l;}while($w<=$D);}$i.push($b);}$d.push($i);}},$l._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration();},$l._calculatePlayDuration=function(){if(0!==this.state){var $d=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$d),this._playEnd>$d&&(this._playEnd=$d),this._playDuration=this._playEnd-this._playStart;}},$l._setPlayParams=function($d,$t){this._currentTime=$d,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$t+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$t;},$l._setPlayParamsWhenStop=function($d,$t){this._currentTime=$d,this._currentKeyframeIndex=Math.max(Math.floor($d/$t+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$t,this._currentAnimationClipIndex=-1;},$l._update=function($d){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $t=this._cacheFrameRateInterval*this._cachePlayRate,$l=0;this._startUpdateLoopCount!==$Y.loopCount&&($l=$d*this.playbackRate,this._elapsedPlaybackTime+=$l);var $k=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$k)return this._setPlayParamsWhenStop($k,$t),void this.event("stopped");if($l+=this._currentTime,0<$k){if($k<=$l)do{if($l-=$k,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($k,$t),this._stopWhenCircleFinish=!1,void this.event("stopped");$l<$k&&(this._setPlayParams($l,$t),this.event("complete"));}while($k<=$l);else this._setPlayParams($l,$t);}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($k,$t),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete");}}},$l._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0;},$l.play=function($d,$t,$l,$k,$W){if(void 0===$d&&($d=0),void 0===$t&&($t=1),void 0===$l&&($l=2147483647),void 0===$k&&($k=0),void 0===$W&&($W=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($l<0||$k<0||$W<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$W&&$W<$k)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$t,this._overallDuration=$l,this._playStart=$k,this._playEnd=$W,this._paused=!1,this._currentAnimationClipIndex=$d,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$Y.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0);},$l.playByFrame=function($d,$t,$l,$k,$W,$i){void 0===$d&&($d=0),void 0===$t&&($t=1),void 0===$l&&($l=2147483647),void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$i&&($i=30);var $A=1e3/$i;this.play($d,$t,$l,$k*$A,$W*$A);},$l.stop=function($d){void 0===$d&&($d=!0),$d?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0;},$i(0,$l,"playEnd",function(){return this._playEnd;}),$i(0,$l,"templet",function(){return this._templet;},function($d){0===!this.state&&this.stop(!0),this._templet!==$d&&((this._templet=$d).loaded?this._computeFullKeyframeIndices():$d.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]));}),$i(0,$l,"playStart",function(){return this._playStart;}),$i(0,$l,"playDuration",function(){return this._playDuration;}),$i(0,$l,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2;}),$i(0,$l,"currentKeyframeIndex",function(){return this._currentKeyframeIndex;}),$i(0,$l,"overallDuration",function(){return this._overallDuration;}),$i(0,$l,"currentFrameTime",function(){return this._currentFrameTime;}),$i(0,$l,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex;}),$i(0,$l,"currentPlayTime",function(){return this._currentTime+this._playStart;}),$i(0,$l,"cachePlayRate",function(){return this._cachePlayRate;},function($d){this._cachePlayRate!==$d&&(this._cachePlayRate=$d,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$d,this._cacheFrameRate])));}),$i(0,$l,"cacheFrameRate",function(){return this._cacheFrameRate;},function($d){this._cacheFrameRate!==$d&&(this._cacheFrameRate=$d,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$d])));}),$i(0,$l,"currentTime",null,function($d){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($d<this._playStart||$d>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$Y.loopCount;var $t=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$d,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$t),0),this._currentFrameTime=this._currentKeyframeIndex*$t;}}),$i(0,$l,"paused",function(){return this._paused;},function($d){(this._paused=$d)&&this.event("paused");}),$i(0,$l,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval;}),$i(0,$l,"destroyed",function(){return this._destroyed;}),$t;}(),$K=function($d){function $t(){$t.__super.call(this),$D.isConchNode&&(this.drawSkin=function($d){$d.transform||($d.transform=$Sd.EMPTY),this._addCmd([$d]),this.setSkinMesh&&this.setSkinMesh($d._ps,$d.mVBData,$d.mEleNum,0,$d.mTexture,$d.transform);});}return $k($t,"laya.ani.GraphicsAni",$A),$t.prototype.drawSkin=function($d){var $t=[$d];this._saveToCmd($D._context._drawSkin,$t);},$t.create=function(){return $t._caches.pop()||new $t();},$t.recycle=function($d){$d.clear(),$t._caches.push($d);},$t._caches=[],$t;}(),$x=function($d){function $e(){this._aniMap={},this.unfixedLastAniIndex=-1,$e.__super.call(this),this._anis=new Array();}$k($e,"laya.ani.AnimationTemplet",$b);var $t=$e.prototype;return $t.parse=function($d){var $t=new $rd($d);this._aniVersion=$t.readUTFString(),$g.parse(this,$t);},$t._calculateKeyFrame=function($d,$t,$l){var $k=$d.keyFrame;$k[$t]=$k[0];for(var $W=0;$W<$t;$W++){var $i=$k[$W];$i.nextData=0===$i.duration?$i.data:$k[$W+1].data;}$k.length--;},$t.onAsynLoaded=function($d,$t,$l){var $k=new $rd($t);switch(this._aniVersion=$k.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$H.parse(this,$k);break;default:$g.parse(this,$k);}this._endLoaded();},$t.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null;},$t.getAnimationCount=function(){return this._anis.length;},$t.getAnimation=function($d){return this._anis[$d];},$t.getAniDuration=function($d){return this._anis[$d].playTime;},$t.getNodes=function($d){return this._anis[$d].nodes;},$t.getNodeIndexWithName=function($d,$t){return this._anis[$d].bone3DMap[$t];},$t.getNodeCount=function($d){return this._anis[$d].nodes.length;},$t.getTotalkeyframesLength=function($d){return this._anis[$d].totalKeyframeDatasLength;},$t.getPublicExtData=function(){return this._publicExtData;},$t.getAnimationDataWithCache=function($d,$t,$l,$k){var $W=$t[$l];if($W){var $i=$W[$d];return $i?$i[$k]:null;}return null;},$t.setAnimationDataWithCache=function($d,$t,$l,$k,$W){var $i=$t[$l]||($t[$l]={});($i[$d]||($i[$d]=[]))[$k]=$W;},$t.getOriginalData=function($d,$t,$l,$k,$W){for(var $i=this._anis[$d].nodes,$A=0,$B=0,$o=$i.length,$I=0;$B<$o;$B++){var $b,$f=$i[$B];$b=$f.keyFrame[$l[$B][$k]],$f.dataOffset=$I;var $J=$W-$b.startTime,$c=$f.lerpType;if($c)switch($c){case 0:case 1:for($A=0;$A<$f.keyframeWidth;)$A+=$f.interpolationMethod[$A]($f,$A,$t,$I+$A,$b.data,$J,null,$b.duration,$b.nextData);break;case 2:var $Y=$b.interpolationData,$w=$Y.length,$D=0;for($A=0;$A<$w;){var $z=$Y[$A];switch($z){case 6:case 7:$A+=$e.interpolation[$z]($f,$D,$t,$I+$D,$b.data,$J,null,$b.duration,$b.nextData,$Y,$A+1);break;default:$A+=$e.interpolation[$z]($f,$D,$t,$I+$D,$b.data,$J,null,$b.duration,$b.nextData);}$D++;}}else for($A=0;$A<$f.keyframeWidth;)$A+=$f.interpolationMethod[$A]($f,$A,$t,$I+$A,$b.data,$J,null,$b.duration,$b.nextData);$I+=$f.keyframeWidth;}},$t.getNodesCurrentFrameIndex=function($d,$t){var $l=this._anis[$d].nodes;$d!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($l.length),this.unfixedCurrentTimes=new Float32Array($l.length),this.unfixedLastAniIndex=$d);for(var $k=0,$W=$l.length;$k<$W;$k++){var $i=$l[$k];for($t<this.unfixedCurrentTimes[$k]&&(this.unfixedCurrentFrameIndexes[$k]=0),this.unfixedCurrentTimes[$k]=$t;this.unfixedCurrentFrameIndexes[$k]<$i.keyFrame.length&&!($i.keyFrame[this.unfixedCurrentFrameIndexes[$k]].startTime>this.unfixedCurrentTimes[$k]);)this.unfixedCurrentFrameIndexes[$k]++;this.unfixedCurrentFrameIndexes[$k]--;}return this.unfixedCurrentFrameIndexes;},$t.getOriginalDataUnfixedRate=function($d,$t,$l){var $k=this._anis[$d].nodes;$d!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($k.length),this.unfixedCurrentTimes=new Float32Array($k.length),this.unfixedKeyframes=$w($k.length),this.unfixedLastAniIndex=$d);for(var $W=0,$i=0,$A=$k.length,$B=0;$i<$A;$i++){var $o=$k[$i];for($l<this.unfixedCurrentTimes[$i]&&(this.unfixedCurrentFrameIndexes[$i]=0),this.unfixedCurrentTimes[$i]=$l;this.unfixedCurrentFrameIndexes[$i]<$o.keyFrame.length&&!($o.keyFrame[this.unfixedCurrentFrameIndexes[$i]].startTime>this.unfixedCurrentTimes[$i]);)this.unfixedKeyframes[$i]=$o.keyFrame[this.unfixedCurrentFrameIndexes[$i]],this.unfixedCurrentFrameIndexes[$i]++;var $I=this.unfixedKeyframes[$i];$o.dataOffset=$B;var $b=$l-$I.startTime;if($o.lerpType)switch($o.lerpType){case 0:case 1:for($W=0;$W<$o.keyframeWidth;)$W+=$o.interpolationMethod[$W]($o,$W,$t,$B+$W,$I.data,$b,null,$I.duration,$I.nextData);break;case 2:var $f=$I.interpolationData,$J=$f.length,$c=0;for($W=0;$W<$J;){var $Y=$f[$W];switch($Y){case 6:case 7:$W+=$e.interpolation[$Y]($o,$c,$t,$B+$c,$I.data,$b,null,$I.duration,$I.nextData,$f,$W+1);break;default:$W+=$e.interpolation[$Y]($o,$c,$t,$B+$c,$I.data,$b,null,$I.duration,$I.nextData);}$c++;}}else for($W=0;$W<$o.keyframeWidth;)$W+=$o.interpolationMethod[$W]($o,$W,$t,$B+$W,$I.data,$b,null,$I.duration,$I.nextData);$B+=$o.keyframeWidth;}},$e._LinearInterpolation_0=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){var $b=0===$B?0:$i/$B;return $l[$k]=(1-$b)*$W[$t]+$b*$o[$t],1;},$e._QuaternionInterpolation_1=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){var $b=0===$B?0:$i/$B;return $J.slerpQuaternionArray($W,$t,$o,$t,$b,$l,$k),4;},$e._AngleInterpolation_2=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return 0;},$e._RadiansInterpolation_3=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return 0;},$e._Matrix4x4Interpolation_4=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){for(var $b=0;$b<16;$b++,$t++)$l[$k+$b]=$W[$t]+$i*$A[$t];return 16;},$e._NoInterpolation_5=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I){return $l[$k]=$W[$t],1;},$e._BezierInterpolation_6=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b){return void 0===$b&&($b=0),$l[$k]=$W[$t]+($o[$t]-$W[$t])*$L.getBezierRate($i/$B,$I[$b],$I[$b+1],$I[$b+2],$I[$b+3]),5;},$e._BezierInterpolation_7=function($d,$t,$l,$k,$W,$i,$A,$B,$o,$I,$b){return void 0===$b&&($b=0),$l[$k]=$I[$b+4]+$I[$b+5]*$L.getBezierRate((.001*$i+$I[$b+6])/$I[$b+7],$I[$b],$I[$b+1],$I[$b+2],$I[$b+3]),9;},$e.load=function($d){return $Wd.loader.create($d,null,null,$e);},$e.interpolation=[$e._LinearInterpolation_0,$e._QuaternionInterpolation_1,$e._AngleInterpolation_2,$e._RadiansInterpolation_3,$e._Matrix4x4Interpolation_4,$e._NoInterpolation_5,$e._BezierInterpolation_6,$e._BezierInterpolation_7],$e;}(),$p=function($t){function $l($d,$t){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$l.__super.call(this),void 0===$t&&($t=0),$d&&this.init($d,$t);}$k($l,"laya.ani.bone.Skeleton",$t);var $d=$l.prototype;return $d.init=function($d,$t){void 0===$t&&($t=0);var $l,$k,$W,$i=0,$A=0;if(1==$t)for(this._graphicsCache=[],$i=0,$A=$d.getAnimationCount();$i<$A;$i++)this._graphicsCache.push([]);if(this._yReverseMatrix=$d.yReverseMatrix,this._aniMode=$t,this._templet=$d,this._player=new $$(),this._player.cacheFrameRate=$d.rate,this._player.templet=$d,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$d.mBoneArr,this._rootBone=$d.mRootBone,this._aniSectionDic=$d.aniSectionDic,0<$d.ikArr.length)for(this._ikArr=[],$i=0,$A=$d.ikArr.length;$i<$A;$i++)this._ikArr.push(new $e($d.ikArr[$i],this._boneList));if(0<$d.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$i=0,$A=$d.pathArr.length;$i<$A;$i++)$l=$d.pathArr[$i],$k=new $R($l,this._boneList),($W=this._boneSlotDic[$l.name])&&(($k=new $R($l,this._boneList)).target=$W),this._pathDic[$l.name]=$k;if(0<$d.tfArr.length)for(this._tfArr=[],$i=0,$A=$d.tfArr.length;$i<$A;$i++)this._tfArr.push(new $G($d.tfArr[$i],this._boneList));if(0<$d.skinDataArray.length){var $B=this._templet.skinDataArray[this._skinIndex];this._skinName=$B.name;}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause);},$d.load=function($d,$t,$l){},$d._onLoaded=function(){},$d._parseComplete=function(){var $d=$M.TEMPLET_DICTIONARY[this._aniPath];$d&&(this.init($d,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this);},$d._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败");},$d._onPlay=function(){this.event("played");},$d._onStop=function(){var $d,$t=this._templet.eventAniArr[this._aniClipIndex];if($t&&this._eventIndex<$t.length)for(;this._eventIndex<$t.length;this._eventIndex++)($d=$t[this._eventIndex]).time>=this._player.playStart&&$d.time<=this._player.playEnd&&this.event("label",$d);this._eventIndex=0,this._drawOrder=null,this.event("stopped");},$d._onPause=function(){this.event("paused");},$d._parseSrcBoneMatrix=function(){var $d=0,$t=0;for($t=this._templet.srcBoneMatrixArr.length,$d=0;$d<$t;$d++)this._boneMatrixArray.push(new $Sd());if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $l,$k,$W=this._templet.boneSlotArray;for($d=0,$t=$W.length;$d<$t;$d++)$l=$W[$d],null==($k=this._bindBoneBoneSlotDic[$l.parent])&&(this._bindBoneBoneSlotDic[$l.parent]=$k=[]),this._boneSlotDic[$l.name]=$l=$l.copy(),$k.push($l),this._boneSlotArray.push($l);}},$d._emitMissedEvents=function($d,$t,$l){void 0===$l&&($l=0);var $k=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($k){var $W,$i,$A=0;for($W=$k.length,$A=$l;$A<$W;$A++)($i=$k[$A]).time>=this._player.playStart&&$i.time<=this._player.playEnd&&this.event("label",$i);}},$d._update=function($d){if(void 0===$d&&($d=!0),!(this._pause||$d&&this._indexControl)){var $t=this.timer.currTimer,$l=this._player.currentKeyframeIndex,$k=$t-this._lastTime;if($d?this._player._update($k):$l=-1,this._lastTime=$t,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$k&&this._clipIndex==$l&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $W;this._lastUpdateAniClipIndex=this._aniClipIndex,$l>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $i,$A=this._templet.eventAniArr[this._aniClipIndex];if($A&&this._eventIndex<$A.length&&(($W=$A[this._eventIndex]).time>=this._player.playStart&&$W.time<=this._player.playEnd?this._player.currentPlayTime>=$W.time&&(this.event("label",$W),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($i=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$i&&(this.graphics=$i));var $B=0,$o=0;for($o=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$o-1)&&0<$o;)$o--;if($o<this._clipIndex)for($B=$o;$B<this._clipIndex;$B++)this._createGraphics($B);}else if(1==this._aniMode){if($i=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$i&&(this.graphics=$i));for($o=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$o-1)&&0<$o;)$o--;if($o<this._clipIndex)for($B=$o;$B<this._clipIndex;$B++)this._createGraphics($B);}this._createGraphics();}}},$d._createGraphics=function($d){void 0===$d&&($d=-1),-1==$d&&($d=this._clipIndex);var $t,$l,$k=$d*this._player.cacheFrameRateInterval,$W=this._templet.drawOrderAniArr[this._aniClipIndex];if($W&&0<$W.length)for(this._drawOrderIndex=0,$t=$W[this._drawOrderIndex];$k>=$t.time&&(this._drawOrder=$t.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$W.length));)$t=$W[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$K.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$K.create(),$l=this.graphics;var $i=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$d,$k);var $A,$B,$o,$I,$b=this._aniSectionDic[this._aniClipIndex],$f=0,$J=0,$c=0,$Y=0,$w=0,$D=this._templet.srcBoneMatrixArr.length;for($w=$b[$J=0];$J<$D;$J++)$I=this._boneList[$J],$o=this._templet.srcBoneMatrixArr[$J],$I.resultTransform.scX=$o.scX*this._curOriginalData[$f++],$I.resultTransform.skX=$o.skX+this._curOriginalData[$f++],$I.resultTransform.skY=$o.skY+this._curOriginalData[$f++],$I.resultTransform.scY=$o.scY*this._curOriginalData[$f++],$I.resultTransform.x=$o.x+this._curOriginalData[$f++],$I.resultTransform.y=$o.y+this._curOriginalData[$f++],8===this._templet.tMatrixDataLen&&($I.resultTransform.skewX=$o.skewX+this._curOriginalData[$f++],$I.resultTransform.skewY=$o.skewY+this._curOriginalData[$f++]);var $z,$e={},$g={};for($w+=$b[1];$J<$w;$J++)$e[($z=$i[$J]).name]=this._curOriginalData[$f++],$g[$z.name]=this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++];var $H,$R,$G={},$q={};for($w+=$b[2];$J<$w;$J++)$G[($z=$i[$J]).name]=this._curOriginalData[$f++],$q[$z.name]=this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++],this._curOriginalData[$f++];if(this._pathDic)for($w+=$b[3];$J<$w;$J++){if($z=$i[$J],$H=this._pathDic[$z.name])switch(new $rd($z.extenData).getByte()){case 1:$H.position=this._curOriginalData[$f++];break;case 2:$H.spacing=this._curOriginalData[$f++];break;case 3:$H.rotateMix=this._curOriginalData[$f++],$H.translateMix=this._curOriginalData[$f++];}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($Sd.TEMP.identity()),this._ikArr)for($J=0,$w=this._ikArr.length;$J<$w;$J++)$R=this._ikArr[$J],$G.hasOwnProperty($R.name)&&($R.bendDirection=$G[$R.name]),$q.hasOwnProperty($R.name)&&($R.mix=$q[$R.name]),$R.apply();if(this._pathDic)for(var $L in this._pathDic)($H=this._pathDic[$L]).apply(this._boneList,$l);if(this._tfArr)for($J=0,$Y=this._tfArr.length;$J<$Y;$J++)this._tfArr[$J].apply();for($J=0,$Y=this._boneList.length;$J<$Y;$J++)if($I=this._boneList[$J],$B=this._bindBoneBoneSlotDic[$I.name],$I.resultMatrix.copyTo(this._boneMatrixArray[$J]),$B)for($c=0,$w=$B.length;$c<$w;$c++)($A=$B[$c])&&$A.setParentMatrix($I.resultMatrix);var $$,$p,$M,$T,$r={},$S=this._templet.deformAniArr;if($S&&0<$S.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$J=0,$w=this._boneSlotArray.length;$J<$w;$J++)($A=this._boneSlotArray[$J]).deformData=null;var $j,$C=$S[this._aniClipIndex];for($j in $$=$C.default,this._setDeform($$,$r,this._boneSlotArray,$k),$C)"default"!=$j&&$j!=this._skinName&&($$=$C[$j],this._setDeform($$,$r,this._boneSlotArray,$k));$$=$C[this._skinName],this._setDeform($$,$r,this._boneSlotArray,$k);}if(this._drawOrder)for($J=0,$w=this._drawOrder.length;$J<$w;$J++)$p=$e[($A=this._boneSlotArray[this._drawOrder[$J]]).name],$M=$g[$A.name],isNaN($M)||($l.save(),$l.alpha($M)),isNaN($p)||-2==$p||(this._templet.attachmentNames?$A.showDisplayByName(this._templet.attachmentNames[$p]):$A.showDisplayByIndex($p)),$r[this._drawOrder[$J]]?($T=$r[this._drawOrder[$J]],$A.currDisplayData&&$T[$A.currDisplayData.attachmentName]?$A.deformData=$T[$A.currDisplayData.attachmentName]:$A.deformData=null):$A.deformData=null,isNaN($M)?$A.draw($l,this._boneMatrixArray,2==this._aniMode):$A.draw($l,this._boneMatrixArray,2==this._aniMode,$M),isNaN($M)||$l.restore();else for($J=0,$w=this._boneSlotArray.length;$J<$w;$J++)$p=$e[($A=this._boneSlotArray[$J]).name],$M=$g[$A.name],isNaN($M)||($l.save(),$l.alpha($M)),isNaN($p)||-2==$p||(this._templet.attachmentNames?$A.showDisplayByName(this._templet.attachmentNames[$p]):$A.showDisplayByIndex($p)),$r[$J]?($T=$r[$J],$A.currDisplayData&&$T[$A.currDisplayData.attachmentName]?$A.deformData=$T[$A.currDisplayData.attachmentName]:$A.deformData=null):$A.deformData=null,isNaN($M)?$A.draw($l,this._boneMatrixArray,2==this._aniMode):$A.draw($l,this._boneMatrixArray,2==this._aniMode,$M),isNaN($M)||$l.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$d,$l):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$d,$l);},$d._setDeform=function($d,$t,$l,$k){if($d){var $W,$i,$A,$B=0,$o=0,$I=0;if($d)for($B=0,$o=$d.deformSlotDataList.length;$B<$o;$B++)for($W=$d.deformSlotDataList[$B],$I=0;$I<$W.deformSlotDisplayList.length;$I++)$A=$l[($i=$W.deformSlotDisplayList[$I]).slotIndex],$i.apply($k,$A),$t[$i.slotIndex]||($t[$i.slotIndex]={}),$t[$i.slotIndex][$i.attachment]=$i.deformData;}},$d.getAnimNum=function(){return this._templet.getAnimationCount();},$d.getAniNameByIndex=function($d){return this._templet.getAniNameByIndex($d);},$d.getSlotByName=function($d){return this._boneSlotDic[$d];},$d.showSkinByName=function($d,$t){void 0===$t&&($t=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($d),$t);},$d.showSkinByIndex=function($d,$t){void 0===$t&&($t=!0);for(var $l=0;$l<this._boneSlotArray.length;$l++)this._boneSlotArray[$l].showSlotData(null,$t);if(this._templet.showSkinByIndex(this._boneSlotDic,$d,$t)){var $k=this._templet.skinDataArray[$d];this._skinIndex=$d,this._skinName=$k.name;}this._clearCache();},$d.showSlotSkinByIndex=function($d,$t){if(0!=this._aniMode){var $l=this.getSlotByName($d);$l&&$l.showDisplayByIndex($t),this._clearCache();}},$d.showSlotSkinByName=function($d,$t){if(0!=this._aniMode){var $l=this.getSlotByName($d);$l&&$l.showDisplayByName($t),this._clearCache();}},$d.replaceSlotSkinName=function($d,$t,$l){if(0!=this._aniMode){var $k=this.getSlotByName($d);$k&&$k.replaceDisplayByName($t,$l),this._clearCache();}},$d.replaceSlotSkinByIndex=function($d,$t,$l){if(0!=this._aniMode){var $k=this.getSlotByName($d);$k&&$k.replaceDisplayByIndex($t,$l),this._clearCache();}},$d.setSlotSkin=function($d,$t){if(0!=this._aniMode){var $l=this.getSlotByName($d);$l&&$l.replaceSkin($t),this._clearCache();}},$d._clearCache=function(){if(1==this._aniMode)for(var $d=0,$t=this._graphicsCache.length;$d<$t;$d++){for(var $l=0,$k=this._graphicsCache[$d].length;$l<$k;$l++){var $W=this._graphicsCache[$d][$l];$W!=this.graphics&&$K.recycle($W);}this._graphicsCache[$d].length=0;}},$d.play=function($d,$t,$l,$k,$W,$i){void 0===$l&&($l=!0),void 0===$k&&($k=0),void 0===$W&&($W=0),void 0===$i&&($i=!0),this._indexControl=!1;var $A=-1,$B=NaN;if($B=$t?2147483647:0,"string"==typeof $d)for(var $o=0,$I=this._templet.getAnimationCount();$o<$I;$o++){var $b=this._templet.getAnimation($o);if($b&&$d==$b.name){$A=$o;break;}}else $A=$d;-1<$A&&$A<this.getAnimNum()&&(this._aniClipIndex=$A,($l||this._pause||this._currAniIndex!=$A)&&(this._currAniIndex=$A,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($A)),this._drawOrder=null,this._eventIndex=0,this._player.play($A,this._player.playbackRate,$B,$k,$W),$i&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$f.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()));},$d.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update));},$d.playbackRate=function($d){this._player&&(this._player.playbackRate=$d);},$d.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update));},$d.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$f.now(),this.timer.frameLoop(1,this,this._update,null,!0));},$d._getGrahicsDataWithCache=function($d,$t){return this._graphicsCache[$d][$t];},$d._setGrahicsDataWithCache=function($d,$t,$l){this._graphicsCache[$d][$t]=$l;},$d.destroy=function($d){void 0===$d&&($d=!0),$t.prototype.destroy.call(this,$d),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update);},$i(0,$d,"url",function(){return this._aniPath;},function($d){this.load($d);}),$i(0,$d,"index",function(){return this._index;},function($d){this.player&&(this._index=$d,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1));}),$i(0,$d,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total;}),$i(0,$d,"templet",function(){return this._templet;}),$i(0,$d,"player",function(){return this._player;}),$l.useSimpleMeshInCanvas=!1,$l;}($id),$M=function($t){function $W(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$W.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[];}$k($W,"laya.ani.bone.Templet",$t);var $d=$W.prototype;return $d.getLoadList=function(){return this._loadList;},$d.loadAni=function($d){this._skBufferUrl=$d,$Wd.loader.load($d,$o.create(this,this.onComplete),null,"arraybuffer");},$d.onComplete=function($d){if(this._isDestroyed)this.destroy();else{var $t=$I.getRes(this._skBufferUrl);$t?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$t)):this.event("error","load failed:"+this._skBufferUrl);}},$d.parseData=function($d,$t,$l){void 0===$l&&($l=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$d,this._mainTexture&&$D.isWebGL&&$d.bitmap&&($d.bitmap.enableMerageInAtlas=!1),this._rate=$l,this.parse($t);},$d.buildArmature=function($d){return void 0===$d&&($d=0),new $p(this,$d);},$d.parse=function($d){$t.prototype.parse.call(this,$d),this._endLoaded(),this._aniVersion!=$W.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$W.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0);},$d._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $d=0;this._loadList=[];var $t,$l=new $rd(this.getPublicExtData()),$k=0,$W=0,$i=0,$A=$l.getInt32(),$B=$l.readUTFString(),$o=$B.split("\n");for($d=0;$d<$A;$d++)$t=this._path+$o[2*$d],$B=$o[2*$d+1],$l.getFloat32(),$l.getFloat32(),$k=$l.getFloat32(),$W=$l.getFloat32(),$i=$l.getFloat32(),isNaN($i)?0:$i,$i=$l.getFloat32(),isNaN($i)?0:$i,$i=$l.getFloat32(),isNaN($i)?$k:$i,$i=$l.getFloat32(),isNaN($i)?$W:$i,-1==this._loadList.indexOf($t)&&this._loadList.push($t);this.event("inited",this);}},$d._textureComplete=function(){for(var $d,$t,$l=0,$k=this._loadList.length;$l<$k;$l++)$t=this._loadList[$l],$d=this._textureDic[$t]=$I.getRes($t),$D.isWebGL&&$d&&$d.bitmap&&($d.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData();},$d._parsePublicExtData=function(){var $d=0,$t=0,$l=0,$k=0,$W=0;for($d=0,$W=this.getAnimationCount();$d<$W;$d++)this._graphicsCache.push([]);var $i;$i="Dragon"!=this._aniClassName;var $A,$B,$o=new $rd(this.getPublicExtData()),$I=0,$b=0,$f=0,$J=0,$c=0,$Y=0,$w=0,$D=0,$z=0,$e=$o.getInt32(),$g=$o.readUTFString(),$H=$g.split("\n");for($d=0;$d<$e;$d++){if($A=this._mainTexture,$B=this._path+$H[2*$d],$g=$H[2*$d+1],null==this._mainTexture&&($A=this._textureDic[$B]),!$A)return this.event("error",this),void(this.isParseFail=!0);$I=$o.getFloat32(),$b=$o.getFloat32(),$f=$o.getFloat32(),$J=$o.getFloat32(),$z=$o.getFloat32(),$c=isNaN($z)?0:$z,$z=$o.getFloat32(),$Y=isNaN($z)?0:$z,$z=$o.getFloat32(),$w=isNaN($z)?$f:$z,$z=$o.getFloat32(),$D=isNaN($z)?$J:$z,this.subTextureDic[$g]=$jd.create($A,$I,$b,$f,$J,-$c,-$Y,$w,$D),$A.alphaTexture&&(this.subTextureDic[$g].alphaTexture=$jd.create($A.alphaTexture,$I,$b,$f,$J,-$c,-$Y,$w,$D));}this._mainTexture=$A;var $R,$G,$q,$L,$$,$p=$o.getUint16();for($d=0;$d<$p;$d++)($R=[]).push($o.getUint16()),$R.push($o.getUint16()),$R.push($o.getUint16()),$R.push($o.getUint16()),this.aniSectionDic[$d]=$R;var $M,$T=$o.getInt16(),$r={};for($d=0;$d<$T;$d++)$G=new $Cd(),0==$d?$M=$G:$G.root=$M,$G.d=$i?-1:1,$L=$o.readUTFString(),$$=$o.readUTFString(),$G.length=$o.getFloat32(),1==$o.getByte()&&($G.inheritRotation=!1),1==$o.getByte()&&($G.inheritScale=!1),$G.name=$L,$$&&(($q=$r[$$])?$q.addChild($G):this.mRootBone=$G),$r[$L]=$G,this.mBoneArr.push($G);this.tMatrixDataLen=$o.getUint16();var $S,$j,$C=$o.getUint16(),$K=Math.floor($C/this.tMatrixDataLen),$x=this.srcBoneMatrixArr;for($d=0;$d<$K;$d++)($S=new $sd()).scX=$o.getFloat32(),$S.skX=$o.getFloat32(),$S.skY=$o.getFloat32(),$S.scY=$o.getFloat32(),$S.x=$o.getFloat32(),$S.y=$o.getFloat32(),8===this.tMatrixDataLen&&($S.skewX=$o.getFloat32(),$S.skewY=$o.getFloat32()),$x.push($S),($G=this.mBoneArr[$d]).transform=$S;var $n,$Q=$o.getUint16(),$y=0;for($d=0;$d<$Q;$d++){for($j=new $Zd(),$y=$o.getUint16(),$t=0;$t<$y;$t++)$j.boneNames.push($o.readUTFString()),$j.boneIndexs.push($o.getInt16());$j.name=$o.readUTFString(),$j.targetBoneName=$o.readUTFString(),$j.targetBoneIndex=$o.getInt16(),$j.bendDirection=$o.getFloat32(),$j.mix=$o.getFloat32(),$j.isSpine=$i,this.ikArr.push($j);}var $V,$Z=$o.getUint16(),$U=0;for($d=0;$d<$Z;$d++){for($n=new $hd(),$U=$o.getUint16(),$t=0;$t<$U;$t++)$n.boneIndexs.push($o.getInt16());$n.name=$o.getUTFString(),$n.targetIndex=$o.getInt16(),$n.rotateMix=$o.getFloat32(),$n.translateMix=$o.getFloat32(),$n.scaleMix=$o.getFloat32(),$n.shearMix=$o.getFloat32(),$n.offsetRotation=$o.getFloat32(),$n.offsetX=$o.getFloat32(),$n.offsetY=$o.getFloat32(),$n.offsetScaleX=$o.getFloat32(),$n.offsetScaleY=$o.getFloat32(),$n.offsetShearY=$o.getFloat32(),this.tfArr.push($n);}var $E=$o.getUint16(),$N=0;for($d=0;$d<$E;$d++){for(($V=new $Ud()).name=$o.readUTFString(),$N=$o.getUint16(),$t=0;$t<$N;$t++)$V.bones.push($o.getInt16());$V.target=$o.readUTFString(),$V.positionMode=$o.readUTFString(),$V.spacingMode=$o.readUTFString(),$V.rotateMode=$o.readUTFString(),$V.offsetRotation=$o.getFloat32(),$V.position=$o.getFloat32(),$V.spacing=$o.getFloat32(),$V.rotateMix=$o.getFloat32(),$V.translateMix=$o.getFloat32(),this.pathArr.push($V);}var $u,$h,$s,$P,$X,$m=0,$O=0,$F=0,$a=NaN,$_=0,$v=$o.getInt16();for($d=0;$d<$v;$d++){var $dd=$o.getUint8(),$td={};this.deformAniArr.push($td);for(var $ld=0;$ld<$dd;$ld++)for(($u=new $xd()).skinName=$o.getUTFString(),$td[$u.skinName]=$u,$m=$o.getInt16(),$t=0;$t<$m;$t++)for($h=new $nd(),$u.deformSlotDataList.push($h),$O=$o.getInt16(),$l=0;$l<$O;$l++)for($s=new $Qd(),$h.deformSlotDisplayList.push($s),$s.slotIndex=$o.getInt16(),$s.attachment=$o.getUTFString(),$F=$o.getInt16(),$k=0;$k<$F;$k++)for(1==$o.getByte()?$s.tweenKeyList.push(!0):$s.tweenKeyList.push(!1),$a=$o.getFloat32(),$s.timeList.push($a),$P=[],$s.vectices.push($P),$_=$o.getInt16(),$W=0;$W<$_;$W++)$P.push($o.getFloat32());}var $kd,$Wd,$id=$o.getInt16(),$Ad=0,$Bd=0;for($d=0;$d<$id;$d++){for($Ad=$o.getInt16(),$X=[],$t=0;$t<$Ad;$t++){for(($kd=new $yd()).time=$o.getFloat32(),$Bd=$o.getInt16(),$l=0;$l<$Bd;$l++)$kd.drawOrder.push($o.getInt16());$X.push($kd);}this.drawOrderAniArr.push($X);}var $od,$Id=$o.getInt16(),$bd=0;for($d=0;$d<$Id;$d++){for($bd=$o.getInt16(),$Wd=[],$t=0;$t<$bd;$t++)($od=new $Vd()).name=$o.getUTFString(),$od.intValue=$o.getInt32(),$od.floatValue=$o.getFloat32(),$od.stringValue=$o.getUTFString(),$od.time=$o.getFloat32(),$Wd.push($od);this.eventAniArr.push($Wd);}var $fd=$o.getInt16();if(0<$fd)for(this.attachmentNames=[],$d=0;$d<$fd;$d++)this.attachmentNames.push($o.getUTFString());var $Jd,$cd,$Yd=$o.getInt16();for($d=0;$d<$Yd;$d++)($Jd=new $Kd()).name=$o.readUTFString(),$Jd.parent=$o.readUTFString(),$Jd.attachmentName=$o.readUTFString(),$Jd.srcDisplayIndex=$Jd.displayIndex=$o.getInt16(),($Jd.templet=this).boneSlotDic[$Jd.name]=$Jd,null==($cd=this.bindBoneBoneSlotDic[$Jd.parent])&&(this.bindBoneBoneSlotDic[$Jd.parent]=$cd=[]),$cd.push($Jd),this.boneSlotArray.push($Jd);var $wd,$Dd,$zd,$ed=$o.readUTFString().split("\n"),$gd=0,$Hd=$o.getUint8(),$Rd=0,$Gd=0,$qd=0,$Ld=0,$$d=0,$pd=0,$Md=0;for($d=0;$d<$Hd;$d++){for(($wd=new $Ed()).name=$ed[$gd++],$Rd=$o.getUint8(),$t=0;$t<$Rd;$t++){for(($Dd=new $ud()).name=$ed[$gd++],$Jd=this.boneSlotDic[$Dd.name],$Gd=$o.getUint8(),$l=0;$l<$Gd;$l++){if($zd=new $Nd(),this.skinSlotDisplayDataArr.push($zd),$zd.name=$ed[$gd++],$zd.attachmentName=$ed[$gd++],$zd.transform=new $sd(),$zd.transform.scX=$o.getFloat32(),$zd.transform.skX=$o.getFloat32(),$zd.transform.skY=$o.getFloat32(),$zd.transform.scY=$o.getFloat32(),$zd.transform.x=$o.getFloat32(),$zd.transform.y=$o.getFloat32(),$Dd.displayArr.push($zd),$zd.width=$o.getFloat32(),$zd.height=$o.getFloat32(),$zd.type=$o.getUint8(),$zd.verLen=$o.getUint16(),0<($T=$o.getUint16()))for($zd.bones=[],$k=0;$k<$T;$k++){var $Td=$o.getUint16();$zd.bones.push($Td);}if(0<($qd=$o.getUint16()))for($zd.uvs=[],$k=0;$k<$qd;$k++)$zd.uvs.push($o.getFloat32());if(0<($Ld=$o.getUint16()))for($zd.weights=[],$k=0;$k<$Ld;$k++)$zd.weights.push($o.getFloat32());if(0<($$d=$o.getUint16()))for($zd.triangles=[],$k=0;$k<$$d;$k++)$zd.triangles.push($o.getUint16());if(0<($pd=$o.getUint16()))for($zd.vertices=[],$k=0;$k<$pd;$k++)$zd.vertices.push($o.getFloat32());if(0<($Md=$o.getUint16()))for($zd.lengths=[],$k=0;$k<$Md;$k++)$zd.lengths.push($o.getFloat32());}$wd.slotArr.push($Dd);}this.skinDic[$wd.name]=$wd,this.skinDataArray.push($wd);}1==$o.getUint8()?(this.yReverseMatrix=new $Sd(1,0,0,-1,0,0),$M&&$M.setTempMatrix(this.yReverseMatrix)):$M&&$M.setTempMatrix(new $Sd()),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this);},$d.getTexture=function($d){var $t=this.subTextureDic[$d];return $t||($t=this.subTextureDic[$d.substr(0,$d.length-1)]),null==$t?this._mainTexture:$t;},$d.showSkinByIndex=function($d,$t,$l){if(void 0===$l&&($l=!0),$t<0&&$t>=this.skinDataArray.length)return!1;var $k,$W,$i=0,$A=0,$B=this.skinDataArray[$t];if($B){for($i=0,$A=$B.slotArr.length;$i<$A;$i++)($W=$B.slotArr[$i])&&($k=$d[$W.name])&&($k.showSlotData($W,$l),$l&&"undefined"!=$k.attachmentName&&"null"!=$k.attachmentName?$k.showDisplayByName($k.attachmentName):$k.showDisplayByIndex($k.displayIndex));return!0;}return!1;},$d.getSkinIndexByName=function($d){for(var $t=0,$l=this.skinDataArray.length;$t<$l;$t++)if(this.skinDataArray[$t].name==$d)return $t;return-1;},$d.getGrahicsDataWithCache=function($d,$t){return this._graphicsCache[$d][$t];},$d.setGrahicsDataWithCache=function($d,$t,$l){this._graphicsCache[$d][$t]=$l;},$d.destroy=function(){var $d;for(var $t in this._isDestroyed=!0,this.subTextureDic)($d=this.subTextureDic[$t])&&$d.destroy();for($t in this._textureDic)($d=this._textureDic[$t])&&$d.destroy();for(var $l=0,$k=this.skinSlotDisplayDataArr.length;$l<$k;$l++)this.skinSlotDisplayDataArr[$l].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $W.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this);},$d.getAniNameByIndex=function($d){var $t=this.getAnimation($d);return $t?$t.name:null;},$i(0,$d,"rate",function(){return this._rate;},function($d){this._rate=$d;}),$W.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$W.TEMPLET_DICTIONARY=null,$W;}($x);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($d,$t){"use strict";for(var $l in Object.defineProperty($t,"__esModule",{value:!0}),Laya){var $k=Laya[$l];$k&&$k.__isclass&&($t[$l]=$k);}});