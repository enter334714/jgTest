var Laya=window.Laya=function(x$L,x$b){var x$f={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(x$b,x$_){return 1==arguments.length?x$f.__presubstr.call(this,x$b):x$f.__presubstr.call(this,x$b,0<x$_?x$_:this.length+x$_)},__init:function(x$b){x$b.forEach(function(x$b){x$b.__init$&&x$b.__init$()})},__isClass:function(x$b){return x$b&&(x$b.__isclass||x$b==Object||x$b==String||x$b==Array)},__newvec:function(x$b,x$_){var x$s=[];x$s.length=x$b;for(var x$h=0;x$h<x$b;x$h++)x$s[x$h]=x$_;return x$s},__extend:function(x$b,x$_){for(var x$s in x$_)if(x$_.hasOwnProperty(x$s)){var x$h=Object.getOwnPropertyDescriptor(x$_,x$s),x$x=x$h.get,x$n=x$h.set;x$x||x$n?x$x&&x$n?Object.defineProperty(x$b,x$s,x$h):(x$x&&Object.defineProperty(x$b,x$s,x$x),x$n&&Object.defineProperty(x$b,x$s,x$n)):x$b[x$s]=x$_[x$s]}function x$E(){x$f.un(this,"constructor",x$b)}x$E.prototype=x$_.prototype,x$b.prototype=new x$E,x$f.un(x$b.prototype,"__imps",x$f.__copy({},x$_.prototype.__imps))},__copy:function(x$b,x$_){if(!x$_)return null;for(var x$s in x$b=x$b||{},x$_)x$b[x$s]=x$_[x$s];return x$b},__package:function(x$b,x$_){if(!x$f.__packages[x$b]){x$f.__packages[x$b]=!0;var x$s=x$L,x$h=x$b.split(".");if(1<x$h.length)for(var x$x=0,x$n=x$h.length-1;x$x<x$n;x$x++){var x$E=x$s[x$h[x$x]];x$s=x$E||(x$s[x$h[x$x]]={})}x$s[x$h[x$h.length-1]]||(x$s[x$h[x$h.length-1]]=x$_||{})}},__hasOwnProperty:function(x$b,x$_){return x$_=x$_||this,Object.hasOwnProperty.call(x$_,x$b)||function x$b(x$_,x$s){if(Object.hasOwnProperty.call(x$s.prototype,x$_))return!0;var x$h=x$s.prototype.__super;return null==x$h?null:x$b(x$_,x$h)}(x$b,x$_.__class)},__typeof:function(x$b,x$_){if(!x$b||!x$_)return!1;if(x$_===String)return"string"==typeof x$b;if(x$_===Number)return"number"==typeof x$b;if(x$_.__interface__)x$_=x$_.__interface__;else if("string"!=typeof x$_)return x$b instanceof x$_;return x$b.__imps&&x$b.__imps[x$_]||x$b.__class==x$_},__as:function(x$b,x$_){return this.__typeof(x$b,x$_)?x$b:null},__int:function(x$b){return x$b?parseInt(x$b):0},interface:function(x$b,x$_){x$f.__package(x$b,{});var x$s=x$f.__internals,x$h=x$s[x$b]=x$s[x$b]||{self:x$b};if(x$_){var x$x=x$_.split(",");x$h.extend=[];for(var x$n=0;x$n<x$x.length;x$n++){var x$E=x$x[x$n];x$s[x$E]=x$s[x$E]||{self:x$E},x$h.extend.push(x$s[x$E])}}var x$C=x$L,x$O=x$b.split(".");for(x$n=0;x$n<x$O.length-1;x$n++)x$C=x$C[x$O[x$n]];x$C[x$O[x$O.length-1]]={__interface__:x$b}},class:function(x$b,x$_,x$s,x$h){if(x$s&&x$f.__extend(x$b,x$s),x$_)if(x$f.__package(x$_,x$b),x$f.__classmap[x$_]=x$b,0<x$_.indexOf(".")){if(0==x$_.indexOf("laya.")){var x$x=x$_.split(".");x$h=x$h||x$x[x$x.length-1],x$f[x$h]&&console.log("Warning!,this class["+x$h+"] already exist:",x$f[x$h]),x$f[x$h]=x$b}}else"Main"==x$_?x$L.Main=x$b:"MainWX"==x$_?x$L.MainWX=x$b:(x$f[x$_]&&console.log("Error!,this class["+x$_+"] already exist:",x$f[x$_]),x$f[x$_]=x$b);var x$n=x$f.un,x$E=x$b.prototype;x$n(x$E,"hasOwnProperty",x$f.__hasOwnProperty),x$n(x$E,"__class",x$b),x$n(x$E,"__super",x$s),x$n(x$E,"__className",x$_),x$n(x$b,"__super",x$s),x$n(x$b,"__className",x$_),x$n(x$b,"__isclass",!0),x$n(x$b,"super",function(x$b){this.__super.call(x$b)})},imps:function(x$b,x$_){if(!x$_)return null;var x$x=x$b.__imps||x$f.un(x$b,"__imps",{});function x$n(x$b){var x$_,x$s;if((x$_=x$f.__internals[x$b])&&(x$x[x$b]=!0,x$s=x$_.extend))for(var x$h=0;x$h<x$s.length;x$h++)x$n(x$s[x$h].self)}for(var x$s in x$_)x$n(x$s)},superSet:function(x$b,x$_,x$s,x$h){var x$x=x$b.prototype["_$set_"+x$s];x$x&&x$x.call(x$_,x$h)},superGet:function(x$b,x$_,x$s){var x$h=x$b.prototype["_$get_"+x$s];return x$h?x$h.call(x$_):null},getset:function(x$b,x$_,x$s,x$h,x$x){x$b?(x$h&&(x$_["_$GET_"+x$s]=x$h),x$x&&(x$_["_$SET_"+x$s]=x$x)):(x$h&&x$f.un(x$_,"_$get_"+x$s,x$h),x$x&&x$f.un(x$_,"_$set_"+x$s,x$x)),x$h&&x$x?Object.defineProperty(x$_,x$s,{get:x$h,set:x$x,enumerable:!1,configurable:!0}):(x$h&&Object.defineProperty(x$_,x$s,{get:x$h,enumerable:!1,configurable:!0}),x$x&&Object.defineProperty(x$_,x$s,{set:x$x,enumerable:!1,configurable:!0}))},static:function(x$s,x$h){for(var x$x=0,x$b=x$h.length;x$x<x$b;x$x+=2)if("length"==x$h[x$x])x$s.length=x$h[x$x+1].call(x$s);else{function x$_(){var x$_=x$h[x$x],x$b=x$h[x$x+1];Object.defineProperty(x$s,x$_,{get:function(){return delete this[x$_],this[x$_]=x$b.call(this)},set:function(x$b){delete this[x$_],this[x$_]=x$b},enumerable:!0,configurable:!0})}x$_()}},un:function(x$b,x$_,x$s){return x$s||(x$s=x$b[x$_]),x$f.__propun.value=x$s,Object.defineProperty(x$b,x$_,x$f.__propun),x$s},uns:function(x$_,x$b){x$b.forEach(function(x$b){x$f.un(x$_,x$b)})}};return x$L.console=x$L.console||{log:function(){}},x$L.trace=x$L.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),x$f}(window,document);!function(x$b,x$_,x$s){x$s.un,x$s.uns,x$s.static,x$s.class,x$s.getset,x$s.__newvec}(window,document,Laya),function(x$E,x$_,x$o){x$o.un,x$o.uns;var x$O=x$o.static,x$f=x$o.class,x$Q=x$o.getset;x$o.__newvec;x$o.interface("laya.runtime.IMarket"),x$o.interface("laya.filters.IFilter"),x$o.interface("laya.display.ILayout"),x$o.interface("laya.resource.IDispose"),x$o.interface("laya.runtime.IPlatform"),x$o.interface("laya.resource.IDestroy"),x$o.interface("laya.runtime.IConchNode"),x$o.interface("laya.filters.IFilterAction"),x$o.interface("laya.runtime.ICPlatformClass"),x$o.interface("laya.resource.ICreateResource"),x$o.interface("laya.runtime.IConchRenderObject"),x$o.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var x$Z=function(){function x$n(){}return x$f(x$n,"laya.utils.RunDriver"),x$n.FILTER_ACTIONS=[],x$n.pixelRatio=-1,x$n._charSizeTestDiv=null,x$n.now=function(){return Date.now()},x$n.getWindow=function(){return x$E},x$n.getPixelRatio=function(){if(x$n.pixelRatio<0){var x$b=x$K.context,x$_=x$b.backingStorePixelRatio||x$b.webkitBackingStorePixelRatio||x$b.mozBackingStorePixelRatio||x$b.msBackingStorePixelRatio||x$b.oBackingStorePixelRatio||x$b.backingStorePixelRatio||1;(x$n.pixelRatio=(x$K.window.devicePixelRatio||1)/x$_)<1&&(x$n.pixelRatio=1)}return x$n.pixelRatio},x$n.getIncludeStr=function(x$b){return null},x$n.createShaderCondition=function(x$b){var x$_="(function() {return "+x$b+";})";return x$o._runScript(x$_)},x$n.fontMap=[],x$n.measureText=function(x$b,x$_){var x$s=x$n.hanzi.test(x$b);if(x$s&&x$n.fontMap[x$_])return x$n.fontMap[x$_];var x$h=x$K.context;x$h.font=x$_;var x$x=x$h.measureText(x$b);return x$s&&(x$n.fontMap[x$_]=x$x),x$x},x$n.getWebGLContext=function(x$b){},x$n.beginFlush=function(){},x$n.endFinish=function(){},x$n.addToAtlas=null,x$n.flashFlushImage=function(x$b){},x$n.drawToCanvas=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$tb.create("2D"),x$C=new x$U(x$s,x$h,x$E);return x$G.renders[x$_]._fun(x$b,x$C,x$x,x$n),x$E},x$n.createParticleTemplate2D=null,x$n.createGLTextur=null,x$n.createWebGLContext2D=null,x$n.changeWebGLSize=function(x$b,x$_){},x$n.createRenderSprite=function(x$b,x$_){return new x$G(x$b,x$_)},x$n.createFilterAction=function(x$b){return new x$t},x$n.createGraphics=function(){return new x$P},x$n.clear=function(x$b){x$q._context.ctx.clear()},x$n.cancelLoadByUrl=function(x$b){},x$n.clearAtlas=function(x$b){},x$n.isAtlas=function(x$b){return!1},x$n.addTextureToAtlas=function(x$b){},x$n.getTexturePixels=function(x$b,x$_,x$s,x$h,x$x){return null},x$n.skinAniSprite=function(){return null},x$n.update3DLoop=function(){},x$O(x$n,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),x$n}(),x$h=(x$Q(1,x$o,"alertGlobalError",null,function(x$b){var x$n=0;x$K.window.onerror=x$b?function(x$b,x$_,x$s,x$h,x$x){x$n++<5&&x$x&&alert(x$x.stack||x$x)}:null}),x$o.init=function(x$b,x$_,x$s){for(var x$h=[],x$x=2,x$n=arguments.length;x$x<x$n;x$x++)x$h.push(arguments[x$x]);if(!x$o._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=x$o._arrayBufferSlice),x$o._isinit=!0,x$K.__init__(),x$z.__init__(),x$P.__init__(),x$o.timer=new x$Y,x$o.scaleTimer=new x$Y,x$o.loader=new x$Ob,x$H.__init__(),x$x=0;for(var x$E=x$h.length;x$x<x$E;x$x++)x$h[x$x].enable&&x$h[x$x].enable();return x$V.__init__(),x$C.__init__(),x$a.__init__(),x$I.beginCheck(),x$o._currentStage=x$o.stage=new x$ib,x$o.stage.conchModel&&x$o.stage.conchModel.setRootNode(),x$o._getUrlPath(),x$o.render=new x$q(0,0),x$o.stage.size(x$b,x$_),x$G.__init__(),x$p.__init__(),x$y.instance.__init__(x$o.stage,x$q.canvas),x$$b.__init__(),x$S.autoStopMusic=!0,x$k.__init__(),x$q.canvas}},x$o._getUrlPath=function(){var x$b=x$K.window.location,x$_=x$b.pathname;x$_=x$_&&":"==x$_.charAt(2)?x$_.substring(1):x$_,x$T.rootPath=x$T.basePath=x$T.getPath("file:"==x$b.protocol?x$_:x$b.protocol+"//"+x$b.host+x$b.pathname)},x$o._arrayBufferSlice=function(x$b,x$_){var x$s=new Uint8Array(this,x$b,x$_-x$b),x$h=new Uint8Array(x$s.length);return x$h.set(x$s),x$h.buffer},x$o._runScript=function(x$b){return x$K.window[x$o._evcode](x$b)},x$o.stage=null,x$o.timer=null,x$o.scaleTimer=null,x$o.loader=null,x$o.version="1.8.6",x$o.render=null,x$o._currentStage=null,x$o._isinit=!1,x$o.isDebug=!1,x$o.MiniAdpter={init:function(){x$E.navigator&&x$E.navigator.userAgent&&-1<x$E.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},x$O(x$o,["conchMarket",function(){return this.conchMarket=x$E.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=x$E.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function x$b(){}return x$f(x$b,"Config"),x$b.WebGLTextCacheCount=500,x$b.atlasEnable=!1,x$b.showCanvasMark=!1,x$b.animationInterval=50,x$b.isAntialias=!1,x$b.isAlpha=!1,x$b.premultipliedAlpha=!0,x$b.isStencil=!0,x$b.preserveDrawingBuffer=!1,x$b}()),x$L=function(){function x$L(){this._events=null}x$f(x$L,"laya.events.EventDispatcher");var x$b=x$L.prototype;return x$b.hasListener=function(x$b){return!!(this._events&&this._events[x$b])},x$b.event=function(x$b,x$_){if(!this._events||!this._events[x$b])return!1;var x$s=this._events[x$b];if(x$s.lock)x$s.queue||(x$s.queue=[]),x$s.queue.push(x$_);else{var x$h;for(x$s.lock=!0,x$s.cursor=x$s.head;x$s.cursor;)x$h=x$s.cursor,x$s.cursor=x$h.next,x$h.once&&x$L.delNode(x$s,x$h),null!=x$_?x$h.args?x$h.method.apply(x$h.caller,x$h.args.concat(x$_)):x$_ instanceof Array?x$h.method.apply(x$h.caller,x$_):x$h.method.call(x$h.caller,x$_):x$h.method.apply(x$h.caller,x$h.args),x$h.once&&x$L.recoverHandler(x$h);x$s.lock=!1,!x$s.head&&this._events&&this._events[x$b]==x$s&&delete this._events[x$b],x$s.queue&&x$s.queue.length&&this.event(x$b,x$s.queue.shift())}return!0},x$b.on=function(x$b,x$_,x$s,x$h){return this._createListener(x$b,x$_,x$s,x$h,!1)},x$b.once=function(x$b,x$_,x$s,x$h){return this._createListener(x$b,x$_,x$s,x$h,!0)},x$b._createListener=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=!0),x$n&&this.off(x$b,x$_,x$s,x$x);var x$E=x$L.createHandler(x$_||this,x$s,x$h,x$x);this._events||(this._events={});var x$C=this._events,x$O=x$C[x$b];return x$O?x$O.tail?(x$E.prev=x$O.tail,x$O.tail.next=x$E,x$O.tail=x$E):x$O.head=x$O.tail=x$E:x$C[x$b]={head:x$E,tail:x$E,cursor:null,lock:!1},this},x$b.off=function(x$b,x$_,x$s,x$h){if(void 0===x$h&&(x$h=!1),!this._events||!this._events[x$b])return this;for(var x$x=this._events[x$b],x$n=x$x.head;x$n;){if((!x$_||x$n.caller===x$_)&&x$n.method===x$s&&(!x$h||x$n.once)){x$L.delNode(x$x,x$n),x$x.cursor==x$n&&(x$x.cursor=x$n.next),x$L.recoverHandler(x$n);break}x$n=x$n.next}return this},x$b.offAll=function(x$b){var x$_=this._events;if(!x$_)return this;if(x$b)this._recoverHandlers(x$_[x$b]),delete x$_[x$b];else{for(var x$s in x$_)this._recoverHandlers(x$_[x$s]);this._events=null}return this},x$b._recoverHandlers=function(x$b){if(x$b){for(var x$_=x$b.head;x$_;){x$L.delNode(x$b,x$_);var x$s=x$_.next;x$L.recoverHandler(x$_),x$_=x$s}x$b.cursor=null}},x$b.isMouseEvent=function(x$b){return x$L.MOUSE_EVENTS[x$b]},x$L.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},x$L.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},x$L.delNode=function(x$b,x$_){x$_.prev?x$_.prev.next=x$_.next:x$b.head=x$_.next,x$_.next?x$_.next.prev=x$_.prev:x$b.tail=x$_.prev},x$L.createHandler=function(x$b,x$_,x$s,x$h){var x$x=x$L._freeHandler;return x$x?(x$L._freeCount--,x$L._freeHandler=x$x.next,x$x.caller=x$b,x$x.method=x$_,x$x.args=x$s,x$x.once=x$h):x$x={caller:x$b,method:x$_,args:x$s,once:x$h},x$x.prev=x$x.next=null,x$x},x$L.recoverHandler=function(x$b){x$b.caller=x$b.method=x$b.args=x$b.prev=null,x$b.next=x$L._freeHandler,x$L._freeHandler=x$b,x$L._freeCount++},x$L._freeHandler=null,x$L._freeCount=0,x$L}(),x$R=function(){function x$x(x$b,x$_,x$s,x$h){this.once=!1,void(this._id=0)===x$h&&(x$h=!1),this.setTo(x$b,x$_,x$s,x$h)}x$f(x$x,"laya.utils.Handler");var x$b=x$x.prototype;return x$b.setTo=function(x$b,x$_,x$s,x$h){return this._id=x$x._gid++,this.caller=x$b,this.method=x$_,this.args=x$s,this.once=x$h,this},x$b.run=function(){if(null==this.method)return null;var x$b=this._id,x$_=this.method.apply(this.caller,this.args);return this._id===x$b&&this.once&&this.recover(),x$_},x$b.runWith=function(x$b){if(null==this.method)return null;var x$_=this._id;if(null==x$b)var x$s=this.method.apply(this.caller,this.args);else x$s=this.args||x$b.unshift?this.args?this.method.apply(this.caller,this.args.concat(x$b)):this.method.apply(this.caller,x$b):this.method.call(this.caller,x$b);return this._id===x$_&&this.once&&this.recover(),x$s},x$b.clear=function(){return this.caller=null,this.method=null,this.args=null,this},x$b.recover=function(){0<this._id&&(this._id=0,this.clear())},x$x.create=function(x$b,x$_,x$s,x$h){return void 0===x$h&&(x$h=!0),new x$x(x$b,x$_,x$s,x$h)},x$x._gid=1,x$x}(),x$B=function(){function x$b(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}x$f(x$b,"laya.display.BitmapFont");var x$_=x$b.prototype;return x$_.loadFont=function(x$b,x$_){this._path=x$b,this._complete=x$_,x$o.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],x$R.create(this,this.onLoaded))},x$_.onLoaded=function(){this.parseFont(x$Cb.getRes(this._path),x$Cb.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},x$_.parseFont=function(x$b,x$_){if(null!=x$b&&null!=x$_){this._texture=x$_;var x$s=x$b.getElementsByTagName("info");if(!x$s[0].getAttributeNode)return this.parseFont2(x$b,x$_);this.fontSize=parseInt(x$s[0].getAttributeNode("size").nodeValue);var x$h,x$x=x$s[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(x$x[0]),parseInt(x$x[1]),parseInt(x$x[2]),parseInt(x$x[3])],x$h=x$b.getElementsByTagName("char");var x$n=0;for(x$n=0;x$n<x$h.length;x$n++){var x$E=x$h[x$n],x$C=parseInt(x$E.getAttributeNode("id").nodeValue),x$O=parseInt(x$E.getAttributeNode("xoffset").nodeValue)/1,x$L=parseInt(x$E.getAttributeNode("yoffset").nodeValue)/1,x$f=parseInt(x$E.getAttributeNode("xadvance").nodeValue)/1,x$p=new x$r;x$p.x=parseInt(x$E.getAttributeNode("x").nodeValue),x$p.y=parseInt(x$E.getAttributeNode("y").nodeValue),x$p.width=parseInt(x$E.getAttributeNode("width").nodeValue),x$p.height=parseInt(x$E.getAttributeNode("height").nodeValue);var x$P=x$fb.create(x$_,x$p.x,x$p.y,x$p.width,x$p.height,x$O,x$L);this._maxWidth=Math.max(this._maxWidth,x$f+this.letterSpacing),this._fontCharDic[x$C]=x$P,this._fontWidthMap[x$C]=x$f}}},x$_.parseFont2=function(x$b,x$_){if(null!=x$b&&null!=x$_){this._texture=x$_;var x$s=x$b.getElementsByTagName("info");this.fontSize=parseInt(x$s[0].attributes.size.nodeValue);var x$h=x$s[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(x$h[0]),parseInt(x$h[1]),parseInt(x$h[2]),parseInt(x$h[3])];var x$x=x$b.getElementsByTagName("char"),x$n=0;for(x$n=0;x$n<x$x.length;x$n++){var x$E=x$x[x$n].attributes,x$C=parseInt(x$E.id.nodeValue),x$O=parseInt(x$E.xoffset.nodeValue)/1,x$L=parseInt(x$E.yoffset.nodeValue)/1,x$f=parseInt(x$E.xadvance.nodeValue)/1,x$p=new x$r;x$p.x=parseInt(x$E.x.nodeValue),x$p.y=parseInt(x$E.y.nodeValue),x$p.width=parseInt(x$E.width.nodeValue),x$p.height=parseInt(x$E.height.nodeValue);var x$P=x$fb.create(x$_,x$p.x,x$p.y,x$p.width,x$p.height,x$O,x$L);this._maxWidth=Math.max(this._maxWidth,x$f+this.letterSpacing),this._fontCharDic[x$C]=x$P,this._fontWidthMap[x$C]=x$f}}},x$_.getCharTexture=function(x$b){return this._fontCharDic[x$b.charCodeAt(0)]},x$_.destroy=function(){if(this._texture){for(var x$b in this._fontCharDic){var x$_=this._fontCharDic[x$b];x$_&&x$_.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},x$_.setSpaceWidth=function(x$b){this._spaceWidth=x$b},x$_.getCharWidth=function(x$b){var x$_=x$b.charCodeAt(0);return this._fontWidthMap[x$_]?this._fontWidthMap[x$_]+this.letterSpacing:" "==x$b?this._spaceWidth+this.letterSpacing:0},x$_.getTextWidth=function(x$b){for(var x$_=0,x$s=0,x$h=x$b.length;x$s<x$h;x$s++)x$_+=this.getCharWidth(x$b.charAt(x$s));return x$_},x$_.getMaxWidth=function(){return this._maxWidth},x$_.getMaxHeight=function(){return this.fontSize},x$_.drawText=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C=this.getTextWidth(x$b),x$O=0;"center"===x$x&&(x$O=(x$n-x$C)/2),"right"===x$x&&(x$O=x$n-x$C);for(var x$L=0,x$f=0,x$p=x$b.length;x$f<x$p;x$f++)(x$E=this.getCharTexture(x$b.charAt(x$f)))&&(x$_.graphics.drawTexture(x$E,x$s+x$L+x$O,x$h),x$L+=this.getCharWidth(x$b.charAt(x$f)))},x$b}(),x$C=function(){function x$s(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=x$s._TF_EMPTY}x$f(x$s,"laya.display.css.Style");var x$b=x$s.prototype;return x$b.getTransform=function(){return this._tf},x$b.setTransform=function(x$b){this._tf="none"!==x$b&&x$b?x$b:x$s._TF_EMPTY},x$b.setTranslateX=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.translateX=x$b},x$b.setTranslateY=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.translateY=x$b},x$b.setScaleX=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.scaleX=x$b},x$b.setScale=function(x$b,x$_){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.scaleX=x$b,this._tf.scaleY=x$_},x$b.setScaleY=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.scaleY=x$b},x$b.setRotate=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.rotate=x$b},x$b.setSkewX=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.skewX=x$b},x$b.setSkewY=function(x$b){this._tf===x$s._TF_EMPTY&&(this._tf=new x$x),this._tf.skewY=x$b},x$b.destroy=function(){this.scrollRect=null},x$b.render=function(x$b,x$_,x$s,x$h){},x$b.getCSSStyle=function(){return x$_b.EMPTY},x$b._enableLayout=function(){return!1},x$Q(0,x$b,"scaleX",function(){return this._tf.scaleX},function(x$b){this.setScaleX(x$b)}),x$Q(0,x$b,"transform",function(){return this.getTransform()},function(x$b){this.setTransform(x$b)}),x$Q(0,x$b,"translateX",function(){return this._tf.translateX},function(x$b){this.setTranslateX(x$b)}),x$Q(0,x$b,"translateY",function(){return this._tf.translateY},function(x$b){this.setTranslateY(x$b)}),x$Q(0,x$b,"scaleY",function(){return this._tf.scaleY},function(x$b){this.setScaleY(x$b)}),x$Q(0,x$b,"block",function(){return 0!=(1&this._type)}),x$Q(0,x$b,"skewY",function(){return this._tf.skewY},function(x$b){this.setSkewY(x$b)}),x$Q(0,x$b,"rotate",function(){return this._tf.rotate},function(x$b){this.setRotate(x$b)}),x$Q(0,x$b,"skewX",function(){return this._tf.skewX},function(x$b){this.setSkewX(x$b)}),x$Q(0,x$b,"paddingLeft",function(){return 0}),x$Q(0,x$b,"paddingTop",function(){return 0}),x$Q(0,x$b,"absolute",function(){return!0}),x$s.__init__=function(){x$s._TF_EMPTY=new x$x,x$s.EMPTY=new x$s},x$s.EMPTY=null,x$s._TF_EMPTY=null,x$s}(),x$V=function(){function x$_(x$b){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=x$F.create(x$_.defaultColor),this.family=x$_.defaultFamily,this.stroke=x$_._STROKE,this.size=x$_.defaultSize,x$b&&x$b!==x$_.EMPTY&&x$b.copyTo(this)}x$f(x$_,"laya.display.css.Font");var x$b=x$_.prototype;return x$b.set=function(x$b){this._text=null;for(var x$_=x$b.split(" "),x$s=0,x$h=x$_.length;x$s<x$h;x$s++){var x$x=x$_[x$s];switch(x$x){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<x$x.indexOf("px")&&(this.size=parseInt(x$x),this.family=x$_[x$s+1],x$s++)}},x$b.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},x$b.copyTo=function(x$b){x$b._type=this._type,x$b._text=this._text,x$b._weight=this._weight,x$b._color=this._color,x$b.family=this.family,x$b.stroke=this.stroke!=x$_._STROKE?this.stroke.slice():x$_._STROKE,x$b.indent=this.indent,x$b.size=this.size},x$Q(0,x$b,"password",function(){return 0!=(1024&this._type)},function(x$b){x$b?this._type|=1024:this._type&=-1025}),x$Q(0,x$b,"color",function(){return this._color.strColor},function(x$b){this._color=x$F.create(x$b)}),x$Q(0,x$b,"italic",function(){return 0!=(512&this._type)},function(x$b){x$b?this._type|=512:this._type&=-513}),x$Q(0,x$b,"bold",function(){return 0!=(2048&this._type)},function(x$b){x$b?this._type|=2048:this._type&=-2049}),x$Q(0,x$b,"weight",function(){return""+this._weight},function(x$b){var x$_=0;switch(x$b){case"normal":break;case"bold":this.bold=!0,x$_=700;break;case"bolder":x$_=800;break;case"lighter":x$_=100;break;default:x$_=parseInt(x$b)}this._weight=x$_,this._text=null}),x$Q(0,x$b,"decoration",function(){return this._decoration?this._decoration.value:null},function(x$b){var x$_=x$b.split(" ");switch(this._decoration||(this._decoration={}),x$_[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=x$_[0]}x$_[1]&&(this._decoration.color=x$F.create(x$_)),this._decoration.value=x$b}),x$_.__init__=function(){x$_.EMPTY=new x$_(null)},x$_.EMPTY=null,x$_.defaultColor="#000000",x$_.defaultSize=12,x$_.defaultFamily="Arial",x$_.defaultFont="12px Arial",x$_._STROKE=[0,"#000000"],x$_._ITALIC=512,x$_._PASSWORD=1024,x$_._BOLD=2048,x$_}(),x$x=function(){function x$b(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return x$f(x$b,"laya.display.css.TransformInfo"),x$b}(),x$P=function(){function x$p(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,x$q.isConchNode){this._nativeObj=new x$E._conchGraphics,this.id=this._nativeObj.conchID}}x$f(x$p,"laya.display.Graphics");var x$b=x$p.prototype;return x$b.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},x$b.clear=function(x$b){void 0===x$b&&(x$b=!1);var x$_=0,x$s=0;if(x$b){var x$h=this._one;if(this._cmds){for(x$s=this._cmds.length,x$_=0;x$_<x$s;x$_++)!(x$h=this._cmds[x$_])||x$h.callee!==x$q._context._drawTexture&&x$h.callee!==x$q._context._drawTextureWithTransform||(x$h[0]=null,x$p._cache.push(x$h));this._cmds.length=0}else x$h&&(!x$h||x$h.callee!==x$q._context._drawTexture&&x$h.callee!==x$q._context._drawTextureWithTransform||(x$h[0]=null,x$p._cache.push(x$h)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(x$_=0,x$s=this._vectorgraphArray.length;x$_<x$s;x$_++)x$v.getInstance().deleteShape(this._vectorgraphArray[x$_]);this._vectorgraphArray.length=0}},x$b._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},x$b._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new x$s,this._graphicBounds._graphics=this)},x$b._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},x$b._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},x$b.getBounds=function(x$b){return void 0===x$b&&(x$b=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(x$b)},x$b.getBoundPoints=function(x$b){return void 0===x$b&&(x$b=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(x$b)},x$b._addCmd=function(x$b){this._cmds=this._cmds||[],x$b.callee=x$b.shift(),this._cmds.push(x$b)},x$b.setFilters=function(x$b){this._saveToCmd(x$q._context._setFilters,x$b)},x$b.drawTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$E&&(x$E=1),!x$b||x$E<.01)return null;x$h||(x$h=x$b.sourceWidth),x$x||(x$x=x$b.sourceHeight),x$E=x$E<0?0:1<x$E?1:x$E;var x$C,x$O=!x$q.isWebGL&&(x$K.onFirefox||x$K.onEdge||x$K.onIE||x$K.onSafari)?.5:0,x$L=x$h/x$b.sourceWidth,x$f=x$x/x$b.sourceHeight;return x$h=x$b.width*x$L,x$x=x$b.height*x$f,x$b.loaded&&(x$h<=0||x$x<=0)?null:(x$_+=x$b.offsetX*x$L,x$s+=x$b.offsetY*x$f,this._sp&&(this._sp._renderType|=512),x$_-=x$O,x$s-=x$O,x$h+=2*x$O,x$x+=2*x$O,x$p._cache.length?((x$C=x$p._cache.pop())[0]=x$b,x$C[1]=x$_,x$C[2]=x$s,x$C[3]=x$h,x$C[4]=x$x,x$C[5]=x$n,x$C[6]=x$E):x$C=[x$b,x$_,x$s,x$h,x$x,x$n,x$E],x$C.callee=x$n||1!=x$E?x$q._context._drawTextureWithTransform:x$q._context._drawTexture,null!=this._one||x$n||1!=x$E?this._saveToCmd(x$C.callee,x$C):(this._one=x$C,this._render=this._renderOneImg),x$b.loaded||x$b.once("loaded",this,this._textureLoaded,[x$b,x$C]),this._repaint(),x$C)},x$b.cleanByTexture=function(x$b,x$_,x$s,x$h,x$x){if(void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),!x$b)return this.clear();if(this._one&&this._render===this._renderOneImg){x$h||(x$h=x$b.sourceWidth),x$x||(x$x=x$b.sourceHeight);var x$n=x$h/x$b.sourceWidth,x$E=x$x/x$b.sourceHeight;x$h=x$b.width*x$n,x$x=x$b.height*x$E,x$_+=x$b.offsetX*x$n,x$s+=x$b.offsetY*x$E,this._one[0]=x$b,this._one[1]=x$_,this._one[2]=x$s,this._one[3]=x$h,this._one[4]=x$x,this._repaint()}else this.clear(),x$b&&this.drawTexture(x$b,x$_,x$s,x$h,x$x)},x$b.drawTextures=function(x$b,x$_){x$b&&this._saveToCmd(x$q._context._drawTextures,[x$b,x$_])},x$b.fillTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n="repeat"),x$b){var x$C=[x$b,x$_,x$s,x$h,x$x,x$n,x$E||x$M.EMPTY,{}];x$b.loaded||x$b.once("loaded",this,this._textureLoaded,[x$b,x$C]),this._saveToCmd(x$q._context._fillTexture,x$C)}},x$b._textureLoaded=function(x$b,x$_){x$_[3]=x$_[3]||x$b.width,x$_[4]=x$_[4]||x$b.height,this._repaint()},x$b.fillCircle=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$s.bitmap.enableMerageInAtlas=!1;var x$C=new Float32Array(2*(x$E+1)),x$O=new Float32Array(2*(x$E+1)),x$L=new Uint16Array(3*x$E),x$f=2*Math.PI/x$E,x$p=0;x$C[0]=x$h,x$C[1]=x$x,x$O[0]=x$h/x$s.width,x$O[1]=x$x/x$s.height;for(var x$P=2,x$V=0;x$V<x$E;x$V++){var x$Q=x$n*Math.cos(x$p)+x$h,x$y=x$n*Math.sin(x$p)+x$x;x$C[x$P]=x$Q,x$C[x$P+1]=x$y,x$O[x$P]=x$Q/x$s.width,x$O[x$P+1]=x$y/x$s.height,x$p+=x$f,x$P+=2}for(x$V=x$P=0;x$V<x$E;x$V++)x$L[x$P++]=0,x$L[x$P++]=x$V+1,x$L[x$P++]=x$E+1<=x$V+2?1:x$V+2;this.drawTriangles(x$s,x$b,x$_,x$C,x$O,x$L)},x$b.drawTriangles=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){void 0===x$C&&(x$C=1),this._saveToCmd(x$q._context.drawTriangles,[x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L])},x$b._saveToCmd=function(x$b,x$_){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=x$_,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(x$_)),x$_.callee=x$b,this._repaint(),x$_},x$b.clipRect=function(x$b,x$_,x$s,x$h){this._saveToCmd(x$q._context._clipRect,[x$b,x$_,x$s,x$h])},x$b.fillText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){void 0===x$E&&(x$E=0),this._saveToCmd(x$q._context._fillText,[x$b,x$_,x$s,x$h||x$V.defaultFont,x$x,x$n])},x$b.fillBorderText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){this._saveToCmd(x$q._context._fillBorderText,[x$b,x$_,x$s,x$h||x$V.defaultFont,x$x,x$n,x$E,x$C])},x$b.strokeText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._saveToCmd(x$q._context._strokeText,[x$b,x$_,x$s,x$h||x$V.defaultFont,x$x,x$n,x$E])},x$b.alpha=function(x$b){x$b=x$b<0?0:1<x$b?1:x$b,this._saveToCmd(x$q._context._alpha,[x$b])},x$b.setAlpha=function(x$b){x$b=x$b<0?0:1<x$b?1:x$b,this._saveToCmd(x$q._context._setAlpha,[x$b])},x$b.transform=function(x$b,x$_,x$s){void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),this._saveToCmd(x$q._context._transform,[x$b,x$_,x$s])},x$b.rotate=function(x$b,x$_,x$s){void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),this._saveToCmd(x$q._context._rotate,[x$b,x$_,x$s])},x$b.scale=function(x$b,x$_,x$s,x$h){void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),this._saveToCmd(x$q._context._scale,[x$b,x$_,x$s,x$h])},x$b.translate=function(x$b,x$_){this._saveToCmd(x$q._context._translate,[x$b,x$_])},x$b.save=function(){this._saveToCmd(x$q._context._save,[])},x$b.restore=function(){this._saveToCmd(x$q._context._restore,[])},x$b.replaceText=function(x$b){this._repaint();var x$_=this._cmds;if(x$_){for(var x$s=x$_.length-1;-1<x$s;x$s--)if(this._isTextCmd(x$_[x$s].callee))return x$_[x$s][0].toUpperCase?x$_[x$s][0]=x$b:x$_[x$s][0].setText(x$b),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=x$b:this._one[0].setText(x$b),!0;return!1},x$b._isTextCmd=function(x$b){return x$b===x$q._context._fillText||x$b===x$q._context._fillBorderText||x$b===x$q._context._strokeText},x$b.replaceTextColor=function(x$b){this._repaint();var x$_=this._cmds;if(x$_)for(var x$s=x$_.length-1;-1<x$s;x$s--)this._isTextCmd(x$_[x$s].callee)&&(x$_[x$s][4]=x$b,x$_[x$s][0].toUpperCase||(x$_[x$s][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=x$b,this._one[0].toUpperCase||(this._one[0].changed=!0))},x$b.loadImage=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=this;void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0);var x$C=x$Cb.getRes(x$b);function x$O(x$b){x$b&&(x$E.drawTexture(x$b,x$_,x$s,x$h,x$x),null!=x$n&&x$n.call(x$E._sp,x$b))}x$C?x$O(x$C):x$o.loader.load(x$b,x$R.create(null,x$O),null,"image")},x$b._renderEmpty=function(x$b,x$_,x$s,x$h){},x$b._renderAll=function(x$b,x$_,x$s,x$h){for(var x$x,x$n=this._cmds,x$E=0,x$C=x$n.length;x$E<x$C;x$E++)(x$x=x$n[x$E]).callee.call(x$_,x$s,x$h,x$x)},x$b._renderOne=function(x$b,x$_,x$s,x$h){this._one.callee.call(x$_,x$s,x$h,this._one)},x$b._renderOneImg=function(x$b,x$_,x$s,x$h){this._one.callee.call(x$_,x$s,x$h,this._one),2305!==x$b._renderType&&(x$b._renderType|=1)},x$b.drawLine=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=1);var x$E=0;x$q.isWebGL&&(x$E=x$v.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(x$E));var x$C=x$n%2==0?0:.5,x$O=[x$b+x$C,x$_+x$C,x$s+x$C,x$h+x$C,x$x,x$n,x$E];this._saveToCmd(x$q._context._drawLine,x$O)},x$b.drawLines=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=1);var x$n=0;if(x$s&&!(x$s.length<4)){x$q.isWebGL&&(x$n=x$v.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(x$n));var x$E=x$x%2==0?0:.5,x$C=[x$b+x$E,x$_+x$E,x$s,x$h,x$x,x$n];this._saveToCmd(x$q._context._drawLines,x$C)}},x$b.drawCurves=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=1);var x$n=[x$b,x$_,x$s,x$h,x$x];this._saveToCmd(x$q._context._drawCurves,x$n)},x$b.drawRect=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){void 0===x$E&&(x$E=1);var x$C=x$n?x$E/2:0,x$O=x$n?x$E:0,x$L=[x$b+x$C,x$_+x$C,x$s-x$O,x$h-x$O,x$x,x$n,x$E];this._saveToCmd(x$q._context._drawRect,x$L)},x$b.drawCircle=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=1);var x$E=x$x?x$n/2:0,x$C=0;x$q.isWebGL&&(x$C=x$v.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(x$C));var x$O=[x$b,x$_,x$s-x$E,x$h,x$x,x$n,x$C];this._saveToCmd(x$q._context._drawCircle,x$O)},x$b.drawPie=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){void 0===x$C&&(x$C=1);var x$O=x$E?x$C/2:0,x$L=x$E?x$C:0,x$f=0;x$q.isWebGL&&(x$f=x$v.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(x$f));var x$p=[x$b+x$O,x$_+x$O,x$s-x$L,x$h,x$x,x$n,x$E,x$C,x$f];x$p[3]=x$e.toRadian(x$h),x$p[4]=x$e.toRadian(x$x),this._saveToCmd(x$q._context._drawPie,x$p)},x$b.drawPoly=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=1);var x$E=0,x$C=!1;x$q.isWebGL&&(x$E=x$v.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(x$E),x$C=!(6<x$s.length));var x$O=x$x?x$n%2==0?0:.5:0,x$L=[x$b+x$O,x$_+x$O,x$s,x$h,x$x,x$n,x$E,x$C];this._saveToCmd(x$q._context._drawPoly,x$L)},x$b.drawPath=function(x$b,x$_,x$s,x$h,x$x){var x$n=[x$b,x$_,x$s,x$h,x$x];this._saveToCmd(x$q._context._drawPath,x$n)},x$Q(0,x$b,"cmds",function(){return this._cmds},function(x$b){this._sp&&(this._sp._renderType|=512),this._cmds=x$b,this._render=this._renderAll,this._repaint()}),x$p.__init__=function(){if(x$q.isConchNode){for(var x$b=laya.display.Graphics.prototype,x$_=x$K.window.ConchGraphics.prototype,x$s=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],x$h=0,x$x=x$s.length;x$h<=x$x;x$h++){var x$n=x$s[x$h];x$b[x$n]=x$_[x$n]}x$b._saveToCmd=null,x$_.drawImageS&&(x$b.drawTextures=function(x$b,x$_){if(x$b&&x$b.loaded&&x$b.bitmap&&x$b.source){var x$s=x$b.uv,x$h=x$b.bitmap.width,x$x=x$b.bitmap.height;this.drawImageS(x$b.bitmap.source,x$s[0]*x$h,x$s[1]*x$x,(x$s[2]-x$s[0])*x$h,(x$s[5]-x$s[3])*x$x,x$b.offsetX,x$b.offsetY,x$b.width,x$b.height,x$_)}}),x$b.drawTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$E&&(x$E=1),x$b)if(x$b.loaded){if(x$b.loaded&&x$b.bitmap&&x$b.source&&(x$h||(x$h=x$b.sourceWidth),x$x||(x$x=x$b.sourceHeight),x$E=x$E<0?0:1<x$E?1:x$E,x$h=x$h-x$b.sourceWidth+x$b.width,x$x=x$x-x$b.sourceHeight+x$b.height,!(x$h<=0||x$x<=0))){x$_+=x$b.offsetX,x$s+=x$b.offsetY;var x$C=x$b.uv,x$O=x$b.bitmap.width,x$L=x$b.bitmap.height;x$C[4]<x$C[0]&&x$C[5]<x$C[1]?this.drawImageM(x$b.bitmap.source,x$C[4]*x$O,x$C[5]*x$L,(x$C[0]-x$C[4])*x$O,(x$C[1]-x$C[5])*x$L,x$_,x$s,x$h,x$x,x$n,x$E):this.drawImageM(x$b.bitmap.source,x$C[0]*x$O,x$C[1]*x$L,(x$C[2]-x$C[0])*x$O,(x$C[5]-x$C[3])*x$L,x$_,x$s,x$h,x$x,x$n,x$E),this._repaint()}}else x$b.once("loaded",this,function(){this.drawTexture(x$b,x$_,x$s,x$h,x$x,x$n)})},x$b.fillTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n="repeat"),x$b&&x$b.loaded){var x$C,x$O=x$q._context.ctx,x$L=x$b.bitmap.width,x$f=x$b.bitmap.height,x$p=x$b.uv;x$C=x$b.uv!=x$fb.DEF_UV?x$O.createPattern(x$b.bitmap.source,x$n,x$p[0]*x$L,x$p[1]*x$f,(x$p[2]-x$p[0])*x$L,(x$p[5]-x$p[3])*x$f):x$O.createPattern(x$b.bitmap.source,x$n);var x$P=0,x$V=0;x$E&&(x$_+=x$E.x%x$b.width,x$s+=x$E.y%x$b.height,x$P-=x$E.x%x$b.width,x$V-=x$E.y%x$b.height),this._fillImage(x$C,x$_,x$s,x$P,x$V,x$h,x$x)}}}},x$p._cache=[],x$p}(),x$s=function(){function x$t(){this._cacheBoundsType=!1}x$f(x$t,"laya.display.GraphicsBounds");var x$b=x$t.prototype;return x$b.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},x$b.reset=function(){this._temp&&(this._temp.length=0)},x$b.getBounds=function(x$b){return void 0===x$b&&(x$b=!1),(!this._bounds||!this._temp||this._temp.length<1||x$b!=this._cacheBoundsType)&&(this._bounds=x$r._getWrapRec(this.getBoundPoints(x$b),this._bounds)),this._cacheBoundsType=x$b,this._bounds},x$b.getBoundPoints=function(x$b){return void 0===x$b&&(x$b=!1),(!this._temp||this._temp.length<1||x$b!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(x$b)),this._cacheBoundsType=x$b,this._rstBoundPoints=x$e.copyArray(this._rstBoundPoints,this._temp)},x$b._getCmdPoints=function(x$b){void 0===x$b&&(x$b=!1);var x$_,x$s,x$h=x$q._context,x$x=this._graphics.cmds;if((x$_=this._temp||(this._temp=[])).length=0,x$x||null==this._graphics._one||(x$t._tempCmds.length=0,x$t._tempCmds.push(this._graphics._one),x$x=x$t._tempCmds),!x$x)return x$_;(x$s=x$t._tempMatrixArrays).length=0;var x$n=x$t._initMatrix;x$n.identity();for(var x$E,x$C,x$O=x$t._tempMatrix,x$L=NaN,x$f=NaN,x$p=NaN,x$P=NaN,x$V=NaN,x$Q=NaN,x$y=0,x$w=x$x.length;x$y<x$w;x$y++)if((x$E=x$x[x$y]).callee)switch(x$E.callee){case x$h._save:case 7:x$s.push(x$n),x$n=x$n.clone();break;case x$h._restore:case 8:x$n=x$s.pop();break;case x$h._scale:case 5:x$O.identity(),x$O.translate(-x$E[2],-x$E[3]),x$O.scale(x$E[0],x$E[1]),x$O.translate(x$E[2],x$E[3]),this._switchMatrix(x$n,x$O);break;case x$h._rotate:case 3:x$O.identity(),x$O.translate(-x$E[1],-x$E[2]),x$O.rotate(x$E[0]),x$O.translate(x$E[1],x$E[2]),this._switchMatrix(x$n,x$O);break;case x$h._translate:case 6:x$O.identity(),x$O.translate(x$E[0],x$E[1]),this._switchMatrix(x$n,x$O);break;case x$h._transform:case 4:x$O.identity(),x$O.translate(-x$E[1],-x$E[2]),x$O.concat(x$E[0]),x$O.translate(x$E[1],x$E[2]),this._switchMatrix(x$n,x$O);break;case 16:case 24:x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[0],x$E[1],x$E[2],x$E[3]),x$n);break;case 17:x$n.copyTo(x$O),x$O.concat(x$E[4]),x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[0],x$E[1],x$E[2],x$E[3]),x$O);break;case x$h._drawTexture:x$C=x$E[0],x$b?x$E[3]&&x$E[4]?x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$E[3],x$E[4]),x$n):(x$C=x$E[0],x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$C.width,x$C.height),x$n)):(x$L=(x$E[3]||x$C.sourceWidth)/x$C.width,x$f=(x$E[4]||x$C.sourceHeight)/x$C.height,x$p=x$L*x$C.sourceWidth,x$P=x$f*x$C.sourceHeight,x$V=0<x$C.offsetX?x$C.offsetX:0,x$Q=0<x$C.offsetY?x$C.offsetY:0,x$V*=x$L,x$Q*=x$f,x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1]-x$V,x$E[2]-x$Q,x$p,x$P),x$n));break;case x$h._fillTexture:x$E[3]&&x$E[4]?x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$E[3],x$E[4]),x$n):(x$C=x$E[0],x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$C.width,x$C.height),x$n));break;case x$h._drawTextureWithTransform:var x$i;x$i=x$E[5]?(x$n.copyTo(x$O),x$O.concat(x$E[5]),x$O):x$n,x$b?x$E[3]&&x$E[4]?x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$E[3],x$E[4]),x$i):(x$C=x$E[0],x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1],x$E[2],x$C.width,x$C.height),x$i)):(x$C=x$E[0],x$L=(x$E[3]||x$C.sourceWidth)/x$C.width,x$f=(x$E[4]||x$C.sourceHeight)/x$C.height,x$p=x$L*x$C.sourceWidth,x$P=x$f*x$C.sourceHeight,x$V=0<x$C.offsetX?x$C.offsetX:0,x$Q=0<x$C.offsetY?x$C.offsetY:0,x$V*=x$L,x$Q*=x$f,x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[1]-x$V,x$E[2]-x$Q,x$p,x$P),x$i));break;case x$h._drawRect:case 13:x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[0],x$E[1],x$E[2],x$E[3]),x$n);break;case x$h._drawCircle:case x$h._fillCircle:case 14:x$t._addPointArrToRst(x$_,x$r._getBoundPointS(x$E[0]-x$E[2],x$E[1]-x$E[2],x$E[2]+x$E[2],x$E[2]+x$E[2]),x$n);break;case x$h._drawLine:case 20:x$t._tempPoints.length=0;var x$R;x$R=.5*x$E[5],x$E[0]==x$E[2]?x$t._tempPoints.push(x$E[0]+x$R,x$E[1],x$E[2]+x$R,x$E[3],x$E[0]-x$R,x$E[1],x$E[2]-x$R,x$E[3]):x$E[1]==x$E[3]?x$t._tempPoints.push(x$E[0],x$E[1]+x$R,x$E[2],x$E[3]+x$R,x$E[0],x$E[1]-x$R,x$E[2],x$E[3]-x$R):x$t._tempPoints.push(x$E[0],x$E[1],x$E[2],x$E[3]),x$t._addPointArrToRst(x$_,x$t._tempPoints,x$n);break;case x$h._drawCurves:case 22:x$t._addPointArrToRst(x$_,x$c.I.getBezierPoints(x$E[2]),x$n,x$E[0],x$E[1]);break;case x$h._drawPoly:case x$h._drawLines:case 18:x$t._addPointArrToRst(x$_,x$E[2],x$n,x$E[0],x$E[1]);break;case x$h._drawPath:case 19:x$t._addPointArrToRst(x$_,this._getPathPoints(x$E[2]),x$n,x$E[0],x$E[1]);break;case x$h._drawPie:case 15:x$t._addPointArrToRst(x$_,this._getPiePoints(x$E[0],x$E[1],x$E[2],x$E[3],x$E[4]),x$n)}return 200<x$_.length?x$_=x$e.copyArray(x$_,x$r._getWrapRec(x$_)._getBoundPoints()):8<x$_.length&&(x$_=x$$.scanPList(x$_)),x$_},x$b._switchMatrix=function(x$b,x$_){x$_.concat(x$b),x$_.copyTo(x$b)},x$b._getPiePoints=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$t._tempPoints;x$t._tempPoints.length=0,x$n.push(x$b,x$_);var x$E=(x$x-x$h)%(2*Math.PI)/10,x$C=NaN,x$O=x$h;for(x$C=0;x$C<=10;x$C++)x$n.push(x$b+x$s*Math.cos(x$O),x$_+x$s*Math.sin(x$O)),x$O+=x$E;return x$n},x$b._getPathPoints=function(x$b){var x$_,x$s,x$h=0,x$x=x$t._tempPoints;for(x$x.length=0,x$_=x$b.length,x$h=0;x$h<x$_;x$h++)1<(x$s=x$b[x$h]).length&&(x$x.push(x$s[1],x$s[2]),3<x$s.length&&x$x.push(x$s[3],x$s[4]));return x$x},x$t._addPointArrToRst=function(x$b,x$_,x$s,x$h,x$x){void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0);var x$n,x$E=0;for(x$n=x$_.length,x$E=0;x$E<x$n;x$E+=2)x$t._addPointToRst(x$b,x$_[x$E]+x$h,x$_[x$E+1]+x$x,x$s)},x$t._addPointToRst=function(x$b,x$_,x$s,x$h){var x$x=x$M.TEMP;x$x.setTo(x$_||0,x$s||0),x$h.transformPoint(x$x),x$b.push(x$x.x,x$x.y)},x$t._tempPoints=[],x$t._tempMatrixArrays=[],x$t._tempCmds=[],x$O(x$t,["_tempMatrix",function(){return this._tempMatrix=new x$J},"_initMatrix",function(){return this._initMatrix=new x$J}]),x$t}(),x$n=function(){function x$b(){}x$f(x$b,"laya.events.Event");var x$_=x$b.prototype;return x$_.setTo=function(x$b,x$_,x$s){return this.type=x$b,this.currentTarget=x$_,this.target=x$s,this},x$_.stopPropagation=function(){this._stoped=!0},x$Q(0,x$_,"stageY",function(){return x$o.stage.mouseY}),x$Q(0,x$_,"charCode",function(){return this.nativeEvent.charCode}),x$Q(0,x$_,"touches",function(){var x$b=this.nativeEvent.touches;if(x$b)for(var x$_=x$o.stage,x$s=0,x$h=x$b.length;x$s<x$h;x$s++){var x$x=x$b[x$s],x$n=x$M.TEMP;x$n.setTo(x$x.clientX,x$x.clientY),x$_._canvasTransform.invertTransformPoint(x$n),x$_.transform.invertTransformPoint(x$n),x$x.stageX=x$n.x,x$x.stageY=x$n.y}return x$b}),x$Q(0,x$_,"keyLocation",function(){return this.nativeEvent.keyLocation}),x$Q(0,x$_,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),x$Q(0,x$_,"altKey",function(){return this.nativeEvent.altKey}),x$Q(0,x$_,"shiftKey",function(){return this.nativeEvent.shiftKey}),x$Q(0,x$_,"stageX",function(){return x$o.stage.mouseX}),x$b.EMPTY=new x$b,x$b.MOUSE_DOWN="mousedown",x$b.MOUSE_UP="mouseup",x$b.CLICK="click",x$b.RIGHT_MOUSE_DOWN="rightmousedown",x$b.RIGHT_MOUSE_UP="rightmouseup",x$b.RIGHT_CLICK="rightclick",x$b.MOUSE_MOVE="mousemove",x$b.MOUSE_OVER="mouseover",x$b.MOUSE_OUT="mouseout",x$b.MOUSE_WHEEL="mousewheel",x$b.ROLL_OVER="mouseover",x$b.ROLL_OUT="mouseout",x$b.DOUBLE_CLICK="doubleclick",x$b.CHANGE="change",x$b.CHANGED="changed",x$b.RESIZE="resize",x$b.ADDED="added",x$b.REMOVED="removed",x$b.DISPLAY="display",x$b.UNDISPLAY="undisplay",x$b.ERROR="error",x$b.COMPLETE="complete",x$b.LOADED="loaded",x$b.INITED="inited",x$b.PROGRESS="progress",x$b.INPUT="input",x$b.RENDER="render",x$b.OPEN="open",x$b.MESSAGE="message",x$b.CLOSE="close",x$b.KEY_DOWN="keydown",x$b.KEY_PRESS="keypress",x$b.KEY_UP="keyup",x$b.FRAME="enterframe",x$b.DRAG_START="dragstart",x$b.DRAG_MOVE="dragmove",x$b.DRAG_END="dragend",x$b.ENTER="enter",x$b.SELECT="select",x$b.BLUR="blur",x$b.FOCUS="focus",x$b.VISIBILITY_CHANGE="visibilitychange",x$b.FOCUS_CHANGE="focuschange",x$b.PLAYED="played",x$b.PAUSED="paused",x$b.STOPPED="stopped",x$b.START="start",x$b.END="end",x$b.ENABLE_CHANGED="enablechanged",x$b.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",x$b.COMPONENT_ADDED="componentadded",x$b.COMPONENT_REMOVED="componentremoved",x$b.LAYER_CHANGED="layerchanged",x$b.HIERARCHY_LOADED="hierarchyloaded",x$b.RECOVERED="recovered",x$b.RELEASED="released",x$b.LINK="link",x$b.LABEL="label",x$b.FULL_SCREEN_CHANGE="fullscreenchange",x$b.DEVICE_LOST="devicelost",x$b.MESH_CHANGED="meshchanged",x$b.MATERIAL_CHANGED="materialchanged",x$b.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",x$b.ANIMATION_CHANGED="animationchanged",x$b.TRIGGER_ENTER="triggerenter",x$b.TRIGGER_STAY="triggerstay",x$b.TRIGGER_EXIT="triggerexit",x$b.TRAIL_FILTER_CHANGE="trailfilterchange",x$b.DOMINO_FILTER_CHANGE="dominofilterchange",x$b}(),x$p=(function(){function x$b(){}x$f(x$b,"laya.events.Keyboard"),x$b.NUMBER_0=48,x$b.NUMBER_1=49,x$b.NUMBER_2=50,x$b.NUMBER_3=51,x$b.NUMBER_4=52,x$b.NUMBER_5=53,x$b.NUMBER_6=54,x$b.NUMBER_7=55,x$b.NUMBER_8=56,x$b.NUMBER_9=57,x$b.A=65,x$b.B=66,x$b.C=67,x$b.D=68,x$b.E=69,x$b.F=70,x$b.G=71,x$b.H=72,x$b.I=73,x$b.J=74,x$b.K=75,x$b.L=76,x$b.M=77,x$b.N=78,x$b.O=79,x$b.P=80,x$b.Q=81,x$b.R=82,x$b.S=83,x$b.T=84,x$b.U=85,x$b.V=86,x$b.W=87,x$b.X=88,x$b.Y=89,x$b.Z=90,x$b.F1=112,x$b.F2=113,x$b.F3=114,x$b.F4=115,x$b.F5=116,x$b.F6=117,x$b.F7=118,x$b.F8=119,x$b.F9=120,x$b.F10=121,x$b.F11=122,x$b.F12=123,x$b.F13=124,x$b.F14=125,x$b.F15=126,x$b.NUMPAD=21,x$b.NUMPAD_0=96,x$b.NUMPAD_1=97,x$b.NUMPAD_2=98,x$b.NUMPAD_3=99,x$b.NUMPAD_4=100,x$b.NUMPAD_5=101,x$b.NUMPAD_6=102,x$b.NUMPAD_7=103,x$b.NUMPAD_8=104,x$b.NUMPAD_9=105,x$b.NUMPAD_ADD=107,x$b.NUMPAD_DECIMAL=110,x$b.NUMPAD_DIVIDE=111,x$b.NUMPAD_ENTER=108,x$b.NUMPAD_MULTIPLY=106,x$b.NUMPAD_SUBTRACT=109,x$b.SEMICOLON=186,x$b.EQUAL=187,x$b.COMMA=188,x$b.MINUS=189,x$b.PERIOD=190,x$b.SLASH=191,x$b.BACKQUOTE=192,x$b.LEFTBRACKET=219,x$b.BACKSLASH=220,x$b.RIGHTBRACKET=221,x$b.QUOTE=222,x$b.ALTERNATE=18,x$b.BACKSPACE=8,x$b.CAPS_LOCK=20,x$b.COMMAND=15,x$b.CONTROL=17,x$b.DELETE=46,x$b.ENTER=13,x$b.ESCAPE=27,x$b.PAGE_UP=33,x$b.PAGE_DOWN=34,x$b.END=35,x$b.HOME=36,x$b.LEFT=37,x$b.UP=38,x$b.RIGHT=39,x$b.DOWN=40,x$b.SHIFT=16,x$b.SPACE=32,x$b.TAB=9,x$b.INSERT=45}(),function(){function x$x(){}return x$f(x$x,"laya.events.KeyBoardManager"),x$x.__init__=function(){x$x._addEvent("keydown"),x$x._addEvent("keypress"),x$x._addEvent("keyup")},x$x._addEvent=function(x$_){x$K.document.addEventListener(x$_,function(x$b){laya.events.KeyBoardManager._dispatch(x$b,x$_)},!0)},x$x._dispatch=function(x$b,x$_){if(x$x.enabled){x$x._event._stoped=!1,x$x._event.nativeEvent=x$b,x$x._event.keyCode=x$b.keyCode||x$b.which||x$b.charCode,"keydown"===x$_?x$x._pressKeys[x$x._event.keyCode]=!0:"keyup"===x$_&&(x$x._pressKeys[x$x._event.keyCode]=null);for(var x$s=x$o.stage.focus&&null!=x$o.stage.focus.event&&x$o.stage.focus.displayedInStage?x$o.stage.focus:x$o.stage,x$h=x$s;x$h;)x$h.event(x$_,x$x._event.setTo(x$_,x$h,x$s)),x$h=x$h.parent}},x$x.hasKeyDown=function(x$b){return x$x._pressKeys[x$b]},x$x._pressKeys={},x$x.enabled=!0,x$O(x$x,["_event",function(){return this._event=new x$n}]),x$x}()),x$y=(function(){function x$b(){}x$f(x$b,"laya.events.KeyLocation"),x$b.STANDARD=0,x$b.LEFT=1,x$b.RIGHT=2,x$b.NUM_PAD=3}(),function(){function x$L(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=x$K.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new x$n,this._matrix=new x$J,this._point=new x$M,this._rect=new x$r,this._prePoint=new x$M,this._curTouchID=NaN}x$f(x$L,"laya.events.MouseManager");var x$b=x$L.prototype;return x$b.__init__=function(x$b,x$_){var x$s=this;this._stage=x$b;var x$h=this,x$x=this._eventList;x$_.oncontextmenu=function(x$b){if(x$L.enabled)return!1},x$_.addEventListener("mousedown",function(x$b){x$L.enabled&&(x$K.onIE||x$b.preventDefault(),x$x.push(x$b),x$h.mouseDownTime=x$K.now())}),x$_.addEventListener("mouseup",function(x$b){x$L.enabled&&(x$b.preventDefault(),x$x.push(x$b),x$h.mouseDownTime=-x$K.now())},!0),x$_.addEventListener("mousemove",function(x$b){if(x$L.enabled){x$b.preventDefault();var x$_=x$K.now();if(x$_-x$h._lastMoveTimer<10)return;x$h._lastMoveTimer=x$_,x$x.push(x$b)}},!0),x$_.addEventListener("mouseout",function(x$b){x$L.enabled&&x$x.push(x$b)}),x$_.addEventListener("mouseover",function(x$b){x$L.enabled&&x$x.push(x$b)}),x$_.addEventListener("touchstart",function(x$b){x$L.enabled&&(x$x.push(x$b),x$L._isFirstTouch||x$$b.isInputting||x$b.preventDefault(),x$h.mouseDownTime=x$K.now())}),x$_.addEventListener("touchend",function(x$b){x$L.enabled?(x$L._isFirstTouch||x$$b.isInputting||x$b.preventDefault(),x$L._isFirstTouch=!1,x$x.push(x$b),x$h.mouseDownTime=-x$K.now()):x$s._curTouchID=NaN},!0),x$_.addEventListener("touchmove",function(x$b){x$L.enabled&&(x$b.preventDefault(),x$x.push(x$b))},!0),x$_.addEventListener("touchcancel",function(x$b){x$L.enabled?(x$b.preventDefault(),x$x.push(x$b)):x$s._curTouchID=NaN},!0),x$_.addEventListener("mousewheel",function(x$b){x$L.enabled&&x$x.push(x$b)}),x$_.addEventListener("DOMMouseScroll",function(x$b){x$L.enabled&&x$x.push(x$b)})},x$b.initEvent=function(x$b,x$_){var x$s;this._event._stoped=!1,this._event.nativeEvent=x$_||x$b,this._target=null,this._point.setTo(x$b.pageX||x$b.clientX,x$b.pageY||x$b.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=x$b.identifier||0,this._tTouchID=this._event.touchId,(x$s=x$w.I._event)._stoped=!1,x$s.nativeEvent=this._event.nativeEvent,x$s.touchId=this._event.touchId},x$b.checkMouseWheel=function(x$b){this._event.delta=x$b.wheelDelta?.025*x$b.wheelDelta:-x$b.detail;for(var x$_=x$w.I.getLastOvers(),x$s=0,x$h=x$_.length;x$s<x$h;x$s++){var x$x=x$_[x$s];x$x.event("mousewheel",this._event.setTo("mousewheel",x$x,this._target))}},x$b.onMouseMove=function(x$b){x$w.I.onMouseMove(x$b,this._tTouchID)},x$b.onMouseDown=function(x$b){if(x$$b.isInputting&&x$o.stage.focus&&x$o.stage.focus.focus&&!x$o.stage.focus.contains(this._target)){var x$_=x$o.stage.focus._tf||x$o.stage.focus,x$s=x$b._tf||x$b;x$s instanceof laya.display.Input&&x$s.multiline==x$_.multiline?x$_._focusOut():x$_.focus=!1}x$w.I.onMouseDown(x$b,this._tTouchID,this._isLeftMouse)},x$b.onMouseUp=function(x$b){x$w.I.onMouseUp(x$b,this._tTouchID,this._isLeftMouse)},x$b.check=function(x$b,x$_,x$s,x$h){this._point.setTo(x$_,x$s),x$b.fromParentPoint(this._point),x$_=this._point.x,x$s=this._point.y;var x$x=x$b.scrollRect;if(x$x&&(this._rect.setTo(x$x.x,x$x.y,x$x.width,x$x.height),!this._rect.contains(x$_,x$s)))return!1;if(!this.disableMouseEvent){if(x$b.hitTestPrior&&!x$b.mouseThrough&&!this.hitTest(x$b,x$_,x$s))return!1;for(var x$n=x$b._childs.length-1;-1<x$n;x$n--){var x$E=x$b._childs[x$n];if(!x$E.destroyed&&x$E.mouseEnabled&&x$E.visible&&this.check(x$E,x$_,x$s,x$h))return!0}}var x$C=!(!x$b.hitTestPrior||x$b.mouseThrough||this.disableMouseEvent)||this.hitTest(x$b,x$_,x$s);return x$C?(this._target=x$b,x$h.call(this,x$b)):x$h===this.onMouseUp&&x$b===this._stage&&(this._target=this._stage,x$h.call(this,this._target)),x$C},x$b.hitTest=function(x$b,x$_,x$s){var x$h=!1;if(x$b.scrollRect&&(x$_-=x$b.scrollRect.x,x$s-=x$b.scrollRect.y),x$b.hitArea instanceof laya.utils.HitArea)return x$b.hitArea.isHit(x$_,x$s);if(0<x$b.width&&0<x$b.height||x$b.mouseThrough||x$b.hitArea)if(x$b.mouseThrough)x$h=x$b.getGraphicBounds().contains(x$_,x$s);else{var x$x=this._rect;x$b.hitArea?x$x=x$b.hitArea:x$x.setTo(0,0,x$b.width,x$b.height),x$h=x$x.contains(x$_,x$s)}return x$h},x$b.runEvent=function(){var x$b=this._eventList.length;if(x$b){this.mouseEventTime=x$K.now();var x$_,x$s=0,x$h=0,x$x=0;try{for(;x$s<x$b;){var x$n=this._eventList[x$s];switch("mousemove"!==x$n.type&&(this._prePoint.x=this._prePoint.y=-1e6),x$n.type){case"mousedown":this._touchIDs[0]=this._id++,x$L._isTouchRespond?x$L._isTouchRespond=!1:(this._isLeftMouse=0===x$n.button,this.initEvent(x$n),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===x$n.button,this.initEvent(x$n),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-x$n.clientX)+Math.abs(this._prePoint.y-x$n.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=x$n.clientX,this._prePoint.y=x$n.clientY,this.initEvent(x$n),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":x$L._isTouchRespond=!0,this._isLeftMouse=!0;var x$E=x$n.changedTouches;for(x$h=0,x$x=x$E.length;x$h<x$x;x$h++)x$_=x$E[x$h],(x$L.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=x$_.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[x$_.identifier]=this._id++,this.initEvent(x$_,x$n),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":x$L._isTouchRespond=!0,this._isLeftMouse=!0;var x$C=x$n.changedTouches;for(x$h=0,x$x=x$C.length;x$h<x$x;x$h++)if(x$_=x$C[x$h],x$L.multiTouchEnabled||x$_.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(x$_,x$n);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var x$O=x$n.changedTouches;for(x$h=0,x$x=x$O.length;x$h<x$x;x$h++)x$_=x$O[x$h],(x$L.multiTouchEnabled||x$_.identifier==this._curTouchID)&&(this.initEvent(x$_,x$n),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(x$n);break;case"mouseout":x$w.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}x$s++}}catch(x$b){throw this._eventList.length=0,x$b}this._eventList.length=0}},x$L.enabled=!0,x$L.multiTouchEnabled=!0,x$L._isTouchRespond=!1,x$L._isFirstTouch=!0,x$O(x$L,["instance",function(){return this.instance=new x$L}]),x$L}()),x$w=function(){function x$Q(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new x$n}x$f(x$Q,"laya.events.TouchManager");var x$b=x$Q.prototype;return x$b._clearTempArrs=function(){x$Q._oldArr.length=0,x$Q._newArr.length=0,x$Q._tEleArr.length=0},x$b.getTouchFromArr=function(x$b,x$_){var x$s,x$h,x$x=0;for(x$s=x$_.length,x$x=0;x$x<x$s;x$x++)if((x$h=x$_[x$x]).id==x$b)return x$h;return null},x$b.removeTouchFromArr=function(x$b,x$_){var x$s=0;for(x$s=x$_.length-1;0<=x$s;x$s--)x$_[x$s].id==x$b&&x$_.splice(x$s,1)},x$b.createTouchO=function(x$b,x$_){var x$s;return(x$s=x$N.getItem("TouchData")||{}).id=x$_,x$s.tar=x$b,x$s},x$b.onMouseDown=function(x$b,x$_,x$s){var x$h,x$x,x$n,x$E;(void 0===x$s&&(x$s=!1),this.enable)&&(x$h=this.getTouchFromArr(x$_,this.preOvers),x$n=this.getEles(x$b,null,x$Q._tEleArr),x$h?x$h.tar=x$b:(x$x=this.createTouchO(x$b,x$_),this.preOvers.push(x$x)),x$K.onMobile&&this.sendEvents(x$n,"mouseover",x$_),x$E=x$s?this.preDowns:this.preRightDowns,(x$h=this.getTouchFromArr(x$_,x$E))?x$h.tar=x$b:(x$x=this.createTouchO(x$b,x$_),x$E.push(x$x)),this.sendEvents(x$n,x$s?"mousedown":"rightmousedown",x$_),this._clearTempArrs())},x$b.sendEvents=function(x$b,x$_,x$s){void 0===x$s&&(x$s=0);var x$h,x$x,x$n,x$E=0;for(x$h=x$b.length,this._event._stoped=!1,x$x=x$b[0],x$E=0;x$E<x$h;x$E++){if((x$n=x$b[x$E]).destroyed)return;if(x$n.event(x$_,this._event.setTo(x$_,x$n,x$x)),this._event._stoped)break}},x$b.getEles=function(x$b,x$_,x$s){for(x$s?x$s.length=0:x$s=[];x$b&&x$b!=x$_;)x$s.push(x$b),x$b=x$b.parent;return x$s},x$b.checkMouseOutAndOverOfMove=function(x$b,x$_,x$s){if(void 0===x$s&&(x$s=0),x$_!=x$b){var x$h,x$x,x$n=0,x$E=0;if(x$_.contains(x$b))x$x=this.getEles(x$b,x$_,x$Q._tEleArr),this.sendEvents(x$x,"mouseover",x$s);else if(x$b.contains(x$_))x$x=this.getEles(x$_,x$b,x$Q._tEleArr),this.sendEvents(x$x,"mouseout",x$s);else{var x$C,x$O;(x$x=x$Q._tEleArr).length=0,x$C=this.getEles(x$_,null,x$Q._oldArr),x$O=this.getEles(x$b,null,x$Q._newArr),x$E=x$C.length;var x$L=0;for(x$n=0;x$n<x$E;x$n++){if(x$h=x$C[x$n],0<=(x$L=x$O.indexOf(x$h))){x$O.splice(x$L,x$O.length-x$L);break}x$x.push(x$h)}0<x$x.length&&this.sendEvents(x$x,"mouseout",x$s),0<x$O.length&&this.sendEvents(x$O,"mouseover",x$s)}}},x$b.onMouseMove=function(x$b,x$_){var x$s,x$h;this.enable&&((x$s=this.getTouchFromArr(x$_,this.preOvers))?(this.checkMouseOutAndOverOfMove(x$b,x$s.tar),x$s.tar=x$b,x$h=this.getEles(x$b,null,x$Q._tEleArr)):(x$h=this.getEles(x$b,null,x$Q._tEleArr),this.sendEvents(x$h,"mouseover",x$_),this.preOvers.push(this.createTouchO(x$b,x$_))),this.sendEvents(x$h,"mousemove",x$_),this._clearTempArrs())},x$b.getLastOvers=function(){return(x$Q._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,x$Q._tEleArr):(x$Q._tEleArr.push(x$o.stage),x$Q._tEleArr)},x$b.stageMouseOut=function(){var x$b;x$b=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(x$b,"mouseout",0)},x$b.onMouseUp=function(x$b,x$_,x$s){if(void 0===x$s&&(x$s=!1),this.enable){var x$h,x$x,x$n,x$E,x$C,x$O,x$L=0,x$f=0,x$p=x$K.onMobile;if(x$x=this.getEles(x$b,null,x$Q._tEleArr),this.sendEvents(x$x,x$s?"mouseup":"rightmouseup",x$_),x$O=x$s?this.preDowns:this.preRightDowns,x$h=this.getTouchFromArr(x$_,x$O)){var x$P,x$V=x$K.now();if(x$P=x$V-this._lastClickTime<300,this._lastClickTime=x$V,x$b==x$h.tar)x$C=x$x;else for(x$n=this.getEles(x$h.tar,null,x$Q._oldArr),(x$C=x$Q._newArr).length=0,x$f=x$n.length,x$L=0;x$L<x$f;x$L++)x$E=x$n[x$L],0<=x$x.indexOf(x$E)&&x$C.push(x$E);0<x$C.length&&this.sendEvents(x$C,x$s?"click":"rightclick",x$_),x$s&&x$P&&this.sendEvents(x$C,"doubleclick",x$_),this.removeTouchFromArr(x$_,x$O),x$h.tar=null,x$N.recover("TouchData",x$h)}else;(x$h=this.getTouchFromArr(x$_,this.preOvers))&&x$p&&((x$C=this.getEles(x$h.tar,null,x$C))&&0<x$C.length&&this.sendEvents(x$C,"mouseout",x$_),this.removeTouchFromArr(x$_,this.preOvers),x$h.tar=null,x$N.recover("TouchData",x$h)),this._clearTempArrs()}},x$Q._oldArr=[],x$Q._newArr=[],x$Q._tEleArr=[],x$O(x$Q,["I",function(){return this.I=new x$Q}]),x$Q}(),x$i=function(){function x$b(){this._action=null}x$f(x$b,"laya.filters.Filter");var x$_=x$b.prototype;return x$o.imps(x$_,{"laya.filters.IFilter":!0}),x$_.callNative=function(x$b){},x$Q(0,x$_,"type",function(){return-1}),x$Q(0,x$_,"action",function(){return this._action}),x$b.BLUR=16,x$b.COLOR=32,x$b.GLOW=8,x$b._filterStart=null,x$b._filterEnd=null,x$b._EndTarget=null,x$b._recycleScope=null,x$b._filter=null,x$b._useSrc=null,x$b._endSrc=null,x$b._useOut=null,x$b._endOut=null,x$b}(),x$t=function(){function x$b(){this.data=null}x$f(x$b,"laya.filters.ColorFilterAction");var x$_=x$b.prototype;return x$o.imps(x$_,{"laya.filters.IFilterAction":!0}),x$_.apply=function(x$b){var x$_=x$b.ctx.ctx,x$s=x$b.ctx.ctx.canvas;if(0==x$s.width||0==x$s.height)return x$s;for(var x$h,x$x=x$_.getImageData(0,0,x$s.width,x$s.height),x$n=x$x.data,x$E=0,x$C=x$n.length;x$E<x$C;x$E+=4)x$h=this.getColor(x$n[x$E],x$n[x$E+1],x$n[x$E+2],x$n[x$E+3]),0!=x$n[x$E+3]&&(x$n[x$E]=x$h[0],x$n[x$E+1]=x$h[1],x$n[x$E+2]=x$h[2],x$n[x$E+3]=x$h[3]);return x$_.putImageData(x$x,0,0),x$b},x$_.getColor=function(x$b,x$_,x$s,x$h){var x$x=[];if(this.data._mat&&this.data._alpha){var x$n=this.data._mat,x$E=this.data._alpha;x$x[0]=x$n[0]*x$b+x$n[1]*x$_+x$n[2]*x$s+x$n[3]*x$h+x$E[0],x$x[1]=x$n[4]*x$b+x$n[5]*x$_+x$n[6]*x$s+x$n[7]*x$h+x$E[1],x$x[2]=x$n[8]*x$b+x$n[9]*x$_+x$n[10]*x$s+x$n[11]*x$h+x$E[2],x$x[3]=x$n[12]*x$b+x$n[13]*x$_+x$n[14]*x$s+x$n[15]*x$h+x$E[3]}return x$x},x$b}(),x$c=(function(){function x$b(){}x$f(x$b,"laya.maths.Arith"),x$b.formatR=function(x$b){return x$b>Math.PI&&(x$b-=2*Math.PI),x$b<-Math.PI&&(x$b+=2*Math.PI),x$b},x$b.isPOT=function(x$b,x$_){return 0<x$b&&0==(x$b&x$b-1)&&0<x$_&&0==(x$_&x$_-1)},x$b.setMatToArray=function(x$b,x$_){x$b.a,x$b.b,x$b.c,x$b.d,x$b.tx,x$b.ty,x$_[0]=x$b.a,x$_[1]=x$b.b,x$_[4]=x$b.c,x$_[5]=x$b.d,x$_[12]=x$b.tx,x$_[13]=x$b.ty}}(),function(){function x$b(){this._controlPoints=[new x$M,new x$M,new x$M],this._calFun=this.getPoint2}x$f(x$b,"laya.maths.Bezier");var x$_=x$b.prototype;return x$_._switchPoint=function(x$b,x$_){var x$s=this._controlPoints.shift();x$s.setTo(x$b,x$_),this._controlPoints.push(x$s)},x$_.getPoint2=function(x$b,x$_){var x$s=this._controlPoints[0],x$h=this._controlPoints[1],x$x=this._controlPoints[2],x$n=Math.pow(1-x$b,2)*x$s.x+2*x$b*(1-x$b)*x$h.x+Math.pow(x$b,2)*x$x.x,x$E=Math.pow(1-x$b,2)*x$s.y+2*x$b*(1-x$b)*x$h.y+Math.pow(x$b,2)*x$x.y;x$_.push(x$n,x$E)},x$_.getPoint3=function(x$b,x$_){var x$s=this._controlPoints[0],x$h=this._controlPoints[1],x$x=this._controlPoints[2],x$n=this._controlPoints[3],x$E=Math.pow(1-x$b,3)*x$s.x+3*x$h.x*x$b*(1-x$b)*(1-x$b)+3*x$x.x*x$b*x$b*(1-x$b)+x$n.x*Math.pow(x$b,3),x$C=Math.pow(1-x$b,3)*x$s.y+3*x$h.y*x$b*(1-x$b)*(1-x$b)+3*x$x.y*x$b*x$b*(1-x$b)+x$n.y*Math.pow(x$b,3);x$_.push(x$E,x$C)},x$_.insertPoints=function(x$b,x$_){var x$s,x$h=NaN;for(x$s=1/(x$b=0<x$b?x$b:5),x$h=0;x$h<=1;x$h+=x$s)this._calFun(x$h,x$_)},x$_.getBezierPoints=function(x$b,x$_,x$s){void 0===x$_&&(x$_=5),void 0===x$s&&(x$s=2);var x$h,x$x,x$n=0;if((x$h=x$b.length)<2*(x$s+1))return[];switch(x$x=[],x$s){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=x$s;)this._controlPoints.push(new x$M);for(x$n=0;x$n<2*x$s;x$n+=2)this._switchPoint(x$b[x$n],x$b[x$n+1]);for(x$n=2*x$s;x$n<x$h;x$n+=2)this._switchPoint(x$b[x$n],x$b[x$n+1]),x$n/2%x$s==0&&this.insertPoints(x$_,x$x);return x$x},x$O(x$b,["I",function(){return this.I=new x$b}]),x$b}()),x$$=function(){function x$L(){}return x$f(x$L,"laya.maths.GrahamScan"),x$L.multiply=function(x$b,x$_,x$s){return(x$b.x-x$s.x)*(x$_.y-x$s.y)-(x$_.x-x$s.x)*(x$b.y-x$s.y)},x$L.dis=function(x$b,x$_){return(x$b.x-x$_.x)*(x$b.x-x$_.x)+(x$b.y-x$_.y)*(x$b.y-x$_.y)},x$L._getPoints=function(x$b,x$_,x$s){for(void 0===x$_&&(x$_=!1),x$L._mPointList||(x$L._mPointList=[]);x$L._mPointList.length<x$b;)x$L._mPointList.push(new x$M);return x$s||(x$s=[]),x$s.length=0,x$_?x$L.getFrom(x$s,x$L._mPointList,x$b):x$L.getFromR(x$s,x$L._mPointList,x$b),x$s},x$L.getFrom=function(x$b,x$_,x$s){var x$h=0;for(x$h=0;x$h<x$s;x$h++)x$b.push(x$_[x$h]);return x$b},x$L.getFromR=function(x$b,x$_,x$s){var x$h=0;for(x$h=0;x$h<x$s;x$h++)x$b.push(x$_.pop());return x$b},x$L.pListToPointList=function(x$b,x$_){void 0===x$_&&(x$_=!1);var x$s=0,x$h=x$b.length/2,x$x=x$L._getPoints(x$h,x$_,x$L._tempPointList);for(x$s=0;x$s<x$h;x$s++)x$x[x$s].setTo(x$b[x$s+x$s],x$b[x$s+x$s+1]);return x$x},x$L.pointListToPlist=function(x$b){var x$_,x$s=0,x$h=x$b.length,x$x=x$L._temPList;for(x$s=x$x.length=0;x$s<x$h;x$s++)x$_=x$b[x$s],x$x.push(x$_.x,x$_.y);return x$x},x$L.scanPList=function(x$b){return x$e.copyArray(x$b,x$L.pointListToPlist(x$L.scan(x$L.pListToPointList(x$b,!0))))},x$L.scan=function(x$b){var x$_,x$s,x$h,x$x=0,x$n=0,x$E=0,x$C=x$b.length,x$O={};for((x$s=x$L._temArr).length=0,x$x=(x$C=x$b.length)-1;0<=x$x;x$x--)x$h=(x$_=x$b[x$x]).x+"_"+x$_.y,x$O.hasOwnProperty(x$h)||(x$O[x$h]=!0,x$s.push(x$_));for(x$C=x$s.length,x$e.copyArray(x$b,x$s),x$x=1;x$x<x$C;x$x++)(x$b[x$x].y<x$b[x$E].y||x$b[x$x].y==x$b[x$E].y&&x$b[x$x].x<x$b[x$E].x)&&(x$E=x$x);for(x$_=x$b[0],x$b[0]=x$b[x$E],x$b[x$E]=x$_,x$x=1;x$x<x$C-1;x$x++){for(x$n=(x$E=x$x)+1;x$n<x$C;x$n++)(0<x$L.multiply(x$b[x$n],x$b[x$E],x$b[0])||0==x$L.multiply(x$b[x$n],x$b[x$E],x$b[0])&&x$L.dis(x$b[0],x$b[x$n])<x$L.dis(x$b[0],x$b[x$E]))&&(x$E=x$n);x$_=x$b[x$x],x$b[x$x]=x$b[x$E],x$b[x$E]=x$_}if((x$s=x$L._temArr).length=0,x$b.length<3)return x$e.copyArray(x$s,x$b);for(x$s.push(x$b[0],x$b[1],x$b[2]),x$x=3;x$x<x$C;x$x++){for(;2<=x$s.length&&0<=x$L.multiply(x$b[x$x],x$s[x$s.length-1],x$s[x$s.length-2]);)x$s.pop();x$b[x$x]&&x$s.push(x$b[x$x])}return x$s},x$L._mPointList=null,x$L._tempPointList=[],x$L._temPList=[],x$L._temArr=[],x$L}(),x$D=function(){function x$x(){}return x$f(x$x,"laya.maths.MathUtil"),x$x.subtractVector3=function(x$b,x$_,x$s){x$s[0]=x$b[0]-x$_[0],x$s[1]=x$b[1]-x$_[1],x$s[2]=x$b[2]-x$_[2]},x$x.lerp=function(x$b,x$_,x$s){return x$b*(1-x$s)+x$_*x$s},x$x.scaleVector3=function(x$b,x$_,x$s){x$s[0]=x$b[0]*x$_,x$s[1]=x$b[1]*x$_,x$s[2]=x$b[2]*x$_},x$x.lerpVector3=function(x$b,x$_,x$s,x$h){var x$x=x$b[0],x$n=x$b[1],x$E=x$b[2];x$h[0]=x$x+x$s*(x$_[0]-x$x),x$h[1]=x$n+x$s*(x$_[1]-x$n),x$h[2]=x$E+x$s*(x$_[2]-x$E)},x$x.lerpVector4=function(x$b,x$_,x$s,x$h){var x$x=x$b[0],x$n=x$b[1],x$E=x$b[2],x$C=x$b[3];x$h[0]=x$x+x$s*(x$_[0]-x$x),x$h[1]=x$n+x$s*(x$_[1]-x$n),x$h[2]=x$E+x$s*(x$_[2]-x$E),x$h[3]=x$C+x$s*(x$_[3]-x$C)},x$x.slerpQuaternionArray=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C,x$O,x$L,x$f,x$p,x$P=x$b[x$_+0],x$V=x$b[x$_+1],x$Q=x$b[x$_+2],x$y=x$b[x$_+3],x$w=x$s[x$h+0],x$i=x$s[x$h+1],x$R=x$s[x$h+2],x$t=x$s[x$h+3];return(x$O=x$P*x$w+x$V*x$i+x$Q*x$R+x$y*x$t)<0&&(x$O=-x$O,x$w=-x$w,x$i=-x$i,x$R=-x$R,x$t=-x$t),x$p=1e-6<1-x$O?(x$C=Math.acos(x$O),x$L=Math.sin(x$C),x$f=Math.sin((1-x$x)*x$C)/x$L,Math.sin(x$x*x$C)/x$L):(x$f=1-x$x,x$x),x$n[x$E+0]=x$f*x$P+x$p*x$w,x$n[x$E+1]=x$f*x$V+x$p*x$i,x$n[x$E+2]=x$f*x$Q+x$p*x$R,x$n[x$E+3]=x$f*x$y+x$p*x$t,x$n},x$x.getRotation=function(x$b,x$_,x$s,x$h){return Math.atan2(x$h-x$_,x$s-x$b)/Math.PI*180},x$x.sortBigFirst=function(x$b,x$_){return x$b==x$_?0:x$b<x$_?1:-1},x$x.sortSmallFirst=function(x$b,x$_){return x$b==x$_?0:x$b<x$_?-1:1},x$x.sortNumBigFirst=function(x$b,x$_){return parseFloat(x$_)-parseFloat(x$b)},x$x.sortNumSmallFirst=function(x$b,x$_){return parseFloat(x$b)-parseFloat(x$_)},x$x.sortByKey=function(x$s,x$b,x$_){var x$h;return void 0===x$b&&(x$b=!1),void 0===x$_&&(x$_=!0),x$h=x$b?x$_?x$x.sortNumBigFirst:x$x.sortBigFirst:x$_?x$x.sortNumSmallFirst:x$x.sortSmallFirst,function(x$b,x$_){return x$h(x$b[x$s],x$_[x$s])}},x$x}(),x$J=function(){function x$s(x$b,x$_,x$s,x$h,x$x,x$n){this.inPool=!1,this.bTransform=!1,void 0===x$b&&(x$b=1),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=1),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=0),this.a=x$b,this.b=x$_,this.c=x$s,this.d=x$h,this.tx=x$x,this.ty=x$n,this._checkTransform()}x$f(x$s,"laya.maths.Matrix");var x$b=x$s.prototype;return x$b.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},x$b._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},x$b.setTranslate=function(x$b,x$_){return this.tx=x$b,this.ty=x$_,this},x$b.translate=function(x$b,x$_){return this.tx+=x$b,this.ty+=x$_,this},x$b.scale=function(x$b,x$_){this.a*=x$b,this.d*=x$_,this.c*=x$b,this.b*=x$_,this.tx*=x$b,this.ty*=x$_,this.bTransform=!0},x$b.rotate=function(x$b){var x$_=Math.cos(x$b),x$s=Math.sin(x$b),x$h=this.a,x$x=this.c,x$n=this.tx;this.a=x$h*x$_-this.b*x$s,this.b=x$h*x$s+this.b*x$_,this.c=x$x*x$_-this.d*x$s,this.d=x$x*x$s+this.d*x$_,this.tx=x$n*x$_-this.ty*x$s,this.ty=x$n*x$s+this.ty*x$_,this.bTransform=!0},x$b.skew=function(x$b,x$_){var x$s=Math.tan(x$b),x$h=Math.tan(x$_),x$x=this.a,x$n=this.b;return this.a+=x$h*this.c,this.b+=x$h*this.d,this.c+=x$s*x$x,this.d+=x$s*x$n,this},x$b.invertTransformPoint=function(x$b){var x$_=this.a,x$s=this.b,x$h=this.c,x$x=this.d,x$n=this.tx,x$E=x$_*x$x-x$s*x$h,x$C=x$x/x$E,x$O=-x$s/x$E,x$L=-x$h/x$E,x$f=x$_/x$E,x$p=(x$h*this.ty-x$x*x$n)/x$E,x$P=-(x$_*this.ty-x$s*x$n)/x$E;return x$b.setTo(x$C*x$b.x+x$L*x$b.y+x$p,x$O*x$b.x+x$f*x$b.y+x$P)},x$b.transformPoint=function(x$b){return x$b.setTo(this.a*x$b.x+this.c*x$b.y+this.tx,this.b*x$b.x+this.d*x$b.y+this.ty)},x$b.transformPointN=function(x$b){return x$b.setTo(this.a*x$b.x+this.c*x$b.y,this.b*x$b.x+this.d*x$b.y)},x$b.transformPointArray=function(x$b,x$_){for(var x$s=x$b.length,x$h=0;x$h<x$s;x$h+=2){var x$x=x$b[x$h],x$n=x$b[x$h+1];x$_[x$h]=this.a*x$x+this.c*x$n+this.tx,x$_[x$h+1]=this.b*x$x+this.d*x$n+this.ty}return x$_},x$b.transformPointArrayScale=function(x$b,x$_){for(var x$s=x$b.length,x$h=0;x$h<x$s;x$h+=2){var x$x=x$b[x$h],x$n=x$b[x$h+1];x$_[x$h]=this.a*x$x+this.c*x$n,x$_[x$h+1]=this.b*x$x+this.d*x$n}return x$_},x$b.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},x$b.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},x$b.invert=function(){var x$b=this.a,x$_=this.b,x$s=this.c,x$h=this.d,x$x=this.tx,x$n=x$b*x$h-x$_*x$s;return this.a=x$h/x$n,this.b=-x$_/x$n,this.c=-x$s/x$n,this.d=x$b/x$n,this.tx=(x$s*this.ty-x$h*x$x)/x$n,this.ty=-(x$b*this.ty-x$_*x$x)/x$n,this},x$b.setTo=function(x$b,x$_,x$s,x$h,x$x,x$n){return this.a=x$b,this.b=x$_,this.c=x$s,this.d=x$h,this.tx=x$x,this.ty=x$n,this},x$b.concat=function(x$b){var x$_=this.a,x$s=this.c,x$h=this.tx;return this.a=x$_*x$b.a+this.b*x$b.c,this.b=x$_*x$b.b+this.b*x$b.d,this.c=x$s*x$b.a+this.d*x$b.c,this.d=x$s*x$b.b+this.d*x$b.d,this.tx=x$h*x$b.a+this.ty*x$b.c+x$b.tx,this.ty=x$h*x$b.b+this.ty*x$b.d+x$b.ty,this},x$b.scaleEx=function(x$b,x$_){var x$s=this.a,x$h=this.b,x$x=this.c,x$n=this.d;0!==x$h||0!==x$x?(this.a=x$b*x$s,this.b=x$b*x$h,this.c=x$_*x$x):(this.a=x$b*x$s,this.b=0*x$n,this.c=0*x$s),this.d=x$_*x$n,this.bTransform=!0},x$b.rotateEx=function(x$b){var x$_=Math.cos(x$b),x$s=Math.sin(x$b),x$h=this.a,x$x=this.b,x$n=this.c,x$E=this.d;0!==x$x||0!==x$n?(this.a=x$_*x$h+x$s*x$n,this.b=x$_*x$x+x$s*x$E,this.c=-x$s*x$h+x$_*x$n,this.d=-x$s*x$x+x$_*x$E):(this.a=x$_*x$h,this.b=x$s*x$E,this.c=-x$s*x$h,this.d=x$_*x$E),this.bTransform=!0},x$b.clone=function(){var x$b=x$s.create();return x$b.a=this.a,x$b.b=this.b,x$b.c=this.c,x$b.d=this.d,x$b.tx=this.tx,x$b.ty=this.ty,x$b.bTransform=this.bTransform,x$b},x$b.copyTo=function(x$b){return x$b.a=this.a,x$b.b=this.b,x$b.c=this.c,x$b.d=this.d,x$b.tx=this.tx,x$b.ty=this.ty,x$b.bTransform=this.bTransform,x$b},x$b.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},x$b.destroy=function(){if(!this.inPool){var x$b=x$s._cache;this.inPool=!0,x$b._length||(x$b._length=0),(x$b[x$b._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},x$s.mul=function(x$b,x$_,x$s){var x$h=x$b.a,x$x=x$b.b,x$n=x$b.c,x$E=x$b.d,x$C=x$b.tx,x$O=x$b.ty,x$L=x$_.a,x$f=x$_.b,x$p=x$_.c,x$P=x$_.d,x$V=x$_.tx,x$Q=x$_.ty;return 0!==x$f||0!==x$p?(x$s.a=x$h*x$L+x$x*x$p,x$s.b=x$h*x$f+x$x*x$P,x$s.c=x$n*x$L+x$E*x$p,x$s.d=x$n*x$f+x$E*x$P,x$s.tx=x$L*x$C+x$p*x$O+x$V,x$s.ty=x$f*x$C+x$P*x$O+x$Q):(x$s.a=x$h*x$L,x$s.b=x$x*x$P,x$s.c=x$n*x$L,x$s.d=x$E*x$P,x$s.tx=x$L*x$C+x$V,x$s.ty=x$P*x$O+x$Q),x$s},x$s.mul16=function(x$b,x$_,x$s){var x$h=x$b.a,x$x=x$b.b,x$n=x$b.c,x$E=x$b.d,x$C=x$b.tx,x$O=x$b.ty,x$L=x$_.a,x$f=x$_.b,x$p=x$_.c,x$P=x$_.d,x$V=x$_.tx,x$Q=x$_.ty;return 0!==x$f||0!==x$p?(x$s[0]=x$h*x$L+x$x*x$p,x$s[1]=x$h*x$f+x$x*x$P,x$s[4]=x$n*x$L+x$E*x$p,x$s[5]=x$n*x$f+x$E*x$P,x$s[12]=x$L*x$C+x$p*x$O+x$V,x$s[13]=x$f*x$C+x$P*x$O+x$Q):(x$s[0]=x$h*x$L,x$s[1]=x$x*x$P,x$s[4]=x$n*x$L,x$s[5]=x$E*x$P,x$s[12]=x$L*x$C+x$V,x$s[13]=x$P*x$O+x$Q),x$s},x$s.mulPre=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=x$b.a,x$L=x$b.b,x$f=x$b.c,x$p=x$b.d,x$P=x$b.tx,x$V=x$b.ty;return 0!==x$s||0!==x$h?(x$C.a=x$O*x$_+x$L*x$h,x$C.b=x$O*x$s+x$L*x$x,x$C.c=x$f*x$_+x$p*x$h,x$C.d=x$f*x$s+x$p*x$x,x$C.tx=x$_*x$P+x$h*x$V+x$n,x$C.ty=x$s*x$P+x$x*x$V+x$E):(x$C.a=x$O*x$_,x$C.b=x$L*x$x,x$C.c=x$f*x$_,x$C.d=x$p*x$x,x$C.tx=x$_*x$P+x$n,x$C.ty=x$x*x$V+x$E),x$C},x$s.mulPos=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=x$b.a,x$L=x$b.b,x$f=x$b.c,x$p=x$b.d,x$P=x$b.tx,x$V=x$b.ty;return 0!==x$L||0!==x$f?(x$C.a=x$_*x$O+x$s*x$f,x$C.b=x$_*x$L+x$s*x$p,x$C.c=x$h*x$O+x$x*x$f,x$C.d=x$h*x$L+x$x*x$p,x$C.tx=x$O*x$n+x$f*x$E+x$P,x$C.ty=x$L*x$n+x$p*x$E+x$V):(x$C.a=x$_*x$O,x$C.b=x$s*x$p,x$C.c=x$h*x$O,x$C.d=x$x*x$p,x$C.tx=x$O*x$n+x$P,x$C.ty=x$p*x$E+x$V),x$C},x$s.preMul=function(x$b,x$_,x$s){var x$h=x$b.a,x$x=x$b.b,x$n=x$b.c,x$E=x$b.d,x$C=x$_.a,x$O=x$_.b,x$L=x$_.c,x$f=x$_.d,x$p=x$_.tx,x$P=x$_.ty;return x$s.a=x$C*x$h,x$s.b=x$s.c=0,x$s.d=x$f*x$E,x$s.tx=x$p*x$h+x$b.tx,x$s.ty=x$P*x$E+x$b.ty,0===x$O&&0===x$L&&0===x$x&&0===x$n||(x$s.a+=x$O*x$n,x$s.d+=x$L*x$x,x$s.b+=x$C*x$x+x$O*x$E,x$s.c+=x$L*x$h+x$f*x$n,x$s.tx+=x$P*x$n,x$s.ty+=x$p*x$x),x$s},x$s.preMulXY=function(x$b,x$_,x$s,x$h){var x$x=x$b.a,x$n=x$b.b,x$E=x$b.c,x$C=x$b.d;return x$h.a=x$x,x$h.b=x$n,x$h.c=x$E,x$h.d=x$C,x$h.tx=x$_*x$x+x$b.tx+x$s*x$E,x$h.ty=x$s*x$C+x$b.ty+x$_*x$n,x$h},x$s.create=function(){var x$b=x$s._cache,x$_=x$b._length?x$b[--x$b._length]:new x$s;return x$_.inPool=!1,x$_},x$s.EMPTY=new x$s,x$s.TEMP=new x$s,x$s._cache=[],x$s}(),x$M=function(){function x$b(x$b,x$_){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),this.x=x$b,this.y=x$_}x$f(x$b,"laya.maths.Point");var x$_=x$b.prototype;return x$_.setTo=function(x$b,x$_){return this.x=x$b,this.y=x$_,this},x$_.distance=function(x$b,x$_){return Math.sqrt((this.x-x$b)*(this.x-x$b)+(this.y-x$_)*(this.y-x$_))},x$_.toString=function(){return this.x+","+this.y},x$_.normalize=function(){var x$b=Math.sqrt(this.x*this.x+this.y*this.y);if(0<x$b){var x$_=1/x$b;this.x*=x$_,this.y*=x$_}},x$b.TEMP=new x$b,x$b.EMPTY=new x$b,x$b}(),x$r=function(){function x$L(x$b,x$_,x$s,x$h){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),this.x=x$b,this.y=x$_,this.width=x$s,this.height=x$h}x$f(x$L,"laya.maths.Rectangle");var x$b=x$L.prototype;return x$b.setTo=function(x$b,x$_,x$s,x$h){return this.x=x$b,this.y=x$_,this.width=x$s,this.height=x$h,this},x$b.copyFrom=function(x$b){return this.x=x$b.x,this.y=x$b.y,this.width=x$b.width,this.height=x$b.height,this},x$b.contains=function(x$b,x$_){return!(this.width<=0||this.height<=0)&&(x$b>=this.x&&x$b<this.right&&x$_>=this.y&&x$_<this.bottom)},x$b.intersects=function(x$b){return!(x$b.x>this.x+this.width||x$b.x+x$b.width<this.x||x$b.y>this.y+this.height||x$b.y+x$b.height<this.y)},x$b.intersection=function(x$b,x$_){return this.intersects(x$b)?(x$_||(x$_=new x$L),x$_.x=Math.max(this.x,x$b.x),x$_.y=Math.max(this.y,x$b.y),x$_.width=Math.min(this.right,x$b.right)-x$_.x,x$_.height=Math.min(this.bottom,x$b.bottom)-x$_.y,x$_):null},x$b.union=function(x$b,x$_){return x$_||(x$_=new x$L),this.clone(x$_),x$b.width<=0||x$b.height<=0?x$_:(x$_.addPoint(x$b.x,x$b.y),x$_.addPoint(x$b.right,x$b.bottom),this)},x$b.clone=function(x$b){return x$b||(x$b=new x$L),x$b.x=this.x,x$b.y=this.y,x$b.width=this.width,x$b.height=this.height,x$b},x$b.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},x$b.equals=function(x$b){return!(!x$b||x$b.x!==this.x||x$b.y!==this.y||x$b.width!==this.width||x$b.height!==this.height)},x$b.addPoint=function(x$b,x$_){return this.x>x$b&&(this.width+=this.x-x$b,this.x=x$b),this.y>x$_&&(this.height+=this.y-x$_,this.y=x$_),this.width<x$b-this.x&&(this.width=x$b-this.x),this.height<x$_-this.y&&(this.height=x$_-this.y),this},x$b._getBoundPoints=function(){var x$b=x$L._temB;return(x$b.length=0)==this.width||0==this.height||x$b.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),x$b},x$b.isEmpty=function(){return this.width<=0||this.height<=0},x$Q(0,x$b,"right",function(){return this.x+this.width}),x$Q(0,x$b,"bottom",function(){return this.y+this.height}),x$L._getBoundPointS=function(x$b,x$_,x$s,x$h){var x$x=x$L._temA;return(x$x.length=0)==x$s||0==x$h||x$x.push(x$b,x$_,x$b+x$s,x$_,x$b,x$_+x$h,x$b+x$s,x$_+x$h),x$x},x$L._getWrapRec=function(x$b,x$_){if(!x$b||x$b.length<1)return x$_?x$_.setTo(0,0,0,0):x$L.TEMP.setTo(0,0,0,0);x$_=x$_||new x$L;var x$s,x$h,x$x,x$n,x$E,x$C=x$b.length,x$O=x$M.TEMP;for(x$x=x$E=-(x$h=x$n=99999),x$s=0;x$s<x$C;x$s+=2)x$O.x=x$b[x$s],x$O.y=x$b[x$s+1],x$h=x$h<x$O.x?x$h:x$O.x,x$n=x$n<x$O.y?x$n:x$O.y,x$x=x$x>x$O.x?x$x:x$O.x,x$E=x$E>x$O.y?x$E:x$O.y;return x$_.setTo(x$h,x$n,x$x-x$h,x$E-x$n)},x$L.EMPTY=new x$L,x$L.TEMP=new x$L,x$L._temB=[],x$L._temA=[],x$L}(),x$S=function(){function x$O(){}return x$f(x$O,"laya.media.SoundManager"),x$Q(1,x$O,"useAudioMusic",function(){return x$O._useAudioMusic},function(x$b){x$O._useAudioMusic=x$b,x$O._musicClass=x$b?x$sb:null}),x$Q(1,x$O,"autoStopMusic",function(){return x$O._autoStopMusic},function(x$b){x$o.stage.off("blur",null,x$O._stageOnBlur),x$o.stage.off("focus",null,x$O._stageOnFocus),x$o.stage.off("visibilitychange",null,x$O._visibilityChange),(x$O._autoStopMusic=x$b)&&(x$o.stage.on("blur",null,x$O._stageOnBlur),x$o.stage.on("focus",null,x$O._stageOnFocus),x$o.stage.on("visibilitychange",null,x$O._visibilityChange))}),x$Q(1,x$O,"muted",function(){return x$O._muted},function(x$b){x$b!=x$O._muted&&(x$b&&x$O.stopAllSound(),x$O.musicMuted=x$b,x$O._muted=x$b)}),x$Q(1,x$O,"musicMuted",function(){return x$O._musicMuted},function(x$b){x$b!=x$O._musicMuted&&(x$b?(x$O._tMusic&&x$O._musicChannel&&!x$O._musicChannel.isStopped?x$O._musicChannel.pause():x$O._musicChannel=null,x$O._musicMuted=x$b):(x$O._musicMuted=x$b,x$O._tMusic&&x$O._musicChannel&&x$O._musicChannel.resume()))}),x$Q(1,x$O,"soundMuted",function(){return x$O._soundMuted},function(x$b){x$O._soundMuted=x$b}),x$O.addChannel=function(x$b){0<=x$O._channels.indexOf(x$b)||(x$O._channels.push(x$b),x$O.autoReleaseSound&&0!=x$O._notUsedCount&&x$O._notUsedUrls[x$b.url]&&(delete x$O._notUsedUrls[x$b.url],0==--x$O._notUsedCount&&x$o.timer.clear(x$O,x$O.disposeSoundIfNotUsed)))},x$O.removeChannel=function(x$b){var x$_=x$O._channels,x$s=x$_.indexOf(x$b);if(-1!=x$s&&(x$_.splice(x$s,1),x$O.autoReleaseSound)){var x$h=x$b.url,x$x=x$O.defaultIntervals[x$h]||2e4;if(0<x$x){var x$n=!0;for(x$s=x$_.length-1;0<=x$s;x$s--)if(x$_[x$s].url==x$h){x$n=!1;break}x$n&&(x$O._notUsedUrls[x$h]=Date.now()+x$x,0==x$O._notUsedCount++&&x$o.timer.loop(1e4,x$O,x$O.disposeSoundIfNotUsed))}}},x$O.disposeSoundIfNotUsed=function(){var x$b=x$O._notUsedUrls;if(0!=x$O._notUsedCount){var x$_=Date.now();for(var x$s in x$b)x$_>=x$b[x$s]&&(delete x$b[x$s],--x$O._notUsedCount,x$O.destroySound(x$s));if(0!=x$O._notUsedCount)return}x$o.timer.clear(x$O,x$O.disposeSoundIfNotUsed)},x$O._visibilityChange=function(){x$o.stage.isVisibility?x$O._stageOnFocus():x$O._stageOnBlur()},x$O._stageOnBlur=function(){x$O._isActive=!1,x$O._musicChannel&&(x$O._musicChannel.isStopped||(x$O._blurPaused=!0,x$O._musicChannel.pause())),x$O.stopAllSound(),x$o.stage.once("mousedown",null,x$O._stageOnFocus)},x$O._recoverWebAudio=function(){x$nb.ctx&&"running"!=x$nb.ctx.state&&x$nb.ctx.resume&&x$nb.ctx.resume()},x$O._stageOnFocus=function(){if(x$O._isActive=!0,x$O._recoverWebAudio(),x$o.stage.off("mousedown",null,x$O._stageOnFocus),x$O._blurPaused){var x$b=x$O._musicChannel;x$b&&x$O._music&&x$b.isStopped&&(x$O._blurPaused=!1,x$O._music._disposed?x$O.playMusic(x$b.url,x$b.loops,x$b.startHandler,x$b.completeHandler,x$b.startTime):x$b.audioBuffer?x$b.resume():x$O._music.play(x$b.startTime,x$b.loops,x$b.startHandler,x$b))}},x$O.playSound=function(x$b,x$_,x$s,x$h,x$x,x$n){if(void 0===x$_&&(x$_=1),void 0===x$n&&(x$n=0),!x$b)return null;if(x$O._muted)return null;if(x$O._recoverWebAudio(),x$b==x$O._tMusic){if(x$O._musicMuted)return null}else{if(!x$O._isActive)return null;if(x$O._soundMuted)return null}var x$E,x$C=x$O._pool[x$b];return x$x||(x$x=x$O._soundClass),x$C||((x$C=new x$x).load(x$b),x$O._pool[x$b]=x$C),(x$E=x$C.play(x$n,x$_,x$s))?(x$b==x$O._tMusic&&(x$O._music=x$C,x$O._isActive||(x$O._blurPaused=!0,x$E.pause())),x$E.url=x$b,x$E.volume=x$b==x$O._tMusic?x$O.musicVolume:x$O.soundVolume,x$E.completeHandler=x$h,x$E):null},x$O.destroySound=function(x$b){var x$_=x$O._pool[x$b];x$_&&(delete x$O._pool[x$b],x$_.dispose())},x$O.playMusic=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$_&&(x$_=0),void 0===x$x&&(x$x=0),x$O._tMusic=x$b,x$O._musicChannel&&x$O._musicChannel.stop(),x$O._musicChannel=x$O.playSound(x$b,x$_,x$s,x$h,null,x$x)},x$O.stopSound=function(x$b){for(var x$_,x$s=x$O._channels.length-1;0<=x$s;x$s--)(x$_=x$O._channels[x$s]).url==x$b&&x$_.stop()},x$O.stopAll=function(){x$O._tMusic=null;var x$b=0;for(x$b=x$O._channels.length-1;0<=x$b;x$b--)x$O._channels[x$b].stop()},x$O.stopAllSound=function(){var x$b,x$_=0;for(x$_=x$O._channels.length-1;0<=x$_;x$_--)(x$b=x$O._channels[x$_]).url!=x$O._tMusic&&x$b.stop()},x$O.stopMusic=function(){x$O._musicChannel&&x$O._musicChannel.stop(),x$O._tMusic=null},x$O.setSoundVolume=function(x$b,x$_){if(x$_)x$O._setVolume(x$_,x$b);else{x$O.soundVolume=x$b;var x$s,x$h=0;for(x$h=x$O._channels.length-1;0<=x$h;x$h--)(x$s=x$O._channels[x$h]).url!=x$O._tMusic&&(x$s.volume=x$b)}},x$O.setMusicVolume=function(x$b){x$O.musicVolume=x$b,x$O._setVolume(x$O._tMusic,x$b)},x$O._setVolume=function(x$b,x$_){for(var x$s,x$h=x$O._channels.length-1;0<=x$h;x$h--)(x$s=x$O._channels[x$h]).url==x$b&&(x$s.volume=x$_)},x$O.musicVolume=1,x$O.soundVolume=1,x$O.playbackRate=1,x$O._useAudioMusic=!0,x$O._muted=!1,x$O._soundMuted=!1,x$O._musicMuted=!1,x$O._tMusic=null,x$O._musicChannel=null,x$O._music=null,x$O._channels=[],x$O._autoStopMusic=!1,x$O._blurPaused=!1,x$O._isActive=!0,x$O._soundClass=null,x$O._musicClass=null,x$O.autoReleaseSound=!0,x$O._pool={},x$O.defaultIntervals={},x$O._notUsedUrls={},x$O._notUsedCount=0,x$O}(),x$k=function(){var x$b;function x$s(){}return x$f(x$s,"laya.net.LocalStorage"),x$s.__init__=function(){x$s._baseClass||(x$s._baseClass=x$b).init(),x$s.items=x$s._baseClass.items,x$s.support=x$s._baseClass.support},x$s.setItem=function(x$b,x$_){x$s._baseClass.setItem(x$b,x$_)},x$s.getItem=function(x$b){return x$s._baseClass.getItem(x$b)},x$s.setJSON=function(x$b,x$_){x$s._baseClass.setJSON(x$b,x$_)},x$s.getJSON=function(x$b){return x$s._baseClass.getJSON(x$b)},x$s.removeItem=function(x$b){x$s._baseClass.removeItem(x$b)},x$s.clear=function(){x$s._baseClass.clear()},x$s._baseClass=null,x$s.items=null,x$s.support=!1,x$s.__init$=function(){x$b=function(){function x$s(){}return x$f(x$s,""),x$s.init=function(){try{x$s.support=!0,x$s.items=x$E.localStorage,x$s.setItem("laya","1"),x$s.removeItem("laya")}catch(x$b){x$s.support=!1}x$s.support||console.log("LocalStorage is not supprot or browser is private mode.")},x$s.setItem=function(x$b,x$_){try{x$s.support&&x$s.items.setItem(x$b,x$_)}catch(x$b){console.warn("set localStorage failed",x$b)}},x$s.getItem=function(x$b){return x$s.support?x$s.items.getItem(x$b):null},x$s.setJSON=function(x$b,x$_){try{x$s.support&&x$s.items.setItem(x$b,JSON.stringify(x$_))}catch(x$b){console.warn("set localStorage failed",x$b)}},x$s.getJSON=function(x$b){return JSON.parse(x$s.support?x$s.items.getItem(x$b):null)},x$s.removeItem=function(x$b){x$s.support&&x$s.items.removeItem(x$b)},x$s.clear=function(){x$s.support&&x$s.items.clear()},x$s.items=null,x$s.support=!1,x$s}()},x$s}(),x$W=(function(){function x$h(){}x$f(x$h,"laya.net.ResourceVersion"),x$h.enable=function(x$b,x$_,x$s){void 0===x$s&&(x$s=2),laya.net.ResourceVersion.type=x$s,x$o.loader.load(x$b,x$R.create(null,x$h.onManifestLoaded,[x$_]),null,"json"),x$T.customFormat=x$h.addVersionPrefix},x$h.onManifestLoaded=function(x$b,x$_){x$h.manifest=x$_,x$b.run(),x$_||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},x$h.addVersionPrefix=function(x$b){return x$h.manifest&&x$h.manifest[x$b]?2==x$h.type?x$h.manifest[x$b]:x$h.manifest[x$b]+"/"+x$b:x$b},x$h.FOLDER_VERSION=1,x$h.FILENAME_VERSION=2,x$h.manifest=null,x$h.type=1}(),function(){function x$b(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}x$f(x$b,"laya.net.TTFLoader");var x$_=x$b.prototype;return x$_.load=function(x$b){var x$_=(this._url=x$b).split(".ttf")[0].split("/");this.fontName=x$_[x$_.length-1],x$K.window.conch?this._loadConch():x$K.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},x$_._loadConch=function(){this._http=new x$Eb,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},x$_._onHttpLoaded=function(x$b){x$K.window.conch.setFontFaceFromBuffer(this.fontName,x$b),this._clearHttp(),this._complete()},x$_._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},x$_._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},x$_._complete=function(){x$o.timer.clear(this,this._complete),x$o.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},x$_._checkComplete=function(){x$Z.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},x$_._loadWithFontFace=function(){var x$b=new x$K.window.FontFace(this.fontName,"url('"+this._url+"')");x$K.window.document.fonts.add(x$b);var x$_=this;x$b.loaded.then(function(){x$_._complete()}),x$b.load()},x$_._createDiv=function(){this._div=x$K.createElement("div"),this._div.innerHTML="laya";var x$b=this._div.style;x$b.fontFamily=this.fontName,x$b.position="absolute",x$b.left="-100px",x$b.top="-100px",x$K.document.body.appendChild(this._div)},x$_._loadWithCSS=function(){var x$b=this,x$_=x$K.createElement("style");x$_.type="text/css",x$K.document.body.appendChild(x$_),x$_.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=x$Z.measureText("LayaTTFFont",this._fontTxt).width;var x$s=this;x$_.onload=function(){x$o.timer.once(1e4,x$s,x$b._complete)},x$o.timer.loop(20,this,this._checkComplete),this._createDiv()},x$b._testString="LayaTTFFont",x$b}()),x$T=function(){function x$h(x$b){this._url=null,this._path=null,this._url=x$h.formatURL(x$b),this._path=x$h.getPath(x$b)}x$f(x$h,"laya.net.URL");var x$b=x$h.prototype;return x$Q(0,x$b,"path",function(){return this._path}),x$Q(0,x$b,"url",function(){return this._url}),x$h.formatURL=function(x$b,x$_){if(!x$b)return"null path";if(0<x$b.indexOf(":"))return x$b;null!=x$h.customFormat&&(x$b=x$h.customFormat(x$b,x$_));var x$s=x$b.charAt(0);if("."===x$s)return x$h.formatRelativePath((x$_||x$h.basePath)+x$b);if("~"===x$s)return x$h.rootPath+x$b.substring(1);if("d"===x$s){if(0===x$b.indexOf("data:image"))return x$b}else if("/"===x$s)return x$b;return(x$_||x$h.basePath)+x$b},x$h.formatRelativePath=function(x$b){for(var x$_=x$b.split("/"),x$s=0,x$h=x$_.length;x$s<x$h;x$s++)".."==x$_[x$s]&&(x$_.splice(x$s-1,2),x$s-=2);return x$_.join("/")},x$h.isAbsolute=function(x$b){return 0<x$b.indexOf(":")||"/"==x$b.charAt(0)},x$h.getPath=function(x$b){var x$_=x$b.lastIndexOf("/");return 0<x$_?x$b.substr(0,x$_+1):""},x$h.getFileName=function(x$b){var x$_=x$b.lastIndexOf("/");return 0<x$_?x$b.substr(x$_+1):x$b},x$h.version={},x$h.basePath="",x$h.rootPath="",x$h.customFormat=function(x$b){var x$_=x$h.version[x$b];return!x$q.isConchApp&&x$_&&(x$b+="?v="+x$_),x$b},x$h}(),x$q=function(){function x$x(x$b,x$_){this._timeId=0;var x$s=x$x._mainCanvas.source.style;x$s.position="absolute",x$s.top=x$s.left="0px",x$s.background="#000000",x$x._mainCanvas.source.id="layaCanvas";var x$h=laya.renders.Render.isWebGL;x$x._mainCanvas.source.width=x$b,x$x._mainCanvas.source.height=x$_,x$h&&x$x.WebGL.init(x$x._mainCanvas,x$b,x$_),x$K.container.appendChild(x$x._mainCanvas.source),(x$x._context=new x$U(x$b,x$_,x$h?null:x$x._mainCanvas)).ctx.setIsMainContext(),x$K.window.requestAnimationFrame(function x$b(x$_){x$K.window.requestAnimationFrame(x$b);x$o.stage._loop()}),x$o.stage.on("visibilitychange",this,this._onVisibilitychange)}x$f(x$x,"laya.renders.Render");var x$b=x$x.prototype;return x$b._onVisibilitychange=function(){x$o.stage.isVisibility?0!=this._timeId&&x$K.window.clearInterval(this._timeId):this._timeId=x$K.window.setInterval(this._enterFrame,1e3)},x$b._enterFrame=function(x$b){x$o.stage._loop()},x$Q(1,x$x,"context",function(){return x$x._context}),x$Q(1,x$x,"canvas",function(){return x$x._mainCanvas.source}),x$x._context=null,x$x._mainCanvas=null,x$x.WebGL=null,x$x.isConchNode=!1,x$x.isConchApp=!1,x$x.isConchWebGL=!1,x$x.isWebGL=!1,x$x.is3DMode=!1,x$x.optimizeTextureMemory=function(x$b,x$_){return!0},x$x.__init$=function(){x$E.ConchRenderType=x$E.ConchRenderType||1,x$E.ConchRenderType|=x$E.conch?4:0,x$x.isConchNode=5==(5&x$E.ConchRenderType),x$x.isConchApp=4==(4&x$E.ConchRenderType),x$x.isConchWebGL=6==x$E.ConchRenderType},x$x}(),x$U=function(){function x$E(x$b,x$_,x$s){this.x=0,this.y=0,this._drawTexture=function(x$b,x$_,x$s){x$s[0].loaded&&this.ctx.drawTexture(x$s[0],x$s[1],x$s[2],x$s[3],x$s[4],x$b,x$_)},this._fillTexture=function(x$b,x$_,x$s){x$s[0].loaded&&this.ctx.fillTexture(x$s[0],x$s[1]+x$b,x$s[2]+x$_,x$s[3],x$s[4],x$s[5],x$s[6],x$s[7])},this._drawTextureWithTransform=function(x$b,x$_,x$s){x$s[0].loaded&&this.ctx.drawTextureWithTransform(x$s[0],x$s[1],x$s[2],x$s[3],x$s[4],x$s[5],x$b,x$_,x$s[6])},this._fillQuadrangle=function(x$b,x$_,x$s){this.ctx.fillQuadrangle(x$s[0],x$s[1],x$s[2],x$s[3],x$s[4])},this._drawRect=function(x$b,x$_,x$s){var x$h=this.ctx;null!=x$s[4]&&(x$h.fillStyle=x$s[4],x$h.fillRect(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3],null)),null!=x$s[5]&&(x$h.strokeStyle=x$s[5],x$h.lineWidth=x$s[6],x$h.strokeRect(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3],x$s[6]))},this._drawPie=function(x$b,x$_,x$s){var x$h=this.ctx;x$q.isWebGL&&x$h.setPathId(x$s[8]),x$h.beginPath(),x$q.isWebGL?(x$h.movePath(x$s[0]+x$b,x$s[1]+x$_),x$h.moveTo(0,0)):x$h.moveTo(x$b+x$s[0],x$_+x$s[1]),x$h.arc(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3],x$s[4]),x$h.closePath(),this._fillAndStroke(x$s[5],x$s[6],x$s[7],!0)},this._clipRect=function(x$b,x$_,x$s){this.ctx.clipRect(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3])},this._fillRect=function(x$b,x$_,x$s){this.ctx.fillRect(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3],x$s[4])},this._drawCircle=function(x$b,x$_,x$s){var x$h=this.ctx;x$q.isWebGL&&x$h.setPathId(x$s[6]),x$X.drawCall++,x$h.beginPath(),x$q.isWebGL&&x$h.movePath(x$s[0]+x$b,x$s[1]+x$_),x$h.arc(x$s[0]+x$b,x$s[1]+x$_,x$s[2],0,x$E.PI2),x$h.closePath(),this._fillAndStroke(x$s[3],x$s[4],x$s[5],!0)},this._fillCircle=function(x$b,x$_,x$s){x$X.drawCall++;var x$h=this.ctx;x$h.beginPath(),x$h.fillStyle=x$s[3],x$h.arc(x$s[0]+x$b,x$s[1]+x$_,x$s[2],0,x$E.PI2),x$h.fill()},this._setShader=function(x$b,x$_,x$s){this.ctx.setShader(x$s[0])},this._drawLine=function(x$b,x$_,x$s){var x$h=this.ctx;x$q.isWebGL&&x$h.setPathId(x$s[6]),x$h.beginPath(),x$h.strokeStyle=x$s[4],x$h.lineWidth=x$s[5],x$q.isWebGL?(x$h.movePath(x$b,x$_),x$h.moveTo(x$s[0],x$s[1]),x$h.lineTo(x$s[2],x$s[3])):(x$h.moveTo(x$b+x$s[0],x$_+x$s[1]),x$h.lineTo(x$b+x$s[2],x$_+x$s[3])),x$h.stroke()},this._drawLines=function(x$b,x$_,x$s){var x$h=this.ctx;x$q.isWebGL&&x$h.setPathId(x$s[5]),x$h.beginPath(),x$b+=x$s[0],x$_+=x$s[1],x$q.isWebGL&&x$h.movePath(x$b,x$_),x$h.strokeStyle=x$s[3],x$h.lineWidth=x$s[4];var x$x=x$s[2],x$n=2,x$E=x$x.length;if(x$q.isWebGL)for(x$h.moveTo(x$x[0],x$x[1]);x$n<x$E;)x$h.lineTo(x$x[x$n++],x$x[x$n++]);else for(x$h.moveTo(x$b+x$x[0],x$_+x$x[1]);x$n<x$E;)x$h.lineTo(x$b+x$x[x$n++],x$_+x$x[x$n++]);x$h.stroke()},this._drawLinesWebGL=function(x$b,x$_,x$s){this.ctx.drawLines(x$b+this.x+x$s[0],x$_+this.y+x$s[1],x$s[2],x$s[3],x$s[4])},this._drawCurves=function(x$b,x$_,x$s){this.ctx.drawCurves(x$b,x$_,x$s)},this._draw=function(x$b,x$_,x$s){x$s[0].call(null,this,x$b,x$_)},this._transformByMatrix=function(x$b,x$_,x$s){this.ctx.transformByMatrix(x$s[0])},this._setTransform=function(x$b,x$_,x$s){this.ctx.setTransform(x$s[0],x$s[1],x$s[2],x$s[3],x$s[4],x$s[5])},this._setTransformByMatrix=function(x$b,x$_,x$s){this.ctx.setTransformByMatrix(x$s[0])},this._save=function(x$b,x$_,x$s){this.ctx.save()},this._restore=function(x$b,x$_,x$s){this.ctx.restore()},this._translate=function(x$b,x$_,x$s){this.ctx.translate(x$s[0],x$s[1])},this._transform=function(x$b,x$_,x$s){this.ctx.translate(x$s[1]+x$b,x$s[2]+x$_);var x$h=x$s[0];this.ctx.transform(x$h.a,x$h.b,x$h.c,x$h.d,x$h.tx,x$h.ty),this.ctx.translate(-x$b-x$s[1],-x$_-x$s[2])},this._rotate=function(x$b,x$_,x$s){this.ctx.translate(x$s[1]+x$b,x$s[2]+x$_),this.ctx.rotate(x$s[0]),this.ctx.translate(-x$b-x$s[1],-x$_-x$s[2])},this._scale=function(x$b,x$_,x$s){this.ctx.translate(x$s[2]+x$b,x$s[3]+x$_),this.ctx.scale(x$s[0],x$s[1]),this.ctx.translate(-x$b-x$s[2],-x$_-x$s[3])},this._alpha=function(x$b,x$_,x$s){this.ctx.globalAlpha*=x$s[0]},this._setAlpha=function(x$b,x$_,x$s){this.ctx.globalAlpha=x$s[0]},this._fillText=function(x$b,x$_,x$s){this.ctx.fillText(x$s[0],x$s[1]+x$b,x$s[2]+x$_,x$s[3],x$s[4],x$s[5])},this._strokeText=function(x$b,x$_,x$s){this.ctx.strokeText(x$s[0],x$s[1]+x$b,x$s[2]+x$_,x$s[3],x$s[4],x$s[5],x$s[6])},this._fillBorderText=function(x$b,x$_,x$s){this.ctx.fillBorderText(x$s[0],x$s[1]+x$b,x$s[2]+x$_,x$s[3],x$s[4],x$s[5],x$s[6],x$s[7])},this._blendMode=function(x$b,x$_,x$s){this.ctx.globalCompositeOperation=x$s[0]},this._beginClip=function(x$b,x$_,x$s){this.ctx.beginClip&&this.ctx.beginClip(x$b+x$s[0],x$_+x$s[1],x$s[2],x$s[3])},this._setIBVB=function(x$b,x$_,x$s){this.ctx.setIBVB(x$s[0]+x$b,x$s[1]+x$_,x$s[2],x$s[3],x$s[4],x$s[5],x$s[6],x$s[7])},this._fillTrangles=function(x$b,x$_,x$s){this.ctx.fillTrangles(x$s[0],x$s[1]+x$b,x$s[2]+x$_,x$s[3],x$s[4])},this._drawPath=function(x$b,x$_,x$s){var x$h=this.ctx;x$q.isWebGL&&x$h.setPathId(-1),x$h.beginPath(),x$b+=x$s[0],x$_+=x$s[1],x$q.isWebGL&&x$h.movePath(x$b,x$_);for(var x$x=x$s[2],x$n=0,x$E=x$x.length;x$n<x$E;x$n++){var x$C=x$x[x$n];switch(x$C[0]){case"moveTo":x$q.isWebGL?x$h.moveTo(x$C[1],x$C[2]):x$h.moveTo(x$b+x$C[1],x$_+x$C[2]);break;case"lineTo":x$q.isWebGL?x$h.lineTo(x$C[1],x$C[2]):x$h.lineTo(x$b+x$C[1],x$_+x$C[2]);break;case"arcTo":x$q.isWebGL?x$h.arcTo(x$C[1],x$C[2],x$C[3],x$C[4],x$C[5]):x$h.arcTo(x$b+x$C[1],x$_+x$C[2],x$b+x$C[3],x$_+x$C[4],x$C[5]);break;case"closePath":x$h.closePath()}}var x$O=x$s[3];null!=x$O&&(x$h.fillStyle=x$O.fillStyle,x$h.fill());var x$L=x$s[4];null!=x$L&&(x$h.strokeStyle=x$L.strokeStyle,x$h.lineWidth=x$L.lineWidth||1,x$h.lineJoin=x$L.lineJoin,x$h.lineCap=x$L.lineCap,x$h.miterLimit=x$L.miterLimit,x$h.stroke())},this.drawPoly=function(x$b,x$_,x$s){this.ctx.drawPoly(x$b+this.x+x$s[0],x$_+this.y+x$s[1],x$s[2],x$s[3],x$s[4],x$s[5],x$s[6])},this._drawPoly=function(x$b,x$_,x$s){var x$h=this.ctx,x$x=x$s[2],x$n=2,x$E=x$x.length;if(x$q.isWebGL)for(x$h.setPathId(x$s[6]),x$h.beginPath(),x$b+=x$s[0],x$_+=x$s[1],x$h.movePath(x$b,x$_),x$h.moveTo(x$x[0],x$x[1]);x$n<x$E;)x$h.lineTo(x$x[x$n++],x$x[x$n++]);else for(x$h.beginPath(),x$b+=x$s[0],x$_+=x$s[1],x$h.moveTo(x$b+x$x[0],x$_+x$x[1]);x$n<x$E;)x$h.lineTo(x$b+x$x[x$n++],x$_+x$x[x$n++]);x$h.closePath(),this._fillAndStroke(x$s[3],x$s[4],x$s[5],x$s[7])},this._drawSkin=function(x$b,x$_,x$s){var x$h=x$s[0];if(x$h){var x$x=this.ctx;x$h.render(x$x,x$b,x$_)}},this._drawParticle=function(x$b,x$_,x$s){this.ctx.drawParticle(x$b+this.x,x$_+this.y,x$s[0])},this._setFilters=function(x$b,x$_,x$s){this.ctx.setFilters(x$s)},x$s?this.ctx=x$s.getContext("2d"):(x$s=x$tb.create("3D"),this.ctx=x$Z.createWebGLContext2D(x$s),x$s._setContext(this.ctx)),x$s.size(x$b,x$_),this.canvas=x$s}x$f(x$E,"laya.renders.RenderContext");var x$b=x$E.prototype;return x$b.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},x$b.drawTexture=function(x$b,x$_,x$s,x$h,x$x){x$b.loaded&&this.ctx.drawTexture(x$b,x$_,x$s,x$h,x$x,this.x,this.y)},x$b._drawTextures=function(x$b,x$_,x$s){x$s[0].loaded&&this.ctx.drawTextures(x$s[0],x$s[1],x$b+this.x,x$_+this.y)},x$b.drawTextureWithTransform=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$b.loaded&&this.ctx.drawTextureWithTransform(x$b,x$_,x$s,x$h,x$x,x$n,this.x,this.y,x$E)},x$b.fillQuadrangle=function(x$b,x$_,x$s,x$h,x$x){this.ctx.fillQuadrangle(x$b,x$_,x$s,x$h,x$x)},x$b.drawCanvas=function(x$b,x$_,x$s,x$h,x$x){this.ctx.drawCanvas(x$b,x$_+this.x,x$s+this.y,x$h,x$x)},x$b.drawRect=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=1);var x$E=this.ctx;x$E.strokeStyle=x$x,x$E.lineWidth=x$n,x$E.strokeRect(x$b+this.x,x$_+this.y,x$s,x$h,x$n)},x$b._fillAndStroke=function(x$b,x$_,x$s,x$h){void 0===x$h&&(x$h=!1);var x$x=this.ctx;null!=x$b&&(x$x.fillStyle=x$b,x$q.isWebGL?x$x.fill(x$h):x$x.fill()),null!=x$_&&0<x$s&&(x$x.strokeStyle=x$_,x$x.lineWidth=x$s,x$x.stroke())},x$b.clipRect=function(x$b,x$_,x$s,x$h){this.ctx.clipRect(x$b+this.x,x$_+this.y,x$s,x$h)},x$b.fillRect=function(x$b,x$_,x$s,x$h,x$x){this.ctx.fillRect(x$b+this.x,x$_+this.y,x$s,x$h,x$x)},x$b.drawCircle=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=1),x$X.drawCall++;var x$n=this.ctx;x$n.beginPath(),x$n.strokeStyle=x$h,x$n.lineWidth=x$x,x$n.arc(x$b+this.x,x$_+this.y,x$s,0,x$E.PI2),x$n.stroke()},x$b.drawTriangles=function(x$b,x$_,x$s){if(x$q.isWebGL)this.ctx.drawTriangles(x$s[0],x$b+x$s[1],x$_+x$s[2],x$s[3],x$s[4],x$s[5],x$s[6],x$s[7],x$s[8],x$s[9]);else{var x$h=x$s[5],x$x=0,x$n=x$h.length,x$E=this.ctx;for(x$x=0;x$x<x$n;x$x+=3){var x$C=2*x$h[x$x],x$O=2*x$h[x$x+1],x$L=2*x$h[x$x+2];x$E.drawTriangle(x$s[0],x$s[3],x$s[4],x$C,x$O,x$L,x$s[6],!0)}}},x$b.fillCircle=function(x$b,x$_,x$s,x$h){x$X.drawCall++;var x$x=this.ctx;x$x.beginPath(),x$x.fillStyle=x$h,x$x.arc(x$b+this.x,x$_+this.y,x$s,0,x$E.PI2),x$x.fill()},x$b.setShader=function(x$b){this.ctx.setShader(x$b)},x$b.drawLine=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=1);var x$E=this.ctx;x$E.beginPath(),x$E.strokeStyle=x$x,x$E.lineWidth=x$n,x$E.moveTo(this.x+x$b,this.y+x$_),x$E.lineTo(this.x+x$s,this.y+x$h),x$E.stroke()},x$b.clear=function(){this.ctx.clear()},x$b.transformByMatrix=function(x$b){this.ctx.transformByMatrix(x$b)},x$b.setTransform=function(x$b,x$_,x$s,x$h,x$x,x$n){this.ctx.setTransform(x$b,x$_,x$s,x$h,x$x,x$n)},x$b.setTransformByMatrix=function(x$b){this.ctx.setTransformByMatrix(x$b)},x$b.save=function(){this.ctx.save()},x$b.restore=function(){this.ctx.restore()},x$b.translate=function(x$b,x$_){this.ctx.translate(x$b,x$_)},x$b.transform=function(x$b,x$_,x$s,x$h,x$x,x$n){this.ctx.transform(x$b,x$_,x$s,x$h,x$x,x$n)},x$b.rotate=function(x$b){this.ctx.rotate(x$b)},x$b.scale=function(x$b,x$_){this.ctx.scale(x$b,x$_)},x$b.alpha=function(x$b){this.ctx.globalAlpha*=x$b},x$b.setAlpha=function(x$b){this.ctx.globalAlpha=x$b},x$b.fillWords=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$n&&(x$n=0),this.ctx.fillWords(x$b,x$_,x$s,x$h,x$x,x$n)},x$b.fillBorderWords=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this.ctx.fillBorderWords(x$b,x$_,x$s,x$h,x$x,x$n,x$E)},x$b.fillText=function(x$b,x$_,x$s,x$h,x$x,x$n){this.ctx.fillText(x$b,x$_+this.x,x$s+this.y,x$h,x$x,x$n)},x$b.strokeText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this.ctx.strokeText(x$b,x$_+this.x,x$s+this.y,x$h,x$x,x$n,x$E)},x$b.blendMode=function(x$b){this.ctx.globalCompositeOperation=x$b},x$b.flush=function(){this.ctx.flush&&this.ctx.flush()},x$b.addRenderObject=function(x$b){this.ctx.addRenderObject(x$b)},x$b.beginClip=function(x$b,x$_,x$s,x$h){this.ctx.beginClip&&this.ctx.beginClip(x$b,x$_,x$s,x$h)},x$b.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},x$b.fillTrangles=function(x$b,x$_,x$s){this.ctx.fillTrangles(x$s[0],x$s[1],x$s[2],x$s[3],4<x$s.length?x$s[4]:null)},x$E.PI2=2*Math.PI,x$E}(),x$G=function(){function x$E(x$b,x$_){switch(this._next=x$_||x$E.NORENDER,x$b){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=x$i._filter);case 69905:return void(this._fun=x$E._initRenderFun)}this.onCreate(x$b)}x$f(x$E,"laya.renders.RenderSprite");var x$b=x$E.prototype;return x$b.onCreate=function(x$b){},x$b._style=function(x$b,x$_,x$s,x$h){x$b._style.render(x$b,x$_,x$s,x$h);var x$x=this._next;x$x._fun.call(x$x,x$b,x$_,x$s,x$h)},x$b._no=function(x$b,x$_,x$s,x$h){},x$b._custom=function(x$b,x$_,x$s,x$h){x$b.customRender(x$_,x$s,x$h);var x$x=x$b._style._tf;this._next._fun.call(this._next,x$b,x$_,x$s-x$x.translateX,x$h-x$x.translateY)},x$b._clip=function(x$b,x$_,x$s,x$h){var x$x=this._next;if(x$x!=x$E.NORENDER){var x$n=x$b._style.scrollRect;x$_.ctx.save(),x$_.ctx.clipRect(x$s,x$h,x$n.width,x$n.height),x$x._fun.call(x$x,x$b,x$_,x$s-x$n.x,x$h-x$n.y),x$_.ctx.restore()}},x$b._blend=function(x$b,x$_,x$s,x$h){var x$x=x$b._style;x$x.blendMode&&(x$_.ctx.globalCompositeOperation=x$x.blendMode);var x$n=this._next;x$n._fun.call(x$n,x$b,x$_,x$s,x$h),x$_.ctx.globalCompositeOperation="source-over"},x$b._mask=function(x$b,x$_,x$s,x$h){var x$x=this._next;x$x._fun.call(x$x,x$b,x$_,x$s,x$h);var x$n=x$b.mask;x$n&&(x$_.ctx.globalCompositeOperation="destination-in",(0<x$n.numChildren||!x$n.graphics._isOnlyOne())&&(x$n.cacheAsBitmap=!0),x$n.render(x$_,x$s-x$b.pivotX,x$h-x$b.pivotY)),x$_.ctx.globalCompositeOperation="source-over"},x$b._graphics=function(x$b,x$_,x$s,x$h){var x$x=x$b._style._tf;x$b._graphics&&x$b._graphics._render(x$b,x$_,x$s-x$x.translateX,x$h-x$x.translateY);var x$n=this._next;x$n._fun.call(x$n,x$b,x$_,x$s,x$h)},x$b._image=function(x$b,x$_,x$s,x$h){var x$x=x$b._style;x$_.ctx.drawTexture2(x$s,x$h,x$x._tf.translateX,x$x._tf.translateY,x$b.transform,x$x.alpha,x$x.blendMode,x$b._graphics._one)},x$b._image2=function(x$b,x$_,x$s,x$h){var x$x=x$b._style._tf;x$_.ctx.drawTexture2(x$s,x$h,x$x.translateX,x$x.translateY,x$b.transform,1,null,x$b._graphics._one)},x$b._alpha=function(x$b,x$_,x$s,x$h){var x$x;if(.01<(x$x=x$b._style.alpha)||x$b._needRepaint()){var x$n=x$_.ctx.globalAlpha;x$_.ctx.globalAlpha*=x$x;var x$E=this._next;x$E._fun.call(x$E,x$b,x$_,x$s,x$h),x$_.ctx.globalAlpha=x$n}},x$b._transform=function(x$b,x$_,x$s,x$h){var x$x=x$b.transform,x$n=this._next;x$x&&x$n!=x$E.NORENDER?(x$_.save(),x$_.transform(x$x.a,x$x.b,x$x.c,x$x.d,x$x.tx+x$s,x$x.ty+x$h),x$n._fun.call(x$n,x$b,x$_,0,0),x$_.restore()):x$n._fun.call(x$n,x$b,x$_,x$s,x$h)},x$b._childs=function(x$b,x$_,x$s,x$h){var x$x=x$b._style,x$n=x$x._tf;if(x$s=x$s-x$n.translateX+x$x.paddingLeft,x$h=x$h-x$n.translateY+x$x.paddingTop,x$x._calculation){var x$E=x$b._getWords();if(x$E){var x$C=x$x;x$C&&(x$C.stroke?x$_.fillBorderWords(x$E,x$s,x$h,x$C.font,x$C.color,x$C.strokeColor,x$C.stroke):x$_.fillWords(x$E,x$s,x$h,x$C.font,x$C.color,"none"!=x$C.textDecoration&&x$C.underLine?1:0))}}var x$O,x$L=x$b._childs,x$f=x$L.length;if(x$b.viewport||x$b.optimizeScrollRect&&x$b._style.scrollRect){var x$p=x$b.viewport||x$b._style.scrollRect,x$P=x$p.x,x$V=x$p.y,x$Q=x$p.right,x$y=x$p.bottom,x$w=NaN,x$i=NaN;for(x$R=0;x$R<x$f;++x$R)(x$O=x$L[x$R]).visible&&(x$w=x$O._x)<x$Q&&x$w+x$O.width>x$P&&(x$i=x$O._y)<x$y&&x$i+x$O.height>x$V&&x$O.render(x$_,x$s,x$h)}else for(var x$R=0;x$R<x$f;++x$R)(x$O=x$L[x$R])._style.visible&&x$O.render(x$_,x$s,x$h)},x$b._canvas=function(x$b,x$_,x$s,x$h){var x$x=x$b._$P.cacheCanvas;if(x$x){"bitmap"===x$x.type?x$X.canvasBitmap++:x$X.canvasNormal++;var x$n=x$x.ctx;if(x$b._needRepaint()||!x$n)this._canvas_repaint(x$b,x$_,x$s,x$h);else{var x$E=x$x._cacheRec;x$_.drawCanvas(x$n.canvas,x$s+x$E.x,x$h+x$E.y,x$E.width,x$E.height)}}else this._next._fun.call(this._next,x$b,x$_,x$s,x$h)},x$b._canvas_repaint=function(x$b,x$_,x$s,x$h){var x$x=x$b._$P.cacheCanvas,x$n=this._next;if(x$x){var x$E,x$C,x$O,x$L,x$f=x$x.ctx,x$p=x$b._needRepaint()||!x$f,x$P=x$x.type;if("bitmap"===x$P?x$X.canvasBitmap++:x$X.canvasNormal++,x$p){var x$V,x$Q;x$x._cacheRec||(x$x._cacheRec=new x$r),x$q.isWebGL&&"bitmap"!==x$P?x$x._cacheRec.setTo(-x$b.pivotX,-x$b.pivotY,1,1):((x$L=x$b.getSelfBounds()).x=x$L.x-x$b.pivotX,x$L.y=x$L.y-x$b.pivotY,x$L.x=x$L.x-16,x$L.y=x$L.y-16,x$L.width=x$L.width+32,x$L.height=x$L.height+32,x$L.x=Math.floor(x$L.x+x$s)-x$s,x$L.y=Math.floor(x$L.y+x$h)-x$h,x$L.width=Math.floor(x$L.width),x$L.height=Math.floor(x$L.height),x$x._cacheRec.copyFrom(x$L)),x$L=x$x._cacheRec;var x$y,x$w=x$q.isWebGL?1:x$K.pixelRatio*x$o.stage.clientScaleX,x$i=x$q.isWebGL?1:x$K.pixelRatio*x$o.stage.clientScaleY;if(!x$q.isWebGL){var x$R,x$t=1,x$c=1;for(x$R=x$b;x$R&&x$R!=x$o.stage;)x$t*=x$R.scaleX,x$c*=x$R.scaleY,x$R=x$R.parent;x$q.isWebGL?(x$t<1&&(x$w*=x$t),x$c<1&&(x$i*=x$c)):(1<x$t&&(x$w*=x$t),1<x$c&&(x$i*=x$c))}if(x$b.scrollRect){var x$$=x$b.scrollRect;x$L.x-=x$$.x,x$L.y-=x$$.y}if(x$V=x$L.width*x$w,x$Q=x$L.height*x$i,x$C=x$L.x,x$O=x$L.y,x$q.isWebGL&&"bitmap"===x$P&&(2048<x$V||2048<x$Q))return console.warn("cache bitmap size larger than 2048,cache ignored"),x$x.ctx&&(x$N.recover("RenderContext",x$x.ctx),x$x.ctx.canvas.size(0,0),x$x.ctx=null),void x$n._fun.call(x$n,x$b,x$_,x$s,x$h);if(x$f||(x$f=x$x.ctx=x$N.getItem("RenderContext")||new x$U(x$V,x$Q,x$tb.create("AUTO"))),x$f.ctx.sprite=x$b,(x$E=x$f.canvas).clear(),(x$E.width!=x$V||x$E.height!=x$Q)&&x$E.size(x$V,x$Q),"bitmap"===x$P?x$E.context.asBitmap=!0:"normal"===x$P&&(x$E.context.asBitmap=!1),1!=x$w||1!=x$i){var x$D=x$f.ctx;x$D.save(),x$D.scale(x$w,x$i),!x$q.isConchWebGL&&x$q.isConchApp&&(x$y=x$b._$P.cf)&&x$D.setFilterMatrix&&x$D.setFilterMatrix(x$y._mat,x$y._alpha),x$n._fun.call(x$n,x$b,x$f,-x$C,-x$O),x$D.restore(),x$q.isConchApp&&!x$q.isConchWebGL||x$b._applyFilters()}else x$D=x$f.ctx,!x$q.isConchWebGL&&x$q.isConchApp&&(x$y=x$b._$P.cf)&&x$D.setFilterMatrix&&x$D.setFilterMatrix(x$y._mat,x$y._alpha),x$n._fun.call(x$n,x$b,x$f,-x$C,-x$O),x$q.isConchApp&&!x$q.isConchWebGL||x$b._applyFilters();x$b._$P.staticCache&&(x$x.reCache=!1),x$X.canvasReCache++}else x$C=(x$L=x$x._cacheRec).x,x$O=x$L.y,x$E=x$f.canvas;x$_.drawCanvas(x$E,x$s+x$C,x$h+x$O,x$L.width,x$L.height)}else x$n._fun.call(x$n,x$b,x$f,x$s,x$h)},x$E.__init__=function(){var x$b,x$_,x$s=0;for(x$_=x$Z.createRenderSprite(69905,null),x$b=x$E.renders.length=4096,x$s=0;x$s<x$b;x$s++)x$E.renders[x$s]=x$_;x$E.renders[0]=x$Z.createRenderSprite(0,null),function(x$b,x$_){for(var x$s=0,x$h=0;x$h<x$b.length;x$h++)x$s|=x$b[x$h],x$E.renders[x$s]=x$_}([1,512,4,2],new x$E(1,null)),x$E.renders[513]=x$Z.createRenderSprite(513,null),x$E.renders[517]=new x$E(517,null)},x$E._initRenderFun=function(x$b,x$_,x$s,x$h){var x$x=x$b._renderType;(x$E.renders[x$x]=x$E._getTypeRender(x$x))._fun(x$b,x$_,x$s,x$h)},x$E._getTypeRender=function(x$b){for(var x$_=null,x$s=2048;1<x$s;)x$s&x$b&&(x$_=x$Z.createRenderSprite(x$s,x$_)),x$s>>=1;return x$_},x$E.IMAGE=1,x$E.ALPHA=2,x$E.TRANSFORM=4,x$E.BLEND=8,x$E.CANVAS=16,x$E.FILTERS=32,x$E.MASK=64,x$E.CLIP=128,x$E.STYLE=256,x$E.GRAPHICS=512,x$E.CUSTOM=1024,x$E.CHILDS=2048,x$E.INIT=69905,x$E.renders=[],x$E.NORENDER=new x$E(0,null),x$E}(),x$z=function(){function x$C(){this._repaint=!1}x$f(x$C,"laya.resource.Context");var x$b=x$C.prototype;return x$b.replaceReset=function(){var x$b,x$_,x$s=0;for(x$b=x$C.replaceKeys.length,x$s=0;x$s<x$b;x$s++)x$_=x$C.replaceKeys[x$s],this[x$C.newKeys[x$s]]=this[x$_]},x$b.replaceResotre=function(){this.__restore(),this.__reset()},x$b.setIsMainContext=function(){},x$b.drawTextures=function(x$b,x$_,x$s,x$h){x$X.drawCall+=x$_.length/2;for(var x$x=x$b.width,x$n=x$b.height,x$E=0,x$C=x$_.length;x$E<x$C;x$E+=2)this.drawTexture(x$b,x$_[x$E],x$_[x$E+1],x$x,x$n,x$s,x$h)},x$b.drawCanvas=function(x$b,x$_,x$s,x$h,x$x){x$X.drawCall++,this.drawImage(x$b.source,x$_,x$s,x$h,x$x)},x$b.fillRect=function(x$b,x$_,x$s,x$h,x$x){x$X.drawCall++,x$x&&(this.fillStyle=x$x),this.__fillRect(x$b,x$_,x$s,x$h)},x$b.fillText=function(x$b,x$_,x$s,x$h,x$x,x$n){x$X.drawCall++,3<arguments.length&&null!=x$h&&(this.font=x$h,this.fillStyle=x$x,this.textAlign=x$n,this.textBaseline="top"),this.__fillText(x$b,x$_,x$s)},x$b.fillBorderText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){x$X.drawCall++,this.font=x$h,this.fillStyle=x$x,this.textBaseline="top",this.strokeStyle=x$n,this.lineWidth=x$E,this.textAlign=x$C,this.__strokeText(x$b,x$_,x$s),this.__fillText(x$b,x$_,x$s)},x$b.strokeText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$X.drawCall++,3<arguments.length&&null!=x$h&&(this.font=x$h,this.strokeStyle=x$x,this.lineWidth=x$n,this.textAlign=x$E,this.textBaseline="top"),this.__strokeText(x$b,x$_,x$s)},x$b.transformByMatrix=function(x$b){this.transform(x$b.a,x$b.b,x$b.c,x$b.d,x$b.tx,x$b.ty)},x$b.setTransformByMatrix=function(x$b){this.setTransform(x$b.a,x$b.b,x$b.c,x$b.d,x$b.tx,x$b.ty)},x$b.clipRect=function(x$b,x$_,x$s,x$h){x$X.drawCall++,this.beginPath(),this.rect(x$b,x$_,x$s,x$h),this.clip()},x$b.drawTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$X.drawCall++;var x$C=x$b.uv,x$O=x$b.bitmap.width,x$L=x$b.bitmap.height;this.drawImage(x$b.source,x$C[0]*x$O,x$C[1]*x$L,(x$C[2]-x$C[0])*x$O,(x$C[5]-x$C[3])*x$L,x$_+x$n,x$s+x$E,x$h,x$x)},x$b.drawTextureWithTransform=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){x$X.drawCall++;var x$L=x$b.uv,x$f=x$b.bitmap.width,x$p=x$b.bitmap.height;this.save(),1!=x$O&&(this.globalAlpha*=x$O),x$n?(this.transform(x$n.a,x$n.b,x$n.c,x$n.d,x$n.tx+x$E,x$n.ty+x$C),this.drawImage(x$b.source,x$L[0]*x$f,x$L[1]*x$p,(x$L[2]-x$L[0])*x$f,(x$L[5]-x$L[3])*x$p,x$_,x$s,x$h,x$x)):this.drawImage(x$b.source,x$L[0]*x$f,x$L[1]*x$p,(x$L[2]-x$L[0])*x$f,(x$L[5]-x$L[3])*x$p,x$_+x$E,x$s+x$C,x$h,x$x),this.restore()},x$b.drawTexture2=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=x$C[0];if(x$O.loaded&&x$O.bitmap&&x$O.source){x$X.drawCall++;var x$L=1!==x$n;if(x$L){var x$f=this.globalAlpha;this.globalAlpha*=x$n}var x$p=x$O.uv,x$P=x$O.bitmap.width,x$V=x$O.bitmap.height;x$x?(this.save(),this.transform(x$x.a,x$x.b,x$x.c,x$x.d,x$x.tx+x$b,x$x.ty+x$_),this.drawImage(x$O.source,x$p[0]*x$P,x$p[1]*x$V,(x$p[2]-x$p[0])*x$P,(x$p[5]-x$p[3])*x$V,x$C[1]-x$s,x$C[2]-x$h,x$C[3],x$C[4]),this.restore()):this.drawImage(x$O.source,x$p[0]*x$P,x$p[1]*x$V,(x$p[2]-x$p[0])*x$P,(x$p[5]-x$p[3])*x$V,x$C[1]-x$s+x$b,x$C[2]-x$h+x$_,x$C[3],x$C[4]),x$L&&(this.globalAlpha=x$f)}},x$b.fillTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){if(!x$C.pat){if(x$b.uv!=x$fb.DEF_UV){var x$O=new x$tb("2D");x$O.getContext("2d"),x$O.size(x$b.width,x$b.height),x$O.context.drawTexture(x$b,0,0,x$b.width,x$b.height,0,0),x$b=new x$fb(x$O)}x$C.pat=this.createPattern(x$b.bitmap.source,x$n)}var x$L=x$_,x$f=x$s,x$p=0,x$P=0;x$E&&(x$L+=x$E.x%x$b.width,x$f+=x$E.y%x$b.height,x$p-=x$E.x%x$b.width,x$P-=x$E.y%x$b.height),this.translate(x$L,x$f),this.fillRect(x$p,x$P,x$h,x$x,x$C.pat),this.translate(-x$L,-x$f)},x$b.drawTriangle=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=x$b.bitmap,x$L=x$O.source,x$f=x$b.width,x$p=x$b.height,x$P=x$O.width,x$V=x$O.height,x$Q=x$s[x$h]*x$P,x$y=x$s[x$x]*x$P,x$w=x$s[x$n]*x$P,x$i=x$s[x$h+1]*x$V,x$R=x$s[x$x+1]*x$V,x$t=x$s[x$n+1]*x$V,x$c=x$_[x$h],x$$=x$_[x$x],x$D=x$_[x$n],x$o=x$_[x$h+1],x$M=x$_[x$x+1],x$r=x$_[x$n+1];if(x$C){var x$k=(x$c+x$$+x$D)/3,x$B=(x$o+x$M+x$r)/3,x$S=x$c-x$k,x$Z=x$o-x$B,x$J=Math.sqrt(x$S*x$S+x$Z*x$Z);x$c=x$k+x$S/x$J*(x$J+1),x$o=x$B+x$Z/x$J*(x$J+1),x$Z=x$M-x$B,x$$=x$k+(x$S=x$$-x$k)/(x$J=Math.sqrt(x$S*x$S+x$Z*x$Z))*(x$J+1),x$M=x$B+x$Z/x$J*(x$J+1),x$Z=x$r-x$B,x$D=x$k+(x$S=x$D-x$k)/(x$J=Math.sqrt(x$S*x$S+x$Z*x$Z))*(x$J+1),x$r=x$B+x$Z/x$J*(x$J+1)}this.save(),x$E&&this.transform(x$E.a,x$E.b,x$E.c,x$E.d,x$E.tx,x$E.ty),this.beginPath(),this.moveTo(x$c,x$o),this.lineTo(x$$,x$M),this.lineTo(x$D,x$r),this.closePath(),this.clip();var x$W=1/(x$Q*x$R+x$i*x$w+x$y*x$t-x$R*x$w-x$i*x$y-x$Q*x$t),x$T=x$c*x$R+x$i*x$D+x$$*x$t-x$R*x$D-x$i*x$$-x$c*x$t,x$q=x$Q*x$$+x$c*x$w+x$y*x$D-x$$*x$w-x$c*x$y-x$Q*x$D,x$U=x$Q*x$R*x$D+x$i*x$$*x$w+x$c*x$y*x$t-x$c*x$R*x$w-x$i*x$y*x$D-x$Q*x$$*x$t,x$G=x$o*x$R+x$i*x$r+x$M*x$t-x$R*x$r-x$i*x$M-x$o*x$t,x$z=x$Q*x$M+x$o*x$w+x$y*x$r-x$M*x$w-x$o*x$y-x$Q*x$r,x$a=x$Q*x$R*x$r+x$i*x$M*x$w+x$o*x$y*x$t-x$o*x$R*x$w-x$i*x$y*x$r-x$Q*x$M*x$t;this.transform(x$T*x$W,x$G*x$W,x$q*x$W,x$z*x$W,x$U*x$W,x$a*x$W),this.drawImage(x$L,x$b.uv[0]*x$P,x$b.uv[1]*x$V,x$f,x$p,x$b.uv[0]*x$P,x$b.uv[1]*x$V,x$f,x$p),this.restore()},x$b.flush=function(){return 0},x$b.fillWords=function(x$b,x$_,x$s,x$h,x$x,x$n){x$h&&(this.font=x$h),x$x&&(this.fillStyle=x$x);this.textBaseline="top",this.textAlign="left";for(var x$E=0,x$C=x$b.length;x$E<x$C;x$E++){var x$O=x$b[x$E];if(this.__fillText(x$O.char,x$O.x+x$_,x$O.y+x$s),1===x$n){var x$L=x$O.height,x$f=.5*x$O.style.letterSpacing;x$f||(x$f=0),this.beginPath(),this.strokeStyle=x$x,this.lineWidth=1,this.moveTo(x$_+x$O.x-x$f+.5,x$s+x$O.y+x$L+.5),this.lineTo(x$_+x$O.x+x$O.width+x$f+.5,x$s+x$O.y+x$L+.5),this.stroke()}}},x$b.fillBorderWords=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$h&&(this.font=x$h),x$x&&(this.fillStyle=x$x),this.textBaseline="top",this.lineWidth=x$E,this.textAlign="left",this.strokeStyle=x$n;for(var x$C=0,x$O=x$b.length;x$C<x$O;x$C++){var x$L=x$b[x$C];this.__strokeText(x$L.char,x$L.x+x$_,x$L.y+x$s),this.__fillText(x$L.char,x$L.x+x$_,x$L.y+x$s)}},x$b.destroy=function(){this.canvas.width=this.canvas.height=0},x$b.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},x$b.drawCurves=function(x$b,x$_,x$s){this.beginPath(),this.strokeStyle=x$s[3],this.lineWidth=x$s[4];var x$h=x$s[2];x$b+=x$s[0],x$_+=x$s[1],this.moveTo(x$b+x$h[0],x$_+x$h[1]);for(var x$x=2,x$n=x$h.length;x$x<x$n;)this.quadraticCurveTo(x$b+x$h[x$x++],x$_+x$h[x$x++],x$b+x$h[x$x++],x$_+x$h[x$x++]);this.stroke()},x$C.__init__=function(x$_){var x$s=laya.resource.Context.prototype;if(!(x$_=x$_||CanvasRenderingContext2D.prototype).inited){x$_.inited=!0,x$_.__fillText=x$_.fillText,x$_.__fillRect=x$_.fillRect,x$_.__strokeText=x$_.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(x$b){x$_[x$b]=x$s[x$b]})}},x$C.replaceCanvasGetSet=function(x$b,x$_){var x$s=Object.getOwnPropertyDescriptor(x$b,x$_);if(!x$s||!x$s.configurable)return!1;var x$h,x$x={};for(x$h in x$s)"set"!=x$h&&(x$x[x$h]=x$s[x$h]);var x$n=x$s.set;return x$x.set=function(x$b){x$n.call(this,x$b);var x$_=this.getContext("2d");x$_&&"__reset"in x$_&&x$_.__reset()},Object.defineProperty(x$b,x$_,x$x),!0},x$C.replaceGetSet=function(x$b,x$_){var x$s=Object.getOwnPropertyDescriptor(x$b,x$_);if(!x$s||!x$s.configurable)return!1;var x$h,x$x={};for(x$h in x$s)"set"!=x$h&&(x$x[x$h]=x$s[x$h]);var x$n=x$s.set,x$E="___"+x$_+"__";return x$C.newKeys.push(x$E),x$x.set=function(x$b){x$b!=this[x$E]&&(this[x$E]=x$b,x$n.call(this,x$b))},Object.defineProperty(x$b,x$_,x$x),!0},x$C._default=new x$C,x$C.newKeys=[],x$O(x$C,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),x$C}(),x$a=function(){function x$n(x$b){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++x$n._uniqueIDCounter,this._name=x$b||"Content Manager",x$n._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,x$n._resourceManagers.push(this),this._resources=[],this._records={}}x$f(x$n,"laya.resource.ResourceManager");var x$b=x$n.prototype;return x$o.imps(x$b,{"laya.resource.IDispose":!0}),x$b.getResourceByIndex=function(x$b){return this._resources[x$b]},x$b.getResourcesLength=function(){return this._resources.length},x$b.addResource=function(x$b){return x$b.resourceManager&&x$b.resourceManager.removeResource(x$b),-1===this._resources.indexOf(x$b)&&((x$b._resourceManager=this)._resources.push(x$b),this.addRecord(x$b.uri,x$b.__className,x$b.memorySize),this.addSize(x$b.memorySize),!0)},x$b.removeResource=function(x$b){var x$_=this._resources.indexOf(x$b);return-1!==x$_&&(this._resources.splice(x$_,1),x$b._resourceManager=null,this._memorySize-=x$b.memorySize,this.addRecord(x$b.uri,x$b.__className,-x$b.memorySize),!0)},x$b.unload=function(){for(var x$b=this._resources.slice(0,this._resources.length),x$_=0;x$_<x$b.length;x$_++){x$b[x$_].destroy()}x$b.length=0},x$b.dispose=function(){if(this===x$n._systemResourceManager)throw new Error("systemResourceManager不能被释放！");x$n._resourceManagers.splice(x$n._resourceManagers.indexOf(this),1),x$n._isResourceManagersSorted=!1;for(var x$b=this._resources.slice(0,this._resources.length),x$_=0;x$_<x$b.length;x$_++){var x$s=x$b[x$_];x$s.resourceManager.removeResource(x$s),x$s.destroy()}x$b.length=0},x$b.addSize=function(x$b){x$b&&(this.autoRelease&&0<x$b&&this._memorySize+x$b>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=x$b)},x$b.addRecord=function(x$b,x$_,x$s){DEBUG&&x$s&&!x$b&&console.error(x$b,x$_,x$s),x$b&&(this._records.hasOwnProperty(x$_+"|"+x$b)||(this._records[x$_+"|"+x$b]=0),this._records[x$_+"|"+x$b]+=x$s,DEBUG&&this._records[x$_+"|"+x$b]<0&&console.error(x$b,x$_,this._records[x$_+"|"+x$b]))},x$b.garbageCollection=function(x$b){var x$_=this._resources;(x$_=x$_.slice()).sort(function(x$b,x$_){if(!x$b||!x$_)throw new Error("a或b不能为空！");return x$b.released&&x$_.released?0:x$b.released?1:x$_.released?-1:x$b._lastUseFrameCount-x$_._lastUseFrameCount});for(var x$s=x$X.loopCount,x$h=0,x$x=x$_.length;x$h<x$x;x$h++){var x$n=x$_[x$h];if(!(1<x$s-x$n._lastUseFrameCount))return void(this._memorySize>=x$b&&(this._isOverflow=!0));if(x$n.releaseResource(),this._memorySize<x$b)return void(this._isOverflow=!1)}},x$Q(0,x$b,"id",function(){return this._id}),x$Q(0,x$b,"name",function(){return this._name},function(x$b){!x$b&&""===x$b||this._name===x$b||(this._name=x$b,x$n._isResourceManagersSorted=!1)}),x$Q(0,x$b,"memorySize",function(){return this._memorySize}),x$Q(0,x$b,"records",function(){return this._records}),x$Q(1,x$n,"systemResourceManager",function(){return x$n._systemResourceManager}),x$n.__init__=function(){x$n.currentResourceManager=x$n.systemResourceManager},x$n.getLoadedResourceManagerByIndex=function(x$b){return x$n._resourceManagers[x$b]},x$n.getLoadedResourceManagersCount=function(){return x$n._resourceManagers.length},x$n.recreateContentManagers=function(x$b){void 0===x$b&&(x$b=!1);for(var x$_=x$n.currentResourceManager,x$s=0;x$s<x$n._resourceManagers.length;x$s++){x$n.currentResourceManager=x$n._resourceManagers[x$s];for(var x$h=0;x$h<x$n.currentResourceManager._resources.length;x$h++)x$n.currentResourceManager._resources[x$h].releaseResource(x$b),x$n.currentResourceManager._resources[x$h].activeResource(x$b)}x$n.currentResourceManager=x$_},x$n.releaseContentManagers=function(x$b){void 0===x$b&&(x$b=!1);for(var x$_=x$n.currentResourceManager,x$s=0;x$s<x$n._resourceManagers.length;x$s++){x$n.currentResourceManager=x$n._resourceManagers[x$s];for(var x$h=0;x$h<x$n.currentResourceManager._resources.length;x$h++){var x$x=x$n.currentResourceManager._resources[x$h];!x$x.released&&x$x.releaseResource(x$b)}}x$n.currentResourceManager=x$_},x$n._uniqueIDCounter=0,x$n._isResourceManagersSorted=!1,x$n._resourceManagers=[],x$O(x$n,["_systemResourceManager",function(){return this._systemResourceManager=new x$n("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=x$n._systemResourceManager}]),x$n}(),x$K=(function(){function x$b(){}x$f(x$b,"laya.system.System"),x$b.changeDefinition=function(x$b,x$_){x$o[x$b]=x$_;var x$s=x$b+"=classObj";x$o._runScript(x$s)},x$b.__init__=function(){x$q.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function x$s(){}return x$f(x$s,"laya.utils.Browser"),x$Q(1,x$s,"pixelRatio",function(){return x$s.__init__(),-1<x$s.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:x$Z.getPixelRatio()}),x$Q(1,x$s,"height",function(){return x$s.__init__(),(x$o.stage&&x$o.stage.canvasRotation?x$s.clientWidth:x$s.clientHeight)*x$s.pixelRatio}),x$Q(1,x$s,"clientWidth",function(){return x$s.__init__(),x$s.window.innerWidth||x$s.document.body.clientWidth}),x$Q(1,x$s,"window",function(){return x$s.__init__(),x$s._window}),x$Q(1,x$s,"clientHeight",function(){return x$s.__init__(),x$s.window.innerHeight||x$s.document.body.clientHeight||x$s.document.documentElement.clientHeight}),x$Q(1,x$s,"width",function(){return x$s.__init__(),(x$o.stage&&x$o.stage.canvasRotation?x$s.clientHeight:x$s.clientWidth)*x$s.pixelRatio}),x$Q(1,x$s,"container",function(){return x$s.__init__(),x$s._container||((x$s._container=x$s.createElement("div")).id="layaContainer",x$s.document.body.appendChild(x$s._container)),x$s._container},function(x$b){x$s._container=x$b}),x$Q(1,x$s,"document",function(){return x$s.__init__(),x$s._document}),x$s.__init__=function(){if(!x$s._window){x$s._window=x$Z.getWindow(),x$s._document=x$s.window.document,x$s._window.addEventListener("message",function(x$b){laya.utils.Browser._onMessage(x$b)},!1),x$s.document.__createElement=x$s.document.createElement,x$E.requestAnimationFrame=x$E.requestAnimationFrame||x$E.webkitRequestAnimationFrame||x$E.mozRequestAnimationFrame||x$E.oRequestAnimationFrame||x$E.msRequestAnimationFrame||function(x$b){return x$E.setTimeout(x$b,1e3/60)};var x$b=x$E.document.body.style;x$b["-webkit-user-select"]="none",x$b["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",x$s.userAgent=x$s.window.navigator.userAgent,x$s.onIOS=!!(x$s.u=x$s.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),x$s.onMobile=-1<x$s.u.indexOf("Mobile"),x$s.onIPhone=-1<x$s.u.indexOf("iPhone"),x$s.onMac=-1<x$s.u.indexOf("Mac OS X"),x$s.onIPad=-1<x$s.u.indexOf("iPad"),x$s.onAndroid=-1<x$s.u.indexOf("Android")||-1<x$s.u.indexOf("Adr"),x$s.onWP=-1<x$s.u.indexOf("Windows Phone"),x$s.onQQBrowser=-1<x$s.u.indexOf("QQBrowser"),x$s.onMQQBrowser=-1<x$s.u.indexOf("MQQBrowser")||-1<x$s.u.indexOf("Mobile")&&-1<x$s.u.indexOf("QQ"),x$s.onIE=!!x$s.window.ActiveXObject||"ActiveXObject"in x$s.window,x$s.onWeiXin=-1<x$s.u.indexOf("MicroMessenger"),x$s.onPC=!x$s.onMobile,x$s.onSafari=-1<x$s.u.indexOf("Safari"),x$s.onFirefox=-1<x$s.u.indexOf("Firefox"),x$s.onEdge=-1<x$s.u.indexOf("Edge"),x$s.onMiniGame=-1<x$s.u.indexOf("MiniGame"),x$s.onLimixiu=-1<x$s.u.indexOf("limixiu"),x$s.httpProtocol="http:"==x$s.window.location.protocol,x$s.onMiniGame&&null==x$s.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),x$s.webAudioEnabled=!!(x$s.window.AudioContext||x$s.window.webkitAudioContext||x$s.window.mozAudioContext),x$s.soundType=x$s.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",x$xb=x$s.webAudioEnabled?x$nb:x$sb,x$s.webAudioEnabled&&x$nb.initWebAudio(),x$sb._initMusicAudio(),x$s.enableTouch="ontouchstart"in x$E||x$E.DocumentTouch&&x$_ instanceof DocumentTouch,x$E.focus(),x$S._soundClass=x$xb,x$S._musicClass=x$sb,x$q._mainCanvas=x$q._mainCanvas||x$tb.create("2D"),x$s.canvas||(x$s.canvas=x$tb.create("2D"),x$s.context=x$s.canvas.getContext("2d"))}},x$s._onMessage=function(x$b){if(x$b.data&&"size"==x$b.data.name){if(x$s.window.innerWidth=x$b.data.width,x$s.window.innerHeight=x$b.data.height,x$s.window.__innerHeight=x$b.data.clientHeight,!x$s.document.createEvent)return void console.warn("no document.createEvent");var x$_=x$s.document.createEvent("HTMLEvents");return x$_.initEvent("resize",!1,!1),void x$s.window.dispatchEvent(x$_)}},x$s.createElement=function(x$b){return x$s.__init__(),x$s.document.__createElement(x$b)},x$s.getElementById=function(x$b){return x$s.__init__(),x$s.document.getElementById(x$b)},x$s.removeElement=function(x$b){x$b&&x$b.parentNode&&x$b.parentNode.removeChild(x$b)},x$s.now=function(){return x$Z.now()},x$s._window=null,x$s._document=null,x$s._container=null,x$s.userAgent=null,x$s.u=null,x$s.onIOS=!1,x$s.onMac=!1,x$s.onMobile=!1,x$s.onIPhone=!1,x$s.onIPad=!1,x$s.onAndroid=!1,x$s.onWP=!1,x$s.onQQBrowser=!1,x$s.onMQQBrowser=!1,x$s.onSafari=!1,x$s.onFirefox=!1,x$s.onEdge=!1,x$s.onIE=!1,x$s.onWeiXin=!1,x$s.onMiniGame=!1,x$s.onLimixiu=!1,x$s.onPC=!1,x$s.httpProtocol=!1,x$s.webAudioEnabled=!1,x$s.soundType=null,x$s.enableTouch=!1,x$s.canvas=null,x$s.context=null,x$s.__init$=function(){},x$s}()),x$d=function(){function x$_(x$b){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,x$b?(this._u8d_=new Uint8Array(x$b),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}x$f(x$_,"laya.utils.Byte");var x$b=x$_.prototype;return x$b.___resizeBuffer=function(x$_){try{var x$b=new Uint8Array(x$_);null!=this._u8d_&&(this._u8d_.length<=x$_?x$b.set(this._u8d_):x$b.set(this._u8d_.subarray(0,x$_))),this._u8d_=x$b,this._d_=new DataView(x$b.buffer)}catch(x$b){throw"___resizeBuffer err:"+x$_}},x$b.getString=function(){return this.rUTF(this.getUint16())},x$b.getFloat32Array=function(x$b,x$_){var x$s=x$b+x$_;x$s=x$s>this._length?this._length:x$s;var x$h=new Float32Array(this._d_.buffer.slice(x$b,x$s));return this._pos_=x$s,x$h},x$b.getUint8Array=function(x$b,x$_){var x$s=x$b+x$_;x$s=x$s>this._length?this._length:x$s;var x$h=new Uint8Array(this._d_.buffer.slice(x$b,x$s));return this._pos_=x$s,x$h},x$b.getInt16Array=function(x$b,x$_){var x$s=x$b+x$_;x$s=x$s>this._length?this._length:x$s;var x$h=new Int16Array(this._d_.buffer.slice(x$b,x$s));return this._pos_=x$s,x$h},x$b.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var x$b=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,x$b},x$b.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var x$b=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,x$b},x$b.writeFloat32=function(x$b){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,x$b,this._xd_),this._pos_+=4},x$b.writeFloat64=function(x$b){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,x$b,this._xd_),this._pos_+=8},x$b.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var x$b=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,x$b},x$b.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var x$b=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,x$b},x$b.writeInt32=function(x$b){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,x$b,this._xd_),this._pos_+=4},x$b.writeUint32=function(x$b){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,x$b,this._xd_),this._pos_+=4},x$b.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var x$b=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,x$b},x$b.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var x$b=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,x$b},x$b.writeUint16=function(x$b){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,x$b,this._xd_),this._pos_+=2},x$b.writeInt16=function(x$b){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,x$b,this._xd_),this._pos_+=2},x$b.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},x$b.writeUint8=function(x$b){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,x$b),this._pos_++},x$b._getUInt8=function(x$b){return this._d_.getUint8(x$b)},x$b._getUint16=function(x$b){return this._d_.getUint16(x$b,this._xd_)},x$b._getMatrix=function(){return new x$J(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},x$b.rUTF=function(x$b){for(var x$_=[],x$s=this._pos_+x$b,x$h=0,x$x=0,x$n=0,x$E=String.fromCharCode,x$C=this._u8d_;this._pos_<x$s;)(x$h=x$C[this._pos_++])<128?0!=x$h&&x$_.push(x$E(x$h)):x$h<224?x$_.push(x$E((63&x$h)<<6|127&x$C[this._pos_++])):x$h<240?(x$x=x$C[this._pos_++],x$_.push(x$E((31&x$h)<<12|(127&x$x)<<6|127&x$C[this._pos_++]))):(x$x=x$C[this._pos_++],x$n=x$C[this._pos_++],x$_.push(x$E((15&x$h)<<18|(127&x$x)<<12|x$n<<6&127|127&x$C[this._pos_++]))),0;return x$_.join("")},x$b.getCustomString=function(x$b){for(var x$_=[],x$s=0,x$h=0,x$x=0,x$n=String.fromCharCode,x$E=this._u8d_;0<x$b;)if((x$h=x$E[this._pos_])<128)x$_.push(x$n(x$h)),this._pos_++,x$b--;else for(x$s=x$h-128,this._pos_++,x$b-=x$s;0<x$s;)x$h=x$E[this._pos_++],x$x=x$E[this._pos_++],x$_.push(x$n(x$x<<8|x$h)),x$s--;return x$_.join("")},x$b.clear=function(){this._pos_=0,this.length=0},x$b.__getBuffer=function(){return this._d_.buffer},x$b.writeUTFBytes=function(x$b){for(var x$_=0,x$s=(x$b+="").length;x$_<x$s;x$_++){var x$h=x$b.charCodeAt(x$_);x$h<=127?this.writeByte(x$h):x$h<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|x$h>>6,128|63&x$h],this._pos_),this._pos_+=2):x$h<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|x$h>>12,128|x$h>>6&63,128|63&x$h],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|x$h>>18,128|x$h>>12&63,128|x$h>>6&63,128|63&x$h],this._pos_),this._pos_+=4)}},x$b.writeUTFString=function(x$b){var x$_=this.pos;this.writeUint16(1),this.writeUTFBytes(x$b);var x$s=this.pos-x$_-2;if(65536<=x$s)throw"writeUTFString byte len more than 65536";this._d_.setUint16(x$_,x$s,this._xd_)},x$b.readUTFString=function(){return this.readUTFBytes(this.getUint16())},x$b.getUTFString=function(){return this.readUTFString()},x$b.readUTFBytes=function(x$b){if(void 0===x$b&&(x$b=-1),0==x$b)return"";var x$_=this.bytesAvailable;if(x$_<x$b)throw"readUTFBytes error - Out of bounds";return x$b=0<x$b?x$b:x$_,this.rUTF(x$b)},x$b.getUTFBytes=function(x$b){return void 0===x$b&&(x$b=-1),this.readUTFBytes(x$b)},x$b.writeByte=function(x$b){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,x$b),this._pos_+=1},x$b.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},x$b.getByte=function(){return this.readByte()},x$b.ensureWrite=function(x$b){this._length<x$b&&(this._length=x$b),this._allocated_<x$b&&(this.length=x$b)},x$b.writeArrayBuffer=function(x$b,x$_,x$s){if(void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),x$_<0||x$s<0)throw"writeArrayBuffer error - Out of bounds";0==x$s&&(x$s=x$b.byteLength-x$_),this.ensureWrite(this._pos_+x$s);var x$h=new Uint8Array(x$b);this._u8d_.set(x$h.subarray(x$_,x$_+x$s),this._pos_),this._pos_+=x$s},x$Q(0,x$b,"buffer",function(){var x$b=this._d_.buffer;return x$b.byteLength==this.length?x$b:x$b.slice(0,this.length)}),x$Q(0,x$b,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(x$b){this._xd_="littleEndian"==x$b}),x$Q(0,x$b,"length",function(){return this._length},function(x$b){this._allocated_<x$b?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(x$b,2*this._allocated_))):this._allocated_>x$b&&this.___resizeBuffer(this._allocated_=x$b),this._length=x$b}),x$Q(0,x$b,"pos",function(){return this._pos_},function(x$b){this._pos_=x$b}),x$Q(0,x$b,"bytesAvailable",function(){return this._length-this._pos_}),x$_.getSystemEndian=function(){if(!x$_._sysEndian){var x$b=new ArrayBuffer(2);new DataView(x$b).setInt16(0,256,!0),x$_._sysEndian=256===new Int16Array(x$b)[0]?"littleEndian":"bigEndian"}return x$_._sysEndian},x$_.BIG_ENDIAN="bigEndian",x$_.LITTLE_ENDIAN="littleEndian",x$_._sysEndian=null,x$_}(),x$I=function(){function x$x(){}return x$f(x$x,"laya.utils.CacheManager"),x$x.regCacheByFunction=function(x$b,x$_){var x$s;x$x.unRegCacheByFunction(x$b,x$_),x$s={tryDispose:x$b,getCacheList:x$_},x$x._cacheList.push(x$s)},x$x.unRegCacheByFunction=function(x$b,x$_){var x$s,x$h=0;for(x$s=x$x._cacheList.length,x$h=0;x$h<x$s;x$h++)if(x$x._cacheList[x$h].tryDispose==x$b&&x$x._cacheList[x$h].getCacheList==x$_)return void x$x._cacheList.splice(x$h,1)},x$x.forceDispose=function(){var x$b=0,x$_=x$x._cacheList.length;for(x$b=0;x$b<x$_;x$b++)x$x._cacheList[x$b].tryDispose(!0)},x$x.beginCheck=function(x$b){void 0===x$b&&(x$b=15e3),x$o.timer.loop(x$b,null,x$x._checkLoop)},x$x.stopCheck=function(){x$o.timer.clear(null,x$x._checkLoop)},x$x._checkLoop=function(){var x$b=x$x._cacheList;if(!(x$b.length<1)){var x$_,x$s=x$K.now(),x$h=0;for(x$_=x$h=x$b.length;0<x$h&&(x$b[x$x._index=++x$x._index%x$_].tryDispose(!1),!(x$K.now()-x$s>x$x.loopTimeLimit));)x$h--}},x$x.loopTimeLimit=2,x$x._cacheList=[],x$x._index=0,x$x}(),x$g=function(){function x$V(){}return x$f(x$V,"laya.utils.ClassUtils"),x$V.regClass=function(x$b,x$_){x$V._classMap[x$b]=x$_},x$V.getRegClass=function(x$b){return x$V._classMap[x$b]},x$V.getInstance=function(x$b){var x$_=x$V.getClass(x$b);return x$_?new x$_:(console.warn("[error] Undefined class:",x$b),null)},x$V.createByJson=function(x$b,x$_,x$s,x$h,x$x){"string"==typeof x$b&&(x$b=JSON.parse(x$b));var x$n=x$b.props;if(!x$_&&!(x$_=x$x?x$x.runWith(x$b):x$V.getInstance(x$n.runtime||x$b.type)))return null;var x$E=x$b.child;if(x$E)for(var x$C=0,x$O=x$E.length;x$C<x$O;x$C++){var x$L=x$E[x$C];if("render"!==x$L.props.name&&"render"!==x$L.props.renderType||!x$_._$set_itemRender)if("Graphic"==x$L.type)x$V.addGraphicsToSprite(x$L,x$_);else if(x$V.isDrawType(x$L.type))x$V.addGraphicToSprite(x$L,x$_,!0);else{var x$f=x$V.createByJson(x$L,null,x$s,x$h,x$x);"Script"==x$L.type?x$f.hasOwnProperty("owner")?x$f.owner=x$_:x$f.hasOwnProperty("target")&&(x$f.target=x$_):"mask"==x$L.props.renderType?x$_.mask=x$f:x$_.addChild(x$f)}else x$_.itemRender=x$L}if(x$n)for(var x$p in x$n){var x$P=x$n[x$p];"var"===x$p&&x$s?x$s[x$P]=x$_:x$P instanceof Array&&"function"==typeof x$_[x$p]?x$_[x$p].apply(x$_,x$P):x$_[x$p]=x$P}return x$h&&x$b.customProps&&x$h.runWith([x$_,x$b]),x$_.created&&x$_.created(),x$_},x$V.addGraphicsToSprite=function(x$b,x$_){var x$s;if((x$s=x$b.child)&&!(x$s.length<1)){var x$h;x$h=x$V._getGraphicsFromSprite(x$b,x$_);var x$x=0,x$n=0;x$b.props&&(x$x=x$V._getObjVar(x$b.props,"x",0),x$n=x$V._getObjVar(x$b.props,"y",0)),0!=x$x&&0!=x$n&&x$h.translate(x$x,x$n);var x$E,x$C=0;for(x$E=x$s.length,x$C=0;x$C<x$E;x$C++)x$V._addGraphicToGraphics(x$s[x$C],x$h);0!=x$x&&0!=x$n&&x$h.translate(-x$x,-x$n)}},x$V.addGraphicToSprite=function(x$b,x$_,x$s){var x$h;void 0===x$s&&(x$s=!1),x$h=x$s?x$V._getGraphicsFromSprite(x$b,x$_):x$_.graphics,x$V._addGraphicToGraphics(x$b,x$h)},x$V._getGraphicsFromSprite=function(x$b,x$_){var x$s,x$h;if(!x$b||!x$b.props)return x$_.graphics;switch(x$h=x$b.props.renderType){case"hit":case"unHit":var x$x;x$_.hitArea||(x$_.hitArea=new x$l),(x$x=x$_.hitArea)[x$h]||(x$x[x$h]=new x$P),x$s=x$x[x$h]}return x$s||(x$s=x$_.graphics),x$s},x$V._getTransformData=function(x$b){var x$_;(x$b.hasOwnProperty("pivotX")||x$b.hasOwnProperty("pivotY"))&&(x$_=x$_||new x$J).translate(-x$V._getObjVar(x$b,"pivotX",0),-x$V._getObjVar(x$b,"pivotY",0));var x$s=x$V._getObjVar(x$b,"scaleX",1),x$h=x$V._getObjVar(x$b,"scaleY",1),x$x=x$V._getObjVar(x$b,"rotation",0);x$V._getObjVar(x$b,"skewX",0),x$V._getObjVar(x$b,"skewY",0);return 1==x$s&&1==x$h&&0==x$x||((x$_=x$_||new x$J).scale(x$s,x$h),x$_.rotate(.0174532922222222*x$x)),x$_},x$V._addGraphicToGraphics=function(x$b,x$_){var x$s,x$h;if((x$s=x$b.props)&&(x$h=x$V.DrawTypeDic[x$b.type])){var x$x,x$n;x$x=x$_;var x$E=x$V._getParams(x$s,x$h[1],x$h[2],x$h[3]);((x$n=x$V._tM)||1!=x$V._alpha)&&(x$x.save(),x$n&&x$x.transform(x$n),1!=x$V._alpha&&x$x.alpha(x$V._alpha)),x$x[x$h[0]].apply(x$x,x$E),(x$n||1!=x$V._alpha)&&x$x.restore()}},x$V._adptLineData=function(x$b){return x$b[2]=parseFloat(x$b[0])+parseFloat(x$b[2]),x$b[3]=parseFloat(x$b[1])+parseFloat(x$b[3]),x$b},x$V._adptTextureData=function(x$b){return x$b[0]=x$Cb.getRes(x$b[0]),x$b},x$V._adptLinesData=function(x$b){return x$b[2]=x$V._getPointListByStr(x$b[2]),x$b},x$V.isDrawType=function(x$b){return"Image"!=x$b&&x$V.DrawTypeDic.hasOwnProperty(x$b)},x$V._getParams=function(x$b,x$_,x$s,x$h){var x$x;void 0===x$s&&(x$s=0),(x$x=x$V._temParam).length=x$_.length;var x$n,x$E,x$C=0;for(x$n=x$_.length,x$C=0;x$C<x$n;x$C++)x$x[x$C]=x$V._getObjVar(x$b,x$_[x$C][0],x$_[x$C][1]);return x$V._alpha=x$V._getObjVar(x$b,"alpha",1),x$E=x$V._getTransformData(x$b),x$V._tM=x$E?(x$s||(x$s=0),x$E.translate(x$x[x$s],x$x[x$s+1]),x$x[x$s]=x$x[x$s+1]=0,x$E):null,x$h&&x$V[x$h]&&(x$x=x$V[x$h](x$x)),x$x},x$V._getPointListByStr=function(x$b){var x$_,x$s,x$h=0;for(x$s=(x$_=x$b.split(",")).length,x$h=0;x$h<x$s;x$h++)x$_[x$h]=parseFloat(x$_[x$h]);return x$_},x$V._getObjVar=function(x$b,x$_,x$s){return x$b.hasOwnProperty(x$_)?x$b[x$_]:x$s},x$V._temParam=[],x$V._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},x$V.getClass=function(x$b){var x$_=x$V._classMap[x$b]||x$b;return"string"==typeof x$_?x$o.__classmap[x$_]:x$_},x$V._tM=null,x$V._alpha=NaN,x$O(x$V,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),x$V}(),x$F=function(){function x$n(x$b){if(this._color=[],"string"==typeof x$b){null===(this.strColor=x$b)&&(x$b="#000000"),"#"==x$b.charAt(0)&&(x$b=x$b.substr(1));var x$_=x$b.length;if(3==x$_||4==x$_){for(var x$s="",x$h=0;x$h<x$_;x$h++)x$s+=x$b[x$h]+x$b[x$h];x$b=x$s}var x$x=this.numColor=parseInt(x$b,16);if(8==x$b.length)return void(this._color=[parseInt(x$b.substr(0,2),16)/255,((16711680&x$x)>>16)/255,((65280&x$x)>>8)/255,(255&x$x)/255])}else x$x=this.numColor=x$b,this.strColor=x$e.toHexColor(x$x);this._color=[((16711680&x$x)>>16)/255,((65280&x$x)>>8)/255,(255&x$x)/255,1],this._color.__id=++x$n._COLODID}return x$f(x$n,"laya.utils.Color"),x$n._initDefault=function(){for(var x$b in x$n._DEFAULT={},x$n._COLOR_MAP)x$n._SAVE[x$b]=x$n._DEFAULT[x$b]=new x$n(x$n._COLOR_MAP[x$b]);return x$n._DEFAULT},x$n._initSaveMap=function(){for(var x$b in x$n._SAVE_SIZE=0,x$n._SAVE={},x$n._DEFAULT)x$n._SAVE[x$b]=x$n._DEFAULT[x$b]},x$n.create=function(x$b){var x$_=x$n._SAVE[x$b+""];return null!=x$_?x$_:(x$n._SAVE_SIZE<1e3||x$n._initSaveMap(),x$n._SAVE[x$b+""]=new x$n(x$b))},x$n._SAVE={},x$n._SAVE_SIZE=0,x$n._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},x$n._DEFAULT=x$n._initDefault(),x$n._COLODID=1,x$n}(),x$A=(function(){function x$b(){this._values=[],this._keys=[]}x$f(x$b,"laya.utils.Dictionary");var x$_=x$b.prototype;x$_.set=function(x$b,x$_){var x$s=this.indexOf(x$b);0<=x$s?this._values[x$s]=x$_:(this._keys.push(x$b),this._values.push(x$_))},x$_.indexOf=function(x$b){var x$_=this._keys.indexOf(x$b);return 0<=x$_?x$_:(x$b="string"==typeof x$b?Number(x$b):"number"==typeof x$b?x$b.toString():x$b,this._keys.indexOf(x$b))},x$_.get=function(x$b){var x$_=this.indexOf(x$b);return x$_<0?null:this._values[x$_]},x$_.remove=function(x$b){var x$_=this.indexOf(x$b);return 0<=x$_&&(this._keys.splice(x$_,1),this._values.splice(x$_,1),!0)},x$_.clear=function(){this._values.length=0,this._keys.length=0},x$Q(0,x$_,"values",function(){return this._values}),x$Q(0,x$_,"keys",function(){return this._keys})}(),function(){function x$b(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}x$f(x$b,"laya.utils.Dragging");var x$_=x$b.prototype;return x$_.start=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){void 0===x$C&&(x$C=.92),this.clearTimer(),this.target=x$b,this.area=x$_,this.hasInertia=x$s,this.elasticDistance=x$_?x$h:0,this.elasticBackTime=x$x,this.data=x$n,this._disableMouseEvent=x$E,this.ratio=x$C,1!=x$b.globalScaleX||1!=x$b.globalScaleY?this._parent=x$b.parent:this._parent=x$o.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,x$o.stage.on("mouseup",this,this.onStageMouseUp),x$o.stage.on("mouseout",this,this.onStageMouseUp),x$o.timer.frameLoop(1,this,this.loop)},x$_.clearTimer=function(){x$o.timer.clear(this,this.loop),x$o.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},x$_.stop=function(){this._dragging&&(x$y.instance.disableMouseEvent=!1,x$o.stage.off("mouseup",this,this.onStageMouseUp),x$o.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},x$_.loop=function(){var x$b=this._parent.getMousePoint(),x$_=x$b.x,x$s=x$b.y,x$h=x$_-this._lastX,x$x=x$s-this._lastY;if(this._clickOnly){if(!(1<Math.abs(x$h*x$o.stage._canvasTransform.getScaleX())||1<Math.abs(x$x*x$o.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),x$y.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(x$h,x$x);0==x$h&&0==x$x||(this._lastX=x$_,this._lastY=x$s,this.target.x+=x$h*this._elasticRateX,this.target.y+=x$x*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},x$_.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var x$b=this.area.x-this.target.x;else x$b=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-x$b/this.elasticDistance),this.target.y<this.area.y)var x$_=this.area.y-this.target.y;else x$_=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-x$_/this.elasticDistance)}},x$_.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},x$_.onStageMouseUp=function(x$b){if(x$y.instance.disableMouseEvent=!1,x$o.stage.off("mouseup",this,this.onStageMouseUp),x$o.stage.off("mouseout",this,this.onStageMouseUp),x$o.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var x$_=this._offsets.length,x$s=Math.min(x$_,6),x$h=this._offsets.length-x$s,x$x=x$_-1;x$h<x$x;x$x--)this._offsetY+=this._offsets[x$x--],this._offsetX+=this._offsets[x$x];this._offsetX=this._offsetX/x$s*2,this._offsetY=this._offsetY/x$s*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),x$o.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},x$_.checkElastic=function(){var x$b=NaN,x$_=NaN;if(this.target.x<this.area.x?x$b=this.area.x:this.target.x>this.area.x+this.area.width&&(x$b=this.area.x+this.area.width),this.target.y<this.area.y?x$_=this.area.y:this.target.y>this.area.y+this.area.height&&(x$_=this.area.y+this.area.height),isNaN(x$b)&&isNaN(x$_))this.clear();else{var x$s={};isNaN(x$b)||(x$s.x=x$b),isNaN(x$_)||(x$s.y=x$_),this._tween=x$m.to(this.target,x$s,this.elasticBackTime,x$u.sineOut,x$R.create(this,this.clear),0,!1,!1)}},x$_.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(x$o.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},x$_.clear=function(){if(this.target){this.clearTimer();var x$b=this.target;this.target=null,this._parent=null,x$b.event("dragend",this.data)}},x$b}()),x$u=function(){function x$C(){}return x$f(x$C,"laya.utils.Ease"),x$C.linearNone=function(x$b,x$_,x$s,x$h){return x$s*x$b/x$h+x$_},x$C.linearIn=function(x$b,x$_,x$s,x$h){return x$s*x$b/x$h+x$_},x$C.linearInOut=function(x$b,x$_,x$s,x$h){return x$s*x$b/x$h+x$_},x$C.linearOut=function(x$b,x$_,x$s,x$h){return x$s*x$b/x$h+x$_},x$C.bounceIn=function(x$b,x$_,x$s,x$h){return x$s-x$C.bounceOut(x$h-x$b,0,x$s,x$h)+x$_},x$C.bounceInOut=function(x$b,x$_,x$s,x$h){return x$b<.5*x$h?.5*x$C.bounceIn(2*x$b,0,x$s,x$h)+x$_:.5*x$C.bounceOut(2*x$b-x$h,0,x$s,x$h)+.5*x$s+x$_},x$C.bounceOut=function(x$b,x$_,x$s,x$h){return(x$b/=x$h)<1/2.75?x$s*(7.5625*x$b*x$b)+x$_:x$b<2/2.75?x$s*(7.5625*(x$b-=1.5/2.75)*x$b+.75)+x$_:x$b<2.5/2.75?x$s*(7.5625*(x$b-=2.25/2.75)*x$b+.9375)+x$_:x$s*(7.5625*(x$b-=2.625/2.75)*x$b+.984375)+x$_},x$C.backIn=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=1.70158),x$s*(x$b/=x$h)*x$b*((x$x+1)*x$b-x$x)+x$_},x$C.backInOut=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=1.70158),(x$b/=.5*x$h)<1?.5*x$s*(x$b*x$b*((1+(x$x*=1.525))*x$b-x$x))+x$_:x$s/2*((x$b-=2)*x$b*((1+(x$x*=1.525))*x$b+x$x)+2)+x$_},x$C.backOut=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=1.70158),x$s*((x$b=x$b/x$h-1)*x$b*((x$x+1)*x$b+x$x)+1)+x$_},x$C.elasticIn=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E;return void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=0),0==x$b?x$_:1==(x$b/=x$h)?x$_+x$s:(x$n||(x$n=.3*x$h),x$E=!x$x||0<x$s&&x$x<x$s||x$s<0&&x$x<-x$s?(x$x=x$s,x$n/4):x$n/x$C.PI2*Math.asin(x$s/x$x),-x$x*Math.pow(2,10*(x$b-=1))*Math.sin((x$b*x$h-x$E)*x$C.PI2/x$n)+x$_)},x$C.elasticInOut=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E;return void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=0),0==x$b?x$_:2==(x$b/=.5*x$h)?x$_+x$s:(x$n||(x$n=x$h*(.3*1.5)),x$E=!x$x||0<x$s&&x$x<x$s||x$s<0&&x$x<-x$s?(x$x=x$s,x$n/4):x$n/x$C.PI2*Math.asin(x$s/x$x),x$b<1?x$x*Math.pow(2,10*(x$b-=1))*Math.sin((x$b*x$h-x$E)*x$C.PI2/x$n)*-.5+x$_:x$x*Math.pow(2,-10*(x$b-=1))*Math.sin((x$b*x$h-x$E)*x$C.PI2/x$n)*.5+x$s+x$_)},x$C.elasticOut=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E;return void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=0),0==x$b?x$_:1==(x$b/=x$h)?x$_+x$s:(x$n||(x$n=.3*x$h),x$E=!x$x||0<x$s&&x$x<x$s||x$s<0&&x$x<-x$s?(x$x=x$s,x$n/4):x$n/x$C.PI2*Math.asin(x$s/x$x),x$x*Math.pow(2,-10*x$b)*Math.sin((x$b*x$h-x$E)*x$C.PI2/x$n)+x$s+x$_)},x$C.strongIn=function(x$b,x$_,x$s,x$h){return x$s*(x$b/=x$h)*x$b*x$b*x$b*x$b+x$_},x$C.strongInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*x$s*x$b*x$b*x$b*x$b*x$b+x$_:.5*x$s*((x$b-=2)*x$b*x$b*x$b*x$b+2)+x$_},x$C.strongOut=function(x$b,x$_,x$s,x$h){return x$s*((x$b=x$b/x$h-1)*x$b*x$b*x$b*x$b+1)+x$_},x$C.sineInOut=function(x$b,x$_,x$s,x$h){return.5*-x$s*(Math.cos(Math.PI*x$b/x$h)-1)+x$_},x$C.sineIn=function(x$b,x$_,x$s,x$h){return-x$s*Math.cos(x$b/x$h*x$C.HALF_PI)+x$s+x$_},x$C.sineOut=function(x$b,x$_,x$s,x$h){return x$s*Math.sin(x$b/x$h*x$C.HALF_PI)+x$_},x$C.quintIn=function(x$b,x$_,x$s,x$h){return x$s*(x$b/=x$h)*x$b*x$b*x$b*x$b+x$_},x$C.quintInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*x$s*x$b*x$b*x$b*x$b*x$b+x$_:.5*x$s*((x$b-=2)*x$b*x$b*x$b*x$b+2)+x$_},x$C.quintOut=function(x$b,x$_,x$s,x$h){return x$s*((x$b=x$b/x$h-1)*x$b*x$b*x$b*x$b+1)+x$_},x$C.quartIn=function(x$b,x$_,x$s,x$h){return x$s*(x$b/=x$h)*x$b*x$b*x$b+x$_},x$C.quartInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*x$s*x$b*x$b*x$b*x$b+x$_:.5*-x$s*((x$b-=2)*x$b*x$b*x$b-2)+x$_},x$C.quartOut=function(x$b,x$_,x$s,x$h){return-x$s*((x$b=x$b/x$h-1)*x$b*x$b*x$b-1)+x$_},x$C.cubicIn=function(x$b,x$_,x$s,x$h){return x$s*(x$b/=x$h)*x$b*x$b+x$_},x$C.cubicInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*x$s*x$b*x$b*x$b+x$_:.5*x$s*((x$b-=2)*x$b*x$b+2)+x$_},x$C.cubicOut=function(x$b,x$_,x$s,x$h){return x$s*((x$b=x$b/x$h-1)*x$b*x$b+1)+x$_},x$C.quadIn=function(x$b,x$_,x$s,x$h){return x$s*(x$b/=x$h)*x$b+x$_},x$C.quadInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*x$s*x$b*x$b+x$_:.5*-x$s*(--x$b*(x$b-2)-1)+x$_},x$C.quadOut=function(x$b,x$_,x$s,x$h){return-x$s*(x$b/=x$h)*(x$b-2)+x$_},x$C.expoIn=function(x$b,x$_,x$s,x$h){return 0==x$b?x$_:x$s*Math.pow(2,10*(x$b/x$h-1))+x$_-.001*x$s},x$C.expoInOut=function(x$b,x$_,x$s,x$h){return 0==x$b?x$_:x$b==x$h?x$_+x$s:(x$b/=.5*x$h)<1?.5*x$s*Math.pow(2,10*(x$b-1))+x$_:.5*x$s*(2-Math.pow(2,-10*--x$b))+x$_},x$C.expoOut=function(x$b,x$_,x$s,x$h){return x$b==x$h?x$_+x$s:x$s*(1-Math.pow(2,-10*x$b/x$h))+x$_},x$C.circIn=function(x$b,x$_,x$s,x$h){return-x$s*(Math.sqrt(1-(x$b/=x$h)*x$b)-1)+x$_},x$C.circInOut=function(x$b,x$_,x$s,x$h){return(x$b/=.5*x$h)<1?.5*-x$s*(Math.sqrt(1-x$b*x$b)-1)+x$_:.5*x$s*(Math.sqrt(1-(x$b-=2)*x$b)+1)+x$_},x$C.circOut=function(x$b,x$_,x$s,x$h){return x$s*Math.sqrt(1-(x$b=x$b/x$h-1)*x$b)+x$_},x$C.HALF_PI=.5*Math.PI,x$C.PI2=2*Math.PI,x$C}(),x$l=function(){function x$p(){this._hit=null,this._unHit=null}x$f(x$p,"laya.utils.HitArea");var x$b=x$p.prototype;return x$b.isHit=function(x$b,x$_){return!!x$p.isHitGraphic(x$b,x$_,this.hit)&&!x$p.isHitGraphic(x$b,x$_,this.unHit)},x$b.contains=function(x$b,x$_){return this.isHit(x$b,x$_)},x$Q(0,x$b,"hit",function(){return this._hit||(this._hit=new x$P),this._hit},function(x$b){this._hit=x$b}),x$Q(0,x$b,"unHit",function(){return this._unHit||(this._unHit=new x$P),this._unHit},function(x$b){this._unHit=x$b}),x$p.isHitGraphic=function(x$b,x$_,x$s){if(!x$s)return!1;var x$h;if(!(x$h=x$s.cmds)&&x$s._one&&((x$h=x$p._cmds).length=1,x$h[0]=x$s._one),!x$h)return!1;var x$x,x$n,x$E=0;for(x$x=x$h.length,x$E=0;x$E<x$x;x$E++)if(x$n=x$h[x$E]){var x$C=x$q._context;switch(x$n.callee){case x$C._translate:case 6:x$b-=x$n[0],x$_-=x$n[1]}if(x$p.isHitCmd(x$b,x$_,x$n))return!0}return!1},x$p.isHitCmd=function(x$b,x$_,x$s){if(!x$s)return!1;var x$h=x$q._context,x$x=!1;switch(x$s.callee){case x$h._drawRect:case 13:x$p._rec.setTo(x$s[0],x$s[1],x$s[2],x$s[3]),x$x=x$p._rec.contains(x$b,x$_);break;case x$h._drawCircle:case x$h._fillCircle:case 14:x$x=(x$b-=x$s[0])*x$b+(x$_-=x$s[1])*x$_<x$s[2]*x$s[2];break;case x$h._drawPoly:case 18:x$b-=x$s[0],x$_-=x$s[1],x$x=x$p.ptInPolygon(x$b,x$_,x$s[2])}return x$x},x$p.ptInPolygon=function(x$b,x$_,x$s){var x$h;(x$h=x$p._ptPoint).setTo(x$b,x$_);var x$x,x$n=0,x$E=NaN,x$C=NaN,x$O=NaN,x$L=NaN;x$x=x$s.length;for(var x$f=0;x$f<x$x;x$f+=2){if(x$E=x$s[x$f],x$C=x$s[x$f+1],x$O=x$s[(x$f+2)%x$x],x$C!=(x$L=x$s[(x$f+3)%x$x]))if(!(x$h.y<Math.min(x$C,x$L)))if(!(x$h.y>=Math.max(x$C,x$L)))(x$h.y-x$C)*(x$O-x$E)/(x$L-x$C)+x$E>x$h.x&&x$n++}return x$n%2==1},x$p._cmds=[],x$O(x$p,["_rec",function(){return this._rec=new x$r},"_ptPoint",function(){return this._ptPoint=new x$M}]),x$p}(),x$N=(function(){function x$x(x$b,x$_,x$s,x$h){this.char=x$b,this.charNum=x$b.charCodeAt(0),this._x=this._y=0,this.width=x$_,this.height=x$s,this.style=x$h,this.isWord=!x$x._isWordRegExp.test(x$b)}x$f(x$x,"laya.utils.HTMLChar");var x$b=x$x.prototype;x$o.imps(x$b,{"laya.display.ILayout":!0}),x$b.setSprite=function(x$b){this._sprite=x$b},x$b.getSprite=function(){return this._sprite},x$b._isChar=function(){return!0},x$b._getCSSStyle=function(){return this.style},x$Q(0,x$b,"width",function(){return this._w},function(x$b){this._w=x$b}),x$Q(0,x$b,"x",function(){return this._x},function(x$b){this._sprite&&(this._sprite.x=x$b),this._x=x$b}),x$Q(0,x$b,"y",function(){return this._y},function(x$b){this._sprite&&(this._sprite.y=x$b),this._y=x$b}),x$Q(0,x$b,"height",function(){return this._h},function(x$b){this._h=x$b}),x$x._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function x$_(){}x$f(x$_,"laya.utils.Log"),x$_.enable=function(){x$_._logdiv||(x$_._logdiv=x$K.window.document.createElement("div"),x$K.window.document.body.appendChild(x$_._logdiv),x$_._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},x$_.toggle=function(){var x$b=x$_._logdiv.style;"1px"==x$b.width?x$b.width=x$b.height="50%":x$b.width=x$b.height="1px"},x$_.print=function(x$b){x$_._logdiv&&(x$_.maxCount<=x$_._count&&x$_.clear(),x$_._count++,x$_._logdiv.innerText+=x$b+"\n",x$_._logdiv.scrollTop=x$_._logdiv.scrollHeight)},x$_.clear=function(){x$_._logdiv.innerText="",x$_._count=0},x$_._logdiv=null,x$_._count=0,x$_.maxCount=20}(),function(){function x$_(){}x$f(x$_,"laya.utils.Mouse"),x$Q(1,x$_,"cursor",function(){return x$_._style.cursor},function(x$b){x$_._style.cursor=x$b}),x$_.hide=function(){"none"!=x$_.cursor&&(x$_._preCursor=x$_.cursor,x$_.cursor="none")},x$_.show=function(){"none"==x$_.cursor&&(x$_.cursor=x$_._preCursor?x$_._preCursor:"auto")},x$_._preCursor=null,x$O(x$_,["_style",function(){return this._style=x$K.document.body.style}])}(),function(){function x$n(){}return x$f(x$n,"laya.utils.Pool"),x$n.getPoolBySign=function(x$b){return x$n._poolDic[x$b]||(x$n._poolDic[x$b]=[])},x$n.clearBySign=function(x$b){x$n._poolDic[x$b]&&(x$n._poolDic[x$b].length=0)},x$n.recover=function(x$b,x$_){x$_.__InPool||(x$_.__InPool=!0,x$n.getPoolBySign(x$b).push(x$_))},x$n.getItemByClass=function(x$b,x$_){var x$s=x$n.getPoolBySign(x$b),x$h=x$s.length?x$s.pop():new x$_;return x$h.__InPool=!1,x$h},x$n.getItemByCreateFun=function(x$b,x$_,x$s){var x$h=x$n.getPoolBySign(x$b),x$x=x$h.length?x$h.pop():x$_.call(x$s);return x$x.__InPool=!1,x$x},x$n.getItem=function(x$b){var x$_=x$n.getPoolBySign(x$b),x$s=x$_.length?x$_.pop():null;return x$s&&(x$s.__InPool=!1),x$s},x$n._poolDic={},x$n.InPoolSign="__InPool",x$n}()),x$X=function(){function x$O(){}return x$f(x$O,"laya.utils.Stat"),x$Q(1,x$O,"onclick",null,function(x$b){x$O._sp&&x$O._sp.on("click",x$O._sp,x$b),x$O._canvas&&(x$O._canvas.source.onclick=x$b,x$O._canvas.source.style.pointerEvents="")}),x$O.show=function(x$b,x$_,x$s){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),!x$q.isConchApp||x$q.isConchWebGL){if(x$q.isConchWebGL||x$K.onMiniGame||x$K.onLimixiu||(x$O._useCanvas=!0),x$O._show=!0,x$O._fpsData.length=60,x$O._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},x$O._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},x$O._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},x$O._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},x$q.isWebGL)if(x$O._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},x$q.is3DMode){if(x$O._view[0].title="FPS(3D)",x$O._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},x$O._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},x$O._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==x$s){var x$h=8;x$O._view[x$h++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},x$O._view[x$h++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},x$O._view[x$h++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==x$s){x$h=8;x$O._view[x$h++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},x$O._view[x$h++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else x$O._view[0].title="FPS(WebGL)",x$O._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else x$O._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};x$O._useCanvas?x$O.createUIPre(x$b,x$_):x$O.createUI(x$b,x$_),x$O.enable()}else x$K.window.conch.showFPS&&x$K.window.conch.showFPS(x$b,x$_)},x$O.createUIPre=function(x$b,x$_){var x$s=x$K.pixelRatio;x$O._width=170*x$s,x$O._vx=75*x$s,x$O._height=x$s*(12*x$O._view.length+3*x$s)+4,x$O._fontSize=12*x$s;for(var x$h=0;x$h<x$O._view.length;x$h++)x$O._view[x$h].x=4,x$O._view[x$h].y=x$h*x$O._fontSize+2*x$s;x$O._canvas||((x$O._canvas=new x$tb("2D")).size(x$O._width,x$O._height),(x$O._ctx=x$O._canvas.getContext("2d")).textBaseline="top",x$O._ctx.font=x$O._fontSize+"px Sans-serif",x$O._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+x$b+"px;top:"+x$_+"px;width:"+x$O._width/x$s+"px;height:"+x$O._height/x$s+"px;"),x$O._first=!0,x$O.loop(),x$O._first=!1,x$K.container.appendChild(x$O._canvas.source)},x$O.createUI=function(x$b,x$_){var x$s=x$O._sp,x$h=x$K.pixelRatio;x$s||(x$s=new x$pb,(x$O._leftText=new x$wb).pos(5,5),x$O._leftText.color="#ffffff",x$s.addChild(x$O._leftText),(x$O._txt=new x$wb).pos(80*x$h,5),x$O._txt.color="#ffffff",x$s.addChild(x$O._txt),x$O._sp=x$s),x$s.pos(x$b,x$_);for(var x$x="",x$n=0;x$n<x$O._view.length;x$n++){x$x+=x$O._view[x$n].title+"\n"}x$O._leftText.text=x$x;var x$E=170*x$h,x$C=x$h*(12*x$O._view.length+3*x$h)+4;x$O._txt.fontSize=x$O._fontSize*x$h,x$O._leftText.fontSize=x$O._fontSize*x$h,x$s.size(x$E,x$C),x$s.graphics.clear(),x$s.graphics.setAlpha(.5),x$s.graphics.drawRect(0,0,x$E,x$C,"#999999"),x$s.graphics.setAlpha(1),x$O.loop()},x$O.enable=function(){x$o.timer.frameLoop(1,x$O,x$O.loop)},x$O.hide=function(){x$O._show=!1,x$o.timer.clear(x$O,x$O.loop),x$O._canvas&&x$K.removeElement(x$O._canvas.source)},x$O.clear=function(){x$O.trianglesFaces=x$O.drawCall=x$O.shaderCall=x$O.spriteCount=x$O.spriteRenderUseCacheCount=x$O.treeNodeCollision=x$O.treeSpriteCollision=x$O.canvasNormal=x$O.canvasBitmap=x$O.canvasReCache=0},x$O.loop=function(){x$O._count++;var x$b=x$K.now();if(!(x$b-x$O._timer<1e3)){var x$_=x$O._count;if(x$O.FPS=Math.round(1e3*x$_/(x$b-x$O._timer)),x$O._show){x$O.trianglesFaces=Math.round(x$O.trianglesFaces/x$_),x$O.spriteCount=x$O._useCanvas?(x$O.drawCall=Math.round(x$O.drawCall/x$_)-2,x$O.shaderCall=Math.round(x$O.shaderCall/x$_),Math.round(x$O.spriteCount/x$_)-1):(x$O.drawCall=Math.round(x$O.drawCall/x$_)-2,x$O.shaderCall=Math.round(x$O.shaderCall/x$_)-4,Math.round(x$O.spriteCount/x$_)-4),x$O.spriteRenderUseCacheCount=Math.round(x$O.spriteRenderUseCacheCount/x$_),x$O.canvasNormal=Math.round(x$O.canvasNormal/x$_),x$O.canvasBitmap=Math.round(x$O.canvasBitmap/x$_),x$O.canvasReCache=Math.ceil(x$O.canvasReCache/x$_),x$O.treeNodeCollision=Math.round(x$O.treeNodeCollision/x$_),x$O.treeSpriteCollision=Math.round(x$O.treeSpriteCollision/x$_);var x$s=0<x$O.FPS?Math.floor(1e3/x$O.FPS).toString():" ";x$O._fpsStr=x$O.FPS+(x$O.renderSlow?" slow":"")+" "+x$s,x$O._spriteStr=x$O.spriteCount+(x$O.spriteRenderUseCacheCount?"/"+x$O.spriteRenderUseCacheCount:""),x$O._canvasStr=x$O.canvasReCache+"/"+x$O.canvasNormal+"/"+x$O.canvasBitmap,x$O.currentMemorySize=x$a.systemResourceManager.memorySize,x$O._useCanvas?x$O.renderInfoPre():x$O.renderInfo(),x$O.clear()}x$O._count=0,x$O._timer=x$b}},x$O.renderInfoPre=function(){if(x$O._canvas){var x$b=x$O._ctx;x$b.clearRect(x$O._first?0:x$O._vx,0,x$O._width,x$O._height);for(var x$_=x$q.WebGL.mainContext,x$s=0;x$s<x$O._view.length;x$s++){var x$h=x$O._view[x$s];x$O._first&&(x$b.fillStyle="white",x$b.fillText(x$h.title,x$h.x,x$h.y,null,null,null)),x$b.fillStyle=x$h.color;var x$x=-1;if((x$h=x$O._view[x$s]).varying){if(x$_)switch(x$h.varying){case 1:x$x=x$_.getParameter(x$_[x$h.value]);break;case 2:x$x=x$_.getExtension(x$h.value)}}else x$x=x$O[x$h.value];"M"==x$h.units&&(x$x=Math.floor(x$x/1048576*100)/100+" M"),"K"==x$h.units&&(x$x=Math.floor(x$x/1024*100)/100+" K"),"string"==x$h.units&&(x$x=x$x.match(/\d+\.?\d/i)),x$b.fillText(x$x+"",x$h.x+x$O._vx,x$h.y,null,null,null)}}},x$O.renderInfo=function(){for(var x$b="",x$_=x$q.WebGL.mainContext,x$s=0;x$s<x$O._view.length;x$s++){var x$h=x$O._view[x$s],x$x=-1;if(x$h.varying){if(x$_)switch(x$h.varying){case 1:x$x=x$_.getParameter(x$_[x$h.value]);break;case 2:x$x=x$_.getExtension(x$h.value)}}else x$x=x$O[x$h.value];"M"==x$h.units&&(x$x=Math.floor(x$x/1048576*100)/100+" M"),"K"==x$h.units&&(x$x=Math.floor(x$x/1024*100)/100+" K"),"string"==x$h.units&&(x$x=x$x.match(/\d+\.?\d/i)),x$b+=x$x+"\n"}x$O._txt.text=x$b},x$O.FPS=0,x$O.loopCount=0,x$O.shaderCall=0,x$O.drawCall=0,x$O.trianglesFaces=0,x$O.spriteCount=0,x$O.spriteRenderUseCacheCount=0,x$O.treeNodeCollision=0,x$O.treeSpriteCollision=0,x$O.canvasNormal=0,x$O.canvasBitmap=0,x$O.canvasReCache=0,x$O.renderSlow=!1,x$O.currentMemorySize=0,x$O._fpsStr=null,x$O._canvasStr=null,x$O._spriteStr=null,x$O._fpsData=[],x$O._timer=0,x$O._count=0,x$O._view=[],x$O._fontSize=12,x$O._txt=null,x$O._leftText=null,x$O._sp=null,x$O._show=!1,x$O._useCanvas=!1,x$O._canvas=null,x$O._ctx=null,x$O._first=!1,x$O._vx=NaN,x$O._width=0,x$O._height=100,x$O}(),x$Y=(function(){function x$b(){this._strsToID={},this._idToStrs=[],this._length=0}x$f(x$b,"laya.utils.StringKey");var x$_=x$b.prototype;x$_.add=function(x$b){var x$_=this._strsToID[x$b];return null!=x$_?x$_:(this._idToStrs[this._length]=x$b,this._strsToID[x$b]=this._length++)},x$_.getID=function(x$b){var x$_=this._strsToID[x$b];return null==x$_?-1:x$_},x$_.getName=function(x$b){var x$_=this._idToStrs[x$b];return null==x$_?void 0:x$_}}(),function(){var x$L;function x$b(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}x$f(x$b,"laya.utils.Timer");var x$_=x$b.prototype;return x$_._init=function(){x$o.timer&&x$o.timer.frameLoop(1,this,this._update)},x$_._now=function(){return Date.now()},x$_._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var x$b=this.currFrame=this.currFrame+this.scale,x$_=this._now();this._delta=(x$_-this._lastTimer)*this.scale;var x$s=this.currTimer=this.currTimer+this._delta;x$o.isDebug&&6e4<Math.abs(x$_-this._lastTimer)&&console.error("系统时间错误！"+(x$_-this._lastTimer)),this._lastTimer=x$_;var x$h=this._handlers;for(x$E=this._count=0,x$C=x$h.length;x$E<x$C;x$E++)if(null!==(x$O=x$h[x$E]).method){var x$x=x$O.userFrame?x$b:x$s;if(x$x>=x$O.exeTime)if(x$O.repeat)if(x$O.jumpFrame)for(;x$x>=x$O.exeTime;)x$O.exeTime+=x$O.delay,x$O.run(!1);else x$O.exeTime+=x$O.delay,x$O.run(!1),x$x>x$O.exeTime&&(x$O.exeTime+=Math.ceil((x$x-x$O.exeTime)/x$O.delay)*x$O.delay);else x$O.run(!0)}else this._count++;(30<this._count||x$b%200==0)&&this._clearHandlers();for(var x$n=this._laters,x$E=0,x$C=x$n.length-1;x$E<=x$C;x$E++){var x$O=x$n[x$E];this._isIgnoreRecover(x$O)||(null!==x$O.method&&(delete this._map[x$O.key],x$O.run(!1)),this._recoverHandler(x$O)),x$E===x$C&&(x$C=x$n.length-1)}x$n.length=0}},x$_._clearHandlers=function(){for(var x$b=this._handlers,x$_=0,x$s=x$b.length;x$_<x$s;x$_++){var x$h=x$b[x$_];null!==x$h.method?this._temp.push(x$h):this._isIgnoreRecover(x$h)?this._temp.push(x$h):this._recoverHandler(x$h)}this._handlers=this._temp,this._temp=x$b,this._temp.length=0},x$_._recoverHandler=function(x$b){this._map[x$b.key]==x$b&&delete this._map[x$b.key],x$b.recover()},x$_._create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){if(!x$s)return x$x.apply(x$h,x$n),null;if(x$E){var x$O=this._getHandler(x$h,x$x);if(x$O)return x$O.repeat=x$_,x$O.userFrame=x$b,x$O.delay=x$s,x$O.ignoreRecover=x$C,x$O.caller=x$h,x$O.method=x$x,x$O.args=x$n,x$O.exeTime=x$s+(x$b?this.currFrame:this.currTimer+this._now()-this._lastTimer),x$O}return(x$O=x$L.create()).repeat=x$_,x$O.userFrame=x$b,x$O.delay=x$s,x$O.ignoreRecover=x$C,x$O.caller=x$h,x$O.method=x$x,x$O.args=x$n,x$O.exeTime=x$s+(x$b?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(x$O),this._handlers.push(x$O),x$O},x$_._indexHandler=function(x$b){var x$_=x$b.caller,x$s=x$b.method,x$h=x$_?x$_.$_GID||(x$_.$_GID=x$e.getGID()):0,x$x=x$s.$_TID||(x$s.$_TID=this._mid++);x$b.key=x$h+"_"+x$x,this._map[x$b.key]=x$b},x$_.once=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=!0),this._create(!1,!1,x$b,x$_,x$s,x$h,x$x,!1)},x$_.loop=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){void 0===x$x&&(x$x=!0),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!1);var x$C=this._create(!1,!0,x$b,x$_,x$s,x$h,x$x,x$E);x$C&&(x$C.jumpFrame=x$n)},x$_.frameOnce=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=!0),this._create(!0,!1,x$b,x$_,x$s,x$h,x$x,!1)},x$_.frameLoop=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$x&&(x$x=!0),void 0===x$n&&(x$n=!1),this._create(!0,!0,x$b,x$_,x$s,x$h,x$x,x$n)},x$_.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+x$L._freeCount},x$_.clear=function(x$b,x$_){var x$s=this._getHandler(x$b,x$_);return!(!x$s||this._isIgnoreRecover(x$s))&&(delete this._map[x$s.key],x$s.key=null,x$s.clear(),!0)},x$_.clearAll=function(x$b){if(x$b)for(var x$_=0,x$s=this._handlers.length;x$_<x$s;x$_++){var x$h=this._handlers[x$_];x$h.caller===x$b&&(this._isIgnoreRecover(x$h)||(delete this._map[x$h.key],x$h.key=null,x$h.clear()))}},x$_._getHandler=function(x$b,x$_){var x$s=x$b?x$b.$_GID||(x$b.$_GID=x$e.getGID()):0,x$h=x$_.$_TID||(x$_.$_TID=this._mid++);return this._map[x$s+"_"+x$h]},x$_._isIgnoreRecover=function(x$b){if(x$b.ignoreRecover||x$b.caller&&"IgnoreRecover"==x$b.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var x$_="";try{arguments.propertyIsEnumerable.caller}catch(x$b){x$_=x$b.stack}x$o.recordError("报错：核心定时器销毁忽略  "+x$_)}return!0}return!1},x$_.hasHandler=function(x$b,x$_){return this._map[x$b.$_GID+"_"+x$_.$_TID]},x$_.callLater=function(x$b,x$_,x$s){if(null==this._getHandler(x$b,x$_)){var x$h=x$L.create();x$h.caller=x$b,x$h.method=x$_,x$h.args=x$s,this._indexHandler(x$h),this._laters.push(x$h)}},x$_.runCallLater=function(x$b,x$_){var x$s=this._getHandler(x$b,x$_);x$s&&null!=x$s.method&&(this._isIgnoreRecover(x$s)||(delete this._map[x$s.key],x$s.run(!0)))},x$_.runTimer=function(x$b,x$_){this.runCallLater(x$b,x$_)},x$Q(0,x$_,"delta",function(){return this._delta}),x$b.__init$=function(){x$L=function(){function x$_(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}x$f(x$_,"");var x$b=x$_.prototype;return x$b.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},x$b.recover=function(){this.clear(),this.args=x$_._freeHandler,x$_._freeHandler=this,x$_._freeCount++},x$b.run=function(x$b){var x$_=this.caller;if(x$_&&x$_.destroyed)return this.clear();var x$s=this.method,x$h=this.args;x$b&&this.clear(),null!=x$s&&(x$h?x$s.apply(x$_,x$h):x$s.call(x$_))},x$_._freeHandler=null,x$_._freeCount=0,x$_.create=function(){var x$b=x$_._freeHandler;return x$b?(x$_._freeHandler=x$b.args,--x$_._freeCount,x$b.args=null,x$b):new x$_},x$_}()},x$b}()),x$m=function(){function x$p(){this.gid=0}x$f(x$p,"laya.utils.Tween");var x$b=x$p.prototype;return x$b.to=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){return void 0===x$n&&(x$n=0),void 0===x$E&&(x$E=!1),this._create(x$b,x$_,x$s,x$h,x$x,x$n,x$E,!0,!1,!0)},x$b.from=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){return void 0===x$n&&(x$n=0),void 0===x$E&&(x$E=!1),this._create(x$b,x$_,x$s,x$h,x$x,x$n,x$E,!1,!1,!0)},x$b._create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){if(!x$b)throw new Error("Tween:target is null");this._target=x$b,this._duration=x$s,this._ease=x$h||x$_.ease||x$p.easeNone,this._complete=x$x||x$_.complete,this._delay=x$n,this._props=[],this._usedTimer=0,this._startTimer=x$K.now(),this._usedPool=x$O,this._delayParam=null,this.update=x$_.update;var x$f=x$b.$_GID||(x$b.$_GID=x$e.getGID());return x$p.tweenMap[x$f]?(x$E&&x$p.clearTween(x$b),x$p.tweenMap[x$f].push(this)):x$p.tweenMap[x$f]=[this],x$L?x$n<=0?this.firstStart(x$b,x$_,x$C):(this._delayParam=[x$b,x$_,x$C],x$o.scaleTimer.once(x$n,this,this.firstStart,this._delayParam)):this._initProps(x$b,x$_,x$C),this},x$b.firstStart=function(x$b,x$_,x$s){this._delayParam=null,x$b.destroyed?this.clear():(this._initProps(x$b,x$_,x$s),this._beginLoop())},x$b._initProps=function(x$b,x$_,x$s){for(var x$h in x$_)if("number"==typeof x$b[x$h]){var x$x=x$s?x$b[x$h]:x$_[x$h],x$n=x$s?x$_[x$h]:x$b[x$h];this._props.push([x$h,x$x,x$n-x$x]),x$s||(x$b[x$h]=x$x)}},x$b._beginLoop=function(){x$o.scaleTimer.frameLoop(1,this,this._doEase)},x$b._doEase=function(){this._updateEase(x$K.now())},x$b._updateEase=function(x$b){var x$_=this._target;if(x$_){if(x$_.destroyed)return x$p.clearTween(x$_);var x$s=this._usedTimer=x$b-this._startTimer-this._delay;if(!(x$s<0)){if(x$s>=this._duration)return this.complete();for(var x$h=0<x$s?this._ease(x$s,0,1,this._duration):0,x$x=this._props,x$n=0,x$E=x$x.length;x$n<x$E;x$n++){var x$C=x$x[x$n];x$_[x$C[0]]=x$C[1]+x$h*x$C[2]}this.update&&this.update.run()}}},x$b.complete=function(){if(this._target){x$o.scaleTimer.runTimer(this,this.firstStart);for(var x$b=this._target,x$_=this._props,x$s=this._complete,x$h=0,x$x=x$_.length;x$h<x$x;x$h++){var x$n=x$_[x$h];x$b[x$n[0]]=x$n[1]+x$n[2]}this.update&&this.update.run(),this.clear(),x$s&&x$s.run()}},x$b.pause=function(){x$o.scaleTimer.clear(this,this._beginLoop),x$o.scaleTimer.clear(this,this._doEase),x$o.scaleTimer.clear(this,this.firstStart);var x$b;(x$b=x$K.now()-this._startTimer-this._delay)<0&&(this._usedTimer=x$b)},x$b.setStartTime=function(x$b){this._startTimer=x$b},x$b.clear=function(){this._target&&(this._remove(),this._clear())},x$b._clear=function(){this.pause(),x$o.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,x$N.recover("tween",this))},x$b.recover=function(){this._usedPool=!0,this._clear()},x$b._remove=function(){var x$b=x$p.tweenMap[this._target.$_GID];if(x$b)for(var x$_=0,x$s=x$b.length;x$_<x$s;x$_++)if(x$b[x$_]===this){x$b.splice(x$_,1);break}},x$b.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=x$K.now(),this._delayParam)x$o.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var x$b=this._props,x$_=0,x$s=x$b.length;x$_<x$s;x$_++){var x$h=x$b[x$_];this._target[x$h[0]]=x$h[1]}x$o.scaleTimer.once(this._delay,this,this._beginLoop)}},x$b.resume=function(){this._usedTimer>=this._duration||(this._startTimer=x$K.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?x$o.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},x$Q(0,x$b,"progress",null,function(x$b){var x$_=x$b*this._duration;this._startTimer=x$K.now()-this._delay-x$_}),x$p.to=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){return void 0===x$n&&(x$n=0),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=!0),x$N.getItemByClass("tween",x$p)._create(x$b,x$_,x$s,x$h,x$x,x$n,x$E,!0,x$C,!0)},x$p.from=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){return void 0===x$n&&(x$n=0),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=!0),x$N.getItemByClass("tween",x$p)._create(x$b,x$_,x$s,x$h,x$x,x$n,x$E,!1,x$C,!0)},x$p.clearAll=function(x$b){if(x$b&&x$b.$_GID){var x$_=x$p.tweenMap[x$b.$_GID];if(x$_){for(var x$s=0,x$h=x$_.length;x$s<x$h;x$s++)x$_[x$s]._clear();x$_.length=0}}},x$p.clear=function(x$b){x$b.clear()},x$p.clearTween=function(x$b){x$p.clearAll(x$b)},x$p.easeNone=function(x$b,x$_,x$s,x$h){return x$s*x$b/x$h+x$_},x$p.tweenMap={},x$p}(),x$e=function(){function x$C(){}return x$f(x$C,"laya.utils.Utils"),x$C.toRadian=function(x$b){return x$b*x$C._pi2},x$C.toAngle=function(x$b){return x$b*x$C._pi},x$C.toHexColor=function(x$b){if(x$b<0||isNaN(x$b))return null;for(var x$_=x$b.toString(16);x$_.length<6;)x$_="0"+x$_;return"#"+x$_},x$C.getGID=function(){return x$C._gid++},x$C.concatArray=function(x$b,x$_){if(!x$_)return x$b;if(!x$b)return x$_;var x$s=0,x$h=x$_.length;for(x$s=0;x$s<x$h;x$s++)x$b.push(x$_[x$s]);return x$b},x$C.clearArray=function(x$b){return x$b&&(x$b.length=0),x$b},x$C.copyArray=function(x$b,x$_){if(x$b||(x$b=[]),!x$_)return x$b;x$b.length=x$_.length;var x$s=0,x$h=x$_.length;for(x$s=0;x$s<x$h;x$s++)x$b[x$s]=x$_[x$s];return x$b},x$C.getGlobalRecByPoints=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E;return x$n=new x$M(x$_,x$s),x$n=x$b.localToGlobal(x$n),x$E=new x$M(x$h,x$x),x$E=x$b.localToGlobal(x$E),x$r._getWrapRec([x$n.x,x$n.y,x$E.x,x$E.y])},x$C.getGlobalPosAndScale=function(x$b){return x$C.getGlobalRecByPoints(x$b,0,0,1,1)},x$C.bind=function(x$b,x$_){return x$b.bind(x$_)},x$C.measureText=function(x$b,x$_){return x$Z.measureText(x$b,x$_)},x$C.updateOrder=function(x$b){if(!x$b||x$b.length<2)return!1;for(var x$_,x$s=1,x$h=0,x$x=x$b.length,x$n=NaN;x$s<x$x;){for(x$_=x$b[x$h=x$s],x$n=x$b[x$h]._zOrder;-1<--x$h&&x$b[x$h]._zOrder>x$n;)x$b[x$h+1]=x$b[x$h];x$b[x$h+1]=x$_,x$s++}var x$E=x$_.parent.conchModel;if(x$E)if(null!=x$E.updateZOrder)x$E.updateZOrder();else{for(x$s=0;x$s<x$x;x$s++)x$E.removeChild(x$b[x$s].conchModel);for(x$s=0;x$s<x$x;x$s++)x$E.addChildAt(x$b[x$s].conchModel,x$s)}return!0},x$C.transPointList=function(x$b,x$_,x$s){var x$h=0,x$x=x$b.length;for(x$h=0;x$h<x$x;x$h+=2)x$b[x$h]+=x$_,x$b[x$h+1]+=x$s},x$C.parseInt=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s=x$K.window.parseInt(x$b,x$_);return isNaN(x$s)?0:x$s},x$C.getFileExtension=function(x$b){x$C._extReg.lastIndex=x$b.lastIndexOf(".");var x$_=x$C._extReg.exec(x$b);return x$_&&1<x$_.length?x$_[1].toLowerCase():null},x$C.getTransformRelativeToWindow=function(x$b,x$_,x$s){var x$h=x$o.stage,x$x=laya.utils.Utils.getGlobalPosAndScale(x$b),x$n=x$h._canvasTransform.clone(),x$E=x$n.tx,x$C=x$n.ty;x$n.rotate(-Math.PI/180*x$o.stage.canvasDegree),x$n.scale(x$o.stage.clientScaleX,x$o.stage.clientScaleY);var x$O=x$o.stage.canvasDegree%180!=0,x$L=NaN,x$f=NaN;x$O?(x$L=x$s+x$x.y,x$f=x$_+x$x.x,x$L*=x$n.d,x$f*=x$n.a,90==x$o.stage.canvasDegree?(x$L=x$E-x$L,x$f+=x$C):(x$L+=x$E,x$f=x$C-x$f)):(x$L=x$_+x$x.x,x$f=x$s+x$x.y,x$L*=x$n.a,x$f*=x$n.d,x$L+=x$E,x$f+=x$C);var x$p=NaN,x$P=NaN;return x$P=x$O?(x$p=x$n.d*x$x.height,x$n.a*x$x.width):(x$p=x$n.a*x$x.width,x$n.d*x$x.height),{x:x$L,y:x$f,scaleX:x$p,scaleY:x$P}},x$C.fitDOMElementInArea=function(x$b,x$_,x$s,x$h,x$x,x$n){x$b._fitLayaAirInitialized||(x$b._fitLayaAirInitialized=!0,x$b.style.transformOrigin=x$b.style.webKittransformOrigin="left top",x$b.style.position="absolute");var x$E=x$C.getTransformRelativeToWindow(x$_,x$s,x$h);x$b.style.transform=x$b.style.webkitTransform="scale("+x$E.scaleX+","+x$E.scaleY+") rotate("+x$o.stage.canvasDegree+"deg)",x$b.style.width=x$x+"px",x$b.style.height=x$n+"px",x$b.style.left=x$E.x+"px",x$b.style.top=x$E.y+"px"},x$C.isOkTextureList=function(x$b){if(!x$b)return!1;var x$_,x$s=0,x$h=x$b.length;for(x$s=0;x$s<x$h;x$s++)if(!(x$_=x$b[x$s])||!x$_.source)return!1;return!0},x$C.isOKCmdList=function(x$b){if(!x$b)return!1;var x$_,x$s,x$h=0,x$x=x$b.length,x$n=x$q._context;for(x$h=0;x$h<x$x;x$h++)switch((x$_=x$b[x$h]).callee){case x$n._drawTexture:case x$n._fillTexture:case x$n._drawTextureWithTransform:if(!(x$s=x$_[0])||!x$s.source)return!1}return!0},x$C._gid=1,x$C._pi=180/Math.PI,x$C._pi2=Math.PI/180,x$C._extReg=/\.(\w+)\??/g,x$C.parseXMLFromString=function(x$b){var x$_;if(x$b=x$b.replace(/>\s+</g,"><"),-1<(x$_=(new DOMParser).parseFromString(x$b,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(x$_.firstChild.firstChild.textContent);return x$_},x$C}(),x$v=function(){function x$b(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],x$q.isWebGL&&x$I.regCacheByFunction(x$e.bind(this.startDispose,this),x$e.bind(this.getCacheList,this))}x$f(x$b,"laya.utils.VectorGraphManager");var x$_=x$b.prototype;return x$_.getId=function(){return this._id++},x$_.addShape=function(x$b,x$_){this.shapeDic[x$b]=x$_,this.useDic[x$b]||(this.useDic[x$b]=!0)},x$_.addLine=function(x$b,x$_){this.shapeLineDic[x$b]=x$_,this.shapeLineDic[x$b]||(this.shapeLineDic[x$b]=!0)},x$_.getShape=function(x$b){this._checkKey&&null!=this.useDic[x$b]&&(this.useDic[x$b]=!0)},x$_.deleteShape=function(x$b){this.shapeDic[x$b]&&(this.shapeDic[x$b]=null,delete this.shapeDic[x$b]),this.shapeLineDic[x$b]&&(this.shapeLineDic[x$b]=null,delete this.shapeLineDic[x$b]),null!=this.useDic[x$b]&&delete this.useDic[x$b]},x$_.getCacheList=function(){var x$b,x$_=[];for(x$b in this.shapeDic)x$_.push(this.shapeDic[x$b]);for(x$b in this.shapeLineDic)x$_.push(this.shapeLineDic[x$b]);return x$_},x$_.startDispose=function(x$b){var x$_;for(x$_ in this.useDic)this.useDic[x$_]=!1;this._checkKey=!0},x$_.endDispose=function(){if(this._checkKey){var x$b;for(x$b in this.useDic)this.useDic[x$b]||this.deleteShape(x$b);this._checkKey=!1}},x$b.getInstance=function(){return x$b.instance=x$b.instance||new x$b},x$b.instance=null,x$b}(),x$H=function(){function x$h(){this._obj=null,this._obj=x$h.supportWeakMap?new x$K.window.WeakMap:{},x$h.supportWeakMap||x$h._maps.push(this)}x$f(x$h,"laya.utils.WeakObject");var x$b=x$h.prototype;return x$b.set=function(x$b,x$_){if(null!=x$b)if(x$h.supportWeakMap){var x$s=x$b;"string"!=typeof x$b&&"number"!=typeof x$b||(x$s=x$h._keys[x$b])||(x$s=x$h._keys[x$b]={k:x$b}),this._obj.set(x$s,x$_)}else"string"==typeof x$b||"number"==typeof x$b?this._obj[x$b]=x$_:(x$b.$_GID||(x$b.$_GID=x$e.getGID()),this._obj[x$b.$_GID]=x$_)},x$b.get=function(x$b){if(null==x$b)return null;if(x$h.supportWeakMap){var x$_="string"==typeof x$b||"number"==typeof x$b?x$h._keys[x$b]:x$b;return x$_?this._obj.get(x$_):null}return"string"==typeof x$b||"number"==typeof x$b?this._obj[x$b]:this._obj[x$b.$_GID]},x$b.del=function(x$b){if(null!=x$b)if(x$h.supportWeakMap){var x$_="string"==typeof x$b||"number"==typeof x$b?x$h._keys[x$b]:x$b;if(!x$_)return;this._obj.delete(x$_)}else"string"==typeof x$b||"number"==typeof x$b?delete this._obj[x$b]:delete this._obj[this._obj.$_GID]},x$b.has=function(x$b){if(null==x$b)return!1;if(x$h.supportWeakMap){var x$_="string"==typeof x$b||"number"==typeof x$b?x$h._keys[x$b]:x$b;return this._obj.has(x$_)}return"string"==typeof x$b||"number"==typeof x$b?null!=this._obj[x$b]:null!=this._obj[this._obj.$_GID]},x$h.__init__=function(){(x$h.supportWeakMap=null!=x$K.window.WeakMap)||x$o.timer.loop(x$h.delInterval,null,x$h.clearCache)},x$h.clearCache=function(){for(var x$b=0,x$_=x$h._maps.length;x$b<x$_;x$b++){x$h._maps[x$b]._obj={}}},x$h.supportWeakMap=!1,x$h.delInterval=3e5,x$h._keys={},x$h._maps=[],x$O(x$h,["I",function(){return this.I=new x$h}]),x$h}(),x$j=function(){function x$b(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}x$f(x$b,"laya.utils.WordText");var x$_=x$b.prototype;return x$_.setText=function(x$b){this.changed=!0,this._text=x$b},x$_.toString=function(){return this._text},x$_.charCodeAt=function(x$b){return this._text?this._text.charCodeAt(x$b):NaN},x$_.charAt=function(x$b){return this._text?this._text.charAt(x$b):null},x$Q(0,x$_,"length",function(){return this._text?this._text.length:0}),x$b}(),x$bb=function(x$b){function x$E(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,x$E.__super.call(this),this._childs=x$E.ARRAY_EMPTY,this._$P=x$E.PROP_EMPTY,this.timer=x$o.scaleTimer,this.conchModel=x$q.isConchNode?this.createConchModel():null}x$f(x$E,"laya.display.Node",x$L);var x$_=x$E.prototype;return x$_._setBit=function(x$b,x$_){1==x$b&&(this._getBit(x$b)!=x$_&&this._updateDisplayedInstage());x$_?this._bits|=x$b:this._bits&=~x$b},x$_._getBit=function(x$b){return 0!=(this._bits&x$b)},x$_._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},x$_._setUpNoticeType=function(x$b){var x$_=this;for(x$_._setBit(x$b,!0),x$_=x$_.parent;x$_;){if(x$_._getBit(x$b))return;x$_._setBit(x$b,!0),x$_=x$_.parent}},x$_.on=function(x$b,x$_,x$s,x$h){return"display"!==x$b&&"undisplay"!==x$b||this._getBit(1)||this._setUpNoticeType(1),this._createListener(x$b,x$_,x$s,x$h,!1)},x$_.once=function(x$b,x$_,x$s,x$h){return"display"!==x$b&&"undisplay"!==x$b||this._getBit(1)||this._setUpNoticeType(1),this._createListener(x$b,x$_,x$s,x$h,!0)},x$_.createConchModel=function(){return null},x$_.destroy=function(x$b){void 0===x$b&&(x$b=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(x$b?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},x$_.destroyChildren=function(){if(this._childs)for(var x$b=this._childs.length-1;-1<x$b;x$b--)this._childs[x$b].destroy(!0)},x$_.addChild=function(x$b){if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),x$b._parent===this){var x$_=this.getChildIndex(x$b);x$_!==this._childs.length-1&&(this._childs.splice(x$_,1),this._childs.push(x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1)),this._childChanged())}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$E.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1),(x$b.parent=this)._childChanged();return x$b},x$_.addChildren=function(x$b){for(var x$_=arguments,x$s=0,x$h=x$_.length;x$s<x$h;)this.addChild(x$_[x$s++])},x$_.addChildAt=function(x$b,x$_){if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),0<=x$_&&x$_<=this._childs.length){if(x$b._parent===this){var x$s=this.getChildIndex(x$b);this._childs.splice(x$s,1),this._childs.splice(x$_,0,x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,x$_)),this._childChanged()}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$E.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(x$_,0,x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,x$_),x$b.parent=this;return x$b}throw new Error("appendChildAt:The index is out of bounds")},x$_.getChildIndex=function(x$b){return this._childs.indexOf(x$b)},x$_.getChildByName=function(x$b){var x$_=this._childs;if(x$_)for(var x$s=0,x$h=x$_.length;x$s<x$h;x$s++){var x$x=x$_[x$s];if(x$x.name===x$b)return x$x}return null},x$_._get$P=function(x$b){return this._$P[x$b]},x$_._set$P=function(x$b,x$_){return this.destroyed||(this._$P===x$E.PROP_EMPTY&&(this._$P={}),this._$P[x$b]=x$_),x$_},x$_.getChildAt=function(x$b){return this._childs[x$b]},x$_.setChildIndex=function(x$b,x$_){var x$s=this._childs;if(x$_<0||x$_>=x$s.length)throw new Error("setChildIndex:The index is out of bounds.");var x$h=this.getChildIndex(x$b);if(x$h<0)throw new Error("setChildIndex:node is must child of this object.");return x$s.splice(x$h,1),x$s.splice(x$_,0,x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,x$_)),this._childChanged(),x$b},x$_._childChanged=function(x$b){},x$_.removeChild=function(x$b){if(!this._childs)return x$b;var x$_=this._childs.indexOf(x$b);return this.removeChildAt(x$_)},x$_.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},x$_.removeChildByName=function(x$b){var x$_=this.getChildByName(x$b);return x$_&&this.removeChild(x$_),x$_},x$_.removeChildAt=function(x$b){var x$_=this.getChildAt(x$b);if(x$_){for(var x$s=this._childs.length-1,x$h=x$b;x$h<x$s;++x$h)this._childs[x$h]=this._childs[x$h+1];this._childs.length=x$s,this.conchModel&&this.conchModel.removeChild(x$_.conchModel),x$_.parent=null}return x$_},x$_.removeChildren=function(x$b,x$_){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=2147483647),this._childs&&0<this._childs.length){var x$s=this._childs;if(0===x$b&&x$n<=x$_){var x$h=x$s;this._childs=x$E.ARRAY_EMPTY}else x$h=x$s.splice(x$b,x$_-x$b);for(var x$x=0,x$n=x$h.length;x$x<x$n;x$x++)x$h[x$x].parent=null,this.conchModel&&this.conchModel.removeChild(x$h[x$x].conchModel)}return this},x$_.replaceChild=function(x$b,x$_){var x$s=this._childs.indexOf(x$_);return-1<x$s?(this._childs.splice(x$s,1,x$b),this.conchModel&&(this.conchModel.removeChild(x$_.conchModel),this.conchModel.addChildAt(x$b.conchModel,x$s)),x$_.parent=null,x$b.parent=this,x$b):null},x$_._updateDisplayedInstage=function(){var x$b;x$b=this;var x$_=x$o.stage;for(this._displayedInStage=!1;x$b;){if(x$b._getBit(1)){this._displayedInStage=x$b._displayedInStage;break}if(x$b==x$_||x$b._displayedInStage){this._displayedInStage=!0;break}x$b=x$b.parent}},x$_._setDisplay=function(x$b){this._displayedInStage!==x$b&&((this._displayedInStage=x$b)?this.event("display"):this.event("undisplay"))},x$_._displayChild=function(x$b,x$_){var x$s=x$b._childs;if(x$s)for(var x$h=0;x$h<x$s.length;x$h++){var x$x=x$s[x$h];x$x&&x$x._getBit(1)&&(0<x$x._childs.length?this._displayChild(x$x,x$_):x$x._setDisplay(x$_))}x$b._setDisplay(x$_)},x$_.contains=function(x$b){if(x$b===this)return!0;for(;x$b;){if(x$b.parent===this)return!0;x$b=x$b.parent}return!1},x$_.timerLoop=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$x&&(x$x=!0),void 0===x$n&&(x$n=!1),this.timer.loop(x$b,x$_,x$s,x$h,x$x,x$n)},x$_.timerOnce=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=!0),this.timer._create(!1,!1,x$b,x$_,x$s,x$h,x$x)},x$_.frameLoop=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=!0),this.timer._create(!0,!0,x$b,x$_,x$s,x$h,x$x)},x$_.frameOnce=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=!0),this.timer._create(!0,!1,x$b,x$_,x$s,x$h,x$x)},x$_.clearTimer=function(x$b,x$_){this.timer.clear(x$b,x$_)},x$Q(0,x$_,"numChildren",function(){return this._childs.length}),x$Q(0,x$_,"destroyed",function(){return this._destroyed}),x$Q(0,x$_,"parent",function(){return this._parent},function(x$b){this._parent!==x$b&&(x$b?(this._parent=x$b,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),x$b.displayedInStage&&this._displayChild(this,!0)),x$b._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=x$b))}),x$Q(0,x$_,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),x$E.ARRAY_EMPTY=[],x$E.PROP_EMPTY={},x$E.NOTICE_DISPLAY=1,x$E.MOUSEENABLE=2,x$E}(),x$_b=function(x$b){function x$P(x$b){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,x$P.__super.call(this),this._padding=x$P._PADDING,this._spacing=x$P._SPACING,this._aligns=x$P._ALIGNS,this._font=x$V.EMPTY,this._ower=x$b}x$f(x$P,"laya.display.css.CSSStyle",x$b);var x$_=x$P.prototype;return x$_.destroy=function(){this._ower=null,this._font=null,this._rect=null},x$_.inherit=function(x$b){this._font=x$b._font,this._spacing=x$b._spacing===x$P._SPACING?x$P._SPACING:x$b._spacing.slice(),this.lineHeight=x$b.lineHeight},x$_._widthAuto=function(){return 0!=(262144&this._type)},x$_.widthed=function(x$b){return 0!=(8&this._type)},x$_._calculation=function(x$b,x$_){if(x$_.indexOf("%")<0)return!1;var x$h=this._ower,x$x=x$h.parent,x$n=this._rect;function x$E(x$b,x$_,x$s){return x$b*x$s[0]+x$_*x$s[1]+x$s[2]}function x$s(x$b){var x$_=x$x.width,x$s=x$h.width;x$n.width&&(x$h.width=x$E(x$_,x$s,x$n.width)),x$n.height&&(x$h.height=x$E(x$_,x$s,x$n.height)),x$n.left&&(x$h.x=x$E(x$_,x$s,x$n.left)),x$n.top&&(x$h.y=x$E(x$_,x$s,x$n.top))}null===x$n&&(x$x._getCSSStyle()._type|=524288,x$x.on("resize",this,x$s),this._rect=x$n={input:{}});var x$C=x$_.split(" ");return x$C[0]=parseFloat(x$C[0])/100,1==x$C.length?x$C[1]=x$C[2]=0:(x$C[1]=parseFloat(x$C[1])/100,x$C[2]=parseFloat(x$C[2])),x$n[x$b]=x$C,x$n.input[x$b]=x$_,x$s(),!0},x$_.heighted=function(x$b){return 0!=(8192&this._type)},x$_.size=function(x$b,x$_){var x$s=this._ower,x$h=!1;-1!==x$b&&x$b!=this._ower.width&&(this._type|=8,this._ower.width=x$b,x$h=!0),-1!==x$_&&x$_!=this._ower.height&&(this._type|=8192,this._ower.height=x$_,x$h=!0),x$h&&(x$s._layoutLater(),524288&this._type&&x$s.event("resize",this))},x$_._getAlign=function(){return this._aligns[0]},x$_._getValign=function(){return this._aligns[1]},x$_._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},x$_._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new x$V(this._font))},x$_.render=function(x$b,x$_,x$s,x$h){var x$x=x$b.width,x$n=x$b.height;x$s-=x$b.pivotX,x$h-=x$b.pivotY,this._bgground&&null!=this._bgground.color&&x$_.ctx.fillRect(x$s,x$h,x$x,x$n,this._bgground.color),this._border&&this._border.color&&x$_.drawRect(x$s,x$h,x$x,x$n,this._border.color.strColor,this._border.size)},x$_.getCSSStyle=function(){return this},x$_.cssText=function(x$b){this.attrs(x$P.parseOneCSS(x$b,";"))},x$_.attrs=function(x$b){if(x$b)for(var x$_=0,x$s=x$b.length;x$_<x$s;x$_++){var x$h=x$b[x$_];this[x$h[0]]=x$h[1]}},x$_.setTransform=function(x$b){"none"===x$b?this._tf=x$C._TF_EMPTY:this.attrs(x$P.parseOneCSS(x$b,","))},x$_.translate=function(x$b,x$_){this._tf===x$C._TF_EMPTY&&(this._tf=new x$x),this._tf.translateX=x$b,this._tf.translateY=x$_},x$_.scale=function(x$b,x$_){this._tf===x$C._TF_EMPTY&&(this._tf=new x$x),this._tf.scaleX=x$b,this._tf.scaleY=x$_},x$_._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},x$Q(0,x$_,"block",x$b.prototype._$get_block,function(x$b){x$b?this._type|=1:this._type&=-2}),x$Q(0,x$_,"valign",function(){return x$P._valigndef[this._aligns[1]]},function(x$b){this._aligns===x$P._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=x$P._valigndef[x$b]}),x$Q(0,x$_,"height",null,function(x$b){if(this._type|=8192,"string"==typeof x$b){if(this._calculation("height",x$b))return;x$b=parseInt(x$b)}this.size(-1,x$b)}),x$Q(0,x$_,"width",null,function(x$b){if(this._type|=8,"string"==typeof x$b){var x$_=x$b.indexOf("auto");if(0<=x$_&&(this._type|=262144,x$b=x$b.substr(0,x$_)),this._calculation("width",x$b))return;x$b=parseInt(x$b)}this.size(x$b,-1)}),x$Q(0,x$_,"fontWeight",function(){return this._font.weight},function(x$b){this._createFont().weight=x$b}),x$Q(0,x$_,"left",null,function(x$b){var x$_=this._ower;if("string"==typeof x$b){if("center"===x$b?x$b="50% -50% 0":"right"===x$b&&(x$b="100% -100% 0"),this._calculation("left",x$b))return;x$b=parseInt(x$b)}x$_.x=x$b}),x$Q(0,x$_,"_translate",null,function(x$b){this.translate(x$b[0],x$b[1])}),x$Q(0,x$_,"absolute",function(){return 0!=(4&this._type)}),x$Q(0,x$_,"top",null,function(x$b){var x$_=this._ower;if("string"==typeof x$b){if("middle"===x$b?x$b="50% -50% 0":"bottom"===x$b&&(x$b="100% -100% 0"),this._calculation("top",x$b))return;x$b=parseInt(x$b)}x$_.y=x$b}),x$Q(0,x$_,"align",function(){return x$P._aligndef[this._aligns[0]]},function(x$b){this._aligns===x$P._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=x$P._aligndef[x$b]}),x$Q(0,x$_,"bold",function(){return this._font.bold},function(x$b){this._createFont().bold=x$b}),x$Q(0,x$_,"padding",function(){return this._padding},function(x$b){this._padding=x$b}),x$Q(0,x$_,"leading",function(){return this._spacing[1]},function(x$b){"string"==typeof x$b&&(x$b=parseInt(x$b+"")),this._spacing===x$P._SPACING&&(this._spacing=[0,0]),this._spacing[1]=x$b}),x$Q(0,x$_,"lineElement",function(){return 0!=(65536&this._type)},function(x$b){x$b?this._type|=65536:this._type&=-65537}),x$Q(0,x$_,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(x$b){this.lineElement=!1,"right"===x$b?this._type|=32768:this._type&=-32769}),x$Q(0,x$_,"textDecoration",function(){return this._font.decoration},function(x$b){this._createFont().decoration=x$b}),x$Q(0,x$_,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(x$b){"nowrap"===x$b&&(this._type|=131072),"none"===x$b&&(this._type&=-131073)}),x$Q(0,x$_,"background",null,function(x$b){x$b?(this._bgground||(this._bgground={}),this._bgground.color=x$b,this._ower.conchModel&&this._ower.conchModel.bgColor(x$b),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),x$Q(0,x$_,"wordWrap",function(){return 0==(131072&this._type)},function(x$b){x$b?this._type&=-131073:this._type|=131072}),x$Q(0,x$_,"color",function(){return this._font.color},function(x$b){this._createFont().color=x$b}),x$Q(0,x$_,"password",function(){return this._font.password},function(x$b){this._createFont().password=x$b}),x$Q(0,x$_,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(x$b){"none"===x$b?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=x$b),this._ower.conchModel&&this._ower.conchModel.bgColor(x$b),this._ower._renderType|=256}),x$Q(0,x$_,"font",function(){return this._font.toString()},function(x$b){this._createFont().set(x$b)}),x$Q(0,x$_,"weight",null,function(x$b){this._createFont().weight=x$b}),x$Q(0,x$_,"letterSpacing",function(){return this._spacing[0]},function(x$b){"string"==typeof x$b&&(x$b=parseInt(x$b+"")),this._spacing===x$P._SPACING&&(this._spacing=[0,0]),this._spacing[0]=x$b}),x$Q(0,x$_,"fontSize",function(){return this._font.size},function(x$b){this._createFont().size=x$b}),x$Q(0,x$_,"italic",function(){return this._font.italic},function(x$b){this._createFont().italic=x$b}),x$Q(0,x$_,"fontFamily",function(){return this._font.family},function(x$b){this._createFont().family=x$b}),x$Q(0,x$_,"stroke",function(){return this._font.stroke[0]},function(x$b){this._createFont().stroke===x$V._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=x$b}),x$Q(0,x$_,"strokeColor",function(){return this._font.stroke[1]},function(x$b){this._createFont().stroke===x$V._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=x$b}),x$Q(0,x$_,"border",function(){return this._border?this._border.value:""},function(x$b){if("none"!=x$b){this._border||(this._border={});var x$_=(this._border.value=x$b).split(" ");if(this._border.color=x$F.create(x$_[x$_.length-1]),1==x$_.length)return this._border.size=1,void(this._border.type="solid");var x$s=0;0<x$_[0].indexOf("px")?(this._border.size=parseInt(x$_[0]),x$s++):this._border.size=1,this._border.type=x$_[x$s],this._ower._renderType|=256}else this._border=null}),x$Q(0,x$_,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(x$b){x$b?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==x$b?null:x$F.create(x$b),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),x$Q(0,x$_,"position",function(){return 4&this._type?"absolute":""},function(x$b){"absolute"==x$b?this._type|=4:this._type&=-5}),x$Q(0,x$_,"display",null,function(x$b){switch(x$b){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),x$Q(0,x$_,"paddingLeft",function(){return this.padding[3]}),x$Q(0,x$_,"paddingTop",function(){return this.padding[0]}),x$Q(0,x$_,"_scale",null,function(x$b){this._ower.scale(x$b[0],x$b[1])}),x$Q(0,x$_,"_rotate",null,function(x$b){this._ower.rotation=x$b}),x$P.parseOneCSS=function(x$b,x$_){for(var x$s,x$h=[],x$x=x$b.split(x$_),x$n=0,x$E=x$x.length;x$n<x$E;x$n++){var x$C=x$x[x$n],x$O=x$C.indexOf(":"),x$L=x$C.substr(0,x$O).replace(/^\s+|\s+$/g,"");if(0!=x$L.length){var x$f=x$C.substr(x$O+1).replace(/^\s+|\s+$/g,""),x$p=[x$L,x$f];switch(x$L){case"italic":case"bold":x$p[1]="true"==x$f;break;case"line-height":x$p[0]="lineHeight",x$p[1]=parseInt(x$f);break;case"font-size":x$p[0]="fontSize",x$p[1]=parseInt(x$f);break;case"padding":1<(x$s=x$f.split(" ")).length||(x$s[1]=x$s[2]=x$s[3]=x$s[0]),x$p[1]=[parseInt(x$s[0]),parseInt(x$s[1]),parseInt(x$s[2]),parseInt(x$s[3])];break;case"rotate":x$p[0]="_rotate",x$p[1]=parseFloat(x$f);break;case"scale":x$s=x$f.split(" "),x$p[0]="_scale",x$p[1]=[parseFloat(x$s[0]),parseFloat(x$s[1])];break;case"translate":x$s=x$f.split(" "),x$p[0]="_translate",x$p[1]=[parseInt(x$s[0]),parseInt(x$s[1])];break;default:(x$p[0]=x$P._CSSTOVALUE[x$L])||(x$p[0]=x$L)}x$h.push(x$p)}}return x$h},x$P.parseCSS=function(x$b,x$_){for(var x$s;null!=(x$s=x$P._parseCSSRegExp.exec(x$b));)x$P.styleSheets[x$s[1]]=x$P.parseOneCSS(x$s[2],";")},x$P.EMPTY=new x$P(null),x$P._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},x$P._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),x$P._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},x$P._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},x$P.styleSheets={},x$P.ALIGN_CENTER=1,x$P.ALIGN_RIGHT=2,x$P.VALIGN_MIDDLE=1,x$P.VALIGN_BOTTOM=2,x$P._CSS_BLOCK=1,x$P._DISPLAY_NONE=2,x$P._ABSOLUTE=4,x$P._WIDTH_SET=8,x$P._PADDING=[0,0,0,0],x$P._RECT=[-1,-1,-1,-1],x$P._SPACING=[0,0],x$P._ALIGNS=[0,0,0],x$P.ADDLAYOUTED=512,x$P._NEWFONT=4096,x$P._HEIGHT_SET=8192,x$P._BACKGROUND_SET=16384,x$P._FLOAT_RIGHT=32768,x$P._LINE_ELEMENT=65536,x$P._NOWARP=131072,x$P._WIDTHAUTO=262144,x$P._LISTERRESZIE=524288,x$P}(x$C),x$sb=function(x$b){function x$E(){this.url=null,this.audio=null,this.loaded=!1,x$E.__super.call(this)}x$f(x$E,"laya.media.h5audio.AudioSound",x$L);var x$_=x$E.prototype;return x$_.dispose=function(){var x$b=x$E._audioCache[this.url];x$b&&(x$b.src="",delete x$E._audioCache[this.url])},x$_.load=function(x$b){var x$_;if(x$b=x$T.formatURL(x$b),(this.url=x$b)==x$S._tMusic?(x$E._initMusicAudio(),(x$_=x$E._musicAudio).src!=x$b&&(x$E._audioCache[x$_.src]=null,x$_=null)):x$_=x$E._audioCache[x$b],x$_&&2<=x$_.readyState)this.event("complete");else{x$_||(x$_=x$b==x$S._tMusic?(x$E._initMusicAudio(),x$E._musicAudio):x$K.createElement("audio"),(x$E._audioCache[x$b]=x$_).src=x$b),x$_.addEventListener("canplaythrough",x$h),x$_.addEventListener("error",x$x);var x$s=this;(this.audio=x$_).load?x$_.load():x$x()}function x$h(){x$n(),x$s.loaded=!0,x$s.event("complete")}function x$x(){x$_.load=null,x$n(),x$s.event("error")}function x$n(){x$_.removeEventListener("canplaythrough",x$h),x$_.removeEventListener("error",x$x)}},x$_.play=function(x$b,x$_,x$s){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),!this.url)return null;var x$h,x$x;if(!(x$h=this.url==x$S._tMusic?x$E._musicAudio:x$E._audioCache[this.url]))return null;x$x=x$N.getItem("audio:"+this.url),x$q.isConchApp?x$x||((x$x=x$K.createElement("audio")).src=this.url):this.url==x$S._tMusic?(x$E._initMusicAudio(),(x$x=x$E._musicAudio).src=this.url):x$x=x$x||x$h.cloneNode(!0);var x$n=new x$Pb(x$x);return x$n.url=this.url,x$n.loops=x$_,x$n.startTime=x$b,x$n.startHandler=x$s,x$n.play(!1),x$S.addChannel(x$n),x$n},x$Q(0,x$_,"duration",function(){var x$b;return(x$b=x$E._audioCache[this.url])?x$b.duration:0}),x$E._initMusicAudio=function(){x$E._musicAudio||(x$E._musicAudio||(x$E._musicAudio=x$K.createElement("audio")),x$q.isConchApp||x$K.document.addEventListener("mousedown",x$E._makeMusicOK))},x$E._makeMusicOK=function(){x$K.document.removeEventListener("mousedown",x$E._makeMusicOK),x$E._musicAudio.src?x$E._musicAudio.play():(x$E._musicAudio.src="",x$E._musicAudio.load())},x$E._audioCache={},x$E._musicAudio=null,x$E}(),x$hb=function(x$b){function x$_(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,x$_.__super.call(this)}x$f(x$_,"laya.media.SoundChannel",x$L);var x$s=x$_.prototype;return x$s.play=function(){},x$s.stop=function(){},x$s.pause=function(){},x$s.resume=function(){},x$s.__runComplete=function(x$b){x$b&&x$b.run()},x$Q(0,x$s,"volume",function(){return 1},function(x$b){}),x$Q(0,x$s,"position",function(){return 0}),x$Q(0,x$s,"duration",function(){return 0}),x$_}(),x$xb=function(x$b){function x$_(){x$_.__super.call(this)}x$f(x$_,"laya.media.Sound",x$L);var x$s=x$_.prototype;return x$s.load=function(x$b){},x$s.play=function(x$b,x$_,x$s){return void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),null},x$s.dispose=function(){},x$Q(0,x$s,"duration",function(){return 0}),x$_}(),x$nb=function(x$b){function x$x(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,x$x.__super.call(this)}x$f(x$x,"laya.media.webaudio.WebAudioSound",x$L);var x$_=x$x.prototype;return x$_.load=function(x$b){this.url=x$b,this.audioBuffer=x$x._dataCache[x$b],this.audioBuffer?this._loaded(this.audioBuffer):(x$x.e.on("loaded:"+x$b,this,this._loaded),x$x.e.on("err:"+x$b,this,this._err),x$x.__loadingSound[x$b]||(x$x.__loadingSound[x$b]=!0,x$o.loader.load(x$b,x$R.create(this,this.onloaded),null,x$Cb.BUFFER,4,!1,null,!0)))},x$_.onloaded=function(x$b){x$b||this._err(),this._disposed?this._removeLoadEvents():(this.data=x$b,x$x.buffs.push({buffer:this.data,url:this.url}),x$x.decode())},x$_._err=function(){if(this._removeLoadEvents(),x$x.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var x$b,x$_,x$s,x$h=0;for(x$b=(x$_=this.__toPlays).length,x$h=0;x$h<x$b;x$h++)(x$s=x$_[x$h])[3]&&!x$s[3].isStopped&&x$s[3].event("error");this.__toPlays.length=0}},x$_._loaded=function(x$b){this._removeLoadEvents(),this._disposed||(this.audioBuffer=x$b,this.loaded=!0,this.event("complete"))},x$_._removeLoadEvents=function(){x$x.e.off("loaded:"+this.url,this,this._loaded),x$x.e.off("err:"+this.url,this,this._err)},x$_.__playAfterLoaded=function(){if(this.__toPlays){var x$b,x$_,x$s,x$h=0;for(x$b=(x$_=this.__toPlays).length,x$h=0;x$h<x$b;x$h++)(x$s=x$_[x$h])[3]&&!x$s[3].isStopped&&this.play(x$s[0],x$s[1],x$s[2],x$s[3]);this.__toPlays.length=0}},x$_.play=function(x$b,x$_,x$s,x$h){return void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),x$h=x$h||new x$Vb,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([x$b,x$_,x$s,x$h]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),x$h.url=this.url,x$h.loops=x$_,x$h.audioBuffer=this.audioBuffer,x$h.startTime=x$b,x$h.startHandler=x$s,x$h.play(!1),x$S.addChannel(x$h),x$h},x$_.dispose=function(){this._disposed=!0,delete x$x._dataCache[this.url],delete x$x.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},x$Q(0,x$_,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),x$x.decode=function(){if(!(x$x.buffs.length<=0||x$x.isDecoding))if(x$x.isDecoding=!0,(x$x.tInfo=x$x.buffs.shift())&&x$x.tInfo.buffer&&x$x.tInfo.buffer.byteLength)try{x$x.ctx.decodeAudioData(x$x.tInfo.buffer,x$x._done,x$x._fail)}catch(x$b){console.error("decodeAudioData error  byteLength:"+x$x.tInfo.buffer.byteLength+"  url:"+x$x.tInfo.url)}else x$x._fail()},x$x._done=function(x$b){x$x.e.event("loaded:"+x$x.tInfo.url,x$b),x$x._dataCache[x$x.tInfo.url]=x$b,x$x.isDecoding=!1,x$x.decode()},x$x._fail=function(){x$x.e.event("err:"+x$x.tInfo.url,null),x$x.isDecoding=!1,x$x.decode()},x$x._playEmptySound=function(){if(null!=x$x.ctx){if(x$x._emptySource&&(x$x._emptySource.stop(),x$x._emptySource.disconnect(0),!x$Vb._tryCleanFailed))try{x$x._emptySource.buffer=null}catch(x$b){x$Vb._tryCleanFailed=!0}var x$b=x$x.ctx.createBufferSource();x$b.buffer=x$x._miniBuffer,x$b.connect(x$x.ctx.destination),x$b.start(0,0,0),x$x._emptySource=x$b}},x$x._unlock=function(){x$x._unlocked||(x$x._playEmptySound(),"running"==x$x.ctx.state?(x$K.document.removeEventListener("mousedown",x$x._unlock,!0),x$K.document.removeEventListener("touchend",x$x._unlock,!0),x$K.document.removeEventListener("touchstart",x$x._unlock,!0),x$x._unlocked=!0):"suspended"==x$x.ctx.state&&x$S._recoverWebAudio())},x$x.initWebAudio=function(){"running"!=x$x.ctx.state&&(x$x._unlock(),x$K.document.addEventListener("mousedown",x$x._unlock,!0),x$K.document.addEventListener("touchend",x$x._unlock,!0),x$K.document.addEventListener("touchstart",x$x._unlock,!0))},x$x._emptySource=null,x$x._dataCache={},x$x.buffs=[],x$x.isDecoding=!1,x$x._unlocked=!1,x$x.tInfo=null,x$x.__loadingSound={},x$O(x$x,["window",function(){return this.window=x$K.window},"webAudioEnabled",function(){return this.webAudioEnabled=x$x.window.AudioContext||x$x.window.webkitAudioContext||x$x.window.mozAudioContext},"ctx",function(){return this.ctx=x$x.webAudioEnabled?new(x$x.window.AudioContext||x$x.window.webkitAudioContext||x$x.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=x$x.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new x$L}]),x$x}(),x$Eb=function(x$b){function x$_(){this._responseType=null,this._data=null,x$_.__super.call(this),this._http=new x$K.window.XMLHttpRequest}x$f(x$_,"laya.net.HttpRequest",x$L);var x$s=x$_.prototype;return x$s.send=function(x$b,x$_,x$s,x$h,x$x){void 0===x$s&&(x$s="get"),void 0===x$h&&(x$h="text"),this._responseType=x$h,this._data=null;var x$n=this,x$E=this._http;if(x$E.open(x$s,x$b,!0),x$x)for(var x$C=0;x$C<x$x.length;x$C++)x$E.setRequestHeader(x$x[x$C++],x$x[x$C]);else x$q.isConchApp||(x$_&&"string"!=typeof x$_?x$E.setRequestHeader("Content-Type","application/json"):x$E.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));x$E.responseType="arraybuffer"!==x$h?"text":"arraybuffer",x$E.onerror=function(x$b){x$n._onError(x$b)},x$E.onabort=function(x$b){x$n._onAbort(x$b)},x$E.onprogress=function(x$b){x$n._onProgress(x$b)},x$E.onload=function(x$b){x$n._onLoad(x$b)},x$E.send(x$_)},x$s._onProgress=function(x$b){x$b&&x$b.lengthComputable&&this.event("progress",x$b.loaded/x$b.total)},x$s._onAbort=function(x$b){this.error("Request was aborted by user")},x$s._onError=function(x$b){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},x$s._onLoad=function(x$b){var x$_=this._http,x$s=void 0!==x$_.status?x$_.status:200;200===x$s||204===x$s||0===x$s?this.complete():this.error("["+x$_.status+"]"+x$_.statusText+":"+x$_.responseURL)},x$s.error=function(x$b){this.clear(),this.event("error",x$b)},x$s.complete=function(){this.clear();var x$_=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=x$e.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(x$b){x$_=!1,this.error(x$b.message)}x$_&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},x$s.clear=function(){var x$b=this._http;x$b.onerror=x$b.onabort=x$b.onprogress=x$b.onload=null},x$Q(0,x$s,"url",function(){return this._http.responseURL}),x$Q(0,x$s,"http",function(){return this._http}),x$Q(0,x$s,"data",function(){return this._data}),x$_}(),x$Cb=function(x$b){function x$k(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,x$k.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}x$f(x$k,"laya.net.Loader",x$L);var x$_=x$k.prototype;return x$_.load=function(x$b,x$_,x$s,x$h,x$x){if(x$b&&""!=x$b||console.error("Loader 加载的url不合法 "+x$b),void 0===x$s&&(x$s=!0),void 0===x$x&&(x$x=!1),0===(this._url=x$b).indexOf("data:image")?this._type=x$_="image":this._type=x$_||(x$_=this.getTypeFromUrl(x$b)),this._cache=x$s,this._data=null,!x$x&&x$k.loadedMap[x$b])return this._data=x$k.loadedMap[x$b],this.event("progress",1),void this.event("complete",this._data);if(x$h&&x$k.setGroup(x$b,x$h),null!=x$k.parserMap[x$_])return this._customParse=!0,void(x$k.parserMap[x$_]instanceof laya.utils.Handler?x$k.parserMap[x$_].runWith(this):x$k.parserMap[x$_].call(null,this));if("image"===x$_||"htmlimage"===x$_||"nativeimage"===x$_)return this._loadImage(x$b);if("ttf"===x$_)return this._loadTTF(x$b);switch(x$_){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:x$_}x$k.preLoadedMap[x$b]?this.onLoaded(x$k.preLoadedMap[x$b]):x$E.resMgrLoad(x$b,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},x$_.getTypeFromUrl=function(x$b){var x$_=x$e.getFileExtension(x$b);return x$_?x$k.typeMap[x$_]:(console.warn("Not recognize the resources suffix",x$b),"text")},x$_._loadTTF=function(x$b){x$b=x$T.formatURL(x$b);var x$_=new x$W;x$_.complete=x$R.create(this,this.onLoaded),x$_.load(x$b)},x$_._loadImage=function(x$b){x$E.imgMgrLoad(x$b,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},x$_._loadImageComplete=function(x$b,x$_,x$s){if(null!=x$s)if(x$s instanceof ArrayBuffer){var x$h=new DataView(x$s),x$x=new laya.webgl.resource.WebGLImage(new Uint8Array(x$s,8),x$b,0,!1,x$h.getUint32(0),x$h.getUint32(4));this.onLoaded(x$x)}else if(x$s instanceof x$fb)x$k.imgMgrSet[x$b]=x$_,x$E.imgMgrLock(x$b,x$k.imgMgrSet[x$b]),this._url=x$b,this.complete(x$s);else{var x$n=-1!=x$b.indexOf(".png",x$b.length-4)?6408:6407;x$x=new laya.webgl.resource.WebGLImage(x$s,x$b,x$n,!1,x$s.width,x$s.height);this.onLoaded(x$x)}else this.event("error","Load image failed")},x$_._loadSound=function(x$b){var x$_=new x$S._soundClass,x$s=this;function x$h(){x$_.offAll()}x$_.on("complete",this,function(){x$h(),x$s.onLoaded(x$_)}),x$_.on("error",this,function(){x$h(),x$_.dispose(),x$s.event("error","Load sound failed")}),x$_.load(x$b)},x$_.onProgress=function(x$b){"atlas"===this._type?this.event("progress",.3*x$b):this.event("progress",x$b)},x$_.onError=function(x$b){this.event("error",x$b)},x$_._loadedComplete=function(x$b,x$_,x$s){if(null!=x$s)switch(this._type){case"atlas":case"plf":case"json":var x$h=new x$d(x$s);this.onLoaded(JSON.parse(x$h.readUTFBytes()));break;case"font":x$h=new x$d(x$s);this.onLoaded(x$e.parseXMLFromString(x$h.readUTFBytes()));break;default:this.onLoaded(x$s)}else this.event("error",x$b)},x$_.onLoaded=function(x$b){var x$_=this._type;if("plf"==x$_)this.parsePLFData(x$b),this.complete(x$b);else if("image"===x$_){var x$s=new x$fb(x$b);x$s.url=this._url,this.complete(x$s)}else if("sound"===x$_||"htmlimage"===x$_||"nativeimage"===x$_)this.complete(x$b);else if("atlas"===x$_){if(!x$b.src&&!x$b._setContext){if(!this._data){if((this._data=x$b).meta&&x$b.meta.image)for(var x$h=x$b.meta.image.split(","),x$x=0<=this._url.indexOf("/")?"/":"\\",x$n=this._url.lastIndexOf(x$x),x$E=0<=x$n?this._url.substr(0,x$n+1):"",x$C=0,x$O=x$h.length;x$C<x$O;x$C++)x$h[x$C]=x$E+x$h[x$C];else x$h=[this._url.replace(".json",".png")];x$h.reverse(),x$b.toLoads=x$h,x$b.pics=[]}return this.event("progress",.3+1/x$h.length*.6),this._loadImage(x$h.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(x$b),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var x$L=this._data.frames,x$f=this._url.split("?")[0],x$p=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:x$f.substring(0,x$f.lastIndexOf("."))+"/",x$P=this._data.pics,x$V=x$T.formatURL(this._url),x$Q=x$k.atlasMap[x$V]||(x$k.atlasMap[x$V]=[]);x$Q.dir=x$p;var x$y=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var x$w in x$y=parseFloat(this._data.meta.scale),x$L){var x$i,x$R=x$L[x$w],x$t=x$P[x$R.frame.idx?x$R.frame.idx:0],x$c=x$T.formatURL(x$p+x$w);x$t.scaleRate=x$y,x$i=x$fb.create(x$t,x$R.frame.x,x$R.frame.y,x$R.frame.w,x$R.frame.h,x$R.spriteSourceSize.x,x$R.spriteSourceSize.y,x$R.sourceSize.w,x$R.sourceSize.h),x$k.cacheRes(x$c,x$i),x$k.keepCache(this._url,x$p+x$w),x$i.url=x$c,x$Q.push(x$c)}else for(x$w in x$L)x$t=x$P[(x$R=x$L[x$w]).frame.idx?x$R.frame.idx:0],x$c=x$T.formatURL(x$p+x$w),x$k.cacheRes(x$c,x$fb.create(x$t,x$R.frame.x,x$R.frame.y,x$R.frame.w,x$R.frame.h,x$R.spriteSourceSize.x,x$R.spriteSourceSize.y,x$R.sourceSize.w,x$R.sourceSize.h)),x$k.loadedMap[x$c].url=x$c,x$k.keepCache(this._url,x$p+x$w),x$Q.push(x$c);delete this._data.pics,this.complete(this._data)}else if("font"==x$_){if(!x$b.src)return this._data=x$b,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var x$$=new x$B;x$$.parseFont(this._data,x$b);var x$D=this._url.split(".fnt")[0].split("/"),x$o=x$D[x$D.length-1];x$wb.registerBitmapFont(x$o,x$$),this._data=x$$,this.complete(this._data)}else if("pkm"==x$_){var x$M=x$Db.create(x$b,this._url),x$r=new x$fb(x$M);x$r.url=this._url,this.complete(x$r)}else this.complete(x$b)},x$_.parsePLFData=function(x$b){var x$_,x$s,x$h;for(x$_ in x$b)switch(x$h=x$b[x$_],x$_){case"json":case"text":for(x$s in x$h)x$k.preLoadedMap[x$T.formatURL(x$s)]=x$h[x$s];break;default:for(x$s in x$h)x$k.preLoadedMap[x$T.formatURL(x$s)]=x$h[x$s]}},x$_.complete=function(x$b){this._data=x$b,this._customParse?this.event("loaded",x$b instanceof Array?[x$b]:x$b):(x$k._loaders.push(this),x$k._isWorking||x$k.checkNext())},x$_.endLoad=function(x$b){x$b&&(this._data=x$b),this._cache&&x$k.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},x$Q(0,x$_,"url",function(){return this._url}),x$Q(0,x$_,"data",function(){return this._data}),x$Q(0,x$_,"cache",function(){return this._cache}),x$Q(0,x$_,"type",function(){return this._type}),x$k.checkNext=function(){x$k._isWorking=!0;for(var x$b=x$K.now();x$k._startIndex<x$k._loaders.length;)if(x$K.now(),x$k._loaders[x$k._startIndex].endLoad(),x$k._startIndex++,x$K.now()-x$b>x$k.maxTimeOut)return console.warn("loader callback cost a long time:"+(x$K.now()-x$b)+" url="+x$k._loaders[x$k._startIndex-1].url),void x$o.timer.frameOnce(1,null,x$k.checkNext);x$k._loaders.length=0,x$k._startIndex=0,x$k._isWorking=!1},x$k.clearRes=function(x$b,x$_){if(null!=x$b){void 0===x$_&&(x$_=!1),x$b=x$T.formatURL(x$b);var x$s=x$k.getAtlas(x$b);if(x$s){for(var x$h=0,x$x=x$s.length;x$h<x$x;x$h++){var x$n=x$s[x$h],x$E=x$k.getRes(x$n);delete x$k.loadedMap[x$n],x$k.clearCache(x$b.substring(x$T.basePath.length),x$n.substring(x$T.basePath.length)),x$E&&x$E.destroy(x$_)}x$s.length=0,delete x$k.atlasMap[x$b],delete x$k.loadedMap[x$b]}else{var x$C=x$k.loadedMap[x$b];x$C&&(delete x$k.loadedMap[x$b],x$C instanceof laya.resource.Texture&&x$C.bitmap&&x$C.destroy(x$_))}}},x$k.clearTextureRes=function(x$b){x$b=x$T.formatURL(x$b);var x$_=laya.net.Loader.getAtlas(x$b),x$s=x$_&&0<x$_.length?laya.net.Loader.getRes(x$_[0]):laya.net.Loader.getRes(x$b);x$s&&x$s.bitmap&&(x$q.isConchApp&&!x$q.isConchWebGL?x$s.bitmap.source.releaseTexture&&x$s.bitmap.source.releaseTexture():null==x$s.bitmap._atlaser&&x$s.bitmap.releaseResource(!0))},x$k.getRes=function(x$b){return x$k.loadedMap[x$T.formatURL(x$b)]},x$k.getAtlas=function(x$b){return x$k.atlasMap[x$T.formatURL(x$b)]},x$k.cacheRes=function(x$b,x$_){x$b=x$T.formatURL(x$b),null!=x$k.loadedMap[x$b]?console.warn("Resources already exist,is repeated loading:",x$b):x$k.loadedMap[x$b]=x$_},x$k.setGroup=function(x$b,x$_){x$k.groupMap[x$_]||(x$k.groupMap[x$_]=[]),x$k.groupMap[x$_].push(x$b)},x$k.clearResByGroup=function(x$b){if(x$k.groupMap[x$b]){var x$_=x$k.groupMap[x$b],x$s=0,x$h=x$_.length;for(x$s=0;x$s<x$h;x$s++)x$k.clearRes(x$_[x$s]);x$_.length=0}},x$k.keepCache=function(x$b,x$_){if(x$b&&x$_){var x$s=x$k.cacheSet[x$_];x$s?-1==x$s.indexOf(x$b)&&x$s.push(x$b):x$k.cacheSet[x$_]=[x$b]}},x$k.clearCache=function(x$b,x$_){if(x$b&&x$_){var x$s=x$k.cacheSet[x$_];if(x$s){var x$h=x$s.indexOf(x$b);if(-1!==x$h){var x$x=x$s.length-1;0==x$x?(delete x$k.cacheSet[x$_],0<x$k.imgMgrSet[x$_]?x$E.imgMgrFree(x$_,x$k.imgMgrSet[x$_]):x$k.clearRes(x$_,!0)):(x$s[x$h]=x$s[x$x],x$s.length=x$x)}}}},x$k.saveObject=function(x$b,x$_,x$s){if(x$_&&x$b){var x$h=x$k.objectSet[x$b];x$h?(console.warn("Loader.saveObject: "+x$b),x$h[0]=x$_,x$h[1]=x$s):x$k.objectSet[x$b]=[x$_,x$s,[]]}},x$k.findObject=function(x$b){if(x$b){var x$_=x$k.objectSet[x$b];if(x$_)return x$_[0]}return null},x$k.keepObject=function(x$b,x$_){if(x$b&&x$_){var x$s=x$k.objectSet[x$_];x$s&&-1===x$s[2].indexOf(x$b)&&x$s[2].push(x$b)}},x$k.clearObject=function(x$b,x$_){if(x$b&&x$_){var x$s=x$k.objectSet[x$_];if(x$s){var x$h=x$s[2],x$x=x$h.indexOf(x$b);if(-1!==x$x){var x$n=x$h.length-1;0==x$n?(delete x$k.objectSet[x$_],x$s[1]&&x$s[1].call(null,x$s[0])):(x$h[x$x]=x$h[x$n],x$h.length=x$n)}}}},x$k.TEXT="text",x$k.JSON="json",x$k.XML="xml",x$k.BUFFER="arraybuffer",x$k.IMAGE="image",x$k.SOUND="sound",x$k.ATLAS="atlas",x$k.FONT="font",x$k.TTF="ttf",x$k.PLF="plf",x$k.PKM="pkm",x$k.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},x$k.parserMap={},x$k.groupMap={},x$k.maxTimeOut=100,x$k.loadedMap={},x$k.preLoadedMap={},x$k.atlasMap={},x$k._loaders=[],x$k._isWorking=!1,x$k._startIndex=0,x$k.imgCache={},x$k.cacheSet={},x$k.objectSet={},x$k.imgMgrSet={},x$k}(),x$Ob=function(x$b){var x$P;function x$V(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},x$V.__super.call(this);for(var x$b=0;x$b<this._maxPriority;x$b++)this._resInfos[x$b]=[]}x$f(x$V,"laya.net.LoaderManager",x$L);var x$_=x$V.prototype;return x$_.create=function(x$b,x$s,x$_,x$h,x$x,x$n,x$E,x$C){if(null==x$n&&(x$n=2),null==x$E&&(x$E=!0),x$b instanceof Array){var x$O=x$b,x$L=x$O.length,x$f=0;if(x$_)var x$p=x$R.create(x$_.caller,x$_.method,x$_.args,!1);for(var x$P=0;x$P<x$L;x$P++){var x$V=x$O[x$P];"string"==typeof x$V&&(x$V=x$O[x$P]={url:x$V}),x$V.progress=0}for(x$P=0;x$P<x$L;x$P++){x$V=x$O[x$P];var x$Q=x$_?x$R.create(null,x$i,[x$V],!1):null,x$y=x$_||x$s?x$R.create(null,x$w,[x$V]):null;this._create(x$V.url,x$y,x$Q,x$V.clas||x$h,x$V.params||x$x,null!=x$V.priority&&0<=x$V.priority?x$V.priority:x$n,x$E,x$V.group||x$C)}function x$w(x$b,x$_){x$f++,x$b.progress=1,x$f===x$L&&x$s&&x$s.run()}function x$i(x$b,x$_){x$b.progress=x$_;for(var x$s=0,x$h=0;x$h<x$L;x$h++){x$s+=x$O[x$h].progress}var x$x=x$s/x$L;x$p.runWith(x$x)}return!0}return this._create(x$b,x$s,x$_,x$h,x$x,x$n,x$E,x$C)},x$_._create=function(x$_,x$s,x$b,x$h,x$x,x$n,x$E,x$C){x$_&&""!=x$_||console.error("加载的url不合法 "+x$_),null==x$n&&(x$n=2),null==x$E&&(x$E=!0);var x$O=x$T.formatURL(x$_),x$L=this.getRes(x$O);if(x$L)!x$L.hasOwnProperty("loaded")||x$L.loaded?(x$b&&x$b.runWith(1),x$s&&x$s.run()):x$s&&x$o.loader._createListener(x$_,x$s.caller,x$s.method,x$s.args,!0,!1);else{var x$f=x$e.getFileExtension(x$_),x$p=x$V.createMap[x$f];if(!x$p)throw new Error("LoaderManager:unknown file("+x$_+") extension with: "+x$f+".");x$h||(x$h=x$p[0]);var x$P=x$p[1];if("atlas"==x$f)this.load(x$_,x$s,x$b,x$P,x$n,x$E);else{x$h===x$fb&&(x$P="htmlimage"),(x$L=x$h?new x$h:null).hasOwnProperty("_loaded")&&(x$L._loaded=!1),x$L._setUrl(x$_),x$C&&x$L._setGroup(x$C),this._createLoad(x$L,x$_,x$R.create(null,function(x$b){x$L&&!x$L.destroyed&&x$b&&x$L.onAsynLoaded.call(x$L,x$_,x$b,x$x),x$s&&x$s.run();x$o.loader.event(x$_)}),x$b,x$P,x$n,!1,x$C,!0),x$E&&this.cacheRes(x$O,x$L)}}return x$L},x$_.load=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){x$b&&""!=x$b||console.error("加载的url不合法 "+x$b);var x$O=this;if(null==x$x&&(x$x=2),null==x$n&&(x$n=!0),void 0===x$C&&(x$C=!1),x$b instanceof Array)return this._loadAssets(x$b,x$_,x$s,x$h,x$x,x$n,x$E);var x$L=x$Cb.getRes(x$b);if(null!=x$L)x$o.timer.frameOnce(1,null,function(){x$s&&x$s.runWith(1),x$_&&x$_.runWith(x$L),x$O._loaderCount||x$O.event("complete")});else{var x$f=x$V._resMap[x$b];x$f?(x$_&&x$f._createListener("complete",x$_.caller,x$_.method,x$_.args,!1,!1),x$s&&x$f._createListener("progress",x$s.caller,x$s.method,x$s.args,!1,!1)):((x$f=this._infoPool.length?this._infoPool.pop():new x$P).url=x$b,x$f.type=x$h,x$f.cache=x$n,x$f.group=x$E,x$f.ignoreCache=x$C,x$f.priority=x$x,x$_&&x$f.on("complete",x$_.caller,x$_.method,x$_.args),x$s&&x$f.on("progress",x$s.caller,x$s.method,x$s.args),x$V._resMap[x$b]=x$f,x$x=x$x<this._maxPriority?0<=x$x?x$x:0:this._maxPriority-1,this._resInfos[x$x].push(x$f),this._next())}return this},x$_._createLoad=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){var x$L=this;if(null==x$n&&(x$n=2),null==x$E&&(x$E=!0),void 0===x$O&&(x$O=!1),x$_ instanceof Array)return this._loadAssets(x$_,x$s,x$h,x$x,x$n,x$E,x$C);var x$f=x$Cb.getRes(x$_);if(null!=x$f)x$o.timer.frameOnce(1,null,function(){x$h&&x$h.runWith(1),x$s&&x$s.runWith(x$f),x$L._loaderCount||x$L.event("complete")});else{var x$p=x$V._resMap[x$_];x$p?(x$s&&x$p._createListener("complete",x$s.caller,x$s.method,x$s.args,!1,!1),x$h&&x$p._createListener("progress",x$h.caller,x$h.method,x$h.args,!1,!1)):((x$p=this._infoPool.length?this._infoPool.pop():new x$P).url=x$_,x$p.clas=x$b,x$p.type=x$x,x$p.cache=x$E,x$p.group=x$C,x$p.ignoreCache=x$O,x$p.priority=x$n,x$s&&x$p.on("complete",x$s.caller,x$s.method,x$s.args),x$h&&x$p.on("progress",x$h.caller,x$h.method,x$h.args),x$V._resMap[x$_]=x$p,x$n=x$n<this._maxPriority?0<=x$n?x$n:0:this._maxPriority-1,this._resInfos[x$n].push(x$p),this._next())}return this},x$_._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var x$b=0;x$b<this._maxPriority;x$b++)for(var x$_=this._resInfos[x$b];0<x$_.length;){var x$s=x$_.shift();if(x$s)return this._doLoad(x$s)}this._loaderCount||this.event("complete")}},x$_._doLoad=function(x$_){this._loaderCount++;var x$s=this._loaders.length?this._loaders.pop():new x$Cb;x$s.on("complete",null,x$x),x$s.on("progress",null,function(x$b){x$_.event("progress",x$b)}),x$s.on("error",null,function(x$b){x$x(null)});var x$h=this;function x$x(x$b){x$s.offAll(),x$s._data=null,x$s._customParse=!1,x$h._loaders.push(x$s),x$h._endLoad(x$_,x$b instanceof Array?[x$b]:x$b),x$h._loaderCount--,x$h._next()}x$s._class=x$_.clas,1<=x$_.priority?(x$s.priority=x$_.priority,x$s.realTime=!1):(x$s.priority=0,x$s.realTime=!0),x$s.load(x$_.url,x$_.type,x$_.cache,x$_.group,x$_.ignoreCache)},x$_._endLoad=function(x$b,x$_){var x$s=x$b.url;if(null==x$_){var x$h=this._failRes[x$s]||0;if(x$h<this.retryNum)return console.warn("[warn]Retry to load:",x$s),this._failRes[x$s]=x$h+1,void x$o.timer.once(this.retryDelay,this,this._addReTry,[x$b],!1);console.warn("[error]Failed to load:",x$s),this.event("error",x$s)}this._failRes[x$s]&&(this._failRes[x$s]=0),delete x$V._resMap[x$s],x$b.event("complete",x$_),x$b.offAll(),this._infoPool.push(x$b)},x$_._addReTry=function(x$b){this._resInfos[this._maxPriority-1].push(x$b),this._next()},x$_.clearRes=function(x$b,x$_){void 0===x$_&&(x$_=!1),x$Cb.clearRes(x$b,x$_)},x$_.getRes=function(x$b){return x$Cb.getRes(x$b)},x$_.cacheRes=function(x$b,x$_){x$Cb.cacheRes(x$b,x$_)},x$_.clearTextureRes=function(x$b){x$Cb.clearTextureRes(x$b)},x$_.setGroup=function(x$b,x$_){x$Cb.setGroup(x$b,x$_)},x$_.clearResByGroup=function(x$b){x$Cb.clearResByGroup(x$b)},x$_.clearUnLoaded=function(){for(var x$b=0;x$b<this._maxPriority;x$b++){for(var x$_=this._resInfos[x$b],x$s=x$_.length-1;-1<x$s;x$s--){var x$h=x$_[x$s];x$h&&(x$h.offAll(),this._infoPool.push(x$h))}x$_.length=0}this._loaderCount=0,x$V._resMap={}},x$_.cancelLoadByUrls=function(x$b){if(x$b)for(var x$_=0,x$s=x$b.length;x$_<x$s;x$_++)this.cancelLoadByUrl(x$b[x$_])},x$_.cancelLoadByUrl=function(x$b){for(var x$_=0;x$_<this._maxPriority;x$_++)for(var x$s=this._resInfos[x$_],x$h=x$s.length-1;-1<x$h;x$h--){var x$x=x$s[x$h];x$x&&x$x.url===x$b&&(x$s[x$h]=null,x$x.offAll(),this._infoPool.push(x$x))}x$V._resMap[x$b]&&delete x$V._resMap[x$b]},x$_._loadAssets=function(x$b,x$s,x$E,x$_,x$h,x$x,x$n){null==x$h&&(x$h=2),null==x$x&&(x$x=!0);for(var x$C=x$b.length,x$O=0,x$L=0,x$f=[],x$p=!0,x$P=0;x$P<x$C;x$P++){var x$V=x$b[x$P];if(!x$V)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+x$b);"string"==typeof x$V&&(x$V={url:x$V,type:x$_,size:1,priority:x$h}),x$V.size||(x$V.size=1),x$V.progress=0,x$L+=x$V.size,x$f.push(x$V);var x$Q=x$E?x$R.create(null,x$i,[x$V],!1):null,x$y=x$s||x$E?x$R.create(null,x$w,[x$V]):null;this.load(x$V.url,x$y,x$Q,x$V.type,null!=x$V.priority&&0<=x$V.priority?x$V.priority:2,x$x,x$V.group||x$n)}function x$w(x$b,x$_){x$O++,x$b.progress=1,x$_||(x$p=!1),x$O===x$C&&x$s&&x$s.runWith(x$p)}function x$i(x$b,x$_){if(null!=x$E){x$b.progress=x$_;for(var x$s=0,x$h=0;x$h<x$f.length;x$h++){var x$x=x$f[x$h];x$s+=x$x.size*x$x.progress}var x$n=x$s/x$L;x$E.runWith(x$n)}}return this},x$V.cacheRes=function(x$b,x$_){x$Cb.cacheRes(x$b,x$_)},x$V._resMap={},x$O(x$V,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),x$V.__init$=function(){x$P=function(x$b){function x$_(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,x$_.__super.call(this)}return x$f(x$_,"",x$L),x$_}()},x$V}(),x$Lb=(function(x$b){function x$x(x$b){x$x.__super.call(this),x$b||(x$b=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var x$_=0,x$s=0,x$h=0;x$h<20;x$h++)x$h%5!=4?this._mat[x$_++]=x$b[x$h]:this._alpha[x$s++]=x$b[x$h];this._action=x$Z.createFilterAction(32),this._action.data=this}x$f(x$x,"laya.filters.ColorFilter",x$i);var x$_=x$x.prototype;x$o.imps(x$_,{"laya.filters.IFilter":!0}),x$_.callNative=function(x$b){x$b._$P.cf=this;x$b.conchModel&&x$b.conchModel.setFilterMatrix&&x$b.conchModel.setFilterMatrix(this._mat,this._alpha)},x$Q(0,x$_,"type",function(){return 32}),x$Q(0,x$_,"action",function(){return this._action})}(),function(x$b){function x$h(x$b,x$_,x$s){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===x$_&&(x$_=0),x$h.__super.call(this),this._byteClass=x$s||x$d,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,x$b&&0<x$_&&x$_<65535&&this.connect(x$b,x$_)}x$f(x$h,"laya.net.Socket",x$L);var x$_=x$h.prototype;x$_.connect=function(x$b,x$_){var x$s="ws://"+x$b+":"+x$_;x$s="https:"==x$K.window.location.protocol?"wss://"+x$b+":"+x$_:"ws://"+x$b+":"+x$_,this.connectByUrl(x$s)},x$_.connectByUrl=function(x$b){var x$_=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new x$K.window.WebSocket(x$b,this.protocols):this._socket=new x$K.window.WebSocket(x$b),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(x$b){x$_._onOpen(x$b)},this._socket.onmessage=function(x$b){x$_._onMessage(x$b)},this._socket.onclose=function(x$b){x$_._onClose(x$b)},this._socket.onerror=function(x$b){x$_._onError(x$b)}},x$_.cleanSocket=function(){try{this._socket.close()}catch(x$b){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},x$_.close=function(){if(null!=this._socket)try{this._socket.close()}catch(x$b){}},x$_._onOpen=function(x$b){this._connected=!0,this.event("open",x$b)},x$_._onMessage=function(x$b){if(x$b&&x$b.data){var x$_=x$b.data;if(this.disableInput&&x$_)this.event("message",x$_);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var x$s=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,x$_&&("string"==typeof x$_?this._input.writeUTFBytes(x$_):this._input.writeArrayBuffer(x$_),this._addInputPosition=this._input.pos,this._input.pos=x$s),this.event("message",x$_)}}},x$_._onClose=function(x$b){this._connected=!1,this.event("close",x$b)},x$_._onError=function(x$b){this.event("error",x$b)},x$_.send=function(x$b){this._socket.send(x$b)},x$_.flush=function(){if(this._output&&0<this._output.length){var x$_;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(x$b){x$_=x$b}this._output.endian=this.endian,this._output.clear(),x$_&&this.event("error",x$_)}},x$Q(0,x$_,"input",function(){return this._input}),x$Q(0,x$_,"output",function(){return this._output}),x$Q(0,x$_,"connected",function(){return this._connected}),x$Q(0,x$_,"endian",function(){return this._endian},function(x$b){this._endian=x$b,null!=this._input&&(this._input.endian=x$b),null!=this._output&&(this._output.endian=x$b)}),x$h.LITTLE_ENDIAN="littleEndian",x$h.BIG_ENDIAN="bigEndian"}(),function(x$b){function x$C(){x$C.__super.call(this),this._$1__id=++x$C._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(x$C._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,x$a.currentResourceManager&&x$a.currentResourceManager.addResource(this)}x$f(x$C,"laya.resource.Resource",x$L);var x$_=x$C.prototype;return x$o.imps(x$_,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),x$_._setUrl=function(x$b){var x$_;this._url!==x$b&&(this._url&&((x$_=x$C._urlResourcesMap[this._url]).splice(x$_.indexOf(this),1),0===x$_.length&&delete x$C._urlResourcesMap[this._url]),x$b&&((x$_=x$C._urlResourcesMap[x$b])||(x$C._urlResourcesMap[x$b]=x$_=[]),x$_.push(this)),this._url=x$b)},x$_._getGroup=function(){return this._group},x$_._setGroup=function(x$b){var x$_;this._group!==x$b&&(this._group&&((x$_=x$C._groupResourcesMap[this._group]).splice(x$_.indexOf(this),1),0===x$_.length&&delete x$C._groupResourcesMap[this._group]),x$b&&((x$_=x$C._groupResourcesMap[x$b])||(x$C._groupResourcesMap[x$b]=x$_=[]),x$_.push(this)),this._group=x$b)},x$_._addReference=function(){this._referenceCount++},x$_._removeReference=function(){this._referenceCount--},x$_._clearReference=function(){this._referenceCount=0},x$_._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},x$_.recreateResource=function(){this.completeCreate()},x$_.disposeResource=function(){},x$_.activeResource=function(x$b){void 0===x$b&&(x$b=!1),this._lastUseFrameCount=x$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||x$b)&&this.recreateResource()},x$_.releaseResource=function(x$b){return void 0===x$b&&(x$b=!0),!(!x$b&&this.lock)&&(!(this._released&&!x$b)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},x$_.onAsynLoaded=function(x$b,x$_,x$s){throw new Error("Resource: must override this function!")},x$_.destroy=function(){var x$b;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete x$C._idResourcesMap[this.id],this._url&&((x$b=x$C._urlResourcesMap[this._url])&&(x$b.splice(x$b.indexOf(this),1),0===x$b.length&&delete x$C._urlResourcesMap[this.url]),x$Cb.clearRes(this._url),this.__loaded||x$Z.cancelLoadByUrl(this._url)),this._group&&((x$b=x$C._groupResourcesMap[this._group]).splice(x$b.indexOf(this),1),0===x$b.length&&delete x$C._groupResourcesMap[this.url]))},x$_.completeCreate=function(){this._released=!1,this.event("recovered",this)},x$_.dispose=function(){this.destroy()},x$Q(0,x$_,"memorySize",function(){return this._memorySize},function(x$b){var x$_=x$b-this._memorySize;this._memorySize=x$b,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,x$_),this.resourceManager&&this.resourceManager.addSize(x$_)}),x$Q(0,x$_,"_loaded",null,function(x$b){this.__loaded=x$b}),x$Q(0,x$_,"loaded",function(){return this.__loaded}),x$Q(0,x$_,"id",function(){return this._$1__id}),x$Q(0,x$_,"destroyed",function(){return this._destroyed}),x$Q(0,x$_,"group",function(){return this._getGroup()},function(x$b){this._setGroup(x$b)}),x$Q(0,x$_,"resourceManager",function(){return this._resourceManager}),x$Q(0,x$_,"url",function(){return this._url}),x$Q(0,x$_,"released",function(){return this._released}),x$Q(0,x$_,"referenceCount",function(){return this._referenceCount}),x$C.getResourceByID=function(x$b){return x$C._idResourcesMap[x$b]},x$C.getResourceByURL=function(x$b,x$_){return void 0===x$_&&(x$_=0),null==x$C._urlResourcesMap[x$b]?null:x$C._urlResourcesMap[x$b][x$_]},x$C.getResourceCountByURL=function(x$b){return x$C._urlResourcesMap[x$b].length},x$C.destroyUnusedResources=function(x$b){var x$_;if(x$b){var x$s=x$C._groupResourcesMap[x$b];if(x$s)for(var x$h=x$s.slice(),x$x=0,x$n=x$h.length;x$x<x$n;x$x++)(x$_=x$h[x$x]).lock||0!==x$_._referenceCount||x$_.destroy()}else for(var x$E in x$C._idResourcesMap)(x$_=x$C._idResourcesMap[x$E]).lock||0!==x$_._referenceCount||x$_.destroy()},x$C._uniqueIDCounter=0,x$C._idResourcesMap={},x$C._urlResourcesMap={},x$C._groupResourcesMap={},x$C}()),x$fb=function(x$b){function x$k(x$b,x$_){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,x$k.__super.call(this),x$b&&null!=x$b._addReference&&x$b._addReference(),this.setTo(x$b,x$_)}x$f(x$k,"laya.resource.Texture",x$L);var x$_=x$k.prototype;return x$_._setUrl=function(x$b){this.url=x$b},x$_.setTo=function(x$b,x$_){if(x$b instanceof x$E.HTMLElement){var x$s=x$tb.create("2D",x$b);this.bitmap=x$s}else this.bitmap=x$b;if(this.uv=x$_||x$k.DEF_UV,x$b){this._w=x$b.width,this._h=x$b.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var x$h=this;if(this._loaded)x$Z.addToAtlas&&x$Z.addToAtlas(x$h);else{var x$x=x$b;x$x instanceof laya.resource.HTMLImage&&x$x.image&&x$x.image.addEventListener("load",function(x$b){x$Z.addToAtlas&&x$Z.addToAtlas(x$h)},!1)}}},x$_.active=function(){this.bitmap&&this.bitmap.activeResource()},x$_.destroy=function(x$b){if(void 0===x$b&&(x$b=!1),this.alphaTexture&&(this.alphaTexture.destroy(x$b),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var x$_=this.bitmap;x$b?(x$q.isConchApp&&x$_.source&&x$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,x$_.dispose(),x$_._clearReference()):(x$_._removeReference(),0==x$_.referenceCount&&(x$q.isConchApp&&x$_.source&&x$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,x$_.dispose())),this.url&&this===x$o.loader.getRes(this.url)&&x$o.loader.clearRes(this.url,x$b),this._loaded=!1}},x$_.load=function(x$b){var x$_=this;this._loaded=!1,x$b=x$T.customFormat(x$b);var x$s=this.bitmap||(this.bitmap=x$Db.create(x$b));x$s.uri=x$b,x$s&&x$s._addReference();var x$h=this;x$s.onload=function(){x$s.onload=null,x$h._loaded=!0,x$_.sourceWidth=x$_._w=x$s.width,x$_.sourceHeight=x$_._h=x$s.height,x$h.event("loaded",this),x$Z.addToAtlas&&x$Z.addToAtlas(x$h)}},x$_.addTextureToAtlas=function(x$b){x$Z.addTextureToAtlas(this)},x$_.getPixels=function(x$b,x$_,x$s,x$h){if(x$q.isConchApp){var x$x=this.bitmap;if(x$x.source&&x$x.source.getImageData){var x$n=x$x.source.getImageData(x$b,x$_,x$s,x$h),x$E=new Uint8Array(x$n);return Array.from(x$E)}return null}return x$q.isWebGL?x$Z.getTexturePixels(this,x$b,x$_,x$s,x$h):(x$K.canvas.size(x$s,x$h),x$K.canvas.clear(),x$K.context.drawTexture(this,-x$b,-x$_,this.width,this.height,0,0),x$K.context.getImageData(0,0,x$s,x$h).data)},x$_.onAsynLoaded=function(x$b,x$_){if(x$_){if("function"!=typeof x$_._addReference)throw new Error("bitmap._addReference is not a function. "+x$_.className+" "+typeof x$_._addReference+" "+x$_.constructor);x$_._addReference()}this.setTo(x$_,this.uv),this._loaded&&this.event("loaded",this)},x$Q(0,x$_,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),x$Q(0,x$_,"loaded",function(){return this._loaded}),x$Q(0,x$_,"released",function(){return!this.bitmap||this.bitmap.released}),x$Q(0,x$_,"width",function(){return this._w?this._w:this.uv&&this.uv!==x$k.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(x$b){this._w=x$b,this.sourceWidth||(this.sourceWidth=x$b)}),x$Q(0,x$_,"repeat",function(){return!x$q.isWebGL||!this.bitmap||this.bitmap.repeat},function(x$b){x$b&&x$q.isWebGL&&this.bitmap&&(this.bitmap.repeat=x$b)&&(this.bitmap.enableMerageInAtlas=!1)}),x$Q(0,x$_,"height",function(){return this._h?this._h:this.uv&&this.uv!==x$k.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(x$b){this._h=x$b,this.sourceHeight||(this.sourceHeight=x$b)}),x$Q(0,x$_,"isLinearSampling",function(){return!x$q.isWebGL||9728!=this.bitmap.minFifter},function(x$b){!x$b&&x$q.isWebGL&&(x$b||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),x$k.moveUV=function(x$b,x$_,x$s){for(var x$h=0;x$h<8;x$h+=2)x$s[x$h]+=x$b,x$s[x$h+1]+=x$_;return x$s},x$k.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){void 0===x$n&&(x$n=0),void 0===x$E&&(x$E=0),void 0===x$C&&(x$C=0),void 0===x$O&&(x$O=0);var x$L=x$b instanceof laya.resource.Texture,x$f=x$L?x$b.uv:x$k.DEF_UV,x$p=x$L?x$b.bitmap:x$b,x$P=x$Z.isAtlas(x$p);if(x$P){var x$V=x$p._atlaser,x$Q=x$b._atlasID;if(-1==x$Q)throw new Error("create texture error");x$p=x$V._inAtlasTextureBitmapValue[x$Q],x$f=x$V._inAtlasTextureOriUVValue[x$Q]}var x$y=new x$k(x$p,null);x$p.width&&x$_+x$h>x$p.width&&(x$h=x$p.width-x$_),x$p.height&&x$s+x$x>x$p.height&&(x$x=x$p.height-x$s),x$y.width=x$h,x$y.height=x$x,x$y.offsetX=x$n,x$y.offsetY=x$E,x$y.sourceWidth=x$C||x$h,x$y.sourceHeight=x$O||x$x;var x$w=1/x$p.width,x$i=1/x$p.height;x$_*=x$w,x$s*=x$i,x$h*=x$w,x$x*=x$i;var x$R=x$y.uv[0],x$t=x$y.uv[1],x$c=x$y.uv[4],x$$=x$y.uv[5],x$D=x$c-x$R,x$o=x$$-x$t,x$M=x$k.moveUV(x$f[0],x$f[1],[x$_,x$s,x$_+x$h,x$s,x$_+x$h,x$s+x$x,x$_,x$s+x$x]);x$y.uv=[x$R+x$M[0]*x$D,x$t+x$M[1]*x$o,x$c-(1-x$M[2])*x$D,x$t+x$M[3]*x$o,x$c-(1-x$M[4])*x$D,x$$-(1-x$M[5])*x$o,x$R+x$M[6]*x$D,x$$-(1-x$M[7])*x$o],x$P&&x$y.addTextureToAtlas();var x$r=x$p.scaleRate;return x$r&&1!=x$r?(x$y.sourceWidth/=x$r,x$y.sourceHeight/=x$r,x$y.width/=x$r,x$y.height/=x$r,x$y.scaleRate=x$r,x$y.offsetX/=x$r,x$y.offsetY/=x$r):x$y.scaleRate=1,x$y},x$k.createFromTexture=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$b.scaleRate;1!=x$n&&(x$_*=x$n,x$s*=x$n,x$h*=x$n,x$x*=x$n);var x$E=x$r.TEMP.setTo(x$_-x$b.offsetX,x$s-x$b.offsetY,x$h,x$x),x$C=x$E.intersection(x$k._rect1.setTo(0,0,x$b.width,x$b.height),x$k._rect2);if(!x$C)return null;var x$O=x$k.create(x$b,x$C.x,x$C.y,x$C.width,x$C.height,x$C.x-x$E.x,x$C.y-x$E.y,x$h,x$x);if(x$O.bitmap&&x$O.bitmap._removeReference)return x$O.bitmap._removeReference(),x$O;var x$L="bitmap:"+(x$O.bitmap?x$O.bitmap.constructor?x$O.bitmap.constructor.name:x$O.bitmap.__className:"")+", url:"+(x$b.url+" | "+(x$O.bitmap?x$O.bitmap.url:x$b.url))+", x="+x$_+",y="+x$s+",width="+x$h+",height="+x$x+", result="+(x$C?x$C.x+","+x$C.y+","+x$C.width+","+x$C.height:"null")+", rect="+x$E.x+","+x$E.y+","+x$E.width+","+x$E.height;throw new Error("报错：bitmap._removeReference is not a function  "+x$L)},x$k.DEF_UV=[0,0,1,0,1,1,0,1],x$k.INV_UV=[0,1,1,1,1,0,0,0],x$k._rect1=new x$r,x$k._rect2=new x$r,x$k}(),x$b=function(x$b){var x$C;function x$n(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,x$n.__super.call(this)}x$f(x$n,"laya.utils.TimeLine",x$L);var x$_=x$n.prototype;return x$_.to=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=0),this._create(x$b,x$_,x$s,x$h,x$x,!0)},x$_.from=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=0),this._create(x$b,x$_,x$s,x$h,x$x,!1)},x$_._create=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$N.getItemByClass("tweenData",x$C);return x$E.isTo=x$n,x$E.type=0,x$E.target=x$b,x$E.duration=x$s,x$E.data=x$_,x$E.startTime=this._startTime+x$x,x$E.endTime=x$E.startTime+x$E.duration,x$E.ease=x$h,this._startTime=Math.max(x$E.endTime,this._startTime),this._tweenDataList.push(x$E),this._startTimeSort=!0,this._endTimeSort=!0,this},x$_.addLabel=function(x$b,x$_){var x$s=x$N.getItemByClass("tweenData",x$C);return x$s.type=1,x$s.data=x$b,x$s.endTime=x$s.startTime=this._startTime+x$_,this._labelDic||(this._labelDic={}),this._labelDic[x$b]=x$s,this._tweenDataList.push(x$s),this},x$_.removeLabel=function(x$b){if(this._labelDic&&this._labelDic[x$b]){var x$_=this._labelDic[x$b];if(x$_){var x$s=this._tweenDataList.indexOf(x$_);-1<x$s&&this._tweenDataList.splice(x$s,1)}delete this._labelDic[x$b]}},x$_.gotoTime=function(x$b){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var x$_,x$s,x$h,x$x;for(var x$n in this._firstTweenDic)if(x$s=this._firstTweenDic[x$n])for(var x$E in x$s)x$s.diyTarget.hasOwnProperty(x$E)&&(x$s.diyTarget[x$E]=x$s[x$E]);for(x$n in this._tweenDic)(x$_=this._tweenDic[x$n]).clear(),delete this._tweenDic[x$n];if(this._index=0,this._gidIndex=0,this._currTime=x$b,this._lastTime=x$K.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=x$h=this._tweenDataList.concat(),x$h.sort(function(x$b,x$_){return x$b.endTime>x$_.endTime?1:x$b.endTime<x$_.endTime?-1:0})}else x$h=this._endTweenDataList;for(var x$C=0,x$O=x$h.length;x$C<x$O;x$C++)if(0==(x$x=x$h[x$C]).type){if(!(x$b>=x$x.endTime))break;this._index=Math.max(this._index,x$C+1);var x$L=x$x.data;if(x$x.isTo)for(var x$f in x$L)x$x.target[x$f]=x$L[x$f]}for(x$C=0,x$O=this._tweenDataList.length;x$C<x$O;x$C++)0==(x$x=this._tweenDataList[x$C]).type&&x$b>=x$x.startTime&&x$b<x$x.endTime&&(this._index=Math.max(this._index,x$C+1),this._gidIndex++,(x$_=x$N.getItemByClass("tween",x$m))._create(x$x.target,x$x.data,x$x.duration,x$x.ease,x$R.create(this,this._animComplete,[this._gidIndex]),0,!1,x$x.isTo,!0,!1),x$_.setStartTime(this._currTime-(x$b-x$x.startTime)),x$_._updateEase(this._currTime),x$_.gid=this._gidIndex,this._tweenDic[this._gidIndex]=x$_)}},x$_.gotoLabel=function(x$b){if(null!=this._labelDic){var x$_=this._labelDic[x$b];x$_&&this.gotoTime(x$_.startTime)}},x$_.pause=function(){x$o.timer.clear(this,this._update)},x$_.resume=function(){this.play(this._currTime,this._loopKey)},x$_.play=function(x$b,x$_){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(x$b,x$_){return x$b.startTime>x$_.startTime?1:x$b.startTime<x$_.startTime?-1:0});for(var x$s=0,x$h=this._tweenDataList.length;x$s<x$h;x$s++){var x$x=this._tweenDataList[x$s];if(null!=x$x&&0==x$x.type){var x$n=x$x.target,x$E=x$n.$_GID||(x$n.$_GID=x$e.getGID()),x$C=null;for(var x$O in null==this._firstTweenDic[x$E]?((x$C={}).diyTarget=x$n,this._firstTweenDic[x$E]=x$C):x$C=this._firstTweenDic[x$E],x$x.data)null==x$C[x$O]&&(x$C[x$O]=x$n[x$O])}}}"string"==typeof x$b?this.gotoLabel(x$b):this.gotoTime(x$b),this._loopKey=x$_,this._lastTime=x$K.now(),x$o.timer.frameLoop(1,this,this._update)}},x$_._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var x$b in this._tweenDic)(x$_=this._tweenDic[x$b]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var x$_,x$s=x$K.now(),x$h=x$s-this._lastTime,x$x=this._currTime+=x$h*this.scale;for(x$b in this._lastTime=x$s,this._tweenDic)(x$_=this._tweenDic[x$b])._updateEase(x$x);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var x$n=this._tweenDataList[this._index];x$x>=x$n.startTime&&(this._index++,0==x$n.type?(this._gidIndex++,(x$_=x$N.getItemByClass("tween",x$m))._create(x$n.target,x$n.data,x$n.duration,x$n.ease,x$R.create(this,this._animComplete,[this._gidIndex]),0,!1,x$n.isTo,!0,!1),x$_.setStartTime(x$x),x$_.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=x$_)._updateEase(x$x)):this.event("label",x$n.data))}},x$_._animComplete=function(x$b){this._tweenDic[x$b]&&delete this._tweenDic[x$b]},x$_._complete=function(){this.event("complete")},x$_.reset=function(){var x$b;if(this._labelDic)for(x$b in this._labelDic)delete this._labelDic[x$b];for(x$b in this._tweenDic)this._tweenDic[x$b].clear(),delete this._tweenDic[x$b];for(x$b in this._firstTweenDic)delete this._firstTweenDic[x$b];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var x$_,x$s=0;for(x$_=this._tweenDataList.length,x$s=0;x$s<x$_;x$s++)this._tweenDataList[x$s]&&this._tweenDataList[x$s].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,x$o.timer.clear(this,this._update)},x$_.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},x$Q(0,x$_,"index",function(){return this._frameIndex},function(x$b){this._frameIndex=x$b,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),x$Q(0,x$_,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),x$n.to=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=0),(new x$n).to(x$b,x$_,x$s,x$h,x$x)},x$n.from=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$x&&(x$x=0),(new x$n).from(x$b,x$_,x$s,x$h,x$x)},x$n.__init$=function(){x$C=function(){function x$b(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return x$f(x$b,""),x$b.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,x$N.recover("tweenData",this)},x$b}()},x$n}(),x$pb=function(x$x){function x$s(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,x$s.__super.call(this),this._style=x$C.EMPTY}x$f(x$s,"laya.display.Sprite",x$x);var x$b=x$s.prototype;return x$o.imps(x$b,{"laya.display.ILayout":!0}),x$b.createConchModel=function(){return new ConchNode},x$b.destroy=function(x$b){if(void 0===x$b&&(x$b=!0),this._releaseMem(),!this._destroyed){this.filters=null;var x$_=this.mask;x$_&&(this.mask=null,x$_.destroy(x$b))}x$x.prototype.destroy.call(this,x$b),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},x$b.updateZOrder=function(){x$e.updateOrder(this._childs)&&this.repaint()},x$b.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},x$b.setBounds=function(x$b){this._set$P("uBounds",x$b)},x$b.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new x$r),x$r._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},x$b.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new x$r),x$r._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},x$b._boundPointsToParent=function(x$b){void 0===x$b&&(x$b=!1);var x$_=0,x$s=0;this._style&&(x$_=this._style._tf.translateX,x$s=this._style._tf.translateY,x$b=x$b||0!==this._style._tf.rotate,this._style.scrollRect&&(x$_+=this._style.scrollRect.x,x$s+=this._style.scrollRect.y));var x$h=this._getBoundPointsM(x$b);if(!x$h||x$h.length<1)return x$h;if(8!=x$h.length&&(x$h=x$b?x$$.scanPList(x$h):x$r._getWrapRec(x$h,x$r.TEMP)._getBoundPoints()),!this.transform)return x$e.transPointList(x$h,this._x-x$_,this._y-x$s),x$h;var x$x=x$M.TEMP,x$n=0,x$E=x$h.length;for(x$n=0;x$n<x$E;x$n+=2)x$x.x=x$h[x$n],x$x.y=x$h[x$n+1],this.toParentPoint(x$x),x$h[x$n]=x$x.x,x$h[x$n+1]=x$x.y;return x$h},x$b.getGraphicBounds=function(x$b){return void 0===x$b&&(x$b=!1),this._graphics?this._graphics.getBounds(x$b):x$r.TEMP.setTo(0,0,0,0)},x$b._getBoundPointsM=function(x$b){if(void 0===x$b&&(x$b=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var x$_=x$e.clearArray(this._$P.temBM),x$s=x$r.TEMP;return x$s.copyFrom(this.scrollRect),x$e.concatArray(x$_,x$s._getBoundPoints()),x$_}for(var x$h,x$x,x$n,x$E=this._graphics?this._graphics.getBoundPoints():x$e.clearArray(this._$P.temBM),x$C=0,x$O=(x$n=this._childs).length;x$C<x$O;x$C++)(x$h=x$n[x$C])instanceof laya.display.Sprite&&1==x$h.visible&&(x$x=x$h._boundPointsToParent(x$b))&&(x$E=x$E?x$e.concatArray(x$E,x$x):x$x);return x$E},x$b.getStyle=function(){return this._style===x$C.EMPTY&&(this._style=new x$C),this._style},x$b.setStyle=function(x$b){this._style=x$b},x$b._adjustTransform=function(){this._tfChanged=!1;var x$b,x$_=this._style._tf,x$s=x$_.scaleX,x$h=x$_.scaleY;if(x$_.rotate||1!==x$s||1!==x$h||x$_.skewX||x$_.skewY){(x$b=this._transform||(this._transform=x$J.create())).bTransform=!0;var x$x=.0174532922222222*(x$_.rotate-x$_.skewX),x$n=.0174532922222222*(x$_.rotate+x$_.skewY),x$E=Math.cos(x$n),x$C=Math.sin(x$n),x$O=Math.sin(x$x),x$L=Math.cos(x$x);return x$b.a=x$s*x$E,x$b.b=x$s*x$C,x$b.c=-x$h*x$O,x$b.d=x$h*x$L,x$b.tx=x$b.ty=0,x$b}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,x$b},x$b.pos=function(x$b,x$_,x$s){if(void 0===x$s&&(x$s=!1),this._x!==x$b||this._y!==x$_){if(this.destroyed)return this;if(x$s){this._x=x$b,this._y=x$_,this.conchModel&&this.conchModel.pos(this._x,this._y);var x$h=this._parent;x$h&&0===x$h._repaint&&(x$h._repaint=1,x$h.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=x$b,this.y=x$_}return this},x$b.pivot=function(x$b,x$_){return this.pivotX=x$b,this.pivotY=x$_,this},x$b.size=function(x$b,x$_){return this.width=x$b,this.height=x$_,this},x$b.scale=function(x$b,x$_,x$s){void 0===x$s&&(x$s=!1);var x$h=this.getStyle(),x$x=x$h._tf;if(x$x.scaleX!=x$b||x$x.scaleY!=x$_){if(this.destroyed)return this;if(x$s){x$h.setScale(x$b,x$_),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(x$b,x$_),this._renderType|=4;var x$n=this._parent;x$n&&0===x$n._repaint&&(x$n._repaint=1,x$n.parentRepaint())}else this.scaleX=x$b,this.scaleY=x$_}return this},x$b.skew=function(x$b,x$_){return this.skewX=x$b,this.skewY=x$_,this},x$b.render=function(x$b,x$_,x$s){x$X.spriteCount++,x$G.renders[this._renderType]._fun(this,x$b,x$_+this._x,x$s+this._y),this._repaint=0},x$b.drawToCanvas=function(x$b,x$_,x$s,x$h){if(x$q.isConchNode){var x$x=x$tb.create("2D");return new x$U(x$b,x$_,x$x).ctx.setCanvasType(1),this.conchModel.drawToCanvas(x$x.source,x$s,x$h),x$x}return x$Z.drawToCanvas(this,this._renderType,x$b,x$_,x$s,x$h)},x$b.customRender=function(x$b,x$_,x$s){this._renderType|=1024},x$b._applyFilters=function(){var x$b;if(!x$q.isWebGL&&((x$b=this._$P.filters)&&!(x$b.length<1)))for(var x$_=0,x$s=x$b.length;x$_<x$s;x$_++)x$b[x$_].action.apply(this._$P.cacheCanvas)},x$b._isHaveGlowFilter=function(){var x$b,x$_=0;if(this.filters)for(x$_=0;x$_<this.filters.length;x$_++)if(8==this.filters[x$_].type)return!0;for(x$_=0,x$b=this._childs.length;x$_<x$b;x$_++)if(this._childs[x$_]._isHaveGlowFilter())return!0;return!1},x$b.localToGlobal=function(x$b,x$_){void 0===x$_&&(x$_=!1),!0===x$_&&(x$b=new x$M(x$b.x,x$b.y));for(var x$s=this;x$s&&x$s!=x$o.stage;)x$b=x$s.toParentPoint(x$b),x$s=x$s.parent;return x$b},x$b.globalToLocal=function(x$b,x$_){void 0===x$_&&(x$_=!1),x$_&&(x$b=new x$M(x$b.x,x$b.y));for(var x$s=this,x$h=[];x$s&&x$s!=x$o.stage;)x$h.push(x$s),x$s=x$s.parent;for(var x$x=x$h.length-1;0<=x$x;)x$b=(x$s=x$h[x$x]).fromParentPoint(x$b),x$x--;return x$b},x$b.toParentPoint=function(x$b){if(!x$b)return x$b;x$b.x-=this.pivotX,x$b.y-=this.pivotY,this.transform&&this._transform.transformPoint(x$b),x$b.x+=this._x,x$b.y+=this._y;var x$_=this._style.scrollRect;return x$_&&(x$b.x-=x$_.x,x$b.y-=x$_.y),x$b},x$b.fromParentPoint=function(x$b){if(!x$b)return x$b;x$b.x-=this._x,x$b.y-=this._y;var x$_=this._style.scrollRect;return x$_&&(x$b.x+=x$_.x,x$b.y+=x$_.y),this.transform&&this._transform.invertTransformPoint(x$b),x$b.x+=this.pivotX,x$b.y+=this.pivotY,x$b},x$b.on=function(x$b,x$_,x$s,x$h){return 1!==this._mouseEnableState&&this.isMouseEvent(x$b)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(x$b,x$_,x$s,x$h,!1)):x$x.prototype.on.call(this,x$b,x$_,x$s,x$h)},x$b.once=function(x$b,x$_,x$s,x$h){return 1!==this._mouseEnableState&&this.isMouseEvent(x$b)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(x$b,x$_,x$s,x$h,!0)):x$x.prototype.once.call(this,x$b,x$_,x$s,x$h)},x$b._$2__onDisplay=function(){if(1!==this._mouseEnableState){var x$b=this;for(x$b=x$b.parent;x$b&&1!==x$b._mouseEnableState&&!x$b._getBit(2);)x$b.mouseEnabled=!0,x$b._setBit(2,!0),x$b=x$b.parent}},x$b.loadImage=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=this;return void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),this.graphics.loadImage(x$b,x$_,x$s,x$h,x$x,function(x$b){x$E.destroyed||(x$E.size(x$_+(x$h||x$b.width),x$s+(x$x||x$b.height)),x$E.repaint(),x$n&&x$n.runWith(x$b))}),this},x$b.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},x$b._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},x$b._childChanged=function(x$b){this._childs.length?this._renderType|=2048:this._renderType&=-2049,x$b&&this._get$P("hasZorder")&&x$o.timer.callLater(this,this.updateZOrder),this.repaint()},x$b.parentRepaint=function(){var x$b=this._parent;x$b&&0===x$b._repaint&&(x$b._repaint=1,x$b.parentRepaint())},x$b.startDrag=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){void 0===x$_&&(x$_=!1),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=300),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=.92),this._$P.dragging||this._set$P("dragging",new x$A),this._$P.dragging.start(this,x$b,x$_,x$s,x$h,x$x,x$n,x$E)},x$b.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},x$b._releaseMem=function(){if(this._$P){var x$b=this._$P.cacheCanvas;x$b&&x$b.ctx&&(x$N.recover("RenderContext",x$b.ctx),x$b.ctx.canvas.size(0,0),x$b.ctx=null);var x$_=this._$P._filterCache;x$_&&(x$_.destroy(),x$_.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},x$b._setDisplay=function(x$b){x$b||this._releaseMem(),x$x.prototype._setDisplay.call(this,x$b)},x$b.hitTestPoint=function(x$b,x$_){var x$s=this.globalToLocal(x$M.TEMP.setTo(x$b,x$_));return x$b=x$s.x,x$_=x$s.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?x$r.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(x$b,x$_)},x$b.getMousePoint=function(){return this.globalToLocal(x$M.TEMP.setTo(x$o.stage.mouseX,x$o.stage.mouseY))},x$b._getWords=function(){return null},x$b._addChildsToLayout=function(x$b){var x$_=this._getWords();if(null==x$_&&0==this._childs.length)return!1;if(x$_)for(var x$s=0,x$h=x$_.length;x$s<x$h;x$s++)x$b.push(x$_[x$s]);x$s=0;for(var x$x=this._childs.length;x$s<x$x;++x$s){var x$n=this._childs[x$s];x$n._style._enableLayout()&&x$n._addToLayout(x$b)}return!0},x$b._addToLayout=function(x$b){this._style.absolute||(this._style.block?x$b.push(this):this._addChildsToLayout(x$b)&&(this.x=this.y=0))},x$b._isChar=function(){return!1},x$b._getCSSStyle=function(){return this._style.getCSSStyle()},x$b._setAttributes=function(x$b,x$_){switch(x$b){case"x":this.x=parseFloat(x$_);break;case"y":this.y=parseFloat(x$_);break;case"width":this.width=parseFloat(x$_);break;case"height":this.height=parseFloat(x$_);break;default:this[x$b]=x$_}},x$b._layoutLater=function(){this.parent&&this.parent._layoutLater()},x$Q(0,x$b,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(x$b){this._optimizeScrollRect!=x$b&&(this._optimizeScrollRect=x$b,this.conchModel&&this.conchModel.optimizeScrollRect(x$b))}),x$Q(0,x$b,"customRenderEnable",null,function(x$b){if(x$b&&(this._renderType|=1024,x$q.isConchNode)){x$s.CustomList.push(this);var x$_=new x$tb("2d");x$_._setContext(new CanvasRenderingContext2D),this.customContext=new x$U(0,0,x$_),x$_.context.setCanvasType&&x$_.context.setCanvasType(2),this.conchModel.custom(x$_.context)}}),x$Q(0,x$b,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(x$b){this.cacheAs=x$b?this._$P.hasFilter?"none":"normal":"none"}),x$Q(0,x$b,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(x$b){var x$_=this._$P.cacheCanvas;if(x$b!==(x$_?x$_.type:"none")){if("none"!==x$b)this._getBit(1)||this._setUpNoticeType(1),x$_||(x$_=this._set$P("cacheCanvas",x$N.getItemByClass("cacheCanvas",Object))),x$_.type=x$b,x$_.reCache=!0,this._renderType|=16,"bitmap"==x$b&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(x$_){var x$s=x$_;x$s&&x$s.ctx&&(x$N.recover("RenderContext",x$s.ctx),x$s.ctx.canvas.size(0,0),x$s.ctx=null),x$N.recover("cacheCanvas",x$_)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),x$Q(0,x$b,"zOrder",function(){return this._zOrder},function(x$b){this._zOrder!=x$b&&(this._zOrder=x$b,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(x$b),this._parent&&(x$b&&this._parent._set$P("hasZorder",!0),x$o.timer.callLater(this._parent,this.updateZOrder)))}),x$Q(0,x$b,"rotation",function(){return this._style._tf.rotate},function(x$b){var x$_=this.getStyle();if(x$_._tf.rotate!==x$b){x$_.setRotate(x$b),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(x$b),this._renderType|=4;var x$s=this._parent;x$s&&0===x$s._repaint&&(x$s._repaint=1,x$s.parentRepaint())}}),x$Q(0,x$b,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(x$b){this._width!==x$b&&(this._width=x$b,this.conchModel&&this.conchModel.size(x$b,this._height),this.repaint())}),x$Q(0,x$b,"x",function(){return this._x},function(x$b){if(this._x!==x$b){if(this.destroyed)return;this._x=x$b,this.conchModel&&this.conchModel.pos(x$b,this._y);var x$_=this._parent;x$_&&0===x$_._repaint&&(x$_._repaint=1,x$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),x$Q(0,x$b,"globalScaleY",function(){for(var x$b=1,x$_=this;x$_&&x$_!==x$o.stage;)x$b*=x$_.scaleY,x$_=x$_.parent;return x$b}),x$Q(0,x$b,"hitArea",function(){return this._$P.hitArea},function(x$b){this._set$P("hitArea",x$b)}),x$Q(0,x$b,"staticCache",function(){return this._$P.staticCache},function(x$b){this._set$P("staticCache",x$b),x$b||this.reCache()}),x$Q(0,x$b,"texture",function(){return this._texture},function(x$b){this._texture!=x$b&&(this._texture=x$b,this.graphics.cleanByTexture(x$b,0,0))}),x$Q(0,x$b,"y",function(){return this._y},function(x$b){if(this._y!==x$b){if(this.destroyed)return;this._y=x$b,this.conchModel&&this.conchModel.pos(this._x,x$b);var x$_=this._parent;x$_&&0===x$_._repaint&&(x$_._repaint=1,x$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),x$Q(0,x$b,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(x$b){this._height!==x$b&&(this._height=x$b,this.conchModel&&this.conchModel.size(this._width,x$b),this.repaint())}),x$Q(0,x$b,"blendMode",function(){return this._style.blendMode},function(x$b){this.getStyle().blendMode=x$b,this.conchModel&&this.conchModel.blendMode(x$b),x$b&&"source-over"!=x$b?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),x$Q(0,x$b,"scaleX",function(){return this._style._tf.scaleX},function(x$b){var x$_=this.getStyle();if(x$_._tf.scaleX!==x$b){x$_.setScaleX(x$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(x$b,x$_._tf.scaleY),this._renderType|=4;var x$s=this._parent;x$s&&0===x$s._repaint&&(x$s._repaint=1,x$s.parentRepaint())}}),x$Q(0,x$b,"scaleY",function(){return this._style._tf.scaleY},function(x$b){var x$_=this.getStyle();if(x$_._tf.scaleY!==x$b){x$_.setScaleY(x$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(x$_._tf.scaleX,x$b),this._renderType|=4;var x$s=this._parent;x$s&&0===x$s._repaint&&(x$s._repaint=1,x$s.parentRepaint())}}),x$Q(0,x$b,"stage",function(){return x$o.stage}),x$Q(0,x$b,"skewX",function(){return this._style._tf.skewX},function(x$b){var x$_=this.getStyle();if(x$_._tf.skewX!==x$b){x$_.setSkewX(x$b),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(x$b,x$_._tf.skewY),this._renderType|=4;var x$s=this._parent;x$s&&0===x$s._repaint&&(x$s._repaint=1,x$s.parentRepaint())}}),x$Q(0,x$b,"scrollRect",function(){return this._style.scrollRect},function(x$b){this.getStyle().scrollRect=x$b,this.repaint(),x$b?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(x$b.x,x$b.y,x$b.width,x$b.height)):(this._renderType&=-129,this.conchModel&&(x$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),x$Q(0,x$b,"skewY",function(){return this._style._tf.skewY},function(x$b){var x$_=this.getStyle();if(x$_._tf.skewY!==x$b){x$_.setSkewY(x$b),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(x$_._tf.skewX,x$b),this._renderType|=4;var x$s=this._parent;x$s&&0===x$s._repaint&&(x$s._repaint=1,x$s.parentRepaint())}}),x$Q(0,x$b,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(x$b){this._tfChanged=!1,(this._transform=x$b)&&(this._x=x$b.tx,this._y=x$b.ty,x$b.tx=x$b.ty=0,this.conchModel&&this.conchModel.transform(x$b.a,x$b.b,x$b.c,x$b.d,this._x,this._y)),x$b?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),x$Q(0,x$b,"pivotX",function(){return this._style._tf.translateX},function(x$b){this.getStyle().setTranslateX(x$b),this.conchModel&&this.conchModel.pivot(x$b,this._style._tf.translateY),this.repaint()}),x$Q(0,x$b,"pivotY",function(){return this._style._tf.translateY},function(x$b){this.getStyle().setTranslateY(x$b),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,x$b),this.repaint()}),x$Q(0,x$b,"alpha",function(){return this._style.alpha},function(x$b){this._style&&this._style.alpha!==x$b&&(x$b=x$b<0?0:1<x$b?1:x$b,this.getStyle().alpha=x$b,this.conchModel&&this.conchModel.alpha(x$b),1!==x$b?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),x$Q(0,x$b,"visible",function(){return this._style.visible},function(x$b){this._style&&this._style.visible!==x$b&&(this.getStyle().visible=x$b,this.conchModel&&this.conchModel.visible(x$b),this.parentRepaint())}),x$Q(0,x$b,"graphics",function(){return this._graphics||(this.graphics=x$Z.createGraphics())},function(x$b){this._graphics&&(this._graphics._sp=null),(this._graphics=x$b)?(this._renderType&=-2,this._renderType|=512,(x$b._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(x$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),x$Q(0,x$b,"filters",function(){return this._$P.filters},function(x$b){x$b&&0===x$b.length&&(x$b=null),this._$P.filters!=x$b&&(this._set$P("filters",x$b?x$b.slice():null),x$q.isConchApp&&(this.conchModel&&(x$s.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),x$q.isWebGL&&(x$b&&x$b.length?this._renderType|=32:this._renderType&=-33),x$b&&0<x$b.length?(this._getBit(1)||this._setUpNoticeType(1),x$q.isWebGL&&1==x$b.length&&x$b[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(x$q.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),x$Q(0,x$b,"parent",x$x.prototype._$get_parent,function(x$b){x$o.superSet(x$bb,this,"parent",x$b),x$b&&this._getBit(2)&&this._$2__onDisplay()}),x$Q(0,x$b,"mask",function(){return this._$P._mask},function(x$b){x$b&&this.mask&&this.mask._$P.maskParent||(x$b?(this.cacheAs="bitmap",this._set$P("_mask",x$b),x$b._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",x$b),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(x$b?x$b.conchModel:null),this._renderType|=64,this.parentRepaint())}),x$Q(0,x$b,"mouseEnabled",function(){return 1<this._mouseEnableState},function(x$b){this._mouseEnableState=x$b?2:1}),x$Q(0,x$b,"globalScaleX",function(){for(var x$b=1,x$_=this;x$_&&x$_!==x$o.stage;)x$b*=x$_.scaleX,x$_=x$_.parent;return x$b}),x$Q(0,x$b,"mouseX",function(){return this.getMousePoint().x}),x$Q(0,x$b,"mouseY",function(){return this.getMousePoint().y}),x$s.fromImage=function(x$b){return(new x$s).loadImage(x$b)},x$s._cachePool=[],x$s.CustomList=[],x$O(x$s,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=x$E.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),x$s}(x$bb),x$Pb=function(x$b){function x$_(x$b){this._audio=null,this._onEnd=null,this._resumePlay=null,x$_.__super.call(this),this._onEnd=x$e.bind(this.__onEnd,this),this._resumePlay=x$e.bind(this.__resumePlay,this),x$b.addEventListener("ended",this._onEnd),this._audio=x$b}x$f(x$_,"laya.media.h5audio.AudioSoundChannel",x$hb);var x$s=x$_.prototype;return x$s.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(x$o.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},x$s.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,x$K.container.appendChild(this._audio),this._audio.play()}catch(x$b){this.event("error")}},x$s.play=function(x$b){this.isStopped=!1;try{this._audio.playbackRate=x$S.playbackRate,this._audio.currentTime=this.startTime}catch(x$b){return void this._audio.addEventListener("canplay",this._resumePlay)}x$S.addChannel(this),x$K.container.appendChild(this._audio),!x$b&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},x$s.stop=function(){this.isStopped=!0,x$S.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&x$q.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),x$K.onIE||this._audio!=x$sb._musicAudio&&x$N.recover("audio:"+this.url,this._audio),x$K.removeElement(this._audio),this._audio=null)},x$s.pause=function(){this.isStopped=!0,x$S.removeChannel(this),"pause"in this._audio&&this._audio.pause()},x$s.resume=function(){this._audio&&(this.isStopped=!1,x$S.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},x$Q(0,x$s,"position",function(){return this._audio?this._audio.currentTime:0}),x$Q(0,x$s,"duration",function(){return this._audio?this._audio.duration:0}),x$Q(0,x$s,"volume",function(){return this._audio?this._audio.volume:1},function(x$b){this._audio&&(this._audio.volume=x$b)}),x$_}(),x$Vb=function(x$b){function x$_(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=x$nb.ctx,x$_.__super.call(this),this._onPlayEnd=x$e.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}x$f(x$_,"laya.media.webaudio.WebAudioSoundChannel",x$hb);var x$s=x$_.prototype;return x$s.play=function(x$b){if(x$S.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var x$_=this.context,x$s=this.gain,x$h=x$_.createBufferSource();(this.bufferSource=x$h).buffer=this.audioBuffer,x$h.connect(x$s),x$s&&x$s.disconnect(),x$s.connect(x$_.destination),x$h.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=x$K.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(x$h.loop=!0),x$h.playbackRate.setTargetAtTime?x$h.playbackRate.setTargetAtTime(x$S.playbackRate,this.context.currentTime,.1):x$h.playbackRate.value=x$S.playbackRate,x$h.start(0,this.startTime),!x$b&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},x$s.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(x$o.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},x$s._clearBufferSource=function(){if(this.bufferSource){var x$b=this.bufferSource;x$b.stop?x$b.stop(0):x$b.noteOff(0),x$b.disconnect(0),x$b.onended=null,x$_._tryCleanFailed||this._tryClearBuffer(x$b),this.bufferSource=null}},x$s._tryClearBuffer=function(x$b){try{x$b.buffer=null}catch(x$b){x$_._tryCleanFailed=!0}},x$s.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,x$S.removeChannel(this),this.startHandler=null,this.completeHandler=null},x$s.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,x$S.removeChannel(this)},x$s.resume=function(){this.startTime=this._pauseTime,this.play(!1)},x$Q(0,x$s,"position",function(){return this.bufferSource?(x$K.now()-this._startTime)/1e3+this.startTime:0}),x$Q(0,x$s,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),x$Q(0,x$s,"volume",function(){return this._volume},function(x$b){this.isStopped||(this._volume=x$b,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(x$b,this.context.currentTime,.1):this.gain.gain.value=x$b)}),x$_._tryCleanFailed=!1,x$_}(),x$Qb=function(x$b){function x$_(){x$_.__super.call(this),this._w=0,this._h=0}x$f(x$_,"laya.resource.Bitmap",x$Lb);var x$s=x$_.prototype;return x$Q(0,x$s,"width",function(){return this._w}),x$Q(0,x$s,"height",function(){return this._h}),x$Q(0,x$s,"source",function(){return this._source}),x$_}(),x$yb=function(x$_){function x$b(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,x$b.__super.call(this),this._interval=x$h.animationInterval,this._setUpNoticeType(1)}x$f(x$b,"laya.display.AnimationPlayerBase",x$_);var x$s=x$b.prototype;return x$s.play=function(x$b,x$_,x$s,x$h){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=!0),void 0===x$s&&(x$s=""),void 0===x$h&&(x$h=!0),this._isPlaying=!0,this.index="string"==typeof x$b?this._getFrameByLabel(x$b):x$b,this.loop=x$_,this._actionName=x$s,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},x$s._getFrameByLabel=function(x$b){var x$_=0;for(x$_=0;x$_<this._count;x$_++)if(this._labels[x$_]&&0<=this._labels[x$_].indexOf(x$b))return x$_;return 0},x$s._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},x$s._setControlNode=function(x$b){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=x$b)&&x$b!=this&&(x$b.on("display",this,this._checkResumePlaying),x$b.on("undisplay",this,this._checkResumePlaying))},x$s._setDisplay=function(x$b){x$_.prototype._setDisplay.call(this,x$b),this._checkResumePlaying()},x$s._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},x$s.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},x$s.addLabel=function(x$b,x$_){this._labels||(this._labels={}),this._labels[x$_]||(this._labels[x$_]=[]),this._labels[x$_].push(x$b)},x$s.removeLabel=function(x$b){if(x$b){if(this._labels)for(var x$_ in this._labels)this._removeLabelFromLabelList(this._labels[x$_],x$b)}else this._labels=null},x$s._removeLabelFromLabelList=function(x$b,x$_){if(x$b)for(var x$s=x$b.length-1;0<=x$s;x$s--)x$b[x$s]==x$_&&x$b.splice(x$s,1)},x$s.gotoAndStop=function(x$b){this.index="string"==typeof x$b?this._getFrameByLabel(x$b):x$b,this.stop()},x$s._displayToIndex=function(x$b){},x$s.clear=function(){this.stop(),this._labels=null},x$Q(0,x$s,"interval",function(){return this._interval},function(x$b){this._interval!=x$b&&(this._frameRateChanged=!0,this._interval=x$b,this._isPlaying&&0<x$b&&this.timerLoop(x$b,this,this._frameLoop,null,!0,!0))}),x$Q(0,x$s,"isPlaying",function(){return this._isPlaying}),x$Q(0,x$s,"index",function(){return this._index},function(x$b){if(this._index=x$b,this._displayToIndex(x$b),this._labels&&this._labels[x$b])for(var x$_=this._labels[x$b],x$s=0,x$h=x$_.length;x$s<x$h;x$s++)this.event("label",x$_[x$s])}),x$Q(0,x$s,"count",function(){return this._count}),x$b.WRAP_POSITIVE=0,x$b.WRAP_REVERSE=1,x$b.WRAP_PINGPONG=2,x$b}(x$pb),x$wb=function(x$_){function x$V(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,x$V.__super.call(this),this.overflow=x$V.VISIBLE,this._style=new x$_b(this),this._style.wordWrap=!1}x$f(x$V,"laya.display.Text",x$_);var x$b=x$V.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._lines=null,this._words&&(this._words.length=0,this._words=null)},x$b._getBoundPointsM=function(x$b){void 0===x$b&&(x$b=!1);var x$_=x$r.TEMP;return x$_.setTo(0,0,this.width,this.height),x$_._getBoundPoints()},x$b.getGraphicBounds=function(x$b){void 0===x$b&&(x$b=!1);var x$_=x$r.TEMP;return x$_.setTo(0,0,this.width,this.height),x$_},x$b._getCSSStyle=function(){return this._style},x$b.lang=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f){if(x$b=x$V.langPacks&&x$V.langPacks[x$b]?x$V.langPacks[x$b]:x$b,arguments.length<2)this._text=x$b;else{for(var x$p=0,x$P=arguments.length;x$p<x$P;x$p++)x$b=x$b.replace("{"+x$p+"}",arguments[x$p+1]);this._text=x$b}},x$b._isPassWordMode=function(){var x$b=this._style.password;return"prompt"in this&&this.prompt==this._text&&(x$b=!1),x$b},x$b._getPassWordTxt=function(x$b){var x$_;x$_="";for(var x$s=x$b.length;0<x$s;x$s--)x$_+="●";return x$_},x$b.renderText=function(x$b,x$_){var x$s=this.graphics;x$s.clear(!0);var x$h=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(x$K.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);x$K.context.font=x$h;var x$x=this.padding,x$n=x$x[3],x$E="left",x$C=this._lines,x$O=this.leading+this._charSize.height,x$L=this._currBitmapFont;x$L&&(x$O=this.leading+x$L.getMaxHeight());var x$f=x$x[0];if(!x$L&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(x$E="right",x$n=this._width-x$x[1]):"center"==this.align&&(x$E="center",x$n=.5*this._width+x$x[3]-x$x[1])),0<this._height){var x$p=this._textHeight>this._height?"top":this.valign;"middle"===x$p?x$f=.5*(this._height-x$_*x$O)+x$x[0]-x$x[2]:"bottom"===x$p&&(x$f=this._height-x$_*x$O-x$x[2])}var x$P=this._style;if(x$L&&x$L.autoScaleSize)var x$V=x$L.fontSize/this.fontSize;if(this._clipPoint)if(x$s.save(),x$L&&x$L.autoScaleSize){var x$Q=0,x$y=0;x$Q=this._width?this._width-x$x[3]-x$x[1]:this._textWidth,x$y=this._height?this._height-x$x[0]-x$x[2]:this._textHeight,x$Q*=x$V,x$y*=x$V,x$s.clipRect(x$x[3],x$x[0],x$Q,x$y)}else x$s.clipRect(x$x[3],x$x[0],this._width?this._width-x$x[3]-x$x[1]:this._textWidth,this._height?this._height-x$x[0]-x$x[2]:this._textHeight);var x$w=x$P.password;"prompt"in this&&this.prompt==this._text&&(x$w=!1);for(var x$i=0,x$R=0,x$t=Math.min(this._lines.length,x$_+x$b)||1,x$c=x$b;x$c<x$t;x$c++){var x$$,x$D=x$C[x$c];if(x$w){var x$o=x$D.length;x$D="";for(var x$M=x$o;0<x$M;x$M--)x$D+="●"}if(x$i=x$n-(this._clipPoint?this._clipPoint.x:0),x$R=x$f+x$O*x$c-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(x$E,x$i,x$R,x$c),x$L){var x$r=this.width;x$L.autoScaleSize&&(x$r=this.width*x$V),x$L.drawText(x$D,this,x$i,x$R,this.align,x$r)}else x$q.isWebGL?(this._words||(this._words=[]),(x$$=this._words.length>x$c-x$b?this._words[x$c-x$b]:new x$j).setText(x$D)):x$$=x$D,x$P.stroke?x$s.fillBorderText(x$$,x$i,x$R,x$h,this.color,x$P.strokeColor,x$P.stroke,x$E):x$s.fillText(x$$,x$i,x$R,x$h,this.color,x$E)}if(x$L&&x$L.autoScaleSize){var x$k=1/x$V;this.scale(x$k,x$k)}this._clipPoint&&x$s.restore(),this._startX=x$n,this._startY=x$f},x$b.drawUnderline=function(x$b,x$_,x$s,x$h){var x$x=this._lineWidths[x$h];switch(x$b){case"center":x$_-=x$x/2;break;case"right":x$_-=x$x}x$s+=this._charSize.height,this._graphics.drawLine(x$_,x$s,x$_+x$x,x$s,this.underlineColor||this.color,1)},x$b.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);x$K.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new x$M(0,0)):this._clipPoint=null;var x$b=this._lines.length;if(this.overflow!=x$V.VISIBLE){var x$_=this.overflow==x$V.HIDDEN?Math.floor:Math.ceil;x$b=Math.min(x$b,x$_((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var x$s=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(x$s,x$b),this.repaint()},x$b.evalTextSize=function(){var x$b,x$_=NaN;x$b=Math.max.apply(this,this._lineWidths),x$_=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],x$b==this._textWidth&&x$_==this._textHeight||(this._textWidth=x$b,this._textHeight=x$_,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},x$b.checkEnabledViewportOrNot=function(){return this.overflow==x$V.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},x$b.changeText=function(x$b){this._text!==x$b&&(this.lang(x$b+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},x$b.parseLines=function(x$b){var x$_=this.wordWrap||this.overflow==x$V.HIDDEN;if(x$_)var x$s=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var x$h=x$K.context.measureText(x$V._testWord);x$q.isConchApp&&0===x$h.width&&0===x$h.height&&(x$h=x$K.context.measureText("W")),this._charSize.width=x$h.width,this._charSize.height=x$h.height||this.fontSize}for(var x$x=x$b.replace(/\r\n/g,"\n").split("\n"),x$n=0,x$E=x$x.length;x$n<x$E;x$n++){var x$C=x$x[x$n];x$_?this.parseLine(x$C,x$s):(this._lineWidths.push(this.getTextWidth(x$C)),this._lines.push(x$C))}},x$b.parseLine=function(x$b,x$_){x$K.context;var x$s,x$h=this._lines,x$x=0,x$n=NaN,x$E=NaN,x$C=0;if((x$n=this.getTextWidth(x$b))<=x$_)return x$h.push(x$b),void this._lineWidths.push(x$n);x$n=this._charSize.width,0==(x$x=Math.floor(x$_/x$n))&&(x$x=1),x$E=x$n=this.getTextWidth(x$b.substring(0,x$x));for(var x$O=x$x,x$L=x$b.length;x$O<x$L;x$O++)if(x$_<(x$E+=x$n=this.getTextWidth(x$b.charAt(x$O))))if(this.wordWrap){var x$f=x$b.substring(x$C,x$O);if(x$f.charCodeAt(x$f.length-1)<255?(x$s=/(?:\w|-)+$/.exec(x$f))&&(x$O=x$s.index+x$C,0==x$s.index?x$O+=x$f.length:x$f=x$b.substring(x$C,x$O)):x$V.RightToLeft&&(x$s=/([\u0600-\u06FF])+$/.exec(x$f))&&(x$O=x$s.index+x$C,0==x$s.index?x$O+=x$f.length:x$f=x$b.substring(x$C,x$O)),x$h.push(x$f),this._lineWidths.push(x$E-x$n),!((x$C=x$O)+x$x<x$L)){x$h.push(x$b.substring(x$C,x$L)),this._lineWidths.push(this.getTextWidth(x$h[x$h.length-1])),x$C=-1;break}x$O+=x$x,x$E=x$n=this.getTextWidth(x$b.substring(x$C,x$O)),x$O--}else if(this.overflow==x$V.HIDDEN)return x$h.push(x$b.substring(0,x$O)),void this._lineWidths.push(this.getTextWidth(x$h[x$h.length-1]));this.wordWrap&&-1!=x$C&&(x$h.push(x$b.substring(x$C,x$L)),this._lineWidths.push(this.getTextWidth(x$h[x$h.length-1])))},x$b.getTextWidth=function(x$b){return this._currBitmapFont?this._currBitmapFont.getTextWidth(x$b):x$K.context.measureText(x$b).width},x$b.getWordWrapWidth=function(){var x$b=this.padding,x$_=NaN;return(x$_=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(x$_=this.wordWrap?100:x$K.width),x$_<=0&&(x$_=100),x$_-x$b[3]-x$b[1]},x$b.getCharPoint=function(x$b,x$_){this._isChanged&&x$o.timer.runCallLater(this,this.typeset);for(var x$s=0,x$h=this._lines,x$x=0,x$n=0,x$E=x$h.length;x$n<x$E;x$n++){if(x$b<(x$s+=x$h[x$n].length)){var x$C=x$n;break}x$x=x$s}var x$O=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;x$K.context.font=x$O;var x$L=this.getTextWidth(this._text.substring(x$x,x$b));return(x$_||new x$M).setTo(this._startX+x$L-(this._clipPoint?this._clipPoint.x:0),this._startY+x$C*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},x$Q(0,x$b,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(x$b){x$b!=this._width&&(x$o.superSet(x$pb,this,"width",x$b),this.isChanged=!0)}),x$Q(0,x$b,"textWidth",function(){return this._isChanged&&x$o.timer.runCallLater(this,this.typeset),this._textWidth}),x$Q(0,x$b,"height",function(){return this._height?this._height:this.textHeight},function(x$b){x$b!=this._height&&(x$o.superSet(x$pb,this,"height",x$b),this.isChanged=!0)}),x$Q(0,x$b,"textHeight",function(){return this._isChanged&&x$o.timer.runCallLater(this,this.typeset),this._textHeight}),x$Q(0,x$b,"padding",function(){return this._getCSSStyle().padding},function(x$b){this._getCSSStyle().padding=x$b,this.isChanged=!0}),x$Q(0,x$b,"bold",function(){return this._getCSSStyle().bold},function(x$b){this._getCSSStyle().bold=x$b,this.isChanged=!0}),x$Q(0,x$b,"text",function(){return this._text||""},function(x$b){this._text!==x$b&&(this.lang(x$b+""),this.isChanged=!0,this.event("change"))}),x$Q(0,x$b,"color",function(){return this._getCSSStyle().color},function(x$b){this._getCSSStyle().color!=x$b&&(this._getCSSStyle().color=x$b,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),x$Q(0,x$b,"font",function(){return this._getCSSStyle().fontFamily},function(x$b){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),x$V._bitmapFonts&&x$V._bitmapFonts[x$b]&&(this._currBitmapFont=x$V._bitmapFonts[x$b]),this._getCSSStyle().fontFamily=x$b,this.isChanged=!0}),x$Q(0,x$b,"fontSize",function(){return this._getCSSStyle().fontSize},function(x$b){this._getCSSStyle().fontSize=x$b,this.isChanged=!0}),x$Q(0,x$b,"italic",function(){return this._getCSSStyle().italic},function(x$b){this._getCSSStyle().italic=x$b,this.isChanged=!0}),x$Q(0,x$b,"align",function(){return this._getCSSStyle().align},function(x$b){this._getCSSStyle().align=x$b,this.isChanged=!0}),x$Q(0,x$b,"valign",function(){return this._getCSSStyle().valign},function(x$b){this._getCSSStyle().valign=x$b,this.isChanged=!0}),x$Q(0,x$b,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(x$b){this._getCSSStyle().wordWrap=x$b,this.isChanged=!0}),x$Q(0,x$b,"leading",function(){return this._getCSSStyle().leading},function(x$b){this._getCSSStyle().leading=x$b,this.isChanged=!0}),x$Q(0,x$b,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(x$b){this._getCSSStyle().backgroundColor=x$b,this.isChanged=!0}),x$Q(0,x$b,"borderColor",function(){return this._getCSSStyle().borderColor},function(x$b){this._getCSSStyle().borderColor=x$b,this.isChanged=!0}),x$Q(0,x$b,"stroke",function(){return this._getCSSStyle().stroke},function(x$b){this._getCSSStyle().stroke=x$b,this.isChanged=!0}),x$Q(0,x$b,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(x$b){this._getCSSStyle().strokeColor=x$b,this.isChanged=!0}),x$Q(0,x$b,"isChanged",null,function(x$b){this._isChanged!==x$b&&(this._isChanged=x$b)&&x$o.timer.callLater(this,this.typeset)}),x$Q(0,x$b,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(x$b){if(!(this.overflow!=x$V.SCROLL||this.textWidth<this._width)&&this._clipPoint){x$b=x$b<this.padding[3]?this.padding[3]:x$b;var x$_=this._textWidth-this._width;x$b=x$_<x$b?x$_:x$b;var x$s=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=x$b,this.renderText(this._lastVisibleLineIndex,x$s)}}),x$Q(0,x$b,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(x$b){if(!(this.overflow!=x$V.SCROLL||this.textHeight<this._height)&&this._clipPoint){x$b=x$b<this.padding[0]?this.padding[0]:x$b;var x$_=this._textHeight-this._height,x$s=(x$b=x$_<x$b?x$_:x$b)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=x$s;var x$h=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=x$b,this.renderText(x$s,x$h)}}),x$Q(0,x$b,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),x$Q(0,x$b,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),x$Q(0,x$b,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),x$Q(0,x$b,"underlineColor",function(){return this._underlineColor},function(x$b){this._underlineColor=x$b,this._isChanged=!0,this.typeset()}),x$V.registerBitmapFont=function(x$b,x$_){x$V._bitmapFonts||(x$V._bitmapFonts={}),x$V._bitmapFonts[x$b]=x$_},x$V.unregisterBitmapFont=function(x$b,x$_){if(void 0===x$_&&(x$_=!0),x$V._bitmapFonts&&x$V._bitmapFonts[x$b]){var x$s=x$V._bitmapFonts[x$b];x$_&&x$s.destroy(),delete x$V._bitmapFonts[x$b]}},x$V.setTextRightToLeft=function(){var x$b;(x$b=x$K.canvas.source.style).display="none",x$b.position="absolute",x$b.direction="rtl",x$q._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,x$K.document.body.appendChild(x$K.canvas.source)},x$V.supportFont=function(x$b){x$K.context.font="10px sans-serif";var x$_=x$K.context.measureText("abcji").width;x$K.context.font="10px "+x$b;var x$s=x$K.context.measureText("abcji").width;return console.log(x$_,x$s),x$_!==x$s},x$V._testWord="游",x$V.langPacks=null,x$V.VISIBLE="visible",x$V.SCROLL="scroll",x$V.HIDDEN="hidden",x$V.CharacterCache=!0,x$V.RightToLeft=!1,x$V._bitmapFonts=null,x$O(x$V,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),x$V}(x$pb),x$ib=function(x$p){function x$E(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",x$E.__super.call(this),this.offset=new x$M,this._canvasTransform=new x$J,this._previousOrientation=x$K.window.orientation;var x$_=this;this.transform=x$J.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var x$b=x$K.window,x$s=this;x$b.addEventListener("focus",function(){x$_._isFocused=!0,x$s.event("focus"),x$s.event("focuschange")}),x$b.addEventListener("blur",function(){x$_._isFocused=!1,x$s.event("blur"),x$s.event("focuschange"),x$s._isInputting()&&(x$$b.inputElement.target.focus=!1)});var x$h="visibilityState",x$x="visibilitychange",x$n=x$b.document;void 0!==x$n.hidden?(x$x="visibilitychange",x$h="visibilityState"):void 0!==x$n.mozHidden?(x$x="mozvisibilitychange",x$h="mozVisibilityState"):void 0!==x$n.msHidden?(x$x="msvisibilitychange",x$h="msVisibilityState"):void 0!==x$n.webkitHidden&&(x$x="webkitvisibilitychange",x$h="webkitVisibilityState"),x$b.document.addEventListener(x$x,function(){"hidden"==x$K.document[x$h]?x$s._setStageVisible(!1):x$s._setStageVisible(!0)}),x$b.document.addEventListener("qbrowserVisibilityChange",function(x$b){x$s._setStageVisible(!x$b.hidden)}),x$b.addEventListener("resize",function(){var x$b=x$K.window.orientation;null!=x$b&&x$b!=x$_._previousOrientation&&x$s._isInputting()&&(x$$b.inputElement.target.focus=!1),x$_._previousOrientation=x$b,x$s._isInputting()||x$s._resetCanvas()}),x$b.addEventListener("orientationchange",function(x$b){x$s._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),x$K.onMobile&&this.on("mousedown",this,this._onmouseMove)}x$f(x$E,"laya.display.Stage",x$p);var x$b=x$E.prototype;return x$b._setStageVisible=function(x$b){this._isVisibility!=x$b&&(this._isVisibility=x$b,this._isVisibility||this._isInputting()&&(x$$b.inputElement.target.focus=!1),this.event("visibilitychange"))},x$b._isInputting=function(){return x$K.onMobile&&x$$b.isInputting},x$b._changeCanvasSize=function(){this.setScreenSize(x$K.clientWidth*x$K.pixelRatio,x$K.clientHeight*x$K.pixelRatio)},x$b._resetCanvas=function(){if(this.screenAdaptationEnabled){var x$b=x$q._mainCanvas;x$b.source.style;x$b.size(1,1),x$o.timer.once(100,this,this._changeCanvasSize)}},x$b.setScreenSize=function(x$b,x$_){var x$s=!1;if("none"!==this._screenMode&&(x$s=(x$b/x$_<1?"vertical":"horizontal")!==this._screenMode)){var x$h=x$_;x$_=x$b,x$b=x$h}this.canvasRotation=x$s;var x$x=x$q._mainCanvas,x$n=x$x.source.style,x$E=this._canvasTransform.identity(),x$C=this._scaleMode,x$O=x$b/this.designWidth,x$L=x$_/this.designHeight,x$f=this.designWidth,x$p=this.designHeight,x$P=x$b,x$V=x$_,x$Q=x$K.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,x$C){case"noscale":x$O=x$L=1,x$P=this.designWidth,x$V=this.designHeight;break;case"showall":x$O=x$L=Math.min(x$O,x$L),x$f=x$P=Math.round(this.designWidth*x$O),x$p=x$V=Math.round(this.designHeight*x$L);break;case"noborder":x$O=x$L=Math.max(x$O,x$L),x$P=Math.round(this.designWidth*x$O),x$V=Math.round(this.designHeight*x$L);break;case"full":x$O=x$L=1,this._width=x$f=x$b,this._height=x$p=x$_;break;case"fixedwidth":x$L=x$O,this._height=x$p=Math.round(x$_/x$O);break;case"fixedheight":x$O=x$L,this._width=x$f=Math.round(x$b/x$L);break;case"fixedauto":x$b/x$_<this.designWidth/this.designHeight?(x$L=x$O,this._height=x$p=Math.round(x$_/x$O)):(x$O=x$L,this._width=x$f=Math.round(x$b/x$L))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,x$f=x$f+1&2147483646,x$p=x$p+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),x$O*=this.scaleX,x$L*=this.scaleY,1===x$O&&1===x$L?this.transform.identity():(this.transform.a=this._formatData(x$O/(x$P/x$f)),this.transform.d=this._formatData(x$L/(x$V/x$p)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),x$x.size(x$f,x$p),x$Z.changeWebGLSize(x$f,x$p),x$E.scale(x$P/x$f/x$Q,x$V/x$p/x$Q),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(x$b-x$P)/x$Q:this.offset.x=.5*(x$b-x$P)/x$Q,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(x$_-x$V)/x$Q:this.offset.y=.5*(x$_-x$V)/x$Q,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),x$E.translate(this.offset.x,this.offset.y),this.canvasDegree=0,x$s&&("horizontal"===this._screenMode?(x$E.rotate(Math.PI/2),x$E.translate(x$_/x$Q,0),this.canvasDegree=90):(x$E.rotate(-Math.PI/2),x$E.translate(0,x$b/x$Q),this.canvasDegree=-90)),x$E.a=this._formatData(x$E.a),x$E.d=this._formatData(x$E.d),x$E.tx=this._formatData(x$E.tx),x$E.ty=this._formatData(x$E.ty),x$n.transformOrigin=x$n.webkitTransformOrigin=x$n.msTransformOrigin=x$n.mozTransformOrigin=x$n.oTransformOrigin="0px 0px 0px",x$n.transform=x$n.webkitTransform=x$n.msTransform=x$n.mozTransform=x$n.oTransform="matrix("+x$E.toString()+")",x$E.translate(parseInt(x$n.left)||0,parseInt(x$n.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},x$b._formatData=function(x$b){return Math.abs(x$b)<1e-6?0:Math.abs(1-x$b)<.001?0<x$b?1:-1:x$b},x$b.getMousePoint=function(){return x$M.TEMP.setTo(this.mouseX,this.mouseY)},x$b.repaint=function(){this._repaint=1},x$b.parentRepaint=function(){},x$b._loop=function(){return this.render(x$q.context,0,0),!0},x$b._onmouseMove=function(x$b){this._mouseMoveTime=x$K.now()},x$b.getTimeFromFrameStart=function(){return x$K.now()-this._frameStartTime},x$b.render=function(x$b,x$_,x$s){if("sleep"===this._frameRate&&!x$q.isConchApp){var x$h=x$K.now();if(!(1e3<=x$h-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(x$X.loopCount++,x$y.instance.runEvent(),x$o.timer._update()));this._frameStartTime=x$h}if(this._renderCount++,x$q.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=x$K.now();var x$x="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),x$n=this._renderCount%2==0;if(x$X.renderSlow=!x$x,x$x||x$n||x$q.isConchApp){var x$E;x$X.loopCount++,x$y.instance.runEvent(),x$o.timer._update(),x$Z.update3DLoop();var x$C=0,x$O=0;if(x$q.isConchNode)for(x$C=0,x$O=this._scenes.length;x$C<x$O;x$C++)(x$E=this._scenes[x$C])&&x$E._updateSceneConch();else for(x$C=0,x$O=this._scenes.length;x$C<x$O;x$C++)(x$E=this._scenes[x$C])&&x$E._updateScene();if(x$q.isConchNode){var x$L=x$pb.CustomList;for(x$C=0,x$O=x$L.length;x$C<x$O;x$C++){var x$f=x$L[x$C];x$f.customRender(x$f.customContext,0,0)}return}}x$q.isConchNode||this.renderingEnabled&&(x$x||!x$n||x$q.isConchWebGL)&&(x$q.isWebGL?x$q.WebGL.mainContext&&!x$q.WebGL.mainContext.isContextLost()&&(x$b.clear(),x$p.prototype.render.call(this,x$b,x$_,x$s),x$X._show&&x$X._sp&&x$X._sp.render(x$b,x$_,x$s),x$Z.clear(this._bgColor),x$Z.beginFlush(),x$b.flush(),x$Z.endFinish(),x$v.instance&&x$v.getInstance().endDispose()):(x$Z.clear(this._bgColor),x$p.prototype.render.call(this,x$b,x$_,x$s),x$X._show&&x$X._sp&&x$X._sp.render(x$b,x$_,x$s)))}else this._renderCount%5==0&&(x$X.loopCount++,x$y.instance.runEvent(),x$o.timer._update())},x$b._requestFullscreen=function(){var x$b=x$K.document.documentElement;x$b.requestFullscreen?x$b.requestFullscreen():x$b.mozRequestFullScreen?x$b.mozRequestFullScreen():x$b.webkitRequestFullscreen?x$b.webkitRequestFullscreen():x$b.msRequestFullscreen&&x$b.msRequestFullscreen()},x$b._fullScreenChanged=function(){x$o.stage.event("fullscreenchange")},x$b.exitFullscreen=function(){var x$b=x$K.document;x$b.exitFullscreen?x$b.exitFullscreen():x$b.mozCancelFullScreen?x$b.mozCancelFullScreen():x$b.webkitExitFullscreen&&x$b.webkitExitFullscreen()},x$Q(0,x$b,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),x$Q(0,x$b,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),x$Q(0,x$b,"frameRate",function(){return this._frameRate},function(x$b){if(this._frameRate=x$b,x$q.isConchApp)switch(this._frameRate){case"slow":x$K.window.conch&&x$K.window.conchConfig.setSlowFrame&&x$K.window.conchConfig.setSlowFrame(!0);break;case"fast":x$K.window.conch&&x$K.window.conchConfig.setSlowFrame&&x$K.window.conchConfig.setSlowFrame(!1);break;case"mouse":x$K.window.conch&&x$K.window.conchConfig.setMouseFrame&&x$K.window.conchConfig.setMouseFrame(2e3);break;case"sleep":x$K.window.conch&&x$K.window.conchConfig.setLimitFPS&&x$K.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),x$Q(0,x$b,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),x$Q(0,x$b,"width",x$p.prototype._$get_width,function(x$b){this.designWidth=x$b,x$o.superSet(x$pb,this,"width",x$b),x$o.timer.callLater(this,this._changeCanvasSize)}),x$Q(0,x$b,"alignH",function(){return this._alignH},function(x$b){this._alignH=x$b,x$o.timer.callLater(this,this._changeCanvasSize)}),x$Q(0,x$b,"isFocused",function(){return this._isFocused}),x$Q(0,x$b,"height",x$p.prototype._$get_height,function(x$b){this.designHeight=x$b,x$o.superSet(x$pb,this,"height",x$b),x$o.timer.callLater(this,this._changeCanvasSize)}),x$Q(0,x$b,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||x$J.create()},x$p.prototype._$set_transform),x$Q(0,x$b,"isVisibility",function(){return this._isVisibility}),x$Q(0,x$b,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),x$Q(0,x$b,"scaleMode",function(){return this._scaleMode},function(x$b){this._scaleMode=x$b,x$o.timer.callLater(this,this._changeCanvasSize)}),x$Q(0,x$b,"alignV",function(){return this._alignV},function(x$b){this._alignV=x$b,x$o.timer.callLater(this,this._changeCanvasSize)}),x$Q(0,x$b,"bgColor",function(){return this._bgColor},function(x$b){this._bgColor=x$b,this.conchModel&&this.conchModel.bgColor(x$b),x$q.isWebGL&&(x$b?x$E._wgColor=x$F.create(x$b)._color:x$K.onMiniGame||(x$E._wgColor=null)),x$K.onLimixiu?x$E._wgColor=x$F.create(x$b)._color:x$q.canvas.style.background=x$b||"none"}),x$Q(0,x$b,"mouseX",function(){return Math.round(x$y.instance.mouseX/this.clientScaleX)}),x$Q(0,x$b,"mouseY",function(){return Math.round(x$y.instance.mouseY/this.clientScaleY)}),x$Q(0,x$b,"screenMode",function(){return this._screenMode},function(x$b){this._screenMode=x$b}),x$Q(0,x$b,"visible",x$p.prototype._$get_visible,function(x$b){this.visible!==x$b&&(x$o.superSet(x$pb,this,"visible",x$b),x$q._mainCanvas.source.style.visibility=x$b?"visible":"hidden")}),x$Q(0,x$b,"fullScreenEnabled",null,function(x$b){var x$_=x$K.document,x$s=x$q.canvas;x$b?(x$s.addEventListener("mousedown",this._requestFullscreen),x$s.addEventListener("touchstart",this._requestFullscreen),x$_.addEventListener("fullscreenchange",this._fullScreenChanged),x$_.addEventListener("mozfullscreenchange",this._fullScreenChanged),x$_.addEventListener("webkitfullscreenchange",this._fullScreenChanged),x$_.addEventListener("msfullscreenchange",this._fullScreenChanged)):(x$s.removeEventListener("mousedown",this._requestFullscreen),x$s.removeEventListener("touchstart",this._requestFullscreen),x$_.removeEventListener("fullscreenchange",this._fullScreenChanged),x$_.removeEventListener("mozfullscreenchange",this._fullScreenChanged),x$_.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),x$_.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),x$E.SCALE_NOSCALE="noscale",x$E.SCALE_EXACTFIT="exactfit",x$E.SCALE_SHOWALL="showall",x$E.SCALE_NOBORDER="noborder",x$E.SCALE_FULL="full",x$E.SCALE_FIXED_WIDTH="fixedwidth",x$E.SCALE_FIXED_HEIGHT="fixedheight",x$E.SCALE_FIXED_AUTO="fixedauto",x$E.ALIGN_LEFT="left",x$E.ALIGN_RIGHT="right",x$E.ALIGN_CENTER="center",x$E.ALIGN_TOP="top",x$E.ALIGN_MIDDLE="middle",x$E.ALIGN_BOTTOM="bottom",x$E.SCREEN_NONE="none",x$E.SCREEN_HORIZONTAL="horizontal",x$E.SCREEN_VERTICAL="vertical",x$E.FRAME_FAST="fast",x$E.FRAME_SLOW="slow",x$E.FRAME_MOUSE="mouse",x$E.FRAME_SLEEP="sleep",x$E.FRAME_MOUSE_THREDHOLD=2e3,x$O(x$E,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),x$E}(x$pb),x$Rb=(function(x$b){function x$_(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,x$_.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}x$f(x$_,"laya.media.SoundNode",x$pb);var x$s=x$_.prototype;x$s._onParentChange=function(){this.target=this.parent},x$s.play=function(x$b,x$_){void 0===x$b&&(x$b=1),isNaN(x$b)&&(x$b=1),this.url&&(this.stop(),this._channel=x$S.playSound(this.url,x$b,null,x$_))},x$s.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},x$s._setPlayAction=function(x$b,x$_,x$s,x$h){void 0===x$h&&(x$h=!0),this[x$s]&&x$b&&(x$h?x$b.on(x$_,this,this[x$s]):x$b.off(x$_,this,this[x$s]))},x$s._setPlayActions=function(x$b,x$_,x$s,x$h){if(void 0===x$h&&(x$h=!0),x$b&&x$_){var x$x,x$n=x$_.split(","),x$E=0;for(x$x=x$n.length,x$E=0;x$E<x$x;x$E++)this._setPlayAction(x$b,x$n[x$E],x$s,x$h)}},x$Q(0,x$s,"playEvent",null,function(x$b){(this._playEvents=x$b)&&this._tar&&this._setPlayActions(this._tar,x$b,"play")}),x$Q(0,x$s,"target",null,function(x$b){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=x$b,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),x$Q(0,x$s,"stopEvent",null,function(x$b){(this._stopEvents=x$b)&&this._tar&&this._setPlayActions(this._tar,x$b,"stop")})}(),function(x$b){function x$_(){this._src=null,this._onload=null,this._onerror=null,x$_.__super.call(this)}x$f(x$_,"laya.resource.FileBitmap",x$Qb);var x$s=x$_.prototype;return x$Q(0,x$s,"src",function(){return this._src},function(x$b){this._src=x$b}),x$Q(0,x$s,"onload",null,function(x$b){}),x$Q(0,x$s,"onerror",null,function(x$b){}),x$_}()),x$tb=function(x$b){function x$s(x$b,x$_){this._is2D=!1,x$s.__super.call(this);var x$h=this;if(this._source=this,"2D"===x$b||"AUTO"===x$b&&!x$q.isWebGL){this._is2D=!0,this._source=x$_||x$K.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var x$x=this;x$x.getContext=function(x$b,x$_){if(x$h._ctx)return x$h._ctx;var x$s=x$h._ctx=x$h._source.getContext(x$b,x$_);return x$s&&(x$s._canvas=x$x,x$q.isFlash||x$K.onLimixiu||(x$s.size=function(x$b,x$_){})),x$s}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}x$f(x$s,"laya.resource.HTMLCanvas",x$Qb);var x$_=x$s.prototype;return x$_.clear=function(){this._ctx&&this._ctx.clear()},x$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},x$_.release=function(){},x$_._setContext=function(x$b){this._ctx=x$b},x$_.getContext=function(x$b,x$_){return this._ctx?this._ctx:this._ctx=x$s._createContext(this)},x$_.getMemSize=function(){return 0},x$_.size=function(x$b,x$_){(this._w!=x$b||this._h!=x$_||this._source&&(this._source.width!=x$b||this._source.height!=x$_))&&(this._w=x$b,this._h=x$_,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(x$b,x$_),this._source&&(this._source.height=x$_,this._source.width=x$b))},x$_.getCanvas=function(){return this._source},x$_.toBase64=function(x$b,x$_,x$s){if(this._source)if(x$q.isConchApp&&this._source.toBase64)this._source.toBase64(x$b,x$_,x$s);else{var x$h=this._source.toDataURL(x$b,x$_);x$s.call(this,x$h)}},x$Q(0,x$_,"context",function(){return this._ctx}),x$Q(0,x$_,"asBitmap",null,function(x$b){}),x$s.create=function(x$b,x$_){return new x$s(x$b,x$_)},x$s.TYPE2D="2D",x$s.TYPE3D="3D",x$s.TYPEAUTO="AUTO",x$s._createContext=null,x$s}(),x$cb=(function(x$b){function x$O(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){throw x$O.__super.call(this),new Error("不允许new！")}x$f(x$O,"laya.resource.HTMLSubImage",x$Qb),x$O.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){return void 0===x$C&&(x$C=!1),new x$O(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C)}}(),function(x$b){function x$p(){this._frames=null,this._url=null,x$p.__super.call(this),this._setControlNode(this)}x$f(x$p,"laya.display.Animation",x$b);var x$_=x$p.prototype;x$_.destroy=function(x$b){void 0===x$b&&(x$b=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,x$b),this._frames=null,this._labels=null},x$_.play=function(x$b,x$_,x$s,x$h){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=!0),void 0===x$s&&(x$s=""),void 0===x$h&&(x$h=!0),x$s&&this._setFramesFromCache(x$s,x$h),this._isPlaying=!0,this.index="string"==typeof x$b?this._getFrameByLabel(x$b):x$b,this.loop=x$_,this._actionName=x$s,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},x$_._setFramesFromCache=function(x$b,x$_){var x$s;return void 0===x$_&&(x$_=!1),this._url&&(x$b=this._url+"#"+x$b),x$b&&x$p.framesMap[x$b]?((x$s=x$p.framesMap[x$b])instanceof Array?(this._frames=x$p.framesMap[x$b],this._count=this._frames.length):(x$s.nodeRoot&&(x$p.framesMap[x$b]=this._parseGraphicAnimationByData(x$s),x$s=x$p.framesMap[x$b]),this._frames=x$s.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=x$s.interval),this._labels=this._copyLabels(x$s.labels)),!0):(x$_&&console.log("ani not found:",x$b),!1)},x$_._copyLabels=function(x$b){if(!x$b)return null;var x$_,x$s;for(x$s in x$_={},x$b)x$_[x$s]=x$e.copyArray([],x$b[x$s]);return x$_},x$_._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&x$b.prototype._frameLoop.call(this)},x$_._displayToIndex=function(x$b){this._frames&&(this.graphics=this._frames[x$b])},x$_.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},x$_.loadImages=function(x$b,x$_){return void 0===x$_&&(x$_=""),this._url="",this._setFramesFromCache(x$_)||(this.frames=x$p.framesMap[x$_]?x$p.framesMap[x$_]:x$p.createFrames(x$b,x$_)),this},x$_.loadAtlas=function(x$_,x$s,x$h){void 0===x$h&&(x$h=""),this._url="";var x$x=this;function x$b(x$b){x$_===x$b&&(x$x.frames=x$p.framesMap[x$h]?x$p.framesMap[x$h]:x$p.createFrames(x$_,x$h),x$s&&x$s.run())}return x$x._setFramesFromCache(x$h)||(x$Cb.getAtlas(x$_)?x$b(x$_):x$o.loader.load(x$_,x$R.create(null,x$b,[x$_]),null,"atlas")),this},x$_.loadAnimation=function(x$b,x$_,x$s){this._url=x$b;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,x$_&&x$_.run()):!x$s||x$Cb.getAtlas(x$s)?this._loadAnimationData(x$b,x$_,x$s):x$o.loader.load(x$s,x$R.create(this,this._loadAnimationData,[x$b,x$_,x$s]),null,"atlas"),this},x$_._loadAnimationData=function(x$C,x$O,x$b){var x$L=this;if(!x$b||x$Cb.getAtlas(x$b)){var x$f=this;x$Cb.getRes(x$C)?x$_(x$C):x$o.loader.load(x$C,x$R.create(null,x$_,[x$C]),null,"json"),x$Cb.clearRes(x$C)}else console.warn("atlas load fail:"+x$b);function x$_(x$b){if(x$Cb.getRes(x$b)&&x$C===x$b){var x$_;if(x$p.framesMap[x$C+"#"])x$f._setFramesFromCache(x$L._actionName,!0),x$L.index=0,x$L._checkResumePlaying();else{var x$s=x$f._parseGraphicAnimation(x$Cb.getRes(x$C));if(!x$s)return;var x$h,x$x=x$s.animationList,x$n=0,x$E=x$x.length;for(x$n=0;x$n<x$E;x$n++)x$_=x$x[x$n],x$p.framesMap[x$C+"#"+x$_.name]=x$_,x$h||(x$h=x$_);x$h&&(x$p.framesMap[x$C+"#"]=x$h,x$f._setFramesFromCache(x$L._actionName,!0),x$L.index=0),x$L._checkResumePlaying()}x$O&&x$O.run()}}},x$_._parseGraphicAnimation=function(x$b){return x$ob.parseAnimationData(x$b)},x$_._parseGraphicAnimationByData=function(x$b){return x$ob.parseAnimationByData(x$b)},x$Q(0,x$_,"frames",function(){return this._frames},function(x$b){(this._frames=x$b)&&(this._count=x$b.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),x$Q(0,x$_,"autoPlay",null,function(x$b){x$b?this.play():this.stop()}),x$Q(0,x$_,"source",null,function(x$b){-1<x$b.indexOf(".ani")?this.loadAnimation(x$b):-1<x$b.indexOf(".json")||-1<x$b.indexOf("als")||-1<x$b.indexOf("atlas")?this.loadAtlas(x$b):this.loadImages(x$b.split(","))}),x$Q(0,x$_,"autoAnimation",null,function(x$b){this.play(0,!0,x$b,!1)}),x$p.createFrames=function(x$b,x$_){var x$s,x$h,x$x=0,x$n=0;if("string"==typeof x$b){var x$E=x$Cb.getAtlas(x$b);if(x$E&&x$E.length)for(x$s=[],x$x=0,x$n=x$E.length;x$x<x$n;x$x++)(x$h=new x$Z.createGraphics).drawTexture(x$Cb.getRes(x$E[x$x]),0,0),x$s.push(x$h)}else if(x$b instanceof Array)for(x$s=[],x$x=0,x$n=x$b.length;x$x<x$n;x$x++)(x$h=new x$Z.createGraphics).loadImage(x$b[x$x],0,0),x$s.push(x$h);return x$_&&(x$p.framesMap[x$_]=x$s),x$s},x$p.clearCache=function(x$b){var x$_,x$s=x$p.framesMap,x$h=x$b+"#";for(x$_ in x$s)x$_!==x$b&&0!=x$_.indexOf(x$h)||delete x$p.framesMap[x$_]},x$p.framesMap={}}(x$yb),function(x$b){function x$n(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,x$n.__super.call(this),null==x$n._sortIndexFun&&(x$n._sortIndexFun=x$D.sortByKey("index",!1,!0))}x$f(x$n,"laya.display.FrameAnimation",x$b);var x$_=x$n.prototype;return x$_._setUp=function(x$b,x$_){this._labels=null,this._animationNewFrames=null,this._targetDic=x$b,this._animationData=x$_,this.interval=1e3/x$_.frameRate,x$_.parsed?(this._count=x$_.count,this._labels=x$_.labels,this._animationNewFrames=x$_.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),x$_.parsed=!0,x$_.labels=this._labels,x$_.count=this._count,x$_.animationNewFrames=this._animationNewFrames},x$_.clear=function(){x$b.prototype.clear.call(this),this._targetDic=null,this._animationData=null},x$_._displayToIndex=function(x$b){if(this._animationData){x$b<0&&(x$b=0),x$b>this._count&&(x$b=this._count);var x$_=this._animationData.nodes,x$s=0,x$h=x$_.length;for(x$s=0;x$s<x$h;x$s++)this._displayNodeToFrame(x$_[x$s],x$b)}},x$_._displayNodeToFrame=function(x$b,x$_,x$s){x$s||(x$s=this._targetDic);var x$h=x$s[x$b.target];if(x$h){var x$x,x$n,x$E,x$C=x$b.frames,x$O=x$b.keys,x$L=0,x$f=x$O.length;for(x$L=0;x$L<x$f;x$L++)x$E=(x$n=x$C[x$x=x$O[x$L]]).length>x$_?x$n[x$_]:x$n[x$n.length-1],x$h[x$x]=x$E}},x$_._calculateDatas=function(){if(this._animationData){var x$b,x$_=this._animationData.nodes,x$s=0,x$h=x$_.length;for(x$s=this._count=0;x$s<x$h;x$s++)x$b=x$_[x$s],this._calculateNodeKeyFrames(x$b);this._count+=1}},x$_._calculateNodeKeyFrames=function(x$b){var x$_,x$s,x$h=x$b.keyframes,x$x=x$b.target;for(x$_ in x$b.frames||(x$b.frames={}),x$b.keys?x$b.keys.length=0:x$b.keys=[],x$b.initValues||(x$b.initValues={}),x$h)x$s=x$h[x$_],x$b.frames[x$_]||(x$b.frames[x$_]=[]),this._targetDic&&this._targetDic[x$x]&&(x$b.initValues[x$_]=this._targetDic[x$x][x$_]),x$s.sort(x$n._sortIndexFun),x$b.keys.push(x$_),this._calculateNodePropFrames(x$s,x$b.frames[x$_],x$_,x$x)},x$_.resetToInitState=function(){if(this._targetDic&&this._animationData){var x$b,x$_,x$s=this._animationData.nodes,x$h=0,x$x=x$s.length;for(x$h=0;x$h<x$x;x$h++)if(x$_=(x$b=x$s[x$h]).initValues){var x$n,x$E=this._targetDic[x$b.target];if(x$E)for(x$n in x$_)x$E[x$n]=x$_[x$n]}}},x$_._calculateNodePropFrames=function(x$b,x$_,x$s,x$h){var x$x=0,x$n=x$b.length-1;if(0<x$n){for(x$_.length=x$b[x$n].index+1,x$x=0;x$x<x$n;x$x++)this._dealKeyFrame(x$b[x$x]),this._calculateFrameValues(x$b[x$x],x$b[x$x+1],x$_);this._dealKeyFrame(x$b[x$x])}0==x$n&&(x$_[x$b[0].index]=x$b[0].value,this._animationNewFrames&&(this._animationNewFrames[x$b[0].index]=!0))},x$_._dealKeyFrame=function(x$b){x$b.label&&""!=x$b.label&&this.addLabel(x$b.label,x$b.index)},x$_._calculateFrameValues=function(x$b,x$_,x$s){var x$h,x$x=0,x$n=x$b.index,x$E=x$_.index,x$C=x$b.value,x$O=x$_.value-x$b.value,x$L=x$E-x$n;if(x$E>this._count&&(this._count=x$E),x$b.tween)for(null==(x$h=x$u[x$b.tweenMethod])&&(x$h=x$u.linearNone),x$x=x$n;x$x<x$E;x$x++)x$s[x$x]=x$h(x$x-x$n,x$C,x$O,x$L),this._animationNewFrames&&(this._animationNewFrames[x$x]=!0);else for(x$x=x$n;x$x<x$E;x$x++)x$s[x$x]=x$C;this._animationNewFrames&&(this._animationNewFrames[x$b.index]=!0,this._animationNewFrames[x$_.index]=!0),x$s[x$_.index]=x$_.value},x$n._sortIndexFun=null,x$n}(x$yb)),x$$b=function(x$_){function x$x(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",x$x.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=x$wb.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}x$f(x$x,"laya.display.Input",x$_);var x$b=x$x.prototype;return x$b.setSelection=function(x$b,x$_){this.focus=!0,laya.display.Input.inputElement.selectionStart=x$b,laya.display.Input.inputElement.selectionEnd=x$_},x$b._onUnDisplay=function(x$b){this.focus=!1},x$b._onMouseDown=function(x$b){this.focus=!0},x$b._syncInputTransform=function(){var x$b=this.nativeInput,x$_=x$e.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),x$s=this._width-this.padding[1]-this.padding[3],x$h=this._height-this.padding[0]-this.padding[2];x$q.isConchApp?(x$b.setScale(x$_.scaleX,x$_.scaleY),x$b.setSize(x$s,x$h),x$b.setPos(x$_.x,x$_.y)):(x$x.inputContainer.style.transform=x$x.inputContainer.style.webkitTransform="scale("+x$_.scaleX+","+x$_.scaleY+") rotate("+x$o.stage.canvasDegree+"deg)",x$b.style.width=x$s+"px",x$b.style.height=x$h+"px",x$x.inputContainer.style.left=x$_.x+"px",x$x.inputContainer.style.top=x$_.y+"px")},x$b.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},x$b._setInputMethod=function(){x$x.input.parentElement&&x$x.inputContainer.removeChild(x$x.input),x$x.area.parentElement&&x$x.inputContainer.removeChild(x$x.area),x$x.inputElement=this._multiline?x$x.area:x$x.input,x$x.inputContainer.appendChild(x$x.inputElement),x$wb.RightToLeft&&(x$x.inputElement.style.direction="rtl")},x$b._focusIn=function(){laya.display.Input.isInputting=!0;var x$b=this.nativeInput;this._focus=!0;var x$_=x$b.style;x$_.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),x$b.readOnly=!this._editable,x$q.isConchApp&&(x$b.setType(this._type),x$b.setForbidEdit(!this._editable)),x$b.maxLength=this._maxChars;this.padding;if(x$b.type=this._type,x$b.value=this._content,x$b.placeholder=this._prompt,x$o.stage.off("keydown",this,this._onKeyDown),x$o.stage.on("keydown",this,this._onKeyDown),(x$o.stage.focus=this).event("focus"),x$K.onPC&&x$b.focus(),!x$K.onMiniGame){this._text;this._text=null}this.typeset(),x$b.setColor(this._originColor),x$b.setFontSize(this.fontSize),x$b.setFontFace(x$K.onIPhone&&x$wb._fontFamilyMap[this.font]||this.font),x$q.isConchApp&&x$b.setMultiAble&&x$b.setMultiAble(this._multiline),x$_.lineHeight=this.leading+this.fontSize+"px",x$_.fontStyle=this.italic?"italic":"normal",x$_.fontWeight=this.bold?"bold":"normal",x$_.textAlign=this.align,x$_.padding="0 0",this._syncInputTransform(),!x$q.isConchApp&&x$K.onPC&&x$o.timer.frameLoop(1,this,this._syncInputTransform)},x$b._setPromptColor=function(){(x$x.promptStyleDOM=x$K.getElementById("promptStyle"))||((x$x.promptStyleDOM=x$K.createElement("style")).setAttribute("id","promptStyle"),x$K.document.head.appendChild(x$x.promptStyleDOM)),x$x.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},x$b._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(x$o.superSet(x$wb,this,"text",this._content),x$o.superSet(x$wb,this,"color",this._originColor)):(x$o.superSet(x$wb,this,"text",this._prompt),x$o.superSet(x$wb,this,"color",this._promptColor)),x$o.stage.off("keydown",this,this._onKeyDown),x$o.stage.focus=null,this.event("blur"),x$q.isConchApp&&this.nativeInput.blur(),x$K.onPC&&x$o.timer.clear(this,this._syncInputTransform)},x$b._onKeyDown=function(x$b){13===x$b.keyCode&&(x$K.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},x$b.changeText=function(x$b){this._content=x$b,this._focus?(this.nativeInput.value=x$b||"",this.event("change")):x$_.prototype.changeText.call(this,x$b)},x$Q(0,x$b,"color",x$_.prototype._$get_color,function(x$b){this._focus&&this.nativeInput.setColor(x$b),x$o.superSet(x$wb,this,"color",this._content?x$b:this._promptColor),this._originColor=x$b}),x$Q(0,x$b,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(x$b){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),x$Q(0,x$b,"multiline",function(){return this._multiline},function(x$b){this._multiline=x$b,this.valign=x$b?"top":"middle"}),x$Q(0,x$b,"maxChars",function(){return this._maxChars},function(x$b){x$b<=0&&(x$b=1e5),this._maxChars=x$b}),x$Q(0,x$b,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(x$b){x$o.superSet(x$wb,this,"color",this._originColor),x$b+="",this._focus?(this.nativeInput.value=x$b||"",this.event("change")):(this._multiline||(x$b=x$b.replace(/\r?\n/g,"")),(this._content=x$b)?x$o.superSet(x$wb,this,"text",x$b):(x$o.superSet(x$wb,this,"text",this._prompt),x$o.superSet(x$wb,this,"color",this.promptColor)))}),x$Q(0,x$b,"nativeInput",function(){return this._multiline?x$x.area:x$x.input}),x$Q(0,x$b,"prompt",function(){return this._prompt},function(x$b){!this._text&&x$b&&x$o.superSet(x$wb,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?x$o.superSet(x$wb,this,"text",this._text==this._prompt?x$b:this._text):x$o.superSet(x$wb,this,"text",x$b),this._prompt=x$wb.langPacks&&x$wb.langPacks[x$b]?x$wb.langPacks[x$b]:x$b}),x$Q(0,x$b,"focus",function(){return this._focus},function(x$b){var x$_=this.nativeInput;this._focus!==x$b&&(x$b?(x$_.target?x$_.target._focusOut():this._setInputMethod(),(x$_.target=this)._focusIn()):(x$_.target=null,this._focusOut(),x$K.document.body.scrollTop=0,x$_.blur(),x$q.isConchApp?x$_.setPos(-1e4,-1e4):x$x.inputContainer.contains(x$_)&&x$x.inputContainer.removeChild(x$_)))}),x$Q(0,x$b,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(x$b){x$b?(-1<(x$b="[^"+x$b+"]").indexOf("^^")&&(x$b=x$b.replace("^^","")),this._restrictPattern=new RegExp(x$b,"g")):this._restrictPattern=null}),x$Q(0,x$b,"editable",function(){return this._editable},function(x$b){this._editable=x$b,x$q.isConchApp&&x$x.input.setForbidEdit(!x$b)}),x$Q(0,x$b,"promptColor",function(){return this._promptColor},function(x$b){this._promptColor=x$b,this._content||x$o.superSet(x$wb,this,"color",x$b)}),x$Q(0,x$b,"type",function(){return this._type},function(x$b){this._getCSSStyle().password="password"==x$b,this._type=x$b,x$q.isConchApp&&this.nativeInput.setType(x$b)}),x$Q(0,x$b,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(x$b){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),x$Q(0,x$b,"asPassword",function(){return this._getCSSStyle().password},function(x$b){this._getCSSStyle().password=x$b,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),x$x.__init__=function(){x$x._createInputElement(),x$K.onMobile&&x$q.canvas.addEventListener(x$x.IOS_IFRAME?x$K.onMiniGame?"touchend":"click":"touchend",x$x._popupInputMethod)},x$x._popupInputMethod=function(x$b){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},x$x._createInputElement=function(){x$x._initInput(x$x.area=x$K.createElement("textarea")),x$x._initInput(x$x.input=x$K.createElement("input")),(x$x.inputContainer=x$K.createElement("div")).style.position="absolute",x$x.inputContainer.style.zIndex=1e5,x$K.container.appendChild(x$x.inputContainer),x$x.inputContainer.setPos=function(x$b,x$_){x$x.inputContainer.style.left=x$b+"px",x$x.inputContainer.style.top=x$_+"px"}},x$x._initInput=function(x$_){var x$b=x$_.style;x$b.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",x$b.resize="none",x$b.backgroundColor="transparent",x$b.border="none",x$b.outline="none",x$b.zIndex=1,x$_.addEventListener("input",x$x._processInputting),x$_.addEventListener("mousemove",x$x._stopEvent),x$_.addEventListener("mousedown",x$x._stopEvent),x$_.addEventListener("touchmove",x$x._stopEvent),x$_.setFontFace=function(x$b){x$_.style.fontFamily=x$b},x$q.isConchApp||(x$_.setColor=function(x$b){x$_.style.color=x$b},x$_.setFontSize=function(x$b){x$_.style.fontSize=x$b+"px"})},x$x._processInputting=function(x$b){var x$_=laya.display.Input.inputElement.target;if(x$_){var x$s=laya.display.Input.inputElement.value;x$_._restrictPattern&&(x$s=x$s.replace(/\u2006|\x27/g,""),x$_._restrictPattern.test(x$s)&&(x$s=x$s.replace(x$_._restrictPattern,""),laya.display.Input.inputElement.value=x$s)),x$_._text=x$s,x$_.event("input")}},x$x._stopEvent=function(x$b){"touchmove"==x$b.type&&x$b.preventDefault(),x$b.stopPropagation&&x$b.stopPropagation()},x$x.TYPE_TEXT="text",x$x.TYPE_PASSWORD="password",x$x.TYPE_EMAIL="email",x$x.TYPE_URL="url",x$x.TYPE_NUMBER="number",x$x.TYPE_RANGE="range",x$x.TYPE_DATE="date",x$x.TYPE_MONTH="month",x$x.TYPE_WEEK="week",x$x.TYPE_TIME="time",x$x.TYPE_DATE_TIME="datetime",x$x.TYPE_DATE_TIME_LOCAL="datetime-local",x$x.TYPE_SEARCH="search",x$x.input=null,x$x.area=null,x$x.inputElement=null,x$x.inputContainer=null,x$x.confirmButton=null,x$x.promptStyleDOM=null,x$x.inputHeight=45,x$x.isInputting=!1,x$x.stageMatrix=null,x$O(x$x,["IOS_IFRAME",function(){return this.IOS_IFRAME=x$K.onIOS&&x$K.window.top!=x$K.window.self}]),x$x}(x$wb),x$Db=function(x$b){function x$s(x$b,x$_){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,x$s.__super.call(this),x$b&&this._init_(x$b,x$_)}x$f(x$s,"laya.resource.HTMLImage",x$Rb);var x$_=x$s.prototype;return x$_._init_=function(x$b,x$_){this._src=x$b,this._source=new x$K.window.Image,x$_&&(x$_.onload&&(this.onload=x$_.onload),x$_.onerror&&(this.onerror=x$_.onerror),x$_.onCreate&&x$_.onCreate(this)),0!=x$b.indexOf("data:image")&&(this._source.crossOrigin=""),x$b&&(this._source.src=x$b)},x$_.recreateResource=function(){var x$b=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var x$_=this;this._source=new x$K.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(x$_._needReleaseAgain)return x$_._needReleaseAgain=!1,x$_._source.onload=null,void(x$_._source=null);x$_._source.onload=null,x$_.memorySize=x$b._w*x$b._h*4,x$_._recreateLock=!1,x$_.completeCreate()},this._source.src=this._src}},x$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},x$_.onresize=function(){this._w=this._source.width,this._h=this._source.height},x$Q(0,x$_,"onload",null,function(x$b){var x$_=this;this._onload=x$b,this._source&&(this._source.onload=null!=this._onload?function(){x$_.onresize(),x$_._onload()}:null)}),x$Q(0,x$_,"onerror",null,function(x$b){var x$_=this;this._onerror=x$b,this._source&&(this._source.onerror=null!=this._onerror?function(){x$_._onerror()}:null)}),x$Q(0,x$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(x$b){this._enableMerageInAtlas=x$b,x$q.isConchApp&&this._source&&(this._source.enableMerageInAtlas=x$b)}),x$s.create=function(x$b,x$_){return new x$s(x$b,x$_)},x$s}(),x$ob=(function(x$n){function x$b(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,x$b.__super.call(this)}x$f(x$b,"laya.display.EffectAnimation",x$n);var x$_=x$b.prototype;x$_._onOtherBegin=function(x$b){x$b!=this&&this.stop()},x$_.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},x$_._onPlayAction=function(){this.play(0,!1)},x$_.play=function(x$b,x$_,x$s,x$h){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=!0),void 0===x$s&&(x$s=""),void 0===x$h&&(x$h=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,x$b,x$_,x$s,x$h))},x$_._recordInitData=function(){if(this._aniKeys){var x$b,x$_,x$s=0;for(x$b=this._aniKeys.length,x$s=0;x$s<x$b;x$s++)x$_=this._aniKeys[x$s],this._initData[x$_]=this._target[x$_]}},x$_._displayToIndex=function(x$b){if(this._animationData){x$b<0&&(x$b=0),x$b>this._count&&(x$b=this._count);var x$_=this._animationData.nodes,x$s=0,x$h=x$_.length;for(x$h=1<x$h?1:x$h,x$s=0;x$s<x$h;x$s++)this._displayNodeToFrame(x$_[x$s],x$b)}},x$_._displayNodeToFrame=function(x$b,x$_,x$s){if(this._target){var x$h;x$h=this._target;var x$x,x$n,x$E,x$C,x$O=x$b.frames,x$L=x$b.keys,x$f=0,x$p=x$L.length;x$C=x$b.secondFrames;var x$P,x$V,x$Q,x$y,x$w=0;for(x$f=0;x$f<x$p;x$f++)x$n=x$O[x$x=x$L[x$f]],x$E=-1==(x$w=x$C[x$x])?this._initData[x$x]:x$_<x$w?(x$Q=(x$V=x$b.keyframes[x$x])[0]).tween?(null==(x$P=x$u[x$Q.tweenMethod])&&(x$P=x$u.linearNone),x$y=x$V[1],x$P(x$_,this._initData[x$x],x$y.value-this._initData[x$x],x$y.index)):this._initData[x$x]:x$n.length>x$_?x$n[x$_]:x$n[x$n.length-1],x$h[x$x]=x$E}},x$_._calculateNodeKeyFrames=function(x$b){x$n.prototype._calculateNodeKeyFrames.call(this,x$b);var x$_,x$s,x$h,x$x=x$b.keyframes;x$b.target;for(x$_ in x$h={},x$b.secondFrames=x$h,x$x)(x$s=x$x[x$_]).length<=1?x$h[x$_]=-1:x$h[x$_]=x$s[1].index},x$Q(0,x$_,"target",function(){return this._target},function(x$b){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=x$b,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),x$Q(0,x$_,"playEvent",null,function(x$b){(this._playEvents=x$b)&&this.addEvent()}),x$Q(0,x$_,"effectData",null,function(x$b){var x$_;x$b&&((x$_=x$b.animations)&&x$_[0]&&(this._setUp({},x$_[0]),x$_[0].nodes&&x$_[0].nodes[0]&&(this._aniKeys=x$_[0].nodes[0].keys)))}),x$Q(0,x$_,"effectClass",null,function(x$b){var x$_,x$s;(this._effectClass=x$g.getClass(x$b),this._effectClass)&&((x$_=this._effectClass.uiView)&&(x$s=x$_.animations)&&x$s[0]&&(this._setUp({},x$s[0]),x$s[0].nodes&&x$s[0].nodes[0]&&(this._aniKeys=x$s[0].nodes[0].keys)))}),x$b.EffectAnimationBegin="effectanimationbegin"}(x$cb),function(x$_){var x$B;function x$S(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,x$S.__super.call(this)}x$f(x$S,"laya.utils.GraphicAnimation",x$_);var x$b=x$S.prototype;return x$b._parseNodeList=function(x$b){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[x$b.compId]=x$b.props,x$b.compId&&this._nodeList.push(x$b.compId);var x$_=x$b.child;if(x$_){var x$s=0,x$h=x$_.length;for(x$s=0;x$s<x$h;x$s++)this._parseNodeList(x$_[x$s])}},x$b._calGraphicData=function(x$b){var x$_;if(this._setUp(null,x$b),this._createGraphicData(),this._nodeIDAniDic)for(x$_ in this._nodeIDAniDic)this._nodeIDAniDic[x$_]=null},x$b._createGraphicData=function(){var x$b,x$_=[],x$s=0,x$h=this.count,x$x=this._animationNewFrames;for(x$x||(x$x=[]),x$s=0;x$s<x$h;x$s++)!x$x[x$s]&&x$b||(x$b=this._createFrameGraphic(x$s)),x$_.push(x$b);this._gList=x$_},x$b._createFrameGraphic=function(x$b){var x$_=x$Z.createGraphics();return x$S._rootMatrix||(x$S._rootMatrix=new x$J),this._updateNodeGraphic(this._rootNode,x$b,x$S._rootMatrix,x$_),x$_},x$b._updateNodeGraphic=function(x$b,x$_,x$s,x$h,x$x){var x$n;void 0===x$x&&(x$x=1);var x$E,x$C,x$O,x$L=(x$n=this._nodeGDic[x$b.compId]=this._getNodeGraphicData(x$b.compId,x$_,this._nodeGDic[x$b.compId])).alpha*x$x;if(!(x$L<.01)&&(x$n.resultTransform||(x$n.resultTransform=x$J.create()),x$E=x$n.resultTransform,x$J.mul(x$n.transform,x$s,x$E),x$n.skin&&(x$C=this._getTextureByUrl(x$n.skin))&&(x$E._checkTransform()?(x$h.drawTexture(x$C,0,0,x$n.width,x$n.height,x$E,x$L),x$n.resultTransform=null):x$h.drawTexture(x$C,x$E.tx,x$E.ty,x$n.width,x$n.height,null,x$L)),x$O=x$b.child)){var x$f,x$p=0;for(x$f=x$O.length,x$p=0;x$p<x$f;x$p++)this._updateNodeGraphic(x$O[x$p],x$_,x$E,x$h,x$L)}},x$b._updateNoChilds=function(x$b,x$_){if(x$b.skin){var x$s=this._getTextureByUrl(x$b.skin);if(x$s){var x$h=x$b.transform;x$h._checkTransform();!x$h.bTransform?x$_.drawTexture(x$s,x$h.tx,x$h.ty,x$b.width,x$b.height,null,x$b.alpha):x$_.drawTexture(x$s,0,0,x$b.width,x$b.height,x$h.clone(),x$b.alpha)}}},x$b._updateNodeGraphic2=function(x$b,x$_,x$s){var x$h;if(x$h=this._nodeGDic[x$b.compId]=this._getNodeGraphicData(x$b.compId,x$_,this._nodeGDic[x$b.compId]),x$b.child){var x$x=x$h.transform;x$x._checkTransform();var x$n,x$E;x$E=(x$n=!x$x.bTransform)&&(0!=x$x.tx||0!=x$x.ty);var x$C,x$O,x$L;if((x$C=x$x.bTransform||1!=x$h.alpha)&&x$s.save(),1!=x$h.alpha&&x$s.alpha(x$h.alpha),x$n?x$E&&x$s.translate(x$x.tx,x$x.ty):x$s.transform(x$x.clone()),x$O=x$b.child,x$h.skin&&(x$L=this._getTextureByUrl(x$h.skin))&&x$s.drawTexture(x$L,0,0,x$h.width,x$h.height),x$O){var x$f,x$p=0;for(x$f=x$O.length,x$p=0;x$p<x$f;x$p++)this._updateNodeGraphic2(x$O[x$p],x$_,x$s)}x$C?x$s.restore():x$n?x$E&&x$s.translate(-x$x.tx,-x$x.ty):x$s.transform(x$x.clone().invert())}else this._updateNoChilds(x$h,x$s)},x$b._calculateNodeKeyFrames=function(x$b){x$_.prototype._calculateNodeKeyFrames.call(this,x$b),this._nodeIDAniDic[x$b.target]=x$b},x$b.getNodeDataByID=function(x$b){return this._nodeIDAniDic[x$b]},x$b._getParams=function(x$b,x$_,x$s,x$h){var x$x=x$S._temParam;x$x.length=x$_.length;var x$n=0,x$E=x$_.length;for(x$n=0;x$n<x$E;x$n++)x$x[x$n]=this._getObjVar(x$b,x$_[x$n][0],x$s,x$_[x$n][1],x$h);return x$x},x$b._getObjVar=function(x$b,x$_,x$s,x$h,x$x){if(x$b.hasOwnProperty(x$_)){var x$n=x$b[x$_];if(x$s>=x$n.length&&(x$s=x$n.length-1),null!=x$b[x$_][x$s])return x$b[x$_][x$s]}return x$x.hasOwnProperty(x$_)?x$x[x$_]:x$h},x$b._getNodeGraphicData=function(x$b,x$_,x$s){x$s||(x$s=x$B.create()),x$s.transform?x$s.transform.identity():x$s.transform=x$J.create();var x$h=this.getNodeDataByID(x$b);if(!x$h)return x$s;var x$x,x$n,x$E=x$h.frames,x$C=this._getParams(x$E,x$S._drawTextureCmd,x$_,this._nodeDefaultProps[x$b]),x$O=x$C[0],x$L=NaN,x$f=NaN,x$p=x$C[5],x$P=x$C[6],x$V=x$C[13],x$Q=x$C[14],x$y=x$C[7],x$w=x$C[8],x$i=x$C[9],x$R=x$C[11],x$t=x$C[12];x$L=x$C[3],x$f=x$C[4],0!=x$L&&0!=x$f||(x$O=null),-1==x$L&&(x$L=0),-1==x$f&&(x$f=0),x$s.skin=x$O,x$s.width=x$L,x$s.height=x$f,x$O&&((x$x=this._getTextureByUrl(x$O))?(x$L||(x$L=x$x.sourceWidth),x$f||(x$f=x$x.sourceHeight)):console.warn("lost skin:",x$O,",you may load pics first")),x$s.alpha=x$C[10],x$n=x$s.transform,0!=x$V&&(x$p=x$V*x$L),0!=x$Q&&(x$P=x$Q*x$f),0==x$p&&0==x$P||x$n.translate(-x$p,-x$P);var x$c=null;if(x$i||1!==x$y||1!==x$w||x$R||x$t){(x$c=x$S._tempMt).identity(),x$c.bTransform=!0;var x$$=.0174532922222222*(x$i-x$R),x$D=.0174532922222222*(x$i+x$t),x$o=Math.cos(x$D),x$M=Math.sin(x$D),x$r=Math.sin(x$$),x$k=Math.cos(x$$);x$c.a=x$y*x$o,x$c.b=x$y*x$M,x$c.c=-x$w*x$r,x$c.d=x$w*x$k,x$c.tx=x$c.ty=0}return x$c&&(x$n=x$J.mul(x$n,x$c,x$n)),x$n.translate(x$C[1],x$C[2]),x$s},x$b._getTextureByUrl=function(x$b){return x$Cb.getRes(x$b)},x$b.setAniData=function(x$b,x$_){if(x$b.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=x$b,this._parseNodeList(x$b);var x$s,x$h={},x$x=[],x$n=x$b.animations,x$E=0,x$C=x$n.length;for(x$E=0;x$E<x$C;x$E++)if(x$s=x$n[x$E],this._labels=null,(!x$_||x$_==x$s.name)&&x$s){try{this._calGraphicData(x$s)}catch(x$b){console.warn("parse animation fail:"+x$s.name+",empty animation created"),this._gList=[]}var x$O={};x$O.interval=1e3/x$s.frameRate,x$O.frames=this._gList,x$O.labels=this._labels,x$O.name=x$s.name,x$x.push(x$O),x$h[x$s.name]=x$O}this.animationList=x$x,this.animationDic=x$h}x$S._temParam.length=0},x$b.parseByData=function(x$b){var x$_,x$s;x$_=x$b.nodeRoot,x$s=x$b.aniO,delete x$b.nodeRoot,delete x$b.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=x$_,this._parseNodeList(x$_),this._labels=null;try{this._calGraphicData(x$s)}catch(x$b){console.warn("parse animation fail:"+x$s.name+",empty animation created"),this._gList=[]}var x$h=x$b;return x$h.interval=1e3/x$s.frameRate,x$h.frames=this._gList,x$h.labels=this._labels,x$h.name=x$s.name,x$h},x$b.setUpAniData=function(x$b){if(x$b.animations){var x$_,x$s={},x$h=[],x$x=x$b.animations,x$n=0,x$E=x$x.length;for(x$n=0;x$n<x$E;x$n++)if(x$_=x$x[x$n]){var x$C={};x$C.name=x$_.name,x$C.aniO=x$_,x$C.nodeRoot=x$b,x$h.push(x$C),x$s[x$_.name]=x$C}this.animationList=x$h,this.animationDic=x$s}},x$b._clear=function(){var x$b,x$_;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(x$b in this._nodeGDic)(x$_=this._nodeGDic[x$b])&&x$_.recover();this._nodeGDic=null},x$S.parseAnimationByData=function(x$b){var x$_;return x$S._I||(x$S._I=new x$S),x$_=x$S._I.parseByData(x$b),x$S._I._clear(),x$_},x$S.parseAnimationData=function(x$b){var x$_;return x$S._I||(x$S._I=new x$S),x$S._I.setUpAniData(x$b),(x$_={}).animationList=x$S._I.animationList,x$_.animationDic=x$S._I.animationDic,x$S._I._clear(),x$_},x$S._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],x$S._temParam=[],x$S._I=null,x$S._rootMatrix=null,x$O(x$S,["_tempMt",function(){return this._tempMt=new x$J}]),x$S.__init$=function(){x$B=function(){function x$b(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return x$f(x$b,""),x$b.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),x$N.recover("GraphicNode",this)},x$b.create=function(){return x$N.getItemByClass("GraphicNode",x$b)},x$b}()},x$S}(x$cb));x$o.__init([x$L,x$Ob,x$q,x$K,x$Y,x$k,x$b,x$ob])}(window,document,Laya),function(x$b,x$_,x$s){x$s.un,x$s.uns,x$s.static;var x$h=x$s.class;x$s.getset,x$s.__newvec;new(function(){function x$b(){}return x$h(x$b,"LayaMain"),x$b}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}}),function(x$b,x$_,x$D){x$D.un,x$D.uns;var x$E=x$D.static,x$P=x$D.class,x$h=x$D.getset,x$n=x$D.__newvec,x$f=laya.maths.Arith,x$p=laya.maths.Bezier,x$s=laya.resource.Bitmap,x$V=laya.utils.Browser,x$O=laya.utils.Byte,x$Q=laya.utils.Color,x$o=(laya.filters.ColorFilter,x$D.Config),x$x=laya.resource.Context,x$M=(laya.events.Event,laya.filters.Filter),x$C=laya.display.Graphics,x$L=laya.resource.HTMLCanvas,x$y=(laya.utils.HTMLChar,laya.resource.HTMLImage),x$w=laya.resource.HTMLSubImage,x$r=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),x$k=laya.maths.Point,x$B=laya.maths.Rectangle,x$i=laya.renders.Render,x$R=(laya.renders.RenderContext,laya.renders.RenderSprite),x$t=laya.resource.Resource,x$c=laya.resource.ResourceManager,x$$=laya.utils.RunDriver,x$S=laya.display.Sprite,x$Z=laya.display.Stage,x$J=laya.utils.Stat,x$W=laya.utils.StringKey,x$T=(laya.display.css.Style,laya.system.System),x$q=laya.display.Text,x$U=laya.resource.Texture,x$G=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),x$z=laya.utils.VectorGraphManager;laya.utils.WordText;x$D.interface("laya.webgl.shapes.IShape"),x$D.interface("laya.webgl.submit.ISubmit"),x$D.interface("laya.webgl.text.ICharSegment"),x$D.interface("laya.webgl.canvas.save.ISaveData"),x$D.interface("laya.webgl.resource.IMergeAtlasBitmap"),x$D.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var x$a=function(){function x$b(){}x$P(x$b,"laya.filters.webgl.FilterActionGL");var x$_=x$b.prototype;return x$D.imps(x$_,{"laya.filters.IFilterActionGL":!0}),x$_.setValue=function(x$b){},x$_.setValueMix=function(x$b){},x$_.apply3d=function(x$b,x$_,x$s,x$h,x$x){return null},x$_.apply=function(x$b){return null},x$h(0,x$_,"typeMix",function(){return 0}),x$b}(),x$K=function(){function x$b(){}return x$P(x$b,"laya.webgl.shader.ShaderValue"),x$b}(),x$d=function(){var x$h,x$x;function x$b(x$b,x$_,x$s){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new x$x,void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),this._cells=null,this._rowInfo=null,this._init(x$b,x$_),this._atlasID=x$s}x$P(x$b,"laya.webgl.atlas.AtlasGrid");var x$_=x$b.prototype;return x$_.getAltasID=function(){return this._atlasID},x$_.setAltasID=function(x$b){0<=x$b&&(this._atlasID=x$b)},x$_.addTex=function(x$b,x$_,x$s){var x$h=this._get(x$_,x$s);return 0==x$h.ret||(this._fill(x$h.x,x$h.y,x$_,x$s,x$b),this._texCount++),x$h},x$_._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},x$_._init=function(x$b,x$_){if(this._width=x$b,this._height=x$_,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=x$n(this._height);for(var x$s=0;x$s<this._height;x$s++)this._rowInfo[x$s]=new x$h;return this._clear(),!0},x$_._get=function(x$b,x$_){var x$s=new x$g;if(x$b>=this._failSize.width&&x$_>=this._failSize.height)return x$s;for(var x$h=-1,x$x=-1,x$n=this._width,x$E=this._height,x$C=this._cells,x$O=0;x$O<x$E;x$O++)if(!(this._rowInfo[x$O].spaceCount<x$b))for(var x$L=0;x$L<x$n;){var x$f=3*(x$O*x$n+x$L);if(0!=x$C[x$f]||x$C[1+x$f]<x$b||x$C[2+x$f]<x$_)x$L+=x$C[1+x$f];else{x$h=x$L,x$x=x$O;for(var x$p=0;x$p<x$b;x$p++)if(x$C[3*x$p+x$f+2]<x$_){x$h=-1;break}if(!(x$h<0))return x$s.ret=!0,x$s.x=x$h,x$s.y=x$x,x$s;x$L+=x$C[1+x$f]}}return x$s},x$_._fill=function(x$b,x$_,x$s,x$h,x$x){var x$n=this._width,x$E=this._height;this._check(x$b+x$s<=x$n&&x$_+x$h<=x$E);for(var x$C=x$_;x$C<x$h+x$_;++x$C){this._check(this._rowInfo[x$C].spaceCount>=x$s),this._rowInfo[x$C].spaceCount-=x$s;for(var x$O=0;x$O<x$s;x$O++){var x$L=3*(x$b+x$C*x$n+x$O);this._check(0==this._cells[x$L]),this._cells[x$L]=x$x,this._cells[1+x$L]=x$s,this._cells[2+x$L]=x$h}}if(0<x$b)for(x$C=0;x$C<x$h;++x$C){var x$f=0;for(x$O=x$b-1;0<=x$O&&0==this._cells[3*((x$_+x$C)*x$n+x$O)];--x$O,++x$f);for(x$O=x$f;0<x$O;--x$O)this._cells[3*((x$_+x$C)*x$n+x$b-x$O)+1]=x$O,this._check(0<x$O)}if(0<x$_)for(x$O=x$b;x$O<x$b+x$s;++x$O){for(x$f=0,x$C=x$_-1;0<=x$C&&0==this._cells[3*(x$O+x$C*x$n)];--x$C,x$f++);for(x$C=x$f;0<x$C;--x$C)this._cells[3*(x$O+(x$_-x$C)*x$n)+2]=x$C,this._check(0<x$C)}},x$_._check=function(x$b){0==x$b&&console.log("xtexMerger 错误啦")},x$_._clear=function(){for(var x$b=this._texCount=0;x$b<this._height;x$b++)this._rowInfo[x$b].spaceCount=this._width;for(var x$_=0;x$_<this._height;x$_++)for(var x$s=0;x$s<this._width;x$s++){var x$h=3*(x$_*this._width+x$s);this._cells[x$h]=0,this._cells[1+x$h]=this._width-x$s,this._cells[2+x$h]=this._width-x$_}this._failSize.width=this._width+1,this._failSize.height=this._height+1},x$b.__init$=function(){x$h=function(){function x$b(){this.spaceCount=0}return x$P(x$b,""),x$b}(),x$x=function(){function x$b(){this.width=0,this.height=0}return x$P(x$b,""),x$b}()},x$b}(),x$I=function(){function x$i(x$b,x$_,x$s,x$h){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=x$b,this._height=x$_,this._gridSize=x$s,this._maxAtlaserCount=x$h,this._gridNumX=x$b/x$s,this._gridNumY=x$_/x$s,this._curAtlasIndex=0,this._atlaserArray=[]}x$P(x$i,"laya.webgl.atlas.AtlasResourceManager");var x$b=x$i.prototype;return x$b.setAtlasParam=function(x$b,x$_,x$s,x$h){if(1==this._setAtlasParam)return x$i._sid_=0,this._width=x$b,this._height=x$_,this._gridSize=x$s,this._maxAtlaserCount=x$h,this._gridNumX=x$b/x$s,this._gridNumY=x$_/x$s,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},x$b.pushData=function(x$b){var x$_,x$s=x$b.bitmap,x$h=-1,x$x=null,x$n=0,x$E=0;for(x$n=0,x$_=this._atlaserArray.length;x$n<x$_&&(x$E=(this._curAtlasIndex+x$n)%x$_,-1==(x$h=(x$x=this._atlaserArray[x$E]).findBitmapIsExist(x$s)));x$n++);if(-1!=x$h){var x$C=x$x.InAtlasWebGLImagesOffsetValue[x$h];return x$Q=x$C[0],x$y=x$C[1],x$x.addToAtlas(x$b,x$Q,x$y),!0}this._setAtlasParam=!1;for(var x$O=Math.ceil((x$b.bitmap.width+2)/this._gridSize),x$L=Math.ceil((x$b.bitmap.height+2)/this._gridSize),x$f=!1,x$p=0;x$p<2;x$p++){var x$P=this._maxAtlaserCount;for(x$n=0;x$n<x$P;x$n++){x$E=(this._curAtlasIndex+x$n)%x$P,this._atlaserArray.length-1>=x$E||this._atlaserArray.push(new x$Bb(this._gridNumX,this._gridNumY,this._width,this._height,x$i._sid_++));var x$V=this._atlaserArray[x$E],x$Q=0,x$y=0,x$w=x$V.addTex(1,x$O,x$L);if(x$w.ret){x$Q=x$w.x*this._gridSize+1,x$y=x$w.y*this._gridSize+1,x$s.lock=!0,x$V.addToAtlasTexture(x$s,x$Q,x$y),x$V.addToAtlas(x$b,x$Q,x$y),x$f=!0,this._curAtlasIndex=x$E;break}}if(x$f)break;this._atlaserArray.push(new x$Bb(this._gridNumX,this._gridNumY,this._width,this._height,x$i._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return x$f||console.log(">>>AtlasManager pushData error"),x$f},x$b.addToAtlas=function(x$b){laya.webgl.atlas.AtlasResourceManager.instance.pushData(x$b)},x$b.garbageCollection=function(){if(!0===this._needGC){for(var x$b=this._atlaserArray.length-this._maxAtlaserCount,x$_=0;x$_<x$b;x$_++)this._atlaserArray[x$_].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+x$b),this._atlaserArray.splice(0,x$b),this._needGC=!1}return!0},x$b.freeAll=function(){for(var x$b=0,x$_=this._atlaserArray.length;x$b<x$_;x$b++)this._atlaserArray[x$b].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},x$b.getAtlaserCount=function(){return this._atlaserArray.length},x$b.getAtlaserByIndex=function(x$b){return this._atlaserArray[x$b]},x$h(1,x$i,"instance",function(){return x$i._Instance||(x$i._Instance=new x$i(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),x$i._Instance}),x$h(1,x$i,"enabled",function(){return x$o.atlasEnable}),x$h(1,x$i,"atlasLimitWidth",function(){return x$i._atlasLimitWidth},function(x$b){x$i._atlasLimitWidth=x$b}),x$h(1,x$i,"atlasLimitHeight",function(){return x$i._atlasLimitHeight},function(x$b){x$i._atlasLimitHeight=x$b}),x$i._enable=function(){x$o.atlasEnable=!0},x$i._disable=function(){x$o.atlasEnable=!1},x$i.__init__=function(){x$i.atlasTextureWidth=2048,x$i.atlasTextureHeight=2048,x$i.maxTextureCount=6,x$i.atlasLimitWidth=512,x$i.atlasLimitHeight=512},x$i._atlasLimitWidth=0,x$i._atlasLimitHeight=0,x$i.gridSize=16,x$i.atlasTextureWidth=0,x$i.atlasTextureHeight=0,x$i.maxTextureCount=0,x$i._atlasRestore=0,x$i.BOARDER_TYPE_NO=0,x$i.BOARDER_TYPE_RIGHT=1,x$i.BOARDER_TYPE_LEFT=2,x$i.BOARDER_TYPE_BOTTOM=4,x$i.BOARDER_TYPE_TOP=8,x$i.BOARDER_TYPE_ALL=15,x$i._sid_=0,x$i._Instance=null,x$i}(),x$g=function(){function x$b(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return x$P(x$b,"laya.webgl.atlas.MergeFillInfo"),x$b}(),x$F=function(){function x$_(){}return x$P(x$_,"laya.webgl.canvas.BlendMode"),x$_._init_=function(x$b){x$_.fns=[x$_.BlendNormal,x$_.BlendAdd,x$_.BlendMultiply,x$_.BlendScreen,x$_.BlendOverlay,x$_.BlendLight,x$_.BlendMask,x$_.BlendDestinationOut],x$_.targetFns=[x$_.BlendNormalTarget,x$_.BlendAddTarget,x$_.BlendMultiplyTarget,x$_.BlendScreenTarget,x$_.BlendOverlayTarget,x$_.BlendLightTarget,x$_.BlendMask,x$_.BlendDestinationOut]},x$_.BlendNormal=function(x$b){x$b.blendFunc(1,771)},x$_.BlendAdd=function(x$b){x$b.blendFunc(1,772)},x$_.BlendMultiply=function(x$b){x$b.blendFunc(774,771)},x$_.BlendScreen=function(x$b){x$b.blendFunc(1,1)},x$_.BlendOverlay=function(x$b){x$b.blendFunc(1,769)},x$_.BlendLight=function(x$b){x$b.blendFunc(1,1)},x$_.BlendNormalTarget=function(x$b){x$b.blendFunc(1,771)},x$_.BlendAddTarget=function(x$b){x$b.blendFunc(1,772)},x$_.BlendMultiplyTarget=function(x$b){x$b.blendFunc(774,771)},x$_.BlendScreenTarget=function(x$b){x$b.blendFunc(1,1)},x$_.BlendOverlayTarget=function(x$b){x$b.blendFunc(1,769)},x$_.BlendLightTarget=function(x$b){x$b.blendFunc(1,1)},x$_.BlendMask=function(x$b){x$b.blendFunc(0,770)},x$_.BlendDestinationOut=function(x$b){x$b.blendFunc(0,0)},x$_.activeBlendFunction=null,x$_.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],x$_.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},x$_.NORMAL="normal",x$_.ADD="add",x$_.MULTIPLY="multiply",x$_.SCREEN="screen",x$_.LIGHT="light",x$_.OVERLAY="overlay",x$_.DESTINATIONOUT="destination-out",x$_.fns=[],x$_.targetFns=[],x$_}(),x$A=function(){function x$s(x$b){this._color=x$Q.create("black"),this.setValue(x$b)}x$P(x$s,"laya.webgl.canvas.DrawStyle");var x$b=x$s.prototype;return x$b.setValue=function(x$b){if(x$b){if("string"==typeof x$b)return void(this._color=x$Q.create(x$b));if(x$b instanceof laya.utils.Color)return void(this._color=x$b)}},x$b.reset=function(){this._color=x$Q.create("black")},x$b.equal=function(x$b){return"string"==typeof x$b?this._color.strColor===x$b:x$b instanceof laya.utils.Color&&this._color.numColor===x$b.numColor},x$b.toColorStr=function(){return this._color.strColor},x$s.create=function(x$b){var x$_;if(x$b&&("string"==typeof x$b?x$_=x$Q.create(x$b):x$b instanceof laya.utils.Color&&(x$_=x$b),x$_))return x$_._drawStyle||(x$_._drawStyle=new x$s(x$b));return laya.webgl.canvas.DrawStyle.DEFAULT},x$E(x$s,["DEFAULT",function(){return this.DEFAULT=new x$s("#000000")}]),x$s}(),x$u=function(){function x$b(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];x$cb.mainContext;this.ib=x$Hb.create(35048),this.vb=x$jb.create(5)}x$P(x$b,"laya.webgl.canvas.Path");var x$_=x$b.prototype;return x$_.addPoint=function(x$b,x$_){this.tempArray.push(x$b,x$_)},x$_.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},x$_.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},x$_.polygon=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E;return this.geomatrys.push(this._curGeomatry=x$E=new x$Wb(x$b,x$_,x$s,x$h,x$x,x$n)),x$h||(x$E.fill=!1),null==x$n&&(x$E.borderWidth=0),x$E},x$_.setGeomtry=function(x$b){this.geomatrys.push(this._curGeomatry=x$b)},x$_.drawLine=function(x$b,x$_,x$s,x$h,x$x){var x$n;return this.closePath?this.geomatrys.push(this._curGeomatry=x$n=new x$Jb(x$b,x$_,x$s,x$h,x$x)):this.geomatrys.push(this._curGeomatry=x$n=new x$Zb(x$b,x$_,x$s,x$h,x$x)),x$n.fill=!1,x$n},x$_.update=function(){var x$b=this.ib._byteLength,x$_=this.geomatrys.length;this.offset=x$b;for(var x$s=this.geoStart;x$s<x$_;x$s++)this.geomatrys[x$s].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=x$_,this.count=(this.ib._byteLength-x$b)/x$yb.BYTES_PIDX},x$_.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},x$_.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},x$b}(),x$l=function(){function x$C(){}x$P(x$C,"laya.webgl.canvas.save.SaveBase");var x$b=x$C.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!1},x$b.restore=function(x$b){this._dataObj[this._valueName]=this._value,(x$C._cache[x$C._cache._length++]=this)._newSubmit&&(x$b._curSubmit=x$nb.RENDERBASE,x$b._renderKey=0)},x$C._createArray=function(){var x$b=[];return x$b._length=0,x$b},x$C._init=function(){var x$b=x$C._namemap={};return x$b[1]="ALPHA",x$b[2]="fillStyle",x$b[8]="font",x$b[256]="lineWidth",x$b[512]="strokeStyle",x$b[8192]="_mergeID",x$b[1024]=x$b[2048]=x$b[4096]=[],x$b[16384]="textBaseline",x$b[32768]="textAlign",x$b[65536]="_nBlendType",x$b[1048576]="shader",x$b[2097152]="filters",x$b},x$C.save=function(x$b,x$_,x$s,x$h){if((x$b._saveMark._saveuse&x$_)!==x$_){x$b._saveMark._saveuse|=x$_;var x$x=x$C._cache,x$n=0<x$x._length?x$x[--x$x._length]:new x$C;x$n._value=x$s[x$n._valueName=x$C._namemap[x$_]],x$n._dataObj=x$s,x$n._newSubmit=x$h;var x$E=x$b._save;x$E[x$E._length++]=x$n}},x$C._cache=laya.webgl.canvas.save.SaveBase._createArray(),x$C._namemap=x$C._init(),x$C}(),x$N=function(){function x$n(){this._clipRect=new x$B}x$P(x$n,"laya.webgl.canvas.save.SaveClipRect");var x$b=x$n.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!1},x$b.restore=function(x$b){x$b._clipRect=this._clipSaveRect,(x$n._cache[x$n._cache._length++]=this)._submitScissor.submitLength=x$b._submits._length-this._submitScissor.submitIndex,x$b._curSubmit=x$nb.RENDERBASE,x$b._renderKey=0},x$n.save=function(x$b,x$_){if(131072!=(131072&x$b._saveMark._saveuse)){x$b._saveMark._saveuse|=131072;var x$s=x$n._cache,x$h=0<x$s._length?x$s[--x$s._length]:new x$n;x$h._clipSaveRect=x$b._clipRect,x$b._clipRect=x$h._clipRect.copyFrom(x$b._clipRect),x$h._submitScissor=x$_;var x$x=x$b._save;x$x[x$x._length++]=x$h}},x$E(x$n,["_cache",function(){return this._cache=x$l._createArray()}]),x$n}(),x$X=function(){function x$V(){this._contextX=0,this._contextY=0,this._clipRect=new x$B,this._rect=new x$B,this._matrix=new x$r}x$P(x$V,"laya.webgl.canvas.save.SaveClipRectStencil");var x$b=x$V.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!1},x$b.restore=function(x$b){x$fb.restore(x$b,this._rect,this._saveMatrix,this._contextX,this._contextY),x$b._clipRect=this._clipSaveRect,x$b._curMat=this._saveMatrix,x$b._x=this._contextX,x$b._y=this._contextY,x$V._cache[x$V._cache._length++]=this,x$b._curSubmit=x$nb.RENDERBASE},x$V.save=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){if(262144!=(262144&x$b._saveMark._saveuse)){x$b._saveMark._saveuse|=262144;var x$f=x$V._cache,x$p=0<x$f._length?x$f[--x$f._length]:new x$V;x$p._clipSaveRect=x$b._clipRect,x$p._clipRect.setTo(x$E,x$C,x$O,x$L),x$b._clipRect=x$p._clipRect,x$p._rect.x=x$s,x$p._rect.y=x$h,x$p._rect.width=x$x,x$p._rect.height=x$n,x$p._contextX=x$b._x,x$p._contextY=x$b._y,x$p._saveMatrix=x$b._curMat,x$b._curMat.copyTo(x$p._matrix),x$b._curMat=x$p._matrix,x$p._submitStencil=x$_;var x$P=x$b._save;x$P[x$P._length++]=x$p}},x$E(x$V,["_cache",function(){return this._cache=x$l._createArray()}]),x$V}(),x$Y=function(){function x$h(){this._saveuse=0}x$P(x$h,"laya.webgl.canvas.save.SaveMark");var x$b=x$h.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!0},x$b.restore=function(x$b){x$b._saveMark=this._preSaveMark,x$h._no[x$h._no._length++]=this},x$h.Create=function(x$b){var x$_=x$h._no,x$s=0<x$_._length?x$_[--x$_._length]:new x$h;return x$s._saveuse=0,x$s._preSaveMark=x$b._saveMark,x$b._saveMark=x$s},x$E(x$h,["_no",function(){return this._no=x$l._createArray()}]),x$h}(),x$m=function(){function x$n(){this._matrix=new x$r}x$P(x$n,"laya.webgl.canvas.save.SaveTransform");var x$b=x$n.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!1},x$b.restore=function(x$b){x$b._curMat=this._savematrix,x$n._no[x$n._no._length++]=this},x$n.save=function(x$b){var x$_=x$b._saveMark;if(2048!=(2048&x$_._saveuse)){x$_._saveuse|=2048;var x$s=x$n._no,x$h=0<x$s._length?x$s[--x$s._length]:new x$n;x$h._savematrix=x$b._curMat,x$b._curMat=x$b._curMat.copyTo(x$h._matrix);var x$x=x$b._save;x$x[x$x._length++]=x$h}},x$E(x$n,["_no",function(){return this._no=x$l._createArray()}]),x$n}(),x$e=function(){function x$x(){}x$P(x$x,"laya.webgl.canvas.save.SaveTranslate");var x$b=x$x.prototype;return x$D.imps(x$b,{"laya.webgl.canvas.save.ISaveData":!0}),x$b.isSaveMark=function(){return!1},x$b.restore=function(x$b){x$b._curMat;x$b._x=this._x,x$b._y=this._y,x$x._no[x$x._no._length++]=this},x$x.save=function(x$b){var x$_=x$x._no,x$s=0<x$_._length?x$_[--x$_._length]:new x$x;x$s._x=x$b._x,x$s._y=x$b._y;var x$h=x$b._save;x$h[x$h._length++]=x$s},x$E(x$x,["_no",function(){return this._no=x$l._createArray()}]),x$x}(),x$v=function(){function x$b(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new x$B}x$P(x$b,"laya.webgl.resource.RenderTargetMAX");var x$_=x$b.prototype;return x$_.setSP=function(x$b){this._sp=x$b},x$_.size=function(x$b,x$_){var x$s=this;this._width!==x$b||this._height!==x$_?(this.repaint=!0,this._width=x$b,this._height=x$_,this.target?this.target.size(x$b,x$_):this.target=x$zb.create(x$b,x$_),this.target.hasListener("recovered")||this.target.on("recovered",this,function(x$b){x$D.timer.callLater(x$s._sp,x$s._sp.repaint)})):this.target.size(x$b,x$_)},x$_._flushToTarget=function(x$b,x$_){if(!x$_._destroy){var x$s=x$Rb.worldScissorTest,x$h=x$Rb.worldClipRect;x$Rb.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,x$Rb.worldScissorTest=!1,x$cb.mainContext.disable(3089);var x$x=x$Rb.worldAlpha,x$n=x$Rb.worldMatrix4,x$E=x$Rb.worldMatrix,x$C=x$Rb.worldFilters,x$O=x$Rb.worldShaderDefines;if(x$Rb.worldMatrix=x$r.EMPTY,x$Rb.restoreTempArray(),x$Rb.worldMatrix4=x$Rb.TEMPMAT4_ARRAY,x$Rb.worldAlpha=1,x$Rb.worldFilters=null,x$Rb.worldShaderDefines=null,x$Gb.activeShader=null,x$_.start(),x$o.showCanvasMark?x$_.clear(0,1,0,.3):x$_.clear(0,0,0,0),x$b.flush(),x$_.end(),x$Gb.activeShader=null,x$Rb.worldAlpha=x$x,x$Rb.worldMatrix4=x$n,x$Rb.worldMatrix=x$E,x$Rb.worldFilters=x$C,x$Rb.worldShaderDefines=x$O,x$Rb.worldScissorTest=x$s){var x$L=x$Rb.height-x$h.y-x$h.height;x$cb.mainContext.scissor(x$h.x,x$L,x$h.width,x$h.height),x$cb.mainContext.enable(3089)}x$Rb.worldClipRect=x$h}},x$_.flush=function(x$b){this.repaint&&(this._flushToTarget(x$b,this.target),this.repaint=!1)},x$_.drawTo=function(x$b,x$_,x$s,x$h,x$x){x$b.drawTexture(this.target.getTexture(),x$_,x$s,x$h,x$x,0,0)},x$_.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},x$b}(),x$H=function(){function x$b(){this.ALPHA=1,this.shaderType=0,this.defines=new x$Sb}return x$P(x$b,"laya.webgl.shader.d2.Shader2D"),x$b.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},x$b.__init__=function(){var x$b,x$_;x$Yb.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),x$Yb.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),x$Yb.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),x$Yb.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),x$Yb.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),x$Yb.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),x$Yb.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),x$Yb.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),x$b="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",x$_='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',x$Yb.preCompile2D(0,1,x$b,x$_,null),x$b="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",x$_='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',x$Yb.preCompile2D(0,2,x$b,x$_,null),x$b="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",x$_="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",x$Yb.preCompile2D(0,4,x$b,x$_,null),x$b="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",x$_='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',x$Yb.preCompile2D(0,256,x$b,x$_,null),x$b="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",x$_="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",x$Yb.preCompile2D(0,512,x$b,x$_,null)},x$b}(),x$j=function(){function x$_(x$b,x$_,x$s){this._value=0,this._name2int=x$b,this._int2name=x$_,this._int2nameMap=x$s}x$P(x$_,"laya.webgl.shader.ShaderDefines");var x$b=x$_.prototype;return x$b.add=function(x$b){return"string"==typeof x$b&&(x$b=this._name2int[x$b]),this._value|=x$b,this._value},x$b.addInt=function(x$b){return this._value|=x$b,this._value},x$b.remove=function(x$b){return"string"==typeof x$b&&(x$b=this._name2int[x$b]),this._value&=~x$b,this._value},x$b.isDefine=function(x$b){return(this._value&x$b)===x$b},x$b.getValue=function(){return this._value},x$b.setValue=function(x$b){this._value=x$b},x$b.toNameDic=function(){var x$b=this._int2nameMap[this._value];return x$b||x$_._toText(this._value,this._int2name,this._int2nameMap)},x$_._reg=function(x$b,x$_,x$s,x$h){x$h[x$s[x$b]=x$_]=x$b},x$_._toText=function(x$b,x$_,x$s){var x$h=x$s[x$b];if(x$h)return x$h;for(var x$x={},x$n=1,x$E=0;x$E<32&&!(x$b<(x$n=1<<x$E));x$E++)if(x$b&x$n){var x$C=x$_[x$n];x$C&&(x$x[x$C]="")}return x$s[x$b]=x$x},x$_._toInt=function(x$b,x$_){for(var x$s=x$b.split("."),x$h=0,x$x=0,x$n=x$s.length;x$x<x$n;x$x++){var x$E=x$_[x$s[x$x]];if(!x$E)throw new Error("Defines to int err:"+x$b+"/"+x$s[x$x]);x$h|=x$E}return x$h},x$_}(),x$bb=function(){function x$E(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new x$r}x$P(x$E,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var x$b=x$E.prototype;return x$b.init=function(x$b,x$_,x$s){if(x$_)this._vs=x$_;else{this._vs=[];var x$h=x$b.width,x$x=x$b.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(x$h,0,1,0,1,1,1,1),this._vs.push(x$h,x$x,1,1,1,1,1,1),this._vs.push(0,x$x,0,1,1,1,1,1)}x$s?this._ps=x$s:(x$E._defaultPS||(x$E._defaultPS=[]).push(0,1,3,3,1,2),this._ps=x$E._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=x$b},x$b.init2=function(x$b,x$_,x$s,x$h,x$x){this.transform&&(this.transform=null),x$s?this._ps=x$s:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=x$h,this._uvs=x$x,this.mEleNum=this._ps.length,this.mTexture=x$b,(x$i.isConchNode||x$i.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},x$b._initMyData=function(){var x$b=0,x$_=0,x$s=4*this._verticles.length;this._vs=x$E._tempVS;var x$h=!1;if(x$i.isConchNode||x$i.isConchApp?(this._vs.length=x$s,x$h=!0):this._vs.length<x$s&&(this._vs.length=x$s,x$h=!0),x$E._tVSLen=x$s,x$h)for(;x$b<x$s;)this._vs[x$b]=this._verticles[x$_],this._vs[x$b+1]=this._verticles[x$_+1],this._vs[x$b+2]=this._uvs[x$_],this._vs[x$b+3]=this._uvs[x$_+1],this._vs[x$b+4]=1,this._vs[x$b+5]=1,this._vs[x$b+6]=1,this._vs[x$b+7]=1,x$b+=8,x$_+=2;else for(;x$b<x$s;)this._vs[x$b]=this._verticles[x$_],this._vs[x$b+1]=this._verticles[x$_+1],this._vs[x$b+2]=this._uvs[x$_],this._vs[x$b+3]=this._uvs[x$_+1],x$b+=8,x$_+=2},x$b.getData2=function(x$b,x$_,x$s){var x$h;this.mVBBuffer=x$b,this.mIBBuffer=x$_,this._initMyData(),x$b.appendEx2(this._vs,Float32Array,x$E._tVSLen,4),this._indexStart=x$_._byteLength,(x$h=x$E._tempIB).length<this._ps.length&&(x$h.length=this._ps.length);for(var x$x=0,x$n=this._ps.length;x$x<x$n;x$x++)x$h[x$x]=this._ps[x$x]+x$s;x$_.appendEx2(x$h,Uint16Array,this._ps.length,2)},x$b.getData=function(x$b,x$_,x$s){if(this.mVBBuffer=x$b,this.mIBBuffer=x$_,x$b.append(this.mVBData),this._indexStart=x$_._byteLength,this.mIBData.start!=x$s){for(var x$h=0,x$x=this._ps.length;x$h<x$x;x$h++)this.mIBData[x$h]=this._ps[x$h]+x$s;this.mIBData.start=x$s}x$_.append(this.mIBData)},x$b.render=function(x$b,x$_,x$s){if(x$i.isWebGL&&this.mTexture){x$b._renderKey=0,x$b._shader2D.glTexture=null,x$_b.getInstance().addSkinMesh(this);var x$h=x$nb.createShape(x$b,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,x$Mb.create(512,0));this.transform||(this.transform=x$r.EMPTY),this.transform.translate(x$_,x$s),x$r.mul(this.transform,x$b._curMat,this._tempMatrix),this.transform.translate(-x$_,-x$s);var x$x=x$h.shaderValue,x$n=x$x.u_mmat2||x$Rb.getMatrArray();x$Rb.mat2MatArray(this._tempMatrix,x$n),x$x.textureHost=this.mTexture,x$x.offsetX=0,x$x.offsetY=0,x$x.u_mmat2=x$n,x$x.ALPHA=x$b._shader2D.ALPHA,x$b._submits[x$b._submits._length++]=x$h}else x$i.isConchApp&&this.mTexture&&(this.transform||(this.transform=x$r.EMPTY),x$b.setSkinMesh&&x$b.setSkinMesh(x$_,x$s,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},x$E._tempVS=[],x$E._tempIB=[],x$E._defaultPS=null,x$E._tVSLen=0,x$E}(),x$_b=function(){function x$b(){this.ib=null,this.vb=null;x$cb.mainContext;this.ib=x$Hb.create(35048),this.vb=x$jb.create(8)}x$P(x$b,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var x$_=x$b.prototype;return x$_.addSkinMesh=function(x$b){x$b.getData2(this.vb,this.ib,this.vb._byteLength/32)},x$_.reset=function(){this.vb.clear(),this.ib.clear()},x$b.getInstance=function(){return x$b.instance=x$b.instance||new x$b},x$b.instance=null,x$b}(),x$sb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===x$O&&(x$O=0),this.x=x$b,this.y=x$_,this.width=x$s,this.height=x$h,this.edges=x$x,this.color=x$n,this.borderWidth=x$E,this.borderColor=x$C}x$P(x$b,"laya.webgl.shapes.BasePoly");var x$_=x$b.prototype;return x$D.imps(x$_,{"laya.webgl.shapes.IShape":!0}),x$_.getData=function(x$b,x$_,x$s){},x$_.rebuild=function(x$b){},x$_.setMatrix=function(x$b){},x$_.needUpdate=function(x$b){return!0},x$_.sector=function(x$b,x$_,x$s){var x$h=this.x,x$x=this.y,x$n=this.edges,x$E=(this.r1-this.r0)/x$n,x$C=this.width,x$O=this.height,x$L=this.color,x$f=(x$L>>16&255)/255,x$p=(x$L>>8&255)/255,x$P=(255&x$L)/255;x$b.push(x$h,x$x,x$f,x$p,x$P);for(var x$V=0;x$V<x$n+1;x$V++)x$b.push(x$h+Math.sin(x$E*x$V+this.r0)*x$C,x$x+Math.cos(x$E*x$V+this.r0)*x$O),x$b.push(x$f,x$p,x$P);for(x$V=0;x$V<x$n;x$V++)x$_.push(x$s,x$s+x$V+1,x$s+x$V+2)},x$_.createLine2=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C,x$O,x$L,x$f,x$p,x$P,x$V,x$Q,x$y,x$w,x$i,x$R,x$t,x$c,x$$,x$D,x$o,x$M,x$r,x$k=x$b.concat(),x$B=x$x,x$S=this.borderColor,x$Z=(x$S>>16&255)/255,x$J=(x$S>>8&255)/255,x$W=(255&x$S)/255,x$T=x$k.length/2,x$q=x$h,x$U=x$s/2;x$O=x$k[0],x$L=x$k[1],x$y=x$O-(x$f=x$k[2]),x$Q=(x$Q=-(x$L-(x$p=x$k[3])))/(x$r=Math.sqrt(x$Q*x$Q+x$y*x$y))*x$U,x$y=x$y/x$r*x$U,x$B.push(x$O-x$Q+this.x,x$L-x$y+this.y,x$Z,x$J,x$W,x$O+x$Q+this.x,x$L+x$y+this.y,x$Z,x$J,x$W);for(var x$G=1;x$G<x$T-1;x$G++)x$O=x$k[2*(x$G-1)],x$L=x$k[2*(x$G-1)+1],x$f=x$k[2*x$G],x$p=x$k[2*x$G+1],x$P=x$k[2*(x$G+1)],x$V=x$k[2*(x$G+1)+1],x$y=x$O-x$f,x$i=x$f-x$P,x$c=(-(x$Q=(x$Q=-(x$L-x$p))/(x$r=Math.sqrt(x$Q*x$Q+x$y*x$y))*x$U)+x$O)*(-(x$y=x$y/x$r*x$U)+x$p)-(-x$Q+x$f)*(-x$y+x$L),x$o=(-(x$w=(x$w=-(x$p-x$V))/(x$r=Math.sqrt(x$w*x$w+x$i*x$i))*x$U)+x$P)*(-(x$i=x$i/x$r*x$U)+x$p)-(-x$w+x$f)*(-x$i+x$V),x$M=(x$R=-x$y+x$L-(-x$y+x$p))*(x$D=-x$w+x$f-(-x$w+x$P))-(x$$=-x$i+x$V-(-x$i+x$p))*(x$t=-x$Q+x$f-(-x$Q+x$O)),Math.abs(x$M)<.1?(x$M+=10.1,x$B.push(x$f-x$Q+this.x,x$p-x$y+this.y,x$Z,x$J,x$W,x$f+x$Q+this.x,x$p+x$y+this.y,x$Z,x$J,x$W)):(((x$E=(x$t*x$o-x$D*x$c)/x$M)-x$f)*(x$E-x$f)+((x$C=(x$$*x$c-x$R*x$o)/x$M)-x$p)+(x$C-x$p),x$B.push(x$E+this.x,x$C+this.y,x$Z,x$J,x$W,x$f-(x$E-x$f)+this.x,x$p-(x$C-x$p)+this.y,x$Z,x$J,x$W));x$O=x$k[x$k.length-4],x$L=x$k[x$k.length-3],x$y=x$O-(x$f=x$k[x$k.length-2]),x$Q=(x$Q=-(x$L-(x$p=x$k[x$k.length-1])))/(x$r=Math.sqrt(x$Q*x$Q+x$y*x$y))*x$U,x$y=x$y/x$r*x$U,x$B.push(x$f-x$Q+this.x,x$p-x$y+this.y,x$Z,x$J,x$W,x$f+x$Q+this.x,x$p+x$y+this.y,x$Z,x$J,x$W);var x$z=x$n;for(x$G=1;x$G<x$z;x$G++)x$_.push(x$q+2*(x$G-1),x$q+2*(x$G-1)+1,x$q+2*x$G+1,x$q+2*x$G+1,x$q+2*x$G,x$q+2*(x$G-1));return x$B},x$_.createLine=function(x$b,x$_,x$s,x$h){var x$x=x$b.concat(),x$n=x$b,x$E=this.borderColor,x$C=(x$E>>16&255)/255,x$O=(x$E>>8&255)/255,x$L=(255&x$E)/255;x$x.splice(0,5);var x$f,x$p,x$P,x$V,x$Q,x$y,x$w,x$i,x$R,x$t,x$c,x$$,x$D,x$o,x$M,x$r,x$k,x$B,x$S,x$Z,x$J=x$x.length/5,x$W=x$h,x$T=x$s/2;x$P=x$x[0],x$V=x$x[1],x$t=x$P-(x$Q=x$x[5]),x$R=(x$R=-(x$V-(x$y=x$x[6])))/(x$Z=Math.sqrt(x$R*x$R+x$t*x$t))*x$T,x$t=x$t/x$Z*x$T,x$n.push(x$P-x$R,x$V-x$t,x$C,x$O,x$L,x$P+x$R,x$V+x$t,x$C,x$O,x$L);for(var x$q=1;x$q<x$J-1;x$q++)x$P=x$x[5*(x$q-1)],x$V=x$x[5*(x$q-1)+1],x$Q=x$x[5*x$q],x$y=x$x[5*x$q+1],x$w=x$x[5*(x$q+1)],x$i=x$x[5*(x$q+1)+1],x$t=x$P-x$Q,x$$=x$Q-x$w,x$M=(-(x$R=(x$R=-(x$V-x$y))/(x$Z=Math.sqrt(x$R*x$R+x$t*x$t))*x$T)+x$P)*(-(x$t=x$t/x$Z*x$T)+x$y)-(-x$R+x$Q)*(-x$t+x$V),x$B=(-(x$c=(x$c=-(x$y-x$i))/(x$Z=Math.sqrt(x$c*x$c+x$$*x$$))*x$T)+x$w)*(-(x$$=x$$/x$Z*x$T)+x$y)-(-x$c+x$Q)*(-x$$+x$i),x$S=(x$D=-x$t+x$V-(-x$t+x$y))*(x$k=-x$c+x$Q-(-x$c+x$w))-(x$r=-x$$+x$i-(-x$$+x$y))*(x$o=-x$R+x$Q-(-x$R+x$P)),Math.abs(x$S)<.1?(x$S+=10.1,x$n.push(x$Q-x$R,x$y-x$t,x$C,x$O,x$L,x$Q+x$R,x$y+x$t,x$C,x$O,x$L)):(((x$f=(x$o*x$B-x$k*x$M)/x$S)-x$Q)*(x$f-x$Q)+((x$p=(x$r*x$M-x$D*x$B)/x$S)-x$y)+(x$p-x$y),x$n.push(x$f,x$p,x$C,x$O,x$L,x$Q-(x$f-x$Q),x$y-(x$p-x$y),x$C,x$O,x$L));x$P=x$x[x$x.length-10],x$V=x$x[x$x.length-9],x$t=x$P-(x$Q=x$x[x$x.length-5]),x$R=(x$R=-(x$V-(x$y=x$x[x$x.length-4])))/(x$Z=Math.sqrt(x$R*x$R+x$t*x$t))*x$T,x$t=x$t/x$Z*x$T,x$n.push(x$Q-x$R,x$y-x$t,x$C,x$O,x$L,x$Q+x$R,x$y+x$t,x$C,x$O,x$L);var x$U=this.edges+1;for(x$q=1;x$q<x$U;x$q++)x$_.push(x$W+2*(x$q-1),x$W+2*(x$q-1)+1,x$W+2*x$q+1,x$W+2*x$q+1,x$W+2*x$q,x$W+2*(x$q-1));return x$n},x$_.createLoopLine=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$b.concat(),x$C=x$x||x$b,x$O=this.borderColor,x$L=(x$O>>16&255)/255,x$f=(x$O>>8&255)/255,x$p=(255&x$O)/255;x$E.splice(0,5);var x$P=[x$E[0],x$E[1]],x$V=[x$E[x$E.length-5],x$E[x$E.length-4]],x$Q=x$V[0]+.5*(x$P[0]-x$V[0]),x$y=x$V[1]+.5*(x$P[1]-x$V[1]);x$E.unshift(x$Q,x$y,0,0,0),x$E.push(x$Q,x$y,0,0,0);var x$w,x$i,x$R,x$t,x$c,x$$,x$D,x$o,x$M,x$r,x$k,x$B,x$S,x$Z,x$J,x$W,x$T,x$q,x$U,x$G,x$z=x$E.length/5,x$a=x$h,x$K=x$s/2;x$R=x$E[0],x$t=x$E[1],x$r=x$R-(x$c=x$E[5]),x$M=(x$M=-(x$t-(x$$=x$E[6])))/(x$G=Math.sqrt(x$M*x$M+x$r*x$r))*x$K,x$r=x$r/x$G*x$K,x$C.push(x$R-x$M,x$t-x$r,x$L,x$f,x$p,x$R+x$M,x$t+x$r,x$L,x$f,x$p);for(var x$d=1;x$d<x$z-1;x$d++)x$R=x$E[5*(x$d-1)],x$t=x$E[5*(x$d-1)+1],x$c=x$E[5*x$d],x$$=x$E[5*x$d+1],x$D=x$E[5*(x$d+1)],x$o=x$E[5*(x$d+1)+1],x$r=x$R-x$c,x$B=x$c-x$D,x$J=(-(x$M=(x$M=-(x$t-x$$))/(x$G=Math.sqrt(x$M*x$M+x$r*x$r))*x$K)+x$R)*(-(x$r=x$r/x$G*x$K)+x$$)-(-x$M+x$c)*(-x$r+x$t),x$q=(-(x$k=(x$k=-(x$$-x$o))/(x$G=Math.sqrt(x$k*x$k+x$B*x$B))*x$K)+x$D)*(-(x$B=x$B/x$G*x$K)+x$$)-(-x$k+x$c)*(-x$B+x$o),x$U=(x$S=-x$r+x$t-(-x$r+x$$))*(x$T=-x$k+x$c-(-x$k+x$D))-(x$W=-x$B+x$o-(-x$B+x$$))*(x$Z=-x$M+x$c-(-x$M+x$R)),Math.abs(x$U)<.1?(x$U+=10.1,x$C.push(x$c-x$M,x$$-x$r,x$L,x$f,x$p,x$c+x$M,x$$+x$r,x$L,x$f,x$p)):(((x$w=(x$Z*x$q-x$T*x$J)/x$U)-x$c)*(x$w-x$c)+((x$i=(x$W*x$J-x$S*x$q)/x$U)-x$$)+(x$i-x$$),x$C.push(x$w,x$i,x$L,x$f,x$p,x$c-(x$w-x$c),x$$-(x$i-x$$),x$L,x$f,x$p));x$n&&(x$_=x$n);var x$I=this.edges+1;for(x$d=1;x$d<x$I;x$d++)x$_.push(x$a+2*(x$d-1),x$a+2*(x$d-1)+1,x$a+2*x$d+1,x$a+2*x$d+1,x$a+2*x$d,x$a+2*(x$d-1));return x$_.push(x$a+2*(x$d-1),x$a+2*(x$d-1)+1,x$a+1,x$a+1,x$a,x$a+2*(x$d-1)),x$C},x$b}(),x$hb=function(){function x$y(){}return x$P(x$y,"laya.webgl.shapes.Earcut"),x$y.earcut=function(x$b,x$_,x$s){x$s=x$s||2;var x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f=x$_&&x$_.length,x$p=x$f?x$_[0]*x$s:x$b.length,x$P=x$y.linkedList(x$b,0,x$p,x$s,!0),x$V=[];if(!x$P)return x$V;if(x$f&&(x$P=x$y.eliminateHoles(x$b,x$_,x$P,x$s)),x$b.length>80*x$s){x$h=x$n=x$b[0],x$x=x$E=x$b[1];for(var x$Q=x$s;x$Q<x$p;x$Q+=x$s)(x$C=x$b[x$Q])<x$h&&(x$h=x$C),(x$O=x$b[x$Q+1])<x$x&&(x$x=x$O),x$n<x$C&&(x$n=x$C),x$E<x$O&&(x$E=x$O);x$L=0!==(x$L=Math.max(x$n-x$h,x$E-x$x))?1/x$L:0}return x$y.earcutLinked(x$P,x$V,x$s,x$h,x$x,x$L),x$V},x$y.linkedList=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E;if(x$x===0<x$y.signedArea(x$b,x$_,x$s,x$h))for(x$n=x$_;x$n<x$s;x$n+=x$h)x$E=x$y.insertNode(x$n,x$b[x$n],x$b[x$n+1],x$E);else for(x$n=x$s-x$h;x$_<=x$n;x$n-=x$h)x$E=x$y.insertNode(x$n,x$b[x$n],x$b[x$n+1],x$E);return x$E&&x$y.equals(x$E,x$E.next)&&(x$y.removeNode(x$E),x$E=x$E.next),x$E},x$y.filterPoints=function(x$b,x$_){if(!x$b)return x$b;x$_||(x$_=x$b);var x$s,x$h=x$b;do{if(x$s=!1,x$h.steiner||!x$y.equals(x$h,x$h.next)&&0!==x$y.area(x$h.prev,x$h,x$h.next))x$h=x$h.next;else{if(x$y.removeNode(x$h),(x$h=x$_=x$h.prev)===x$h.next)break;x$s=!0}}while(x$s||x$h!==x$_);return x$_},x$y.earcutLinked=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(x$b){!x$E&&x$n&&x$y.indexCurve(x$b,x$h,x$x,x$n);for(var x$C,x$O,x$L=x$b;x$b.prev!==x$b.next;)if(x$C=x$b.prev,x$O=x$b.next,x$n?x$y.isEarHashed(x$b,x$h,x$x,x$n):x$y.isEar(x$b))x$_.push(x$C.i/x$s),x$_.push(x$b.i/x$s),x$_.push(x$O.i/x$s),x$y.removeNode(x$b),x$b=x$O.next,x$L=x$O.next;else if((x$b=x$O)===x$L){x$E?1===x$E?(x$b=x$y.cureLocalIntersections(x$b,x$_,x$s),x$y.earcutLinked(x$b,x$_,x$s,x$h,x$x,x$n,2)):2===x$E&&x$y.splitEarcut(x$b,x$_,x$s,x$h,x$x,x$n):x$y.earcutLinked(x$y.filterPoints(x$b,null),x$_,x$s,x$h,x$x,x$n,1);break}}},x$y.isEar=function(x$b){var x$_=x$b.prev,x$s=x$b,x$h=x$b.next;if(0<=x$y.area(x$_,x$s,x$h))return!1;for(var x$x=x$b.next.next;x$x!==x$b.prev;){if(x$y.pointInTriangle(x$_.x,x$_.y,x$s.x,x$s.y,x$h.x,x$h.y,x$x.x,x$x.y)&&0<=x$y.area(x$x.prev,x$x,x$x.next))return!1;x$x=x$x.next}return!0},x$y.isEarHashed=function(x$b,x$_,x$s,x$h){var x$x=x$b.prev,x$n=x$b,x$E=x$b.next;if(0<=x$y.area(x$x,x$n,x$E))return!1;for(var x$C=x$x.x<x$n.x?x$x.x<x$E.x?x$x.x:x$E.x:x$n.x<x$E.x?x$n.x:x$E.x,x$O=x$x.y<x$n.y?x$x.y<x$E.y?x$x.y:x$E.y:x$n.y<x$E.y?x$n.y:x$E.y,x$L=x$x.x>x$n.x?x$x.x>x$E.x?x$x.x:x$E.x:x$n.x>x$E.x?x$n.x:x$E.x,x$f=x$x.y>x$n.y?x$x.y>x$E.y?x$x.y:x$E.y:x$n.y>x$E.y?x$n.y:x$E.y,x$p=x$y.zOrder(x$C,x$O,x$_,x$s,x$h),x$P=x$y.zOrder(x$L,x$f,x$_,x$s,x$h),x$V=x$b.nextZ;x$V&&x$V.z<=x$P;){if(x$V!==x$b.prev&&x$V!==x$b.next&&x$y.pointInTriangle(x$x.x,x$x.y,x$n.x,x$n.y,x$E.x,x$E.y,x$V.x,x$V.y)&&0<=x$y.area(x$V.prev,x$V,x$V.next))return!1;x$V=x$V.nextZ}for(x$V=x$b.prevZ;x$V&&x$V.z>=x$p;){if(x$V!==x$b.prev&&x$V!==x$b.next&&x$y.pointInTriangle(x$x.x,x$x.y,x$n.x,x$n.y,x$E.x,x$E.y,x$V.x,x$V.y)&&0<=x$y.area(x$V.prev,x$V,x$V.next))return!1;x$V=x$V.prevZ}return!0},x$y.cureLocalIntersections=function(x$b,x$_,x$s){var x$h=x$b;do{var x$x=x$h.prev,x$n=x$h.next.next;!x$y.equals(x$x,x$n)&&x$y.intersects(x$x,x$h,x$h.next,x$n)&&x$y.locallyInside(x$x,x$n)&&x$y.locallyInside(x$n,x$x)&&(x$_.push(x$x.i/x$s),x$_.push(x$h.i/x$s),x$_.push(x$n.i/x$s),x$y.removeNode(x$h),x$y.removeNode(x$h.next),x$h=x$b=x$n),x$h=x$h.next}while(x$h!==x$b);return x$h},x$y.splitEarcut=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$b;do{for(var x$C=x$E.next.next;x$C!==x$E.prev;){if(x$E.i!==x$C.i&&x$y.isValidDiagonal(x$E,x$C)){var x$O=x$y.splitPolygon(x$E,x$C);return x$E=x$y.filterPoints(x$E,x$E.next),x$O=x$y.filterPoints(x$O,x$O.next),x$y.earcutLinked(x$E,x$_,x$s,x$h,x$x,x$n),void x$y.earcutLinked(x$O,x$_,x$s,x$h,x$x,x$n)}x$C=x$C.next}x$E=x$E.next}while(x$E!==x$b)},x$y.eliminateHoles=function(x$b,x$_,x$s,x$h){var x$x,x$n,x$E,x$C,x$O,x$L=[];for(x$x=0,x$n=x$_.length;x$x<x$n;x$x++)x$E=x$_[x$x]*x$h,x$C=x$x<x$n-1?x$_[x$x+1]*x$h:x$b.length,(x$O=x$y.linkedList(x$b,x$E,x$C,x$h,!1))===x$O.next&&(x$O.steiner=!0),x$L.push(x$y.getLeftmost(x$O));for(x$L.sort(x$y.compareX),x$x=0;x$x<x$L.length;x$x++)x$y.eliminateHole(x$L[x$x],x$s),x$s=x$y.filterPoints(x$s,x$s.next);return x$s},x$y.compareX=function(x$b,x$_){return x$b.x-x$_.x},x$y.eliminateHole=function(x$b,x$_){if(x$_=x$y.findHoleBridge(x$b,x$_)){var x$s=x$y.splitPolygon(x$_,x$b);x$y.filterPoints(x$s,x$s.next)}},x$y.findHoleBridge=function(x$b,x$_){var x$s,x$h=x$_,x$x=x$b.x,x$n=x$b.y,x$E=-1/0;do{if(x$n<=x$h.y&&x$n>=x$h.next.y&&x$h.next.y!==x$h.y){var x$C=x$h.x+(x$n-x$h.y)*(x$h.next.x-x$h.x)/(x$h.next.y-x$h.y);if(x$C<=x$x&&x$E<x$C){if((x$E=x$C)===x$x){if(x$n===x$h.y)return x$h;if(x$n===x$h.next.y)return x$h.next}x$s=x$h.x<x$h.next.x?x$h:x$h.next}}x$h=x$h.next}while(x$h!==x$_);if(!x$s)return null;if(x$x===x$E)return x$s.prev;var x$O,x$L=x$s,x$f=x$s.x,x$p=x$s.y,x$P=1/0;for(x$h=x$s.next;x$h!==x$L;)x$x>=x$h.x&&x$h.x>=x$f&&x$x!==x$h.x&&x$y.pointInTriangle(x$n<x$p?x$x:x$E,x$n,x$f,x$p,x$n<x$p?x$E:x$x,x$n,x$h.x,x$h.y)&&((x$O=Math.abs(x$n-x$h.y)/(x$x-x$h.x))<x$P||x$O===x$P&&x$h.x>x$s.x)&&x$y.locallyInside(x$h,x$b)&&(x$s=x$h,x$P=x$O),x$h=x$h.next;return x$s},x$y.indexCurve=function(x$b,x$_,x$s,x$h){for(var x$x=x$b;null===x$x.z&&(x$x.z=x$y.zOrder(x$x.x,x$x.y,x$_,x$s,x$h)),x$x.prevZ=x$x.prev,x$x.nextZ=x$x.next,(x$x=x$x.next)!==x$b;);x$x.prevZ.nextZ=null,x$x.prevZ=null,x$y.sortLinked(x$x)},x$y.sortLinked=function(x$b){var x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L=1;do{for(x$s=x$b,x$n=x$b=null,x$E=0;x$s;){for(x$E++,x$h=x$s,x$_=x$C=0;x$_<x$L&&(x$C++,x$h=x$h.nextZ);x$_++);for(x$O=x$L;0<x$C||0<x$O&&x$h;)0!==x$C&&(0===x$O||!x$h||x$s.z<=x$h.z)?(x$s=(x$x=x$s).nextZ,x$C--):(x$h=(x$x=x$h).nextZ,x$O--),x$n?x$n.nextZ=x$x:x$b=x$x,x$x.prevZ=x$n,x$n=x$x;x$s=x$h}x$n.nextZ=null,x$L*=2}while(1<x$E);return x$b},x$y.zOrder=function(x$b,x$_,x$s,x$h,x$x){return(x$b=1431655765&((x$b=858993459&((x$b=252645135&((x$b=16711935&((x$b=32767*(x$b-x$s)*x$x)|x$b<<8))|x$b<<4))|x$b<<2))|x$b<<1))|(x$_=1431655765&((x$_=858993459&((x$_=252645135&((x$_=16711935&((x$_=32767*(x$_-x$h)*x$x)|x$_<<8))|x$_<<4))|x$_<<2))|x$_<<1))<<1},x$y.getLeftmost=function(x$b){for(var x$_=x$b,x$s=x$b;x$_.x<x$s.x&&(x$s=x$_),(x$_=x$_.next)!==x$b;);return x$s},x$y.pointInTriangle=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){return 0<=(x$x-x$E)*(x$_-x$C)-(x$b-x$E)*(x$n-x$C)&&0<=(x$b-x$E)*(x$h-x$C)-(x$s-x$E)*(x$_-x$C)&&0<=(x$s-x$E)*(x$n-x$C)-(x$x-x$E)*(x$h-x$C)},x$y.isValidDiagonal=function(x$b,x$_){return x$b.next.i!==x$_.i&&x$b.prev.i!==x$_.i&&!x$y.intersectsPolygon(x$b,x$_)&&x$y.locallyInside(x$b,x$_)&&x$y.locallyInside(x$_,x$b)&&x$y.middleInside(x$b,x$_)},x$y.area=function(x$b,x$_,x$s){return(x$_.y-x$b.y)*(x$s.x-x$_.x)-(x$_.x-x$b.x)*(x$s.y-x$_.y)},x$y.equals=function(x$b,x$_){return x$b.x===x$_.x&&x$b.y===x$_.y},x$y.intersects=function(x$b,x$_,x$s,x$h){return!!(x$y.equals(x$b,x$_)&&x$y.equals(x$s,x$h)||x$y.equals(x$b,x$h)&&x$y.equals(x$s,x$_))||0<x$y.area(x$b,x$_,x$s)!=0<x$y.area(x$b,x$_,x$h)&&0<x$y.area(x$s,x$h,x$b)!=0<x$y.area(x$s,x$h,x$_)},x$y.intersectsPolygon=function(x$b,x$_){var x$s=x$b;do{if(x$s.i!==x$b.i&&x$s.next.i!==x$b.i&&x$s.i!==x$_.i&&x$s.next.i!==x$_.i&&x$y.intersects(x$s,x$s.next,x$b,x$_))return!0;x$s=x$s.next}while(x$s!==x$b);return!1},x$y.locallyInside=function(x$b,x$_){return x$y.area(x$b.prev,x$b,x$b.next)<0?0<=x$y.area(x$b,x$_,x$b.next)&&0<=x$y.area(x$b,x$b.prev,x$_):x$y.area(x$b,x$_,x$b.prev)<0||x$y.area(x$b,x$b.next,x$_)<0},x$y.middleInside=function(x$b,x$_){for(var x$s=x$b,x$h=!1,x$x=(x$b.x+x$_.x)/2,x$n=(x$b.y+x$_.y)/2;x$s.y>x$n!=x$s.next.y>x$n&&x$s.next.y!==x$s.y&&x$x<(x$s.next.x-x$s.x)*(x$n-x$s.y)/(x$s.next.y-x$s.y)+x$s.x&&(x$h=!x$h),(x$s=x$s.next)!==x$b;);return x$h},x$y.splitPolygon=function(x$b,x$_){var x$s=new x$xb(x$b.i,x$b.x,x$b.y),x$h=new x$xb(x$_.i,x$_.x,x$_.y),x$x=x$b.next,x$n=x$_.prev;return(x$b.next=x$_).prev=x$b,(x$s.next=x$x).prev=x$s,(x$h.next=x$s).prev=x$h,(x$n.next=x$h).prev=x$n,x$h},x$y.insertNode=function(x$b,x$_,x$s,x$h){var x$x=new x$xb(x$b,x$_,x$s);return x$h?(x$x.next=x$h.next,(x$x.prev=x$h).next.prev=x$x,x$h.next=x$x):(x$x.prev=x$x).next=x$x,x$x},x$y.removeNode=function(x$b){x$b.next.prev=x$b.prev,x$b.prev.next=x$b.next,x$b.prevZ&&(x$b.prevZ.nextZ=x$b.nextZ),x$b.nextZ&&(x$b.nextZ.prevZ=x$b.prevZ)},x$y.signedArea=function(x$b,x$_,x$s,x$h){for(var x$x=0,x$n=x$_,x$E=x$s-x$h;x$n<x$s;x$n+=x$h)x$x+=(x$b[x$E]-x$b[x$n])*(x$b[x$n+1]+x$b[x$E+1]),x$E=x$n;return x$x},x$y}(),x$xb=function(){function x$b(x$b,x$_,x$s){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=x$b,this.x=x$_,this.y=x$s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return x$P(x$b,"laya.webgl.shapes.EarcutNode"),x$b}(),x$nb=(function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this.lineWidth=x$b,this.lineColor=x$_,this.lineAlpha=x$s,this.fillColor=x$h,this.fillAlpha=x$x,this.shape=x$E,this.fill=x$n}x$P(x$b,"laya.webgl.shapes.GeometryData");var x$_=x$b.prototype;x$_.clone=function(){return new x$b(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},x$_.getIndexData=function(){return null},x$_.getVertexData=function(){return null},x$_.destroy=function(){this.shape=null}}(),function(){function x$b(x$b){if(x$b instanceof Float32Array)this.points=x$b;else if(x$b instanceof Array){x$b.length;this.points=new Float32Array(x$b)}}x$P(x$b,"laya.webgl.shapes.Vertex");var x$_=x$b.prototype;x$D.imps(x$_,{"laya.webgl.shapes.IShape":!0}),x$_.getData=function(x$b,x$_,x$s){},x$_.needUpdate=function(x$b){return!1},x$_.rebuild=function(x$b){},x$_.setMatrix=function(x$b){}}(),function(){function x$O(x$b){void 0===x$b&&(x$b=1e4),this._renderType=x$b}x$P(x$O,"laya.webgl.submit.Submit");var x$b=x$O.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b.releaseRender=function(){var x$b=x$O._cache;(x$b[x$b._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},x$b.getRenderType=function(){return this._renderType},x$b.renderSubmit=function(){if(0===this._numEle)return 1;var x$b=this.shaderValue.textureHost;if(x$b){var x$_=x$b.source;if(!x$b.bitmap||!x$_)return 1;this.shaderValue.texture=x$_,x$b.alphaTexture&&x$b.alphaTexture.source&&(this.shaderValue.texture1=x$b.alphaTexture.source)}this._vb.bind_upload(this._ib);var x$s=x$cb.mainContext;return this.shaderValue.upload(),x$F.activeBlendFunction!==this._blendFn&&(x$s.enable(3042),this._blendFn(x$s),x$F.activeBlendFunction=this._blendFn),x$J.drawCall++,x$J.trianglesFaces+=this._numEle/3,x$s.drawElements(4,this._numEle,5123,this._startIdx),1},x$O.__init__=function(){var x$b=x$O.RENDERBASE=new x$O(-1);x$b.shaderValue=new x$Mb(0,0),x$b.shaderValue.ALPHA=-1234},x$O.createSubmit=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$O._cache._length?x$O._cache[--x$O._cache._length]:new x$O;null==x$s&&((x$s=x$n._selfVb||(x$n._selfVb=x$jb.create(-1))).clear(),x$h=0),x$n._ib=x$_,x$n._vb=x$s,x$n._startIdx=x$h*x$yb.BYTES_PIDX,x$n._numEle=0;var x$E=x$b._nBlendType;x$n._blendFn=x$b._targets?x$F.targetFns[x$E]:x$F.fns[x$E],x$n.shaderValue=x$x,x$n.shaderValue.setValue(x$b._shader2D);var x$C=x$b._shader2D.filters;return x$C&&x$n.shaderValue.setFilters(x$C),x$n},x$O.createShape=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$O._cache._length?x$O._cache[--x$O._cache._length]:new x$O;x$E._ib=x$_,x$E._vb=x$s,x$E._numEle=x$h,x$E._startIdx=x$x,x$E.shaderValue=x$n,x$E.shaderValue.setValue(x$b._shader2D);var x$C=x$b._nBlendType;return x$E._blendFn=x$b._targets?x$F.targetFns[x$C]:x$F.fns[x$C],x$E},x$O.TYPE_2D=1e4,x$O.TYPE_CANVAS=10003,x$O.TYPE_CMDSETRT=10004,x$O.TYPE_CUSTOM=10005,x$O.TYPE_BLURRT=10006,x$O.TYPE_CMDDESTORYPRERT=10007,x$O.TYPE_DISABLESTENCIL=10008,x$O.TYPE_OTHERIBVB=10009,x$O.TYPE_PRIMITIVE=10010,x$O.TYPE_RT=10011,x$O.TYPE_BLUR_RT=10012,x$O.TYPE_TARGET=10013,x$O.TYPE_CHANGE_VALUE=10014,x$O.TYPE_SHAPE=10015,x$O.TYPE_TEXTURE=10016,x$O.TYPE_FILLTEXTURE=10017,x$O.RENDERBASE=null,x$O._cache=((x$O._cache=[])._length=0,x$O._cache),x$O}()),x$Eb=function(){function x$h(){this.fun=null,this.args=null}x$P(x$h,"laya.webgl.submit.SubmitCMD");var x$b=x$h.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b.renderSubmit=function(){return this.fun.apply(null,this.args),1},x$b.getRenderType=function(){return 0},x$b.releaseRender=function(){var x$b=x$h._cache;x$b[x$b._length++]=this},x$h.create=function(x$b,x$_){var x$s=x$h._cache._length?x$h._cache[--x$h._cache._length]:new x$h;return x$s.fun=x$_,x$s.args=x$b,x$s},x$h._cache=((x$h._cache=[])._length=0,x$h._cache),x$h}(),x$Cb=function(){function x$_(){this.variables={}}x$P(x$_,"laya.webgl.submit.SubmitCMDScope");var x$b=x$_.prototype;return x$b.getValue=function(x$b){return this.variables[x$b]},x$b.addValue=function(x$b,x$_){return this.variables[x$b]=x$_},x$b.setValue=function(x$b,x$_){return this.variables.hasOwnProperty(x$b)?this.variables[x$b]=x$_:null},x$b.clear=function(){for(var x$b in this.variables)delete this.variables[x$b]},x$b.recycle=function(){this.clear(),x$_.POOL.push(this)},x$_.create=function(){var x$b=x$_.POOL.pop();return x$b||(x$b=new x$_),x$b},x$_.POOL=[],x$_}(),x$Ob=function(){function x$p(){this.offset=0,this.startIndex=0,this._mat=x$r.create()}x$P(x$p,"laya.webgl.submit.SubmitOtherIBVB");var x$b=x$p.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b.releaseRender=function(){var x$b=x$p._cache;(x$b[x$b._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},x$b.getRenderType=function(){return 10009},x$b.renderSubmit=function(){var x$b=this._shaderValue.textureHost;if(x$b){var x$_=x$b.source;if(!x$b.bitmap||!x$_)return 1;this._shaderValue.texture=x$_}this._vb.bind_upload(this._ib);var x$s=x$Rb.worldMatrix4,x$h=x$r.TEMP;x$r.mulPre(this._mat,x$s[0],x$s[1],x$s[4],x$s[5],x$s[12],x$s[13],x$h);var x$x=x$Rb.worldMatrix4=x$p.tempMatrix4;x$x[0]=x$h.a,x$x[1]=x$h.b,x$x[4]=x$h.c,x$x[5]=x$h.d,x$x[12]=x$h.tx,x$x[13]=x$h.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var x$n=x$cb.mainContext;return x$F.activeBlendFunction!==this._blendFn&&(x$n.enable(3042),this._blendFn(x$n),x$F.activeBlendFunction=this._blendFn),x$J.drawCall++,x$J.trianglesFaces+=this._numEle/3,x$n.drawElements(4,this._numEle,5123,this.startIndex),x$Rb.worldMatrix4=x$s,x$Gb.activeShader=null,1},x$p.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){void 0===x$O&&(x$O=0);var x$L=x$p._cache._length?x$p._cache[--x$p._cache._length]:new x$p;x$L._ib=x$s,x$L._vb=x$_,x$L._numEle=x$h,x$L._shader=x$x,x$L._shaderValue=x$n;var x$f=x$b._nBlendType;switch(x$L._blendFn=x$b._targets?x$F.targetFns[x$f]:x$F.fns[x$f],x$O){case 0:x$L.offset=0,x$L.startIndex=x$C/(x$yb.BYTES_PE*x$_.vertexStride)*1.5,x$L.startIndex*=x$yb.BYTES_PIDX;break;case 1:x$L.startIndex=x$E,x$L.offset=x$C}return x$L},x$p._cache=((x$p._cache=[])._length=0,x$p._cache),x$p.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x$p}(),x$Lb=function(){function x$s(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new x$B,this.screenRect=new x$B}x$P(x$s,"laya.webgl.submit.SubmitScissor");var x$b=x$s.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b._scissor=function(x$b,x$_,x$s,x$h){var x$x=x$Rb.worldMatrix4,x$n=x$x[0],x$E=x$x[5],x$C=x$x[12],x$O=x$x[13];if(x$h*=x$E,(x$s*=x$n)<1||x$h<1)return!1;var x$L=(x$b=x$b*x$n+x$C)+x$s,x$f=(x$_=x$_*x$E+x$O)+x$h;x$b<0&&(x$s=x$L-(x$b=0)),x$_<0&&(x$h=x$f-(x$_=0));var x$p=x$Rb.worldClipRect;if(x$b=Math.max(x$b,x$p.x),x$_=Math.max(x$_,x$p.y),x$s=Math.min(x$L,x$p.right)-x$b,x$h=Math.min(x$f,x$p.bottom)-x$_,x$s<1||x$h<1)return!1;var x$P=x$Rb.worldScissorTest;return this.screenRect.copyFrom(x$p),x$p.x=x$b,x$p.y=x$_,x$p.width=x$s,x$p.height=x$h,x$Rb.worldScissorTest=!0,x$_=x$Rb.height-x$_-x$h,x$cb.mainContext.scissor(x$b,x$_,x$s,x$h),x$cb.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),x$P?(x$_=x$Rb.height-this.screenRect.y-this.screenRect.height,x$cb.mainContext.scissor(this.screenRect.x,x$_,this.screenRect.width,this.screenRect.height),x$cb.mainContext.enable(3089)):(x$cb.mainContext.disable(3089),x$Rb.worldScissorTest=!1),x$p.copyFrom(this.screenRect),!0},x$b._scissorWithTagart=function(x$b,x$_,x$s,x$h){if(x$s<1||x$h<1)return!1;var x$x=x$b+x$s,x$n=x$_+x$h;x$b<0&&(x$s=x$x-(x$b=0)),x$_<0&&(x$h=x$n-(x$_=0));var x$E=x$Rb.worldClipRect;if(x$b=Math.max(x$b,x$E.x),x$_=Math.max(x$_,x$E.y),x$s=Math.min(x$x,x$E.right)-x$b,x$h=Math.min(x$n,x$E.bottom)-x$_,x$s<1||x$h<1)return!1;var x$C=x$Rb.worldScissorTest;return this.screenRect.copyFrom(x$E),x$Rb.worldScissorTest=!0,x$E.x=x$b,x$E.y=x$_,x$E.width=x$s,x$E.height=x$h,x$_=x$Rb.height-x$_-x$h,x$cb.mainContext.scissor(x$b,x$_,x$s,x$h),x$cb.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),x$C?(x$_=x$Rb.height-this.screenRect.y-this.screenRect.height,x$cb.mainContext.scissor(this.screenRect.x,x$_,this.screenRect.width,this.screenRect.height),x$cb.mainContext.enable(3089)):(x$cb.mainContext.disable(3089),x$Rb.worldScissorTest=!1),x$E.copyFrom(this.screenRect),!0},x$b.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},x$b.getRenderType=function(){return 0},x$b.releaseRender=function(){var x$b=x$s._cache;(x$b[x$b._length++]=this).context=null},x$s.create=function(x$b){var x$_=x$s._cache._length?x$s._cache[--x$s._cache._length]:new x$s;return x$_.context=x$b,x$_},x$s._cache=((x$s._cache=[])._length=0,x$s._cache),x$s}(),x$fb=function(){function x$O(){this.step=0,this.blendMode=null,this.level=0}x$P(x$O,"laya.webgl.submit.SubmitStencil");var x$b=x$O.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},x$b.getRenderType=function(){return 0},x$b.releaseRender=function(){var x$b=x$O._cache;x$b[x$b._length++]=this},x$b.do1=function(){var x$b=x$cb.mainContext;x$b.enable(2960),x$b.clear(1024),x$b.colorMask(!1,!1,!1,!1),x$b.stencilFunc(514,this.level,255),x$b.stencilOp(7680,7680,7682)},x$b.do2=function(){var x$b=x$cb.mainContext;x$b.stencilFunc(514,this.level+1,255),x$b.colorMask(!0,!0,!0,!0),x$b.stencilOp(7680,7680,7680)},x$b.do3=function(){var x$b=x$cb.mainContext;x$b.colorMask(!0,!0,!0,!0),x$b.stencilOp(7680,7680,7680),x$b.clear(1024),x$b.disable(2960)},x$b.do4=function(){var x$b=x$cb.mainContext;0==this.level&&(x$b.enable(2960),x$b.clear(1024)),x$b.colorMask(!1,!1,!1,!1),x$b.stencilFunc(519,0,255),x$b.stencilOp(7680,7680,7682)},x$b.do5=function(){var x$b=x$cb.mainContext;x$b.stencilFunc(514,this.level,255),x$b.colorMask(!0,!0,!0,!0),x$b.stencilOp(7680,7680,7680)},x$b.do6=function(){var x$b=x$cb.mainContext;x$F.targetFns[x$F.TOINT[this.blendMode]](x$b)},x$b.do7=function(){var x$b=x$cb.mainContext;x$b.colorMask(!1,!1,!1,!1),x$b.stencilOp(7680,7680,7683)},x$b.do8=function(){var x$b=x$cb.mainContext;x$b.colorMask(!0,!0,!0,!0),x$b.stencilFunc(514,this.level,255),x$b.stencilOp(7680,7680,7680)},x$O.restore=function(x$b,x$_,x$s,x$h,x$x){var x$n;if((x$b._renderKey=0)<x$O._mask&&x$O._mask--,0==x$O._mask)x$n=laya.webgl.submit.SubmitStencil.create(3),x$b.addRenderObject(x$n),x$b._curSubmit=x$nb.RENDERBASE;else{x$n=laya.webgl.submit.SubmitStencil.create(7),x$b.addRenderObject(x$n);var x$E=x$b._vb;x$E._byteLength;if(x$wb.fillRectImgVb(x$E,null,x$_.x,x$_.y,x$_.width,x$_.height,x$U.DEF_UV,x$s,x$h,x$x,0,0)){x$b._shader2D.glTexture=null;var x$C=x$b._curSubmit=x$nb.createSubmit(x$b,x$b._ib,x$E,(x$E._byteLength-64)/32*3,x$Mb.create(2,0));x$C.shaderValue.ALPHA=1,x$b._submits[x$b._submits._length++]=x$C,x$b._curSubmit._numEle+=6,x$b._curSubmit=x$nb.RENDERBASE}else alert("clipRect calc stencil rect error");x$n=laya.webgl.submit.SubmitStencil.create(8),x$b.addRenderObject(x$n)}},x$O.restore2=function(x$b,x$_){var x$s;(x$b._renderKey=0)<x$O._mask&&x$O._mask--,0==x$O._mask?(x$s=laya.webgl.submit.SubmitStencil.create(3),x$b.addRenderObject(x$s),x$b._curSubmit=x$nb.RENDERBASE):(x$s=laya.webgl.submit.SubmitStencil.create(7),x$b.addRenderObject(x$s),x$b._submits[x$b._submits._length++]=x$_,x$s=laya.webgl.submit.SubmitStencil.create(8),x$b.addRenderObject(x$s))},x$O.create=function(x$b){var x$_=x$O._cache._length?x$O._cache[--x$O._cache._length]:new x$O;return 5==(x$_.step=x$b)&&++x$O._mask,x$_.level=x$O._mask,x$_},x$O._cache=((x$O._cache=[])._length=0,x$O._cache),x$O._mask=0,x$O}(),x$pb=function(){function x$C(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}x$P(x$C,"laya.webgl.submit.SubmitTarget");var x$b=x$C.prototype;return x$D.imps(x$b,{"laya.webgl.submit.ISubmit":!0}),x$b.renderSubmit=function(){this._vb.bind_upload(this._ib);var x$b=this.scope.getValue(this.proName);return x$b&&(this.shaderValue.texture=x$b.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[x$b.width,x$b.height]),this.shaderValue.upload(),this.blend(),x$J.drawCall++,x$J.trianglesFaces+=this._numEle/3,x$cb.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},x$b.blend=function(){if(x$F.activeBlendFunction!==x$F.fns[this.blendType]){var x$b=x$cb.mainContext;x$b.enable(3042),x$F.fns[this.blendType](x$b),x$F.activeBlendFunction=x$F.fns[this.blendType]}},x$b.getRenderType=function(){return 0},x$b.releaseRender=function(){var x$b=x$C._cache;(x$b[x$b._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},x$C.create=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$C._cache._length?x$C._cache[--x$C._cache._length]:new x$C;return x$E._ib=x$_,x$E._vb=x$s,x$E.proName=x$n,x$E._startIdx=x$h*x$yb.BYTES_PIDX,x$E._numEle=0,x$E.blendType=x$b._nBlendType,x$E.shaderValue=x$x,x$E.shaderValue.setValue(x$b._shader2D),x$E},x$C._cache=((x$C._cache=[])._length=0,x$C._cache),x$C}(),x$Pb=function(){function x$b(){this._sourceStr=null}x$P(x$b,"laya.webgl.text.CharSegment");var x$_=x$b.prototype;return x$D.imps(x$_,{"laya.webgl.text.ICharSegment":!0}),x$_.textToSpit=function(x$b){this._sourceStr=x$b},x$_.getChar=function(x$b){return this._sourceStr.charAt(x$b)},x$_.getCharCode=function(x$b){return this._sourceStr.charCodeAt(x$b)},x$_.length=function(){return this._sourceStr.length},x$b}(),x$Vb=function(){var x$b;function x$J(){}return x$P(x$J,"laya.webgl.text.DrawText"),x$J.__init__=function(){x$J._charsTemp=new Array,x$J._drawValue=new x$b,x$J._charSeg=new x$Pb},x$J.customCharSeg=function(x$b){x$J._charSeg=x$b},x$J.getChar=function(x$b,x$_,x$s){var x$h=x$lb.createOneChar(x$b,x$s);return-1!=x$_&&(x$J._charsCache[x$_]=x$h),x$h},x$J._drawSlow=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P,x$V,x$Q){var x$y,x$w,x$i=x$J._drawValue.value(x$n,x$C,x$O,x$L,x$P,x$V,x$Q),x$R=0,x$t=0,x$c=x$J._charsTemp,x$$=0,x$D=NaN;if(x$h)for(x$c.length=x$h.length,x$R=0,x$t=x$h.length;x$R<x$t;x$R++)(x$w=x$h[x$R])&&(x$D=x$w.charNum+x$i.txtID,x$c[x$R]=x$y=x$J._charsCache[x$D]||x$J.getChar(x$w.char,x$D,x$i),x$y.active());else{var x$o=x$s instanceof laya.utils.WordText?x$s.toString():x$s;if(x$q.CharacterCache){x$J._charSeg.textToSpit(x$o);var x$M=x$J._charSeg.length();for(x$R=0,x$t=x$c.length=x$M;x$R<x$t;x$R++)x$D=x$J._charSeg.getCharCode(x$R)+x$i.txtID,x$c[x$R]=x$y=x$J._charsCache[x$D]||x$J.getChar(x$J._charSeg.getChar(x$R),x$D,x$i),x$y.active(),x$$+=x$y.cw}else x$c.length=0,(x$y=x$J.getChar(x$o,-1,x$i)).active(),x$$+=x$y.cw,x$c[0]=x$y}var x$r=0;null!==x$E&&"left"!==x$E&&(x$r=-("center"==x$E?x$$/2:x$$));var x$k,x$B,x$S=NaN,x$Z=0;if(x$h)for(x$R=0,x$t=x$c.length;x$R<x$t;x$R++)x$y=x$c[x$R],x$w=x$h[x$R],x$y&&x$w&&!x$y.isSpace&&(x$S=x$y.borderSize,x$k=x$y.texture,x$_._drawText(x$k,x$f+x$r+x$w.x*x$P-x$S,x$p+x$w.y*x$V-x$S,x$k.width,x$k.height,x$x,0,0,0,0));else{for(x$R=0,x$t=x$c.length;x$R<x$t;x$R++)(x$y=x$c[x$R])&&!x$y.isSpace&&(x$S=x$y.borderSize,x$k=x$y.texture,x$_._drawText(x$k,x$f+x$r-x$S,x$p-x$S,x$k.width,x$k.height,x$x,0,0,0,0),x$b&&((x$B=x$b[x$Z++])||(x$B=x$b[x$Z-1]=[]),x$B[0]=x$k,x$B[1]=x$r-x$S,x$B[2]=-x$S)),x$r+=x$y.cw;x$b&&(x$b.length=x$Z)}},x$J._drawFast=function(x$b,x$_,x$s,x$h,x$x){for(var x$n,x$E,x$C=0,x$O=x$b.length;x$C<x$O;x$C++)(x$n=(x$E=x$b[x$C])[0]).active(),x$_._drawText(x$n,x$h+x$E[1],x$x+x$E[2],x$n.width,x$n.height,x$s,0,0,0,0)},x$J.drawText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p){if(void 0===x$p&&(x$p=0),!(x$_&&0===x$_.length||x$s&&0===x$s.length)){var x$P=x$h.a,x$V=x$h.d;(0!==x$h.b||0!==x$h.c)&&(x$P=x$V=1);var x$Q=1!==x$P||1!==x$V;if(x$Q&&x$D.stage.transform){var x$y=x$D.stage.transform;x$Q=x$y.a===x$P&&x$y.d===x$V}else x$Q=!1;if(x$Q){var x$w=(x$h=x$h.copyTo(x$ob._tmpMatrix)).tx,x$i=x$h.ty;x$h.scale(1/x$P,1/x$V),x$h._checkTransform(),x$L*=x$P,x$f*=x$V,x$L+=x$w-x$h.tx,x$f+=x$i-x$h.ty}else x$P=x$V=1;if(x$s)x$J._drawSlow(null,x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$P,x$V,x$p);else{if(null===x$_.toUpperCase){var x$R=x$P+1e5*x$V,x$t=x$_;return void(x$t.changed||x$t.id!==x$R?(x$t.id=x$R,x$t.changed=!1,x$J._drawSlow(x$t.save,x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$P,x$V,x$p)):x$J._drawFast(x$t.save,x$b,x$h,x$L,x$f))}var x$c=x$_+x$x.toString()+x$E+x$C+x$O+x$P+x$V+x$n,x$$=x$J._textsCache[x$c];x$q.CharacterCache?x$$?x$J._drawFast(x$$,x$b,x$h,x$L,x$f):(x$J._textsCache.__length||(x$J._textsCache.__length=0),x$J._textsCache.__length>x$o.WebGLTextCacheCount&&((x$J._textsCache={}).__length=0,x$J._curPoolIndex=0),x$J._textCachesPool[x$J._curPoolIndex]?(x$$=x$J._textsCache[x$c]=x$J._textCachesPool[x$J._curPoolIndex]).length=0:x$J._textCachesPool[x$J._curPoolIndex]=x$$=x$J._textsCache[x$c]=[],x$J._textsCache.__length++,x$J._curPoolIndex++,x$J._drawSlow(x$$,x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$P,x$V,x$p)):x$J._drawSlow(x$$,x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$P,x$V,x$p)}}},x$J._charsTemp=null,x$J._textCachesPool=[],x$J._curPoolIndex=0,x$J._charsCache={},x$J._textsCache={},x$J._drawValue=null,x$J.d=[],x$J._charSeg=null,x$J.__init$=function(){x$b=function(){function x$O(){}return x$P(x$O,""),x$O.prototype.value=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this.font=x$b,this.fillColor=x$_,this.borderColor=x$s,this.lineWidth=x$h,this.scaleX=x$x,this.scaleY=x$n,this.underLine=x$E;var x$C=x$b.toString()+x$x+x$n+x$h+(x$_?x$_.toLowerCase():" ")+(x$s?x$s.toLowerCase():" ")+x$E;return this.txtID=x$O._keymap[x$C],this.txtID||(this.txtID=1e-7*++x$O._keymapCount,x$O._keymap[x$C]=this.txtID),this},x$O.clear=function(){x$O._keymap={},x$O._keymapCount=1},x$O._keymap={},x$O._keymapCount=1,x$O}()},x$J}(),x$Qb=function(){function x$x(x$b){this._index=0,this._size=14,this._italic=-2,x$x._cache2=x$x._cache2||[],this.setFont(x$b||"14px Arial")}x$P(x$x,"laya.webgl.text.FontInContext");var x$b=x$x.prototype;return x$b.setFont=function(x$b){var x$_=x$x._cache2[x$b];if(x$_)this._words=x$_[0],this._size=x$_[1];else{this._words=x$b.split(" ");for(var x$s=0,x$h=this._words.length;x$s<x$h;x$s++)if(0<this._words[x$s].indexOf("px")){this._index=x$s;break}this._size=parseInt(this._words[this._index]),x$x._cache2[x$b]=[this._words,this._size]}this._text=null,this._italic=-2},x$b.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},x$b.hasType=function(x$b){for(var x$_=0,x$s=this._words.length;x$_<x$s;x$_++)if(this._words[x$_]===x$b)return x$_;return-1},x$b.removeType=function(x$b){for(var x$_=0,x$s=this._words.length;x$_<x$s;x$_++)if(this._words[x$_]===x$b){this._words.splice(x$_,1),this._index>x$_&&this._index--;break}this._text=null,this._italic=-2},x$b.copyTo=function(x$b){return x$b._text=this._text,x$b._size=this._size,x$b._index=this._index,x$b._words=this._words.slice(),x$b._italic=-2,x$b},x$b.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},x$h(0,x$b,"size",function(){return this._size},function(x$b){this._size=x$b,this._words[this._index]=x$b+"px",this._text=null}),x$x.create=function(x$b){var x$_=x$x._cache[x$b];return x$_||(x$_=x$x._cache[x$b]=new x$x(x$b))},x$x.EMPTY=new x$x,x$x._cache={},x$x._cache2=null,x$x}(),x$yb=function(){function x$b(){}return x$P(x$b,"laya.webgl.utils.CONST3D2D"),x$b.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x$b.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],x$b.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],x$b._TMPARRAY=[],x$b._OFFSETX=0,x$b._OFFSETY=0,x$E(x$b,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),x$b}(),x$wb=function(){function x$Q(){}return x$P(x$Q,"laya.webgl.utils.GlUtils"),x$Q.make2DProjection=function(x$b,x$_,x$s){return[2/x$b,0,0,0,0,-2/x$_,0,0,0,0,2/x$s,0,-1,1,0,1]},x$Q.fillIBQuadrangle=function(x$b,x$_){if(65535/4<x$_)throw Error("IBQuadrangle count:"+x$_+" must<:"+Math.floor(65535/4));x$_=Math.floor(x$_),x$b._resizeBuffer(6*(x$_+1)*2,!1),x$b.byteLength=x$b.bufferLength;for(var x$s=x$b.getUint16Array(),x$h=0,x$x=0;x$x<x$_;x$x++)x$s[x$h++]=4*x$x,x$s[x$h++]=4*x$x+2,x$s[x$h++]=4*x$x+1,x$s[x$h++]=4*x$x,x$s[x$h++]=4*x$x+3,x$s[x$h++]=4*x$x+2;return x$b.setNeedUpload(),!0},x$Q.expandIBQuadrangle=function(x$b,x$_){x$b.bufferLength>=6*x$_*2||x$Q.fillIBQuadrangle(x$b,x$_)},x$Q.mathCeilPowerOfTwo=function(x$b){return x$b--,x$b|=x$b>>1,x$b|=x$b>>2,x$b|=x$b>>4,x$b|=x$b>>8,x$b|=x$b>>16,++x$b},x$Q.fillQuadrangleImgVb=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=16+(x$b._byteLength>>2);x$b.byteLength=x$O<<2;var x$L=x$b.getFloat32Array();x$L[(x$O-=16)+2]=x$x[0],x$L[x$O+3]=x$x[1],x$L[x$O+6]=x$x[2],x$L[x$O+7]=x$x[3],x$L[x$O+10]=x$x[4],x$L[x$O+11]=x$x[5],x$L[x$O+14]=x$x[6],x$L[x$O+15]=x$x[7];var x$f=x$n.a,x$p=x$n.b,x$P=x$n.c,x$V=x$n.d;if(1!==x$f||0!==x$p||0!==x$P||1!==x$V){x$n.bTransform=!0;var x$Q=x$n.tx+x$E,x$y=x$n.ty+x$C;x$L[x$O]=(x$h[0]+x$_)*x$f+(x$h[1]+x$s)*x$P+x$Q,x$L[x$O+1]=(x$h[0]+x$_)*x$p+(x$h[1]+x$s)*x$V+x$y,x$L[x$O+4]=(x$h[2]+x$_)*x$f+(x$h[3]+x$s)*x$P+x$Q,x$L[x$O+5]=(x$h[2]+x$_)*x$p+(x$h[3]+x$s)*x$V+x$y,x$L[x$O+8]=(x$h[4]+x$_)*x$f+(x$h[5]+x$s)*x$P+x$Q,x$L[x$O+9]=(x$h[4]+x$_)*x$p+(x$h[5]+x$s)*x$V+x$y,x$L[x$O+12]=(x$h[6]+x$_)*x$f+(x$h[7]+x$s)*x$P+x$Q,x$L[x$O+13]=(x$h[6]+x$_)*x$p+(x$h[7]+x$s)*x$V+x$y}else x$n.bTransform=!1,x$_+=x$n.tx+x$E,x$s+=x$n.ty+x$C,x$L[x$O]=x$_+x$h[0],x$L[x$O+1]=x$s+x$h[1],x$L[x$O+4]=x$_+x$h[2],x$L[x$O+5]=x$s+x$h[3],x$L[x$O+8]=x$_+x$h[4],x$L[x$O+9]=x$s+x$h[5],x$L[x$O+12]=x$_+x$h[6],x$L[x$O+13]=x$s+x$h[7];return x$b._upload=!0},x$Q.fillTranglesVB=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C=(x$b._byteLength>>2)+x$h.length;x$b.byteLength=x$C<<2;var x$O=x$b.getFloat32Array();x$C-=x$h.length;for(var x$L=x$h.length,x$f=x$x.a,x$p=x$x.b,x$P=x$x.c,x$V=x$x.d,x$Q=0;x$Q<x$L;x$Q+=4)if(x$O[x$C+x$Q+2]=x$h[x$Q+2],x$O[x$C+x$Q+3]=x$h[x$Q+3],1!==x$f||0!==x$p||0!==x$P||1!==x$V){x$x.bTransform=!0;var x$y=x$x.tx+x$n,x$w=x$x.ty+x$E;x$O[x$C+x$Q]=(x$h[x$Q]+x$_)*x$f+(x$h[x$Q+1]+x$s)*x$P+x$y,x$O[x$C+x$Q+1]=(x$h[x$Q]+x$_)*x$p+(x$h[x$Q+1]+x$s)*x$V+x$w}else x$x.bTransform=!1,x$_+=x$x.tx+x$n,x$s+=x$x.ty+x$E,x$O[x$C+x$Q]=x$_+x$h[x$Q],x$O[x$C+x$Q+1]=x$s+x$h[x$Q+1];return x$b._upload=!0},x$Q.copyPreImgVb=function(x$b,x$_,x$s){var x$h=x$b._byteLength>>2;x$b.byteLength=x$h+16<<2;for(var x$x=x$b.getFloat32Array(),x$n=0,x$E=x$h-16;x$n<4;x$n++)x$x[x$h]=x$x[x$E]+x$_,++x$E,x$x[++x$h]=x$x[x$E]+x$s,++x$E,x$x[++x$h]=x$x[x$E],++x$E,x$x[++x$h]=x$x[x$E],++x$h,++x$E;x$b._upload=!0},x$Q.fillRectImgVb=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P){void 0===x$P&&(x$P=!1);var x$V,x$Q,x$y,x$w,x$i,x$R,x$t,x$c,x$$,x$D,x$o,x$M,x$r,x$k,x$B,x$S,x$Z=1,x$J=x$C.a,x$W=x$C.b,x$T=x$C.c,x$q=x$C.d,x$U=x$_&&x$_.width<99999999;if(1!==x$J||0!==x$W||0!==x$T||1!==x$q?(x$C.bTransform=!0,0===x$W&&0===x$T&&(x$Z=23,x$$=x$x+x$s,x$D=x$n+x$h,x$V=x$J*x$s+(x$o=x$C.tx+x$O),x$y=x$J*x$$+x$o,x$Q=x$q*x$h+(x$M=x$C.ty+x$L),x$w=x$q*x$D+x$M)):(x$Z=23,x$C.bTransform=!1,x$y=(x$V=x$s+x$C.tx+x$O)+x$x,x$w=(x$Q=x$h+x$C.ty+x$L)+x$n),x$U&&(x$i=x$_.x,x$R=x$_.y,x$t=x$_.width+x$i,x$c=x$_.height+x$R),1!==x$Z){if(Math.min(x$V,x$y)>=x$t)return!1;if(Math.min(x$Q,x$w)>=x$c)return!1;if(Math.max(x$y,x$V)<=x$i)return!1;if(Math.max(x$w,x$Q)<=x$R)return!1}var x$G=x$b._byteLength>>2;x$b.byteLength=16+x$G<<2;var x$z=x$b.getFloat32Array();switch(x$z[2+x$G]=x$E[0],x$z[3+x$G]=x$E[1],x$z[6+x$G]=x$E[2],x$z[7+x$G]=x$E[3],x$z[10+x$G]=x$E[4],x$z[11+x$G]=x$E[5],x$z[14+x$G]=x$E[6],x$z[15+x$G]=x$E[7],x$Z){case 1:x$o=x$C.tx+x$O,x$M=x$C.ty+x$L;var x$a=x$J*x$s,x$K=x$T*x$h,x$d=x$q*x$h,x$I=x$W*x$s,x$g=x$J*(x$$=x$x+x$s),x$F=x$T*(x$D=x$n+x$h),x$A=x$q*x$D,x$u=x$W*x$$;x$P?(x$r=x$a+x$K+x$o,x$B=Math.round(x$r)-x$r,x$k=x$d+x$I+x$M,x$S=Math.round(x$k)-x$k,x$z[x$G]=x$r+x$B,x$z[1+x$G]=x$k+x$S,x$z[4+x$G]=x$g+x$K+x$o+x$B,x$z[5+x$G]=x$d+x$u+x$M+x$S,x$z[8+x$G]=x$g+x$F+x$o+x$B,x$z[9+x$G]=x$A+x$u+x$M+x$S,x$z[12+x$G]=x$a+x$F+x$o+x$B,x$z[13+x$G]=x$A+x$I+x$M+x$S):(x$z[x$G]=x$a+x$K+x$o,x$z[1+x$G]=x$d+x$I+x$M,x$z[4+x$G]=x$g+x$K+x$o,x$z[5+x$G]=x$d+x$u+x$M,x$z[8+x$G]=x$g+x$F+x$o,x$z[9+x$G]=x$A+x$u+x$M,x$z[12+x$G]=x$a+x$F+x$o,x$z[13+x$G]=x$A+x$I+x$M);break;case 23:x$P?(x$r=x$V+x$f,x$B=Math.round(x$r)-x$r,x$k=x$Q,x$S=Math.round(x$k)-x$k,x$z[x$G]=x$r+x$B,x$z[1+x$G]=x$k+x$S,x$z[4+x$G]=x$y+x$f+x$B,x$z[5+x$G]=x$Q+x$S,x$z[8+x$G]=x$y+x$B,x$z[9+x$G]=x$w+x$S,x$z[12+x$G]=x$V+x$B,x$z[13+x$G]=x$w+x$S):(x$z[x$G]=x$V+x$f,x$z[1+x$G]=x$Q,x$z[4+x$G]=x$y+x$f,x$z[5+x$G]=x$Q,x$z[8+x$G]=x$y,x$z[9+x$G]=x$w,x$z[12+x$G]=x$V,x$z[13+x$G]=x$w)}return x$b._upload=!0},x$Q.fillLineVb=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=.5*x$E,x$L=x$Q._fillLineArray,x$f=-(x$h-x$n),x$p=x$s-x$x,x$P=Math.sqrt(x$f*x$f+x$p*x$p);x$f/=x$P,x$p/=x$P,x$f*=x$O,x$p*=x$O,x$L[0]=x$s-x$f,x$L[1]=x$h-x$p,x$L[4]=x$s+x$f,x$L[5]=x$h+x$p,x$L[8]=x$x+x$f,x$L[9]=x$n+x$p,x$L[12]=x$x-x$f,x$L[13]=x$n-x$p,x$C&&x$C.transformPointArray(x$L,x$L);var x$V=16+(x$b._byteLength>>2);return x$b.byteLength=x$V<<2,x$b.insertData(x$L,x$V-16),!0},x$Q._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x$Q}(),x$ib=(function(){function x$O(){}x$P(x$O,"laya.webgl.utils.MatirxArray"),x$O.ArrayMul=function(x$b,x$_,x$s){if(x$b)if(x$_)for(var x$h=NaN,x$x=NaN,x$n=NaN,x$E=NaN,x$C=0;x$C<4;x$C++)x$h=x$b[x$C],x$x=x$b[x$C+4],x$n=x$b[x$C+8],x$E=x$b[x$C+12],x$s[x$C]=x$h*x$_[0]+x$x*x$_[1]+x$n*x$_[2]+x$E*x$_[3],x$s[x$C+4]=x$h*x$_[4]+x$x*x$_[5]+x$n*x$_[6]+x$E*x$_[7],x$s[x$C+8]=x$h*x$_[8]+x$x*x$_[9]+x$n*x$_[10]+x$E*x$_[11],x$s[x$C+12]=x$h*x$_[12]+x$x*x$_[13]+x$n*x$_[14]+x$E*x$_[15];else x$O.copyArray(x$b,x$s);else x$O.copyArray(x$_,x$s)},x$O.copyArray=function(x$b,x$_){if(x$b&&x$_)for(var x$s=0;x$s<x$b.length;x$s++)x$_[x$s]=x$b[x$s]}}(),function(){function x$_(x$b,x$_,x$s){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=x$b,this._vb=new x$jb(x$b,35048),x$_&&this._vb._resizeBuffer(x$_,!1),this._ib=new x$Hb,x$s&&this._ib._resizeBuffer(x$s,!1)}x$P(x$_,"laya.webgl.utils.Mesh2D");var x$b=x$_.prototype;return x$b.cloneWithNewVB=function(){var x$b=new x$_(this._stride,0,0);return x$b._ib=this._ib,x$b._quadNum=this._quadNum,x$b._attribInfo=this._attribInfo,x$b},x$b.cloneWithNewVBIB=function(){var x$b=new x$_(this._stride,0,0);return x$b._attribInfo=this._attribInfo,x$b},x$b.getVBW=function(){return this._vb.setNeedUpload(),this._vb},x$b.getVBR=function(){return this._vb},x$b.getIBR=function(){return this._ib},x$b.getIBW=function(){return this._ib.setNeedUpload(),this._ib},x$b.createQuadIB=function(x$b){this._quadNum=x$b,this._ib._resizeBuffer(6*x$b*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var x$_=this._ib.getUint16Array(),x$s=0,x$h=0,x$x=0;x$x<x$b;x$x++)x$_[x$s++]=x$h,x$_[x$s++]=x$h+2,x$_[x$s++]=x$h+1,x$_[x$s++]=x$h,x$_[x$s++]=x$h+3,x$_[x$s++]=x$h+2,x$h+=4;this._ib.setNeedUpload()},x$b.setAttributes=function(x$b){if(this._attribInfo=x$b,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},x$b.getEleNum=function(){return this._ib.getBuffer().byteLength/2},x$b.releaseMesh=function(){},x$b.destroy=function(){},x$b.clearVB=function(){this._vb.clear()},x$_._gvaoid=0,x$_}()),x$Rb=function(){function x$x(){}return x$P(x$x,"laya.webgl.utils.RenderState2D"),x$x.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},x$x.mat2MatArray=function(x$b,x$_){var x$s=x$b,x$h=x$_;return x$h[0]=x$s.a,x$h[1]=x$s.b,x$h[2]=x$x.EMPTYMAT4_ARRAY[2],x$h[3]=x$x.EMPTYMAT4_ARRAY[3],x$h[4]=x$s.c,x$h[5]=x$s.d,x$h[6]=x$x.EMPTYMAT4_ARRAY[6],x$h[7]=x$x.EMPTYMAT4_ARRAY[7],x$h[8]=x$x.EMPTYMAT4_ARRAY[8],x$h[9]=x$x.EMPTYMAT4_ARRAY[9],x$h[10]=x$x.EMPTYMAT4_ARRAY[10],x$h[11]=x$x.EMPTYMAT4_ARRAY[11],x$h[12]=x$s.tx,x$h[13]=x$s.ty,x$h[14]=x$x.EMPTYMAT4_ARRAY[14],x$h[15]=x$x.EMPTYMAT4_ARRAY[15],x$_},x$x.restoreTempArray=function(){x$x.TEMPMAT4_ARRAY[0]=1,x$x.TEMPMAT4_ARRAY[1]=0,x$x.TEMPMAT4_ARRAY[4]=0,x$x.TEMPMAT4_ARRAY[5]=1,x$x.TEMPMAT4_ARRAY[12]=0,x$x.TEMPMAT4_ARRAY[13]=0},x$x.clear=function(){x$x.worldScissorTest=!1,x$x.worldShaderDefines=null,x$x.worldFilters=null,x$x.worldAlpha=1,x$x.worldClipRect.x=x$x.worldClipRect.y=0,x$x.worldClipRect.width=x$x.width,x$x.worldClipRect.height=x$x.height,x$x.curRenderTarget=null},x$x._MAXSIZE=99999999,x$x.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x$x.worldMatrix4=x$x.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x$x.worldAlpha=1,x$x.worldScissorTest=!1,x$x.worldFilters=null,x$x.worldShaderDefines=null,x$x.curRenderTarget=null,x$x.width=0,x$x.height=0,x$E(x$x,["worldMatrix",function(){return this.worldMatrix=new x$r},"worldClipRect",function(){return this.worldClipRect=new x$B(0,0,99999999,99999999)}]),x$x}(),x$tb=function(){var x$R,x$s;function x$t(x$b,x$_,x$s,x$h,x$x){var x$n=this;function x$E(x$b){var x$_=[],x$s=new x$R(x$_);return x$n._compileToTree(x$s,x$b.split("\n"),0,x$_,x$x),x$s}var x$C=x$V.now();this._VS=x$E(x$_),this._PS=x$E(x$s),this._nameMap=x$h,2<x$V.now()-x$C&&console.log("ShaderCompile use time:"+(x$V.now()-x$C)+"  size:"+x$_.length+"/"+x$s.length)}x$P(x$t,"laya.webgl.utils.ShaderCompile");var x$b=x$t.prototype;return x$b._compileToTree=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P=0,x$V=0,x$Q=0,x$y=0;for(x$V=x$s;x$V<x$_.length;x$V++)if(!((x$C=x$_[x$V]).length<1)&&0!==(x$P=x$C.indexOf("//"))){if(0<=x$P&&(x$C=x$C.substr(0,x$P)),x$n=x$p||new x$R(x$h),x$p=null,x$n.text=x$C,x$n.noCompile=!0,0<=(x$P=x$C.indexOf("#"))){for(x$O="#",x$y=x$P+1,x$Q=x$C.length;x$y<x$Q;x$y++){var x$w=x$C.charAt(x$y);if(" "===x$w||"\t"===x$w||"\r"===x$w||"\n"===x$w||"?"===x$w)break;x$O+=x$w}switch(x$n.name=x$O){case"#ifdef":case"#ifndef":if(x$n.src=x$C,x$n.noCompile=null!=x$C.match(/[!&|()=<>]/),x$n.noCompile?console.log("function():Boolean{return "+x$C.substr(x$P+x$n.name.length)+"}"):(x$f=x$C.replace(/^\s*/,"").split(/\s+/),x$n.setCondition(x$f[1],"#ifdef"===x$O?1:2),x$n.text="//"+x$n.text),x$n.setParent(x$b),x$b=x$n,x$x)for(x$f=x$C.substr(x$y).split(x$t._splitToWordExps3),x$y=0;x$y<x$f.length;x$y++)(x$C=x$f[x$y]).length&&(x$x[x$C]=!0);continue;case"#if":if(x$n.src=x$C,x$n.noCompile=!0,x$n.setParent(x$b),x$b=x$n,x$x)for(x$f=x$C.substr(x$y).split(x$t._splitToWordExps3),x$y=0;x$y<x$f.length;x$y++)(x$C=x$f[x$y]).length&&"defined"!=x$C&&(x$x[x$C]=!0);continue;case"#else":x$n.src=x$C,x$E=(x$b=x$b.parent).childs[x$b.childs.length-1],x$n.noCompile=x$E.noCompile,x$n.noCompile||(x$n.condition=x$E.condition,x$n.conditionType=1==x$E.conditionType?2:1,x$n.text="//"+x$n.text+" "+x$E.text+" "+x$n.conditionType),x$n.setParent(x$b),x$b=x$n;continue;case"#endif":x$E=(x$b=x$b.parent).childs[x$b.childs.length-1],x$n.noCompile=x$E.noCompile,x$n.noCompile||(x$n.text="//"+x$n.text),x$n.setParent(x$b);continue;case"#include":x$f=x$t.splitToWords(x$C,null);var x$i=x$t.includes[x$f[1]];if(!x$i)throw"ShaderCompile error no this include file:"+x$f[1];if((x$P=x$f[0].indexOf("?"))<0){x$n.setParent(x$b),x$C=x$i.getWith("with"==x$f[2]?x$f[3]:null),this._compileToTree(x$n,x$C.split("\n"),0,x$h,x$x),x$n.text="";continue}x$n.setCondition(x$f[0].substr(x$P+1),1),x$n.text=x$i.getWith("with"==x$f[2]?x$f[3]:null);break;case"#import":x$L=(x$f=x$t.splitToWords(x$C,null))[1],x$h.push({node:x$n,file:x$t.includes[x$L],ofs:x$n.text.length});continue}}else{if((x$E=x$b.childs[x$b.childs.length-1])&&!x$E.name){0<x$h.length&&x$t.splitToWords(x$C,x$E),x$p=x$n,x$E.text+="\n"+x$C;continue}0<x$h.length&&x$t.splitToWords(x$C,x$n)}x$n.setParent(x$b)}},x$b.createShader=function(x$b,x$_,x$s){var x$h={},x$x="";if(x$b)for(var x$n in x$b)x$x+="#define "+x$n+"\n",x$h[x$n]=!0;var x$E=this._VS.toscript(x$h,[]),x$C=this._PS.toscript(x$h,[]);return(x$s||x$Yb.create)(x$x+x$E.join("\n"),x$x+x$C.join("\n"),x$_,this._nameMap)},x$t._parseOne=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E={type:x$t.shaderParamsMap[x$s[x$h+1]],name:x$s[x$h+2],size:isNaN(parseInt(x$s[x$h+3]))?1:parseInt(x$s[x$h+3])};return x$n&&("attribute"==x$x?x$b.push(x$E):x$_.push(x$E)),":"==x$s[x$h+3]&&(x$E.type=x$s[x$h+4],x$h+=2),x$h+=2},x$t.addInclude=function(x$b,x$_){if(!x$_||0===x$_.length)throw new Error("add shader include file err:"+x$b);if(x$t.includes[x$b])throw new Error("add shader include file err, has add:"+x$b);x$t.includes[x$b]=new x$s(x$_)},x$t.preGetParams=function(x$b,x$_){var x$s=[x$b,x$_],x$h={},x$x=[],x$n=[],x$E={},x$C=[];x$h.attributes=x$x,x$h.uniforms=x$n,x$h.defines=x$E;for(var x$O=0,x$L=0,x$f=0;x$f<2;x$f++){x$s[x$f]=x$s[x$f].replace(x$t._removeAnnotation,"");var x$p,x$P=x$s[x$f].match(x$t._reg);for(x$O=0,x$L=x$P.length;x$O<x$L;x$O++){var x$V=x$P[x$O];if("attribute"==x$V||"uniform"==x$V)x$O=x$t._parseOne(x$x,x$n,x$P,x$O,x$V,!0);else{if("#define"==x$V){x$C[x$V=x$P[++x$O]]=1;continue}if("#ifdef"==x$V){x$E[x$p=x$P[++x$O]]=x$E[x$p]||[];for(x$O++;x$O<x$L;x$O++)if("attribute"==(x$V=x$P[x$O])||"uniform"==x$V)x$O=x$t._parseOne(x$x,x$n,x$P,x$O,x$V,x$C[x$p]);else if("#else"==x$V)for(x$O++;x$O<x$L;x$O++)if("attribute"==(x$V=x$P[x$O])||"uniform"==x$V)x$O=x$t._parseOne(x$x,x$n,x$P,x$O,x$V,!x$C[x$p]);else if("#endif"==x$V)break}}}}return x$h},x$t.splitToWords=function(x$b,x$_){for(var x$s,x$h,x$x=[],x$n=-1,x$E=0,x$C=x$b.length;x$E<x$C;x$E++)if(x$s=x$b.charAt(x$E),0<=" \t=+-*/&%!<>()'\",;".indexOf(x$s)){if(0<=x$n&&1<x$E-x$n&&(x$h=x$b.substr(x$n,x$E-x$n),x$x.push(x$h)),'"'==x$s||"'"==x$s){var x$O=x$b.indexOf(x$s,x$E+1);if(x$O<0)throw"Sharder err:"+x$b;x$x.push(x$b.substr(x$E+1,x$O-x$E-1)),x$E=x$O,x$n=-1;continue}"("==x$s&&x$_&&0<x$x.length&&(x$h=x$x[x$x.length-1]+";","vec4;main;".indexOf(x$h)<0&&(x$_.useFuns+=x$h)),x$n=-1}else x$n<0&&(x$n=x$E);return x$n<x$C&&1<x$C-x$n&&(x$h=x$b.substr(x$n,x$C-x$n),x$x.push(x$h)),x$x},x$t.IFDEF_NO=0,x$t.IFDEF_YES=1,x$t.IFDEF_ELSE=2,x$t.IFDEF_PARENT=3,x$t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),x$t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),x$t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),x$t.includes={},x$E(x$t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),x$t.__init$=function(){x$R=function(){function x$s(x$b){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=x$b}x$P(x$s,"");var x$b=x$s.prototype;return x$b.setParent=function(x$b){x$b.childs.push(this),this.z=x$b.z+1,this.parent=x$b},x$b.setCondition=function(x$b,x$_){x$b&&(this.conditionType=x$_,x$b=x$b.replace(/(\s*$)/g,""),this.condition=function(){return this[x$b]},this.condition.__condition=x$b)},x$b.toscript=function(x$b,x$_){return this._toscript(x$b,x$_,++x$s.__id)},x$b._toscript=function(x$h,x$x,x$n){if(this.childs.length<1&&!this.text)return x$x;x$x.length;if(this.condition){var x$b=!!this.condition.call(x$h);if(2===this.conditionType&&(x$b=!x$b),!x$b)return x$x}if(this.text&&x$x.push(this.text),0<this.childs.length&&this.childs.forEach(function(x$b,x$_,x$s){x$b._toscript(x$h,x$x,x$n)}),0<this.includefiles.length&&0<this.useFuns.length)for(var x$_,x$s=0,x$E=this.includefiles.length;x$s<x$E;x$s++)this.includefiles[x$s].curUseID!=x$n&&0<(x$_=this.includefiles[x$s].file.getFunsScript(this.useFuns)).length&&(this.includefiles[x$s].curUseID=x$n,x$x[0]=x$_+x$x[0]);return x$x},x$s.__id=1,x$s}(),x$s=function(){function x$b(x$b){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=x$b;for(var x$_=0,x$s=0,x$h=0;!((x$_=x$b.indexOf("#begin",x$_))<0);){for(x$h=x$_+5;!((x$h=x$b.indexOf("#end",x$h))<0)&&"i"===x$b.charAt(x$h+4);)x$h+=5;if(x$h<0)throw"add include err,no #end:"+x$b;x$s=x$b.indexOf("\n",x$_);var x$x=x$t.splitToWords(x$b.substr(x$_,x$s-x$_),null);"code"==x$x[1]?this.codes[x$x[2]]=x$b.substr(x$s+1,x$h-x$s-1):"function"==x$x[1]&&(x$s=x$b.indexOf("function",x$_),x$s+="function".length,this.funs[x$x[3]]=x$b.substr(x$s+1,x$h-x$s-1),this.funnames+=x$x[3]+";"),x$_=x$h+1}}x$P(x$b,"");var x$_=x$b.prototype;return x$_.getWith=function(x$b){var x$_=x$b?this.codes[x$b]:this.script;if(!x$_)throw"get with error:"+x$b;return x$_},x$_.getFunsScript=function(x$b){var x$_="";for(var x$s in this.funs)0<=x$b.indexOf(x$s+";")&&(x$_+=this.funs[x$s]);return x$_},x$b}()},x$t}(),x$cb=function(){function x$E(){}return x$P(x$E,"laya.webgl.WebGL"),x$E._uint8ArraySlice=function(){for(var x$b=this.length,x$_=new Uint8Array(this.length),x$s=0;x$s<x$b;x$s++)x$_[x$s]=this[x$s];return x$_},x$E._float32ArraySlice=function(){for(var x$b=this.length,x$_=new Float32Array(this.length),x$s=0;x$s<x$b;x$s++)x$_[x$s]=this[x$s];return x$_},x$E._uint16ArraySlice=function(x$b){var x$_,x$s=arguments,x$h=0,x$x=0;if(0===x$s.length)for(x$h=this.length,x$_=new Uint16Array(x$h),x$x=0;x$x<x$h;x$x++)x$_[x$x]=this[x$x];else if(2===x$s.length){var x$n=x$s[0],x$E=x$s[1];if(x$n<x$E)for(x$h=x$E-x$n,x$_=new Uint16Array(x$h),x$x=x$n;x$x<x$E;x$x++)x$_[x$x-x$n]=this[x$x];else x$_=new Uint16Array(0)}return x$_},x$E.expandContext=function(){var x$b=x$x.prototype,x$_=CanvasRenderingContext2D.prototype;x$_.fillTrangles=x$b.fillTrangles,x$mb.__int__(null),x$_.setIBVB=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){void 0===x$O&&(x$O=0),void 0===x$L&&(x$L=0),null===x$s&&(this._ib=this._ib||x$Hb.QuadrangleIB,x$s=this._ib,x$wb.expandIBQuadrangle(x$s,x$h._byteLength/64+8)),this._setIBVB(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L)},x$_.fillTrangles=function(x$b,x$_,x$s,x$h,x$x){this._curMat=this._curMat||x$r.create(),this._vb=this._vb||x$jb.create(),this._ib||(this._ib=x$Hb.create(),x$wb.fillIBQuadrangle(this._ib,x$E/4));var x$n=this._vb,x$E=x$h.length>>4;x$wb.fillTranglesVB(x$n,x$_,x$s,x$h,x$x||this._curMat,0,0),x$wb.expandIBQuadrangle(this._ib,x$n._byteLength/64+8);var x$C=new x$Mb(1,0);x$C.textureHost=x$b;var x$O=new x$vb("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");x$n._vertType=3,this._setIBVB(x$_,x$s,this._ib,x$n,6*x$E,x$x,x$O,x$C,0,0)}},x$E.enable=function(){if(x$V.__init__(),x$i.isConchApp&&!x$i.isConchWebGL)return x$$.skinAniSprite=function(){return new x$bb},x$E.expandContext(),!1;if(x$$.getWebGLContext=function(x$b){for(var x$_,x$s=["webgl","experimental-webgl","webkit-3d","moz-webgl"],x$h=0;x$h<x$s.length;x$h++){try{x$_=x$b.getContext(x$s[x$h],{stencil:x$o.isStencil,alpha:x$o.isAlpha,antialias:x$o.isAntialias,premultipliedAlpha:x$o.premultipliedAlpha,preserveDrawingBuffer:x$o.preserveDrawingBuffer})}catch(x$b){}if(x$_)return x$_}return null},null==(x$E.mainContext=x$$.getWebGLContext(x$i._mainCanvas)))return!1;if(x$i.isWebGL)return!0;x$y.create=function(x$b,x$_){return new x$b_(x$b,x$_)},x$w.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){return new x$Xb(x$b,x$_,x$s,x$h,x$x,x$n,x$E)},x$i.WebGL=x$E,x$i.isWebGL=!0,x$Vb.__init__(),x$$.createRenderSprite=function(x$b,x$_){return new x$rb(x$b,x$_)},x$$.createWebGLContext2D=function(x$b){return new x$ob(x$b)},x$$.changeWebGLSize=function(x$b,x$_){laya.webgl.WebGL.onStageResize(x$b,x$_)},x$$.createGraphics=function(){return new x$Db};var x$b=x$$.createFilterAction;return x$$.createFilterAction=x$b||function(x$b){return new x$kb},x$$.clear=function(x$b){x$Rb.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var x$_=x$i.context.ctx,x$s=0==x$_._submits._length||x$o.preserveDrawingBuffer?x$Q.create(x$b)._color:x$Z._wgColor;x$s&&x$_.clearBG(x$s[0],x$s[1],x$s[2],x$s[3]),x$Rb.clear()},x$$.addToAtlas=function(x$b,x$_){void 0===x$_&&(x$_=!1);var x$s=x$b.bitmap;x$i.optimizeTextureMemory(x$b.url,x$b)?x$D.__typeof(x$s,"laya.webgl.resource.IMergeAtlasBitmap")&&x$s.allowMerageInAtlas&&x$s.on("recovered",x$b,x$b.addTextureToAtlas):x$s.enableMerageInAtlas=!1},x$$.isAtlas=function(x$b){return x$b instanceof laya.webgl.atlas.AtlasWebGLCanvas},x$I._enable(),x$$.beginFlush=function(){for(var x$b=x$I.instance,x$_=x$b.getAtlaserCount(),x$s=0;x$s<x$_;x$s++){var x$h=x$b.getAtlaserByIndex(x$s).texture;x$h._flashCacheImageNeedFlush&&x$$.flashFlushImage(x$h)}},x$$.drawToCanvas=function(x$b,x$_,x$s,x$h,x$x,x$n){(x$s<=0||x$h<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),x$s|=0,x$h|=0,x$x|=0,x$n|=0;var x$E=x$zb.create(x$s,x$h,6408,5121,0,!1);x$E.start(),x$E.clear(0,0,0,0),x$i.context.clear(),x$R.renders[x$_]._fun(x$b,x$i.context,x$x,x$Rb.height-x$h+x$n),x$i.context.flush(),x$E.end();var x$C=x$E.getData(0,0,x$s,x$h);if(x$E.recycle(),x$C.byteLength==x$s*x$h*4){var x$O=new x$ub;x$O._canvas=x$V.createElement("canvas"),x$O.size(x$s,x$h);var x$L=x$O._canvas.getContext("2d");x$V.canvas.size(x$s,x$h);var x$f=x$V.context,x$p=x$f.createImageData(x$s,x$h);return x$p.data.set(new Uint8ClampedArray(x$C.buffer)),x$O._imgData=x$p,x$f.putImageData(x$p,0,0),x$L.save(),x$L.translate(0,x$h),x$L.scale(1,-1),x$L.drawImage(x$V.canvas.source,0,0),x$L.restore(),x$O}console.log("drawToCanvas error: w:"+x$s+",h:"+x$h+",datalen:"+x$C.byteLength)},x$$.createFilterAction=function(x$b){var x$_;switch(x$b){case 32:x$_=new x$kb}return x$_},x$$.addTextureToAtlas=function(x$b){x$b._uvID++,x$I._atlasRestore++,x$b.bitmap.enableMerageInAtlas&&x$I.instance.addToAtlas(x$b)},x$$.getTexturePixels=function(x$b,x$_,x$s,x$h,x$x){x$i.context.ctx.clear();var x$n=new x$S;x$n.graphics.drawTexture(x$b,-x$_,-x$s);var x$E=x$zb.create(x$h,x$x);x$E.start(),x$E.clear(0,0,0,0),x$n.render(x$i.context,0,0),x$i.context.ctx.flush(),x$E.end();for(var x$C=x$E.getData(0,0,x$h,x$x),x$O=[],x$L=0,x$f=x$x-1;0<=x$f;x$f--)for(var x$p=0;x$p<x$h;x$p++)x$L=4*(x$f*x$h+x$p),x$O.push(x$C[x$L]),x$O.push(x$C[x$L+1]),x$O.push(x$C[x$L+2]),x$O.push(x$C[x$L+3]);return x$O},x$$.skinAniSprite=function(){return new x$bb},x$L.create=function(x$b,x$_){var x$s=new x$ub;return x$s._imgData=x$_,x$s.flipY=!1,x$s},x$M._filterStart=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$b.getValue("bounds"),x$E=x$zb.create(x$n.width,x$n.height);if(x$E.start(),x$E.clear(0,0,0,0),x$b.addValue("src",x$E),x$b.addValue("ScissorTest",x$Rb.worldScissorTest),x$Rb.worldScissorTest){var x$C=new x$B;x$C.copyFrom(x$s.ctx._clipRect),x$b.addValue("clipRect",x$C),x$Rb.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},x$M._filterEnd=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$b.getValue("bounds");x$b.getValue("src").end();var x$E=x$zb.create(x$n.width,x$n.height);x$E.start(),x$E.clear(0,0,0,0),x$b.addValue("out",x$E),x$_._set$P("_filterCache",x$E),x$_._set$P("_isHaveGlowFilter",x$b.getValue("_isHaveGlowFilter"))},x$M._EndTarget=function(x$b,x$_){if(x$b.getValue("src").recycle(),x$b.getValue("out").end(),x$b.getValue("ScissorTest")){x$Rb.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),x$_.ctx.save();var x$s=x$b.getValue("clipRect");x$_.ctx.clipRect(x$s.x,x$s.y,x$s.width,x$s.height)}},x$M._useSrc=function(x$b){var x$_=x$b.getValue("out");x$_.end(),(x$_=x$b.getValue("src")).start(),x$_.clear(0,0,0,0)},x$M._endSrc=function(x$b){x$b.getValue("src").end()},x$M._useOut=function(x$b){var x$_=x$b.getValue("src");x$_.end(),(x$_=x$b.getValue("out")).start(),x$_.clear(0,0,0,0)},x$M._endOut=function(x$b){x$b.getValue("out").end()},x$M._recycleScope=function(x$b){x$b.recycle()},x$M._filter=function(x$b,x$_,x$s,x$h){var x$x=this._next;if(x$x){var x$n,x$E,x$C=x$b.filters,x$O=x$C.length;if(1==x$O&&32==x$C[0].type)return x$_.ctx.save(),x$_.ctx.setFilters([x$C[0]]),x$x._fun.call(x$x,x$b,x$_,x$s,x$h),void x$_.ctx.restore();var x$L=x$Cb.create(),x$f=x$k.TEMP,x$p=x$_.ctx._getTransformMatrix(),x$P=x$r.create();x$p.copyTo(x$P);var x$V=0,x$Q=0,x$y=!1,x$w=x$b._$P._filterCache?x$b._$P._filterCache:null;if(!x$w||x$b._repaint){x$y=x$b._isHaveGlowFilter(),x$L.addValue("_isHaveGlowFilter",x$y),x$y&&(x$V=50,x$Q=25),(x$E=new x$B).copyFrom(x$b.getSelfBounds()),x$E.x+=x$b.x,x$E.y+=x$b.y,x$E.x-=x$b.pivotX+4,x$E.y-=x$b.pivotY+4;var x$i=x$E.x,x$R=x$E.y;if(x$E.width+=x$V+8,x$E.height+=x$V+8,x$f.x=x$E.x*x$P.a+x$E.y*x$P.c,x$f.y=x$E.y*x$P.d+x$E.x*x$P.b,x$E.x=x$f.x,x$E.y=x$f.y,x$f.x=x$E.width*x$P.a+x$E.height*x$P.c,x$f.y=x$E.height*x$P.d+x$E.width*x$P.b,x$E.width=x$f.x,x$E.height=x$f.y,x$E.width<=0||x$E.height<=0)return;x$w&&x$w.recycle(),x$L.addValue("bounds",x$E);var x$t=x$Eb.create([x$L,x$b,x$_,0,0],x$M._filterStart);x$_.addRenderObject(x$t),x$_.ctx._renderKey=0,x$_.ctx._shader2D.glTexture=null;var x$c=x$b.x-x$i+x$Q,x$$=x$b.y-x$R+x$Q;x$x._fun.call(x$x,x$b,x$_,x$c,x$$),x$t=x$Eb.create([x$L,x$b,x$_,0,0],x$M._filterEnd),x$_.addRenderObject(x$t);for(var x$D=0;x$D<x$O;x$D++){0!=x$D&&(x$t=x$Eb.create([x$L],x$M._useSrc),x$_.addRenderObject(x$t),x$n=x$Mb.create(1,0),x$r.TEMP.identity(),x$_.ctx.drawTarget(x$L,0,0,x$E.width,x$E.height,x$r.TEMP,"out",x$n,null,x$F.TOINT.overlay),x$t=x$Eb.create([x$L],x$M._useOut),x$_.addRenderObject(x$t)),x$C[x$D].action.apply3d(x$L,x$b,x$_,0,0)}x$t=x$Eb.create([x$L,x$_],x$M._EndTarget),x$_.addRenderObject(x$t)}else{if((x$y=!!x$b._$P._isHaveGlowFilter&&x$b._$P._isHaveGlowFilter)&&(x$V=50,x$Q=25),(x$E=x$b.getBounds()).width<=0||x$E.height<=0)return;x$E.width+=x$V,x$E.height+=x$V,x$f.x=x$E.x*x$P.a+x$E.y*x$P.c,x$f.y=x$E.y*x$P.d+x$E.x*x$P.b,x$E.x=x$f.x,x$E.y=x$f.y,x$f.x=x$E.width*x$P.a+x$E.height*x$P.c,x$f.y=x$E.height*x$P.d+x$E.width*x$P.b,x$E.width=x$f.x,x$E.height=x$f.y,x$L.addValue("out",x$w)}x$s=x$s-x$Q-x$b.x,x$h=x$h-x$Q-x$b.y,x$f.setTo(x$s,x$h),x$P.transformPoint(x$f),x$s=x$f.x+x$E.x,x$h=x$f.y+x$E.y,x$n=x$Mb.create(1,0),x$r.TEMP.identity(),x$_.ctx.drawTarget(x$L,x$s,x$h,x$E.width,x$E.height,x$r.TEMP,"out",x$n,null,x$F.TOINT.overlay),x$t=x$Eb.create([x$L],x$M._recycleScope),x$_.addRenderObject(x$t),x$P.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=x$E._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=x$E._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=x$E._uint8ArraySlice),!0},x$E.onStageResize=function(x$b,x$_){null!=x$E.mainContext&&(x$E.mainContext.viewport(0,0,x$b,x$_),x$Rb.width=x$b,x$Rb.height=x$_)},x$E.onInvalidGLRes=function(){x$I.instance.freeAll(),x$c.releaseContentManagers(!0),x$E.doNodeRepaint(x$D.stage),x$E.mainContext.viewport(0,0,x$Rb.width,x$Rb.height),x$D.stage.event("devicelost")},x$E.doNodeRepaint=function(x$b){0==x$b.numChildren&&x$b.repaint();for(var x$_=0;x$_<x$b.numChildren;x$_++)x$E.doNodeRepaint(x$b.getChildAt(x$_))},x$E.init=function(x$b,x$_,x$s){x$E.mainCanvas=x$b,x$L._createContext=function(x$b){return new x$ob(x$b)},x$ub._createContext=function(x$b){return new x$ob(x$b)};var x$h=laya.webgl.WebGL.mainContext;if(null!=x$h.getShaderPrecisionFormat){var x$x=x$h.getShaderPrecisionFormat(35633,36338),x$n=x$h.getShaderPrecisionFormat(35632,36338);x$E.shaderHighPrecision=!(!x$x.precision||!x$n.precision)}else x$E.shaderHighPrecision=!1;if(x$h.deleteTexture1=x$h.deleteTexture,x$h.deleteTexture=function(x$b){x$b==x$$b.curBindTexValue&&(x$$b.curBindTexValue=null),x$h.deleteTexture1(x$b)},x$E.onStageResize(x$_,x$s),null==x$E.mainContext)throw new Error("webGL getContext err!");x$T.__init__(),x$I.__init__(),x$Sb.__init__(),x$nb.__init__(),x$ob.__init__(),x$Mb.__init__(),x$H.__init__(),x$mb.__int__(x$h),x$F._init_(x$h),x$i.isConchApp&&conch.setOnInvalidGLRes(x$E.onInvalidGLRes)},x$E.mainCanvas=null,x$E.mainContext=null,x$E.antialias=!0,x$E.shaderHighPrecision=!1,x$E._bg_null=[0,0,0,0],x$E}(),x$$b=function(){function x$h(){}return x$P(x$h,"laya.webgl.WebGLContext"),x$h.UseProgram=function(x$b){return x$h._useProgram!==x$b&&(x$cb.mainContext.useProgram(x$b),x$h._useProgram=x$b,!0)},x$h.setDepthTest=function(x$b,x$_){x$_!==x$h._depthTest&&((x$h._depthTest=x$_)?x$b.enable(2929):x$b.disable(2929))},x$h.setDepthMask=function(x$b,x$_){x$_!==x$h._depthMask&&(x$h._depthMask=x$_,x$b.depthMask(x$_))},x$h.setDepthFunc=function(x$b,x$_){x$_!==x$h._depthFunc&&(x$h._depthFunc=x$_,x$b.depthFunc(x$_))},x$h.setBlend=function(x$b,x$_){x$_!==x$h._blend&&((x$h._blend=x$_)?x$b.enable(3042):x$b.disable(3042))},x$h.setBlendFunc=function(x$b,x$_,x$s){(x$_!==x$h._sFactor||x$s!==x$h._dFactor)&&(x$h._sFactor=x$_,x$h._dFactor=x$s,x$b.blendFunc(x$_,x$s))},x$h.setCullFace=function(x$b,x$_){x$_!==x$h._cullFace&&((x$h._cullFace=x$_)?x$b.enable(2884):x$b.disable(2884))},x$h.setFrontFace=function(x$b,x$_){x$_!==x$h._frontFace&&(x$h._frontFace=x$_,x$b.frontFace(x$_))},x$h.bindTexture=function(x$b,x$_,x$s){x$b.bindTexture(x$_,x$s),x$h.curBindTexTarget=x$_,x$h.curBindTexValue=x$s},x$h.DEPTH_BUFFER_BIT=256,x$h.STENCIL_BUFFER_BIT=1024,x$h.COLOR_BUFFER_BIT=16384,x$h.POINTS=0,x$h.LINES=1,x$h.LINE_LOOP=2,x$h.LINE_STRIP=3,x$h.TRIANGLES=4,x$h.TRIANGLE_STRIP=5,x$h.TRIANGLE_FAN=6,x$h.ZERO=0,x$h.ONE=1,x$h.SRC_COLOR=768,x$h.ONE_MINUS_SRC_COLOR=769,x$h.SRC_ALPHA=770,x$h.ONE_MINUS_SRC_ALPHA=771,x$h.DST_ALPHA=772,x$h.ONE_MINUS_DST_ALPHA=773,x$h.DST_COLOR=774,x$h.ONE_MINUS_DST_COLOR=775,x$h.SRC_ALPHA_SATURATE=776,x$h.FUNC_ADD=32774,x$h.BLEND_EQUATION=32777,x$h.BLEND_EQUATION_RGB=32777,x$h.BLEND_EQUATION_ALPHA=34877,x$h.FUNC_SUBTRACT=32778,x$h.FUNC_REVERSE_SUBTRACT=32779,x$h.BLEND_DST_RGB=32968,x$h.BLEND_SRC_RGB=32969,x$h.BLEND_DST_ALPHA=32970,x$h.BLEND_SRC_ALPHA=32971,x$h.CONSTANT_COLOR=32769,x$h.ONE_MINUS_CONSTANT_COLOR=32770,x$h.CONSTANT_ALPHA=32771,x$h.ONE_MINUS_CONSTANT_ALPHA=32772,x$h.BLEND_COLOR=32773,x$h.ARRAY_BUFFER=34962,x$h.ELEMENT_ARRAY_BUFFER=34963,x$h.ARRAY_BUFFER_BINDING=34964,x$h.ELEMENT_ARRAY_BUFFER_BINDING=34965,x$h.STREAM_DRAW=35040,x$h.STATIC_DRAW=35044,x$h.DYNAMIC_DRAW=35048,x$h.BUFFER_SIZE=34660,x$h.BUFFER_USAGE=34661,x$h.CURRENT_VERTEX_ATTRIB=34342,x$h.FRONT=1028,x$h.BACK=1029,x$h.CULL_FACE=2884,x$h.FRONT_AND_BACK=1032,x$h.BLEND=3042,x$h.DITHER=3024,x$h.STENCIL_TEST=2960,x$h.DEPTH_TEST=2929,x$h.SCISSOR_TEST=3089,x$h.POLYGON_OFFSET_FILL=32823,x$h.SAMPLE_ALPHA_TO_COVERAGE=32926,x$h.SAMPLE_COVERAGE=32928,x$h.NO_ERROR=0,x$h.INVALID_ENUM=1280,x$h.INVALID_VALUE=1281,x$h.INVALID_OPERATION=1282,x$h.OUT_OF_MEMORY=1285,x$h.CW=2304,x$h.CCW=2305,x$h.LINE_WIDTH=2849,x$h.ALIASED_POINT_SIZE_RANGE=33901,x$h.ALIASED_LINE_WIDTH_RANGE=33902,x$h.CULL_FACE_MODE=2885,x$h.FRONT_FACE=2886,x$h.DEPTH_RANGE=2928,x$h.DEPTH_WRITEMASK=2930,x$h.DEPTH_CLEAR_VALUE=2931,x$h.DEPTH_FUNC=2932,x$h.STENCIL_CLEAR_VALUE=2961,x$h.STENCIL_FUNC=2962,x$h.STENCIL_FAIL=2964,x$h.STENCIL_PASS_DEPTH_FAIL=2965,x$h.STENCIL_PASS_DEPTH_PASS=2966,x$h.STENCIL_REF=2967,x$h.STENCIL_VALUE_MASK=2963,x$h.STENCIL_WRITEMASK=2968,x$h.STENCIL_BACK_FUNC=34816,x$h.STENCIL_BACK_FAIL=34817,x$h.STENCIL_BACK_PASS_DEPTH_FAIL=34818,x$h.STENCIL_BACK_PASS_DEPTH_PASS=34819,x$h.STENCIL_BACK_REF=36003,x$h.STENCIL_BACK_VALUE_MASK=36004,x$h.STENCIL_BACK_WRITEMASK=36005,x$h.VIEWPORT=2978,x$h.SCISSOR_BOX=3088,x$h.COLOR_CLEAR_VALUE=3106,x$h.COLOR_WRITEMASK=3107,x$h.UNPACK_ALIGNMENT=3317,x$h.PACK_ALIGNMENT=3333,x$h.MAX_TEXTURE_SIZE=3379,x$h.MAX_VIEWPORT_DIMS=3386,x$h.SUBPIXEL_BITS=3408,x$h.RED_BITS=3410,x$h.GREEN_BITS=3411,x$h.BLUE_BITS=3412,x$h.ALPHA_BITS=3413,x$h.DEPTH_BITS=3414,x$h.STENCIL_BITS=3415,x$h.POLYGON_OFFSET_UNITS=10752,x$h.POLYGON_OFFSET_FACTOR=32824,x$h.TEXTURE_BINDING_2D=32873,x$h.SAMPLE_BUFFERS=32936,x$h.SAMPLES=32937,x$h.SAMPLE_COVERAGE_VALUE=32938,x$h.SAMPLE_COVERAGE_INVERT=32939,x$h.NUM_COMPRESSED_TEXTURE_FORMATS=34466,x$h.COMPRESSED_TEXTURE_FORMATS=34467,x$h.DONT_CARE=4352,x$h.FASTEST=4353,x$h.NICEST=4354,x$h.GENERATE_MIPMAP_HINT=33170,x$h.BYTE=5120,x$h.UNSIGNED_BYTE=5121,x$h.SHORT=5122,x$h.UNSIGNED_SHORT=5123,x$h.INT=5124,x$h.UNSIGNED_INT=5125,x$h.FLOAT=5126,x$h.DEPTH_COMPONENT=6402,x$h.ALPHA=6406,x$h.RGB=6407,x$h.RGBA=6408,x$h.LUMINANCE=6409,x$h.LUMINANCE_ALPHA=6410,x$h.UNSIGNED_SHORT_4_4_4_4=32819,x$h.UNSIGNED_SHORT_5_5_5_1=32820,x$h.UNSIGNED_SHORT_5_6_5=33635,x$h.FRAGMENT_SHADER=35632,x$h.VERTEX_SHADER=35633,x$h.MAX_VERTEX_ATTRIBS=34921,x$h.MAX_VERTEX_UNIFORM_VECTORS=36347,x$h.MAX_VARYING_VECTORS=36348,x$h.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,x$h.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,x$h.MAX_TEXTURE_IMAGE_UNITS=34930,x$h.MAX_FRAGMENT_UNIFORM_VECTORS=36349,x$h.SHADER_TYPE=35663,x$h.DELETE_STATUS=35712,x$h.LINK_STATUS=35714,x$h.VALIDATE_STATUS=35715,x$h.ATTACHED_SHADERS=35717,x$h.ACTIVE_UNIFORMS=35718,x$h.ACTIVE_ATTRIBUTES=35721,x$h.SHADING_LANGUAGE_VERSION=35724,x$h.CURRENT_PROGRAM=35725,x$h.NEVER=512,x$h.LESS=513,x$h.EQUAL=514,x$h.LEQUAL=515,x$h.GREATER=516,x$h.NOTEQUAL=517,x$h.GEQUAL=518,x$h.ALWAYS=519,x$h.KEEP=7680,x$h.REPLACE=7681,x$h.INCR=7682,x$h.DECR=7683,x$h.INVERT=5386,x$h.INCR_WRAP=34055,x$h.DECR_WRAP=34056,x$h.VENDOR=7936,x$h.RENDERER=7937,x$h.VERSION=7938,x$h.NEAREST=9728,x$h.LINEAR=9729,x$h.NEAREST_MIPMAP_NEAREST=9984,x$h.LINEAR_MIPMAP_NEAREST=9985,x$h.NEAREST_MIPMAP_LINEAR=9986,x$h.LINEAR_MIPMAP_LINEAR=9987,x$h.TEXTURE_MAG_FILTER=10240,x$h.TEXTURE_MIN_FILTER=10241,x$h.TEXTURE_WRAP_S=10242,x$h.TEXTURE_WRAP_T=10243,x$h.TEXTURE_2D=3553,x$h.TEXTURE=5890,x$h.TEXTURE_CUBE_MAP=34067,x$h.TEXTURE_BINDING_CUBE_MAP=34068,x$h.TEXTURE_CUBE_MAP_POSITIVE_X=34069,x$h.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,x$h.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,x$h.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,x$h.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,x$h.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,x$h.MAX_CUBE_MAP_TEXTURE_SIZE=34076,x$h.TEXTURE0=33984,x$h.TEXTURE1=33985,x$h.TEXTURE2=33986,x$h.TEXTURE3=33987,x$h.TEXTURE4=33988,x$h.TEXTURE5=33989,x$h.TEXTURE6=33990,x$h.TEXTURE7=33991,x$h.TEXTURE8=33992,x$h.TEXTURE9=33993,x$h.TEXTURE10=33994,x$h.TEXTURE11=33995,x$h.TEXTURE12=33996,x$h.TEXTURE13=33997,x$h.TEXTURE14=33998,x$h.TEXTURE15=33999,x$h.TEXTURE16=34e3,x$h.TEXTURE17=34001,x$h.TEXTURE18=34002,x$h.TEXTURE19=34003,x$h.TEXTURE20=34004,x$h.TEXTURE21=34005,x$h.TEXTURE22=34006,x$h.TEXTURE23=34007,x$h.TEXTURE24=34008,x$h.TEXTURE25=34009,x$h.TEXTURE26=34010,x$h.TEXTURE27=34011,x$h.TEXTURE28=34012,x$h.TEXTURE29=34013,x$h.TEXTURE30=34014,x$h.TEXTURE31=34015,x$h.ACTIVE_TEXTURE=34016,x$h.REPEAT=10497,x$h.CLAMP_TO_EDGE=33071,x$h.MIRRORED_REPEAT=33648,x$h.FLOAT_VEC2=35664,x$h.FLOAT_VEC3=35665,x$h.FLOAT_VEC4=35666,x$h.INT_VEC2=35667,x$h.INT_VEC3=35668,x$h.INT_VEC4=35669,x$h.BOOL=35670,x$h.BOOL_VEC2=35671,x$h.BOOL_VEC3=35672,x$h.BOOL_VEC4=35673,x$h.FLOAT_MAT2=35674,x$h.FLOAT_MAT3=35675,x$h.FLOAT_MAT4=35676,x$h.SAMPLER_2D=35678,x$h.SAMPLER_CUBE=35680,x$h.VERTEX_ATTRIB_ARRAY_ENABLED=34338,x$h.VERTEX_ATTRIB_ARRAY_SIZE=34339,x$h.VERTEX_ATTRIB_ARRAY_STRIDE=34340,x$h.VERTEX_ATTRIB_ARRAY_TYPE=34341,x$h.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,x$h.VERTEX_ATTRIB_ARRAY_POINTER=34373,x$h.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,x$h.COMPILE_STATUS=35713,x$h.LOW_FLOAT=36336,x$h.MEDIUM_FLOAT=36337,x$h.HIGH_FLOAT=36338,x$h.LOW_INT=36339,x$h.MEDIUM_INT=36340,x$h.HIGH_INT=36341,x$h.FRAMEBUFFER=36160,x$h.RENDERBUFFER=36161,x$h.RGBA4=32854,x$h.RGB5_A1=32855,x$h.RGB565=36194,x$h.DEPTH_COMPONENT16=33189,x$h.STENCIL_INDEX=6401,x$h.STENCIL_INDEX8=36168,x$h.DEPTH_STENCIL=34041,x$h.RENDERBUFFER_WIDTH=36162,x$h.RENDERBUFFER_HEIGHT=36163,x$h.RENDERBUFFER_INTERNAL_FORMAT=36164,x$h.RENDERBUFFER_RED_SIZE=36176,x$h.RENDERBUFFER_GREEN_SIZE=36177,x$h.RENDERBUFFER_BLUE_SIZE=36178,x$h.RENDERBUFFER_ALPHA_SIZE=36179,x$h.RENDERBUFFER_DEPTH_SIZE=36180,x$h.RENDERBUFFER_STENCIL_SIZE=36181,x$h.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,x$h.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,x$h.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,x$h.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,x$h.COLOR_ATTACHMENT0=36064,x$h.DEPTH_ATTACHMENT=36096,x$h.STENCIL_ATTACHMENT=36128,x$h.DEPTH_STENCIL_ATTACHMENT=33306,x$h.NONE=0,x$h.FRAMEBUFFER_COMPLETE=36053,x$h.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,x$h.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,x$h.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,x$h.FRAMEBUFFER_UNSUPPORTED=36061,x$h.FRAMEBUFFER_BINDING=36006,x$h.RENDERBUFFER_BINDING=36007,x$h.MAX_RENDERBUFFER_SIZE=34024,x$h.INVALID_FRAMEBUFFER_OPERATION=1286,x$h.UNPACK_FLIP_Y_WEBGL=37440,x$h.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,x$h.CONTEXT_LOST_WEBGL=37442,x$h.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,x$h.BROWSER_DEFAULT_WEBGL=37444,x$h._useProgram=null,x$h._depthTest=!0,x$h._depthMask=!0,x$h._blend=!1,x$h._cullFace=!1,x$h.curBindTexTarget=null,x$h.curBindTexValue=null,x$E(x$h,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),x$h}(),x$Db=function(x$b){function x$_(){x$_.__super.call(this)}x$P(x$_,"laya.webgl.display.GraphicsGL",x$C);var x$s=x$_.prototype;return x$s.setShader=function(x$b){this._saveToCmd(x$i.context._setShader,[x$b])},x$s.setIBVB=function(x$b,x$_,x$s,x$h,x$x,x$n){this._saveToCmd(x$i.context._setIBVB,[x$b,x$_,x$s,x$h,x$x,x$n])},x$s.drawParticle=function(x$b,x$_,x$s){var x$h=x$$.createParticleTemplate2D(x$s);x$h.x=x$b,x$h.y=x$_,this._saveToCmd(x$i.context._drawParticle,[x$h])},x$_}(),x$ob=function(x$b){var x$s;function x$d(x$b){this._x=0,this._y=0,this._id=++x$d._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,x$d.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=x$d.MAXCLIPRECT,this.mOutPoint,this._canvas=x$b,this._canvas._addReference(),x$d._contextcount++,x$i.isFlash?(this._ib=x$Hb.create(35044),x$wb.fillIBQuadrangle(this._ib,16)):this._ib=x$Hb.QuadrangleIB,this.clear()}x$P(x$d,"laya.webgl.canvas.WebGLContext2D",x$x);var x$_=x$d.prototype;return x$_.setIsMainContext=function(){this._isMain=!0},x$_.clearBG=function(x$b,x$_,x$s,x$h){var x$x=x$cb.mainContext;x$x.clearColor(x$b,x$_,x$s,x$h),x$x.clear(16384)},x$_._getSubmits=function(){return this._submits},x$_._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var x$b=0,x$_=this._submits._length;x$b<x$_;x$b++)this._submits[x$b].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},x$_.destroy=function(){--x$d._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=x$Hb.QuadrangleIB&&this._ib.releaseResource()},x$_.clear=function(){this._submits||(this._other=x$s.DEFAULT,this._curMat=x$r.create(),this._vb=x$jb.create(-1),this._submits=[],this._save=[x$Y.Create(this)],this._save.length=10,this._shader2D=new x$H,this._triangleMesh=x$Ub.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=x$s.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=x$d.MAXCLIPRECT,this._curSubmit=x$nb.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=x$A.DEFAULT;for(var x$b=0,x$_=this._submits._length;x$b<x$_;x$b++)this._submits[x$b].releaseRender(),this._submits[x$b]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},x$_.size=function(x$b,x$_){if(this._width!=x$b||this._height!=x$_)if(0==x$b||0==x$_){0!=this._vb._byteLength&&(this._width=x$b,this._height=x$_,this._vb.clear(),this._vb.upload());for(var x$s=0,x$h=this._submits._length;x$s<x$h;x$s++)this._submits[x$s].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=x$b,this._height=x$_,this._targets&&this._targets.size(x$b,x$_),this._canvas.memorySize-=this._canvas.memorySize;0===x$b&&0===x$_&&this._releaseMem()},x$_._getTransformMatrix=function(){return this._curMat},x$_.translate=function(x$b,x$_){0===x$b&&0===x$_||(x$e.save(this),this._curMat.bTransform&&(x$m.save(this),this._curMat.transformPointN(x$k.TEMP.setTo(x$b,x$_)),x$b=x$k.TEMP.x,x$_=x$k.TEMP.y),this._x+=x$b,this._y+=x$_)},x$_.save=function(){this._save[this._save._length++]=x$Y.Create(this)},x$_.restore=function(){var x$b=this._save._length;if(!(x$b<1))for(var x$_=x$b-1;0<=x$_;x$_--){var x$s=this._save[x$_];if(x$s.restore(this),x$s.isSaveMark())return void(this._save._length=x$_)}},x$_._fillText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){void 0===x$L&&(x$L=0);var x$f=this._shader2D,x$p=this._curSubmit.shaderValue,x$P=x$x?x$Qb.create(x$x):this._other.font;if(x$I.enabled)x$f.ALPHA!==x$p.ALPHA&&(x$f.glTexture=null),x$Vb.drawText(this,x$b,x$_,this._curMat,x$P,x$O||this._other.textAlign,x$n,x$E,x$C,x$s,x$h,x$L);else{this._shader2D.defines.getValue();var x$V=x$n?x$Q.create(x$n)._color:x$f.colorAdd;x$f.ALPHA===x$p.ALPHA&&x$V===x$f.colorAdd&&x$p.colorAdd===x$f.colorAdd||(x$f.glTexture=null,x$f.colorAdd=x$V),x$Vb.drawText(this,x$b,x$_,this._curMat,x$P,x$O||this._other.textAlign,x$n,x$E,x$C,x$s,x$h,x$L)}},x$_.fillWords=function(x$b,x$_,x$s,x$h,x$x,x$n){this._fillText(null,x$b,x$_,x$s,x$h,x$x,null,-1,null,x$n)},x$_.fillBorderWords=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._fillBorderText(null,x$b,x$_,x$s,x$h,x$x,x$n,x$E,null)},x$_.fillText=function(x$b,x$_,x$s,x$h,x$x,x$n){this._fillText(x$b,null,x$_,x$s,x$h,x$x,null,-1,x$n)},x$_.strokeText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._fillText(x$b,null,x$_,x$s,x$h,null,x$x,x$n||1,x$E)},x$_.fillBorderText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){this._fillBorderText(x$b,null,x$_,x$s,x$h,x$x,x$n,x$E,x$C)},x$_._fillBorderText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){if(!x$I.enabled)return this._fillText(x$b,x$_,x$s,x$h,x$x,null,x$E,x$C||1,x$O),void this._fillText(x$b,x$_,x$s,x$h,x$x,x$n,null,-1,x$O);var x$L=this._shader2D,x$f=this._curSubmit.shaderValue;x$L.ALPHA!==x$f.ALPHA&&(x$L.glTexture=null);var x$p=x$x?(x$d._fontTemp.setFont(x$x),x$d._fontTemp):this._other.font;x$Vb.drawText(this,x$b,x$_,this._curMat,x$p,x$O||this._other.textAlign,x$n,x$E,x$C||1,x$s,x$h,0)},x$_.fillRect=function(x$b,x$_,x$s,x$h,x$x){var x$n=this._vb;if(x$wb.fillRectImgVb(x$n,this._clipRect,x$b,x$_,x$s,x$h,x$U.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var x$E=this._shader2D.fillStyle;x$x&&(this._shader2D.fillStyle=x$A.create(x$x));var x$C=this._shader2D,x$O=this._curSubmit.shaderValue;if(x$C.fillStyle!==x$O.fillStyle||x$C.ALPHA!==x$O.ALPHA){x$C.glTexture=null;var x$L=this._curSubmit=x$nb.createSubmit(this,this._ib,x$n,(x$n._byteLength-64)/32*3,x$Mb.create(2,0));x$L.shaderValue.color=x$C.fillStyle._color._color,x$L.shaderValue.ALPHA=x$C.ALPHA,this._submits[this._submits._length++]=x$L}this._curSubmit._numEle+=6,this._shader2D.fillStyle=x$E}},x$_.fillTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){if(x$b.loaded&&x$b.bitmap&&x$b.source){var x$O=this._vb,x$L=x$b.bitmap.width,x$f=x$b.bitmap.height,x$p=x$b.uv,x$P=x$E.x%x$b.width,x$V=x$E.y%x$b.height;if(x$L!=x$C.w||x$f!=x$C.h){if(!x$C.w&&!x$C.h)switch(x$C.oy=x$C.ox=0,x$n){case"repeat":x$C.width=x$h,x$C.height=x$x;break;case"repeat-x":x$C.width=x$h,x$V<0?x$b.height+x$V>x$x?x$C.height=x$x:x$C.height=x$b.height+x$V:(x$C.oy=x$V,x$b.height+x$V>x$x?x$C.height=x$x-x$V:x$C.height=x$b.height);break;case"repeat-y":x$P<0?x$b.width+x$P>x$h?x$C.width=x$h:x$C.width=x$b.width+x$P:(x$C.ox=x$P,x$b.width+x$P>x$h?x$C.width=x$h-x$P:x$C.width=x$b.width),x$C.height=x$x;break;case"no-repeat":x$P<0?x$b.width+x$P>x$h?x$C.width=x$h:x$C.width=x$b.width+x$P:(x$C.ox=x$P,x$b.width+x$P>x$h?x$C.width=x$h-x$P:x$C.width=x$b.width),x$V<0?x$b.height+x$V>x$x?x$C.height=x$x:x$C.height=x$b.height+x$V:(x$C.oy=x$V,x$b.height+x$V>x$x?x$C.height=x$x-x$V:x$C.height=x$b.height);break;default:x$C.width=x$h,x$C.height=x$x}x$C.w=x$L,x$C.h=x$f,x$C.uv=[0,0,x$C.width/x$L,0,x$C.width/x$L,x$C.height/x$f,0,x$C.height/x$f]}if(x$_+=x$C.ox,x$s+=x$C.oy,x$P-=x$C.ox,x$V-=x$C.oy,x$wb.fillRectImgVb(x$O,this._clipRect,x$_,x$s,x$C.width,x$C.height,x$C.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var x$Q=x$qb.create(this,this._ib,x$O,(x$O._byteLength-64)/32*3,x$Mb.create(256,0)),x$y=(this._submits[this._submits._length++]=x$Q).shaderValue;x$y.textureHost=x$b;var x$w=x$p[0]*x$L,x$i=x$p[1]*x$f,x$R=(x$p[2]-x$p[0])*x$L,x$t=(x$p[5]-x$p[3])*x$f,x$c=-x$P/x$L,x$$=-x$V/x$f;x$y.u_TexRange[0]=x$w/x$L,x$y.u_TexRange[1]=x$R/x$L,x$y.u_TexRange[2]=x$i/x$f,x$y.u_TexRange[3]=x$t/x$f,x$y.u_offset[0]=x$c,x$y.u_offset[1]=x$$,x$I.enabled&&!this._isMain&&x$Q.addTexture(x$b,(x$O._byteLength>>2)-16),(this._curSubmit=x$Q)._renderType=10017,x$Q._numEle+=6}}else this.sprite&&x$D.timer.callLater(this,this._repaintSprite)},x$_.setShader=function(x$b){x$l.save(this,1048576,this._shader2D,!0),this._shader2D.shader=x$b},x$_.setFilters=function(x$b){x$l.save(this,2097152,this._shader2D,!0),this._shader2D.filters=x$b,this._curSubmit=x$nb.RENDERBASE,this._renderKey=0,this._drawCount++},x$_.drawTexture=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._drawTextureM(x$b,x$_,x$s,x$h,x$x,x$n,x$E,null,1)},x$_.addTextureVb=function(x$b,x$_,x$s){var x$h=this._curSubmit._vb||this._vb,x$x=x$h._byteLength>>2;x$h.byteLength=x$x+16<<2;for(var x$n=x$h.getFloat32Array(),x$E=0;x$E<16;x$E+=4)x$n[x$x++]=x$b[x$E]+x$_,x$n[x$x++]=x$b[x$E+1]+x$s,x$n[x$x++]=x$b[x$E+2],x$n[x$x++]=x$b[x$E+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),x$h._upload=!0},x$_.willDrawTexture=function(x$b,x$_){if(!(x$b.loaded&&x$b.bitmap&&x$b.source))return this.sprite&&x$D.timer.callLater(this,this._repaintSprite),0;var x$s=x$b.bitmap,x$h=x$s.id+this._shader2D.ALPHA*x$_+10016;if(x$h==this._renderKey)return x$h;var x$x=this._shader2D,x$n=x$x.ALPHA,x$E=this._curSubmit.shaderValue;x$x.ALPHA*=x$_,this._renderKey=x$h,this._drawCount++,x$x.glTexture=x$s;var x$C=this._vb,x$O=null,x$L=x$C._byteLength/32*3,x$f=x$E.textureHost&&x$E.textureHost==x$b&&x$E.textureHost.alphaTexture==x$b.alphaTexture;return x$O=x$qb.create(this,this._ib,x$C,x$L,x$Mb.create(1,0)),(this._submits[this._submits._length++]=x$O).shaderValue.textureHost=x$b,x$O._renderType=10016,x$O._preIsSameTextureShader=10016===this._curSubmit._renderType&&x$x.ALPHA===x$E.ALPHA&&x$f,this._curSubmit=x$O,x$x.ALPHA=x$n,x$h},x$_.drawTextures=function(x$b,x$_,x$s,x$h){if(x$b.loaded&&x$b.bitmap&&x$b.source){var x$x=this._clipRect;if(this._clipRect=x$d.MAXCLIPRECT,this._drawTextureM(x$b,x$_[0],x$_[1],x$b.width,x$b.height,x$s,x$h,null,1)){if(this._clipRect=x$x,x$J.drawCall++,!(x$_.length<4)){for(var x$n=this._curSubmit._vb||this._vb,x$E=this._curMat.a,x$C=this._curMat.d,x$O=2,x$L=x$_.length;x$O<x$L;x$O+=2)x$wb.copyPreImgVb(x$n,(x$_[x$O]-x$_[x$O-2])*x$E,(x$_[x$O+1]-x$_[x$O-1])*x$C),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&x$D.timer.callLater(this,this._repaintSprite)},x$_._drawTextureM=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){if(!x$b.loaded||!x$b.source)return this.sprite&&x$D.timer.callLater(this,this._repaintSprite),!1;var x$L=this._curSubmit._vb||this._vb,x$f=x$b.bitmap;x$_+=x$n,x$s+=x$E,this._drawCount++;var x$p=x$f.id+this._shader2D.ALPHA*x$O+10016;if(x$p!=this._renderKey){this._renderKey=x$p;var x$P=this._curSubmit.shaderValue,x$V=this._shader2D,x$Q=x$V.ALPHA;x$V.ALPHA*=x$O,x$V.glTexture=x$f;var x$y=this._vb,x$w=null,x$i=x$y._byteLength/32*3,x$R=x$P.textureHost&&x$P.textureHost==x$b&&x$P.textureHost.alphaTexture==x$b.alphaTexture;x$w=x$qb.create(this,this._ib,x$y,x$i,x$Mb.create(1,0)),(this._submits[this._submits._length++]=x$w).shaderValue.textureHost=x$b,x$w._renderType=10016,x$w._preIsSameTextureShader=10016===this._curSubmit._renderType&&x$V.ALPHA===x$P.ALPHA&&x$R,this._curSubmit=x$w,x$L=this._curSubmit._vb||this._vb,x$V.ALPHA=x$Q}return!!x$wb.fillRectImgVb(x$L,this._clipRect,x$_,x$s,x$h||x$b.width,x$x||x$b.height,x$b.uv,x$C||this._curMat,this._x,this._y,0,0)&&(x$I.enabled&&!this._isMain&&this._curSubmit.addTexture(x$b,(x$L._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},x$_._repaintSprite=function(){this.sprite&&this.sprite.repaint()},x$_._drawText=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){var x$f=x$b.bitmap;this._drawCount++;var x$p=x$f.id+this._shader2D.ALPHA+10016;if(x$p!=this._renderKey){this._renderKey=x$p;var x$P=this._curSubmit.shaderValue,x$V=this._shader2D;x$V.glTexture=x$f;var x$Q=this._vb,x$y=null,x$w=x$Q._byteLength/32*3,x$i=x$P.textureHost&&x$P.textureHost==x$b&&x$P.textureHost.alphaTexture==x$b.alphaTexture;(x$y=x$I.enabled?x$qb.create(this,this._ib,x$Q,x$w,x$Mb.create(1,0)):x$qb.create(this,this._ib,x$Q,x$w,x$eb.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&x$V.ALPHA===x$P.ALPHA&&x$i,(this._submits[this._submits._length++]=x$y).shaderValue.textureHost=x$b,x$y._renderType=10016,this._curSubmit=x$y}x$b.active();var x$R=this._curSubmit._vb||this._vb;x$wb.fillRectImgVb(x$R,this._clipRect,x$_+x$E,x$s+x$C,x$h||x$b.width,x$x||x$b.height,x$b.uv,x$n||this._curMat,this._x,this._y,x$O,x$L,!0)&&(x$I.enabled&&!this._isMain&&this._curSubmit.addTexture(x$b,(x$R._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},x$_.drawTextureWithTransform=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){if(x$n){var x$L=this._curMat,x$f=this._x,x$p=this._y;(0!==x$E||0!==x$C)&&(this._x=x$E*x$L.a+x$C*x$L.c,this._y=x$C*x$L.d+x$E*x$L.b),x$n&&x$L.bTransform?(x$r.mul(x$n,x$L,x$d._tmpMatrix),(x$n=x$d._tmpMatrix)._checkTransform()):(this._x+=x$L.tx,this._y+=x$L.ty),this._drawTextureM(x$b,x$_,x$s,x$h,x$x,0,0,x$n,x$O),this._x=x$f,this._y=x$p}else this._drawTextureM(x$b,x$_,x$s,x$h,x$x,x$E,x$C,null,x$O)},x$_.fillQuadrangle=function(x$b,x$_,x$s,x$h,x$x){var x$n=this._curSubmit,x$E=this._vb,x$C=this._shader2D,x$O=x$n.shaderValue;if(this._renderKey=0,x$b.bitmap){var x$L=x$b.bitmap;x$C.glTexture==x$L&&x$C.ALPHA===x$O.ALPHA||(x$C.glTexture=x$L,(x$n=this._curSubmit=x$nb.createSubmit(this,this._ib,x$E,x$E._byteLength/32*3,x$Mb.create(1,0))).shaderValue.glTexture=x$L,this._submits[this._submits._length++]=x$n),x$wb.fillQuadrangleImgVb(x$E,x$_,x$s,x$h,x$b.uv,x$x||this._curMat,this._x,this._y)}else x$n.shaderValue.fillStyle&&x$n.shaderValue.fillStyle.equal(x$b)&&x$C.ALPHA===x$O.ALPHA||(x$C.glTexture=null,(x$n=this._curSubmit=x$nb.createSubmit(this,this._ib,x$E,x$E._byteLength/32*3,x$Mb.create(2,0))).shaderValue.defines.add(2),x$n.shaderValue.fillStyle=x$A.create(x$b),this._submits[this._submits._length++]=x$n),x$wb.fillQuadrangleImgVb(x$E,x$_,x$s,x$h,x$U.DEF_UV,x$x||this._curMat,this._x,this._y);x$n._numEle+=6},x$_.drawTexture2=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){if(0!=x$n){var x$O=this._curMat;if(this._x=x$b*x$O.a+x$_*x$O.c,this._y=x$_*x$O.d+x$b*x$O.b,x$x&&(x$x=x$O.bTransform||x$x.bTransform?(x$r.mul(x$x,x$O,x$d._tmpMatrix),x$d._tmpMatrix):(this._x+=x$x.tx+x$O.tx,this._y+=x$x.ty+x$O.ty,x$r.EMPTY)),1!==x$n||x$E){var x$L=this._shader2D.ALPHA,x$f=this._nBlendType;this._shader2D.ALPHA=x$n,x$E&&(this._nBlendType=x$F.TOINT(x$E)),this._drawTextureM(x$C[0],x$C[1]-x$s,x$C[2]-x$h,x$C[3],x$C[4],0,0,x$x,1),this._shader2D.ALPHA=x$L,this._nBlendType=x$f}else this._drawTextureM(x$C[0],x$C[1]-x$s,x$C[2]-x$h,x$C[3],x$C[4],0,0,x$x,1);this._x=this._y=0}},x$_.drawCanvas=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$b.context;if(this._renderKey=0,x$n._targets)this._submits[this._submits._length++]=x$Tb.create(x$n,0,null),this._curSubmit=x$nb.RENDERBASE,x$n._targets.drawTo(this,x$_,x$s,x$h,x$x);else{var x$E=this._submits[this._submits._length++]=x$Tb.create(x$n,this._shader2D.ALPHA,this._shader2D.filters),x$C=x$h/x$b.width,x$O=x$x/x$b.height,x$L=x$E._matrix;this._curMat.copyTo(x$L),1!=x$C&&1!=x$O&&x$L.scale(x$C,x$O);var x$f=x$L.tx,x$p=x$L.ty;x$L.tx=x$L.ty=0,x$L.transformPoint(x$k.TEMP.setTo(x$_,x$s)),x$L.translate(x$k.TEMP.x+x$f,x$k.TEMP.y+x$p),this._curSubmit=x$nb.RENDERBASE}x$o.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=x$n._targets?"yellow":"green",this.strokeRect(x$_-1,x$s-1,x$h+2,x$x+2,1),this.strokeRect(x$_,x$s,x$h,x$x,1),this.restore())},x$_.drawTarget=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){void 0===x$L&&(x$L=-1);var x$f=this._vb;if(x$wb.fillRectImgVb(x$f,this._clipRect,x$_,x$s,x$h,x$x,x$O||x$U.DEF_UV,x$n||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var x$p=this._curSubmit=x$pb.create(this,this._ib,x$f,(x$f._byteLength-64)/32*3,x$C,x$E);x$p.blendType=-1==x$L?this._nBlendType:x$L,x$p.scope=x$b,this._submits[this._submits._length++]=x$p,this._curSubmit._numEle+=6}},x$_.mixRGBandAlpha=function(x$b){return this._mixRGBandAlpha(x$b,this._shader2D.ALPHA)},x$_._mixRGBandAlpha=function(x$b,x$_){var x$s=(4278190080&x$b)>>>24;return 0!=x$s?x$s*=x$_:x$s=255*x$_,16777215&x$b|x$s<<24},x$_.drawTriangles=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){if(!x$b.loaded||!x$b.source)return this.sprite&&x$D.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;x$b.bitmap;var x$f=this._mixRGBandAlpha(4294967295,x$C),x$p=(x$h.length,x$n.length);this._renderKey=-1;var x$P=this._curSubmit=x$qb.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,x$Mb.create(1,0));return x$P.shaderValue.textureHost=x$b,x$P._renderType=10016,this._submits[this._submits._length++]=x$P,x$E?(x$d._tmpMatrix.a=x$E.a,x$d._tmpMatrix.b=x$E.b,x$d._tmpMatrix.c=x$E.c,x$d._tmpMatrix.d=x$E.d,x$d._tmpMatrix.tx=x$E.tx+x$_,x$d._tmpMatrix.ty=x$E.ty+x$s,x$r.mul(x$d._tmpMatrix,this._curMat,x$d._tmpMatrix)):(x$d._tmpMatrix.a=this._curMat.a,x$d._tmpMatrix.b=this._curMat.b,x$d._tmpMatrix.c=this._curMat.c,x$d._tmpMatrix.d=this._curMat.d,x$d._tmpMatrix.tx=this._curMat.tx+x$_,x$d._tmpMatrix.ty=this._curMat.ty+x$s),this._triangleMesh.addData(x$h,x$x,x$n,x$d._tmpMatrix,x$f,this),this._curSubmit._numEle+=x$p,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},x$_.transform=function(x$b,x$_,x$s,x$h,x$x,x$n){x$m.save(this),x$r.mul(x$r.TEMP.setTo(x$b,x$_,x$s,x$h,x$x,x$n),this._curMat,this._curMat),this._curMat._checkTransform()},x$_.setTransformByMatrix=function(x$b){x$b.copyTo(this._curMat)},x$_.transformByMatrix=function(x$b){x$m.save(this),x$r.mul(x$b,this._curMat,this._curMat),this._curMat._checkTransform()},x$_.rotate=function(x$b){x$m.save(this),this._curMat.rotateEx(x$b)},x$_.scale=function(x$b,x$_){x$m.save(this),this._curMat.scaleEx(x$b,x$_)},x$_.clipRect=function(x$b,x$_,x$s,x$h){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var x$x=x$fb.create(4);this.addRenderObject(x$x);var x$n=this._vb,x$E=x$n._byteLength>>2;if(x$wb.fillRectImgVb(x$n,null,x$b,x$_,x$s,x$h,x$U.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var x$C=this._curSubmit=x$nb.createSubmit(this,this._ib,x$n,(x$n._byteLength-64)/32*3,x$Mb.create(2,0));x$C.shaderValue.ALPHA=1,this._submits[this._submits._length++]=x$C,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var x$O=x$fb.create(5);this.addRenderObject(x$O);var x$L=x$n.getFloat32Array(),x$f=Math.min(Math.min(Math.min(x$L[0+x$E],x$L[4+x$E]),x$L[8+x$E]),x$L[12+x$E]),x$p=Math.max(Math.max(Math.max(x$L[0+x$E],x$L[4+x$E]),x$L[8+x$E]),x$L[12+x$E]),x$P=Math.min(Math.min(Math.min(x$L[1+x$E],x$L[5+x$E]),x$L[9+x$E]),x$L[13+x$E]),x$V=Math.max(Math.max(Math.max(x$L[1+x$E],x$L[5+x$E]),x$L[9+x$E]),x$L[13+x$E]);x$X.save(this,x$O,x$b,x$_,x$s,x$h,x$f,x$P,x$p-x$f,x$V-x$P),this._curSubmit=x$nb.RENDERBASE}else{x$s*=this._curMat.a,x$h*=this._curMat.d;var x$Q=x$k.TEMP;this._curMat.transformPoint(x$Q.setTo(x$b,x$_)),x$s<0&&(x$Q.x=x$Q.x+x$s,x$s=-x$s),x$h<0&&(x$Q.y=x$Q.y+x$h,x$h=-x$h),this._renderKey=0;var x$y=this._curSubmit=x$Lb.create(this);(this._submits[this._submits._length++]=x$y).submitIndex=this._submits._length,x$y.submitLength=9999999,x$N.save(this,x$y);var x$w=this._clipRect,x$i=x$w.x,x$R=x$w.y,x$t=x$Q.x+x$s,x$c=x$Q.y+x$h;x$i<x$Q.x&&(x$w.x=x$Q.x),x$R<x$Q.y&&(x$w.y=x$Q.y),x$w.width=Math.min(x$t,x$i+x$w.width)-x$w.x,x$w.height=Math.min(x$c,x$R+x$w.height)-x$w.y,this._shader2D.glTexture=null,x$y.clipRect.copyFrom(x$w),this._curSubmit=x$nb.RENDERBASE}},x$_.setIBVB=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f){if(void 0===x$O&&(x$O=0),void 0===x$L&&(x$L=0),void 0===x$f&&(x$f=0),null===x$s){if(x$i.isFlash){var x$p=x$h;x$p._selfIB||(x$p._selfIB=x$Hb.create(35044)),x$p._selfIB.clear(),x$s=x$p._selfIB}else x$s=this._ib;x$wb.expandIBQuadrangle(x$s,x$h._byteLength/(4*x$h.vertexStride*4))}if(!x$C||!x$E)throw Error("setIBVB must input:shader shaderValues");var x$P=x$Ob.create(this,x$h,x$s,x$x,x$E,x$C,x$O,x$L,x$f);x$n||(x$n=x$r.EMPTY),x$n.translate(x$b,x$_),x$r.mul(x$n,this._curMat,x$P._mat),x$n.translate(-x$b,-x$_),this._submits[this._submits._length++]=x$P,this._curSubmit=x$nb.RENDERBASE,this._renderKey=0},x$_.addRenderObject=function(x$b){this._submits[this._submits._length++]=x$b},x$_.fillTrangles=function(x$b,x$_,x$s,x$h,x$x){var x$n=this._curSubmit,x$E=this._vb,x$C=this._shader2D,x$O=x$n.shaderValue,x$L=x$h.length>>4,x$f=x$b.bitmap;this._renderKey=0,x$C.glTexture==x$f&&x$C.ALPHA===x$O.ALPHA||((x$n=this._curSubmit=x$nb.createSubmit(this,this._ib,x$E,x$E._byteLength/32*3,x$Mb.create(1,0))).shaderValue.textureHost=x$b,this._submits[this._submits._length++]=x$n),x$wb.fillTranglesVB(x$E,x$_,x$s,x$h,x$x||this._curMat,this._x,this._y),x$n._numEle+=6*x$L},x$_.submitElement=function(x$b,x$_){var x$s=this._submits;for(x$_<0&&(x$_=x$s._length);x$b<x$_;)x$b+=x$s[x$b].renderSubmit()},x$_.finish=function(){x$cb.mainContext.finish()},x$_.flush=function(){var x$b=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(x$b>this._ib.bufferLength/12&&x$wb.expandIBQuadrangle(this._ib,x$b),!this._isMain&&x$I.enabled&&x$I._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=x$I._atlasRestore;for(var x$_=this._submits,x$s=0,x$h=x$_._length;x$s<x$h;x$s++){var x$x=x$_[x$s];10016===x$x.getRenderType()&&x$x.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),x$_b.instance&&x$_b.getInstance().reset();var x$n;for(x$s=0,x$n=this.meshlist.length;x$s<x$n;x$s++){var x$E=this.meshlist[x$s];x$E.canReuse?x$E.releaseMesh():x$E.destroy()}return this.meshlist.length=0,this._curSubmit=x$nb.RENDERBASE,this._renderKey=0,this._triangleMesh=x$Ub.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},x$_.setPathId=function(x$b){if(this.mId=x$b,-1!=this.mId){this.mHaveKey=!1;var x$_=x$z.getInstance();x$_.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,x$_.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},x$_.movePath=function(x$b,x$_){var x$s=x$b,x$h=x$_;x$b=this._curMat.a*x$s+this._curMat.c*x$h+this._curMat.tx,x$_=this._curMat.b*x$s+this._curMat.d*x$h+this._curMat.ty,this.mX+=x$b,this.mY+=x$_},x$_.beginPath=function(){var x$b=this._getPath();x$b.tempArray.length=0,x$b.closePath=!1,this.mX=0,this.mY=0},x$_.closePath=function(){this._path.closePath=!0},x$_.fill=function(x$b){void 0===x$b&&(x$b=!1);var x$_=this._getPath();this.drawPoly(0,0,x$_.tempArray,this.fillStyle._color.numColor,0,0,x$b)},x$_.stroke=function(){var x$b=this._getPath();if(0<this.lineWidth){if(-1==this.mId)x$b.drawLine(0,0,x$b.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var x$_=x$z.getInstance().shapeLineDic[this.mId];x$_.rebuild(x$b.tempArray),x$b.setGeomtry(x$_)}else x$z.getInstance().addLine(this.mId,x$b.drawLine(0,0,x$b.tempArray,this.lineWidth,this.strokeStyle._color.numColor));x$b.update();var x$s=[this.mX,this.mY],x$h=x$nb.createShape(this,x$b.ib,x$b.vb,x$b.count,x$b.offset,x$Mb.create(4,0));x$h.shaderValue.ALPHA=this._shader2D.ALPHA,x$h.shaderValue.u_pos=x$s,x$h.shaderValue.u_mmat2=x$Rb.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=x$h,this._renderKey=-1}},x$_.line=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=this._curSubmit,x$C=this._vb;if(x$wb.fillLineVb(x$C,this._clipRect,x$b,x$_,x$s,x$h,x$x,x$n)){this._renderKey=0;var x$O=this._shader2D,x$L=x$E.shaderValue;x$O.strokeStyle===x$L.strokeStyle&&x$O.ALPHA===x$L.ALPHA||(x$O.glTexture=null,(x$E=this._curSubmit=x$nb.createSubmit(this,this._ib,x$C,(x$C._byteLength-64)/32*3,x$Mb.create(2,0))).shaderValue.strokeStyle=x$O.strokeStyle,x$E.shaderValue.mainID=2,x$E.shaderValue.ALPHA=x$O.ALPHA,this._submits[this._submits._length++]=x$E),x$E._numEle+=6}},x$_.moveTo=function(x$b,x$_,x$s){void 0===x$s&&(x$s=!0);var x$h=this._getPath();if(x$s){var x$x=x$b,x$n=x$_;x$b=this._curMat.a*x$x+this._curMat.c*x$n,x$_=this._curMat.b*x$x+this._curMat.d*x$n}x$h.addPoint(x$b,x$_)},x$_.lineTo=function(x$b,x$_,x$s){void 0===x$s&&(x$s=!0);var x$h=this._getPath();if(x$s){var x$x=x$b,x$n=x$_;x$b=this._curMat.a*x$x+this._curMat.c*x$n,x$_=this._curMat.b*x$x+this._curMat.d*x$n}x$h.addPoint(x$b,x$_)},x$_.drawCurves=function(x$b,x$_,x$s){this.setPathId(-1),this.beginPath(),this.strokeStyle=x$s[3],this.lineWidth=x$s[4];var x$h=x$s[2];x$b+=x$s[0],x$_+=x$s[1],this.movePath(x$b,x$_),this.moveTo(x$h[0],x$h[1]);for(var x$x=2,x$n=x$h.length;x$x<x$n;)this.quadraticCurveTo(x$h[x$x++],x$h[x$x++],x$h[x$x++],x$h[x$x++]);this.stroke()},x$_.arcTo=function(x$b,x$_,x$s,x$h,x$x){if(-1==this.mId||!this.mHaveKey){var x$n=0,x$E=0,x$C=0,x$O=this._getPath();this._curMat.copyTo(x$d._tmpMatrix),x$d._tmpMatrix.tx=x$d._tmpMatrix.ty=0,x$d._tempPoint.setTo(x$O.getEndPointX(),x$O.getEndPointY()),x$d._tmpMatrix.invertTransformPoint(x$d._tempPoint);var x$L=x$d._tempPoint.x-x$b,x$f=x$d._tempPoint.y-x$_,x$p=Math.sqrt(x$L*x$L+x$f*x$f);if(!(x$p<=1e-6)){var x$P=x$L/x$p,x$V=x$f/x$p,x$Q=x$s-x$b,x$y=x$h-x$_,x$w=x$Q*x$Q+x$y*x$y,x$i=Math.sqrt(x$w);if(!(x$i<=1e-6)){var x$R=x$Q/x$i,x$t=x$y/x$i,x$c=x$P+x$R,x$$=x$V+x$t,x$D=Math.sqrt(x$c*x$c+x$$*x$$);if(!(x$D<=1e-6)){var x$o=x$c/x$D,x$M=x$$/x$D,x$r=Math.acos(x$o*x$P+x$M*x$V),x$k=Math.PI/2-x$r,x$B=(x$p=x$x/Math.tan(x$k))*x$P+x$b,x$S=x$p*x$V+x$_,x$Z=Math.sqrt(x$p*x$p+x$x*x$x),x$J=x$b+x$o*x$Z,x$W=x$_+x$M*x$Z,x$T=0,x$q=0;if(0<=x$P*x$t-x$V*x$R){var x$U=2*x$k/x$d.SEGNUM;x$T=Math.sin(x$U),x$q=Math.cos(x$U)}else x$U=2*-x$k/x$d.SEGNUM,x$T=Math.sin(x$U),x$q=Math.cos(x$U);x$E=this._curMat.a*x$B+this._curMat.c*x$S,x$C=this._curMat.b*x$B+this._curMat.d*x$S,x$E==this._path.getEndPointX()&&x$C==this._path.getEndPointY()||x$O.addPoint(x$E,x$C);var x$G=x$B-x$J,x$z=x$S-x$W;for(x$n=0;x$n<x$d.SEGNUM;x$n++){var x$a=x$G*x$q+x$z*x$T,x$K=-x$G*x$T+x$z*x$q;x$E=x$a+x$J,x$C=x$K+x$W,x$b=this._curMat.a*x$E+this._curMat.c*x$C,x$C=x$_=this._curMat.b*x$E+this._curMat.d*x$C,(x$E=x$b)==this._path.getEndPointX()&&x$C==this._path.getEndPointY()||x$O.addPoint(x$E,x$C),x$G=x$a,x$z=x$K}}}}}},x$_.arc=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!0),-1!=this.mId){var x$C=x$z.getInstance().shapeDic[this.mId];if(x$C&&this.mHaveKey&&!x$C.needUpdate(this._curMat))return;x$_=x$b=0}var x$O,x$L=0,x$f=0,x$p=0,x$P=0,x$V=0,x$Q=0,x$y=0;if(x$f=x$x-x$h,x$n)if(Math.abs(x$f)>=2*Math.PI)x$f=2*-Math.PI;else for(;0<x$f;)x$f-=2*Math.PI;else if(Math.abs(x$f)>=2*Math.PI)x$f=2*Math.PI;else for(;x$f<0;)x$f+=2*Math.PI;x$O=x$f/(x$y=x$s<101?Math.max(10,x$f*x$s/5):x$s<201?Math.max(10,x$f*x$s/20):Math.max(10,x$f*x$s/40))/2,x$p=Math.abs(4/3*(1-Math.cos(x$O))/Math.sin(x$O)),x$n&&(x$p=-x$p);var x$w=this._getPath(),x$i=NaN,x$R=NaN;for(x$Q=0;x$Q<=x$y;x$Q++)x$L=x$h+x$f*(x$Q/x$y),x$P=x$b+Math.cos(x$L)*x$s,x$V=x$_+Math.sin(x$L)*x$s,x$E&&(x$i=x$P,x$R=x$V,x$P=this._curMat.a*x$i+this._curMat.c*x$R,x$V=this._curMat.b*x$i+this._curMat.d*x$R),x$P==this._path.getEndPointX()&&x$V==this._path.getEndPointY()||x$w.addPoint(x$P,x$V);x$P=x$b+Math.cos(x$x)*x$s,x$V=x$_+Math.sin(x$x)*x$s,x$E&&(x$i=x$P,x$R=x$V,x$P=this._curMat.a*x$i+this._curMat.c*x$R,x$V=this._curMat.b*x$i+this._curMat.d*x$R),x$P==this._path.getEndPointX()&&x$V==this._path.getEndPointY()||x$w.addPoint(x$P,x$V)},x$_.quadraticCurveTo=function(x$b,x$_,x$s,x$h){var x$x=x$p.I,x$n=x$s,x$E=x$h;x$s=this._curMat.a*x$n+this._curMat.c*x$E,x$h=this._curMat.b*x$n+this._curMat.d*x$E,x$n=x$b,x$E=x$_,x$b=this._curMat.a*x$n+this._curMat.c*x$E,x$_=this._curMat.b*x$n+this._curMat.d*x$E;for(var x$C=x$x.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),x$b,x$_,x$s,x$h],30,2),x$O=0,x$L=x$C.length/2;x$O<x$L;x$O++)this.lineTo(x$C[2*x$O],x$C[2*x$O+1],!1);this.lineTo(x$s,x$h,!1)},x$_.rect=function(x$b,x$_,x$s,x$h){this._other=this._other.make(),this._other.path||(this._other.path=new x$u),this._other.path.rect(x$b,x$_,x$s,x$h)},x$_.strokeRect=function(x$b,x$_,x$s,x$h,x$x){var x$n=.5*x$x;this.line(x$b-x$n,x$_,x$b+x$s+x$n,x$_,x$x,this._curMat),this.line(x$b+x$s,x$_,x$b+x$s,x$_+x$h,x$x,this._curMat),this.line(x$b,x$_,x$b,x$_+x$h,x$x,this._curMat),this.line(x$b-x$n,x$_+x$h,x$b+x$s+x$n,x$_+x$h,x$x,this._curMat)},x$_.clip=function(){},x$_.drawPoly=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){void 0===x$E&&(x$E=!1),this._renderKey=0,this._shader2D.glTexture=null;var x$C=this._getPath();if(-1==this.mId)x$C.polygon(x$b,x$_,x$s,x$h,x$x||1,x$n);else if(this.mHaveKey){var x$O=x$z.getInstance().shapeDic[this.mId];x$O.setMatrix(this._curMat),x$O.rebuild(x$C.tempArray),x$C.setGeomtry(x$O)}else{var x$L=x$C.polygon(x$b,x$_,x$s,x$h,x$x||1,x$n);x$z.getInstance().addShape(this.mId,x$L),x$L.setMatrix(this._curMat)}x$C.update();var x$f,x$p=[this.mX,this.mY];if((x$f=x$nb.createShape(this,x$C.ib,x$C.vb,x$C.count,x$C.offset,x$Mb.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,x$f.shaderValue.u_pos=x$p,x$f.shaderValue.u_mmat2=x$Rb.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=x$f,0<x$x){if(this.mHaveLineKey){var x$P=x$z.getInstance().shapeLineDic[this.mId];x$P.rebuild(x$C.tempArray),x$C.setGeomtry(x$P)}else x$z.getInstance().addShape(this.mId,x$C.drawLine(x$b,x$_,x$s,x$x,x$n));x$C.update(),(x$f=x$nb.createShape(this,x$C.ib,x$C.vb,x$C.count,x$C.offset,x$Mb.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,x$f.shaderValue.u_mmat2=x$Rb.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=x$f}},x$_.drawParticle=function(x$b,x$_,x$s){x$s.x=x$b,x$s.y=x$_,this._submits[this._submits._length++]=x$s},x$_._getPath=function(){return this._path||(this._path=new x$u)},x$h(0,x$_,"globalCompositeOperation",function(){return x$F.NAMES[this._nBlendType]},function(x$b){var x$_=x$F.TOINT[x$b];null==x$_||this._nBlendType===x$_||(x$l.save(this,65536,this,!0),this._curSubmit=x$nb.RENDERBASE,this._renderKey=0,this._nBlendType=x$_)}),x$h(0,x$_,"strokeStyle",function(){return this._shader2D.strokeStyle},function(x$b){this._shader2D.strokeStyle.equal(x$b)||(x$l.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=x$A.create(x$b))}),x$h(0,x$_,"globalAlpha",function(){return this._shader2D.ALPHA},function(x$b){(x$b=Math.floor(1e3*x$b)/1e3)!=this._shader2D.ALPHA&&(x$l.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=x$b)}),x$h(0,x$_,"asBitmap",null,function(x$b){if(x$b){if(this._targets||(this._targets=new x$v),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),x$h(0,x$_,"fillStyle",function(){return this._shader2D.fillStyle},function(x$b){this._shader2D.fillStyle.equal(x$b)||(x$l.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=x$A.create(x$b))}),x$h(0,x$_,"textAlign",function(){return this._other.textAlign},function(x$b){this._other.textAlign===x$b||(this._other=this._other.make(),x$l.save(this,32768,this._other,!1),this._other.textAlign=x$b)}),x$h(0,x$_,"lineWidth",function(){return this._other.lineWidth},function(x$b){this._other.lineWidth===x$b||(this._other=this._other.make(),x$l.save(this,256,this._other,!1),this._other.lineWidth=x$b)}),x$h(0,x$_,"textBaseline",function(){return this._other.textBaseline},function(x$b){this._other.textBaseline===x$b||(this._other=this._other.make(),x$l.save(this,16384,this._other,!1),this._other.textBaseline=x$b)}),x$h(0,x$_,"font",null,function(x$b){x$b!=this._other.font.toString()&&(this._other=this._other.make(),x$l.save(this,8,this._other,!1),this._other.font===x$Qb.EMPTY?this._other.font=new x$Qb(x$b):this._other.font.setFont(x$b))}),x$d.__init__=function(){x$s.DEFAULT=new x$s},x$d._tempPoint=new x$k,x$d._SUBMITVBSIZE=32e3,x$d._MAXSIZE=99999999,x$d._RECTVBSIZE=16,x$d.MAXCLIPRECT=new x$B(0,0,99999999,99999999),x$d._COUNT=0,x$d._tmpMatrix=new x$r,x$d.SEGNUM=32,x$d._contextcount=0,x$E(x$d,["_fontTemp",function(){return this._fontTemp=new x$Qb},"_drawStyleTemp",function(){return this._drawStyleTemp=new x$A(null)}]),x$d.__init$=function(){x$s=function(){function x$b(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=x$Qb.EMPTY}x$P(x$b,"");var x$_=x$b.prototype;return x$_.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=x$Qb.EMPTY},x$_.make=function(){return this===x$b.DEFAULT?new x$b:this},x$b.DEFAULT=null,x$b}()},x$d}(),x$Mb=function(x$b){function x$h(x$b,x$_){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,x$h.__super.call(this),this.defines=new x$Sb,this.position=x$h._POSITION,this.mainID=x$b,this.subID=x$_,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=x$b|x$_,this._inClassCache=x$h._cache[this._cacheID],0<x$b&&!this._inClassCache&&(this._inClassCache=x$h._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}x$P(x$h,"laya.webgl.shader.d2.value.Value2D",x$K);var x$_=x$h.prototype;return x$_.setValue=function(x$b){},x$_.refresh=function(){var x$b=this.size;return x$b[0]=x$Rb.width,x$b[1]=x$Rb.height,this.alpha=this.ALPHA*x$Rb.worldAlpha,this.mmat=x$Rb.worldMatrix4,this},x$_._ShaderWithCompile=function(){return x$Yb.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,x$vb.create)},x$_._withWorldShaderDefines=function(){var x$b=x$Rb.worldShaderDefines,x$_=x$Yb.sharders[this.mainID|this.defines._value|x$b.getValue()];if(!x$_){var x$s,x$h={};for(x$s in this.defines.toNameDic())x$h[x$s]="";for(x$s in x$b.toNameDic())x$h[x$s]="";x$_=x$Yb.withCompile2D(0,this.mainID,x$h,this.mainID|this.defines._value|x$b.getValue(),x$vb.create)}var x$x=x$Rb.worldFilters;if(!x$x)return x$_;for(var x$n,x$E=x$x.length,x$C=0;x$C<x$E;x$C++)(x$n=x$x[x$C])&&x$n.action.setValue(this);return x$_},x$_.upload=function(){var x$b=x$Rb;this.alpha=this.ALPHA*x$b.worldAlpha,x$Rb.worldMatrix4!==x$Rb.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),x$cb.shaderHighPrecision&&this.defines.add(1024);var x$_,x$s=x$b.worldShaderDefines?this._withWorldShaderDefines():x$Yb.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=x$b.width,this.size[1]=x$b.height,this.mmat=x$b.worldMatrix4,x$Gb.activeShader!==x$s?x$s._shaderValueWidth!==x$b.width||x$s._shaderValueHeight!==x$b.height?(x$s._shaderValueWidth=x$b.width,x$s._shaderValueHeight=x$b.height):x$_=x$s._params2dQuick2||x$s._make2dQuick2():x$s._shaderValueWidth!==x$b.width||x$s._shaderValueHeight!==x$b.height?(x$s._shaderValueWidth=x$b.width,x$s._shaderValueHeight=x$b.height):x$_=x$s._params2dQuick1||x$s._make2dQuick1(),x$s.upload(this,x$_)},x$_.setFilters=function(x$b){if(this.filters=x$b)for(var x$_,x$s=x$b.length,x$h=0;x$h<x$s;x$h++)(x$_=x$b[x$h])&&(this.defines.add(x$_.type),x$_.action.setValue(this))},x$_.clear=function(){this.defines.setValue(this.subID)},x$_.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},x$h._initone=function(x$b,x$_){x$h._typeClass[x$b]=x$_,x$h._cache[x$b]=[],x$h._cache[x$b]._length=0},x$h.__init__=function(){x$h._POSITION=[2,5126,!1,4*x$yb.BYTES_PE,0],x$h._TEXCOORD=[2,5126,!1,4*x$yb.BYTES_PE,2*x$yb.BYTES_PE],x$h._initone(2,x$db),x$h._initone(4,x$Fb),x$h._initone(256,x$Ib),x$h._initone(512,x$Kb),x$h._initone(1,x$gb),x$h._initone(65,x$eb),x$h._initone(9,x$gb)},x$h.create=function(x$b,x$_){var x$s=x$h._cache[x$b|x$_];return x$s._length?x$s[--x$s._length]:new x$h._typeClass[x$b|x$_](x$_)},x$h._POSITION=null,x$h._TEXCOORD=null,x$h._cache=[],x$h._typeClass=[],x$h.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x$h}(),x$rb=function(x$b){function x$w(x$b,x$_){x$w.__super.call(this,x$b,x$_)}x$P(x$w,"laya.webgl.utils.RenderSprite3D",x$R);var x$_=x$w.prototype;return x$_.onCreate=function(x$b){switch(x$b){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},x$_._mask=function(x$b,x$_,x$s,x$h){var x$x,x$n,x$E=this._next,x$C=x$b.mask;if(x$C){x$_.ctx.save();var x$O=x$_.ctx.globalCompositeOperation,x$L=new x$B;if(x$L.copyFrom(x$C.getBounds()),x$L.width=Math.round(x$L.width),x$L.height=Math.round(x$L.height),x$L.x=Math.round(x$L.x),x$L.y=Math.round(x$L.y),0<x$L.width&&0<x$L.height){var x$f=x$b._style._tf,x$p=x$Cb.create();x$p.addValue("bounds",x$L),x$x=x$Eb.create([x$p,x$_],laya.webgl.utils.RenderSprite3D.tmpTarget),x$_.addRenderObject(x$x),x$C.render(x$_,-x$L.x,-x$L.y),x$x=x$Eb.create([x$p],laya.webgl.utils.RenderSprite3D.endTmpTarget),x$_.addRenderObject(x$x),x$_.ctx.save(),x$_.clipRect(x$s-x$f.translateX+x$L.x,x$h-x$f.translateY+x$L.y,x$L.width,x$L.height),x$E._fun.call(x$E,x$b,x$_,x$s,x$h),x$_.ctx.restore(),x$n=x$fb.create(6),x$O=x$_.ctx.globalCompositeOperation,x$n.blendMode="mask",x$_.addRenderObject(x$n),x$r.TEMP.identity();var x$P=x$Mb.create(1,0),x$V=x$U.INV_UV,x$Q=x$L.width,x$y=x$L.height;(x$L.width<32||x$L.height<32)&&((x$V=x$w.tempUV)[0]=0,x$V[1]=0,x$V[2]=32<=x$L.width?1:x$L.width/32,x$V[3]=0,x$V[4]=32<=x$L.width?1:x$L.width/32,x$V[5]=32<=x$L.height?1:x$L.height/32,x$V[6]=0,x$V[7]=32<=x$L.height?1:x$L.height/32,x$L.width=32<=x$L.width?x$L.width:32,x$L.height=32<=x$L.height?x$L.height:32,x$V[1]*=-1,x$V[3]*=-1,x$V[5]*=-1,x$V[7]*=-1,x$V[1]+=1,x$V[3]+=1,x$V[5]+=1,x$V[7]+=1),x$_.ctx.drawTarget(x$p,x$s+x$L.x-x$f.translateX,x$h+x$L.y-x$f.translateY,x$Q,x$y,x$r.TEMP,"tmpTarget",x$P,x$V,6),x$x=x$Eb.create([x$p],laya.webgl.utils.RenderSprite3D.recycleTarget),x$_.addRenderObject(x$x),(x$n=x$fb.create(6)).blendMode=x$O,x$_.addRenderObject(x$n)}x$_.ctx.restore()}else x$E._fun.call(x$E,x$b,x$_,x$s,x$h)},x$_._blend=function(x$b,x$_,x$s,x$h){var x$x=x$b._style,x$n=this._next;x$x.blendMode?(x$_.ctx.save(),x$_.ctx.globalCompositeOperation=x$x.blendMode,x$n._fun.call(x$n,x$b,x$_,x$s,x$h),x$_.ctx.restore()):x$n._fun.call(x$n,x$b,x$_,x$s,x$h)},x$_._transform=function(x$b,x$_,x$s,x$h){var x$x=x$b.transform,x$n=this._next;if(x$x&&x$n!=x$R.NORENDER){var x$E=x$_.ctx;x$b._style;x$x.tx=x$s,x$x.ty=x$h;var x$C=x$E._getTransformMatrix(),x$O=x$C.clone();x$r.mul(x$x,x$C,x$C),x$C._checkTransform(),x$x.tx=x$x.ty=0,x$n._fun.call(x$n,x$b,x$_,0,0),x$O.copyTo(x$C),x$O.destroy()}else x$n._fun.call(x$n,x$b,x$_,x$s,x$h)},x$w.tmpTarget=function(x$b,x$_){var x$s=x$b.getValue("bounds"),x$h=x$zb.create(x$s.width,x$s.height);x$h.start(),x$h.clear(0,0,0,0),x$b.addValue("tmpTarget",x$h)},x$w.endTmpTarget=function(x$b){x$b.getValue("tmpTarget").end()},x$w.recycleTarget=function(x$b){x$b.getValue("tmpTarget").recycle(),x$b.recycle()},x$E(x$w,["tempUV",function(){return this.tempUV=new Array(8)}]),x$w}(),x$kb=function(x$b){function x$_(){this.data=null,x$_.__super.call(this)}x$P(x$_,"laya.filters.webgl.ColorFilterActionGL",x$a);var x$s=x$_.prototype;return x$D.imps(x$s,{"laya.filters.IFilterActionGL":!0}),x$s.setValue=function(x$b){x$b.colorMat=this.data._mat,x$b.colorAlpha=this.data._alpha},x$s.apply3d=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$b.getValue("bounds"),x$E=x$Mb.create(1,0);x$E.setFilters([this.data]);var x$C=x$r.TEMP;x$C.identity(),x$s.ctx.drawTarget(x$b,0,0,x$n.width,x$n.height,x$C,"src",x$E)},x$_}(),x$Bb=function(x$b){function x$n(x$b,x$_,x$s,x$h,x$x){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,x$n.__super.call(this,x$b,x$_,x$x),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new x$Ab,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=x$s,this._atlasCanvas.height=x$h,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}x$P(x$n,"laya.webgl.atlas.Atlaser",x$d);var x$_=x$n.prototype;return x$_.computeUVinAtlasTexture=function(x$b,x$_,x$s,x$h){var x$x=x$I.atlasTextureWidth,x$n=x$I.atlasTextureHeight,x$E=x$s/x$x,x$C=x$h/x$n,x$O=(x$s+x$b.bitmap.width)/x$x,x$L=(x$h+x$b.bitmap.height)/x$n,x$f=x$b.bitmap.width/x$x,x$p=x$b.bitmap.height/x$n;x$b.uv=[x$E+x$_[0]*x$f,x$C+x$_[1]*x$p,x$O-(1-x$_[2])*x$f,x$C+x$_[3]*x$p,x$O-(1-x$_[4])*x$f,x$L-(1-x$_[5])*x$p,x$E+x$_[6]*x$f,x$L-(1-x$_[7])*x$p]},x$_.findBitmapIsExist=function(x$b){if(x$b instanceof laya.webgl.resource.WebGLImage){var x$_=x$b,x$s=x$_.url,x$h=this._InAtlasWebGLImagesKey[x$s||x$_.id];if(x$h)return x$h.offsetInfoID}return-1},x$_.addToAtlasTexture=function(x$b,x$_,x$s){if(x$b instanceof laya.webgl.resource.WebGLImage){var x$h=x$b,x$x=x$h.url;this._InAtlasWebGLImagesKey[x$x||x$h.id]={bitmap:x$b,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([x$_,x$s])}this._atlasCanvas.texSubImage2D(x$_,x$s,x$b.atlasSource),x$b.clearAtlasSource()},x$_.addToAtlas=function(x$b,x$_,x$s){x$b._atlasID=this._inAtlasTextureKey.length;var x$h=x$b.uv.slice(),x$x=x$b.bitmap;this._inAtlasTextureKey.push(x$b),this._inAtlasTextureOriUVValue.push(x$h),this._inAtlasTextureBitmapValue.push(x$x),this.computeUVinAtlasTexture(x$b,x$h,x$_,x$s),x$b.bitmap=this._atlasCanvas},x$_.clear=function(){for(var x$b=0,x$_=this._inAtlasTextureKey.length;x$b<x$_;x$b++)this._inAtlasTextureKey[x$b].bitmap=this._inAtlasTextureBitmapValue[x$b],this._inAtlasTextureKey[x$b].uv=this._inAtlasTextureOriUVValue[x$b],this._inAtlasTextureKey[x$b]._atlasID=-1,this._inAtlasTextureKey[x$b].bitmap.lock=!1,this._inAtlasTextureKey[x$b].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},x$_.dispose=function(){this.clear(),this._atlasCanvas.destroy()},x$h(0,x$_,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),x$h(0,x$_,"texture",function(){return this._atlasCanvas}),x$h(0,x$_,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),x$n}(),x$Sb=function(x$b){function x$s(){x$s.__super.call(this,x$s.__name2int,x$s.__int2name,x$s.__int2nameMap)}return x$P(x$s,"laya.webgl.shader.d2.ShaderDefines2D",x$j),x$s.__init__=function(){x$s.reg("TEXTURE2D",1),x$s.reg("COLOR2D",2),x$s.reg("PRIMITIVE",4),x$s.reg("GLOW_FILTER",8),x$s.reg("BLUR_FILTER",16),x$s.reg("COLOR_FILTER",32),x$s.reg("COLOR_ADD",64),x$s.reg("WORLDMAT",128),x$s.reg("FILLTEXTURE",256),x$s.reg("FSHIGHPRECISION",1024),x$s.reg("TXTALPHA",2048),x$s.reg("TXTCOMPRESS",4096)},x$s.reg=function(x$b,x$_){x$j._reg(x$b,x$_,x$s.__name2int,x$s.__int2name)},x$s.toText=function(x$b,x$_,x$s){return x$j._toText(x$b,x$_,x$s)},x$s.toInt=function(x$b){return x$j._toInt(x$b,x$s.__name2int)},x$s.TEXTURE2D=1,x$s.COLOR2D=2,x$s.PRIMITIVE=4,x$s.FILTERGLOW=8,x$s.FILTERBLUR=16,x$s.FILTERCOLOR=32,x$s.COLORADD=64,x$s.WORLDMAT=128,x$s.FILLTEXTURE=256,x$s.SKINMESH=512,x$s.SHADERDEFINE_FSHIGHPRECISION=1024,x$s.TXTALPHA=2048,x$s.TXTCOMPRESS=4096,x$s.__name2int={},x$s.__int2name=[],x$s.__int2nameMap=[],x$s}(),x$Zb=(function(x$b){function x$C(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$C.__super.call(this,x$b,x$_,x$s,x$h,40,x$x,x$n,x$E)}x$P(x$C,"laya.webgl.shapes.Ellipse",x$sb)}(),function(x$b){function x$n(x$b,x$_,x$s,x$h,x$x){this._points=[],this.rebuild(x$s),x$n.__super.call(this,x$b,x$_,0,0,0,x$x,x$h,x$x,0)}x$P(x$n,"laya.webgl.shapes.Line",x$sb);var x$_=x$n.prototype;return x$_.rebuild=function(x$b){var x$_=x$b.length;x$_!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(x$_/2-1)),this.mFloat32Array=new Float32Array(5*x$_)),this._points.length=0;for(var x$s=NaN,x$h=NaN,x$x=-1,x$n=-1,x$E=x$b.length/2,x$C=0;x$C<x$E;x$C++)x$s=x$b[2*x$C],x$h=x$b[2*x$C+1],(.01<Math.abs(x$x-x$s)||.01<Math.abs(x$n-x$h))&&this._points.push(x$s,x$h),x$x=x$s,x$n=x$h},x$_.getData=function(x$b,x$_,x$s){var x$h=[],x$x=[];0<this.borderWidth&&this.createLine2(this._points,x$h,this.borderWidth,x$s,x$x,this._points.length/2),this.mUint16Array.set(x$h,0),this.mFloat32Array.set(x$x,0),x$b.append(this.mUint16Array),x$_.append(this.mFloat32Array)},x$n}()),x$Jb=function(x$b){function x$p(x$b,x$_,x$s,x$h,x$x){this._points=[];for(var x$n=NaN,x$E=NaN,x$C=-1,x$O=-1,x$L=x$s.length/2-1,x$f=0;x$f<x$L;x$f++)x$n=x$s[2*x$f],x$E=x$s[2*x$f+1],(.01<Math.abs(x$C-x$n)||.01<Math.abs(x$O-x$E))&&this._points.push(x$n,x$E),x$C=x$n,x$O=x$E;x$n=x$s[2*x$L],x$E=x$s[2*x$L+1],x$C=this._points[0],x$O=this._points[1],(.01<Math.abs(x$C-x$n)||.01<Math.abs(x$O-x$E))&&this._points.push(x$n,x$E),x$p.__super.call(this,x$b,x$_,0,0,this._points.length/2,0,x$h,x$x)}x$P(x$p,"laya.webgl.shapes.LoopLine",x$sb);var x$_=x$p.prototype;return x$_.getData=function(x$b,x$_,x$s){if(0<this.borderWidth){for(var x$h=this.color,x$x=(x$h>>16&255)/255,x$n=(x$h>>8&255)/255,x$E=(255&x$h)/255,x$C=[],x$O=0,x$L=0,x$f=[],x$p=Math.floor(this._points.length/2),x$P=0;x$P<x$p;x$P++)x$O=this._points[2*x$P],x$L=this._points[2*x$P+1],x$C.push(this.x+x$O,this.y+x$L,x$x,x$n,x$E);this.createLoopLine(x$C,x$f,this.borderWidth,x$s+x$C.length/5),x$b.append(new Uint16Array(x$f)),x$_.append(new Float32Array(x$C))}},x$_.createLoopLine=function(x$b,x$_,x$s,x$h,x$x,x$n){x$b.length;var x$E=x$b.concat(),x$C=x$x||x$b,x$O=this.borderColor,x$L=(x$O>>16&255)/255,x$f=(x$O>>8&255)/255,x$p=(255&x$O)/255,x$P=[x$E[0],x$E[1]],x$V=[x$E[x$E.length-5],x$E[x$E.length-4]],x$Q=x$V[0]+.5*(x$P[0]-x$V[0]),x$y=x$V[1]+.5*(x$P[1]-x$V[1]);x$E.unshift(x$Q,x$y,0,0,0),x$E.push(x$Q,x$y,0,0,0);var x$w,x$i,x$R,x$t,x$c,x$$,x$D,x$o,x$M,x$r,x$k,x$B,x$S,x$Z,x$J,x$W,x$T,x$q,x$U,x$G,x$z=x$E.length/5,x$a=x$h,x$K=x$s/2;x$R=x$E[0],x$t=x$E[1],x$r=x$R-(x$c=x$E[5]),x$M=(x$M=-(x$t-(x$$=x$E[6])))/(x$G=Math.sqrt(x$M*x$M+x$r*x$r))*x$K,x$r=x$r/x$G*x$K,x$C.push(x$R-x$M,x$t-x$r,x$L,x$f,x$p,x$R+x$M,x$t+x$r,x$L,x$f,x$p);for(var x$d=1;x$d<x$z-1;x$d++)x$R=x$E[5*(x$d-1)],x$t=x$E[5*(x$d-1)+1],x$c=x$E[5*x$d],x$$=x$E[5*x$d+1],x$D=x$E[5*(x$d+1)],x$o=x$E[5*(x$d+1)+1],x$r=x$R-x$c,x$B=x$c-x$D,x$J=(-(x$M=(x$M=-(x$t-x$$))/(x$G=Math.sqrt(x$M*x$M+x$r*x$r))*x$K)+x$R)*(-(x$r=x$r/x$G*x$K)+x$$)-(-x$M+x$c)*(-x$r+x$t),x$q=(-(x$k=(x$k=-(x$$-x$o))/(x$G=Math.sqrt(x$k*x$k+x$B*x$B))*x$K)+x$D)*(-(x$B=x$B/x$G*x$K)+x$$)-(-x$k+x$c)*(-x$B+x$o),x$U=(x$S=-x$r+x$t-(-x$r+x$$))*(x$T=-x$k+x$c-(-x$k+x$D))-(x$W=-x$B+x$o-(-x$B+x$$))*(x$Z=-x$M+x$c-(-x$M+x$R)),Math.abs(x$U)<.1?(x$U+=10.1,x$C.push(x$c-x$M,x$$-x$r,x$L,x$f,x$p,x$c+x$M,x$$+x$r,x$L,x$f,x$p)):(((x$w=(x$Z*x$q-x$T*x$J)/x$U)-x$c)*(x$w-x$c)+((x$i=(x$W*x$J-x$S*x$q)/x$U)-x$$)+(x$i-x$$),x$C.push(x$w,x$i,x$L,x$f,x$p,x$c-(x$w-x$c),x$$-(x$i-x$$),x$L,x$f,x$p));x$n&&(x$_=x$n);var x$I=this.edges+1;for(x$d=1;x$d<x$I;x$d++)x$_.push(x$a+2*(x$d-1),x$a+2*(x$d-1)+1,x$a+2*x$d+1,x$a+2*x$d+1,x$a+2*x$d,x$a+2*(x$d-1));return x$_.push(x$a+2*(x$d-1),x$a+2*(x$d-1)+1,x$a+1,x$a+1,x$a,x$a+2*(x$d-1)),x$C},x$p}(),x$Wb=function(x$b){function x$E(x$b,x$_,x$s,x$h,x$x,x$n){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=x$r.create(),this._points=x$s.slice(0,x$s.length),x$E.__super.call(this,x$b,x$_,0,0,this._points.length/2,x$h,x$x,x$n)}x$P(x$E,"laya.webgl.shapes.Polygon",x$sb);var x$_=x$E.prototype;return x$_.rebuild=function(x$b){this._repaint||(this._points.length=0,this._points=this._points.concat(x$b))},x$_.setMatrix=function(x$b){x$b.copyTo(this._mat)},x$_.needUpdate=function(x$b){return this._repaint=this._mat.a==x$b.a&&this._mat.b==x$b.b&&this._mat.c==x$b.c&&this._mat.d==x$b.d&&this._mat.tx==x$b.tx&&this._mat.ty==x$b.ty,!this._repaint},x$_.getData=function(x$b,x$_,x$s){var x$h,x$x=0,x$n=this._points,x$E=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=x$s){for(this._start=x$s,x$h=[],x$E=this.earcutTriangles.length,x$x=0;x$x<x$E;x$x++)x$h.push(this.earcutTriangles[x$x]+x$s);this.mUint16Array=new Uint16Array(x$h)}}else{this._start=x$s,x$h=[];var x$C=[],x$O=[],x$L=this.color,x$f=(x$L>>16&255)/255,x$p=(x$L>>8&255)/255,x$P=(255&x$L)/255;for(x$E=Math.floor(x$n.length/2),x$x=0;x$x<x$E;x$x++)x$C.push(this.x+x$n[2*x$x],this.y+x$n[2*x$x+1],x$f,x$p,x$P),x$O.push(this.x+x$n[2*x$x],this.y+x$n[2*x$x+1]);for(this.earcutTriangles=x$hb.earcut(x$O,null,2),x$E=this.earcutTriangles.length,x$x=0;x$x<x$E;x$x++)x$h.push(this.earcutTriangles[x$x]+x$s);this.mUint16Array=new Uint16Array(x$h),this.mFloat32Array=new Float32Array(x$C)}x$b.append(this.mUint16Array),x$_.append(this.mFloat32Array)},x$E}(),x$Tb=function(x$b){function x$n(){this._matrix=new x$r,this._matrix4=x$yb.defaultMatrix4.concat(),x$n.__super.call(this,1e4),this.shaderValue=new x$Mb(0,0)}x$P(x$n,"laya.webgl.submit.SubmitCanvas",x$nb);var x$_=x$n.prototype;return x$_.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var x$b=x$Rb.worldAlpha,x$_=x$Rb.worldMatrix4,x$s=x$Rb.worldMatrix,x$h=x$Rb.worldFilters,x$x=x$Rb.worldShaderDefines,x$n=this.shaderValue,x$E=this._matrix,x$C=this._matrix4,x$O=x$r.TEMP;return x$r.mul(x$E,x$s,x$O),x$C[0]=x$O.a,x$C[1]=x$O.b,x$C[4]=x$O.c,x$C[5]=x$O.d,x$C[12]=x$O.tx,x$C[13]=x$O.ty,x$Rb.worldMatrix=x$O.clone(),x$Rb.worldMatrix4=x$C,x$Rb.worldAlpha=x$Rb.worldAlpha*x$n.alpha,x$n.filters&&x$n.filters.length&&(x$Rb.worldFilters=x$n.filters,x$Rb.worldShaderDefines=x$n.defines),this._ctx_src.flush(),x$Rb.worldAlpha=x$b,x$Rb.worldMatrix4=x$_,x$Rb.worldMatrix.destroy(),x$Rb.worldMatrix=x$s,x$Rb.worldFilters=x$h,x$Rb.worldShaderDefines=x$x,1},x$_.releaseRender=function(){var x$b=x$n._cache;this._ctx_src=null,x$b[x$b._length++]=this},x$_.getRenderType=function(){return 10003},x$n.create=function(x$b,x$_,x$s){var x$h=x$n._cache._length?x$n._cache[--x$n._cache._length]:new x$n;x$h._ctx_src=x$b;var x$x=x$h.shaderValue;return x$x.alpha=x$_,x$x.defines.setValue(0),x$s&&x$s.length&&x$x.setFilters(x$s),x$h},x$n._cache=((x$n._cache=[])._length=0,x$n._cache),x$n}(),x$qb=function(x$b){function x$L(x$b){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===x$b&&(x$b=1e4),x$L.__super.call(this,x$b)}x$P(x$L,"laya.webgl.submit.SubmitTexture",x$nb);var x$_=x$L.prototype;return x$_.releaseRender=function(){var x$b=x$L._cache;(x$b[x$b._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},x$_.addTexture=function(x$b,x$_){this._texsID[this._texs.length]=x$b._uvID,this._texs.push(x$b),this._vbPos.push(x$_)},x$_.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var x$b=this.shaderValue.textureHost.bitmap;if(null!==x$b)for(var x$_=this._vb.getFloat32Array(),x$s=0,x$h=this._texs.length;x$s<x$h;x$s++){var x$x=this._texs[x$s];x$x.active();var x$n=x$x.uv;if(this._texsID[x$s]!==x$x._uvID){this._texsID[x$s]=x$x._uvID;var x$E=this._vbPos[x$s];x$_[x$E+2]=x$n[0],x$_[x$E+3]=x$n[1],x$_[x$E+6]=x$n[2],x$_[x$E+7]=x$n[3],x$_[x$E+10]=x$n[4],x$_[x$E+11]=x$n[5],x$_[x$E+14]=x$n[6],x$_[x$E+15]=x$n[7],this._vb.setNeedUpload()}x$x.bitmap!==x$b&&(this._isSameTexture=!1)}}},x$_.renderSubmit=function(){if(0===this._numEle)return x$L._shaderSet=!1,1;var x$b=this.shaderValue.textureHost;if(x$b){var x$_=x$b.source;if(!x$b.bitmap||!x$_)return x$L._shaderSet=!1,1;this.shaderValue.texture=x$_,x$b.alphaTexture&&x$b.alphaTexture.source&&(this.shaderValue.texture1=x$b.alphaTexture.source)}this._vb.bind_upload(this._ib);var x$s=x$cb.mainContext;if(x$F.activeBlendFunction!==this._blendFn&&(x$s.enable(3042),this._blendFn(x$s),x$F.activeBlendFunction=this._blendFn),x$J.drawCall++,x$J.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&x$Gb.activeShader&&x$L._shaderSet?(x$Gb.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&x$Gb.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),x$L._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var x$h=x$b.bitmap,x$x=0,x$n=x$Gb.activeShader,x$E=0,x$C=this._texs.length;x$E<x$C;x$E++){var x$O=this._texs[x$E];x$O.bitmap===x$h&&x$E+1!==x$C||(x$n.uploadTexture2D(x$O.source),x$s.drawElements(4,6*(x$E-x$x+1),5123,this._startIdx+6*x$x*x$yb.BYTES_PIDX),x$h=x$O.bitmap,x$x=x$E)}else x$s.drawElements(4,this._numEle,5123,this._startIdx);return 1},x$L.create=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$L._cache._length?x$L._cache[--x$L._cache._length]:new x$L;null==x$s&&((x$s=x$n._selfVb||(x$n._selfVb=x$jb.create(-1))).clear(),x$h=0),x$n._ib=x$_,x$n._vb=x$s,x$n._startIdx=x$h*x$yb.BYTES_PIDX,x$n._numEle=0;var x$E=x$b._nBlendType;x$n._blendFn=x$b._targets?x$F.targetFns[x$E]:x$F.fns[x$E],x$n.shaderValue=x$x,x$n.shaderValue.setValue(x$b._shader2D);var x$C=x$b._shader2D.filters;return x$C&&x$n.shaderValue.setFilters(x$C),x$n},x$L._cache=((x$L._cache=[])._length=0,x$L._cache),x$L._shaderSet=!0,x$L}(),x$Ub=function(x$b){function x$i(){x$i.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}x$P(x$i,"laya.webgl.utils.MeshTexture",x$ib);var x$_=x$i.prototype;return x$_.addData=function(x$b,x$_,x$s,x$h,x$x,x$n){for(var x$E=x$b.length/2,x$C=this._vb.needSize(x$E*x$i.const_stride)>>2,x$O=this._vb.getFloat32Array(),x$L=0,x$f=0;x$f<x$E;x$f++){var x$p=x$b[x$L],x$P=x$b[x$L+1],x$V=x$p*x$h.a+x$P*x$h.c+x$h.tx,x$Q=x$p*x$h.b+x$P*x$h.d+x$h.ty;x$O[x$C++]=x$V,x$O[x$C++]=x$Q,x$O[x$C++]=x$_[x$L],x$O[x$C++]=x$_[x$L+1],x$L+=2}this._vb.setNeedUpload();var x$y=this.vertNum;if(0<x$y){(x$E=x$s.length)>x$i.tmpIdx.length&&(x$i.tmpIdx=new Uint16Array(x$E));for(var x$w=0;x$w<x$E;x$w++)x$i.tmpIdx[x$w]=x$s[x$w]+x$y;this._ib.appendU16Array(x$i.tmpIdx,x$s.length)}else this._ib.append(x$s);this._ib.setNeedUpload(),this.vertNum+=x$E,this.indexNum+=x$s.length},x$_.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},x$_.destroy=function(){this._ib.destroy(),this._vb.destroy()},x$i.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new x$i},x$i.const_stride=16,x$i._POOL=[],x$E(x$i,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),x$i}(),x$Gb=function(x$b){function x$_(){x$_.__super.call(this),this.lock=!0}return x$P(x$_,"laya.webgl.shader.BaseShader",x$t),x$_.activeShader=null,x$_.bindShader=null,x$_}(),x$zb=function(x$_){function x$f(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===x$s&&(x$s=6408),void 0===x$h&&(x$h=5121),void 0===x$x&&(x$x=34041),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=-1),void 0===x$O&&(x$O=-1),this._type=1,this._w=x$b,this._h=x$_,this._surfaceFormat=x$s,this._surfaceType=x$h,this._depthStencilFormat=x$x,x$i.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=x$n,this._repeat=x$E,this._minFifter=x$C,this._magFifter=x$O,this._createWebGLRenderTarget(),this.bitmap.lock=!0,x$f.__super.call(this,this.bitmap,x$U.INV_UV)}x$P(x$f,"laya.webgl.resource.RenderTarget2D",x$_);var x$b=x$f.prototype;return x$D.imps(x$b,{"laya.resource.IDispose":!0}),x$b.getType=function(){return this._type},x$b.getTexture=function(){return this},x$b.size=function(x$b,x$_){this._w==x$b&&this._h==x$_||(this._w=x$b,this._h=x$_,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},x$b.release=function(){this.destroy()},x$b.recycle=function(){x$f.POOL.push(this)},x$b.start=function(){var x$b=x$cb.mainContext;return this._preRenderTarget=x$Rb.curRenderTarget,x$Rb.curRenderTarget=this,x$b.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(x$b.viewport(0,0,this._w,this._h),this._svWidth=x$Rb.width,this._svHeight=x$Rb.height,x$Rb.width=this._w,x$Rb.height=this._h,x$Gb.activeShader=null),this},x$b.clear=function(x$b,x$_,x$s,x$h){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=1);var x$x=x$cb.mainContext;x$x.clearColor(x$b,x$_,x$s,x$h);var x$n=16384;switch(this._depthStencilFormat){case 33189:x$n|=256;break;case 36168:x$n|=1024;break;case 34041:x$n|=256,x$n|=1024}x$x.clear(x$n)},x$b.end=function(){var x$b=x$cb.mainContext;x$b.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,x$Rb.curRenderTarget=this._preRenderTarget,1==this._type?(x$b.viewport(0,0,this._svWidth,this._svHeight),x$Rb.width=this._svWidth,x$Rb.height=this._svHeight,x$Gb.activeShader=null):x$b.viewport(0,0,x$D.stage.width,x$D.stage.height)},x$b.getData=function(x$b,x$_,x$s,x$h){var x$x=x$cb.mainContext;if(x$x.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===x$x.checkFramebufferStatus(36160)))return x$x.bindFramebuffer(36160,null),null;var x$n=new Uint8Array(this._w*this._h*4);return x$x.readPixels(x$b,x$_,x$s,x$h,this._surfaceFormat,this._surfaceType,x$n),x$x.bindFramebuffer(36160,null),x$n},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,x$_.prototype.destroy.call(this))},x$b.dispose=function(){},x$b._createWebGLRenderTarget=function(){this.bitmap=new x$Nb(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(x$b){this.event("recovered")})},x$h(0,x$b,"surfaceFormat",function(){return this._surfaceFormat}),x$h(0,x$b,"magFifter",function(){return this._magFifter}),x$h(0,x$b,"surfaceType",function(){return this._surfaceType}),x$h(0,x$b,"mipMap",function(){return this._mipMap}),x$h(0,x$b,"depthStencilFormat",function(){return this._depthStencilFormat}),x$h(0,x$b,"minFifter",function(){return this._minFifter}),x$h(0,x$b,"source",function(){return this._alreadyResolved?x$D.superGet(x$U,this,"source"):null}),x$f.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){void 0===x$s&&(x$s=6408),void 0===x$h&&(x$h=5121),void 0===x$x&&(x$x=34041),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=-1),void 0===x$O&&(x$O=-1);var x$L=x$f.POOL.pop();return x$L||(x$L=new x$f(x$b,x$_)),x$L.bitmap&&x$L._w==x$b&&x$L._h==x$_&&x$L._surfaceFormat==x$s&&x$L._surfaceType==x$h&&x$L._depthStencilFormat==x$x&&x$L._mipMap==x$n&&x$L._repeat==x$E&&x$L._minFifter==x$C&&x$L._magFifter==x$O||(x$L._w=x$b,x$L._h=x$_,x$L._surfaceFormat=x$s,x$L._surfaceType=x$h,x$L._depthStencilFormat=x$x,x$i.isConchWebGL&&34041===x$L._depthStencilFormat&&(x$L._depthStencilFormat=33189),x$L._mipMap=x$n,x$L._repeat=x$E,x$L._minFifter=x$C,x$L._magFifter=x$O,x$L.release(),x$L._createWebGLRenderTarget()),x$L},x$f.TYPE2D=1,x$f.TYPE3D=2,x$f.POOL=[],x$f}(x$U),x$ab=function(x$b){function x$_(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,x$_.__super.call(this),x$_._gl=x$cb.mainContext}x$P(x$_,"laya.webgl.utils.Buffer",x$t);var x$s=x$_.prototype;return x$s._bind=function(){this.activeResource(),x$_._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(x$_._bindVertexBuffer=this._glBuffer),x$_._gl.bindBuffer(this._bufferType,x$_._bindActive[this._bufferType]=this._glBuffer),x$Gb.activeShader=null)},x$s.recreateResource=function(){this._glBuffer||(this._glBuffer=x$_._gl.createBuffer()),this.completeCreate()},x$s.disposeResource=function(){this._glBuffer&&(x$cb.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},x$h(0,x$s,"bufferUsage",function(){return this._bufferUsage}),x$_._gl=null,x$_._bindActive={},x$_._bindVertexBuffer=null,x$_._enableAtributes=[],x$_}(),x$Kb=function(x$b){function x$s(x$b){this.texcoord=null,this.offsetX=300,this.offsetY=0,x$s.__super.call(this,512,0);var x$_=8*x$yb.BYTES_PE;this.position=[2,5126,!1,x$_,0],this.texcoord=[2,5126,!1,x$_,2*x$yb.BYTES_PE],this.color=[4,5126,!1,x$_,4*x$yb.BYTES_PE]}return x$P(x$s,"laya.webgl.shader.d2.skinAnishader.SkinSV",x$Mb),x$s}(),x$db=function(x$b){function x$_(x$b){x$_.__super.call(this,2,0),this.color=[]}return x$P(x$_,"laya.webgl.shader.d2.value.Color2dSV",x$Mb),x$_.prototype.setValue=function(x$b){x$b.fillStyle&&(this.color=x$b.fillStyle._color._color),x$b.strokeStyle&&(this.color=x$b.strokeStyle._color._color)},x$_}(),x$Ib=function(x$b){function x$_(x$b){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=x$Mb._TEXCOORD,x$_.__super.call(this,256,0)}x$P(x$_,"laya.webgl.shader.d2.value.FillTextureSV",x$Mb);var x$s=x$_.prototype;return x$s.setValue=function(x$b){this.ALPHA=x$b.ALPHA,x$b.filters&&this.setFilters(x$b.filters)},x$s.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},x$_}(),x$gb=function(x$b){function x$_(x$b){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=x$Mb._TEXCOORD,void 0===x$b&&(x$b=0),x$_.__super.call(this,1,x$b)}x$P(x$_,"laya.webgl.shader.d2.value.TextureSV",x$Mb);var x$s=x$_.prototype;return x$s.setValue=function(x$b){this.ALPHA=x$b.ALPHA,x$b.filters&&this.setFilters(x$b.filters)},x$s.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},x$_}(),x$Fb=function(x$b){function x$_(x$b){this.a_color=null,this.u_pos=[0,0],x$_.__super.call(this,4,0),this.position=[2,5126,!1,5*x$yb.BYTES_PE,0],this.a_color=[3,5126,!1,5*x$yb.BYTES_PE,2*x$yb.BYTES_PE]}return x$P(x$_,"laya.webgl.shader.d2.value.PrimitiveSV",x$Mb),x$_}(),x$Ab=function(x$b){function x$_(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,x$_.__super.call(this)}x$P(x$_,"laya.webgl.atlas.AtlasWebGLCanvas",x$b);var x$s=x$_.prototype;return x$s.recreateResource=function(){var x$b=x$cb.mainContext,x$_=this._source=x$b.createTexture(),x$s=x$$b.curBindTexTarget,x$h=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,x$_),x$b.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),x$b.texParameteri(3553,10241,9729),x$b.texParameteri(3553,10240,9729),x$b.texParameteri(3553,10242,33071),x$b.texParameteri(3553,10243,33071),x$s&&x$h&&x$$b.bindTexture(x$b,x$s,x$h),this.memorySize=this._w*this._h*4,this.completeCreate()},x$s.disposeResource=function(){this._source&&(x$cb.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},x$s.texSubImage2D=function(x$b,x$_,x$s){if(x$i.isFlash){this._flashCacheImage||(this._flashCacheImage=x$y.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var x$h=x$s.bitmapdata;this._flashCacheImage._image.copyPixels(x$h,0,0,x$h.width,x$h.height,x$b,x$_),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var x$x=x$cb.mainContext,x$n=x$$b.curBindTexTarget,x$E=x$$b.curBindTexValue;x$$b.bindTexture(x$x,3553,this._source),x$x.pixelStorei(37441,!0),0<=x$b-1&&x$x.texSubImage2D(3553,0,x$b-1,x$_,6408,5121,x$s),x$b+1<=this._w&&x$x.texSubImage2D(3553,0,x$b+1,x$_,6408,5121,x$s),0<=x$_-1&&x$x.texSubImage2D(3553,0,x$b,x$_-1,6408,5121,x$s),x$_+1<=this._h&&x$x.texSubImage2D(3553,0,x$b,x$_+1,6408,5121,x$s),x$x.texSubImage2D(3553,0,x$b,x$_,6408,5121,x$s),x$x.pixelStorei(37441,!1),x$n&&x$E&&x$$b.bindTexture(x$x,x$n,x$E)}},x$s.texSubImage2DPixel=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$cb.mainContext,x$E=x$$b.curBindTexTarget,x$C=x$$b.curBindTexValue;x$$b.bindTexture(x$n,3553,this._source);var x$O=new Uint8Array(x$x.data);x$n.pixelStorei(37441,!0),x$n.texSubImage2D(3553,0,x$b,x$_,x$s,x$h,6408,5121,x$O),x$n.pixelStorei(37441,!1),x$E&&x$C&&x$$b.bindTexture(x$n,x$E,x$C)},x$h(0,x$s,"width",x$b.prototype._$get_width,function(x$b){this._w=x$b}),x$h(0,x$s,"height",x$b.prototype._$get_height,function(x$b){this._h=x$b}),x$_}(x$s),x$ub=function(x$b){function x$x(){this.flipY=!0,this.alwaysChange=!1,x$x.__super.call(this)}x$P(x$x,"laya.webgl.resource.WebGLCanvas",x$s);var x$_=x$x.prototype;return x$_.getCanvas=function(){return this._canvas},x$_.clear=function(){this._ctx&&this._ctx.clear()},x$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},x$_._setContext=function(x$b){this._ctx=x$b},x$_.getContext=function(x$b,x$_){return this._ctx?this._ctx:this._ctx=x$x._createContext(this)},x$_.size=function(x$b,x$_){this._w==x$b&&this._h==x$_||(this._w=x$b,this._h=x$_,this._ctx&&this._ctx.size(x$b,x$_),this._canvas&&(this._canvas.height=x$_,this._canvas.width=x$b))},x$_.activeResource=function(x$b){void 0===x$b&&(x$b=!1),this._source||this.recreateResource()},x$_.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},x$_.disposeResource=function(){this._source&&!this.iscpuSource&&(x$cb.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},x$_.createWebGlTexture=function(){var x$b=x$cb.mainContext;this._canvas;var x$_=this._source=x$b.createTexture();this.iscpuSource=!1;var x$s=x$$b.curBindTexTarget,x$h=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,x$_),x$b.pixelStorei(37440,this.flipY?1:0),x$x.premulAlpha&&x$b.pixelStorei(37441,!0),x$b.texImage2D(3553,0,6408,6408,5121,this._imgData),x$x.premulAlpha&&x$b.pixelStorei(37441,!1),x$b.texParameteri(3553,10240,9729),x$b.texParameteri(3553,10241,9729),x$b.texParameteri(3553,10242,33071),x$b.texParameteri(3553,10243,33071),x$b.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,x$s&&x$h&&x$$b.bindTexture(x$b,x$s,x$h)},x$_.reloadCanvasData=function(){var x$b=x$cb.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var x$_=x$$b.curBindTexTarget,x$s=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,this._source),x$x.premulAlpha&&x$b.pixelStorei(37441,!0),x$b.texImage2D(3553,0,6408,6408,5121,this._imgData),x$x.premulAlpha&&x$b.pixelStorei(37441,!1),x$b.pixelStorei(37440,0),x$_&&x$s&&x$$b.bindTexture(x$b,x$_,x$s)},x$_.texSubImage2D=function(x$b,x$_,x$s){var x$h=x$cb.mainContext,x$x=x$$b.curBindTexTarget,x$n=x$$b.curBindTexValue;x$$b.bindTexture(x$h,3553,this._source),x$h.pixelStorei(37441,!0),x$h.texSubImage2D(3553,0,x$_,x$s,6408,5121,x$b._source),x$h.pixelStorei(37441,!1),x$x&&x$n&&x$$b.bindTexture(x$h,x$x,x$n)},x$_.toBase64=function(x$b,x$_,x$s){var x$h=null;this._canvas&&(x$h=this._canvas.toDataURL(x$b,x$_)),x$s.call(this,x$h)},x$h(0,x$_,"context",function(){return this._ctx}),x$h(0,x$_,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),x$h(0,x$_,"asBitmap",null,function(x$b){this._ctx&&(this._ctx.asBitmap=x$b)}),x$x._createContext=null,x$x.premulAlpha=!1,x$x}(),x$lb=function(x$b){function x$n(x$b,x$_){this.CborderSize=12,x$n.__super.call(this),this.char=x$b,this.isSpace=" "===x$b,this.xs=x$_.scaleX,this.ys=x$_.scaleY,this.font=x$_.font.toString(),this.fontSize=x$_.font.size,this.fillColor=x$_.fillColor,this.borderColor=x$_.borderColor,this.lineWidth=x$_.lineWidth,this.underLine=x$_.underLine;var x$s,x$h=x$i.isConchApp;x$h?((x$s=ConchTextCanvas)._source=ConchTextCanvas,x$s._source.canvas=ConchTextCanvas):x$s=x$V.canvas.source,this.canvas=x$s,this._enableMerageInAtlas=!0,this._ctx=x$h?x$s:this.canvas.getContext("2d",void 0);var x$x=x$G.measureText(this.char,this.font);this.cw=x$x.width*this.xs,this.ch=(x$x.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new x$U(this)}x$P(x$n,"laya.webgl.resource.WebGLCharImage",x$s);var x$_=x$n.prototype;return x$D.imps(x$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),x$_.active=function(){this.texture.active()},x$_.recreateResource=function(){var x$b=x$i.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),x$b){var x$_=this.fontSize;1==this.xs&&1==this.ys||(x$_=parseInt(x$_*(this.xs>this.ys?this.xs:this.ys)+""));var x$s="normal 100 "+this.font;x$s=x$s.replace(x$n._fontSizeReg,x$_),this.borderColor&&(x$s+=" 1 "+this.borderColor),this._ctx.font=x$s,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,x$q.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var x$h=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(x$h,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},x$_.onresize=function(x$b,x$_){this._w=x$b,this._h=x$_,this._allowMerageInAtlas=!0},x$_.clearAtlasSource=function(){},x$h(0,x$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),x$h(0,x$_,"atlasSource",function(){return this.canvas}),x$h(0,x$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(x$b){this._enableMerageInAtlas=x$b}),x$n.createOneChar=function(x$b,x$_){return new x$n(x$b,x$_)},x$n._fontSizeReg=new RegExp("\\d+(?=px)","g"),x$n}(),x$Nb=function(x$b){function x$L(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){void 0===x$s&&(x$s=6408),void 0===x$h&&(x$h=5121),void 0===x$x&&(x$x=34041),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=-1),void 0===x$O&&(x$O=1),x$L.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=x$b,this._h=x$_,this._surfaceFormat=x$s,this._surfaceType=x$h,this._depthStencilFormat=x$x,this._mipMap=x$n,this._repeat=x$E,this._minFifter=x$C,this._magFifter=x$O}x$P(x$L,"laya.webgl.resource.WebGLRenderTarget",x$s);var x$_=x$L.prototype;return x$_.recreateResource=function(){var x$b=x$cb.mainContext;this._frameBuffer||(this._frameBuffer=x$b.createFramebuffer()),this._source||(this._source=x$b.createTexture());var x$_=x$$b.curBindTexTarget,x$s=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,this._source),x$b.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var x$h=this._minFifter,x$x=this._magFifter,x$n=this._repeat?10497:33071,x$E=x$f.isPOT(this._w,this._h);if(x$E?(this._mipMap?-1!==x$h||(x$h=9987):-1!==x$h||(x$h=9729),-1!==x$x||(x$x=9729),x$b.texParameteri(3553,10241,x$h),x$b.texParameteri(3553,10240,x$x),x$b.texParameteri(3553,10242,x$n),x$b.texParameteri(3553,10243,x$n),this._mipMap&&x$b.generateMipmap(3553)):(-1!==x$h||(x$h=9729),-1!==x$x||(x$x=9729),x$b.texParameteri(3553,10241,x$h),x$b.texParameteri(3553,10240,x$x),x$b.texParameteri(3553,10242,33071),x$b.texParameteri(3553,10243,33071)),x$b.bindFramebuffer(36160,this._frameBuffer),x$b.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=x$b.createRenderbuffer()),x$b.bindRenderbuffer(36161,this._depthStencilBuffer),x$b.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:x$b.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:x$b.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:x$b.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}x$b.bindFramebuffer(36160,null),x$_&&x$s&&x$$b.bindTexture(x$b,x$_,x$s),x$b.bindRenderbuffer(36161,null),x$E&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},x$_.disposeResource=function(){this._frameBuffer&&(x$cb.mainContext.deleteTexture(this._source),x$cb.mainContext.deleteFramebuffer(this._frameBuffer),x$cb.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},x$h(0,x$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),x$h(0,x$_,"frameBuffer",function(){return this._frameBuffer}),x$L}(),x$Xb=function(x$b){function x$C(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this.offsetX=0,this.offsetY=0,x$C.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=x$n,this.canvas=x$b,this._ctx=x$b.getContext("2d",void 0),this._w=x$h,this._h=x$x,this.offsetX=x$_,this.offsetY=x$s,this.src=x$E,this._enableMerageInAtlas=!0,x$I.enabled&&this._w<x$I.atlasLimitWidth&&this._h<x$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}x$P(x$C,"laya.webgl.resource.WebGLSubImage",x$s);var x$_=x$C.prototype;return x$D.imps(x$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),x$_.size=function(x$b,x$_){this._w=x$b,this._h=x$_,this._ctx&&this._ctx.size(x$b,x$_),this.canvas&&(this.canvas.height=x$_,this.canvas.width=x$b)},x$_.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},x$_.createWebGlTexture=function(){var x$b=x$cb.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var x$_=this._source=x$b.createTexture(),x$s=x$$b.curBindTexTarget,x$h=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,x$_),x$b.pixelStorei(37441,!0),x$b.texImage2D(3553,0,6408,6408,5121,this.canvas),x$b.pixelStorei(37441,!1);var x$x=this.minFifter,x$n=this.magFifter,x$E=this.repeat?10497:33071,x$C=x$f.isPOT(this.width,this.height);x$C?(this.mipmap?-1!==x$x||(x$x=9987):-1!==x$x||(x$x=9729),-1!==x$n||(x$n=9729),x$b.texParameteri(3553,10240,x$n),x$b.texParameteri(3553,10241,x$x),x$b.texParameteri(3553,10242,x$E),x$b.texParameteri(3553,10243,x$E),this.mipmap&&x$b.generateMipmap(3553)):(-1!==x$x||(x$x=9729),-1!==x$n||(x$n=9729),x$b.texParameteri(3553,10241,x$x),x$b.texParameteri(3553,10240,x$n),x$b.texParameteri(3553,10242,33071),x$b.texParameteri(3553,10243,33071)),x$s&&x$h&&x$$b.bindTexture(x$b,x$s,x$h),this.canvas=null,x$C&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},x$_.disposeResource=function(){x$I.enabled&&this._allowMerageInAtlas||!this._source||(x$cb.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},x$_.clearAtlasSource=function(){},x$h(0,x$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),x$h(0,x$_,"atlasSource",function(){return this.canvas}),x$h(0,x$_,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(x$b){this._allowMerageInAtlas=x$b}),x$C}(),x$Yb=function(x$b){function x$L(x$b,x$_,x$s,x$h){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,x$L.__super.call(this),!x$b||!x$_)throw"Shader Error";this._id=++x$L._count,this._vs=x$b,this._ps=x$_,this._nameMap=x$h||{},null!=x$s&&(x$L.sharders[x$s]=this)}x$P(x$L,"laya.webgl.shader.Shader",x$Gb);var x$_=x$L.prototype;return x$_.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},x$_.disposeResource=function(){x$cb.mainContext.deleteShader(this._vshader),x$cb.mainContext.deleteShader(this._pshader),x$cb.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},x$_._compile=function(){if(!x$cb.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var x$b=[this._vs,this._ps],x$_=x$cb.mainContext;if(this._program=x$_.createProgram(),this._vshader=x$L._createShader(x$_,x$b[0],35633),this._pshader=x$L._createShader(x$_,x$b[1],35632),x$_.attachShader(this._program,this._vshader),x$_.attachShader(this._program,this._pshader),x$_.linkProgram(this._program),!x$i.isConchApp&&!x$_.getProgramParameter(this._program,35714))throw x$_.getProgramInfoLog(this._program);var x$s,x$h,x$x=0,x$n=0;for(x$n=x$i.isConchApp?x$_.getProgramParameterEx(this._vs,this._ps,"",35721):x$_.getProgramParameter(this._program,35721),x$x=0;x$x<x$n;x$x++){var x$E=null;x$s={vartype:"attribute",glfun:null,ivartype:0,attrib:x$E=x$i.isConchApp?x$_.getActiveAttribEx(this._vs,this._ps,"",x$x):x$_.getActiveAttrib(this._program,x$x),location:x$_.getAttribLocation(this._program,x$E.name),name:x$E.name,type:x$E.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(x$s)}var x$C=0;for(x$C=x$i.isConchApp?x$_.getProgramParameterEx(this._vs,this._ps,"",35718):x$_.getProgramParameter(this._program,35718),x$x=0;x$x<x$C;x$x++){var x$O=null;x$O=x$i.isConchApp?x$_.getActiveUniformEx(this._vs,this._ps,"",x$x):x$_.getActiveUniform(this._program,x$x),0<(x$s={vartype:"uniform",glfun:null,ivartype:1,attrib:x$E,location:x$_.getUniformLocation(this._program,x$O.name),name:x$O.name,type:x$O.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(x$s.name=x$s.name.substr(0,x$s.name.length-3),x$s.isArray=!0,x$s.location=x$_.getUniformLocation(this._program,x$s.name)),this._params.push(x$s)}for(x$x=0,x$h=this._params.length;x$x<x$h;x$x++)if((x$s=this._params[x$x]).indexOfParams=x$x,x$s.index=1,x$s.value=[x$s.location,null],x$s.codename=x$s.name,x$s.name=this._nameMap[x$s.codename]?this._nameMap[x$s.codename]:x$s.codename,(this._paramsMap[x$s.name]=x$s)._this=this,x$s.uploadedValue=[],"attribute"!==x$s.vartype)switch(x$s.type){case 5124:x$s.fun=x$s.isArray?this._uniform1iv:this._uniform1i;break;case 5126:x$s.fun=x$s.isArray?this._uniform1fv:this._uniform1f;break;case 35664:x$s.fun=x$s.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:x$s.fun=x$s.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:x$s.fun=x$s.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:x$s.fun=this._uniform_sampler2D;break;case 35680:x$s.fun=this._uniform_samplerCube;break;case 35676:x$s.glfun=x$_.uniformMatrix4fv,x$s.fun=this._uniformMatrix4fv;break;case 35670:x$s.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else x$s.fun=this._attribute}},x$_.getUniform=function(x$b){return this._paramsMap[x$b]},x$_._attribute=function(x$b,x$_){var x$s=x$cb.mainContext,x$h=x$ab._enableAtributes,x$x=x$b.location;return x$h[x$x]||x$s.enableVertexAttribArray(x$x),x$s.vertexAttribPointer(x$x,x$_[0],x$_[1],x$_[2],x$_[3],x$_[4]+this._offset),x$h[x$x]=x$ab._bindVertexBuffer,1},x$_._uniform1f=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_?(x$cb.mainContext.uniform1f(x$b.location,x$s[0]=x$_),1):0},x$_._uniform1fv=function(x$b,x$_){if(x$_.length<4){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$cb.mainContext.uniform1fv(x$b.location,x$_),x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3],1):0}return x$cb.mainContext.uniform1fv(x$b.location,x$_),1},x$_._uniform_vec2=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]?(x$cb.mainContext.uniform2f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1]),1):0},x$_._uniform_vec2v=function(x$b,x$_){if(x$_.length<2){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$cb.mainContext.uniform2fv(x$b.location,x$_),x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3],1):0}return x$cb.mainContext.uniform2fv(x$b.location,x$_),1},x$_._uniform_vec3=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]?(x$cb.mainContext.uniform3f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2]),1):0},x$_._uniform_vec3v=function(x$b,x$_){return x$cb.mainContext.uniform3fv(x$b.location,x$_),1},x$_._uniform_vec4=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$cb.mainContext.uniform4f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3]),1):0},x$_._uniform_vec4v=function(x$b,x$_){return x$cb.mainContext.uniform4fv(x$b.location,x$_),1},x$_._uniformMatrix2fv=function(x$b,x$_){return x$cb.mainContext.uniformMatrix2fv(x$b.location,!1,x$_),1},x$_._uniformMatrix3fv=function(x$b,x$_){return x$cb.mainContext.uniformMatrix3fv(x$b.location,!1,x$_),1},x$_._uniformMatrix4fv=function(x$b,x$_){return x$cb.mainContext.uniformMatrix4fv(x$b.location,!1,x$_),1},x$_._uniform1i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_?(x$cb.mainContext.uniform1i(x$b.location,x$s[0]=x$_),1):0},x$_._uniform1iv=function(x$b,x$_){return x$cb.mainContext.uniform1iv(x$b.location,x$_),1},x$_._uniform_ivec2=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]?(x$cb.mainContext.uniform2i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1]),1):0},x$_._uniform_ivec2v=function(x$b,x$_){return x$cb.mainContext.uniform2iv(x$b.location,x$_),1},x$_._uniform_vec3i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]?(x$cb.mainContext.uniform3i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2]),1):0},x$_._uniform_vec3vi=function(x$b,x$_){return x$cb.mainContext.uniform3iv(x$b.location,x$_),1},x$_._uniform_vec4i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$cb.mainContext.uniform4i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3]),1):0},x$_._uniform_vec4vi=function(x$b,x$_){return x$cb.mainContext.uniform4iv(x$b.location,x$_),1},x$_._uniform_sampler2D=function(x$b,x$_){var x$s=x$cb.mainContext,x$h=x$b.uploadedValue;return null==x$h[0]?(x$h[0]=this._curActTexIndex,x$s.uniform1i(x$b.location,this._curActTexIndex),x$s.activeTexture(x$L._TEXTURES[this._curActTexIndex]),x$$b.bindTexture(x$s,3553,x$_),this._curActTexIndex++,1):(x$s.activeTexture(x$L._TEXTURES[x$h[0]]),x$$b.bindTexture(x$s,3553,x$_),0)},x$_._uniform_samplerCube=function(x$b,x$_){var x$s=x$cb.mainContext,x$h=x$b.uploadedValue;return null==x$h[0]?(x$h[0]=this._curActTexIndex,x$s.uniform1i(x$b.location,this._curActTexIndex),x$s.activeTexture(x$L._TEXTURES[this._curActTexIndex]),x$$b.bindTexture(x$s,34067,x$_),this._curActTexIndex++,1):(x$s.activeTexture(x$L._TEXTURES[x$h[0]]),x$$b.bindTexture(x$s,34067,x$_),0)},x$_._noSetValue=function(x$b){console.log("no....:"+x$b.name)},x$_.uploadOne=function(x$b,x$_){this.activeResource(),x$$b.UseProgram(this._program);var x$s=this._paramsMap[x$b];x$s.fun.call(this,x$s,x$_)},x$_.uploadTexture2D=function(x$b){x$J.shaderCall++;var x$_=x$cb.mainContext;x$_.activeTexture(33984),x$$b.bindTexture(x$_,3553,x$b)},x$_.uploadTexture2D1=function(x$b){x$J.shaderCall++;var x$_=x$cb.mainContext;x$_.activeTexture(33985),x$$b.bindTexture(x$_,3553,x$b)},x$_.upload=function(x$b,x$_){x$Gb.activeShader=x$Gb.bindShader=this,this._lastUseFrameCount===x$J.loopCount||this.activeResource(),x$$b.UseProgram(this._program),this._reCompile?(x$_=this._params,this._reCompile=!1):x$_=x$_||this._params;x$cb.mainContext;for(var x$s,x$h,x$x=x$_.length,x$n=0,x$E=0;x$E<x$x;x$E++)null!==(x$h=x$b[(x$s=x$_[x$E]).name])&&(x$n+=x$s.fun.call(this,x$s,x$h));x$J.shaderCall+=x$n},x$_.uploadArray=function(x$b,x$_,x$s){x$Gb.activeShader=this,(x$Gb.bindShader=this).activeResource(),x$$b.UseProgram(this._program);this._params;for(var x$h,x$x,x$n=0,x$E=x$_-2;0<=x$E;x$E-=2)(x$x=this._paramsMap[x$b[x$E]])&&null!=(x$h=x$b[x$E+1])&&(x$s&&x$s[x$x.name]&&x$s[x$x.name].bind(),x$n+=x$x.fun.call(this,x$x,x$h));x$J.shaderCall+=x$n},x$_.getParams=function(){return this._params},x$L.getShader=function(x$b){return x$L.sharders[x$b]},x$L.create=function(x$b,x$_,x$s,x$h){return new x$L(x$b,x$_,x$s,x$h)},x$L.withCompile=function(x$b,x$_,x$s,x$h){if(x$s&&x$L.sharders[x$s])return x$L.sharders[x$s];var x$x=x$L._preCompileShader[2e-4*x$b];if(!x$x)throw new Error("withCompile shader err!"+x$b);return x$x.createShader(x$_,x$s,x$h)},x$L.withCompile2D=function(x$b,x$_,x$s,x$h,x$x){if(x$h&&x$L.sharders[x$h])return x$L.sharders[x$h];var x$n=x$L._preCompileShader[2e-4*x$b+x$_];if(!x$n)throw new Error("withCompile shader err!"+x$b+" "+x$_);return x$n.createShader(x$s,x$h,x$x)},x$L.addInclude=function(x$b,x$_){x$tb.addInclude(x$b,x$_)},x$L.preCompile=function(x$b,x$_,x$s,x$h){var x$x=2e-4*x$b;x$L._preCompileShader[x$x]=new x$tb(x$x,x$_,x$s,x$h)},x$L.preCompile2D=function(x$b,x$_,x$s,x$h,x$x){var x$n=2e-4*x$b+x$_;x$L._preCompileShader[x$n]=new x$tb(x$n,x$s,x$h,x$x)},x$L._createShader=function(x$b,x$_,x$s){var x$h=x$b.createShader(x$s);return x$b.shaderSource(x$h,x$_),x$b.compileShader(x$h),x$h},x$L._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],x$L._count=0,x$L._preCompileShader={},x$L.SHADERNAME2ID=2e-4,x$L.sharders=((x$L.sharders=[]).length=32,x$L.sharders),x$E(x$L,["nameKey",function(){return this.nameKey=new x$W}]),x$L}(),x$mb=function(x$b){function x$_(){this._maxsize=0,this._upload=!0,this._uploadSize=0,x$_.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}x$P(x$_,"laya.webgl.utils.Buffer2D",x$b);var x$s=x$_.prototype;return x$s.needSize=function(x$b){var x$_=this._byteLength;if(x$b){var x$s=this._byteLength+x$b;x$s<=this._buffer.byteLength||this._resizeBuffer(x$s<<1,!0),this._byteLength=x$s}return x$_},x$s._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),x$J.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,x$ab._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),x$ab._gl.bufferSubData(this._bufferType,0,this._buffer)},x$s._bufferSubData=function(x$b,x$_,x$s){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),this._maxsize=Math.max(this._maxsize,this._byteLength),x$J.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,x$ab._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),x$_||x$s){var x$h=this._buffer.slice(x$_,x$s);x$ab._gl.bufferSubData(this._bufferType,x$b,x$h)}else x$ab._gl.bufferSubData(this._bufferType,x$b,this._buffer)},x$s._checkArrayUse=function(){},x$s._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},x$s._bind_subUpload=function(x$b,x$_,x$s){return void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(x$b,x$_,x$s),!0)},x$s._resizeBuffer=function(x$b,x$_){if(x$b<this._buffer.byteLength)return this;if(this.memorySize=x$b,x$_&&this._buffer&&0<this._buffer.byteLength){var x$s=new ArrayBuffer(x$b);new Uint8Array(x$s).set(new Uint8Array(this._buffer),0),this._buffer=x$s}else this._buffer=new ArrayBuffer(x$b);return this._checkArrayUse(),this._upload=!0,this},x$s.append=function(x$b){this._upload=!0;var x$_,x$s;x$_=x$b.byteLength,x$b instanceof Uint8Array?(this._resizeBuffer(this._byteLength+x$_,!0),x$s=new Uint8Array(this._buffer,this._byteLength)):x$b instanceof Uint16Array?(this._resizeBuffer(this._byteLength+x$_,!0),x$s=new Uint16Array(this._buffer,this._byteLength)):x$b instanceof Float32Array&&(this._resizeBuffer(this._byteLength+x$_,!0),x$s=new Float32Array(this._buffer,this._byteLength)),x$s.set(x$b,0),this._byteLength+=x$_,this._checkArrayUse()},x$s.appendU16Array=function(x$b,x$_){this._resizeBuffer(this._byteLength+2*x$_,!0);for(var x$s=new Uint16Array(this._buffer,this._byteLength,x$_),x$h=0;x$h<x$_;x$h++)x$s[x$h]=x$b[x$h];this._byteLength+=2*x$_,this._checkArrayUse()},x$s.appendEx=function(x$b,x$_){this._upload=!0;var x$s;x$s=x$b.byteLength,this._resizeBuffer(this._byteLength+x$s,!0),new x$_(this._buffer,this._byteLength).set(x$b,0),this._byteLength+=x$s,this._checkArrayUse()},x$s.appendEx2=function(x$b,x$_,x$s,x$h){void 0===x$h&&(x$h=1),this._upload=!0;var x$x,x$n;x$x=x$s*x$h,this._resizeBuffer(this._byteLength+x$x,!0),x$n=new x$_(this._buffer,this._byteLength);var x$E=0;for(x$E=0;x$E<x$s;x$E++)x$n[x$E]=x$b[x$E];this._byteLength+=x$x,this._checkArrayUse()},x$s.getBuffer=function(){return this._buffer},x$s.setNeedUpload=function(){this._upload=!0},x$s.getNeedUpload=function(){return this._upload},x$s.upload=function(){var x$b=this._bind_upload();return x$ab._gl.bindBuffer(this._bufferType,null),x$ab._bindActive[this._bufferType]=null,x$Gb.activeShader=null,x$b},x$s.subUpload=function(x$b,x$_,x$s){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0);var x$h=this._bind_subUpload();return x$ab._gl.bindBuffer(this._bufferType,null),x$ab._bindActive[this._bufferType]=null,x$Gb.activeShader=null,x$h},x$s.disposeResource=function(){x$b.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},x$s.clear=function(){this._byteLength=0,this._upload=!0},x$h(0,x$s,"bufferLength",function(){return this._buffer.byteLength}),x$h(0,x$s,"byteLength",null,function(x$b){this._byteLength!==x$b&&(x$b<=this._buffer.byteLength||this._resizeBuffer(2*x$b+256,!0),this._byteLength=x$b)}),x$_.__int__=function(x$b){x$Hb.QuadrangleIB=x$Hb.create(35044),x$wb.fillIBQuadrangle(x$Hb.QuadrangleIB,16)},x$_.FLOAT32=4,x$_.SHORT=2,x$_}(x$ab),x$eb=(function(x$_){function x$s(x$b){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,x$s.__super.call(this,9)}x$P(x$s,"laya.webgl.shader.d2.value.GlowSV",x$_);var x$b=x$s.prototype;x$b.setValue=function(x$b){x$_.prototype.setValue.call(this,x$b)},x$b.clear=function(){x$_.prototype.clear.call(this)}}(x$gb),function(x$b){function x$_(x$b){x$_.__super.call(this,64),this.defines.add(64)}x$P(x$_,"laya.webgl.shader.d2.value.TextSV",x$b);var x$s=x$_.prototype;return x$s.release=function(){(x$_.pool[x$_._length++]=this).clear()},x$s.clear=function(){x$b.prototype.clear.call(this)},x$_.create=function(){return x$_._length?x$_.pool[--x$_._length]:new x$_(null)},x$_.pool=[],x$_._length=0,x$_}(x$gb)),x$vb=function(x$b){function x$x(x$b,x$_,x$s,x$h){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,x$x.__super.call(this,x$b,x$_,x$s,x$h)}x$P(x$x,"laya.webgl.shader.d2.Shader2X",x$b);var x$_=x$x.prototype;return x$_.upload2dQuick1=function(x$b){this.upload(x$b,this._params2dQuick1||this._make2dQuick1())},x$_._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var x$b,x$_=this._params,x$s=0,x$h=x$_.length;x$s<x$h;x$s++)x$b=x$_[x$s],(x$i.isFlash||"size"!==x$b.name&&"position"!==x$b.name&&"texcoord"!==x$b.name)&&this._params2dQuick1.push(x$b)}return this._params2dQuick1},x$_.disposeResource=function(){x$b.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},x$_.upload2dQuick2=function(x$b){this.upload(x$b,this._params2dQuick2||this._make2dQuick2())},x$_._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var x$b,x$_=this._params,x$s=0,x$h=x$_.length;x$s<x$h;x$s++)x$b=x$_[x$s],(x$i.isFlash||"size"!==x$b.name)&&this._params2dQuick2.push(x$b)}return this._params2dQuick2},x$x.create=function(x$b,x$_,x$s,x$h){return new x$x(x$b,x$_,x$s,x$h)},x$x}(x$Yb),x$Hb=function(x$b){function x$_(x$b){this._uint8Array=null,this._uint16Array=null,void 0===x$b&&(x$b=35044),x$_.__super.call(this),this._bufferUsage=x$b,this._bufferType=34963,x$i.isFlash||(this._buffer=new ArrayBuffer(8))}x$P(x$_,"laya.webgl.utils.IndexBuffer2D",x$mb);var x$s=x$_.prototype;return x$s._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},x$s.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},x$s.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},x$s.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},x$_.QuadrangleIB=null,x$_.create=function(x$b){return void 0===x$b&&(x$b=35044),new x$_(x$b)},x$_}(),x$jb=function(x$b){function x$s(x$b,x$_){this._floatArray32=null,this._vertexStride=0,x$s.__super.call(this),this._vertexStride=x$b,this._bufferUsage=x$_,this._bufferType=34962,x$i.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}x$P(x$s,"laya.webgl.utils.VertexBuffer2D",x$b);var x$_=x$s.prototype;return x$_.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},x$_.bind=function(x$b){x$b&&x$b._bind(),this._bind()},x$_.insertData=function(x$b,x$_){this.getFloat32Array().set(x$b,x$_),this._upload=!0},x$_.bind_upload=function(x$b){x$b._bind_upload()||x$b._bind(),this._bind_upload()||this._bind()},x$_._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},x$_.disposeResource=function(){x$b.prototype.disposeResource.call(this)},x$_.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},x$h(0,x$_,"vertexStride",function(){return this._vertexStride}),x$s.create=function(x$b,x$_){return void 0===x$_&&(x$_=35048),new x$s(x$b,x$_)},x$s}(x$mb),x$b_=function(x$b){function x$C(x$b,x$_,x$s,x$h,x$x,x$n){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===x$s&&(x$s=6408),void 0===x$h&&(x$h=!0),x$C.__super.call(this,x$b,x$_),x$b){if(this._format=x$s,this._mipmap=x$h,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof x$b)this._url=x$b,this._src=x$b,this._image=new x$V.window.Image,x$_&&(x$_.onload&&(this.onload=x$_.onload),x$_.onerror&&(this.onerror=x$_.onerror),x$_.onCreate&&x$_.onCreate(this)),this._image.crossOrigin=x$b&&0==x$b.indexOf("data:")?null:"",x$b&&(this._image.src=x$b);else if(x$b instanceof ArrayBuffer){this._src=x$_,this._url=this._src;var x$E=new x$O(x$b);x$E.readUTFBytes(4),x$E.readUTFBytes(2),x$E.getInt16();x$E.endian="bigEndian",this._w=x$E.getInt16(),this._h=x$E.getInt16();x$E.getInt16(),x$E.getInt16();this._image=new Uint8Array(x$b,x$E.pos),this._format=x$cb.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,x$I.enabled&&this._w<x$I.atlasLimitWidth&&this._h<x$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(x$b instanceof Uint8Array))return this._src=x$_,this._url=this._src,this._image=x$b.source||x$b,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=x$_,this._url=this._src,this._w=x$x,this._h=x$n,this._image=x$b,this._format=0===x$s?x$b.byteLength/(x$x*x$n)==4?6408:6407:x$s}this._$5__enableMerageInAtlas=!0}}x$P(x$C,"laya.webgl.resource.WebGLImage",x$y);var x$_=x$C.prototype;return x$D.imps(x$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),x$_._init_=function(x$b,x$_){},x$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var x$b=x$cb.mainContext,x$_=this._source=x$b.createTexture(),x$s=x$$b.curBindTexTarget,x$h=x$$b.curBindTexValue;x$$b.bindTexture(x$b,3553,x$_);var x$x=this.minFifter,x$n=this.magFifter,x$E=this.repeat?10497:33071,x$C=x$f.isPOT(this._w,this._h),x$O=!1;switch(x$C?(this.mipmap?-1!==x$x||(x$x=9987):-1!==x$x||(x$x=9729),-1!==x$n||(x$n=9729),x$b.texParameteri(3553,10241,x$x),x$b.texParameteri(3553,10240,x$n),x$b.texParameteri(3553,10242,x$E),x$b.texParameteri(3553,10243,x$E),this.mipmap&&x$b.generateMipmap(3553)):(-1!==x$x||(x$x=9729),-1!==x$n||(x$n=9729),x$b.texParameteri(3553,10241,x$x),x$b.texParameteri(3553,10240,x$n),x$b.texParameteri(3553,10242,33071),x$b.texParameteri(3553,10243,33071)),x$b.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&x$b.pixelStorei(x$b.UNPACK_ALIGNMENT,1),x$b.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&x$b.pixelStorei(x$b.UNPACK_ALIGNMENT,1),x$b.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:x$O=!0,x$b.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case x$cb.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:x$O=!0,x$b.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}x$b.pixelStorei(37441,!1),x$s&&x$h&&x$$b.bindTexture(x$b,x$s,x$h),this.uri||(this.uri=this._url),x$O?this.memorySize=this._image.length:x$C&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},x$_.recreateResource=function(){var x$b=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var x$_=this;this._image=new x$V.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(x$_._needReleaseAgain)return x$_._needReleaseAgain=!1,x$_._image.onload=null,void(x$_._image=null);x$_._allowMerageInAtlas&&x$_._enableMerageInAtlas?(x$b.memorySize=0,x$b._recreateLock=!1):x$_._createWebGlTexture(),x$_.completeCreate()},this._image.src=this._src}},x$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&x$cb.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},x$_.onresize=function(){this._w=this._image.width,this._h=this._image.height,x$I.enabled&&this._w<x$I.atlasLimitWidth&&this._h<x$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},x$_.clearAtlasSource=function(){this._image=null},x$h(0,x$_,"format",function(){return this._format}),x$h(0,x$_,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(x$b){this._$5__enableMerageInAtlas=x$b}),x$h(0,x$_,"mipmap",function(){return this._mipmap}),x$h(0,x$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),x$h(0,x$_,"atlasSource",function(){return this._image}),x$h(0,x$_,"onload",null,function(x$b){var x$_=this;this._onload=x$b,this._image&&(this._image.onload=null!=this._onload?function(){x$_.onresize(),x$_._onload()}:null)}),x$h(0,x$_,"onerror",null,function(x$b){var x$_=this;this._onerror=x$b,this._image&&(this._image.onerror=null!=this._onerror?function(){x$_._onerror()}:null)}),x$C}();x$D.__init([x$Vb,x$d,x$ob,x$tb])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}}),function(x$n,x$b,x$h){x$h.un,x$h.uns;var x$x=x$h.static,x$E=x$h.class,x$C=x$h.getset,x$O=(x$h.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),x$Q=laya.utils.ClassUtils,x$p=(laya.events.Event,laya.utils.HTMLChar),x$L=laya.net.Loader,x$f=(laya.display.Node,laya.maths.Rectangle),x$P=laya.renders.Render,x$V=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),x$y=laya.utils.Stat,x$G=laya.display.Text,x$w=laya.resource.Texture,x$i=laya.net.URL,x$R=laya.utils.Utils,x$t=function(){function x$V(){}return x$E(x$V,"laya.html.utils.HTMLParse"),x$V.parse=function(x$b,x$_,x$s){x$_=(x$_="<root>"+(x$_=x$_.replace(/<br>/g,"<br/>"))+"</root>").replace(x$V.spacePattern,x$V.char255);var x$h=x$R.parseXMLFromString(x$_);x$V._parseXML(x$b,x$h.childNodes[0].childNodes,x$s)},x$V._parseXML=function(x$b,x$_,x$s,x$h){var x$x=0,x$n=0;if(x$_.join||x$_.item)for(x$x=0,x$n=x$_.length;x$x<x$n;++x$x)x$V._parseXML(x$b,x$_[x$x],x$s,x$h);else{var x$E,x$C,x$O;if(3==x$_.nodeType)return void(x$b instanceof laya.html.dom.HTMLDivElement?(null==x$_.nodeName&&(x$_.nodeName="#text"),x$C=x$_.nodeName.toLowerCase(),0<(x$O=x$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(x$E=x$Q.getInstance(x$C))&&(x$b.addChild(x$E),x$E.innerTEXT=x$O.replace(x$V.char255AndOneSpacePattern," "))):0<(x$O=x$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(x$b.innerTEXT=x$O.replace(x$V.char255AndOneSpacePattern," ")));if("#comment"==(x$C=x$_.nodeName.toLowerCase()))return;if(x$E=x$Q.getInstance(x$C)){(x$E=x$b.addChild(x$E)).URI=x$s,x$E.href=x$h;var x$L=x$_.attributes;if(x$L&&0<x$L.length)for(x$x=0,x$n=x$L.length;x$x<x$n;++x$x){var x$f=x$L[x$x],x$p=x$f.nodeName,x$P=x$f.value;x$E._setAttributes(x$p,x$P)}x$V._parseXML(x$E,x$_.childNodes,x$s,x$E.href)}else x$V._parseXML(x$b,x$_.childNodes,x$s,x$h)}},x$V.char255=String.fromCharCode(255),x$V.spacePattern=/&nbsp;|&#160;/g,x$V.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),x$V}(),x$c=function(){function x$U(){}return x$E(x$U,"laya.html.utils.Layout"),x$U.later=function(x$b){null==x$U._will&&(x$U._will=[],x$h.stage.frameLoop(1,null,function(){if(!(x$U._will.length<1)){for(var x$b=0;x$b<x$U._will.length;x$b++)laya.html.utils.Layout.layout(x$U._will[x$b]);x$U._will.length=0}})),x$U._will.push(x$b)},x$U.layout=function(x$b){if(!x$b||!x$b._style)return null;if(0==(512&x$b._style._type))return null;x$b.getStyle()._type&=-513;var x$_=x$U._multiLineLayout(x$b);return x$P.isConchApp&&x$b.layaoutCallNative&&x$b.layaoutCallNative(),x$_},x$U._multiLineLayout=function(x$b){if(x$G.RightToLeft)return x$U._multiLineLayout2(x$b);var x$_=new Array;x$b._addChildsToLayout(x$_);var x$s,x$h,x$x,x$n,x$E,x$C=0,x$O=x$_.length,x$L=x$b._getCSSStyle(),x$f=x$L.letterSpacing,x$p=x$L.leading,x$P=x$L.lineHeight,x$V=x$L._widthAuto()||!x$L.wordWrap,x$Q=x$V?999999:x$b.width,x$y=(x$b.height,0),x$w=x$L.italic?x$L.fontSize/3:0,x$i=x$L._getAlign(),x$R=x$L._getValign(),x$t=0!==x$R||0!==x$i||0!=x$P,x$c=0,x$$=0,x$D=0,x$o=0,x$M=new Array,x$r=x$M[0]=new x$z,x$k=!1,x$B=!1;x$r.h=0,x$L.italic&&(x$Q-=x$L.fontSize/3);var x$S=0,x$Z=!0;function x$J(){x$r.y=x$$,x$$+=x$r.h+x$p,0==x$r.h&&(x$$+=x$P),x$r.mWidth=x$S,x$S=0,x$r=new x$z,x$M.push(x$r),x$r.h=0,x$k=!(x$Z=!(x$c=0))}for(x$C=0;x$C<x$O;x$C++)if(null!=(x$s=x$_[x$C]))if(x$Z=!1,x$s instanceof laya.html.dom.HTMLBrElement)x$J(),x$r.y=x$$;else{if(x$s._isChar()){if((x$n=x$s).isWord)x$k=x$B||"\n"===x$n.char,x$r.wordStartIndex=x$r.elements.length;else{if(x$D=x$n.width+x$n.style.letterSpacin,0<x$M.length&&x$Q<x$c+x$D&&0<x$r.wordStartIndex){var x$W;x$W=x$r.elements.length-x$r.wordStartIndex+1,x$r.elements.length=x$r.wordStartIndex,x$C-=x$W,x$J();continue}x$k=!1,x$S+=x$n.width}x$D=x$n.width+x$f,x$o=x$n.height,x$B=!1,(x$k=x$k||x$Q<x$c+x$D)&&x$J(),x$r.minTextHeight=Math.min(x$r.minTextHeight,x$s.height)}else x$h=x$s._getCSSStyle(),x$E=x$s,x$x=x$h.padding,0===x$h._getCssFloat()||(x$t=!0),x$k=x$B||x$h.lineElement,x$D=x$E.width*x$E._style._tf.scaleX+x$x[1]+x$x[3]+x$f,x$o=x$E.height*x$E._style._tf.scaleY+x$x[0]+x$x[2],x$B=x$h.lineElement,(x$k=x$k||x$Q<x$c+x$D&&x$h.wordWrap)&&x$J();x$r.elements.push(x$s),x$r.h=Math.max(x$r.h,x$o),x$s.x=x$c,x$s.y=x$$,x$c+=x$D,x$r.w=x$c-x$f,x$r.y=x$$,x$y=Math.max(x$c+x$w,x$y)}else x$Z||(x$c+=x$U.DIV_ELEMENT_PADDING),x$r.wordStartIndex=x$r.elements.length;if(x$$=x$r.y+x$r.h,x$t){var x$T=0,x$q=x$Q;for(x$V&&0<x$b.width&&(x$q=x$b.width),x$C=0,x$O=x$M.length;x$C<x$O;x$C++)x$M[x$C].updatePos(0,x$q,x$C,x$T,x$i,x$R,x$P),x$T+=Math.max(x$P,x$M[x$C].h+x$p);x$$=x$T}return x$V&&(x$b.width=x$y),x$$>x$b.height&&(x$b.height=x$$),[x$y,x$$]},x$U._multiLineLayout2=function(x$b){var x$_=new Array;x$b._addChildsToLayout(x$_);var x$s,x$h,x$x,x$n,x$E,x$C=0,x$O=x$_.length,x$L=x$b._getCSSStyle(),x$f=x$L.letterSpacing,x$p=x$L.leading,x$P=x$L.lineHeight,x$V=x$L._widthAuto()||!x$L.wordWrap,x$Q=x$V?999999:x$b.width,x$y=(x$b.height,0),x$w=x$L.italic?x$L.fontSize/3:0,x$i=2-x$L._getAlign(),x$R=x$L._getValign(),x$t=0!==x$R||0!=x$i||0!=x$P,x$c=0,x$$=0,x$D=0,x$o=0,x$M=new Array,x$r=x$M[0]=new x$z,x$k=!1,x$B=!1;x$r.h=0,x$L.italic&&(x$Q-=x$L.fontSize/3);var x$S=0,x$Z=!0;function x$J(){x$r.y=x$$,x$$+=x$r.h+x$p,0==x$r.h&&(x$$+=x$P),x$r.mWidth=x$S,x$S=0,x$r=new x$z,x$M.push(x$r),x$r.h=0,x$k=!(x$Z=!(x$c=0))}for(x$C=0;x$C<x$O;x$C++)if(null!=(x$s=x$_[x$C]))if(x$Z=!1,x$s instanceof laya.html.dom.HTMLBrElement)x$J(),x$r.y=x$$;else{if(x$s._isChar()){if((x$n=x$s).isWord)x$k=x$B||"\n"===x$n.char,x$r.wordStartIndex=x$r.elements.length;else{if(0<x$M.length&&x$Q<x$c+x$D&&0<x$r.wordStartIndex){var x$W;x$W=x$r.elements.length-x$r.wordStartIndex+1,x$r.elements.length=x$r.wordStartIndex,x$C-=x$W,x$J();continue}x$k=!1,x$S+=x$n.width}x$D=x$n.width+x$f,x$o=x$n.height,x$B=!1,(x$k=x$k||x$Q<x$c+x$D)&&x$J(),x$r.minTextHeight=Math.min(x$r.minTextHeight,x$s.height)}else x$h=x$s._getCSSStyle(),x$E=x$s,x$x=x$h.padding,0===x$h._getCssFloat()||(x$t=!0),x$k=x$B||x$h.lineElement,x$D=x$E.width*x$E._style._tf.scaleX+x$x[1]+x$x[3]+x$f,x$o=x$E.height*x$E._style._tf.scaleY+x$x[0]+x$x[2],x$B=x$h.lineElement,(x$k=x$k||x$Q<x$c+x$D&&x$h.wordWrap)&&x$J();x$r.elements.push(x$s),x$r.h=Math.max(x$r.h,x$o),x$s.x=x$c,x$s.y=x$$,x$c+=x$D,x$r.w=x$c-x$f,x$r.y=x$$,x$y=Math.max(x$c+x$w,x$y)}else x$Z||(x$c+=x$U.DIV_ELEMENT_PADDING),x$r.wordStartIndex=x$r.elements.length;if(x$$=x$r.y+x$r.h,x$t){var x$T=0,x$q=x$Q;for(x$C=0,x$O=x$M.length;x$C<x$O;x$C++)x$M[x$C].updatePos(0,x$q,x$C,x$T,x$i,x$R,x$P),x$T+=Math.max(x$P,x$M[x$C].h+x$p);x$$=x$T}for(x$V&&(x$b.width=x$y),x$$>x$b.height&&(x$b.height=x$$),x$C=0,x$O=x$M.length;x$C<x$O;x$C++)x$M[x$C].revertOrder(x$Q);return[x$y,x$$]},x$U._will=null,x$U.DIV_ELEMENT_PADDING=0,x$U}(),x$z=function(){function x$b(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}x$E(x$b,"laya.html.utils.LayoutLine");var x$_=x$b.prototype;return x$_.updatePos=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C,x$O=0;0<this.elements.length&&(x$O=(x$C=this.elements[this.elements.length-1]).x+x$C.width-this.elements[0].x);var x$L=0,x$f=NaN;1===x$x&&(x$L=(x$_-x$O)/2),2===x$x&&(x$L=x$_-x$O),0===x$E||0!=x$n||(x$n=1);for(var x$p=0,x$P=this.elements.length;x$p<x$P;x$p++){var x$V=(x$C=this.elements[x$p])._getCSSStyle();switch(0!==x$L&&(x$C.x+=x$L),x$V._getValign()){case 0:x$C.y=x$h;break;case 1:var x$Q=0;99999!=this.minTextHeight&&(x$Q=this.minTextHeight);var x$y=(x$Q+x$E)/2;x$y=Math.max(x$y,this.h),x$f=(laya.html.dom.HTMLImageElement,x$h+x$y-x$C.height),x$C.y=x$f;break;case 2:x$C.y=x$h+(x$E-x$C.height)}}},x$_.revertOrder=function(x$b){var x$_;if(0<this.elements.length){var x$s,x$h=0;for(x$s=this.elements.length,x$h=0;x$h<x$s;x$h++)(x$_=this.elements[x$h]).x=x$b-x$_.x-x$_.width}},x$b}(),x$$=function(x$s){function x$_(){this.URI=null,this._href=null,x$_.__super.call(this),this._text=x$_._EMPTYTEXT,this.setStyle(new x$O(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}x$E(x$_,"laya.html.dom.HTMLElement",x$s);var x$b=x$_.prototype;return x$b.layaoutCallNative=function(){var x$b=0;if(this._childs&&0<(x$b=this._childs.length))for(var x$_=0;x$_<x$b;x$_++)this._childs[x$_].layaoutCallNative&&this._childs[x$_].layaoutCallNative();var x$s=this._getWords();x$s?laya.html.dom.HTMLElement.fillWords(this,x$s,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},x$b.appendChild=function(x$b){return this.addChild(x$b)},x$b._getWords2=function(){var x$b=this._text.text;if(!x$b||0===x$b.length)return null;var x$_,x$s,x$h=0,x$x=0;if(this._text.drawWords)x$s=this._text.drawWords;else{for(x$x=(x$_=x$b.split(" ")).length-1,x$s=[],x$h=0;x$h<x$x;x$h++)x$s.push(x$_[x$h]," ");0<=x$x&&x$s.push(x$_[x$x]),this._text.drawWords=x$s}var x$n,x$E=this._text.words;if(x$E&&x$E.length===x$s.length)return x$E;null===x$E&&(this._text.words=x$E=[]),x$E.length=x$s.length;var x$C=this.style,x$O=x$C.font;for(x$h=0,x$x=x$s.length;x$h<x$x;x$h++){x$n=x$R.measureText(x$s[x$h],x$O);var x$L=x$E[x$h]=new x$p(x$s[x$h],x$n.width,x$n.height||x$C.fontSize,x$C);if(1<x$L.char.length&&(x$L.charNum=x$L.char),this.href){var x$f=new x$V;this.addChild(x$f),x$L.setSprite(x$f)}}return x$E},x$b._getWords=function(){if(!x$G.CharacterCache)return this._getWords2();var x$b=this._text.text;if(!x$b||0===x$b.length)return null;var x$_,x$s=this._text.words;if(x$s&&x$s.length===x$b.length)return x$s;null===x$s&&(this._text.words=x$s=[]),x$s.length=x$b.length;for(var x$h=this.style,x$x=x$h.font,x$n=0,x$E=x$b.length;x$n<x$E;x$n++)if(x$_=x$R.measureText(x$b.charAt(x$n),x$x)){var x$C=x$s[x$n]=new x$p(x$b.charAt(x$n),x$_.width,x$_.height||x$h.fontSize,x$h);if(this.href){var x$O=new x$V;this.addChild(x$O),x$C.setSprite(x$O)}}else console.warn("_getWords size is null"+x$b.charAt(x$n),x$x);return x$s},x$b.showLinkSprite=function(){var x$b=this._text.words;if(x$b)for(var x$_,x$s,x$h=[],x$x=0;x$x<x$b.length;x$x++)x$s=x$b[x$x],(x$_=new x$V).graphics.drawRect(0,0,x$s.width,x$s.height,"#ff0000"),x$_.width=x$s.width,x$_.height=x$s.height,this.addChild(x$_),x$h.push(x$_)},x$b._layoutLater=function(){var x$b=this.style;512&x$b._type||(x$b.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&x$b.block?(x$c.later(this),x$b._type|=512):this.parent&&this.parent._layoutLater())},x$b._setAttributes=function(x$b,x$_){switch(x$b){case"style":return void this.style.cssText(x$_);case"class":return void(this.className=x$_)}x$s.prototype._setAttributes.call(this,x$b,x$_)},x$b.updateHref=function(){if(null!=this._href){var x$b=this._getWords();if(x$b)for(var x$_,x$s,x$h=0;x$h<x$b.length;x$h++)(x$s=(x$_=x$b[x$h]).getSprite())&&(x$s.size(x$_.width,x$_.height),x$s.on("click",this,this.onLinkHandler))}},x$b.onLinkHandler=function(x$b){switch(x$b.type){case"click":for(var x$_=this;x$_;)x$_.event("link",[this.href]),x$_=x$_.parent}},x$b.formatURL=function(x$b){return this.URI?x$i.formatURL(x$b,this.URI?this.URI.path:null):x$b},x$C(0,x$b,"href",function(){return this._href},function(x$b){null!=(this._href=x$b)&&(this._getCSSStyle().underLine=1,this.updateHref())}),x$C(0,x$b,"color",null,function(x$b){this.style.color=x$b}),x$C(0,x$b,"onClick",null,function(x$b){x$h._runScript("fn=function(event){"+x$b+";}"),this.on("click",this,void 0)}),x$C(0,x$b,"id",null,function(x$b){x$D.document.setElementById(x$b,this)}),x$C(0,x$b,"innerTEXT",function(){return this._text.text},function(x$b){this.text=x$b}),x$C(0,x$b,"style",function(){return this._style}),x$C(0,x$b,"text",function(){return this._text.text},function(x$b){this._text==x$_._EMPTYTEXT?this._text={text:x$b,words:null}:(this._text.text=x$b,this._text.words&&(this._text.words.length=0)),x$P.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),x$C(0,x$b,"parent",x$s.prototype._$get_parent,function(x$b){if(x$b instanceof laya.html.dom.HTMLElement){var x$_=x$b;this.URI||(this.URI=x$_.URI),this.style.inherit(x$_.style)}x$h.superSet(x$V,this,"parent",x$b)}),x$C(0,x$b,"className",null,function(x$b){this.style.attrs(x$D.document.styleSheets["."+x$b])}),x$_.fillWords=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$b.graphics.clear();for(var x$C=0,x$O=x$_.length;x$C<x$O;x$C++){var x$L=x$_[x$C];x$b.graphics.fillText(x$L.char,x$L.x+x$s,x$L.y+x$h,x$x,x$n,"left",x$E)}},x$_._EMPTYTEXT={text:null,words:null},x$_}(x$V),x$_=(function(x$b){function x$_(){x$_.__super.call(this),this.style.lineElement=!0,this.style.block=!0}x$E(x$_,"laya.html.dom.HTMLBrElement",x$$)}(),function(x$b){function x$_(){this.contextHeight=NaN,this.contextWidth=NaN,x$_.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}x$E(x$_,"laya.html.dom.HTMLDivElement",x$b);var x$s=x$_.prototype;return x$s.appendHTML=function(x$b){x$t.parse(this,x$b,this.URI),this.layout()},x$s._addChildsToLayout=function(x$_){var x$b=this._getWords();if(null==x$b&&0==this._childs.length)return!1;x$b&&x$b.forEach(function(x$b){x$_.push(x$b)});for(var x$s=!0,x$h=0,x$x=this._childs.length;x$h<x$x;x$h++){var x$n=this._childs[x$h];x$s?x$s=!1:x$_.push(null),x$n._addToLayout(x$_)}return!0},x$s._addToLayout=function(x$b){this.layout()},x$s.layout=function(){if(this.style){this.style._type|=512;var x$b=x$c.layout(this);if(x$b){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new x$f);var x$_=this._$P.mHtmlBounds;x$_.x=x$_.y=0,x$_.width=this.contextWidth=x$b[0],x$_.height=this.contextHeight=x$b[1],this.setBounds(x$_)}}},x$C(0,x$s,"height",function(){return this._height?this._height:this.contextHeight},x$b.prototype._$set_height),x$C(0,x$s,"innerHTML",null,function(x$b){this.destroyChildren(),this.appendHTML(x$b)}),x$C(0,x$s,"width",function(){return this._width?this._width:this.contextWidth},function(x$b){var x$_=!1;x$_=0===x$b?x$b!=this._width:x$b!=this.width,x$h.superSet(x$$,this,"width",x$b),x$_&&this.layout()}),x$_}(x$$)),x$D=function(x$b){function x$_(){this.all=new Array,this.styleSheets=x$O.styleSheets,x$_.__super.call(this)}x$E(x$_,"laya.html.dom.HTMLDocument",x$$);var x$s=x$_.prototype;return x$s.getElementById=function(x$b){return this.all[x$b]},x$s.setElementById=function(x$b,x$_){this.all[x$b]=x$_},x$x(x$_,["document",function(){return this.document=new x$_}]),x$_}();(function(x$b){function x$_(){this._tex=null,this._url=null,this._renderArgs=[],x$_.__super.call(this),this.style.block=!0}x$E(x$_,"laya.html.dom.HTMLImageElement",x$$);var x$s=x$_.prototype;x$s._addToLayout=function(x$b){!this._style.absolute&&x$b.push(this)},x$s.render=function(x$b,x$_,x$s){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(x$y.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,x$b.ctx.drawTexture2(x$_,x$s,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},x$s.layaoutCallNative=function(){var x$b=0;if(this._childs&&0<(x$b=this._childs.length))for(var x$_=0;x$_<x$b;x$_++)this._childs[x$_].layaoutCallNative&&this._childs[x$_].layaoutCallNative()},x$C(0,x$s,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(x$b){this._width!==x$b&&(this._width=x$b,this._style.width=x$b,this.repaint())}),x$C(0,x$s,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(x$b){this._height!==x$b&&(this._height=x$b,this._style.height=x$b,this.repaint())}),x$s.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),x$L.clearCache(this,this._url),this._tex=null),x$$.prototype.destroy.call(this)},x$s.onloaded=function(){var x$b=this._style;x$b&&!x$b.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),x$b&&!x$b.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),x$P.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},x$s._loadImageComplete=function(x$b,x$_,x$s){if(!this._destroyed)if(null!=x$s)if(x$s instanceof ArrayBuffer){var x$h=new DataView(x$s);new laya.webgl.resource.WebGLImage(new Uint8Array(x$s,8),x$b,0,!1,x$h.getUint32(0),x$h.getUint32(4));this.onloaded()}else if(x$s instanceof x$w)x$L.imgMgrSet[x$b]=x$_,x$n.imgMgrLock(x$b,x$L.imgMgrSet[x$b]),this._url=x$b,this._tex=x$s,x$L.keepCache(this,x$b),x$L.cacheRes(x$b,this._tex),this.onloaded();else{var x$x=-1!=x$b.indexOf(".png",x$b.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(x$s,x$b,x$x,!1,x$s.width,x$s.height);this.onloaded()}else this.event("error","Load image failed")},x$C(0,x$s,"src",null,function(x$b){(x$b=this.formatURL(x$b),this._url!=x$b)&&(null!=this._tex&&(x$L.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=x$b,(this._tex=x$L.getRes(x$b))?(x$L.keepCache(this,x$b),this.onloaded()):x$n.imgMgrLoad(x$b,this._loadImageComplete.bind(this),2,!1))})})(),function(x$b){function x$_(){this.type=null,x$_.__super.call(this),this.visible=!1}x$E(x$_,"laya.html.dom.HTMLLinkElement",x$b);var x$s=x$_.prototype;x$s._onload=function(x$b){switch(this.type){case"text/css":x$O.parseCSS(x$b,this.URI)}},x$C(0,x$s,"href",x$b.prototype._$get_href,function(x$b){var x$_=this;x$b=this.formatURL(x$b),this.URI=new x$i(x$b);var x$s=new x$L;x$s.once("complete",null,function(x$b){x$_._onload(x$b)}),x$s.load(x$b,"text")}),x$_._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(x$$),function(x$b){function x$_(){x$_.__super.call(this),this.visible=!1}x$E(x$_,"laya.html.dom.HTMLStyleElement",x$b),x$C(0,x$_.prototype,"text",x$b.prototype._$get_text,function(x$b){x$O.parseCSS(x$b,null)})}(x$$),function(x$b){function x$_(){x$_.__super.call(this),this._getCSSStyle().valign="middle"}x$E(x$_,"laya.html.dom.HTMLIframeElement",x$b),x$C(0,x$_.prototype,"href",x$b.prototype._$get_href,function(x$s){var x$h=this;x$s=this.formatURL(x$s);var x$b=new x$L;x$b.once("complete",null,function(x$b){var x$_=x$h.URI;x$h.URI=new x$i(x$s),x$h.innerHTML=x$b,!x$_||(x$h.URI=x$_)}),x$b.load(x$s,"text")})}(x$_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}}),function(x$b,x$_,x$y){x$y.un,x$y.uns;var x$h=x$y.static,x$n=x$y.class,x$x=x$y.getset,x$s=(x$y.__newvec,laya.display.Animation),x$w=(laya.utils.Browser,laya.utils.ClassUtils),x$E=laya.filters.ColorFilter,x$C=laya.utils.Ease,x$O=laya.events.Event,x$L=(laya.events.EventDispatcher,laya.display.css.Font),x$f=laya.display.FrameAnimation,x$p=laya.display.Graphics,x$P=laya.utils.Handler,x$V=laya.display.Input,x$R=laya.net.Loader,x$Q=(laya.display.Node,laya.maths.Point),x$i=laya.maths.Rectangle,x$t=laya.renders.Render,x$c=laya.display.Sprite,x$$=laya.display.Text,x$D=laya.resource.Texture,x$o=laya.utils.Tween,x$M=laya.utils.Utils,x$r=laya.utils.WeakObject;x$y.interface("laya.ui.IItem"),x$y.interface("laya.ui.ISelect"),x$y.interface("laya.ui.IRender"),x$y.interface("laya.ui.IComponent"),x$y.interface("laya.ui.IBox","IComponent");var x$k=function(){function x$b(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return x$n(x$b,"laya.ui.LayoutStyle"),x$h(x$b,["EMPTY",function(){return this.EMPTY=new x$b}]),x$b}(),x$B=function(){function x$b(){}return x$n(x$b,"laya.ui.Styles"),x$b.labelColor="#000000",x$b.buttonStateNum=3,x$b.scrollBarMinNum=15,x$b.scrollBarDelayTime=500,x$h(x$b,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),x$b}(),x$S=function(){function x$x(){}return x$n(x$x,"laya.ui.UIUtils"),x$x.fillArray=function(x$b,x$_,x$s){var x$h=x$b.concat();if(x$_)for(var x$x=x$_.split(","),x$n=0,x$E=Math.min(x$h.length,x$x.length);x$n<x$E;x$n++){var x$C=x$x[x$n];x$h[x$n]="true"==x$C||"false"!=x$C&&x$C,null!=x$s&&(x$h[x$n]=x$s(x$C))}return x$h},x$x.toColor=function(x$b){return x$M.toHexColor(x$b)},x$x.gray=function(x$b,x$_){void 0===x$_&&(x$_=!0),x$_?x$x.addFilter(x$b,x$x.grayFilter):x$x.clearFilter(x$b,x$E)},x$x.addFilter=function(x$b,x$_){var x$s=x$b.filters||[];x$s.push(x$_),x$b.filters=x$s},x$x.clearFilter=function(x$b,x$_){var x$s=x$b.filters;if(null!=x$s&&0<x$s.length){for(var x$h=x$s.length-1;-1<x$h;x$h--){var x$x=x$s[x$h];x$y.__typeof(x$x,x$_)&&x$s.splice(x$h,1)}x$b.filters=x$s}},x$x._getReplaceStr=function(x$b){return x$x.escapeSequence[x$b]},x$x.adptString=function(x$b){return x$b.replace(/\\(\w)/g,x$x._getReplaceStr)},x$x.getBindFun=function(x$b){var x$_=x$x._funMap.get(x$b);if(null==x$_){var x$s='"'+x$b+'"',x$h="(function(data){if(data==null)return;with(data){try{\nreturn "+(x$s=x$s.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";x$_=x$y._runScript(x$h),x$x._funMap.set(x$b,x$_)}return x$_},x$h(x$x,["grayFilter",function(){return this.grayFilter=new x$E([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new x$r}]),x$x}(),x$Z=function(){function x$b(){}return x$n(x$b,"UIConfig"),x$b.touchScrollEnable=!0,x$b.mouseWheelEnable=!0,x$b.showButtons=!0,x$b.popupBgColor="#000000",x$b.popupBgAlpha=.5,x$b.closeDialogOnSide=!0,x$b}(),x$J=function(x$s){function x$i(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,x$i.__super.call(this),this._weakKeys=[]}x$n(x$i,"laya.ui.AutoBitmap",x$s);var x$b=x$i.prototype;return x$b.destroy=function(){if(x$R.clearObject(this,this._weakKey),this._weakKeys){for(var x$b=0,x$_=this._weakKeys.length;x$b<x$_;++x$b)x$R.clearObject(this,this._weakKeys[x$b]);this._weakKeys=null}x$s.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},x$b._setChanged=function(){this._isChanged||(this._isChanged=!0,x$y.timer.callLater(this,this.changeSource))},x$b.changeSource=function(){this._isChanged=!1;var x$b=this._source;if(x$b&&x$b.bitmap){var x$_=this.width,x$s=this.height,x$h=this._sizeGrid,x$x=x$b.sourceWidth,x$n=x$b.sourceHeight;if(!x$h||x$x===x$_&&x$n===x$s)this.cleanByTexture(x$b,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,x$_,x$s);else{x$R.clearObject(this,this._weakKey),x$b.$_GID||(x$b.$_GID=x$M.getGID());var x$E=x$b.$_GID+"."+x$_+"."+x$s+"."+x$h.join("."),x$C=x$R.findObject(x$E);if(x$M.isOKCmdList(x$C))return this._weakKey=x$E,x$R.keepObject(this,this._weakKey),void(this.cmds=x$C);this.clear();var x$O,x$L,x$f=x$h[0],x$p=x$h[1],x$P=x$h[2],x$V=x$h[3],x$Q=x$h[4],x$y=!1;if(x$_==x$x&&(x$V=x$p=0),x$s==x$n&&(x$f=x$P=0),x$_<x$V+x$p){var x$w=x$_;x$y=!0,x$_=x$V+x$p,this.save(),this.clipRect(0,0,x$w,x$s)}x$V&&x$f&&(x$O=x$i.getTexture(x$b,0,0,x$V,x$f),x$L=this._weakKeys[0],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[0]=x$O.weakKey),this.drawTexture(x$O,0,0,x$V,x$f)):(x$R.clearObject(this,x$L),this._weakKeys[0]="")),x$p&&x$f&&(x$O=x$i.getTexture(x$b,x$x-x$p,0,x$p,x$f),x$L=this._weakKeys[1],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[1]=x$O.weakKey),this.drawTexture(x$O,x$_-x$p,0,x$p,x$f)):(x$R.clearObject(this,x$L),this._weakKeys[1]="")),x$V&&x$P&&(x$O=x$i.getTexture(x$b,0,x$n-x$P,x$V,x$P),x$L=this._weakKeys[2],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[2]=x$O.weakKey),this.drawTexture(x$O,0,x$s-x$P,x$V,x$P)):(x$R.clearObject(this,x$L),this._weakKeys[2]="")),x$p&&x$P&&(x$O=x$i.getTexture(x$b,x$x-x$p,x$n-x$P,x$p,x$P),x$L=this._weakKeys[3],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[3]=x$O.weakKey),this.drawTexture(x$O,x$_-x$p,x$s-x$P,x$p,x$P)):(x$R.clearObject(this,x$L),this._weakKeys[3]="")),x$f&&(x$O=x$i.getTexture(x$b,x$V,0,x$x-x$V-x$p,x$f),x$L=this._weakKeys[4],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[4]=x$O.weakKey),this.drawBitmap(x$Q,x$O,x$V,0,x$_-x$V-x$p,x$f)):(x$R.clearObject(this,x$L),this._weakKeys[4]="")),x$P&&(x$O=x$i.getTexture(x$b,x$V,x$n-x$P,x$x-x$V-x$p,x$P),x$L=this._weakKeys[5],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[5]=x$O.weakKey),this.drawBitmap(x$Q,x$O,x$V,x$s-x$P,x$_-x$V-x$p,x$P)):(x$R.clearObject(this,x$L),this._weakKeys[5]="")),x$V&&(x$O=x$i.getTexture(x$b,0,x$f,x$V,x$n-x$f-x$P),x$L=this._weakKeys[6],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[6]=x$O.weakKey),this.drawBitmap(x$Q,x$O,0,x$f,x$V,x$s-x$f-x$P)):(x$R.clearObject(this,x$L),this._weakKeys[6]="")),x$p&&(x$O=x$i.getTexture(x$b,x$x-x$p,x$f,x$p,x$n-x$f-x$P),x$L=this._weakKeys[7],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[7]=x$O.weakKey),this.drawBitmap(x$Q,x$O,x$_-x$p,x$f,x$p,x$s-x$f-x$P)):(x$R.clearObject(this,x$L),this._weakKeys[7]="")),x$O=x$i.getTexture(x$b,x$V,x$f,x$x-x$V-x$p,x$n-x$f-x$P),x$L=this._weakKeys[8],x$O?(x$L!=x$O.weakKey&&(x$R.clearObject(this,x$L),x$R.keepObject(this,x$O.weakKey),this._weakKeys[8]=x$O.weakKey),this.drawBitmap(x$Q,x$O,x$V,x$f,x$_-x$V-x$p,x$s-x$f-x$P)):(x$R.clearObject(this,x$L),this._weakKeys[8]=""),x$y&&this.restore(),this.autoCacheCmd&&!x$t.isConchApp&&(x$R.saveObject(x$E,this.cmds,null),this._weakKey=x$E,x$R.keepObject(this,this._weakKey))}this._repaint()}},x$b.drawBitmap=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=0),x$x<.1||x$n<.1||(!x$b||x$_.width==x$x&&x$_.height==x$n?this.drawTexture(x$_,x$s,x$h,x$x,x$n):this.fillTexture(x$_,x$s,x$h,x$x,x$n))},x$b.clear=function(x$b){void 0===x$b&&(x$b=!0),x$s.prototype.clear.call(this,!1)},x$x(0,x$b,"sizeGrid",function(){return this._sizeGrid},function(x$b){this._sizeGrid=x$b,this._setChanged()}),x$x(0,x$b,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(x$b){this._width!=x$b&&(this._width=x$b,this._setChanged())}),x$x(0,x$b,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(x$b){this._height!=x$b&&(this._height=x$b,this._setChanged())}),x$x(0,x$b,"source",function(){return this._source},function(x$b){x$b?(this._source=x$b,this._setChanged()):(this._source=null,this.clear())}),x$i.getTexture=function(x$b,x$_,x$s,x$h,x$x){x$h<=0&&(x$h=1),x$x<=0&&(x$x=1),x$b.$_GID||(x$b.$_GID=x$M.getGID());var x$n=x$b.$_GID+"."+x$_+"."+x$s+"."+x$h+"."+x$x,x$E=x$R.findObject(x$n);if((!x$E||!x$E.source)&&(x$E=x$D.createFromTexture(x$b,x$_,x$s,x$h,x$x))){if(x$b.alphaTexture){var x$C=x$b.width/x$b.alphaTexture.width;x$E.alphaTexture=x$D.createFromTexture(x$b.alphaTexture,x$_/x$C,x$s/x$C,x$h/x$C,x$x/x$C)}x$R.saveObject(x$n,x$E),x$E.weakKey=x$n}return x$E},x$i}(x$p),x$W=(function(x$b){function x$_(){x$_.__super.call(this)}x$n(x$_,"laya.ui.UIEvent",x$O),x$_.SHOW_TIP="showtip",x$_.HIDE_TIP="hidetip"}(),function(x$_){function x$b(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,x$b.__super.call(this),this._layout=x$k.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}x$n(x$b,"laya.ui.Component",x$_);var x$s=x$b.prototype;return x$y.imps(x$s,{"laya.ui.IComponent":!0}),x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},x$s.preinitialize=function(){},x$s.createChildren=function(){},x$s.initialize=function(){},x$s.callLater=function(x$b,x$_){x$y.timer.callLater(this,x$b,x$_)},x$s.runCallLater=function(x$b){x$y.timer.runCallLater(this,x$b)},x$s.commitMeasure=function(){},x$s.changeSize=function(){this.event("resize")},x$s.getLayout=function(){return this._layout===x$k.EMPTY&&(this._layout=new x$k),this._layout},x$s._setLayoutEnabled=function(x$b){this._layout&&this._layout.enable!=x$b&&(this._layout.enable=x$b,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},x$s.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},x$s.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},x$s.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},x$s.resetLayoutX=function(){var x$b=this._layout;if(isNaN(x$b.anchorX)||(this.pivotX=x$b.anchorX*this.width),this.layoutEnabled){var x$_=this.parent;x$_&&(isNaN(x$b.centerX)?isNaN(x$b.left)?isNaN(x$b.right)||(this.x=Math.round(x$_.width-this.displayWidth-x$b.right+this.pivotX*this.scaleX)):(this.x=Math.round(x$b.left+this.pivotX*this.scaleX),isNaN(x$b.right)||(this.width=(x$_._width-x$b.left-x$b.right)/(this.scaleX||.01))):this.x=Math.round(.5*(x$_.width-this.displayWidth)+x$b.centerX+this.pivotX*this.scaleX))}},x$s.resetLayoutY=function(){var x$b=this._layout;if(isNaN(x$b.anchorY)||(this.pivotY=x$b.anchorY*this.height),this.layoutEnabled){var x$_=this.parent;x$_&&(isNaN(x$b.centerY)?isNaN(x$b.top)?isNaN(x$b.bottom)||(this.y=Math.round(x$_.height-this.displayHeight-x$b.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(x$b.top+this.pivotY*this.scaleY),isNaN(x$b.bottom)||(this.height=(x$_._height-x$b.top-x$b.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(x$_.height-this.displayHeight)+x$b.centerY+this.pivotY*this.scaleY))}},x$s.onMouseOver=function(x$b){x$y.stage.event("showtip",this._toolTip)},x$s.onMouseOut=function(x$b){x$y.stage.event("hidetip",this._toolTip)},x$x(0,x$s,"displayWidth",function(){return this.width*this.scaleX}),x$x(0,x$s,"width",function(){return this._width?this._width:this.measureWidth},function(x$b){this._width!=x$b&&(this._width=x$b,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),x$x(0,x$s,"measureWidth",function(){var x$b=0;this.commitMeasure();for(var x$_=this.numChildren-1;-1<x$_;x$_--){var x$s=this.getChildAt(x$_);x$s.visible&&(x$b=Math.max(x$s.x+x$s.width*x$s.scaleX,x$b))}return x$b}),x$x(0,x$s,"displayHeight",function(){return this.height*this.scaleY}),x$x(0,x$s,"height",function(){return this._height?this._height:this.measureHeight},function(x$b){this._height!=x$b&&(this._height=x$b,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),x$x(0,x$s,"dataSource",function(){return this._dataSource},function(x$b){for(var x$_ in this._dataSource=x$b,this._dataSource)this.hasOwnProperty(x$_)&&"function"!=typeof this[x$_]&&(this[x$_]=this._dataSource[x$_])}),x$x(0,x$s,"scaleY",x$_.prototype._$get_scaleY,function(x$b){x$y.superGet(x$c,this,"scaleY")!=x$b&&(x$y.superSet(x$c,this,"scaleY",x$b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),x$x(0,x$s,"measureHeight",function(){var x$b=0;this.commitMeasure();for(var x$_=this.numChildren-1;-1<x$_;x$_--){var x$s=this.getChildAt(x$_);x$s.visible&&(x$b=Math.max(x$s.y+x$s.height*x$s.scaleY,x$b))}return x$b}),x$x(0,x$s,"scaleX",x$_.prototype._$get_scaleX,function(x$b){x$y.superGet(x$c,this,"scaleX")!=x$b&&(x$y.superSet(x$c,this,"scaleX",x$b),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),x$x(0,x$s,"top",function(){return this._layout.top},function(x$b){x$b!=this._layout.top&&(this.getLayout().top=x$b,this._setLayoutEnabled(!0)),this.resetLayoutY()}),x$x(0,x$s,"bottom",function(){return this._layout.bottom},function(x$b){x$b!=this._layout.bottom&&(this.getLayout().bottom=x$b,this._setLayoutEnabled(!0)),this.resetLayoutY()}),x$x(0,x$s,"left",function(){return this._layout.left},function(x$b){x$b!=this._layout.left&&(this.getLayout().left=x$b,this._setLayoutEnabled(!0)),this.resetLayoutX()}),x$x(0,x$s,"right",function(){return this._layout.right},function(x$b){x$b!=this._layout.right&&(this.getLayout().right=x$b,this._setLayoutEnabled(!0)),this.resetLayoutX()}),x$x(0,x$s,"centerX",function(){return this._layout.centerX},function(x$b){x$b!=this._layout.centerX&&(this.getLayout().centerX=x$b,this._setLayoutEnabled(!0)),this.resetLayoutX()}),x$x(0,x$s,"centerY",function(){return this._layout.centerY},function(x$b){x$b!=this._layout.centerY&&(this.getLayout().centerY=x$b,this._setLayoutEnabled(!0)),this.resetLayoutY()}),x$x(0,x$s,"anchorX",function(){return this._layout.anchorX},function(x$b){x$b!=this._layout.anchorX&&(this.getLayout().anchorX=x$b,this._setLayoutEnabled(!0)),this.resetLayoutX()}),x$x(0,x$s,"anchorY",function(){return this._layout.anchorY},function(x$b){x$b!=this._layout.anchorY&&(this.getLayout().anchorY=x$b,this._setLayoutEnabled(!0)),this.resetLayoutY()}),x$x(0,x$s,"tag",function(){return this._tag},function(x$b){this._tag=x$b}),x$x(0,x$s,"toolTip",function(){return this._toolTip},function(x$b){this._toolTip!=x$b&&(null!=(this._toolTip=x$b)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),x$x(0,x$s,"comXml",function(){return this._comXml},function(x$b){this._comXml=x$b}),x$x(0,x$s,"gray",function(){return this._gray},function(x$b){x$b!==this._gray&&(this._gray=x$b,x$S.gray(this,x$b))}),x$x(0,x$s,"disabled",function(){return this._disabled},function(x$b){x$b!==this._disabled&&(this.gray=this._disabled=x$b,this.mouseEnabled=!x$b)}),x$b}(x$c)),x$T=function(x$b){function x$_(){this.lockLayer=null,this.popupEffect=function(x$b){x$b.scale(1,1),x$o.from(x$b,{x:x$y.stage.width/2,y:x$y.stage.height/2,scaleX:0,scaleY:0},300,x$C.backOut,x$P.create(this,this.doOpen,[x$b]))},this.closeEffect=function(x$b,x$_){x$o.to(x$b,{x:x$y.stage.width/2,y:x$y.stage.height/2,scaleX:0,scaleY:0},300,x$C.strongOut,x$P.create(this,this.doClose,[x$b,x$_]))},x$_.__super.call(this),this.maskLayer=new x$c,this.popupEffectHandler=x$P.create(this,this.popupEffect,null,!1),this.closeEffectHandler=x$P.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,x$y.stage.addChild(this),x$y.stage.on("resize",this,this._onResize),x$Z.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}x$n(x$_,"laya.ui.DialogManager",x$c);var x$s=x$_.prototype;return x$s._closeOnSide=function(){var x$b=this.getChildAt(this.numChildren-1);x$b instanceof laya.ui.Dialog&&x$b.close("side")},x$s.setLockView=function(x$b){this.lockLayer||(this.lockLayer=new x$q,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(x$y.stage.width,x$y.stage.height)),this.lockLayer.removeChildren(),x$b&&(x$b.centerX=x$b.centerY=0,this.lockLayer.addChild(x$b))},x$s._onResize=function(x$b){var x$_=this.maskLayer.width=x$y.stage.width,x$s=this.maskLayer.height=x$y.stage.height;this.lockLayer&&this.lockLayer.size(x$_,x$s),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,x$_,x$s,x$Z.popupBgColor),this.maskLayer.alpha=x$Z.popupBgAlpha;for(var x$h=this.numChildren-1;-1<x$h;x$h--){var x$x=this.getChildAt(x$h);x$x.popupCenter&&this._centerDialog(x$x)}},x$s._centerDialog=function(x$b){x$b.x=Math.round((x$y.stage.width-x$b.width>>1)+x$b.pivotX),x$b.y=Math.round((x$y.stage.height-x$b.height>>1)+x$b.pivotY)},x$s.open=function(x$b,x$_,x$s){void 0===x$_&&(x$_=!1),void 0===x$s&&(x$s=!1),x$_&&this._closeAll(),x$b.popupCenter&&this._centerDialog(x$b),this.addChild(x$b),(x$b.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),x$s&&null!=x$b.popupEffect?x$b.popupEffect.runWith(x$b):this.doOpen(x$b),this.event("open")},x$s.doOpen=function(x$b){x$b.onOpened()},x$s.lock=function(x$b){this.lockLayer&&(x$b?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},x$s.close=function(x$b,x$_,x$s){void 0===x$s&&(x$s=!1),x$s&&null!=x$b.closeEffect?x$b.closeEffect.runWith([x$b,x$_]):this.doClose(x$b,x$_),this.event("close")},x$s.doClose=function(x$b,x$_){x$b.removeSelf(),x$b.isModal&&this._checkMask(),x$b.closeHandler&&x$b.closeHandler.runWith(x$_),x$b.onClosed(x$_)},x$s.closeAll=function(){this._closeAll(),this.event("close")},x$s._closeAll=function(){for(var x$b=this.numChildren-1;-1<x$b;x$b--){var x$_=this.getChildAt(x$b);x$_&&null!=x$_.close&&this.doClose(x$_)}},x$s.getDialogsByGroup=function(x$b){for(var x$_=[],x$s=this.numChildren-1;-1<x$s;x$s--){var x$h=this.getChildAt(x$s);x$h&&x$h.group===x$b&&x$_.push(x$h)}return x$_},x$s.closeByGroup=function(x$b){for(var x$_=[],x$s=this.numChildren-1;-1<x$s;x$s--){var x$h=this.getChildAt(x$s);x$h&&x$h.group===x$b&&(x$h.close(),x$_.push(x$h))}return x$_},x$s._checkMask=function(){this.maskLayer.removeSelf();for(var x$b=this.numChildren-1;-1<x$b;x$b--){var x$_=this.getChildAt(x$b);if(x$_&&x$_.isModal)return void this.addChildAt(this.maskLayer,x$b)}},x$_}(),x$q=function(x$b){function x$_(){x$_.__super.call(this)}x$n(x$_,"laya.ui.Box",x$b);var x$s=x$_.prototype;return x$y.imps(x$s,{"laya.ui.IBox":!0}),x$x(0,x$s,"dataSource",x$b.prototype._$get_dataSource,function(x$b){for(var x$_ in this._dataSource=x$b){var x$s=this.getChildByName(x$_);x$s?x$s.dataSource=x$b[x$_]:this.hasOwnProperty(x$_)&&"function"!=typeof this[x$_]&&(this[x$_]=x$b[x$_])}}),x$_}(x$W),x$U=function(x$_){function x$s(x$b,x$_){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,x$s.__super.call(this),this._labelColors=x$B.buttonLabelColors,this._stateNum=x$B.buttonStateNum,void 0===x$_&&(x$_=""),this.skin=x$b,this.label=x$_}x$n(x$s,"laya.ui.Button",x$_);var x$b=x$s.prototype;return x$y.imps(x$b,{"laya.ui.ISelect":!0}),x$b.destroy=function(x$b){x$R.clearCache(this,this._skin),x$R.clearObject(this,this._weakKey),void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(x$b),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},x$b.createChildren=function(){this.graphics=this._bitmap=new x$J},x$b.createText=function(){this._text||(this._text=new x$$,this._text.overflow=x$$.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},x$b.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},x$b.onMouse=function(x$b){if(!1!==this.toggle||!this._selected)return"click"===x$b.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=x$s.stateMap[x$b.type]))},x$b.changeClips=function(){var x$b=x$R.getRes(this._skin);if(x$b&&this._skin&&""!=this._skin){x$R.clearObject(this,this._weakKey);var x$_=x$b.sourceWidth,x$s=x$b.sourceHeight/this._stateNum;x$b.$_GID||(x$b.$_GID=x$M.getGID());var x$h=x$b.$_GID+"-"+this._stateNum,x$x=x$R.findObject(x$h);if(x$M.isOkTextureList(x$x)||(x$x=null),x$x)this._weakKey=x$h,x$R.keepObject(this,this._weakKey),this._sources=x$x;else{if(this._sources=[],1===this._stateNum)this._sources.push(x$b);else for(var x$n=0;x$n<this._stateNum;x$n++){var x$E=x$D.createFromTexture(x$b,0,x$s*x$n,x$_,x$s);if(x$b.alphaTexture){var x$C=x$b.width/x$b.alphaTexture.width;x$E.alphaTexture=x$D.createFromTexture(x$b.alphaTexture,0/x$C,x$s*x$n/x$C,x$_/x$C,x$s/x$C)}this._sources.push(x$E)}x$R.saveObject(x$h,this._sources),this._weakKey=x$h,x$R.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||x$_,this._bitmap.height=this._height||x$s,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=x$_)}else console.warn("lose skin ",this._skin,this.name,this.__className)},x$b.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var x$b=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[x$b]),this.label&&(this._text.color=this._labelColors[x$b],this._strokeColors&&(this._text.strokeColor=this._strokeColors[x$b]))},x$b._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},x$x(0,x$b,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(x$b){this.createText(),this._text.strokeColor=x$b}),x$x(0,x$b,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(x$R.clearCache(this,this._skin),this._skin=x$b,x$R.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),x$x(0,x$b,"state",function(){return this._state},function(x$b){this._state!=x$b&&(this._state=x$b,this._setStateChanged())}),x$x(0,x$b,"text",function(){return this.createText(),this._text}),x$x(0,x$b,"stateNum",function(){return this._stateNum},function(x$b){"string"==typeof x$b&&(x$b=parseInt(x$b)),this._stateNum!=x$b&&(this._stateNum=x$b<1?1:3<x$b?3:x$b,this.callLater(this.changeClips))}),x$x(0,x$b,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(x$b){this._strokeColors=x$S.fillArray(x$B.buttonLabelColors,x$b,String),this._setStateChanged()}),x$x(0,x$b,"labelColors",function(){return this._labelColors.join(",")},function(x$b){this._labelColors=x$S.fillArray(x$B.buttonLabelColors,x$b,String),this._setStateChanged()}),x$x(0,x$b,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),x$x(0,x$b,"label",function(){return this._text?this._text.text:null},function(x$b){(this._text||x$b)&&(this.createText(),this._text.text!=x$b&&(x$b&&!this._text.parent&&this.addChild(this._text),this._text.text=(x$b+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),x$x(0,x$b,"selected",function(){return this._selected},function(x$b){this._selected!=x$b&&(this._selected=x$b,this.state=this._selected?2:0,this.event("change"))}),x$x(0,x$b,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(x$b){this.createText(),this._text.padding=x$S.fillArray(x$B.labelPadding,x$b,Number)}),x$x(0,x$b,"labelSize",function(){return this.createText(),this._text.fontSize},function(x$b){this.createText(),this._text.fontSize=x$b}),x$x(0,x$b,"labelStroke",function(){return this.createText(),this._text.stroke},function(x$b){this.createText(),this._text.stroke=x$b}),x$x(0,x$b,"labelBold",function(){return this.createText(),this._text.bold},function(x$b){this.createText(),this._text.bold=x$b}),x$x(0,x$b,"labelFont",function(){return this.createText(),this._text.font},function(x$b){this.createText(),this._text.font=x$b}),x$x(0,x$b,"labelAlign",function(){return this.createText(),this._text.align},function(x$b){this.createText(),this._text.align=x$b}),x$x(0,x$b,"clickHandler",function(){return this._clickHandler},function(x$b){this._clickHandler=x$b}),x$x(0,x$b,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(x$b){this._bitmap.sizeGrid=x$S.fillArray(x$B.defaultSizeGrid,x$b,Number)}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$W,this,"width",x$b),this._autoSize&&(this._bitmap.width=x$b,this._text&&(this._text.width=x$b))}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$W,this,"height",x$b),this._autoSize&&(this._bitmap.height=x$b,this._text&&(this._text.height=x$b))}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)||"string"==typeof x$b?this.label=x$b+"":x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(x$b){this._bitmap._offset=x$b?x$S.fillArray([1,1],x$b,Number):[]}),x$h(x$s,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),x$s}(x$W),x$G=function(x$_){function x$h(x$b,x$_,x$s){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,x$h.__super.call(this),void 0===x$_&&(x$_=1),void 0===x$s&&(x$s=1),this._clipX=x$_,this._clipY=x$s,this.skin=x$b}x$n(x$h,"laya.ui.Clip",x$_);var x$b=x$h.prototype;return x$b.destroy=function(x$b){x$R.clearCache(this,this._skin),x$R.clearObject(this,this._weakKey),void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},x$b.dispose=function(){this.destroy(!0),x$y.loader.clearRes(this._skin)},x$b.createChildren=function(){this.graphics=this._bitmap=new x$J},x$b._onDisplay=function(x$b){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},x$b.changeClip=function(){if(this._clipChanged=!1,this._skin){var x$b=x$R.getRes(this._skin);x$b?this.loadComplete(this._skin,x$b):x$y.loader.load(this._skin,x$P.create(this,this.loadComplete,[this._skin]))}},x$b.loadComplete=function(x$b,x$_){if(x$b===this._skin&&x$_){x$R.clearObject(this,this._weakKey);var x$s=this._clipWidth||Math.ceil(x$_.sourceWidth/this._clipX),x$h=this._clipHeight||Math.ceil(x$_.sourceHeight/this._clipY),x$x=this._skin+x$s+x$h,x$n=x$R.findObject(x$x);if(x$M.isOkTextureList(x$n)||(x$n=null),x$n)this._weakKey=x$x,x$R.keepObject(this,this._weakKey),this._sources=x$n;else{this._sources=[];for(var x$E=0;x$E<this._clipY;x$E++)for(var x$C=0;x$C<this._clipX;x$C++){var x$O=x$D.createFromTexture(x$_,x$s*x$C,x$h*x$E,x$s,x$h);if(x$_.alphaTexture){var x$L=x$_.width/x$_.alphaTexture.width;x$O.alphaTexture=x$D.createFromTexture(x$_.alphaTexture,x$s*x$C/x$L,x$h*x$E/x$L,x$s/x$L,x$h/x$L)}this._sources.push(x$O)}x$R.saveObject(x$x,this._sources),this._weakKey=x$x,x$R.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},x$b.play=function(x$b,x$_){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=-1),this._isPlaying=!0,this.index=x$b,this._toIndex=x$_,this._index++,x$y.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},x$b._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},x$b.stop=function(){this._isPlaying=!1,x$y.timer.clear(this,this._loop),this.event("complete")},x$b._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},x$x(0,x$b,"interval",function(){return this._interval},function(x$b){this._interval!=x$b&&(this._interval=x$b,this._isPlaying&&this.play())}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(x$R.clearCache(this,this._skin),(this._skin=x$b)?(x$R.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),x$x(0,x$b,"sources",function(){return this._sources},function(x$b){this._sources=x$b,this.index=this._index,this.event("loaded")}),x$x(0,x$b,"clipX",function(){return this._clipX},function(x$b){this._clipX=x$b||1,this._setClipChanged()}),x$x(0,x$b,"clipY",function(){return this._clipY},function(x$b){this._clipY=x$b||1,this._setClipChanged()}),x$x(0,x$b,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),x$x(0,x$b,"clipWidth",function(){return this._clipWidth},function(x$b){this._clipWidth=x$b,this._setClipChanged()}),x$x(0,x$b,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(x$b){this._bitmap.sizeGrid=x$S.fillArray(x$B.defaultSizeGrid,x$b,Number)}),x$x(0,x$b,"group",function(){return this._group},function(x$b){x$b&&this._skin&&x$R.setGroup(this._skin,x$b),this._group=x$b}),x$x(0,x$b,"clipHeight",function(){return this._clipHeight},function(x$b){this._clipHeight=x$b,this._setClipChanged()}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$W,this,"width",x$b),this._bitmap.width=x$b}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$W,this,"height",x$b),this._bitmap.height=x$b}),x$x(0,x$b,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),x$x(0,x$b,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),x$x(0,x$b,"index",function(){return this._index},function(x$b){this._index=x$b,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[x$b]),this.event("change")}),x$x(0,x$b,"autoPlay",function(){return this._autoPlay},function(x$b){this._autoPlay!=x$b&&((this._autoPlay=x$b)?this.play():this.stop())}),x$x(0,x$b,"isPlaying",function(){return this._isPlaying},function(x$b){this._isPlaying=x$b}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)&&Math.floor(x$b)==x$b||"string"==typeof x$b?this.index=parseInt(x$b):x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"bitmap",function(){return this._bitmap}),x$h}(x$W),x$z=function(x$_){function x$b(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,x$b.__super.call(this)}x$n(x$b,"laya.ui.ColorPicker",x$_);var x$s=x$b.prototype;return x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._colorPanel&&this._colorPanel.destroy(x$b),this._colorButton&&this._colorButton.destroy(x$b),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},x$s.createChildren=function(){this.addChild(this._colorButton=new x$U),this._colorPanel=new x$q,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new x$c),this._colorPanel.addChild(this._colorBlock=new x$c),this._colorPanel.addChild(this._colorInput=new x$V)},x$s.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},x$s.onPanelMouseDown=function(x$b){x$b.stopPropagation()},x$s.changePanel=function(){this._panelChanged=!1;var x$b=this._colorPanel.graphics;x$b.clear(),x$b.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(x$b=this._colorTiles.graphics).clear();for(var x$_=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],x$s=0;x$s<12;x$s++)for(var x$h=0;x$h<20;x$h++){var x$x=0;x$x=0===x$h?x$_[x$s]:1===x$h?0:51*(((3*x$s+x$h/6)%3<<0)+3*(x$s/6<<0))<<16|x$h%6*51<<8|(x$s<<0)%6*51;var x$n=x$S.toColor(x$x);this._colors.push(x$n);var x$E=x$h*this._gridSize,x$C=x$s*this._gridSize;x$b.drawRect(x$E,x$C,this._gridSize,this._gridSize,x$n,"#000000")}},x$s.onColorButtonClick=function(x$b){this._colorPanel.parent?this.close():this.open()},x$s.open=function(){var x$b=this.localToGlobal(new x$Q),x$_=x$b.x+this._colorPanel.width<=x$y.stage.width?x$b.x:x$y.stage.width-this._colorPanel.width,x$s=x$b.y+this._colorButton.height;x$s=x$s+this._colorPanel.height<=x$y.stage.height?x$s:x$b.y-this._colorPanel.height,this._colorPanel.pos(x$_,x$s),this._colorPanel.zOrder=1001,x$y._currentStage.addChild(this._colorPanel),x$y.stage.on("mousedown",this,this.removeColorBox)},x$s.close=function(){x$y.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},x$s.removeColorBox=function(x$b){this.close()},x$s.onColorFieldKeyDown=function(x$b){13==x$b.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),x$b.stopPropagation())},x$s.onColorInputChange=function(x$b){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},x$s.onColorTilesClick=function(x$b){this.selectedColor=this.getColorByMouse(),this.close()},x$s.onColorTilesMouseMove=function(x$b){this._colorInput.focus=!1;var x$_=this.getColorByMouse();this._colorInput.text=x$_,this.drawBlock(x$_)},x$s.getColorByMouse=function(){var x$b=this._colorTiles.getMousePoint(),x$_=Math.floor(x$b.x/this._gridSize),x$s=Math.floor(x$b.y/this._gridSize);return this._colors[20*x$s+x$_]},x$s.drawBlock=function(x$b){var x$_=this._colorBlock.graphics;x$_.clear();var x$s=x$b||"#ffffff";x$_.drawRect(0,0,50,20,x$s,this._borderColor),x$b||x$_.drawLine(0,0,50,20,"#ff0000")},x$s.changeColor=function(){var x$b=this.graphics;x$b.clear();var x$_=this._selectedColor||"#000000";x$b.drawRect(0,0,this._colorButton.width,this._colorButton.height,x$_)},x$s._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},x$x(0,x$s,"inputBgColor",function(){return this._inputBgColor},function(x$b){this._inputBgColor=x$b,this._setPanelChanged()}),x$x(0,x$s,"selectedColor",function(){return this._selectedColor},function(x$b){this._selectedColor!=x$b&&(this._selectedColor=this._colorInput.text=x$b,this.drawBlock(x$b),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",x$O.EMPTY.setTo("change",this,this)))}),x$x(0,x$s,"skin",function(){return this._colorButton.skin},function(x$b){this._colorButton.skin=x$b,this.changeColor()}),x$x(0,x$s,"bgColor",function(){return this._bgColor},function(x$b){this._bgColor=x$b,this._setPanelChanged()}),x$x(0,x$s,"borderColor",function(){return this._borderColor},function(x$b){this._borderColor=x$b,this._setPanelChanged()}),x$x(0,x$s,"inputColor",function(){return this._inputColor},function(x$b){this._inputColor=x$b,this._setPanelChanged()}),x$b}(x$W),x$a=function(x$_){function x$s(x$b,x$_){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,x$s.__super.call(this),this._itemColors=x$B.comboBoxItemColors,this.skin=x$b,this.labels=x$_}x$n(x$s,"laya.ui.ComboBox",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._button&&this._button.destroy(x$b),this._list&&this._list.destroy(x$b),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},x$b.createChildren=function(){this.addChild(this._button=new x$U),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},x$b._createList=function(){this._list=new x$X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},x$b._setListEvent=function(x$b){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=x$P.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},x$b.onListDown=function(x$b){x$b.stopPropagation()},x$b.onScrollBarDown=function(x$b){x$b.stopPropagation()},x$b.onButtonMouseDown=function(x$b){this.callLater(this.switchTo,[!this._isOpen])},x$b.changeList=function(){this._listChanged=!1;var x$b=this.width-2,x$_=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:x$b,height:this._itemHeight,fontSize:this._itemSize,color:x$_}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},x$b.onlistItemMouse=function(x$b,x$_){var x$s=x$b.type;if("mouseover"===x$s||"mouseout"===x$s){if(this._isCustomList)return;var x$h=this._list.getCell(x$_);if(!x$h)return;var x$x=x$h.getChildByName("label");x$x&&("mouseover"===x$s?(x$x.bgColor=this._itemColors[0],x$x.color=this._itemColors[1]):(x$x.bgColor=null,x$x.color=this._itemColors[2]))}else"click"===x$s&&(this.selectedIndex=x$_,this.isOpen=!1)},x$b.switchTo=function(x$b){this.isOpen=x$b},x$b.changeOpen=function(){this.isOpen=!this._isOpen},x$b.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var x$b=this._list.graphics;x$b.clear(),x$b.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var x$_=this._list.array||[],x$s=x$_.length=0,x$h=this._labels.length;x$s<x$h;x$s++)x$_.push({label:this._labels[x$s]});this._list.height=this._listHeight,this._list.array=x$_},x$b.changeSelected=function(){this._button.label=this.selectedLabel},x$b._onStageMouseWheel=function(x$b){this._list&&!this._list.contains(x$b.target)&&this.removeList(null)},x$b.removeList=function(x$b){x$y.stage.off("mousedown",this,this.removeList),x$y.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},x$x(0,x$b,"selectedIndex",function(){return this._selectedIndex},function(x$b){this._selectedIndex!=x$b&&(this._selectedIndex=x$b,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[x$O.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),x$x(0,x$b,"measureHeight",function(){return this._button.height}),x$x(0,x$b,"skin",function(){return this._button.skin},function(x$b){this._button.skin!=x$b&&(this._button.skin=x$b,this._listChanged=!0)}),x$x(0,x$b,"measureWidth",function(){return this._button.width}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$W,this,"width",x$b),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),x$x(0,x$b,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(x$b){this.selectedIndex=this._labels.indexOf(x$b)}),x$x(0,x$b,"labels",function(){return this._labels.join(",")},function(x$b){0<this._labels.length&&(this.selectedIndex=-1),x$b?this._labels=x$b.split(","):this._labels.length=0,this._itemChanged=!0}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$W,this,"height",x$b),this._button.height=this._height}),x$x(0,x$b,"selectHandler",function(){return this._selectHandler},function(x$b){this._selectHandler=x$b}),x$x(0,x$b,"visibleNum",function(){return this._visibleNum},function(x$b){this._visibleNum=x$b,this._listChanged=!0}),x$x(0,x$b,"labelBold",function(){return this._button.text.bold},function(x$b){this._button.text.bold=x$b}),x$x(0,x$b,"itemColors",function(){return String(this._itemColors)},function(x$b){this._itemColors=x$S.fillArray(this._itemColors,x$b,String),this._listChanged=!0}),x$x(0,x$b,"itemSize",function(){return this._itemSize},function(x$b){this._itemSize=x$b,this._listChanged=!0}),x$x(0,x$b,"scrollBar",function(){return this.list.scrollBar}),x$x(0,x$b,"isOpen",function(){return this._isOpen},function(x$b){if(this._isOpen!=x$b)if(this._isOpen=x$b,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var x$_=this.localToGlobal(x$Q.TEMP.setTo(0,0)),x$s=x$_.y+this._button.height;x$s=x$s+this._listHeight<=x$y.stage.height?x$s:x$_.y-this._listHeight,this._list.pos(x$_.x,x$s),this._list.zOrder=1001,x$y._currentStage.addChild(this._list),x$y.stage.once("mousedown",this,this.removeList),x$y.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),x$x(0,x$b,"scrollBarSkin",function(){return this._scrollBarSkin},function(x$b){this._scrollBarSkin=x$b}),x$x(0,x$b,"sizeGrid",function(){return this._button.sizeGrid},function(x$b){this._button.sizeGrid=x$b}),x$x(0,x$b,"button",function(){return this._button}),x$x(0,x$b,"list",function(){return this._list||this._createList(),this._list},function(x$b){x$b&&(x$b.removeSelf(),this._isCustomList=!0,this._list=x$b,this._setListEvent(x$b),this._itemHeight=x$b.getCell(0).height+x$b.spaceY)}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)&&Math.floor(x$b)==x$b||"string"==typeof x$b?this.selectedIndex=parseInt(x$b):x$b instanceof Array?this.labels=x$b.join(","):x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"labelColors",function(){return this._button.labelColors},function(x$b){this._button.labelColors!=x$b&&(this._button.labelColors=x$b)}),x$x(0,x$b,"labelPadding",function(){return this._button.text.padding.join(",")},function(x$b){this._button.text.padding=x$S.fillArray(x$B.labelPadding,x$b,Number)}),x$x(0,x$b,"labelSize",function(){return this._button.text.fontSize},function(x$b){this._button.text.fontSize=x$b}),x$x(0,x$b,"labelFont",function(){return this._button.text.font},function(x$b){this._button.text.font=x$b}),x$x(0,x$b,"stateNum",function(){return this._button.stateNum},function(x$b){this._button.stateNum=x$b}),x$s}(x$W),x$K=function(x$_){function x$s(x$b){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,x$s.__super.call(this),this._showButtons=x$Z.showButtons,this._touchScrollEnable=x$Z.touchScrollEnable,this._mouseWheelEnable=x$Z.mouseWheelEnable,this.skin=x$b,this.max=1}x$n(x$s,"laya.ui.ScrollBar",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),this.stopScroll(),this.target=null,x$_.prototype.destroy.call(this,x$b),this.upButton&&this.upButton.destroy(x$b),this.downButton&&this.downButton.destroy(x$b),this.slider&&this.slider.destroy(x$b),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},x$b.createChildren=function(){this.addChild(this.slider=new x$d),this.addChild(this.upButton=new x$U),this.addChild(this.downButton=new x$U)},x$b.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},x$b.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},x$b.onButtonMouseDown=function(x$b){var x$_=x$b.currentTarget===this.upButton;this.slide(x$_),x$y.timer.once(x$B.scrollBarDelayTime,this,this.startLoop,[x$_]),x$y.stage.once("mouseup",this,this.onStageMouseUp)},x$b.startLoop=function(x$b){x$y.timer.frameLoop(1,this,this.slide,[x$b])},x$b.slide=function(x$b){x$b?this.value-=this._scrollSize:this.value+=this._scrollSize},x$b.onStageMouseUp=function(x$b){x$y.timer.clear(this,this.startLoop),x$y.timer.clear(this,this.slide)},x$b.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},x$b.changeSize=function(){x$_.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},x$b.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},x$b.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},x$b.setScroll=function(x$b,x$_,x$s){this.runCallLater(this.changeSize),this.slider.setSlider(x$b,x$_,x$s),this.slider.bar.visible=0<x$_,!this._hide&&this.autoHide&&(this.visible=!1)},x$b.onTargetMouseWheel=function(x$b){this.value-=x$b.delta*this._scrollSize,this.target=this._target},x$b.onTargetMouseDown=function(x$b){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new x$Q),this._lastPoint.setTo(x$y.stage.mouseX,x$y.stage.mouseY),x$y.timer.clear(this,this.tweenMove),x$o.clearTween(this),x$y.stage.once("mouseup",this,this.onStageMouseUp2),x$y.stage.once("mouseout",this,this.onStageMouseUp2),x$y.timer.frameLoop(1,this,this.loop)},x$b.loop=function(){var x$b=x$y.stage.mouseY,x$_=x$y.stage.mouseX;if(this._lastOffset=this.isVertical?x$b-this._lastPoint.y:x$_-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?x$y.stage._canvasTransform.getScaleY():x$y.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=x$_,this._lastPoint.y=x$b,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},x$b.onStageMouseUp2=function(x$b){if(x$y.stage.off("mouseup",this,this.onStageMouseUp2),x$y.stage.off("mouseout",this,this.onStageMouseUp2),x$y.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?x$o.to(this,{value:this.min},this.elasticBackTime,x$C.sineOut,x$P.create(this,this.elasticOver)):this._value>this.max&&x$o.to(this,{value:this.max},this.elasticBackTime,x$C.sineOut,x$P.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?x$y.stage.mouseY-this._lastPoint.y:x$y.stage.mouseX-this._lastPoint.x);for(var x$_=0,x$s=Math.min(this._offsets.length,3),x$h=0;x$h<x$s;x$h++)x$_+=this._offsets[this._offsets.length-1-x$h];if(this._lastOffset=x$_/x$s,(x$_=Math.abs(this._lastOffset))<2)return void this.event("end");60<x$_&&(this._lastOffset=0<this._lastOffset?60:-60);var x$x=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));x$y.timer.frameLoop(1,this,this.tweenMove,[x$x])}},x$b.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&x$o.to(this,{alpha:0},500),this.event("end")},x$b.tweenMove=function(x$b){this._lastOffset*=this.rollRatio;var x$_=NaN;if(0<x$b&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,x$_=.5*-(this.min-x$b-this.value),this._lastOffset>x$_&&(this._lastOffset=x$_)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,x$_=.5*-(this.max+x$b-this.value),this._lastOffset<x$_&&(this._lastOffset=x$_))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(x$y.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?x$o.to(this,{value:this.min},this.elasticBackTime,x$C.sineOut,x$P.create(this,this.elasticOver)):this._value>this.max?x$o.to(this,{value:this.max},this.elasticBackTime,x$C.sineOut,x$P.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&x$o.to(this,{alpha:0},500)}},x$b.stopScroll=function(){this.onStageMouseUp2(null),x$y.timer.clear(this,this.tweenMove),x$o.clearTween(this)},x$x(0,x$b,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(this._skin=x$b,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),x$x(0,x$b,"max",function(){return this.slider.max},function(x$b){this.slider.max=x$b}),x$x(0,x$b,"showButtons",function(){return this._showButtons},function(x$b){this._showButtons=x$b,this.callLater(this.changeScrollBar)}),x$x(0,x$b,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),x$x(0,x$b,"min",function(){return this.slider.min},function(x$b){this.slider.min=x$b}),x$x(0,x$b,"value",function(){return this._value},function(x$b){x$b!==this._value&&(this._value=x$b,this._isElastic||(this.slider._value!=x$b&&(this.slider._value=x$b,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),x$x(0,x$b,"isVertical",function(){return this.slider.isVertical},function(x$b){this.slider.isVertical=x$b}),x$x(0,x$b,"sizeGrid",function(){return this.slider.sizeGrid},function(x$b){this.slider.sizeGrid=x$b}),x$x(0,x$b,"scrollSize",function(){return this._scrollSize},function(x$b){this._scrollSize=x$b}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)||"string"==typeof x$b?this.value=Number(x$b):x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"thumbPercent",function(){return this._thumbPercent},function(x$b){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),x$b=1<=x$b?.99:x$b,this._thumbPercent=x$b,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*x$b,x$B.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*x$b,x$B.scrollBarMinNum))}),x$x(0,x$b,"target",function(){return this._target},function(x$b){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=x$b)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),x$x(0,x$b,"hide",function(){return this._hide},function(x$b){this._hide=x$b,this.visible=!x$b}),x$x(0,x$b,"touchScrollEnable",function(){return this._touchScrollEnable},function(x$b){this._touchScrollEnable=x$b,this.target=this._target}),x$x(0,x$b,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(x$b){this._mouseWheelEnable=x$b,this.target=this._target}),x$x(0,x$b,"tick",function(){return this.slider.tick},function(x$b){this.slider.tick=x$b}),x$s}(x$W),x$d=function(x$_){function x$s(x$b){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,x$s.__super.call(this),this.skin=x$b}x$n(x$s,"laya.ui.Slider",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._bg&&this._bg.destroy(x$b),this._bar&&this._bar.destroy(x$b),this._progress&&this._progress.destroy(x$b),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},x$b.createChildren=function(){this.addChild(this._bg=new x$I),this.addChild(this._bar=new x$U)},x$b.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},x$b.onBarMouseDown=function(x$b){this._globalSacle||(this._globalSacle=new x$Q),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=x$y.stage.mouseX,this._ty=x$y.stage.mouseY,x$y.stage.on("mousemove",this,this.mouseMove),x$y.stage.once("mouseup",this,this.mouseUp),x$y.stage.once("mouseout",this,this.mouseUp),this.showValueText()},x$b.showValueText=function(){if(this.showLabel){var x$b=laya.ui.Slider.label;this.addChild(x$b),x$b.textField.changeText(this._value+""),this.isVertical?(x$b.x=this._bar.x+20,x$b.y=.5*(this._bar.height-x$b.height)+this._bar.y):(x$b.y=this._bar.y-20,x$b.x=.5*(this._bar.width-x$b.width)+this._bar.x)}},x$b.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},x$b.mouseUp=function(x$b){x$y.stage.off("mousemove",this,this.mouseMove),x$y.stage.off("mouseup",this,this.mouseUp),x$y.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},x$b.mouseMove=function(x$b){var x$_=this._value;this.isVertical?(this._bar.y+=(x$y.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(x$y.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=x$y.stage.mouseX,this._ty=x$y.stage.mouseY;var x$s=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*x$s)/x$s,this._value!=x$_&&this.sendChangeEvent(),this.showValueText()},x$b.sendChangeEvent=function(x$b){void 0===x$b&&(x$b="change"),this.event(x$b),this.changeHandler&&this.changeHandler.runWith(this._value)},x$b.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},x$b.changeSize=function(){x$_.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},x$b.setSlider=function(x$b,x$_,x$s){this._value=-1,this._min=x$b,this._max=x$b<x$_?x$_:x$b,this.value=x$s<x$b?x$b:x$_<x$s?x$_:x$s},x$b.changeValue=function(){var x$b=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*x$b)/x$b,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var x$_=this._max-this._min;0===x$_&&(x$_=1),this.isVertical?(this._bar.y=(this._value-this._min)/x$_*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/x$_*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},x$b.onBgMouseDown=function(x$b){var x$_=this._bg.getMousePoint();this.isVertical?this.value=x$_.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=x$_.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},x$x(0,x$b,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){if(this._skin!=x$b){this._skin=x$b,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var x$_=this._skin.replace(".png","$progress.png");x$R.getRes(x$_)&&(this._progress||(this.addChild(this._progress=new x$I),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=x$_),this.setBarPoint(),this.callLater(this.changeValue)}}),x$x(0,x$b,"allowClickBack",function(){return this._allowClickBack},function(x$b){this._allowClickBack!=x$b&&((this._allowClickBack=x$b)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),x$x(0,x$b,"max",function(){return this._max},function(x$b){this._max!=x$b&&(this._max=x$b,this.callLater(this.changeValue))}),x$x(0,x$b,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),x$x(0,x$b,"tick",function(){return this._tick},function(x$b){this._tick!=x$b&&(this._tick=x$b,this.callLater(this.changeValue))}),x$x(0,x$b,"sizeGrid",function(){return this._bg.sizeGrid},function(x$b){this._bg.sizeGrid=x$b,this._bar.sizeGrid=x$b,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),x$x(0,x$b,"min",function(){return this._min},function(x$b){this._min!=x$b&&(this._min=x$b,this.callLater(this.changeValue))}),x$x(0,x$b,"value",function(){return this._value},function(x$b){if(this._value!=x$b){var x$_=this._value;this._value=x$b,this.changeValue(),this._value!=x$_&&this.sendChangeEvent()}}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)||"string"==typeof x$b?this.value=Number(x$b):x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"bar",function(){return this._bar}),x$h(x$s,["label",function(){return this.label=new x$g}]),x$s}(x$W),x$I=function(x$_){function x$s(x$b){this._bitmap=null,this._skin=null,this._group=null,x$s.__super.call(this),this.skin=x$b}x$n(x$s,"laya.ui.Image",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,x$R.clearCache(this,this._skin)},x$b.dispose=function(){this.destroy(!0),x$R.clearCache(this,this._skin)},x$b.createChildren=function(){this.graphics=this._bitmap=new x$J},x$b.setSource=function(x$b,x$_){x$b===this._skin&&x$_&&(this.source=x$_,this.onCompResize())},x$x(0,x$b,"source",function(){return this._bitmap.source},function(x$b){this._bitmap&&(this._bitmap.source=x$b,this.event("loaded"),this.repaint())}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"string"==typeof(this._dataSource=x$b)?this.skin=x$b:x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"measureHeight",function(){return this._bitmap.height}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){if(this._skin!=x$b)if(x$R.clearCache(this,this._skin),this._skin=x$b){x$R.keepCache(this,this._skin);var x$_=x$R.getRes(x$b);x$_?(this.source=x$_,this.onCompResize()):x$y.loader.load(this._skin,x$P.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),x$x(0,x$b,"group",function(){return this._group},function(x$b){x$b&&this._skin&&x$R.setGroup(this._skin,x$b),this._group=x$b}),x$x(0,x$b,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(x$b){this._bitmap.sizeGrid=x$S.fillArray(x$B.defaultSizeGrid,x$b,Number)}),x$x(0,x$b,"measureWidth",function(){return this._bitmap.width}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$W,this,"width",x$b),this._bitmap.width=0==x$b?1e-7:x$b}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$W,this,"height",x$b),this._bitmap.height=0==x$b?1e-7:x$b}),x$s}(x$W),x$g=function(x$_){function x$s(x$b){this._tf=null,x$s.__super.call(this),void 0===x$b&&(x$b=""),x$L.defaultColor=x$B.labelColor,this.text=x$b}x$n(x$s,"laya.ui.Label",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._tf=null},x$b.createChildren=function(){this.addChild(this._tf=new x$$)},x$b.changeText=function(x$b){this._tf.changeText(x$b)},x$x(0,x$b,"padding",function(){return this._tf.padding.join(",")},function(x$b){this._tf.padding=x$S.fillArray(x$B.labelPadding,x$b,Number)}),x$x(0,x$b,"bold",function(){return this._tf.bold},function(x$b){this._tf.bold=x$b}),x$x(0,x$b,"align",function(){return this._tf.align},function(x$b){this._tf.align=x$b}),x$x(0,x$b,"text",function(){return this._tf.text},function(x$b){this._tf.text!=x$b&&(x$b&&(x$b=x$S.adptString(x$b+"")),this._tf.text=x$b,this.event("change"),this._width&&this._height||this.onCompResize())}),x$x(0,x$b,"italic",function(){return this._tf.italic},function(x$b){this._tf.italic=x$b}),x$x(0,x$b,"wordWrap",function(){return this._tf.wordWrap},function(x$b){this._tf.wordWrap=x$b}),x$x(0,x$b,"font",function(){return this._tf.font},function(x$b){this._tf.font=x$b}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)||"string"==typeof x$b?this.text=x$b+"":x$y.superSet(x$W,this,"dataSource",x$b)}),x$x(0,x$b,"color",function(){return this._tf.color},function(x$b){this._tf.color=x$b}),x$x(0,x$b,"valign",function(){return this._tf.valign},function(x$b){this._tf.valign=x$b}),x$x(0,x$b,"leading",function(){return this._tf.leading},function(x$b){this._tf.leading=x$b}),x$x(0,x$b,"fontSize",function(){return this._tf.fontSize},function(x$b){this._tf.fontSize=x$b}),x$x(0,x$b,"bgColor",function(){return this._tf.bgColor},function(x$b){this._tf.bgColor=x$b}),x$x(0,x$b,"borderColor",function(){return this._tf.borderColor},function(x$b){this._tf.borderColor=x$b}),x$x(0,x$b,"stroke",function(){return this._tf.stroke},function(x$b){this._tf.stroke=x$b}),x$x(0,x$b,"strokeColor",function(){return this._tf.strokeColor},function(x$b){this._tf.strokeColor=x$b}),x$x(0,x$b,"textField",function(){return this._tf}),x$x(0,x$b,"measureWidth",function(){return this._tf.width}),x$x(0,x$b,"measureHeight",function(){return this._tf.height}),x$x(0,x$b,"width",function(){return this._width||this._tf.text?x$y.superGet(x$W,this,"width"):0},function(x$b){x$y.superSet(x$W,this,"width",x$b),this._tf.width=x$b}),x$x(0,x$b,"height",function(){return this._height||this._tf.text?x$y.superGet(x$W,this,"height"):0},function(x$b){x$y.superSet(x$W,this,"height",x$b),this._tf.height=x$b}),x$x(0,x$b,"overflow",function(){return this._tf.overflow},function(x$b){this._tf.overflow=x$b}),x$x(0,x$b,"underline",function(){return this._tf.underline},function(x$b){this._tf.underline=x$b}),x$x(0,x$b,"underlineColor",function(){return this._tf.underlineColor},function(x$b){this._tf.underlineColor=x$b}),x$s}(x$W),x$F=function(x$_){function x$s(x$b){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,x$s.__super.call(this),this.skin=x$b}x$n(x$s,"laya.ui.ProgressBar",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._bg&&this._bg.destroy(x$b),this._bar&&this._bar.destroy(x$b),this._bg=this._bar=null,this.changeHandler=null},x$b.createChildren=function(){this.addChild(this._bg=new x$I),this.addChild(this._bar=new x$I)},x$b.changeValue=function(){if(this.sizeGrid){var x$b=this.sizeGrid.split(","),x$_=Number(x$b[3]),x$s=Number(x$b[1]),x$h=(this.width-x$_-x$s)*this._value;this._bar.width=x$_+x$s+x$h,this._bar.visible=this._bar.width>x$_+x$s}else this._bar.width=this.width*this._value},x$x(0,x$b,"measureHeight",function(){return this._bg.height}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(this._skin=x$b,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),x$x(0,x$b,"measureWidth",function(){return this._bg.width}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$W,this,"height",x$b),this._bg.height=this._height,this._bar.height=this._height}),x$x(0,x$b,"bar",function(){return this._bar}),x$x(0,x$b,"value",function(){return this._value},function(x$b){this._value!=x$b&&(x$b=1<x$b?1:x$b<0?0:x$b,this._value=x$b,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(x$b))}),x$x(0,x$b,"bg",function(){return this._bg}),x$x(0,x$b,"sizeGrid",function(){return this._bg.sizeGrid},function(x$b){this._bg.sizeGrid=this._bar.sizeGrid=x$b}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$W,this,"width",x$b),this._bg.width=this._width,this.callLater(this.changeValue)}),x$x(0,x$b,"dataSource",x$_.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)||"string"==typeof x$b?this.value=Number(x$b):x$y.superSet(x$W,this,"dataSource",x$b)}),x$s}(x$W),x$A=(function(x$b){function x$s(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,x$s.__super.call(this),this._tipBox=new x$W,this._tipBox.addChild(this._tipText=new x$$),this._tipText.x=this._tipText.y=5,this._tipText.color=x$s.tipTextColor,this._defaultTipHandler=this._showDefaultTip,x$y.stage.on("showtip",this,this._onStageShowTip),x$y.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}x$n(x$s,"laya.ui.TipManager",x$W);var x$_=x$s.prototype;x$_._onStageHideTip=function(x$b){x$y.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},x$_._onStageShowTip=function(x$b){x$y.timer.once(x$s.tipDelay,this,this._showTip,[x$b],!0)},x$_._showTip=function(x$b){if("string"==typeof x$b){var x$_=String(x$b);Boolean(x$_)&&this._defaultTipHandler(x$_)}else x$b instanceof laya.utils.Handler?x$b.run():"function"==typeof x$b&&x$b.apply();x$y.stage.on("mousemove",this,this._onStageMouseMove),x$y.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},x$_._onStageMouseDown=function(x$b){this.closeAll()},x$_._onStageMouseMove=function(x$b){this._showToStage(this,x$s.offsetX,x$s.offsetY)},x$_._showToStage=function(x$b,x$_,x$s){void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0);var x$h=x$b.getBounds();x$b.x=x$y.stage.mouseX+x$_,x$b.y=x$y.stage.mouseY+x$s,x$b.x+x$h.width>x$y.stage.width&&(x$b.x-=x$h.width+x$_),x$b.y+x$h.height>x$y.stage.height&&(x$b.y-=x$h.height+x$s)},x$_.closeAll=function(){x$y.timer.clear(this,this._showTip),x$y.stage.off("mousemove",this,this._onStageMouseMove),x$y.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},x$_.showDislayTip=function(x$b){this.addChild(x$b),this._showToStage(this),x$y._currentStage.addChild(this)},x$_._showDefaultTip=function(x$b){this._tipText.text=x$b;var x$_=this._tipBox.graphics;x$_.clear(),x$_.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,x$s.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),x$y._currentStage.addChild(this)},x$x(0,x$_,"defaultTipHandler",function(){return this._defaultTipHandler},function(x$b){this._defaultTipHandler=x$b}),x$s.offsetX=10,x$s.offsetY=15,x$s.tipTextColor="#ffffff",x$s.tipBackColor="#111111",x$s.tipDelay=200}(),function(x$b){var x$V;function x$Q(){this._idMap=null,this._aniList=null,this._watchMap={},x$Q.__super.call(this)}x$n(x$Q,"laya.ui.View",x$q);var x$_=x$Q.prototype;return x$_.createView=function(x$b){if(x$b.animations&&!this._idMap&&(this._idMap={}),x$Q.createComp(x$b,this,this),x$b.animations){var x$_,x$s,x$h=[],x$x=x$b.animations,x$n=0,x$E=x$x.length;for(x$n=0;x$n<x$E;x$n++){switch(x$_=new x$f,x$s=x$x[x$n],x$_._setUp(this._idMap,x$s),(this[x$s.name]=x$_)._setControlNode(this),x$s.action){case 1:x$_.play(0,!1);break;case 2:x$_.play(0,!0)}x$h.push(x$_)}this._aniList=x$h}0<this._width&&null==x$b.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},x$_.onEvent=function(x$b,x$_){},x$_.loadUI=function(x$b){var x$_=x$Q.uiMap[x$b];x$_&&this.createView(x$_)},x$_.destroy=function(x$b){void 0===x$b&&(x$b=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,x$b)},x$_.changeData=function(x$b){var x$_=this._watchMap[x$b];if(x$_){console.log("change",x$b);for(var x$s=0,x$h=x$_.length;x$s<x$h;x$s++){x$_[x$s].exe(this)}}},x$Q._regs=function(){for(var x$b in x$Q.uiClassMap)x$w.regClass(x$b,x$Q.uiClassMap[x$b])},x$Q.createComp=function(x$b,x$_,x$s,x$h){if(!(x$_=x$_||x$Q.getCompInstance(x$b)))return console.warn("can not create:"+x$b.type),null;var x$x=x$b.child;if(x$x)for(var x$n=x$_ instanceof laya.ui.List,x$E=0,x$C=x$x.length;x$E<x$C;x$E++){var x$O=x$x[x$E];if(!x$_.hasOwnProperty("itemRender")||"render"!=x$O.props.name&&"render"!==x$O.props.renderType)if("Graphic"==x$O.type)x$w.addGraphicsToSprite(x$O,x$_);else if(x$w.isDrawType(x$O.type))x$w.addGraphicToSprite(x$O,x$_,!0);else{if(x$n){var x$L=[],x$f=x$Q.createComp(x$O,null,x$s,x$L);x$L.length&&(x$f._$bindData=x$L)}else x$f=x$Q.createComp(x$O,null,x$s,x$h);"Script"==x$O.type?"owner"in x$f?x$f.owner=x$_:"target"in x$f&&(x$f.target=x$_):"mask"==x$O.props.renderType||"mask"==x$O.props.name?x$_.mask=x$f:x$f instanceof laya.display.Sprite&&x$_.addChild(x$f)}else x$_.itemRender=x$O}var x$p=x$b.props;for(var x$P in x$p){var x$V=x$p[x$P];x$Q.eventDic[x$P]?x$V&&x$s&&x$_.on(x$P,x$s,x$s.onEvent,[x$V]):x$Q.setCompValue(x$_,x$P,x$V,x$s,x$h)}return x$y.__typeof(x$_,"laya.ui.IItem")&&x$_.initItems(),x$b.compId&&x$s&&x$s._idMap&&(x$s._idMap[x$b.compId]=x$_),x$_},x$Q.setCompValue=function(x$b,x$_,x$s,x$h,x$x){if("string"==typeof x$s&&-1<x$s.indexOf("${")){if(x$Q._sheet||(x$Q._sheet=x$w.getClass("laya.data.Table")),!x$Q._sheet)return void console.warn("Can not find class Sheet");if(x$x)x$x.push(x$b,x$_,x$s);else if(x$h){-1==x$s.indexOf("].")&&(x$s=x$s.replace(".","[0]."));var x$n,x$E,x$C=new x$V(x$b,x$_,x$s);x$C.exe(x$h);for(var x$O=x$s.replace(/\[.*?\]\./g,".");null!=(x$n=x$Q._parseWatchData.exec(x$O));){for(var x$L=x$n[1];null!=(x$E=x$Q._parseKeyWord.exec(x$L));){var x$f=x$E[0],x$p=x$h._watchMap[x$f]||(x$h._watchMap[x$f]=[]);x$p.push(x$C),x$Q._sheet.I.notifer.on(x$f,x$h,x$h.changeData,[x$f])}(x$p=x$h._watchMap[x$L]||(x$h._watchMap[x$L]=[])).push(x$C),x$Q._sheet.I.notifer.on(x$L,x$h,x$h.changeData,[x$L])}}}else if("var"===x$_&&x$h)x$h[x$s]=x$b;else if("onClick"==x$_){var x$P=x$y._runScript("(function(){"+x$s+"})");x$b.on("click",x$h,x$P)}else x$b[x$_]="true"===x$s||"false"!==x$s&&x$s},x$Q.getCompInstance=function(x$b){var x$_,x$s=x$b.props?x$b.props.runtime:null;return x$_=x$s?x$Q.viewClassMap[x$s]||x$Q.uiClassMap[x$s]||x$y.__classmap[x$s]:x$Q.uiClassMap[x$b.type],x$b.props&&x$b.props.hasOwnProperty("renderType")&&"instance"==x$b.props.renderType?x$_.instance:x$_?new x$_:null},x$Q.regComponent=function(x$b,x$_){x$Q.uiClassMap[x$b]=x$_,x$w.regClass(x$b,x$_)},x$Q.regViewRuntime=function(x$b,x$_){x$Q.viewClassMap[x$b]=x$_},x$Q.uiMap={},x$Q.viewClassMap={},x$Q._sheet=null,x$h(x$Q,["uiClassMap",function(){return this.uiClassMap={ViewStack:x$bb,LinkButton:x$U,TextArea:x$Lb,ColorPicker:x$z,Box:x$q,Button:x$U,CheckBox:x$u,Clip:x$G,ComboBox:x$a,Component:x$W,HScrollBar:x$Y,HSlider:x$e,Image:x$I,Label:x$g,List:x$X,Panel:x$m,ProgressBar:x$F,Radio:x$H,RadioGroup:x$Cb,ScrollBar:x$K,Slider:x$d,Tab:x$Ob,TextInput:x$sb,View:x$Q,VScrollBar:x$_b,VSlider:x$hb,Tree:x$j,HBox:x$nb,VBox:x$Eb,Sprite:x$c,Animation:x$s,Text:x$$,FontClip:x$N}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),x$Q.__init$=function(){x$Q._regs(),x$V=function(){function x$b(x$b,x$_,x$s){this.comp=null,this.prop=null,this.value=null,this.comp=x$b,this.prop=x$_,this.value=x$s}return x$n(x$b,""),x$b.prototype.exe=function(x$b){var x$_=x$S.getBindFun(this.value);this.comp[this.prop]=x$_.call(this,x$b)},x$b}()},x$Q}()),x$u=function(x$b){function x$s(x$b,x$_){void 0===x$_&&(x$_=""),x$s.__super.call(this,x$b,x$_)}x$n(x$s,"laya.ui.CheckBox",x$b);var x$_=x$s.prototype;return x$_.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},x$_.initialize=function(){x$b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},x$x(0,x$_,"dataSource",x$b.prototype._$get_dataSource,function(x$b){"boolean"==typeof(this._dataSource=x$b)?this.selected=x$b:"string"==typeof x$b?this.selected="true"===x$b:x$y.superSet(x$U,this,"dataSource",x$b)}),x$s}(x$U),x$l=function(x$b){function x$_(){this._space=0,this._align="none",this._itemChanged=!1,x$_.__super.call(this)}x$n(x$_,"laya.ui.LayoutBox",x$q);var x$s=x$_.prototype;return x$s.addChild=function(x$b){return x$b.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,x$b)},x$s.onResize=function(x$b){this._setItemChanged()},x$s.addChildAt=function(x$b,x$_){return x$b.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,x$b,x$_)},x$s.removeChild=function(x$b){return x$b.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,x$b)},x$s.removeChildAt=function(x$b){return this.getChildAt(x$b).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,x$b)},x$s.refresh=function(){this._setItemChanged()},x$s.changeItems=function(){this._itemChanged=!1},x$s.sortItem=function(x$b){x$b&&x$b.sort(function(x$b,x$_){return x$b.y-x$_.y})},x$s._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},x$x(0,x$s,"space",function(){return this._space},function(x$b){this._space=x$b,this._setItemChanged()}),x$x(0,x$s,"align",function(){return this._align},function(x$b){this._align=x$b,this._setItemChanged()}),x$_}(),x$N=function(x$_){function x$s(x$b,x$_){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,x$s.__super.call(this),x$b&&(this.skin=x$b),x$_&&(this.sheet=x$_)}x$n(x$s,"laya.ui.FontClip",x$_);var x$b=x$s.prototype;return x$b.createChildren=function(){this._bitmap=new x$J,this.on("loaded",this,this._onClipLoaded)},x$b._onClipLoaded=function(){this.callLater(this.changeValue)},x$b.changeValue=function(){var x$b;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),x$b=this._sources[0]))){var x$_="horizontal"===this._direction;x$_?(this._wordsW=this._valueArr.length*(x$b.sourceWidth+this.spaceX),this._wordsH=x$b.sourceHeight):(this._wordsW=x$b.sourceWidth,this._wordsH=(x$b.sourceHeight+this.spaceY)*this._valueArr.length);var x$s=0;if(this._width)switch(this._align){case"center":x$s=.5*(this._width-this._wordsW);break;case"right":x$s=this._width-this._wordsW;break;default:x$s=0}for(var x$h=0,x$x=this._valueArr.length;x$h<x$x;x$h++){var x$n=this._indexMap[this._valueArr.charAt(x$h)];this.sources[x$n]&&(x$b=this.sources[x$n],x$_?this.graphics.drawTexture(x$b,x$s+x$h*(x$b.sourceWidth+this.spaceX),0,x$b.sourceWidth,x$b.sourceHeight):this.graphics.drawTexture(x$b,0+x$s,x$h*(x$b.sourceHeight+this.spaceY),x$b.sourceWidth,x$b.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),x$_.prototype.destroy.call(this,x$b)},x$x(0,x$b,"sheet",function(){return this._sheet},function(x$b){x$b+="";var x$_=(this._sheet=x$b).split(" ");this._clipX=String(x$_[0]).length,this.clipY=x$_.length,this._indexMap={};for(var x$s=0;x$s<this._clipY;x$s++)for(var x$h=x$_[x$s].split(""),x$x=0,x$n=x$h.length;x$x<x$n;x$x++)this._indexMap[x$h[x$x]]=x$s*this._clipX+x$x}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$G,this,"height",x$b),this.callLater(this.changeValue)}),x$x(0,x$b,"direction",function(){return this._direction},function(x$b){this._direction=x$b,this.callLater(this.changeValue)}),x$x(0,x$b,"value",function(){return this._valueArr?this._valueArr:""},function(x$b){x$b+="",this._valueArr=x$b,this.callLater(this.changeValue)}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$G,this,"width",x$b),this.callLater(this.changeValue)}),x$x(0,x$b,"spaceX",function(){return this._spaceX},function(x$b){this._spaceX=x$b,"horizontal"===this._direction&&this.callLater(this.changeValue)}),x$x(0,x$b,"spaceY",function(){return this._spaceY},function(x$b){this._spaceY=x$b,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),x$x(0,x$b,"align",function(){return this._align},function(x$b){this._align=x$b,this.callLater(this.changeValue)}),x$x(0,x$b,"measureWidth",function(){return this._wordsW}),x$x(0,x$b,"measureHeight",function(){return this._wordsH}),x$s}(x$G),x$X=function(x$b){function x$_(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new x$Q,x$_.__super.call(this)}x$n(x$_,"laya.ui.List",x$b);var x$s=x$_.prototype;return x$y.imps(x$s,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),this._content&&this._content.destroy(x$b),this._scrollBar&&this._scrollBar.destroy(x$b),laya.ui.Component.prototype.destroy.call(this,x$b),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},x$s.createChildren=function(){this.addChild(this._content=new x$q)},x$s.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=x$y.superGet(x$q,this,"cacheAs")),x$y.superSet(x$q,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},x$s.onScrollEnd=function(){x$y.superSet(x$q,this,"cacheAs",this._$P.cacheAs)},x$s._removePreScrollBar=function(){var x$b=this.removeChildByName("scrollBar");x$b&&x$b.destroy(!0)},x$s.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var x$b=this._getOneCell(),x$_=x$b.width+this._spaceX||1,x$s=x$b.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/x$_):Math.ceil(this._width/x$_)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/x$s):Math.round(this._height/x$s));var x$h=this._width?this._width:x$_*this.repeatX-this._spaceX,x$x=this._height?this._height:x$s*this.repeatY-this._spaceY;this._cellSize=this._isVertical?x$s:x$_,this._cellOffset=this._isVertical?x$s*Math.max(this._repeatY2,this._repeatY)-x$x-this._spaceY:x$_*Math.max(this._repeatX2,this._repeatX)-x$h-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=x$x:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=x$h),this.setContentSize(x$h,x$x);var x$n=this._isVertical?this.repeatX:this.repeatY,x$E=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,x$n,x$E),this._createdLine=x$E,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},x$s._getOneCell=function(){if(0===this._cells.length){var x$b=this.createItem();if(this._offset.setTo(x$b.x,x$b.y),this.cacheContent)return x$b;this._cells.push(x$b)}return this._cells[0]},x$s._createItems=function(x$b,x$_,x$s){var x$h=this._content,x$x=this._getOneCell(),x$n=x$x.width+this._spaceX,x$E=x$x.height+this._spaceY;if(this.cacheContent){var x$C=new x$q;x$C.cacheAsBitmap=!0,x$C.pos((this._isVertical?0:x$b)*x$n,(this._isVertical?x$b:0)*x$E),this._content.addChild(x$C),this._content.optimizeScrollRect=!0,x$h=x$C}else{for(var x$O=[],x$L=this._cells.length-1;-1<x$L;x$L--){var x$f=this._cells[x$L];x$f.removeSelf(),x$O.push(x$f)}this._cells.length=0}for(var x$p=x$b;x$p<x$s;x$p++)for(var x$P=0;x$P<x$_;x$P++)(x$x=x$O&&x$O.length?x$O.pop():this.createItem()).x=(this._isVertical?x$P:x$p)*x$n-x$h.x,x$x.y=(this._isVertical?x$p:x$P)*x$E-x$h.y,x$x.name="item"+(x$p*x$_+x$P),x$h.addChild(x$x),this.addCell(x$x)},x$s.createItem=function(){var x$b=[];if("function"==typeof this._itemRender)var x$_=new this._itemRender;else x$_=x$A.createComp(this._itemRender,null,null,x$b);if(0==x$b.length&&x$_._watchMap){var x$s=x$_._watchMap;for(var x$h in x$s)for(var x$x=x$s[x$h],x$n=0;x$n<x$x.length;x$n++){var x$E=x$x[x$n];x$b.push(x$E.comp,x$E.prop,x$E.value)}}return x$b.length&&(x$_._$bindData=x$b),x$_},x$s.addCell=function(x$b){x$b.on("click",this,this.onCellMouse),x$b.on("rightclick",this,this.onCellMouse),x$b.on("mouseover",this,this.onCellMouse),x$b.on("mouseout",this,this.onCellMouse),x$b.on("mousedown",this,this.onCellMouse),x$b.on("mouseup",this,this.onCellMouse),this._cells.push(x$b)},x$s.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var x$b=0,x$_=x$b=0;x$_<1e4;x$_++){var x$s=this.getChildByName("item"+x$_);if(!x$s)break;this.addCell(x$s),x$b++}this.repeatY=x$b}},x$s.setContentSize=function(x$b,x$_){this._content.width=x$b,this._content.height=x$_,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new x$i),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,x$b,x$_),this._content.scrollRect=this._content.scrollRect),this.event("resize")},x$s.onCellMouse=function(x$b){"mousedown"===x$b.type&&(this._isMoved=!1);var x$_=x$b.currentTarget,x$s=this._startIndex+this._cells.indexOf(x$_);x$s<0||("click"===x$b.type||"rightclick"===x$b.type?this.selectEnable&&!this._isMoved?this.selectedIndex=x$s:this.changeCellState(x$_,!0,0):"mouseover"!==x$b.type&&"mouseout"!==x$b.type||this._selectedIndex===x$s||this.changeCellState(x$_,"mouseover"===x$b.type,0),this.mouseHandler&&this.mouseHandler.runWith([x$b,x$s]))},x$s.changeCellState=function(x$b,x$_,x$s){var x$h=x$b.getChildByName("selectBox");x$h&&(this.selectEnable=!0,x$h.visible=x$_,x$h.index=x$s)},x$s.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},x$s.onScrollBarChange=function(x$b){this.runCallLater(this.changeCells);var x$_=this._scrollBar.value,x$s=this._isVertical?this.repeatX:this.repeatY,x$h=this._isVertical?this.repeatY:this.repeatX,x$x=Math.floor(x$_/this._cellSize);if(this.cacheContent)x$E=x$h+1,this._createdLine-x$x<x$E&&(this._createItems(this._createdLine,x$s,this._createdLine+x$E),this.renderItems(this._createdLine*x$s,0),this._createdLine+=x$E);else{var x$n=x$x*x$s,x$E=0;if(x$n>this._startIndex){x$E=x$n-this._startIndex;var x$C=!0,x$O=this._startIndex+x$s*(x$h+1);this._isMoved=!0}else x$n<this._startIndex&&(x$E=this._startIndex-x$n,x$C=!1,x$O=this._startIndex-1,this._isMoved=!0);for(var x$L=0;x$L<x$E;x$L++){if(x$C){var x$f=this._cells.shift();this._cells[this._cells.length]=x$f;var x$p=x$O+x$L}else x$f=this._cells.pop(),this._cells.unshift(x$f),x$p=x$O-x$L;var x$P=Math.floor(x$p/x$s)*this._cellSize;this._isVertical?x$f.y=x$P:x$f.x=x$P,this.renderItem(x$f,x$p)}this._startIndex=x$n,this.changeSelectStatus()}var x$V=this._content.scrollRect;this._isVertical?(x$V.y=x$_-this._offset.y,x$V.x=-this._offset.x):(x$V.y=-this._offset.y,x$V.x=x$_-this._offset.x),this._content.scrollRect=x$V},x$s.posCell=function(x$b,x$_){if(this._scrollBar){var x$s=this._isVertical?this.repeatX:this.repeatY,x$h=(this._isVertical?this.repeatY:this.repeatX,Math.floor(x$_/x$s)*this._cellSize);this._isVertical?x$b.y=x$h:x$b.x=x$h}},x$s.changeSelectStatus=function(){for(var x$b=0,x$_=this._cells.length;x$b<x$_;x$b++)this.changeCellState(this._cells[x$b],this._selectedIndex===this._startIndex+x$b,1)},x$s.renderItems=function(x$b,x$_){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0);for(var x$s=x$b,x$h=x$_||this._cells.length;x$s<x$h;x$s++)this.renderItem(this._cells[x$s],this._startIndex+x$s);this.changeSelectStatus()},x$s.renderItem=function(x$b,x$_){this._array&&0<=x$_&&x$_<this._array.length?(x$b.visible=!0,x$b._$bindData?(x$b._dataSource=this._array[x$_],this._bindData(x$b,this._array[x$_])):x$b.dataSource=this._array[x$_],this.cacheContent||this.posCell(x$b,x$_),this.hasListener("render")&&this.event("render",[x$b,x$_]),this.renderHandler&&this.renderHandler.runWith([x$b,x$_])):(x$b.visible=!1,x$b.dataSource=null)},x$s._bindData=function(x$b,x$_){for(var x$s=x$b._$bindData,x$h=0,x$x=x$s.length;x$h<x$x;x$h++){var x$n=x$s[x$h++],x$E=x$s[x$h++],x$C=x$s[x$h],x$O=x$S.getBindFun(x$C);x$n[x$E]=x$O.call(this,x$_)}},x$s.refresh=function(){this.array=this._array},x$s.getItem=function(x$b){return-1<x$b&&x$b<this._array.length?this._array[x$b]:null},x$s.changeItem=function(x$b,x$_){-1<x$b&&x$b<this._array.length&&(this._array[x$b]=x$_,x$b>=this._startIndex&&x$b<this._startIndex+this._cells.length&&this.renderItem(this.getCell(x$b),x$b))},x$s.setItem=function(x$b,x$_){this.changeItem(x$b,x$_)},x$s.addItem=function(x$b){this._array.push(x$b),this.array=this._array},x$s.addItemAt=function(x$b,x$_){this._array.splice(x$_,0,x$b),this.array=this._array},x$s.deleteItem=function(x$b){this._array.splice(x$b,1),this.array=this._array},x$s.getCell=function(x$b){return this.runCallLater(this.changeCells),-1<x$b&&this._cells?this._cells[(x$b-this._startIndex)%this._cells.length]:null},x$s.scrollTo=function(x$b){if(this._scrollBar){var x$_=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(x$b/x$_)*this._cellSize}else this.startIndex=x$b},x$s.tweenTo=function(x$b,x$_,x$s){if(void 0===x$_&&(x$_=200),this._scrollBar){var x$h=this._isVertical?this.repeatX:this.repeatY;x$o.to(this._scrollBar,{value:Math.floor(x$b/x$h)*this._cellSize},x$_,null,x$s,0,!0)}else this.startIndex=x$b,x$s&&x$s.run()},x$s._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},x$s.commitMeasure=function(){this.runCallLater(this.changeCells)},x$x(0,x$s,"cacheAs",x$b.prototype._$get_cacheAs,function(x$b){x$y.superSet(x$q,this,"cacheAs",x$b),this._scrollBar&&(this._$P.cacheAs=null,"none"!==x$b?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),x$x(0,x$s,"content",function(){return this._content}),x$x(0,x$s,"height",x$b.prototype._$get_height,function(x$b){x$b!=this._height&&(x$y.superSet(x$q,this,"height",x$b),this._setCellChanged())}),x$x(0,x$s,"itemRender",function(){return this._itemRender},function(x$b){if(this._itemRender!=x$b){this._itemRender=x$b;for(var x$_=this._cells.length-1;-1<x$_;x$_--)this._cells[x$_].destroy();this._cells.length=0,this._setCellChanged()}}),x$x(0,x$s,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(x$b){this._removePreScrollBar();var x$_=new x$_b;x$_.name="scrollBar",x$_.right=0,x$b&&" "!=x$b&&(x$_.skin=x$b),this.scrollBar=x$_,this.addChild(x$_),this._setCellChanged()}),x$x(0,x$s,"page",function(){return this._page},function(x$b){this._page=x$b,this._array&&(this._page=0<x$b?x$b:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),x$x(0,x$s,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(x$b){this._removePreScrollBar();var x$_=new x$Y;x$_.name="scrollBar",x$_.bottom=0,x$b&&" "!=x$b&&(x$_.skin=x$b),this.scrollBar=x$_,this.addChild(x$_),this._setCellChanged()}),x$x(0,x$s,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(x$b){this._repeatX=x$b,this._setCellChanged()}),x$x(0,x$s,"scrollBar",function(){return this._scrollBar},function(x$b){this._scrollBar!=x$b&&(this._scrollBar=x$b)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),x$x(0,x$s,"width",x$b.prototype._$get_width,function(x$b){x$b!=this._width&&(x$y.superSet(x$q,this,"width",x$b),this._setCellChanged())}),x$x(0,x$s,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(x$b){this._repeatY=x$b,this._setCellChanged()}),x$x(0,x$s,"spaceX",function(){return this._spaceX},function(x$b){this._spaceX=x$b,this._setCellChanged()}),x$x(0,x$s,"spaceY",function(){return this._spaceY},function(x$b){this._spaceY=x$b,this._setCellChanged()}),x$x(0,x$s,"selectedIndex",function(){return this._selectedIndex},function(x$b){this._selectedIndex!=x$b&&(this._selectedIndex=x$b,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(x$b),this.startIndex=this._startIndex)}),x$x(0,x$s,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(x$b){this.selectedIndex=this._array.indexOf(x$b)}),x$x(0,x$s,"length",function(){return this._array?this._array.length:0}),x$x(0,x$s,"selection",function(){return this.getCell(this._selectedIndex)},function(x$b){this.selectedIndex=this._startIndex+this._cells.indexOf(x$b)}),x$x(0,x$s,"startIndex",function(){return this._startIndex},function(x$b){this._startIndex=0<x$b?x$b:0,this.callLater(this.renderItems)}),x$x(0,x$s,"array",function(){return this._array},function(x$b){this.runCallLater(this.changeCells),this._array=x$b||[];var x$_=this._array.length;if(this.totalPage=Math.ceil(x$_/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<x$_?this._selectedIndex:x$_-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var x$s=this._isVertical?this.repeatX:this.repeatY,x$h=this._isVertical?this.repeatY:this.repeatX,x$x=Math.ceil(x$_/x$s);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=x$h/x$x,this._scrollBar.setScroll(0,(x$x-x$h)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),x$x(0,x$s,"dataSource",x$b.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)&&Math.floor(x$b)==x$b||"string"==typeof x$b?this.selectedIndex=parseInt(x$b):x$b instanceof Array?this.array=x$b:x$y.superSet(x$q,this,"dataSource",x$b)}),x$x(0,x$s,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),x$_}(x$q),x$Y=function(x$b){function x$_(){x$_.__super.call(this)}return x$n(x$_,"laya.ui.HScrollBar",x$b),x$_.prototype.initialize=function(){x$b.prototype.initialize.call(this),this.slider.isVertical=!1},x$_}(x$K),x$m=function(x$b){function x$_(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,x$_.__super.call(this),this.width=this.height=100}x$n(x$_,"laya.ui.Panel",x$b);var x$s=x$_.prototype;return x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),laya.ui.Component.prototype.destroy.call(this,x$b),this._content&&this._content.destroy(x$b),this._vScrollBar&&this._vScrollBar.destroy(x$b),this._hScrollBar&&this._hScrollBar.destroy(x$b),this._vScrollBar=null,this._hScrollBar=null,this._content=null},x$s.destroyChildren=function(){this._content.destroyChildren()},x$s.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new x$q)},x$s.addChild=function(x$b){return x$b.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(x$b)},x$s.onResize=function(){this._setScrollChanged()},x$s.addChildAt=function(x$b,x$_){return x$b.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(x$b,x$_)},x$s.removeChild=function(x$b){return x$b.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(x$b)},x$s.removeChildAt=function(x$b){return this.getChildAt(x$b).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(x$b)},x$s.removeChildren=function(x$b,x$_){return void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=2147483647),this._content.removeChildren(x$b,x$_),this._setScrollChanged(),this},x$s.getChildAt=function(x$b){return this._content.getChildAt(x$b)},x$s.getChildByName=function(x$b){return this._content.getChildByName(x$b)},x$s.getChildIndex=function(x$b){return this._content.getChildIndex(x$b)},x$s.changeScroll=function(){this._scrollChanged=!1;var x$b=this.contentWidth||1,x$_=this.contentHeight||1,x$s=this._vScrollBar,x$h=this._hScrollBar,x$x=x$s&&x$_>this._height,x$n=x$h&&x$b>this._width,x$E=x$x?this._width-x$s.width:this._width,x$C=x$n?this._height-x$h.height:this._height;x$s&&(x$s.x=this._width-x$s.width,x$s.y=0,x$s.height=this._height-(x$n?x$h.height:0),x$s.scrollSize=Math.max(.033*this._height,1),x$s.thumbPercent=x$C/x$_,x$s.setScroll(0,x$_-x$C,x$s.value)),x$h&&(x$h.x=0,x$h.y=this._height-x$h.height,x$h.width=this._width-(x$x?x$s.width:0),x$h.scrollSize=Math.max(.033*this._width,1),x$h.thumbPercent=x$E/x$b,x$h.setScroll(0,x$b-x$E,x$h.value))},x$s.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},x$s.setContentSize=function(x$b,x$_){var x$s=this._content;x$s.width=x$b,x$s.height=x$_,x$s.scrollRect||(x$s.scrollRect=new x$i),x$s.scrollRect.setTo(0,0,x$b,x$_),x$s.scrollRect=x$s.scrollRect},x$s.onScrollBarChange=function(x$b){var x$_=this._content.scrollRect;if(x$_){var x$s=Math.round(x$b.value);x$b.isVertical?x$_.y=x$s:x$_.x=x$s,this._content.scrollRect=x$_}},x$s.scrollTo=function(x$b,x$_){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),this.vScrollBar&&(this.vScrollBar.value=x$_),this.hScrollBar&&(this.hScrollBar.value=x$b)},x$s.refresh=function(){this.changeScroll()},x$s.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=x$y.superGet(x$q,this,"cacheAs")),x$y.superSet(x$q,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},x$s.onScrollEnd=function(){x$y.superSet(x$q,this,"cacheAs",this._$P.cacheAs)},x$s._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},x$x(0,x$s,"numChildren",function(){return this._content.numChildren}),x$x(0,x$s,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(x$b){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new x$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=x$b}),x$x(0,x$s,"contentWidth",function(){for(var x$b=0,x$_=this._content.numChildren-1;-1<x$_;x$_--){var x$s=this._content.getChildAt(x$_);x$b=Math.max(x$s.x+x$s.width*x$s.scaleX,x$b)}return x$b}),x$x(0,x$s,"contentHeight",function(){for(var x$b=0,x$_=this._content.numChildren-1;-1<x$_;x$_--){var x$s=this._content.getChildAt(x$_);x$b=Math.max(x$s.y+x$s.height*x$s.scaleY,x$b)}return x$b}),x$x(0,x$s,"width",x$b.prototype._$get_width,function(x$b){x$y.superSet(x$q,this,"width",x$b),this._setScrollChanged()}),x$x(0,x$s,"hScrollBar",function(){return this._hScrollBar}),x$x(0,x$s,"content",function(){return this._content}),x$x(0,x$s,"height",x$b.prototype._$get_height,function(x$b){x$y.superSet(x$q,this,"height",x$b),this._setScrollChanged()}),x$x(0,x$s,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(x$b){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new x$_b),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=x$b}),x$x(0,x$s,"vScrollBar",function(){return this._vScrollBar}),x$x(0,x$s,"cacheAs",x$b.prototype._$get_cacheAs,function(x$b){x$y.superSet(x$q,this,"cacheAs",x$b),this._$P.cacheAs=null,"none"!==x$b?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),x$_}(x$q),x$e=function(x$b){function x$_(x$b){x$_.__super.call(this,x$b),this.isVertical=!1}return x$n(x$_,"laya.ui.HSlider",x$d),x$_}(),x$v=function(x$b){function x$s(x$b,x$_){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,x$s.__super.call(this),this.skin=x$_,this.labels=x$b}x$n(x$s,"laya.ui.UIGroup",x$b);var x$_=x$s.prototype;return x$y.imps(x$_,{"laya.ui.IItem":!0}),x$_.preinitialize=function(){this.mouseEnabled=!0},x$_.destroy=function(x$b){void 0===x$b&&(x$b=!0),laya.ui.Component.prototype.destroy.call(this,x$b),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},x$_.addItem=function(x$b,x$_){void 0===x$_&&(x$_=!0);var x$s=x$b,x$h=this._items.length;if(x$s.name="item"+x$h,this.addChild(x$s),this.initItems(),x$_&&0<x$h){var x$x=this._items[x$h-1];"horizontal"==this._direction?x$s.x=x$x.x+x$x.width+this._space:x$s.y=x$x.y+x$x.height+this._space}else x$_&&(x$s.x=0,x$s.y=0);return x$h},x$_.delItem=function(x$b,x$_){void 0===x$_&&(x$_=!0);var x$s=this._items.indexOf(x$b);if(-1!=x$s){var x$h=x$b;this.removeChild(x$h);for(var x$x=x$s+1,x$n=this._items.length;x$x<x$n;x$x++){var x$E=this._items[x$x];x$E.name="item"+(x$x-1),x$_&&("horizontal"==this._direction?x$E.x-=x$h.width+this._space:x$E.y-=x$h.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var x$C;x$C=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=x$C}}},x$_.initItems=function(){this._items||(this._items=[]);for(var x$b=this._items.length=0;x$b<1e4;x$b++){var x$_=this.getChildByName("item"+x$b);if(null==x$_)break;this._items.push(x$_),x$_.selected=x$b===this._selectedIndex,x$_.clickHandler=x$P.create(this,this.itemClick,[x$b],!1)}},x$_.itemClick=function(x$b){this.selectedIndex=x$b},x$_.setSelect=function(x$b,x$_){this._items&&-1<x$b&&x$b<this._items.length&&(this._items[x$b].selected=x$_)},x$_.createItem=function(x$b,x$_){return null},x$_.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var x$b=0,x$_=0,x$s=this._items.length;x$_<x$s;x$_++){var x$h=this._items[x$_];this._skin&&(x$h.skin=this._skin),this._labelColors&&(x$h.labelColors=this._labelColors),this._labelSize&&(x$h.labelSize=this._labelSize),this._labelStroke&&(x$h.labelStroke=this._labelStroke),this._labelStrokeColor&&(x$h.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(x$h.strokeColors=this._strokeColors),this._labelBold&&(x$h.labelBold=this._labelBold),this._labelPadding&&(x$h.labelPadding=this._labelPadding),this._labelAlign&&(x$h.labelAlign=this._labelAlign),this._stateNum&&(x$h.stateNum=this._stateNum),this._labelFont&&(x$h.labelFont=this._labelFont),"horizontal"===this._direction?(x$h.y=0,x$h.x=x$b,x$b+=x$h.width+this._space):(x$h.x=0,x$h.y=x$b,x$b+=x$h.height+this._space)}this.changeSize()},x$_.commitMeasure=function(){this.runCallLater(this.changeLabels)},x$_._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},x$x(0,x$_,"labelStrokeColor",function(){return this._labelStrokeColor},function(x$b){this._labelStrokeColor!=x$b&&(this._labelStrokeColor=x$b,this._setLabelChanged())}),x$x(0,x$_,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(this._skin=x$b,this._setLabelChanged())}),x$x(0,x$_,"selectedIndex",function(){return this._selectedIndex},function(x$b){this._selectedIndex!=x$b&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=x$b,this.setSelect(x$b,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),x$x(0,x$_,"labels",function(){return this._labels},function(x$b){if(this._labels!=x$b){if(this._labels=x$b,this.removeChildren(),this._setLabelChanged(),this._labels)for(var x$_=this._labels.split(","),x$s=0,x$h=x$_.length;x$s<x$h;x$s++){var x$x=this.createItem(this._skin,x$_[x$s]);x$x.name="item"+x$s,this.addChild(x$x)}this.initItems()}}),x$x(0,x$_,"strokeColors",function(){return this._strokeColors},function(x$b){this._strokeColors!=x$b&&(this._strokeColors=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelColors",function(){return this._labelColors},function(x$b){this._labelColors!=x$b&&(this._labelColors=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelStroke",function(){return this._labelStroke},function(x$b){this._labelStroke!=x$b&&(this._labelStroke=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelSize",function(){return this._labelSize},function(x$b){this._labelSize!=x$b&&(this._labelSize=x$b,this._setLabelChanged())}),x$x(0,x$_,"stateNum",function(){return this._stateNum},function(x$b){this._stateNum!=x$b&&(this._stateNum=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelBold",function(){return this._labelBold},function(x$b){this._labelBold!=x$b&&(this._labelBold=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelFont",function(){return this._labelFont},function(x$b){this._labelFont!=x$b&&(this._labelFont=x$b,this._setLabelChanged())}),x$x(0,x$_,"labelPadding",function(){return this._labelPadding},function(x$b){this._labelPadding!=x$b&&(this._labelPadding=x$b,this._setLabelChanged())}),x$x(0,x$_,"direction",function(){return this._direction},function(x$b){this._direction=x$b,this._setLabelChanged()}),x$x(0,x$_,"space",function(){return this._space},function(x$b){this._space=x$b,this._setLabelChanged()}),x$x(0,x$_,"items",function(){return this._items}),x$x(0,x$_,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(x$b){this.selectedIndex=this._items.indexOf(x$b)}),x$x(0,x$_,"dataSource",x$b.prototype._$get_dataSource,function(x$b){"number"==typeof(this._dataSource=x$b)&&Math.floor(x$b)==x$b||"string"==typeof x$b?this.selectedIndex=parseInt(x$b):x$b instanceof Array?this.labels=x$b.join(","):x$y.superSet(x$q,this,"dataSource",x$b)}),x$s}(x$q),x$H=function(x$_){function x$s(x$b,x$_){this._value=null,void 0===x$_&&(x$_=""),x$s.__super.call(this,x$b,x$_)}x$n(x$s,"laya.ui.Radio",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._value=null},x$b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},x$b.initialize=function(){x$_.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},x$b.onClick=function(x$b){this.selected=!0},x$x(0,x$b,"value",function(){return null!=this._value?this._value:this.label},function(x$b){this._value=x$b}),x$s}(x$U),x$j=function(x$b){function x$_(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,x$_.__super.call(this),this.width=this.height=200}x$n(x$_,"laya.ui.Tree",x$b);var x$s=x$_.prototype;return x$y.imps(x$s,{"laya.ui.IRender":!0}),x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),laya.ui.Component.prototype.destroy.call(this,x$b),this._list&&this._list.destroy(x$b),this._list=null,this._source=null,this._renderHandler=null},x$s.createChildren=function(){this.addChild(this._list=new x$X),this._list.renderHandler=x$P.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},x$s.onListChange=function(x$b){this.event("change")},x$s.getArray=function(){var x$b,x$_=[];for(var x$s in this._source)x$b=this._source[x$s],this.getParentOpenStatus(x$b)&&(x$b.x=this._spaceLeft*this.getDepth(x$b),x$_.push(x$b));return x$_},x$s.getDepth=function(x$b,x$_){return void 0===x$_&&(x$_=0),null==x$b.nodeParent?x$_:this.getDepth(x$b.nodeParent,x$_+1)},x$s.getParentOpenStatus=function(x$b){var x$_=x$b.nodeParent;return null==x$_||!!x$_.isOpen&&(null==x$_.nodeParent||this.getParentOpenStatus(x$_))},x$s.renderItem=function(x$b,x$_){var x$s=x$b.dataSource;if(x$s){x$b.left=x$s.x;var x$h=x$b.getChildByName("arrow");x$h&&(x$s.hasChild?(x$h.visible=!0,x$h.index=x$s.isOpen?1:0,x$h.tag=x$_,x$h.off("click",this,this.onArrowClick),x$h.on("click",this,this.onArrowClick)):x$h.visible=!1);var x$x=x$b.getChildByName("folder");x$x&&(2==x$x.clipY?x$x.index=x$s.isDirectory?0:1:x$x.index=x$s.isDirectory?x$s.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([x$b,x$_])}},x$s.onArrowClick=function(x$b){var x$_=x$b.currentTarget.tag;this._list.array[x$_].isOpen=!this._list.array[x$_].isOpen,this.event("open"),this._list.array=this.getArray()},x$s.setItemState=function(x$b,x$_){this._list.array[x$b]&&(this._list.array[x$b].isOpen=x$_,this._list.array=this.getArray())},x$s.fresh=function(){this._list.array=this.getArray(),this.repaint()},x$s.parseXml=function(x$b,x$_,x$s,x$h){var x$x,x$n=x$b.childNodes,x$E=x$n.length;if(!x$h){x$x={};var x$C,x$O=x$b.attributes;for(var x$L in x$O){var x$f=(x$C=x$O[x$L]).nodeName,x$p=x$C.nodeValue;x$x[x$f]="true"==x$p||"false"!=x$p&&x$p}x$x.nodeParent=x$s,0<x$E&&(x$x.isDirectory=!0),x$x.hasChild=0<x$E,x$_.push(x$x)}for(var x$P=0;x$P<x$E;x$P++){var x$V=x$n[x$P];this.parseXml(x$V,x$_,x$x,!1)}},x$s.parseOpenStatus=function(x$b,x$_){for(var x$s=0,x$h=x$_.length;x$s<x$h;x$s++){var x$x=x$_[x$s];if(x$x.isDirectory)for(var x$n=0,x$E=x$b.length;x$n<x$E;x$n++){var x$C=x$b[x$n];if(x$C.isDirectory&&this.isSameParent(x$C,x$x)&&x$x.label==x$C.label){x$x.isOpen=x$C.isOpen;break}}}},x$s.isSameParent=function(x$b,x$_){return null==x$b.nodeParent&&null==x$_.nodeParent||null!=x$b.nodeParent&&null!=x$_.nodeParent&&(x$b.nodeParent.label==x$_.nodeParent.label&&this.isSameParent(x$b.nodeParent,x$_.nodeParent))},x$s.filter=function(x$b){if(Boolean(x$b)){var x$_=[];this.getFilterSource(this._source,x$_,x$b),this._list.array=x$_}else this._list.array=this.getArray()},x$s.getFilterSource=function(x$b,x$_,x$s){var x$h;for(var x$x in x$s=x$s.toLocaleLowerCase(),x$b)!(x$h=x$b[x$x]).isDirectory&&-1<String(x$h.label).toLowerCase().indexOf(x$s)&&(x$h.x=0,x$_.push(x$h)),x$h.child&&0<x$h.child.length&&this.getFilterSource(x$h.child,x$_,x$s)},x$x(0,x$s,"spaceBottom",function(){return this._list.spaceY},function(x$b){this._list.spaceY=x$b}),x$x(0,x$s,"keepStatus",function(){return this._keepStatus},function(x$b){this._keepStatus=x$b}),x$x(0,x$s,"itemRender",function(){return this._list.itemRender},function(x$b){this._list.itemRender=x$b}),x$x(0,x$s,"array",function(){return this._list.array},function(x$b){this._keepStatus&&this._list.array&&x$b&&this.parseOpenStatus(this._list.array,x$b),this._source=x$b,this._list.array=this.getArray()}),x$x(0,x$s,"mouseHandler",function(){return this._list.mouseHandler},function(x$b){this._list.mouseHandler=x$b}),x$x(0,x$s,"dataSource",x$b.prototype._$get_dataSource,function(x$b){this._dataSource=x$b,x$y.superSet(x$q,this,"dataSource",x$b)}),x$x(0,x$s,"source",function(){return this._source}),x$x(0,x$s,"scrollBar",function(){return this._list.scrollBar}),x$x(0,x$s,"list",function(){return this._list}),x$x(0,x$s,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(x$b){this._list.vScrollBarSkin=x$b}),x$x(0,x$s,"renderHandler",function(){return this._renderHandler},function(x$b){this._renderHandler=x$b}),x$x(0,x$s,"selectedIndex",function(){return this._list.selectedIndex},function(x$b){this._list.selectedIndex=x$b}),x$x(0,x$s,"spaceLeft",function(){return this._spaceLeft},function(x$b){this._spaceLeft=x$b}),x$x(0,x$s,"selectedItem",function(){return this._list.selectedItem},function(x$b){this._list.selectedItem=x$b}),x$x(0,x$s,"width",x$b.prototype._$get_width,function(x$b){x$y.superSet(x$q,this,"width",x$b),this._list.width=x$b}),x$x(0,x$s,"height",x$b.prototype._$get_height,function(x$b){x$y.superSet(x$q,this,"height",x$b),this._list.height=x$b}),x$x(0,x$s,"xml",null,function(x$b){var x$_=[];this.parseXml(x$b.childNodes[0],x$_,null,!0),this.array=x$_}),x$x(0,x$s,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),x$_}(x$q),x$bb=function(x$b){function x$_(){this._items=null,this._selectedIndex=0,x$_.__super.call(this),this._setIndexHandler=x$P.create(this,this.setIndex,null,!1)}x$n(x$_,"laya.ui.ViewStack",x$b);var x$s=x$_.prototype;return x$y.imps(x$s,{"laya.ui.IItem":!0}),x$s.setItems=function(x$b){this.removeChildren();for(var x$_=0,x$s=0,x$h=x$b.length;x$s<x$h;x$s++){var x$x=x$b[x$s];x$x&&(x$x.name="item"+x$_,this.addChild(x$x),x$_++)}this.initItems()},x$s.addItem=function(x$b){x$b.name="item"+this._items.length,this.addChild(x$b),this.initItems()},x$s.initItems=function(){this._items=[];for(var x$b=0;x$b<1e4;x$b++){var x$_=this.getChildByName("item"+x$b);if(null==x$_)break;this._items.push(x$_),x$_.visible=x$b==this._selectedIndex}},x$s.setSelect=function(x$b,x$_){this._items&&-1<x$b&&x$b<this._items.length&&(this._items[x$b].visible=x$_)},x$s.setIndex=function(x$b){this.selectedIndex=x$b},x$x(0,x$s,"dataSource",x$b.prototype._$get_dataSource,function(x$b){if("number"==typeof(this._dataSource=x$b)&&Math.floor(x$b)==x$b||"string"==typeof x$b)this.selectedIndex=parseInt(x$b);else for(var x$_ in this._dataSource)this.hasOwnProperty(x$_)&&(this[x$_]=this._dataSource[x$_])}),x$x(0,x$s,"selectedIndex",function(){return this._selectedIndex},function(x$b){this._selectedIndex!=x$b&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=x$b,this.setSelect(this._selectedIndex,!0))}),x$x(0,x$s,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(x$b){this.selectedIndex=this._items.indexOf(x$b)}),x$x(0,x$s,"items",function(){return this._items}),x$x(0,x$s,"setIndexHandler",function(){return this._setIndexHandler},function(x$b){this._setIndexHandler=x$b}),x$_}(x$q),x$_b=function(x$b){function x$_(){x$_.__super.call(this)}return x$n(x$_,"laya.ui.VScrollBar",x$K),x$_}(),x$sb=function(x$_){function x$s(x$b){this._bg=null,this._skin=null,x$s.__super.call(this),void 0===x$b&&(x$b=""),this.text=x$b,this.skin=this.skin}x$n(x$s,"laya.ui.TextInput",x$_);var x$b=x$s.prototype;return x$b.preinitialize=function(){this.mouseEnabled=!0},x$b.destroy=function(x$b){x$R.clearCache(this,this._skin),void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._bg&&this._bg.destroy(),this._bg=null},x$b.createChildren=function(){this.addChild(this._tf=new x$V),this._tf.padding=x$B.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},x$b._onFocus=function(){this.event("focus",this)},x$b._onBlur=function(){this.event("blur",this)},x$b._onInput=function(){this.event("input",this)},x$b._onEnter=function(){this.event("enter",this)},x$b.initialize=function(){this.width=128,this.height=22},x$b.select=function(){this._tf.select()},x$b.setSelection=function(x$b,x$_){this._tf.setSelection(x$b,x$_)},x$x(0,x$b,"text",x$_.prototype._$get_text,function(x$b){this._tf.text!=x$b&&(x$b+="",this._tf.text=x$b,this.event("change"))}),x$x(0,x$b,"bg",function(){return this._bg},function(x$b){this.graphics=this._bg=x$b}),x$x(0,x$b,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(x$b){this._tf.inputElementYAdjuster=x$b}),x$x(0,x$b,"multiline",function(){return this._tf.multiline},function(x$b){this._tf.multiline=x$b}),x$x(0,x$b,"skin",function(){return this._skin},function(x$b){this._skin!=x$b&&(x$R.clearCache(this,this._skin),this._skin=x$b,this._bg||(this.graphics=this._bg=new x$J),x$R.keepCache(this,this._skin),this._bg.source=x$R.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),x$x(0,x$b,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(x$b){this._bg||(this.graphics=this._bg=new x$J),this._bg.sizeGrid=x$S.fillArray(x$B.defaultSizeGrid,x$b,Number)}),x$x(0,x$b,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(x$b){this._tf.inputElementXAdjuster=x$b}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$g,this,"width",x$b),this._bg&&(this._bg.width=x$b)}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$g,this,"height",x$b),this._bg&&(this._bg.height=x$b)}),x$x(0,x$b,"editable",function(){return this._tf.editable},function(x$b){this._tf.editable=x$b}),x$x(0,x$b,"restrict",function(){return this._tf.restrict},function(x$b){this._tf.restrict=x$b}),x$x(0,x$b,"prompt",function(){return this._tf.prompt},function(x$b){this._tf.prompt=x$b}),x$x(0,x$b,"promptColor",function(){return this._tf.promptColor},function(x$b){this._tf.promptColor=x$b}),x$x(0,x$b,"maxChars",function(){return this._tf.maxChars},function(x$b){this._tf.maxChars=x$b}),x$x(0,x$b,"focus",function(){return this._tf.focus},function(x$b){this._tf.focus=x$b}),x$x(0,x$b,"type",function(){return this._tf.type},function(x$b){this._tf.type=x$b}),x$x(0,x$b,"asPassword",function(){return this._tf.asPassword},function(x$b){this._tf.asPassword=x$b}),x$s}(x$g),x$hb=function(x$b){function x$_(){x$_.__super.call(this)}return x$n(x$_,"laya.ui.VSlider",x$d),x$_}(),x$xb=function(x$b){function x$h(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,x$h.__super.call(this)}x$n(x$h,"laya.ui.Dialog",x$b);var x$_=x$h.prototype;return x$_.initialize=function(){this.popupEffect=x$h.manager.popupEffectHandler,this.closeEffect=x$h.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},x$_._dealDragArea=function(){var x$b=this.getChildByName("drag");x$b&&(this.dragArea=x$b.x+","+x$b.y+","+x$b.width+","+x$b.height,x$b.removeSelf())},x$_._onClick=function(x$b){var x$_=x$b.target;if(x$_)switch(x$_.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(x$_.name)}},x$_.show=function(x$b,x$_){void 0===x$b&&(x$b=!1),void 0===x$_&&(x$_=!0),this._open(!1,x$b,x$_)},x$_.popup=function(x$b,x$_){void 0===x$b&&(x$b=!1),void 0===x$_&&(x$_=!0),this._open(!0,x$b,x$_)},x$_._open=function(x$b,x$_,x$s){x$h.manager.lock(!1),this.isModal=x$b,x$h.manager.open(this,x$_,x$s)},x$_.onOpened=function(){},x$_.close=function(x$b,x$_){void 0===x$_&&(x$_=!0),x$h.manager.close(this,x$b,x$_)},x$_.onClosed=function(x$b){},x$_._onMouseDown=function(x$b){var x$_=this.getMousePoint();this._dragArea.contains(x$_.x,x$_.y)?this.startDrag():this.stopDrag()},x$x(0,x$_,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(x$b){if(x$b){var x$_=x$S.fillArray([0,0,0,0],x$b,Number);this._dragArea=new x$i(x$_[0],x$_[1],x$_[2],x$_[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),x$x(0,x$_,"isPopup",function(){return null!=this.parent}),x$x(0,x$_,"zOrder",x$b.prototype._$get_zOrder,function(x$b){x$y.superSet(x$A,this,"zOrder",x$b),x$h.manager._checkMask()}),x$x(1,x$h,"manager",function(){return x$h._manager=x$h._manager||new x$T},function(x$b){x$h._manager=x$b}),x$h.setLockView=function(x$b){x$h.manager.setLockView(x$b)},x$h.lock=function(x$b){x$h.manager.lock(x$b)},x$h.closeAll=function(){x$h.manager.closeAll()},x$h.getDialogsByGroup=function(x$b){return x$h.manager.getDialogsByGroup(x$b)},x$h.closeByGroup=function(x$b){return x$h.manager.closeByGroup(x$b)},x$h.CLOSE="close",x$h.CANCEL="cancel",x$h.SURE="sure",x$h.NO="no",x$h.OK="ok",x$h.YES="yes",x$h._manager=null,x$h}(x$A),x$nb=function(x$b){function x$_(){x$_.__super.call(this)}x$n(x$_,"laya.ui.HBox",x$b);var x$s=x$_.prototype;return x$s.sortItem=function(x$b){x$b&&x$b.sort(function(x$b,x$_){return x$b.x-x$_.x})},x$s.changeItems=function(){this._itemChanged=!1;for(var x$b=[],x$_=0,x$s=0,x$h=this.numChildren;x$s<x$h;x$s++){var x$x=this.getChildAt(x$s);x$x&&x$x.layoutEnabled&&(x$b.push(x$x),x$_=this._height?this._height:Math.max(x$_,x$x.height*x$x.scaleY))}this.sortItem(x$b);var x$n=0;for(x$s=0,x$h=x$b.length;x$s<x$h;x$s++)(x$x=x$b[x$s]).x=x$n,x$n+=x$x.width*x$x.scaleX+this._space,"top"==this._align?x$x.y=0:"middle"==this._align?x$x.y=.5*(x$_-x$x.height*x$x.scaleY):"bottom"==this._align&&(x$x.y=x$_-x$x.height*x$x.scaleY);this.changeSize()},x$x(0,x$s,"height",x$b.prototype._$get_height,function(x$b){this._height!=x$b&&(x$y.superSet(x$l,this,"height",x$b),this.callLater(this.changeItems))}),x$_.NONE="none",x$_.TOP="top",x$_.MIDDLE="middle",x$_.BOTTOM="bottom",x$_}(x$l),x$Eb=function(x$b){function x$_(){x$_.__super.call(this)}x$n(x$_,"laya.ui.VBox",x$b);var x$s=x$_.prototype;return x$s.changeItems=function(){this._itemChanged=!1;for(var x$b=[],x$_=0,x$s=0,x$h=this.numChildren;x$s<x$h;x$s++){var x$x=this.getChildAt(x$s);x$x&&x$x.layoutEnabled&&(x$b.push(x$x),x$_=this._width?this._width:Math.max(x$_,x$x.width*x$x.scaleX))}this.sortItem(x$b);var x$n=0;for(x$s=0,x$h=x$b.length;x$s<x$h;x$s++)(x$x=x$b[x$s]).y=x$n,x$n+=x$x.height*x$x.scaleY+this._space,"left"==this._align?x$x.x=0:"center"==this._align?x$x.x=.5*(x$_-x$x.width*x$x.scaleX):"right"==this._align&&(x$x.x=x$_-x$x.width*x$x.scaleX);this.changeSize()},x$x(0,x$s,"width",x$b.prototype._$get_width,function(x$b){this._width!=x$b&&(x$y.superSet(x$l,this,"width",x$b),this.callLater(this.changeItems))}),x$_.NONE="none",x$_.LEFT="left",x$_.CENTER="center",x$_.RIGHT="right",x$_}(x$l),x$Cb=function(x$b){function x$_(){x$_.__super.call(this)}return x$n(x$_,"laya.ui.RadioGroup",x$v),x$_.prototype.createItem=function(x$b,x$_){return new x$H(x$b,x$_)},x$_}(),x$Ob=function(x$b){function x$_(){x$_.__super.call(this)}return x$n(x$_,"laya.ui.Tab",x$v),x$_.prototype.createItem=function(x$b,x$_){return new x$U(x$b,x$_)},x$_}(),x$Lb=function(x$_){function x$s(x$b){this._vScrollBar=null,this._hScrollBar=null,void 0===x$b&&(x$b=""),x$s.__super.call(this,x$b)}x$n(x$s,"laya.ui.TextArea",x$_);var x$b=x$s.prototype;return x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},x$b.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},x$b.onVBarChanged=function(x$b){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},x$b.onHBarChanged=function(x$b){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},x$b.changeScroll=function(){var x$b=this._vScrollBar&&0<this._tf.maxScrollY,x$_=this._hScrollBar&&0<this._tf.maxScrollX,x$s=x$b?this._width-this._vScrollBar.width:this._width,x$h=x$_?this._height-this._hScrollBar.height:this._height,x$x=this._tf.padding||x$B.labelPadding;this._tf.width=x$s,this._tf.height=x$h,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-x$x[2],this._vScrollBar.y=x$x[1],this._vScrollBar.height=this._height-(x$_?this._hScrollBar.height:0)-x$x[1]-x$x[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=x$h/Math.max(this._tf.textHeight,x$h),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=x$b),this._hScrollBar&&(this._hScrollBar.x=x$x[0],this._hScrollBar.y=this._height-this._hScrollBar.height-x$x[3],this._hScrollBar.width=this._width-(x$b?this._vScrollBar.width:0)-x$x[0]-x$x[2],this._hScrollBar.scrollSize=Math.max(.033*x$s,1),this._hScrollBar.thumbPercent=x$s/Math.max(this._tf.textWidth,x$s),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=x$_)},x$b.scrollTo=function(x$b){this.commitMeasure(),this._tf.scrollY=x$b},x$x(0,x$b,"scrollY",function(){return this._tf.scrollY}),x$x(0,x$b,"width",x$_.prototype._$get_width,function(x$b){x$y.superSet(x$sb,this,"width",x$b),this.callLater(this.changeScroll)}),x$x(0,x$b,"hScrollBar",function(){return this._hScrollBar}),x$x(0,x$b,"height",x$_.prototype._$get_height,function(x$b){x$y.superSet(x$sb,this,"height",x$b),this.callLater(this.changeScroll)}),x$x(0,x$b,"maxScrollX",function(){return this._tf.maxScrollX}),x$x(0,x$b,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(x$b){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new x$_b),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=x$b}),x$x(0,x$b,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(x$b){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new x$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=x$b}),x$x(0,x$b,"vScrollBar",function(){return this._vScrollBar}),x$x(0,x$b,"maxScrollY",function(){return this._tf.maxScrollY}),x$x(0,x$b,"scrollX",function(){return this._tf.scrollX}),x$s}(x$sb);!function(x$b){function x$_(){this._uiView=null,this.isCloseOther=!1,x$_.__super.call(this)}x$n(x$_,"laya.ui.AsynDialog",x$xb);var x$s=x$_.prototype;x$s.createView=function(x$b){this._uiView=x$b},x$s._open=function(x$b,x$_,x$s){this.isModal=x$b,this.isCloseOther=x$_,x$xb.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},x$s.onCreated=function(){this.createUI(),this.onOpen()},x$s.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},x$s.onOpen=function(){x$xb.manager.open(this,this.isCloseOther),x$xb.manager.lock(!1)},x$s.close=function(x$b,x$_){void 0===x$_&&(x$_=!0),x$xb.manager.close(this),this.onClose()},x$s.onClose=function(){},x$s.destroy=function(x$b){void 0===x$b&&(x$b=!0),laya.ui.View.prototype.destroy.call(this,x$b),this._uiView=null,this.onDestroy()},x$s.onDestroy=function(){}}();x$y.__init([x$A])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}}),function(x$P,x$b,x$$){x$$.un,x$$.uns;var x$p=x$$.static,x$V=x$$.class,x$Q=x$$.getset,x$h=x$$.__newvec,x$c=laya.maths.Arith,x$E=laya.webgl.atlas.AtlasResourceManager,x$s=laya.webgl.shader.BaseShader,x$W=laya.utils.Browser,x$C=laya.webgl.utils.Buffer,x$D=laya.utils.Byte,x$x=laya.utils.ClassUtils,x$O=x$$.Config,x$n=(laya.events.Event,laya.events.EventDispatcher),x$B=laya.utils.Handler,x$i=laya.net.Loader,x$_=laya.net.LoaderManager,x$L=(laya.maths.MathUtil,laya.display.Node),x$y=laya.renders.Render,x$f=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),x$w=laya.resource.Resource,x$R=laya.utils.RunDriver,x$t=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),x$o=laya.display.Sprite,x$M=laya.utils.Stat,x$r=laya.utils.StringKey,x$S=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),x$k=laya.utils.Utils,x$Z=laya.webgl.WebGL,x$J=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;x$$.interface("laya.d3.core.IClone"),x$$.interface("laya.d3.graphics.IVertex"),x$$.interface("laya.d3.core.render.IUpdate"),x$$.interface("laya.d3.core.scene.ITreeNode"),x$$.interface("laya.d3.core.render.IRenderable");(function(){function x$U(){}x$V(x$U,"laya.d3.animation.AnimationClipParser01"),x$U.READ_DATA=function(){x$U._DATA.offset=x$U._reader.getUint32(),x$U._DATA.size=x$U._reader.getUint32()},x$U.READ_BLOCK=function(){for(var x$b=x$U._BLOCK.count=x$U._reader.getUint16(),x$_=x$U._BLOCK.blockStarts=[],x$s=x$U._BLOCK.blockLengths=[],x$h=0;x$h<x$b;x$h++)x$_.push(x$U._reader.getUint32()),x$s.push(x$U._reader.getUint32())},x$U.READ_STRINGS=function(){var x$b=x$U._reader.getUint32(),x$_=x$U._reader.getUint16(),x$s=x$U._reader.pos;x$U._reader.pos=x$b+x$U._DATA.offset;for(var x$h=0;x$h<x$_;x$h++)x$U._strings[x$h]=x$U._reader.readUTFString();x$U._reader.pos=x$s},x$U.parse=function(x$b,x$_){x$U._animationClip=x$b;(x$U._reader=x$_).__getBuffer();x$U.READ_DATA(),x$U.READ_BLOCK(),x$U.READ_STRINGS();for(var x$s=0,x$h=x$U._BLOCK.count;x$s<x$h;x$s++){var x$x=x$_.getUint16(),x$n=x$U._strings[x$x],x$E=x$U["READ_"+x$n];if(null==x$E)throw new Error("model file err,no this function:"+x$x+" "+x$n);x$E.call()}},x$U.READ_ANIMATIONS=function(){var x$b,x$_=0,x$s=0,x$h=x$U._reader,x$x=x$h.__getBuffer(),x$n=[],x$E=x$h.getUint8();for(x$n.length=x$E,x$_=0;x$_<x$E;x$_++)x$n[x$_]=x$h.getUint16();var x$C=[],x$O=x$h.getUint16();for(x$C.length=x$O,x$_=0;x$_<x$O;x$_++)x$C[x$_]=x$h.getFloat32();var x$L=x$U._animationClip;x$L.name=x$U._strings[x$h.getUint16()];var x$f=x$L._duration=x$h.getFloat32();x$L.islooping=!!x$h.getByte(),x$L._frameRate=x$h.getInt16();var x$p=x$h.getInt16(),x$P=x$L._nodes=new Array;x$P.length=x$p,(x$L._publicClipDatas=[]).length=x$p;var x$V=x$L._nodesMap={},x$Q=0,x$y=0;for(x$_=0;x$_<x$p;x$_++){x$b=x$P[x$_]=new x$F;var x$w=x$h.getUint16(),x$i=x$b.path=[];for(x$i.length=x$w,x$s=0;x$s<x$w;x$s++)x$i[x$s]=x$U._strings[x$h.getUint16()];var x$R=x$i.join("/"),x$t=x$V[x$R];x$t||(x$V[x$R]=x$t=[]),x$t.push(x$b);var x$c=x$h.getInt16();-1!==x$c&&(x$b.componentType=x$U._strings[x$c]);var x$$=x$I._propertyIndexDic[x$U._strings[x$h.getUint16()]];if(null==x$$)throw new Error("AnimationClipParser01:unknown property name.");var x$D=x$$<4,x$o=!x$D||x$D&&""===x$i[0];(x$b._cacheProperty=x$o)?x$Q++:x$y++,x$b.propertyNameID=x$$;var x$M=x$n[x$h.getUint8()];x$b.keyFrameWidth=x$M/4;var x$r=x$b.keyFrames=[],x$k=x$r.length=x$h.getUint16(),x$B=null,x$S=NaN;for(x$s=0;x$s<x$k;x$s++){var x$Z=x$r[x$s]=new x$g;x$S=x$Z.startTime=x$C[x$h.getUint16()];var x$J=x$h.pos;x$Z.inTangent=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$J=x$h.pos,x$Z.outTangent=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$J=x$h.pos,x$Z.data=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$B&&(x$B.next=x$Z,x$B.duration=x$S-x$B.startTime),x$B=x$Z}x$Z.next=null,x$Z.duration=x$f-x$S}var x$W=x$L._nodeToCachePropertyMap=new Int32Array(x$p),x$T=x$L._cachePropertyMap=new Int32Array(x$Q),x$q=x$L._unCachePropertyMap=new Int32Array(x$y);for(x$Q=x$y=0,x$_=0;x$_<x$p;x$_++)(x$b=x$P[x$_])._cacheProperty?(x$W[x$_]=x$Q,x$T[x$Q++]=x$_):x$q[x$y++]=x$_},x$U._animationClip=null,x$U._reader=null,x$U._strings=[],x$p(x$U,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function x$K(){}x$V(x$K,"laya.d3.animation.AnimationClipParser02"),x$K.READ_DATA=function(){x$K._DATA.offset=x$K._reader.getUint32(),x$K._DATA.size=x$K._reader.getUint32()},x$K.READ_BLOCK=function(){for(var x$b=x$K._BLOCK.count=x$K._reader.getUint16(),x$_=x$K._BLOCK.blockStarts=[],x$s=x$K._BLOCK.blockLengths=[],x$h=0;x$h<x$b;x$h++)x$_.push(x$K._reader.getUint32()),x$s.push(x$K._reader.getUint32())},x$K.READ_STRINGS=function(){var x$b=x$K._reader.getUint32(),x$_=x$K._reader.getUint16(),x$s=x$K._reader.pos;x$K._reader.pos=x$b+x$K._DATA.offset;for(var x$h=0;x$h<x$_;x$h++)x$K._strings[x$h]=x$K._reader.readUTFString();x$K._reader.pos=x$s},x$K.parse=function(x$b,x$_){x$K._animationClip=x$b;(x$K._reader=x$_).__getBuffer();x$K.READ_DATA(),x$K.READ_BLOCK(),x$K.READ_STRINGS();for(var x$s=0,x$h=x$K._BLOCK.count;x$s<x$h;x$s++){var x$x=x$_.getUint16(),x$n=x$K._strings[x$x],x$E=x$K["READ_"+x$n];if(null==x$E)throw new Error("model file err,no this function:"+x$x+" "+x$n);x$E.call()}},x$K.READ_ANIMATIONS=function(){var x$b,x$_=0,x$s=0,x$h=x$K._reader,x$x=x$h.__getBuffer(),x$n=[],x$E=x$h.getUint8();for(x$n.length=x$E,x$_=0;x$_<x$E;x$_++)x$n[x$_]=x$h.getUint16();var x$C=[],x$O=x$h.getUint16();for(x$C.length=x$O,x$_=0;x$_<x$O;x$_++)x$C[x$_]=x$h.getFloat32();var x$L=x$K._animationClip;x$L.name=x$K._strings[x$h.getUint16()];var x$f=x$L._duration=x$h.getFloat32();x$L.islooping=!!x$h.getByte(),x$L._frameRate=x$h.getInt16();var x$p=x$h.getInt16(),x$P=x$L._nodes=new Array;x$P.length=x$p,(x$L._publicClipDatas=[]).length=x$p;var x$V=x$L._nodesMap={},x$Q=0,x$y=0;for(x$_=0;x$_<x$p;x$_++){x$b=x$P[x$_]=new x$F;var x$w=x$h.getUint16(),x$i=x$b.path=[];for(x$i.length=x$w,x$s=0;x$s<x$w;x$s++)x$i[x$s]=x$K._strings[x$h.getUint16()];var x$R=x$i.join("/"),x$t=x$V[x$R];x$t||(x$V[x$R]=x$t=[]),x$t.push(x$b);var x$c=x$h.getInt16();-1!==x$c&&(x$b.componentType=x$K._strings[x$c]);var x$$=x$I._propertyIndexDic[x$K._strings[x$h.getUint16()]];if(null==x$$)throw new Error("AnimationClipParser02:unknown property name.");var x$D=x$$<4,x$o=!x$D||x$D&&""===x$i[0];(x$b._cacheProperty=x$o)?x$Q++:x$y++,x$b.propertyNameID=x$$;var x$M=x$n[x$h.getUint8()];x$b.keyFrameWidth=x$M/4;var x$r=x$b.keyFrames=[],x$k=x$r.length=x$h.getUint16(),x$B=null,x$S=NaN;for(x$s=0;x$s<x$k;x$s++){var x$Z=x$r[x$s]=new x$g;x$S=x$Z.startTime=x$C[x$h.getUint16()];var x$J=x$h.pos;x$Z.inTangent=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$J=x$h.pos,x$Z.outTangent=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$J=x$h.pos,x$Z.data=new Float32Array(x$x.slice(x$J,x$J+x$M)),x$h.pos+=x$M,x$B&&(x$B.next=x$Z,x$B.duration=x$S-x$B.startTime),x$B=x$Z}x$Z.next=null,x$Z.duration=x$f-x$S}var x$W=x$h.getUint16();for(x$_=0;x$_<x$W;x$_++){var x$T,x$q=new x$d;x$q.time=x$h.getFloat32(),x$q.eventName=x$K._strings[x$h.getUint16()];var x$U=x$h.getUint16();for(0<x$U&&(x$q.params=x$T=[]),x$s=0;x$s<x$U;x$s++){switch(x$h.getByte()){case 0:x$T.push(!!x$h.getByte());break;case 1:x$T.push(x$h.getInt32());break;case 2:x$T.push(x$h.getFloat32());break;case 3:x$T.push(x$K._strings[x$h.getUint16()]);break;default:throw new Error("unknown type.")}}x$L.addEvent(x$q)}var x$G=x$L._nodeToCachePropertyMap=new Int32Array(x$p),x$z=x$L._cachePropertyMap=new Int32Array(x$Q),x$a=x$L._unCachePropertyMap=new Int32Array(x$y);for(x$Q=x$y=0,x$_=0;x$_<x$p;x$_++)(x$b=x$P[x$_])._cacheProperty?(x$G[x$_]=x$Q,x$z[x$Q++]=x$_):x$a[x$y++]=x$_},x$K._animationClip=null,x$K._reader=null,x$K._strings=[],x$p(x$K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var x$d=function(){function x$b(){this.time=NaN,this.eventName=null,this.params=null}return x$V(x$b,"laya.d3.animation.AnimationEvent"),x$b}(),x$I=function(){function x$h(){this._childs=[],this.transform=new x$R_(this)}x$V(x$h,"laya.d3.animation.AnimationNode");var x$b=x$h.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.addChild=function(x$b){x$b._parent=this,x$b.transform.setParent(this.transform),this._childs.push(x$b)},x$b.removeChild=function(x$b){var x$_=this._childs.indexOf(x$b);-1!==x$_&&this._childs.splice(x$_,1)},x$b.getChildByName=function(x$b){for(var x$_=0,x$s=this._childs.length;x$_<x$s;x$_++){var x$h=this._childs[x$_];if(x$h.name===x$b)return x$h}return null},x$b.getChildByIndex=function(x$b){return this._childs[x$b]},x$b.getChildCount=function(){return this._childs.length},x$b.cloneTo=function(x$b){var x$_=x$b;x$_.name=this.name;for(var x$s=0,x$h=this._childs.length;x$s<x$h;x$s++){var x$x=this._childs[x$s],x$n=x$x.clone();x$_.addChild(x$n);var x$E=x$x.transform,x$C=x$n.transform;x$C.setLocalPosition(x$E.getLocalPosition()),x$C.setLocalRotation(x$E.getLocalRotation()),x$C.setLocalScale(x$E.getLocalScale()),x$C._localRotationEuler=x$E._localRotationEuler,x$C._setWorldMatrixIgnoreUpdate(x$E.getWorldMatrix())}},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$h.__init__=function(){x$h.registerAnimationNodeProperty("localPosition",x$h._getLocalPosition,x$h._setLocalPosition),x$h.registerAnimationNodeProperty("localRotation",x$h._getLocalRotation,x$h._setLocalRotation),x$h.registerAnimationNodeProperty("localScale",x$h._getLocalScale,x$h._setLocalScale),x$h.registerAnimationNodeProperty("localRotationEuler",x$h._getLocalRotationEuler,x$h._setLocalRotationEuler),x$h.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",x$h._getParticleRenderSharedMaterialTintColor,x$h._setParticleRenderSharedMaterialTintColor),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",x$h._getMeshRenderSharedMaterialTilingOffset,x$h._setMeshRenderSharedMaterialTilingOffset),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",x$h._getMeshRenderSharedMaterialAlbedo,x$h._setMeshRenderSharedMaterialAlbedo),x$h.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",x$h._getSkinnedMeshRenderSharedMaterialTilingOffset,x$h._setSkinnedMeshRenderSharedMaterialTilingOffset),x$h.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",x$h._getSkinnedMeshRenderSharedMaterialAlbedo,x$h._setSkinnedMeshRenderSharedMaterialAlbedo),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",x$h._getMeshRenderSharedMaterialAlbedo,x$h._setMeshRenderSharedMaterialAlbedo),x$h.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",x$h._getSkinnedMeshRenderSharedMaterialAlbedo,x$h._setSkinnedMeshRenderSharedMaterialAlbedo),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",x$h._getMeshRenderSharedMaterialIntensity,x$h._setMeshRenderSharedMaterialIntensity),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",x$h._getMeshRenderSharedMaterialAlpha,x$h._setMeshRenderSharedMaterialAlpha),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",x$h._getMeshRenderSharedMaterialAlphaColor,x$h._setMeshRenderSharedMaterialAlphaColor),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",x$h._getMeshRenderSharedMaterialBaseColor,x$h._setMeshRenderSharedMaterialBaseColor),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",x$h._getMeshRenderSharedMaterialDissolve,x$h._setMeshRenderSharedMaterialDissolve),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",x$h._getMeshRenderSharedMaterialDissolveSpeed,x$h._setMeshRenderSharedMaterialDissolveSpeed),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",x$h._getMeshRenderSharedMaterialMMultiplier,x$h._setMeshRenderSharedMaterialMMultiplier),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",x$h._getMeshRenderSharedMaterialBaseScrollSpeedX,x$h._setMeshRenderSharedMaterialBaseScrollSpeedX),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",x$h._getMeshRenderSharedMaterialBaseScrollSpeedY,x$h._setMeshRenderSharedMaterialBaseScrollSpeedY),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",x$h._getMeshRenderSharedMaterialSecondScrollSpeedX,x$h._setMeshRenderSharedMaterialSecondScrollSpeedX),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",x$h._getMeshRenderSharedMaterialSecondScrollSpeedY,x$h._setMeshRenderSharedMaterialSecondScrollSpeedY),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",x$h._getMeshRenderSharedMaterialDetailTilingOffset,x$h._setMeshRenderSharedMaterialDetailTilingOffset),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",x$h._getMeshRenderSharedMaterialDissolveTilingOffset,x$h._setMeshRenderSharedMaterialDissolveTilingOffset),x$h.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",x$h._getMeshRenderSharedMaterialMaskTilingOffset,x$h._setMeshRenderSharedMaterialMaskTilingOffset)},x$h.registerAnimationNodeProperty=function(x$b,x$_,x$s){if(x$h._propertyIndexDic[x$b])throw new Error("AnimationNode: this propertyName has registered.");x$h._propertyIndexDic[x$b]=x$h._propertyIDCounter,x$h._propertyGetFuncs[x$h._propertyIDCounter]=x$_,x$h._propertySetFuncs[x$h._propertyIDCounter]=x$s,x$h._propertyIDCounter++},x$h._getLocalPosition=function(x$b,x$_){return x$b?x$b.transform.getLocalPosition():x$_._transform.localPosition.elements},x$h._setLocalPosition=function(x$b,x$_,x$s){if(x$b)x$b.transform.setLocalPosition(x$s);else{var x$h=x$_._transform,x$x=x$h.localPosition;x$x.elements=x$s,x$h.localPosition=x$x}},x$h._getLocalRotation=function(x$b,x$_){return x$b?x$b.transform.getLocalRotation():x$_._transform.localRotation.elements},x$h._setLocalRotation=function(x$b,x$_,x$s){if(x$b)x$b.transform.setLocalRotation(x$s);else{var x$h=x$_._transform,x$x=x$h.localRotation;x$x.elements=x$s,x$h.localRotation=x$x}},x$h._getLocalScale=function(x$b,x$_){return x$b?x$b.transform.getLocalScale():x$_._transform.localScale.elements},x$h._setLocalScale=function(x$b,x$_,x$s){if(x$b)x$b.transform.setLocalScale(x$s);else{var x$h=x$_._transform,x$x=x$h.localScale;x$x.elements=x$s,x$h.localScale=x$x}},x$h._getLocalRotationEuler=function(x$b,x$_){return x$b?x$b.transform.getLocalRotationEuler():x$_._transform.localRotationEuler.elements},x$h._setLocalRotationEuler=function(x$b,x$_,x$s){if(x$b)x$b.transform.setLocalRotationEuler(x$s);else{var x$h=x$_._transform,x$x=x$h.localRotationEuler;x$x.elements=x$s,x$h.localRotationEuler=x$x}},x$h._getMeshRenderSharedMaterialTilingOffset=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return x$_.meshRender.sharedMaterial.tilingOffset.elements},x$h._setMeshRenderSharedMaterialTilingOffset=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).tilingOffset).elements=x$s,x$h.tilingOffset=x$x)}else(x$x=(x$h=x$_.meshRender.material).tilingOffset).elements=x$s,x$h.tilingOffset=x$x},x$h._getMeshRenderSharedMaterialAlbedo=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.albedoColor.elements:null}return x$_.meshRender.sharedMaterial.albedoColor.elements},x$h._setMeshRenderSharedMaterialAlbedo=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).albedoColor).elements=x$s,x$h.albedoColor=x$x)}else(x$x=(x$h=x$_.meshRender.material).albedoColor).elements=x$s,x$h.albedoColor=x$x},x$h._getSkinnedMeshRenderSharedMaterialTilingOffset=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return x$_.skinnedMeshRender.sharedMaterial.tilingOffset.elements},x$h._setSkinnedMeshRenderSharedMaterialTilingOffset=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.skinnedMeshRender.material).tilingOffset).elements=x$s,x$h.tilingOffset=x$x)}else(x$x=(x$h=x$_.skinnedMeshRender.material).tilingOffset).elements=x$s,x$h.tilingOffset=x$x},x$h._getSkinnedMeshRenderSharedMaterialAlbedo=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return x$_.skinnedMeshRender.sharedMaterial.albedoColor.elements},x$h._setSkinnedMeshRenderSharedMaterialAlbedo=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.skinnedMeshRender.material).albedoColor).elements=x$s,x$h.albedoColor=x$x)}else(x$x=(x$h=x$_.skinnedMeshRender.material).albedoColor).elements=x$s,x$h.albedoColor=x$x},x$h._getParticleRenderSharedMaterialTintColor=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.particleRender.sharedMaterial.tintColor.elements:null}return x$_.particleRender.sharedMaterial.tintColor.elements},x$h._setParticleRenderSharedMaterialTintColor=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.particleRender.material).tintColor).elements=x$s,x$h.tintColor=x$x)}else(x$x=(x$h=x$_.particleRender.material).tintColor).elements=x$s,x$h.tintColor=x$x},x$h._getMeshRenderSharedMaterialAlphaColor=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.alphaColor.elements:null}return x$_.meshRender.sharedMaterial.alphaColor.elements},x$h._setMeshRenderSharedMaterialAlphaColor=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).alphaColor).elements=x$s,x$h.alphaColor=x$x)}else(x$x=(x$h=x$_.meshRender.material).alphaColor).elements=x$s,x$h.alphaColor=x$x},x$h._getMeshRenderSharedMaterialBaseColor=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.baseColor.elements:null}return x$_.meshRender.sharedMaterial.baseColor.elements},x$h._setMeshRenderSharedMaterialBaseColor=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).baseColor).elements=x$s,x$h.baseColor=x$x)}else(x$x=(x$h=x$_.meshRender.material).baseColor).elements=x$s,x$h.baseColor=x$x},x$h._getMeshRenderSharedMaterialDissolve=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.dissolve:0}return x$_.meshRender.sharedMaterial.dissolve},x$h._setMeshRenderSharedMaterialDissolve=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.dissolve=x$s[0])}else x$_.meshRender.material.dissolve=x$s[0]},x$h._getMeshRenderSharedMaterialDissolveSpeed=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.dissolveSpeed:0}return x$_.meshRender.sharedMaterial.dissolveSpeed},x$h._setMeshRenderSharedMaterialDissolveSpeed=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.dissolveSpeed=x$s[0])}else x$_.meshRender.material.dissolveSpeed=x$s[0]},x$h._getMeshRenderSharedMaterialMMultiplier=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.mMultiplier:0}return x$_.meshRender.sharedMaterial.mMultiplier},x$h._setMeshRenderSharedMaterialMMultiplier=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.mMultiplier=x$s[0])}else x$_.meshRender.material.mMultiplier=x$s[0]},x$h._getMeshRenderSharedMaterialBaseScrollSpeedX=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return x$_.meshRender.sharedMaterial.baseScrollSpeedX},x$h._setMeshRenderSharedMaterialBaseScrollSpeedX=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.baseScrollSpeedX=x$s[0])}else x$_.meshRender.material.baseScrollSpeedX=x$s[0]},x$h._getMeshRenderSharedMaterialBaseScrollSpeedY=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return x$_.meshRender.sharedMaterial.baseScrollSpeedY},x$h._setMeshRenderSharedMaterialBaseScrollSpeedY=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.baseScrollSpeedY=x$s[0])}else x$_.meshRender.material.baseScrollSpeedY=x$s[0]},x$h._getMeshRenderSharedMaterialSecondScrollSpeedX=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return x$_.meshRender.sharedMaterial.secondScrollSpeedX},x$h._setMeshRenderSharedMaterialSecondScrollSpeedX=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.secondScrollSpeedX=x$s[0])}else x$_.meshRender.material.secondScrollSpeedX=x$s[0]},x$h._getMeshRenderSharedMaterialSecondScrollSpeedY=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return x$_.meshRender.sharedMaterial.secondScrollSpeedY},x$h._setMeshRenderSharedMaterialSecondScrollSpeedY=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.secondScrollSpeedY=x$s[0])}else x$_.meshRender.material.secondScrollSpeedY=x$s[0]},x$h._getMeshRenderSharedMaterialAlpha=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.alpha:0}return x$_.meshRender.sharedMaterial.alpha},x$h._setMeshRenderSharedMaterialAlpha=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.alpha=x$s[0])}else x$_.meshRender.material.alpha=x$s[0]},x$h._getMeshRenderSharedMaterialIntensity=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.intensity:0}return x$_.meshRender.sharedMaterial.intensity},x$h._setMeshRenderSharedMaterialIntensity=function(x$b,x$_,x$s){if(x$b){var x$h=x$b.transform._entity;x$h&&(x$h.owner.meshRender.material.intensity=x$s[0])}else x$_.meshRender.material.intensity=x$s[0]},x$h._getMeshRenderSharedMaterialDetailTilingOffset=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return x$_.meshRender.sharedMaterial.detailTilingOffset.elements},x$h._setMeshRenderSharedMaterialDetailTilingOffset=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).detailTilingOffset).elements=x$s,x$h.detailTilingOffset=x$x)}else(x$x=(x$h=x$_.meshRender.material).detailTilingOffset).elements=x$s,x$h.detailTilingOffset=x$x},x$h._getMeshRenderSharedMaterialDissolveTilingOffset=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return x$_.meshRender.sharedMaterial.dissolveTilingOffset.elements},x$h._setMeshRenderSharedMaterialDissolveTilingOffset=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).dissolveTilingOffset).elements=x$s,x$h.dissolveTilingOffset=x$x)}else(x$x=(x$h=x$_.meshRender.material).dissolveTilingOffset).elements=x$s,x$h.dissolveTilingOffset=x$x},x$h._getMeshRenderSharedMaterialMaskTilingOffset=function(x$b,x$_){if(x$b){var x$s=x$b.transform._entity;return x$s?x$s.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return x$_.meshRender.sharedMaterial.maskTilingOffset.elements},x$h._setMeshRenderSharedMaterialMaskTilingOffset=function(x$b,x$_,x$s){var x$h,x$x;if(x$b){var x$n=x$b.transform._entity;x$n&&((x$x=(x$h=x$n.owner.meshRender.material).maskTilingOffset).elements=x$s,x$h.maskTilingOffset=x$x)}else(x$x=(x$h=x$_.meshRender.material).maskTilingOffset).elements=x$s,x$h.maskTilingOffset=x$x},x$h._propertyIDCounter=0,x$h._propertyIndexDic={},x$h._propertySetFuncs=[],x$h._propertyGetFuncs=[],x$h}(),x$g=function(){function x$b(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return x$V(x$b,"laya.d3.animation.Keyframe"),x$b}(),x$F=function(){function x$b(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return x$V(x$b,"laya.d3.animation.KeyframeNode"),x$b}(),x$T=(function(){function x$b(){this._tempVector30=new x$E_,this._tempVector31=new x$E_,this._tempVector32=new x$E_,this._a=new x$E_,this._b=new x$E_,this._c=new x$E_,this._d=new x$E_}x$V(x$b,"laya.d3.core.glitter.SplineCurvePositionVelocity");var x$_=x$b.prototype;x$_.Init=function(x$b,x$_,x$s,x$h){x$b.cloneTo(this._d),x$_.cloneTo(this._c),x$E_.scale(x$b,2,this._a),x$E_.scale(x$s,2,this._tempVector30),x$E_.subtract(this._a,this._tempVector30,this._a),x$E_.add(this._a,x$_,this._a),x$E_.add(this._a,x$h,this._a),x$E_.scale(x$s,3,this._b),x$E_.scale(x$b,3,this._tempVector30),x$E_.subtract(this._b,this._tempVector30,this._b),x$E_.subtract(this._b,x$h,this._b),x$E_.scale(x$_,2,this._tempVector30),x$E_.subtract(this._b,this._tempVector30,this._b)},x$_.Slerp=function(x$b,x$_){x$E_.scale(this._a,x$b*x$b*x$b,this._tempVector30),x$E_.scale(this._b,x$b*x$b,this._tempVector31),x$E_.scale(this._c,x$b,this._tempVector32),x$E_.add(this._tempVector30,this._tempVector31,x$_),x$E_.add(x$_,this._tempVector32,x$_),x$E_.add(x$_,this._d,x$_)}}(),function(){function x$z(x$b,x$_,x$s,x$h){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=x$b,this._h=x$_,this._minHeight=x$s,this._maxHeight=x$h}x$V(x$z,"laya.d3.core.HeightMap");var x$b=x$z.prototype;x$b._inBounds=function(x$b,x$_){return 0<=x$b&&x$b<this._h&&0<=x$_&&x$_<this._w},x$b.getHeight=function(x$b,x$_){return this._inBounds(x$b,x$_)?this._datas[x$b][x$_]:NaN},x$Q(0,x$b,"width",function(){return this._w}),x$Q(0,x$b,"height",function(){return this._h}),x$Q(0,x$b,"maxHeight",function(){return this._maxHeight}),x$Q(0,x$b,"minHeight",function(){return this._minHeight}),x$z.creatFromMesh=function(x$b,x$_,x$s,x$h){for(var x$x=[],x$n=[],x$E=x$b.getSubMeshCount(),x$C=0;x$C<x$E;x$C++){for(var x$O=x$b.getSubMesh(x$C),x$L=x$O._getVertexBuffer(),x$f=x$L.getData(),x$p=[],x$P=0;x$P<x$f.length;x$P+=x$L.vertexDeclaration.vertexStride/4){var x$V=new x$E_(x$f[x$P+0],x$f[x$P+1],x$f[x$P+2]);x$p.push(x$V)}x$x.push(x$p);var x$Q=x$O._getIndexBuffer();x$n.push(x$Q.getData())}var x$y=x$b.boundingBox,x$w=x$y.min.x,x$i=x$y.min.z,x$R=x$y.max.x,x$t=x$y.max.z,x$c=x$y.min.y,x$$=x$y.max.y,x$D=x$R-x$w,x$o=x$t-x$i,x$M=x$h.elements[0]=x$D/(x$_-1),x$r=x$h.elements[1]=x$o/(x$s-1),x$k=new x$z(x$_,x$s,x$c,x$$),x$B=x$z._tempRay,x$S=x$B.direction.elements;x$S[0]=0,x$S[1]=-1,x$S[2]=0;var x$Z=x$$+.1;x$B.origin.elements[1]=x$Z;for(var x$J=0;x$J<x$s;x$J++){var x$W=x$i+x$J*x$r;x$k._datas[x$J]=[];for(var x$T=0;x$T<x$_;x$T++){var x$q=x$w+x$T*x$M,x$U=x$B.origin.elements;x$U[0]=x$q,x$U[2]=x$W;var x$G=x$z._getPosition(x$B,x$x,x$n);x$k._datas[x$J][x$T]=x$G===Number.MAX_VALUE?NaN:x$Z-x$G}}return x$k},x$z.createFromImage=function(x$b,x$_,x$s){for(var x$h=x$b.width,x$x=x$b.height,x$n=new x$z(x$h,x$x,x$_,x$s),x$E=(x$s-x$_)/254,x$C=x$b.getPixels(),x$O=0,x$L=0;x$L<x$x;x$L++)for(var x$f=x$n._datas[x$L]=[],x$p=0;x$p<x$h;x$p++){var x$P=x$C[x$O++],x$V=x$C[x$O++],x$Q=x$C[x$O++],x$y=x$C[x$O++];x$f[x$p]=255==x$P&&255==x$V&&255==x$Q&&255==x$y?NaN:(x$P+x$V+x$Q)/3*x$E+x$_}return x$n},x$z._getPosition=function(x$b,x$_,x$s){for(var x$h=Number.MAX_VALUE,x$x=0;x$x<x$_.length;x$x++)for(var x$n=x$_[x$x],x$E=x$s[x$x],x$C=0;x$C<x$E.length;x$C+=3){var x$O=x$n[x$E[x$C+0]],x$L=x$n[x$E[x$C+1]],x$f=x$n[x$E[x$C+2]],x$p=x$Q_.rayIntersectsTriangle(x$b,x$O,x$L,x$f);!isNaN(x$p)&&x$p<x$h&&(x$h=x$p)}return x$h},x$p(x$z,["_tempRay",function(){return this._tempRay=new x$x_(new x$E_,new x$E_)}])}(),function(){function x$x(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}x$V(x$x,"laya.d3.core.Layer");var x$b=x$x.prototype;return x$b._binarySearchIndex=function(){for(var x$b=0,x$_=x$x._collsionTestList.length-1,x$s=0;x$b<=x$_;){x$s=Math.floor((x$b+x$_)/2);var x$h=x$x._collsionTestList[x$s];if(x$h==this._number)return x$s;x$h>this._number?x$_=x$s-1:x$b=x$s+1}return x$b},x$b._addCollider=function(x$b){0===this._colliders.length&&x$x._collsionTestList.splice(this._binarySearchIndex(),0,this._number),x$b._isRigidbody?(this._colliders.unshift(x$b),this._nonRigidbodyOffset++):this._colliders.push(x$b)},x$b._removeCollider=function(x$b){var x$_=this._colliders.indexOf(x$b);x$_<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(x$_,1),0===this._colliders.length&&x$x._collsionTestList.splice(x$x._collsionTestList.indexOf(this._number),1)},x$Q(0,x$b,"number",function(){return this._number}),x$Q(0,x$b,"visible",function(){return this._visible},function(x$b){this._visible=x$b,x$x._visibleLayers=x$b?x$x._visibleLayers|this.mask:x$x._visibleLayers&~this.mask}),x$Q(0,x$b,"mask",function(){return this._mask}),x$Q(1,x$x,"visibleLayers",function(){return x$x._visibleLayers},function(x$b){x$x._visibleLayers=x$b;for(var x$_=0,x$s=x$x._layerList.length;x$_<x$s;x$_++){var x$h=x$x._layerList[x$_];x$h._visible=0!=(x$h._mask&x$x._visibleLayers)}}),x$x.__init__=function(){x$x._layerList.length=31;for(var x$b=0;x$b<31;x$b++){var x$_=new x$x;x$x._layerList[x$b]=x$_,0===x$b?(x$_.name="Default Layer",x$_.visible=!0):(x$_.name="Layer-"+x$b,x$_.visible=!1),x$_._number=x$b,x$_._mask=Math.pow(2,x$b)}x$x.currentCreationLayer=x$x._layerList[0]},x$x.getLayerByNumber=function(x$b){if(x$b<0||30<x$b)throw new Error("无法返回指定Layer，该number超出范围！");return x$x._layerList[x$b]},x$x.getLayerByName=function(x$b){for(var x$_=0;x$_<31;x$_++)if(x$x._layerList[x$_].name===x$b)return x$x._layerList[x$_];throw new Error("无法返回指定Layer,该name不存在")},x$x.isVisible=function(x$b){return 0!=(x$b&x$x._currentCameraCullingMask&x$x._visibleLayers)},x$x._layerList=[],x$x._visibleLayers=2147483647,x$x._collsionTestList=[],x$x._currentCameraCullingMask=2147483647,x$x.maxCount=31,x$x.currentCreationLayer=null,x$x}()),x$q=(function(){function x$b(x$b,x$_,x$s){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=x$b,this._minCount=x$_,this._maxCount=x$s}x$V(x$b,"laya.d3.core.particleShuriKen.module.Burst");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.cloneTo=function(x$b){var x$_=x$b;x$_._time=this._time,x$_._minCount=this._minCount,x$_._maxCount=this._maxCount},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"time",function(){return this._time}),x$Q(0,x$_,"minCount",function(){return this._minCount}),x$Q(0,x$_,"maxCount",function(){return this._maxCount})}(),function(){function x$b(x$b){this._color=null,this.enbale=!1,this._color=x$b}x$V(x$b,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var x$_=x$b.prototype;x$_.cloneTo=function(x$b){var x$_=x$b;this._color.cloneTo(x$_._color),x$_.enbale=this.enbale},x$_.clone=function(){var x$b;switch(this._color.type){case 0:x$b=x$G.createByConstant(this._color.constant.clone());break;case 1:x$b=x$G.createByGradient(this._color.gradient.clone());break;case 2:x$b=x$G.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:x$b=x$G.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var x$_=new this.constructor(x$b);return x$_.enbale=this.enbale,x$_},x$Q(0,x$_,"color",function(){return this._color})}(),function(){function x$b(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}x$V(x$b,"laya.d3.core.particleShuriKen.module.Emission");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),x$_._destroy=function(){this._bursts=null,this._destroyed=!0},x$_.getBurstsCount=function(){return this._bursts.length},x$_.getBurstByIndex=function(x$b){return this._bursts[x$b]},x$_.addBurst=function(x$b){var x$_=this._bursts.length;if(0<x$_)for(var x$s=0;x$s<x$_;x$s++)this._bursts[x$s].time>x$b.time&&this._bursts.splice(x$s,0,x$b);this._bursts.push(x$b)},x$_.removeBurst=function(x$b){var x$_=this._bursts.indexOf(x$b);-1!==x$_&&this._bursts.splice(x$_,1)},x$_.removeBurstByIndex=function(x$b){this._bursts.splice(x$b,1)},x$_.clearBurst=function(){this._bursts.length=0},x$_.cloneTo=function(x$b){var x$_=x$b,x$s=x$_._bursts;x$s.length=this._bursts.length;for(var x$h=0,x$x=this._bursts.length;x$h<x$x;x$h++){var x$n=x$s[x$h];x$n?this._bursts[x$h].cloneTo(x$n):x$s[x$h]=this._bursts[x$h].clone()}x$_._emissionRate=this._emissionRate,x$_.enbale=this.enbale},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"destroyed",function(){return this._destroyed}),x$Q(0,x$_,"emissionRate",function(){return this._emissionRate},function(x$b){if(x$b<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=x$b})}(),function(){function x$h(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}x$V(x$h,"laya.d3.core.particleShuriKen.module.FrameOverTime");var x$b=x$h.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,x$_._constant=this._constant,this._overTime.cloneTo(x$_._overTime),x$_._constantMin=this._constantMin,x$_._constantMax=this._constantMax,this._overTimeMin.cloneTo(x$_._overTimeMin),this._overTimeMax.cloneTo(x$_._overTimeMax)},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"frameOverTimeData",function(){return this._overTime}),x$Q(0,x$b,"constant",function(){return this._constant}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"frameOverTimeDataMin",function(){return this._overTimeMin}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"frameOverTimeDataMax",function(){return this._overTimeMax}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$h.createByConstant=function(x$b){var x$_=new x$h;return x$_._type=0,x$_._constant=x$b,x$_},x$h.createByOverTime=function(x$b){var x$_=new x$h;return x$_._type=1,x$_._overTime=x$b,x$_},x$h.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$h;return x$s._type=2,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$h.createByRandomTwoOverTime=function(x$b,x$_){var x$s=new x$h;return x$s._type=3,x$s._overTimeMin=x$b,x$s._overTimeMax=x$_,x$s},x$h}()),x$U=function(){function x$L(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}x$V(x$L,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var x$b=x$L.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,x$_._separateAxes=this._separateAxes,x$_._constant=this._constant,this._constantSeparate.cloneTo(x$_._constantSeparate),this._gradient.cloneTo(x$_._gradient),this._gradientX.cloneTo(x$_._gradientX),this._gradientY.cloneTo(x$_._gradientY),this._gradientZ.cloneTo(x$_._gradientZ),x$_._constantMin=this._constantMin,x$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(x$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(x$_._constantMaxSeparate),this._gradientMin.cloneTo(x$_._gradientMin),this._gradientMax.cloneTo(x$_._gradientMax),this._gradientXMin.cloneTo(x$_._gradientXMin),this._gradientXMax.cloneTo(x$_._gradientXMax),this._gradientYMin.cloneTo(x$_._gradientYMin),this._gradientYMax.cloneTo(x$_._gradientYMax),this._gradientZMin.cloneTo(x$_._gradientZMin),this._gradientZMax.cloneTo(x$_._gradientZMax)},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"gradientZ",function(){return this._gradientZ}),x$Q(0,x$b,"constant",function(){return this._constant}),x$Q(0,x$b,"gradient",function(){return this._gradient}),x$Q(0,x$b,"separateAxes",function(){return this._separateAxes}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"constantSeparate",function(){return this._constantSeparate}),x$Q(0,x$b,"gradientX",function(){return this._gradientX}),x$Q(0,x$b,"gradientY",function(){return this._gradientY}),x$Q(0,x$b,"gradientW",function(){return this._gradientW}),x$Q(0,x$b,"gradientMin",function(){return this._gradientMin}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"gradientMax",function(){return this._gradientMax}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$Q(0,x$b,"gradientWMin",function(){return this._gradientWMin}),x$Q(0,x$b,"constantMinSeparate",function(){return this._constantMinSeparate}),x$Q(0,x$b,"constantMaxSeparate",function(){return this._constantMaxSeparate}),x$Q(0,x$b,"gradientXMin",function(){return this._gradientXMin}),x$Q(0,x$b,"gradientXMax",function(){return this._gradientXMax}),x$Q(0,x$b,"gradientWMax",function(){return this._gradientWMax}),x$Q(0,x$b,"gradientYMin",function(){return this._gradientYMin}),x$Q(0,x$b,"gradientYMax",function(){return this._gradientYMax}),x$Q(0,x$b,"gradientZMin",function(){return this._gradientZMin}),x$Q(0,x$b,"gradientZMax",function(){return this._gradientZMax}),x$L.createByConstant=function(x$b){var x$_=new x$L;return x$_._type=0,x$_._separateAxes=!1,x$_._constant=x$b,x$_},x$L.createByConstantSeparate=function(x$b){var x$_=new x$L;return x$_._type=0,x$_._separateAxes=!0,x$_._constantSeparate=x$b,x$_},x$L.createByGradient=function(x$b){var x$_=new x$L;return x$_._type=1,x$_._separateAxes=!1,x$_._gradient=x$b,x$_},x$L.createByGradientSeparate=function(x$b,x$_,x$s,x$h){var x$x=new x$L;return x$x._type=1,x$x._separateAxes=!0,x$x._gradientX=x$b,x$x._gradientY=x$_,x$x._gradientZ=x$s,x$x._gradientW=x$h,x$x},x$L.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$L;return x$s._type=2,x$s._separateAxes=!1,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$L.createByRandomTwoConstantSeparate=function(x$b,x$_){var x$s=new x$L;return x$s._type=2,x$s._separateAxes=!0,x$s._constantMinSeparate=x$b,x$s._constantMaxSeparate=x$_,x$s},x$L.createByRandomTwoGradient=function(x$b,x$_){var x$s=new x$L;return x$s._type=3,x$s._separateAxes=!1,x$s._gradientMin=x$b,x$s._gradientMax=x$_,x$s},x$L.createByRandomTwoGradientSeparate=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){var x$O=new x$L;return x$O._type=3,x$O._separateAxes=!0,x$O._gradientXMin=x$b,x$O._gradientXMax=x$_,x$O._gradientYMin=x$s,x$O._gradientYMax=x$h,x$O._gradientZMin=x$x,x$O._gradientZMax=x$n,x$O._gradientWMin=x$E,x$O._gradientWMax=x$C,x$O},x$L}(),x$G=function(){function x$h(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}x$V(x$h,"laya.d3.core.particleShuriKen.module.GradientColor");var x$b=x$h.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,this._constant.cloneTo(x$_._constant),this._constantMin.cloneTo(x$_._constantMin),this._constantMax.cloneTo(x$_._constantMax),this._gradient.cloneTo(x$_._gradient),this._gradientMin.cloneTo(x$_._gradientMin),this._gradientMax.cloneTo(x$_._gradientMax)},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"gradient",function(){return this._gradient}),x$Q(0,x$b,"constant",function(){return this._constant}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"gradientMin",function(){return this._gradientMin}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"gradientMax",function(){return this._gradientMax}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$h.createByConstant=function(x$b){var x$_=new x$h;return x$_._type=0,x$_._constant=x$b,x$_},x$h.createByGradient=function(x$b){var x$_=new x$h;return x$_._type=1,x$_._gradient=x$b,x$_},x$h.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$h;return x$s._type=2,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$h.createByRandomTwoGradient=function(x$b,x$_){var x$s=new x$h;return x$s._type=3,x$s._gradientMin=x$b,x$s._gradientMax=x$_,x$s},x$h}(),x$z=(function(){function x$b(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}x$V(x$b,"laya.d3.core.particleShuriKen.module.GradientDataColor");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.addAlpha=function(x$b,x$_){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==x$b&&(x$b=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=x$b,this._alphaElements[this._alphaCurrentLength++]=x$_):DEBUG},x$_.addRGB=function(x$b,x$_){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==x$b&&(x$b=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=x$b,this._rgbElements[this._rgbCurrentLength++]=x$_.x,this._rgbElements[this._rgbCurrentLength++]=x$_.y,this._rgbElements[this._rgbCurrentLength++]=x$_.z):DEBUG},x$_.cloneTo=function(x$b){var x$_=x$b,x$s=0,x$h=0;x$_._alphaCurrentLength=this._alphaCurrentLength;var x$x=x$_._alphaElements;for(x$x.length=this._alphaElements.length,x$s=0,x$h=this._alphaElements.length;x$s<x$h;x$s++)x$x[x$s]=this._alphaElements[x$s];x$_._rgbCurrentLength=this._rgbCurrentLength;var x$n=x$_._rgbElements;for(x$n.length=this._rgbElements.length,x$s=0,x$h=this._rgbElements.length;x$s<x$h;x$s++)x$n[x$s]=this._rgbElements[x$s]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),x$Q(0,x$_,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function x$b(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}x$V(x$b,"laya.d3.core.particleShuriKen.module.GradientDataInt");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.add=function(x$b,x$_){this._currentLength<8?(6===this._currentLength&&1!==x$b&&(x$b=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=x$b,this._elements[this._currentLength++]=x$_):console.log("Warning:data count must lessEqual than 4")},x$_.cloneTo=function(x$b){var x$_=x$b;x$_._currentLength=this._currentLength;var x$s=x$_._elements;x$s.length=this._elements.length;for(var x$h=0,x$x=this._elements.length;x$h<x$x;x$h++)x$s[x$h]=this._elements[x$h]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function x$b(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}x$V(x$b,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.add=function(x$b,x$_){this._currentLength<8?(6===this._currentLength&&1!==x$b&&(x$b=1,DEBUG),this._elements[this._currentLength++]=x$b,this._elements[this._currentLength++]=x$_):DEBUG},x$_.getKeyByIndex=function(x$b){return this._elements[2*x$b]},x$_.getValueByIndex=function(x$b){return this._elements[2*x$b+1]},x$_.getAverageValue=function(){for(var x$b=0,x$_=this._currentLength-2;x$b<x$_;x$b+=2){this._elements[x$b+1];this._elements[x$b+3],this._elements[x$b+2]-this._elements[x$b]}return 0},x$_.cloneTo=function(x$b){var x$_=x$b;x$_._currentLength=this._currentLength;var x$s=x$_._elements;x$s.length=this._elements.length;for(var x$h=0,x$x=this._elements.length;x$h<x$x;x$h++)x$s[x$h]=this._elements[x$h]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function x$b(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}x$V(x$b,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.add=function(x$b,x$_){this._currentLength<8?(6===this._currentLength&&1!==x$b&&(x$b=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=x$b,this._elements[this._currentLength++]=x$_.x,this._elements[this._currentLength++]=x$_.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},x$_.cloneTo=function(x$b){var x$_=x$b;x$_._currentLength=this._currentLength;var x$s=x$_._elements;x$s.length=this._elements.length;for(var x$h=0,x$x=this._elements.length;x$h<x$x;x$h++)x$s[x$h]=this._elements[x$h]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"gradientCount",function(){return this._currentLength/3})}(),function(){function x$C(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}x$V(x$C,"laya.d3.core.particleShuriKen.module.GradientSize");var x$b=x$C.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.getMaxSizeInGradient=function(){var x$b=0,x$_=0,x$s=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(x$b=0,x$_=this._gradientX.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientX.getValueByIndex(x$b));for(x$b=0,x$_=this._gradientY.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientY.getValueByIndex(x$b))}else for(x$b=0,x$_=this._gradient.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradient.getValueByIndex(x$b));break;case 1:x$s=this._separateAxes?(x$s=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),x$s=Math.max(x$s,this._constantMinSeparate.y),Math.max(x$s,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(x$b=0,x$_=this._gradientXMin.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientXMin.getValueByIndex(x$b));for(x$b=0,x$_=this._gradientXMax.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientXMax.getValueByIndex(x$b));for(x$b=0,x$_=this._gradientYMin.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientYMin.getValueByIndex(x$b));for(x$b=0,x$_=this._gradientZMax.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientZMax.getValueByIndex(x$b))}else{for(x$b=0,x$_=this._gradientMin.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientMin.getValueByIndex(x$b));for(x$b=0,x$_=this._gradientMax.gradientCount;x$b<x$_;x$b++)x$s=Math.max(x$s,this._gradientMax.getValueByIndex(x$b))}}return x$s},x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,x$_._separateAxes=this._separateAxes,this._gradient.cloneTo(x$_._gradient),this._gradientX.cloneTo(x$_._gradientX),this._gradientY.cloneTo(x$_._gradientY),this._gradientZ.cloneTo(x$_._gradientZ),x$_._constantMin=this._constantMin,x$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(x$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(x$_._constantMaxSeparate),this._gradientMin.cloneTo(x$_._gradientMin),this._gradientMax.cloneTo(x$_._gradientMax),this._gradientXMin.cloneTo(x$_._gradientXMin),this._gradientXMax.cloneTo(x$_._gradientXMax),this._gradientYMin.cloneTo(x$_._gradientYMin),this._gradientYMax.cloneTo(x$_._gradientYMax),this._gradientZMin.cloneTo(x$_._gradientZMin),this._gradientZMax.cloneTo(x$_._gradientZMax)},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"gradientZ",function(){return this._gradientZ}),x$Q(0,x$b,"gradient",function(){return this._gradient}),x$Q(0,x$b,"separateAxes",function(){return this._separateAxes}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"gradientMin",function(){return this._gradientMin}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"gradientX",function(){return this._gradientX}),x$Q(0,x$b,"gradientY",function(){return this._gradientY}),x$Q(0,x$b,"gradientMax",function(){return this._gradientMax}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$Q(0,x$b,"constantMinSeparate",function(){return this._constantMinSeparate}),x$Q(0,x$b,"constantMaxSeparate",function(){return this._constantMaxSeparate}),x$Q(0,x$b,"gradientXMin",function(){return this._gradientXMin}),x$Q(0,x$b,"gradientXMax",function(){return this._gradientXMax}),x$Q(0,x$b,"gradientYMin",function(){return this._gradientYMin}),x$Q(0,x$b,"gradientYMax",function(){return this._gradientYMax}),x$Q(0,x$b,"gradientZMin",function(){return this._gradientZMin}),x$Q(0,x$b,"gradientZMax",function(){return this._gradientZMax}),x$C.createByGradient=function(x$b){var x$_=new x$C;return x$_._type=0,x$_._separateAxes=!1,x$_._gradient=x$b,x$_},x$C.createByGradientSeparate=function(x$b,x$_,x$s){var x$h=new x$C;return x$h._type=0,x$h._separateAxes=!0,x$h._gradientX=x$b,x$h._gradientY=x$_,x$h._gradientZ=x$s,x$h},x$C.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$C;return x$s._type=1,x$s._separateAxes=!1,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$C.createByRandomTwoConstantSeparate=function(x$b,x$_){var x$s=new x$C;return x$s._type=1,x$s._separateAxes=!0,x$s._constantMinSeparate=x$b,x$s._constantMaxSeparate=x$_,x$s},x$C.createByRandomTwoGradient=function(x$b,x$_){var x$s=new x$C;return x$s._type=2,x$s._separateAxes=!1,x$s._gradientMin=x$b,x$s._gradientMax=x$_,x$s},x$C.createByRandomTwoGradientSeparate=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=new x$C;return x$E._type=2,x$E._separateAxes=!0,x$E._gradientXMin=x$b,x$E._gradientXMax=x$_,x$E._gradientYMin=x$s,x$E._gradientYMax=x$h,x$E._gradientZMin=x$x,x$E._gradientZMax=x$n,x$E},x$C}()),x$a=function(){function x$C(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}x$V(x$C,"laya.d3.core.particleShuriKen.module.GradientVelocity");var x$b=x$C.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,this._constant.cloneTo(x$_._constant),this._gradientX.cloneTo(x$_._gradientX),this._gradientY.cloneTo(x$_._gradientY),this._gradientZ.cloneTo(x$_._gradientZ),this._constantMin.cloneTo(x$_._constantMin),this._constantMax.cloneTo(x$_._constantMax),this._gradientXMin.cloneTo(x$_._gradientXMin),this._gradientXMax.cloneTo(x$_._gradientXMax),this._gradientYMin.cloneTo(x$_._gradientYMin),this._gradientYMax.cloneTo(x$_._gradientYMax),this._gradientZMin.cloneTo(x$_._gradientZMin),this._gradientZMax.cloneTo(x$_._gradientZMax)},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"gradientZ",function(){return this._gradientZ}),x$Q(0,x$b,"constant",function(){return this._constant}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"gradientXMax",function(){return this._gradientXMax}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"gradientX",function(){return this._gradientX}),x$Q(0,x$b,"gradientY",function(){return this._gradientY}),x$Q(0,x$b,"gradientXMin",function(){return this._gradientXMin}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$Q(0,x$b,"gradientYMin",function(){return this._gradientYMin}),x$Q(0,x$b,"gradientYMax",function(){return this._gradientYMax}),x$Q(0,x$b,"gradientZMin",function(){return this._gradientZMin}),x$Q(0,x$b,"gradientZMax",function(){return this._gradientZMax}),x$C.createByConstant=function(x$b){var x$_=new x$C;return x$_._type=0,x$_._constant=x$b,x$_},x$C.createByGradient=function(x$b,x$_,x$s){var x$h=new x$C;return x$h._type=1,x$h._gradientX=x$b,x$h._gradientY=x$_,x$h._gradientZ=x$s,x$h},x$C.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$C;return x$s._type=2,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$C.createByRandomTwoGradient=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=new x$C;return x$E._type=3,x$E._gradientXMin=x$b,x$E._gradientXMax=x$_,x$E._gradientYMin=x$s,x$E._gradientYMax=x$h,x$E._gradientZMin=x$x,x$E._gradientZMax=x$n,x$E},x$C}(),x$K=(function(){function x$b(x$b){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=x$b}x$V(x$b,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.cloneTo=function(x$b){var x$_=x$b;this._angularVelocity.cloneTo(x$_._angularVelocity),x$_.enbale=this.enbale},x$_.clone=function(){var x$b;switch(this._angularVelocity.type){case 0:x$b=this._angularVelocity.separateAxes?x$U.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):x$U.createByConstant(this._angularVelocity.constant);break;case 1:x$b=this._angularVelocity.separateAxes?x$U.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):x$U.createByGradient(this._angularVelocity.gradient.clone());break;case 2:x$b=this._angularVelocity.separateAxes?x$U.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):x$U.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:x$b=this._angularVelocity.separateAxes?x$U.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):x$U.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var x$_=new this.constructor(x$b);return x$_.enbale=this.enbale,x$_},x$Q(0,x$_,"angularVelocity",function(){return this._angularVelocity})}(),function(){function x$b(){this.enable=!1,this.randomDirection=!1}x$V(x$b,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_._getShapeBoundBox=function(x$b){throw new Error("BaseShape: must override it.")},x$_._getSpeedBoundBox=function(x$b){throw new Error("BaseShape: must override it.")},x$_.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){throw new Error("BaseShape: must override it.")},x$_._calculateProceduralBounds=function(x$b,x$_,x$s){this._getShapeBoundBox(x$b);var x$h=x$b.min,x$x=x$b.max;x$E_.multiply(x$h,x$_,x$h),x$E_.multiply(x$x,x$_,x$x);var x$n=new x$mb(new x$E_,new x$E_);this.randomDirection?(x$n.min=new x$E_(-1,-1,-1),x$n.max=new x$E_(1,1,1)):this._getSpeedBoundBox(x$n);var x$E=new x$mb(new x$E_,new x$E_),x$C=x$E.min,x$O=x$E.max;x$E_.scale(x$n.min,x$s.y,x$C),x$E_.scale(x$n.max,x$s.y,x$O),x$E_.add(x$b.min,x$C,x$C),x$E_.add(x$b.max,x$O,x$O),x$E_.min(x$b.min,x$C,x$b.min),x$E_.max(x$b.max,x$C,x$b.max);var x$L=new x$mb(new x$E_,new x$E_),x$f=x$L.min,x$p=x$L.max;x$E_.scale(x$n.min,x$s.x,x$f),x$E_.scale(x$n.max,x$s.x,x$p),x$E_.min(x$L.min,x$p,x$C),x$E_.max(x$L.min,x$p,x$O),x$E_.min(x$b.min,x$C,x$b.min),x$E_.max(x$b.max,x$C,x$b.max)},x$_.cloneTo=function(x$b){x$b.enable=this.enable},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$b}()),x$A=function(){function x$n(){}return x$V(x$n,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),x$n._randomPointUnitArcCircle=function(x$b,x$_,x$s){var x$h=x$_.elements,x$x=NaN;x$x=x$s?x$s.getFloat()*x$b:Math.random()*x$b,x$h[0]=Math.cos(x$x),x$h[1]=Math.sin(x$x)},x$n._randomPointInsideUnitArcCircle=function(x$b,x$_,x$s){var x$h=x$_.elements;x$n._randomPointUnitArcCircle(x$b,x$_,x$s);var x$x=NaN;x$x=x$s?Math.pow(x$s.getFloat(),.5):Math.pow(Math.random(),.5),x$h[0]=x$h[0]*x$x,x$h[1]=x$h[1]*x$x},x$n._randomPointUnitCircle=function(x$b,x$_){var x$s=x$b.elements,x$h=NaN;x$h=x$_?x$_.getFloat()*Math.PI*2:Math.random()*Math.PI*2,x$s[0]=Math.cos(x$h),x$s[1]=Math.sin(x$h)},x$n._randomPointInsideUnitCircle=function(x$b,x$_){var x$s=x$b.elements;x$n._randomPointUnitCircle(x$b);var x$h=NaN;x$h=x$_?Math.pow(x$_.getFloat(),.5):Math.pow(Math.random(),.5),x$s[0]=x$s[0]*x$h,x$s[1]=x$s[1]*x$h},x$n._randomPointUnitSphere=function(x$b,x$_){var x$s=x$b.elements,x$h=NaN,x$x=NaN;x$x=x$_?(x$h=x$s[2]=2*x$_.getFloat()-1,x$_.getFloat()*Math.PI*2):(x$h=x$s[2]=2*Math.random()-1,Math.random()*Math.PI*2);var x$n=Math.sqrt(1-x$h*x$h);x$s[0]=x$n*Math.cos(x$x),x$s[1]=x$n*Math.sin(x$x)},x$n._randomPointInsideUnitSphere=function(x$b,x$_){var x$s=x$b.elements;x$n._randomPointUnitSphere(x$b);var x$h=NaN;x$h=x$_?Math.pow(x$_.getFloat(),1/3):Math.pow(Math.random(),1/3),x$s[0]=x$s[0]*x$h,x$s[1]=x$s[1]*x$h,x$s[2]=x$s[2]*x$h},x$n._randomPointInsideHalfUnitBox=function(x$b,x$_){var x$s=x$b.elements;x$_?(x$s[0]=x$_.getFloat()-.5,x$s[1]=x$_.getFloat()-.5,x$s[2]=x$_.getFloat()-.5):(x$s[0]=Math.random()-.5,x$s[1]=Math.random()-.5,x$s[2]=Math.random()-.5)},x$n}(),x$u=(function(){function x$b(x$b){this._size=null,this.enbale=!1,this._size=x$b}x$V(x$b,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.cloneTo=function(x$b){var x$_=x$b;this._size.cloneTo(x$_._size),x$_.enbale=this.enbale},x$_.clone=function(){var x$b;switch(this._size.type){case 0:x$b=this._size.separateAxes?x$z.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):x$z.createByGradient(this._size.gradient.clone());break;case 1:x$b=this._size.separateAxes?x$z.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):x$z.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:x$b=this._size.separateAxes?x$z.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):x$z.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var x$_=new this.constructor(x$b);return x$_.enbale=this.enbale,x$_},x$Q(0,x$_,"size",function(){return this._size})}(),function(){function x$h(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}x$V(x$h,"laya.d3.core.particleShuriKen.module.StartFrame");var x$b=x$h.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.cloneTo=function(x$b){var x$_=x$b;x$_._type=this._type,x$_._constant=this._constant,x$_._constantMin=this._constantMin,x$_._constantMax=this._constantMax},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$b,"constant",function(){return this._constant}),x$Q(0,x$b,"type",function(){return this._type}),x$Q(0,x$b,"constantMin",function(){return this._constantMin}),x$Q(0,x$b,"constantMax",function(){return this._constantMax}),x$h.createByConstant=function(x$b){var x$_=new x$h;return x$_._type=0,x$_._constant=x$b,x$_},x$h.createByRandomTwoConstant=function(x$b,x$_){var x$s=new x$h;return x$s._type=1,x$s._constantMin=x$b,x$s._constantMax=x$_,x$s},x$h}()),x$l=(function(){function x$b(x$b,x$_){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new x$n_(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=x$b,this._startFrame=x$_}x$V(x$b,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.cloneTo=function(x$b){var x$_=x$b;this.tiles.cloneTo(x$_.tiles),x$_.type=this.type,x$_.randomRow=this.randomRow,this._frame.cloneTo(x$_._frame),this._startFrame.cloneTo(x$_._startFrame),x$_.cycles=this.cycles,x$_.enableUVChannels=this.enableUVChannels,x$_.enable=this.enable},x$_.clone=function(){var x$b,x$_;switch(this._frame.type){case 0:x$b=x$q.createByConstant(this._frame.constant);break;case 1:x$b=x$q.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:x$b=x$q.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:x$b=x$q.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:x$_=x$u.createByConstant(this._startFrame.constant);break;case 1:x$_=x$u.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var x$s=new this.constructor(x$b,x$_);return this.tiles.cloneTo(x$s.tiles),x$s.type=this.type,x$s.randomRow=this.randomRow,x$s.cycles=this.cycles,x$s.enableUVChannels=this.enableUVChannels,x$s.enable=this.enable,x$s},x$Q(0,x$_,"frame",function(){return this._frame}),x$Q(0,x$_,"startFrame",function(){return this._startFrame})}(),function(){function x$b(x$b){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=x$b}x$V(x$b,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.cloneTo=function(x$b){var x$_=x$b;this._velocity.cloneTo(x$_._velocity),x$_.enbale=this.enbale,x$_.space=this.space},x$_.clone=function(){var x$b;switch(this._velocity.type){case 0:x$b=x$a.createByConstant(this._velocity.constant.clone());break;case 1:x$b=x$a.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:x$b=x$a.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:x$b=x$a.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var x$_=new this.constructor(x$b);return x$_.enbale=this.enbale,x$_.space=this.space,x$_},x$Q(0,x$_,"velocity",function(){return this._velocity})}(),function(){function x$b(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new x$P_,this._vb=x$K_.create(x$b._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=x$a_.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=x$G_.nameKey.getID("LINE"),this._shaderCompile=x$M_._preCompileShader[this._sharderNameID]}x$V(x$b,"laya.d3.core.PhasorSpriter3D");var x$_=x$b.prototype;return x$_.line=function(x$b,x$_,x$s,x$h){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(x$b.x,x$b.y,x$b.z,x$_.x,x$_.y,x$_.z,x$_.w),this.addVertex(x$s.x,x$s.y,x$s.z,x$h.x,x$h.y,x$h.z,x$h.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},x$_.circle=function(x$b,x$_,x$s,x$h,x$x,x$n){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*x$_,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/x$_,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*x$b,Math.cos(this._tempNumver0)*x$b,0,x$s,x$h,x$x,x$n),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},x$_.plane=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=x$h/2,this._tempNumver1=x$x/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(x$b-this._tempNumver0,x$_+this._tempNumver1,x$s,x$n,x$E,x$C,x$O),this.addVertex(x$b+this._tempNumver0,x$_+this._tempNumver1,x$s,x$n,x$E,x$C,x$O),this.addVertex(x$b-this._tempNumver0,x$_-this._tempNumver1,x$s,x$n,x$E,x$C,x$O),this.addVertex(x$b+this._tempNumver0,x$_-this._tempNumver1,x$s,x$n,x$E,x$C,x$O),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},x$_.box=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=x$h/2,this._tempNumver1=x$x/2,this._tempNumver2=x$n/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(x$b-this._tempNumver0,x$_+this._tempNumver1,x$s+this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b+this._tempNumver0,x$_+this._tempNumver1,x$s+this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b-this._tempNumver0,x$_-this._tempNumver1,x$s+this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b+this._tempNumver0,x$_-this._tempNumver1,x$s+this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b+this._tempNumver0,x$_+this._tempNumver1,x$s-this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b-this._tempNumver0,x$_+this._tempNumver1,x$s-this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b+this._tempNumver0,x$_-this._tempNumver1,x$s-this._tempNumver2,x$E,x$C,x$O,x$L),this.addVertex(x$b-this._tempNumver0,x$_-this._tempNumver1,x$s-this._tempNumver2,x$E,x$C,x$O,x$L),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},x$_.cone=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*x$s+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*x$s>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/x$s,this.addVertexIndex(0,x$_,0,x$h,x$x,x$n,x$E,this._tempUint0),this.addVertexIndex(0,0,0,x$h,x$x,x$n,x$E,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<x$s;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(x$b*this._tempNumver2,0,x$b*this._tempNumver3,x$h,x$x,x$n,x$E,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==x$s-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(x$b*this._tempNumver2,0,x$b*this._tempNumver3,x$h,x$x,x$n,x$E,this._tempUint0+(this._tempInt0+x$s)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==x$s-1?this.addIndexes(this._tempUint1+x$s+2):this.addIndexes(this._tempUint1+this._tempInt0+x$s+1),this.addIndexes(this._tempUint1+this._tempInt0+x$s),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},x$_.boundingBoxLine=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(x$b,x$x,x$n,x$E,x$C,x$O,x$L),this.addVertex(x$h,x$x,x$n,x$E,x$C,x$O,x$L),this.addVertex(x$b,x$_,x$n,x$E,x$C,x$O,x$L),this.addVertex(x$h,x$_,x$n,x$E,x$C,x$O,x$L),this.addVertex(x$h,x$x,x$s,x$E,x$C,x$O,x$L),this.addVertex(x$b,x$x,x$s,x$E,x$C,x$O,x$L),this.addVertex(x$h,x$_,x$s,x$E,x$C,x$O,x$L),this.addVertex(x$b,x$_,x$s,x$E,x$C,x$O,x$L),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},x$_.addVertex=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=x$b,this._vbData[this._posInVBData+1]=x$_,this._vbData[this._posInVBData+2]=x$s,this._vbData[this._posInVBData+3]=x$h,this._vbData[this._posInVBData+4]=x$x,this._vbData[this._posInVBData+5]=x$n,this._vbData[this._posInVBData+6]=x$E,this._posInVBData+=this._floatSizePerVer,this},x$_.addVertexIndex=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){return this._hasBegun||this.addVertexIndexException(),this._vbData[x$C]=x$b,this._vbData[x$C+1]=x$_,this._vbData[x$C+2]=x$s,this._vbData[x$C+3]=x$h,this._vbData[x$C+4]=x$x,this._vbData[x$C+5]=x$n,this._vbData[x$C+6]=x$E,(x$C+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=x$C),this},x$_.addIndexes=function(x$b){var x$_=arguments;this._hasBegun||this.addVertexIndexException();for(var x$s=0;x$s<x$_.length;x$s++)this._ibData[this._posInIBData]=x$_[x$s],this._posInIBData++;return this},x$_.begin=function(x$b,x$_){return this._hasBegun&&this.beginException0(),1!==x$b&&4!==x$b&&this.beginException1(),this._primitiveType=x$b,this._camera=x$_,this._hasBegun=!0,this},x$_.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},x$_.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(x$b._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),x$M.drawCall++,x$Z.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},x$_.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},x$_.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},x$_.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},x$_.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},x$_.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},x$_.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(28,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector4",1)])}]),x$b}()),x$N=function(){function x$b(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++x$b._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new x$P_}x$V(x$b,"laya.d3.core.render.RenderElement");var x$_=x$b.prototype;return x$_.getDynamicBatchBakedVertexs=function(x$b){for(var x$_=this._renderObj._getVertexBuffer(x$b),x$s=x$_.getData().slice(),x$h=x$_.vertexDeclaration,x$x=x$h.getVertexElementByUsage(0).offset/4,x$n=x$h.getVertexElementByUsage(3).offset/4,x$E=this._sprite3D.transform,x$C=x$E.worldMatrix,x$O=x$E.rotation,x$L=x$h.vertexStride/4,x$f=0,x$p=x$s.length;x$f<x$p;x$f+=x$L){var x$P=x$f+x$x,x$V=x$f+x$n;x$w_.transformVector3ArrayToVector3ArrayCoordinate(x$s,x$P,x$C,x$s,x$P),x$w_.transformVector3ArrayByQuat(x$s,x$V,x$O,x$s,x$V)}return x$s},x$_.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},x$_._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},x$Q(0,x$_,"id",function(){return this._id}),x$Q(0,x$_,"renderObj",function(){return this._renderObj},function(x$b){this._renderObj!==x$b&&(this._renderObj=x$b)}),x$b._uniqueIDCounter=0,x$b}(),x$X=function(){function x$_(x$b){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++x$_._uniqueIDCounter,this._needSort=!1,this._scene=x$b,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}x$V(x$_,"laya.d3.core.render.RenderQueue");var x$b=x$_.prototype;return x$b._sortOpaqueFunc=function(x$b,x$_){if(x$b._render&&x$_._render){var x$s=x$b._material.renderQueue-x$_._material.renderQueue;return 0==x$s?x$b._render._distanceForSort-x$_._render._distanceForSort:x$s}return 0},x$b._sortAlphaFunc=function(x$b,x$_){if(x$b._render&&x$_._render){var x$s=x$b._material.renderQueue-x$_._material.renderQueue;return 0==x$s?x$_._render._distanceForSort-x$b._render._distanceForSort:x$s}return 0},x$b._begainRenderElement=function(x$b,x$_,x$s){return!!x$_._beforeRender(x$b)},x$b._sortAlpha=function(x$b){x$_._cameraPosition=x$b,this._finalElements.sort(this._sortAlphaFunc)},x$b._sortOpaque=function(x$b){x$_._cameraPosition=x$b,this._finalElements.sort(this._sortOpaqueFunc)},x$b._preRender=function(x$b){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},x$b._render=function(x$b,x$_){for(var x$s,x$h,x$x,x$n,x$E,x$C,x$O=x$M.loopCount,x$L=this._scene,x$f=x$b.camera,x$p=(x$f.id,!1),x$P=0,x$V=this._finalElements.length;x$P<x$V;x$P++){var x$Q,x$y,x$w,x$i=this._finalElements[x$P];if(null!=x$i._onPreRenderFunction&&x$i._onPreRenderFunction.call(x$i._sprite3D,x$b),0===x$i._type){if(x$b.owner=x$w=x$i._sprite3D,x$b.renderElement=x$i,x$w._preRenderUpdateComponents(x$b),x$Q=x$i.renderObj,x$y=x$i._material,this._begainRenderElement(x$b,x$Q,x$y)){if(x$s=x$Q._getVertexBuffers(),!(x$x=(x$h=x$Q._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[x$h.id]){this._errorRecord[x$h.id]=1;var x$R="vertexBuffer:"+("("+x$h._destroyed+","+x$h._released+","+x$h._referenceCount+","+x$h._buffer+")")+", material:"+(x$y?x$y.__className+"("+x$y._destroyed+","+x$y._released+")":"null")+", owner:"+(x$w?x$w.__className+"("+x$w._destroyed+","+x$w._activeInHierarchy+","+x$w._displayedInStage+")":"null")+", renderObj:"+(x$Q?x$Q.__className+"("+x$Q._destroyed+","+x$Q._released+","+x$Q._referenceCount+")":"")+", parent:, url:"+(x$w?x$w.url:"")+", disposeStack:"+x$h.disposeStack;x$$.recordError("报错：unknown vertexDeclaration  "+x$R)}continue}if(x$p=(x$n=x$b._shader=x$y._getShader(x$L._shaderDefineValue,x$x.shaderDefineValue,x$w._shaderDefineValue)).bind()||x$O!==x$n._uploadLoopCount,x$s){if(x$n._uploadVertexBuffer!==x$s||x$p){for(var x$t=0;x$t<x$s.length;x$t++){var x$c=x$s[x$t];x$n.uploadAttributesX(x$c.vertexDeclaration.shaderValues.data,x$c)}x$n._uploadVertexBuffer=x$s}}else(x$n._uploadVertexBuffer!==x$h||x$p)&&(x$n.uploadAttributes(x$x.shaderValues.data,null),x$n._uploadVertexBuffer=x$h);(x$n._uploadScene!==x$L||x$p)&&(x$n.uploadSceneUniforms(x$L._shaderValues.data),x$n._uploadScene=x$L),(x$f!==x$n._uploadCamera||x$n._uploadSprite3D!==x$w||x$p)&&(x$n.uploadSpriteUniforms(x$w._shaderValues.data),x$n._uploadSprite3D=x$w),(x$f!==x$n._uploadCamera||x$p)&&(x$n.uploadCameraUniforms(x$f._shaderValues.data),x$n._uploadCamera=x$f),(x$n._uploadMaterial!==x$y||x$p)&&(x$y._upload(),x$n._uploadMaterial=x$y),x$E!==x$y?(x$y._setRenderStateBlendDepth(),x$y._setRenderStateFrontFace(x$_,x$w.transform),x$E=x$y,x$C=x$w):x$C!==x$w&&(x$y._setRenderStateFrontFace(x$_,x$w.transform),x$C=x$w),x$Q._render(x$b),x$n._uploadLoopCount=x$O}x$w._postRenderUpdateComponents(x$b)}else if(2===x$i._type){x$i.renderObj;x$b.owner=x$w=x$i._sprite3D,x$b.renderElement=x$i,x$b._batchIndexStart=x$i._tempBatchIndexStart,x$b._batchIndexEnd=x$i._tempBatchIndexEnd,x$Q=x$i.renderObj,x$y=x$i._material,this._begainRenderElement(x$b,x$Q,x$y)&&(x$x=(x$h=x$Q._getVertexBuffer(0)).vertexDeclaration,x$p=(x$n=x$b._shader=x$y._getShader(x$L._shaderDefineValue,x$x.shaderDefineValue,x$w._shaderDefineValue)).bind()||x$O!==x$n._uploadLoopCount,(x$n._uploadVertexBuffer!==x$h||x$p)&&(x$n.uploadAttributes(x$x.shaderValues.data,null),x$n._uploadVertexBuffer=x$h),(x$n._uploadScene!==x$L||x$p)&&(x$n.uploadSceneUniforms(x$L._shaderValues.data),x$n._uploadScene=x$L),(x$f!==x$n._uploadCamera||x$n._uploadSprite3D!==x$w||x$p)&&(x$n.uploadSpriteUniforms(x$w._shaderValues.data),x$n._uploadSprite3D=x$w),(x$f!==x$n._uploadCamera||x$p)&&(x$n.uploadCameraUniforms(x$f._shaderValues.data),x$n._uploadCamera=x$f),(x$n._uploadMaterial!==x$y||x$p)&&(x$y._upload(),x$n._uploadMaterial=x$y),x$E!==x$y?(x$y._setRenderStateBlendDepth(),x$y._setRenderStateFrontFace(x$_,x$w.transform),x$E=x$y,x$C=x$w):x$C!==x$w&&(x$y._setRenderStateFrontFace(x$_,x$w.transform),x$C=x$w),x$Q._render(x$b),x$n._uploadLoopCount=x$O)}}},x$b._renderShadow=function(x$b,x$_){for(var x$s,x$h,x$x,x$n,x$E,x$C=x$M.loopCount,x$O=this._scene,x$L=x$b.camera,x$f=!1,x$p=0,x$P=this._finalElements.length;x$p<x$P;x$p++){var x$V,x$Q,x$y,x$w=this._finalElements[x$p];0===x$w._type&&(x$b.owner=x$y=x$w._sprite3D,x$_||x$y._projectionViewWorldUpdateCamera===x$L&&x$y._projectionViewWorldUpdateLoopCount===x$M.loopCount||(x$y._render._renderUpdate(x$b._projectionViewMatrix),x$y._projectionViewWorldUpdateLoopCount=x$M.loopCount,x$y._projectionViewWorldUpdateCamera=x$L),x$b.renderElement=x$w,x$y._preRenderUpdateComponents(x$b),x$V=x$w.renderObj,x$Q=x$w._material,this._begainRenderElement(x$b,x$V,null)&&(x$h=(x$s=x$V._getVertexBuffer(0)).vertexDeclaration,x$f=(x$x=x$b._shader=x$Q._getShader(x$O._shaderDefineValue,x$h.shaderDefineValue,x$y._shaderDefineValue)).bind()||x$C!==x$x._uploadLoopCount,(x$x._uploadVertexBuffer!==x$s||x$f)&&(x$x.uploadAttributes(x$h.shaderValues.data,null),x$x._uploadVertexBuffer=x$s),(x$L!==x$x._uploadCamera||x$x._uploadSprite3D!==x$y||x$f)&&(x$x.uploadSpriteUniforms(x$y._shaderValues.data),x$x._uploadSprite3D=x$y),(x$L!==x$x._uploadCamera||x$f)&&(x$x.uploadCameraUniforms(x$L._shaderValues.data),x$x._uploadCamera=x$L),(x$x._uploadMaterial!==x$Q||x$f)&&(x$Q._upload(),x$x._uploadMaterial=x$Q),x$x._uploadRenderElement,x$n!==x$Q?(x$Q._setRenderStateFrontFace(!1,x$y.transform),x$n=x$Q,x$E=x$y):x$E!==x$y&&(x$Q._setRenderStateFrontFace(!1,x$y.transform),x$E=x$y),x$V._render(x$b),x$x._uploadLoopCount=x$C),x$y._postRenderUpdateComponents(x$b))}},x$b._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},x$b._addRenderElement=function(x$b){this._renderElements.push(x$b),this._needSort=!0},x$b._addDynamicBatchElement=function(x$b){this._dynamicBatchCombineRenderElements.push(x$b)},x$Q(0,x$b,"id",function(){return this._id}),x$_._uniqueIDCounter=0,x$_._cameraPosition=null,x$_}(),x$Y=function(){function x$b(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return x$V(x$b,"laya.d3.core.render.RenderState"),x$b.clientWidth=0,x$b.clientHeight=0,x$b}(),x$m=function(){function x$E(x$b,x$_){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new x$vb(new x$E_,0),this._corners=[new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_],this._boundingBoxCenter=new x$E_,this._children=x$h(8),this._objects=[],this._tempBoundBoxCorners=[new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_],this._scene=x$b,this._currentDepth=x$_}x$V(x$E,"laya.d3.core.scene.OctreeNode");var x$b=x$E.prototype;return x$$.imps(x$b,{"laya.d3.core.scene.ITreeNode":!0}),x$b.init=function(x$b,x$_){var x$s=new x$E_,x$h=new x$E_;x$E_.scale(x$_,-.5,x$s),x$E_.scale(x$_,.5,x$h),x$E_.add(x$s,x$b,x$s),x$E_.add(x$h,x$b,x$h),this.exactBox=new x$mb(x$s,x$h),this.relaxBox=new x$mb(x$s,x$h)},x$b.addTreeNode=function(x$b){1===Collision.boxContainsBox(this._relaxBox,x$b.boundingBox)?this.addNodeDown(x$b,0):this.addObject(x$b)},x$b.addChild=function(x$b){var x$_=this._children[x$b];if(null==x$_){x$_=new x$E(this._scene,this._currentDepth+1),(this._children[x$b]=x$_)._parent=this,x$E_.subtract(this._exactBox.max,this._exactBox.min,x$E.tempSize),x$E_.multiply(x$E.tempSize,x$E._octreeSplit[x$b],x$E.tempCenter),x$E_.add(this._exactBox.min,x$E.tempCenter,x$E.tempCenter),x$E_.scale(x$E.tempSize,.25,x$E.tempSize);var x$s=new x$E_,x$h=new x$E_;x$E_.subtract(x$E.tempCenter,x$E.tempSize,x$s),x$E_.add(x$E.tempCenter,x$E.tempSize,x$h),x$_.exactBox=new x$mb(x$s,x$h),x$E_.scale(x$E.tempSize,x$E.relax,x$E.tempSize);var x$x=new x$E_,x$n=new x$E_;x$E_.subtract(x$E.tempCenter,x$E.tempSize,x$x),x$E_.add(x$E.tempCenter,x$E.tempSize,x$n),x$_.relaxBox=new x$mb(x$x,x$n)}return x$_},x$b.addObject=function(x$b){(x$b._treeNode=this)._objects.push(x$b)},x$b.removeObject=function(x$b){if(x$b._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var x$_=this._objects.indexOf(x$b);return-1!==x$_&&(this._objects.splice(x$_,1),!0)},x$b.clearObject=function(){this._objects.length=0},x$b.addNodeUp=function(x$b,x$_){this._parent&&1!==Collision.boxContainsBox(this._exactBox,x$b.boundingBox)?this._parent.addNodeUp(x$b,x$_-1):this.addNodeDown(x$b,x$_)},x$b.addNodeDown=function(x$b,x$_){if(x$_<this._scene.treeLevel){var x$s=this.inChildIndex(x$b.boundingBoxCenter),x$h=this.addChild(x$s);1===Collision.boxContainsBox(x$h._relaxBox,x$b.boundingBox)?x$h.addNodeDown(x$b,++x$_):this.addObject(x$b)}else this.addObject(x$b)},x$b.inChildIndex=function(x$b){return 4*(x$b.z<this._boundingBoxCenter.z?0:1)+2*(x$b.y<this._boundingBoxCenter.y?0:1)+(x$b.x<this._boundingBoxCenter.x?0:1)},x$b.updateObject=function(x$b){1===Collision.boxContainsBox(this._relaxBox,x$b.boundingBox)?(this.removeObject(x$b),x$b._treeNode=null,this.addNodeDown(x$b,this._currentDepth)):this._parent&&(this.removeObject(x$b),x$b._treeNode=null,this._parent.addNodeUp(x$b,this._currentDepth-1))},x$b.cullingObjects=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E=0,x$C=0,x$O=0,x$L=this._scene._dynamicBatchManager;for(x$E=0,x$n=this._objects.length;x$E<x$n;x$E++){var x$f=this._objects[x$E];if(x$T.isVisible(x$f._owner.layer.mask)&&x$f.enable){if(x$_&&(x$M.treeSpriteCollision+=1,0===x$b.containsBoundSphere(x$f.boundingSphere)))continue;x$f._renderUpdate(x$x),x$f._distanceForSort=x$E_.distance(x$f.boundingSphere.center,x$h)+x$f.sortingFudge;var x$p=x$f._renderElements;for(x$C=0,x$O=x$p.length;x$C<x$O;x$C++){var x$P=x$p[x$C],x$V=x$P._staticBatch;if(x$V&&x$V._material===x$P._material)x$V._addBatchRenderElement(x$P);else{var x$Q=x$P.renderObj;x$Q.triangleCount<10&&1===x$Q._vertexBufferCount&&x$Q._getIndexBuffer()&&x$P._material.renderQueue<2&&x$P._canDynamicBatch&&!x$f._owner.isStatic?x$L._addPrepareRenderElement(x$P):this._scene.getRenderQueue(x$P._material.renderQueue)._addRenderElement(x$P)}}}}for(x$E=0;x$E<8;x$E++){var x$y=this._children[x$E];if(null!=x$y){var x$w=x$_;if(x$_){var x$i=x$b.containsBoundBox(x$y._relaxBox);if(x$M.treeNodeCollision+=1,0===x$i)continue;x$w=2===x$i}x$y.cullingObjects(x$b,x$w,x$s,x$h,x$x)}}},x$b.cullingShadowObjects=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E=0,x$C=0,x$O=0;this._scene._dynamicBatchManager;for(x$E=0,x$n=this._objects.length;x$E<x$n;x$E++){var x$L=this._objects[x$E];if(x$L.castShadow&&x$T.isVisible(x$L._owner.layer.mask)&&x$L.enable){if(x$s&&0===x$b[0].containsBoundSphere(x$L.boundingSphere))continue;for(var x$f=1,x$p=x$b.length;x$f<x$p;x$f++){var x$P=x$_[x$f-1];if(0!==x$b[x$f].containsBoundSphere(x$L.boundingSphere)){var x$V=x$L._renderElements;for(x$C=0,x$O=x$V.length;x$C<x$O;x$C++)x$P._addRenderElement(x$V[x$C])}}}}for(x$E=0;x$E<8;x$E++){var x$Q=this._children[x$E];if(null!=x$Q){var x$y=x$s;if(x$s){var x$w=x$b[0].containsBoundBox(x$Q._relaxBox);if(0===x$w)continue;x$y=2===x$w}x$Q.cullingShadowObjects(x$b,x$_,x$y,x$h,x$x)}}},x$b.cullingShadowObjectsOnePSSM=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C=x$_[0],x$O=0,x$L=0,x$f=0;for(x$O=0,x$E=this._objects.length;x$O<x$E;x$O++){var x$p=this._objects[x$O];if(x$p.castShadow&&x$T.isVisible(x$p._owner.layer.mask)&&x$p.enable){if(x$h&&0===x$b.containsBoundSphere(x$p.boundingSphere))continue;x$p._renderUpdate(x$s);var x$P=x$p._renderElements;for(x$L=0,x$f=x$P.length;x$L<x$f;x$L++)x$C._addRenderElement(x$P[x$L])}}for(x$O=0;x$O<8;x$O++){var x$V=this._children[x$O];if(null!=x$V){var x$Q=x$h;if(x$h){var x$y=x$b.containsBoundBox(x$V._relaxBox);if(0===x$y)continue;x$Q=2===x$y}x$V.cullingShadowObjectsOnePSSM(x$b,x$_,x$s,x$Q,x$x,x$n)}}},x$b.renderBoudingBox=function(x$b){this._renderBoudingBox(x$b);for(var x$_=0;x$_<8;++x$_){var x$s=this._children[x$_];x$s&&x$s.renderBoudingBox(x$b)}},x$b.buildAllChild=function(x$b){if(x$b<this._scene.treeLevel)for(var x$_=0;x$_<8;x$_++){this.addChild(x$_).buildAllChild(x$b+1)}},x$b._renderBoudingBox=function(x$b){},x$Q(0,x$b,"exactBox",function(){return this._exactBox},function(x$b){this._exactBox=x$b,x$E_.add(x$b.min,x$b.max,this._boundingBoxCenter),x$E_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),x$Q(0,x$b,"relaxBox",function(){return this._relaxBox},function(x$b){(this._relaxBox=x$b).getCorners(this._corners),x$vb.createfromPoints(this._corners,this._boundingSphere)}),x$E.debugMode=!1,x$E.relax=1.15,x$E.CHILDNUM=8,x$p(x$E,["tempVector0",function(){return this.tempVector0=new x$E_},"tempSize",function(){return this.tempSize=new x$E_},"tempCenter",function(){return this.tempCenter=new x$E_},"_octreeSplit",function(){return this._octreeSplit=[new x$E_(.25,.25,.25),new x$E_(.75,.25,.25),new x$E_(.25,.75,.25),new x$E_(.75,.75,.25),new x$E_(.25,.25,.75),new x$E_(.75,.25,.75),new x$E_(.25,.75,.75),new x$E_(.75,.75,.75)]}]),x$E}(),x$e=(function(){function x$b(){}x$V(x$b,"laya.d3.core.scene.SceneManager")}(),function(){function x$b(x$b,x$_,x$s,x$h){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===x$b&&(x$b=1),void 0===x$_&&(x$_=1),void 0===x$s&&(x$s=1),void 0===x$h&&(x$h=1),this._r=x$b,this._g=x$_,this._b=x$s,this._a=x$h}return x$V(x$b,"laya.d3.core.trail.module.Color",null,"Color$1"),x$b.prototype.cloneTo=function(x$b){x$b._r=this._r,x$b._g=this._g,x$b._b=this._b,x$b._a=this._a},x$p(x$b,["RED",function(){return this.RED=new x$b(1,0,0,1)},"GREEN",function(){return this.GREEN=new x$b(0,1,0,1)},"BLUE",function(){return this.BLUE=new x$b(0,0,1,1)},"CYAN",function(){return this.CYAN=new x$b(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new x$b(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new x$b(1,0,1,1)},"GRAY",function(){return this.GRAY=new x$b(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new x$b(1,1,1,1)},"BLACK",function(){return this.BLACK=new x$b(0,0,0,1)}]),x$b}()),x$v=(function(){function x$b(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}x$V(x$b,"laya.d3.core.trail.module.Gradient");var x$_=x$b.prototype;x$_.setKeys=function(x$b,x$_){var x$s,x$h;this._colorKeys=x$b;for(var x$x=this.index=0;x$x<x$b.length;x$x++){var x$n=(x$s=x$b[x$x]).color;this._colorKeyData[this.index++]=x$n._r,this._colorKeyData[this.index++]=x$n._g,this._colorKeyData[this.index++]=x$n._b,this._colorKeyData[this.index++]=x$s.time}this._alphaKeys=x$_;for(var x$E=this.index=0;x$E<x$_.length;x$E++)x$h=x$_[x$E],this._alphaKeyData[this.index++]=x$h.alpha,this._alphaKeyData[this.index++]=x$h.time},x$_.cloneTo=function(x$b){var x$_=0,x$s=0,x$h=this.colorKeys,x$x=[];for(x$_=0,x$s=x$h.length;x$_<x$s;x$_++){var x$n=new x$H;x$h[x$_].cloneTo(x$n),x$x.push(x$n)}var x$E=this.alphaKeys,x$C=[];for(x$_=0,x$s=x$E.length;x$_<x$s;x$_++){var x$O=new x$v;x$E[x$_].cloneTo(x$O),x$C.push(x$O)}x$b.setKeys(x$x,x$C)},x$Q(0,x$_,"mode",function(){return this._mode},function(x$b){this._mode=x$b}),x$Q(0,x$_,"colorKeys",function(){return this._colorKeys},function(x$b){this._colorKeys=x$b;for(var x$_=this.index=0;x$_<x$b.length;x$_++){var x$s=x$b[x$_],x$h=x$s.color;this._colorKeyData[this.index++]=x$h._r,this._colorKeyData[this.index++]=x$h._g,this._colorKeyData[this.index++]=x$h._b,this._colorKeyData[this.index++]=x$s.time}}),x$Q(0,x$_,"alphaKeys",function(){return this._alphaKeys},function(x$b){this._alphaKeys=x$b;for(var x$_=this.index=0;x$_<x$b.length;x$_++){var x$s=x$b[x$_];this._alphaKeyData[this.index++]=x$s.alpha,this._alphaKeyData[this.index++]=x$s.time}})}(),function(){function x$b(x$b,x$_){this._alpha=NaN,this._time=NaN,void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),this._alpha=x$b,this._time=x$_}x$V(x$b,"laya.d3.core.trail.module.GradientAlphaKey");var x$_=x$b.prototype;return x$_.cloneTo=function(x$b){x$b.alpha=this.alpha,x$b.time=this.time},x$Q(0,x$_,"alpha",function(){return this._alpha},function(x$b){this._alpha=x$b}),x$Q(0,x$_,"time",function(){return this._time},function(x$b){this._time=x$b}),x$b}()),x$H=function(){function x$b(x$b,x$_){this._color=null,this._time=NaN,void 0===x$_&&(x$_=0),this._color=x$b||new x$e,this._time=x$_}x$V(x$b,"laya.d3.core.trail.module.GradientColorKey");var x$_=x$b.prototype;return x$_.cloneTo=function(x$b){this.color.cloneTo(x$b.color),x$b.time=this.time},x$Q(0,x$_,"color",function(){return this._color},function(x$b){this._color=x$b}),x$Q(0,x$_,"time",function(){return this._time},function(x$b){this._time=x$b}),x$b}(),x$j=(function(){function x$b(){}x$V(x$b,"laya.d3.core.trail.module.GradientMode"),x$b.Blend=0,x$b.Fixed=1}(),function(){function x$b(){}x$V(x$b,"laya.d3.core.trail.module.TextureMode"),x$b.Stretch=0,x$b.Tile=1}(),function(){function x$b(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}x$V(x$b,"laya.d3.core.trail.module.TrailKeyFrame"),x$b.prototype.cloneTo=function(x$b){x$b.time=this.time,x$b.inTangent=this.inTangent,x$b.outTangent=this.outTangent,x$b.value=this.value}}(),function(){function x$_(x$b){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new x$E_,this._curPosition=new x$E_,this._delVector3=new x$E_,this._lastFixedVertexPosition=new x$E_,this._pointAtoBVector3=new x$E_,this._pointA=new x$E_,this._pointB=new x$E_,this._owner=x$b,this._id=x$_.renderElementCount++,0==this._id?x$b._owner.transform.position.cloneTo(this._lastPosition):x$b._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new x$K_(x$j.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new x$K_(x$j.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}x$V(x$_,"laya.d3.core.trail.TrailRenderElement");var x$b=x$_.prototype;x$$.imps(x$b,{"laya.d3.core.render.IRenderable":!0}),x$b._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},x$b._addTrailByFirstPosition=function(x$b,x$_){x$E_.subtract(x$_,x$b,this._delVector3),x$E_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),x$E_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),x$E_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(x$b),x$b.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},x$b._addTrailByNextPosition=function(x$b){x$E_.subtract(x$b,this._lastFixedVertexPosition,this._delVector3),x$E_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),x$E_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),x$E_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=x$E_.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=x$Hb.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(x$b),x$b.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(x$b),this._virtualVerticesCount=2)},x$b._updateVerticesByPosition=function(x$b){this._pointe=x$b.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},x$b._updateVertexBuffer2=function(){var x$b,x$_=0,x$s=0,x$h=0;for(x$h=0,x$b=(this._verticesCount+this._virtualVerticesCount)/2;x$h<x$b;x$h++)x$s=0==this._owner.textureMode?(this._VerticesToTailLength[x$h]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[x$h],this._vertices2[x$_++]=1-x$s,this._vertices2[x$_++]=1-x$s;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},x$b._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},x$b._updateDisappear=function(){var x$b,x$_=0;for(x$_=this._curDisappearIndex,x$b=(this._verticesCount+this._virtualVerticesCount)/2;x$_<x$b;x$_++)this._owner._curtime-this._everyGroupVertexBirthTime[x$_]>=this._owner.time+x$Hb.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},x$b._beforeRender=function(x$b){return this._camera=x$b.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),x$E_.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},x$b._render=function(x$b){this._isDead||(x$Z.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),x$M.drawCall++,x$M.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},x$b._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),0===x$b?this._vertexBuffer1:1===x$b?this._vertexBuffer2:null},x$b._getVertexBuffers=function(){return this._vertexBuffers},x$b._getIndexBuffer=function(){return null},x$b.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},x$b._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},x$Q(0,x$b,"_vertexBufferCount",function(){return this._vertexBuffers.length}),x$Q(0,x$b,"triangleCount",function(){return 0}),x$_.renderElementCount=0}(),function(){function x$b(){}x$V(x$b,"laya.d3.core.trail.VertexTrail");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration1}),x$Q(1,x$b,"vertexDeclaration1",function(){return x$b._vertexDeclaration1}),x$Q(1,x$b,"vertexDeclaration2",function(){return x$b._vertexDeclaration2}),x$p(x$b,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new x$nb(32,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",41),new x$Eb(24,"single",33),new x$Eb(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new x$nb(4,[new x$Eb(0,"single",38)])}]),x$b}()),x$bb=function(){function x$c(x$b){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=x$b}x$V(x$c,"laya.d3.graphics.DynamicBatch");var x$b=x$c.prototype;return x$$.imps(x$b,{"laya.d3.core.render.IRenderable":!0}),x$b._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),0===x$b?this._vertexBuffer:null},x$b._getIndexBuffer=function(){return this._indexBuffer},x$b._getCombineRenderElementFromPool=function(x$b,x$_,x$s){var x$h=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return x$h||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=x$h=new x$N,x$h._sprite3D=new x$X_),x$h._sprite3D._render._renderUpdate(x$s),x$h},x$b._getRenderElement=function(x$b,x$_,x$s){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*x$c.maxVertexCount),this._indexDatas=new Uint16Array(x$c.maxIndexCount),this._vertexBuffer=x$K_.create(this._vertexDeclaration,x$c.maxVertexCount,35048),this._indexBuffer=x$a_.create("ushort",x$c.maxIndexCount,35048));for(var x$h=this._merageElements.length=0,x$x=0,x$n=0,x$E=this._combineRenderElements.length;x$n<x$E;x$n++){var x$C=this._combineRenderElements[x$n],x$O=x$C.getDynamicBatchBakedVertexs(0),x$L=x$C.getBakedIndices(),x$f=x$C._sprite3D.transform._isFrontFaceInvert,x$p=x$h/(this._vertexDeclaration.vertexStride/4),x$P=x$x,x$V=x$P+x$L.length;x$C._tempBatchIndexStart=x$P,x$C._tempBatchIndexEnd=x$V,this._indexDatas.set(x$L,x$x);var x$Q=0;if(x$f)for(x$Q=x$P;x$Q<x$V;x$Q+=3){this._indexDatas[x$Q]=x$p+this._indexDatas[x$Q];var x$y=this._indexDatas[x$Q+1],x$w=this._indexDatas[x$Q+2];this._indexDatas[x$Q+1]=x$p+x$w,this._indexDatas[x$Q+2]=x$p+x$y}else for(x$Q=x$P;x$Q<x$V;x$Q+=3)this._indexDatas[x$Q]=x$p+this._indexDatas[x$Q],this._indexDatas[x$Q+1]=x$p+this._indexDatas[x$Q+1],this._indexDatas[x$Q+2]=x$p+this._indexDatas[x$Q+2];x$x+=x$L.length,this._vertexDatas.set(x$O,x$h),x$h+=x$O.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),x$n=this._combineRenderElementPoolIndex=0,x$E=this._materials.length;x$n<x$E;x$n++){var x$i=this._getCombineRenderElementFromPool(x$b,x$_,x$s);x$i._type=2,x$i._staticBatch=null;var x$R=(x$i.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[x$n]]._tempBatchIndexStart,x$t=x$n+1===this._materialToRenderElementsOffsets.length?x$x:this._combineRenderElements[this._materialToRenderElementsOffsets[x$n+1]]._tempBatchIndexStart;x$i._tempBatchIndexStart=x$R,x$i._tempBatchIndexEnd=x$t,x$i._material=this._materials[x$n],this._merageElements.push(x$i)}},x$b._addCombineRenderObjTest=function(x$b){var x$_=x$b.renderObj,x$s=this._currentCombineIndexCount+x$_._getIndexBuffer().indexCount,x$h=this._currentCombineVertexCount+x$_._getVertexBuffer().vertexCount;return!(x$c.maxVertexCount<x$h||x$c.maxIndexCount<x$s)},x$b._addCombineRenderObj=function(x$b){var x$_=x$b.renderObj;this._combineRenderElements.push(x$b),this._currentCombineIndexCount=this._currentCombineIndexCount+x$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+x$_._getVertexBuffer().vertexCount},x$b._addCombineMaterial=function(x$b){this._materials.push(x$b)},x$b._addMaterialToRenderElementOffset=function(x$b){this._materialToRenderElementsOffsets.push(x$b)},x$b._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},x$b._addToRenderQueue=function(x$b,x$_,x$s,x$h){this._getRenderElement(x$_,x$s,x$h);for(var x$x=0,x$n=this._materials.length;x$x<x$n;x$x++)x$b.getRenderQueue(this._materials[x$x].renderQueue)._addDynamicBatchElement(this._merageElements[x$x])},x$b._beforeRender=function(x$b){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},x$b._render=function(x$b){var x$_=x$b._batchIndexEnd-x$b._batchIndexStart;x$Z.mainContext.drawElements(4,x$_,5123,2*x$b._batchIndexStart),x$M.drawCall++,x$M.trianglesFaces+=x$_/3},x$b._getVertexBuffers=function(){return null},x$Q(0,x$b,"_vertexBufferCount",function(){return 1}),x$Q(0,x$b,"triangleCount",function(){return this._indexBuffer.indexCount/3}),x$Q(0,x$b,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),x$c.maxVertexCount=2e4,x$c.maxIndexCount=4e4,x$c.maxCombineTriangleCount=10,x$c}(),x$_b=function(){function x$c(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}x$V(x$c,"laya.d3.graphics.DynamicBatchManager");var x$b=x$c.prototype;return x$b.getDynamicBatch=function(x$b,x$_){var x$s,x$h=x$b.id.toString()+x$_;return this._dynamicBatches[x$h]?x$s=this._dynamicBatches[x$h]:this._dynamicBatches[x$h]=x$s=new x$bb(x$b),x$s},x$b._garbageCollection=function(){for(var x$b in this._dynamicBatches)0===this._dynamicBatches[x$b].combineRenderElementsCount&&delete this._dynamicBatches[x$b]},x$b._addPrepareRenderElement=function(x$b){this._prepareDynamicBatchCombineElements.push(x$b)},x$b._finishCombineDynamicBatch=function(x$b){var x$_,x$s,x$h;this._prepareDynamicBatchCombineElements.sort(x$c._sortPrepareDynamicBatch);for(var x$x,x$n,x$E,x$C,x$O,x$L=-1,x$f=!0,x$p=0,x$P=-1,x$V=0,x$Q=this._prepareDynamicBatchCombineElements.length;x$V<x$Q;x$V++){var x$y=(x$n=this._prepareDynamicBatchCombineElements[x$V]).renderObj._getVertexBuffer(0).vertexDeclaration,x$w=x$s!==x$y;x$w&&(x$p=0,x$s=x$y);var x$i=x$p!==x$L;if(x$i&&(x$L=x$p),(x$w||x$i)&&(x$E=this.getDynamicBatch(x$y,x$p),x$_=null),x$f)if(x$E._addCombineRenderObjTest(x$n)){if(x$_!==(x$x=x$n._material))x$C&&(x$b.getRenderQueue(x$O._material.renderQueue)._addRenderElement(x$O),x$O=x$C=null,x$P=-1),x$C=x$x,x$P=x$E.combineRenderElementsCount,x$O=x$n,x$_=x$x;else if(x$C){var x$R=x$O.renderObj,x$t=x$n.renderObj;x$R._getVertexBuffer().vertexCount+x$t._getVertexBuffer().vertexCount>x$bb.maxVertexCount||x$R._getIndexBuffer().indexCount+x$t._getIndexBuffer().indexCount>x$bb.maxIndexCount?(x$b.getRenderQueue(x$O._material.renderQueue)._addRenderElement(x$O),x$C=x$x,x$P=x$E.combineRenderElementsCount,x$O=x$n):(x$E._addCombineMaterial(x$C),x$E._addMaterialToRenderElementOffset(x$P),x$E._addCombineRenderObj(x$O),x$O=x$C=null,x$P=-1,x$E._addCombineRenderObj(x$n))}else x$E._addCombineRenderObj(x$n);x$f=!0}else x$C&&(x$b.getRenderQueue(x$O._material.renderQueue)._addRenderElement(x$O),x$O=x$C=null,x$P=-1),x$p++,x$f=!1;else x$h=this._prepareDynamicBatchCombineElements[x$V-1],x$E._addMaterialToRenderElementOffset(x$E.combineRenderElementsCount),x$_=x$h._material,x$E._addCombineMaterial(x$_),x$E._addCombineRenderObj(x$h),x$f=!0,x$_!==(x$x=x$n._material)?(x$C=x$x,x$P=x$E.combineRenderElementsCount,x$O=x$n):x$E._addCombineRenderObj(x$n),x$_=x$x}x$C&&(x$b.getRenderQueue(x$O._material.renderQueue)._addRenderElement(x$O),x$O=x$C=null,x$P=-1),this._prepareDynamicBatchCombineElements.length=0},x$b._clearRenderElements=function(){for(var x$b in this._dynamicBatches)this._dynamicBatches[x$b]._clearRenderElements()},x$b._addToRenderQueue=function(x$b,x$_,x$s,x$h){for(var x$x in this._dynamicBatches){var x$n=this._dynamicBatches[x$x];0<x$n.combineRenderElementsCount&&x$n._addToRenderQueue(x$b,x$_,x$s,x$h)}},x$b.dispose=function(){this._dynamicBatches=null},x$c._sortPrepareDynamicBatch=function(x$b,x$_){return x$b._mainSortID-x$_._mainSortID},x$c}(),x$sb=function(){function x$b(){}return x$V(x$b,"laya.d3.graphics.FrustumCulling"),x$b.renderShadowObjectCulling=function(x$b,x$_,x$s,x$h,x$x){var x$n=0,x$E=0,x$C=0,x$O=0;for(x$n=0,x$C=x$s.length;x$n<x$C;x$n++){var x$L=x$s[x$n];x$L&&x$L._clearRenderElements()}var x$f,x$p,x$P,x$V=x$b._cullingRenders;if(1<x$x){for(x$n=0,x$C=x$b._cullingRendersLength;x$n<x$C;x$n++)if((x$f=x$V[x$n]).castShadow&&x$T.isVisible(x$f._owner.layer.mask)&&x$f.enable)for(var x$Q=1,x$y=x$_.length;x$Q<x$y;x$Q++)if(x$p=x$s[x$Q-1],0!==x$_[x$Q].containsBoundSphere(x$f.boundingSphere))for(x$E=0,x$O=(x$P=x$f._renderElements).length;x$E<x$O;x$E++)x$p._addRenderElement(x$P[x$E])}else for(x$n=0,x$C=x$b._cullingRendersLength;x$n<x$C;x$n++)if((x$f=x$V[x$n]).castShadow&&x$T.isVisible(x$f._owner.layer.mask)&&x$f.enable&&0!==x$_[0].containsBoundSphere(x$f.boundingSphere))for(x$f._renderUpdate(x$h),x$p=x$s[0],x$E=0,x$O=(x$P=x$f._renderElements).length;x$E<x$O;x$E++)x$p._addRenderElement(x$P[x$E])},x$b.renderShadowObjectCullingOctree=function(x$b,x$_,x$s,x$h,x$x){for(var x$n=0,x$E=x$s.length;x$n<x$E;x$n++){var x$C=x$s[x$n];x$C&&x$C._clearRenderElements()}1<x$x?x$b.treeRoot.cullingShadowObjects(x$_,x$s,!0,0,x$b):x$b.treeRoot.cullingShadowObjectsOnePSSM(x$_[0],x$s,x$h,!0,0,x$b)},x$b.renderObjectCulling=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=0,x$C=0,x$O=0,x$L=0,x$f=x$_._quenes,x$p=x$_._dynamicBatchManager,x$P=x$_._cullingRenders;for(x$E=0,x$C=x$f.length;x$E<x$C;x$E++){var x$V=x$f[x$E];x$V&&x$V._clearRenderElements()}var x$Q=x$hb._staticBatchManagers;for(x$E=0,x$C=x$Q.length;x$E<x$C;x$E++)x$Q[x$E]._clearRenderElements();x$p._clearRenderElements();var x$y=x$s.transform.position;for(x$E=0,x$C=x$_._cullingRendersLength;x$E<x$C;x$E++){var x$w=x$P[x$E];if(x$T.isVisible(x$w._owner.layer.mask)&&x$w.enable&&0!==x$b.containsBoundSphere(x$w.boundingSphere)&&x$w._renderUpdate(x$n)){x$w._distanceForSort=x$E_.distance(x$w.boundingSphere.center,x$y)+x$w.sortingFudge;var x$i=x$w._renderElements;for(x$O=0,x$L=x$i.length;x$O<x$L;x$O++){var x$R=x$i[x$O],x$t=x$R._staticBatch;if(x$t&&x$t._material===x$R._material)x$t._addBatchRenderElement(x$R);else{var x$c=x$R.renderObj;x$c.triangleCount<10&&1===x$c._vertexBufferCount&&x$c._getIndexBuffer()&&x$R._material.renderQueue<2&&x$R._canDynamicBatch&&!x$w._owner.isStatic?x$p._addPrepareRenderElement(x$R):x$_.getRenderQueue(x$R._material.renderQueue)._addRenderElement(x$R)}}}}for(x$E=0,x$C=x$Q.length;x$E<x$C;x$E++)x$Q[x$E]._addToRenderQueue(x$_,x$h,x$x,x$n);x$p._finishCombineDynamicBatch(x$_),x$p._addToRenderQueue(x$_,x$h,x$x,x$n)},x$b.renderObjectCullingOctree=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=0,x$C=0,x$O=x$_._quenes,x$L=x$_._dynamicBatchManager;for(x$E=0,x$C=x$O.length;x$E<x$C;x$E++){var x$f=x$O[x$E];x$f&&x$f._clearRenderElements()}var x$p=x$hb._staticBatchManagers;for(x$E=0,x$C=x$p.length;x$E<x$C;x$E++)x$p[x$E]._clearRenderElements();for(x$L._clearRenderElements(),x$_._cullingRenders.length=0,x$_.treeRoot.cullingObjects(x$b,!0,0,x$s.transform.position,x$n),x$E=0,x$C=x$p.length;x$E<x$C;x$E++)x$p[x$E]._addToRenderQueue(x$_,x$h,x$x,x$n);x$L._finishCombineDynamicBatch(x$_),x$L._addToRenderQueue(x$_,x$h,x$x,x$n)},x$b.renderObjectCullingNoBoundFrustum=function(x$b,x$_,x$s,x$h,x$x){var x$n=0,x$E=0,x$C=0,x$O=0,x$L=x$b._quenes,x$f=x$b._dynamicBatchManager,x$p=x$b._cullingRenders;for(x$n=0,x$E=x$L.length;x$n<x$E;x$n++){var x$P=x$L[x$n];x$P&&x$P._clearRenderElements()}var x$V=x$hb._staticBatchManagers;for(x$n=0,x$E=x$V.length;x$n<x$E;x$n++)x$V[x$n]._clearRenderElements();x$f._clearRenderElements();var x$Q=x$_.transform.position;for(x$n=0,x$E=x$b._cullingRendersLength;x$n<x$E;x$n++){var x$y=x$p[x$n];if(x$T.isVisible(x$y._owner.layer.mask)&&x$y.enable){x$y._renderUpdate(x$x),x$y._distanceForSort=x$E_.distance(x$y.boundingSphere.center,x$Q)+x$y.sortingFudge;var x$w=x$y._renderElements;for(x$C=0,x$O=x$w.length;x$C<x$O;x$C++){var x$i=x$w[x$C],x$R=x$i._staticBatch;if(x$R&&x$R._material===x$i._material)x$R._addBatchRenderElement(x$i);else{var x$t=x$i.renderObj;x$t.triangleCount<10&&1===x$t._vertexBufferCount&&x$t._getIndexBuffer()&&x$i._material.renderQueue<2&&x$i._canDynamicBatch&&!x$y._owner.isStatic?x$f._addPrepareRenderElement(x$i):x$b.getRenderQueue(x$i._material.renderQueue)._addRenderElement(x$i)}}}}for(x$n=0,x$E=x$V.length;x$n<x$E;x$n++)x$V[x$n]._addToRenderQueue(x$b,x$s,x$h,x$x);x$f._finishCombineDynamicBatch(x$b),x$f._addToRenderQueue(x$b,x$s,x$h,x$x)},x$b}(),x$hb=function(){function x$n(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}x$V(x$n,"laya.d3.graphics.StaticBatchManager");var x$b=x$n.prototype;return x$b._finishInit=function(){for(var x$b in this._staticBatches)this._staticBatches[x$b]._finishInit();this._initBatchRenderElements.length=0},x$b._initStaticBatchs=function(x$b){throw new Error("StaticBatchManager:must override this function.")},x$b._addInitBatchSprite=function(x$b){for(var x$_=x$b._render._renderElements,x$s=0,x$h=x$_.length;x$s<x$h;x$s++)this._initBatchRenderElements.push(x$_[x$s])},x$b._clearRenderElements=function(){for(var x$b in this._staticBatches)this._staticBatches[x$b]._clearRenderElements()},x$b._garbageCollection=function(x$b){var x$_=x$b._staticBatch,x$s=x$_._initBatchRenderElements,x$h=x$s.indexOf(x$b);x$s.splice(x$h,1),0===x$s.length&&(x$_.dispose(),delete this._staticBatches[x$_._key])},x$b._addToRenderQueue=function(x$b,x$_,x$s,x$h){for(var x$x in this._staticBatches){var x$n=this._staticBatches[x$x];0<x$n._batchRenderElements.length&&x$n._updateToRenderQueue(x$b,x$h)}},x$b.dispose=function(){this._staticBatches=null},x$n._addToStaticBatchQueue=function(x$b){x$b instanceof laya.d3.core.RenderableSprite3D&&x$b._addToInitStaticBatchManager();for(var x$_=0,x$s=x$b.numChildren;x$_<x$s;x$_++)x$n._addToStaticBatchQueue(x$b._childs[x$_])},x$n.combine=function(x$b,x$_){var x$s,x$h=0,x$x=0;if(x$_)for(x$h=0,x$x=x$_.length;x$h<x$x;x$h++){x$_[x$h]._addToInitStaticBatchManager()}else x$b&&x$n._addToStaticBatchQueue(x$b);for(x$h=0,x$x=x$n._staticBatchManagers.length;x$h<x$x;x$h++)(x$s=x$n._staticBatchManagers[x$h])._initStaticBatchs(x$b),x$s._finishInit()},x$n._staticBatchManagers=[],x$n}(),x$xb=function(){function x$b(x$b,x$_,x$s){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=x$b,this._manager=x$_,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=x$s}x$V(x$b,"laya.d3.graphics.StaticBatch");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),x$_._binarySearch=function(x$b){for(var x$_=0,x$s=this._batchRenderElements.length-1,x$h=0;x$_<=x$s;)x$h=Math.floor((x$_+x$s)/2),this._compareBatchRenderElement(this._batchRenderElements[x$h],x$b)?x$s=x$h-1:x$_=x$h+1;return x$_},x$_._compareBatchRenderElement=function(x$b,x$_){throw new Error("StaticBatch:must override this function.")},x$_._getVertexDecLightMap=function(x$b){return x$b===x$ab.vertexDeclaration?x$Tb.vertexDeclaration:x$b===x$zb.vertexDeclaration?x$Wb.vertexDeclaration:x$b===x$rb.vertexDeclaration?x$cb.vertexDeclaration:x$b===x$gb.vertexDeclaration?null:x$b===x$yb.vertexDeclaration?x$wb.vertexDeclaration:x$b===x$db.vertexDeclaration?x$Ub.vertexDeclaration:x$b===x$Zb.vertexDeclaration?x$Jb.vertexDeclaration:x$b===x$Kb.vertexDeclaration?x$qb.vertexDeclaration:x$b===x$zb.vertexDeclaration?x$Wb.vertexDeclaration:x$b===x$kb.vertexDeclaration?x$$b.vertexDeclaration:x$b===x$gb.vertexDeclaration?null:x$b===x$yb.vertexDeclaration?x$wb.vertexDeclaration:x$b===x$Ib.vertexDeclaration?x$Gb.vertexDeclaration:x$b===x$Zb.vertexDeclaration?x$Jb.vertexDeclaration:x$b},x$_._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},x$_._addBatchRenderElement=function(x$b){this._batchRenderElements.splice(this._binarySearch(x$b),0,x$b)},x$_._updateToRenderQueue=function(x$b,x$_){this._combineRenderElementPoolIndex=0,this._getRenderElement(x$b.getRenderQueue(this._material.renderQueue)._renderElements,x$b,x$_)},x$_._getRenderElement=function(x$b,x$_,x$s){throw new Error("StaticBatch:must override this function.")},x$_._finishInit=function(){throw new Error("StaticBatch:must override this function.")},x$_._clearRenderElements=function(){this._batchRenderElements.length=0},x$_.dispose=function(){},x$_._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),null},x$_._getIndexBuffer=function(){return null},x$_._beforeRender=function(x$b){return!0},x$_._render=function(x$b){},x$_._getVertexBuffers=function(){return null},x$Q(0,x$_,"_vertexBufferCount",function(){return 1}),x$Q(0,x$_,"triangleCount",function(){return 0}),x$b.combine=function(x$b){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),x$hb.combine(x$b)},x$b.maxBatchVertexCount=65535,x$b}(),x$nb=function(){function x$E(x$b,x$_){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++x$E._uniqueIDCounter,this._id>x$E.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",x$E.maxVertexDeclaration);this._shaderValues=new x$P_,this._vertexElementsDic={},this._vertexStride=x$b,this._vertexElements=x$_;for(var x$s=0;x$s<x$_.length;x$s++){var x$h=x$_[x$s],x$x=x$h.elementUsage;this._vertexElementsDic[x$x]=x$h;var x$n=[x$E._getTypeSize(x$h.elementFormat)/4,5126,!1,this._vertexStride,x$h.offset];switch(this._shaderValues.setValue(x$x,x$n),x$x){case 1:this._addShaderDefine(x$M_.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(x$M_.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(x$M_.SHADERDEFINE_UV1)}}}x$V(x$E,"laya.d3.graphics.VertexDeclaration");var x$b=x$E.prototype;return x$b._addShaderDefine=function(x$b){this._shaderDefineValue|=x$b},x$b._removeShaderDefine=function(x$b){this._shaderDefineValue&=~x$b},x$b.getVertexElements=function(){return this._vertexElements.slice()},x$b.getVertexElementByUsage=function(x$b){return this._vertexElementsDic[x$b]},x$b.unBinding=function(){},x$Q(0,x$b,"shaderDefineValue",function(){return this._shaderDefineValue}),x$Q(0,x$b,"id",function(){return this._id}),x$Q(0,x$b,"vertexStride",function(){return this._vertexStride}),x$Q(0,x$b,"shaderValues",function(){return this._shaderValues}),x$E._getTypeSize=function(x$b){switch(x$b){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},x$E.getVertexStride=function(x$b){for(var x$_=0,x$s=0;x$s<x$b.Length;x$s++){var x$h=x$b[x$s],x$x=x$h.offset+x$E._getTypeSize(x$h.elementFormat);x$_<x$x&&(x$_=x$x)}return x$_},x$E._maxVertexDeclarationBit=1e3,x$E._uniqueIDCounter=1,x$p(x$E,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),x$E}(),x$Eb=function(){function x$b(x$b,x$_,x$s){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=x$b,this.elementFormat=x$_,this.elementUsage=x$s}return x$V(x$b,"laya.d3.graphics.VertexElement"),x$b}(),x$Cb=(function(){function x$b(){}x$V(x$b,"laya.d3.graphics.VertexElementFormat"),x$b.Single="single",x$b.Vector2="vector2",x$b.Vector3="vector3",x$b.Vector4="vector4",x$b.Color="color",x$b.Byte4="byte4",x$b.Short2="short2",x$b.Short4="short4",x$b.NormalizedShort2="normalizedshort2",x$b.NormalizedShort4="normalizedshort4",x$b.HalfVector2="halfvector2",x$b.HalfVector4="halfvector4"}(),function(){function x$b(){}x$V(x$b,"laya.d3.graphics.VertexElementUsage"),x$b.POSITION0=0,x$b.COLOR0=1,x$b.TEXTURECOORDINATE0=2,x$b.NORMAL0=3,x$b.BINORMAL0=4,x$b.TANGENT0=5,x$b.BLENDINDICES0=6,x$b.BLENDWEIGHT0=7,x$b.DEPTH0=8,x$b.FOG0=9,x$b.POINTSIZE0=10,x$b.SAMPLE0=11,x$b.TESSELLATEFACTOR0=12,x$b.COLOR1=13,x$b.NEXTTEXTURECOORDINATE0=14,x$b.TEXTURECOORDINATE1=15,x$b.NEXTTEXTURECOORDINATE1=16,x$b.CORNERTEXTURECOORDINATE0=17,x$b.VELOCITY0=18,x$b.STARTCOLOR0=19,x$b.STARTSIZE=20,x$b.AGEADDSCALE0=21,x$b.STARTROTATION=22,x$b.ENDCOLOR0=23,x$b.STARTLIFETIME=24,x$b.TIME0=33,x$b.SHAPEPOSITIONSTARTLIFETIME=30,x$b.DIRECTIONTIME=32,x$b.SIZEROTATION0=27,x$b.RADIUS0=28,x$b.RADIAN0=29,x$b.STARTSPEED=31,x$b.RANDOM0=34,x$b.RANDOM1=35,x$b.SIMULATIONWORLDPOSTION=36,x$b.SIMULATIONWORLDROTATION=37,x$b.TEXTURECOORDINATE0X=38,x$b.TEXTURECOORDINATE0X1=39,x$b.TEXTURECOORDINATE0Y=40,x$b.OFFSETVECTOR=41}(),function(){function x$b(x$b,x$_,x$s){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=x$b,this._textureCoordinate0=x$_,this._time=x$s}x$V(x$b,"laya.d3.graphics.VertexGlitter");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate0}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"time",function(){return this._time}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(24,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector2",2),new x$Eb(20,"single",33)])}])}(),function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=x$b,this._position=x$_,this._velocity=x$s,this._startColor=x$h,this._endColor=x$x,this._sizeRotation=x$n,this._radius=x$E,this._radian=x$C,this._ageAddScale=x$O,this._time=x$L}x$V(x$b,"laya.d3.graphics.VertexParticle");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"endColor",function(){return this._endColor}),x$Q(0,x$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),x$Q(0,x$_,"sizeRotation",function(){return this._sizeRotation}),x$Q(0,x$_,"velocity",function(){return this._velocity}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"startColor",function(){return this._startColor}),x$Q(0,x$_,"radius",function(){return this._radius}),x$Q(0,x$_,"radian",function(){return this._radian}),x$Q(0,x$_,"ageAddScale",function(){return this._ageAddScale}),x$Q(0,x$_,"time",function(){return this._time}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(116,[new x$Eb(0,"vector4",17),new x$Eb(16,"vector3",0),new x$Eb(28,"vector3",18),new x$Eb(40,"vector4",19),new x$Eb(56,"vector4",23),new x$Eb(72,"vector3",27),new x$Eb(84,"vector2",28),new x$Eb(92,"vector4",29),new x$Eb(108,"single",24),new x$Eb(112,"single",33)])}])}(),function(){function x$b(x$b){this._position=null,this._position=x$b}x$V(x$b,"laya.d3.graphics.VertexPosition");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(12,[new x$Eb(0,"vector3",0)])}]),x$b}()),x$Ob=function(){function x$b(x$b,x$_){this._position=null,this._normal=null,this._position=x$b,this._normal=x$_}x$V(x$b,"laya.d3.graphics.VertexPositionNormal");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(24,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3)])}]),x$b}(),x$Lb=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._color=null,this._position=x$b,this._normal=x$_,this._color=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColor");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(40,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1)])}]),x$b}(),x$fb=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._blendIndex=x$h,this._blendWeight=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorSkin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(72,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6)])}]),x$b}(),x$pb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._tangent=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(88,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6),new x$Eb(72,"vector4",5)])}]),x$b}(),x$Pb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._tangent=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(84,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6),new x$Eb(72,"vector3",5)])}]),x$b}(),x$Vb=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._tangent=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(56,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector4",5)])}]),x$b}(),x$Qb=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._tangent=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(52,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector3",5)])}]),x$b}(),x$yb=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(48,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2)])}]),x$b}(),x$wb=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(56,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15)])}]),x$b}(),x$ib=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._blendIndex=x$n,this._blendWeight=x$E}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(88,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15),new x$Eb(56,"vector4",7),new x$Eb(72,"vector4",6)])}]),x$b}(),x$Rb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._tangent=x$n,this._blendIndex=x$E,this._blendWeight=x$C}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(104,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15),new x$Eb(56,"vector4",7),new x$Eb(72,"vector4",6),new x$Eb(88,"vector4",5)])}]),x$b}(),x$tb=function(){function x$b(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$_.VertexPositionNormalColorTexture0SkinTangent=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._tangent=x$n,this._blendIndex=x$E,this._blendWeight=x$C},x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(100,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15),new x$Eb(56,"vector4",7),new x$Eb(72,"vector4",6),new x$Eb(88,"vector3",5)])}]),x$b}(),x$cb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._tangent=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(72,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15),new x$Eb(56,"vector4",5)])}]),x$b}(),x$$b=function(){function x$b(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$_.VertexPositionNormalColorTexture0Tangent=function(x$b,x$_,x$s,x$h,x$x,x$n){this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._tangent=x$n},x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(68,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector2",15),new x$Eb(56,"vector3",5)])}]),x$b}(),x$Db=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(80,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector4",7),new x$Eb(64,"vector4",6)])}]),x$b}(),x$ob=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h,this._tangent=x$x,this._blendIndex=x$n,this._blendWeight=x$E}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(96,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector4",7),new x$Eb(64,"vector4",6),new x$Eb(80,"vector4",5)])}]),x$b}(),x$Mb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h,this._tangent=x$x,this._blendIndex=x$n,this._blendWeight=x$E}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(92,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector4",7),new x$Eb(64,"vector4",6),new x$Eb(80,"vector3",5)])}]),x$b}(),x$rb=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h,this._tangent=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(64,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector4",5)])}]),x$b}(),x$kb=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._color=x$s,this._textureCoordinate=x$h,this._tangent=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"color",function(){return this._color}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(60,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",1),new x$Eb(40,"vector2",2),new x$Eb(48,"vector3",5)])}]),x$b}(),x$Bb=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._tangent=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNormalSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(40,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector4",5)])}]),x$b}(),x$Sb=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._tangent=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(36,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector3",5)])}]),x$b}(),x$Zb=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(32,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2)])}]),x$b}(),x$Jb=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(40,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15)])}]),x$b}(),x$Wb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(72,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6)])}]),x$b}(),x$Tb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h,this._tangent=x$x,this._blendIndex=x$n,this._blendWeight=x$E}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(88,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6),new x$Eb(72,"vector4",5)])}]),x$b}(),x$qb=function(){function x$b(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$_.VertexPositionNormalTexture0SkinTangent=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h,this._tangent=x$x,this._blendIndex=x$n,this._blendWeight=x$E},x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(84,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15),new x$Eb(40,"vector4",7),new x$Eb(56,"vector4",6),new x$Eb(72,"vector3",5)])}]),x$b}(),x$Ub=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h,this._tangent=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(56,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15),new x$Eb(40,"vector4",5)])}]),x$b}(),x$Gb=function(){function x$b(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$_.VertexPositionNormalTexture0Tangent=function(x$b,x$_,x$s,x$h,x$x){this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$s,this._textureCoordinate1=x$h,this._tangent=x$x},x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(52,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15),new x$Eb(40,"vector3",5)])}]),x$b}(),x$zb=function(){function x$b(x$b,x$_,x$s,x$h,x$x){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s,this._blendIndex=x$h,this._blendWeight=x$x}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTextureSkin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(64,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector4",7),new x$Eb(48,"vector4",6)])}]),x$b}(),x$ab=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s,this._tangent=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(80,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector4",7),new x$Eb(48,"vector4",6),new x$Eb(64,"vector4",5)])}]),x$b}(),x$Kb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s,this._tangent=x$h,this._blendIndex=x$x,this._blendWeight=x$n}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(76,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector4",7),new x$Eb(48,"vector4",6),new x$Eb(64,"vector3",5)])}]),x$b}(),x$db=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s,this._tangent=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(48,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector4",5)])}]),x$b}(),x$Ib=function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s,this._tangent=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionNormalTextureTangent");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(44,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector3",5)])}]),x$b}(),x$gb=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNTBTexture");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(56,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector3",5),new x$Eb(36,"vector3",4),new x$Eb(48,"vector2",2)])}]),x$b}(),x$Fb=function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=x$b,this._normal=x$_,this._textureCoordinate0=x$h,this._textureCoordinate1=x$x,this._tangent=x$n,x$s=x$s,this._blendIndex=x$E,this._blendWeight=x$C}x$V(x$b,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"tangent",function(){return this._tangent}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(0,x$_,"textureCoordinate1",function(){return this._textureCoordinate1}),x$Q(0,x$_,"blendIndex",function(){return this._blendIndex}),x$Q(0,x$_,"blendWeight",function(){return this._blendWeight}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(96,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector3",5),new x$Eb(36,"vector3",4),new x$Eb(48,"vector2",2),new x$Eb(56,"vector2",15),new x$Eb(64,"vector4",7),new x$Eb(80,"vector4",6)])}]),x$b}(),x$Ab=function(){function x$b(x$b,x$_,x$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=x$b,this._normal=x$_,this._textureCoordinate=x$s}x$V(x$b,"laya.d3.graphics.VertexPositionNTBTextureSkin");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"textureCoordinate",function(){return this._textureCoordinate}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(88,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector3",5),new x$Eb(36,"vector3",4),new x$Eb(48,"vector2",2),new x$Eb(56,"vector4",7),new x$Eb(72,"vector4",6)])}]),x$b}(),x$ub=(function(){function x$b(x$b,x$_,x$s,x$h){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=x$b,this._normal=x$_,this._textureCoord0=x$s,this._textureCoord1=x$h}x$V(x$b,"laya.d3.graphics.VertexPositionTerrain");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"normal",function(){return this._normal}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoord0",function(){return this._textureCoord0}),x$Q(0,x$_,"textureCoord1",function(){return this._textureCoord1}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(40,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector3",3),new x$Eb(24,"vector2",2),new x$Eb(32,"vector2",15)])}])}(),function(){function x$b(x$b,x$_){this._position=null,this._textureCoordinate0=null,this._position=x$b,this._textureCoordinate0=x$_}x$V(x$b,"laya.d3.graphics.VertexPositionTexture0");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"position",function(){return this._position}),x$Q(0,x$_,"textureCoordinate0",function(){return this._textureCoordinate0}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(20,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector2",2)])}]),x$b}()),x$lb=(function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P,x$V){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=x$b,this._positionStartLifeTime=x$_,this._velocity=x$s,this._startColor=x$h,this._startSize=x$x,this._startRotation0=x$n,this._startRotation1=x$E,this._startRotation2=x$C,this._startLifeTime=x$O,this._time=x$L,this._startSpeed=x$f,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=x$V}x$V(x$b,"laya.d3.graphics.VertexShurikenParticleBillboard");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),x$Q(0,x$_,"random1",function(){return this._randoms1}),x$Q(0,x$_,"startRotation2",function(){return this._startRotation2}),x$Q(0,x$_,"positionStartLifeTime",function(){return this._positionStartLifeTime}),x$Q(0,x$_,"velocity",function(){return this._velocity}),x$Q(0,x$_,"random0",function(){return this._randoms0}),x$Q(0,x$_,"startSize",function(){return this._startSize}),x$Q(0,x$_,"startColor",function(){return this._startColor}),x$Q(0,x$_,"startRotation0",function(){return this._startRotation0}),x$Q(0,x$_,"startRotation1",function(){return this._startRotation1}),x$Q(0,x$_,"startLifeTime",function(){return this._startLifeTime}),x$Q(0,x$_,"time",function(){return this._time}),x$Q(0,x$_,"startSpeed",function(){return this._startSpeed}),x$Q(0,x$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(152,[new x$Eb(0,"vector4",17),new x$Eb(16,"vector4",30),new x$Eb(32,"vector4",32),new x$Eb(48,"vector4",19),new x$Eb(64,"vector3",20),new x$Eb(76,"vector3",22),new x$Eb(88,"single",31),new x$Eb(92,"vector4",34),new x$Eb(108,"vector4",35),new x$Eb(124,"vector3",36),new x$Eb(136,"vector4",37)])}])}(),function(){function x$b(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P,x$V){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=x$b,this._positionStartLifeTime=x$_,this._velocity=x$s,this._startColor=x$h,this._startSize=x$x,this._startRotation0=x$n,this._startRotation1=x$E,this._startRotation2=x$C,this._startLifeTime=x$O,this._time=x$L,this._startSpeed=x$f,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=x$V}x$V(x$b,"laya.d3.graphics.VertexShurikenParticleMesh");var x$_=x$b.prototype;x$$.imps(x$_,{"laya.d3.graphics.IVertex":!0}),x$Q(0,x$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),x$Q(0,x$_,"velocity",function(){return this._velocity}),x$Q(0,x$_,"position",function(){return this._positionStartLifeTime}),x$Q(0,x$_,"random0",function(){return this._randoms0}),x$Q(0,x$_,"startSize",function(){return this._startSize}),x$Q(0,x$_,"startColor",function(){return this._startColor}),x$Q(0,x$_,"startRotation0",function(){return this._startRotation0}),x$Q(0,x$_,"startRotation1",function(){return this._startRotation1}),x$Q(0,x$_,"random1",function(){return this._randoms1}),x$Q(0,x$_,"startRotation2",function(){return this._startRotation2}),x$Q(0,x$_,"startLifeTime",function(){return this._startLifeTime}),x$Q(0,x$_,"time",function(){return this._time}),x$Q(0,x$_,"startSpeed",function(){return this._startSpeed}),x$Q(0,x$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),x$Q(0,x$_,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$Q(1,x$b,"vertexDeclaration",function(){return x$b._vertexDeclaration}),x$p(x$b,["_vertexDeclaration",function(){return this._vertexDeclaration=new x$nb(172,[new x$Eb(0,"vector3",0),new x$Eb(12,"vector4",1),new x$Eb(28,"vector2",2),new x$Eb(36,"vector4",30),new x$Eb(52,"vector4",32),new x$Eb(68,"vector4",19),new x$Eb(84,"vector3",20),new x$Eb(96,"vector3",22),new x$Eb(108,"single",31),new x$Eb(112,"vector4",34),new x$Eb(128,"vector4",35),new x$Eb(144,"vector3",36),new x$Eb(156,"vector4",37)])}])}(),function(){function x$t(x$b,x$_,x$s,x$h,x$x,x$n){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=x$s,this._materials=x$h,this._subMeshes=x$x,this._materialMap=x$n,this._version=x$_,this._onLoaded(x$b)}x$V(x$t,"laya.d3.loaders.LoadModelV01");var x$b=x$t.prototype;return x$b._onLoaded=function(x$b){this._readData=x$b,this.READ_BLOCK();for(var x$_=0;x$_<this._BLOCK.count;x$_++){var x$s=this._readData.getUint16(),x$h=this._strings[x$s],x$x=this["READ_"+x$h];if(null==x$x)throw new Error("model file err,no this function:"+x$s+" "+x$h);if(!x$x.call(this))break}return this._mesh},x$b.onError=function(){},x$b._readString=function(){return this._strings[this._readData.getUint16()]},x$b.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},x$b.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},x$b.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var x$b=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var x$_=0;x$_<this._STRINGS.size;x$_++)this._strings[x$_]=this._readData.readUTFString();return this._readData.pos=x$b,!0},x$b.READ_MATERIAL=function(){var x$b=this._readData.getUint16(),x$_=(this._readString(),this._readString());return this._materials[x$b]="null"!==x$_?x$i.getRes(this._materialMap[x$_]):new x$S_,!0},x$b.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var x$b,x$_=this._readData.__getBuffer(),x$s=0,x$h=this._readData.getUint32(),x$x=this._readData.getUint32(),x$n=(new Float32Array(x$_.slice(x$h+this._DATA.offset,x$h+this._DATA.offset+x$x)),this._readData.getUint32()),x$E=this._readData.getUint32(),x$C=new Float32Array(x$_.slice(x$n+this._DATA.offset,x$n+this._DATA.offset+x$E));for(this.mesh._inverseBindPoses=[],x$s=0,x$b=x$C.length;x$s<x$b;x$s+=16){var x$O=new x$b_(x$C[x$s+0],x$C[x$s+1],x$C[x$s+2],x$C[x$s+3],x$C[x$s+4],x$C[x$s+5],x$C[x$s+6],x$C[x$s+7],x$C[x$s+8],x$C[x$s+9],x$C[x$s+10],x$C[x$s+11],x$C[x$s+12],x$C[x$s+13],x$C[x$s+14],x$C[x$s+15]);this.mesh._inverseBindPoses.push(x$O)}break;default:throw new Error("LoadModel:unknown version.")}return!0},x$b.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var x$b=this._readString();this._shaderAttributes=x$b.match(x$t._attrReg);var x$_=this._readData.getUint32(),x$s=this._readData.getUint32(),x$h=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),x$x=this._readData.getUint32(),x$n=this._readData.getUint32(),x$E=this._readData.getUint32(),x$C=this._readData.__getBuffer(),x$O=new x$L_(this._mesh),x$L=this._getVertexDeclaration(),x$f=x$K_.create(x$L,x$x/x$L.vertexStride,35044,!0),x$p=x$h+this._DATA.offset,x$P=x$C.slice(x$p,x$p+x$x);x$f.setData(new Float32Array(x$P));for(var x$V=(x$O._vertexBuffer=x$f).vertexDeclaration.getVertexElements(),x$Q=0;x$Q<x$V.length;x$Q++)x$O._bufferUsage[x$V[x$Q].elementUsage]=x$f;var x$y=x$a_.create("ushort",x$s/2,35044,!0),x$w=x$_+this._DATA.offset,x$i=x$C.slice(x$w,x$w+x$s);x$y.setData(new Uint16Array(x$i)),x$O._indexBuffer=x$y;var x$R=x$C.slice(x$n+this._DATA.offset,x$n+this._DATA.offset+x$E);return x$O._boneIndicesList[0]=new Uint8Array(x$R),this._subMeshes.push(x$O),!0},x$b.READ_DATAAREA=function(){return!1},x$b._getVertexDeclaration=function(){for(var x$b,x$_=!1,x$s=!1,x$h=!1,x$x=!1,x$n=!1,x$E=!1,x$C=!1,x$O=!1,x$L=!1,x$f=0;x$f<this._shaderAttributes.length;x$f+=8)switch(this._shaderAttributes[x$f]){case"POSITION":x$_=!0;break;case"NORMAL":x$s=!0;break;case"COLOR":x$h=!0;break;case"UV":x$x=!0;break;case"UV1":x$n=!0;break;case"BLENDWEIGHT":x$C=!0;break;case"BLENDINDICES":x$O=!0;break;case"TANGENT":x$E=!0;break;case"BINORMAL":x$L=!0}return x$_&&x$s&&x$h&&x$x&&x$n&&x$C&&x$O&&x$E?x$b=x$tb.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$n&&x$C&&x$O?x$b=x$ib.vertexDeclaration:x$_&&x$s&&x$x&&x$n&&x$C&&x$O&&x$E?x$b=x$qb.vertexDeclaration:x$_&&x$s&&x$x&&x$n&&x$C&&x$O?x$b=x$Wb.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$C&&x$O&&x$E?x$b=x$Mb.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$C&&x$O?x$b=x$Db.vertexDeclaration:x$_&&x$s&&x$E&&x$L&&x$x&&x$C&&x$O?x$b=x$Ab.vertexDeclaration:x$_&&x$s&&x$x&&x$C&&x$O&&x$E?x$b=x$Kb.vertexDeclaration:x$_&&x$s&&x$x&&x$C&&x$O?x$b=x$zb.vertexDeclaration:x$_&&x$s&&x$h&&x$C&&x$O&&x$E?x$b=x$Pb.vertexDeclaration:x$_&&x$s&&x$h&&x$C&&x$O?x$b=x$fb.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$n&&x$E?x$b=x$$b.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$n?x$b=x$wb.vertexDeclaration:x$_&&x$s&&x$x&&x$n&&x$E?x$b=x$Gb.vertexDeclaration:x$_&&x$s&&x$x&&x$n?x$b=x$Jb.vertexDeclaration:x$_&&x$s&&x$h&&x$x&&x$E?x$b=x$kb.vertexDeclaration:x$_&&x$s&&x$x&&x$E&&x$L?x$b=x$gb.vertexDeclaration:x$_&&x$s&&x$h&&x$x?x$b=x$yb.vertexDeclaration:x$_&&x$s&&x$x&&x$E?x$b=x$Ib.vertexDeclaration:x$_&&x$s&&x$x?x$b=x$Zb.vertexDeclaration:x$_&&x$s&&x$h&&x$E?x$b=x$Qb.vertexDeclaration:x$_&&x$s&&x$h&&(x$b=x$Lb.vertexDeclaration),x$b},x$Q(0,x$b,"mesh",function(){return this._mesh}),x$t._attrReg=new RegExp("(\\w+)|([:,;])","g"),x$t}()),x$Nb=function(){function x$o(){}return x$V(x$o,"laya.d3.loaders.LoadModelV02"),x$o.parse=function(x$b,x$_,x$s,x$h,x$x,x$n){x$o._mesh=x$s,x$o._materials=x$h,x$o._subMeshes=x$x,x$o._materialMap=x$n,x$o._version=x$_,x$o._readData=x$b,x$o.READ_DATA(),x$o.READ_BLOCK(),x$o.READ_STRINGS();for(var x$E=0,x$C=x$o._BLOCK.count;x$E<x$C;x$E++){x$o._readData.pos=x$o._BLOCK.blockStarts[x$E];var x$O=x$o._readData.getUint16(),x$L=x$o._strings[x$O],x$f=x$o["READ_"+x$L];if(null==x$f)throw new Error("model file err,no this function:"+x$O+" "+x$L);x$f.call()}x$o._strings.length=0,x$o._readData=null,x$o._version=null,x$o._mesh=null,x$o._materials=null,x$o._subMeshes=null,x$o._materialMap=null},x$o._readString=function(){return x$o._strings[x$o._readData.getUint16()]},x$o.READ_DATA=function(){x$o._DATA.offset=x$o._readData.getUint32(),x$o._DATA.size=x$o._readData.getUint32()},x$o.READ_BLOCK=function(){for(var x$b=x$o._BLOCK.count=x$o._readData.getUint16(),x$_=x$o._BLOCK.blockStarts=[],x$s=x$o._BLOCK.blockLengths=[],x$h=0;x$h<x$b;x$h++)x$_.push(x$o._readData.getUint32()),x$s.push(x$o._readData.getUint32())},x$o.READ_STRINGS=function(){var x$b=x$o._readData.getUint32(),x$_=x$o._readData.getUint16(),x$s=x$o._readData.pos;x$o._readData.pos=x$b+x$o._DATA.offset;for(var x$h=0;x$h<x$_;x$h++)x$o._strings[x$h]=x$o._readData.readUTFString();x$o._readData.pos=x$s},x$o.READ_MATERIAL=function(){x$o._readString(),x$o._readString();var x$b=x$o._readString();return""!==x$b&&x$o._materials.push(x$i.getRes(x$o._materialMap[x$b])),!0},x$o.READ_MESH=function(){x$o._readString();var x$b,x$_=x$o._readData.__getBuffer(),x$s=0,x$h=x$o._readData.getInt16(),x$x=x$o._DATA.offset;for(x$s=0;x$s<x$h;x$s++){var x$n=x$x+x$o._readData.getUint32(),x$E=x$o._readData.getUint32(),x$C=new Float32Array(x$_.slice(x$n,x$n+x$E)),x$O=x$o._readString().match(x$o._attrReg),x$L=x$o._getVertexDeclaration(x$O),x$f=x$K_.create(x$L,4*x$C.length/x$L.vertexStride,35044,!0);x$f.setData(x$C),x$o._mesh._vertexBuffers.push(x$f)}var x$p=x$x+x$o._readData.getUint32(),x$P=x$o._readData.getUint32(),x$V=new Uint16Array(x$_.slice(x$p,x$p+x$P)),x$Q=x$a_.create("ushort",x$P/2,35044,!0);x$Q.setData(x$V),x$o._mesh._indexBuffer=x$Q;var x$y=x$o._mesh._boneNames=[],x$w=x$o._readData.getUint16();for(x$y.length=x$w,x$s=0;x$s<x$w;x$s++)x$y[x$s]=x$o._strings[x$o._readData.getUint16()];var x$i=x$o._readData.getUint32(),x$R=x$o._readData.getUint32(),x$t=(new Float32Array(x$_.slice(x$x+x$i,x$x+x$i+x$R)),x$o._readData.getUint32()),x$c=x$o._readData.getUint32(),x$$=new Float32Array(x$_.slice(x$x+x$t,x$x+x$t+x$c));for(x$o._mesh._inverseBindPoses=[],x$s=0,x$b=x$$.length;x$s<x$b;x$s+=16){var x$D=new x$b_(x$$[x$s+0],x$$[x$s+1],x$$[x$s+2],x$$[x$s+3],x$$[x$s+4],x$$[x$s+5],x$$[x$s+6],x$$[x$s+7],x$$[x$s+8],x$$[x$s+9],x$$[x$s+10],x$$[x$s+11],x$$[x$s+12],x$$[x$s+13],x$$[x$s+14],x$$[x$s+15]);x$o._mesh._inverseBindPoses.push(x$D)}return x$o._mesh._skinnedDatas=new Float32Array(16*x$$.length),!0},x$o.READ_SUBMESH=function(){var x$b=x$o._readData.__getBuffer(),x$_=new x$L_(x$o._mesh),x$s=x$o._readData.getInt16(),x$h=x$o._readData.getUint32(),x$x=x$o._readData.getUint32();x$_._vertexBuffer=x$o._mesh._vertexBuffers[x$s],x$_._vertexStart=x$h,x$_._vertexCount=x$x;var x$n=x$o._readData.getUint32(),x$E=x$o._readData.getUint32(),x$C=x$o._mesh._indexBuffer;x$_._indexBuffer=x$C,x$_._indexStart=x$n,x$_._indexCount=x$E,x$_._indices=new Uint16Array(x$C.getData().buffer,2*x$n,x$E);var x$O=x$o._DATA.offset,x$L=x$_._subIndexBufferStart,x$f=x$_._subIndexBufferCount,x$p=x$_._boneIndicesList,x$P=x$o._readData.getUint16();x$L.length=x$P,x$f.length=x$P,x$p.length=x$P;for(var x$V=0;x$V<x$P;x$V++){x$L[x$V]=x$o._readData.getUint32(),x$f[x$V]=x$o._readData.getUint32();var x$Q=x$o._readData.getUint32(),x$y=x$o._readData.getUint32();x$_._boneIndicesList[x$V]=new Uint8Array(x$b.slice(x$O+x$Q,x$O+x$Q+x$y))}return x$o._subMeshes.push(x$_),!0},x$o._getVertexDeclaration=function(x$b){for(var x$_,x$s=!1,x$h=!1,x$x=!1,x$n=!1,x$E=!1,x$C=!1,x$O=!1,x$L=!1,x$f=!1,x$p=0;x$p<x$b.length;x$p++)switch(x$b[x$p]){case"POSITION":x$s=!0;break;case"NORMAL":x$h=!0;break;case"COLOR":x$x=!0;break;case"UV":x$n=!0;break;case"UV1":x$E=!0;break;case"BLENDWEIGHT":x$O=!0;break;case"BLENDINDICES":x$L=!0;break;case"TANGENT":x$C=!0;break;case"BINORMAL":x$f=!0}return x$s&&x$h&&x$x&&x$n&&x$E&&x$O&&x$L&&x$C?x$_=x$tb.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$E&&x$O&&x$L?x$_=x$ib.vertexDeclaration:x$s&&x$h&&x$n&&x$E&&x$O&&x$L&&x$C?x$_=x$qb.vertexDeclaration:x$s&&x$h&&x$n&&x$E&&x$O&&x$L?x$_=x$Wb.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$O&&x$L&&x$C?x$_=x$Mb.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$O&&x$L?x$_=x$Db.vertexDeclaration:x$s&&x$h&&x$n&&x$O&&x$L&&x$C?x$_=x$Kb.vertexDeclaration:x$s&&x$h&&x$n&&x$O&&x$L?x$_=x$zb.vertexDeclaration:x$s&&x$h&&x$x&&x$O&&x$L&&x$C?x$_=x$Pb.vertexDeclaration:x$s&&x$h&&x$x&&x$O&&x$L?x$_=x$fb.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$E&&x$C?x$_=x$$b.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$E?x$_=x$wb.vertexDeclaration:x$s&&x$h&&x$n&&x$E&&x$C?x$_=x$Gb.vertexDeclaration:x$s&&x$h&&x$n&&x$E?x$_=x$Jb.vertexDeclaration:x$s&&x$h&&x$x&&x$n&&x$C?x$_=x$kb.vertexDeclaration:x$s&&x$h&&x$n&&x$C&&x$f?x$_=x$gb.vertexDeclaration:x$s&&x$h&&x$x&&x$n?x$_=x$yb.vertexDeclaration:x$s&&x$h&&x$n&&x$C?x$_=x$Ib.vertexDeclaration:x$s&&x$h&&x$n?x$_=x$Zb.vertexDeclaration:x$s&&x$h&&x$x&&x$C?x$_=x$Qb.vertexDeclaration:x$s&&x$h&&x$x&&(x$_=x$Lb.vertexDeclaration),x$_},x$o._attrReg=new RegExp("(\\w+)|([:,;])","g"),x$o._strings=[],x$o._readData=null,x$o._version=null,x$o._mesh=null,x$o._materials=null,x$o._subMeshes=null,x$o._materialMap=null,x$p(x$o,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),x$o}(),x$Xb=function(){function x$D(){}return x$V(x$D,"laya.d3.loaders.LoadModelV03"),x$D.parse=function(x$b,x$_,x$s,x$h,x$x){x$D._mesh=x$s,x$D._subMeshes=x$h,x$D._materialMap=x$x,x$D._version=x$_,x$D._readData=x$b,x$D.READ_DATA(),x$D.READ_BLOCK(),x$D.READ_STRINGS();for(var x$n=0,x$E=x$D._BLOCK.count;x$n<x$E;x$n++){x$D._readData.pos=x$D._BLOCK.blockStarts[x$n];var x$C=x$D._readData.getUint16(),x$O=x$D._strings[x$C],x$L=x$D["READ_"+x$O];if(null==x$L)throw new Error("model file err,no this function:"+x$C+" "+x$O);x$L.call()}x$D._strings.length=0,x$D._readData=null,x$D._version=null,x$D._mesh=null,x$D._subMeshes=null,x$D._materialMap=null},x$D._readString=function(){return x$D._strings[x$D._readData.getUint16()]},x$D.READ_DATA=function(){x$D._DATA.offset=x$D._readData.getUint32(),x$D._DATA.size=x$D._readData.getUint32()},x$D.READ_BLOCK=function(){for(var x$b=x$D._BLOCK.count=x$D._readData.getUint16(),x$_=x$D._BLOCK.blockStarts=[],x$s=x$D._BLOCK.blockLengths=[],x$h=0;x$h<x$b;x$h++)x$_.push(x$D._readData.getUint32()),x$s.push(x$D._readData.getUint32())},x$D.READ_STRINGS=function(){var x$b=x$D._readData.getUint32(),x$_=x$D._readData.getUint16(),x$s=x$D._readData.pos;x$D._readData.pos=x$b+x$D._DATA.offset;for(var x$h=0;x$h<x$_;x$h++)x$D._strings[x$h]=x$D._readData.readUTFString();x$D._readData.pos=x$s},x$D.READ_MESH=function(){var x$b,x$_=x$D._readString(),x$s=x$D._readData.__getBuffer(),x$h=0,x$x=x$D._readData.getInt16(),x$n=x$D._DATA.offset;for(x$h=0;x$h<x$x;x$h++){var x$E,x$C=x$n+x$D._readData.getUint32(),x$O=x$D._readData.getUint32(),x$L=new Float32Array(x$s.slice(x$C,x$C+x$O)),x$f=x$D._readString();switch(x$D._version){case"LAYAMODEL:03":x$E=x$D._vertexDeclarationMap_Discard[x$f];break;case"LAYAMODEL:0301":x$E=x$D._vertexDeclarationMap[x$f];break;default:throw new Error("LoadModelV03: unknown version.")}if(!x$E)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+x$D._version+"  bufferAttribute="+x$f+"  name="+x$_+"  url="+(x$D._mesh?x$D._mesh.url:"null"));var x$p=x$K_.create(x$E,4*x$L.length/x$E.vertexStride,35044,!0,x$D._mesh._url+"_"+x$h);x$p.setData(x$L),x$D._mesh._vertexBuffers.push(x$p)}var x$P=x$n+x$D._readData.getUint32(),x$V=x$D._readData.getUint32(),x$Q=new Uint16Array(x$s.slice(x$P,x$P+x$V)),x$y=x$a_.create("ushort",x$V/2,35044,!0,x$D._mesh._url);x$y.setData(x$Q),x$D._mesh._indexBuffer=x$y;var x$w=x$D._mesh._boneNames=[],x$i=x$D._readData.getUint16();for(x$w.length=x$i,x$h=0;x$h<x$i;x$h++)x$w[x$h]=x$D._strings[x$D._readData.getUint16()];x$D._readData.pos+=8;var x$R=x$D._readData.getUint32(),x$t=x$D._readData.getUint32(),x$c=new Float32Array(x$s.slice(x$n+x$R,x$n+x$R+x$t));for(x$D._mesh._inverseBindPoses=[],x$h=0,x$b=x$c.length;x$h<x$b;x$h+=16){var x$$=new x$b_(x$c[x$h+0],x$c[x$h+1],x$c[x$h+2],x$c[x$h+3],x$c[x$h+4],x$c[x$h+5],x$c[x$h+6],x$c[x$h+7],x$c[x$h+8],x$c[x$h+9],x$c[x$h+10],x$c[x$h+11],x$c[x$h+12],x$c[x$h+13],x$c[x$h+14],x$c[x$h+15]);x$D._mesh._inverseBindPoses.push(x$$)}return x$D._mesh._skinnedDatas=new Float32Array(16*x$c.length),!0},x$D.READ_SUBMESH=function(){var x$b=x$D._readData.__getBuffer(),x$_=new x$L_(x$D._mesh),x$s=x$D._readData.getInt16(),x$h=x$D._readData.getUint32(),x$x=x$D._readData.getUint32();x$_._vertexBuffer=x$D._mesh._vertexBuffers[x$s],x$_._vertexStart=x$h,x$_._vertexCount=x$x;var x$n=x$D._readData.getUint32(),x$E=x$D._readData.getUint32(),x$C=x$D._mesh._indexBuffer;x$_._indexBuffer=x$C,x$_._indexStart=x$n,x$_._indexCount=x$E,x$_._indices=new Uint16Array(x$C.getData().buffer,2*x$n,x$E);var x$O=x$D._DATA.offset,x$L=x$_._subIndexBufferStart,x$f=x$_._subIndexBufferCount,x$p=x$_._boneIndicesList,x$P=x$D._readData.getUint16();x$L.length=x$P,x$f.length=x$P,x$p.length=x$P;for(var x$V=0;x$V<x$P;x$V++){x$L[x$V]=x$D._readData.getUint32(),x$f[x$V]=x$D._readData.getUint32();var x$Q=x$D._readData.getUint32(),x$y=x$D._readData.getUint32();x$p[x$V]=new Uint8Array(x$b.slice(x$O+x$Q,x$O+x$Q+x$y))}return x$D._subMeshes.push(x$_),!0},x$D._strings=[],x$D._readData=null,x$D._version=null,x$D._mesh=null,x$D._subMeshes=null,x$D._materialMap=null,x$p(x$D,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":x$tb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":x$ib.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":x$Fb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":x$qb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":x$Wb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":x$Mb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":x$Db.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":x$Kb.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":x$zb.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":x$Pb.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":x$fb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":x$$b.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":x$wb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":x$Gb.vertexDeclaration,"POSITION,NORMAL,UV,UV1":x$Jb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":x$kb.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":x$gb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":x$yb.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":x$Ib.vertexDeclaration,"POSITION,NORMAL,UV":x$Zb.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":x$Qb.vertexDeclaration,"POSITION,NORMAL,COLOR":x$Lb.vertexDeclaration,"POSITION,NORMAL,TANGENT":x$Sb.vertexDeclaration,"POSITION,NORMAL":x$Ob.vertexDeclaration,"POSITION,UV":x$ub.vertexDeclaration,POSITION:x$Cb.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":x$Rb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":x$ib.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":x$Fb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":x$Tb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":x$Wb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":x$ob.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":x$Db.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":x$ab.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":x$zb.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":x$pb.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":x$fb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":x$cb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":x$wb.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":x$Ub.vertexDeclaration,"POSITION,NORMAL,UV,UV1":x$Jb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":x$rb.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":x$gb.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":x$yb.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":x$db.vertexDeclaration,"POSITION,NORMAL,UV":x$Zb.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":x$Vb.vertexDeclaration,"POSITION,NORMAL,COLOR":x$Lb.vertexDeclaration,"POSITION,NORMAL,TANGENT":x$Bb.vertexDeclaration,"POSITION,NORMAL":x$Ob.vertexDeclaration,"POSITION,UV":x$ub.vertexDeclaration,POSITION:x$Cb.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),x$D}(),x$Yb=function(){function x$C(){}return x$V(x$C,"laya.d3.loaders.MeshReader"),x$C.read=function(x$b,x$_,x$s,x$h,x$x){var x$n=new x$D(x$b);x$n.pos=0;var x$E=x$n.readUTFString();switch(x$E){case"LAYAMODEL:01":case"LAYASKINANI:01":x$C._readVersion01(x$n,x$E,x$_,x$s,x$h,x$x);break;case"LAYAMODEL:02":x$Nb.parse(x$n,x$E,x$_,x$s,x$h,x$x);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":x$Xb.parse(x$n,x$E,x$_,x$h,x$x);break;default:throw new Error("MeshReader: unknown mesh version.")}x$_._setSubMeshes(x$h)},x$C._readVersion01=function(x$b,x$_,x$s,x$h,x$x,x$n){new x$lb(x$b,x$_,x$s,x$h,x$x,x$n)},x$C}(),x$mb=function(){function x$b(x$b,x$_){this.min=null,this.max=null,this.min=x$b,this.max=x$_}x$V(x$b,"laya.d3.math.BoundBox");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.getCorners=function(x$b){x$b.length=8;var x$_=this.min.elements,x$s=this.max.elements,x$h=x$_[0],x$x=x$_[1],x$n=x$_[2],x$E=x$s[0],x$C=x$s[1],x$O=x$s[2];x$b[0]=new x$E_(x$h,x$C,x$O),x$b[1]=new x$E_(x$E,x$C,x$O),x$b[2]=new x$E_(x$E,x$x,x$O),x$b[3]=new x$E_(x$h,x$x,x$O),x$b[4]=new x$E_(x$h,x$C,x$n),x$b[5]=new x$E_(x$E,x$C,x$n),x$b[6]=new x$E_(x$E,x$x,x$n),x$b[7]=new x$E_(x$h,x$x,x$n)},x$_.toDefault=function(){this.min.toDefault(),this.max.toDefault()},x$_.cloneTo=function(x$b){var x$_=x$b;this.min.cloneTo(x$_.min),this.max.cloneTo(x$_.max)},x$_.clone=function(){var x$b=new this.constructor(new x$E_,new x$E_);return this.cloneTo(x$b),x$b},x$b.createfromPoints=function(x$b,x$_){if(null==x$b)throw new Error("points");var x$s=x$_.min,x$h=x$_.max,x$x=x$s.elements;x$x[0]=Number.MAX_VALUE,x$x[1]=Number.MAX_VALUE,x$x[2]=Number.MAX_VALUE;var x$n=x$h.elements;x$n[0]=-Number.MAX_VALUE,x$n[1]=-Number.MAX_VALUE,x$n[2]=-Number.MAX_VALUE;for(var x$E=0,x$C=x$b.length;x$E<x$C;++x$E)x$E_.min(x$s,x$b[x$E],x$s),x$E_.max(x$h,x$b[x$E],x$h)},x$b.merge=function(x$b,x$_,x$s){x$E_.min(x$b.min,x$_.min,x$s.min),x$E_.max(x$b.max,x$_.max,x$s.max)},x$b}(),x$eb=function(){function x$L(x$b){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=x$b,this._near=new x$__(new x$E_),this._far=new x$__(new x$E_),this._left=new x$__(new x$E_),this._right=new x$__(new x$E_),this._top=new x$__(new x$E_),this._bottom=new x$__(new x$E_),x$L._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}x$V(x$L,"laya.d3.math.BoundFrustum");var x$b=x$L.prototype;return x$b.equalsBoundFrustum=function(x$b){return this._matrix.equalsOtherMatrix(x$b.matrix)},x$b.equalsObj=function(x$b){if(x$b instanceof laya.d3.math.BoundFrustum){var x$_=x$b;return this.equalsBoundFrustum(x$_)}return!1},x$b.getPlane=function(x$b){switch(x$b){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},x$b.getCorners=function(x$b){x$L._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(x$b[0]),x$L._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(x$b[1]),x$L._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(x$b[2]),x$L._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(x$b[3]),x$L._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(x$b[4]),x$L._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(x$b[5]),x$L._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(x$b[6]),x$L._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(x$b[7])},x$b.containsPoint=function(x$b){for(var x$_=x$__.PlaneIntersectionType_Front,x$s=x$__.PlaneIntersectionType_Front,x$h=0;x$h<6;x$h++){switch(x$h){case 0:x$s=Collision.intersectsPlaneAndPoint(this._near,x$b);break;case 1:x$s=Collision.intersectsPlaneAndPoint(this._far,x$b);break;case 2:x$s=Collision.intersectsPlaneAndPoint(this._left,x$b);break;case 3:x$s=Collision.intersectsPlaneAndPoint(this._right,x$b);break;case 4:x$s=Collision.intersectsPlaneAndPoint(this._top,x$b);break;case 5:x$s=Collision.intersectsPlaneAndPoint(this._bottom,x$b)}switch(x$s){case x$__.PlaneIntersectionType_Back:return 0;case x$__.PlaneIntersectionType_Intersecting:x$_=x$__.PlaneIntersectionType_Intersecting}}switch(x$_){case x$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},x$b.containsBoundBox=function(x$b){for(var x$_,x$s=x$L._tempV30,x$h=x$L._tempV31,x$x=1,x$n=0;x$n<6;x$n++){if(x$_=this.getPlane(x$n),this._getBoxToPlanePVertexNVertex(x$b,x$_.normal,x$s,x$h),Collision.intersectsPlaneAndPoint(x$_,x$s)===x$__.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(x$_,x$h)===x$__.PlaneIntersectionType_Back&&(x$x=2)}return x$x},x$b.containsBoundSphere=function(x$b){for(var x$_=x$__.PlaneIntersectionType_Front,x$s=x$__.PlaneIntersectionType_Front,x$h=0;x$h<6;x$h++){switch(x$h){case 0:x$s=Collision.intersectsPlaneAndSphere(this._near,x$b);break;case 1:x$s=Collision.intersectsPlaneAndSphere(this._far,x$b);break;case 2:x$s=Collision.intersectsPlaneAndSphere(this._left,x$b);break;case 3:x$s=Collision.intersectsPlaneAndSphere(this._right,x$b);break;case 4:x$s=Collision.intersectsPlaneAndSphere(this._top,x$b);break;case 5:x$s=Collision.intersectsPlaneAndSphere(this._bottom,x$b)}switch(x$s){case x$__.PlaneIntersectionType_Back:return 0;case x$__.PlaneIntersectionType_Intersecting:x$_=x$__.PlaneIntersectionType_Intersecting}}switch(x$_){case x$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},x$b._getBoxToPlanePVertexNVertex=function(x$b,x$_,x$s,x$h){var x$x=x$b.min,x$n=x$x.elements,x$E=x$b.max,x$C=x$E.elements,x$O=x$_.elements,x$L=x$O[0],x$f=x$O[1],x$p=x$O[2];x$x.cloneTo(x$s);var x$P=x$s.elements;0<=x$L&&(x$P[0]=x$C[0]),0<=x$f&&(x$P[1]=x$C[1]),0<=x$p&&(x$P[2]=x$C[2]),x$E.cloneTo(x$h);var x$V=x$h.elements;0<=x$L&&(x$V[0]=x$n[0]),0<=x$f&&(x$V[1]=x$n[1]),0<=x$p&&(x$V[2]=x$n[2])},x$Q(0,x$b,"top",function(){return this._top}),x$Q(0,x$b,"matrix",function(){return this._matrix},function(x$b){this._matrix=x$b,x$L._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),x$Q(0,x$b,"near",function(){return this._near}),x$Q(0,x$b,"far",function(){return this._far}),x$Q(0,x$b,"left",function(){return this._left}),x$Q(0,x$b,"right",function(){return this._right}),x$Q(0,x$b,"bottom",function(){return this._bottom}),x$L._getPlanesFromMatrix=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C=x$b.elements,x$O=x$C[0],x$L=x$C[1],x$f=x$C[2],x$p=x$C[3],x$P=x$C[4],x$V=x$C[5],x$Q=x$C[6],x$y=x$C[7],x$w=x$C[8],x$i=x$C[9],x$R=x$C[10],x$t=x$C[11],x$c=x$C[12],x$$=x$C[13],x$D=x$C[14],x$o=x$C[15],x$M=x$_.normal.elements;x$M[0]=x$p+x$f,x$M[1]=x$y+x$Q,x$M[2]=x$t+x$R,x$_.distance=x$o+x$D,x$_.normalize();var x$r=x$s.normal.elements;x$r[0]=x$p-x$f,x$r[1]=x$y-x$Q,x$r[2]=x$t-x$R,x$s.distance=x$o-x$D,x$s.normalize();var x$k=x$h.normal.elements;x$k[0]=x$p+x$O,x$k[1]=x$y+x$P,x$k[2]=x$t+x$w,x$h.distance=x$o+x$c,x$h.normalize();var x$B=x$x.normal.elements;x$B[0]=x$p-x$O,x$B[1]=x$y-x$P,x$B[2]=x$t-x$w,x$x.distance=x$o-x$c,x$x.normalize();var x$S=x$n.normal.elements;x$S[0]=x$p-x$L,x$S[1]=x$y-x$V,x$S[2]=x$t-x$i,x$n.distance=x$o-x$$,x$n.normalize();var x$Z=x$E.normal.elements;x$Z[0]=x$p+x$L,x$Z[1]=x$y+x$V,x$Z[2]=x$t+x$i,x$E.distance=x$o+x$$,x$E.normalize()},x$L._get3PlaneInterPoint=function(x$b,x$_,x$s){var x$h=x$b.normal,x$x=x$_.normal,x$n=x$s.normal;x$E_.cross(x$x,x$n,x$L._tempV30),x$E_.cross(x$n,x$h,x$L._tempV31),x$E_.cross(x$h,x$x,x$L._tempV32);var x$E=x$E_.dot(x$h,x$L._tempV30),x$C=x$E_.dot(x$x,x$L._tempV31),x$O=x$E_.dot(x$n,x$L._tempV32);return x$E_.scale(x$L._tempV30,-x$b.distance/x$E,x$L._tempV33),x$E_.scale(x$L._tempV31,-x$_.distance/x$C,x$L._tempV34),x$E_.scale(x$L._tempV32,-x$s.distance/x$O,x$L._tempV35),x$E_.add(x$L._tempV33,x$L._tempV34,x$L._tempV36),x$E_.add(x$L._tempV35,x$L._tempV36,x$L._tempV37),x$L._tempV37},x$p(x$L,["_tempV30",function(){return this._tempV30=new x$E_},"_tempV31",function(){return this._tempV31=new x$E_},"_tempV32",function(){return this._tempV32=new x$E_},"_tempV33",function(){return this._tempV33=new x$E_},"_tempV34",function(){return this._tempV34=new x$E_},"_tempV35",function(){return this._tempV35=new x$E_},"_tempV36",function(){return this._tempV36=new x$E_},"_tempV37",function(){return this._tempV37=new x$E_}]),x$L}(),x$vb=function(){function x$f(x$b,x$_){this.center=null,this.radius=NaN,this.center=x$b,this.radius=x$_}x$V(x$f,"laya.d3.math.BoundSphere");var x$b=x$f.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.toDefault=function(){this.center.toDefault(),this.radius=0},x$b.intersectsRayDistance=function(x$b){return Collision.intersectsRayAndSphereRD(x$b,this)},x$b.intersectsRayPoint=function(x$b,x$_){return Collision.intersectsRayAndSphereRP(x$b,this,x$_)},x$b.cloneTo=function(x$b){var x$_=x$b;this.center.cloneTo(x$_.center),x$_.radius=this.radius},x$b.clone=function(){var x$b=new this.constructor(new x$E_,new x$E_);return this.cloneTo(x$b),x$b},x$f.createFromSubPoints=function(x$b,x$_,x$s,x$h){if(null==x$b)throw new Error("points");if(x$_<0||x$_>=x$b.length)throw new Error("start"+x$_+"Must be in the range [0, "+(x$b.length-1)+"]");if(x$s<0||x$_+x$s>x$b.length)throw new Error("count"+x$s+"Must be in the range <= "+x$b.length+"}");var x$x=x$_+x$s,x$n=x$f._tempVector3;x$n.elements[0]=0,x$n.elements[1]=0,x$n.elements[2]=0;for(var x$E=x$_;x$E<x$x;++x$E)x$E_.add(x$b[x$E],x$n,x$n);var x$C=x$h.center;x$E_.scale(x$n,1/x$s,x$C);var x$O=0;for(x$E=x$_;x$E<x$x;++x$E){var x$L=x$E_.distanceSquared(x$C,x$b[x$E]);x$O<x$L&&(x$O=x$L)}x$h.radius=Math.sqrt(x$O)},x$f.createfromPoints=function(x$b,x$_){if(null==x$b)throw new Error("points");x$f.createFromSubPoints(x$b,0,x$b.length,x$_)},x$p(x$f,["_tempVector3",function(){return this._tempVector3=new x$E_}]),x$f}(),x$Hb=(function(){function x$b(){}x$V(x$b,"laya.d3.math.ContainmentType"),x$b.Disjoint=0,x$b.Contains=1,x$b.Intersects=2}(),function(){function x$s(){}return x$V(x$s,"laya.d3.math.MathUtils3D"),x$s.isZero=function(x$b){return Math.abs(x$b)<x$s.zeroTolerance},x$s.nearEqual=function(x$b,x$_){return!!x$s.isZero(x$b-x$_)},x$s.fastInvSqrt=function(x$b){return x$s.isZero(x$b)?x$b:1/Math.sqrt(x$b)},x$p(x$s,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),x$s}()),x$jb=function(){function x$O(){var x$b=this.elements=new Float32Array(9);x$b[0]=1,x$b[1]=0,x$b[2]=0,x$b[3]=0,x$b[4]=1,x$b[5]=0,x$b[6]=0,x$b[7]=0,x$b[8]=1}x$V(x$O,"laya.d3.math.Matrix3x3");var x$b=x$O.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.determinant=function(){var x$b=this.elements,x$_=x$b[0],x$s=x$b[1],x$h=x$b[2],x$x=x$b[3],x$n=x$b[4],x$E=x$b[5],x$C=x$b[6],x$O=x$b[7],x$L=x$b[8];return x$_*(x$L*x$n-x$E*x$O)+x$s*(-x$L*x$x+x$E*x$C)+x$h*(x$O*x$x-x$n*x$C)},x$b.translate=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements,x$x=x$b.elements,x$n=x$h[0],x$E=x$h[1],x$C=x$h[2],x$O=x$h[3],x$L=x$h[4],x$f=x$h[5],x$p=x$h[6],x$P=x$h[7],x$V=x$h[8],x$Q=x$x[0],x$y=x$x[1];x$s[0]=x$n,x$s[1]=x$E,x$s[2]=x$C,x$s[3]=x$O,x$s[4]=x$L,x$s[5]=x$f,x$s[6]=x$Q*x$n+x$y*x$O+x$p,x$s[7]=x$Q*x$E+x$y*x$L+x$P,x$s[8]=x$Q*x$C+x$y*x$f+x$V},x$b.rotate=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=x$h[4],x$L=x$h[5],x$f=x$h[6],x$p=x$h[7],x$P=x$h[8],x$V=Math.sin(x$b),x$Q=Math.cos(x$b);x$s[0]=x$Q*x$x+x$V*x$C,x$s[1]=x$Q*x$n+x$V*x$O,x$s[2]=x$Q*x$E+x$V*x$L,x$s[3]=x$Q*x$C-x$V*x$x,x$s[4]=x$Q*x$O-x$V*x$n,x$s[5]=x$Q*x$L-x$V*x$E,x$s[6]=x$f,x$s[7]=x$p,x$s[8]=x$P},x$b.scale=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements,x$x=x$b.elements,x$n=x$x[0],x$E=x$x[1];x$s[0]=x$n*x$h[0],x$s[1]=x$n*x$h[1],x$s[2]=x$n*x$h[2],x$s[3]=x$E*x$h[3],x$s[4]=x$E*x$h[4],x$s[5]=x$E*x$h[5],x$s[6]=x$h[6],x$s[7]=x$h[7],x$s[8]=x$h[8]},x$b.invert=function(x$b){var x$_=x$b.elements,x$s=this.elements,x$h=x$s[0],x$x=x$s[1],x$n=x$s[2],x$E=x$s[3],x$C=x$s[4],x$O=x$s[5],x$L=x$s[6],x$f=x$s[7],x$p=x$s[8],x$P=x$p*x$C-x$O*x$f,x$V=-x$p*x$E+x$O*x$L,x$Q=x$f*x$E-x$C*x$L,x$y=x$h*x$P+x$x*x$V+x$n*x$Q;x$y||(x$b=null),x$y=1/x$y,x$_[0]=x$P*x$y,x$_[1]=(-x$p*x$x+x$n*x$f)*x$y,x$_[2]=(x$O*x$x-x$n*x$C)*x$y,x$_[3]=x$V*x$y,x$_[4]=(x$p*x$h-x$n*x$L)*x$y,x$_[5]=(-x$O*x$h+x$n*x$E)*x$y,x$_[6]=x$Q*x$y,x$_[7]=(-x$f*x$h+x$x*x$L)*x$y,x$_[8]=(x$C*x$h-x$x*x$E)*x$y},x$b.transpose=function(x$b){var x$_=x$b.elements,x$s=this.elements;if(x$b===this){var x$h=x$s[1],x$x=x$s[2],x$n=x$s[5];x$_[1]=x$s[3],x$_[2]=x$s[6],x$_[3]=x$h,x$_[5]=x$s[7],x$_[6]=x$x,x$_[7]=x$n}else x$_[0]=x$s[0],x$_[1]=x$s[3],x$_[2]=x$s[6],x$_[3]=x$s[1],x$_[4]=x$s[4],x$_[5]=x$s[7],x$_[6]=x$s[2],x$_[7]=x$s[5],x$_[8]=x$s[8]},x$b.identity=function(){var x$b=this.elements;x$b[0]=1,x$b[1]=0,x$b[2]=0,x$b[3]=0,x$b[4]=1,x$b[5]=0,x$b[6]=0,x$b[7]=0,x$b[8]=1},x$b.cloneTo=function(x$b){var x$_,x$s,x$h;if((x$s=this.elements)!==(x$h=x$b.elements))for(x$_=0;x$_<9;++x$_)x$h[x$_]=x$s[x$_]},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$O.createFromTranslation=function(x$b,x$_){x$_.elements;var x$s=x$b.elements;x$_[0]=1,x$_[1]=0,x$_[2]=0,x$_[3]=0,x$_[4]=1,x$_[5]=0,x$_[6]=x$s[0],x$_[7]=x$s[1],x$_[8]=1},x$O.createFromRotation=function(x$b,x$_){var x$s=x$_.elements,x$h=Math.sin(x$b),x$x=Math.cos(x$b);x$s[0]=x$x,x$s[1]=x$h,x$s[2]=0,x$s[3]=-x$h,x$s[4]=x$x,x$s[5]=0,x$s[6]=0,x$s[7]=0,x$s[8]=1},x$O.createFromScaling=function(x$b,x$_){var x$s=x$_.elements,x$h=x$b.elements;x$s[0]=x$h[0],x$s[1]=0,x$s[2]=0,x$s[3]=0,x$s[4]=x$h[1],x$s[5]=0,x$s[6]=0,x$s[7]=0,x$s[8]=1},x$O.createFromMatrix4x4=function(x$b,x$_){x$_[0]=x$b[0],x$_[1]=x$b[1],x$_[2]=x$b[2],x$_[3]=x$b[4],x$_[4]=x$b[5],x$_[5]=x$b[6],x$_[6]=x$b[8],x$_[7]=x$b[9],x$_[8]=x$b[10]},x$O.multiply=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements,x$E=x$x[0],x$C=x$x[1],x$O=x$x[2],x$L=x$x[3],x$f=x$x[4],x$p=x$x[5],x$P=x$x[6],x$V=x$x[7],x$Q=x$x[8],x$y=x$n[0],x$w=x$n[1],x$i=x$n[2],x$R=x$n[3],x$t=x$n[4],x$c=x$n[5],x$$=x$n[6],x$D=x$n[7],x$o=x$n[8];x$h[0]=x$y*x$E+x$w*x$L+x$i*x$P,x$h[1]=x$y*x$C+x$w*x$f+x$i*x$V,x$h[2]=x$y*x$O+x$w*x$p+x$i*x$Q,x$h[3]=x$R*x$E+x$t*x$L+x$c*x$P,x$h[4]=x$R*x$C+x$t*x$f+x$c*x$V,x$h[5]=x$R*x$O+x$t*x$p+x$c*x$Q,x$h[6]=x$$*x$E+x$D*x$L+x$o*x$P,x$h[7]=x$$*x$C+x$D*x$f+x$o*x$V,x$h[8]=x$$*x$O+x$D*x$p+x$o*x$Q},x$O.lookAt=function(x$b,x$_,x$s,x$h){x$E_.subtract(x$b,x$_,x$O._tempV30),x$E_.normalize(x$O._tempV30,x$O._tempV30),x$E_.cross(x$s,x$O._tempV30,x$O._tempV31),x$E_.normalize(x$O._tempV31,x$O._tempV31),x$E_.cross(x$O._tempV30,x$O._tempV31,x$O._tempV32);var x$x=x$O._tempV30.elements,x$n=x$O._tempV31.elements,x$E=x$O._tempV32.elements,x$C=x$h.elements;x$C[0]=x$n[0],x$C[3]=x$n[1],x$C[6]=x$n[2],x$C[1]=x$E[0],x$C[4]=x$E[1],x$C[7]=x$E[2],x$C[2]=x$x[0],x$C[5]=x$x[1],x$C[8]=x$x[2]},x$O.DEFAULT=new x$O,x$p(x$O,["_tempV30",function(){return this._tempV30=new x$E_},"_tempV31",function(){return this._tempV31=new x$E_},"_tempV32",function(){return this._tempV32=new x$E_}]),x$O}(),x$b_=function(){function x$r(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p,x$P,x$V,x$Q,x$y){void 0===x$b&&(x$b=1),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=1),void 0===x$E&&(x$E=0),void 0===x$C&&(x$C=0),void 0===x$O&&(x$O=0),void 0===x$L&&(x$L=0),void 0===x$f&&(x$f=1),void 0===x$p&&(x$p=0),void 0===x$P&&(x$P=0),void 0===x$V&&(x$V=0),void 0===x$Q&&(x$Q=0),void 0===x$y&&(x$y=1);var x$w=this.elements=new Float32Array(16);x$w[0]=x$b,x$w[1]=x$_,x$w[2]=x$s,x$w[3]=x$h,x$w[4]=x$x,x$w[5]=x$n,x$w[6]=x$E,x$w[7]=x$C,x$w[8]=x$O,x$w[9]=x$L,x$w[10]=x$f,x$w[11]=x$p,x$w[12]=x$P,x$w[13]=x$V,x$w[14]=x$Q,x$w[15]=x$y}x$V(x$r,"laya.d3.math.Matrix4x4");var x$b=x$r.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.getElementByRowColumn=function(x$b,x$_){if(x$b<0||3<x$b)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(x$_<0||3<x$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*x$b+x$_]},x$b.setElementByRowColumn=function(x$b,x$_,x$s){if(x$b<0||3<x$b)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(x$_<0||3<x$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*x$b+x$_]=x$s},x$b.equalsOtherMatrix=function(x$b){var x$_=this.elements,x$s=x$b.elements;return x$Hb.nearEqual(x$_[0],x$s[0])&&x$Hb.nearEqual(x$_[1],x$s[1])&&x$Hb.nearEqual(x$_[2],x$s[2])&&x$Hb.nearEqual(x$_[3],x$s[3])&&x$Hb.nearEqual(x$_[4],x$s[4])&&x$Hb.nearEqual(x$_[5],x$s[5])&&x$Hb.nearEqual(x$_[6],x$s[6])&&x$Hb.nearEqual(x$_[7],x$s[7])&&x$Hb.nearEqual(x$_[8],x$s[8])&&x$Hb.nearEqual(x$_[9],x$s[9])&&x$Hb.nearEqual(x$_[10],x$s[10])&&x$Hb.nearEqual(x$_[11],x$s[11])&&x$Hb.nearEqual(x$_[12],x$s[12])&&x$Hb.nearEqual(x$_[13],x$s[13])&&x$Hb.nearEqual(x$_[14],x$s[14])&&x$Hb.nearEqual(x$_[15],x$s[15])},x$b.decomposeTransRotScale=function(x$b,x$_,x$s){var x$h=x$r._tempMatrix4x4;return this.decomposeTransRotMatScale(x$b,x$h,x$s)?(x$s_.createFromMatrix4x4(x$h,x$_),!0):(x$_.identity(),!1)},x$b.decomposeTransRotMatScale=function(x$b,x$_,x$s){var x$h=this.elements,x$x=x$b.elements,x$n=x$_.elements,x$E=x$s.elements;x$x[0]=x$h[12],x$x[1]=x$h[13],x$x[2]=x$h[14];var x$C=x$h[0],x$O=x$h[1],x$L=x$h[2],x$f=x$h[4],x$p=x$h[5],x$P=x$h[6],x$V=x$h[8],x$Q=x$h[9],x$y=x$h[10],x$w=x$E[0]=Math.sqrt(x$C*x$C+x$O*x$O+x$L*x$L),x$i=x$E[1]=Math.sqrt(x$f*x$f+x$p*x$p+x$P*x$P),x$R=x$E[2]=Math.sqrt(x$V*x$V+x$Q*x$Q+x$y*x$y);if(x$Hb.isZero(x$w)||x$Hb.isZero(x$i)||x$Hb.isZero(x$R))return x$n[1]=x$n[2]=x$n[3]=x$n[4]=x$n[6]=x$n[7]=x$n[8]=x$n[9]=x$n[11]=x$n[12]=x$n[13]=x$n[14]=0,x$n[0]=x$n[5]=x$n[10]=x$n[15]=1,!1;var x$t=x$r._tempVector0,x$c=x$t.elements;x$c[0]=x$V/x$R,x$c[1]=x$Q/x$R,x$c[2]=x$y/x$R;var x$$=x$r._tempVector1,x$D=x$$.elements;x$D[0]=x$C/x$w,x$D[1]=x$O/x$w,x$D[2]=x$L/x$w;var x$o=x$r._tempVector2;x$E_.cross(x$t,x$$,x$o);var x$M=x$r._tempVector1;return x$E_.cross(x$o,x$t,x$M),x$n[3]=x$n[7]=x$n[11]=x$n[12]=x$n[13]=x$n[14]=0,x$n[15]=1,x$n[0]=x$M.x,x$n[1]=x$M.y,x$n[2]=x$M.z,x$n[4]=x$o.x,x$n[5]=x$o.y,x$n[6]=x$o.z,x$n[8]=x$t.x,x$n[9]=x$t.y,x$n[10]=x$t.z,x$n[0]*x$C+x$n[1]*x$O+x$n[2]*x$L<0&&(x$E[0]=-x$w),x$n[4]*x$f+x$n[5]*x$p+x$n[6]*x$P<0&&(x$E[1]=-x$i),x$n[8]*x$V+x$n[9]*x$Q+x$n[10]*x$y<0&&(x$E[2]=-x$R),!0},x$b.decomposeYawPitchRoll=function(x$b){var x$_=x$b.elements,x$s=Math.asin(-this.elements[9]);x$_[1]=x$s,Math.cos(x$s)>x$Hb.zeroTolerance?(x$_[2]=Math.atan2(this.elements[1],this.elements[5]),x$_[0]=Math.atan2(this.elements[8],this.elements[10])):(x$_[2]=Math.atan2(-this.elements[4],this.elements[0]),x$_[0]=0)},x$b.normalize=function(){var x$b=this.elements,x$_=x$b[0],x$s=x$b[1],x$h=x$b[2],x$x=Math.sqrt(x$_*x$_+x$s*x$s+x$h*x$h);if(!x$x)return x$b[0]=0,x$b[1]=0,void(x$b[2]=0);1!=x$x&&(x$x=1/x$x,x$b[0]=x$_*x$x,x$b[1]=x$s*x$x,x$b[2]=x$h*x$x)},x$b.transpose=function(){var x$b,x$_;return x$_=(x$b=this.elements)[1],x$b[1]=x$b[4],x$b[4]=x$_,x$_=x$b[2],x$b[2]=x$b[8],x$b[8]=x$_,x$_=x$b[3],x$b[3]=x$b[12],x$b[12]=x$_,x$_=x$b[6],x$b[6]=x$b[9],x$b[9]=x$_,x$_=x$b[7],x$b[7]=x$b[13],x$b[13]=x$_,x$_=x$b[11],x$b[11]=x$b[14],x$b[14]=x$_,this},x$b.invert=function(x$b){var x$_=this.elements,x$s=x$b.elements,x$h=x$_[0],x$x=x$_[1],x$n=x$_[2],x$E=x$_[3],x$C=x$_[4],x$O=x$_[5],x$L=x$_[6],x$f=x$_[7],x$p=x$_[8],x$P=x$_[9],x$V=x$_[10],x$Q=x$_[11],x$y=x$_[12],x$w=x$_[13],x$i=x$_[14],x$R=x$_[15],x$t=x$h*x$O-x$x*x$C,x$c=x$h*x$L-x$n*x$C,x$$=x$h*x$f-x$E*x$C,x$D=x$x*x$L-x$n*x$O,x$o=x$x*x$f-x$E*x$O,x$M=x$n*x$f-x$E*x$L,x$r=x$p*x$w-x$P*x$y,x$k=x$p*x$i-x$V*x$y,x$B=x$p*x$R-x$Q*x$y,x$S=x$P*x$i-x$V*x$w,x$Z=x$P*x$R-x$Q*x$w,x$J=x$V*x$R-x$Q*x$i,x$W=x$t*x$J-x$c*x$Z+x$$*x$S+x$D*x$B-x$o*x$k+x$M*x$r;0!==Math.abs(x$W)&&(x$W=1/x$W,x$s[0]=(x$O*x$J-x$L*x$Z+x$f*x$S)*x$W,x$s[1]=(x$n*x$Z-x$x*x$J-x$E*x$S)*x$W,x$s[2]=(x$w*x$M-x$i*x$o+x$R*x$D)*x$W,x$s[3]=(x$V*x$o-x$P*x$M-x$Q*x$D)*x$W,x$s[4]=(x$L*x$B-x$C*x$J-x$f*x$k)*x$W,x$s[5]=(x$h*x$J-x$n*x$B+x$E*x$k)*x$W,x$s[6]=(x$i*x$$-x$y*x$M-x$R*x$c)*x$W,x$s[7]=(x$p*x$M-x$V*x$$+x$Q*x$c)*x$W,x$s[8]=(x$C*x$Z-x$O*x$B+x$f*x$r)*x$W,x$s[9]=(x$x*x$B-x$h*x$Z-x$E*x$r)*x$W,x$s[10]=(x$y*x$o-x$w*x$$+x$R*x$t)*x$W,x$s[11]=(x$P*x$$-x$p*x$o-x$Q*x$t)*x$W,x$s[12]=(x$O*x$k-x$C*x$S-x$L*x$r)*x$W,x$s[13]=(x$h*x$S-x$x*x$k+x$n*x$r)*x$W,x$s[14]=(x$w*x$c-x$y*x$D-x$i*x$t)*x$W,x$s[15]=(x$p*x$D-x$P*x$c+x$V*x$t)*x$W)},x$b.identity=function(){var x$b=this.elements;x$b[1]=x$b[2]=x$b[3]=x$b[4]=x$b[6]=x$b[7]=x$b[8]=x$b[9]=x$b[11]=x$b[12]=x$b[13]=x$b[14]=0,x$b[0]=x$b[5]=x$b[10]=x$b[15]=1},x$b.cloneTo=function(x$b){var x$_,x$s,x$h;if((x$s=this.elements)!==(x$h=x$b.elements))for(x$_=0;x$_<16;++x$_)x$h[x$_]=x$s[x$_]},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$b.getTranslationVector=function(x$b){var x$_=this.elements,x$s=x$b.elements;x$s[0]=x$_[12],x$s[1]=x$_[13],x$s[2]=x$_[14]},x$b.setTranslationVector=function(x$b){var x$_=this.elements,x$s=x$b.elements;x$_[12]=x$s[0],x$_[13]=x$s[1],x$_[14]=x$s[2]},x$b.getForward=function(x$b){var x$_=this.elements,x$s=x$b.elements;x$s[0]=-x$_[8],x$s[1]=-x$_[9],x$s[2]=-x$_[10]},x$b.setForward=function(x$b){var x$_=this.elements,x$s=x$b.elements;x$_[8]=-x$s[0],x$_[9]=-x$s[1],x$_[10]=-x$s[2]},x$r.createRotationX=function(x$b,x$_){var x$s=x$_.elements,x$h=Math.sin(x$b),x$x=Math.cos(x$b);x$s[1]=x$s[2]=x$s[3]=x$s[4]=x$s[7]=x$s[8]=x$s[11]=x$s[12]=x$s[13]=x$s[14]=0,x$s[0]=x$s[15]=1,x$s[5]=x$s[10]=x$x,x$s[6]=x$h,x$s[9]=-x$h},x$r.createRotationY=function(x$b,x$_){var x$s=x$_.elements,x$h=Math.sin(x$b),x$x=Math.cos(x$b);x$s[1]=x$s[3]=x$s[4]=x$s[6]=x$s[7]=x$s[9]=x$s[11]=x$s[12]=x$s[13]=x$s[14]=0,x$s[5]=x$s[15]=1,x$s[0]=x$s[10]=x$x,x$s[2]=-x$h,x$s[8]=x$h},x$r.createRotationZ=function(x$b,x$_){var x$s=x$_.elements,x$h=Math.sin(x$b),x$x=Math.cos(x$b);x$s[2]=x$s[3]=x$s[6]=x$s[7]=x$s[8]=x$s[9]=x$s[11]=x$s[12]=x$s[13]=x$s[14]=0,x$s[10]=x$s[15]=1,x$s[0]=x$s[5]=x$x,x$s[1]=x$h,x$s[4]=-x$h},x$r.createRotationYawPitchRoll=function(x$b,x$_,x$s,x$h){x$s_.createFromYawPitchRoll(x$b,x$_,x$s,x$r._tempQuaternion),x$r.createRotationQuaternion(x$r._tempQuaternion,x$h)},x$r.createRotationAxis=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=Math.cos(x$_),x$O=Math.sin(x$_),x$L=x$x*x$x,x$f=x$n*x$n,x$p=x$E*x$E,x$P=x$x*x$n,x$V=x$x*x$E,x$Q=x$n*x$E,x$y=x$s.elements;x$y[3]=x$y[7]=x$y[11]=x$y[12]=x$y[13]=x$y[14]=0,x$y[15]=1,x$y[0]=x$L+x$C*(1-x$L),x$y[1]=x$P-x$C*x$P+x$O*x$E,x$y[2]=x$V-x$C*x$V-x$O*x$n,x$y[4]=x$P-x$C*x$P-x$O*x$E,x$y[5]=x$f+x$C*(1-x$f),x$y[6]=x$Q-x$C*x$Q+x$O*x$x,x$y[8]=x$V-x$C*x$V+x$O*x$n,x$y[9]=x$Q-x$C*x$Q-x$O*x$x,x$y[10]=x$p+x$C*(1-x$p)},x$r.createRotationQuaternion=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0],x$n=x$s[1],x$E=x$s[2],x$C=x$s[3],x$O=x$x*x$x,x$L=x$n*x$n,x$f=x$E*x$E,x$p=x$x*x$n,x$P=x$E*x$C,x$V=x$E*x$x,x$Q=x$n*x$C,x$y=x$n*x$E,x$w=x$x*x$C;x$h[3]=x$h[7]=x$h[11]=x$h[12]=x$h[13]=x$h[14]=0,x$h[15]=1,x$h[0]=1-2*(x$L+x$f),x$h[1]=2*(x$p+x$P),x$h[2]=2*(x$V-x$Q),x$h[4]=2*(x$p-x$P),x$h[5]=1-2*(x$f+x$O),x$h[6]=2*(x$y+x$w),x$h[8]=2*(x$V+x$Q),x$h[9]=2*(x$y-x$w),x$h[10]=1-2*(x$L+x$O)},x$r.createTranslate=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;x$h[4]=x$h[8]=x$h[1]=x$h[9]=x$h[2]=x$h[6]=x$h[3]=x$h[7]=x$h[11]=0,x$h[0]=x$h[5]=x$h[10]=x$h[15]=1,x$h[12]=x$s[0],x$h[13]=x$s[1],x$h[14]=x$s[2]},x$r.createScaling=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;x$h[0]=x$s[0],x$h[5]=x$s[1],x$h[10]=x$s[2],x$h[1]=x$h[4]=x$h[8]=x$h[12]=x$h[9]=x$h[13]=x$h[2]=x$h[6]=x$h[14]=x$h[3]=x$h[7]=x$h[11]=0,x$h[15]=1},x$r.multiply=function(x$b,x$_,x$s){var x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f;for(x$x=x$s.elements,x$n=x$b.elements,x$x===(x$E=x$_.elements)&&(x$E=x$E.slice()),x$h=0;x$h<4;x$h++)x$C=x$n[x$h],x$O=x$n[x$h+4],x$L=x$n[x$h+8],x$f=x$n[x$h+12],x$x[x$h]=x$C*x$E[0]+x$O*x$E[1]+x$L*x$E[2]+x$f*x$E[3],x$x[x$h+4]=x$C*x$E[4]+x$O*x$E[5]+x$L*x$E[6]+x$f*x$E[7],x$x[x$h+8]=x$C*x$E[8]+x$O*x$E[9]+x$L*x$E[10]+x$f*x$E[11],x$x[x$h+12]=x$C*x$E[12]+x$O*x$E[13]+x$L*x$E[14]+x$f*x$E[15]},x$r.createFromQuaternion=function(x$b,x$_){var x$s=x$_.elements,x$h=x$b.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=x$x+x$x,x$L=x$n+x$n,x$f=x$E+x$E,x$p=x$x*x$O,x$P=x$n*x$O,x$V=x$n*x$L,x$Q=x$E*x$O,x$y=x$E*x$L,x$w=x$E*x$f,x$i=x$C*x$O,x$R=x$C*x$L,x$t=x$C*x$f;x$s[0]=1-x$V-x$w,x$s[1]=x$P+x$t,x$s[2]=x$Q-x$R,x$s[3]=0,x$s[4]=x$P-x$t,x$s[5]=1-x$p-x$w,x$s[6]=x$y+x$i,x$s[7]=0,x$s[8]=x$Q+x$R,x$s[9]=x$y-x$i,x$s[10]=1-x$p-x$V,x$s[11]=0,x$s[12]=0,x$s[13]=0,x$s[14]=0,x$s[15]=1},x$r.createAffineTransformation=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements,x$n=x$_.elements,x$E=x$s.elements,x$C=x$h.elements,x$O=x$n[0],x$L=x$n[1],x$f=x$n[2],x$p=x$n[3],x$P=x$O+x$O,x$V=x$L+x$L,x$Q=x$f+x$f,x$y=x$O*x$P,x$w=x$O*x$V,x$i=x$O*x$Q,x$R=x$L*x$V,x$t=x$L*x$Q,x$c=x$f*x$Q,x$$=x$p*x$P,x$D=x$p*x$V,x$o=x$p*x$Q,x$M=x$E[0],x$r=x$E[1],x$k=x$E[2];x$C[0]=(1-(x$R+x$c))*x$M,x$C[1]=(x$w+x$o)*x$M,x$C[2]=(x$i-x$D)*x$M,x$C[3]=0,x$C[4]=(x$w-x$o)*x$r,x$C[5]=(1-(x$y+x$c))*x$r,x$C[6]=(x$t+x$$)*x$r,x$C[7]=0,x$C[8]=(x$i+x$D)*x$k,x$C[9]=(x$t-x$$)*x$k,x$C[10]=(1-(x$y+x$R))*x$k,x$C[11]=0,x$C[12]=x$x[0],x$C[13]=x$x[1],x$C[14]=x$x[2],x$C[15]=1},x$r.createLookAt=function(x$b,x$_,x$s,x$h){var x$x=x$h.elements,x$n=x$r._tempVector0,x$E=x$r._tempVector1,x$C=x$r._tempVector2;x$E_.subtract(x$b,x$_,x$C),x$E_.normalize(x$C,x$C),x$E_.cross(x$s,x$C,x$n),x$E_.normalize(x$n,x$n),x$E_.cross(x$C,x$n,x$E),x$h.identity(),x$x[0]=x$n.x,x$x[4]=x$n.y,x$x[8]=x$n.z,x$x[1]=x$E.x,x$x[5]=x$E.y,x$x[9]=x$E.z,x$x[2]=x$C.x,x$x[6]=x$C.y,x$x[10]=x$C.z,x$x[12]=-x$E_.dot(x$n,x$b),x$x[13]=-x$E_.dot(x$E,x$b),x$x[14]=-x$E_.dot(x$C,x$b)},x$r.createPerspective=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$x.elements,x$E=1/Math.tan(x$b/2),x$C=1/(x$s-x$h);x$n[0]=x$E/x$_,x$n[5]=x$E,x$n[10]=(x$h+x$s)*x$C,x$n[11]=-1,x$n[14]=2*x$h*x$s*x$C,x$n[1]=x$n[2]=x$n[3]=x$n[4]=x$n[6]=x$n[7]=x$n[8]=x$n[9]=x$n[12]=x$n[13]=x$n[15]=0},x$r.createOrthoOffCenterRH=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C=x$E.elements,x$O=1/(x$b-x$_),x$L=1/(x$s-x$h),x$f=1/(x$x-x$n);x$C[1]=x$C[2]=x$C[3]=x$C[4]=x$C[6]=x$C[7]=x$C[8]=x$C[9]=x$C[11]=0,x$C[15]=1,x$C[0]=-2*x$O,x$C[5]=-2*x$L,x$C[10]=2*x$f,x$C[12]=(x$b+x$_)*x$O,x$C[13]=(x$h+x$s)*x$L,x$C[14]=(x$n+x$x)*x$f},x$r.translation=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;x$h[0]=x$h[5]=x$h[10]=x$h[15]=1,x$h[12]=x$s[0],x$h[13]=x$s[1],x$h[14]=x$s[2]},x$p(x$r,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new x$r},"_tempVector0",function(){return this._tempVector0=new x$E_},"_tempVector1",function(){return this._tempVector1=new x$E_},"_tempVector2",function(){return this._tempVector2=new x$E_},"_tempQuaternion",function(){return this._tempQuaternion=new x$s_},"DEFAULT",function(){return this.DEFAULT=new x$r},"ZERO",function(){return this.ZERO=new x$r(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),x$r}(),x$__=(function(){function x$t(x$b,x$_){this.extents=null,this.transformation=null,this.extents=x$b,this.transformation=x$_}x$V(x$t,"laya.d3.math.OrientedBoundBox");var x$b=x$t.prototype;x$b.getCorners=function(x$b){var x$_=x$t._tempV30.elements,x$s=x$t._tempV31.elements,x$h=x$t._tempV32.elements,x$x=this.extents.elements;x$_[0]=x$x[0],x$_[1]=x$_[2]=0,x$s[1]=x$x[1],x$s[0]=x$s[2]=0,x$h[2]=x$x[2],x$h[0]=x$h[1]=0,x$E_.TransformNormal(x$t._tempV30,this.transformation,x$t._tempV30),x$E_.TransformNormal(x$t._tempV31,this.transformation,x$t._tempV31),x$E_.TransformNormal(x$t._tempV32,this.transformation,x$t._tempV32);var x$n=x$t._tempV33;this.transformation.getTranslationVector(x$n),x$b.length=8,x$E_.add(x$n,x$t._tempV30,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV32,x$b[0]),x$E_.add(x$n,x$t._tempV30,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV32,x$b[1]),x$E_.subtract(x$n,x$t._tempV30,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV32,x$b[2]),x$E_.subtract(x$n,x$t._tempV30,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV32,x$b[3]),x$E_.add(x$n,x$t._tempV30,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV32,x$b[4]),x$E_.add(x$n,x$t._tempV30,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV32,x$b[5]),x$E_.subtract(x$n,x$t._tempV30,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV32,x$b[6]),x$E_.subtract(x$n,x$t._tempV30,x$t._tempV34),x$E_.subtract(x$t._tempV34,x$t._tempV31,x$t._tempV34),x$E_.add(x$t._tempV34,x$t._tempV32,x$b[7])},x$b.transform=function(x$b){x$b_.multiply(this.transformation,x$b,this.transformation)},x$b.scale=function(x$b){x$E_.multiply(this.extents,x$b,this.extents)},x$b.translate=function(x$b){this.transformation.getTranslationVector(x$t._tempV30),x$E_.add(x$t._tempV30,x$b,x$t._tempV31),this.transformation.setTranslationVector(x$t._tempV31)},x$b.Size=function(x$b){x$E_.scale(this.extents,2,x$b)},x$b.getSize=function(x$b){var x$_=this.extents.elements;x$t._tempV30.x=x$_[0],x$t._tempV31.y=x$_[1],x$t._tempV32.z=x$_[2],x$E_.TransformNormal(x$t._tempV30,this.transformation,x$t._tempV30),x$E_.TransformNormal(x$t._tempV31,this.transformation,x$t._tempV31),x$E_.TransformNormal(x$t._tempV31,this.transformation,x$t._tempV32);var x$s=x$b.elements;x$s[0]=x$E_.scalarLength(x$t._tempV30),x$s[1]=x$E_.scalarLength(x$t._tempV31),x$s[2]=x$E_.scalarLength(x$t._tempV32)},x$b.getSizeSquared=function(x$b){var x$_=this.extents.elements;x$t._tempV30.x=x$_[0],x$t._tempV31.y=x$_[1],x$t._tempV32.z=x$_[2],x$E_.TransformNormal(x$t._tempV30,this.transformation,x$t._tempV30),x$E_.TransformNormal(x$t._tempV31,this.transformation,x$t._tempV31),x$E_.TransformNormal(x$t._tempV31,this.transformation,x$t._tempV32);var x$s=x$b.elements;x$s[0]=x$E_.scalarLengthSquared(x$t._tempV30),x$s[1]=x$E_.scalarLengthSquared(x$t._tempV31),x$s[2]=x$E_.scalarLengthSquared(x$t._tempV32)},x$b.getCenter=function(x$b){this.transformation.getTranslationVector(x$b)},x$b.containsPoint=function(x$b){var x$_=this.extents.elements,x$s=x$_[0],x$h=x$_[1],x$x=x$_[2];this.transformation.invert(x$t._tempM0),x$E_.transformCoordinate(x$b,x$t._tempM0,x$t._tempV30);var x$n=x$t._tempV30.elements,x$E=Math.abs(x$n[0]),x$C=Math.abs(x$n[1]),x$O=Math.abs(x$n[2]);return x$Hb.nearEqual(x$E,x$s)&&x$Hb.nearEqual(x$C,x$h)&&x$Hb.nearEqual(x$O,x$x)?2:x$E<x$s&&x$C<x$h&&x$O<x$x?1:0},x$b.containsPoints=function(x$b){var x$_=this.extents.elements,x$s=x$_[0],x$h=x$_[1],x$x=x$_[2];this.transformation.invert(x$t._tempM0);for(var x$n=!0,x$E=!1,x$C=0;x$C<x$b.length;x$C++){x$E_.transformCoordinate(x$b[x$C],x$t._tempM0,x$t._tempV30);var x$O=x$t._tempV30.elements,x$L=Math.abs(x$O[0]),x$f=Math.abs(x$O[1]),x$p=Math.abs(x$O[2]);x$Hb.nearEqual(x$L,x$s)&&x$Hb.nearEqual(x$f,x$h)&&x$Hb.nearEqual(x$p,x$x)&&(x$E=!0),x$L<x$s&&x$f<x$h&&x$p<x$x?x$E=!0:x$n=!1}return x$n?1:x$E?2:0},x$b.containsSphere=function(x$b,x$_){void 0===x$_&&(x$_=!1);var x$s=this.extents.elements,x$h=x$s[0],x$x=x$s[1],x$n=x$s[2],x$E=x$b.radius;this.transformation.invert(x$t._tempM0),x$E_.transformCoordinate(x$b.center,x$t._tempM0,x$t._tempV30);var x$C=NaN;if(x$C=x$_?x$E:(x$E_.scale(x$E_.UnitX,x$E,x$t._tempV31),x$E_.TransformNormal(x$t._tempV31,x$t._tempM0,x$t._tempV31),x$E_.scalarLength(x$t._tempV31)),x$E_.scale(this.extents,-1,x$t._tempV32),x$E_.Clamp(x$t._tempV30,x$t._tempV32,this.extents,x$t._tempV33),x$C*x$C<x$E_.distanceSquared(x$t._tempV30,x$t._tempV33))return 0;var x$O=x$t._tempV30.elements,x$L=x$O[0],x$f=x$O[1],x$p=x$O[2],x$P=x$t._tempV32.elements,x$V=x$P[0],x$Q=x$P[1],x$y=x$P[2];return x$V+x$C<=x$L&&x$L<=x$h-x$C&&x$C<x$h-x$V&&x$Q+x$C<=x$f&&x$f<=x$x-x$C&&x$C<x$x-x$Q&&x$y+x$C<=x$p&&x$p<=x$n-x$C&&x$C<x$n-x$y?1:2},x$b.containsOrientedBoundBox=function(x$b){var x$_=0,x$s=0;x$b.getCorners(x$t._corners);var x$h=this.containsPoints(x$t._corners);if(0!=x$h)return x$h;var x$x=this.extents.elements;x$b.extents.cloneTo(x$t._tempV35);var x$n=x$t._tempV35.elements;x$t._getRows(this.transformation,x$t._rows1),x$t._getRows(x$b.transformation,x$t._rows2);var x$E=NaN;for(x$_=0;x$_<4;x$_++)for(x$s=0;x$s<4;x$s++)3==x$_||3==x$s?(x$t._tempM0.setElementByRowColumn(x$_,x$s,0),x$t._tempM1.setElementByRowColumn(x$_,x$s,0)):(x$E=x$E_.dot(x$t._rows1[x$_],x$t._rows2[x$s]),x$t._tempM0.setElementByRowColumn(x$_,x$s,x$E),x$t._tempM1.setElementByRowColumn(x$_,x$s,Math.abs(x$E)));x$b.getCenter(x$t._tempV34),this.getCenter(x$t._tempV36),x$E_.subtract(x$t._tempV34,x$t._tempV36,x$t._tempV30);var x$C=x$t._tempV31.elements;x$C[0]=x$E_.dot(x$t._tempV30,x$t._rows1[0]),x$C[1]=x$E_.dot(x$t._tempV30,x$t._rows1[1]),x$C[2]=x$E_.dot(x$t._tempV30,x$t._rows1[2]);var x$O=x$t._tempV32.elements,x$L=x$t._tempV33.elements;for(x$_=0;x$_<3;x$_++)if(x$O[0]=x$t._tempM1.getElementByRowColumn(x$_,0),x$O[1]=x$t._tempM1.getElementByRowColumn(x$_,1),x$O[2]=x$t._tempM1.getElementByRowColumn(x$_,2),x$x[x$_]+x$E_.dot(x$t._tempV35,x$t._tempV32)<Math.abs(x$C[x$_]))return 0;for(x$s=0;x$s<3;x$s++)if(x$O[0]=x$t._tempM1.getElementByRowColumn(0,x$s),x$O[1]=x$t._tempM1.getElementByRowColumn(1,x$s),x$O[2]=x$t._tempM1.getElementByRowColumn(2,x$s),x$L[0]=x$t._tempM0.getElementByRowColumn(0,x$s),x$L[1]=x$t._tempM0.getElementByRowColumn(1,x$s),x$L[2]=x$t._tempM0.getElementByRowColumn(2,x$s),x$E_.dot(this.extents,x$t._tempV32)+x$n[x$s]<Math.abs(x$E_.dot(x$t._tempV31,x$t._tempV33)))return 0;for(x$_=0;x$_<3;x$_++)for(x$s=0;x$s<3;x$s++){var x$f=(x$_+1)%3,x$p=(x$_+2)%3,x$P=(x$s+1)%3,x$V=(x$s+2)%3;if(x$x[x$f]*x$t._tempM1.getElementByRowColumn(x$p,x$s)+x$x[x$p]*x$t._tempM1.getElementByRowColumn(x$f,x$s)+(x$n[x$P]*x$t._tempM1.getElementByRowColumn(x$_,x$V)+x$n[x$V]*x$t._tempM1.getElementByRowColumn(x$_,x$P))<Math.abs(x$C[x$p]*x$t._tempM0.getElementByRowColumn(x$f,x$s)-x$C[x$f]*x$t._tempM0.getElementByRowColumn(x$p,x$s)))return 0}return 2},x$b.containsLine=function(x$b,x$_){x$t._corners[0]=x$b,x$t._corners[1]=x$_;var x$s=this.containsPoints(x$t._corners);if(0!=x$s)return x$s;var x$h=this.extents.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2];this.transformation.invert(x$t._tempM0),x$E_.transformCoordinate(x$b,x$t._tempM0,x$t._tempV30),x$E_.transformCoordinate(x$_,x$t._tempM0,x$t._tempV31),x$E_.add(x$t._tempV30,x$t._tempV31,x$t._tempV32),x$E_.scale(x$t._tempV32,.5,x$t._tempV32),x$E_.subtract(x$t._tempV30,x$t._tempV32,x$t._tempV33);var x$C=x$t._tempV33.elements,x$O=x$C[0],x$L=x$C[1],x$f=x$C[2],x$p=x$t._tempV34.elements,x$P=x$p[0]=Math.abs(x$C[0]),x$V=x$p[1]=Math.abs(x$C[1]),x$Q=x$p[2]=Math.abs(x$C[2]),x$y=x$t._tempV32.elements,x$w=x$y[0],x$i=x$y[1],x$R=x$y[2];return Math.abs(x$w)>x$x+x$P?0:Math.abs(x$i)>x$n+x$V?0:Math.abs(x$R)>x$E+x$Q?0:Math.abs(x$i*x$f-x$R*x$L)>x$n*x$Q+x$E*x$V?0:Math.abs(x$w*x$f-x$R*x$O)>x$x*x$Q+x$E*x$P?0:Math.abs(x$w*x$L-x$i*x$O)>x$x*x$V+x$n*x$P?0:2},x$b.containsBoundBox=function(x$b){var x$_=0,x$s=0,x$h=x$b.min,x$x=x$b.max;x$b.getCorners(x$t._corners);var x$n=this.containsPoints(x$t._corners);if(0!=x$n)return x$n;x$E_.subtract(x$x,x$h,x$t._tempV30),x$E_.scale(x$t._tempV30,.5,x$t._tempV30),x$E_.add(x$h,x$t._tempV30,x$t._tempV30),x$E_.subtract(x$x,x$t._tempV30,x$t._tempV31);var x$E=this.extents.elements,x$C=x$t._tempV31.elements;x$t._getRows(this.transformation,x$t._rows1),this.transformation.invert(x$t._tempM0);for(x$_=0;x$_<3;x$_++)for(x$s=0;x$s<3;x$s++)x$t._tempM1.setElementByRowColumn(x$_,x$s,Math.abs(x$t._tempM0.getElementByRowColumn(x$_,x$s)));this.getCenter(x$t._tempV35),x$E_.subtract(x$t._tempV30,x$t._tempV35,x$t._tempV32);var x$O=x$t._tempV31.elements;x$O[0]=x$E_.dot(x$t._tempV32,x$t._rows1[0]),x$O[1]=x$E_.dot(x$t._tempV32,x$t._rows1[1]),x$O[2]=x$E_.dot(x$t._tempV32,x$t._rows1[2]);var x$L=x$t._tempV33.elements,x$f=x$t._tempV34.elements;for(x$_=0;x$_<3;x$_++)if(x$L[0]=x$t._tempM1.getElementByRowColumn(x$_,0),x$L[1]=x$t._tempM1.getElementByRowColumn(x$_,1),x$L[2]=x$t._tempM1.getElementByRowColumn(x$_,2),x$E[x$_]+x$E_.dot(x$t._tempV31,x$t._tempV33)<Math.abs(x$O[x$_]))return 0;for(x$s=0;x$s<3;x$s++)if(x$L[0]=x$t._tempM1.getElementByRowColumn(0,x$s),x$L[1]=x$t._tempM1.getElementByRowColumn(1,x$s),x$L[2]=x$t._tempM1.getElementByRowColumn(2,x$s),x$f[0]=x$t._tempM0.getElementByRowColumn(0,x$s),x$f[1]=x$t._tempM0.getElementByRowColumn(1,x$s),x$f[2]=x$t._tempM0.getElementByRowColumn(2,x$s),x$E_.dot(this.extents,x$t._tempV33)+x$C[x$s]<Math.abs(x$E_.dot(x$t._tempV31,x$t._tempV34)))return 0;for(x$_=0;x$_<3;x$_++)for(x$s=0;x$s<3;x$s++){var x$p=(x$_+1)%3,x$P=(x$_+2)%3,x$V=(x$s+1)%3,x$Q=(x$s+2)%3;if(x$E[x$p]*x$t._tempM1.getElementByRowColumn(x$P,x$s)+x$E[x$P]*x$t._tempM1.getElementByRowColumn(x$p,x$s)+(x$C[x$V]*x$t._tempM1.getElementByRowColumn(x$_,x$Q)+x$C[x$Q]*x$t._tempM1.getElementByRowColumn(x$_,x$V))<Math.abs(x$O[x$P]*x$t._tempM0.getElementByRowColumn(x$p,x$s)-x$O[x$p]*x$t._tempM0.getElementByRowColumn(x$P,x$s)))return 0}return 2},x$b.intersectsRay=function(x$b,x$_){x$E_.scale(this.extents,-1,x$t._tempV30),this.transformation.invert(x$t._tempM0),x$E_.TransformNormal(x$b.direction,x$t._tempM0,x$t._ray.direction),x$E_.transformCoordinate(x$b.origin,x$t._tempM0,x$t._ray.origin),x$t._boxBound1.min=x$t._tempV30,x$t._boxBound1.max=this.extents;var x$s=Collision.intersectsRayAndBoxRP(x$t._ray,x$t._boxBound1,x$_);return-1!==x$s&&x$E_.transformCoordinate(x$_,this.transformation,x$_),x$s},x$b._getLocalCorners=function(x$b){x$b.length=8;var x$_=this.extents.elements;x$t._tempV30.x=x$_[0],x$t._tempV31.y=x$_[1],x$t._tempV32.z=x$_[2],x$E_.add(x$t._tempV30,x$t._tempV31,x$t._tempV33),x$E_.add(x$t._tempV33,x$t._tempV32,x$b[0]),x$E_.add(x$t._tempV30,x$t._tempV31,x$t._tempV33),x$E_.subtract(x$t._tempV33,x$t._tempV32,x$b[1]),x$E_.subtract(x$t._tempV31,x$t._tempV30,x$t._tempV33),x$E_.subtract(x$t._tempV33,x$t._tempV30,x$b[2]),x$E_.subtract(x$t._tempV31,x$t._tempV30,x$t._tempV33),x$E_.add(x$t._tempV33,x$t._tempV32,x$b[3]),x$E_.subtract(x$t._tempV30,x$t._tempV31,x$t._tempV33),x$E_.add(x$t._tempV33,x$t._tempV32,x$b[4]),x$E_.subtract(x$t._tempV30,x$t._tempV31,x$t._tempV33),x$E_.subtract(x$t._tempV33,x$t._tempV32,x$b[5]),x$E_.scale(x$b[0],-1,x$b[6]),x$E_.subtract(x$t._tempV32,x$t._tempV30,x$t._tempV33),x$E_.subtract(x$t._tempV33,x$t._tempV31,x$b[7])},x$b.equals=function(x$b){return this.extents==x$b.extents&&this.transformation==x$b.transformation},x$b.cloneTo=function(x$b){var x$_=x$b;this.extents.cloneTo(x$_.extents),this.transformation.cloneTo(x$_.transformation)},x$t.createByBoundBox=function(x$b,x$_){var x$s=x$b.min,x$h=x$b.max;x$E_.subtract(x$h,x$s,x$t._tempV30),x$E_.scale(x$t._tempV30,.5,x$t._tempV30),x$E_.add(x$s,x$t._tempV30,x$t._tempV31),x$E_.subtract(x$h,x$t._tempV31,x$t._tempV32),x$b_.translation(x$t._tempV31,x$t._tempM0);var x$x=x$t._tempV32.clone(),x$n=x$t._tempM0.clone();x$_.extents=x$x,x$_.transformation=x$n},x$t.createByMinAndMaxVertex=function(x$b,x$_){return x$E_.subtract(x$_,x$b,x$t._tempV30),x$E_.scale(x$t._tempV30,.5,x$t._tempV30),x$E_.add(x$b,x$t._tempV30,x$t._tempV31),x$E_.subtract(x$_,x$t._tempV31,x$t._tempV32),x$b_.translation(x$t._tempV31,x$t._tempM0),new x$t(x$t._tempV32,x$t._tempM0)},x$t._getRows=function(x$b,x$_){x$_.length=3;var x$s=x$b.elements,x$h=x$_[0].elements;x$h[0]=x$s[0],x$h[1]=x$s[1],x$h[2]=x$s[2];var x$x=x$_[1].elements;x$x[0]=x$s[4],x$x[1]=x$s[5],x$x[2]=x$s[6];var x$n=x$_[2].elements;x$n[0]=x$s[8],x$n[1]=x$s[9],x$n[2]=x$s[10]},x$t.getObbtoObbMatrix4x4=function(x$b,x$_,x$s,x$h){var x$x=x$b.transformation,x$n=x$_.transformation;if(x$s){x$t._getRows(x$x,x$t._rows1),x$t._getRows(x$n,x$t._rows2);for(var x$E=0;x$E<3;x$E++)for(var x$C=0;x$C<3;x$C++)x$h.setElementByRowColumn(x$E,x$C,x$E_.dot(x$t._rows2[x$E],x$t._rows1[x$C]));x$_.getCenter(x$t._tempV30),x$b.getCenter(x$t._tempV31),x$E_.subtract(x$t._tempV30,x$t._tempV31,x$t._tempV32);var x$O=x$h.elements;x$O[12]=x$E_.dot(x$t._tempV32,x$t._rows1[0]),x$O[13]=x$E_.dot(x$t._tempV32,x$t._rows1[1]),x$O[14]=x$E_.dot(x$t._tempV32,x$t._rows1[2]),x$O[15]=1}else x$x.invert(x$t._tempM0),x$b_.multiply(x$n,x$t._tempM0,x$h)},x$t.merge=function(x$b,x$_,x$s){var x$h=x$b.extents,x$x=x$b.transformation;x$t.getObbtoObbMatrix4x4(x$b,x$_,x$s,x$t._tempM0),x$_._getLocalCorners(x$t._corners),x$E_.transformCoordinate(x$t._corners[0],x$t._tempM0,x$t._corners[0]),x$E_.transformCoordinate(x$t._corners[1],x$t._tempM0,x$t._corners[1]),x$E_.transformCoordinate(x$t._corners[2],x$t._tempM0,x$t._corners[2]),x$E_.transformCoordinate(x$t._corners[3],x$t._tempM0,x$t._corners[3]),x$E_.transformCoordinate(x$t._corners[4],x$t._tempM0,x$t._corners[4]),x$E_.transformCoordinate(x$t._corners[5],x$t._tempM0,x$t._corners[5]),x$E_.transformCoordinate(x$t._corners[6],x$t._tempM0,x$t._corners[6]),x$E_.transformCoordinate(x$t._corners[7],x$t._tempM0,x$t._corners[7]),x$E_.scale(x$h,-1,x$t._boxBound1.min),x$h.cloneTo(x$t._boxBound1.max),x$mb.createfromPoints(x$t._corners,x$t._boxBound2),x$mb.merge(x$t._boxBound2,x$t._boxBound1,x$t._boxBound3);var x$n=x$t._boxBound3.min,x$E=x$t._boxBound3.max;x$E_.subtract(x$E,x$n,x$t._tempV30),x$E_.scale(x$t._tempV30,.5,x$t._tempV30),x$E_.add(x$n,x$t._tempV30,x$t._tempV32),x$E_.subtract(x$E,x$t._tempV32,x$h),x$E_.transformCoordinate(x$t._tempV32,x$x,x$t._tempV33)},x$p(x$t,["_tempV30",function(){return this._tempV30=new x$E_},"_tempV31",function(){return this._tempV31=new x$E_},"_tempV32",function(){return this._tempV32=new x$E_},"_tempV33",function(){return this._tempV33=new x$E_},"_tempV34",function(){return this._tempV34=new x$E_},"_tempV35",function(){return this._tempV35=new x$E_},"_tempV36",function(){return this._tempV36=new x$E_},"_tempM0",function(){return this._tempM0=new x$b_},"_tempM1",function(){return this._tempM1=new x$b_},"_corners",function(){return this._corners=[new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_]},"_rows1",function(){return this._rows1=[new x$E_,new x$E_,new x$E_]},"_rows2",function(){return this._rows2=[new x$E_,new x$E_,new x$E_]},"_ray",function(){return this._ray=new x$x_(new x$E_,new x$E_)},"_boxBound1",function(){return this._boxBound1=new x$mb(new x$E_,new x$E_)},"_boxBound2",function(){return this._boxBound2=new x$mb(new x$E_,new x$E_)},"_boxBound3",function(){return this._boxBound3=new x$mb(new x$E_,new x$E_)}])}(),function(){function x$$(x$b,x$_){this.normal=null,this.distance=NaN,void 0===x$_&&(x$_=0),this.normal=x$b,this.distance=x$_}return x$V(x$$,"laya.d3.math.Plane"),x$$.prototype.normalize=function(){var x$b=this.normal.elements,x$_=x$b[0],x$s=x$b[1],x$h=x$b[2],x$x=1/Math.sqrt(x$_*x$_+x$s*x$s+x$h*x$h);x$b[0]=x$_*x$x,x$b[1]=x$s*x$x,x$b[2]=x$h*x$x,this.distance*=x$x},x$$.createPlaneBy3P=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$_.elements,x$n=x$s.elements,x$E=x$x[0]-x$h[0],x$C=x$x[1]-x$h[1],x$O=x$x[2]-x$h[2],x$L=x$n[0]-x$h[0],x$f=x$n[1]-x$h[1],x$p=x$n[2]-x$h[2],x$P=x$C*x$p-x$O*x$f,x$V=x$O*x$L-x$E*x$p,x$Q=x$E*x$f-x$C*x$L,x$y=1/Math.sqrt(x$P*x$P+x$V*x$V+x$Q*x$Q),x$w=x$P*x$y,x$i=x$V*x$y,x$R=x$Q*x$y,x$t=x$$._TEMPVec3.elements;x$t[0]=x$w,x$t[1]=x$i,x$t[2]=x$R;var x$c=-(x$w*x$h[0]+x$i*x$h[1]+x$R*x$h[2]);return new x$$(x$$._TEMPVec3,x$c)},x$$.PlaneIntersectionType_Back=0,x$$.PlaneIntersectionType_Front=1,x$$.PlaneIntersectionType_Intersecting=2,x$p(x$$,["_TEMPVec3",function(){return this._TEMPVec3=new x$E_}]),x$$}()),x$s_=function(){function x$x(x$b,x$_,x$s,x$h){this.elements=new Float32Array(4),void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=1),this.elements[0]=x$b,this.elements[1]=x$_,this.elements[2]=x$s,this.elements[3]=x$h}x$V(x$x,"laya.d3.math.Quaternion");var x$b=x$x.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.scaling=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements;x$s[0]=x$h[0]*x$b,x$s[1]=x$h[1]*x$b,x$s[2]=x$h[2]*x$b,x$s[3]=x$h[3]*x$b},x$b.normalize=function(x$b){var x$_=x$b.elements,x$s=this.elements,x$h=x$s[0],x$x=x$s[1],x$n=x$s[2],x$E=x$s[3],x$C=x$h*x$h+x$x*x$x+x$n*x$n+x$E*x$E;0<x$C&&(x$C=1/Math.sqrt(x$C),x$_[0]=x$h*x$C,x$_[1]=x$x*x$C,x$_[2]=x$n*x$C,x$_[3]=x$E*x$C)},x$b.length=function(){var x$b=this.elements,x$_=x$b[0],x$s=x$b[1],x$h=x$b[2],x$x=x$b[3];return Math.sqrt(x$_*x$_+x$s*x$s+x$h*x$h+x$x*x$x)},x$b.rotateX=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements;x$b*=.5;var x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=Math.sin(x$b),x$L=Math.cos(x$b);x$s[0]=x$x*x$L+x$C*x$O,x$s[1]=x$n*x$L+x$E*x$O,x$s[2]=x$E*x$L-x$n*x$O,x$s[3]=x$C*x$L-x$x*x$O},x$b.rotateY=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements;x$b*=.5;var x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=Math.sin(x$b),x$L=Math.cos(x$b);x$s[0]=x$x*x$L-x$E*x$O,x$s[1]=x$n*x$L+x$C*x$O,x$s[2]=x$E*x$L+x$x*x$O,x$s[3]=x$C*x$L-x$n*x$O},x$b.rotateZ=function(x$b,x$_){var x$s=x$_.elements,x$h=this.elements;x$b*=.5;var x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=Math.sin(x$b),x$L=Math.cos(x$b);x$s[0]=x$x*x$L+x$n*x$O,x$s[1]=x$n*x$L-x$x*x$O,x$s[2]=x$E*x$L+x$C*x$O,x$s[3]=x$C*x$L-x$E*x$O},x$b.getYawPitchRoll=function(x$b){x$E_.transformQuat(x$E_.ForwardRH,this,x$x.TEMPVector31),x$E_.transformQuat(x$E_.Up,this,x$x.TEMPVector32);var x$_=x$x.TEMPVector32.elements;x$x.angleTo(x$E_.ZERO,x$x.TEMPVector31,x$x.TEMPVector33);var x$s=x$x.TEMPVector33.elements;x$s[0]==Math.PI/2?(x$s[1]=x$x.arcTanAngle(x$_[2],x$_[0]),x$s[2]=0):x$s[0]==-Math.PI/2?(x$s[1]=x$x.arcTanAngle(-x$_[2],-x$_[0]),x$s[2]=0):(x$b_.createRotationY(-x$s[1],x$x.TEMPMatrix0),x$b_.createRotationX(-x$s[0],x$x.TEMPMatrix1),x$E_.transformCoordinate(x$x.TEMPVector32,x$x.TEMPMatrix0,x$x.TEMPVector32),x$E_.transformCoordinate(x$x.TEMPVector32,x$x.TEMPMatrix1,x$x.TEMPVector32),x$s[2]=x$x.arcTanAngle(x$_[1],-x$_[0])),x$s[1]<=-Math.PI&&(x$s[1]=Math.PI),x$s[2]<=-Math.PI&&(x$s[2]=Math.PI),x$s[1]>=Math.PI&&x$s[2]>=Math.PI&&(x$s[1]=0,x$s[2]=0,x$s[0]=Math.PI-x$s[0]);var x$h=x$b.elements;x$h[0]=x$s[1],x$h[1]=x$s[0],x$h[2]=x$s[2]},x$b.invert=function(x$b){var x$_=x$b.elements,x$s=this.elements,x$h=x$s[0],x$x=x$s[1],x$n=x$s[2],x$E=x$s[3],x$C=x$h*x$h+x$x*x$x+x$n*x$n+x$E*x$E,x$O=x$C?1/x$C:0;x$_[0]=-x$h*x$O,x$_[1]=-x$x*x$O,x$_[2]=-x$n*x$O,x$_[3]=x$E*x$O},x$b.identity=function(){var x$b=this.elements;x$b[0]=0,x$b[1]=0,x$b[2]=0,x$b[3]=1},x$b.fromArray=function(x$b,x$_){void 0===x$_&&(x$_=0),this.elements[0]=x$b[x$_+0],this.elements[1]=x$b[x$_+1],this.elements[2]=x$b[x$_+2],this.elements[3]=x$b[x$_+3]},x$b.cloneTo=function(x$b){var x$_,x$s,x$h;if((x$s=this.elements)!==(x$h=x$b.elements))for(x$_=0;x$_<4;++x$_)x$h[x$_]=x$s[x$_]},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$b.equals=function(x$b){var x$_=this.elements,x$s=x$b.elements;return x$Hb.nearEqual(x$_[0],x$s[0])&&x$Hb.nearEqual(x$_[1],x$s[1])&&x$Hb.nearEqual(x$_[2],x$s[2])&&x$Hb.nearEqual(x$_[3],x$s[3])},x$b.lengthSquared=function(){var x$b=this.elements[0],x$_=this.elements[1],x$s=this.elements[2],x$h=this.elements[3];return x$b*x$b+x$_*x$_+x$s*x$s+x$h*x$h},x$Q(0,x$b,"x",function(){return this.elements[0]}),x$Q(0,x$b,"y",function(){return this.elements[1]}),x$Q(0,x$b,"z",function(){return this.elements[2]}),x$Q(0,x$b,"w",function(){return this.elements[3]}),x$x.createFromYawPitchRoll=function(x$b,x$_,x$s,x$h){var x$x=.5*x$s,x$n=.5*x$_,x$E=.5*x$b,x$C=Math.sin(x$x),x$O=Math.cos(x$x),x$L=Math.sin(x$n),x$f=Math.cos(x$n),x$p=Math.sin(x$E),x$P=Math.cos(x$E),x$V=x$h.elements;x$V[0]=x$P*x$L*x$O+x$p*x$f*x$C,x$V[1]=x$p*x$f*x$O-x$P*x$L*x$C,x$V[2]=x$P*x$f*x$C-x$p*x$L*x$O,x$V[3]=x$P*x$f*x$O+x$p*x$L*x$C},x$x.multiply=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$_.elements,x$n=x$s.elements,x$E=x$h[0],x$C=x$h[1],x$O=x$h[2],x$L=x$h[3],x$f=x$x[0],x$p=x$x[1],x$P=x$x[2],x$V=x$x[3],x$Q=x$C*x$P-x$O*x$p,x$y=x$O*x$f-x$E*x$P,x$w=x$E*x$p-x$C*x$f,x$i=x$E*x$f+x$C*x$p+x$O*x$P;x$n[0]=x$E*x$V+x$f*x$L+x$Q,x$n[1]=x$C*x$V+x$p*x$L+x$y,x$n[2]=x$O*x$V+x$P*x$L+x$w,x$n[3]=x$L*x$V-x$i},x$x.arcTanAngle=function(x$b,x$_){return 0==x$b?1==x$_?Math.PI/2:-Math.PI/2:0<x$b?Math.atan(x$_/x$b):x$b<0?0<x$_?Math.atan(x$_/x$b)+Math.PI:Math.atan(x$_/x$b)-Math.PI:0},x$x.angleTo=function(x$b,x$_,x$s){x$E_.subtract(x$_,x$b,x$x.TEMPVector30),x$E_.normalize(x$x.TEMPVector30,x$x.TEMPVector30),x$s.elements[0]=Math.asin(x$x.TEMPVector30.y),x$s.elements[1]=x$x.arcTanAngle(-x$x.TEMPVector30.z,-x$x.TEMPVector30.x)},x$x.createFromAxisAngle=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements;x$_*=.5;var x$n=Math.sin(x$_);x$h[0]=x$n*x$x[0],x$h[1]=x$n*x$x[1],x$h[2]=x$n*x$x[2],x$h[3]=Math.cos(x$_)},x$x.createFromMatrix3x3=function(x$b,x$_){var x$s,x$h=x$_.elements,x$x=x$b.elements,x$n=x$x[0]+x$x[4]+x$x[8];if(0<x$n)x$s=Math.sqrt(x$n+1),x$h[3]=.5*x$s,x$s=.5/x$s,x$h[0]=(x$x[5]-x$x[7])*x$s,x$h[1]=(x$x[6]-x$x[2])*x$s,x$h[2]=(x$x[1]-x$x[3])*x$s;else{var x$E=0;x$x[4]>x$x[0]&&(x$E=1),x$x[8]>x$x[3*x$E+x$E]&&(x$E=2);var x$C=(x$E+1)%3,x$O=(x$E+2)%3;x$s=Math.sqrt(x$x[3*x$E+x$E]-x$x[3*x$C+x$C]-x$x[3*x$O+x$O]+1),x$h[x$E]=.5*x$s,x$s=.5/x$s,x$h[3]=(x$x[3*x$C+x$O]-x$x[3*x$O+x$C])*x$s,x$h[x$C]=(x$x[3*x$C+x$E]+x$x[3*x$E+x$C])*x$s,x$h[x$O]=(x$x[3*x$O+x$E]+x$x[3*x$E+x$O])*x$s}},x$x.createFromMatrix4x4=function(x$b,x$_){var x$s,x$h,x$x=x$b.elements,x$n=x$_.elements,x$E=x$x[0]+x$x[5]+x$x[10];0<x$E?(x$s=Math.sqrt(x$E+1),x$n[3]=.5*x$s,x$s=.5/x$s,x$n[0]=(x$x[6]-x$x[9])*x$s,x$n[1]=(x$x[8]-x$x[2])*x$s,x$n[2]=(x$x[1]-x$x[4])*x$s):x$x[0]>=x$x[5]&&x$x[0]>=x$x[10]?(x$h=.5/(x$s=Math.sqrt(1+x$x[0]-x$x[5]-x$x[10])),x$n[0]=.5*x$s,x$n[1]=(x$x[1]+x$x[4])*x$h,x$n[2]=(x$x[2]+x$x[8])*x$h,x$n[3]=(x$x[6]-x$x[9])*x$h):x$x[5]>x$x[10]?(x$h=.5/(x$s=Math.sqrt(1+x$x[5]-x$x[0]-x$x[10])),x$n[0]=(x$x[4]+x$x[1])*x$h,x$n[1]=.5*x$s,x$n[2]=(x$x[9]+x$x[6])*x$h,x$n[3]=(x$x[8]-x$x[2])*x$h):(x$h=.5/(x$s=Math.sqrt(1+x$x[10]-x$x[0]-x$x[5])),x$n[0]=(x$x[8]+x$x[2])*x$h,x$n[1]=(x$x[9]+x$x[6])*x$h,x$n[2]=.5*x$s,x$n[3]=(x$x[1]-x$x[4])*x$h)},x$x.slerp=function(x$b,x$_,x$s,x$h){var x$x,x$n,x$E,x$C,x$O,x$L=x$b.elements,x$f=x$_.elements,x$p=x$h.elements,x$P=x$L[0],x$V=x$L[1],x$Q=x$L[2],x$y=x$L[3],x$w=x$f[0],x$i=x$f[1],x$R=x$f[2],x$t=x$f[3];return(x$n=x$P*x$w+x$V*x$i+x$Q*x$R+x$y*x$t)<0&&(x$n=-x$n,x$w=-x$w,x$i=-x$i,x$R=-x$R,x$t=-x$t),x$O=1e-6<1-x$n?(x$x=Math.acos(x$n),x$E=Math.sin(x$x),x$C=Math.sin((1-x$s)*x$x)/x$E,Math.sin(x$s*x$x)/x$E):(x$C=1-x$s,x$s),x$p[0]=x$C*x$P+x$O*x$w,x$p[1]=x$C*x$V+x$O*x$i,x$p[2]=x$C*x$Q+x$O*x$R,x$p[3]=x$C*x$y+x$O*x$t,x$p},x$x.lerp=function(x$b,x$_,x$s,x$h){var x$x=x$h.elements,x$n=x$b.elements,x$E=x$_.elements,x$C=x$n[0],x$O=x$n[1],x$L=x$n[2],x$f=x$n[3];x$x[0]=x$C+x$s*(x$E[0]-x$C),x$x[1]=x$O+x$s*(x$E[1]-x$O),x$x[2]=x$L+x$s*(x$E[2]-x$L),x$x[3]=x$f+x$s*(x$E[3]-x$f)},x$x.add=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]+x$n[0],x$h[1]=x$x[1]+x$n[1],x$h[2]=x$x[2]+x$n[2],x$h[3]=x$x[3]+x$n[3]},x$x.dot=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;return x$s[0]*x$h[0]+x$s[1]*x$h[1]+x$s[2]*x$h[2]+x$s[3]*x$h[3]},x$x.rotationLookAt=function(x$b,x$_,x$s){x$x.lookAt(x$E_.ZERO,x$b,x$_,x$s)},x$x.lookAt=function(x$b,x$_,x$s,x$h){x$jb.lookAt(x$b,x$_,x$s,x$x._tempMatrix3x3),x$x.rotationMatrix(x$x._tempMatrix3x3,x$h)},x$x.invert=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$b.lengthSquared();x$Hb.isZero(x$x)||(x$x=1/x$x,x$h[0]=-x$s[0]*x$x,x$h[1]=-x$s[1]*x$x,x$h[2]=-x$s[2]*x$x,x$h[3]=x$s[3]*x$x)},x$x.rotationMatrix=function(x$b,x$_){var x$s=x$b.elements,x$h=x$s[0],x$x=x$s[1],x$n=x$s[2],x$E=x$s[3],x$C=x$s[4],x$O=x$s[5],x$L=x$s[6],x$f=x$s[7],x$p=x$s[8],x$P=x$_.elements,x$V=NaN,x$Q=NaN,x$y=x$h+x$C+x$p;0<x$y?(x$V=Math.sqrt(x$y+1),x$P[3]=.5*x$V,x$V=.5/x$V,x$P[0]=(x$O-x$f)*x$V,x$P[1]=(x$L-x$n)*x$V,x$P[2]=(x$x-x$E)*x$V):x$C<=x$h&&x$p<=x$h?(x$Q=.5/(x$V=Math.sqrt(1+x$h-x$C-x$p)),x$P[0]=.5*x$V,x$P[1]=(x$x+x$E)*x$Q,x$P[2]=(x$n+x$L)*x$Q,x$P[3]=(x$O-x$f)*x$Q):x$p<x$C?(x$Q=.5/(x$V=Math.sqrt(1+x$C-x$h-x$p)),x$P[0]=(x$E+x$x)*x$Q,x$P[1]=.5*x$V,x$P[2]=(x$f+x$O)*x$Q,x$P[3]=(x$L-x$n)*x$Q):(x$Q=.5/(x$V=Math.sqrt(1+x$p-x$h-x$C)),x$P[0]=(x$L+x$n)*x$Q,x$P[1]=(x$f+x$O)*x$Q,x$P[2]=.5*x$V,x$P[3]=(x$x-x$E)*x$Q)},x$x.DEFAULT=new x$x,x$p(x$x,["TEMPVector30",function(){return this.TEMPVector30=new x$E_},"TEMPVector31",function(){return this.TEMPVector31=new x$E_},"TEMPVector32",function(){return this.TEMPVector32=new x$E_},"TEMPVector33",function(){return this.TEMPVector33=new x$E_},"TEMPMatrix0",function(){return this.TEMPMatrix0=new x$b_},"TEMPMatrix1",function(){return this.TEMPMatrix1=new x$b_},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new x$jb},"NAN",function(){return this.NAN=new x$x(NaN,NaN,NaN,NaN)}]),x$x}(),x$h_=function(){function x$b(x$b){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=x$b,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}x$V(x$b,"laya.d3.math.Rand");var x$_=x$b.prototype;return x$_.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},x$_.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},x$_.getSignedFloat=function(){return 2*this.getFloat()-1},x$Q(0,x$_,"seed",function(){return this.seeds[0]},function(x$b){this.seeds[0]=x$b,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),x$b.getFloatFromInt=function(x$b){return 1/8388607*(8388607&x$b)},x$b.getByteFromInt=function(x$b){return(8388607&x$b)>>>15},x$b}(),x$x_=(function(){function x$x(x$b){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(x$b instanceof Array)||4!==x$b.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|x$b[0],this._state0L=0|x$b[1],this._state1U=0|x$b[2],this._state1L=0|x$b[3]}x$V(x$x,"laya.d3.math.RandX");var x$b=x$x.prototype;x$b.randomint=function(){var x$b=this._state0U,x$_=this._state0L,x$s=this._state1U,x$h=this._state1L,x$x=(x$h>>>0)+(x$_>>>0),x$n=x$s+x$b+(x$x/2>>>31)>>>0,x$E=x$x>>>0,x$C=0,x$O=0;x$C=(x$b^=x$C=x$b<<23|(-512&x$_)>>>9)^(this._state0U=x$s),x$O=(x$_^=x$O=x$_<<23)^(this._state0L=x$h);x$C^=x$b>>>18,x$O^=x$_>>>18|(262143&x$b)<<14;return x$C^=x$s>>>5,x$O^=x$h>>>5|(31&x$s)<<27,this._state1U=x$C,this._state1L=x$O,[x$n,x$E]},x$b.random=function(){var x$b=this.randomint(),x$_=x$b[0],x$s=1023<<20|x$_>>>12,x$h=0|(x$b[1]>>>12|(4095&x$_)<<20);return x$x._CONVERTION_BUFFER.setUint32(0,x$s,!1),x$x._CONVERTION_BUFFER.setUint32(4,x$h,!1),x$h_._CONVERTION_BUFFER.getFloat64(0,!1)-1},x$p(x$x,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new x$h_([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function x$b(x$b,x$_){this.origin=null,this.direction=null,this.origin=x$b,this.direction=x$_}return x$V(x$b,"laya.d3.math.Ray"),x$b}()),x$n_=function(){function x$b(x$b,x$_){this.elements=new Float32Array(2),void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0);var x$s=this.elements;x$s[0]=x$b,x$s[1]=x$_}x$V(x$b,"laya.d3.math.Vector2");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.fromArray=function(x$b,x$_){void 0===x$_&&(x$_=0),this.elements[0]=x$b[x$_+0],this.elements[1]=x$b[x$_+1]},x$_.cloneTo=function(x$b){var x$_=x$b.elements,x$s=this.elements;x$_[0]=x$s[0],x$_[1]=x$s[1]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"x",function(){return this.elements[0]},function(x$b){this.elements[0]=x$b}),x$Q(0,x$_,"y",function(){return this.elements[1]},function(x$b){this.elements[1]=x$b}),x$b.scale=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements;x$h[0]=x$x[0]*x$_,x$h[1]=x$x[1]*x$_},x$p(x$b,["ZERO",function(){return this.ZERO=new x$b(0,0)},"ONE",function(){return this.ONE=new x$b(1,1)}]),x$b}(),x$E_=function(){function x$f(x$b,x$_,x$s){this.elements=new Float32Array(3),void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0);var x$h=this.elements;x$h[0]=x$b,x$h[1]=x$_,x$h[2]=x$s}x$V(x$f,"laya.d3.math.Vector3");var x$b=x$f.prototype;return x$$.imps(x$b,{"laya.d3.core.IClone":!0}),x$b.fromArray=function(x$b,x$_){void 0===x$_&&(x$_=0),this.elements[0]=x$b[x$_+0],this.elements[1]=x$b[x$_+1],this.elements[2]=x$b[x$_+2]},x$b.cloneTo=function(x$b){var x$_=x$b.elements,x$s=this.elements;x$_[0]=x$s[0],x$_[1]=x$s[1],x$_[2]=x$s[2]},x$b.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$b.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},x$b.reset=function(x$b,x$_,x$s){this.elements[0]=x$b,this.elements[1]=x$_,this.elements[2]=x$s},x$Q(0,x$b,"x",function(){return this.elements[0]},function(x$b){this.elements[0]=x$b}),x$Q(0,x$b,"y",function(){return this.elements[1]},function(x$b){this.elements[1]=x$b}),x$Q(0,x$b,"z",function(){return this.elements[2]},function(x$b){this.elements[2]=x$b}),x$f.distanceSquared=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0]-x$h[0],x$n=x$s[1]-x$h[1],x$E=x$s[2]-x$h[2];return x$x*x$x+x$n*x$n+x$E*x$E},x$f.distance=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0]-x$h[0],x$n=x$s[1]-x$h[1],x$E=x$s[2]-x$h[2];return Math.sqrt(x$x*x$x+x$n*x$n+x$E*x$E)},x$f.min=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=Math.min(x$x[0],x$n[0]),x$h[1]=Math.min(x$x[1],x$n[1]),x$h[2]=Math.min(x$x[2],x$n[2])},x$f.max=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=Math.max(x$x[0],x$n[0]),x$h[1]=Math.max(x$x[1],x$n[1]),x$h[2]=Math.max(x$x[2],x$n[2])},x$f.transformQuat=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements,x$E=x$x[0],x$C=x$x[1],x$O=x$x[2],x$L=x$n[0],x$f=x$n[1],x$p=x$n[2],x$P=x$n[3],x$V=x$P*x$E+x$f*x$O-x$p*x$C,x$Q=x$P*x$C+x$p*x$E-x$L*x$O,x$y=x$P*x$O+x$L*x$C-x$f*x$E,x$w=-x$L*x$E-x$f*x$C-x$p*x$O;x$h[0]=x$V*x$P+x$w*-x$L+x$Q*-x$p-x$y*-x$f,x$h[1]=x$Q*x$P+x$w*-x$f+x$y*-x$L-x$V*-x$p,x$h[2]=x$y*x$P+x$w*-x$p+x$V*-x$f-x$Q*-x$L},x$f.scalarLength=function(x$b){var x$_=x$b.elements,x$s=x$_[0],x$h=x$_[1],x$x=x$_[2];return Math.sqrt(x$s*x$s+x$h*x$h+x$x*x$x)},x$f.scalarLengthSquared=function(x$b){var x$_=x$b.elements,x$s=x$_[0],x$h=x$_[1],x$x=x$_[2];return x$s*x$s+x$h*x$h+x$x*x$x},x$f.normalize=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0],x$n=x$s[1],x$E=x$s[2],x$C=x$x*x$x+x$n*x$n+x$E*x$E;0<x$C&&(x$C=1/Math.sqrt(x$C),x$h[0]=x$s[0]*x$C,x$h[1]=x$s[1]*x$C,x$h[2]=x$s[2]*x$C)},x$f.multiply=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]*x$n[0],x$h[1]=x$x[1]*x$n[1],x$h[2]=x$x[2]*x$n[2]},x$f.scale=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements;x$h[0]=x$x[0]*x$_,x$h[1]=x$x[1]*x$_,x$h[2]=x$x[2]*x$_},x$f.lerp=function(x$b,x$_,x$s,x$h){var x$x=x$h.elements,x$n=x$b.elements,x$E=x$_.elements,x$C=x$n[0],x$O=x$n[1],x$L=x$n[2];x$x[0]=x$C+x$s*(x$E[0]-x$C),x$x[1]=x$O+x$s*(x$E[1]-x$O),x$x[2]=x$L+x$s*(x$E[2]-x$L)},x$f.transformV3ToV3=function(x$b,x$_,x$s){var x$h=x$f._tempVector4;x$f.transformV3ToV4(x$b,x$_,x$h);var x$x=x$h.elements,x$n=x$s.elements;x$n[0]=x$x[0],x$n[1]=x$x[1],x$n[2]=x$x[2]},x$f.transformV3ToV4=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$_.elements,x$O=x$s.elements;x$O[0]=x$x*x$C[0]+x$n*x$C[4]+x$E*x$C[8]+x$C[12],x$O[1]=x$x*x$C[1]+x$n*x$C[5]+x$E*x$C[9]+x$C[13],x$O[2]=x$x*x$C[2]+x$n*x$C[6]+x$E*x$C[10]+x$C[14],x$O[3]=x$x*x$C[3]+x$n*x$C[7]+x$E*x$C[11]+x$C[15]},x$f.TransformNormal=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$_.elements,x$O=x$s.elements;x$O[0]=x$x*x$C[0]+x$n*x$C[4]+x$E*x$C[8],x$O[1]=x$x*x$C[1]+x$n*x$C[5]+x$E*x$C[9],x$O[2]=x$x*x$C[2]+x$n*x$C[6]+x$E*x$C[10]},x$f.transformCoordinate=function(x$b,x$_,x$s){var x$h=x$f._tempVector4.elements,x$x=x$b.elements,x$n=x$x[0],x$E=x$x[1],x$C=x$x[2],x$O=x$_.elements;x$h[0]=x$n*x$O[0]+x$E*x$O[4]+x$C*x$O[8]+x$O[12],x$h[1]=x$n*x$O[1]+x$E*x$O[5]+x$C*x$O[9]+x$O[13],x$h[2]=x$n*x$O[2]+x$E*x$O[6]+x$C*x$O[10]+x$O[14],x$h[3]=1/(x$n*x$O[3]+x$E*x$O[7]+x$C*x$O[11]+x$O[15]);var x$L=x$s.elements;x$L[0]=x$h[0]*x$h[3],x$L[1]=x$h[1]*x$h[3],x$L[2]=x$h[2]*x$h[3]},x$f.Clamp=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements,x$n=x$x[0],x$E=x$x[1],x$C=x$x[2],x$O=x$_.elements,x$L=x$O[0],x$f=x$O[1],x$p=x$O[2],x$P=x$s.elements,x$V=x$P[0],x$Q=x$P[1],x$y=x$P[2],x$w=x$h.elements;x$n=(x$n=x$V<x$n?x$V:x$n)<x$L?x$L:x$n,x$E=(x$E=x$Q<x$E?x$Q:x$E)<x$f?x$f:x$E,x$C=(x$C=x$y<x$C?x$y:x$C)<x$p?x$p:x$C,x$w[0]=x$n,x$w[1]=x$E,x$w[2]=x$C},x$f.add=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]+x$n[0],x$h[1]=x$x[1]+x$n[1],x$h[2]=x$x[2]+x$n[2]},x$f.subtract=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]-x$n[0],x$h[1]=x$x[1]-x$n[1],x$h[2]=x$x[2]-x$n[2]},x$f.cross=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$_.elements,x$n=x$s.elements,x$E=x$h[0],x$C=x$h[1],x$O=x$h[2],x$L=x$x[0],x$f=x$x[1],x$p=x$x[2];x$n[0]=x$C*x$p-x$O*x$f,x$n[1]=x$O*x$L-x$E*x$p,x$n[2]=x$E*x$f-x$C*x$L},x$f.dot=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;return x$s[0]*x$h[0]+x$s[1]*x$h[1]+x$s[2]*x$h[2]},x$f.equals=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;return x$Hb.nearEqual(Math.abs(x$s[0]),Math.abs(x$h[0]))&&x$Hb.nearEqual(Math.abs(x$s[1]),Math.abs(x$h[1]))&&x$Hb.nearEqual(Math.abs(x$s[2]),Math.abs(x$h[2]))},x$f.ZERO=new x$f(0,0,0),x$f.ONE=new x$f(1,1,1),x$f.NegativeUnitX=new x$f(-1,0,0),x$f.UnitX=new x$f(1,0,0),x$f.UnitY=new x$f(0,1,0),x$f.UnitZ=new x$f(0,0,1),x$f.ForwardRH=new x$f(0,0,-1),x$f.ForwardLH=new x$f(0,0,1),x$f.Up=new x$f(0,1,0),x$f.NAN=new x$f(NaN,NaN,NaN),x$p(x$f,["_tempVector4",function(){return this._tempVector4=new x$C_}]),x$f}(),x$C_=function(){function x$b(x$b,x$_,x$s,x$h){this.elements=new Float32Array(4),void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=0);var x$x=this.elements;x$x[0]=x$b,x$x[1]=x$_,x$x[2]=x$s,x$x[3]=x$h}x$V(x$b,"laya.d3.math.Vector4");var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_.fromArray=function(x$b,x$_){void 0===x$_&&(x$_=0),this.elements[0]=x$b[x$_+0],this.elements[1]=x$b[x$_+1],this.elements[2]=x$b[x$_+2],this.elements[3]=x$b[x$_+3]},x$_.cloneTo=function(x$b){var x$_=x$b.elements,x$s=this.elements;x$_[0]=x$s[0],x$_[1]=x$s[1],x$_[2]=x$s[2],x$_[3]=x$s[3]},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$_.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},x$_.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},x$Q(0,x$_,"x",function(){return this.elements[0]},function(x$b){this.elements[0]=x$b}),x$Q(0,x$_,"y",function(){return this.elements[1]},function(x$b){this.elements[1]=x$b}),x$Q(0,x$_,"z",function(){return this.elements[2]},function(x$b){this.elements[2]=x$b}),x$Q(0,x$_,"w",function(){return this.elements[3]},function(x$b){this.elements[3]=x$b}),x$b.lerp=function(x$b,x$_,x$s,x$h){var x$x=x$h.elements,x$n=x$b.elements,x$E=x$_.elements,x$C=x$n[0],x$O=x$n[1],x$L=x$n[2],x$f=x$n[3];x$x[0]=x$C+x$s*(x$E[0]-x$C),x$x[1]=x$O+x$s*(x$E[1]-x$O),x$x[2]=x$L+x$s*(x$E[2]-x$L),x$x[3]=x$f+x$s*(x$E[3]-x$f)},x$b.transformByM4x4=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$h[0],x$n=x$h[1],x$E=x$h[2],x$C=x$h[3],x$O=x$_.elements,x$L=x$s.elements;x$L[0]=x$x*x$O[0]+x$n*x$O[4]+x$E*x$O[8]+x$C*x$O[12],x$L[1]=x$x*x$O[1]+x$n*x$O[5]+x$E*x$O[9]+x$C*x$O[13],x$L[2]=x$x*x$O[2]+x$n*x$O[6]+x$E*x$O[10]+x$C*x$O[14],x$L[3]=x$x*x$O[3]+x$n*x$O[7]+x$E*x$O[11]+x$C*x$O[15]},x$b.equals=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;return x$Hb.nearEqual(Math.abs(x$s[0]),Math.abs(x$h[0]))&&x$Hb.nearEqual(Math.abs(x$s[1]),Math.abs(x$h[1]))&&x$Hb.nearEqual(Math.abs(x$s[2]),Math.abs(x$h[2]))&&x$Hb.nearEqual(Math.abs(x$s[3]),Math.abs(x$h[3]))},x$b.normalize=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$b.length();0<x$x&&(x$h[0]=x$s[0]*x$x,x$h[1]=x$s[1]*x$x,x$h[2]=x$s[2]*x$x,x$h[3]=x$s[3]*x$x)},x$b.add=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]+x$n[0],x$h[1]=x$x[1]+x$n[1],x$h[2]=x$x[2]+x$n[2],x$h[3]=x$x[3]+x$n[3]},x$b.subtract=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]-x$n[0],x$h[1]=x$x[1]-x$n[1],x$h[2]=x$x[2]-x$n[2],x$h[3]=x$x[3]-x$n[3]},x$b.multiply=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=x$x[0]*x$n[0],x$h[1]=x$x[1]*x$n[1],x$h[2]=x$x[2]*x$n[2],x$h[3]=x$x[3]*x$n[3]},x$b.scale=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements;x$h[0]=x$x[0]*x$_,x$h[1]=x$x[1]*x$_,x$h[2]=x$x[2]*x$_,x$h[3]=x$x[3]*x$_},x$b.Clamp=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements,x$n=x$x[0],x$E=x$x[1],x$C=x$x[2],x$O=x$x[3],x$L=x$_.elements,x$f=x$L[0],x$p=x$L[1],x$P=x$L[2],x$V=x$L[3],x$Q=x$s.elements,x$y=x$Q[0],x$w=x$Q[1],x$i=x$Q[2],x$R=x$Q[3],x$t=x$h.elements;x$n=(x$n=x$y<x$n?x$y:x$n)<x$f?x$f:x$n,x$E=(x$E=x$w<x$E?x$w:x$E)<x$p?x$p:x$E,x$C=(x$C=x$i<x$C?x$i:x$C)<x$P?x$P:x$C,x$O=(x$O=x$R<x$O?x$R:x$O)<x$V?x$V:x$O,x$t[0]=x$n,x$t[1]=x$E,x$t[2]=x$C,x$t[3]=x$O},x$b.distanceSquared=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0]-x$h[0],x$n=x$s[1]-x$h[1],x$E=x$s[2]-x$h[2],x$C=x$s[3]-x$h[3];return x$x*x$x+x$n*x$n+x$E*x$E+x$C*x$C},x$b.distance=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements,x$x=x$s[0]-x$h[0],x$n=x$s[1]-x$h[1],x$E=x$s[2]-x$h[2],x$C=x$s[3]-x$h[3];return Math.sqrt(x$x*x$x+x$n*x$n+x$E*x$E+x$C*x$C)},x$b.dot=function(x$b,x$_){var x$s=x$b.elements,x$h=x$_.elements;return x$s[0]*x$h[0]+x$s[1]*x$h[1]+x$s[2]*x$h[2]+x$s[3]*x$h[3]},x$b.min=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=Math.min(x$x[0],x$n[0]),x$h[1]=Math.min(x$x[1],x$n[1]),x$h[2]=Math.min(x$x[2],x$n[2]),x$h[3]=Math.min(x$x[3],x$n[3])},x$b.max=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_.elements;x$h[0]=Math.max(x$x[0],x$n[0]),x$h[1]=Math.max(x$x[1],x$n[1]),x$h[2]=Math.max(x$x[2],x$n[2]),x$h[3]=Math.max(x$x[3],x$n[3])},x$p(x$b,["ZERO",function(){return this.ZERO=new x$b},"ONE",function(){return this.ONE=new x$b(1,1,1,1)},"UnitX",function(){return this.UnitX=new x$b(1,0,0,0)},"UnitY",function(){return this.UnitY=new x$b(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new x$b(0,0,1,0)},"UnitW",function(){return this.UnitW=new x$b(0,0,0,1)}]),x$b}(),x$O_=function(){function x$n(x$b,x$_,x$s,x$h){this.minDepth=0,this.maxDepth=1,this.x=x$b,this.y=x$_,this.width=x$s,this.height=x$h}x$V(x$n,"laya.d3.math.Viewport");var x$b=x$n.prototype;return x$b.project=function(x$b,x$_,x$s){x$E_.transformV3ToV3(x$b,x$_,x$s);var x$h=x$b.elements,x$x=x$_.elements,x$n=x$s.elements,x$E=x$h[0]*x$x[3]+x$h[1]*x$x[7]+x$h[2]*x$x[11]+x$x[15];1!==x$E&&(x$n[0]=x$n[0]/x$E,x$n[1]=x$n[1]/x$E,x$n[2]=x$n[2]/x$E),x$n[0]=.5*(x$n[0]+1)*this.width+this.x,x$n[1]=.5*(1-x$n[1])*this.height+this.y,x$n[2]=x$n[2]*(this.maxDepth-this.minDepth)+this.minDepth},x$b.unprojectFromMat=function(x$b,x$_,x$s){var x$h=x$b.elements,x$x=x$_.elements,x$n=x$s.elements;x$n[0]=(x$h[0]-this.x)/this.width*2-1,x$n[1]=-((x$h[1]-this.y)/this.height*2-1);var x$E=(this.maxDepth-this.minDepth)/2;x$n[2]=(x$h[2]-this.minDepth-x$E)/x$E;var x$C=x$n[0]*x$x[3]+x$n[1]*x$x[7]+x$n[2]*x$x[11]+x$x[15];x$E_.transformV3ToV3(x$s,x$_,x$s),1!==x$C&&(x$n[0]=x$n[0]/x$C,x$n[1]=x$n[1]/x$C,x$n[2]=x$n[2]/x$C)},x$b.unprojectFromWVP=function(x$b,x$_,x$s,x$h,x$x){x$b_.multiply(x$_,x$s,x$n._tempMatrix4x4),x$h&&x$b_.multiply(x$n._tempMatrix4x4,x$h,x$n._tempMatrix4x4),x$n._tempMatrix4x4.invert(x$n._tempMatrix4x4),this.unprojectFromMat(x$b,x$n._tempMatrix4x4,x$x)},x$p(x$n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new x$b_}]),x$n}(),x$L_=function(){function x$S(x$b){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=x$b,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}x$V(x$S,"laya.d3.resource.models.SubMesh");var x$b=x$S.prototype;return x$$.imps(x$b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),x$b._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),0===x$b?this._vertexBuffer:null},x$b._getIndexBuffer=function(){return this._indexBuffer},x$b._getStaticBatchBakedVertexs=function(x$b,x$_){var x$s,x$h,x$x=this._vertexBuffer,x$n=x$x.vertexDeclaration,x$E=x$n.getVertexElementByUsage(0).offset/4,x$C=x$n.getVertexElementByUsage(3).offset/4,x$O=x$_.meshRender.lightmapScaleOffset,x$L=0,x$f=0,x$p=0,x$P=0,x$V=0,x$Q=0;if(x$O)if(x$h=x$n.getVertexElementByUsage(15))x$p=x$n.vertexStride/4,x$s=0<this._vertexCount?x$x.getData().slice(this._vertexStart*x$p,(this._vertexStart+this._vertexCount)*x$p):x$x.getData().slice(),x$P=x$h.offset/4;else{x$p=(x$Q=x$n.vertexStride/4)+2,x$s=this._vertexCount?new Float32Array(this._vertexCount*(x$x.vertexDeclaration.vertexStride/4+2)):new Float32Array(x$x.vertexCount*(x$x.vertexDeclaration.vertexStride/4+2)),x$P=(x$V=x$n.getVertexElementByUsage(2).offset/4)+2;var x$y=x$x.getData();for(x$L=0,x$f=x$y.length/x$Q;x$L<x$f;x$L++){var x$w=0;x$w=0<this._vertexCount?(this._vertexStart+x$L)*x$Q:x$L*x$Q;var x$i=x$L*x$p,x$R=0;for(x$R=0;x$R<x$P;x$R++)x$s[x$i+x$R]=x$y[x$w+x$R];for(x$R=x$P;x$R<x$Q;x$R++)x$s[x$i+x$R+2]=x$y[x$w+x$R]}}else x$p=x$n.vertexStride/4,x$s=this._vertexCount?x$x.getData().slice(this._vertexStart*x$p,(this._vertexStart+this._vertexCount)*x$p):x$x.getData().slice();if(x$b){var x$t=x$b.worldMatrix,x$c=x$S._tempMatrix4x40;x$t.invert(x$c);var x$$=x$S._tempMatrix4x41,x$D=x$_.transform.worldMatrix;x$b_.multiply(x$c,x$D,x$$)}else x$$=x$_.transform.worldMatrix;var x$o=x$S._tempQuaternion0;for(x$$.decomposeTransRotScale(x$S._tempVector30,x$o,x$S._tempVector31),x$L=0,x$f=x$s.length/x$p;x$L<x$f;x$L++){var x$M=x$L*x$p+x$E,x$r=x$L*x$p+x$C;if(x$w_.transformVector3ArrayToVector3ArrayCoordinate(x$s,x$M,x$$,x$s,x$M),x$w_.transformVector3ArrayByQuat(x$s,x$r,x$o,x$s,x$r),x$O){var x$k=x$L*x$p+x$P;if(x$h)x$w_.transformLightingMapTexcoordByUV1Array(x$s,x$k,x$O,x$s,x$k);else{var x$B=x$L*x$Q+x$V;x$w_.transformLightingMapTexcoordByUV0Array(x$y,x$B,x$O,x$s,x$k)}}}return x$s},x$b._getVertexBuffers=function(){return null},x$b._beforeRender=function(x$b){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},x$b._render=function(x$b){var x$_,x$s=0,x$h=x$b.renderElement;if(1<this._indexCount){var x$x=this._boneIndicesList.length;if(1<x$x){for(var x$n=0;x$n<x$x;x$n++)(x$_=x$h._skinAnimationDatas||this._skinAnimationDatas)&&(x$h._shaderValue.setValue(0,x$_[x$n]),x$b._shader.uploadRenderElementUniforms(x$h._shaderValue.data)),x$Z.mainContext.drawElements(4,this._subIndexBufferCount[x$n],5123,2*this._subIndexBufferStart[x$n]);x$M.drawCall+=x$x}else(x$_=x$h._skinAnimationDatas||this._skinAnimationDatas)&&(x$h._shaderValue.setValue(0,x$_[0]),x$b._shader.uploadRenderElementUniforms(x$h._shaderValue.data)),x$Z.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),x$M.drawCall++;x$s=this._indexCount}else x$s=this._indexBuffer.indexCount,(x$_=x$h._skinAnimationDatas||this._skinAnimationDatas)&&(x$h._shaderValue.setValue(0,x$_[0]),x$b._shader.uploadRenderElementUniforms(x$h._shaderValue.data)),x$Z.mainContext.drawElements(4,x$s,5123,0),x$M.drawCall++;x$M.trianglesFaces+=x$s/3},x$b.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},x$b.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},x$Q(0,x$b,"_vertexBufferCount",function(){return 1}),x$Q(0,x$b,"triangleCount",function(){return this._indexBuffer.indexCount/3}),x$p(x$S,["_tempVector30",function(){return this._tempVector30=new x$E_},"_tempVector31",function(){return this._tempVector31=new x$E_},"_tempQuaternion0",function(){return this._tempQuaternion0=new x$s_},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new x$b_},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new x$b_}]),x$S}(),x$f_=function(){function x$b(x$b){this.defineCounter=0,this.defines=null,x$b?(this.defineCounter=x$b.defineCounter,this.defines=x$b.defines.slice()):(this.defineCounter=0,this.defines=[])}return x$V(x$b,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),x$b.prototype.registerDefine=function(x$b){var x$_=Math.pow(2,this.defineCounter++);return this.defines[x$_]=x$b,x$_},x$b}(),x$p_=function(){function x$b(){}return x$V(x$b,"laya.d3.shader.ShaderInit3D"),x$b.__init__=function(){var x$b,x$_;x$M_._globalRegDefine("HIGHPRECISION",x$M_.SHADERDEFINE_HIGHPRECISION),x$M_._globalRegDefine("FOG",x$M_.SHADERDEFINE_FOG),x$M_._globalRegDefine("DIRECTIONLIGHT",x$M_.SHADERDEFINE_DIRECTIONLIGHT),x$M_._globalRegDefine("POINTLIGHT",x$M_.SHADERDEFINE_POINTLIGHT),x$M_._globalRegDefine("SPOTLIGHT",x$M_.SHADERDEFINE_SPOTLIGHT),x$M_._globalRegDefine("UV",x$M_.SHADERDEFINE_UV0),x$M_._globalRegDefine("COLOR",x$M_.SHADERDEFINE_COLOR),x$M_._globalRegDefine("UV1",x$M_.SHADERDEFINE_UV1),x$M_._globalRegDefine("CASTSHADOW",x$V_.SHADERDEFINE_CAST_SHADOW),x$M_._globalRegDefine("SHADOWMAP_PSSM1",x$V_.SHADERDEFINE_SHADOW_PSSM1),x$M_._globalRegDefine("SHADOWMAP_PSSM2",x$V_.SHADERDEFINE_SHADOW_PSSM2),x$M_._globalRegDefine("SHADOWMAP_PSSM3",x$V_.SHADERDEFINE_SHADOW_PSSM3),x$M_._globalRegDefine("SHADOWMAP_PCF_NO",x$V_.SHADERDEFINE_SHADOW_PCF_NO),x$M_._globalRegDefine("SHADOWMAP_PCF1",x$V_.SHADERDEFINE_SHADOW_PCF1),x$M_._globalRegDefine("SHADOWMAP_PCF2",x$V_.SHADERDEFINE_SHADOW_PCF2),x$M_._globalRegDefine("SHADOWMAP_PCF3",x$V_.SHADERDEFINE_SHADOW_PCF3),x$M_._globalRegDefine("DEPTHFOG",x$M_.SAHDERDEFINE_DEPTHFOG),x$G_.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),x$G_.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),x$b={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},x$_={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var x$s=x$G_.nameKey.add("SIMPLE");shaderCompile=x$M_.add(x$s,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',x$b,x$_),x$z_.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),x$z_.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),x$z_.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),x$z_.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),x$z_.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),x$z_.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),x$z_.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),x$z_.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),x$z_.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},x$b}(),x$P_=function(){function x$b(){this._data=null,this._data=[]}x$V(x$b,"laya.d3.shader.ValusArray");var x$_=x$b.prototype;return x$_.setValue=function(x$b,x$_){this._data[x$b]=x$_},x$Q(0,x$_,"data",function(){return this._data}),x$b}(),x$V_=function(){function x$b(){}return x$b.SHADERDEFINE_RECEIVE_SHADOW=1,x$b.SHADERDEFINE_CAST_SHADOW=512,x$b.SHADERDEFINE_SHADOW_PSSM1=1024,x$b.SHADERDEFINE_SHADOW_PSSM2=2048,x$b.SHADERDEFINE_SHADOW_PSSM3=4096,x$b.SHADERDEFINE_SHADOW_PCF_NO=8192,x$b.SHADERDEFINE_SHADOW_PCF1=16384,x$b.SHADERDEFINE_SHADOW_PCF2=32768,x$b.SHADERDEFINE_SHADOW_PCF3=65536,x$b.MAX_PSSM_COUNT=3,x$b}(),x$Q_=function(){function x$X(){}return x$V(x$X,"laya.d3.utils.Picker"),x$X.calculateCursorRay=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$b.elements[0],x$C=x$b.elements[1],x$O=x$X._tempVector30,x$L=x$O.elements;x$L[0]=x$E,x$L[1]=x$C,x$L[2]=x$_.minDepth;var x$f=x$X._tempVector31,x$p=x$f.elements;x$p[0]=x$E,x$p[1]=x$C,x$p[2]=x$_.maxDepth;var x$P=x$n.origin,x$V=x$X._tempVector32;x$_.unprojectFromWVP(x$O,x$s,x$h,x$x,x$P),x$_.unprojectFromWVP(x$f,x$s,x$h,x$x,x$V);var x$Q=x$n.direction.elements;x$Q[0]=x$V.x-x$P.x,x$Q[1]=x$V.y-x$P.y,x$Q[2]=x$V.z-x$P.z,x$E_.normalize(x$n.direction,x$n.direction)},x$X.rayIntersectsPositionsAndIndices=function(x$b,x$_,x$s,x$h,x$x){for(var x$n=x$s.vertexStride/4,x$E=x$s.getVertexElementByUsage(0).offset/4,x$C=Number.MAX_VALUE,x$O=-1,x$L=-1,x$f=-1,x$p=0;x$p<x$h.length;x$p+=3){var x$P=x$X._tempVector35,x$V=x$P.elements,x$Q=x$h[x$p]*x$n,x$y=x$Q+x$E;x$V[0]=x$_[x$y],x$V[1]=x$_[1+x$y],x$V[2]=x$_[2+x$y];var x$w=x$X._tempVector36,x$i=x$w.elements,x$R=x$h[x$p+1]*x$n,x$t=x$R+x$E;x$i[0]=x$_[x$t],x$i[1]=x$_[1+x$t],x$i[2]=x$_[2+x$t];var x$c=x$X._tempVector37,x$$=x$c.elements,x$D=x$h[x$p+2]*x$n,x$o=x$D+x$E;x$$[0]=x$_[x$o],x$$[1]=x$_[1+x$o],x$$[2]=x$_[2+x$o];var x$M=laya.d3.utils.Picker.rayIntersectsTriangle(x$b,x$P,x$w,x$c);!isNaN(x$M)&&x$M<x$C&&(x$C=x$M,x$O=x$Q,x$L=x$R,x$f=x$D)}if(x$C===Number.MAX_VALUE)return x$x.position.toDefault(),x$x.distance=Number.MAX_VALUE,x$x.trianglePositions[0].toDefault(),x$x.trianglePositions[1].toDefault(),x$x.trianglePositions[2].toDefault(),x$x.triangleNormals[0].toDefault(),x$x.triangleNormals[1].toDefault(),x$x.triangleNormals[2].toDefault(),!1;x$x.distance=x$C,x$E_.scale(x$b.direction,x$C,x$x.position),x$E_.add(x$b.origin,x$x.position,x$x.position);var x$r=x$x.trianglePositions,x$k=x$r[0],x$B=x$r[1],x$S=x$r[2],x$Z=x$k.elements,x$J=x$B.elements,x$W=x$S.elements,x$T=x$O+x$E;x$Z[0]=x$_[x$T],x$Z[1]=x$_[x$T+1],x$Z[2]=x$_[x$T+2];var x$q=x$L+x$E;x$J[0]=x$_[x$q],x$J[1]=x$_[x$q+1],x$J[2]=x$_[x$q+2];var x$U=x$f+x$E;x$W[0]=x$_[x$U],x$W[1]=x$_[x$U+1],x$W[2]=x$_[x$U+2];var x$G=x$s.getVertexElementByUsage(3);if(x$G){var x$z=x$G.offset/4,x$a=x$x.triangleNormals,x$K=x$a[0],x$d=x$a[1],x$I=x$a[2],x$g=x$K.elements,x$F=x$d.elements,x$A=x$I.elements,x$u=x$O+x$z;x$g[0]=x$_[x$u],x$g[1]=x$_[x$u+1],x$g[2]=x$_[x$u+2];var x$l=x$L+x$z;x$F[0]=x$_[x$l],x$F[1]=x$_[x$l+1],x$F[2]=x$_[x$l+2];var x$N=x$f+x$z;x$A[0]=x$_[x$N],x$A[1]=x$_[x$N+1],x$A[2]=x$_[x$N+2]}return!0},x$X.rayIntersectsTriangle=function(x$b,x$_,x$s,x$h){var x$x=x$X._tempVector30,x$n=x$X._tempVector31;x$E_.subtract(x$s,x$_,x$x),x$E_.subtract(x$h,x$_,x$n);var x$E,x$C=x$X._tempVector32;if(x$E_.cross(x$b.direction,x$n,x$C),(x$E=x$E_.dot(x$x,x$C))>-Number.MIN_VALUE&&x$E<Number.MIN_VALUE)return Number.NaN;var x$O,x$L=1/x$E,x$f=x$X._tempVector33;if(x$E_.subtract(x$b.origin,x$_,x$f),x$O=x$E_.dot(x$f,x$C),(x$O*=x$L)<0||1<x$O)return Number.NaN;var x$p,x$P,x$V=x$X._tempVector34;return x$E_.cross(x$f,x$x,x$V),x$p=x$E_.dot(x$b.direction,x$V),(x$p*=x$L)<0||1<x$O+x$p?Number.NaN:(x$P=x$E_.dot(x$n,x$V),(x$P*=x$L)<0?Number.NaN:x$P)},x$p(x$X,["_tempVector30",function(){return this._tempVector30=new x$E_},"_tempVector31",function(){return this._tempVector31=new x$E_},"_tempVector32",function(){return this._tempVector32=new x$E_},"_tempVector33",function(){return this._tempVector33=new x$E_},"_tempVector34",function(){return this._tempVector34=new x$E_},"_tempVector35",function(){return this._tempVector35=new x$E_},"_tempVector36",function(){return this._tempVector36=new x$E_},"_tempVector37",function(){return this._tempVector37=new x$E_}]),x$X}(),x$y_=(function(){function x$b(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new x$E_,new x$E_,new x$E_],this.trianglePositions.length=3,this.triangleNormals=[new x$E_,new x$E_,new x$E_],this.triangleNormals.length=3,this.position=new x$E_}x$V(x$b,"laya.d3.utils.RaycastHit"),x$b.prototype.cloneTo=function(x$b){x$b.distance=this.distance,this.trianglePositions[0].cloneTo(x$b.trianglePositions[0]),this.trianglePositions[1].cloneTo(x$b.trianglePositions[1]),this.trianglePositions[2].cloneTo(x$b.trianglePositions[2]),this.triangleNormals[0].cloneTo(x$b.triangleNormals[0]),this.triangleNormals[1].cloneTo(x$b.triangleNormals[1]),this.triangleNormals[2].cloneTo(x$b.triangleNormals[2]),this.position.cloneTo(x$b.position),x$b.sprite3D=this.sprite3D}}(),function(){function x$b(x$b,x$_){this._width=0,this._height=0,this._width=x$b,this._height=x$_}x$V(x$b,"laya.d3.utils.Size");var x$_=x$b.prototype;return x$Q(0,x$_,"width",function(){return-1===this._width?x$Y.clientWidth:this._width}),x$Q(0,x$_,"height",function(){return-1===this._height?x$Y.clientHeight:this._height}),x$Q(1,x$b,"fullScreen",function(){return new x$b(-1,-1)}),x$b}()),x$w_=function(){function x$T(){}return x$V(x$T,"laya.d3.utils.Utils3D"),x$T._rotationTransformScaleSkinAnimation=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p){var x$P,x$V,x$Q,x$y,x$w,x$i=x$T._tempArray16_0,x$R=x$T._tempArray16_1,x$t=x$T._tempArray16_2,x$c=x$h+x$h,x$$=x$x+x$x,x$D=x$n+x$n,x$o=x$h*x$c,x$M=x$x*x$c,x$r=x$x*x$$,x$k=x$n*x$c,x$B=x$n*x$$,x$S=x$n*x$D,x$Z=x$E*x$c,x$J=x$E*x$$,x$W=x$E*x$D;for(x$i[15]=1,x$i[0]=1-x$r-x$S,x$i[1]=x$M+x$W,x$i[2]=x$k-x$J,x$i[4]=x$M-x$W,x$i[5]=1-x$o-x$S,x$i[6]=x$B+x$Z,x$i[8]=x$k+x$J,x$i[9]=x$B-x$Z,x$i[10]=1-x$o-x$r,x$R[15]=1,x$R[0]=x$C,x$R[5]=x$O,x$R[10]=x$L,x$P=0;x$P<4;x$P++)x$V=x$i[x$P],x$Q=x$i[x$P+4],x$y=x$i[x$P+8],x$w=x$i[x$P+12],x$t[x$P]=x$V,x$t[x$P+4]=x$Q,x$t[x$P+8]=x$y,x$t[x$P+12]=x$V*x$b+x$Q*x$_+x$y*x$s+x$w;for(x$P=0;x$P<4;x$P++)x$V=x$t[x$P],x$Q=x$t[x$P+4],x$y=x$t[x$P+8],x$w=x$t[x$P+12],x$f[x$P+x$p]=x$V*x$R[0]+x$Q*x$R[1]+x$y*x$R[2]+x$w*x$R[3],x$f[x$P+x$p+4]=x$V*x$R[4]+x$Q*x$R[5]+x$y*x$R[6]+x$w*x$R[7],x$f[x$P+x$p+8]=x$V*x$R[8]+x$Q*x$R[9]+x$y*x$R[10]+x$w*x$R[11],x$f[x$P+x$p+12]=x$V*x$R[12]+x$Q*x$R[13]+x$y*x$R[14]+x$w*x$R[15]},x$T._createNodeByJson=function(x$b,x$_,x$s,x$h){if(!x$s)switch(x$_.type){case"Sprite3D":x$s=new x$U_;break;case"MeshSprite3D":x$s=new x$X_;break;case"SkinnedMeshSprite3D":x$s=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":x$s=new ShuriKenParticle3D;break;case"TrailSprite3D":x$s=new TrailSprite3D;break;case"Terrain":x$s=new Terrain;break;case"Camera":x$s=new x$N_;break;case"DirectionLight":x$s=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var x$x=x$_.props;if(x$x)for(var x$n in x$x)x$s[x$n]=x$x[x$n];var x$E=x$_.customProps;x$E&&(x$s instanceof laya.d3.core.Sprite3D?(x$s._parseBaseCustomProps(x$E),x$s._parseCustomProps(x$b,x$h,x$E,x$_),x$s._parseCustomComponent(x$b,x$h,x$_.components)):x$s._parseCustomProps(x$b,x$h,x$E,x$_));var x$C=x$_.child;if(x$C)for(var x$O=0,x$L=x$C.length;x$O<x$L;x$O++){var x$f=x$T._createNodeByJson(x$b,x$C[x$O],null,x$h);x$s.addChild(x$f)}return x$s},x$T._computeBoneAndAnimationDatasByBindPoseMatrxix=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C,x$O=0,x$L=0,x$f=x$b.length;for(x$E=0;x$E<x$f;x$O+=x$b[x$E].keyframeWidth,x$L+=16,x$E++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(x$_[x$O+0],x$_[x$O+1],x$_[x$O+2],x$_[x$O+3],x$_[x$O+4],x$_[x$O+5],x$_[x$O+6],x$_[x$O+7],x$_[x$O+8],x$_[x$O+9],x$h,x$L),0!=x$E&&(x$C=16*x$b[x$E].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(x$h,x$C,x$h,x$L,x$h,x$L));var x$p=x$s.length;for(x$E=0;x$E<x$p;x$E++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(x$h,16*x$n[x$E],x$s[x$E],x$x,16*x$E)},x$T._computeAnimationDatasByArrayAndMatrixFast=function(x$b,x$_,x$s,x$h){for(var x$x=0,x$n=x$b.length;x$x<x$n;x$x++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(x$_,16*x$h[x$x],x$b[x$x],x$s,16*x$x)},x$T._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E,x$C=0,x$O=0,x$L=x$b.length;for(x$n=0;x$n<x$L;x$C+=x$b[x$n].keyframeWidth,x$O+=16,x$n++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(x$_[x$C+7],x$_[x$C+8],x$_[x$C+9],x$_[x$C+3],x$_[x$C+4],x$_[x$C+5],x$_[x$C+6],x$_[x$C+0],x$_[x$C+1],x$_[x$C+2],x$h,x$O),0!=x$n&&(x$E=16*x$b[x$n].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(x$h,x$E,x$h,x$O,x$h,x$O));var x$f=x$s.length;for(x$n=0;x$n<x$f;x$n++){var x$p=16*x$n;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(x$h,x$p,x$s[x$n],x$x,x$p)}},x$T._computeAnimationDatasByArrayAndMatrixFastOld=function(x$b,x$_,x$s){for(var x$h=x$b.length,x$x=0;x$x<x$h;x$x++){var x$n=16*x$x;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(x$_,x$n,x$b[x$x],x$s,x$n)}},x$T._computeRootAnimationData=function(x$b,x$_,x$s){for(var x$h=0,x$x=0,x$n=0,x$E=x$b.length;x$h<x$E;x$x+=x$b[x$h].keyframeWidth,x$n+=16,x$h++)laya.d3.utils.Utils3D.createAffineTransformationArray(x$_[x$x+0],x$_[x$x+1],x$_[x$x+2],x$_[x$x+3],x$_[x$x+4],x$_[x$x+5],x$_[x$x+6],x$_[x$x+7],x$_[x$x+8],x$_[x$x+9],x$s,x$n)},x$T.transformVector3ArrayByQuat=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$s.elements,x$E=x$b[x$_],x$C=x$b[x$_+1],x$O=x$b[x$_+2],x$L=x$n[0],x$f=x$n[1],x$p=x$n[2],x$P=x$n[3],x$V=x$P*x$E+x$f*x$O-x$p*x$C,x$Q=x$P*x$C+x$p*x$E-x$L*x$O,x$y=x$P*x$O+x$L*x$C-x$f*x$E,x$w=-x$L*x$E-x$f*x$C-x$p*x$O;x$h[x$x]=x$V*x$P+x$w*-x$L+x$Q*-x$p-x$y*-x$f,x$h[x$x+1]=x$Q*x$P+x$w*-x$f+x$y*-x$L-x$V*-x$p,x$h[x$x+2]=x$y*x$P+x$w*-x$p+x$V*-x$f-x$Q*-x$L},x$T.mulMatrixByArray=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C,x$O,x$L,x$f;if(x$x===x$s){for(x$s=x$T._tempArray16_3,x$E=0;x$E<16;++x$E)x$s[x$E]=x$x[x$n+x$E];x$h=0}for(x$E=0;x$E<4;x$E++)x$C=x$b[x$_+x$E],x$O=x$b[x$_+x$E+4],x$L=x$b[x$_+x$E+8],x$f=x$b[x$_+x$E+12],x$x[x$n+x$E]=x$C*x$s[x$h+0]+x$O*x$s[x$h+1]+x$L*x$s[x$h+2]+x$f*x$s[x$h+3],x$x[x$n+x$E+4]=x$C*x$s[x$h+4]+x$O*x$s[x$h+5]+x$L*x$s[x$h+6]+x$f*x$s[x$h+7],x$x[x$n+x$E+8]=x$C*x$s[x$h+8]+x$O*x$s[x$h+9]+x$L*x$s[x$h+10]+x$f*x$s[x$h+11],x$x[x$n+x$E+12]=x$C*x$s[x$h+12]+x$O*x$s[x$h+13]+x$L*x$s[x$h+14]+x$f*x$s[x$h+15]},x$T.mulMatrixByArrayFast=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C,x$O,x$L,x$f;for(x$E=0;x$E<4;x$E++)x$C=x$b[x$_+x$E],x$O=x$b[x$_+x$E+4],x$L=x$b[x$_+x$E+8],x$f=x$b[x$_+x$E+12],x$x[x$n+x$E]=x$C*x$s[x$h+0]+x$O*x$s[x$h+1]+x$L*x$s[x$h+2]+x$f*x$s[x$h+3],x$x[x$n+x$E+4]=x$C*x$s[x$h+4]+x$O*x$s[x$h+5]+x$L*x$s[x$h+6]+x$f*x$s[x$h+7],x$x[x$n+x$E+8]=x$C*x$s[x$h+8]+x$O*x$s[x$h+9]+x$L*x$s[x$h+10]+x$f*x$s[x$h+11],x$x[x$n+x$E+12]=x$C*x$s[x$h+12]+x$O*x$s[x$h+13]+x$L*x$s[x$h+14]+x$f*x$s[x$h+15]},x$T.mulMatrixByArrayAndMatrixFast=function(x$b,x$_,x$s,x$h,x$x){var x$n,x$E,x$C,x$O,x$L,x$f=x$s.elements,x$p=x$f[0],x$P=x$f[1],x$V=x$f[2],x$Q=x$f[3],x$y=x$f[4],x$w=x$f[5],x$i=x$f[6],x$R=x$f[7],x$t=x$f[8],x$c=x$f[9],x$$=x$f[10],x$D=x$f[11],x$o=x$f[12],x$M=x$f[13],x$r=x$f[14],x$k=x$f[15],x$B=x$_,x$S=x$_+4,x$Z=x$_+8,x$J=x$_+12,x$W=x$x,x$T=x$x+4,x$q=x$x+8,x$U=x$x+12;for(x$n=0;x$n<4;x$n++)x$E=x$b[x$B+x$n],x$C=x$b[x$S+x$n],x$O=x$b[x$Z+x$n],x$L=x$b[x$J+x$n],x$h[x$W+x$n]=x$E*x$p+x$C*x$P+x$O*x$V+x$L*x$Q,x$h[x$T+x$n]=x$E*x$y+x$C*x$w+x$O*x$i+x$L*x$R,x$h[x$q+x$n]=x$E*x$t+x$C*x$c+x$O*x$$+x$L*x$D,x$h[x$U+x$n]=x$E*x$o+x$C*x$M+x$O*x$r+x$L*x$k},x$T.createAffineTransformationArray=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p){var x$P=x$h+x$h,x$V=x$x+x$x,x$Q=x$n+x$n,x$y=x$h*x$P,x$w=x$h*x$V,x$i=x$h*x$Q,x$R=x$x*x$V,x$t=x$x*x$Q,x$c=x$n*x$Q,x$$=x$E*x$P,x$D=x$E*x$V,x$o=x$E*x$Q;x$f[x$p+0]=(1-(x$R+x$c))*x$C,x$f[x$p+1]=(x$w+x$o)*x$C,x$f[x$p+2]=(x$i-x$D)*x$C,x$f[x$p+3]=0,x$f[x$p+4]=(x$w-x$o)*x$O,x$f[x$p+5]=(1-(x$y+x$c))*x$O,x$f[x$p+6]=(x$t+x$$)*x$O,x$f[x$p+7]=0,x$f[x$p+8]=(x$i+x$D)*x$L,x$f[x$p+9]=(x$t-x$$)*x$L,x$f[x$p+10]=(1-(x$y+x$R))*x$L,x$f[x$p+11]=0,x$f[x$p+12]=x$b,x$f[x$p+13]=x$_,x$f[x$p+14]=x$s,x$f[x$p+15]=1},x$T.transformVector3ArrayToVector3ArrayCoordinate=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$T._tempArray4_0,x$E=x$b[x$_+0],x$C=x$b[x$_+1],x$O=x$b[x$_+2],x$L=x$s.elements;x$n[0]=x$E*x$L[0]+x$C*x$L[4]+x$O*x$L[8]+x$L[12],x$n[1]=x$E*x$L[1]+x$C*x$L[5]+x$O*x$L[9]+x$L[13],x$n[2]=x$E*x$L[2]+x$C*x$L[6]+x$O*x$L[10]+x$L[14],x$n[3]=1/(x$E*x$L[3]+x$C*x$L[7]+x$O*x$L[11]+x$L[15]),x$h[x$x+0]=x$n[0]*x$n[3],x$h[x$x+1]=x$n[1]*x$n[3],x$h[x$x+2]=x$n[2]*x$n[3]},x$T.transformLightingMapTexcoordByUV0Array=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$s.elements;x$h[x$x+0]=x$b[x$_+0]*x$n[0]+x$n[2],x$h[x$x+1]=(x$b[x$_+1]-1)*x$n[1]+x$n[3]},x$T.transformLightingMapTexcoordByUV1Array=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$s.elements;x$h[x$x+0]=x$b[x$_+0]*x$n[0]+x$n[2],x$h[x$x+1]=1+x$b[x$_+1]*x$n[1]+x$n[3]},x$T.getURLVerion=function(x$b){var x$_=x$b.indexOf("?");return 0<=x$_?x$b.substr(x$_):null},x$T._quaternionCreateFromYawPitchRollArray=function(x$b,x$_,x$s,x$h){var x$x=.5*x$s,x$n=.5*x$_,x$E=.5*x$b,x$C=Math.sin(x$x),x$O=Math.cos(x$x),x$L=Math.sin(x$n),x$f=Math.cos(x$n),x$p=Math.sin(x$E),x$P=Math.cos(x$E);x$h[0]=x$P*x$L*x$O+x$p*x$f*x$C,x$h[1]=x$p*x$f*x$O-x$P*x$L*x$C,x$h[2]=x$P*x$f*x$C-x$p*x$L*x$O,x$h[3]=x$P*x$f*x$O+x$p*x$L*x$C},x$T._createAffineTransformationArray=function(x$b,x$_,x$s,x$h){var x$x=x$_[0],x$n=x$_[1],x$E=x$_[2],x$C=x$_[3],x$O=x$x+x$x,x$L=x$n+x$n,x$f=x$E+x$E,x$p=x$x*x$O,x$P=x$x*x$L,x$V=x$x*x$f,x$Q=x$n*x$L,x$y=x$n*x$f,x$w=x$E*x$f,x$i=x$C*x$O,x$R=x$C*x$L,x$t=x$C*x$f,x$c=x$s[0],x$$=x$s[1],x$D=x$s[2];x$h[0]=(1-(x$Q+x$w))*x$c,x$h[1]=(x$P+x$t)*x$c,x$h[2]=(x$V-x$R)*x$c,x$h[3]=0,x$h[4]=(x$P-x$t)*x$$,x$h[5]=(1-(x$p+x$w))*x$$,x$h[6]=(x$y+x$i)*x$$,x$h[7]=0,x$h[8]=(x$V+x$R)*x$D,x$h[9]=(x$y-x$i)*x$D,x$h[10]=(1-(x$p+x$Q))*x$D,x$h[11]=0,x$h[12]=x$b[0],x$h[13]=x$b[1],x$h[14]=x$b[2],x$h[15]=1},x$T._mulMatrixArray=function(x$b,x$_,x$s,x$h){var x$x,x$n,x$E,x$C,x$O,x$L=x$_.elements,x$f=x$L[0],x$p=x$L[1],x$P=x$L[2],x$V=x$L[3],x$Q=x$L[4],x$y=x$L[5],x$w=x$L[6],x$i=x$L[7],x$R=x$L[8],x$t=x$L[9],x$c=x$L[10],x$$=x$L[11],x$D=x$L[12],x$o=x$L[13],x$M=x$L[14],x$r=x$L[15],x$k=x$h,x$B=x$h+4,x$S=x$h+8,x$Z=x$h+12;for(x$x=0;x$x<4;x$x++)x$n=x$b[x$x],x$E=x$b[x$x+4],x$C=x$b[x$x+8],x$O=x$b[x$x+12],x$s[x$k+x$x]=x$n*x$f+x$E*x$p+x$C*x$P+x$O*x$V,x$s[x$B+x$x]=x$n*x$Q+x$E*x$y+x$C*x$w+x$O*x$i,x$s[x$S+x$x]=x$n*x$R+x$E*x$t+x$C*x$c+x$O*x$$,x$s[x$Z+x$x]=x$n*x$D+x$E*x$o+x$C*x$M+x$O*x$r},x$T.getYawPitchRoll=function(x$b,x$_){x$T.transformQuat(x$E_.ForwardRH,x$b,x$s_.TEMPVector31),x$T.transformQuat(x$E_.Up,x$b,x$s_.TEMPVector32);var x$s=x$s_.TEMPVector32.elements;x$T.angleTo(x$E_.ZERO,x$s_.TEMPVector31,x$s_.TEMPVector33);var x$h=x$s_.TEMPVector33.elements;x$h[0]==Math.PI/2?(x$h[1]=x$T.arcTanAngle(x$s[2],x$s[0]),x$h[2]=0):x$h[0]==-Math.PI/2?(x$h[1]=x$T.arcTanAngle(-x$s[2],-x$s[0]),x$h[2]=0):(x$b_.createRotationY(-x$h[1],x$s_.TEMPMatrix0),x$b_.createRotationX(-x$h[0],x$s_.TEMPMatrix1),x$E_.transformCoordinate(x$s_.TEMPVector32,x$s_.TEMPMatrix0,x$s_.TEMPVector32),x$E_.transformCoordinate(x$s_.TEMPVector32,x$s_.TEMPMatrix1,x$s_.TEMPVector32),x$h[2]=x$T.arcTanAngle(x$s[1],-x$s[0])),x$h[1]<=-Math.PI&&(x$h[1]=Math.PI),x$h[2]<=-Math.PI&&(x$h[2]=Math.PI),x$h[1]>=Math.PI&&x$h[2]>=Math.PI&&(x$h[1]=0,x$h[2]=0,x$h[0]=Math.PI-x$h[0]),x$_[0]=x$h[1],x$_[1]=x$h[0],x$_[2]=x$h[2]},x$T.arcTanAngle=function(x$b,x$_){return 0==x$b?1==x$_?Math.PI/2:-Math.PI/2:0<x$b?Math.atan(x$_/x$b):x$b<0?0<x$_?Math.atan(x$_/x$b)+Math.PI:Math.atan(x$_/x$b)-Math.PI:0},x$T.angleTo=function(x$b,x$_,x$s){x$E_.subtract(x$_,x$b,x$s_.TEMPVector30),x$E_.normalize(x$s_.TEMPVector30,x$s_.TEMPVector30),x$s.elements[0]=Math.asin(x$s_.TEMPVector30.y),x$s.elements[1]=x$T.arcTanAngle(-x$s_.TEMPVector30.z,-x$s_.TEMPVector30.x)},x$T.transformQuat=function(x$b,x$_,x$s){var x$h=x$s.elements,x$x=x$b.elements,x$n=x$_,x$E=x$x[0],x$C=x$x[1],x$O=x$x[2],x$L=x$n[0],x$f=x$n[1],x$p=x$n[2],x$P=x$n[3],x$V=x$P*x$E+x$f*x$O-x$p*x$C,x$Q=x$P*x$C+x$p*x$E-x$L*x$O,x$y=x$P*x$O+x$L*x$C-x$f*x$E,x$w=-x$L*x$E-x$f*x$C-x$p*x$O;x$h[0]=x$V*x$P+x$w*-x$L+x$Q*-x$p-x$y*-x$f,x$h[1]=x$Q*x$P+x$w*-x$f+x$y*-x$L-x$V*-x$p,x$h[2]=x$y*x$P+x$w*-x$p+x$V*-x$f-x$Q*-x$L},x$T.quaterionNormalize=function(x$b,x$_){var x$s=x$b[0],x$h=x$b[1],x$x=x$b[2],x$n=x$b[3],x$E=x$s*x$s+x$h*x$h+x$x*x$x+x$n*x$n;0<x$E&&(x$E=1/Math.sqrt(x$E),x$_[0]=x$s*x$E,x$_[1]=x$h*x$E,x$_[2]=x$x*x$E,x$_[3]=x$n*x$E)},x$T.matrix4x4MultiplyFFF=function(x$b,x$_,x$s){var x$h,x$x,x$n,x$E,x$C;if(x$s===x$_)for(x$_=new Float32Array(16),x$h=0;x$h<16;++x$h)x$_[x$h]=x$s[x$h];for(x$h=0;x$h<4;x$h++)x$x=x$b[x$h],x$n=x$b[x$h+4],x$E=x$b[x$h+8],x$C=x$b[x$h+12],x$s[x$h]=x$x*x$_[0]+x$n*x$_[1]+x$E*x$_[2]+x$C*x$_[3],x$s[x$h+4]=x$x*x$_[4]+x$n*x$_[5]+x$E*x$_[6]+x$C*x$_[7],x$s[x$h+8]=x$x*x$_[8]+x$n*x$_[9]+x$E*x$_[10]+x$C*x$_[11],x$s[x$h+12]=x$x*x$_[12]+x$n*x$_[13]+x$E*x$_[14]+x$C*x$_[15]},x$T.matrix4x4MultiplyMFM=function(x$b,x$_,x$s){x$T.matrix4x4MultiplyFFF(x$b.elements,x$_,x$s.elements)},x$p(x$T,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new x$E_},"_tempVector3_1",function(){return this._tempVector3_1=new x$E_},"_tempVector3_2",function(){return this._tempVector3_2=new x$E_},"_tempVector3_3",function(){return this._tempVector3_3=new x$E_},"_tempVector3_4",function(){return this._tempVector3_4=new x$E_},"_tempVector3_5",function(){return this._tempVector3_5=new x$E_},"_tempVector3_6",function(){return this._tempVector3_6=new x$E_},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),x$T}(),x$i_=function(){function x$J(){}return x$V(x$J,"Laya3D"),x$J._cancelLoadByUrl=function(x$b){x$$.loader.cancelLoadByUrl(x$b),x$J._innerFirstLevelLoaderManager.cancelLoadByUrl(x$b),x$J._innerSecondLevelLoaderManager.cancelLoadByUrl(x$b),x$J._innerThirdLevelLoaderManager.cancelLoadByUrl(x$b),x$J._innerFourthLevelLoaderManager.cancelLoadByUrl(x$b)},x$J._changeWebGLSize=function(x$b,x$_){x$Z.onStageResize(x$b,x$_),x$Y.clientWidth=x$b,x$Y.clientHeight=x$_},x$J.__init__=function(){var x$b=x$_.createMap;x$b.lh=[x$U_,"SPRITE3DHIERARCHY"],x$b.ls=[x$q_,"SPRITE3DHIERARCHY"],x$b.lm=[x$g_,"MESH"],x$b.lmat=[x$z_,"MATERIAL"],x$b.jpg=[x$A_,"nativeimage"],x$b.jpeg=[x$A_,"nativeimage"],x$b.png=[x$A_,"nativeimage"],x$b.pkm=[x$A_,"arraybuffer"],x$b.raw=[x$d_,"arraybuffer"],x$b.mipmaps=[x$d_,"arraybuffer"],x$i.parserMap.SPRITE3DHIERARCHY=x$J._loadHierarchy,x$i.parserMap.MESH=x$J._loadMesh,x$i.parserMap.MATERIAL=x$J._loadMaterial,x$i.parserMap.TEXTURECUBE=x$J._loadTextureCube,x$i.parserMap.TERRAIN=x$J._loadTerrain,x$J._innerFirstLevelLoaderManager.on("error",null,x$J._eventLoadManagerError),x$J._innerSecondLevelLoaderManager.on("error",null,x$J._eventLoadManagerError),x$J._innerThirdLevelLoaderManager.on("error",null,x$J._eventLoadManagerError),x$J._innerFourthLevelLoaderManager.on("error",null,x$J._eventLoadManagerError)},x$J.READ_BLOCK=function(){return x$J._readData.pos+=4,!0},x$J.READ_DATA=function(){return x$J._DATA.offset=x$J._readData.getUint32(),x$J._DATA.size=x$J._readData.getUint32(),!0},x$J.READ_STRINGS=function(){var x$b=[],x$_={offset:0,size:0};x$_.offset=x$J._readData.getUint16(),x$_.size=x$J._readData.getUint16();x$J._readData.pos;x$J._readData.pos=x$_.offset+x$J._DATA.offset;for(var x$s=0;x$s<x$_.size;x$s++){var x$h=x$J._readData.readUTFString();-1===x$h.lastIndexOf(".lmat")&&-1===x$h.lastIndexOf(".lpbr")||x$b.push(x$h)}return x$b},x$J.formatRelativePath=function(x$b,x$_){var x$s;if("."===x$_.charAt(0)){for(var x$h=(x$b+x$_).split("/"),x$x=0,x$n=x$h.length;x$x<x$n;x$x++)if(".."==x$h[x$x]){var x$E=x$x-1;0<x$E&&".."!==x$h[x$E]&&(x$h.splice(x$E,2),x$x-=2)}x$s=x$h.join("/")}else x$s=x$b+x$_;return null!=x$S.customFormat&&(x$s=x$S.customFormat(x$s,null)),x$s},x$J._eventLoadManagerError=function(x$b){x$$.loader.event("error",x$b)},x$J._addHierarchyInnerUrls=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E=x$J.formatRelativePath(x$h,x$x);x$s&&(x$E+=x$s),x$b.push({url:x$E,clas:x$n}),x$_[x$x]=x$E},x$J._getSprite3DHierarchyInnerUrls=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){var x$C,x$O=0,x$L=0;switch(x$b.type){case"Scene":var x$f=x$b.customProps.lightmaps;for(x$O=0,x$L=x$f.length;x$O<x$L;x$O++){var x$p=x$f[x$O].replace(".exr",".png");x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$p,x$A_)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var x$P;if(x$b.instanceParams)(x$P=x$b.instanceParams.loadPath)&&x$J._addHierarchyInnerUrls(x$_,x$x,x$n,x$E,x$P,x$g_);else{(x$P=(x$C=x$b.customProps).meshPath)&&x$J._addHierarchyInnerUrls(x$_,x$x,x$n,x$E,x$P,x$g_);var x$V=x$C.materials;if(x$V)for(x$O=0,x$L=x$V.length;x$O<x$L;x$O++){for(var x$Q=x$V[x$O],x$y=x$Q.type.split("."),x$w=x$W.window,x$i=0,x$R=x$y.length;x$i<x$R;++x$i){x$w=x$w[this.clasPaths[x$i]]}if("function"!=typeof x$w)throw"_getSprite3DHierarchyInnerUrls 错误: "+x$Q.type+" 不是类";x$J._addHierarchyInnerUrls(x$s,x$x,x$n,x$E,x$Q.path,x$w)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var x$t=(x$C=x$b.customProps).meshPath;x$t&&x$J._addHierarchyInnerUrls(x$_,x$x,x$n,x$E,x$t,x$g_);var x$c=x$C.material;if(x$c){x$y=x$c.type.split("."),x$w=x$W.window;for(x$i=0,x$R=x$y.length;x$i<x$R;++x$i){x$w=x$w[this.clasPaths[x$i]]}x$J._addHierarchyInnerUrls(x$s,x$x,x$n,x$E,x$c.path,x$w)}else{var x$$=x$C.materialPath;if(x$$)x$J._addHierarchyInnerUrls(x$s,x$x,x$n,x$E,x$$,ShurikenParticleMaterial);else{var x$D=x$C.texturePath;x$D&&x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$D,x$A_)}}break;case"Terrain":x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$b.customProps.dataPath,TerrainRes)}var x$o=x$b.components;for(var x$M in x$o){var x$r=x$o[x$M];switch(x$M){case"Animator":var x$k=x$r.avatarPath;if(x$k)x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$k,Avatar);else{var x$B=x$r.avatar;x$B&&x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$B.path,Avatar)}var x$S=x$r.clipPaths;for(x$O=0,x$L=x$S.length;x$O<x$L;x$O++)x$J._addHierarchyInnerUrls(x$h,x$x,x$n,x$E,x$S[x$O],AnimationClip)}}var x$Z=x$b.child;for(x$O=0,x$L=x$Z.length;x$O<x$L;x$O++)x$J._getSprite3DHierarchyInnerUrls(x$Z[x$O],x$_,x$s,x$h,x$x,x$n,x$E)},x$J._loadHierarchy=function(x$b){x$b.on("loaded",null,x$J._onHierarchylhLoaded,[x$b,x$b._class._getGroup()]),x$b.load(x$b.url,"json",!1,null,!0)},x$J._onHierarchylhLoaded=function(x$b,x$_,x$s){if(x$b._class.destroyed)x$b.endLoad();else{var x$h=x$b.url,x$x=x$w_.getURLVerion(x$h),x$n=x$S.getPath(x$h),x$E=[],x$C=[],x$O=[],x$L={};x$J._getSprite3DHierarchyInnerUrls(x$s,x$E,x$C,x$O,x$L,x$x,x$n);var x$f=x$E.length+x$C.length+x$O.length,x$p=x$f+1,x$P=1/x$p;if(x$J._onProcessChange(x$b,0,x$P,1),0<x$O.length){var x$V=x$f/x$p,x$Q=x$B.create(null,x$J._onProcessChange,[x$b,x$P,x$V],!1);x$J._innerFourthLevelLoaderManager.create(x$O,x$B.create(null,x$J._onHierarchyInnerForthLevResouLoaded,[x$b,x$_,x$Q,x$s,x$L,x$E,x$C,x$P+x$V*x$O.length,x$V]),x$Q,null,null,1,!0,x$_)}else x$J._onHierarchyInnerForthLevResouLoaded(x$b,x$_,null,x$s,x$L,x$E,x$C,x$P,x$V)}},x$J._onHierarchyInnerForthLevResouLoaded=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){if(x$b._class.destroyed)x$b.endLoad();else if(x$s&&x$s.recover(),0<x$E.length){var x$L=x$B.create(null,x$J._onProcessChange,[x$b,x$C,x$O],!1);x$J._innerSecondLevelLoaderManager.create(x$E,x$B.create(null,x$J._onHierarchyInnerSecondLevResouLoaded,[x$b,x$_,x$L,x$h,x$x,x$n,x$C+x$O*x$E.length,x$O]),x$s,null,null,1,!0,x$_)}else x$J._onHierarchyInnerSecondLevResouLoaded(x$b,x$_,null,x$h,x$x,x$n,x$C,x$O)},x$J._onHierarchyInnerSecondLevResouLoaded=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C){if(x$b._class.destroyed)x$b.endLoad();else if(x$s&&x$s.recover(),0<x$n.length){var x$O=x$B.create(null,x$J._onProcessChange,[x$b,x$E,x$C],!1);x$J._innerFirstLevelLoaderManager.create(x$n,x$B.create(null,x$J._onHierarchyInnerFirstLevResouLoaded,[x$b,x$O,x$h,x$x]),x$s,null,null,1,!0,x$_)}else x$J._onHierarchyInnerFirstLevResouLoaded(x$b,null,x$h,x$x)},x$J._onHierarchyInnerFirstLevResouLoaded=function(x$b,x$_,x$s,x$h){x$_&&x$_.recover(),x$b.endLoad([x$s,x$h])},x$J._loadTerrain=function(x$b){x$b.on("loaded",null,x$J._onTerrainLtLoaded,[x$b,x$b._class._getGroup()]),x$b.load(x$b.url,"json",!1,null,!0)},x$J._onTerrainLtLoaded=function(x$b,x$_,x$s){if(x$b._class.destroyed)x$b.endLoad();else{var x$h,x$x,x$n=x$b.url,x$E=x$w_.getURLVerion(x$n),x$C=x$S.getPath(x$n),x$O=[],x$L={},x$f=0,x$p=0,x$P=x$s.heightData;x$h=x$P.url,x$x=x$J.formatRelativePath(x$C,x$h),x$E&&(x$x+=x$E),x$h=x$L[x$h]=x$x;var x$V=x$s.detailTexture;for(x$f=0,x$p=x$V.length;x$f<x$p;x$f++)x$O.push({url:x$V[x$f].diffuse});var x$Q=x$s.normalMap;for(x$f=0,x$p=x$Q.length;x$f<x$p;x$f++)x$O.push({url:x$Q[x$f]});var x$y=x$s.alphaMap;for(x$f=0,x$p=x$y.length;x$f<x$p;x$f++)x$O.push({url:x$y[x$f],params:[!1,!1,6408,!0]});for(x$f=0,x$p=x$O.length;x$f<x$p;x$f++){var x$w=x$O[x$f].url;x$x=x$J.formatRelativePath(x$C,x$w),x$E&&(x$x+=x$E),x$O[x$f].url=x$x,x$L[x$w]=x$x}var x$i=x$O.length,x$R=x$i+2,x$t=1/x$R;x$J._onProcessChange(x$b,0,x$t,1);var x$c={heightMapLoaded:!1,texturesLoaded:!1},x$$=x$B.create(null,x$J._onProcessChange,[x$b,x$t,x$t],!1);x$J._innerFourthLevelLoaderManager.create(x$h,x$B.create(null,x$J._onTerrainHeightMapLoaded,[x$b,x$$,x$s,x$L,x$c]),x$$,null,[x$P.numX,x$P.numZ,x$P.bitType,x$P.value],1,!0,x$_);var x$D=x$B.create(null,x$J._onProcessChange,[x$b,2*x$t,x$i/x$R],!1);x$J._innerFourthLevelLoaderManager.create(x$O,x$B.create(null,x$J._onTerrainTexturesLoaded,[x$b,x$D,x$s,x$L,x$c]),x$D,null,null,1,!0,x$_)}},x$J._onTerrainHeightMapLoaded=function(x$b,x$_,x$s,x$h,x$x){x$x.heightMapLoaded=!0,x$x.texturesLoaded&&(x$b.endLoad([x$s,x$h]),x$_.recover())},x$J._onTerrainTexturesLoaded=function(x$b,x$_,x$s,x$h,x$x){x$x.texturesLoaded=!0,x$x.heightMapLoaded&&(x$b.endLoad([x$s,x$h]),x$_.recover())},x$J._loadMesh=function(x$b){x$b.on("loaded",null,x$J._onMeshLmLoaded,[x$b,x$b._class._getGroup()]),x$b.load(x$b.url,"arraybuffer",!1,null,!0)},x$J._onMeshLmLoaded=function(x$b,x$_,x$s){if(x$b._class.destroyed)x$b.endLoad();else{var x$h,x$x,x$n,x$E=x$b.url,x$C=x$w_.getURLVerion(x$E),x$O=x$S.getPath(x$E),x$L={},x$f=0,x$p=0;switch((x$J._readData=new x$D(x$s)).pos=0,x$J._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var x$P=x$J._readData.getUint32();x$J._readData.pos=x$J._readData.pos+4,x$p=x$J._readData.getUint16(),x$J._readData.pos=x$J._readData.pos+8*x$p;var x$V=x$J._readData.getUint32();for(x$p=x$J._readData.getUint16(),x$J._readData.pos=x$P+x$V,x$h=[],x$f=0;x$f<x$p;x$f++){var x$Q=x$J._readData.readUTFString();-1!==x$Q.lastIndexOf(".lmat")&&x$h.push(x$Q)}break;default:for(x$J.READ_BLOCK(),x$f=0;x$f<2;x$f++){var x$y=x$J._readData.getUint16(),x$w=x$J._strings[x$y],x$i=x$J["READ_"+x$w];if(null==x$i)throw new Error("model file err,no this function:"+x$y+" "+x$w);1===x$f?x$h=x$i.call():x$i.call()}}for(x$f=0,x$n=x$h.length;x$f<x$n;x$f++){var x$R=x$h[x$f];x$x=x$J.formatRelativePath(x$O,x$R),x$C&&(x$x+=x$C),x$h[x$f]=x$x,x$L[x$R]=x$x}if(0<x$h.length){x$J._onProcessChange(x$b,0,.5,1);var x$t=x$B.create(null,x$J._onProcessChange,[x$b,.5,.5],!1);x$J._innerSecondLevelLoaderManager.create(x$h,x$B.create(null,x$J._onMeshMateialLoaded,[x$b,x$t,x$s,x$L]),x$t,null,null,1,!0,x$_)}else x$b.endLoad([x$s,x$L])}},x$J._onMeshMateialLoaded=function(x$b,x$_,x$s,x$h){x$b.endLoad([x$s,x$h]),x$_.recover()},x$J._getMaterialTexturePath=function(x$b,x$_,x$s){var x$h=x$b.length-4;return x$b.indexOf(".dds")!=x$h&&x$b.indexOf(".tga")!=x$h&&x$b.indexOf(".exr")!=x$h&&x$b.indexOf(".DDS")!=x$h&&x$b.indexOf(".TGA")!=x$h&&x$b.indexOf(".EXR")!=x$h||(x$b=x$b.substr(0,x$h)+".png"),x$b=x$J.formatRelativePath(x$s,x$b),x$_&&(x$b+=x$_),x$b},x$J._loadMaterial=function(x$b){x$b.on("loaded",null,x$J._onMaterilLmatLoaded,[x$b,x$b._class._getGroup()]),x$b.load(x$b.url,"json",!1,null,!0)},x$J._onMaterilLmatLoaded=function(x$b,x$_,x$s){if(x$b._class.destroyed)x$b.endLoad();else{var x$h,x$x=x$b.url,x$n=x$w_.getURLVerion(x$x),x$E=x$S.getPath(x$x),x$C=[],x$O={},x$L=x$s.customProps,x$f=x$s.version;if(x$f)switch(x$f){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var x$p=x$s.props.textures,x$P=0,x$V=x$p.length;x$P<x$V;x$P++){var x$Q=x$p[x$P],x$y=x$Q.path;if(x$y){var x$w=x$y.length-4;x$y.indexOf(".exr")!=x$w&&x$y.indexOf(".EXR")!=x$w||(x$y=x$y.substr(0,x$w)+".png"),x$h=x$J.formatRelativePath(x$E,x$y),x$n&&(x$h+=x$n),x$C.push({url:x$h,params:x$Q.params}),x$O[x$y]=x$h}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var x$i=x$L.diffuseTexture.texture2D;if(x$i&&(x$h=x$J._getMaterialTexturePath(x$i,x$n,x$E),x$C.push(x$h),x$O[x$i]=x$h),x$L.normalTexture){var x$R=x$L.normalTexture.texture2D;x$R&&(x$h=x$J._getMaterialTexturePath(x$R,x$n,x$E),x$C.push(x$h),x$O[x$R]=x$h)}if(x$L.specularTexture){var x$t=x$L.specularTexture.texture2D;x$t&&(x$h=x$J._getMaterialTexturePath(x$t,x$n,x$E),x$C.push(x$h),x$O[x$t]=x$h)}if(x$L.emissiveTexture){var x$c=x$L.emissiveTexture.texture2D;x$c&&(x$h=x$J._getMaterialTexturePath(x$c,x$n,x$E),x$C.push(x$h),x$O[x$c]=x$h)}if(x$L.ambientTexture){var x$$=x$L.ambientTexture.texture2D;x$$&&(x$h=x$J._getMaterialTexturePath(x$$,x$n,x$E),x$C.push(x$h),x$O[x$$]=x$h)}if(x$L.reflectTexture){var x$D=x$L.reflectTexture.texture2D;x$D&&(x$h=x$J._getMaterialTexturePath(x$D,x$n,x$E),x$C.push(x$h),x$O[x$D]=x$h)}}var x$o=x$C.length,x$M=x$o+1,x$r=1/x$M;if(x$J._onProcessChange(x$b,0,x$r,1),0<x$o){var x$k=x$B.create(null,x$J._onProcessChange,[x$b,x$r,x$o/x$M],!1);x$J._innerFourthLevelLoaderManager.create(x$C,x$B.create(null,x$J._onMateialTexturesLoaded,[x$b,x$k,x$s,x$O]),x$k,x$A_,null,1,!0,x$_)}else x$J._onMateialTexturesLoaded(x$b,null,x$s,null)}},x$J._onMateialTexturesLoaded=function(x$b,x$_,x$s,x$h){x$b.endLoad([x$s,x$h]),x$_&&x$_.recover()},x$J._loadTextureCube=function(x$b){x$b.on("loaded",null,x$J._onTextureCubeLtcLoaded,[x$b]),x$b.load(x$b.url,"json",!1,null,!0)},x$J._onTextureCubeLtcLoaded=function(x$b,x$_){if(x$b._class.destroyed)x$b.endLoad();else{var x$s=x$S.getPath(x$b.url),x$h=[x$J.formatRelativePath(x$s,x$_.px),x$J.formatRelativePath(x$s,x$_.nx),x$J.formatRelativePath(x$s,x$_.py),x$J.formatRelativePath(x$s,x$_.ny),x$J.formatRelativePath(x$s,x$_.pz),x$J.formatRelativePath(x$s,x$_.nz)];x$J._onProcessChange(x$b,0,1/7,1);var x$x=x$B.create(null,x$J._onProcessChange,[x$b,1/7,6/7],!1);x$J._innerFourthLevelLoaderManager.load(x$h,x$B.create(null,x$J._onTextureCubeImagesLoaded,[x$b,x$h,x$x]),x$x,"nativeimage")}},x$J._onTextureCubeImagesLoaded=function(x$b,x$_,x$s){var x$h=[];x$h.length=6;for(var x$x=0;x$x<6;x$x++){var x$n=x$_[x$x];x$h[x$x]=x$i.getRes(x$n),x$i.clearRes(x$n)}x$b.endLoad(x$h),x$s.recover()},x$J._onProcessChange=function(x$b,x$_,x$s,x$h){(x$h=x$_+x$h*x$s)<1&&x$b.event("progress",x$h)},x$J.init=function(x$b,x$_,x$s,x$h,x$x,x$n){if(void 0===x$s&&(x$s=!1),void 0===x$h&&(x$h=!1),void 0===x$x&&(x$x=!0),void 0===x$n&&(x$n=!0),x$R.update3DLoop=function(){},x$R.cancelLoadByUrl=function(x$b){x$J._cancelLoadByUrl(x$b)},x$O.isAntialias=x$s,x$O.isAlpha=x$h,x$O.premultipliedAlpha=x$x,x$O.isStencil=x$n,!x$Z.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");x$R.changeWebGLSize=x$J._changeWebGLSize,x$y.is3DMode=!0,x$$.init(x$b,x$_),x$T.__init__(),x$p_.__init__(),x$X_.__init__(),x$I.__init__(),x$J.__init__(),x$E.maxTextureCount=2,(x$J.debugMode||x$m.debugMode)&&(x$J._debugPhasorSprite=new x$l)},x$J.HIERARCHY="SPRITE3DHIERARCHY",x$J.MESH="MESH",x$J.MATERIAL="MATERIAL",x$J.PBRMATERIAL="PBRMTL",x$J.TEXTURECUBE="TEXTURECUBE",x$J.TERRAIN="TERRAIN",x$J._readData=null,x$J._debugPhasorSprite=null,x$J.debugMode=!1,x$p(x$J,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new x$_},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new x$_},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new x$_},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new x$_}]),x$J}(),x$R_=function(x$b){function x$x(x$b){x$x.__super.call(this),this._owner=x$b,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}x$V(x$x,"laya.d3.animation.AnimationTransform3D",x$n);var x$_=x$x.prototype;return x$_._getlocalMatrix=function(){return this._localUpdate&&(x$w_._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},x$_._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldTransform()}},x$_._setWorldMatrixAndUpdate=function(x$b){if(this._worldMatrix=x$b,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var x$_=this._getlocalMatrix(),x$s=0;x$s<16;++x$s)this._worldMatrix[x$s]=x$_[x$s];else x$w_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},x$_._setWorldMatrixNoUpdate=function(x$b){this._worldMatrix=x$b},x$_._setWorldMatrixIgnoreUpdate=function(x$b){this._worldMatrix=x$b,this._worldUpdate=!1},x$_.getLocalPosition=function(){return this._localPosition},x$_.setLocalPosition=function(x$b){if(this._parent)this._localPosition=x$b,this._localUpdate=!0,this._onWorldTransform();else{var x$_=this._entity.owner._transform,x$s=this._entity.localPosition,x$h=x$s.elements;x$h[0]=x$b[0],x$h[1]=x$b[1],x$h[2]=x$b[2],x$_.localPosition=x$s}},x$_.getLocalRotation=function(){if(this._localQuaternionUpdate){var x$b=this._localRotationEuler;x$w_._quaternionCreateFromYawPitchRollArray(x$b[1]/x$x._angleToRandin,x$b[0]/x$x._angleToRandin,x$b[2]/x$x._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},x$_.setLocalRotation=function(x$b){if(this._parent)this._localRotation=x$b,x$w_.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var x$_=this._entity.owner._transform,x$s=this._entity.localRotation,x$h=x$s.elements;x$h[0]=x$b[0],x$h[1]=x$b[1],x$h[2]=x$b[2],x$h[3]=x$b[3],x$_.localRotation=x$s}},x$_.getLocalScale=function(){return this._localScale},x$_.setLocalScale=function(x$b){if(this._parent)this._localScale=x$b,this._localUpdate=!0,this._onWorldTransform();else{var x$_=this._entity.owner._transform,x$s=this._entity.localScale,x$h=x$s.elements;x$h[0]=x$b[0],x$h[1]=x$b[1],x$h[2]=x$b[2],x$_.localScale=x$s}},x$_.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){x$w_.getYawPitchRoll(this._localRotation,x$x._tempVector3);var x$b=x$x._tempVector3,x$_=this._localRotationEuler;x$_[0]=x$b[1]*x$x._angleToRandin,x$_[1]=x$b[0]*x$x._angleToRandin,x$_[2]=x$b[2]*x$x._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},x$_.setLocalRotationEuler=function(x$b){if(this._parent)x$w_._quaternionCreateFromYawPitchRollArray(x$b[1]/x$x._angleToRandin,x$b[0]/x$x._angleToRandin,x$b[2]/x$x._angleToRandin,this._localRotation),this._localRotationEuler=x$b,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var x$_=this._entity.owner._transform,x$s=this._entity.localRotationEuler,x$h=x$s.elements;x$h[0]=x$b[0],x$h[1]=x$b[1],x$h[2]=x$b[2],x$_.localRotationEuler=x$s}},x$_.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)x$w_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var x$b=this._getlocalMatrix(),x$_=0;x$_<16;++x$_)this._worldMatrix[x$_]=x$b[x$_];this._worldUpdate=!1}return this._worldMatrix},x$_.setParent=function(x$b){if(this._parent!==x$b){if(this._parent){var x$_=this._parent._childs,x$s=x$_.indexOf(this);x$_.splice(x$s,1)}x$b&&(x$b._childs.push(this),x$b&&this._onWorldTransform()),this._parent=x$b}},x$p(x$x,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),x$x}(),x$t_=function(x$b){function x$_(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,x$_.__super.call(this),this._destroyed=!1,this._id=x$_._uniqueIDCounter,x$_._uniqueIDCounter++}x$V(x$_,"laya.d3.component.Component3D",x$n);var x$s=x$_.prototype;return x$$.imps(x$s,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),x$s._initialize=function(x$b){this._owner=x$b,this._enable=!0,this.started=!1,this._load(x$b)},x$s._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},x$s._load=function(x$b){},x$s._start=function(x$b){},x$s._update=function(x$b){},x$s._lateUpdate=function(x$b){},x$s._preRenderUpdate=function(x$b){},x$s._postRenderUpdate=function(x$b){},x$s._unload=function(x$b){this.offAll()},x$s._cloneTo=function(x$b){},x$Q(0,x$s,"id",function(){return this._id}),x$Q(0,x$s,"destroyed",function(){return this._destroyed}),x$Q(0,x$s,"owner",function(){return this._owner}),x$Q(0,x$s,"enable",function(){return this._enable},function(x$b){this._enable!==x$b&&(this._enable=x$b,this.event("enablechanged",this._enable))}),x$Q(0,x$s,"isSingleton",function(){return x$_._isSingleton}),x$_._isSingleton=!0,x$_._uniqueIDCounter=1,x$_}(),x$c_=function(x$b){function x$_(){this._destroyed=!1,x$_.__super.call(this),this._destroyed=!1}x$V(x$_,"laya.d3.core.GeometryFilter",x$n);var x$s=x$_.prototype;return x$$.imps(x$s,{"laya.resource.IDestroy":!0}),x$s._destroy=function(){this.offAll(),this._destroyed=!0},x$Q(0,x$s,"_isAsyncLoaded",function(){return!0}),x$Q(0,x$s,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),x$Q(0,x$s,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),x$Q(0,x$s,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),x$Q(0,x$s,"destroyed",function(){return this._destroyed}),x$_}(),x$$_=function(x$b){function x$h(x$b){x$h.__super.call(this),this._id=++x$h._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new x$mb(new x$E_,new x$E_),this._boundingBoxCenter=new x$E_,this._boundingSphere=new x$vb(new x$E_,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=x$b,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}x$V(x$h,"laya.d3.core.render.BaseRender",x$n);var x$_=x$h.prototype;return x$$.imps(x$_,{"laya.resource.IDestroy":!0}),x$_._changeMaterialReference=function(x$b,x$_){x$b&&x$b._removeReference(),x$_._addReference()},x$_._getInstanceMaterial=function(x$b,x$_){var x$s=new x$b.constructor;return x$b.cloneTo(x$s),x$s.name=x$s.name+"(Instance)",this._materialsInstance[x$_]=!0,this._changeMaterialReference(this._materials[x$_],x$s),this._materials[x$_]=x$s},x$_._setShaderValuelightMap=function(x$b){this._setShaderValueTexture(3,x$b)},x$_._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},x$_._renderRenderableBoundBox=function(){var x$b=x$i_._debugPhasorSprite,x$_=this.boundingBox,x$s=x$h._tempBoundBoxCorners;x$_.getCorners(x$s),x$b.line(x$s[0],x$h._greenColor,x$s[1],x$h._greenColor),x$b.line(x$s[2],x$h._greenColor,x$s[3],x$h._greenColor),x$b.line(x$s[4],x$h._greenColor,x$s[5],x$h._greenColor),x$b.line(x$s[6],x$h._greenColor,x$s[7],x$h._greenColor),x$b.line(x$s[0],x$h._greenColor,x$s[3],x$h._greenColor),x$b.line(x$s[1],x$h._greenColor,x$s[2],x$h._greenColor),x$b.line(x$s[2],x$h._greenColor,x$s[6],x$h._greenColor),x$b.line(x$s[3],x$h._greenColor,x$s[7],x$h._greenColor),x$b.line(x$s[0],x$h._greenColor,x$s[4],x$h._greenColor),x$b.line(x$s[1],x$h._greenColor,x$s[5],x$h._greenColor),x$b.line(x$s[4],x$h._greenColor,x$s[7],x$h._greenColor),x$b.line(x$s[5],x$h._greenColor,x$s[6],x$h._greenColor)},x$_._calculateBoundingSphere=function(){throw"BaseRender: must override it."},x$_._calculateBoundingBox=function(){throw"BaseRender: must override it."},x$_._setShaderValueTexture=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_)},x$_._setShaderValueMatrix4x4=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_?x$_.elements:null)},x$_._setShaderValueColor=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_?x$_.elements:null)},x$_._setShaderValueBuffer=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_)},x$_._setShaderValueInt=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_)},x$_._setShaderValueBool=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_)},x$_._setShaderValueNumber=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_)},x$_._setShaderValueVector2=function(x$b,x$_){this._owner._shaderValues.setValue(x$b,x$_?x$_.elements:null)},x$_._addShaderDefine=function(x$b){this._owner._shaderDefineValue|=x$b},x$_._removeShaderDefine=function(x$b){this._owner._shaderDefineValue&=~x$b},x$_._renderUpdate=function(x$b){return!0},x$_._applyLightMapParams=function(){if(0<=this._lightmapIndex){var x$b=this._owner.scene;if(x$b){var x$_=x$b.getlightmaps()[this._lightmapIndex];x$_?(this._addShaderDefine(x$l_.SAHDERDEFINE_LIGHTMAP),x$_.loaded?this._setShaderValuelightMap(x$_):x$_.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(x$l_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(x$l_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(x$l_.SAHDERDEFINE_LIGHTMAP)},x$_._updateOctreeNode=function(){var x$b=this._treeNode;x$b&&this._octreeNodeNeedChange&&(x$b.updateObject(this),this._octreeNodeNeedChange=!1)},x$_._destroy=function(){this.offAll();var x$b=0,x$_=0;for(x$b=0,x$_=this._renderElements.length;x$b<x$_;x$b++)this._renderElements[x$b]._destroy();for(x$b=0,x$_=this._materials.length;x$b<x$_;x$b++)this._materials[x$b]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},x$Q(0,x$_,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),x$Q(0,x$_,"id",function(){return this._id}),x$Q(0,x$_,"material",function(){var x$b=this._materials[0];if(x$b&&!this._materialsInstance[0]){var x$_=this._getInstanceMaterial(x$b,0);this.event("materialchanged",[this,0,x$_])}return this._materials[0]},function(x$b){this.sharedMaterial=x$b}),x$Q(0,x$_,"sharedMaterial",function(){return this._materials[0]},function(x$b){var x$_=this._materials[0];x$_!==x$b&&(this._materials[0]=x$b,this._materialsInstance[0]=!1,this._changeMaterialReference(x$_,x$b),this.event("materialchanged",[this,0,x$b]))}),x$Q(0,x$_,"lightmapIndex",function(){return this._lightmapIndex},function(x$b){this._lightmapIndex=x$b,this._applyLightMapParams()}),x$Q(0,x$_,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(x$b){this._lightmapScaleOffset=x$b,this._setShaderValueColor(2,x$b),this._addShaderDefine(x$l_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),x$Q(0,x$_,"enable",function(){return this._enable},function(x$b){this._enable=x$b,this.event("enablechanged",[this,x$b])}),x$Q(0,x$_,"materials",function(){for(var x$b=0,x$_=this._materials.length;x$b<x$_;x$b++)if(!this._materialsInstance[x$b]){var x$s=this._getInstanceMaterial(this._materials[x$b],x$b);this.event("materialchanged",[this,x$b,x$s])}return this._materials.slice()},function(x$b){this.sharedMaterials=x$b}),x$Q(0,x$_,"sharedMaterials",function(){return this._materials.slice()},function(x$b){if(!x$b)throw new Error("MeshRender: shadredMaterials value can't be null.");var x$_=x$b.length;this._materialsInstance.length=x$_;for(var x$s=0;x$s<x$_;x$s++){var x$h=this._materials[x$s];x$h!==x$b[x$s]&&(this._materialsInstance[x$s]=!1,this._changeMaterialReference(x$h,x$b[x$s]),this.event("materialchanged",[this,x$s,x$b[x$s]]))}this._materials=x$b}),x$Q(0,x$_,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),x$Q(0,x$_,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var x$b=this.boundingBox;x$E_.add(x$b.min,x$b.max,this._boundingBoxCenter),x$E_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),x$Q(0,x$_,"receiveShadow",function(){return this._receiveShadow},function(x$b){this._receiveShadow!==x$b&&((this._receiveShadow=x$b)?this._addShaderDefine(x$V_.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(x$V_.SHADERDEFINE_RECEIVE_SHADOW))}),x$Q(0,x$_,"destroyed",function(){return this._destroyed}),x$h._uniqueIDCounter=0,x$p(x$h,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_,new x$E_]},"_greenColor",function(){return this._greenColor=new x$C_(0,1,0,1)}]),x$h}(),x$D_=function(x$b){function x$C(x$b){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,x$C.__super.call(this),this._localPosition=new x$E_,this._localRotation=new x$s_(0,0,0,1),this._localScale=new x$E_(1,1,1),this._localRotationEuler=new x$E_,this._localMatrix=new x$b_,this._position=new x$E_,this._rotation=new x$s_(0,0,0,1),this._scale=new x$E_(1,1,1),this._worldMatrix=new x$b_,this._forward=new x$E_,this._up=new x$E_,this._right=new x$E_,this._owner=x$b,this._childs=[]}x$V(x$C,"laya.d3.core.Transform3D",x$n);var x$_=x$C.prototype;return x$_._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)x$b_.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var x$b=x$C._tempVector30;x$E_.multiply(this.pivot,this._localScale,x$b);var x$_=x$C._tempVector31;x$E_.subtract(x$b,this.pivot,x$_);var x$s=x$C._tempVector32,x$h=this.localRotation;x$E_.transformQuat(x$b,x$h,x$s),x$E_.subtract(x$s,x$b,x$s);var x$x=x$C._tempVector33;x$E_.subtract(this._localPosition,x$_,x$x),x$E_.subtract(x$x,x$s,x$x),x$b_.createAffineTransformation(x$x,x$h,this._localScale,this._localMatrix)}},x$_._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldPositionRotationTransform()}},x$_._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldPositionScaleTransform()}},x$_._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldPositionTransform()}},x$_._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldPositionRotationTransform()}},x$_._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldPositionScaleTransform()}},x$_._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._onWorldTransform()}},x$_.translate=function(x$b,x$_){void 0===x$_&&(x$_=!0),x$_?(x$b_.createFromQuaternion(this.localRotation,x$C._tempMatrix0),x$E_.transformCoordinate(x$b,x$C._tempMatrix0,x$C._tempVector30),x$E_.add(this.localPosition,x$C._tempVector30,this._localPosition),this.localPosition=this._localPosition):(x$E_.add(this.position,x$b,this._position),this.position=this._position)},x$_.rotate=function(x$b,x$_,x$s){var x$h;void 0===x$_&&(x$_=!0),void 0===x$s&&(x$s=!0),x$h=x$s?x$b:(x$E_.scale(x$b,Math.PI/180,x$C._tempVector30),x$C._tempVector30),x$s_.createFromYawPitchRoll(x$h.y,x$h.x,x$h.z,x$C._tempQuaternion0),x$_?(x$s_.multiply(this._localRotation,x$C._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(x$s_.multiply(x$C._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},x$_.lookAt=function(x$b,x$_,x$s){void 0===x$s&&(x$s=!1);var x$h,x$x=x$b.elements;if(x$s){if(x$h=this._localPosition.elements,Math.abs(x$h[0]-x$x[0])<x$Hb.zeroTolerance&&Math.abs(x$h[1]-x$x[1])<x$Hb.zeroTolerance&&Math.abs(x$h[2]-x$x[2])<x$Hb.zeroTolerance)return;x$s_.lookAt(this._localPosition,x$b,x$_,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var x$n=this.position;if(x$h=x$n.elements,Math.abs(x$h[0]-x$x[0])<x$Hb.zeroTolerance&&Math.abs(x$h[1]-x$x[1])<x$Hb.zeroTolerance&&Math.abs(x$h[2]-x$x[2])<x$Hb.zeroTolerance)return;x$s_.lookAt(x$n,x$b,x$_,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},x$Q(0,x$_,"_isFrontFaceInvert",function(){var x$b=this.scale,x$_=x$b.x<0;return x$b.y<0&&(x$_=!x$_),x$b.z<0&&(x$_=!x$_),x$_}),x$Q(0,x$_,"owner",function(){return this._owner}),x$Q(0,x$_,"localRotation",function(){if(this._localQuaternionUpdate){var x$b=this._localRotationEuler.elements;x$s_.createFromYawPitchRoll(x$b[1]/x$C._angleToRandin,x$b[0]/x$C._angleToRandin,x$b[2]/x$C._angleToRandin,this._localRotation)}return this._localRotation},function(x$b){this._localRotation=x$b,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),x$Q(0,x$_,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?x$b_.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(x$b){null===this._parent?x$b.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),x$b_.multiply(this._localMatrix,x$b,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=x$b,this._worldUpdate=!1}),x$Q(0,x$_,"worldNeedUpdate",function(){return this._worldUpdate}),x$Q(0,x$_,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(x$b){this._localMatrix=x$b,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),x$Q(0,x$_,"dummy",function(){return this._dummy},function(x$b){this._dummy!==x$b&&(this._dummy&&(this._dummy._entity=null),x$b&&(x$b._entity=this),this._dummy=x$b)}),x$Q(0,x$_,"localPosition",function(){return this._localPosition},function(x$b){this._localPosition=x$b,this._localUpdate=!0,this._onWorldPositionTransform()}),x$Q(0,x$_,"position",function(){if(this._positionUpdate){if(null!=this._parent){var x$b=this._parent.position;x$E_.multiply(this._localPosition,this._parent.scale,x$C._tempVector30),x$E_.transformQuat(x$C._tempVector30,this._parent.rotation,x$C._tempVector30),x$E_.add(x$b,x$C._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(x$b){if(null!=this._parent){x$E_.subtract(x$b,this._parent.position,this._localPosition);var x$_=this._parent.scale.elements,x$s=x$_[0],x$h=x$_[1],x$x=x$_[2];if(1!==x$s||1!==x$h||1!==x$x){var x$n=x$C._tempVector30,x$E=x$n.elements;x$E[0]=1/x$s,x$E[1]=1/x$h,x$E[2]=1/x$x,x$E_.multiply(this._localPosition,x$n,this._localPosition)}this._parent.rotation.invert(x$C._tempQuaternion0),x$E_.transformQuat(this._localPosition,x$C._tempQuaternion0,this._localPosition)}else x$b.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=x$b,this._positionUpdate=!1}),x$Q(0,x$_,"localScale",function(){return this._localScale},function(x$b){this._localScale=x$b,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),x$Q(0,x$_,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(x$C._tempVector30);var x$b=x$C._tempVector30.elements,x$_=this._localRotationEuler.elements;x$_[0]=x$b[1]*x$C._angleToRandin,x$_[1]=x$b[0]*x$C._angleToRandin,x$_[2]=x$b[2]*x$C._angleToRandin}return this._localRotationEuler},function(x$b){this._localRotationEuler=x$b,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),x$Q(0,x$_,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?x$s_.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(x$b){null!=this._parent?(this._parent.rotation.invert(x$C._tempQuaternion0),x$s_.multiply(x$b,x$C._tempQuaternion0,this._localRotation)):x$b.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=x$b,this._rotationUpdate=!1}),x$Q(0,x$_,"scale",function(){return this._scaleUpdate&&(null!==this._parent?x$E_.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(x$b){if(null!==this._parent){var x$_=this._parent.scale.elements,x$s=x$C._tempVector30.elements;x$s[0]=1/x$_[0],x$s[1]=1/x$_[1],x$s[2]=1/x$_[2],x$E_.multiply(x$b,x$C._tempVector30,this._localScale)}else x$b.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=x$b,this._scaleUpdate=!1}),x$Q(0,x$_,"rotationEuler",null,function(x$b){x$s_.createFromYawPitchRoll(x$b.y,x$b.x,x$b.z,this._rotation),this.rotation=this._rotation}),x$Q(0,x$_,"forward",function(){var x$b=this.worldMatrix.elements;return this._forward.elements[0]=-x$b[8],this._forward.elements[1]=-x$b[9],this._forward.elements[2]=-x$b[10],this._forward}),x$Q(0,x$_,"up",function(){var x$b=this.worldMatrix.elements;return this._up.elements[0]=x$b[4],this._up.elements[1]=x$b[5],this._up.elements[2]=x$b[6],this._up}),x$Q(0,x$_,"right",function(){var x$b=this.worldMatrix.elements;return this._right.elements[0]=x$b[0],this._right.elements[1]=x$b[1],this._right.elements[2]=x$b[2],this._right}),x$Q(0,x$_,"parent",function(){return this._parent},function(x$b){if(this._parent!==x$b){if(this._parent){var x$_=this._parent._childs,x$s=x$_.indexOf(this);x$_.splice(x$s,1)}x$b&&(x$b._childs.push(this),x$b&&this._onWorldTransform()),this._parent=x$b}}),x$p(x$C,["_tempVector30",function(){return this._tempVector30=new x$E_},"_tempVector31",function(){return this._tempVector31=new x$E_},"_tempVector32",function(){return this._tempVector32=new x$E_},"_tempVector33",function(){return this._tempVector33=new x$E_},"_tempQuaternion0",function(){return this._tempQuaternion0=new x$s_},"_tempMatrix0",function(){return this._tempMatrix0=new x$b_},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),x$C}(),x$o_=(function(x$b){function x$_(){this._rotation=0,this._matNeedUpdte=!1,x$_.__super.call(this),this._matrix=new x$b_,this._offset=new x$n_,this._tiling=new x$n_(1,1)}x$V(x$_,"laya.d3.core.TransformUV",x$n);var x$s=x$_.prototype;x$$.imps(x$s,{"laya.d3.core.IClone":!0}),x$s._updateMatrix=function(){x$_._tempOffsetV3.elements[0]=this._offset.x,x$_._tempOffsetV3.elements[1]=this._offset.y,x$s_.createFromYawPitchRoll(0,0,this._rotation,x$_._tempRotationQua),x$_._tempTitlingV3.elements[0]=this._tiling.x,x$_._tempTitlingV3.elements[1]=this._tiling.y,x$b_.createAffineTransformation(x$_._tempOffsetV3,x$_._tempRotationQua,x$_._tempTitlingV3,this._matrix)},x$s.cloneTo=function(x$b){x$b._matrix=this._matrix.clone(),x$b._offset=this._offset.clone(),x$b._rotation=this._rotation,x$b._tiling=this._tiling.clone()},x$s.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$s,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),x$Q(0,x$s,"tiling",function(){return this._tiling},function(x$b){this._tiling=x$b,this._matNeedUpdte=!0}),x$Q(0,x$s,"offset",function(){return this._offset},function(x$b){this._offset=x$b,this._matNeedUpdte=!0}),x$Q(0,x$s,"rotation",function(){return this._rotation},function(x$b){this._rotation=x$b,this._matNeedUpdte=!0}),x$p(x$_,["_tempOffsetV3",function(){return this._tempOffsetV3=new x$E_(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new x$s_},"_tempTitlingV3",function(){return this._tempTitlingV3=new x$E_(1,1,1)}])}(),function(x$s){function x$b(){this.x=NaN,this.y=NaN,this.z=NaN,x$b.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}x$V(x$b,"laya.d3.core.particleShuriKen.module.shape.BoxShape",x$s);var x$_=x$b.prototype;x$_._getShapeBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=.5*-this.x,x$_[1]=.5*-this.y,x$_[2]=.5*-this.z;var x$s=x$b.max.elements;x$s[0]=.5*this.x,x$s[1]=.5*this.y,x$s[2]=.5*this.z},x$_._getSpeedBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=0,x$_[1]=0,x$_[2]=0;var x$s=x$b.max.elements;x$s[0]=0,x$s[1]=1,x$s[2]=0},x$_.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements,x$n=x$_.elements;x$s?(x$s.seed=x$h[16],x$A._randomPointInsideHalfUnitBox(x$b,x$s),x$h[16]=x$s.seed):x$A._randomPointInsideHalfUnitBox(x$b),x$x[0]=this.x*x$x[0],x$x[1]=this.y*x$x[1],x$x[2]=this.z*x$x[2],this.randomDirection?x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_):(x$n[0]=0,x$n[1]=0,x$n[2]=1)},x$_.cloneTo=function(x$b){x$s.prototype.cloneTo.call(this,x$b);var x$_=x$b;x$_.x=this.x,x$_.y=this.y,x$_.z=this.z,x$_.randomDirection=this.randomDirection}}(x$K),function(x$s){function x$E(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,x$E.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}x$V(x$E,"laya.d3.core.particleShuriKen.module.shape.CircleShape",x$s);var x$b=x$E.prototype;x$b._getShapeBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[2]=-this.radius,x$_[1]=0;var x$s=x$b.max.elements;x$s[0]=x$s[2]=this.radius,x$s[1]=0},x$b._getSpeedBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[1]=-1,x$_[2]=0;var x$s=x$b.max.elements;x$s[0]=x$s[1]=1,x$s[2]=0},x$b.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements,x$n=x$E._tempPositionPoint.elements;x$s?(x$s.seed=x$h[16],this.emitFromEdge?x$A._randomPointUnitArcCircle(this.arc,x$E._tempPositionPoint,x$s):x$A._randomPointInsideUnitArcCircle(this.arc,x$E._tempPositionPoint,x$s),x$h[16]=x$s.seed):this.emitFromEdge?x$A._randomPointUnitArcCircle(this.arc,x$E._tempPositionPoint):x$A._randomPointInsideUnitArcCircle(this.arc,x$E._tempPositionPoint),x$x[0]=-x$n[0],x$x[1]=x$n[1],x$x[2]=0,x$E_.scale(x$b,this.radius,x$b),this.randomDirection?x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_):x$b.cloneTo(x$_)},x$b.cloneTo=function(x$b){x$s.prototype.cloneTo.call(this,x$b);var x$_=x$b;x$_.radius=this.radius,x$_.arc=this.arc,x$_.emitFromEdge=this.emitFromEdge,x$_.randomDirection=this.randomDirection},x$p(x$E,["_tempPositionPoint",function(){return this._tempPositionPoint=new x$n_}])}(x$K),function(x$s){function x$P(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,x$P.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}x$V(x$P,"laya.d3.core.particleShuriKen.module.shape.ConeShape",x$s);var x$b=x$P.prototype;x$b._getShapeBoundBox=function(x$b){var x$_=this.radius+this.length*Math.sin(this.angle),x$s=this.length*Math.cos(this.angle),x$h=x$b.min.elements;x$h[0]=x$h[1]=-x$_,x$h[2]=0;var x$x=x$b.max.elements;x$x[0]=x$x[1]=x$_,x$x[2]=x$s},x$b._getSpeedBoundBox=function(x$b){var x$_=Math.sin(this.angle),x$s=x$b.min.elements;x$s[0]=x$s[1]=-x$_,x$s[2]=0;var x$h=x$b.max.elements;x$h[0]=x$s[1]=x$_,x$h[2]=1},x$b.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){var x$x,x$n=x$b.elements,x$E=x$_.elements,x$C=x$P._tempPositionPoint.elements,x$O=NaN,x$L=NaN,x$f=Math.cos(this.angle),x$p=Math.sin(this.angle);switch(this.emitType){case 0:x$s?(x$s.seed=x$h[16],x$A._randomPointInsideUnitCircle(x$P._tempPositionPoint,x$s),x$h[16]=x$s.seed):x$A._randomPointInsideUnitCircle(x$P._tempPositionPoint),x$O=x$C[0],x$L=x$C[1],x$n[0]=x$O*this.radius,x$n[1]=x$L*this.radius,x$n[2]=0,this.randomDirection?(x$s?(x$s.seed=x$h[17],x$A._randomPointInsideUnitCircle(x$P._tempDirectionPoint,x$s),x$h[17]=x$s.seed):x$A._randomPointInsideUnitCircle(x$P._tempDirectionPoint),x$x=x$P._tempDirectionPoint.elements,x$E[0]=x$x[0]*x$p,x$E[1]=x$x[1]*x$p):(x$E[0]=x$O*x$p,x$E[1]=x$L*x$p),x$E[2]=x$f;break;case 1:x$s?(x$s.seed=x$h[16],x$A._randomPointUnitCircle(x$P._tempPositionPoint,x$s),x$h[16]=x$s.seed):x$A._randomPointUnitCircle(x$P._tempPositionPoint),x$O=x$C[0],x$L=x$C[1],x$n[0]=x$O*this.radius,x$n[1]=x$L*this.radius,x$n[2]=0,this.randomDirection?(x$s?(x$s.seed=x$h[17],x$A._randomPointInsideUnitCircle(x$P._tempDirectionPoint,x$s),x$h[17]=x$s.seed):x$A._randomPointInsideUnitCircle(x$P._tempDirectionPoint),x$x=x$P._tempDirectionPoint.elements,x$E[0]=x$x[0]*x$p,x$E[1]=x$x[1]*x$p):(x$E[0]=x$O*x$p,x$E[1]=x$L*x$p),x$E[2]=x$f;break;case 2:x$s?(x$s.seed=x$h[16],x$A._randomPointInsideUnitCircle(x$P._tempPositionPoint,x$s)):x$A._randomPointInsideUnitCircle(x$P._tempPositionPoint),x$O=x$C[0],x$L=x$C[1],x$n[0]=x$O*this.radius,x$n[1]=x$L*this.radius,x$E[x$n[2]=0]=x$O*x$p,x$E[1]=x$L*x$p,x$E[2]=x$f,x$E_.normalize(x$_,x$_),x$s?(x$E_.scale(x$_,this.length*x$s.getFloat(),x$_),x$h[16]=x$s.seed):x$E_.scale(x$_,this.length*Math.random(),x$_),x$E_.add(x$b,x$_,x$b),this.randomDirection&&(x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_));break;case 3:x$s?(x$s.seed=x$h[16],x$A._randomPointUnitCircle(x$P._tempPositionPoint,x$s)):x$A._randomPointUnitCircle(x$P._tempPositionPoint),x$O=x$C[0],x$L=x$C[1],x$n[0]=x$O*this.radius,x$n[1]=x$L*this.radius,x$E[x$n[2]=0]=x$O*x$p,x$E[1]=x$L*x$p,x$E[2]=x$f,x$E_.normalize(x$_,x$_),x$s?(x$E_.scale(x$_,this.length*x$s.getFloat(),x$_),x$h[16]=x$s.seed):x$E_.scale(x$_,this.length*Math.random(),x$_),x$E_.add(x$b,x$_,x$b),this.randomDirection&&(x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_));break;default:throw new Error("ConeShape:emitType is invalid.")}},x$b.cloneTo=function(x$b){x$s.prototype.cloneTo.call(this,x$b);var x$_=x$b;x$_.angle=this.angle,x$_.radius=this.radius,x$_.length=this.length,x$_.emitType=this.emitType,x$_.randomDirection=this.randomDirection},x$p(x$P,["_tempPositionPoint",function(){return this._tempPositionPoint=new x$n_},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new x$n_}])}(x$K),function(x$s){function x$b(){this.radius=NaN,this.emitFromShell=!1,x$b.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}x$V(x$b,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",x$s);var x$_=x$b.prototype;x$_._getShapeBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[1]=x$_[2]=-this.radius;var x$s=x$b.max.elements;x$s[0]=x$s[1]=this.radius,x$s[2]=0},x$_._getSpeedBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[1]=-1,x$_[2]=0;var x$s=x$b.max.elements;x$s[0]=x$s[1]=x$s[2]=1},x$_.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){var x$x=x$b.elements;x$s?(x$s.seed=x$h[16],this.emitFromShell?x$A._randomPointUnitSphere(x$b,x$s):x$A._randomPointInsideUnitSphere(x$b,x$s),x$h[16]=x$s.seed):this.emitFromShell?x$A._randomPointUnitSphere(x$b):x$A._randomPointInsideUnitSphere(x$b),x$E_.scale(x$b,this.radius,x$b);var x$n=x$x[2];x$n<0&&(x$x[2]=-1*x$n),this.randomDirection?x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_):x$b.cloneTo(x$_)},x$_.cloneTo=function(x$b){x$s.prototype.cloneTo.call(this,x$b);var x$_=x$b;x$_.radius=this.radius,x$_.emitFromShell=this.emitFromShell,x$_.randomDirection=this.randomDirection}}(x$K),function(x$s){function x$b(){this.radius=NaN,this.emitFromShell=!1,x$b.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}x$V(x$b,"laya.d3.core.particleShuriKen.module.shape.SphereShape",x$s);var x$_=x$b.prototype;x$_._getShapeBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[1]=x$_[2]=-this.radius;var x$s=x$b.max.elements;x$s[0]=x$s[1]=x$s[2]=this.radius},x$_._getSpeedBoundBox=function(x$b){var x$_=x$b.min.elements;x$_[0]=x$_[1]=x$_[2]=-1;var x$s=x$b.max.elements;x$s[0]=x$s[1]=x$s[2]=1},x$_.generatePositionAndDirection=function(x$b,x$_,x$s,x$h){x$s?(x$s.seed=x$h[16],this.emitFromShell?x$A._randomPointUnitSphere(x$b,x$s):x$A._randomPointInsideUnitSphere(x$b,x$s),x$h[16]=x$s.seed):this.emitFromShell?x$A._randomPointUnitSphere(x$b):x$A._randomPointInsideUnitSphere(x$b),x$E_.scale(x$b,this.radius,x$b),this.randomDirection?x$s?(x$s.seed=x$h[17],x$A._randomPointUnitSphere(x$_,x$s),x$h[17]=x$s.seed):x$A._randomPointUnitSphere(x$_):x$b.cloneTo(x$_)},x$_.cloneTo=function(x$b){x$s.prototype.cloneTo.call(this,x$b);var x$_=x$b;x$_.radius=this.radius,x$_.emitFromShell=this.emitFromShell,x$_.randomDirection=this.randomDirection}}(x$K),function(x$b){function x$_(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,x$_.__super.call(this)}return x$V(x$_,"laya.d3.core.render.SubMeshRenderElement",x$N),x$_}()),x$M_=function(x$b){function x$w(x$b,x$_,x$s,x$h,x$x,x$n){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=x$b,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[x$V_.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[x$l_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[x$l_.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[x$S_.SHADERDEFINE_ALPHATEST]="ALPHATEST";x$w.__super.call(this,x$b,x$_,x$s,null,{}),this._attributeMap=x$h;var x$E;for(x$E in x$x){var x$C=x$x[x$E];switch(x$C[1]){case 0:this._renderElementUniformMap[x$E]=x$C[0];break;case 1:this._materialUniformMap[x$E]=x$C[0];break;case 2:this._spriteUniformMap[x$E]=x$C[0];break;case 3:this._cameraUniformMap[x$E]=x$C[0];break;case 4:this._sceneUniformMap[x$E]=x$C[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}x$V(x$w,"laya.d3.shader.ShaderCompile3D",x$t);var x$_=x$w.prototype;return x$_._definesToNameDic=function(x$b,x$_){for(var x$s={},x$h=1,x$x=0;x$x<32&&!(x$b<(x$h=1<<x$x));x$x++)if(x$b&x$h){var x$n=x$_[x$h];x$n&&(x$s[x$n]="")}return x$s},x$_.withCompile=function(x$b,x$_,x$s,x$h){var x$x,x$n,x$E;if(x$n=this.sharders[x$b])if(x$E=x$n[x$_]){if(x$x=x$E[x$s])return x$x}else x$E=x$n[x$_]=[];else x$E=(x$n=this.sharders[x$b]=[])[x$_]=[];var x$C,x$O=this._definesToNameDic(x$b,x$w._globalInt2name),x$L=this._definesToNameDic(x$_,this._spriteInt2name),x$f=this._definesToNameDic(x$s,this._materialInt2name),x$p={},x$P="";if(x$O)for(x$C in x$O)x$P+="#define "+x$C+"\n",x$p[x$C]=!0;if(x$L)for(x$C in x$L)x$P+="#define "+x$C+"\n",x$p[x$C]=!0;if(x$f)for(x$C in x$f)x$P+="#define "+x$C+"\n",x$p[x$C]=!0;var x$V=x$G_.nameKey.getName(this._name)+" compile ("+x$b+","+x$_+","+x$s+")",x$Q=this._VS.toscript(x$p,[]),x$y=this._PS.toscript(x$p,[]);x$W.now();if(x$x=x$G_.create(x$P+x$Q.join("\n"),x$P+x$y.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,x$h,x$V),x$E[x$s]=x$x,laya.d3.shader.ShaderCompile3D.debugMode)x$W.now();return x$x},x$_.precompileShaderWithShaderDefine=function(x$b,x$_,x$s){this.withCompile(x$b,x$_,x$s,!0)},x$_.addMaterialDefines=function(x$b){var x$_=x$b.defines;for(var x$s in x$_){var x$h=x$_[x$s],x$x=parseInt(x$s);this._materialInt2name[x$x]=x$h,this._materialName2Int[x$h]=x$x}},x$_.addSpriteDefines=function(x$b){var x$_=x$b.defines;for(var x$s in x$_){var x$h=x$_[x$s],x$x=parseInt(x$s);this._spriteInt2name[x$x]=x$h,this._spriteName2Int[x$h]=x$x}},x$_.getMaterialDefineByName=function(x$b){return this._materialName2Int[x$b]},x$_.registerMaterialDefine=function(x$b){var x$_=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[x$_]=x$b,this._materialName2Int[x$b]=x$_},x$_.registerSpriteDefine=function(x$b){var x$_=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[x$_]=x$b,this._spriteName2Int[x$b]=x$_},x$w._globalRegDefine=function(x$b,x$_){x$w._globalInt2name[x$_]=x$b},x$w.add=function(x$b,x$_,x$s,x$h,x$x){return laya.d3.shader.ShaderCompile3D._preCompileShader[x$b]=new x$w(x$b,x$_,x$s,x$h,x$x,x$t.includes)},x$w.get=function(x$b){return laya.d3.shader.ShaderCompile3D._preCompileShader[x$G_.nameKey.getID(x$b)]},x$w._preCompileShader={},x$w._globalInt2name=[],x$w.debugMode=!1,x$w.SHADERDEFINE_HIGHPRECISION=1,x$w.SHADERDEFINE_FOG=4,x$w.SHADERDEFINE_DIRECTIONLIGHT=8,x$w.SHADERDEFINE_POINTLIGHT=16,x$w.SHADERDEFINE_SPOTLIGHT=32,x$w.SHADERDEFINE_UV0=64,x$w.SHADERDEFINE_COLOR=128,x$w.SHADERDEFINE_UV1=256,x$w.SAHDERDEFINE_DEPTHFOG=131072,x$w}(),x$r_=function(x$b){function x$Q(){x$Q.__super.call(this)}x$V(x$Q,"laya.d3.graphics.MeshSprite3DStaticBatchManager",x$hb);var x$_=x$Q.prototype;return x$_._getStaticBatch=function(x$b,x$_,x$s,x$h){var x$x,x$n;return x$n=x$b?x$b.id.toString()+x$s.id.toString()+x$_.id.toString()+x$h.toString():x$s.id.toString()+x$_.id.toString()+x$h.toString(),this._staticBatches[x$n]?x$x=this._staticBatches[x$n]:this._staticBatches[x$n]=x$x=new x$k_(x$n,this,x$b,x$_,x$s),x$x},x$_._initStaticBatchs=function(x$b){var x$_,x$s;this._initBatchRenderElements.sort(x$Q._sortPrepareStaticBatch);for(var x$h,x$x=!1,x$n=0,x$E=0,x$C=this._initBatchRenderElements.length;x$E<x$C;x$E++){var x$O,x$L=this._initBatchRenderElements[x$E],x$f=x$L.renderObj._getVertexBuffer(0);x$L._sprite3D;if(x$s===x$f.vertexDeclaration&&x$_===x$L._material)if(x$x)x$h._addCombineBatchRenderObjTest(x$L)?(x$O=x$L._staticBatch)!==x$h&&(x$O&&x$O._deleteCombineBatchRenderObj(x$L),x$h._addCombineBatchRenderObj(x$L)):(x$x=!1,x$n++);else{var x$p=this._initBatchRenderElements[x$E-1],x$P=x$p.renderObj,x$V=x$L.renderObj;x$x=!(65535<x$P._getVertexBuffer().vertexCount+x$V._getVertexBuffer().vertexCount)&&(x$h=this._getStaticBatch(x$b,x$s,x$_,x$n),(x$O=x$p._staticBatch)!==x$h&&(x$O&&x$O._deleteCombineBatchRenderObj(x$p),x$h._addCombineBatchRenderObj(x$p)),(x$O=x$L._staticBatch)!==x$h&&(x$O&&x$O._deleteCombineBatchRenderObj(x$L),x$h._addCombineBatchRenderObj(x$L)),!0)}else x$x=!1,x$n=0;x$_=x$L._material,x$s=x$f.vertexDeclaration}},x$Q._sortPrepareStaticBatch=function(x$b,x$_){var x$s=x$b._render,x$h=x$_._render,x$x=x$s.lightmapIndex-x$h.lightmapIndex;if(0!=x$x)return x$x;var x$n=x$s.receiveShadow-x$h.receiveShadow;if(0!=x$n)return x$n;var x$E=x$b._mainSortID-x$_._mainSortID;return 0==x$E?x$b.renderObj.triangleCount-x$_.renderObj.triangleCount:x$E},x$Q}(),x$k_=function(x$b){function x$n(x$b,x$_,x$s,x$h,x$x){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,x$n.__super.call(this,x$b,x$_,x$s),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=x$h,this._material=x$x}x$V(x$n,"laya.d3.graphics.SubMeshStaticBatch",x$xb);var x$_=x$n.prototype;return x$_._compareBatchRenderElement=function(x$b,x$_){return x$b._batchIndexStart>x$_._batchIndexStart},x$_._addCombineBatchRenderObjTest=function(x$b){var x$_=x$b.renderObj._vertexCount;return!(65535<(0<x$_?this._currentCombineVertexCount+x$_:this._currentCombineVertexCount+x$b.renderObj._getVertexBuffer().vertexCount))},x$_._addCombineBatchRenderObj=function(x$b){var x$_=x$b.renderObj,x$s=x$_._vertexCount;this._initBatchRenderElements.push(x$b),x$b._staticBatch=this,0<x$s?(this._currentCombineIndexCount+=x$_._indexCount,this._currentCombineVertexCount+=x$s):(this._currentCombineIndexCount=this._currentCombineIndexCount+x$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+x$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0},x$_._deleteCombineBatchRenderObj=function(x$b){var x$_=x$b.renderObj,x$s=this._initBatchRenderElements.indexOf(x$b);if(-1!==x$s){this._initBatchRenderElements.splice(x$s,1),x$b._staticBatch=null;var x$h=x$_._vertexCount;0<x$h?(this._currentCombineIndexCount=this._currentCombineIndexCount-x$_._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-x$h):(this._currentCombineIndexCount=this._currentCombineIndexCount-x$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-x$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},x$_._finishInit=function(){if(this._needFinishCombine){var x$b=0,x$_=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var x$s=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),x$h=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=x$K_.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=x$a_.create("ushort",this._currentCombineIndexCount,35044);for(var x$x=0,x$n=this._initBatchRenderElements.length;x$x<x$n;x$x++){var x$E=this._initBatchRenderElements[x$x],x$C=x$E.renderObj,x$O=x$C._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,x$E._sprite3D),x$L=x$C.getIndices(),x$f=x$E._sprite3D.transform._isFrontFaceInvert,x$p=x$b/(this._vertexDeclaration.vertexStride/4)-x$C._vertexStart,x$P=x$_,x$V=x$P+x$L.length;x$E._batchIndexStart=x$P,x$E._batchIndexEnd=x$V,x$h.set(x$L,x$_);var x$Q=0;if(x$f)for(x$Q=x$P;x$Q<x$V;x$Q+=3){x$h[x$Q]=x$p+x$h[x$Q];var x$y=x$h[x$Q+1],x$w=x$h[x$Q+2];x$h[x$Q+1]=x$p+x$w,x$h[x$Q+2]=x$p+x$y}else for(x$Q=x$P;x$Q<x$V;x$Q+=3)x$h[x$Q]=x$p+x$h[x$Q],x$h[x$Q+1]=x$p+x$h[x$Q+1],x$h[x$Q+2]=x$p+x$h[x$Q+2];x$_+=x$L.length,x$s.set(x$O,x$b),x$b+=x$O.length}this._vertexBuffer.setData(x$s),this._indexBuffer.setData(x$h),this._needFinishCombine=!1}},x$_._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new x$o_)},x$_._getRenderElement=function(x$b,x$_,x$s){for(var x$h,x$x,x$n=this._batchRenderElements.length,x$E=!0,x$C=0;x$C<x$n;x$C++){var x$O,x$L,x$f=(x$x=this._batchRenderElements[x$C])._sprite3D._render;if(0!==x$C&&(x$E=(x$O=(x$h=this._batchRenderElements[x$C-1])._sprite3D._render).lightmapIndex!==x$f.lightmapIndex||x$O.receiveShadow!==x$f.receiveShadow||x$h._batchIndexEnd!==x$x._batchIndexStart),x$E){(x$L=this._getCombineRenderElementFromPool()).renderObj=this,x$L._material=this._material,x$L._batchIndexStart=x$x._batchIndexStart,x$L._batchIndexEnd=x$x._batchIndexEnd;var x$p=x$f.lightmapIndex,x$P=x$p+1,x$V=this._batchOwnerIndices[x$P];x$V||(x$V=this._batchOwnerIndices[x$P]=[]);var x$Q,x$y=x$V[x$x._render.receiveShadow?1:0];void 0===x$y?(x$V[x$f.receiveShadow?1:0]=this._batchOwners.length,(x$Q=new x$X_(null,"StaticBatchMeshSprite3D"))._scene=x$_,x$Q._transform=this._rootOwner?this._rootOwner._transform:null,x$Q._render.lightmapIndex=x$p,x$Q._render.receiveShadow=x$x._render.receiveShadow,this._batchOwners.push(x$Q)):x$Q=this._batchOwners[x$y],x$Q._render._renderUpdate(x$s),x$L._sprite3D=x$Q,x$b.push(x$L)}else x$L._batchIndexEnd=x$x._batchIndexEnd}},x$_._beforeRender=function(x$b){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},x$_._render=function(x$b){var x$_=x$b.renderElement,x$s=x$_._batchIndexStart,x$h=x$_._batchIndexEnd-x$s;x$Z.mainContext.drawElements(4,x$h,5123,2*x$s),x$M.drawCall++,x$M.trianglesFaces+=x$h/3},x$_.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},x$_._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),this._vertexBuffer},x$n}(),x$B_=function(x$b){function x$_(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,x$_.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}x$V(x$_,"laya.d3.core.ComponentNode",x$L);var x$s=x$_.prototype;return x$s.addComponent=function(x$b){var x$_,x$s=this._componentsMap.indexOf(x$b);if(-1===x$s)x$_=[],this._componentsMap.push(x$b),this._typeComponentsIndices.push(x$_);else if(x$_=this._typeComponentsIndices[x$s],this._components[x$_[0]].isSingleton)throw new Error("无法单实例创建"+x$b+"组件，"+x$b+"组件已存在！");var x$h=x$x.getInstance(x$b);return x$_.push(this._components.length),this._components.push(x$h),x$h instanceof laya.d3.component.Script&&this._scripts.push(x$h),x$h._initialize(this),x$h},x$s._removeComponent=function(x$b,x$_){var x$s=this._typeComponentsIndices[x$b],x$h=x$s[x$_],x$x=this._components[x$h];this._components.splice(x$h,1),x$x instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(x$x),1),x$s.splice(x$_,1),0===x$s.length&&(this._typeComponentsIndices.splice(x$b,1),this._componentsMap.splice(x$b,1));for(var x$n=0,x$E=this._componentsMap.length;x$n<x$E;x$n++)for(var x$C=(x$s=this._typeComponentsIndices[x$n]).length-1;0<=x$C;x$C--){var x$O=x$s[x$C];if(!(x$h<x$O))break;x$s[x$C]=--x$O}x$x._destroy()},x$s.getComponentByType=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s=this._componentsMap.indexOf(x$b);return-1===x$s?null:this._components[this._typeComponentsIndices[x$s][x$_]]},x$s.getComponentsByType=function(x$b,x$_){var x$s=this._componentsMap.indexOf(x$b);if(-1!==x$s){var x$h=this._typeComponentsIndices[x$s],x$x=x$h.length;x$_.length=x$x;for(var x$n=0;x$n<x$x;x$n++)x$_[x$n]=this._components[x$h[x$n]]}else x$_.length=0},x$s.getComponentByIndex=function(x$b){return this._components[x$b]},x$s.removeComponentByType=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s=this._componentsMap.indexOf(x$b);-1!==x$s&&this._removeComponent(x$s,x$_)},x$s.removeComponentsByType=function(x$b){var x$_=this._componentsMap.indexOf(x$b);if(-1!==x$_)for(var x$s=this._typeComponentsIndices[x$_],x$h=0,x$x=x$s.length;x$h<x$x;x$s.length<x$x?x$x--:x$h++)this._removeComponent(x$_,x$h)},x$s.removeAllComponent=function(){for(var x$b=0,x$_=this._componentsMap.length;x$b<x$_;this._componentsMap.length<x$_?x$_--:x$b++)this.removeComponentsByType(this._componentsMap[x$b])},x$s._updateComponents=function(x$b){for(var x$_=0,x$s=this._components.length;x$_<x$s;x$_++){var x$h=this._components[x$_];!x$h.started&&(x$h._start(x$b),x$h.started=!0),x$h.enable&&x$h._update(x$b)}},x$s._lateUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._lateUpdate(x$b)}},x$s._preRenderUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._preRenderUpdate(x$b)}},x$s._postRenderUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._postRenderUpdate(x$b)}},x$_}(),x$S_=function(x$h){function x$b(){x$b.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new x$P_,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new x$C_(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}x$V(x$b,"laya.d3.core.material.BaseMaterial",x$h);var x$_=x$b.prototype;return x$$.imps(x$_,{"laya.d3.core.IClone":!0}),x$_._addShaderDefine=function(x$b){this._shaderDefineValue|=x$b},x$_._removeShaderDefine=function(x$b){this._shaderDefineValue&=~x$b},x$_._addDisablePublicShaderDefine=function(x$b){this._disablePublicShaderDefine|=x$b},x$_._removeDisablePublicShaderDefine=function(x$b){this._disablePublicShaderDefine&=~x$b},x$_._setBuffer=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_),this._values[x$b]=x$_},x$_._getBuffer=function(x$b){return this._values[x$b]},x$_._setMatrix4x4=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_?x$_.elements:null),this._values[x$b]=x$_},x$_._getMatrix4x4=function(x$b){return this._values[x$b]},x$_._setInt=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_),this._values[x$b]=x$_},x$_._getInt=function(x$b){return this._values[x$b]},x$_._setNumber=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_),this._values[x$b]=x$_},x$_._getNumber=function(x$b){return this._values[x$b]},x$_._setBool=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_),this._values[x$b]=x$_},x$_._getBool=function(x$b){return this._values[x$b]},x$_._setVector2=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_?x$_.elements:null),this._values[x$b]=x$_},x$_._getVector2=function(x$b){return this._values[x$b]},x$_._setColor=function(x$b,x$_){this._shaderValues.setValue(x$b,x$_?x$_.elements:null),this._values[x$b]=x$_},x$_._getColor=function(x$b){return this._values[x$b]},x$_._setTexture=function(x$b,x$_){var x$s=this._values[x$b];this._values[x$b]=x$_,this._shaderValues.setValue(x$b,x$_),0<this.referenceCount&&(x$s&&x$s._removeReference(),x$_&&x$_._addReference())},x$_._getTexture=function(x$b){return this._values[x$b]},x$_._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},x$_._getShader=function(x$b,x$_,x$s){var x$h=(x$b|x$_)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(x$h,x$s,this._shaderDefineValue),this._shader},x$_._setRenderStateBlendDepth=function(){var x$b=x$Z.mainContext;switch(x$J.setDepthMask(x$b,this.depthWrite),0===this.depthTest?x$J.setDepthTest(x$b,!1):(x$J.setDepthTest(x$b,!0),x$J.setDepthFunc(x$b,this.depthTest)),this.blend){case 0:x$J.setBlend(x$b,!1);break;case 1:x$J.setBlend(x$b,!0),x$J.setBlendFunc(x$b,this.srcBlend,this.dstBlend);break;case 2:x$J.setBlend(x$b,!0)}},x$_._setRenderStateFrontFace=function(x$b,x$_){var x$s=x$Z.mainContext,x$h=0;switch(this.cull){case 0:x$J.setCullFace(x$s,!1);break;case 1:x$J.setCullFace(x$s,!0),x$h=x$b?x$_&&x$_._isFrontFaceInvert?2305:2304:x$_&&x$_._isFrontFaceInvert?2304:2305,x$J.setFrontFace(x$s,x$h);break;case 2:x$J.setCullFace(x$s,!0),x$h=x$b?x$_&&x$_._isFrontFaceInvert?2304:2305:x$_&&x$_._isFrontFaceInvert?2305:2304,x$J.setFrontFace(x$s,x$h)}},x$_.onAsynLoaded=function(x$b,x$_,x$s){var x$h=x$_[0],x$x=x$_[1];switch(x$h.version){case"LAYAMATERIAL:01":var x$n=0,x$E=0,x$C=x$h.props;for(var x$O in x$C)switch(x$O){case"vectors":var x$L=x$C[x$O];for(x$n=0,x$E=x$L.length;x$n<x$E;x$n++){var x$f=x$L[x$n],x$p=x$f.value;switch(x$p.length){case 2:this[x$f.name]=new x$n_(x$p[0],x$p[1]);break;case 3:this[x$f.name]=new x$E_(x$p[0],x$p[1],x$p[2]);break;case 4:this[x$f.name]=new x$C_(x$p[0],x$p[1],x$p[2],x$p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var x$P=x$C[x$O];for(x$n=0,x$E=x$P.length;x$n<x$E;x$n++){var x$V=x$P[x$n],x$Q=x$V.path;x$Q&&(this[x$V.name]=x$i.getRes(x$x[x$Q]))}break;case"defines":var x$y=x$C[x$O];for(x$n=0,x$E=x$y.length;x$n<x$E;x$n++){var x$w=this._shaderCompile.getMaterialDefineByName(x$y[x$n]);this._addShaderDefine(x$w)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[x$O]=x$C[x$O];break;case"renderQueue":switch(x$C[x$O]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[x$O]=x$C[x$O]}break;case"LAYAMATERIAL:02":for(x$O in x$C=x$h.props)switch(x$O){case"vectors":for(x$n=0,x$E=(x$L=x$C[x$O]).length;x$n<x$E;x$n++)switch((x$p=(x$f=x$L[x$n]).value).length){case 2:this[x$f.name]=new x$n_(x$p[0],x$p[1]);break;case 3:this[x$f.name]=new x$E_(x$p[0],x$p[1],x$p[2]);break;case 4:this[x$f.name]=new x$C_(x$p[0],x$p[1],x$p[2],x$p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(x$n=0,x$E=(x$P=x$C[x$O]).length;x$n<x$E;x$n++)(x$Q=(x$V=x$P[x$n]).path)&&(this[x$V.name]=x$i.getRes(x$x[x$Q]));break;case"defines":for(x$n=0,x$E=(x$y=x$C[x$O]).length;x$n<x$E;x$n++)x$w=this._shaderCompile.getMaterialDefineByName(x$y[x$n]),this._addShaderDefine(x$w);break;default:this[x$O]=x$C[x$O]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},x$_._addReference=function(){x$h.prototype._addReference.call(this);for(var x$b=0,x$_=this._values.length;x$b<x$_;x$b++){var x$s=this._values[x$b];x$s&&x$s instanceof laya.d3.resource.BaseTexture&&x$s._addReference()}},x$_._removeReference=function(){x$h.prototype._removeReference.call(this);for(var x$b=0,x$_=this._values.length;x$b<x$_;x$b++){var x$s=this._values[x$b];x$s&&x$s instanceof laya.d3.resource.BaseTexture&&x$s._removeReference()}},x$_.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},x$_.setShaderName=function(x$b){var x$_=x$G_.nameKey.getID(x$b);if(-1===x$_)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=x$M_._preCompileShader[x$_]},x$_.cloneTo=function(x$b){var x$_=x$b;x$_.name=this.name,x$_.cull=this.cull,x$_.blend=this.blend,x$_.srcBlend=this.srcBlend,x$_.dstBlend=this.dstBlend,x$_.srcBlendRGB=this.srcBlendRGB,x$_.dstBlendRGB=this.dstBlendRGB,x$_.srcBlendAlpha=this.srcBlendAlpha,x$_.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(x$_.blendConstColor),x$_.blendEquation=this.blendEquation,x$_.blendEquationRGB=this.blendEquationRGB,x$_.blendEquationAlpha=this.blendEquationAlpha,x$_.depthTest=this.depthTest,x$_.depthWrite=this.depthWrite,x$_.renderQueue=this.renderQueue,x$_._shader=this._shader,x$_._disablePublicShaderDefine=this._disablePublicShaderDefine,x$_._shaderDefineValue=this._shaderDefineValue;var x$s,x$h=0,x$x=x$_._shaderValues;x$_._shaderValues.data.length=this._shaderValues.data.length;var x$n=this._values.length,x$E=x$_._values;for(x$h=0,x$s=x$E.length=x$n;x$h<x$s;x$h++){var x$C=this._values[x$h];if(x$C)if("number"==typeof x$C)x$E[x$h]=x$C,x$x.data[x$h]=x$C;else if("number"==typeof x$C&&Math.floor(x$C)==x$C)x$E[x$h]=x$C,x$x.data[x$h]=x$C;else if("boolean"==typeof x$C)x$E[x$h]=x$C,x$x.data[x$h]=x$C;else if(x$C instanceof laya.d3.math.Vector2){var x$O=x$E[x$h]||(x$E[x$h]=new x$n_);x$C.cloneTo(x$O),x$x.data[x$h]=x$O.elements}else if(x$C instanceof laya.d3.math.Vector3){var x$L=x$E[x$h]||(x$E[x$h]=new x$E_);x$C.cloneTo(x$L),x$x.data[x$h]=x$L.elements}else if(x$C instanceof laya.d3.math.Vector4){var x$f=x$E[x$h]||(x$E[x$h]=new x$C_);x$C.cloneTo(x$f),x$x.data[x$h]=x$f.elements}else if(x$C instanceof laya.d3.math.Matrix4x4){var x$p=x$E[x$h]||(x$E[x$h]=new x$b_);x$C.cloneTo(x$p),x$x.data[x$h]=x$p.elements}else x$C instanceof laya.d3.resource.BaseTexture&&(x$E[x$h]=x$C,x$x.data[x$h]=x$C)}},x$_.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$Q(0,x$_,"alphaTestValue",function(){return this._getNumber(0)},function(x$b){this._setNumber(0,x$b)}),x$Q(0,x$_,"alphaTest",function(){return this._alphaTest},function(x$b){(this._alphaTest=x$b)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),x$b.__init__=function(){x$b.SHADERDEFINE_ALPHATEST=x$b.shaderDefines.registerDefine("ALPHATEST")},x$b.RENDERQUEUE_OPAQUE=2e3,x$b.RENDERQUEUE_ALPHATEST=2450,x$b.RENDERQUEUE_TRANSPARENT=3e3,x$b.CULL_NONE=0,x$b.CULL_FRONT=1,x$b.CULL_BACK=2,x$b.BLEND_DISABLE=0,x$b.BLEND_ENABLE_ALL=1,x$b.BLEND_ENABLE_SEPERATE=2,x$b.BLENDPARAM_ZERO=0,x$b.BLENDPARAM_ONE=1,x$b.BLENDPARAM_SRC_COLOR=768,x$b.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,x$b.BLENDPARAM_DST_COLOR=774,x$b.BLENDPARAM_ONE_MINUS_DST_COLOR=775,x$b.BLENDPARAM_SRC_ALPHA=770,x$b.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,x$b.BLENDPARAM_DST_ALPHA=772,x$b.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,x$b.BLENDPARAM_SRC_ALPHA_SATURATE=776,x$b.BLENDEQUATION_ADD=0,x$b.BLENDEQUATION_SUBTRACT=1,x$b.BLENDEQUATION_REVERSE_SUBTRACT=2,x$b.DEPTHTEST_OFF=0,x$b.DEPTHTEST_NEVER=512,x$b.DEPTHTEST_LESS=513,x$b.DEPTHTEST_EQUAL=514,x$b.DEPTHTEST_LEQUAL=515,x$b.DEPTHTEST_GREATER=516,x$b.DEPTHTEST_NOTEQUAL=517,x$b.DEPTHTEST_GEQUAL=518,x$b.DEPTHTEST_ALWAYS=519,x$b.SHADERDEFINE_ALPHATEST=1,x$b.ALPHATESTVALUE=0,x$p(x$b,["shaderDefines",function(){return this.shaderDefines=new x$f_}]),x$b}(x$w),x$Z_=function(x$b){function x$_(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,x$_.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}x$V(x$_,"laya.d3.resource.BaseTexture",x$w);var x$s=x$_.prototype;return x$Q(0,x$s,"width",function(){return this._width}),x$Q(0,x$s,"repeat",function(){return this._repeat},function(x$b){if(this._repeat!==x$b&&(this._repeat=x$b,this._source)){var x$_=x$Z.mainContext;x$J.bindTexture(x$_,this._type,this._source),x$c.isPOT(this._width,this._height)&&this._repeat?(x$_.texParameteri(this._type,10242,10497),x$_.texParameteri(this._type,10243,10497)):(x$_.texParameteri(this._type,10242,33071),x$_.texParameteri(this._type,10243,33071))}}),x$Q(0,x$s,"height",function(){return this._height}),x$Q(0,x$s,"magFifter",function(){return this._magFifter},function(x$b){(this._magFifter=x$b)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(x$b)}),x$Q(0,x$s,"wrapModeV",function(){return this._wrapModeV}),x$Q(0,x$s,"size",function(){return this._size}),x$Q(0,x$s,"wrapModeU",function(){return this._wrapModeU}),x$Q(0,x$s,"mipmap",function(){return this._mipmap},function(x$b){this._mipmap=x$b,this._mipmap!=x$b&&this._conchTexture&&this._conchTexture.setMipMap(x$b)}),x$Q(0,x$s,"minFifter",function(){return this._minFifter},function(x$b){this._minFifter=x$b,this._minFifter!=x$b&&this._conchTexture&&this._conchTexture.setMinFifter(x$b)}),x$Q(0,x$s,"format",function(){return this._format}),x$Q(0,x$s,"source",function(){return this.activeResource(),this._source}),x$Q(0,x$s,"defaulteTexture",function(){return x$F_.grayTexture}),x$_.WARPMODE_REPEAT=0,x$_.WARPMODE_CLAMP=1,x$_}(),x$J_=function(x$b){function x$_(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,x$_.__super.call(this),this._boundingBoxCorners=x$h(8,null)}x$V(x$_,"laya.d3.resource.models.BaseMesh",x$w);var x$s=x$_.prototype;return x$s._getPositions=function(){throw new Error("未Override,请重载该属性！")},x$s._generateBoundingObject=function(){this._boundingSphere=new x$vb(new x$E_,0),x$vb.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new x$mb(new x$E_,new x$E_),x$mb.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},x$s.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},x$s.getRenderElement=function(x$b){throw new Error("未Override,请重载该属性！")},x$Q(0,x$s,"subMeshCount",function(){return this._subMeshCount}),x$Q(0,x$s,"boundingBox",function(){return this._boundingBox}),x$Q(0,x$s,"boundingBoxCorners",function(){return this._boundingBoxCorners}),x$Q(0,x$s,"boundingSphere",function(){return this._boundingSphere}),x$_}(),x$W_=(function(x$b){function x$_(){x$_.__super.call(this)}x$V(x$_,"laya.d3.component.Script",x$t_);var x$s=x$_.prototype;x$s.onTriggerEnter=function(x$b){},x$s.onTriggerExit=function(x$b){},x$s.onTriggerStay=function(x$b){},x$Q(0,x$s,"isSingleton",function(){return x$_._isSingleton}),x$_._isSingleton=!1}(),function(x$b){function x$_(x$b){this._owner=null,this._sharedMesh=null,x$_.__super.call(this),this._owner=x$b}x$V(x$_,"laya.d3.core.MeshFilter",x$b);var x$s=x$_.prototype;return x$s._sharedMeshLoaded=function(){this.event("loaded")},x$s._destroy=function(){x$b.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},x$Q(0,x$s,"sharedMesh",function(){return this._sharedMesh},function(x$b){var x$_=this._sharedMesh;x$_&&x$_._removeReference(),(this._sharedMesh=x$b)._addReference(),this.event("meshchanged",[this,x$_,x$b]),x$b.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),x$Q(0,x$s,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),x$Q(0,x$s,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),x$Q(0,x$s,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),x$Q(0,x$s,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),x$_}(x$c_)),x$T_=function(x$b){function x$_(x$b){x$_.__super.call(this,x$b),x$b.meshFilter.on("meshchanged",this,this._onMeshChanged)}x$V(x$_,"laya.d3.core.MeshRender",x$$_);var x$s=x$_.prototype;return x$s._onMeshChanged=function(x$b,x$_,x$s){x$s.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:x$s.once("loaded",this,this._onMeshLoaed)},x$s._onMeshLoaed=function(x$b,x$_){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},x$s._calculateBoundingSphereByInitSphere=function(x$b){var x$_=NaN,x$s=this._owner.transform,x$h=x$s.scale.elements,x$x=Math.abs(x$h[0]),x$n=Math.abs(x$h[1]),x$E=Math.abs(x$h[2]);x$_=x$n<=x$x&&x$E<=x$x?x$x:x$E<=x$n?x$n:x$E,x$E_.transformCoordinate(x$b.center,x$s.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=x$b.radius*x$_},x$s._calculateBoundBoxByInitCorners=function(x$b){for(var x$_=this._owner.transform.worldMatrix,x$s=0;x$s<8;x$s++)x$E_.transformCoordinate(x$b[x$s],x$_,x$$_._tempBoundBoxCorners[x$s]);x$mb.createfromPoints(x$$_._tempBoundBoxCorners,this._boundingBox)},x$s._calculateBoundingSphere=function(){var x$b=this._owner.meshFilter.sharedMesh;null==x$b||null==x$b.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(x$b.boundingSphere)},x$s._calculateBoundingBox=function(){var x$b=this._owner.meshFilter.sharedMesh;null==x$b||null==x$b.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(x$b.boundingBoxCorners)},x$s._renderUpdate=function(x$b){var x$_=this._owner.transform;if(x$_){this._setShaderValueMatrix4x4(0,x$_.worldMatrix);var x$s=this._owner.getProjectionViewWorldMatrix(x$b);this._setShaderValueMatrix4x4(1,x$s)}else this._setShaderValueMatrix4x4(0,x$b_.DEFAULT),this._setShaderValueMatrix4x4(1,x$b);return x$i_.debugMode&&this._renderRenderableBoundBox(),!0},x$_}(),x$q_=function(x$_){function x$h(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,x$h.__super.call(this),this._renderState=new x$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new x$P_,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new x$_b,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new x$E_(.7,.7,.7),this.ambientColor=new x$E_(.212,.227,.259),x$Z.shaderHighPrecision&&this.addShaderDefine(x$M_.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}x$V(x$h,"laya.d3.core.scene.Scene",x$_);var x$b=x$h.prototype;return x$$.imps(x$b,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),x$b._setUrl=function(x$b){this._url=x$b},x$b._getGroup=function(){return this._group},x$b._setGroup=function(x$b){this._group=x$b},x$b._display=function(){x$$.stage._scenes.push(this),x$$.stage._scenes.sort(x$h._sortScenes);for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++){var x$s=this._childs[x$b];x$s.active&&x$s._activeHierarchy()}},x$b._unDisplay=function(){var x$b=x$$.stage._scenes;x$b.splice(x$b.indexOf(this),1);for(var x$_=0,x$s=this._childs.length;x$_<x$s;x$_++){var x$h=this._childs[x$_];x$h.active&&x$h._inActiveHierarchy()}},x$b._addChild3D=function(x$b){x$b.transform._onWorldTransform(),x$b._setBelongScene(this),this.displayedInStage&&x$b.active&&x$b._activeHierarchy()},x$b._removeChild3D=function(x$b){x$b.transform.parent=null,this.displayedInStage&&x$b.active&&x$b._inActiveHierarchy(),x$b._setUnBelongScene()},x$b.initOctree=function(x$b,x$_,x$s,x$h,x$x){void 0===x$x&&(x$x=6),this.treeSize=new x$E_(x$b,x$_,x$s),this.treeLevel=x$x,this.treeRoot=new x$m(this,0),this.treeRoot.init(x$h,this.treeSize)},x$b._prepareUpdateToRenderState=function(x$b,x$_){x$_.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,x$_.scene=this},x$b._prepareSceneToRender=function(x$b){var x$_=this._lights.length;if(0<x$_)for(var x$s=0,x$h=0;x$h<x$_&&!(this._lights[x$h]._prepareToScene(x$b)&&++x$s>=this._enableLightCount);x$h++);},x$b._updateChilds=function(x$b){for(var x$_=0,x$s=this._childs.length;x$_<x$s;++x$_)this._childs[x$_]._update(x$b)},x$b._preRenderScene=function(x$b,x$_,x$s){var x$h,x$x=x$_._viewMatrix,x$n=x$_._projectionMatrix,x$E=x$_._projectionViewMatrix,x$C=0,x$O=x$_.camera;for(x$O.useOcclusionCulling?this.treeRoot?x$sb.renderObjectCullingOctree(x$s,this,x$O,x$x,x$n,x$E):x$sb.renderObjectCulling(x$s,this,x$O,x$x,x$n,x$E):x$sb.renderObjectCullingNoBoundFrustum(this,x$O,x$x,x$n,x$E),x$C=0,x$h=this._quenes.length;x$C<x$h;x$C++)this._quenes[x$C]&&this._quenes[x$C]._preRender(x$_)},x$b._clear=function(x$b,x$_){var x$s=x$_._viewport,x$h=x$_.camera,x$x=x$s.x,x$n=x$h.renderTargetSize.height-x$s.y-x$s.height,x$E=x$s.width,x$C=x$s.height;x$b.viewport(x$x,x$n,x$E,x$C);var x$O=256,x$L=x$h.renderTarget;switch(x$h.clearFlag){case 0:var x$f=x$h.clearColor;if(x$f){x$b.enable(3089),x$b.scissor(x$x,x$n,x$E,x$C);var x$p=x$f.elements;x$b.clearColor(x$p[0],x$p[1],x$p[2],x$p[3]),x$O|=16384}if(x$L)switch(x$f||(x$O=16384),x$L.depthStencilFormat){case 33189:x$O|=256;break;case 36168:x$O|=1024;break;case 34041:x$O|=256,x$O|=1024}x$b.clear(x$O),x$f&&x$b.disable(3089);break;case 1:case 2:if(x$L)switch(x$O=16384,x$L.depthStencilFormat){case 33189:x$O|=256;break;case 36168:x$O|=1024;break;case 34041:x$O|=256,x$O|=1024}x$b.clear(x$O);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},x$b._renderScene=function(x$b,x$_){var x$s,x$h,x$x=x$_.camera,x$n=0;for(x$n=0;x$n<2;x$n++)(x$h=this._quenes[x$n])&&(x$x.renderTarget?x$h._render(x$_,!0):x$h._render(x$_,!1));if(1===x$x.clearFlag){var x$E=x$x.sky;x$E&&(x$J.setCullFace(x$b,!1),x$J.setDepthFunc(x$b,515),x$J.setDepthMask(x$b,!1),x$E._render(x$_),x$J.setDepthFunc(x$b,513),x$J.setDepthMask(x$b,!0))}for(x$n=2,x$s=this._quenes.length;x$n<x$s;x$n++)(x$h=this._quenes[x$n])&&(x$h._sortAlpha(x$_.camera.transform.position),x$x.renderTarget?x$h._render(x$_,!0):x$h._render(x$_,!1))},x$b._set3DRenderConfig=function(x$b){x$b.disable(3042),x$J._blend=!1,x$b.blendFunc(770,771),x$J._sFactor=770,x$J._dFactor=771,x$b.disable(2929),x$J._depthTest=!1,x$b.enable(2884),x$J._cullFace=!0,x$b.depthMask(1),x$J._depthMask=!0,x$b.frontFace(2304),x$J._frontFace=2304},x$b._set2DRenderConfig=function(x$b){x$J.setBlend(x$b,!0),x$J.setBlendFunc(x$b,1,771),x$J.setDepthTest(x$b,!1),x$J.setCullFace(x$b,!1),x$J.setDepthMask(x$b,!0),x$J.setFrontFace(x$b,2305),x$b.viewport(0,0,x$f.width,x$f.height)},x$b._parseCustomProps=function(x$b,x$_,x$s,x$h){var x$x=x$h.customProps.lightmaps,x$n=x$x.length,x$E=this._lightmaps;x$E.length=x$n;for(var x$C=0;x$C<x$n;x$C++)x$E[x$C]=x$i.getRes(x$_[x$x[x$C].replace(".exr",".png")]);this.setlightmaps(x$E);var x$O=x$h.customProps.ambientColor;x$O&&(this.ambientColor=new x$E_(x$O[0],x$O[1],x$O[2]));var x$L=x$h.customProps.fogColor;x$L&&(this.fogColor=new x$E_(x$L[0],x$L[1],x$L[2]))},x$b._addLight=function(x$b){this._lights.indexOf(x$b)<0&&this._lights.push(x$b)},x$b._removeLight=function(x$b){var x$_=this._lights.indexOf(x$b);0<=x$_&&this._lights.splice(x$_,1)},x$b._updateScene=function(){var x$b=this._renderState;this._prepareUpdateToRenderState(x$Z.mainContext,x$b),this._updateComponents(x$b),this._updateChilds(x$b),this._lateUpdateComponents(x$b),this._time+=x$b.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},x$b._updateSceneConch=function(){var x$b=this._renderState;this._prepareUpdateToRenderState(x$Z.mainContext,x$b),this._updateComponents(x$b),this._lateUpdateComponents(x$b),this._prepareSceneToRender(x$b);for(var x$_=0,x$s=this._cameraPool.length;x$_<x$s;x$_++){var x$h=this._cameraPool[x$_];(x$b.camera=x$h)._prepareCameraToRender()}},x$b._preRenderShadow=function(x$b,x$_,x$s,x$h,x$x){this.treeRoot?x$sb.renderShadowObjectCullingOctree(this,x$_,x$s,x$h,x$x):x$sb.renderShadowObjectCulling(this,x$_,x$s,x$h,x$x);for(var x$n=0,x$E=x$s.length;x$n<x$E;x$n++)x$s[x$n]&&x$s[x$n]._preRender(x$b)},x$b._renderShadowMap=function(x$b,x$_,x$s){var x$h=this.parallelSplitShadowMaps[0];x$h._calcAllLightCameraInfo(x$s);var x$x,x$n,x$E,x$C=x$h.PSSMNum;if(this._preRenderShadow(x$_,x$h._lightCulling,x$h._shadowQuenes,x$h._lightVPMatrix[0],x$C),this.addShaderDefine(x$V_.SHADERDEFINE_CAST_SHADOW),1<x$C)for(var x$O=0;x$O<x$C;x$O++)x$x=x$h.getRenderTarget(x$O+1),x$h.beginRenderTarget(x$O+1),x$b.clearColor(1,1,1,1),x$b.clear(16640),x$b.viewport(0,0,x$x.width,x$x.height),x$_.camera=x$E=x$h.getLightCamera(x$O),x$E._prepareCameraToRender(),x$E._prepareCameraViewProject(x$E.viewMatrix,x$E.projectionMatrix),x$_._projectionViewMatrix=x$h._lightVPMatrix[x$O+1],(x$n=x$h._shadowQuenes[x$O])._preRender(x$_),x$n._renderShadow(x$_,!1),x$h.endRenderTarget(x$O+1);else x$x=x$h.getRenderTarget(1),x$h.beginRenderTarget(1),x$b.clearColor(1,1,1,1),x$b.clear(16640),x$b.viewport(0,0,x$x.width,x$x.height),x$_.camera=x$E=x$h.getLightCamera(0),x$E._prepareCameraToRender(),x$E._prepareCameraViewProject(x$E.viewMatrix,x$E.projectionMatrix),x$_._projectionViewMatrix=x$h._lightVPMatrix[0],(x$n=x$h._shadowQuenes[0])._preRender(x$_),x$n._renderShadow(x$_,!0),x$h.endRenderTarget(1);this.removeShaderDefine(x$V_.SHADERDEFINE_CAST_SHADOW)},x$b.addTreeNode=function(x$b){this.treeRoot.addTreeNode(x$b)},x$b.removeTreeNode=function(x$b){this.treeSize&&x$b._treeNode&&x$b._treeNode.removeObject(x$b)},x$b.setlightmaps=function(x$b){this._lightmaps=x$b;for(var x$_=0,x$s=this._renderableSprite3Ds.length;x$_<x$s;x$_++)this._renderableSprite3Ds[x$_]._render._applyLightMapParams()},x$b.getlightmaps=function(){return this._lightmaps},x$b.addChildAt=function(x$b,x$_){if(!(x$b instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(x$b&&x$b.__className));if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),0<=x$_&&x$_<=this._childs.length){if(x$b._parent===this){var x$s=this.getChildIndex(x$b);this._childs.splice(x$s,1),this._childs.splice(x$_,0,x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,x$_)),this._childChanged()}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(x$_,0,x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,x$_),(x$b.parent=this)._addChild3D(x$b);return x$b}throw new Error("appendChildAt:The index is out of bounds")},x$b.addChild=function(x$b){if(!(x$b instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),x$b._parent===this){var x$_=this.getChildIndex(x$b);x$_!==this._childs.length-1&&(this._childs.splice(x$_,1),this._childs.push(x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1)),this._childChanged())}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1),(x$b.parent=this)._childChanged(),this._addChild3D(x$b);return x$b},x$b.removeChildAt=function(x$b){var x$_=this.getChildAt(x$b);return x$_&&(this._removeChild3D(x$_),this._childs.splice(x$b,1),this.conchModel&&this.conchModel.removeChild(x$_.conchModel),x$_.parent=null),x$_},x$b.removeChildren=function(x$b,x$_){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=2147483647),this._childs&&0<this._childs.length){var x$s=this._childs;if(0===x$b&&x$n<=x$_){var x$h=x$s;this._childs=x$L.ARRAY_EMPTY}else x$h=x$s.splice(x$b,x$_-x$b);for(var x$x=0,x$n=x$h.length;x$x<x$n;x$x++)this._removeChild3D(x$h[x$x]),x$h[x$x].parent=null,this.conchModel&&this.conchModel.removeChild(x$h[x$x].conchModel)}return this},x$b.addFrustumCullingObject=function(x$b){this.treeRoot?this.addTreeNode(x$b):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(x$b):this._cullingRenders[this._cullingRendersLength]=x$b,x$b._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},x$b.removeFrustumCullingObject=function(x$b){if(this.treeRoot)this.removeTreeNode(x$b);else{this._cullingRendersLength--;var x$_=x$b._indexInSceneFrustumCullingObjects;if(x$_!==this._cullingRendersLength){var x$s=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[x$_]=x$s)._indexInSceneFrustumCullingObjects=x$_,x$b._indexInSceneFrustumCullingObjects=-1}}},x$b.getRenderQueue=function(x$b){return x$b<3e3?this._quenes[1]||(this._quenes[1]=new x$X(this)):this._quenes[2]||(this._quenes[2]=new x$X(this))},x$b.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new x$X(this)},x$b.addShaderDefine=function(x$b){this._shaderDefineValue|=x$b},x$b.removeShaderDefine=function(x$b){this._shaderDefineValue&=~x$b},x$b.addScript=function(x$b){return this._addComponent(x$b)},x$b.getScriptByType=function(x$b,x$_){return void 0===x$_&&(x$_=0),this._getComponentByType(x$b,x$_)},x$b.getScriptsByType=function(x$b,x$_){this._getComponentsByType(x$b,x$_)},x$b.getScriptByIndex=function(x$b){return this._getComponentByIndex(x$b)},x$b.removeScriptByType=function(x$b,x$_){void 0===x$_&&(x$_=0),this._removeComponentByType(x$b,x$_)},x$b.removeScriptsByType=function(x$b){this._removeComponentByType(x$b)},x$b.removeAllScript=function(){this._removeAllComponent()},x$b.render=function(x$b,x$_,x$s){(x$y._context.ctx._renderKey=0)<this._childs.length&&x$b.addRenderObject(this)},x$b.renderSubmit=function(){var x$b=x$Z.mainContext,x$_=this._renderState;this._set3DRenderConfig(x$b),this._prepareSceneToRender(this._renderState);var x$s,x$h=0,x$x=0;if(x$i_.debugMode||x$m.debugMode)for(x$h=0,x$x=this._cameraPool.length;x$h<x$x;x$h++)x$s=this._cameraPool[x$h],x$i_._debugPhasorSprite.begin(1,x$s),x$s.activeInHierarchy&&x$s._renderCamera(x$b,x$_,this),x$i_._debugPhasorSprite.end();else for(x$h=0,x$x=this._cameraPool.length;x$h<x$x;x$h++)(x$s=this._cameraPool[x$h]).activeInHierarchy&&x$s._renderCamera(x$b,x$_,this);return this._set2DRenderConfig(x$b),1},x$b.onAsynLoaded=function(x$b,x$_,x$s){var x$h=x$_[0];if("Scene"!==x$h.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var x$x=x$_[1];x$w_._createNodeByJson(this,x$h,this,x$x),this.event("hierarchyloaded",[this]),this.__loaded=!0},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),this.destroyed||(x$_.prototype.destroy.call(this,x$b),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,x$i.clearRes(this.url),this.loaded||x$i_._cancelLoadByUrl(this.url))},x$b.getRenderType=function(){return 0},x$b.releaseRender=function(){},x$b._addComponent=function(x$b){var x$_,x$s=this._componentsMap.indexOf(x$b);if(-1===x$s)x$_=[],this._componentsMap.push(x$b),this._typeComponentsIndices.push(x$_);else if(x$_=this._typeComponentsIndices[x$s],this._components[x$_[0]].isSingleton)throw new Error("无法单实例创建"+x$b+"组件，"+x$b+"组件已存在！");var x$h=x$x.getInstance(x$b);x$_.push(this._components.length),this._components.push(x$h);return x$h._initialize(this),x$h},x$b._removeComponent=function(x$b,x$_){var x$s=this._typeComponentsIndices[x$b],x$h=x$s[x$_],x$x=this._components[x$h];this._components.splice(x$h,1),x$s.splice(x$_,1),0===x$s.length&&(this._typeComponentsIndices.splice(x$b,1),this._componentsMap.splice(x$b,1));for(var x$n=0,x$E=this._componentsMap.length;x$n<x$E;x$n++)for(var x$C=(x$s=this._typeComponentsIndices[x$n]).length-1;0<=x$C;x$C--){var x$O=x$s[x$C];if(!(x$h<x$O))break;x$s[x$C]=--x$O}x$x._destroy()},x$b._getComponentByType=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s=this._componentsMap.indexOf(x$b);return-1===x$s?null:this._components[this._typeComponentsIndices[x$s][x$_]]},x$b._getComponentsByType=function(x$b,x$_){var x$s=this._componentsMap.indexOf(x$b);if(-1!==x$s){var x$h=this._typeComponentsIndices[x$s],x$x=x$h.length;x$_.length=x$x;for(var x$n=0;x$n<x$x;x$n++)x$_[x$n]=this._components[x$h[x$n]]}else x$_.length=0},x$b._getComponentByIndex=function(x$b){return this._components[x$b]},x$b._removeComponentByType=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s=this._componentsMap.indexOf(x$b);-1!==x$s&&this._removeComponent(x$s,x$_)},x$b._removeComponentsByType=function(x$b){var x$_=this._componentsMap.indexOf(x$b);if(-1!==x$_)for(var x$s=this._typeComponentsIndices[x$_],x$h=0,x$x=x$s.length;x$h<x$x;x$s.length<x$x?x$x--:x$h++)this._removeComponent(x$_,x$h)},x$b._removeAllComponent=function(){for(var x$b=0,x$_=this._componentsMap.length;x$b<x$_;this._componentsMap.length<x$_?x$_--:x$b++)this._removeComponentsByType(this._componentsMap[x$b])},x$b._updateComponents=function(x$b){for(var x$_=0,x$s=this._components.length;x$_<x$s;x$_++){var x$h=this._components[x$_];!x$h.started&&(x$h._start(x$b),x$h.started=!0),x$h.enable&&x$h._update(x$b)}},x$b._lateUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._lateUpdate(x$b)}},x$b._preRenderUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._preRenderUpdate(x$b)}},x$b._postRenderUpdateComponents=function(x$b){for(var x$_=0;x$_<this._components.length;x$_++){var x$s=this._components[x$_];!x$s.started&&(x$s._start(x$b),x$s.started=!0),x$s.enable&&x$s._postRenderUpdate(x$b)}},x$Q(0,x$b,"_loaded",null,function(x$b){this.__loaded=x$b}),x$Q(0,x$b,"fogColor",function(){return this._fogColor},function(x$b){this._fogColor=x$b,this._shaderValues.setValue(0,x$b.elements)}),x$Q(0,x$b,"enableFog",function(){return this._enableFog},function(x$b){this._enableFog!==x$b&&((this._enableFog=x$b)?(this.addShaderDefine(x$M_.SHADERDEFINE_FOG),this.removeShaderDefine(x$M_.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(x$M_.SHADERDEFINE_FOG))}),x$Q(0,x$b,"url",function(){return this._url}),x$Q(0,x$b,"loaded",function(){return this.__loaded}),x$Q(0,x$b,"enableDepthFog",function(){return this._enableDepthFog},function(x$b){this._enableDepthFog!=x$b&&((this._enableDepthFog=x$b)?(this.addShaderDefine(x$M_.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(x$M_.SHADERDEFINE_FOG)):this.removeShaderDefine(x$M_.SAHDERDEFINE_DEPTHFOG))}),x$Q(0,x$b,"fogStart",function(){return this._fogStart},function(x$b){this._fogStart=x$b,this._shaderValues.setValue(1,x$b)}),x$Q(0,x$b,"fogRange",function(){return this._fogRange},function(x$b){this._fogRange=x$b,this._shaderValues.setValue(2,x$b)}),x$Q(0,x$b,"ambientColor",function(){return this._ambientColor},function(x$b){this._ambientColor=x$b,this._shaderValues.setValue(21,x$b.elements)}),x$Q(0,x$b,"scene",function(){return this}),x$Q(0,x$b,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),x$h._sortScenes=function(x$b,x$_){if(x$b.parent!==x$$.stage||x$_.parent!==x$$.stage)return x$b.parent!==x$$.stage&&x$_.parent!==x$$.stage?x$h._sortScenes(x$b.parent,x$_.parent):x$b.parent===x$$.stage?-1:1;var x$s=x$$.stage._childs;return x$s.indexOf(x$b)-x$s.indexOf(x$_)},x$h.load=function(x$b){return x$$.loader.create(x$b,null,null,x$h)},x$h.FOGCOLOR=0,x$h.FOGSTART=1,x$h.FOGRANGE=2,x$h.LIGHTDIRECTION=3,x$h.LIGHTDIRCOLOR=4,x$h.POINTLIGHTPOS=5,x$h.POINTLIGHTRANGE=6,x$h.POINTLIGHTATTENUATION=7,x$h.POINTLIGHTCOLOR=8,x$h.SPOTLIGHTPOS=9,x$h.SPOTLIGHTDIRECTION=10,x$h.SPOTLIGHTSPOT=11,x$h.SPOTLIGHTRANGE=12,x$h.SPOTLIGHTATTENUATION=13,x$h.SPOTLIGHTCOLOR=14,x$h.SHADOWDISTANCE=15,x$h.SHADOWLIGHTVIEWPROJECT=16,x$h.SHADOWMAPPCFOFFSET=17,x$h.SHADOWMAPTEXTURE1=18,x$h.SHADOWMAPTEXTURE2=19,x$h.SHADOWMAPTEXTURE3=20,x$h.AMBIENTCOLOR=21,x$h.TIME=22,x$h}(x$o),x$U_=function(x$b){function x$_(x$b){x$_.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new x$b_,this._shaderValues=new x$P_,this._colliders=[],this._id=++x$_._uniqueIDCounter,this._transform=new x$D_(this),this.name=x$b||"Sprite3D-"+x$_._nameNumberCounter++,this.layer=x$T.currentCreationLayer,this.active=!0}x$V(x$_,"laya.d3.core.Sprite3D",x$B_);var x$s=x$_.prototype;return x$$.imps(x$s,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),x$s._setUrl=function(x$b){this._url=x$b},x$s._getGroup=function(){return this._group},x$s._setGroup=function(x$b){this._group=x$b},x$s._addChild3D=function(x$b){x$b.transform.parent=this.transform,this._hierarchyAnimator&&(!x$b._hierarchyAnimator&&x$b._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(x$b,!0,[x$b.name])),this._scene&&(x$b._setBelongScene(this._scene),this._activeInHierarchy&&x$b._active&&x$b._activeHierarchy())},x$s._removeChild3D=function(x$b){x$b.transform.parent=null,this._scene&&(this._activeInHierarchy&&x$b._active&&x$b._inActiveHierarchy(),x$b._setUnBelongScene()),this._hierarchyAnimator&&(x$b._hierarchyAnimator==this._hierarchyAnimator&&x$b._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(x$b,!1,[x$b.name]))},x$s._parseBaseCustomProps=function(x$b){var x$_=this.transform.localPosition;x$b.translate?(x$_.fromArray(x$b.translate),x$_.x*=100,x$_.y*=100,x$_.z*=100):x$_.elements.fill(0),this.transform.localPosition=x$_;var x$s=this.transform.localRotation;x$b.rotation?x$s.fromArray(x$b.rotation):x$s.fromArray([0,0,0,-1]),this.transform.localRotation=x$s;var x$h=this.transform.localScale;x$b.scale?x$h.fromArray(x$b.scale):x$h.elements.fill(1),this.transform.localScale=x$h;var x$x=x$b.layer;null!=x$x&&(this.layer=x$T.getLayerByNumber(x$x))},x$s._parseCustomComponent=function(x$b,x$_,x$s){for(var x$h in x$s){var x$x=x$s[x$h];switch(x$h){case"Animator":var x$n=this.addComponent(Animator);if(x$x.avatarPath)x$n.avatar=x$i.getRes(x$_[x$x.avatarPath]);else{var x$E=x$x.avatar;if(x$E){x$n.avatar=x$i.getRes(x$_[x$E.path]);var x$C=x$E.linkSprites;x$C&&x$b.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[x$n,x$C])}}for(var x$O=x$x.clipPaths,x$L=x$O.length,x$f=0;x$f<x$L;x$f++)x$n.addClip(x$i.getRes(x$_[x$O[x$f]]));x$n.clip=x$i.getRes(x$_[x$O[0]]);var x$p=x$x.playOnWake;void 0!==x$p&&(x$n.playOnWake=x$p);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var x$P=this.addComponent(SphereCollider);x$P.isTrigger=x$x.isTrigger;var x$V=x$P.center;x$V.fromArray(x$x.center),x$P.center=x$V,x$P.radius=x$x.radius;break;case"BoxCollider":var x$Q=this.addComponent(BoxCollider);x$Q.isTrigger=x$x.isTrigger,x$Q.center.fromArray(x$x.center);var x$y=x$Q.size;x$y.fromArray(x$x.size),x$Q.size=x$y;break;case"MeshCollider":this.addComponent(MeshCollider)}}},x$s._onRootNodeHierarchyLoaded=function(x$b,x$_){for(var x$s in x$_){for(var x$h=this,x$x=x$_[x$s],x$n=0,x$E=x$x.length;x$n<x$E;x$n++){var x$C=x$x[x$n];if(""===x$C)break;if(!(x$h=x$h.getChildByName(x$C)))break}x$h&&x$b.linkSprite3DToAvatarNode(x$s,x$h)}},x$s._setHierarchyAnimator=function(x$b,x$_){this._changeHierarchyAnimator(x$b);for(var x$s=0,x$h=this._childs.length;x$s<x$h;x$s++){var x$x=this._childs[x$s];x$x._hierarchyAnimator==x$_&&x$x._setHierarchyAnimator(x$b,x$_)}},x$s._clearHierarchyAnimator=function(x$b,x$_){this._changeHierarchyAnimator(x$_);for(var x$s=0,x$h=this._childs.length;x$s<x$h;x$s++){var x$x=this._childs[x$s];x$x._hierarchyAnimator==x$b&&x$x._clearHierarchyAnimator(x$b,x$_)}},x$s._getAnimatorToLinkSprite3D=function(x$b,x$_,x$s){var x$h=this.getComponentByType(Animator);if(x$h&&(x$h.avatar?x$h.avatar._version||x$b._setAnimatorToLinkAvatar(x$h,x$_):x$b._setAnimatorToLinkSprite3DNoAvatar(x$h,x$_,x$s)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){x$s.unshift(this._parent.name);var x$x=this._parent;x$x._hierarchyAnimator&&x$x._getAnimatorToLinkSprite3D(x$b,x$_,x$s)}},x$s._setAnimatorToLinkSprite3DNoAvatar=function(x$b,x$_,x$s){var x$h=0,x$x=0;for(x$h=0,x$x=x$b.getClipCount();x$h<x$x;x$h++)x$b._handleSpriteOwnersBySprite(x$h,x$_,x$s,this);for(x$h=0,x$x=this._childs.length;x$h<x$x;x$h++){var x$n=this._childs[x$h],x$E=x$s.length;x$s.push(x$n.name),x$n._setAnimatorToLinkSprite3DNoAvatar(x$b,x$_,x$s),x$s.splice(x$E,1)}},x$s._changeHierarchyAnimator=function(x$b){this._hierarchyAnimator=x$b},x$s._isLinkSpriteToAnimationNode=function(x$b,x$_,x$s){var x$h=x$b._avatarNodes.indexOf(x$_),x$x=x$b._cacheSpriteToNodesMap;if(x$s)this._transform.dummy=x$_.transform,x$b._cacheNodesToSpriteMap[x$h]=x$x.length,x$x.push(x$h);else{this._transform.dummy=null;var x$n=x$b._cacheNodesToSpriteMap[x$h];x$b._cacheNodesToSpriteMap[x$h]=null,x$x.splice(x$n,1)}},x$s._setBelongScene=function(x$b){this._scene=x$b;for(var x$_=0,x$s=this._childs.length;x$_<x$s;x$_++)this._childs[x$_]._setBelongScene(x$b)},x$s._setUnBelongScene=function(){this._scene=null;for(var x$b=0,x$_=this._childs.length;x$b<x$_;x$b++)this._childs[x$b]._setUnBelongScene()},x$s._activeHierarchy=function(){var x$b=0,x$_=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),x$b=0,x$_=this._colliders.length;x$b<x$_;x$b++)this._layer._addCollider(this._colliders[x$b]);for(this.event("activeinhierarchychanged",!0),x$b=0,x$_=this._childs.length;x$b<x$_;x$b++){var x$s=this._childs[x$b];x$s._active&&x$s._activeHierarchy()}},x$s._inActiveHierarchy=function(){var x$b=0,x$_=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),x$b=0,x$_=this._colliders.length;x$b<x$_;x$b++){var x$s=this._colliders[x$b];x$s._clearCollsionMap(),this._layer._removeCollider(x$s)}for(this.event("activeinhierarchychanged",!1),x$b=0,x$_=this._childs.length;x$b<x$_;x$b++){var x$h=this._childs[x$b];x$h._active&&x$h._inActiveHierarchy()}},x$s.addComponent=function(x$b){var x$_,x$s=this._componentsMap.indexOf(x$b);if(-1===x$s)x$_=[],this._componentsMap.push(x$b),this._typeComponentsIndices.push(x$_);else if(x$_=this._typeComponentsIndices[x$s],this._components[x$_[0]].isSingleton)throw new Error("无法单实例创建"+x$b+"组件，"+x$b+"组件已存在！");var x$h=x$x.getInstance(x$b);return x$_.push(this._components.length),this._components.push(x$h),x$h instanceof laya.d3.component.Script&&this._scripts.push(x$h),x$h._initialize(this),x$h},x$s._removeComponent=function(x$b,x$_){var x$s,x$h=0,x$x=this._typeComponentsIndices[x$b],x$n=x$x[x$_],x$E=this._components[x$n];for(x$E instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(x$E),1),x$x.splice(x$_,1),0===x$x.length&&(this._typeComponentsIndices.splice(x$b,1),this._componentsMap.splice(x$b,1)),x$h=0,x$s=this._componentsMap.length;x$h<x$s;x$h++)for(var x$C=(x$x=this._typeComponentsIndices[x$h]).length-1;0<=x$C;x$C--){var x$O=x$x[x$C];if(!(x$n<x$O))break;x$x[x$C]=--x$O}x$E._destroy()},x$s._clearSelfRenderObjects=function(){},x$s._addSelfRenderObjects=function(){},x$s._parseCustomProps=function(x$b,x$_,x$s,x$h){},x$s._updateChilds=function(x$b){var x$_=this._childs.length;if(0!==x$_)for(var x$s=0;x$s<x$_;++x$s)this._childs[x$s]._update(x$b)},x$s._getSortID=function(x$b,x$_){return 1e3*x$_.id+x$b._getVertexBuffer().vertexDeclaration.id},x$s._update=function(x$b){(x$b.owner=this)._activeInHierarchy&&(this._updateComponents(x$b),this._lateUpdateComponents(x$b),x$M.spriteCount++,this._childs.length&&this._updateChilds(x$b))},x$s.getProjectionViewWorldMatrix=function(x$b){return x$b_.multiply(x$b,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},x$s.loadHierarchy=function(x$b){this.addChild(laya.d3.core.Sprite3D.load(x$b))},x$s.addChildAt=function(x$b,x$_){if(!(x$b instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),0<=x$_&&x$_<=this._childs.length){if(x$b._parent===this){var x$s=this.getChildIndex(x$b);this._childs.splice(x$s,1),this._childs.splice(x$_,0,x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,x$_)),this._childChanged()}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(x$_,0,x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,x$_),(x$b.parent=this)._addChild3D(x$b);return x$b}throw new Error("appendChildAt:The index is out of bounds")},x$s.addChild=function(x$b){if(!(x$b instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!x$b||this.destroyed||x$b===this)return x$b;if(x$b.zOrder&&this._set$P("hasZorder",!0),x$b._parent===this){var x$_=this.getChildIndex(x$b);x$_!==this._childs.length-1&&(this._childs.splice(x$_,1),this._childs.push(x$b),this.conchModel&&(this.conchModel.removeChild(x$b.conchModel),this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1)),this._childChanged())}else x$b.parent&&x$b.parent.removeChild(x$b),this._childs===x$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(x$b),this.conchModel&&this.conchModel.addChildAt(x$b.conchModel,this._childs.length-1),(x$b.parent=this)._childChanged(),this._addChild3D(x$b);return x$b},x$s.removeChildAt=function(x$b){var x$_=this.getChildAt(x$b);return x$_&&(this._removeChild3D(x$_),this._childs.splice(x$b,1),this.conchModel&&this.conchModel.removeChild(x$_.conchModel),x$_.parent=null),x$_},x$s.removeChildren=function(x$b,x$_){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=2147483647),this._childs&&0<this._childs.length){var x$s=this._childs;if(0===x$b&&x$n<=x$_){var x$h=x$s;this._childs=x$L.ARRAY_EMPTY}else x$h=x$s.splice(x$b,x$_-x$b);for(var x$x=0,x$n=x$h.length;x$x<x$n;x$x++)this._removeChild3D(x$h[x$x]),x$h[x$x].parent=null,this.conchModel&&this.conchModel.removeChild(x$h[x$x].conchModel)}return this},x$s.onAsynLoaded=function(x$b,x$_,x$s){var x$h=x$_[0];if("Sprite3D"!==x$h.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var x$x=x$_[1];x$w_._createNodeByJson(this,x$h,this,x$x),this.event("hierarchyloaded",[this]),this.__loaded=!0},x$s.cloneTo=function(x$b){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var x$_=x$b;x$_.name=this.name,x$_._destroyed=this._destroyed,x$_.timer=this.timer,x$_._$P=this._$P,x$_.active=this._active;var x$s=x$_.transform.localPosition;this.transform.localPosition.cloneTo(x$s),x$_.transform.localPosition=x$s;var x$h=x$_.transform.localRotation;this.transform.localRotation.cloneTo(x$h),x$_.transform.localRotation=x$h;var x$x=x$_.transform.localScale;this.transform.localScale.cloneTo(x$x),x$_.transform.localScale=x$x,x$_.isStatic=this.isStatic;var x$n=0,x$E=0;for(x$n=0,x$E=this._componentsMap.length;x$n<x$E;x$n++){var x$C=x$_.addComponent(this._componentsMap[x$n]);this._components[x$n]._cloneTo(x$C)}for(x$n=0,x$E=this._childs.length;x$n<x$E;x$n++)x$_.addChild(this._childs[x$n].clone());var x$O=x$_.getComponentByType(Animator);if(x$O){var x$L=x$O._linkSpritesData;if(x$L)for(var x$f in x$L){for(var x$p=x$L[x$f],x$P=x$_,x$V=0,x$Q=x$p.length;x$V<x$Q&&(x$P=x$P.getChildByName(x$p[x$V]));x$V++);if(x$P){var x$y=x$O._avatarNodeMap[x$f];x$P._isLinkSpriteToAnimationNode(x$O,x$y,!0)}}}},x$s.clone=function(){var x$b=new this.constructor;return this.cloneTo(x$b),x$b},x$s.destroy=function(x$b){if(void 0===x$b&&(x$b=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,x$b);var x$_,x$s=0;for(x$s=0,x$_=this._components.length;x$s<x$_;x$s++)this._components[x$s]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,x$i.clearRes(this.url),this.loaded||x$i_._cancelLoadByUrl(this.url)}},x$s._handleSpriteToAvatar=function(x$b,x$_){x$b._avatarNodes;var x$s=x$b._avatarNodeMap[this.name];x$s&&x$s.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(x$b,x$s,x$_)},x$s._setAnimatorToLinkAvatar=function(x$b,x$_){this._handleSpriteToAvatar(x$b,x$_);for(var x$s=0,x$h=this._childs.length;x$s<x$h;x$s++){this._childs[x$s]._setAnimatorToLinkAvatar(x$b,x$_)}},x$Q(0,x$s,"activeInHierarchy",function(){return this._activeInHierarchy}),x$Q(0,x$s,"_loaded",null,function(x$b){this.__loaded=x$b}),x$Q(0,x$s,"active",function(){return this._active},function(x$b){this._active!==x$b&&(this._active=x$b,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(x$b?this._activeHierarchy():this._inActiveHierarchy()))}),x$Q(0,x$s,"componentsCount",function(){return this._components.length}),x$Q(0,x$s,"loaded",function(){return this.__loaded}),x$Q(0,x$s,"id",function(){return this._id}),x$Q(0,x$s,"url",function(){return this._url}),x$Q(0,x$s,"layer",function(){return this._layer},function(x$b){if(this._layer!==x$b){if(!x$b)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var x$_=0,x$s=this._colliders.length;if(this._layer)for(x$_=0;x$_<x$s;x$_++)this._layer._removeCollider(this._colliders[x$_]);for(x$_=0;x$_<x$s;x$_++)x$b._addCollider(this._colliders[x$_])}this._layer=x$b,this.event("layerchanged",x$b)}}),x$Q(0,x$s,"scene",function(){return this._scene}),x$Q(0,x$s,"transform",function(){return this._transform}),x$_.instantiate=function(x$b,x$_,x$s,x$h,x$x){void 0===x$s&&(x$s=!0);var x$n=x$b.clone();x$_&&x$_.addChild(x$n);var x$E=x$n.transform;if(x$s){var x$C=x$E.worldMatrix;x$b.transform.worldMatrix.cloneTo(x$C),x$E.worldMatrix=x$C}else x$h&&(x$E.position=x$h),x$x&&(x$E.rotation=x$x);return x$n},x$_.load=function(x$b){return x$$.loader.create(x$b,null,null,x$_)},x$_.WORLDMATRIX=0,x$_.MVPMATRIX=1,x$_._uniqueIDCounter=0,x$_._nameNumberCounter=0,x$_}(),x$G_=function(x$b){function x$f(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],x$f.__super.call(this),!x$b||!x$_)throw"Shader Error";this._id=++x$f._count,this._vs=x$b,this._ps=x$_,this._attributeMap=x$s,this._sceneUniformMap=x$h,this._cameraUniformMap=x$x,this._spriteUniformMap=x$n,this._materialUniformMap=x$E,this._renderElementUniformMap=x$C,this._precompile=x$O,this._define=x$L,this._precompile&&x$f.extCompileObj&&x$f.extCompileFunc?x$f.extCompileFunc.call(x$f.extCompileObj,x$b,x$_,x$L):this.recreateResource()}x$V(x$f,"laya.d3.shader.Shader3D",x$s);var x$_=x$f.prototype;return x$_.recreateResource=function(){x$W.now();this._compile(),this.completeCreate(),this.memorySize=0},x$_.disposeResource=function(){x$Z.mainContext.deleteShader(this._vshader),x$Z.mainContext.deleteShader(this._pshader),x$Z.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},x$_._compile=function(){if(!x$Z.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var x$b=[this._vs,this._ps],x$_=x$Z.mainContext;if(this._program=x$_.createProgram(),this._vshader=x$f._createShader(x$_,x$b[0],35633),this._pshader=x$f._createShader(x$_,x$b[1],35632),x$_.attachShader(this._program,this._vshader),x$_.attachShader(this._program,this._pshader),x$_.linkProgram(this._program),!x$y.isConchApp&&x$M_.debugMode&&!x$_.getProgramParameter(this._program,35714))throw x$_.getProgramInfoLog(this._program);var x$s,x$h=0,x$x=0,x$n=0;for(x$n=x$y.isConchApp?x$_.getProgramParameterEx(this._vs,this._ps,"",35721):x$_.getProgramParameter(this._program,35721),x$h=0;x$h<x$n;x$h++){var x$E=null;x$s={vartype:"attribute",ivartype:0,attrib:x$E=x$y.isConchApp?x$_.getActiveAttribEx(this._vs,this._ps,"",x$h):x$_.getActiveAttrib(this._program,x$h),location:x$_.getAttribLocation(this._program,x$E.name),name:x$E.name,type:x$E.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(x$s)}var x$C=0;for(x$C=x$y.isConchApp?x$_.getProgramParameterEx(this._vs,this._ps,"",35718):x$_.getProgramParameter(this._program,35718),x$h=0;x$h<x$C;x$h++){var x$O=null;x$O=x$y.isConchApp?x$_.getActiveUniformEx(this._vs,this._ps,"",x$h):x$_.getActiveUniform(this._program,x$h),0<(x$s={vartype:"uniform",ivartype:1,attrib:x$E,location:x$_.getUniformLocation(this._program,x$O.name),name:x$O.name,type:x$O.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(x$s.name=x$s.name.substr(0,x$s.name.length-3),x$s.isArray=!0,x$s.location=x$_.getUniformLocation(this._program,x$s.name)),this._uniformParams.push(x$s)}for(x$h=0,x$x=this._attributeParams.length;x$h<x$x;x$h++)(x$s=this._attributeParams[x$h]).indexOfParams=x$h,x$s.index=1,x$s.value=[x$s.location,null],x$s.codename=x$s.name,x$s.name=null!=this._attributeMap[x$s.codename]?this._attributeMap[x$s.codename]:x$s.codename,this._attributeParamsMap.push(x$s.name),this._attributeParamsMap.push(x$s),x$s._this=this,x$s.uploadedValue=[],x$s.fun=this._attribute;for(x$h=0,x$x=this._uniformParams.length;x$h<x$x;x$h++)switch((x$s=this._uniformParams[x$h]).indexOfParams=x$h,x$s.index=1,x$s.value=[x$s.location,null],x$s.codename=x$s.name,null!=this._sceneUniformMap[x$s.codename]?(x$s.name=this._sceneUniformMap[x$s.codename],this._sceneUniformParamsMap.push(x$s.name),this._sceneUniformParamsMap.push(x$s)):null!=this._cameraUniformMap[x$s.codename]?(x$s.name=this._cameraUniformMap[x$s.codename],this._cameraUniformParamsMap.push(x$s.name),this._cameraUniformParamsMap.push(x$s)):null!=this._spriteUniformMap[x$s.codename]?(x$s.name=this._spriteUniformMap[x$s.codename],this._spriteUniformParamsMap.push(x$s.name),this._spriteUniformParamsMap.push(x$s)):null!=this._materialUniformMap[x$s.codename]?(x$s.name=this._materialUniformMap[x$s.codename],this._materialUniformParamsMap.push(x$s.name),this._materialUniformParamsMap.push(x$s)):null!=this._renderElementUniformMap[x$s.codename]?(x$s.name=this._renderElementUniformMap[x$s.codename],this._renderElementUniformParamsMap.push(x$s.name),this._renderElementUniformParamsMap.push(x$s)):console.log("Shader:can't find uinform name:"+x$s.codename+" in shader file."),x$s._this=this,x$s.uploadedValue=[],x$s.type){case 5124:x$s.fun=x$s.isArray?this._uniform1iv:this._uniform1i;break;case 5126:x$s.fun=x$s.isArray?this._uniform1fv:this._uniform1f;break;case 35664:x$s.fun=x$s.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:x$s.fun=x$s.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:x$s.fun=x$s.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:x$s.fun=this._uniform_sampler2D;break;case 35680:x$s.fun=this._uniform_samplerCube;break;case 35676:x$s.fun=this._uniformMatrix4fv;break;case 35670:x$s.fun=this._uniform1i;break;case 35674:x$s.fun=this._uinformMatrix2fv;break;case 35675:x$s.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},x$_._attribute=function(x$b,x$_){var x$s=x$Z.mainContext,x$h=x$C._enableAtributes,x$x=x$b.location;return x$h[x$x]||x$s.enableVertexAttribArray(x$x),x$s.vertexAttribPointer(x$x,x$_[0],x$_[1],x$_[2],x$_[3],x$_[4]),x$h[x$x]=x$C._bindVertexBuffer,1},x$_._uniform1f=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_?(x$Z.mainContext.uniform1f(x$b.location,x$s[0]=x$_),1):0},x$_._uniform1fv=function(x$b,x$_){if(x$_.length<4){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$Z.mainContext.uniform1fv(x$b.location,x$_),x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3],1):0}return x$Z.mainContext.uniform1fv(x$b.location,x$_),1},x$_._uniform_vec2=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]?(x$Z.mainContext.uniform2f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1]),1):0},x$_._uniform_vec2v=function(x$b,x$_){if(x$_.length<2){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$Z.mainContext.uniform2fv(x$b.location,x$_),x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3],1):0}return x$Z.mainContext.uniform2fv(x$b.location,x$_),1},x$_._uniform_vec3=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]?(x$Z.mainContext.uniform3f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2]),1):0},x$_._uniform_vec3v=function(x$b,x$_){return x$Z.mainContext.uniform3fv(x$b.location,x$_),1},x$_._uniform_vec4=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$Z.mainContext.uniform4f(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3]),1):0},x$_._uniform_vec4v=function(x$b,x$_){return x$Z.mainContext.uniform4fv(x$b.location,x$_),1},x$_._uniformMatrix2fv=function(x$b,x$_){return x$Z.mainContext.uniformMatrix2fv(x$b.location,!1,x$_),1},x$_._uniformMatrix3fv=function(x$b,x$_){return x$Z.mainContext.uniformMatrix3fv(x$b.location,!1,x$_),1},x$_._uniformMatrix4fv=function(x$b,x$_){return x$Z.mainContext.uniformMatrix4fv(x$b.location,!1,x$_),1},x$_._uinformMatrix2fv=function(x$b,x$_){return x$Z.mainContext.uniformMatrix2fv(x$b.location,!1,x$_),1},x$_._uinformMatrix3fv=function(x$b,x$_){return x$Z.mainContext.uniformMatrix3fv(x$b.location,!1,x$_),1},x$_._uniform1i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_?(x$Z.mainContext.uniform1i(x$b.location,x$s[0]=x$_),1):0},x$_._uniform1iv=function(x$b,x$_){return x$Z.mainContext.uniform1iv(x$b.location,x$_),1},x$_._uniform_ivec2=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]?(x$Z.mainContext.uniform2i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1]),1):0},x$_._uniform_ivec2v=function(x$b,x$_){return x$Z.mainContext.uniform2iv(x$b.location,x$_),1},x$_._uniform_vec3i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]?(x$Z.mainContext.uniform3i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2]),1):0},x$_._uniform_vec3vi=function(x$b,x$_){return x$Z.mainContext.uniform3iv(x$b.location,x$_),1},x$_._uniform_vec4i=function(x$b,x$_){var x$s=x$b.uploadedValue;return x$s[0]!==x$_[0]||x$s[1]!==x$_[1]||x$s[2]!==x$_[2]||x$s[3]!==x$_[3]?(x$Z.mainContext.uniform4i(x$b.location,x$s[0]=x$_[0],x$s[1]=x$_[1],x$s[2]=x$_[2],x$s[3]=x$_[3]),1):0},x$_._uniform_vec4vi=function(x$b,x$_){return x$Z.mainContext.uniform4iv(x$b.location,x$_),1},x$_._uniform_sampler2D=function(x$b,x$_){var x$s=x$_.source||x$_.defaulteTexture.source,x$h=x$Z.mainContext,x$x=x$b.uploadedValue;if(null!=x$x[0])return x$h.activeTexture(x$f._TEXTURES[x$x[0]]),x$s&&x$J.bindTexture(x$h,3553,x$s),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return x$x[0]=this._curActTexIndex,x$h.uniform1i(x$b.location,this._curActTexIndex),x$h.activeTexture(x$f._TEXTURES[this._curActTexIndex]),x$s&&x$J.bindTexture(x$h,3553,x$s),this._curActTexIndex++,1},x$_._uniform_samplerCube=function(x$b,x$_){var x$s=x$_.source||x$_.defaulteTexture.source,x$h=x$Z.mainContext,x$x=x$b.uploadedValue;if(null!=x$x[0])return x$h.activeTexture(x$f._TEXTURES[x$x[0]]),x$s?x$J.bindTexture(x$h,34067,x$s):x$J.bindTexture(x$h,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return x$x[0]=this._curActTexIndex,x$h.uniform1i(x$b.location,this._curActTexIndex),x$h.activeTexture(x$f._TEXTURES[this._curActTexIndex]),x$s?x$J.bindTexture(x$h,34067,x$s):x$J.bindTexture(x$h,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},x$_._noSetValue=function(x$b){console.log("no....:"+x$b.name)},x$_.bind=function(){return x$s.activeShader=this,(x$s.bindShader=this).activeResource(),x$J.UseProgram(this._program)},x$_.uploadAttributes=function(x$b,x$_){for(var x$s,x$h,x$x=0,x$n=0,x$E=this._attributeParamsMap.length;x$n<x$E;x$n+=2)x$h=this._attributeParamsMap[x$n+1],null!=(x$s=x$b[this._attributeParamsMap[x$n]])&&(x$_&&x$_[x$h.name]&&x$_[x$h.name].bind(),x$x+=x$h.fun.call(this,x$h,x$s));x$M.shaderCall+=x$x},x$_.uploadAttributesX=function(x$b,x$_){for(var x$s,x$h,x$x=0,x$n=0,x$E=this._attributeParamsMap.length;x$n<x$E;x$n+=2)x$h=this._attributeParamsMap[x$n+1],null!=(x$s=x$b[this._attributeParamsMap[x$n]])&&(x$_._bind(),x$x+=x$h.fun.call(this,x$h,x$s));x$M.shaderCall+=x$x},x$_.uploadSceneUniforms=function(x$b){for(var x$_,x$s,x$h=0,x$x=0,x$n=this._sceneUniformParamsMap.length;x$x<x$n;x$x+=2)x$s=this._sceneUniformParamsMap[x$x+1],null!=(x$_=x$b[this._sceneUniformParamsMap[x$x]])&&(x$h+=x$s.fun.call(this,x$s,x$_));x$M.shaderCall+=x$h},x$_.uploadCameraUniforms=function(x$b){for(var x$_,x$s,x$h=0,x$x=0,x$n=this._cameraUniformParamsMap.length;x$x<x$n;x$x+=2)x$s=this._cameraUniformParamsMap[x$x+1],null!=(x$_=x$b[this._cameraUniformParamsMap[x$x]])&&(x$h+=x$s.fun.call(this,x$s,x$_));x$M.shaderCall+=x$h},x$_.uploadSpriteUniforms=function(x$b){for(var x$_,x$s,x$h=0,x$x=0,x$n=this._spriteUniformParamsMap.length;x$x<x$n;x$x+=2)x$s=this._spriteUniformParamsMap[x$x+1],null!=(x$_=x$b[this._spriteUniformParamsMap[x$x]])&&(x$h+=x$s.fun.call(this,x$s,x$_));x$M.shaderCall+=x$h},x$_.uploadMaterialUniforms=function(x$b){for(var x$_,x$s,x$h=0,x$x=0,x$n=this._materialUniformParamsMap.length;x$x<x$n;x$x+=2)x$s=this._materialUniformParamsMap[x$x+1],null!=(x$_=x$b[this._materialUniformParamsMap[x$x]])&&(x$h+=x$s.fun.call(this,x$s,x$_));x$M.shaderCall+=x$h},x$_.uploadRenderElementUniforms=function(x$b){for(var x$_,x$s,x$h=0,x$x=0,x$n=this._renderElementUniformParamsMap.length;x$x<x$n;x$x+=2)x$s=this._renderElementUniformParamsMap[x$x+1],null!=(x$_=x$b[this._renderElementUniformParamsMap[x$x]])&&(x$h+=x$s.fun.call(this,x$s,x$_));x$M.shaderCall+=x$h},x$f.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return new x$f(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L)},x$f.addInclude=function(x$b,x$_){x$t.addInclude(x$b,x$_)},x$f._createShader=function(x$b,x$_,x$s){var x$h=x$b.createShader(x$s);if(x$b.shaderSource(x$h,x$_),x$b.compileShader(x$h),x$M_.debugMode&&!x$b.getShaderParameter(x$h,35713))throw x$b.getShaderInfoLog(x$h);return x$h},x$f.PERIOD_RENDERELEMENT=0,x$f.PERIOD_MATERIAL=1,x$f.PERIOD_SPRITE=2,x$f.PERIOD_CAMERA=3,x$f.PERIOD_SCENE=4,x$f._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],x$f._count=0,x$f._preCompile=!1,x$f.extCompileFunc=null,x$f.extCompileObj=null,x$p(x$f,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new x$r}]),x$f}(),x$z_=function(x$C){function x$O(){this._transformUV=null,x$O.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new x$E_(.6,.6,.6)),this._setColor(10,new x$E_(1,1,1)),this._setColor(11,new x$C_(1,1,1,8)),this._setColor(12,new x$E_(1,1,1)),this._setColor(7,new x$C_(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new x$C_(1,1,0,0)),this.renderMode=1}x$V(x$O,"laya.d3.core.material.StandardMaterial",x$C);var x$b=x$O.prototype;return x$b.disableLight=function(){this._addDisablePublicShaderDefine(x$M_.SHADERDEFINE_POINTLIGHT|x$M_.SHADERDEFINE_SPOTLIGHT|x$M_.SHADERDEFINE_DIRECTIONLIGHT)},x$b.disableFog=function(){this._addDisablePublicShaderDefine(x$M_.SHADERDEFINE_FOG)},x$b.onAsynLoaded=function(x$b,x$_,x$s){var x$h=x$_[0];if(x$h.version)x$C.prototype.onAsynLoaded.call(this,x$b,x$_,x$s);else{var x$x=x$_[1],x$n=x$h.props;for(var x$E in x$n)this[x$E]=x$n[x$E];x$O._parseStandardMaterial(x$x,this,x$h),this._endLoaded()}},x$b.cloneTo=function(x$b){x$C.prototype.cloneTo.call(this,x$b);var x$_=x$b;this._transformUV&&(x$_._transformUV=this._transformUV.clone())},x$Q(0,x$b,"ambientColor",function(){return this._getColor(9)},function(x$b){this._setColor(9,x$b)}),x$Q(0,x$b,"ambientTexture",function(){return this._getTexture(5)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,x$b)}),x$Q(0,x$b,"renderMode",null,function(x$b){switch(x$b){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(x$O.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(x$b)}),x$Q(0,x$b,"reflectColor",function(){return this._getColor(12)},function(x$b){this._setColor(12,x$b)}),x$Q(0,x$b,"tilingOffset",function(){return this._getColor(15)},function(x$b){if(x$b){var x$_=x$b.elements;1!=x$_[0]||1!=x$_[1]||0!=x$_[2]||0!=x$_[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,x$b)}),x$Q(0,x$b,"albedo",function(){return this._getColor(7)},function(x$b){this._setColor(7,x$b)}),x$Q(0,x$b,"diffuseColor",function(){return this._getColor(10)},function(x$b){this._setColor(10,x$b)}),x$Q(0,x$b,"albedoColor",function(){return this._getColor(7)},function(x$b){this._setColor(7,x$b)}),x$Q(0,x$b,"specularColor",function(){return this._getColor(11)},function(x$b){this._setColor(11,x$b)}),x$Q(0,x$b,"diffuseTexture",function(){return this._getTexture(1)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,x$b)}),x$Q(0,x$b,"normalTexture",function(){return this._getTexture(2)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,x$b)}),x$Q(0,x$b,"specularTexture",function(){return this._getTexture(3)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,x$b)}),x$Q(0,x$b,"emissiveTexture",function(){return this._getTexture(4)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,x$b)}),x$Q(0,x$b,"reflectTexture",function(){return this._getTexture(6)},function(x$b){x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,x$b)}),x$Q(0,x$b,"transformUV",function(){return this._transformUV},function(x$b){this._transformUV=x$b,this._setMatrix4x4(13,x$b.matrix),x$b?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,x$b.matrix.elements,0)}),x$O.__init__=function(){x$O.SHADERDEFINE_DIFFUSEMAP=x$O.shaderDefines.registerDefine("DIFFUSEMAP"),x$O.SHADERDEFINE_NORMALMAP=x$O.shaderDefines.registerDefine("NORMALMAP"),x$O.SHADERDEFINE_SPECULARMAP=x$O.shaderDefines.registerDefine("SPECULARMAP"),x$O.SHADERDEFINE_EMISSIVEMAP=x$O.shaderDefines.registerDefine("EMISSIVEMAP"),x$O.SHADERDEFINE_AMBIENTMAP=x$O.shaderDefines.registerDefine("AMBIENTMAP"),x$O.SHADERDEFINE_REFLECTMAP=x$O.shaderDefines.registerDefine("REFLECTMAP"),x$O.SHADERDEFINE_UVTRANSFORM=x$O.shaderDefines.registerDefine("UVTRANSFORM"),x$O.SHADERDEFINE_TILINGOFFSET=x$O.shaderDefines.registerDefine("TILINGOFFSET"),x$O.SHADERDEFINE_ADDTIVEFOG=x$O.shaderDefines.registerDefine("ADDTIVEFOG")},x$O.load=function(x$b){return x$$.loader.create(x$b,null,null,x$O)},x$O._parseStandardMaterial=function(x$b,x$_,x$s){var x$h=x$s.customProps,x$x=x$h.ambientColor;x$_.ambientColor=new x$E_(x$x[0],x$x[1],x$x[2]);var x$n=x$h.diffuseColor;x$_.diffuseColor=new x$E_(x$n[0],x$n[1],x$n[2]);var x$E=x$h.specularColor;x$_.specularColor=new x$C_(x$E[0],x$E[1],x$E[2],x$E[3]);var x$C=x$h.reflectColor;x$_.reflectColor=new x$E_(x$C[0],x$C[1],x$C[2]);var x$O=x$h.albedoColor;x$O&&(x$_.albedo=new x$C_(x$O[0],x$O[1],x$O[2],x$O[3]));var x$L=x$h.diffuseTexture.texture2D;x$L&&(x$_.diffuseTexture=x$i.getRes(x$b[x$L]));var x$f=x$h.normalTexture.texture2D;x$f&&(x$_.normalTexture=x$i.getRes(x$b[x$f]));var x$p=x$h.specularTexture.texture2D;x$p&&(x$_.specularTexture=x$i.getRes(x$b[x$p]));var x$P=x$h.emissiveTexture.texture2D;x$P&&(x$_.emissiveTexture=x$i.getRes(x$b[x$P]));var x$V=x$h.ambientTexture.texture2D;x$V&&(x$_.ambientTexture=x$i.getRes(x$b[x$V]));var x$Q=x$h.reflectTexture.texture2D;x$Q&&(x$_.reflectTexture=x$i.getRes(x$b[x$Q]))},x$O.RENDERMODE_OPAQUE=1,x$O.RENDERMODE_OPAQUEDOUBLEFACE=2,x$O.RENDERMODE_CUTOUT=3,x$O.RENDERMODE_CUTOUTDOUBLEFACE=4,x$O.RENDERMODE_TRANSPARENT=13,x$O.RENDERMODE_TRANSPARENTDOUBLEFACE=14,x$O.RENDERMODE_ADDTIVE=15,x$O.RENDERMODE_ADDTIVEDOUBLEFACE=16,x$O.RENDERMODE_DEPTHREAD_TRANSPARENT=5,x$O.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,x$O.RENDERMODE_DEPTHREAD_ADDTIVE=7,x$O.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,x$O.RENDERMODE_NONDEPTH_TRANSPARENT=9,x$O.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,x$O.RENDERMODE_NONDEPTH_ADDTIVE=11,x$O.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,x$O.SHADERDEFINE_DIFFUSEMAP=0,x$O.SHADERDEFINE_NORMALMAP=0,x$O.SHADERDEFINE_SPECULARMAP=0,x$O.SHADERDEFINE_EMISSIVEMAP=0,x$O.SHADERDEFINE_AMBIENTMAP=0,x$O.SHADERDEFINE_REFLECTMAP=0,x$O.SHADERDEFINE_UVTRANSFORM=0,x$O.SHADERDEFINE_TILINGOFFSET=0,x$O.SHADERDEFINE_ADDTIVEFOG=0,x$O.DIFFUSETEXTURE=1,x$O.NORMALTEXTURE=2,x$O.SPECULARTEXTURE=3,x$O.EMISSIVETEXTURE=4,x$O.AMBIENTTEXTURE=5,x$O.REFLECTTEXTURE=6,x$O.ALBEDO=7,x$O.UVANIAGE=8,x$O.MATERIALAMBIENT=9,x$O.MATERIALDIFFUSE=10,x$O.MATERIALSPECULAR=11,x$O.MATERIALREFLECT=12,x$O.UVMATRIX=13,x$O.UVAGE=14,x$O.TILINGOFFSET=15,x$p(x$O,["defaultMaterial",function(){var x$b=new x$O;return x$b.lock=!0,this.defaultMaterial=x$b},"shaderDefines",function(){return this.shaderDefines=new x$f_(x$S_.shaderDefines)}]),x$O}(x$S_),x$a_=function(x$b){function x$E(x$b,x$_,x$s,x$h,x$x){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===x$s&&(x$s=35044),void 0===x$h&&(x$h=!1),x$E.__super.call(this),this._indexType=x$b,this._indexCount=x$_,this._bufferUsage=x$s,this._bufferType=34963,this._canRead=x$h;var x$n;if("ushort"==x$b)this._indexTypeByteCount=2;else{if("ubyte"!=x$b)throw new Error("unidentification index type.");this._indexTypeByteCount=1}x$n=this._indexTypeByteCount*x$_,this._byteLength=x$n,this._bind(),x$C._gl.bufferData(this._bufferType,x$n,this._bufferUsage),this.uri=x$x,x$h?("ushort"==x$b?this._buffer=new Uint16Array(x$_):"ubyte"==x$b&&(this._buffer=new Uint8Array(x$_)),this.memorySize=2*x$n):this.memorySize=x$n}x$V(x$E,"laya.d3.graphics.IndexBuffer3D",x$b);var x$_=x$E.prototype;return x$_.setData=function(x$b,x$_,x$s,x$h){void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=4294967295);var x$x=0;if("ushort"==this._indexType?(x$x=2,0===x$s&&4294967295===x$h||(x$b=new Uint16Array(x$b.buffer,x$s*x$x,x$h))):"ubyte"==this._indexType&&(x$x=1,0===x$s&&4294967295===x$h||(x$b=new Uint8Array(x$b.buffer,x$s*x$x,x$h))),this._bind(),x$C._gl.bufferSubData(this._bufferType,x$_*x$x,x$b),this._canRead)if(0!==x$_||0!==x$s||4294967295!==x$h){var x$n=this._buffer.length-x$_;x$n<x$h&&(x$h=x$n);for(var x$E=0;x$E<x$h;x$E++)this._buffer[x$_+x$E]=x$b[x$E]}else this._buffer=x$b},x$_.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},x$_.disposeResource=function(){x$b.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},x$Q(0,x$_,"indexType",function(){return this._indexType}),x$Q(0,x$_,"indexTypeByteCount",function(){return this._indexTypeByteCount}),x$Q(0,x$_,"indexCount",function(){return this._indexCount}),x$Q(0,x$_,"canRead",function(){return this._canRead}),x$E.INDEXTYPE_UBYTE="ubyte",x$E.INDEXTYPE_USHORT="ushort",x$E.create=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$s&&(x$s=35044),void 0===x$h&&(x$h=!1),new x$E(x$b,x$_,x$s,x$h,x$x)},x$E}(x$C),x$K_=function(x$n){function x$E(x$b,x$_,x$s,x$h,x$x){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===x$h&&(x$h=!1),x$E.__super.call(this),this._vertexDeclaration=x$b,this._vertexCount=x$_,this._bufferUsage=x$s,this._bufferType=34962,this._canRead=x$h,this.uri=x$x,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*x$_,this._bind(),x$C._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),x$h&&(this._buffer=new Float32Array(this._byteLength/4))}x$V(x$E,"laya.d3.graphics.VertexBuffer3D",x$n);var x$b=x$E.prototype;return x$b.bindWithIndexBuffer=function(x$b){x$b&&x$b._bind(),this._bind()},x$b.setData=function(x$b,x$_,x$s,x$h){if(void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=4294967295),0===x$s&&4294967295===x$h||(x$b=new Float32Array(x$b.buffer,4*x$s,x$h)),this._bind(),x$C._gl.bufferSubData(this._bufferType,4*x$_,x$b),this._canRead)if(0!==x$_||0!==x$s||4294967295!==x$h){var x$x=this._buffer.length-x$_;x$x<x$h&&(x$h=x$x);for(var x$n=0;x$n<x$h;x$n++)this._buffer[x$_+x$n]=x$b[x$n]}else this._buffer=x$b},x$b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},x$b.disposeResource=function(){for(var x$b=x$Z.mainContext,x$_=this._vertexDeclaration.getVertexElements(),x$s=x$C._enableAtributes,x$h=0,x$x=x$_.length;x$h<x$x;x$h++)x$s[x$h]===this._glBuffer&&(x$b.disableVertexAttribArray(x$h),x$s[x$h]=null);x$n.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},x$Q(0,x$b,"vertexDeclaration",function(){return this._vertexDeclaration}),x$Q(0,x$b,"vertexCount",function(){return this._vertexCount}),x$Q(0,x$b,"canRead",function(){return this._canRead}),x$E.create=function(x$b,x$_,x$s,x$h,x$x){return void 0===x$s&&(x$s=35044),void 0===x$h&&(x$h=!1),new x$E(x$b,x$_,x$s,x$h,x$x)},x$E}(x$C),x$d_=function(x$b){function x$t(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,x$t.__super.call(this),this._type=3553}x$V(x$t,"laya.d3.resource.DataTexture2D",x$Z_);var x$_=x$t.prototype;return x$_.genDebugMipmaps=function(){var x$b=[];return x$b.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),x$b.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),x$b.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),x$b.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),x$b.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),x$b.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),x$b.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),x$b.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),x$b.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),x$b.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),x$b},x$_._onTextureLoaded=function(x$b){},x$_._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var x$b=x$Z.mainContext,x$_=this._source=x$b.createTexture(),x$s=this._width,x$h=this._height,x$x=x$J.curBindTexTarget,x$n=x$J.curBindTexValue,x$E=!1;if(x$J.bindTexture(x$b,this._type,x$_),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var x$C=0;x$b.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var x$O=0;x$O<this._mipmaps.length;x$O++){if(this._mipmaps[x$O].byteLength!=x$L*x$f*4)throw"mipmap size error  level:"+x$O;x$b.texSubImage2D(this._type,0,x$t.simLodRect[x$C++],x$t.simLodRect[x$C++],x$t.simLodRect[x$C++],x$t.simLodRect[x$C++],6408,5121,new Uint8Array(this._mipmaps[x$O]))}this.minFifter=9729,this.magFifter=9729}else{var x$L=this._width,x$f=this._height;for(x$C=0,x$b.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),x$O=0;x$O<this._mipmaps.length;x$O++){if(this._mipmaps[x$O].byteLength!=x$L*x$f*4)throw"mipmap size error  level:"+x$O;x$b.texImage2D(this._type,x$O,6408,x$L,x$f,0,6408,5121,new Uint8Array(this._mipmaps[x$O])),(x$L/=2)<1&&(x$L=1),(x$f/=2)<1&&(x$f=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&x$b.pixelStorei(x$b.UNPACK_ALIGNMENT,1),x$b.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var x$p=0,x$P=!1,x$V=!1;this._buffer.byteLength==4*x$s*x$h?(x$p=6408,x$P=!0):this._buffer.byteLength==3*x$s*x$h?(x$p=6407,x$V=!0):x$p=this._format,x$P||x$V?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),x$V&&x$b.pixelStorei(x$b.UNPACK_ALIGNMENT,1),x$b.texImage2D(this._type,0,x$p,x$s,x$h,0,x$p,5121,this._buffer)):x$b&&x$p==x$b.ALPHA?(x$b.texImage2D(3553,0,x$p,x$s,x$h,0,x$p,x$b.UNSIGNED_BYTE,this._buffer),x$E=!0):0!=x$p&&(x$b.compressedTexImage2D(3553,0,x$p,x$s,x$h,0,this._buffer),x$E=!0)}var x$Q=this._minFifter,x$y=this._magFifter,x$w=0==this._wrapModeU?10497:33071,x$i=0==this._wrapModeV?10497:33071,x$R=x$c.isPOT(x$s,x$h);x$R?(this._mipmap||this._mipmaps?-1!==x$Q||(x$Q=9987):-1!==x$Q||(x$Q=9729),-1!==x$y||(x$y=9729),x$b.texParameteri(this._type,10241,x$Q),x$b.texParameteri(this._type,10240,x$y),x$b.texParameteri(this._type,10242,x$w),x$b.texParameteri(this._type,10243,x$i),this._mipmap&&x$b.generateMipmap(this._type)):(-1!==x$Q||(x$Q=9729),-1!==x$y||(x$y=9729),x$b.texParameteri(this._type,10241,x$Q),x$b.texParameteri(this._type,10240,x$y),x$b.texParameteri(this._type,10242,33071),x$b.texParameteri(this._type,10243,33071)),x$x&&x$n&&x$J.bindTexture(x$b,x$x,x$n),this.memorySize=x$E?this._buffer.length:x$R?x$s*x$h*4*(1+1/3):x$s*x$h*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},x$_.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},x$_.onAsynLoaded=function(x$b,x$_,x$s){var x$h;x$s&&(x$h=x$s[0].call(this,x$_)),x$h&&(this._width=x$h.width,this._height=x$h.height,this._buffer=x$h.data),this._src=x$b,this._size=new x$y_(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},x$_.getPixels=function(){return new Uint8Array(this._buffer)},x$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(x$Z.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},x$Q(0,x$_,"src",function(){return this._src}),x$t.create=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){if(void 0===x$h&&(x$h=9729),void 0===x$x&&(x$x=9729),void 0===x$n&&(x$n=!0),!x$b||x$b.byteLength<x$_*x$s*4)throw"DataTexture2D create error";var x$C=new x$t;return x$C.uri=x$E,x$C._buffer=x$b,x$C._width=x$_,x$C._height=x$s,x$C._mipmap=x$n,x$C._magFifter=x$h,x$C._minFifter=x$x,x$C._size=new x$y_(x$C._width,x$C._height),x$C._conchTexture?alert("怎么给runtime传递datatexture数据"):x$C.activeResource(),x$C},x$t.load=function(x$b,x$_,x$s,x$h,x$x){if(void 0===x$_&&(x$_=0),void 0===x$s&&(x$s=0),void 0===x$h&&(x$h=9729),void 0===x$x&&(x$x=9729),"mipmaps"===x$k.getFileExtension(x$b)){var x$n=x$$.loader.create(x$b,null,null,x$t,[function(x$b){this._mipmaps=[];var x$_=new Uint32Array(x$b);this._width=x$_[0];var x$s=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,x$s=1024),this._width!=x$s)throw"现在只支持512x256的环境贴图。当前的是"+x$_[0];this._height=x$_[1];for(var x$h=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,x$x=this._height,x$n=8;;){var x$E=x$h*x$x*4;if(x$n+x$E>x$b.byteLength)throw"load mipmaps data size error ";var x$C=new Uint8Array(x$b,x$n,x$E);if(this._mipmaps.push(x$C),x$n+=x$E,1==x$h&&1==x$x)break;(x$h/=2)<1&&(x$h=1),(x$x/=2)<1&&(x$x=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){x$n.simLodInfo=new Float32Array(40);for(var x$E=0;x$E<x$n.simLodInfo.length;)x$n.simLodInfo[x$E]=(x$t.simLodRect[x$E]+.5)/1024,x$E++,x$n.simLodInfo[x$E]=(x$t.simLodRect[x$E]+.5)/256,x$E++,x$n.simLodInfo[x$E]=Math.max(x$t.simLodRect[x$E]-1,.1)/1024,x$E++,x$n.simLodInfo[x$E]=Math.max(x$t.simLodRect[x$E]-1.5,.1)/256,x$E++}return x$n}if("number"==typeof x$_)return x$$.loader.create(x$b,null,null,x$t,[function(x$b){return this._width=x$_,this._height=x$s,this._buffer=x$b,null}]);if("function"==typeof x$_)return x$$.loader.create(x$b,null,null,x$t,[x$_]);throw new Error("unknown params.")},x$t.lodasatlas=!1,x$p(x$t,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),x$t}(),x$I_=function(x$b){function x$_(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,x$_.__super.call(this)}x$V(x$_,"laya.d3.resource.models.PrimitiveMesh",x$J_);var x$s=x$_.prototype;return x$$.imps(x$s,{"laya.d3.core.render.IRenderable":!0}),x$s._getVertexBuffer=function(x$b){return void 0===x$b&&(x$b=0),0===x$b?this._vertexBuffer:null},x$s._getVertexBuffers=function(){return null},x$s._getIndexBuffer=function(){return this._indexBuffer},x$s._getPositions=function(){var x$b,x$_=[],x$s=this._vertexBuffer.vertexDeclaration.getVertexElements(),x$h=0;for(x$h=0;x$h<x$s.length;x$h++){var x$x=x$s[x$h];if("vector3"===x$x.elementFormat&&0===x$x.elementUsage){x$b=x$x;break}}var x$n=this._vertexBuffer.getData();for(x$h=0;x$h<x$n.length;x$h+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var x$E=x$h+x$b.offset/4,x$C=new x$E_(x$n[x$E+0],x$n[x$E+1],x$n[x$E+2]);x$_.push(x$C)}return x$_},x$s.getRenderElement=function(x$b){return this},x$s.getRenderElementsCount=function(){return 1},x$s.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},x$s._beforeRender=function(x$b){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},x$s._render=function(x$b){x$Z.mainContext.drawElements(4,this._numberIndices,5123,0),x$M.drawCall++,x$M.trianglesFaces+=this._numberIndices/3},x$Q(0,x$s,"_vertexBufferCount",function(){return 1}),x$Q(0,x$s,"triangleCount",function(){return this._indexBuffer.indexCount/3}),x$_}(),x$g_=function(x$b){function x$_(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,x$_.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}x$V(x$_,"laya.d3.resource.models.Mesh",x$J_);var x$s=x$_.prototype;return x$s._getPositions=function(){var x$b,x$_,x$s,x$h,x$x,x$n=[],x$E=0,x$C=0,x$O=0;if(0!==this._vertexBuffers.length){var x$L=this._vertexBuffers.length;for(x$E=0;x$E<x$L;x$E++){for(x$s=(x$b=this._vertexBuffers[x$E]).vertexDeclaration.getVertexElements(),x$C=0;x$C<x$s.length;x$C++)if("vector3"===(x$h=x$s[x$C]).elementFormat&&0===x$h.elementUsage){x$_=x$h;break}for(x$x=x$b.getData(),x$C=0;x$C<x$x.length;x$C+=x$b.vertexDeclaration.vertexStride/4)x$O=x$C+x$_.offset/4,x$n.push(new x$E_(x$x[x$O+0],x$x[x$O+1],x$x[x$O+2]))}}else{var x$f=this._subMeshes.length;for(x$E=0;x$E<x$f;x$E++){for(x$s=(x$b=this._subMeshes[x$E]._getVertexBuffer()).vertexDeclaration.getVertexElements(),x$C=0;x$C<x$s.length;x$C++)if("vector3"===(x$h=x$s[x$C]).elementFormat&&0===x$h.elementUsage){x$_=x$h;break}for(x$x=x$b.getData(),x$C=0;x$C<x$x.length;x$C+=x$b.vertexDeclaration.vertexStride/4)x$O=x$C+x$_.offset/4,x$n.push(new x$E_(x$x[x$O+0],x$x[x$O+1],x$x[x$O+2]))}}return x$n},x$s._setSubMeshes=function(x$b){this._subMeshes=x$b,this._subMeshCount=x$b.length;for(var x$_=0;x$_<this._subMeshCount;x$_++)x$b[x$_]._indexInMesh=x$_;this._positions=this._getPositions(),this._generateBoundingObject()},x$s.onAsynLoaded=function(x$b,x$_,x$s){var x$h=x$_[0],x$x=x$_[1];x$Yb.read(x$h,this,this._materials,this._subMeshes,x$x),this.completeCreate(),this._endLoaded()},x$s.getSubMesh=function(x$b){return this._subMeshes[x$b]},x$s.getSubMeshCount=function(){return this._subMeshes.length},x$s.getRenderElementsCount=function(){return this._subMeshes.length},x$s.getRenderElement=function(x$b){return this._subMeshes[x$b]},x$s.disposeResource=function(){for(var x$b=0;x$b<this._subMeshes.length;x$b++)this._subMeshes[x$b].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},x$Q(0,x$s,"materials",function(){return this._materials.slice()}),x$Q(0,x$s,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),x$_.load=function(x$b){return x$$.loader.create(x$b,null,null,x$_)},x$_}(),x$F_=(function(x$b){function x$L(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===x$s&&(x$s=6408),void 0===x$h&&(x$h=5121),void 0===x$x&&(x$x=33189),void 0===x$n&&(x$n=!1),void 0===x$E&&(x$E=!1),void 0===x$C&&(x$C=-1),void 0===x$O&&(x$O=-1),x$L.__super.call(this),this._type=3553,this._width=x$b,this._height=x$_,this._size=new x$y_(x$b,x$_),this._surfaceFormat=x$s,this._surfaceType=x$h,this._depthStencilFormat=x$x,x$y.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=x$n,this._repeat=x$E,this._minFifter=x$C,this._magFifter=x$O,this.activeResource(),this._alreadyResolved=!0}x$V(x$L,"laya.d3.resource.RenderTexture",x$Z_);var x$_=x$L.prototype;x$_.recreateResource=function(){var x$b=x$Z.mainContext;this._frameBuffer=x$b.createFramebuffer(),this._source=x$b.createTexture();var x$_=x$J.curBindTexTarget,x$s=x$J.curBindTexValue;x$J.bindTexture(x$b,this._type,this._source),x$b.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var x$h=this._minFifter,x$x=this._magFifter,x$n=this._repeat?10497:33071;if(x$c.isPOT(this._width,this._height)?(this._mipmap?-1!==x$h||(x$h=9987):-1!==x$h||(x$h=9729),-1!==x$x||(x$x=9729),x$b.texParameteri(this._type,10241,x$h),x$b.texParameteri(this._type,10240,x$x),x$b.texParameteri(this._type,10242,x$n),x$b.texParameteri(this._type,10243,x$n),this._mipmap&&x$b.generateMipmap(this._type)):(-1!==x$h||(x$h=9729),-1!==x$x||(x$x=9729),x$b.texParameteri(this._type,10241,x$h),x$b.texParameteri(this._type,10240,x$x),x$b.texParameteri(this._type,10242,33071),x$b.texParameteri(this._type,10243,33071)),x$_&&x$s&&x$J.bindTexture(x$b,x$_,x$s),x$b.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=x$b.createRenderbuffer(),x$b.bindRenderbuffer(36161,this._depthStencilBuffer),x$b.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),x$b.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:x$b.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:x$b.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:x$b.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}x$b.framebufferTexture2D(36160,36064,3553,this._source,0),x$b.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},x$_.start=function(){x$Z.mainContext.bindFramebuffer(36160,this.frameBuffer),(x$L._currentRenderTarget=this)._alreadyResolved=!1},x$_.end=function(){x$Z.mainContext.bindFramebuffer(36160,null),x$L._currentRenderTarget=null,this._alreadyResolved=!0},x$_.getData=function(x$b,x$_,x$s,x$h){var x$x=x$Z.mainContext;if(x$x.bindFramebuffer(36160,this._frameBuffer),!(36053===x$x.checkFramebufferStatus(36160)))return x$x.bindFramebuffer(36160,null),null;var x$n=new Uint8Array(this._width*this._height*4);return x$x.readPixels(x$b,x$_,x$s,x$h,this._surfaceFormat,this._surfaceType,x$n),x$x.bindFramebuffer(36160,null),x$n},x$_.disposeResource=function(){if(this._frameBuffer){var x$b=x$Z.mainContext;x$b.deleteTexture(this._source),x$b.deleteFramebuffer(this._frameBuffer),x$b.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},x$Q(0,x$_,"surfaceFormat",function(){return this._surfaceFormat}),x$Q(0,x$_,"surfaceType",function(){return this._surfaceType}),x$Q(0,x$_,"depthStencilFormat",function(){return this._depthStencilFormat}),x$Q(0,x$_,"source",function(){return this._alreadyResolved?x$$.superGet(x$Z_,this,"source"):null}),x$Q(0,x$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),x$Q(0,x$_,"frameBuffer",function(){return this._frameBuffer}),x$L._currentRenderTarget=null}(),function(x$b){function x$_(x$b){this._color=null,this._pixels=null,x$_.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new x$y_(this.width,this.height),this._color=x$b,this._pixels=new Uint8Array([255*x$b.x,255*x$b.y,255*x$b.z,255*x$b.w]),this.uri="SolidColorTexture2D_"+this.id}x$V(x$_,"laya.d3.resource.SolidColorTexture2D",x$Z_);var x$s=x$_.prototype;return x$s._createWebGlTexture=function(){var x$b=x$Z.mainContext,x$_=this._source=x$b.createTexture(),x$s=this._width,x$h=this._height,x$x=x$J.curBindTexTarget,x$n=x$J.curBindTexValue;x$J.bindTexture(x$b,this._type,x$_),x$b.texImage2D(this._type,0,6408,x$s,x$h,0,6408,5121,this._pixels);var x$E=this._minFifter,x$C=this._magFifter,x$O=this._repeat?10497:33071,x$L=x$c.isPOT(x$s,x$h);x$L?(this._mipmap?-1!==x$E||(x$E=9987):-1!==x$E||(x$E=9729),-1!==x$C||(x$C=9729),x$b.texParameteri(this._type,10241,x$E),x$b.texParameteri(this._type,10240,x$C),x$b.texParameteri(this._type,10242,x$O),x$b.texParameteri(this._type,10243,x$O),this._mipmap&&x$b.generateMipmap(this._type)):(-1!==x$E||(x$E=9729),-1!==x$C||(x$C=9729),x$b.texParameteri(this._type,10241,x$E),x$b.texParameteri(this._type,10240,x$C),x$b.texParameteri(this._type,10242,33071),x$b.texParameteri(this._type,10243,33071)),x$x&&x$n&&x$J.bindTexture(x$b,x$x,x$n),this.memorySize=x$L?x$s*x$h*4*(1+1/3):x$s*x$h*4},x$s.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},x$s.disposeResource=function(){this._source&&(x$Z.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},x$p(x$_,["magentaTexture",function(){var x$b=new x$_(new x$C_(1,0,1,1));return x$b.lock=!0,this.magentaTexture=x$b},"grayTexture",function(){var x$b=new x$_(new x$C_(.5,.5,.5,1));return x$b.lock=!0,this.grayTexture=x$b}]),x$_}()),x$A_=function(x$b){function x$x(x$b,x$_,x$s,x$h){this._canRead=!1,this._image=null,this._pixels=null,void 0===x$b&&(x$b=!1),void 0===x$_&&(x$_=!0),void 0===x$s&&(x$s=6408),void 0===x$h&&(x$h=!0),x$x.__super.call(this),this._type=3553,this._repeat=x$_,this._canRead=x$b,this._format=x$s,this._mipmap=x$h}x$V(x$x,"laya.d3.resource.Texture2D",x$Z_);var x$_=x$x.prototype;return x$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var x$b=x$Z.mainContext,x$_=this._source=x$b.createTexture(),x$s=this._width,x$h=this._height,x$x=x$J.curBindTexTarget,x$n=x$J.curBindTexValue;switch(x$J.bindTexture(x$b,this._type,x$_),this._format){case 6407:case 6408:this._canRead?x$b.texImage2D(this._type,0,this._format,x$s,x$h,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?x$b.texImage2D(this._type,0,this._image._format,x$s,x$h,0,this._image._format,5121,this._image.atlasSource):x$b.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case x$Z.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:x$b.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var x$E=this._minFifter,x$C=this._magFifter,x$O=this._repeat?10497:33071,x$L=0==this._wrapModeU?10497:33071,x$f=0==this._wrapModeV?10497:33071,x$p=x$c.isPOT(x$s,x$h);x$p?(this._mipmap?-1!==x$E||(x$E=9987):-1!==x$E||(x$E=9729),-1!==x$C||(x$C=9729),x$b.texParameteri(this._type,10241,x$E),x$b.texParameteri(this._type,10240,x$C),x$b.texParameteri(this._type,10242,x$O),x$b.texParameteri(this._type,10243,x$O),x$b.texParameteri(this._type,10242,x$L),x$b.texParameteri(this._type,10243,x$f),this._mipmap&&x$b.generateMipmap(this._type)):(-1!==x$E||(x$E=9729),-1!==x$C||(x$C=9729),x$b.texParameteri(this._type,10241,x$E),x$b.texParameteri(this._type,10240,x$C),x$b.texParameteri(this._type,10242,33071),x$b.texParameteri(this._type,10243,33071)),x$x&&x$n&&x$J.bindTexture(x$b,x$x,x$n),this._image.onload=null,this._image=null,this.memorySize=x$p?x$s*x$h*4*(1+1/3):x$s*x$h*4},x$_.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},x$_.onAsynLoaded=function(x$b,x$_,x$s){if(x$s){var x$h=x$s[0];void 0!==x$h&&(this._canRead=x$h);var x$x=x$s[1];void 0!==x$x&&(this._repeat=x$x);var x$n=x$s[2];void 0!==x$n&&(this._format=x$n);var x$E=x$s[3];void 0!==x$E&&(this._mipmap=x$E);var x$C=x$s.wrapModeU;void 0!==x$C&&(this._wrapModeU=x$C);var x$O=x$s.wrapModeV;void 0!==x$O&&(this._wrapModeV=x$O)}switch(this._format){case 6407:case 6408:var x$L=(this._image=x$_).width,x$f=x$_.height;this._width=x$L,this._height=x$f,this._size=new x$y_(x$L,x$f),this._canRead&&(x$y.isConchApp?x$_ instanceof x$P.HTMLElement&&(this._pixels=new Uint8Array(x$_.getImageData(0,0,x$L,x$f))):(x$W.canvas.size(x$L,x$f),x$W.canvas.clear(),x$W.context.drawImage(x$_,0,0,x$L,x$f),this._pixels=new Uint8Array(x$W.context.getImageData(0,0,x$L,x$f).data.buffer)));break;case x$Z.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var x$p=new x$D(x$_);x$p.readUTFBytes(4),x$p.readUTFBytes(2),x$p.getInt16();x$p.endian="bigEndian",this._width=x$p.getInt16(),this._height=x$p.getInt16(),this._size=new x$y_(this._width,this._height);x$p.getInt16(),x$p.getInt16();this._image=new Uint8Array(x$_,x$p.pos)}this.recreateResource(),this._endLoaded()},x$_.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},x$_.disposeResource=function(){this._source&&(x$Z.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},x$Q(0,x$_,"_src",function(){return this.url}),x$Q(0,x$_,"src",function(){return this.url}),x$x.load=function(x$b){return x$$.loader.create(x$b,null,null,x$x)},x$x}(),x$u_=function(x$_){function x$s(x$b,x$_){x$s.__super.call(this),void 0===x$b&&(x$b=.3),void 0===x$_&&(x$_=1e3),this._tempVector3=new x$E_,this._position=new x$E_,this._up=new x$E_,this._forward=new x$E_,this._right=new x$E_,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=x$y_.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=x$b,this._farPlane=x$_,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),x$$.stage.on("resize",this,this._onScreenSizeChanged)}x$V(x$s,"laya.d3.core.BaseCamera",x$_);var x$b=x$s.prototype;return x$b._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var x$b=this.scene._cameraPool,x$_=x$b.length-1,x$s=0;x$s<x$_;x$s++)if(x$b[x$s].renderingOrder>x$b[x$_].renderingOrder){var x$h=x$b[x$s];x$b[x$s]=x$b[x$_],x$b[x$_]=x$h}},x$b._calculateProjectionMatrix=function(){},x$b._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},x$b._prepareCameraToRender=function(){x$T._currentCameraCullingMask=this.cullingMask;var x$b=this._shaderValues;x$b.setValue(0,this.transform.position.elements),x$b.setValue(5,this.forward.elements),x$b.setValue(6,this.up.elements)},x$b._prepareCameraViewProject=function(x$b,x$_){var x$s=this._shaderValues;x$s.setValue(1,x$b.elements),x$s.setValue(2,x$_.elements)},x$b._renderCamera=function(x$b,x$_,x$s){},x$b.addLayer=function(x$b){29!==x$b.number&&30!=x$b.number&&(this.cullingMask=this.cullingMask|x$b.mask)},x$b.removeLayer=function(x$b){29!==x$b.number&&30!=x$b.number&&(this.cullingMask=this.cullingMask&~x$b.mask)},x$b.addAllLayers=function(){this.cullingMask=2147483647},x$b.removeAllLayers=function(){this.cullingMask=0|x$T.getLayerByNumber(29).mask|x$T.getLayerByNumber(30).mask},x$b.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},x$b.moveForward=function(x$b){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=x$b,this.transform.translate(this._tempVector3)},x$b.moveRight=function(x$b){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=x$b,this.transform.translate(this._tempVector3)},x$b.moveVertical=function(x$b){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=x$b,this.transform.translate(this._tempVector3,!1)},x$b._addSelfRenderObjects=function(){var x$b=this.scene._cameraPool,x$_=x$b.length;if(0<x$_){for(var x$s=x$_-1;0<=x$s;x$s--)if(this.renderingOrder<=x$b[x$s].renderingOrder){x$b.splice(x$s+1,0,this);break}}else x$b.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},x$b._clearSelfRenderObjects=function(){var x$b=this.scene._cameraPool;x$b.splice(x$b.indexOf(this),1)},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,x$$.stage.off("resize",this,this._onScreenSizeChanged),x$_.prototype.destroy.call(this,x$b)},x$Q(0,x$b,"sky",function(){return this._sky},function(x$b){(this._sky=x$b)._ownerCamera=this}),x$Q(0,x$b,"forward",function(){var x$b=this.transform.worldMatrix.elements,x$_=this._forward.elements;return x$_[0]=-x$b[8],x$_[1]=-x$b[9],x$_[2]=-x$b[10],this._forward}),x$Q(0,x$b,"position",function(){var x$b=this.transform.worldMatrix.elements,x$_=this._position.elements;return x$_[0]=x$b[12],x$_[1]=x$b[13],x$_[2]=x$b[14],this._position}),x$Q(0,x$b,"renderTarget",function(){return this._renderTarget},function(x$b){null!=(this._renderTarget=x$b)&&(this._renderTargetSize=x$b.size)}),x$Q(0,x$b,"up",function(){var x$b=this.transform.worldMatrix.elements,x$_=this._up.elements;return x$_[0]=x$b[4],x$_[1]=x$b[5],x$_[2]=x$b[6],this._up}),x$Q(0,x$b,"right",function(){var x$b=this.transform.worldMatrix.elements,x$_=this._right.elements;return x$_[0]=x$b[0],x$_[1]=x$b[1],x$_[2]=x$b[2],this._right}),x$Q(0,x$b,"renderTargetSize",function(){return this._renderTargetSize},function(x$b){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"fieldOfView",function(){return this._fieldOfView},function(x$b){this._fieldOfView=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"nearPlane",function(){return this._nearPlane},function(x$b){this._nearPlane=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"farPlane",function(){return this._farPlane},function(x$b){this._farPlane=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"orthographic",function(){return this._orthographic},function(x$b){this._orthographic=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(x$b){this._orthographicVerticalSize=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$b,"renderingOrder",function(){return this._renderingOrder},function(x$b){this._renderingOrder=x$b,this._sortCamerasByRenderingOrder()}),x$s.CAMERAPOS=0,x$s.VIEWMATRIX=1,x$s.PROJECTMATRIX=2,x$s.VPMATRIX=3,x$s.VPMATRIX_NO_TRANSLATE=4,x$s.CAMERADIRECTION=5,x$s.CAMERAUP=6,x$s.ENVIRONMENTDIFFUSE=7,x$s.ENVIRONMENTSPECULAR=8,x$s.SIMLODINFO=9,x$s.DIFFUSEIRRADMATR=10,x$s.DIFFUSEIRRADMATG=11,x$s.DIFFUSEIRRADMATB=12,x$s.HDREXPOSURE=13,x$s.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",x$s.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",x$s.CLEARFLAG_SOLIDCOLOR=0,x$s.CLEARFLAG_SKY=1,x$s.CLEARFLAG_DEPTHONLY=2,x$s.CLEARFLAG_NONE=3,x$p(x$s,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new x$b_(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new x$b_},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new x$b_}]),x$s}(x$U_),x$l_=function(x$s){function x$_(x$b){this._render=null,this._geometryFilter=null,x$_.__super.call(this,x$b)}x$V(x$_,"laya.d3.core.RenderableSprite3D",x$s);var x$b=x$_.prototype;return x$b._addToInitStaticBatchManager=function(){},x$b._setBelongScene=function(x$b){x$s.prototype._setBelongScene.call(this,x$b),x$b._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},x$b._setUnBelongScene=function(){var x$b=this._scene._renderableSprite3Ds,x$_=x$b.indexOf(this);x$b.splice(x$_,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),x$s.prototype._setUnBelongScene.call(this)},x$b._update=function(x$b){(x$b.owner=this)._activeInHierarchy&&(this._updateComponents(x$b),this._render._updateOctreeNode(),this._lateUpdateComponents(x$b),x$M.spriteCount++,this._childs.length&&this._updateChilds(x$b))},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$s.prototype.destroy.call(this,x$b),this._render._destroy(),this._render=null},x$_.__init__=function(){x$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=x$_.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),x$_.SAHDERDEFINE_LIGHTMAP=x$_.shaderDefines.registerDefine("LIGHTMAP")},x$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,x$_.SAHDERDEFINE_LIGHTMAP=4,x$_.LIGHTMAPSCALEOFFSET=2,x$_.LIGHTMAP=3,x$p(x$_,["shaderDefines",function(){return this.shaderDefines=new x$f_}]),x$_}(x$U_),x$N_=(function(x$b){function x$h(x$b,x$_,x$s){this._long=NaN,this._width=NaN,this._height=NaN,void 0===x$b&&(x$b=1),void 0===x$_&&(x$_=1),void 0===x$s&&(x$s=1),x$h.__super.call(this),this._long=x$b,this._width=x$_,this._height=x$s,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}x$V(x$h,"laya.d3.resource.models.BoxMesh",x$I_);var x$_=x$h.prototype;x$_.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var x$b=x$Zb.vertexDeclaration,x$_=(x$b.vertexStride,this._long/2),x$s=this._height/2,x$h=this._width/2,x$x=new Float32Array([-x$_,x$s,-x$h,0,1,0,0,0,x$_,x$s,-x$h,0,1,0,1,0,x$_,x$s,x$h,0,1,0,1,1,-x$_,x$s,x$h,0,1,0,0,1,-x$_,-x$s,-x$h,0,-1,0,0,1,x$_,-x$s,-x$h,0,-1,0,1,1,x$_,-x$s,x$h,0,-1,0,1,0,-x$_,-x$s,x$h,0,-1,0,0,0,-x$_,x$s,-x$h,-1,0,0,0,0,-x$_,x$s,x$h,-1,0,0,1,0,-x$_,-x$s,x$h,-1,0,0,1,1,-x$_,-x$s,-x$h,-1,0,0,0,1,x$_,x$s,-x$h,1,0,0,1,0,x$_,x$s,x$h,1,0,0,0,0,x$_,-x$s,x$h,1,0,0,0,1,x$_,-x$s,-x$h,1,0,0,1,1,-x$_,x$s,x$h,0,0,1,0,0,x$_,x$s,x$h,0,0,1,1,0,x$_,-x$s,x$h,0,0,1,1,1,-x$_,-x$s,x$h,0,0,1,0,1,-x$_,x$s,-x$h,0,0,-1,1,0,x$_,x$s,-x$h,0,0,-1,0,0,x$_,-x$s,-x$h,0,0,-1,0,1,-x$_,-x$s,-x$h,0,0,-1,1,1]),x$n=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new x$K_(x$b,this._numberVertices,35044,!0),this._indexBuffer=new x$a_("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(x$x),this._indexBuffer.setData(x$n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},x$Q(0,x$_,"long",function(){return this._long},function(x$b){this._long!==x$b&&(this._long=x$b,this.releaseResource(),this.activeResource())}),x$Q(0,x$_,"width",function(){return this._width},function(x$b){this._width!==x$b&&(this._width=x$b,this.releaseResource(),this.activeResource())}),x$Q(0,x$_,"height",function(){return this._height},function(x$b){this._height!==x$b&&(this._height=x$b,this.releaseResource(),this.activeResource())})}(),function(x$b){function x$E(x$b,x$_,x$s){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=.3),void 0===x$s&&(x$s=1e3),this._viewMatrix=new x$b_,this._projectionMatrix=new x$b_,this._projectionViewMatrix=new x$b_,this._viewport=new x$O_(0,0,0,0),this._normalizedViewport=new x$O_(0,0,1,1),this._aspectRatio=x$b,this._boundFrustumUpdate=!0,this._boundFrustum=new x$eb(x$b_.DEFAULT),x$E.__super.call(this,x$_,x$s),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}x$V(x$E,"laya.d3.core.Camera",x$u_);var x$_=x$E.prototype;return x$_._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},x$_._parseCustomProps=function(x$b,x$_,x$s,x$h){var x$x=x$s.clearColor;this.clearColor=new x$C_(x$x[0],x$x[1],x$x[2],x$x[3]);var x$n=x$s.viewport;this.normalizedViewport=new x$O_(x$n[0],x$n[1],x$n[2],x$n[3])},x$_._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var x$b=this.orthographicVerticalSize*this.aspectRatio*.5,x$_=.5*this.orthographicVerticalSize;x$b_.createOrthoOffCenterRH(-x$b,x$b,-x$_,x$_,this.nearPlane,this.farPlane,this._projectionMatrix)}else x$b_.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},x$_._update=function(x$b){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,x$b)},x$_._renderCamera=function(x$b,x$_,x$s){var x$h,x$x;x$s.parallelSplitShadowMaps[0]&&x$s._renderShadowMap(x$b,x$_,this),(x$_.camera=this)._prepareCameraToRender(),x$s._preRenderUpdateComponents(x$_),x$h=x$_._viewMatrix=this.viewMatrix;var x$n=this._renderTarget;x$n?(x$n.start(),x$b_.multiply(x$u_._invertYScaleMatrix,this._projectionMatrix,x$u_._invertYProjectionMatrix),x$b_.multiply(x$u_._invertYScaleMatrix,this.projectionViewMatrix,x$u_._invertYProjectionViewMatrix),x$x=x$_._projectionMatrix=x$u_._invertYProjectionMatrix,x$_._projectionViewMatrix=x$u_._invertYProjectionViewMatrix):(x$x=x$_._projectionMatrix=this._projectionMatrix,x$_._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(x$h,x$x),x$_._viewport=this.viewport,x$s._preRenderScene(x$b,x$_,this.boundFrustum),x$s._clear(x$b,x$_),x$s._renderScene(x$b,x$_),x$s._postRenderUpdateComponents(x$_),x$n&&x$n.end()},x$_.viewportPointToRay=function(x$b,x$_){x$Q_.calculateCursorRay(x$b,this.viewport,this._projectionMatrix,this.viewMatrix,null,x$_)},x$_.normalizedViewportPointToRay=function(x$b,x$_){var x$s=x$E._tempVector20,x$h=this.viewport,x$x=x$b.elements,x$n=x$s.elements;x$n[0]=x$x[0]*x$h.width,x$n[1]=x$x[1]*x$h.height,x$Q_.calculateCursorRay(x$s,this.viewport,this._projectionMatrix,this.viewMatrix,null,x$_)},x$_.worldToViewportPoint=function(x$b,x$_){x$b_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(x$b,this._projectionViewMatrix,x$_);var x$s=x$_.elements;x$s[0]=x$s[0]/x$$.stage.clientScaleX,x$s[1]=x$s[1]/x$$.stage.clientScaleY},x$_.worldToNormalizedViewportPoint=function(x$b,x$_){x$b_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(x$b,this._projectionViewMatrix,x$_);var x$s=x$_.elements;x$s[0]=x$s[0]/x$$.stage.clientScaleX,x$s[1]=x$s[1]/x$$.stage.clientScaleY},x$_.convertScreenCoordToOrthographicCoord=function(x$b,x$_){if(this._orthographic){var x$s=x$Y.clientWidth,x$h=x$Y.clientHeight,x$x=this.orthographicVerticalSize*this.aspectRatio/x$s,x$n=this.orthographicVerticalSize/x$h,x$E=x$b.elements,x$C=x$_.elements;return x$C[0]=(-x$s/2+x$E[0])*x$x,x$C[1]=(x$h/2-x$E[1])*x$n,x$C[2]=(this.nearPlane-this.farPlane)*(x$E[2]+1)/2-this.nearPlane,x$E_.transformCoordinate(x$_,this.transform.worldMatrix,x$_),!0}return!1},x$Q(0,x$_,"projectionViewMatrix",function(){return x$b_.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),x$Q(0,x$_,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var x$b=this.viewport;return x$b.width/x$b.height},function(x$b){if(x$b<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$_,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),x$Q(0,x$_,"needViewport",function(){var x$b=this.normalizedViewport;return 0===x$b.x&&0===x$b.y&&1===x$b.width&&1===x$b.height}),x$Q(0,x$_,"viewport",function(){if(this._viewportExpressedInClipSpace){var x$b=this._normalizedViewport,x$_=this.renderTargetSize,x$s=x$_.width,x$h=x$_.height;this._viewport.x=x$b.x*x$s,this._viewport.y=x$b.y*x$h,this._viewport.width=x$b.width*x$s,this._viewport.height=x$b.height*x$h}return this._viewport},function(x$b){if(null!=this.renderTarget&&(x$b.x<0||x$b.y<0||0==x$b.width||0==x$b.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$_,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var x$b=this._viewport,x$_=this.renderTargetSize,x$s=x$_.width,x$h=x$_.height;this._normalizedViewport.x=x$b.x/x$s,this._normalizedViewport.y=x$b.y/x$h,this._normalizedViewport.width=x$b.width/x$s,this._normalizedViewport.height=x$b.height/x$h}return this._normalizedViewport},function(x$b){x$b.x<0&&(x$b.x=0,console.warn("Camera: viewport.x must large than 0.0.")),x$b.y<0&&(x$b.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<x$b.x+x$b.width&&(x$b.width=1-x$b.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<x$b.y+x$b.height&&(x$b.height=1-x$b.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=x$b,this._calculateProjectionMatrix()}),x$Q(0,x$_,"projectionMatrix",function(){return this._projectionMatrix},function(x$b){this._projectionMatrix=x$b,this._useUserProjectionMatrix=!0}),x$Q(0,x$_,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),x$p(x$E,["_tempVector20",function(){return this._tempVector20=new x$n_}]),x$E}()),x$X_=function(x$s){function x$h(x$b,x$_){x$h.__super.call(this,x$_),this._geometryFilter=new x$W_(this),this._render=new x$T_(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),x$b&&(this._geometryFilter.sharedMesh=x$b)instanceof laya.d3.resource.models.Mesh&&(x$b.loaded?this._render.sharedMaterials=x$b.materials:x$b.once("loaded",this,this._applyMeshMaterials))}x$V(x$h,"laya.d3.core.MeshSprite3D",x$s);var x$b=x$h.prototype;return x$b._changeRenderObjectByMesh=function(x$b){var x$_=this._render._renderElements,x$s=x$_[x$b];x$s||(x$s=x$_[x$b]=new x$o_),x$s._render=this._render;var x$h=this._render.sharedMaterials[x$b];x$h||(x$h=x$z_.defaultMaterial);var x$x=this._geometryFilter.sharedMesh.getRenderElement(x$b);return x$s._mainSortID=this._getSortID(x$x,x$h),x$s._sprite3D=this,x$s.renderObj=x$x,x$s._material=x$h,x$s},x$b._changeRenderObjectByMaterial=function(x$b,x$_){var x$s=this._render._renderElements[x$b];x$_||(x$_=x$z_.defaultMaterial);var x$h=this._geometryFilter.sharedMesh.getRenderElement(x$b);return x$s._mainSortID=this._getSortID(x$h,x$_),x$s._sprite3D=this,x$s.renderObj=x$h,x$s._material=x$_,x$s},x$b._changeRenderObjectsByMesh=function(){var x$b=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=x$b;for(var x$_=0;x$_<x$b;x$_++)this._changeRenderObjectByMesh(x$_)},x$b._onMeshChanged=function(x$b){var x$_=x$b.sharedMesh;x$_.loaded?this._changeRenderObjectsByMesh():x$_.once("loaded",this,this._onMeshLoaded)},x$b._onMeshLoaded=function(x$b){x$b===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},x$b._onMaterialChanged=function(x$b,x$_,x$s){x$_<this._render._renderElements.length&&this._changeRenderObjectByMaterial(x$_,x$s)},x$b._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},x$b._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},x$b._parseCustomProps=function(x$b,x$_,x$s,x$h){var x$x=this.meshRender,x$n=x$s.lightmapIndex;null!=x$n&&(x$x.lightmapIndex=x$n);var x$E,x$C,x$O=x$s.lightmapScaleOffset;if(x$O&&(x$x.lightmapScaleOffset=new x$C_(x$O[0],x$O[1],x$O[2],x$O[3])),x$h.instanceParams)(x$E=x$h.instanceParams.loadPath)&&(x$C=x$i.getRes(x$_[x$E]),(this.meshFilter.sharedMesh=x$C).loaded?x$x.sharedMaterials=x$C.materials:x$C.once("loaded",this,this._applyMeshMaterials));else{(x$E=x$s.meshPath)&&(x$C=x$i.getRes(x$_[x$E]),this.meshFilter.sharedMesh=x$C);var x$L=x$s.materials;if(x$L){var x$f=x$x.sharedMaterials,x$p=x$L.length;x$f.length=x$p;for(var x$P=0;x$P<x$p;x$P++)x$f[x$P]=x$i.getRes(x$_[x$L[x$P].path]);x$x.sharedMaterials=x$f}}},x$b._applyMeshMaterials=function(x$b){for(var x$_=this._render.sharedMaterials,x$s=x$b.materials,x$h=0,x$x=x$s.length;x$h<x$x;x$h++)x$_[x$h]||(x$_[x$h]=x$s[x$h]);this._render.sharedMaterials=x$_},x$b._addToInitStaticBatchManager=function(){x$h._staticBatchManager._addInitBatchSprite(this)},x$b.cloneTo=function(x$b){var x$_=x$b;x$_._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var x$s=this._render,x$h=x$_._render;x$h.enable=x$s.enable,x$h.sharedMaterials=x$s.sharedMaterials,x$h.castShadow=x$s.castShadow;var x$x=x$s.lightmapScaleOffset;x$x&&(x$h.lightmapScaleOffset=x$x.clone()),x$h.lightmapIndex=x$s.lightmapIndex,x$h.receiveShadow=x$s.receiveShadow,x$h.sortingFudge=x$s.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,x$b)},x$b.destroy=function(x$b){if(void 0===x$b&&(x$b=!0),!this.destroyed){var x$_=this.meshFilter.sharedMesh;null!=x$_&&(x$_.loaded||x$_.off("loaded",this,this._applyMeshMaterials)),x$s.prototype.destroy.call(this,x$b),this._geometryFilter._destroy()}},x$Q(0,x$b,"meshFilter",function(){return this._geometryFilter}),x$Q(0,x$b,"meshRender",function(){return this._render}),x$h.__init__=function(){x$hb._staticBatchManagers.push(x$h._staticBatchManager)},x$h.load=function(x$b){return x$$.loader.create(x$b,null,null,x$h)},x$p(x$h,["_staticBatchManager",function(){return this._staticBatchManager=new x$r_}]),x$h}(x$l_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}}),function(x$b,x$_,x$xb){x$xb.un,x$xb.uns;var x$s=x$xb.static,x$h=x$xb.class,x$n=x$xb.getset,x$y=x$xb.__newvec,x$C=laya.maths.Bezier,x$p=laya.utils.Browser,x$Zb=laya.utils.Byte,x$x=(laya.events.Event,laya.events.EventDispatcher),x$E=laya.display.Graphics,x$O=(laya.resource.HTMLCanvas,laya.utils.Handler),x$L=laya.net.Loader,x$P=laya.maths.MathUtil,x$Jb=laya.maths.Matrix,x$w=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),x$f=(laya.renders.RenderContext,laya.resource.Resource),x$V=laya.utils.RunDriver,x$nb=laya.display.Sprite,x$Q=laya.utils.Stat,x$Wb=laya.resource.Texture,x$i=(laya.net.URL,laya.utils.Utils),x$J=function(){function x$b(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return x$h(x$b,"laya.ani.AnimationContent"),x$b}(),x$W=function(){function x$b(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return x$h(x$b,"laya.ani.AnimationNodeContent"),x$b}(),x$t=function(){function x$b(){}return x$h(x$b,"laya.ani.AnimationParser01"),x$b.parse=function(x$b,x$_){var x$s=x$_.__getBuffer(),x$h=0,x$x=0,x$n=0,x$E=0,x$C=0,x$O=0,x$L=0,x$f=x$_.readUTFString();x$b._aniClassName=x$f;var x$p,x$P=x$_.readUTFString().split("\n"),x$V=x$_.getUint8(),x$Q=x$_.getUint32(),x$y=x$_.getUint32();0<x$Q&&(x$p=x$s.slice(x$Q,x$y));var x$w=new x$Zb(x$p);for(0<x$y&&(x$b._publicExtData=x$s.slice(x$y,x$s.byteLength)),x$b._useParent=!!x$_.getUint8(),x$b._anis.length=x$V,x$h=0;x$h<x$V;x$h++){var x$i=x$b._anis[x$h]=new x$J;x$i.nodes=new Array;var x$R=x$i.name=x$P[x$_.getUint16()];x$b._aniMap[x$R]=x$h,x$i.bone3DMap={},x$i.playTime=x$_.getFloat32(),x$i.playTime<=0&&console.error("播放时间不能为0  url="+x$b.url+" name="+x$i.name);var x$t=x$i.nodes.length=x$_.getUint8();for(x$x=x$i.totalKeyframeDatasLength=0;x$x<x$t;x$x++){var x$c=x$i.nodes[x$x]=new x$W;x$c.childs=[];var x$$=x$_.getInt16();0<=x$$&&(x$c.name=x$P[x$$],x$i.bone3DMap[x$c.name]=x$x),x$c.keyFrame=new Array,x$c.parentIndex=x$_.getInt16(),-1==x$c.parentIndex?x$c.parent=null:x$c.parent=x$i.nodes[x$c.parentIndex],x$c.lerpType=x$_.getUint8();var x$D=x$_.getUint32();x$w.pos=x$D;var x$o=x$c.keyframeWidth=x$w.getUint16();if(x$i.totalKeyframeDatasLength+=x$o,0===x$c.lerpType||1===x$c.lerpType)for(x$c.interpolationMethod=[],x$c.interpolationMethod.length=x$o,x$n=0;x$n<x$o;x$n++)x$c.interpolationMethod[x$n]=x$U.interpolation[x$w.getUint8()];null!=x$c.parent&&x$c.parent.childs.push(x$c);var x$M=x$_.getUint16();0<x$M&&(x$c.extenData=x$s.slice(x$_.pos,x$_.pos+x$M),x$_.pos+=x$M);var x$r,x$k=x$_.getUint16(),x$B=0;for(x$n=0,x$E=x$c.keyFrame.length=x$k;x$n<x$E;x$n++){if((x$r=x$c.keyFrame[x$n]=new x$T).duration=x$_.getFloat32(),x$r.startTime=x$B,2===x$c.lerpType){x$r.interpolationData=[];var x$S,x$Z=x$_.getUint8();switch(x$S=x$_.getFloat32()){case 254:for(x$r.interpolationData.length=x$o,x$L=0;x$L<x$o;x$L++)x$r.interpolationData[x$L]=0;break;case 255:for(x$r.interpolationData.length=x$o,x$L=0;x$L<x$o;x$L++)x$r.interpolationData[x$L]=5;break;default:for(x$r.interpolationData.push(x$S),x$O=1;x$O<x$Z;x$O++)x$r.interpolationData.push(x$_.getFloat32())}}for(x$r.data=new Float32Array(x$o),x$C=0;x$C<x$o;x$C++)x$r.data[x$C]=x$_.getFloat32(),-1e-8<x$r.data[x$C]&&x$r.data[x$C]<1e-8&&(x$r.data[x$C]=0);x$B+=x$r.duration}x$r.startTime=x$i.playTime,x$c.playTime=x$i.playTime,x$b._calculateKeyFrame(x$c,x$k,x$o)}}},x$b}(),x$c=function(){function x$$(){}return x$h(x$$,"laya.ani.AnimationParser02"),x$$.READ_DATA=function(){x$$._DATA.offset=x$$._reader.getUint32(),x$$._DATA.size=x$$._reader.getUint32()},x$$.READ_BLOCK=function(){for(var x$b=x$$._BLOCK.count=x$$._reader.getUint16(),x$_=x$$._BLOCK.blockStarts=[],x$s=x$$._BLOCK.blockLengths=[],x$h=0;x$h<x$b;x$h++)x$_.push(x$$._reader.getUint32()),x$s.push(x$$._reader.getUint32())},x$$.READ_STRINGS=function(){var x$b=x$$._reader.getUint32(),x$_=x$$._reader.getUint16(),x$s=x$$._reader.pos;x$$._reader.pos=x$b+x$$._DATA.offset;for(var x$h=0;x$h<x$_;x$h++)x$$._strings[x$h]=x$$._reader.readUTFString();x$$._reader.pos=x$s},x$$.parse=function(x$b,x$_){x$$._templet=x$b;(x$$._reader=x$_).__getBuffer();x$$.READ_DATA(),x$$.READ_BLOCK(),x$$.READ_STRINGS();for(var x$s=0,x$h=x$$._BLOCK.count;x$s<x$h;x$s++){var x$x=x$_.getUint16(),x$n=x$$._strings[x$x],x$E=x$$["READ_"+x$n];if(null==x$E)throw new Error("model file err,no this function:"+x$x+" "+x$n);x$E.call()}},x$$.READ_ANIMATIONS=function(){var x$b=x$$._reader,x$_=x$b.__getBuffer(),x$s=0,x$h=0,x$x=0,x$n=0,x$E=x$b.getUint16(),x$C=[];for(x$C.length=x$E,x$s=0;x$s<x$E;x$s++)x$C[x$s]=x$U.interpolation[x$b.getByte()];var x$O=x$b.getUint8();for(x$$._templet._anis.length=x$O,x$s=0;x$s<x$O;x$s++){var x$L=x$$._templet._anis[x$s]={};x$L.nodes=new Array;var x$f=x$L.name=x$$._strings[x$b.getUint16()];x$$._templet._aniMap[x$f]=x$s,x$L.bone3DMap={},x$L.playTime=x$b.getFloat32();var x$p=x$L.nodes.length=x$b.getInt16();for(x$h=x$L.totalKeyframeDatasLength=0;x$h<x$p;x$h++){var x$P=x$L.nodes[x$h]={};x$P.keyframeWidth=x$E,x$P.childs=[];var x$V=x$b.getUint16();0<=x$V&&(x$P.name=x$$._strings[x$V],x$L.bone3DMap[x$P.name]=x$h),x$P.keyFrame=new Array,x$P.parentIndex=x$b.getInt16(),-1==x$P.parentIndex?x$P.parent=null:x$P.parent=x$L.nodes[x$P.parentIndex],x$L.totalKeyframeDatasLength+=x$E,x$P.interpolationMethod=x$C,null!=x$P.parent&&x$P.parent.childs.push(x$P);var x$Q=x$b.getUint16(),x$y=null,x$w=null;for(x$x=0,x$n=x$P.keyFrame.length=x$Q;x$x<x$n;x$x++){(x$y=x$P.keyFrame[x$x]={}).startTime=x$b.getFloat32(),x$w&&(x$w.duration=x$y.startTime-x$w.startTime);var x$i=x$$._DATA.offset,x$R=x$b.getUint32(),x$t=4*x$E,x$c=x$_.slice(x$i+x$R,x$i+x$R+x$t);x$y.data=new Float32Array(x$c),x$w=x$y}x$y.duration=0,x$P.playTime=x$L.playTime,x$$._templet._calculateKeyFrame(x$P,x$Q,x$E)}}},x$$._templet=null,x$$._reader=null,x$$._strings=[],x$s(x$$,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),x$$}(),x$Tb=(function(){function x$b(){}x$h(x$b,"laya.ani.AnimationState"),x$b.stopped=0,x$b.paused=1,x$b.playing=2}(),function(){function x$x(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new x$lb,this.resultMatrix=new x$Jb,this._children=[]}x$h(x$x,"laya.ani.bone.Bone");var x$b=x$x.prototype;return x$b.setTempMatrix=function(x$b){this._tempMatrix=x$b;var x$_,x$s=0;for(x$s=0,x$_=this._children.length;x$s<x$_;x$s++)this._children[x$s].setTempMatrix(this._tempMatrix)},x$b.update=function(x$b){var x$_;if(this.rotation=this.transform.skX,x$b)x$_=this.resultTransform.getMatrix(),x$Jb.mul(x$_,x$b,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)x$_=this.resultTransform.getMatrix(),x$Jb.mul(x$_,this.parentBone.resultMatrix,this.resultMatrix);else{var x$s=this.parentBone,x$h=NaN,x$x=NaN,x$n=NaN,x$E=this.parentBone.resultMatrix;x$_=this.resultTransform.getMatrix();var x$C=x$E.a*x$_.tx+x$E.c*x$_.ty+x$E.tx,x$O=x$E.b*x$_.tx+x$E.d*x$_.ty+x$E.ty,x$L=new x$Jb;this.inheritRotation?(x$h=Math.atan2(x$s.resultMatrix.b,x$s.resultMatrix.a),x$x=Math.cos(x$h),x$n=Math.sin(x$h),x$L.setTo(x$x,x$n,-x$n,x$x,0,0),x$Jb.mul(this._tempMatrix,x$L,x$Jb.TEMP),x$Jb.TEMP.copyTo(x$L),x$_=this.resultTransform.getMatrix(),x$Jb.mul(x$_,x$L,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,x$_=this.resultTransform.getMatrix(),x$Jb.TEMP.identity(),x$Jb.TEMP.d=this.d,x$Jb.mul(x$_,x$Jb.TEMP,this.resultMatrix)),this.resultMatrix.tx=x$C,this.resultMatrix.ty=x$O}else(x$_=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var x$f,x$p=0;for(x$p=0,x$f=this._children.length;x$p<x$f;x$p++)this._children[x$p].update()},x$b.updateChild=function(){var x$b,x$_=0;for(x$_=0,x$b=this._children.length;x$_<x$b;x$_++)this._children[x$_].update()},x$b.setRotation=function(x$b){this._sprite&&(this._sprite.rotation=180*x$b/Math.PI)},x$b.updateDraw=function(x$b,x$_){x$x.ShowBones&&!x$x.ShowBones[this.name]||(this._sprite||(this._sprite=new x$nb,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),x$xb.stage.addChild(this._sprite)),this._sprite.x=x$b+this.resultMatrix.tx,this._sprite.y=x$_+this.resultMatrix.ty);var x$s,x$h=0;for(x$h=0,x$s=this._children.length;x$h<x$s;x$h++)this._children[x$h].updateDraw(x$b,x$_)},x$b.addChild=function(x$b){this._children.push(x$b),x$b.parentBone=this},x$b.findBone=function(x$b){if(this.name==x$b)return this;var x$_,x$s,x$h=0;for(x$h=0,x$_=this._children.length;x$h<x$_;x$h++)if(x$s=this._children[x$h].findBone(x$b))return x$s;return null},x$b.localToWorld=function(x$b){var x$_=x$b[0],x$s=x$b[1];x$b[0]=x$_*this.resultMatrix.a+x$s*this.resultMatrix.c+this.resultMatrix.tx,x$b[1]=x$_*this.resultMatrix.b+x$s*this.resultMatrix.d+this.resultMatrix.ty},x$x.ShowBones={},x$x}()),x$qb=function(){function x$y(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}x$h(x$y,"laya.ani.bone.BoneSlot");var x$b=x$y.prototype;return x$b.showSlotData=function(x$b,x$_){void 0===x$_&&(x$_=!0),this.currSlotData=x$b,x$_&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},x$b.showDisplayByName=function(x$b){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(x$b))},x$b.replaceDisplayByName=function(x$b,x$_){if(this.currSlotData){var x$s;x$s=this.currSlotData.getDisplayByName(x$b);var x$h;x$h=this.currSlotData.getDisplayByName(x$_),this.replaceDisplayByIndex(x$s,x$h)}},x$b.replaceDisplayByIndex=function(x$b,x$_){this.currSlotData&&(this._replaceDic[x$b]=x$_,this.displayIndex==x$b&&this.showDisplayByIndex(x$b))},x$b.showDisplayByIndex=function(x$b){if(null!=this._replaceDic[x$b]&&(x$b=this._replaceDic[x$b]),this.currSlotData&&-1<x$b&&x$b<this.currSlotData.displayArr.length){if(this.displayIndex=x$b,this.currDisplayData=this.currSlotData.displayArr[x$b],this.currDisplayData){var x$_=this.currDisplayData.name;this.currTexture=this.templet.getTexture(x$_),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!x$w.isConchApp||x$w.isConchApp&&"0.9.15"<x$nb.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},x$b.replaceSkin=function(x$b){this._diyTexture=x$b,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},x$b.setParentMatrix=function(x$b){this._parentMatrix=x$b},x$b.draw=function(x$b,x$_,x$s,x$h){if(void 0===x$s&&(x$s=!1),void 0===x$h&&(x$h=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var x$x,x$n=this.currTexture;switch(this._diyTexture&&(x$n=this._diyTexture),this.currDisplayData.type){case 0:if(x$b){var x$E=this.getDisplayMatrix();if(this._parentMatrix){var x$C=!1;if(x$E){var x$O;if(x$Jb.mul(x$E,this._parentMatrix,x$Jb.TEMP),x$O=x$s?(null==this._resultMatrix&&(this._resultMatrix=new x$Jb),this._resultMatrix):new x$Jb,!x$w.isWebGL&&this.currDisplayData.uvs||x$w.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var x$L=x$y._tempMatrix;x$L.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(x$L.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(x$C=!0,x$L.rotate(-Math.PI/2)),x$Jb.mul(x$L,x$Jb.TEMP,x$O)}else x$Jb.TEMP.copyTo(x$O);x$C?x$b.drawTexture(x$n,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,x$O):x$b.drawTexture(x$n,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,x$O)}}}break;case 1:if(null==(x$x=x$s?(null==this._skinSprite&&(this._skinSprite=x$y.createSkinMesh()),this._skinSprite):x$y.createSkinMesh()))return;var x$f;if(null==this.currDisplayData.bones){var x$p,x$P=this.currDisplayData.weights;this.deformData&&(x$P=this.deformData),x$p=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=x$o.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=x$o.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=x$P;this.currDisplayData.triangles.length;x$f=this.currDisplayData.triangles,x$x.init2(x$n,null,x$f,this._mVerticleArr,x$p);var x$V,x$Q=this.getDisplayMatrix();if(this._parentMatrix)if(x$Q)x$Jb.mul(x$Q,this._parentMatrix,x$Jb.TEMP),x$V=x$s?(null==this._resultMatrix&&(this._resultMatrix=new x$Jb),this._resultMatrix):new x$Jb,x$Jb.TEMP.copyTo(x$V),x$x.transform=x$V}else this.skinMesh(x$_,x$x,x$h);x$b.drawSkin(x$x);break;case 2:if(null==(x$x=x$s?(null==this._skinSprite&&(this._skinSprite=x$y.createSkinMesh()),this._skinSprite):x$y.createSkinMesh()))return;this.skinMesh(x$_,x$x,x$h),x$b.drawSkin(x$x)}}},x$b.skinMesh=function(x$b,x$_,x$s){var x$h,x$x=this.currTexture,x$n=this.currDisplayData.bones;x$h=this._diyTexture?(x$x=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=x$o.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=x$o.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var x$E,x$C,x$O=this.currDisplayData.weights,x$L=this.currDisplayData.triangles,x$f=0,x$p=0,x$P=0,x$V=NaN,x$Q=NaN,x$y=0,x$w=0,x$i=[],x$R=0,x$t=0;if(this.deformData&&0<this.deformData.length){var x$c=0;for(x$R=0,x$t=x$n.length;x$R<x$t;){for(x$P=x$n[x$R++]+x$R,x$p=x$f=0;x$R<x$P;x$R++)x$C=x$b[x$n[x$R]],x$V=x$O[x$y]+this.deformData[x$c++],x$Q=x$O[x$y+1]+this.deformData[x$c++],x$w=x$O[x$y+2],x$f+=(x$V*x$C.a+x$Q*x$C.c+x$C.tx)*x$w,x$p+=(x$V*x$C.b+x$Q*x$C.d+x$C.ty)*x$w,x$y+=3;x$i.push(x$f,x$p)}}else for(x$R=0,x$t=x$n.length;x$R<x$t;){for(x$P=x$n[x$R++]+x$R,x$p=x$f=0;x$R<x$P;x$R++)x$C=x$b[x$n[x$R]],x$V=x$O[x$y],x$Q=x$O[x$y+1],x$w=x$O[x$y+2],x$f+=(x$V*x$C.a+x$Q*x$C.c+x$C.tx)*x$w,x$p+=(x$V*x$C.b+x$Q*x$C.d+x$C.ty)*x$w,x$y+=3;x$i.push(x$f,x$p)}this._mVerticleArr=x$i,x$E=x$L,x$_.init2(x$x,null,x$E,this._mVerticleArr,x$h)},x$b.drawBonePoint=function(x$b){x$b&&this._parentMatrix&&x$b.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},x$b.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},x$b.getMatrix=function(){return this._resultMatrix},x$b.copy=function(){var x$b=new x$y;return x$b.type="copy",x$b.name=this.name,x$b.attachmentName=this.attachmentName,x$b.srcDisplayIndex=this.srcDisplayIndex,x$b.parent=this.parent,x$b.displayIndex=this.displayIndex,x$b.templet=this.templet,x$b.currSlotData=this.currSlotData,x$b.currTexture=this.currTexture,x$b.currDisplayData=this.currDisplayData,x$b},x$y.createSkinMesh=function(){return x$w.isWebGL||x$w.isConchApp?x$V.skinAniSprite():(x$w.isWebGL,null)},x$s(x$y,["_tempMatrix",function(){return this._tempMatrix=new x$Jb}]),x$y}(),x$Ub=function(){function x$b(){this.skinName=null,this.deformSlotDataList=[]}return x$h(x$b,"laya.ani.bone.DeformAniData"),x$b}(),x$Gb=function(){function x$b(){this.deformSlotDisplayList=[]}return x$h(x$b,"laya.ani.bone.DeformSlotData"),x$b}(),x$zb=function(){function x$b(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}x$h(x$b,"laya.ani.bone.DeformSlotDisplayData");var x$_=x$b.prototype;return x$_.binarySearch1=function(x$b,x$_){var x$s=0,x$h=x$b.length-2;if(0==x$h)return 1;for(var x$x=x$h>>>1;;){if(x$b[Math.floor(x$x+1)]<=x$_?x$s=x$x+1:x$h=x$x,x$s==x$h)return x$s+1;x$x=x$s+x$h>>>1}return 0},x$_.apply=function(x$b,x$_,x$s){if(void 0===x$s&&(x$s=1),x$b+=.05,!(this.timeList.length<=0)){var x$h=0;if(!(x$b<this.timeList[0])){var x$x=this.vectices[0].length,x$n=[],x$E=this.binarySearch1(this.timeList,x$b);if(this.frameIndex=x$E,x$b>=this.timeList[this.timeList.length-1]){var x$C=this.vectices[this.vectices.length-1];if(x$s<1)for(x$h=0;x$h<x$x;x$h++)x$n[x$h]+=(x$C[x$h]-x$n[x$h])*x$s;else for(x$h=0;x$h<x$x;x$h++)x$n[x$h]=x$C[x$h];this.deformData=x$n}else{this.tweenKeyList[this.frameIndex];var x$O=this.vectices[this.frameIndex-1],x$L=this.vectices[this.frameIndex],x$f=this.timeList[this.frameIndex-1],x$p=this.timeList[this.frameIndex];x$s=this.tweenKeyList[x$E-1]?(x$b-x$f)/(x$p-x$f):0;var x$P=NaN;for(x$h=0;x$h<x$x;x$h++)x$P=x$O[x$h],x$n[x$h]=x$P+(x$L[x$h]-x$P)*x$s;this.deformData=x$n}}}},x$b}(),x$ab=function(){function x$b(){this.time=NaN,this.drawOrder=[]}return x$h(x$b,"laya.ani.bone.DrawOrderData"),x$b}(),x$Kb=function(){function x$b(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return x$h(x$b,"laya.ani.bone.EventData"),x$b}(),x$R=function(){function x$hb(x$b,x$_){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=x$b,this._targetBone=x$_[x$b.targetBoneIndex],this.isSpine=x$b.isSpine,null==this._bones&&(this._bones=[]);for(var x$s=this._bones.length=0,x$h=x$b.boneIndexs.length;x$s<x$h;x$s++)this._bones.push(x$_[x$b.boneIndexs[x$s]]);this.name=x$b.name,this.mix=x$b.mix,this.bendDirection=x$b.bendDirection}x$h(x$hb,"laya.ani.bone.IkConstraint");var x$b=x$hb.prototype;return x$b.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},x$b._applyIk1=function(x$b,x$_,x$s,x$h){var x$x=x$b.parentBone,x$n=1/(x$x.resultMatrix.a*x$x.resultMatrix.d-x$x.resultMatrix.b*x$x.resultMatrix.c),x$E=x$_-x$x.resultMatrix.tx,x$C=x$s-x$x.resultMatrix.ty,x$O=(x$E*x$x.resultMatrix.d-x$C*x$x.resultMatrix.c)*x$n-x$b.transform.x,x$L=(x$C*x$x.resultMatrix.a-x$E*x$x.resultMatrix.b)*x$n-x$b.transform.y,x$f=Math.atan2(x$L,x$O)*x$hb.radDeg-0-x$b.transform.skX;x$b.transform.scX<0&&(x$f+=180),180<x$f?x$f-=360:x$f<-180&&(x$f+=360),x$b.transform.skX=x$b.transform.skY=x$b.transform.skX+x$f*x$h,x$b.update()},x$b.updatePos=function(x$b,x$_){this._sp&&this._sp.pos(x$b,x$_)},x$b._applyIk2=function(x$b,x$_,x$s,x$h,x$x,x$n){if(0!=x$n){var x$E=x$b.resultTransform.x,x$C=x$b.resultTransform.y,x$O=x$b.transform.scX,x$L=x$b.transform.scY,x$f=x$_.transform.scX,x$p=0,x$P=0,x$V=0;x$V=x$O<0?(x$O=-x$O,x$p=180,-1):(x$p=0,1),x$L<0&&(x$L=-x$L,x$V=-x$V),x$P=x$f<0?(x$f=-x$f,180):0;var x$Q=x$_.resultTransform.x,x$y=NaN,x$w=NaN,x$i=NaN,x$R=x$b.resultMatrix.a,x$t=x$b.resultMatrix.c,x$c=x$b.resultMatrix.b,x$$=x$b.resultMatrix.d,x$D=Math.abs(x$O-x$L)<=1e-4;x$i=x$D?(x$w=x$R*x$Q+x$t*(x$y=x$_.resultTransform.y)+x$b.resultMatrix.tx,x$c*x$Q+x$$*x$y+x$b.resultMatrix.ty):(x$y=0,x$w=x$R*x$Q+x$b.resultMatrix.tx,x$c*x$Q+x$b.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new x$nb,x$xb.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(x$s,x$h,15,"#ffff00"),this._sp.graphics.drawCircle(x$w,x$i,15,"#ff00ff")),x$b.setRotation(Math.atan2(x$i-x$b.resultMatrix.ty,x$w-x$b.resultMatrix.tx));var x$o=x$b.parentBone;x$R=x$o.resultMatrix.a,x$t=x$o.resultMatrix.c,x$c=x$o.resultMatrix.b;var x$M=1/(x$R*(x$$=x$o.resultMatrix.d)-x$t*x$c),x$r=x$s-x$o.resultMatrix.tx,x$k=x$h-x$o.resultMatrix.ty,x$B=(x$r*x$$-x$k*x$t)*x$M-x$E,x$S=(x$k*x$R-x$r*x$c)*x$M-x$C,x$Z=((x$r=x$w-x$o.resultMatrix.tx)*x$$-(x$k=x$i-x$o.resultMatrix.ty)*x$t)*x$M-x$E,x$J=(x$k*x$R-x$r*x$c)*x$M-x$C,x$W=Math.sqrt(x$Z*x$Z+x$J*x$J),x$T=x$_.length*x$f,x$q=NaN,x$U=NaN;if(x$D){var x$G=(x$B*x$B+x$S*x$S-x$W*x$W-(x$T*=x$O)*x$T)/(2*x$W*x$T);x$G<-1?x$G=-1:1<x$G&&(x$G=1),x$U=Math.acos(x$G)*x$x,x$R=x$W+x$T*x$G,x$t=x$T*Math.sin(x$U),x$q=Math.atan2(x$S*x$R-x$B*x$t,x$B*x$R+x$S*x$t)}else{var x$z=(x$R=x$O*x$T)*x$R,x$a=(x$t=x$L*x$T)*x$t,x$K=x$B*x$B+x$S*x$S,x$d=Math.atan2(x$S,x$B),x$I=-2*x$a*x$W,x$g=x$a-x$z;if(0<(x$$=x$I*x$I-4*x$g*(x$c=x$a*x$W*x$W+x$z*x$K-x$z*x$a))){var x$F=Math.sqrt(x$$);x$I<0&&(x$F=-x$F);var x$A=(x$F=-(x$I+x$F)/2)/x$g,x$u=x$c/x$F,x$l=Math.abs(x$A)<Math.abs(x$u)?x$A:x$u;x$l*x$l<=x$K&&(x$k=Math.sqrt(x$K-x$l*x$l)*x$x,x$q=x$d-Math.atan2(x$k,x$l),x$U=Math.atan2(x$k/x$L,(x$l-x$W)/x$O))}var x$N=0,x$X=Number.MAX_VALUE,x$Y=0,x$m=0,x$e=0,x$v=0,x$H=0,x$j=0;x$v<(x$$=(x$r=x$W+x$R)*x$r)&&(x$e=0,x$v=x$$,x$H=x$r),(x$$=(x$r=x$W-x$R)*x$r)<x$X&&(x$N=Math.PI,x$X=x$$,x$Y=x$r);var x$bb=Math.acos(-x$R*x$W/(x$z-x$a));(x$$=(x$r=x$R*Math.cos(x$bb)+x$W)*x$r+(x$k=x$t*Math.sin(x$bb))*x$k)<x$X&&(x$N=x$bb,x$X=x$$,x$Y=x$r,x$m=x$k),x$v<x$$&&(x$e=x$bb,x$v=x$$,x$H=x$r,x$j=x$k),x$U=x$K<=(x$X+x$v)/2?(x$q=x$d-Math.atan2(x$m*x$x,x$Y),x$N*x$x):(x$q=x$d-Math.atan2(x$j*x$x,x$H),x$e*x$x)}var x$_b=Math.atan2(x$y,x$Q)*x$V,x$sb=x$b.resultTransform.skX;180<(x$q=(x$q-x$_b)*x$hb.radDeg+x$p-x$sb)?x$q-=360:x$q<-180&&(x$q+=360),x$b.resultTransform.x=x$E,x$b.resultTransform.y=x$C,x$b.resultTransform.skX=x$b.resultTransform.skY=x$sb+x$q*x$n,x$sb=x$_.resultTransform.skX,180<(x$U=((x$U+x$_b)*x$hb.radDeg-0)*x$V+x$P-(x$sb%=360))?x$U-=360:x$U<-180&&(x$U+=360),x$_.resultTransform.x=x$Q,x$_.resultTransform.y=x$y,x$_.resultTransform.skX=x$_.resultTransform.skY=x$_.resultTransform.skY+x$U*x$n,x$b.update()}},x$b._applyIk3=function(x$b,x$_,x$s,x$h,x$x,x$n){if(0!=x$n){var x$E,x$C,x$O=x$_.resultMatrix.a*x$_.length,x$L=x$_.resultMatrix.b*x$_.length,x$f=x$O*x$O+x$L*x$L,x$p=Math.sqrt(x$f),x$P=x$b.resultMatrix.tx,x$V=x$b.resultMatrix.ty,x$Q=x$_.resultMatrix.tx,x$y=x$_.resultMatrix.ty,x$w=x$Q-x$P,x$i=x$y-x$V,x$R=x$w*x$w+x$i*x$i,x$t=Math.sqrt(x$R),x$c=(x$w=x$s-x$b.resultMatrix.tx)*x$w+(x$i=x$h-x$b.resultMatrix.ty)*x$i,x$$=Math.sqrt(x$c);if(x$p+x$t<=x$$||x$$+x$p<=x$t||x$$+x$t<=x$p){var x$D=NaN;x$Q=x$P+(x$D=x$p+x$t<=x$$?1:-1)*(x$s-x$P)*x$t/x$$,x$y=x$V+x$D*(x$h-x$V)*x$t/x$$}else{var x$o=(x$R-x$f+x$c)/(2*x$c),x$M=Math.sqrt(x$R-x$o*x$o*x$c)/x$$,x$r=x$P+x$w*x$o,x$k=x$V+x$i*x$o,x$B=-x$i*x$M,x$S=x$w*x$M;x$y=0<x$x?(x$Q=x$r-x$B,x$k-x$S):(x$Q=x$r+x$B,x$k+x$S)}x$E=x$Q,x$C=x$y,this.isDebug&&(this._sp||(this._sp=new x$nb,x$xb.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(x$P,x$V,15,"#ff00ff"),this._sp.graphics.drawCircle(x$s,x$h,15,"#ffff00"),this._sp.graphics.drawCircle(x$E,x$C,15,"#ff00ff"));var x$Z,x$J;x$Z=Math.atan2(x$C-x$b.resultMatrix.ty,x$E-x$b.resultMatrix.tx),x$b.setRotation(x$Z),(x$J=x$hb._tempMatrix).identity(),x$J.rotate(x$Z),x$J.scale(x$b.resultMatrix.getScaleX(),x$b.resultMatrix.getScaleY()),x$J.translate(x$b.resultMatrix.tx,x$b.resultMatrix.ty),x$J.copyTo(x$b.resultMatrix),x$b.updateChild();var x$W,x$T;x$W=Math.atan2(x$h-x$C,x$s-x$E),x$_.setRotation(x$W),(x$T=x$hb._tempMatrix).identity(),x$T.rotate(x$W),x$T.scale(x$_.resultMatrix.getScaleX(),x$_.resultMatrix.getScaleY()),x$T.translate(x$E,x$C),x$J.copyTo(x$_.resultMatrix),x$_.updateChild()}},x$s(x$hb,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new x$Jb}]),x$hb}(),x$db=function(){function x$b(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return x$h(x$b,"laya.ani.bone.IkConstraintData"),x$b}(),x$$=function(){function x$T(x$b,x$_){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=x$b,this.position=x$b.position,this.spacing=x$b.spacing,this.rotateMix=x$b.rotateMix,this.translateMix=x$b.translateMix,this.bones=[];for(var x$s=this.data.bones,x$h=0,x$x=x$s.length;x$h<x$x;x$h++)this.bones.push(x$_[x$s[x$h]])}x$h(x$T,"laya.ani.bone.PathConstraint");var x$b=x$T.prototype;return x$b.apply=function(x$b,x$_){if(this.target){var x$s=this.translateMix,x$h=this.translateMix,x$x=0<x$h,x$n=this.data.spacingMode,x$E="length"==x$n,x$C=this.data.rotateMode,x$O="tangent"==x$C,x$L="chainScale"==x$C,x$f=[],x$p=this.bones.length,x$P=x$O?x$p:x$p+1,x$V=[];(this._spaces=x$V)[0]=this.position;var x$Q=this.spacing;if(x$L||x$E)for(var x$y=0,x$w=x$P-1;x$y<x$w;){var x$i=this.bones[x$y],x$R=x$i.length,x$t=x$R*x$i.resultMatrix.a,x$c=x$R*x$i.resultMatrix.b;x$R=Math.sqrt(x$t*x$t+x$c*x$c),x$L&&(x$f[x$y]=x$R),x$V[++x$y]=x$E?Math.max(0,x$R+x$Q):x$Q}else for(x$y=1;x$y<x$P;x$y++)x$V[x$y]=x$Q;var x$$=this.computeWorldPositions(this.target,x$b,x$_,x$P,x$O,"percent"==this.data.positionMode,"percent"==x$n);if(this._debugKey){for(x$y=0;x$y<x$$.length;x$y++)x$_.drawCircle(x$$[x$y++],x$$[x$y++],5,"#00ff00");var x$D=[];for(x$y=0;x$y<x$$.length;x$y++)x$D.push(x$$[x$y++],x$$[x$y++]);x$_.drawLines(0,0,x$D,"#ff0000")}var x$o=x$$[0],x$M=x$$[1],x$r=this.data.offsetRotation,x$k="chain"==x$C&&0==x$r,x$B=NaN;for(x$y=0,x$B=3;x$y<x$p;x$y++,x$B+=3){(x$i=this.bones[x$y]).resultMatrix.tx+=(x$o-x$i.resultMatrix.tx)*x$s,x$i.resultMatrix.ty+=(x$M-x$i.resultMatrix.ty)*x$s;var x$S=(x$t=x$$[x$B])-x$o,x$Z=(x$c=x$$[x$B+1])-x$M;if(x$L&&0!=(x$R=x$f[x$y])){var x$J=(Math.sqrt(x$S*x$S+x$Z*x$Z)/x$R-1)*x$h+1;x$i.resultMatrix.a*=x$J,x$i.resultMatrix.c*=x$J}if(x$o=x$t,x$M=x$c,x$x){var x$W=x$i.resultMatrix.a,x$T=x$i.resultMatrix.c,x$q=x$i.resultMatrix.b,x$U=x$i.resultMatrix.d,x$G=NaN,x$z=NaN,x$a=NaN;x$G=x$O?x$$[x$B-1]:0==x$V[x$y+1]?x$$[x$B+2]:Math.atan2(x$Z,x$S),x$G-=Math.atan2(x$q,x$W)-x$r/180*Math.PI,x$k&&(x$z=Math.cos(x$G),x$a=Math.sin(x$G),x$o+=((x$R=x$i.length)*(x$z*x$W-x$a*x$q)-x$S)*x$h,x$M+=(x$R*(x$a*x$W+x$z*x$q)-x$Z)*x$h),x$G>Math.PI?x$G-=2*Math.PI:x$G<-Math.PI&&(x$G+=2*Math.PI),x$G*=x$h,x$z=Math.cos(x$G),x$a=Math.sin(x$G),x$i.resultMatrix.a=x$z*x$W-x$a*x$q,x$i.resultMatrix.c=x$z*x$T-x$a*x$U,x$i.resultMatrix.b=x$a*x$W+x$z*x$q,x$i.resultMatrix.d=x$a*x$T+x$z*x$U}}}},x$b.computeWorldVertices2=function(x$b,x$_,x$s,x$h,x$x,x$n){var x$E,x$C,x$O=x$b.currDisplayData.bones,x$L=x$b.currDisplayData.weights,x$f=x$b.currDisplayData.triangles,x$p=0,x$P=0,x$V=0,x$Q=0,x$y=0,x$w=0,x$i=0,x$R=0,x$t=0,x$c=0,x$$=0;if(null!=x$O){for(x$p=0;x$p<x$s;x$p+=2)x$P+=(x$Q=x$O[x$P])+1,x$V+=x$Q;var x$D=x$_;for(x$y=x$n,x$w=3*x$V;x$y<x$h;x$y+=2){for(x$R=x$i=0,x$Q=x$O[x$P++],x$Q+=x$P;x$P<x$Q;x$P++,x$w+=3){x$E=x$D[x$O[x$P]].resultMatrix,x$t=x$L[x$w],x$c=x$L[x$w+1];var x$o=x$L[x$w+2];x$i+=(x$t*x$E.a+x$c*x$E.c+x$E.tx)*x$o,x$R+=(x$t*x$E.b+x$c*x$E.d+x$E.ty)*x$o}x$x[x$y]=x$i,x$x[x$y+1]=x$R}}else{var x$M,x$r;if(x$f||(x$f=x$L),x$b.deformData&&(x$f=x$b.deformData),x$M=x$b.parent,x$_)for(x$$=x$_.length,x$p=0;x$p<x$$;x$p++)if(x$_[x$p].name==x$M){x$C=x$_[x$p];break}x$C&&(x$r=x$C.resultMatrix),x$r||(x$r=x$T._tempMt);var x$k=x$r.tx,x$B=x$r.ty,x$S=x$r.a,x$Z=x$r.b,x$J=x$r.c,x$W=x$r.d;for(x$C&&(x$W*=x$C.d),x$P=x$s,x$y=x$n;x$y<x$h;x$P+=2,x$y+=2)x$t=x$f[x$P],x$c=x$f[x$P+1],x$x[x$y]=x$t*x$S+x$c*x$Z+x$k,x$x[x$y+1]=-(x$t*x$J+x$c*x$W+x$B)}},x$b.computeWorldPositions=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E){x$b.currDisplayData.bones,x$b.currDisplayData.weights,x$b.currDisplayData.triangles;var x$C=[],x$O=0,x$L=x$b.currDisplayData.verLen,x$f=this.position,x$p=this._spaces,x$P=[],x$V=[],x$Q=x$L/6,x$y=-1,x$w=NaN,x$i=0,x$R=0,x$t=NaN,x$c=NaN,x$$=NaN,x$D=NaN;if(x$Q--,x$L-=4,this.computeWorldVertices2(x$b,x$_,2,x$L,x$C,0),this._debugKey)for(x$O=0;x$O<x$C.length;)x$s.drawCircle(x$C[x$O++],x$C[x$O++],10,"#ff0000");x$P=x$C,this._curves.length=x$Q;var x$o=this._curves,x$M=x$P[x$w=0],x$r=x$P[1],x$k=0,x$B=0,x$S=0,x$Z=0,x$J=0,x$W=0,x$T=NaN,x$q=NaN,x$U=NaN,x$G=NaN,x$z=NaN,x$a=NaN,x$K=NaN,x$d=NaN,x$I=0;for(x$O=0,x$I=2;x$O<x$Q;x$O++,x$I+=6)x$k=x$P[x$I],x$B=x$P[x$I+1],x$S=x$P[x$I+2],x$Z=x$P[x$I+3],x$z=2*(x$T=.1875*(x$M-2*x$k+x$S))+(x$U=.09375*(3*(x$k-x$S)-x$M+(x$J=x$P[x$I+4]))),x$a=2*(x$q=.1875*(x$r-2*x$B+x$Z))+(x$G=.09375*(3*(x$B-x$Z)-x$r+(x$W=x$P[x$I+5]))),x$K=.75*(x$k-x$M)+x$T+.16666667*x$U,x$d=.75*(x$B-x$r)+x$q+.16666667*x$G,x$w+=Math.sqrt(x$K*x$K+x$d*x$d),x$K+=x$z,x$d+=x$a,x$z+=x$U,x$a+=x$G,x$w+=Math.sqrt(x$K*x$K+x$d*x$d),x$K+=x$z,x$d+=x$a,x$w+=Math.sqrt(x$K*x$K+x$d*x$d),x$K+=x$z+x$U,x$d+=x$a+x$G,x$w+=Math.sqrt(x$K*x$K+x$d*x$d),x$o[x$O]=x$w,x$M=x$J,x$r=x$W;if(x$n&&(x$f*=x$w),x$E)for(x$O=0;x$O<x$h;x$O++)x$p[x$O]*=x$w;var x$g=this._segments,x$F=0,x$A=0;for(x$A=x$R=x$i=x$O=0;x$O<x$h;x$O++,x$i+=3)if((x$t=x$f+=x$c=x$p[x$O])<0)this.addBeforePosition(x$t,x$P,0,x$V,x$i);else if(x$w<x$t)this.addAfterPosition(x$t-x$w,x$P,x$L-4,x$V,x$i);else{for(;;x$R++)if(!((x$D=x$o[x$R])<x$t)){0==x$R?x$t/=x$D:x$t=(x$t-(x$$=x$o[x$R-1]))/(x$D-x$$);break}if(x$R!=x$y){var x$u=6*(x$y=x$R);for(x$M=x$P[x$u],x$r=x$P[x$u+1],x$k=x$P[x$u+2],x$B=x$P[x$u+3],x$S=x$P[x$u+4],x$Z=x$P[x$u+5],x$z=2*(x$T=.03*(x$M-2*x$k+x$S))+(x$U=.006*(3*(x$k-x$S)-x$M+(x$J=x$P[x$u+6]))),x$a=2*(x$q=.03*(x$r-2*x$B+x$Z))+(x$G=.006*(3*(x$B-x$Z)-x$r+(x$W=x$P[x$u+7]))),x$K=.3*(x$k-x$M)+x$T+.16666667*x$U,x$d=.3*(x$B-x$r)+x$q+.16666667*x$G,x$F=Math.sqrt(x$K*x$K+x$d*x$d),x$g[0]=x$F,x$u=1;x$u<8;x$u++)x$K+=x$z,x$d+=x$a,x$z+=x$U,x$a+=x$G,x$F+=Math.sqrt(x$K*x$K+x$d*x$d),x$g[x$u]=x$F;x$K+=x$z,x$d+=x$a,x$F+=Math.sqrt(x$K*x$K+x$d*x$d),x$g[8]=x$F,x$K+=x$z+x$U,x$d+=x$a+x$G,x$F+=Math.sqrt(x$K*x$K+x$d*x$d),x$g[9]=x$F,x$A=0}for(x$t*=x$F;;x$A++)if(!((x$D=x$g[x$A])<x$t)){0==x$A?x$t/=x$D:x$t=x$A+(x$t-(x$$=x$g[x$A-1]))/(x$D-x$$);break}this.addCurvePosition(.1*x$t,x$M,x$r,x$k,x$B,x$S,x$Z,x$J,x$W,x$V,x$i,x$x||0<x$O&&0==x$c)}return x$V},x$b.addBeforePosition=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$_[x$s],x$E=x$_[x$s+1],x$C=x$_[x$s+2]-x$n,x$O=x$_[x$s+3]-x$E,x$L=Math.atan2(x$O,x$C);x$h[x$x]=x$n+x$b*Math.cos(x$L),x$h[x$x+1]=x$E+x$b*Math.sin(x$L),x$h[x$x+2]=x$L},x$b.addAfterPosition=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$_[x$s+2],x$E=x$_[x$s+3],x$C=x$n-x$_[x$s],x$O=x$E-x$_[x$s+1],x$L=Math.atan2(x$O,x$C);x$h[x$x]=x$n+x$b*Math.cos(x$L),x$h[x$x+1]=x$E+x$b*Math.sin(x$L),x$h[x$x+2]=x$L},x$b.addCurvePosition=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f,x$p){0==x$b&&(x$b=1e-4);var x$P=x$b*x$b,x$V=x$P*x$b,x$Q=1-x$b,x$y=x$Q*x$Q,x$w=x$y*x$Q,x$i=x$Q*x$b,x$R=3*x$i,x$t=x$Q*x$R,x$c=x$R*x$b,x$$=x$_*x$w+x$h*x$t+x$n*x$c+x$C*x$V,x$D=x$s*x$w+x$x*x$t+x$E*x$c+x$O*x$V;x$L[x$f]=x$$,x$L[x$f+1]=x$D,x$L[x$f+2]=x$p?Math.atan2(x$D-(x$s*x$y+x$x*x$i*2+x$E*x$P),x$$-(x$_*x$y+x$h*x$i*2+x$n*x$P)):0},x$T.NONE=-1,x$T.BEFORE=-2,x$T.AFTER=-3,x$s(x$T,["_tempMt",function(){return this._tempMt=new x$Jb}]),x$T}(),x$Ib=function(){function x$b(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return x$h(x$b,"laya.ani.bone.PathConstraintData"),x$b}(),x$gb=function(){function x$b(){this.name=null,this.slotArr=[]}return x$h(x$b,"laya.ani.bone.SkinData"),x$b}(),x$Fb=function(){function x$b(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}x$h(x$b,"laya.ani.bone.SkinSlotDisplayData");var x$_=x$b.prototype;return x$_.createTexture=function(x$b){return this.texture||(this.texture=new x$Wb(x$b.bitmap,this.uvs),x$b.bitmap.alphaTexture&&(this.texture.alphaTexture=new x$Wb(x$b.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=x$b.height,this.texture.height=x$b.width,this.texture.offsetX=-x$b.offsetX,this.texture.offsetY=-x$b.offsetY,this.texture.sourceWidth=x$b.sourceHeight,this.texture.sourceHeight=x$b.sourceWidth):(this.texture.width=x$b.width,this.texture.height=x$b.height,this.texture.offsetX=-x$b.offsetX,this.texture.offsetY=-x$b.offsetY,this.texture.sourceWidth=x$b.sourceWidth,this.texture.sourceHeight=x$b.sourceHeight),x$w.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},x$_.destory=function(){this.texture&&this.texture.destroy()},x$b}(),x$Ab=function(){function x$b(){this.name=null,this.displayArr=[]}return x$h(x$b,"laya.ani.bone.SlotData"),x$b.prototype.getDisplayByName=function(x$b){for(var x$_=0,x$s=this.displayArr.length;x$_<x$s;x$_++)if(this.displayArr[x$_].attachmentName==x$b)return x$_;return-1},x$b}(),x$D=function(){function x$b(x$b,x$_){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=x$y(2,0),this._data=x$b,null==this._bones&&(this._bones=[]),this.target=x$_[x$b.targetIndex];var x$s,x$h=0;for(x$h=0,x$s=x$b.boneIndexs.length;x$h<x$s;x$h++)this._bones.push(x$_[x$b.boneIndexs[x$h]]);this.rotateMix=x$b.rotateMix,this.translateMix=x$b.translateMix,this.scaleMix=x$b.scaleMix,this.shearMix=x$b.shearMix}return x$h(x$b,"laya.ani.bone.TfConstraint"),x$b.prototype.apply=function(){for(var x$b,x$_=this.target.resultMatrix.a,x$s=this.target.resultMatrix.b,x$h=this.target.resultMatrix.c,x$x=this.target.resultMatrix.d,x$n=0,x$E=this._bones.length;x$n<x$E;x$n++){if(x$b=this._bones[x$n],0<this.rotateMix){var x$C=x$b.resultMatrix.a,x$O=x$b.resultMatrix.b,x$L=x$b.resultMatrix.c,x$f=x$b.resultMatrix.d,x$p=Math.atan2(x$h,x$_)-Math.atan2(x$L,x$C)+this._data.offsetRotation*Math.PI/180;x$p>Math.PI?x$p-=2*Math.PI:x$p<-Math.PI&&(x$p+=2*Math.PI),x$p*=this.rotateMix;var x$P=Math.cos(x$p),x$V=Math.sin(x$p);x$b.resultMatrix.a=x$P*x$C-x$V*x$L,x$b.resultMatrix.b=x$P*x$O-x$V*x$f,x$b.resultMatrix.c=x$V*x$C+x$P*x$L,x$b.resultMatrix.d=x$V*x$O+x$P*x$f}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),x$b.resultMatrix.tx+=(this._temp[0]-x$b.resultMatrix.tx)*this.translateMix,x$b.resultMatrix.ty+=(this._temp[1]-x$b.resultMatrix.ty)*this.translateMix,x$b.updateChild()),0<this.scaleMix){var x$Q=Math.sqrt(x$b.resultMatrix.a*x$b.resultMatrix.a+x$b.resultMatrix.c*x$b.resultMatrix.c),x$y=Math.sqrt(x$_*x$_+x$h*x$h),x$w=1e-5<x$Q?(x$Q+(x$y-x$Q+this._data.offsetScaleX)*this.scaleMix)/x$Q:0;x$b.resultMatrix.a*=x$w,x$b.resultMatrix.c*=x$w,x$Q=Math.sqrt(x$b.resultMatrix.b*x$b.resultMatrix.b+x$b.resultMatrix.d*x$b.resultMatrix.d),x$y=Math.sqrt(x$s*x$s+x$x*x$x),x$w=1e-5<x$Q?(x$Q+(x$y-x$Q+this._data.offsetScaleY)*this.scaleMix)/x$Q:0,x$b.resultMatrix.b*=x$w,x$b.resultMatrix.d*=x$w}if(0<this.shearMix){x$O=x$b.resultMatrix.b,x$f=x$b.resultMatrix.d;var x$i=Math.atan2(x$f,x$O);(x$p=Math.atan2(x$x,x$s)-Math.atan2(x$h,x$_)-(x$i-Math.atan2(x$b.resultMatrix.c,x$b.resultMatrix.a)))>Math.PI?x$p-=2*Math.PI:x$p<-Math.PI&&(x$p+=2*Math.PI),x$p=x$i+(x$p+this._data.offsetShearY*Math.PI/180)*this.shearMix,x$w=Math.sqrt(x$O*x$O+x$f*x$f),x$b.resultMatrix.b=Math.cos(x$p)*x$w,x$b.resultMatrix.d=Math.sin(x$p)*x$w}}},x$b}(),x$ub=function(){function x$b(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return x$h(x$b,"laya.ani.bone.TfConstraintData"),x$b}(),x$lb=function(){function x$b(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}x$h(x$b,"laya.ani.bone.Transform");var x$_=x$b.prototype;return x$_.initData=function(x$b){null!=x$b.x&&(this.x=x$b.x),null!=x$b.y&&(this.y=x$b.y),null!=x$b.skX&&(this.skX=x$b.skX),null!=x$b.skY&&(this.skY=x$b.skY),null!=x$b.scX&&(this.scX=x$b.scX),null!=x$b.scY&&(this.scY=x$b.scY)},x$_.getMatrix=function(){var x$b;return(x$b=this.mMatrix?this.mMatrix:this.mMatrix=new x$Jb).identity(),x$b.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(x$b,this.skewX*Math.PI/180,this.skewY*Math.PI/180),x$b.rotate(this.skX*Math.PI/180),x$b.translate(this.x,this.y),x$b},x$_.skew=function(x$b,x$_,x$s){var x$h=Math.sin(x$s),x$x=Math.cos(x$s),x$n=Math.sin(x$_),x$E=Math.cos(x$_);return x$b.setTo(x$b.a*x$E-x$b.b*x$h,x$b.a*x$n+x$b.b*x$x,x$b.c*x$E-x$b.d*x$h,x$b.c*x$n+x$b.d*x$x,x$b.tx*x$E-x$b.ty*x$h,x$b.tx*x$n+x$b.ty*x$x),x$b},x$b}(),x$o=function(){function x$b(){}return x$h(x$b,"laya.ani.bone.UVTools"),x$b.getRelativeUV=function(x$b,x$_,x$s){var x$h=x$b[0],x$x=x$b[2]-x$b[0],x$n=x$b[1],x$E=x$b[5]-x$b[1];x$s||(x$s=[]),x$s.length=x$_.length;var x$C,x$O=0;x$C=x$s.length;var x$L=1/x$x,x$f=1/x$E;for(x$O=0;x$O<x$C;x$O+=2)x$s[x$O]=(x$_[x$O]-x$h)*x$L,x$s[x$O+1]=(x$_[x$O+1]-x$n)*x$f;return x$s},x$b.getAbsoluteUV=function(x$b,x$_,x$s){if(0==x$b[0]&&0==x$b[1]&&1==x$b[4]&&1==x$b[5])return x$s?(x$i.copyArray(x$s,x$_),x$s):x$_;var x$h=x$b[0],x$x=x$b[2]-x$b[0],x$n=x$b[1],x$E=x$b[5]-x$b[1];x$s||(x$s=[]),x$s.length=x$_.length;var x$C,x$O=0;for(x$C=x$s.length,x$O=0;x$O<x$C;x$O+=2)x$s[x$O]=x$_[x$O]*x$x+x$h,x$s[x$O+1]=x$_[x$O+1]*x$E+x$n;return x$s},x$b}(),x$T=function(){function x$b(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return x$h(x$b,"laya.ani.KeyFramesContent"),x$b}(),x$M=function(){function x$f(){}return x$h(x$f,"laya.ani.math.BezierLerp"),x$f.getBezierRate=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$f._getBezierParamKey(x$_,x$s,x$h,x$x),x$E=100*x$n+x$b;if(x$f._bezierResultCache[x$E])return x$f._bezierResultCache[x$E];var x$C,x$O=x$f._getBezierPoints(x$_,x$s,x$h,x$x,x$n),x$L=0;for(x$C=x$O.length,x$L=0;x$L<x$C;x$L+=2)if(x$b<=x$O[x$L])return x$f._bezierResultCache[x$E]=x$O[x$L+1],x$O[x$L+1];return x$f._bezierResultCache[x$E]=1},x$f._getBezierParamKey=function(x$b,x$_,x$s,x$h){return 100*(100*(100*(100*x$b+x$_)+x$s)+x$h)},x$f._getBezierPoints=function(x$b,x$_,x$s,x$h,x$x){return x$f._bezierPointsCache[x$x]?x$f._bezierPointsCache[x$x]:(x$n=[0,0,x$b,x$_,x$s,x$h,1,1],x$E=(new x$C).getBezierPoints(x$n,100,3),x$f._bezierPointsCache[x$x]=x$E);var x$n,x$E},x$f._bezierResultCache={},x$f._bezierPointsCache={},x$f}(),x$r=function(x$b){function x$_(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,x$_.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}x$h(x$_,"laya.ani.AnimationPlayer",x$x);var x$s=x$_.prototype;return x$xb.imps(x$s,{"laya.resource.IDestroy":!0}),x$s._onTempletLoadedComputeFullKeyframeIndices=function(x$b,x$_,x$s){this._templet===x$s&&this._cachePlayRate===x$b&&this._cacheFrameRate===x$_&&this._computeFullKeyframeIndices()},x$s._computeFullKeyframeIndices=function(){for(var x$b=this._fullFrames=[],x$_=this._templet,x$s=this._cacheFrameRateInterval*this._cachePlayRate,x$h=0,x$x=x$_.getAnimationCount();x$h<x$x;x$h++){for(var x$n=[],x$E=0,x$C=x$_.getAnimation(x$h).nodes.length;x$E<x$C;x$E++){for(var x$O=x$_.getAnimation(x$h).nodes[x$E],x$L=Math.floor(x$O.playTime/x$s+.01),x$f=new Uint16Array(x$L+1),x$p=-1,x$P=0,x$V=x$O.keyFrame.length;x$P<x$V;x$P++){var x$Q=x$O.keyFrame[x$P],x$y=x$Q.startTime,x$w=x$y+x$Q.duration+x$s;do{for(var x$i=Math.floor(x$y/x$s+.5),x$R=x$p+1;x$R<x$i;x$R++)x$f[x$R]=x$P;x$f[x$p=x$i]=x$P,x$y+=x$s}while(x$y<=x$w)}x$n.push(x$f)}x$b.push(x$n)}},x$s._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},x$s._calculatePlayDuration=function(){if(0!==this.state){var x$b=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=x$b),this._playEnd>x$b&&(this._playEnd=x$b),this._playDuration=this._playEnd-this._playStart}},x$s._setPlayParams=function(x$b,x$_){this._currentTime=x$b,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/x$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*x$_},x$s._setPlayParamsWhenStop=function(x$b,x$_){this._currentTime=x$b,this._currentKeyframeIndex=Math.max(Math.floor(x$b/x$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*x$_,this._currentAnimationClipIndex=-1},x$s._update=function(x$b){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var x$_=this._cacheFrameRateInterval*this._cachePlayRate,x$s=0;this._startUpdateLoopCount!==x$Q.loopCount&&(x$s=x$b*this.playbackRate,this._elapsedPlaybackTime+=x$s);var x$h=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=x$h)return this._setPlayParamsWhenStop(x$h,x$_),void this.event("stopped");if(x$s+=this._currentTime,0<x$h)if(x$h<=x$s)do{if(x$s-=x$h,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(x$h,x$_),this._stopWhenCircleFinish=!1,void this.event("stopped");x$s<x$h&&(this._setPlayParams(x$s,x$_),this.event("complete"))}while(x$h<=x$s);else this._setPlayParams(x$s,x$_);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(x$h,x$_),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},x$s._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},x$s.play=function(x$b,x$_,x$s,x$h,x$x){if(void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=1),void 0===x$s&&(x$s=2147483647),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(x$s<0||x$h<0||x$x<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==x$x&&x$x<x$h)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=x$_,this._overallDuration=x$s,this._playStart=x$h,this._playEnd=x$x,this._paused=!1,this._currentAnimationClipIndex=x$b,this._currentKeyframeIndex=0,this._startUpdateLoopCount=x$Q.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},x$s.playByFrame=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$b&&(x$b=0),void 0===x$_&&(x$_=1),void 0===x$s&&(x$s=2147483647),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=30);var x$E=1e3/x$n;this.play(x$b,x$_,x$s,x$h*x$E,x$x*x$E)},x$s.stop=function(x$b){void 0===x$b&&(x$b=!0),x$b?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},x$n(0,x$s,"playEnd",function(){return this._playEnd}),x$n(0,x$s,"templet",function(){return this._templet},function(x$b){0===!this.state&&this.stop(!0),this._templet!==x$b&&((this._templet=x$b).loaded?this._computeFullKeyframeIndices():x$b.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),x$n(0,x$s,"playStart",function(){return this._playStart}),x$n(0,x$s,"playDuration",function(){return this._playDuration}),x$n(0,x$s,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),x$n(0,x$s,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),x$n(0,x$s,"overallDuration",function(){return this._overallDuration}),x$n(0,x$s,"currentFrameTime",function(){return this._currentFrameTime}),x$n(0,x$s,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),x$n(0,x$s,"currentPlayTime",function(){return this._currentTime+this._playStart}),x$n(0,x$s,"cachePlayRate",function(){return this._cachePlayRate},function(x$b){this._cachePlayRate!==x$b&&(this._cachePlayRate=x$b,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[x$b,this._cacheFrameRate])))}),x$n(0,x$s,"cacheFrameRate",function(){return this._cacheFrameRate},function(x$b){this._cacheFrameRate!==x$b&&(this._cacheFrameRate=x$b,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,x$b])))}),x$n(0,x$s,"currentTime",null,function(x$b){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(x$b<this._playStart||x$b>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=x$Q.loopCount;var x$_=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=x$b,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/x$_),0),this._currentFrameTime=this._currentKeyframeIndex*x$_}}),x$n(0,x$s,"paused",function(){return this._paused},function(x$b){(this._paused=x$b)&&this.event("paused")}),x$n(0,x$s,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),x$n(0,x$s,"destroyed",function(){return this._destroyed}),x$_}(),x$q=function(x$b){function x$_(){x$_.__super.call(this),x$w.isConchNode&&(this.drawSkin=function(x$b){x$b.transform||(x$b.transform=x$Jb.EMPTY),this._addCmd([x$b]),this.setSkinMesh&&this.setSkinMesh(x$b._ps,x$b.mVBData,x$b.mEleNum,0,x$b.mTexture,x$b.transform)})}return x$h(x$_,"laya.ani.GraphicsAni",x$E),x$_.prototype.drawSkin=function(x$b){var x$_=[x$b];this._saveToCmd(x$w._context._drawSkin,x$_)},x$_.create=function(){return x$_._caches.pop()||new x$_},x$_.recycle=function(x$b){x$b.clear(),x$_._caches.push(x$b)},x$_._caches=[],x$_}(),x$U=function(x$b){function x$R(){this._aniMap={},this.unfixedLastAniIndex=-1,x$R.__super.call(this),this._anis=new Array}x$h(x$R,"laya.ani.AnimationTemplet",x$f);var x$_=x$R.prototype;return x$_.parse=function(x$b){var x$_=new x$Zb(x$b);this._aniVersion=x$_.readUTFString(),x$t.parse(this,x$_)},x$_._calculateKeyFrame=function(x$b,x$_,x$s){var x$h=x$b.keyFrame;x$h[x$_]=x$h[0];for(var x$x=0;x$x<x$_;x$x++){var x$n=x$h[x$x];x$n.nextData=0===x$n.duration?x$n.data:x$h[x$x+1].data}x$h.length--},x$_.onAsynLoaded=function(x$b,x$_,x$s){var x$h=new x$Zb(x$_);switch(this._aniVersion=x$h.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":x$c.parse(this,x$h);break;default:x$t.parse(this,x$h)}this._endLoaded()},x$_.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},x$_.getAnimationCount=function(){return this._anis.length},x$_.getAnimation=function(x$b){return this._anis[x$b]},x$_.getAniDuration=function(x$b){return this._anis[x$b].playTime},x$_.getNodes=function(x$b){return this._anis[x$b].nodes},x$_.getNodeIndexWithName=function(x$b,x$_){return this._anis[x$b].bone3DMap[x$_]},x$_.getNodeCount=function(x$b){return this._anis[x$b].nodes.length},x$_.getTotalkeyframesLength=function(x$b){return this._anis[x$b].totalKeyframeDatasLength},x$_.getPublicExtData=function(){return this._publicExtData},x$_.getAnimationDataWithCache=function(x$b,x$_,x$s,x$h){var x$x=x$_[x$s];if(x$x){var x$n=x$x[x$b];return x$n?x$n[x$h]:null}return null},x$_.setAnimationDataWithCache=function(x$b,x$_,x$s,x$h,x$x){var x$n=x$_[x$s]||(x$_[x$s]={});(x$n[x$b]||(x$n[x$b]=[]))[x$h]=x$x},x$_.getOriginalData=function(x$b,x$_,x$s,x$h,x$x){for(var x$n=this._anis[x$b].nodes,x$E=0,x$C=0,x$O=x$n.length,x$L=0;x$C<x$O;x$C++){var x$f,x$p=x$n[x$C];x$f=x$p.keyFrame[x$s[x$C][x$h]],x$p.dataOffset=x$L;var x$P=x$x-x$f.startTime,x$V=x$p.lerpType;if(x$V)switch(x$V){case 0:case 1:for(x$E=0;x$E<x$p.keyframeWidth;)x$E+=x$p.interpolationMethod[x$E](x$p,x$E,x$_,x$L+x$E,x$f.data,x$P,null,x$f.duration,x$f.nextData);break;case 2:var x$Q=x$f.interpolationData,x$y=x$Q.length,x$w=0;for(x$E=0;x$E<x$y;){var x$i=x$Q[x$E];switch(x$i){case 6:case 7:x$E+=x$R.interpolation[x$i](x$p,x$w,x$_,x$L+x$w,x$f.data,x$P,null,x$f.duration,x$f.nextData,x$Q,x$E+1);break;default:x$E+=x$R.interpolation[x$i](x$p,x$w,x$_,x$L+x$w,x$f.data,x$P,null,x$f.duration,x$f.nextData)}x$w++}}else for(x$E=0;x$E<x$p.keyframeWidth;)x$E+=x$p.interpolationMethod[x$E](x$p,x$E,x$_,x$L+x$E,x$f.data,x$P,null,x$f.duration,x$f.nextData);x$L+=x$p.keyframeWidth}},x$_.getNodesCurrentFrameIndex=function(x$b,x$_){var x$s=this._anis[x$b].nodes;x$b!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(x$s.length),this.unfixedCurrentTimes=new Float32Array(x$s.length),this.unfixedLastAniIndex=x$b);for(var x$h=0,x$x=x$s.length;x$h<x$x;x$h++){var x$n=x$s[x$h];for(x$_<this.unfixedCurrentTimes[x$h]&&(this.unfixedCurrentFrameIndexes[x$h]=0),this.unfixedCurrentTimes[x$h]=x$_;this.unfixedCurrentFrameIndexes[x$h]<x$n.keyFrame.length&&!(x$n.keyFrame[this.unfixedCurrentFrameIndexes[x$h]].startTime>this.unfixedCurrentTimes[x$h]);)this.unfixedCurrentFrameIndexes[x$h]++;this.unfixedCurrentFrameIndexes[x$h]--}return this.unfixedCurrentFrameIndexes},x$_.getOriginalDataUnfixedRate=function(x$b,x$_,x$s){var x$h=this._anis[x$b].nodes;x$b!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(x$h.length),this.unfixedCurrentTimes=new Float32Array(x$h.length),this.unfixedKeyframes=x$y(x$h.length),this.unfixedLastAniIndex=x$b);for(var x$x=0,x$n=0,x$E=x$h.length,x$C=0;x$n<x$E;x$n++){var x$O=x$h[x$n];for(x$s<this.unfixedCurrentTimes[x$n]&&(this.unfixedCurrentFrameIndexes[x$n]=0),this.unfixedCurrentTimes[x$n]=x$s;this.unfixedCurrentFrameIndexes[x$n]<x$O.keyFrame.length&&!(x$O.keyFrame[this.unfixedCurrentFrameIndexes[x$n]].startTime>this.unfixedCurrentTimes[x$n]);)this.unfixedKeyframes[x$n]=x$O.keyFrame[this.unfixedCurrentFrameIndexes[x$n]],this.unfixedCurrentFrameIndexes[x$n]++;var x$L=this.unfixedKeyframes[x$n];x$O.dataOffset=x$C;var x$f=x$s-x$L.startTime;if(x$O.lerpType)switch(x$O.lerpType){case 0:case 1:for(x$x=0;x$x<x$O.keyframeWidth;)x$x+=x$O.interpolationMethod[x$x](x$O,x$x,x$_,x$C+x$x,x$L.data,x$f,null,x$L.duration,x$L.nextData);break;case 2:var x$p=x$L.interpolationData,x$P=x$p.length,x$V=0;for(x$x=0;x$x<x$P;){var x$Q=x$p[x$x];switch(x$Q){case 6:case 7:x$x+=x$R.interpolation[x$Q](x$O,x$V,x$_,x$C+x$V,x$L.data,x$f,null,x$L.duration,x$L.nextData,x$p,x$x+1);break;default:x$x+=x$R.interpolation[x$Q](x$O,x$V,x$_,x$C+x$V,x$L.data,x$f,null,x$L.duration,x$L.nextData)}x$V++}}else for(x$x=0;x$x<x$O.keyframeWidth;)x$x+=x$O.interpolationMethod[x$x](x$O,x$x,x$_,x$C+x$x,x$L.data,x$f,null,x$L.duration,x$L.nextData);x$C+=x$O.keyframeWidth}},x$R._LinearInterpolation_0=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){var x$f=0===x$C?0:x$n/x$C;return x$s[x$h]=(1-x$f)*x$x[x$_]+x$f*x$O[x$_],1},x$R._QuaternionInterpolation_1=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){var x$f=0===x$C?0:x$n/x$C;return x$P.slerpQuaternionArray(x$x,x$_,x$O,x$_,x$f,x$s,x$h),4},x$R._AngleInterpolation_2=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return 0},x$R._RadiansInterpolation_3=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return 0},x$R._Matrix4x4Interpolation_4=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){for(var x$f=0;x$f<16;x$f++,x$_++)x$s[x$h+x$f]=x$x[x$_]+x$n*x$E[x$_];return 16},x$R._NoInterpolation_5=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L){return x$s[x$h]=x$x[x$_],1},x$R._BezierInterpolation_6=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f){return void 0===x$f&&(x$f=0),x$s[x$h]=x$x[x$_]+(x$O[x$_]-x$x[x$_])*x$M.getBezierRate(x$n/x$C,x$L[x$f],x$L[x$f+1],x$L[x$f+2],x$L[x$f+3]),5},x$R._BezierInterpolation_7=function(x$b,x$_,x$s,x$h,x$x,x$n,x$E,x$C,x$O,x$L,x$f){return void 0===x$f&&(x$f=0),x$s[x$h]=x$L[x$f+4]+x$L[x$f+5]*x$M.getBezierRate((.001*x$n+x$L[x$f+6])/x$L[x$f+7],x$L[x$f],x$L[x$f+1],x$L[x$f+2],x$L[x$f+3]),9},x$R.load=function(x$b){return x$xb.loader.create(x$b,null,null,x$R)},x$R.interpolation=[x$R._LinearInterpolation_0,x$R._QuaternionInterpolation_1,x$R._AngleInterpolation_2,x$R._RadiansInterpolation_3,x$R._Matrix4x4Interpolation_4,x$R._NoInterpolation_5,x$R._BezierInterpolation_6,x$R._BezierInterpolation_7],x$R}(),x$k=function(x$_){function x$s(x$b,x$_){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,x$s.__super.call(this),void 0===x$_&&(x$_=0),x$b&&this.init(x$b,x$_)}x$h(x$s,"laya.ani.bone.Skeleton",x$_);var x$b=x$s.prototype;return x$b.init=function(x$b,x$_){void 0===x$_&&(x$_=0);var x$s,x$h,x$x,x$n=0,x$E=0;if(1==x$_)for(this._graphicsCache=[],x$n=0,x$E=x$b.getAnimationCount();x$n<x$E;x$n++)this._graphicsCache.push([]);if(this._yReverseMatrix=x$b.yReverseMatrix,this._aniMode=x$_,this._templet=x$b,this._player=new x$r,this._player.cacheFrameRate=x$b.rate,this._player.templet=x$b,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=x$b.mBoneArr,this._rootBone=x$b.mRootBone,this._aniSectionDic=x$b.aniSectionDic,0<x$b.ikArr.length)for(this._ikArr=[],x$n=0,x$E=x$b.ikArr.length;x$n<x$E;x$n++)this._ikArr.push(new x$R(x$b.ikArr[x$n],this._boneList));if(0<x$b.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),x$n=0,x$E=x$b.pathArr.length;x$n<x$E;x$n++)x$s=x$b.pathArr[x$n],x$h=new x$$(x$s,this._boneList),(x$x=this._boneSlotDic[x$s.name])&&((x$h=new x$$(x$s,this._boneList)).target=x$x),this._pathDic[x$s.name]=x$h;if(0<x$b.tfArr.length)for(this._tfArr=[],x$n=0,x$E=x$b.tfArr.length;x$n<x$E;x$n++)this._tfArr.push(new x$D(x$b.tfArr[x$n],this._boneList));if(0<x$b.skinDataArray.length){var x$C=this._templet.skinDataArray[this._skinIndex];this._skinName=x$C.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},x$b.load=function(x$b,x$_,x$s){},x$b._onLoaded=function(){},x$b._parseComplete=function(){var x$b=x$B.TEMPLET_DICTIONARY[this._aniPath];x$b&&(this.init(x$b,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},x$b._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},x$b._onPlay=function(){this.event("played")},x$b._onStop=function(){var x$b,x$_=this._templet.eventAniArr[this._aniClipIndex];if(x$_&&this._eventIndex<x$_.length)for(;this._eventIndex<x$_.length;this._eventIndex++)(x$b=x$_[this._eventIndex]).time>=this._player.playStart&&x$b.time<=this._player.playEnd&&this.event("label",x$b);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},x$b._onPause=function(){this.event("paused")},x$b._parseSrcBoneMatrix=function(){var x$b=0,x$_=0;for(x$_=this._templet.srcBoneMatrixArr.length,x$b=0;x$b<x$_;x$b++)this._boneMatrixArray.push(new x$Jb);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var x$s,x$h,x$x=this._templet.boneSlotArray;for(x$b=0,x$_=x$x.length;x$b<x$_;x$b++)x$s=x$x[x$b],null==(x$h=this._bindBoneBoneSlotDic[x$s.parent])&&(this._bindBoneBoneSlotDic[x$s.parent]=x$h=[]),this._boneSlotDic[x$s.name]=x$s=x$s.copy(),x$h.push(x$s),this._boneSlotArray.push(x$s)}},x$b._emitMissedEvents=function(x$b,x$_,x$s){void 0===x$s&&(x$s=0);var x$h=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(x$h){var x$x,x$n,x$E=0;for(x$x=x$h.length,x$E=x$s;x$E<x$x;x$E++)(x$n=x$h[x$E]).time>=this._player.playStart&&x$n.time<=this._player.playEnd&&this.event("label",x$n)}},x$b._update=function(x$b){if(void 0===x$b&&(x$b=!0),!(this._pause||x$b&&this._indexControl)){var x$_=this.timer.currTimer,x$s=this._player.currentKeyframeIndex,x$h=x$_-this._lastTime;if(x$b?this._player._update(x$h):x$s=-1,this._lastTime=x$_,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<x$h&&this._clipIndex==x$s&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var x$x;this._lastUpdateAniClipIndex=this._aniClipIndex,x$s>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var x$n,x$E=this._templet.eventAniArr[this._aniClipIndex];if(x$E&&this._eventIndex<x$E.length&&((x$x=x$E[this._eventIndex]).time>=this._player.playStart&&x$x.time<=this._player.playEnd?this._player.currentPlayTime>=x$x.time&&(this.event("label",x$x),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(x$n=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=x$n&&(this.graphics=x$n));var x$C=0,x$O=0;for(x$O=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,x$O-1)&&0<x$O;)x$O--;if(x$O<this._clipIndex)for(x$C=x$O;x$C<this._clipIndex;x$C++)this._createGraphics(x$C)}else if(1==this._aniMode){if(x$n=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=x$n&&(this.graphics=x$n));for(x$O=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,x$O-1)&&0<x$O;)x$O--;if(x$O<this._clipIndex)for(x$C=x$O;x$C<this._clipIndex;x$C++)this._createGraphics(x$C)}this._createGraphics()}}},x$b._createGraphics=function(x$b){void 0===x$b&&(x$b=-1),-1==x$b&&(x$b=this._clipIndex);var x$_,x$s,x$h=x$b*this._player.cacheFrameRateInterval,x$x=this._templet.drawOrderAniArr[this._aniClipIndex];if(x$x&&0<x$x.length)for(this._drawOrderIndex=0,x$_=x$x[this._drawOrderIndex];x$h>=x$_.time&&(this._drawOrder=x$_.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=x$x.length));)x$_=x$x[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=x$q.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=x$q.create(),x$s=this.graphics;var x$n=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],x$b,x$h);var x$E,x$C,x$O,x$L,x$f=this._aniSectionDic[this._aniClipIndex],x$p=0,x$P=0,x$V=0,x$Q=0,x$y=0,x$w=this._templet.srcBoneMatrixArr.length;for(x$y=x$f[x$P=0];x$P<x$w;x$P++)x$L=this._boneList[x$P],x$O=this._templet.srcBoneMatrixArr[x$P],x$L.resultTransform.scX=x$O.scX*this._curOriginalData[x$p++],x$L.resultTransform.skX=x$O.skX+this._curOriginalData[x$p++],x$L.resultTransform.skY=x$O.skY+this._curOriginalData[x$p++],x$L.resultTransform.scY=x$O.scY*this._curOriginalData[x$p++],x$L.resultTransform.x=x$O.x+this._curOriginalData[x$p++],x$L.resultTransform.y=x$O.y+this._curOriginalData[x$p++],8===this._templet.tMatrixDataLen&&(x$L.resultTransform.skewX=x$O.skewX+this._curOriginalData[x$p++],x$L.resultTransform.skewY=x$O.skewY+this._curOriginalData[x$p++]);var x$i,x$R={},x$t={};for(x$y+=x$f[1];x$P<x$y;x$P++)x$R[(x$i=x$n[x$P]).name]=this._curOriginalData[x$p++],x$t[x$i.name]=this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++];var x$c,x$$,x$D={},x$o={};for(x$y+=x$f[2];x$P<x$y;x$P++)x$D[(x$i=x$n[x$P]).name]=this._curOriginalData[x$p++],x$o[x$i.name]=this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++],this._curOriginalData[x$p++];if(this._pathDic)for(x$y+=x$f[3];x$P<x$y;x$P++){if(x$i=x$n[x$P],x$c=this._pathDic[x$i.name])switch(new x$Zb(x$i.extenData).getByte()){case 1:x$c.position=this._curOriginalData[x$p++];break;case 2:x$c.spacing=this._curOriginalData[x$p++];break;case 3:x$c.rotateMix=this._curOriginalData[x$p++],x$c.translateMix=this._curOriginalData[x$p++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(x$Jb.TEMP.identity()),this._ikArr)for(x$P=0,x$y=this._ikArr.length;x$P<x$y;x$P++)x$$=this._ikArr[x$P],x$D.hasOwnProperty(x$$.name)&&(x$$.bendDirection=x$D[x$$.name]),x$o.hasOwnProperty(x$$.name)&&(x$$.mix=x$o[x$$.name]),x$$.apply();if(this._pathDic)for(var x$M in this._pathDic)(x$c=this._pathDic[x$M]).apply(this._boneList,x$s);if(this._tfArr)for(x$P=0,x$Q=this._tfArr.length;x$P<x$Q;x$P++)this._tfArr[x$P].apply();for(x$P=0,x$Q=this._boneList.length;x$P<x$Q;x$P++)if(x$L=this._boneList[x$P],x$C=this._bindBoneBoneSlotDic[x$L.name],x$L.resultMatrix.copyTo(this._boneMatrixArray[x$P]),x$C)for(x$V=0,x$y=x$C.length;x$V<x$y;x$V++)(x$E=x$C[x$V])&&x$E.setParentMatrix(x$L.resultMatrix);var x$r,x$k,x$B,x$S,x$Z={},x$J=this._templet.deformAniArr;if(x$J&&0<x$J.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,x$P=0,x$y=this._boneSlotArray.length;x$P<x$y;x$P++)(x$E=this._boneSlotArray[x$P]).deformData=null;var x$W,x$T=x$J[this._aniClipIndex];for(x$W in x$r=x$T.default,this._setDeform(x$r,x$Z,this._boneSlotArray,x$h),x$T)"default"!=x$W&&x$W!=this._skinName&&(x$r=x$T[x$W],this._setDeform(x$r,x$Z,this._boneSlotArray,x$h));x$r=x$T[this._skinName],this._setDeform(x$r,x$Z,this._boneSlotArray,x$h)}if(this._drawOrder)for(x$P=0,x$y=this._drawOrder.length;x$P<x$y;x$P++)x$k=x$R[(x$E=this._boneSlotArray[this._drawOrder[x$P]]).name],x$B=x$t[x$E.name],isNaN(x$B)||(x$s.save(),x$s.alpha(x$B)),isNaN(x$k)||-2==x$k||(this._templet.attachmentNames?x$E.showDisplayByName(this._templet.attachmentNames[x$k]):x$E.showDisplayByIndex(x$k)),x$Z[this._drawOrder[x$P]]?(x$S=x$Z[this._drawOrder[x$P]],x$E.currDisplayData&&x$S[x$E.currDisplayData.attachmentName]?x$E.deformData=x$S[x$E.currDisplayData.attachmentName]:x$E.deformData=null):x$E.deformData=null,isNaN(x$B)?x$E.draw(x$s,this._boneMatrixArray,2==this._aniMode):x$E.draw(x$s,this._boneMatrixArray,2==this._aniMode,x$B),isNaN(x$B)||x$s.restore();else for(x$P=0,x$y=this._boneSlotArray.length;x$P<x$y;x$P++)x$k=x$R[(x$E=this._boneSlotArray[x$P]).name],x$B=x$t[x$E.name],isNaN(x$B)||(x$s.save(),x$s.alpha(x$B)),isNaN(x$k)||-2==x$k||(this._templet.attachmentNames?x$E.showDisplayByName(this._templet.attachmentNames[x$k]):x$E.showDisplayByIndex(x$k)),x$Z[x$P]?(x$S=x$Z[x$P],x$E.currDisplayData&&x$S[x$E.currDisplayData.attachmentName]?x$E.deformData=x$S[x$E.currDisplayData.attachmentName]:x$E.deformData=null):x$E.deformData=null,isNaN(x$B)?x$E.draw(x$s,this._boneMatrixArray,2==this._aniMode):x$E.draw(x$s,this._boneMatrixArray,2==this._aniMode,x$B),isNaN(x$B)||x$s.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,x$b,x$s):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,x$b,x$s)},x$b._setDeform=function(x$b,x$_,x$s,x$h){if(x$b){var x$x,x$n,x$E,x$C=0,x$O=0,x$L=0;if(x$b)for(x$C=0,x$O=x$b.deformSlotDataList.length;x$C<x$O;x$C++)for(x$x=x$b.deformSlotDataList[x$C],x$L=0;x$L<x$x.deformSlotDisplayList.length;x$L++)x$E=x$s[(x$n=x$x.deformSlotDisplayList[x$L]).slotIndex],x$n.apply(x$h,x$E),x$_[x$n.slotIndex]||(x$_[x$n.slotIndex]={}),x$_[x$n.slotIndex][x$n.attachment]=x$n.deformData}},x$b.getAnimNum=function(){return this._templet.getAnimationCount()},x$b.getAniNameByIndex=function(x$b){return this._templet.getAniNameByIndex(x$b)},x$b.getSlotByName=function(x$b){return this._boneSlotDic[x$b]},x$b.showSkinByName=function(x$b,x$_){void 0===x$_&&(x$_=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(x$b),x$_)},x$b.showSkinByIndex=function(x$b,x$_){void 0===x$_&&(x$_=!0);for(var x$s=0;x$s<this._boneSlotArray.length;x$s++)this._boneSlotArray[x$s].showSlotData(null,x$_);if(this._templet.showSkinByIndex(this._boneSlotDic,x$b,x$_)){var x$h=this._templet.skinDataArray[x$b];this._skinIndex=x$b,this._skinName=x$h.name}this._clearCache()},x$b.showSlotSkinByIndex=function(x$b,x$_){if(0!=this._aniMode){var x$s=this.getSlotByName(x$b);x$s&&x$s.showDisplayByIndex(x$_),this._clearCache()}},x$b.showSlotSkinByName=function(x$b,x$_){if(0!=this._aniMode){var x$s=this.getSlotByName(x$b);x$s&&x$s.showDisplayByName(x$_),this._clearCache()}},x$b.replaceSlotSkinName=function(x$b,x$_,x$s){if(0!=this._aniMode){var x$h=this.getSlotByName(x$b);x$h&&x$h.replaceDisplayByName(x$_,x$s),this._clearCache()}},x$b.replaceSlotSkinByIndex=function(x$b,x$_,x$s){if(0!=this._aniMode){var x$h=this.getSlotByName(x$b);x$h&&x$h.replaceDisplayByIndex(x$_,x$s),this._clearCache()}},x$b.setSlotSkin=function(x$b,x$_){if(0!=this._aniMode){var x$s=this.getSlotByName(x$b);x$s&&x$s.replaceSkin(x$_),this._clearCache()}},x$b._clearCache=function(){if(1==this._aniMode)for(var x$b=0,x$_=this._graphicsCache.length;x$b<x$_;x$b++){for(var x$s=0,x$h=this._graphicsCache[x$b].length;x$s<x$h;x$s++){var x$x=this._graphicsCache[x$b][x$s];x$x!=this.graphics&&x$q.recycle(x$x)}this._graphicsCache[x$b].length=0}},x$b.play=function(x$b,x$_,x$s,x$h,x$x,x$n){void 0===x$s&&(x$s=!0),void 0===x$h&&(x$h=0),void 0===x$x&&(x$x=0),void 0===x$n&&(x$n=!0),this._indexControl=!1;var x$E=-1,x$C=NaN;if(x$C=x$_?2147483647:0,"string"==typeof x$b)for(var x$O=0,x$L=this._templet.getAnimationCount();x$O<x$L;x$O++){var x$f=this._templet.getAnimation(x$O);if(x$f&&x$b==x$f.name){x$E=x$O;break}}else x$E=x$b;-1<x$E&&x$E<this.getAnimNum()&&(this._aniClipIndex=x$E,(x$s||this._pause||this._currAniIndex!=x$E)&&(this._currAniIndex=x$E,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(x$E)),this._drawOrder=null,this._eventIndex=0,this._player.play(x$E,this._player.playbackRate,x$C,x$h,x$x),x$n&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=x$p.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},x$b.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},x$b.playbackRate=function(x$b){this._player&&(this._player.playbackRate=x$b)},x$b.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},x$b.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=x$p.now(),this.timer.frameLoop(1,this,this._update,null,!0))},x$b._getGrahicsDataWithCache=function(x$b,x$_){return this._graphicsCache[x$b][x$_]},x$b._setGrahicsDataWithCache=function(x$b,x$_,x$s){this._graphicsCache[x$b][x$_]=x$s},x$b.destroy=function(x$b){void 0===x$b&&(x$b=!0),x$_.prototype.destroy.call(this,x$b),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},x$n(0,x$b,"url",function(){return this._aniPath},function(x$b){this.load(x$b)}),x$n(0,x$b,"index",function(){return this._index},function(x$b){this.player&&(this._index=x$b,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),x$n(0,x$b,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),x$n(0,x$b,"templet",function(){return this._templet}),x$n(0,x$b,"player",function(){return this._player}),x$s.useSimpleMeshInCanvas=!1,x$s}(x$nb),x$B=function(x$_){function x$x(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,x$x.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}x$h(x$x,"laya.ani.bone.Templet",x$_);var x$b=x$x.prototype;return x$b.getLoadList=function(){return this._loadList},x$b.loadAni=function(x$b){this._skBufferUrl=x$b,x$xb.loader.load(x$b,x$O.create(this,this.onComplete),null,"arraybuffer")},x$b.onComplete=function(x$b){if(this._isDestroyed)this.destroy();else{var x$_=x$L.getRes(this._skBufferUrl);x$_?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,x$_)):this.event("error","load failed:"+this._skBufferUrl)}},x$b.parseData=function(x$b,x$_,x$s){void 0===x$s&&(x$s=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=x$b,this._mainTexture&&x$w.isWebGL&&x$b.bitmap&&(x$b.bitmap.enableMerageInAtlas=!1),this._rate=x$s,this.parse(x$_)},x$b.buildArmature=function(x$b){return void 0===x$b&&(x$b=0),new x$k(this,x$b)},x$b.parse=function(x$b){x$_.prototype.parse.call(this,x$b),this._endLoaded(),this._aniVersion!=x$x.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+x$x.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},x$b._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var x$b=0;this._loadList=[];var x$_,x$s=new x$Zb(this.getPublicExtData()),x$h=0,x$x=0,x$n=0,x$E=x$s.getInt32(),x$C=x$s.readUTFString(),x$O=x$C.split("\n");for(x$b=0;x$b<x$E;x$b++)x$_=this._path+x$O[2*x$b],x$C=x$O[2*x$b+1],x$s.getFloat32(),x$s.getFloat32(),x$h=x$s.getFloat32(),x$x=x$s.getFloat32(),x$n=x$s.getFloat32(),isNaN(x$n)?0:x$n,x$n=x$s.getFloat32(),isNaN(x$n)?0:x$n,x$n=x$s.getFloat32(),isNaN(x$n)?x$h:x$n,x$n=x$s.getFloat32(),isNaN(x$n)?x$x:x$n,-1==this._loadList.indexOf(x$_)&&this._loadList.push(x$_);this.event("inited",this)}},x$b._textureComplete=function(){for(var x$b,x$_,x$s=0,x$h=this._loadList.length;x$s<x$h;x$s++)x$_=this._loadList[x$s],x$b=this._textureDic[x$_]=x$L.getRes(x$_),x$w.isWebGL&&x$b&&x$b.bitmap&&(x$b.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},x$b._parsePublicExtData=function(){var x$b=0,x$_=0,x$s=0,x$h=0,x$x=0;for(x$b=0,x$x=this.getAnimationCount();x$b<x$x;x$b++)this._graphicsCache.push([]);var x$n;x$n="Dragon"!=this._aniClassName;var x$E,x$C,x$O=new x$Zb(this.getPublicExtData()),x$L=0,x$f=0,x$p=0,x$P=0,x$V=0,x$Q=0,x$y=0,x$w=0,x$i=0,x$R=x$O.getInt32(),x$t=x$O.readUTFString(),x$c=x$t.split("\n");for(x$b=0;x$b<x$R;x$b++){if(x$E=this._mainTexture,x$C=this._path+x$c[2*x$b],x$t=x$c[2*x$b+1],null==this._mainTexture&&(x$E=this._textureDic[x$C]),!x$E)return this.event("error",this),void(this.isParseFail=!0);x$L=x$O.getFloat32(),x$f=x$O.getFloat32(),x$p=x$O.getFloat32(),x$P=x$O.getFloat32(),x$i=x$O.getFloat32(),x$V=isNaN(x$i)?0:x$i,x$i=x$O.getFloat32(),x$Q=isNaN(x$i)?0:x$i,x$i=x$O.getFloat32(),x$y=isNaN(x$i)?x$p:x$i,x$i=x$O.getFloat32(),x$w=isNaN(x$i)?x$P:x$i,this.subTextureDic[x$t]=x$Wb.create(x$E,x$L,x$f,x$p,x$P,-x$V,-x$Q,x$y,x$w),x$E.alphaTexture&&(this.subTextureDic[x$t].alphaTexture=x$Wb.create(x$E.alphaTexture,x$L,x$f,x$p,x$P,-x$V,-x$Q,x$y,x$w))}this._mainTexture=x$E;var x$$,x$D,x$o,x$M,x$r,x$k=x$O.getUint16();for(x$b=0;x$b<x$k;x$b++)(x$$=[]).push(x$O.getUint16()),x$$.push(x$O.getUint16()),x$$.push(x$O.getUint16()),x$$.push(x$O.getUint16()),this.aniSectionDic[x$b]=x$$;var x$B,x$S=x$O.getInt16(),x$Z={};for(x$b=0;x$b<x$S;x$b++)x$D=new x$Tb,0==x$b?x$B=x$D:x$D.root=x$B,x$D.d=x$n?-1:1,x$M=x$O.readUTFString(),x$r=x$O.readUTFString(),x$D.length=x$O.getFloat32(),1==x$O.getByte()&&(x$D.inheritRotation=!1),1==x$O.getByte()&&(x$D.inheritScale=!1),x$D.name=x$M,x$r&&((x$o=x$Z[x$r])?x$o.addChild(x$D):this.mRootBone=x$D),x$Z[x$M]=x$D,this.mBoneArr.push(x$D);this.tMatrixDataLen=x$O.getUint16();var x$J,x$W,x$T=x$O.getUint16(),x$q=Math.floor(x$T/this.tMatrixDataLen),x$U=this.srcBoneMatrixArr;for(x$b=0;x$b<x$q;x$b++)(x$J=new x$lb).scX=x$O.getFloat32(),x$J.skX=x$O.getFloat32(),x$J.skY=x$O.getFloat32(),x$J.scY=x$O.getFloat32(),x$J.x=x$O.getFloat32(),x$J.y=x$O.getFloat32(),8===this.tMatrixDataLen&&(x$J.skewX=x$O.getFloat32(),x$J.skewY=x$O.getFloat32()),x$U.push(x$J),(x$D=this.mBoneArr[x$b]).transform=x$J;var x$G,x$z=x$O.getUint16(),x$a=0;for(x$b=0;x$b<x$z;x$b++){for(x$W=new x$db,x$a=x$O.getUint16(),x$_=0;x$_<x$a;x$_++)x$W.boneNames.push(x$O.readUTFString()),x$W.boneIndexs.push(x$O.getInt16());x$W.name=x$O.readUTFString(),x$W.targetBoneName=x$O.readUTFString(),x$W.targetBoneIndex=x$O.getInt16(),x$W.bendDirection=x$O.getFloat32(),x$W.mix=x$O.getFloat32(),x$W.isSpine=x$n,this.ikArr.push(x$W)}var x$K,x$d=x$O.getUint16(),x$I=0;for(x$b=0;x$b<x$d;x$b++){for(x$G=new x$ub,x$I=x$O.getUint16(),x$_=0;x$_<x$I;x$_++)x$G.boneIndexs.push(x$O.getInt16());x$G.name=x$O.getUTFString(),x$G.targetIndex=x$O.getInt16(),x$G.rotateMix=x$O.getFloat32(),x$G.translateMix=x$O.getFloat32(),x$G.scaleMix=x$O.getFloat32(),x$G.shearMix=x$O.getFloat32(),x$G.offsetRotation=x$O.getFloat32(),x$G.offsetX=x$O.getFloat32(),x$G.offsetY=x$O.getFloat32(),x$G.offsetScaleX=x$O.getFloat32(),x$G.offsetScaleY=x$O.getFloat32(),x$G.offsetShearY=x$O.getFloat32(),this.tfArr.push(x$G)}var x$g=x$O.getUint16(),x$F=0;for(x$b=0;x$b<x$g;x$b++){for((x$K=new x$Ib).name=x$O.readUTFString(),x$F=x$O.getUint16(),x$_=0;x$_<x$F;x$_++)x$K.bones.push(x$O.getInt16());x$K.target=x$O.readUTFString(),x$K.positionMode=x$O.readUTFString(),x$K.spacingMode=x$O.readUTFString(),x$K.rotateMode=x$O.readUTFString(),x$K.offsetRotation=x$O.getFloat32(),x$K.position=x$O.getFloat32(),x$K.spacing=x$O.getFloat32(),x$K.rotateMix=x$O.getFloat32(),x$K.translateMix=x$O.getFloat32(),this.pathArr.push(x$K)}var x$A,x$u,x$l,x$N,x$X,x$Y=0,x$m=0,x$e=0,x$v=NaN,x$H=0,x$j=x$O.getInt16();for(x$b=0;x$b<x$j;x$b++){var x$bb=x$O.getUint8(),x$_b={};this.deformAniArr.push(x$_b);for(var x$sb=0;x$sb<x$bb;x$sb++)for((x$A=new x$Ub).skinName=x$O.getUTFString(),x$_b[x$A.skinName]=x$A,x$Y=x$O.getInt16(),x$_=0;x$_<x$Y;x$_++)for(x$u=new x$Gb,x$A.deformSlotDataList.push(x$u),x$m=x$O.getInt16(),x$s=0;x$s<x$m;x$s++)for(x$l=new x$zb,x$u.deformSlotDisplayList.push(x$l),x$l.slotIndex=x$O.getInt16(),x$l.attachment=x$O.getUTFString(),x$e=x$O.getInt16(),x$h=0;x$h<x$e;x$h++)for(1==x$O.getByte()?x$l.tweenKeyList.push(!0):x$l.tweenKeyList.push(!1),x$v=x$O.getFloat32(),x$l.timeList.push(x$v),x$N=[],x$l.vectices.push(x$N),x$H=x$O.getInt16(),x$x=0;x$x<x$H;x$x++)x$N.push(x$O.getFloat32())}var x$hb,x$xb,x$nb=x$O.getInt16(),x$Eb=0,x$Cb=0;for(x$b=0;x$b<x$nb;x$b++){for(x$Eb=x$O.getInt16(),x$X=[],x$_=0;x$_<x$Eb;x$_++){for((x$hb=new x$ab).time=x$O.getFloat32(),x$Cb=x$O.getInt16(),x$s=0;x$s<x$Cb;x$s++)x$hb.drawOrder.push(x$O.getInt16());x$X.push(x$hb)}this.drawOrderAniArr.push(x$X)}var x$Ob,x$Lb=x$O.getInt16(),x$fb=0;for(x$b=0;x$b<x$Lb;x$b++){for(x$fb=x$O.getInt16(),x$xb=[],x$_=0;x$_<x$fb;x$_++)(x$Ob=new x$Kb).name=x$O.getUTFString(),x$Ob.intValue=x$O.getInt32(),x$Ob.floatValue=x$O.getFloat32(),x$Ob.stringValue=x$O.getUTFString(),x$Ob.time=x$O.getFloat32(),x$xb.push(x$Ob);this.eventAniArr.push(x$xb)}var x$pb=x$O.getInt16();if(0<x$pb)for(this.attachmentNames=[],x$b=0;x$b<x$pb;x$b++)this.attachmentNames.push(x$O.getUTFString());var x$Pb,x$Vb,x$Qb=x$O.getInt16();for(x$b=0;x$b<x$Qb;x$b++)(x$Pb=new x$qb).name=x$O.readUTFString(),x$Pb.parent=x$O.readUTFString(),x$Pb.attachmentName=x$O.readUTFString(),x$Pb.srcDisplayIndex=x$Pb.displayIndex=x$O.getInt16(),(x$Pb.templet=this).boneSlotDic[x$Pb.name]=x$Pb,null==(x$Vb=this.bindBoneBoneSlotDic[x$Pb.parent])&&(this.bindBoneBoneSlotDic[x$Pb.parent]=x$Vb=[]),x$Vb.push(x$Pb),this.boneSlotArray.push(x$Pb);var x$yb,x$wb,x$ib,x$Rb=x$O.readUTFString().split("\n"),x$tb=0,x$cb=x$O.getUint8(),x$$b=0,x$Db=0,x$ob=0,x$Mb=0,x$rb=0,x$kb=0,x$Bb=0;for(x$b=0;x$b<x$cb;x$b++){for((x$yb=new x$gb).name=x$Rb[x$tb++],x$$b=x$O.getUint8(),x$_=0;x$_<x$$b;x$_++){for((x$wb=new x$Ab).name=x$Rb[x$tb++],x$Pb=this.boneSlotDic[x$wb.name],x$Db=x$O.getUint8(),x$s=0;x$s<x$Db;x$s++){if(x$ib=new x$Fb,this.skinSlotDisplayDataArr.push(x$ib),x$ib.name=x$Rb[x$tb++],x$ib.attachmentName=x$Rb[x$tb++],x$ib.transform=new x$lb,x$ib.transform.scX=x$O.getFloat32(),x$ib.transform.skX=x$O.getFloat32(),x$ib.transform.skY=x$O.getFloat32(),x$ib.transform.scY=x$O.getFloat32(),x$ib.transform.x=x$O.getFloat32(),x$ib.transform.y=x$O.getFloat32(),x$wb.displayArr.push(x$ib),x$ib.width=x$O.getFloat32(),x$ib.height=x$O.getFloat32(),x$ib.type=x$O.getUint8(),x$ib.verLen=x$O.getUint16(),0<(x$S=x$O.getUint16()))for(x$ib.bones=[],x$h=0;x$h<x$S;x$h++){var x$Sb=x$O.getUint16();x$ib.bones.push(x$Sb)}if(0<(x$ob=x$O.getUint16()))for(x$ib.uvs=[],x$h=0;x$h<x$ob;x$h++)x$ib.uvs.push(x$O.getFloat32());if(0<(x$Mb=x$O.getUint16()))for(x$ib.weights=[],x$h=0;x$h<x$Mb;x$h++)x$ib.weights.push(x$O.getFloat32());if(0<(x$rb=x$O.getUint16()))for(x$ib.triangles=[],x$h=0;x$h<x$rb;x$h++)x$ib.triangles.push(x$O.getUint16());if(0<(x$kb=x$O.getUint16()))for(x$ib.vertices=[],x$h=0;x$h<x$kb;x$h++)x$ib.vertices.push(x$O.getFloat32());if(0<(x$Bb=x$O.getUint16()))for(x$ib.lengths=[],x$h=0;x$h<x$Bb;x$h++)x$ib.lengths.push(x$O.getFloat32())}x$yb.slotArr.push(x$wb)}this.skinDic[x$yb.name]=x$yb,this.skinDataArray.push(x$yb)}1==x$O.getUint8()?(this.yReverseMatrix=new x$Jb(1,0,0,-1,0,0),x$B&&x$B.setTempMatrix(this.yReverseMatrix)):x$B&&x$B.setTempMatrix(new x$Jb),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},x$b.getTexture=function(x$b){var x$_=this.subTextureDic[x$b];return x$_||(x$_=this.subTextureDic[x$b.substr(0,x$b.length-1)]),null==x$_?this._mainTexture:x$_},x$b.showSkinByIndex=function(x$b,x$_,x$s){if(void 0===x$s&&(x$s=!0),x$_<0&&x$_>=this.skinDataArray.length)return!1;var x$h,x$x,x$n=0,x$E=0,x$C=this.skinDataArray[x$_];if(x$C){for(x$n=0,x$E=x$C.slotArr.length;x$n<x$E;x$n++)(x$x=x$C.slotArr[x$n])&&(x$h=x$b[x$x.name])&&(x$h.showSlotData(x$x,x$s),x$s&&"undefined"!=x$h.attachmentName&&"null"!=x$h.attachmentName?x$h.showDisplayByName(x$h.attachmentName):x$h.showDisplayByIndex(x$h.displayIndex));return!0}return!1},x$b.getSkinIndexByName=function(x$b){for(var x$_=0,x$s=this.skinDataArray.length;x$_<x$s;x$_++)if(this.skinDataArray[x$_].name==x$b)return x$_;return-1},x$b.getGrahicsDataWithCache=function(x$b,x$_){return this._graphicsCache[x$b][x$_]},x$b.setGrahicsDataWithCache=function(x$b,x$_,x$s){this._graphicsCache[x$b][x$_]=x$s},x$b.destroy=function(){var x$b;for(var x$_ in this._isDestroyed=!0,this.subTextureDic)(x$b=this.subTextureDic[x$_])&&x$b.destroy();for(x$_ in this._textureDic)(x$b=this._textureDic[x$_])&&x$b.destroy();for(var x$s=0,x$h=this.skinSlotDisplayDataArr.length;x$s<x$h;x$s++)this.skinSlotDisplayDataArr[x$s].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete x$x.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},x$b.getAniNameByIndex=function(x$b){var x$_=this.getAnimation(x$b);return x$_?x$_.name:null},x$n(0,x$b,"rate",function(){return this._rate},function(x$b){this._rate=x$b}),x$x.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",x$x.TEMPLET_DICTIONARY=null,x$x}(x$U)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(x$b,x$_){"use strict";for(var x$s in Object.defineProperty(x$_,"__esModule",{value:!0}),Laya){var x$h=Laya[x$s];x$h&&x$h.__isclass&&(x$_[x$s]=x$h)}});