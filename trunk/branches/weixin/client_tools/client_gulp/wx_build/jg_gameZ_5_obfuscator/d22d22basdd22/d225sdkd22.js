var F=wx.$D;import sdk from"../utils/sq_xgamesdk_1.0";var config={game_id:F[561795],game_pkg:F[561796],partner_label:F[561797],partner_id:F[561798],game_ver:F[561799],is_auth:!1,partner_game_id:10227,partner_package_name:F[561800],partner_package_version:1};window.config=config;var D1W24IX=D1W4XI2();var HOST=F[561801];var D1W24XI=null;var D1W4IX2=null;var partner_user_data={};var user_invite_by_activity=null;function D1W4XI2(){var a={};return{order_data:{},init:function(e,t){e=e&&e.game_ver?e.game_ver:0;console.log(F[561802]);var r=this;var n;n=wx.getStorageSync(F[561803])?0:(n=r.uuid(16,32),wx.setStorageSync(F[561803],n),1),wx.getStorageSync(F[561804])||(a=r.uuid(16,32),wx.setStorageSync(F[561804],a));var a=wx.getLaunchOptionsSync();var i=a.scene||"";n&&a.query&&a.query.ad_code&&wx.setStorageSync(F[561805],a.query.ad_code),r.log(F[561806],{install:n,scene:i}),wx.showShareMenu();r=a.query&&a.query.invite?a.query.invite:"";var o=a.query&&a.query.invite_type?a.query.invite_type:"";var s=a.query&&a.query.cp_activity_id?a.query.cp_activity_id:"";s||(o=(s=a.query&&a.query.shareMessageToFriendScene?a.query.shareMessageToFriendScene:"")?F[561807]:""),s&&(user_invite_by_activity={invite:r,invite_type:o,is_new:n,scene:i,cp_activity_id:s}),r&&(D1W4IX2={invite:r,invite_type:o,is_new:n,scene:i}),e&&(this.checkGameVersion(e,function(e){t&&t(e)}),sdk.D12I({game_id:config.partner_game_id,package_name:config.partner_package_name,package_version:config.partner_package_version,game_version:e},function(e,t,r){console.log(e,t,r)}))},login:function(e,t){var n=this;console.log(F[561808]),a[F[560696]]=typeof t==F[561003]?t:null,sdk.sdkLogin(function(e,t,r){console.log(F[561809]),console.log(e,t,r),n.do_login(t)})},do_login:function(e){var r=this;var t=r.getPublicData();if(t[F[561810]]=JSON.stringify(e),D1W4IX2&&typeof D1W4IX2==F[560901])for(var n in D1W4IX2)t[n]=D1W4IX2[n];wx.request({url:F[561811]+HOST+F[561812],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:t,success:function(e){if(console.log(F[561813],e),200===e.statusCode){e=e.data;if(e.state){partner_user_data.openid=e.data.ext;try{wx.setStorageSync(F[561814],e.data.sdk_token),wx.setStorageSync(F[561815],e.data.user_id),wx.setStorageSync(F[561816],e.data.username),e.data.ext&&wx.setStorageSync(F[561817],e.data.ext)}catch(e){}var t={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};a[F[560696]]&&a[F[560696]](0,t)}else a[F[560696]]&&a[F[560696]](1,{errMsg:e.msg});r.getShareInfo(F[561818],function(e){console.log(F[561819]),wx.onShareAppMessage(function(){return r.logStartShare(F[561818]),{title:e.title,imageUrl:e.img,query:e.query}})})}else a[F[560696]]&&a[F[560696]](1,{errMsg:F[561820]})}})},share:function(e){a[F[560790]]=typeof callback==F[561003]?callback:null;var t=e.type||F[560790];var r=e.cp_activity_id||"";console.log(F[561821]+t);var n=this;this.getShareInfo(t,function(e){""!=r&&""!=e.query&&(e.query=e.query+F[561822]+r),n.logStartShare(t),n.logSheyeShare(),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logSheyeShare:function(){var t={openid:partner_user_data.openid,server_id:D1W24XI.server_id};wx.request({url:F[561811]+HOST+F[561823]+config.partner_id+"/"+config.game_pkg,method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:t,success:function(e){console.log(F[561824]+JSON.stringify(t)),console.log(F[561825]+JSON.stringify(e))}})},logStartShare:function(e){var t=wx.getStorageSync(F[561814]);wx.request({url:F[561811]+HOST+F[561826],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,server_id:D1W24XI?D1W24XI.server_id:"",role_id:D1W24XI?D1W24XI.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,r){console.log(F[561827]);wx.getStorageSync(F[561814]);wx.request({url:F[561811]+HOST+F[561828],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var t;console.log(F[561829]),console.log(e),200==e.statusCode&&(t=e.data).state?r&&r(t.data):r&&r({develop:0})}})},getShareInfo:function(e,t){console.log(F[561830]);var r=wx.getStorageSync(F[561814]);wx.request({url:F[561811]+HOST+F[561831],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,type:e,server_id:D1W24XI?D1W24XI.server_id:"",role_id:D1W24XI?D1W24XI.role_id:"",no_log:1},success:function(e){console.log(F[561832]),console.log(e),200==e.statusCode?(e=e.data).state?t&&t(e.data):a[F[560790]]&&a[F[560790]](1,{errMsg:F[561833]+e.msg}):a[F[560790]]&&a[F[560790]](1,{errMsg:F[561834]})}})},updateShare:function(e,t,r,n,a,i){console.log(F[561835]);var o=wx.getStorageSync(F[561814]);wx.request({url:F[561811]+HOST+F[561836],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,invite:e,invite_type:t,is_new:r,role_id:n,sever_id:a,scene:i},success:function(e){console.log(F[561837]),console.log(e)}})},msgCheck:function(e,n){console.log(F[561838]);var a={};sdk.sdkMsgCheck(e,function(e,t,r){console.log(e,t,r),a.data={},0==t.is_sec?(a.statusCode=200,a.data.state=1):(a.statusCode=0,a.data.state=0),n&&n(a)})},pay:function(e,t){this.startPay(e,t)},startPay:function(e,t){console.log(F[561839],e);a[F[560772]]=typeof t==F[561003]?t:null;t=wx.getStorageSync(F[561814]);var r=wx.getStorageSync(F[561817]);var n;t||r?(n=wx.getSystemInfoSync(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:t,session_key:r,platform:n.platform},this.order_data=e,(t=this.getPublicData())[F[561841]]=JSON.stringify(e),wx.request({url:F[561811]+HOST+F[561842],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:t,success:function(e){console.log(F[561843],e),200===e.statusCode?(e=e.data).state&&e.data.pay_data?(console.log(F[561844]+JSON.stringify(e.data.pay_data)),sdk.sdkPay(e.data.pay_data,function(e,t,r){console.log(F[561845]),console.log(e,t,r)})):a[F[560772]]&&a[F[560772]](1,{errMsg:e.errMsg}):a[F[560696]]&&a[F[560696]](1,{errMsg:F[561820]})}})):a[F[560772]]&&a[F[560772]](1,{errMsg:F[561840]})},logCreateRole:function(e){var t=wx.getStorageSync(F[561815]);var r=wx.getStorageSync(F[561816]);var n={};var a,i,o;n[F[561846]]=t,n[F[561847]]=r,n[F[561848]]=e.roleid,n[F[561849]]=e.rolelevel,n[F[561850]]=e.rolename,n[F[560022]]=e.serverid,e.roleid&&e.serverid&&(D1W24XI={role_id:e.roleid,server_id:e.serverid}),this.log(F[560149],n),user_invite_by_activity&&(r=user_invite_by_activity.scene,n=user_invite_by_activity.is_new,a=user_invite_by_activity.invite,i=user_invite_by_activity&&user_invite_by_activity.invite_type?user_invite_by_activity.invite_type:"",o=user_invite_by_activity.cp_activity_id,t={uid:t,role_id:e.roleid,role_name:e.rolename,server_id:e.serverid,server_name:e.servername,game_id:config.game_id,partner_id:config.partner_id,game_pkg:config.game_pkg,scene:r,is_new:n,invite_code:a,invite_type:i,cp_activity_id:o},wx.request({url:F[561811]+HOST+F[561851],method:F[560665],dataType:F[561250],header:{"content-type":F[560830]},data:t,success:function(e){console.log(F[561852]+JSON.stringify(e))}}));r=Date.parse(new Date).toString();r=r.substr(0,10),sdk.sdkRole({role_id:e.roleid,role_level:0,role_name:e.rolename,server_id:e.serverid,server_name:e.servername,update_time:r})},subscribeMessage:function(t,e){console.log(F[561853]+t),a[F[560801]]=typeof e==F[561003]?e:null;e={template:t[0],role_id:D1W24XI?D1W24XI.role_id:"",tpl_type:2};Sygame.syGetSubscribe(e).then(e=>{1001==e.status&&(e.errMsg=F[560803],e[t[0]]=e.type),a[F[560801]]&&a[F[560801]](e)})},logEnterGame:function(e){var t=wx.getStorageSync(F[561815]);var r=wx.getStorageSync(F[561816]);var n={};n[F[561846]]=t,n[F[561847]]=r,n[F[561848]]=e.roleid,n[F[561849]]=e.rolelevel,n[F[561850]]=e.rolename,n[F[560022]]=e.serverid,e.roleid&&e.serverid&&(D1W24XI={role_id:e.roleid,server_id:e.serverid}),this.log(F[561854],n),D1W4IX2&&this.updateShare(D1W4IX2.invite,D1W4IX2.invite_type,D1W4IX2.is_new,e.roleid,e.serverid,D1W4IX2.scene)},logRoleUpLevel:function(e){var t=wx.getStorageSync(F[561815]);var r=wx.getStorageSync(F[561816]);var n={};n[F[561846]]=t,n[F[561847]]=r,n[F[561848]]=e.roleid,n[F[561849]]=e.rolelevel,n[F[561850]]=e.rolename,n[F[560022]]=e.serverid,e.roleid&&e.serverid&&(D1W24XI={role_id:e.roleid,server_id:e.serverid}),this.log(F[561855],n);t=Date.parse(new Date).toString();t=t.substr(0,10),sdk.sdkRole({role_id:e.roleid,role_level:e.rolelevel,role_name:e.rolename,server_id:e.serverid,server_name:e.servername,update_time:t})},uuid:function(e,t){var r=F[561856].split("");var n,a=[];var i;if(e=e||r.length,t)for(n=0;n<t;n++)a[n]=r[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(i=0|16*Math.random(),a[n]=r[19==n?3&i|8:i]);return a.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var t=wx.getStorageSync(F[561803]);var r=wx.getStorageSync(F[561804]);var n=wx.getStorageSync(F[561805]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:n,is_from_min:1,uuid:t,idfv:r,dname:e.model,mac:F[561857],net_type:0==e.wifiSignal?"4G":F[561858],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:e.platform==F[560109]?1:2}},log:function(e,t){var r=this.getPublicData();for(var n in t)r[n]=t[n];console.log(F[561859]+e),console.log(r),wx.request({url:F[561811]+HOST+F[561860]+e+F[561861]+encodeURIComponent(JSON.stringify(r))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},setMessageToFriendQuery:function(e,t){e=e.activity_id;e=wx.setMessageToFriendQuery({shareMessageToFriendScene:e});t&&t(e)},getFriendShareInfo:function(t){this.getShareInfo(F[561807],function(e){t&&t({title:e.title,img:e.img})})}}}function run(e,t,r){e in D1W24IX&&D1W24IX[e](t,r)}exports.init=function(e,t){run(F[560501],e,t)},exports.login=function(e){run(F[560696],"",e)},exports.pay=function(e,t){run(F[560772],e,t)},exports.subscribeMessage=function(e,t){run(F[560801],e,t)},exports.openService=function(){run(F[560791])},exports.logCreateRole=function(e,t,r,n,a){run(F[560785],{serverid:e,servername:t,roleid:r,rolename:n,rolelevel:a})},exports.logEnterGame=function(e,t,r,n,a,i,o){o=o&&o.rolepower?o.rolepower:0;run(F[560787],{serverid:e,servername:t,roleid:r,rolename:n,rolelevel:a,rolecreatetime:i,rolepower:o})},exports.logRoleUpLevel=function(e,t,r,n,a,i,o){o=o&&o.rolepower?o.rolepower:0;run(F[560789],{serverid:e,servername:t,roleid:r,rolename:n,rolelevel:a,rolecreatetime:i,rolepower:o})},exports.share=function(e,t){t=t&&t.activity_id?t.activity_id:"";run(F[560790],{type:e,cp_activity_id:t})},exports.msgCheck=function(e,t){run(F[560646],e,t)},exports.shareConfig=function(e){run(F[561862],e)},exports.clickBoxGame=function(e){run(F[561863],e)},exports.downloadClient=function(){run(F[561864])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(F[561865])};