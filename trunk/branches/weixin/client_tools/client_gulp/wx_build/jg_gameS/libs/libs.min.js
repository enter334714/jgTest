var Laya=window.Laya=function(s$x,s$d){var s$t={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(s$d,s$L){return 1==arguments.length?s$t.__presubstr.call(this,s$d):s$t.__presubstr.call(this,s$d,0<s$L?s$L:this.length+s$L)},__init:function(s$d){s$d.forEach(function(s$d){s$d.__init$&&s$d.__init$()})},__isClass:function(s$d){return s$d&&(s$d.__isclass||s$d==Object||s$d==String||s$d==Array)},__newvec:function(s$d,s$L){var s$l=[];s$l.length=s$d;for(var s$Z=0;s$Z<s$d;s$Z++)s$l[s$Z]=s$L;return s$l},__extend:function(s$d,s$L){for(var s$l in s$L)if(s$L.hasOwnProperty(s$l)){var s$Z=Object.getOwnPropertyDescriptor(s$L,s$l),s$h=s$Z.get,s$_=s$Z.set;s$h||s$_?s$h&&s$_?Object.defineProperty(s$d,s$l,s$Z):(s$h&&Object.defineProperty(s$d,s$l,s$h),s$_&&Object.defineProperty(s$d,s$l,s$_)):s$d[s$l]=s$L[s$l]}function s$N(){s$t.un(this,"constructor",s$d)}s$N.prototype=s$L.prototype,s$d.prototype=new s$N,s$t.un(s$d.prototype,"__imps",s$t.__copy({},s$L.prototype.__imps))},__copy:function(s$d,s$L){if(!s$L)return null;for(var s$l in s$d=s$d||{},s$L)s$d[s$l]=s$L[s$l];return s$d},__package:function(s$d,s$L){if(!s$t.__packages[s$d]){s$t.__packages[s$d]=!0;var s$l=s$x,s$Z=s$d.split(".");if(1<s$Z.length)for(var s$h=0,s$_=s$Z.length-1;s$h<s$_;s$h++){var s$N=s$l[s$Z[s$h]];s$l=s$N||(s$l[s$Z[s$h]]={})}s$l[s$Z[s$Z.length-1]]||(s$l[s$Z[s$Z.length-1]]=s$L||{})}},__hasOwnProperty:function(s$d,s$L){return s$L=s$L||this,Object.hasOwnProperty.call(s$L,s$d)||function s$d(s$L,s$l){if(Object.hasOwnProperty.call(s$l.prototype,s$L))return!0;var s$Z=s$l.prototype.__super;return null==s$Z?null:s$d(s$L,s$Z)}(s$d,s$L.__class)},__typeof:function(s$d,s$L){if(!s$d||!s$L)return!1;if(s$L===String)return"string"==typeof s$d;if(s$L===Number)return"number"==typeof s$d;if(s$L.__interface__)s$L=s$L.__interface__;else if("string"!=typeof s$L)return s$d instanceof s$L;return s$d.__imps&&s$d.__imps[s$L]||s$d.__class==s$L},__as:function(s$d,s$L){return this.__typeof(s$d,s$L)?s$d:null},__int:function(s$d){return s$d?parseInt(s$d):0},interface:function(s$d,s$L){s$t.__package(s$d,{});var s$l=s$t.__internals,s$Z=s$l[s$d]=s$l[s$d]||{self:s$d};if(s$L){var s$h=s$L.split(",");s$Z.extend=[];for(var s$_=0;s$_<s$h.length;s$_++){var s$N=s$h[s$_];s$l[s$N]=s$l[s$N]||{self:s$N},s$Z.extend.push(s$l[s$N])}}var s$m=s$x,s$u=s$d.split(".");for(s$_=0;s$_<s$u.length-1;s$_++)s$m=s$m[s$u[s$_]];s$m[s$u[s$u.length-1]]={__interface__:s$d}},class:function(s$d,s$L,s$l,s$Z){if(s$l&&s$t.__extend(s$d,s$l),s$L)if(s$t.__package(s$L,s$d),s$t.__classmap[s$L]=s$d,0<s$L.indexOf(".")){if(0==s$L.indexOf("laya.")){var s$h=s$L.split(".");s$Z=s$Z||s$h[s$h.length-1],s$t[s$Z]&&console.log("Warning!,this class["+s$Z+"] already exist:",s$t[s$Z]),s$t[s$Z]=s$d}}else"Main"==s$L?s$x.Main=s$d:"MainWX"==s$L?s$x.MainWX=s$d:(s$t[s$L]&&console.log("Error!,this class["+s$L+"] already exist:",s$t[s$L]),s$t[s$L]=s$d);var s$_=s$t.un,s$N=s$d.prototype;s$_(s$N,"hasOwnProperty",s$t.__hasOwnProperty),s$_(s$N,"__class",s$d),s$_(s$N,"__super",s$l),s$_(s$N,"__className",s$L),s$_(s$d,"__super",s$l),s$_(s$d,"__className",s$L),s$_(s$d,"__isclass",!0),s$_(s$d,"super",function(s$d){this.__super.call(s$d)})},imps:function(s$d,s$L){if(!s$L)return null;var s$h=s$d.__imps||s$t.un(s$d,"__imps",{});function s$_(s$d){var s$L,s$l;if((s$L=s$t.__internals[s$d])&&(s$h[s$d]=!0,s$l=s$L.extend))for(var s$Z=0;s$Z<s$l.length;s$Z++)s$_(s$l[s$Z].self)}for(var s$l in s$L)s$_(s$l)},superSet:function(s$d,s$L,s$l,s$Z){var s$h=s$d.prototype["_$set_"+s$l];s$h&&s$h.call(s$L,s$Z)},superGet:function(s$d,s$L,s$l){var s$Z=s$d.prototype["_$get_"+s$l];return s$Z?s$Z.call(s$L):null},getset:function(s$d,s$L,s$l,s$Z,s$h){s$d?(s$Z&&(s$L["_$GET_"+s$l]=s$Z),s$h&&(s$L["_$SET_"+s$l]=s$h)):(s$Z&&s$t.un(s$L,"_$get_"+s$l,s$Z),s$h&&s$t.un(s$L,"_$set_"+s$l,s$h)),s$Z&&s$h?Object.defineProperty(s$L,s$l,{get:s$Z,set:s$h,enumerable:!1,configurable:!0}):(s$Z&&Object.defineProperty(s$L,s$l,{get:s$Z,enumerable:!1,configurable:!0}),s$h&&Object.defineProperty(s$L,s$l,{set:s$h,enumerable:!1,configurable:!0}))},static:function(s$l,s$Z){for(var s$h=0,s$d=s$Z.length;s$h<s$d;s$h+=2)if("length"==s$Z[s$h])s$l.length=s$Z[s$h+1].call(s$l);else{function s$L(){var s$L=s$Z[s$h],s$d=s$Z[s$h+1];Object.defineProperty(s$l,s$L,{get:function(){return delete this[s$L],this[s$L]=s$d.call(this)},set:function(s$d){delete this[s$L],this[s$L]=s$d},enumerable:!0,configurable:!0})}s$L()}},un:function(s$d,s$L,s$l){return s$l||(s$l=s$d[s$L]),s$t.__propun.value=s$l,Object.defineProperty(s$d,s$L,s$t.__propun),s$l},uns:function(s$L,s$d){s$d.forEach(function(s$d){s$t.un(s$L,s$d)})}};return s$x.console=s$x.console||{log:function(){}},s$x.trace=s$x.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),s$t}(window,document);!function(s$d,s$L,s$l){s$l.un,s$l.uns,s$l.static,s$l.class,s$l.getset,s$l.__newvec}(window,document,Laya),function(s$N,s$L,s$$){s$$.un,s$$.uns;var s$u=s$$.static,s$t=s$$.class,s$c=s$$.getset;s$$.__newvec;s$$.interface("laya.runtime.IMarket"),s$$.interface("laya.filters.IFilter"),s$$.interface("laya.display.ILayout"),s$$.interface("laya.resource.IDispose"),s$$.interface("laya.runtime.IPlatform"),s$$.interface("laya.resource.IDestroy"),s$$.interface("laya.runtime.IConchNode"),s$$.interface("laya.filters.IFilterAction"),s$$.interface("laya.runtime.ICPlatformClass"),s$$.interface("laya.resource.ICreateResource"),s$$.interface("laya.runtime.IConchRenderObject"),s$$.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var s$F=function(){function s$_(){}return s$t(s$_,"laya.utils.RunDriver"),s$_.FILTER_ACTIONS=[],s$_.pixelRatio=-1,s$_._charSizeTestDiv=null,s$_.now=function(){return Date.now()},s$_.getWindow=function(){return s$N},s$_.getPixelRatio=function(){if(s$_.pixelRatio<0){var s$d=s$i.context,s$L=s$d.backingStorePixelRatio||s$d.webkitBackingStorePixelRatio||s$d.mozBackingStorePixelRatio||s$d.msBackingStorePixelRatio||s$d.oBackingStorePixelRatio||s$d.backingStorePixelRatio||1;(s$_.pixelRatio=(s$i.window.devicePixelRatio||1)/s$L)<1&&(s$_.pixelRatio=1)}return s$_.pixelRatio},s$_.getIncludeStr=function(s$d){return null},s$_.createShaderCondition=function(s$d){var s$L="(function() {return "+s$d+";})";return s$$._runScript(s$L)},s$_.fontMap=[],s$_.measureText=function(s$d,s$L){var s$l=s$_.hanzi.test(s$d);if(s$l&&s$_.fontMap[s$L])return s$_.fontMap[s$L];var s$Z=s$i.context;s$Z.font=s$L;var s$h=s$Z.measureText(s$d);return s$l&&(s$_.fontMap[s$L]=s$h),s$h},s$_.getWebGLContext=function(s$d){},s$_.beginFlush=function(){},s$_.endFinish=function(){},s$_.addToAtlas=null,s$_.flashFlushImage=function(s$d){},s$_.drawToCanvas=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$wd.create("2D"),s$m=new s$X(s$l,s$Z,s$N);return s$j.renders[s$L]._fun(s$d,s$m,s$h,s$_),s$N},s$_.createParticleTemplate2D=null,s$_.createGLTextur=null,s$_.createWebGLContext2D=null,s$_.changeWebGLSize=function(s$d,s$L){},s$_.createRenderSprite=function(s$d,s$L){return new s$j(s$d,s$L)},s$_.createFilterAction=function(s$d){return new s$w},s$_.createGraphics=function(){return new s$q},s$_.clear=function(s$d){s$H._context.ctx.clear()},s$_.cancelLoadByUrl=function(s$d){},s$_.clearAtlas=function(s$d){},s$_.isAtlas=function(s$d){return!1},s$_.addTextureToAtlas=function(s$d){},s$_.getTexturePixels=function(s$d,s$L,s$l,s$Z,s$h){return null},s$_.skinAniSprite=function(){return null},s$_.update3DLoop=function(){},s$u(s$_,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),s$_}(),s$Z=(s$c(1,s$$,"alertGlobalError",null,function(s$d){var s$_=0;s$i.window.onerror=s$d?function(s$d,s$L,s$l,s$Z,s$h){s$_++<5&&s$h&&alert(s$h.stack||s$h)}:null}),s$$.init=function(s$d,s$L,s$l){for(var s$Z=[],s$h=2,s$_=arguments.length;s$h<s$_;s$h++)s$Z.push(arguments[s$h]);if(!s$$._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=s$$._arrayBufferSlice),s$$._isinit=!0,s$i.__init__(),s$R.__init__(),s$q.__init__(),s$$.timer=new s$v,s$$.scaleTimer=new s$v,s$$.loader=new s$ud,s$W.__init__(),s$h=0;for(var s$N=s$Z.length;s$h<s$N;s$h++)s$Z[s$h].enable&&s$Z[s$h].enable();return s$Y.__init__(),s$m.__init__(),s$o.__init__(),s$B.beginCheck(),s$$._currentStage=s$$.stage=new s$kd,s$$.stage.conchModel&&s$$.stage.conchModel.setRootNode(),s$$._getUrlPath(),s$$.render=new s$H(0,0),s$$.stage.size(s$d,s$L),s$j.__init__(),s$b.__init__(),s$r.instance.__init__(s$$.stage,s$H.canvas),s$Ad.__init__(),s$g.autoStopMusic=!0,s$V.__init__(),s$H.canvas}},s$$._getUrlPath=function(){var s$d=s$i.window.location,s$L=s$d.pathname;s$L=s$L&&":"==s$L.charAt(2)?s$L.substring(1):s$L,s$p.rootPath=s$p.basePath=s$p.getPath("file:"==s$d.protocol?s$L:s$d.protocol+"//"+s$d.host+s$d.pathname)},s$$._arrayBufferSlice=function(s$d,s$L){var s$l=new Uint8Array(this,s$d,s$L-s$d),s$Z=new Uint8Array(s$l.length);return s$Z.set(s$l),s$Z.buffer},s$$._runScript=function(s$d){return s$i.window[s$$._evcode](s$d)},s$$.stage=null,s$$.timer=null,s$$.scaleTimer=null,s$$.loader=null,s$$.version="1.8.6",s$$.render=null,s$$._currentStage=null,s$$._isinit=!1,s$$.isDebug=!1,s$$.MiniAdpter={init:function(){s$N.navigator&&s$N.navigator.userAgent&&-1<s$N.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},s$u(s$$,["conchMarket",function(){return this.conchMarket=s$N.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=s$N.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function s$d(){}return s$t(s$d,"Config"),s$d.WebGLTextCacheCount=500,s$d.atlasEnable=!1,s$d.showCanvasMark=!1,s$d.animationInterval=50,s$d.isAntialias=!1,s$d.isAlpha=!1,s$d.premultipliedAlpha=!0,s$d.isStencil=!0,s$d.preserveDrawingBuffer=!1,s$d}()),s$x=function(){function s$x(){this._events=null}s$t(s$x,"laya.events.EventDispatcher");var s$d=s$x.prototype;return s$d.hasListener=function(s$d){return!!(this._events&&this._events[s$d])},s$d.event=function(s$d,s$L){if(!this._events||!this._events[s$d])return!1;var s$l=this._events[s$d];if(s$l.lock)s$l.queue||(s$l.queue=[]),s$l.queue.push(s$L);else{var s$Z;for(s$l.lock=!0,s$l.cursor=s$l.head;s$l.cursor;)s$Z=s$l.cursor,s$l.cursor=s$Z.next,s$Z.once&&s$x.delNode(s$l,s$Z),null!=s$L?s$Z.args?s$Z.method.apply(s$Z.caller,s$Z.args.concat(s$L)):s$L instanceof Array?s$Z.method.apply(s$Z.caller,s$L):s$Z.method.call(s$Z.caller,s$L):s$Z.method.apply(s$Z.caller,s$Z.args),s$Z.once&&s$x.recoverHandler(s$Z);s$l.lock=!1,!s$l.head&&this._events&&this._events[s$d]==s$l&&delete this._events[s$d],s$l.queue&&s$l.queue.length&&this.event(s$d,s$l.queue.shift())}return!0},s$d.on=function(s$d,s$L,s$l,s$Z){return this._createListener(s$d,s$L,s$l,s$Z,!1)},s$d.once=function(s$d,s$L,s$l,s$Z){return this._createListener(s$d,s$L,s$l,s$Z,!0)},s$d._createListener=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=!0),s$_&&this.off(s$d,s$L,s$l,s$h);var s$N=s$x.createHandler(s$L||this,s$l,s$Z,s$h);this._events||(this._events={});var s$m=this._events,s$u=s$m[s$d];return s$u?s$u.tail?(s$N.prev=s$u.tail,s$u.tail.next=s$N,s$u.tail=s$N):s$u.head=s$u.tail=s$N:s$m[s$d]={head:s$N,tail:s$N,cursor:null,lock:!1},this},s$d.off=function(s$d,s$L,s$l,s$Z){if(void 0===s$Z&&(s$Z=!1),!this._events||!this._events[s$d])return this;for(var s$h=this._events[s$d],s$_=s$h.head;s$_;){if((!s$L||s$_.caller===s$L)&&s$_.method===s$l&&(!s$Z||s$_.once)){s$x.delNode(s$h,s$_),s$h.cursor==s$_&&(s$h.cursor=s$_.next),s$x.recoverHandler(s$_);break}s$_=s$_.next}return this},s$d.offAll=function(s$d){var s$L=this._events;if(!s$L)return this;if(s$d)this._recoverHandlers(s$L[s$d]),delete s$L[s$d];else{for(var s$l in s$L)this._recoverHandlers(s$L[s$l]);this._events=null}return this},s$d._recoverHandlers=function(s$d){if(s$d){for(var s$L=s$d.head;s$L;){s$x.delNode(s$d,s$L);var s$l=s$L.next;s$x.recoverHandler(s$L),s$L=s$l}s$d.cursor=null}},s$d.isMouseEvent=function(s$d){return s$x.MOUSE_EVENTS[s$d]},s$x.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},s$x.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},s$x.delNode=function(s$d,s$L){s$L.prev?s$L.prev.next=s$L.next:s$d.head=s$L.next,s$L.next?s$L.next.prev=s$L.prev:s$d.tail=s$L.prev},s$x.createHandler=function(s$d,s$L,s$l,s$Z){var s$h=s$x._freeHandler;return s$h?(s$x._freeCount--,s$x._freeHandler=s$h.next,s$h.caller=s$d,s$h.method=s$L,s$h.args=s$l,s$h.once=s$Z):s$h={caller:s$d,method:s$L,args:s$l,once:s$Z},s$h.prev=s$h.next=null,s$h},s$x.recoverHandler=function(s$d){s$d.caller=s$d.method=s$d.args=s$d.prev=null,s$d.next=s$x._freeHandler,s$x._freeHandler=s$d,s$x._freeCount++},s$x._freeHandler=null,s$x._freeCount=0,s$x}(),s$e=function(){function s$h(s$d,s$L,s$l,s$Z){this.once=!1,void(this._id=0)===s$Z&&(s$Z=!1),this.setTo(s$d,s$L,s$l,s$Z)}s$t(s$h,"laya.utils.Handler");var s$d=s$h.prototype;return s$d.setTo=function(s$d,s$L,s$l,s$Z){return this._id=s$h._gid++,this.caller=s$d,this.method=s$L,this.args=s$l,this.once=s$Z,this},s$d.run=function(){if(null==this.method)return null;var s$d=this._id,s$L=this.method.apply(this.caller,this.args);return this._id===s$d&&this.once&&this.recover(),s$L},s$d.runWith=function(s$d){if(null==this.method)return null;var s$L=this._id;if(null==s$d)var s$l=this.method.apply(this.caller,this.args);else s$l=this.args||s$d.unshift?this.args?this.method.apply(this.caller,this.args.concat(s$d)):this.method.apply(this.caller,s$d):this.method.call(this.caller,s$d);return this._id===s$L&&this.once&&this.recover(),s$l},s$d.clear=function(){return this.caller=null,this.method=null,this.args=null,this},s$d.recover=function(){0<this._id&&(this._id=0,this.clear())},s$h.create=function(s$d,s$L,s$l,s$Z){return void 0===s$Z&&(s$Z=!0),new s$h(s$d,s$L,s$l,s$Z)},s$h._gid=1,s$h}(),s$Q=function(){function s$d(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}s$t(s$d,"laya.display.BitmapFont");var s$L=s$d.prototype;return s$L.loadFont=function(s$d,s$L){this._path=s$d,this._complete=s$L,s$$.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],s$e.create(this,this.onLoaded))},s$L.onLoaded=function(){this.parseFont(s$md.getRes(this._path),s$md.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},s$L.parseFont=function(s$d,s$L){if(null!=s$d&&null!=s$L){this._texture=s$L;var s$l=s$d.getElementsByTagName("info");if(!s$l[0].getAttributeNode)return this.parseFont2(s$d,s$L);this.fontSize=parseInt(s$l[0].getAttributeNode("size").nodeValue);var s$Z,s$h=s$l[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(s$h[0]),parseInt(s$h[1]),parseInt(s$h[2]),parseInt(s$h[3])],s$Z=s$d.getElementsByTagName("char");var s$_=0;for(s$_=0;s$_<s$Z.length;s$_++){var s$N=s$Z[s$_],s$m=parseInt(s$N.getAttributeNode("id").nodeValue),s$u=parseInt(s$N.getAttributeNode("xoffset").nodeValue)/1,s$x=parseInt(s$N.getAttributeNode("yoffset").nodeValue)/1,s$t=parseInt(s$N.getAttributeNode("xadvance").nodeValue)/1,s$b=new s$n;s$b.x=parseInt(s$N.getAttributeNode("x").nodeValue),s$b.y=parseInt(s$N.getAttributeNode("y").nodeValue),s$b.width=parseInt(s$N.getAttributeNode("width").nodeValue),s$b.height=parseInt(s$N.getAttributeNode("height").nodeValue);var s$q=s$td.create(s$L,s$b.x,s$b.y,s$b.width,s$b.height,s$u,s$x);this._maxWidth=Math.max(this._maxWidth,s$t+this.letterSpacing),this._fontCharDic[s$m]=s$q,this._fontWidthMap[s$m]=s$t}}},s$L.parseFont2=function(s$d,s$L){if(null!=s$d&&null!=s$L){this._texture=s$L;var s$l=s$d.getElementsByTagName("info");this.fontSize=parseInt(s$l[0].attributes.size.nodeValue);var s$Z=s$l[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(s$Z[0]),parseInt(s$Z[1]),parseInt(s$Z[2]),parseInt(s$Z[3])];var s$h=s$d.getElementsByTagName("char"),s$_=0;for(s$_=0;s$_<s$h.length;s$_++){var s$N=s$h[s$_].attributes,s$m=parseInt(s$N.id.nodeValue),s$u=parseInt(s$N.xoffset.nodeValue)/1,s$x=parseInt(s$N.yoffset.nodeValue)/1,s$t=parseInt(s$N.xadvance.nodeValue)/1,s$b=new s$n;s$b.x=parseInt(s$N.x.nodeValue),s$b.y=parseInt(s$N.y.nodeValue),s$b.width=parseInt(s$N.width.nodeValue),s$b.height=parseInt(s$N.height.nodeValue);var s$q=s$td.create(s$L,s$b.x,s$b.y,s$b.width,s$b.height,s$u,s$x);this._maxWidth=Math.max(this._maxWidth,s$t+this.letterSpacing),this._fontCharDic[s$m]=s$q,this._fontWidthMap[s$m]=s$t}}},s$L.getCharTexture=function(s$d){return this._fontCharDic[s$d.charCodeAt(0)]},s$L.destroy=function(){if(this._texture){for(var s$d in this._fontCharDic){var s$L=this._fontCharDic[s$d];s$L&&s$L.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},s$L.setSpaceWidth=function(s$d){this._spaceWidth=s$d},s$L.getCharWidth=function(s$d){var s$L=s$d.charCodeAt(0);return this._fontWidthMap[s$L]?this._fontWidthMap[s$L]+this.letterSpacing:" "==s$d?this._spaceWidth+this.letterSpacing:0},s$L.getTextWidth=function(s$d){for(var s$L=0,s$l=0,s$Z=s$d.length;s$l<s$Z;s$l++)s$L+=this.getCharWidth(s$d.charAt(s$l));return s$L},s$L.getMaxWidth=function(){return this._maxWidth},s$L.getMaxHeight=function(){return this.fontSize},s$L.drawText=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m=this.getTextWidth(s$d),s$u=0;"center"===s$h&&(s$u=(s$_-s$m)/2),"right"===s$h&&(s$u=s$_-s$m);for(var s$x=0,s$t=0,s$b=s$d.length;s$t<s$b;s$t++)(s$N=this.getCharTexture(s$d.charAt(s$t)))&&(s$L.graphics.drawTexture(s$N,s$l+s$x+s$u,s$Z),s$x+=this.getCharWidth(s$d.charAt(s$t)))},s$d}(),s$m=function(){function s$l(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=s$l._TF_EMPTY}s$t(s$l,"laya.display.css.Style");var s$d=s$l.prototype;return s$d.getTransform=function(){return this._tf},s$d.setTransform=function(s$d){this._tf="none"!==s$d&&s$d?s$d:s$l._TF_EMPTY},s$d.setTranslateX=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.translateX=s$d},s$d.setTranslateY=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.translateY=s$d},s$d.setScaleX=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.scaleX=s$d},s$d.setScale=function(s$d,s$L){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.scaleX=s$d,this._tf.scaleY=s$L},s$d.setScaleY=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.scaleY=s$d},s$d.setRotate=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.rotate=s$d},s$d.setSkewX=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.skewX=s$d},s$d.setSkewY=function(s$d){this._tf===s$l._TF_EMPTY&&(this._tf=new s$h),this._tf.skewY=s$d},s$d.destroy=function(){this.scrollRect=null},s$d.render=function(s$d,s$L,s$l,s$Z){},s$d.getCSSStyle=function(){return s$Ld.EMPTY},s$d._enableLayout=function(){return!1},s$c(0,s$d,"scaleX",function(){return this._tf.scaleX},function(s$d){this.setScaleX(s$d)}),s$c(0,s$d,"transform",function(){return this.getTransform()},function(s$d){this.setTransform(s$d)}),s$c(0,s$d,"translateX",function(){return this._tf.translateX},function(s$d){this.setTranslateX(s$d)}),s$c(0,s$d,"translateY",function(){return this._tf.translateY},function(s$d){this.setTranslateY(s$d)}),s$c(0,s$d,"scaleY",function(){return this._tf.scaleY},function(s$d){this.setScaleY(s$d)}),s$c(0,s$d,"block",function(){return 0!=(1&this._type)}),s$c(0,s$d,"skewY",function(){return this._tf.skewY},function(s$d){this.setSkewY(s$d)}),s$c(0,s$d,"rotate",function(){return this._tf.rotate},function(s$d){this.setRotate(s$d)}),s$c(0,s$d,"skewX",function(){return this._tf.skewX},function(s$d){this.setSkewX(s$d)}),s$c(0,s$d,"paddingLeft",function(){return 0}),s$c(0,s$d,"paddingTop",function(){return 0}),s$c(0,s$d,"absolute",function(){return!0}),s$l.__init__=function(){s$l._TF_EMPTY=new s$h,s$l.EMPTY=new s$l},s$l.EMPTY=null,s$l._TF_EMPTY=null,s$l}(),s$Y=function(){function s$L(s$d){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=s$P.create(s$L.defaultColor),this.family=s$L.defaultFamily,this.stroke=s$L._STROKE,this.size=s$L.defaultSize,s$d&&s$d!==s$L.EMPTY&&s$d.copyTo(this)}s$t(s$L,"laya.display.css.Font");var s$d=s$L.prototype;return s$d.set=function(s$d){this._text=null;for(var s$L=s$d.split(" "),s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){var s$h=s$L[s$l];switch(s$h){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<s$h.indexOf("px")&&(this.size=parseInt(s$h),this.family=s$L[s$l+1],s$l++)}},s$d.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},s$d.copyTo=function(s$d){s$d._type=this._type,s$d._text=this._text,s$d._weight=this._weight,s$d._color=this._color,s$d.family=this.family,s$d.stroke=this.stroke!=s$L._STROKE?this.stroke.slice():s$L._STROKE,s$d.indent=this.indent,s$d.size=this.size},s$c(0,s$d,"password",function(){return 0!=(1024&this._type)},function(s$d){s$d?this._type|=1024:this._type&=-1025}),s$c(0,s$d,"color",function(){return this._color.strColor},function(s$d){this._color=s$P.create(s$d)}),s$c(0,s$d,"italic",function(){return 0!=(512&this._type)},function(s$d){s$d?this._type|=512:this._type&=-513}),s$c(0,s$d,"bold",function(){return 0!=(2048&this._type)},function(s$d){s$d?this._type|=2048:this._type&=-2049}),s$c(0,s$d,"weight",function(){return""+this._weight},function(s$d){var s$L=0;switch(s$d){case"normal":break;case"bold":this.bold=!0,s$L=700;break;case"bolder":s$L=800;break;case"lighter":s$L=100;break;default:s$L=parseInt(s$d)}this._weight=s$L,this._text=null}),s$c(0,s$d,"decoration",function(){return this._decoration?this._decoration.value:null},function(s$d){var s$L=s$d.split(" ");switch(this._decoration||(this._decoration={}),s$L[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=s$L[0]}s$L[1]&&(this._decoration.color=s$P.create(s$L)),this._decoration.value=s$d}),s$L.__init__=function(){s$L.EMPTY=new s$L(null)},s$L.EMPTY=null,s$L.defaultColor="#000000",s$L.defaultSize=12,s$L.defaultFamily="Arial",s$L.defaultFont="12px Arial",s$L._STROKE=[0,"#000000"],s$L._ITALIC=512,s$L._PASSWORD=1024,s$L._BOLD=2048,s$L}(),s$h=function(){function s$d(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return s$t(s$d,"laya.display.css.TransformInfo"),s$d}(),s$q=function(){function s$b(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,s$H.isConchNode){this._nativeObj=new s$N._conchGraphics,this.id=this._nativeObj.conchID}}s$t(s$b,"laya.display.Graphics");var s$d=s$b.prototype;return s$d.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},s$d.clear=function(s$d){void 0===s$d&&(s$d=!1);var s$L=0,s$l=0;if(s$d){var s$Z=this._one;if(this._cmds){for(s$l=this._cmds.length,s$L=0;s$L<s$l;s$L++)!(s$Z=this._cmds[s$L])||s$Z.callee!==s$H._context._drawTexture&&s$Z.callee!==s$H._context._drawTextureWithTransform||(s$Z[0]=null,s$b._cache.push(s$Z));this._cmds.length=0}else s$Z&&(!s$Z||s$Z.callee!==s$H._context._drawTexture&&s$Z.callee!==s$H._context._drawTextureWithTransform||(s$Z[0]=null,s$b._cache.push(s$Z)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(s$L=0,s$l=this._vectorgraphArray.length;s$L<s$l;s$L++)s$U.getInstance().deleteShape(this._vectorgraphArray[s$L]);this._vectorgraphArray.length=0}},s$d._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},s$d._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new s$l,this._graphicBounds._graphics=this)},s$d._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},s$d._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},s$d.getBounds=function(s$d){return void 0===s$d&&(s$d=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(s$d)},s$d.getBoundPoints=function(s$d){return void 0===s$d&&(s$d=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(s$d)},s$d._addCmd=function(s$d){this._cmds=this._cmds||[],s$d.callee=s$d.shift(),this._cmds.push(s$d)},s$d.setFilters=function(s$d){this._saveToCmd(s$H._context._setFilters,s$d)},s$d.drawTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$N&&(s$N=1),!s$d||s$N<.01)return null;s$Z||(s$Z=s$d.sourceWidth),s$h||(s$h=s$d.sourceHeight),s$N=s$N<0?0:1<s$N?1:s$N;var s$m,s$u=!s$H.isWebGL&&(s$i.onFirefox||s$i.onEdge||s$i.onIE||s$i.onSafari)?.5:0,s$x=s$Z/s$d.sourceWidth,s$t=s$h/s$d.sourceHeight;return s$Z=s$d.width*s$x,s$h=s$d.height*s$t,s$d.loaded&&(s$Z<=0||s$h<=0)?null:(s$L+=s$d.offsetX*s$x,s$l+=s$d.offsetY*s$t,this._sp&&(this._sp._renderType|=512),s$L-=s$u,s$l-=s$u,s$Z+=2*s$u,s$h+=2*s$u,s$b._cache.length?((s$m=s$b._cache.pop())[0]=s$d,s$m[1]=s$L,s$m[2]=s$l,s$m[3]=s$Z,s$m[4]=s$h,s$m[5]=s$_,s$m[6]=s$N):s$m=[s$d,s$L,s$l,s$Z,s$h,s$_,s$N],s$m.callee=s$_||1!=s$N?s$H._context._drawTextureWithTransform:s$H._context._drawTexture,null!=this._one||s$_||1!=s$N?this._saveToCmd(s$m.callee,s$m):(this._one=s$m,this._render=this._renderOneImg),s$d.loaded||s$d.once("loaded",this,this._textureLoaded,[s$d,s$m]),this._repaint(),s$m)},s$d.cleanByTexture=function(s$d,s$L,s$l,s$Z,s$h){if(void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),!s$d)return this.clear();if(this._one&&this._render===this._renderOneImg){s$Z||(s$Z=s$d.sourceWidth),s$h||(s$h=s$d.sourceHeight);var s$_=s$Z/s$d.sourceWidth,s$N=s$h/s$d.sourceHeight;s$Z=s$d.width*s$_,s$h=s$d.height*s$N,s$L+=s$d.offsetX*s$_,s$l+=s$d.offsetY*s$N,this._one[0]=s$d,this._one[1]=s$L,this._one[2]=s$l,this._one[3]=s$Z,this._one[4]=s$h,this._repaint()}else this.clear(),s$d&&this.drawTexture(s$d,s$L,s$l,s$Z,s$h)},s$d.drawTextures=function(s$d,s$L){s$d&&this._saveToCmd(s$H._context._drawTextures,[s$d,s$L])},s$d.fillTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_="repeat"),s$d){var s$m=[s$d,s$L,s$l,s$Z,s$h,s$_,s$N||s$O.EMPTY,{}];s$d.loaded||s$d.once("loaded",this,this._textureLoaded,[s$d,s$m]),this._saveToCmd(s$H._context._fillTexture,s$m)}},s$d._textureLoaded=function(s$d,s$L){s$L[3]=s$L[3]||s$d.width,s$L[4]=s$L[4]||s$d.height,this._repaint()},s$d.fillCircle=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$l.bitmap.enableMerageInAtlas=!1;var s$m=new Float32Array(2*(s$N+1)),s$u=new Float32Array(2*(s$N+1)),s$x=new Uint16Array(3*s$N),s$t=2*Math.PI/s$N,s$b=0;s$m[0]=s$Z,s$m[1]=s$h,s$u[0]=s$Z/s$l.width,s$u[1]=s$h/s$l.height;for(var s$q=2,s$Y=0;s$Y<s$N;s$Y++){var s$c=s$_*Math.cos(s$b)+s$Z,s$r=s$_*Math.sin(s$b)+s$h;s$m[s$q]=s$c,s$m[s$q+1]=s$r,s$u[s$q]=s$c/s$l.width,s$u[s$q+1]=s$r/s$l.height,s$b+=s$t,s$q+=2}for(s$Y=s$q=0;s$Y<s$N;s$Y++)s$x[s$q++]=0,s$x[s$q++]=s$Y+1,s$x[s$q++]=s$N+1<=s$Y+2?1:s$Y+2;this.drawTriangles(s$l,s$d,s$L,s$m,s$u,s$x)},s$d.drawTriangles=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){void 0===s$m&&(s$m=1),this._saveToCmd(s$H._context.drawTriangles,[s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x])},s$d._saveToCmd=function(s$d,s$L){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=s$L,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(s$L)),s$L.callee=s$d,this._repaint(),s$L},s$d.clipRect=function(s$d,s$L,s$l,s$Z){this._saveToCmd(s$H._context._clipRect,[s$d,s$L,s$l,s$Z])},s$d.fillText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){void 0===s$N&&(s$N=0),this._saveToCmd(s$H._context._fillText,[s$d,s$L,s$l,s$Z||s$Y.defaultFont,s$h,s$_])},s$d.fillBorderText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){this._saveToCmd(s$H._context._fillBorderText,[s$d,s$L,s$l,s$Z||s$Y.defaultFont,s$h,s$_,s$N,s$m])},s$d.strokeText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._saveToCmd(s$H._context._strokeText,[s$d,s$L,s$l,s$Z||s$Y.defaultFont,s$h,s$_,s$N])},s$d.alpha=function(s$d){s$d=s$d<0?0:1<s$d?1:s$d,this._saveToCmd(s$H._context._alpha,[s$d])},s$d.setAlpha=function(s$d){s$d=s$d<0?0:1<s$d?1:s$d,this._saveToCmd(s$H._context._setAlpha,[s$d])},s$d.transform=function(s$d,s$L,s$l){void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),this._saveToCmd(s$H._context._transform,[s$d,s$L,s$l])},s$d.rotate=function(s$d,s$L,s$l){void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),this._saveToCmd(s$H._context._rotate,[s$d,s$L,s$l])},s$d.scale=function(s$d,s$L,s$l,s$Z){void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),this._saveToCmd(s$H._context._scale,[s$d,s$L,s$l,s$Z])},s$d.translate=function(s$d,s$L){this._saveToCmd(s$H._context._translate,[s$d,s$L])},s$d.save=function(){this._saveToCmd(s$H._context._save,[])},s$d.restore=function(){this._saveToCmd(s$H._context._restore,[])},s$d.replaceText=function(s$d){this._repaint();var s$L=this._cmds;if(s$L){for(var s$l=s$L.length-1;-1<s$l;s$l--)if(this._isTextCmd(s$L[s$l].callee))return s$L[s$l][0].toUpperCase?s$L[s$l][0]=s$d:s$L[s$l][0].setText(s$d),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=s$d:this._one[0].setText(s$d),!0;return!1},s$d._isTextCmd=function(s$d){return s$d===s$H._context._fillText||s$d===s$H._context._fillBorderText||s$d===s$H._context._strokeText},s$d.replaceTextColor=function(s$d){this._repaint();var s$L=this._cmds;if(s$L)for(var s$l=s$L.length-1;-1<s$l;s$l--)this._isTextCmd(s$L[s$l].callee)&&(s$L[s$l][4]=s$d,s$L[s$l][0].toUpperCase||(s$L[s$l][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=s$d,this._one[0].toUpperCase||(this._one[0].changed=!0))},s$d.loadImage=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=this;void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0);var s$m=s$md.getRes(s$d);function s$u(s$d){s$d&&(s$N.drawTexture(s$d,s$L,s$l,s$Z,s$h),null!=s$_&&s$_.call(s$N._sp,s$d))}s$m?s$u(s$m):s$$.loader.load(s$d,s$e.create(null,s$u),null,"image")},s$d._renderEmpty=function(s$d,s$L,s$l,s$Z){},s$d._renderAll=function(s$d,s$L,s$l,s$Z){for(var s$h,s$_=this._cmds,s$N=0,s$m=s$_.length;s$N<s$m;s$N++)(s$h=s$_[s$N]).callee.call(s$L,s$l,s$Z,s$h)},s$d._renderOne=function(s$d,s$L,s$l,s$Z){this._one.callee.call(s$L,s$l,s$Z,this._one)},s$d._renderOneImg=function(s$d,s$L,s$l,s$Z){this._one.callee.call(s$L,s$l,s$Z,this._one),2305!==s$d._renderType&&(s$d._renderType|=1)},s$d.drawLine=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=1);var s$N=0;s$H.isWebGL&&(s$N=s$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s$N));var s$m=s$_%2==0?0:.5,s$u=[s$d+s$m,s$L+s$m,s$l+s$m,s$Z+s$m,s$h,s$_,s$N];this._saveToCmd(s$H._context._drawLine,s$u)},s$d.drawLines=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=1);var s$_=0;if(s$l&&!(s$l.length<4)){s$H.isWebGL&&(s$_=s$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s$_));var s$N=s$h%2==0?0:.5,s$m=[s$d+s$N,s$L+s$N,s$l,s$Z,s$h,s$_];this._saveToCmd(s$H._context._drawLines,s$m)}},s$d.drawCurves=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=1);var s$_=[s$d,s$L,s$l,s$Z,s$h];this._saveToCmd(s$H._context._drawCurves,s$_)},s$d.drawRect=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){void 0===s$N&&(s$N=1);var s$m=s$_?s$N/2:0,s$u=s$_?s$N:0,s$x=[s$d+s$m,s$L+s$m,s$l-s$u,s$Z-s$u,s$h,s$_,s$N];this._saveToCmd(s$H._context._drawRect,s$x)},s$d.drawCircle=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=1);var s$N=s$h?s$_/2:0,s$m=0;s$H.isWebGL&&(s$m=s$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s$m));var s$u=[s$d,s$L,s$l-s$N,s$Z,s$h,s$_,s$m];this._saveToCmd(s$H._context._drawCircle,s$u)},s$d.drawPie=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){void 0===s$m&&(s$m=1);var s$u=s$N?s$m/2:0,s$x=s$N?s$m:0,s$t=0;s$H.isWebGL&&(s$t=s$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s$t));var s$b=[s$d+s$u,s$L+s$u,s$l-s$x,s$Z,s$h,s$_,s$N,s$m,s$t];s$b[3]=s$f.toRadian(s$Z),s$b[4]=s$f.toRadian(s$h),this._saveToCmd(s$H._context._drawPie,s$b)},s$d.drawPoly=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=1);var s$N=0,s$m=!1;s$H.isWebGL&&(s$N=s$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(s$N),s$m=!(6<s$l.length));var s$u=s$h?s$_%2==0?0:.5:0,s$x=[s$d+s$u,s$L+s$u,s$l,s$Z,s$h,s$_,s$N,s$m];this._saveToCmd(s$H._context._drawPoly,s$x)},s$d.drawPath=function(s$d,s$L,s$l,s$Z,s$h){var s$_=[s$d,s$L,s$l,s$Z,s$h];this._saveToCmd(s$H._context._drawPath,s$_)},s$c(0,s$d,"cmds",function(){return this._cmds},function(s$d){this._sp&&(this._sp._renderType|=512),this._cmds=s$d,this._render=this._renderAll,this._repaint()}),s$b.__init__=function(){if(s$H.isConchNode){for(var s$d=laya.display.Graphics.prototype,s$L=s$i.window.ConchGraphics.prototype,s$l=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],s$Z=0,s$h=s$l.length;s$Z<=s$h;s$Z++){var s$_=s$l[s$Z];s$d[s$_]=s$L[s$_]}s$d._saveToCmd=null,s$L.drawImageS&&(s$d.drawTextures=function(s$d,s$L){if(s$d&&s$d.loaded&&s$d.bitmap&&s$d.source){var s$l=s$d.uv,s$Z=s$d.bitmap.width,s$h=s$d.bitmap.height;this.drawImageS(s$d.bitmap.source,s$l[0]*s$Z,s$l[1]*s$h,(s$l[2]-s$l[0])*s$Z,(s$l[5]-s$l[3])*s$h,s$d.offsetX,s$d.offsetY,s$d.width,s$d.height,s$L)}}),s$d.drawTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$N&&(s$N=1),s$d)if(s$d.loaded){if(s$d.loaded&&s$d.bitmap&&s$d.source&&(s$Z||(s$Z=s$d.sourceWidth),s$h||(s$h=s$d.sourceHeight),s$N=s$N<0?0:1<s$N?1:s$N,s$Z=s$Z-s$d.sourceWidth+s$d.width,s$h=s$h-s$d.sourceHeight+s$d.height,!(s$Z<=0||s$h<=0))){s$L+=s$d.offsetX,s$l+=s$d.offsetY;var s$m=s$d.uv,s$u=s$d.bitmap.width,s$x=s$d.bitmap.height;s$m[4]<s$m[0]&&s$m[5]<s$m[1]?this.drawImageM(s$d.bitmap.source,s$m[4]*s$u,s$m[5]*s$x,(s$m[0]-s$m[4])*s$u,(s$m[1]-s$m[5])*s$x,s$L,s$l,s$Z,s$h,s$_,s$N):this.drawImageM(s$d.bitmap.source,s$m[0]*s$u,s$m[1]*s$x,(s$m[2]-s$m[0])*s$u,(s$m[5]-s$m[3])*s$x,s$L,s$l,s$Z,s$h,s$_,s$N),this._repaint()}}else s$d.once("loaded",this,function(){this.drawTexture(s$d,s$L,s$l,s$Z,s$h,s$_)})},s$d.fillTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_="repeat"),s$d&&s$d.loaded){var s$m,s$u=s$H._context.ctx,s$x=s$d.bitmap.width,s$t=s$d.bitmap.height,s$b=s$d.uv;s$m=s$d.uv!=s$td.DEF_UV?s$u.createPattern(s$d.bitmap.source,s$_,s$b[0]*s$x,s$b[1]*s$t,(s$b[2]-s$b[0])*s$x,(s$b[5]-s$b[3])*s$t):s$u.createPattern(s$d.bitmap.source,s$_);var s$q=0,s$Y=0;s$N&&(s$L+=s$N.x%s$d.width,s$l+=s$N.y%s$d.height,s$q-=s$N.x%s$d.width,s$Y-=s$N.y%s$d.height),this._fillImage(s$m,s$L,s$l,s$q,s$Y,s$Z,s$h)}}}},s$b._cache=[],s$b}(),s$l=function(){function s$w(){this._cacheBoundsType=!1}s$t(s$w,"laya.display.GraphicsBounds");var s$d=s$w.prototype;return s$d.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},s$d.reset=function(){this._temp&&(this._temp.length=0)},s$d.getBounds=function(s$d){return void 0===s$d&&(s$d=!1),(!this._bounds||!this._temp||this._temp.length<1||s$d!=this._cacheBoundsType)&&(this._bounds=s$n._getWrapRec(this.getBoundPoints(s$d),this._bounds)),this._cacheBoundsType=s$d,this._bounds},s$d.getBoundPoints=function(s$d){return void 0===s$d&&(s$d=!1),(!this._temp||this._temp.length<1||s$d!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(s$d)),this._cacheBoundsType=s$d,this._rstBoundPoints=s$f.copyArray(this._rstBoundPoints,this._temp)},s$d._getCmdPoints=function(s$d){void 0===s$d&&(s$d=!1);var s$L,s$l,s$Z=s$H._context,s$h=this._graphics.cmds;if((s$L=this._temp||(this._temp=[])).length=0,s$h||null==this._graphics._one||(s$w._tempCmds.length=0,s$w._tempCmds.push(this._graphics._one),s$h=s$w._tempCmds),!s$h)return s$L;(s$l=s$w._tempMatrixArrays).length=0;var s$_=s$w._initMatrix;s$_.identity();for(var s$N,s$m,s$u=s$w._tempMatrix,s$x=NaN,s$t=NaN,s$b=NaN,s$q=NaN,s$Y=NaN,s$c=NaN,s$r=0,s$a=s$h.length;s$r<s$a;s$r++)if((s$N=s$h[s$r]).callee)switch(s$N.callee){case s$Z._save:case 7:s$l.push(s$_),s$_=s$_.clone();break;case s$Z._restore:case 8:s$_=s$l.pop();break;case s$Z._scale:case 5:s$u.identity(),s$u.translate(-s$N[2],-s$N[3]),s$u.scale(s$N[0],s$N[1]),s$u.translate(s$N[2],s$N[3]),this._switchMatrix(s$_,s$u);break;case s$Z._rotate:case 3:s$u.identity(),s$u.translate(-s$N[1],-s$N[2]),s$u.rotate(s$N[0]),s$u.translate(s$N[1],s$N[2]),this._switchMatrix(s$_,s$u);break;case s$Z._translate:case 6:s$u.identity(),s$u.translate(s$N[0],s$N[1]),this._switchMatrix(s$_,s$u);break;case s$Z._transform:case 4:s$u.identity(),s$u.translate(-s$N[1],-s$N[2]),s$u.concat(s$N[0]),s$u.translate(s$N[1],s$N[2]),this._switchMatrix(s$_,s$u);break;case 16:case 24:s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[0],s$N[1],s$N[2],s$N[3]),s$_);break;case 17:s$_.copyTo(s$u),s$u.concat(s$N[4]),s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[0],s$N[1],s$N[2],s$N[3]),s$u);break;case s$Z._drawTexture:s$m=s$N[0],s$d?s$N[3]&&s$N[4]?s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$N[3],s$N[4]),s$_):(s$m=s$N[0],s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$m.width,s$m.height),s$_)):(s$x=(s$N[3]||s$m.sourceWidth)/s$m.width,s$t=(s$N[4]||s$m.sourceHeight)/s$m.height,s$b=s$x*s$m.sourceWidth,s$q=s$t*s$m.sourceHeight,s$Y=0<s$m.offsetX?s$m.offsetX:0,s$c=0<s$m.offsetY?s$m.offsetY:0,s$Y*=s$x,s$c*=s$t,s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1]-s$Y,s$N[2]-s$c,s$b,s$q),s$_));break;case s$Z._fillTexture:s$N[3]&&s$N[4]?s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$N[3],s$N[4]),s$_):(s$m=s$N[0],s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$m.width,s$m.height),s$_));break;case s$Z._drawTextureWithTransform:var s$k;s$k=s$N[5]?(s$_.copyTo(s$u),s$u.concat(s$N[5]),s$u):s$_,s$d?s$N[3]&&s$N[4]?s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$N[3],s$N[4]),s$k):(s$m=s$N[0],s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1],s$N[2],s$m.width,s$m.height),s$k)):(s$m=s$N[0],s$x=(s$N[3]||s$m.sourceWidth)/s$m.width,s$t=(s$N[4]||s$m.sourceHeight)/s$m.height,s$b=s$x*s$m.sourceWidth,s$q=s$t*s$m.sourceHeight,s$Y=0<s$m.offsetX?s$m.offsetX:0,s$c=0<s$m.offsetY?s$m.offsetY:0,s$Y*=s$x,s$c*=s$t,s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[1]-s$Y,s$N[2]-s$c,s$b,s$q),s$k));break;case s$Z._drawRect:case 13:s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[0],s$N[1],s$N[2],s$N[3]),s$_);break;case s$Z._drawCircle:case s$Z._fillCircle:case 14:s$w._addPointArrToRst(s$L,s$n._getBoundPointS(s$N[0]-s$N[2],s$N[1]-s$N[2],s$N[2]+s$N[2],s$N[2]+s$N[2]),s$_);break;case s$Z._drawLine:case 20:s$w._tempPoints.length=0;var s$e;s$e=.5*s$N[5],s$N[0]==s$N[2]?s$w._tempPoints.push(s$N[0]+s$e,s$N[1],s$N[2]+s$e,s$N[3],s$N[0]-s$e,s$N[1],s$N[2]-s$e,s$N[3]):s$N[1]==s$N[3]?s$w._tempPoints.push(s$N[0],s$N[1]+s$e,s$N[2],s$N[3]+s$e,s$N[0],s$N[1]-s$e,s$N[2],s$N[3]-s$e):s$w._tempPoints.push(s$N[0],s$N[1],s$N[2],s$N[3]),s$w._addPointArrToRst(s$L,s$w._tempPoints,s$_);break;case s$Z._drawCurves:case 22:s$w._addPointArrToRst(s$L,s$s.I.getBezierPoints(s$N[2]),s$_,s$N[0],s$N[1]);break;case s$Z._drawPoly:case s$Z._drawLines:case 18:s$w._addPointArrToRst(s$L,s$N[2],s$_,s$N[0],s$N[1]);break;case s$Z._drawPath:case 19:s$w._addPointArrToRst(s$L,this._getPathPoints(s$N[2]),s$_,s$N[0],s$N[1]);break;case s$Z._drawPie:case 15:s$w._addPointArrToRst(s$L,this._getPiePoints(s$N[0],s$N[1],s$N[2],s$N[3],s$N[4]),s$_)}return 200<s$L.length?s$L=s$f.copyArray(s$L,s$n._getWrapRec(s$L)._getBoundPoints()):8<s$L.length&&(s$L=s$A.scanPList(s$L)),s$L},s$d._switchMatrix=function(s$d,s$L){s$L.concat(s$d),s$L.copyTo(s$d)},s$d._getPiePoints=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$w._tempPoints;s$w._tempPoints.length=0,s$_.push(s$d,s$L);var s$N=(s$h-s$Z)%(2*Math.PI)/10,s$m=NaN,s$u=s$Z;for(s$m=0;s$m<=10;s$m++)s$_.push(s$d+s$l*Math.cos(s$u),s$L+s$l*Math.sin(s$u)),s$u+=s$N;return s$_},s$d._getPathPoints=function(s$d){var s$L,s$l,s$Z=0,s$h=s$w._tempPoints;for(s$h.length=0,s$L=s$d.length,s$Z=0;s$Z<s$L;s$Z++)1<(s$l=s$d[s$Z]).length&&(s$h.push(s$l[1],s$l[2]),3<s$l.length&&s$h.push(s$l[3],s$l[4]));return s$h},s$w._addPointArrToRst=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0);var s$_,s$N=0;for(s$_=s$L.length,s$N=0;s$N<s$_;s$N+=2)s$w._addPointToRst(s$d,s$L[s$N]+s$Z,s$L[s$N+1]+s$h,s$l)},s$w._addPointToRst=function(s$d,s$L,s$l,s$Z){var s$h=s$O.TEMP;s$h.setTo(s$L||0,s$l||0),s$Z.transformPoint(s$h),s$d.push(s$h.x,s$h.y)},s$w._tempPoints=[],s$w._tempMatrixArrays=[],s$w._tempCmds=[],s$u(s$w,["_tempMatrix",function(){return this._tempMatrix=new s$E},"_initMatrix",function(){return this._initMatrix=new s$E}]),s$w}(),s$_=function(){function s$d(){}s$t(s$d,"laya.events.Event");var s$L=s$d.prototype;return s$L.setTo=function(s$d,s$L,s$l){return this.type=s$d,this.currentTarget=s$L,this.target=s$l,this},s$L.stopPropagation=function(){this._stoped=!0},s$c(0,s$L,"stageY",function(){return s$$.stage.mouseY}),s$c(0,s$L,"charCode",function(){return this.nativeEvent.charCode}),s$c(0,s$L,"touches",function(){var s$d=this.nativeEvent.touches;if(s$d)for(var s$L=s$$.stage,s$l=0,s$Z=s$d.length;s$l<s$Z;s$l++){var s$h=s$d[s$l],s$_=s$O.TEMP;s$_.setTo(s$h.clientX,s$h.clientY),s$L._canvasTransform.invertTransformPoint(s$_),s$L.transform.invertTransformPoint(s$_),s$h.stageX=s$_.x,s$h.stageY=s$_.y}return s$d}),s$c(0,s$L,"keyLocation",function(){return this.nativeEvent.keyLocation}),s$c(0,s$L,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),s$c(0,s$L,"altKey",function(){return this.nativeEvent.altKey}),s$c(0,s$L,"shiftKey",function(){return this.nativeEvent.shiftKey}),s$c(0,s$L,"stageX",function(){return s$$.stage.mouseX}),s$d.EMPTY=new s$d,s$d.MOUSE_DOWN="mousedown",s$d.MOUSE_UP="mouseup",s$d.CLICK="click",s$d.RIGHT_MOUSE_DOWN="rightmousedown",s$d.RIGHT_MOUSE_UP="rightmouseup",s$d.RIGHT_CLICK="rightclick",s$d.MOUSE_MOVE="mousemove",s$d.MOUSE_OVER="mouseover",s$d.MOUSE_OUT="mouseout",s$d.MOUSE_WHEEL="mousewheel",s$d.ROLL_OVER="mouseover",s$d.ROLL_OUT="mouseout",s$d.DOUBLE_CLICK="doubleclick",s$d.CHANGE="change",s$d.CHANGED="changed",s$d.RESIZE="resize",s$d.ADDED="added",s$d.REMOVED="removed",s$d.DISPLAY="display",s$d.UNDISPLAY="undisplay",s$d.ERROR="error",s$d.COMPLETE="complete",s$d.LOADED="loaded",s$d.INITED="inited",s$d.PROGRESS="progress",s$d.INPUT="input",s$d.RENDER="render",s$d.OPEN="open",s$d.MESSAGE="message",s$d.CLOSE="close",s$d.KEY_DOWN="keydown",s$d.KEY_PRESS="keypress",s$d.KEY_UP="keyup",s$d.FRAME="enterframe",s$d.DRAG_START="dragstart",s$d.DRAG_MOVE="dragmove",s$d.DRAG_END="dragend",s$d.ENTER="enter",s$d.SELECT="select",s$d.BLUR="blur",s$d.FOCUS="focus",s$d.VISIBILITY_CHANGE="visibilitychange",s$d.FOCUS_CHANGE="focuschange",s$d.PLAYED="played",s$d.PAUSED="paused",s$d.STOPPED="stopped",s$d.START="start",s$d.END="end",s$d.ENABLE_CHANGED="enablechanged",s$d.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",s$d.COMPONENT_ADDED="componentadded",s$d.COMPONENT_REMOVED="componentremoved",s$d.LAYER_CHANGED="layerchanged",s$d.HIERARCHY_LOADED="hierarchyloaded",s$d.RECOVERED="recovered",s$d.RELEASED="released",s$d.LINK="link",s$d.LABEL="label",s$d.FULL_SCREEN_CHANGE="fullscreenchange",s$d.DEVICE_LOST="devicelost",s$d.MESH_CHANGED="meshchanged",s$d.MATERIAL_CHANGED="materialchanged",s$d.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",s$d.ANIMATION_CHANGED="animationchanged",s$d.TRIGGER_ENTER="triggerenter",s$d.TRIGGER_STAY="triggerstay",s$d.TRIGGER_EXIT="triggerexit",s$d.TRAIL_FILTER_CHANGE="trailfilterchange",s$d.DOMINO_FILTER_CHANGE="dominofilterchange",s$d}(),s$b=(function(){function s$d(){}s$t(s$d,"laya.events.Keyboard"),s$d.NUMBER_0=48,s$d.NUMBER_1=49,s$d.NUMBER_2=50,s$d.NUMBER_3=51,s$d.NUMBER_4=52,s$d.NUMBER_5=53,s$d.NUMBER_6=54,s$d.NUMBER_7=55,s$d.NUMBER_8=56,s$d.NUMBER_9=57,s$d.A=65,s$d.B=66,s$d.C=67,s$d.D=68,s$d.E=69,s$d.F=70,s$d.G=71,s$d.H=72,s$d.I=73,s$d.J=74,s$d.K=75,s$d.L=76,s$d.M=77,s$d.N=78,s$d.O=79,s$d.P=80,s$d.Q=81,s$d.R=82,s$d.S=83,s$d.T=84,s$d.U=85,s$d.V=86,s$d.W=87,s$d.X=88,s$d.Y=89,s$d.Z=90,s$d.F1=112,s$d.F2=113,s$d.F3=114,s$d.F4=115,s$d.F5=116,s$d.F6=117,s$d.F7=118,s$d.F8=119,s$d.F9=120,s$d.F10=121,s$d.F11=122,s$d.F12=123,s$d.F13=124,s$d.F14=125,s$d.F15=126,s$d.NUMPAD=21,s$d.NUMPAD_0=96,s$d.NUMPAD_1=97,s$d.NUMPAD_2=98,s$d.NUMPAD_3=99,s$d.NUMPAD_4=100,s$d.NUMPAD_5=101,s$d.NUMPAD_6=102,s$d.NUMPAD_7=103,s$d.NUMPAD_8=104,s$d.NUMPAD_9=105,s$d.NUMPAD_ADD=107,s$d.NUMPAD_DECIMAL=110,s$d.NUMPAD_DIVIDE=111,s$d.NUMPAD_ENTER=108,s$d.NUMPAD_MULTIPLY=106,s$d.NUMPAD_SUBTRACT=109,s$d.SEMICOLON=186,s$d.EQUAL=187,s$d.COMMA=188,s$d.MINUS=189,s$d.PERIOD=190,s$d.SLASH=191,s$d.BACKQUOTE=192,s$d.LEFTBRACKET=219,s$d.BACKSLASH=220,s$d.RIGHTBRACKET=221,s$d.QUOTE=222,s$d.ALTERNATE=18,s$d.BACKSPACE=8,s$d.CAPS_LOCK=20,s$d.COMMAND=15,s$d.CONTROL=17,s$d.DELETE=46,s$d.ENTER=13,s$d.ESCAPE=27,s$d.PAGE_UP=33,s$d.PAGE_DOWN=34,s$d.END=35,s$d.HOME=36,s$d.LEFT=37,s$d.UP=38,s$d.RIGHT=39,s$d.DOWN=40,s$d.SHIFT=16,s$d.SPACE=32,s$d.TAB=9,s$d.INSERT=45}(),function(){function s$h(){}return s$t(s$h,"laya.events.KeyBoardManager"),s$h.__init__=function(){s$h._addEvent("keydown"),s$h._addEvent("keypress"),s$h._addEvent("keyup")},s$h._addEvent=function(s$L){s$i.document.addEventListener(s$L,function(s$d){laya.events.KeyBoardManager._dispatch(s$d,s$L)},!0)},s$h._dispatch=function(s$d,s$L){if(s$h.enabled){s$h._event._stoped=!1,s$h._event.nativeEvent=s$d,s$h._event.keyCode=s$d.keyCode||s$d.which||s$d.charCode,"keydown"===s$L?s$h._pressKeys[s$h._event.keyCode]=!0:"keyup"===s$L&&(s$h._pressKeys[s$h._event.keyCode]=null);for(var s$l=s$$.stage.focus&&null!=s$$.stage.focus.event&&s$$.stage.focus.displayedInStage?s$$.stage.focus:s$$.stage,s$Z=s$l;s$Z;)s$Z.event(s$L,s$h._event.setTo(s$L,s$Z,s$l)),s$Z=s$Z.parent}},s$h.hasKeyDown=function(s$d){return s$h._pressKeys[s$d]},s$h._pressKeys={},s$h.enabled=!0,s$u(s$h,["_event",function(){return this._event=new s$_}]),s$h}()),s$r=(function(){function s$d(){}s$t(s$d,"laya.events.KeyLocation"),s$d.STANDARD=0,s$d.LEFT=1,s$d.RIGHT=2,s$d.NUM_PAD=3}(),function(){function s$x(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=s$i.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new s$_,this._matrix=new s$E,this._point=new s$O,this._rect=new s$n,this._prePoint=new s$O,this._curTouchID=NaN}s$t(s$x,"laya.events.MouseManager");var s$d=s$x.prototype;return s$d.__init__=function(s$d,s$L){var s$l=this;this._stage=s$d;var s$Z=this,s$h=this._eventList;s$L.oncontextmenu=function(s$d){if(s$x.enabled)return!1},s$L.addEventListener("mousedown",function(s$d){s$x.enabled&&(s$i.onIE||s$d.preventDefault(),s$h.push(s$d),s$Z.mouseDownTime=s$i.now())}),s$L.addEventListener("mouseup",function(s$d){s$x.enabled&&(s$d.preventDefault(),s$h.push(s$d),s$Z.mouseDownTime=-s$i.now())},!0),s$L.addEventListener("mousemove",function(s$d){if(s$x.enabled){s$d.preventDefault();var s$L=s$i.now();if(s$L-s$Z._lastMoveTimer<10)return;s$Z._lastMoveTimer=s$L,s$h.push(s$d)}},!0),s$L.addEventListener("mouseout",function(s$d){s$x.enabled&&s$h.push(s$d)}),s$L.addEventListener("mouseover",function(s$d){s$x.enabled&&s$h.push(s$d)}),s$L.addEventListener("touchstart",function(s$d){s$x.enabled&&(s$h.push(s$d),s$x._isFirstTouch||s$Ad.isInputting||s$d.preventDefault(),s$Z.mouseDownTime=s$i.now())}),s$L.addEventListener("touchend",function(s$d){s$x.enabled?(s$x._isFirstTouch||s$Ad.isInputting||s$d.preventDefault(),s$x._isFirstTouch=!1,s$h.push(s$d),s$Z.mouseDownTime=-s$i.now()):s$l._curTouchID=NaN},!0),s$L.addEventListener("touchmove",function(s$d){s$x.enabled&&(s$d.preventDefault(),s$h.push(s$d))},!0),s$L.addEventListener("touchcancel",function(s$d){s$x.enabled?(s$d.preventDefault(),s$h.push(s$d)):s$l._curTouchID=NaN},!0),s$L.addEventListener("mousewheel",function(s$d){s$x.enabled&&s$h.push(s$d)}),s$L.addEventListener("DOMMouseScroll",function(s$d){s$x.enabled&&s$h.push(s$d)})},s$d.initEvent=function(s$d,s$L){var s$l;this._event._stoped=!1,this._event.nativeEvent=s$L||s$d,this._target=null,this._point.setTo(s$d.pageX||s$d.clientX,s$d.pageY||s$d.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=s$d.identifier||0,this._tTouchID=this._event.touchId,(s$l=s$a.I._event)._stoped=!1,s$l.nativeEvent=this._event.nativeEvent,s$l.touchId=this._event.touchId},s$d.checkMouseWheel=function(s$d){this._event.delta=s$d.wheelDelta?.025*s$d.wheelDelta:-s$d.detail;for(var s$L=s$a.I.getLastOvers(),s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){var s$h=s$L[s$l];s$h.event("mousewheel",this._event.setTo("mousewheel",s$h,this._target))}},s$d.onMouseMove=function(s$d){s$a.I.onMouseMove(s$d,this._tTouchID)},s$d.onMouseDown=function(s$d){if(s$Ad.isInputting&&s$$.stage.focus&&s$$.stage.focus.focus&&!s$$.stage.focus.contains(this._target)){var s$L=s$$.stage.focus._tf||s$$.stage.focus,s$l=s$d._tf||s$d;s$l instanceof laya.display.Input&&s$l.multiline==s$L.multiline?s$L._focusOut():s$L.focus=!1}s$a.I.onMouseDown(s$d,this._tTouchID,this._isLeftMouse)},s$d.onMouseUp=function(s$d){s$a.I.onMouseUp(s$d,this._tTouchID,this._isLeftMouse)},s$d.check=function(s$d,s$L,s$l,s$Z){this._point.setTo(s$L,s$l),s$d.fromParentPoint(this._point),s$L=this._point.x,s$l=this._point.y;var s$h=s$d.scrollRect;if(s$h&&(this._rect.setTo(s$h.x,s$h.y,s$h.width,s$h.height),!this._rect.contains(s$L,s$l)))return!1;if(!this.disableMouseEvent){if(s$d.hitTestPrior&&!s$d.mouseThrough&&!this.hitTest(s$d,s$L,s$l))return!1;for(var s$_=s$d._childs.length-1;-1<s$_;s$_--){var s$N=s$d._childs[s$_];if(!s$N.destroyed&&s$N.mouseEnabled&&s$N.visible&&this.check(s$N,s$L,s$l,s$Z))return!0}}var s$m=!(!s$d.hitTestPrior||s$d.mouseThrough||this.disableMouseEvent)||this.hitTest(s$d,s$L,s$l);return s$m?(this._target=s$d,s$Z.call(this,s$d)):s$Z===this.onMouseUp&&s$d===this._stage&&(this._target=this._stage,s$Z.call(this,this._target)),s$m},s$d.hitTest=function(s$d,s$L,s$l){var s$Z=!1;if(s$d.scrollRect&&(s$L-=s$d.scrollRect.x,s$l-=s$d.scrollRect.y),s$d.hitArea instanceof laya.utils.HitArea)return s$d.hitArea.isHit(s$L,s$l);if(0<s$d.width&&0<s$d.height||s$d.mouseThrough||s$d.hitArea)if(s$d.mouseThrough)s$Z=s$d.getGraphicBounds().contains(s$L,s$l);else{var s$h=this._rect;s$d.hitArea?s$h=s$d.hitArea:s$h.setTo(0,0,s$d.width,s$d.height),s$Z=s$h.contains(s$L,s$l)}return s$Z},s$d.runEvent=function(){var s$d=this._eventList.length;if(s$d){this.mouseEventTime=s$i.now();var s$L,s$l=0,s$Z=0,s$h=0;try{for(;s$l<s$d;){var s$_=this._eventList[s$l];switch("mousemove"!==s$_.type&&(this._prePoint.x=this._prePoint.y=-1e6),s$_.type){case"mousedown":this._touchIDs[0]=this._id++,s$x._isTouchRespond?s$x._isTouchRespond=!1:(this._isLeftMouse=0===s$_.button,this.initEvent(s$_),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===s$_.button,this.initEvent(s$_),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-s$_.clientX)+Math.abs(this._prePoint.y-s$_.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=s$_.clientX,this._prePoint.y=s$_.clientY,this.initEvent(s$_),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":s$x._isTouchRespond=!0,this._isLeftMouse=!0;var s$N=s$_.changedTouches;for(s$Z=0,s$h=s$N.length;s$Z<s$h;s$Z++)s$L=s$N[s$Z],(s$x.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=s$L.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[s$L.identifier]=this._id++,this.initEvent(s$L,s$_),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":s$x._isTouchRespond=!0,this._isLeftMouse=!0;var s$m=s$_.changedTouches;for(s$Z=0,s$h=s$m.length;s$Z<s$h;s$Z++)if(s$L=s$m[s$Z],s$x.multiTouchEnabled||s$L.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(s$L,s$_);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var s$u=s$_.changedTouches;for(s$Z=0,s$h=s$u.length;s$Z<s$h;s$Z++)s$L=s$u[s$Z],(s$x.multiTouchEnabled||s$L.identifier==this._curTouchID)&&(this.initEvent(s$L,s$_),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(s$_);break;case"mouseout":s$a.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}s$l++}}catch(s$d){throw this._eventList.length=0,s$d}this._eventList.length=0}},s$x.enabled=!0,s$x.multiTouchEnabled=!0,s$x._isTouchRespond=!1,s$x._isFirstTouch=!0,s$u(s$x,["instance",function(){return this.instance=new s$x}]),s$x}()),s$a=function(){function s$c(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new s$_}s$t(s$c,"laya.events.TouchManager");var s$d=s$c.prototype;return s$d._clearTempArrs=function(){s$c._oldArr.length=0,s$c._newArr.length=0,s$c._tEleArr.length=0},s$d.getTouchFromArr=function(s$d,s$L){var s$l,s$Z,s$h=0;for(s$l=s$L.length,s$h=0;s$h<s$l;s$h++)if((s$Z=s$L[s$h]).id==s$d)return s$Z;return null},s$d.removeTouchFromArr=function(s$d,s$L){var s$l=0;for(s$l=s$L.length-1;0<=s$l;s$l--)s$L[s$l].id==s$d&&s$L.splice(s$l,1)},s$d.createTouchO=function(s$d,s$L){var s$l;return(s$l=s$G.getItem("TouchData")||{}).id=s$L,s$l.tar=s$d,s$l},s$d.onMouseDown=function(s$d,s$L,s$l){var s$Z,s$h,s$_,s$N;(void 0===s$l&&(s$l=!1),this.enable)&&(s$Z=this.getTouchFromArr(s$L,this.preOvers),s$_=this.getEles(s$d,null,s$c._tEleArr),s$Z?s$Z.tar=s$d:(s$h=this.createTouchO(s$d,s$L),this.preOvers.push(s$h)),s$i.onMobile&&this.sendEvents(s$_,"mouseover",s$L),s$N=s$l?this.preDowns:this.preRightDowns,(s$Z=this.getTouchFromArr(s$L,s$N))?s$Z.tar=s$d:(s$h=this.createTouchO(s$d,s$L),s$N.push(s$h)),this.sendEvents(s$_,s$l?"mousedown":"rightmousedown",s$L),this._clearTempArrs())},s$d.sendEvents=function(s$d,s$L,s$l){void 0===s$l&&(s$l=0);var s$Z,s$h,s$_,s$N=0;for(s$Z=s$d.length,this._event._stoped=!1,s$h=s$d[0],s$N=0;s$N<s$Z;s$N++){if((s$_=s$d[s$N]).destroyed)return;if(s$_.event(s$L,this._event.setTo(s$L,s$_,s$h)),this._event._stoped)break}},s$d.getEles=function(s$d,s$L,s$l){for(s$l?s$l.length=0:s$l=[];s$d&&s$d!=s$L;)s$l.push(s$d),s$d=s$d.parent;return s$l},s$d.checkMouseOutAndOverOfMove=function(s$d,s$L,s$l){if(void 0===s$l&&(s$l=0),s$L!=s$d){var s$Z,s$h,s$_=0,s$N=0;if(s$L.contains(s$d))s$h=this.getEles(s$d,s$L,s$c._tEleArr),this.sendEvents(s$h,"mouseover",s$l);else if(s$d.contains(s$L))s$h=this.getEles(s$L,s$d,s$c._tEleArr),this.sendEvents(s$h,"mouseout",s$l);else{var s$m,s$u;(s$h=s$c._tEleArr).length=0,s$m=this.getEles(s$L,null,s$c._oldArr),s$u=this.getEles(s$d,null,s$c._newArr),s$N=s$m.length;var s$x=0;for(s$_=0;s$_<s$N;s$_++){if(s$Z=s$m[s$_],0<=(s$x=s$u.indexOf(s$Z))){s$u.splice(s$x,s$u.length-s$x);break}s$h.push(s$Z)}0<s$h.length&&this.sendEvents(s$h,"mouseout",s$l),0<s$u.length&&this.sendEvents(s$u,"mouseover",s$l)}}},s$d.onMouseMove=function(s$d,s$L){var s$l,s$Z;this.enable&&((s$l=this.getTouchFromArr(s$L,this.preOvers))?(this.checkMouseOutAndOverOfMove(s$d,s$l.tar),s$l.tar=s$d,s$Z=this.getEles(s$d,null,s$c._tEleArr)):(s$Z=this.getEles(s$d,null,s$c._tEleArr),this.sendEvents(s$Z,"mouseover",s$L),this.preOvers.push(this.createTouchO(s$d,s$L))),this.sendEvents(s$Z,"mousemove",s$L),this._clearTempArrs())},s$d.getLastOvers=function(){return(s$c._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,s$c._tEleArr):(s$c._tEleArr.push(s$$.stage),s$c._tEleArr)},s$d.stageMouseOut=function(){var s$d;s$d=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(s$d,"mouseout",0)},s$d.onMouseUp=function(s$d,s$L,s$l){if(void 0===s$l&&(s$l=!1),this.enable){var s$Z,s$h,s$_,s$N,s$m,s$u,s$x=0,s$t=0,s$b=s$i.onMobile;if(s$h=this.getEles(s$d,null,s$c._tEleArr),this.sendEvents(s$h,s$l?"mouseup":"rightmouseup",s$L),s$u=s$l?this.preDowns:this.preRightDowns,s$Z=this.getTouchFromArr(s$L,s$u)){var s$q,s$Y=s$i.now();if(s$q=s$Y-this._lastClickTime<300,this._lastClickTime=s$Y,s$d==s$Z.tar)s$m=s$h;else for(s$_=this.getEles(s$Z.tar,null,s$c._oldArr),(s$m=s$c._newArr).length=0,s$t=s$_.length,s$x=0;s$x<s$t;s$x++)s$N=s$_[s$x],0<=s$h.indexOf(s$N)&&s$m.push(s$N);0<s$m.length&&this.sendEvents(s$m,s$l?"click":"rightclick",s$L),s$l&&s$q&&this.sendEvents(s$m,"doubleclick",s$L),this.removeTouchFromArr(s$L,s$u),s$Z.tar=null,s$G.recover("TouchData",s$Z)}else;(s$Z=this.getTouchFromArr(s$L,this.preOvers))&&s$b&&((s$m=this.getEles(s$Z.tar,null,s$m))&&0<s$m.length&&this.sendEvents(s$m,"mouseout",s$L),this.removeTouchFromArr(s$L,this.preOvers),s$Z.tar=null,s$G.recover("TouchData",s$Z)),this._clearTempArrs()}},s$c._oldArr=[],s$c._newArr=[],s$c._tEleArr=[],s$u(s$c,["I",function(){return this.I=new s$c}]),s$c}(),s$k=function(){function s$d(){this._action=null}s$t(s$d,"laya.filters.Filter");var s$L=s$d.prototype;return s$$.imps(s$L,{"laya.filters.IFilter":!0}),s$L.callNative=function(s$d){},s$c(0,s$L,"type",function(){return-1}),s$c(0,s$L,"action",function(){return this._action}),s$d.BLUR=16,s$d.COLOR=32,s$d.GLOW=8,s$d._filterStart=null,s$d._filterEnd=null,s$d._EndTarget=null,s$d._recycleScope=null,s$d._filter=null,s$d._useSrc=null,s$d._endSrc=null,s$d._useOut=null,s$d._endOut=null,s$d}(),s$w=function(){function s$d(){this.data=null}s$t(s$d,"laya.filters.ColorFilterAction");var s$L=s$d.prototype;return s$$.imps(s$L,{"laya.filters.IFilterAction":!0}),s$L.apply=function(s$d){var s$L=s$d.ctx.ctx,s$l=s$d.ctx.ctx.canvas;if(0==s$l.width||0==s$l.height)return s$l;for(var s$Z,s$h=s$L.getImageData(0,0,s$l.width,s$l.height),s$_=s$h.data,s$N=0,s$m=s$_.length;s$N<s$m;s$N+=4)s$Z=this.getColor(s$_[s$N],s$_[s$N+1],s$_[s$N+2],s$_[s$N+3]),0!=s$_[s$N+3]&&(s$_[s$N]=s$Z[0],s$_[s$N+1]=s$Z[1],s$_[s$N+2]=s$Z[2],s$_[s$N+3]=s$Z[3]);return s$L.putImageData(s$h,0,0),s$d},s$L.getColor=function(s$d,s$L,s$l,s$Z){var s$h=[];if(this.data._mat&&this.data._alpha){var s$_=this.data._mat,s$N=this.data._alpha;s$h[0]=s$_[0]*s$d+s$_[1]*s$L+s$_[2]*s$l+s$_[3]*s$Z+s$N[0],s$h[1]=s$_[4]*s$d+s$_[5]*s$L+s$_[6]*s$l+s$_[7]*s$Z+s$N[1],s$h[2]=s$_[8]*s$d+s$_[9]*s$L+s$_[10]*s$l+s$_[11]*s$Z+s$N[2],s$h[3]=s$_[12]*s$d+s$_[13]*s$L+s$_[14]*s$l+s$_[15]*s$Z+s$N[3]}return s$h},s$d}(),s$s=(function(){function s$d(){}s$t(s$d,"laya.maths.Arith"),s$d.formatR=function(s$d){return s$d>Math.PI&&(s$d-=2*Math.PI),s$d<-Math.PI&&(s$d+=2*Math.PI),s$d},s$d.isPOT=function(s$d,s$L){return 0<s$d&&0==(s$d&s$d-1)&&0<s$L&&0==(s$L&s$L-1)},s$d.setMatToArray=function(s$d,s$L){s$d.a,s$d.b,s$d.c,s$d.d,s$d.tx,s$d.ty,s$L[0]=s$d.a,s$L[1]=s$d.b,s$L[4]=s$d.c,s$L[5]=s$d.d,s$L[12]=s$d.tx,s$L[13]=s$d.ty}}(),function(){function s$d(){this._controlPoints=[new s$O,new s$O,new s$O],this._calFun=this.getPoint2}s$t(s$d,"laya.maths.Bezier");var s$L=s$d.prototype;return s$L._switchPoint=function(s$d,s$L){var s$l=this._controlPoints.shift();s$l.setTo(s$d,s$L),this._controlPoints.push(s$l)},s$L.getPoint2=function(s$d,s$L){var s$l=this._controlPoints[0],s$Z=this._controlPoints[1],s$h=this._controlPoints[2],s$_=Math.pow(1-s$d,2)*s$l.x+2*s$d*(1-s$d)*s$Z.x+Math.pow(s$d,2)*s$h.x,s$N=Math.pow(1-s$d,2)*s$l.y+2*s$d*(1-s$d)*s$Z.y+Math.pow(s$d,2)*s$h.y;s$L.push(s$_,s$N)},s$L.getPoint3=function(s$d,s$L){var s$l=this._controlPoints[0],s$Z=this._controlPoints[1],s$h=this._controlPoints[2],s$_=this._controlPoints[3],s$N=Math.pow(1-s$d,3)*s$l.x+3*s$Z.x*s$d*(1-s$d)*(1-s$d)+3*s$h.x*s$d*s$d*(1-s$d)+s$_.x*Math.pow(s$d,3),s$m=Math.pow(1-s$d,3)*s$l.y+3*s$Z.y*s$d*(1-s$d)*(1-s$d)+3*s$h.y*s$d*s$d*(1-s$d)+s$_.y*Math.pow(s$d,3);s$L.push(s$N,s$m)},s$L.insertPoints=function(s$d,s$L){var s$l,s$Z=NaN;for(s$l=1/(s$d=0<s$d?s$d:5),s$Z=0;s$Z<=1;s$Z+=s$l)this._calFun(s$Z,s$L)},s$L.getBezierPoints=function(s$d,s$L,s$l){void 0===s$L&&(s$L=5),void 0===s$l&&(s$l=2);var s$Z,s$h,s$_=0;if((s$Z=s$d.length)<2*(s$l+1))return[];switch(s$h=[],s$l){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=s$l;)this._controlPoints.push(new s$O);for(s$_=0;s$_<2*s$l;s$_+=2)this._switchPoint(s$d[s$_],s$d[s$_+1]);for(s$_=2*s$l;s$_<s$Z;s$_+=2)this._switchPoint(s$d[s$_],s$d[s$_+1]),s$_/2%s$l==0&&this.insertPoints(s$L,s$h);return s$h},s$u(s$d,["I",function(){return this.I=new s$d}]),s$d}()),s$A=function(){function s$x(){}return s$t(s$x,"laya.maths.GrahamScan"),s$x.multiply=function(s$d,s$L,s$l){return(s$d.x-s$l.x)*(s$L.y-s$l.y)-(s$L.x-s$l.x)*(s$d.y-s$l.y)},s$x.dis=function(s$d,s$L){return(s$d.x-s$L.x)*(s$d.x-s$L.x)+(s$d.y-s$L.y)*(s$d.y-s$L.y)},s$x._getPoints=function(s$d,s$L,s$l){for(void 0===s$L&&(s$L=!1),s$x._mPointList||(s$x._mPointList=[]);s$x._mPointList.length<s$d;)s$x._mPointList.push(new s$O);return s$l||(s$l=[]),s$l.length=0,s$L?s$x.getFrom(s$l,s$x._mPointList,s$d):s$x.getFromR(s$l,s$x._mPointList,s$d),s$l},s$x.getFrom=function(s$d,s$L,s$l){var s$Z=0;for(s$Z=0;s$Z<s$l;s$Z++)s$d.push(s$L[s$Z]);return s$d},s$x.getFromR=function(s$d,s$L,s$l){var s$Z=0;for(s$Z=0;s$Z<s$l;s$Z++)s$d.push(s$L.pop());return s$d},s$x.pListToPointList=function(s$d,s$L){void 0===s$L&&(s$L=!1);var s$l=0,s$Z=s$d.length/2,s$h=s$x._getPoints(s$Z,s$L,s$x._tempPointList);for(s$l=0;s$l<s$Z;s$l++)s$h[s$l].setTo(s$d[s$l+s$l],s$d[s$l+s$l+1]);return s$h},s$x.pointListToPlist=function(s$d){var s$L,s$l=0,s$Z=s$d.length,s$h=s$x._temPList;for(s$l=s$h.length=0;s$l<s$Z;s$l++)s$L=s$d[s$l],s$h.push(s$L.x,s$L.y);return s$h},s$x.scanPList=function(s$d){return s$f.copyArray(s$d,s$x.pointListToPlist(s$x.scan(s$x.pListToPointList(s$d,!0))))},s$x.scan=function(s$d){var s$L,s$l,s$Z,s$h=0,s$_=0,s$N=0,s$m=s$d.length,s$u={};for((s$l=s$x._temArr).length=0,s$h=(s$m=s$d.length)-1;0<=s$h;s$h--)s$Z=(s$L=s$d[s$h]).x+"_"+s$L.y,s$u.hasOwnProperty(s$Z)||(s$u[s$Z]=!0,s$l.push(s$L));for(s$m=s$l.length,s$f.copyArray(s$d,s$l),s$h=1;s$h<s$m;s$h++)(s$d[s$h].y<s$d[s$N].y||s$d[s$h].y==s$d[s$N].y&&s$d[s$h].x<s$d[s$N].x)&&(s$N=s$h);for(s$L=s$d[0],s$d[0]=s$d[s$N],s$d[s$N]=s$L,s$h=1;s$h<s$m-1;s$h++){for(s$_=(s$N=s$h)+1;s$_<s$m;s$_++)(0<s$x.multiply(s$d[s$_],s$d[s$N],s$d[0])||0==s$x.multiply(s$d[s$_],s$d[s$N],s$d[0])&&s$x.dis(s$d[0],s$d[s$_])<s$x.dis(s$d[0],s$d[s$N]))&&(s$N=s$_);s$L=s$d[s$h],s$d[s$h]=s$d[s$N],s$d[s$N]=s$L}if((s$l=s$x._temArr).length=0,s$d.length<3)return s$f.copyArray(s$l,s$d);for(s$l.push(s$d[0],s$d[1],s$d[2]),s$h=3;s$h<s$m;s$h++){for(;2<=s$l.length&&0<=s$x.multiply(s$d[s$h],s$l[s$l.length-1],s$l[s$l.length-2]);)s$l.pop();s$d[s$h]&&s$l.push(s$d[s$h])}return s$l},s$x._mPointList=null,s$x._tempPointList=[],s$x._temPList=[],s$x._temArr=[],s$x}(),s$y=function(){function s$h(){}return s$t(s$h,"laya.maths.MathUtil"),s$h.subtractVector3=function(s$d,s$L,s$l){s$l[0]=s$d[0]-s$L[0],s$l[1]=s$d[1]-s$L[1],s$l[2]=s$d[2]-s$L[2]},s$h.lerp=function(s$d,s$L,s$l){return s$d*(1-s$l)+s$L*s$l},s$h.scaleVector3=function(s$d,s$L,s$l){s$l[0]=s$d[0]*s$L,s$l[1]=s$d[1]*s$L,s$l[2]=s$d[2]*s$L},s$h.lerpVector3=function(s$d,s$L,s$l,s$Z){var s$h=s$d[0],s$_=s$d[1],s$N=s$d[2];s$Z[0]=s$h+s$l*(s$L[0]-s$h),s$Z[1]=s$_+s$l*(s$L[1]-s$_),s$Z[2]=s$N+s$l*(s$L[2]-s$N)},s$h.lerpVector4=function(s$d,s$L,s$l,s$Z){var s$h=s$d[0],s$_=s$d[1],s$N=s$d[2],s$m=s$d[3];s$Z[0]=s$h+s$l*(s$L[0]-s$h),s$Z[1]=s$_+s$l*(s$L[1]-s$_),s$Z[2]=s$N+s$l*(s$L[2]-s$N),s$Z[3]=s$m+s$l*(s$L[3]-s$m)},s$h.slerpQuaternionArray=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m,s$u,s$x,s$t,s$b,s$q=s$d[s$L+0],s$Y=s$d[s$L+1],s$c=s$d[s$L+2],s$r=s$d[s$L+3],s$a=s$l[s$Z+0],s$k=s$l[s$Z+1],s$e=s$l[s$Z+2],s$w=s$l[s$Z+3];return(s$u=s$q*s$a+s$Y*s$k+s$c*s$e+s$r*s$w)<0&&(s$u=-s$u,s$a=-s$a,s$k=-s$k,s$e=-s$e,s$w=-s$w),s$b=1e-6<1-s$u?(s$m=Math.acos(s$u),s$x=Math.sin(s$m),s$t=Math.sin((1-s$h)*s$m)/s$x,Math.sin(s$h*s$m)/s$x):(s$t=1-s$h,s$h),s$_[s$N+0]=s$t*s$q+s$b*s$a,s$_[s$N+1]=s$t*s$Y+s$b*s$k,s$_[s$N+2]=s$t*s$c+s$b*s$e,s$_[s$N+3]=s$t*s$r+s$b*s$w,s$_},s$h.getRotation=function(s$d,s$L,s$l,s$Z){return Math.atan2(s$Z-s$L,s$l-s$d)/Math.PI*180},s$h.sortBigFirst=function(s$d,s$L){return s$d==s$L?0:s$d<s$L?1:-1},s$h.sortSmallFirst=function(s$d,s$L){return s$d==s$L?0:s$d<s$L?-1:1},s$h.sortNumBigFirst=function(s$d,s$L){return parseFloat(s$L)-parseFloat(s$d)},s$h.sortNumSmallFirst=function(s$d,s$L){return parseFloat(s$d)-parseFloat(s$L)},s$h.sortByKey=function(s$l,s$d,s$L){var s$Z;return void 0===s$d&&(s$d=!1),void 0===s$L&&(s$L=!0),s$Z=s$d?s$L?s$h.sortNumBigFirst:s$h.sortBigFirst:s$L?s$h.sortNumSmallFirst:s$h.sortSmallFirst,function(s$d,s$L){return s$Z(s$d[s$l],s$L[s$l])}},s$h}(),s$E=function(){function s$l(s$d,s$L,s$l,s$Z,s$h,s$_){this.inPool=!1,this.bTransform=!1,void 0===s$d&&(s$d=1),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=1),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=0),this.a=s$d,this.b=s$L,this.c=s$l,this.d=s$Z,this.tx=s$h,this.ty=s$_,this._checkTransform()}s$t(s$l,"laya.maths.Matrix");var s$d=s$l.prototype;return s$d.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},s$d._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},s$d.setTranslate=function(s$d,s$L){return this.tx=s$d,this.ty=s$L,this},s$d.translate=function(s$d,s$L){return this.tx+=s$d,this.ty+=s$L,this},s$d.scale=function(s$d,s$L){this.a*=s$d,this.d*=s$L,this.c*=s$d,this.b*=s$L,this.tx*=s$d,this.ty*=s$L,this.bTransform=!0},s$d.rotate=function(s$d){var s$L=Math.cos(s$d),s$l=Math.sin(s$d),s$Z=this.a,s$h=this.c,s$_=this.tx;this.a=s$Z*s$L-this.b*s$l,this.b=s$Z*s$l+this.b*s$L,this.c=s$h*s$L-this.d*s$l,this.d=s$h*s$l+this.d*s$L,this.tx=s$_*s$L-this.ty*s$l,this.ty=s$_*s$l+this.ty*s$L,this.bTransform=!0},s$d.skew=function(s$d,s$L){var s$l=Math.tan(s$d),s$Z=Math.tan(s$L),s$h=this.a,s$_=this.b;return this.a+=s$Z*this.c,this.b+=s$Z*this.d,this.c+=s$l*s$h,this.d+=s$l*s$_,this},s$d.invertTransformPoint=function(s$d){var s$L=this.a,s$l=this.b,s$Z=this.c,s$h=this.d,s$_=this.tx,s$N=s$L*s$h-s$l*s$Z,s$m=s$h/s$N,s$u=-s$l/s$N,s$x=-s$Z/s$N,s$t=s$L/s$N,s$b=(s$Z*this.ty-s$h*s$_)/s$N,s$q=-(s$L*this.ty-s$l*s$_)/s$N;return s$d.setTo(s$m*s$d.x+s$x*s$d.y+s$b,s$u*s$d.x+s$t*s$d.y+s$q)},s$d.transformPoint=function(s$d){return s$d.setTo(this.a*s$d.x+this.c*s$d.y+this.tx,this.b*s$d.x+this.d*s$d.y+this.ty)},s$d.transformPointN=function(s$d){return s$d.setTo(this.a*s$d.x+this.c*s$d.y,this.b*s$d.x+this.d*s$d.y)},s$d.transformPointArray=function(s$d,s$L){for(var s$l=s$d.length,s$Z=0;s$Z<s$l;s$Z+=2){var s$h=s$d[s$Z],s$_=s$d[s$Z+1];s$L[s$Z]=this.a*s$h+this.c*s$_+this.tx,s$L[s$Z+1]=this.b*s$h+this.d*s$_+this.ty}return s$L},s$d.transformPointArrayScale=function(s$d,s$L){for(var s$l=s$d.length,s$Z=0;s$Z<s$l;s$Z+=2){var s$h=s$d[s$Z],s$_=s$d[s$Z+1];s$L[s$Z]=this.a*s$h+this.c*s$_,s$L[s$Z+1]=this.b*s$h+this.d*s$_}return s$L},s$d.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},s$d.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},s$d.invert=function(){var s$d=this.a,s$L=this.b,s$l=this.c,s$Z=this.d,s$h=this.tx,s$_=s$d*s$Z-s$L*s$l;return this.a=s$Z/s$_,this.b=-s$L/s$_,this.c=-s$l/s$_,this.d=s$d/s$_,this.tx=(s$l*this.ty-s$Z*s$h)/s$_,this.ty=-(s$d*this.ty-s$L*s$h)/s$_,this},s$d.setTo=function(s$d,s$L,s$l,s$Z,s$h,s$_){return this.a=s$d,this.b=s$L,this.c=s$l,this.d=s$Z,this.tx=s$h,this.ty=s$_,this},s$d.concat=function(s$d){var s$L=this.a,s$l=this.c,s$Z=this.tx;return this.a=s$L*s$d.a+this.b*s$d.c,this.b=s$L*s$d.b+this.b*s$d.d,this.c=s$l*s$d.a+this.d*s$d.c,this.d=s$l*s$d.b+this.d*s$d.d,this.tx=s$Z*s$d.a+this.ty*s$d.c+s$d.tx,this.ty=s$Z*s$d.b+this.ty*s$d.d+s$d.ty,this},s$d.scaleEx=function(s$d,s$L){var s$l=this.a,s$Z=this.b,s$h=this.c,s$_=this.d;0!==s$Z||0!==s$h?(this.a=s$d*s$l,this.b=s$d*s$Z,this.c=s$L*s$h):(this.a=s$d*s$l,this.b=0*s$_,this.c=0*s$l),this.d=s$L*s$_,this.bTransform=!0},s$d.rotateEx=function(s$d){var s$L=Math.cos(s$d),s$l=Math.sin(s$d),s$Z=this.a,s$h=this.b,s$_=this.c,s$N=this.d;0!==s$h||0!==s$_?(this.a=s$L*s$Z+s$l*s$_,this.b=s$L*s$h+s$l*s$N,this.c=-s$l*s$Z+s$L*s$_,this.d=-s$l*s$h+s$L*s$N):(this.a=s$L*s$Z,this.b=s$l*s$N,this.c=-s$l*s$Z,this.d=s$L*s$N),this.bTransform=!0},s$d.clone=function(){var s$d=s$l.create();return s$d.a=this.a,s$d.b=this.b,s$d.c=this.c,s$d.d=this.d,s$d.tx=this.tx,s$d.ty=this.ty,s$d.bTransform=this.bTransform,s$d},s$d.copyTo=function(s$d){return s$d.a=this.a,s$d.b=this.b,s$d.c=this.c,s$d.d=this.d,s$d.tx=this.tx,s$d.ty=this.ty,s$d.bTransform=this.bTransform,s$d},s$d.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},s$d.destroy=function(){if(!this.inPool){var s$d=s$l._cache;this.inPool=!0,s$d._length||(s$d._length=0),(s$d[s$d._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},s$l.mul=function(s$d,s$L,s$l){var s$Z=s$d.a,s$h=s$d.b,s$_=s$d.c,s$N=s$d.d,s$m=s$d.tx,s$u=s$d.ty,s$x=s$L.a,s$t=s$L.b,s$b=s$L.c,s$q=s$L.d,s$Y=s$L.tx,s$c=s$L.ty;return 0!==s$t||0!==s$b?(s$l.a=s$Z*s$x+s$h*s$b,s$l.b=s$Z*s$t+s$h*s$q,s$l.c=s$_*s$x+s$N*s$b,s$l.d=s$_*s$t+s$N*s$q,s$l.tx=s$x*s$m+s$b*s$u+s$Y,s$l.ty=s$t*s$m+s$q*s$u+s$c):(s$l.a=s$Z*s$x,s$l.b=s$h*s$q,s$l.c=s$_*s$x,s$l.d=s$N*s$q,s$l.tx=s$x*s$m+s$Y,s$l.ty=s$q*s$u+s$c),s$l},s$l.mul16=function(s$d,s$L,s$l){var s$Z=s$d.a,s$h=s$d.b,s$_=s$d.c,s$N=s$d.d,s$m=s$d.tx,s$u=s$d.ty,s$x=s$L.a,s$t=s$L.b,s$b=s$L.c,s$q=s$L.d,s$Y=s$L.tx,s$c=s$L.ty;return 0!==s$t||0!==s$b?(s$l[0]=s$Z*s$x+s$h*s$b,s$l[1]=s$Z*s$t+s$h*s$q,s$l[4]=s$_*s$x+s$N*s$b,s$l[5]=s$_*s$t+s$N*s$q,s$l[12]=s$x*s$m+s$b*s$u+s$Y,s$l[13]=s$t*s$m+s$q*s$u+s$c):(s$l[0]=s$Z*s$x,s$l[1]=s$h*s$q,s$l[4]=s$_*s$x,s$l[5]=s$N*s$q,s$l[12]=s$x*s$m+s$Y,s$l[13]=s$q*s$u+s$c),s$l},s$l.mulPre=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=s$d.a,s$x=s$d.b,s$t=s$d.c,s$b=s$d.d,s$q=s$d.tx,s$Y=s$d.ty;return 0!==s$l||0!==s$Z?(s$m.a=s$u*s$L+s$x*s$Z,s$m.b=s$u*s$l+s$x*s$h,s$m.c=s$t*s$L+s$b*s$Z,s$m.d=s$t*s$l+s$b*s$h,s$m.tx=s$L*s$q+s$Z*s$Y+s$_,s$m.ty=s$l*s$q+s$h*s$Y+s$N):(s$m.a=s$u*s$L,s$m.b=s$x*s$h,s$m.c=s$t*s$L,s$m.d=s$b*s$h,s$m.tx=s$L*s$q+s$_,s$m.ty=s$h*s$Y+s$N),s$m},s$l.mulPos=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=s$d.a,s$x=s$d.b,s$t=s$d.c,s$b=s$d.d,s$q=s$d.tx,s$Y=s$d.ty;return 0!==s$x||0!==s$t?(s$m.a=s$L*s$u+s$l*s$t,s$m.b=s$L*s$x+s$l*s$b,s$m.c=s$Z*s$u+s$h*s$t,s$m.d=s$Z*s$x+s$h*s$b,s$m.tx=s$u*s$_+s$t*s$N+s$q,s$m.ty=s$x*s$_+s$b*s$N+s$Y):(s$m.a=s$L*s$u,s$m.b=s$l*s$b,s$m.c=s$Z*s$u,s$m.d=s$h*s$b,s$m.tx=s$u*s$_+s$q,s$m.ty=s$b*s$N+s$Y),s$m},s$l.preMul=function(s$d,s$L,s$l){var s$Z=s$d.a,s$h=s$d.b,s$_=s$d.c,s$N=s$d.d,s$m=s$L.a,s$u=s$L.b,s$x=s$L.c,s$t=s$L.d,s$b=s$L.tx,s$q=s$L.ty;return s$l.a=s$m*s$Z,s$l.b=s$l.c=0,s$l.d=s$t*s$N,s$l.tx=s$b*s$Z+s$d.tx,s$l.ty=s$q*s$N+s$d.ty,0===s$u&&0===s$x&&0===s$h&&0===s$_||(s$l.a+=s$u*s$_,s$l.d+=s$x*s$h,s$l.b+=s$m*s$h+s$u*s$N,s$l.c+=s$x*s$Z+s$t*s$_,s$l.tx+=s$q*s$_,s$l.ty+=s$b*s$h),s$l},s$l.preMulXY=function(s$d,s$L,s$l,s$Z){var s$h=s$d.a,s$_=s$d.b,s$N=s$d.c,s$m=s$d.d;return s$Z.a=s$h,s$Z.b=s$_,s$Z.c=s$N,s$Z.d=s$m,s$Z.tx=s$L*s$h+s$d.tx+s$l*s$N,s$Z.ty=s$l*s$m+s$d.ty+s$L*s$_,s$Z},s$l.create=function(){var s$d=s$l._cache,s$L=s$d._length?s$d[--s$d._length]:new s$l;return s$L.inPool=!1,s$L},s$l.EMPTY=new s$l,s$l.TEMP=new s$l,s$l._cache=[],s$l}(),s$O=function(){function s$d(s$d,s$L){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),this.x=s$d,this.y=s$L}s$t(s$d,"laya.maths.Point");var s$L=s$d.prototype;return s$L.setTo=function(s$d,s$L){return this.x=s$d,this.y=s$L,this},s$L.distance=function(s$d,s$L){return Math.sqrt((this.x-s$d)*(this.x-s$d)+(this.y-s$L)*(this.y-s$L))},s$L.toString=function(){return this.x+","+this.y},s$L.normalize=function(){var s$d=Math.sqrt(this.x*this.x+this.y*this.y);if(0<s$d){var s$L=1/s$d;this.x*=s$L,this.y*=s$L}},s$d.TEMP=new s$d,s$d.EMPTY=new s$d,s$d}(),s$n=function(){function s$x(s$d,s$L,s$l,s$Z){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),this.x=s$d,this.y=s$L,this.width=s$l,this.height=s$Z}s$t(s$x,"laya.maths.Rectangle");var s$d=s$x.prototype;return s$d.setTo=function(s$d,s$L,s$l,s$Z){return this.x=s$d,this.y=s$L,this.width=s$l,this.height=s$Z,this},s$d.copyFrom=function(s$d){return this.x=s$d.x,this.y=s$d.y,this.width=s$d.width,this.height=s$d.height,this},s$d.contains=function(s$d,s$L){return!(this.width<=0||this.height<=0)&&(s$d>=this.x&&s$d<this.right&&s$L>=this.y&&s$L<this.bottom)},s$d.intersects=function(s$d){return!(s$d.x>this.x+this.width||s$d.x+s$d.width<this.x||s$d.y>this.y+this.height||s$d.y+s$d.height<this.y)},s$d.intersection=function(s$d,s$L){return this.intersects(s$d)?(s$L||(s$L=new s$x),s$L.x=Math.max(this.x,s$d.x),s$L.y=Math.max(this.y,s$d.y),s$L.width=Math.min(this.right,s$d.right)-s$L.x,s$L.height=Math.min(this.bottom,s$d.bottom)-s$L.y,s$L):null},s$d.union=function(s$d,s$L){return s$L||(s$L=new s$x),this.clone(s$L),s$d.width<=0||s$d.height<=0?s$L:(s$L.addPoint(s$d.x,s$d.y),s$L.addPoint(s$d.right,s$d.bottom),this)},s$d.clone=function(s$d){return s$d||(s$d=new s$x),s$d.x=this.x,s$d.y=this.y,s$d.width=this.width,s$d.height=this.height,s$d},s$d.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},s$d.equals=function(s$d){return!(!s$d||s$d.x!==this.x||s$d.y!==this.y||s$d.width!==this.width||s$d.height!==this.height)},s$d.addPoint=function(s$d,s$L){return this.x>s$d&&(this.width+=this.x-s$d,this.x=s$d),this.y>s$L&&(this.height+=this.y-s$L,this.y=s$L),this.width<s$d-this.x&&(this.width=s$d-this.x),this.height<s$L-this.y&&(this.height=s$L-this.y),this},s$d._getBoundPoints=function(){var s$d=s$x._temB;return(s$d.length=0)==this.width||0==this.height||s$d.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),s$d},s$d.isEmpty=function(){return this.width<=0||this.height<=0},s$c(0,s$d,"right",function(){return this.x+this.width}),s$c(0,s$d,"bottom",function(){return this.y+this.height}),s$x._getBoundPointS=function(s$d,s$L,s$l,s$Z){var s$h=s$x._temA;return(s$h.length=0)==s$l||0==s$Z||s$h.push(s$d,s$L,s$d+s$l,s$L,s$d,s$L+s$Z,s$d+s$l,s$L+s$Z),s$h},s$x._getWrapRec=function(s$d,s$L){if(!s$d||s$d.length<1)return s$L?s$L.setTo(0,0,0,0):s$x.TEMP.setTo(0,0,0,0);s$L=s$L||new s$x;var s$l,s$Z,s$h,s$_,s$N,s$m=s$d.length,s$u=s$O.TEMP;for(s$h=s$N=-(s$Z=s$_=99999),s$l=0;s$l<s$m;s$l+=2)s$u.x=s$d[s$l],s$u.y=s$d[s$l+1],s$Z=s$Z<s$u.x?s$Z:s$u.x,s$_=s$_<s$u.y?s$_:s$u.y,s$h=s$h>s$u.x?s$h:s$u.x,s$N=s$N>s$u.y?s$N:s$u.y;return s$L.setTo(s$Z,s$_,s$h-s$Z,s$N-s$_)},s$x.EMPTY=new s$x,s$x.TEMP=new s$x,s$x._temB=[],s$x._temA=[],s$x}(),s$g=function(){function s$u(){}return s$t(s$u,"laya.media.SoundManager"),s$c(1,s$u,"useAudioMusic",function(){return s$u._useAudioMusic},function(s$d){s$u._useAudioMusic=s$d,s$u._musicClass=s$d?s$ld:null}),s$c(1,s$u,"autoStopMusic",function(){return s$u._autoStopMusic},function(s$d){s$$.stage.off("blur",null,s$u._stageOnBlur),s$$.stage.off("focus",null,s$u._stageOnFocus),s$$.stage.off("visibilitychange",null,s$u._visibilityChange),(s$u._autoStopMusic=s$d)&&(s$$.stage.on("blur",null,s$u._stageOnBlur),s$$.stage.on("focus",null,s$u._stageOnFocus),s$$.stage.on("visibilitychange",null,s$u._visibilityChange))}),s$c(1,s$u,"muted",function(){return s$u._muted},function(s$d){s$d!=s$u._muted&&(s$d&&s$u.stopAllSound(),s$u.musicMuted=s$d,s$u._muted=s$d)}),s$c(1,s$u,"musicMuted",function(){return s$u._musicMuted},function(s$d){s$d!=s$u._musicMuted&&(s$d?(s$u._tMusic&&s$u._musicChannel&&!s$u._musicChannel.isStopped?s$u._musicChannel.pause():s$u._musicChannel=null,s$u._musicMuted=s$d):(s$u._musicMuted=s$d,s$u._tMusic&&s$u._musicChannel&&s$u._musicChannel.resume()))}),s$c(1,s$u,"soundMuted",function(){return s$u._soundMuted},function(s$d){s$u._soundMuted=s$d}),s$u.addChannel=function(s$d){0<=s$u._channels.indexOf(s$d)||(s$u._channels.push(s$d),s$u.autoReleaseSound&&0!=s$u._notUsedCount&&s$u._notUsedUrls[s$d.url]&&(delete s$u._notUsedUrls[s$d.url],0==--s$u._notUsedCount&&s$$.timer.clear(s$u,s$u.disposeSoundIfNotUsed)))},s$u.removeChannel=function(s$d){var s$L=s$u._channels,s$l=s$L.indexOf(s$d);if(-1!=s$l&&(s$L.splice(s$l,1),s$u.autoReleaseSound)){var s$Z=s$d.url,s$h=s$u.defaultIntervals[s$Z]||2e4;if(0<s$h){var s$_=!0;for(s$l=s$L.length-1;0<=s$l;s$l--)if(s$L[s$l].url==s$Z){s$_=!1;break}s$_&&(s$u._notUsedUrls[s$Z]=Date.now()+s$h,0==s$u._notUsedCount++&&s$$.timer.loop(1e4,s$u,s$u.disposeSoundIfNotUsed))}}},s$u.disposeSoundIfNotUsed=function(){var s$d=s$u._notUsedUrls;if(0!=s$u._notUsedCount){var s$L=Date.now();for(var s$l in s$d)s$L>=s$d[s$l]&&(delete s$d[s$l],--s$u._notUsedCount,s$u.destroySound(s$l));if(0!=s$u._notUsedCount)return}s$$.timer.clear(s$u,s$u.disposeSoundIfNotUsed)},s$u._visibilityChange=function(){s$$.stage.isVisibility?s$u._stageOnFocus():s$u._stageOnBlur()},s$u._stageOnBlur=function(){s$u._isActive=!1,s$u._musicChannel&&(s$u._musicChannel.isStopped||(s$u._blurPaused=!0,s$u._musicChannel.pause())),s$u.stopAllSound(),s$$.stage.once("mousedown",null,s$u._stageOnFocus)},s$u._recoverWebAudio=function(){s$_d.ctx&&"running"!=s$_d.ctx.state&&s$_d.ctx.resume&&s$_d.ctx.resume()},s$u._stageOnFocus=function(){if(s$u._isActive=!0,s$u._recoverWebAudio(),s$$.stage.off("mousedown",null,s$u._stageOnFocus),s$u._blurPaused){var s$d=s$u._musicChannel;s$d&&s$u._music&&s$d.isStopped&&(s$u._blurPaused=!1,s$u._music._disposed?s$u.playMusic(s$d.url,s$d.loops,s$d.startHandler,s$d.completeHandler,s$d.startTime):s$d.audioBuffer?s$d.resume():s$u._music.play(s$d.startTime,s$d.loops,s$d.startHandler,s$d))}},s$u.playSound=function(s$d,s$L,s$l,s$Z,s$h,s$_){if(void 0===s$L&&(s$L=1),void 0===s$_&&(s$_=0),!s$d)return null;if(s$u._muted)return null;if(s$u._recoverWebAudio(),s$d==s$u._tMusic){if(s$u._musicMuted)return null}else{if(!s$u._isActive)return null;if(s$u._soundMuted)return null}var s$N,s$m=s$u._pool[s$d];return s$h||(s$h=s$u._soundClass),s$m||((s$m=new s$h).load(s$d),s$u._pool[s$d]=s$m),(s$N=s$m.play(s$_,s$L,s$l))?(s$d==s$u._tMusic&&(s$u._music=s$m,s$u._isActive||(s$u._blurPaused=!0,s$N.pause())),s$N.url=s$d,s$N.volume=s$d==s$u._tMusic?s$u.musicVolume:s$u.soundVolume,s$N.completeHandler=s$Z,s$N):null},s$u.destroySound=function(s$d){var s$L=s$u._pool[s$d];s$L&&(delete s$u._pool[s$d],s$L.dispose())},s$u.playMusic=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$L&&(s$L=0),void 0===s$h&&(s$h=0),s$u._tMusic=s$d,s$u._musicChannel&&s$u._musicChannel.stop(),s$u._musicChannel=s$u.playSound(s$d,s$L,s$l,s$Z,null,s$h)},s$u.stopSound=function(s$d){for(var s$L,s$l=s$u._channels.length-1;0<=s$l;s$l--)(s$L=s$u._channels[s$l]).url==s$d&&s$L.stop()},s$u.stopAll=function(){s$u._tMusic=null;var s$d=0;for(s$d=s$u._channels.length-1;0<=s$d;s$d--)s$u._channels[s$d].stop()},s$u.stopAllSound=function(){var s$d,s$L=0;for(s$L=s$u._channels.length-1;0<=s$L;s$L--)(s$d=s$u._channels[s$L]).url!=s$u._tMusic&&s$d.stop()},s$u.stopMusic=function(){s$u._musicChannel&&s$u._musicChannel.stop(),s$u._tMusic=null},s$u.setSoundVolume=function(s$d,s$L){if(s$L)s$u._setVolume(s$L,s$d);else{s$u.soundVolume=s$d;var s$l,s$Z=0;for(s$Z=s$u._channels.length-1;0<=s$Z;s$Z--)(s$l=s$u._channels[s$Z]).url!=s$u._tMusic&&(s$l.volume=s$d)}},s$u.setMusicVolume=function(s$d){s$u.musicVolume=s$d,s$u._setVolume(s$u._tMusic,s$d)},s$u._setVolume=function(s$d,s$L){for(var s$l,s$Z=s$u._channels.length-1;0<=s$Z;s$Z--)(s$l=s$u._channels[s$Z]).url==s$d&&(s$l.volume=s$L)},s$u.musicVolume=1,s$u.soundVolume=1,s$u.playbackRate=1,s$u._useAudioMusic=!0,s$u._muted=!1,s$u._soundMuted=!1,s$u._musicMuted=!1,s$u._tMusic=null,s$u._musicChannel=null,s$u._music=null,s$u._channels=[],s$u._autoStopMusic=!1,s$u._blurPaused=!1,s$u._isActive=!0,s$u._soundClass=null,s$u._musicClass=null,s$u.autoReleaseSound=!0,s$u._pool={},s$u.defaultIntervals={},s$u._notUsedUrls={},s$u._notUsedCount=0,s$u}(),s$V=function(){var s$d;function s$l(){}return s$t(s$l,"laya.net.LocalStorage"),s$l.__init__=function(){s$l._baseClass||(s$l._baseClass=s$d).init(),s$l.items=s$l._baseClass.items,s$l.support=s$l._baseClass.support},s$l.setItem=function(s$d,s$L){s$l._baseClass.setItem(s$d,s$L)},s$l.getItem=function(s$d){return s$l._baseClass.getItem(s$d)},s$l.setJSON=function(s$d,s$L){s$l._baseClass.setJSON(s$d,s$L)},s$l.getJSON=function(s$d){return s$l._baseClass.getJSON(s$d)},s$l.removeItem=function(s$d){s$l._baseClass.removeItem(s$d)},s$l.clear=function(){s$l._baseClass.clear()},s$l._baseClass=null,s$l.items=null,s$l.support=!1,s$l.__init$=function(){s$d=function(){function s$l(){}return s$t(s$l,""),s$l.init=function(){try{s$l.support=!0,s$l.items=s$N.localStorage,s$l.setItem("laya","1"),s$l.removeItem("laya")}catch(s$d){s$l.support=!1}s$l.support||console.log("LocalStorage is not supprot or browser is private mode.")},s$l.setItem=function(s$d,s$L){try{s$l.support&&s$l.items.setItem(s$d,s$L)}catch(s$d){console.warn("set localStorage failed",s$d)}},s$l.getItem=function(s$d){return s$l.support?s$l.items.getItem(s$d):null},s$l.setJSON=function(s$d,s$L){try{s$l.support&&s$l.items.setItem(s$d,JSON.stringify(s$L))}catch(s$d){console.warn("set localStorage failed",s$d)}},s$l.getJSON=function(s$d){return JSON.parse(s$l.support?s$l.items.getItem(s$d):null)},s$l.removeItem=function(s$d){s$l.support&&s$l.items.removeItem(s$d)},s$l.clear=function(){s$l.support&&s$l.items.clear()},s$l.items=null,s$l.support=!1,s$l}()},s$l}(),s$I=(function(){function s$Z(){}s$t(s$Z,"laya.net.ResourceVersion"),s$Z.enable=function(s$d,s$L,s$l){void 0===s$l&&(s$l=2),laya.net.ResourceVersion.type=s$l,s$$.loader.load(s$d,s$e.create(null,s$Z.onManifestLoaded,[s$L]),null,"json"),s$p.customFormat=s$Z.addVersionPrefix},s$Z.onManifestLoaded=function(s$d,s$L){s$Z.manifest=s$L,s$d.run(),s$L||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},s$Z.addVersionPrefix=function(s$d){return s$Z.manifest&&s$Z.manifest[s$d]?2==s$Z.type?s$Z.manifest[s$d]:s$Z.manifest[s$d]+"/"+s$d:s$d},s$Z.FOLDER_VERSION=1,s$Z.FILENAME_VERSION=2,s$Z.manifest=null,s$Z.type=1}(),function(){function s$d(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}s$t(s$d,"laya.net.TTFLoader");var s$L=s$d.prototype;return s$L.load=function(s$d){var s$L=(this._url=s$d).split(".ttf")[0].split("/");this.fontName=s$L[s$L.length-1],s$i.window.conch?this._loadConch():s$i.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},s$L._loadConch=function(){this._http=new s$Nd,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},s$L._onHttpLoaded=function(s$d){s$i.window.conch.setFontFaceFromBuffer(this.fontName,s$d),this._clearHttp(),this._complete()},s$L._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},s$L._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},s$L._complete=function(){s$$.timer.clear(this,this._complete),s$$.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},s$L._checkComplete=function(){s$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},s$L._loadWithFontFace=function(){var s$d=new s$i.window.FontFace(this.fontName,"url('"+this._url+"')");s$i.window.document.fonts.add(s$d);var s$L=this;s$d.loaded.then(function(){s$L._complete()}),s$d.load()},s$L._createDiv=function(){this._div=s$i.createElement("div"),this._div.innerHTML="laya";var s$d=this._div.style;s$d.fontFamily=this.fontName,s$d.position="absolute",s$d.left="-100px",s$d.top="-100px",s$i.document.body.appendChild(this._div)},s$L._loadWithCSS=function(){var s$d=this,s$L=s$i.createElement("style");s$L.type="text/css",s$i.document.body.appendChild(s$L),s$L.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=s$F.measureText("LayaTTFFont",this._fontTxt).width;var s$l=this;s$L.onload=function(){s$$.timer.once(1e4,s$l,s$d._complete)},s$$.timer.loop(20,this,this._checkComplete),this._createDiv()},s$d._testString="LayaTTFFont",s$d}()),s$p=function(){function s$Z(s$d){this._url=null,this._path=null,this._url=s$Z.formatURL(s$d),this._path=s$Z.getPath(s$d)}s$t(s$Z,"laya.net.URL");var s$d=s$Z.prototype;return s$c(0,s$d,"path",function(){return this._path}),s$c(0,s$d,"url",function(){return this._url}),s$Z.formatURL=function(s$d,s$L){if(!s$d)return"null path";if(0<s$d.indexOf(":"))return s$d;null!=s$Z.customFormat&&(s$d=s$Z.customFormat(s$d,s$L));var s$l=s$d.charAt(0);if("."===s$l)return s$Z.formatRelativePath((s$L||s$Z.basePath)+s$d);if("~"===s$l)return s$Z.rootPath+s$d.substring(1);if("d"===s$l){if(0===s$d.indexOf("data:image"))return s$d}else if("/"===s$l)return s$d;return(s$L||s$Z.basePath)+s$d},s$Z.formatRelativePath=function(s$d){for(var s$L=s$d.split("/"),s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)".."==s$L[s$l]&&(s$L.splice(s$l-1,2),s$l-=2);return s$L.join("/")},s$Z.isAbsolute=function(s$d){return 0<s$d.indexOf(":")||"/"==s$d.charAt(0)},s$Z.getPath=function(s$d){var s$L=s$d.lastIndexOf("/");return 0<s$L?s$d.substr(0,s$L+1):""},s$Z.getFileName=function(s$d){var s$L=s$d.lastIndexOf("/");return 0<s$L?s$d.substr(s$L+1):s$d},s$Z.version={},s$Z.basePath="",s$Z.rootPath="",s$Z.customFormat=function(s$d){var s$L=s$Z.version[s$d];return!s$H.isConchApp&&s$L&&(s$d+="?v="+s$L),s$d},s$Z}(),s$H=function(){function s$h(s$d,s$L){this._timeId=0;var s$l=s$h._mainCanvas.source.style;s$l.position="absolute",s$l.top=s$l.left="0px",s$l.background="#000000",s$h._mainCanvas.source.id="layaCanvas";var s$Z=laya.renders.Render.isWebGL;s$h._mainCanvas.source.width=s$d,s$h._mainCanvas.source.height=s$L,s$Z&&s$h.WebGL.init(s$h._mainCanvas,s$d,s$L),s$i.container.appendChild(s$h._mainCanvas.source),(s$h._context=new s$X(s$d,s$L,s$Z?null:s$h._mainCanvas)).ctx.setIsMainContext(),s$i.window.requestAnimationFrame(function s$d(s$L){s$i.window.requestAnimationFrame(s$d);s$$.stage._loop()}),s$$.stage.on("visibilitychange",this,this._onVisibilitychange)}s$t(s$h,"laya.renders.Render");var s$d=s$h.prototype;return s$d._onVisibilitychange=function(){s$$.stage.isVisibility?0!=this._timeId&&s$i.window.clearInterval(this._timeId):this._timeId=s$i.window.setInterval(this._enterFrame,1e3)},s$d._enterFrame=function(s$d){s$$.stage._loop()},s$c(1,s$h,"context",function(){return s$h._context}),s$c(1,s$h,"canvas",function(){return s$h._mainCanvas.source}),s$h._context=null,s$h._mainCanvas=null,s$h.WebGL=null,s$h.isConchNode=!1,s$h.isConchApp=!1,s$h.isConchWebGL=!1,s$h.isWebGL=!1,s$h.is3DMode=!1,s$h.optimizeTextureMemory=function(s$d,s$L){return!0},s$h.__init$=function(){s$N.ConchRenderType=s$N.ConchRenderType||1,s$N.ConchRenderType|=s$N.conch?4:0,s$h.isConchNode=5==(5&s$N.ConchRenderType),s$h.isConchApp=4==(4&s$N.ConchRenderType),s$h.isConchWebGL=6==s$N.ConchRenderType},s$h}(),s$X=function(){function s$N(s$d,s$L,s$l){this.x=0,this.y=0,this._drawTexture=function(s$d,s$L,s$l){s$l[0].loaded&&this.ctx.drawTexture(s$l[0],s$l[1],s$l[2],s$l[3],s$l[4],s$d,s$L)},this._fillTexture=function(s$d,s$L,s$l){s$l[0].loaded&&this.ctx.fillTexture(s$l[0],s$l[1]+s$d,s$l[2]+s$L,s$l[3],s$l[4],s$l[5],s$l[6],s$l[7])},this._drawTextureWithTransform=function(s$d,s$L,s$l){s$l[0].loaded&&this.ctx.drawTextureWithTransform(s$l[0],s$l[1],s$l[2],s$l[3],s$l[4],s$l[5],s$d,s$L,s$l[6])},this._fillQuadrangle=function(s$d,s$L,s$l){this.ctx.fillQuadrangle(s$l[0],s$l[1],s$l[2],s$l[3],s$l[4])},this._drawRect=function(s$d,s$L,s$l){var s$Z=this.ctx;null!=s$l[4]&&(s$Z.fillStyle=s$l[4],s$Z.fillRect(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3],null)),null!=s$l[5]&&(s$Z.strokeStyle=s$l[5],s$Z.lineWidth=s$l[6],s$Z.strokeRect(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3],s$l[6]))},this._drawPie=function(s$d,s$L,s$l){var s$Z=this.ctx;s$H.isWebGL&&s$Z.setPathId(s$l[8]),s$Z.beginPath(),s$H.isWebGL?(s$Z.movePath(s$l[0]+s$d,s$l[1]+s$L),s$Z.moveTo(0,0)):s$Z.moveTo(s$d+s$l[0],s$L+s$l[1]),s$Z.arc(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3],s$l[4]),s$Z.closePath(),this._fillAndStroke(s$l[5],s$l[6],s$l[7],!0)},this._clipRect=function(s$d,s$L,s$l){this.ctx.clipRect(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3])},this._fillRect=function(s$d,s$L,s$l){this.ctx.fillRect(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3],s$l[4])},this._drawCircle=function(s$d,s$L,s$l){var s$Z=this.ctx;s$H.isWebGL&&s$Z.setPathId(s$l[6]),s$K.drawCall++,s$Z.beginPath(),s$H.isWebGL&&s$Z.movePath(s$l[0]+s$d,s$l[1]+s$L),s$Z.arc(s$l[0]+s$d,s$l[1]+s$L,s$l[2],0,s$N.PI2),s$Z.closePath(),this._fillAndStroke(s$l[3],s$l[4],s$l[5],!0)},this._fillCircle=function(s$d,s$L,s$l){s$K.drawCall++;var s$Z=this.ctx;s$Z.beginPath(),s$Z.fillStyle=s$l[3],s$Z.arc(s$l[0]+s$d,s$l[1]+s$L,s$l[2],0,s$N.PI2),s$Z.fill()},this._setShader=function(s$d,s$L,s$l){this.ctx.setShader(s$l[0])},this._drawLine=function(s$d,s$L,s$l){var s$Z=this.ctx;s$H.isWebGL&&s$Z.setPathId(s$l[6]),s$Z.beginPath(),s$Z.strokeStyle=s$l[4],s$Z.lineWidth=s$l[5],s$H.isWebGL?(s$Z.movePath(s$d,s$L),s$Z.moveTo(s$l[0],s$l[1]),s$Z.lineTo(s$l[2],s$l[3])):(s$Z.moveTo(s$d+s$l[0],s$L+s$l[1]),s$Z.lineTo(s$d+s$l[2],s$L+s$l[3])),s$Z.stroke()},this._drawLines=function(s$d,s$L,s$l){var s$Z=this.ctx;s$H.isWebGL&&s$Z.setPathId(s$l[5]),s$Z.beginPath(),s$d+=s$l[0],s$L+=s$l[1],s$H.isWebGL&&s$Z.movePath(s$d,s$L),s$Z.strokeStyle=s$l[3],s$Z.lineWidth=s$l[4];var s$h=s$l[2],s$_=2,s$N=s$h.length;if(s$H.isWebGL)for(s$Z.moveTo(s$h[0],s$h[1]);s$_<s$N;)s$Z.lineTo(s$h[s$_++],s$h[s$_++]);else for(s$Z.moveTo(s$d+s$h[0],s$L+s$h[1]);s$_<s$N;)s$Z.lineTo(s$d+s$h[s$_++],s$L+s$h[s$_++]);s$Z.stroke()},this._drawLinesWebGL=function(s$d,s$L,s$l){this.ctx.drawLines(s$d+this.x+s$l[0],s$L+this.y+s$l[1],s$l[2],s$l[3],s$l[4])},this._drawCurves=function(s$d,s$L,s$l){this.ctx.drawCurves(s$d,s$L,s$l)},this._draw=function(s$d,s$L,s$l){s$l[0].call(null,this,s$d,s$L)},this._transformByMatrix=function(s$d,s$L,s$l){this.ctx.transformByMatrix(s$l[0])},this._setTransform=function(s$d,s$L,s$l){this.ctx.setTransform(s$l[0],s$l[1],s$l[2],s$l[3],s$l[4],s$l[5])},this._setTransformByMatrix=function(s$d,s$L,s$l){this.ctx.setTransformByMatrix(s$l[0])},this._save=function(s$d,s$L,s$l){this.ctx.save()},this._restore=function(s$d,s$L,s$l){this.ctx.restore()},this._translate=function(s$d,s$L,s$l){this.ctx.translate(s$l[0],s$l[1])},this._transform=function(s$d,s$L,s$l){this.ctx.translate(s$l[1]+s$d,s$l[2]+s$L);var s$Z=s$l[0];this.ctx.transform(s$Z.a,s$Z.b,s$Z.c,s$Z.d,s$Z.tx,s$Z.ty),this.ctx.translate(-s$d-s$l[1],-s$L-s$l[2])},this._rotate=function(s$d,s$L,s$l){this.ctx.translate(s$l[1]+s$d,s$l[2]+s$L),this.ctx.rotate(s$l[0]),this.ctx.translate(-s$d-s$l[1],-s$L-s$l[2])},this._scale=function(s$d,s$L,s$l){this.ctx.translate(s$l[2]+s$d,s$l[3]+s$L),this.ctx.scale(s$l[0],s$l[1]),this.ctx.translate(-s$d-s$l[2],-s$L-s$l[3])},this._alpha=function(s$d,s$L,s$l){this.ctx.globalAlpha*=s$l[0]},this._setAlpha=function(s$d,s$L,s$l){this.ctx.globalAlpha=s$l[0]},this._fillText=function(s$d,s$L,s$l){this.ctx.fillText(s$l[0],s$l[1]+s$d,s$l[2]+s$L,s$l[3],s$l[4],s$l[5])},this._strokeText=function(s$d,s$L,s$l){this.ctx.strokeText(s$l[0],s$l[1]+s$d,s$l[2]+s$L,s$l[3],s$l[4],s$l[5],s$l[6])},this._fillBorderText=function(s$d,s$L,s$l){this.ctx.fillBorderText(s$l[0],s$l[1]+s$d,s$l[2]+s$L,s$l[3],s$l[4],s$l[5],s$l[6],s$l[7])},this._blendMode=function(s$d,s$L,s$l){this.ctx.globalCompositeOperation=s$l[0]},this._beginClip=function(s$d,s$L,s$l){this.ctx.beginClip&&this.ctx.beginClip(s$d+s$l[0],s$L+s$l[1],s$l[2],s$l[3])},this._setIBVB=function(s$d,s$L,s$l){this.ctx.setIBVB(s$l[0]+s$d,s$l[1]+s$L,s$l[2],s$l[3],s$l[4],s$l[5],s$l[6],s$l[7])},this._fillTrangles=function(s$d,s$L,s$l){this.ctx.fillTrangles(s$l[0],s$l[1]+s$d,s$l[2]+s$L,s$l[3],s$l[4])},this._drawPath=function(s$d,s$L,s$l){var s$Z=this.ctx;s$H.isWebGL&&s$Z.setPathId(-1),s$Z.beginPath(),s$d+=s$l[0],s$L+=s$l[1],s$H.isWebGL&&s$Z.movePath(s$d,s$L);for(var s$h=s$l[2],s$_=0,s$N=s$h.length;s$_<s$N;s$_++){var s$m=s$h[s$_];switch(s$m[0]){case"moveTo":s$H.isWebGL?s$Z.moveTo(s$m[1],s$m[2]):s$Z.moveTo(s$d+s$m[1],s$L+s$m[2]);break;case"lineTo":s$H.isWebGL?s$Z.lineTo(s$m[1],s$m[2]):s$Z.lineTo(s$d+s$m[1],s$L+s$m[2]);break;case"arcTo":s$H.isWebGL?s$Z.arcTo(s$m[1],s$m[2],s$m[3],s$m[4],s$m[5]):s$Z.arcTo(s$d+s$m[1],s$L+s$m[2],s$d+s$m[3],s$L+s$m[4],s$m[5]);break;case"closePath":s$Z.closePath()}}var s$u=s$l[3];null!=s$u&&(s$Z.fillStyle=s$u.fillStyle,s$Z.fill());var s$x=s$l[4];null!=s$x&&(s$Z.strokeStyle=s$x.strokeStyle,s$Z.lineWidth=s$x.lineWidth||1,s$Z.lineJoin=s$x.lineJoin,s$Z.lineCap=s$x.lineCap,s$Z.miterLimit=s$x.miterLimit,s$Z.stroke())},this.drawPoly=function(s$d,s$L,s$l){this.ctx.drawPoly(s$d+this.x+s$l[0],s$L+this.y+s$l[1],s$l[2],s$l[3],s$l[4],s$l[5],s$l[6])},this._drawPoly=function(s$d,s$L,s$l){var s$Z=this.ctx,s$h=s$l[2],s$_=2,s$N=s$h.length;if(s$H.isWebGL)for(s$Z.setPathId(s$l[6]),s$Z.beginPath(),s$d+=s$l[0],s$L+=s$l[1],s$Z.movePath(s$d,s$L),s$Z.moveTo(s$h[0],s$h[1]);s$_<s$N;)s$Z.lineTo(s$h[s$_++],s$h[s$_++]);else for(s$Z.beginPath(),s$d+=s$l[0],s$L+=s$l[1],s$Z.moveTo(s$d+s$h[0],s$L+s$h[1]);s$_<s$N;)s$Z.lineTo(s$d+s$h[s$_++],s$L+s$h[s$_++]);s$Z.closePath(),this._fillAndStroke(s$l[3],s$l[4],s$l[5],s$l[7])},this._drawSkin=function(s$d,s$L,s$l){var s$Z=s$l[0];if(s$Z){var s$h=this.ctx;s$Z.render(s$h,s$d,s$L)}},this._drawParticle=function(s$d,s$L,s$l){this.ctx.drawParticle(s$d+this.x,s$L+this.y,s$l[0])},this._setFilters=function(s$d,s$L,s$l){this.ctx.setFilters(s$l)},s$l?this.ctx=s$l.getContext("2d"):(s$l=s$wd.create("3D"),this.ctx=s$F.createWebGLContext2D(s$l),s$l._setContext(this.ctx)),s$l.size(s$d,s$L),this.canvas=s$l}s$t(s$N,"laya.renders.RenderContext");var s$d=s$N.prototype;return s$d.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},s$d.drawTexture=function(s$d,s$L,s$l,s$Z,s$h){s$d.loaded&&this.ctx.drawTexture(s$d,s$L,s$l,s$Z,s$h,this.x,this.y)},s$d._drawTextures=function(s$d,s$L,s$l){s$l[0].loaded&&this.ctx.drawTextures(s$l[0],s$l[1],s$d+this.x,s$L+this.y)},s$d.drawTextureWithTransform=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$d.loaded&&this.ctx.drawTextureWithTransform(s$d,s$L,s$l,s$Z,s$h,s$_,this.x,this.y,s$N)},s$d.fillQuadrangle=function(s$d,s$L,s$l,s$Z,s$h){this.ctx.fillQuadrangle(s$d,s$L,s$l,s$Z,s$h)},s$d.drawCanvas=function(s$d,s$L,s$l,s$Z,s$h){this.ctx.drawCanvas(s$d,s$L+this.x,s$l+this.y,s$Z,s$h)},s$d.drawRect=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=1);var s$N=this.ctx;s$N.strokeStyle=s$h,s$N.lineWidth=s$_,s$N.strokeRect(s$d+this.x,s$L+this.y,s$l,s$Z,s$_)},s$d._fillAndStroke=function(s$d,s$L,s$l,s$Z){void 0===s$Z&&(s$Z=!1);var s$h=this.ctx;null!=s$d&&(s$h.fillStyle=s$d,s$H.isWebGL?s$h.fill(s$Z):s$h.fill()),null!=s$L&&0<s$l&&(s$h.strokeStyle=s$L,s$h.lineWidth=s$l,s$h.stroke())},s$d.clipRect=function(s$d,s$L,s$l,s$Z){this.ctx.clipRect(s$d+this.x,s$L+this.y,s$l,s$Z)},s$d.fillRect=function(s$d,s$L,s$l,s$Z,s$h){this.ctx.fillRect(s$d+this.x,s$L+this.y,s$l,s$Z,s$h)},s$d.drawCircle=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=1),s$K.drawCall++;var s$_=this.ctx;s$_.beginPath(),s$_.strokeStyle=s$Z,s$_.lineWidth=s$h,s$_.arc(s$d+this.x,s$L+this.y,s$l,0,s$N.PI2),s$_.stroke()},s$d.drawTriangles=function(s$d,s$L,s$l){if(s$H.isWebGL)this.ctx.drawTriangles(s$l[0],s$d+s$l[1],s$L+s$l[2],s$l[3],s$l[4],s$l[5],s$l[6],s$l[7],s$l[8],s$l[9]);else{var s$Z=s$l[5],s$h=0,s$_=s$Z.length,s$N=this.ctx;for(s$h=0;s$h<s$_;s$h+=3){var s$m=2*s$Z[s$h],s$u=2*s$Z[s$h+1],s$x=2*s$Z[s$h+2];s$N.drawTriangle(s$l[0],s$l[3],s$l[4],s$m,s$u,s$x,s$l[6],!0)}}},s$d.fillCircle=function(s$d,s$L,s$l,s$Z){s$K.drawCall++;var s$h=this.ctx;s$h.beginPath(),s$h.fillStyle=s$Z,s$h.arc(s$d+this.x,s$L+this.y,s$l,0,s$N.PI2),s$h.fill()},s$d.setShader=function(s$d){this.ctx.setShader(s$d)},s$d.drawLine=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=1);var s$N=this.ctx;s$N.beginPath(),s$N.strokeStyle=s$h,s$N.lineWidth=s$_,s$N.moveTo(this.x+s$d,this.y+s$L),s$N.lineTo(this.x+s$l,this.y+s$Z),s$N.stroke()},s$d.clear=function(){this.ctx.clear()},s$d.transformByMatrix=function(s$d){this.ctx.transformByMatrix(s$d)},s$d.setTransform=function(s$d,s$L,s$l,s$Z,s$h,s$_){this.ctx.setTransform(s$d,s$L,s$l,s$Z,s$h,s$_)},s$d.setTransformByMatrix=function(s$d){this.ctx.setTransformByMatrix(s$d)},s$d.save=function(){this.ctx.save()},s$d.restore=function(){this.ctx.restore()},s$d.translate=function(s$d,s$L){this.ctx.translate(s$d,s$L)},s$d.transform=function(s$d,s$L,s$l,s$Z,s$h,s$_){this.ctx.transform(s$d,s$L,s$l,s$Z,s$h,s$_)},s$d.rotate=function(s$d){this.ctx.rotate(s$d)},s$d.scale=function(s$d,s$L){this.ctx.scale(s$d,s$L)},s$d.alpha=function(s$d){this.ctx.globalAlpha*=s$d},s$d.setAlpha=function(s$d){this.ctx.globalAlpha=s$d},s$d.fillWords=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$_&&(s$_=0),this.ctx.fillWords(s$d,s$L,s$l,s$Z,s$h,s$_)},s$d.fillBorderWords=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this.ctx.fillBorderWords(s$d,s$L,s$l,s$Z,s$h,s$_,s$N)},s$d.fillText=function(s$d,s$L,s$l,s$Z,s$h,s$_){this.ctx.fillText(s$d,s$L+this.x,s$l+this.y,s$Z,s$h,s$_)},s$d.strokeText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this.ctx.strokeText(s$d,s$L+this.x,s$l+this.y,s$Z,s$h,s$_,s$N)},s$d.blendMode=function(s$d){this.ctx.globalCompositeOperation=s$d},s$d.flush=function(){this.ctx.flush&&this.ctx.flush()},s$d.addRenderObject=function(s$d){this.ctx.addRenderObject(s$d)},s$d.beginClip=function(s$d,s$L,s$l,s$Z){this.ctx.beginClip&&this.ctx.beginClip(s$d,s$L,s$l,s$Z)},s$d.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},s$d.fillTrangles=function(s$d,s$L,s$l){this.ctx.fillTrangles(s$l[0],s$l[1],s$l[2],s$l[3],4<s$l.length?s$l[4]:null)},s$N.PI2=2*Math.PI,s$N}(),s$j=function(){function s$N(s$d,s$L){switch(this._next=s$L||s$N.NORENDER,s$d){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=s$k._filter);case 69905:return void(this._fun=s$N._initRenderFun)}this.onCreate(s$d)}s$t(s$N,"laya.renders.RenderSprite");var s$d=s$N.prototype;return s$d.onCreate=function(s$d){},s$d._style=function(s$d,s$L,s$l,s$Z){s$d._style.render(s$d,s$L,s$l,s$Z);var s$h=this._next;s$h._fun.call(s$h,s$d,s$L,s$l,s$Z)},s$d._no=function(s$d,s$L,s$l,s$Z){},s$d._custom=function(s$d,s$L,s$l,s$Z){s$d.customRender(s$L,s$l,s$Z);var s$h=s$d._style._tf;this._next._fun.call(this._next,s$d,s$L,s$l-s$h.translateX,s$Z-s$h.translateY)},s$d._clip=function(s$d,s$L,s$l,s$Z){var s$h=this._next;if(s$h!=s$N.NORENDER){var s$_=s$d._style.scrollRect;s$L.ctx.save(),s$L.ctx.clipRect(s$l,s$Z,s$_.width,s$_.height),s$h._fun.call(s$h,s$d,s$L,s$l-s$_.x,s$Z-s$_.y),s$L.ctx.restore()}},s$d._blend=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style;s$h.blendMode&&(s$L.ctx.globalCompositeOperation=s$h.blendMode);var s$_=this._next;s$_._fun.call(s$_,s$d,s$L,s$l,s$Z),s$L.ctx.globalCompositeOperation="source-over"},s$d._mask=function(s$d,s$L,s$l,s$Z){var s$h=this._next;s$h._fun.call(s$h,s$d,s$L,s$l,s$Z);var s$_=s$d.mask;s$_&&(s$L.ctx.globalCompositeOperation="destination-in",(0<s$_.numChildren||!s$_.graphics._isOnlyOne())&&(s$_.cacheAsBitmap=!0),s$_.render(s$L,s$l-s$d.pivotX,s$Z-s$d.pivotY)),s$L.ctx.globalCompositeOperation="source-over"},s$d._graphics=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style._tf;s$d._graphics&&s$d._graphics._render(s$d,s$L,s$l-s$h.translateX,s$Z-s$h.translateY);var s$_=this._next;s$_._fun.call(s$_,s$d,s$L,s$l,s$Z)},s$d._image=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style;s$L.ctx.drawTexture2(s$l,s$Z,s$h._tf.translateX,s$h._tf.translateY,s$d.transform,s$h.alpha,s$h.blendMode,s$d._graphics._one)},s$d._image2=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style._tf;s$L.ctx.drawTexture2(s$l,s$Z,s$h.translateX,s$h.translateY,s$d.transform,1,null,s$d._graphics._one)},s$d._alpha=function(s$d,s$L,s$l,s$Z){var s$h;if(.01<(s$h=s$d._style.alpha)||s$d._needRepaint()){var s$_=s$L.ctx.globalAlpha;s$L.ctx.globalAlpha*=s$h;var s$N=this._next;s$N._fun.call(s$N,s$d,s$L,s$l,s$Z),s$L.ctx.globalAlpha=s$_}},s$d._transform=function(s$d,s$L,s$l,s$Z){var s$h=s$d.transform,s$_=this._next;s$h&&s$_!=s$N.NORENDER?(s$L.save(),s$L.transform(s$h.a,s$h.b,s$h.c,s$h.d,s$h.tx+s$l,s$h.ty+s$Z),s$_._fun.call(s$_,s$d,s$L,0,0),s$L.restore()):s$_._fun.call(s$_,s$d,s$L,s$l,s$Z)},s$d._childs=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style,s$_=s$h._tf;if(s$l=s$l-s$_.translateX+s$h.paddingLeft,s$Z=s$Z-s$_.translateY+s$h.paddingTop,s$h._calculation){var s$N=s$d._getWords();if(s$N){var s$m=s$h;s$m&&(s$m.stroke?s$L.fillBorderWords(s$N,s$l,s$Z,s$m.font,s$m.color,s$m.strokeColor,s$m.stroke):s$L.fillWords(s$N,s$l,s$Z,s$m.font,s$m.color,"none"!=s$m.textDecoration&&s$m.underLine?1:0))}}var s$u,s$x=s$d._childs,s$t=s$x.length;if(s$d.viewport||s$d.optimizeScrollRect&&s$d._style.scrollRect){var s$b=s$d.viewport||s$d._style.scrollRect,s$q=s$b.x,s$Y=s$b.y,s$c=s$b.right,s$r=s$b.bottom,s$a=NaN,s$k=NaN;for(s$e=0;s$e<s$t;++s$e)(s$u=s$x[s$e]).visible&&(s$a=s$u._x)<s$c&&s$a+s$u.width>s$q&&(s$k=s$u._y)<s$r&&s$k+s$u.height>s$Y&&s$u.render(s$L,s$l,s$Z)}else for(var s$e=0;s$e<s$t;++s$e)(s$u=s$x[s$e])._style.visible&&s$u.render(s$L,s$l,s$Z)},s$d._canvas=function(s$d,s$L,s$l,s$Z){var s$h=s$d._$P.cacheCanvas;if(s$h){"bitmap"===s$h.type?s$K.canvasBitmap++:s$K.canvasNormal++;var s$_=s$h.ctx;if(s$d._needRepaint()||!s$_)this._canvas_repaint(s$d,s$L,s$l,s$Z);else{var s$N=s$h._cacheRec;s$L.drawCanvas(s$_.canvas,s$l+s$N.x,s$Z+s$N.y,s$N.width,s$N.height)}}else this._next._fun.call(this._next,s$d,s$L,s$l,s$Z)},s$d._canvas_repaint=function(s$d,s$L,s$l,s$Z){var s$h=s$d._$P.cacheCanvas,s$_=this._next;if(s$h){var s$N,s$m,s$u,s$x,s$t=s$h.ctx,s$b=s$d._needRepaint()||!s$t,s$q=s$h.type;if("bitmap"===s$q?s$K.canvasBitmap++:s$K.canvasNormal++,s$b){var s$Y,s$c;s$h._cacheRec||(s$h._cacheRec=new s$n),s$H.isWebGL&&"bitmap"!==s$q?s$h._cacheRec.setTo(-s$d.pivotX,-s$d.pivotY,1,1):((s$x=s$d.getSelfBounds()).x=s$x.x-s$d.pivotX,s$x.y=s$x.y-s$d.pivotY,s$x.x=s$x.x-16,s$x.y=s$x.y-16,s$x.width=s$x.width+32,s$x.height=s$x.height+32,s$x.x=Math.floor(s$x.x+s$l)-s$l,s$x.y=Math.floor(s$x.y+s$Z)-s$Z,s$x.width=Math.floor(s$x.width),s$x.height=Math.floor(s$x.height),s$h._cacheRec.copyFrom(s$x)),s$x=s$h._cacheRec;var s$r,s$a=s$H.isWebGL?1:s$i.pixelRatio*s$$.stage.clientScaleX,s$k=s$H.isWebGL?1:s$i.pixelRatio*s$$.stage.clientScaleY;if(!s$H.isWebGL){var s$e,s$w=1,s$s=1;for(s$e=s$d;s$e&&s$e!=s$$.stage;)s$w*=s$e.scaleX,s$s*=s$e.scaleY,s$e=s$e.parent;s$H.isWebGL?(s$w<1&&(s$a*=s$w),s$s<1&&(s$k*=s$s)):(1<s$w&&(s$a*=s$w),1<s$s&&(s$k*=s$s))}if(s$d.scrollRect){var s$A=s$d.scrollRect;s$x.x-=s$A.x,s$x.y-=s$A.y}if(s$Y=s$x.width*s$a,s$c=s$x.height*s$k,s$m=s$x.x,s$u=s$x.y,s$H.isWebGL&&"bitmap"===s$q&&(2048<s$Y||2048<s$c))return console.warn("cache bitmap size larger than 2048,cache ignored"),s$h.ctx&&(s$G.recover("RenderContext",s$h.ctx),s$h.ctx.canvas.size(0,0),s$h.ctx=null),void s$_._fun.call(s$_,s$d,s$L,s$l,s$Z);if(s$t||(s$t=s$h.ctx=s$G.getItem("RenderContext")||new s$X(s$Y,s$c,s$wd.create("AUTO"))),s$t.ctx.sprite=s$d,(s$N=s$t.canvas).clear(),(s$N.width!=s$Y||s$N.height!=s$c)&&s$N.size(s$Y,s$c),"bitmap"===s$q?s$N.context.asBitmap=!0:"normal"===s$q&&(s$N.context.asBitmap=!1),1!=s$a||1!=s$k){var s$y=s$t.ctx;s$y.save(),s$y.scale(s$a,s$k),!s$H.isConchWebGL&&s$H.isConchApp&&(s$r=s$d._$P.cf)&&s$y.setFilterMatrix&&s$y.setFilterMatrix(s$r._mat,s$r._alpha),s$_._fun.call(s$_,s$d,s$t,-s$m,-s$u),s$y.restore(),s$H.isConchApp&&!s$H.isConchWebGL||s$d._applyFilters()}else s$y=s$t.ctx,!s$H.isConchWebGL&&s$H.isConchApp&&(s$r=s$d._$P.cf)&&s$y.setFilterMatrix&&s$y.setFilterMatrix(s$r._mat,s$r._alpha),s$_._fun.call(s$_,s$d,s$t,-s$m,-s$u),s$H.isConchApp&&!s$H.isConchWebGL||s$d._applyFilters();s$d._$P.staticCache&&(s$h.reCache=!1),s$K.canvasReCache++}else s$m=(s$x=s$h._cacheRec).x,s$u=s$x.y,s$N=s$t.canvas;s$L.drawCanvas(s$N,s$l+s$m,s$Z+s$u,s$x.width,s$x.height)}else s$_._fun.call(s$_,s$d,s$t,s$l,s$Z)},s$N.__init__=function(){var s$d,s$L,s$l=0;for(s$L=s$F.createRenderSprite(69905,null),s$d=s$N.renders.length=4096,s$l=0;s$l<s$d;s$l++)s$N.renders[s$l]=s$L;s$N.renders[0]=s$F.createRenderSprite(0,null),function(s$d,s$L){for(var s$l=0,s$Z=0;s$Z<s$d.length;s$Z++)s$l|=s$d[s$Z],s$N.renders[s$l]=s$L}([1,512,4,2],new s$N(1,null)),s$N.renders[513]=s$F.createRenderSprite(513,null),s$N.renders[517]=new s$N(517,null)},s$N._initRenderFun=function(s$d,s$L,s$l,s$Z){var s$h=s$d._renderType;(s$N.renders[s$h]=s$N._getTypeRender(s$h))._fun(s$d,s$L,s$l,s$Z)},s$N._getTypeRender=function(s$d){for(var s$L=null,s$l=2048;1<s$l;)s$l&s$d&&(s$L=s$F.createRenderSprite(s$l,s$L)),s$l>>=1;return s$L},s$N.IMAGE=1,s$N.ALPHA=2,s$N.TRANSFORM=4,s$N.BLEND=8,s$N.CANVAS=16,s$N.FILTERS=32,s$N.MASK=64,s$N.CLIP=128,s$N.STYLE=256,s$N.GRAPHICS=512,s$N.CUSTOM=1024,s$N.CHILDS=2048,s$N.INIT=69905,s$N.renders=[],s$N.NORENDER=new s$N(0,null),s$N}(),s$R=function(){function s$m(){this._repaint=!1}s$t(s$m,"laya.resource.Context");var s$d=s$m.prototype;return s$d.replaceReset=function(){var s$d,s$L,s$l=0;for(s$d=s$m.replaceKeys.length,s$l=0;s$l<s$d;s$l++)s$L=s$m.replaceKeys[s$l],this[s$m.newKeys[s$l]]=this[s$L]},s$d.replaceResotre=function(){this.__restore(),this.__reset()},s$d.setIsMainContext=function(){},s$d.drawTextures=function(s$d,s$L,s$l,s$Z){s$K.drawCall+=s$L.length/2;for(var s$h=s$d.width,s$_=s$d.height,s$N=0,s$m=s$L.length;s$N<s$m;s$N+=2)this.drawTexture(s$d,s$L[s$N],s$L[s$N+1],s$h,s$_,s$l,s$Z)},s$d.drawCanvas=function(s$d,s$L,s$l,s$Z,s$h){s$K.drawCall++,this.drawImage(s$d.source,s$L,s$l,s$Z,s$h)},s$d.fillRect=function(s$d,s$L,s$l,s$Z,s$h){s$K.drawCall++,s$h&&(this.fillStyle=s$h),this.__fillRect(s$d,s$L,s$l,s$Z)},s$d.fillText=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$K.drawCall++,3<arguments.length&&null!=s$Z&&(this.font=s$Z,this.fillStyle=s$h,this.textAlign=s$_,this.textBaseline="top"),this.__fillText(s$d,s$L,s$l)},s$d.fillBorderText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){s$K.drawCall++,this.font=s$Z,this.fillStyle=s$h,this.textBaseline="top",this.strokeStyle=s$_,this.lineWidth=s$N,this.textAlign=s$m,this.__strokeText(s$d,s$L,s$l),this.__fillText(s$d,s$L,s$l)},s$d.strokeText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$K.drawCall++,3<arguments.length&&null!=s$Z&&(this.font=s$Z,this.strokeStyle=s$h,this.lineWidth=s$_,this.textAlign=s$N,this.textBaseline="top"),this.__strokeText(s$d,s$L,s$l)},s$d.transformByMatrix=function(s$d){this.transform(s$d.a,s$d.b,s$d.c,s$d.d,s$d.tx,s$d.ty)},s$d.setTransformByMatrix=function(s$d){this.setTransform(s$d.a,s$d.b,s$d.c,s$d.d,s$d.tx,s$d.ty)},s$d.clipRect=function(s$d,s$L,s$l,s$Z){s$K.drawCall++,this.beginPath(),this.rect(s$d,s$L,s$l,s$Z),this.clip()},s$d.drawTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$K.drawCall++;var s$m=s$d.uv,s$u=s$d.bitmap.width,s$x=s$d.bitmap.height;this.drawImage(s$d.source,s$m[0]*s$u,s$m[1]*s$x,(s$m[2]-s$m[0])*s$u,(s$m[5]-s$m[3])*s$x,s$L+s$_,s$l+s$N,s$Z,s$h)},s$d.drawTextureWithTransform=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){s$K.drawCall++;var s$x=s$d.uv,s$t=s$d.bitmap.width,s$b=s$d.bitmap.height;this.save(),1!=s$u&&(this.globalAlpha*=s$u),s$_?(this.transform(s$_.a,s$_.b,s$_.c,s$_.d,s$_.tx+s$N,s$_.ty+s$m),this.drawImage(s$d.source,s$x[0]*s$t,s$x[1]*s$b,(s$x[2]-s$x[0])*s$t,(s$x[5]-s$x[3])*s$b,s$L,s$l,s$Z,s$h)):this.drawImage(s$d.source,s$x[0]*s$t,s$x[1]*s$b,(s$x[2]-s$x[0])*s$t,(s$x[5]-s$x[3])*s$b,s$L+s$N,s$l+s$m,s$Z,s$h),this.restore()},s$d.drawTexture2=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=s$m[0];if(s$u.loaded&&s$u.bitmap&&s$u.source){s$K.drawCall++;var s$x=1!==s$_;if(s$x){var s$t=this.globalAlpha;this.globalAlpha*=s$_}var s$b=s$u.uv,s$q=s$u.bitmap.width,s$Y=s$u.bitmap.height;s$h?(this.save(),this.transform(s$h.a,s$h.b,s$h.c,s$h.d,s$h.tx+s$d,s$h.ty+s$L),this.drawImage(s$u.source,s$b[0]*s$q,s$b[1]*s$Y,(s$b[2]-s$b[0])*s$q,(s$b[5]-s$b[3])*s$Y,s$m[1]-s$l,s$m[2]-s$Z,s$m[3],s$m[4]),this.restore()):this.drawImage(s$u.source,s$b[0]*s$q,s$b[1]*s$Y,(s$b[2]-s$b[0])*s$q,(s$b[5]-s$b[3])*s$Y,s$m[1]-s$l+s$d,s$m[2]-s$Z+s$L,s$m[3],s$m[4]),s$x&&(this.globalAlpha=s$t)}},s$d.fillTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){if(!s$m.pat){if(s$d.uv!=s$td.DEF_UV){var s$u=new s$wd("2D");s$u.getContext("2d"),s$u.size(s$d.width,s$d.height),s$u.context.drawTexture(s$d,0,0,s$d.width,s$d.height,0,0),s$d=new s$td(s$u)}s$m.pat=this.createPattern(s$d.bitmap.source,s$_)}var s$x=s$L,s$t=s$l,s$b=0,s$q=0;s$N&&(s$x+=s$N.x%s$d.width,s$t+=s$N.y%s$d.height,s$b-=s$N.x%s$d.width,s$q-=s$N.y%s$d.height),this.translate(s$x,s$t),this.fillRect(s$b,s$q,s$Z,s$h,s$m.pat),this.translate(-s$x,-s$t)},s$d.drawTriangle=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=s$d.bitmap,s$x=s$u.source,s$t=s$d.width,s$b=s$d.height,s$q=s$u.width,s$Y=s$u.height,s$c=s$l[s$Z]*s$q,s$r=s$l[s$h]*s$q,s$a=s$l[s$_]*s$q,s$k=s$l[s$Z+1]*s$Y,s$e=s$l[s$h+1]*s$Y,s$w=s$l[s$_+1]*s$Y,s$s=s$L[s$Z],s$A=s$L[s$h],s$y=s$L[s$_],s$$=s$L[s$Z+1],s$O=s$L[s$h+1],s$n=s$L[s$_+1];if(s$m){var s$V=(s$s+s$A+s$y)/3,s$Q=(s$$+s$O+s$n)/3,s$g=s$s-s$V,s$F=s$$-s$Q,s$E=Math.sqrt(s$g*s$g+s$F*s$F);s$s=s$V+s$g/s$E*(s$E+1),s$$=s$Q+s$F/s$E*(s$E+1),s$F=s$O-s$Q,s$A=s$V+(s$g=s$A-s$V)/(s$E=Math.sqrt(s$g*s$g+s$F*s$F))*(s$E+1),s$O=s$Q+s$F/s$E*(s$E+1),s$F=s$n-s$Q,s$y=s$V+(s$g=s$y-s$V)/(s$E=Math.sqrt(s$g*s$g+s$F*s$F))*(s$E+1),s$n=s$Q+s$F/s$E*(s$E+1)}this.save(),s$N&&this.transform(s$N.a,s$N.b,s$N.c,s$N.d,s$N.tx,s$N.ty),this.beginPath(),this.moveTo(s$s,s$$),this.lineTo(s$A,s$O),this.lineTo(s$y,s$n),this.closePath(),this.clip();var s$I=1/(s$c*s$e+s$k*s$a+s$r*s$w-s$e*s$a-s$k*s$r-s$c*s$w),s$p=s$s*s$e+s$k*s$y+s$A*s$w-s$e*s$y-s$k*s$A-s$s*s$w,s$H=s$c*s$A+s$s*s$a+s$r*s$y-s$A*s$a-s$s*s$r-s$c*s$y,s$X=s$c*s$e*s$y+s$k*s$A*s$a+s$s*s$r*s$w-s$s*s$e*s$a-s$k*s$r*s$y-s$c*s$A*s$w,s$j=s$$*s$e+s$k*s$n+s$O*s$w-s$e*s$n-s$k*s$O-s$$*s$w,s$R=s$c*s$O+s$$*s$a+s$r*s$n-s$O*s$a-s$$*s$r-s$c*s$n,s$o=s$c*s$e*s$n+s$k*s$O*s$a+s$$*s$r*s$w-s$$*s$e*s$a-s$k*s$r*s$n-s$c*s$O*s$w;this.transform(s$p*s$I,s$j*s$I,s$H*s$I,s$R*s$I,s$X*s$I,s$o*s$I),this.drawImage(s$x,s$d.uv[0]*s$q,s$d.uv[1]*s$Y,s$t,s$b,s$d.uv[0]*s$q,s$d.uv[1]*s$Y,s$t,s$b),this.restore()},s$d.flush=function(){return 0},s$d.fillWords=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$Z&&(this.font=s$Z),s$h&&(this.fillStyle=s$h);this.textBaseline="top",this.textAlign="left";for(var s$N=0,s$m=s$d.length;s$N<s$m;s$N++){var s$u=s$d[s$N];if(this.__fillText(s$u.char,s$u.x+s$L,s$u.y+s$l),1===s$_){var s$x=s$u.height,s$t=.5*s$u.style.letterSpacing;s$t||(s$t=0),this.beginPath(),this.strokeStyle=s$h,this.lineWidth=1,this.moveTo(s$L+s$u.x-s$t+.5,s$l+s$u.y+s$x+.5),this.lineTo(s$L+s$u.x+s$u.width+s$t+.5,s$l+s$u.y+s$x+.5),this.stroke()}}},s$d.fillBorderWords=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$Z&&(this.font=s$Z),s$h&&(this.fillStyle=s$h),this.textBaseline="top",this.lineWidth=s$N,this.textAlign="left",this.strokeStyle=s$_;for(var s$m=0,s$u=s$d.length;s$m<s$u;s$m++){var s$x=s$d[s$m];this.__strokeText(s$x.char,s$x.x+s$L,s$x.y+s$l),this.__fillText(s$x.char,s$x.x+s$L,s$x.y+s$l)}},s$d.destroy=function(){this.canvas.width=this.canvas.height=0},s$d.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},s$d.drawCurves=function(s$d,s$L,s$l){this.beginPath(),this.strokeStyle=s$l[3],this.lineWidth=s$l[4];var s$Z=s$l[2];s$d+=s$l[0],s$L+=s$l[1],this.moveTo(s$d+s$Z[0],s$L+s$Z[1]);for(var s$h=2,s$_=s$Z.length;s$h<s$_;)this.quadraticCurveTo(s$d+s$Z[s$h++],s$L+s$Z[s$h++],s$d+s$Z[s$h++],s$L+s$Z[s$h++]);this.stroke()},s$m.__init__=function(s$L){var s$l=laya.resource.Context.prototype;if(!(s$L=s$L||CanvasRenderingContext2D.prototype).inited){s$L.inited=!0,s$L.__fillText=s$L.fillText,s$L.__fillRect=s$L.fillRect,s$L.__strokeText=s$L.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(s$d){s$L[s$d]=s$l[s$d]})}},s$m.replaceCanvasGetSet=function(s$d,s$L){var s$l=Object.getOwnPropertyDescriptor(s$d,s$L);if(!s$l||!s$l.configurable)return!1;var s$Z,s$h={};for(s$Z in s$l)"set"!=s$Z&&(s$h[s$Z]=s$l[s$Z]);var s$_=s$l.set;return s$h.set=function(s$d){s$_.call(this,s$d);var s$L=this.getContext("2d");s$L&&"__reset"in s$L&&s$L.__reset()},Object.defineProperty(s$d,s$L,s$h),!0},s$m.replaceGetSet=function(s$d,s$L){var s$l=Object.getOwnPropertyDescriptor(s$d,s$L);if(!s$l||!s$l.configurable)return!1;var s$Z,s$h={};for(s$Z in s$l)"set"!=s$Z&&(s$h[s$Z]=s$l[s$Z]);var s$_=s$l.set,s$N="___"+s$L+"__";return s$m.newKeys.push(s$N),s$h.set=function(s$d){s$d!=this[s$N]&&(this[s$N]=s$d,s$_.call(this,s$d))},Object.defineProperty(s$d,s$L,s$h),!0},s$m._default=new s$m,s$m.newKeys=[],s$u(s$m,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),s$m}(),s$o=function(){function s$_(s$d){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++s$_._uniqueIDCounter,this._name=s$d||"Content Manager",s$_._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,s$_._resourceManagers.push(this),this._resources=[],this._records={}}s$t(s$_,"laya.resource.ResourceManager");var s$d=s$_.prototype;return s$$.imps(s$d,{"laya.resource.IDispose":!0}),s$d.getResourceByIndex=function(s$d){return this._resources[s$d]},s$d.getResourcesLength=function(){return this._resources.length},s$d.addResource=function(s$d){return s$d.resourceManager&&s$d.resourceManager.removeResource(s$d),-1===this._resources.indexOf(s$d)&&((s$d._resourceManager=this)._resources.push(s$d),this.addRecord(s$d.uri,s$d.__className,s$d.memorySize),this.addSize(s$d.memorySize),!0)},s$d.removeResource=function(s$d){var s$L=this._resources.indexOf(s$d);return-1!==s$L&&(this._resources.splice(s$L,1),s$d._resourceManager=null,this._memorySize-=s$d.memorySize,this.addRecord(s$d.uri,s$d.__className,-s$d.memorySize),!0)},s$d.unload=function(){for(var s$d=this._resources.slice(0,this._resources.length),s$L=0;s$L<s$d.length;s$L++){s$d[s$L].destroy()}s$d.length=0},s$d.dispose=function(){if(this===s$_._systemResourceManager)throw new Error("systemResourceManager不能被释放！");s$_._resourceManagers.splice(s$_._resourceManagers.indexOf(this),1),s$_._isResourceManagersSorted=!1;for(var s$d=this._resources.slice(0,this._resources.length),s$L=0;s$L<s$d.length;s$L++){var s$l=s$d[s$L];s$l.resourceManager.removeResource(s$l),s$l.destroy()}s$d.length=0},s$d.addSize=function(s$d){s$d&&(this.autoRelease&&0<s$d&&this._memorySize+s$d>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=s$d)},s$d.addRecord=function(s$d,s$L,s$l){DEBUG&&s$l&&!s$d&&console.error(s$d,s$L,s$l),s$d&&(this._records.hasOwnProperty(s$L+"|"+s$d)||(this._records[s$L+"|"+s$d]=0),this._records[s$L+"|"+s$d]+=s$l,DEBUG&&this._records[s$L+"|"+s$d]<0&&console.error(s$d,s$L,this._records[s$L+"|"+s$d]))},s$d.garbageCollection=function(s$d){var s$L=this._resources;(s$L=s$L.slice()).sort(function(s$d,s$L){if(!s$d||!s$L)throw new Error("a或b不能为空！");return s$d.released&&s$L.released?0:s$d.released?1:s$L.released?-1:s$d._lastUseFrameCount-s$L._lastUseFrameCount});for(var s$l=s$K.loopCount,s$Z=0,s$h=s$L.length;s$Z<s$h;s$Z++){var s$_=s$L[s$Z];if(!(1<s$l-s$_._lastUseFrameCount))return void(this._memorySize>=s$d&&(this._isOverflow=!0));if(s$_.releaseResource(),this._memorySize<s$d)return void(this._isOverflow=!1)}},s$c(0,s$d,"id",function(){return this._id}),s$c(0,s$d,"name",function(){return this._name},function(s$d){!s$d&&""===s$d||this._name===s$d||(this._name=s$d,s$_._isResourceManagersSorted=!1)}),s$c(0,s$d,"memorySize",function(){return this._memorySize}),s$c(0,s$d,"records",function(){return this._records}),s$c(1,s$_,"systemResourceManager",function(){return s$_._systemResourceManager}),s$_.__init__=function(){s$_.currentResourceManager=s$_.systemResourceManager},s$_.getLoadedResourceManagerByIndex=function(s$d){return s$_._resourceManagers[s$d]},s$_.getLoadedResourceManagersCount=function(){return s$_._resourceManagers.length},s$_.recreateContentManagers=function(s$d){void 0===s$d&&(s$d=!1);for(var s$L=s$_.currentResourceManager,s$l=0;s$l<s$_._resourceManagers.length;s$l++){s$_.currentResourceManager=s$_._resourceManagers[s$l];for(var s$Z=0;s$Z<s$_.currentResourceManager._resources.length;s$Z++)s$_.currentResourceManager._resources[s$Z].releaseResource(s$d),s$_.currentResourceManager._resources[s$Z].activeResource(s$d)}s$_.currentResourceManager=s$L},s$_.releaseContentManagers=function(s$d){void 0===s$d&&(s$d=!1);for(var s$L=s$_.currentResourceManager,s$l=0;s$l<s$_._resourceManagers.length;s$l++){s$_.currentResourceManager=s$_._resourceManagers[s$l];for(var s$Z=0;s$Z<s$_.currentResourceManager._resources.length;s$Z++){var s$h=s$_.currentResourceManager._resources[s$Z];!s$h.released&&s$h.releaseResource(s$d)}}s$_.currentResourceManager=s$L},s$_._uniqueIDCounter=0,s$_._isResourceManagersSorted=!1,s$_._resourceManagers=[],s$u(s$_,["_systemResourceManager",function(){return this._systemResourceManager=new s$_("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=s$_._systemResourceManager}]),s$_}(),s$i=(function(){function s$d(){}s$t(s$d,"laya.system.System"),s$d.changeDefinition=function(s$d,s$L){s$$[s$d]=s$L;var s$l=s$d+"=classObj";s$$._runScript(s$l)},s$d.__init__=function(){s$H.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function s$l(){}return s$t(s$l,"laya.utils.Browser"),s$c(1,s$l,"pixelRatio",function(){return s$l.__init__(),-1<s$l.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:s$F.getPixelRatio()}),s$c(1,s$l,"height",function(){return s$l.__init__(),(s$$.stage&&s$$.stage.canvasRotation?s$l.clientWidth:s$l.clientHeight)*s$l.pixelRatio}),s$c(1,s$l,"clientWidth",function(){return s$l.__init__(),s$l.window.innerWidth||s$l.document.body.clientWidth}),s$c(1,s$l,"window",function(){return s$l.__init__(),s$l._window}),s$c(1,s$l,"clientHeight",function(){return s$l.__init__(),s$l.window.innerHeight||s$l.document.body.clientHeight||s$l.document.documentElement.clientHeight}),s$c(1,s$l,"width",function(){return s$l.__init__(),(s$$.stage&&s$$.stage.canvasRotation?s$l.clientHeight:s$l.clientWidth)*s$l.pixelRatio}),s$c(1,s$l,"container",function(){return s$l.__init__(),s$l._container||((s$l._container=s$l.createElement("div")).id="layaContainer",s$l.document.body.appendChild(s$l._container)),s$l._container},function(s$d){s$l._container=s$d}),s$c(1,s$l,"document",function(){return s$l.__init__(),s$l._document}),s$l.__init__=function(){if(!s$l._window){s$l._window=s$F.getWindow(),s$l._document=s$l.window.document,s$l._window.addEventListener("message",function(s$d){laya.utils.Browser._onMessage(s$d)},!1),s$l.document.__createElement=s$l.document.createElement,s$N.requestAnimationFrame=s$N.requestAnimationFrame||s$N.webkitRequestAnimationFrame||s$N.mozRequestAnimationFrame||s$N.oRequestAnimationFrame||s$N.msRequestAnimationFrame||function(s$d){return s$N.setTimeout(s$d,1e3/60)};var s$d=s$N.document.body.style;s$d["-webkit-user-select"]="none",s$d["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",s$l.userAgent=s$l.window.navigator.userAgent,s$l.onIOS=!!(s$l.u=s$l.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),s$l.onMobile=-1<s$l.u.indexOf("Mobile"),s$l.onIPhone=-1<s$l.u.indexOf("iPhone"),s$l.onMac=-1<s$l.u.indexOf("Mac OS X"),s$l.onIPad=-1<s$l.u.indexOf("iPad"),s$l.onAndroid=-1<s$l.u.indexOf("Android")||-1<s$l.u.indexOf("Adr"),s$l.onWP=-1<s$l.u.indexOf("Windows Phone"),s$l.onQQBrowser=-1<s$l.u.indexOf("QQBrowser"),s$l.onMQQBrowser=-1<s$l.u.indexOf("MQQBrowser")||-1<s$l.u.indexOf("Mobile")&&-1<s$l.u.indexOf("QQ"),s$l.onIE=!!s$l.window.ActiveXObject||"ActiveXObject"in s$l.window,s$l.onWeiXin=-1<s$l.u.indexOf("MicroMessenger"),s$l.onPC=!s$l.onMobile,s$l.onSafari=-1<s$l.u.indexOf("Safari"),s$l.onFirefox=-1<s$l.u.indexOf("Firefox"),s$l.onEdge=-1<s$l.u.indexOf("Edge"),s$l.onMiniGame=-1<s$l.u.indexOf("MiniGame"),s$l.onLimixiu=-1<s$l.u.indexOf("limixiu"),s$l.httpProtocol="http:"==s$l.window.location.protocol,s$l.onMiniGame&&null==s$l.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),s$l.webAudioEnabled=!!(s$l.window.AudioContext||s$l.window.webkitAudioContext||s$l.window.mozAudioContext),s$l.soundType=s$l.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",s$hd=s$l.webAudioEnabled?s$_d:s$ld,s$l.webAudioEnabled&&s$_d.initWebAudio(),s$ld._initMusicAudio(),s$l.enableTouch="ontouchstart"in s$N||s$N.DocumentTouch&&s$L instanceof DocumentTouch,s$N.focus(),s$g._soundClass=s$hd,s$g._musicClass=s$ld,s$H._mainCanvas=s$H._mainCanvas||s$wd.create("2D"),s$l.canvas||(s$l.canvas=s$wd.create("2D"),s$l.context=s$l.canvas.getContext("2d"))}},s$l._onMessage=function(s$d){if(s$d.data&&"size"==s$d.data.name){if(s$l.window.innerWidth=s$d.data.width,s$l.window.innerHeight=s$d.data.height,s$l.window.__innerHeight=s$d.data.clientHeight,!s$l.document.createEvent)return void console.warn("no document.createEvent");var s$L=s$l.document.createEvent("HTMLEvents");return s$L.initEvent("resize",!1,!1),void s$l.window.dispatchEvent(s$L)}},s$l.createElement=function(s$d){return s$l.__init__(),s$l.document.__createElement(s$d)},s$l.getElementById=function(s$d){return s$l.__init__(),s$l.document.getElementById(s$d)},s$l.removeElement=function(s$d){s$d&&s$d.parentNode&&s$d.parentNode.removeChild(s$d)},s$l.now=function(){return s$F.now()},s$l._window=null,s$l._document=null,s$l._container=null,s$l.userAgent=null,s$l.u=null,s$l.onIOS=!1,s$l.onMac=!1,s$l.onMobile=!1,s$l.onIPhone=!1,s$l.onIPad=!1,s$l.onAndroid=!1,s$l.onWP=!1,s$l.onQQBrowser=!1,s$l.onMQQBrowser=!1,s$l.onSafari=!1,s$l.onFirefox=!1,s$l.onEdge=!1,s$l.onIE=!1,s$l.onWeiXin=!1,s$l.onMiniGame=!1,s$l.onLimixiu=!1,s$l.onPC=!1,s$l.httpProtocol=!1,s$l.webAudioEnabled=!1,s$l.soundType=null,s$l.enableTouch=!1,s$l.canvas=null,s$l.context=null,s$l.__init$=function(){},s$l}()),s$S=function(){function s$L(s$d){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,s$d?(this._u8d_=new Uint8Array(s$d),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}s$t(s$L,"laya.utils.Byte");var s$d=s$L.prototype;return s$d.___resizeBuffer=function(s$L){try{var s$d=new Uint8Array(s$L);null!=this._u8d_&&(this._u8d_.length<=s$L?s$d.set(this._u8d_):s$d.set(this._u8d_.subarray(0,s$L))),this._u8d_=s$d,this._d_=new DataView(s$d.buffer)}catch(s$d){throw"___resizeBuffer err:"+s$L}},s$d.getString=function(){return this.rUTF(this.getUint16())},s$d.getFloat32Array=function(s$d,s$L){var s$l=s$d+s$L;s$l=s$l>this._length?this._length:s$l;var s$Z=new Float32Array(this._d_.buffer.slice(s$d,s$l));return this._pos_=s$l,s$Z},s$d.getUint8Array=function(s$d,s$L){var s$l=s$d+s$L;s$l=s$l>this._length?this._length:s$l;var s$Z=new Uint8Array(this._d_.buffer.slice(s$d,s$l));return this._pos_=s$l,s$Z},s$d.getInt16Array=function(s$d,s$L){var s$l=s$d+s$L;s$l=s$l>this._length?this._length:s$l;var s$Z=new Int16Array(this._d_.buffer.slice(s$d,s$l));return this._pos_=s$l,s$Z},s$d.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var s$d=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,s$d},s$d.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var s$d=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,s$d},s$d.writeFloat32=function(s$d){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,s$d,this._xd_),this._pos_+=4},s$d.writeFloat64=function(s$d){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,s$d,this._xd_),this._pos_+=8},s$d.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var s$d=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,s$d},s$d.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var s$d=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,s$d},s$d.writeInt32=function(s$d){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,s$d,this._xd_),this._pos_+=4},s$d.writeUint32=function(s$d){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,s$d,this._xd_),this._pos_+=4},s$d.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var s$d=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,s$d},s$d.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var s$d=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,s$d},s$d.writeUint16=function(s$d){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,s$d,this._xd_),this._pos_+=2},s$d.writeInt16=function(s$d){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,s$d,this._xd_),this._pos_+=2},s$d.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},s$d.writeUint8=function(s$d){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,s$d),this._pos_++},s$d._getUInt8=function(s$d){return this._d_.getUint8(s$d)},s$d._getUint16=function(s$d){return this._d_.getUint16(s$d,this._xd_)},s$d._getMatrix=function(){return new s$E(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},s$d.rUTF=function(s$d){for(var s$L=[],s$l=this._pos_+s$d,s$Z=0,s$h=0,s$_=0,s$N=String.fromCharCode,s$m=this._u8d_;this._pos_<s$l;)(s$Z=s$m[this._pos_++])<128?0!=s$Z&&s$L.push(s$N(s$Z)):s$Z<224?s$L.push(s$N((63&s$Z)<<6|127&s$m[this._pos_++])):s$Z<240?(s$h=s$m[this._pos_++],s$L.push(s$N((31&s$Z)<<12|(127&s$h)<<6|127&s$m[this._pos_++]))):(s$h=s$m[this._pos_++],s$_=s$m[this._pos_++],s$L.push(s$N((15&s$Z)<<18|(127&s$h)<<12|s$_<<6&127|127&s$m[this._pos_++]))),0;return s$L.join("")},s$d.getCustomString=function(s$d){for(var s$L=[],s$l=0,s$Z=0,s$h=0,s$_=String.fromCharCode,s$N=this._u8d_;0<s$d;)if((s$Z=s$N[this._pos_])<128)s$L.push(s$_(s$Z)),this._pos_++,s$d--;else for(s$l=s$Z-128,this._pos_++,s$d-=s$l;0<s$l;)s$Z=s$N[this._pos_++],s$h=s$N[this._pos_++],s$L.push(s$_(s$h<<8|s$Z)),s$l--;return s$L.join("")},s$d.clear=function(){this._pos_=0,this.length=0},s$d.__getBuffer=function(){return this._d_.buffer},s$d.writeUTFBytes=function(s$d){for(var s$L=0,s$l=(s$d+="").length;s$L<s$l;s$L++){var s$Z=s$d.charCodeAt(s$L);s$Z<=127?this.writeByte(s$Z):s$Z<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|s$Z>>6,128|63&s$Z],this._pos_),this._pos_+=2):s$Z<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|s$Z>>12,128|s$Z>>6&63,128|63&s$Z],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|s$Z>>18,128|s$Z>>12&63,128|s$Z>>6&63,128|63&s$Z],this._pos_),this._pos_+=4)}},s$d.writeUTFString=function(s$d){var s$L=this.pos;this.writeUint16(1),this.writeUTFBytes(s$d);var s$l=this.pos-s$L-2;if(65536<=s$l)throw"writeUTFString byte len more than 65536";this._d_.setUint16(s$L,s$l,this._xd_)},s$d.readUTFString=function(){return this.readUTFBytes(this.getUint16())},s$d.getUTFString=function(){return this.readUTFString()},s$d.readUTFBytes=function(s$d){if(void 0===s$d&&(s$d=-1),0==s$d)return"";var s$L=this.bytesAvailable;if(s$L<s$d)throw"readUTFBytes error - Out of bounds";return s$d=0<s$d?s$d:s$L,this.rUTF(s$d)},s$d.getUTFBytes=function(s$d){return void 0===s$d&&(s$d=-1),this.readUTFBytes(s$d)},s$d.writeByte=function(s$d){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,s$d),this._pos_+=1},s$d.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},s$d.getByte=function(){return this.readByte()},s$d.ensureWrite=function(s$d){this._length<s$d&&(this._length=s$d),this._allocated_<s$d&&(this.length=s$d)},s$d.writeArrayBuffer=function(s$d,s$L,s$l){if(void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),s$L<0||s$l<0)throw"writeArrayBuffer error - Out of bounds";0==s$l&&(s$l=s$d.byteLength-s$L),this.ensureWrite(this._pos_+s$l);var s$Z=new Uint8Array(s$d);this._u8d_.set(s$Z.subarray(s$L,s$L+s$l),this._pos_),this._pos_+=s$l},s$c(0,s$d,"buffer",function(){var s$d=this._d_.buffer;return s$d.byteLength==this.length?s$d:s$d.slice(0,this.length)}),s$c(0,s$d,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(s$d){this._xd_="littleEndian"==s$d}),s$c(0,s$d,"length",function(){return this._length},function(s$d){this._allocated_<s$d?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(s$d,2*this._allocated_))):this._allocated_>s$d&&this.___resizeBuffer(this._allocated_=s$d),this._length=s$d}),s$c(0,s$d,"pos",function(){return this._pos_},function(s$d){this._pos_=s$d}),s$c(0,s$d,"bytesAvailable",function(){return this._length-this._pos_}),s$L.getSystemEndian=function(){if(!s$L._sysEndian){var s$d=new ArrayBuffer(2);new DataView(s$d).setInt16(0,256,!0),s$L._sysEndian=256===new Int16Array(s$d)[0]?"littleEndian":"bigEndian"}return s$L._sysEndian},s$L.BIG_ENDIAN="bigEndian",s$L.LITTLE_ENDIAN="littleEndian",s$L._sysEndian=null,s$L}(),s$B=function(){function s$h(){}return s$t(s$h,"laya.utils.CacheManager"),s$h.regCacheByFunction=function(s$d,s$L){var s$l;s$h.unRegCacheByFunction(s$d,s$L),s$l={tryDispose:s$d,getCacheList:s$L},s$h._cacheList.push(s$l)},s$h.unRegCacheByFunction=function(s$d,s$L){var s$l,s$Z=0;for(s$l=s$h._cacheList.length,s$Z=0;s$Z<s$l;s$Z++)if(s$h._cacheList[s$Z].tryDispose==s$d&&s$h._cacheList[s$Z].getCacheList==s$L)return void s$h._cacheList.splice(s$Z,1)},s$h.forceDispose=function(){var s$d=0,s$L=s$h._cacheList.length;for(s$d=0;s$d<s$L;s$d++)s$h._cacheList[s$d].tryDispose(!0)},s$h.beginCheck=function(s$d){void 0===s$d&&(s$d=15e3),s$$.timer.loop(s$d,null,s$h._checkLoop)},s$h.stopCheck=function(){s$$.timer.clear(null,s$h._checkLoop)},s$h._checkLoop=function(){var s$d=s$h._cacheList;if(!(s$d.length<1)){var s$L,s$l=s$i.now(),s$Z=0;for(s$L=s$Z=s$d.length;0<s$Z&&(s$d[s$h._index=++s$h._index%s$L].tryDispose(!1),!(s$i.now()-s$l>s$h.loopTimeLimit));)s$Z--}},s$h.loopTimeLimit=2,s$h._cacheList=[],s$h._index=0,s$h}(),s$C=function(){function s$Y(){}return s$t(s$Y,"laya.utils.ClassUtils"),s$Y.regClass=function(s$d,s$L){s$Y._classMap[s$d]=s$L},s$Y.getRegClass=function(s$d){return s$Y._classMap[s$d]},s$Y.getInstance=function(s$d){var s$L=s$Y.getClass(s$d);return s$L?new s$L:(console.warn("[error] Undefined class:",s$d),null)},s$Y.createByJson=function(s$d,s$L,s$l,s$Z,s$h){"string"==typeof s$d&&(s$d=JSON.parse(s$d));var s$_=s$d.props;if(!s$L&&!(s$L=s$h?s$h.runWith(s$d):s$Y.getInstance(s$_.runtime||s$d.type)))return null;var s$N=s$d.child;if(s$N)for(var s$m=0,s$u=s$N.length;s$m<s$u;s$m++){var s$x=s$N[s$m];if("render"!==s$x.props.name&&"render"!==s$x.props.renderType||!s$L._$set_itemRender)if("Graphic"==s$x.type)s$Y.addGraphicsToSprite(s$x,s$L);else if(s$Y.isDrawType(s$x.type))s$Y.addGraphicToSprite(s$x,s$L,!0);else{var s$t=s$Y.createByJson(s$x,null,s$l,s$Z,s$h);"Script"==s$x.type?s$t.hasOwnProperty("owner")?s$t.owner=s$L:s$t.hasOwnProperty("target")&&(s$t.target=s$L):"mask"==s$x.props.renderType?s$L.mask=s$t:s$L.addChild(s$t)}else s$L.itemRender=s$x}if(s$_)for(var s$b in s$_){var s$q=s$_[s$b];"var"===s$b&&s$l?s$l[s$q]=s$L:s$q instanceof Array&&"function"==typeof s$L[s$b]?s$L[s$b].apply(s$L,s$q):s$L[s$b]=s$q}return s$Z&&s$d.customProps&&s$Z.runWith([s$L,s$d]),s$L.created&&s$L.created(),s$L},s$Y.addGraphicsToSprite=function(s$d,s$L){var s$l;if((s$l=s$d.child)&&!(s$l.length<1)){var s$Z;s$Z=s$Y._getGraphicsFromSprite(s$d,s$L);var s$h=0,s$_=0;s$d.props&&(s$h=s$Y._getObjVar(s$d.props,"x",0),s$_=s$Y._getObjVar(s$d.props,"y",0)),0!=s$h&&0!=s$_&&s$Z.translate(s$h,s$_);var s$N,s$m=0;for(s$N=s$l.length,s$m=0;s$m<s$N;s$m++)s$Y._addGraphicToGraphics(s$l[s$m],s$Z);0!=s$h&&0!=s$_&&s$Z.translate(-s$h,-s$_)}},s$Y.addGraphicToSprite=function(s$d,s$L,s$l){var s$Z;void 0===s$l&&(s$l=!1),s$Z=s$l?s$Y._getGraphicsFromSprite(s$d,s$L):s$L.graphics,s$Y._addGraphicToGraphics(s$d,s$Z)},s$Y._getGraphicsFromSprite=function(s$d,s$L){var s$l,s$Z;if(!s$d||!s$d.props)return s$L.graphics;switch(s$Z=s$d.props.renderType){case"hit":case"unHit":var s$h;s$L.hitArea||(s$L.hitArea=new s$D),(s$h=s$L.hitArea)[s$Z]||(s$h[s$Z]=new s$q),s$l=s$h[s$Z]}return s$l||(s$l=s$L.graphics),s$l},s$Y._getTransformData=function(s$d){var s$L;(s$d.hasOwnProperty("pivotX")||s$d.hasOwnProperty("pivotY"))&&(s$L=s$L||new s$E).translate(-s$Y._getObjVar(s$d,"pivotX",0),-s$Y._getObjVar(s$d,"pivotY",0));var s$l=s$Y._getObjVar(s$d,"scaleX",1),s$Z=s$Y._getObjVar(s$d,"scaleY",1),s$h=s$Y._getObjVar(s$d,"rotation",0);s$Y._getObjVar(s$d,"skewX",0),s$Y._getObjVar(s$d,"skewY",0);return 1==s$l&&1==s$Z&&0==s$h||((s$L=s$L||new s$E).scale(s$l,s$Z),s$L.rotate(.0174532922222222*s$h)),s$L},s$Y._addGraphicToGraphics=function(s$d,s$L){var s$l,s$Z;if((s$l=s$d.props)&&(s$Z=s$Y.DrawTypeDic[s$d.type])){var s$h,s$_;s$h=s$L;var s$N=s$Y._getParams(s$l,s$Z[1],s$Z[2],s$Z[3]);((s$_=s$Y._tM)||1!=s$Y._alpha)&&(s$h.save(),s$_&&s$h.transform(s$_),1!=s$Y._alpha&&s$h.alpha(s$Y._alpha)),s$h[s$Z[0]].apply(s$h,s$N),(s$_||1!=s$Y._alpha)&&s$h.restore()}},s$Y._adptLineData=function(s$d){return s$d[2]=parseFloat(s$d[0])+parseFloat(s$d[2]),s$d[3]=parseFloat(s$d[1])+parseFloat(s$d[3]),s$d},s$Y._adptTextureData=function(s$d){return s$d[0]=s$md.getRes(s$d[0]),s$d},s$Y._adptLinesData=function(s$d){return s$d[2]=s$Y._getPointListByStr(s$d[2]),s$d},s$Y.isDrawType=function(s$d){return"Image"!=s$d&&s$Y.DrawTypeDic.hasOwnProperty(s$d)},s$Y._getParams=function(s$d,s$L,s$l,s$Z){var s$h;void 0===s$l&&(s$l=0),(s$h=s$Y._temParam).length=s$L.length;var s$_,s$N,s$m=0;for(s$_=s$L.length,s$m=0;s$m<s$_;s$m++)s$h[s$m]=s$Y._getObjVar(s$d,s$L[s$m][0],s$L[s$m][1]);return s$Y._alpha=s$Y._getObjVar(s$d,"alpha",1),s$N=s$Y._getTransformData(s$d),s$Y._tM=s$N?(s$l||(s$l=0),s$N.translate(s$h[s$l],s$h[s$l+1]),s$h[s$l]=s$h[s$l+1]=0,s$N):null,s$Z&&s$Y[s$Z]&&(s$h=s$Y[s$Z](s$h)),s$h},s$Y._getPointListByStr=function(s$d){var s$L,s$l,s$Z=0;for(s$l=(s$L=s$d.split(",")).length,s$Z=0;s$Z<s$l;s$Z++)s$L[s$Z]=parseFloat(s$L[s$Z]);return s$L},s$Y._getObjVar=function(s$d,s$L,s$l){return s$d.hasOwnProperty(s$L)?s$d[s$L]:s$l},s$Y._temParam=[],s$Y._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},s$Y.getClass=function(s$d){var s$L=s$Y._classMap[s$d]||s$d;return"string"==typeof s$L?s$$.__classmap[s$L]:s$L},s$Y._tM=null,s$Y._alpha=NaN,s$u(s$Y,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),s$Y}(),s$P=function(){function s$_(s$d){if(this._color=[],"string"==typeof s$d){null===(this.strColor=s$d)&&(s$d="#000000"),"#"==s$d.charAt(0)&&(s$d=s$d.substr(1));var s$L=s$d.length;if(3==s$L||4==s$L){for(var s$l="",s$Z=0;s$Z<s$L;s$Z++)s$l+=s$d[s$Z]+s$d[s$Z];s$d=s$l}var s$h=this.numColor=parseInt(s$d,16);if(8==s$d.length)return void(this._color=[parseInt(s$d.substr(0,2),16)/255,((16711680&s$h)>>16)/255,((65280&s$h)>>8)/255,(255&s$h)/255])}else s$h=this.numColor=s$d,this.strColor=s$f.toHexColor(s$h);this._color=[((16711680&s$h)>>16)/255,((65280&s$h)>>8)/255,(255&s$h)/255,1],this._color.__id=++s$_._COLODID}return s$t(s$_,"laya.utils.Color"),s$_._initDefault=function(){for(var s$d in s$_._DEFAULT={},s$_._COLOR_MAP)s$_._SAVE[s$d]=s$_._DEFAULT[s$d]=new s$_(s$_._COLOR_MAP[s$d]);return s$_._DEFAULT},s$_._initSaveMap=function(){for(var s$d in s$_._SAVE_SIZE=0,s$_._SAVE={},s$_._DEFAULT)s$_._SAVE[s$d]=s$_._DEFAULT[s$d]},s$_.create=function(s$d){var s$L=s$_._SAVE[s$d+""];return null!=s$L?s$L:(s$_._SAVE_SIZE<1e3||s$_._initSaveMap(),s$_._SAVE[s$d+""]=new s$_(s$d))},s$_._SAVE={},s$_._SAVE_SIZE=0,s$_._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},s$_._DEFAULT=s$_._initDefault(),s$_._COLODID=1,s$_}(),s$T=(function(){function s$d(){this._values=[],this._keys=[]}s$t(s$d,"laya.utils.Dictionary");var s$L=s$d.prototype;s$L.set=function(s$d,s$L){var s$l=this.indexOf(s$d);0<=s$l?this._values[s$l]=s$L:(this._keys.push(s$d),this._values.push(s$L))},s$L.indexOf=function(s$d){var s$L=this._keys.indexOf(s$d);return 0<=s$L?s$L:(s$d="string"==typeof s$d?Number(s$d):"number"==typeof s$d?s$d.toString():s$d,this._keys.indexOf(s$d))},s$L.get=function(s$d){var s$L=this.indexOf(s$d);return s$L<0?null:this._values[s$L]},s$L.remove=function(s$d){var s$L=this.indexOf(s$d);return 0<=s$L&&(this._keys.splice(s$L,1),this._values.splice(s$L,1),!0)},s$L.clear=function(){this._values.length=0,this._keys.length=0},s$c(0,s$L,"values",function(){return this._values}),s$c(0,s$L,"keys",function(){return this._keys})}(),function(){function s$d(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}s$t(s$d,"laya.utils.Dragging");var s$L=s$d.prototype;return s$L.start=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){void 0===s$m&&(s$m=.92),this.clearTimer(),this.target=s$d,this.area=s$L,this.hasInertia=s$l,this.elasticDistance=s$L?s$Z:0,this.elasticBackTime=s$h,this.data=s$_,this._disableMouseEvent=s$N,this.ratio=s$m,1!=s$d.globalScaleX||1!=s$d.globalScaleY?this._parent=s$d.parent:this._parent=s$$.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,s$$.stage.on("mouseup",this,this.onStageMouseUp),s$$.stage.on("mouseout",this,this.onStageMouseUp),s$$.timer.frameLoop(1,this,this.loop)},s$L.clearTimer=function(){s$$.timer.clear(this,this.loop),s$$.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},s$L.stop=function(){this._dragging&&(s$r.instance.disableMouseEvent=!1,s$$.stage.off("mouseup",this,this.onStageMouseUp),s$$.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},s$L.loop=function(){var s$d=this._parent.getMousePoint(),s$L=s$d.x,s$l=s$d.y,s$Z=s$L-this._lastX,s$h=s$l-this._lastY;if(this._clickOnly){if(!(1<Math.abs(s$Z*s$$.stage._canvasTransform.getScaleX())||1<Math.abs(s$h*s$$.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),s$r.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(s$Z,s$h);0==s$Z&&0==s$h||(this._lastX=s$L,this._lastY=s$l,this.target.x+=s$Z*this._elasticRateX,this.target.y+=s$h*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},s$L.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var s$d=this.area.x-this.target.x;else s$d=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-s$d/this.elasticDistance),this.target.y<this.area.y)var s$L=this.area.y-this.target.y;else s$L=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-s$L/this.elasticDistance)}},s$L.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},s$L.onStageMouseUp=function(s$d){if(s$r.instance.disableMouseEvent=!1,s$$.stage.off("mouseup",this,this.onStageMouseUp),s$$.stage.off("mouseout",this,this.onStageMouseUp),s$$.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var s$L=this._offsets.length,s$l=Math.min(s$L,6),s$Z=this._offsets.length-s$l,s$h=s$L-1;s$Z<s$h;s$h--)this._offsetY+=this._offsets[s$h--],this._offsetX+=this._offsets[s$h];this._offsetX=this._offsetX/s$l*2,this._offsetY=this._offsetY/s$l*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),s$$.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},s$L.checkElastic=function(){var s$d=NaN,s$L=NaN;if(this.target.x<this.area.x?s$d=this.area.x:this.target.x>this.area.x+this.area.width&&(s$d=this.area.x+this.area.width),this.target.y<this.area.y?s$L=this.area.y:this.target.y>this.area.y+this.area.height&&(s$L=this.area.y+this.area.height),isNaN(s$d)&&isNaN(s$L))this.clear();else{var s$l={};isNaN(s$d)||(s$l.x=s$d),isNaN(s$L)||(s$l.y=s$L),this._tween=s$J.to(this.target,s$l,this.elasticBackTime,s$z.sineOut,s$e.create(this,this.clear),0,!1,!1)}},s$L.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(s$$.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},s$L.clear=function(){if(this.target){this.clearTimer();var s$d=this.target;this.target=null,this._parent=null,s$d.event("dragend",this.data)}},s$d}()),s$z=function(){function s$m(){}return s$t(s$m,"laya.utils.Ease"),s$m.linearNone=function(s$d,s$L,s$l,s$Z){return s$l*s$d/s$Z+s$L},s$m.linearIn=function(s$d,s$L,s$l,s$Z){return s$l*s$d/s$Z+s$L},s$m.linearInOut=function(s$d,s$L,s$l,s$Z){return s$l*s$d/s$Z+s$L},s$m.linearOut=function(s$d,s$L,s$l,s$Z){return s$l*s$d/s$Z+s$L},s$m.bounceIn=function(s$d,s$L,s$l,s$Z){return s$l-s$m.bounceOut(s$Z-s$d,0,s$l,s$Z)+s$L},s$m.bounceInOut=function(s$d,s$L,s$l,s$Z){return s$d<.5*s$Z?.5*s$m.bounceIn(2*s$d,0,s$l,s$Z)+s$L:.5*s$m.bounceOut(2*s$d-s$Z,0,s$l,s$Z)+.5*s$l+s$L},s$m.bounceOut=function(s$d,s$L,s$l,s$Z){return(s$d/=s$Z)<1/2.75?s$l*(7.5625*s$d*s$d)+s$L:s$d<2/2.75?s$l*(7.5625*(s$d-=1.5/2.75)*s$d+.75)+s$L:s$d<2.5/2.75?s$l*(7.5625*(s$d-=2.25/2.75)*s$d+.9375)+s$L:s$l*(7.5625*(s$d-=2.625/2.75)*s$d+.984375)+s$L},s$m.backIn=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=1.70158),s$l*(s$d/=s$Z)*s$d*((s$h+1)*s$d-s$h)+s$L},s$m.backInOut=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=1.70158),(s$d/=.5*s$Z)<1?.5*s$l*(s$d*s$d*((1+(s$h*=1.525))*s$d-s$h))+s$L:s$l/2*((s$d-=2)*s$d*((1+(s$h*=1.525))*s$d+s$h)+2)+s$L},s$m.backOut=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=1.70158),s$l*((s$d=s$d/s$Z-1)*s$d*((s$h+1)*s$d+s$h)+1)+s$L},s$m.elasticIn=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N;return void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=0),0==s$d?s$L:1==(s$d/=s$Z)?s$L+s$l:(s$_||(s$_=.3*s$Z),s$N=!s$h||0<s$l&&s$h<s$l||s$l<0&&s$h<-s$l?(s$h=s$l,s$_/4):s$_/s$m.PI2*Math.asin(s$l/s$h),-s$h*Math.pow(2,10*(s$d-=1))*Math.sin((s$d*s$Z-s$N)*s$m.PI2/s$_)+s$L)},s$m.elasticInOut=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N;return void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=0),0==s$d?s$L:2==(s$d/=.5*s$Z)?s$L+s$l:(s$_||(s$_=s$Z*(.3*1.5)),s$N=!s$h||0<s$l&&s$h<s$l||s$l<0&&s$h<-s$l?(s$h=s$l,s$_/4):s$_/s$m.PI2*Math.asin(s$l/s$h),s$d<1?s$h*Math.pow(2,10*(s$d-=1))*Math.sin((s$d*s$Z-s$N)*s$m.PI2/s$_)*-.5+s$L:s$h*Math.pow(2,-10*(s$d-=1))*Math.sin((s$d*s$Z-s$N)*s$m.PI2/s$_)*.5+s$l+s$L)},s$m.elasticOut=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N;return void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=0),0==s$d?s$L:1==(s$d/=s$Z)?s$L+s$l:(s$_||(s$_=.3*s$Z),s$N=!s$h||0<s$l&&s$h<s$l||s$l<0&&s$h<-s$l?(s$h=s$l,s$_/4):s$_/s$m.PI2*Math.asin(s$l/s$h),s$h*Math.pow(2,-10*s$d)*Math.sin((s$d*s$Z-s$N)*s$m.PI2/s$_)+s$l+s$L)},s$m.strongIn=function(s$d,s$L,s$l,s$Z){return s$l*(s$d/=s$Z)*s$d*s$d*s$d*s$d+s$L},s$m.strongInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*s$l*s$d*s$d*s$d*s$d*s$d+s$L:.5*s$l*((s$d-=2)*s$d*s$d*s$d*s$d+2)+s$L},s$m.strongOut=function(s$d,s$L,s$l,s$Z){return s$l*((s$d=s$d/s$Z-1)*s$d*s$d*s$d*s$d+1)+s$L},s$m.sineInOut=function(s$d,s$L,s$l,s$Z){return.5*-s$l*(Math.cos(Math.PI*s$d/s$Z)-1)+s$L},s$m.sineIn=function(s$d,s$L,s$l,s$Z){return-s$l*Math.cos(s$d/s$Z*s$m.HALF_PI)+s$l+s$L},s$m.sineOut=function(s$d,s$L,s$l,s$Z){return s$l*Math.sin(s$d/s$Z*s$m.HALF_PI)+s$L},s$m.quintIn=function(s$d,s$L,s$l,s$Z){return s$l*(s$d/=s$Z)*s$d*s$d*s$d*s$d+s$L},s$m.quintInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*s$l*s$d*s$d*s$d*s$d*s$d+s$L:.5*s$l*((s$d-=2)*s$d*s$d*s$d*s$d+2)+s$L},s$m.quintOut=function(s$d,s$L,s$l,s$Z){return s$l*((s$d=s$d/s$Z-1)*s$d*s$d*s$d*s$d+1)+s$L},s$m.quartIn=function(s$d,s$L,s$l,s$Z){return s$l*(s$d/=s$Z)*s$d*s$d*s$d+s$L},s$m.quartInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*s$l*s$d*s$d*s$d*s$d+s$L:.5*-s$l*((s$d-=2)*s$d*s$d*s$d-2)+s$L},s$m.quartOut=function(s$d,s$L,s$l,s$Z){return-s$l*((s$d=s$d/s$Z-1)*s$d*s$d*s$d-1)+s$L},s$m.cubicIn=function(s$d,s$L,s$l,s$Z){return s$l*(s$d/=s$Z)*s$d*s$d+s$L},s$m.cubicInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*s$l*s$d*s$d*s$d+s$L:.5*s$l*((s$d-=2)*s$d*s$d+2)+s$L},s$m.cubicOut=function(s$d,s$L,s$l,s$Z){return s$l*((s$d=s$d/s$Z-1)*s$d*s$d+1)+s$L},s$m.quadIn=function(s$d,s$L,s$l,s$Z){return s$l*(s$d/=s$Z)*s$d+s$L},s$m.quadInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*s$l*s$d*s$d+s$L:.5*-s$l*(--s$d*(s$d-2)-1)+s$L},s$m.quadOut=function(s$d,s$L,s$l,s$Z){return-s$l*(s$d/=s$Z)*(s$d-2)+s$L},s$m.expoIn=function(s$d,s$L,s$l,s$Z){return 0==s$d?s$L:s$l*Math.pow(2,10*(s$d/s$Z-1))+s$L-.001*s$l},s$m.expoInOut=function(s$d,s$L,s$l,s$Z){return 0==s$d?s$L:s$d==s$Z?s$L+s$l:(s$d/=.5*s$Z)<1?.5*s$l*Math.pow(2,10*(s$d-1))+s$L:.5*s$l*(2-Math.pow(2,-10*--s$d))+s$L},s$m.expoOut=function(s$d,s$L,s$l,s$Z){return s$d==s$Z?s$L+s$l:s$l*(1-Math.pow(2,-10*s$d/s$Z))+s$L},s$m.circIn=function(s$d,s$L,s$l,s$Z){return-s$l*(Math.sqrt(1-(s$d/=s$Z)*s$d)-1)+s$L},s$m.circInOut=function(s$d,s$L,s$l,s$Z){return(s$d/=.5*s$Z)<1?.5*-s$l*(Math.sqrt(1-s$d*s$d)-1)+s$L:.5*s$l*(Math.sqrt(1-(s$d-=2)*s$d)+1)+s$L},s$m.circOut=function(s$d,s$L,s$l,s$Z){return s$l*Math.sqrt(1-(s$d=s$d/s$Z-1)*s$d)+s$L},s$m.HALF_PI=.5*Math.PI,s$m.PI2=2*Math.PI,s$m}(),s$D=function(){function s$b(){this._hit=null,this._unHit=null}s$t(s$b,"laya.utils.HitArea");var s$d=s$b.prototype;return s$d.isHit=function(s$d,s$L){return!!s$b.isHitGraphic(s$d,s$L,this.hit)&&!s$b.isHitGraphic(s$d,s$L,this.unHit)},s$d.contains=function(s$d,s$L){return this.isHit(s$d,s$L)},s$c(0,s$d,"hit",function(){return this._hit||(this._hit=new s$q),this._hit},function(s$d){this._hit=s$d}),s$c(0,s$d,"unHit",function(){return this._unHit||(this._unHit=new s$q),this._unHit},function(s$d){this._unHit=s$d}),s$b.isHitGraphic=function(s$d,s$L,s$l){if(!s$l)return!1;var s$Z;if(!(s$Z=s$l.cmds)&&s$l._one&&((s$Z=s$b._cmds).length=1,s$Z[0]=s$l._one),!s$Z)return!1;var s$h,s$_,s$N=0;for(s$h=s$Z.length,s$N=0;s$N<s$h;s$N++)if(s$_=s$Z[s$N]){var s$m=s$H._context;switch(s$_.callee){case s$m._translate:case 6:s$d-=s$_[0],s$L-=s$_[1]}if(s$b.isHitCmd(s$d,s$L,s$_))return!0}return!1},s$b.isHitCmd=function(s$d,s$L,s$l){if(!s$l)return!1;var s$Z=s$H._context,s$h=!1;switch(s$l.callee){case s$Z._drawRect:case 13:s$b._rec.setTo(s$l[0],s$l[1],s$l[2],s$l[3]),s$h=s$b._rec.contains(s$d,s$L);break;case s$Z._drawCircle:case s$Z._fillCircle:case 14:s$h=(s$d-=s$l[0])*s$d+(s$L-=s$l[1])*s$L<s$l[2]*s$l[2];break;case s$Z._drawPoly:case 18:s$d-=s$l[0],s$L-=s$l[1],s$h=s$b.ptInPolygon(s$d,s$L,s$l[2])}return s$h},s$b.ptInPolygon=function(s$d,s$L,s$l){var s$Z;(s$Z=s$b._ptPoint).setTo(s$d,s$L);var s$h,s$_=0,s$N=NaN,s$m=NaN,s$u=NaN,s$x=NaN;s$h=s$l.length;for(var s$t=0;s$t<s$h;s$t+=2){if(s$N=s$l[s$t],s$m=s$l[s$t+1],s$u=s$l[(s$t+2)%s$h],s$m!=(s$x=s$l[(s$t+3)%s$h]))if(!(s$Z.y<Math.min(s$m,s$x)))if(!(s$Z.y>=Math.max(s$m,s$x)))(s$Z.y-s$m)*(s$u-s$N)/(s$x-s$m)+s$N>s$Z.x&&s$_++}return s$_%2==1},s$b._cmds=[],s$u(s$b,["_rec",function(){return this._rec=new s$n},"_ptPoint",function(){return this._ptPoint=new s$O}]),s$b}(),s$G=(function(){function s$h(s$d,s$L,s$l,s$Z){this.char=s$d,this.charNum=s$d.charCodeAt(0),this._x=this._y=0,this.width=s$L,this.height=s$l,this.style=s$Z,this.isWord=!s$h._isWordRegExp.test(s$d)}s$t(s$h,"laya.utils.HTMLChar");var s$d=s$h.prototype;s$$.imps(s$d,{"laya.display.ILayout":!0}),s$d.setSprite=function(s$d){this._sprite=s$d},s$d.getSprite=function(){return this._sprite},s$d._isChar=function(){return!0},s$d._getCSSStyle=function(){return this.style},s$c(0,s$d,"width",function(){return this._w},function(s$d){this._w=s$d}),s$c(0,s$d,"x",function(){return this._x},function(s$d){this._sprite&&(this._sprite.x=s$d),this._x=s$d}),s$c(0,s$d,"y",function(){return this._y},function(s$d){this._sprite&&(this._sprite.y=s$d),this._y=s$d}),s$c(0,s$d,"height",function(){return this._h},function(s$d){this._h=s$d}),s$h._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function s$L(){}s$t(s$L,"laya.utils.Log"),s$L.enable=function(){s$L._logdiv||(s$L._logdiv=s$i.window.document.createElement("div"),s$i.window.document.body.appendChild(s$L._logdiv),s$L._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},s$L.toggle=function(){var s$d=s$L._logdiv.style;"1px"==s$d.width?s$d.width=s$d.height="50%":s$d.width=s$d.height="1px"},s$L.print=function(s$d){s$L._logdiv&&(s$L.maxCount<=s$L._count&&s$L.clear(),s$L._count++,s$L._logdiv.innerText+=s$d+"\n",s$L._logdiv.scrollTop=s$L._logdiv.scrollHeight)},s$L.clear=function(){s$L._logdiv.innerText="",s$L._count=0},s$L._logdiv=null,s$L._count=0,s$L.maxCount=20}(),function(){function s$L(){}s$t(s$L,"laya.utils.Mouse"),s$c(1,s$L,"cursor",function(){return s$L._style.cursor},function(s$d){s$L._style.cursor=s$d}),s$L.hide=function(){"none"!=s$L.cursor&&(s$L._preCursor=s$L.cursor,s$L.cursor="none")},s$L.show=function(){"none"==s$L.cursor&&(s$L.cursor=s$L._preCursor?s$L._preCursor:"auto")},s$L._preCursor=null,s$u(s$L,["_style",function(){return this._style=s$i.document.body.style}])}(),function(){function s$_(){}return s$t(s$_,"laya.utils.Pool"),s$_.getPoolBySign=function(s$d){return s$_._poolDic[s$d]||(s$_._poolDic[s$d]=[])},s$_.clearBySign=function(s$d){s$_._poolDic[s$d]&&(s$_._poolDic[s$d].length=0)},s$_.recover=function(s$d,s$L){s$L.__InPool||(s$L.__InPool=!0,s$_.getPoolBySign(s$d).push(s$L))},s$_.getItemByClass=function(s$d,s$L){var s$l=s$_.getPoolBySign(s$d),s$Z=s$l.length?s$l.pop():new s$L;return s$Z.__InPool=!1,s$Z},s$_.getItemByCreateFun=function(s$d,s$L,s$l){var s$Z=s$_.getPoolBySign(s$d),s$h=s$Z.length?s$Z.pop():s$L.call(s$l);return s$h.__InPool=!1,s$h},s$_.getItem=function(s$d){var s$L=s$_.getPoolBySign(s$d),s$l=s$L.length?s$L.pop():null;return s$l&&(s$l.__InPool=!1),s$l},s$_._poolDic={},s$_.InPoolSign="__InPool",s$_}()),s$K=function(){function s$u(){}return s$t(s$u,"laya.utils.Stat"),s$c(1,s$u,"onclick",null,function(s$d){s$u._sp&&s$u._sp.on("click",s$u._sp,s$d),s$u._canvas&&(s$u._canvas.source.onclick=s$d,s$u._canvas.source.style.pointerEvents="")}),s$u.show=function(s$d,s$L,s$l){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),!s$H.isConchApp||s$H.isConchWebGL){if(s$H.isConchWebGL||s$i.onMiniGame||s$i.onLimixiu||(s$u._useCanvas=!0),s$u._show=!0,s$u._fpsData.length=60,s$u._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},s$u._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},s$u._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},s$u._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},s$H.isWebGL)if(s$u._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},s$H.is3DMode){if(s$u._view[0].title="FPS(3D)",s$u._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},s$u._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},s$u._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==s$l){var s$Z=8;s$u._view[s$Z++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},s$u._view[s$Z++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},s$u._view[s$Z++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==s$l){s$Z=8;s$u._view[s$Z++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},s$u._view[s$Z++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else s$u._view[0].title="FPS(WebGL)",s$u._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else s$u._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};s$u._useCanvas?s$u.createUIPre(s$d,s$L):s$u.createUI(s$d,s$L),s$u.enable()}else s$i.window.conch.showFPS&&s$i.window.conch.showFPS(s$d,s$L)},s$u.createUIPre=function(s$d,s$L){var s$l=s$i.pixelRatio;s$u._width=170*s$l,s$u._vx=75*s$l,s$u._height=s$l*(12*s$u._view.length+3*s$l)+4,s$u._fontSize=12*s$l;for(var s$Z=0;s$Z<s$u._view.length;s$Z++)s$u._view[s$Z].x=4,s$u._view[s$Z].y=s$Z*s$u._fontSize+2*s$l;s$u._canvas||((s$u._canvas=new s$wd("2D")).size(s$u._width,s$u._height),(s$u._ctx=s$u._canvas.getContext("2d")).textBaseline="top",s$u._ctx.font=s$u._fontSize+"px Sans-serif",s$u._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+s$d+"px;top:"+s$L+"px;width:"+s$u._width/s$l+"px;height:"+s$u._height/s$l+"px;"),s$u._first=!0,s$u.loop(),s$u._first=!1,s$i.container.appendChild(s$u._canvas.source)},s$u.createUI=function(s$d,s$L){var s$l=s$u._sp,s$Z=s$i.pixelRatio;s$l||(s$l=new s$bd,(s$u._leftText=new s$ad).pos(5,5),s$u._leftText.color="#ffffff",s$l.addChild(s$u._leftText),(s$u._txt=new s$ad).pos(80*s$Z,5),s$u._txt.color="#ffffff",s$l.addChild(s$u._txt),s$u._sp=s$l),s$l.pos(s$d,s$L);for(var s$h="",s$_=0;s$_<s$u._view.length;s$_++){s$h+=s$u._view[s$_].title+"\n"}s$u._leftText.text=s$h;var s$N=170*s$Z,s$m=s$Z*(12*s$u._view.length+3*s$Z)+4;s$u._txt.fontSize=s$u._fontSize*s$Z,s$u._leftText.fontSize=s$u._fontSize*s$Z,s$l.size(s$N,s$m),s$l.graphics.clear(),s$l.graphics.setAlpha(.5),s$l.graphics.drawRect(0,0,s$N,s$m,"#999999"),s$l.graphics.setAlpha(1),s$u.loop()},s$u.enable=function(){s$$.timer.frameLoop(1,s$u,s$u.loop)},s$u.hide=function(){s$u._show=!1,s$$.timer.clear(s$u,s$u.loop),s$u._canvas&&s$i.removeElement(s$u._canvas.source)},s$u.clear=function(){s$u.trianglesFaces=s$u.drawCall=s$u.shaderCall=s$u.spriteCount=s$u.spriteRenderUseCacheCount=s$u.treeNodeCollision=s$u.treeSpriteCollision=s$u.canvasNormal=s$u.canvasBitmap=s$u.canvasReCache=0},s$u.loop=function(){s$u._count++;var s$d=s$i.now();if(!(s$d-s$u._timer<1e3)){var s$L=s$u._count;if(s$u.FPS=Math.round(1e3*s$L/(s$d-s$u._timer)),s$u._show){s$u.trianglesFaces=Math.round(s$u.trianglesFaces/s$L),s$u.spriteCount=s$u._useCanvas?(s$u.drawCall=Math.round(s$u.drawCall/s$L)-2,s$u.shaderCall=Math.round(s$u.shaderCall/s$L),Math.round(s$u.spriteCount/s$L)-1):(s$u.drawCall=Math.round(s$u.drawCall/s$L)-2,s$u.shaderCall=Math.round(s$u.shaderCall/s$L)-4,Math.round(s$u.spriteCount/s$L)-4),s$u.spriteRenderUseCacheCount=Math.round(s$u.spriteRenderUseCacheCount/s$L),s$u.canvasNormal=Math.round(s$u.canvasNormal/s$L),s$u.canvasBitmap=Math.round(s$u.canvasBitmap/s$L),s$u.canvasReCache=Math.ceil(s$u.canvasReCache/s$L),s$u.treeNodeCollision=Math.round(s$u.treeNodeCollision/s$L),s$u.treeSpriteCollision=Math.round(s$u.treeSpriteCollision/s$L);var s$l=0<s$u.FPS?Math.floor(1e3/s$u.FPS).toString():" ";s$u._fpsStr=s$u.FPS+(s$u.renderSlow?" slow":"")+" "+s$l,s$u._spriteStr=s$u.spriteCount+(s$u.spriteRenderUseCacheCount?"/"+s$u.spriteRenderUseCacheCount:""),s$u._canvasStr=s$u.canvasReCache+"/"+s$u.canvasNormal+"/"+s$u.canvasBitmap,s$u.currentMemorySize=s$o.systemResourceManager.memorySize,s$u._useCanvas?s$u.renderInfoPre():s$u.renderInfo(),s$u.clear()}s$u._count=0,s$u._timer=s$d}},s$u.renderInfoPre=function(){if(s$u._canvas){var s$d=s$u._ctx;s$d.clearRect(s$u._first?0:s$u._vx,0,s$u._width,s$u._height);for(var s$L=s$H.WebGL.mainContext,s$l=0;s$l<s$u._view.length;s$l++){var s$Z=s$u._view[s$l];s$u._first&&(s$d.fillStyle="white",s$d.fillText(s$Z.title,s$Z.x,s$Z.y,null,null,null)),s$d.fillStyle=s$Z.color;var s$h=-1;if((s$Z=s$u._view[s$l]).varying){if(s$L)switch(s$Z.varying){case 1:s$h=s$L.getParameter(s$L[s$Z.value]);break;case 2:s$h=s$L.getExtension(s$Z.value)}}else s$h=s$u[s$Z.value];"M"==s$Z.units&&(s$h=Math.floor(s$h/1048576*100)/100+" M"),"K"==s$Z.units&&(s$h=Math.floor(s$h/1024*100)/100+" K"),"string"==s$Z.units&&(s$h=s$h.match(/\d+\.?\d/i)),s$d.fillText(s$h+"",s$Z.x+s$u._vx,s$Z.y,null,null,null)}}},s$u.renderInfo=function(){for(var s$d="",s$L=s$H.WebGL.mainContext,s$l=0;s$l<s$u._view.length;s$l++){var s$Z=s$u._view[s$l],s$h=-1;if(s$Z.varying){if(s$L)switch(s$Z.varying){case 1:s$h=s$L.getParameter(s$L[s$Z.value]);break;case 2:s$h=s$L.getExtension(s$Z.value)}}else s$h=s$u[s$Z.value];"M"==s$Z.units&&(s$h=Math.floor(s$h/1048576*100)/100+" M"),"K"==s$Z.units&&(s$h=Math.floor(s$h/1024*100)/100+" K"),"string"==s$Z.units&&(s$h=s$h.match(/\d+\.?\d/i)),s$d+=s$h+"\n"}s$u._txt.text=s$d},s$u.FPS=0,s$u.loopCount=0,s$u.shaderCall=0,s$u.drawCall=0,s$u.trianglesFaces=0,s$u.spriteCount=0,s$u.spriteRenderUseCacheCount=0,s$u.treeNodeCollision=0,s$u.treeSpriteCollision=0,s$u.canvasNormal=0,s$u.canvasBitmap=0,s$u.canvasReCache=0,s$u.renderSlow=!1,s$u.currentMemorySize=0,s$u._fpsStr=null,s$u._canvasStr=null,s$u._spriteStr=null,s$u._fpsData=[],s$u._timer=0,s$u._count=0,s$u._view=[],s$u._fontSize=12,s$u._txt=null,s$u._leftText=null,s$u._sp=null,s$u._show=!1,s$u._useCanvas=!1,s$u._canvas=null,s$u._ctx=null,s$u._first=!1,s$u._vx=NaN,s$u._width=0,s$u._height=100,s$u}(),s$v=(function(){function s$d(){this._strsToID={},this._idToStrs=[],this._length=0}s$t(s$d,"laya.utils.StringKey");var s$L=s$d.prototype;s$L.add=function(s$d){var s$L=this._strsToID[s$d];return null!=s$L?s$L:(this._idToStrs[this._length]=s$d,this._strsToID[s$d]=this._length++)},s$L.getID=function(s$d){var s$L=this._strsToID[s$d];return null==s$L?-1:s$L},s$L.getName=function(s$d){var s$L=this._idToStrs[s$d];return null==s$L?void 0:s$L}}(),function(){var s$x;function s$d(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}s$t(s$d,"laya.utils.Timer");var s$L=s$d.prototype;return s$L._init=function(){s$$.timer&&s$$.timer.frameLoop(1,this,this._update)},s$L._now=function(){return Date.now()},s$L._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var s$d=this.currFrame=this.currFrame+this.scale,s$L=this._now();this._delta=(s$L-this._lastTimer)*this.scale;var s$l=this.currTimer=this.currTimer+this._delta;s$$.isDebug&&6e4<Math.abs(s$L-this._lastTimer)&&console.error("系统时间错误！"+(s$L-this._lastTimer)),this._lastTimer=s$L;var s$Z=this._handlers;for(s$N=this._count=0,s$m=s$Z.length;s$N<s$m;s$N++)if(null!==(s$u=s$Z[s$N]).method){var s$h=s$u.userFrame?s$d:s$l;if(s$h>=s$u.exeTime)if(s$u.repeat)if(s$u.jumpFrame)for(;s$h>=s$u.exeTime;)s$u.exeTime+=s$u.delay,s$u.run(!1);else s$u.exeTime+=s$u.delay,s$u.run(!1),s$h>s$u.exeTime&&(s$u.exeTime+=Math.ceil((s$h-s$u.exeTime)/s$u.delay)*s$u.delay);else s$u.run(!0)}else this._count++;(30<this._count||s$d%200==0)&&this._clearHandlers();for(var s$_=this._laters,s$N=0,s$m=s$_.length-1;s$N<=s$m;s$N++){var s$u=s$_[s$N];this._isIgnoreRecover(s$u)||(null!==s$u.method&&(delete this._map[s$u.key],s$u.run(!1)),this._recoverHandler(s$u)),s$N===s$m&&(s$m=s$_.length-1)}s$_.length=0}},s$L._clearHandlers=function(){for(var s$d=this._handlers,s$L=0,s$l=s$d.length;s$L<s$l;s$L++){var s$Z=s$d[s$L];null!==s$Z.method?this._temp.push(s$Z):this._isIgnoreRecover(s$Z)?this._temp.push(s$Z):this._recoverHandler(s$Z)}this._handlers=this._temp,this._temp=s$d,this._temp.length=0},s$L._recoverHandler=function(s$d){this._map[s$d.key]==s$d&&delete this._map[s$d.key],s$d.recover()},s$L._create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){if(!s$l)return s$h.apply(s$Z,s$_),null;if(s$N){var s$u=this._getHandler(s$Z,s$h);if(s$u)return s$u.repeat=s$L,s$u.userFrame=s$d,s$u.delay=s$l,s$u.ignoreRecover=s$m,s$u.caller=s$Z,s$u.method=s$h,s$u.args=s$_,s$u.exeTime=s$l+(s$d?this.currFrame:this.currTimer+this._now()-this._lastTimer),s$u}return(s$u=s$x.create()).repeat=s$L,s$u.userFrame=s$d,s$u.delay=s$l,s$u.ignoreRecover=s$m,s$u.caller=s$Z,s$u.method=s$h,s$u.args=s$_,s$u.exeTime=s$l+(s$d?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(s$u),this._handlers.push(s$u),s$u},s$L._indexHandler=function(s$d){var s$L=s$d.caller,s$l=s$d.method,s$Z=s$L?s$L.$_GID||(s$L.$_GID=s$f.getGID()):0,s$h=s$l.$_TID||(s$l.$_TID=this._mid++);s$d.key=s$Z+"_"+s$h,this._map[s$d.key]=s$d},s$L.once=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=!0),this._create(!1,!1,s$d,s$L,s$l,s$Z,s$h,!1)},s$L.loop=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){void 0===s$h&&(s$h=!0),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!1);var s$m=this._create(!1,!0,s$d,s$L,s$l,s$Z,s$h,s$N);s$m&&(s$m.jumpFrame=s$_)},s$L.frameOnce=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=!0),this._create(!0,!1,s$d,s$L,s$l,s$Z,s$h,!1)},s$L.frameLoop=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$h&&(s$h=!0),void 0===s$_&&(s$_=!1),this._create(!0,!0,s$d,s$L,s$l,s$Z,s$h,s$_)},s$L.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+s$x._freeCount},s$L.clear=function(s$d,s$L){var s$l=this._getHandler(s$d,s$L);return!(!s$l||this._isIgnoreRecover(s$l))&&(delete this._map[s$l.key],s$l.key=null,s$l.clear(),!0)},s$L.clearAll=function(s$d){if(s$d)for(var s$L=0,s$l=this._handlers.length;s$L<s$l;s$L++){var s$Z=this._handlers[s$L];s$Z.caller===s$d&&(this._isIgnoreRecover(s$Z)||(delete this._map[s$Z.key],s$Z.key=null,s$Z.clear()))}},s$L._getHandler=function(s$d,s$L){var s$l=s$d?s$d.$_GID||(s$d.$_GID=s$f.getGID()):0,s$Z=s$L.$_TID||(s$L.$_TID=this._mid++);return this._map[s$l+"_"+s$Z]},s$L._isIgnoreRecover=function(s$d){if(s$d.ignoreRecover||s$d.caller&&"IgnoreRecover"==s$d.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var s$L="";try{arguments.propertyIsEnumerable.caller}catch(s$d){s$L=s$d.stack}s$$.recordError("报错：核心定时器销毁忽略  "+s$L)}return!0}return!1},s$L.hasHandler=function(s$d,s$L){return this._map[s$d.$_GID+"_"+s$L.$_TID]},s$L.callLater=function(s$d,s$L,s$l){if(null==this._getHandler(s$d,s$L)){var s$Z=s$x.create();s$Z.caller=s$d,s$Z.method=s$L,s$Z.args=s$l,this._indexHandler(s$Z),this._laters.push(s$Z)}},s$L.runCallLater=function(s$d,s$L){var s$l=this._getHandler(s$d,s$L);s$l&&null!=s$l.method&&(this._isIgnoreRecover(s$l)||(delete this._map[s$l.key],s$l.run(!0)))},s$L.runTimer=function(s$d,s$L){this.runCallLater(s$d,s$L)},s$c(0,s$L,"delta",function(){return this._delta}),s$d.__init$=function(){s$x=function(){function s$L(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}s$t(s$L,"");var s$d=s$L.prototype;return s$d.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},s$d.recover=function(){this.clear(),this.args=s$L._freeHandler,s$L._freeHandler=this,s$L._freeCount++},s$d.run=function(s$d){var s$L=this.caller;if(s$L&&s$L.destroyed)return this.clear();var s$l=this.method,s$Z=this.args;s$d&&this.clear(),null!=s$l&&(s$Z?s$l.apply(s$L,s$Z):s$l.call(s$L))},s$L._freeHandler=null,s$L._freeCount=0,s$L.create=function(){var s$d=s$L._freeHandler;return s$d?(s$L._freeHandler=s$d.args,--s$L._freeCount,s$d.args=null,s$d):new s$L},s$L}()},s$d}()),s$J=function(){function s$b(){this.gid=0}s$t(s$b,"laya.utils.Tween");var s$d=s$b.prototype;return s$d.to=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){return void 0===s$_&&(s$_=0),void 0===s$N&&(s$N=!1),this._create(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,!0,!1,!0)},s$d.from=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){return void 0===s$_&&(s$_=0),void 0===s$N&&(s$N=!1),this._create(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,!1,!1,!0)},s$d._create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){if(!s$d)throw new Error("Tween:target is null");this._target=s$d,this._duration=s$l,this._ease=s$Z||s$L.ease||s$b.easeNone,this._complete=s$h||s$L.complete,this._delay=s$_,this._props=[],this._usedTimer=0,this._startTimer=s$i.now(),this._usedPool=s$u,this._delayParam=null,this.update=s$L.update;var s$t=s$d.$_GID||(s$d.$_GID=s$f.getGID());return s$b.tweenMap[s$t]?(s$N&&s$b.clearTween(s$d),s$b.tweenMap[s$t].push(this)):s$b.tweenMap[s$t]=[this],s$x?s$_<=0?this.firstStart(s$d,s$L,s$m):(this._delayParam=[s$d,s$L,s$m],s$$.scaleTimer.once(s$_,this,this.firstStart,this._delayParam)):this._initProps(s$d,s$L,s$m),this},s$d.firstStart=function(s$d,s$L,s$l){this._delayParam=null,s$d.destroyed?this.clear():(this._initProps(s$d,s$L,s$l),this._beginLoop())},s$d._initProps=function(s$d,s$L,s$l){for(var s$Z in s$L)if("number"==typeof s$d[s$Z]){var s$h=s$l?s$d[s$Z]:s$L[s$Z],s$_=s$l?s$L[s$Z]:s$d[s$Z];this._props.push([s$Z,s$h,s$_-s$h]),s$l||(s$d[s$Z]=s$h)}},s$d._beginLoop=function(){s$$.scaleTimer.frameLoop(1,this,this._doEase)},s$d._doEase=function(){this._updateEase(s$i.now())},s$d._updateEase=function(s$d){var s$L=this._target;if(s$L){if(s$L.destroyed)return s$b.clearTween(s$L);var s$l=this._usedTimer=s$d-this._startTimer-this._delay;if(!(s$l<0)){if(s$l>=this._duration)return this.complete();for(var s$Z=0<s$l?this._ease(s$l,0,1,this._duration):0,s$h=this._props,s$_=0,s$N=s$h.length;s$_<s$N;s$_++){var s$m=s$h[s$_];s$L[s$m[0]]=s$m[1]+s$Z*s$m[2]}this.update&&this.update.run()}}},s$d.complete=function(){if(this._target){s$$.scaleTimer.runTimer(this,this.firstStart);for(var s$d=this._target,s$L=this._props,s$l=this._complete,s$Z=0,s$h=s$L.length;s$Z<s$h;s$Z++){var s$_=s$L[s$Z];s$d[s$_[0]]=s$_[1]+s$_[2]}this.update&&this.update.run(),this.clear(),s$l&&s$l.run()}},s$d.pause=function(){s$$.scaleTimer.clear(this,this._beginLoop),s$$.scaleTimer.clear(this,this._doEase),s$$.scaleTimer.clear(this,this.firstStart);var s$d;(s$d=s$i.now()-this._startTimer-this._delay)<0&&(this._usedTimer=s$d)},s$d.setStartTime=function(s$d){this._startTimer=s$d},s$d.clear=function(){this._target&&(this._remove(),this._clear())},s$d._clear=function(){this.pause(),s$$.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,s$G.recover("tween",this))},s$d.recover=function(){this._usedPool=!0,this._clear()},s$d._remove=function(){var s$d=s$b.tweenMap[this._target.$_GID];if(s$d)for(var s$L=0,s$l=s$d.length;s$L<s$l;s$L++)if(s$d[s$L]===this){s$d.splice(s$L,1);break}},s$d.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=s$i.now(),this._delayParam)s$$.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var s$d=this._props,s$L=0,s$l=s$d.length;s$L<s$l;s$L++){var s$Z=s$d[s$L];this._target[s$Z[0]]=s$Z[1]}s$$.scaleTimer.once(this._delay,this,this._beginLoop)}},s$d.resume=function(){this._usedTimer>=this._duration||(this._startTimer=s$i.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?s$$.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},s$c(0,s$d,"progress",null,function(s$d){var s$L=s$d*this._duration;this._startTimer=s$i.now()-this._delay-s$L}),s$b.to=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){return void 0===s$_&&(s$_=0),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=!0),s$G.getItemByClass("tween",s$b)._create(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,!0,s$m,!0)},s$b.from=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){return void 0===s$_&&(s$_=0),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=!0),s$G.getItemByClass("tween",s$b)._create(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,!1,s$m,!0)},s$b.clearAll=function(s$d){if(s$d&&s$d.$_GID){var s$L=s$b.tweenMap[s$d.$_GID];if(s$L){for(var s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)s$L[s$l]._clear();s$L.length=0}}},s$b.clear=function(s$d){s$d.clear()},s$b.clearTween=function(s$d){s$b.clearAll(s$d)},s$b.easeNone=function(s$d,s$L,s$l,s$Z){return s$l*s$d/s$Z+s$L},s$b.tweenMap={},s$b}(),s$f=function(){function s$m(){}return s$t(s$m,"laya.utils.Utils"),s$m.toRadian=function(s$d){return s$d*s$m._pi2},s$m.toAngle=function(s$d){return s$d*s$m._pi},s$m.toHexColor=function(s$d){if(s$d<0||isNaN(s$d))return null;for(var s$L=s$d.toString(16);s$L.length<6;)s$L="0"+s$L;return"#"+s$L},s$m.getGID=function(){return s$m._gid++},s$m.concatArray=function(s$d,s$L){if(!s$L)return s$d;if(!s$d)return s$L;var s$l=0,s$Z=s$L.length;for(s$l=0;s$l<s$Z;s$l++)s$d.push(s$L[s$l]);return s$d},s$m.clearArray=function(s$d){return s$d&&(s$d.length=0),s$d},s$m.copyArray=function(s$d,s$L){if(s$d||(s$d=[]),!s$L)return s$d;s$d.length=s$L.length;var s$l=0,s$Z=s$L.length;for(s$l=0;s$l<s$Z;s$l++)s$d[s$l]=s$L[s$l];return s$d},s$m.getGlobalRecByPoints=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N;return s$_=new s$O(s$L,s$l),s$_=s$d.localToGlobal(s$_),s$N=new s$O(s$Z,s$h),s$N=s$d.localToGlobal(s$N),s$n._getWrapRec([s$_.x,s$_.y,s$N.x,s$N.y])},s$m.getGlobalPosAndScale=function(s$d){return s$m.getGlobalRecByPoints(s$d,0,0,1,1)},s$m.bind=function(s$d,s$L){return s$d.bind(s$L)},s$m.measureText=function(s$d,s$L){return s$F.measureText(s$d,s$L)},s$m.updateOrder=function(s$d){if(!s$d||s$d.length<2)return!1;for(var s$L,s$l=1,s$Z=0,s$h=s$d.length,s$_=NaN;s$l<s$h;){for(s$L=s$d[s$Z=s$l],s$_=s$d[s$Z]._zOrder;-1<--s$Z&&s$d[s$Z]._zOrder>s$_;)s$d[s$Z+1]=s$d[s$Z];s$d[s$Z+1]=s$L,s$l++}var s$N=s$L.parent.conchModel;if(s$N)if(null!=s$N.updateZOrder)s$N.updateZOrder();else{for(s$l=0;s$l<s$h;s$l++)s$N.removeChild(s$d[s$l].conchModel);for(s$l=0;s$l<s$h;s$l++)s$N.addChildAt(s$d[s$l].conchModel,s$l)}return!0},s$m.transPointList=function(s$d,s$L,s$l){var s$Z=0,s$h=s$d.length;for(s$Z=0;s$Z<s$h;s$Z+=2)s$d[s$Z]+=s$L,s$d[s$Z+1]+=s$l},s$m.parseInt=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l=s$i.window.parseInt(s$d,s$L);return isNaN(s$l)?0:s$l},s$m.getFileExtension=function(s$d){s$m._extReg.lastIndex=s$d.lastIndexOf(".");var s$L=s$m._extReg.exec(s$d);return s$L&&1<s$L.length?s$L[1].toLowerCase():null},s$m.getTransformRelativeToWindow=function(s$d,s$L,s$l){var s$Z=s$$.stage,s$h=laya.utils.Utils.getGlobalPosAndScale(s$d),s$_=s$Z._canvasTransform.clone(),s$N=s$_.tx,s$m=s$_.ty;s$_.rotate(-Math.PI/180*s$$.stage.canvasDegree),s$_.scale(s$$.stage.clientScaleX,s$$.stage.clientScaleY);var s$u=s$$.stage.canvasDegree%180!=0,s$x=NaN,s$t=NaN;s$u?(s$x=s$l+s$h.y,s$t=s$L+s$h.x,s$x*=s$_.d,s$t*=s$_.a,90==s$$.stage.canvasDegree?(s$x=s$N-s$x,s$t+=s$m):(s$x+=s$N,s$t=s$m-s$t)):(s$x=s$L+s$h.x,s$t=s$l+s$h.y,s$x*=s$_.a,s$t*=s$_.d,s$x+=s$N,s$t+=s$m);var s$b=NaN,s$q=NaN;return s$q=s$u?(s$b=s$_.d*s$h.height,s$_.a*s$h.width):(s$b=s$_.a*s$h.width,s$_.d*s$h.height),{x:s$x,y:s$t,scaleX:s$b,scaleY:s$q}},s$m.fitDOMElementInArea=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$d._fitLayaAirInitialized||(s$d._fitLayaAirInitialized=!0,s$d.style.transformOrigin=s$d.style.webKittransformOrigin="left top",s$d.style.position="absolute");var s$N=s$m.getTransformRelativeToWindow(s$L,s$l,s$Z);s$d.style.transform=s$d.style.webkitTransform="scale("+s$N.scaleX+","+s$N.scaleY+") rotate("+s$$.stage.canvasDegree+"deg)",s$d.style.width=s$h+"px",s$d.style.height=s$_+"px",s$d.style.left=s$N.x+"px",s$d.style.top=s$N.y+"px"},s$m.isOkTextureList=function(s$d){if(!s$d)return!1;var s$L,s$l=0,s$Z=s$d.length;for(s$l=0;s$l<s$Z;s$l++)if(!(s$L=s$d[s$l])||!s$L.source)return!1;return!0},s$m.isOKCmdList=function(s$d){if(!s$d)return!1;var s$L,s$l,s$Z=0,s$h=s$d.length,s$_=s$H._context;for(s$Z=0;s$Z<s$h;s$Z++)switch((s$L=s$d[s$Z]).callee){case s$_._drawTexture:case s$_._fillTexture:case s$_._drawTextureWithTransform:if(!(s$l=s$L[0])||!s$l.source)return!1}return!0},s$m._gid=1,s$m._pi=180/Math.PI,s$m._pi2=Math.PI/180,s$m._extReg=/\.(\w+)\??/g,s$m.parseXMLFromString=function(s$d){var s$L;if(s$d=s$d.replace(/>\s+</g,"><"),-1<(s$L=(new DOMParser).parseFromString(s$d,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(s$L.firstChild.firstChild.textContent);return s$L},s$m}(),s$U=function(){function s$d(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],s$H.isWebGL&&s$B.regCacheByFunction(s$f.bind(this.startDispose,this),s$f.bind(this.getCacheList,this))}s$t(s$d,"laya.utils.VectorGraphManager");var s$L=s$d.prototype;return s$L.getId=function(){return this._id++},s$L.addShape=function(s$d,s$L){this.shapeDic[s$d]=s$L,this.useDic[s$d]||(this.useDic[s$d]=!0)},s$L.addLine=function(s$d,s$L){this.shapeLineDic[s$d]=s$L,this.shapeLineDic[s$d]||(this.shapeLineDic[s$d]=!0)},s$L.getShape=function(s$d){this._checkKey&&null!=this.useDic[s$d]&&(this.useDic[s$d]=!0)},s$L.deleteShape=function(s$d){this.shapeDic[s$d]&&(this.shapeDic[s$d]=null,delete this.shapeDic[s$d]),this.shapeLineDic[s$d]&&(this.shapeLineDic[s$d]=null,delete this.shapeLineDic[s$d]),null!=this.useDic[s$d]&&delete this.useDic[s$d]},s$L.getCacheList=function(){var s$d,s$L=[];for(s$d in this.shapeDic)s$L.push(this.shapeDic[s$d]);for(s$d in this.shapeLineDic)s$L.push(this.shapeLineDic[s$d]);return s$L},s$L.startDispose=function(s$d){var s$L;for(s$L in this.useDic)this.useDic[s$L]=!1;this._checkKey=!0},s$L.endDispose=function(){if(this._checkKey){var s$d;for(s$d in this.useDic)this.useDic[s$d]||this.deleteShape(s$d);this._checkKey=!1}},s$d.getInstance=function(){return s$d.instance=s$d.instance||new s$d},s$d.instance=null,s$d}(),s$W=function(){function s$Z(){this._obj=null,this._obj=s$Z.supportWeakMap?new s$i.window.WeakMap:{},s$Z.supportWeakMap||s$Z._maps.push(this)}s$t(s$Z,"laya.utils.WeakObject");var s$d=s$Z.prototype;return s$d.set=function(s$d,s$L){if(null!=s$d)if(s$Z.supportWeakMap){var s$l=s$d;"string"!=typeof s$d&&"number"!=typeof s$d||(s$l=s$Z._keys[s$d])||(s$l=s$Z._keys[s$d]={k:s$d}),this._obj.set(s$l,s$L)}else"string"==typeof s$d||"number"==typeof s$d?this._obj[s$d]=s$L:(s$d.$_GID||(s$d.$_GID=s$f.getGID()),this._obj[s$d.$_GID]=s$L)},s$d.get=function(s$d){if(null==s$d)return null;if(s$Z.supportWeakMap){var s$L="string"==typeof s$d||"number"==typeof s$d?s$Z._keys[s$d]:s$d;return s$L?this._obj.get(s$L):null}return"string"==typeof s$d||"number"==typeof s$d?this._obj[s$d]:this._obj[s$d.$_GID]},s$d.del=function(s$d){if(null!=s$d)if(s$Z.supportWeakMap){var s$L="string"==typeof s$d||"number"==typeof s$d?s$Z._keys[s$d]:s$d;if(!s$L)return;this._obj.delete(s$L)}else"string"==typeof s$d||"number"==typeof s$d?delete this._obj[s$d]:delete this._obj[this._obj.$_GID]},s$d.has=function(s$d){if(null==s$d)return!1;if(s$Z.supportWeakMap){var s$L="string"==typeof s$d||"number"==typeof s$d?s$Z._keys[s$d]:s$d;return this._obj.has(s$L)}return"string"==typeof s$d||"number"==typeof s$d?null!=this._obj[s$d]:null!=this._obj[this._obj.$_GID]},s$Z.__init__=function(){(s$Z.supportWeakMap=null!=s$i.window.WeakMap)||s$$.timer.loop(s$Z.delInterval,null,s$Z.clearCache)},s$Z.clearCache=function(){for(var s$d=0,s$L=s$Z._maps.length;s$d<s$L;s$d++){s$Z._maps[s$d]._obj={}}},s$Z.supportWeakMap=!1,s$Z.delInterval=3e5,s$Z._keys={},s$Z._maps=[],s$u(s$Z,["I",function(){return this.I=new s$Z}]),s$Z}(),s$M=function(){function s$d(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}s$t(s$d,"laya.utils.WordText");var s$L=s$d.prototype;return s$L.setText=function(s$d){this.changed=!0,this._text=s$d},s$L.toString=function(){return this._text},s$L.charCodeAt=function(s$d){return this._text?this._text.charCodeAt(s$d):NaN},s$L.charAt=function(s$d){return this._text?this._text.charAt(s$d):null},s$c(0,s$L,"length",function(){return this._text?this._text.length:0}),s$d}(),s$dd=function(s$d){function s$N(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,s$N.__super.call(this),this._childs=s$N.ARRAY_EMPTY,this._$P=s$N.PROP_EMPTY,this.timer=s$$.scaleTimer,this.conchModel=s$H.isConchNode?this.createConchModel():null}s$t(s$N,"laya.display.Node",s$x);var s$L=s$N.prototype;return s$L._setBit=function(s$d,s$L){1==s$d&&(this._getBit(s$d)!=s$L&&this._updateDisplayedInstage());s$L?this._bits|=s$d:this._bits&=~s$d},s$L._getBit=function(s$d){return 0!=(this._bits&s$d)},s$L._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},s$L._setUpNoticeType=function(s$d){var s$L=this;for(s$L._setBit(s$d,!0),s$L=s$L.parent;s$L;){if(s$L._getBit(s$d))return;s$L._setBit(s$d,!0),s$L=s$L.parent}},s$L.on=function(s$d,s$L,s$l,s$Z){return"display"!==s$d&&"undisplay"!==s$d||this._getBit(1)||this._setUpNoticeType(1),this._createListener(s$d,s$L,s$l,s$Z,!1)},s$L.once=function(s$d,s$L,s$l,s$Z){return"display"!==s$d&&"undisplay"!==s$d||this._getBit(1)||this._setUpNoticeType(1),this._createListener(s$d,s$L,s$l,s$Z,!0)},s$L.createConchModel=function(){return null},s$L.destroy=function(s$d){void 0===s$d&&(s$d=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(s$d?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},s$L.destroyChildren=function(){if(this._childs)for(var s$d=this._childs.length-1;-1<s$d;s$d--)this._childs[s$d].destroy(!0)},s$L.addChild=function(s$d){if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),s$d._parent===this){var s$L=this.getChildIndex(s$d);s$L!==this._childs.length-1&&(this._childs.splice(s$L,1),this._childs.push(s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1)),this._childChanged())}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$N.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1),(s$d.parent=this)._childChanged();return s$d},s$L.addChildren=function(s$d){for(var s$L=arguments,s$l=0,s$Z=s$L.length;s$l<s$Z;)this.addChild(s$L[s$l++])},s$L.addChildAt=function(s$d,s$L){if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),0<=s$L&&s$L<=this._childs.length){if(s$d._parent===this){var s$l=this.getChildIndex(s$d);this._childs.splice(s$l,1),this._childs.splice(s$L,0,s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,s$L)),this._childChanged()}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$N.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(s$L,0,s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,s$L),s$d.parent=this;return s$d}throw new Error("appendChildAt:The index is out of bounds")},s$L.getChildIndex=function(s$d){return this._childs.indexOf(s$d)},s$L.getChildByName=function(s$d){var s$L=this._childs;if(s$L)for(var s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){var s$h=s$L[s$l];if(s$h.name===s$d)return s$h}return null},s$L._get$P=function(s$d){return this._$P[s$d]},s$L._set$P=function(s$d,s$L){return this.destroyed||(this._$P===s$N.PROP_EMPTY&&(this._$P={}),this._$P[s$d]=s$L),s$L},s$L.getChildAt=function(s$d){return this._childs[s$d]},s$L.setChildIndex=function(s$d,s$L){var s$l=this._childs;if(s$L<0||s$L>=s$l.length)throw new Error("setChildIndex:The index is out of bounds.");var s$Z=this.getChildIndex(s$d);if(s$Z<0)throw new Error("setChildIndex:node is must child of this object.");return s$l.splice(s$Z,1),s$l.splice(s$L,0,s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,s$L)),this._childChanged(),s$d},s$L._childChanged=function(s$d){},s$L.removeChild=function(s$d){if(!this._childs)return s$d;var s$L=this._childs.indexOf(s$d);return this.removeChildAt(s$L)},s$L.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},s$L.removeChildByName=function(s$d){var s$L=this.getChildByName(s$d);return s$L&&this.removeChild(s$L),s$L},s$L.removeChildAt=function(s$d){var s$L=this.getChildAt(s$d);if(s$L){for(var s$l=this._childs.length-1,s$Z=s$d;s$Z<s$l;++s$Z)this._childs[s$Z]=this._childs[s$Z+1];this._childs.length=s$l,this.conchModel&&this.conchModel.removeChild(s$L.conchModel),s$L.parent=null}return s$L},s$L.removeChildren=function(s$d,s$L){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=2147483647),this._childs&&0<this._childs.length){var s$l=this._childs;if(0===s$d&&s$_<=s$L){var s$Z=s$l;this._childs=s$N.ARRAY_EMPTY}else s$Z=s$l.splice(s$d,s$L-s$d);for(var s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)s$Z[s$h].parent=null,this.conchModel&&this.conchModel.removeChild(s$Z[s$h].conchModel)}return this},s$L.replaceChild=function(s$d,s$L){var s$l=this._childs.indexOf(s$L);return-1<s$l?(this._childs.splice(s$l,1,s$d),this.conchModel&&(this.conchModel.removeChild(s$L.conchModel),this.conchModel.addChildAt(s$d.conchModel,s$l)),s$L.parent=null,s$d.parent=this,s$d):null},s$L._updateDisplayedInstage=function(){var s$d;s$d=this;var s$L=s$$.stage;for(this._displayedInStage=!1;s$d;){if(s$d._getBit(1)){this._displayedInStage=s$d._displayedInStage;break}if(s$d==s$L||s$d._displayedInStage){this._displayedInStage=!0;break}s$d=s$d.parent}},s$L._setDisplay=function(s$d){this._displayedInStage!==s$d&&((this._displayedInStage=s$d)?this.event("display"):this.event("undisplay"))},s$L._displayChild=function(s$d,s$L){var s$l=s$d._childs;if(s$l)for(var s$Z=0;s$Z<s$l.length;s$Z++){var s$h=s$l[s$Z];s$h&&s$h._getBit(1)&&(0<s$h._childs.length?this._displayChild(s$h,s$L):s$h._setDisplay(s$L))}s$d._setDisplay(s$L)},s$L.contains=function(s$d){if(s$d===this)return!0;for(;s$d;){if(s$d.parent===this)return!0;s$d=s$d.parent}return!1},s$L.timerLoop=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$h&&(s$h=!0),void 0===s$_&&(s$_=!1),this.timer.loop(s$d,s$L,s$l,s$Z,s$h,s$_)},s$L.timerOnce=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=!0),this.timer._create(!1,!1,s$d,s$L,s$l,s$Z,s$h)},s$L.frameLoop=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=!0),this.timer._create(!0,!0,s$d,s$L,s$l,s$Z,s$h)},s$L.frameOnce=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=!0),this.timer._create(!0,!1,s$d,s$L,s$l,s$Z,s$h)},s$L.clearTimer=function(s$d,s$L){this.timer.clear(s$d,s$L)},s$c(0,s$L,"numChildren",function(){return this._childs.length}),s$c(0,s$L,"destroyed",function(){return this._destroyed}),s$c(0,s$L,"parent",function(){return this._parent},function(s$d){this._parent!==s$d&&(s$d?(this._parent=s$d,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),s$d.displayedInStage&&this._displayChild(this,!0)),s$d._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=s$d))}),s$c(0,s$L,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),s$N.ARRAY_EMPTY=[],s$N.PROP_EMPTY={},s$N.NOTICE_DISPLAY=1,s$N.MOUSEENABLE=2,s$N}(),s$Ld=function(s$d){function s$q(s$d){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,s$q.__super.call(this),this._padding=s$q._PADDING,this._spacing=s$q._SPACING,this._aligns=s$q._ALIGNS,this._font=s$Y.EMPTY,this._ower=s$d}s$t(s$q,"laya.display.css.CSSStyle",s$d);var s$L=s$q.prototype;return s$L.destroy=function(){this._ower=null,this._font=null,this._rect=null},s$L.inherit=function(s$d){this._font=s$d._font,this._spacing=s$d._spacing===s$q._SPACING?s$q._SPACING:s$d._spacing.slice(),this.lineHeight=s$d.lineHeight},s$L._widthAuto=function(){return 0!=(262144&this._type)},s$L.widthed=function(s$d){return 0!=(8&this._type)},s$L._calculation=function(s$d,s$L){if(s$L.indexOf("%")<0)return!1;var s$Z=this._ower,s$h=s$Z.parent,s$_=this._rect;function s$N(s$d,s$L,s$l){return s$d*s$l[0]+s$L*s$l[1]+s$l[2]}function s$l(s$d){var s$L=s$h.width,s$l=s$Z.width;s$_.width&&(s$Z.width=s$N(s$L,s$l,s$_.width)),s$_.height&&(s$Z.height=s$N(s$L,s$l,s$_.height)),s$_.left&&(s$Z.x=s$N(s$L,s$l,s$_.left)),s$_.top&&(s$Z.y=s$N(s$L,s$l,s$_.top))}null===s$_&&(s$h._getCSSStyle()._type|=524288,s$h.on("resize",this,s$l),this._rect=s$_={input:{}});var s$m=s$L.split(" ");return s$m[0]=parseFloat(s$m[0])/100,1==s$m.length?s$m[1]=s$m[2]=0:(s$m[1]=parseFloat(s$m[1])/100,s$m[2]=parseFloat(s$m[2])),s$_[s$d]=s$m,s$_.input[s$d]=s$L,s$l(),!0},s$L.heighted=function(s$d){return 0!=(8192&this._type)},s$L.size=function(s$d,s$L){var s$l=this._ower,s$Z=!1;-1!==s$d&&s$d!=this._ower.width&&(this._type|=8,this._ower.width=s$d,s$Z=!0),-1!==s$L&&s$L!=this._ower.height&&(this._type|=8192,this._ower.height=s$L,s$Z=!0),s$Z&&(s$l._layoutLater(),524288&this._type&&s$l.event("resize",this))},s$L._getAlign=function(){return this._aligns[0]},s$L._getValign=function(){return this._aligns[1]},s$L._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},s$L._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new s$Y(this._font))},s$L.render=function(s$d,s$L,s$l,s$Z){var s$h=s$d.width,s$_=s$d.height;s$l-=s$d.pivotX,s$Z-=s$d.pivotY,this._bgground&&null!=this._bgground.color&&s$L.ctx.fillRect(s$l,s$Z,s$h,s$_,this._bgground.color),this._border&&this._border.color&&s$L.drawRect(s$l,s$Z,s$h,s$_,this._border.color.strColor,this._border.size)},s$L.getCSSStyle=function(){return this},s$L.cssText=function(s$d){this.attrs(s$q.parseOneCSS(s$d,";"))},s$L.attrs=function(s$d){if(s$d)for(var s$L=0,s$l=s$d.length;s$L<s$l;s$L++){var s$Z=s$d[s$L];this[s$Z[0]]=s$Z[1]}},s$L.setTransform=function(s$d){"none"===s$d?this._tf=s$m._TF_EMPTY:this.attrs(s$q.parseOneCSS(s$d,","))},s$L.translate=function(s$d,s$L){this._tf===s$m._TF_EMPTY&&(this._tf=new s$h),this._tf.translateX=s$d,this._tf.translateY=s$L},s$L.scale=function(s$d,s$L){this._tf===s$m._TF_EMPTY&&(this._tf=new s$h),this._tf.scaleX=s$d,this._tf.scaleY=s$L},s$L._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},s$c(0,s$L,"block",s$d.prototype._$get_block,function(s$d){s$d?this._type|=1:this._type&=-2}),s$c(0,s$L,"valign",function(){return s$q._valigndef[this._aligns[1]]},function(s$d){this._aligns===s$q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=s$q._valigndef[s$d]}),s$c(0,s$L,"height",null,function(s$d){if(this._type|=8192,"string"==typeof s$d){if(this._calculation("height",s$d))return;s$d=parseInt(s$d)}this.size(-1,s$d)}),s$c(0,s$L,"width",null,function(s$d){if(this._type|=8,"string"==typeof s$d){var s$L=s$d.indexOf("auto");if(0<=s$L&&(this._type|=262144,s$d=s$d.substr(0,s$L)),this._calculation("width",s$d))return;s$d=parseInt(s$d)}this.size(s$d,-1)}),s$c(0,s$L,"fontWeight",function(){return this._font.weight},function(s$d){this._createFont().weight=s$d}),s$c(0,s$L,"left",null,function(s$d){var s$L=this._ower;if("string"==typeof s$d){if("center"===s$d?s$d="50% -50% 0":"right"===s$d&&(s$d="100% -100% 0"),this._calculation("left",s$d))return;s$d=parseInt(s$d)}s$L.x=s$d}),s$c(0,s$L,"_translate",null,function(s$d){this.translate(s$d[0],s$d[1])}),s$c(0,s$L,"absolute",function(){return 0!=(4&this._type)}),s$c(0,s$L,"top",null,function(s$d){var s$L=this._ower;if("string"==typeof s$d){if("middle"===s$d?s$d="50% -50% 0":"bottom"===s$d&&(s$d="100% -100% 0"),this._calculation("top",s$d))return;s$d=parseInt(s$d)}s$L.y=s$d}),s$c(0,s$L,"align",function(){return s$q._aligndef[this._aligns[0]]},function(s$d){this._aligns===s$q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=s$q._aligndef[s$d]}),s$c(0,s$L,"bold",function(){return this._font.bold},function(s$d){this._createFont().bold=s$d}),s$c(0,s$L,"padding",function(){return this._padding},function(s$d){this._padding=s$d}),s$c(0,s$L,"leading",function(){return this._spacing[1]},function(s$d){"string"==typeof s$d&&(s$d=parseInt(s$d+"")),this._spacing===s$q._SPACING&&(this._spacing=[0,0]),this._spacing[1]=s$d}),s$c(0,s$L,"lineElement",function(){return 0!=(65536&this._type)},function(s$d){s$d?this._type|=65536:this._type&=-65537}),s$c(0,s$L,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(s$d){this.lineElement=!1,"right"===s$d?this._type|=32768:this._type&=-32769}),s$c(0,s$L,"textDecoration",function(){return this._font.decoration},function(s$d){this._createFont().decoration=s$d}),s$c(0,s$L,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(s$d){"nowrap"===s$d&&(this._type|=131072),"none"===s$d&&(this._type&=-131073)}),s$c(0,s$L,"background",null,function(s$d){s$d?(this._bgground||(this._bgground={}),this._bgground.color=s$d,this._ower.conchModel&&this._ower.conchModel.bgColor(s$d),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),s$c(0,s$L,"wordWrap",function(){return 0==(131072&this._type)},function(s$d){s$d?this._type&=-131073:this._type|=131072}),s$c(0,s$L,"color",function(){return this._font.color},function(s$d){this._createFont().color=s$d}),s$c(0,s$L,"password",function(){return this._font.password},function(s$d){this._createFont().password=s$d}),s$c(0,s$L,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(s$d){"none"===s$d?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=s$d),this._ower.conchModel&&this._ower.conchModel.bgColor(s$d),this._ower._renderType|=256}),s$c(0,s$L,"font",function(){return this._font.toString()},function(s$d){this._createFont().set(s$d)}),s$c(0,s$L,"weight",null,function(s$d){this._createFont().weight=s$d}),s$c(0,s$L,"letterSpacing",function(){return this._spacing[0]},function(s$d){"string"==typeof s$d&&(s$d=parseInt(s$d+"")),this._spacing===s$q._SPACING&&(this._spacing=[0,0]),this._spacing[0]=s$d}),s$c(0,s$L,"fontSize",function(){return this._font.size},function(s$d){this._createFont().size=s$d}),s$c(0,s$L,"italic",function(){return this._font.italic},function(s$d){this._createFont().italic=s$d}),s$c(0,s$L,"fontFamily",function(){return this._font.family},function(s$d){this._createFont().family=s$d}),s$c(0,s$L,"stroke",function(){return this._font.stroke[0]},function(s$d){this._createFont().stroke===s$Y._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=s$d}),s$c(0,s$L,"strokeColor",function(){return this._font.stroke[1]},function(s$d){this._createFont().stroke===s$Y._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=s$d}),s$c(0,s$L,"border",function(){return this._border?this._border.value:""},function(s$d){if("none"!=s$d){this._border||(this._border={});var s$L=(this._border.value=s$d).split(" ");if(this._border.color=s$P.create(s$L[s$L.length-1]),1==s$L.length)return this._border.size=1,void(this._border.type="solid");var s$l=0;0<s$L[0].indexOf("px")?(this._border.size=parseInt(s$L[0]),s$l++):this._border.size=1,this._border.type=s$L[s$l],this._ower._renderType|=256}else this._border=null}),s$c(0,s$L,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(s$d){s$d?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==s$d?null:s$P.create(s$d),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),s$c(0,s$L,"position",function(){return 4&this._type?"absolute":""},function(s$d){"absolute"==s$d?this._type|=4:this._type&=-5}),s$c(0,s$L,"display",null,function(s$d){switch(s$d){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),s$c(0,s$L,"paddingLeft",function(){return this.padding[3]}),s$c(0,s$L,"paddingTop",function(){return this.padding[0]}),s$c(0,s$L,"_scale",null,function(s$d){this._ower.scale(s$d[0],s$d[1])}),s$c(0,s$L,"_rotate",null,function(s$d){this._ower.rotation=s$d}),s$q.parseOneCSS=function(s$d,s$L){for(var s$l,s$Z=[],s$h=s$d.split(s$L),s$_=0,s$N=s$h.length;s$_<s$N;s$_++){var s$m=s$h[s$_],s$u=s$m.indexOf(":"),s$x=s$m.substr(0,s$u).replace(/^\s+|\s+$/g,"");if(0!=s$x.length){var s$t=s$m.substr(s$u+1).replace(/^\s+|\s+$/g,""),s$b=[s$x,s$t];switch(s$x){case"italic":case"bold":s$b[1]="true"==s$t;break;case"line-height":s$b[0]="lineHeight",s$b[1]=parseInt(s$t);break;case"font-size":s$b[0]="fontSize",s$b[1]=parseInt(s$t);break;case"padding":1<(s$l=s$t.split(" ")).length||(s$l[1]=s$l[2]=s$l[3]=s$l[0]),s$b[1]=[parseInt(s$l[0]),parseInt(s$l[1]),parseInt(s$l[2]),parseInt(s$l[3])];break;case"rotate":s$b[0]="_rotate",s$b[1]=parseFloat(s$t);break;case"scale":s$l=s$t.split(" "),s$b[0]="_scale",s$b[1]=[parseFloat(s$l[0]),parseFloat(s$l[1])];break;case"translate":s$l=s$t.split(" "),s$b[0]="_translate",s$b[1]=[parseInt(s$l[0]),parseInt(s$l[1])];break;default:(s$b[0]=s$q._CSSTOVALUE[s$x])||(s$b[0]=s$x)}s$Z.push(s$b)}}return s$Z},s$q.parseCSS=function(s$d,s$L){for(var s$l;null!=(s$l=s$q._parseCSSRegExp.exec(s$d));)s$q.styleSheets[s$l[1]]=s$q.parseOneCSS(s$l[2],";")},s$q.EMPTY=new s$q(null),s$q._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},s$q._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),s$q._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},s$q._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},s$q.styleSheets={},s$q.ALIGN_CENTER=1,s$q.ALIGN_RIGHT=2,s$q.VALIGN_MIDDLE=1,s$q.VALIGN_BOTTOM=2,s$q._CSS_BLOCK=1,s$q._DISPLAY_NONE=2,s$q._ABSOLUTE=4,s$q._WIDTH_SET=8,s$q._PADDING=[0,0,0,0],s$q._RECT=[-1,-1,-1,-1],s$q._SPACING=[0,0],s$q._ALIGNS=[0,0,0],s$q.ADDLAYOUTED=512,s$q._NEWFONT=4096,s$q._HEIGHT_SET=8192,s$q._BACKGROUND_SET=16384,s$q._FLOAT_RIGHT=32768,s$q._LINE_ELEMENT=65536,s$q._NOWARP=131072,s$q._WIDTHAUTO=262144,s$q._LISTERRESZIE=524288,s$q}(s$m),s$ld=function(s$d){function s$N(){this.url=null,this.audio=null,this.loaded=!1,s$N.__super.call(this)}s$t(s$N,"laya.media.h5audio.AudioSound",s$x);var s$L=s$N.prototype;return s$L.dispose=function(){var s$d=s$N._audioCache[this.url];s$d&&(s$d.src="",delete s$N._audioCache[this.url])},s$L.load=function(s$d){var s$L;if(s$d=s$p.formatURL(s$d),(this.url=s$d)==s$g._tMusic?(s$N._initMusicAudio(),(s$L=s$N._musicAudio).src!=s$d&&(s$N._audioCache[s$L.src]=null,s$L=null)):s$L=s$N._audioCache[s$d],s$L&&2<=s$L.readyState)this.event("complete");else{s$L||(s$L=s$d==s$g._tMusic?(s$N._initMusicAudio(),s$N._musicAudio):s$i.createElement("audio"),(s$N._audioCache[s$d]=s$L).src=s$d),s$L.addEventListener("canplaythrough",s$Z),s$L.addEventListener("error",s$h);var s$l=this;(this.audio=s$L).load?s$L.load():s$h()}function s$Z(){s$_(),s$l.loaded=!0,s$l.event("complete")}function s$h(){s$L.load=null,s$_(),s$l.event("error")}function s$_(){s$L.removeEventListener("canplaythrough",s$Z),s$L.removeEventListener("error",s$h)}},s$L.play=function(s$d,s$L,s$l){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),!this.url)return null;var s$Z,s$h;if(!(s$Z=this.url==s$g._tMusic?s$N._musicAudio:s$N._audioCache[this.url]))return null;s$h=s$G.getItem("audio:"+this.url),s$H.isConchApp?s$h||((s$h=s$i.createElement("audio")).src=this.url):this.url==s$g._tMusic?(s$N._initMusicAudio(),(s$h=s$N._musicAudio).src=this.url):s$h=s$h||s$Z.cloneNode(!0);var s$_=new s$qd(s$h);return s$_.url=this.url,s$_.loops=s$L,s$_.startTime=s$d,s$_.startHandler=s$l,s$_.play(!1),s$g.addChannel(s$_),s$_},s$c(0,s$L,"duration",function(){var s$d;return(s$d=s$N._audioCache[this.url])?s$d.duration:0}),s$N._initMusicAudio=function(){s$N._musicAudio||(s$N._musicAudio||(s$N._musicAudio=s$i.createElement("audio")),s$H.isConchApp||s$i.document.addEventListener("mousedown",s$N._makeMusicOK))},s$N._makeMusicOK=function(){s$i.document.removeEventListener("mousedown",s$N._makeMusicOK),s$N._musicAudio.src?s$N._musicAudio.play():(s$N._musicAudio.src="",s$N._musicAudio.load())},s$N._audioCache={},s$N._musicAudio=null,s$N}(),s$Zd=function(s$d){function s$L(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,s$L.__super.call(this)}s$t(s$L,"laya.media.SoundChannel",s$x);var s$l=s$L.prototype;return s$l.play=function(){},s$l.stop=function(){},s$l.pause=function(){},s$l.resume=function(){},s$l.__runComplete=function(s$d){s$d&&s$d.run()},s$c(0,s$l,"volume",function(){return 1},function(s$d){}),s$c(0,s$l,"position",function(){return 0}),s$c(0,s$l,"duration",function(){return 0}),s$L}(),s$hd=function(s$d){function s$L(){s$L.__super.call(this)}s$t(s$L,"laya.media.Sound",s$x);var s$l=s$L.prototype;return s$l.load=function(s$d){},s$l.play=function(s$d,s$L,s$l){return void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),null},s$l.dispose=function(){},s$c(0,s$l,"duration",function(){return 0}),s$L}(),s$_d=function(s$d){function s$h(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,s$h.__super.call(this)}s$t(s$h,"laya.media.webaudio.WebAudioSound",s$x);var s$L=s$h.prototype;return s$L.load=function(s$d){this.url=s$d,this.audioBuffer=s$h._dataCache[s$d],this.audioBuffer?this._loaded(this.audioBuffer):(s$h.e.on("loaded:"+s$d,this,this._loaded),s$h.e.on("err:"+s$d,this,this._err),s$h.__loadingSound[s$d]||(s$h.__loadingSound[s$d]=!0,s$$.loader.load(s$d,s$e.create(this,this.onloaded),null,s$md.BUFFER,4,!1,null,!0)))},s$L.onloaded=function(s$d){s$d||this._err(),this._disposed?this._removeLoadEvents():(this.data=s$d,s$h.buffs.push({buffer:this.data,url:this.url}),s$h.decode())},s$L._err=function(){if(this._removeLoadEvents(),s$h.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var s$d,s$L,s$l,s$Z=0;for(s$d=(s$L=this.__toPlays).length,s$Z=0;s$Z<s$d;s$Z++)(s$l=s$L[s$Z])[3]&&!s$l[3].isStopped&&s$l[3].event("error");this.__toPlays.length=0}},s$L._loaded=function(s$d){this._removeLoadEvents(),this._disposed||(this.audioBuffer=s$d,this.loaded=!0,this.event("complete"))},s$L._removeLoadEvents=function(){s$h.e.off("loaded:"+this.url,this,this._loaded),s$h.e.off("err:"+this.url,this,this._err)},s$L.__playAfterLoaded=function(){if(this.__toPlays){var s$d,s$L,s$l,s$Z=0;for(s$d=(s$L=this.__toPlays).length,s$Z=0;s$Z<s$d;s$Z++)(s$l=s$L[s$Z])[3]&&!s$l[3].isStopped&&this.play(s$l[0],s$l[1],s$l[2],s$l[3]);this.__toPlays.length=0}},s$L.play=function(s$d,s$L,s$l,s$Z){return void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),s$Z=s$Z||new s$Yd,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([s$d,s$L,s$l,s$Z]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),s$Z.url=this.url,s$Z.loops=s$L,s$Z.audioBuffer=this.audioBuffer,s$Z.startTime=s$d,s$Z.startHandler=s$l,s$Z.play(!1),s$g.addChannel(s$Z),s$Z},s$L.dispose=function(){this._disposed=!0,delete s$h._dataCache[this.url],delete s$h.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},s$c(0,s$L,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),s$h.decode=function(){if(!(s$h.buffs.length<=0||s$h.isDecoding))if(s$h.isDecoding=!0,(s$h.tInfo=s$h.buffs.shift())&&s$h.tInfo.buffer&&s$h.tInfo.buffer.byteLength)try{s$h.ctx.decodeAudioData(s$h.tInfo.buffer,s$h._done,s$h._fail)}catch(s$d){console.error("decodeAudioData error  byteLength:"+s$h.tInfo.buffer.byteLength+"  url:"+s$h.tInfo.url)}else s$h._fail()},s$h._done=function(s$d){s$h.e.event("loaded:"+s$h.tInfo.url,s$d),s$h._dataCache[s$h.tInfo.url]=s$d,s$h.isDecoding=!1,s$h.decode()},s$h._fail=function(){s$h.e.event("err:"+s$h.tInfo.url,null),s$h.isDecoding=!1,s$h.decode()},s$h._playEmptySound=function(){if(null!=s$h.ctx){if(s$h._emptySource&&(s$h._emptySource.stop(),s$h._emptySource.disconnect(0),!s$Yd._tryCleanFailed))try{s$h._emptySource.buffer=null}catch(s$d){s$Yd._tryCleanFailed=!0}var s$d=s$h.ctx.createBufferSource();s$d.buffer=s$h._miniBuffer,s$d.connect(s$h.ctx.destination),s$d.start(0,0,0),s$h._emptySource=s$d}},s$h._unlock=function(){s$h._unlocked||(s$h._playEmptySound(),"running"==s$h.ctx.state?(s$i.document.removeEventListener("mousedown",s$h._unlock,!0),s$i.document.removeEventListener("touchend",s$h._unlock,!0),s$i.document.removeEventListener("touchstart",s$h._unlock,!0),s$h._unlocked=!0):"suspended"==s$h.ctx.state&&s$g._recoverWebAudio())},s$h.initWebAudio=function(){"running"!=s$h.ctx.state&&(s$h._unlock(),s$i.document.addEventListener("mousedown",s$h._unlock,!0),s$i.document.addEventListener("touchend",s$h._unlock,!0),s$i.document.addEventListener("touchstart",s$h._unlock,!0))},s$h._emptySource=null,s$h._dataCache={},s$h.buffs=[],s$h.isDecoding=!1,s$h._unlocked=!1,s$h.tInfo=null,s$h.__loadingSound={},s$u(s$h,["window",function(){return this.window=s$i.window},"webAudioEnabled",function(){return this.webAudioEnabled=s$h.window.AudioContext||s$h.window.webkitAudioContext||s$h.window.mozAudioContext},"ctx",function(){return this.ctx=s$h.webAudioEnabled?new(s$h.window.AudioContext||s$h.window.webkitAudioContext||s$h.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=s$h.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new s$x}]),s$h}(),s$Nd=function(s$d){function s$L(){this._responseType=null,this._data=null,s$L.__super.call(this),this._http=new s$i.window.XMLHttpRequest}s$t(s$L,"laya.net.HttpRequest",s$x);var s$l=s$L.prototype;return s$l.send=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$l&&(s$l="get"),void 0===s$Z&&(s$Z="text"),this._responseType=s$Z,this._data=null;var s$_=this,s$N=this._http;if(s$N.open(s$l,s$d,!0),s$h)for(var s$m=0;s$m<s$h.length;s$m++)s$N.setRequestHeader(s$h[s$m++],s$h[s$m]);else s$H.isConchApp||(s$L&&"string"!=typeof s$L?s$N.setRequestHeader("Content-Type","application/json"):s$N.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));s$N.responseType="arraybuffer"!==s$Z?"text":"arraybuffer",s$N.onerror=function(s$d){s$_._onError(s$d)},s$N.onabort=function(s$d){s$_._onAbort(s$d)},s$N.onprogress=function(s$d){s$_._onProgress(s$d)},s$N.onload=function(s$d){s$_._onLoad(s$d)},s$N.send(s$L)},s$l._onProgress=function(s$d){s$d&&s$d.lengthComputable&&this.event("progress",s$d.loaded/s$d.total)},s$l._onAbort=function(s$d){this.error("Request was aborted by user")},s$l._onError=function(s$d){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},s$l._onLoad=function(s$d){var s$L=this._http,s$l=void 0!==s$L.status?s$L.status:200;200===s$l||204===s$l||0===s$l?this.complete():this.error("["+s$L.status+"]"+s$L.statusText+":"+s$L.responseURL)},s$l.error=function(s$d){this.clear(),this.event("error",s$d)},s$l.complete=function(){this.clear();var s$L=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=s$f.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(s$d){s$L=!1,this.error(s$d.message)}s$L&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},s$l.clear=function(){var s$d=this._http;s$d.onerror=s$d.onabort=s$d.onprogress=s$d.onload=null},s$c(0,s$l,"url",function(){return this._http.responseURL}),s$c(0,s$l,"http",function(){return this._http}),s$c(0,s$l,"data",function(){return this._data}),s$L}(),s$md=function(s$d){function s$V(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,s$V.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}s$t(s$V,"laya.net.Loader",s$x);var s$L=s$V.prototype;return s$L.load=function(s$d,s$L,s$l,s$Z,s$h){if(s$d&&""!=s$d||console.error("Loader 加载的url不合法 "+s$d),void 0===s$l&&(s$l=!0),void 0===s$h&&(s$h=!1),0===(this._url=s$d).indexOf("data:image")?this._type=s$L="image":this._type=s$L||(s$L=this.getTypeFromUrl(s$d)),this._cache=s$l,this._data=null,!s$h&&s$V.loadedMap[s$d])return this._data=s$V.loadedMap[s$d],this.event("progress",1),void this.event("complete",this._data);if(s$Z&&s$V.setGroup(s$d,s$Z),null!=s$V.parserMap[s$L])return this._customParse=!0,void(s$V.parserMap[s$L]instanceof laya.utils.Handler?s$V.parserMap[s$L].runWith(this):s$V.parserMap[s$L].call(null,this));if("image"===s$L||"htmlimage"===s$L||"nativeimage"===s$L)return this._loadImage(s$d);if("ttf"===s$L)return this._loadTTF(s$d);switch(s$L){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:s$L}s$V.preLoadedMap[s$d]?this.onLoaded(s$V.preLoadedMap[s$d]):s$N.resMgrLoad(s$d,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},s$L.getTypeFromUrl=function(s$d){var s$L=s$f.getFileExtension(s$d);return s$L?s$V.typeMap[s$L]:(console.warn("Not recognize the resources suffix",s$d),"text")},s$L._loadTTF=function(s$d){s$d=s$p.formatURL(s$d);var s$L=new s$I;s$L.complete=s$e.create(this,this.onLoaded),s$L.load(s$d)},s$L._loadImage=function(s$d){s$N.imgMgrLoad(s$d,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},s$L._loadImageComplete=function(s$d,s$L,s$l){if(null!=s$l)if(s$l instanceof ArrayBuffer){var s$Z=new DataView(s$l),s$h=new laya.webgl.resource.WebGLImage(new Uint8Array(s$l,8),s$d,0,!1,s$Z.getUint32(0),s$Z.getUint32(4));this.onLoaded(s$h)}else if(s$l instanceof s$td)s$V.imgMgrSet[s$d]=s$L,s$N.imgMgrLock(s$d,s$V.imgMgrSet[s$d]),this._url=s$d,this.complete(s$l);else{var s$_=-1!=s$d.indexOf(".png",s$d.length-4)?6408:6407;s$h=new laya.webgl.resource.WebGLImage(s$l,s$d,s$_,!1,s$l.width,s$l.height);this.onLoaded(s$h)}else this.event("error","Load image failed")},s$L._loadSound=function(s$d){var s$L=new s$g._soundClass,s$l=this;function s$Z(){s$L.offAll()}s$L.on("complete",this,function(){s$Z(),s$l.onLoaded(s$L)}),s$L.on("error",this,function(){s$Z(),s$L.dispose(),s$l.event("error","Load sound failed")}),s$L.load(s$d)},s$L.onProgress=function(s$d){"atlas"===this._type?this.event("progress",.3*s$d):this.event("progress",s$d)},s$L.onError=function(s$d){this.event("error",s$d)},s$L._loadedComplete=function(s$d,s$L,s$l){if(null!=s$l)switch(this._type){case"atlas":case"plf":case"json":var s$Z=new s$S(s$l);this.onLoaded(JSON.parse(s$Z.readUTFBytes()));break;case"font":s$Z=new s$S(s$l);this.onLoaded(s$f.parseXMLFromString(s$Z.readUTFBytes()));break;default:this.onLoaded(s$l)}else this.event("error",s$d)},s$L.onLoaded=function(s$d){var s$L=this._type;if("plf"==s$L)this.parsePLFData(s$d),this.complete(s$d);else if("image"===s$L){var s$l=new s$td(s$d);s$l.url=this._url,this.complete(s$l)}else if("sound"===s$L||"htmlimage"===s$L||"nativeimage"===s$L)this.complete(s$d);else if("atlas"===s$L){if(!s$d.src&&!s$d._setContext){if(!this._data){if((this._data=s$d).meta&&s$d.meta.image)for(var s$Z=s$d.meta.image.split(","),s$h=0<=this._url.indexOf("/")?"/":"\\",s$_=this._url.lastIndexOf(s$h),s$N=0<=s$_?this._url.substr(0,s$_+1):"",s$m=0,s$u=s$Z.length;s$m<s$u;s$m++)s$Z[s$m]=s$N+s$Z[s$m];else s$Z=[this._url.replace(".json",".png")];s$Z.reverse(),s$d.toLoads=s$Z,s$d.pics=[]}return this.event("progress",.3+1/s$Z.length*.6),this._loadImage(s$Z.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(s$d),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var s$x=this._data.frames,s$t=this._url.split("?")[0],s$b=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:s$t.substring(0,s$t.lastIndexOf("."))+"/",s$q=this._data.pics,s$Y=s$p.formatURL(this._url),s$c=s$V.atlasMap[s$Y]||(s$V.atlasMap[s$Y]=[]);s$c.dir=s$b;var s$r=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var s$a in s$r=parseFloat(this._data.meta.scale),s$x){var s$k,s$e=s$x[s$a],s$w=s$q[s$e.frame.idx?s$e.frame.idx:0],s$s=s$p.formatURL(s$b+s$a);s$w.scaleRate=s$r,s$k=s$td.create(s$w,s$e.frame.x,s$e.frame.y,s$e.frame.w,s$e.frame.h,s$e.spriteSourceSize.x,s$e.spriteSourceSize.y,s$e.sourceSize.w,s$e.sourceSize.h),s$V.cacheRes(s$s,s$k),s$V.keepCache(this._url,s$b+s$a),s$k.url=s$s,s$c.push(s$s)}else for(s$a in s$x)s$w=s$q[(s$e=s$x[s$a]).frame.idx?s$e.frame.idx:0],s$s=s$p.formatURL(s$b+s$a),s$V.cacheRes(s$s,s$td.create(s$w,s$e.frame.x,s$e.frame.y,s$e.frame.w,s$e.frame.h,s$e.spriteSourceSize.x,s$e.spriteSourceSize.y,s$e.sourceSize.w,s$e.sourceSize.h)),s$V.loadedMap[s$s].url=s$s,s$V.keepCache(this._url,s$b+s$a),s$c.push(s$s);delete this._data.pics,this.complete(this._data)}else if("font"==s$L){if(!s$d.src)return this._data=s$d,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var s$A=new s$Q;s$A.parseFont(this._data,s$d);var s$y=this._url.split(".fnt")[0].split("/"),s$$=s$y[s$y.length-1];s$ad.registerBitmapFont(s$$,s$A),this._data=s$A,this.complete(this._data)}else if("pkm"==s$L){var s$O=s$yd.create(s$d,this._url),s$n=new s$td(s$O);s$n.url=this._url,this.complete(s$n)}else this.complete(s$d)},s$L.parsePLFData=function(s$d){var s$L,s$l,s$Z;for(s$L in s$d)switch(s$Z=s$d[s$L],s$L){case"json":case"text":for(s$l in s$Z)s$V.preLoadedMap[s$p.formatURL(s$l)]=s$Z[s$l];break;default:for(s$l in s$Z)s$V.preLoadedMap[s$p.formatURL(s$l)]=s$Z[s$l]}},s$L.complete=function(s$d){this._data=s$d,this._customParse?this.event("loaded",s$d instanceof Array?[s$d]:s$d):(s$V._loaders.push(this),s$V._isWorking||s$V.checkNext())},s$L.endLoad=function(s$d){s$d&&(this._data=s$d),this._cache&&s$V.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},s$c(0,s$L,"url",function(){return this._url}),s$c(0,s$L,"data",function(){return this._data}),s$c(0,s$L,"cache",function(){return this._cache}),s$c(0,s$L,"type",function(){return this._type}),s$V.checkNext=function(){s$V._isWorking=!0;for(var s$d=s$i.now();s$V._startIndex<s$V._loaders.length;)if(s$i.now(),s$V._loaders[s$V._startIndex].endLoad(),s$V._startIndex++,s$i.now()-s$d>s$V.maxTimeOut)return console.warn("loader callback cost a long time:"+(s$i.now()-s$d)+" url="+s$V._loaders[s$V._startIndex-1].url),void s$$.timer.frameOnce(1,null,s$V.checkNext);s$V._loaders.length=0,s$V._startIndex=0,s$V._isWorking=!1},s$V.clearRes=function(s$d,s$L){if(null!=s$d){void 0===s$L&&(s$L=!1),s$d=s$p.formatURL(s$d);var s$l=s$V.getAtlas(s$d);if(s$l){for(var s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++){var s$_=s$l[s$Z],s$N=s$V.getRes(s$_);delete s$V.loadedMap[s$_],s$V.clearCache(s$d.substring(s$p.basePath.length),s$_.substring(s$p.basePath.length)),s$N&&s$N.destroy(s$L)}s$l.length=0,delete s$V.atlasMap[s$d],delete s$V.loadedMap[s$d]}else{var s$m=s$V.loadedMap[s$d];s$m&&(delete s$V.loadedMap[s$d],s$m instanceof laya.resource.Texture&&s$m.bitmap&&s$m.destroy(s$L))}}},s$V.clearTextureRes=function(s$d){s$d=s$p.formatURL(s$d);var s$L=laya.net.Loader.getAtlas(s$d),s$l=s$L&&0<s$L.length?laya.net.Loader.getRes(s$L[0]):laya.net.Loader.getRes(s$d);s$l&&s$l.bitmap&&(s$H.isConchApp&&!s$H.isConchWebGL?s$l.bitmap.source.releaseTexture&&s$l.bitmap.source.releaseTexture():null==s$l.bitmap._atlaser&&s$l.bitmap.releaseResource(!0))},s$V.getRes=function(s$d){return s$V.loadedMap[s$p.formatURL(s$d)]},s$V.getAtlas=function(s$d){return s$V.atlasMap[s$p.formatURL(s$d)]},s$V.cacheRes=function(s$d,s$L){s$d=s$p.formatURL(s$d),null!=s$V.loadedMap[s$d]?console.warn("Resources already exist,is repeated loading:",s$d):s$V.loadedMap[s$d]=s$L},s$V.setGroup=function(s$d,s$L){s$V.groupMap[s$L]||(s$V.groupMap[s$L]=[]),s$V.groupMap[s$L].push(s$d)},s$V.clearResByGroup=function(s$d){if(s$V.groupMap[s$d]){var s$L=s$V.groupMap[s$d],s$l=0,s$Z=s$L.length;for(s$l=0;s$l<s$Z;s$l++)s$V.clearRes(s$L[s$l]);s$L.length=0}},s$V.keepCache=function(s$d,s$L){if(s$d&&s$L){var s$l=s$V.cacheSet[s$L];s$l?-1==s$l.indexOf(s$d)&&s$l.push(s$d):s$V.cacheSet[s$L]=[s$d]}},s$V.clearCache=function(s$d,s$L){if(s$d&&s$L){var s$l=s$V.cacheSet[s$L];if(s$l){var s$Z=s$l.indexOf(s$d);if(-1!==s$Z){var s$h=s$l.length-1;0==s$h?(delete s$V.cacheSet[s$L],0<s$V.imgMgrSet[s$L]?s$N.imgMgrFree(s$L,s$V.imgMgrSet[s$L]):s$V.clearRes(s$L,!0)):(s$l[s$Z]=s$l[s$h],s$l.length=s$h)}}}},s$V.saveObject=function(s$d,s$L,s$l){if(s$L&&s$d){var s$Z=s$V.objectSet[s$d];s$Z?(console.warn("Loader.saveObject: "+s$d),s$Z[0]=s$L,s$Z[1]=s$l):s$V.objectSet[s$d]=[s$L,s$l,[]]}},s$V.findObject=function(s$d){if(s$d){var s$L=s$V.objectSet[s$d];if(s$L)return s$L[0]}return null},s$V.keepObject=function(s$d,s$L){if(s$d&&s$L){var s$l=s$V.objectSet[s$L];s$l&&-1===s$l[2].indexOf(s$d)&&s$l[2].push(s$d)}},s$V.clearObject=function(s$d,s$L){if(s$d&&s$L){var s$l=s$V.objectSet[s$L];if(s$l){var s$Z=s$l[2],s$h=s$Z.indexOf(s$d);if(-1!==s$h){var s$_=s$Z.length-1;0==s$_?(delete s$V.objectSet[s$L],s$l[1]&&s$l[1].call(null,s$l[0])):(s$Z[s$h]=s$Z[s$_],s$Z.length=s$_)}}}},s$V.TEXT="text",s$V.JSON="json",s$V.XML="xml",s$V.BUFFER="arraybuffer",s$V.IMAGE="image",s$V.SOUND="sound",s$V.ATLAS="atlas",s$V.FONT="font",s$V.TTF="ttf",s$V.PLF="plf",s$V.PKM="pkm",s$V.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},s$V.parserMap={},s$V.groupMap={},s$V.maxTimeOut=100,s$V.loadedMap={},s$V.preLoadedMap={},s$V.atlasMap={},s$V._loaders=[],s$V._isWorking=!1,s$V._startIndex=0,s$V.imgCache={},s$V.cacheSet={},s$V.objectSet={},s$V.imgMgrSet={},s$V}(),s$ud=function(s$d){var s$q;function s$Y(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},s$Y.__super.call(this);for(var s$d=0;s$d<this._maxPriority;s$d++)this._resInfos[s$d]=[]}s$t(s$Y,"laya.net.LoaderManager",s$x);var s$L=s$Y.prototype;return s$L.create=function(s$d,s$l,s$L,s$Z,s$h,s$_,s$N,s$m){if(null==s$_&&(s$_=2),null==s$N&&(s$N=!0),s$d instanceof Array){var s$u=s$d,s$x=s$u.length,s$t=0;if(s$L)var s$b=s$e.create(s$L.caller,s$L.method,s$L.args,!1);for(var s$q=0;s$q<s$x;s$q++){var s$Y=s$u[s$q];"string"==typeof s$Y&&(s$Y=s$u[s$q]={url:s$Y}),s$Y.progress=0}for(s$q=0;s$q<s$x;s$q++){s$Y=s$u[s$q];var s$c=s$L?s$e.create(null,s$k,[s$Y],!1):null,s$r=s$L||s$l?s$e.create(null,s$a,[s$Y]):null;this._create(s$Y.url,s$r,s$c,s$Y.clas||s$Z,s$Y.params||s$h,null!=s$Y.priority&&0<=s$Y.priority?s$Y.priority:s$_,s$N,s$Y.group||s$m)}function s$a(s$d,s$L){s$t++,s$d.progress=1,s$t===s$x&&s$l&&s$l.run()}function s$k(s$d,s$L){s$d.progress=s$L;for(var s$l=0,s$Z=0;s$Z<s$x;s$Z++){s$l+=s$u[s$Z].progress}var s$h=s$l/s$x;s$b.runWith(s$h)}return!0}return this._create(s$d,s$l,s$L,s$Z,s$h,s$_,s$N,s$m)},s$L._create=function(s$L,s$l,s$d,s$Z,s$h,s$_,s$N,s$m){s$L&&""!=s$L||console.error("加载的url不合法 "+s$L),null==s$_&&(s$_=2),null==s$N&&(s$N=!0);var s$u=s$p.formatURL(s$L),s$x=this.getRes(s$u);if(s$x)!s$x.hasOwnProperty("loaded")||s$x.loaded?(s$d&&s$d.runWith(1),s$l&&s$l.run()):s$l&&s$$.loader._createListener(s$L,s$l.caller,s$l.method,s$l.args,!0,!1);else{var s$t=s$f.getFileExtension(s$L),s$b=s$Y.createMap[s$t];if(!s$b)throw new Error("LoaderManager:unknown file("+s$L+") extension with: "+s$t+".");s$Z||(s$Z=s$b[0]);var s$q=s$b[1];if("atlas"==s$t)this.load(s$L,s$l,s$d,s$q,s$_,s$N);else{s$Z===s$td&&(s$q="htmlimage"),(s$x=s$Z?new s$Z:null).hasOwnProperty("_loaded")&&(s$x._loaded=!1),s$x._setUrl(s$L),s$m&&s$x._setGroup(s$m),this._createLoad(s$x,s$L,s$e.create(null,function(s$d){s$x&&!s$x.destroyed&&s$d&&s$x.onAsynLoaded.call(s$x,s$L,s$d,s$h),s$l&&s$l.run();s$$.loader.event(s$L)}),s$d,s$q,s$_,!1,s$m,!0),s$N&&this.cacheRes(s$u,s$x)}}return s$x},s$L.load=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){s$d&&""!=s$d||console.error("加载的url不合法 "+s$d);var s$u=this;if(null==s$h&&(s$h=2),null==s$_&&(s$_=!0),void 0===s$m&&(s$m=!1),s$d instanceof Array)return this._loadAssets(s$d,s$L,s$l,s$Z,s$h,s$_,s$N);var s$x=s$md.getRes(s$d);if(null!=s$x)s$$.timer.frameOnce(1,null,function(){s$l&&s$l.runWith(1),s$L&&s$L.runWith(s$x),s$u._loaderCount||s$u.event("complete")});else{var s$t=s$Y._resMap[s$d];s$t?(s$L&&s$t._createListener("complete",s$L.caller,s$L.method,s$L.args,!1,!1),s$l&&s$t._createListener("progress",s$l.caller,s$l.method,s$l.args,!1,!1)):((s$t=this._infoPool.length?this._infoPool.pop():new s$q).url=s$d,s$t.type=s$Z,s$t.cache=s$_,s$t.group=s$N,s$t.ignoreCache=s$m,s$t.priority=s$h,s$L&&s$t.on("complete",s$L.caller,s$L.method,s$L.args),s$l&&s$t.on("progress",s$l.caller,s$l.method,s$l.args),s$Y._resMap[s$d]=s$t,s$h=s$h<this._maxPriority?0<=s$h?s$h:0:this._maxPriority-1,this._resInfos[s$h].push(s$t),this._next())}return this},s$L._createLoad=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){var s$x=this;if(null==s$_&&(s$_=2),null==s$N&&(s$N=!0),void 0===s$u&&(s$u=!1),s$L instanceof Array)return this._loadAssets(s$L,s$l,s$Z,s$h,s$_,s$N,s$m);var s$t=s$md.getRes(s$L);if(null!=s$t)s$$.timer.frameOnce(1,null,function(){s$Z&&s$Z.runWith(1),s$l&&s$l.runWith(s$t),s$x._loaderCount||s$x.event("complete")});else{var s$b=s$Y._resMap[s$L];s$b?(s$l&&s$b._createListener("complete",s$l.caller,s$l.method,s$l.args,!1,!1),s$Z&&s$b._createListener("progress",s$Z.caller,s$Z.method,s$Z.args,!1,!1)):((s$b=this._infoPool.length?this._infoPool.pop():new s$q).url=s$L,s$b.clas=s$d,s$b.type=s$h,s$b.cache=s$N,s$b.group=s$m,s$b.ignoreCache=s$u,s$b.priority=s$_,s$l&&s$b.on("complete",s$l.caller,s$l.method,s$l.args),s$Z&&s$b.on("progress",s$Z.caller,s$Z.method,s$Z.args),s$Y._resMap[s$L]=s$b,s$_=s$_<this._maxPriority?0<=s$_?s$_:0:this._maxPriority-1,this._resInfos[s$_].push(s$b),this._next())}return this},s$L._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var s$d=0;s$d<this._maxPriority;s$d++)for(var s$L=this._resInfos[s$d];0<s$L.length;){var s$l=s$L.shift();if(s$l)return this._doLoad(s$l)}this._loaderCount||this.event("complete")}},s$L._doLoad=function(s$L){this._loaderCount++;var s$l=this._loaders.length?this._loaders.pop():new s$md;s$l.on("complete",null,s$h),s$l.on("progress",null,function(s$d){s$L.event("progress",s$d)}),s$l.on("error",null,function(s$d){s$h(null)});var s$Z=this;function s$h(s$d){s$l.offAll(),s$l._data=null,s$l._customParse=!1,s$Z._loaders.push(s$l),s$Z._endLoad(s$L,s$d instanceof Array?[s$d]:s$d),s$Z._loaderCount--,s$Z._next()}s$l._class=s$L.clas,1<=s$L.priority?(s$l.priority=s$L.priority,s$l.realTime=!1):(s$l.priority=0,s$l.realTime=!0),s$l.load(s$L.url,s$L.type,s$L.cache,s$L.group,s$L.ignoreCache)},s$L._endLoad=function(s$d,s$L){var s$l=s$d.url;if(null==s$L){var s$Z=this._failRes[s$l]||0;if(s$Z<this.retryNum)return console.warn("[warn]Retry to load:",s$l),this._failRes[s$l]=s$Z+1,void s$$.timer.once(this.retryDelay,this,this._addReTry,[s$d],!1);console.warn("[error]Failed to load:",s$l),this.event("error",s$l)}this._failRes[s$l]&&(this._failRes[s$l]=0),delete s$Y._resMap[s$l],s$d.event("complete",s$L),s$d.offAll(),this._infoPool.push(s$d)},s$L._addReTry=function(s$d){this._resInfos[this._maxPriority-1].push(s$d),this._next()},s$L.clearRes=function(s$d,s$L){void 0===s$L&&(s$L=!1),s$md.clearRes(s$d,s$L)},s$L.getRes=function(s$d){return s$md.getRes(s$d)},s$L.cacheRes=function(s$d,s$L){s$md.cacheRes(s$d,s$L)},s$L.clearTextureRes=function(s$d){s$md.clearTextureRes(s$d)},s$L.setGroup=function(s$d,s$L){s$md.setGroup(s$d,s$L)},s$L.clearResByGroup=function(s$d){s$md.clearResByGroup(s$d)},s$L.clearUnLoaded=function(){for(var s$d=0;s$d<this._maxPriority;s$d++){for(var s$L=this._resInfos[s$d],s$l=s$L.length-1;-1<s$l;s$l--){var s$Z=s$L[s$l];s$Z&&(s$Z.offAll(),this._infoPool.push(s$Z))}s$L.length=0}this._loaderCount=0,s$Y._resMap={}},s$L.cancelLoadByUrls=function(s$d){if(s$d)for(var s$L=0,s$l=s$d.length;s$L<s$l;s$L++)this.cancelLoadByUrl(s$d[s$L])},s$L.cancelLoadByUrl=function(s$d){for(var s$L=0;s$L<this._maxPriority;s$L++)for(var s$l=this._resInfos[s$L],s$Z=s$l.length-1;-1<s$Z;s$Z--){var s$h=s$l[s$Z];s$h&&s$h.url===s$d&&(s$l[s$Z]=null,s$h.offAll(),this._infoPool.push(s$h))}s$Y._resMap[s$d]&&delete s$Y._resMap[s$d]},s$L._loadAssets=function(s$d,s$l,s$N,s$L,s$Z,s$h,s$_){null==s$Z&&(s$Z=2),null==s$h&&(s$h=!0);for(var s$m=s$d.length,s$u=0,s$x=0,s$t=[],s$b=!0,s$q=0;s$q<s$m;s$q++){var s$Y=s$d[s$q];if(!s$Y)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+s$d);"string"==typeof s$Y&&(s$Y={url:s$Y,type:s$L,size:1,priority:s$Z}),s$Y.size||(s$Y.size=1),s$Y.progress=0,s$x+=s$Y.size,s$t.push(s$Y);var s$c=s$N?s$e.create(null,s$k,[s$Y],!1):null,s$r=s$l||s$N?s$e.create(null,s$a,[s$Y]):null;this.load(s$Y.url,s$r,s$c,s$Y.type,null!=s$Y.priority&&0<=s$Y.priority?s$Y.priority:2,s$h,s$Y.group||s$_)}function s$a(s$d,s$L){s$u++,s$d.progress=1,s$L||(s$b=!1),s$u===s$m&&s$l&&s$l.runWith(s$b)}function s$k(s$d,s$L){if(null!=s$N){s$d.progress=s$L;for(var s$l=0,s$Z=0;s$Z<s$t.length;s$Z++){var s$h=s$t[s$Z];s$l+=s$h.size*s$h.progress}var s$_=s$l/s$x;s$N.runWith(s$_)}}return this},s$Y.cacheRes=function(s$d,s$L){s$md.cacheRes(s$d,s$L)},s$Y._resMap={},s$u(s$Y,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),s$Y.__init$=function(){s$q=function(s$d){function s$L(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,s$L.__super.call(this)}return s$t(s$L,"",s$x),s$L}()},s$Y}(),s$xd=(function(s$d){function s$h(s$d){s$h.__super.call(this),s$d||(s$d=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var s$L=0,s$l=0,s$Z=0;s$Z<20;s$Z++)s$Z%5!=4?this._mat[s$L++]=s$d[s$Z]:this._alpha[s$l++]=s$d[s$Z];this._action=s$F.createFilterAction(32),this._action.data=this}s$t(s$h,"laya.filters.ColorFilter",s$k);var s$L=s$h.prototype;s$$.imps(s$L,{"laya.filters.IFilter":!0}),s$L.callNative=function(s$d){s$d._$P.cf=this;s$d.conchModel&&s$d.conchModel.setFilterMatrix&&s$d.conchModel.setFilterMatrix(this._mat,this._alpha)},s$c(0,s$L,"type",function(){return 32}),s$c(0,s$L,"action",function(){return this._action})}(),function(s$d){function s$Z(s$d,s$L,s$l){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===s$L&&(s$L=0),s$Z.__super.call(this),this._byteClass=s$l||s$S,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,s$d&&0<s$L&&s$L<65535&&this.connect(s$d,s$L)}s$t(s$Z,"laya.net.Socket",s$x);var s$L=s$Z.prototype;s$L.connect=function(s$d,s$L){var s$l="ws://"+s$d+":"+s$L;s$l="https:"==s$i.window.location.protocol?"wss://"+s$d+":"+s$L:"ws://"+s$d+":"+s$L,this.connectByUrl(s$l)},s$L.connectByUrl=function(s$d){var s$L=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new s$i.window.WebSocket(s$d,this.protocols):this._socket=new s$i.window.WebSocket(s$d),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(s$d){s$L._onOpen(s$d)},this._socket.onmessage=function(s$d){s$L._onMessage(s$d)},this._socket.onclose=function(s$d){s$L._onClose(s$d)},this._socket.onerror=function(s$d){s$L._onError(s$d)}},s$L.cleanSocket=function(){try{this._socket.close()}catch(s$d){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},s$L.close=function(){if(null!=this._socket)try{this._socket.close()}catch(s$d){}},s$L._onOpen=function(s$d){this._connected=!0,this.event("open",s$d)},s$L._onMessage=function(s$d){if(s$d&&s$d.data){var s$L=s$d.data;if(this.disableInput&&s$L)this.event("message",s$L);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var s$l=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,s$L&&("string"==typeof s$L?this._input.writeUTFBytes(s$L):this._input.writeArrayBuffer(s$L),this._addInputPosition=this._input.pos,this._input.pos=s$l),this.event("message",s$L)}}},s$L._onClose=function(s$d){this._connected=!1,this.event("close",s$d)},s$L._onError=function(s$d){this.event("error",s$d)},s$L.send=function(s$d){this._socket.send(s$d)},s$L.flush=function(){if(this._output&&0<this._output.length){var s$L;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(s$d){s$L=s$d}this._output.endian=this.endian,this._output.clear(),s$L&&this.event("error",s$L)}},s$c(0,s$L,"input",function(){return this._input}),s$c(0,s$L,"output",function(){return this._output}),s$c(0,s$L,"connected",function(){return this._connected}),s$c(0,s$L,"endian",function(){return this._endian},function(s$d){this._endian=s$d,null!=this._input&&(this._input.endian=s$d),null!=this._output&&(this._output.endian=s$d)}),s$Z.LITTLE_ENDIAN="littleEndian",s$Z.BIG_ENDIAN="bigEndian"}(),function(s$d){function s$m(){s$m.__super.call(this),this._$1__id=++s$m._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(s$m._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,s$o.currentResourceManager&&s$o.currentResourceManager.addResource(this)}s$t(s$m,"laya.resource.Resource",s$x);var s$L=s$m.prototype;return s$$.imps(s$L,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),s$L._setUrl=function(s$d){var s$L;this._url!==s$d&&(this._url&&((s$L=s$m._urlResourcesMap[this._url]).splice(s$L.indexOf(this),1),0===s$L.length&&delete s$m._urlResourcesMap[this._url]),s$d&&((s$L=s$m._urlResourcesMap[s$d])||(s$m._urlResourcesMap[s$d]=s$L=[]),s$L.push(this)),this._url=s$d)},s$L._getGroup=function(){return this._group},s$L._setGroup=function(s$d){var s$L;this._group!==s$d&&(this._group&&((s$L=s$m._groupResourcesMap[this._group]).splice(s$L.indexOf(this),1),0===s$L.length&&delete s$m._groupResourcesMap[this._group]),s$d&&((s$L=s$m._groupResourcesMap[s$d])||(s$m._groupResourcesMap[s$d]=s$L=[]),s$L.push(this)),this._group=s$d)},s$L._addReference=function(){this._referenceCount++},s$L._removeReference=function(){this._referenceCount--},s$L._clearReference=function(){this._referenceCount=0},s$L._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},s$L.recreateResource=function(){this.completeCreate()},s$L.disposeResource=function(){},s$L.activeResource=function(s$d){void 0===s$d&&(s$d=!1),this._lastUseFrameCount=s$K.loopCount,!this._destroyed&&this.__loaded&&(this._released||s$d)&&this.recreateResource()},s$L.releaseResource=function(s$d){return void 0===s$d&&(s$d=!0),!(!s$d&&this.lock)&&(!(this._released&&!s$d)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},s$L.onAsynLoaded=function(s$d,s$L,s$l){throw new Error("Resource: must override this function!")},s$L.destroy=function(){var s$d;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete s$m._idResourcesMap[this.id],this._url&&((s$d=s$m._urlResourcesMap[this._url])&&(s$d.splice(s$d.indexOf(this),1),0===s$d.length&&delete s$m._urlResourcesMap[this.url]),s$md.clearRes(this._url),this.__loaded||s$F.cancelLoadByUrl(this._url)),this._group&&((s$d=s$m._groupResourcesMap[this._group]).splice(s$d.indexOf(this),1),0===s$d.length&&delete s$m._groupResourcesMap[this.url]))},s$L.completeCreate=function(){this._released=!1,this.event("recovered",this)},s$L.dispose=function(){this.destroy()},s$c(0,s$L,"memorySize",function(){return this._memorySize},function(s$d){var s$L=s$d-this._memorySize;this._memorySize=s$d,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,s$L),this.resourceManager&&this.resourceManager.addSize(s$L)}),s$c(0,s$L,"_loaded",null,function(s$d){this.__loaded=s$d}),s$c(0,s$L,"loaded",function(){return this.__loaded}),s$c(0,s$L,"id",function(){return this._$1__id}),s$c(0,s$L,"destroyed",function(){return this._destroyed}),s$c(0,s$L,"group",function(){return this._getGroup()},function(s$d){this._setGroup(s$d)}),s$c(0,s$L,"resourceManager",function(){return this._resourceManager}),s$c(0,s$L,"url",function(){return this._url}),s$c(0,s$L,"released",function(){return this._released}),s$c(0,s$L,"referenceCount",function(){return this._referenceCount}),s$m.getResourceByID=function(s$d){return s$m._idResourcesMap[s$d]},s$m.getResourceByURL=function(s$d,s$L){return void 0===s$L&&(s$L=0),null==s$m._urlResourcesMap[s$d]?null:s$m._urlResourcesMap[s$d][s$L]},s$m.getResourceCountByURL=function(s$d){return s$m._urlResourcesMap[s$d].length},s$m.destroyUnusedResources=function(s$d){var s$L;if(s$d){var s$l=s$m._groupResourcesMap[s$d];if(s$l)for(var s$Z=s$l.slice(),s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)(s$L=s$Z[s$h]).lock||0!==s$L._referenceCount||s$L.destroy()}else for(var s$N in s$m._idResourcesMap)(s$L=s$m._idResourcesMap[s$N]).lock||0!==s$L._referenceCount||s$L.destroy()},s$m._uniqueIDCounter=0,s$m._idResourcesMap={},s$m._urlResourcesMap={},s$m._groupResourcesMap={},s$m}()),s$td=function(s$d){function s$V(s$d,s$L){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,s$V.__super.call(this),s$d&&null!=s$d._addReference&&s$d._addReference(),this.setTo(s$d,s$L)}s$t(s$V,"laya.resource.Texture",s$x);var s$L=s$V.prototype;return s$L._setUrl=function(s$d){this.url=s$d},s$L.setTo=function(s$d,s$L){if(s$d instanceof s$N.HTMLElement){var s$l=s$wd.create("2D",s$d);this.bitmap=s$l}else this.bitmap=s$d;if(this.uv=s$L||s$V.DEF_UV,s$d){this._w=s$d.width,this._h=s$d.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var s$Z=this;if(this._loaded)s$F.addToAtlas&&s$F.addToAtlas(s$Z);else{var s$h=s$d;s$h instanceof laya.resource.HTMLImage&&s$h.image&&s$h.image.addEventListener("load",function(s$d){s$F.addToAtlas&&s$F.addToAtlas(s$Z)},!1)}}},s$L.active=function(){this.bitmap&&this.bitmap.activeResource()},s$L.destroy=function(s$d){if(void 0===s$d&&(s$d=!1),this.alphaTexture&&(this.alphaTexture.destroy(s$d),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var s$L=this.bitmap;s$d?(s$H.isConchApp&&s$L.source&&s$L.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,s$L.dispose(),s$L._clearReference()):(s$L._removeReference(),0==s$L.referenceCount&&(s$H.isConchApp&&s$L.source&&s$L.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,s$L.dispose())),this.url&&this===s$$.loader.getRes(this.url)&&s$$.loader.clearRes(this.url,s$d),this._loaded=!1}},s$L.load=function(s$d){var s$L=this;this._loaded=!1,s$d=s$p.customFormat(s$d);var s$l=this.bitmap||(this.bitmap=s$yd.create(s$d));s$l.uri=s$d,s$l&&s$l._addReference();var s$Z=this;s$l.onload=function(){s$l.onload=null,s$Z._loaded=!0,s$L.sourceWidth=s$L._w=s$l.width,s$L.sourceHeight=s$L._h=s$l.height,s$Z.event("loaded",this),s$F.addToAtlas&&s$F.addToAtlas(s$Z)}},s$L.addTextureToAtlas=function(s$d){s$F.addTextureToAtlas(this)},s$L.getPixels=function(s$d,s$L,s$l,s$Z){if(s$H.isConchApp){var s$h=this.bitmap;if(s$h.source&&s$h.source.getImageData){var s$_=s$h.source.getImageData(s$d,s$L,s$l,s$Z),s$N=new Uint8Array(s$_);return Array.from(s$N)}return null}return s$H.isWebGL?s$F.getTexturePixels(this,s$d,s$L,s$l,s$Z):(s$i.canvas.size(s$l,s$Z),s$i.canvas.clear(),s$i.context.drawTexture(this,-s$d,-s$L,this.width,this.height,0,0),s$i.context.getImageData(0,0,s$l,s$Z).data)},s$L.onAsynLoaded=function(s$d,s$L){if(s$L){if("function"!=typeof s$L._addReference)throw new Error("bitmap._addReference is not a function. "+s$L.className+" "+typeof s$L._addReference+" "+s$L.constructor);s$L._addReference()}this.setTo(s$L,this.uv),this._loaded&&this.event("loaded",this)},s$c(0,s$L,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),s$c(0,s$L,"loaded",function(){return this._loaded}),s$c(0,s$L,"released",function(){return!this.bitmap||this.bitmap.released}),s$c(0,s$L,"width",function(){return this._w?this._w:this.uv&&this.uv!==s$V.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(s$d){this._w=s$d,this.sourceWidth||(this.sourceWidth=s$d)}),s$c(0,s$L,"repeat",function(){return!s$H.isWebGL||!this.bitmap||this.bitmap.repeat},function(s$d){s$d&&s$H.isWebGL&&this.bitmap&&(this.bitmap.repeat=s$d)&&(this.bitmap.enableMerageInAtlas=!1)}),s$c(0,s$L,"height",function(){return this._h?this._h:this.uv&&this.uv!==s$V.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(s$d){this._h=s$d,this.sourceHeight||(this.sourceHeight=s$d)}),s$c(0,s$L,"isLinearSampling",function(){return!s$H.isWebGL||9728!=this.bitmap.minFifter},function(s$d){!s$d&&s$H.isWebGL&&(s$d||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),s$V.moveUV=function(s$d,s$L,s$l){for(var s$Z=0;s$Z<8;s$Z+=2)s$l[s$Z]+=s$d,s$l[s$Z+1]+=s$L;return s$l},s$V.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){void 0===s$_&&(s$_=0),void 0===s$N&&(s$N=0),void 0===s$m&&(s$m=0),void 0===s$u&&(s$u=0);var s$x=s$d instanceof laya.resource.Texture,s$t=s$x?s$d.uv:s$V.DEF_UV,s$b=s$x?s$d.bitmap:s$d,s$q=s$F.isAtlas(s$b);if(s$q){var s$Y=s$b._atlaser,s$c=s$d._atlasID;if(-1==s$c)throw new Error("create texture error");s$b=s$Y._inAtlasTextureBitmapValue[s$c],s$t=s$Y._inAtlasTextureOriUVValue[s$c]}var s$r=new s$V(s$b,null);s$b.width&&s$L+s$Z>s$b.width&&(s$Z=s$b.width-s$L),s$b.height&&s$l+s$h>s$b.height&&(s$h=s$b.height-s$l),s$r.width=s$Z,s$r.height=s$h,s$r.offsetX=s$_,s$r.offsetY=s$N,s$r.sourceWidth=s$m||s$Z,s$r.sourceHeight=s$u||s$h;var s$a=1/s$b.width,s$k=1/s$b.height;s$L*=s$a,s$l*=s$k,s$Z*=s$a,s$h*=s$k;var s$e=s$r.uv[0],s$w=s$r.uv[1],s$s=s$r.uv[4],s$A=s$r.uv[5],s$y=s$s-s$e,s$$=s$A-s$w,s$O=s$V.moveUV(s$t[0],s$t[1],[s$L,s$l,s$L+s$Z,s$l,s$L+s$Z,s$l+s$h,s$L,s$l+s$h]);s$r.uv=[s$e+s$O[0]*s$y,s$w+s$O[1]*s$$,s$s-(1-s$O[2])*s$y,s$w+s$O[3]*s$$,s$s-(1-s$O[4])*s$y,s$A-(1-s$O[5])*s$$,s$e+s$O[6]*s$y,s$A-(1-s$O[7])*s$$],s$q&&s$r.addTextureToAtlas();var s$n=s$b.scaleRate;return s$n&&1!=s$n?(s$r.sourceWidth/=s$n,s$r.sourceHeight/=s$n,s$r.width/=s$n,s$r.height/=s$n,s$r.scaleRate=s$n,s$r.offsetX/=s$n,s$r.offsetY/=s$n):s$r.scaleRate=1,s$r},s$V.createFromTexture=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$d.scaleRate;1!=s$_&&(s$L*=s$_,s$l*=s$_,s$Z*=s$_,s$h*=s$_);var s$N=s$n.TEMP.setTo(s$L-s$d.offsetX,s$l-s$d.offsetY,s$Z,s$h),s$m=s$N.intersection(s$V._rect1.setTo(0,0,s$d.width,s$d.height),s$V._rect2);if(!s$m)return null;var s$u=s$V.create(s$d,s$m.x,s$m.y,s$m.width,s$m.height,s$m.x-s$N.x,s$m.y-s$N.y,s$Z,s$h);if(s$u.bitmap&&s$u.bitmap._removeReference)return s$u.bitmap._removeReference(),s$u;var s$x="bitmap:"+(s$u.bitmap?s$u.bitmap.constructor?s$u.bitmap.constructor.name:s$u.bitmap.__className:"")+", url:"+(s$d.url+" | "+(s$u.bitmap?s$u.bitmap.url:s$d.url))+", x="+s$L+",y="+s$l+",width="+s$Z+",height="+s$h+", result="+(s$m?s$m.x+","+s$m.y+","+s$m.width+","+s$m.height:"null")+", rect="+s$N.x+","+s$N.y+","+s$N.width+","+s$N.height;throw new Error("报错：bitmap._removeReference is not a function  "+s$x)},s$V.DEF_UV=[0,0,1,0,1,1,0,1],s$V.INV_UV=[0,1,1,1,1,0,0,0],s$V._rect1=new s$n,s$V._rect2=new s$n,s$V}(),s$d=function(s$d){var s$m;function s$_(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,s$_.__super.call(this)}s$t(s$_,"laya.utils.TimeLine",s$x);var s$L=s$_.prototype;return s$L.to=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=0),this._create(s$d,s$L,s$l,s$Z,s$h,!0)},s$L.from=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=0),this._create(s$d,s$L,s$l,s$Z,s$h,!1)},s$L._create=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$G.getItemByClass("tweenData",s$m);return s$N.isTo=s$_,s$N.type=0,s$N.target=s$d,s$N.duration=s$l,s$N.data=s$L,s$N.startTime=this._startTime+s$h,s$N.endTime=s$N.startTime+s$N.duration,s$N.ease=s$Z,this._startTime=Math.max(s$N.endTime,this._startTime),this._tweenDataList.push(s$N),this._startTimeSort=!0,this._endTimeSort=!0,this},s$L.addLabel=function(s$d,s$L){var s$l=s$G.getItemByClass("tweenData",s$m);return s$l.type=1,s$l.data=s$d,s$l.endTime=s$l.startTime=this._startTime+s$L,this._labelDic||(this._labelDic={}),this._labelDic[s$d]=s$l,this._tweenDataList.push(s$l),this},s$L.removeLabel=function(s$d){if(this._labelDic&&this._labelDic[s$d]){var s$L=this._labelDic[s$d];if(s$L){var s$l=this._tweenDataList.indexOf(s$L);-1<s$l&&this._tweenDataList.splice(s$l,1)}delete this._labelDic[s$d]}},s$L.gotoTime=function(s$d){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var s$L,s$l,s$Z,s$h;for(var s$_ in this._firstTweenDic)if(s$l=this._firstTweenDic[s$_])for(var s$N in s$l)s$l.diyTarget.hasOwnProperty(s$N)&&(s$l.diyTarget[s$N]=s$l[s$N]);for(s$_ in this._tweenDic)(s$L=this._tweenDic[s$_]).clear(),delete this._tweenDic[s$_];if(this._index=0,this._gidIndex=0,this._currTime=s$d,this._lastTime=s$i.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=s$Z=this._tweenDataList.concat(),s$Z.sort(function(s$d,s$L){return s$d.endTime>s$L.endTime?1:s$d.endTime<s$L.endTime?-1:0})}else s$Z=this._endTweenDataList;for(var s$m=0,s$u=s$Z.length;s$m<s$u;s$m++)if(0==(s$h=s$Z[s$m]).type){if(!(s$d>=s$h.endTime))break;this._index=Math.max(this._index,s$m+1);var s$x=s$h.data;if(s$h.isTo)for(var s$t in s$x)s$h.target[s$t]=s$x[s$t]}for(s$m=0,s$u=this._tweenDataList.length;s$m<s$u;s$m++)0==(s$h=this._tweenDataList[s$m]).type&&s$d>=s$h.startTime&&s$d<s$h.endTime&&(this._index=Math.max(this._index,s$m+1),this._gidIndex++,(s$L=s$G.getItemByClass("tween",s$J))._create(s$h.target,s$h.data,s$h.duration,s$h.ease,s$e.create(this,this._animComplete,[this._gidIndex]),0,!1,s$h.isTo,!0,!1),s$L.setStartTime(this._currTime-(s$d-s$h.startTime)),s$L._updateEase(this._currTime),s$L.gid=this._gidIndex,this._tweenDic[this._gidIndex]=s$L)}},s$L.gotoLabel=function(s$d){if(null!=this._labelDic){var s$L=this._labelDic[s$d];s$L&&this.gotoTime(s$L.startTime)}},s$L.pause=function(){s$$.timer.clear(this,this._update)},s$L.resume=function(){this.play(this._currTime,this._loopKey)},s$L.play=function(s$d,s$L){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(s$d,s$L){return s$d.startTime>s$L.startTime?1:s$d.startTime<s$L.startTime?-1:0});for(var s$l=0,s$Z=this._tweenDataList.length;s$l<s$Z;s$l++){var s$h=this._tweenDataList[s$l];if(null!=s$h&&0==s$h.type){var s$_=s$h.target,s$N=s$_.$_GID||(s$_.$_GID=s$f.getGID()),s$m=null;for(var s$u in null==this._firstTweenDic[s$N]?((s$m={}).diyTarget=s$_,this._firstTweenDic[s$N]=s$m):s$m=this._firstTweenDic[s$N],s$h.data)null==s$m[s$u]&&(s$m[s$u]=s$_[s$u])}}}"string"==typeof s$d?this.gotoLabel(s$d):this.gotoTime(s$d),this._loopKey=s$L,this._lastTime=s$i.now(),s$$.timer.frameLoop(1,this,this._update)}},s$L._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var s$d in this._tweenDic)(s$L=this._tweenDic[s$d]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var s$L,s$l=s$i.now(),s$Z=s$l-this._lastTime,s$h=this._currTime+=s$Z*this.scale;for(s$d in this._lastTime=s$l,this._tweenDic)(s$L=this._tweenDic[s$d])._updateEase(s$h);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var s$_=this._tweenDataList[this._index];s$h>=s$_.startTime&&(this._index++,0==s$_.type?(this._gidIndex++,(s$L=s$G.getItemByClass("tween",s$J))._create(s$_.target,s$_.data,s$_.duration,s$_.ease,s$e.create(this,this._animComplete,[this._gidIndex]),0,!1,s$_.isTo,!0,!1),s$L.setStartTime(s$h),s$L.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=s$L)._updateEase(s$h)):this.event("label",s$_.data))}},s$L._animComplete=function(s$d){this._tweenDic[s$d]&&delete this._tweenDic[s$d]},s$L._complete=function(){this.event("complete")},s$L.reset=function(){var s$d;if(this._labelDic)for(s$d in this._labelDic)delete this._labelDic[s$d];for(s$d in this._tweenDic)this._tweenDic[s$d].clear(),delete this._tweenDic[s$d];for(s$d in this._firstTweenDic)delete this._firstTweenDic[s$d];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var s$L,s$l=0;for(s$L=this._tweenDataList.length,s$l=0;s$l<s$L;s$l++)this._tweenDataList[s$l]&&this._tweenDataList[s$l].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,s$$.timer.clear(this,this._update)},s$L.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},s$c(0,s$L,"index",function(){return this._frameIndex},function(s$d){this._frameIndex=s$d,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),s$c(0,s$L,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),s$_.to=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=0),(new s$_).to(s$d,s$L,s$l,s$Z,s$h)},s$_.from=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$h&&(s$h=0),(new s$_).from(s$d,s$L,s$l,s$Z,s$h)},s$_.__init$=function(){s$m=function(){function s$d(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return s$t(s$d,""),s$d.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,s$G.recover("tweenData",this)},s$d}()},s$_}(),s$bd=function(s$h){function s$l(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,s$l.__super.call(this),this._style=s$m.EMPTY}s$t(s$l,"laya.display.Sprite",s$h);var s$d=s$l.prototype;return s$$.imps(s$d,{"laya.display.ILayout":!0}),s$d.createConchModel=function(){return new ConchNode},s$d.destroy=function(s$d){if(void 0===s$d&&(s$d=!0),this._releaseMem(),!this._destroyed){this.filters=null;var s$L=this.mask;s$L&&(this.mask=null,s$L.destroy(s$d))}s$h.prototype.destroy.call(this,s$d),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},s$d.updateZOrder=function(){s$f.updateOrder(this._childs)&&this.repaint()},s$d.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},s$d.setBounds=function(s$d){this._set$P("uBounds",s$d)},s$d.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new s$n),s$n._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},s$d.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new s$n),s$n._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},s$d._boundPointsToParent=function(s$d){void 0===s$d&&(s$d=!1);var s$L=0,s$l=0;this._style&&(s$L=this._style._tf.translateX,s$l=this._style._tf.translateY,s$d=s$d||0!==this._style._tf.rotate,this._style.scrollRect&&(s$L+=this._style.scrollRect.x,s$l+=this._style.scrollRect.y));var s$Z=this._getBoundPointsM(s$d);if(!s$Z||s$Z.length<1)return s$Z;if(8!=s$Z.length&&(s$Z=s$d?s$A.scanPList(s$Z):s$n._getWrapRec(s$Z,s$n.TEMP)._getBoundPoints()),!this.transform)return s$f.transPointList(s$Z,this._x-s$L,this._y-s$l),s$Z;var s$h=s$O.TEMP,s$_=0,s$N=s$Z.length;for(s$_=0;s$_<s$N;s$_+=2)s$h.x=s$Z[s$_],s$h.y=s$Z[s$_+1],this.toParentPoint(s$h),s$Z[s$_]=s$h.x,s$Z[s$_+1]=s$h.y;return s$Z},s$d.getGraphicBounds=function(s$d){return void 0===s$d&&(s$d=!1),this._graphics?this._graphics.getBounds(s$d):s$n.TEMP.setTo(0,0,0,0)},s$d._getBoundPointsM=function(s$d){if(void 0===s$d&&(s$d=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var s$L=s$f.clearArray(this._$P.temBM),s$l=s$n.TEMP;return s$l.copyFrom(this.scrollRect),s$f.concatArray(s$L,s$l._getBoundPoints()),s$L}for(var s$Z,s$h,s$_,s$N=this._graphics?this._graphics.getBoundPoints():s$f.clearArray(this._$P.temBM),s$m=0,s$u=(s$_=this._childs).length;s$m<s$u;s$m++)(s$Z=s$_[s$m])instanceof laya.display.Sprite&&1==s$Z.visible&&(s$h=s$Z._boundPointsToParent(s$d))&&(s$N=s$N?s$f.concatArray(s$N,s$h):s$h);return s$N},s$d.getStyle=function(){return this._style===s$m.EMPTY&&(this._style=new s$m),this._style},s$d.setStyle=function(s$d){this._style=s$d},s$d._adjustTransform=function(){this._tfChanged=!1;var s$d,s$L=this._style._tf,s$l=s$L.scaleX,s$Z=s$L.scaleY;if(s$L.rotate||1!==s$l||1!==s$Z||s$L.skewX||s$L.skewY){(s$d=this._transform||(this._transform=s$E.create())).bTransform=!0;var s$h=.0174532922222222*(s$L.rotate-s$L.skewX),s$_=.0174532922222222*(s$L.rotate+s$L.skewY),s$N=Math.cos(s$_),s$m=Math.sin(s$_),s$u=Math.sin(s$h),s$x=Math.cos(s$h);return s$d.a=s$l*s$N,s$d.b=s$l*s$m,s$d.c=-s$Z*s$u,s$d.d=s$Z*s$x,s$d.tx=s$d.ty=0,s$d}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,s$d},s$d.pos=function(s$d,s$L,s$l){if(void 0===s$l&&(s$l=!1),this._x!==s$d||this._y!==s$L){if(this.destroyed)return this;if(s$l){this._x=s$d,this._y=s$L,this.conchModel&&this.conchModel.pos(this._x,this._y);var s$Z=this._parent;s$Z&&0===s$Z._repaint&&(s$Z._repaint=1,s$Z.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=s$d,this.y=s$L}return this},s$d.pivot=function(s$d,s$L){return this.pivotX=s$d,this.pivotY=s$L,this},s$d.size=function(s$d,s$L){return this.width=s$d,this.height=s$L,this},s$d.scale=function(s$d,s$L,s$l){void 0===s$l&&(s$l=!1);var s$Z=this.getStyle(),s$h=s$Z._tf;if(s$h.scaleX!=s$d||s$h.scaleY!=s$L){if(this.destroyed)return this;if(s$l){s$Z.setScale(s$d,s$L),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(s$d,s$L),this._renderType|=4;var s$_=this._parent;s$_&&0===s$_._repaint&&(s$_._repaint=1,s$_.parentRepaint())}else this.scaleX=s$d,this.scaleY=s$L}return this},s$d.skew=function(s$d,s$L){return this.skewX=s$d,this.skewY=s$L,this},s$d.render=function(s$d,s$L,s$l){s$K.spriteCount++,s$j.renders[this._renderType]._fun(this,s$d,s$L+this._x,s$l+this._y),this._repaint=0},s$d.drawToCanvas=function(s$d,s$L,s$l,s$Z){if(s$H.isConchNode){var s$h=s$wd.create("2D");return new s$X(s$d,s$L,s$h).ctx.setCanvasType(1),this.conchModel.drawToCanvas(s$h.source,s$l,s$Z),s$h}return s$F.drawToCanvas(this,this._renderType,s$d,s$L,s$l,s$Z)},s$d.customRender=function(s$d,s$L,s$l){this._renderType|=1024},s$d._applyFilters=function(){var s$d;if(!s$H.isWebGL&&((s$d=this._$P.filters)&&!(s$d.length<1)))for(var s$L=0,s$l=s$d.length;s$L<s$l;s$L++)s$d[s$L].action.apply(this._$P.cacheCanvas)},s$d._isHaveGlowFilter=function(){var s$d,s$L=0;if(this.filters)for(s$L=0;s$L<this.filters.length;s$L++)if(8==this.filters[s$L].type)return!0;for(s$L=0,s$d=this._childs.length;s$L<s$d;s$L++)if(this._childs[s$L]._isHaveGlowFilter())return!0;return!1},s$d.localToGlobal=function(s$d,s$L){void 0===s$L&&(s$L=!1),!0===s$L&&(s$d=new s$O(s$d.x,s$d.y));for(var s$l=this;s$l&&s$l!=s$$.stage;)s$d=s$l.toParentPoint(s$d),s$l=s$l.parent;return s$d},s$d.globalToLocal=function(s$d,s$L){void 0===s$L&&(s$L=!1),s$L&&(s$d=new s$O(s$d.x,s$d.y));for(var s$l=this,s$Z=[];s$l&&s$l!=s$$.stage;)s$Z.push(s$l),s$l=s$l.parent;for(var s$h=s$Z.length-1;0<=s$h;)s$d=(s$l=s$Z[s$h]).fromParentPoint(s$d),s$h--;return s$d},s$d.toParentPoint=function(s$d){if(!s$d)return s$d;s$d.x-=this.pivotX,s$d.y-=this.pivotY,this.transform&&this._transform.transformPoint(s$d),s$d.x+=this._x,s$d.y+=this._y;var s$L=this._style.scrollRect;return s$L&&(s$d.x-=s$L.x,s$d.y-=s$L.y),s$d},s$d.fromParentPoint=function(s$d){if(!s$d)return s$d;s$d.x-=this._x,s$d.y-=this._y;var s$L=this._style.scrollRect;return s$L&&(s$d.x+=s$L.x,s$d.y+=s$L.y),this.transform&&this._transform.invertTransformPoint(s$d),s$d.x+=this.pivotX,s$d.y+=this.pivotY,s$d},s$d.on=function(s$d,s$L,s$l,s$Z){return 1!==this._mouseEnableState&&this.isMouseEvent(s$d)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(s$d,s$L,s$l,s$Z,!1)):s$h.prototype.on.call(this,s$d,s$L,s$l,s$Z)},s$d.once=function(s$d,s$L,s$l,s$Z){return 1!==this._mouseEnableState&&this.isMouseEvent(s$d)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(s$d,s$L,s$l,s$Z,!0)):s$h.prototype.once.call(this,s$d,s$L,s$l,s$Z)},s$d._$2__onDisplay=function(){if(1!==this._mouseEnableState){var s$d=this;for(s$d=s$d.parent;s$d&&1!==s$d._mouseEnableState&&!s$d._getBit(2);)s$d.mouseEnabled=!0,s$d._setBit(2,!0),s$d=s$d.parent}},s$d.loadImage=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=this;return void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),this.graphics.loadImage(s$d,s$L,s$l,s$Z,s$h,function(s$d){s$N.destroyed||(s$N.size(s$L+(s$Z||s$d.width),s$l+(s$h||s$d.height)),s$N.repaint(),s$_&&s$_.runWith(s$d))}),this},s$d.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},s$d._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},s$d._childChanged=function(s$d){this._childs.length?this._renderType|=2048:this._renderType&=-2049,s$d&&this._get$P("hasZorder")&&s$$.timer.callLater(this,this.updateZOrder),this.repaint()},s$d.parentRepaint=function(){var s$d=this._parent;s$d&&0===s$d._repaint&&(s$d._repaint=1,s$d.parentRepaint())},s$d.startDrag=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){void 0===s$L&&(s$L=!1),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=300),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=.92),this._$P.dragging||this._set$P("dragging",new s$T),this._$P.dragging.start(this,s$d,s$L,s$l,s$Z,s$h,s$_,s$N)},s$d.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},s$d._releaseMem=function(){if(this._$P){var s$d=this._$P.cacheCanvas;s$d&&s$d.ctx&&(s$G.recover("RenderContext",s$d.ctx),s$d.ctx.canvas.size(0,0),s$d.ctx=null);var s$L=this._$P._filterCache;s$L&&(s$L.destroy(),s$L.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},s$d._setDisplay=function(s$d){s$d||this._releaseMem(),s$h.prototype._setDisplay.call(this,s$d)},s$d.hitTestPoint=function(s$d,s$L){var s$l=this.globalToLocal(s$O.TEMP.setTo(s$d,s$L));return s$d=s$l.x,s$L=s$l.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?s$n.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(s$d,s$L)},s$d.getMousePoint=function(){return this.globalToLocal(s$O.TEMP.setTo(s$$.stage.mouseX,s$$.stage.mouseY))},s$d._getWords=function(){return null},s$d._addChildsToLayout=function(s$d){var s$L=this._getWords();if(null==s$L&&0==this._childs.length)return!1;if(s$L)for(var s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)s$d.push(s$L[s$l]);s$l=0;for(var s$h=this._childs.length;s$l<s$h;++s$l){var s$_=this._childs[s$l];s$_._style._enableLayout()&&s$_._addToLayout(s$d)}return!0},s$d._addToLayout=function(s$d){this._style.absolute||(this._style.block?s$d.push(this):this._addChildsToLayout(s$d)&&(this.x=this.y=0))},s$d._isChar=function(){return!1},s$d._getCSSStyle=function(){return this._style.getCSSStyle()},s$d._setAttributes=function(s$d,s$L){switch(s$d){case"x":this.x=parseFloat(s$L);break;case"y":this.y=parseFloat(s$L);break;case"width":this.width=parseFloat(s$L);break;case"height":this.height=parseFloat(s$L);break;default:this[s$d]=s$L}},s$d._layoutLater=function(){this.parent&&this.parent._layoutLater()},s$c(0,s$d,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(s$d){this._optimizeScrollRect!=s$d&&(this._optimizeScrollRect=s$d,this.conchModel&&this.conchModel.optimizeScrollRect(s$d))}),s$c(0,s$d,"customRenderEnable",null,function(s$d){if(s$d&&(this._renderType|=1024,s$H.isConchNode)){s$l.CustomList.push(this);var s$L=new s$wd("2d");s$L._setContext(new CanvasRenderingContext2D),this.customContext=new s$X(0,0,s$L),s$L.context.setCanvasType&&s$L.context.setCanvasType(2),this.conchModel.custom(s$L.context)}}),s$c(0,s$d,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(s$d){this.cacheAs=s$d?this._$P.hasFilter?"none":"normal":"none"}),s$c(0,s$d,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(s$d){var s$L=this._$P.cacheCanvas;if(s$d!==(s$L?s$L.type:"none")){if("none"!==s$d)this._getBit(1)||this._setUpNoticeType(1),s$L||(s$L=this._set$P("cacheCanvas",s$G.getItemByClass("cacheCanvas",Object))),s$L.type=s$d,s$L.reCache=!0,this._renderType|=16,"bitmap"==s$d&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(s$L){var s$l=s$L;s$l&&s$l.ctx&&(s$G.recover("RenderContext",s$l.ctx),s$l.ctx.canvas.size(0,0),s$l.ctx=null),s$G.recover("cacheCanvas",s$L)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),s$c(0,s$d,"zOrder",function(){return this._zOrder},function(s$d){this._zOrder!=s$d&&(this._zOrder=s$d,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(s$d),this._parent&&(s$d&&this._parent._set$P("hasZorder",!0),s$$.timer.callLater(this._parent,this.updateZOrder)))}),s$c(0,s$d,"rotation",function(){return this._style._tf.rotate},function(s$d){var s$L=this.getStyle();if(s$L._tf.rotate!==s$d){s$L.setRotate(s$d),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(s$d),this._renderType|=4;var s$l=this._parent;s$l&&0===s$l._repaint&&(s$l._repaint=1,s$l.parentRepaint())}}),s$c(0,s$d,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(s$d){this._width!==s$d&&(this._width=s$d,this.conchModel&&this.conchModel.size(s$d,this._height),this.repaint())}),s$c(0,s$d,"x",function(){return this._x},function(s$d){if(this._x!==s$d){if(this.destroyed)return;this._x=s$d,this.conchModel&&this.conchModel.pos(s$d,this._y);var s$L=this._parent;s$L&&0===s$L._repaint&&(s$L._repaint=1,s$L.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),s$c(0,s$d,"globalScaleY",function(){for(var s$d=1,s$L=this;s$L&&s$L!==s$$.stage;)s$d*=s$L.scaleY,s$L=s$L.parent;return s$d}),s$c(0,s$d,"hitArea",function(){return this._$P.hitArea},function(s$d){this._set$P("hitArea",s$d)}),s$c(0,s$d,"staticCache",function(){return this._$P.staticCache},function(s$d){this._set$P("staticCache",s$d),s$d||this.reCache()}),s$c(0,s$d,"texture",function(){return this._texture},function(s$d){this._texture!=s$d&&(this._texture=s$d,this.graphics.cleanByTexture(s$d,0,0))}),s$c(0,s$d,"y",function(){return this._y},function(s$d){if(this._y!==s$d){if(this.destroyed)return;this._y=s$d,this.conchModel&&this.conchModel.pos(this._x,s$d);var s$L=this._parent;s$L&&0===s$L._repaint&&(s$L._repaint=1,s$L.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),s$c(0,s$d,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(s$d){this._height!==s$d&&(this._height=s$d,this.conchModel&&this.conchModel.size(this._width,s$d),this.repaint())}),s$c(0,s$d,"blendMode",function(){return this._style.blendMode},function(s$d){this.getStyle().blendMode=s$d,this.conchModel&&this.conchModel.blendMode(s$d),s$d&&"source-over"!=s$d?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),s$c(0,s$d,"scaleX",function(){return this._style._tf.scaleX},function(s$d){var s$L=this.getStyle();if(s$L._tf.scaleX!==s$d){s$L.setScaleX(s$d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(s$d,s$L._tf.scaleY),this._renderType|=4;var s$l=this._parent;s$l&&0===s$l._repaint&&(s$l._repaint=1,s$l.parentRepaint())}}),s$c(0,s$d,"scaleY",function(){return this._style._tf.scaleY},function(s$d){var s$L=this.getStyle();if(s$L._tf.scaleY!==s$d){s$L.setScaleY(s$d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(s$L._tf.scaleX,s$d),this._renderType|=4;var s$l=this._parent;s$l&&0===s$l._repaint&&(s$l._repaint=1,s$l.parentRepaint())}}),s$c(0,s$d,"stage",function(){return s$$.stage}),s$c(0,s$d,"skewX",function(){return this._style._tf.skewX},function(s$d){var s$L=this.getStyle();if(s$L._tf.skewX!==s$d){s$L.setSkewX(s$d),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(s$d,s$L._tf.skewY),this._renderType|=4;var s$l=this._parent;s$l&&0===s$l._repaint&&(s$l._repaint=1,s$l.parentRepaint())}}),s$c(0,s$d,"scrollRect",function(){return this._style.scrollRect},function(s$d){this.getStyle().scrollRect=s$d,this.repaint(),s$d?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(s$d.x,s$d.y,s$d.width,s$d.height)):(this._renderType&=-129,this.conchModel&&(s$l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),s$c(0,s$d,"skewY",function(){return this._style._tf.skewY},function(s$d){var s$L=this.getStyle();if(s$L._tf.skewY!==s$d){s$L.setSkewY(s$d),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(s$L._tf.skewX,s$d),this._renderType|=4;var s$l=this._parent;s$l&&0===s$l._repaint&&(s$l._repaint=1,s$l.parentRepaint())}}),s$c(0,s$d,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(s$d){this._tfChanged=!1,(this._transform=s$d)&&(this._x=s$d.tx,this._y=s$d.ty,s$d.tx=s$d.ty=0,this.conchModel&&this.conchModel.transform(s$d.a,s$d.b,s$d.c,s$d.d,this._x,this._y)),s$d?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),s$c(0,s$d,"pivotX",function(){return this._style._tf.translateX},function(s$d){this.getStyle().setTranslateX(s$d),this.conchModel&&this.conchModel.pivot(s$d,this._style._tf.translateY),this.repaint()}),s$c(0,s$d,"pivotY",function(){return this._style._tf.translateY},function(s$d){this.getStyle().setTranslateY(s$d),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,s$d),this.repaint()}),s$c(0,s$d,"alpha",function(){return this._style.alpha},function(s$d){this._style&&this._style.alpha!==s$d&&(s$d=s$d<0?0:1<s$d?1:s$d,this.getStyle().alpha=s$d,this.conchModel&&this.conchModel.alpha(s$d),1!==s$d?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),s$c(0,s$d,"visible",function(){return this._style.visible},function(s$d){this._style&&this._style.visible!==s$d&&(this.getStyle().visible=s$d,this.conchModel&&this.conchModel.visible(s$d),this.parentRepaint())}),s$c(0,s$d,"graphics",function(){return this._graphics||(this.graphics=s$F.createGraphics())},function(s$d){this._graphics&&(this._graphics._sp=null),(this._graphics=s$d)?(this._renderType&=-2,this._renderType|=512,(s$d._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(s$l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),s$c(0,s$d,"filters",function(){return this._$P.filters},function(s$d){s$d&&0===s$d.length&&(s$d=null),this._$P.filters!=s$d&&(this._set$P("filters",s$d?s$d.slice():null),s$H.isConchApp&&(this.conchModel&&(s$l.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),s$H.isWebGL&&(s$d&&s$d.length?this._renderType|=32:this._renderType&=-33),s$d&&0<s$d.length?(this._getBit(1)||this._setUpNoticeType(1),s$H.isWebGL&&1==s$d.length&&s$d[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(s$H.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),s$c(0,s$d,"parent",s$h.prototype._$get_parent,function(s$d){s$$.superSet(s$dd,this,"parent",s$d),s$d&&this._getBit(2)&&this._$2__onDisplay()}),s$c(0,s$d,"mask",function(){return this._$P._mask},function(s$d){s$d&&this.mask&&this.mask._$P.maskParent||(s$d?(this.cacheAs="bitmap",this._set$P("_mask",s$d),s$d._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",s$d),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(s$d?s$d.conchModel:null),this._renderType|=64,this.parentRepaint())}),s$c(0,s$d,"mouseEnabled",function(){return 1<this._mouseEnableState},function(s$d){this._mouseEnableState=s$d?2:1}),s$c(0,s$d,"globalScaleX",function(){for(var s$d=1,s$L=this;s$L&&s$L!==s$$.stage;)s$d*=s$L.scaleX,s$L=s$L.parent;return s$d}),s$c(0,s$d,"mouseX",function(){return this.getMousePoint().x}),s$c(0,s$d,"mouseY",function(){return this.getMousePoint().y}),s$l.fromImage=function(s$d){return(new s$l).loadImage(s$d)},s$l._cachePool=[],s$l.CustomList=[],s$u(s$l,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=s$N.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),s$l}(s$dd),s$qd=function(s$d){function s$L(s$d){this._audio=null,this._onEnd=null,this._resumePlay=null,s$L.__super.call(this),this._onEnd=s$f.bind(this.__onEnd,this),this._resumePlay=s$f.bind(this.__resumePlay,this),s$d.addEventListener("ended",this._onEnd),this._audio=s$d}s$t(s$L,"laya.media.h5audio.AudioSoundChannel",s$Zd);var s$l=s$L.prototype;return s$l.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(s$$.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},s$l.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,s$i.container.appendChild(this._audio),this._audio.play()}catch(s$d){this.event("error")}},s$l.play=function(s$d){this.isStopped=!1;try{this._audio.playbackRate=s$g.playbackRate,this._audio.currentTime=this.startTime}catch(s$d){return void this._audio.addEventListener("canplay",this._resumePlay)}s$g.addChannel(this),s$i.container.appendChild(this._audio),!s$d&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},s$l.stop=function(){this.isStopped=!0,s$g.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&s$H.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),s$i.onIE||this._audio!=s$ld._musicAudio&&s$G.recover("audio:"+this.url,this._audio),s$i.removeElement(this._audio),this._audio=null)},s$l.pause=function(){this.isStopped=!0,s$g.removeChannel(this),"pause"in this._audio&&this._audio.pause()},s$l.resume=function(){this._audio&&(this.isStopped=!1,s$g.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},s$c(0,s$l,"position",function(){return this._audio?this._audio.currentTime:0}),s$c(0,s$l,"duration",function(){return this._audio?this._audio.duration:0}),s$c(0,s$l,"volume",function(){return this._audio?this._audio.volume:1},function(s$d){this._audio&&(this._audio.volume=s$d)}),s$L}(),s$Yd=function(s$d){function s$L(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=s$_d.ctx,s$L.__super.call(this),this._onPlayEnd=s$f.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}s$t(s$L,"laya.media.webaudio.WebAudioSoundChannel",s$Zd);var s$l=s$L.prototype;return s$l.play=function(s$d){if(s$g.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var s$L=this.context,s$l=this.gain,s$Z=s$L.createBufferSource();(this.bufferSource=s$Z).buffer=this.audioBuffer,s$Z.connect(s$l),s$l&&s$l.disconnect(),s$l.connect(s$L.destination),s$Z.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=s$i.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(s$Z.loop=!0),s$Z.playbackRate.setTargetAtTime?s$Z.playbackRate.setTargetAtTime(s$g.playbackRate,this.context.currentTime,.1):s$Z.playbackRate.value=s$g.playbackRate,s$Z.start(0,this.startTime),!s$d&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},s$l.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(s$$.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},s$l._clearBufferSource=function(){if(this.bufferSource){var s$d=this.bufferSource;s$d.stop?s$d.stop(0):s$d.noteOff(0),s$d.disconnect(0),s$d.onended=null,s$L._tryCleanFailed||this._tryClearBuffer(s$d),this.bufferSource=null}},s$l._tryClearBuffer=function(s$d){try{s$d.buffer=null}catch(s$d){s$L._tryCleanFailed=!0}},s$l.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,s$g.removeChannel(this),this.startHandler=null,this.completeHandler=null},s$l.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,s$g.removeChannel(this)},s$l.resume=function(){this.startTime=this._pauseTime,this.play(!1)},s$c(0,s$l,"position",function(){return this.bufferSource?(s$i.now()-this._startTime)/1e3+this.startTime:0}),s$c(0,s$l,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),s$c(0,s$l,"volume",function(){return this._volume},function(s$d){this.isStopped||(this._volume=s$d,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(s$d,this.context.currentTime,.1):this.gain.gain.value=s$d)}),s$L._tryCleanFailed=!1,s$L}(),s$cd=function(s$d){function s$L(){s$L.__super.call(this),this._w=0,this._h=0}s$t(s$L,"laya.resource.Bitmap",s$xd);var s$l=s$L.prototype;return s$c(0,s$l,"width",function(){return this._w}),s$c(0,s$l,"height",function(){return this._h}),s$c(0,s$l,"source",function(){return this._source}),s$L}(),s$rd=function(s$L){function s$d(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,s$d.__super.call(this),this._interval=s$Z.animationInterval,this._setUpNoticeType(1)}s$t(s$d,"laya.display.AnimationPlayerBase",s$L);var s$l=s$d.prototype;return s$l.play=function(s$d,s$L,s$l,s$Z){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=!0),void 0===s$l&&(s$l=""),void 0===s$Z&&(s$Z=!0),this._isPlaying=!0,this.index="string"==typeof s$d?this._getFrameByLabel(s$d):s$d,this.loop=s$L,this._actionName=s$l,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},s$l._getFrameByLabel=function(s$d){var s$L=0;for(s$L=0;s$L<this._count;s$L++)if(this._labels[s$L]&&0<=this._labels[s$L].indexOf(s$d))return s$L;return 0},s$l._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},s$l._setControlNode=function(s$d){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=s$d)&&s$d!=this&&(s$d.on("display",this,this._checkResumePlaying),s$d.on("undisplay",this,this._checkResumePlaying))},s$l._setDisplay=function(s$d){s$L.prototype._setDisplay.call(this,s$d),this._checkResumePlaying()},s$l._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},s$l.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},s$l.addLabel=function(s$d,s$L){this._labels||(this._labels={}),this._labels[s$L]||(this._labels[s$L]=[]),this._labels[s$L].push(s$d)},s$l.removeLabel=function(s$d){if(s$d){if(this._labels)for(var s$L in this._labels)this._removeLabelFromLabelList(this._labels[s$L],s$d)}else this._labels=null},s$l._removeLabelFromLabelList=function(s$d,s$L){if(s$d)for(var s$l=s$d.length-1;0<=s$l;s$l--)s$d[s$l]==s$L&&s$d.splice(s$l,1)},s$l.gotoAndStop=function(s$d){this.index="string"==typeof s$d?this._getFrameByLabel(s$d):s$d,this.stop()},s$l._displayToIndex=function(s$d){},s$l.clear=function(){this.stop(),this._labels=null},s$c(0,s$l,"interval",function(){return this._interval},function(s$d){this._interval!=s$d&&(this._frameRateChanged=!0,this._interval=s$d,this._isPlaying&&0<s$d&&this.timerLoop(s$d,this,this._frameLoop,null,!0,!0))}),s$c(0,s$l,"isPlaying",function(){return this._isPlaying}),s$c(0,s$l,"index",function(){return this._index},function(s$d){if(this._index=s$d,this._displayToIndex(s$d),this._labels&&this._labels[s$d])for(var s$L=this._labels[s$d],s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)this.event("label",s$L[s$l])}),s$c(0,s$l,"count",function(){return this._count}),s$d.WRAP_POSITIVE=0,s$d.WRAP_REVERSE=1,s$d.WRAP_PINGPONG=2,s$d}(s$bd),s$ad=function(s$L){function s$Y(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,s$Y.__super.call(this),this.overflow=s$Y.VISIBLE,this._style=new s$Ld(this),this._style.wordWrap=!1}s$t(s$Y,"laya.display.Text",s$L);var s$d=s$Y.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._lines=null,this._words&&(this._words.length=0,this._words=null)},s$d._getBoundPointsM=function(s$d){void 0===s$d&&(s$d=!1);var s$L=s$n.TEMP;return s$L.setTo(0,0,this.width,this.height),s$L._getBoundPoints()},s$d.getGraphicBounds=function(s$d){void 0===s$d&&(s$d=!1);var s$L=s$n.TEMP;return s$L.setTo(0,0,this.width,this.height),s$L},s$d._getCSSStyle=function(){return this._style},s$d.lang=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t){if(s$d=s$Y.langPacks&&s$Y.langPacks[s$d]?s$Y.langPacks[s$d]:s$d,arguments.length<2)this._text=s$d;else{for(var s$b=0,s$q=arguments.length;s$b<s$q;s$b++)s$d=s$d.replace("{"+s$b+"}",arguments[s$b+1]);this._text=s$d}},s$d._isPassWordMode=function(){var s$d=this._style.password;return"prompt"in this&&this.prompt==this._text&&(s$d=!1),s$d},s$d._getPassWordTxt=function(s$d){var s$L;s$L="";for(var s$l=s$d.length;0<s$l;s$l--)s$L+="●";return s$L},s$d.renderText=function(s$d,s$L){var s$l=this.graphics;s$l.clear(!0);var s$Z=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(s$i.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);s$i.context.font=s$Z;var s$h=this.padding,s$_=s$h[3],s$N="left",s$m=this._lines,s$u=this.leading+this._charSize.height,s$x=this._currBitmapFont;s$x&&(s$u=this.leading+s$x.getMaxHeight());var s$t=s$h[0];if(!s$x&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(s$N="right",s$_=this._width-s$h[1]):"center"==this.align&&(s$N="center",s$_=.5*this._width+s$h[3]-s$h[1])),0<this._height){var s$b=this._textHeight>this._height?"top":this.valign;"middle"===s$b?s$t=.5*(this._height-s$L*s$u)+s$h[0]-s$h[2]:"bottom"===s$b&&(s$t=this._height-s$L*s$u-s$h[2])}var s$q=this._style;if(s$x&&s$x.autoScaleSize)var s$Y=s$x.fontSize/this.fontSize;if(this._clipPoint)if(s$l.save(),s$x&&s$x.autoScaleSize){var s$c=0,s$r=0;s$c=this._width?this._width-s$h[3]-s$h[1]:this._textWidth,s$r=this._height?this._height-s$h[0]-s$h[2]:this._textHeight,s$c*=s$Y,s$r*=s$Y,s$l.clipRect(s$h[3],s$h[0],s$c,s$r)}else s$l.clipRect(s$h[3],s$h[0],this._width?this._width-s$h[3]-s$h[1]:this._textWidth,this._height?this._height-s$h[0]-s$h[2]:this._textHeight);var s$a=s$q.password;"prompt"in this&&this.prompt==this._text&&(s$a=!1);for(var s$k=0,s$e=0,s$w=Math.min(this._lines.length,s$L+s$d)||1,s$s=s$d;s$s<s$w;s$s++){var s$A,s$y=s$m[s$s];if(s$a){var s$$=s$y.length;s$y="";for(var s$O=s$$;0<s$O;s$O--)s$y+="●"}if(s$k=s$_-(this._clipPoint?this._clipPoint.x:0),s$e=s$t+s$u*s$s-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(s$N,s$k,s$e,s$s),s$x){var s$n=this.width;s$x.autoScaleSize&&(s$n=this.width*s$Y),s$x.drawText(s$y,this,s$k,s$e,this.align,s$n)}else s$H.isWebGL?(this._words||(this._words=[]),(s$A=this._words.length>s$s-s$d?this._words[s$s-s$d]:new s$M).setText(s$y)):s$A=s$y,s$q.stroke?s$l.fillBorderText(s$A,s$k,s$e,s$Z,this.color,s$q.strokeColor,s$q.stroke,s$N):s$l.fillText(s$A,s$k,s$e,s$Z,this.color,s$N)}if(s$x&&s$x.autoScaleSize){var s$V=1/s$Y;this.scale(s$V,s$V)}this._clipPoint&&s$l.restore(),this._startX=s$_,this._startY=s$t},s$d.drawUnderline=function(s$d,s$L,s$l,s$Z){var s$h=this._lineWidths[s$Z];switch(s$d){case"center":s$L-=s$h/2;break;case"right":s$L-=s$h}s$l+=this._charSize.height,this._graphics.drawLine(s$L,s$l,s$L+s$h,s$l,this.underlineColor||this.color,1)},s$d.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);s$i.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new s$O(0,0)):this._clipPoint=null;var s$d=this._lines.length;if(this.overflow!=s$Y.VISIBLE){var s$L=this.overflow==s$Y.HIDDEN?Math.floor:Math.ceil;s$d=Math.min(s$d,s$L((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var s$l=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(s$l,s$d),this.repaint()},s$d.evalTextSize=function(){var s$d,s$L=NaN;s$d=Math.max.apply(this,this._lineWidths),s$L=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],s$d==this._textWidth&&s$L==this._textHeight||(this._textWidth=s$d,this._textHeight=s$L,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},s$d.checkEnabledViewportOrNot=function(){return this.overflow==s$Y.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},s$d.changeText=function(s$d){this._text!==s$d&&(this.lang(s$d+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},s$d.parseLines=function(s$d){var s$L=this.wordWrap||this.overflow==s$Y.HIDDEN;if(s$L)var s$l=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var s$Z=s$i.context.measureText(s$Y._testWord);s$H.isConchApp&&0===s$Z.width&&0===s$Z.height&&(s$Z=s$i.context.measureText("W")),this._charSize.width=s$Z.width,this._charSize.height=s$Z.height||this.fontSize}for(var s$h=s$d.replace(/\r\n/g,"\n").split("\n"),s$_=0,s$N=s$h.length;s$_<s$N;s$_++){var s$m=s$h[s$_];s$L?this.parseLine(s$m,s$l):(this._lineWidths.push(this.getTextWidth(s$m)),this._lines.push(s$m))}},s$d.parseLine=function(s$d,s$L){s$i.context;var s$l,s$Z=this._lines,s$h=0,s$_=NaN,s$N=NaN,s$m=0;if((s$_=this.getTextWidth(s$d))<=s$L)return s$Z.push(s$d),void this._lineWidths.push(s$_);s$_=this._charSize.width,0==(s$h=Math.floor(s$L/s$_))&&(s$h=1),s$N=s$_=this.getTextWidth(s$d.substring(0,s$h));for(var s$u=s$h,s$x=s$d.length;s$u<s$x;s$u++)if(s$L<(s$N+=s$_=this.getTextWidth(s$d.charAt(s$u))))if(this.wordWrap){var s$t=s$d.substring(s$m,s$u);if(s$t.charCodeAt(s$t.length-1)<255?(s$l=/(?:\w|-)+$/.exec(s$t))&&(s$u=s$l.index+s$m,0==s$l.index?s$u+=s$t.length:s$t=s$d.substring(s$m,s$u)):s$Y.RightToLeft&&(s$l=/([\u0600-\u06FF])+$/.exec(s$t))&&(s$u=s$l.index+s$m,0==s$l.index?s$u+=s$t.length:s$t=s$d.substring(s$m,s$u)),s$Z.push(s$t),this._lineWidths.push(s$N-s$_),!((s$m=s$u)+s$h<s$x)){s$Z.push(s$d.substring(s$m,s$x)),this._lineWidths.push(this.getTextWidth(s$Z[s$Z.length-1])),s$m=-1;break}s$u+=s$h,s$N=s$_=this.getTextWidth(s$d.substring(s$m,s$u)),s$u--}else if(this.overflow==s$Y.HIDDEN)return s$Z.push(s$d.substring(0,s$u)),void this._lineWidths.push(this.getTextWidth(s$Z[s$Z.length-1]));this.wordWrap&&-1!=s$m&&(s$Z.push(s$d.substring(s$m,s$x)),this._lineWidths.push(this.getTextWidth(s$Z[s$Z.length-1])))},s$d.getTextWidth=function(s$d){return this._currBitmapFont?this._currBitmapFont.getTextWidth(s$d):s$i.context.measureText(s$d).width},s$d.getWordWrapWidth=function(){var s$d=this.padding,s$L=NaN;return(s$L=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(s$L=this.wordWrap?100:s$i.width),s$L<=0&&(s$L=100),s$L-s$d[3]-s$d[1]},s$d.getCharPoint=function(s$d,s$L){this._isChanged&&s$$.timer.runCallLater(this,this.typeset);for(var s$l=0,s$Z=this._lines,s$h=0,s$_=0,s$N=s$Z.length;s$_<s$N;s$_++){if(s$d<(s$l+=s$Z[s$_].length)){var s$m=s$_;break}s$h=s$l}var s$u=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;s$i.context.font=s$u;var s$x=this.getTextWidth(this._text.substring(s$h,s$d));return(s$L||new s$O).setTo(this._startX+s$x-(this._clipPoint?this._clipPoint.x:0),this._startY+s$m*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},s$c(0,s$d,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(s$d){s$d!=this._width&&(s$$.superSet(s$bd,this,"width",s$d),this.isChanged=!0)}),s$c(0,s$d,"textWidth",function(){return this._isChanged&&s$$.timer.runCallLater(this,this.typeset),this._textWidth}),s$c(0,s$d,"height",function(){return this._height?this._height:this.textHeight},function(s$d){s$d!=this._height&&(s$$.superSet(s$bd,this,"height",s$d),this.isChanged=!0)}),s$c(0,s$d,"textHeight",function(){return this._isChanged&&s$$.timer.runCallLater(this,this.typeset),this._textHeight}),s$c(0,s$d,"padding",function(){return this._getCSSStyle().padding},function(s$d){this._getCSSStyle().padding=s$d,this.isChanged=!0}),s$c(0,s$d,"bold",function(){return this._getCSSStyle().bold},function(s$d){this._getCSSStyle().bold=s$d,this.isChanged=!0}),s$c(0,s$d,"text",function(){return this._text||""},function(s$d){this._text!==s$d&&(this.lang(s$d+""),this.isChanged=!0,this.event("change"))}),s$c(0,s$d,"color",function(){return this._getCSSStyle().color},function(s$d){this._getCSSStyle().color!=s$d&&(this._getCSSStyle().color=s$d,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),s$c(0,s$d,"font",function(){return this._getCSSStyle().fontFamily},function(s$d){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),s$Y._bitmapFonts&&s$Y._bitmapFonts[s$d]&&(this._currBitmapFont=s$Y._bitmapFonts[s$d]),this._getCSSStyle().fontFamily=s$d,this.isChanged=!0}),s$c(0,s$d,"fontSize",function(){return this._getCSSStyle().fontSize},function(s$d){this._getCSSStyle().fontSize=s$d,this.isChanged=!0}),s$c(0,s$d,"italic",function(){return this._getCSSStyle().italic},function(s$d){this._getCSSStyle().italic=s$d,this.isChanged=!0}),s$c(0,s$d,"align",function(){return this._getCSSStyle().align},function(s$d){this._getCSSStyle().align=s$d,this.isChanged=!0}),s$c(0,s$d,"valign",function(){return this._getCSSStyle().valign},function(s$d){this._getCSSStyle().valign=s$d,this.isChanged=!0}),s$c(0,s$d,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(s$d){this._getCSSStyle().wordWrap=s$d,this.isChanged=!0}),s$c(0,s$d,"leading",function(){return this._getCSSStyle().leading},function(s$d){this._getCSSStyle().leading=s$d,this.isChanged=!0}),s$c(0,s$d,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(s$d){this._getCSSStyle().backgroundColor=s$d,this.isChanged=!0}),s$c(0,s$d,"borderColor",function(){return this._getCSSStyle().borderColor},function(s$d){this._getCSSStyle().borderColor=s$d,this.isChanged=!0}),s$c(0,s$d,"stroke",function(){return this._getCSSStyle().stroke},function(s$d){this._getCSSStyle().stroke=s$d,this.isChanged=!0}),s$c(0,s$d,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(s$d){this._getCSSStyle().strokeColor=s$d,this.isChanged=!0}),s$c(0,s$d,"isChanged",null,function(s$d){this._isChanged!==s$d&&(this._isChanged=s$d)&&s$$.timer.callLater(this,this.typeset)}),s$c(0,s$d,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(s$d){if(!(this.overflow!=s$Y.SCROLL||this.textWidth<this._width)&&this._clipPoint){s$d=s$d<this.padding[3]?this.padding[3]:s$d;var s$L=this._textWidth-this._width;s$d=s$L<s$d?s$L:s$d;var s$l=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=s$d,this.renderText(this._lastVisibleLineIndex,s$l)}}),s$c(0,s$d,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(s$d){if(!(this.overflow!=s$Y.SCROLL||this.textHeight<this._height)&&this._clipPoint){s$d=s$d<this.padding[0]?this.padding[0]:s$d;var s$L=this._textHeight-this._height,s$l=(s$d=s$L<s$d?s$L:s$d)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=s$l;var s$Z=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=s$d,this.renderText(s$l,s$Z)}}),s$c(0,s$d,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),s$c(0,s$d,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),s$c(0,s$d,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),s$c(0,s$d,"underlineColor",function(){return this._underlineColor},function(s$d){this._underlineColor=s$d,this._isChanged=!0,this.typeset()}),s$Y.registerBitmapFont=function(s$d,s$L){s$Y._bitmapFonts||(s$Y._bitmapFonts={}),s$Y._bitmapFonts[s$d]=s$L},s$Y.unregisterBitmapFont=function(s$d,s$L){if(void 0===s$L&&(s$L=!0),s$Y._bitmapFonts&&s$Y._bitmapFonts[s$d]){var s$l=s$Y._bitmapFonts[s$d];s$L&&s$l.destroy(),delete s$Y._bitmapFonts[s$d]}},s$Y.setTextRightToLeft=function(){var s$d;(s$d=s$i.canvas.source.style).display="none",s$d.position="absolute",s$d.direction="rtl",s$H._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,s$i.document.body.appendChild(s$i.canvas.source)},s$Y.supportFont=function(s$d){s$i.context.font="10px sans-serif";var s$L=s$i.context.measureText("abcji").width;s$i.context.font="10px "+s$d;var s$l=s$i.context.measureText("abcji").width;return console.log(s$L,s$l),s$L!==s$l},s$Y._testWord="游",s$Y.langPacks=null,s$Y.VISIBLE="visible",s$Y.SCROLL="scroll",s$Y.HIDDEN="hidden",s$Y.CharacterCache=!0,s$Y.RightToLeft=!1,s$Y._bitmapFonts=null,s$u(s$Y,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),s$Y}(s$bd),s$kd=function(s$b){function s$N(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",s$N.__super.call(this),this.offset=new s$O,this._canvasTransform=new s$E,this._previousOrientation=s$i.window.orientation;var s$L=this;this.transform=s$E.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var s$d=s$i.window,s$l=this;s$d.addEventListener("focus",function(){s$L._isFocused=!0,s$l.event("focus"),s$l.event("focuschange")}),s$d.addEventListener("blur",function(){s$L._isFocused=!1,s$l.event("blur"),s$l.event("focuschange"),s$l._isInputting()&&(s$Ad.inputElement.target.focus=!1)});var s$Z="visibilityState",s$h="visibilitychange",s$_=s$d.document;void 0!==s$_.hidden?(s$h="visibilitychange",s$Z="visibilityState"):void 0!==s$_.mozHidden?(s$h="mozvisibilitychange",s$Z="mozVisibilityState"):void 0!==s$_.msHidden?(s$h="msvisibilitychange",s$Z="msVisibilityState"):void 0!==s$_.webkitHidden&&(s$h="webkitvisibilitychange",s$Z="webkitVisibilityState"),s$d.document.addEventListener(s$h,function(){"hidden"==s$i.document[s$Z]?s$l._setStageVisible(!1):s$l._setStageVisible(!0)}),s$d.document.addEventListener("qbrowserVisibilityChange",function(s$d){s$l._setStageVisible(!s$d.hidden)}),s$d.addEventListener("resize",function(){var s$d=s$i.window.orientation;null!=s$d&&s$d!=s$L._previousOrientation&&s$l._isInputting()&&(s$Ad.inputElement.target.focus=!1),s$L._previousOrientation=s$d,s$l._isInputting()||s$l._resetCanvas()}),s$d.addEventListener("orientationchange",function(s$d){s$l._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),s$i.onMobile&&this.on("mousedown",this,this._onmouseMove)}s$t(s$N,"laya.display.Stage",s$b);var s$d=s$N.prototype;return s$d._setStageVisible=function(s$d){this._isVisibility!=s$d&&(this._isVisibility=s$d,this._isVisibility||this._isInputting()&&(s$Ad.inputElement.target.focus=!1),this.event("visibilitychange"))},s$d._isInputting=function(){return s$i.onMobile&&s$Ad.isInputting},s$d._changeCanvasSize=function(){this.setScreenSize(s$i.clientWidth*s$i.pixelRatio,s$i.clientHeight*s$i.pixelRatio)},s$d._resetCanvas=function(){if(this.screenAdaptationEnabled){var s$d=s$H._mainCanvas;s$d.source.style;s$d.size(1,1),s$$.timer.once(100,this,this._changeCanvasSize)}},s$d.setScreenSize=function(s$d,s$L){var s$l=!1;if("none"!==this._screenMode&&(s$l=(s$d/s$L<1?"vertical":"horizontal")!==this._screenMode)){var s$Z=s$L;s$L=s$d,s$d=s$Z}this.canvasRotation=s$l;var s$h=s$H._mainCanvas,s$_=s$h.source.style,s$N=this._canvasTransform.identity(),s$m=this._scaleMode,s$u=s$d/this.designWidth,s$x=s$L/this.designHeight,s$t=this.designWidth,s$b=this.designHeight,s$q=s$d,s$Y=s$L,s$c=s$i.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,s$m){case"noscale":s$u=s$x=1,s$q=this.designWidth,s$Y=this.designHeight;break;case"showall":s$u=s$x=Math.min(s$u,s$x),s$t=s$q=Math.round(this.designWidth*s$u),s$b=s$Y=Math.round(this.designHeight*s$x);break;case"noborder":s$u=s$x=Math.max(s$u,s$x),s$q=Math.round(this.designWidth*s$u),s$Y=Math.round(this.designHeight*s$x);break;case"full":s$u=s$x=1,this._width=s$t=s$d,this._height=s$b=s$L;break;case"fixedwidth":s$x=s$u,this._height=s$b=Math.round(s$L/s$u);break;case"fixedheight":s$u=s$x,this._width=s$t=Math.round(s$d/s$x);break;case"fixedauto":s$d/s$L<this.designWidth/this.designHeight?(s$x=s$u,this._height=s$b=Math.round(s$L/s$u)):(s$u=s$x,this._width=s$t=Math.round(s$d/s$x))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,s$t=s$t+1&2147483646,s$b=s$b+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),s$u*=this.scaleX,s$x*=this.scaleY,1===s$u&&1===s$x?this.transform.identity():(this.transform.a=this._formatData(s$u/(s$q/s$t)),this.transform.d=this._formatData(s$x/(s$Y/s$b)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),s$h.size(s$t,s$b),s$F.changeWebGLSize(s$t,s$b),s$N.scale(s$q/s$t/s$c,s$Y/s$b/s$c),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(s$d-s$q)/s$c:this.offset.x=.5*(s$d-s$q)/s$c,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(s$L-s$Y)/s$c:this.offset.y=.5*(s$L-s$Y)/s$c,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),s$N.translate(this.offset.x,this.offset.y),this.canvasDegree=0,s$l&&("horizontal"===this._screenMode?(s$N.rotate(Math.PI/2),s$N.translate(s$L/s$c,0),this.canvasDegree=90):(s$N.rotate(-Math.PI/2),s$N.translate(0,s$d/s$c),this.canvasDegree=-90)),s$N.a=this._formatData(s$N.a),s$N.d=this._formatData(s$N.d),s$N.tx=this._formatData(s$N.tx),s$N.ty=this._formatData(s$N.ty),s$_.transformOrigin=s$_.webkitTransformOrigin=s$_.msTransformOrigin=s$_.mozTransformOrigin=s$_.oTransformOrigin="0px 0px 0px",s$_.transform=s$_.webkitTransform=s$_.msTransform=s$_.mozTransform=s$_.oTransform="matrix("+s$N.toString()+")",s$N.translate(parseInt(s$_.left)||0,parseInt(s$_.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},s$d._formatData=function(s$d){return Math.abs(s$d)<1e-6?0:Math.abs(1-s$d)<.001?0<s$d?1:-1:s$d},s$d.getMousePoint=function(){return s$O.TEMP.setTo(this.mouseX,this.mouseY)},s$d.repaint=function(){this._repaint=1},s$d.parentRepaint=function(){},s$d._loop=function(){return this.render(s$H.context,0,0),!0},s$d._onmouseMove=function(s$d){this._mouseMoveTime=s$i.now()},s$d.getTimeFromFrameStart=function(){return s$i.now()-this._frameStartTime},s$d.render=function(s$d,s$L,s$l){if("sleep"===this._frameRate&&!s$H.isConchApp){var s$Z=s$i.now();if(!(1e3<=s$Z-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(s$K.loopCount++,s$r.instance.runEvent(),s$$.timer._update()));this._frameStartTime=s$Z}if(this._renderCount++,s$H.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=s$i.now();var s$h="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),s$_=this._renderCount%2==0;if(s$K.renderSlow=!s$h,s$h||s$_||s$H.isConchApp){var s$N;s$K.loopCount++,s$r.instance.runEvent(),s$$.timer._update(),s$F.update3DLoop();var s$m=0,s$u=0;if(s$H.isConchNode)for(s$m=0,s$u=this._scenes.length;s$m<s$u;s$m++)(s$N=this._scenes[s$m])&&s$N._updateSceneConch();else for(s$m=0,s$u=this._scenes.length;s$m<s$u;s$m++)(s$N=this._scenes[s$m])&&s$N._updateScene();if(s$H.isConchNode){var s$x=s$bd.CustomList;for(s$m=0,s$u=s$x.length;s$m<s$u;s$m++){var s$t=s$x[s$m];s$t.customRender(s$t.customContext,0,0)}return}}s$H.isConchNode||this.renderingEnabled&&(s$h||!s$_||s$H.isConchWebGL)&&(s$H.isWebGL?s$H.WebGL.mainContext&&!s$H.WebGL.mainContext.isContextLost()&&(s$d.clear(),s$b.prototype.render.call(this,s$d,s$L,s$l),s$K._show&&s$K._sp&&s$K._sp.render(s$d,s$L,s$l),s$F.clear(this._bgColor),s$F.beginFlush(),s$d.flush(),s$F.endFinish(),s$U.instance&&s$U.getInstance().endDispose()):(s$F.clear(this._bgColor),s$b.prototype.render.call(this,s$d,s$L,s$l),s$K._show&&s$K._sp&&s$K._sp.render(s$d,s$L,s$l)))}else this._renderCount%5==0&&(s$K.loopCount++,s$r.instance.runEvent(),s$$.timer._update())},s$d._requestFullscreen=function(){var s$d=s$i.document.documentElement;s$d.requestFullscreen?s$d.requestFullscreen():s$d.mozRequestFullScreen?s$d.mozRequestFullScreen():s$d.webkitRequestFullscreen?s$d.webkitRequestFullscreen():s$d.msRequestFullscreen&&s$d.msRequestFullscreen()},s$d._fullScreenChanged=function(){s$$.stage.event("fullscreenchange")},s$d.exitFullscreen=function(){var s$d=s$i.document;s$d.exitFullscreen?s$d.exitFullscreen():s$d.mozCancelFullScreen?s$d.mozCancelFullScreen():s$d.webkitExitFullscreen&&s$d.webkitExitFullscreen()},s$c(0,s$d,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),s$c(0,s$d,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),s$c(0,s$d,"frameRate",function(){return this._frameRate},function(s$d){if(this._frameRate=s$d,s$H.isConchApp)switch(this._frameRate){case"slow":s$i.window.conch&&s$i.window.conchConfig.setSlowFrame&&s$i.window.conchConfig.setSlowFrame(!0);break;case"fast":s$i.window.conch&&s$i.window.conchConfig.setSlowFrame&&s$i.window.conchConfig.setSlowFrame(!1);break;case"mouse":s$i.window.conch&&s$i.window.conchConfig.setMouseFrame&&s$i.window.conchConfig.setMouseFrame(2e3);break;case"sleep":s$i.window.conch&&s$i.window.conchConfig.setLimitFPS&&s$i.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),s$c(0,s$d,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),s$c(0,s$d,"width",s$b.prototype._$get_width,function(s$d){this.designWidth=s$d,s$$.superSet(s$bd,this,"width",s$d),s$$.timer.callLater(this,this._changeCanvasSize)}),s$c(0,s$d,"alignH",function(){return this._alignH},function(s$d){this._alignH=s$d,s$$.timer.callLater(this,this._changeCanvasSize)}),s$c(0,s$d,"isFocused",function(){return this._isFocused}),s$c(0,s$d,"height",s$b.prototype._$get_height,function(s$d){this.designHeight=s$d,s$$.superSet(s$bd,this,"height",s$d),s$$.timer.callLater(this,this._changeCanvasSize)}),s$c(0,s$d,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||s$E.create()},s$b.prototype._$set_transform),s$c(0,s$d,"isVisibility",function(){return this._isVisibility}),s$c(0,s$d,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),s$c(0,s$d,"scaleMode",function(){return this._scaleMode},function(s$d){this._scaleMode=s$d,s$$.timer.callLater(this,this._changeCanvasSize)}),s$c(0,s$d,"alignV",function(){return this._alignV},function(s$d){this._alignV=s$d,s$$.timer.callLater(this,this._changeCanvasSize)}),s$c(0,s$d,"bgColor",function(){return this._bgColor},function(s$d){this._bgColor=s$d,this.conchModel&&this.conchModel.bgColor(s$d),s$H.isWebGL&&(s$d?s$N._wgColor=s$P.create(s$d)._color:s$i.onMiniGame||(s$N._wgColor=null)),s$i.onLimixiu?s$N._wgColor=s$P.create(s$d)._color:s$H.canvas.style.background=s$d||"none"}),s$c(0,s$d,"mouseX",function(){return Math.round(s$r.instance.mouseX/this.clientScaleX)}),s$c(0,s$d,"mouseY",function(){return Math.round(s$r.instance.mouseY/this.clientScaleY)}),s$c(0,s$d,"screenMode",function(){return this._screenMode},function(s$d){this._screenMode=s$d}),s$c(0,s$d,"visible",s$b.prototype._$get_visible,function(s$d){this.visible!==s$d&&(s$$.superSet(s$bd,this,"visible",s$d),s$H._mainCanvas.source.style.visibility=s$d?"visible":"hidden")}),s$c(0,s$d,"fullScreenEnabled",null,function(s$d){var s$L=s$i.document,s$l=s$H.canvas;s$d?(s$l.addEventListener("mousedown",this._requestFullscreen),s$l.addEventListener("touchstart",this._requestFullscreen),s$L.addEventListener("fullscreenchange",this._fullScreenChanged),s$L.addEventListener("mozfullscreenchange",this._fullScreenChanged),s$L.addEventListener("webkitfullscreenchange",this._fullScreenChanged),s$L.addEventListener("msfullscreenchange",this._fullScreenChanged)):(s$l.removeEventListener("mousedown",this._requestFullscreen),s$l.removeEventListener("touchstart",this._requestFullscreen),s$L.removeEventListener("fullscreenchange",this._fullScreenChanged),s$L.removeEventListener("mozfullscreenchange",this._fullScreenChanged),s$L.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),s$L.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),s$N.SCALE_NOSCALE="noscale",s$N.SCALE_EXACTFIT="exactfit",s$N.SCALE_SHOWALL="showall",s$N.SCALE_NOBORDER="noborder",s$N.SCALE_FULL="full",s$N.SCALE_FIXED_WIDTH="fixedwidth",s$N.SCALE_FIXED_HEIGHT="fixedheight",s$N.SCALE_FIXED_AUTO="fixedauto",s$N.ALIGN_LEFT="left",s$N.ALIGN_RIGHT="right",s$N.ALIGN_CENTER="center",s$N.ALIGN_TOP="top",s$N.ALIGN_MIDDLE="middle",s$N.ALIGN_BOTTOM="bottom",s$N.SCREEN_NONE="none",s$N.SCREEN_HORIZONTAL="horizontal",s$N.SCREEN_VERTICAL="vertical",s$N.FRAME_FAST="fast",s$N.FRAME_SLOW="slow",s$N.FRAME_MOUSE="mouse",s$N.FRAME_SLEEP="sleep",s$N.FRAME_MOUSE_THREDHOLD=2e3,s$u(s$N,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),s$N}(s$bd),s$ed=(function(s$d){function s$L(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,s$L.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}s$t(s$L,"laya.media.SoundNode",s$bd);var s$l=s$L.prototype;s$l._onParentChange=function(){this.target=this.parent},s$l.play=function(s$d,s$L){void 0===s$d&&(s$d=1),isNaN(s$d)&&(s$d=1),this.url&&(this.stop(),this._channel=s$g.playSound(this.url,s$d,null,s$L))},s$l.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},s$l._setPlayAction=function(s$d,s$L,s$l,s$Z){void 0===s$Z&&(s$Z=!0),this[s$l]&&s$d&&(s$Z?s$d.on(s$L,this,this[s$l]):s$d.off(s$L,this,this[s$l]))},s$l._setPlayActions=function(s$d,s$L,s$l,s$Z){if(void 0===s$Z&&(s$Z=!0),s$d&&s$L){var s$h,s$_=s$L.split(","),s$N=0;for(s$h=s$_.length,s$N=0;s$N<s$h;s$N++)this._setPlayAction(s$d,s$_[s$N],s$l,s$Z)}},s$c(0,s$l,"playEvent",null,function(s$d){(this._playEvents=s$d)&&this._tar&&this._setPlayActions(this._tar,s$d,"play")}),s$c(0,s$l,"target",null,function(s$d){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=s$d,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),s$c(0,s$l,"stopEvent",null,function(s$d){(this._stopEvents=s$d)&&this._tar&&this._setPlayActions(this._tar,s$d,"stop")})}(),function(s$d){function s$L(){this._src=null,this._onload=null,this._onerror=null,s$L.__super.call(this)}s$t(s$L,"laya.resource.FileBitmap",s$cd);var s$l=s$L.prototype;return s$c(0,s$l,"src",function(){return this._src},function(s$d){this._src=s$d}),s$c(0,s$l,"onload",null,function(s$d){}),s$c(0,s$l,"onerror",null,function(s$d){}),s$L}()),s$wd=function(s$d){function s$l(s$d,s$L){this._is2D=!1,s$l.__super.call(this);var s$Z=this;if(this._source=this,"2D"===s$d||"AUTO"===s$d&&!s$H.isWebGL){this._is2D=!0,this._source=s$L||s$i.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var s$h=this;s$h.getContext=function(s$d,s$L){if(s$Z._ctx)return s$Z._ctx;var s$l=s$Z._ctx=s$Z._source.getContext(s$d,s$L);return s$l&&(s$l._canvas=s$h,s$H.isFlash||s$i.onLimixiu||(s$l.size=function(s$d,s$L){})),s$l}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}s$t(s$l,"laya.resource.HTMLCanvas",s$cd);var s$L=s$l.prototype;return s$L.clear=function(){this._ctx&&this._ctx.clear()},s$L.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},s$L.release=function(){},s$L._setContext=function(s$d){this._ctx=s$d},s$L.getContext=function(s$d,s$L){return this._ctx?this._ctx:this._ctx=s$l._createContext(this)},s$L.getMemSize=function(){return 0},s$L.size=function(s$d,s$L){(this._w!=s$d||this._h!=s$L||this._source&&(this._source.width!=s$d||this._source.height!=s$L))&&(this._w=s$d,this._h=s$L,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(s$d,s$L),this._source&&(this._source.height=s$L,this._source.width=s$d))},s$L.getCanvas=function(){return this._source},s$L.toBase64=function(s$d,s$L,s$l){if(this._source)if(s$H.isConchApp&&this._source.toBase64)this._source.toBase64(s$d,s$L,s$l);else{var s$Z=this._source.toDataURL(s$d,s$L);s$l.call(this,s$Z)}},s$c(0,s$L,"context",function(){return this._ctx}),s$c(0,s$L,"asBitmap",null,function(s$d){}),s$l.create=function(s$d,s$L){return new s$l(s$d,s$L)},s$l.TYPE2D="2D",s$l.TYPE3D="3D",s$l.TYPEAUTO="AUTO",s$l._createContext=null,s$l}(),s$sd=(function(s$d){function s$u(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){throw s$u.__super.call(this),new Error("不允许new！")}s$t(s$u,"laya.resource.HTMLSubImage",s$cd),s$u.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){return void 0===s$m&&(s$m=!1),new s$u(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m)}}(),function(s$d){function s$b(){this._frames=null,this._url=null,s$b.__super.call(this),this._setControlNode(this)}s$t(s$b,"laya.display.Animation",s$d);var s$L=s$b.prototype;s$L.destroy=function(s$d){void 0===s$d&&(s$d=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,s$d),this._frames=null,this._labels=null},s$L.play=function(s$d,s$L,s$l,s$Z){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=!0),void 0===s$l&&(s$l=""),void 0===s$Z&&(s$Z=!0),s$l&&this._setFramesFromCache(s$l,s$Z),this._isPlaying=!0,this.index="string"==typeof s$d?this._getFrameByLabel(s$d):s$d,this.loop=s$L,this._actionName=s$l,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},s$L._setFramesFromCache=function(s$d,s$L){var s$l;return void 0===s$L&&(s$L=!1),this._url&&(s$d=this._url+"#"+s$d),s$d&&s$b.framesMap[s$d]?((s$l=s$b.framesMap[s$d])instanceof Array?(this._frames=s$b.framesMap[s$d],this._count=this._frames.length):(s$l.nodeRoot&&(s$b.framesMap[s$d]=this._parseGraphicAnimationByData(s$l),s$l=s$b.framesMap[s$d]),this._frames=s$l.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=s$l.interval),this._labels=this._copyLabels(s$l.labels)),!0):(s$L&&console.log("ani not found:",s$d),!1)},s$L._copyLabels=function(s$d){if(!s$d)return null;var s$L,s$l;for(s$l in s$L={},s$d)s$L[s$l]=s$f.copyArray([],s$d[s$l]);return s$L},s$L._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&s$d.prototype._frameLoop.call(this)},s$L._displayToIndex=function(s$d){this._frames&&(this.graphics=this._frames[s$d])},s$L.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},s$L.loadImages=function(s$d,s$L){return void 0===s$L&&(s$L=""),this._url="",this._setFramesFromCache(s$L)||(this.frames=s$b.framesMap[s$L]?s$b.framesMap[s$L]:s$b.createFrames(s$d,s$L)),this},s$L.loadAtlas=function(s$L,s$l,s$Z){void 0===s$Z&&(s$Z=""),this._url="";var s$h=this;function s$d(s$d){s$L===s$d&&(s$h.frames=s$b.framesMap[s$Z]?s$b.framesMap[s$Z]:s$b.createFrames(s$L,s$Z),s$l&&s$l.run())}return s$h._setFramesFromCache(s$Z)||(s$md.getAtlas(s$L)?s$d(s$L):s$$.loader.load(s$L,s$e.create(null,s$d,[s$L]),null,"atlas")),this},s$L.loadAnimation=function(s$d,s$L,s$l){this._url=s$d;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,s$L&&s$L.run()):!s$l||s$md.getAtlas(s$l)?this._loadAnimationData(s$d,s$L,s$l):s$$.loader.load(s$l,s$e.create(this,this._loadAnimationData,[s$d,s$L,s$l]),null,"atlas"),this},s$L._loadAnimationData=function(s$m,s$u,s$d){var s$x=this;if(!s$d||s$md.getAtlas(s$d)){var s$t=this;s$md.getRes(s$m)?s$L(s$m):s$$.loader.load(s$m,s$e.create(null,s$L,[s$m]),null,"json"),s$md.clearRes(s$m)}else console.warn("atlas load fail:"+s$d);function s$L(s$d){if(s$md.getRes(s$d)&&s$m===s$d){var s$L;if(s$b.framesMap[s$m+"#"])s$t._setFramesFromCache(s$x._actionName,!0),s$x.index=0,s$x._checkResumePlaying();else{var s$l=s$t._parseGraphicAnimation(s$md.getRes(s$m));if(!s$l)return;var s$Z,s$h=s$l.animationList,s$_=0,s$N=s$h.length;for(s$_=0;s$_<s$N;s$_++)s$L=s$h[s$_],s$b.framesMap[s$m+"#"+s$L.name]=s$L,s$Z||(s$Z=s$L);s$Z&&(s$b.framesMap[s$m+"#"]=s$Z,s$t._setFramesFromCache(s$x._actionName,!0),s$x.index=0),s$x._checkResumePlaying()}s$u&&s$u.run()}}},s$L._parseGraphicAnimation=function(s$d){return s$$d.parseAnimationData(s$d)},s$L._parseGraphicAnimationByData=function(s$d){return s$$d.parseAnimationByData(s$d)},s$c(0,s$L,"frames",function(){return this._frames},function(s$d){(this._frames=s$d)&&(this._count=s$d.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),s$c(0,s$L,"autoPlay",null,function(s$d){s$d?this.play():this.stop()}),s$c(0,s$L,"source",null,function(s$d){-1<s$d.indexOf(".ani")?this.loadAnimation(s$d):-1<s$d.indexOf(".json")||-1<s$d.indexOf("als")||-1<s$d.indexOf("atlas")?this.loadAtlas(s$d):this.loadImages(s$d.split(","))}),s$c(0,s$L,"autoAnimation",null,function(s$d){this.play(0,!0,s$d,!1)}),s$b.createFrames=function(s$d,s$L){var s$l,s$Z,s$h=0,s$_=0;if("string"==typeof s$d){var s$N=s$md.getAtlas(s$d);if(s$N&&s$N.length)for(s$l=[],s$h=0,s$_=s$N.length;s$h<s$_;s$h++)(s$Z=new s$F.createGraphics).drawTexture(s$md.getRes(s$N[s$h]),0,0),s$l.push(s$Z)}else if(s$d instanceof Array)for(s$l=[],s$h=0,s$_=s$d.length;s$h<s$_;s$h++)(s$Z=new s$F.createGraphics).loadImage(s$d[s$h],0,0),s$l.push(s$Z);return s$L&&(s$b.framesMap[s$L]=s$l),s$l},s$b.clearCache=function(s$d){var s$L,s$l=s$b.framesMap,s$Z=s$d+"#";for(s$L in s$l)s$L!==s$d&&0!=s$L.indexOf(s$Z)||delete s$b.framesMap[s$L]},s$b.framesMap={}}(s$rd),function(s$d){function s$_(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,s$_.__super.call(this),null==s$_._sortIndexFun&&(s$_._sortIndexFun=s$y.sortByKey("index",!1,!0))}s$t(s$_,"laya.display.FrameAnimation",s$d);var s$L=s$_.prototype;return s$L._setUp=function(s$d,s$L){this._labels=null,this._animationNewFrames=null,this._targetDic=s$d,this._animationData=s$L,this.interval=1e3/s$L.frameRate,s$L.parsed?(this._count=s$L.count,this._labels=s$L.labels,this._animationNewFrames=s$L.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),s$L.parsed=!0,s$L.labels=this._labels,s$L.count=this._count,s$L.animationNewFrames=this._animationNewFrames},s$L.clear=function(){s$d.prototype.clear.call(this),this._targetDic=null,this._animationData=null},s$L._displayToIndex=function(s$d){if(this._animationData){s$d<0&&(s$d=0),s$d>this._count&&(s$d=this._count);var s$L=this._animationData.nodes,s$l=0,s$Z=s$L.length;for(s$l=0;s$l<s$Z;s$l++)this._displayNodeToFrame(s$L[s$l],s$d)}},s$L._displayNodeToFrame=function(s$d,s$L,s$l){s$l||(s$l=this._targetDic);var s$Z=s$l[s$d.target];if(s$Z){var s$h,s$_,s$N,s$m=s$d.frames,s$u=s$d.keys,s$x=0,s$t=s$u.length;for(s$x=0;s$x<s$t;s$x++)s$N=(s$_=s$m[s$h=s$u[s$x]]).length>s$L?s$_[s$L]:s$_[s$_.length-1],s$Z[s$h]=s$N}},s$L._calculateDatas=function(){if(this._animationData){var s$d,s$L=this._animationData.nodes,s$l=0,s$Z=s$L.length;for(s$l=this._count=0;s$l<s$Z;s$l++)s$d=s$L[s$l],this._calculateNodeKeyFrames(s$d);this._count+=1}},s$L._calculateNodeKeyFrames=function(s$d){var s$L,s$l,s$Z=s$d.keyframes,s$h=s$d.target;for(s$L in s$d.frames||(s$d.frames={}),s$d.keys?s$d.keys.length=0:s$d.keys=[],s$d.initValues||(s$d.initValues={}),s$Z)s$l=s$Z[s$L],s$d.frames[s$L]||(s$d.frames[s$L]=[]),this._targetDic&&this._targetDic[s$h]&&(s$d.initValues[s$L]=this._targetDic[s$h][s$L]),s$l.sort(s$_._sortIndexFun),s$d.keys.push(s$L),this._calculateNodePropFrames(s$l,s$d.frames[s$L],s$L,s$h)},s$L.resetToInitState=function(){if(this._targetDic&&this._animationData){var s$d,s$L,s$l=this._animationData.nodes,s$Z=0,s$h=s$l.length;for(s$Z=0;s$Z<s$h;s$Z++)if(s$L=(s$d=s$l[s$Z]).initValues){var s$_,s$N=this._targetDic[s$d.target];if(s$N)for(s$_ in s$L)s$N[s$_]=s$L[s$_]}}},s$L._calculateNodePropFrames=function(s$d,s$L,s$l,s$Z){var s$h=0,s$_=s$d.length-1;if(0<s$_){for(s$L.length=s$d[s$_].index+1,s$h=0;s$h<s$_;s$h++)this._dealKeyFrame(s$d[s$h]),this._calculateFrameValues(s$d[s$h],s$d[s$h+1],s$L);this._dealKeyFrame(s$d[s$h])}0==s$_&&(s$L[s$d[0].index]=s$d[0].value,this._animationNewFrames&&(this._animationNewFrames[s$d[0].index]=!0))},s$L._dealKeyFrame=function(s$d){s$d.label&&""!=s$d.label&&this.addLabel(s$d.label,s$d.index)},s$L._calculateFrameValues=function(s$d,s$L,s$l){var s$Z,s$h=0,s$_=s$d.index,s$N=s$L.index,s$m=s$d.value,s$u=s$L.value-s$d.value,s$x=s$N-s$_;if(s$N>this._count&&(this._count=s$N),s$d.tween)for(null==(s$Z=s$z[s$d.tweenMethod])&&(s$Z=s$z.linearNone),s$h=s$_;s$h<s$N;s$h++)s$l[s$h]=s$Z(s$h-s$_,s$m,s$u,s$x),this._animationNewFrames&&(this._animationNewFrames[s$h]=!0);else for(s$h=s$_;s$h<s$N;s$h++)s$l[s$h]=s$m;this._animationNewFrames&&(this._animationNewFrames[s$d.index]=!0,this._animationNewFrames[s$L.index]=!0),s$l[s$L.index]=s$L.value},s$_._sortIndexFun=null,s$_}(s$rd)),s$Ad=function(s$L){function s$h(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",s$h.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=s$ad.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}s$t(s$h,"laya.display.Input",s$L);var s$d=s$h.prototype;return s$d.setSelection=function(s$d,s$L){this.focus=!0,laya.display.Input.inputElement.selectionStart=s$d,laya.display.Input.inputElement.selectionEnd=s$L},s$d._onUnDisplay=function(s$d){this.focus=!1},s$d._onMouseDown=function(s$d){this.focus=!0},s$d._syncInputTransform=function(){var s$d=this.nativeInput,s$L=s$f.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),s$l=this._width-this.padding[1]-this.padding[3],s$Z=this._height-this.padding[0]-this.padding[2];s$H.isConchApp?(s$d.setScale(s$L.scaleX,s$L.scaleY),s$d.setSize(s$l,s$Z),s$d.setPos(s$L.x,s$L.y)):(s$h.inputContainer.style.transform=s$h.inputContainer.style.webkitTransform="scale("+s$L.scaleX+","+s$L.scaleY+") rotate("+s$$.stage.canvasDegree+"deg)",s$d.style.width=s$l+"px",s$d.style.height=s$Z+"px",s$h.inputContainer.style.left=s$L.x+"px",s$h.inputContainer.style.top=s$L.y+"px")},s$d.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},s$d._setInputMethod=function(){s$h.input.parentElement&&s$h.inputContainer.removeChild(s$h.input),s$h.area.parentElement&&s$h.inputContainer.removeChild(s$h.area),s$h.inputElement=this._multiline?s$h.area:s$h.input,s$h.inputContainer.appendChild(s$h.inputElement),s$ad.RightToLeft&&(s$h.inputElement.style.direction="rtl")},s$d._focusIn=function(){laya.display.Input.isInputting=!0;var s$d=this.nativeInput;this._focus=!0;var s$L=s$d.style;s$L.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),s$d.readOnly=!this._editable,s$H.isConchApp&&(s$d.setType(this._type),s$d.setForbidEdit(!this._editable)),s$d.maxLength=this._maxChars;this.padding;if(s$d.type=this._type,s$d.value=this._content,s$d.placeholder=this._prompt,s$$.stage.off("keydown",this,this._onKeyDown),s$$.stage.on("keydown",this,this._onKeyDown),(s$$.stage.focus=this).event("focus"),s$i.onPC&&s$d.focus(),!s$i.onMiniGame){this._text;this._text=null}this.typeset(),s$d.setColor(this._originColor),s$d.setFontSize(this.fontSize),s$d.setFontFace(s$i.onIPhone&&s$ad._fontFamilyMap[this.font]||this.font),s$H.isConchApp&&s$d.setMultiAble&&s$d.setMultiAble(this._multiline),s$L.lineHeight=this.leading+this.fontSize+"px",s$L.fontStyle=this.italic?"italic":"normal",s$L.fontWeight=this.bold?"bold":"normal",s$L.textAlign=this.align,s$L.padding="0 0",this._syncInputTransform(),!s$H.isConchApp&&s$i.onPC&&s$$.timer.frameLoop(1,this,this._syncInputTransform)},s$d._setPromptColor=function(){(s$h.promptStyleDOM=s$i.getElementById("promptStyle"))||((s$h.promptStyleDOM=s$i.createElement("style")).setAttribute("id","promptStyle"),s$i.document.head.appendChild(s$h.promptStyleDOM)),s$h.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},s$d._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(s$$.superSet(s$ad,this,"text",this._content),s$$.superSet(s$ad,this,"color",this._originColor)):(s$$.superSet(s$ad,this,"text",this._prompt),s$$.superSet(s$ad,this,"color",this._promptColor)),s$$.stage.off("keydown",this,this._onKeyDown),s$$.stage.focus=null,this.event("blur"),s$H.isConchApp&&this.nativeInput.blur(),s$i.onPC&&s$$.timer.clear(this,this._syncInputTransform)},s$d._onKeyDown=function(s$d){13===s$d.keyCode&&(s$i.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},s$d.changeText=function(s$d){this._content=s$d,this._focus?(this.nativeInput.value=s$d||"",this.event("change")):s$L.prototype.changeText.call(this,s$d)},s$c(0,s$d,"color",s$L.prototype._$get_color,function(s$d){this._focus&&this.nativeInput.setColor(s$d),s$$.superSet(s$ad,this,"color",this._content?s$d:this._promptColor),this._originColor=s$d}),s$c(0,s$d,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(s$d){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),s$c(0,s$d,"multiline",function(){return this._multiline},function(s$d){this._multiline=s$d,this.valign=s$d?"top":"middle"}),s$c(0,s$d,"maxChars",function(){return this._maxChars},function(s$d){s$d<=0&&(s$d=1e5),this._maxChars=s$d}),s$c(0,s$d,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(s$d){s$$.superSet(s$ad,this,"color",this._originColor),s$d+="",this._focus?(this.nativeInput.value=s$d||"",this.event("change")):(this._multiline||(s$d=s$d.replace(/\r?\n/g,"")),(this._content=s$d)?s$$.superSet(s$ad,this,"text",s$d):(s$$.superSet(s$ad,this,"text",this._prompt),s$$.superSet(s$ad,this,"color",this.promptColor)))}),s$c(0,s$d,"nativeInput",function(){return this._multiline?s$h.area:s$h.input}),s$c(0,s$d,"prompt",function(){return this._prompt},function(s$d){!this._text&&s$d&&s$$.superSet(s$ad,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?s$$.superSet(s$ad,this,"text",this._text==this._prompt?s$d:this._text):s$$.superSet(s$ad,this,"text",s$d),this._prompt=s$ad.langPacks&&s$ad.langPacks[s$d]?s$ad.langPacks[s$d]:s$d}),s$c(0,s$d,"focus",function(){return this._focus},function(s$d){var s$L=this.nativeInput;this._focus!==s$d&&(s$d?(s$L.target?s$L.target._focusOut():this._setInputMethod(),(s$L.target=this)._focusIn()):(s$L.target=null,this._focusOut(),s$i.document.body.scrollTop=0,s$L.blur(),s$H.isConchApp?s$L.setPos(-1e4,-1e4):s$h.inputContainer.contains(s$L)&&s$h.inputContainer.removeChild(s$L)))}),s$c(0,s$d,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(s$d){s$d?(-1<(s$d="[^"+s$d+"]").indexOf("^^")&&(s$d=s$d.replace("^^","")),this._restrictPattern=new RegExp(s$d,"g")):this._restrictPattern=null}),s$c(0,s$d,"editable",function(){return this._editable},function(s$d){this._editable=s$d,s$H.isConchApp&&s$h.input.setForbidEdit(!s$d)}),s$c(0,s$d,"promptColor",function(){return this._promptColor},function(s$d){this._promptColor=s$d,this._content||s$$.superSet(s$ad,this,"color",s$d)}),s$c(0,s$d,"type",function(){return this._type},function(s$d){this._getCSSStyle().password="password"==s$d,this._type=s$d,s$H.isConchApp&&this.nativeInput.setType(s$d)}),s$c(0,s$d,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(s$d){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),s$c(0,s$d,"asPassword",function(){return this._getCSSStyle().password},function(s$d){this._getCSSStyle().password=s$d,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),s$h.__init__=function(){s$h._createInputElement(),s$i.onMobile&&s$H.canvas.addEventListener(s$h.IOS_IFRAME?s$i.onMiniGame?"touchend":"click":"touchend",s$h._popupInputMethod)},s$h._popupInputMethod=function(s$d){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},s$h._createInputElement=function(){s$h._initInput(s$h.area=s$i.createElement("textarea")),s$h._initInput(s$h.input=s$i.createElement("input")),(s$h.inputContainer=s$i.createElement("div")).style.position="absolute",s$h.inputContainer.style.zIndex=1e5,s$i.container.appendChild(s$h.inputContainer),s$h.inputContainer.setPos=function(s$d,s$L){s$h.inputContainer.style.left=s$d+"px",s$h.inputContainer.style.top=s$L+"px"}},s$h._initInput=function(s$L){var s$d=s$L.style;s$d.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",s$d.resize="none",s$d.backgroundColor="transparent",s$d.border="none",s$d.outline="none",s$d.zIndex=1,s$L.addEventListener("input",s$h._processInputting),s$L.addEventListener("mousemove",s$h._stopEvent),s$L.addEventListener("mousedown",s$h._stopEvent),s$L.addEventListener("touchmove",s$h._stopEvent),s$L.setFontFace=function(s$d){s$L.style.fontFamily=s$d},s$H.isConchApp||(s$L.setColor=function(s$d){s$L.style.color=s$d},s$L.setFontSize=function(s$d){s$L.style.fontSize=s$d+"px"})},s$h._processInputting=function(s$d){var s$L=laya.display.Input.inputElement.target;if(s$L){var s$l=laya.display.Input.inputElement.value;s$L._restrictPattern&&(s$l=s$l.replace(/\u2006|\x27/g,""),s$L._restrictPattern.test(s$l)&&(s$l=s$l.replace(s$L._restrictPattern,""),laya.display.Input.inputElement.value=s$l)),s$L._text=s$l,s$L.event("input")}},s$h._stopEvent=function(s$d){"touchmove"==s$d.type&&s$d.preventDefault(),s$d.stopPropagation&&s$d.stopPropagation()},s$h.TYPE_TEXT="text",s$h.TYPE_PASSWORD="password",s$h.TYPE_EMAIL="email",s$h.TYPE_URL="url",s$h.TYPE_NUMBER="number",s$h.TYPE_RANGE="range",s$h.TYPE_DATE="date",s$h.TYPE_MONTH="month",s$h.TYPE_WEEK="week",s$h.TYPE_TIME="time",s$h.TYPE_DATE_TIME="datetime",s$h.TYPE_DATE_TIME_LOCAL="datetime-local",s$h.TYPE_SEARCH="search",s$h.input=null,s$h.area=null,s$h.inputElement=null,s$h.inputContainer=null,s$h.confirmButton=null,s$h.promptStyleDOM=null,s$h.inputHeight=45,s$h.isInputting=!1,s$h.stageMatrix=null,s$u(s$h,["IOS_IFRAME",function(){return this.IOS_IFRAME=s$i.onIOS&&s$i.window.top!=s$i.window.self}]),s$h}(s$ad),s$yd=function(s$d){function s$l(s$d,s$L){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,s$l.__super.call(this),s$d&&this._init_(s$d,s$L)}s$t(s$l,"laya.resource.HTMLImage",s$ed);var s$L=s$l.prototype;return s$L._init_=function(s$d,s$L){this._src=s$d,this._source=new s$i.window.Image,s$L&&(s$L.onload&&(this.onload=s$L.onload),s$L.onerror&&(this.onerror=s$L.onerror),s$L.onCreate&&s$L.onCreate(this)),0!=s$d.indexOf("data:image")&&(this._source.crossOrigin=""),s$d&&(this._source.src=s$d)},s$L.recreateResource=function(){var s$d=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var s$L=this;this._source=new s$i.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(s$L._needReleaseAgain)return s$L._needReleaseAgain=!1,s$L._source.onload=null,void(s$L._source=null);s$L._source.onload=null,s$L.memorySize=s$d._w*s$d._h*4,s$L._recreateLock=!1,s$L.completeCreate()},this._source.src=this._src}},s$L.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},s$L.onresize=function(){this._w=this._source.width,this._h=this._source.height},s$c(0,s$L,"onload",null,function(s$d){var s$L=this;this._onload=s$d,this._source&&(this._source.onload=null!=this._onload?function(){s$L.onresize(),s$L._onload()}:null)}),s$c(0,s$L,"onerror",null,function(s$d){var s$L=this;this._onerror=s$d,this._source&&(this._source.onerror=null!=this._onerror?function(){s$L._onerror()}:null)}),s$c(0,s$L,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(s$d){this._enableMerageInAtlas=s$d,s$H.isConchApp&&this._source&&(this._source.enableMerageInAtlas=s$d)}),s$l.create=function(s$d,s$L){return new s$l(s$d,s$L)},s$l}(),s$$d=(function(s$_){function s$d(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,s$d.__super.call(this)}s$t(s$d,"laya.display.EffectAnimation",s$_);var s$L=s$d.prototype;s$L._onOtherBegin=function(s$d){s$d!=this&&this.stop()},s$L.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},s$L._onPlayAction=function(){this.play(0,!1)},s$L.play=function(s$d,s$L,s$l,s$Z){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=!0),void 0===s$l&&(s$l=""),void 0===s$Z&&(s$Z=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,s$d,s$L,s$l,s$Z))},s$L._recordInitData=function(){if(this._aniKeys){var s$d,s$L,s$l=0;for(s$d=this._aniKeys.length,s$l=0;s$l<s$d;s$l++)s$L=this._aniKeys[s$l],this._initData[s$L]=this._target[s$L]}},s$L._displayToIndex=function(s$d){if(this._animationData){s$d<0&&(s$d=0),s$d>this._count&&(s$d=this._count);var s$L=this._animationData.nodes,s$l=0,s$Z=s$L.length;for(s$Z=1<s$Z?1:s$Z,s$l=0;s$l<s$Z;s$l++)this._displayNodeToFrame(s$L[s$l],s$d)}},s$L._displayNodeToFrame=function(s$d,s$L,s$l){if(this._target){var s$Z;s$Z=this._target;var s$h,s$_,s$N,s$m,s$u=s$d.frames,s$x=s$d.keys,s$t=0,s$b=s$x.length;s$m=s$d.secondFrames;var s$q,s$Y,s$c,s$r,s$a=0;for(s$t=0;s$t<s$b;s$t++)s$_=s$u[s$h=s$x[s$t]],s$N=-1==(s$a=s$m[s$h])?this._initData[s$h]:s$L<s$a?(s$c=(s$Y=s$d.keyframes[s$h])[0]).tween?(null==(s$q=s$z[s$c.tweenMethod])&&(s$q=s$z.linearNone),s$r=s$Y[1],s$q(s$L,this._initData[s$h],s$r.value-this._initData[s$h],s$r.index)):this._initData[s$h]:s$_.length>s$L?s$_[s$L]:s$_[s$_.length-1],s$Z[s$h]=s$N}},s$L._calculateNodeKeyFrames=function(s$d){s$_.prototype._calculateNodeKeyFrames.call(this,s$d);var s$L,s$l,s$Z,s$h=s$d.keyframes;s$d.target;for(s$L in s$Z={},s$d.secondFrames=s$Z,s$h)(s$l=s$h[s$L]).length<=1?s$Z[s$L]=-1:s$Z[s$L]=s$l[1].index},s$c(0,s$L,"target",function(){return this._target},function(s$d){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=s$d,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),s$c(0,s$L,"playEvent",null,function(s$d){(this._playEvents=s$d)&&this.addEvent()}),s$c(0,s$L,"effectData",null,function(s$d){var s$L;s$d&&((s$L=s$d.animations)&&s$L[0]&&(this._setUp({},s$L[0]),s$L[0].nodes&&s$L[0].nodes[0]&&(this._aniKeys=s$L[0].nodes[0].keys)))}),s$c(0,s$L,"effectClass",null,function(s$d){var s$L,s$l;(this._effectClass=s$C.getClass(s$d),this._effectClass)&&((s$L=this._effectClass.uiView)&&(s$l=s$L.animations)&&s$l[0]&&(this._setUp({},s$l[0]),s$l[0].nodes&&s$l[0].nodes[0]&&(this._aniKeys=s$l[0].nodes[0].keys)))}),s$d.EffectAnimationBegin="effectanimationbegin"}(s$sd),function(s$L){var s$Q;function s$g(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,s$g.__super.call(this)}s$t(s$g,"laya.utils.GraphicAnimation",s$L);var s$d=s$g.prototype;return s$d._parseNodeList=function(s$d){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[s$d.compId]=s$d.props,s$d.compId&&this._nodeList.push(s$d.compId);var s$L=s$d.child;if(s$L){var s$l=0,s$Z=s$L.length;for(s$l=0;s$l<s$Z;s$l++)this._parseNodeList(s$L[s$l])}},s$d._calGraphicData=function(s$d){var s$L;if(this._setUp(null,s$d),this._createGraphicData(),this._nodeIDAniDic)for(s$L in this._nodeIDAniDic)this._nodeIDAniDic[s$L]=null},s$d._createGraphicData=function(){var s$d,s$L=[],s$l=0,s$Z=this.count,s$h=this._animationNewFrames;for(s$h||(s$h=[]),s$l=0;s$l<s$Z;s$l++)!s$h[s$l]&&s$d||(s$d=this._createFrameGraphic(s$l)),s$L.push(s$d);this._gList=s$L},s$d._createFrameGraphic=function(s$d){var s$L=s$F.createGraphics();return s$g._rootMatrix||(s$g._rootMatrix=new s$E),this._updateNodeGraphic(this._rootNode,s$d,s$g._rootMatrix,s$L),s$L},s$d._updateNodeGraphic=function(s$d,s$L,s$l,s$Z,s$h){var s$_;void 0===s$h&&(s$h=1);var s$N,s$m,s$u,s$x=(s$_=this._nodeGDic[s$d.compId]=this._getNodeGraphicData(s$d.compId,s$L,this._nodeGDic[s$d.compId])).alpha*s$h;if(!(s$x<.01)&&(s$_.resultTransform||(s$_.resultTransform=s$E.create()),s$N=s$_.resultTransform,s$E.mul(s$_.transform,s$l,s$N),s$_.skin&&(s$m=this._getTextureByUrl(s$_.skin))&&(s$N._checkTransform()?(s$Z.drawTexture(s$m,0,0,s$_.width,s$_.height,s$N,s$x),s$_.resultTransform=null):s$Z.drawTexture(s$m,s$N.tx,s$N.ty,s$_.width,s$_.height,null,s$x)),s$u=s$d.child)){var s$t,s$b=0;for(s$t=s$u.length,s$b=0;s$b<s$t;s$b++)this._updateNodeGraphic(s$u[s$b],s$L,s$N,s$Z,s$x)}},s$d._updateNoChilds=function(s$d,s$L){if(s$d.skin){var s$l=this._getTextureByUrl(s$d.skin);if(s$l){var s$Z=s$d.transform;s$Z._checkTransform();!s$Z.bTransform?s$L.drawTexture(s$l,s$Z.tx,s$Z.ty,s$d.width,s$d.height,null,s$d.alpha):s$L.drawTexture(s$l,0,0,s$d.width,s$d.height,s$Z.clone(),s$d.alpha)}}},s$d._updateNodeGraphic2=function(s$d,s$L,s$l){var s$Z;if(s$Z=this._nodeGDic[s$d.compId]=this._getNodeGraphicData(s$d.compId,s$L,this._nodeGDic[s$d.compId]),s$d.child){var s$h=s$Z.transform;s$h._checkTransform();var s$_,s$N;s$N=(s$_=!s$h.bTransform)&&(0!=s$h.tx||0!=s$h.ty);var s$m,s$u,s$x;if((s$m=s$h.bTransform||1!=s$Z.alpha)&&s$l.save(),1!=s$Z.alpha&&s$l.alpha(s$Z.alpha),s$_?s$N&&s$l.translate(s$h.tx,s$h.ty):s$l.transform(s$h.clone()),s$u=s$d.child,s$Z.skin&&(s$x=this._getTextureByUrl(s$Z.skin))&&s$l.drawTexture(s$x,0,0,s$Z.width,s$Z.height),s$u){var s$t,s$b=0;for(s$t=s$u.length,s$b=0;s$b<s$t;s$b++)this._updateNodeGraphic2(s$u[s$b],s$L,s$l)}s$m?s$l.restore():s$_?s$N&&s$l.translate(-s$h.tx,-s$h.ty):s$l.transform(s$h.clone().invert())}else this._updateNoChilds(s$Z,s$l)},s$d._calculateNodeKeyFrames=function(s$d){s$L.prototype._calculateNodeKeyFrames.call(this,s$d),this._nodeIDAniDic[s$d.target]=s$d},s$d.getNodeDataByID=function(s$d){return this._nodeIDAniDic[s$d]},s$d._getParams=function(s$d,s$L,s$l,s$Z){var s$h=s$g._temParam;s$h.length=s$L.length;var s$_=0,s$N=s$L.length;for(s$_=0;s$_<s$N;s$_++)s$h[s$_]=this._getObjVar(s$d,s$L[s$_][0],s$l,s$L[s$_][1],s$Z);return s$h},s$d._getObjVar=function(s$d,s$L,s$l,s$Z,s$h){if(s$d.hasOwnProperty(s$L)){var s$_=s$d[s$L];if(s$l>=s$_.length&&(s$l=s$_.length-1),null!=s$d[s$L][s$l])return s$d[s$L][s$l]}return s$h.hasOwnProperty(s$L)?s$h[s$L]:s$Z},s$d._getNodeGraphicData=function(s$d,s$L,s$l){s$l||(s$l=s$Q.create()),s$l.transform?s$l.transform.identity():s$l.transform=s$E.create();var s$Z=this.getNodeDataByID(s$d);if(!s$Z)return s$l;var s$h,s$_,s$N=s$Z.frames,s$m=this._getParams(s$N,s$g._drawTextureCmd,s$L,this._nodeDefaultProps[s$d]),s$u=s$m[0],s$x=NaN,s$t=NaN,s$b=s$m[5],s$q=s$m[6],s$Y=s$m[13],s$c=s$m[14],s$r=s$m[7],s$a=s$m[8],s$k=s$m[9],s$e=s$m[11],s$w=s$m[12];s$x=s$m[3],s$t=s$m[4],0!=s$x&&0!=s$t||(s$u=null),-1==s$x&&(s$x=0),-1==s$t&&(s$t=0),s$l.skin=s$u,s$l.width=s$x,s$l.height=s$t,s$u&&((s$h=this._getTextureByUrl(s$u))?(s$x||(s$x=s$h.sourceWidth),s$t||(s$t=s$h.sourceHeight)):console.warn("lost skin:",s$u,",you may load pics first")),s$l.alpha=s$m[10],s$_=s$l.transform,0!=s$Y&&(s$b=s$Y*s$x),0!=s$c&&(s$q=s$c*s$t),0==s$b&&0==s$q||s$_.translate(-s$b,-s$q);var s$s=null;if(s$k||1!==s$r||1!==s$a||s$e||s$w){(s$s=s$g._tempMt).identity(),s$s.bTransform=!0;var s$A=.0174532922222222*(s$k-s$e),s$y=.0174532922222222*(s$k+s$w),s$$=Math.cos(s$y),s$O=Math.sin(s$y),s$n=Math.sin(s$A),s$V=Math.cos(s$A);s$s.a=s$r*s$$,s$s.b=s$r*s$O,s$s.c=-s$a*s$n,s$s.d=s$a*s$V,s$s.tx=s$s.ty=0}return s$s&&(s$_=s$E.mul(s$_,s$s,s$_)),s$_.translate(s$m[1],s$m[2]),s$l},s$d._getTextureByUrl=function(s$d){return s$md.getRes(s$d)},s$d.setAniData=function(s$d,s$L){if(s$d.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=s$d,this._parseNodeList(s$d);var s$l,s$Z={},s$h=[],s$_=s$d.animations,s$N=0,s$m=s$_.length;for(s$N=0;s$N<s$m;s$N++)if(s$l=s$_[s$N],this._labels=null,(!s$L||s$L==s$l.name)&&s$l){try{this._calGraphicData(s$l)}catch(s$d){console.warn("parse animation fail:"+s$l.name+",empty animation created"),this._gList=[]}var s$u={};s$u.interval=1e3/s$l.frameRate,s$u.frames=this._gList,s$u.labels=this._labels,s$u.name=s$l.name,s$h.push(s$u),s$Z[s$l.name]=s$u}this.animationList=s$h,this.animationDic=s$Z}s$g._temParam.length=0},s$d.parseByData=function(s$d){var s$L,s$l;s$L=s$d.nodeRoot,s$l=s$d.aniO,delete s$d.nodeRoot,delete s$d.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=s$L,this._parseNodeList(s$L),this._labels=null;try{this._calGraphicData(s$l)}catch(s$d){console.warn("parse animation fail:"+s$l.name+",empty animation created"),this._gList=[]}var s$Z=s$d;return s$Z.interval=1e3/s$l.frameRate,s$Z.frames=this._gList,s$Z.labels=this._labels,s$Z.name=s$l.name,s$Z},s$d.setUpAniData=function(s$d){if(s$d.animations){var s$L,s$l={},s$Z=[],s$h=s$d.animations,s$_=0,s$N=s$h.length;for(s$_=0;s$_<s$N;s$_++)if(s$L=s$h[s$_]){var s$m={};s$m.name=s$L.name,s$m.aniO=s$L,s$m.nodeRoot=s$d,s$Z.push(s$m),s$l[s$L.name]=s$m}this.animationList=s$Z,this.animationDic=s$l}},s$d._clear=function(){var s$d,s$L;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(s$d in this._nodeGDic)(s$L=this._nodeGDic[s$d])&&s$L.recover();this._nodeGDic=null},s$g.parseAnimationByData=function(s$d){var s$L;return s$g._I||(s$g._I=new s$g),s$L=s$g._I.parseByData(s$d),s$g._I._clear(),s$L},s$g.parseAnimationData=function(s$d){var s$L;return s$g._I||(s$g._I=new s$g),s$g._I.setUpAniData(s$d),(s$L={}).animationList=s$g._I.animationList,s$L.animationDic=s$g._I.animationDic,s$g._I._clear(),s$L},s$g._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],s$g._temParam=[],s$g._I=null,s$g._rootMatrix=null,s$u(s$g,["_tempMt",function(){return this._tempMt=new s$E}]),s$g.__init$=function(){s$Q=function(){function s$d(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return s$t(s$d,""),s$d.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),s$G.recover("GraphicNode",this)},s$d.create=function(){return s$G.getItemByClass("GraphicNode",s$d)},s$d}()},s$g}(s$sd));s$$.__init([s$x,s$ud,s$H,s$i,s$v,s$V,s$d,s$$d])}(window,document,Laya),function(s$d,s$L,s$l){s$l.un,s$l.uns,s$l.static;var s$Z=s$l.class;s$l.getset,s$l.__newvec;new(function(){function s$d(){}return s$Z(s$d,"LayaMain"),s$d}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}}),function(s$d,s$L,s$y){s$y.un,s$y.uns;var s$N=s$y.static,s$q=s$y.class,s$Z=s$y.getset,s$_=s$y.__newvec,s$t=laya.maths.Arith,s$b=laya.maths.Bezier,s$l=laya.resource.Bitmap,s$Y=laya.utils.Browser,s$u=laya.utils.Byte,s$c=laya.utils.Color,s$$=(laya.filters.ColorFilter,s$y.Config),s$h=laya.resource.Context,s$O=(laya.events.Event,laya.filters.Filter),s$m=laya.display.Graphics,s$x=laya.resource.HTMLCanvas,s$r=(laya.utils.HTMLChar,laya.resource.HTMLImage),s$a=laya.resource.HTMLSubImage,s$n=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),s$V=laya.maths.Point,s$Q=laya.maths.Rectangle,s$k=laya.renders.Render,s$e=(laya.renders.RenderContext,laya.renders.RenderSprite),s$w=laya.resource.Resource,s$s=laya.resource.ResourceManager,s$A=laya.utils.RunDriver,s$g=laya.display.Sprite,s$F=laya.display.Stage,s$E=laya.utils.Stat,s$I=laya.utils.StringKey,s$p=(laya.display.css.Style,laya.system.System),s$H=laya.display.Text,s$X=laya.resource.Texture,s$j=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),s$R=laya.utils.VectorGraphManager;laya.utils.WordText;s$y.interface("laya.webgl.shapes.IShape"),s$y.interface("laya.webgl.submit.ISubmit"),s$y.interface("laya.webgl.text.ICharSegment"),s$y.interface("laya.webgl.canvas.save.ISaveData"),s$y.interface("laya.webgl.resource.IMergeAtlasBitmap"),s$y.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var s$o=function(){function s$d(){}s$q(s$d,"laya.filters.webgl.FilterActionGL");var s$L=s$d.prototype;return s$y.imps(s$L,{"laya.filters.IFilterActionGL":!0}),s$L.setValue=function(s$d){},s$L.setValueMix=function(s$d){},s$L.apply3d=function(s$d,s$L,s$l,s$Z,s$h){return null},s$L.apply=function(s$d){return null},s$Z(0,s$L,"typeMix",function(){return 0}),s$d}(),s$i=function(){function s$d(){}return s$q(s$d,"laya.webgl.shader.ShaderValue"),s$d}(),s$S=function(){var s$Z,s$h;function s$d(s$d,s$L,s$l){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new s$h,void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),this._cells=null,this._rowInfo=null,this._init(s$d,s$L),this._atlasID=s$l}s$q(s$d,"laya.webgl.atlas.AtlasGrid");var s$L=s$d.prototype;return s$L.getAltasID=function(){return this._atlasID},s$L.setAltasID=function(s$d){0<=s$d&&(this._atlasID=s$d)},s$L.addTex=function(s$d,s$L,s$l){var s$Z=this._get(s$L,s$l);return 0==s$Z.ret||(this._fill(s$Z.x,s$Z.y,s$L,s$l,s$d),this._texCount++),s$Z},s$L._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},s$L._init=function(s$d,s$L){if(this._width=s$d,this._height=s$L,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=s$_(this._height);for(var s$l=0;s$l<this._height;s$l++)this._rowInfo[s$l]=new s$Z;return this._clear(),!0},s$L._get=function(s$d,s$L){var s$l=new s$C;if(s$d>=this._failSize.width&&s$L>=this._failSize.height)return s$l;for(var s$Z=-1,s$h=-1,s$_=this._width,s$N=this._height,s$m=this._cells,s$u=0;s$u<s$N;s$u++)if(!(this._rowInfo[s$u].spaceCount<s$d))for(var s$x=0;s$x<s$_;){var s$t=3*(s$u*s$_+s$x);if(0!=s$m[s$t]||s$m[1+s$t]<s$d||s$m[2+s$t]<s$L)s$x+=s$m[1+s$t];else{s$Z=s$x,s$h=s$u;for(var s$b=0;s$b<s$d;s$b++)if(s$m[3*s$b+s$t+2]<s$L){s$Z=-1;break}if(!(s$Z<0))return s$l.ret=!0,s$l.x=s$Z,s$l.y=s$h,s$l;s$x+=s$m[1+s$t]}}return s$l},s$L._fill=function(s$d,s$L,s$l,s$Z,s$h){var s$_=this._width,s$N=this._height;this._check(s$d+s$l<=s$_&&s$L+s$Z<=s$N);for(var s$m=s$L;s$m<s$Z+s$L;++s$m){this._check(this._rowInfo[s$m].spaceCount>=s$l),this._rowInfo[s$m].spaceCount-=s$l;for(var s$u=0;s$u<s$l;s$u++){var s$x=3*(s$d+s$m*s$_+s$u);this._check(0==this._cells[s$x]),this._cells[s$x]=s$h,this._cells[1+s$x]=s$l,this._cells[2+s$x]=s$Z}}if(0<s$d)for(s$m=0;s$m<s$Z;++s$m){var s$t=0;for(s$u=s$d-1;0<=s$u&&0==this._cells[3*((s$L+s$m)*s$_+s$u)];--s$u,++s$t);for(s$u=s$t;0<s$u;--s$u)this._cells[3*((s$L+s$m)*s$_+s$d-s$u)+1]=s$u,this._check(0<s$u)}if(0<s$L)for(s$u=s$d;s$u<s$d+s$l;++s$u){for(s$t=0,s$m=s$L-1;0<=s$m&&0==this._cells[3*(s$u+s$m*s$_)];--s$m,s$t++);for(s$m=s$t;0<s$m;--s$m)this._cells[3*(s$u+(s$L-s$m)*s$_)+2]=s$m,this._check(0<s$m)}},s$L._check=function(s$d){0==s$d&&console.log("xtexMerger 错误啦")},s$L._clear=function(){for(var s$d=this._texCount=0;s$d<this._height;s$d++)this._rowInfo[s$d].spaceCount=this._width;for(var s$L=0;s$L<this._height;s$L++)for(var s$l=0;s$l<this._width;s$l++){var s$Z=3*(s$L*this._width+s$l);this._cells[s$Z]=0,this._cells[1+s$Z]=this._width-s$l,this._cells[2+s$Z]=this._width-s$L}this._failSize.width=this._width+1,this._failSize.height=this._height+1},s$d.__init$=function(){s$Z=function(){function s$d(){this.spaceCount=0}return s$q(s$d,""),s$d}(),s$h=function(){function s$d(){this.width=0,this.height=0}return s$q(s$d,""),s$d}()},s$d}(),s$B=function(){function s$k(s$d,s$L,s$l,s$Z){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=s$d,this._height=s$L,this._gridSize=s$l,this._maxAtlaserCount=s$Z,this._gridNumX=s$d/s$l,this._gridNumY=s$L/s$l,this._curAtlasIndex=0,this._atlaserArray=[]}s$q(s$k,"laya.webgl.atlas.AtlasResourceManager");var s$d=s$k.prototype;return s$d.setAtlasParam=function(s$d,s$L,s$l,s$Z){if(1==this._setAtlasParam)return s$k._sid_=0,this._width=s$d,this._height=s$L,this._gridSize=s$l,this._maxAtlaserCount=s$Z,this._gridNumX=s$d/s$l,this._gridNumY=s$L/s$l,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},s$d.pushData=function(s$d){var s$L,s$l=s$d.bitmap,s$Z=-1,s$h=null,s$_=0,s$N=0;for(s$_=0,s$L=this._atlaserArray.length;s$_<s$L&&(s$N=(this._curAtlasIndex+s$_)%s$L,-1==(s$Z=(s$h=this._atlaserArray[s$N]).findBitmapIsExist(s$l)));s$_++);if(-1!=s$Z){var s$m=s$h.InAtlasWebGLImagesOffsetValue[s$Z];return s$c=s$m[0],s$r=s$m[1],s$h.addToAtlas(s$d,s$c,s$r),!0}this._setAtlasParam=!1;for(var s$u=Math.ceil((s$d.bitmap.width+2)/this._gridSize),s$x=Math.ceil((s$d.bitmap.height+2)/this._gridSize),s$t=!1,s$b=0;s$b<2;s$b++){var s$q=this._maxAtlaserCount;for(s$_=0;s$_<s$q;s$_++){s$N=(this._curAtlasIndex+s$_)%s$q,this._atlaserArray.length-1>=s$N||this._atlaserArray.push(new s$Qd(this._gridNumX,this._gridNumY,this._width,this._height,s$k._sid_++));var s$Y=this._atlaserArray[s$N],s$c=0,s$r=0,s$a=s$Y.addTex(1,s$u,s$x);if(s$a.ret){s$c=s$a.x*this._gridSize+1,s$r=s$a.y*this._gridSize+1,s$l.lock=!0,s$Y.addToAtlasTexture(s$l,s$c,s$r),s$Y.addToAtlas(s$d,s$c,s$r),s$t=!0,this._curAtlasIndex=s$N;break}}if(s$t)break;this._atlaserArray.push(new s$Qd(this._gridNumX,this._gridNumY,this._width,this._height,s$k._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return s$t||console.log(">>>AtlasManager pushData error"),s$t},s$d.addToAtlas=function(s$d){laya.webgl.atlas.AtlasResourceManager.instance.pushData(s$d)},s$d.garbageCollection=function(){if(!0===this._needGC){for(var s$d=this._atlaserArray.length-this._maxAtlaserCount,s$L=0;s$L<s$d;s$L++)this._atlaserArray[s$L].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+s$d),this._atlaserArray.splice(0,s$d),this._needGC=!1}return!0},s$d.freeAll=function(){for(var s$d=0,s$L=this._atlaserArray.length;s$d<s$L;s$d++)this._atlaserArray[s$d].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},s$d.getAtlaserCount=function(){return this._atlaserArray.length},s$d.getAtlaserByIndex=function(s$d){return this._atlaserArray[s$d]},s$Z(1,s$k,"instance",function(){return s$k._Instance||(s$k._Instance=new s$k(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),s$k._Instance}),s$Z(1,s$k,"enabled",function(){return s$$.atlasEnable}),s$Z(1,s$k,"atlasLimitWidth",function(){return s$k._atlasLimitWidth},function(s$d){s$k._atlasLimitWidth=s$d}),s$Z(1,s$k,"atlasLimitHeight",function(){return s$k._atlasLimitHeight},function(s$d){s$k._atlasLimitHeight=s$d}),s$k._enable=function(){s$$.atlasEnable=!0},s$k._disable=function(){s$$.atlasEnable=!1},s$k.__init__=function(){s$k.atlasTextureWidth=2048,s$k.atlasTextureHeight=2048,s$k.maxTextureCount=6,s$k.atlasLimitWidth=512,s$k.atlasLimitHeight=512},s$k._atlasLimitWidth=0,s$k._atlasLimitHeight=0,s$k.gridSize=16,s$k.atlasTextureWidth=0,s$k.atlasTextureHeight=0,s$k.maxTextureCount=0,s$k._atlasRestore=0,s$k.BOARDER_TYPE_NO=0,s$k.BOARDER_TYPE_RIGHT=1,s$k.BOARDER_TYPE_LEFT=2,s$k.BOARDER_TYPE_BOTTOM=4,s$k.BOARDER_TYPE_TOP=8,s$k.BOARDER_TYPE_ALL=15,s$k._sid_=0,s$k._Instance=null,s$k}(),s$C=function(){function s$d(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return s$q(s$d,"laya.webgl.atlas.MergeFillInfo"),s$d}(),s$P=function(){function s$L(){}return s$q(s$L,"laya.webgl.canvas.BlendMode"),s$L._init_=function(s$d){s$L.fns=[s$L.BlendNormal,s$L.BlendAdd,s$L.BlendMultiply,s$L.BlendScreen,s$L.BlendOverlay,s$L.BlendLight,s$L.BlendMask,s$L.BlendDestinationOut],s$L.targetFns=[s$L.BlendNormalTarget,s$L.BlendAddTarget,s$L.BlendMultiplyTarget,s$L.BlendScreenTarget,s$L.BlendOverlayTarget,s$L.BlendLightTarget,s$L.BlendMask,s$L.BlendDestinationOut]},s$L.BlendNormal=function(s$d){s$d.blendFunc(1,771)},s$L.BlendAdd=function(s$d){s$d.blendFunc(1,772)},s$L.BlendMultiply=function(s$d){s$d.blendFunc(774,771)},s$L.BlendScreen=function(s$d){s$d.blendFunc(1,1)},s$L.BlendOverlay=function(s$d){s$d.blendFunc(1,769)},s$L.BlendLight=function(s$d){s$d.blendFunc(1,1)},s$L.BlendNormalTarget=function(s$d){s$d.blendFunc(1,771)},s$L.BlendAddTarget=function(s$d){s$d.blendFunc(1,772)},s$L.BlendMultiplyTarget=function(s$d){s$d.blendFunc(774,771)},s$L.BlendScreenTarget=function(s$d){s$d.blendFunc(1,1)},s$L.BlendOverlayTarget=function(s$d){s$d.blendFunc(1,769)},s$L.BlendLightTarget=function(s$d){s$d.blendFunc(1,1)},s$L.BlendMask=function(s$d){s$d.blendFunc(0,770)},s$L.BlendDestinationOut=function(s$d){s$d.blendFunc(0,0)},s$L.activeBlendFunction=null,s$L.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],s$L.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},s$L.NORMAL="normal",s$L.ADD="add",s$L.MULTIPLY="multiply",s$L.SCREEN="screen",s$L.LIGHT="light",s$L.OVERLAY="overlay",s$L.DESTINATIONOUT="destination-out",s$L.fns=[],s$L.targetFns=[],s$L}(),s$T=function(){function s$l(s$d){this._color=s$c.create("black"),this.setValue(s$d)}s$q(s$l,"laya.webgl.canvas.DrawStyle");var s$d=s$l.prototype;return s$d.setValue=function(s$d){if(s$d){if("string"==typeof s$d)return void(this._color=s$c.create(s$d));if(s$d instanceof laya.utils.Color)return void(this._color=s$d)}},s$d.reset=function(){this._color=s$c.create("black")},s$d.equal=function(s$d){return"string"==typeof s$d?this._color.strColor===s$d:s$d instanceof laya.utils.Color&&this._color.numColor===s$d.numColor},s$d.toColorStr=function(){return this._color.strColor},s$l.create=function(s$d){var s$L;if(s$d&&("string"==typeof s$d?s$L=s$c.create(s$d):s$d instanceof laya.utils.Color&&(s$L=s$d),s$L))return s$L._drawStyle||(s$L._drawStyle=new s$l(s$d));return laya.webgl.canvas.DrawStyle.DEFAULT},s$N(s$l,["DEFAULT",function(){return this.DEFAULT=new s$l("#000000")}]),s$l}(),s$z=function(){function s$d(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];s$sd.mainContext;this.ib=s$Wd.create(35048),this.vb=s$Md.create(5)}s$q(s$d,"laya.webgl.canvas.Path");var s$L=s$d.prototype;return s$L.addPoint=function(s$d,s$L){this.tempArray.push(s$d,s$L)},s$L.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},s$L.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},s$L.polygon=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N;return this.geomatrys.push(this._curGeomatry=s$N=new s$Id(s$d,s$L,s$l,s$Z,s$h,s$_)),s$Z||(s$N.fill=!1),null==s$_&&(s$N.borderWidth=0),s$N},s$L.setGeomtry=function(s$d){this.geomatrys.push(this._curGeomatry=s$d)},s$L.drawLine=function(s$d,s$L,s$l,s$Z,s$h){var s$_;return this.closePath?this.geomatrys.push(this._curGeomatry=s$_=new s$Ed(s$d,s$L,s$l,s$Z,s$h)):this.geomatrys.push(this._curGeomatry=s$_=new s$Fd(s$d,s$L,s$l,s$Z,s$h)),s$_.fill=!1,s$_},s$L.update=function(){var s$d=this.ib._byteLength,s$L=this.geomatrys.length;this.offset=s$d;for(var s$l=this.geoStart;s$l<s$L;s$l++)this.geomatrys[s$l].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=s$L,this.count=(this.ib._byteLength-s$d)/s$rd.BYTES_PIDX},s$L.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},s$L.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},s$d}(),s$D=function(){function s$m(){}s$q(s$m,"laya.webgl.canvas.save.SaveBase");var s$d=s$m.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!1},s$d.restore=function(s$d){this._dataObj[this._valueName]=this._value,(s$m._cache[s$m._cache._length++]=this)._newSubmit&&(s$d._curSubmit=s$_d.RENDERBASE,s$d._renderKey=0)},s$m._createArray=function(){var s$d=[];return s$d._length=0,s$d},s$m._init=function(){var s$d=s$m._namemap={};return s$d[1]="ALPHA",s$d[2]="fillStyle",s$d[8]="font",s$d[256]="lineWidth",s$d[512]="strokeStyle",s$d[8192]="_mergeID",s$d[1024]=s$d[2048]=s$d[4096]=[],s$d[16384]="textBaseline",s$d[32768]="textAlign",s$d[65536]="_nBlendType",s$d[1048576]="shader",s$d[2097152]="filters",s$d},s$m.save=function(s$d,s$L,s$l,s$Z){if((s$d._saveMark._saveuse&s$L)!==s$L){s$d._saveMark._saveuse|=s$L;var s$h=s$m._cache,s$_=0<s$h._length?s$h[--s$h._length]:new s$m;s$_._value=s$l[s$_._valueName=s$m._namemap[s$L]],s$_._dataObj=s$l,s$_._newSubmit=s$Z;var s$N=s$d._save;s$N[s$N._length++]=s$_}},s$m._cache=laya.webgl.canvas.save.SaveBase._createArray(),s$m._namemap=s$m._init(),s$m}(),s$G=function(){function s$_(){this._clipRect=new s$Q}s$q(s$_,"laya.webgl.canvas.save.SaveClipRect");var s$d=s$_.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!1},s$d.restore=function(s$d){s$d._clipRect=this._clipSaveRect,(s$_._cache[s$_._cache._length++]=this)._submitScissor.submitLength=s$d._submits._length-this._submitScissor.submitIndex,s$d._curSubmit=s$_d.RENDERBASE,s$d._renderKey=0},s$_.save=function(s$d,s$L){if(131072!=(131072&s$d._saveMark._saveuse)){s$d._saveMark._saveuse|=131072;var s$l=s$_._cache,s$Z=0<s$l._length?s$l[--s$l._length]:new s$_;s$Z._clipSaveRect=s$d._clipRect,s$d._clipRect=s$Z._clipRect.copyFrom(s$d._clipRect),s$Z._submitScissor=s$L;var s$h=s$d._save;s$h[s$h._length++]=s$Z}},s$N(s$_,["_cache",function(){return this._cache=s$D._createArray()}]),s$_}(),s$K=function(){function s$Y(){this._contextX=0,this._contextY=0,this._clipRect=new s$Q,this._rect=new s$Q,this._matrix=new s$n}s$q(s$Y,"laya.webgl.canvas.save.SaveClipRectStencil");var s$d=s$Y.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!1},s$d.restore=function(s$d){s$td.restore(s$d,this._rect,this._saveMatrix,this._contextX,this._contextY),s$d._clipRect=this._clipSaveRect,s$d._curMat=this._saveMatrix,s$d._x=this._contextX,s$d._y=this._contextY,s$Y._cache[s$Y._cache._length++]=this,s$d._curSubmit=s$_d.RENDERBASE},s$Y.save=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){if(262144!=(262144&s$d._saveMark._saveuse)){s$d._saveMark._saveuse|=262144;var s$t=s$Y._cache,s$b=0<s$t._length?s$t[--s$t._length]:new s$Y;s$b._clipSaveRect=s$d._clipRect,s$b._clipRect.setTo(s$N,s$m,s$u,s$x),s$d._clipRect=s$b._clipRect,s$b._rect.x=s$l,s$b._rect.y=s$Z,s$b._rect.width=s$h,s$b._rect.height=s$_,s$b._contextX=s$d._x,s$b._contextY=s$d._y,s$b._saveMatrix=s$d._curMat,s$d._curMat.copyTo(s$b._matrix),s$d._curMat=s$b._matrix,s$b._submitStencil=s$L;var s$q=s$d._save;s$q[s$q._length++]=s$b}},s$N(s$Y,["_cache",function(){return this._cache=s$D._createArray()}]),s$Y}(),s$v=function(){function s$Z(){this._saveuse=0}s$q(s$Z,"laya.webgl.canvas.save.SaveMark");var s$d=s$Z.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!0},s$d.restore=function(s$d){s$d._saveMark=this._preSaveMark,s$Z._no[s$Z._no._length++]=this},s$Z.Create=function(s$d){var s$L=s$Z._no,s$l=0<s$L._length?s$L[--s$L._length]:new s$Z;return s$l._saveuse=0,s$l._preSaveMark=s$d._saveMark,s$d._saveMark=s$l},s$N(s$Z,["_no",function(){return this._no=s$D._createArray()}]),s$Z}(),s$J=function(){function s$_(){this._matrix=new s$n}s$q(s$_,"laya.webgl.canvas.save.SaveTransform");var s$d=s$_.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!1},s$d.restore=function(s$d){s$d._curMat=this._savematrix,s$_._no[s$_._no._length++]=this},s$_.save=function(s$d){var s$L=s$d._saveMark;if(2048!=(2048&s$L._saveuse)){s$L._saveuse|=2048;var s$l=s$_._no,s$Z=0<s$l._length?s$l[--s$l._length]:new s$_;s$Z._savematrix=s$d._curMat,s$d._curMat=s$d._curMat.copyTo(s$Z._matrix);var s$h=s$d._save;s$h[s$h._length++]=s$Z}},s$N(s$_,["_no",function(){return this._no=s$D._createArray()}]),s$_}(),s$f=function(){function s$h(){}s$q(s$h,"laya.webgl.canvas.save.SaveTranslate");var s$d=s$h.prototype;return s$y.imps(s$d,{"laya.webgl.canvas.save.ISaveData":!0}),s$d.isSaveMark=function(){return!1},s$d.restore=function(s$d){s$d._curMat;s$d._x=this._x,s$d._y=this._y,s$h._no[s$h._no._length++]=this},s$h.save=function(s$d){var s$L=s$h._no,s$l=0<s$L._length?s$L[--s$L._length]:new s$h;s$l._x=s$d._x,s$l._y=s$d._y;var s$Z=s$d._save;s$Z[s$Z._length++]=s$l},s$N(s$h,["_no",function(){return this._no=s$D._createArray()}]),s$h}(),s$U=function(){function s$d(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new s$Q}s$q(s$d,"laya.webgl.resource.RenderTargetMAX");var s$L=s$d.prototype;return s$L.setSP=function(s$d){this._sp=s$d},s$L.size=function(s$d,s$L){var s$l=this;this._width!==s$d||this._height!==s$L?(this.repaint=!0,this._width=s$d,this._height=s$L,this.target?this.target.size(s$d,s$L):this.target=s$Rd.create(s$d,s$L),this.target.hasListener("recovered")||this.target.on("recovered",this,function(s$d){s$y.timer.callLater(s$l._sp,s$l._sp.repaint)})):this.target.size(s$d,s$L)},s$L._flushToTarget=function(s$d,s$L){if(!s$L._destroy){var s$l=s$ed.worldScissorTest,s$Z=s$ed.worldClipRect;s$ed.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,s$ed.worldScissorTest=!1,s$sd.mainContext.disable(3089);var s$h=s$ed.worldAlpha,s$_=s$ed.worldMatrix4,s$N=s$ed.worldMatrix,s$m=s$ed.worldFilters,s$u=s$ed.worldShaderDefines;if(s$ed.worldMatrix=s$n.EMPTY,s$ed.restoreTempArray(),s$ed.worldMatrix4=s$ed.TEMPMAT4_ARRAY,s$ed.worldAlpha=1,s$ed.worldFilters=null,s$ed.worldShaderDefines=null,s$jd.activeShader=null,s$L.start(),s$$.showCanvasMark?s$L.clear(0,1,0,.3):s$L.clear(0,0,0,0),s$d.flush(),s$L.end(),s$jd.activeShader=null,s$ed.worldAlpha=s$h,s$ed.worldMatrix4=s$_,s$ed.worldMatrix=s$N,s$ed.worldFilters=s$m,s$ed.worldShaderDefines=s$u,s$ed.worldScissorTest=s$l){var s$x=s$ed.height-s$Z.y-s$Z.height;s$sd.mainContext.scissor(s$Z.x,s$x,s$Z.width,s$Z.height),s$sd.mainContext.enable(3089)}s$ed.worldClipRect=s$Z}},s$L.flush=function(s$d){this.repaint&&(this._flushToTarget(s$d,this.target),this.repaint=!1)},s$L.drawTo=function(s$d,s$L,s$l,s$Z,s$h){s$d.drawTexture(this.target.getTexture(),s$L,s$l,s$Z,s$h,0,0)},s$L.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},s$d}(),s$W=function(){function s$d(){this.ALPHA=1,this.shaderType=0,this.defines=new s$gd}return s$q(s$d,"laya.webgl.shader.d2.Shader2D"),s$d.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},s$d.__init__=function(){var s$d,s$L;s$vd.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),s$vd.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),s$vd.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),s$vd.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),s$vd.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),s$vd.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),s$vd.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),s$vd.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),s$d="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",s$L='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',s$vd.preCompile2D(0,1,s$d,s$L,null),s$d="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",s$L='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',s$vd.preCompile2D(0,2,s$d,s$L,null),s$d="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",s$L="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",s$vd.preCompile2D(0,4,s$d,s$L,null),s$d="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",s$L='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',s$vd.preCompile2D(0,256,s$d,s$L,null),s$d="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",s$L="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",s$vd.preCompile2D(0,512,s$d,s$L,null)},s$d}(),s$M=function(){function s$L(s$d,s$L,s$l){this._value=0,this._name2int=s$d,this._int2name=s$L,this._int2nameMap=s$l}s$q(s$L,"laya.webgl.shader.ShaderDefines");var s$d=s$L.prototype;return s$d.add=function(s$d){return"string"==typeof s$d&&(s$d=this._name2int[s$d]),this._value|=s$d,this._value},s$d.addInt=function(s$d){return this._value|=s$d,this._value},s$d.remove=function(s$d){return"string"==typeof s$d&&(s$d=this._name2int[s$d]),this._value&=~s$d,this._value},s$d.isDefine=function(s$d){return(this._value&s$d)===s$d},s$d.getValue=function(){return this._value},s$d.setValue=function(s$d){this._value=s$d},s$d.toNameDic=function(){var s$d=this._int2nameMap[this._value];return s$d||s$L._toText(this._value,this._int2name,this._int2nameMap)},s$L._reg=function(s$d,s$L,s$l,s$Z){s$Z[s$l[s$d]=s$L]=s$d},s$L._toText=function(s$d,s$L,s$l){var s$Z=s$l[s$d];if(s$Z)return s$Z;for(var s$h={},s$_=1,s$N=0;s$N<32&&!(s$d<(s$_=1<<s$N));s$N++)if(s$d&s$_){var s$m=s$L[s$_];s$m&&(s$h[s$m]="")}return s$l[s$d]=s$h},s$L._toInt=function(s$d,s$L){for(var s$l=s$d.split("."),s$Z=0,s$h=0,s$_=s$l.length;s$h<s$_;s$h++){var s$N=s$L[s$l[s$h]];if(!s$N)throw new Error("Defines to int err:"+s$d+"/"+s$l[s$h]);s$Z|=s$N}return s$Z},s$L}(),s$dd=function(){function s$N(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new s$n}s$q(s$N,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var s$d=s$N.prototype;return s$d.init=function(s$d,s$L,s$l){if(s$L)this._vs=s$L;else{this._vs=[];var s$Z=s$d.width,s$h=s$d.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(s$Z,0,1,0,1,1,1,1),this._vs.push(s$Z,s$h,1,1,1,1,1,1),this._vs.push(0,s$h,0,1,1,1,1,1)}s$l?this._ps=s$l:(s$N._defaultPS||(s$N._defaultPS=[]).push(0,1,3,3,1,2),this._ps=s$N._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=s$d},s$d.init2=function(s$d,s$L,s$l,s$Z,s$h){this.transform&&(this.transform=null),s$l?this._ps=s$l:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=s$Z,this._uvs=s$h,this.mEleNum=this._ps.length,this.mTexture=s$d,(s$k.isConchNode||s$k.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},s$d._initMyData=function(){var s$d=0,s$L=0,s$l=4*this._verticles.length;this._vs=s$N._tempVS;var s$Z=!1;if(s$k.isConchNode||s$k.isConchApp?(this._vs.length=s$l,s$Z=!0):this._vs.length<s$l&&(this._vs.length=s$l,s$Z=!0),s$N._tVSLen=s$l,s$Z)for(;s$d<s$l;)this._vs[s$d]=this._verticles[s$L],this._vs[s$d+1]=this._verticles[s$L+1],this._vs[s$d+2]=this._uvs[s$L],this._vs[s$d+3]=this._uvs[s$L+1],this._vs[s$d+4]=1,this._vs[s$d+5]=1,this._vs[s$d+6]=1,this._vs[s$d+7]=1,s$d+=8,s$L+=2;else for(;s$d<s$l;)this._vs[s$d]=this._verticles[s$L],this._vs[s$d+1]=this._verticles[s$L+1],this._vs[s$d+2]=this._uvs[s$L],this._vs[s$d+3]=this._uvs[s$L+1],s$d+=8,s$L+=2},s$d.getData2=function(s$d,s$L,s$l){var s$Z;this.mVBBuffer=s$d,this.mIBBuffer=s$L,this._initMyData(),s$d.appendEx2(this._vs,Float32Array,s$N._tVSLen,4),this._indexStart=s$L._byteLength,(s$Z=s$N._tempIB).length<this._ps.length&&(s$Z.length=this._ps.length);for(var s$h=0,s$_=this._ps.length;s$h<s$_;s$h++)s$Z[s$h]=this._ps[s$h]+s$l;s$L.appendEx2(s$Z,Uint16Array,this._ps.length,2)},s$d.getData=function(s$d,s$L,s$l){if(this.mVBBuffer=s$d,this.mIBBuffer=s$L,s$d.append(this.mVBData),this._indexStart=s$L._byteLength,this.mIBData.start!=s$l){for(var s$Z=0,s$h=this._ps.length;s$Z<s$h;s$Z++)this.mIBData[s$Z]=this._ps[s$Z]+s$l;this.mIBData.start=s$l}s$L.append(this.mIBData)},s$d.render=function(s$d,s$L,s$l){if(s$k.isWebGL&&this.mTexture){s$d._renderKey=0,s$d._shader2D.glTexture=null,s$Ld.getInstance().addSkinMesh(this);var s$Z=s$_d.createShape(s$d,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,s$Od.create(512,0));this.transform||(this.transform=s$n.EMPTY),this.transform.translate(s$L,s$l),s$n.mul(this.transform,s$d._curMat,this._tempMatrix),this.transform.translate(-s$L,-s$l);var s$h=s$Z.shaderValue,s$_=s$h.u_mmat2||s$ed.getMatrArray();s$ed.mat2MatArray(this._tempMatrix,s$_),s$h.textureHost=this.mTexture,s$h.offsetX=0,s$h.offsetY=0,s$h.u_mmat2=s$_,s$h.ALPHA=s$d._shader2D.ALPHA,s$d._submits[s$d._submits._length++]=s$Z}else s$k.isConchApp&&this.mTexture&&(this.transform||(this.transform=s$n.EMPTY),s$d.setSkinMesh&&s$d.setSkinMesh(s$L,s$l,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},s$N._tempVS=[],s$N._tempIB=[],s$N._defaultPS=null,s$N._tVSLen=0,s$N}(),s$Ld=function(){function s$d(){this.ib=null,this.vb=null;s$sd.mainContext;this.ib=s$Wd.create(35048),this.vb=s$Md.create(8)}s$q(s$d,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var s$L=s$d.prototype;return s$L.addSkinMesh=function(s$d){s$d.getData2(this.vb,this.ib,this.vb._byteLength/32)},s$L.reset=function(){this.vb.clear(),this.ib.clear()},s$d.getInstance=function(){return s$d.instance=s$d.instance||new s$d},s$d.instance=null,s$d}(),s$ld=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===s$u&&(s$u=0),this.x=s$d,this.y=s$L,this.width=s$l,this.height=s$Z,this.edges=s$h,this.color=s$_,this.borderWidth=s$N,this.borderColor=s$m}s$q(s$d,"laya.webgl.shapes.BasePoly");var s$L=s$d.prototype;return s$y.imps(s$L,{"laya.webgl.shapes.IShape":!0}),s$L.getData=function(s$d,s$L,s$l){},s$L.rebuild=function(s$d){},s$L.setMatrix=function(s$d){},s$L.needUpdate=function(s$d){return!0},s$L.sector=function(s$d,s$L,s$l){var s$Z=this.x,s$h=this.y,s$_=this.edges,s$N=(this.r1-this.r0)/s$_,s$m=this.width,s$u=this.height,s$x=this.color,s$t=(s$x>>16&255)/255,s$b=(s$x>>8&255)/255,s$q=(255&s$x)/255;s$d.push(s$Z,s$h,s$t,s$b,s$q);for(var s$Y=0;s$Y<s$_+1;s$Y++)s$d.push(s$Z+Math.sin(s$N*s$Y+this.r0)*s$m,s$h+Math.cos(s$N*s$Y+this.r0)*s$u),s$d.push(s$t,s$b,s$q);for(s$Y=0;s$Y<s$_;s$Y++)s$L.push(s$l,s$l+s$Y+1,s$l+s$Y+2)},s$L.createLine2=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m,s$u,s$x,s$t,s$b,s$q,s$Y,s$c,s$r,s$a,s$k,s$e,s$w,s$s,s$A,s$y,s$$,s$O,s$n,s$V=s$d.concat(),s$Q=s$h,s$g=this.borderColor,s$F=(s$g>>16&255)/255,s$E=(s$g>>8&255)/255,s$I=(255&s$g)/255,s$p=s$V.length/2,s$H=s$Z,s$X=s$l/2;s$u=s$V[0],s$x=s$V[1],s$r=s$u-(s$t=s$V[2]),s$c=(s$c=-(s$x-(s$b=s$V[3])))/(s$n=Math.sqrt(s$c*s$c+s$r*s$r))*s$X,s$r=s$r/s$n*s$X,s$Q.push(s$u-s$c+this.x,s$x-s$r+this.y,s$F,s$E,s$I,s$u+s$c+this.x,s$x+s$r+this.y,s$F,s$E,s$I);for(var s$j=1;s$j<s$p-1;s$j++)s$u=s$V[2*(s$j-1)],s$x=s$V[2*(s$j-1)+1],s$t=s$V[2*s$j],s$b=s$V[2*s$j+1],s$q=s$V[2*(s$j+1)],s$Y=s$V[2*(s$j+1)+1],s$r=s$u-s$t,s$k=s$t-s$q,s$s=(-(s$c=(s$c=-(s$x-s$b))/(s$n=Math.sqrt(s$c*s$c+s$r*s$r))*s$X)+s$u)*(-(s$r=s$r/s$n*s$X)+s$b)-(-s$c+s$t)*(-s$r+s$x),s$$=(-(s$a=(s$a=-(s$b-s$Y))/(s$n=Math.sqrt(s$a*s$a+s$k*s$k))*s$X)+s$q)*(-(s$k=s$k/s$n*s$X)+s$b)-(-s$a+s$t)*(-s$k+s$Y),s$O=(s$e=-s$r+s$x-(-s$r+s$b))*(s$y=-s$a+s$t-(-s$a+s$q))-(s$A=-s$k+s$Y-(-s$k+s$b))*(s$w=-s$c+s$t-(-s$c+s$u)),Math.abs(s$O)<.1?(s$O+=10.1,s$Q.push(s$t-s$c+this.x,s$b-s$r+this.y,s$F,s$E,s$I,s$t+s$c+this.x,s$b+s$r+this.y,s$F,s$E,s$I)):(((s$N=(s$w*s$$-s$y*s$s)/s$O)-s$t)*(s$N-s$t)+((s$m=(s$A*s$s-s$e*s$$)/s$O)-s$b)+(s$m-s$b),s$Q.push(s$N+this.x,s$m+this.y,s$F,s$E,s$I,s$t-(s$N-s$t)+this.x,s$b-(s$m-s$b)+this.y,s$F,s$E,s$I));s$u=s$V[s$V.length-4],s$x=s$V[s$V.length-3],s$r=s$u-(s$t=s$V[s$V.length-2]),s$c=(s$c=-(s$x-(s$b=s$V[s$V.length-1])))/(s$n=Math.sqrt(s$c*s$c+s$r*s$r))*s$X,s$r=s$r/s$n*s$X,s$Q.push(s$t-s$c+this.x,s$b-s$r+this.y,s$F,s$E,s$I,s$t+s$c+this.x,s$b+s$r+this.y,s$F,s$E,s$I);var s$R=s$_;for(s$j=1;s$j<s$R;s$j++)s$L.push(s$H+2*(s$j-1),s$H+2*(s$j-1)+1,s$H+2*s$j+1,s$H+2*s$j+1,s$H+2*s$j,s$H+2*(s$j-1));return s$Q},s$L.createLine=function(s$d,s$L,s$l,s$Z){var s$h=s$d.concat(),s$_=s$d,s$N=this.borderColor,s$m=(s$N>>16&255)/255,s$u=(s$N>>8&255)/255,s$x=(255&s$N)/255;s$h.splice(0,5);var s$t,s$b,s$q,s$Y,s$c,s$r,s$a,s$k,s$e,s$w,s$s,s$A,s$y,s$$,s$O,s$n,s$V,s$Q,s$g,s$F,s$E=s$h.length/5,s$I=s$Z,s$p=s$l/2;s$q=s$h[0],s$Y=s$h[1],s$w=s$q-(s$c=s$h[5]),s$e=(s$e=-(s$Y-(s$r=s$h[6])))/(s$F=Math.sqrt(s$e*s$e+s$w*s$w))*s$p,s$w=s$w/s$F*s$p,s$_.push(s$q-s$e,s$Y-s$w,s$m,s$u,s$x,s$q+s$e,s$Y+s$w,s$m,s$u,s$x);for(var s$H=1;s$H<s$E-1;s$H++)s$q=s$h[5*(s$H-1)],s$Y=s$h[5*(s$H-1)+1],s$c=s$h[5*s$H],s$r=s$h[5*s$H+1],s$a=s$h[5*(s$H+1)],s$k=s$h[5*(s$H+1)+1],s$w=s$q-s$c,s$A=s$c-s$a,s$O=(-(s$e=(s$e=-(s$Y-s$r))/(s$F=Math.sqrt(s$e*s$e+s$w*s$w))*s$p)+s$q)*(-(s$w=s$w/s$F*s$p)+s$r)-(-s$e+s$c)*(-s$w+s$Y),s$Q=(-(s$s=(s$s=-(s$r-s$k))/(s$F=Math.sqrt(s$s*s$s+s$A*s$A))*s$p)+s$a)*(-(s$A=s$A/s$F*s$p)+s$r)-(-s$s+s$c)*(-s$A+s$k),s$g=(s$y=-s$w+s$Y-(-s$w+s$r))*(s$V=-s$s+s$c-(-s$s+s$a))-(s$n=-s$A+s$k-(-s$A+s$r))*(s$$=-s$e+s$c-(-s$e+s$q)),Math.abs(s$g)<.1?(s$g+=10.1,s$_.push(s$c-s$e,s$r-s$w,s$m,s$u,s$x,s$c+s$e,s$r+s$w,s$m,s$u,s$x)):(((s$t=(s$$*s$Q-s$V*s$O)/s$g)-s$c)*(s$t-s$c)+((s$b=(s$n*s$O-s$y*s$Q)/s$g)-s$r)+(s$b-s$r),s$_.push(s$t,s$b,s$m,s$u,s$x,s$c-(s$t-s$c),s$r-(s$b-s$r),s$m,s$u,s$x));s$q=s$h[s$h.length-10],s$Y=s$h[s$h.length-9],s$w=s$q-(s$c=s$h[s$h.length-5]),s$e=(s$e=-(s$Y-(s$r=s$h[s$h.length-4])))/(s$F=Math.sqrt(s$e*s$e+s$w*s$w))*s$p,s$w=s$w/s$F*s$p,s$_.push(s$c-s$e,s$r-s$w,s$m,s$u,s$x,s$c+s$e,s$r+s$w,s$m,s$u,s$x);var s$X=this.edges+1;for(s$H=1;s$H<s$X;s$H++)s$L.push(s$I+2*(s$H-1),s$I+2*(s$H-1)+1,s$I+2*s$H+1,s$I+2*s$H+1,s$I+2*s$H,s$I+2*(s$H-1));return s$_},s$L.createLoopLine=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$d.concat(),s$m=s$h||s$d,s$u=this.borderColor,s$x=(s$u>>16&255)/255,s$t=(s$u>>8&255)/255,s$b=(255&s$u)/255;s$N.splice(0,5);var s$q=[s$N[0],s$N[1]],s$Y=[s$N[s$N.length-5],s$N[s$N.length-4]],s$c=s$Y[0]+.5*(s$q[0]-s$Y[0]),s$r=s$Y[1]+.5*(s$q[1]-s$Y[1]);s$N.unshift(s$c,s$r,0,0,0),s$N.push(s$c,s$r,0,0,0);var s$a,s$k,s$e,s$w,s$s,s$A,s$y,s$$,s$O,s$n,s$V,s$Q,s$g,s$F,s$E,s$I,s$p,s$H,s$X,s$j,s$R=s$N.length/5,s$o=s$Z,s$i=s$l/2;s$e=s$N[0],s$w=s$N[1],s$n=s$e-(s$s=s$N[5]),s$O=(s$O=-(s$w-(s$A=s$N[6])))/(s$j=Math.sqrt(s$O*s$O+s$n*s$n))*s$i,s$n=s$n/s$j*s$i,s$m.push(s$e-s$O,s$w-s$n,s$x,s$t,s$b,s$e+s$O,s$w+s$n,s$x,s$t,s$b);for(var s$S=1;s$S<s$R-1;s$S++)s$e=s$N[5*(s$S-1)],s$w=s$N[5*(s$S-1)+1],s$s=s$N[5*s$S],s$A=s$N[5*s$S+1],s$y=s$N[5*(s$S+1)],s$$=s$N[5*(s$S+1)+1],s$n=s$e-s$s,s$Q=s$s-s$y,s$E=(-(s$O=(s$O=-(s$w-s$A))/(s$j=Math.sqrt(s$O*s$O+s$n*s$n))*s$i)+s$e)*(-(s$n=s$n/s$j*s$i)+s$A)-(-s$O+s$s)*(-s$n+s$w),s$H=(-(s$V=(s$V=-(s$A-s$$))/(s$j=Math.sqrt(s$V*s$V+s$Q*s$Q))*s$i)+s$y)*(-(s$Q=s$Q/s$j*s$i)+s$A)-(-s$V+s$s)*(-s$Q+s$$),s$X=(s$g=-s$n+s$w-(-s$n+s$A))*(s$p=-s$V+s$s-(-s$V+s$y))-(s$I=-s$Q+s$$-(-s$Q+s$A))*(s$F=-s$O+s$s-(-s$O+s$e)),Math.abs(s$X)<.1?(s$X+=10.1,s$m.push(s$s-s$O,s$A-s$n,s$x,s$t,s$b,s$s+s$O,s$A+s$n,s$x,s$t,s$b)):(((s$a=(s$F*s$H-s$p*s$E)/s$X)-s$s)*(s$a-s$s)+((s$k=(s$I*s$E-s$g*s$H)/s$X)-s$A)+(s$k-s$A),s$m.push(s$a,s$k,s$x,s$t,s$b,s$s-(s$a-s$s),s$A-(s$k-s$A),s$x,s$t,s$b));s$_&&(s$L=s$_);var s$B=this.edges+1;for(s$S=1;s$S<s$B;s$S++)s$L.push(s$o+2*(s$S-1),s$o+2*(s$S-1)+1,s$o+2*s$S+1,s$o+2*s$S+1,s$o+2*s$S,s$o+2*(s$S-1));return s$L.push(s$o+2*(s$S-1),s$o+2*(s$S-1)+1,s$o+1,s$o+1,s$o,s$o+2*(s$S-1)),s$m},s$d}(),s$Zd=function(){function s$r(){}return s$q(s$r,"laya.webgl.shapes.Earcut"),s$r.earcut=function(s$d,s$L,s$l){s$l=s$l||2;var s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t=s$L&&s$L.length,s$b=s$t?s$L[0]*s$l:s$d.length,s$q=s$r.linkedList(s$d,0,s$b,s$l,!0),s$Y=[];if(!s$q)return s$Y;if(s$t&&(s$q=s$r.eliminateHoles(s$d,s$L,s$q,s$l)),s$d.length>80*s$l){s$Z=s$_=s$d[0],s$h=s$N=s$d[1];for(var s$c=s$l;s$c<s$b;s$c+=s$l)(s$m=s$d[s$c])<s$Z&&(s$Z=s$m),(s$u=s$d[s$c+1])<s$h&&(s$h=s$u),s$_<s$m&&(s$_=s$m),s$N<s$u&&(s$N=s$u);s$x=0!==(s$x=Math.max(s$_-s$Z,s$N-s$h))?1/s$x:0}return s$r.earcutLinked(s$q,s$Y,s$l,s$Z,s$h,s$x),s$Y},s$r.linkedList=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N;if(s$h===0<s$r.signedArea(s$d,s$L,s$l,s$Z))for(s$_=s$L;s$_<s$l;s$_+=s$Z)s$N=s$r.insertNode(s$_,s$d[s$_],s$d[s$_+1],s$N);else for(s$_=s$l-s$Z;s$L<=s$_;s$_-=s$Z)s$N=s$r.insertNode(s$_,s$d[s$_],s$d[s$_+1],s$N);return s$N&&s$r.equals(s$N,s$N.next)&&(s$r.removeNode(s$N),s$N=s$N.next),s$N},s$r.filterPoints=function(s$d,s$L){if(!s$d)return s$d;s$L||(s$L=s$d);var s$l,s$Z=s$d;do{if(s$l=!1,s$Z.steiner||!s$r.equals(s$Z,s$Z.next)&&0!==s$r.area(s$Z.prev,s$Z,s$Z.next))s$Z=s$Z.next;else{if(s$r.removeNode(s$Z),(s$Z=s$L=s$Z.prev)===s$Z.next)break;s$l=!0}}while(s$l||s$Z!==s$L);return s$L},s$r.earcutLinked=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(s$d){!s$N&&s$_&&s$r.indexCurve(s$d,s$Z,s$h,s$_);for(var s$m,s$u,s$x=s$d;s$d.prev!==s$d.next;)if(s$m=s$d.prev,s$u=s$d.next,s$_?s$r.isEarHashed(s$d,s$Z,s$h,s$_):s$r.isEar(s$d))s$L.push(s$m.i/s$l),s$L.push(s$d.i/s$l),s$L.push(s$u.i/s$l),s$r.removeNode(s$d),s$d=s$u.next,s$x=s$u.next;else if((s$d=s$u)===s$x){s$N?1===s$N?(s$d=s$r.cureLocalIntersections(s$d,s$L,s$l),s$r.earcutLinked(s$d,s$L,s$l,s$Z,s$h,s$_,2)):2===s$N&&s$r.splitEarcut(s$d,s$L,s$l,s$Z,s$h,s$_):s$r.earcutLinked(s$r.filterPoints(s$d,null),s$L,s$l,s$Z,s$h,s$_,1);break}}},s$r.isEar=function(s$d){var s$L=s$d.prev,s$l=s$d,s$Z=s$d.next;if(0<=s$r.area(s$L,s$l,s$Z))return!1;for(var s$h=s$d.next.next;s$h!==s$d.prev;){if(s$r.pointInTriangle(s$L.x,s$L.y,s$l.x,s$l.y,s$Z.x,s$Z.y,s$h.x,s$h.y)&&0<=s$r.area(s$h.prev,s$h,s$h.next))return!1;s$h=s$h.next}return!0},s$r.isEarHashed=function(s$d,s$L,s$l,s$Z){var s$h=s$d.prev,s$_=s$d,s$N=s$d.next;if(0<=s$r.area(s$h,s$_,s$N))return!1;for(var s$m=s$h.x<s$_.x?s$h.x<s$N.x?s$h.x:s$N.x:s$_.x<s$N.x?s$_.x:s$N.x,s$u=s$h.y<s$_.y?s$h.y<s$N.y?s$h.y:s$N.y:s$_.y<s$N.y?s$_.y:s$N.y,s$x=s$h.x>s$_.x?s$h.x>s$N.x?s$h.x:s$N.x:s$_.x>s$N.x?s$_.x:s$N.x,s$t=s$h.y>s$_.y?s$h.y>s$N.y?s$h.y:s$N.y:s$_.y>s$N.y?s$_.y:s$N.y,s$b=s$r.zOrder(s$m,s$u,s$L,s$l,s$Z),s$q=s$r.zOrder(s$x,s$t,s$L,s$l,s$Z),s$Y=s$d.nextZ;s$Y&&s$Y.z<=s$q;){if(s$Y!==s$d.prev&&s$Y!==s$d.next&&s$r.pointInTriangle(s$h.x,s$h.y,s$_.x,s$_.y,s$N.x,s$N.y,s$Y.x,s$Y.y)&&0<=s$r.area(s$Y.prev,s$Y,s$Y.next))return!1;s$Y=s$Y.nextZ}for(s$Y=s$d.prevZ;s$Y&&s$Y.z>=s$b;){if(s$Y!==s$d.prev&&s$Y!==s$d.next&&s$r.pointInTriangle(s$h.x,s$h.y,s$_.x,s$_.y,s$N.x,s$N.y,s$Y.x,s$Y.y)&&0<=s$r.area(s$Y.prev,s$Y,s$Y.next))return!1;s$Y=s$Y.prevZ}return!0},s$r.cureLocalIntersections=function(s$d,s$L,s$l){var s$Z=s$d;do{var s$h=s$Z.prev,s$_=s$Z.next.next;!s$r.equals(s$h,s$_)&&s$r.intersects(s$h,s$Z,s$Z.next,s$_)&&s$r.locallyInside(s$h,s$_)&&s$r.locallyInside(s$_,s$h)&&(s$L.push(s$h.i/s$l),s$L.push(s$Z.i/s$l),s$L.push(s$_.i/s$l),s$r.removeNode(s$Z),s$r.removeNode(s$Z.next),s$Z=s$d=s$_),s$Z=s$Z.next}while(s$Z!==s$d);return s$Z},s$r.splitEarcut=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$d;do{for(var s$m=s$N.next.next;s$m!==s$N.prev;){if(s$N.i!==s$m.i&&s$r.isValidDiagonal(s$N,s$m)){var s$u=s$r.splitPolygon(s$N,s$m);return s$N=s$r.filterPoints(s$N,s$N.next),s$u=s$r.filterPoints(s$u,s$u.next),s$r.earcutLinked(s$N,s$L,s$l,s$Z,s$h,s$_),void s$r.earcutLinked(s$u,s$L,s$l,s$Z,s$h,s$_)}s$m=s$m.next}s$N=s$N.next}while(s$N!==s$d)},s$r.eliminateHoles=function(s$d,s$L,s$l,s$Z){var s$h,s$_,s$N,s$m,s$u,s$x=[];for(s$h=0,s$_=s$L.length;s$h<s$_;s$h++)s$N=s$L[s$h]*s$Z,s$m=s$h<s$_-1?s$L[s$h+1]*s$Z:s$d.length,(s$u=s$r.linkedList(s$d,s$N,s$m,s$Z,!1))===s$u.next&&(s$u.steiner=!0),s$x.push(s$r.getLeftmost(s$u));for(s$x.sort(s$r.compareX),s$h=0;s$h<s$x.length;s$h++)s$r.eliminateHole(s$x[s$h],s$l),s$l=s$r.filterPoints(s$l,s$l.next);return s$l},s$r.compareX=function(s$d,s$L){return s$d.x-s$L.x},s$r.eliminateHole=function(s$d,s$L){if(s$L=s$r.findHoleBridge(s$d,s$L)){var s$l=s$r.splitPolygon(s$L,s$d);s$r.filterPoints(s$l,s$l.next)}},s$r.findHoleBridge=function(s$d,s$L){var s$l,s$Z=s$L,s$h=s$d.x,s$_=s$d.y,s$N=-1/0;do{if(s$_<=s$Z.y&&s$_>=s$Z.next.y&&s$Z.next.y!==s$Z.y){var s$m=s$Z.x+(s$_-s$Z.y)*(s$Z.next.x-s$Z.x)/(s$Z.next.y-s$Z.y);if(s$m<=s$h&&s$N<s$m){if((s$N=s$m)===s$h){if(s$_===s$Z.y)return s$Z;if(s$_===s$Z.next.y)return s$Z.next}s$l=s$Z.x<s$Z.next.x?s$Z:s$Z.next}}s$Z=s$Z.next}while(s$Z!==s$L);if(!s$l)return null;if(s$h===s$N)return s$l.prev;var s$u,s$x=s$l,s$t=s$l.x,s$b=s$l.y,s$q=1/0;for(s$Z=s$l.next;s$Z!==s$x;)s$h>=s$Z.x&&s$Z.x>=s$t&&s$h!==s$Z.x&&s$r.pointInTriangle(s$_<s$b?s$h:s$N,s$_,s$t,s$b,s$_<s$b?s$N:s$h,s$_,s$Z.x,s$Z.y)&&((s$u=Math.abs(s$_-s$Z.y)/(s$h-s$Z.x))<s$q||s$u===s$q&&s$Z.x>s$l.x)&&s$r.locallyInside(s$Z,s$d)&&(s$l=s$Z,s$q=s$u),s$Z=s$Z.next;return s$l},s$r.indexCurve=function(s$d,s$L,s$l,s$Z){for(var s$h=s$d;null===s$h.z&&(s$h.z=s$r.zOrder(s$h.x,s$h.y,s$L,s$l,s$Z)),s$h.prevZ=s$h.prev,s$h.nextZ=s$h.next,(s$h=s$h.next)!==s$d;);s$h.prevZ.nextZ=null,s$h.prevZ=null,s$r.sortLinked(s$h)},s$r.sortLinked=function(s$d){var s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x=1;do{for(s$l=s$d,s$_=s$d=null,s$N=0;s$l;){for(s$N++,s$Z=s$l,s$L=s$m=0;s$L<s$x&&(s$m++,s$Z=s$Z.nextZ);s$L++);for(s$u=s$x;0<s$m||0<s$u&&s$Z;)0!==s$m&&(0===s$u||!s$Z||s$l.z<=s$Z.z)?(s$l=(s$h=s$l).nextZ,s$m--):(s$Z=(s$h=s$Z).nextZ,s$u--),s$_?s$_.nextZ=s$h:s$d=s$h,s$h.prevZ=s$_,s$_=s$h;s$l=s$Z}s$_.nextZ=null,s$x*=2}while(1<s$N);return s$d},s$r.zOrder=function(s$d,s$L,s$l,s$Z,s$h){return(s$d=1431655765&((s$d=858993459&((s$d=252645135&((s$d=16711935&((s$d=32767*(s$d-s$l)*s$h)|s$d<<8))|s$d<<4))|s$d<<2))|s$d<<1))|(s$L=1431655765&((s$L=858993459&((s$L=252645135&((s$L=16711935&((s$L=32767*(s$L-s$Z)*s$h)|s$L<<8))|s$L<<4))|s$L<<2))|s$L<<1))<<1},s$r.getLeftmost=function(s$d){for(var s$L=s$d,s$l=s$d;s$L.x<s$l.x&&(s$l=s$L),(s$L=s$L.next)!==s$d;);return s$l},s$r.pointInTriangle=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){return 0<=(s$h-s$N)*(s$L-s$m)-(s$d-s$N)*(s$_-s$m)&&0<=(s$d-s$N)*(s$Z-s$m)-(s$l-s$N)*(s$L-s$m)&&0<=(s$l-s$N)*(s$_-s$m)-(s$h-s$N)*(s$Z-s$m)},s$r.isValidDiagonal=function(s$d,s$L){return s$d.next.i!==s$L.i&&s$d.prev.i!==s$L.i&&!s$r.intersectsPolygon(s$d,s$L)&&s$r.locallyInside(s$d,s$L)&&s$r.locallyInside(s$L,s$d)&&s$r.middleInside(s$d,s$L)},s$r.area=function(s$d,s$L,s$l){return(s$L.y-s$d.y)*(s$l.x-s$L.x)-(s$L.x-s$d.x)*(s$l.y-s$L.y)},s$r.equals=function(s$d,s$L){return s$d.x===s$L.x&&s$d.y===s$L.y},s$r.intersects=function(s$d,s$L,s$l,s$Z){return!!(s$r.equals(s$d,s$L)&&s$r.equals(s$l,s$Z)||s$r.equals(s$d,s$Z)&&s$r.equals(s$l,s$L))||0<s$r.area(s$d,s$L,s$l)!=0<s$r.area(s$d,s$L,s$Z)&&0<s$r.area(s$l,s$Z,s$d)!=0<s$r.area(s$l,s$Z,s$L)},s$r.intersectsPolygon=function(s$d,s$L){var s$l=s$d;do{if(s$l.i!==s$d.i&&s$l.next.i!==s$d.i&&s$l.i!==s$L.i&&s$l.next.i!==s$L.i&&s$r.intersects(s$l,s$l.next,s$d,s$L))return!0;s$l=s$l.next}while(s$l!==s$d);return!1},s$r.locallyInside=function(s$d,s$L){return s$r.area(s$d.prev,s$d,s$d.next)<0?0<=s$r.area(s$d,s$L,s$d.next)&&0<=s$r.area(s$d,s$d.prev,s$L):s$r.area(s$d,s$L,s$d.prev)<0||s$r.area(s$d,s$d.next,s$L)<0},s$r.middleInside=function(s$d,s$L){for(var s$l=s$d,s$Z=!1,s$h=(s$d.x+s$L.x)/2,s$_=(s$d.y+s$L.y)/2;s$l.y>s$_!=s$l.next.y>s$_&&s$l.next.y!==s$l.y&&s$h<(s$l.next.x-s$l.x)*(s$_-s$l.y)/(s$l.next.y-s$l.y)+s$l.x&&(s$Z=!s$Z),(s$l=s$l.next)!==s$d;);return s$Z},s$r.splitPolygon=function(s$d,s$L){var s$l=new s$hd(s$d.i,s$d.x,s$d.y),s$Z=new s$hd(s$L.i,s$L.x,s$L.y),s$h=s$d.next,s$_=s$L.prev;return(s$d.next=s$L).prev=s$d,(s$l.next=s$h).prev=s$l,(s$Z.next=s$l).prev=s$Z,(s$_.next=s$Z).prev=s$_,s$Z},s$r.insertNode=function(s$d,s$L,s$l,s$Z){var s$h=new s$hd(s$d,s$L,s$l);return s$Z?(s$h.next=s$Z.next,(s$h.prev=s$Z).next.prev=s$h,s$Z.next=s$h):(s$h.prev=s$h).next=s$h,s$h},s$r.removeNode=function(s$d){s$d.next.prev=s$d.prev,s$d.prev.next=s$d.next,s$d.prevZ&&(s$d.prevZ.nextZ=s$d.nextZ),s$d.nextZ&&(s$d.nextZ.prevZ=s$d.prevZ)},s$r.signedArea=function(s$d,s$L,s$l,s$Z){for(var s$h=0,s$_=s$L,s$N=s$l-s$Z;s$_<s$l;s$_+=s$Z)s$h+=(s$d[s$N]-s$d[s$_])*(s$d[s$_+1]+s$d[s$N+1]),s$N=s$_;return s$h},s$r}(),s$hd=function(){function s$d(s$d,s$L,s$l){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=s$d,this.x=s$L,this.y=s$l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return s$q(s$d,"laya.webgl.shapes.EarcutNode"),s$d}(),s$_d=(function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this.lineWidth=s$d,this.lineColor=s$L,this.lineAlpha=s$l,this.fillColor=s$Z,this.fillAlpha=s$h,this.shape=s$N,this.fill=s$_}s$q(s$d,"laya.webgl.shapes.GeometryData");var s$L=s$d.prototype;s$L.clone=function(){return new s$d(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},s$L.getIndexData=function(){return null},s$L.getVertexData=function(){return null},s$L.destroy=function(){this.shape=null}}(),function(){function s$d(s$d){if(s$d instanceof Float32Array)this.points=s$d;else if(s$d instanceof Array){s$d.length;this.points=new Float32Array(s$d)}}s$q(s$d,"laya.webgl.shapes.Vertex");var s$L=s$d.prototype;s$y.imps(s$L,{"laya.webgl.shapes.IShape":!0}),s$L.getData=function(s$d,s$L,s$l){},s$L.needUpdate=function(s$d){return!1},s$L.rebuild=function(s$d){},s$L.setMatrix=function(s$d){}}(),function(){function s$u(s$d){void 0===s$d&&(s$d=1e4),this._renderType=s$d}s$q(s$u,"laya.webgl.submit.Submit");var s$d=s$u.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d.releaseRender=function(){var s$d=s$u._cache;(s$d[s$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},s$d.getRenderType=function(){return this._renderType},s$d.renderSubmit=function(){if(0===this._numEle)return 1;var s$d=this.shaderValue.textureHost;if(s$d){var s$L=s$d.source;if(!s$d.bitmap||!s$L)return 1;this.shaderValue.texture=s$L,s$d.alphaTexture&&s$d.alphaTexture.source&&(this.shaderValue.texture1=s$d.alphaTexture.source)}this._vb.bind_upload(this._ib);var s$l=s$sd.mainContext;return this.shaderValue.upload(),s$P.activeBlendFunction!==this._blendFn&&(s$l.enable(3042),this._blendFn(s$l),s$P.activeBlendFunction=this._blendFn),s$E.drawCall++,s$E.trianglesFaces+=this._numEle/3,s$l.drawElements(4,this._numEle,5123,this._startIdx),1},s$u.__init__=function(){var s$d=s$u.RENDERBASE=new s$u(-1);s$d.shaderValue=new s$Od(0,0),s$d.shaderValue.ALPHA=-1234},s$u.createSubmit=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$u._cache._length?s$u._cache[--s$u._cache._length]:new s$u;null==s$l&&((s$l=s$_._selfVb||(s$_._selfVb=s$Md.create(-1))).clear(),s$Z=0),s$_._ib=s$L,s$_._vb=s$l,s$_._startIdx=s$Z*s$rd.BYTES_PIDX,s$_._numEle=0;var s$N=s$d._nBlendType;s$_._blendFn=s$d._targets?s$P.targetFns[s$N]:s$P.fns[s$N],s$_.shaderValue=s$h,s$_.shaderValue.setValue(s$d._shader2D);var s$m=s$d._shader2D.filters;return s$m&&s$_.shaderValue.setFilters(s$m),s$_},s$u.createShape=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$u._cache._length?s$u._cache[--s$u._cache._length]:new s$u;s$N._ib=s$L,s$N._vb=s$l,s$N._numEle=s$Z,s$N._startIdx=s$h,s$N.shaderValue=s$_,s$N.shaderValue.setValue(s$d._shader2D);var s$m=s$d._nBlendType;return s$N._blendFn=s$d._targets?s$P.targetFns[s$m]:s$P.fns[s$m],s$N},s$u.TYPE_2D=1e4,s$u.TYPE_CANVAS=10003,s$u.TYPE_CMDSETRT=10004,s$u.TYPE_CUSTOM=10005,s$u.TYPE_BLURRT=10006,s$u.TYPE_CMDDESTORYPRERT=10007,s$u.TYPE_DISABLESTENCIL=10008,s$u.TYPE_OTHERIBVB=10009,s$u.TYPE_PRIMITIVE=10010,s$u.TYPE_RT=10011,s$u.TYPE_BLUR_RT=10012,s$u.TYPE_TARGET=10013,s$u.TYPE_CHANGE_VALUE=10014,s$u.TYPE_SHAPE=10015,s$u.TYPE_TEXTURE=10016,s$u.TYPE_FILLTEXTURE=10017,s$u.RENDERBASE=null,s$u._cache=((s$u._cache=[])._length=0,s$u._cache),s$u}()),s$Nd=function(){function s$Z(){this.fun=null,this.args=null}s$q(s$Z,"laya.webgl.submit.SubmitCMD");var s$d=s$Z.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d.renderSubmit=function(){return this.fun.apply(null,this.args),1},s$d.getRenderType=function(){return 0},s$d.releaseRender=function(){var s$d=s$Z._cache;s$d[s$d._length++]=this},s$Z.create=function(s$d,s$L){var s$l=s$Z._cache._length?s$Z._cache[--s$Z._cache._length]:new s$Z;return s$l.fun=s$L,s$l.args=s$d,s$l},s$Z._cache=((s$Z._cache=[])._length=0,s$Z._cache),s$Z}(),s$md=function(){function s$L(){this.variables={}}s$q(s$L,"laya.webgl.submit.SubmitCMDScope");var s$d=s$L.prototype;return s$d.getValue=function(s$d){return this.variables[s$d]},s$d.addValue=function(s$d,s$L){return this.variables[s$d]=s$L},s$d.setValue=function(s$d,s$L){return this.variables.hasOwnProperty(s$d)?this.variables[s$d]=s$L:null},s$d.clear=function(){for(var s$d in this.variables)delete this.variables[s$d]},s$d.recycle=function(){this.clear(),s$L.POOL.push(this)},s$L.create=function(){var s$d=s$L.POOL.pop();return s$d||(s$d=new s$L),s$d},s$L.POOL=[],s$L}(),s$ud=function(){function s$b(){this.offset=0,this.startIndex=0,this._mat=s$n.create()}s$q(s$b,"laya.webgl.submit.SubmitOtherIBVB");var s$d=s$b.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d.releaseRender=function(){var s$d=s$b._cache;(s$d[s$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},s$d.getRenderType=function(){return 10009},s$d.renderSubmit=function(){var s$d=this._shaderValue.textureHost;if(s$d){var s$L=s$d.source;if(!s$d.bitmap||!s$L)return 1;this._shaderValue.texture=s$L}this._vb.bind_upload(this._ib);var s$l=s$ed.worldMatrix4,s$Z=s$n.TEMP;s$n.mulPre(this._mat,s$l[0],s$l[1],s$l[4],s$l[5],s$l[12],s$l[13],s$Z);var s$h=s$ed.worldMatrix4=s$b.tempMatrix4;s$h[0]=s$Z.a,s$h[1]=s$Z.b,s$h[4]=s$Z.c,s$h[5]=s$Z.d,s$h[12]=s$Z.tx,s$h[13]=s$Z.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var s$_=s$sd.mainContext;return s$P.activeBlendFunction!==this._blendFn&&(s$_.enable(3042),this._blendFn(s$_),s$P.activeBlendFunction=this._blendFn),s$E.drawCall++,s$E.trianglesFaces+=this._numEle/3,s$_.drawElements(4,this._numEle,5123,this.startIndex),s$ed.worldMatrix4=s$l,s$jd.activeShader=null,1},s$b.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){void 0===s$u&&(s$u=0);var s$x=s$b._cache._length?s$b._cache[--s$b._cache._length]:new s$b;s$x._ib=s$l,s$x._vb=s$L,s$x._numEle=s$Z,s$x._shader=s$h,s$x._shaderValue=s$_;var s$t=s$d._nBlendType;switch(s$x._blendFn=s$d._targets?s$P.targetFns[s$t]:s$P.fns[s$t],s$u){case 0:s$x.offset=0,s$x.startIndex=s$m/(s$rd.BYTES_PE*s$L.vertexStride)*1.5,s$x.startIndex*=s$rd.BYTES_PIDX;break;case 1:s$x.startIndex=s$N,s$x.offset=s$m}return s$x},s$b._cache=((s$b._cache=[])._length=0,s$b._cache),s$b.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s$b}(),s$xd=function(){function s$l(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new s$Q,this.screenRect=new s$Q}s$q(s$l,"laya.webgl.submit.SubmitScissor");var s$d=s$l.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d._scissor=function(s$d,s$L,s$l,s$Z){var s$h=s$ed.worldMatrix4,s$_=s$h[0],s$N=s$h[5],s$m=s$h[12],s$u=s$h[13];if(s$Z*=s$N,(s$l*=s$_)<1||s$Z<1)return!1;var s$x=(s$d=s$d*s$_+s$m)+s$l,s$t=(s$L=s$L*s$N+s$u)+s$Z;s$d<0&&(s$l=s$x-(s$d=0)),s$L<0&&(s$Z=s$t-(s$L=0));var s$b=s$ed.worldClipRect;if(s$d=Math.max(s$d,s$b.x),s$L=Math.max(s$L,s$b.y),s$l=Math.min(s$x,s$b.right)-s$d,s$Z=Math.min(s$t,s$b.bottom)-s$L,s$l<1||s$Z<1)return!1;var s$q=s$ed.worldScissorTest;return this.screenRect.copyFrom(s$b),s$b.x=s$d,s$b.y=s$L,s$b.width=s$l,s$b.height=s$Z,s$ed.worldScissorTest=!0,s$L=s$ed.height-s$L-s$Z,s$sd.mainContext.scissor(s$d,s$L,s$l,s$Z),s$sd.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),s$q?(s$L=s$ed.height-this.screenRect.y-this.screenRect.height,s$sd.mainContext.scissor(this.screenRect.x,s$L,this.screenRect.width,this.screenRect.height),s$sd.mainContext.enable(3089)):(s$sd.mainContext.disable(3089),s$ed.worldScissorTest=!1),s$b.copyFrom(this.screenRect),!0},s$d._scissorWithTagart=function(s$d,s$L,s$l,s$Z){if(s$l<1||s$Z<1)return!1;var s$h=s$d+s$l,s$_=s$L+s$Z;s$d<0&&(s$l=s$h-(s$d=0)),s$L<0&&(s$Z=s$_-(s$L=0));var s$N=s$ed.worldClipRect;if(s$d=Math.max(s$d,s$N.x),s$L=Math.max(s$L,s$N.y),s$l=Math.min(s$h,s$N.right)-s$d,s$Z=Math.min(s$_,s$N.bottom)-s$L,s$l<1||s$Z<1)return!1;var s$m=s$ed.worldScissorTest;return this.screenRect.copyFrom(s$N),s$ed.worldScissorTest=!0,s$N.x=s$d,s$N.y=s$L,s$N.width=s$l,s$N.height=s$Z,s$L=s$ed.height-s$L-s$Z,s$sd.mainContext.scissor(s$d,s$L,s$l,s$Z),s$sd.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),s$m?(s$L=s$ed.height-this.screenRect.y-this.screenRect.height,s$sd.mainContext.scissor(this.screenRect.x,s$L,this.screenRect.width,this.screenRect.height),s$sd.mainContext.enable(3089)):(s$sd.mainContext.disable(3089),s$ed.worldScissorTest=!1),s$N.copyFrom(this.screenRect),!0},s$d.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},s$d.getRenderType=function(){return 0},s$d.releaseRender=function(){var s$d=s$l._cache;(s$d[s$d._length++]=this).context=null},s$l.create=function(s$d){var s$L=s$l._cache._length?s$l._cache[--s$l._cache._length]:new s$l;return s$L.context=s$d,s$L},s$l._cache=((s$l._cache=[])._length=0,s$l._cache),s$l}(),s$td=function(){function s$u(){this.step=0,this.blendMode=null,this.level=0}s$q(s$u,"laya.webgl.submit.SubmitStencil");var s$d=s$u.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},s$d.getRenderType=function(){return 0},s$d.releaseRender=function(){var s$d=s$u._cache;s$d[s$d._length++]=this},s$d.do1=function(){var s$d=s$sd.mainContext;s$d.enable(2960),s$d.clear(1024),s$d.colorMask(!1,!1,!1,!1),s$d.stencilFunc(514,this.level,255),s$d.stencilOp(7680,7680,7682)},s$d.do2=function(){var s$d=s$sd.mainContext;s$d.stencilFunc(514,this.level+1,255),s$d.colorMask(!0,!0,!0,!0),s$d.stencilOp(7680,7680,7680)},s$d.do3=function(){var s$d=s$sd.mainContext;s$d.colorMask(!0,!0,!0,!0),s$d.stencilOp(7680,7680,7680),s$d.clear(1024),s$d.disable(2960)},s$d.do4=function(){var s$d=s$sd.mainContext;0==this.level&&(s$d.enable(2960),s$d.clear(1024)),s$d.colorMask(!1,!1,!1,!1),s$d.stencilFunc(519,0,255),s$d.stencilOp(7680,7680,7682)},s$d.do5=function(){var s$d=s$sd.mainContext;s$d.stencilFunc(514,this.level,255),s$d.colorMask(!0,!0,!0,!0),s$d.stencilOp(7680,7680,7680)},s$d.do6=function(){var s$d=s$sd.mainContext;s$P.targetFns[s$P.TOINT[this.blendMode]](s$d)},s$d.do7=function(){var s$d=s$sd.mainContext;s$d.colorMask(!1,!1,!1,!1),s$d.stencilOp(7680,7680,7683)},s$d.do8=function(){var s$d=s$sd.mainContext;s$d.colorMask(!0,!0,!0,!0),s$d.stencilFunc(514,this.level,255),s$d.stencilOp(7680,7680,7680)},s$u.restore=function(s$d,s$L,s$l,s$Z,s$h){var s$_;if((s$d._renderKey=0)<s$u._mask&&s$u._mask--,0==s$u._mask)s$_=laya.webgl.submit.SubmitStencil.create(3),s$d.addRenderObject(s$_),s$d._curSubmit=s$_d.RENDERBASE;else{s$_=laya.webgl.submit.SubmitStencil.create(7),s$d.addRenderObject(s$_);var s$N=s$d._vb;s$N._byteLength;if(s$ad.fillRectImgVb(s$N,null,s$L.x,s$L.y,s$L.width,s$L.height,s$X.DEF_UV,s$l,s$Z,s$h,0,0)){s$d._shader2D.glTexture=null;var s$m=s$d._curSubmit=s$_d.createSubmit(s$d,s$d._ib,s$N,(s$N._byteLength-64)/32*3,s$Od.create(2,0));s$m.shaderValue.ALPHA=1,s$d._submits[s$d._submits._length++]=s$m,s$d._curSubmit._numEle+=6,s$d._curSubmit=s$_d.RENDERBASE}else alert("clipRect calc stencil rect error");s$_=laya.webgl.submit.SubmitStencil.create(8),s$d.addRenderObject(s$_)}},s$u.restore2=function(s$d,s$L){var s$l;(s$d._renderKey=0)<s$u._mask&&s$u._mask--,0==s$u._mask?(s$l=laya.webgl.submit.SubmitStencil.create(3),s$d.addRenderObject(s$l),s$d._curSubmit=s$_d.RENDERBASE):(s$l=laya.webgl.submit.SubmitStencil.create(7),s$d.addRenderObject(s$l),s$d._submits[s$d._submits._length++]=s$L,s$l=laya.webgl.submit.SubmitStencil.create(8),s$d.addRenderObject(s$l))},s$u.create=function(s$d){var s$L=s$u._cache._length?s$u._cache[--s$u._cache._length]:new s$u;return 5==(s$L.step=s$d)&&++s$u._mask,s$L.level=s$u._mask,s$L},s$u._cache=((s$u._cache=[])._length=0,s$u._cache),s$u._mask=0,s$u}(),s$bd=function(){function s$m(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}s$q(s$m,"laya.webgl.submit.SubmitTarget");var s$d=s$m.prototype;return s$y.imps(s$d,{"laya.webgl.submit.ISubmit":!0}),s$d.renderSubmit=function(){this._vb.bind_upload(this._ib);var s$d=this.scope.getValue(this.proName);return s$d&&(this.shaderValue.texture=s$d.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[s$d.width,s$d.height]),this.shaderValue.upload(),this.blend(),s$E.drawCall++,s$E.trianglesFaces+=this._numEle/3,s$sd.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},s$d.blend=function(){if(s$P.activeBlendFunction!==s$P.fns[this.blendType]){var s$d=s$sd.mainContext;s$d.enable(3042),s$P.fns[this.blendType](s$d),s$P.activeBlendFunction=s$P.fns[this.blendType]}},s$d.getRenderType=function(){return 0},s$d.releaseRender=function(){var s$d=s$m._cache;(s$d[s$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},s$m.create=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$m._cache._length?s$m._cache[--s$m._cache._length]:new s$m;return s$N._ib=s$L,s$N._vb=s$l,s$N.proName=s$_,s$N._startIdx=s$Z*s$rd.BYTES_PIDX,s$N._numEle=0,s$N.blendType=s$d._nBlendType,s$N.shaderValue=s$h,s$N.shaderValue.setValue(s$d._shader2D),s$N},s$m._cache=((s$m._cache=[])._length=0,s$m._cache),s$m}(),s$qd=function(){function s$d(){this._sourceStr=null}s$q(s$d,"laya.webgl.text.CharSegment");var s$L=s$d.prototype;return s$y.imps(s$L,{"laya.webgl.text.ICharSegment":!0}),s$L.textToSpit=function(s$d){this._sourceStr=s$d},s$L.getChar=function(s$d){return this._sourceStr.charAt(s$d)},s$L.getCharCode=function(s$d){return this._sourceStr.charCodeAt(s$d)},s$L.length=function(){return this._sourceStr.length},s$d}(),s$Yd=function(){var s$d;function s$E(){}return s$q(s$E,"laya.webgl.text.DrawText"),s$E.__init__=function(){s$E._charsTemp=new Array,s$E._drawValue=new s$d,s$E._charSeg=new s$qd},s$E.customCharSeg=function(s$d){s$E._charSeg=s$d},s$E.getChar=function(s$d,s$L,s$l){var s$Z=s$Dd.createOneChar(s$d,s$l);return-1!=s$L&&(s$E._charsCache[s$L]=s$Z),s$Z},s$E._drawSlow=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q,s$Y,s$c){var s$r,s$a,s$k=s$E._drawValue.value(s$_,s$m,s$u,s$x,s$q,s$Y,s$c),s$e=0,s$w=0,s$s=s$E._charsTemp,s$A=0,s$y=NaN;if(s$Z)for(s$s.length=s$Z.length,s$e=0,s$w=s$Z.length;s$e<s$w;s$e++)(s$a=s$Z[s$e])&&(s$y=s$a.charNum+s$k.txtID,s$s[s$e]=s$r=s$E._charsCache[s$y]||s$E.getChar(s$a.char,s$y,s$k),s$r.active());else{var s$$=s$l instanceof laya.utils.WordText?s$l.toString():s$l;if(s$H.CharacterCache){s$E._charSeg.textToSpit(s$$);var s$O=s$E._charSeg.length();for(s$e=0,s$w=s$s.length=s$O;s$e<s$w;s$e++)s$y=s$E._charSeg.getCharCode(s$e)+s$k.txtID,s$s[s$e]=s$r=s$E._charsCache[s$y]||s$E.getChar(s$E._charSeg.getChar(s$e),s$y,s$k),s$r.active(),s$A+=s$r.cw}else s$s.length=0,(s$r=s$E.getChar(s$$,-1,s$k)).active(),s$A+=s$r.cw,s$s[0]=s$r}var s$n=0;null!==s$N&&"left"!==s$N&&(s$n=-("center"==s$N?s$A/2:s$A));var s$V,s$Q,s$g=NaN,s$F=0;if(s$Z)for(s$e=0,s$w=s$s.length;s$e<s$w;s$e++)s$r=s$s[s$e],s$a=s$Z[s$e],s$r&&s$a&&!s$r.isSpace&&(s$g=s$r.borderSize,s$V=s$r.texture,s$L._drawText(s$V,s$t+s$n+s$a.x*s$q-s$g,s$b+s$a.y*s$Y-s$g,s$V.width,s$V.height,s$h,0,0,0,0));else{for(s$e=0,s$w=s$s.length;s$e<s$w;s$e++)(s$r=s$s[s$e])&&!s$r.isSpace&&(s$g=s$r.borderSize,s$V=s$r.texture,s$L._drawText(s$V,s$t+s$n-s$g,s$b-s$g,s$V.width,s$V.height,s$h,0,0,0,0),s$d&&((s$Q=s$d[s$F++])||(s$Q=s$d[s$F-1]=[]),s$Q[0]=s$V,s$Q[1]=s$n-s$g,s$Q[2]=-s$g)),s$n+=s$r.cw;s$d&&(s$d.length=s$F)}},s$E._drawFast=function(s$d,s$L,s$l,s$Z,s$h){for(var s$_,s$N,s$m=0,s$u=s$d.length;s$m<s$u;s$m++)(s$_=(s$N=s$d[s$m])[0]).active(),s$L._drawText(s$_,s$Z+s$N[1],s$h+s$N[2],s$_.width,s$_.height,s$l,0,0,0,0)},s$E.drawText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b){if(void 0===s$b&&(s$b=0),!(s$L&&0===s$L.length||s$l&&0===s$l.length)){var s$q=s$Z.a,s$Y=s$Z.d;(0!==s$Z.b||0!==s$Z.c)&&(s$q=s$Y=1);var s$c=1!==s$q||1!==s$Y;if(s$c&&s$y.stage.transform){var s$r=s$y.stage.transform;s$c=s$r.a===s$q&&s$r.d===s$Y}else s$c=!1;if(s$c){var s$a=(s$Z=s$Z.copyTo(s$$d._tmpMatrix)).tx,s$k=s$Z.ty;s$Z.scale(1/s$q,1/s$Y),s$Z._checkTransform(),s$x*=s$q,s$t*=s$Y,s$x+=s$a-s$Z.tx,s$t+=s$k-s$Z.ty}else s$q=s$Y=1;if(s$l)s$E._drawSlow(null,s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$q,s$Y,s$b);else{if(null===s$L.toUpperCase){var s$e=s$q+1e5*s$Y,s$w=s$L;return void(s$w.changed||s$w.id!==s$e?(s$w.id=s$e,s$w.changed=!1,s$E._drawSlow(s$w.save,s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$q,s$Y,s$b)):s$E._drawFast(s$w.save,s$d,s$Z,s$x,s$t))}var s$s=s$L+s$h.toString()+s$N+s$m+s$u+s$q+s$Y+s$_,s$A=s$E._textsCache[s$s];s$H.CharacterCache?s$A?s$E._drawFast(s$A,s$d,s$Z,s$x,s$t):(s$E._textsCache.__length||(s$E._textsCache.__length=0),s$E._textsCache.__length>s$$.WebGLTextCacheCount&&((s$E._textsCache={}).__length=0,s$E._curPoolIndex=0),s$E._textCachesPool[s$E._curPoolIndex]?(s$A=s$E._textsCache[s$s]=s$E._textCachesPool[s$E._curPoolIndex]).length=0:s$E._textCachesPool[s$E._curPoolIndex]=s$A=s$E._textsCache[s$s]=[],s$E._textsCache.__length++,s$E._curPoolIndex++,s$E._drawSlow(s$A,s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$q,s$Y,s$b)):s$E._drawSlow(s$A,s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$q,s$Y,s$b)}}},s$E._charsTemp=null,s$E._textCachesPool=[],s$E._curPoolIndex=0,s$E._charsCache={},s$E._textsCache={},s$E._drawValue=null,s$E.d=[],s$E._charSeg=null,s$E.__init$=function(){s$d=function(){function s$u(){}return s$q(s$u,""),s$u.prototype.value=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this.font=s$d,this.fillColor=s$L,this.borderColor=s$l,this.lineWidth=s$Z,this.scaleX=s$h,this.scaleY=s$_,this.underLine=s$N;var s$m=s$d.toString()+s$h+s$_+s$Z+(s$L?s$L.toLowerCase():" ")+(s$l?s$l.toLowerCase():" ")+s$N;return this.txtID=s$u._keymap[s$m],this.txtID||(this.txtID=1e-7*++s$u._keymapCount,s$u._keymap[s$m]=this.txtID),this},s$u.clear=function(){s$u._keymap={},s$u._keymapCount=1},s$u._keymap={},s$u._keymapCount=1,s$u}()},s$E}(),s$cd=function(){function s$h(s$d){this._index=0,this._size=14,this._italic=-2,s$h._cache2=s$h._cache2||[],this.setFont(s$d||"14px Arial")}s$q(s$h,"laya.webgl.text.FontInContext");var s$d=s$h.prototype;return s$d.setFont=function(s$d){var s$L=s$h._cache2[s$d];if(s$L)this._words=s$L[0],this._size=s$L[1];else{this._words=s$d.split(" ");for(var s$l=0,s$Z=this._words.length;s$l<s$Z;s$l++)if(0<this._words[s$l].indexOf("px")){this._index=s$l;break}this._size=parseInt(this._words[this._index]),s$h._cache2[s$d]=[this._words,this._size]}this._text=null,this._italic=-2},s$d.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},s$d.hasType=function(s$d){for(var s$L=0,s$l=this._words.length;s$L<s$l;s$L++)if(this._words[s$L]===s$d)return s$L;return-1},s$d.removeType=function(s$d){for(var s$L=0,s$l=this._words.length;s$L<s$l;s$L++)if(this._words[s$L]===s$d){this._words.splice(s$L,1),this._index>s$L&&this._index--;break}this._text=null,this._italic=-2},s$d.copyTo=function(s$d){return s$d._text=this._text,s$d._size=this._size,s$d._index=this._index,s$d._words=this._words.slice(),s$d._italic=-2,s$d},s$d.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},s$Z(0,s$d,"size",function(){return this._size},function(s$d){this._size=s$d,this._words[this._index]=s$d+"px",this._text=null}),s$h.create=function(s$d){var s$L=s$h._cache[s$d];return s$L||(s$L=s$h._cache[s$d]=new s$h(s$d))},s$h.EMPTY=new s$h,s$h._cache={},s$h._cache2=null,s$h}(),s$rd=function(){function s$d(){}return s$q(s$d,"laya.webgl.utils.CONST3D2D"),s$d.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s$d.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],s$d.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],s$d._TMPARRAY=[],s$d._OFFSETX=0,s$d._OFFSETY=0,s$N(s$d,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),s$d}(),s$ad=function(){function s$c(){}return s$q(s$c,"laya.webgl.utils.GlUtils"),s$c.make2DProjection=function(s$d,s$L,s$l){return[2/s$d,0,0,0,0,-2/s$L,0,0,0,0,2/s$l,0,-1,1,0,1]},s$c.fillIBQuadrangle=function(s$d,s$L){if(65535/4<s$L)throw Error("IBQuadrangle count:"+s$L+" must<:"+Math.floor(65535/4));s$L=Math.floor(s$L),s$d._resizeBuffer(6*(s$L+1)*2,!1),s$d.byteLength=s$d.bufferLength;for(var s$l=s$d.getUint16Array(),s$Z=0,s$h=0;s$h<s$L;s$h++)s$l[s$Z++]=4*s$h,s$l[s$Z++]=4*s$h+2,s$l[s$Z++]=4*s$h+1,s$l[s$Z++]=4*s$h,s$l[s$Z++]=4*s$h+3,s$l[s$Z++]=4*s$h+2;return s$d.setNeedUpload(),!0},s$c.expandIBQuadrangle=function(s$d,s$L){s$d.bufferLength>=6*s$L*2||s$c.fillIBQuadrangle(s$d,s$L)},s$c.mathCeilPowerOfTwo=function(s$d){return s$d--,s$d|=s$d>>1,s$d|=s$d>>2,s$d|=s$d>>4,s$d|=s$d>>8,s$d|=s$d>>16,++s$d},s$c.fillQuadrangleImgVb=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=16+(s$d._byteLength>>2);s$d.byteLength=s$u<<2;var s$x=s$d.getFloat32Array();s$x[(s$u-=16)+2]=s$h[0],s$x[s$u+3]=s$h[1],s$x[s$u+6]=s$h[2],s$x[s$u+7]=s$h[3],s$x[s$u+10]=s$h[4],s$x[s$u+11]=s$h[5],s$x[s$u+14]=s$h[6],s$x[s$u+15]=s$h[7];var s$t=s$_.a,s$b=s$_.b,s$q=s$_.c,s$Y=s$_.d;if(1!==s$t||0!==s$b||0!==s$q||1!==s$Y){s$_.bTransform=!0;var s$c=s$_.tx+s$N,s$r=s$_.ty+s$m;s$x[s$u]=(s$Z[0]+s$L)*s$t+(s$Z[1]+s$l)*s$q+s$c,s$x[s$u+1]=(s$Z[0]+s$L)*s$b+(s$Z[1]+s$l)*s$Y+s$r,s$x[s$u+4]=(s$Z[2]+s$L)*s$t+(s$Z[3]+s$l)*s$q+s$c,s$x[s$u+5]=(s$Z[2]+s$L)*s$b+(s$Z[3]+s$l)*s$Y+s$r,s$x[s$u+8]=(s$Z[4]+s$L)*s$t+(s$Z[5]+s$l)*s$q+s$c,s$x[s$u+9]=(s$Z[4]+s$L)*s$b+(s$Z[5]+s$l)*s$Y+s$r,s$x[s$u+12]=(s$Z[6]+s$L)*s$t+(s$Z[7]+s$l)*s$q+s$c,s$x[s$u+13]=(s$Z[6]+s$L)*s$b+(s$Z[7]+s$l)*s$Y+s$r}else s$_.bTransform=!1,s$L+=s$_.tx+s$N,s$l+=s$_.ty+s$m,s$x[s$u]=s$L+s$Z[0],s$x[s$u+1]=s$l+s$Z[1],s$x[s$u+4]=s$L+s$Z[2],s$x[s$u+5]=s$l+s$Z[3],s$x[s$u+8]=s$L+s$Z[4],s$x[s$u+9]=s$l+s$Z[5],s$x[s$u+12]=s$L+s$Z[6],s$x[s$u+13]=s$l+s$Z[7];return s$d._upload=!0},s$c.fillTranglesVB=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m=(s$d._byteLength>>2)+s$Z.length;s$d.byteLength=s$m<<2;var s$u=s$d.getFloat32Array();s$m-=s$Z.length;for(var s$x=s$Z.length,s$t=s$h.a,s$b=s$h.b,s$q=s$h.c,s$Y=s$h.d,s$c=0;s$c<s$x;s$c+=4)if(s$u[s$m+s$c+2]=s$Z[s$c+2],s$u[s$m+s$c+3]=s$Z[s$c+3],1!==s$t||0!==s$b||0!==s$q||1!==s$Y){s$h.bTransform=!0;var s$r=s$h.tx+s$_,s$a=s$h.ty+s$N;s$u[s$m+s$c]=(s$Z[s$c]+s$L)*s$t+(s$Z[s$c+1]+s$l)*s$q+s$r,s$u[s$m+s$c+1]=(s$Z[s$c]+s$L)*s$b+(s$Z[s$c+1]+s$l)*s$Y+s$a}else s$h.bTransform=!1,s$L+=s$h.tx+s$_,s$l+=s$h.ty+s$N,s$u[s$m+s$c]=s$L+s$Z[s$c],s$u[s$m+s$c+1]=s$l+s$Z[s$c+1];return s$d._upload=!0},s$c.copyPreImgVb=function(s$d,s$L,s$l){var s$Z=s$d._byteLength>>2;s$d.byteLength=s$Z+16<<2;for(var s$h=s$d.getFloat32Array(),s$_=0,s$N=s$Z-16;s$_<4;s$_++)s$h[s$Z]=s$h[s$N]+s$L,++s$N,s$h[++s$Z]=s$h[s$N]+s$l,++s$N,s$h[++s$Z]=s$h[s$N],++s$N,s$h[++s$Z]=s$h[s$N],++s$Z,++s$N;s$d._upload=!0},s$c.fillRectImgVb=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q){void 0===s$q&&(s$q=!1);var s$Y,s$c,s$r,s$a,s$k,s$e,s$w,s$s,s$A,s$y,s$$,s$O,s$n,s$V,s$Q,s$g,s$F=1,s$E=s$m.a,s$I=s$m.b,s$p=s$m.c,s$H=s$m.d,s$X=s$L&&s$L.width<99999999;if(1!==s$E||0!==s$I||0!==s$p||1!==s$H?(s$m.bTransform=!0,0===s$I&&0===s$p&&(s$F=23,s$A=s$h+s$l,s$y=s$_+s$Z,s$Y=s$E*s$l+(s$$=s$m.tx+s$u),s$r=s$E*s$A+s$$,s$c=s$H*s$Z+(s$O=s$m.ty+s$x),s$a=s$H*s$y+s$O)):(s$F=23,s$m.bTransform=!1,s$r=(s$Y=s$l+s$m.tx+s$u)+s$h,s$a=(s$c=s$Z+s$m.ty+s$x)+s$_),s$X&&(s$k=s$L.x,s$e=s$L.y,s$w=s$L.width+s$k,s$s=s$L.height+s$e),1!==s$F){if(Math.min(s$Y,s$r)>=s$w)return!1;if(Math.min(s$c,s$a)>=s$s)return!1;if(Math.max(s$r,s$Y)<=s$k)return!1;if(Math.max(s$a,s$c)<=s$e)return!1}var s$j=s$d._byteLength>>2;s$d.byteLength=16+s$j<<2;var s$R=s$d.getFloat32Array();switch(s$R[2+s$j]=s$N[0],s$R[3+s$j]=s$N[1],s$R[6+s$j]=s$N[2],s$R[7+s$j]=s$N[3],s$R[10+s$j]=s$N[4],s$R[11+s$j]=s$N[5],s$R[14+s$j]=s$N[6],s$R[15+s$j]=s$N[7],s$F){case 1:s$$=s$m.tx+s$u,s$O=s$m.ty+s$x;var s$o=s$E*s$l,s$i=s$p*s$Z,s$S=s$H*s$Z,s$B=s$I*s$l,s$C=s$E*(s$A=s$h+s$l),s$P=s$p*(s$y=s$_+s$Z),s$T=s$H*s$y,s$z=s$I*s$A;s$q?(s$n=s$o+s$i+s$$,s$Q=Math.round(s$n)-s$n,s$V=s$S+s$B+s$O,s$g=Math.round(s$V)-s$V,s$R[s$j]=s$n+s$Q,s$R[1+s$j]=s$V+s$g,s$R[4+s$j]=s$C+s$i+s$$+s$Q,s$R[5+s$j]=s$S+s$z+s$O+s$g,s$R[8+s$j]=s$C+s$P+s$$+s$Q,s$R[9+s$j]=s$T+s$z+s$O+s$g,s$R[12+s$j]=s$o+s$P+s$$+s$Q,s$R[13+s$j]=s$T+s$B+s$O+s$g):(s$R[s$j]=s$o+s$i+s$$,s$R[1+s$j]=s$S+s$B+s$O,s$R[4+s$j]=s$C+s$i+s$$,s$R[5+s$j]=s$S+s$z+s$O,s$R[8+s$j]=s$C+s$P+s$$,s$R[9+s$j]=s$T+s$z+s$O,s$R[12+s$j]=s$o+s$P+s$$,s$R[13+s$j]=s$T+s$B+s$O);break;case 23:s$q?(s$n=s$Y+s$t,s$Q=Math.round(s$n)-s$n,s$V=s$c,s$g=Math.round(s$V)-s$V,s$R[s$j]=s$n+s$Q,s$R[1+s$j]=s$V+s$g,s$R[4+s$j]=s$r+s$t+s$Q,s$R[5+s$j]=s$c+s$g,s$R[8+s$j]=s$r+s$Q,s$R[9+s$j]=s$a+s$g,s$R[12+s$j]=s$Y+s$Q,s$R[13+s$j]=s$a+s$g):(s$R[s$j]=s$Y+s$t,s$R[1+s$j]=s$c,s$R[4+s$j]=s$r+s$t,s$R[5+s$j]=s$c,s$R[8+s$j]=s$r,s$R[9+s$j]=s$a,s$R[12+s$j]=s$Y,s$R[13+s$j]=s$a)}return s$d._upload=!0},s$c.fillLineVb=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=.5*s$N,s$x=s$c._fillLineArray,s$t=-(s$Z-s$_),s$b=s$l-s$h,s$q=Math.sqrt(s$t*s$t+s$b*s$b);s$t/=s$q,s$b/=s$q,s$t*=s$u,s$b*=s$u,s$x[0]=s$l-s$t,s$x[1]=s$Z-s$b,s$x[4]=s$l+s$t,s$x[5]=s$Z+s$b,s$x[8]=s$h+s$t,s$x[9]=s$_+s$b,s$x[12]=s$h-s$t,s$x[13]=s$_-s$b,s$m&&s$m.transformPointArray(s$x,s$x);var s$Y=16+(s$d._byteLength>>2);return s$d.byteLength=s$Y<<2,s$d.insertData(s$x,s$Y-16),!0},s$c._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s$c}(),s$kd=(function(){function s$u(){}s$q(s$u,"laya.webgl.utils.MatirxArray"),s$u.ArrayMul=function(s$d,s$L,s$l){if(s$d)if(s$L)for(var s$Z=NaN,s$h=NaN,s$_=NaN,s$N=NaN,s$m=0;s$m<4;s$m++)s$Z=s$d[s$m],s$h=s$d[s$m+4],s$_=s$d[s$m+8],s$N=s$d[s$m+12],s$l[s$m]=s$Z*s$L[0]+s$h*s$L[1]+s$_*s$L[2]+s$N*s$L[3],s$l[s$m+4]=s$Z*s$L[4]+s$h*s$L[5]+s$_*s$L[6]+s$N*s$L[7],s$l[s$m+8]=s$Z*s$L[8]+s$h*s$L[9]+s$_*s$L[10]+s$N*s$L[11],s$l[s$m+12]=s$Z*s$L[12]+s$h*s$L[13]+s$_*s$L[14]+s$N*s$L[15];else s$u.copyArray(s$d,s$l);else s$u.copyArray(s$L,s$l)},s$u.copyArray=function(s$d,s$L){if(s$d&&s$L)for(var s$l=0;s$l<s$d.length;s$l++)s$L[s$l]=s$d[s$l]}}(),function(){function s$L(s$d,s$L,s$l){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=s$d,this._vb=new s$Md(s$d,35048),s$L&&this._vb._resizeBuffer(s$L,!1),this._ib=new s$Wd,s$l&&this._ib._resizeBuffer(s$l,!1)}s$q(s$L,"laya.webgl.utils.Mesh2D");var s$d=s$L.prototype;return s$d.cloneWithNewVB=function(){var s$d=new s$L(this._stride,0,0);return s$d._ib=this._ib,s$d._quadNum=this._quadNum,s$d._attribInfo=this._attribInfo,s$d},s$d.cloneWithNewVBIB=function(){var s$d=new s$L(this._stride,0,0);return s$d._attribInfo=this._attribInfo,s$d},s$d.getVBW=function(){return this._vb.setNeedUpload(),this._vb},s$d.getVBR=function(){return this._vb},s$d.getIBR=function(){return this._ib},s$d.getIBW=function(){return this._ib.setNeedUpload(),this._ib},s$d.createQuadIB=function(s$d){this._quadNum=s$d,this._ib._resizeBuffer(6*s$d*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var s$L=this._ib.getUint16Array(),s$l=0,s$Z=0,s$h=0;s$h<s$d;s$h++)s$L[s$l++]=s$Z,s$L[s$l++]=s$Z+2,s$L[s$l++]=s$Z+1,s$L[s$l++]=s$Z,s$L[s$l++]=s$Z+3,s$L[s$l++]=s$Z+2,s$Z+=4;this._ib.setNeedUpload()},s$d.setAttributes=function(s$d){if(this._attribInfo=s$d,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},s$d.getEleNum=function(){return this._ib.getBuffer().byteLength/2},s$d.releaseMesh=function(){},s$d.destroy=function(){},s$d.clearVB=function(){this._vb.clear()},s$L._gvaoid=0,s$L}()),s$ed=function(){function s$h(){}return s$q(s$h,"laya.webgl.utils.RenderState2D"),s$h.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},s$h.mat2MatArray=function(s$d,s$L){var s$l=s$d,s$Z=s$L;return s$Z[0]=s$l.a,s$Z[1]=s$l.b,s$Z[2]=s$h.EMPTYMAT4_ARRAY[2],s$Z[3]=s$h.EMPTYMAT4_ARRAY[3],s$Z[4]=s$l.c,s$Z[5]=s$l.d,s$Z[6]=s$h.EMPTYMAT4_ARRAY[6],s$Z[7]=s$h.EMPTYMAT4_ARRAY[7],s$Z[8]=s$h.EMPTYMAT4_ARRAY[8],s$Z[9]=s$h.EMPTYMAT4_ARRAY[9],s$Z[10]=s$h.EMPTYMAT4_ARRAY[10],s$Z[11]=s$h.EMPTYMAT4_ARRAY[11],s$Z[12]=s$l.tx,s$Z[13]=s$l.ty,s$Z[14]=s$h.EMPTYMAT4_ARRAY[14],s$Z[15]=s$h.EMPTYMAT4_ARRAY[15],s$L},s$h.restoreTempArray=function(){s$h.TEMPMAT4_ARRAY[0]=1,s$h.TEMPMAT4_ARRAY[1]=0,s$h.TEMPMAT4_ARRAY[4]=0,s$h.TEMPMAT4_ARRAY[5]=1,s$h.TEMPMAT4_ARRAY[12]=0,s$h.TEMPMAT4_ARRAY[13]=0},s$h.clear=function(){s$h.worldScissorTest=!1,s$h.worldShaderDefines=null,s$h.worldFilters=null,s$h.worldAlpha=1,s$h.worldClipRect.x=s$h.worldClipRect.y=0,s$h.worldClipRect.width=s$h.width,s$h.worldClipRect.height=s$h.height,s$h.curRenderTarget=null},s$h._MAXSIZE=99999999,s$h.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s$h.worldMatrix4=s$h.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s$h.worldAlpha=1,s$h.worldScissorTest=!1,s$h.worldFilters=null,s$h.worldShaderDefines=null,s$h.curRenderTarget=null,s$h.width=0,s$h.height=0,s$N(s$h,["worldMatrix",function(){return this.worldMatrix=new s$n},"worldClipRect",function(){return this.worldClipRect=new s$Q(0,0,99999999,99999999)}]),s$h}(),s$wd=function(){var s$e,s$l;function s$w(s$d,s$L,s$l,s$Z,s$h){var s$_=this;function s$N(s$d){var s$L=[],s$l=new s$e(s$L);return s$_._compileToTree(s$l,s$d.split("\n"),0,s$L,s$h),s$l}var s$m=s$Y.now();this._VS=s$N(s$L),this._PS=s$N(s$l),this._nameMap=s$Z,2<s$Y.now()-s$m&&console.log("ShaderCompile use time:"+(s$Y.now()-s$m)+"  size:"+s$L.length+"/"+s$l.length)}s$q(s$w,"laya.webgl.utils.ShaderCompile");var s$d=s$w.prototype;return s$d._compileToTree=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q=0,s$Y=0,s$c=0,s$r=0;for(s$Y=s$l;s$Y<s$L.length;s$Y++)if(!((s$m=s$L[s$Y]).length<1)&&0!==(s$q=s$m.indexOf("//"))){if(0<=s$q&&(s$m=s$m.substr(0,s$q)),s$_=s$b||new s$e(s$Z),s$b=null,s$_.text=s$m,s$_.noCompile=!0,0<=(s$q=s$m.indexOf("#"))){for(s$u="#",s$r=s$q+1,s$c=s$m.length;s$r<s$c;s$r++){var s$a=s$m.charAt(s$r);if(" "===s$a||"\t"===s$a||"\r"===s$a||"\n"===s$a||"?"===s$a)break;s$u+=s$a}switch(s$_.name=s$u){case"#ifdef":case"#ifndef":if(s$_.src=s$m,s$_.noCompile=null!=s$m.match(/[!&|()=<>]/),s$_.noCompile?console.log("function():Boolean{return "+s$m.substr(s$q+s$_.name.length)+"}"):(s$t=s$m.replace(/^\s*/,"").split(/\s+/),s$_.setCondition(s$t[1],"#ifdef"===s$u?1:2),s$_.text="//"+s$_.text),s$_.setParent(s$d),s$d=s$_,s$h)for(s$t=s$m.substr(s$r).split(s$w._splitToWordExps3),s$r=0;s$r<s$t.length;s$r++)(s$m=s$t[s$r]).length&&(s$h[s$m]=!0);continue;case"#if":if(s$_.src=s$m,s$_.noCompile=!0,s$_.setParent(s$d),s$d=s$_,s$h)for(s$t=s$m.substr(s$r).split(s$w._splitToWordExps3),s$r=0;s$r<s$t.length;s$r++)(s$m=s$t[s$r]).length&&"defined"!=s$m&&(s$h[s$m]=!0);continue;case"#else":s$_.src=s$m,s$N=(s$d=s$d.parent).childs[s$d.childs.length-1],s$_.noCompile=s$N.noCompile,s$_.noCompile||(s$_.condition=s$N.condition,s$_.conditionType=1==s$N.conditionType?2:1,s$_.text="//"+s$_.text+" "+s$N.text+" "+s$_.conditionType),s$_.setParent(s$d),s$d=s$_;continue;case"#endif":s$N=(s$d=s$d.parent).childs[s$d.childs.length-1],s$_.noCompile=s$N.noCompile,s$_.noCompile||(s$_.text="//"+s$_.text),s$_.setParent(s$d);continue;case"#include":s$t=s$w.splitToWords(s$m,null);var s$k=s$w.includes[s$t[1]];if(!s$k)throw"ShaderCompile error no this include file:"+s$t[1];if((s$q=s$t[0].indexOf("?"))<0){s$_.setParent(s$d),s$m=s$k.getWith("with"==s$t[2]?s$t[3]:null),this._compileToTree(s$_,s$m.split("\n"),0,s$Z,s$h),s$_.text="";continue}s$_.setCondition(s$t[0].substr(s$q+1),1),s$_.text=s$k.getWith("with"==s$t[2]?s$t[3]:null);break;case"#import":s$x=(s$t=s$w.splitToWords(s$m,null))[1],s$Z.push({node:s$_,file:s$w.includes[s$x],ofs:s$_.text.length});continue}}else{if((s$N=s$d.childs[s$d.childs.length-1])&&!s$N.name){0<s$Z.length&&s$w.splitToWords(s$m,s$N),s$b=s$_,s$N.text+="\n"+s$m;continue}0<s$Z.length&&s$w.splitToWords(s$m,s$_)}s$_.setParent(s$d)}},s$d.createShader=function(s$d,s$L,s$l){var s$Z={},s$h="";if(s$d)for(var s$_ in s$d)s$h+="#define "+s$_+"\n",s$Z[s$_]=!0;var s$N=this._VS.toscript(s$Z,[]),s$m=this._PS.toscript(s$Z,[]);return(s$l||s$vd.create)(s$h+s$N.join("\n"),s$h+s$m.join("\n"),s$L,this._nameMap)},s$w._parseOne=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N={type:s$w.shaderParamsMap[s$l[s$Z+1]],name:s$l[s$Z+2],size:isNaN(parseInt(s$l[s$Z+3]))?1:parseInt(s$l[s$Z+3])};return s$_&&("attribute"==s$h?s$d.push(s$N):s$L.push(s$N)),":"==s$l[s$Z+3]&&(s$N.type=s$l[s$Z+4],s$Z+=2),s$Z+=2},s$w.addInclude=function(s$d,s$L){if(!s$L||0===s$L.length)throw new Error("add shader include file err:"+s$d);if(s$w.includes[s$d])throw new Error("add shader include file err, has add:"+s$d);s$w.includes[s$d]=new s$l(s$L)},s$w.preGetParams=function(s$d,s$L){var s$l=[s$d,s$L],s$Z={},s$h=[],s$_=[],s$N={},s$m=[];s$Z.attributes=s$h,s$Z.uniforms=s$_,s$Z.defines=s$N;for(var s$u=0,s$x=0,s$t=0;s$t<2;s$t++){s$l[s$t]=s$l[s$t].replace(s$w._removeAnnotation,"");var s$b,s$q=s$l[s$t].match(s$w._reg);for(s$u=0,s$x=s$q.length;s$u<s$x;s$u++){var s$Y=s$q[s$u];if("attribute"==s$Y||"uniform"==s$Y)s$u=s$w._parseOne(s$h,s$_,s$q,s$u,s$Y,!0);else{if("#define"==s$Y){s$m[s$Y=s$q[++s$u]]=1;continue}if("#ifdef"==s$Y){s$N[s$b=s$q[++s$u]]=s$N[s$b]||[];for(s$u++;s$u<s$x;s$u++)if("attribute"==(s$Y=s$q[s$u])||"uniform"==s$Y)s$u=s$w._parseOne(s$h,s$_,s$q,s$u,s$Y,s$m[s$b]);else if("#else"==s$Y)for(s$u++;s$u<s$x;s$u++)if("attribute"==(s$Y=s$q[s$u])||"uniform"==s$Y)s$u=s$w._parseOne(s$h,s$_,s$q,s$u,s$Y,!s$m[s$b]);else if("#endif"==s$Y)break}}}}return s$Z},s$w.splitToWords=function(s$d,s$L){for(var s$l,s$Z,s$h=[],s$_=-1,s$N=0,s$m=s$d.length;s$N<s$m;s$N++)if(s$l=s$d.charAt(s$N),0<=" \t=+-*/&%!<>()'\",;".indexOf(s$l)){if(0<=s$_&&1<s$N-s$_&&(s$Z=s$d.substr(s$_,s$N-s$_),s$h.push(s$Z)),'"'==s$l||"'"==s$l){var s$u=s$d.indexOf(s$l,s$N+1);if(s$u<0)throw"Sharder err:"+s$d;s$h.push(s$d.substr(s$N+1,s$u-s$N-1)),s$N=s$u,s$_=-1;continue}"("==s$l&&s$L&&0<s$h.length&&(s$Z=s$h[s$h.length-1]+";","vec4;main;".indexOf(s$Z)<0&&(s$L.useFuns+=s$Z)),s$_=-1}else s$_<0&&(s$_=s$N);return s$_<s$m&&1<s$m-s$_&&(s$Z=s$d.substr(s$_,s$m-s$_),s$h.push(s$Z)),s$h},s$w.IFDEF_NO=0,s$w.IFDEF_YES=1,s$w.IFDEF_ELSE=2,s$w.IFDEF_PARENT=3,s$w._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),s$w._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),s$w._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),s$w.includes={},s$N(s$w,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),s$w.__init$=function(){s$e=function(){function s$l(s$d){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=s$d}s$q(s$l,"");var s$d=s$l.prototype;return s$d.setParent=function(s$d){s$d.childs.push(this),this.z=s$d.z+1,this.parent=s$d},s$d.setCondition=function(s$d,s$L){s$d&&(this.conditionType=s$L,s$d=s$d.replace(/(\s*$)/g,""),this.condition=function(){return this[s$d]},this.condition.__condition=s$d)},s$d.toscript=function(s$d,s$L){return this._toscript(s$d,s$L,++s$l.__id)},s$d._toscript=function(s$Z,s$h,s$_){if(this.childs.length<1&&!this.text)return s$h;s$h.length;if(this.condition){var s$d=!!this.condition.call(s$Z);if(2===this.conditionType&&(s$d=!s$d),!s$d)return s$h}if(this.text&&s$h.push(this.text),0<this.childs.length&&this.childs.forEach(function(s$d,s$L,s$l){s$d._toscript(s$Z,s$h,s$_)}),0<this.includefiles.length&&0<this.useFuns.length)for(var s$L,s$l=0,s$N=this.includefiles.length;s$l<s$N;s$l++)this.includefiles[s$l].curUseID!=s$_&&0<(s$L=this.includefiles[s$l].file.getFunsScript(this.useFuns)).length&&(this.includefiles[s$l].curUseID=s$_,s$h[0]=s$L+s$h[0]);return s$h},s$l.__id=1,s$l}(),s$l=function(){function s$d(s$d){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=s$d;for(var s$L=0,s$l=0,s$Z=0;!((s$L=s$d.indexOf("#begin",s$L))<0);){for(s$Z=s$L+5;!((s$Z=s$d.indexOf("#end",s$Z))<0)&&"i"===s$d.charAt(s$Z+4);)s$Z+=5;if(s$Z<0)throw"add include err,no #end:"+s$d;s$l=s$d.indexOf("\n",s$L);var s$h=s$w.splitToWords(s$d.substr(s$L,s$l-s$L),null);"code"==s$h[1]?this.codes[s$h[2]]=s$d.substr(s$l+1,s$Z-s$l-1):"function"==s$h[1]&&(s$l=s$d.indexOf("function",s$L),s$l+="function".length,this.funs[s$h[3]]=s$d.substr(s$l+1,s$Z-s$l-1),this.funnames+=s$h[3]+";"),s$L=s$Z+1}}s$q(s$d,"");var s$L=s$d.prototype;return s$L.getWith=function(s$d){var s$L=s$d?this.codes[s$d]:this.script;if(!s$L)throw"get with error:"+s$d;return s$L},s$L.getFunsScript=function(s$d){var s$L="";for(var s$l in this.funs)0<=s$d.indexOf(s$l+";")&&(s$L+=this.funs[s$l]);return s$L},s$d}()},s$w}(),s$sd=function(){function s$N(){}return s$q(s$N,"laya.webgl.WebGL"),s$N._uint8ArraySlice=function(){for(var s$d=this.length,s$L=new Uint8Array(this.length),s$l=0;s$l<s$d;s$l++)s$L[s$l]=this[s$l];return s$L},s$N._float32ArraySlice=function(){for(var s$d=this.length,s$L=new Float32Array(this.length),s$l=0;s$l<s$d;s$l++)s$L[s$l]=this[s$l];return s$L},s$N._uint16ArraySlice=function(s$d){var s$L,s$l=arguments,s$Z=0,s$h=0;if(0===s$l.length)for(s$Z=this.length,s$L=new Uint16Array(s$Z),s$h=0;s$h<s$Z;s$h++)s$L[s$h]=this[s$h];else if(2===s$l.length){var s$_=s$l[0],s$N=s$l[1];if(s$_<s$N)for(s$Z=s$N-s$_,s$L=new Uint16Array(s$Z),s$h=s$_;s$h<s$N;s$h++)s$L[s$h-s$_]=this[s$h];else s$L=new Uint16Array(0)}return s$L},s$N.expandContext=function(){var s$d=s$h.prototype,s$L=CanvasRenderingContext2D.prototype;s$L.fillTrangles=s$d.fillTrangles,s$Jd.__int__(null),s$L.setIBVB=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){void 0===s$u&&(s$u=0),void 0===s$x&&(s$x=0),null===s$l&&(this._ib=this._ib||s$Wd.QuadrangleIB,s$l=this._ib,s$ad.expandIBQuadrangle(s$l,s$Z._byteLength/64+8)),this._setIBVB(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x)},s$L.fillTrangles=function(s$d,s$L,s$l,s$Z,s$h){this._curMat=this._curMat||s$n.create(),this._vb=this._vb||s$Md.create(),this._ib||(this._ib=s$Wd.create(),s$ad.fillIBQuadrangle(this._ib,s$N/4));var s$_=this._vb,s$N=s$Z.length>>4;s$ad.fillTranglesVB(s$_,s$L,s$l,s$Z,s$h||this._curMat,0,0),s$ad.expandIBQuadrangle(this._ib,s$_._byteLength/64+8);var s$m=new s$Od(1,0);s$m.textureHost=s$d;var s$u=new s$Ud("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");s$_._vertType=3,this._setIBVB(s$L,s$l,this._ib,s$_,6*s$N,s$h,s$u,s$m,0,0)}},s$N.enable=function(){if(s$Y.__init__(),s$k.isConchApp&&!s$k.isConchWebGL)return s$A.skinAniSprite=function(){return new s$dd},s$N.expandContext(),!1;if(s$A.getWebGLContext=function(s$d){for(var s$L,s$l=["webgl","experimental-webgl","webkit-3d","moz-webgl"],s$Z=0;s$Z<s$l.length;s$Z++){try{s$L=s$d.getContext(s$l[s$Z],{stencil:s$$.isStencil,alpha:s$$.isAlpha,antialias:s$$.isAntialias,premultipliedAlpha:s$$.premultipliedAlpha,preserveDrawingBuffer:s$$.preserveDrawingBuffer})}catch(s$d){}if(s$L)return s$L}return null},null==(s$N.mainContext=s$A.getWebGLContext(s$k._mainCanvas)))return!1;if(s$k.isWebGL)return!0;s$r.create=function(s$d,s$L){return new s$dL(s$d,s$L)},s$a.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){return new s$Kd(s$d,s$L,s$l,s$Z,s$h,s$_,s$N)},s$k.WebGL=s$N,s$k.isWebGL=!0,s$Yd.__init__(),s$A.createRenderSprite=function(s$d,s$L){return new s$nd(s$d,s$L)},s$A.createWebGLContext2D=function(s$d){return new s$$d(s$d)},s$A.changeWebGLSize=function(s$d,s$L){laya.webgl.WebGL.onStageResize(s$d,s$L)},s$A.createGraphics=function(){return new s$yd};var s$d=s$A.createFilterAction;return s$A.createFilterAction=s$d||function(s$d){return new s$Vd},s$A.clear=function(s$d){s$ed.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var s$L=s$k.context.ctx,s$l=0==s$L._submits._length||s$$.preserveDrawingBuffer?s$c.create(s$d)._color:s$F._wgColor;s$l&&s$L.clearBG(s$l[0],s$l[1],s$l[2],s$l[3]),s$ed.clear()},s$A.addToAtlas=function(s$d,s$L){void 0===s$L&&(s$L=!1);var s$l=s$d.bitmap;s$k.optimizeTextureMemory(s$d.url,s$d)?s$y.__typeof(s$l,"laya.webgl.resource.IMergeAtlasBitmap")&&s$l.allowMerageInAtlas&&s$l.on("recovered",s$d,s$d.addTextureToAtlas):s$l.enableMerageInAtlas=!1},s$A.isAtlas=function(s$d){return s$d instanceof laya.webgl.atlas.AtlasWebGLCanvas},s$B._enable(),s$A.beginFlush=function(){for(var s$d=s$B.instance,s$L=s$d.getAtlaserCount(),s$l=0;s$l<s$L;s$l++){var s$Z=s$d.getAtlaserByIndex(s$l).texture;s$Z._flashCacheImageNeedFlush&&s$A.flashFlushImage(s$Z)}},s$A.drawToCanvas=function(s$d,s$L,s$l,s$Z,s$h,s$_){(s$l<=0||s$Z<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),s$l|=0,s$Z|=0,s$h|=0,s$_|=0;var s$N=s$Rd.create(s$l,s$Z,6408,5121,0,!1);s$N.start(),s$N.clear(0,0,0,0),s$k.context.clear(),s$e.renders[s$L]._fun(s$d,s$k.context,s$h,s$ed.height-s$Z+s$_),s$k.context.flush(),s$N.end();var s$m=s$N.getData(0,0,s$l,s$Z);if(s$N.recycle(),s$m.byteLength==s$l*s$Z*4){var s$u=new s$zd;s$u._canvas=s$Y.createElement("canvas"),s$u.size(s$l,s$Z);var s$x=s$u._canvas.getContext("2d");s$Y.canvas.size(s$l,s$Z);var s$t=s$Y.context,s$b=s$t.createImageData(s$l,s$Z);return s$b.data.set(new Uint8ClampedArray(s$m.buffer)),s$u._imgData=s$b,s$t.putImageData(s$b,0,0),s$x.save(),s$x.translate(0,s$Z),s$x.scale(1,-1),s$x.drawImage(s$Y.canvas.source,0,0),s$x.restore(),s$u}console.log("drawToCanvas error: w:"+s$l+",h:"+s$Z+",datalen:"+s$m.byteLength)},s$A.createFilterAction=function(s$d){var s$L;switch(s$d){case 32:s$L=new s$Vd}return s$L},s$A.addTextureToAtlas=function(s$d){s$d._uvID++,s$B._atlasRestore++,s$d.bitmap.enableMerageInAtlas&&s$B.instance.addToAtlas(s$d)},s$A.getTexturePixels=function(s$d,s$L,s$l,s$Z,s$h){s$k.context.ctx.clear();var s$_=new s$g;s$_.graphics.drawTexture(s$d,-s$L,-s$l);var s$N=s$Rd.create(s$Z,s$h);s$N.start(),s$N.clear(0,0,0,0),s$_.render(s$k.context,0,0),s$k.context.ctx.flush(),s$N.end();for(var s$m=s$N.getData(0,0,s$Z,s$h),s$u=[],s$x=0,s$t=s$h-1;0<=s$t;s$t--)for(var s$b=0;s$b<s$Z;s$b++)s$x=4*(s$t*s$Z+s$b),s$u.push(s$m[s$x]),s$u.push(s$m[s$x+1]),s$u.push(s$m[s$x+2]),s$u.push(s$m[s$x+3]);return s$u},s$A.skinAniSprite=function(){return new s$dd},s$x.create=function(s$d,s$L){var s$l=new s$zd;return s$l._imgData=s$L,s$l.flipY=!1,s$l},s$O._filterStart=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$d.getValue("bounds"),s$N=s$Rd.create(s$_.width,s$_.height);if(s$N.start(),s$N.clear(0,0,0,0),s$d.addValue("src",s$N),s$d.addValue("ScissorTest",s$ed.worldScissorTest),s$ed.worldScissorTest){var s$m=new s$Q;s$m.copyFrom(s$l.ctx._clipRect),s$d.addValue("clipRect",s$m),s$ed.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},s$O._filterEnd=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$d.getValue("bounds");s$d.getValue("src").end();var s$N=s$Rd.create(s$_.width,s$_.height);s$N.start(),s$N.clear(0,0,0,0),s$d.addValue("out",s$N),s$L._set$P("_filterCache",s$N),s$L._set$P("_isHaveGlowFilter",s$d.getValue("_isHaveGlowFilter"))},s$O._EndTarget=function(s$d,s$L){if(s$d.getValue("src").recycle(),s$d.getValue("out").end(),s$d.getValue("ScissorTest")){s$ed.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),s$L.ctx.save();var s$l=s$d.getValue("clipRect");s$L.ctx.clipRect(s$l.x,s$l.y,s$l.width,s$l.height)}},s$O._useSrc=function(s$d){var s$L=s$d.getValue("out");s$L.end(),(s$L=s$d.getValue("src")).start(),s$L.clear(0,0,0,0)},s$O._endSrc=function(s$d){s$d.getValue("src").end()},s$O._useOut=function(s$d){var s$L=s$d.getValue("src");s$L.end(),(s$L=s$d.getValue("out")).start(),s$L.clear(0,0,0,0)},s$O._endOut=function(s$d){s$d.getValue("out").end()},s$O._recycleScope=function(s$d){s$d.recycle()},s$O._filter=function(s$d,s$L,s$l,s$Z){var s$h=this._next;if(s$h){var s$_,s$N,s$m=s$d.filters,s$u=s$m.length;if(1==s$u&&32==s$m[0].type)return s$L.ctx.save(),s$L.ctx.setFilters([s$m[0]]),s$h._fun.call(s$h,s$d,s$L,s$l,s$Z),void s$L.ctx.restore();var s$x=s$md.create(),s$t=s$V.TEMP,s$b=s$L.ctx._getTransformMatrix(),s$q=s$n.create();s$b.copyTo(s$q);var s$Y=0,s$c=0,s$r=!1,s$a=s$d._$P._filterCache?s$d._$P._filterCache:null;if(!s$a||s$d._repaint){s$r=s$d._isHaveGlowFilter(),s$x.addValue("_isHaveGlowFilter",s$r),s$r&&(s$Y=50,s$c=25),(s$N=new s$Q).copyFrom(s$d.getSelfBounds()),s$N.x+=s$d.x,s$N.y+=s$d.y,s$N.x-=s$d.pivotX+4,s$N.y-=s$d.pivotY+4;var s$k=s$N.x,s$e=s$N.y;if(s$N.width+=s$Y+8,s$N.height+=s$Y+8,s$t.x=s$N.x*s$q.a+s$N.y*s$q.c,s$t.y=s$N.y*s$q.d+s$N.x*s$q.b,s$N.x=s$t.x,s$N.y=s$t.y,s$t.x=s$N.width*s$q.a+s$N.height*s$q.c,s$t.y=s$N.height*s$q.d+s$N.width*s$q.b,s$N.width=s$t.x,s$N.height=s$t.y,s$N.width<=0||s$N.height<=0)return;s$a&&s$a.recycle(),s$x.addValue("bounds",s$N);var s$w=s$Nd.create([s$x,s$d,s$L,0,0],s$O._filterStart);s$L.addRenderObject(s$w),s$L.ctx._renderKey=0,s$L.ctx._shader2D.glTexture=null;var s$s=s$d.x-s$k+s$c,s$A=s$d.y-s$e+s$c;s$h._fun.call(s$h,s$d,s$L,s$s,s$A),s$w=s$Nd.create([s$x,s$d,s$L,0,0],s$O._filterEnd),s$L.addRenderObject(s$w);for(var s$y=0;s$y<s$u;s$y++){0!=s$y&&(s$w=s$Nd.create([s$x],s$O._useSrc),s$L.addRenderObject(s$w),s$_=s$Od.create(1,0),s$n.TEMP.identity(),s$L.ctx.drawTarget(s$x,0,0,s$N.width,s$N.height,s$n.TEMP,"out",s$_,null,s$P.TOINT.overlay),s$w=s$Nd.create([s$x],s$O._useOut),s$L.addRenderObject(s$w)),s$m[s$y].action.apply3d(s$x,s$d,s$L,0,0)}s$w=s$Nd.create([s$x,s$L],s$O._EndTarget),s$L.addRenderObject(s$w)}else{if((s$r=!!s$d._$P._isHaveGlowFilter&&s$d._$P._isHaveGlowFilter)&&(s$Y=50,s$c=25),(s$N=s$d.getBounds()).width<=0||s$N.height<=0)return;s$N.width+=s$Y,s$N.height+=s$Y,s$t.x=s$N.x*s$q.a+s$N.y*s$q.c,s$t.y=s$N.y*s$q.d+s$N.x*s$q.b,s$N.x=s$t.x,s$N.y=s$t.y,s$t.x=s$N.width*s$q.a+s$N.height*s$q.c,s$t.y=s$N.height*s$q.d+s$N.width*s$q.b,s$N.width=s$t.x,s$N.height=s$t.y,s$x.addValue("out",s$a)}s$l=s$l-s$c-s$d.x,s$Z=s$Z-s$c-s$d.y,s$t.setTo(s$l,s$Z),s$q.transformPoint(s$t),s$l=s$t.x+s$N.x,s$Z=s$t.y+s$N.y,s$_=s$Od.create(1,0),s$n.TEMP.identity(),s$L.ctx.drawTarget(s$x,s$l,s$Z,s$N.width,s$N.height,s$n.TEMP,"out",s$_,null,s$P.TOINT.overlay),s$w=s$Nd.create([s$x],s$O._recycleScope),s$L.addRenderObject(s$w),s$q.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=s$N._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=s$N._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=s$N._uint8ArraySlice),!0},s$N.onStageResize=function(s$d,s$L){null!=s$N.mainContext&&(s$N.mainContext.viewport(0,0,s$d,s$L),s$ed.width=s$d,s$ed.height=s$L)},s$N.onInvalidGLRes=function(){s$B.instance.freeAll(),s$s.releaseContentManagers(!0),s$N.doNodeRepaint(s$y.stage),s$N.mainContext.viewport(0,0,s$ed.width,s$ed.height),s$y.stage.event("devicelost")},s$N.doNodeRepaint=function(s$d){0==s$d.numChildren&&s$d.repaint();for(var s$L=0;s$L<s$d.numChildren;s$L++)s$N.doNodeRepaint(s$d.getChildAt(s$L))},s$N.init=function(s$d,s$L,s$l){s$N.mainCanvas=s$d,s$x._createContext=function(s$d){return new s$$d(s$d)},s$zd._createContext=function(s$d){return new s$$d(s$d)};var s$Z=laya.webgl.WebGL.mainContext;if(null!=s$Z.getShaderPrecisionFormat){var s$h=s$Z.getShaderPrecisionFormat(35633,36338),s$_=s$Z.getShaderPrecisionFormat(35632,36338);s$N.shaderHighPrecision=!(!s$h.precision||!s$_.precision)}else s$N.shaderHighPrecision=!1;if(s$Z.deleteTexture1=s$Z.deleteTexture,s$Z.deleteTexture=function(s$d){s$d==s$Ad.curBindTexValue&&(s$Ad.curBindTexValue=null),s$Z.deleteTexture1(s$d)},s$N.onStageResize(s$L,s$l),null==s$N.mainContext)throw new Error("webGL getContext err!");s$p.__init__(),s$B.__init__(),s$gd.__init__(),s$_d.__init__(),s$$d.__init__(),s$Od.__init__(),s$W.__init__(),s$Jd.__int__(s$Z),s$P._init_(s$Z),s$k.isConchApp&&conch.setOnInvalidGLRes(s$N.onInvalidGLRes)},s$N.mainCanvas=null,s$N.mainContext=null,s$N.antialias=!0,s$N.shaderHighPrecision=!1,s$N._bg_null=[0,0,0,0],s$N}(),s$Ad=function(){function s$Z(){}return s$q(s$Z,"laya.webgl.WebGLContext"),s$Z.UseProgram=function(s$d){return s$Z._useProgram!==s$d&&(s$sd.mainContext.useProgram(s$d),s$Z._useProgram=s$d,!0)},s$Z.setDepthTest=function(s$d,s$L){s$L!==s$Z._depthTest&&((s$Z._depthTest=s$L)?s$d.enable(2929):s$d.disable(2929))},s$Z.setDepthMask=function(s$d,s$L){s$L!==s$Z._depthMask&&(s$Z._depthMask=s$L,s$d.depthMask(s$L))},s$Z.setDepthFunc=function(s$d,s$L){s$L!==s$Z._depthFunc&&(s$Z._depthFunc=s$L,s$d.depthFunc(s$L))},s$Z.setBlend=function(s$d,s$L){s$L!==s$Z._blend&&((s$Z._blend=s$L)?s$d.enable(3042):s$d.disable(3042))},s$Z.setBlendFunc=function(s$d,s$L,s$l){(s$L!==s$Z._sFactor||s$l!==s$Z._dFactor)&&(s$Z._sFactor=s$L,s$Z._dFactor=s$l,s$d.blendFunc(s$L,s$l))},s$Z.setCullFace=function(s$d,s$L){s$L!==s$Z._cullFace&&((s$Z._cullFace=s$L)?s$d.enable(2884):s$d.disable(2884))},s$Z.setFrontFace=function(s$d,s$L){s$L!==s$Z._frontFace&&(s$Z._frontFace=s$L,s$d.frontFace(s$L))},s$Z.bindTexture=function(s$d,s$L,s$l){s$d.bindTexture(s$L,s$l),s$Z.curBindTexTarget=s$L,s$Z.curBindTexValue=s$l},s$Z.DEPTH_BUFFER_BIT=256,s$Z.STENCIL_BUFFER_BIT=1024,s$Z.COLOR_BUFFER_BIT=16384,s$Z.POINTS=0,s$Z.LINES=1,s$Z.LINE_LOOP=2,s$Z.LINE_STRIP=3,s$Z.TRIANGLES=4,s$Z.TRIANGLE_STRIP=5,s$Z.TRIANGLE_FAN=6,s$Z.ZERO=0,s$Z.ONE=1,s$Z.SRC_COLOR=768,s$Z.ONE_MINUS_SRC_COLOR=769,s$Z.SRC_ALPHA=770,s$Z.ONE_MINUS_SRC_ALPHA=771,s$Z.DST_ALPHA=772,s$Z.ONE_MINUS_DST_ALPHA=773,s$Z.DST_COLOR=774,s$Z.ONE_MINUS_DST_COLOR=775,s$Z.SRC_ALPHA_SATURATE=776,s$Z.FUNC_ADD=32774,s$Z.BLEND_EQUATION=32777,s$Z.BLEND_EQUATION_RGB=32777,s$Z.BLEND_EQUATION_ALPHA=34877,s$Z.FUNC_SUBTRACT=32778,s$Z.FUNC_REVERSE_SUBTRACT=32779,s$Z.BLEND_DST_RGB=32968,s$Z.BLEND_SRC_RGB=32969,s$Z.BLEND_DST_ALPHA=32970,s$Z.BLEND_SRC_ALPHA=32971,s$Z.CONSTANT_COLOR=32769,s$Z.ONE_MINUS_CONSTANT_COLOR=32770,s$Z.CONSTANT_ALPHA=32771,s$Z.ONE_MINUS_CONSTANT_ALPHA=32772,s$Z.BLEND_COLOR=32773,s$Z.ARRAY_BUFFER=34962,s$Z.ELEMENT_ARRAY_BUFFER=34963,s$Z.ARRAY_BUFFER_BINDING=34964,s$Z.ELEMENT_ARRAY_BUFFER_BINDING=34965,s$Z.STREAM_DRAW=35040,s$Z.STATIC_DRAW=35044,s$Z.DYNAMIC_DRAW=35048,s$Z.BUFFER_SIZE=34660,s$Z.BUFFER_USAGE=34661,s$Z.CURRENT_VERTEX_ATTRIB=34342,s$Z.FRONT=1028,s$Z.BACK=1029,s$Z.CULL_FACE=2884,s$Z.FRONT_AND_BACK=1032,s$Z.BLEND=3042,s$Z.DITHER=3024,s$Z.STENCIL_TEST=2960,s$Z.DEPTH_TEST=2929,s$Z.SCISSOR_TEST=3089,s$Z.POLYGON_OFFSET_FILL=32823,s$Z.SAMPLE_ALPHA_TO_COVERAGE=32926,s$Z.SAMPLE_COVERAGE=32928,s$Z.NO_ERROR=0,s$Z.INVALID_ENUM=1280,s$Z.INVALID_VALUE=1281,s$Z.INVALID_OPERATION=1282,s$Z.OUT_OF_MEMORY=1285,s$Z.CW=2304,s$Z.CCW=2305,s$Z.LINE_WIDTH=2849,s$Z.ALIASED_POINT_SIZE_RANGE=33901,s$Z.ALIASED_LINE_WIDTH_RANGE=33902,s$Z.CULL_FACE_MODE=2885,s$Z.FRONT_FACE=2886,s$Z.DEPTH_RANGE=2928,s$Z.DEPTH_WRITEMASK=2930,s$Z.DEPTH_CLEAR_VALUE=2931,s$Z.DEPTH_FUNC=2932,s$Z.STENCIL_CLEAR_VALUE=2961,s$Z.STENCIL_FUNC=2962,s$Z.STENCIL_FAIL=2964,s$Z.STENCIL_PASS_DEPTH_FAIL=2965,s$Z.STENCIL_PASS_DEPTH_PASS=2966,s$Z.STENCIL_REF=2967,s$Z.STENCIL_VALUE_MASK=2963,s$Z.STENCIL_WRITEMASK=2968,s$Z.STENCIL_BACK_FUNC=34816,s$Z.STENCIL_BACK_FAIL=34817,s$Z.STENCIL_BACK_PASS_DEPTH_FAIL=34818,s$Z.STENCIL_BACK_PASS_DEPTH_PASS=34819,s$Z.STENCIL_BACK_REF=36003,s$Z.STENCIL_BACK_VALUE_MASK=36004,s$Z.STENCIL_BACK_WRITEMASK=36005,s$Z.VIEWPORT=2978,s$Z.SCISSOR_BOX=3088,s$Z.COLOR_CLEAR_VALUE=3106,s$Z.COLOR_WRITEMASK=3107,s$Z.UNPACK_ALIGNMENT=3317,s$Z.PACK_ALIGNMENT=3333,s$Z.MAX_TEXTURE_SIZE=3379,s$Z.MAX_VIEWPORT_DIMS=3386,s$Z.SUBPIXEL_BITS=3408,s$Z.RED_BITS=3410,s$Z.GREEN_BITS=3411,s$Z.BLUE_BITS=3412,s$Z.ALPHA_BITS=3413,s$Z.DEPTH_BITS=3414,s$Z.STENCIL_BITS=3415,s$Z.POLYGON_OFFSET_UNITS=10752,s$Z.POLYGON_OFFSET_FACTOR=32824,s$Z.TEXTURE_BINDING_2D=32873,s$Z.SAMPLE_BUFFERS=32936,s$Z.SAMPLES=32937,s$Z.SAMPLE_COVERAGE_VALUE=32938,s$Z.SAMPLE_COVERAGE_INVERT=32939,s$Z.NUM_COMPRESSED_TEXTURE_FORMATS=34466,s$Z.COMPRESSED_TEXTURE_FORMATS=34467,s$Z.DONT_CARE=4352,s$Z.FASTEST=4353,s$Z.NICEST=4354,s$Z.GENERATE_MIPMAP_HINT=33170,s$Z.BYTE=5120,s$Z.UNSIGNED_BYTE=5121,s$Z.SHORT=5122,s$Z.UNSIGNED_SHORT=5123,s$Z.INT=5124,s$Z.UNSIGNED_INT=5125,s$Z.FLOAT=5126,s$Z.DEPTH_COMPONENT=6402,s$Z.ALPHA=6406,s$Z.RGB=6407,s$Z.RGBA=6408,s$Z.LUMINANCE=6409,s$Z.LUMINANCE_ALPHA=6410,s$Z.UNSIGNED_SHORT_4_4_4_4=32819,s$Z.UNSIGNED_SHORT_5_5_5_1=32820,s$Z.UNSIGNED_SHORT_5_6_5=33635,s$Z.FRAGMENT_SHADER=35632,s$Z.VERTEX_SHADER=35633,s$Z.MAX_VERTEX_ATTRIBS=34921,s$Z.MAX_VERTEX_UNIFORM_VECTORS=36347,s$Z.MAX_VARYING_VECTORS=36348,s$Z.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,s$Z.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,s$Z.MAX_TEXTURE_IMAGE_UNITS=34930,s$Z.MAX_FRAGMENT_UNIFORM_VECTORS=36349,s$Z.SHADER_TYPE=35663,s$Z.DELETE_STATUS=35712,s$Z.LINK_STATUS=35714,s$Z.VALIDATE_STATUS=35715,s$Z.ATTACHED_SHADERS=35717,s$Z.ACTIVE_UNIFORMS=35718,s$Z.ACTIVE_ATTRIBUTES=35721,s$Z.SHADING_LANGUAGE_VERSION=35724,s$Z.CURRENT_PROGRAM=35725,s$Z.NEVER=512,s$Z.LESS=513,s$Z.EQUAL=514,s$Z.LEQUAL=515,s$Z.GREATER=516,s$Z.NOTEQUAL=517,s$Z.GEQUAL=518,s$Z.ALWAYS=519,s$Z.KEEP=7680,s$Z.REPLACE=7681,s$Z.INCR=7682,s$Z.DECR=7683,s$Z.INVERT=5386,s$Z.INCR_WRAP=34055,s$Z.DECR_WRAP=34056,s$Z.VENDOR=7936,s$Z.RENDERER=7937,s$Z.VERSION=7938,s$Z.NEAREST=9728,s$Z.LINEAR=9729,s$Z.NEAREST_MIPMAP_NEAREST=9984,s$Z.LINEAR_MIPMAP_NEAREST=9985,s$Z.NEAREST_MIPMAP_LINEAR=9986,s$Z.LINEAR_MIPMAP_LINEAR=9987,s$Z.TEXTURE_MAG_FILTER=10240,s$Z.TEXTURE_MIN_FILTER=10241,s$Z.TEXTURE_WRAP_S=10242,s$Z.TEXTURE_WRAP_T=10243,s$Z.TEXTURE_2D=3553,s$Z.TEXTURE=5890,s$Z.TEXTURE_CUBE_MAP=34067,s$Z.TEXTURE_BINDING_CUBE_MAP=34068,s$Z.TEXTURE_CUBE_MAP_POSITIVE_X=34069,s$Z.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,s$Z.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,s$Z.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,s$Z.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,s$Z.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,s$Z.MAX_CUBE_MAP_TEXTURE_SIZE=34076,s$Z.TEXTURE0=33984,s$Z.TEXTURE1=33985,s$Z.TEXTURE2=33986,s$Z.TEXTURE3=33987,s$Z.TEXTURE4=33988,s$Z.TEXTURE5=33989,s$Z.TEXTURE6=33990,s$Z.TEXTURE7=33991,s$Z.TEXTURE8=33992,s$Z.TEXTURE9=33993,s$Z.TEXTURE10=33994,s$Z.TEXTURE11=33995,s$Z.TEXTURE12=33996,s$Z.TEXTURE13=33997,s$Z.TEXTURE14=33998,s$Z.TEXTURE15=33999,s$Z.TEXTURE16=34e3,s$Z.TEXTURE17=34001,s$Z.TEXTURE18=34002,s$Z.TEXTURE19=34003,s$Z.TEXTURE20=34004,s$Z.TEXTURE21=34005,s$Z.TEXTURE22=34006,s$Z.TEXTURE23=34007,s$Z.TEXTURE24=34008,s$Z.TEXTURE25=34009,s$Z.TEXTURE26=34010,s$Z.TEXTURE27=34011,s$Z.TEXTURE28=34012,s$Z.TEXTURE29=34013,s$Z.TEXTURE30=34014,s$Z.TEXTURE31=34015,s$Z.ACTIVE_TEXTURE=34016,s$Z.REPEAT=10497,s$Z.CLAMP_TO_EDGE=33071,s$Z.MIRRORED_REPEAT=33648,s$Z.FLOAT_VEC2=35664,s$Z.FLOAT_VEC3=35665,s$Z.FLOAT_VEC4=35666,s$Z.INT_VEC2=35667,s$Z.INT_VEC3=35668,s$Z.INT_VEC4=35669,s$Z.BOOL=35670,s$Z.BOOL_VEC2=35671,s$Z.BOOL_VEC3=35672,s$Z.BOOL_VEC4=35673,s$Z.FLOAT_MAT2=35674,s$Z.FLOAT_MAT3=35675,s$Z.FLOAT_MAT4=35676,s$Z.SAMPLER_2D=35678,s$Z.SAMPLER_CUBE=35680,s$Z.VERTEX_ATTRIB_ARRAY_ENABLED=34338,s$Z.VERTEX_ATTRIB_ARRAY_SIZE=34339,s$Z.VERTEX_ATTRIB_ARRAY_STRIDE=34340,s$Z.VERTEX_ATTRIB_ARRAY_TYPE=34341,s$Z.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,s$Z.VERTEX_ATTRIB_ARRAY_POINTER=34373,s$Z.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,s$Z.COMPILE_STATUS=35713,s$Z.LOW_FLOAT=36336,s$Z.MEDIUM_FLOAT=36337,s$Z.HIGH_FLOAT=36338,s$Z.LOW_INT=36339,s$Z.MEDIUM_INT=36340,s$Z.HIGH_INT=36341,s$Z.FRAMEBUFFER=36160,s$Z.RENDERBUFFER=36161,s$Z.RGBA4=32854,s$Z.RGB5_A1=32855,s$Z.RGB565=36194,s$Z.DEPTH_COMPONENT16=33189,s$Z.STENCIL_INDEX=6401,s$Z.STENCIL_INDEX8=36168,s$Z.DEPTH_STENCIL=34041,s$Z.RENDERBUFFER_WIDTH=36162,s$Z.RENDERBUFFER_HEIGHT=36163,s$Z.RENDERBUFFER_INTERNAL_FORMAT=36164,s$Z.RENDERBUFFER_RED_SIZE=36176,s$Z.RENDERBUFFER_GREEN_SIZE=36177,s$Z.RENDERBUFFER_BLUE_SIZE=36178,s$Z.RENDERBUFFER_ALPHA_SIZE=36179,s$Z.RENDERBUFFER_DEPTH_SIZE=36180,s$Z.RENDERBUFFER_STENCIL_SIZE=36181,s$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,s$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,s$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,s$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,s$Z.COLOR_ATTACHMENT0=36064,s$Z.DEPTH_ATTACHMENT=36096,s$Z.STENCIL_ATTACHMENT=36128,s$Z.DEPTH_STENCIL_ATTACHMENT=33306,s$Z.NONE=0,s$Z.FRAMEBUFFER_COMPLETE=36053,s$Z.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,s$Z.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,s$Z.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,s$Z.FRAMEBUFFER_UNSUPPORTED=36061,s$Z.FRAMEBUFFER_BINDING=36006,s$Z.RENDERBUFFER_BINDING=36007,s$Z.MAX_RENDERBUFFER_SIZE=34024,s$Z.INVALID_FRAMEBUFFER_OPERATION=1286,s$Z.UNPACK_FLIP_Y_WEBGL=37440,s$Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,s$Z.CONTEXT_LOST_WEBGL=37442,s$Z.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,s$Z.BROWSER_DEFAULT_WEBGL=37444,s$Z._useProgram=null,s$Z._depthTest=!0,s$Z._depthMask=!0,s$Z._blend=!1,s$Z._cullFace=!1,s$Z.curBindTexTarget=null,s$Z.curBindTexValue=null,s$N(s$Z,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),s$Z}(),s$yd=function(s$d){function s$L(){s$L.__super.call(this)}s$q(s$L,"laya.webgl.display.GraphicsGL",s$m);var s$l=s$L.prototype;return s$l.setShader=function(s$d){this._saveToCmd(s$k.context._setShader,[s$d])},s$l.setIBVB=function(s$d,s$L,s$l,s$Z,s$h,s$_){this._saveToCmd(s$k.context._setIBVB,[s$d,s$L,s$l,s$Z,s$h,s$_])},s$l.drawParticle=function(s$d,s$L,s$l){var s$Z=s$A.createParticleTemplate2D(s$l);s$Z.x=s$d,s$Z.y=s$L,this._saveToCmd(s$k.context._drawParticle,[s$Z])},s$L}(),s$$d=function(s$d){var s$l;function s$S(s$d){this._x=0,this._y=0,this._id=++s$S._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,s$S.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=s$S.MAXCLIPRECT,this.mOutPoint,this._canvas=s$d,this._canvas._addReference(),s$S._contextcount++,s$k.isFlash?(this._ib=s$Wd.create(35044),s$ad.fillIBQuadrangle(this._ib,16)):this._ib=s$Wd.QuadrangleIB,this.clear()}s$q(s$S,"laya.webgl.canvas.WebGLContext2D",s$h);var s$L=s$S.prototype;return s$L.setIsMainContext=function(){this._isMain=!0},s$L.clearBG=function(s$d,s$L,s$l,s$Z){var s$h=s$sd.mainContext;s$h.clearColor(s$d,s$L,s$l,s$Z),s$h.clear(16384)},s$L._getSubmits=function(){return this._submits},s$L._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var s$d=0,s$L=this._submits._length;s$d<s$L;s$d++)this._submits[s$d].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},s$L.destroy=function(){--s$S._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=s$Wd.QuadrangleIB&&this._ib.releaseResource()},s$L.clear=function(){this._submits||(this._other=s$l.DEFAULT,this._curMat=s$n.create(),this._vb=s$Md.create(-1),this._submits=[],this._save=[s$v.Create(this)],this._save.length=10,this._shader2D=new s$W,this._triangleMesh=s$Xd.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=s$l.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=s$S.MAXCLIPRECT,this._curSubmit=s$_d.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=s$T.DEFAULT;for(var s$d=0,s$L=this._submits._length;s$d<s$L;s$d++)this._submits[s$d].releaseRender(),this._submits[s$d]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},s$L.size=function(s$d,s$L){if(this._width!=s$d||this._height!=s$L)if(0==s$d||0==s$L){0!=this._vb._byteLength&&(this._width=s$d,this._height=s$L,this._vb.clear(),this._vb.upload());for(var s$l=0,s$Z=this._submits._length;s$l<s$Z;s$l++)this._submits[s$l].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=s$d,this._height=s$L,this._targets&&this._targets.size(s$d,s$L),this._canvas.memorySize-=this._canvas.memorySize;0===s$d&&0===s$L&&this._releaseMem()},s$L._getTransformMatrix=function(){return this._curMat},s$L.translate=function(s$d,s$L){0===s$d&&0===s$L||(s$f.save(this),this._curMat.bTransform&&(s$J.save(this),this._curMat.transformPointN(s$V.TEMP.setTo(s$d,s$L)),s$d=s$V.TEMP.x,s$L=s$V.TEMP.y),this._x+=s$d,this._y+=s$L)},s$L.save=function(){this._save[this._save._length++]=s$v.Create(this)},s$L.restore=function(){var s$d=this._save._length;if(!(s$d<1))for(var s$L=s$d-1;0<=s$L;s$L--){var s$l=this._save[s$L];if(s$l.restore(this),s$l.isSaveMark())return void(this._save._length=s$L)}},s$L._fillText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){void 0===s$x&&(s$x=0);var s$t=this._shader2D,s$b=this._curSubmit.shaderValue,s$q=s$h?s$cd.create(s$h):this._other.font;if(s$B.enabled)s$t.ALPHA!==s$b.ALPHA&&(s$t.glTexture=null),s$Yd.drawText(this,s$d,s$L,this._curMat,s$q,s$u||this._other.textAlign,s$_,s$N,s$m,s$l,s$Z,s$x);else{this._shader2D.defines.getValue();var s$Y=s$_?s$c.create(s$_)._color:s$t.colorAdd;s$t.ALPHA===s$b.ALPHA&&s$Y===s$t.colorAdd&&s$b.colorAdd===s$t.colorAdd||(s$t.glTexture=null,s$t.colorAdd=s$Y),s$Yd.drawText(this,s$d,s$L,this._curMat,s$q,s$u||this._other.textAlign,s$_,s$N,s$m,s$l,s$Z,s$x)}},s$L.fillWords=function(s$d,s$L,s$l,s$Z,s$h,s$_){this._fillText(null,s$d,s$L,s$l,s$Z,s$h,null,-1,null,s$_)},s$L.fillBorderWords=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._fillBorderText(null,s$d,s$L,s$l,s$Z,s$h,s$_,s$N,null)},s$L.fillText=function(s$d,s$L,s$l,s$Z,s$h,s$_){this._fillText(s$d,null,s$L,s$l,s$Z,s$h,null,-1,s$_)},s$L.strokeText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._fillText(s$d,null,s$L,s$l,s$Z,null,s$h,s$_||1,s$N)},s$L.fillBorderText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){this._fillBorderText(s$d,null,s$L,s$l,s$Z,s$h,s$_,s$N,s$m)},s$L._fillBorderText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){if(!s$B.enabled)return this._fillText(s$d,s$L,s$l,s$Z,s$h,null,s$N,s$m||1,s$u),void this._fillText(s$d,s$L,s$l,s$Z,s$h,s$_,null,-1,s$u);var s$x=this._shader2D,s$t=this._curSubmit.shaderValue;s$x.ALPHA!==s$t.ALPHA&&(s$x.glTexture=null);var s$b=s$h?(s$S._fontTemp.setFont(s$h),s$S._fontTemp):this._other.font;s$Yd.drawText(this,s$d,s$L,this._curMat,s$b,s$u||this._other.textAlign,s$_,s$N,s$m||1,s$l,s$Z,0)},s$L.fillRect=function(s$d,s$L,s$l,s$Z,s$h){var s$_=this._vb;if(s$ad.fillRectImgVb(s$_,this._clipRect,s$d,s$L,s$l,s$Z,s$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var s$N=this._shader2D.fillStyle;s$h&&(this._shader2D.fillStyle=s$T.create(s$h));var s$m=this._shader2D,s$u=this._curSubmit.shaderValue;if(s$m.fillStyle!==s$u.fillStyle||s$m.ALPHA!==s$u.ALPHA){s$m.glTexture=null;var s$x=this._curSubmit=s$_d.createSubmit(this,this._ib,s$_,(s$_._byteLength-64)/32*3,s$Od.create(2,0));s$x.shaderValue.color=s$m.fillStyle._color._color,s$x.shaderValue.ALPHA=s$m.ALPHA,this._submits[this._submits._length++]=s$x}this._curSubmit._numEle+=6,this._shader2D.fillStyle=s$N}},s$L.fillTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){if(s$d.loaded&&s$d.bitmap&&s$d.source){var s$u=this._vb,s$x=s$d.bitmap.width,s$t=s$d.bitmap.height,s$b=s$d.uv,s$q=s$N.x%s$d.width,s$Y=s$N.y%s$d.height;if(s$x!=s$m.w||s$t!=s$m.h){if(!s$m.w&&!s$m.h)switch(s$m.oy=s$m.ox=0,s$_){case"repeat":s$m.width=s$Z,s$m.height=s$h;break;case"repeat-x":s$m.width=s$Z,s$Y<0?s$d.height+s$Y>s$h?s$m.height=s$h:s$m.height=s$d.height+s$Y:(s$m.oy=s$Y,s$d.height+s$Y>s$h?s$m.height=s$h-s$Y:s$m.height=s$d.height);break;case"repeat-y":s$q<0?s$d.width+s$q>s$Z?s$m.width=s$Z:s$m.width=s$d.width+s$q:(s$m.ox=s$q,s$d.width+s$q>s$Z?s$m.width=s$Z-s$q:s$m.width=s$d.width),s$m.height=s$h;break;case"no-repeat":s$q<0?s$d.width+s$q>s$Z?s$m.width=s$Z:s$m.width=s$d.width+s$q:(s$m.ox=s$q,s$d.width+s$q>s$Z?s$m.width=s$Z-s$q:s$m.width=s$d.width),s$Y<0?s$d.height+s$Y>s$h?s$m.height=s$h:s$m.height=s$d.height+s$Y:(s$m.oy=s$Y,s$d.height+s$Y>s$h?s$m.height=s$h-s$Y:s$m.height=s$d.height);break;default:s$m.width=s$Z,s$m.height=s$h}s$m.w=s$x,s$m.h=s$t,s$m.uv=[0,0,s$m.width/s$x,0,s$m.width/s$x,s$m.height/s$t,0,s$m.height/s$t]}if(s$L+=s$m.ox,s$l+=s$m.oy,s$q-=s$m.ox,s$Y-=s$m.oy,s$ad.fillRectImgVb(s$u,this._clipRect,s$L,s$l,s$m.width,s$m.height,s$m.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var s$c=s$Hd.create(this,this._ib,s$u,(s$u._byteLength-64)/32*3,s$Od.create(256,0)),s$r=(this._submits[this._submits._length++]=s$c).shaderValue;s$r.textureHost=s$d;var s$a=s$b[0]*s$x,s$k=s$b[1]*s$t,s$e=(s$b[2]-s$b[0])*s$x,s$w=(s$b[5]-s$b[3])*s$t,s$s=-s$q/s$x,s$A=-s$Y/s$t;s$r.u_TexRange[0]=s$a/s$x,s$r.u_TexRange[1]=s$e/s$x,s$r.u_TexRange[2]=s$k/s$t,s$r.u_TexRange[3]=s$w/s$t,s$r.u_offset[0]=s$s,s$r.u_offset[1]=s$A,s$B.enabled&&!this._isMain&&s$c.addTexture(s$d,(s$u._byteLength>>2)-16),(this._curSubmit=s$c)._renderType=10017,s$c._numEle+=6}}else this.sprite&&s$y.timer.callLater(this,this._repaintSprite)},s$L.setShader=function(s$d){s$D.save(this,1048576,this._shader2D,!0),this._shader2D.shader=s$d},s$L.setFilters=function(s$d){s$D.save(this,2097152,this._shader2D,!0),this._shader2D.filters=s$d,this._curSubmit=s$_d.RENDERBASE,this._renderKey=0,this._drawCount++},s$L.drawTexture=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._drawTextureM(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,null,1)},s$L.addTextureVb=function(s$d,s$L,s$l){var s$Z=this._curSubmit._vb||this._vb,s$h=s$Z._byteLength>>2;s$Z.byteLength=s$h+16<<2;for(var s$_=s$Z.getFloat32Array(),s$N=0;s$N<16;s$N+=4)s$_[s$h++]=s$d[s$N]+s$L,s$_[s$h++]=s$d[s$N+1]+s$l,s$_[s$h++]=s$d[s$N+2],s$_[s$h++]=s$d[s$N+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),s$Z._upload=!0},s$L.willDrawTexture=function(s$d,s$L){if(!(s$d.loaded&&s$d.bitmap&&s$d.source))return this.sprite&&s$y.timer.callLater(this,this._repaintSprite),0;var s$l=s$d.bitmap,s$Z=s$l.id+this._shader2D.ALPHA*s$L+10016;if(s$Z==this._renderKey)return s$Z;var s$h=this._shader2D,s$_=s$h.ALPHA,s$N=this._curSubmit.shaderValue;s$h.ALPHA*=s$L,this._renderKey=s$Z,this._drawCount++,s$h.glTexture=s$l;var s$m=this._vb,s$u=null,s$x=s$m._byteLength/32*3,s$t=s$N.textureHost&&s$N.textureHost==s$d&&s$N.textureHost.alphaTexture==s$d.alphaTexture;return s$u=s$Hd.create(this,this._ib,s$m,s$x,s$Od.create(1,0)),(this._submits[this._submits._length++]=s$u).shaderValue.textureHost=s$d,s$u._renderType=10016,s$u._preIsSameTextureShader=10016===this._curSubmit._renderType&&s$h.ALPHA===s$N.ALPHA&&s$t,this._curSubmit=s$u,s$h.ALPHA=s$_,s$Z},s$L.drawTextures=function(s$d,s$L,s$l,s$Z){if(s$d.loaded&&s$d.bitmap&&s$d.source){var s$h=this._clipRect;if(this._clipRect=s$S.MAXCLIPRECT,this._drawTextureM(s$d,s$L[0],s$L[1],s$d.width,s$d.height,s$l,s$Z,null,1)){if(this._clipRect=s$h,s$E.drawCall++,!(s$L.length<4)){for(var s$_=this._curSubmit._vb||this._vb,s$N=this._curMat.a,s$m=this._curMat.d,s$u=2,s$x=s$L.length;s$u<s$x;s$u+=2)s$ad.copyPreImgVb(s$_,(s$L[s$u]-s$L[s$u-2])*s$N,(s$L[s$u+1]-s$L[s$u-1])*s$m),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&s$y.timer.callLater(this,this._repaintSprite)},s$L._drawTextureM=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){if(!s$d.loaded||!s$d.source)return this.sprite&&s$y.timer.callLater(this,this._repaintSprite),!1;var s$x=this._curSubmit._vb||this._vb,s$t=s$d.bitmap;s$L+=s$_,s$l+=s$N,this._drawCount++;var s$b=s$t.id+this._shader2D.ALPHA*s$u+10016;if(s$b!=this._renderKey){this._renderKey=s$b;var s$q=this._curSubmit.shaderValue,s$Y=this._shader2D,s$c=s$Y.ALPHA;s$Y.ALPHA*=s$u,s$Y.glTexture=s$t;var s$r=this._vb,s$a=null,s$k=s$r._byteLength/32*3,s$e=s$q.textureHost&&s$q.textureHost==s$d&&s$q.textureHost.alphaTexture==s$d.alphaTexture;s$a=s$Hd.create(this,this._ib,s$r,s$k,s$Od.create(1,0)),(this._submits[this._submits._length++]=s$a).shaderValue.textureHost=s$d,s$a._renderType=10016,s$a._preIsSameTextureShader=10016===this._curSubmit._renderType&&s$Y.ALPHA===s$q.ALPHA&&s$e,this._curSubmit=s$a,s$x=this._curSubmit._vb||this._vb,s$Y.ALPHA=s$c}return!!s$ad.fillRectImgVb(s$x,this._clipRect,s$L,s$l,s$Z||s$d.width,s$h||s$d.height,s$d.uv,s$m||this._curMat,this._x,this._y,0,0)&&(s$B.enabled&&!this._isMain&&this._curSubmit.addTexture(s$d,(s$x._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},s$L._repaintSprite=function(){this.sprite&&this.sprite.repaint()},s$L._drawText=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){var s$t=s$d.bitmap;this._drawCount++;var s$b=s$t.id+this._shader2D.ALPHA+10016;if(s$b!=this._renderKey){this._renderKey=s$b;var s$q=this._curSubmit.shaderValue,s$Y=this._shader2D;s$Y.glTexture=s$t;var s$c=this._vb,s$r=null,s$a=s$c._byteLength/32*3,s$k=s$q.textureHost&&s$q.textureHost==s$d&&s$q.textureHost.alphaTexture==s$d.alphaTexture;(s$r=s$B.enabled?s$Hd.create(this,this._ib,s$c,s$a,s$Od.create(1,0)):s$Hd.create(this,this._ib,s$c,s$a,s$fd.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&s$Y.ALPHA===s$q.ALPHA&&s$k,(this._submits[this._submits._length++]=s$r).shaderValue.textureHost=s$d,s$r._renderType=10016,this._curSubmit=s$r}s$d.active();var s$e=this._curSubmit._vb||this._vb;s$ad.fillRectImgVb(s$e,this._clipRect,s$L+s$N,s$l+s$m,s$Z||s$d.width,s$h||s$d.height,s$d.uv,s$_||this._curMat,this._x,this._y,s$u,s$x,!0)&&(s$B.enabled&&!this._isMain&&this._curSubmit.addTexture(s$d,(s$e._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},s$L.drawTextureWithTransform=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){if(s$_){var s$x=this._curMat,s$t=this._x,s$b=this._y;(0!==s$N||0!==s$m)&&(this._x=s$N*s$x.a+s$m*s$x.c,this._y=s$m*s$x.d+s$N*s$x.b),s$_&&s$x.bTransform?(s$n.mul(s$_,s$x,s$S._tmpMatrix),(s$_=s$S._tmpMatrix)._checkTransform()):(this._x+=s$x.tx,this._y+=s$x.ty),this._drawTextureM(s$d,s$L,s$l,s$Z,s$h,0,0,s$_,s$u),this._x=s$t,this._y=s$b}else this._drawTextureM(s$d,s$L,s$l,s$Z,s$h,s$N,s$m,null,s$u)},s$L.fillQuadrangle=function(s$d,s$L,s$l,s$Z,s$h){var s$_=this._curSubmit,s$N=this._vb,s$m=this._shader2D,s$u=s$_.shaderValue;if(this._renderKey=0,s$d.bitmap){var s$x=s$d.bitmap;s$m.glTexture==s$x&&s$m.ALPHA===s$u.ALPHA||(s$m.glTexture=s$x,(s$_=this._curSubmit=s$_d.createSubmit(this,this._ib,s$N,s$N._byteLength/32*3,s$Od.create(1,0))).shaderValue.glTexture=s$x,this._submits[this._submits._length++]=s$_),s$ad.fillQuadrangleImgVb(s$N,s$L,s$l,s$Z,s$d.uv,s$h||this._curMat,this._x,this._y)}else s$_.shaderValue.fillStyle&&s$_.shaderValue.fillStyle.equal(s$d)&&s$m.ALPHA===s$u.ALPHA||(s$m.glTexture=null,(s$_=this._curSubmit=s$_d.createSubmit(this,this._ib,s$N,s$N._byteLength/32*3,s$Od.create(2,0))).shaderValue.defines.add(2),s$_.shaderValue.fillStyle=s$T.create(s$d),this._submits[this._submits._length++]=s$_),s$ad.fillQuadrangleImgVb(s$N,s$L,s$l,s$Z,s$X.DEF_UV,s$h||this._curMat,this._x,this._y);s$_._numEle+=6},s$L.drawTexture2=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){if(0!=s$_){var s$u=this._curMat;if(this._x=s$d*s$u.a+s$L*s$u.c,this._y=s$L*s$u.d+s$d*s$u.b,s$h&&(s$h=s$u.bTransform||s$h.bTransform?(s$n.mul(s$h,s$u,s$S._tmpMatrix),s$S._tmpMatrix):(this._x+=s$h.tx+s$u.tx,this._y+=s$h.ty+s$u.ty,s$n.EMPTY)),1!==s$_||s$N){var s$x=this._shader2D.ALPHA,s$t=this._nBlendType;this._shader2D.ALPHA=s$_,s$N&&(this._nBlendType=s$P.TOINT(s$N)),this._drawTextureM(s$m[0],s$m[1]-s$l,s$m[2]-s$Z,s$m[3],s$m[4],0,0,s$h,1),this._shader2D.ALPHA=s$x,this._nBlendType=s$t}else this._drawTextureM(s$m[0],s$m[1]-s$l,s$m[2]-s$Z,s$m[3],s$m[4],0,0,s$h,1);this._x=this._y=0}},s$L.drawCanvas=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$d.context;if(this._renderKey=0,s$_._targets)this._submits[this._submits._length++]=s$pd.create(s$_,0,null),this._curSubmit=s$_d.RENDERBASE,s$_._targets.drawTo(this,s$L,s$l,s$Z,s$h);else{var s$N=this._submits[this._submits._length++]=s$pd.create(s$_,this._shader2D.ALPHA,this._shader2D.filters),s$m=s$Z/s$d.width,s$u=s$h/s$d.height,s$x=s$N._matrix;this._curMat.copyTo(s$x),1!=s$m&&1!=s$u&&s$x.scale(s$m,s$u);var s$t=s$x.tx,s$b=s$x.ty;s$x.tx=s$x.ty=0,s$x.transformPoint(s$V.TEMP.setTo(s$L,s$l)),s$x.translate(s$V.TEMP.x+s$t,s$V.TEMP.y+s$b),this._curSubmit=s$_d.RENDERBASE}s$$.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=s$_._targets?"yellow":"green",this.strokeRect(s$L-1,s$l-1,s$Z+2,s$h+2,1),this.strokeRect(s$L,s$l,s$Z,s$h,1),this.restore())},s$L.drawTarget=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){void 0===s$x&&(s$x=-1);var s$t=this._vb;if(s$ad.fillRectImgVb(s$t,this._clipRect,s$L,s$l,s$Z,s$h,s$u||s$X.DEF_UV,s$_||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var s$b=this._curSubmit=s$bd.create(this,this._ib,s$t,(s$t._byteLength-64)/32*3,s$m,s$N);s$b.blendType=-1==s$x?this._nBlendType:s$x,s$b.scope=s$d,this._submits[this._submits._length++]=s$b,this._curSubmit._numEle+=6}},s$L.mixRGBandAlpha=function(s$d){return this._mixRGBandAlpha(s$d,this._shader2D.ALPHA)},s$L._mixRGBandAlpha=function(s$d,s$L){var s$l=(4278190080&s$d)>>>24;return 0!=s$l?s$l*=s$L:s$l=255*s$L,16777215&s$d|s$l<<24},s$L.drawTriangles=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){if(!s$d.loaded||!s$d.source)return this.sprite&&s$y.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;s$d.bitmap;var s$t=this._mixRGBandAlpha(4294967295,s$m),s$b=(s$Z.length,s$_.length);this._renderKey=-1;var s$q=this._curSubmit=s$Hd.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,s$Od.create(1,0));return s$q.shaderValue.textureHost=s$d,s$q._renderType=10016,this._submits[this._submits._length++]=s$q,s$N?(s$S._tmpMatrix.a=s$N.a,s$S._tmpMatrix.b=s$N.b,s$S._tmpMatrix.c=s$N.c,s$S._tmpMatrix.d=s$N.d,s$S._tmpMatrix.tx=s$N.tx+s$L,s$S._tmpMatrix.ty=s$N.ty+s$l,s$n.mul(s$S._tmpMatrix,this._curMat,s$S._tmpMatrix)):(s$S._tmpMatrix.a=this._curMat.a,s$S._tmpMatrix.b=this._curMat.b,s$S._tmpMatrix.c=this._curMat.c,s$S._tmpMatrix.d=this._curMat.d,s$S._tmpMatrix.tx=this._curMat.tx+s$L,s$S._tmpMatrix.ty=this._curMat.ty+s$l),this._triangleMesh.addData(s$Z,s$h,s$_,s$S._tmpMatrix,s$t,this),this._curSubmit._numEle+=s$b,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},s$L.transform=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$J.save(this),s$n.mul(s$n.TEMP.setTo(s$d,s$L,s$l,s$Z,s$h,s$_),this._curMat,this._curMat),this._curMat._checkTransform()},s$L.setTransformByMatrix=function(s$d){s$d.copyTo(this._curMat)},s$L.transformByMatrix=function(s$d){s$J.save(this),s$n.mul(s$d,this._curMat,this._curMat),this._curMat._checkTransform()},s$L.rotate=function(s$d){s$J.save(this),this._curMat.rotateEx(s$d)},s$L.scale=function(s$d,s$L){s$J.save(this),this._curMat.scaleEx(s$d,s$L)},s$L.clipRect=function(s$d,s$L,s$l,s$Z){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var s$h=s$td.create(4);this.addRenderObject(s$h);var s$_=this._vb,s$N=s$_._byteLength>>2;if(s$ad.fillRectImgVb(s$_,null,s$d,s$L,s$l,s$Z,s$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var s$m=this._curSubmit=s$_d.createSubmit(this,this._ib,s$_,(s$_._byteLength-64)/32*3,s$Od.create(2,0));s$m.shaderValue.ALPHA=1,this._submits[this._submits._length++]=s$m,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var s$u=s$td.create(5);this.addRenderObject(s$u);var s$x=s$_.getFloat32Array(),s$t=Math.min(Math.min(Math.min(s$x[0+s$N],s$x[4+s$N]),s$x[8+s$N]),s$x[12+s$N]),s$b=Math.max(Math.max(Math.max(s$x[0+s$N],s$x[4+s$N]),s$x[8+s$N]),s$x[12+s$N]),s$q=Math.min(Math.min(Math.min(s$x[1+s$N],s$x[5+s$N]),s$x[9+s$N]),s$x[13+s$N]),s$Y=Math.max(Math.max(Math.max(s$x[1+s$N],s$x[5+s$N]),s$x[9+s$N]),s$x[13+s$N]);s$K.save(this,s$u,s$d,s$L,s$l,s$Z,s$t,s$q,s$b-s$t,s$Y-s$q),this._curSubmit=s$_d.RENDERBASE}else{s$l*=this._curMat.a,s$Z*=this._curMat.d;var s$c=s$V.TEMP;this._curMat.transformPoint(s$c.setTo(s$d,s$L)),s$l<0&&(s$c.x=s$c.x+s$l,s$l=-s$l),s$Z<0&&(s$c.y=s$c.y+s$Z,s$Z=-s$Z),this._renderKey=0;var s$r=this._curSubmit=s$xd.create(this);(this._submits[this._submits._length++]=s$r).submitIndex=this._submits._length,s$r.submitLength=9999999,s$G.save(this,s$r);var s$a=this._clipRect,s$k=s$a.x,s$e=s$a.y,s$w=s$c.x+s$l,s$s=s$c.y+s$Z;s$k<s$c.x&&(s$a.x=s$c.x),s$e<s$c.y&&(s$a.y=s$c.y),s$a.width=Math.min(s$w,s$k+s$a.width)-s$a.x,s$a.height=Math.min(s$s,s$e+s$a.height)-s$a.y,this._shader2D.glTexture=null,s$r.clipRect.copyFrom(s$a),this._curSubmit=s$_d.RENDERBASE}},s$L.setIBVB=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t){if(void 0===s$u&&(s$u=0),void 0===s$x&&(s$x=0),void 0===s$t&&(s$t=0),null===s$l){if(s$k.isFlash){var s$b=s$Z;s$b._selfIB||(s$b._selfIB=s$Wd.create(35044)),s$b._selfIB.clear(),s$l=s$b._selfIB}else s$l=this._ib;s$ad.expandIBQuadrangle(s$l,s$Z._byteLength/(4*s$Z.vertexStride*4))}if(!s$m||!s$N)throw Error("setIBVB must input:shader shaderValues");var s$q=s$ud.create(this,s$Z,s$l,s$h,s$N,s$m,s$u,s$x,s$t);s$_||(s$_=s$n.EMPTY),s$_.translate(s$d,s$L),s$n.mul(s$_,this._curMat,s$q._mat),s$_.translate(-s$d,-s$L),this._submits[this._submits._length++]=s$q,this._curSubmit=s$_d.RENDERBASE,this._renderKey=0},s$L.addRenderObject=function(s$d){this._submits[this._submits._length++]=s$d},s$L.fillTrangles=function(s$d,s$L,s$l,s$Z,s$h){var s$_=this._curSubmit,s$N=this._vb,s$m=this._shader2D,s$u=s$_.shaderValue,s$x=s$Z.length>>4,s$t=s$d.bitmap;this._renderKey=0,s$m.glTexture==s$t&&s$m.ALPHA===s$u.ALPHA||((s$_=this._curSubmit=s$_d.createSubmit(this,this._ib,s$N,s$N._byteLength/32*3,s$Od.create(1,0))).shaderValue.textureHost=s$d,this._submits[this._submits._length++]=s$_),s$ad.fillTranglesVB(s$N,s$L,s$l,s$Z,s$h||this._curMat,this._x,this._y),s$_._numEle+=6*s$x},s$L.submitElement=function(s$d,s$L){var s$l=this._submits;for(s$L<0&&(s$L=s$l._length);s$d<s$L;)s$d+=s$l[s$d].renderSubmit()},s$L.finish=function(){s$sd.mainContext.finish()},s$L.flush=function(){var s$d=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(s$d>this._ib.bufferLength/12&&s$ad.expandIBQuadrangle(this._ib,s$d),!this._isMain&&s$B.enabled&&s$B._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=s$B._atlasRestore;for(var s$L=this._submits,s$l=0,s$Z=s$L._length;s$l<s$Z;s$l++){var s$h=s$L[s$l];10016===s$h.getRenderType()&&s$h.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),s$Ld.instance&&s$Ld.getInstance().reset();var s$_;for(s$l=0,s$_=this.meshlist.length;s$l<s$_;s$l++){var s$N=this.meshlist[s$l];s$N.canReuse?s$N.releaseMesh():s$N.destroy()}return this.meshlist.length=0,this._curSubmit=s$_d.RENDERBASE,this._renderKey=0,this._triangleMesh=s$Xd.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},s$L.setPathId=function(s$d){if(this.mId=s$d,-1!=this.mId){this.mHaveKey=!1;var s$L=s$R.getInstance();s$L.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,s$L.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},s$L.movePath=function(s$d,s$L){var s$l=s$d,s$Z=s$L;s$d=this._curMat.a*s$l+this._curMat.c*s$Z+this._curMat.tx,s$L=this._curMat.b*s$l+this._curMat.d*s$Z+this._curMat.ty,this.mX+=s$d,this.mY+=s$L},s$L.beginPath=function(){var s$d=this._getPath();s$d.tempArray.length=0,s$d.closePath=!1,this.mX=0,this.mY=0},s$L.closePath=function(){this._path.closePath=!0},s$L.fill=function(s$d){void 0===s$d&&(s$d=!1);var s$L=this._getPath();this.drawPoly(0,0,s$L.tempArray,this.fillStyle._color.numColor,0,0,s$d)},s$L.stroke=function(){var s$d=this._getPath();if(0<this.lineWidth){if(-1==this.mId)s$d.drawLine(0,0,s$d.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var s$L=s$R.getInstance().shapeLineDic[this.mId];s$L.rebuild(s$d.tempArray),s$d.setGeomtry(s$L)}else s$R.getInstance().addLine(this.mId,s$d.drawLine(0,0,s$d.tempArray,this.lineWidth,this.strokeStyle._color.numColor));s$d.update();var s$l=[this.mX,this.mY],s$Z=s$_d.createShape(this,s$d.ib,s$d.vb,s$d.count,s$d.offset,s$Od.create(4,0));s$Z.shaderValue.ALPHA=this._shader2D.ALPHA,s$Z.shaderValue.u_pos=s$l,s$Z.shaderValue.u_mmat2=s$ed.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=s$Z,this._renderKey=-1}},s$L.line=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=this._curSubmit,s$m=this._vb;if(s$ad.fillLineVb(s$m,this._clipRect,s$d,s$L,s$l,s$Z,s$h,s$_)){this._renderKey=0;var s$u=this._shader2D,s$x=s$N.shaderValue;s$u.strokeStyle===s$x.strokeStyle&&s$u.ALPHA===s$x.ALPHA||(s$u.glTexture=null,(s$N=this._curSubmit=s$_d.createSubmit(this,this._ib,s$m,(s$m._byteLength-64)/32*3,s$Od.create(2,0))).shaderValue.strokeStyle=s$u.strokeStyle,s$N.shaderValue.mainID=2,s$N.shaderValue.ALPHA=s$u.ALPHA,this._submits[this._submits._length++]=s$N),s$N._numEle+=6}},s$L.moveTo=function(s$d,s$L,s$l){void 0===s$l&&(s$l=!0);var s$Z=this._getPath();if(s$l){var s$h=s$d,s$_=s$L;s$d=this._curMat.a*s$h+this._curMat.c*s$_,s$L=this._curMat.b*s$h+this._curMat.d*s$_}s$Z.addPoint(s$d,s$L)},s$L.lineTo=function(s$d,s$L,s$l){void 0===s$l&&(s$l=!0);var s$Z=this._getPath();if(s$l){var s$h=s$d,s$_=s$L;s$d=this._curMat.a*s$h+this._curMat.c*s$_,s$L=this._curMat.b*s$h+this._curMat.d*s$_}s$Z.addPoint(s$d,s$L)},s$L.drawCurves=function(s$d,s$L,s$l){this.setPathId(-1),this.beginPath(),this.strokeStyle=s$l[3],this.lineWidth=s$l[4];var s$Z=s$l[2];s$d+=s$l[0],s$L+=s$l[1],this.movePath(s$d,s$L),this.moveTo(s$Z[0],s$Z[1]);for(var s$h=2,s$_=s$Z.length;s$h<s$_;)this.quadraticCurveTo(s$Z[s$h++],s$Z[s$h++],s$Z[s$h++],s$Z[s$h++]);this.stroke()},s$L.arcTo=function(s$d,s$L,s$l,s$Z,s$h){if(-1==this.mId||!this.mHaveKey){var s$_=0,s$N=0,s$m=0,s$u=this._getPath();this._curMat.copyTo(s$S._tmpMatrix),s$S._tmpMatrix.tx=s$S._tmpMatrix.ty=0,s$S._tempPoint.setTo(s$u.getEndPointX(),s$u.getEndPointY()),s$S._tmpMatrix.invertTransformPoint(s$S._tempPoint);var s$x=s$S._tempPoint.x-s$d,s$t=s$S._tempPoint.y-s$L,s$b=Math.sqrt(s$x*s$x+s$t*s$t);if(!(s$b<=1e-6)){var s$q=s$x/s$b,s$Y=s$t/s$b,s$c=s$l-s$d,s$r=s$Z-s$L,s$a=s$c*s$c+s$r*s$r,s$k=Math.sqrt(s$a);if(!(s$k<=1e-6)){var s$e=s$c/s$k,s$w=s$r/s$k,s$s=s$q+s$e,s$A=s$Y+s$w,s$y=Math.sqrt(s$s*s$s+s$A*s$A);if(!(s$y<=1e-6)){var s$$=s$s/s$y,s$O=s$A/s$y,s$n=Math.acos(s$$*s$q+s$O*s$Y),s$V=Math.PI/2-s$n,s$Q=(s$b=s$h/Math.tan(s$V))*s$q+s$d,s$g=s$b*s$Y+s$L,s$F=Math.sqrt(s$b*s$b+s$h*s$h),s$E=s$d+s$$*s$F,s$I=s$L+s$O*s$F,s$p=0,s$H=0;if(0<=s$q*s$w-s$Y*s$e){var s$X=2*s$V/s$S.SEGNUM;s$p=Math.sin(s$X),s$H=Math.cos(s$X)}else s$X=2*-s$V/s$S.SEGNUM,s$p=Math.sin(s$X),s$H=Math.cos(s$X);s$N=this._curMat.a*s$Q+this._curMat.c*s$g,s$m=this._curMat.b*s$Q+this._curMat.d*s$g,s$N==this._path.getEndPointX()&&s$m==this._path.getEndPointY()||s$u.addPoint(s$N,s$m);var s$j=s$Q-s$E,s$R=s$g-s$I;for(s$_=0;s$_<s$S.SEGNUM;s$_++){var s$o=s$j*s$H+s$R*s$p,s$i=-s$j*s$p+s$R*s$H;s$N=s$o+s$E,s$m=s$i+s$I,s$d=this._curMat.a*s$N+this._curMat.c*s$m,s$m=s$L=this._curMat.b*s$N+this._curMat.d*s$m,(s$N=s$d)==this._path.getEndPointX()&&s$m==this._path.getEndPointY()||s$u.addPoint(s$N,s$m),s$j=s$o,s$R=s$i}}}}}},s$L.arc=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!0),-1!=this.mId){var s$m=s$R.getInstance().shapeDic[this.mId];if(s$m&&this.mHaveKey&&!s$m.needUpdate(this._curMat))return;s$L=s$d=0}var s$u,s$x=0,s$t=0,s$b=0,s$q=0,s$Y=0,s$c=0,s$r=0;if(s$t=s$h-s$Z,s$_)if(Math.abs(s$t)>=2*Math.PI)s$t=2*-Math.PI;else for(;0<s$t;)s$t-=2*Math.PI;else if(Math.abs(s$t)>=2*Math.PI)s$t=2*Math.PI;else for(;s$t<0;)s$t+=2*Math.PI;s$u=s$t/(s$r=s$l<101?Math.max(10,s$t*s$l/5):s$l<201?Math.max(10,s$t*s$l/20):Math.max(10,s$t*s$l/40))/2,s$b=Math.abs(4/3*(1-Math.cos(s$u))/Math.sin(s$u)),s$_&&(s$b=-s$b);var s$a=this._getPath(),s$k=NaN,s$e=NaN;for(s$c=0;s$c<=s$r;s$c++)s$x=s$Z+s$t*(s$c/s$r),s$q=s$d+Math.cos(s$x)*s$l,s$Y=s$L+Math.sin(s$x)*s$l,s$N&&(s$k=s$q,s$e=s$Y,s$q=this._curMat.a*s$k+this._curMat.c*s$e,s$Y=this._curMat.b*s$k+this._curMat.d*s$e),s$q==this._path.getEndPointX()&&s$Y==this._path.getEndPointY()||s$a.addPoint(s$q,s$Y);s$q=s$d+Math.cos(s$h)*s$l,s$Y=s$L+Math.sin(s$h)*s$l,s$N&&(s$k=s$q,s$e=s$Y,s$q=this._curMat.a*s$k+this._curMat.c*s$e,s$Y=this._curMat.b*s$k+this._curMat.d*s$e),s$q==this._path.getEndPointX()&&s$Y==this._path.getEndPointY()||s$a.addPoint(s$q,s$Y)},s$L.quadraticCurveTo=function(s$d,s$L,s$l,s$Z){var s$h=s$b.I,s$_=s$l,s$N=s$Z;s$l=this._curMat.a*s$_+this._curMat.c*s$N,s$Z=this._curMat.b*s$_+this._curMat.d*s$N,s$_=s$d,s$N=s$L,s$d=this._curMat.a*s$_+this._curMat.c*s$N,s$L=this._curMat.b*s$_+this._curMat.d*s$N;for(var s$m=s$h.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),s$d,s$L,s$l,s$Z],30,2),s$u=0,s$x=s$m.length/2;s$u<s$x;s$u++)this.lineTo(s$m[2*s$u],s$m[2*s$u+1],!1);this.lineTo(s$l,s$Z,!1)},s$L.rect=function(s$d,s$L,s$l,s$Z){this._other=this._other.make(),this._other.path||(this._other.path=new s$z),this._other.path.rect(s$d,s$L,s$l,s$Z)},s$L.strokeRect=function(s$d,s$L,s$l,s$Z,s$h){var s$_=.5*s$h;this.line(s$d-s$_,s$L,s$d+s$l+s$_,s$L,s$h,this._curMat),this.line(s$d+s$l,s$L,s$d+s$l,s$L+s$Z,s$h,this._curMat),this.line(s$d,s$L,s$d,s$L+s$Z,s$h,this._curMat),this.line(s$d-s$_,s$L+s$Z,s$d+s$l+s$_,s$L+s$Z,s$h,this._curMat)},s$L.clip=function(){},s$L.drawPoly=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){void 0===s$N&&(s$N=!1),this._renderKey=0,this._shader2D.glTexture=null;var s$m=this._getPath();if(-1==this.mId)s$m.polygon(s$d,s$L,s$l,s$Z,s$h||1,s$_);else if(this.mHaveKey){var s$u=s$R.getInstance().shapeDic[this.mId];s$u.setMatrix(this._curMat),s$u.rebuild(s$m.tempArray),s$m.setGeomtry(s$u)}else{var s$x=s$m.polygon(s$d,s$L,s$l,s$Z,s$h||1,s$_);s$R.getInstance().addShape(this.mId,s$x),s$x.setMatrix(this._curMat)}s$m.update();var s$t,s$b=[this.mX,this.mY];if((s$t=s$_d.createShape(this,s$m.ib,s$m.vb,s$m.count,s$m.offset,s$Od.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,s$t.shaderValue.u_pos=s$b,s$t.shaderValue.u_mmat2=s$ed.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=s$t,0<s$h){if(this.mHaveLineKey){var s$q=s$R.getInstance().shapeLineDic[this.mId];s$q.rebuild(s$m.tempArray),s$m.setGeomtry(s$q)}else s$R.getInstance().addShape(this.mId,s$m.drawLine(s$d,s$L,s$l,s$h,s$_));s$m.update(),(s$t=s$_d.createShape(this,s$m.ib,s$m.vb,s$m.count,s$m.offset,s$Od.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,s$t.shaderValue.u_mmat2=s$ed.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=s$t}},s$L.drawParticle=function(s$d,s$L,s$l){s$l.x=s$d,s$l.y=s$L,this._submits[this._submits._length++]=s$l},s$L._getPath=function(){return this._path||(this._path=new s$z)},s$Z(0,s$L,"globalCompositeOperation",function(){return s$P.NAMES[this._nBlendType]},function(s$d){var s$L=s$P.TOINT[s$d];null==s$L||this._nBlendType===s$L||(s$D.save(this,65536,this,!0),this._curSubmit=s$_d.RENDERBASE,this._renderKey=0,this._nBlendType=s$L)}),s$Z(0,s$L,"strokeStyle",function(){return this._shader2D.strokeStyle},function(s$d){this._shader2D.strokeStyle.equal(s$d)||(s$D.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=s$T.create(s$d))}),s$Z(0,s$L,"globalAlpha",function(){return this._shader2D.ALPHA},function(s$d){(s$d=Math.floor(1e3*s$d)/1e3)!=this._shader2D.ALPHA&&(s$D.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=s$d)}),s$Z(0,s$L,"asBitmap",null,function(s$d){if(s$d){if(this._targets||(this._targets=new s$U),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),s$Z(0,s$L,"fillStyle",function(){return this._shader2D.fillStyle},function(s$d){this._shader2D.fillStyle.equal(s$d)||(s$D.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=s$T.create(s$d))}),s$Z(0,s$L,"textAlign",function(){return this._other.textAlign},function(s$d){this._other.textAlign===s$d||(this._other=this._other.make(),s$D.save(this,32768,this._other,!1),this._other.textAlign=s$d)}),s$Z(0,s$L,"lineWidth",function(){return this._other.lineWidth},function(s$d){this._other.lineWidth===s$d||(this._other=this._other.make(),s$D.save(this,256,this._other,!1),this._other.lineWidth=s$d)}),s$Z(0,s$L,"textBaseline",function(){return this._other.textBaseline},function(s$d){this._other.textBaseline===s$d||(this._other=this._other.make(),s$D.save(this,16384,this._other,!1),this._other.textBaseline=s$d)}),s$Z(0,s$L,"font",null,function(s$d){s$d!=this._other.font.toString()&&(this._other=this._other.make(),s$D.save(this,8,this._other,!1),this._other.font===s$cd.EMPTY?this._other.font=new s$cd(s$d):this._other.font.setFont(s$d))}),s$S.__init__=function(){s$l.DEFAULT=new s$l},s$S._tempPoint=new s$V,s$S._SUBMITVBSIZE=32e3,s$S._MAXSIZE=99999999,s$S._RECTVBSIZE=16,s$S.MAXCLIPRECT=new s$Q(0,0,99999999,99999999),s$S._COUNT=0,s$S._tmpMatrix=new s$n,s$S.SEGNUM=32,s$S._contextcount=0,s$N(s$S,["_fontTemp",function(){return this._fontTemp=new s$cd},"_drawStyleTemp",function(){return this._drawStyleTemp=new s$T(null)}]),s$S.__init$=function(){s$l=function(){function s$d(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=s$cd.EMPTY}s$q(s$d,"");var s$L=s$d.prototype;return s$L.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=s$cd.EMPTY},s$L.make=function(){return this===s$d.DEFAULT?new s$d:this},s$d.DEFAULT=null,s$d}()},s$S}(),s$Od=function(s$d){function s$Z(s$d,s$L){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,s$Z.__super.call(this),this.defines=new s$gd,this.position=s$Z._POSITION,this.mainID=s$d,this.subID=s$L,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=s$d|s$L,this._inClassCache=s$Z._cache[this._cacheID],0<s$d&&!this._inClassCache&&(this._inClassCache=s$Z._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}s$q(s$Z,"laya.webgl.shader.d2.value.Value2D",s$i);var s$L=s$Z.prototype;return s$L.setValue=function(s$d){},s$L.refresh=function(){var s$d=this.size;return s$d[0]=s$ed.width,s$d[1]=s$ed.height,this.alpha=this.ALPHA*s$ed.worldAlpha,this.mmat=s$ed.worldMatrix4,this},s$L._ShaderWithCompile=function(){return s$vd.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,s$Ud.create)},s$L._withWorldShaderDefines=function(){var s$d=s$ed.worldShaderDefines,s$L=s$vd.sharders[this.mainID|this.defines._value|s$d.getValue()];if(!s$L){var s$l,s$Z={};for(s$l in this.defines.toNameDic())s$Z[s$l]="";for(s$l in s$d.toNameDic())s$Z[s$l]="";s$L=s$vd.withCompile2D(0,this.mainID,s$Z,this.mainID|this.defines._value|s$d.getValue(),s$Ud.create)}var s$h=s$ed.worldFilters;if(!s$h)return s$L;for(var s$_,s$N=s$h.length,s$m=0;s$m<s$N;s$m++)(s$_=s$h[s$m])&&s$_.action.setValue(this);return s$L},s$L.upload=function(){var s$d=s$ed;this.alpha=this.ALPHA*s$d.worldAlpha,s$ed.worldMatrix4!==s$ed.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),s$sd.shaderHighPrecision&&this.defines.add(1024);var s$L,s$l=s$d.worldShaderDefines?this._withWorldShaderDefines():s$vd.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=s$d.width,this.size[1]=s$d.height,this.mmat=s$d.worldMatrix4,s$jd.activeShader!==s$l?s$l._shaderValueWidth!==s$d.width||s$l._shaderValueHeight!==s$d.height?(s$l._shaderValueWidth=s$d.width,s$l._shaderValueHeight=s$d.height):s$L=s$l._params2dQuick2||s$l._make2dQuick2():s$l._shaderValueWidth!==s$d.width||s$l._shaderValueHeight!==s$d.height?(s$l._shaderValueWidth=s$d.width,s$l._shaderValueHeight=s$d.height):s$L=s$l._params2dQuick1||s$l._make2dQuick1(),s$l.upload(this,s$L)},s$L.setFilters=function(s$d){if(this.filters=s$d)for(var s$L,s$l=s$d.length,s$Z=0;s$Z<s$l;s$Z++)(s$L=s$d[s$Z])&&(this.defines.add(s$L.type),s$L.action.setValue(this))},s$L.clear=function(){this.defines.setValue(this.subID)},s$L.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},s$Z._initone=function(s$d,s$L){s$Z._typeClass[s$d]=s$L,s$Z._cache[s$d]=[],s$Z._cache[s$d]._length=0},s$Z.__init__=function(){s$Z._POSITION=[2,5126,!1,4*s$rd.BYTES_PE,0],s$Z._TEXCOORD=[2,5126,!1,4*s$rd.BYTES_PE,2*s$rd.BYTES_PE],s$Z._initone(2,s$Sd),s$Z._initone(4,s$Pd),s$Z._initone(256,s$Bd),s$Z._initone(512,s$id),s$Z._initone(1,s$Cd),s$Z._initone(65,s$fd),s$Z._initone(9,s$Cd)},s$Z.create=function(s$d,s$L){var s$l=s$Z._cache[s$d|s$L];return s$l._length?s$l[--s$l._length]:new s$Z._typeClass[s$d|s$L](s$L)},s$Z._POSITION=null,s$Z._TEXCOORD=null,s$Z._cache=[],s$Z._typeClass=[],s$Z.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s$Z}(),s$nd=function(s$d){function s$a(s$d,s$L){s$a.__super.call(this,s$d,s$L)}s$q(s$a,"laya.webgl.utils.RenderSprite3D",s$e);var s$L=s$a.prototype;return s$L.onCreate=function(s$d){switch(s$d){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},s$L._mask=function(s$d,s$L,s$l,s$Z){var s$h,s$_,s$N=this._next,s$m=s$d.mask;if(s$m){s$L.ctx.save();var s$u=s$L.ctx.globalCompositeOperation,s$x=new s$Q;if(s$x.copyFrom(s$m.getBounds()),s$x.width=Math.round(s$x.width),s$x.height=Math.round(s$x.height),s$x.x=Math.round(s$x.x),s$x.y=Math.round(s$x.y),0<s$x.width&&0<s$x.height){var s$t=s$d._style._tf,s$b=s$md.create();s$b.addValue("bounds",s$x),s$h=s$Nd.create([s$b,s$L],laya.webgl.utils.RenderSprite3D.tmpTarget),s$L.addRenderObject(s$h),s$m.render(s$L,-s$x.x,-s$x.y),s$h=s$Nd.create([s$b],laya.webgl.utils.RenderSprite3D.endTmpTarget),s$L.addRenderObject(s$h),s$L.ctx.save(),s$L.clipRect(s$l-s$t.translateX+s$x.x,s$Z-s$t.translateY+s$x.y,s$x.width,s$x.height),s$N._fun.call(s$N,s$d,s$L,s$l,s$Z),s$L.ctx.restore(),s$_=s$td.create(6),s$u=s$L.ctx.globalCompositeOperation,s$_.blendMode="mask",s$L.addRenderObject(s$_),s$n.TEMP.identity();var s$q=s$Od.create(1,0),s$Y=s$X.INV_UV,s$c=s$x.width,s$r=s$x.height;(s$x.width<32||s$x.height<32)&&((s$Y=s$a.tempUV)[0]=0,s$Y[1]=0,s$Y[2]=32<=s$x.width?1:s$x.width/32,s$Y[3]=0,s$Y[4]=32<=s$x.width?1:s$x.width/32,s$Y[5]=32<=s$x.height?1:s$x.height/32,s$Y[6]=0,s$Y[7]=32<=s$x.height?1:s$x.height/32,s$x.width=32<=s$x.width?s$x.width:32,s$x.height=32<=s$x.height?s$x.height:32,s$Y[1]*=-1,s$Y[3]*=-1,s$Y[5]*=-1,s$Y[7]*=-1,s$Y[1]+=1,s$Y[3]+=1,s$Y[5]+=1,s$Y[7]+=1),s$L.ctx.drawTarget(s$b,s$l+s$x.x-s$t.translateX,s$Z+s$x.y-s$t.translateY,s$c,s$r,s$n.TEMP,"tmpTarget",s$q,s$Y,6),s$h=s$Nd.create([s$b],laya.webgl.utils.RenderSprite3D.recycleTarget),s$L.addRenderObject(s$h),(s$_=s$td.create(6)).blendMode=s$u,s$L.addRenderObject(s$_)}s$L.ctx.restore()}else s$N._fun.call(s$N,s$d,s$L,s$l,s$Z)},s$L._blend=function(s$d,s$L,s$l,s$Z){var s$h=s$d._style,s$_=this._next;s$h.blendMode?(s$L.ctx.save(),s$L.ctx.globalCompositeOperation=s$h.blendMode,s$_._fun.call(s$_,s$d,s$L,s$l,s$Z),s$L.ctx.restore()):s$_._fun.call(s$_,s$d,s$L,s$l,s$Z)},s$L._transform=function(s$d,s$L,s$l,s$Z){var s$h=s$d.transform,s$_=this._next;if(s$h&&s$_!=s$e.NORENDER){var s$N=s$L.ctx;s$d._style;s$h.tx=s$l,s$h.ty=s$Z;var s$m=s$N._getTransformMatrix(),s$u=s$m.clone();s$n.mul(s$h,s$m,s$m),s$m._checkTransform(),s$h.tx=s$h.ty=0,s$_._fun.call(s$_,s$d,s$L,0,0),s$u.copyTo(s$m),s$u.destroy()}else s$_._fun.call(s$_,s$d,s$L,s$l,s$Z)},s$a.tmpTarget=function(s$d,s$L){var s$l=s$d.getValue("bounds"),s$Z=s$Rd.create(s$l.width,s$l.height);s$Z.start(),s$Z.clear(0,0,0,0),s$d.addValue("tmpTarget",s$Z)},s$a.endTmpTarget=function(s$d){s$d.getValue("tmpTarget").end()},s$a.recycleTarget=function(s$d){s$d.getValue("tmpTarget").recycle(),s$d.recycle()},s$N(s$a,["tempUV",function(){return this.tempUV=new Array(8)}]),s$a}(),s$Vd=function(s$d){function s$L(){this.data=null,s$L.__super.call(this)}s$q(s$L,"laya.filters.webgl.ColorFilterActionGL",s$o);var s$l=s$L.prototype;return s$y.imps(s$l,{"laya.filters.IFilterActionGL":!0}),s$l.setValue=function(s$d){s$d.colorMat=this.data._mat,s$d.colorAlpha=this.data._alpha},s$l.apply3d=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$d.getValue("bounds"),s$N=s$Od.create(1,0);s$N.setFilters([this.data]);var s$m=s$n.TEMP;s$m.identity(),s$l.ctx.drawTarget(s$d,0,0,s$_.width,s$_.height,s$m,"src",s$N)},s$L}(),s$Qd=function(s$d){function s$_(s$d,s$L,s$l,s$Z,s$h){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,s$_.__super.call(this,s$d,s$L,s$h),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new s$Td,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=s$l,this._atlasCanvas.height=s$Z,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}s$q(s$_,"laya.webgl.atlas.Atlaser",s$S);var s$L=s$_.prototype;return s$L.computeUVinAtlasTexture=function(s$d,s$L,s$l,s$Z){var s$h=s$B.atlasTextureWidth,s$_=s$B.atlasTextureHeight,s$N=s$l/s$h,s$m=s$Z/s$_,s$u=(s$l+s$d.bitmap.width)/s$h,s$x=(s$Z+s$d.bitmap.height)/s$_,s$t=s$d.bitmap.width/s$h,s$b=s$d.bitmap.height/s$_;s$d.uv=[s$N+s$L[0]*s$t,s$m+s$L[1]*s$b,s$u-(1-s$L[2])*s$t,s$m+s$L[3]*s$b,s$u-(1-s$L[4])*s$t,s$x-(1-s$L[5])*s$b,s$N+s$L[6]*s$t,s$x-(1-s$L[7])*s$b]},s$L.findBitmapIsExist=function(s$d){if(s$d instanceof laya.webgl.resource.WebGLImage){var s$L=s$d,s$l=s$L.url,s$Z=this._InAtlasWebGLImagesKey[s$l||s$L.id];if(s$Z)return s$Z.offsetInfoID}return-1},s$L.addToAtlasTexture=function(s$d,s$L,s$l){if(s$d instanceof laya.webgl.resource.WebGLImage){var s$Z=s$d,s$h=s$Z.url;this._InAtlasWebGLImagesKey[s$h||s$Z.id]={bitmap:s$d,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([s$L,s$l])}this._atlasCanvas.texSubImage2D(s$L,s$l,s$d.atlasSource),s$d.clearAtlasSource()},s$L.addToAtlas=function(s$d,s$L,s$l){s$d._atlasID=this._inAtlasTextureKey.length;var s$Z=s$d.uv.slice(),s$h=s$d.bitmap;this._inAtlasTextureKey.push(s$d),this._inAtlasTextureOriUVValue.push(s$Z),this._inAtlasTextureBitmapValue.push(s$h),this.computeUVinAtlasTexture(s$d,s$Z,s$L,s$l),s$d.bitmap=this._atlasCanvas},s$L.clear=function(){for(var s$d=0,s$L=this._inAtlasTextureKey.length;s$d<s$L;s$d++)this._inAtlasTextureKey[s$d].bitmap=this._inAtlasTextureBitmapValue[s$d],this._inAtlasTextureKey[s$d].uv=this._inAtlasTextureOriUVValue[s$d],this._inAtlasTextureKey[s$d]._atlasID=-1,this._inAtlasTextureKey[s$d].bitmap.lock=!1,this._inAtlasTextureKey[s$d].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},s$L.dispose=function(){this.clear(),this._atlasCanvas.destroy()},s$Z(0,s$L,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),s$Z(0,s$L,"texture",function(){return this._atlasCanvas}),s$Z(0,s$L,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),s$_}(),s$gd=function(s$d){function s$l(){s$l.__super.call(this,s$l.__name2int,s$l.__int2name,s$l.__int2nameMap)}return s$q(s$l,"laya.webgl.shader.d2.ShaderDefines2D",s$M),s$l.__init__=function(){s$l.reg("TEXTURE2D",1),s$l.reg("COLOR2D",2),s$l.reg("PRIMITIVE",4),s$l.reg("GLOW_FILTER",8),s$l.reg("BLUR_FILTER",16),s$l.reg("COLOR_FILTER",32),s$l.reg("COLOR_ADD",64),s$l.reg("WORLDMAT",128),s$l.reg("FILLTEXTURE",256),s$l.reg("FSHIGHPRECISION",1024),s$l.reg("TXTALPHA",2048),s$l.reg("TXTCOMPRESS",4096)},s$l.reg=function(s$d,s$L){s$M._reg(s$d,s$L,s$l.__name2int,s$l.__int2name)},s$l.toText=function(s$d,s$L,s$l){return s$M._toText(s$d,s$L,s$l)},s$l.toInt=function(s$d){return s$M._toInt(s$d,s$l.__name2int)},s$l.TEXTURE2D=1,s$l.COLOR2D=2,s$l.PRIMITIVE=4,s$l.FILTERGLOW=8,s$l.FILTERBLUR=16,s$l.FILTERCOLOR=32,s$l.COLORADD=64,s$l.WORLDMAT=128,s$l.FILLTEXTURE=256,s$l.SKINMESH=512,s$l.SHADERDEFINE_FSHIGHPRECISION=1024,s$l.TXTALPHA=2048,s$l.TXTCOMPRESS=4096,s$l.__name2int={},s$l.__int2name=[],s$l.__int2nameMap=[],s$l}(),s$Fd=(function(s$d){function s$m(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$m.__super.call(this,s$d,s$L,s$l,s$Z,40,s$h,s$_,s$N)}s$q(s$m,"laya.webgl.shapes.Ellipse",s$ld)}(),function(s$d){function s$_(s$d,s$L,s$l,s$Z,s$h){this._points=[],this.rebuild(s$l),s$_.__super.call(this,s$d,s$L,0,0,0,s$h,s$Z,s$h,0)}s$q(s$_,"laya.webgl.shapes.Line",s$ld);var s$L=s$_.prototype;return s$L.rebuild=function(s$d){var s$L=s$d.length;s$L!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(s$L/2-1)),this.mFloat32Array=new Float32Array(5*s$L)),this._points.length=0;for(var s$l=NaN,s$Z=NaN,s$h=-1,s$_=-1,s$N=s$d.length/2,s$m=0;s$m<s$N;s$m++)s$l=s$d[2*s$m],s$Z=s$d[2*s$m+1],(.01<Math.abs(s$h-s$l)||.01<Math.abs(s$_-s$Z))&&this._points.push(s$l,s$Z),s$h=s$l,s$_=s$Z},s$L.getData=function(s$d,s$L,s$l){var s$Z=[],s$h=[];0<this.borderWidth&&this.createLine2(this._points,s$Z,this.borderWidth,s$l,s$h,this._points.length/2),this.mUint16Array.set(s$Z,0),this.mFloat32Array.set(s$h,0),s$d.append(this.mUint16Array),s$L.append(this.mFloat32Array)},s$_}()),s$Ed=function(s$d){function s$b(s$d,s$L,s$l,s$Z,s$h){this._points=[];for(var s$_=NaN,s$N=NaN,s$m=-1,s$u=-1,s$x=s$l.length/2-1,s$t=0;s$t<s$x;s$t++)s$_=s$l[2*s$t],s$N=s$l[2*s$t+1],(.01<Math.abs(s$m-s$_)||.01<Math.abs(s$u-s$N))&&this._points.push(s$_,s$N),s$m=s$_,s$u=s$N;s$_=s$l[2*s$x],s$N=s$l[2*s$x+1],s$m=this._points[0],s$u=this._points[1],(.01<Math.abs(s$m-s$_)||.01<Math.abs(s$u-s$N))&&this._points.push(s$_,s$N),s$b.__super.call(this,s$d,s$L,0,0,this._points.length/2,0,s$Z,s$h)}s$q(s$b,"laya.webgl.shapes.LoopLine",s$ld);var s$L=s$b.prototype;return s$L.getData=function(s$d,s$L,s$l){if(0<this.borderWidth){for(var s$Z=this.color,s$h=(s$Z>>16&255)/255,s$_=(s$Z>>8&255)/255,s$N=(255&s$Z)/255,s$m=[],s$u=0,s$x=0,s$t=[],s$b=Math.floor(this._points.length/2),s$q=0;s$q<s$b;s$q++)s$u=this._points[2*s$q],s$x=this._points[2*s$q+1],s$m.push(this.x+s$u,this.y+s$x,s$h,s$_,s$N);this.createLoopLine(s$m,s$t,this.borderWidth,s$l+s$m.length/5),s$d.append(new Uint16Array(s$t)),s$L.append(new Float32Array(s$m))}},s$L.createLoopLine=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$d.length;var s$N=s$d.concat(),s$m=s$h||s$d,s$u=this.borderColor,s$x=(s$u>>16&255)/255,s$t=(s$u>>8&255)/255,s$b=(255&s$u)/255,s$q=[s$N[0],s$N[1]],s$Y=[s$N[s$N.length-5],s$N[s$N.length-4]],s$c=s$Y[0]+.5*(s$q[0]-s$Y[0]),s$r=s$Y[1]+.5*(s$q[1]-s$Y[1]);s$N.unshift(s$c,s$r,0,0,0),s$N.push(s$c,s$r,0,0,0);var s$a,s$k,s$e,s$w,s$s,s$A,s$y,s$$,s$O,s$n,s$V,s$Q,s$g,s$F,s$E,s$I,s$p,s$H,s$X,s$j,s$R=s$N.length/5,s$o=s$Z,s$i=s$l/2;s$e=s$N[0],s$w=s$N[1],s$n=s$e-(s$s=s$N[5]),s$O=(s$O=-(s$w-(s$A=s$N[6])))/(s$j=Math.sqrt(s$O*s$O+s$n*s$n))*s$i,s$n=s$n/s$j*s$i,s$m.push(s$e-s$O,s$w-s$n,s$x,s$t,s$b,s$e+s$O,s$w+s$n,s$x,s$t,s$b);for(var s$S=1;s$S<s$R-1;s$S++)s$e=s$N[5*(s$S-1)],s$w=s$N[5*(s$S-1)+1],s$s=s$N[5*s$S],s$A=s$N[5*s$S+1],s$y=s$N[5*(s$S+1)],s$$=s$N[5*(s$S+1)+1],s$n=s$e-s$s,s$Q=s$s-s$y,s$E=(-(s$O=(s$O=-(s$w-s$A))/(s$j=Math.sqrt(s$O*s$O+s$n*s$n))*s$i)+s$e)*(-(s$n=s$n/s$j*s$i)+s$A)-(-s$O+s$s)*(-s$n+s$w),s$H=(-(s$V=(s$V=-(s$A-s$$))/(s$j=Math.sqrt(s$V*s$V+s$Q*s$Q))*s$i)+s$y)*(-(s$Q=s$Q/s$j*s$i)+s$A)-(-s$V+s$s)*(-s$Q+s$$),s$X=(s$g=-s$n+s$w-(-s$n+s$A))*(s$p=-s$V+s$s-(-s$V+s$y))-(s$I=-s$Q+s$$-(-s$Q+s$A))*(s$F=-s$O+s$s-(-s$O+s$e)),Math.abs(s$X)<.1?(s$X+=10.1,s$m.push(s$s-s$O,s$A-s$n,s$x,s$t,s$b,s$s+s$O,s$A+s$n,s$x,s$t,s$b)):(((s$a=(s$F*s$H-s$p*s$E)/s$X)-s$s)*(s$a-s$s)+((s$k=(s$I*s$E-s$g*s$H)/s$X)-s$A)+(s$k-s$A),s$m.push(s$a,s$k,s$x,s$t,s$b,s$s-(s$a-s$s),s$A-(s$k-s$A),s$x,s$t,s$b));s$_&&(s$L=s$_);var s$B=this.edges+1;for(s$S=1;s$S<s$B;s$S++)s$L.push(s$o+2*(s$S-1),s$o+2*(s$S-1)+1,s$o+2*s$S+1,s$o+2*s$S+1,s$o+2*s$S,s$o+2*(s$S-1));return s$L.push(s$o+2*(s$S-1),s$o+2*(s$S-1)+1,s$o+1,s$o+1,s$o,s$o+2*(s$S-1)),s$m},s$b}(),s$Id=function(s$d){function s$N(s$d,s$L,s$l,s$Z,s$h,s$_){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=s$n.create(),this._points=s$l.slice(0,s$l.length),s$N.__super.call(this,s$d,s$L,0,0,this._points.length/2,s$Z,s$h,s$_)}s$q(s$N,"laya.webgl.shapes.Polygon",s$ld);var s$L=s$N.prototype;return s$L.rebuild=function(s$d){this._repaint||(this._points.length=0,this._points=this._points.concat(s$d))},s$L.setMatrix=function(s$d){s$d.copyTo(this._mat)},s$L.needUpdate=function(s$d){return this._repaint=this._mat.a==s$d.a&&this._mat.b==s$d.b&&this._mat.c==s$d.c&&this._mat.d==s$d.d&&this._mat.tx==s$d.tx&&this._mat.ty==s$d.ty,!this._repaint},s$L.getData=function(s$d,s$L,s$l){var s$Z,s$h=0,s$_=this._points,s$N=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=s$l){for(this._start=s$l,s$Z=[],s$N=this.earcutTriangles.length,s$h=0;s$h<s$N;s$h++)s$Z.push(this.earcutTriangles[s$h]+s$l);this.mUint16Array=new Uint16Array(s$Z)}}else{this._start=s$l,s$Z=[];var s$m=[],s$u=[],s$x=this.color,s$t=(s$x>>16&255)/255,s$b=(s$x>>8&255)/255,s$q=(255&s$x)/255;for(s$N=Math.floor(s$_.length/2),s$h=0;s$h<s$N;s$h++)s$m.push(this.x+s$_[2*s$h],this.y+s$_[2*s$h+1],s$t,s$b,s$q),s$u.push(this.x+s$_[2*s$h],this.y+s$_[2*s$h+1]);for(this.earcutTriangles=s$Zd.earcut(s$u,null,2),s$N=this.earcutTriangles.length,s$h=0;s$h<s$N;s$h++)s$Z.push(this.earcutTriangles[s$h]+s$l);this.mUint16Array=new Uint16Array(s$Z),this.mFloat32Array=new Float32Array(s$m)}s$d.append(this.mUint16Array),s$L.append(this.mFloat32Array)},s$N}(),s$pd=function(s$d){function s$_(){this._matrix=new s$n,this._matrix4=s$rd.defaultMatrix4.concat(),s$_.__super.call(this,1e4),this.shaderValue=new s$Od(0,0)}s$q(s$_,"laya.webgl.submit.SubmitCanvas",s$_d);var s$L=s$_.prototype;return s$L.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var s$d=s$ed.worldAlpha,s$L=s$ed.worldMatrix4,s$l=s$ed.worldMatrix,s$Z=s$ed.worldFilters,s$h=s$ed.worldShaderDefines,s$_=this.shaderValue,s$N=this._matrix,s$m=this._matrix4,s$u=s$n.TEMP;return s$n.mul(s$N,s$l,s$u),s$m[0]=s$u.a,s$m[1]=s$u.b,s$m[4]=s$u.c,s$m[5]=s$u.d,s$m[12]=s$u.tx,s$m[13]=s$u.ty,s$ed.worldMatrix=s$u.clone(),s$ed.worldMatrix4=s$m,s$ed.worldAlpha=s$ed.worldAlpha*s$_.alpha,s$_.filters&&s$_.filters.length&&(s$ed.worldFilters=s$_.filters,s$ed.worldShaderDefines=s$_.defines),this._ctx_src.flush(),s$ed.worldAlpha=s$d,s$ed.worldMatrix4=s$L,s$ed.worldMatrix.destroy(),s$ed.worldMatrix=s$l,s$ed.worldFilters=s$Z,s$ed.worldShaderDefines=s$h,1},s$L.releaseRender=function(){var s$d=s$_._cache;this._ctx_src=null,s$d[s$d._length++]=this},s$L.getRenderType=function(){return 10003},s$_.create=function(s$d,s$L,s$l){var s$Z=s$_._cache._length?s$_._cache[--s$_._cache._length]:new s$_;s$Z._ctx_src=s$d;var s$h=s$Z.shaderValue;return s$h.alpha=s$L,s$h.defines.setValue(0),s$l&&s$l.length&&s$h.setFilters(s$l),s$Z},s$_._cache=((s$_._cache=[])._length=0,s$_._cache),s$_}(),s$Hd=function(s$d){function s$x(s$d){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===s$d&&(s$d=1e4),s$x.__super.call(this,s$d)}s$q(s$x,"laya.webgl.submit.SubmitTexture",s$_d);var s$L=s$x.prototype;return s$L.releaseRender=function(){var s$d=s$x._cache;(s$d[s$d._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},s$L.addTexture=function(s$d,s$L){this._texsID[this._texs.length]=s$d._uvID,this._texs.push(s$d),this._vbPos.push(s$L)},s$L.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var s$d=this.shaderValue.textureHost.bitmap;if(null!==s$d)for(var s$L=this._vb.getFloat32Array(),s$l=0,s$Z=this._texs.length;s$l<s$Z;s$l++){var s$h=this._texs[s$l];s$h.active();var s$_=s$h.uv;if(this._texsID[s$l]!==s$h._uvID){this._texsID[s$l]=s$h._uvID;var s$N=this._vbPos[s$l];s$L[s$N+2]=s$_[0],s$L[s$N+3]=s$_[1],s$L[s$N+6]=s$_[2],s$L[s$N+7]=s$_[3],s$L[s$N+10]=s$_[4],s$L[s$N+11]=s$_[5],s$L[s$N+14]=s$_[6],s$L[s$N+15]=s$_[7],this._vb.setNeedUpload()}s$h.bitmap!==s$d&&(this._isSameTexture=!1)}}},s$L.renderSubmit=function(){if(0===this._numEle)return s$x._shaderSet=!1,1;var s$d=this.shaderValue.textureHost;if(s$d){var s$L=s$d.source;if(!s$d.bitmap||!s$L)return s$x._shaderSet=!1,1;this.shaderValue.texture=s$L,s$d.alphaTexture&&s$d.alphaTexture.source&&(this.shaderValue.texture1=s$d.alphaTexture.source)}this._vb.bind_upload(this._ib);var s$l=s$sd.mainContext;if(s$P.activeBlendFunction!==this._blendFn&&(s$l.enable(3042),this._blendFn(s$l),s$P.activeBlendFunction=this._blendFn),s$E.drawCall++,s$E.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&s$jd.activeShader&&s$x._shaderSet?(s$jd.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&s$jd.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),s$x._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var s$Z=s$d.bitmap,s$h=0,s$_=s$jd.activeShader,s$N=0,s$m=this._texs.length;s$N<s$m;s$N++){var s$u=this._texs[s$N];s$u.bitmap===s$Z&&s$N+1!==s$m||(s$_.uploadTexture2D(s$u.source),s$l.drawElements(4,6*(s$N-s$h+1),5123,this._startIdx+6*s$h*s$rd.BYTES_PIDX),s$Z=s$u.bitmap,s$h=s$N)}else s$l.drawElements(4,this._numEle,5123,this._startIdx);return 1},s$x.create=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$x._cache._length?s$x._cache[--s$x._cache._length]:new s$x;null==s$l&&((s$l=s$_._selfVb||(s$_._selfVb=s$Md.create(-1))).clear(),s$Z=0),s$_._ib=s$L,s$_._vb=s$l,s$_._startIdx=s$Z*s$rd.BYTES_PIDX,s$_._numEle=0;var s$N=s$d._nBlendType;s$_._blendFn=s$d._targets?s$P.targetFns[s$N]:s$P.fns[s$N],s$_.shaderValue=s$h,s$_.shaderValue.setValue(s$d._shader2D);var s$m=s$d._shader2D.filters;return s$m&&s$_.shaderValue.setFilters(s$m),s$_},s$x._cache=((s$x._cache=[])._length=0,s$x._cache),s$x._shaderSet=!0,s$x}(),s$Xd=function(s$d){function s$k(){s$k.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}s$q(s$k,"laya.webgl.utils.MeshTexture",s$kd);var s$L=s$k.prototype;return s$L.addData=function(s$d,s$L,s$l,s$Z,s$h,s$_){for(var s$N=s$d.length/2,s$m=this._vb.needSize(s$N*s$k.const_stride)>>2,s$u=this._vb.getFloat32Array(),s$x=0,s$t=0;s$t<s$N;s$t++){var s$b=s$d[s$x],s$q=s$d[s$x+1],s$Y=s$b*s$Z.a+s$q*s$Z.c+s$Z.tx,s$c=s$b*s$Z.b+s$q*s$Z.d+s$Z.ty;s$u[s$m++]=s$Y,s$u[s$m++]=s$c,s$u[s$m++]=s$L[s$x],s$u[s$m++]=s$L[s$x+1],s$x+=2}this._vb.setNeedUpload();var s$r=this.vertNum;if(0<s$r){(s$N=s$l.length)>s$k.tmpIdx.length&&(s$k.tmpIdx=new Uint16Array(s$N));for(var s$a=0;s$a<s$N;s$a++)s$k.tmpIdx[s$a]=s$l[s$a]+s$r;this._ib.appendU16Array(s$k.tmpIdx,s$l.length)}else this._ib.append(s$l);this._ib.setNeedUpload(),this.vertNum+=s$N,this.indexNum+=s$l.length},s$L.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},s$L.destroy=function(){this._ib.destroy(),this._vb.destroy()},s$k.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new s$k},s$k.const_stride=16,s$k._POOL=[],s$N(s$k,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),s$k}(),s$jd=function(s$d){function s$L(){s$L.__super.call(this),this.lock=!0}return s$q(s$L,"laya.webgl.shader.BaseShader",s$w),s$L.activeShader=null,s$L.bindShader=null,s$L}(),s$Rd=function(s$L){function s$t(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=5121),void 0===s$h&&(s$h=34041),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=-1),void 0===s$u&&(s$u=-1),this._type=1,this._w=s$d,this._h=s$L,this._surfaceFormat=s$l,this._surfaceType=s$Z,this._depthStencilFormat=s$h,s$k.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=s$_,this._repeat=s$N,this._minFifter=s$m,this._magFifter=s$u,this._createWebGLRenderTarget(),this.bitmap.lock=!0,s$t.__super.call(this,this.bitmap,s$X.INV_UV)}s$q(s$t,"laya.webgl.resource.RenderTarget2D",s$L);var s$d=s$t.prototype;return s$y.imps(s$d,{"laya.resource.IDispose":!0}),s$d.getType=function(){return this._type},s$d.getTexture=function(){return this},s$d.size=function(s$d,s$L){this._w==s$d&&this._h==s$L||(this._w=s$d,this._h=s$L,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},s$d.release=function(){this.destroy()},s$d.recycle=function(){s$t.POOL.push(this)},s$d.start=function(){var s$d=s$sd.mainContext;return this._preRenderTarget=s$ed.curRenderTarget,s$ed.curRenderTarget=this,s$d.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(s$d.viewport(0,0,this._w,this._h),this._svWidth=s$ed.width,this._svHeight=s$ed.height,s$ed.width=this._w,s$ed.height=this._h,s$jd.activeShader=null),this},s$d.clear=function(s$d,s$L,s$l,s$Z){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=1);var s$h=s$sd.mainContext;s$h.clearColor(s$d,s$L,s$l,s$Z);var s$_=16384;switch(this._depthStencilFormat){case 33189:s$_|=256;break;case 36168:s$_|=1024;break;case 34041:s$_|=256,s$_|=1024}s$h.clear(s$_)},s$d.end=function(){var s$d=s$sd.mainContext;s$d.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,s$ed.curRenderTarget=this._preRenderTarget,1==this._type?(s$d.viewport(0,0,this._svWidth,this._svHeight),s$ed.width=this._svWidth,s$ed.height=this._svHeight,s$jd.activeShader=null):s$d.viewport(0,0,s$y.stage.width,s$y.stage.height)},s$d.getData=function(s$d,s$L,s$l,s$Z){var s$h=s$sd.mainContext;if(s$h.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===s$h.checkFramebufferStatus(36160)))return s$h.bindFramebuffer(36160,null),null;var s$_=new Uint8Array(this._w*this._h*4);return s$h.readPixels(s$d,s$L,s$l,s$Z,this._surfaceFormat,this._surfaceType,s$_),s$h.bindFramebuffer(36160,null),s$_},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,s$L.prototype.destroy.call(this))},s$d.dispose=function(){},s$d._createWebGLRenderTarget=function(){this.bitmap=new s$Gd(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(s$d){this.event("recovered")})},s$Z(0,s$d,"surfaceFormat",function(){return this._surfaceFormat}),s$Z(0,s$d,"magFifter",function(){return this._magFifter}),s$Z(0,s$d,"surfaceType",function(){return this._surfaceType}),s$Z(0,s$d,"mipMap",function(){return this._mipMap}),s$Z(0,s$d,"depthStencilFormat",function(){return this._depthStencilFormat}),s$Z(0,s$d,"minFifter",function(){return this._minFifter}),s$Z(0,s$d,"source",function(){return this._alreadyResolved?s$y.superGet(s$X,this,"source"):null}),s$t.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){void 0===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=5121),void 0===s$h&&(s$h=34041),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=-1),void 0===s$u&&(s$u=-1);var s$x=s$t.POOL.pop();return s$x||(s$x=new s$t(s$d,s$L)),s$x.bitmap&&s$x._w==s$d&&s$x._h==s$L&&s$x._surfaceFormat==s$l&&s$x._surfaceType==s$Z&&s$x._depthStencilFormat==s$h&&s$x._mipMap==s$_&&s$x._repeat==s$N&&s$x._minFifter==s$m&&s$x._magFifter==s$u||(s$x._w=s$d,s$x._h=s$L,s$x._surfaceFormat=s$l,s$x._surfaceType=s$Z,s$x._depthStencilFormat=s$h,s$k.isConchWebGL&&34041===s$x._depthStencilFormat&&(s$x._depthStencilFormat=33189),s$x._mipMap=s$_,s$x._repeat=s$N,s$x._minFifter=s$m,s$x._magFifter=s$u,s$x.release(),s$x._createWebGLRenderTarget()),s$x},s$t.TYPE2D=1,s$t.TYPE3D=2,s$t.POOL=[],s$t}(s$X),s$od=function(s$d){function s$L(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,s$L.__super.call(this),s$L._gl=s$sd.mainContext}s$q(s$L,"laya.webgl.utils.Buffer",s$w);var s$l=s$L.prototype;return s$l._bind=function(){this.activeResource(),s$L._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(s$L._bindVertexBuffer=this._glBuffer),s$L._gl.bindBuffer(this._bufferType,s$L._bindActive[this._bufferType]=this._glBuffer),s$jd.activeShader=null)},s$l.recreateResource=function(){this._glBuffer||(this._glBuffer=s$L._gl.createBuffer()),this.completeCreate()},s$l.disposeResource=function(){this._glBuffer&&(s$sd.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},s$Z(0,s$l,"bufferUsage",function(){return this._bufferUsage}),s$L._gl=null,s$L._bindActive={},s$L._bindVertexBuffer=null,s$L._enableAtributes=[],s$L}(),s$id=function(s$d){function s$l(s$d){this.texcoord=null,this.offsetX=300,this.offsetY=0,s$l.__super.call(this,512,0);var s$L=8*s$rd.BYTES_PE;this.position=[2,5126,!1,s$L,0],this.texcoord=[2,5126,!1,s$L,2*s$rd.BYTES_PE],this.color=[4,5126,!1,s$L,4*s$rd.BYTES_PE]}return s$q(s$l,"laya.webgl.shader.d2.skinAnishader.SkinSV",s$Od),s$l}(),s$Sd=function(s$d){function s$L(s$d){s$L.__super.call(this,2,0),this.color=[]}return s$q(s$L,"laya.webgl.shader.d2.value.Color2dSV",s$Od),s$L.prototype.setValue=function(s$d){s$d.fillStyle&&(this.color=s$d.fillStyle._color._color),s$d.strokeStyle&&(this.color=s$d.strokeStyle._color._color)},s$L}(),s$Bd=function(s$d){function s$L(s$d){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=s$Od._TEXCOORD,s$L.__super.call(this,256,0)}s$q(s$L,"laya.webgl.shader.d2.value.FillTextureSV",s$Od);var s$l=s$L.prototype;return s$l.setValue=function(s$d){this.ALPHA=s$d.ALPHA,s$d.filters&&this.setFilters(s$d.filters)},s$l.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},s$L}(),s$Cd=function(s$d){function s$L(s$d){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=s$Od._TEXCOORD,void 0===s$d&&(s$d=0),s$L.__super.call(this,1,s$d)}s$q(s$L,"laya.webgl.shader.d2.value.TextureSV",s$Od);var s$l=s$L.prototype;return s$l.setValue=function(s$d){this.ALPHA=s$d.ALPHA,s$d.filters&&this.setFilters(s$d.filters)},s$l.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},s$L}(),s$Pd=function(s$d){function s$L(s$d){this.a_color=null,this.u_pos=[0,0],s$L.__super.call(this,4,0),this.position=[2,5126,!1,5*s$rd.BYTES_PE,0],this.a_color=[3,5126,!1,5*s$rd.BYTES_PE,2*s$rd.BYTES_PE]}return s$q(s$L,"laya.webgl.shader.d2.value.PrimitiveSV",s$Od),s$L}(),s$Td=function(s$d){function s$L(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,s$L.__super.call(this)}s$q(s$L,"laya.webgl.atlas.AtlasWebGLCanvas",s$d);var s$l=s$L.prototype;return s$l.recreateResource=function(){var s$d=s$sd.mainContext,s$L=this._source=s$d.createTexture(),s$l=s$Ad.curBindTexTarget,s$Z=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,s$L),s$d.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),s$d.texParameteri(3553,10241,9729),s$d.texParameteri(3553,10240,9729),s$d.texParameteri(3553,10242,33071),s$d.texParameteri(3553,10243,33071),s$l&&s$Z&&s$Ad.bindTexture(s$d,s$l,s$Z),this.memorySize=this._w*this._h*4,this.completeCreate()},s$l.disposeResource=function(){this._source&&(s$sd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},s$l.texSubImage2D=function(s$d,s$L,s$l){if(s$k.isFlash){this._flashCacheImage||(this._flashCacheImage=s$r.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var s$Z=s$l.bitmapdata;this._flashCacheImage._image.copyPixels(s$Z,0,0,s$Z.width,s$Z.height,s$d,s$L),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var s$h=s$sd.mainContext,s$_=s$Ad.curBindTexTarget,s$N=s$Ad.curBindTexValue;s$Ad.bindTexture(s$h,3553,this._source),s$h.pixelStorei(37441,!0),0<=s$d-1&&s$h.texSubImage2D(3553,0,s$d-1,s$L,6408,5121,s$l),s$d+1<=this._w&&s$h.texSubImage2D(3553,0,s$d+1,s$L,6408,5121,s$l),0<=s$L-1&&s$h.texSubImage2D(3553,0,s$d,s$L-1,6408,5121,s$l),s$L+1<=this._h&&s$h.texSubImage2D(3553,0,s$d,s$L+1,6408,5121,s$l),s$h.texSubImage2D(3553,0,s$d,s$L,6408,5121,s$l),s$h.pixelStorei(37441,!1),s$_&&s$N&&s$Ad.bindTexture(s$h,s$_,s$N)}},s$l.texSubImage2DPixel=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$sd.mainContext,s$N=s$Ad.curBindTexTarget,s$m=s$Ad.curBindTexValue;s$Ad.bindTexture(s$_,3553,this._source);var s$u=new Uint8Array(s$h.data);s$_.pixelStorei(37441,!0),s$_.texSubImage2D(3553,0,s$d,s$L,s$l,s$Z,6408,5121,s$u),s$_.pixelStorei(37441,!1),s$N&&s$m&&s$Ad.bindTexture(s$_,s$N,s$m)},s$Z(0,s$l,"width",s$d.prototype._$get_width,function(s$d){this._w=s$d}),s$Z(0,s$l,"height",s$d.prototype._$get_height,function(s$d){this._h=s$d}),s$L}(s$l),s$zd=function(s$d){function s$h(){this.flipY=!0,this.alwaysChange=!1,s$h.__super.call(this)}s$q(s$h,"laya.webgl.resource.WebGLCanvas",s$l);var s$L=s$h.prototype;return s$L.getCanvas=function(){return this._canvas},s$L.clear=function(){this._ctx&&this._ctx.clear()},s$L.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},s$L._setContext=function(s$d){this._ctx=s$d},s$L.getContext=function(s$d,s$L){return this._ctx?this._ctx:this._ctx=s$h._createContext(this)},s$L.size=function(s$d,s$L){this._w==s$d&&this._h==s$L||(this._w=s$d,this._h=s$L,this._ctx&&this._ctx.size(s$d,s$L),this._canvas&&(this._canvas.height=s$L,this._canvas.width=s$d))},s$L.activeResource=function(s$d){void 0===s$d&&(s$d=!1),this._source||this.recreateResource()},s$L.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},s$L.disposeResource=function(){this._source&&!this.iscpuSource&&(s$sd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},s$L.createWebGlTexture=function(){var s$d=s$sd.mainContext;this._canvas;var s$L=this._source=s$d.createTexture();this.iscpuSource=!1;var s$l=s$Ad.curBindTexTarget,s$Z=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,s$L),s$d.pixelStorei(37440,this.flipY?1:0),s$h.premulAlpha&&s$d.pixelStorei(37441,!0),s$d.texImage2D(3553,0,6408,6408,5121,this._imgData),s$h.premulAlpha&&s$d.pixelStorei(37441,!1),s$d.texParameteri(3553,10240,9729),s$d.texParameteri(3553,10241,9729),s$d.texParameteri(3553,10242,33071),s$d.texParameteri(3553,10243,33071),s$d.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,s$l&&s$Z&&s$Ad.bindTexture(s$d,s$l,s$Z)},s$L.reloadCanvasData=function(){var s$d=s$sd.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var s$L=s$Ad.curBindTexTarget,s$l=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,this._source),s$h.premulAlpha&&s$d.pixelStorei(37441,!0),s$d.texImage2D(3553,0,6408,6408,5121,this._imgData),s$h.premulAlpha&&s$d.pixelStorei(37441,!1),s$d.pixelStorei(37440,0),s$L&&s$l&&s$Ad.bindTexture(s$d,s$L,s$l)},s$L.texSubImage2D=function(s$d,s$L,s$l){var s$Z=s$sd.mainContext,s$h=s$Ad.curBindTexTarget,s$_=s$Ad.curBindTexValue;s$Ad.bindTexture(s$Z,3553,this._source),s$Z.pixelStorei(37441,!0),s$Z.texSubImage2D(3553,0,s$L,s$l,6408,5121,s$d._source),s$Z.pixelStorei(37441,!1),s$h&&s$_&&s$Ad.bindTexture(s$Z,s$h,s$_)},s$L.toBase64=function(s$d,s$L,s$l){var s$Z=null;this._canvas&&(s$Z=this._canvas.toDataURL(s$d,s$L)),s$l.call(this,s$Z)},s$Z(0,s$L,"context",function(){return this._ctx}),s$Z(0,s$L,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),s$Z(0,s$L,"asBitmap",null,function(s$d){this._ctx&&(this._ctx.asBitmap=s$d)}),s$h._createContext=null,s$h.premulAlpha=!1,s$h}(),s$Dd=function(s$d){function s$_(s$d,s$L){this.CborderSize=12,s$_.__super.call(this),this.char=s$d,this.isSpace=" "===s$d,this.xs=s$L.scaleX,this.ys=s$L.scaleY,this.font=s$L.font.toString(),this.fontSize=s$L.font.size,this.fillColor=s$L.fillColor,this.borderColor=s$L.borderColor,this.lineWidth=s$L.lineWidth,this.underLine=s$L.underLine;var s$l,s$Z=s$k.isConchApp;s$Z?((s$l=ConchTextCanvas)._source=ConchTextCanvas,s$l._source.canvas=ConchTextCanvas):s$l=s$Y.canvas.source,this.canvas=s$l,this._enableMerageInAtlas=!0,this._ctx=s$Z?s$l:this.canvas.getContext("2d",void 0);var s$h=s$j.measureText(this.char,this.font);this.cw=s$h.width*this.xs,this.ch=(s$h.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new s$X(this)}s$q(s$_,"laya.webgl.resource.WebGLCharImage",s$l);var s$L=s$_.prototype;return s$y.imps(s$L,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),s$L.active=function(){this.texture.active()},s$L.recreateResource=function(){var s$d=s$k.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),s$d){var s$L=this.fontSize;1==this.xs&&1==this.ys||(s$L=parseInt(s$L*(this.xs>this.ys?this.xs:this.ys)+""));var s$l="normal 100 "+this.font;s$l=s$l.replace(s$_._fontSizeReg,s$L),this.borderColor&&(s$l+=" 1 "+this.borderColor),this._ctx.font=s$l,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,s$H.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var s$Z=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(s$Z,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},s$L.onresize=function(s$d,s$L){this._w=s$d,this._h=s$L,this._allowMerageInAtlas=!0},s$L.clearAtlasSource=function(){},s$Z(0,s$L,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),s$Z(0,s$L,"atlasSource",function(){return this.canvas}),s$Z(0,s$L,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(s$d){this._enableMerageInAtlas=s$d}),s$_.createOneChar=function(s$d,s$L){return new s$_(s$d,s$L)},s$_._fontSizeReg=new RegExp("\\d+(?=px)","g"),s$_}(),s$Gd=function(s$d){function s$x(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){void 0===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=5121),void 0===s$h&&(s$h=34041),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=-1),void 0===s$u&&(s$u=1),s$x.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=s$d,this._h=s$L,this._surfaceFormat=s$l,this._surfaceType=s$Z,this._depthStencilFormat=s$h,this._mipMap=s$_,this._repeat=s$N,this._minFifter=s$m,this._magFifter=s$u}s$q(s$x,"laya.webgl.resource.WebGLRenderTarget",s$l);var s$L=s$x.prototype;return s$L.recreateResource=function(){var s$d=s$sd.mainContext;this._frameBuffer||(this._frameBuffer=s$d.createFramebuffer()),this._source||(this._source=s$d.createTexture());var s$L=s$Ad.curBindTexTarget,s$l=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,this._source),s$d.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var s$Z=this._minFifter,s$h=this._magFifter,s$_=this._repeat?10497:33071,s$N=s$t.isPOT(this._w,this._h);if(s$N?(this._mipMap?-1!==s$Z||(s$Z=9987):-1!==s$Z||(s$Z=9729),-1!==s$h||(s$h=9729),s$d.texParameteri(3553,10241,s$Z),s$d.texParameteri(3553,10240,s$h),s$d.texParameteri(3553,10242,s$_),s$d.texParameteri(3553,10243,s$_),this._mipMap&&s$d.generateMipmap(3553)):(-1!==s$Z||(s$Z=9729),-1!==s$h||(s$h=9729),s$d.texParameteri(3553,10241,s$Z),s$d.texParameteri(3553,10240,s$h),s$d.texParameteri(3553,10242,33071),s$d.texParameteri(3553,10243,33071)),s$d.bindFramebuffer(36160,this._frameBuffer),s$d.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=s$d.createRenderbuffer()),s$d.bindRenderbuffer(36161,this._depthStencilBuffer),s$d.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:s$d.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:s$d.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:s$d.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}s$d.bindFramebuffer(36160,null),s$L&&s$l&&s$Ad.bindTexture(s$d,s$L,s$l),s$d.bindRenderbuffer(36161,null),s$N&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},s$L.disposeResource=function(){this._frameBuffer&&(s$sd.mainContext.deleteTexture(this._source),s$sd.mainContext.deleteFramebuffer(this._frameBuffer),s$sd.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},s$Z(0,s$L,"depthStencilBuffer",function(){return this._depthStencilBuffer}),s$Z(0,s$L,"frameBuffer",function(){return this._frameBuffer}),s$x}(),s$Kd=function(s$d){function s$m(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this.offsetX=0,this.offsetY=0,s$m.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=s$_,this.canvas=s$d,this._ctx=s$d.getContext("2d",void 0),this._w=s$Z,this._h=s$h,this.offsetX=s$L,this.offsetY=s$l,this.src=s$N,this._enableMerageInAtlas=!0,s$B.enabled&&this._w<s$B.atlasLimitWidth&&this._h<s$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}s$q(s$m,"laya.webgl.resource.WebGLSubImage",s$l);var s$L=s$m.prototype;return s$y.imps(s$L,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),s$L.size=function(s$d,s$L){this._w=s$d,this._h=s$L,this._ctx&&this._ctx.size(s$d,s$L),this.canvas&&(this.canvas.height=s$L,this.canvas.width=s$d)},s$L.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},s$L.createWebGlTexture=function(){var s$d=s$sd.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var s$L=this._source=s$d.createTexture(),s$l=s$Ad.curBindTexTarget,s$Z=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,s$L),s$d.pixelStorei(37441,!0),s$d.texImage2D(3553,0,6408,6408,5121,this.canvas),s$d.pixelStorei(37441,!1);var s$h=this.minFifter,s$_=this.magFifter,s$N=this.repeat?10497:33071,s$m=s$t.isPOT(this.width,this.height);s$m?(this.mipmap?-1!==s$h||(s$h=9987):-1!==s$h||(s$h=9729),-1!==s$_||(s$_=9729),s$d.texParameteri(3553,10240,s$_),s$d.texParameteri(3553,10241,s$h),s$d.texParameteri(3553,10242,s$N),s$d.texParameteri(3553,10243,s$N),this.mipmap&&s$d.generateMipmap(3553)):(-1!==s$h||(s$h=9729),-1!==s$_||(s$_=9729),s$d.texParameteri(3553,10241,s$h),s$d.texParameteri(3553,10240,s$_),s$d.texParameteri(3553,10242,33071),s$d.texParameteri(3553,10243,33071)),s$l&&s$Z&&s$Ad.bindTexture(s$d,s$l,s$Z),this.canvas=null,s$m&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},s$L.disposeResource=function(){s$B.enabled&&this._allowMerageInAtlas||!this._source||(s$sd.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},s$L.clearAtlasSource=function(){},s$Z(0,s$L,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),s$Z(0,s$L,"atlasSource",function(){return this.canvas}),s$Z(0,s$L,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(s$d){this._allowMerageInAtlas=s$d}),s$m}(),s$vd=function(s$d){function s$x(s$d,s$L,s$l,s$Z){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,s$x.__super.call(this),!s$d||!s$L)throw"Shader Error";this._id=++s$x._count,this._vs=s$d,this._ps=s$L,this._nameMap=s$Z||{},null!=s$l&&(s$x.sharders[s$l]=this)}s$q(s$x,"laya.webgl.shader.Shader",s$jd);var s$L=s$x.prototype;return s$L.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},s$L.disposeResource=function(){s$sd.mainContext.deleteShader(this._vshader),s$sd.mainContext.deleteShader(this._pshader),s$sd.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},s$L._compile=function(){if(!s$sd.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var s$d=[this._vs,this._ps],s$L=s$sd.mainContext;if(this._program=s$L.createProgram(),this._vshader=s$x._createShader(s$L,s$d[0],35633),this._pshader=s$x._createShader(s$L,s$d[1],35632),s$L.attachShader(this._program,this._vshader),s$L.attachShader(this._program,this._pshader),s$L.linkProgram(this._program),!s$k.isConchApp&&!s$L.getProgramParameter(this._program,35714))throw s$L.getProgramInfoLog(this._program);var s$l,s$Z,s$h=0,s$_=0;for(s$_=s$k.isConchApp?s$L.getProgramParameterEx(this._vs,this._ps,"",35721):s$L.getProgramParameter(this._program,35721),s$h=0;s$h<s$_;s$h++){var s$N=null;s$l={vartype:"attribute",glfun:null,ivartype:0,attrib:s$N=s$k.isConchApp?s$L.getActiveAttribEx(this._vs,this._ps,"",s$h):s$L.getActiveAttrib(this._program,s$h),location:s$L.getAttribLocation(this._program,s$N.name),name:s$N.name,type:s$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(s$l)}var s$m=0;for(s$m=s$k.isConchApp?s$L.getProgramParameterEx(this._vs,this._ps,"",35718):s$L.getProgramParameter(this._program,35718),s$h=0;s$h<s$m;s$h++){var s$u=null;s$u=s$k.isConchApp?s$L.getActiveUniformEx(this._vs,this._ps,"",s$h):s$L.getActiveUniform(this._program,s$h),0<(s$l={vartype:"uniform",glfun:null,ivartype:1,attrib:s$N,location:s$L.getUniformLocation(this._program,s$u.name),name:s$u.name,type:s$u.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(s$l.name=s$l.name.substr(0,s$l.name.length-3),s$l.isArray=!0,s$l.location=s$L.getUniformLocation(this._program,s$l.name)),this._params.push(s$l)}for(s$h=0,s$Z=this._params.length;s$h<s$Z;s$h++)if((s$l=this._params[s$h]).indexOfParams=s$h,s$l.index=1,s$l.value=[s$l.location,null],s$l.codename=s$l.name,s$l.name=this._nameMap[s$l.codename]?this._nameMap[s$l.codename]:s$l.codename,(this._paramsMap[s$l.name]=s$l)._this=this,s$l.uploadedValue=[],"attribute"!==s$l.vartype)switch(s$l.type){case 5124:s$l.fun=s$l.isArray?this._uniform1iv:this._uniform1i;break;case 5126:s$l.fun=s$l.isArray?this._uniform1fv:this._uniform1f;break;case 35664:s$l.fun=s$l.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:s$l.fun=s$l.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:s$l.fun=s$l.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:s$l.fun=this._uniform_sampler2D;break;case 35680:s$l.fun=this._uniform_samplerCube;break;case 35676:s$l.glfun=s$L.uniformMatrix4fv,s$l.fun=this._uniformMatrix4fv;break;case 35670:s$l.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else s$l.fun=this._attribute}},s$L.getUniform=function(s$d){return this._paramsMap[s$d]},s$L._attribute=function(s$d,s$L){var s$l=s$sd.mainContext,s$Z=s$od._enableAtributes,s$h=s$d.location;return s$Z[s$h]||s$l.enableVertexAttribArray(s$h),s$l.vertexAttribPointer(s$h,s$L[0],s$L[1],s$L[2],s$L[3],s$L[4]+this._offset),s$Z[s$h]=s$od._bindVertexBuffer,1},s$L._uniform1f=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L?(s$sd.mainContext.uniform1f(s$d.location,s$l[0]=s$L),1):0},s$L._uniform1fv=function(s$d,s$L){if(s$L.length<4){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$sd.mainContext.uniform1fv(s$d.location,s$L),s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3],1):0}return s$sd.mainContext.uniform1fv(s$d.location,s$L),1},s$L._uniform_vec2=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]?(s$sd.mainContext.uniform2f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1]),1):0},s$L._uniform_vec2v=function(s$d,s$L){if(s$L.length<2){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$sd.mainContext.uniform2fv(s$d.location,s$L),s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3],1):0}return s$sd.mainContext.uniform2fv(s$d.location,s$L),1},s$L._uniform_vec3=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]?(s$sd.mainContext.uniform3f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2]),1):0},s$L._uniform_vec3v=function(s$d,s$L){return s$sd.mainContext.uniform3fv(s$d.location,s$L),1},s$L._uniform_vec4=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$sd.mainContext.uniform4f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3]),1):0},s$L._uniform_vec4v=function(s$d,s$L){return s$sd.mainContext.uniform4fv(s$d.location,s$L),1},s$L._uniformMatrix2fv=function(s$d,s$L){return s$sd.mainContext.uniformMatrix2fv(s$d.location,!1,s$L),1},s$L._uniformMatrix3fv=function(s$d,s$L){return s$sd.mainContext.uniformMatrix3fv(s$d.location,!1,s$L),1},s$L._uniformMatrix4fv=function(s$d,s$L){return s$sd.mainContext.uniformMatrix4fv(s$d.location,!1,s$L),1},s$L._uniform1i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L?(s$sd.mainContext.uniform1i(s$d.location,s$l[0]=s$L),1):0},s$L._uniform1iv=function(s$d,s$L){return s$sd.mainContext.uniform1iv(s$d.location,s$L),1},s$L._uniform_ivec2=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]?(s$sd.mainContext.uniform2i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1]),1):0},s$L._uniform_ivec2v=function(s$d,s$L){return s$sd.mainContext.uniform2iv(s$d.location,s$L),1},s$L._uniform_vec3i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]?(s$sd.mainContext.uniform3i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2]),1):0},s$L._uniform_vec3vi=function(s$d,s$L){return s$sd.mainContext.uniform3iv(s$d.location,s$L),1},s$L._uniform_vec4i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$sd.mainContext.uniform4i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3]),1):0},s$L._uniform_vec4vi=function(s$d,s$L){return s$sd.mainContext.uniform4iv(s$d.location,s$L),1},s$L._uniform_sampler2D=function(s$d,s$L){var s$l=s$sd.mainContext,s$Z=s$d.uploadedValue;return null==s$Z[0]?(s$Z[0]=this._curActTexIndex,s$l.uniform1i(s$d.location,this._curActTexIndex),s$l.activeTexture(s$x._TEXTURES[this._curActTexIndex]),s$Ad.bindTexture(s$l,3553,s$L),this._curActTexIndex++,1):(s$l.activeTexture(s$x._TEXTURES[s$Z[0]]),s$Ad.bindTexture(s$l,3553,s$L),0)},s$L._uniform_samplerCube=function(s$d,s$L){var s$l=s$sd.mainContext,s$Z=s$d.uploadedValue;return null==s$Z[0]?(s$Z[0]=this._curActTexIndex,s$l.uniform1i(s$d.location,this._curActTexIndex),s$l.activeTexture(s$x._TEXTURES[this._curActTexIndex]),s$Ad.bindTexture(s$l,34067,s$L),this._curActTexIndex++,1):(s$l.activeTexture(s$x._TEXTURES[s$Z[0]]),s$Ad.bindTexture(s$l,34067,s$L),0)},s$L._noSetValue=function(s$d){console.log("no....:"+s$d.name)},s$L.uploadOne=function(s$d,s$L){this.activeResource(),s$Ad.UseProgram(this._program);var s$l=this._paramsMap[s$d];s$l.fun.call(this,s$l,s$L)},s$L.uploadTexture2D=function(s$d){s$E.shaderCall++;var s$L=s$sd.mainContext;s$L.activeTexture(33984),s$Ad.bindTexture(s$L,3553,s$d)},s$L.uploadTexture2D1=function(s$d){s$E.shaderCall++;var s$L=s$sd.mainContext;s$L.activeTexture(33985),s$Ad.bindTexture(s$L,3553,s$d)},s$L.upload=function(s$d,s$L){s$jd.activeShader=s$jd.bindShader=this,this._lastUseFrameCount===s$E.loopCount||this.activeResource(),s$Ad.UseProgram(this._program),this._reCompile?(s$L=this._params,this._reCompile=!1):s$L=s$L||this._params;s$sd.mainContext;for(var s$l,s$Z,s$h=s$L.length,s$_=0,s$N=0;s$N<s$h;s$N++)null!==(s$Z=s$d[(s$l=s$L[s$N]).name])&&(s$_+=s$l.fun.call(this,s$l,s$Z));s$E.shaderCall+=s$_},s$L.uploadArray=function(s$d,s$L,s$l){s$jd.activeShader=this,(s$jd.bindShader=this).activeResource(),s$Ad.UseProgram(this._program);this._params;for(var s$Z,s$h,s$_=0,s$N=s$L-2;0<=s$N;s$N-=2)(s$h=this._paramsMap[s$d[s$N]])&&null!=(s$Z=s$d[s$N+1])&&(s$l&&s$l[s$h.name]&&s$l[s$h.name].bind(),s$_+=s$h.fun.call(this,s$h,s$Z));s$E.shaderCall+=s$_},s$L.getParams=function(){return this._params},s$x.getShader=function(s$d){return s$x.sharders[s$d]},s$x.create=function(s$d,s$L,s$l,s$Z){return new s$x(s$d,s$L,s$l,s$Z)},s$x.withCompile=function(s$d,s$L,s$l,s$Z){if(s$l&&s$x.sharders[s$l])return s$x.sharders[s$l];var s$h=s$x._preCompileShader[2e-4*s$d];if(!s$h)throw new Error("withCompile shader err!"+s$d);return s$h.createShader(s$L,s$l,s$Z)},s$x.withCompile2D=function(s$d,s$L,s$l,s$Z,s$h){if(s$Z&&s$x.sharders[s$Z])return s$x.sharders[s$Z];var s$_=s$x._preCompileShader[2e-4*s$d+s$L];if(!s$_)throw new Error("withCompile shader err!"+s$d+" "+s$L);return s$_.createShader(s$l,s$Z,s$h)},s$x.addInclude=function(s$d,s$L){s$wd.addInclude(s$d,s$L)},s$x.preCompile=function(s$d,s$L,s$l,s$Z){var s$h=2e-4*s$d;s$x._preCompileShader[s$h]=new s$wd(s$h,s$L,s$l,s$Z)},s$x.preCompile2D=function(s$d,s$L,s$l,s$Z,s$h){var s$_=2e-4*s$d+s$L;s$x._preCompileShader[s$_]=new s$wd(s$_,s$l,s$Z,s$h)},s$x._createShader=function(s$d,s$L,s$l){var s$Z=s$d.createShader(s$l);return s$d.shaderSource(s$Z,s$L),s$d.compileShader(s$Z),s$Z},s$x._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],s$x._count=0,s$x._preCompileShader={},s$x.SHADERNAME2ID=2e-4,s$x.sharders=((s$x.sharders=[]).length=32,s$x.sharders),s$N(s$x,["nameKey",function(){return this.nameKey=new s$I}]),s$x}(),s$Jd=function(s$d){function s$L(){this._maxsize=0,this._upload=!0,this._uploadSize=0,s$L.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}s$q(s$L,"laya.webgl.utils.Buffer2D",s$d);var s$l=s$L.prototype;return s$l.needSize=function(s$d){var s$L=this._byteLength;if(s$d){var s$l=this._byteLength+s$d;s$l<=this._buffer.byteLength||this._resizeBuffer(s$l<<1,!0),this._byteLength=s$l}return s$L},s$l._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),s$E.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,s$od._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),s$od._gl.bufferSubData(this._bufferType,0,this._buffer)},s$l._bufferSubData=function(s$d,s$L,s$l){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),this._maxsize=Math.max(this._maxsize,this._byteLength),s$E.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,s$od._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),s$L||s$l){var s$Z=this._buffer.slice(s$L,s$l);s$od._gl.bufferSubData(this._bufferType,s$d,s$Z)}else s$od._gl.bufferSubData(this._bufferType,s$d,this._buffer)},s$l._checkArrayUse=function(){},s$l._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},s$l._bind_subUpload=function(s$d,s$L,s$l){return void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(s$d,s$L,s$l),!0)},s$l._resizeBuffer=function(s$d,s$L){if(s$d<this._buffer.byteLength)return this;if(this.memorySize=s$d,s$L&&this._buffer&&0<this._buffer.byteLength){var s$l=new ArrayBuffer(s$d);new Uint8Array(s$l).set(new Uint8Array(this._buffer),0),this._buffer=s$l}else this._buffer=new ArrayBuffer(s$d);return this._checkArrayUse(),this._upload=!0,this},s$l.append=function(s$d){this._upload=!0;var s$L,s$l;s$L=s$d.byteLength,s$d instanceof Uint8Array?(this._resizeBuffer(this._byteLength+s$L,!0),s$l=new Uint8Array(this._buffer,this._byteLength)):s$d instanceof Uint16Array?(this._resizeBuffer(this._byteLength+s$L,!0),s$l=new Uint16Array(this._buffer,this._byteLength)):s$d instanceof Float32Array&&(this._resizeBuffer(this._byteLength+s$L,!0),s$l=new Float32Array(this._buffer,this._byteLength)),s$l.set(s$d,0),this._byteLength+=s$L,this._checkArrayUse()},s$l.appendU16Array=function(s$d,s$L){this._resizeBuffer(this._byteLength+2*s$L,!0);for(var s$l=new Uint16Array(this._buffer,this._byteLength,s$L),s$Z=0;s$Z<s$L;s$Z++)s$l[s$Z]=s$d[s$Z];this._byteLength+=2*s$L,this._checkArrayUse()},s$l.appendEx=function(s$d,s$L){this._upload=!0;var s$l;s$l=s$d.byteLength,this._resizeBuffer(this._byteLength+s$l,!0),new s$L(this._buffer,this._byteLength).set(s$d,0),this._byteLength+=s$l,this._checkArrayUse()},s$l.appendEx2=function(s$d,s$L,s$l,s$Z){void 0===s$Z&&(s$Z=1),this._upload=!0;var s$h,s$_;s$h=s$l*s$Z,this._resizeBuffer(this._byteLength+s$h,!0),s$_=new s$L(this._buffer,this._byteLength);var s$N=0;for(s$N=0;s$N<s$l;s$N++)s$_[s$N]=s$d[s$N];this._byteLength+=s$h,this._checkArrayUse()},s$l.getBuffer=function(){return this._buffer},s$l.setNeedUpload=function(){this._upload=!0},s$l.getNeedUpload=function(){return this._upload},s$l.upload=function(){var s$d=this._bind_upload();return s$od._gl.bindBuffer(this._bufferType,null),s$od._bindActive[this._bufferType]=null,s$jd.activeShader=null,s$d},s$l.subUpload=function(s$d,s$L,s$l){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0);var s$Z=this._bind_subUpload();return s$od._gl.bindBuffer(this._bufferType,null),s$od._bindActive[this._bufferType]=null,s$jd.activeShader=null,s$Z},s$l.disposeResource=function(){s$d.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},s$l.clear=function(){this._byteLength=0,this._upload=!0},s$Z(0,s$l,"bufferLength",function(){return this._buffer.byteLength}),s$Z(0,s$l,"byteLength",null,function(s$d){this._byteLength!==s$d&&(s$d<=this._buffer.byteLength||this._resizeBuffer(2*s$d+256,!0),this._byteLength=s$d)}),s$L.__int__=function(s$d){s$Wd.QuadrangleIB=s$Wd.create(35044),s$ad.fillIBQuadrangle(s$Wd.QuadrangleIB,16)},s$L.FLOAT32=4,s$L.SHORT=2,s$L}(s$od),s$fd=(function(s$L){function s$l(s$d){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,s$l.__super.call(this,9)}s$q(s$l,"laya.webgl.shader.d2.value.GlowSV",s$L);var s$d=s$l.prototype;s$d.setValue=function(s$d){s$L.prototype.setValue.call(this,s$d)},s$d.clear=function(){s$L.prototype.clear.call(this)}}(s$Cd),function(s$d){function s$L(s$d){s$L.__super.call(this,64),this.defines.add(64)}s$q(s$L,"laya.webgl.shader.d2.value.TextSV",s$d);var s$l=s$L.prototype;return s$l.release=function(){(s$L.pool[s$L._length++]=this).clear()},s$l.clear=function(){s$d.prototype.clear.call(this)},s$L.create=function(){return s$L._length?s$L.pool[--s$L._length]:new s$L(null)},s$L.pool=[],s$L._length=0,s$L}(s$Cd)),s$Ud=function(s$d){function s$h(s$d,s$L,s$l,s$Z){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,s$h.__super.call(this,s$d,s$L,s$l,s$Z)}s$q(s$h,"laya.webgl.shader.d2.Shader2X",s$d);var s$L=s$h.prototype;return s$L.upload2dQuick1=function(s$d){this.upload(s$d,this._params2dQuick1||this._make2dQuick1())},s$L._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var s$d,s$L=this._params,s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)s$d=s$L[s$l],(s$k.isFlash||"size"!==s$d.name&&"position"!==s$d.name&&"texcoord"!==s$d.name)&&this._params2dQuick1.push(s$d)}return this._params2dQuick1},s$L.disposeResource=function(){s$d.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},s$L.upload2dQuick2=function(s$d){this.upload(s$d,this._params2dQuick2||this._make2dQuick2())},s$L._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var s$d,s$L=this._params,s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)s$d=s$L[s$l],(s$k.isFlash||"size"!==s$d.name)&&this._params2dQuick2.push(s$d)}return this._params2dQuick2},s$h.create=function(s$d,s$L,s$l,s$Z){return new s$h(s$d,s$L,s$l,s$Z)},s$h}(s$vd),s$Wd=function(s$d){function s$L(s$d){this._uint8Array=null,this._uint16Array=null,void 0===s$d&&(s$d=35044),s$L.__super.call(this),this._bufferUsage=s$d,this._bufferType=34963,s$k.isFlash||(this._buffer=new ArrayBuffer(8))}s$q(s$L,"laya.webgl.utils.IndexBuffer2D",s$Jd);var s$l=s$L.prototype;return s$l._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},s$l.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},s$l.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},s$l.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},s$L.QuadrangleIB=null,s$L.create=function(s$d){return void 0===s$d&&(s$d=35044),new s$L(s$d)},s$L}(),s$Md=function(s$d){function s$l(s$d,s$L){this._floatArray32=null,this._vertexStride=0,s$l.__super.call(this),this._vertexStride=s$d,this._bufferUsage=s$L,this._bufferType=34962,s$k.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}s$q(s$l,"laya.webgl.utils.VertexBuffer2D",s$d);var s$L=s$l.prototype;return s$L.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},s$L.bind=function(s$d){s$d&&s$d._bind(),this._bind()},s$L.insertData=function(s$d,s$L){this.getFloat32Array().set(s$d,s$L),this._upload=!0},s$L.bind_upload=function(s$d){s$d._bind_upload()||s$d._bind(),this._bind_upload()||this._bind()},s$L._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},s$L.disposeResource=function(){s$d.prototype.disposeResource.call(this)},s$L.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},s$Z(0,s$L,"vertexStride",function(){return this._vertexStride}),s$l.create=function(s$d,s$L){return void 0===s$L&&(s$L=35048),new s$l(s$d,s$L)},s$l}(s$Jd),s$dL=function(s$d){function s$m(s$d,s$L,s$l,s$Z,s$h,s$_){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=!0),s$m.__super.call(this,s$d,s$L),s$d){if(this._format=s$l,this._mipmap=s$Z,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof s$d)this._url=s$d,this._src=s$d,this._image=new s$Y.window.Image,s$L&&(s$L.onload&&(this.onload=s$L.onload),s$L.onerror&&(this.onerror=s$L.onerror),s$L.onCreate&&s$L.onCreate(this)),this._image.crossOrigin=s$d&&0==s$d.indexOf("data:")?null:"",s$d&&(this._image.src=s$d);else if(s$d instanceof ArrayBuffer){this._src=s$L,this._url=this._src;var s$N=new s$u(s$d);s$N.readUTFBytes(4),s$N.readUTFBytes(2),s$N.getInt16();s$N.endian="bigEndian",this._w=s$N.getInt16(),this._h=s$N.getInt16();s$N.getInt16(),s$N.getInt16();this._image=new Uint8Array(s$d,s$N.pos),this._format=s$sd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,s$B.enabled&&this._w<s$B.atlasLimitWidth&&this._h<s$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(s$d instanceof Uint8Array))return this._src=s$L,this._url=this._src,this._image=s$d.source||s$d,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=s$L,this._url=this._src,this._w=s$h,this._h=s$_,this._image=s$d,this._format=0===s$l?s$d.byteLength/(s$h*s$_)==4?6408:6407:s$l}this._$5__enableMerageInAtlas=!0}}s$q(s$m,"laya.webgl.resource.WebGLImage",s$r);var s$L=s$m.prototype;return s$y.imps(s$L,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),s$L._init_=function(s$d,s$L){},s$L._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var s$d=s$sd.mainContext,s$L=this._source=s$d.createTexture(),s$l=s$Ad.curBindTexTarget,s$Z=s$Ad.curBindTexValue;s$Ad.bindTexture(s$d,3553,s$L);var s$h=this.minFifter,s$_=this.magFifter,s$N=this.repeat?10497:33071,s$m=s$t.isPOT(this._w,this._h),s$u=!1;switch(s$m?(this.mipmap?-1!==s$h||(s$h=9987):-1!==s$h||(s$h=9729),-1!==s$_||(s$_=9729),s$d.texParameteri(3553,10241,s$h),s$d.texParameteri(3553,10240,s$_),s$d.texParameteri(3553,10242,s$N),s$d.texParameteri(3553,10243,s$N),this.mipmap&&s$d.generateMipmap(3553)):(-1!==s$h||(s$h=9729),-1!==s$_||(s$_=9729),s$d.texParameteri(3553,10241,s$h),s$d.texParameteri(3553,10240,s$_),s$d.texParameteri(3553,10242,33071),s$d.texParameteri(3553,10243,33071)),s$d.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&s$d.pixelStorei(s$d.UNPACK_ALIGNMENT,1),s$d.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&s$d.pixelStorei(s$d.UNPACK_ALIGNMENT,1),s$d.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:s$u=!0,s$d.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case s$sd.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:s$u=!0,s$d.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}s$d.pixelStorei(37441,!1),s$l&&s$Z&&s$Ad.bindTexture(s$d,s$l,s$Z),this.uri||(this.uri=this._url),s$u?this.memorySize=this._image.length:s$m&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},s$L.recreateResource=function(){var s$d=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var s$L=this;this._image=new s$Y.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(s$L._needReleaseAgain)return s$L._needReleaseAgain=!1,s$L._image.onload=null,void(s$L._image=null);s$L._allowMerageInAtlas&&s$L._enableMerageInAtlas?(s$d.memorySize=0,s$d._recreateLock=!1):s$L._createWebGlTexture(),s$L.completeCreate()},this._image.src=this._src}},s$L.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&s$sd.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},s$L.onresize=function(){this._w=this._image.width,this._h=this._image.height,s$B.enabled&&this._w<s$B.atlasLimitWidth&&this._h<s$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},s$L.clearAtlasSource=function(){this._image=null},s$Z(0,s$L,"format",function(){return this._format}),s$Z(0,s$L,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(s$d){this._$5__enableMerageInAtlas=s$d}),s$Z(0,s$L,"mipmap",function(){return this._mipmap}),s$Z(0,s$L,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),s$Z(0,s$L,"atlasSource",function(){return this._image}),s$Z(0,s$L,"onload",null,function(s$d){var s$L=this;this._onload=s$d,this._image&&(this._image.onload=null!=this._onload?function(){s$L.onresize(),s$L._onload()}:null)}),s$Z(0,s$L,"onerror",null,function(s$d){var s$L=this;this._onerror=s$d,this._image&&(this._image.onerror=null!=this._onerror?function(){s$L._onerror()}:null)}),s$m}();s$y.__init([s$Yd,s$S,s$$d,s$wd])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}}),function(s$_,s$d,s$Z){s$Z.un,s$Z.uns;var s$h=s$Z.static,s$N=s$Z.class,s$m=s$Z.getset,s$u=(s$Z.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),s$c=laya.utils.ClassUtils,s$b=(laya.events.Event,laya.utils.HTMLChar),s$x=laya.net.Loader,s$t=(laya.display.Node,laya.maths.Rectangle),s$q=laya.renders.Render,s$Y=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),s$r=laya.utils.Stat,s$j=laya.display.Text,s$a=laya.resource.Texture,s$k=laya.net.URL,s$e=laya.utils.Utils,s$w=function(){function s$Y(){}return s$N(s$Y,"laya.html.utils.HTMLParse"),s$Y.parse=function(s$d,s$L,s$l){s$L=(s$L="<root>"+(s$L=s$L.replace(/<br>/g,"<br/>"))+"</root>").replace(s$Y.spacePattern,s$Y.char255);var s$Z=s$e.parseXMLFromString(s$L);s$Y._parseXML(s$d,s$Z.childNodes[0].childNodes,s$l)},s$Y._parseXML=function(s$d,s$L,s$l,s$Z){var s$h=0,s$_=0;if(s$L.join||s$L.item)for(s$h=0,s$_=s$L.length;s$h<s$_;++s$h)s$Y._parseXML(s$d,s$L[s$h],s$l,s$Z);else{var s$N,s$m,s$u;if(3==s$L.nodeType)return void(s$d instanceof laya.html.dom.HTMLDivElement?(null==s$L.nodeName&&(s$L.nodeName="#text"),s$m=s$L.nodeName.toLowerCase(),0<(s$u=s$L.textContent.replace(/^\s+|\s+$/g,"")).length&&(s$N=s$c.getInstance(s$m))&&(s$d.addChild(s$N),s$N.innerTEXT=s$u.replace(s$Y.char255AndOneSpacePattern," "))):0<(s$u=s$L.textContent.replace(/^\s+|\s+$/g,"")).length&&(s$d.innerTEXT=s$u.replace(s$Y.char255AndOneSpacePattern," ")));if("#comment"==(s$m=s$L.nodeName.toLowerCase()))return;if(s$N=s$c.getInstance(s$m)){(s$N=s$d.addChild(s$N)).URI=s$l,s$N.href=s$Z;var s$x=s$L.attributes;if(s$x&&0<s$x.length)for(s$h=0,s$_=s$x.length;s$h<s$_;++s$h){var s$t=s$x[s$h],s$b=s$t.nodeName,s$q=s$t.value;s$N._setAttributes(s$b,s$q)}s$Y._parseXML(s$N,s$L.childNodes,s$l,s$N.href)}else s$Y._parseXML(s$d,s$L.childNodes,s$l,s$Z)}},s$Y.char255=String.fromCharCode(255),s$Y.spacePattern=/&nbsp;|&#160;/g,s$Y.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),s$Y}(),s$s=function(){function s$X(){}return s$N(s$X,"laya.html.utils.Layout"),s$X.later=function(s$d){null==s$X._will&&(s$X._will=[],s$Z.stage.frameLoop(1,null,function(){if(!(s$X._will.length<1)){for(var s$d=0;s$d<s$X._will.length;s$d++)laya.html.utils.Layout.layout(s$X._will[s$d]);s$X._will.length=0}})),s$X._will.push(s$d)},s$X.layout=function(s$d){if(!s$d||!s$d._style)return null;if(0==(512&s$d._style._type))return null;s$d.getStyle()._type&=-513;var s$L=s$X._multiLineLayout(s$d);return s$q.isConchApp&&s$d.layaoutCallNative&&s$d.layaoutCallNative(),s$L},s$X._multiLineLayout=function(s$d){if(s$j.RightToLeft)return s$X._multiLineLayout2(s$d);var s$L=new Array;s$d._addChildsToLayout(s$L);var s$l,s$Z,s$h,s$_,s$N,s$m=0,s$u=s$L.length,s$x=s$d._getCSSStyle(),s$t=s$x.letterSpacing,s$b=s$x.leading,s$q=s$x.lineHeight,s$Y=s$x._widthAuto()||!s$x.wordWrap,s$c=s$Y?999999:s$d.width,s$r=(s$d.height,0),s$a=s$x.italic?s$x.fontSize/3:0,s$k=s$x._getAlign(),s$e=s$x._getValign(),s$w=0!==s$e||0!==s$k||0!=s$q,s$s=0,s$A=0,s$y=0,s$$=0,s$O=new Array,s$n=s$O[0]=new s$R,s$V=!1,s$Q=!1;s$n.h=0,s$x.italic&&(s$c-=s$x.fontSize/3);var s$g=0,s$F=!0;function s$E(){s$n.y=s$A,s$A+=s$n.h+s$b,0==s$n.h&&(s$A+=s$q),s$n.mWidth=s$g,s$g=0,s$n=new s$R,s$O.push(s$n),s$n.h=0,s$V=!(s$F=!(s$s=0))}for(s$m=0;s$m<s$u;s$m++)if(null!=(s$l=s$L[s$m]))if(s$F=!1,s$l instanceof laya.html.dom.HTMLBrElement)s$E(),s$n.y=s$A;else{if(s$l._isChar()){if((s$_=s$l).isWord)s$V=s$Q||"\n"===s$_.char,s$n.wordStartIndex=s$n.elements.length;else{if(s$y=s$_.width+s$_.style.letterSpacin,0<s$O.length&&s$c<s$s+s$y&&0<s$n.wordStartIndex){var s$I;s$I=s$n.elements.length-s$n.wordStartIndex+1,s$n.elements.length=s$n.wordStartIndex,s$m-=s$I,s$E();continue}s$V=!1,s$g+=s$_.width}s$y=s$_.width+s$t,s$$=s$_.height,s$Q=!1,(s$V=s$V||s$c<s$s+s$y)&&s$E(),s$n.minTextHeight=Math.min(s$n.minTextHeight,s$l.height)}else s$Z=s$l._getCSSStyle(),s$N=s$l,s$h=s$Z.padding,0===s$Z._getCssFloat()||(s$w=!0),s$V=s$Q||s$Z.lineElement,s$y=s$N.width*s$N._style._tf.scaleX+s$h[1]+s$h[3]+s$t,s$$=s$N.height*s$N._style._tf.scaleY+s$h[0]+s$h[2],s$Q=s$Z.lineElement,(s$V=s$V||s$c<s$s+s$y&&s$Z.wordWrap)&&s$E();s$n.elements.push(s$l),s$n.h=Math.max(s$n.h,s$$),s$l.x=s$s,s$l.y=s$A,s$s+=s$y,s$n.w=s$s-s$t,s$n.y=s$A,s$r=Math.max(s$s+s$a,s$r)}else s$F||(s$s+=s$X.DIV_ELEMENT_PADDING),s$n.wordStartIndex=s$n.elements.length;if(s$A=s$n.y+s$n.h,s$w){var s$p=0,s$H=s$c;for(s$Y&&0<s$d.width&&(s$H=s$d.width),s$m=0,s$u=s$O.length;s$m<s$u;s$m++)s$O[s$m].updatePos(0,s$H,s$m,s$p,s$k,s$e,s$q),s$p+=Math.max(s$q,s$O[s$m].h+s$b);s$A=s$p}return s$Y&&(s$d.width=s$r),s$A>s$d.height&&(s$d.height=s$A),[s$r,s$A]},s$X._multiLineLayout2=function(s$d){var s$L=new Array;s$d._addChildsToLayout(s$L);var s$l,s$Z,s$h,s$_,s$N,s$m=0,s$u=s$L.length,s$x=s$d._getCSSStyle(),s$t=s$x.letterSpacing,s$b=s$x.leading,s$q=s$x.lineHeight,s$Y=s$x._widthAuto()||!s$x.wordWrap,s$c=s$Y?999999:s$d.width,s$r=(s$d.height,0),s$a=s$x.italic?s$x.fontSize/3:0,s$k=2-s$x._getAlign(),s$e=s$x._getValign(),s$w=0!==s$e||0!=s$k||0!=s$q,s$s=0,s$A=0,s$y=0,s$$=0,s$O=new Array,s$n=s$O[0]=new s$R,s$V=!1,s$Q=!1;s$n.h=0,s$x.italic&&(s$c-=s$x.fontSize/3);var s$g=0,s$F=!0;function s$E(){s$n.y=s$A,s$A+=s$n.h+s$b,0==s$n.h&&(s$A+=s$q),s$n.mWidth=s$g,s$g=0,s$n=new s$R,s$O.push(s$n),s$n.h=0,s$V=!(s$F=!(s$s=0))}for(s$m=0;s$m<s$u;s$m++)if(null!=(s$l=s$L[s$m]))if(s$F=!1,s$l instanceof laya.html.dom.HTMLBrElement)s$E(),s$n.y=s$A;else{if(s$l._isChar()){if((s$_=s$l).isWord)s$V=s$Q||"\n"===s$_.char,s$n.wordStartIndex=s$n.elements.length;else{if(0<s$O.length&&s$c<s$s+s$y&&0<s$n.wordStartIndex){var s$I;s$I=s$n.elements.length-s$n.wordStartIndex+1,s$n.elements.length=s$n.wordStartIndex,s$m-=s$I,s$E();continue}s$V=!1,s$g+=s$_.width}s$y=s$_.width+s$t,s$$=s$_.height,s$Q=!1,(s$V=s$V||s$c<s$s+s$y)&&s$E(),s$n.minTextHeight=Math.min(s$n.minTextHeight,s$l.height)}else s$Z=s$l._getCSSStyle(),s$N=s$l,s$h=s$Z.padding,0===s$Z._getCssFloat()||(s$w=!0),s$V=s$Q||s$Z.lineElement,s$y=s$N.width*s$N._style._tf.scaleX+s$h[1]+s$h[3]+s$t,s$$=s$N.height*s$N._style._tf.scaleY+s$h[0]+s$h[2],s$Q=s$Z.lineElement,(s$V=s$V||s$c<s$s+s$y&&s$Z.wordWrap)&&s$E();s$n.elements.push(s$l),s$n.h=Math.max(s$n.h,s$$),s$l.x=s$s,s$l.y=s$A,s$s+=s$y,s$n.w=s$s-s$t,s$n.y=s$A,s$r=Math.max(s$s+s$a,s$r)}else s$F||(s$s+=s$X.DIV_ELEMENT_PADDING),s$n.wordStartIndex=s$n.elements.length;if(s$A=s$n.y+s$n.h,s$w){var s$p=0,s$H=s$c;for(s$m=0,s$u=s$O.length;s$m<s$u;s$m++)s$O[s$m].updatePos(0,s$H,s$m,s$p,s$k,s$e,s$q),s$p+=Math.max(s$q,s$O[s$m].h+s$b);s$A=s$p}for(s$Y&&(s$d.width=s$r),s$A>s$d.height&&(s$d.height=s$A),s$m=0,s$u=s$O.length;s$m<s$u;s$m++)s$O[s$m].revertOrder(s$c);return[s$r,s$A]},s$X._will=null,s$X.DIV_ELEMENT_PADDING=0,s$X}(),s$R=function(){function s$d(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}s$N(s$d,"laya.html.utils.LayoutLine");var s$L=s$d.prototype;return s$L.updatePos=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m,s$u=0;0<this.elements.length&&(s$u=(s$m=this.elements[this.elements.length-1]).x+s$m.width-this.elements[0].x);var s$x=0,s$t=NaN;1===s$h&&(s$x=(s$L-s$u)/2),2===s$h&&(s$x=s$L-s$u),0===s$N||0!=s$_||(s$_=1);for(var s$b=0,s$q=this.elements.length;s$b<s$q;s$b++){var s$Y=(s$m=this.elements[s$b])._getCSSStyle();switch(0!==s$x&&(s$m.x+=s$x),s$Y._getValign()){case 0:s$m.y=s$Z;break;case 1:var s$c=0;99999!=this.minTextHeight&&(s$c=this.minTextHeight);var s$r=(s$c+s$N)/2;s$r=Math.max(s$r,this.h),s$t=(laya.html.dom.HTMLImageElement,s$Z+s$r-s$m.height),s$m.y=s$t;break;case 2:s$m.y=s$Z+(s$N-s$m.height)}}},s$L.revertOrder=function(s$d){var s$L;if(0<this.elements.length){var s$l,s$Z=0;for(s$l=this.elements.length,s$Z=0;s$Z<s$l;s$Z++)(s$L=this.elements[s$Z]).x=s$d-s$L.x-s$L.width}},s$d}(),s$A=function(s$l){function s$L(){this.URI=null,this._href=null,s$L.__super.call(this),this._text=s$L._EMPTYTEXT,this.setStyle(new s$u(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}s$N(s$L,"laya.html.dom.HTMLElement",s$l);var s$d=s$L.prototype;return s$d.layaoutCallNative=function(){var s$d=0;if(this._childs&&0<(s$d=this._childs.length))for(var s$L=0;s$L<s$d;s$L++)this._childs[s$L].layaoutCallNative&&this._childs[s$L].layaoutCallNative();var s$l=this._getWords();s$l?laya.html.dom.HTMLElement.fillWords(this,s$l,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},s$d.appendChild=function(s$d){return this.addChild(s$d)},s$d._getWords2=function(){var s$d=this._text.text;if(!s$d||0===s$d.length)return null;var s$L,s$l,s$Z=0,s$h=0;if(this._text.drawWords)s$l=this._text.drawWords;else{for(s$h=(s$L=s$d.split(" ")).length-1,s$l=[],s$Z=0;s$Z<s$h;s$Z++)s$l.push(s$L[s$Z]," ");0<=s$h&&s$l.push(s$L[s$h]),this._text.drawWords=s$l}var s$_,s$N=this._text.words;if(s$N&&s$N.length===s$l.length)return s$N;null===s$N&&(this._text.words=s$N=[]),s$N.length=s$l.length;var s$m=this.style,s$u=s$m.font;for(s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++){s$_=s$e.measureText(s$l[s$Z],s$u);var s$x=s$N[s$Z]=new s$b(s$l[s$Z],s$_.width,s$_.height||s$m.fontSize,s$m);if(1<s$x.char.length&&(s$x.charNum=s$x.char),this.href){var s$t=new s$Y;this.addChild(s$t),s$x.setSprite(s$t)}}return s$N},s$d._getWords=function(){if(!s$j.CharacterCache)return this._getWords2();var s$d=this._text.text;if(!s$d||0===s$d.length)return null;var s$L,s$l=this._text.words;if(s$l&&s$l.length===s$d.length)return s$l;null===s$l&&(this._text.words=s$l=[]),s$l.length=s$d.length;for(var s$Z=this.style,s$h=s$Z.font,s$_=0,s$N=s$d.length;s$_<s$N;s$_++)if(s$L=s$e.measureText(s$d.charAt(s$_),s$h)){var s$m=s$l[s$_]=new s$b(s$d.charAt(s$_),s$L.width,s$L.height||s$Z.fontSize,s$Z);if(this.href){var s$u=new s$Y;this.addChild(s$u),s$m.setSprite(s$u)}}else console.warn("_getWords size is null"+s$d.charAt(s$_),s$h);return s$l},s$d.showLinkSprite=function(){var s$d=this._text.words;if(s$d)for(var s$L,s$l,s$Z=[],s$h=0;s$h<s$d.length;s$h++)s$l=s$d[s$h],(s$L=new s$Y).graphics.drawRect(0,0,s$l.width,s$l.height,"#ff0000"),s$L.width=s$l.width,s$L.height=s$l.height,this.addChild(s$L),s$Z.push(s$L)},s$d._layoutLater=function(){var s$d=this.style;512&s$d._type||(s$d.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&s$d.block?(s$s.later(this),s$d._type|=512):this.parent&&this.parent._layoutLater())},s$d._setAttributes=function(s$d,s$L){switch(s$d){case"style":return void this.style.cssText(s$L);case"class":return void(this.className=s$L)}s$l.prototype._setAttributes.call(this,s$d,s$L)},s$d.updateHref=function(){if(null!=this._href){var s$d=this._getWords();if(s$d)for(var s$L,s$l,s$Z=0;s$Z<s$d.length;s$Z++)(s$l=(s$L=s$d[s$Z]).getSprite())&&(s$l.size(s$L.width,s$L.height),s$l.on("click",this,this.onLinkHandler))}},s$d.onLinkHandler=function(s$d){switch(s$d.type){case"click":for(var s$L=this;s$L;)s$L.event("link",[this.href]),s$L=s$L.parent}},s$d.formatURL=function(s$d){return this.URI?s$k.formatURL(s$d,this.URI?this.URI.path:null):s$d},s$m(0,s$d,"href",function(){return this._href},function(s$d){null!=(this._href=s$d)&&(this._getCSSStyle().underLine=1,this.updateHref())}),s$m(0,s$d,"color",null,function(s$d){this.style.color=s$d}),s$m(0,s$d,"onClick",null,function(s$d){s$Z._runScript("fn=function(event){"+s$d+";}"),this.on("click",this,void 0)}),s$m(0,s$d,"id",null,function(s$d){s$y.document.setElementById(s$d,this)}),s$m(0,s$d,"innerTEXT",function(){return this._text.text},function(s$d){this.text=s$d}),s$m(0,s$d,"style",function(){return this._style}),s$m(0,s$d,"text",function(){return this._text.text},function(s$d){this._text==s$L._EMPTYTEXT?this._text={text:s$d,words:null}:(this._text.text=s$d,this._text.words&&(this._text.words.length=0)),s$q.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),s$m(0,s$d,"parent",s$l.prototype._$get_parent,function(s$d){if(s$d instanceof laya.html.dom.HTMLElement){var s$L=s$d;this.URI||(this.URI=s$L.URI),this.style.inherit(s$L.style)}s$Z.superSet(s$Y,this,"parent",s$d)}),s$m(0,s$d,"className",null,function(s$d){this.style.attrs(s$y.document.styleSheets["."+s$d])}),s$L.fillWords=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$d.graphics.clear();for(var s$m=0,s$u=s$L.length;s$m<s$u;s$m++){var s$x=s$L[s$m];s$d.graphics.fillText(s$x.char,s$x.x+s$l,s$x.y+s$Z,s$h,s$_,"left",s$N)}},s$L._EMPTYTEXT={text:null,words:null},s$L}(s$Y),s$L=(function(s$d){function s$L(){s$L.__super.call(this),this.style.lineElement=!0,this.style.block=!0}s$N(s$L,"laya.html.dom.HTMLBrElement",s$A)}(),function(s$d){function s$L(){this.contextHeight=NaN,this.contextWidth=NaN,s$L.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}s$N(s$L,"laya.html.dom.HTMLDivElement",s$d);var s$l=s$L.prototype;return s$l.appendHTML=function(s$d){s$w.parse(this,s$d,this.URI),this.layout()},s$l._addChildsToLayout=function(s$L){var s$d=this._getWords();if(null==s$d&&0==this._childs.length)return!1;s$d&&s$d.forEach(function(s$d){s$L.push(s$d)});for(var s$l=!0,s$Z=0,s$h=this._childs.length;s$Z<s$h;s$Z++){var s$_=this._childs[s$Z];s$l?s$l=!1:s$L.push(null),s$_._addToLayout(s$L)}return!0},s$l._addToLayout=function(s$d){this.layout()},s$l.layout=function(){if(this.style){this.style._type|=512;var s$d=s$s.layout(this);if(s$d){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new s$t);var s$L=this._$P.mHtmlBounds;s$L.x=s$L.y=0,s$L.width=this.contextWidth=s$d[0],s$L.height=this.contextHeight=s$d[1],this.setBounds(s$L)}}},s$m(0,s$l,"height",function(){return this._height?this._height:this.contextHeight},s$d.prototype._$set_height),s$m(0,s$l,"innerHTML",null,function(s$d){this.destroyChildren(),this.appendHTML(s$d)}),s$m(0,s$l,"width",function(){return this._width?this._width:this.contextWidth},function(s$d){var s$L=!1;s$L=0===s$d?s$d!=this._width:s$d!=this.width,s$Z.superSet(s$A,this,"width",s$d),s$L&&this.layout()}),s$L}(s$A)),s$y=function(s$d){function s$L(){this.all=new Array,this.styleSheets=s$u.styleSheets,s$L.__super.call(this)}s$N(s$L,"laya.html.dom.HTMLDocument",s$A);var s$l=s$L.prototype;return s$l.getElementById=function(s$d){return this.all[s$d]},s$l.setElementById=function(s$d,s$L){this.all[s$d]=s$L},s$h(s$L,["document",function(){return this.document=new s$L}]),s$L}();(function(s$d){function s$L(){this._tex=null,this._url=null,this._renderArgs=[],s$L.__super.call(this),this.style.block=!0}s$N(s$L,"laya.html.dom.HTMLImageElement",s$A);var s$l=s$L.prototype;s$l._addToLayout=function(s$d){!this._style.absolute&&s$d.push(this)},s$l.render=function(s$d,s$L,s$l){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(s$r.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,s$d.ctx.drawTexture2(s$L,s$l,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},s$l.layaoutCallNative=function(){var s$d=0;if(this._childs&&0<(s$d=this._childs.length))for(var s$L=0;s$L<s$d;s$L++)this._childs[s$L].layaoutCallNative&&this._childs[s$L].layaoutCallNative()},s$m(0,s$l,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(s$d){this._width!==s$d&&(this._width=s$d,this._style.width=s$d,this.repaint())}),s$m(0,s$l,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(s$d){this._height!==s$d&&(this._height=s$d,this._style.height=s$d,this.repaint())}),s$l.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),s$x.clearCache(this,this._url),this._tex=null),s$A.prototype.destroy.call(this)},s$l.onloaded=function(){var s$d=this._style;s$d&&!s$d.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),s$d&&!s$d.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),s$q.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},s$l._loadImageComplete=function(s$d,s$L,s$l){if(!this._destroyed)if(null!=s$l)if(s$l instanceof ArrayBuffer){var s$Z=new DataView(s$l);new laya.webgl.resource.WebGLImage(new Uint8Array(s$l,8),s$d,0,!1,s$Z.getUint32(0),s$Z.getUint32(4));this.onloaded()}else if(s$l instanceof s$a)s$x.imgMgrSet[s$d]=s$L,s$_.imgMgrLock(s$d,s$x.imgMgrSet[s$d]),this._url=s$d,this._tex=s$l,s$x.keepCache(this,s$d),s$x.cacheRes(s$d,this._tex),this.onloaded();else{var s$h=-1!=s$d.indexOf(".png",s$d.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(s$l,s$d,s$h,!1,s$l.width,s$l.height);this.onloaded()}else this.event("error","Load image failed")},s$m(0,s$l,"src",null,function(s$d){(s$d=this.formatURL(s$d),this._url!=s$d)&&(null!=this._tex&&(s$x.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=s$d,(this._tex=s$x.getRes(s$d))?(s$x.keepCache(this,s$d),this.onloaded()):s$_.imgMgrLoad(s$d,this._loadImageComplete.bind(this),2,!1))})})(),function(s$d){function s$L(){this.type=null,s$L.__super.call(this),this.visible=!1}s$N(s$L,"laya.html.dom.HTMLLinkElement",s$d);var s$l=s$L.prototype;s$l._onload=function(s$d){switch(this.type){case"text/css":s$u.parseCSS(s$d,this.URI)}},s$m(0,s$l,"href",s$d.prototype._$get_href,function(s$d){var s$L=this;s$d=this.formatURL(s$d),this.URI=new s$k(s$d);var s$l=new s$x;s$l.once("complete",null,function(s$d){s$L._onload(s$d)}),s$l.load(s$d,"text")}),s$L._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(s$A),function(s$d){function s$L(){s$L.__super.call(this),this.visible=!1}s$N(s$L,"laya.html.dom.HTMLStyleElement",s$d),s$m(0,s$L.prototype,"text",s$d.prototype._$get_text,function(s$d){s$u.parseCSS(s$d,null)})}(s$A),function(s$d){function s$L(){s$L.__super.call(this),this._getCSSStyle().valign="middle"}s$N(s$L,"laya.html.dom.HTMLIframeElement",s$d),s$m(0,s$L.prototype,"href",s$d.prototype._$get_href,function(s$l){var s$Z=this;s$l=this.formatURL(s$l);var s$d=new s$x;s$d.once("complete",null,function(s$d){var s$L=s$Z.URI;s$Z.URI=new s$k(s$l),s$Z.innerHTML=s$d,!s$L||(s$Z.URI=s$L)}),s$d.load(s$l,"text")})}(s$L)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}}),function(s$d,s$L,s$r){s$r.un,s$r.uns;var s$Z=s$r.static,s$_=s$r.class,s$h=s$r.getset,s$l=(s$r.__newvec,laya.display.Animation),s$a=(laya.utils.Browser,laya.utils.ClassUtils),s$N=laya.filters.ColorFilter,s$m=laya.utils.Ease,s$u=laya.events.Event,s$x=(laya.events.EventDispatcher,laya.display.css.Font),s$t=laya.display.FrameAnimation,s$b=laya.display.Graphics,s$q=laya.utils.Handler,s$Y=laya.display.Input,s$e=laya.net.Loader,s$c=(laya.display.Node,laya.maths.Point),s$k=laya.maths.Rectangle,s$w=laya.renders.Render,s$s=laya.display.Sprite,s$A=laya.display.Text,s$y=laya.resource.Texture,s$$=laya.utils.Tween,s$O=laya.utils.Utils,s$n=laya.utils.WeakObject;s$r.interface("laya.ui.IItem"),s$r.interface("laya.ui.ISelect"),s$r.interface("laya.ui.IRender"),s$r.interface("laya.ui.IComponent"),s$r.interface("laya.ui.IBox","IComponent");var s$V=function(){function s$d(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return s$_(s$d,"laya.ui.LayoutStyle"),s$Z(s$d,["EMPTY",function(){return this.EMPTY=new s$d}]),s$d}(),s$Q=function(){function s$d(){}return s$_(s$d,"laya.ui.Styles"),s$d.labelColor="#000000",s$d.buttonStateNum=3,s$d.scrollBarMinNum=15,s$d.scrollBarDelayTime=500,s$Z(s$d,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),s$d}(),s$g=function(){function s$h(){}return s$_(s$h,"laya.ui.UIUtils"),s$h.fillArray=function(s$d,s$L,s$l){var s$Z=s$d.concat();if(s$L)for(var s$h=s$L.split(","),s$_=0,s$N=Math.min(s$Z.length,s$h.length);s$_<s$N;s$_++){var s$m=s$h[s$_];s$Z[s$_]="true"==s$m||"false"!=s$m&&s$m,null!=s$l&&(s$Z[s$_]=s$l(s$m))}return s$Z},s$h.toColor=function(s$d){return s$O.toHexColor(s$d)},s$h.gray=function(s$d,s$L){void 0===s$L&&(s$L=!0),s$L?s$h.addFilter(s$d,s$h.grayFilter):s$h.clearFilter(s$d,s$N)},s$h.addFilter=function(s$d,s$L){var s$l=s$d.filters||[];s$l.push(s$L),s$d.filters=s$l},s$h.clearFilter=function(s$d,s$L){var s$l=s$d.filters;if(null!=s$l&&0<s$l.length){for(var s$Z=s$l.length-1;-1<s$Z;s$Z--){var s$h=s$l[s$Z];s$r.__typeof(s$h,s$L)&&s$l.splice(s$Z,1)}s$d.filters=s$l}},s$h._getReplaceStr=function(s$d){return s$h.escapeSequence[s$d]},s$h.adptString=function(s$d){return s$d.replace(/\\(\w)/g,s$h._getReplaceStr)},s$h.getBindFun=function(s$d){var s$L=s$h._funMap.get(s$d);if(null==s$L){var s$l='"'+s$d+'"',s$Z="(function(data){if(data==null)return;with(data){try{\nreturn "+(s$l=s$l.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";s$L=s$r._runScript(s$Z),s$h._funMap.set(s$d,s$L)}return s$L},s$Z(s$h,["grayFilter",function(){return this.grayFilter=new s$N([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new s$n}]),s$h}(),s$F=function(){function s$d(){}return s$_(s$d,"UIConfig"),s$d.touchScrollEnable=!0,s$d.mouseWheelEnable=!0,s$d.showButtons=!0,s$d.popupBgColor="#000000",s$d.popupBgAlpha=.5,s$d.closeDialogOnSide=!0,s$d}(),s$E=function(s$l){function s$k(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,s$k.__super.call(this),this._weakKeys=[]}s$_(s$k,"laya.ui.AutoBitmap",s$l);var s$d=s$k.prototype;return s$d.destroy=function(){if(s$e.clearObject(this,this._weakKey),this._weakKeys){for(var s$d=0,s$L=this._weakKeys.length;s$d<s$L;++s$d)s$e.clearObject(this,this._weakKeys[s$d]);this._weakKeys=null}s$l.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},s$d._setChanged=function(){this._isChanged||(this._isChanged=!0,s$r.timer.callLater(this,this.changeSource))},s$d.changeSource=function(){this._isChanged=!1;var s$d=this._source;if(s$d&&s$d.bitmap){var s$L=this.width,s$l=this.height,s$Z=this._sizeGrid,s$h=s$d.sourceWidth,s$_=s$d.sourceHeight;if(!s$Z||s$h===s$L&&s$_===s$l)this.cleanByTexture(s$d,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,s$L,s$l);else{s$e.clearObject(this,this._weakKey),s$d.$_GID||(s$d.$_GID=s$O.getGID());var s$N=s$d.$_GID+"."+s$L+"."+s$l+"."+s$Z.join("."),s$m=s$e.findObject(s$N);if(s$O.isOKCmdList(s$m))return this._weakKey=s$N,s$e.keepObject(this,this._weakKey),void(this.cmds=s$m);this.clear();var s$u,s$x,s$t=s$Z[0],s$b=s$Z[1],s$q=s$Z[2],s$Y=s$Z[3],s$c=s$Z[4],s$r=!1;if(s$L==s$h&&(s$Y=s$b=0),s$l==s$_&&(s$t=s$q=0),s$L<s$Y+s$b){var s$a=s$L;s$r=!0,s$L=s$Y+s$b,this.save(),this.clipRect(0,0,s$a,s$l)}s$Y&&s$t&&(s$u=s$k.getTexture(s$d,0,0,s$Y,s$t),s$x=this._weakKeys[0],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[0]=s$u.weakKey),this.drawTexture(s$u,0,0,s$Y,s$t)):(s$e.clearObject(this,s$x),this._weakKeys[0]="")),s$b&&s$t&&(s$u=s$k.getTexture(s$d,s$h-s$b,0,s$b,s$t),s$x=this._weakKeys[1],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[1]=s$u.weakKey),this.drawTexture(s$u,s$L-s$b,0,s$b,s$t)):(s$e.clearObject(this,s$x),this._weakKeys[1]="")),s$Y&&s$q&&(s$u=s$k.getTexture(s$d,0,s$_-s$q,s$Y,s$q),s$x=this._weakKeys[2],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[2]=s$u.weakKey),this.drawTexture(s$u,0,s$l-s$q,s$Y,s$q)):(s$e.clearObject(this,s$x),this._weakKeys[2]="")),s$b&&s$q&&(s$u=s$k.getTexture(s$d,s$h-s$b,s$_-s$q,s$b,s$q),s$x=this._weakKeys[3],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[3]=s$u.weakKey),this.drawTexture(s$u,s$L-s$b,s$l-s$q,s$b,s$q)):(s$e.clearObject(this,s$x),this._weakKeys[3]="")),s$t&&(s$u=s$k.getTexture(s$d,s$Y,0,s$h-s$Y-s$b,s$t),s$x=this._weakKeys[4],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[4]=s$u.weakKey),this.drawBitmap(s$c,s$u,s$Y,0,s$L-s$Y-s$b,s$t)):(s$e.clearObject(this,s$x),this._weakKeys[4]="")),s$q&&(s$u=s$k.getTexture(s$d,s$Y,s$_-s$q,s$h-s$Y-s$b,s$q),s$x=this._weakKeys[5],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[5]=s$u.weakKey),this.drawBitmap(s$c,s$u,s$Y,s$l-s$q,s$L-s$Y-s$b,s$q)):(s$e.clearObject(this,s$x),this._weakKeys[5]="")),s$Y&&(s$u=s$k.getTexture(s$d,0,s$t,s$Y,s$_-s$t-s$q),s$x=this._weakKeys[6],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[6]=s$u.weakKey),this.drawBitmap(s$c,s$u,0,s$t,s$Y,s$l-s$t-s$q)):(s$e.clearObject(this,s$x),this._weakKeys[6]="")),s$b&&(s$u=s$k.getTexture(s$d,s$h-s$b,s$t,s$b,s$_-s$t-s$q),s$x=this._weakKeys[7],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[7]=s$u.weakKey),this.drawBitmap(s$c,s$u,s$L-s$b,s$t,s$b,s$l-s$t-s$q)):(s$e.clearObject(this,s$x),this._weakKeys[7]="")),s$u=s$k.getTexture(s$d,s$Y,s$t,s$h-s$Y-s$b,s$_-s$t-s$q),s$x=this._weakKeys[8],s$u?(s$x!=s$u.weakKey&&(s$e.clearObject(this,s$x),s$e.keepObject(this,s$u.weakKey),this._weakKeys[8]=s$u.weakKey),this.drawBitmap(s$c,s$u,s$Y,s$t,s$L-s$Y-s$b,s$l-s$t-s$q)):(s$e.clearObject(this,s$x),this._weakKeys[8]=""),s$r&&this.restore(),this.autoCacheCmd&&!s$w.isConchApp&&(s$e.saveObject(s$N,this.cmds,null),this._weakKey=s$N,s$e.keepObject(this,this._weakKey))}this._repaint()}},s$d.drawBitmap=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=0),s$h<.1||s$_<.1||(!s$d||s$L.width==s$h&&s$L.height==s$_?this.drawTexture(s$L,s$l,s$Z,s$h,s$_):this.fillTexture(s$L,s$l,s$Z,s$h,s$_))},s$d.clear=function(s$d){void 0===s$d&&(s$d=!0),s$l.prototype.clear.call(this,!1)},s$h(0,s$d,"sizeGrid",function(){return this._sizeGrid},function(s$d){this._sizeGrid=s$d,this._setChanged()}),s$h(0,s$d,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(s$d){this._width!=s$d&&(this._width=s$d,this._setChanged())}),s$h(0,s$d,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(s$d){this._height!=s$d&&(this._height=s$d,this._setChanged())}),s$h(0,s$d,"source",function(){return this._source},function(s$d){s$d?(this._source=s$d,this._setChanged()):(this._source=null,this.clear())}),s$k.getTexture=function(s$d,s$L,s$l,s$Z,s$h){s$Z<=0&&(s$Z=1),s$h<=0&&(s$h=1),s$d.$_GID||(s$d.$_GID=s$O.getGID());var s$_=s$d.$_GID+"."+s$L+"."+s$l+"."+s$Z+"."+s$h,s$N=s$e.findObject(s$_);if((!s$N||!s$N.source)&&(s$N=s$y.createFromTexture(s$d,s$L,s$l,s$Z,s$h))){if(s$d.alphaTexture){var s$m=s$d.width/s$d.alphaTexture.width;s$N.alphaTexture=s$y.createFromTexture(s$d.alphaTexture,s$L/s$m,s$l/s$m,s$Z/s$m,s$h/s$m)}s$e.saveObject(s$_,s$N),s$N.weakKey=s$_}return s$N},s$k}(s$b),s$I=(function(s$d){function s$L(){s$L.__super.call(this)}s$_(s$L,"laya.ui.UIEvent",s$u),s$L.SHOW_TIP="showtip",s$L.HIDE_TIP="hidetip"}(),function(s$L){function s$d(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,s$d.__super.call(this),this._layout=s$V.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}s$_(s$d,"laya.ui.Component",s$L);var s$l=s$d.prototype;return s$r.imps(s$l,{"laya.ui.IComponent":!0}),s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},s$l.preinitialize=function(){},s$l.createChildren=function(){},s$l.initialize=function(){},s$l.callLater=function(s$d,s$L){s$r.timer.callLater(this,s$d,s$L)},s$l.runCallLater=function(s$d){s$r.timer.runCallLater(this,s$d)},s$l.commitMeasure=function(){},s$l.changeSize=function(){this.event("resize")},s$l.getLayout=function(){return this._layout===s$V.EMPTY&&(this._layout=new s$V),this._layout},s$l._setLayoutEnabled=function(s$d){this._layout&&this._layout.enable!=s$d&&(this._layout.enable=s$d,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},s$l.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},s$l.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},s$l.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},s$l.resetLayoutX=function(){var s$d=this._layout;if(isNaN(s$d.anchorX)||(this.pivotX=s$d.anchorX*this.width),this.layoutEnabled){var s$L=this.parent;s$L&&(isNaN(s$d.centerX)?isNaN(s$d.left)?isNaN(s$d.right)||(this.x=Math.round(s$L.width-this.displayWidth-s$d.right+this.pivotX*this.scaleX)):(this.x=Math.round(s$d.left+this.pivotX*this.scaleX),isNaN(s$d.right)||(this.width=(s$L._width-s$d.left-s$d.right)/(this.scaleX||.01))):this.x=Math.round(.5*(s$L.width-this.displayWidth)+s$d.centerX+this.pivotX*this.scaleX))}},s$l.resetLayoutY=function(){var s$d=this._layout;if(isNaN(s$d.anchorY)||(this.pivotY=s$d.anchorY*this.height),this.layoutEnabled){var s$L=this.parent;s$L&&(isNaN(s$d.centerY)?isNaN(s$d.top)?isNaN(s$d.bottom)||(this.y=Math.round(s$L.height-this.displayHeight-s$d.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(s$d.top+this.pivotY*this.scaleY),isNaN(s$d.bottom)||(this.height=(s$L._height-s$d.top-s$d.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(s$L.height-this.displayHeight)+s$d.centerY+this.pivotY*this.scaleY))}},s$l.onMouseOver=function(s$d){s$r.stage.event("showtip",this._toolTip)},s$l.onMouseOut=function(s$d){s$r.stage.event("hidetip",this._toolTip)},s$h(0,s$l,"displayWidth",function(){return this.width*this.scaleX}),s$h(0,s$l,"width",function(){return this._width?this._width:this.measureWidth},function(s$d){this._width!=s$d&&(this._width=s$d,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),s$h(0,s$l,"measureWidth",function(){var s$d=0;this.commitMeasure();for(var s$L=this.numChildren-1;-1<s$L;s$L--){var s$l=this.getChildAt(s$L);s$l.visible&&(s$d=Math.max(s$l.x+s$l.width*s$l.scaleX,s$d))}return s$d}),s$h(0,s$l,"displayHeight",function(){return this.height*this.scaleY}),s$h(0,s$l,"height",function(){return this._height?this._height:this.measureHeight},function(s$d){this._height!=s$d&&(this._height=s$d,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),s$h(0,s$l,"dataSource",function(){return this._dataSource},function(s$d){for(var s$L in this._dataSource=s$d,this._dataSource)this.hasOwnProperty(s$L)&&"function"!=typeof this[s$L]&&(this[s$L]=this._dataSource[s$L])}),s$h(0,s$l,"scaleY",s$L.prototype._$get_scaleY,function(s$d){s$r.superGet(s$s,this,"scaleY")!=s$d&&(s$r.superSet(s$s,this,"scaleY",s$d),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),s$h(0,s$l,"measureHeight",function(){var s$d=0;this.commitMeasure();for(var s$L=this.numChildren-1;-1<s$L;s$L--){var s$l=this.getChildAt(s$L);s$l.visible&&(s$d=Math.max(s$l.y+s$l.height*s$l.scaleY,s$d))}return s$d}),s$h(0,s$l,"scaleX",s$L.prototype._$get_scaleX,function(s$d){s$r.superGet(s$s,this,"scaleX")!=s$d&&(s$r.superSet(s$s,this,"scaleX",s$d),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),s$h(0,s$l,"top",function(){return this._layout.top},function(s$d){s$d!=this._layout.top&&(this.getLayout().top=s$d,this._setLayoutEnabled(!0)),this.resetLayoutY()}),s$h(0,s$l,"bottom",function(){return this._layout.bottom},function(s$d){s$d!=this._layout.bottom&&(this.getLayout().bottom=s$d,this._setLayoutEnabled(!0)),this.resetLayoutY()}),s$h(0,s$l,"left",function(){return this._layout.left},function(s$d){s$d!=this._layout.left&&(this.getLayout().left=s$d,this._setLayoutEnabled(!0)),this.resetLayoutX()}),s$h(0,s$l,"right",function(){return this._layout.right},function(s$d){s$d!=this._layout.right&&(this.getLayout().right=s$d,this._setLayoutEnabled(!0)),this.resetLayoutX()}),s$h(0,s$l,"centerX",function(){return this._layout.centerX},function(s$d){s$d!=this._layout.centerX&&(this.getLayout().centerX=s$d,this._setLayoutEnabled(!0)),this.resetLayoutX()}),s$h(0,s$l,"centerY",function(){return this._layout.centerY},function(s$d){s$d!=this._layout.centerY&&(this.getLayout().centerY=s$d,this._setLayoutEnabled(!0)),this.resetLayoutY()}),s$h(0,s$l,"anchorX",function(){return this._layout.anchorX},function(s$d){s$d!=this._layout.anchorX&&(this.getLayout().anchorX=s$d,this._setLayoutEnabled(!0)),this.resetLayoutX()}),s$h(0,s$l,"anchorY",function(){return this._layout.anchorY},function(s$d){s$d!=this._layout.anchorY&&(this.getLayout().anchorY=s$d,this._setLayoutEnabled(!0)),this.resetLayoutY()}),s$h(0,s$l,"tag",function(){return this._tag},function(s$d){this._tag=s$d}),s$h(0,s$l,"toolTip",function(){return this._toolTip},function(s$d){this._toolTip!=s$d&&(null!=(this._toolTip=s$d)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),s$h(0,s$l,"comXml",function(){return this._comXml},function(s$d){this._comXml=s$d}),s$h(0,s$l,"gray",function(){return this._gray},function(s$d){s$d!==this._gray&&(this._gray=s$d,s$g.gray(this,s$d))}),s$h(0,s$l,"disabled",function(){return this._disabled},function(s$d){s$d!==this._disabled&&(this.gray=this._disabled=s$d,this.mouseEnabled=!s$d)}),s$d}(s$s)),s$p=function(s$d){function s$L(){this.lockLayer=null,this.popupEffect=function(s$d){s$d.scale(1,1),s$$.from(s$d,{x:s$r.stage.width/2,y:s$r.stage.height/2,scaleX:0,scaleY:0},300,s$m.backOut,s$q.create(this,this.doOpen,[s$d]))},this.closeEffect=function(s$d,s$L){s$$.to(s$d,{x:s$r.stage.width/2,y:s$r.stage.height/2,scaleX:0,scaleY:0},300,s$m.strongOut,s$q.create(this,this.doClose,[s$d,s$L]))},s$L.__super.call(this),this.maskLayer=new s$s,this.popupEffectHandler=s$q.create(this,this.popupEffect,null,!1),this.closeEffectHandler=s$q.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,s$r.stage.addChild(this),s$r.stage.on("resize",this,this._onResize),s$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}s$_(s$L,"laya.ui.DialogManager",s$s);var s$l=s$L.prototype;return s$l._closeOnSide=function(){var s$d=this.getChildAt(this.numChildren-1);s$d instanceof laya.ui.Dialog&&s$d.close("side")},s$l.setLockView=function(s$d){this.lockLayer||(this.lockLayer=new s$H,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(s$r.stage.width,s$r.stage.height)),this.lockLayer.removeChildren(),s$d&&(s$d.centerX=s$d.centerY=0,this.lockLayer.addChild(s$d))},s$l._onResize=function(s$d){var s$L=this.maskLayer.width=s$r.stage.width,s$l=this.maskLayer.height=s$r.stage.height;this.lockLayer&&this.lockLayer.size(s$L,s$l),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,s$L,s$l,s$F.popupBgColor),this.maskLayer.alpha=s$F.popupBgAlpha;for(var s$Z=this.numChildren-1;-1<s$Z;s$Z--){var s$h=this.getChildAt(s$Z);s$h.popupCenter&&this._centerDialog(s$h)}},s$l._centerDialog=function(s$d){s$d.x=Math.round((s$r.stage.width-s$d.width>>1)+s$d.pivotX),s$d.y=Math.round((s$r.stage.height-s$d.height>>1)+s$d.pivotY)},s$l.open=function(s$d,s$L,s$l){void 0===s$L&&(s$L=!1),void 0===s$l&&(s$l=!1),s$L&&this._closeAll(),s$d.popupCenter&&this._centerDialog(s$d),this.addChild(s$d),(s$d.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),s$l&&null!=s$d.popupEffect?s$d.popupEffect.runWith(s$d):this.doOpen(s$d),this.event("open")},s$l.doOpen=function(s$d){s$d.onOpened()},s$l.lock=function(s$d){this.lockLayer&&(s$d?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},s$l.close=function(s$d,s$L,s$l){void 0===s$l&&(s$l=!1),s$l&&null!=s$d.closeEffect?s$d.closeEffect.runWith([s$d,s$L]):this.doClose(s$d,s$L),this.event("close")},s$l.doClose=function(s$d,s$L){s$d.removeSelf(),s$d.isModal&&this._checkMask(),s$d.closeHandler&&s$d.closeHandler.runWith(s$L),s$d.onClosed(s$L)},s$l.closeAll=function(){this._closeAll(),this.event("close")},s$l._closeAll=function(){for(var s$d=this.numChildren-1;-1<s$d;s$d--){var s$L=this.getChildAt(s$d);s$L&&null!=s$L.close&&this.doClose(s$L)}},s$l.getDialogsByGroup=function(s$d){for(var s$L=[],s$l=this.numChildren-1;-1<s$l;s$l--){var s$Z=this.getChildAt(s$l);s$Z&&s$Z.group===s$d&&s$L.push(s$Z)}return s$L},s$l.closeByGroup=function(s$d){for(var s$L=[],s$l=this.numChildren-1;-1<s$l;s$l--){var s$Z=this.getChildAt(s$l);s$Z&&s$Z.group===s$d&&(s$Z.close(),s$L.push(s$Z))}return s$L},s$l._checkMask=function(){this.maskLayer.removeSelf();for(var s$d=this.numChildren-1;-1<s$d;s$d--){var s$L=this.getChildAt(s$d);if(s$L&&s$L.isModal)return void this.addChildAt(this.maskLayer,s$d)}},s$L}(),s$H=function(s$d){function s$L(){s$L.__super.call(this)}s$_(s$L,"laya.ui.Box",s$d);var s$l=s$L.prototype;return s$r.imps(s$l,{"laya.ui.IBox":!0}),s$h(0,s$l,"dataSource",s$d.prototype._$get_dataSource,function(s$d){for(var s$L in this._dataSource=s$d){var s$l=this.getChildByName(s$L);s$l?s$l.dataSource=s$d[s$L]:this.hasOwnProperty(s$L)&&"function"!=typeof this[s$L]&&(this[s$L]=s$d[s$L])}}),s$L}(s$I),s$X=function(s$L){function s$l(s$d,s$L){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,s$l.__super.call(this),this._labelColors=s$Q.buttonLabelColors,this._stateNum=s$Q.buttonStateNum,void 0===s$L&&(s$L=""),this.skin=s$d,this.label=s$L}s$_(s$l,"laya.ui.Button",s$L);var s$d=s$l.prototype;return s$r.imps(s$d,{"laya.ui.ISelect":!0}),s$d.destroy=function(s$d){s$e.clearCache(this,this._skin),s$e.clearObject(this,this._weakKey),void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(s$d),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},s$d.createChildren=function(){this.graphics=this._bitmap=new s$E},s$d.createText=function(){this._text||(this._text=new s$A,this._text.overflow=s$A.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},s$d.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},s$d.onMouse=function(s$d){if(!1!==this.toggle||!this._selected)return"click"===s$d.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=s$l.stateMap[s$d.type]))},s$d.changeClips=function(){var s$d=s$e.getRes(this._skin);if(s$d&&this._skin&&""!=this._skin){s$e.clearObject(this,this._weakKey);var s$L=s$d.sourceWidth,s$l=s$d.sourceHeight/this._stateNum;s$d.$_GID||(s$d.$_GID=s$O.getGID());var s$Z=s$d.$_GID+"-"+this._stateNum,s$h=s$e.findObject(s$Z);if(s$O.isOkTextureList(s$h)||(s$h=null),s$h)this._weakKey=s$Z,s$e.keepObject(this,this._weakKey),this._sources=s$h;else{if(this._sources=[],1===this._stateNum)this._sources.push(s$d);else for(var s$_=0;s$_<this._stateNum;s$_++){var s$N=s$y.createFromTexture(s$d,0,s$l*s$_,s$L,s$l);if(s$d.alphaTexture){var s$m=s$d.width/s$d.alphaTexture.width;s$N.alphaTexture=s$y.createFromTexture(s$d.alphaTexture,0/s$m,s$l*s$_/s$m,s$L/s$m,s$l/s$m)}this._sources.push(s$N)}s$e.saveObject(s$Z,this._sources),this._weakKey=s$Z,s$e.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||s$L,this._bitmap.height=this._height||s$l,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=s$L)}else console.warn("lose skin ",this._skin,this.name,this.__className)},s$d.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var s$d=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[s$d]),this.label&&(this._text.color=this._labelColors[s$d],this._strokeColors&&(this._text.strokeColor=this._strokeColors[s$d]))},s$d._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},s$h(0,s$d,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(s$d){this.createText(),this._text.strokeColor=s$d}),s$h(0,s$d,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(s$e.clearCache(this,this._skin),this._skin=s$d,s$e.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),s$h(0,s$d,"state",function(){return this._state},function(s$d){this._state!=s$d&&(this._state=s$d,this._setStateChanged())}),s$h(0,s$d,"text",function(){return this.createText(),this._text}),s$h(0,s$d,"stateNum",function(){return this._stateNum},function(s$d){"string"==typeof s$d&&(s$d=parseInt(s$d)),this._stateNum!=s$d&&(this._stateNum=s$d<1?1:3<s$d?3:s$d,this.callLater(this.changeClips))}),s$h(0,s$d,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(s$d){this._strokeColors=s$g.fillArray(s$Q.buttonLabelColors,s$d,String),this._setStateChanged()}),s$h(0,s$d,"labelColors",function(){return this._labelColors.join(",")},function(s$d){this._labelColors=s$g.fillArray(s$Q.buttonLabelColors,s$d,String),this._setStateChanged()}),s$h(0,s$d,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),s$h(0,s$d,"label",function(){return this._text?this._text.text:null},function(s$d){(this._text||s$d)&&(this.createText(),this._text.text!=s$d&&(s$d&&!this._text.parent&&this.addChild(this._text),this._text.text=(s$d+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),s$h(0,s$d,"selected",function(){return this._selected},function(s$d){this._selected!=s$d&&(this._selected=s$d,this.state=this._selected?2:0,this.event("change"))}),s$h(0,s$d,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(s$d){this.createText(),this._text.padding=s$g.fillArray(s$Q.labelPadding,s$d,Number)}),s$h(0,s$d,"labelSize",function(){return this.createText(),this._text.fontSize},function(s$d){this.createText(),this._text.fontSize=s$d}),s$h(0,s$d,"labelStroke",function(){return this.createText(),this._text.stroke},function(s$d){this.createText(),this._text.stroke=s$d}),s$h(0,s$d,"labelBold",function(){return this.createText(),this._text.bold},function(s$d){this.createText(),this._text.bold=s$d}),s$h(0,s$d,"labelFont",function(){return this.createText(),this._text.font},function(s$d){this.createText(),this._text.font=s$d}),s$h(0,s$d,"labelAlign",function(){return this.createText(),this._text.align},function(s$d){this.createText(),this._text.align=s$d}),s$h(0,s$d,"clickHandler",function(){return this._clickHandler},function(s$d){this._clickHandler=s$d}),s$h(0,s$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(s$d){this._bitmap.sizeGrid=s$g.fillArray(s$Q.defaultSizeGrid,s$d,Number)}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$I,this,"width",s$d),this._autoSize&&(this._bitmap.width=s$d,this._text&&(this._text.width=s$d))}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$I,this,"height",s$d),this._autoSize&&(this._bitmap.height=s$d,this._text&&(this._text.height=s$d))}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)||"string"==typeof s$d?this.label=s$d+"":s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(s$d){this._bitmap._offset=s$d?s$g.fillArray([1,1],s$d,Number):[]}),s$Z(s$l,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),s$l}(s$I),s$j=function(s$L){function s$Z(s$d,s$L,s$l){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,s$Z.__super.call(this),void 0===s$L&&(s$L=1),void 0===s$l&&(s$l=1),this._clipX=s$L,this._clipY=s$l,this.skin=s$d}s$_(s$Z,"laya.ui.Clip",s$L);var s$d=s$Z.prototype;return s$d.destroy=function(s$d){s$e.clearCache(this,this._skin),s$e.clearObject(this,this._weakKey),void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},s$d.dispose=function(){this.destroy(!0),s$r.loader.clearRes(this._skin)},s$d.createChildren=function(){this.graphics=this._bitmap=new s$E},s$d._onDisplay=function(s$d){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},s$d.changeClip=function(){if(this._clipChanged=!1,this._skin){var s$d=s$e.getRes(this._skin);s$d?this.loadComplete(this._skin,s$d):s$r.loader.load(this._skin,s$q.create(this,this.loadComplete,[this._skin]))}},s$d.loadComplete=function(s$d,s$L){if(s$d===this._skin&&s$L){s$e.clearObject(this,this._weakKey);var s$l=this._clipWidth||Math.ceil(s$L.sourceWidth/this._clipX),s$Z=this._clipHeight||Math.ceil(s$L.sourceHeight/this._clipY),s$h=this._skin+s$l+s$Z,s$_=s$e.findObject(s$h);if(s$O.isOkTextureList(s$_)||(s$_=null),s$_)this._weakKey=s$h,s$e.keepObject(this,this._weakKey),this._sources=s$_;else{this._sources=[];for(var s$N=0;s$N<this._clipY;s$N++)for(var s$m=0;s$m<this._clipX;s$m++){var s$u=s$y.createFromTexture(s$L,s$l*s$m,s$Z*s$N,s$l,s$Z);if(s$L.alphaTexture){var s$x=s$L.width/s$L.alphaTexture.width;s$u.alphaTexture=s$y.createFromTexture(s$L.alphaTexture,s$l*s$m/s$x,s$Z*s$N/s$x,s$l/s$x,s$Z/s$x)}this._sources.push(s$u)}s$e.saveObject(s$h,this._sources),this._weakKey=s$h,s$e.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},s$d.play=function(s$d,s$L){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=-1),this._isPlaying=!0,this.index=s$d,this._toIndex=s$L,this._index++,s$r.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},s$d._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},s$d.stop=function(){this._isPlaying=!1,s$r.timer.clear(this,this._loop),this.event("complete")},s$d._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},s$h(0,s$d,"interval",function(){return this._interval},function(s$d){this._interval!=s$d&&(this._interval=s$d,this._isPlaying&&this.play())}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(s$e.clearCache(this,this._skin),(this._skin=s$d)?(s$e.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),s$h(0,s$d,"sources",function(){return this._sources},function(s$d){this._sources=s$d,this.index=this._index,this.event("loaded")}),s$h(0,s$d,"clipX",function(){return this._clipX},function(s$d){this._clipX=s$d||1,this._setClipChanged()}),s$h(0,s$d,"clipY",function(){return this._clipY},function(s$d){this._clipY=s$d||1,this._setClipChanged()}),s$h(0,s$d,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),s$h(0,s$d,"clipWidth",function(){return this._clipWidth},function(s$d){this._clipWidth=s$d,this._setClipChanged()}),s$h(0,s$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(s$d){this._bitmap.sizeGrid=s$g.fillArray(s$Q.defaultSizeGrid,s$d,Number)}),s$h(0,s$d,"group",function(){return this._group},function(s$d){s$d&&this._skin&&s$e.setGroup(this._skin,s$d),this._group=s$d}),s$h(0,s$d,"clipHeight",function(){return this._clipHeight},function(s$d){this._clipHeight=s$d,this._setClipChanged()}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$I,this,"width",s$d),this._bitmap.width=s$d}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$I,this,"height",s$d),this._bitmap.height=s$d}),s$h(0,s$d,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),s$h(0,s$d,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),s$h(0,s$d,"index",function(){return this._index},function(s$d){this._index=s$d,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[s$d]),this.event("change")}),s$h(0,s$d,"autoPlay",function(){return this._autoPlay},function(s$d){this._autoPlay!=s$d&&((this._autoPlay=s$d)?this.play():this.stop())}),s$h(0,s$d,"isPlaying",function(){return this._isPlaying},function(s$d){this._isPlaying=s$d}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)&&Math.floor(s$d)==s$d||"string"==typeof s$d?this.index=parseInt(s$d):s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"bitmap",function(){return this._bitmap}),s$Z}(s$I),s$R=function(s$L){function s$d(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,s$d.__super.call(this)}s$_(s$d,"laya.ui.ColorPicker",s$L);var s$l=s$d.prototype;return s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._colorPanel&&this._colorPanel.destroy(s$d),this._colorButton&&this._colorButton.destroy(s$d),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},s$l.createChildren=function(){this.addChild(this._colorButton=new s$X),this._colorPanel=new s$H,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new s$s),this._colorPanel.addChild(this._colorBlock=new s$s),this._colorPanel.addChild(this._colorInput=new s$Y)},s$l.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},s$l.onPanelMouseDown=function(s$d){s$d.stopPropagation()},s$l.changePanel=function(){this._panelChanged=!1;var s$d=this._colorPanel.graphics;s$d.clear(),s$d.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(s$d=this._colorTiles.graphics).clear();for(var s$L=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],s$l=0;s$l<12;s$l++)for(var s$Z=0;s$Z<20;s$Z++){var s$h=0;s$h=0===s$Z?s$L[s$l]:1===s$Z?0:51*(((3*s$l+s$Z/6)%3<<0)+3*(s$l/6<<0))<<16|s$Z%6*51<<8|(s$l<<0)%6*51;var s$_=s$g.toColor(s$h);this._colors.push(s$_);var s$N=s$Z*this._gridSize,s$m=s$l*this._gridSize;s$d.drawRect(s$N,s$m,this._gridSize,this._gridSize,s$_,"#000000")}},s$l.onColorButtonClick=function(s$d){this._colorPanel.parent?this.close():this.open()},s$l.open=function(){var s$d=this.localToGlobal(new s$c),s$L=s$d.x+this._colorPanel.width<=s$r.stage.width?s$d.x:s$r.stage.width-this._colorPanel.width,s$l=s$d.y+this._colorButton.height;s$l=s$l+this._colorPanel.height<=s$r.stage.height?s$l:s$d.y-this._colorPanel.height,this._colorPanel.pos(s$L,s$l),this._colorPanel.zOrder=1001,s$r._currentStage.addChild(this._colorPanel),s$r.stage.on("mousedown",this,this.removeColorBox)},s$l.close=function(){s$r.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},s$l.removeColorBox=function(s$d){this.close()},s$l.onColorFieldKeyDown=function(s$d){13==s$d.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),s$d.stopPropagation())},s$l.onColorInputChange=function(s$d){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},s$l.onColorTilesClick=function(s$d){this.selectedColor=this.getColorByMouse(),this.close()},s$l.onColorTilesMouseMove=function(s$d){this._colorInput.focus=!1;var s$L=this.getColorByMouse();this._colorInput.text=s$L,this.drawBlock(s$L)},s$l.getColorByMouse=function(){var s$d=this._colorTiles.getMousePoint(),s$L=Math.floor(s$d.x/this._gridSize),s$l=Math.floor(s$d.y/this._gridSize);return this._colors[20*s$l+s$L]},s$l.drawBlock=function(s$d){var s$L=this._colorBlock.graphics;s$L.clear();var s$l=s$d||"#ffffff";s$L.drawRect(0,0,50,20,s$l,this._borderColor),s$d||s$L.drawLine(0,0,50,20,"#ff0000")},s$l.changeColor=function(){var s$d=this.graphics;s$d.clear();var s$L=this._selectedColor||"#000000";s$d.drawRect(0,0,this._colorButton.width,this._colorButton.height,s$L)},s$l._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},s$h(0,s$l,"inputBgColor",function(){return this._inputBgColor},function(s$d){this._inputBgColor=s$d,this._setPanelChanged()}),s$h(0,s$l,"selectedColor",function(){return this._selectedColor},function(s$d){this._selectedColor!=s$d&&(this._selectedColor=this._colorInput.text=s$d,this.drawBlock(s$d),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",s$u.EMPTY.setTo("change",this,this)))}),s$h(0,s$l,"skin",function(){return this._colorButton.skin},function(s$d){this._colorButton.skin=s$d,this.changeColor()}),s$h(0,s$l,"bgColor",function(){return this._bgColor},function(s$d){this._bgColor=s$d,this._setPanelChanged()}),s$h(0,s$l,"borderColor",function(){return this._borderColor},function(s$d){this._borderColor=s$d,this._setPanelChanged()}),s$h(0,s$l,"inputColor",function(){return this._inputColor},function(s$d){this._inputColor=s$d,this._setPanelChanged()}),s$d}(s$I),s$o=function(s$L){function s$l(s$d,s$L){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,s$l.__super.call(this),this._itemColors=s$Q.comboBoxItemColors,this.skin=s$d,this.labels=s$L}s$_(s$l,"laya.ui.ComboBox",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._button&&this._button.destroy(s$d),this._list&&this._list.destroy(s$d),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},s$d.createChildren=function(){this.addChild(this._button=new s$X),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},s$d._createList=function(){this._list=new s$K,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},s$d._setListEvent=function(s$d){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=s$q.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},s$d.onListDown=function(s$d){s$d.stopPropagation()},s$d.onScrollBarDown=function(s$d){s$d.stopPropagation()},s$d.onButtonMouseDown=function(s$d){this.callLater(this.switchTo,[!this._isOpen])},s$d.changeList=function(){this._listChanged=!1;var s$d=this.width-2,s$L=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:s$d,height:this._itemHeight,fontSize:this._itemSize,color:s$L}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},s$d.onlistItemMouse=function(s$d,s$L){var s$l=s$d.type;if("mouseover"===s$l||"mouseout"===s$l){if(this._isCustomList)return;var s$Z=this._list.getCell(s$L);if(!s$Z)return;var s$h=s$Z.getChildByName("label");s$h&&("mouseover"===s$l?(s$h.bgColor=this._itemColors[0],s$h.color=this._itemColors[1]):(s$h.bgColor=null,s$h.color=this._itemColors[2]))}else"click"===s$l&&(this.selectedIndex=s$L,this.isOpen=!1)},s$d.switchTo=function(s$d){this.isOpen=s$d},s$d.changeOpen=function(){this.isOpen=!this._isOpen},s$d.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var s$d=this._list.graphics;s$d.clear(),s$d.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var s$L=this._list.array||[],s$l=s$L.length=0,s$Z=this._labels.length;s$l<s$Z;s$l++)s$L.push({label:this._labels[s$l]});this._list.height=this._listHeight,this._list.array=s$L},s$d.changeSelected=function(){this._button.label=this.selectedLabel},s$d._onStageMouseWheel=function(s$d){this._list&&!this._list.contains(s$d.target)&&this.removeList(null)},s$d.removeList=function(s$d){s$r.stage.off("mousedown",this,this.removeList),s$r.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},s$h(0,s$d,"selectedIndex",function(){return this._selectedIndex},function(s$d){this._selectedIndex!=s$d&&(this._selectedIndex=s$d,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[s$u.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),s$h(0,s$d,"measureHeight",function(){return this._button.height}),s$h(0,s$d,"skin",function(){return this._button.skin},function(s$d){this._button.skin!=s$d&&(this._button.skin=s$d,this._listChanged=!0)}),s$h(0,s$d,"measureWidth",function(){return this._button.width}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$I,this,"width",s$d),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),s$h(0,s$d,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(s$d){this.selectedIndex=this._labels.indexOf(s$d)}),s$h(0,s$d,"labels",function(){return this._labels.join(",")},function(s$d){0<this._labels.length&&(this.selectedIndex=-1),s$d?this._labels=s$d.split(","):this._labels.length=0,this._itemChanged=!0}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$I,this,"height",s$d),this._button.height=this._height}),s$h(0,s$d,"selectHandler",function(){return this._selectHandler},function(s$d){this._selectHandler=s$d}),s$h(0,s$d,"visibleNum",function(){return this._visibleNum},function(s$d){this._visibleNum=s$d,this._listChanged=!0}),s$h(0,s$d,"labelBold",function(){return this._button.text.bold},function(s$d){this._button.text.bold=s$d}),s$h(0,s$d,"itemColors",function(){return String(this._itemColors)},function(s$d){this._itemColors=s$g.fillArray(this._itemColors,s$d,String),this._listChanged=!0}),s$h(0,s$d,"itemSize",function(){return this._itemSize},function(s$d){this._itemSize=s$d,this._listChanged=!0}),s$h(0,s$d,"scrollBar",function(){return this.list.scrollBar}),s$h(0,s$d,"isOpen",function(){return this._isOpen},function(s$d){if(this._isOpen!=s$d)if(this._isOpen=s$d,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var s$L=this.localToGlobal(s$c.TEMP.setTo(0,0)),s$l=s$L.y+this._button.height;s$l=s$l+this._listHeight<=s$r.stage.height?s$l:s$L.y-this._listHeight,this._list.pos(s$L.x,s$l),this._list.zOrder=1001,s$r._currentStage.addChild(this._list),s$r.stage.once("mousedown",this,this.removeList),s$r.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),s$h(0,s$d,"scrollBarSkin",function(){return this._scrollBarSkin},function(s$d){this._scrollBarSkin=s$d}),s$h(0,s$d,"sizeGrid",function(){return this._button.sizeGrid},function(s$d){this._button.sizeGrid=s$d}),s$h(0,s$d,"button",function(){return this._button}),s$h(0,s$d,"list",function(){return this._list||this._createList(),this._list},function(s$d){s$d&&(s$d.removeSelf(),this._isCustomList=!0,this._list=s$d,this._setListEvent(s$d),this._itemHeight=s$d.getCell(0).height+s$d.spaceY)}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)&&Math.floor(s$d)==s$d||"string"==typeof s$d?this.selectedIndex=parseInt(s$d):s$d instanceof Array?this.labels=s$d.join(","):s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"labelColors",function(){return this._button.labelColors},function(s$d){this._button.labelColors!=s$d&&(this._button.labelColors=s$d)}),s$h(0,s$d,"labelPadding",function(){return this._button.text.padding.join(",")},function(s$d){this._button.text.padding=s$g.fillArray(s$Q.labelPadding,s$d,Number)}),s$h(0,s$d,"labelSize",function(){return this._button.text.fontSize},function(s$d){this._button.text.fontSize=s$d}),s$h(0,s$d,"labelFont",function(){return this._button.text.font},function(s$d){this._button.text.font=s$d}),s$h(0,s$d,"stateNum",function(){return this._button.stateNum},function(s$d){this._button.stateNum=s$d}),s$l}(s$I),s$i=function(s$L){function s$l(s$d){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,s$l.__super.call(this),this._showButtons=s$F.showButtons,this._touchScrollEnable=s$F.touchScrollEnable,this._mouseWheelEnable=s$F.mouseWheelEnable,this.skin=s$d,this.max=1}s$_(s$l,"laya.ui.ScrollBar",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),this.stopScroll(),this.target=null,s$L.prototype.destroy.call(this,s$d),this.upButton&&this.upButton.destroy(s$d),this.downButton&&this.downButton.destroy(s$d),this.slider&&this.slider.destroy(s$d),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},s$d.createChildren=function(){this.addChild(this.slider=new s$S),this.addChild(this.upButton=new s$X),this.addChild(this.downButton=new s$X)},s$d.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},s$d.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},s$d.onButtonMouseDown=function(s$d){var s$L=s$d.currentTarget===this.upButton;this.slide(s$L),s$r.timer.once(s$Q.scrollBarDelayTime,this,this.startLoop,[s$L]),s$r.stage.once("mouseup",this,this.onStageMouseUp)},s$d.startLoop=function(s$d){s$r.timer.frameLoop(1,this,this.slide,[s$d])},s$d.slide=function(s$d){s$d?this.value-=this._scrollSize:this.value+=this._scrollSize},s$d.onStageMouseUp=function(s$d){s$r.timer.clear(this,this.startLoop),s$r.timer.clear(this,this.slide)},s$d.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},s$d.changeSize=function(){s$L.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},s$d.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},s$d.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},s$d.setScroll=function(s$d,s$L,s$l){this.runCallLater(this.changeSize),this.slider.setSlider(s$d,s$L,s$l),this.slider.bar.visible=0<s$L,!this._hide&&this.autoHide&&(this.visible=!1)},s$d.onTargetMouseWheel=function(s$d){this.value-=s$d.delta*this._scrollSize,this.target=this._target},s$d.onTargetMouseDown=function(s$d){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new s$c),this._lastPoint.setTo(s$r.stage.mouseX,s$r.stage.mouseY),s$r.timer.clear(this,this.tweenMove),s$$.clearTween(this),s$r.stage.once("mouseup",this,this.onStageMouseUp2),s$r.stage.once("mouseout",this,this.onStageMouseUp2),s$r.timer.frameLoop(1,this,this.loop)},s$d.loop=function(){var s$d=s$r.stage.mouseY,s$L=s$r.stage.mouseX;if(this._lastOffset=this.isVertical?s$d-this._lastPoint.y:s$L-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?s$r.stage._canvasTransform.getScaleY():s$r.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=s$L,this._lastPoint.y=s$d,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},s$d.onStageMouseUp2=function(s$d){if(s$r.stage.off("mouseup",this,this.onStageMouseUp2),s$r.stage.off("mouseout",this,this.onStageMouseUp2),s$r.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?s$$.to(this,{value:this.min},this.elasticBackTime,s$m.sineOut,s$q.create(this,this.elasticOver)):this._value>this.max&&s$$.to(this,{value:this.max},this.elasticBackTime,s$m.sineOut,s$q.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?s$r.stage.mouseY-this._lastPoint.y:s$r.stage.mouseX-this._lastPoint.x);for(var s$L=0,s$l=Math.min(this._offsets.length,3),s$Z=0;s$Z<s$l;s$Z++)s$L+=this._offsets[this._offsets.length-1-s$Z];if(this._lastOffset=s$L/s$l,(s$L=Math.abs(this._lastOffset))<2)return void this.event("end");60<s$L&&(this._lastOffset=0<this._lastOffset?60:-60);var s$h=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));s$r.timer.frameLoop(1,this,this.tweenMove,[s$h])}},s$d.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&s$$.to(this,{alpha:0},500),this.event("end")},s$d.tweenMove=function(s$d){this._lastOffset*=this.rollRatio;var s$L=NaN;if(0<s$d&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,s$L=.5*-(this.min-s$d-this.value),this._lastOffset>s$L&&(this._lastOffset=s$L)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,s$L=.5*-(this.max+s$d-this.value),this._lastOffset<s$L&&(this._lastOffset=s$L))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(s$r.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?s$$.to(this,{value:this.min},this.elasticBackTime,s$m.sineOut,s$q.create(this,this.elasticOver)):this._value>this.max?s$$.to(this,{value:this.max},this.elasticBackTime,s$m.sineOut,s$q.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&s$$.to(this,{alpha:0},500)}},s$d.stopScroll=function(){this.onStageMouseUp2(null),s$r.timer.clear(this,this.tweenMove),s$$.clearTween(this)},s$h(0,s$d,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(this._skin=s$d,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),s$h(0,s$d,"max",function(){return this.slider.max},function(s$d){this.slider.max=s$d}),s$h(0,s$d,"showButtons",function(){return this._showButtons},function(s$d){this._showButtons=s$d,this.callLater(this.changeScrollBar)}),s$h(0,s$d,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),s$h(0,s$d,"min",function(){return this.slider.min},function(s$d){this.slider.min=s$d}),s$h(0,s$d,"value",function(){return this._value},function(s$d){s$d!==this._value&&(this._value=s$d,this._isElastic||(this.slider._value!=s$d&&(this.slider._value=s$d,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),s$h(0,s$d,"isVertical",function(){return this.slider.isVertical},function(s$d){this.slider.isVertical=s$d}),s$h(0,s$d,"sizeGrid",function(){return this.slider.sizeGrid},function(s$d){this.slider.sizeGrid=s$d}),s$h(0,s$d,"scrollSize",function(){return this._scrollSize},function(s$d){this._scrollSize=s$d}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)||"string"==typeof s$d?this.value=Number(s$d):s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"thumbPercent",function(){return this._thumbPercent},function(s$d){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),s$d=1<=s$d?.99:s$d,this._thumbPercent=s$d,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*s$d,s$Q.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*s$d,s$Q.scrollBarMinNum))}),s$h(0,s$d,"target",function(){return this._target},function(s$d){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=s$d)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),s$h(0,s$d,"hide",function(){return this._hide},function(s$d){this._hide=s$d,this.visible=!s$d}),s$h(0,s$d,"touchScrollEnable",function(){return this._touchScrollEnable},function(s$d){this._touchScrollEnable=s$d,this.target=this._target}),s$h(0,s$d,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(s$d){this._mouseWheelEnable=s$d,this.target=this._target}),s$h(0,s$d,"tick",function(){return this.slider.tick},function(s$d){this.slider.tick=s$d}),s$l}(s$I),s$S=function(s$L){function s$l(s$d){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,s$l.__super.call(this),this.skin=s$d}s$_(s$l,"laya.ui.Slider",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._bg&&this._bg.destroy(s$d),this._bar&&this._bar.destroy(s$d),this._progress&&this._progress.destroy(s$d),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},s$d.createChildren=function(){this.addChild(this._bg=new s$B),this.addChild(this._bar=new s$X)},s$d.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},s$d.onBarMouseDown=function(s$d){this._globalSacle||(this._globalSacle=new s$c),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=s$r.stage.mouseX,this._ty=s$r.stage.mouseY,s$r.stage.on("mousemove",this,this.mouseMove),s$r.stage.once("mouseup",this,this.mouseUp),s$r.stage.once("mouseout",this,this.mouseUp),this.showValueText()},s$d.showValueText=function(){if(this.showLabel){var s$d=laya.ui.Slider.label;this.addChild(s$d),s$d.textField.changeText(this._value+""),this.isVertical?(s$d.x=this._bar.x+20,s$d.y=.5*(this._bar.height-s$d.height)+this._bar.y):(s$d.y=this._bar.y-20,s$d.x=.5*(this._bar.width-s$d.width)+this._bar.x)}},s$d.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},s$d.mouseUp=function(s$d){s$r.stage.off("mousemove",this,this.mouseMove),s$r.stage.off("mouseup",this,this.mouseUp),s$r.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},s$d.mouseMove=function(s$d){var s$L=this._value;this.isVertical?(this._bar.y+=(s$r.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(s$r.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=s$r.stage.mouseX,this._ty=s$r.stage.mouseY;var s$l=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*s$l)/s$l,this._value!=s$L&&this.sendChangeEvent(),this.showValueText()},s$d.sendChangeEvent=function(s$d){void 0===s$d&&(s$d="change"),this.event(s$d),this.changeHandler&&this.changeHandler.runWith(this._value)},s$d.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},s$d.changeSize=function(){s$L.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},s$d.setSlider=function(s$d,s$L,s$l){this._value=-1,this._min=s$d,this._max=s$d<s$L?s$L:s$d,this.value=s$l<s$d?s$d:s$L<s$l?s$L:s$l},s$d.changeValue=function(){var s$d=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*s$d)/s$d,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var s$L=this._max-this._min;0===s$L&&(s$L=1),this.isVertical?(this._bar.y=(this._value-this._min)/s$L*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/s$L*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},s$d.onBgMouseDown=function(s$d){var s$L=this._bg.getMousePoint();this.isVertical?this.value=s$L.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=s$L.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},s$h(0,s$d,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){if(this._skin!=s$d){this._skin=s$d,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var s$L=this._skin.replace(".png","$progress.png");s$e.getRes(s$L)&&(this._progress||(this.addChild(this._progress=new s$B),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=s$L),this.setBarPoint(),this.callLater(this.changeValue)}}),s$h(0,s$d,"allowClickBack",function(){return this._allowClickBack},function(s$d){this._allowClickBack!=s$d&&((this._allowClickBack=s$d)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),s$h(0,s$d,"max",function(){return this._max},function(s$d){this._max!=s$d&&(this._max=s$d,this.callLater(this.changeValue))}),s$h(0,s$d,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),s$h(0,s$d,"tick",function(){return this._tick},function(s$d){this._tick!=s$d&&(this._tick=s$d,this.callLater(this.changeValue))}),s$h(0,s$d,"sizeGrid",function(){return this._bg.sizeGrid},function(s$d){this._bg.sizeGrid=s$d,this._bar.sizeGrid=s$d,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),s$h(0,s$d,"min",function(){return this._min},function(s$d){this._min!=s$d&&(this._min=s$d,this.callLater(this.changeValue))}),s$h(0,s$d,"value",function(){return this._value},function(s$d){if(this._value!=s$d){var s$L=this._value;this._value=s$d,this.changeValue(),this._value!=s$L&&this.sendChangeEvent()}}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)||"string"==typeof s$d?this.value=Number(s$d):s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"bar",function(){return this._bar}),s$Z(s$l,["label",function(){return this.label=new s$C}]),s$l}(s$I),s$B=function(s$L){function s$l(s$d){this._bitmap=null,this._skin=null,this._group=null,s$l.__super.call(this),this.skin=s$d}s$_(s$l,"laya.ui.Image",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,s$e.clearCache(this,this._skin)},s$d.dispose=function(){this.destroy(!0),s$e.clearCache(this,this._skin)},s$d.createChildren=function(){this.graphics=this._bitmap=new s$E},s$d.setSource=function(s$d,s$L){s$d===this._skin&&s$L&&(this.source=s$L,this.onCompResize())},s$h(0,s$d,"source",function(){return this._bitmap.source},function(s$d){this._bitmap&&(this._bitmap.source=s$d,this.event("loaded"),this.repaint())}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"string"==typeof(this._dataSource=s$d)?this.skin=s$d:s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"measureHeight",function(){return this._bitmap.height}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){if(this._skin!=s$d)if(s$e.clearCache(this,this._skin),this._skin=s$d){s$e.keepCache(this,this._skin);var s$L=s$e.getRes(s$d);s$L?(this.source=s$L,this.onCompResize()):s$r.loader.load(this._skin,s$q.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),s$h(0,s$d,"group",function(){return this._group},function(s$d){s$d&&this._skin&&s$e.setGroup(this._skin,s$d),this._group=s$d}),s$h(0,s$d,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(s$d){this._bitmap.sizeGrid=s$g.fillArray(s$Q.defaultSizeGrid,s$d,Number)}),s$h(0,s$d,"measureWidth",function(){return this._bitmap.width}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$I,this,"width",s$d),this._bitmap.width=0==s$d?1e-7:s$d}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$I,this,"height",s$d),this._bitmap.height=0==s$d?1e-7:s$d}),s$l}(s$I),s$C=function(s$L){function s$l(s$d){this._tf=null,s$l.__super.call(this),void 0===s$d&&(s$d=""),s$x.defaultColor=s$Q.labelColor,this.text=s$d}s$_(s$l,"laya.ui.Label",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._tf=null},s$d.createChildren=function(){this.addChild(this._tf=new s$A)},s$d.changeText=function(s$d){this._tf.changeText(s$d)},s$h(0,s$d,"padding",function(){return this._tf.padding.join(",")},function(s$d){this._tf.padding=s$g.fillArray(s$Q.labelPadding,s$d,Number)}),s$h(0,s$d,"bold",function(){return this._tf.bold},function(s$d){this._tf.bold=s$d}),s$h(0,s$d,"align",function(){return this._tf.align},function(s$d){this._tf.align=s$d}),s$h(0,s$d,"text",function(){return this._tf.text},function(s$d){this._tf.text!=s$d&&(s$d&&(s$d=s$g.adptString(s$d+"")),this._tf.text=s$d,this.event("change"),this._width&&this._height||this.onCompResize())}),s$h(0,s$d,"italic",function(){return this._tf.italic},function(s$d){this._tf.italic=s$d}),s$h(0,s$d,"wordWrap",function(){return this._tf.wordWrap},function(s$d){this._tf.wordWrap=s$d}),s$h(0,s$d,"font",function(){return this._tf.font},function(s$d){this._tf.font=s$d}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)||"string"==typeof s$d?this.text=s$d+"":s$r.superSet(s$I,this,"dataSource",s$d)}),s$h(0,s$d,"color",function(){return this._tf.color},function(s$d){this._tf.color=s$d}),s$h(0,s$d,"valign",function(){return this._tf.valign},function(s$d){this._tf.valign=s$d}),s$h(0,s$d,"leading",function(){return this._tf.leading},function(s$d){this._tf.leading=s$d}),s$h(0,s$d,"fontSize",function(){return this._tf.fontSize},function(s$d){this._tf.fontSize=s$d}),s$h(0,s$d,"bgColor",function(){return this._tf.bgColor},function(s$d){this._tf.bgColor=s$d}),s$h(0,s$d,"borderColor",function(){return this._tf.borderColor},function(s$d){this._tf.borderColor=s$d}),s$h(0,s$d,"stroke",function(){return this._tf.stroke},function(s$d){this._tf.stroke=s$d}),s$h(0,s$d,"strokeColor",function(){return this._tf.strokeColor},function(s$d){this._tf.strokeColor=s$d}),s$h(0,s$d,"textField",function(){return this._tf}),s$h(0,s$d,"measureWidth",function(){return this._tf.width}),s$h(0,s$d,"measureHeight",function(){return this._tf.height}),s$h(0,s$d,"width",function(){return this._width||this._tf.text?s$r.superGet(s$I,this,"width"):0},function(s$d){s$r.superSet(s$I,this,"width",s$d),this._tf.width=s$d}),s$h(0,s$d,"height",function(){return this._height||this._tf.text?s$r.superGet(s$I,this,"height"):0},function(s$d){s$r.superSet(s$I,this,"height",s$d),this._tf.height=s$d}),s$h(0,s$d,"overflow",function(){return this._tf.overflow},function(s$d){this._tf.overflow=s$d}),s$h(0,s$d,"underline",function(){return this._tf.underline},function(s$d){this._tf.underline=s$d}),s$h(0,s$d,"underlineColor",function(){return this._tf.underlineColor},function(s$d){this._tf.underlineColor=s$d}),s$l}(s$I),s$P=function(s$L){function s$l(s$d){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,s$l.__super.call(this),this.skin=s$d}s$_(s$l,"laya.ui.ProgressBar",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._bg&&this._bg.destroy(s$d),this._bar&&this._bar.destroy(s$d),this._bg=this._bar=null,this.changeHandler=null},s$d.createChildren=function(){this.addChild(this._bg=new s$B),this.addChild(this._bar=new s$B)},s$d.changeValue=function(){if(this.sizeGrid){var s$d=this.sizeGrid.split(","),s$L=Number(s$d[3]),s$l=Number(s$d[1]),s$Z=(this.width-s$L-s$l)*this._value;this._bar.width=s$L+s$l+s$Z,this._bar.visible=this._bar.width>s$L+s$l}else this._bar.width=this.width*this._value},s$h(0,s$d,"measureHeight",function(){return this._bg.height}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(this._skin=s$d,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),s$h(0,s$d,"measureWidth",function(){return this._bg.width}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$I,this,"height",s$d),this._bg.height=this._height,this._bar.height=this._height}),s$h(0,s$d,"bar",function(){return this._bar}),s$h(0,s$d,"value",function(){return this._value},function(s$d){this._value!=s$d&&(s$d=1<s$d?1:s$d<0?0:s$d,this._value=s$d,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(s$d))}),s$h(0,s$d,"bg",function(){return this._bg}),s$h(0,s$d,"sizeGrid",function(){return this._bg.sizeGrid},function(s$d){this._bg.sizeGrid=this._bar.sizeGrid=s$d}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$I,this,"width",s$d),this._bg.width=this._width,this.callLater(this.changeValue)}),s$h(0,s$d,"dataSource",s$L.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)||"string"==typeof s$d?this.value=Number(s$d):s$r.superSet(s$I,this,"dataSource",s$d)}),s$l}(s$I),s$T=(function(s$d){function s$l(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,s$l.__super.call(this),this._tipBox=new s$I,this._tipBox.addChild(this._tipText=new s$A),this._tipText.x=this._tipText.y=5,this._tipText.color=s$l.tipTextColor,this._defaultTipHandler=this._showDefaultTip,s$r.stage.on("showtip",this,this._onStageShowTip),s$r.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}s$_(s$l,"laya.ui.TipManager",s$I);var s$L=s$l.prototype;s$L._onStageHideTip=function(s$d){s$r.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},s$L._onStageShowTip=function(s$d){s$r.timer.once(s$l.tipDelay,this,this._showTip,[s$d],!0)},s$L._showTip=function(s$d){if("string"==typeof s$d){var s$L=String(s$d);Boolean(s$L)&&this._defaultTipHandler(s$L)}else s$d instanceof laya.utils.Handler?s$d.run():"function"==typeof s$d&&s$d.apply();s$r.stage.on("mousemove",this,this._onStageMouseMove),s$r.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},s$L._onStageMouseDown=function(s$d){this.closeAll()},s$L._onStageMouseMove=function(s$d){this._showToStage(this,s$l.offsetX,s$l.offsetY)},s$L._showToStage=function(s$d,s$L,s$l){void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0);var s$Z=s$d.getBounds();s$d.x=s$r.stage.mouseX+s$L,s$d.y=s$r.stage.mouseY+s$l,s$d.x+s$Z.width>s$r.stage.width&&(s$d.x-=s$Z.width+s$L),s$d.y+s$Z.height>s$r.stage.height&&(s$d.y-=s$Z.height+s$l)},s$L.closeAll=function(){s$r.timer.clear(this,this._showTip),s$r.stage.off("mousemove",this,this._onStageMouseMove),s$r.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},s$L.showDislayTip=function(s$d){this.addChild(s$d),this._showToStage(this),s$r._currentStage.addChild(this)},s$L._showDefaultTip=function(s$d){this._tipText.text=s$d;var s$L=this._tipBox.graphics;s$L.clear(),s$L.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,s$l.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),s$r._currentStage.addChild(this)},s$h(0,s$L,"defaultTipHandler",function(){return this._defaultTipHandler},function(s$d){this._defaultTipHandler=s$d}),s$l.offsetX=10,s$l.offsetY=15,s$l.tipTextColor="#ffffff",s$l.tipBackColor="#111111",s$l.tipDelay=200}(),function(s$d){var s$Y;function s$c(){this._idMap=null,this._aniList=null,this._watchMap={},s$c.__super.call(this)}s$_(s$c,"laya.ui.View",s$H);var s$L=s$c.prototype;return s$L.createView=function(s$d){if(s$d.animations&&!this._idMap&&(this._idMap={}),s$c.createComp(s$d,this,this),s$d.animations){var s$L,s$l,s$Z=[],s$h=s$d.animations,s$_=0,s$N=s$h.length;for(s$_=0;s$_<s$N;s$_++){switch(s$L=new s$t,s$l=s$h[s$_],s$L._setUp(this._idMap,s$l),(this[s$l.name]=s$L)._setControlNode(this),s$l.action){case 1:s$L.play(0,!1);break;case 2:s$L.play(0,!0)}s$Z.push(s$L)}this._aniList=s$Z}0<this._width&&null==s$d.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},s$L.onEvent=function(s$d,s$L){},s$L.loadUI=function(s$d){var s$L=s$c.uiMap[s$d];s$L&&this.createView(s$L)},s$L.destroy=function(s$d){void 0===s$d&&(s$d=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,s$d)},s$L.changeData=function(s$d){var s$L=this._watchMap[s$d];if(s$L){console.log("change",s$d);for(var s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){s$L[s$l].exe(this)}}},s$c._regs=function(){for(var s$d in s$c.uiClassMap)s$a.regClass(s$d,s$c.uiClassMap[s$d])},s$c.createComp=function(s$d,s$L,s$l,s$Z){if(!(s$L=s$L||s$c.getCompInstance(s$d)))return console.warn("can not create:"+s$d.type),null;var s$h=s$d.child;if(s$h)for(var s$_=s$L instanceof laya.ui.List,s$N=0,s$m=s$h.length;s$N<s$m;s$N++){var s$u=s$h[s$N];if(!s$L.hasOwnProperty("itemRender")||"render"!=s$u.props.name&&"render"!==s$u.props.renderType)if("Graphic"==s$u.type)s$a.addGraphicsToSprite(s$u,s$L);else if(s$a.isDrawType(s$u.type))s$a.addGraphicToSprite(s$u,s$L,!0);else{if(s$_){var s$x=[],s$t=s$c.createComp(s$u,null,s$l,s$x);s$x.length&&(s$t._$bindData=s$x)}else s$t=s$c.createComp(s$u,null,s$l,s$Z);"Script"==s$u.type?"owner"in s$t?s$t.owner=s$L:"target"in s$t&&(s$t.target=s$L):"mask"==s$u.props.renderType||"mask"==s$u.props.name?s$L.mask=s$t:s$t instanceof laya.display.Sprite&&s$L.addChild(s$t)}else s$L.itemRender=s$u}var s$b=s$d.props;for(var s$q in s$b){var s$Y=s$b[s$q];s$c.eventDic[s$q]?s$Y&&s$l&&s$L.on(s$q,s$l,s$l.onEvent,[s$Y]):s$c.setCompValue(s$L,s$q,s$Y,s$l,s$Z)}return s$r.__typeof(s$L,"laya.ui.IItem")&&s$L.initItems(),s$d.compId&&s$l&&s$l._idMap&&(s$l._idMap[s$d.compId]=s$L),s$L},s$c.setCompValue=function(s$d,s$L,s$l,s$Z,s$h){if("string"==typeof s$l&&-1<s$l.indexOf("${")){if(s$c._sheet||(s$c._sheet=s$a.getClass("laya.data.Table")),!s$c._sheet)return void console.warn("Can not find class Sheet");if(s$h)s$h.push(s$d,s$L,s$l);else if(s$Z){-1==s$l.indexOf("].")&&(s$l=s$l.replace(".","[0]."));var s$_,s$N,s$m=new s$Y(s$d,s$L,s$l);s$m.exe(s$Z);for(var s$u=s$l.replace(/\[.*?\]\./g,".");null!=(s$_=s$c._parseWatchData.exec(s$u));){for(var s$x=s$_[1];null!=(s$N=s$c._parseKeyWord.exec(s$x));){var s$t=s$N[0],s$b=s$Z._watchMap[s$t]||(s$Z._watchMap[s$t]=[]);s$b.push(s$m),s$c._sheet.I.notifer.on(s$t,s$Z,s$Z.changeData,[s$t])}(s$b=s$Z._watchMap[s$x]||(s$Z._watchMap[s$x]=[])).push(s$m),s$c._sheet.I.notifer.on(s$x,s$Z,s$Z.changeData,[s$x])}}}else if("var"===s$L&&s$Z)s$Z[s$l]=s$d;else if("onClick"==s$L){var s$q=s$r._runScript("(function(){"+s$l+"})");s$d.on("click",s$Z,s$q)}else s$d[s$L]="true"===s$l||"false"!==s$l&&s$l},s$c.getCompInstance=function(s$d){var s$L,s$l=s$d.props?s$d.props.runtime:null;return s$L=s$l?s$c.viewClassMap[s$l]||s$c.uiClassMap[s$l]||s$r.__classmap[s$l]:s$c.uiClassMap[s$d.type],s$d.props&&s$d.props.hasOwnProperty("renderType")&&"instance"==s$d.props.renderType?s$L.instance:s$L?new s$L:null},s$c.regComponent=function(s$d,s$L){s$c.uiClassMap[s$d]=s$L,s$a.regClass(s$d,s$L)},s$c.regViewRuntime=function(s$d,s$L){s$c.viewClassMap[s$d]=s$L},s$c.uiMap={},s$c.viewClassMap={},s$c._sheet=null,s$Z(s$c,["uiClassMap",function(){return this.uiClassMap={ViewStack:s$dd,LinkButton:s$X,TextArea:s$xd,ColorPicker:s$R,Box:s$H,Button:s$X,CheckBox:s$z,Clip:s$j,ComboBox:s$o,Component:s$I,HScrollBar:s$v,HSlider:s$f,Image:s$B,Label:s$C,List:s$K,Panel:s$J,ProgressBar:s$P,Radio:s$W,RadioGroup:s$md,ScrollBar:s$i,Slider:s$S,Tab:s$ud,TextInput:s$ld,View:s$c,VScrollBar:s$Ld,VSlider:s$Zd,Tree:s$M,HBox:s$_d,VBox:s$Nd,Sprite:s$s,Animation:s$l,Text:s$A,FontClip:s$G}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),s$c.__init$=function(){s$c._regs(),s$Y=function(){function s$d(s$d,s$L,s$l){this.comp=null,this.prop=null,this.value=null,this.comp=s$d,this.prop=s$L,this.value=s$l}return s$_(s$d,""),s$d.prototype.exe=function(s$d){var s$L=s$g.getBindFun(this.value);this.comp[this.prop]=s$L.call(this,s$d)},s$d}()},s$c}()),s$z=function(s$d){function s$l(s$d,s$L){void 0===s$L&&(s$L=""),s$l.__super.call(this,s$d,s$L)}s$_(s$l,"laya.ui.CheckBox",s$d);var s$L=s$l.prototype;return s$L.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},s$L.initialize=function(){s$d.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},s$h(0,s$L,"dataSource",s$d.prototype._$get_dataSource,function(s$d){"boolean"==typeof(this._dataSource=s$d)?this.selected=s$d:"string"==typeof s$d?this.selected="true"===s$d:s$r.superSet(s$X,this,"dataSource",s$d)}),s$l}(s$X),s$D=function(s$d){function s$L(){this._space=0,this._align="none",this._itemChanged=!1,s$L.__super.call(this)}s$_(s$L,"laya.ui.LayoutBox",s$H);var s$l=s$L.prototype;return s$l.addChild=function(s$d){return s$d.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,s$d)},s$l.onResize=function(s$d){this._setItemChanged()},s$l.addChildAt=function(s$d,s$L){return s$d.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,s$d,s$L)},s$l.removeChild=function(s$d){return s$d.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,s$d)},s$l.removeChildAt=function(s$d){return this.getChildAt(s$d).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,s$d)},s$l.refresh=function(){this._setItemChanged()},s$l.changeItems=function(){this._itemChanged=!1},s$l.sortItem=function(s$d){s$d&&s$d.sort(function(s$d,s$L){return s$d.y-s$L.y})},s$l._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},s$h(0,s$l,"space",function(){return this._space},function(s$d){this._space=s$d,this._setItemChanged()}),s$h(0,s$l,"align",function(){return this._align},function(s$d){this._align=s$d,this._setItemChanged()}),s$L}(),s$G=function(s$L){function s$l(s$d,s$L){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,s$l.__super.call(this),s$d&&(this.skin=s$d),s$L&&(this.sheet=s$L)}s$_(s$l,"laya.ui.FontClip",s$L);var s$d=s$l.prototype;return s$d.createChildren=function(){this._bitmap=new s$E,this.on("loaded",this,this._onClipLoaded)},s$d._onClipLoaded=function(){this.callLater(this.changeValue)},s$d.changeValue=function(){var s$d;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),s$d=this._sources[0]))){var s$L="horizontal"===this._direction;s$L?(this._wordsW=this._valueArr.length*(s$d.sourceWidth+this.spaceX),this._wordsH=s$d.sourceHeight):(this._wordsW=s$d.sourceWidth,this._wordsH=(s$d.sourceHeight+this.spaceY)*this._valueArr.length);var s$l=0;if(this._width)switch(this._align){case"center":s$l=.5*(this._width-this._wordsW);break;case"right":s$l=this._width-this._wordsW;break;default:s$l=0}for(var s$Z=0,s$h=this._valueArr.length;s$Z<s$h;s$Z++){var s$_=this._indexMap[this._valueArr.charAt(s$Z)];this.sources[s$_]&&(s$d=this.sources[s$_],s$L?this.graphics.drawTexture(s$d,s$l+s$Z*(s$d.sourceWidth+this.spaceX),0,s$d.sourceWidth,s$d.sourceHeight):this.graphics.drawTexture(s$d,0+s$l,s$Z*(s$d.sourceHeight+this.spaceY),s$d.sourceWidth,s$d.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),s$L.prototype.destroy.call(this,s$d)},s$h(0,s$d,"sheet",function(){return this._sheet},function(s$d){s$d+="";var s$L=(this._sheet=s$d).split(" ");this._clipX=String(s$L[0]).length,this.clipY=s$L.length,this._indexMap={};for(var s$l=0;s$l<this._clipY;s$l++)for(var s$Z=s$L[s$l].split(""),s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)this._indexMap[s$Z[s$h]]=s$l*this._clipX+s$h}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$j,this,"height",s$d),this.callLater(this.changeValue)}),s$h(0,s$d,"direction",function(){return this._direction},function(s$d){this._direction=s$d,this.callLater(this.changeValue)}),s$h(0,s$d,"value",function(){return this._valueArr?this._valueArr:""},function(s$d){s$d+="",this._valueArr=s$d,this.callLater(this.changeValue)}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$j,this,"width",s$d),this.callLater(this.changeValue)}),s$h(0,s$d,"spaceX",function(){return this._spaceX},function(s$d){this._spaceX=s$d,"horizontal"===this._direction&&this.callLater(this.changeValue)}),s$h(0,s$d,"spaceY",function(){return this._spaceY},function(s$d){this._spaceY=s$d,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),s$h(0,s$d,"align",function(){return this._align},function(s$d){this._align=s$d,this.callLater(this.changeValue)}),s$h(0,s$d,"measureWidth",function(){return this._wordsW}),s$h(0,s$d,"measureHeight",function(){return this._wordsH}),s$l}(s$j),s$K=function(s$d){function s$L(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new s$c,s$L.__super.call(this)}s$_(s$L,"laya.ui.List",s$d);var s$l=s$L.prototype;return s$r.imps(s$l,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),this._content&&this._content.destroy(s$d),this._scrollBar&&this._scrollBar.destroy(s$d),laya.ui.Component.prototype.destroy.call(this,s$d),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},s$l.createChildren=function(){this.addChild(this._content=new s$H)},s$l.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=s$r.superGet(s$H,this,"cacheAs")),s$r.superSet(s$H,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},s$l.onScrollEnd=function(){s$r.superSet(s$H,this,"cacheAs",this._$P.cacheAs)},s$l._removePreScrollBar=function(){var s$d=this.removeChildByName("scrollBar");s$d&&s$d.destroy(!0)},s$l.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var s$d=this._getOneCell(),s$L=s$d.width+this._spaceX||1,s$l=s$d.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/s$L):Math.ceil(this._width/s$L)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/s$l):Math.round(this._height/s$l));var s$Z=this._width?this._width:s$L*this.repeatX-this._spaceX,s$h=this._height?this._height:s$l*this.repeatY-this._spaceY;this._cellSize=this._isVertical?s$l:s$L,this._cellOffset=this._isVertical?s$l*Math.max(this._repeatY2,this._repeatY)-s$h-this._spaceY:s$L*Math.max(this._repeatX2,this._repeatX)-s$Z-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=s$h:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=s$Z),this.setContentSize(s$Z,s$h);var s$_=this._isVertical?this.repeatX:this.repeatY,s$N=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,s$_,s$N),this._createdLine=s$N,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},s$l._getOneCell=function(){if(0===this._cells.length){var s$d=this.createItem();if(this._offset.setTo(s$d.x,s$d.y),this.cacheContent)return s$d;this._cells.push(s$d)}return this._cells[0]},s$l._createItems=function(s$d,s$L,s$l){var s$Z=this._content,s$h=this._getOneCell(),s$_=s$h.width+this._spaceX,s$N=s$h.height+this._spaceY;if(this.cacheContent){var s$m=new s$H;s$m.cacheAsBitmap=!0,s$m.pos((this._isVertical?0:s$d)*s$_,(this._isVertical?s$d:0)*s$N),this._content.addChild(s$m),this._content.optimizeScrollRect=!0,s$Z=s$m}else{for(var s$u=[],s$x=this._cells.length-1;-1<s$x;s$x--){var s$t=this._cells[s$x];s$t.removeSelf(),s$u.push(s$t)}this._cells.length=0}for(var s$b=s$d;s$b<s$l;s$b++)for(var s$q=0;s$q<s$L;s$q++)(s$h=s$u&&s$u.length?s$u.pop():this.createItem()).x=(this._isVertical?s$q:s$b)*s$_-s$Z.x,s$h.y=(this._isVertical?s$b:s$q)*s$N-s$Z.y,s$h.name="item"+(s$b*s$L+s$q),s$Z.addChild(s$h),this.addCell(s$h)},s$l.createItem=function(){var s$d=[];if("function"==typeof this._itemRender)var s$L=new this._itemRender;else s$L=s$T.createComp(this._itemRender,null,null,s$d);if(0==s$d.length&&s$L._watchMap){var s$l=s$L._watchMap;for(var s$Z in s$l)for(var s$h=s$l[s$Z],s$_=0;s$_<s$h.length;s$_++){var s$N=s$h[s$_];s$d.push(s$N.comp,s$N.prop,s$N.value)}}return s$d.length&&(s$L._$bindData=s$d),s$L},s$l.addCell=function(s$d){s$d.on("click",this,this.onCellMouse),s$d.on("rightclick",this,this.onCellMouse),s$d.on("mouseover",this,this.onCellMouse),s$d.on("mouseout",this,this.onCellMouse),s$d.on("mousedown",this,this.onCellMouse),s$d.on("mouseup",this,this.onCellMouse),this._cells.push(s$d)},s$l.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var s$d=0,s$L=s$d=0;s$L<1e4;s$L++){var s$l=this.getChildByName("item"+s$L);if(!s$l)break;this.addCell(s$l),s$d++}this.repeatY=s$d}},s$l.setContentSize=function(s$d,s$L){this._content.width=s$d,this._content.height=s$L,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new s$k),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,s$d,s$L),this._content.scrollRect=this._content.scrollRect),this.event("resize")},s$l.onCellMouse=function(s$d){"mousedown"===s$d.type&&(this._isMoved=!1);var s$L=s$d.currentTarget,s$l=this._startIndex+this._cells.indexOf(s$L);s$l<0||("click"===s$d.type||"rightclick"===s$d.type?this.selectEnable&&!this._isMoved?this.selectedIndex=s$l:this.changeCellState(s$L,!0,0):"mouseover"!==s$d.type&&"mouseout"!==s$d.type||this._selectedIndex===s$l||this.changeCellState(s$L,"mouseover"===s$d.type,0),this.mouseHandler&&this.mouseHandler.runWith([s$d,s$l]))},s$l.changeCellState=function(s$d,s$L,s$l){var s$Z=s$d.getChildByName("selectBox");s$Z&&(this.selectEnable=!0,s$Z.visible=s$L,s$Z.index=s$l)},s$l.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},s$l.onScrollBarChange=function(s$d){this.runCallLater(this.changeCells);var s$L=this._scrollBar.value,s$l=this._isVertical?this.repeatX:this.repeatY,s$Z=this._isVertical?this.repeatY:this.repeatX,s$h=Math.floor(s$L/this._cellSize);if(this.cacheContent)s$N=s$Z+1,this._createdLine-s$h<s$N&&(this._createItems(this._createdLine,s$l,this._createdLine+s$N),this.renderItems(this._createdLine*s$l,0),this._createdLine+=s$N);else{var s$_=s$h*s$l,s$N=0;if(s$_>this._startIndex){s$N=s$_-this._startIndex;var s$m=!0,s$u=this._startIndex+s$l*(s$Z+1);this._isMoved=!0}else s$_<this._startIndex&&(s$N=this._startIndex-s$_,s$m=!1,s$u=this._startIndex-1,this._isMoved=!0);for(var s$x=0;s$x<s$N;s$x++){if(s$m){var s$t=this._cells.shift();this._cells[this._cells.length]=s$t;var s$b=s$u+s$x}else s$t=this._cells.pop(),this._cells.unshift(s$t),s$b=s$u-s$x;var s$q=Math.floor(s$b/s$l)*this._cellSize;this._isVertical?s$t.y=s$q:s$t.x=s$q,this.renderItem(s$t,s$b)}this._startIndex=s$_,this.changeSelectStatus()}var s$Y=this._content.scrollRect;this._isVertical?(s$Y.y=s$L-this._offset.y,s$Y.x=-this._offset.x):(s$Y.y=-this._offset.y,s$Y.x=s$L-this._offset.x),this._content.scrollRect=s$Y},s$l.posCell=function(s$d,s$L){if(this._scrollBar){var s$l=this._isVertical?this.repeatX:this.repeatY,s$Z=(this._isVertical?this.repeatY:this.repeatX,Math.floor(s$L/s$l)*this._cellSize);this._isVertical?s$d.y=s$Z:s$d.x=s$Z}},s$l.changeSelectStatus=function(){for(var s$d=0,s$L=this._cells.length;s$d<s$L;s$d++)this.changeCellState(this._cells[s$d],this._selectedIndex===this._startIndex+s$d,1)},s$l.renderItems=function(s$d,s$L){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0);for(var s$l=s$d,s$Z=s$L||this._cells.length;s$l<s$Z;s$l++)this.renderItem(this._cells[s$l],this._startIndex+s$l);this.changeSelectStatus()},s$l.renderItem=function(s$d,s$L){this._array&&0<=s$L&&s$L<this._array.length?(s$d.visible=!0,s$d._$bindData?(s$d._dataSource=this._array[s$L],this._bindData(s$d,this._array[s$L])):s$d.dataSource=this._array[s$L],this.cacheContent||this.posCell(s$d,s$L),this.hasListener("render")&&this.event("render",[s$d,s$L]),this.renderHandler&&this.renderHandler.runWith([s$d,s$L])):(s$d.visible=!1,s$d.dataSource=null)},s$l._bindData=function(s$d,s$L){for(var s$l=s$d._$bindData,s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++){var s$_=s$l[s$Z++],s$N=s$l[s$Z++],s$m=s$l[s$Z],s$u=s$g.getBindFun(s$m);s$_[s$N]=s$u.call(this,s$L)}},s$l.refresh=function(){this.array=this._array},s$l.getItem=function(s$d){return-1<s$d&&s$d<this._array.length?this._array[s$d]:null},s$l.changeItem=function(s$d,s$L){-1<s$d&&s$d<this._array.length&&(this._array[s$d]=s$L,s$d>=this._startIndex&&s$d<this._startIndex+this._cells.length&&this.renderItem(this.getCell(s$d),s$d))},s$l.setItem=function(s$d,s$L){this.changeItem(s$d,s$L)},s$l.addItem=function(s$d){this._array.push(s$d),this.array=this._array},s$l.addItemAt=function(s$d,s$L){this._array.splice(s$L,0,s$d),this.array=this._array},s$l.deleteItem=function(s$d){this._array.splice(s$d,1),this.array=this._array},s$l.getCell=function(s$d){return this.runCallLater(this.changeCells),-1<s$d&&this._cells?this._cells[(s$d-this._startIndex)%this._cells.length]:null},s$l.scrollTo=function(s$d){if(this._scrollBar){var s$L=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(s$d/s$L)*this._cellSize}else this.startIndex=s$d},s$l.tweenTo=function(s$d,s$L,s$l){if(void 0===s$L&&(s$L=200),this._scrollBar){var s$Z=this._isVertical?this.repeatX:this.repeatY;s$$.to(this._scrollBar,{value:Math.floor(s$d/s$Z)*this._cellSize},s$L,null,s$l,0,!0)}else this.startIndex=s$d,s$l&&s$l.run()},s$l._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},s$l.commitMeasure=function(){this.runCallLater(this.changeCells)},s$h(0,s$l,"cacheAs",s$d.prototype._$get_cacheAs,function(s$d){s$r.superSet(s$H,this,"cacheAs",s$d),this._scrollBar&&(this._$P.cacheAs=null,"none"!==s$d?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),s$h(0,s$l,"content",function(){return this._content}),s$h(0,s$l,"height",s$d.prototype._$get_height,function(s$d){s$d!=this._height&&(s$r.superSet(s$H,this,"height",s$d),this._setCellChanged())}),s$h(0,s$l,"itemRender",function(){return this._itemRender},function(s$d){if(this._itemRender!=s$d){this._itemRender=s$d;for(var s$L=this._cells.length-1;-1<s$L;s$L--)this._cells[s$L].destroy();this._cells.length=0,this._setCellChanged()}}),s$h(0,s$l,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(s$d){this._removePreScrollBar();var s$L=new s$Ld;s$L.name="scrollBar",s$L.right=0,s$d&&" "!=s$d&&(s$L.skin=s$d),this.scrollBar=s$L,this.addChild(s$L),this._setCellChanged()}),s$h(0,s$l,"page",function(){return this._page},function(s$d){this._page=s$d,this._array&&(this._page=0<s$d?s$d:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),s$h(0,s$l,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(s$d){this._removePreScrollBar();var s$L=new s$v;s$L.name="scrollBar",s$L.bottom=0,s$d&&" "!=s$d&&(s$L.skin=s$d),this.scrollBar=s$L,this.addChild(s$L),this._setCellChanged()}),s$h(0,s$l,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(s$d){this._repeatX=s$d,this._setCellChanged()}),s$h(0,s$l,"scrollBar",function(){return this._scrollBar},function(s$d){this._scrollBar!=s$d&&(this._scrollBar=s$d)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),s$h(0,s$l,"width",s$d.prototype._$get_width,function(s$d){s$d!=this._width&&(s$r.superSet(s$H,this,"width",s$d),this._setCellChanged())}),s$h(0,s$l,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(s$d){this._repeatY=s$d,this._setCellChanged()}),s$h(0,s$l,"spaceX",function(){return this._spaceX},function(s$d){this._spaceX=s$d,this._setCellChanged()}),s$h(0,s$l,"spaceY",function(){return this._spaceY},function(s$d){this._spaceY=s$d,this._setCellChanged()}),s$h(0,s$l,"selectedIndex",function(){return this._selectedIndex},function(s$d){this._selectedIndex!=s$d&&(this._selectedIndex=s$d,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(s$d),this.startIndex=this._startIndex)}),s$h(0,s$l,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(s$d){this.selectedIndex=this._array.indexOf(s$d)}),s$h(0,s$l,"length",function(){return this._array?this._array.length:0}),s$h(0,s$l,"selection",function(){return this.getCell(this._selectedIndex)},function(s$d){this.selectedIndex=this._startIndex+this._cells.indexOf(s$d)}),s$h(0,s$l,"startIndex",function(){return this._startIndex},function(s$d){this._startIndex=0<s$d?s$d:0,this.callLater(this.renderItems)}),s$h(0,s$l,"array",function(){return this._array},function(s$d){this.runCallLater(this.changeCells),this._array=s$d||[];var s$L=this._array.length;if(this.totalPage=Math.ceil(s$L/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<s$L?this._selectedIndex:s$L-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var s$l=this._isVertical?this.repeatX:this.repeatY,s$Z=this._isVertical?this.repeatY:this.repeatX,s$h=Math.ceil(s$L/s$l);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=s$Z/s$h,this._scrollBar.setScroll(0,(s$h-s$Z)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),s$h(0,s$l,"dataSource",s$d.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)&&Math.floor(s$d)==s$d||"string"==typeof s$d?this.selectedIndex=parseInt(s$d):s$d instanceof Array?this.array=s$d:s$r.superSet(s$H,this,"dataSource",s$d)}),s$h(0,s$l,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),s$L}(s$H),s$v=function(s$d){function s$L(){s$L.__super.call(this)}return s$_(s$L,"laya.ui.HScrollBar",s$d),s$L.prototype.initialize=function(){s$d.prototype.initialize.call(this),this.slider.isVertical=!1},s$L}(s$i),s$J=function(s$d){function s$L(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,s$L.__super.call(this),this.width=this.height=100}s$_(s$L,"laya.ui.Panel",s$d);var s$l=s$L.prototype;return s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),laya.ui.Component.prototype.destroy.call(this,s$d),this._content&&this._content.destroy(s$d),this._vScrollBar&&this._vScrollBar.destroy(s$d),this._hScrollBar&&this._hScrollBar.destroy(s$d),this._vScrollBar=null,this._hScrollBar=null,this._content=null},s$l.destroyChildren=function(){this._content.destroyChildren()},s$l.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new s$H)},s$l.addChild=function(s$d){return s$d.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(s$d)},s$l.onResize=function(){this._setScrollChanged()},s$l.addChildAt=function(s$d,s$L){return s$d.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(s$d,s$L)},s$l.removeChild=function(s$d){return s$d.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(s$d)},s$l.removeChildAt=function(s$d){return this.getChildAt(s$d).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(s$d)},s$l.removeChildren=function(s$d,s$L){return void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=2147483647),this._content.removeChildren(s$d,s$L),this._setScrollChanged(),this},s$l.getChildAt=function(s$d){return this._content.getChildAt(s$d)},s$l.getChildByName=function(s$d){return this._content.getChildByName(s$d)},s$l.getChildIndex=function(s$d){return this._content.getChildIndex(s$d)},s$l.changeScroll=function(){this._scrollChanged=!1;var s$d=this.contentWidth||1,s$L=this.contentHeight||1,s$l=this._vScrollBar,s$Z=this._hScrollBar,s$h=s$l&&s$L>this._height,s$_=s$Z&&s$d>this._width,s$N=s$h?this._width-s$l.width:this._width,s$m=s$_?this._height-s$Z.height:this._height;s$l&&(s$l.x=this._width-s$l.width,s$l.y=0,s$l.height=this._height-(s$_?s$Z.height:0),s$l.scrollSize=Math.max(.033*this._height,1),s$l.thumbPercent=s$m/s$L,s$l.setScroll(0,s$L-s$m,s$l.value)),s$Z&&(s$Z.x=0,s$Z.y=this._height-s$Z.height,s$Z.width=this._width-(s$h?s$l.width:0),s$Z.scrollSize=Math.max(.033*this._width,1),s$Z.thumbPercent=s$N/s$d,s$Z.setScroll(0,s$d-s$N,s$Z.value))},s$l.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},s$l.setContentSize=function(s$d,s$L){var s$l=this._content;s$l.width=s$d,s$l.height=s$L,s$l.scrollRect||(s$l.scrollRect=new s$k),s$l.scrollRect.setTo(0,0,s$d,s$L),s$l.scrollRect=s$l.scrollRect},s$l.onScrollBarChange=function(s$d){var s$L=this._content.scrollRect;if(s$L){var s$l=Math.round(s$d.value);s$d.isVertical?s$L.y=s$l:s$L.x=s$l,this._content.scrollRect=s$L}},s$l.scrollTo=function(s$d,s$L){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),this.vScrollBar&&(this.vScrollBar.value=s$L),this.hScrollBar&&(this.hScrollBar.value=s$d)},s$l.refresh=function(){this.changeScroll()},s$l.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=s$r.superGet(s$H,this,"cacheAs")),s$r.superSet(s$H,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},s$l.onScrollEnd=function(){s$r.superSet(s$H,this,"cacheAs",this._$P.cacheAs)},s$l._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},s$h(0,s$l,"numChildren",function(){return this._content.numChildren}),s$h(0,s$l,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(s$d){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new s$v),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=s$d}),s$h(0,s$l,"contentWidth",function(){for(var s$d=0,s$L=this._content.numChildren-1;-1<s$L;s$L--){var s$l=this._content.getChildAt(s$L);s$d=Math.max(s$l.x+s$l.width*s$l.scaleX,s$d)}return s$d}),s$h(0,s$l,"contentHeight",function(){for(var s$d=0,s$L=this._content.numChildren-1;-1<s$L;s$L--){var s$l=this._content.getChildAt(s$L);s$d=Math.max(s$l.y+s$l.height*s$l.scaleY,s$d)}return s$d}),s$h(0,s$l,"width",s$d.prototype._$get_width,function(s$d){s$r.superSet(s$H,this,"width",s$d),this._setScrollChanged()}),s$h(0,s$l,"hScrollBar",function(){return this._hScrollBar}),s$h(0,s$l,"content",function(){return this._content}),s$h(0,s$l,"height",s$d.prototype._$get_height,function(s$d){s$r.superSet(s$H,this,"height",s$d),this._setScrollChanged()}),s$h(0,s$l,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(s$d){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new s$Ld),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=s$d}),s$h(0,s$l,"vScrollBar",function(){return this._vScrollBar}),s$h(0,s$l,"cacheAs",s$d.prototype._$get_cacheAs,function(s$d){s$r.superSet(s$H,this,"cacheAs",s$d),this._$P.cacheAs=null,"none"!==s$d?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),s$L}(s$H),s$f=function(s$d){function s$L(s$d){s$L.__super.call(this,s$d),this.isVertical=!1}return s$_(s$L,"laya.ui.HSlider",s$S),s$L}(),s$U=function(s$d){function s$l(s$d,s$L){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,s$l.__super.call(this),this.skin=s$L,this.labels=s$d}s$_(s$l,"laya.ui.UIGroup",s$d);var s$L=s$l.prototype;return s$r.imps(s$L,{"laya.ui.IItem":!0}),s$L.preinitialize=function(){this.mouseEnabled=!0},s$L.destroy=function(s$d){void 0===s$d&&(s$d=!0),laya.ui.Component.prototype.destroy.call(this,s$d),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},s$L.addItem=function(s$d,s$L){void 0===s$L&&(s$L=!0);var s$l=s$d,s$Z=this._items.length;if(s$l.name="item"+s$Z,this.addChild(s$l),this.initItems(),s$L&&0<s$Z){var s$h=this._items[s$Z-1];"horizontal"==this._direction?s$l.x=s$h.x+s$h.width+this._space:s$l.y=s$h.y+s$h.height+this._space}else s$L&&(s$l.x=0,s$l.y=0);return s$Z},s$L.delItem=function(s$d,s$L){void 0===s$L&&(s$L=!0);var s$l=this._items.indexOf(s$d);if(-1!=s$l){var s$Z=s$d;this.removeChild(s$Z);for(var s$h=s$l+1,s$_=this._items.length;s$h<s$_;s$h++){var s$N=this._items[s$h];s$N.name="item"+(s$h-1),s$L&&("horizontal"==this._direction?s$N.x-=s$Z.width+this._space:s$N.y-=s$Z.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var s$m;s$m=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=s$m}}},s$L.initItems=function(){this._items||(this._items=[]);for(var s$d=this._items.length=0;s$d<1e4;s$d++){var s$L=this.getChildByName("item"+s$d);if(null==s$L)break;this._items.push(s$L),s$L.selected=s$d===this._selectedIndex,s$L.clickHandler=s$q.create(this,this.itemClick,[s$d],!1)}},s$L.itemClick=function(s$d){this.selectedIndex=s$d},s$L.setSelect=function(s$d,s$L){this._items&&-1<s$d&&s$d<this._items.length&&(this._items[s$d].selected=s$L)},s$L.createItem=function(s$d,s$L){return null},s$L.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var s$d=0,s$L=0,s$l=this._items.length;s$L<s$l;s$L++){var s$Z=this._items[s$L];this._skin&&(s$Z.skin=this._skin),this._labelColors&&(s$Z.labelColors=this._labelColors),this._labelSize&&(s$Z.labelSize=this._labelSize),this._labelStroke&&(s$Z.labelStroke=this._labelStroke),this._labelStrokeColor&&(s$Z.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(s$Z.strokeColors=this._strokeColors),this._labelBold&&(s$Z.labelBold=this._labelBold),this._labelPadding&&(s$Z.labelPadding=this._labelPadding),this._labelAlign&&(s$Z.labelAlign=this._labelAlign),this._stateNum&&(s$Z.stateNum=this._stateNum),this._labelFont&&(s$Z.labelFont=this._labelFont),"horizontal"===this._direction?(s$Z.y=0,s$Z.x=s$d,s$d+=s$Z.width+this._space):(s$Z.x=0,s$Z.y=s$d,s$d+=s$Z.height+this._space)}this.changeSize()},s$L.commitMeasure=function(){this.runCallLater(this.changeLabels)},s$L._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},s$h(0,s$L,"labelStrokeColor",function(){return this._labelStrokeColor},function(s$d){this._labelStrokeColor!=s$d&&(this._labelStrokeColor=s$d,this._setLabelChanged())}),s$h(0,s$L,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(this._skin=s$d,this._setLabelChanged())}),s$h(0,s$L,"selectedIndex",function(){return this._selectedIndex},function(s$d){this._selectedIndex!=s$d&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=s$d,this.setSelect(s$d,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),s$h(0,s$L,"labels",function(){return this._labels},function(s$d){if(this._labels!=s$d){if(this._labels=s$d,this.removeChildren(),this._setLabelChanged(),this._labels)for(var s$L=this._labels.split(","),s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){var s$h=this.createItem(this._skin,s$L[s$l]);s$h.name="item"+s$l,this.addChild(s$h)}this.initItems()}}),s$h(0,s$L,"strokeColors",function(){return this._strokeColors},function(s$d){this._strokeColors!=s$d&&(this._strokeColors=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelColors",function(){return this._labelColors},function(s$d){this._labelColors!=s$d&&(this._labelColors=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelStroke",function(){return this._labelStroke},function(s$d){this._labelStroke!=s$d&&(this._labelStroke=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelSize",function(){return this._labelSize},function(s$d){this._labelSize!=s$d&&(this._labelSize=s$d,this._setLabelChanged())}),s$h(0,s$L,"stateNum",function(){return this._stateNum},function(s$d){this._stateNum!=s$d&&(this._stateNum=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelBold",function(){return this._labelBold},function(s$d){this._labelBold!=s$d&&(this._labelBold=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelFont",function(){return this._labelFont},function(s$d){this._labelFont!=s$d&&(this._labelFont=s$d,this._setLabelChanged())}),s$h(0,s$L,"labelPadding",function(){return this._labelPadding},function(s$d){this._labelPadding!=s$d&&(this._labelPadding=s$d,this._setLabelChanged())}),s$h(0,s$L,"direction",function(){return this._direction},function(s$d){this._direction=s$d,this._setLabelChanged()}),s$h(0,s$L,"space",function(){return this._space},function(s$d){this._space=s$d,this._setLabelChanged()}),s$h(0,s$L,"items",function(){return this._items}),s$h(0,s$L,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(s$d){this.selectedIndex=this._items.indexOf(s$d)}),s$h(0,s$L,"dataSource",s$d.prototype._$get_dataSource,function(s$d){"number"==typeof(this._dataSource=s$d)&&Math.floor(s$d)==s$d||"string"==typeof s$d?this.selectedIndex=parseInt(s$d):s$d instanceof Array?this.labels=s$d.join(","):s$r.superSet(s$H,this,"dataSource",s$d)}),s$l}(s$H),s$W=function(s$L){function s$l(s$d,s$L){this._value=null,void 0===s$L&&(s$L=""),s$l.__super.call(this,s$d,s$L)}s$_(s$l,"laya.ui.Radio",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._value=null},s$d.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},s$d.initialize=function(){s$L.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},s$d.onClick=function(s$d){this.selected=!0},s$h(0,s$d,"value",function(){return null!=this._value?this._value:this.label},function(s$d){this._value=s$d}),s$l}(s$X),s$M=function(s$d){function s$L(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,s$L.__super.call(this),this.width=this.height=200}s$_(s$L,"laya.ui.Tree",s$d);var s$l=s$L.prototype;return s$r.imps(s$l,{"laya.ui.IRender":!0}),s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),laya.ui.Component.prototype.destroy.call(this,s$d),this._list&&this._list.destroy(s$d),this._list=null,this._source=null,this._renderHandler=null},s$l.createChildren=function(){this.addChild(this._list=new s$K),this._list.renderHandler=s$q.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},s$l.onListChange=function(s$d){this.event("change")},s$l.getArray=function(){var s$d,s$L=[];for(var s$l in this._source)s$d=this._source[s$l],this.getParentOpenStatus(s$d)&&(s$d.x=this._spaceLeft*this.getDepth(s$d),s$L.push(s$d));return s$L},s$l.getDepth=function(s$d,s$L){return void 0===s$L&&(s$L=0),null==s$d.nodeParent?s$L:this.getDepth(s$d.nodeParent,s$L+1)},s$l.getParentOpenStatus=function(s$d){var s$L=s$d.nodeParent;return null==s$L||!!s$L.isOpen&&(null==s$L.nodeParent||this.getParentOpenStatus(s$L))},s$l.renderItem=function(s$d,s$L){var s$l=s$d.dataSource;if(s$l){s$d.left=s$l.x;var s$Z=s$d.getChildByName("arrow");s$Z&&(s$l.hasChild?(s$Z.visible=!0,s$Z.index=s$l.isOpen?1:0,s$Z.tag=s$L,s$Z.off("click",this,this.onArrowClick),s$Z.on("click",this,this.onArrowClick)):s$Z.visible=!1);var s$h=s$d.getChildByName("folder");s$h&&(2==s$h.clipY?s$h.index=s$l.isDirectory?0:1:s$h.index=s$l.isDirectory?s$l.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([s$d,s$L])}},s$l.onArrowClick=function(s$d){var s$L=s$d.currentTarget.tag;this._list.array[s$L].isOpen=!this._list.array[s$L].isOpen,this.event("open"),this._list.array=this.getArray()},s$l.setItemState=function(s$d,s$L){this._list.array[s$d]&&(this._list.array[s$d].isOpen=s$L,this._list.array=this.getArray())},s$l.fresh=function(){this._list.array=this.getArray(),this.repaint()},s$l.parseXml=function(s$d,s$L,s$l,s$Z){var s$h,s$_=s$d.childNodes,s$N=s$_.length;if(!s$Z){s$h={};var s$m,s$u=s$d.attributes;for(var s$x in s$u){var s$t=(s$m=s$u[s$x]).nodeName,s$b=s$m.nodeValue;s$h[s$t]="true"==s$b||"false"!=s$b&&s$b}s$h.nodeParent=s$l,0<s$N&&(s$h.isDirectory=!0),s$h.hasChild=0<s$N,s$L.push(s$h)}for(var s$q=0;s$q<s$N;s$q++){var s$Y=s$_[s$q];this.parseXml(s$Y,s$L,s$h,!1)}},s$l.parseOpenStatus=function(s$d,s$L){for(var s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++){var s$h=s$L[s$l];if(s$h.isDirectory)for(var s$_=0,s$N=s$d.length;s$_<s$N;s$_++){var s$m=s$d[s$_];if(s$m.isDirectory&&this.isSameParent(s$m,s$h)&&s$h.label==s$m.label){s$h.isOpen=s$m.isOpen;break}}}},s$l.isSameParent=function(s$d,s$L){return null==s$d.nodeParent&&null==s$L.nodeParent||null!=s$d.nodeParent&&null!=s$L.nodeParent&&(s$d.nodeParent.label==s$L.nodeParent.label&&this.isSameParent(s$d.nodeParent,s$L.nodeParent))},s$l.filter=function(s$d){if(Boolean(s$d)){var s$L=[];this.getFilterSource(this._source,s$L,s$d),this._list.array=s$L}else this._list.array=this.getArray()},s$l.getFilterSource=function(s$d,s$L,s$l){var s$Z;for(var s$h in s$l=s$l.toLocaleLowerCase(),s$d)!(s$Z=s$d[s$h]).isDirectory&&-1<String(s$Z.label).toLowerCase().indexOf(s$l)&&(s$Z.x=0,s$L.push(s$Z)),s$Z.child&&0<s$Z.child.length&&this.getFilterSource(s$Z.child,s$L,s$l)},s$h(0,s$l,"spaceBottom",function(){return this._list.spaceY},function(s$d){this._list.spaceY=s$d}),s$h(0,s$l,"keepStatus",function(){return this._keepStatus},function(s$d){this._keepStatus=s$d}),s$h(0,s$l,"itemRender",function(){return this._list.itemRender},function(s$d){this._list.itemRender=s$d}),s$h(0,s$l,"array",function(){return this._list.array},function(s$d){this._keepStatus&&this._list.array&&s$d&&this.parseOpenStatus(this._list.array,s$d),this._source=s$d,this._list.array=this.getArray()}),s$h(0,s$l,"mouseHandler",function(){return this._list.mouseHandler},function(s$d){this._list.mouseHandler=s$d}),s$h(0,s$l,"dataSource",s$d.prototype._$get_dataSource,function(s$d){this._dataSource=s$d,s$r.superSet(s$H,this,"dataSource",s$d)}),s$h(0,s$l,"source",function(){return this._source}),s$h(0,s$l,"scrollBar",function(){return this._list.scrollBar}),s$h(0,s$l,"list",function(){return this._list}),s$h(0,s$l,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(s$d){this._list.vScrollBarSkin=s$d}),s$h(0,s$l,"renderHandler",function(){return this._renderHandler},function(s$d){this._renderHandler=s$d}),s$h(0,s$l,"selectedIndex",function(){return this._list.selectedIndex},function(s$d){this._list.selectedIndex=s$d}),s$h(0,s$l,"spaceLeft",function(){return this._spaceLeft},function(s$d){this._spaceLeft=s$d}),s$h(0,s$l,"selectedItem",function(){return this._list.selectedItem},function(s$d){this._list.selectedItem=s$d}),s$h(0,s$l,"width",s$d.prototype._$get_width,function(s$d){s$r.superSet(s$H,this,"width",s$d),this._list.width=s$d}),s$h(0,s$l,"height",s$d.prototype._$get_height,function(s$d){s$r.superSet(s$H,this,"height",s$d),this._list.height=s$d}),s$h(0,s$l,"xml",null,function(s$d){var s$L=[];this.parseXml(s$d.childNodes[0],s$L,null,!0),this.array=s$L}),s$h(0,s$l,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),s$L}(s$H),s$dd=function(s$d){function s$L(){this._items=null,this._selectedIndex=0,s$L.__super.call(this),this._setIndexHandler=s$q.create(this,this.setIndex,null,!1)}s$_(s$L,"laya.ui.ViewStack",s$d);var s$l=s$L.prototype;return s$r.imps(s$l,{"laya.ui.IItem":!0}),s$l.setItems=function(s$d){this.removeChildren();for(var s$L=0,s$l=0,s$Z=s$d.length;s$l<s$Z;s$l++){var s$h=s$d[s$l];s$h&&(s$h.name="item"+s$L,this.addChild(s$h),s$L++)}this.initItems()},s$l.addItem=function(s$d){s$d.name="item"+this._items.length,this.addChild(s$d),this.initItems()},s$l.initItems=function(){this._items=[];for(var s$d=0;s$d<1e4;s$d++){var s$L=this.getChildByName("item"+s$d);if(null==s$L)break;this._items.push(s$L),s$L.visible=s$d==this._selectedIndex}},s$l.setSelect=function(s$d,s$L){this._items&&-1<s$d&&s$d<this._items.length&&(this._items[s$d].visible=s$L)},s$l.setIndex=function(s$d){this.selectedIndex=s$d},s$h(0,s$l,"dataSource",s$d.prototype._$get_dataSource,function(s$d){if("number"==typeof(this._dataSource=s$d)&&Math.floor(s$d)==s$d||"string"==typeof s$d)this.selectedIndex=parseInt(s$d);else for(var s$L in this._dataSource)this.hasOwnProperty(s$L)&&(this[s$L]=this._dataSource[s$L])}),s$h(0,s$l,"selectedIndex",function(){return this._selectedIndex},function(s$d){this._selectedIndex!=s$d&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=s$d,this.setSelect(this._selectedIndex,!0))}),s$h(0,s$l,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(s$d){this.selectedIndex=this._items.indexOf(s$d)}),s$h(0,s$l,"items",function(){return this._items}),s$h(0,s$l,"setIndexHandler",function(){return this._setIndexHandler},function(s$d){this._setIndexHandler=s$d}),s$L}(s$H),s$Ld=function(s$d){function s$L(){s$L.__super.call(this)}return s$_(s$L,"laya.ui.VScrollBar",s$i),s$L}(),s$ld=function(s$L){function s$l(s$d){this._bg=null,this._skin=null,s$l.__super.call(this),void 0===s$d&&(s$d=""),this.text=s$d,this.skin=this.skin}s$_(s$l,"laya.ui.TextInput",s$L);var s$d=s$l.prototype;return s$d.preinitialize=function(){this.mouseEnabled=!0},s$d.destroy=function(s$d){s$e.clearCache(this,this._skin),void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._bg&&this._bg.destroy(),this._bg=null},s$d.createChildren=function(){this.addChild(this._tf=new s$Y),this._tf.padding=s$Q.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},s$d._onFocus=function(){this.event("focus",this)},s$d._onBlur=function(){this.event("blur",this)},s$d._onInput=function(){this.event("input",this)},s$d._onEnter=function(){this.event("enter",this)},s$d.initialize=function(){this.width=128,this.height=22},s$d.select=function(){this._tf.select()},s$d.setSelection=function(s$d,s$L){this._tf.setSelection(s$d,s$L)},s$h(0,s$d,"text",s$L.prototype._$get_text,function(s$d){this._tf.text!=s$d&&(s$d+="",this._tf.text=s$d,this.event("change"))}),s$h(0,s$d,"bg",function(){return this._bg},function(s$d){this.graphics=this._bg=s$d}),s$h(0,s$d,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(s$d){this._tf.inputElementYAdjuster=s$d}),s$h(0,s$d,"multiline",function(){return this._tf.multiline},function(s$d){this._tf.multiline=s$d}),s$h(0,s$d,"skin",function(){return this._skin},function(s$d){this._skin!=s$d&&(s$e.clearCache(this,this._skin),this._skin=s$d,this._bg||(this.graphics=this._bg=new s$E),s$e.keepCache(this,this._skin),this._bg.source=s$e.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),s$h(0,s$d,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(s$d){this._bg||(this.graphics=this._bg=new s$E),this._bg.sizeGrid=s$g.fillArray(s$Q.defaultSizeGrid,s$d,Number)}),s$h(0,s$d,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(s$d){this._tf.inputElementXAdjuster=s$d}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$C,this,"width",s$d),this._bg&&(this._bg.width=s$d)}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$C,this,"height",s$d),this._bg&&(this._bg.height=s$d)}),s$h(0,s$d,"editable",function(){return this._tf.editable},function(s$d){this._tf.editable=s$d}),s$h(0,s$d,"restrict",function(){return this._tf.restrict},function(s$d){this._tf.restrict=s$d}),s$h(0,s$d,"prompt",function(){return this._tf.prompt},function(s$d){this._tf.prompt=s$d}),s$h(0,s$d,"promptColor",function(){return this._tf.promptColor},function(s$d){this._tf.promptColor=s$d}),s$h(0,s$d,"maxChars",function(){return this._tf.maxChars},function(s$d){this._tf.maxChars=s$d}),s$h(0,s$d,"focus",function(){return this._tf.focus},function(s$d){this._tf.focus=s$d}),s$h(0,s$d,"type",function(){return this._tf.type},function(s$d){this._tf.type=s$d}),s$h(0,s$d,"asPassword",function(){return this._tf.asPassword},function(s$d){this._tf.asPassword=s$d}),s$l}(s$C),s$Zd=function(s$d){function s$L(){s$L.__super.call(this)}return s$_(s$L,"laya.ui.VSlider",s$S),s$L}(),s$hd=function(s$d){function s$Z(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,s$Z.__super.call(this)}s$_(s$Z,"laya.ui.Dialog",s$d);var s$L=s$Z.prototype;return s$L.initialize=function(){this.popupEffect=s$Z.manager.popupEffectHandler,this.closeEffect=s$Z.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},s$L._dealDragArea=function(){var s$d=this.getChildByName("drag");s$d&&(this.dragArea=s$d.x+","+s$d.y+","+s$d.width+","+s$d.height,s$d.removeSelf())},s$L._onClick=function(s$d){var s$L=s$d.target;if(s$L)switch(s$L.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(s$L.name)}},s$L.show=function(s$d,s$L){void 0===s$d&&(s$d=!1),void 0===s$L&&(s$L=!0),this._open(!1,s$d,s$L)},s$L.popup=function(s$d,s$L){void 0===s$d&&(s$d=!1),void 0===s$L&&(s$L=!0),this._open(!0,s$d,s$L)},s$L._open=function(s$d,s$L,s$l){s$Z.manager.lock(!1),this.isModal=s$d,s$Z.manager.open(this,s$L,s$l)},s$L.onOpened=function(){},s$L.close=function(s$d,s$L){void 0===s$L&&(s$L=!0),s$Z.manager.close(this,s$d,s$L)},s$L.onClosed=function(s$d){},s$L._onMouseDown=function(s$d){var s$L=this.getMousePoint();this._dragArea.contains(s$L.x,s$L.y)?this.startDrag():this.stopDrag()},s$h(0,s$L,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(s$d){if(s$d){var s$L=s$g.fillArray([0,0,0,0],s$d,Number);this._dragArea=new s$k(s$L[0],s$L[1],s$L[2],s$L[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),s$h(0,s$L,"isPopup",function(){return null!=this.parent}),s$h(0,s$L,"zOrder",s$d.prototype._$get_zOrder,function(s$d){s$r.superSet(s$T,this,"zOrder",s$d),s$Z.manager._checkMask()}),s$h(1,s$Z,"manager",function(){return s$Z._manager=s$Z._manager||new s$p},function(s$d){s$Z._manager=s$d}),s$Z.setLockView=function(s$d){s$Z.manager.setLockView(s$d)},s$Z.lock=function(s$d){s$Z.manager.lock(s$d)},s$Z.closeAll=function(){s$Z.manager.closeAll()},s$Z.getDialogsByGroup=function(s$d){return s$Z.manager.getDialogsByGroup(s$d)},s$Z.closeByGroup=function(s$d){return s$Z.manager.closeByGroup(s$d)},s$Z.CLOSE="close",s$Z.CANCEL="cancel",s$Z.SURE="sure",s$Z.NO="no",s$Z.OK="ok",s$Z.YES="yes",s$Z._manager=null,s$Z}(s$T),s$_d=function(s$d){function s$L(){s$L.__super.call(this)}s$_(s$L,"laya.ui.HBox",s$d);var s$l=s$L.prototype;return s$l.sortItem=function(s$d){s$d&&s$d.sort(function(s$d,s$L){return s$d.x-s$L.x})},s$l.changeItems=function(){this._itemChanged=!1;for(var s$d=[],s$L=0,s$l=0,s$Z=this.numChildren;s$l<s$Z;s$l++){var s$h=this.getChildAt(s$l);s$h&&s$h.layoutEnabled&&(s$d.push(s$h),s$L=this._height?this._height:Math.max(s$L,s$h.height*s$h.scaleY))}this.sortItem(s$d);var s$_=0;for(s$l=0,s$Z=s$d.length;s$l<s$Z;s$l++)(s$h=s$d[s$l]).x=s$_,s$_+=s$h.width*s$h.scaleX+this._space,"top"==this._align?s$h.y=0:"middle"==this._align?s$h.y=.5*(s$L-s$h.height*s$h.scaleY):"bottom"==this._align&&(s$h.y=s$L-s$h.height*s$h.scaleY);this.changeSize()},s$h(0,s$l,"height",s$d.prototype._$get_height,function(s$d){this._height!=s$d&&(s$r.superSet(s$D,this,"height",s$d),this.callLater(this.changeItems))}),s$L.NONE="none",s$L.TOP="top",s$L.MIDDLE="middle",s$L.BOTTOM="bottom",s$L}(s$D),s$Nd=function(s$d){function s$L(){s$L.__super.call(this)}s$_(s$L,"laya.ui.VBox",s$d);var s$l=s$L.prototype;return s$l.changeItems=function(){this._itemChanged=!1;for(var s$d=[],s$L=0,s$l=0,s$Z=this.numChildren;s$l<s$Z;s$l++){var s$h=this.getChildAt(s$l);s$h&&s$h.layoutEnabled&&(s$d.push(s$h),s$L=this._width?this._width:Math.max(s$L,s$h.width*s$h.scaleX))}this.sortItem(s$d);var s$_=0;for(s$l=0,s$Z=s$d.length;s$l<s$Z;s$l++)(s$h=s$d[s$l]).y=s$_,s$_+=s$h.height*s$h.scaleY+this._space,"left"==this._align?s$h.x=0:"center"==this._align?s$h.x=.5*(s$L-s$h.width*s$h.scaleX):"right"==this._align&&(s$h.x=s$L-s$h.width*s$h.scaleX);this.changeSize()},s$h(0,s$l,"width",s$d.prototype._$get_width,function(s$d){this._width!=s$d&&(s$r.superSet(s$D,this,"width",s$d),this.callLater(this.changeItems))}),s$L.NONE="none",s$L.LEFT="left",s$L.CENTER="center",s$L.RIGHT="right",s$L}(s$D),s$md=function(s$d){function s$L(){s$L.__super.call(this)}return s$_(s$L,"laya.ui.RadioGroup",s$U),s$L.prototype.createItem=function(s$d,s$L){return new s$W(s$d,s$L)},s$L}(),s$ud=function(s$d){function s$L(){s$L.__super.call(this)}return s$_(s$L,"laya.ui.Tab",s$U),s$L.prototype.createItem=function(s$d,s$L){return new s$X(s$d,s$L)},s$L}(),s$xd=function(s$L){function s$l(s$d){this._vScrollBar=null,this._hScrollBar=null,void 0===s$d&&(s$d=""),s$l.__super.call(this,s$d)}s$_(s$l,"laya.ui.TextArea",s$L);var s$d=s$l.prototype;return s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},s$d.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},s$d.onVBarChanged=function(s$d){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},s$d.onHBarChanged=function(s$d){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},s$d.changeScroll=function(){var s$d=this._vScrollBar&&0<this._tf.maxScrollY,s$L=this._hScrollBar&&0<this._tf.maxScrollX,s$l=s$d?this._width-this._vScrollBar.width:this._width,s$Z=s$L?this._height-this._hScrollBar.height:this._height,s$h=this._tf.padding||s$Q.labelPadding;this._tf.width=s$l,this._tf.height=s$Z,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-s$h[2],this._vScrollBar.y=s$h[1],this._vScrollBar.height=this._height-(s$L?this._hScrollBar.height:0)-s$h[1]-s$h[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=s$Z/Math.max(this._tf.textHeight,s$Z),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=s$d),this._hScrollBar&&(this._hScrollBar.x=s$h[0],this._hScrollBar.y=this._height-this._hScrollBar.height-s$h[3],this._hScrollBar.width=this._width-(s$d?this._vScrollBar.width:0)-s$h[0]-s$h[2],this._hScrollBar.scrollSize=Math.max(.033*s$l,1),this._hScrollBar.thumbPercent=s$l/Math.max(this._tf.textWidth,s$l),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=s$L)},s$d.scrollTo=function(s$d){this.commitMeasure(),this._tf.scrollY=s$d},s$h(0,s$d,"scrollY",function(){return this._tf.scrollY}),s$h(0,s$d,"width",s$L.prototype._$get_width,function(s$d){s$r.superSet(s$ld,this,"width",s$d),this.callLater(this.changeScroll)}),s$h(0,s$d,"hScrollBar",function(){return this._hScrollBar}),s$h(0,s$d,"height",s$L.prototype._$get_height,function(s$d){s$r.superSet(s$ld,this,"height",s$d),this.callLater(this.changeScroll)}),s$h(0,s$d,"maxScrollX",function(){return this._tf.maxScrollX}),s$h(0,s$d,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(s$d){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new s$Ld),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=s$d}),s$h(0,s$d,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(s$d){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new s$v),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=s$d}),s$h(0,s$d,"vScrollBar",function(){return this._vScrollBar}),s$h(0,s$d,"maxScrollY",function(){return this._tf.maxScrollY}),s$h(0,s$d,"scrollX",function(){return this._tf.scrollX}),s$l}(s$ld);!function(s$d){function s$L(){this._uiView=null,this.isCloseOther=!1,s$L.__super.call(this)}s$_(s$L,"laya.ui.AsynDialog",s$hd);var s$l=s$L.prototype;s$l.createView=function(s$d){this._uiView=s$d},s$l._open=function(s$d,s$L,s$l){this.isModal=s$d,this.isCloseOther=s$L,s$hd.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},s$l.onCreated=function(){this.createUI(),this.onOpen()},s$l.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},s$l.onOpen=function(){s$hd.manager.open(this,this.isCloseOther),s$hd.manager.lock(!1)},s$l.close=function(s$d,s$L){void 0===s$L&&(s$L=!0),s$hd.manager.close(this),this.onClose()},s$l.onClose=function(){},s$l.destroy=function(s$d){void 0===s$d&&(s$d=!0),laya.ui.View.prototype.destroy.call(this,s$d),this._uiView=null,this.onDestroy()},s$l.onDestroy=function(){}}();s$r.__init([s$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}}),function(s$q,s$d,s$A){s$A.un,s$A.uns;var s$b=s$A.static,s$Y=s$A.class,s$c=s$A.getset,s$Z=s$A.__newvec,s$s=laya.maths.Arith,s$N=laya.webgl.atlas.AtlasResourceManager,s$l=laya.webgl.shader.BaseShader,s$I=laya.utils.Browser,s$m=laya.webgl.utils.Buffer,s$y=laya.utils.Byte,s$h=laya.utils.ClassUtils,s$u=s$A.Config,s$_=(laya.events.Event,laya.events.EventDispatcher),s$Q=laya.utils.Handler,s$k=laya.net.Loader,s$L=laya.net.LoaderManager,s$x=(laya.maths.MathUtil,laya.display.Node),s$r=laya.renders.Render,s$t=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),s$a=laya.resource.Resource,s$e=laya.utils.RunDriver,s$w=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),s$$=laya.display.Sprite,s$O=laya.utils.Stat,s$n=laya.utils.StringKey,s$g=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),s$V=laya.utils.Utils,s$F=laya.webgl.WebGL,s$E=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;s$A.interface("laya.d3.core.IClone"),s$A.interface("laya.d3.graphics.IVertex"),s$A.interface("laya.d3.core.render.IUpdate"),s$A.interface("laya.d3.core.scene.ITreeNode"),s$A.interface("laya.d3.core.render.IRenderable");(function(){function s$X(){}s$Y(s$X,"laya.d3.animation.AnimationClipParser01"),s$X.READ_DATA=function(){s$X._DATA.offset=s$X._reader.getUint32(),s$X._DATA.size=s$X._reader.getUint32()},s$X.READ_BLOCK=function(){for(var s$d=s$X._BLOCK.count=s$X._reader.getUint16(),s$L=s$X._BLOCK.blockStarts=[],s$l=s$X._BLOCK.blockLengths=[],s$Z=0;s$Z<s$d;s$Z++)s$L.push(s$X._reader.getUint32()),s$l.push(s$X._reader.getUint32())},s$X.READ_STRINGS=function(){var s$d=s$X._reader.getUint32(),s$L=s$X._reader.getUint16(),s$l=s$X._reader.pos;s$X._reader.pos=s$d+s$X._DATA.offset;for(var s$Z=0;s$Z<s$L;s$Z++)s$X._strings[s$Z]=s$X._reader.readUTFString();s$X._reader.pos=s$l},s$X.parse=function(s$d,s$L){s$X._animationClip=s$d;(s$X._reader=s$L).__getBuffer();s$X.READ_DATA(),s$X.READ_BLOCK(),s$X.READ_STRINGS();for(var s$l=0,s$Z=s$X._BLOCK.count;s$l<s$Z;s$l++){var s$h=s$L.getUint16(),s$_=s$X._strings[s$h],s$N=s$X["READ_"+s$_];if(null==s$N)throw new Error("model file err,no this function:"+s$h+" "+s$_);s$N.call()}},s$X.READ_ANIMATIONS=function(){var s$d,s$L=0,s$l=0,s$Z=s$X._reader,s$h=s$Z.__getBuffer(),s$_=[],s$N=s$Z.getUint8();for(s$_.length=s$N,s$L=0;s$L<s$N;s$L++)s$_[s$L]=s$Z.getUint16();var s$m=[],s$u=s$Z.getUint16();for(s$m.length=s$u,s$L=0;s$L<s$u;s$L++)s$m[s$L]=s$Z.getFloat32();var s$x=s$X._animationClip;s$x.name=s$X._strings[s$Z.getUint16()];var s$t=s$x._duration=s$Z.getFloat32();s$x.islooping=!!s$Z.getByte(),s$x._frameRate=s$Z.getInt16();var s$b=s$Z.getInt16(),s$q=s$x._nodes=new Array;s$q.length=s$b,(s$x._publicClipDatas=[]).length=s$b;var s$Y=s$x._nodesMap={},s$c=0,s$r=0;for(s$L=0;s$L<s$b;s$L++){s$d=s$q[s$L]=new s$P;var s$a=s$Z.getUint16(),s$k=s$d.path=[];for(s$k.length=s$a,s$l=0;s$l<s$a;s$l++)s$k[s$l]=s$X._strings[s$Z.getUint16()];var s$e=s$k.join("/"),s$w=s$Y[s$e];s$w||(s$Y[s$e]=s$w=[]),s$w.push(s$d);var s$s=s$Z.getInt16();-1!==s$s&&(s$d.componentType=s$X._strings[s$s]);var s$A=s$B._propertyIndexDic[s$X._strings[s$Z.getUint16()]];if(null==s$A)throw new Error("AnimationClipParser01:unknown property name.");var s$y=s$A<4,s$$=!s$y||s$y&&""===s$k[0];(s$d._cacheProperty=s$$)?s$c++:s$r++,s$d.propertyNameID=s$A;var s$O=s$_[s$Z.getUint8()];s$d.keyFrameWidth=s$O/4;var s$n=s$d.keyFrames=[],s$V=s$n.length=s$Z.getUint16(),s$Q=null,s$g=NaN;for(s$l=0;s$l<s$V;s$l++){var s$F=s$n[s$l]=new s$C;s$g=s$F.startTime=s$m[s$Z.getUint16()];var s$E=s$Z.pos;s$F.inTangent=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$E=s$Z.pos,s$F.outTangent=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$E=s$Z.pos,s$F.data=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$Q&&(s$Q.next=s$F,s$Q.duration=s$g-s$Q.startTime),s$Q=s$F}s$F.next=null,s$F.duration=s$t-s$g}var s$I=s$x._nodeToCachePropertyMap=new Int32Array(s$b),s$p=s$x._cachePropertyMap=new Int32Array(s$c),s$H=s$x._unCachePropertyMap=new Int32Array(s$r);for(s$c=s$r=0,s$L=0;s$L<s$b;s$L++)(s$d=s$q[s$L])._cacheProperty?(s$I[s$L]=s$c,s$p[s$c++]=s$L):s$H[s$r++]=s$L},s$X._animationClip=null,s$X._reader=null,s$X._strings=[],s$b(s$X,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function s$i(){}s$Y(s$i,"laya.d3.animation.AnimationClipParser02"),s$i.READ_DATA=function(){s$i._DATA.offset=s$i._reader.getUint32(),s$i._DATA.size=s$i._reader.getUint32()},s$i.READ_BLOCK=function(){for(var s$d=s$i._BLOCK.count=s$i._reader.getUint16(),s$L=s$i._BLOCK.blockStarts=[],s$l=s$i._BLOCK.blockLengths=[],s$Z=0;s$Z<s$d;s$Z++)s$L.push(s$i._reader.getUint32()),s$l.push(s$i._reader.getUint32())},s$i.READ_STRINGS=function(){var s$d=s$i._reader.getUint32(),s$L=s$i._reader.getUint16(),s$l=s$i._reader.pos;s$i._reader.pos=s$d+s$i._DATA.offset;for(var s$Z=0;s$Z<s$L;s$Z++)s$i._strings[s$Z]=s$i._reader.readUTFString();s$i._reader.pos=s$l},s$i.parse=function(s$d,s$L){s$i._animationClip=s$d;(s$i._reader=s$L).__getBuffer();s$i.READ_DATA(),s$i.READ_BLOCK(),s$i.READ_STRINGS();for(var s$l=0,s$Z=s$i._BLOCK.count;s$l<s$Z;s$l++){var s$h=s$L.getUint16(),s$_=s$i._strings[s$h],s$N=s$i["READ_"+s$_];if(null==s$N)throw new Error("model file err,no this function:"+s$h+" "+s$_);s$N.call()}},s$i.READ_ANIMATIONS=function(){var s$d,s$L=0,s$l=0,s$Z=s$i._reader,s$h=s$Z.__getBuffer(),s$_=[],s$N=s$Z.getUint8();for(s$_.length=s$N,s$L=0;s$L<s$N;s$L++)s$_[s$L]=s$Z.getUint16();var s$m=[],s$u=s$Z.getUint16();for(s$m.length=s$u,s$L=0;s$L<s$u;s$L++)s$m[s$L]=s$Z.getFloat32();var s$x=s$i._animationClip;s$x.name=s$i._strings[s$Z.getUint16()];var s$t=s$x._duration=s$Z.getFloat32();s$x.islooping=!!s$Z.getByte(),s$x._frameRate=s$Z.getInt16();var s$b=s$Z.getInt16(),s$q=s$x._nodes=new Array;s$q.length=s$b,(s$x._publicClipDatas=[]).length=s$b;var s$Y=s$x._nodesMap={},s$c=0,s$r=0;for(s$L=0;s$L<s$b;s$L++){s$d=s$q[s$L]=new s$P;var s$a=s$Z.getUint16(),s$k=s$d.path=[];for(s$k.length=s$a,s$l=0;s$l<s$a;s$l++)s$k[s$l]=s$i._strings[s$Z.getUint16()];var s$e=s$k.join("/"),s$w=s$Y[s$e];s$w||(s$Y[s$e]=s$w=[]),s$w.push(s$d);var s$s=s$Z.getInt16();-1!==s$s&&(s$d.componentType=s$i._strings[s$s]);var s$A=s$B._propertyIndexDic[s$i._strings[s$Z.getUint16()]];if(null==s$A)throw new Error("AnimationClipParser02:unknown property name.");var s$y=s$A<4,s$$=!s$y||s$y&&""===s$k[0];(s$d._cacheProperty=s$$)?s$c++:s$r++,s$d.propertyNameID=s$A;var s$O=s$_[s$Z.getUint8()];s$d.keyFrameWidth=s$O/4;var s$n=s$d.keyFrames=[],s$V=s$n.length=s$Z.getUint16(),s$Q=null,s$g=NaN;for(s$l=0;s$l<s$V;s$l++){var s$F=s$n[s$l]=new s$C;s$g=s$F.startTime=s$m[s$Z.getUint16()];var s$E=s$Z.pos;s$F.inTangent=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$E=s$Z.pos,s$F.outTangent=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$E=s$Z.pos,s$F.data=new Float32Array(s$h.slice(s$E,s$E+s$O)),s$Z.pos+=s$O,s$Q&&(s$Q.next=s$F,s$Q.duration=s$g-s$Q.startTime),s$Q=s$F}s$F.next=null,s$F.duration=s$t-s$g}var s$I=s$Z.getUint16();for(s$L=0;s$L<s$I;s$L++){var s$p,s$H=new s$S;s$H.time=s$Z.getFloat32(),s$H.eventName=s$i._strings[s$Z.getUint16()];var s$X=s$Z.getUint16();for(0<s$X&&(s$H.params=s$p=[]),s$l=0;s$l<s$X;s$l++){switch(s$Z.getByte()){case 0:s$p.push(!!s$Z.getByte());break;case 1:s$p.push(s$Z.getInt32());break;case 2:s$p.push(s$Z.getFloat32());break;case 3:s$p.push(s$i._strings[s$Z.getUint16()]);break;default:throw new Error("unknown type.")}}s$x.addEvent(s$H)}var s$j=s$x._nodeToCachePropertyMap=new Int32Array(s$b),s$R=s$x._cachePropertyMap=new Int32Array(s$c),s$o=s$x._unCachePropertyMap=new Int32Array(s$r);for(s$c=s$r=0,s$L=0;s$L<s$b;s$L++)(s$d=s$q[s$L])._cacheProperty?(s$j[s$L]=s$c,s$R[s$c++]=s$L):s$o[s$r++]=s$L},s$i._animationClip=null,s$i._reader=null,s$i._strings=[],s$b(s$i,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var s$S=function(){function s$d(){this.time=NaN,this.eventName=null,this.params=null}return s$Y(s$d,"laya.d3.animation.AnimationEvent"),s$d}(),s$B=function(){function s$Z(){this._childs=[],this.transform=new s$eL(this)}s$Y(s$Z,"laya.d3.animation.AnimationNode");var s$d=s$Z.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.addChild=function(s$d){s$d._parent=this,s$d.transform.setParent(this.transform),this._childs.push(s$d)},s$d.removeChild=function(s$d){var s$L=this._childs.indexOf(s$d);-1!==s$L&&this._childs.splice(s$L,1)},s$d.getChildByName=function(s$d){for(var s$L=0,s$l=this._childs.length;s$L<s$l;s$L++){var s$Z=this._childs[s$L];if(s$Z.name===s$d)return s$Z}return null},s$d.getChildByIndex=function(s$d){return this._childs[s$d]},s$d.getChildCount=function(){return this._childs.length},s$d.cloneTo=function(s$d){var s$L=s$d;s$L.name=this.name;for(var s$l=0,s$Z=this._childs.length;s$l<s$Z;s$l++){var s$h=this._childs[s$l],s$_=s$h.clone();s$L.addChild(s$_);var s$N=s$h.transform,s$m=s$_.transform;s$m.setLocalPosition(s$N.getLocalPosition()),s$m.setLocalRotation(s$N.getLocalRotation()),s$m.setLocalScale(s$N.getLocalScale()),s$m._localRotationEuler=s$N._localRotationEuler,s$m._setWorldMatrixIgnoreUpdate(s$N.getWorldMatrix())}},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$Z.__init__=function(){s$Z.registerAnimationNodeProperty("localPosition",s$Z._getLocalPosition,s$Z._setLocalPosition),s$Z.registerAnimationNodeProperty("localRotation",s$Z._getLocalRotation,s$Z._setLocalRotation),s$Z.registerAnimationNodeProperty("localScale",s$Z._getLocalScale,s$Z._setLocalScale),s$Z.registerAnimationNodeProperty("localRotationEuler",s$Z._getLocalRotationEuler,s$Z._setLocalRotationEuler),s$Z.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",s$Z._getParticleRenderSharedMaterialTintColor,s$Z._setParticleRenderSharedMaterialTintColor),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",s$Z._getMeshRenderSharedMaterialTilingOffset,s$Z._setMeshRenderSharedMaterialTilingOffset),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",s$Z._getMeshRenderSharedMaterialAlbedo,s$Z._setMeshRenderSharedMaterialAlbedo),s$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",s$Z._getSkinnedMeshRenderSharedMaterialTilingOffset,s$Z._setSkinnedMeshRenderSharedMaterialTilingOffset),s$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",s$Z._getSkinnedMeshRenderSharedMaterialAlbedo,s$Z._setSkinnedMeshRenderSharedMaterialAlbedo),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",s$Z._getMeshRenderSharedMaterialAlbedo,s$Z._setMeshRenderSharedMaterialAlbedo),s$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",s$Z._getSkinnedMeshRenderSharedMaterialAlbedo,s$Z._setSkinnedMeshRenderSharedMaterialAlbedo),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",s$Z._getMeshRenderSharedMaterialIntensity,s$Z._setMeshRenderSharedMaterialIntensity),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",s$Z._getMeshRenderSharedMaterialAlpha,s$Z._setMeshRenderSharedMaterialAlpha),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",s$Z._getMeshRenderSharedMaterialAlphaColor,s$Z._setMeshRenderSharedMaterialAlphaColor),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",s$Z._getMeshRenderSharedMaterialBaseColor,s$Z._setMeshRenderSharedMaterialBaseColor),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",s$Z._getMeshRenderSharedMaterialDissolve,s$Z._setMeshRenderSharedMaterialDissolve),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",s$Z._getMeshRenderSharedMaterialDissolveSpeed,s$Z._setMeshRenderSharedMaterialDissolveSpeed),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",s$Z._getMeshRenderSharedMaterialMMultiplier,s$Z._setMeshRenderSharedMaterialMMultiplier),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",s$Z._getMeshRenderSharedMaterialBaseScrollSpeedX,s$Z._setMeshRenderSharedMaterialBaseScrollSpeedX),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",s$Z._getMeshRenderSharedMaterialBaseScrollSpeedY,s$Z._setMeshRenderSharedMaterialBaseScrollSpeedY),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",s$Z._getMeshRenderSharedMaterialSecondScrollSpeedX,s$Z._setMeshRenderSharedMaterialSecondScrollSpeedX),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",s$Z._getMeshRenderSharedMaterialSecondScrollSpeedY,s$Z._setMeshRenderSharedMaterialSecondScrollSpeedY),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",s$Z._getMeshRenderSharedMaterialDetailTilingOffset,s$Z._setMeshRenderSharedMaterialDetailTilingOffset),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",s$Z._getMeshRenderSharedMaterialDissolveTilingOffset,s$Z._setMeshRenderSharedMaterialDissolveTilingOffset),s$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",s$Z._getMeshRenderSharedMaterialMaskTilingOffset,s$Z._setMeshRenderSharedMaterialMaskTilingOffset)},s$Z.registerAnimationNodeProperty=function(s$d,s$L,s$l){if(s$Z._propertyIndexDic[s$d])throw new Error("AnimationNode: this propertyName has registered.");s$Z._propertyIndexDic[s$d]=s$Z._propertyIDCounter,s$Z._propertyGetFuncs[s$Z._propertyIDCounter]=s$L,s$Z._propertySetFuncs[s$Z._propertyIDCounter]=s$l,s$Z._propertyIDCounter++},s$Z._getLocalPosition=function(s$d,s$L){return s$d?s$d.transform.getLocalPosition():s$L._transform.localPosition.elements},s$Z._setLocalPosition=function(s$d,s$L,s$l){if(s$d)s$d.transform.setLocalPosition(s$l);else{var s$Z=s$L._transform,s$h=s$Z.localPosition;s$h.elements=s$l,s$Z.localPosition=s$h}},s$Z._getLocalRotation=function(s$d,s$L){return s$d?s$d.transform.getLocalRotation():s$L._transform.localRotation.elements},s$Z._setLocalRotation=function(s$d,s$L,s$l){if(s$d)s$d.transform.setLocalRotation(s$l);else{var s$Z=s$L._transform,s$h=s$Z.localRotation;s$h.elements=s$l,s$Z.localRotation=s$h}},s$Z._getLocalScale=function(s$d,s$L){return s$d?s$d.transform.getLocalScale():s$L._transform.localScale.elements},s$Z._setLocalScale=function(s$d,s$L,s$l){if(s$d)s$d.transform.setLocalScale(s$l);else{var s$Z=s$L._transform,s$h=s$Z.localScale;s$h.elements=s$l,s$Z.localScale=s$h}},s$Z._getLocalRotationEuler=function(s$d,s$L){return s$d?s$d.transform.getLocalRotationEuler():s$L._transform.localRotationEuler.elements},s$Z._setLocalRotationEuler=function(s$d,s$L,s$l){if(s$d)s$d.transform.setLocalRotationEuler(s$l);else{var s$Z=s$L._transform,s$h=s$Z.localRotationEuler;s$h.elements=s$l,s$Z.localRotationEuler=s$h}},s$Z._getMeshRenderSharedMaterialTilingOffset=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return s$L.meshRender.sharedMaterial.tilingOffset.elements},s$Z._setMeshRenderSharedMaterialTilingOffset=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).tilingOffset).elements=s$l,s$Z.tilingOffset=s$h)}else(s$h=(s$Z=s$L.meshRender.material).tilingOffset).elements=s$l,s$Z.tilingOffset=s$h},s$Z._getMeshRenderSharedMaterialAlbedo=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.albedoColor.elements:null}return s$L.meshRender.sharedMaterial.albedoColor.elements},s$Z._setMeshRenderSharedMaterialAlbedo=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).albedoColor).elements=s$l,s$Z.albedoColor=s$h)}else(s$h=(s$Z=s$L.meshRender.material).albedoColor).elements=s$l,s$Z.albedoColor=s$h},s$Z._getSkinnedMeshRenderSharedMaterialTilingOffset=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return s$L.skinnedMeshRender.sharedMaterial.tilingOffset.elements},s$Z._setSkinnedMeshRenderSharedMaterialTilingOffset=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.skinnedMeshRender.material).tilingOffset).elements=s$l,s$Z.tilingOffset=s$h)}else(s$h=(s$Z=s$L.skinnedMeshRender.material).tilingOffset).elements=s$l,s$Z.tilingOffset=s$h},s$Z._getSkinnedMeshRenderSharedMaterialAlbedo=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return s$L.skinnedMeshRender.sharedMaterial.albedoColor.elements},s$Z._setSkinnedMeshRenderSharedMaterialAlbedo=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.skinnedMeshRender.material).albedoColor).elements=s$l,s$Z.albedoColor=s$h)}else(s$h=(s$Z=s$L.skinnedMeshRender.material).albedoColor).elements=s$l,s$Z.albedoColor=s$h},s$Z._getParticleRenderSharedMaterialTintColor=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.particleRender.sharedMaterial.tintColor.elements:null}return s$L.particleRender.sharedMaterial.tintColor.elements},s$Z._setParticleRenderSharedMaterialTintColor=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.particleRender.material).tintColor).elements=s$l,s$Z.tintColor=s$h)}else(s$h=(s$Z=s$L.particleRender.material).tintColor).elements=s$l,s$Z.tintColor=s$h},s$Z._getMeshRenderSharedMaterialAlphaColor=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.alphaColor.elements:null}return s$L.meshRender.sharedMaterial.alphaColor.elements},s$Z._setMeshRenderSharedMaterialAlphaColor=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).alphaColor).elements=s$l,s$Z.alphaColor=s$h)}else(s$h=(s$Z=s$L.meshRender.material).alphaColor).elements=s$l,s$Z.alphaColor=s$h},s$Z._getMeshRenderSharedMaterialBaseColor=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.baseColor.elements:null}return s$L.meshRender.sharedMaterial.baseColor.elements},s$Z._setMeshRenderSharedMaterialBaseColor=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).baseColor).elements=s$l,s$Z.baseColor=s$h)}else(s$h=(s$Z=s$L.meshRender.material).baseColor).elements=s$l,s$Z.baseColor=s$h},s$Z._getMeshRenderSharedMaterialDissolve=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.dissolve:0}return s$L.meshRender.sharedMaterial.dissolve},s$Z._setMeshRenderSharedMaterialDissolve=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.dissolve=s$l[0])}else s$L.meshRender.material.dissolve=s$l[0]},s$Z._getMeshRenderSharedMaterialDissolveSpeed=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.dissolveSpeed:0}return s$L.meshRender.sharedMaterial.dissolveSpeed},s$Z._setMeshRenderSharedMaterialDissolveSpeed=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.dissolveSpeed=s$l[0])}else s$L.meshRender.material.dissolveSpeed=s$l[0]},s$Z._getMeshRenderSharedMaterialMMultiplier=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.mMultiplier:0}return s$L.meshRender.sharedMaterial.mMultiplier},s$Z._setMeshRenderSharedMaterialMMultiplier=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.mMultiplier=s$l[0])}else s$L.meshRender.material.mMultiplier=s$l[0]},s$Z._getMeshRenderSharedMaterialBaseScrollSpeedX=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return s$L.meshRender.sharedMaterial.baseScrollSpeedX},s$Z._setMeshRenderSharedMaterialBaseScrollSpeedX=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.baseScrollSpeedX=s$l[0])}else s$L.meshRender.material.baseScrollSpeedX=s$l[0]},s$Z._getMeshRenderSharedMaterialBaseScrollSpeedY=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return s$L.meshRender.sharedMaterial.baseScrollSpeedY},s$Z._setMeshRenderSharedMaterialBaseScrollSpeedY=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.baseScrollSpeedY=s$l[0])}else s$L.meshRender.material.baseScrollSpeedY=s$l[0]},s$Z._getMeshRenderSharedMaterialSecondScrollSpeedX=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return s$L.meshRender.sharedMaterial.secondScrollSpeedX},s$Z._setMeshRenderSharedMaterialSecondScrollSpeedX=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.secondScrollSpeedX=s$l[0])}else s$L.meshRender.material.secondScrollSpeedX=s$l[0]},s$Z._getMeshRenderSharedMaterialSecondScrollSpeedY=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return s$L.meshRender.sharedMaterial.secondScrollSpeedY},s$Z._setMeshRenderSharedMaterialSecondScrollSpeedY=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.secondScrollSpeedY=s$l[0])}else s$L.meshRender.material.secondScrollSpeedY=s$l[0]},s$Z._getMeshRenderSharedMaterialAlpha=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.alpha:0}return s$L.meshRender.sharedMaterial.alpha},s$Z._setMeshRenderSharedMaterialAlpha=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.alpha=s$l[0])}else s$L.meshRender.material.alpha=s$l[0]},s$Z._getMeshRenderSharedMaterialIntensity=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.intensity:0}return s$L.meshRender.sharedMaterial.intensity},s$Z._setMeshRenderSharedMaterialIntensity=function(s$d,s$L,s$l){if(s$d){var s$Z=s$d.transform._entity;s$Z&&(s$Z.owner.meshRender.material.intensity=s$l[0])}else s$L.meshRender.material.intensity=s$l[0]},s$Z._getMeshRenderSharedMaterialDetailTilingOffset=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return s$L.meshRender.sharedMaterial.detailTilingOffset.elements},s$Z._setMeshRenderSharedMaterialDetailTilingOffset=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).detailTilingOffset).elements=s$l,s$Z.detailTilingOffset=s$h)}else(s$h=(s$Z=s$L.meshRender.material).detailTilingOffset).elements=s$l,s$Z.detailTilingOffset=s$h},s$Z._getMeshRenderSharedMaterialDissolveTilingOffset=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return s$L.meshRender.sharedMaterial.dissolveTilingOffset.elements},s$Z._setMeshRenderSharedMaterialDissolveTilingOffset=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).dissolveTilingOffset).elements=s$l,s$Z.dissolveTilingOffset=s$h)}else(s$h=(s$Z=s$L.meshRender.material).dissolveTilingOffset).elements=s$l,s$Z.dissolveTilingOffset=s$h},s$Z._getMeshRenderSharedMaterialMaskTilingOffset=function(s$d,s$L){if(s$d){var s$l=s$d.transform._entity;return s$l?s$l.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return s$L.meshRender.sharedMaterial.maskTilingOffset.elements},s$Z._setMeshRenderSharedMaterialMaskTilingOffset=function(s$d,s$L,s$l){var s$Z,s$h;if(s$d){var s$_=s$d.transform._entity;s$_&&((s$h=(s$Z=s$_.owner.meshRender.material).maskTilingOffset).elements=s$l,s$Z.maskTilingOffset=s$h)}else(s$h=(s$Z=s$L.meshRender.material).maskTilingOffset).elements=s$l,s$Z.maskTilingOffset=s$h},s$Z._propertyIDCounter=0,s$Z._propertyIndexDic={},s$Z._propertySetFuncs=[],s$Z._propertyGetFuncs=[],s$Z}(),s$C=function(){function s$d(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return s$Y(s$d,"laya.d3.animation.Keyframe"),s$d}(),s$P=function(){function s$d(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return s$Y(s$d,"laya.d3.animation.KeyframeNode"),s$d}(),s$p=(function(){function s$d(){this._tempVector30=new s$NL,this._tempVector31=new s$NL,this._tempVector32=new s$NL,this._a=new s$NL,this._b=new s$NL,this._c=new s$NL,this._d=new s$NL}s$Y(s$d,"laya.d3.core.glitter.SplineCurvePositionVelocity");var s$L=s$d.prototype;s$L.Init=function(s$d,s$L,s$l,s$Z){s$d.cloneTo(this._d),s$L.cloneTo(this._c),s$NL.scale(s$d,2,this._a),s$NL.scale(s$l,2,this._tempVector30),s$NL.subtract(this._a,this._tempVector30,this._a),s$NL.add(this._a,s$L,this._a),s$NL.add(this._a,s$Z,this._a),s$NL.scale(s$l,3,this._b),s$NL.scale(s$d,3,this._tempVector30),s$NL.subtract(this._b,this._tempVector30,this._b),s$NL.subtract(this._b,s$Z,this._b),s$NL.scale(s$L,2,this._tempVector30),s$NL.subtract(this._b,this._tempVector30,this._b)},s$L.Slerp=function(s$d,s$L){s$NL.scale(this._a,s$d*s$d*s$d,this._tempVector30),s$NL.scale(this._b,s$d*s$d,this._tempVector31),s$NL.scale(this._c,s$d,this._tempVector32),s$NL.add(this._tempVector30,this._tempVector31,s$L),s$NL.add(s$L,this._tempVector32,s$L),s$NL.add(s$L,this._d,s$L)}}(),function(){function s$R(s$d,s$L,s$l,s$Z){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=s$d,this._h=s$L,this._minHeight=s$l,this._maxHeight=s$Z}s$Y(s$R,"laya.d3.core.HeightMap");var s$d=s$R.prototype;s$d._inBounds=function(s$d,s$L){return 0<=s$d&&s$d<this._h&&0<=s$L&&s$L<this._w},s$d.getHeight=function(s$d,s$L){return this._inBounds(s$d,s$L)?this._datas[s$d][s$L]:NaN},s$c(0,s$d,"width",function(){return this._w}),s$c(0,s$d,"height",function(){return this._h}),s$c(0,s$d,"maxHeight",function(){return this._maxHeight}),s$c(0,s$d,"minHeight",function(){return this._minHeight}),s$R.creatFromMesh=function(s$d,s$L,s$l,s$Z){for(var s$h=[],s$_=[],s$N=s$d.getSubMeshCount(),s$m=0;s$m<s$N;s$m++){for(var s$u=s$d.getSubMesh(s$m),s$x=s$u._getVertexBuffer(),s$t=s$x.getData(),s$b=[],s$q=0;s$q<s$t.length;s$q+=s$x.vertexDeclaration.vertexStride/4){var s$Y=new s$NL(s$t[s$q+0],s$t[s$q+1],s$t[s$q+2]);s$b.push(s$Y)}s$h.push(s$b);var s$c=s$u._getIndexBuffer();s$_.push(s$c.getData())}var s$r=s$d.boundingBox,s$a=s$r.min.x,s$k=s$r.min.z,s$e=s$r.max.x,s$w=s$r.max.z,s$s=s$r.min.y,s$A=s$r.max.y,s$y=s$e-s$a,s$$=s$w-s$k,s$O=s$Z.elements[0]=s$y/(s$L-1),s$n=s$Z.elements[1]=s$$/(s$l-1),s$V=new s$R(s$L,s$l,s$s,s$A),s$Q=s$R._tempRay,s$g=s$Q.direction.elements;s$g[0]=0,s$g[1]=-1,s$g[2]=0;var s$F=s$A+.1;s$Q.origin.elements[1]=s$F;for(var s$E=0;s$E<s$l;s$E++){var s$I=s$k+s$E*s$n;s$V._datas[s$E]=[];for(var s$p=0;s$p<s$L;s$p++){var s$H=s$a+s$p*s$O,s$X=s$Q.origin.elements;s$X[0]=s$H,s$X[2]=s$I;var s$j=s$R._getPosition(s$Q,s$h,s$_);s$V._datas[s$E][s$p]=s$j===Number.MAX_VALUE?NaN:s$F-s$j}}return s$V},s$R.createFromImage=function(s$d,s$L,s$l){for(var s$Z=s$d.width,s$h=s$d.height,s$_=new s$R(s$Z,s$h,s$L,s$l),s$N=(s$l-s$L)/254,s$m=s$d.getPixels(),s$u=0,s$x=0;s$x<s$h;s$x++)for(var s$t=s$_._datas[s$x]=[],s$b=0;s$b<s$Z;s$b++){var s$q=s$m[s$u++],s$Y=s$m[s$u++],s$c=s$m[s$u++],s$r=s$m[s$u++];s$t[s$b]=255==s$q&&255==s$Y&&255==s$c&&255==s$r?NaN:(s$q+s$Y+s$c)/3*s$N+s$L}return s$_},s$R._getPosition=function(s$d,s$L,s$l){for(var s$Z=Number.MAX_VALUE,s$h=0;s$h<s$L.length;s$h++)for(var s$_=s$L[s$h],s$N=s$l[s$h],s$m=0;s$m<s$N.length;s$m+=3){var s$u=s$_[s$N[s$m+0]],s$x=s$_[s$N[s$m+1]],s$t=s$_[s$N[s$m+2]],s$b=s$cL.rayIntersectsTriangle(s$d,s$u,s$x,s$t);!isNaN(s$b)&&s$b<s$Z&&(s$Z=s$b)}return s$Z},s$b(s$R,["_tempRay",function(){return this._tempRay=new s$hL(new s$NL,new s$NL)}])}(),function(){function s$h(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}s$Y(s$h,"laya.d3.core.Layer");var s$d=s$h.prototype;return s$d._binarySearchIndex=function(){for(var s$d=0,s$L=s$h._collsionTestList.length-1,s$l=0;s$d<=s$L;){s$l=Math.floor((s$d+s$L)/2);var s$Z=s$h._collsionTestList[s$l];if(s$Z==this._number)return s$l;s$Z>this._number?s$L=s$l-1:s$d=s$l+1}return s$d},s$d._addCollider=function(s$d){0===this._colliders.length&&s$h._collsionTestList.splice(this._binarySearchIndex(),0,this._number),s$d._isRigidbody?(this._colliders.unshift(s$d),this._nonRigidbodyOffset++):this._colliders.push(s$d)},s$d._removeCollider=function(s$d){var s$L=this._colliders.indexOf(s$d);s$L<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(s$L,1),0===this._colliders.length&&s$h._collsionTestList.splice(s$h._collsionTestList.indexOf(this._number),1)},s$c(0,s$d,"number",function(){return this._number}),s$c(0,s$d,"visible",function(){return this._visible},function(s$d){this._visible=s$d,s$h._visibleLayers=s$d?s$h._visibleLayers|this.mask:s$h._visibleLayers&~this.mask}),s$c(0,s$d,"mask",function(){return this._mask}),s$c(1,s$h,"visibleLayers",function(){return s$h._visibleLayers},function(s$d){s$h._visibleLayers=s$d;for(var s$L=0,s$l=s$h._layerList.length;s$L<s$l;s$L++){var s$Z=s$h._layerList[s$L];s$Z._visible=0!=(s$Z._mask&s$h._visibleLayers)}}),s$h.__init__=function(){s$h._layerList.length=31;for(var s$d=0;s$d<31;s$d++){var s$L=new s$h;s$h._layerList[s$d]=s$L,0===s$d?(s$L.name="Default Layer",s$L.visible=!0):(s$L.name="Layer-"+s$d,s$L.visible=!1),s$L._number=s$d,s$L._mask=Math.pow(2,s$d)}s$h.currentCreationLayer=s$h._layerList[0]},s$h.getLayerByNumber=function(s$d){if(s$d<0||30<s$d)throw new Error("无法返回指定Layer，该number超出范围！");return s$h._layerList[s$d]},s$h.getLayerByName=function(s$d){for(var s$L=0;s$L<31;s$L++)if(s$h._layerList[s$L].name===s$d)return s$h._layerList[s$L];throw new Error("无法返回指定Layer,该name不存在")},s$h.isVisible=function(s$d){return 0!=(s$d&s$h._currentCameraCullingMask&s$h._visibleLayers)},s$h._layerList=[],s$h._visibleLayers=2147483647,s$h._collsionTestList=[],s$h._currentCameraCullingMask=2147483647,s$h.maxCount=31,s$h.currentCreationLayer=null,s$h}()),s$H=(function(){function s$d(s$d,s$L,s$l){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=s$d,this._minCount=s$L,this._maxCount=s$l}s$Y(s$d,"laya.d3.core.particleShuriKen.module.Burst");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.cloneTo=function(s$d){var s$L=s$d;s$L._time=this._time,s$L._minCount=this._minCount,s$L._maxCount=this._maxCount},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"time",function(){return this._time}),s$c(0,s$L,"minCount",function(){return this._minCount}),s$c(0,s$L,"maxCount",function(){return this._maxCount})}(),function(){function s$d(s$d){this._color=null,this.enbale=!1,this._color=s$d}s$Y(s$d,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var s$L=s$d.prototype;s$L.cloneTo=function(s$d){var s$L=s$d;this._color.cloneTo(s$L._color),s$L.enbale=this.enbale},s$L.clone=function(){var s$d;switch(this._color.type){case 0:s$d=s$j.createByConstant(this._color.constant.clone());break;case 1:s$d=s$j.createByGradient(this._color.gradient.clone());break;case 2:s$d=s$j.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:s$d=s$j.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var s$L=new this.constructor(s$d);return s$L.enbale=this.enbale,s$L},s$c(0,s$L,"color",function(){return this._color})}(),function(){function s$d(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}s$Y(s$d,"laya.d3.core.particleShuriKen.module.Emission");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),s$L._destroy=function(){this._bursts=null,this._destroyed=!0},s$L.getBurstsCount=function(){return this._bursts.length},s$L.getBurstByIndex=function(s$d){return this._bursts[s$d]},s$L.addBurst=function(s$d){var s$L=this._bursts.length;if(0<s$L)for(var s$l=0;s$l<s$L;s$l++)this._bursts[s$l].time>s$d.time&&this._bursts.splice(s$l,0,s$d);this._bursts.push(s$d)},s$L.removeBurst=function(s$d){var s$L=this._bursts.indexOf(s$d);-1!==s$L&&this._bursts.splice(s$L,1)},s$L.removeBurstByIndex=function(s$d){this._bursts.splice(s$d,1)},s$L.clearBurst=function(){this._bursts.length=0},s$L.cloneTo=function(s$d){var s$L=s$d,s$l=s$L._bursts;s$l.length=this._bursts.length;for(var s$Z=0,s$h=this._bursts.length;s$Z<s$h;s$Z++){var s$_=s$l[s$Z];s$_?this._bursts[s$Z].cloneTo(s$_):s$l[s$Z]=this._bursts[s$Z].clone()}s$L._emissionRate=this._emissionRate,s$L.enbale=this.enbale},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"destroyed",function(){return this._destroyed}),s$c(0,s$L,"emissionRate",function(){return this._emissionRate},function(s$d){if(s$d<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=s$d})}(),function(){function s$Z(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}s$Y(s$Z,"laya.d3.core.particleShuriKen.module.FrameOverTime");var s$d=s$Z.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,s$L._constant=this._constant,this._overTime.cloneTo(s$L._overTime),s$L._constantMin=this._constantMin,s$L._constantMax=this._constantMax,this._overTimeMin.cloneTo(s$L._overTimeMin),this._overTimeMax.cloneTo(s$L._overTimeMax)},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"frameOverTimeData",function(){return this._overTime}),s$c(0,s$d,"constant",function(){return this._constant}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"frameOverTimeDataMin",function(){return this._overTimeMin}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"frameOverTimeDataMax",function(){return this._overTimeMax}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$Z.createByConstant=function(s$d){var s$L=new s$Z;return s$L._type=0,s$L._constant=s$d,s$L},s$Z.createByOverTime=function(s$d){var s$L=new s$Z;return s$L._type=1,s$L._overTime=s$d,s$L},s$Z.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$Z;return s$l._type=2,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$Z.createByRandomTwoOverTime=function(s$d,s$L){var s$l=new s$Z;return s$l._type=3,s$l._overTimeMin=s$d,s$l._overTimeMax=s$L,s$l},s$Z}()),s$X=function(){function s$x(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}s$Y(s$x,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var s$d=s$x.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,s$L._separateAxes=this._separateAxes,s$L._constant=this._constant,this._constantSeparate.cloneTo(s$L._constantSeparate),this._gradient.cloneTo(s$L._gradient),this._gradientX.cloneTo(s$L._gradientX),this._gradientY.cloneTo(s$L._gradientY),this._gradientZ.cloneTo(s$L._gradientZ),s$L._constantMin=this._constantMin,s$L._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(s$L._constantMinSeparate),this._constantMaxSeparate.cloneTo(s$L._constantMaxSeparate),this._gradientMin.cloneTo(s$L._gradientMin),this._gradientMax.cloneTo(s$L._gradientMax),this._gradientXMin.cloneTo(s$L._gradientXMin),this._gradientXMax.cloneTo(s$L._gradientXMax),this._gradientYMin.cloneTo(s$L._gradientYMin),this._gradientYMax.cloneTo(s$L._gradientYMax),this._gradientZMin.cloneTo(s$L._gradientZMin),this._gradientZMax.cloneTo(s$L._gradientZMax)},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"gradientZ",function(){return this._gradientZ}),s$c(0,s$d,"constant",function(){return this._constant}),s$c(0,s$d,"gradient",function(){return this._gradient}),s$c(0,s$d,"separateAxes",function(){return this._separateAxes}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"constantSeparate",function(){return this._constantSeparate}),s$c(0,s$d,"gradientX",function(){return this._gradientX}),s$c(0,s$d,"gradientY",function(){return this._gradientY}),s$c(0,s$d,"gradientW",function(){return this._gradientW}),s$c(0,s$d,"gradientMin",function(){return this._gradientMin}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"gradientMax",function(){return this._gradientMax}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$c(0,s$d,"gradientWMin",function(){return this._gradientWMin}),s$c(0,s$d,"constantMinSeparate",function(){return this._constantMinSeparate}),s$c(0,s$d,"constantMaxSeparate",function(){return this._constantMaxSeparate}),s$c(0,s$d,"gradientXMin",function(){return this._gradientXMin}),s$c(0,s$d,"gradientXMax",function(){return this._gradientXMax}),s$c(0,s$d,"gradientWMax",function(){return this._gradientWMax}),s$c(0,s$d,"gradientYMin",function(){return this._gradientYMin}),s$c(0,s$d,"gradientYMax",function(){return this._gradientYMax}),s$c(0,s$d,"gradientZMin",function(){return this._gradientZMin}),s$c(0,s$d,"gradientZMax",function(){return this._gradientZMax}),s$x.createByConstant=function(s$d){var s$L=new s$x;return s$L._type=0,s$L._separateAxes=!1,s$L._constant=s$d,s$L},s$x.createByConstantSeparate=function(s$d){var s$L=new s$x;return s$L._type=0,s$L._separateAxes=!0,s$L._constantSeparate=s$d,s$L},s$x.createByGradient=function(s$d){var s$L=new s$x;return s$L._type=1,s$L._separateAxes=!1,s$L._gradient=s$d,s$L},s$x.createByGradientSeparate=function(s$d,s$L,s$l,s$Z){var s$h=new s$x;return s$h._type=1,s$h._separateAxes=!0,s$h._gradientX=s$d,s$h._gradientY=s$L,s$h._gradientZ=s$l,s$h._gradientW=s$Z,s$h},s$x.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$x;return s$l._type=2,s$l._separateAxes=!1,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$x.createByRandomTwoConstantSeparate=function(s$d,s$L){var s$l=new s$x;return s$l._type=2,s$l._separateAxes=!0,s$l._constantMinSeparate=s$d,s$l._constantMaxSeparate=s$L,s$l},s$x.createByRandomTwoGradient=function(s$d,s$L){var s$l=new s$x;return s$l._type=3,s$l._separateAxes=!1,s$l._gradientMin=s$d,s$l._gradientMax=s$L,s$l},s$x.createByRandomTwoGradientSeparate=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){var s$u=new s$x;return s$u._type=3,s$u._separateAxes=!0,s$u._gradientXMin=s$d,s$u._gradientXMax=s$L,s$u._gradientYMin=s$l,s$u._gradientYMax=s$Z,s$u._gradientZMin=s$h,s$u._gradientZMax=s$_,s$u._gradientWMin=s$N,s$u._gradientWMax=s$m,s$u},s$x}(),s$j=function(){function s$Z(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}s$Y(s$Z,"laya.d3.core.particleShuriKen.module.GradientColor");var s$d=s$Z.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,this._constant.cloneTo(s$L._constant),this._constantMin.cloneTo(s$L._constantMin),this._constantMax.cloneTo(s$L._constantMax),this._gradient.cloneTo(s$L._gradient),this._gradientMin.cloneTo(s$L._gradientMin),this._gradientMax.cloneTo(s$L._gradientMax)},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"gradient",function(){return this._gradient}),s$c(0,s$d,"constant",function(){return this._constant}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"gradientMin",function(){return this._gradientMin}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"gradientMax",function(){return this._gradientMax}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$Z.createByConstant=function(s$d){var s$L=new s$Z;return s$L._type=0,s$L._constant=s$d,s$L},s$Z.createByGradient=function(s$d){var s$L=new s$Z;return s$L._type=1,s$L._gradient=s$d,s$L},s$Z.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$Z;return s$l._type=2,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$Z.createByRandomTwoGradient=function(s$d,s$L){var s$l=new s$Z;return s$l._type=3,s$l._gradientMin=s$d,s$l._gradientMax=s$L,s$l},s$Z}(),s$R=(function(){function s$d(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}s$Y(s$d,"laya.d3.core.particleShuriKen.module.GradientDataColor");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.addAlpha=function(s$d,s$L){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==s$d&&(s$d=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=s$d,this._alphaElements[this._alphaCurrentLength++]=s$L):DEBUG},s$L.addRGB=function(s$d,s$L){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==s$d&&(s$d=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=s$d,this._rgbElements[this._rgbCurrentLength++]=s$L.x,this._rgbElements[this._rgbCurrentLength++]=s$L.y,this._rgbElements[this._rgbCurrentLength++]=s$L.z):DEBUG},s$L.cloneTo=function(s$d){var s$L=s$d,s$l=0,s$Z=0;s$L._alphaCurrentLength=this._alphaCurrentLength;var s$h=s$L._alphaElements;for(s$h.length=this._alphaElements.length,s$l=0,s$Z=this._alphaElements.length;s$l<s$Z;s$l++)s$h[s$l]=this._alphaElements[s$l];s$L._rgbCurrentLength=this._rgbCurrentLength;var s$_=s$L._rgbElements;for(s$_.length=this._rgbElements.length,s$l=0,s$Z=this._rgbElements.length;s$l<s$Z;s$l++)s$_[s$l]=this._rgbElements[s$l]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),s$c(0,s$L,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function s$d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}s$Y(s$d,"laya.d3.core.particleShuriKen.module.GradientDataInt");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.add=function(s$d,s$L){this._currentLength<8?(6===this._currentLength&&1!==s$d&&(s$d=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=s$d,this._elements[this._currentLength++]=s$L):console.log("Warning:data count must lessEqual than 4")},s$L.cloneTo=function(s$d){var s$L=s$d;s$L._currentLength=this._currentLength;var s$l=s$L._elements;s$l.length=this._elements.length;for(var s$Z=0,s$h=this._elements.length;s$Z<s$h;s$Z++)s$l[s$Z]=this._elements[s$Z]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"gradientCount",function(){return this._currentLength/2})}(),function(){function s$d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}s$Y(s$d,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.add=function(s$d,s$L){this._currentLength<8?(6===this._currentLength&&1!==s$d&&(s$d=1,DEBUG),this._elements[this._currentLength++]=s$d,this._elements[this._currentLength++]=s$L):DEBUG},s$L.getKeyByIndex=function(s$d){return this._elements[2*s$d]},s$L.getValueByIndex=function(s$d){return this._elements[2*s$d+1]},s$L.getAverageValue=function(){for(var s$d=0,s$L=this._currentLength-2;s$d<s$L;s$d+=2){this._elements[s$d+1];this._elements[s$d+3],this._elements[s$d+2]-this._elements[s$d]}return 0},s$L.cloneTo=function(s$d){var s$L=s$d;s$L._currentLength=this._currentLength;var s$l=s$L._elements;s$l.length=this._elements.length;for(var s$Z=0,s$h=this._elements.length;s$Z<s$h;s$Z++)s$l[s$Z]=this._elements[s$Z]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"gradientCount",function(){return this._currentLength/2})}(),function(){function s$d(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}s$Y(s$d,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.add=function(s$d,s$L){this._currentLength<8?(6===this._currentLength&&1!==s$d&&(s$d=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=s$d,this._elements[this._currentLength++]=s$L.x,this._elements[this._currentLength++]=s$L.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},s$L.cloneTo=function(s$d){var s$L=s$d;s$L._currentLength=this._currentLength;var s$l=s$L._elements;s$l.length=this._elements.length;for(var s$Z=0,s$h=this._elements.length;s$Z<s$h;s$Z++)s$l[s$Z]=this._elements[s$Z]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"gradientCount",function(){return this._currentLength/3})}(),function(){function s$m(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}s$Y(s$m,"laya.d3.core.particleShuriKen.module.GradientSize");var s$d=s$m.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.getMaxSizeInGradient=function(){var s$d=0,s$L=0,s$l=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(s$d=0,s$L=this._gradientX.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientX.getValueByIndex(s$d));for(s$d=0,s$L=this._gradientY.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientY.getValueByIndex(s$d))}else for(s$d=0,s$L=this._gradient.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradient.getValueByIndex(s$d));break;case 1:s$l=this._separateAxes?(s$l=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),s$l=Math.max(s$l,this._constantMinSeparate.y),Math.max(s$l,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(s$d=0,s$L=this._gradientXMin.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientXMin.getValueByIndex(s$d));for(s$d=0,s$L=this._gradientXMax.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientXMax.getValueByIndex(s$d));for(s$d=0,s$L=this._gradientYMin.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientYMin.getValueByIndex(s$d));for(s$d=0,s$L=this._gradientZMax.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientZMax.getValueByIndex(s$d))}else{for(s$d=0,s$L=this._gradientMin.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientMin.getValueByIndex(s$d));for(s$d=0,s$L=this._gradientMax.gradientCount;s$d<s$L;s$d++)s$l=Math.max(s$l,this._gradientMax.getValueByIndex(s$d))}}return s$l},s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,s$L._separateAxes=this._separateAxes,this._gradient.cloneTo(s$L._gradient),this._gradientX.cloneTo(s$L._gradientX),this._gradientY.cloneTo(s$L._gradientY),this._gradientZ.cloneTo(s$L._gradientZ),s$L._constantMin=this._constantMin,s$L._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(s$L._constantMinSeparate),this._constantMaxSeparate.cloneTo(s$L._constantMaxSeparate),this._gradientMin.cloneTo(s$L._gradientMin),this._gradientMax.cloneTo(s$L._gradientMax),this._gradientXMin.cloneTo(s$L._gradientXMin),this._gradientXMax.cloneTo(s$L._gradientXMax),this._gradientYMin.cloneTo(s$L._gradientYMin),this._gradientYMax.cloneTo(s$L._gradientYMax),this._gradientZMin.cloneTo(s$L._gradientZMin),this._gradientZMax.cloneTo(s$L._gradientZMax)},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"gradientZ",function(){return this._gradientZ}),s$c(0,s$d,"gradient",function(){return this._gradient}),s$c(0,s$d,"separateAxes",function(){return this._separateAxes}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"gradientMin",function(){return this._gradientMin}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"gradientX",function(){return this._gradientX}),s$c(0,s$d,"gradientY",function(){return this._gradientY}),s$c(0,s$d,"gradientMax",function(){return this._gradientMax}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$c(0,s$d,"constantMinSeparate",function(){return this._constantMinSeparate}),s$c(0,s$d,"constantMaxSeparate",function(){return this._constantMaxSeparate}),s$c(0,s$d,"gradientXMin",function(){return this._gradientXMin}),s$c(0,s$d,"gradientXMax",function(){return this._gradientXMax}),s$c(0,s$d,"gradientYMin",function(){return this._gradientYMin}),s$c(0,s$d,"gradientYMax",function(){return this._gradientYMax}),s$c(0,s$d,"gradientZMin",function(){return this._gradientZMin}),s$c(0,s$d,"gradientZMax",function(){return this._gradientZMax}),s$m.createByGradient=function(s$d){var s$L=new s$m;return s$L._type=0,s$L._separateAxes=!1,s$L._gradient=s$d,s$L},s$m.createByGradientSeparate=function(s$d,s$L,s$l){var s$Z=new s$m;return s$Z._type=0,s$Z._separateAxes=!0,s$Z._gradientX=s$d,s$Z._gradientY=s$L,s$Z._gradientZ=s$l,s$Z},s$m.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$m;return s$l._type=1,s$l._separateAxes=!1,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$m.createByRandomTwoConstantSeparate=function(s$d,s$L){var s$l=new s$m;return s$l._type=1,s$l._separateAxes=!0,s$l._constantMinSeparate=s$d,s$l._constantMaxSeparate=s$L,s$l},s$m.createByRandomTwoGradient=function(s$d,s$L){var s$l=new s$m;return s$l._type=2,s$l._separateAxes=!1,s$l._gradientMin=s$d,s$l._gradientMax=s$L,s$l},s$m.createByRandomTwoGradientSeparate=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=new s$m;return s$N._type=2,s$N._separateAxes=!0,s$N._gradientXMin=s$d,s$N._gradientXMax=s$L,s$N._gradientYMin=s$l,s$N._gradientYMax=s$Z,s$N._gradientZMin=s$h,s$N._gradientZMax=s$_,s$N},s$m}()),s$o=function(){function s$m(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}s$Y(s$m,"laya.d3.core.particleShuriKen.module.GradientVelocity");var s$d=s$m.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,this._constant.cloneTo(s$L._constant),this._gradientX.cloneTo(s$L._gradientX),this._gradientY.cloneTo(s$L._gradientY),this._gradientZ.cloneTo(s$L._gradientZ),this._constantMin.cloneTo(s$L._constantMin),this._constantMax.cloneTo(s$L._constantMax),this._gradientXMin.cloneTo(s$L._gradientXMin),this._gradientXMax.cloneTo(s$L._gradientXMax),this._gradientYMin.cloneTo(s$L._gradientYMin),this._gradientYMax.cloneTo(s$L._gradientYMax),this._gradientZMin.cloneTo(s$L._gradientZMin),this._gradientZMax.cloneTo(s$L._gradientZMax)},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"gradientZ",function(){return this._gradientZ}),s$c(0,s$d,"constant",function(){return this._constant}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"gradientXMax",function(){return this._gradientXMax}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"gradientX",function(){return this._gradientX}),s$c(0,s$d,"gradientY",function(){return this._gradientY}),s$c(0,s$d,"gradientXMin",function(){return this._gradientXMin}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$c(0,s$d,"gradientYMin",function(){return this._gradientYMin}),s$c(0,s$d,"gradientYMax",function(){return this._gradientYMax}),s$c(0,s$d,"gradientZMin",function(){return this._gradientZMin}),s$c(0,s$d,"gradientZMax",function(){return this._gradientZMax}),s$m.createByConstant=function(s$d){var s$L=new s$m;return s$L._type=0,s$L._constant=s$d,s$L},s$m.createByGradient=function(s$d,s$L,s$l){var s$Z=new s$m;return s$Z._type=1,s$Z._gradientX=s$d,s$Z._gradientY=s$L,s$Z._gradientZ=s$l,s$Z},s$m.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$m;return s$l._type=2,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$m.createByRandomTwoGradient=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=new s$m;return s$N._type=3,s$N._gradientXMin=s$d,s$N._gradientXMax=s$L,s$N._gradientYMin=s$l,s$N._gradientYMax=s$Z,s$N._gradientZMin=s$h,s$N._gradientZMax=s$_,s$N},s$m}(),s$i=(function(){function s$d(s$d){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=s$d}s$Y(s$d,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.cloneTo=function(s$d){var s$L=s$d;this._angularVelocity.cloneTo(s$L._angularVelocity),s$L.enbale=this.enbale},s$L.clone=function(){var s$d;switch(this._angularVelocity.type){case 0:s$d=this._angularVelocity.separateAxes?s$X.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):s$X.createByConstant(this._angularVelocity.constant);break;case 1:s$d=this._angularVelocity.separateAxes?s$X.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):s$X.createByGradient(this._angularVelocity.gradient.clone());break;case 2:s$d=this._angularVelocity.separateAxes?s$X.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):s$X.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:s$d=this._angularVelocity.separateAxes?s$X.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):s$X.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var s$L=new this.constructor(s$d);return s$L.enbale=this.enbale,s$L},s$c(0,s$L,"angularVelocity",function(){return this._angularVelocity})}(),function(){function s$d(){this.enable=!1,this.randomDirection=!1}s$Y(s$d,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L._getShapeBoundBox=function(s$d){throw new Error("BaseShape: must override it.")},s$L._getSpeedBoundBox=function(s$d){throw new Error("BaseShape: must override it.")},s$L.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){throw new Error("BaseShape: must override it.")},s$L._calculateProceduralBounds=function(s$d,s$L,s$l){this._getShapeBoundBox(s$d);var s$Z=s$d.min,s$h=s$d.max;s$NL.multiply(s$Z,s$L,s$Z),s$NL.multiply(s$h,s$L,s$h);var s$_=new s$Jd(new s$NL,new s$NL);this.randomDirection?(s$_.min=new s$NL(-1,-1,-1),s$_.max=new s$NL(1,1,1)):this._getSpeedBoundBox(s$_);var s$N=new s$Jd(new s$NL,new s$NL),s$m=s$N.min,s$u=s$N.max;s$NL.scale(s$_.min,s$l.y,s$m),s$NL.scale(s$_.max,s$l.y,s$u),s$NL.add(s$d.min,s$m,s$m),s$NL.add(s$d.max,s$u,s$u),s$NL.min(s$d.min,s$m,s$d.min),s$NL.max(s$d.max,s$m,s$d.max);var s$x=new s$Jd(new s$NL,new s$NL),s$t=s$x.min,s$b=s$x.max;s$NL.scale(s$_.min,s$l.x,s$t),s$NL.scale(s$_.max,s$l.x,s$b),s$NL.min(s$x.min,s$b,s$m),s$NL.max(s$x.min,s$b,s$u),s$NL.min(s$d.min,s$m,s$d.min),s$NL.max(s$d.max,s$m,s$d.max)},s$L.cloneTo=function(s$d){s$d.enable=this.enable},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$d}()),s$T=function(){function s$_(){}return s$Y(s$_,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),s$_._randomPointUnitArcCircle=function(s$d,s$L,s$l){var s$Z=s$L.elements,s$h=NaN;s$h=s$l?s$l.getFloat()*s$d:Math.random()*s$d,s$Z[0]=Math.cos(s$h),s$Z[1]=Math.sin(s$h)},s$_._randomPointInsideUnitArcCircle=function(s$d,s$L,s$l){var s$Z=s$L.elements;s$_._randomPointUnitArcCircle(s$d,s$L,s$l);var s$h=NaN;s$h=s$l?Math.pow(s$l.getFloat(),.5):Math.pow(Math.random(),.5),s$Z[0]=s$Z[0]*s$h,s$Z[1]=s$Z[1]*s$h},s$_._randomPointUnitCircle=function(s$d,s$L){var s$l=s$d.elements,s$Z=NaN;s$Z=s$L?s$L.getFloat()*Math.PI*2:Math.random()*Math.PI*2,s$l[0]=Math.cos(s$Z),s$l[1]=Math.sin(s$Z)},s$_._randomPointInsideUnitCircle=function(s$d,s$L){var s$l=s$d.elements;s$_._randomPointUnitCircle(s$d);var s$Z=NaN;s$Z=s$L?Math.pow(s$L.getFloat(),.5):Math.pow(Math.random(),.5),s$l[0]=s$l[0]*s$Z,s$l[1]=s$l[1]*s$Z},s$_._randomPointUnitSphere=function(s$d,s$L){var s$l=s$d.elements,s$Z=NaN,s$h=NaN;s$h=s$L?(s$Z=s$l[2]=2*s$L.getFloat()-1,s$L.getFloat()*Math.PI*2):(s$Z=s$l[2]=2*Math.random()-1,Math.random()*Math.PI*2);var s$_=Math.sqrt(1-s$Z*s$Z);s$l[0]=s$_*Math.cos(s$h),s$l[1]=s$_*Math.sin(s$h)},s$_._randomPointInsideUnitSphere=function(s$d,s$L){var s$l=s$d.elements;s$_._randomPointUnitSphere(s$d);var s$Z=NaN;s$Z=s$L?Math.pow(s$L.getFloat(),1/3):Math.pow(Math.random(),1/3),s$l[0]=s$l[0]*s$Z,s$l[1]=s$l[1]*s$Z,s$l[2]=s$l[2]*s$Z},s$_._randomPointInsideHalfUnitBox=function(s$d,s$L){var s$l=s$d.elements;s$L?(s$l[0]=s$L.getFloat()-.5,s$l[1]=s$L.getFloat()-.5,s$l[2]=s$L.getFloat()-.5):(s$l[0]=Math.random()-.5,s$l[1]=Math.random()-.5,s$l[2]=Math.random()-.5)},s$_}(),s$z=(function(){function s$d(s$d){this._size=null,this.enbale=!1,this._size=s$d}s$Y(s$d,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.cloneTo=function(s$d){var s$L=s$d;this._size.cloneTo(s$L._size),s$L.enbale=this.enbale},s$L.clone=function(){var s$d;switch(this._size.type){case 0:s$d=this._size.separateAxes?s$R.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):s$R.createByGradient(this._size.gradient.clone());break;case 1:s$d=this._size.separateAxes?s$R.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):s$R.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:s$d=this._size.separateAxes?s$R.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):s$R.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var s$L=new this.constructor(s$d);return s$L.enbale=this.enbale,s$L},s$c(0,s$L,"size",function(){return this._size})}(),function(){function s$Z(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}s$Y(s$Z,"laya.d3.core.particleShuriKen.module.StartFrame");var s$d=s$Z.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.cloneTo=function(s$d){var s$L=s$d;s$L._type=this._type,s$L._constant=this._constant,s$L._constantMin=this._constantMin,s$L._constantMax=this._constantMax},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$d,"constant",function(){return this._constant}),s$c(0,s$d,"type",function(){return this._type}),s$c(0,s$d,"constantMin",function(){return this._constantMin}),s$c(0,s$d,"constantMax",function(){return this._constantMax}),s$Z.createByConstant=function(s$d){var s$L=new s$Z;return s$L._type=0,s$L._constant=s$d,s$L},s$Z.createByRandomTwoConstant=function(s$d,s$L){var s$l=new s$Z;return s$l._type=1,s$l._constantMin=s$d,s$l._constantMax=s$L,s$l},s$Z}()),s$D=(function(){function s$d(s$d,s$L){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new s$_L(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=s$d,this._startFrame=s$L}s$Y(s$d,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.cloneTo=function(s$d){var s$L=s$d;this.tiles.cloneTo(s$L.tiles),s$L.type=this.type,s$L.randomRow=this.randomRow,this._frame.cloneTo(s$L._frame),this._startFrame.cloneTo(s$L._startFrame),s$L.cycles=this.cycles,s$L.enableUVChannels=this.enableUVChannels,s$L.enable=this.enable},s$L.clone=function(){var s$d,s$L;switch(this._frame.type){case 0:s$d=s$H.createByConstant(this._frame.constant);break;case 1:s$d=s$H.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:s$d=s$H.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:s$d=s$H.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:s$L=s$z.createByConstant(this._startFrame.constant);break;case 1:s$L=s$z.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var s$l=new this.constructor(s$d,s$L);return this.tiles.cloneTo(s$l.tiles),s$l.type=this.type,s$l.randomRow=this.randomRow,s$l.cycles=this.cycles,s$l.enableUVChannels=this.enableUVChannels,s$l.enable=this.enable,s$l},s$c(0,s$L,"frame",function(){return this._frame}),s$c(0,s$L,"startFrame",function(){return this._startFrame})}(),function(){function s$d(s$d){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=s$d}s$Y(s$d,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.cloneTo=function(s$d){var s$L=s$d;this._velocity.cloneTo(s$L._velocity),s$L.enbale=this.enbale,s$L.space=this.space},s$L.clone=function(){var s$d;switch(this._velocity.type){case 0:s$d=s$o.createByConstant(this._velocity.constant.clone());break;case 1:s$d=s$o.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:s$d=s$o.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:s$d=s$o.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var s$L=new this.constructor(s$d);return s$L.enbale=this.enbale,s$L.space=this.space,s$L},s$c(0,s$L,"velocity",function(){return this._velocity})}(),function(){function s$d(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new s$qL,this._vb=s$iL.create(s$d._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=s$oL.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=s$jL.nameKey.getID("LINE"),this._shaderCompile=s$OL._preCompileShader[this._sharderNameID]}s$Y(s$d,"laya.d3.core.PhasorSpriter3D");var s$L=s$d.prototype;return s$L.line=function(s$d,s$L,s$l,s$Z){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(s$d.x,s$d.y,s$d.z,s$L.x,s$L.y,s$L.z,s$L.w),this.addVertex(s$l.x,s$l.y,s$l.z,s$Z.x,s$Z.y,s$Z.z,s$Z.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},s$L.circle=function(s$d,s$L,s$l,s$Z,s$h,s$_){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*s$L,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/s$L,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*s$d,Math.cos(this._tempNumver0)*s$d,0,s$l,s$Z,s$h,s$_),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},s$L.plane=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=s$Z/2,this._tempNumver1=s$h/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(s$d-this._tempNumver0,s$L+this._tempNumver1,s$l,s$_,s$N,s$m,s$u),this.addVertex(s$d+this._tempNumver0,s$L+this._tempNumver1,s$l,s$_,s$N,s$m,s$u),this.addVertex(s$d-this._tempNumver0,s$L-this._tempNumver1,s$l,s$_,s$N,s$m,s$u),this.addVertex(s$d+this._tempNumver0,s$L-this._tempNumver1,s$l,s$_,s$N,s$m,s$u),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},s$L.box=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=s$Z/2,this._tempNumver1=s$h/2,this._tempNumver2=s$_/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(s$d-this._tempNumver0,s$L+this._tempNumver1,s$l+this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d+this._tempNumver0,s$L+this._tempNumver1,s$l+this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d-this._tempNumver0,s$L-this._tempNumver1,s$l+this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d+this._tempNumver0,s$L-this._tempNumver1,s$l+this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d+this._tempNumver0,s$L+this._tempNumver1,s$l-this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d-this._tempNumver0,s$L+this._tempNumver1,s$l-this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d+this._tempNumver0,s$L-this._tempNumver1,s$l-this._tempNumver2,s$N,s$m,s$u,s$x),this.addVertex(s$d-this._tempNumver0,s$L-this._tempNumver1,s$l-this._tempNumver2,s$N,s$m,s$u,s$x),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},s$L.cone=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*s$l+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*s$l>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/s$l,this.addVertexIndex(0,s$L,0,s$Z,s$h,s$_,s$N,this._tempUint0),this.addVertexIndex(0,0,0,s$Z,s$h,s$_,s$N,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<s$l;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(s$d*this._tempNumver2,0,s$d*this._tempNumver3,s$Z,s$h,s$_,s$N,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==s$l-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(s$d*this._tempNumver2,0,s$d*this._tempNumver3,s$Z,s$h,s$_,s$N,this._tempUint0+(this._tempInt0+s$l)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==s$l-1?this.addIndexes(this._tempUint1+s$l+2):this.addIndexes(this._tempUint1+this._tempInt0+s$l+1),this.addIndexes(this._tempUint1+this._tempInt0+s$l),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},s$L.boundingBoxLine=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(s$d,s$h,s$_,s$N,s$m,s$u,s$x),this.addVertex(s$Z,s$h,s$_,s$N,s$m,s$u,s$x),this.addVertex(s$d,s$L,s$_,s$N,s$m,s$u,s$x),this.addVertex(s$Z,s$L,s$_,s$N,s$m,s$u,s$x),this.addVertex(s$Z,s$h,s$l,s$N,s$m,s$u,s$x),this.addVertex(s$d,s$h,s$l,s$N,s$m,s$u,s$x),this.addVertex(s$Z,s$L,s$l,s$N,s$m,s$u,s$x),this.addVertex(s$d,s$L,s$l,s$N,s$m,s$u,s$x),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},s$L.addVertex=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=s$d,this._vbData[this._posInVBData+1]=s$L,this._vbData[this._posInVBData+2]=s$l,this._vbData[this._posInVBData+3]=s$Z,this._vbData[this._posInVBData+4]=s$h,this._vbData[this._posInVBData+5]=s$_,this._vbData[this._posInVBData+6]=s$N,this._posInVBData+=this._floatSizePerVer,this},s$L.addVertexIndex=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){return this._hasBegun||this.addVertexIndexException(),this._vbData[s$m]=s$d,this._vbData[s$m+1]=s$L,this._vbData[s$m+2]=s$l,this._vbData[s$m+3]=s$Z,this._vbData[s$m+4]=s$h,this._vbData[s$m+5]=s$_,this._vbData[s$m+6]=s$N,(s$m+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=s$m),this},s$L.addIndexes=function(s$d){var s$L=arguments;this._hasBegun||this.addVertexIndexException();for(var s$l=0;s$l<s$L.length;s$l++)this._ibData[this._posInIBData]=s$L[s$l],this._posInIBData++;return this},s$L.begin=function(s$d,s$L){return this._hasBegun&&this.beginException0(),1!==s$d&&4!==s$d&&this.beginException1(),this._primitiveType=s$d,this._camera=s$L,this._hasBegun=!0,this},s$L.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},s$L.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(s$d._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),s$O.drawCall++,s$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},s$L.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},s$L.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},s$L.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},s$L.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},s$L.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},s$L.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(28,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector4",1)])}]),s$d}()),s$G=function(){function s$d(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++s$d._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new s$qL}s$Y(s$d,"laya.d3.core.render.RenderElement");var s$L=s$d.prototype;return s$L.getDynamicBatchBakedVertexs=function(s$d){for(var s$L=this._renderObj._getVertexBuffer(s$d),s$l=s$L.getData().slice(),s$Z=s$L.vertexDeclaration,s$h=s$Z.getVertexElementByUsage(0).offset/4,s$_=s$Z.getVertexElementByUsage(3).offset/4,s$N=this._sprite3D.transform,s$m=s$N.worldMatrix,s$u=s$N.rotation,s$x=s$Z.vertexStride/4,s$t=0,s$b=s$l.length;s$t<s$b;s$t+=s$x){var s$q=s$t+s$h,s$Y=s$t+s$_;s$aL.transformVector3ArrayToVector3ArrayCoordinate(s$l,s$q,s$m,s$l,s$q),s$aL.transformVector3ArrayByQuat(s$l,s$Y,s$u,s$l,s$Y)}return s$l},s$L.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},s$L._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},s$c(0,s$L,"id",function(){return this._id}),s$c(0,s$L,"renderObj",function(){return this._renderObj},function(s$d){this._renderObj!==s$d&&(this._renderObj=s$d)}),s$d._uniqueIDCounter=0,s$d}(),s$K=function(){function s$L(s$d){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++s$L._uniqueIDCounter,this._needSort=!1,this._scene=s$d,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}s$Y(s$L,"laya.d3.core.render.RenderQueue");var s$d=s$L.prototype;return s$d._sortOpaqueFunc=function(s$d,s$L){if(s$d._render&&s$L._render){var s$l=s$d._material.renderQueue-s$L._material.renderQueue;return 0==s$l?s$d._render._distanceForSort-s$L._render._distanceForSort:s$l}return 0},s$d._sortAlphaFunc=function(s$d,s$L){if(s$d._render&&s$L._render){var s$l=s$d._material.renderQueue-s$L._material.renderQueue;return 0==s$l?s$L._render._distanceForSort-s$d._render._distanceForSort:s$l}return 0},s$d._begainRenderElement=function(s$d,s$L,s$l){return!!s$L._beforeRender(s$d)},s$d._sortAlpha=function(s$d){s$L._cameraPosition=s$d,this._finalElements.sort(this._sortAlphaFunc)},s$d._sortOpaque=function(s$d){s$L._cameraPosition=s$d,this._finalElements.sort(this._sortOpaqueFunc)},s$d._preRender=function(s$d){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},s$d._render=function(s$d,s$L){for(var s$l,s$Z,s$h,s$_,s$N,s$m,s$u=s$O.loopCount,s$x=this._scene,s$t=s$d.camera,s$b=(s$t.id,!1),s$q=0,s$Y=this._finalElements.length;s$q<s$Y;s$q++){var s$c,s$r,s$a,s$k=this._finalElements[s$q];if(null!=s$k._onPreRenderFunction&&s$k._onPreRenderFunction.call(s$k._sprite3D,s$d),0===s$k._type){if(s$d.owner=s$a=s$k._sprite3D,s$d.renderElement=s$k,s$a._preRenderUpdateComponents(s$d),s$c=s$k.renderObj,s$r=s$k._material,this._begainRenderElement(s$d,s$c,s$r)){if(s$l=s$c._getVertexBuffers(),!(s$h=(s$Z=s$c._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[s$Z.id]){this._errorRecord[s$Z.id]=1;var s$e="vertexBuffer:"+("("+s$Z._destroyed+","+s$Z._released+","+s$Z._referenceCount+","+s$Z._buffer+")")+", material:"+(s$r?s$r.__className+"("+s$r._destroyed+","+s$r._released+")":"null")+", owner:"+(s$a?s$a.__className+"("+s$a._destroyed+","+s$a._activeInHierarchy+","+s$a._displayedInStage+")":"null")+", renderObj:"+(s$c?s$c.__className+"("+s$c._destroyed+","+s$c._released+","+s$c._referenceCount+")":"")+", parent:, url:"+(s$a?s$a.url:"")+", disposeStack:"+s$Z.disposeStack;s$A.recordError("报错：unknown vertexDeclaration  "+s$e)}continue}if(s$b=(s$_=s$d._shader=s$r._getShader(s$x._shaderDefineValue,s$h.shaderDefineValue,s$a._shaderDefineValue)).bind()||s$u!==s$_._uploadLoopCount,s$l){if(s$_._uploadVertexBuffer!==s$l||s$b){for(var s$w=0;s$w<s$l.length;s$w++){var s$s=s$l[s$w];s$_.uploadAttributesX(s$s.vertexDeclaration.shaderValues.data,s$s)}s$_._uploadVertexBuffer=s$l}}else(s$_._uploadVertexBuffer!==s$Z||s$b)&&(s$_.uploadAttributes(s$h.shaderValues.data,null),s$_._uploadVertexBuffer=s$Z);(s$_._uploadScene!==s$x||s$b)&&(s$_.uploadSceneUniforms(s$x._shaderValues.data),s$_._uploadScene=s$x),(s$t!==s$_._uploadCamera||s$_._uploadSprite3D!==s$a||s$b)&&(s$_.uploadSpriteUniforms(s$a._shaderValues.data),s$_._uploadSprite3D=s$a),(s$t!==s$_._uploadCamera||s$b)&&(s$_.uploadCameraUniforms(s$t._shaderValues.data),s$_._uploadCamera=s$t),(s$_._uploadMaterial!==s$r||s$b)&&(s$r._upload(),s$_._uploadMaterial=s$r),s$N!==s$r?(s$r._setRenderStateBlendDepth(),s$r._setRenderStateFrontFace(s$L,s$a.transform),s$N=s$r,s$m=s$a):s$m!==s$a&&(s$r._setRenderStateFrontFace(s$L,s$a.transform),s$m=s$a),s$c._render(s$d),s$_._uploadLoopCount=s$u}s$a._postRenderUpdateComponents(s$d)}else if(2===s$k._type){s$k.renderObj;s$d.owner=s$a=s$k._sprite3D,s$d.renderElement=s$k,s$d._batchIndexStart=s$k._tempBatchIndexStart,s$d._batchIndexEnd=s$k._tempBatchIndexEnd,s$c=s$k.renderObj,s$r=s$k._material,this._begainRenderElement(s$d,s$c,s$r)&&(s$h=(s$Z=s$c._getVertexBuffer(0)).vertexDeclaration,s$b=(s$_=s$d._shader=s$r._getShader(s$x._shaderDefineValue,s$h.shaderDefineValue,s$a._shaderDefineValue)).bind()||s$u!==s$_._uploadLoopCount,(s$_._uploadVertexBuffer!==s$Z||s$b)&&(s$_.uploadAttributes(s$h.shaderValues.data,null),s$_._uploadVertexBuffer=s$Z),(s$_._uploadScene!==s$x||s$b)&&(s$_.uploadSceneUniforms(s$x._shaderValues.data),s$_._uploadScene=s$x),(s$t!==s$_._uploadCamera||s$_._uploadSprite3D!==s$a||s$b)&&(s$_.uploadSpriteUniforms(s$a._shaderValues.data),s$_._uploadSprite3D=s$a),(s$t!==s$_._uploadCamera||s$b)&&(s$_.uploadCameraUniforms(s$t._shaderValues.data),s$_._uploadCamera=s$t),(s$_._uploadMaterial!==s$r||s$b)&&(s$r._upload(),s$_._uploadMaterial=s$r),s$N!==s$r?(s$r._setRenderStateBlendDepth(),s$r._setRenderStateFrontFace(s$L,s$a.transform),s$N=s$r,s$m=s$a):s$m!==s$a&&(s$r._setRenderStateFrontFace(s$L,s$a.transform),s$m=s$a),s$c._render(s$d),s$_._uploadLoopCount=s$u)}}},s$d._renderShadow=function(s$d,s$L){for(var s$l,s$Z,s$h,s$_,s$N,s$m=s$O.loopCount,s$u=this._scene,s$x=s$d.camera,s$t=!1,s$b=0,s$q=this._finalElements.length;s$b<s$q;s$b++){var s$Y,s$c,s$r,s$a=this._finalElements[s$b];0===s$a._type&&(s$d.owner=s$r=s$a._sprite3D,s$L||s$r._projectionViewWorldUpdateCamera===s$x&&s$r._projectionViewWorldUpdateLoopCount===s$O.loopCount||(s$r._render._renderUpdate(s$d._projectionViewMatrix),s$r._projectionViewWorldUpdateLoopCount=s$O.loopCount,s$r._projectionViewWorldUpdateCamera=s$x),s$d.renderElement=s$a,s$r._preRenderUpdateComponents(s$d),s$Y=s$a.renderObj,s$c=s$a._material,this._begainRenderElement(s$d,s$Y,null)&&(s$Z=(s$l=s$Y._getVertexBuffer(0)).vertexDeclaration,s$t=(s$h=s$d._shader=s$c._getShader(s$u._shaderDefineValue,s$Z.shaderDefineValue,s$r._shaderDefineValue)).bind()||s$m!==s$h._uploadLoopCount,(s$h._uploadVertexBuffer!==s$l||s$t)&&(s$h.uploadAttributes(s$Z.shaderValues.data,null),s$h._uploadVertexBuffer=s$l),(s$x!==s$h._uploadCamera||s$h._uploadSprite3D!==s$r||s$t)&&(s$h.uploadSpriteUniforms(s$r._shaderValues.data),s$h._uploadSprite3D=s$r),(s$x!==s$h._uploadCamera||s$t)&&(s$h.uploadCameraUniforms(s$x._shaderValues.data),s$h._uploadCamera=s$x),(s$h._uploadMaterial!==s$c||s$t)&&(s$c._upload(),s$h._uploadMaterial=s$c),s$h._uploadRenderElement,s$_!==s$c?(s$c._setRenderStateFrontFace(!1,s$r.transform),s$_=s$c,s$N=s$r):s$N!==s$r&&(s$c._setRenderStateFrontFace(!1,s$r.transform),s$N=s$r),s$Y._render(s$d),s$h._uploadLoopCount=s$m),s$r._postRenderUpdateComponents(s$d))}},s$d._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},s$d._addRenderElement=function(s$d){this._renderElements.push(s$d),this._needSort=!0},s$d._addDynamicBatchElement=function(s$d){this._dynamicBatchCombineRenderElements.push(s$d)},s$c(0,s$d,"id",function(){return this._id}),s$L._uniqueIDCounter=0,s$L._cameraPosition=null,s$L}(),s$v=function(){function s$d(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return s$Y(s$d,"laya.d3.core.render.RenderState"),s$d.clientWidth=0,s$d.clientHeight=0,s$d}(),s$J=function(){function s$N(s$d,s$L){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new s$Ud(new s$NL,0),this._corners=[new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL],this._boundingBoxCenter=new s$NL,this._children=s$Z(8),this._objects=[],this._tempBoundBoxCorners=[new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL],this._scene=s$d,this._currentDepth=s$L}s$Y(s$N,"laya.d3.core.scene.OctreeNode");var s$d=s$N.prototype;return s$A.imps(s$d,{"laya.d3.core.scene.ITreeNode":!0}),s$d.init=function(s$d,s$L){var s$l=new s$NL,s$Z=new s$NL;s$NL.scale(s$L,-.5,s$l),s$NL.scale(s$L,.5,s$Z),s$NL.add(s$l,s$d,s$l),s$NL.add(s$Z,s$d,s$Z),this.exactBox=new s$Jd(s$l,s$Z),this.relaxBox=new s$Jd(s$l,s$Z)},s$d.addTreeNode=function(s$d){1===Collision.boxContainsBox(this._relaxBox,s$d.boundingBox)?this.addNodeDown(s$d,0):this.addObject(s$d)},s$d.addChild=function(s$d){var s$L=this._children[s$d];if(null==s$L){s$L=new s$N(this._scene,this._currentDepth+1),(this._children[s$d]=s$L)._parent=this,s$NL.subtract(this._exactBox.max,this._exactBox.min,s$N.tempSize),s$NL.multiply(s$N.tempSize,s$N._octreeSplit[s$d],s$N.tempCenter),s$NL.add(this._exactBox.min,s$N.tempCenter,s$N.tempCenter),s$NL.scale(s$N.tempSize,.25,s$N.tempSize);var s$l=new s$NL,s$Z=new s$NL;s$NL.subtract(s$N.tempCenter,s$N.tempSize,s$l),s$NL.add(s$N.tempCenter,s$N.tempSize,s$Z),s$L.exactBox=new s$Jd(s$l,s$Z),s$NL.scale(s$N.tempSize,s$N.relax,s$N.tempSize);var s$h=new s$NL,s$_=new s$NL;s$NL.subtract(s$N.tempCenter,s$N.tempSize,s$h),s$NL.add(s$N.tempCenter,s$N.tempSize,s$_),s$L.relaxBox=new s$Jd(s$h,s$_)}return s$L},s$d.addObject=function(s$d){(s$d._treeNode=this)._objects.push(s$d)},s$d.removeObject=function(s$d){if(s$d._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var s$L=this._objects.indexOf(s$d);return-1!==s$L&&(this._objects.splice(s$L,1),!0)},s$d.clearObject=function(){this._objects.length=0},s$d.addNodeUp=function(s$d,s$L){this._parent&&1!==Collision.boxContainsBox(this._exactBox,s$d.boundingBox)?this._parent.addNodeUp(s$d,s$L-1):this.addNodeDown(s$d,s$L)},s$d.addNodeDown=function(s$d,s$L){if(s$L<this._scene.treeLevel){var s$l=this.inChildIndex(s$d.boundingBoxCenter),s$Z=this.addChild(s$l);1===Collision.boxContainsBox(s$Z._relaxBox,s$d.boundingBox)?s$Z.addNodeDown(s$d,++s$L):this.addObject(s$d)}else this.addObject(s$d)},s$d.inChildIndex=function(s$d){return 4*(s$d.z<this._boundingBoxCenter.z?0:1)+2*(s$d.y<this._boundingBoxCenter.y?0:1)+(s$d.x<this._boundingBoxCenter.x?0:1)},s$d.updateObject=function(s$d){1===Collision.boxContainsBox(this._relaxBox,s$d.boundingBox)?(this.removeObject(s$d),s$d._treeNode=null,this.addNodeDown(s$d,this._currentDepth)):this._parent&&(this.removeObject(s$d),s$d._treeNode=null,this._parent.addNodeUp(s$d,this._currentDepth-1))},s$d.cullingObjects=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N=0,s$m=0,s$u=0,s$x=this._scene._dynamicBatchManager;for(s$N=0,s$_=this._objects.length;s$N<s$_;s$N++){var s$t=this._objects[s$N];if(s$p.isVisible(s$t._owner.layer.mask)&&s$t.enable){if(s$L&&(s$O.treeSpriteCollision+=1,0===s$d.containsBoundSphere(s$t.boundingSphere)))continue;s$t._renderUpdate(s$h),s$t._distanceForSort=s$NL.distance(s$t.boundingSphere.center,s$Z)+s$t.sortingFudge;var s$b=s$t._renderElements;for(s$m=0,s$u=s$b.length;s$m<s$u;s$m++){var s$q=s$b[s$m],s$Y=s$q._staticBatch;if(s$Y&&s$Y._material===s$q._material)s$Y._addBatchRenderElement(s$q);else{var s$c=s$q.renderObj;s$c.triangleCount<10&&1===s$c._vertexBufferCount&&s$c._getIndexBuffer()&&s$q._material.renderQueue<2&&s$q._canDynamicBatch&&!s$t._owner.isStatic?s$x._addPrepareRenderElement(s$q):this._scene.getRenderQueue(s$q._material.renderQueue)._addRenderElement(s$q)}}}}for(s$N=0;s$N<8;s$N++){var s$r=this._children[s$N];if(null!=s$r){var s$a=s$L;if(s$L){var s$k=s$d.containsBoundBox(s$r._relaxBox);if(s$O.treeNodeCollision+=1,0===s$k)continue;s$a=2===s$k}s$r.cullingObjects(s$d,s$a,s$l,s$Z,s$h)}}},s$d.cullingShadowObjects=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N=0,s$m=0,s$u=0;this._scene._dynamicBatchManager;for(s$N=0,s$_=this._objects.length;s$N<s$_;s$N++){var s$x=this._objects[s$N];if(s$x.castShadow&&s$p.isVisible(s$x._owner.layer.mask)&&s$x.enable){if(s$l&&0===s$d[0].containsBoundSphere(s$x.boundingSphere))continue;for(var s$t=1,s$b=s$d.length;s$t<s$b;s$t++){var s$q=s$L[s$t-1];if(0!==s$d[s$t].containsBoundSphere(s$x.boundingSphere)){var s$Y=s$x._renderElements;for(s$m=0,s$u=s$Y.length;s$m<s$u;s$m++)s$q._addRenderElement(s$Y[s$m])}}}}for(s$N=0;s$N<8;s$N++){var s$c=this._children[s$N];if(null!=s$c){var s$r=s$l;if(s$l){var s$a=s$d[0].containsBoundBox(s$c._relaxBox);if(0===s$a)continue;s$r=2===s$a}s$c.cullingShadowObjects(s$d,s$L,s$r,s$Z,s$h)}}},s$d.cullingShadowObjectsOnePSSM=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m=s$L[0],s$u=0,s$x=0,s$t=0;for(s$u=0,s$N=this._objects.length;s$u<s$N;s$u++){var s$b=this._objects[s$u];if(s$b.castShadow&&s$p.isVisible(s$b._owner.layer.mask)&&s$b.enable){if(s$Z&&0===s$d.containsBoundSphere(s$b.boundingSphere))continue;s$b._renderUpdate(s$l);var s$q=s$b._renderElements;for(s$x=0,s$t=s$q.length;s$x<s$t;s$x++)s$m._addRenderElement(s$q[s$x])}}for(s$u=0;s$u<8;s$u++){var s$Y=this._children[s$u];if(null!=s$Y){var s$c=s$Z;if(s$Z){var s$r=s$d.containsBoundBox(s$Y._relaxBox);if(0===s$r)continue;s$c=2===s$r}s$Y.cullingShadowObjectsOnePSSM(s$d,s$L,s$l,s$c,s$h,s$_)}}},s$d.renderBoudingBox=function(s$d){this._renderBoudingBox(s$d);for(var s$L=0;s$L<8;++s$L){var s$l=this._children[s$L];s$l&&s$l.renderBoudingBox(s$d)}},s$d.buildAllChild=function(s$d){if(s$d<this._scene.treeLevel)for(var s$L=0;s$L<8;s$L++){this.addChild(s$L).buildAllChild(s$d+1)}},s$d._renderBoudingBox=function(s$d){},s$c(0,s$d,"exactBox",function(){return this._exactBox},function(s$d){this._exactBox=s$d,s$NL.add(s$d.min,s$d.max,this._boundingBoxCenter),s$NL.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),s$c(0,s$d,"relaxBox",function(){return this._relaxBox},function(s$d){(this._relaxBox=s$d).getCorners(this._corners),s$Ud.createfromPoints(this._corners,this._boundingSphere)}),s$N.debugMode=!1,s$N.relax=1.15,s$N.CHILDNUM=8,s$b(s$N,["tempVector0",function(){return this.tempVector0=new s$NL},"tempSize",function(){return this.tempSize=new s$NL},"tempCenter",function(){return this.tempCenter=new s$NL},"_octreeSplit",function(){return this._octreeSplit=[new s$NL(.25,.25,.25),new s$NL(.75,.25,.25),new s$NL(.25,.75,.25),new s$NL(.75,.75,.25),new s$NL(.25,.25,.75),new s$NL(.75,.25,.75),new s$NL(.25,.75,.75),new s$NL(.75,.75,.75)]}]),s$N}(),s$f=(function(){function s$d(){}s$Y(s$d,"laya.d3.core.scene.SceneManager")}(),function(){function s$d(s$d,s$L,s$l,s$Z){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===s$d&&(s$d=1),void 0===s$L&&(s$L=1),void 0===s$l&&(s$l=1),void 0===s$Z&&(s$Z=1),this._r=s$d,this._g=s$L,this._b=s$l,this._a=s$Z}return s$Y(s$d,"laya.d3.core.trail.module.Color",null,"Color$1"),s$d.prototype.cloneTo=function(s$d){s$d._r=this._r,s$d._g=this._g,s$d._b=this._b,s$d._a=this._a},s$b(s$d,["RED",function(){return this.RED=new s$d(1,0,0,1)},"GREEN",function(){return this.GREEN=new s$d(0,1,0,1)},"BLUE",function(){return this.BLUE=new s$d(0,0,1,1)},"CYAN",function(){return this.CYAN=new s$d(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new s$d(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new s$d(1,0,1,1)},"GRAY",function(){return this.GRAY=new s$d(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new s$d(1,1,1,1)},"BLACK",function(){return this.BLACK=new s$d(0,0,0,1)}]),s$d}()),s$U=(function(){function s$d(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}s$Y(s$d,"laya.d3.core.trail.module.Gradient");var s$L=s$d.prototype;s$L.setKeys=function(s$d,s$L){var s$l,s$Z;this._colorKeys=s$d;for(var s$h=this.index=0;s$h<s$d.length;s$h++){var s$_=(s$l=s$d[s$h]).color;this._colorKeyData[this.index++]=s$_._r,this._colorKeyData[this.index++]=s$_._g,this._colorKeyData[this.index++]=s$_._b,this._colorKeyData[this.index++]=s$l.time}this._alphaKeys=s$L;for(var s$N=this.index=0;s$N<s$L.length;s$N++)s$Z=s$L[s$N],this._alphaKeyData[this.index++]=s$Z.alpha,this._alphaKeyData[this.index++]=s$Z.time},s$L.cloneTo=function(s$d){var s$L=0,s$l=0,s$Z=this.colorKeys,s$h=[];for(s$L=0,s$l=s$Z.length;s$L<s$l;s$L++){var s$_=new s$W;s$Z[s$L].cloneTo(s$_),s$h.push(s$_)}var s$N=this.alphaKeys,s$m=[];for(s$L=0,s$l=s$N.length;s$L<s$l;s$L++){var s$u=new s$U;s$N[s$L].cloneTo(s$u),s$m.push(s$u)}s$d.setKeys(s$h,s$m)},s$c(0,s$L,"mode",function(){return this._mode},function(s$d){this._mode=s$d}),s$c(0,s$L,"colorKeys",function(){return this._colorKeys},function(s$d){this._colorKeys=s$d;for(var s$L=this.index=0;s$L<s$d.length;s$L++){var s$l=s$d[s$L],s$Z=s$l.color;this._colorKeyData[this.index++]=s$Z._r,this._colorKeyData[this.index++]=s$Z._g,this._colorKeyData[this.index++]=s$Z._b,this._colorKeyData[this.index++]=s$l.time}}),s$c(0,s$L,"alphaKeys",function(){return this._alphaKeys},function(s$d){this._alphaKeys=s$d;for(var s$L=this.index=0;s$L<s$d.length;s$L++){var s$l=s$d[s$L];this._alphaKeyData[this.index++]=s$l.alpha,this._alphaKeyData[this.index++]=s$l.time}})}(),function(){function s$d(s$d,s$L){this._alpha=NaN,this._time=NaN,void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),this._alpha=s$d,this._time=s$L}s$Y(s$d,"laya.d3.core.trail.module.GradientAlphaKey");var s$L=s$d.prototype;return s$L.cloneTo=function(s$d){s$d.alpha=this.alpha,s$d.time=this.time},s$c(0,s$L,"alpha",function(){return this._alpha},function(s$d){this._alpha=s$d}),s$c(0,s$L,"time",function(){return this._time},function(s$d){this._time=s$d}),s$d}()),s$W=function(){function s$d(s$d,s$L){this._color=null,this._time=NaN,void 0===s$L&&(s$L=0),this._color=s$d||new s$f,this._time=s$L}s$Y(s$d,"laya.d3.core.trail.module.GradientColorKey");var s$L=s$d.prototype;return s$L.cloneTo=function(s$d){this.color.cloneTo(s$d.color),s$d.time=this.time},s$c(0,s$L,"color",function(){return this._color},function(s$d){this._color=s$d}),s$c(0,s$L,"time",function(){return this._time},function(s$d){this._time=s$d}),s$d}(),s$M=(function(){function s$d(){}s$Y(s$d,"laya.d3.core.trail.module.GradientMode"),s$d.Blend=0,s$d.Fixed=1}(),function(){function s$d(){}s$Y(s$d,"laya.d3.core.trail.module.TextureMode"),s$d.Stretch=0,s$d.Tile=1}(),function(){function s$d(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}s$Y(s$d,"laya.d3.core.trail.module.TrailKeyFrame"),s$d.prototype.cloneTo=function(s$d){s$d.time=this.time,s$d.inTangent=this.inTangent,s$d.outTangent=this.outTangent,s$d.value=this.value}}(),function(){function s$L(s$d){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new s$NL,this._curPosition=new s$NL,this._delVector3=new s$NL,this._lastFixedVertexPosition=new s$NL,this._pointAtoBVector3=new s$NL,this._pointA=new s$NL,this._pointB=new s$NL,this._owner=s$d,this._id=s$L.renderElementCount++,0==this._id?s$d._owner.transform.position.cloneTo(this._lastPosition):s$d._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new s$iL(s$M.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new s$iL(s$M.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}s$Y(s$L,"laya.d3.core.trail.TrailRenderElement");var s$d=s$L.prototype;s$A.imps(s$d,{"laya.d3.core.render.IRenderable":!0}),s$d._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},s$d._addTrailByFirstPosition=function(s$d,s$L){s$NL.subtract(s$L,s$d,this._delVector3),s$NL.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),s$NL.normalize(this._pointAtoBVector3,this._pointAtoBVector3),s$NL.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(s$d),s$d.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},s$d._addTrailByNextPosition=function(s$d){s$NL.subtract(s$d,this._lastFixedVertexPosition,this._delVector3),s$NL.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),s$NL.normalize(this._pointAtoBVector3,this._pointAtoBVector3),s$NL.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=s$NL.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=s$Wd.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(s$d),s$d.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(s$d),this._virtualVerticesCount=2)},s$d._updateVerticesByPosition=function(s$d){this._pointe=s$d.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},s$d._updateVertexBuffer2=function(){var s$d,s$L=0,s$l=0,s$Z=0;for(s$Z=0,s$d=(this._verticesCount+this._virtualVerticesCount)/2;s$Z<s$d;s$Z++)s$l=0==this._owner.textureMode?(this._VerticesToTailLength[s$Z]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[s$Z],this._vertices2[s$L++]=1-s$l,this._vertices2[s$L++]=1-s$l;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},s$d._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},s$d._updateDisappear=function(){var s$d,s$L=0;for(s$L=this._curDisappearIndex,s$d=(this._verticesCount+this._virtualVerticesCount)/2;s$L<s$d;s$L++)this._owner._curtime-this._everyGroupVertexBirthTime[s$L]>=this._owner.time+s$Wd.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},s$d._beforeRender=function(s$d){return this._camera=s$d.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),s$NL.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},s$d._render=function(s$d){this._isDead||(s$F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),s$O.drawCall++,s$O.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},s$d._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),0===s$d?this._vertexBuffer1:1===s$d?this._vertexBuffer2:null},s$d._getVertexBuffers=function(){return this._vertexBuffers},s$d._getIndexBuffer=function(){return null},s$d.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},s$d._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},s$c(0,s$d,"_vertexBufferCount",function(){return this._vertexBuffers.length}),s$c(0,s$d,"triangleCount",function(){return 0}),s$L.renderElementCount=0}(),function(){function s$d(){}s$Y(s$d,"laya.d3.core.trail.VertexTrail");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration1}),s$c(1,s$d,"vertexDeclaration1",function(){return s$d._vertexDeclaration1}),s$c(1,s$d,"vertexDeclaration2",function(){return s$d._vertexDeclaration2}),s$b(s$d,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new s$_d(32,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",41),new s$Nd(24,"single",33),new s$Nd(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new s$_d(4,[new s$Nd(0,"single",38)])}]),s$d}()),s$dd=function(){function s$s(s$d){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=s$d}s$Y(s$s,"laya.d3.graphics.DynamicBatch");var s$d=s$s.prototype;return s$A.imps(s$d,{"laya.d3.core.render.IRenderable":!0}),s$d._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),0===s$d?this._vertexBuffer:null},s$d._getIndexBuffer=function(){return this._indexBuffer},s$d._getCombineRenderElementFromPool=function(s$d,s$L,s$l){var s$Z=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return s$Z||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=s$Z=new s$G,s$Z._sprite3D=new s$KL),s$Z._sprite3D._render._renderUpdate(s$l),s$Z},s$d._getRenderElement=function(s$d,s$L,s$l){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*s$s.maxVertexCount),this._indexDatas=new Uint16Array(s$s.maxIndexCount),this._vertexBuffer=s$iL.create(this._vertexDeclaration,s$s.maxVertexCount,35048),this._indexBuffer=s$oL.create("ushort",s$s.maxIndexCount,35048));for(var s$Z=this._merageElements.length=0,s$h=0,s$_=0,s$N=this._combineRenderElements.length;s$_<s$N;s$_++){var s$m=this._combineRenderElements[s$_],s$u=s$m.getDynamicBatchBakedVertexs(0),s$x=s$m.getBakedIndices(),s$t=s$m._sprite3D.transform._isFrontFaceInvert,s$b=s$Z/(this._vertexDeclaration.vertexStride/4),s$q=s$h,s$Y=s$q+s$x.length;s$m._tempBatchIndexStart=s$q,s$m._tempBatchIndexEnd=s$Y,this._indexDatas.set(s$x,s$h);var s$c=0;if(s$t)for(s$c=s$q;s$c<s$Y;s$c+=3){this._indexDatas[s$c]=s$b+this._indexDatas[s$c];var s$r=this._indexDatas[s$c+1],s$a=this._indexDatas[s$c+2];this._indexDatas[s$c+1]=s$b+s$a,this._indexDatas[s$c+2]=s$b+s$r}else for(s$c=s$q;s$c<s$Y;s$c+=3)this._indexDatas[s$c]=s$b+this._indexDatas[s$c],this._indexDatas[s$c+1]=s$b+this._indexDatas[s$c+1],this._indexDatas[s$c+2]=s$b+this._indexDatas[s$c+2];s$h+=s$x.length,this._vertexDatas.set(s$u,s$Z),s$Z+=s$u.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),s$_=this._combineRenderElementPoolIndex=0,s$N=this._materials.length;s$_<s$N;s$_++){var s$k=this._getCombineRenderElementFromPool(s$d,s$L,s$l);s$k._type=2,s$k._staticBatch=null;var s$e=(s$k.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[s$_]]._tempBatchIndexStart,s$w=s$_+1===this._materialToRenderElementsOffsets.length?s$h:this._combineRenderElements[this._materialToRenderElementsOffsets[s$_+1]]._tempBatchIndexStart;s$k._tempBatchIndexStart=s$e,s$k._tempBatchIndexEnd=s$w,s$k._material=this._materials[s$_],this._merageElements.push(s$k)}},s$d._addCombineRenderObjTest=function(s$d){var s$L=s$d.renderObj,s$l=this._currentCombineIndexCount+s$L._getIndexBuffer().indexCount,s$Z=this._currentCombineVertexCount+s$L._getVertexBuffer().vertexCount;return!(s$s.maxVertexCount<s$Z||s$s.maxIndexCount<s$l)},s$d._addCombineRenderObj=function(s$d){var s$L=s$d.renderObj;this._combineRenderElements.push(s$d),this._currentCombineIndexCount=this._currentCombineIndexCount+s$L._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+s$L._getVertexBuffer().vertexCount},s$d._addCombineMaterial=function(s$d){this._materials.push(s$d)},s$d._addMaterialToRenderElementOffset=function(s$d){this._materialToRenderElementsOffsets.push(s$d)},s$d._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},s$d._addToRenderQueue=function(s$d,s$L,s$l,s$Z){this._getRenderElement(s$L,s$l,s$Z);for(var s$h=0,s$_=this._materials.length;s$h<s$_;s$h++)s$d.getRenderQueue(this._materials[s$h].renderQueue)._addDynamicBatchElement(this._merageElements[s$h])},s$d._beforeRender=function(s$d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},s$d._render=function(s$d){var s$L=s$d._batchIndexEnd-s$d._batchIndexStart;s$F.mainContext.drawElements(4,s$L,5123,2*s$d._batchIndexStart),s$O.drawCall++,s$O.trianglesFaces+=s$L/3},s$d._getVertexBuffers=function(){return null},s$c(0,s$d,"_vertexBufferCount",function(){return 1}),s$c(0,s$d,"triangleCount",function(){return this._indexBuffer.indexCount/3}),s$c(0,s$d,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),s$s.maxVertexCount=2e4,s$s.maxIndexCount=4e4,s$s.maxCombineTriangleCount=10,s$s}(),s$Ld=function(){function s$s(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}s$Y(s$s,"laya.d3.graphics.DynamicBatchManager");var s$d=s$s.prototype;return s$d.getDynamicBatch=function(s$d,s$L){var s$l,s$Z=s$d.id.toString()+s$L;return this._dynamicBatches[s$Z]?s$l=this._dynamicBatches[s$Z]:this._dynamicBatches[s$Z]=s$l=new s$dd(s$d),s$l},s$d._garbageCollection=function(){for(var s$d in this._dynamicBatches)0===this._dynamicBatches[s$d].combineRenderElementsCount&&delete this._dynamicBatches[s$d]},s$d._addPrepareRenderElement=function(s$d){this._prepareDynamicBatchCombineElements.push(s$d)},s$d._finishCombineDynamicBatch=function(s$d){var s$L,s$l,s$Z;this._prepareDynamicBatchCombineElements.sort(s$s._sortPrepareDynamicBatch);for(var s$h,s$_,s$N,s$m,s$u,s$x=-1,s$t=!0,s$b=0,s$q=-1,s$Y=0,s$c=this._prepareDynamicBatchCombineElements.length;s$Y<s$c;s$Y++){var s$r=(s$_=this._prepareDynamicBatchCombineElements[s$Y]).renderObj._getVertexBuffer(0).vertexDeclaration,s$a=s$l!==s$r;s$a&&(s$b=0,s$l=s$r);var s$k=s$b!==s$x;if(s$k&&(s$x=s$b),(s$a||s$k)&&(s$N=this.getDynamicBatch(s$r,s$b),s$L=null),s$t)if(s$N._addCombineRenderObjTest(s$_)){if(s$L!==(s$h=s$_._material))s$m&&(s$d.getRenderQueue(s$u._material.renderQueue)._addRenderElement(s$u),s$u=s$m=null,s$q=-1),s$m=s$h,s$q=s$N.combineRenderElementsCount,s$u=s$_,s$L=s$h;else if(s$m){var s$e=s$u.renderObj,s$w=s$_.renderObj;s$e._getVertexBuffer().vertexCount+s$w._getVertexBuffer().vertexCount>s$dd.maxVertexCount||s$e._getIndexBuffer().indexCount+s$w._getIndexBuffer().indexCount>s$dd.maxIndexCount?(s$d.getRenderQueue(s$u._material.renderQueue)._addRenderElement(s$u),s$m=s$h,s$q=s$N.combineRenderElementsCount,s$u=s$_):(s$N._addCombineMaterial(s$m),s$N._addMaterialToRenderElementOffset(s$q),s$N._addCombineRenderObj(s$u),s$u=s$m=null,s$q=-1,s$N._addCombineRenderObj(s$_))}else s$N._addCombineRenderObj(s$_);s$t=!0}else s$m&&(s$d.getRenderQueue(s$u._material.renderQueue)._addRenderElement(s$u),s$u=s$m=null,s$q=-1),s$b++,s$t=!1;else s$Z=this._prepareDynamicBatchCombineElements[s$Y-1],s$N._addMaterialToRenderElementOffset(s$N.combineRenderElementsCount),s$L=s$Z._material,s$N._addCombineMaterial(s$L),s$N._addCombineRenderObj(s$Z),s$t=!0,s$L!==(s$h=s$_._material)?(s$m=s$h,s$q=s$N.combineRenderElementsCount,s$u=s$_):s$N._addCombineRenderObj(s$_),s$L=s$h}s$m&&(s$d.getRenderQueue(s$u._material.renderQueue)._addRenderElement(s$u),s$u=s$m=null,s$q=-1),this._prepareDynamicBatchCombineElements.length=0},s$d._clearRenderElements=function(){for(var s$d in this._dynamicBatches)this._dynamicBatches[s$d]._clearRenderElements()},s$d._addToRenderQueue=function(s$d,s$L,s$l,s$Z){for(var s$h in this._dynamicBatches){var s$_=this._dynamicBatches[s$h];0<s$_.combineRenderElementsCount&&s$_._addToRenderQueue(s$d,s$L,s$l,s$Z)}},s$d.dispose=function(){this._dynamicBatches=null},s$s._sortPrepareDynamicBatch=function(s$d,s$L){return s$d._mainSortID-s$L._mainSortID},s$s}(),s$ld=function(){function s$d(){}return s$Y(s$d,"laya.d3.graphics.FrustumCulling"),s$d.renderShadowObjectCulling=function(s$d,s$L,s$l,s$Z,s$h){var s$_=0,s$N=0,s$m=0,s$u=0;for(s$_=0,s$m=s$l.length;s$_<s$m;s$_++){var s$x=s$l[s$_];s$x&&s$x._clearRenderElements()}var s$t,s$b,s$q,s$Y=s$d._cullingRenders;if(1<s$h){for(s$_=0,s$m=s$d._cullingRendersLength;s$_<s$m;s$_++)if((s$t=s$Y[s$_]).castShadow&&s$p.isVisible(s$t._owner.layer.mask)&&s$t.enable)for(var s$c=1,s$r=s$L.length;s$c<s$r;s$c++)if(s$b=s$l[s$c-1],0!==s$L[s$c].containsBoundSphere(s$t.boundingSphere))for(s$N=0,s$u=(s$q=s$t._renderElements).length;s$N<s$u;s$N++)s$b._addRenderElement(s$q[s$N])}else for(s$_=0,s$m=s$d._cullingRendersLength;s$_<s$m;s$_++)if((s$t=s$Y[s$_]).castShadow&&s$p.isVisible(s$t._owner.layer.mask)&&s$t.enable&&0!==s$L[0].containsBoundSphere(s$t.boundingSphere))for(s$t._renderUpdate(s$Z),s$b=s$l[0],s$N=0,s$u=(s$q=s$t._renderElements).length;s$N<s$u;s$N++)s$b._addRenderElement(s$q[s$N])},s$d.renderShadowObjectCullingOctree=function(s$d,s$L,s$l,s$Z,s$h){for(var s$_=0,s$N=s$l.length;s$_<s$N;s$_++){var s$m=s$l[s$_];s$m&&s$m._clearRenderElements()}1<s$h?s$d.treeRoot.cullingShadowObjects(s$L,s$l,!0,0,s$d):s$d.treeRoot.cullingShadowObjectsOnePSSM(s$L[0],s$l,s$Z,!0,0,s$d)},s$d.renderObjectCulling=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=0,s$m=0,s$u=0,s$x=0,s$t=s$L._quenes,s$b=s$L._dynamicBatchManager,s$q=s$L._cullingRenders;for(s$N=0,s$m=s$t.length;s$N<s$m;s$N++){var s$Y=s$t[s$N];s$Y&&s$Y._clearRenderElements()}var s$c=s$Zd._staticBatchManagers;for(s$N=0,s$m=s$c.length;s$N<s$m;s$N++)s$c[s$N]._clearRenderElements();s$b._clearRenderElements();var s$r=s$l.transform.position;for(s$N=0,s$m=s$L._cullingRendersLength;s$N<s$m;s$N++){var s$a=s$q[s$N];if(s$p.isVisible(s$a._owner.layer.mask)&&s$a.enable&&0!==s$d.containsBoundSphere(s$a.boundingSphere)&&s$a._renderUpdate(s$_)){s$a._distanceForSort=s$NL.distance(s$a.boundingSphere.center,s$r)+s$a.sortingFudge;var s$k=s$a._renderElements;for(s$u=0,s$x=s$k.length;s$u<s$x;s$u++){var s$e=s$k[s$u],s$w=s$e._staticBatch;if(s$w&&s$w._material===s$e._material)s$w._addBatchRenderElement(s$e);else{var s$s=s$e.renderObj;s$s.triangleCount<10&&1===s$s._vertexBufferCount&&s$s._getIndexBuffer()&&s$e._material.renderQueue<2&&s$e._canDynamicBatch&&!s$a._owner.isStatic?s$b._addPrepareRenderElement(s$e):s$L.getRenderQueue(s$e._material.renderQueue)._addRenderElement(s$e)}}}}for(s$N=0,s$m=s$c.length;s$N<s$m;s$N++)s$c[s$N]._addToRenderQueue(s$L,s$Z,s$h,s$_);s$b._finishCombineDynamicBatch(s$L),s$b._addToRenderQueue(s$L,s$Z,s$h,s$_)},s$d.renderObjectCullingOctree=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=0,s$m=0,s$u=s$L._quenes,s$x=s$L._dynamicBatchManager;for(s$N=0,s$m=s$u.length;s$N<s$m;s$N++){var s$t=s$u[s$N];s$t&&s$t._clearRenderElements()}var s$b=s$Zd._staticBatchManagers;for(s$N=0,s$m=s$b.length;s$N<s$m;s$N++)s$b[s$N]._clearRenderElements();for(s$x._clearRenderElements(),s$L._cullingRenders.length=0,s$L.treeRoot.cullingObjects(s$d,!0,0,s$l.transform.position,s$_),s$N=0,s$m=s$b.length;s$N<s$m;s$N++)s$b[s$N]._addToRenderQueue(s$L,s$Z,s$h,s$_);s$x._finishCombineDynamicBatch(s$L),s$x._addToRenderQueue(s$L,s$Z,s$h,s$_)},s$d.renderObjectCullingNoBoundFrustum=function(s$d,s$L,s$l,s$Z,s$h){var s$_=0,s$N=0,s$m=0,s$u=0,s$x=s$d._quenes,s$t=s$d._dynamicBatchManager,s$b=s$d._cullingRenders;for(s$_=0,s$N=s$x.length;s$_<s$N;s$_++){var s$q=s$x[s$_];s$q&&s$q._clearRenderElements()}var s$Y=s$Zd._staticBatchManagers;for(s$_=0,s$N=s$Y.length;s$_<s$N;s$_++)s$Y[s$_]._clearRenderElements();s$t._clearRenderElements();var s$c=s$L.transform.position;for(s$_=0,s$N=s$d._cullingRendersLength;s$_<s$N;s$_++){var s$r=s$b[s$_];if(s$p.isVisible(s$r._owner.layer.mask)&&s$r.enable){s$r._renderUpdate(s$h),s$r._distanceForSort=s$NL.distance(s$r.boundingSphere.center,s$c)+s$r.sortingFudge;var s$a=s$r._renderElements;for(s$m=0,s$u=s$a.length;s$m<s$u;s$m++){var s$k=s$a[s$m],s$e=s$k._staticBatch;if(s$e&&s$e._material===s$k._material)s$e._addBatchRenderElement(s$k);else{var s$w=s$k.renderObj;s$w.triangleCount<10&&1===s$w._vertexBufferCount&&s$w._getIndexBuffer()&&s$k._material.renderQueue<2&&s$k._canDynamicBatch&&!s$r._owner.isStatic?s$t._addPrepareRenderElement(s$k):s$d.getRenderQueue(s$k._material.renderQueue)._addRenderElement(s$k)}}}}for(s$_=0,s$N=s$Y.length;s$_<s$N;s$_++)s$Y[s$_]._addToRenderQueue(s$d,s$l,s$Z,s$h);s$t._finishCombineDynamicBatch(s$d),s$t._addToRenderQueue(s$d,s$l,s$Z,s$h)},s$d}(),s$Zd=function(){function s$_(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}s$Y(s$_,"laya.d3.graphics.StaticBatchManager");var s$d=s$_.prototype;return s$d._finishInit=function(){for(var s$d in this._staticBatches)this._staticBatches[s$d]._finishInit();this._initBatchRenderElements.length=0},s$d._initStaticBatchs=function(s$d){throw new Error("StaticBatchManager:must override this function.")},s$d._addInitBatchSprite=function(s$d){for(var s$L=s$d._render._renderElements,s$l=0,s$Z=s$L.length;s$l<s$Z;s$l++)this._initBatchRenderElements.push(s$L[s$l])},s$d._clearRenderElements=function(){for(var s$d in this._staticBatches)this._staticBatches[s$d]._clearRenderElements()},s$d._garbageCollection=function(s$d){var s$L=s$d._staticBatch,s$l=s$L._initBatchRenderElements,s$Z=s$l.indexOf(s$d);s$l.splice(s$Z,1),0===s$l.length&&(s$L.dispose(),delete this._staticBatches[s$L._key])},s$d._addToRenderQueue=function(s$d,s$L,s$l,s$Z){for(var s$h in this._staticBatches){var s$_=this._staticBatches[s$h];0<s$_._batchRenderElements.length&&s$_._updateToRenderQueue(s$d,s$Z)}},s$d.dispose=function(){this._staticBatches=null},s$_._addToStaticBatchQueue=function(s$d){s$d instanceof laya.d3.core.RenderableSprite3D&&s$d._addToInitStaticBatchManager();for(var s$L=0,s$l=s$d.numChildren;s$L<s$l;s$L++)s$_._addToStaticBatchQueue(s$d._childs[s$L])},s$_.combine=function(s$d,s$L){var s$l,s$Z=0,s$h=0;if(s$L)for(s$Z=0,s$h=s$L.length;s$Z<s$h;s$Z++){s$L[s$Z]._addToInitStaticBatchManager()}else s$d&&s$_._addToStaticBatchQueue(s$d);for(s$Z=0,s$h=s$_._staticBatchManagers.length;s$Z<s$h;s$Z++)(s$l=s$_._staticBatchManagers[s$Z])._initStaticBatchs(s$d),s$l._finishInit()},s$_._staticBatchManagers=[],s$_}(),s$hd=function(){function s$d(s$d,s$L,s$l){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=s$d,this._manager=s$L,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=s$l}s$Y(s$d,"laya.d3.graphics.StaticBatch");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),s$L._binarySearch=function(s$d){for(var s$L=0,s$l=this._batchRenderElements.length-1,s$Z=0;s$L<=s$l;)s$Z=Math.floor((s$L+s$l)/2),this._compareBatchRenderElement(this._batchRenderElements[s$Z],s$d)?s$l=s$Z-1:s$L=s$Z+1;return s$L},s$L._compareBatchRenderElement=function(s$d,s$L){throw new Error("StaticBatch:must override this function.")},s$L._getVertexDecLightMap=function(s$d){return s$d===s$od.vertexDeclaration?s$pd.vertexDeclaration:s$d===s$Rd.vertexDeclaration?s$Id.vertexDeclaration:s$d===s$nd.vertexDeclaration?s$sd.vertexDeclaration:s$d===s$Cd.vertexDeclaration?null:s$d===s$rd.vertexDeclaration?s$ad.vertexDeclaration:s$d===s$Sd.vertexDeclaration?s$Xd.vertexDeclaration:s$d===s$Fd.vertexDeclaration?s$Ed.vertexDeclaration:s$d===s$id.vertexDeclaration?s$Hd.vertexDeclaration:s$d===s$Rd.vertexDeclaration?s$Id.vertexDeclaration:s$d===s$Vd.vertexDeclaration?s$Ad.vertexDeclaration:s$d===s$Cd.vertexDeclaration?null:s$d===s$rd.vertexDeclaration?s$ad.vertexDeclaration:s$d===s$Bd.vertexDeclaration?s$jd.vertexDeclaration:s$d===s$Fd.vertexDeclaration?s$Ed.vertexDeclaration:s$d},s$L._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},s$L._addBatchRenderElement=function(s$d){this._batchRenderElements.splice(this._binarySearch(s$d),0,s$d)},s$L._updateToRenderQueue=function(s$d,s$L){this._combineRenderElementPoolIndex=0,this._getRenderElement(s$d.getRenderQueue(this._material.renderQueue)._renderElements,s$d,s$L)},s$L._getRenderElement=function(s$d,s$L,s$l){throw new Error("StaticBatch:must override this function.")},s$L._finishInit=function(){throw new Error("StaticBatch:must override this function.")},s$L._clearRenderElements=function(){this._batchRenderElements.length=0},s$L.dispose=function(){},s$L._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),null},s$L._getIndexBuffer=function(){return null},s$L._beforeRender=function(s$d){return!0},s$L._render=function(s$d){},s$L._getVertexBuffers=function(){return null},s$c(0,s$L,"_vertexBufferCount",function(){return 1}),s$c(0,s$L,"triangleCount",function(){return 0}),s$d.combine=function(s$d){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),s$Zd.combine(s$d)},s$d.maxBatchVertexCount=65535,s$d}(),s$_d=function(){function s$N(s$d,s$L){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++s$N._uniqueIDCounter,this._id>s$N.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",s$N.maxVertexDeclaration);this._shaderValues=new s$qL,this._vertexElementsDic={},this._vertexStride=s$d,this._vertexElements=s$L;for(var s$l=0;s$l<s$L.length;s$l++){var s$Z=s$L[s$l],s$h=s$Z.elementUsage;this._vertexElementsDic[s$h]=s$Z;var s$_=[s$N._getTypeSize(s$Z.elementFormat)/4,5126,!1,this._vertexStride,s$Z.offset];switch(this._shaderValues.setValue(s$h,s$_),s$h){case 1:this._addShaderDefine(s$OL.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(s$OL.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(s$OL.SHADERDEFINE_UV1)}}}s$Y(s$N,"laya.d3.graphics.VertexDeclaration");var s$d=s$N.prototype;return s$d._addShaderDefine=function(s$d){this._shaderDefineValue|=s$d},s$d._removeShaderDefine=function(s$d){this._shaderDefineValue&=~s$d},s$d.getVertexElements=function(){return this._vertexElements.slice()},s$d.getVertexElementByUsage=function(s$d){return this._vertexElementsDic[s$d]},s$d.unBinding=function(){},s$c(0,s$d,"shaderDefineValue",function(){return this._shaderDefineValue}),s$c(0,s$d,"id",function(){return this._id}),s$c(0,s$d,"vertexStride",function(){return this._vertexStride}),s$c(0,s$d,"shaderValues",function(){return this._shaderValues}),s$N._getTypeSize=function(s$d){switch(s$d){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},s$N.getVertexStride=function(s$d){for(var s$L=0,s$l=0;s$l<s$d.Length;s$l++){var s$Z=s$d[s$l],s$h=s$Z.offset+s$N._getTypeSize(s$Z.elementFormat);s$L<s$h&&(s$L=s$h)}return s$L},s$N._maxVertexDeclarationBit=1e3,s$N._uniqueIDCounter=1,s$b(s$N,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),s$N}(),s$Nd=function(){function s$d(s$d,s$L,s$l){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=s$d,this.elementFormat=s$L,this.elementUsage=s$l}return s$Y(s$d,"laya.d3.graphics.VertexElement"),s$d}(),s$md=(function(){function s$d(){}s$Y(s$d,"laya.d3.graphics.VertexElementFormat"),s$d.Single="single",s$d.Vector2="vector2",s$d.Vector3="vector3",s$d.Vector4="vector4",s$d.Color="color",s$d.Byte4="byte4",s$d.Short2="short2",s$d.Short4="short4",s$d.NormalizedShort2="normalizedshort2",s$d.NormalizedShort4="normalizedshort4",s$d.HalfVector2="halfvector2",s$d.HalfVector4="halfvector4"}(),function(){function s$d(){}s$Y(s$d,"laya.d3.graphics.VertexElementUsage"),s$d.POSITION0=0,s$d.COLOR0=1,s$d.TEXTURECOORDINATE0=2,s$d.NORMAL0=3,s$d.BINORMAL0=4,s$d.TANGENT0=5,s$d.BLENDINDICES0=6,s$d.BLENDWEIGHT0=7,s$d.DEPTH0=8,s$d.FOG0=9,s$d.POINTSIZE0=10,s$d.SAMPLE0=11,s$d.TESSELLATEFACTOR0=12,s$d.COLOR1=13,s$d.NEXTTEXTURECOORDINATE0=14,s$d.TEXTURECOORDINATE1=15,s$d.NEXTTEXTURECOORDINATE1=16,s$d.CORNERTEXTURECOORDINATE0=17,s$d.VELOCITY0=18,s$d.STARTCOLOR0=19,s$d.STARTSIZE=20,s$d.AGEADDSCALE0=21,s$d.STARTROTATION=22,s$d.ENDCOLOR0=23,s$d.STARTLIFETIME=24,s$d.TIME0=33,s$d.SHAPEPOSITIONSTARTLIFETIME=30,s$d.DIRECTIONTIME=32,s$d.SIZEROTATION0=27,s$d.RADIUS0=28,s$d.RADIAN0=29,s$d.STARTSPEED=31,s$d.RANDOM0=34,s$d.RANDOM1=35,s$d.SIMULATIONWORLDPOSTION=36,s$d.SIMULATIONWORLDROTATION=37,s$d.TEXTURECOORDINATE0X=38,s$d.TEXTURECOORDINATE0X1=39,s$d.TEXTURECOORDINATE0Y=40,s$d.OFFSETVECTOR=41}(),function(){function s$d(s$d,s$L,s$l){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=s$d,this._textureCoordinate0=s$L,this._time=s$l}s$Y(s$d,"laya.d3.graphics.VertexGlitter");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate0}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"time",function(){return this._time}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(24,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector2",2),new s$Nd(20,"single",33)])}])}(),function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=s$d,this._position=s$L,this._velocity=s$l,this._startColor=s$Z,this._endColor=s$h,this._sizeRotation=s$_,this._radius=s$N,this._radian=s$m,this._ageAddScale=s$u,this._time=s$x}s$Y(s$d,"laya.d3.graphics.VertexParticle");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"endColor",function(){return this._endColor}),s$c(0,s$L,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),s$c(0,s$L,"sizeRotation",function(){return this._sizeRotation}),s$c(0,s$L,"velocity",function(){return this._velocity}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"startColor",function(){return this._startColor}),s$c(0,s$L,"radius",function(){return this._radius}),s$c(0,s$L,"radian",function(){return this._radian}),s$c(0,s$L,"ageAddScale",function(){return this._ageAddScale}),s$c(0,s$L,"time",function(){return this._time}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(116,[new s$Nd(0,"vector4",17),new s$Nd(16,"vector3",0),new s$Nd(28,"vector3",18),new s$Nd(40,"vector4",19),new s$Nd(56,"vector4",23),new s$Nd(72,"vector3",27),new s$Nd(84,"vector2",28),new s$Nd(92,"vector4",29),new s$Nd(108,"single",24),new s$Nd(112,"single",33)])}])}(),function(){function s$d(s$d){this._position=null,this._position=s$d}s$Y(s$d,"laya.d3.graphics.VertexPosition");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(12,[new s$Nd(0,"vector3",0)])}]),s$d}()),s$ud=function(){function s$d(s$d,s$L){this._position=null,this._normal=null,this._position=s$d,this._normal=s$L}s$Y(s$d,"laya.d3.graphics.VertexPositionNormal");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(24,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3)])}]),s$d}(),s$xd=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._color=null,this._position=s$d,this._normal=s$L,this._color=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColor");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(40,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1)])}]),s$d}(),s$td=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._blendIndex=s$Z,this._blendWeight=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorSkin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(72,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6)])}]),s$d}(),s$bd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._tangent=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(88,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6),new s$Nd(72,"vector4",5)])}]),s$d}(),s$qd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._tangent=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(84,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6),new s$Nd(72,"vector3",5)])}]),s$d}(),s$Yd=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._tangent=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(56,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector4",5)])}]),s$d}(),s$cd=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._tangent=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(52,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector3",5)])}]),s$d}(),s$rd=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(48,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2)])}]),s$d}(),s$ad=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(56,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15)])}]),s$d}(),s$kd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._blendIndex=s$_,this._blendWeight=s$N}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(88,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15),new s$Nd(56,"vector4",7),new s$Nd(72,"vector4",6)])}]),s$d}(),s$ed=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._tangent=s$_,this._blendIndex=s$N,this._blendWeight=s$m}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(104,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15),new s$Nd(56,"vector4",7),new s$Nd(72,"vector4",6),new s$Nd(88,"vector4",5)])}]),s$d}(),s$wd=function(){function s$d(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$L.VertexPositionNormalColorTexture0SkinTangent=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._tangent=s$_,this._blendIndex=s$N,this._blendWeight=s$m},s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(100,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15),new s$Nd(56,"vector4",7),new s$Nd(72,"vector4",6),new s$Nd(88,"vector3",5)])}]),s$d}(),s$sd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._tangent=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(72,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15),new s$Nd(56,"vector4",5)])}]),s$d}(),s$Ad=function(){function s$d(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$L.VertexPositionNormalColorTexture0Tangent=function(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._tangent=s$_},s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(68,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector2",15),new s$Nd(56,"vector3",5)])}]),s$d}(),s$yd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(80,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector4",7),new s$Nd(64,"vector4",6)])}]),s$d}(),s$$d=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z,this._tangent=s$h,this._blendIndex=s$_,this._blendWeight=s$N}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(96,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector4",7),new s$Nd(64,"vector4",6),new s$Nd(80,"vector4",5)])}]),s$d}(),s$Od=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z,this._tangent=s$h,this._blendIndex=s$_,this._blendWeight=s$N}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(92,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector4",7),new s$Nd(64,"vector4",6),new s$Nd(80,"vector3",5)])}]),s$d}(),s$nd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z,this._tangent=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(64,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector4",5)])}]),s$d}(),s$Vd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._color=s$l,this._textureCoordinate=s$Z,this._tangent=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"color",function(){return this._color}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(60,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",1),new s$Nd(40,"vector2",2),new s$Nd(48,"vector3",5)])}]),s$d}(),s$Qd=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._tangent=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(40,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector4",5)])}]),s$d}(),s$gd=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._tangent=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(36,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector3",5)])}]),s$d}(),s$Fd=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(32,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2)])}]),s$d}(),s$Ed=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(40,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15)])}]),s$d}(),s$Id=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(72,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6)])}]),s$d}(),s$pd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z,this._tangent=s$h,this._blendIndex=s$_,this._blendWeight=s$N}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(88,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6),new s$Nd(72,"vector4",5)])}]),s$d}(),s$Hd=function(){function s$d(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$L.VertexPositionNormalTexture0SkinTangent=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z,this._tangent=s$h,this._blendIndex=s$_,this._blendWeight=s$N},s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(84,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15),new s$Nd(40,"vector4",7),new s$Nd(56,"vector4",6),new s$Nd(72,"vector3",5)])}]),s$d}(),s$Xd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z,this._tangent=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(56,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15),new s$Nd(40,"vector4",5)])}]),s$d}(),s$jd=function(){function s$d(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$L.VertexPositionNormalTexture0Tangent=function(s$d,s$L,s$l,s$Z,s$h){this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$l,this._textureCoordinate1=s$Z,this._tangent=s$h},s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(52,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15),new s$Nd(40,"vector3",5)])}]),s$d}(),s$Rd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l,this._blendIndex=s$Z,this._blendWeight=s$h}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTextureSkin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(64,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector4",7),new s$Nd(48,"vector4",6)])}]),s$d}(),s$od=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l,this._tangent=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(80,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector4",7),new s$Nd(48,"vector4",6),new s$Nd(64,"vector4",5)])}]),s$d}(),s$id=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l,this._tangent=s$Z,this._blendIndex=s$h,this._blendWeight=s$_}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(76,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector4",7),new s$Nd(48,"vector4",6),new s$Nd(64,"vector3",5)])}]),s$d}(),s$Sd=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l,this._tangent=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(48,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector4",5)])}]),s$d}(),s$Bd=function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l,this._tangent=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionNormalTextureTangent");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(44,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector3",5)])}]),s$d}(),s$Cd=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNTBTexture");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(56,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector3",5),new s$Nd(36,"vector3",4),new s$Nd(48,"vector2",2)])}]),s$d}(),s$Pd=function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=s$d,this._normal=s$L,this._textureCoordinate0=s$Z,this._textureCoordinate1=s$h,this._tangent=s$_,s$l=s$l,this._blendIndex=s$N,this._blendWeight=s$m}s$Y(s$d,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"tangent",function(){return this._tangent}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(0,s$L,"textureCoordinate1",function(){return this._textureCoordinate1}),s$c(0,s$L,"blendIndex",function(){return this._blendIndex}),s$c(0,s$L,"blendWeight",function(){return this._blendWeight}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(96,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector3",5),new s$Nd(36,"vector3",4),new s$Nd(48,"vector2",2),new s$Nd(56,"vector2",15),new s$Nd(64,"vector4",7),new s$Nd(80,"vector4",6)])}]),s$d}(),s$Td=function(){function s$d(s$d,s$L,s$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=s$d,this._normal=s$L,this._textureCoordinate=s$l}s$Y(s$d,"laya.d3.graphics.VertexPositionNTBTextureSkin");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"textureCoordinate",function(){return this._textureCoordinate}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(88,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector3",5),new s$Nd(36,"vector3",4),new s$Nd(48,"vector2",2),new s$Nd(56,"vector4",7),new s$Nd(72,"vector4",6)])}]),s$d}(),s$zd=(function(){function s$d(s$d,s$L,s$l,s$Z){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=s$d,this._normal=s$L,this._textureCoord0=s$l,this._textureCoord1=s$Z}s$Y(s$d,"laya.d3.graphics.VertexPositionTerrain");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"normal",function(){return this._normal}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoord0",function(){return this._textureCoord0}),s$c(0,s$L,"textureCoord1",function(){return this._textureCoord1}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(40,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector3",3),new s$Nd(24,"vector2",2),new s$Nd(32,"vector2",15)])}])}(),function(){function s$d(s$d,s$L){this._position=null,this._textureCoordinate0=null,this._position=s$d,this._textureCoordinate0=s$L}s$Y(s$d,"laya.d3.graphics.VertexPositionTexture0");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"position",function(){return this._position}),s$c(0,s$L,"textureCoordinate0",function(){return this._textureCoordinate0}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(20,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector2",2)])}]),s$d}()),s$Dd=(function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q,s$Y){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=s$d,this._positionStartLifeTime=s$L,this._velocity=s$l,this._startColor=s$Z,this._startSize=s$h,this._startRotation0=s$_,this._startRotation1=s$N,this._startRotation2=s$m,this._startLifeTime=s$u,this._time=s$x,this._startSpeed=s$t,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=s$Y}s$Y(s$d,"laya.d3.graphics.VertexShurikenParticleBillboard");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),s$c(0,s$L,"random1",function(){return this._randoms1}),s$c(0,s$L,"startRotation2",function(){return this._startRotation2}),s$c(0,s$L,"positionStartLifeTime",function(){return this._positionStartLifeTime}),s$c(0,s$L,"velocity",function(){return this._velocity}),s$c(0,s$L,"random0",function(){return this._randoms0}),s$c(0,s$L,"startSize",function(){return this._startSize}),s$c(0,s$L,"startColor",function(){return this._startColor}),s$c(0,s$L,"startRotation0",function(){return this._startRotation0}),s$c(0,s$L,"startRotation1",function(){return this._startRotation1}),s$c(0,s$L,"startLifeTime",function(){return this._startLifeTime}),s$c(0,s$L,"time",function(){return this._time}),s$c(0,s$L,"startSpeed",function(){return this._startSpeed}),s$c(0,s$L,"simulationWorldPostion",function(){return this._simulationWorldPostion}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(152,[new s$Nd(0,"vector4",17),new s$Nd(16,"vector4",30),new s$Nd(32,"vector4",32),new s$Nd(48,"vector4",19),new s$Nd(64,"vector3",20),new s$Nd(76,"vector3",22),new s$Nd(88,"single",31),new s$Nd(92,"vector4",34),new s$Nd(108,"vector4",35),new s$Nd(124,"vector3",36),new s$Nd(136,"vector4",37)])}])}(),function(){function s$d(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q,s$Y){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=s$d,this._positionStartLifeTime=s$L,this._velocity=s$l,this._startColor=s$Z,this._startSize=s$h,this._startRotation0=s$_,this._startRotation1=s$N,this._startRotation2=s$m,this._startLifeTime=s$u,this._time=s$x,this._startSpeed=s$t,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=s$Y}s$Y(s$d,"laya.d3.graphics.VertexShurikenParticleMesh");var s$L=s$d.prototype;s$A.imps(s$L,{"laya.d3.graphics.IVertex":!0}),s$c(0,s$L,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),s$c(0,s$L,"velocity",function(){return this._velocity}),s$c(0,s$L,"position",function(){return this._positionStartLifeTime}),s$c(0,s$L,"random0",function(){return this._randoms0}),s$c(0,s$L,"startSize",function(){return this._startSize}),s$c(0,s$L,"startColor",function(){return this._startColor}),s$c(0,s$L,"startRotation0",function(){return this._startRotation0}),s$c(0,s$L,"startRotation1",function(){return this._startRotation1}),s$c(0,s$L,"random1",function(){return this._randoms1}),s$c(0,s$L,"startRotation2",function(){return this._startRotation2}),s$c(0,s$L,"startLifeTime",function(){return this._startLifeTime}),s$c(0,s$L,"time",function(){return this._time}),s$c(0,s$L,"startSpeed",function(){return this._startSpeed}),s$c(0,s$L,"simulationWorldPostion",function(){return this._simulationWorldPostion}),s$c(0,s$L,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$c(1,s$d,"vertexDeclaration",function(){return s$d._vertexDeclaration}),s$b(s$d,["_vertexDeclaration",function(){return this._vertexDeclaration=new s$_d(172,[new s$Nd(0,"vector3",0),new s$Nd(12,"vector4",1),new s$Nd(28,"vector2",2),new s$Nd(36,"vector4",30),new s$Nd(52,"vector4",32),new s$Nd(68,"vector4",19),new s$Nd(84,"vector3",20),new s$Nd(96,"vector3",22),new s$Nd(108,"single",31),new s$Nd(112,"vector4",34),new s$Nd(128,"vector4",35),new s$Nd(144,"vector3",36),new s$Nd(156,"vector4",37)])}])}(),function(){function s$w(s$d,s$L,s$l,s$Z,s$h,s$_){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=s$l,this._materials=s$Z,this._subMeshes=s$h,this._materialMap=s$_,this._version=s$L,this._onLoaded(s$d)}s$Y(s$w,"laya.d3.loaders.LoadModelV01");var s$d=s$w.prototype;return s$d._onLoaded=function(s$d){this._readData=s$d,this.READ_BLOCK();for(var s$L=0;s$L<this._BLOCK.count;s$L++){var s$l=this._readData.getUint16(),s$Z=this._strings[s$l],s$h=this["READ_"+s$Z];if(null==s$h)throw new Error("model file err,no this function:"+s$l+" "+s$Z);if(!s$h.call(this))break}return this._mesh},s$d.onError=function(){},s$d._readString=function(){return this._strings[this._readData.getUint16()]},s$d.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},s$d.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},s$d.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var s$d=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var s$L=0;s$L<this._STRINGS.size;s$L++)this._strings[s$L]=this._readData.readUTFString();return this._readData.pos=s$d,!0},s$d.READ_MATERIAL=function(){var s$d=this._readData.getUint16(),s$L=(this._readString(),this._readString());return this._materials[s$d]="null"!==s$L?s$k.getRes(this._materialMap[s$L]):new s$gL,!0},s$d.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var s$d,s$L=this._readData.__getBuffer(),s$l=0,s$Z=this._readData.getUint32(),s$h=this._readData.getUint32(),s$_=(new Float32Array(s$L.slice(s$Z+this._DATA.offset,s$Z+this._DATA.offset+s$h)),this._readData.getUint32()),s$N=this._readData.getUint32(),s$m=new Float32Array(s$L.slice(s$_+this._DATA.offset,s$_+this._DATA.offset+s$N));for(this.mesh._inverseBindPoses=[],s$l=0,s$d=s$m.length;s$l<s$d;s$l+=16){var s$u=new s$dL(s$m[s$l+0],s$m[s$l+1],s$m[s$l+2],s$m[s$l+3],s$m[s$l+4],s$m[s$l+5],s$m[s$l+6],s$m[s$l+7],s$m[s$l+8],s$m[s$l+9],s$m[s$l+10],s$m[s$l+11],s$m[s$l+12],s$m[s$l+13],s$m[s$l+14],s$m[s$l+15]);this.mesh._inverseBindPoses.push(s$u)}break;default:throw new Error("LoadModel:unknown version.")}return!0},s$d.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var s$d=this._readString();this._shaderAttributes=s$d.match(s$w._attrReg);var s$L=this._readData.getUint32(),s$l=this._readData.getUint32(),s$Z=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),s$h=this._readData.getUint32(),s$_=this._readData.getUint32(),s$N=this._readData.getUint32(),s$m=this._readData.__getBuffer(),s$u=new s$xL(this._mesh),s$x=this._getVertexDeclaration(),s$t=s$iL.create(s$x,s$h/s$x.vertexStride,35044,!0),s$b=s$Z+this._DATA.offset,s$q=s$m.slice(s$b,s$b+s$h);s$t.setData(new Float32Array(s$q));for(var s$Y=(s$u._vertexBuffer=s$t).vertexDeclaration.getVertexElements(),s$c=0;s$c<s$Y.length;s$c++)s$u._bufferUsage[s$Y[s$c].elementUsage]=s$t;var s$r=s$oL.create("ushort",s$l/2,35044,!0),s$a=s$L+this._DATA.offset,s$k=s$m.slice(s$a,s$a+s$l);s$r.setData(new Uint16Array(s$k)),s$u._indexBuffer=s$r;var s$e=s$m.slice(s$_+this._DATA.offset,s$_+this._DATA.offset+s$N);return s$u._boneIndicesList[0]=new Uint8Array(s$e),this._subMeshes.push(s$u),!0},s$d.READ_DATAAREA=function(){return!1},s$d._getVertexDeclaration=function(){for(var s$d,s$L=!1,s$l=!1,s$Z=!1,s$h=!1,s$_=!1,s$N=!1,s$m=!1,s$u=!1,s$x=!1,s$t=0;s$t<this._shaderAttributes.length;s$t+=8)switch(this._shaderAttributes[s$t]){case"POSITION":s$L=!0;break;case"NORMAL":s$l=!0;break;case"COLOR":s$Z=!0;break;case"UV":s$h=!0;break;case"UV1":s$_=!0;break;case"BLENDWEIGHT":s$m=!0;break;case"BLENDINDICES":s$u=!0;break;case"TANGENT":s$N=!0;break;case"BINORMAL":s$x=!0}return s$L&&s$l&&s$Z&&s$h&&s$_&&s$m&&s$u&&s$N?s$d=s$wd.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$_&&s$m&&s$u?s$d=s$kd.vertexDeclaration:s$L&&s$l&&s$h&&s$_&&s$m&&s$u&&s$N?s$d=s$Hd.vertexDeclaration:s$L&&s$l&&s$h&&s$_&&s$m&&s$u?s$d=s$Id.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$m&&s$u&&s$N?s$d=s$Od.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$m&&s$u?s$d=s$yd.vertexDeclaration:s$L&&s$l&&s$N&&s$x&&s$h&&s$m&&s$u?s$d=s$Td.vertexDeclaration:s$L&&s$l&&s$h&&s$m&&s$u&&s$N?s$d=s$id.vertexDeclaration:s$L&&s$l&&s$h&&s$m&&s$u?s$d=s$Rd.vertexDeclaration:s$L&&s$l&&s$Z&&s$m&&s$u&&s$N?s$d=s$qd.vertexDeclaration:s$L&&s$l&&s$Z&&s$m&&s$u?s$d=s$td.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$_&&s$N?s$d=s$Ad.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$_?s$d=s$ad.vertexDeclaration:s$L&&s$l&&s$h&&s$_&&s$N?s$d=s$jd.vertexDeclaration:s$L&&s$l&&s$h&&s$_?s$d=s$Ed.vertexDeclaration:s$L&&s$l&&s$Z&&s$h&&s$N?s$d=s$Vd.vertexDeclaration:s$L&&s$l&&s$h&&s$N&&s$x?s$d=s$Cd.vertexDeclaration:s$L&&s$l&&s$Z&&s$h?s$d=s$rd.vertexDeclaration:s$L&&s$l&&s$h&&s$N?s$d=s$Bd.vertexDeclaration:s$L&&s$l&&s$h?s$d=s$Fd.vertexDeclaration:s$L&&s$l&&s$Z&&s$N?s$d=s$cd.vertexDeclaration:s$L&&s$l&&s$Z&&(s$d=s$xd.vertexDeclaration),s$d},s$c(0,s$d,"mesh",function(){return this._mesh}),s$w._attrReg=new RegExp("(\\w+)|([:,;])","g"),s$w}()),s$Gd=function(){function s$$(){}return s$Y(s$$,"laya.d3.loaders.LoadModelV02"),s$$.parse=function(s$d,s$L,s$l,s$Z,s$h,s$_){s$$._mesh=s$l,s$$._materials=s$Z,s$$._subMeshes=s$h,s$$._materialMap=s$_,s$$._version=s$L,s$$._readData=s$d,s$$.READ_DATA(),s$$.READ_BLOCK(),s$$.READ_STRINGS();for(var s$N=0,s$m=s$$._BLOCK.count;s$N<s$m;s$N++){s$$._readData.pos=s$$._BLOCK.blockStarts[s$N];var s$u=s$$._readData.getUint16(),s$x=s$$._strings[s$u],s$t=s$$["READ_"+s$x];if(null==s$t)throw new Error("model file err,no this function:"+s$u+" "+s$x);s$t.call()}s$$._strings.length=0,s$$._readData=null,s$$._version=null,s$$._mesh=null,s$$._materials=null,s$$._subMeshes=null,s$$._materialMap=null},s$$._readString=function(){return s$$._strings[s$$._readData.getUint16()]},s$$.READ_DATA=function(){s$$._DATA.offset=s$$._readData.getUint32(),s$$._DATA.size=s$$._readData.getUint32()},s$$.READ_BLOCK=function(){for(var s$d=s$$._BLOCK.count=s$$._readData.getUint16(),s$L=s$$._BLOCK.blockStarts=[],s$l=s$$._BLOCK.blockLengths=[],s$Z=0;s$Z<s$d;s$Z++)s$L.push(s$$._readData.getUint32()),s$l.push(s$$._readData.getUint32())},s$$.READ_STRINGS=function(){var s$d=s$$._readData.getUint32(),s$L=s$$._readData.getUint16(),s$l=s$$._readData.pos;s$$._readData.pos=s$d+s$$._DATA.offset;for(var s$Z=0;s$Z<s$L;s$Z++)s$$._strings[s$Z]=s$$._readData.readUTFString();s$$._readData.pos=s$l},s$$.READ_MATERIAL=function(){s$$._readString(),s$$._readString();var s$d=s$$._readString();return""!==s$d&&s$$._materials.push(s$k.getRes(s$$._materialMap[s$d])),!0},s$$.READ_MESH=function(){s$$._readString();var s$d,s$L=s$$._readData.__getBuffer(),s$l=0,s$Z=s$$._readData.getInt16(),s$h=s$$._DATA.offset;for(s$l=0;s$l<s$Z;s$l++){var s$_=s$h+s$$._readData.getUint32(),s$N=s$$._readData.getUint32(),s$m=new Float32Array(s$L.slice(s$_,s$_+s$N)),s$u=s$$._readString().match(s$$._attrReg),s$x=s$$._getVertexDeclaration(s$u),s$t=s$iL.create(s$x,4*s$m.length/s$x.vertexStride,35044,!0);s$t.setData(s$m),s$$._mesh._vertexBuffers.push(s$t)}var s$b=s$h+s$$._readData.getUint32(),s$q=s$$._readData.getUint32(),s$Y=new Uint16Array(s$L.slice(s$b,s$b+s$q)),s$c=s$oL.create("ushort",s$q/2,35044,!0);s$c.setData(s$Y),s$$._mesh._indexBuffer=s$c;var s$r=s$$._mesh._boneNames=[],s$a=s$$._readData.getUint16();for(s$r.length=s$a,s$l=0;s$l<s$a;s$l++)s$r[s$l]=s$$._strings[s$$._readData.getUint16()];var s$k=s$$._readData.getUint32(),s$e=s$$._readData.getUint32(),s$w=(new Float32Array(s$L.slice(s$h+s$k,s$h+s$k+s$e)),s$$._readData.getUint32()),s$s=s$$._readData.getUint32(),s$A=new Float32Array(s$L.slice(s$h+s$w,s$h+s$w+s$s));for(s$$._mesh._inverseBindPoses=[],s$l=0,s$d=s$A.length;s$l<s$d;s$l+=16){var s$y=new s$dL(s$A[s$l+0],s$A[s$l+1],s$A[s$l+2],s$A[s$l+3],s$A[s$l+4],s$A[s$l+5],s$A[s$l+6],s$A[s$l+7],s$A[s$l+8],s$A[s$l+9],s$A[s$l+10],s$A[s$l+11],s$A[s$l+12],s$A[s$l+13],s$A[s$l+14],s$A[s$l+15]);s$$._mesh._inverseBindPoses.push(s$y)}return s$$._mesh._skinnedDatas=new Float32Array(16*s$A.length),!0},s$$.READ_SUBMESH=function(){var s$d=s$$._readData.__getBuffer(),s$L=new s$xL(s$$._mesh),s$l=s$$._readData.getInt16(),s$Z=s$$._readData.getUint32(),s$h=s$$._readData.getUint32();s$L._vertexBuffer=s$$._mesh._vertexBuffers[s$l],s$L._vertexStart=s$Z,s$L._vertexCount=s$h;var s$_=s$$._readData.getUint32(),s$N=s$$._readData.getUint32(),s$m=s$$._mesh._indexBuffer;s$L._indexBuffer=s$m,s$L._indexStart=s$_,s$L._indexCount=s$N,s$L._indices=new Uint16Array(s$m.getData().buffer,2*s$_,s$N);var s$u=s$$._DATA.offset,s$x=s$L._subIndexBufferStart,s$t=s$L._subIndexBufferCount,s$b=s$L._boneIndicesList,s$q=s$$._readData.getUint16();s$x.length=s$q,s$t.length=s$q,s$b.length=s$q;for(var s$Y=0;s$Y<s$q;s$Y++){s$x[s$Y]=s$$._readData.getUint32(),s$t[s$Y]=s$$._readData.getUint32();var s$c=s$$._readData.getUint32(),s$r=s$$._readData.getUint32();s$L._boneIndicesList[s$Y]=new Uint8Array(s$d.slice(s$u+s$c,s$u+s$c+s$r))}return s$$._subMeshes.push(s$L),!0},s$$._getVertexDeclaration=function(s$d){for(var s$L,s$l=!1,s$Z=!1,s$h=!1,s$_=!1,s$N=!1,s$m=!1,s$u=!1,s$x=!1,s$t=!1,s$b=0;s$b<s$d.length;s$b++)switch(s$d[s$b]){case"POSITION":s$l=!0;break;case"NORMAL":s$Z=!0;break;case"COLOR":s$h=!0;break;case"UV":s$_=!0;break;case"UV1":s$N=!0;break;case"BLENDWEIGHT":s$u=!0;break;case"BLENDINDICES":s$x=!0;break;case"TANGENT":s$m=!0;break;case"BINORMAL":s$t=!0}return s$l&&s$Z&&s$h&&s$_&&s$N&&s$u&&s$x&&s$m?s$L=s$wd.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$N&&s$u&&s$x?s$L=s$kd.vertexDeclaration:s$l&&s$Z&&s$_&&s$N&&s$u&&s$x&&s$m?s$L=s$Hd.vertexDeclaration:s$l&&s$Z&&s$_&&s$N&&s$u&&s$x?s$L=s$Id.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$u&&s$x&&s$m?s$L=s$Od.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$u&&s$x?s$L=s$yd.vertexDeclaration:s$l&&s$Z&&s$_&&s$u&&s$x&&s$m?s$L=s$id.vertexDeclaration:s$l&&s$Z&&s$_&&s$u&&s$x?s$L=s$Rd.vertexDeclaration:s$l&&s$Z&&s$h&&s$u&&s$x&&s$m?s$L=s$qd.vertexDeclaration:s$l&&s$Z&&s$h&&s$u&&s$x?s$L=s$td.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$N&&s$m?s$L=s$Ad.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$N?s$L=s$ad.vertexDeclaration:s$l&&s$Z&&s$_&&s$N&&s$m?s$L=s$jd.vertexDeclaration:s$l&&s$Z&&s$_&&s$N?s$L=s$Ed.vertexDeclaration:s$l&&s$Z&&s$h&&s$_&&s$m?s$L=s$Vd.vertexDeclaration:s$l&&s$Z&&s$_&&s$m&&s$t?s$L=s$Cd.vertexDeclaration:s$l&&s$Z&&s$h&&s$_?s$L=s$rd.vertexDeclaration:s$l&&s$Z&&s$_&&s$m?s$L=s$Bd.vertexDeclaration:s$l&&s$Z&&s$_?s$L=s$Fd.vertexDeclaration:s$l&&s$Z&&s$h&&s$m?s$L=s$cd.vertexDeclaration:s$l&&s$Z&&s$h&&(s$L=s$xd.vertexDeclaration),s$L},s$$._attrReg=new RegExp("(\\w+)|([:,;])","g"),s$$._strings=[],s$$._readData=null,s$$._version=null,s$$._mesh=null,s$$._materials=null,s$$._subMeshes=null,s$$._materialMap=null,s$b(s$$,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),s$$}(),s$Kd=function(){function s$y(){}return s$Y(s$y,"laya.d3.loaders.LoadModelV03"),s$y.parse=function(s$d,s$L,s$l,s$Z,s$h){s$y._mesh=s$l,s$y._subMeshes=s$Z,s$y._materialMap=s$h,s$y._version=s$L,s$y._readData=s$d,s$y.READ_DATA(),s$y.READ_BLOCK(),s$y.READ_STRINGS();for(var s$_=0,s$N=s$y._BLOCK.count;s$_<s$N;s$_++){s$y._readData.pos=s$y._BLOCK.blockStarts[s$_];var s$m=s$y._readData.getUint16(),s$u=s$y._strings[s$m],s$x=s$y["READ_"+s$u];if(null==s$x)throw new Error("model file err,no this function:"+s$m+" "+s$u);s$x.call()}s$y._strings.length=0,s$y._readData=null,s$y._version=null,s$y._mesh=null,s$y._subMeshes=null,s$y._materialMap=null},s$y._readString=function(){return s$y._strings[s$y._readData.getUint16()]},s$y.READ_DATA=function(){s$y._DATA.offset=s$y._readData.getUint32(),s$y._DATA.size=s$y._readData.getUint32()},s$y.READ_BLOCK=function(){for(var s$d=s$y._BLOCK.count=s$y._readData.getUint16(),s$L=s$y._BLOCK.blockStarts=[],s$l=s$y._BLOCK.blockLengths=[],s$Z=0;s$Z<s$d;s$Z++)s$L.push(s$y._readData.getUint32()),s$l.push(s$y._readData.getUint32())},s$y.READ_STRINGS=function(){var s$d=s$y._readData.getUint32(),s$L=s$y._readData.getUint16(),s$l=s$y._readData.pos;s$y._readData.pos=s$d+s$y._DATA.offset;for(var s$Z=0;s$Z<s$L;s$Z++)s$y._strings[s$Z]=s$y._readData.readUTFString();s$y._readData.pos=s$l},s$y.READ_MESH=function(){var s$d,s$L=s$y._readString(),s$l=s$y._readData.__getBuffer(),s$Z=0,s$h=s$y._readData.getInt16(),s$_=s$y._DATA.offset;for(s$Z=0;s$Z<s$h;s$Z++){var s$N,s$m=s$_+s$y._readData.getUint32(),s$u=s$y._readData.getUint32(),s$x=new Float32Array(s$l.slice(s$m,s$m+s$u)),s$t=s$y._readString();switch(s$y._version){case"LAYAMODEL:03":s$N=s$y._vertexDeclarationMap_Discard[s$t];break;case"LAYAMODEL:0301":s$N=s$y._vertexDeclarationMap[s$t];break;default:throw new Error("LoadModelV03: unknown version.")}if(!s$N)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+s$y._version+"  bufferAttribute="+s$t+"  name="+s$L+"  url="+(s$y._mesh?s$y._mesh.url:"null"));var s$b=s$iL.create(s$N,4*s$x.length/s$N.vertexStride,35044,!0,s$y._mesh._url+"_"+s$Z);s$b.setData(s$x),s$y._mesh._vertexBuffers.push(s$b)}var s$q=s$_+s$y._readData.getUint32(),s$Y=s$y._readData.getUint32(),s$c=new Uint16Array(s$l.slice(s$q,s$q+s$Y)),s$r=s$oL.create("ushort",s$Y/2,35044,!0,s$y._mesh._url);s$r.setData(s$c),s$y._mesh._indexBuffer=s$r;var s$a=s$y._mesh._boneNames=[],s$k=s$y._readData.getUint16();for(s$a.length=s$k,s$Z=0;s$Z<s$k;s$Z++)s$a[s$Z]=s$y._strings[s$y._readData.getUint16()];s$y._readData.pos+=8;var s$e=s$y._readData.getUint32(),s$w=s$y._readData.getUint32(),s$s=new Float32Array(s$l.slice(s$_+s$e,s$_+s$e+s$w));for(s$y._mesh._inverseBindPoses=[],s$Z=0,s$d=s$s.length;s$Z<s$d;s$Z+=16){var s$A=new s$dL(s$s[s$Z+0],s$s[s$Z+1],s$s[s$Z+2],s$s[s$Z+3],s$s[s$Z+4],s$s[s$Z+5],s$s[s$Z+6],s$s[s$Z+7],s$s[s$Z+8],s$s[s$Z+9],s$s[s$Z+10],s$s[s$Z+11],s$s[s$Z+12],s$s[s$Z+13],s$s[s$Z+14],s$s[s$Z+15]);s$y._mesh._inverseBindPoses.push(s$A)}return s$y._mesh._skinnedDatas=new Float32Array(16*s$s.length),!0},s$y.READ_SUBMESH=function(){var s$d=s$y._readData.__getBuffer(),s$L=new s$xL(s$y._mesh),s$l=s$y._readData.getInt16(),s$Z=s$y._readData.getUint32(),s$h=s$y._readData.getUint32();s$L._vertexBuffer=s$y._mesh._vertexBuffers[s$l],s$L._vertexStart=s$Z,s$L._vertexCount=s$h;var s$_=s$y._readData.getUint32(),s$N=s$y._readData.getUint32(),s$m=s$y._mesh._indexBuffer;s$L._indexBuffer=s$m,s$L._indexStart=s$_,s$L._indexCount=s$N,s$L._indices=new Uint16Array(s$m.getData().buffer,2*s$_,s$N);var s$u=s$y._DATA.offset,s$x=s$L._subIndexBufferStart,s$t=s$L._subIndexBufferCount,s$b=s$L._boneIndicesList,s$q=s$y._readData.getUint16();s$x.length=s$q,s$t.length=s$q,s$b.length=s$q;for(var s$Y=0;s$Y<s$q;s$Y++){s$x[s$Y]=s$y._readData.getUint32(),s$t[s$Y]=s$y._readData.getUint32();var s$c=s$y._readData.getUint32(),s$r=s$y._readData.getUint32();s$b[s$Y]=new Uint8Array(s$d.slice(s$u+s$c,s$u+s$c+s$r))}return s$y._subMeshes.push(s$L),!0},s$y._strings=[],s$y._readData=null,s$y._version=null,s$y._mesh=null,s$y._subMeshes=null,s$y._materialMap=null,s$b(s$y,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":s$wd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":s$kd.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":s$Pd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":s$Hd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":s$Id.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":s$Od.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":s$yd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":s$id.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":s$Rd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":s$qd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":s$td.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":s$Ad.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":s$ad.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":s$jd.vertexDeclaration,"POSITION,NORMAL,UV,UV1":s$Ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":s$Vd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":s$Cd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":s$rd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":s$Bd.vertexDeclaration,"POSITION,NORMAL,UV":s$Fd.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":s$cd.vertexDeclaration,"POSITION,NORMAL,COLOR":s$xd.vertexDeclaration,"POSITION,NORMAL,TANGENT":s$gd.vertexDeclaration,"POSITION,NORMAL":s$ud.vertexDeclaration,"POSITION,UV":s$zd.vertexDeclaration,POSITION:s$md.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":s$ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":s$kd.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":s$Pd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":s$pd.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":s$Id.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":s$$d.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":s$yd.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":s$od.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":s$Rd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":s$bd.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":s$td.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":s$sd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":s$ad.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":s$Xd.vertexDeclaration,"POSITION,NORMAL,UV,UV1":s$Ed.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":s$nd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":s$Cd.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":s$rd.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":s$Sd.vertexDeclaration,"POSITION,NORMAL,UV":s$Fd.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":s$Yd.vertexDeclaration,"POSITION,NORMAL,COLOR":s$xd.vertexDeclaration,"POSITION,NORMAL,TANGENT":s$Qd.vertexDeclaration,"POSITION,NORMAL":s$ud.vertexDeclaration,"POSITION,UV":s$zd.vertexDeclaration,POSITION:s$md.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),s$y}(),s$vd=function(){function s$m(){}return s$Y(s$m,"laya.d3.loaders.MeshReader"),s$m.read=function(s$d,s$L,s$l,s$Z,s$h){var s$_=new s$y(s$d);s$_.pos=0;var s$N=s$_.readUTFString();switch(s$N){case"LAYAMODEL:01":case"LAYASKINANI:01":s$m._readVersion01(s$_,s$N,s$L,s$l,s$Z,s$h);break;case"LAYAMODEL:02":s$Gd.parse(s$_,s$N,s$L,s$l,s$Z,s$h);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":s$Kd.parse(s$_,s$N,s$L,s$Z,s$h);break;default:throw new Error("MeshReader: unknown mesh version.")}s$L._setSubMeshes(s$Z)},s$m._readVersion01=function(s$d,s$L,s$l,s$Z,s$h,s$_){new s$Dd(s$d,s$L,s$l,s$Z,s$h,s$_)},s$m}(),s$Jd=function(){function s$d(s$d,s$L){this.min=null,this.max=null,this.min=s$d,this.max=s$L}s$Y(s$d,"laya.d3.math.BoundBox");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.getCorners=function(s$d){s$d.length=8;var s$L=this.min.elements,s$l=this.max.elements,s$Z=s$L[0],s$h=s$L[1],s$_=s$L[2],s$N=s$l[0],s$m=s$l[1],s$u=s$l[2];s$d[0]=new s$NL(s$Z,s$m,s$u),s$d[1]=new s$NL(s$N,s$m,s$u),s$d[2]=new s$NL(s$N,s$h,s$u),s$d[3]=new s$NL(s$Z,s$h,s$u),s$d[4]=new s$NL(s$Z,s$m,s$_),s$d[5]=new s$NL(s$N,s$m,s$_),s$d[6]=new s$NL(s$N,s$h,s$_),s$d[7]=new s$NL(s$Z,s$h,s$_)},s$L.toDefault=function(){this.min.toDefault(),this.max.toDefault()},s$L.cloneTo=function(s$d){var s$L=s$d;this.min.cloneTo(s$L.min),this.max.cloneTo(s$L.max)},s$L.clone=function(){var s$d=new this.constructor(new s$NL,new s$NL);return this.cloneTo(s$d),s$d},s$d.createfromPoints=function(s$d,s$L){if(null==s$d)throw new Error("points");var s$l=s$L.min,s$Z=s$L.max,s$h=s$l.elements;s$h[0]=Number.MAX_VALUE,s$h[1]=Number.MAX_VALUE,s$h[2]=Number.MAX_VALUE;var s$_=s$Z.elements;s$_[0]=-Number.MAX_VALUE,s$_[1]=-Number.MAX_VALUE,s$_[2]=-Number.MAX_VALUE;for(var s$N=0,s$m=s$d.length;s$N<s$m;++s$N)s$NL.min(s$l,s$d[s$N],s$l),s$NL.max(s$Z,s$d[s$N],s$Z)},s$d.merge=function(s$d,s$L,s$l){s$NL.min(s$d.min,s$L.min,s$l.min),s$NL.max(s$d.max,s$L.max,s$l.max)},s$d}(),s$fd=function(){function s$x(s$d){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=s$d,this._near=new s$LL(new s$NL),this._far=new s$LL(new s$NL),this._left=new s$LL(new s$NL),this._right=new s$LL(new s$NL),this._top=new s$LL(new s$NL),this._bottom=new s$LL(new s$NL),s$x._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}s$Y(s$x,"laya.d3.math.BoundFrustum");var s$d=s$x.prototype;return s$d.equalsBoundFrustum=function(s$d){return this._matrix.equalsOtherMatrix(s$d.matrix)},s$d.equalsObj=function(s$d){if(s$d instanceof laya.d3.math.BoundFrustum){var s$L=s$d;return this.equalsBoundFrustum(s$L)}return!1},s$d.getPlane=function(s$d){switch(s$d){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},s$d.getCorners=function(s$d){s$x._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(s$d[0]),s$x._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(s$d[1]),s$x._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(s$d[2]),s$x._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(s$d[3]),s$x._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(s$d[4]),s$x._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(s$d[5]),s$x._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(s$d[6]),s$x._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(s$d[7])},s$d.containsPoint=function(s$d){for(var s$L=s$LL.PlaneIntersectionType_Front,s$l=s$LL.PlaneIntersectionType_Front,s$Z=0;s$Z<6;s$Z++){switch(s$Z){case 0:s$l=Collision.intersectsPlaneAndPoint(this._near,s$d);break;case 1:s$l=Collision.intersectsPlaneAndPoint(this._far,s$d);break;case 2:s$l=Collision.intersectsPlaneAndPoint(this._left,s$d);break;case 3:s$l=Collision.intersectsPlaneAndPoint(this._right,s$d);break;case 4:s$l=Collision.intersectsPlaneAndPoint(this._top,s$d);break;case 5:s$l=Collision.intersectsPlaneAndPoint(this._bottom,s$d)}switch(s$l){case s$LL.PlaneIntersectionType_Back:return 0;case s$LL.PlaneIntersectionType_Intersecting:s$L=s$LL.PlaneIntersectionType_Intersecting}}switch(s$L){case s$LL.PlaneIntersectionType_Intersecting:return 2;default:return 1}},s$d.containsBoundBox=function(s$d){for(var s$L,s$l=s$x._tempV30,s$Z=s$x._tempV31,s$h=1,s$_=0;s$_<6;s$_++){if(s$L=this.getPlane(s$_),this._getBoxToPlanePVertexNVertex(s$d,s$L.normal,s$l,s$Z),Collision.intersectsPlaneAndPoint(s$L,s$l)===s$LL.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(s$L,s$Z)===s$LL.PlaneIntersectionType_Back&&(s$h=2)}return s$h},s$d.containsBoundSphere=function(s$d){for(var s$L=s$LL.PlaneIntersectionType_Front,s$l=s$LL.PlaneIntersectionType_Front,s$Z=0;s$Z<6;s$Z++){switch(s$Z){case 0:s$l=Collision.intersectsPlaneAndSphere(this._near,s$d);break;case 1:s$l=Collision.intersectsPlaneAndSphere(this._far,s$d);break;case 2:s$l=Collision.intersectsPlaneAndSphere(this._left,s$d);break;case 3:s$l=Collision.intersectsPlaneAndSphere(this._right,s$d);break;case 4:s$l=Collision.intersectsPlaneAndSphere(this._top,s$d);break;case 5:s$l=Collision.intersectsPlaneAndSphere(this._bottom,s$d)}switch(s$l){case s$LL.PlaneIntersectionType_Back:return 0;case s$LL.PlaneIntersectionType_Intersecting:s$L=s$LL.PlaneIntersectionType_Intersecting}}switch(s$L){case s$LL.PlaneIntersectionType_Intersecting:return 2;default:return 1}},s$d._getBoxToPlanePVertexNVertex=function(s$d,s$L,s$l,s$Z){var s$h=s$d.min,s$_=s$h.elements,s$N=s$d.max,s$m=s$N.elements,s$u=s$L.elements,s$x=s$u[0],s$t=s$u[1],s$b=s$u[2];s$h.cloneTo(s$l);var s$q=s$l.elements;0<=s$x&&(s$q[0]=s$m[0]),0<=s$t&&(s$q[1]=s$m[1]),0<=s$b&&(s$q[2]=s$m[2]),s$N.cloneTo(s$Z);var s$Y=s$Z.elements;0<=s$x&&(s$Y[0]=s$_[0]),0<=s$t&&(s$Y[1]=s$_[1]),0<=s$b&&(s$Y[2]=s$_[2])},s$c(0,s$d,"top",function(){return this._top}),s$c(0,s$d,"matrix",function(){return this._matrix},function(s$d){this._matrix=s$d,s$x._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),s$c(0,s$d,"near",function(){return this._near}),s$c(0,s$d,"far",function(){return this._far}),s$c(0,s$d,"left",function(){return this._left}),s$c(0,s$d,"right",function(){return this._right}),s$c(0,s$d,"bottom",function(){return this._bottom}),s$x._getPlanesFromMatrix=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m=s$d.elements,s$u=s$m[0],s$x=s$m[1],s$t=s$m[2],s$b=s$m[3],s$q=s$m[4],s$Y=s$m[5],s$c=s$m[6],s$r=s$m[7],s$a=s$m[8],s$k=s$m[9],s$e=s$m[10],s$w=s$m[11],s$s=s$m[12],s$A=s$m[13],s$y=s$m[14],s$$=s$m[15],s$O=s$L.normal.elements;s$O[0]=s$b+s$t,s$O[1]=s$r+s$c,s$O[2]=s$w+s$e,s$L.distance=s$$+s$y,s$L.normalize();var s$n=s$l.normal.elements;s$n[0]=s$b-s$t,s$n[1]=s$r-s$c,s$n[2]=s$w-s$e,s$l.distance=s$$-s$y,s$l.normalize();var s$V=s$Z.normal.elements;s$V[0]=s$b+s$u,s$V[1]=s$r+s$q,s$V[2]=s$w+s$a,s$Z.distance=s$$+s$s,s$Z.normalize();var s$Q=s$h.normal.elements;s$Q[0]=s$b-s$u,s$Q[1]=s$r-s$q,s$Q[2]=s$w-s$a,s$h.distance=s$$-s$s,s$h.normalize();var s$g=s$_.normal.elements;s$g[0]=s$b-s$x,s$g[1]=s$r-s$Y,s$g[2]=s$w-s$k,s$_.distance=s$$-s$A,s$_.normalize();var s$F=s$N.normal.elements;s$F[0]=s$b+s$x,s$F[1]=s$r+s$Y,s$F[2]=s$w+s$k,s$N.distance=s$$+s$A,s$N.normalize()},s$x._get3PlaneInterPoint=function(s$d,s$L,s$l){var s$Z=s$d.normal,s$h=s$L.normal,s$_=s$l.normal;s$NL.cross(s$h,s$_,s$x._tempV30),s$NL.cross(s$_,s$Z,s$x._tempV31),s$NL.cross(s$Z,s$h,s$x._tempV32);var s$N=s$NL.dot(s$Z,s$x._tempV30),s$m=s$NL.dot(s$h,s$x._tempV31),s$u=s$NL.dot(s$_,s$x._tempV32);return s$NL.scale(s$x._tempV30,-s$d.distance/s$N,s$x._tempV33),s$NL.scale(s$x._tempV31,-s$L.distance/s$m,s$x._tempV34),s$NL.scale(s$x._tempV32,-s$l.distance/s$u,s$x._tempV35),s$NL.add(s$x._tempV33,s$x._tempV34,s$x._tempV36),s$NL.add(s$x._tempV35,s$x._tempV36,s$x._tempV37),s$x._tempV37},s$b(s$x,["_tempV30",function(){return this._tempV30=new s$NL},"_tempV31",function(){return this._tempV31=new s$NL},"_tempV32",function(){return this._tempV32=new s$NL},"_tempV33",function(){return this._tempV33=new s$NL},"_tempV34",function(){return this._tempV34=new s$NL},"_tempV35",function(){return this._tempV35=new s$NL},"_tempV36",function(){return this._tempV36=new s$NL},"_tempV37",function(){return this._tempV37=new s$NL}]),s$x}(),s$Ud=function(){function s$t(s$d,s$L){this.center=null,this.radius=NaN,this.center=s$d,this.radius=s$L}s$Y(s$t,"laya.d3.math.BoundSphere");var s$d=s$t.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.toDefault=function(){this.center.toDefault(),this.radius=0},s$d.intersectsRayDistance=function(s$d){return Collision.intersectsRayAndSphereRD(s$d,this)},s$d.intersectsRayPoint=function(s$d,s$L){return Collision.intersectsRayAndSphereRP(s$d,this,s$L)},s$d.cloneTo=function(s$d){var s$L=s$d;this.center.cloneTo(s$L.center),s$L.radius=this.radius},s$d.clone=function(){var s$d=new this.constructor(new s$NL,new s$NL);return this.cloneTo(s$d),s$d},s$t.createFromSubPoints=function(s$d,s$L,s$l,s$Z){if(null==s$d)throw new Error("points");if(s$L<0||s$L>=s$d.length)throw new Error("start"+s$L+"Must be in the range [0, "+(s$d.length-1)+"]");if(s$l<0||s$L+s$l>s$d.length)throw new Error("count"+s$l+"Must be in the range <= "+s$d.length+"}");var s$h=s$L+s$l,s$_=s$t._tempVector3;s$_.elements[0]=0,s$_.elements[1]=0,s$_.elements[2]=0;for(var s$N=s$L;s$N<s$h;++s$N)s$NL.add(s$d[s$N],s$_,s$_);var s$m=s$Z.center;s$NL.scale(s$_,1/s$l,s$m);var s$u=0;for(s$N=s$L;s$N<s$h;++s$N){var s$x=s$NL.distanceSquared(s$m,s$d[s$N]);s$u<s$x&&(s$u=s$x)}s$Z.radius=Math.sqrt(s$u)},s$t.createfromPoints=function(s$d,s$L){if(null==s$d)throw new Error("points");s$t.createFromSubPoints(s$d,0,s$d.length,s$L)},s$b(s$t,["_tempVector3",function(){return this._tempVector3=new s$NL}]),s$t}(),s$Wd=(function(){function s$d(){}s$Y(s$d,"laya.d3.math.ContainmentType"),s$d.Disjoint=0,s$d.Contains=1,s$d.Intersects=2}(),function(){function s$l(){}return s$Y(s$l,"laya.d3.math.MathUtils3D"),s$l.isZero=function(s$d){return Math.abs(s$d)<s$l.zeroTolerance},s$l.nearEqual=function(s$d,s$L){return!!s$l.isZero(s$d-s$L)},s$l.fastInvSqrt=function(s$d){return s$l.isZero(s$d)?s$d:1/Math.sqrt(s$d)},s$b(s$l,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),s$l}()),s$Md=function(){function s$u(){var s$d=this.elements=new Float32Array(9);s$d[0]=1,s$d[1]=0,s$d[2]=0,s$d[3]=0,s$d[4]=1,s$d[5]=0,s$d[6]=0,s$d[7]=0,s$d[8]=1}s$Y(s$u,"laya.d3.math.Matrix3x3");var s$d=s$u.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.determinant=function(){var s$d=this.elements,s$L=s$d[0],s$l=s$d[1],s$Z=s$d[2],s$h=s$d[3],s$_=s$d[4],s$N=s$d[5],s$m=s$d[6],s$u=s$d[7],s$x=s$d[8];return s$L*(s$x*s$_-s$N*s$u)+s$l*(-s$x*s$h+s$N*s$m)+s$Z*(s$u*s$h-s$_*s$m)},s$d.translate=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements,s$h=s$d.elements,s$_=s$Z[0],s$N=s$Z[1],s$m=s$Z[2],s$u=s$Z[3],s$x=s$Z[4],s$t=s$Z[5],s$b=s$Z[6],s$q=s$Z[7],s$Y=s$Z[8],s$c=s$h[0],s$r=s$h[1];s$l[0]=s$_,s$l[1]=s$N,s$l[2]=s$m,s$l[3]=s$u,s$l[4]=s$x,s$l[5]=s$t,s$l[6]=s$c*s$_+s$r*s$u+s$b,s$l[7]=s$c*s$N+s$r*s$x+s$q,s$l[8]=s$c*s$m+s$r*s$t+s$Y},s$d.rotate=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=s$Z[4],s$x=s$Z[5],s$t=s$Z[6],s$b=s$Z[7],s$q=s$Z[8],s$Y=Math.sin(s$d),s$c=Math.cos(s$d);s$l[0]=s$c*s$h+s$Y*s$m,s$l[1]=s$c*s$_+s$Y*s$u,s$l[2]=s$c*s$N+s$Y*s$x,s$l[3]=s$c*s$m-s$Y*s$h,s$l[4]=s$c*s$u-s$Y*s$_,s$l[5]=s$c*s$x-s$Y*s$N,s$l[6]=s$t,s$l[7]=s$b,s$l[8]=s$q},s$d.scale=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements,s$h=s$d.elements,s$_=s$h[0],s$N=s$h[1];s$l[0]=s$_*s$Z[0],s$l[1]=s$_*s$Z[1],s$l[2]=s$_*s$Z[2],s$l[3]=s$N*s$Z[3],s$l[4]=s$N*s$Z[4],s$l[5]=s$N*s$Z[5],s$l[6]=s$Z[6],s$l[7]=s$Z[7],s$l[8]=s$Z[8]},s$d.invert=function(s$d){var s$L=s$d.elements,s$l=this.elements,s$Z=s$l[0],s$h=s$l[1],s$_=s$l[2],s$N=s$l[3],s$m=s$l[4],s$u=s$l[5],s$x=s$l[6],s$t=s$l[7],s$b=s$l[8],s$q=s$b*s$m-s$u*s$t,s$Y=-s$b*s$N+s$u*s$x,s$c=s$t*s$N-s$m*s$x,s$r=s$Z*s$q+s$h*s$Y+s$_*s$c;s$r||(s$d=null),s$r=1/s$r,s$L[0]=s$q*s$r,s$L[1]=(-s$b*s$h+s$_*s$t)*s$r,s$L[2]=(s$u*s$h-s$_*s$m)*s$r,s$L[3]=s$Y*s$r,s$L[4]=(s$b*s$Z-s$_*s$x)*s$r,s$L[5]=(-s$u*s$Z+s$_*s$N)*s$r,s$L[6]=s$c*s$r,s$L[7]=(-s$t*s$Z+s$h*s$x)*s$r,s$L[8]=(s$m*s$Z-s$h*s$N)*s$r},s$d.transpose=function(s$d){var s$L=s$d.elements,s$l=this.elements;if(s$d===this){var s$Z=s$l[1],s$h=s$l[2],s$_=s$l[5];s$L[1]=s$l[3],s$L[2]=s$l[6],s$L[3]=s$Z,s$L[5]=s$l[7],s$L[6]=s$h,s$L[7]=s$_}else s$L[0]=s$l[0],s$L[1]=s$l[3],s$L[2]=s$l[6],s$L[3]=s$l[1],s$L[4]=s$l[4],s$L[5]=s$l[7],s$L[6]=s$l[2],s$L[7]=s$l[5],s$L[8]=s$l[8]},s$d.identity=function(){var s$d=this.elements;s$d[0]=1,s$d[1]=0,s$d[2]=0,s$d[3]=0,s$d[4]=1,s$d[5]=0,s$d[6]=0,s$d[7]=0,s$d[8]=1},s$d.cloneTo=function(s$d){var s$L,s$l,s$Z;if((s$l=this.elements)!==(s$Z=s$d.elements))for(s$L=0;s$L<9;++s$L)s$Z[s$L]=s$l[s$L]},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$u.createFromTranslation=function(s$d,s$L){s$L.elements;var s$l=s$d.elements;s$L[0]=1,s$L[1]=0,s$L[2]=0,s$L[3]=0,s$L[4]=1,s$L[5]=0,s$L[6]=s$l[0],s$L[7]=s$l[1],s$L[8]=1},s$u.createFromRotation=function(s$d,s$L){var s$l=s$L.elements,s$Z=Math.sin(s$d),s$h=Math.cos(s$d);s$l[0]=s$h,s$l[1]=s$Z,s$l[2]=0,s$l[3]=-s$Z,s$l[4]=s$h,s$l[5]=0,s$l[6]=0,s$l[7]=0,s$l[8]=1},s$u.createFromScaling=function(s$d,s$L){var s$l=s$L.elements,s$Z=s$d.elements;s$l[0]=s$Z[0],s$l[1]=0,s$l[2]=0,s$l[3]=0,s$l[4]=s$Z[1],s$l[5]=0,s$l[6]=0,s$l[7]=0,s$l[8]=1},s$u.createFromMatrix4x4=function(s$d,s$L){s$L[0]=s$d[0],s$L[1]=s$d[1],s$L[2]=s$d[2],s$L[3]=s$d[4],s$L[4]=s$d[5],s$L[5]=s$d[6],s$L[6]=s$d[8],s$L[7]=s$d[9],s$L[8]=s$d[10]},s$u.multiply=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements,s$N=s$h[0],s$m=s$h[1],s$u=s$h[2],s$x=s$h[3],s$t=s$h[4],s$b=s$h[5],s$q=s$h[6],s$Y=s$h[7],s$c=s$h[8],s$r=s$_[0],s$a=s$_[1],s$k=s$_[2],s$e=s$_[3],s$w=s$_[4],s$s=s$_[5],s$A=s$_[6],s$y=s$_[7],s$$=s$_[8];s$Z[0]=s$r*s$N+s$a*s$x+s$k*s$q,s$Z[1]=s$r*s$m+s$a*s$t+s$k*s$Y,s$Z[2]=s$r*s$u+s$a*s$b+s$k*s$c,s$Z[3]=s$e*s$N+s$w*s$x+s$s*s$q,s$Z[4]=s$e*s$m+s$w*s$t+s$s*s$Y,s$Z[5]=s$e*s$u+s$w*s$b+s$s*s$c,s$Z[6]=s$A*s$N+s$y*s$x+s$$*s$q,s$Z[7]=s$A*s$m+s$y*s$t+s$$*s$Y,s$Z[8]=s$A*s$u+s$y*s$b+s$$*s$c},s$u.lookAt=function(s$d,s$L,s$l,s$Z){s$NL.subtract(s$d,s$L,s$u._tempV30),s$NL.normalize(s$u._tempV30,s$u._tempV30),s$NL.cross(s$l,s$u._tempV30,s$u._tempV31),s$NL.normalize(s$u._tempV31,s$u._tempV31),s$NL.cross(s$u._tempV30,s$u._tempV31,s$u._tempV32);var s$h=s$u._tempV30.elements,s$_=s$u._tempV31.elements,s$N=s$u._tempV32.elements,s$m=s$Z.elements;s$m[0]=s$_[0],s$m[3]=s$_[1],s$m[6]=s$_[2],s$m[1]=s$N[0],s$m[4]=s$N[1],s$m[7]=s$N[2],s$m[2]=s$h[0],s$m[5]=s$h[1],s$m[8]=s$h[2]},s$u.DEFAULT=new s$u,s$b(s$u,["_tempV30",function(){return this._tempV30=new s$NL},"_tempV31",function(){return this._tempV31=new s$NL},"_tempV32",function(){return this._tempV32=new s$NL}]),s$u}(),s$dL=function(){function s$n(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b,s$q,s$Y,s$c,s$r){void 0===s$d&&(s$d=1),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=1),void 0===s$N&&(s$N=0),void 0===s$m&&(s$m=0),void 0===s$u&&(s$u=0),void 0===s$x&&(s$x=0),void 0===s$t&&(s$t=1),void 0===s$b&&(s$b=0),void 0===s$q&&(s$q=0),void 0===s$Y&&(s$Y=0),void 0===s$c&&(s$c=0),void 0===s$r&&(s$r=1);var s$a=this.elements=new Float32Array(16);s$a[0]=s$d,s$a[1]=s$L,s$a[2]=s$l,s$a[3]=s$Z,s$a[4]=s$h,s$a[5]=s$_,s$a[6]=s$N,s$a[7]=s$m,s$a[8]=s$u,s$a[9]=s$x,s$a[10]=s$t,s$a[11]=s$b,s$a[12]=s$q,s$a[13]=s$Y,s$a[14]=s$c,s$a[15]=s$r}s$Y(s$n,"laya.d3.math.Matrix4x4");var s$d=s$n.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.getElementByRowColumn=function(s$d,s$L){if(s$d<0||3<s$d)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(s$L<0||3<s$L)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*s$d+s$L]},s$d.setElementByRowColumn=function(s$d,s$L,s$l){if(s$d<0||3<s$d)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(s$L<0||3<s$L)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*s$d+s$L]=s$l},s$d.equalsOtherMatrix=function(s$d){var s$L=this.elements,s$l=s$d.elements;return s$Wd.nearEqual(s$L[0],s$l[0])&&s$Wd.nearEqual(s$L[1],s$l[1])&&s$Wd.nearEqual(s$L[2],s$l[2])&&s$Wd.nearEqual(s$L[3],s$l[3])&&s$Wd.nearEqual(s$L[4],s$l[4])&&s$Wd.nearEqual(s$L[5],s$l[5])&&s$Wd.nearEqual(s$L[6],s$l[6])&&s$Wd.nearEqual(s$L[7],s$l[7])&&s$Wd.nearEqual(s$L[8],s$l[8])&&s$Wd.nearEqual(s$L[9],s$l[9])&&s$Wd.nearEqual(s$L[10],s$l[10])&&s$Wd.nearEqual(s$L[11],s$l[11])&&s$Wd.nearEqual(s$L[12],s$l[12])&&s$Wd.nearEqual(s$L[13],s$l[13])&&s$Wd.nearEqual(s$L[14],s$l[14])&&s$Wd.nearEqual(s$L[15],s$l[15])},s$d.decomposeTransRotScale=function(s$d,s$L,s$l){var s$Z=s$n._tempMatrix4x4;return this.decomposeTransRotMatScale(s$d,s$Z,s$l)?(s$lL.createFromMatrix4x4(s$Z,s$L),!0):(s$L.identity(),!1)},s$d.decomposeTransRotMatScale=function(s$d,s$L,s$l){var s$Z=this.elements,s$h=s$d.elements,s$_=s$L.elements,s$N=s$l.elements;s$h[0]=s$Z[12],s$h[1]=s$Z[13],s$h[2]=s$Z[14];var s$m=s$Z[0],s$u=s$Z[1],s$x=s$Z[2],s$t=s$Z[4],s$b=s$Z[5],s$q=s$Z[6],s$Y=s$Z[8],s$c=s$Z[9],s$r=s$Z[10],s$a=s$N[0]=Math.sqrt(s$m*s$m+s$u*s$u+s$x*s$x),s$k=s$N[1]=Math.sqrt(s$t*s$t+s$b*s$b+s$q*s$q),s$e=s$N[2]=Math.sqrt(s$Y*s$Y+s$c*s$c+s$r*s$r);if(s$Wd.isZero(s$a)||s$Wd.isZero(s$k)||s$Wd.isZero(s$e))return s$_[1]=s$_[2]=s$_[3]=s$_[4]=s$_[6]=s$_[7]=s$_[8]=s$_[9]=s$_[11]=s$_[12]=s$_[13]=s$_[14]=0,s$_[0]=s$_[5]=s$_[10]=s$_[15]=1,!1;var s$w=s$n._tempVector0,s$s=s$w.elements;s$s[0]=s$Y/s$e,s$s[1]=s$c/s$e,s$s[2]=s$r/s$e;var s$A=s$n._tempVector1,s$y=s$A.elements;s$y[0]=s$m/s$a,s$y[1]=s$u/s$a,s$y[2]=s$x/s$a;var s$$=s$n._tempVector2;s$NL.cross(s$w,s$A,s$$);var s$O=s$n._tempVector1;return s$NL.cross(s$$,s$w,s$O),s$_[3]=s$_[7]=s$_[11]=s$_[12]=s$_[13]=s$_[14]=0,s$_[15]=1,s$_[0]=s$O.x,s$_[1]=s$O.y,s$_[2]=s$O.z,s$_[4]=s$$.x,s$_[5]=s$$.y,s$_[6]=s$$.z,s$_[8]=s$w.x,s$_[9]=s$w.y,s$_[10]=s$w.z,s$_[0]*s$m+s$_[1]*s$u+s$_[2]*s$x<0&&(s$N[0]=-s$a),s$_[4]*s$t+s$_[5]*s$b+s$_[6]*s$q<0&&(s$N[1]=-s$k),s$_[8]*s$Y+s$_[9]*s$c+s$_[10]*s$r<0&&(s$N[2]=-s$e),!0},s$d.decomposeYawPitchRoll=function(s$d){var s$L=s$d.elements,s$l=Math.asin(-this.elements[9]);s$L[1]=s$l,Math.cos(s$l)>s$Wd.zeroTolerance?(s$L[2]=Math.atan2(this.elements[1],this.elements[5]),s$L[0]=Math.atan2(this.elements[8],this.elements[10])):(s$L[2]=Math.atan2(-this.elements[4],this.elements[0]),s$L[0]=0)},s$d.normalize=function(){var s$d=this.elements,s$L=s$d[0],s$l=s$d[1],s$Z=s$d[2],s$h=Math.sqrt(s$L*s$L+s$l*s$l+s$Z*s$Z);if(!s$h)return s$d[0]=0,s$d[1]=0,void(s$d[2]=0);1!=s$h&&(s$h=1/s$h,s$d[0]=s$L*s$h,s$d[1]=s$l*s$h,s$d[2]=s$Z*s$h)},s$d.transpose=function(){var s$d,s$L;return s$L=(s$d=this.elements)[1],s$d[1]=s$d[4],s$d[4]=s$L,s$L=s$d[2],s$d[2]=s$d[8],s$d[8]=s$L,s$L=s$d[3],s$d[3]=s$d[12],s$d[12]=s$L,s$L=s$d[6],s$d[6]=s$d[9],s$d[9]=s$L,s$L=s$d[7],s$d[7]=s$d[13],s$d[13]=s$L,s$L=s$d[11],s$d[11]=s$d[14],s$d[14]=s$L,this},s$d.invert=function(s$d){var s$L=this.elements,s$l=s$d.elements,s$Z=s$L[0],s$h=s$L[1],s$_=s$L[2],s$N=s$L[3],s$m=s$L[4],s$u=s$L[5],s$x=s$L[6],s$t=s$L[7],s$b=s$L[8],s$q=s$L[9],s$Y=s$L[10],s$c=s$L[11],s$r=s$L[12],s$a=s$L[13],s$k=s$L[14],s$e=s$L[15],s$w=s$Z*s$u-s$h*s$m,s$s=s$Z*s$x-s$_*s$m,s$A=s$Z*s$t-s$N*s$m,s$y=s$h*s$x-s$_*s$u,s$$=s$h*s$t-s$N*s$u,s$O=s$_*s$t-s$N*s$x,s$n=s$b*s$a-s$q*s$r,s$V=s$b*s$k-s$Y*s$r,s$Q=s$b*s$e-s$c*s$r,s$g=s$q*s$k-s$Y*s$a,s$F=s$q*s$e-s$c*s$a,s$E=s$Y*s$e-s$c*s$k,s$I=s$w*s$E-s$s*s$F+s$A*s$g+s$y*s$Q-s$$*s$V+s$O*s$n;0!==Math.abs(s$I)&&(s$I=1/s$I,s$l[0]=(s$u*s$E-s$x*s$F+s$t*s$g)*s$I,s$l[1]=(s$_*s$F-s$h*s$E-s$N*s$g)*s$I,s$l[2]=(s$a*s$O-s$k*s$$+s$e*s$y)*s$I,s$l[3]=(s$Y*s$$-s$q*s$O-s$c*s$y)*s$I,s$l[4]=(s$x*s$Q-s$m*s$E-s$t*s$V)*s$I,s$l[5]=(s$Z*s$E-s$_*s$Q+s$N*s$V)*s$I,s$l[6]=(s$k*s$A-s$r*s$O-s$e*s$s)*s$I,s$l[7]=(s$b*s$O-s$Y*s$A+s$c*s$s)*s$I,s$l[8]=(s$m*s$F-s$u*s$Q+s$t*s$n)*s$I,s$l[9]=(s$h*s$Q-s$Z*s$F-s$N*s$n)*s$I,s$l[10]=(s$r*s$$-s$a*s$A+s$e*s$w)*s$I,s$l[11]=(s$q*s$A-s$b*s$$-s$c*s$w)*s$I,s$l[12]=(s$u*s$V-s$m*s$g-s$x*s$n)*s$I,s$l[13]=(s$Z*s$g-s$h*s$V+s$_*s$n)*s$I,s$l[14]=(s$a*s$s-s$r*s$y-s$k*s$w)*s$I,s$l[15]=(s$b*s$y-s$q*s$s+s$Y*s$w)*s$I)},s$d.identity=function(){var s$d=this.elements;s$d[1]=s$d[2]=s$d[3]=s$d[4]=s$d[6]=s$d[7]=s$d[8]=s$d[9]=s$d[11]=s$d[12]=s$d[13]=s$d[14]=0,s$d[0]=s$d[5]=s$d[10]=s$d[15]=1},s$d.cloneTo=function(s$d){var s$L,s$l,s$Z;if((s$l=this.elements)!==(s$Z=s$d.elements))for(s$L=0;s$L<16;++s$L)s$Z[s$L]=s$l[s$L]},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$d.getTranslationVector=function(s$d){var s$L=this.elements,s$l=s$d.elements;s$l[0]=s$L[12],s$l[1]=s$L[13],s$l[2]=s$L[14]},s$d.setTranslationVector=function(s$d){var s$L=this.elements,s$l=s$d.elements;s$L[12]=s$l[0],s$L[13]=s$l[1],s$L[14]=s$l[2]},s$d.getForward=function(s$d){var s$L=this.elements,s$l=s$d.elements;s$l[0]=-s$L[8],s$l[1]=-s$L[9],s$l[2]=-s$L[10]},s$d.setForward=function(s$d){var s$L=this.elements,s$l=s$d.elements;s$L[8]=-s$l[0],s$L[9]=-s$l[1],s$L[10]=-s$l[2]},s$n.createRotationX=function(s$d,s$L){var s$l=s$L.elements,s$Z=Math.sin(s$d),s$h=Math.cos(s$d);s$l[1]=s$l[2]=s$l[3]=s$l[4]=s$l[7]=s$l[8]=s$l[11]=s$l[12]=s$l[13]=s$l[14]=0,s$l[0]=s$l[15]=1,s$l[5]=s$l[10]=s$h,s$l[6]=s$Z,s$l[9]=-s$Z},s$n.createRotationY=function(s$d,s$L){var s$l=s$L.elements,s$Z=Math.sin(s$d),s$h=Math.cos(s$d);s$l[1]=s$l[3]=s$l[4]=s$l[6]=s$l[7]=s$l[9]=s$l[11]=s$l[12]=s$l[13]=s$l[14]=0,s$l[5]=s$l[15]=1,s$l[0]=s$l[10]=s$h,s$l[2]=-s$Z,s$l[8]=s$Z},s$n.createRotationZ=function(s$d,s$L){var s$l=s$L.elements,s$Z=Math.sin(s$d),s$h=Math.cos(s$d);s$l[2]=s$l[3]=s$l[6]=s$l[7]=s$l[8]=s$l[9]=s$l[11]=s$l[12]=s$l[13]=s$l[14]=0,s$l[10]=s$l[15]=1,s$l[0]=s$l[5]=s$h,s$l[1]=s$Z,s$l[4]=-s$Z},s$n.createRotationYawPitchRoll=function(s$d,s$L,s$l,s$Z){s$lL.createFromYawPitchRoll(s$d,s$L,s$l,s$n._tempQuaternion),s$n.createRotationQuaternion(s$n._tempQuaternion,s$Z)},s$n.createRotationAxis=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=Math.cos(s$L),s$u=Math.sin(s$L),s$x=s$h*s$h,s$t=s$_*s$_,s$b=s$N*s$N,s$q=s$h*s$_,s$Y=s$h*s$N,s$c=s$_*s$N,s$r=s$l.elements;s$r[3]=s$r[7]=s$r[11]=s$r[12]=s$r[13]=s$r[14]=0,s$r[15]=1,s$r[0]=s$x+s$m*(1-s$x),s$r[1]=s$q-s$m*s$q+s$u*s$N,s$r[2]=s$Y-s$m*s$Y-s$u*s$_,s$r[4]=s$q-s$m*s$q-s$u*s$N,s$r[5]=s$t+s$m*(1-s$t),s$r[6]=s$c-s$m*s$c+s$u*s$h,s$r[8]=s$Y-s$m*s$Y+s$u*s$_,s$r[9]=s$c-s$m*s$c-s$u*s$h,s$r[10]=s$b+s$m*(1-s$b)},s$n.createRotationQuaternion=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0],s$_=s$l[1],s$N=s$l[2],s$m=s$l[3],s$u=s$h*s$h,s$x=s$_*s$_,s$t=s$N*s$N,s$b=s$h*s$_,s$q=s$N*s$m,s$Y=s$N*s$h,s$c=s$_*s$m,s$r=s$_*s$N,s$a=s$h*s$m;s$Z[3]=s$Z[7]=s$Z[11]=s$Z[12]=s$Z[13]=s$Z[14]=0,s$Z[15]=1,s$Z[0]=1-2*(s$x+s$t),s$Z[1]=2*(s$b+s$q),s$Z[2]=2*(s$Y-s$c),s$Z[4]=2*(s$b-s$q),s$Z[5]=1-2*(s$t+s$u),s$Z[6]=2*(s$r+s$a),s$Z[8]=2*(s$Y+s$c),s$Z[9]=2*(s$r-s$a),s$Z[10]=1-2*(s$x+s$u)},s$n.createTranslate=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;s$Z[4]=s$Z[8]=s$Z[1]=s$Z[9]=s$Z[2]=s$Z[6]=s$Z[3]=s$Z[7]=s$Z[11]=0,s$Z[0]=s$Z[5]=s$Z[10]=s$Z[15]=1,s$Z[12]=s$l[0],s$Z[13]=s$l[1],s$Z[14]=s$l[2]},s$n.createScaling=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;s$Z[0]=s$l[0],s$Z[5]=s$l[1],s$Z[10]=s$l[2],s$Z[1]=s$Z[4]=s$Z[8]=s$Z[12]=s$Z[9]=s$Z[13]=s$Z[2]=s$Z[6]=s$Z[14]=s$Z[3]=s$Z[7]=s$Z[11]=0,s$Z[15]=1},s$n.multiply=function(s$d,s$L,s$l){var s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t;for(s$h=s$l.elements,s$_=s$d.elements,s$h===(s$N=s$L.elements)&&(s$N=s$N.slice()),s$Z=0;s$Z<4;s$Z++)s$m=s$_[s$Z],s$u=s$_[s$Z+4],s$x=s$_[s$Z+8],s$t=s$_[s$Z+12],s$h[s$Z]=s$m*s$N[0]+s$u*s$N[1]+s$x*s$N[2]+s$t*s$N[3],s$h[s$Z+4]=s$m*s$N[4]+s$u*s$N[5]+s$x*s$N[6]+s$t*s$N[7],s$h[s$Z+8]=s$m*s$N[8]+s$u*s$N[9]+s$x*s$N[10]+s$t*s$N[11],s$h[s$Z+12]=s$m*s$N[12]+s$u*s$N[13]+s$x*s$N[14]+s$t*s$N[15]},s$n.createFromQuaternion=function(s$d,s$L){var s$l=s$L.elements,s$Z=s$d.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=s$h+s$h,s$x=s$_+s$_,s$t=s$N+s$N,s$b=s$h*s$u,s$q=s$_*s$u,s$Y=s$_*s$x,s$c=s$N*s$u,s$r=s$N*s$x,s$a=s$N*s$t,s$k=s$m*s$u,s$e=s$m*s$x,s$w=s$m*s$t;s$l[0]=1-s$Y-s$a,s$l[1]=s$q+s$w,s$l[2]=s$c-s$e,s$l[3]=0,s$l[4]=s$q-s$w,s$l[5]=1-s$b-s$a,s$l[6]=s$r+s$k,s$l[7]=0,s$l[8]=s$c+s$e,s$l[9]=s$r-s$k,s$l[10]=1-s$b-s$Y,s$l[11]=0,s$l[12]=0,s$l[13]=0,s$l[14]=0,s$l[15]=1},s$n.createAffineTransformation=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements,s$_=s$L.elements,s$N=s$l.elements,s$m=s$Z.elements,s$u=s$_[0],s$x=s$_[1],s$t=s$_[2],s$b=s$_[3],s$q=s$u+s$u,s$Y=s$x+s$x,s$c=s$t+s$t,s$r=s$u*s$q,s$a=s$u*s$Y,s$k=s$u*s$c,s$e=s$x*s$Y,s$w=s$x*s$c,s$s=s$t*s$c,s$A=s$b*s$q,s$y=s$b*s$Y,s$$=s$b*s$c,s$O=s$N[0],s$n=s$N[1],s$V=s$N[2];s$m[0]=(1-(s$e+s$s))*s$O,s$m[1]=(s$a+s$$)*s$O,s$m[2]=(s$k-s$y)*s$O,s$m[3]=0,s$m[4]=(s$a-s$$)*s$n,s$m[5]=(1-(s$r+s$s))*s$n,s$m[6]=(s$w+s$A)*s$n,s$m[7]=0,s$m[8]=(s$k+s$y)*s$V,s$m[9]=(s$w-s$A)*s$V,s$m[10]=(1-(s$r+s$e))*s$V,s$m[11]=0,s$m[12]=s$h[0],s$m[13]=s$h[1],s$m[14]=s$h[2],s$m[15]=1},s$n.createLookAt=function(s$d,s$L,s$l,s$Z){var s$h=s$Z.elements,s$_=s$n._tempVector0,s$N=s$n._tempVector1,s$m=s$n._tempVector2;s$NL.subtract(s$d,s$L,s$m),s$NL.normalize(s$m,s$m),s$NL.cross(s$l,s$m,s$_),s$NL.normalize(s$_,s$_),s$NL.cross(s$m,s$_,s$N),s$Z.identity(),s$h[0]=s$_.x,s$h[4]=s$_.y,s$h[8]=s$_.z,s$h[1]=s$N.x,s$h[5]=s$N.y,s$h[9]=s$N.z,s$h[2]=s$m.x,s$h[6]=s$m.y,s$h[10]=s$m.z,s$h[12]=-s$NL.dot(s$_,s$d),s$h[13]=-s$NL.dot(s$N,s$d),s$h[14]=-s$NL.dot(s$m,s$d)},s$n.createPerspective=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$h.elements,s$N=1/Math.tan(s$d/2),s$m=1/(s$l-s$Z);s$_[0]=s$N/s$L,s$_[5]=s$N,s$_[10]=(s$Z+s$l)*s$m,s$_[11]=-1,s$_[14]=2*s$Z*s$l*s$m,s$_[1]=s$_[2]=s$_[3]=s$_[4]=s$_[6]=s$_[7]=s$_[8]=s$_[9]=s$_[12]=s$_[13]=s$_[15]=0},s$n.createOrthoOffCenterRH=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m=s$N.elements,s$u=1/(s$d-s$L),s$x=1/(s$l-s$Z),s$t=1/(s$h-s$_);s$m[1]=s$m[2]=s$m[3]=s$m[4]=s$m[6]=s$m[7]=s$m[8]=s$m[9]=s$m[11]=0,s$m[15]=1,s$m[0]=-2*s$u,s$m[5]=-2*s$x,s$m[10]=2*s$t,s$m[12]=(s$d+s$L)*s$u,s$m[13]=(s$Z+s$l)*s$x,s$m[14]=(s$_+s$h)*s$t},s$n.translation=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;s$Z[0]=s$Z[5]=s$Z[10]=s$Z[15]=1,s$Z[12]=s$l[0],s$Z[13]=s$l[1],s$Z[14]=s$l[2]},s$b(s$n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new s$n},"_tempVector0",function(){return this._tempVector0=new s$NL},"_tempVector1",function(){return this._tempVector1=new s$NL},"_tempVector2",function(){return this._tempVector2=new s$NL},"_tempQuaternion",function(){return this._tempQuaternion=new s$lL},"DEFAULT",function(){return this.DEFAULT=new s$n},"ZERO",function(){return this.ZERO=new s$n(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),s$n}(),s$LL=(function(){function s$w(s$d,s$L){this.extents=null,this.transformation=null,this.extents=s$d,this.transformation=s$L}s$Y(s$w,"laya.d3.math.OrientedBoundBox");var s$d=s$w.prototype;s$d.getCorners=function(s$d){var s$L=s$w._tempV30.elements,s$l=s$w._tempV31.elements,s$Z=s$w._tempV32.elements,s$h=this.extents.elements;s$L[0]=s$h[0],s$L[1]=s$L[2]=0,s$l[1]=s$h[1],s$l[0]=s$l[2]=0,s$Z[2]=s$h[2],s$Z[0]=s$Z[1]=0,s$NL.TransformNormal(s$w._tempV30,this.transformation,s$w._tempV30),s$NL.TransformNormal(s$w._tempV31,this.transformation,s$w._tempV31),s$NL.TransformNormal(s$w._tempV32,this.transformation,s$w._tempV32);var s$_=s$w._tempV33;this.transformation.getTranslationVector(s$_),s$d.length=8,s$NL.add(s$_,s$w._tempV30,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV32,s$d[0]),s$NL.add(s$_,s$w._tempV30,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV32,s$d[1]),s$NL.subtract(s$_,s$w._tempV30,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV32,s$d[2]),s$NL.subtract(s$_,s$w._tempV30,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV32,s$d[3]),s$NL.add(s$_,s$w._tempV30,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV32,s$d[4]),s$NL.add(s$_,s$w._tempV30,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV32,s$d[5]),s$NL.subtract(s$_,s$w._tempV30,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV32,s$d[6]),s$NL.subtract(s$_,s$w._tempV30,s$w._tempV34),s$NL.subtract(s$w._tempV34,s$w._tempV31,s$w._tempV34),s$NL.add(s$w._tempV34,s$w._tempV32,s$d[7])},s$d.transform=function(s$d){s$dL.multiply(this.transformation,s$d,this.transformation)},s$d.scale=function(s$d){s$NL.multiply(this.extents,s$d,this.extents)},s$d.translate=function(s$d){this.transformation.getTranslationVector(s$w._tempV30),s$NL.add(s$w._tempV30,s$d,s$w._tempV31),this.transformation.setTranslationVector(s$w._tempV31)},s$d.Size=function(s$d){s$NL.scale(this.extents,2,s$d)},s$d.getSize=function(s$d){var s$L=this.extents.elements;s$w._tempV30.x=s$L[0],s$w._tempV31.y=s$L[1],s$w._tempV32.z=s$L[2],s$NL.TransformNormal(s$w._tempV30,this.transformation,s$w._tempV30),s$NL.TransformNormal(s$w._tempV31,this.transformation,s$w._tempV31),s$NL.TransformNormal(s$w._tempV31,this.transformation,s$w._tempV32);var s$l=s$d.elements;s$l[0]=s$NL.scalarLength(s$w._tempV30),s$l[1]=s$NL.scalarLength(s$w._tempV31),s$l[2]=s$NL.scalarLength(s$w._tempV32)},s$d.getSizeSquared=function(s$d){var s$L=this.extents.elements;s$w._tempV30.x=s$L[0],s$w._tempV31.y=s$L[1],s$w._tempV32.z=s$L[2],s$NL.TransformNormal(s$w._tempV30,this.transformation,s$w._tempV30),s$NL.TransformNormal(s$w._tempV31,this.transformation,s$w._tempV31),s$NL.TransformNormal(s$w._tempV31,this.transformation,s$w._tempV32);var s$l=s$d.elements;s$l[0]=s$NL.scalarLengthSquared(s$w._tempV30),s$l[1]=s$NL.scalarLengthSquared(s$w._tempV31),s$l[2]=s$NL.scalarLengthSquared(s$w._tempV32)},s$d.getCenter=function(s$d){this.transformation.getTranslationVector(s$d)},s$d.containsPoint=function(s$d){var s$L=this.extents.elements,s$l=s$L[0],s$Z=s$L[1],s$h=s$L[2];this.transformation.invert(s$w._tempM0),s$NL.transformCoordinate(s$d,s$w._tempM0,s$w._tempV30);var s$_=s$w._tempV30.elements,s$N=Math.abs(s$_[0]),s$m=Math.abs(s$_[1]),s$u=Math.abs(s$_[2]);return s$Wd.nearEqual(s$N,s$l)&&s$Wd.nearEqual(s$m,s$Z)&&s$Wd.nearEqual(s$u,s$h)?2:s$N<s$l&&s$m<s$Z&&s$u<s$h?1:0},s$d.containsPoints=function(s$d){var s$L=this.extents.elements,s$l=s$L[0],s$Z=s$L[1],s$h=s$L[2];this.transformation.invert(s$w._tempM0);for(var s$_=!0,s$N=!1,s$m=0;s$m<s$d.length;s$m++){s$NL.transformCoordinate(s$d[s$m],s$w._tempM0,s$w._tempV30);var s$u=s$w._tempV30.elements,s$x=Math.abs(s$u[0]),s$t=Math.abs(s$u[1]),s$b=Math.abs(s$u[2]);s$Wd.nearEqual(s$x,s$l)&&s$Wd.nearEqual(s$t,s$Z)&&s$Wd.nearEqual(s$b,s$h)&&(s$N=!0),s$x<s$l&&s$t<s$Z&&s$b<s$h?s$N=!0:s$_=!1}return s$_?1:s$N?2:0},s$d.containsSphere=function(s$d,s$L){void 0===s$L&&(s$L=!1);var s$l=this.extents.elements,s$Z=s$l[0],s$h=s$l[1],s$_=s$l[2],s$N=s$d.radius;this.transformation.invert(s$w._tempM0),s$NL.transformCoordinate(s$d.center,s$w._tempM0,s$w._tempV30);var s$m=NaN;if(s$m=s$L?s$N:(s$NL.scale(s$NL.UnitX,s$N,s$w._tempV31),s$NL.TransformNormal(s$w._tempV31,s$w._tempM0,s$w._tempV31),s$NL.scalarLength(s$w._tempV31)),s$NL.scale(this.extents,-1,s$w._tempV32),s$NL.Clamp(s$w._tempV30,s$w._tempV32,this.extents,s$w._tempV33),s$m*s$m<s$NL.distanceSquared(s$w._tempV30,s$w._tempV33))return 0;var s$u=s$w._tempV30.elements,s$x=s$u[0],s$t=s$u[1],s$b=s$u[2],s$q=s$w._tempV32.elements,s$Y=s$q[0],s$c=s$q[1],s$r=s$q[2];return s$Y+s$m<=s$x&&s$x<=s$Z-s$m&&s$m<s$Z-s$Y&&s$c+s$m<=s$t&&s$t<=s$h-s$m&&s$m<s$h-s$c&&s$r+s$m<=s$b&&s$b<=s$_-s$m&&s$m<s$_-s$r?1:2},s$d.containsOrientedBoundBox=function(s$d){var s$L=0,s$l=0;s$d.getCorners(s$w._corners);var s$Z=this.containsPoints(s$w._corners);if(0!=s$Z)return s$Z;var s$h=this.extents.elements;s$d.extents.cloneTo(s$w._tempV35);var s$_=s$w._tempV35.elements;s$w._getRows(this.transformation,s$w._rows1),s$w._getRows(s$d.transformation,s$w._rows2);var s$N=NaN;for(s$L=0;s$L<4;s$L++)for(s$l=0;s$l<4;s$l++)3==s$L||3==s$l?(s$w._tempM0.setElementByRowColumn(s$L,s$l,0),s$w._tempM1.setElementByRowColumn(s$L,s$l,0)):(s$N=s$NL.dot(s$w._rows1[s$L],s$w._rows2[s$l]),s$w._tempM0.setElementByRowColumn(s$L,s$l,s$N),s$w._tempM1.setElementByRowColumn(s$L,s$l,Math.abs(s$N)));s$d.getCenter(s$w._tempV34),this.getCenter(s$w._tempV36),s$NL.subtract(s$w._tempV34,s$w._tempV36,s$w._tempV30);var s$m=s$w._tempV31.elements;s$m[0]=s$NL.dot(s$w._tempV30,s$w._rows1[0]),s$m[1]=s$NL.dot(s$w._tempV30,s$w._rows1[1]),s$m[2]=s$NL.dot(s$w._tempV30,s$w._rows1[2]);var s$u=s$w._tempV32.elements,s$x=s$w._tempV33.elements;for(s$L=0;s$L<3;s$L++)if(s$u[0]=s$w._tempM1.getElementByRowColumn(s$L,0),s$u[1]=s$w._tempM1.getElementByRowColumn(s$L,1),s$u[2]=s$w._tempM1.getElementByRowColumn(s$L,2),s$h[s$L]+s$NL.dot(s$w._tempV35,s$w._tempV32)<Math.abs(s$m[s$L]))return 0;for(s$l=0;s$l<3;s$l++)if(s$u[0]=s$w._tempM1.getElementByRowColumn(0,s$l),s$u[1]=s$w._tempM1.getElementByRowColumn(1,s$l),s$u[2]=s$w._tempM1.getElementByRowColumn(2,s$l),s$x[0]=s$w._tempM0.getElementByRowColumn(0,s$l),s$x[1]=s$w._tempM0.getElementByRowColumn(1,s$l),s$x[2]=s$w._tempM0.getElementByRowColumn(2,s$l),s$NL.dot(this.extents,s$w._tempV32)+s$_[s$l]<Math.abs(s$NL.dot(s$w._tempV31,s$w._tempV33)))return 0;for(s$L=0;s$L<3;s$L++)for(s$l=0;s$l<3;s$l++){var s$t=(s$L+1)%3,s$b=(s$L+2)%3,s$q=(s$l+1)%3,s$Y=(s$l+2)%3;if(s$h[s$t]*s$w._tempM1.getElementByRowColumn(s$b,s$l)+s$h[s$b]*s$w._tempM1.getElementByRowColumn(s$t,s$l)+(s$_[s$q]*s$w._tempM1.getElementByRowColumn(s$L,s$Y)+s$_[s$Y]*s$w._tempM1.getElementByRowColumn(s$L,s$q))<Math.abs(s$m[s$b]*s$w._tempM0.getElementByRowColumn(s$t,s$l)-s$m[s$t]*s$w._tempM0.getElementByRowColumn(s$b,s$l)))return 0}return 2},s$d.containsLine=function(s$d,s$L){s$w._corners[0]=s$d,s$w._corners[1]=s$L;var s$l=this.containsPoints(s$w._corners);if(0!=s$l)return s$l;var s$Z=this.extents.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2];this.transformation.invert(s$w._tempM0),s$NL.transformCoordinate(s$d,s$w._tempM0,s$w._tempV30),s$NL.transformCoordinate(s$L,s$w._tempM0,s$w._tempV31),s$NL.add(s$w._tempV30,s$w._tempV31,s$w._tempV32),s$NL.scale(s$w._tempV32,.5,s$w._tempV32),s$NL.subtract(s$w._tempV30,s$w._tempV32,s$w._tempV33);var s$m=s$w._tempV33.elements,s$u=s$m[0],s$x=s$m[1],s$t=s$m[2],s$b=s$w._tempV34.elements,s$q=s$b[0]=Math.abs(s$m[0]),s$Y=s$b[1]=Math.abs(s$m[1]),s$c=s$b[2]=Math.abs(s$m[2]),s$r=s$w._tempV32.elements,s$a=s$r[0],s$k=s$r[1],s$e=s$r[2];return Math.abs(s$a)>s$h+s$q?0:Math.abs(s$k)>s$_+s$Y?0:Math.abs(s$e)>s$N+s$c?0:Math.abs(s$k*s$t-s$e*s$x)>s$_*s$c+s$N*s$Y?0:Math.abs(s$a*s$t-s$e*s$u)>s$h*s$c+s$N*s$q?0:Math.abs(s$a*s$x-s$k*s$u)>s$h*s$Y+s$_*s$q?0:2},s$d.containsBoundBox=function(s$d){var s$L=0,s$l=0,s$Z=s$d.min,s$h=s$d.max;s$d.getCorners(s$w._corners);var s$_=this.containsPoints(s$w._corners);if(0!=s$_)return s$_;s$NL.subtract(s$h,s$Z,s$w._tempV30),s$NL.scale(s$w._tempV30,.5,s$w._tempV30),s$NL.add(s$Z,s$w._tempV30,s$w._tempV30),s$NL.subtract(s$h,s$w._tempV30,s$w._tempV31);var s$N=this.extents.elements,s$m=s$w._tempV31.elements;s$w._getRows(this.transformation,s$w._rows1),this.transformation.invert(s$w._tempM0);for(s$L=0;s$L<3;s$L++)for(s$l=0;s$l<3;s$l++)s$w._tempM1.setElementByRowColumn(s$L,s$l,Math.abs(s$w._tempM0.getElementByRowColumn(s$L,s$l)));this.getCenter(s$w._tempV35),s$NL.subtract(s$w._tempV30,s$w._tempV35,s$w._tempV32);var s$u=s$w._tempV31.elements;s$u[0]=s$NL.dot(s$w._tempV32,s$w._rows1[0]),s$u[1]=s$NL.dot(s$w._tempV32,s$w._rows1[1]),s$u[2]=s$NL.dot(s$w._tempV32,s$w._rows1[2]);var s$x=s$w._tempV33.elements,s$t=s$w._tempV34.elements;for(s$L=0;s$L<3;s$L++)if(s$x[0]=s$w._tempM1.getElementByRowColumn(s$L,0),s$x[1]=s$w._tempM1.getElementByRowColumn(s$L,1),s$x[2]=s$w._tempM1.getElementByRowColumn(s$L,2),s$N[s$L]+s$NL.dot(s$w._tempV31,s$w._tempV33)<Math.abs(s$u[s$L]))return 0;for(s$l=0;s$l<3;s$l++)if(s$x[0]=s$w._tempM1.getElementByRowColumn(0,s$l),s$x[1]=s$w._tempM1.getElementByRowColumn(1,s$l),s$x[2]=s$w._tempM1.getElementByRowColumn(2,s$l),s$t[0]=s$w._tempM0.getElementByRowColumn(0,s$l),s$t[1]=s$w._tempM0.getElementByRowColumn(1,s$l),s$t[2]=s$w._tempM0.getElementByRowColumn(2,s$l),s$NL.dot(this.extents,s$w._tempV33)+s$m[s$l]<Math.abs(s$NL.dot(s$w._tempV31,s$w._tempV34)))return 0;for(s$L=0;s$L<3;s$L++)for(s$l=0;s$l<3;s$l++){var s$b=(s$L+1)%3,s$q=(s$L+2)%3,s$Y=(s$l+1)%3,s$c=(s$l+2)%3;if(s$N[s$b]*s$w._tempM1.getElementByRowColumn(s$q,s$l)+s$N[s$q]*s$w._tempM1.getElementByRowColumn(s$b,s$l)+(s$m[s$Y]*s$w._tempM1.getElementByRowColumn(s$L,s$c)+s$m[s$c]*s$w._tempM1.getElementByRowColumn(s$L,s$Y))<Math.abs(s$u[s$q]*s$w._tempM0.getElementByRowColumn(s$b,s$l)-s$u[s$b]*s$w._tempM0.getElementByRowColumn(s$q,s$l)))return 0}return 2},s$d.intersectsRay=function(s$d,s$L){s$NL.scale(this.extents,-1,s$w._tempV30),this.transformation.invert(s$w._tempM0),s$NL.TransformNormal(s$d.direction,s$w._tempM0,s$w._ray.direction),s$NL.transformCoordinate(s$d.origin,s$w._tempM0,s$w._ray.origin),s$w._boxBound1.min=s$w._tempV30,s$w._boxBound1.max=this.extents;var s$l=Collision.intersectsRayAndBoxRP(s$w._ray,s$w._boxBound1,s$L);return-1!==s$l&&s$NL.transformCoordinate(s$L,this.transformation,s$L),s$l},s$d._getLocalCorners=function(s$d){s$d.length=8;var s$L=this.extents.elements;s$w._tempV30.x=s$L[0],s$w._tempV31.y=s$L[1],s$w._tempV32.z=s$L[2],s$NL.add(s$w._tempV30,s$w._tempV31,s$w._tempV33),s$NL.add(s$w._tempV33,s$w._tempV32,s$d[0]),s$NL.add(s$w._tempV30,s$w._tempV31,s$w._tempV33),s$NL.subtract(s$w._tempV33,s$w._tempV32,s$d[1]),s$NL.subtract(s$w._tempV31,s$w._tempV30,s$w._tempV33),s$NL.subtract(s$w._tempV33,s$w._tempV30,s$d[2]),s$NL.subtract(s$w._tempV31,s$w._tempV30,s$w._tempV33),s$NL.add(s$w._tempV33,s$w._tempV32,s$d[3]),s$NL.subtract(s$w._tempV30,s$w._tempV31,s$w._tempV33),s$NL.add(s$w._tempV33,s$w._tempV32,s$d[4]),s$NL.subtract(s$w._tempV30,s$w._tempV31,s$w._tempV33),s$NL.subtract(s$w._tempV33,s$w._tempV32,s$d[5]),s$NL.scale(s$d[0],-1,s$d[6]),s$NL.subtract(s$w._tempV32,s$w._tempV30,s$w._tempV33),s$NL.subtract(s$w._tempV33,s$w._tempV31,s$d[7])},s$d.equals=function(s$d){return this.extents==s$d.extents&&this.transformation==s$d.transformation},s$d.cloneTo=function(s$d){var s$L=s$d;this.extents.cloneTo(s$L.extents),this.transformation.cloneTo(s$L.transformation)},s$w.createByBoundBox=function(s$d,s$L){var s$l=s$d.min,s$Z=s$d.max;s$NL.subtract(s$Z,s$l,s$w._tempV30),s$NL.scale(s$w._tempV30,.5,s$w._tempV30),s$NL.add(s$l,s$w._tempV30,s$w._tempV31),s$NL.subtract(s$Z,s$w._tempV31,s$w._tempV32),s$dL.translation(s$w._tempV31,s$w._tempM0);var s$h=s$w._tempV32.clone(),s$_=s$w._tempM0.clone();s$L.extents=s$h,s$L.transformation=s$_},s$w.createByMinAndMaxVertex=function(s$d,s$L){return s$NL.subtract(s$L,s$d,s$w._tempV30),s$NL.scale(s$w._tempV30,.5,s$w._tempV30),s$NL.add(s$d,s$w._tempV30,s$w._tempV31),s$NL.subtract(s$L,s$w._tempV31,s$w._tempV32),s$dL.translation(s$w._tempV31,s$w._tempM0),new s$w(s$w._tempV32,s$w._tempM0)},s$w._getRows=function(s$d,s$L){s$L.length=3;var s$l=s$d.elements,s$Z=s$L[0].elements;s$Z[0]=s$l[0],s$Z[1]=s$l[1],s$Z[2]=s$l[2];var s$h=s$L[1].elements;s$h[0]=s$l[4],s$h[1]=s$l[5],s$h[2]=s$l[6];var s$_=s$L[2].elements;s$_[0]=s$l[8],s$_[1]=s$l[9],s$_[2]=s$l[10]},s$w.getObbtoObbMatrix4x4=function(s$d,s$L,s$l,s$Z){var s$h=s$d.transformation,s$_=s$L.transformation;if(s$l){s$w._getRows(s$h,s$w._rows1),s$w._getRows(s$_,s$w._rows2);for(var s$N=0;s$N<3;s$N++)for(var s$m=0;s$m<3;s$m++)s$Z.setElementByRowColumn(s$N,s$m,s$NL.dot(s$w._rows2[s$N],s$w._rows1[s$m]));s$L.getCenter(s$w._tempV30),s$d.getCenter(s$w._tempV31),s$NL.subtract(s$w._tempV30,s$w._tempV31,s$w._tempV32);var s$u=s$Z.elements;s$u[12]=s$NL.dot(s$w._tempV32,s$w._rows1[0]),s$u[13]=s$NL.dot(s$w._tempV32,s$w._rows1[1]),s$u[14]=s$NL.dot(s$w._tempV32,s$w._rows1[2]),s$u[15]=1}else s$h.invert(s$w._tempM0),s$dL.multiply(s$_,s$w._tempM0,s$Z)},s$w.merge=function(s$d,s$L,s$l){var s$Z=s$d.extents,s$h=s$d.transformation;s$w.getObbtoObbMatrix4x4(s$d,s$L,s$l,s$w._tempM0),s$L._getLocalCorners(s$w._corners),s$NL.transformCoordinate(s$w._corners[0],s$w._tempM0,s$w._corners[0]),s$NL.transformCoordinate(s$w._corners[1],s$w._tempM0,s$w._corners[1]),s$NL.transformCoordinate(s$w._corners[2],s$w._tempM0,s$w._corners[2]),s$NL.transformCoordinate(s$w._corners[3],s$w._tempM0,s$w._corners[3]),s$NL.transformCoordinate(s$w._corners[4],s$w._tempM0,s$w._corners[4]),s$NL.transformCoordinate(s$w._corners[5],s$w._tempM0,s$w._corners[5]),s$NL.transformCoordinate(s$w._corners[6],s$w._tempM0,s$w._corners[6]),s$NL.transformCoordinate(s$w._corners[7],s$w._tempM0,s$w._corners[7]),s$NL.scale(s$Z,-1,s$w._boxBound1.min),s$Z.cloneTo(s$w._boxBound1.max),s$Jd.createfromPoints(s$w._corners,s$w._boxBound2),s$Jd.merge(s$w._boxBound2,s$w._boxBound1,s$w._boxBound3);var s$_=s$w._boxBound3.min,s$N=s$w._boxBound3.max;s$NL.subtract(s$N,s$_,s$w._tempV30),s$NL.scale(s$w._tempV30,.5,s$w._tempV30),s$NL.add(s$_,s$w._tempV30,s$w._tempV32),s$NL.subtract(s$N,s$w._tempV32,s$Z),s$NL.transformCoordinate(s$w._tempV32,s$h,s$w._tempV33)},s$b(s$w,["_tempV30",function(){return this._tempV30=new s$NL},"_tempV31",function(){return this._tempV31=new s$NL},"_tempV32",function(){return this._tempV32=new s$NL},"_tempV33",function(){return this._tempV33=new s$NL},"_tempV34",function(){return this._tempV34=new s$NL},"_tempV35",function(){return this._tempV35=new s$NL},"_tempV36",function(){return this._tempV36=new s$NL},"_tempM0",function(){return this._tempM0=new s$dL},"_tempM1",function(){return this._tempM1=new s$dL},"_corners",function(){return this._corners=[new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL]},"_rows1",function(){return this._rows1=[new s$NL,new s$NL,new s$NL]},"_rows2",function(){return this._rows2=[new s$NL,new s$NL,new s$NL]},"_ray",function(){return this._ray=new s$hL(new s$NL,new s$NL)},"_boxBound1",function(){return this._boxBound1=new s$Jd(new s$NL,new s$NL)},"_boxBound2",function(){return this._boxBound2=new s$Jd(new s$NL,new s$NL)},"_boxBound3",function(){return this._boxBound3=new s$Jd(new s$NL,new s$NL)}])}(),function(){function s$A(s$d,s$L){this.normal=null,this.distance=NaN,void 0===s$L&&(s$L=0),this.normal=s$d,this.distance=s$L}return s$Y(s$A,"laya.d3.math.Plane"),s$A.prototype.normalize=function(){var s$d=this.normal.elements,s$L=s$d[0],s$l=s$d[1],s$Z=s$d[2],s$h=1/Math.sqrt(s$L*s$L+s$l*s$l+s$Z*s$Z);s$d[0]=s$L*s$h,s$d[1]=s$l*s$h,s$d[2]=s$Z*s$h,this.distance*=s$h},s$A.createPlaneBy3P=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$L.elements,s$_=s$l.elements,s$N=s$h[0]-s$Z[0],s$m=s$h[1]-s$Z[1],s$u=s$h[2]-s$Z[2],s$x=s$_[0]-s$Z[0],s$t=s$_[1]-s$Z[1],s$b=s$_[2]-s$Z[2],s$q=s$m*s$b-s$u*s$t,s$Y=s$u*s$x-s$N*s$b,s$c=s$N*s$t-s$m*s$x,s$r=1/Math.sqrt(s$q*s$q+s$Y*s$Y+s$c*s$c),s$a=s$q*s$r,s$k=s$Y*s$r,s$e=s$c*s$r,s$w=s$A._TEMPVec3.elements;s$w[0]=s$a,s$w[1]=s$k,s$w[2]=s$e;var s$s=-(s$a*s$Z[0]+s$k*s$Z[1]+s$e*s$Z[2]);return new s$A(s$A._TEMPVec3,s$s)},s$A.PlaneIntersectionType_Back=0,s$A.PlaneIntersectionType_Front=1,s$A.PlaneIntersectionType_Intersecting=2,s$b(s$A,["_TEMPVec3",function(){return this._TEMPVec3=new s$NL}]),s$A}()),s$lL=function(){function s$h(s$d,s$L,s$l,s$Z){this.elements=new Float32Array(4),void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=1),this.elements[0]=s$d,this.elements[1]=s$L,this.elements[2]=s$l,this.elements[3]=s$Z}s$Y(s$h,"laya.d3.math.Quaternion");var s$d=s$h.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.scaling=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements;s$l[0]=s$Z[0]*s$d,s$l[1]=s$Z[1]*s$d,s$l[2]=s$Z[2]*s$d,s$l[3]=s$Z[3]*s$d},s$d.normalize=function(s$d){var s$L=s$d.elements,s$l=this.elements,s$Z=s$l[0],s$h=s$l[1],s$_=s$l[2],s$N=s$l[3],s$m=s$Z*s$Z+s$h*s$h+s$_*s$_+s$N*s$N;0<s$m&&(s$m=1/Math.sqrt(s$m),s$L[0]=s$Z*s$m,s$L[1]=s$h*s$m,s$L[2]=s$_*s$m,s$L[3]=s$N*s$m)},s$d.length=function(){var s$d=this.elements,s$L=s$d[0],s$l=s$d[1],s$Z=s$d[2],s$h=s$d[3];return Math.sqrt(s$L*s$L+s$l*s$l+s$Z*s$Z+s$h*s$h)},s$d.rotateX=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements;s$d*=.5;var s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=Math.sin(s$d),s$x=Math.cos(s$d);s$l[0]=s$h*s$x+s$m*s$u,s$l[1]=s$_*s$x+s$N*s$u,s$l[2]=s$N*s$x-s$_*s$u,s$l[3]=s$m*s$x-s$h*s$u},s$d.rotateY=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements;s$d*=.5;var s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=Math.sin(s$d),s$x=Math.cos(s$d);s$l[0]=s$h*s$x-s$N*s$u,s$l[1]=s$_*s$x+s$m*s$u,s$l[2]=s$N*s$x+s$h*s$u,s$l[3]=s$m*s$x-s$_*s$u},s$d.rotateZ=function(s$d,s$L){var s$l=s$L.elements,s$Z=this.elements;s$d*=.5;var s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=Math.sin(s$d),s$x=Math.cos(s$d);s$l[0]=s$h*s$x+s$_*s$u,s$l[1]=s$_*s$x-s$h*s$u,s$l[2]=s$N*s$x+s$m*s$u,s$l[3]=s$m*s$x-s$N*s$u},s$d.getYawPitchRoll=function(s$d){s$NL.transformQuat(s$NL.ForwardRH,this,s$h.TEMPVector31),s$NL.transformQuat(s$NL.Up,this,s$h.TEMPVector32);var s$L=s$h.TEMPVector32.elements;s$h.angleTo(s$NL.ZERO,s$h.TEMPVector31,s$h.TEMPVector33);var s$l=s$h.TEMPVector33.elements;s$l[0]==Math.PI/2?(s$l[1]=s$h.arcTanAngle(s$L[2],s$L[0]),s$l[2]=0):s$l[0]==-Math.PI/2?(s$l[1]=s$h.arcTanAngle(-s$L[2],-s$L[0]),s$l[2]=0):(s$dL.createRotationY(-s$l[1],s$h.TEMPMatrix0),s$dL.createRotationX(-s$l[0],s$h.TEMPMatrix1),s$NL.transformCoordinate(s$h.TEMPVector32,s$h.TEMPMatrix0,s$h.TEMPVector32),s$NL.transformCoordinate(s$h.TEMPVector32,s$h.TEMPMatrix1,s$h.TEMPVector32),s$l[2]=s$h.arcTanAngle(s$L[1],-s$L[0])),s$l[1]<=-Math.PI&&(s$l[1]=Math.PI),s$l[2]<=-Math.PI&&(s$l[2]=Math.PI),s$l[1]>=Math.PI&&s$l[2]>=Math.PI&&(s$l[1]=0,s$l[2]=0,s$l[0]=Math.PI-s$l[0]);var s$Z=s$d.elements;s$Z[0]=s$l[1],s$Z[1]=s$l[0],s$Z[2]=s$l[2]},s$d.invert=function(s$d){var s$L=s$d.elements,s$l=this.elements,s$Z=s$l[0],s$h=s$l[1],s$_=s$l[2],s$N=s$l[3],s$m=s$Z*s$Z+s$h*s$h+s$_*s$_+s$N*s$N,s$u=s$m?1/s$m:0;s$L[0]=-s$Z*s$u,s$L[1]=-s$h*s$u,s$L[2]=-s$_*s$u,s$L[3]=s$N*s$u},s$d.identity=function(){var s$d=this.elements;s$d[0]=0,s$d[1]=0,s$d[2]=0,s$d[3]=1},s$d.fromArray=function(s$d,s$L){void 0===s$L&&(s$L=0),this.elements[0]=s$d[s$L+0],this.elements[1]=s$d[s$L+1],this.elements[2]=s$d[s$L+2],this.elements[3]=s$d[s$L+3]},s$d.cloneTo=function(s$d){var s$L,s$l,s$Z;if((s$l=this.elements)!==(s$Z=s$d.elements))for(s$L=0;s$L<4;++s$L)s$Z[s$L]=s$l[s$L]},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$d.equals=function(s$d){var s$L=this.elements,s$l=s$d.elements;return s$Wd.nearEqual(s$L[0],s$l[0])&&s$Wd.nearEqual(s$L[1],s$l[1])&&s$Wd.nearEqual(s$L[2],s$l[2])&&s$Wd.nearEqual(s$L[3],s$l[3])},s$d.lengthSquared=function(){var s$d=this.elements[0],s$L=this.elements[1],s$l=this.elements[2],s$Z=this.elements[3];return s$d*s$d+s$L*s$L+s$l*s$l+s$Z*s$Z},s$c(0,s$d,"x",function(){return this.elements[0]}),s$c(0,s$d,"y",function(){return this.elements[1]}),s$c(0,s$d,"z",function(){return this.elements[2]}),s$c(0,s$d,"w",function(){return this.elements[3]}),s$h.createFromYawPitchRoll=function(s$d,s$L,s$l,s$Z){var s$h=.5*s$l,s$_=.5*s$L,s$N=.5*s$d,s$m=Math.sin(s$h),s$u=Math.cos(s$h),s$x=Math.sin(s$_),s$t=Math.cos(s$_),s$b=Math.sin(s$N),s$q=Math.cos(s$N),s$Y=s$Z.elements;s$Y[0]=s$q*s$x*s$u+s$b*s$t*s$m,s$Y[1]=s$b*s$t*s$u-s$q*s$x*s$m,s$Y[2]=s$q*s$t*s$m-s$b*s$x*s$u,s$Y[3]=s$q*s$t*s$u+s$b*s$x*s$m},s$h.multiply=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$L.elements,s$_=s$l.elements,s$N=s$Z[0],s$m=s$Z[1],s$u=s$Z[2],s$x=s$Z[3],s$t=s$h[0],s$b=s$h[1],s$q=s$h[2],s$Y=s$h[3],s$c=s$m*s$q-s$u*s$b,s$r=s$u*s$t-s$N*s$q,s$a=s$N*s$b-s$m*s$t,s$k=s$N*s$t+s$m*s$b+s$u*s$q;s$_[0]=s$N*s$Y+s$t*s$x+s$c,s$_[1]=s$m*s$Y+s$b*s$x+s$r,s$_[2]=s$u*s$Y+s$q*s$x+s$a,s$_[3]=s$x*s$Y-s$k},s$h.arcTanAngle=function(s$d,s$L){return 0==s$d?1==s$L?Math.PI/2:-Math.PI/2:0<s$d?Math.atan(s$L/s$d):s$d<0?0<s$L?Math.atan(s$L/s$d)+Math.PI:Math.atan(s$L/s$d)-Math.PI:0},s$h.angleTo=function(s$d,s$L,s$l){s$NL.subtract(s$L,s$d,s$h.TEMPVector30),s$NL.normalize(s$h.TEMPVector30,s$h.TEMPVector30),s$l.elements[0]=Math.asin(s$h.TEMPVector30.y),s$l.elements[1]=s$h.arcTanAngle(-s$h.TEMPVector30.z,-s$h.TEMPVector30.x)},s$h.createFromAxisAngle=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements;s$L*=.5;var s$_=Math.sin(s$L);s$Z[0]=s$_*s$h[0],s$Z[1]=s$_*s$h[1],s$Z[2]=s$_*s$h[2],s$Z[3]=Math.cos(s$L)},s$h.createFromMatrix3x3=function(s$d,s$L){var s$l,s$Z=s$L.elements,s$h=s$d.elements,s$_=s$h[0]+s$h[4]+s$h[8];if(0<s$_)s$l=Math.sqrt(s$_+1),s$Z[3]=.5*s$l,s$l=.5/s$l,s$Z[0]=(s$h[5]-s$h[7])*s$l,s$Z[1]=(s$h[6]-s$h[2])*s$l,s$Z[2]=(s$h[1]-s$h[3])*s$l;else{var s$N=0;s$h[4]>s$h[0]&&(s$N=1),s$h[8]>s$h[3*s$N+s$N]&&(s$N=2);var s$m=(s$N+1)%3,s$u=(s$N+2)%3;s$l=Math.sqrt(s$h[3*s$N+s$N]-s$h[3*s$m+s$m]-s$h[3*s$u+s$u]+1),s$Z[s$N]=.5*s$l,s$l=.5/s$l,s$Z[3]=(s$h[3*s$m+s$u]-s$h[3*s$u+s$m])*s$l,s$Z[s$m]=(s$h[3*s$m+s$N]+s$h[3*s$N+s$m])*s$l,s$Z[s$u]=(s$h[3*s$u+s$N]+s$h[3*s$N+s$u])*s$l}},s$h.createFromMatrix4x4=function(s$d,s$L){var s$l,s$Z,s$h=s$d.elements,s$_=s$L.elements,s$N=s$h[0]+s$h[5]+s$h[10];0<s$N?(s$l=Math.sqrt(s$N+1),s$_[3]=.5*s$l,s$l=.5/s$l,s$_[0]=(s$h[6]-s$h[9])*s$l,s$_[1]=(s$h[8]-s$h[2])*s$l,s$_[2]=(s$h[1]-s$h[4])*s$l):s$h[0]>=s$h[5]&&s$h[0]>=s$h[10]?(s$Z=.5/(s$l=Math.sqrt(1+s$h[0]-s$h[5]-s$h[10])),s$_[0]=.5*s$l,s$_[1]=(s$h[1]+s$h[4])*s$Z,s$_[2]=(s$h[2]+s$h[8])*s$Z,s$_[3]=(s$h[6]-s$h[9])*s$Z):s$h[5]>s$h[10]?(s$Z=.5/(s$l=Math.sqrt(1+s$h[5]-s$h[0]-s$h[10])),s$_[0]=(s$h[4]+s$h[1])*s$Z,s$_[1]=.5*s$l,s$_[2]=(s$h[9]+s$h[6])*s$Z,s$_[3]=(s$h[8]-s$h[2])*s$Z):(s$Z=.5/(s$l=Math.sqrt(1+s$h[10]-s$h[0]-s$h[5])),s$_[0]=(s$h[8]+s$h[2])*s$Z,s$_[1]=(s$h[9]+s$h[6])*s$Z,s$_[2]=.5*s$l,s$_[3]=(s$h[1]-s$h[4])*s$Z)},s$h.slerp=function(s$d,s$L,s$l,s$Z){var s$h,s$_,s$N,s$m,s$u,s$x=s$d.elements,s$t=s$L.elements,s$b=s$Z.elements,s$q=s$x[0],s$Y=s$x[1],s$c=s$x[2],s$r=s$x[3],s$a=s$t[0],s$k=s$t[1],s$e=s$t[2],s$w=s$t[3];return(s$_=s$q*s$a+s$Y*s$k+s$c*s$e+s$r*s$w)<0&&(s$_=-s$_,s$a=-s$a,s$k=-s$k,s$e=-s$e,s$w=-s$w),s$u=1e-6<1-s$_?(s$h=Math.acos(s$_),s$N=Math.sin(s$h),s$m=Math.sin((1-s$l)*s$h)/s$N,Math.sin(s$l*s$h)/s$N):(s$m=1-s$l,s$l),s$b[0]=s$m*s$q+s$u*s$a,s$b[1]=s$m*s$Y+s$u*s$k,s$b[2]=s$m*s$c+s$u*s$e,s$b[3]=s$m*s$r+s$u*s$w,s$b},s$h.lerp=function(s$d,s$L,s$l,s$Z){var s$h=s$Z.elements,s$_=s$d.elements,s$N=s$L.elements,s$m=s$_[0],s$u=s$_[1],s$x=s$_[2],s$t=s$_[3];s$h[0]=s$m+s$l*(s$N[0]-s$m),s$h[1]=s$u+s$l*(s$N[1]-s$u),s$h[2]=s$x+s$l*(s$N[2]-s$x),s$h[3]=s$t+s$l*(s$N[3]-s$t)},s$h.add=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]+s$_[0],s$Z[1]=s$h[1]+s$_[1],s$Z[2]=s$h[2]+s$_[2],s$Z[3]=s$h[3]+s$_[3]},s$h.dot=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;return s$l[0]*s$Z[0]+s$l[1]*s$Z[1]+s$l[2]*s$Z[2]+s$l[3]*s$Z[3]},s$h.rotationLookAt=function(s$d,s$L,s$l){s$h.lookAt(s$NL.ZERO,s$d,s$L,s$l)},s$h.lookAt=function(s$d,s$L,s$l,s$Z){s$Md.lookAt(s$d,s$L,s$l,s$h._tempMatrix3x3),s$h.rotationMatrix(s$h._tempMatrix3x3,s$Z)},s$h.invert=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$d.lengthSquared();s$Wd.isZero(s$h)||(s$h=1/s$h,s$Z[0]=-s$l[0]*s$h,s$Z[1]=-s$l[1]*s$h,s$Z[2]=-s$l[2]*s$h,s$Z[3]=s$l[3]*s$h)},s$h.rotationMatrix=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$l[0],s$h=s$l[1],s$_=s$l[2],s$N=s$l[3],s$m=s$l[4],s$u=s$l[5],s$x=s$l[6],s$t=s$l[7],s$b=s$l[8],s$q=s$L.elements,s$Y=NaN,s$c=NaN,s$r=s$Z+s$m+s$b;0<s$r?(s$Y=Math.sqrt(s$r+1),s$q[3]=.5*s$Y,s$Y=.5/s$Y,s$q[0]=(s$u-s$t)*s$Y,s$q[1]=(s$x-s$_)*s$Y,s$q[2]=(s$h-s$N)*s$Y):s$m<=s$Z&&s$b<=s$Z?(s$c=.5/(s$Y=Math.sqrt(1+s$Z-s$m-s$b)),s$q[0]=.5*s$Y,s$q[1]=(s$h+s$N)*s$c,s$q[2]=(s$_+s$x)*s$c,s$q[3]=(s$u-s$t)*s$c):s$b<s$m?(s$c=.5/(s$Y=Math.sqrt(1+s$m-s$Z-s$b)),s$q[0]=(s$N+s$h)*s$c,s$q[1]=.5*s$Y,s$q[2]=(s$t+s$u)*s$c,s$q[3]=(s$x-s$_)*s$c):(s$c=.5/(s$Y=Math.sqrt(1+s$b-s$Z-s$m)),s$q[0]=(s$x+s$_)*s$c,s$q[1]=(s$t+s$u)*s$c,s$q[2]=.5*s$Y,s$q[3]=(s$h-s$N)*s$c)},s$h.DEFAULT=new s$h,s$b(s$h,["TEMPVector30",function(){return this.TEMPVector30=new s$NL},"TEMPVector31",function(){return this.TEMPVector31=new s$NL},"TEMPVector32",function(){return this.TEMPVector32=new s$NL},"TEMPVector33",function(){return this.TEMPVector33=new s$NL},"TEMPMatrix0",function(){return this.TEMPMatrix0=new s$dL},"TEMPMatrix1",function(){return this.TEMPMatrix1=new s$dL},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new s$Md},"NAN",function(){return this.NAN=new s$h(NaN,NaN,NaN,NaN)}]),s$h}(),s$ZL=function(){function s$d(s$d){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=s$d,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}s$Y(s$d,"laya.d3.math.Rand");var s$L=s$d.prototype;return s$L.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},s$L.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},s$L.getSignedFloat=function(){return 2*this.getFloat()-1},s$c(0,s$L,"seed",function(){return this.seeds[0]},function(s$d){this.seeds[0]=s$d,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),s$d.getFloatFromInt=function(s$d){return 1/8388607*(8388607&s$d)},s$d.getByteFromInt=function(s$d){return(8388607&s$d)>>>15},s$d}(),s$hL=(function(){function s$h(s$d){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(s$d instanceof Array)||4!==s$d.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|s$d[0],this._state0L=0|s$d[1],this._state1U=0|s$d[2],this._state1L=0|s$d[3]}s$Y(s$h,"laya.d3.math.RandX");var s$d=s$h.prototype;s$d.randomint=function(){var s$d=this._state0U,s$L=this._state0L,s$l=this._state1U,s$Z=this._state1L,s$h=(s$Z>>>0)+(s$L>>>0),s$_=s$l+s$d+(s$h/2>>>31)>>>0,s$N=s$h>>>0,s$m=0,s$u=0;s$m=(s$d^=s$m=s$d<<23|(-512&s$L)>>>9)^(this._state0U=s$l),s$u=(s$L^=s$u=s$L<<23)^(this._state0L=s$Z);s$m^=s$d>>>18,s$u^=s$L>>>18|(262143&s$d)<<14;return s$m^=s$l>>>5,s$u^=s$Z>>>5|(31&s$l)<<27,this._state1U=s$m,this._state1L=s$u,[s$_,s$N]},s$d.random=function(){var s$d=this.randomint(),s$L=s$d[0],s$l=1023<<20|s$L>>>12,s$Z=0|(s$d[1]>>>12|(4095&s$L)<<20);return s$h._CONVERTION_BUFFER.setUint32(0,s$l,!1),s$h._CONVERTION_BUFFER.setUint32(4,s$Z,!1),s$ZL._CONVERTION_BUFFER.getFloat64(0,!1)-1},s$b(s$h,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new s$ZL([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function s$d(s$d,s$L){this.origin=null,this.direction=null,this.origin=s$d,this.direction=s$L}return s$Y(s$d,"laya.d3.math.Ray"),s$d}()),s$_L=function(){function s$d(s$d,s$L){this.elements=new Float32Array(2),void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0);var s$l=this.elements;s$l[0]=s$d,s$l[1]=s$L}s$Y(s$d,"laya.d3.math.Vector2");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.fromArray=function(s$d,s$L){void 0===s$L&&(s$L=0),this.elements[0]=s$d[s$L+0],this.elements[1]=s$d[s$L+1]},s$L.cloneTo=function(s$d){var s$L=s$d.elements,s$l=this.elements;s$L[0]=s$l[0],s$L[1]=s$l[1]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"x",function(){return this.elements[0]},function(s$d){this.elements[0]=s$d}),s$c(0,s$L,"y",function(){return this.elements[1]},function(s$d){this.elements[1]=s$d}),s$d.scale=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements;s$Z[0]=s$h[0]*s$L,s$Z[1]=s$h[1]*s$L},s$b(s$d,["ZERO",function(){return this.ZERO=new s$d(0,0)},"ONE",function(){return this.ONE=new s$d(1,1)}]),s$d}(),s$NL=function(){function s$t(s$d,s$L,s$l){this.elements=new Float32Array(3),void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0);var s$Z=this.elements;s$Z[0]=s$d,s$Z[1]=s$L,s$Z[2]=s$l}s$Y(s$t,"laya.d3.math.Vector3");var s$d=s$t.prototype;return s$A.imps(s$d,{"laya.d3.core.IClone":!0}),s$d.fromArray=function(s$d,s$L){void 0===s$L&&(s$L=0),this.elements[0]=s$d[s$L+0],this.elements[1]=s$d[s$L+1],this.elements[2]=s$d[s$L+2]},s$d.cloneTo=function(s$d){var s$L=s$d.elements,s$l=this.elements;s$L[0]=s$l[0],s$L[1]=s$l[1],s$L[2]=s$l[2]},s$d.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$d.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},s$d.reset=function(s$d,s$L,s$l){this.elements[0]=s$d,this.elements[1]=s$L,this.elements[2]=s$l},s$c(0,s$d,"x",function(){return this.elements[0]},function(s$d){this.elements[0]=s$d}),s$c(0,s$d,"y",function(){return this.elements[1]},function(s$d){this.elements[1]=s$d}),s$c(0,s$d,"z",function(){return this.elements[2]},function(s$d){this.elements[2]=s$d}),s$t.distanceSquared=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0]-s$Z[0],s$_=s$l[1]-s$Z[1],s$N=s$l[2]-s$Z[2];return s$h*s$h+s$_*s$_+s$N*s$N},s$t.distance=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0]-s$Z[0],s$_=s$l[1]-s$Z[1],s$N=s$l[2]-s$Z[2];return Math.sqrt(s$h*s$h+s$_*s$_+s$N*s$N)},s$t.min=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=Math.min(s$h[0],s$_[0]),s$Z[1]=Math.min(s$h[1],s$_[1]),s$Z[2]=Math.min(s$h[2],s$_[2])},s$t.max=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=Math.max(s$h[0],s$_[0]),s$Z[1]=Math.max(s$h[1],s$_[1]),s$Z[2]=Math.max(s$h[2],s$_[2])},s$t.transformQuat=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements,s$N=s$h[0],s$m=s$h[1],s$u=s$h[2],s$x=s$_[0],s$t=s$_[1],s$b=s$_[2],s$q=s$_[3],s$Y=s$q*s$N+s$t*s$u-s$b*s$m,s$c=s$q*s$m+s$b*s$N-s$x*s$u,s$r=s$q*s$u+s$x*s$m-s$t*s$N,s$a=-s$x*s$N-s$t*s$m-s$b*s$u;s$Z[0]=s$Y*s$q+s$a*-s$x+s$c*-s$b-s$r*-s$t,s$Z[1]=s$c*s$q+s$a*-s$t+s$r*-s$x-s$Y*-s$b,s$Z[2]=s$r*s$q+s$a*-s$b+s$Y*-s$t-s$c*-s$x},s$t.scalarLength=function(s$d){var s$L=s$d.elements,s$l=s$L[0],s$Z=s$L[1],s$h=s$L[2];return Math.sqrt(s$l*s$l+s$Z*s$Z+s$h*s$h)},s$t.scalarLengthSquared=function(s$d){var s$L=s$d.elements,s$l=s$L[0],s$Z=s$L[1],s$h=s$L[2];return s$l*s$l+s$Z*s$Z+s$h*s$h},s$t.normalize=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0],s$_=s$l[1],s$N=s$l[2],s$m=s$h*s$h+s$_*s$_+s$N*s$N;0<s$m&&(s$m=1/Math.sqrt(s$m),s$Z[0]=s$l[0]*s$m,s$Z[1]=s$l[1]*s$m,s$Z[2]=s$l[2]*s$m)},s$t.multiply=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]*s$_[0],s$Z[1]=s$h[1]*s$_[1],s$Z[2]=s$h[2]*s$_[2]},s$t.scale=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements;s$Z[0]=s$h[0]*s$L,s$Z[1]=s$h[1]*s$L,s$Z[2]=s$h[2]*s$L},s$t.lerp=function(s$d,s$L,s$l,s$Z){var s$h=s$Z.elements,s$_=s$d.elements,s$N=s$L.elements,s$m=s$_[0],s$u=s$_[1],s$x=s$_[2];s$h[0]=s$m+s$l*(s$N[0]-s$m),s$h[1]=s$u+s$l*(s$N[1]-s$u),s$h[2]=s$x+s$l*(s$N[2]-s$x)},s$t.transformV3ToV3=function(s$d,s$L,s$l){var s$Z=s$t._tempVector4;s$t.transformV3ToV4(s$d,s$L,s$Z);var s$h=s$Z.elements,s$_=s$l.elements;s$_[0]=s$h[0],s$_[1]=s$h[1],s$_[2]=s$h[2]},s$t.transformV3ToV4=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$L.elements,s$u=s$l.elements;s$u[0]=s$h*s$m[0]+s$_*s$m[4]+s$N*s$m[8]+s$m[12],s$u[1]=s$h*s$m[1]+s$_*s$m[5]+s$N*s$m[9]+s$m[13],s$u[2]=s$h*s$m[2]+s$_*s$m[6]+s$N*s$m[10]+s$m[14],s$u[3]=s$h*s$m[3]+s$_*s$m[7]+s$N*s$m[11]+s$m[15]},s$t.TransformNormal=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$L.elements,s$u=s$l.elements;s$u[0]=s$h*s$m[0]+s$_*s$m[4]+s$N*s$m[8],s$u[1]=s$h*s$m[1]+s$_*s$m[5]+s$N*s$m[9],s$u[2]=s$h*s$m[2]+s$_*s$m[6]+s$N*s$m[10]},s$t.transformCoordinate=function(s$d,s$L,s$l){var s$Z=s$t._tempVector4.elements,s$h=s$d.elements,s$_=s$h[0],s$N=s$h[1],s$m=s$h[2],s$u=s$L.elements;s$Z[0]=s$_*s$u[0]+s$N*s$u[4]+s$m*s$u[8]+s$u[12],s$Z[1]=s$_*s$u[1]+s$N*s$u[5]+s$m*s$u[9]+s$u[13],s$Z[2]=s$_*s$u[2]+s$N*s$u[6]+s$m*s$u[10]+s$u[14],s$Z[3]=1/(s$_*s$u[3]+s$N*s$u[7]+s$m*s$u[11]+s$u[15]);var s$x=s$l.elements;s$x[0]=s$Z[0]*s$Z[3],s$x[1]=s$Z[1]*s$Z[3],s$x[2]=s$Z[2]*s$Z[3]},s$t.Clamp=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements,s$_=s$h[0],s$N=s$h[1],s$m=s$h[2],s$u=s$L.elements,s$x=s$u[0],s$t=s$u[1],s$b=s$u[2],s$q=s$l.elements,s$Y=s$q[0],s$c=s$q[1],s$r=s$q[2],s$a=s$Z.elements;s$_=(s$_=s$Y<s$_?s$Y:s$_)<s$x?s$x:s$_,s$N=(s$N=s$c<s$N?s$c:s$N)<s$t?s$t:s$N,s$m=(s$m=s$r<s$m?s$r:s$m)<s$b?s$b:s$m,s$a[0]=s$_,s$a[1]=s$N,s$a[2]=s$m},s$t.add=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]+s$_[0],s$Z[1]=s$h[1]+s$_[1],s$Z[2]=s$h[2]+s$_[2]},s$t.subtract=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]-s$_[0],s$Z[1]=s$h[1]-s$_[1],s$Z[2]=s$h[2]-s$_[2]},s$t.cross=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$L.elements,s$_=s$l.elements,s$N=s$Z[0],s$m=s$Z[1],s$u=s$Z[2],s$x=s$h[0],s$t=s$h[1],s$b=s$h[2];s$_[0]=s$m*s$b-s$u*s$t,s$_[1]=s$u*s$x-s$N*s$b,s$_[2]=s$N*s$t-s$m*s$x},s$t.dot=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;return s$l[0]*s$Z[0]+s$l[1]*s$Z[1]+s$l[2]*s$Z[2]},s$t.equals=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;return s$Wd.nearEqual(Math.abs(s$l[0]),Math.abs(s$Z[0]))&&s$Wd.nearEqual(Math.abs(s$l[1]),Math.abs(s$Z[1]))&&s$Wd.nearEqual(Math.abs(s$l[2]),Math.abs(s$Z[2]))},s$t.ZERO=new s$t(0,0,0),s$t.ONE=new s$t(1,1,1),s$t.NegativeUnitX=new s$t(-1,0,0),s$t.UnitX=new s$t(1,0,0),s$t.UnitY=new s$t(0,1,0),s$t.UnitZ=new s$t(0,0,1),s$t.ForwardRH=new s$t(0,0,-1),s$t.ForwardLH=new s$t(0,0,1),s$t.Up=new s$t(0,1,0),s$t.NAN=new s$t(NaN,NaN,NaN),s$b(s$t,["_tempVector4",function(){return this._tempVector4=new s$mL}]),s$t}(),s$mL=function(){function s$d(s$d,s$L,s$l,s$Z){this.elements=new Float32Array(4),void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=0);var s$h=this.elements;s$h[0]=s$d,s$h[1]=s$L,s$h[2]=s$l,s$h[3]=s$Z}s$Y(s$d,"laya.d3.math.Vector4");var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L.fromArray=function(s$d,s$L){void 0===s$L&&(s$L=0),this.elements[0]=s$d[s$L+0],this.elements[1]=s$d[s$L+1],this.elements[2]=s$d[s$L+2],this.elements[3]=s$d[s$L+3]},s$L.cloneTo=function(s$d){var s$L=s$d.elements,s$l=this.elements;s$L[0]=s$l[0],s$L[1]=s$l[1],s$L[2]=s$l[2],s$L[3]=s$l[3]},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$L.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},s$L.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},s$c(0,s$L,"x",function(){return this.elements[0]},function(s$d){this.elements[0]=s$d}),s$c(0,s$L,"y",function(){return this.elements[1]},function(s$d){this.elements[1]=s$d}),s$c(0,s$L,"z",function(){return this.elements[2]},function(s$d){this.elements[2]=s$d}),s$c(0,s$L,"w",function(){return this.elements[3]},function(s$d){this.elements[3]=s$d}),s$d.lerp=function(s$d,s$L,s$l,s$Z){var s$h=s$Z.elements,s$_=s$d.elements,s$N=s$L.elements,s$m=s$_[0],s$u=s$_[1],s$x=s$_[2],s$t=s$_[3];s$h[0]=s$m+s$l*(s$N[0]-s$m),s$h[1]=s$u+s$l*(s$N[1]-s$u),s$h[2]=s$x+s$l*(s$N[2]-s$x),s$h[3]=s$t+s$l*(s$N[3]-s$t)},s$d.transformByM4x4=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$Z[0],s$_=s$Z[1],s$N=s$Z[2],s$m=s$Z[3],s$u=s$L.elements,s$x=s$l.elements;s$x[0]=s$h*s$u[0]+s$_*s$u[4]+s$N*s$u[8]+s$m*s$u[12],s$x[1]=s$h*s$u[1]+s$_*s$u[5]+s$N*s$u[9]+s$m*s$u[13],s$x[2]=s$h*s$u[2]+s$_*s$u[6]+s$N*s$u[10]+s$m*s$u[14],s$x[3]=s$h*s$u[3]+s$_*s$u[7]+s$N*s$u[11]+s$m*s$u[15]},s$d.equals=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;return s$Wd.nearEqual(Math.abs(s$l[0]),Math.abs(s$Z[0]))&&s$Wd.nearEqual(Math.abs(s$l[1]),Math.abs(s$Z[1]))&&s$Wd.nearEqual(Math.abs(s$l[2]),Math.abs(s$Z[2]))&&s$Wd.nearEqual(Math.abs(s$l[3]),Math.abs(s$Z[3]))},s$d.normalize=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$d.length();0<s$h&&(s$Z[0]=s$l[0]*s$h,s$Z[1]=s$l[1]*s$h,s$Z[2]=s$l[2]*s$h,s$Z[3]=s$l[3]*s$h)},s$d.add=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]+s$_[0],s$Z[1]=s$h[1]+s$_[1],s$Z[2]=s$h[2]+s$_[2],s$Z[3]=s$h[3]+s$_[3]},s$d.subtract=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]-s$_[0],s$Z[1]=s$h[1]-s$_[1],s$Z[2]=s$h[2]-s$_[2],s$Z[3]=s$h[3]-s$_[3]},s$d.multiply=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=s$h[0]*s$_[0],s$Z[1]=s$h[1]*s$_[1],s$Z[2]=s$h[2]*s$_[2],s$Z[3]=s$h[3]*s$_[3]},s$d.scale=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements;s$Z[0]=s$h[0]*s$L,s$Z[1]=s$h[1]*s$L,s$Z[2]=s$h[2]*s$L,s$Z[3]=s$h[3]*s$L},s$d.Clamp=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements,s$_=s$h[0],s$N=s$h[1],s$m=s$h[2],s$u=s$h[3],s$x=s$L.elements,s$t=s$x[0],s$b=s$x[1],s$q=s$x[2],s$Y=s$x[3],s$c=s$l.elements,s$r=s$c[0],s$a=s$c[1],s$k=s$c[2],s$e=s$c[3],s$w=s$Z.elements;s$_=(s$_=s$r<s$_?s$r:s$_)<s$t?s$t:s$_,s$N=(s$N=s$a<s$N?s$a:s$N)<s$b?s$b:s$N,s$m=(s$m=s$k<s$m?s$k:s$m)<s$q?s$q:s$m,s$u=(s$u=s$e<s$u?s$e:s$u)<s$Y?s$Y:s$u,s$w[0]=s$_,s$w[1]=s$N,s$w[2]=s$m,s$w[3]=s$u},s$d.distanceSquared=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0]-s$Z[0],s$_=s$l[1]-s$Z[1],s$N=s$l[2]-s$Z[2],s$m=s$l[3]-s$Z[3];return s$h*s$h+s$_*s$_+s$N*s$N+s$m*s$m},s$d.distance=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements,s$h=s$l[0]-s$Z[0],s$_=s$l[1]-s$Z[1],s$N=s$l[2]-s$Z[2],s$m=s$l[3]-s$Z[3];return Math.sqrt(s$h*s$h+s$_*s$_+s$N*s$N+s$m*s$m)},s$d.dot=function(s$d,s$L){var s$l=s$d.elements,s$Z=s$L.elements;return s$l[0]*s$Z[0]+s$l[1]*s$Z[1]+s$l[2]*s$Z[2]+s$l[3]*s$Z[3]},s$d.min=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=Math.min(s$h[0],s$_[0]),s$Z[1]=Math.min(s$h[1],s$_[1]),s$Z[2]=Math.min(s$h[2],s$_[2]),s$Z[3]=Math.min(s$h[3],s$_[3])},s$d.max=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L.elements;s$Z[0]=Math.max(s$h[0],s$_[0]),s$Z[1]=Math.max(s$h[1],s$_[1]),s$Z[2]=Math.max(s$h[2],s$_[2]),s$Z[3]=Math.max(s$h[3],s$_[3])},s$b(s$d,["ZERO",function(){return this.ZERO=new s$d},"ONE",function(){return this.ONE=new s$d(1,1,1,1)},"UnitX",function(){return this.UnitX=new s$d(1,0,0,0)},"UnitY",function(){return this.UnitY=new s$d(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new s$d(0,0,1,0)},"UnitW",function(){return this.UnitW=new s$d(0,0,0,1)}]),s$d}(),s$uL=function(){function s$_(s$d,s$L,s$l,s$Z){this.minDepth=0,this.maxDepth=1,this.x=s$d,this.y=s$L,this.width=s$l,this.height=s$Z}s$Y(s$_,"laya.d3.math.Viewport");var s$d=s$_.prototype;return s$d.project=function(s$d,s$L,s$l){s$NL.transformV3ToV3(s$d,s$L,s$l);var s$Z=s$d.elements,s$h=s$L.elements,s$_=s$l.elements,s$N=s$Z[0]*s$h[3]+s$Z[1]*s$h[7]+s$Z[2]*s$h[11]+s$h[15];1!==s$N&&(s$_[0]=s$_[0]/s$N,s$_[1]=s$_[1]/s$N,s$_[2]=s$_[2]/s$N),s$_[0]=.5*(s$_[0]+1)*this.width+this.x,s$_[1]=.5*(1-s$_[1])*this.height+this.y,s$_[2]=s$_[2]*(this.maxDepth-this.minDepth)+this.minDepth},s$d.unprojectFromMat=function(s$d,s$L,s$l){var s$Z=s$d.elements,s$h=s$L.elements,s$_=s$l.elements;s$_[0]=(s$Z[0]-this.x)/this.width*2-1,s$_[1]=-((s$Z[1]-this.y)/this.height*2-1);var s$N=(this.maxDepth-this.minDepth)/2;s$_[2]=(s$Z[2]-this.minDepth-s$N)/s$N;var s$m=s$_[0]*s$h[3]+s$_[1]*s$h[7]+s$_[2]*s$h[11]+s$h[15];s$NL.transformV3ToV3(s$l,s$L,s$l),1!==s$m&&(s$_[0]=s$_[0]/s$m,s$_[1]=s$_[1]/s$m,s$_[2]=s$_[2]/s$m)},s$d.unprojectFromWVP=function(s$d,s$L,s$l,s$Z,s$h){s$dL.multiply(s$L,s$l,s$_._tempMatrix4x4),s$Z&&s$dL.multiply(s$_._tempMatrix4x4,s$Z,s$_._tempMatrix4x4),s$_._tempMatrix4x4.invert(s$_._tempMatrix4x4),this.unprojectFromMat(s$d,s$_._tempMatrix4x4,s$h)},s$b(s$_,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new s$dL}]),s$_}(),s$xL=function(){function s$g(s$d){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=s$d,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}s$Y(s$g,"laya.d3.resource.models.SubMesh");var s$d=s$g.prototype;return s$A.imps(s$d,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),s$d._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),0===s$d?this._vertexBuffer:null},s$d._getIndexBuffer=function(){return this._indexBuffer},s$d._getStaticBatchBakedVertexs=function(s$d,s$L){var s$l,s$Z,s$h=this._vertexBuffer,s$_=s$h.vertexDeclaration,s$N=s$_.getVertexElementByUsage(0).offset/4,s$m=s$_.getVertexElementByUsage(3).offset/4,s$u=s$L.meshRender.lightmapScaleOffset,s$x=0,s$t=0,s$b=0,s$q=0,s$Y=0,s$c=0;if(s$u)if(s$Z=s$_.getVertexElementByUsage(15))s$b=s$_.vertexStride/4,s$l=0<this._vertexCount?s$h.getData().slice(this._vertexStart*s$b,(this._vertexStart+this._vertexCount)*s$b):s$h.getData().slice(),s$q=s$Z.offset/4;else{s$b=(s$c=s$_.vertexStride/4)+2,s$l=this._vertexCount?new Float32Array(this._vertexCount*(s$h.vertexDeclaration.vertexStride/4+2)):new Float32Array(s$h.vertexCount*(s$h.vertexDeclaration.vertexStride/4+2)),s$q=(s$Y=s$_.getVertexElementByUsage(2).offset/4)+2;var s$r=s$h.getData();for(s$x=0,s$t=s$r.length/s$c;s$x<s$t;s$x++){var s$a=0;s$a=0<this._vertexCount?(this._vertexStart+s$x)*s$c:s$x*s$c;var s$k=s$x*s$b,s$e=0;for(s$e=0;s$e<s$q;s$e++)s$l[s$k+s$e]=s$r[s$a+s$e];for(s$e=s$q;s$e<s$c;s$e++)s$l[s$k+s$e+2]=s$r[s$a+s$e]}}else s$b=s$_.vertexStride/4,s$l=this._vertexCount?s$h.getData().slice(this._vertexStart*s$b,(this._vertexStart+this._vertexCount)*s$b):s$h.getData().slice();if(s$d){var s$w=s$d.worldMatrix,s$s=s$g._tempMatrix4x40;s$w.invert(s$s);var s$A=s$g._tempMatrix4x41,s$y=s$L.transform.worldMatrix;s$dL.multiply(s$s,s$y,s$A)}else s$A=s$L.transform.worldMatrix;var s$$=s$g._tempQuaternion0;for(s$A.decomposeTransRotScale(s$g._tempVector30,s$$,s$g._tempVector31),s$x=0,s$t=s$l.length/s$b;s$x<s$t;s$x++){var s$O=s$x*s$b+s$N,s$n=s$x*s$b+s$m;if(s$aL.transformVector3ArrayToVector3ArrayCoordinate(s$l,s$O,s$A,s$l,s$O),s$aL.transformVector3ArrayByQuat(s$l,s$n,s$$,s$l,s$n),s$u){var s$V=s$x*s$b+s$q;if(s$Z)s$aL.transformLightingMapTexcoordByUV1Array(s$l,s$V,s$u,s$l,s$V);else{var s$Q=s$x*s$c+s$Y;s$aL.transformLightingMapTexcoordByUV0Array(s$r,s$Q,s$u,s$l,s$V)}}}return s$l},s$d._getVertexBuffers=function(){return null},s$d._beforeRender=function(s$d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},s$d._render=function(s$d){var s$L,s$l=0,s$Z=s$d.renderElement;if(1<this._indexCount){var s$h=this._boneIndicesList.length;if(1<s$h){for(var s$_=0;s$_<s$h;s$_++)(s$L=s$Z._skinAnimationDatas||this._skinAnimationDatas)&&(s$Z._shaderValue.setValue(0,s$L[s$_]),s$d._shader.uploadRenderElementUniforms(s$Z._shaderValue.data)),s$F.mainContext.drawElements(4,this._subIndexBufferCount[s$_],5123,2*this._subIndexBufferStart[s$_]);s$O.drawCall+=s$h}else(s$L=s$Z._skinAnimationDatas||this._skinAnimationDatas)&&(s$Z._shaderValue.setValue(0,s$L[0]),s$d._shader.uploadRenderElementUniforms(s$Z._shaderValue.data)),s$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),s$O.drawCall++;s$l=this._indexCount}else s$l=this._indexBuffer.indexCount,(s$L=s$Z._skinAnimationDatas||this._skinAnimationDatas)&&(s$Z._shaderValue.setValue(0,s$L[0]),s$d._shader.uploadRenderElementUniforms(s$Z._shaderValue.data)),s$F.mainContext.drawElements(4,s$l,5123,0),s$O.drawCall++;s$O.trianglesFaces+=s$l/3},s$d.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},s$d.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},s$c(0,s$d,"_vertexBufferCount",function(){return 1}),s$c(0,s$d,"triangleCount",function(){return this._indexBuffer.indexCount/3}),s$b(s$g,["_tempVector30",function(){return this._tempVector30=new s$NL},"_tempVector31",function(){return this._tempVector31=new s$NL},"_tempQuaternion0",function(){return this._tempQuaternion0=new s$lL},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new s$dL},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new s$dL}]),s$g}(),s$tL=function(){function s$d(s$d){this.defineCounter=0,this.defines=null,s$d?(this.defineCounter=s$d.defineCounter,this.defines=s$d.defines.slice()):(this.defineCounter=0,this.defines=[])}return s$Y(s$d,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),s$d.prototype.registerDefine=function(s$d){var s$L=Math.pow(2,this.defineCounter++);return this.defines[s$L]=s$d,s$L},s$d}(),s$bL=function(){function s$d(){}return s$Y(s$d,"laya.d3.shader.ShaderInit3D"),s$d.__init__=function(){var s$d,s$L;s$OL._globalRegDefine("HIGHPRECISION",s$OL.SHADERDEFINE_HIGHPRECISION),s$OL._globalRegDefine("FOG",s$OL.SHADERDEFINE_FOG),s$OL._globalRegDefine("DIRECTIONLIGHT",s$OL.SHADERDEFINE_DIRECTIONLIGHT),s$OL._globalRegDefine("POINTLIGHT",s$OL.SHADERDEFINE_POINTLIGHT),s$OL._globalRegDefine("SPOTLIGHT",s$OL.SHADERDEFINE_SPOTLIGHT),s$OL._globalRegDefine("UV",s$OL.SHADERDEFINE_UV0),s$OL._globalRegDefine("COLOR",s$OL.SHADERDEFINE_COLOR),s$OL._globalRegDefine("UV1",s$OL.SHADERDEFINE_UV1),s$OL._globalRegDefine("CASTSHADOW",s$YL.SHADERDEFINE_CAST_SHADOW),s$OL._globalRegDefine("SHADOWMAP_PSSM1",s$YL.SHADERDEFINE_SHADOW_PSSM1),s$OL._globalRegDefine("SHADOWMAP_PSSM2",s$YL.SHADERDEFINE_SHADOW_PSSM2),s$OL._globalRegDefine("SHADOWMAP_PSSM3",s$YL.SHADERDEFINE_SHADOW_PSSM3),s$OL._globalRegDefine("SHADOWMAP_PCF_NO",s$YL.SHADERDEFINE_SHADOW_PCF_NO),s$OL._globalRegDefine("SHADOWMAP_PCF1",s$YL.SHADERDEFINE_SHADOW_PCF1),s$OL._globalRegDefine("SHADOWMAP_PCF2",s$YL.SHADERDEFINE_SHADOW_PCF2),s$OL._globalRegDefine("SHADOWMAP_PCF3",s$YL.SHADERDEFINE_SHADOW_PCF3),s$OL._globalRegDefine("DEPTHFOG",s$OL.SAHDERDEFINE_DEPTHFOG),s$jL.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),s$jL.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),s$d={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},s$L={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var s$l=s$jL.nameKey.add("SIMPLE");shaderCompile=s$OL.add(s$l,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',s$d,s$L),s$RL.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),s$RL.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),s$RL.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),s$RL.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),s$RL.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),s$RL.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),s$RL.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),s$RL.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),s$RL.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},s$d}(),s$qL=function(){function s$d(){this._data=null,this._data=[]}s$Y(s$d,"laya.d3.shader.ValusArray");var s$L=s$d.prototype;return s$L.setValue=function(s$d,s$L){this._data[s$d]=s$L},s$c(0,s$L,"data",function(){return this._data}),s$d}(),s$YL=function(){function s$d(){}return s$d.SHADERDEFINE_RECEIVE_SHADOW=1,s$d.SHADERDEFINE_CAST_SHADOW=512,s$d.SHADERDEFINE_SHADOW_PSSM1=1024,s$d.SHADERDEFINE_SHADOW_PSSM2=2048,s$d.SHADERDEFINE_SHADOW_PSSM3=4096,s$d.SHADERDEFINE_SHADOW_PCF_NO=8192,s$d.SHADERDEFINE_SHADOW_PCF1=16384,s$d.SHADERDEFINE_SHADOW_PCF2=32768,s$d.SHADERDEFINE_SHADOW_PCF3=65536,s$d.MAX_PSSM_COUNT=3,s$d}(),s$cL=function(){function s$K(){}return s$Y(s$K,"laya.d3.utils.Picker"),s$K.calculateCursorRay=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$d.elements[0],s$m=s$d.elements[1],s$u=s$K._tempVector30,s$x=s$u.elements;s$x[0]=s$N,s$x[1]=s$m,s$x[2]=s$L.minDepth;var s$t=s$K._tempVector31,s$b=s$t.elements;s$b[0]=s$N,s$b[1]=s$m,s$b[2]=s$L.maxDepth;var s$q=s$_.origin,s$Y=s$K._tempVector32;s$L.unprojectFromWVP(s$u,s$l,s$Z,s$h,s$q),s$L.unprojectFromWVP(s$t,s$l,s$Z,s$h,s$Y);var s$c=s$_.direction.elements;s$c[0]=s$Y.x-s$q.x,s$c[1]=s$Y.y-s$q.y,s$c[2]=s$Y.z-s$q.z,s$NL.normalize(s$_.direction,s$_.direction)},s$K.rayIntersectsPositionsAndIndices=function(s$d,s$L,s$l,s$Z,s$h){for(var s$_=s$l.vertexStride/4,s$N=s$l.getVertexElementByUsage(0).offset/4,s$m=Number.MAX_VALUE,s$u=-1,s$x=-1,s$t=-1,s$b=0;s$b<s$Z.length;s$b+=3){var s$q=s$K._tempVector35,s$Y=s$q.elements,s$c=s$Z[s$b]*s$_,s$r=s$c+s$N;s$Y[0]=s$L[s$r],s$Y[1]=s$L[1+s$r],s$Y[2]=s$L[2+s$r];var s$a=s$K._tempVector36,s$k=s$a.elements,s$e=s$Z[s$b+1]*s$_,s$w=s$e+s$N;s$k[0]=s$L[s$w],s$k[1]=s$L[1+s$w],s$k[2]=s$L[2+s$w];var s$s=s$K._tempVector37,s$A=s$s.elements,s$y=s$Z[s$b+2]*s$_,s$$=s$y+s$N;s$A[0]=s$L[s$$],s$A[1]=s$L[1+s$$],s$A[2]=s$L[2+s$$];var s$O=laya.d3.utils.Picker.rayIntersectsTriangle(s$d,s$q,s$a,s$s);!isNaN(s$O)&&s$O<s$m&&(s$m=s$O,s$u=s$c,s$x=s$e,s$t=s$y)}if(s$m===Number.MAX_VALUE)return s$h.position.toDefault(),s$h.distance=Number.MAX_VALUE,s$h.trianglePositions[0].toDefault(),s$h.trianglePositions[1].toDefault(),s$h.trianglePositions[2].toDefault(),s$h.triangleNormals[0].toDefault(),s$h.triangleNormals[1].toDefault(),s$h.triangleNormals[2].toDefault(),!1;s$h.distance=s$m,s$NL.scale(s$d.direction,s$m,s$h.position),s$NL.add(s$d.origin,s$h.position,s$h.position);var s$n=s$h.trianglePositions,s$V=s$n[0],s$Q=s$n[1],s$g=s$n[2],s$F=s$V.elements,s$E=s$Q.elements,s$I=s$g.elements,s$p=s$u+s$N;s$F[0]=s$L[s$p],s$F[1]=s$L[s$p+1],s$F[2]=s$L[s$p+2];var s$H=s$x+s$N;s$E[0]=s$L[s$H],s$E[1]=s$L[s$H+1],s$E[2]=s$L[s$H+2];var s$X=s$t+s$N;s$I[0]=s$L[s$X],s$I[1]=s$L[s$X+1],s$I[2]=s$L[s$X+2];var s$j=s$l.getVertexElementByUsage(3);if(s$j){var s$R=s$j.offset/4,s$o=s$h.triangleNormals,s$i=s$o[0],s$S=s$o[1],s$B=s$o[2],s$C=s$i.elements,s$P=s$S.elements,s$T=s$B.elements,s$z=s$u+s$R;s$C[0]=s$L[s$z],s$C[1]=s$L[s$z+1],s$C[2]=s$L[s$z+2];var s$D=s$x+s$R;s$P[0]=s$L[s$D],s$P[1]=s$L[s$D+1],s$P[2]=s$L[s$D+2];var s$G=s$t+s$R;s$T[0]=s$L[s$G],s$T[1]=s$L[s$G+1],s$T[2]=s$L[s$G+2]}return!0},s$K.rayIntersectsTriangle=function(s$d,s$L,s$l,s$Z){var s$h=s$K._tempVector30,s$_=s$K._tempVector31;s$NL.subtract(s$l,s$L,s$h),s$NL.subtract(s$Z,s$L,s$_);var s$N,s$m=s$K._tempVector32;if(s$NL.cross(s$d.direction,s$_,s$m),(s$N=s$NL.dot(s$h,s$m))>-Number.MIN_VALUE&&s$N<Number.MIN_VALUE)return Number.NaN;var s$u,s$x=1/s$N,s$t=s$K._tempVector33;if(s$NL.subtract(s$d.origin,s$L,s$t),s$u=s$NL.dot(s$t,s$m),(s$u*=s$x)<0||1<s$u)return Number.NaN;var s$b,s$q,s$Y=s$K._tempVector34;return s$NL.cross(s$t,s$h,s$Y),s$b=s$NL.dot(s$d.direction,s$Y),(s$b*=s$x)<0||1<s$u+s$b?Number.NaN:(s$q=s$NL.dot(s$_,s$Y),(s$q*=s$x)<0?Number.NaN:s$q)},s$b(s$K,["_tempVector30",function(){return this._tempVector30=new s$NL},"_tempVector31",function(){return this._tempVector31=new s$NL},"_tempVector32",function(){return this._tempVector32=new s$NL},"_tempVector33",function(){return this._tempVector33=new s$NL},"_tempVector34",function(){return this._tempVector34=new s$NL},"_tempVector35",function(){return this._tempVector35=new s$NL},"_tempVector36",function(){return this._tempVector36=new s$NL},"_tempVector37",function(){return this._tempVector37=new s$NL}]),s$K}(),s$rL=(function(){function s$d(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new s$NL,new s$NL,new s$NL],this.trianglePositions.length=3,this.triangleNormals=[new s$NL,new s$NL,new s$NL],this.triangleNormals.length=3,this.position=new s$NL}s$Y(s$d,"laya.d3.utils.RaycastHit"),s$d.prototype.cloneTo=function(s$d){s$d.distance=this.distance,this.trianglePositions[0].cloneTo(s$d.trianglePositions[0]),this.trianglePositions[1].cloneTo(s$d.trianglePositions[1]),this.trianglePositions[2].cloneTo(s$d.trianglePositions[2]),this.triangleNormals[0].cloneTo(s$d.triangleNormals[0]),this.triangleNormals[1].cloneTo(s$d.triangleNormals[1]),this.triangleNormals[2].cloneTo(s$d.triangleNormals[2]),this.position.cloneTo(s$d.position),s$d.sprite3D=this.sprite3D}}(),function(){function s$d(s$d,s$L){this._width=0,this._height=0,this._width=s$d,this._height=s$L}s$Y(s$d,"laya.d3.utils.Size");var s$L=s$d.prototype;return s$c(0,s$L,"width",function(){return-1===this._width?s$v.clientWidth:this._width}),s$c(0,s$L,"height",function(){return-1===this._height?s$v.clientHeight:this._height}),s$c(1,s$d,"fullScreen",function(){return new s$d(-1,-1)}),s$d}()),s$aL=function(){function s$p(){}return s$Y(s$p,"laya.d3.utils.Utils3D"),s$p._rotationTransformScaleSkinAnimation=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b){var s$q,s$Y,s$c,s$r,s$a,s$k=s$p._tempArray16_0,s$e=s$p._tempArray16_1,s$w=s$p._tempArray16_2,s$s=s$Z+s$Z,s$A=s$h+s$h,s$y=s$_+s$_,s$$=s$Z*s$s,s$O=s$h*s$s,s$n=s$h*s$A,s$V=s$_*s$s,s$Q=s$_*s$A,s$g=s$_*s$y,s$F=s$N*s$s,s$E=s$N*s$A,s$I=s$N*s$y;for(s$k[15]=1,s$k[0]=1-s$n-s$g,s$k[1]=s$O+s$I,s$k[2]=s$V-s$E,s$k[4]=s$O-s$I,s$k[5]=1-s$$-s$g,s$k[6]=s$Q+s$F,s$k[8]=s$V+s$E,s$k[9]=s$Q-s$F,s$k[10]=1-s$$-s$n,s$e[15]=1,s$e[0]=s$m,s$e[5]=s$u,s$e[10]=s$x,s$q=0;s$q<4;s$q++)s$Y=s$k[s$q],s$c=s$k[s$q+4],s$r=s$k[s$q+8],s$a=s$k[s$q+12],s$w[s$q]=s$Y,s$w[s$q+4]=s$c,s$w[s$q+8]=s$r,s$w[s$q+12]=s$Y*s$d+s$c*s$L+s$r*s$l+s$a;for(s$q=0;s$q<4;s$q++)s$Y=s$w[s$q],s$c=s$w[s$q+4],s$r=s$w[s$q+8],s$a=s$w[s$q+12],s$t[s$q+s$b]=s$Y*s$e[0]+s$c*s$e[1]+s$r*s$e[2]+s$a*s$e[3],s$t[s$q+s$b+4]=s$Y*s$e[4]+s$c*s$e[5]+s$r*s$e[6]+s$a*s$e[7],s$t[s$q+s$b+8]=s$Y*s$e[8]+s$c*s$e[9]+s$r*s$e[10]+s$a*s$e[11],s$t[s$q+s$b+12]=s$Y*s$e[12]+s$c*s$e[13]+s$r*s$e[14]+s$a*s$e[15]},s$p._createNodeByJson=function(s$d,s$L,s$l,s$Z){if(!s$l)switch(s$L.type){case"Sprite3D":s$l=new s$XL;break;case"MeshSprite3D":s$l=new s$KL;break;case"SkinnedMeshSprite3D":s$l=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":s$l=new ShuriKenParticle3D;break;case"TrailSprite3D":s$l=new TrailSprite3D;break;case"Terrain":s$l=new Terrain;break;case"Camera":s$l=new s$GL;break;case"DirectionLight":s$l=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var s$h=s$L.props;if(s$h)for(var s$_ in s$h)s$l[s$_]=s$h[s$_];var s$N=s$L.customProps;s$N&&(s$l instanceof laya.d3.core.Sprite3D?(s$l._parseBaseCustomProps(s$N),s$l._parseCustomProps(s$d,s$Z,s$N,s$L),s$l._parseCustomComponent(s$d,s$Z,s$L.components)):s$l._parseCustomProps(s$d,s$Z,s$N,s$L));var s$m=s$L.child;if(s$m)for(var s$u=0,s$x=s$m.length;s$u<s$x;s$u++){var s$t=s$p._createNodeByJson(s$d,s$m[s$u],null,s$Z);s$l.addChild(s$t)}return s$l},s$p._computeBoneAndAnimationDatasByBindPoseMatrxix=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m,s$u=0,s$x=0,s$t=s$d.length;for(s$N=0;s$N<s$t;s$u+=s$d[s$N].keyframeWidth,s$x+=16,s$N++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(s$L[s$u+0],s$L[s$u+1],s$L[s$u+2],s$L[s$u+3],s$L[s$u+4],s$L[s$u+5],s$L[s$u+6],s$L[s$u+7],s$L[s$u+8],s$L[s$u+9],s$Z,s$x),0!=s$N&&(s$m=16*s$d[s$N].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(s$Z,s$m,s$Z,s$x,s$Z,s$x));var s$b=s$l.length;for(s$N=0;s$N<s$b;s$N++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(s$Z,16*s$_[s$N],s$l[s$N],s$h,16*s$N)},s$p._computeAnimationDatasByArrayAndMatrixFast=function(s$d,s$L,s$l,s$Z){for(var s$h=0,s$_=s$d.length;s$h<s$_;s$h++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(s$L,16*s$Z[s$h],s$d[s$h],s$l,16*s$h)},s$p._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N,s$m=0,s$u=0,s$x=s$d.length;for(s$_=0;s$_<s$x;s$m+=s$d[s$_].keyframeWidth,s$u+=16,s$_++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(s$L[s$m+7],s$L[s$m+8],s$L[s$m+9],s$L[s$m+3],s$L[s$m+4],s$L[s$m+5],s$L[s$m+6],s$L[s$m+0],s$L[s$m+1],s$L[s$m+2],s$Z,s$u),0!=s$_&&(s$N=16*s$d[s$_].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(s$Z,s$N,s$Z,s$u,s$Z,s$u));var s$t=s$l.length;for(s$_=0;s$_<s$t;s$_++){var s$b=16*s$_;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(s$Z,s$b,s$l[s$_],s$h,s$b)}},s$p._computeAnimationDatasByArrayAndMatrixFastOld=function(s$d,s$L,s$l){for(var s$Z=s$d.length,s$h=0;s$h<s$Z;s$h++){var s$_=16*s$h;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(s$L,s$_,s$d[s$h],s$l,s$_)}},s$p._computeRootAnimationData=function(s$d,s$L,s$l){for(var s$Z=0,s$h=0,s$_=0,s$N=s$d.length;s$Z<s$N;s$h+=s$d[s$Z].keyframeWidth,s$_+=16,s$Z++)laya.d3.utils.Utils3D.createAffineTransformationArray(s$L[s$h+0],s$L[s$h+1],s$L[s$h+2],s$L[s$h+3],s$L[s$h+4],s$L[s$h+5],s$L[s$h+6],s$L[s$h+7],s$L[s$h+8],s$L[s$h+9],s$l,s$_)},s$p.transformVector3ArrayByQuat=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$l.elements,s$N=s$d[s$L],s$m=s$d[s$L+1],s$u=s$d[s$L+2],s$x=s$_[0],s$t=s$_[1],s$b=s$_[2],s$q=s$_[3],s$Y=s$q*s$N+s$t*s$u-s$b*s$m,s$c=s$q*s$m+s$b*s$N-s$x*s$u,s$r=s$q*s$u+s$x*s$m-s$t*s$N,s$a=-s$x*s$N-s$t*s$m-s$b*s$u;s$Z[s$h]=s$Y*s$q+s$a*-s$x+s$c*-s$b-s$r*-s$t,s$Z[s$h+1]=s$c*s$q+s$a*-s$t+s$r*-s$x-s$Y*-s$b,s$Z[s$h+2]=s$r*s$q+s$a*-s$b+s$Y*-s$t-s$c*-s$x},s$p.mulMatrixByArray=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m,s$u,s$x,s$t;if(s$h===s$l){for(s$l=s$p._tempArray16_3,s$N=0;s$N<16;++s$N)s$l[s$N]=s$h[s$_+s$N];s$Z=0}for(s$N=0;s$N<4;s$N++)s$m=s$d[s$L+s$N],s$u=s$d[s$L+s$N+4],s$x=s$d[s$L+s$N+8],s$t=s$d[s$L+s$N+12],s$h[s$_+s$N]=s$m*s$l[s$Z+0]+s$u*s$l[s$Z+1]+s$x*s$l[s$Z+2]+s$t*s$l[s$Z+3],s$h[s$_+s$N+4]=s$m*s$l[s$Z+4]+s$u*s$l[s$Z+5]+s$x*s$l[s$Z+6]+s$t*s$l[s$Z+7],s$h[s$_+s$N+8]=s$m*s$l[s$Z+8]+s$u*s$l[s$Z+9]+s$x*s$l[s$Z+10]+s$t*s$l[s$Z+11],s$h[s$_+s$N+12]=s$m*s$l[s$Z+12]+s$u*s$l[s$Z+13]+s$x*s$l[s$Z+14]+s$t*s$l[s$Z+15]},s$p.mulMatrixByArrayFast=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m,s$u,s$x,s$t;for(s$N=0;s$N<4;s$N++)s$m=s$d[s$L+s$N],s$u=s$d[s$L+s$N+4],s$x=s$d[s$L+s$N+8],s$t=s$d[s$L+s$N+12],s$h[s$_+s$N]=s$m*s$l[s$Z+0]+s$u*s$l[s$Z+1]+s$x*s$l[s$Z+2]+s$t*s$l[s$Z+3],s$h[s$_+s$N+4]=s$m*s$l[s$Z+4]+s$u*s$l[s$Z+5]+s$x*s$l[s$Z+6]+s$t*s$l[s$Z+7],s$h[s$_+s$N+8]=s$m*s$l[s$Z+8]+s$u*s$l[s$Z+9]+s$x*s$l[s$Z+10]+s$t*s$l[s$Z+11],s$h[s$_+s$N+12]=s$m*s$l[s$Z+12]+s$u*s$l[s$Z+13]+s$x*s$l[s$Z+14]+s$t*s$l[s$Z+15]},s$p.mulMatrixByArrayAndMatrixFast=function(s$d,s$L,s$l,s$Z,s$h){var s$_,s$N,s$m,s$u,s$x,s$t=s$l.elements,s$b=s$t[0],s$q=s$t[1],s$Y=s$t[2],s$c=s$t[3],s$r=s$t[4],s$a=s$t[5],s$k=s$t[6],s$e=s$t[7],s$w=s$t[8],s$s=s$t[9],s$A=s$t[10],s$y=s$t[11],s$$=s$t[12],s$O=s$t[13],s$n=s$t[14],s$V=s$t[15],s$Q=s$L,s$g=s$L+4,s$F=s$L+8,s$E=s$L+12,s$I=s$h,s$p=s$h+4,s$H=s$h+8,s$X=s$h+12;for(s$_=0;s$_<4;s$_++)s$N=s$d[s$Q+s$_],s$m=s$d[s$g+s$_],s$u=s$d[s$F+s$_],s$x=s$d[s$E+s$_],s$Z[s$I+s$_]=s$N*s$b+s$m*s$q+s$u*s$Y+s$x*s$c,s$Z[s$p+s$_]=s$N*s$r+s$m*s$a+s$u*s$k+s$x*s$e,s$Z[s$H+s$_]=s$N*s$w+s$m*s$s+s$u*s$A+s$x*s$y,s$Z[s$X+s$_]=s$N*s$$+s$m*s$O+s$u*s$n+s$x*s$V},s$p.createAffineTransformationArray=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b){var s$q=s$Z+s$Z,s$Y=s$h+s$h,s$c=s$_+s$_,s$r=s$Z*s$q,s$a=s$Z*s$Y,s$k=s$Z*s$c,s$e=s$h*s$Y,s$w=s$h*s$c,s$s=s$_*s$c,s$A=s$N*s$q,s$y=s$N*s$Y,s$$=s$N*s$c;s$t[s$b+0]=(1-(s$e+s$s))*s$m,s$t[s$b+1]=(s$a+s$$)*s$m,s$t[s$b+2]=(s$k-s$y)*s$m,s$t[s$b+3]=0,s$t[s$b+4]=(s$a-s$$)*s$u,s$t[s$b+5]=(1-(s$r+s$s))*s$u,s$t[s$b+6]=(s$w+s$A)*s$u,s$t[s$b+7]=0,s$t[s$b+8]=(s$k+s$y)*s$x,s$t[s$b+9]=(s$w-s$A)*s$x,s$t[s$b+10]=(1-(s$r+s$e))*s$x,s$t[s$b+11]=0,s$t[s$b+12]=s$d,s$t[s$b+13]=s$L,s$t[s$b+14]=s$l,s$t[s$b+15]=1},s$p.transformVector3ArrayToVector3ArrayCoordinate=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$p._tempArray4_0,s$N=s$d[s$L+0],s$m=s$d[s$L+1],s$u=s$d[s$L+2],s$x=s$l.elements;s$_[0]=s$N*s$x[0]+s$m*s$x[4]+s$u*s$x[8]+s$x[12],s$_[1]=s$N*s$x[1]+s$m*s$x[5]+s$u*s$x[9]+s$x[13],s$_[2]=s$N*s$x[2]+s$m*s$x[6]+s$u*s$x[10]+s$x[14],s$_[3]=1/(s$N*s$x[3]+s$m*s$x[7]+s$u*s$x[11]+s$x[15]),s$Z[s$h+0]=s$_[0]*s$_[3],s$Z[s$h+1]=s$_[1]*s$_[3],s$Z[s$h+2]=s$_[2]*s$_[3]},s$p.transformLightingMapTexcoordByUV0Array=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$l.elements;s$Z[s$h+0]=s$d[s$L+0]*s$_[0]+s$_[2],s$Z[s$h+1]=(s$d[s$L+1]-1)*s$_[1]+s$_[3]},s$p.transformLightingMapTexcoordByUV1Array=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$l.elements;s$Z[s$h+0]=s$d[s$L+0]*s$_[0]+s$_[2],s$Z[s$h+1]=1+s$d[s$L+1]*s$_[1]+s$_[3]},s$p.getURLVerion=function(s$d){var s$L=s$d.indexOf("?");return 0<=s$L?s$d.substr(s$L):null},s$p._quaternionCreateFromYawPitchRollArray=function(s$d,s$L,s$l,s$Z){var s$h=.5*s$l,s$_=.5*s$L,s$N=.5*s$d,s$m=Math.sin(s$h),s$u=Math.cos(s$h),s$x=Math.sin(s$_),s$t=Math.cos(s$_),s$b=Math.sin(s$N),s$q=Math.cos(s$N);s$Z[0]=s$q*s$x*s$u+s$b*s$t*s$m,s$Z[1]=s$b*s$t*s$u-s$q*s$x*s$m,s$Z[2]=s$q*s$t*s$m-s$b*s$x*s$u,s$Z[3]=s$q*s$t*s$u+s$b*s$x*s$m},s$p._createAffineTransformationArray=function(s$d,s$L,s$l,s$Z){var s$h=s$L[0],s$_=s$L[1],s$N=s$L[2],s$m=s$L[3],s$u=s$h+s$h,s$x=s$_+s$_,s$t=s$N+s$N,s$b=s$h*s$u,s$q=s$h*s$x,s$Y=s$h*s$t,s$c=s$_*s$x,s$r=s$_*s$t,s$a=s$N*s$t,s$k=s$m*s$u,s$e=s$m*s$x,s$w=s$m*s$t,s$s=s$l[0],s$A=s$l[1],s$y=s$l[2];s$Z[0]=(1-(s$c+s$a))*s$s,s$Z[1]=(s$q+s$w)*s$s,s$Z[2]=(s$Y-s$e)*s$s,s$Z[3]=0,s$Z[4]=(s$q-s$w)*s$A,s$Z[5]=(1-(s$b+s$a))*s$A,s$Z[6]=(s$r+s$k)*s$A,s$Z[7]=0,s$Z[8]=(s$Y+s$e)*s$y,s$Z[9]=(s$r-s$k)*s$y,s$Z[10]=(1-(s$b+s$c))*s$y,s$Z[11]=0,s$Z[12]=s$d[0],s$Z[13]=s$d[1],s$Z[14]=s$d[2],s$Z[15]=1},s$p._mulMatrixArray=function(s$d,s$L,s$l,s$Z){var s$h,s$_,s$N,s$m,s$u,s$x=s$L.elements,s$t=s$x[0],s$b=s$x[1],s$q=s$x[2],s$Y=s$x[3],s$c=s$x[4],s$r=s$x[5],s$a=s$x[6],s$k=s$x[7],s$e=s$x[8],s$w=s$x[9],s$s=s$x[10],s$A=s$x[11],s$y=s$x[12],s$$=s$x[13],s$O=s$x[14],s$n=s$x[15],s$V=s$Z,s$Q=s$Z+4,s$g=s$Z+8,s$F=s$Z+12;for(s$h=0;s$h<4;s$h++)s$_=s$d[s$h],s$N=s$d[s$h+4],s$m=s$d[s$h+8],s$u=s$d[s$h+12],s$l[s$V+s$h]=s$_*s$t+s$N*s$b+s$m*s$q+s$u*s$Y,s$l[s$Q+s$h]=s$_*s$c+s$N*s$r+s$m*s$a+s$u*s$k,s$l[s$g+s$h]=s$_*s$e+s$N*s$w+s$m*s$s+s$u*s$A,s$l[s$F+s$h]=s$_*s$y+s$N*s$$+s$m*s$O+s$u*s$n},s$p.getYawPitchRoll=function(s$d,s$L){s$p.transformQuat(s$NL.ForwardRH,s$d,s$lL.TEMPVector31),s$p.transformQuat(s$NL.Up,s$d,s$lL.TEMPVector32);var s$l=s$lL.TEMPVector32.elements;s$p.angleTo(s$NL.ZERO,s$lL.TEMPVector31,s$lL.TEMPVector33);var s$Z=s$lL.TEMPVector33.elements;s$Z[0]==Math.PI/2?(s$Z[1]=s$p.arcTanAngle(s$l[2],s$l[0]),s$Z[2]=0):s$Z[0]==-Math.PI/2?(s$Z[1]=s$p.arcTanAngle(-s$l[2],-s$l[0]),s$Z[2]=0):(s$dL.createRotationY(-s$Z[1],s$lL.TEMPMatrix0),s$dL.createRotationX(-s$Z[0],s$lL.TEMPMatrix1),s$NL.transformCoordinate(s$lL.TEMPVector32,s$lL.TEMPMatrix0,s$lL.TEMPVector32),s$NL.transformCoordinate(s$lL.TEMPVector32,s$lL.TEMPMatrix1,s$lL.TEMPVector32),s$Z[2]=s$p.arcTanAngle(s$l[1],-s$l[0])),s$Z[1]<=-Math.PI&&(s$Z[1]=Math.PI),s$Z[2]<=-Math.PI&&(s$Z[2]=Math.PI),s$Z[1]>=Math.PI&&s$Z[2]>=Math.PI&&(s$Z[1]=0,s$Z[2]=0,s$Z[0]=Math.PI-s$Z[0]),s$L[0]=s$Z[1],s$L[1]=s$Z[0],s$L[2]=s$Z[2]},s$p.arcTanAngle=function(s$d,s$L){return 0==s$d?1==s$L?Math.PI/2:-Math.PI/2:0<s$d?Math.atan(s$L/s$d):s$d<0?0<s$L?Math.atan(s$L/s$d)+Math.PI:Math.atan(s$L/s$d)-Math.PI:0},s$p.angleTo=function(s$d,s$L,s$l){s$NL.subtract(s$L,s$d,s$lL.TEMPVector30),s$NL.normalize(s$lL.TEMPVector30,s$lL.TEMPVector30),s$l.elements[0]=Math.asin(s$lL.TEMPVector30.y),s$l.elements[1]=s$p.arcTanAngle(-s$lL.TEMPVector30.z,-s$lL.TEMPVector30.x)},s$p.transformQuat=function(s$d,s$L,s$l){var s$Z=s$l.elements,s$h=s$d.elements,s$_=s$L,s$N=s$h[0],s$m=s$h[1],s$u=s$h[2],s$x=s$_[0],s$t=s$_[1],s$b=s$_[2],s$q=s$_[3],s$Y=s$q*s$N+s$t*s$u-s$b*s$m,s$c=s$q*s$m+s$b*s$N-s$x*s$u,s$r=s$q*s$u+s$x*s$m-s$t*s$N,s$a=-s$x*s$N-s$t*s$m-s$b*s$u;s$Z[0]=s$Y*s$q+s$a*-s$x+s$c*-s$b-s$r*-s$t,s$Z[1]=s$c*s$q+s$a*-s$t+s$r*-s$x-s$Y*-s$b,s$Z[2]=s$r*s$q+s$a*-s$b+s$Y*-s$t-s$c*-s$x},s$p.quaterionNormalize=function(s$d,s$L){var s$l=s$d[0],s$Z=s$d[1],s$h=s$d[2],s$_=s$d[3],s$N=s$l*s$l+s$Z*s$Z+s$h*s$h+s$_*s$_;0<s$N&&(s$N=1/Math.sqrt(s$N),s$L[0]=s$l*s$N,s$L[1]=s$Z*s$N,s$L[2]=s$h*s$N,s$L[3]=s$_*s$N)},s$p.matrix4x4MultiplyFFF=function(s$d,s$L,s$l){var s$Z,s$h,s$_,s$N,s$m;if(s$l===s$L)for(s$L=new Float32Array(16),s$Z=0;s$Z<16;++s$Z)s$L[s$Z]=s$l[s$Z];for(s$Z=0;s$Z<4;s$Z++)s$h=s$d[s$Z],s$_=s$d[s$Z+4],s$N=s$d[s$Z+8],s$m=s$d[s$Z+12],s$l[s$Z]=s$h*s$L[0]+s$_*s$L[1]+s$N*s$L[2]+s$m*s$L[3],s$l[s$Z+4]=s$h*s$L[4]+s$_*s$L[5]+s$N*s$L[6]+s$m*s$L[7],s$l[s$Z+8]=s$h*s$L[8]+s$_*s$L[9]+s$N*s$L[10]+s$m*s$L[11],s$l[s$Z+12]=s$h*s$L[12]+s$_*s$L[13]+s$N*s$L[14]+s$m*s$L[15]},s$p.matrix4x4MultiplyMFM=function(s$d,s$L,s$l){s$p.matrix4x4MultiplyFFF(s$d.elements,s$L,s$l.elements)},s$b(s$p,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new s$NL},"_tempVector3_1",function(){return this._tempVector3_1=new s$NL},"_tempVector3_2",function(){return this._tempVector3_2=new s$NL},"_tempVector3_3",function(){return this._tempVector3_3=new s$NL},"_tempVector3_4",function(){return this._tempVector3_4=new s$NL},"_tempVector3_5",function(){return this._tempVector3_5=new s$NL},"_tempVector3_6",function(){return this._tempVector3_6=new s$NL},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),s$p}(),s$kL=function(){function s$E(){}return s$Y(s$E,"Laya3D"),s$E._cancelLoadByUrl=function(s$d){s$A.loader.cancelLoadByUrl(s$d),s$E._innerFirstLevelLoaderManager.cancelLoadByUrl(s$d),s$E._innerSecondLevelLoaderManager.cancelLoadByUrl(s$d),s$E._innerThirdLevelLoaderManager.cancelLoadByUrl(s$d),s$E._innerFourthLevelLoaderManager.cancelLoadByUrl(s$d)},s$E._changeWebGLSize=function(s$d,s$L){s$F.onStageResize(s$d,s$L),s$v.clientWidth=s$d,s$v.clientHeight=s$L},s$E.__init__=function(){var s$d=s$L.createMap;s$d.lh=[s$XL,"SPRITE3DHIERARCHY"],s$d.ls=[s$HL,"SPRITE3DHIERARCHY"],s$d.lm=[s$CL,"MESH"],s$d.lmat=[s$RL,"MATERIAL"],s$d.jpg=[s$TL,"nativeimage"],s$d.jpeg=[s$TL,"nativeimage"],s$d.png=[s$TL,"nativeimage"],s$d.pkm=[s$TL,"arraybuffer"],s$d.raw=[s$SL,"arraybuffer"],s$d.mipmaps=[s$SL,"arraybuffer"],s$k.parserMap.SPRITE3DHIERARCHY=s$E._loadHierarchy,s$k.parserMap.MESH=s$E._loadMesh,s$k.parserMap.MATERIAL=s$E._loadMaterial,s$k.parserMap.TEXTURECUBE=s$E._loadTextureCube,s$k.parserMap.TERRAIN=s$E._loadTerrain,s$E._innerFirstLevelLoaderManager.on("error",null,s$E._eventLoadManagerError),s$E._innerSecondLevelLoaderManager.on("error",null,s$E._eventLoadManagerError),s$E._innerThirdLevelLoaderManager.on("error",null,s$E._eventLoadManagerError),s$E._innerFourthLevelLoaderManager.on("error",null,s$E._eventLoadManagerError)},s$E.READ_BLOCK=function(){return s$E._readData.pos+=4,!0},s$E.READ_DATA=function(){return s$E._DATA.offset=s$E._readData.getUint32(),s$E._DATA.size=s$E._readData.getUint32(),!0},s$E.READ_STRINGS=function(){var s$d=[],s$L={offset:0,size:0};s$L.offset=s$E._readData.getUint16(),s$L.size=s$E._readData.getUint16();s$E._readData.pos;s$E._readData.pos=s$L.offset+s$E._DATA.offset;for(var s$l=0;s$l<s$L.size;s$l++){var s$Z=s$E._readData.readUTFString();-1===s$Z.lastIndexOf(".lmat")&&-1===s$Z.lastIndexOf(".lpbr")||s$d.push(s$Z)}return s$d},s$E.formatRelativePath=function(s$d,s$L){var s$l;if("."===s$L.charAt(0)){for(var s$Z=(s$d+s$L).split("/"),s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)if(".."==s$Z[s$h]){var s$N=s$h-1;0<s$N&&".."!==s$Z[s$N]&&(s$Z.splice(s$N,2),s$h-=2)}s$l=s$Z.join("/")}else s$l=s$d+s$L;return null!=s$g.customFormat&&(s$l=s$g.customFormat(s$l,null)),s$l},s$E._eventLoadManagerError=function(s$d){s$A.loader.event("error",s$d)},s$E._addHierarchyInnerUrls=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N=s$E.formatRelativePath(s$Z,s$h);s$l&&(s$N+=s$l),s$d.push({url:s$N,clas:s$_}),s$L[s$h]=s$N},s$E._getSprite3DHierarchyInnerUrls=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){var s$m,s$u=0,s$x=0;switch(s$d.type){case"Scene":var s$t=s$d.customProps.lightmaps;for(s$u=0,s$x=s$t.length;s$u<s$x;s$u++){var s$b=s$t[s$u].replace(".exr",".png");s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$b,s$TL)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var s$q;if(s$d.instanceParams)(s$q=s$d.instanceParams.loadPath)&&s$E._addHierarchyInnerUrls(s$L,s$h,s$_,s$N,s$q,s$CL);else{(s$q=(s$m=s$d.customProps).meshPath)&&s$E._addHierarchyInnerUrls(s$L,s$h,s$_,s$N,s$q,s$CL);var s$Y=s$m.materials;if(s$Y)for(s$u=0,s$x=s$Y.length;s$u<s$x;s$u++){for(var s$c=s$Y[s$u],s$r=s$c.type.split("."),s$a=s$I.window,s$k=0,s$e=s$r.length;s$k<s$e;++s$k){s$a=s$a[this.clasPaths[s$k]]}if("function"!=typeof s$a)throw"_getSprite3DHierarchyInnerUrls 错误: "+s$c.type+" 不是类";s$E._addHierarchyInnerUrls(s$l,s$h,s$_,s$N,s$c.path,s$a)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var s$w=(s$m=s$d.customProps).meshPath;s$w&&s$E._addHierarchyInnerUrls(s$L,s$h,s$_,s$N,s$w,s$CL);var s$s=s$m.material;if(s$s){s$r=s$s.type.split("."),s$a=s$I.window;for(s$k=0,s$e=s$r.length;s$k<s$e;++s$k){s$a=s$a[this.clasPaths[s$k]]}s$E._addHierarchyInnerUrls(s$l,s$h,s$_,s$N,s$s.path,s$a)}else{var s$A=s$m.materialPath;if(s$A)s$E._addHierarchyInnerUrls(s$l,s$h,s$_,s$N,s$A,ShurikenParticleMaterial);else{var s$y=s$m.texturePath;s$y&&s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$y,s$TL)}}break;case"Terrain":s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$d.customProps.dataPath,TerrainRes)}var s$$=s$d.components;for(var s$O in s$$){var s$n=s$$[s$O];switch(s$O){case"Animator":var s$V=s$n.avatarPath;if(s$V)s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$V,Avatar);else{var s$Q=s$n.avatar;s$Q&&s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$Q.path,Avatar)}var s$g=s$n.clipPaths;for(s$u=0,s$x=s$g.length;s$u<s$x;s$u++)s$E._addHierarchyInnerUrls(s$Z,s$h,s$_,s$N,s$g[s$u],AnimationClip)}}var s$F=s$d.child;for(s$u=0,s$x=s$F.length;s$u<s$x;s$u++)s$E._getSprite3DHierarchyInnerUrls(s$F[s$u],s$L,s$l,s$Z,s$h,s$_,s$N)},s$E._loadHierarchy=function(s$d){s$d.on("loaded",null,s$E._onHierarchylhLoaded,[s$d,s$d._class._getGroup()]),s$d.load(s$d.url,"json",!1,null,!0)},s$E._onHierarchylhLoaded=function(s$d,s$L,s$l){if(s$d._class.destroyed)s$d.endLoad();else{var s$Z=s$d.url,s$h=s$aL.getURLVerion(s$Z),s$_=s$g.getPath(s$Z),s$N=[],s$m=[],s$u=[],s$x={};s$E._getSprite3DHierarchyInnerUrls(s$l,s$N,s$m,s$u,s$x,s$h,s$_);var s$t=s$N.length+s$m.length+s$u.length,s$b=s$t+1,s$q=1/s$b;if(s$E._onProcessChange(s$d,0,s$q,1),0<s$u.length){var s$Y=s$t/s$b,s$c=s$Q.create(null,s$E._onProcessChange,[s$d,s$q,s$Y],!1);s$E._innerFourthLevelLoaderManager.create(s$u,s$Q.create(null,s$E._onHierarchyInnerForthLevResouLoaded,[s$d,s$L,s$c,s$l,s$x,s$N,s$m,s$q+s$Y*s$u.length,s$Y]),s$c,null,null,1,!0,s$L)}else s$E._onHierarchyInnerForthLevResouLoaded(s$d,s$L,null,s$l,s$x,s$N,s$m,s$q,s$Y)}},s$E._onHierarchyInnerForthLevResouLoaded=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){if(s$d._class.destroyed)s$d.endLoad();else if(s$l&&s$l.recover(),0<s$N.length){var s$x=s$Q.create(null,s$E._onProcessChange,[s$d,s$m,s$u],!1);s$E._innerSecondLevelLoaderManager.create(s$N,s$Q.create(null,s$E._onHierarchyInnerSecondLevResouLoaded,[s$d,s$L,s$x,s$Z,s$h,s$_,s$m+s$u*s$N.length,s$u]),s$l,null,null,1,!0,s$L)}else s$E._onHierarchyInnerSecondLevResouLoaded(s$d,s$L,null,s$Z,s$h,s$_,s$m,s$u)},s$E._onHierarchyInnerSecondLevResouLoaded=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m){if(s$d._class.destroyed)s$d.endLoad();else if(s$l&&s$l.recover(),0<s$_.length){var s$u=s$Q.create(null,s$E._onProcessChange,[s$d,s$N,s$m],!1);s$E._innerFirstLevelLoaderManager.create(s$_,s$Q.create(null,s$E._onHierarchyInnerFirstLevResouLoaded,[s$d,s$u,s$Z,s$h]),s$l,null,null,1,!0,s$L)}else s$E._onHierarchyInnerFirstLevResouLoaded(s$d,null,s$Z,s$h)},s$E._onHierarchyInnerFirstLevResouLoaded=function(s$d,s$L,s$l,s$Z){s$L&&s$L.recover(),s$d.endLoad([s$l,s$Z])},s$E._loadTerrain=function(s$d){s$d.on("loaded",null,s$E._onTerrainLtLoaded,[s$d,s$d._class._getGroup()]),s$d.load(s$d.url,"json",!1,null,!0)},s$E._onTerrainLtLoaded=function(s$d,s$L,s$l){if(s$d._class.destroyed)s$d.endLoad();else{var s$Z,s$h,s$_=s$d.url,s$N=s$aL.getURLVerion(s$_),s$m=s$g.getPath(s$_),s$u=[],s$x={},s$t=0,s$b=0,s$q=s$l.heightData;s$Z=s$q.url,s$h=s$E.formatRelativePath(s$m,s$Z),s$N&&(s$h+=s$N),s$Z=s$x[s$Z]=s$h;var s$Y=s$l.detailTexture;for(s$t=0,s$b=s$Y.length;s$t<s$b;s$t++)s$u.push({url:s$Y[s$t].diffuse});var s$c=s$l.normalMap;for(s$t=0,s$b=s$c.length;s$t<s$b;s$t++)s$u.push({url:s$c[s$t]});var s$r=s$l.alphaMap;for(s$t=0,s$b=s$r.length;s$t<s$b;s$t++)s$u.push({url:s$r[s$t],params:[!1,!1,6408,!0]});for(s$t=0,s$b=s$u.length;s$t<s$b;s$t++){var s$a=s$u[s$t].url;s$h=s$E.formatRelativePath(s$m,s$a),s$N&&(s$h+=s$N),s$u[s$t].url=s$h,s$x[s$a]=s$h}var s$k=s$u.length,s$e=s$k+2,s$w=1/s$e;s$E._onProcessChange(s$d,0,s$w,1);var s$s={heightMapLoaded:!1,texturesLoaded:!1},s$A=s$Q.create(null,s$E._onProcessChange,[s$d,s$w,s$w],!1);s$E._innerFourthLevelLoaderManager.create(s$Z,s$Q.create(null,s$E._onTerrainHeightMapLoaded,[s$d,s$A,s$l,s$x,s$s]),s$A,null,[s$q.numX,s$q.numZ,s$q.bitType,s$q.value],1,!0,s$L);var s$y=s$Q.create(null,s$E._onProcessChange,[s$d,2*s$w,s$k/s$e],!1);s$E._innerFourthLevelLoaderManager.create(s$u,s$Q.create(null,s$E._onTerrainTexturesLoaded,[s$d,s$y,s$l,s$x,s$s]),s$y,null,null,1,!0,s$L)}},s$E._onTerrainHeightMapLoaded=function(s$d,s$L,s$l,s$Z,s$h){s$h.heightMapLoaded=!0,s$h.texturesLoaded&&(s$d.endLoad([s$l,s$Z]),s$L.recover())},s$E._onTerrainTexturesLoaded=function(s$d,s$L,s$l,s$Z,s$h){s$h.texturesLoaded=!0,s$h.heightMapLoaded&&(s$d.endLoad([s$l,s$Z]),s$L.recover())},s$E._loadMesh=function(s$d){s$d.on("loaded",null,s$E._onMeshLmLoaded,[s$d,s$d._class._getGroup()]),s$d.load(s$d.url,"arraybuffer",!1,null,!0)},s$E._onMeshLmLoaded=function(s$d,s$L,s$l){if(s$d._class.destroyed)s$d.endLoad();else{var s$Z,s$h,s$_,s$N=s$d.url,s$m=s$aL.getURLVerion(s$N),s$u=s$g.getPath(s$N),s$x={},s$t=0,s$b=0;switch((s$E._readData=new s$y(s$l)).pos=0,s$E._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var s$q=s$E._readData.getUint32();s$E._readData.pos=s$E._readData.pos+4,s$b=s$E._readData.getUint16(),s$E._readData.pos=s$E._readData.pos+8*s$b;var s$Y=s$E._readData.getUint32();for(s$b=s$E._readData.getUint16(),s$E._readData.pos=s$q+s$Y,s$Z=[],s$t=0;s$t<s$b;s$t++){var s$c=s$E._readData.readUTFString();-1!==s$c.lastIndexOf(".lmat")&&s$Z.push(s$c)}break;default:for(s$E.READ_BLOCK(),s$t=0;s$t<2;s$t++){var s$r=s$E._readData.getUint16(),s$a=s$E._strings[s$r],s$k=s$E["READ_"+s$a];if(null==s$k)throw new Error("model file err,no this function:"+s$r+" "+s$a);1===s$t?s$Z=s$k.call():s$k.call()}}for(s$t=0,s$_=s$Z.length;s$t<s$_;s$t++){var s$e=s$Z[s$t];s$h=s$E.formatRelativePath(s$u,s$e),s$m&&(s$h+=s$m),s$Z[s$t]=s$h,s$x[s$e]=s$h}if(0<s$Z.length){s$E._onProcessChange(s$d,0,.5,1);var s$w=s$Q.create(null,s$E._onProcessChange,[s$d,.5,.5],!1);s$E._innerSecondLevelLoaderManager.create(s$Z,s$Q.create(null,s$E._onMeshMateialLoaded,[s$d,s$w,s$l,s$x]),s$w,null,null,1,!0,s$L)}else s$d.endLoad([s$l,s$x])}},s$E._onMeshMateialLoaded=function(s$d,s$L,s$l,s$Z){s$d.endLoad([s$l,s$Z]),s$L.recover()},s$E._getMaterialTexturePath=function(s$d,s$L,s$l){var s$Z=s$d.length-4;return s$d.indexOf(".dds")!=s$Z&&s$d.indexOf(".tga")!=s$Z&&s$d.indexOf(".exr")!=s$Z&&s$d.indexOf(".DDS")!=s$Z&&s$d.indexOf(".TGA")!=s$Z&&s$d.indexOf(".EXR")!=s$Z||(s$d=s$d.substr(0,s$Z)+".png"),s$d=s$E.formatRelativePath(s$l,s$d),s$L&&(s$d+=s$L),s$d},s$E._loadMaterial=function(s$d){s$d.on("loaded",null,s$E._onMaterilLmatLoaded,[s$d,s$d._class._getGroup()]),s$d.load(s$d.url,"json",!1,null,!0)},s$E._onMaterilLmatLoaded=function(s$d,s$L,s$l){if(s$d._class.destroyed)s$d.endLoad();else{var s$Z,s$h=s$d.url,s$_=s$aL.getURLVerion(s$h),s$N=s$g.getPath(s$h),s$m=[],s$u={},s$x=s$l.customProps,s$t=s$l.version;if(s$t)switch(s$t){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var s$b=s$l.props.textures,s$q=0,s$Y=s$b.length;s$q<s$Y;s$q++){var s$c=s$b[s$q],s$r=s$c.path;if(s$r){var s$a=s$r.length-4;s$r.indexOf(".exr")!=s$a&&s$r.indexOf(".EXR")!=s$a||(s$r=s$r.substr(0,s$a)+".png"),s$Z=s$E.formatRelativePath(s$N,s$r),s$_&&(s$Z+=s$_),s$m.push({url:s$Z,params:s$c.params}),s$u[s$r]=s$Z}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var s$k=s$x.diffuseTexture.texture2D;if(s$k&&(s$Z=s$E._getMaterialTexturePath(s$k,s$_,s$N),s$m.push(s$Z),s$u[s$k]=s$Z),s$x.normalTexture){var s$e=s$x.normalTexture.texture2D;s$e&&(s$Z=s$E._getMaterialTexturePath(s$e,s$_,s$N),s$m.push(s$Z),s$u[s$e]=s$Z)}if(s$x.specularTexture){var s$w=s$x.specularTexture.texture2D;s$w&&(s$Z=s$E._getMaterialTexturePath(s$w,s$_,s$N),s$m.push(s$Z),s$u[s$w]=s$Z)}if(s$x.emissiveTexture){var s$s=s$x.emissiveTexture.texture2D;s$s&&(s$Z=s$E._getMaterialTexturePath(s$s,s$_,s$N),s$m.push(s$Z),s$u[s$s]=s$Z)}if(s$x.ambientTexture){var s$A=s$x.ambientTexture.texture2D;s$A&&(s$Z=s$E._getMaterialTexturePath(s$A,s$_,s$N),s$m.push(s$Z),s$u[s$A]=s$Z)}if(s$x.reflectTexture){var s$y=s$x.reflectTexture.texture2D;s$y&&(s$Z=s$E._getMaterialTexturePath(s$y,s$_,s$N),s$m.push(s$Z),s$u[s$y]=s$Z)}}var s$$=s$m.length,s$O=s$$+1,s$n=1/s$O;if(s$E._onProcessChange(s$d,0,s$n,1),0<s$$){var s$V=s$Q.create(null,s$E._onProcessChange,[s$d,s$n,s$$/s$O],!1);s$E._innerFourthLevelLoaderManager.create(s$m,s$Q.create(null,s$E._onMateialTexturesLoaded,[s$d,s$V,s$l,s$u]),s$V,s$TL,null,1,!0,s$L)}else s$E._onMateialTexturesLoaded(s$d,null,s$l,null)}},s$E._onMateialTexturesLoaded=function(s$d,s$L,s$l,s$Z){s$d.endLoad([s$l,s$Z]),s$L&&s$L.recover()},s$E._loadTextureCube=function(s$d){s$d.on("loaded",null,s$E._onTextureCubeLtcLoaded,[s$d]),s$d.load(s$d.url,"json",!1,null,!0)},s$E._onTextureCubeLtcLoaded=function(s$d,s$L){if(s$d._class.destroyed)s$d.endLoad();else{var s$l=s$g.getPath(s$d.url),s$Z=[s$E.formatRelativePath(s$l,s$L.px),s$E.formatRelativePath(s$l,s$L.nx),s$E.formatRelativePath(s$l,s$L.py),s$E.formatRelativePath(s$l,s$L.ny),s$E.formatRelativePath(s$l,s$L.pz),s$E.formatRelativePath(s$l,s$L.nz)];s$E._onProcessChange(s$d,0,1/7,1);var s$h=s$Q.create(null,s$E._onProcessChange,[s$d,1/7,6/7],!1);s$E._innerFourthLevelLoaderManager.load(s$Z,s$Q.create(null,s$E._onTextureCubeImagesLoaded,[s$d,s$Z,s$h]),s$h,"nativeimage")}},s$E._onTextureCubeImagesLoaded=function(s$d,s$L,s$l){var s$Z=[];s$Z.length=6;for(var s$h=0;s$h<6;s$h++){var s$_=s$L[s$h];s$Z[s$h]=s$k.getRes(s$_),s$k.clearRes(s$_)}s$d.endLoad(s$Z),s$l.recover()},s$E._onProcessChange=function(s$d,s$L,s$l,s$Z){(s$Z=s$L+s$Z*s$l)<1&&s$d.event("progress",s$Z)},s$E.init=function(s$d,s$L,s$l,s$Z,s$h,s$_){if(void 0===s$l&&(s$l=!1),void 0===s$Z&&(s$Z=!1),void 0===s$h&&(s$h=!0),void 0===s$_&&(s$_=!0),s$e.update3DLoop=function(){},s$e.cancelLoadByUrl=function(s$d){s$E._cancelLoadByUrl(s$d)},s$u.isAntialias=s$l,s$u.isAlpha=s$Z,s$u.premultipliedAlpha=s$h,s$u.isStencil=s$_,!s$F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");s$e.changeWebGLSize=s$E._changeWebGLSize,s$r.is3DMode=!0,s$A.init(s$d,s$L),s$p.__init__(),s$bL.__init__(),s$KL.__init__(),s$B.__init__(),s$E.__init__(),s$N.maxTextureCount=2,(s$E.debugMode||s$J.debugMode)&&(s$E._debugPhasorSprite=new s$D)},s$E.HIERARCHY="SPRITE3DHIERARCHY",s$E.MESH="MESH",s$E.MATERIAL="MATERIAL",s$E.PBRMATERIAL="PBRMTL",s$E.TEXTURECUBE="TEXTURECUBE",s$E.TERRAIN="TERRAIN",s$E._readData=null,s$E._debugPhasorSprite=null,s$E.debugMode=!1,s$b(s$E,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new s$L},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new s$L},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new s$L},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new s$L}]),s$E}(),s$eL=function(s$d){function s$h(s$d){s$h.__super.call(this),this._owner=s$d,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}s$Y(s$h,"laya.d3.animation.AnimationTransform3D",s$_);var s$L=s$h.prototype;return s$L._getlocalMatrix=function(){return this._localUpdate&&(s$aL._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},s$L._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldTransform()}},s$L._setWorldMatrixAndUpdate=function(s$d){if(this._worldMatrix=s$d,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var s$L=this._getlocalMatrix(),s$l=0;s$l<16;++s$l)this._worldMatrix[s$l]=s$L[s$l];else s$aL.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},s$L._setWorldMatrixNoUpdate=function(s$d){this._worldMatrix=s$d},s$L._setWorldMatrixIgnoreUpdate=function(s$d){this._worldMatrix=s$d,this._worldUpdate=!1},s$L.getLocalPosition=function(){return this._localPosition},s$L.setLocalPosition=function(s$d){if(this._parent)this._localPosition=s$d,this._localUpdate=!0,this._onWorldTransform();else{var s$L=this._entity.owner._transform,s$l=this._entity.localPosition,s$Z=s$l.elements;s$Z[0]=s$d[0],s$Z[1]=s$d[1],s$Z[2]=s$d[2],s$L.localPosition=s$l}},s$L.getLocalRotation=function(){if(this._localQuaternionUpdate){var s$d=this._localRotationEuler;s$aL._quaternionCreateFromYawPitchRollArray(s$d[1]/s$h._angleToRandin,s$d[0]/s$h._angleToRandin,s$d[2]/s$h._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},s$L.setLocalRotation=function(s$d){if(this._parent)this._localRotation=s$d,s$aL.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var s$L=this._entity.owner._transform,s$l=this._entity.localRotation,s$Z=s$l.elements;s$Z[0]=s$d[0],s$Z[1]=s$d[1],s$Z[2]=s$d[2],s$Z[3]=s$d[3],s$L.localRotation=s$l}},s$L.getLocalScale=function(){return this._localScale},s$L.setLocalScale=function(s$d){if(this._parent)this._localScale=s$d,this._localUpdate=!0,this._onWorldTransform();else{var s$L=this._entity.owner._transform,s$l=this._entity.localScale,s$Z=s$l.elements;s$Z[0]=s$d[0],s$Z[1]=s$d[1],s$Z[2]=s$d[2],s$L.localScale=s$l}},s$L.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){s$aL.getYawPitchRoll(this._localRotation,s$h._tempVector3);var s$d=s$h._tempVector3,s$L=this._localRotationEuler;s$L[0]=s$d[1]*s$h._angleToRandin,s$L[1]=s$d[0]*s$h._angleToRandin,s$L[2]=s$d[2]*s$h._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},s$L.setLocalRotationEuler=function(s$d){if(this._parent)s$aL._quaternionCreateFromYawPitchRollArray(s$d[1]/s$h._angleToRandin,s$d[0]/s$h._angleToRandin,s$d[2]/s$h._angleToRandin,this._localRotation),this._localRotationEuler=s$d,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var s$L=this._entity.owner._transform,s$l=this._entity.localRotationEuler,s$Z=s$l.elements;s$Z[0]=s$d[0],s$Z[1]=s$d[1],s$Z[2]=s$d[2],s$L.localRotationEuler=s$l}},s$L.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)s$aL.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var s$d=this._getlocalMatrix(),s$L=0;s$L<16;++s$L)this._worldMatrix[s$L]=s$d[s$L];this._worldUpdate=!1}return this._worldMatrix},s$L.setParent=function(s$d){if(this._parent!==s$d){if(this._parent){var s$L=this._parent._childs,s$l=s$L.indexOf(this);s$L.splice(s$l,1)}s$d&&(s$d._childs.push(this),s$d&&this._onWorldTransform()),this._parent=s$d}},s$b(s$h,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),s$h}(),s$wL=function(s$d){function s$L(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,s$L.__super.call(this),this._destroyed=!1,this._id=s$L._uniqueIDCounter,s$L._uniqueIDCounter++}s$Y(s$L,"laya.d3.component.Component3D",s$_);var s$l=s$L.prototype;return s$A.imps(s$l,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),s$l._initialize=function(s$d){this._owner=s$d,this._enable=!0,this.started=!1,this._load(s$d)},s$l._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},s$l._load=function(s$d){},s$l._start=function(s$d){},s$l._update=function(s$d){},s$l._lateUpdate=function(s$d){},s$l._preRenderUpdate=function(s$d){},s$l._postRenderUpdate=function(s$d){},s$l._unload=function(s$d){this.offAll()},s$l._cloneTo=function(s$d){},s$c(0,s$l,"id",function(){return this._id}),s$c(0,s$l,"destroyed",function(){return this._destroyed}),s$c(0,s$l,"owner",function(){return this._owner}),s$c(0,s$l,"enable",function(){return this._enable},function(s$d){this._enable!==s$d&&(this._enable=s$d,this.event("enablechanged",this._enable))}),s$c(0,s$l,"isSingleton",function(){return s$L._isSingleton}),s$L._isSingleton=!0,s$L._uniqueIDCounter=1,s$L}(),s$sL=function(s$d){function s$L(){this._destroyed=!1,s$L.__super.call(this),this._destroyed=!1}s$Y(s$L,"laya.d3.core.GeometryFilter",s$_);var s$l=s$L.prototype;return s$A.imps(s$l,{"laya.resource.IDestroy":!0}),s$l._destroy=function(){this.offAll(),this._destroyed=!0},s$c(0,s$l,"_isAsyncLoaded",function(){return!0}),s$c(0,s$l,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),s$c(0,s$l,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),s$c(0,s$l,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),s$c(0,s$l,"destroyed",function(){return this._destroyed}),s$L}(),s$AL=function(s$d){function s$Z(s$d){s$Z.__super.call(this),this._id=++s$Z._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new s$Jd(new s$NL,new s$NL),this._boundingBoxCenter=new s$NL,this._boundingSphere=new s$Ud(new s$NL,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=s$d,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}s$Y(s$Z,"laya.d3.core.render.BaseRender",s$_);var s$L=s$Z.prototype;return s$A.imps(s$L,{"laya.resource.IDestroy":!0}),s$L._changeMaterialReference=function(s$d,s$L){s$d&&s$d._removeReference(),s$L._addReference()},s$L._getInstanceMaterial=function(s$d,s$L){var s$l=new s$d.constructor;return s$d.cloneTo(s$l),s$l.name=s$l.name+"(Instance)",this._materialsInstance[s$L]=!0,this._changeMaterialReference(this._materials[s$L],s$l),this._materials[s$L]=s$l},s$L._setShaderValuelightMap=function(s$d){this._setShaderValueTexture(3,s$d)},s$L._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},s$L._renderRenderableBoundBox=function(){var s$d=s$kL._debugPhasorSprite,s$L=this.boundingBox,s$l=s$Z._tempBoundBoxCorners;s$L.getCorners(s$l),s$d.line(s$l[0],s$Z._greenColor,s$l[1],s$Z._greenColor),s$d.line(s$l[2],s$Z._greenColor,s$l[3],s$Z._greenColor),s$d.line(s$l[4],s$Z._greenColor,s$l[5],s$Z._greenColor),s$d.line(s$l[6],s$Z._greenColor,s$l[7],s$Z._greenColor),s$d.line(s$l[0],s$Z._greenColor,s$l[3],s$Z._greenColor),s$d.line(s$l[1],s$Z._greenColor,s$l[2],s$Z._greenColor),s$d.line(s$l[2],s$Z._greenColor,s$l[6],s$Z._greenColor),s$d.line(s$l[3],s$Z._greenColor,s$l[7],s$Z._greenColor),s$d.line(s$l[0],s$Z._greenColor,s$l[4],s$Z._greenColor),s$d.line(s$l[1],s$Z._greenColor,s$l[5],s$Z._greenColor),s$d.line(s$l[4],s$Z._greenColor,s$l[7],s$Z._greenColor),s$d.line(s$l[5],s$Z._greenColor,s$l[6],s$Z._greenColor)},s$L._calculateBoundingSphere=function(){throw"BaseRender: must override it."},s$L._calculateBoundingBox=function(){throw"BaseRender: must override it."},s$L._setShaderValueTexture=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L)},s$L._setShaderValueMatrix4x4=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L?s$L.elements:null)},s$L._setShaderValueColor=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L?s$L.elements:null)},s$L._setShaderValueBuffer=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L)},s$L._setShaderValueInt=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L)},s$L._setShaderValueBool=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L)},s$L._setShaderValueNumber=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L)},s$L._setShaderValueVector2=function(s$d,s$L){this._owner._shaderValues.setValue(s$d,s$L?s$L.elements:null)},s$L._addShaderDefine=function(s$d){this._owner._shaderDefineValue|=s$d},s$L._removeShaderDefine=function(s$d){this._owner._shaderDefineValue&=~s$d},s$L._renderUpdate=function(s$d){return!0},s$L._applyLightMapParams=function(){if(0<=this._lightmapIndex){var s$d=this._owner.scene;if(s$d){var s$L=s$d.getlightmaps()[this._lightmapIndex];s$L?(this._addShaderDefine(s$DL.SAHDERDEFINE_LIGHTMAP),s$L.loaded?this._setShaderValuelightMap(s$L):s$L.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(s$DL.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(s$DL.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(s$DL.SAHDERDEFINE_LIGHTMAP)},s$L._updateOctreeNode=function(){var s$d=this._treeNode;s$d&&this._octreeNodeNeedChange&&(s$d.updateObject(this),this._octreeNodeNeedChange=!1)},s$L._destroy=function(){this.offAll();var s$d=0,s$L=0;for(s$d=0,s$L=this._renderElements.length;s$d<s$L;s$d++)this._renderElements[s$d]._destroy();for(s$d=0,s$L=this._materials.length;s$d<s$L;s$d++)this._materials[s$d]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},s$c(0,s$L,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),s$c(0,s$L,"id",function(){return this._id}),s$c(0,s$L,"material",function(){var s$d=this._materials[0];if(s$d&&!this._materialsInstance[0]){var s$L=this._getInstanceMaterial(s$d,0);this.event("materialchanged",[this,0,s$L])}return this._materials[0]},function(s$d){this.sharedMaterial=s$d}),s$c(0,s$L,"sharedMaterial",function(){return this._materials[0]},function(s$d){var s$L=this._materials[0];s$L!==s$d&&(this._materials[0]=s$d,this._materialsInstance[0]=!1,this._changeMaterialReference(s$L,s$d),this.event("materialchanged",[this,0,s$d]))}),s$c(0,s$L,"lightmapIndex",function(){return this._lightmapIndex},function(s$d){this._lightmapIndex=s$d,this._applyLightMapParams()}),s$c(0,s$L,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(s$d){this._lightmapScaleOffset=s$d,this._setShaderValueColor(2,s$d),this._addShaderDefine(s$DL.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),s$c(0,s$L,"enable",function(){return this._enable},function(s$d){this._enable=s$d,this.event("enablechanged",[this,s$d])}),s$c(0,s$L,"materials",function(){for(var s$d=0,s$L=this._materials.length;s$d<s$L;s$d++)if(!this._materialsInstance[s$d]){var s$l=this._getInstanceMaterial(this._materials[s$d],s$d);this.event("materialchanged",[this,s$d,s$l])}return this._materials.slice()},function(s$d){this.sharedMaterials=s$d}),s$c(0,s$L,"sharedMaterials",function(){return this._materials.slice()},function(s$d){if(!s$d)throw new Error("MeshRender: shadredMaterials value can't be null.");var s$L=s$d.length;this._materialsInstance.length=s$L;for(var s$l=0;s$l<s$L;s$l++){var s$Z=this._materials[s$l];s$Z!==s$d[s$l]&&(this._materialsInstance[s$l]=!1,this._changeMaterialReference(s$Z,s$d[s$l]),this.event("materialchanged",[this,s$l,s$d[s$l]]))}this._materials=s$d}),s$c(0,s$L,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),s$c(0,s$L,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var s$d=this.boundingBox;s$NL.add(s$d.min,s$d.max,this._boundingBoxCenter),s$NL.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),s$c(0,s$L,"receiveShadow",function(){return this._receiveShadow},function(s$d){this._receiveShadow!==s$d&&((this._receiveShadow=s$d)?this._addShaderDefine(s$YL.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(s$YL.SHADERDEFINE_RECEIVE_SHADOW))}),s$c(0,s$L,"destroyed",function(){return this._destroyed}),s$Z._uniqueIDCounter=0,s$b(s$Z,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL,new s$NL]},"_greenColor",function(){return this._greenColor=new s$mL(0,1,0,1)}]),s$Z}(),s$yL=function(s$d){function s$m(s$d){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,s$m.__super.call(this),this._localPosition=new s$NL,this._localRotation=new s$lL(0,0,0,1),this._localScale=new s$NL(1,1,1),this._localRotationEuler=new s$NL,this._localMatrix=new s$dL,this._position=new s$NL,this._rotation=new s$lL(0,0,0,1),this._scale=new s$NL(1,1,1),this._worldMatrix=new s$dL,this._forward=new s$NL,this._up=new s$NL,this._right=new s$NL,this._owner=s$d,this._childs=[]}s$Y(s$m,"laya.d3.core.Transform3D",s$_);var s$L=s$m.prototype;return s$L._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)s$dL.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var s$d=s$m._tempVector30;s$NL.multiply(this.pivot,this._localScale,s$d);var s$L=s$m._tempVector31;s$NL.subtract(s$d,this.pivot,s$L);var s$l=s$m._tempVector32,s$Z=this.localRotation;s$NL.transformQuat(s$d,s$Z,s$l),s$NL.subtract(s$l,s$d,s$l);var s$h=s$m._tempVector33;s$NL.subtract(this._localPosition,s$L,s$h),s$NL.subtract(s$h,s$l,s$h),s$dL.createAffineTransformation(s$h,s$Z,this._localScale,this._localMatrix)}},s$L._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldPositionRotationTransform()}},s$L._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldPositionScaleTransform()}},s$L._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldPositionTransform()}},s$L._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldPositionRotationTransform()}},s$L._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldPositionScaleTransform()}},s$L._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._onWorldTransform()}},s$L.translate=function(s$d,s$L){void 0===s$L&&(s$L=!0),s$L?(s$dL.createFromQuaternion(this.localRotation,s$m._tempMatrix0),s$NL.transformCoordinate(s$d,s$m._tempMatrix0,s$m._tempVector30),s$NL.add(this.localPosition,s$m._tempVector30,this._localPosition),this.localPosition=this._localPosition):(s$NL.add(this.position,s$d,this._position),this.position=this._position)},s$L.rotate=function(s$d,s$L,s$l){var s$Z;void 0===s$L&&(s$L=!0),void 0===s$l&&(s$l=!0),s$Z=s$l?s$d:(s$NL.scale(s$d,Math.PI/180,s$m._tempVector30),s$m._tempVector30),s$lL.createFromYawPitchRoll(s$Z.y,s$Z.x,s$Z.z,s$m._tempQuaternion0),s$L?(s$lL.multiply(this._localRotation,s$m._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(s$lL.multiply(s$m._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},s$L.lookAt=function(s$d,s$L,s$l){void 0===s$l&&(s$l=!1);var s$Z,s$h=s$d.elements;if(s$l){if(s$Z=this._localPosition.elements,Math.abs(s$Z[0]-s$h[0])<s$Wd.zeroTolerance&&Math.abs(s$Z[1]-s$h[1])<s$Wd.zeroTolerance&&Math.abs(s$Z[2]-s$h[2])<s$Wd.zeroTolerance)return;s$lL.lookAt(this._localPosition,s$d,s$L,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var s$_=this.position;if(s$Z=s$_.elements,Math.abs(s$Z[0]-s$h[0])<s$Wd.zeroTolerance&&Math.abs(s$Z[1]-s$h[1])<s$Wd.zeroTolerance&&Math.abs(s$Z[2]-s$h[2])<s$Wd.zeroTolerance)return;s$lL.lookAt(s$_,s$d,s$L,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},s$c(0,s$L,"_isFrontFaceInvert",function(){var s$d=this.scale,s$L=s$d.x<0;return s$d.y<0&&(s$L=!s$L),s$d.z<0&&(s$L=!s$L),s$L}),s$c(0,s$L,"owner",function(){return this._owner}),s$c(0,s$L,"localRotation",function(){if(this._localQuaternionUpdate){var s$d=this._localRotationEuler.elements;s$lL.createFromYawPitchRoll(s$d[1]/s$m._angleToRandin,s$d[0]/s$m._angleToRandin,s$d[2]/s$m._angleToRandin,this._localRotation)}return this._localRotation},function(s$d){this._localRotation=s$d,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),s$c(0,s$L,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?s$dL.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(s$d){null===this._parent?s$d.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),s$dL.multiply(this._localMatrix,s$d,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=s$d,this._worldUpdate=!1}),s$c(0,s$L,"worldNeedUpdate",function(){return this._worldUpdate}),s$c(0,s$L,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(s$d){this._localMatrix=s$d,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),s$c(0,s$L,"dummy",function(){return this._dummy},function(s$d){this._dummy!==s$d&&(this._dummy&&(this._dummy._entity=null),s$d&&(s$d._entity=this),this._dummy=s$d)}),s$c(0,s$L,"localPosition",function(){return this._localPosition},function(s$d){this._localPosition=s$d,this._localUpdate=!0,this._onWorldPositionTransform()}),s$c(0,s$L,"position",function(){if(this._positionUpdate){if(null!=this._parent){var s$d=this._parent.position;s$NL.multiply(this._localPosition,this._parent.scale,s$m._tempVector30),s$NL.transformQuat(s$m._tempVector30,this._parent.rotation,s$m._tempVector30),s$NL.add(s$d,s$m._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(s$d){if(null!=this._parent){s$NL.subtract(s$d,this._parent.position,this._localPosition);var s$L=this._parent.scale.elements,s$l=s$L[0],s$Z=s$L[1],s$h=s$L[2];if(1!==s$l||1!==s$Z||1!==s$h){var s$_=s$m._tempVector30,s$N=s$_.elements;s$N[0]=1/s$l,s$N[1]=1/s$Z,s$N[2]=1/s$h,s$NL.multiply(this._localPosition,s$_,this._localPosition)}this._parent.rotation.invert(s$m._tempQuaternion0),s$NL.transformQuat(this._localPosition,s$m._tempQuaternion0,this._localPosition)}else s$d.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=s$d,this._positionUpdate=!1}),s$c(0,s$L,"localScale",function(){return this._localScale},function(s$d){this._localScale=s$d,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),s$c(0,s$L,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(s$m._tempVector30);var s$d=s$m._tempVector30.elements,s$L=this._localRotationEuler.elements;s$L[0]=s$d[1]*s$m._angleToRandin,s$L[1]=s$d[0]*s$m._angleToRandin,s$L[2]=s$d[2]*s$m._angleToRandin}return this._localRotationEuler},function(s$d){this._localRotationEuler=s$d,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),s$c(0,s$L,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?s$lL.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(s$d){null!=this._parent?(this._parent.rotation.invert(s$m._tempQuaternion0),s$lL.multiply(s$d,s$m._tempQuaternion0,this._localRotation)):s$d.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=s$d,this._rotationUpdate=!1}),s$c(0,s$L,"scale",function(){return this._scaleUpdate&&(null!==this._parent?s$NL.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(s$d){if(null!==this._parent){var s$L=this._parent.scale.elements,s$l=s$m._tempVector30.elements;s$l[0]=1/s$L[0],s$l[1]=1/s$L[1],s$l[2]=1/s$L[2],s$NL.multiply(s$d,s$m._tempVector30,this._localScale)}else s$d.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=s$d,this._scaleUpdate=!1}),s$c(0,s$L,"rotationEuler",null,function(s$d){s$lL.createFromYawPitchRoll(s$d.y,s$d.x,s$d.z,this._rotation),this.rotation=this._rotation}),s$c(0,s$L,"forward",function(){var s$d=this.worldMatrix.elements;return this._forward.elements[0]=-s$d[8],this._forward.elements[1]=-s$d[9],this._forward.elements[2]=-s$d[10],this._forward}),s$c(0,s$L,"up",function(){var s$d=this.worldMatrix.elements;return this._up.elements[0]=s$d[4],this._up.elements[1]=s$d[5],this._up.elements[2]=s$d[6],this._up}),s$c(0,s$L,"right",function(){var s$d=this.worldMatrix.elements;return this._right.elements[0]=s$d[0],this._right.elements[1]=s$d[1],this._right.elements[2]=s$d[2],this._right}),s$c(0,s$L,"parent",function(){return this._parent},function(s$d){if(this._parent!==s$d){if(this._parent){var s$L=this._parent._childs,s$l=s$L.indexOf(this);s$L.splice(s$l,1)}s$d&&(s$d._childs.push(this),s$d&&this._onWorldTransform()),this._parent=s$d}}),s$b(s$m,["_tempVector30",function(){return this._tempVector30=new s$NL},"_tempVector31",function(){return this._tempVector31=new s$NL},"_tempVector32",function(){return this._tempVector32=new s$NL},"_tempVector33",function(){return this._tempVector33=new s$NL},"_tempQuaternion0",function(){return this._tempQuaternion0=new s$lL},"_tempMatrix0",function(){return this._tempMatrix0=new s$dL},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),s$m}(),s$$L=(function(s$d){function s$L(){this._rotation=0,this._matNeedUpdte=!1,s$L.__super.call(this),this._matrix=new s$dL,this._offset=new s$_L,this._tiling=new s$_L(1,1)}s$Y(s$L,"laya.d3.core.TransformUV",s$_);var s$l=s$L.prototype;s$A.imps(s$l,{"laya.d3.core.IClone":!0}),s$l._updateMatrix=function(){s$L._tempOffsetV3.elements[0]=this._offset.x,s$L._tempOffsetV3.elements[1]=this._offset.y,s$lL.createFromYawPitchRoll(0,0,this._rotation,s$L._tempRotationQua),s$L._tempTitlingV3.elements[0]=this._tiling.x,s$L._tempTitlingV3.elements[1]=this._tiling.y,s$dL.createAffineTransformation(s$L._tempOffsetV3,s$L._tempRotationQua,s$L._tempTitlingV3,this._matrix)},s$l.cloneTo=function(s$d){s$d._matrix=this._matrix.clone(),s$d._offset=this._offset.clone(),s$d._rotation=this._rotation,s$d._tiling=this._tiling.clone()},s$l.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$l,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),s$c(0,s$l,"tiling",function(){return this._tiling},function(s$d){this._tiling=s$d,this._matNeedUpdte=!0}),s$c(0,s$l,"offset",function(){return this._offset},function(s$d){this._offset=s$d,this._matNeedUpdte=!0}),s$c(0,s$l,"rotation",function(){return this._rotation},function(s$d){this._rotation=s$d,this._matNeedUpdte=!0}),s$b(s$L,["_tempOffsetV3",function(){return this._tempOffsetV3=new s$NL(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new s$lL},"_tempTitlingV3",function(){return this._tempTitlingV3=new s$NL(1,1,1)}])}(),function(s$l){function s$d(){this.x=NaN,this.y=NaN,this.z=NaN,s$d.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}s$Y(s$d,"laya.d3.core.particleShuriKen.module.shape.BoxShape",s$l);var s$L=s$d.prototype;s$L._getShapeBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=.5*-this.x,s$L[1]=.5*-this.y,s$L[2]=.5*-this.z;var s$l=s$d.max.elements;s$l[0]=.5*this.x,s$l[1]=.5*this.y,s$l[2]=.5*this.z},s$L._getSpeedBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=0,s$L[1]=0,s$L[2]=0;var s$l=s$d.max.elements;s$l[0]=0,s$l[1]=1,s$l[2]=0},s$L.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements,s$_=s$L.elements;s$l?(s$l.seed=s$Z[16],s$T._randomPointInsideHalfUnitBox(s$d,s$l),s$Z[16]=s$l.seed):s$T._randomPointInsideHalfUnitBox(s$d),s$h[0]=this.x*s$h[0],s$h[1]=this.y*s$h[1],s$h[2]=this.z*s$h[2],this.randomDirection?s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L):(s$_[0]=0,s$_[1]=0,s$_[2]=1)},s$L.cloneTo=function(s$d){s$l.prototype.cloneTo.call(this,s$d);var s$L=s$d;s$L.x=this.x,s$L.y=this.y,s$L.z=this.z,s$L.randomDirection=this.randomDirection}}(s$i),function(s$l){function s$N(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,s$N.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}s$Y(s$N,"laya.d3.core.particleShuriKen.module.shape.CircleShape",s$l);var s$d=s$N.prototype;s$d._getShapeBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[2]=-this.radius,s$L[1]=0;var s$l=s$d.max.elements;s$l[0]=s$l[2]=this.radius,s$l[1]=0},s$d._getSpeedBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[1]=-1,s$L[2]=0;var s$l=s$d.max.elements;s$l[0]=s$l[1]=1,s$l[2]=0},s$d.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements,s$_=s$N._tempPositionPoint.elements;s$l?(s$l.seed=s$Z[16],this.emitFromEdge?s$T._randomPointUnitArcCircle(this.arc,s$N._tempPositionPoint,s$l):s$T._randomPointInsideUnitArcCircle(this.arc,s$N._tempPositionPoint,s$l),s$Z[16]=s$l.seed):this.emitFromEdge?s$T._randomPointUnitArcCircle(this.arc,s$N._tempPositionPoint):s$T._randomPointInsideUnitArcCircle(this.arc,s$N._tempPositionPoint),s$h[0]=-s$_[0],s$h[1]=s$_[1],s$h[2]=0,s$NL.scale(s$d,this.radius,s$d),this.randomDirection?s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L):s$d.cloneTo(s$L)},s$d.cloneTo=function(s$d){s$l.prototype.cloneTo.call(this,s$d);var s$L=s$d;s$L.radius=this.radius,s$L.arc=this.arc,s$L.emitFromEdge=this.emitFromEdge,s$L.randomDirection=this.randomDirection},s$b(s$N,["_tempPositionPoint",function(){return this._tempPositionPoint=new s$_L}])}(s$i),function(s$l){function s$q(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,s$q.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}s$Y(s$q,"laya.d3.core.particleShuriKen.module.shape.ConeShape",s$l);var s$d=s$q.prototype;s$d._getShapeBoundBox=function(s$d){var s$L=this.radius+this.length*Math.sin(this.angle),s$l=this.length*Math.cos(this.angle),s$Z=s$d.min.elements;s$Z[0]=s$Z[1]=-s$L,s$Z[2]=0;var s$h=s$d.max.elements;s$h[0]=s$h[1]=s$L,s$h[2]=s$l},s$d._getSpeedBoundBox=function(s$d){var s$L=Math.sin(this.angle),s$l=s$d.min.elements;s$l[0]=s$l[1]=-s$L,s$l[2]=0;var s$Z=s$d.max.elements;s$Z[0]=s$l[1]=s$L,s$Z[2]=1},s$d.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){var s$h,s$_=s$d.elements,s$N=s$L.elements,s$m=s$q._tempPositionPoint.elements,s$u=NaN,s$x=NaN,s$t=Math.cos(this.angle),s$b=Math.sin(this.angle);switch(this.emitType){case 0:s$l?(s$l.seed=s$Z[16],s$T._randomPointInsideUnitCircle(s$q._tempPositionPoint,s$l),s$Z[16]=s$l.seed):s$T._randomPointInsideUnitCircle(s$q._tempPositionPoint),s$u=s$m[0],s$x=s$m[1],s$_[0]=s$u*this.radius,s$_[1]=s$x*this.radius,s$_[2]=0,this.randomDirection?(s$l?(s$l.seed=s$Z[17],s$T._randomPointInsideUnitCircle(s$q._tempDirectionPoint,s$l),s$Z[17]=s$l.seed):s$T._randomPointInsideUnitCircle(s$q._tempDirectionPoint),s$h=s$q._tempDirectionPoint.elements,s$N[0]=s$h[0]*s$b,s$N[1]=s$h[1]*s$b):(s$N[0]=s$u*s$b,s$N[1]=s$x*s$b),s$N[2]=s$t;break;case 1:s$l?(s$l.seed=s$Z[16],s$T._randomPointUnitCircle(s$q._tempPositionPoint,s$l),s$Z[16]=s$l.seed):s$T._randomPointUnitCircle(s$q._tempPositionPoint),s$u=s$m[0],s$x=s$m[1],s$_[0]=s$u*this.radius,s$_[1]=s$x*this.radius,s$_[2]=0,this.randomDirection?(s$l?(s$l.seed=s$Z[17],s$T._randomPointInsideUnitCircle(s$q._tempDirectionPoint,s$l),s$Z[17]=s$l.seed):s$T._randomPointInsideUnitCircle(s$q._tempDirectionPoint),s$h=s$q._tempDirectionPoint.elements,s$N[0]=s$h[0]*s$b,s$N[1]=s$h[1]*s$b):(s$N[0]=s$u*s$b,s$N[1]=s$x*s$b),s$N[2]=s$t;break;case 2:s$l?(s$l.seed=s$Z[16],s$T._randomPointInsideUnitCircle(s$q._tempPositionPoint,s$l)):s$T._randomPointInsideUnitCircle(s$q._tempPositionPoint),s$u=s$m[0],s$x=s$m[1],s$_[0]=s$u*this.radius,s$_[1]=s$x*this.radius,s$N[s$_[2]=0]=s$u*s$b,s$N[1]=s$x*s$b,s$N[2]=s$t,s$NL.normalize(s$L,s$L),s$l?(s$NL.scale(s$L,this.length*s$l.getFloat(),s$L),s$Z[16]=s$l.seed):s$NL.scale(s$L,this.length*Math.random(),s$L),s$NL.add(s$d,s$L,s$d),this.randomDirection&&(s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L));break;case 3:s$l?(s$l.seed=s$Z[16],s$T._randomPointUnitCircle(s$q._tempPositionPoint,s$l)):s$T._randomPointUnitCircle(s$q._tempPositionPoint),s$u=s$m[0],s$x=s$m[1],s$_[0]=s$u*this.radius,s$_[1]=s$x*this.radius,s$N[s$_[2]=0]=s$u*s$b,s$N[1]=s$x*s$b,s$N[2]=s$t,s$NL.normalize(s$L,s$L),s$l?(s$NL.scale(s$L,this.length*s$l.getFloat(),s$L),s$Z[16]=s$l.seed):s$NL.scale(s$L,this.length*Math.random(),s$L),s$NL.add(s$d,s$L,s$d),this.randomDirection&&(s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L));break;default:throw new Error("ConeShape:emitType is invalid.")}},s$d.cloneTo=function(s$d){s$l.prototype.cloneTo.call(this,s$d);var s$L=s$d;s$L.angle=this.angle,s$L.radius=this.radius,s$L.length=this.length,s$L.emitType=this.emitType,s$L.randomDirection=this.randomDirection},s$b(s$q,["_tempPositionPoint",function(){return this._tempPositionPoint=new s$_L},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new s$_L}])}(s$i),function(s$l){function s$d(){this.radius=NaN,this.emitFromShell=!1,s$d.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}s$Y(s$d,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",s$l);var s$L=s$d.prototype;s$L._getShapeBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[1]=s$L[2]=-this.radius;var s$l=s$d.max.elements;s$l[0]=s$l[1]=this.radius,s$l[2]=0},s$L._getSpeedBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[1]=-1,s$L[2]=0;var s$l=s$d.max.elements;s$l[0]=s$l[1]=s$l[2]=1},s$L.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){var s$h=s$d.elements;s$l?(s$l.seed=s$Z[16],this.emitFromShell?s$T._randomPointUnitSphere(s$d,s$l):s$T._randomPointInsideUnitSphere(s$d,s$l),s$Z[16]=s$l.seed):this.emitFromShell?s$T._randomPointUnitSphere(s$d):s$T._randomPointInsideUnitSphere(s$d),s$NL.scale(s$d,this.radius,s$d);var s$_=s$h[2];s$_<0&&(s$h[2]=-1*s$_),this.randomDirection?s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L):s$d.cloneTo(s$L)},s$L.cloneTo=function(s$d){s$l.prototype.cloneTo.call(this,s$d);var s$L=s$d;s$L.radius=this.radius,s$L.emitFromShell=this.emitFromShell,s$L.randomDirection=this.randomDirection}}(s$i),function(s$l){function s$d(){this.radius=NaN,this.emitFromShell=!1,s$d.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}s$Y(s$d,"laya.d3.core.particleShuriKen.module.shape.SphereShape",s$l);var s$L=s$d.prototype;s$L._getShapeBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[1]=s$L[2]=-this.radius;var s$l=s$d.max.elements;s$l[0]=s$l[1]=s$l[2]=this.radius},s$L._getSpeedBoundBox=function(s$d){var s$L=s$d.min.elements;s$L[0]=s$L[1]=s$L[2]=-1;var s$l=s$d.max.elements;s$l[0]=s$l[1]=s$l[2]=1},s$L.generatePositionAndDirection=function(s$d,s$L,s$l,s$Z){s$l?(s$l.seed=s$Z[16],this.emitFromShell?s$T._randomPointUnitSphere(s$d,s$l):s$T._randomPointInsideUnitSphere(s$d,s$l),s$Z[16]=s$l.seed):this.emitFromShell?s$T._randomPointUnitSphere(s$d):s$T._randomPointInsideUnitSphere(s$d),s$NL.scale(s$d,this.radius,s$d),this.randomDirection?s$l?(s$l.seed=s$Z[17],s$T._randomPointUnitSphere(s$L,s$l),s$Z[17]=s$l.seed):s$T._randomPointUnitSphere(s$L):s$d.cloneTo(s$L)},s$L.cloneTo=function(s$d){s$l.prototype.cloneTo.call(this,s$d);var s$L=s$d;s$L.radius=this.radius,s$L.emitFromShell=this.emitFromShell,s$L.randomDirection=this.randomDirection}}(s$i),function(s$d){function s$L(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,s$L.__super.call(this)}return s$Y(s$L,"laya.d3.core.render.SubMeshRenderElement",s$G),s$L}()),s$OL=function(s$d){function s$a(s$d,s$L,s$l,s$Z,s$h,s$_){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=s$d,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[s$YL.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[s$DL.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[s$DL.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[s$gL.SHADERDEFINE_ALPHATEST]="ALPHATEST";s$a.__super.call(this,s$d,s$L,s$l,null,{}),this._attributeMap=s$Z;var s$N;for(s$N in s$h){var s$m=s$h[s$N];switch(s$m[1]){case 0:this._renderElementUniformMap[s$N]=s$m[0];break;case 1:this._materialUniformMap[s$N]=s$m[0];break;case 2:this._spriteUniformMap[s$N]=s$m[0];break;case 3:this._cameraUniformMap[s$N]=s$m[0];break;case 4:this._sceneUniformMap[s$N]=s$m[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}s$Y(s$a,"laya.d3.shader.ShaderCompile3D",s$w);var s$L=s$a.prototype;return s$L._definesToNameDic=function(s$d,s$L){for(var s$l={},s$Z=1,s$h=0;s$h<32&&!(s$d<(s$Z=1<<s$h));s$h++)if(s$d&s$Z){var s$_=s$L[s$Z];s$_&&(s$l[s$_]="")}return s$l},s$L.withCompile=function(s$d,s$L,s$l,s$Z){var s$h,s$_,s$N;if(s$_=this.sharders[s$d])if(s$N=s$_[s$L]){if(s$h=s$N[s$l])return s$h}else s$N=s$_[s$L]=[];else s$N=(s$_=this.sharders[s$d]=[])[s$L]=[];var s$m,s$u=this._definesToNameDic(s$d,s$a._globalInt2name),s$x=this._definesToNameDic(s$L,this._spriteInt2name),s$t=this._definesToNameDic(s$l,this._materialInt2name),s$b={},s$q="";if(s$u)for(s$m in s$u)s$q+="#define "+s$m+"\n",s$b[s$m]=!0;if(s$x)for(s$m in s$x)s$q+="#define "+s$m+"\n",s$b[s$m]=!0;if(s$t)for(s$m in s$t)s$q+="#define "+s$m+"\n",s$b[s$m]=!0;var s$Y=s$jL.nameKey.getName(this._name)+" compile ("+s$d+","+s$L+","+s$l+")",s$c=this._VS.toscript(s$b,[]),s$r=this._PS.toscript(s$b,[]);s$I.now();if(s$h=s$jL.create(s$q+s$c.join("\n"),s$q+s$r.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,s$Z,s$Y),s$N[s$l]=s$h,laya.d3.shader.ShaderCompile3D.debugMode)s$I.now();return s$h},s$L.precompileShaderWithShaderDefine=function(s$d,s$L,s$l){this.withCompile(s$d,s$L,s$l,!0)},s$L.addMaterialDefines=function(s$d){var s$L=s$d.defines;for(var s$l in s$L){var s$Z=s$L[s$l],s$h=parseInt(s$l);this._materialInt2name[s$h]=s$Z,this._materialName2Int[s$Z]=s$h}},s$L.addSpriteDefines=function(s$d){var s$L=s$d.defines;for(var s$l in s$L){var s$Z=s$L[s$l],s$h=parseInt(s$l);this._spriteInt2name[s$h]=s$Z,this._spriteName2Int[s$Z]=s$h}},s$L.getMaterialDefineByName=function(s$d){return this._materialName2Int[s$d]},s$L.registerMaterialDefine=function(s$d){var s$L=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[s$L]=s$d,this._materialName2Int[s$d]=s$L},s$L.registerSpriteDefine=function(s$d){var s$L=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[s$L]=s$d,this._spriteName2Int[s$d]=s$L},s$a._globalRegDefine=function(s$d,s$L){s$a._globalInt2name[s$L]=s$d},s$a.add=function(s$d,s$L,s$l,s$Z,s$h){return laya.d3.shader.ShaderCompile3D._preCompileShader[s$d]=new s$a(s$d,s$L,s$l,s$Z,s$h,s$w.includes)},s$a.get=function(s$d){return laya.d3.shader.ShaderCompile3D._preCompileShader[s$jL.nameKey.getID(s$d)]},s$a._preCompileShader={},s$a._globalInt2name=[],s$a.debugMode=!1,s$a.SHADERDEFINE_HIGHPRECISION=1,s$a.SHADERDEFINE_FOG=4,s$a.SHADERDEFINE_DIRECTIONLIGHT=8,s$a.SHADERDEFINE_POINTLIGHT=16,s$a.SHADERDEFINE_SPOTLIGHT=32,s$a.SHADERDEFINE_UV0=64,s$a.SHADERDEFINE_COLOR=128,s$a.SHADERDEFINE_UV1=256,s$a.SAHDERDEFINE_DEPTHFOG=131072,s$a}(),s$nL=function(s$d){function s$c(){s$c.__super.call(this)}s$Y(s$c,"laya.d3.graphics.MeshSprite3DStaticBatchManager",s$Zd);var s$L=s$c.prototype;return s$L._getStaticBatch=function(s$d,s$L,s$l,s$Z){var s$h,s$_;return s$_=s$d?s$d.id.toString()+s$l.id.toString()+s$L.id.toString()+s$Z.toString():s$l.id.toString()+s$L.id.toString()+s$Z.toString(),this._staticBatches[s$_]?s$h=this._staticBatches[s$_]:this._staticBatches[s$_]=s$h=new s$VL(s$_,this,s$d,s$L,s$l),s$h},s$L._initStaticBatchs=function(s$d){var s$L,s$l;this._initBatchRenderElements.sort(s$c._sortPrepareStaticBatch);for(var s$Z,s$h=!1,s$_=0,s$N=0,s$m=this._initBatchRenderElements.length;s$N<s$m;s$N++){var s$u,s$x=this._initBatchRenderElements[s$N],s$t=s$x.renderObj._getVertexBuffer(0);s$x._sprite3D;if(s$l===s$t.vertexDeclaration&&s$L===s$x._material)if(s$h)s$Z._addCombineBatchRenderObjTest(s$x)?(s$u=s$x._staticBatch)!==s$Z&&(s$u&&s$u._deleteCombineBatchRenderObj(s$x),s$Z._addCombineBatchRenderObj(s$x)):(s$h=!1,s$_++);else{var s$b=this._initBatchRenderElements[s$N-1],s$q=s$b.renderObj,s$Y=s$x.renderObj;s$h=!(65535<s$q._getVertexBuffer().vertexCount+s$Y._getVertexBuffer().vertexCount)&&(s$Z=this._getStaticBatch(s$d,s$l,s$L,s$_),(s$u=s$b._staticBatch)!==s$Z&&(s$u&&s$u._deleteCombineBatchRenderObj(s$b),s$Z._addCombineBatchRenderObj(s$b)),(s$u=s$x._staticBatch)!==s$Z&&(s$u&&s$u._deleteCombineBatchRenderObj(s$x),s$Z._addCombineBatchRenderObj(s$x)),!0)}else s$h=!1,s$_=0;s$L=s$x._material,s$l=s$t.vertexDeclaration}},s$c._sortPrepareStaticBatch=function(s$d,s$L){var s$l=s$d._render,s$Z=s$L._render,s$h=s$l.lightmapIndex-s$Z.lightmapIndex;if(0!=s$h)return s$h;var s$_=s$l.receiveShadow-s$Z.receiveShadow;if(0!=s$_)return s$_;var s$N=s$d._mainSortID-s$L._mainSortID;return 0==s$N?s$d.renderObj.triangleCount-s$L.renderObj.triangleCount:s$N},s$c}(),s$VL=function(s$d){function s$_(s$d,s$L,s$l,s$Z,s$h){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,s$_.__super.call(this,s$d,s$L,s$l),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=s$Z,this._material=s$h}s$Y(s$_,"laya.d3.graphics.SubMeshStaticBatch",s$hd);var s$L=s$_.prototype;return s$L._compareBatchRenderElement=function(s$d,s$L){return s$d._batchIndexStart>s$L._batchIndexStart},s$L._addCombineBatchRenderObjTest=function(s$d){var s$L=s$d.renderObj._vertexCount;return!(65535<(0<s$L?this._currentCombineVertexCount+s$L:this._currentCombineVertexCount+s$d.renderObj._getVertexBuffer().vertexCount))},s$L._addCombineBatchRenderObj=function(s$d){var s$L=s$d.renderObj,s$l=s$L._vertexCount;this._initBatchRenderElements.push(s$d),s$d._staticBatch=this,0<s$l?(this._currentCombineIndexCount+=s$L._indexCount,this._currentCombineVertexCount+=s$l):(this._currentCombineIndexCount=this._currentCombineIndexCount+s$L._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+s$L._getVertexBuffer().vertexCount),this._needFinishCombine=!0},s$L._deleteCombineBatchRenderObj=function(s$d){var s$L=s$d.renderObj,s$l=this._initBatchRenderElements.indexOf(s$d);if(-1!==s$l){this._initBatchRenderElements.splice(s$l,1),s$d._staticBatch=null;var s$Z=s$L._vertexCount;0<s$Z?(this._currentCombineIndexCount=this._currentCombineIndexCount-s$L._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-s$Z):(this._currentCombineIndexCount=this._currentCombineIndexCount-s$L._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-s$L._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},s$L._finishInit=function(){if(this._needFinishCombine){var s$d=0,s$L=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var s$l=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),s$Z=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=s$iL.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=s$oL.create("ushort",this._currentCombineIndexCount,35044);for(var s$h=0,s$_=this._initBatchRenderElements.length;s$h<s$_;s$h++){var s$N=this._initBatchRenderElements[s$h],s$m=s$N.renderObj,s$u=s$m._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,s$N._sprite3D),s$x=s$m.getIndices(),s$t=s$N._sprite3D.transform._isFrontFaceInvert,s$b=s$d/(this._vertexDeclaration.vertexStride/4)-s$m._vertexStart,s$q=s$L,s$Y=s$q+s$x.length;s$N._batchIndexStart=s$q,s$N._batchIndexEnd=s$Y,s$Z.set(s$x,s$L);var s$c=0;if(s$t)for(s$c=s$q;s$c<s$Y;s$c+=3){s$Z[s$c]=s$b+s$Z[s$c];var s$r=s$Z[s$c+1],s$a=s$Z[s$c+2];s$Z[s$c+1]=s$b+s$a,s$Z[s$c+2]=s$b+s$r}else for(s$c=s$q;s$c<s$Y;s$c+=3)s$Z[s$c]=s$b+s$Z[s$c],s$Z[s$c+1]=s$b+s$Z[s$c+1],s$Z[s$c+2]=s$b+s$Z[s$c+2];s$L+=s$x.length,s$l.set(s$u,s$d),s$d+=s$u.length}this._vertexBuffer.setData(s$l),this._indexBuffer.setData(s$Z),this._needFinishCombine=!1}},s$L._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new s$$L)},s$L._getRenderElement=function(s$d,s$L,s$l){for(var s$Z,s$h,s$_=this._batchRenderElements.length,s$N=!0,s$m=0;s$m<s$_;s$m++){var s$u,s$x,s$t=(s$h=this._batchRenderElements[s$m])._sprite3D._render;if(0!==s$m&&(s$N=(s$u=(s$Z=this._batchRenderElements[s$m-1])._sprite3D._render).lightmapIndex!==s$t.lightmapIndex||s$u.receiveShadow!==s$t.receiveShadow||s$Z._batchIndexEnd!==s$h._batchIndexStart),s$N){(s$x=this._getCombineRenderElementFromPool()).renderObj=this,s$x._material=this._material,s$x._batchIndexStart=s$h._batchIndexStart,s$x._batchIndexEnd=s$h._batchIndexEnd;var s$b=s$t.lightmapIndex,s$q=s$b+1,s$Y=this._batchOwnerIndices[s$q];s$Y||(s$Y=this._batchOwnerIndices[s$q]=[]);var s$c,s$r=s$Y[s$h._render.receiveShadow?1:0];void 0===s$r?(s$Y[s$t.receiveShadow?1:0]=this._batchOwners.length,(s$c=new s$KL(null,"StaticBatchMeshSprite3D"))._scene=s$L,s$c._transform=this._rootOwner?this._rootOwner._transform:null,s$c._render.lightmapIndex=s$b,s$c._render.receiveShadow=s$h._render.receiveShadow,this._batchOwners.push(s$c)):s$c=this._batchOwners[s$r],s$c._render._renderUpdate(s$l),s$x._sprite3D=s$c,s$d.push(s$x)}else s$x._batchIndexEnd=s$h._batchIndexEnd}},s$L._beforeRender=function(s$d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},s$L._render=function(s$d){var s$L=s$d.renderElement,s$l=s$L._batchIndexStart,s$Z=s$L._batchIndexEnd-s$l;s$F.mainContext.drawElements(4,s$Z,5123,2*s$l),s$O.drawCall++,s$O.trianglesFaces+=s$Z/3},s$L.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},s$L._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),this._vertexBuffer},s$_}(),s$QL=function(s$d){function s$L(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,s$L.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}s$Y(s$L,"laya.d3.core.ComponentNode",s$x);var s$l=s$L.prototype;return s$l.addComponent=function(s$d){var s$L,s$l=this._componentsMap.indexOf(s$d);if(-1===s$l)s$L=[],this._componentsMap.push(s$d),this._typeComponentsIndices.push(s$L);else if(s$L=this._typeComponentsIndices[s$l],this._components[s$L[0]].isSingleton)throw new Error("无法单实例创建"+s$d+"组件，"+s$d+"组件已存在！");var s$Z=s$h.getInstance(s$d);return s$L.push(this._components.length),this._components.push(s$Z),s$Z instanceof laya.d3.component.Script&&this._scripts.push(s$Z),s$Z._initialize(this),s$Z},s$l._removeComponent=function(s$d,s$L){var s$l=this._typeComponentsIndices[s$d],s$Z=s$l[s$L],s$h=this._components[s$Z];this._components.splice(s$Z,1),s$h instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(s$h),1),s$l.splice(s$L,1),0===s$l.length&&(this._typeComponentsIndices.splice(s$d,1),this._componentsMap.splice(s$d,1));for(var s$_=0,s$N=this._componentsMap.length;s$_<s$N;s$_++)for(var s$m=(s$l=this._typeComponentsIndices[s$_]).length-1;0<=s$m;s$m--){var s$u=s$l[s$m];if(!(s$Z<s$u))break;s$l[s$m]=--s$u}s$h._destroy()},s$l.getComponentByType=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l=this._componentsMap.indexOf(s$d);return-1===s$l?null:this._components[this._typeComponentsIndices[s$l][s$L]]},s$l.getComponentsByType=function(s$d,s$L){var s$l=this._componentsMap.indexOf(s$d);if(-1!==s$l){var s$Z=this._typeComponentsIndices[s$l],s$h=s$Z.length;s$L.length=s$h;for(var s$_=0;s$_<s$h;s$_++)s$L[s$_]=this._components[s$Z[s$_]]}else s$L.length=0},s$l.getComponentByIndex=function(s$d){return this._components[s$d]},s$l.removeComponentByType=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l=this._componentsMap.indexOf(s$d);-1!==s$l&&this._removeComponent(s$l,s$L)},s$l.removeComponentsByType=function(s$d){var s$L=this._componentsMap.indexOf(s$d);if(-1!==s$L)for(var s$l=this._typeComponentsIndices[s$L],s$Z=0,s$h=s$l.length;s$Z<s$h;s$l.length<s$h?s$h--:s$Z++)this._removeComponent(s$L,s$Z)},s$l.removeAllComponent=function(){for(var s$d=0,s$L=this._componentsMap.length;s$d<s$L;this._componentsMap.length<s$L?s$L--:s$d++)this.removeComponentsByType(this._componentsMap[s$d])},s$l._updateComponents=function(s$d){for(var s$L=0,s$l=this._components.length;s$L<s$l;s$L++){var s$Z=this._components[s$L];!s$Z.started&&(s$Z._start(s$d),s$Z.started=!0),s$Z.enable&&s$Z._update(s$d)}},s$l._lateUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._lateUpdate(s$d)}},s$l._preRenderUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._preRenderUpdate(s$d)}},s$l._postRenderUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._postRenderUpdate(s$d)}},s$L}(),s$gL=function(s$Z){function s$d(){s$d.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new s$qL,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new s$mL(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}s$Y(s$d,"laya.d3.core.material.BaseMaterial",s$Z);var s$L=s$d.prototype;return s$A.imps(s$L,{"laya.d3.core.IClone":!0}),s$L._addShaderDefine=function(s$d){this._shaderDefineValue|=s$d},s$L._removeShaderDefine=function(s$d){this._shaderDefineValue&=~s$d},s$L._addDisablePublicShaderDefine=function(s$d){this._disablePublicShaderDefine|=s$d},s$L._removeDisablePublicShaderDefine=function(s$d){this._disablePublicShaderDefine&=~s$d},s$L._setBuffer=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L),this._values[s$d]=s$L},s$L._getBuffer=function(s$d){return this._values[s$d]},s$L._setMatrix4x4=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L?s$L.elements:null),this._values[s$d]=s$L},s$L._getMatrix4x4=function(s$d){return this._values[s$d]},s$L._setInt=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L),this._values[s$d]=s$L},s$L._getInt=function(s$d){return this._values[s$d]},s$L._setNumber=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L),this._values[s$d]=s$L},s$L._getNumber=function(s$d){return this._values[s$d]},s$L._setBool=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L),this._values[s$d]=s$L},s$L._getBool=function(s$d){return this._values[s$d]},s$L._setVector2=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L?s$L.elements:null),this._values[s$d]=s$L},s$L._getVector2=function(s$d){return this._values[s$d]},s$L._setColor=function(s$d,s$L){this._shaderValues.setValue(s$d,s$L?s$L.elements:null),this._values[s$d]=s$L},s$L._getColor=function(s$d){return this._values[s$d]},s$L._setTexture=function(s$d,s$L){var s$l=this._values[s$d];this._values[s$d]=s$L,this._shaderValues.setValue(s$d,s$L),0<this.referenceCount&&(s$l&&s$l._removeReference(),s$L&&s$L._addReference())},s$L._getTexture=function(s$d){return this._values[s$d]},s$L._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},s$L._getShader=function(s$d,s$L,s$l){var s$Z=(s$d|s$L)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(s$Z,s$l,this._shaderDefineValue),this._shader},s$L._setRenderStateBlendDepth=function(){var s$d=s$F.mainContext;switch(s$E.setDepthMask(s$d,this.depthWrite),0===this.depthTest?s$E.setDepthTest(s$d,!1):(s$E.setDepthTest(s$d,!0),s$E.setDepthFunc(s$d,this.depthTest)),this.blend){case 0:s$E.setBlend(s$d,!1);break;case 1:s$E.setBlend(s$d,!0),s$E.setBlendFunc(s$d,this.srcBlend,this.dstBlend);break;case 2:s$E.setBlend(s$d,!0)}},s$L._setRenderStateFrontFace=function(s$d,s$L){var s$l=s$F.mainContext,s$Z=0;switch(this.cull){case 0:s$E.setCullFace(s$l,!1);break;case 1:s$E.setCullFace(s$l,!0),s$Z=s$d?s$L&&s$L._isFrontFaceInvert?2305:2304:s$L&&s$L._isFrontFaceInvert?2304:2305,s$E.setFrontFace(s$l,s$Z);break;case 2:s$E.setCullFace(s$l,!0),s$Z=s$d?s$L&&s$L._isFrontFaceInvert?2304:2305:s$L&&s$L._isFrontFaceInvert?2305:2304,s$E.setFrontFace(s$l,s$Z)}},s$L.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=s$L[0],s$h=s$L[1];switch(s$Z.version){case"LAYAMATERIAL:01":var s$_=0,s$N=0,s$m=s$Z.props;for(var s$u in s$m)switch(s$u){case"vectors":var s$x=s$m[s$u];for(s$_=0,s$N=s$x.length;s$_<s$N;s$_++){var s$t=s$x[s$_],s$b=s$t.value;switch(s$b.length){case 2:this[s$t.name]=new s$_L(s$b[0],s$b[1]);break;case 3:this[s$t.name]=new s$NL(s$b[0],s$b[1],s$b[2]);break;case 4:this[s$t.name]=new s$mL(s$b[0],s$b[1],s$b[2],s$b[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var s$q=s$m[s$u];for(s$_=0,s$N=s$q.length;s$_<s$N;s$_++){var s$Y=s$q[s$_],s$c=s$Y.path;s$c&&(this[s$Y.name]=s$k.getRes(s$h[s$c]))}break;case"defines":var s$r=s$m[s$u];for(s$_=0,s$N=s$r.length;s$_<s$N;s$_++){var s$a=this._shaderCompile.getMaterialDefineByName(s$r[s$_]);this._addShaderDefine(s$a)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[s$u]=s$m[s$u];break;case"renderQueue":switch(s$m[s$u]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[s$u]=s$m[s$u]}break;case"LAYAMATERIAL:02":for(s$u in s$m=s$Z.props)switch(s$u){case"vectors":for(s$_=0,s$N=(s$x=s$m[s$u]).length;s$_<s$N;s$_++)switch((s$b=(s$t=s$x[s$_]).value).length){case 2:this[s$t.name]=new s$_L(s$b[0],s$b[1]);break;case 3:this[s$t.name]=new s$NL(s$b[0],s$b[1],s$b[2]);break;case 4:this[s$t.name]=new s$mL(s$b[0],s$b[1],s$b[2],s$b[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(s$_=0,s$N=(s$q=s$m[s$u]).length;s$_<s$N;s$_++)(s$c=(s$Y=s$q[s$_]).path)&&(this[s$Y.name]=s$k.getRes(s$h[s$c]));break;case"defines":for(s$_=0,s$N=(s$r=s$m[s$u]).length;s$_<s$N;s$_++)s$a=this._shaderCompile.getMaterialDefineByName(s$r[s$_]),this._addShaderDefine(s$a);break;default:this[s$u]=s$m[s$u]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},s$L._addReference=function(){s$Z.prototype._addReference.call(this);for(var s$d=0,s$L=this._values.length;s$d<s$L;s$d++){var s$l=this._values[s$d];s$l&&s$l instanceof laya.d3.resource.BaseTexture&&s$l._addReference()}},s$L._removeReference=function(){s$Z.prototype._removeReference.call(this);for(var s$d=0,s$L=this._values.length;s$d<s$L;s$d++){var s$l=this._values[s$d];s$l&&s$l instanceof laya.d3.resource.BaseTexture&&s$l._removeReference()}},s$L.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},s$L.setShaderName=function(s$d){var s$L=s$jL.nameKey.getID(s$d);if(-1===s$L)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=s$OL._preCompileShader[s$L]},s$L.cloneTo=function(s$d){var s$L=s$d;s$L.name=this.name,s$L.cull=this.cull,s$L.blend=this.blend,s$L.srcBlend=this.srcBlend,s$L.dstBlend=this.dstBlend,s$L.srcBlendRGB=this.srcBlendRGB,s$L.dstBlendRGB=this.dstBlendRGB,s$L.srcBlendAlpha=this.srcBlendAlpha,s$L.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(s$L.blendConstColor),s$L.blendEquation=this.blendEquation,s$L.blendEquationRGB=this.blendEquationRGB,s$L.blendEquationAlpha=this.blendEquationAlpha,s$L.depthTest=this.depthTest,s$L.depthWrite=this.depthWrite,s$L.renderQueue=this.renderQueue,s$L._shader=this._shader,s$L._disablePublicShaderDefine=this._disablePublicShaderDefine,s$L._shaderDefineValue=this._shaderDefineValue;var s$l,s$Z=0,s$h=s$L._shaderValues;s$L._shaderValues.data.length=this._shaderValues.data.length;var s$_=this._values.length,s$N=s$L._values;for(s$Z=0,s$l=s$N.length=s$_;s$Z<s$l;s$Z++){var s$m=this._values[s$Z];if(s$m)if("number"==typeof s$m)s$N[s$Z]=s$m,s$h.data[s$Z]=s$m;else if("number"==typeof s$m&&Math.floor(s$m)==s$m)s$N[s$Z]=s$m,s$h.data[s$Z]=s$m;else if("boolean"==typeof s$m)s$N[s$Z]=s$m,s$h.data[s$Z]=s$m;else if(s$m instanceof laya.d3.math.Vector2){var s$u=s$N[s$Z]||(s$N[s$Z]=new s$_L);s$m.cloneTo(s$u),s$h.data[s$Z]=s$u.elements}else if(s$m instanceof laya.d3.math.Vector3){var s$x=s$N[s$Z]||(s$N[s$Z]=new s$NL);s$m.cloneTo(s$x),s$h.data[s$Z]=s$x.elements}else if(s$m instanceof laya.d3.math.Vector4){var s$t=s$N[s$Z]||(s$N[s$Z]=new s$mL);s$m.cloneTo(s$t),s$h.data[s$Z]=s$t.elements}else if(s$m instanceof laya.d3.math.Matrix4x4){var s$b=s$N[s$Z]||(s$N[s$Z]=new s$dL);s$m.cloneTo(s$b),s$h.data[s$Z]=s$b.elements}else s$m instanceof laya.d3.resource.BaseTexture&&(s$N[s$Z]=s$m,s$h.data[s$Z]=s$m)}},s$L.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$c(0,s$L,"alphaTestValue",function(){return this._getNumber(0)},function(s$d){this._setNumber(0,s$d)}),s$c(0,s$L,"alphaTest",function(){return this._alphaTest},function(s$d){(this._alphaTest=s$d)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),s$d.__init__=function(){s$d.SHADERDEFINE_ALPHATEST=s$d.shaderDefines.registerDefine("ALPHATEST")},s$d.RENDERQUEUE_OPAQUE=2e3,s$d.RENDERQUEUE_ALPHATEST=2450,s$d.RENDERQUEUE_TRANSPARENT=3e3,s$d.CULL_NONE=0,s$d.CULL_FRONT=1,s$d.CULL_BACK=2,s$d.BLEND_DISABLE=0,s$d.BLEND_ENABLE_ALL=1,s$d.BLEND_ENABLE_SEPERATE=2,s$d.BLENDPARAM_ZERO=0,s$d.BLENDPARAM_ONE=1,s$d.BLENDPARAM_SRC_COLOR=768,s$d.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,s$d.BLENDPARAM_DST_COLOR=774,s$d.BLENDPARAM_ONE_MINUS_DST_COLOR=775,s$d.BLENDPARAM_SRC_ALPHA=770,s$d.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,s$d.BLENDPARAM_DST_ALPHA=772,s$d.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,s$d.BLENDPARAM_SRC_ALPHA_SATURATE=776,s$d.BLENDEQUATION_ADD=0,s$d.BLENDEQUATION_SUBTRACT=1,s$d.BLENDEQUATION_REVERSE_SUBTRACT=2,s$d.DEPTHTEST_OFF=0,s$d.DEPTHTEST_NEVER=512,s$d.DEPTHTEST_LESS=513,s$d.DEPTHTEST_EQUAL=514,s$d.DEPTHTEST_LEQUAL=515,s$d.DEPTHTEST_GREATER=516,s$d.DEPTHTEST_NOTEQUAL=517,s$d.DEPTHTEST_GEQUAL=518,s$d.DEPTHTEST_ALWAYS=519,s$d.SHADERDEFINE_ALPHATEST=1,s$d.ALPHATESTVALUE=0,s$b(s$d,["shaderDefines",function(){return this.shaderDefines=new s$tL}]),s$d}(s$a),s$FL=function(s$d){function s$L(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,s$L.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}s$Y(s$L,"laya.d3.resource.BaseTexture",s$a);var s$l=s$L.prototype;return s$c(0,s$l,"width",function(){return this._width}),s$c(0,s$l,"repeat",function(){return this._repeat},function(s$d){if(this._repeat!==s$d&&(this._repeat=s$d,this._source)){var s$L=s$F.mainContext;s$E.bindTexture(s$L,this._type,this._source),s$s.isPOT(this._width,this._height)&&this._repeat?(s$L.texParameteri(this._type,10242,10497),s$L.texParameteri(this._type,10243,10497)):(s$L.texParameteri(this._type,10242,33071),s$L.texParameteri(this._type,10243,33071))}}),s$c(0,s$l,"height",function(){return this._height}),s$c(0,s$l,"magFifter",function(){return this._magFifter},function(s$d){(this._magFifter=s$d)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(s$d)}),s$c(0,s$l,"wrapModeV",function(){return this._wrapModeV}),s$c(0,s$l,"size",function(){return this._size}),s$c(0,s$l,"wrapModeU",function(){return this._wrapModeU}),s$c(0,s$l,"mipmap",function(){return this._mipmap},function(s$d){this._mipmap=s$d,this._mipmap!=s$d&&this._conchTexture&&this._conchTexture.setMipMap(s$d)}),s$c(0,s$l,"minFifter",function(){return this._minFifter},function(s$d){this._minFifter=s$d,this._minFifter!=s$d&&this._conchTexture&&this._conchTexture.setMinFifter(s$d)}),s$c(0,s$l,"format",function(){return this._format}),s$c(0,s$l,"source",function(){return this.activeResource(),this._source}),s$c(0,s$l,"defaulteTexture",function(){return s$PL.grayTexture}),s$L.WARPMODE_REPEAT=0,s$L.WARPMODE_CLAMP=1,s$L}(),s$EL=function(s$d){function s$L(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,s$L.__super.call(this),this._boundingBoxCorners=s$Z(8,null)}s$Y(s$L,"laya.d3.resource.models.BaseMesh",s$a);var s$l=s$L.prototype;return s$l._getPositions=function(){throw new Error("未Override,请重载该属性！")},s$l._generateBoundingObject=function(){this._boundingSphere=new s$Ud(new s$NL,0),s$Ud.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new s$Jd(new s$NL,new s$NL),s$Jd.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},s$l.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},s$l.getRenderElement=function(s$d){throw new Error("未Override,请重载该属性！")},s$c(0,s$l,"subMeshCount",function(){return this._subMeshCount}),s$c(0,s$l,"boundingBox",function(){return this._boundingBox}),s$c(0,s$l,"boundingBoxCorners",function(){return this._boundingBoxCorners}),s$c(0,s$l,"boundingSphere",function(){return this._boundingSphere}),s$L}(),s$IL=(function(s$d){function s$L(){s$L.__super.call(this)}s$Y(s$L,"laya.d3.component.Script",s$wL);var s$l=s$L.prototype;s$l.onTriggerEnter=function(s$d){},s$l.onTriggerExit=function(s$d){},s$l.onTriggerStay=function(s$d){},s$c(0,s$l,"isSingleton",function(){return s$L._isSingleton}),s$L._isSingleton=!1}(),function(s$d){function s$L(s$d){this._owner=null,this._sharedMesh=null,s$L.__super.call(this),this._owner=s$d}s$Y(s$L,"laya.d3.core.MeshFilter",s$d);var s$l=s$L.prototype;return s$l._sharedMeshLoaded=function(){this.event("loaded")},s$l._destroy=function(){s$d.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},s$c(0,s$l,"sharedMesh",function(){return this._sharedMesh},function(s$d){var s$L=this._sharedMesh;s$L&&s$L._removeReference(),(this._sharedMesh=s$d)._addReference(),this.event("meshchanged",[this,s$L,s$d]),s$d.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),s$c(0,s$l,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),s$c(0,s$l,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),s$c(0,s$l,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),s$c(0,s$l,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),s$L}(s$sL)),s$pL=function(s$d){function s$L(s$d){s$L.__super.call(this,s$d),s$d.meshFilter.on("meshchanged",this,this._onMeshChanged)}s$Y(s$L,"laya.d3.core.MeshRender",s$AL);var s$l=s$L.prototype;return s$l._onMeshChanged=function(s$d,s$L,s$l){s$l.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:s$l.once("loaded",this,this._onMeshLoaed)},s$l._onMeshLoaed=function(s$d,s$L){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},s$l._calculateBoundingSphereByInitSphere=function(s$d){var s$L=NaN,s$l=this._owner.transform,s$Z=s$l.scale.elements,s$h=Math.abs(s$Z[0]),s$_=Math.abs(s$Z[1]),s$N=Math.abs(s$Z[2]);s$L=s$_<=s$h&&s$N<=s$h?s$h:s$N<=s$_?s$_:s$N,s$NL.transformCoordinate(s$d.center,s$l.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=s$d.radius*s$L},s$l._calculateBoundBoxByInitCorners=function(s$d){for(var s$L=this._owner.transform.worldMatrix,s$l=0;s$l<8;s$l++)s$NL.transformCoordinate(s$d[s$l],s$L,s$AL._tempBoundBoxCorners[s$l]);s$Jd.createfromPoints(s$AL._tempBoundBoxCorners,this._boundingBox)},s$l._calculateBoundingSphere=function(){var s$d=this._owner.meshFilter.sharedMesh;null==s$d||null==s$d.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(s$d.boundingSphere)},s$l._calculateBoundingBox=function(){var s$d=this._owner.meshFilter.sharedMesh;null==s$d||null==s$d.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(s$d.boundingBoxCorners)},s$l._renderUpdate=function(s$d){var s$L=this._owner.transform;if(s$L){this._setShaderValueMatrix4x4(0,s$L.worldMatrix);var s$l=this._owner.getProjectionViewWorldMatrix(s$d);this._setShaderValueMatrix4x4(1,s$l)}else this._setShaderValueMatrix4x4(0,s$dL.DEFAULT),this._setShaderValueMatrix4x4(1,s$d);return s$kL.debugMode&&this._renderRenderableBoundBox(),!0},s$L}(),s$HL=function(s$L){function s$Z(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,s$Z.__super.call(this),this._renderState=new s$v,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new s$qL,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new s$Ld,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new s$NL(.7,.7,.7),this.ambientColor=new s$NL(.212,.227,.259),s$F.shaderHighPrecision&&this.addShaderDefine(s$OL.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}s$Y(s$Z,"laya.d3.core.scene.Scene",s$L);var s$d=s$Z.prototype;return s$A.imps(s$d,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),s$d._setUrl=function(s$d){this._url=s$d},s$d._getGroup=function(){return this._group},s$d._setGroup=function(s$d){this._group=s$d},s$d._display=function(){s$A.stage._scenes.push(this),s$A.stage._scenes.sort(s$Z._sortScenes);for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++){var s$l=this._childs[s$d];s$l.active&&s$l._activeHierarchy()}},s$d._unDisplay=function(){var s$d=s$A.stage._scenes;s$d.splice(s$d.indexOf(this),1);for(var s$L=0,s$l=this._childs.length;s$L<s$l;s$L++){var s$Z=this._childs[s$L];s$Z.active&&s$Z._inActiveHierarchy()}},s$d._addChild3D=function(s$d){s$d.transform._onWorldTransform(),s$d._setBelongScene(this),this.displayedInStage&&s$d.active&&s$d._activeHierarchy()},s$d._removeChild3D=function(s$d){s$d.transform.parent=null,this.displayedInStage&&s$d.active&&s$d._inActiveHierarchy(),s$d._setUnBelongScene()},s$d.initOctree=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$h&&(s$h=6),this.treeSize=new s$NL(s$d,s$L,s$l),this.treeLevel=s$h,this.treeRoot=new s$J(this,0),this.treeRoot.init(s$Z,this.treeSize)},s$d._prepareUpdateToRenderState=function(s$d,s$L){s$L.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,s$L.scene=this},s$d._prepareSceneToRender=function(s$d){var s$L=this._lights.length;if(0<s$L)for(var s$l=0,s$Z=0;s$Z<s$L&&!(this._lights[s$Z]._prepareToScene(s$d)&&++s$l>=this._enableLightCount);s$Z++);},s$d._updateChilds=function(s$d){for(var s$L=0,s$l=this._childs.length;s$L<s$l;++s$L)this._childs[s$L]._update(s$d)},s$d._preRenderScene=function(s$d,s$L,s$l){var s$Z,s$h=s$L._viewMatrix,s$_=s$L._projectionMatrix,s$N=s$L._projectionViewMatrix,s$m=0,s$u=s$L.camera;for(s$u.useOcclusionCulling?this.treeRoot?s$ld.renderObjectCullingOctree(s$l,this,s$u,s$h,s$_,s$N):s$ld.renderObjectCulling(s$l,this,s$u,s$h,s$_,s$N):s$ld.renderObjectCullingNoBoundFrustum(this,s$u,s$h,s$_,s$N),s$m=0,s$Z=this._quenes.length;s$m<s$Z;s$m++)this._quenes[s$m]&&this._quenes[s$m]._preRender(s$L)},s$d._clear=function(s$d,s$L){var s$l=s$L._viewport,s$Z=s$L.camera,s$h=s$l.x,s$_=s$Z.renderTargetSize.height-s$l.y-s$l.height,s$N=s$l.width,s$m=s$l.height;s$d.viewport(s$h,s$_,s$N,s$m);var s$u=256,s$x=s$Z.renderTarget;switch(s$Z.clearFlag){case 0:var s$t=s$Z.clearColor;if(s$t){s$d.enable(3089),s$d.scissor(s$h,s$_,s$N,s$m);var s$b=s$t.elements;s$d.clearColor(s$b[0],s$b[1],s$b[2],s$b[3]),s$u|=16384}if(s$x)switch(s$t||(s$u=16384),s$x.depthStencilFormat){case 33189:s$u|=256;break;case 36168:s$u|=1024;break;case 34041:s$u|=256,s$u|=1024}s$d.clear(s$u),s$t&&s$d.disable(3089);break;case 1:case 2:if(s$x)switch(s$u=16384,s$x.depthStencilFormat){case 33189:s$u|=256;break;case 36168:s$u|=1024;break;case 34041:s$u|=256,s$u|=1024}s$d.clear(s$u);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},s$d._renderScene=function(s$d,s$L){var s$l,s$Z,s$h=s$L.camera,s$_=0;for(s$_=0;s$_<2;s$_++)(s$Z=this._quenes[s$_])&&(s$h.renderTarget?s$Z._render(s$L,!0):s$Z._render(s$L,!1));if(1===s$h.clearFlag){var s$N=s$h.sky;s$N&&(s$E.setCullFace(s$d,!1),s$E.setDepthFunc(s$d,515),s$E.setDepthMask(s$d,!1),s$N._render(s$L),s$E.setDepthFunc(s$d,513),s$E.setDepthMask(s$d,!0))}for(s$_=2,s$l=this._quenes.length;s$_<s$l;s$_++)(s$Z=this._quenes[s$_])&&(s$Z._sortAlpha(s$L.camera.transform.position),s$h.renderTarget?s$Z._render(s$L,!0):s$Z._render(s$L,!1))},s$d._set3DRenderConfig=function(s$d){s$d.disable(3042),s$E._blend=!1,s$d.blendFunc(770,771),s$E._sFactor=770,s$E._dFactor=771,s$d.disable(2929),s$E._depthTest=!1,s$d.enable(2884),s$E._cullFace=!0,s$d.depthMask(1),s$E._depthMask=!0,s$d.frontFace(2304),s$E._frontFace=2304},s$d._set2DRenderConfig=function(s$d){s$E.setBlend(s$d,!0),s$E.setBlendFunc(s$d,1,771),s$E.setDepthTest(s$d,!1),s$E.setCullFace(s$d,!1),s$E.setDepthMask(s$d,!0),s$E.setFrontFace(s$d,2305),s$d.viewport(0,0,s$t.width,s$t.height)},s$d._parseCustomProps=function(s$d,s$L,s$l,s$Z){var s$h=s$Z.customProps.lightmaps,s$_=s$h.length,s$N=this._lightmaps;s$N.length=s$_;for(var s$m=0;s$m<s$_;s$m++)s$N[s$m]=s$k.getRes(s$L[s$h[s$m].replace(".exr",".png")]);this.setlightmaps(s$N);var s$u=s$Z.customProps.ambientColor;s$u&&(this.ambientColor=new s$NL(s$u[0],s$u[1],s$u[2]));var s$x=s$Z.customProps.fogColor;s$x&&(this.fogColor=new s$NL(s$x[0],s$x[1],s$x[2]))},s$d._addLight=function(s$d){this._lights.indexOf(s$d)<0&&this._lights.push(s$d)},s$d._removeLight=function(s$d){var s$L=this._lights.indexOf(s$d);0<=s$L&&this._lights.splice(s$L,1)},s$d._updateScene=function(){var s$d=this._renderState;this._prepareUpdateToRenderState(s$F.mainContext,s$d),this._updateComponents(s$d),this._updateChilds(s$d),this._lateUpdateComponents(s$d),this._time+=s$d.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},s$d._updateSceneConch=function(){var s$d=this._renderState;this._prepareUpdateToRenderState(s$F.mainContext,s$d),this._updateComponents(s$d),this._lateUpdateComponents(s$d),this._prepareSceneToRender(s$d);for(var s$L=0,s$l=this._cameraPool.length;s$L<s$l;s$L++){var s$Z=this._cameraPool[s$L];(s$d.camera=s$Z)._prepareCameraToRender()}},s$d._preRenderShadow=function(s$d,s$L,s$l,s$Z,s$h){this.treeRoot?s$ld.renderShadowObjectCullingOctree(this,s$L,s$l,s$Z,s$h):s$ld.renderShadowObjectCulling(this,s$L,s$l,s$Z,s$h);for(var s$_=0,s$N=s$l.length;s$_<s$N;s$_++)s$l[s$_]&&s$l[s$_]._preRender(s$d)},s$d._renderShadowMap=function(s$d,s$L,s$l){var s$Z=this.parallelSplitShadowMaps[0];s$Z._calcAllLightCameraInfo(s$l);var s$h,s$_,s$N,s$m=s$Z.PSSMNum;if(this._preRenderShadow(s$L,s$Z._lightCulling,s$Z._shadowQuenes,s$Z._lightVPMatrix[0],s$m),this.addShaderDefine(s$YL.SHADERDEFINE_CAST_SHADOW),1<s$m)for(var s$u=0;s$u<s$m;s$u++)s$h=s$Z.getRenderTarget(s$u+1),s$Z.beginRenderTarget(s$u+1),s$d.clearColor(1,1,1,1),s$d.clear(16640),s$d.viewport(0,0,s$h.width,s$h.height),s$L.camera=s$N=s$Z.getLightCamera(s$u),s$N._prepareCameraToRender(),s$N._prepareCameraViewProject(s$N.viewMatrix,s$N.projectionMatrix),s$L._projectionViewMatrix=s$Z._lightVPMatrix[s$u+1],(s$_=s$Z._shadowQuenes[s$u])._preRender(s$L),s$_._renderShadow(s$L,!1),s$Z.endRenderTarget(s$u+1);else s$h=s$Z.getRenderTarget(1),s$Z.beginRenderTarget(1),s$d.clearColor(1,1,1,1),s$d.clear(16640),s$d.viewport(0,0,s$h.width,s$h.height),s$L.camera=s$N=s$Z.getLightCamera(0),s$N._prepareCameraToRender(),s$N._prepareCameraViewProject(s$N.viewMatrix,s$N.projectionMatrix),s$L._projectionViewMatrix=s$Z._lightVPMatrix[0],(s$_=s$Z._shadowQuenes[0])._preRender(s$L),s$_._renderShadow(s$L,!0),s$Z.endRenderTarget(1);this.removeShaderDefine(s$YL.SHADERDEFINE_CAST_SHADOW)},s$d.addTreeNode=function(s$d){this.treeRoot.addTreeNode(s$d)},s$d.removeTreeNode=function(s$d){this.treeSize&&s$d._treeNode&&s$d._treeNode.removeObject(s$d)},s$d.setlightmaps=function(s$d){this._lightmaps=s$d;for(var s$L=0,s$l=this._renderableSprite3Ds.length;s$L<s$l;s$L++)this._renderableSprite3Ds[s$L]._render._applyLightMapParams()},s$d.getlightmaps=function(){return this._lightmaps},s$d.addChildAt=function(s$d,s$L){if(!(s$d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(s$d&&s$d.__className));if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),0<=s$L&&s$L<=this._childs.length){if(s$d._parent===this){var s$l=this.getChildIndex(s$d);this._childs.splice(s$l,1),this._childs.splice(s$L,0,s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,s$L)),this._childChanged()}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$x.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(s$L,0,s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,s$L),(s$d.parent=this)._addChild3D(s$d);return s$d}throw new Error("appendChildAt:The index is out of bounds")},s$d.addChild=function(s$d){if(!(s$d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),s$d._parent===this){var s$L=this.getChildIndex(s$d);s$L!==this._childs.length-1&&(this._childs.splice(s$L,1),this._childs.push(s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1)),this._childChanged())}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$x.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1),(s$d.parent=this)._childChanged(),this._addChild3D(s$d);return s$d},s$d.removeChildAt=function(s$d){var s$L=this.getChildAt(s$d);return s$L&&(this._removeChild3D(s$L),this._childs.splice(s$d,1),this.conchModel&&this.conchModel.removeChild(s$L.conchModel),s$L.parent=null),s$L},s$d.removeChildren=function(s$d,s$L){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=2147483647),this._childs&&0<this._childs.length){var s$l=this._childs;if(0===s$d&&s$_<=s$L){var s$Z=s$l;this._childs=s$x.ARRAY_EMPTY}else s$Z=s$l.splice(s$d,s$L-s$d);for(var s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)this._removeChild3D(s$Z[s$h]),s$Z[s$h].parent=null,this.conchModel&&this.conchModel.removeChild(s$Z[s$h].conchModel)}return this},s$d.addFrustumCullingObject=function(s$d){this.treeRoot?this.addTreeNode(s$d):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(s$d):this._cullingRenders[this._cullingRendersLength]=s$d,s$d._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},s$d.removeFrustumCullingObject=function(s$d){if(this.treeRoot)this.removeTreeNode(s$d);else{this._cullingRendersLength--;var s$L=s$d._indexInSceneFrustumCullingObjects;if(s$L!==this._cullingRendersLength){var s$l=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[s$L]=s$l)._indexInSceneFrustumCullingObjects=s$L,s$d._indexInSceneFrustumCullingObjects=-1}}},s$d.getRenderQueue=function(s$d){return s$d<3e3?this._quenes[1]||(this._quenes[1]=new s$K(this)):this._quenes[2]||(this._quenes[2]=new s$K(this))},s$d.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new s$K(this)},s$d.addShaderDefine=function(s$d){this._shaderDefineValue|=s$d},s$d.removeShaderDefine=function(s$d){this._shaderDefineValue&=~s$d},s$d.addScript=function(s$d){return this._addComponent(s$d)},s$d.getScriptByType=function(s$d,s$L){return void 0===s$L&&(s$L=0),this._getComponentByType(s$d,s$L)},s$d.getScriptsByType=function(s$d,s$L){this._getComponentsByType(s$d,s$L)},s$d.getScriptByIndex=function(s$d){return this._getComponentByIndex(s$d)},s$d.removeScriptByType=function(s$d,s$L){void 0===s$L&&(s$L=0),this._removeComponentByType(s$d,s$L)},s$d.removeScriptsByType=function(s$d){this._removeComponentByType(s$d)},s$d.removeAllScript=function(){this._removeAllComponent()},s$d.render=function(s$d,s$L,s$l){(s$r._context.ctx._renderKey=0)<this._childs.length&&s$d.addRenderObject(this)},s$d.renderSubmit=function(){var s$d=s$F.mainContext,s$L=this._renderState;this._set3DRenderConfig(s$d),this._prepareSceneToRender(this._renderState);var s$l,s$Z=0,s$h=0;if(s$kL.debugMode||s$J.debugMode)for(s$Z=0,s$h=this._cameraPool.length;s$Z<s$h;s$Z++)s$l=this._cameraPool[s$Z],s$kL._debugPhasorSprite.begin(1,s$l),s$l.activeInHierarchy&&s$l._renderCamera(s$d,s$L,this),s$kL._debugPhasorSprite.end();else for(s$Z=0,s$h=this._cameraPool.length;s$Z<s$h;s$Z++)(s$l=this._cameraPool[s$Z]).activeInHierarchy&&s$l._renderCamera(s$d,s$L,this);return this._set2DRenderConfig(s$d),1},s$d.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=s$L[0];if("Scene"!==s$Z.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var s$h=s$L[1];s$aL._createNodeByJson(this,s$Z,this,s$h),this.event("hierarchyloaded",[this]),this.__loaded=!0},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),this.destroyed||(s$L.prototype.destroy.call(this,s$d),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,s$k.clearRes(this.url),this.loaded||s$kL._cancelLoadByUrl(this.url))},s$d.getRenderType=function(){return 0},s$d.releaseRender=function(){},s$d._addComponent=function(s$d){var s$L,s$l=this._componentsMap.indexOf(s$d);if(-1===s$l)s$L=[],this._componentsMap.push(s$d),this._typeComponentsIndices.push(s$L);else if(s$L=this._typeComponentsIndices[s$l],this._components[s$L[0]].isSingleton)throw new Error("无法单实例创建"+s$d+"组件，"+s$d+"组件已存在！");var s$Z=s$h.getInstance(s$d);s$L.push(this._components.length),this._components.push(s$Z);return s$Z._initialize(this),s$Z},s$d._removeComponent=function(s$d,s$L){var s$l=this._typeComponentsIndices[s$d],s$Z=s$l[s$L],s$h=this._components[s$Z];this._components.splice(s$Z,1),s$l.splice(s$L,1),0===s$l.length&&(this._typeComponentsIndices.splice(s$d,1),this._componentsMap.splice(s$d,1));for(var s$_=0,s$N=this._componentsMap.length;s$_<s$N;s$_++)for(var s$m=(s$l=this._typeComponentsIndices[s$_]).length-1;0<=s$m;s$m--){var s$u=s$l[s$m];if(!(s$Z<s$u))break;s$l[s$m]=--s$u}s$h._destroy()},s$d._getComponentByType=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l=this._componentsMap.indexOf(s$d);return-1===s$l?null:this._components[this._typeComponentsIndices[s$l][s$L]]},s$d._getComponentsByType=function(s$d,s$L){var s$l=this._componentsMap.indexOf(s$d);if(-1!==s$l){var s$Z=this._typeComponentsIndices[s$l],s$h=s$Z.length;s$L.length=s$h;for(var s$_=0;s$_<s$h;s$_++)s$L[s$_]=this._components[s$Z[s$_]]}else s$L.length=0},s$d._getComponentByIndex=function(s$d){return this._components[s$d]},s$d._removeComponentByType=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l=this._componentsMap.indexOf(s$d);-1!==s$l&&this._removeComponent(s$l,s$L)},s$d._removeComponentsByType=function(s$d){var s$L=this._componentsMap.indexOf(s$d);if(-1!==s$L)for(var s$l=this._typeComponentsIndices[s$L],s$Z=0,s$h=s$l.length;s$Z<s$h;s$l.length<s$h?s$h--:s$Z++)this._removeComponent(s$L,s$Z)},s$d._removeAllComponent=function(){for(var s$d=0,s$L=this._componentsMap.length;s$d<s$L;this._componentsMap.length<s$L?s$L--:s$d++)this._removeComponentsByType(this._componentsMap[s$d])},s$d._updateComponents=function(s$d){for(var s$L=0,s$l=this._components.length;s$L<s$l;s$L++){var s$Z=this._components[s$L];!s$Z.started&&(s$Z._start(s$d),s$Z.started=!0),s$Z.enable&&s$Z._update(s$d)}},s$d._lateUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._lateUpdate(s$d)}},s$d._preRenderUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._preRenderUpdate(s$d)}},s$d._postRenderUpdateComponents=function(s$d){for(var s$L=0;s$L<this._components.length;s$L++){var s$l=this._components[s$L];!s$l.started&&(s$l._start(s$d),s$l.started=!0),s$l.enable&&s$l._postRenderUpdate(s$d)}},s$c(0,s$d,"_loaded",null,function(s$d){this.__loaded=s$d}),s$c(0,s$d,"fogColor",function(){return this._fogColor},function(s$d){this._fogColor=s$d,this._shaderValues.setValue(0,s$d.elements)}),s$c(0,s$d,"enableFog",function(){return this._enableFog},function(s$d){this._enableFog!==s$d&&((this._enableFog=s$d)?(this.addShaderDefine(s$OL.SHADERDEFINE_FOG),this.removeShaderDefine(s$OL.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(s$OL.SHADERDEFINE_FOG))}),s$c(0,s$d,"url",function(){return this._url}),s$c(0,s$d,"loaded",function(){return this.__loaded}),s$c(0,s$d,"enableDepthFog",function(){return this._enableDepthFog},function(s$d){this._enableDepthFog!=s$d&&((this._enableDepthFog=s$d)?(this.addShaderDefine(s$OL.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(s$OL.SHADERDEFINE_FOG)):this.removeShaderDefine(s$OL.SAHDERDEFINE_DEPTHFOG))}),s$c(0,s$d,"fogStart",function(){return this._fogStart},function(s$d){this._fogStart=s$d,this._shaderValues.setValue(1,s$d)}),s$c(0,s$d,"fogRange",function(){return this._fogRange},function(s$d){this._fogRange=s$d,this._shaderValues.setValue(2,s$d)}),s$c(0,s$d,"ambientColor",function(){return this._ambientColor},function(s$d){this._ambientColor=s$d,this._shaderValues.setValue(21,s$d.elements)}),s$c(0,s$d,"scene",function(){return this}),s$c(0,s$d,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),s$Z._sortScenes=function(s$d,s$L){if(s$d.parent!==s$A.stage||s$L.parent!==s$A.stage)return s$d.parent!==s$A.stage&&s$L.parent!==s$A.stage?s$Z._sortScenes(s$d.parent,s$L.parent):s$d.parent===s$A.stage?-1:1;var s$l=s$A.stage._childs;return s$l.indexOf(s$d)-s$l.indexOf(s$L)},s$Z.load=function(s$d){return s$A.loader.create(s$d,null,null,s$Z)},s$Z.FOGCOLOR=0,s$Z.FOGSTART=1,s$Z.FOGRANGE=2,s$Z.LIGHTDIRECTION=3,s$Z.LIGHTDIRCOLOR=4,s$Z.POINTLIGHTPOS=5,s$Z.POINTLIGHTRANGE=6,s$Z.POINTLIGHTATTENUATION=7,s$Z.POINTLIGHTCOLOR=8,s$Z.SPOTLIGHTPOS=9,s$Z.SPOTLIGHTDIRECTION=10,s$Z.SPOTLIGHTSPOT=11,s$Z.SPOTLIGHTRANGE=12,s$Z.SPOTLIGHTATTENUATION=13,s$Z.SPOTLIGHTCOLOR=14,s$Z.SHADOWDISTANCE=15,s$Z.SHADOWLIGHTVIEWPROJECT=16,s$Z.SHADOWMAPPCFOFFSET=17,s$Z.SHADOWMAPTEXTURE1=18,s$Z.SHADOWMAPTEXTURE2=19,s$Z.SHADOWMAPTEXTURE3=20,s$Z.AMBIENTCOLOR=21,s$Z.TIME=22,s$Z}(s$$),s$XL=function(s$d){function s$L(s$d){s$L.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new s$dL,this._shaderValues=new s$qL,this._colliders=[],this._id=++s$L._uniqueIDCounter,this._transform=new s$yL(this),this.name=s$d||"Sprite3D-"+s$L._nameNumberCounter++,this.layer=s$p.currentCreationLayer,this.active=!0}s$Y(s$L,"laya.d3.core.Sprite3D",s$QL);var s$l=s$L.prototype;return s$A.imps(s$l,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),s$l._setUrl=function(s$d){this._url=s$d},s$l._getGroup=function(){return this._group},s$l._setGroup=function(s$d){this._group=s$d},s$l._addChild3D=function(s$d){s$d.transform.parent=this.transform,this._hierarchyAnimator&&(!s$d._hierarchyAnimator&&s$d._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(s$d,!0,[s$d.name])),this._scene&&(s$d._setBelongScene(this._scene),this._activeInHierarchy&&s$d._active&&s$d._activeHierarchy())},s$l._removeChild3D=function(s$d){s$d.transform.parent=null,this._scene&&(this._activeInHierarchy&&s$d._active&&s$d._inActiveHierarchy(),s$d._setUnBelongScene()),this._hierarchyAnimator&&(s$d._hierarchyAnimator==this._hierarchyAnimator&&s$d._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(s$d,!1,[s$d.name]))},s$l._parseBaseCustomProps=function(s$d){var s$L=this.transform.localPosition;s$d.translate?(s$L.fromArray(s$d.translate),s$L.x*=100,s$L.y*=100,s$L.z*=100):s$L.elements.fill(0),this.transform.localPosition=s$L;var s$l=this.transform.localRotation;s$d.rotation?s$l.fromArray(s$d.rotation):s$l.fromArray([0,0,0,-1]),this.transform.localRotation=s$l;var s$Z=this.transform.localScale;s$d.scale?s$Z.fromArray(s$d.scale):s$Z.elements.fill(1),this.transform.localScale=s$Z;var s$h=s$d.layer;null!=s$h&&(this.layer=s$p.getLayerByNumber(s$h))},s$l._parseCustomComponent=function(s$d,s$L,s$l){for(var s$Z in s$l){var s$h=s$l[s$Z];switch(s$Z){case"Animator":var s$_=this.addComponent(Animator);if(s$h.avatarPath)s$_.avatar=s$k.getRes(s$L[s$h.avatarPath]);else{var s$N=s$h.avatar;if(s$N){s$_.avatar=s$k.getRes(s$L[s$N.path]);var s$m=s$N.linkSprites;s$m&&s$d.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[s$_,s$m])}}for(var s$u=s$h.clipPaths,s$x=s$u.length,s$t=0;s$t<s$x;s$t++)s$_.addClip(s$k.getRes(s$L[s$u[s$t]]));s$_.clip=s$k.getRes(s$L[s$u[0]]);var s$b=s$h.playOnWake;void 0!==s$b&&(s$_.playOnWake=s$b);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var s$q=this.addComponent(SphereCollider);s$q.isTrigger=s$h.isTrigger;var s$Y=s$q.center;s$Y.fromArray(s$h.center),s$q.center=s$Y,s$q.radius=s$h.radius;break;case"BoxCollider":var s$c=this.addComponent(BoxCollider);s$c.isTrigger=s$h.isTrigger,s$c.center.fromArray(s$h.center);var s$r=s$c.size;s$r.fromArray(s$h.size),s$c.size=s$r;break;case"MeshCollider":this.addComponent(MeshCollider)}}},s$l._onRootNodeHierarchyLoaded=function(s$d,s$L){for(var s$l in s$L){for(var s$Z=this,s$h=s$L[s$l],s$_=0,s$N=s$h.length;s$_<s$N;s$_++){var s$m=s$h[s$_];if(""===s$m)break;if(!(s$Z=s$Z.getChildByName(s$m)))break}s$Z&&s$d.linkSprite3DToAvatarNode(s$l,s$Z)}},s$l._setHierarchyAnimator=function(s$d,s$L){this._changeHierarchyAnimator(s$d);for(var s$l=0,s$Z=this._childs.length;s$l<s$Z;s$l++){var s$h=this._childs[s$l];s$h._hierarchyAnimator==s$L&&s$h._setHierarchyAnimator(s$d,s$L)}},s$l._clearHierarchyAnimator=function(s$d,s$L){this._changeHierarchyAnimator(s$L);for(var s$l=0,s$Z=this._childs.length;s$l<s$Z;s$l++){var s$h=this._childs[s$l];s$h._hierarchyAnimator==s$d&&s$h._clearHierarchyAnimator(s$d,s$L)}},s$l._getAnimatorToLinkSprite3D=function(s$d,s$L,s$l){var s$Z=this.getComponentByType(Animator);if(s$Z&&(s$Z.avatar?s$Z.avatar._version||s$d._setAnimatorToLinkAvatar(s$Z,s$L):s$d._setAnimatorToLinkSprite3DNoAvatar(s$Z,s$L,s$l)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){s$l.unshift(this._parent.name);var s$h=this._parent;s$h._hierarchyAnimator&&s$h._getAnimatorToLinkSprite3D(s$d,s$L,s$l)}},s$l._setAnimatorToLinkSprite3DNoAvatar=function(s$d,s$L,s$l){var s$Z=0,s$h=0;for(s$Z=0,s$h=s$d.getClipCount();s$Z<s$h;s$Z++)s$d._handleSpriteOwnersBySprite(s$Z,s$L,s$l,this);for(s$Z=0,s$h=this._childs.length;s$Z<s$h;s$Z++){var s$_=this._childs[s$Z],s$N=s$l.length;s$l.push(s$_.name),s$_._setAnimatorToLinkSprite3DNoAvatar(s$d,s$L,s$l),s$l.splice(s$N,1)}},s$l._changeHierarchyAnimator=function(s$d){this._hierarchyAnimator=s$d},s$l._isLinkSpriteToAnimationNode=function(s$d,s$L,s$l){var s$Z=s$d._avatarNodes.indexOf(s$L),s$h=s$d._cacheSpriteToNodesMap;if(s$l)this._transform.dummy=s$L.transform,s$d._cacheNodesToSpriteMap[s$Z]=s$h.length,s$h.push(s$Z);else{this._transform.dummy=null;var s$_=s$d._cacheNodesToSpriteMap[s$Z];s$d._cacheNodesToSpriteMap[s$Z]=null,s$h.splice(s$_,1)}},s$l._setBelongScene=function(s$d){this._scene=s$d;for(var s$L=0,s$l=this._childs.length;s$L<s$l;s$L++)this._childs[s$L]._setBelongScene(s$d)},s$l._setUnBelongScene=function(){this._scene=null;for(var s$d=0,s$L=this._childs.length;s$d<s$L;s$d++)this._childs[s$d]._setUnBelongScene()},s$l._activeHierarchy=function(){var s$d=0,s$L=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),s$d=0,s$L=this._colliders.length;s$d<s$L;s$d++)this._layer._addCollider(this._colliders[s$d]);for(this.event("activeinhierarchychanged",!0),s$d=0,s$L=this._childs.length;s$d<s$L;s$d++){var s$l=this._childs[s$d];s$l._active&&s$l._activeHierarchy()}},s$l._inActiveHierarchy=function(){var s$d=0,s$L=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),s$d=0,s$L=this._colliders.length;s$d<s$L;s$d++){var s$l=this._colliders[s$d];s$l._clearCollsionMap(),this._layer._removeCollider(s$l)}for(this.event("activeinhierarchychanged",!1),s$d=0,s$L=this._childs.length;s$d<s$L;s$d++){var s$Z=this._childs[s$d];s$Z._active&&s$Z._inActiveHierarchy()}},s$l.addComponent=function(s$d){var s$L,s$l=this._componentsMap.indexOf(s$d);if(-1===s$l)s$L=[],this._componentsMap.push(s$d),this._typeComponentsIndices.push(s$L);else if(s$L=this._typeComponentsIndices[s$l],this._components[s$L[0]].isSingleton)throw new Error("无法单实例创建"+s$d+"组件，"+s$d+"组件已存在！");var s$Z=s$h.getInstance(s$d);return s$L.push(this._components.length),this._components.push(s$Z),s$Z instanceof laya.d3.component.Script&&this._scripts.push(s$Z),s$Z._initialize(this),s$Z},s$l._removeComponent=function(s$d,s$L){var s$l,s$Z=0,s$h=this._typeComponentsIndices[s$d],s$_=s$h[s$L],s$N=this._components[s$_];for(s$N instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(s$N),1),s$h.splice(s$L,1),0===s$h.length&&(this._typeComponentsIndices.splice(s$d,1),this._componentsMap.splice(s$d,1)),s$Z=0,s$l=this._componentsMap.length;s$Z<s$l;s$Z++)for(var s$m=(s$h=this._typeComponentsIndices[s$Z]).length-1;0<=s$m;s$m--){var s$u=s$h[s$m];if(!(s$_<s$u))break;s$h[s$m]=--s$u}s$N._destroy()},s$l._clearSelfRenderObjects=function(){},s$l._addSelfRenderObjects=function(){},s$l._parseCustomProps=function(s$d,s$L,s$l,s$Z){},s$l._updateChilds=function(s$d){var s$L=this._childs.length;if(0!==s$L)for(var s$l=0;s$l<s$L;++s$l)this._childs[s$l]._update(s$d)},s$l._getSortID=function(s$d,s$L){return 1e3*s$L.id+s$d._getVertexBuffer().vertexDeclaration.id},s$l._update=function(s$d){(s$d.owner=this)._activeInHierarchy&&(this._updateComponents(s$d),this._lateUpdateComponents(s$d),s$O.spriteCount++,this._childs.length&&this._updateChilds(s$d))},s$l.getProjectionViewWorldMatrix=function(s$d){return s$dL.multiply(s$d,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},s$l.loadHierarchy=function(s$d){this.addChild(laya.d3.core.Sprite3D.load(s$d))},s$l.addChildAt=function(s$d,s$L){if(!(s$d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),0<=s$L&&s$L<=this._childs.length){if(s$d._parent===this){var s$l=this.getChildIndex(s$d);this._childs.splice(s$l,1),this._childs.splice(s$L,0,s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,s$L)),this._childChanged()}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$x.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(s$L,0,s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,s$L),(s$d.parent=this)._addChild3D(s$d);return s$d}throw new Error("appendChildAt:The index is out of bounds")},s$l.addChild=function(s$d){if(!(s$d instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!s$d||this.destroyed||s$d===this)return s$d;if(s$d.zOrder&&this._set$P("hasZorder",!0),s$d._parent===this){var s$L=this.getChildIndex(s$d);s$L!==this._childs.length-1&&(this._childs.splice(s$L,1),this._childs.push(s$d),this.conchModel&&(this.conchModel.removeChild(s$d.conchModel),this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1)),this._childChanged())}else s$d.parent&&s$d.parent.removeChild(s$d),this._childs===s$x.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(s$d),this.conchModel&&this.conchModel.addChildAt(s$d.conchModel,this._childs.length-1),(s$d.parent=this)._childChanged(),this._addChild3D(s$d);return s$d},s$l.removeChildAt=function(s$d){var s$L=this.getChildAt(s$d);return s$L&&(this._removeChild3D(s$L),this._childs.splice(s$d,1),this.conchModel&&this.conchModel.removeChild(s$L.conchModel),s$L.parent=null),s$L},s$l.removeChildren=function(s$d,s$L){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=2147483647),this._childs&&0<this._childs.length){var s$l=this._childs;if(0===s$d&&s$_<=s$L){var s$Z=s$l;this._childs=s$x.ARRAY_EMPTY}else s$Z=s$l.splice(s$d,s$L-s$d);for(var s$h=0,s$_=s$Z.length;s$h<s$_;s$h++)this._removeChild3D(s$Z[s$h]),s$Z[s$h].parent=null,this.conchModel&&this.conchModel.removeChild(s$Z[s$h].conchModel)}return this},s$l.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=s$L[0];if("Sprite3D"!==s$Z.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var s$h=s$L[1];s$aL._createNodeByJson(this,s$Z,this,s$h),this.event("hierarchyloaded",[this]),this.__loaded=!0},s$l.cloneTo=function(s$d){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var s$L=s$d;s$L.name=this.name,s$L._destroyed=this._destroyed,s$L.timer=this.timer,s$L._$P=this._$P,s$L.active=this._active;var s$l=s$L.transform.localPosition;this.transform.localPosition.cloneTo(s$l),s$L.transform.localPosition=s$l;var s$Z=s$L.transform.localRotation;this.transform.localRotation.cloneTo(s$Z),s$L.transform.localRotation=s$Z;var s$h=s$L.transform.localScale;this.transform.localScale.cloneTo(s$h),s$L.transform.localScale=s$h,s$L.isStatic=this.isStatic;var s$_=0,s$N=0;for(s$_=0,s$N=this._componentsMap.length;s$_<s$N;s$_++){var s$m=s$L.addComponent(this._componentsMap[s$_]);this._components[s$_]._cloneTo(s$m)}for(s$_=0,s$N=this._childs.length;s$_<s$N;s$_++)s$L.addChild(this._childs[s$_].clone());var s$u=s$L.getComponentByType(Animator);if(s$u){var s$x=s$u._linkSpritesData;if(s$x)for(var s$t in s$x){for(var s$b=s$x[s$t],s$q=s$L,s$Y=0,s$c=s$b.length;s$Y<s$c&&(s$q=s$q.getChildByName(s$b[s$Y]));s$Y++);if(s$q){var s$r=s$u._avatarNodeMap[s$t];s$q._isLinkSpriteToAnimationNode(s$u,s$r,!0)}}}},s$l.clone=function(){var s$d=new this.constructor;return this.cloneTo(s$d),s$d},s$l.destroy=function(s$d){if(void 0===s$d&&(s$d=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,s$d);var s$L,s$l=0;for(s$l=0,s$L=this._components.length;s$l<s$L;s$l++)this._components[s$l]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,s$k.clearRes(this.url),this.loaded||s$kL._cancelLoadByUrl(this.url)}},s$l._handleSpriteToAvatar=function(s$d,s$L){s$d._avatarNodes;var s$l=s$d._avatarNodeMap[this.name];s$l&&s$l.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(s$d,s$l,s$L)},s$l._setAnimatorToLinkAvatar=function(s$d,s$L){this._handleSpriteToAvatar(s$d,s$L);for(var s$l=0,s$Z=this._childs.length;s$l<s$Z;s$l++){this._childs[s$l]._setAnimatorToLinkAvatar(s$d,s$L)}},s$c(0,s$l,"activeInHierarchy",function(){return this._activeInHierarchy}),s$c(0,s$l,"_loaded",null,function(s$d){this.__loaded=s$d}),s$c(0,s$l,"active",function(){return this._active},function(s$d){this._active!==s$d&&(this._active=s$d,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(s$d?this._activeHierarchy():this._inActiveHierarchy()))}),s$c(0,s$l,"componentsCount",function(){return this._components.length}),s$c(0,s$l,"loaded",function(){return this.__loaded}),s$c(0,s$l,"id",function(){return this._id}),s$c(0,s$l,"url",function(){return this._url}),s$c(0,s$l,"layer",function(){return this._layer},function(s$d){if(this._layer!==s$d){if(!s$d)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var s$L=0,s$l=this._colliders.length;if(this._layer)for(s$L=0;s$L<s$l;s$L++)this._layer._removeCollider(this._colliders[s$L]);for(s$L=0;s$L<s$l;s$L++)s$d._addCollider(this._colliders[s$L])}this._layer=s$d,this.event("layerchanged",s$d)}}),s$c(0,s$l,"scene",function(){return this._scene}),s$c(0,s$l,"transform",function(){return this._transform}),s$L.instantiate=function(s$d,s$L,s$l,s$Z,s$h){void 0===s$l&&(s$l=!0);var s$_=s$d.clone();s$L&&s$L.addChild(s$_);var s$N=s$_.transform;if(s$l){var s$m=s$N.worldMatrix;s$d.transform.worldMatrix.cloneTo(s$m),s$N.worldMatrix=s$m}else s$Z&&(s$N.position=s$Z),s$h&&(s$N.rotation=s$h);return s$_},s$L.load=function(s$d){return s$A.loader.create(s$d,null,null,s$L)},s$L.WORLDMATRIX=0,s$L.MVPMATRIX=1,s$L._uniqueIDCounter=0,s$L._nameNumberCounter=0,s$L}(),s$jL=function(s$d){function s$t(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],s$t.__super.call(this),!s$d||!s$L)throw"Shader Error";this._id=++s$t._count,this._vs=s$d,this._ps=s$L,this._attributeMap=s$l,this._sceneUniformMap=s$Z,this._cameraUniformMap=s$h,this._spriteUniformMap=s$_,this._materialUniformMap=s$N,this._renderElementUniformMap=s$m,this._precompile=s$u,this._define=s$x,this._precompile&&s$t.extCompileObj&&s$t.extCompileFunc?s$t.extCompileFunc.call(s$t.extCompileObj,s$d,s$L,s$x):this.recreateResource()}s$Y(s$t,"laya.d3.shader.Shader3D",s$l);var s$L=s$t.prototype;return s$L.recreateResource=function(){s$I.now();this._compile(),this.completeCreate(),this.memorySize=0},s$L.disposeResource=function(){s$F.mainContext.deleteShader(this._vshader),s$F.mainContext.deleteShader(this._pshader),s$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},s$L._compile=function(){if(!s$F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var s$d=[this._vs,this._ps],s$L=s$F.mainContext;if(this._program=s$L.createProgram(),this._vshader=s$t._createShader(s$L,s$d[0],35633),this._pshader=s$t._createShader(s$L,s$d[1],35632),s$L.attachShader(this._program,this._vshader),s$L.attachShader(this._program,this._pshader),s$L.linkProgram(this._program),!s$r.isConchApp&&s$OL.debugMode&&!s$L.getProgramParameter(this._program,35714))throw s$L.getProgramInfoLog(this._program);var s$l,s$Z=0,s$h=0,s$_=0;for(s$_=s$r.isConchApp?s$L.getProgramParameterEx(this._vs,this._ps,"",35721):s$L.getProgramParameter(this._program,35721),s$Z=0;s$Z<s$_;s$Z++){var s$N=null;s$l={vartype:"attribute",ivartype:0,attrib:s$N=s$r.isConchApp?s$L.getActiveAttribEx(this._vs,this._ps,"",s$Z):s$L.getActiveAttrib(this._program,s$Z),location:s$L.getAttribLocation(this._program,s$N.name),name:s$N.name,type:s$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(s$l)}var s$m=0;for(s$m=s$r.isConchApp?s$L.getProgramParameterEx(this._vs,this._ps,"",35718):s$L.getProgramParameter(this._program,35718),s$Z=0;s$Z<s$m;s$Z++){var s$u=null;s$u=s$r.isConchApp?s$L.getActiveUniformEx(this._vs,this._ps,"",s$Z):s$L.getActiveUniform(this._program,s$Z),0<(s$l={vartype:"uniform",ivartype:1,attrib:s$N,location:s$L.getUniformLocation(this._program,s$u.name),name:s$u.name,type:s$u.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(s$l.name=s$l.name.substr(0,s$l.name.length-3),s$l.isArray=!0,s$l.location=s$L.getUniformLocation(this._program,s$l.name)),this._uniformParams.push(s$l)}for(s$Z=0,s$h=this._attributeParams.length;s$Z<s$h;s$Z++)(s$l=this._attributeParams[s$Z]).indexOfParams=s$Z,s$l.index=1,s$l.value=[s$l.location,null],s$l.codename=s$l.name,s$l.name=null!=this._attributeMap[s$l.codename]?this._attributeMap[s$l.codename]:s$l.codename,this._attributeParamsMap.push(s$l.name),this._attributeParamsMap.push(s$l),s$l._this=this,s$l.uploadedValue=[],s$l.fun=this._attribute;for(s$Z=0,s$h=this._uniformParams.length;s$Z<s$h;s$Z++)switch((s$l=this._uniformParams[s$Z]).indexOfParams=s$Z,s$l.index=1,s$l.value=[s$l.location,null],s$l.codename=s$l.name,null!=this._sceneUniformMap[s$l.codename]?(s$l.name=this._sceneUniformMap[s$l.codename],this._sceneUniformParamsMap.push(s$l.name),this._sceneUniformParamsMap.push(s$l)):null!=this._cameraUniformMap[s$l.codename]?(s$l.name=this._cameraUniformMap[s$l.codename],this._cameraUniformParamsMap.push(s$l.name),this._cameraUniformParamsMap.push(s$l)):null!=this._spriteUniformMap[s$l.codename]?(s$l.name=this._spriteUniformMap[s$l.codename],this._spriteUniformParamsMap.push(s$l.name),this._spriteUniformParamsMap.push(s$l)):null!=this._materialUniformMap[s$l.codename]?(s$l.name=this._materialUniformMap[s$l.codename],this._materialUniformParamsMap.push(s$l.name),this._materialUniformParamsMap.push(s$l)):null!=this._renderElementUniformMap[s$l.codename]?(s$l.name=this._renderElementUniformMap[s$l.codename],this._renderElementUniformParamsMap.push(s$l.name),this._renderElementUniformParamsMap.push(s$l)):console.log("Shader:can't find uinform name:"+s$l.codename+" in shader file."),s$l._this=this,s$l.uploadedValue=[],s$l.type){case 5124:s$l.fun=s$l.isArray?this._uniform1iv:this._uniform1i;break;case 5126:s$l.fun=s$l.isArray?this._uniform1fv:this._uniform1f;break;case 35664:s$l.fun=s$l.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:s$l.fun=s$l.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:s$l.fun=s$l.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:s$l.fun=this._uniform_sampler2D;break;case 35680:s$l.fun=this._uniform_samplerCube;break;case 35676:s$l.fun=this._uniformMatrix4fv;break;case 35670:s$l.fun=this._uniform1i;break;case 35674:s$l.fun=this._uinformMatrix2fv;break;case 35675:s$l.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},s$L._attribute=function(s$d,s$L){var s$l=s$F.mainContext,s$Z=s$m._enableAtributes,s$h=s$d.location;return s$Z[s$h]||s$l.enableVertexAttribArray(s$h),s$l.vertexAttribPointer(s$h,s$L[0],s$L[1],s$L[2],s$L[3],s$L[4]),s$Z[s$h]=s$m._bindVertexBuffer,1},s$L._uniform1f=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L?(s$F.mainContext.uniform1f(s$d.location,s$l[0]=s$L),1):0},s$L._uniform1fv=function(s$d,s$L){if(s$L.length<4){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$F.mainContext.uniform1fv(s$d.location,s$L),s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3],1):0}return s$F.mainContext.uniform1fv(s$d.location,s$L),1},s$L._uniform_vec2=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]?(s$F.mainContext.uniform2f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1]),1):0},s$L._uniform_vec2v=function(s$d,s$L){if(s$L.length<2){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$F.mainContext.uniform2fv(s$d.location,s$L),s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3],1):0}return s$F.mainContext.uniform2fv(s$d.location,s$L),1},s$L._uniform_vec3=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]?(s$F.mainContext.uniform3f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2]),1):0},s$L._uniform_vec3v=function(s$d,s$L){return s$F.mainContext.uniform3fv(s$d.location,s$L),1},s$L._uniform_vec4=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$F.mainContext.uniform4f(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3]),1):0},s$L._uniform_vec4v=function(s$d,s$L){return s$F.mainContext.uniform4fv(s$d.location,s$L),1},s$L._uniformMatrix2fv=function(s$d,s$L){return s$F.mainContext.uniformMatrix2fv(s$d.location,!1,s$L),1},s$L._uniformMatrix3fv=function(s$d,s$L){return s$F.mainContext.uniformMatrix3fv(s$d.location,!1,s$L),1},s$L._uniformMatrix4fv=function(s$d,s$L){return s$F.mainContext.uniformMatrix4fv(s$d.location,!1,s$L),1},s$L._uinformMatrix2fv=function(s$d,s$L){return s$F.mainContext.uniformMatrix2fv(s$d.location,!1,s$L),1},s$L._uinformMatrix3fv=function(s$d,s$L){return s$F.mainContext.uniformMatrix3fv(s$d.location,!1,s$L),1},s$L._uniform1i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L?(s$F.mainContext.uniform1i(s$d.location,s$l[0]=s$L),1):0},s$L._uniform1iv=function(s$d,s$L){return s$F.mainContext.uniform1iv(s$d.location,s$L),1},s$L._uniform_ivec2=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]?(s$F.mainContext.uniform2i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1]),1):0},s$L._uniform_ivec2v=function(s$d,s$L){return s$F.mainContext.uniform2iv(s$d.location,s$L),1},s$L._uniform_vec3i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]?(s$F.mainContext.uniform3i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2]),1):0},s$L._uniform_vec3vi=function(s$d,s$L){return s$F.mainContext.uniform3iv(s$d.location,s$L),1},s$L._uniform_vec4i=function(s$d,s$L){var s$l=s$d.uploadedValue;return s$l[0]!==s$L[0]||s$l[1]!==s$L[1]||s$l[2]!==s$L[2]||s$l[3]!==s$L[3]?(s$F.mainContext.uniform4i(s$d.location,s$l[0]=s$L[0],s$l[1]=s$L[1],s$l[2]=s$L[2],s$l[3]=s$L[3]),1):0},s$L._uniform_vec4vi=function(s$d,s$L){return s$F.mainContext.uniform4iv(s$d.location,s$L),1},s$L._uniform_sampler2D=function(s$d,s$L){var s$l=s$L.source||s$L.defaulteTexture.source,s$Z=s$F.mainContext,s$h=s$d.uploadedValue;if(null!=s$h[0])return s$Z.activeTexture(s$t._TEXTURES[s$h[0]]),s$l&&s$E.bindTexture(s$Z,3553,s$l),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return s$h[0]=this._curActTexIndex,s$Z.uniform1i(s$d.location,this._curActTexIndex),s$Z.activeTexture(s$t._TEXTURES[this._curActTexIndex]),s$l&&s$E.bindTexture(s$Z,3553,s$l),this._curActTexIndex++,1},s$L._uniform_samplerCube=function(s$d,s$L){var s$l=s$L.source||s$L.defaulteTexture.source,s$Z=s$F.mainContext,s$h=s$d.uploadedValue;if(null!=s$h[0])return s$Z.activeTexture(s$t._TEXTURES[s$h[0]]),s$l?s$E.bindTexture(s$Z,34067,s$l):s$E.bindTexture(s$Z,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return s$h[0]=this._curActTexIndex,s$Z.uniform1i(s$d.location,this._curActTexIndex),s$Z.activeTexture(s$t._TEXTURES[this._curActTexIndex]),s$l?s$E.bindTexture(s$Z,34067,s$l):s$E.bindTexture(s$Z,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},s$L._noSetValue=function(s$d){console.log("no....:"+s$d.name)},s$L.bind=function(){return s$l.activeShader=this,(s$l.bindShader=this).activeResource(),s$E.UseProgram(this._program)},s$L.uploadAttributes=function(s$d,s$L){for(var s$l,s$Z,s$h=0,s$_=0,s$N=this._attributeParamsMap.length;s$_<s$N;s$_+=2)s$Z=this._attributeParamsMap[s$_+1],null!=(s$l=s$d[this._attributeParamsMap[s$_]])&&(s$L&&s$L[s$Z.name]&&s$L[s$Z.name].bind(),s$h+=s$Z.fun.call(this,s$Z,s$l));s$O.shaderCall+=s$h},s$L.uploadAttributesX=function(s$d,s$L){for(var s$l,s$Z,s$h=0,s$_=0,s$N=this._attributeParamsMap.length;s$_<s$N;s$_+=2)s$Z=this._attributeParamsMap[s$_+1],null!=(s$l=s$d[this._attributeParamsMap[s$_]])&&(s$L._bind(),s$h+=s$Z.fun.call(this,s$Z,s$l));s$O.shaderCall+=s$h},s$L.uploadSceneUniforms=function(s$d){for(var s$L,s$l,s$Z=0,s$h=0,s$_=this._sceneUniformParamsMap.length;s$h<s$_;s$h+=2)s$l=this._sceneUniformParamsMap[s$h+1],null!=(s$L=s$d[this._sceneUniformParamsMap[s$h]])&&(s$Z+=s$l.fun.call(this,s$l,s$L));s$O.shaderCall+=s$Z},s$L.uploadCameraUniforms=function(s$d){for(var s$L,s$l,s$Z=0,s$h=0,s$_=this._cameraUniformParamsMap.length;s$h<s$_;s$h+=2)s$l=this._cameraUniformParamsMap[s$h+1],null!=(s$L=s$d[this._cameraUniformParamsMap[s$h]])&&(s$Z+=s$l.fun.call(this,s$l,s$L));s$O.shaderCall+=s$Z},s$L.uploadSpriteUniforms=function(s$d){for(var s$L,s$l,s$Z=0,s$h=0,s$_=this._spriteUniformParamsMap.length;s$h<s$_;s$h+=2)s$l=this._spriteUniformParamsMap[s$h+1],null!=(s$L=s$d[this._spriteUniformParamsMap[s$h]])&&(s$Z+=s$l.fun.call(this,s$l,s$L));s$O.shaderCall+=s$Z},s$L.uploadMaterialUniforms=function(s$d){for(var s$L,s$l,s$Z=0,s$h=0,s$_=this._materialUniformParamsMap.length;s$h<s$_;s$h+=2)s$l=this._materialUniformParamsMap[s$h+1],null!=(s$L=s$d[this._materialUniformParamsMap[s$h]])&&(s$Z+=s$l.fun.call(this,s$l,s$L));s$O.shaderCall+=s$Z},s$L.uploadRenderElementUniforms=function(s$d){for(var s$L,s$l,s$Z=0,s$h=0,s$_=this._renderElementUniformParamsMap.length;s$h<s$_;s$h+=2)s$l=this._renderElementUniformParamsMap[s$h+1],null!=(s$L=s$d[this._renderElementUniformParamsMap[s$h]])&&(s$Z+=s$l.fun.call(this,s$l,s$L));s$O.shaderCall+=s$Z},s$t.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return new s$t(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x)},s$t.addInclude=function(s$d,s$L){s$w.addInclude(s$d,s$L)},s$t._createShader=function(s$d,s$L,s$l){var s$Z=s$d.createShader(s$l);if(s$d.shaderSource(s$Z,s$L),s$d.compileShader(s$Z),s$OL.debugMode&&!s$d.getShaderParameter(s$Z,35713))throw s$d.getShaderInfoLog(s$Z);return s$Z},s$t.PERIOD_RENDERELEMENT=0,s$t.PERIOD_MATERIAL=1,s$t.PERIOD_SPRITE=2,s$t.PERIOD_CAMERA=3,s$t.PERIOD_SCENE=4,s$t._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],s$t._count=0,s$t._preCompile=!1,s$t.extCompileFunc=null,s$t.extCompileObj=null,s$b(s$t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new s$n}]),s$t}(),s$RL=function(s$m){function s$u(){this._transformUV=null,s$u.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new s$NL(.6,.6,.6)),this._setColor(10,new s$NL(1,1,1)),this._setColor(11,new s$mL(1,1,1,8)),this._setColor(12,new s$NL(1,1,1)),this._setColor(7,new s$mL(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new s$mL(1,1,0,0)),this.renderMode=1}s$Y(s$u,"laya.d3.core.material.StandardMaterial",s$m);var s$d=s$u.prototype;return s$d.disableLight=function(){this._addDisablePublicShaderDefine(s$OL.SHADERDEFINE_POINTLIGHT|s$OL.SHADERDEFINE_SPOTLIGHT|s$OL.SHADERDEFINE_DIRECTIONLIGHT)},s$d.disableFog=function(){this._addDisablePublicShaderDefine(s$OL.SHADERDEFINE_FOG)},s$d.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=s$L[0];if(s$Z.version)s$m.prototype.onAsynLoaded.call(this,s$d,s$L,s$l);else{var s$h=s$L[1],s$_=s$Z.props;for(var s$N in s$_)this[s$N]=s$_[s$N];s$u._parseStandardMaterial(s$h,this,s$Z),this._endLoaded()}},s$d.cloneTo=function(s$d){s$m.prototype.cloneTo.call(this,s$d);var s$L=s$d;this._transformUV&&(s$L._transformUV=this._transformUV.clone())},s$c(0,s$d,"ambientColor",function(){return this._getColor(9)},function(s$d){this._setColor(9,s$d)}),s$c(0,s$d,"ambientTexture",function(){return this._getTexture(5)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,s$d)}),s$c(0,s$d,"renderMode",null,function(s$d){switch(s$d){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(s$u.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(s$d)}),s$c(0,s$d,"reflectColor",function(){return this._getColor(12)},function(s$d){this._setColor(12,s$d)}),s$c(0,s$d,"tilingOffset",function(){return this._getColor(15)},function(s$d){if(s$d){var s$L=s$d.elements;1!=s$L[0]||1!=s$L[1]||0!=s$L[2]||0!=s$L[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,s$d)}),s$c(0,s$d,"albedo",function(){return this._getColor(7)},function(s$d){this._setColor(7,s$d)}),s$c(0,s$d,"diffuseColor",function(){return this._getColor(10)},function(s$d){this._setColor(10,s$d)}),s$c(0,s$d,"albedoColor",function(){return this._getColor(7)},function(s$d){this._setColor(7,s$d)}),s$c(0,s$d,"specularColor",function(){return this._getColor(11)},function(s$d){this._setColor(11,s$d)}),s$c(0,s$d,"diffuseTexture",function(){return this._getTexture(1)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,s$d)}),s$c(0,s$d,"normalTexture",function(){return this._getTexture(2)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,s$d)}),s$c(0,s$d,"specularTexture",function(){return this._getTexture(3)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,s$d)}),s$c(0,s$d,"emissiveTexture",function(){return this._getTexture(4)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,s$d)}),s$c(0,s$d,"reflectTexture",function(){return this._getTexture(6)},function(s$d){s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,s$d)}),s$c(0,s$d,"transformUV",function(){return this._transformUV},function(s$d){this._transformUV=s$d,this._setMatrix4x4(13,s$d.matrix),s$d?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,s$d.matrix.elements,0)}),s$u.__init__=function(){s$u.SHADERDEFINE_DIFFUSEMAP=s$u.shaderDefines.registerDefine("DIFFUSEMAP"),s$u.SHADERDEFINE_NORMALMAP=s$u.shaderDefines.registerDefine("NORMALMAP"),s$u.SHADERDEFINE_SPECULARMAP=s$u.shaderDefines.registerDefine("SPECULARMAP"),s$u.SHADERDEFINE_EMISSIVEMAP=s$u.shaderDefines.registerDefine("EMISSIVEMAP"),s$u.SHADERDEFINE_AMBIENTMAP=s$u.shaderDefines.registerDefine("AMBIENTMAP"),s$u.SHADERDEFINE_REFLECTMAP=s$u.shaderDefines.registerDefine("REFLECTMAP"),s$u.SHADERDEFINE_UVTRANSFORM=s$u.shaderDefines.registerDefine("UVTRANSFORM"),s$u.SHADERDEFINE_TILINGOFFSET=s$u.shaderDefines.registerDefine("TILINGOFFSET"),s$u.SHADERDEFINE_ADDTIVEFOG=s$u.shaderDefines.registerDefine("ADDTIVEFOG")},s$u.load=function(s$d){return s$A.loader.create(s$d,null,null,s$u)},s$u._parseStandardMaterial=function(s$d,s$L,s$l){var s$Z=s$l.customProps,s$h=s$Z.ambientColor;s$L.ambientColor=new s$NL(s$h[0],s$h[1],s$h[2]);var s$_=s$Z.diffuseColor;s$L.diffuseColor=new s$NL(s$_[0],s$_[1],s$_[2]);var s$N=s$Z.specularColor;s$L.specularColor=new s$mL(s$N[0],s$N[1],s$N[2],s$N[3]);var s$m=s$Z.reflectColor;s$L.reflectColor=new s$NL(s$m[0],s$m[1],s$m[2]);var s$u=s$Z.albedoColor;s$u&&(s$L.albedo=new s$mL(s$u[0],s$u[1],s$u[2],s$u[3]));var s$x=s$Z.diffuseTexture.texture2D;s$x&&(s$L.diffuseTexture=s$k.getRes(s$d[s$x]));var s$t=s$Z.normalTexture.texture2D;s$t&&(s$L.normalTexture=s$k.getRes(s$d[s$t]));var s$b=s$Z.specularTexture.texture2D;s$b&&(s$L.specularTexture=s$k.getRes(s$d[s$b]));var s$q=s$Z.emissiveTexture.texture2D;s$q&&(s$L.emissiveTexture=s$k.getRes(s$d[s$q]));var s$Y=s$Z.ambientTexture.texture2D;s$Y&&(s$L.ambientTexture=s$k.getRes(s$d[s$Y]));var s$c=s$Z.reflectTexture.texture2D;s$c&&(s$L.reflectTexture=s$k.getRes(s$d[s$c]))},s$u.RENDERMODE_OPAQUE=1,s$u.RENDERMODE_OPAQUEDOUBLEFACE=2,s$u.RENDERMODE_CUTOUT=3,s$u.RENDERMODE_CUTOUTDOUBLEFACE=4,s$u.RENDERMODE_TRANSPARENT=13,s$u.RENDERMODE_TRANSPARENTDOUBLEFACE=14,s$u.RENDERMODE_ADDTIVE=15,s$u.RENDERMODE_ADDTIVEDOUBLEFACE=16,s$u.RENDERMODE_DEPTHREAD_TRANSPARENT=5,s$u.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,s$u.RENDERMODE_DEPTHREAD_ADDTIVE=7,s$u.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,s$u.RENDERMODE_NONDEPTH_TRANSPARENT=9,s$u.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,s$u.RENDERMODE_NONDEPTH_ADDTIVE=11,s$u.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,s$u.SHADERDEFINE_DIFFUSEMAP=0,s$u.SHADERDEFINE_NORMALMAP=0,s$u.SHADERDEFINE_SPECULARMAP=0,s$u.SHADERDEFINE_EMISSIVEMAP=0,s$u.SHADERDEFINE_AMBIENTMAP=0,s$u.SHADERDEFINE_REFLECTMAP=0,s$u.SHADERDEFINE_UVTRANSFORM=0,s$u.SHADERDEFINE_TILINGOFFSET=0,s$u.SHADERDEFINE_ADDTIVEFOG=0,s$u.DIFFUSETEXTURE=1,s$u.NORMALTEXTURE=2,s$u.SPECULARTEXTURE=3,s$u.EMISSIVETEXTURE=4,s$u.AMBIENTTEXTURE=5,s$u.REFLECTTEXTURE=6,s$u.ALBEDO=7,s$u.UVANIAGE=8,s$u.MATERIALAMBIENT=9,s$u.MATERIALDIFFUSE=10,s$u.MATERIALSPECULAR=11,s$u.MATERIALREFLECT=12,s$u.UVMATRIX=13,s$u.UVAGE=14,s$u.TILINGOFFSET=15,s$b(s$u,["defaultMaterial",function(){var s$d=new s$u;return s$d.lock=!0,this.defaultMaterial=s$d},"shaderDefines",function(){return this.shaderDefines=new s$tL(s$gL.shaderDefines)}]),s$u}(s$gL),s$oL=function(s$d){function s$N(s$d,s$L,s$l,s$Z,s$h){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===s$l&&(s$l=35044),void 0===s$Z&&(s$Z=!1),s$N.__super.call(this),this._indexType=s$d,this._indexCount=s$L,this._bufferUsage=s$l,this._bufferType=34963,this._canRead=s$Z;var s$_;if("ushort"==s$d)this._indexTypeByteCount=2;else{if("ubyte"!=s$d)throw new Error("unidentification index type.");this._indexTypeByteCount=1}s$_=this._indexTypeByteCount*s$L,this._byteLength=s$_,this._bind(),s$m._gl.bufferData(this._bufferType,s$_,this._bufferUsage),this.uri=s$h,s$Z?("ushort"==s$d?this._buffer=new Uint16Array(s$L):"ubyte"==s$d&&(this._buffer=new Uint8Array(s$L)),this.memorySize=2*s$_):this.memorySize=s$_}s$Y(s$N,"laya.d3.graphics.IndexBuffer3D",s$d);var s$L=s$N.prototype;return s$L.setData=function(s$d,s$L,s$l,s$Z){void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=4294967295);var s$h=0;if("ushort"==this._indexType?(s$h=2,0===s$l&&4294967295===s$Z||(s$d=new Uint16Array(s$d.buffer,s$l*s$h,s$Z))):"ubyte"==this._indexType&&(s$h=1,0===s$l&&4294967295===s$Z||(s$d=new Uint8Array(s$d.buffer,s$l*s$h,s$Z))),this._bind(),s$m._gl.bufferSubData(this._bufferType,s$L*s$h,s$d),this._canRead)if(0!==s$L||0!==s$l||4294967295!==s$Z){var s$_=this._buffer.length-s$L;s$_<s$Z&&(s$Z=s$_);for(var s$N=0;s$N<s$Z;s$N++)this._buffer[s$L+s$N]=s$d[s$N]}else this._buffer=s$d},s$L.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},s$L.disposeResource=function(){s$d.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},s$c(0,s$L,"indexType",function(){return this._indexType}),s$c(0,s$L,"indexTypeByteCount",function(){return this._indexTypeByteCount}),s$c(0,s$L,"indexCount",function(){return this._indexCount}),s$c(0,s$L,"canRead",function(){return this._canRead}),s$N.INDEXTYPE_UBYTE="ubyte",s$N.INDEXTYPE_USHORT="ushort",s$N.create=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$l&&(s$l=35044),void 0===s$Z&&(s$Z=!1),new s$N(s$d,s$L,s$l,s$Z,s$h)},s$N}(s$m),s$iL=function(s$_){function s$N(s$d,s$L,s$l,s$Z,s$h){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===s$Z&&(s$Z=!1),s$N.__super.call(this),this._vertexDeclaration=s$d,this._vertexCount=s$L,this._bufferUsage=s$l,this._bufferType=34962,this._canRead=s$Z,this.uri=s$h,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*s$L,this._bind(),s$m._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),s$Z&&(this._buffer=new Float32Array(this._byteLength/4))}s$Y(s$N,"laya.d3.graphics.VertexBuffer3D",s$_);var s$d=s$N.prototype;return s$d.bindWithIndexBuffer=function(s$d){s$d&&s$d._bind(),this._bind()},s$d.setData=function(s$d,s$L,s$l,s$Z){if(void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=4294967295),0===s$l&&4294967295===s$Z||(s$d=new Float32Array(s$d.buffer,4*s$l,s$Z)),this._bind(),s$m._gl.bufferSubData(this._bufferType,4*s$L,s$d),this._canRead)if(0!==s$L||0!==s$l||4294967295!==s$Z){var s$h=this._buffer.length-s$L;s$h<s$Z&&(s$Z=s$h);for(var s$_=0;s$_<s$Z;s$_++)this._buffer[s$L+s$_]=s$d[s$_]}else this._buffer=s$d},s$d.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},s$d.disposeResource=function(){for(var s$d=s$F.mainContext,s$L=this._vertexDeclaration.getVertexElements(),s$l=s$m._enableAtributes,s$Z=0,s$h=s$L.length;s$Z<s$h;s$Z++)s$l[s$Z]===this._glBuffer&&(s$d.disableVertexAttribArray(s$Z),s$l[s$Z]=null);s$_.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},s$c(0,s$d,"vertexDeclaration",function(){return this._vertexDeclaration}),s$c(0,s$d,"vertexCount",function(){return this._vertexCount}),s$c(0,s$d,"canRead",function(){return this._canRead}),s$N.create=function(s$d,s$L,s$l,s$Z,s$h){return void 0===s$l&&(s$l=35044),void 0===s$Z&&(s$Z=!1),new s$N(s$d,s$L,s$l,s$Z,s$h)},s$N}(s$m),s$SL=function(s$d){function s$w(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,s$w.__super.call(this),this._type=3553}s$Y(s$w,"laya.d3.resource.DataTexture2D",s$FL);var s$L=s$w.prototype;return s$L.genDebugMipmaps=function(){var s$d=[];return s$d.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),s$d.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),s$d.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),s$d.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),s$d.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),s$d.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),s$d.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),s$d.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),s$d.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),s$d.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),s$d},s$L._onTextureLoaded=function(s$d){},s$L._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var s$d=s$F.mainContext,s$L=this._source=s$d.createTexture(),s$l=this._width,s$Z=this._height,s$h=s$E.curBindTexTarget,s$_=s$E.curBindTexValue,s$N=!1;if(s$E.bindTexture(s$d,this._type,s$L),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var s$m=0;s$d.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var s$u=0;s$u<this._mipmaps.length;s$u++){if(this._mipmaps[s$u].byteLength!=s$x*s$t*4)throw"mipmap size error  level:"+s$u;s$d.texSubImage2D(this._type,0,s$w.simLodRect[s$m++],s$w.simLodRect[s$m++],s$w.simLodRect[s$m++],s$w.simLodRect[s$m++],6408,5121,new Uint8Array(this._mipmaps[s$u]))}this.minFifter=9729,this.magFifter=9729}else{var s$x=this._width,s$t=this._height;for(s$m=0,s$d.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),s$u=0;s$u<this._mipmaps.length;s$u++){if(this._mipmaps[s$u].byteLength!=s$x*s$t*4)throw"mipmap size error  level:"+s$u;s$d.texImage2D(this._type,s$u,6408,s$x,s$t,0,6408,5121,new Uint8Array(this._mipmaps[s$u])),(s$x/=2)<1&&(s$x=1),(s$t/=2)<1&&(s$t=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&s$d.pixelStorei(s$d.UNPACK_ALIGNMENT,1),s$d.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var s$b=0,s$q=!1,s$Y=!1;this._buffer.byteLength==4*s$l*s$Z?(s$b=6408,s$q=!0):this._buffer.byteLength==3*s$l*s$Z?(s$b=6407,s$Y=!0):s$b=this._format,s$q||s$Y?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),s$Y&&s$d.pixelStorei(s$d.UNPACK_ALIGNMENT,1),s$d.texImage2D(this._type,0,s$b,s$l,s$Z,0,s$b,5121,this._buffer)):s$d&&s$b==s$d.ALPHA?(s$d.texImage2D(3553,0,s$b,s$l,s$Z,0,s$b,s$d.UNSIGNED_BYTE,this._buffer),s$N=!0):0!=s$b&&(s$d.compressedTexImage2D(3553,0,s$b,s$l,s$Z,0,this._buffer),s$N=!0)}var s$c=this._minFifter,s$r=this._magFifter,s$a=0==this._wrapModeU?10497:33071,s$k=0==this._wrapModeV?10497:33071,s$e=s$s.isPOT(s$l,s$Z);s$e?(this._mipmap||this._mipmaps?-1!==s$c||(s$c=9987):-1!==s$c||(s$c=9729),-1!==s$r||(s$r=9729),s$d.texParameteri(this._type,10241,s$c),s$d.texParameteri(this._type,10240,s$r),s$d.texParameteri(this._type,10242,s$a),s$d.texParameteri(this._type,10243,s$k),this._mipmap&&s$d.generateMipmap(this._type)):(-1!==s$c||(s$c=9729),-1!==s$r||(s$r=9729),s$d.texParameteri(this._type,10241,s$c),s$d.texParameteri(this._type,10240,s$r),s$d.texParameteri(this._type,10242,33071),s$d.texParameteri(this._type,10243,33071)),s$h&&s$_&&s$E.bindTexture(s$d,s$h,s$_),this.memorySize=s$N?this._buffer.length:s$e?s$l*s$Z*4*(1+1/3):s$l*s$Z*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},s$L.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},s$L.onAsynLoaded=function(s$d,s$L,s$l){var s$Z;s$l&&(s$Z=s$l[0].call(this,s$L)),s$Z&&(this._width=s$Z.width,this._height=s$Z.height,this._buffer=s$Z.data),this._src=s$d,this._size=new s$rL(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},s$L.getPixels=function(){return new Uint8Array(this._buffer)},s$L.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(s$F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},s$c(0,s$L,"src",function(){return this._src}),s$w.create=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){if(void 0===s$Z&&(s$Z=9729),void 0===s$h&&(s$h=9729),void 0===s$_&&(s$_=!0),!s$d||s$d.byteLength<s$L*s$l*4)throw"DataTexture2D create error";var s$m=new s$w;return s$m.uri=s$N,s$m._buffer=s$d,s$m._width=s$L,s$m._height=s$l,s$m._mipmap=s$_,s$m._magFifter=s$Z,s$m._minFifter=s$h,s$m._size=new s$rL(s$m._width,s$m._height),s$m._conchTexture?alert("怎么给runtime传递datatexture数据"):s$m.activeResource(),s$m},s$w.load=function(s$d,s$L,s$l,s$Z,s$h){if(void 0===s$L&&(s$L=0),void 0===s$l&&(s$l=0),void 0===s$Z&&(s$Z=9729),void 0===s$h&&(s$h=9729),"mipmaps"===s$V.getFileExtension(s$d)){var s$_=s$A.loader.create(s$d,null,null,s$w,[function(s$d){this._mipmaps=[];var s$L=new Uint32Array(s$d);this._width=s$L[0];var s$l=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,s$l=1024),this._width!=s$l)throw"现在只支持512x256的环境贴图。当前的是"+s$L[0];this._height=s$L[1];for(var s$Z=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,s$h=this._height,s$_=8;;){var s$N=s$Z*s$h*4;if(s$_+s$N>s$d.byteLength)throw"load mipmaps data size error ";var s$m=new Uint8Array(s$d,s$_,s$N);if(this._mipmaps.push(s$m),s$_+=s$N,1==s$Z&&1==s$h)break;(s$Z/=2)<1&&(s$Z=1),(s$h/=2)<1&&(s$h=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){s$_.simLodInfo=new Float32Array(40);for(var s$N=0;s$N<s$_.simLodInfo.length;)s$_.simLodInfo[s$N]=(s$w.simLodRect[s$N]+.5)/1024,s$N++,s$_.simLodInfo[s$N]=(s$w.simLodRect[s$N]+.5)/256,s$N++,s$_.simLodInfo[s$N]=Math.max(s$w.simLodRect[s$N]-1,.1)/1024,s$N++,s$_.simLodInfo[s$N]=Math.max(s$w.simLodRect[s$N]-1.5,.1)/256,s$N++}return s$_}if("number"==typeof s$L)return s$A.loader.create(s$d,null,null,s$w,[function(s$d){return this._width=s$L,this._height=s$l,this._buffer=s$d,null}]);if("function"==typeof s$L)return s$A.loader.create(s$d,null,null,s$w,[s$L]);throw new Error("unknown params.")},s$w.lodasatlas=!1,s$b(s$w,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),s$w}(),s$BL=function(s$d){function s$L(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,s$L.__super.call(this)}s$Y(s$L,"laya.d3.resource.models.PrimitiveMesh",s$EL);var s$l=s$L.prototype;return s$A.imps(s$l,{"laya.d3.core.render.IRenderable":!0}),s$l._getVertexBuffer=function(s$d){return void 0===s$d&&(s$d=0),0===s$d?this._vertexBuffer:null},s$l._getVertexBuffers=function(){return null},s$l._getIndexBuffer=function(){return this._indexBuffer},s$l._getPositions=function(){var s$d,s$L=[],s$l=this._vertexBuffer.vertexDeclaration.getVertexElements(),s$Z=0;for(s$Z=0;s$Z<s$l.length;s$Z++){var s$h=s$l[s$Z];if("vector3"===s$h.elementFormat&&0===s$h.elementUsage){s$d=s$h;break}}var s$_=this._vertexBuffer.getData();for(s$Z=0;s$Z<s$_.length;s$Z+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var s$N=s$Z+s$d.offset/4,s$m=new s$NL(s$_[s$N+0],s$_[s$N+1],s$_[s$N+2]);s$L.push(s$m)}return s$L},s$l.getRenderElement=function(s$d){return this},s$l.getRenderElementsCount=function(){return 1},s$l.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},s$l._beforeRender=function(s$d){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},s$l._render=function(s$d){s$F.mainContext.drawElements(4,this._numberIndices,5123,0),s$O.drawCall++,s$O.trianglesFaces+=this._numberIndices/3},s$c(0,s$l,"_vertexBufferCount",function(){return 1}),s$c(0,s$l,"triangleCount",function(){return this._indexBuffer.indexCount/3}),s$L}(),s$CL=function(s$d){function s$L(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,s$L.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}s$Y(s$L,"laya.d3.resource.models.Mesh",s$EL);var s$l=s$L.prototype;return s$l._getPositions=function(){var s$d,s$L,s$l,s$Z,s$h,s$_=[],s$N=0,s$m=0,s$u=0;if(0!==this._vertexBuffers.length){var s$x=this._vertexBuffers.length;for(s$N=0;s$N<s$x;s$N++){for(s$l=(s$d=this._vertexBuffers[s$N]).vertexDeclaration.getVertexElements(),s$m=0;s$m<s$l.length;s$m++)if("vector3"===(s$Z=s$l[s$m]).elementFormat&&0===s$Z.elementUsage){s$L=s$Z;break}for(s$h=s$d.getData(),s$m=0;s$m<s$h.length;s$m+=s$d.vertexDeclaration.vertexStride/4)s$u=s$m+s$L.offset/4,s$_.push(new s$NL(s$h[s$u+0],s$h[s$u+1],s$h[s$u+2]))}}else{var s$t=this._subMeshes.length;for(s$N=0;s$N<s$t;s$N++){for(s$l=(s$d=this._subMeshes[s$N]._getVertexBuffer()).vertexDeclaration.getVertexElements(),s$m=0;s$m<s$l.length;s$m++)if("vector3"===(s$Z=s$l[s$m]).elementFormat&&0===s$Z.elementUsage){s$L=s$Z;break}for(s$h=s$d.getData(),s$m=0;s$m<s$h.length;s$m+=s$d.vertexDeclaration.vertexStride/4)s$u=s$m+s$L.offset/4,s$_.push(new s$NL(s$h[s$u+0],s$h[s$u+1],s$h[s$u+2]))}}return s$_},s$l._setSubMeshes=function(s$d){this._subMeshes=s$d,this._subMeshCount=s$d.length;for(var s$L=0;s$L<this._subMeshCount;s$L++)s$d[s$L]._indexInMesh=s$L;this._positions=this._getPositions(),this._generateBoundingObject()},s$l.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=s$L[0],s$h=s$L[1];s$vd.read(s$Z,this,this._materials,this._subMeshes,s$h),this.completeCreate(),this._endLoaded()},s$l.getSubMesh=function(s$d){return this._subMeshes[s$d]},s$l.getSubMeshCount=function(){return this._subMeshes.length},s$l.getRenderElementsCount=function(){return this._subMeshes.length},s$l.getRenderElement=function(s$d){return this._subMeshes[s$d]},s$l.disposeResource=function(){for(var s$d=0;s$d<this._subMeshes.length;s$d++)this._subMeshes[s$d].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},s$c(0,s$l,"materials",function(){return this._materials.slice()}),s$c(0,s$l,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),s$L.load=function(s$d){return s$A.loader.create(s$d,null,null,s$L)},s$L}(),s$PL=(function(s$d){function s$x(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=5121),void 0===s$h&&(s$h=33189),void 0===s$_&&(s$_=!1),void 0===s$N&&(s$N=!1),void 0===s$m&&(s$m=-1),void 0===s$u&&(s$u=-1),s$x.__super.call(this),this._type=3553,this._width=s$d,this._height=s$L,this._size=new s$rL(s$d,s$L),this._surfaceFormat=s$l,this._surfaceType=s$Z,this._depthStencilFormat=s$h,s$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=s$_,this._repeat=s$N,this._minFifter=s$m,this._magFifter=s$u,this.activeResource(),this._alreadyResolved=!0}s$Y(s$x,"laya.d3.resource.RenderTexture",s$FL);var s$L=s$x.prototype;s$L.recreateResource=function(){var s$d=s$F.mainContext;this._frameBuffer=s$d.createFramebuffer(),this._source=s$d.createTexture();var s$L=s$E.curBindTexTarget,s$l=s$E.curBindTexValue;s$E.bindTexture(s$d,this._type,this._source),s$d.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var s$Z=this._minFifter,s$h=this._magFifter,s$_=this._repeat?10497:33071;if(s$s.isPOT(this._width,this._height)?(this._mipmap?-1!==s$Z||(s$Z=9987):-1!==s$Z||(s$Z=9729),-1!==s$h||(s$h=9729),s$d.texParameteri(this._type,10241,s$Z),s$d.texParameteri(this._type,10240,s$h),s$d.texParameteri(this._type,10242,s$_),s$d.texParameteri(this._type,10243,s$_),this._mipmap&&s$d.generateMipmap(this._type)):(-1!==s$Z||(s$Z=9729),-1!==s$h||(s$h=9729),s$d.texParameteri(this._type,10241,s$Z),s$d.texParameteri(this._type,10240,s$h),s$d.texParameteri(this._type,10242,33071),s$d.texParameteri(this._type,10243,33071)),s$L&&s$l&&s$E.bindTexture(s$d,s$L,s$l),s$d.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=s$d.createRenderbuffer(),s$d.bindRenderbuffer(36161,this._depthStencilBuffer),s$d.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),s$d.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:s$d.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:s$d.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:s$d.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}s$d.framebufferTexture2D(36160,36064,3553,this._source,0),s$d.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},s$L.start=function(){s$F.mainContext.bindFramebuffer(36160,this.frameBuffer),(s$x._currentRenderTarget=this)._alreadyResolved=!1},s$L.end=function(){s$F.mainContext.bindFramebuffer(36160,null),s$x._currentRenderTarget=null,this._alreadyResolved=!0},s$L.getData=function(s$d,s$L,s$l,s$Z){var s$h=s$F.mainContext;if(s$h.bindFramebuffer(36160,this._frameBuffer),!(36053===s$h.checkFramebufferStatus(36160)))return s$h.bindFramebuffer(36160,null),null;var s$_=new Uint8Array(this._width*this._height*4);return s$h.readPixels(s$d,s$L,s$l,s$Z,this._surfaceFormat,this._surfaceType,s$_),s$h.bindFramebuffer(36160,null),s$_},s$L.disposeResource=function(){if(this._frameBuffer){var s$d=s$F.mainContext;s$d.deleteTexture(this._source),s$d.deleteFramebuffer(this._frameBuffer),s$d.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},s$c(0,s$L,"surfaceFormat",function(){return this._surfaceFormat}),s$c(0,s$L,"surfaceType",function(){return this._surfaceType}),s$c(0,s$L,"depthStencilFormat",function(){return this._depthStencilFormat}),s$c(0,s$L,"source",function(){return this._alreadyResolved?s$A.superGet(s$FL,this,"source"):null}),s$c(0,s$L,"depthStencilBuffer",function(){return this._depthStencilBuffer}),s$c(0,s$L,"frameBuffer",function(){return this._frameBuffer}),s$x._currentRenderTarget=null}(),function(s$d){function s$L(s$d){this._color=null,this._pixels=null,s$L.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new s$rL(this.width,this.height),this._color=s$d,this._pixels=new Uint8Array([255*s$d.x,255*s$d.y,255*s$d.z,255*s$d.w]),this.uri="SolidColorTexture2D_"+this.id}s$Y(s$L,"laya.d3.resource.SolidColorTexture2D",s$FL);var s$l=s$L.prototype;return s$l._createWebGlTexture=function(){var s$d=s$F.mainContext,s$L=this._source=s$d.createTexture(),s$l=this._width,s$Z=this._height,s$h=s$E.curBindTexTarget,s$_=s$E.curBindTexValue;s$E.bindTexture(s$d,this._type,s$L),s$d.texImage2D(this._type,0,6408,s$l,s$Z,0,6408,5121,this._pixels);var s$N=this._minFifter,s$m=this._magFifter,s$u=this._repeat?10497:33071,s$x=s$s.isPOT(s$l,s$Z);s$x?(this._mipmap?-1!==s$N||(s$N=9987):-1!==s$N||(s$N=9729),-1!==s$m||(s$m=9729),s$d.texParameteri(this._type,10241,s$N),s$d.texParameteri(this._type,10240,s$m),s$d.texParameteri(this._type,10242,s$u),s$d.texParameteri(this._type,10243,s$u),this._mipmap&&s$d.generateMipmap(this._type)):(-1!==s$N||(s$N=9729),-1!==s$m||(s$m=9729),s$d.texParameteri(this._type,10241,s$N),s$d.texParameteri(this._type,10240,s$m),s$d.texParameteri(this._type,10242,33071),s$d.texParameteri(this._type,10243,33071)),s$h&&s$_&&s$E.bindTexture(s$d,s$h,s$_),this.memorySize=s$x?s$l*s$Z*4*(1+1/3):s$l*s$Z*4},s$l.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},s$l.disposeResource=function(){this._source&&(s$F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},s$b(s$L,["magentaTexture",function(){var s$d=new s$L(new s$mL(1,0,1,1));return s$d.lock=!0,this.magentaTexture=s$d},"grayTexture",function(){var s$d=new s$L(new s$mL(.5,.5,.5,1));return s$d.lock=!0,this.grayTexture=s$d}]),s$L}()),s$TL=function(s$d){function s$h(s$d,s$L,s$l,s$Z){this._canRead=!1,this._image=null,this._pixels=null,void 0===s$d&&(s$d=!1),void 0===s$L&&(s$L=!0),void 0===s$l&&(s$l=6408),void 0===s$Z&&(s$Z=!0),s$h.__super.call(this),this._type=3553,this._repeat=s$L,this._canRead=s$d,this._format=s$l,this._mipmap=s$Z}s$Y(s$h,"laya.d3.resource.Texture2D",s$FL);var s$L=s$h.prototype;return s$L._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var s$d=s$F.mainContext,s$L=this._source=s$d.createTexture(),s$l=this._width,s$Z=this._height,s$h=s$E.curBindTexTarget,s$_=s$E.curBindTexValue;switch(s$E.bindTexture(s$d,this._type,s$L),this._format){case 6407:case 6408:this._canRead?s$d.texImage2D(this._type,0,this._format,s$l,s$Z,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?s$d.texImage2D(this._type,0,this._image._format,s$l,s$Z,0,this._image._format,5121,this._image.atlasSource):s$d.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case s$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:s$d.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var s$N=this._minFifter,s$m=this._magFifter,s$u=this._repeat?10497:33071,s$x=0==this._wrapModeU?10497:33071,s$t=0==this._wrapModeV?10497:33071,s$b=s$s.isPOT(s$l,s$Z);s$b?(this._mipmap?-1!==s$N||(s$N=9987):-1!==s$N||(s$N=9729),-1!==s$m||(s$m=9729),s$d.texParameteri(this._type,10241,s$N),s$d.texParameteri(this._type,10240,s$m),s$d.texParameteri(this._type,10242,s$u),s$d.texParameteri(this._type,10243,s$u),s$d.texParameteri(this._type,10242,s$x),s$d.texParameteri(this._type,10243,s$t),this._mipmap&&s$d.generateMipmap(this._type)):(-1!==s$N||(s$N=9729),-1!==s$m||(s$m=9729),s$d.texParameteri(this._type,10241,s$N),s$d.texParameteri(this._type,10240,s$m),s$d.texParameteri(this._type,10242,33071),s$d.texParameteri(this._type,10243,33071)),s$h&&s$_&&s$E.bindTexture(s$d,s$h,s$_),this._image.onload=null,this._image=null,this.memorySize=s$b?s$l*s$Z*4*(1+1/3):s$l*s$Z*4},s$L.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},s$L.onAsynLoaded=function(s$d,s$L,s$l){if(s$l){var s$Z=s$l[0];void 0!==s$Z&&(this._canRead=s$Z);var s$h=s$l[1];void 0!==s$h&&(this._repeat=s$h);var s$_=s$l[2];void 0!==s$_&&(this._format=s$_);var s$N=s$l[3];void 0!==s$N&&(this._mipmap=s$N);var s$m=s$l.wrapModeU;void 0!==s$m&&(this._wrapModeU=s$m);var s$u=s$l.wrapModeV;void 0!==s$u&&(this._wrapModeV=s$u)}switch(this._format){case 6407:case 6408:var s$x=(this._image=s$L).width,s$t=s$L.height;this._width=s$x,this._height=s$t,this._size=new s$rL(s$x,s$t),this._canRead&&(s$r.isConchApp?s$L instanceof s$q.HTMLElement&&(this._pixels=new Uint8Array(s$L.getImageData(0,0,s$x,s$t))):(s$I.canvas.size(s$x,s$t),s$I.canvas.clear(),s$I.context.drawImage(s$L,0,0,s$x,s$t),this._pixels=new Uint8Array(s$I.context.getImageData(0,0,s$x,s$t).data.buffer)));break;case s$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var s$b=new s$y(s$L);s$b.readUTFBytes(4),s$b.readUTFBytes(2),s$b.getInt16();s$b.endian="bigEndian",this._width=s$b.getInt16(),this._height=s$b.getInt16(),this._size=new s$rL(this._width,this._height);s$b.getInt16(),s$b.getInt16();this._image=new Uint8Array(s$L,s$b.pos)}this.recreateResource(),this._endLoaded()},s$L.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},s$L.disposeResource=function(){this._source&&(s$F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},s$c(0,s$L,"_src",function(){return this.url}),s$c(0,s$L,"src",function(){return this.url}),s$h.load=function(s$d){return s$A.loader.create(s$d,null,null,s$h)},s$h}(),s$zL=function(s$L){function s$l(s$d,s$L){s$l.__super.call(this),void 0===s$d&&(s$d=.3),void 0===s$L&&(s$L=1e3),this._tempVector3=new s$NL,this._position=new s$NL,this._up=new s$NL,this._forward=new s$NL,this._right=new s$NL,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=s$rL.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=s$d,this._farPlane=s$L,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),s$A.stage.on("resize",this,this._onScreenSizeChanged)}s$Y(s$l,"laya.d3.core.BaseCamera",s$L);var s$d=s$l.prototype;return s$d._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var s$d=this.scene._cameraPool,s$L=s$d.length-1,s$l=0;s$l<s$L;s$l++)if(s$d[s$l].renderingOrder>s$d[s$L].renderingOrder){var s$Z=s$d[s$l];s$d[s$l]=s$d[s$L],s$d[s$L]=s$Z}},s$d._calculateProjectionMatrix=function(){},s$d._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},s$d._prepareCameraToRender=function(){s$p._currentCameraCullingMask=this.cullingMask;var s$d=this._shaderValues;s$d.setValue(0,this.transform.position.elements),s$d.setValue(5,this.forward.elements),s$d.setValue(6,this.up.elements)},s$d._prepareCameraViewProject=function(s$d,s$L){var s$l=this._shaderValues;s$l.setValue(1,s$d.elements),s$l.setValue(2,s$L.elements)},s$d._renderCamera=function(s$d,s$L,s$l){},s$d.addLayer=function(s$d){29!==s$d.number&&30!=s$d.number&&(this.cullingMask=this.cullingMask|s$d.mask)},s$d.removeLayer=function(s$d){29!==s$d.number&&30!=s$d.number&&(this.cullingMask=this.cullingMask&~s$d.mask)},s$d.addAllLayers=function(){this.cullingMask=2147483647},s$d.removeAllLayers=function(){this.cullingMask=0|s$p.getLayerByNumber(29).mask|s$p.getLayerByNumber(30).mask},s$d.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},s$d.moveForward=function(s$d){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=s$d,this.transform.translate(this._tempVector3)},s$d.moveRight=function(s$d){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=s$d,this.transform.translate(this._tempVector3)},s$d.moveVertical=function(s$d){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=s$d,this.transform.translate(this._tempVector3,!1)},s$d._addSelfRenderObjects=function(){var s$d=this.scene._cameraPool,s$L=s$d.length;if(0<s$L){for(var s$l=s$L-1;0<=s$l;s$l--)if(this.renderingOrder<=s$d[s$l].renderingOrder){s$d.splice(s$l+1,0,this);break}}else s$d.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},s$d._clearSelfRenderObjects=function(){var s$d=this.scene._cameraPool;s$d.splice(s$d.indexOf(this),1)},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,s$A.stage.off("resize",this,this._onScreenSizeChanged),s$L.prototype.destroy.call(this,s$d)},s$c(0,s$d,"sky",function(){return this._sky},function(s$d){(this._sky=s$d)._ownerCamera=this}),s$c(0,s$d,"forward",function(){var s$d=this.transform.worldMatrix.elements,s$L=this._forward.elements;return s$L[0]=-s$d[8],s$L[1]=-s$d[9],s$L[2]=-s$d[10],this._forward}),s$c(0,s$d,"position",function(){var s$d=this.transform.worldMatrix.elements,s$L=this._position.elements;return s$L[0]=s$d[12],s$L[1]=s$d[13],s$L[2]=s$d[14],this._position}),s$c(0,s$d,"renderTarget",function(){return this._renderTarget},function(s$d){null!=(this._renderTarget=s$d)&&(this._renderTargetSize=s$d.size)}),s$c(0,s$d,"up",function(){var s$d=this.transform.worldMatrix.elements,s$L=this._up.elements;return s$L[0]=s$d[4],s$L[1]=s$d[5],s$L[2]=s$d[6],this._up}),s$c(0,s$d,"right",function(){var s$d=this.transform.worldMatrix.elements,s$L=this._right.elements;return s$L[0]=s$d[0],s$L[1]=s$d[1],s$L[2]=s$d[2],this._right}),s$c(0,s$d,"renderTargetSize",function(){return this._renderTargetSize},function(s$d){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"fieldOfView",function(){return this._fieldOfView},function(s$d){this._fieldOfView=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"nearPlane",function(){return this._nearPlane},function(s$d){this._nearPlane=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"farPlane",function(){return this._farPlane},function(s$d){this._farPlane=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"orthographic",function(){return this._orthographic},function(s$d){this._orthographic=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(s$d){this._orthographicVerticalSize=s$d,this._calculateProjectionMatrix()}),s$c(0,s$d,"renderingOrder",function(){return this._renderingOrder},function(s$d){this._renderingOrder=s$d,this._sortCamerasByRenderingOrder()}),s$l.CAMERAPOS=0,s$l.VIEWMATRIX=1,s$l.PROJECTMATRIX=2,s$l.VPMATRIX=3,s$l.VPMATRIX_NO_TRANSLATE=4,s$l.CAMERADIRECTION=5,s$l.CAMERAUP=6,s$l.ENVIRONMENTDIFFUSE=7,s$l.ENVIRONMENTSPECULAR=8,s$l.SIMLODINFO=9,s$l.DIFFUSEIRRADMATR=10,s$l.DIFFUSEIRRADMATG=11,s$l.DIFFUSEIRRADMATB=12,s$l.HDREXPOSURE=13,s$l.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",s$l.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",s$l.CLEARFLAG_SOLIDCOLOR=0,s$l.CLEARFLAG_SKY=1,s$l.CLEARFLAG_DEPTHONLY=2,s$l.CLEARFLAG_NONE=3,s$b(s$l,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new s$dL(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new s$dL},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new s$dL}]),s$l}(s$XL),s$DL=function(s$l){function s$L(s$d){this._render=null,this._geometryFilter=null,s$L.__super.call(this,s$d)}s$Y(s$L,"laya.d3.core.RenderableSprite3D",s$l);var s$d=s$L.prototype;return s$d._addToInitStaticBatchManager=function(){},s$d._setBelongScene=function(s$d){s$l.prototype._setBelongScene.call(this,s$d),s$d._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},s$d._setUnBelongScene=function(){var s$d=this._scene._renderableSprite3Ds,s$L=s$d.indexOf(this);s$d.splice(s$L,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),s$l.prototype._setUnBelongScene.call(this)},s$d._update=function(s$d){(s$d.owner=this)._activeInHierarchy&&(this._updateComponents(s$d),this._render._updateOctreeNode(),this._lateUpdateComponents(s$d),s$O.spriteCount++,this._childs.length&&this._updateChilds(s$d))},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$l.prototype.destroy.call(this,s$d),this._render._destroy(),this._render=null},s$L.__init__=function(){s$L.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=s$L.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),s$L.SAHDERDEFINE_LIGHTMAP=s$L.shaderDefines.registerDefine("LIGHTMAP")},s$L.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,s$L.SAHDERDEFINE_LIGHTMAP=4,s$L.LIGHTMAPSCALEOFFSET=2,s$L.LIGHTMAP=3,s$b(s$L,["shaderDefines",function(){return this.shaderDefines=new s$tL}]),s$L}(s$XL),s$GL=(function(s$d){function s$Z(s$d,s$L,s$l){this._long=NaN,this._width=NaN,this._height=NaN,void 0===s$d&&(s$d=1),void 0===s$L&&(s$L=1),void 0===s$l&&(s$l=1),s$Z.__super.call(this),this._long=s$d,this._width=s$L,this._height=s$l,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}s$Y(s$Z,"laya.d3.resource.models.BoxMesh",s$BL);var s$L=s$Z.prototype;s$L.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var s$d=s$Fd.vertexDeclaration,s$L=(s$d.vertexStride,this._long/2),s$l=this._height/2,s$Z=this._width/2,s$h=new Float32Array([-s$L,s$l,-s$Z,0,1,0,0,0,s$L,s$l,-s$Z,0,1,0,1,0,s$L,s$l,s$Z,0,1,0,1,1,-s$L,s$l,s$Z,0,1,0,0,1,-s$L,-s$l,-s$Z,0,-1,0,0,1,s$L,-s$l,-s$Z,0,-1,0,1,1,s$L,-s$l,s$Z,0,-1,0,1,0,-s$L,-s$l,s$Z,0,-1,0,0,0,-s$L,s$l,-s$Z,-1,0,0,0,0,-s$L,s$l,s$Z,-1,0,0,1,0,-s$L,-s$l,s$Z,-1,0,0,1,1,-s$L,-s$l,-s$Z,-1,0,0,0,1,s$L,s$l,-s$Z,1,0,0,1,0,s$L,s$l,s$Z,1,0,0,0,0,s$L,-s$l,s$Z,1,0,0,0,1,s$L,-s$l,-s$Z,1,0,0,1,1,-s$L,s$l,s$Z,0,0,1,0,0,s$L,s$l,s$Z,0,0,1,1,0,s$L,-s$l,s$Z,0,0,1,1,1,-s$L,-s$l,s$Z,0,0,1,0,1,-s$L,s$l,-s$Z,0,0,-1,1,0,s$L,s$l,-s$Z,0,0,-1,0,0,s$L,-s$l,-s$Z,0,0,-1,0,1,-s$L,-s$l,-s$Z,0,0,-1,1,1]),s$_=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new s$iL(s$d,this._numberVertices,35044,!0),this._indexBuffer=new s$oL("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(s$h),this._indexBuffer.setData(s$_),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},s$c(0,s$L,"long",function(){return this._long},function(s$d){this._long!==s$d&&(this._long=s$d,this.releaseResource(),this.activeResource())}),s$c(0,s$L,"width",function(){return this._width},function(s$d){this._width!==s$d&&(this._width=s$d,this.releaseResource(),this.activeResource())}),s$c(0,s$L,"height",function(){return this._height},function(s$d){this._height!==s$d&&(this._height=s$d,this.releaseResource(),this.activeResource())})}(),function(s$d){function s$N(s$d,s$L,s$l){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=.3),void 0===s$l&&(s$l=1e3),this._viewMatrix=new s$dL,this._projectionMatrix=new s$dL,this._projectionViewMatrix=new s$dL,this._viewport=new s$uL(0,0,0,0),this._normalizedViewport=new s$uL(0,0,1,1),this._aspectRatio=s$d,this._boundFrustumUpdate=!0,this._boundFrustum=new s$fd(s$dL.DEFAULT),s$N.__super.call(this,s$L,s$l),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}s$Y(s$N,"laya.d3.core.Camera",s$zL);var s$L=s$N.prototype;return s$L._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},s$L._parseCustomProps=function(s$d,s$L,s$l,s$Z){var s$h=s$l.clearColor;this.clearColor=new s$mL(s$h[0],s$h[1],s$h[2],s$h[3]);var s$_=s$l.viewport;this.normalizedViewport=new s$uL(s$_[0],s$_[1],s$_[2],s$_[3])},s$L._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var s$d=this.orthographicVerticalSize*this.aspectRatio*.5,s$L=.5*this.orthographicVerticalSize;s$dL.createOrthoOffCenterRH(-s$d,s$d,-s$L,s$L,this.nearPlane,this.farPlane,this._projectionMatrix)}else s$dL.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},s$L._update=function(s$d){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,s$d)},s$L._renderCamera=function(s$d,s$L,s$l){var s$Z,s$h;s$l.parallelSplitShadowMaps[0]&&s$l._renderShadowMap(s$d,s$L,this),(s$L.camera=this)._prepareCameraToRender(),s$l._preRenderUpdateComponents(s$L),s$Z=s$L._viewMatrix=this.viewMatrix;var s$_=this._renderTarget;s$_?(s$_.start(),s$dL.multiply(s$zL._invertYScaleMatrix,this._projectionMatrix,s$zL._invertYProjectionMatrix),s$dL.multiply(s$zL._invertYScaleMatrix,this.projectionViewMatrix,s$zL._invertYProjectionViewMatrix),s$h=s$L._projectionMatrix=s$zL._invertYProjectionMatrix,s$L._projectionViewMatrix=s$zL._invertYProjectionViewMatrix):(s$h=s$L._projectionMatrix=this._projectionMatrix,s$L._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(s$Z,s$h),s$L._viewport=this.viewport,s$l._preRenderScene(s$d,s$L,this.boundFrustum),s$l._clear(s$d,s$L),s$l._renderScene(s$d,s$L),s$l._postRenderUpdateComponents(s$L),s$_&&s$_.end()},s$L.viewportPointToRay=function(s$d,s$L){s$cL.calculateCursorRay(s$d,this.viewport,this._projectionMatrix,this.viewMatrix,null,s$L)},s$L.normalizedViewportPointToRay=function(s$d,s$L){var s$l=s$N._tempVector20,s$Z=this.viewport,s$h=s$d.elements,s$_=s$l.elements;s$_[0]=s$h[0]*s$Z.width,s$_[1]=s$h[1]*s$Z.height,s$cL.calculateCursorRay(s$l,this.viewport,this._projectionMatrix,this.viewMatrix,null,s$L)},s$L.worldToViewportPoint=function(s$d,s$L){s$dL.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(s$d,this._projectionViewMatrix,s$L);var s$l=s$L.elements;s$l[0]=s$l[0]/s$A.stage.clientScaleX,s$l[1]=s$l[1]/s$A.stage.clientScaleY},s$L.worldToNormalizedViewportPoint=function(s$d,s$L){s$dL.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(s$d,this._projectionViewMatrix,s$L);var s$l=s$L.elements;s$l[0]=s$l[0]/s$A.stage.clientScaleX,s$l[1]=s$l[1]/s$A.stage.clientScaleY},s$L.convertScreenCoordToOrthographicCoord=function(s$d,s$L){if(this._orthographic){var s$l=s$v.clientWidth,s$Z=s$v.clientHeight,s$h=this.orthographicVerticalSize*this.aspectRatio/s$l,s$_=this.orthographicVerticalSize/s$Z,s$N=s$d.elements,s$m=s$L.elements;return s$m[0]=(-s$l/2+s$N[0])*s$h,s$m[1]=(s$Z/2-s$N[1])*s$_,s$m[2]=(this.nearPlane-this.farPlane)*(s$N[2]+1)/2-this.nearPlane,s$NL.transformCoordinate(s$L,this.transform.worldMatrix,s$L),!0}return!1},s$c(0,s$L,"projectionViewMatrix",function(){return s$dL.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),s$c(0,s$L,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var s$d=this.viewport;return s$d.width/s$d.height},function(s$d){if(s$d<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=s$d,this._calculateProjectionMatrix()}),s$c(0,s$L,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),s$c(0,s$L,"needViewport",function(){var s$d=this.normalizedViewport;return 0===s$d.x&&0===s$d.y&&1===s$d.width&&1===s$d.height}),s$c(0,s$L,"viewport",function(){if(this._viewportExpressedInClipSpace){var s$d=this._normalizedViewport,s$L=this.renderTargetSize,s$l=s$L.width,s$Z=s$L.height;this._viewport.x=s$d.x*s$l,this._viewport.y=s$d.y*s$Z,this._viewport.width=s$d.width*s$l,this._viewport.height=s$d.height*s$Z}return this._viewport},function(s$d){if(null!=this.renderTarget&&(s$d.x<0||s$d.y<0||0==s$d.width||0==s$d.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=s$d,this._calculateProjectionMatrix()}),s$c(0,s$L,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var s$d=this._viewport,s$L=this.renderTargetSize,s$l=s$L.width,s$Z=s$L.height;this._normalizedViewport.x=s$d.x/s$l,this._normalizedViewport.y=s$d.y/s$Z,this._normalizedViewport.width=s$d.width/s$l,this._normalizedViewport.height=s$d.height/s$Z}return this._normalizedViewport},function(s$d){s$d.x<0&&(s$d.x=0,console.warn("Camera: viewport.x must large than 0.0.")),s$d.y<0&&(s$d.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<s$d.x+s$d.width&&(s$d.width=1-s$d.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<s$d.y+s$d.height&&(s$d.height=1-s$d.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=s$d,this._calculateProjectionMatrix()}),s$c(0,s$L,"projectionMatrix",function(){return this._projectionMatrix},function(s$d){this._projectionMatrix=s$d,this._useUserProjectionMatrix=!0}),s$c(0,s$L,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),s$b(s$N,["_tempVector20",function(){return this._tempVector20=new s$_L}]),s$N}()),s$KL=function(s$l){function s$Z(s$d,s$L){s$Z.__super.call(this,s$L),this._geometryFilter=new s$IL(this),this._render=new s$pL(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),s$d&&(this._geometryFilter.sharedMesh=s$d)instanceof laya.d3.resource.models.Mesh&&(s$d.loaded?this._render.sharedMaterials=s$d.materials:s$d.once("loaded",this,this._applyMeshMaterials))}s$Y(s$Z,"laya.d3.core.MeshSprite3D",s$l);var s$d=s$Z.prototype;return s$d._changeRenderObjectByMesh=function(s$d){var s$L=this._render._renderElements,s$l=s$L[s$d];s$l||(s$l=s$L[s$d]=new s$$L),s$l._render=this._render;var s$Z=this._render.sharedMaterials[s$d];s$Z||(s$Z=s$RL.defaultMaterial);var s$h=this._geometryFilter.sharedMesh.getRenderElement(s$d);return s$l._mainSortID=this._getSortID(s$h,s$Z),s$l._sprite3D=this,s$l.renderObj=s$h,s$l._material=s$Z,s$l},s$d._changeRenderObjectByMaterial=function(s$d,s$L){var s$l=this._render._renderElements[s$d];s$L||(s$L=s$RL.defaultMaterial);var s$Z=this._geometryFilter.sharedMesh.getRenderElement(s$d);return s$l._mainSortID=this._getSortID(s$Z,s$L),s$l._sprite3D=this,s$l.renderObj=s$Z,s$l._material=s$L,s$l},s$d._changeRenderObjectsByMesh=function(){var s$d=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=s$d;for(var s$L=0;s$L<s$d;s$L++)this._changeRenderObjectByMesh(s$L)},s$d._onMeshChanged=function(s$d){var s$L=s$d.sharedMesh;s$L.loaded?this._changeRenderObjectsByMesh():s$L.once("loaded",this,this._onMeshLoaded)},s$d._onMeshLoaded=function(s$d){s$d===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},s$d._onMaterialChanged=function(s$d,s$L,s$l){s$L<this._render._renderElements.length&&this._changeRenderObjectByMaterial(s$L,s$l)},s$d._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},s$d._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},s$d._parseCustomProps=function(s$d,s$L,s$l,s$Z){var s$h=this.meshRender,s$_=s$l.lightmapIndex;null!=s$_&&(s$h.lightmapIndex=s$_);var s$N,s$m,s$u=s$l.lightmapScaleOffset;if(s$u&&(s$h.lightmapScaleOffset=new s$mL(s$u[0],s$u[1],s$u[2],s$u[3])),s$Z.instanceParams)(s$N=s$Z.instanceParams.loadPath)&&(s$m=s$k.getRes(s$L[s$N]),(this.meshFilter.sharedMesh=s$m).loaded?s$h.sharedMaterials=s$m.materials:s$m.once("loaded",this,this._applyMeshMaterials));else{(s$N=s$l.meshPath)&&(s$m=s$k.getRes(s$L[s$N]),this.meshFilter.sharedMesh=s$m);var s$x=s$l.materials;if(s$x){var s$t=s$h.sharedMaterials,s$b=s$x.length;s$t.length=s$b;for(var s$q=0;s$q<s$b;s$q++)s$t[s$q]=s$k.getRes(s$L[s$x[s$q].path]);s$h.sharedMaterials=s$t}}},s$d._applyMeshMaterials=function(s$d){for(var s$L=this._render.sharedMaterials,s$l=s$d.materials,s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++)s$L[s$Z]||(s$L[s$Z]=s$l[s$Z]);this._render.sharedMaterials=s$L},s$d._addToInitStaticBatchManager=function(){s$Z._staticBatchManager._addInitBatchSprite(this)},s$d.cloneTo=function(s$d){var s$L=s$d;s$L._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var s$l=this._render,s$Z=s$L._render;s$Z.enable=s$l.enable,s$Z.sharedMaterials=s$l.sharedMaterials,s$Z.castShadow=s$l.castShadow;var s$h=s$l.lightmapScaleOffset;s$h&&(s$Z.lightmapScaleOffset=s$h.clone()),s$Z.lightmapIndex=s$l.lightmapIndex,s$Z.receiveShadow=s$l.receiveShadow,s$Z.sortingFudge=s$l.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,s$d)},s$d.destroy=function(s$d){if(void 0===s$d&&(s$d=!0),!this.destroyed){var s$L=this.meshFilter.sharedMesh;null!=s$L&&(s$L.loaded||s$L.off("loaded",this,this._applyMeshMaterials)),s$l.prototype.destroy.call(this,s$d),this._geometryFilter._destroy()}},s$c(0,s$d,"meshFilter",function(){return this._geometryFilter}),s$c(0,s$d,"meshRender",function(){return this._render}),s$Z.__init__=function(){s$Zd._staticBatchManagers.push(s$Z._staticBatchManager)},s$Z.load=function(s$d){return s$A.loader.create(s$d,null,null,s$Z)},s$b(s$Z,["_staticBatchManager",function(){return this._staticBatchManager=new s$nL}]),s$Z}(s$DL)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}}),function(s$d,s$L,s$hd){s$hd.un,s$hd.uns;var s$l=s$hd.static,s$Z=s$hd.class,s$_=s$hd.getset,s$r=s$hd.__newvec,s$m=laya.maths.Bezier,s$b=laya.utils.Browser,s$Fd=laya.utils.Byte,s$h=(laya.events.Event,laya.events.EventDispatcher),s$N=laya.display.Graphics,s$u=(laya.resource.HTMLCanvas,laya.utils.Handler),s$x=laya.net.Loader,s$q=laya.maths.MathUtil,s$Ed=laya.maths.Matrix,s$a=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),s$t=(laya.renders.RenderContext,laya.resource.Resource),s$Y=laya.utils.RunDriver,s$_d=laya.display.Sprite,s$c=laya.utils.Stat,s$Id=laya.resource.Texture,s$k=(laya.net.URL,laya.utils.Utils),s$E=function(){function s$d(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return s$Z(s$d,"laya.ani.AnimationContent"),s$d}(),s$I=function(){function s$d(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return s$Z(s$d,"laya.ani.AnimationNodeContent"),s$d}(),s$w=function(){function s$d(){}return s$Z(s$d,"laya.ani.AnimationParser01"),s$d.parse=function(s$d,s$L){var s$l=s$L.__getBuffer(),s$Z=0,s$h=0,s$_=0,s$N=0,s$m=0,s$u=0,s$x=0,s$t=s$L.readUTFString();s$d._aniClassName=s$t;var s$b,s$q=s$L.readUTFString().split("\n"),s$Y=s$L.getUint8(),s$c=s$L.getUint32(),s$r=s$L.getUint32();0<s$c&&(s$b=s$l.slice(s$c,s$r));var s$a=new s$Fd(s$b);for(0<s$r&&(s$d._publicExtData=s$l.slice(s$r,s$l.byteLength)),s$d._useParent=!!s$L.getUint8(),s$d._anis.length=s$Y,s$Z=0;s$Z<s$Y;s$Z++){var s$k=s$d._anis[s$Z]=new s$E;s$k.nodes=new Array;var s$e=s$k.name=s$q[s$L.getUint16()];s$d._aniMap[s$e]=s$Z,s$k.bone3DMap={},s$k.playTime=s$L.getFloat32(),s$k.playTime<=0&&console.error("播放时间不能为0  url="+s$d.url+" name="+s$k.name);var s$w=s$k.nodes.length=s$L.getUint8();for(s$h=s$k.totalKeyframeDatasLength=0;s$h<s$w;s$h++){var s$s=s$k.nodes[s$h]=new s$I;s$s.childs=[];var s$A=s$L.getInt16();0<=s$A&&(s$s.name=s$q[s$A],s$k.bone3DMap[s$s.name]=s$h),s$s.keyFrame=new Array,s$s.parentIndex=s$L.getInt16(),-1==s$s.parentIndex?s$s.parent=null:s$s.parent=s$k.nodes[s$s.parentIndex],s$s.lerpType=s$L.getUint8();var s$y=s$L.getUint32();s$a.pos=s$y;var s$$=s$s.keyframeWidth=s$a.getUint16();if(s$k.totalKeyframeDatasLength+=s$$,0===s$s.lerpType||1===s$s.lerpType)for(s$s.interpolationMethod=[],s$s.interpolationMethod.length=s$$,s$_=0;s$_<s$$;s$_++)s$s.interpolationMethod[s$_]=s$X.interpolation[s$a.getUint8()];null!=s$s.parent&&s$s.parent.childs.push(s$s);var s$O=s$L.getUint16();0<s$O&&(s$s.extenData=s$l.slice(s$L.pos,s$L.pos+s$O),s$L.pos+=s$O);var s$n,s$V=s$L.getUint16(),s$Q=0;for(s$_=0,s$N=s$s.keyFrame.length=s$V;s$_<s$N;s$_++){if((s$n=s$s.keyFrame[s$_]=new s$p).duration=s$L.getFloat32(),s$n.startTime=s$Q,2===s$s.lerpType){s$n.interpolationData=[];var s$g,s$F=s$L.getUint8();switch(s$g=s$L.getFloat32()){case 254:for(s$n.interpolationData.length=s$$,s$x=0;s$x<s$$;s$x++)s$n.interpolationData[s$x]=0;break;case 255:for(s$n.interpolationData.length=s$$,s$x=0;s$x<s$$;s$x++)s$n.interpolationData[s$x]=5;break;default:for(s$n.interpolationData.push(s$g),s$u=1;s$u<s$F;s$u++)s$n.interpolationData.push(s$L.getFloat32())}}for(s$n.data=new Float32Array(s$$),s$m=0;s$m<s$$;s$m++)s$n.data[s$m]=s$L.getFloat32(),-1e-8<s$n.data[s$m]&&s$n.data[s$m]<1e-8&&(s$n.data[s$m]=0);s$Q+=s$n.duration}s$n.startTime=s$k.playTime,s$s.playTime=s$k.playTime,s$d._calculateKeyFrame(s$s,s$V,s$$)}}},s$d}(),s$s=function(){function s$A(){}return s$Z(s$A,"laya.ani.AnimationParser02"),s$A.READ_DATA=function(){s$A._DATA.offset=s$A._reader.getUint32(),s$A._DATA.size=s$A._reader.getUint32()},s$A.READ_BLOCK=function(){for(var s$d=s$A._BLOCK.count=s$A._reader.getUint16(),s$L=s$A._BLOCK.blockStarts=[],s$l=s$A._BLOCK.blockLengths=[],s$Z=0;s$Z<s$d;s$Z++)s$L.push(s$A._reader.getUint32()),s$l.push(s$A._reader.getUint32())},s$A.READ_STRINGS=function(){var s$d=s$A._reader.getUint32(),s$L=s$A._reader.getUint16(),s$l=s$A._reader.pos;s$A._reader.pos=s$d+s$A._DATA.offset;for(var s$Z=0;s$Z<s$L;s$Z++)s$A._strings[s$Z]=s$A._reader.readUTFString();s$A._reader.pos=s$l},s$A.parse=function(s$d,s$L){s$A._templet=s$d;(s$A._reader=s$L).__getBuffer();s$A.READ_DATA(),s$A.READ_BLOCK(),s$A.READ_STRINGS();for(var s$l=0,s$Z=s$A._BLOCK.count;s$l<s$Z;s$l++){var s$h=s$L.getUint16(),s$_=s$A._strings[s$h],s$N=s$A["READ_"+s$_];if(null==s$N)throw new Error("model file err,no this function:"+s$h+" "+s$_);s$N.call()}},s$A.READ_ANIMATIONS=function(){var s$d=s$A._reader,s$L=s$d.__getBuffer(),s$l=0,s$Z=0,s$h=0,s$_=0,s$N=s$d.getUint16(),s$m=[];for(s$m.length=s$N,s$l=0;s$l<s$N;s$l++)s$m[s$l]=s$X.interpolation[s$d.getByte()];var s$u=s$d.getUint8();for(s$A._templet._anis.length=s$u,s$l=0;s$l<s$u;s$l++){var s$x=s$A._templet._anis[s$l]={};s$x.nodes=new Array;var s$t=s$x.name=s$A._strings[s$d.getUint16()];s$A._templet._aniMap[s$t]=s$l,s$x.bone3DMap={},s$x.playTime=s$d.getFloat32();var s$b=s$x.nodes.length=s$d.getInt16();for(s$Z=s$x.totalKeyframeDatasLength=0;s$Z<s$b;s$Z++){var s$q=s$x.nodes[s$Z]={};s$q.keyframeWidth=s$N,s$q.childs=[];var s$Y=s$d.getUint16();0<=s$Y&&(s$q.name=s$A._strings[s$Y],s$x.bone3DMap[s$q.name]=s$Z),s$q.keyFrame=new Array,s$q.parentIndex=s$d.getInt16(),-1==s$q.parentIndex?s$q.parent=null:s$q.parent=s$x.nodes[s$q.parentIndex],s$x.totalKeyframeDatasLength+=s$N,s$q.interpolationMethod=s$m,null!=s$q.parent&&s$q.parent.childs.push(s$q);var s$c=s$d.getUint16(),s$r=null,s$a=null;for(s$h=0,s$_=s$q.keyFrame.length=s$c;s$h<s$_;s$h++){(s$r=s$q.keyFrame[s$h]={}).startTime=s$d.getFloat32(),s$a&&(s$a.duration=s$r.startTime-s$a.startTime);var s$k=s$A._DATA.offset,s$e=s$d.getUint32(),s$w=4*s$N,s$s=s$L.slice(s$k+s$e,s$k+s$e+s$w);s$r.data=new Float32Array(s$s),s$a=s$r}s$r.duration=0,s$q.playTime=s$x.playTime,s$A._templet._calculateKeyFrame(s$q,s$c,s$N)}}},s$A._templet=null,s$A._reader=null,s$A._strings=[],s$l(s$A,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),s$A}(),s$pd=(function(){function s$d(){}s$Z(s$d,"laya.ani.AnimationState"),s$d.stopped=0,s$d.paused=1,s$d.playing=2}(),function(){function s$h(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new s$Dd,this.resultMatrix=new s$Ed,this._children=[]}s$Z(s$h,"laya.ani.bone.Bone");var s$d=s$h.prototype;return s$d.setTempMatrix=function(s$d){this._tempMatrix=s$d;var s$L,s$l=0;for(s$l=0,s$L=this._children.length;s$l<s$L;s$l++)this._children[s$l].setTempMatrix(this._tempMatrix)},s$d.update=function(s$d){var s$L;if(this.rotation=this.transform.skX,s$d)s$L=this.resultTransform.getMatrix(),s$Ed.mul(s$L,s$d,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)s$L=this.resultTransform.getMatrix(),s$Ed.mul(s$L,this.parentBone.resultMatrix,this.resultMatrix);else{var s$l=this.parentBone,s$Z=NaN,s$h=NaN,s$_=NaN,s$N=this.parentBone.resultMatrix;s$L=this.resultTransform.getMatrix();var s$m=s$N.a*s$L.tx+s$N.c*s$L.ty+s$N.tx,s$u=s$N.b*s$L.tx+s$N.d*s$L.ty+s$N.ty,s$x=new s$Ed;this.inheritRotation?(s$Z=Math.atan2(s$l.resultMatrix.b,s$l.resultMatrix.a),s$h=Math.cos(s$Z),s$_=Math.sin(s$Z),s$x.setTo(s$h,s$_,-s$_,s$h,0,0),s$Ed.mul(this._tempMatrix,s$x,s$Ed.TEMP),s$Ed.TEMP.copyTo(s$x),s$L=this.resultTransform.getMatrix(),s$Ed.mul(s$L,s$x,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,s$L=this.resultTransform.getMatrix(),s$Ed.TEMP.identity(),s$Ed.TEMP.d=this.d,s$Ed.mul(s$L,s$Ed.TEMP,this.resultMatrix)),this.resultMatrix.tx=s$m,this.resultMatrix.ty=s$u}else(s$L=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var s$t,s$b=0;for(s$b=0,s$t=this._children.length;s$b<s$t;s$b++)this._children[s$b].update()},s$d.updateChild=function(){var s$d,s$L=0;for(s$L=0,s$d=this._children.length;s$L<s$d;s$L++)this._children[s$L].update()},s$d.setRotation=function(s$d){this._sprite&&(this._sprite.rotation=180*s$d/Math.PI)},s$d.updateDraw=function(s$d,s$L){s$h.ShowBones&&!s$h.ShowBones[this.name]||(this._sprite||(this._sprite=new s$_d,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),s$hd.stage.addChild(this._sprite)),this._sprite.x=s$d+this.resultMatrix.tx,this._sprite.y=s$L+this.resultMatrix.ty);var s$l,s$Z=0;for(s$Z=0,s$l=this._children.length;s$Z<s$l;s$Z++)this._children[s$Z].updateDraw(s$d,s$L)},s$d.addChild=function(s$d){this._children.push(s$d),s$d.parentBone=this},s$d.findBone=function(s$d){if(this.name==s$d)return this;var s$L,s$l,s$Z=0;for(s$Z=0,s$L=this._children.length;s$Z<s$L;s$Z++)if(s$l=this._children[s$Z].findBone(s$d))return s$l;return null},s$d.localToWorld=function(s$d){var s$L=s$d[0],s$l=s$d[1];s$d[0]=s$L*this.resultMatrix.a+s$l*this.resultMatrix.c+this.resultMatrix.tx,s$d[1]=s$L*this.resultMatrix.b+s$l*this.resultMatrix.d+this.resultMatrix.ty},s$h.ShowBones={},s$h}()),s$Hd=function(){function s$r(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}s$Z(s$r,"laya.ani.bone.BoneSlot");var s$d=s$r.prototype;return s$d.showSlotData=function(s$d,s$L){void 0===s$L&&(s$L=!0),this.currSlotData=s$d,s$L&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},s$d.showDisplayByName=function(s$d){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(s$d))},s$d.replaceDisplayByName=function(s$d,s$L){if(this.currSlotData){var s$l;s$l=this.currSlotData.getDisplayByName(s$d);var s$Z;s$Z=this.currSlotData.getDisplayByName(s$L),this.replaceDisplayByIndex(s$l,s$Z)}},s$d.replaceDisplayByIndex=function(s$d,s$L){this.currSlotData&&(this._replaceDic[s$d]=s$L,this.displayIndex==s$d&&this.showDisplayByIndex(s$d))},s$d.showDisplayByIndex=function(s$d){if(null!=this._replaceDic[s$d]&&(s$d=this._replaceDic[s$d]),this.currSlotData&&-1<s$d&&s$d<this.currSlotData.displayArr.length){if(this.displayIndex=s$d,this.currDisplayData=this.currSlotData.displayArr[s$d],this.currDisplayData){var s$L=this.currDisplayData.name;this.currTexture=this.templet.getTexture(s$L),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!s$a.isConchApp||s$a.isConchApp&&"0.9.15"<s$_d.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},s$d.replaceSkin=function(s$d){this._diyTexture=s$d,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},s$d.setParentMatrix=function(s$d){this._parentMatrix=s$d},s$d.draw=function(s$d,s$L,s$l,s$Z){if(void 0===s$l&&(s$l=!1),void 0===s$Z&&(s$Z=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var s$h,s$_=this.currTexture;switch(this._diyTexture&&(s$_=this._diyTexture),this.currDisplayData.type){case 0:if(s$d){var s$N=this.getDisplayMatrix();if(this._parentMatrix){var s$m=!1;if(s$N){var s$u;if(s$Ed.mul(s$N,this._parentMatrix,s$Ed.TEMP),s$u=s$l?(null==this._resultMatrix&&(this._resultMatrix=new s$Ed),this._resultMatrix):new s$Ed,!s$a.isWebGL&&this.currDisplayData.uvs||s$a.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var s$x=s$r._tempMatrix;s$x.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(s$x.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(s$m=!0,s$x.rotate(-Math.PI/2)),s$Ed.mul(s$x,s$Ed.TEMP,s$u)}else s$Ed.TEMP.copyTo(s$u);s$m?s$d.drawTexture(s$_,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,s$u):s$d.drawTexture(s$_,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,s$u)}}}break;case 1:if(null==(s$h=s$l?(null==this._skinSprite&&(this._skinSprite=s$r.createSkinMesh()),this._skinSprite):s$r.createSkinMesh()))return;var s$t;if(null==this.currDisplayData.bones){var s$b,s$q=this.currDisplayData.weights;this.deformData&&(s$q=this.deformData),s$b=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=s$$.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=s$$.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=s$q;this.currDisplayData.triangles.length;s$t=this.currDisplayData.triangles,s$h.init2(s$_,null,s$t,this._mVerticleArr,s$b);var s$Y,s$c=this.getDisplayMatrix();if(this._parentMatrix)if(s$c)s$Ed.mul(s$c,this._parentMatrix,s$Ed.TEMP),s$Y=s$l?(null==this._resultMatrix&&(this._resultMatrix=new s$Ed),this._resultMatrix):new s$Ed,s$Ed.TEMP.copyTo(s$Y),s$h.transform=s$Y}else this.skinMesh(s$L,s$h,s$Z);s$d.drawSkin(s$h);break;case 2:if(null==(s$h=s$l?(null==this._skinSprite&&(this._skinSprite=s$r.createSkinMesh()),this._skinSprite):s$r.createSkinMesh()))return;this.skinMesh(s$L,s$h,s$Z),s$d.drawSkin(s$h)}}},s$d.skinMesh=function(s$d,s$L,s$l){var s$Z,s$h=this.currTexture,s$_=this.currDisplayData.bones;s$Z=this._diyTexture?(s$h=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=s$$.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=s$$.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var s$N,s$m,s$u=this.currDisplayData.weights,s$x=this.currDisplayData.triangles,s$t=0,s$b=0,s$q=0,s$Y=NaN,s$c=NaN,s$r=0,s$a=0,s$k=[],s$e=0,s$w=0;if(this.deformData&&0<this.deformData.length){var s$s=0;for(s$e=0,s$w=s$_.length;s$e<s$w;){for(s$q=s$_[s$e++]+s$e,s$b=s$t=0;s$e<s$q;s$e++)s$m=s$d[s$_[s$e]],s$Y=s$u[s$r]+this.deformData[s$s++],s$c=s$u[s$r+1]+this.deformData[s$s++],s$a=s$u[s$r+2],s$t+=(s$Y*s$m.a+s$c*s$m.c+s$m.tx)*s$a,s$b+=(s$Y*s$m.b+s$c*s$m.d+s$m.ty)*s$a,s$r+=3;s$k.push(s$t,s$b)}}else for(s$e=0,s$w=s$_.length;s$e<s$w;){for(s$q=s$_[s$e++]+s$e,s$b=s$t=0;s$e<s$q;s$e++)s$m=s$d[s$_[s$e]],s$Y=s$u[s$r],s$c=s$u[s$r+1],s$a=s$u[s$r+2],s$t+=(s$Y*s$m.a+s$c*s$m.c+s$m.tx)*s$a,s$b+=(s$Y*s$m.b+s$c*s$m.d+s$m.ty)*s$a,s$r+=3;s$k.push(s$t,s$b)}this._mVerticleArr=s$k,s$N=s$x,s$L.init2(s$h,null,s$N,this._mVerticleArr,s$Z)},s$d.drawBonePoint=function(s$d){s$d&&this._parentMatrix&&s$d.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},s$d.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},s$d.getMatrix=function(){return this._resultMatrix},s$d.copy=function(){var s$d=new s$r;return s$d.type="copy",s$d.name=this.name,s$d.attachmentName=this.attachmentName,s$d.srcDisplayIndex=this.srcDisplayIndex,s$d.parent=this.parent,s$d.displayIndex=this.displayIndex,s$d.templet=this.templet,s$d.currSlotData=this.currSlotData,s$d.currTexture=this.currTexture,s$d.currDisplayData=this.currDisplayData,s$d},s$r.createSkinMesh=function(){return s$a.isWebGL||s$a.isConchApp?s$Y.skinAniSprite():(s$a.isWebGL,null)},s$l(s$r,["_tempMatrix",function(){return this._tempMatrix=new s$Ed}]),s$r}(),s$Xd=function(){function s$d(){this.skinName=null,this.deformSlotDataList=[]}return s$Z(s$d,"laya.ani.bone.DeformAniData"),s$d}(),s$jd=function(){function s$d(){this.deformSlotDisplayList=[]}return s$Z(s$d,"laya.ani.bone.DeformSlotData"),s$d}(),s$Rd=function(){function s$d(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}s$Z(s$d,"laya.ani.bone.DeformSlotDisplayData");var s$L=s$d.prototype;return s$L.binarySearch1=function(s$d,s$L){var s$l=0,s$Z=s$d.length-2;if(0==s$Z)return 1;for(var s$h=s$Z>>>1;;){if(s$d[Math.floor(s$h+1)]<=s$L?s$l=s$h+1:s$Z=s$h,s$l==s$Z)return s$l+1;s$h=s$l+s$Z>>>1}return 0},s$L.apply=function(s$d,s$L,s$l){if(void 0===s$l&&(s$l=1),s$d+=.05,!(this.timeList.length<=0)){var s$Z=0;if(!(s$d<this.timeList[0])){var s$h=this.vectices[0].length,s$_=[],s$N=this.binarySearch1(this.timeList,s$d);if(this.frameIndex=s$N,s$d>=this.timeList[this.timeList.length-1]){var s$m=this.vectices[this.vectices.length-1];if(s$l<1)for(s$Z=0;s$Z<s$h;s$Z++)s$_[s$Z]+=(s$m[s$Z]-s$_[s$Z])*s$l;else for(s$Z=0;s$Z<s$h;s$Z++)s$_[s$Z]=s$m[s$Z];this.deformData=s$_}else{this.tweenKeyList[this.frameIndex];var s$u=this.vectices[this.frameIndex-1],s$x=this.vectices[this.frameIndex],s$t=this.timeList[this.frameIndex-1],s$b=this.timeList[this.frameIndex];s$l=this.tweenKeyList[s$N-1]?(s$d-s$t)/(s$b-s$t):0;var s$q=NaN;for(s$Z=0;s$Z<s$h;s$Z++)s$q=s$u[s$Z],s$_[s$Z]=s$q+(s$x[s$Z]-s$q)*s$l;this.deformData=s$_}}}},s$d}(),s$od=function(){function s$d(){this.time=NaN,this.drawOrder=[]}return s$Z(s$d,"laya.ani.bone.DrawOrderData"),s$d}(),s$id=function(){function s$d(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return s$Z(s$d,"laya.ani.bone.EventData"),s$d}(),s$e=function(){function s$Zd(s$d,s$L){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=s$d,this._targetBone=s$L[s$d.targetBoneIndex],this.isSpine=s$d.isSpine,null==this._bones&&(this._bones=[]);for(var s$l=this._bones.length=0,s$Z=s$d.boneIndexs.length;s$l<s$Z;s$l++)this._bones.push(s$L[s$d.boneIndexs[s$l]]);this.name=s$d.name,this.mix=s$d.mix,this.bendDirection=s$d.bendDirection}s$Z(s$Zd,"laya.ani.bone.IkConstraint");var s$d=s$Zd.prototype;return s$d.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},s$d._applyIk1=function(s$d,s$L,s$l,s$Z){var s$h=s$d.parentBone,s$_=1/(s$h.resultMatrix.a*s$h.resultMatrix.d-s$h.resultMatrix.b*s$h.resultMatrix.c),s$N=s$L-s$h.resultMatrix.tx,s$m=s$l-s$h.resultMatrix.ty,s$u=(s$N*s$h.resultMatrix.d-s$m*s$h.resultMatrix.c)*s$_-s$d.transform.x,s$x=(s$m*s$h.resultMatrix.a-s$N*s$h.resultMatrix.b)*s$_-s$d.transform.y,s$t=Math.atan2(s$x,s$u)*s$Zd.radDeg-0-s$d.transform.skX;s$d.transform.scX<0&&(s$t+=180),180<s$t?s$t-=360:s$t<-180&&(s$t+=360),s$d.transform.skX=s$d.transform.skY=s$d.transform.skX+s$t*s$Z,s$d.update()},s$d.updatePos=function(s$d,s$L){this._sp&&this._sp.pos(s$d,s$L)},s$d._applyIk2=function(s$d,s$L,s$l,s$Z,s$h,s$_){if(0!=s$_){var s$N=s$d.resultTransform.x,s$m=s$d.resultTransform.y,s$u=s$d.transform.scX,s$x=s$d.transform.scY,s$t=s$L.transform.scX,s$b=0,s$q=0,s$Y=0;s$Y=s$u<0?(s$u=-s$u,s$b=180,-1):(s$b=0,1),s$x<0&&(s$x=-s$x,s$Y=-s$Y),s$q=s$t<0?(s$t=-s$t,180):0;var s$c=s$L.resultTransform.x,s$r=NaN,s$a=NaN,s$k=NaN,s$e=s$d.resultMatrix.a,s$w=s$d.resultMatrix.c,s$s=s$d.resultMatrix.b,s$A=s$d.resultMatrix.d,s$y=Math.abs(s$u-s$x)<=1e-4;s$k=s$y?(s$a=s$e*s$c+s$w*(s$r=s$L.resultTransform.y)+s$d.resultMatrix.tx,s$s*s$c+s$A*s$r+s$d.resultMatrix.ty):(s$r=0,s$a=s$e*s$c+s$d.resultMatrix.tx,s$s*s$c+s$d.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new s$_d,s$hd.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(s$l,s$Z,15,"#ffff00"),this._sp.graphics.drawCircle(s$a,s$k,15,"#ff00ff")),s$d.setRotation(Math.atan2(s$k-s$d.resultMatrix.ty,s$a-s$d.resultMatrix.tx));var s$$=s$d.parentBone;s$e=s$$.resultMatrix.a,s$w=s$$.resultMatrix.c,s$s=s$$.resultMatrix.b;var s$O=1/(s$e*(s$A=s$$.resultMatrix.d)-s$w*s$s),s$n=s$l-s$$.resultMatrix.tx,s$V=s$Z-s$$.resultMatrix.ty,s$Q=(s$n*s$A-s$V*s$w)*s$O-s$N,s$g=(s$V*s$e-s$n*s$s)*s$O-s$m,s$F=((s$n=s$a-s$$.resultMatrix.tx)*s$A-(s$V=s$k-s$$.resultMatrix.ty)*s$w)*s$O-s$N,s$E=(s$V*s$e-s$n*s$s)*s$O-s$m,s$I=Math.sqrt(s$F*s$F+s$E*s$E),s$p=s$L.length*s$t,s$H=NaN,s$X=NaN;if(s$y){var s$j=(s$Q*s$Q+s$g*s$g-s$I*s$I-(s$p*=s$u)*s$p)/(2*s$I*s$p);s$j<-1?s$j=-1:1<s$j&&(s$j=1),s$X=Math.acos(s$j)*s$h,s$e=s$I+s$p*s$j,s$w=s$p*Math.sin(s$X),s$H=Math.atan2(s$g*s$e-s$Q*s$w,s$Q*s$e+s$g*s$w)}else{var s$R=(s$e=s$u*s$p)*s$e,s$o=(s$w=s$x*s$p)*s$w,s$i=s$Q*s$Q+s$g*s$g,s$S=Math.atan2(s$g,s$Q),s$B=-2*s$o*s$I,s$C=s$o-s$R;if(0<(s$A=s$B*s$B-4*s$C*(s$s=s$o*s$I*s$I+s$R*s$i-s$R*s$o))){var s$P=Math.sqrt(s$A);s$B<0&&(s$P=-s$P);var s$T=(s$P=-(s$B+s$P)/2)/s$C,s$z=s$s/s$P,s$D=Math.abs(s$T)<Math.abs(s$z)?s$T:s$z;s$D*s$D<=s$i&&(s$V=Math.sqrt(s$i-s$D*s$D)*s$h,s$H=s$S-Math.atan2(s$V,s$D),s$X=Math.atan2(s$V/s$x,(s$D-s$I)/s$u))}var s$G=0,s$K=Number.MAX_VALUE,s$v=0,s$J=0,s$f=0,s$U=0,s$W=0,s$M=0;s$U<(s$A=(s$n=s$I+s$e)*s$n)&&(s$f=0,s$U=s$A,s$W=s$n),(s$A=(s$n=s$I-s$e)*s$n)<s$K&&(s$G=Math.PI,s$K=s$A,s$v=s$n);var s$dd=Math.acos(-s$e*s$I/(s$R-s$o));(s$A=(s$n=s$e*Math.cos(s$dd)+s$I)*s$n+(s$V=s$w*Math.sin(s$dd))*s$V)<s$K&&(s$G=s$dd,s$K=s$A,s$v=s$n,s$J=s$V),s$U<s$A&&(s$f=s$dd,s$U=s$A,s$W=s$n,s$M=s$V),s$X=s$i<=(s$K+s$U)/2?(s$H=s$S-Math.atan2(s$J*s$h,s$v),s$G*s$h):(s$H=s$S-Math.atan2(s$M*s$h,s$W),s$f*s$h)}var s$Ld=Math.atan2(s$r,s$c)*s$Y,s$ld=s$d.resultTransform.skX;180<(s$H=(s$H-s$Ld)*s$Zd.radDeg+s$b-s$ld)?s$H-=360:s$H<-180&&(s$H+=360),s$d.resultTransform.x=s$N,s$d.resultTransform.y=s$m,s$d.resultTransform.skX=s$d.resultTransform.skY=s$ld+s$H*s$_,s$ld=s$L.resultTransform.skX,180<(s$X=((s$X+s$Ld)*s$Zd.radDeg-0)*s$Y+s$q-(s$ld%=360))?s$X-=360:s$X<-180&&(s$X+=360),s$L.resultTransform.x=s$c,s$L.resultTransform.y=s$r,s$L.resultTransform.skX=s$L.resultTransform.skY=s$L.resultTransform.skY+s$X*s$_,s$d.update()}},s$d._applyIk3=function(s$d,s$L,s$l,s$Z,s$h,s$_){if(0!=s$_){var s$N,s$m,s$u=s$L.resultMatrix.a*s$L.length,s$x=s$L.resultMatrix.b*s$L.length,s$t=s$u*s$u+s$x*s$x,s$b=Math.sqrt(s$t),s$q=s$d.resultMatrix.tx,s$Y=s$d.resultMatrix.ty,s$c=s$L.resultMatrix.tx,s$r=s$L.resultMatrix.ty,s$a=s$c-s$q,s$k=s$r-s$Y,s$e=s$a*s$a+s$k*s$k,s$w=Math.sqrt(s$e),s$s=(s$a=s$l-s$d.resultMatrix.tx)*s$a+(s$k=s$Z-s$d.resultMatrix.ty)*s$k,s$A=Math.sqrt(s$s);if(s$b+s$w<=s$A||s$A+s$b<=s$w||s$A+s$w<=s$b){var s$y=NaN;s$c=s$q+(s$y=s$b+s$w<=s$A?1:-1)*(s$l-s$q)*s$w/s$A,s$r=s$Y+s$y*(s$Z-s$Y)*s$w/s$A}else{var s$$=(s$e-s$t+s$s)/(2*s$s),s$O=Math.sqrt(s$e-s$$*s$$*s$s)/s$A,s$n=s$q+s$a*s$$,s$V=s$Y+s$k*s$$,s$Q=-s$k*s$O,s$g=s$a*s$O;s$r=0<s$h?(s$c=s$n-s$Q,s$V-s$g):(s$c=s$n+s$Q,s$V+s$g)}s$N=s$c,s$m=s$r,this.isDebug&&(this._sp||(this._sp=new s$_d,s$hd.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(s$q,s$Y,15,"#ff00ff"),this._sp.graphics.drawCircle(s$l,s$Z,15,"#ffff00"),this._sp.graphics.drawCircle(s$N,s$m,15,"#ff00ff"));var s$F,s$E;s$F=Math.atan2(s$m-s$d.resultMatrix.ty,s$N-s$d.resultMatrix.tx),s$d.setRotation(s$F),(s$E=s$Zd._tempMatrix).identity(),s$E.rotate(s$F),s$E.scale(s$d.resultMatrix.getScaleX(),s$d.resultMatrix.getScaleY()),s$E.translate(s$d.resultMatrix.tx,s$d.resultMatrix.ty),s$E.copyTo(s$d.resultMatrix),s$d.updateChild();var s$I,s$p;s$I=Math.atan2(s$Z-s$m,s$l-s$N),s$L.setRotation(s$I),(s$p=s$Zd._tempMatrix).identity(),s$p.rotate(s$I),s$p.scale(s$L.resultMatrix.getScaleX(),s$L.resultMatrix.getScaleY()),s$p.translate(s$N,s$m),s$E.copyTo(s$L.resultMatrix),s$L.updateChild()}},s$l(s$Zd,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new s$Ed}]),s$Zd}(),s$Sd=function(){function s$d(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return s$Z(s$d,"laya.ani.bone.IkConstraintData"),s$d}(),s$A=function(){function s$p(s$d,s$L){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=s$d,this.position=s$d.position,this.spacing=s$d.spacing,this.rotateMix=s$d.rotateMix,this.translateMix=s$d.translateMix,this.bones=[];for(var s$l=this.data.bones,s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++)this.bones.push(s$L[s$l[s$Z]])}s$Z(s$p,"laya.ani.bone.PathConstraint");var s$d=s$p.prototype;return s$d.apply=function(s$d,s$L){if(this.target){var s$l=this.translateMix,s$Z=this.translateMix,s$h=0<s$Z,s$_=this.data.spacingMode,s$N="length"==s$_,s$m=this.data.rotateMode,s$u="tangent"==s$m,s$x="chainScale"==s$m,s$t=[],s$b=this.bones.length,s$q=s$u?s$b:s$b+1,s$Y=[];(this._spaces=s$Y)[0]=this.position;var s$c=this.spacing;if(s$x||s$N)for(var s$r=0,s$a=s$q-1;s$r<s$a;){var s$k=this.bones[s$r],s$e=s$k.length,s$w=s$e*s$k.resultMatrix.a,s$s=s$e*s$k.resultMatrix.b;s$e=Math.sqrt(s$w*s$w+s$s*s$s),s$x&&(s$t[s$r]=s$e),s$Y[++s$r]=s$N?Math.max(0,s$e+s$c):s$c}else for(s$r=1;s$r<s$q;s$r++)s$Y[s$r]=s$c;var s$A=this.computeWorldPositions(this.target,s$d,s$L,s$q,s$u,"percent"==this.data.positionMode,"percent"==s$_);if(this._debugKey){for(s$r=0;s$r<s$A.length;s$r++)s$L.drawCircle(s$A[s$r++],s$A[s$r++],5,"#00ff00");var s$y=[];for(s$r=0;s$r<s$A.length;s$r++)s$y.push(s$A[s$r++],s$A[s$r++]);s$L.drawLines(0,0,s$y,"#ff0000")}var s$$=s$A[0],s$O=s$A[1],s$n=this.data.offsetRotation,s$V="chain"==s$m&&0==s$n,s$Q=NaN;for(s$r=0,s$Q=3;s$r<s$b;s$r++,s$Q+=3){(s$k=this.bones[s$r]).resultMatrix.tx+=(s$$-s$k.resultMatrix.tx)*s$l,s$k.resultMatrix.ty+=(s$O-s$k.resultMatrix.ty)*s$l;var s$g=(s$w=s$A[s$Q])-s$$,s$F=(s$s=s$A[s$Q+1])-s$O;if(s$x&&0!=(s$e=s$t[s$r])){var s$E=(Math.sqrt(s$g*s$g+s$F*s$F)/s$e-1)*s$Z+1;s$k.resultMatrix.a*=s$E,s$k.resultMatrix.c*=s$E}if(s$$=s$w,s$O=s$s,s$h){var s$I=s$k.resultMatrix.a,s$p=s$k.resultMatrix.c,s$H=s$k.resultMatrix.b,s$X=s$k.resultMatrix.d,s$j=NaN,s$R=NaN,s$o=NaN;s$j=s$u?s$A[s$Q-1]:0==s$Y[s$r+1]?s$A[s$Q+2]:Math.atan2(s$F,s$g),s$j-=Math.atan2(s$H,s$I)-s$n/180*Math.PI,s$V&&(s$R=Math.cos(s$j),s$o=Math.sin(s$j),s$$+=((s$e=s$k.length)*(s$R*s$I-s$o*s$H)-s$g)*s$Z,s$O+=(s$e*(s$o*s$I+s$R*s$H)-s$F)*s$Z),s$j>Math.PI?s$j-=2*Math.PI:s$j<-Math.PI&&(s$j+=2*Math.PI),s$j*=s$Z,s$R=Math.cos(s$j),s$o=Math.sin(s$j),s$k.resultMatrix.a=s$R*s$I-s$o*s$H,s$k.resultMatrix.c=s$R*s$p-s$o*s$X,s$k.resultMatrix.b=s$o*s$I+s$R*s$H,s$k.resultMatrix.d=s$o*s$p+s$R*s$X}}}},s$d.computeWorldVertices2=function(s$d,s$L,s$l,s$Z,s$h,s$_){var s$N,s$m,s$u=s$d.currDisplayData.bones,s$x=s$d.currDisplayData.weights,s$t=s$d.currDisplayData.triangles,s$b=0,s$q=0,s$Y=0,s$c=0,s$r=0,s$a=0,s$k=0,s$e=0,s$w=0,s$s=0,s$A=0;if(null!=s$u){for(s$b=0;s$b<s$l;s$b+=2)s$q+=(s$c=s$u[s$q])+1,s$Y+=s$c;var s$y=s$L;for(s$r=s$_,s$a=3*s$Y;s$r<s$Z;s$r+=2){for(s$e=s$k=0,s$c=s$u[s$q++],s$c+=s$q;s$q<s$c;s$q++,s$a+=3){s$N=s$y[s$u[s$q]].resultMatrix,s$w=s$x[s$a],s$s=s$x[s$a+1];var s$$=s$x[s$a+2];s$k+=(s$w*s$N.a+s$s*s$N.c+s$N.tx)*s$$,s$e+=(s$w*s$N.b+s$s*s$N.d+s$N.ty)*s$$}s$h[s$r]=s$k,s$h[s$r+1]=s$e}}else{var s$O,s$n;if(s$t||(s$t=s$x),s$d.deformData&&(s$t=s$d.deformData),s$O=s$d.parent,s$L)for(s$A=s$L.length,s$b=0;s$b<s$A;s$b++)if(s$L[s$b].name==s$O){s$m=s$L[s$b];break}s$m&&(s$n=s$m.resultMatrix),s$n||(s$n=s$p._tempMt);var s$V=s$n.tx,s$Q=s$n.ty,s$g=s$n.a,s$F=s$n.b,s$E=s$n.c,s$I=s$n.d;for(s$m&&(s$I*=s$m.d),s$q=s$l,s$r=s$_;s$r<s$Z;s$q+=2,s$r+=2)s$w=s$t[s$q],s$s=s$t[s$q+1],s$h[s$r]=s$w*s$g+s$s*s$F+s$V,s$h[s$r+1]=-(s$w*s$E+s$s*s$I+s$Q)}},s$d.computeWorldPositions=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N){s$d.currDisplayData.bones,s$d.currDisplayData.weights,s$d.currDisplayData.triangles;var s$m=[],s$u=0,s$x=s$d.currDisplayData.verLen,s$t=this.position,s$b=this._spaces,s$q=[],s$Y=[],s$c=s$x/6,s$r=-1,s$a=NaN,s$k=0,s$e=0,s$w=NaN,s$s=NaN,s$A=NaN,s$y=NaN;if(s$c--,s$x-=4,this.computeWorldVertices2(s$d,s$L,2,s$x,s$m,0),this._debugKey)for(s$u=0;s$u<s$m.length;)s$l.drawCircle(s$m[s$u++],s$m[s$u++],10,"#ff0000");s$q=s$m,this._curves.length=s$c;var s$$=this._curves,s$O=s$q[s$a=0],s$n=s$q[1],s$V=0,s$Q=0,s$g=0,s$F=0,s$E=0,s$I=0,s$p=NaN,s$H=NaN,s$X=NaN,s$j=NaN,s$R=NaN,s$o=NaN,s$i=NaN,s$S=NaN,s$B=0;for(s$u=0,s$B=2;s$u<s$c;s$u++,s$B+=6)s$V=s$q[s$B],s$Q=s$q[s$B+1],s$g=s$q[s$B+2],s$F=s$q[s$B+3],s$R=2*(s$p=.1875*(s$O-2*s$V+s$g))+(s$X=.09375*(3*(s$V-s$g)-s$O+(s$E=s$q[s$B+4]))),s$o=2*(s$H=.1875*(s$n-2*s$Q+s$F))+(s$j=.09375*(3*(s$Q-s$F)-s$n+(s$I=s$q[s$B+5]))),s$i=.75*(s$V-s$O)+s$p+.16666667*s$X,s$S=.75*(s$Q-s$n)+s$H+.16666667*s$j,s$a+=Math.sqrt(s$i*s$i+s$S*s$S),s$i+=s$R,s$S+=s$o,s$R+=s$X,s$o+=s$j,s$a+=Math.sqrt(s$i*s$i+s$S*s$S),s$i+=s$R,s$S+=s$o,s$a+=Math.sqrt(s$i*s$i+s$S*s$S),s$i+=s$R+s$X,s$S+=s$o+s$j,s$a+=Math.sqrt(s$i*s$i+s$S*s$S),s$$[s$u]=s$a,s$O=s$E,s$n=s$I;if(s$_&&(s$t*=s$a),s$N)for(s$u=0;s$u<s$Z;s$u++)s$b[s$u]*=s$a;var s$C=this._segments,s$P=0,s$T=0;for(s$T=s$e=s$k=s$u=0;s$u<s$Z;s$u++,s$k+=3)if((s$w=s$t+=s$s=s$b[s$u])<0)this.addBeforePosition(s$w,s$q,0,s$Y,s$k);else if(s$a<s$w)this.addAfterPosition(s$w-s$a,s$q,s$x-4,s$Y,s$k);else{for(;;s$e++)if(!((s$y=s$$[s$e])<s$w)){0==s$e?s$w/=s$y:s$w=(s$w-(s$A=s$$[s$e-1]))/(s$y-s$A);break}if(s$e!=s$r){var s$z=6*(s$r=s$e);for(s$O=s$q[s$z],s$n=s$q[s$z+1],s$V=s$q[s$z+2],s$Q=s$q[s$z+3],s$g=s$q[s$z+4],s$F=s$q[s$z+5],s$R=2*(s$p=.03*(s$O-2*s$V+s$g))+(s$X=.006*(3*(s$V-s$g)-s$O+(s$E=s$q[s$z+6]))),s$o=2*(s$H=.03*(s$n-2*s$Q+s$F))+(s$j=.006*(3*(s$Q-s$F)-s$n+(s$I=s$q[s$z+7]))),s$i=.3*(s$V-s$O)+s$p+.16666667*s$X,s$S=.3*(s$Q-s$n)+s$H+.16666667*s$j,s$P=Math.sqrt(s$i*s$i+s$S*s$S),s$C[0]=s$P,s$z=1;s$z<8;s$z++)s$i+=s$R,s$S+=s$o,s$R+=s$X,s$o+=s$j,s$P+=Math.sqrt(s$i*s$i+s$S*s$S),s$C[s$z]=s$P;s$i+=s$R,s$S+=s$o,s$P+=Math.sqrt(s$i*s$i+s$S*s$S),s$C[8]=s$P,s$i+=s$R+s$X,s$S+=s$o+s$j,s$P+=Math.sqrt(s$i*s$i+s$S*s$S),s$C[9]=s$P,s$T=0}for(s$w*=s$P;;s$T++)if(!((s$y=s$C[s$T])<s$w)){0==s$T?s$w/=s$y:s$w=s$T+(s$w-(s$A=s$C[s$T-1]))/(s$y-s$A);break}this.addCurvePosition(.1*s$w,s$O,s$n,s$V,s$Q,s$g,s$F,s$E,s$I,s$Y,s$k,s$h||0<s$u&&0==s$s)}return s$Y},s$d.addBeforePosition=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$L[s$l],s$N=s$L[s$l+1],s$m=s$L[s$l+2]-s$_,s$u=s$L[s$l+3]-s$N,s$x=Math.atan2(s$u,s$m);s$Z[s$h]=s$_+s$d*Math.cos(s$x),s$Z[s$h+1]=s$N+s$d*Math.sin(s$x),s$Z[s$h+2]=s$x},s$d.addAfterPosition=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$L[s$l+2],s$N=s$L[s$l+3],s$m=s$_-s$L[s$l],s$u=s$N-s$L[s$l+1],s$x=Math.atan2(s$u,s$m);s$Z[s$h]=s$_+s$d*Math.cos(s$x),s$Z[s$h+1]=s$N+s$d*Math.sin(s$x),s$Z[s$h+2]=s$x},s$d.addCurvePosition=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t,s$b){0==s$d&&(s$d=1e-4);var s$q=s$d*s$d,s$Y=s$q*s$d,s$c=1-s$d,s$r=s$c*s$c,s$a=s$r*s$c,s$k=s$c*s$d,s$e=3*s$k,s$w=s$c*s$e,s$s=s$e*s$d,s$A=s$L*s$a+s$Z*s$w+s$_*s$s+s$m*s$Y,s$y=s$l*s$a+s$h*s$w+s$N*s$s+s$u*s$Y;s$x[s$t]=s$A,s$x[s$t+1]=s$y,s$x[s$t+2]=s$b?Math.atan2(s$y-(s$l*s$r+s$h*s$k*2+s$N*s$q),s$A-(s$L*s$r+s$Z*s$k*2+s$_*s$q)):0},s$p.NONE=-1,s$p.BEFORE=-2,s$p.AFTER=-3,s$l(s$p,["_tempMt",function(){return this._tempMt=new s$Ed}]),s$p}(),s$Bd=function(){function s$d(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return s$Z(s$d,"laya.ani.bone.PathConstraintData"),s$d}(),s$Cd=function(){function s$d(){this.name=null,this.slotArr=[]}return s$Z(s$d,"laya.ani.bone.SkinData"),s$d}(),s$Pd=function(){function s$d(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}s$Z(s$d,"laya.ani.bone.SkinSlotDisplayData");var s$L=s$d.prototype;return s$L.createTexture=function(s$d){return this.texture||(this.texture=new s$Id(s$d.bitmap,this.uvs),s$d.bitmap.alphaTexture&&(this.texture.alphaTexture=new s$Id(s$d.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=s$d.height,this.texture.height=s$d.width,this.texture.offsetX=-s$d.offsetX,this.texture.offsetY=-s$d.offsetY,this.texture.sourceWidth=s$d.sourceHeight,this.texture.sourceHeight=s$d.sourceWidth):(this.texture.width=s$d.width,this.texture.height=s$d.height,this.texture.offsetX=-s$d.offsetX,this.texture.offsetY=-s$d.offsetY,this.texture.sourceWidth=s$d.sourceWidth,this.texture.sourceHeight=s$d.sourceHeight),s$a.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},s$L.destory=function(){this.texture&&this.texture.destroy()},s$d}(),s$Td=function(){function s$d(){this.name=null,this.displayArr=[]}return s$Z(s$d,"laya.ani.bone.SlotData"),s$d.prototype.getDisplayByName=function(s$d){for(var s$L=0,s$l=this.displayArr.length;s$L<s$l;s$L++)if(this.displayArr[s$L].attachmentName==s$d)return s$L;return-1},s$d}(),s$y=function(){function s$d(s$d,s$L){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=s$r(2,0),this._data=s$d,null==this._bones&&(this._bones=[]),this.target=s$L[s$d.targetIndex];var s$l,s$Z=0;for(s$Z=0,s$l=s$d.boneIndexs.length;s$Z<s$l;s$Z++)this._bones.push(s$L[s$d.boneIndexs[s$Z]]);this.rotateMix=s$d.rotateMix,this.translateMix=s$d.translateMix,this.scaleMix=s$d.scaleMix,this.shearMix=s$d.shearMix}return s$Z(s$d,"laya.ani.bone.TfConstraint"),s$d.prototype.apply=function(){for(var s$d,s$L=this.target.resultMatrix.a,s$l=this.target.resultMatrix.b,s$Z=this.target.resultMatrix.c,s$h=this.target.resultMatrix.d,s$_=0,s$N=this._bones.length;s$_<s$N;s$_++){if(s$d=this._bones[s$_],0<this.rotateMix){var s$m=s$d.resultMatrix.a,s$u=s$d.resultMatrix.b,s$x=s$d.resultMatrix.c,s$t=s$d.resultMatrix.d,s$b=Math.atan2(s$Z,s$L)-Math.atan2(s$x,s$m)+this._data.offsetRotation*Math.PI/180;s$b>Math.PI?s$b-=2*Math.PI:s$b<-Math.PI&&(s$b+=2*Math.PI),s$b*=this.rotateMix;var s$q=Math.cos(s$b),s$Y=Math.sin(s$b);s$d.resultMatrix.a=s$q*s$m-s$Y*s$x,s$d.resultMatrix.b=s$q*s$u-s$Y*s$t,s$d.resultMatrix.c=s$Y*s$m+s$q*s$x,s$d.resultMatrix.d=s$Y*s$u+s$q*s$t}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),s$d.resultMatrix.tx+=(this._temp[0]-s$d.resultMatrix.tx)*this.translateMix,s$d.resultMatrix.ty+=(this._temp[1]-s$d.resultMatrix.ty)*this.translateMix,s$d.updateChild()),0<this.scaleMix){var s$c=Math.sqrt(s$d.resultMatrix.a*s$d.resultMatrix.a+s$d.resultMatrix.c*s$d.resultMatrix.c),s$r=Math.sqrt(s$L*s$L+s$Z*s$Z),s$a=1e-5<s$c?(s$c+(s$r-s$c+this._data.offsetScaleX)*this.scaleMix)/s$c:0;s$d.resultMatrix.a*=s$a,s$d.resultMatrix.c*=s$a,s$c=Math.sqrt(s$d.resultMatrix.b*s$d.resultMatrix.b+s$d.resultMatrix.d*s$d.resultMatrix.d),s$r=Math.sqrt(s$l*s$l+s$h*s$h),s$a=1e-5<s$c?(s$c+(s$r-s$c+this._data.offsetScaleY)*this.scaleMix)/s$c:0,s$d.resultMatrix.b*=s$a,s$d.resultMatrix.d*=s$a}if(0<this.shearMix){s$u=s$d.resultMatrix.b,s$t=s$d.resultMatrix.d;var s$k=Math.atan2(s$t,s$u);(s$b=Math.atan2(s$h,s$l)-Math.atan2(s$Z,s$L)-(s$k-Math.atan2(s$d.resultMatrix.c,s$d.resultMatrix.a)))>Math.PI?s$b-=2*Math.PI:s$b<-Math.PI&&(s$b+=2*Math.PI),s$b=s$k+(s$b+this._data.offsetShearY*Math.PI/180)*this.shearMix,s$a=Math.sqrt(s$u*s$u+s$t*s$t),s$d.resultMatrix.b=Math.cos(s$b)*s$a,s$d.resultMatrix.d=Math.sin(s$b)*s$a}}},s$d}(),s$zd=function(){function s$d(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return s$Z(s$d,"laya.ani.bone.TfConstraintData"),s$d}(),s$Dd=function(){function s$d(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}s$Z(s$d,"laya.ani.bone.Transform");var s$L=s$d.prototype;return s$L.initData=function(s$d){null!=s$d.x&&(this.x=s$d.x),null!=s$d.y&&(this.y=s$d.y),null!=s$d.skX&&(this.skX=s$d.skX),null!=s$d.skY&&(this.skY=s$d.skY),null!=s$d.scX&&(this.scX=s$d.scX),null!=s$d.scY&&(this.scY=s$d.scY)},s$L.getMatrix=function(){var s$d;return(s$d=this.mMatrix?this.mMatrix:this.mMatrix=new s$Ed).identity(),s$d.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(s$d,this.skewX*Math.PI/180,this.skewY*Math.PI/180),s$d.rotate(this.skX*Math.PI/180),s$d.translate(this.x,this.y),s$d},s$L.skew=function(s$d,s$L,s$l){var s$Z=Math.sin(s$l),s$h=Math.cos(s$l),s$_=Math.sin(s$L),s$N=Math.cos(s$L);return s$d.setTo(s$d.a*s$N-s$d.b*s$Z,s$d.a*s$_+s$d.b*s$h,s$d.c*s$N-s$d.d*s$Z,s$d.c*s$_+s$d.d*s$h,s$d.tx*s$N-s$d.ty*s$Z,s$d.tx*s$_+s$d.ty*s$h),s$d},s$d}(),s$$=function(){function s$d(){}return s$Z(s$d,"laya.ani.bone.UVTools"),s$d.getRelativeUV=function(s$d,s$L,s$l){var s$Z=s$d[0],s$h=s$d[2]-s$d[0],s$_=s$d[1],s$N=s$d[5]-s$d[1];s$l||(s$l=[]),s$l.length=s$L.length;var s$m,s$u=0;s$m=s$l.length;var s$x=1/s$h,s$t=1/s$N;for(s$u=0;s$u<s$m;s$u+=2)s$l[s$u]=(s$L[s$u]-s$Z)*s$x,s$l[s$u+1]=(s$L[s$u+1]-s$_)*s$t;return s$l},s$d.getAbsoluteUV=function(s$d,s$L,s$l){if(0==s$d[0]&&0==s$d[1]&&1==s$d[4]&&1==s$d[5])return s$l?(s$k.copyArray(s$l,s$L),s$l):s$L;var s$Z=s$d[0],s$h=s$d[2]-s$d[0],s$_=s$d[1],s$N=s$d[5]-s$d[1];s$l||(s$l=[]),s$l.length=s$L.length;var s$m,s$u=0;for(s$m=s$l.length,s$u=0;s$u<s$m;s$u+=2)s$l[s$u]=s$L[s$u]*s$h+s$Z,s$l[s$u+1]=s$L[s$u+1]*s$N+s$_;return s$l},s$d}(),s$p=function(){function s$d(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return s$Z(s$d,"laya.ani.KeyFramesContent"),s$d}(),s$O=function(){function s$t(){}return s$Z(s$t,"laya.ani.math.BezierLerp"),s$t.getBezierRate=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$t._getBezierParamKey(s$L,s$l,s$Z,s$h),s$N=100*s$_+s$d;if(s$t._bezierResultCache[s$N])return s$t._bezierResultCache[s$N];var s$m,s$u=s$t._getBezierPoints(s$L,s$l,s$Z,s$h,s$_),s$x=0;for(s$m=s$u.length,s$x=0;s$x<s$m;s$x+=2)if(s$d<=s$u[s$x])return s$t._bezierResultCache[s$N]=s$u[s$x+1],s$u[s$x+1];return s$t._bezierResultCache[s$N]=1},s$t._getBezierParamKey=function(s$d,s$L,s$l,s$Z){return 100*(100*(100*(100*s$d+s$L)+s$l)+s$Z)},s$t._getBezierPoints=function(s$d,s$L,s$l,s$Z,s$h){return s$t._bezierPointsCache[s$h]?s$t._bezierPointsCache[s$h]:(s$_=[0,0,s$d,s$L,s$l,s$Z,1,1],s$N=(new s$m).getBezierPoints(s$_,100,3),s$t._bezierPointsCache[s$h]=s$N);var s$_,s$N},s$t._bezierResultCache={},s$t._bezierPointsCache={},s$t}(),s$n=function(s$d){function s$L(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,s$L.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}s$Z(s$L,"laya.ani.AnimationPlayer",s$h);var s$l=s$L.prototype;return s$hd.imps(s$l,{"laya.resource.IDestroy":!0}),s$l._onTempletLoadedComputeFullKeyframeIndices=function(s$d,s$L,s$l){this._templet===s$l&&this._cachePlayRate===s$d&&this._cacheFrameRate===s$L&&this._computeFullKeyframeIndices()},s$l._computeFullKeyframeIndices=function(){for(var s$d=this._fullFrames=[],s$L=this._templet,s$l=this._cacheFrameRateInterval*this._cachePlayRate,s$Z=0,s$h=s$L.getAnimationCount();s$Z<s$h;s$Z++){for(var s$_=[],s$N=0,s$m=s$L.getAnimation(s$Z).nodes.length;s$N<s$m;s$N++){for(var s$u=s$L.getAnimation(s$Z).nodes[s$N],s$x=Math.floor(s$u.playTime/s$l+.01),s$t=new Uint16Array(s$x+1),s$b=-1,s$q=0,s$Y=s$u.keyFrame.length;s$q<s$Y;s$q++){var s$c=s$u.keyFrame[s$q],s$r=s$c.startTime,s$a=s$r+s$c.duration+s$l;do{for(var s$k=Math.floor(s$r/s$l+.5),s$e=s$b+1;s$e<s$k;s$e++)s$t[s$e]=s$q;s$t[s$b=s$k]=s$q,s$r+=s$l}while(s$r<=s$a)}s$_.push(s$t)}s$d.push(s$_)}},s$l._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},s$l._calculatePlayDuration=function(){if(0!==this.state){var s$d=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=s$d),this._playEnd>s$d&&(this._playEnd=s$d),this._playDuration=this._playEnd-this._playStart}},s$l._setPlayParams=function(s$d,s$L){this._currentTime=s$d,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/s$L+.01),0),this._currentFrameTime=this._currentKeyframeIndex*s$L},s$l._setPlayParamsWhenStop=function(s$d,s$L){this._currentTime=s$d,this._currentKeyframeIndex=Math.max(Math.floor(s$d/s$L+.01),0),this._currentFrameTime=this._currentKeyframeIndex*s$L,this._currentAnimationClipIndex=-1},s$l._update=function(s$d){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var s$L=this._cacheFrameRateInterval*this._cachePlayRate,s$l=0;this._startUpdateLoopCount!==s$c.loopCount&&(s$l=s$d*this.playbackRate,this._elapsedPlaybackTime+=s$l);var s$Z=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=s$Z)return this._setPlayParamsWhenStop(s$Z,s$L),void this.event("stopped");if(s$l+=this._currentTime,0<s$Z)if(s$Z<=s$l)do{if(s$l-=s$Z,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(s$Z,s$L),this._stopWhenCircleFinish=!1,void this.event("stopped");s$l<s$Z&&(this._setPlayParams(s$l,s$L),this.event("complete"))}while(s$Z<=s$l);else this._setPlayParams(s$l,s$L);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(s$Z,s$L),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},s$l._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},s$l.play=function(s$d,s$L,s$l,s$Z,s$h){if(void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=1),void 0===s$l&&(s$l=2147483647),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(s$l<0||s$Z<0||s$h<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==s$h&&s$h<s$Z)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=s$L,this._overallDuration=s$l,this._playStart=s$Z,this._playEnd=s$h,this._paused=!1,this._currentAnimationClipIndex=s$d,this._currentKeyframeIndex=0,this._startUpdateLoopCount=s$c.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},s$l.playByFrame=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$d&&(s$d=0),void 0===s$L&&(s$L=1),void 0===s$l&&(s$l=2147483647),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=30);var s$N=1e3/s$_;this.play(s$d,s$L,s$l,s$Z*s$N,s$h*s$N)},s$l.stop=function(s$d){void 0===s$d&&(s$d=!0),s$d?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},s$_(0,s$l,"playEnd",function(){return this._playEnd}),s$_(0,s$l,"templet",function(){return this._templet},function(s$d){0===!this.state&&this.stop(!0),this._templet!==s$d&&((this._templet=s$d).loaded?this._computeFullKeyframeIndices():s$d.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),s$_(0,s$l,"playStart",function(){return this._playStart}),s$_(0,s$l,"playDuration",function(){return this._playDuration}),s$_(0,s$l,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),s$_(0,s$l,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),s$_(0,s$l,"overallDuration",function(){return this._overallDuration}),s$_(0,s$l,"currentFrameTime",function(){return this._currentFrameTime}),s$_(0,s$l,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),s$_(0,s$l,"currentPlayTime",function(){return this._currentTime+this._playStart}),s$_(0,s$l,"cachePlayRate",function(){return this._cachePlayRate},function(s$d){this._cachePlayRate!==s$d&&(this._cachePlayRate=s$d,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[s$d,this._cacheFrameRate])))}),s$_(0,s$l,"cacheFrameRate",function(){return this._cacheFrameRate},function(s$d){this._cacheFrameRate!==s$d&&(this._cacheFrameRate=s$d,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,s$d])))}),s$_(0,s$l,"currentTime",null,function(s$d){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(s$d<this._playStart||s$d>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=s$c.loopCount;var s$L=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=s$d,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/s$L),0),this._currentFrameTime=this._currentKeyframeIndex*s$L}}),s$_(0,s$l,"paused",function(){return this._paused},function(s$d){(this._paused=s$d)&&this.event("paused")}),s$_(0,s$l,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),s$_(0,s$l,"destroyed",function(){return this._destroyed}),s$L}(),s$H=function(s$d){function s$L(){s$L.__super.call(this),s$a.isConchNode&&(this.drawSkin=function(s$d){s$d.transform||(s$d.transform=s$Ed.EMPTY),this._addCmd([s$d]),this.setSkinMesh&&this.setSkinMesh(s$d._ps,s$d.mVBData,s$d.mEleNum,0,s$d.mTexture,s$d.transform)})}return s$Z(s$L,"laya.ani.GraphicsAni",s$N),s$L.prototype.drawSkin=function(s$d){var s$L=[s$d];this._saveToCmd(s$a._context._drawSkin,s$L)},s$L.create=function(){return s$L._caches.pop()||new s$L},s$L.recycle=function(s$d){s$d.clear(),s$L._caches.push(s$d)},s$L._caches=[],s$L}(),s$X=function(s$d){function s$e(){this._aniMap={},this.unfixedLastAniIndex=-1,s$e.__super.call(this),this._anis=new Array}s$Z(s$e,"laya.ani.AnimationTemplet",s$t);var s$L=s$e.prototype;return s$L.parse=function(s$d){var s$L=new s$Fd(s$d);this._aniVersion=s$L.readUTFString(),s$w.parse(this,s$L)},s$L._calculateKeyFrame=function(s$d,s$L,s$l){var s$Z=s$d.keyFrame;s$Z[s$L]=s$Z[0];for(var s$h=0;s$h<s$L;s$h++){var s$_=s$Z[s$h];s$_.nextData=0===s$_.duration?s$_.data:s$Z[s$h+1].data}s$Z.length--},s$L.onAsynLoaded=function(s$d,s$L,s$l){var s$Z=new s$Fd(s$L);switch(this._aniVersion=s$Z.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":s$s.parse(this,s$Z);break;default:s$w.parse(this,s$Z)}this._endLoaded()},s$L.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},s$L.getAnimationCount=function(){return this._anis.length},s$L.getAnimation=function(s$d){return this._anis[s$d]},s$L.getAniDuration=function(s$d){return this._anis[s$d].playTime},s$L.getNodes=function(s$d){return this._anis[s$d].nodes},s$L.getNodeIndexWithName=function(s$d,s$L){return this._anis[s$d].bone3DMap[s$L]},s$L.getNodeCount=function(s$d){return this._anis[s$d].nodes.length},s$L.getTotalkeyframesLength=function(s$d){return this._anis[s$d].totalKeyframeDatasLength},s$L.getPublicExtData=function(){return this._publicExtData},s$L.getAnimationDataWithCache=function(s$d,s$L,s$l,s$Z){var s$h=s$L[s$l];if(s$h){var s$_=s$h[s$d];return s$_?s$_[s$Z]:null}return null},s$L.setAnimationDataWithCache=function(s$d,s$L,s$l,s$Z,s$h){var s$_=s$L[s$l]||(s$L[s$l]={});(s$_[s$d]||(s$_[s$d]=[]))[s$Z]=s$h},s$L.getOriginalData=function(s$d,s$L,s$l,s$Z,s$h){for(var s$_=this._anis[s$d].nodes,s$N=0,s$m=0,s$u=s$_.length,s$x=0;s$m<s$u;s$m++){var s$t,s$b=s$_[s$m];s$t=s$b.keyFrame[s$l[s$m][s$Z]],s$b.dataOffset=s$x;var s$q=s$h-s$t.startTime,s$Y=s$b.lerpType;if(s$Y)switch(s$Y){case 0:case 1:for(s$N=0;s$N<s$b.keyframeWidth;)s$N+=s$b.interpolationMethod[s$N](s$b,s$N,s$L,s$x+s$N,s$t.data,s$q,null,s$t.duration,s$t.nextData);break;case 2:var s$c=s$t.interpolationData,s$r=s$c.length,s$a=0;for(s$N=0;s$N<s$r;){var s$k=s$c[s$N];switch(s$k){case 6:case 7:s$N+=s$e.interpolation[s$k](s$b,s$a,s$L,s$x+s$a,s$t.data,s$q,null,s$t.duration,s$t.nextData,s$c,s$N+1);break;default:s$N+=s$e.interpolation[s$k](s$b,s$a,s$L,s$x+s$a,s$t.data,s$q,null,s$t.duration,s$t.nextData)}s$a++}}else for(s$N=0;s$N<s$b.keyframeWidth;)s$N+=s$b.interpolationMethod[s$N](s$b,s$N,s$L,s$x+s$N,s$t.data,s$q,null,s$t.duration,s$t.nextData);s$x+=s$b.keyframeWidth}},s$L.getNodesCurrentFrameIndex=function(s$d,s$L){var s$l=this._anis[s$d].nodes;s$d!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(s$l.length),this.unfixedCurrentTimes=new Float32Array(s$l.length),this.unfixedLastAniIndex=s$d);for(var s$Z=0,s$h=s$l.length;s$Z<s$h;s$Z++){var s$_=s$l[s$Z];for(s$L<this.unfixedCurrentTimes[s$Z]&&(this.unfixedCurrentFrameIndexes[s$Z]=0),this.unfixedCurrentTimes[s$Z]=s$L;this.unfixedCurrentFrameIndexes[s$Z]<s$_.keyFrame.length&&!(s$_.keyFrame[this.unfixedCurrentFrameIndexes[s$Z]].startTime>this.unfixedCurrentTimes[s$Z]);)this.unfixedCurrentFrameIndexes[s$Z]++;this.unfixedCurrentFrameIndexes[s$Z]--}return this.unfixedCurrentFrameIndexes},s$L.getOriginalDataUnfixedRate=function(s$d,s$L,s$l){var s$Z=this._anis[s$d].nodes;s$d!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(s$Z.length),this.unfixedCurrentTimes=new Float32Array(s$Z.length),this.unfixedKeyframes=s$r(s$Z.length),this.unfixedLastAniIndex=s$d);for(var s$h=0,s$_=0,s$N=s$Z.length,s$m=0;s$_<s$N;s$_++){var s$u=s$Z[s$_];for(s$l<this.unfixedCurrentTimes[s$_]&&(this.unfixedCurrentFrameIndexes[s$_]=0),this.unfixedCurrentTimes[s$_]=s$l;this.unfixedCurrentFrameIndexes[s$_]<s$u.keyFrame.length&&!(s$u.keyFrame[this.unfixedCurrentFrameIndexes[s$_]].startTime>this.unfixedCurrentTimes[s$_]);)this.unfixedKeyframes[s$_]=s$u.keyFrame[this.unfixedCurrentFrameIndexes[s$_]],this.unfixedCurrentFrameIndexes[s$_]++;var s$x=this.unfixedKeyframes[s$_];s$u.dataOffset=s$m;var s$t=s$l-s$x.startTime;if(s$u.lerpType)switch(s$u.lerpType){case 0:case 1:for(s$h=0;s$h<s$u.keyframeWidth;)s$h+=s$u.interpolationMethod[s$h](s$u,s$h,s$L,s$m+s$h,s$x.data,s$t,null,s$x.duration,s$x.nextData);break;case 2:var s$b=s$x.interpolationData,s$q=s$b.length,s$Y=0;for(s$h=0;s$h<s$q;){var s$c=s$b[s$h];switch(s$c){case 6:case 7:s$h+=s$e.interpolation[s$c](s$u,s$Y,s$L,s$m+s$Y,s$x.data,s$t,null,s$x.duration,s$x.nextData,s$b,s$h+1);break;default:s$h+=s$e.interpolation[s$c](s$u,s$Y,s$L,s$m+s$Y,s$x.data,s$t,null,s$x.duration,s$x.nextData)}s$Y++}}else for(s$h=0;s$h<s$u.keyframeWidth;)s$h+=s$u.interpolationMethod[s$h](s$u,s$h,s$L,s$m+s$h,s$x.data,s$t,null,s$x.duration,s$x.nextData);s$m+=s$u.keyframeWidth}},s$e._LinearInterpolation_0=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){var s$t=0===s$m?0:s$_/s$m;return s$l[s$Z]=(1-s$t)*s$h[s$L]+s$t*s$u[s$L],1},s$e._QuaternionInterpolation_1=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){var s$t=0===s$m?0:s$_/s$m;return s$q.slerpQuaternionArray(s$h,s$L,s$u,s$L,s$t,s$l,s$Z),4},s$e._AngleInterpolation_2=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return 0},s$e._RadiansInterpolation_3=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return 0},s$e._Matrix4x4Interpolation_4=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){for(var s$t=0;s$t<16;s$t++,s$L++)s$l[s$Z+s$t]=s$h[s$L]+s$_*s$N[s$L];return 16},s$e._NoInterpolation_5=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x){return s$l[s$Z]=s$h[s$L],1},s$e._BezierInterpolation_6=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t){return void 0===s$t&&(s$t=0),s$l[s$Z]=s$h[s$L]+(s$u[s$L]-s$h[s$L])*s$O.getBezierRate(s$_/s$m,s$x[s$t],s$x[s$t+1],s$x[s$t+2],s$x[s$t+3]),5},s$e._BezierInterpolation_7=function(s$d,s$L,s$l,s$Z,s$h,s$_,s$N,s$m,s$u,s$x,s$t){return void 0===s$t&&(s$t=0),s$l[s$Z]=s$x[s$t+4]+s$x[s$t+5]*s$O.getBezierRate((.001*s$_+s$x[s$t+6])/s$x[s$t+7],s$x[s$t],s$x[s$t+1],s$x[s$t+2],s$x[s$t+3]),9},s$e.load=function(s$d){return s$hd.loader.create(s$d,null,null,s$e)},s$e.interpolation=[s$e._LinearInterpolation_0,s$e._QuaternionInterpolation_1,s$e._AngleInterpolation_2,s$e._RadiansInterpolation_3,s$e._Matrix4x4Interpolation_4,s$e._NoInterpolation_5,s$e._BezierInterpolation_6,s$e._BezierInterpolation_7],s$e}(),s$V=function(s$L){function s$l(s$d,s$L){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,s$l.__super.call(this),void 0===s$L&&(s$L=0),s$d&&this.init(s$d,s$L)}s$Z(s$l,"laya.ani.bone.Skeleton",s$L);var s$d=s$l.prototype;return s$d.init=function(s$d,s$L){void 0===s$L&&(s$L=0);var s$l,s$Z,s$h,s$_=0,s$N=0;if(1==s$L)for(this._graphicsCache=[],s$_=0,s$N=s$d.getAnimationCount();s$_<s$N;s$_++)this._graphicsCache.push([]);if(this._yReverseMatrix=s$d.yReverseMatrix,this._aniMode=s$L,this._templet=s$d,this._player=new s$n,this._player.cacheFrameRate=s$d.rate,this._player.templet=s$d,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=s$d.mBoneArr,this._rootBone=s$d.mRootBone,this._aniSectionDic=s$d.aniSectionDic,0<s$d.ikArr.length)for(this._ikArr=[],s$_=0,s$N=s$d.ikArr.length;s$_<s$N;s$_++)this._ikArr.push(new s$e(s$d.ikArr[s$_],this._boneList));if(0<s$d.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),s$_=0,s$N=s$d.pathArr.length;s$_<s$N;s$_++)s$l=s$d.pathArr[s$_],s$Z=new s$A(s$l,this._boneList),(s$h=this._boneSlotDic[s$l.name])&&((s$Z=new s$A(s$l,this._boneList)).target=s$h),this._pathDic[s$l.name]=s$Z;if(0<s$d.tfArr.length)for(this._tfArr=[],s$_=0,s$N=s$d.tfArr.length;s$_<s$N;s$_++)this._tfArr.push(new s$y(s$d.tfArr[s$_],this._boneList));if(0<s$d.skinDataArray.length){var s$m=this._templet.skinDataArray[this._skinIndex];this._skinName=s$m.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},s$d.load=function(s$d,s$L,s$l){},s$d._onLoaded=function(){},s$d._parseComplete=function(){var s$d=s$Q.TEMPLET_DICTIONARY[this._aniPath];s$d&&(this.init(s$d,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},s$d._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},s$d._onPlay=function(){this.event("played")},s$d._onStop=function(){var s$d,s$L=this._templet.eventAniArr[this._aniClipIndex];if(s$L&&this._eventIndex<s$L.length)for(;this._eventIndex<s$L.length;this._eventIndex++)(s$d=s$L[this._eventIndex]).time>=this._player.playStart&&s$d.time<=this._player.playEnd&&this.event("label",s$d);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},s$d._onPause=function(){this.event("paused")},s$d._parseSrcBoneMatrix=function(){var s$d=0,s$L=0;for(s$L=this._templet.srcBoneMatrixArr.length,s$d=0;s$d<s$L;s$d++)this._boneMatrixArray.push(new s$Ed);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var s$l,s$Z,s$h=this._templet.boneSlotArray;for(s$d=0,s$L=s$h.length;s$d<s$L;s$d++)s$l=s$h[s$d],null==(s$Z=this._bindBoneBoneSlotDic[s$l.parent])&&(this._bindBoneBoneSlotDic[s$l.parent]=s$Z=[]),this._boneSlotDic[s$l.name]=s$l=s$l.copy(),s$Z.push(s$l),this._boneSlotArray.push(s$l)}},s$d._emitMissedEvents=function(s$d,s$L,s$l){void 0===s$l&&(s$l=0);var s$Z=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(s$Z){var s$h,s$_,s$N=0;for(s$h=s$Z.length,s$N=s$l;s$N<s$h;s$N++)(s$_=s$Z[s$N]).time>=this._player.playStart&&s$_.time<=this._player.playEnd&&this.event("label",s$_)}},s$d._update=function(s$d){if(void 0===s$d&&(s$d=!0),!(this._pause||s$d&&this._indexControl)){var s$L=this.timer.currTimer,s$l=this._player.currentKeyframeIndex,s$Z=s$L-this._lastTime;if(s$d?this._player._update(s$Z):s$l=-1,this._lastTime=s$L,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<s$Z&&this._clipIndex==s$l&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var s$h;this._lastUpdateAniClipIndex=this._aniClipIndex,s$l>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var s$_,s$N=this._templet.eventAniArr[this._aniClipIndex];if(s$N&&this._eventIndex<s$N.length&&((s$h=s$N[this._eventIndex]).time>=this._player.playStart&&s$h.time<=this._player.playEnd?this._player.currentPlayTime>=s$h.time&&(this.event("label",s$h),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(s$_=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=s$_&&(this.graphics=s$_));var s$m=0,s$u=0;for(s$u=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,s$u-1)&&0<s$u;)s$u--;if(s$u<this._clipIndex)for(s$m=s$u;s$m<this._clipIndex;s$m++)this._createGraphics(s$m)}else if(1==this._aniMode){if(s$_=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=s$_&&(this.graphics=s$_));for(s$u=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,s$u-1)&&0<s$u;)s$u--;if(s$u<this._clipIndex)for(s$m=s$u;s$m<this._clipIndex;s$m++)this._createGraphics(s$m)}this._createGraphics()}}},s$d._createGraphics=function(s$d){void 0===s$d&&(s$d=-1),-1==s$d&&(s$d=this._clipIndex);var s$L,s$l,s$Z=s$d*this._player.cacheFrameRateInterval,s$h=this._templet.drawOrderAniArr[this._aniClipIndex];if(s$h&&0<s$h.length)for(this._drawOrderIndex=0,s$L=s$h[this._drawOrderIndex];s$Z>=s$L.time&&(this._drawOrder=s$L.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=s$h.length));)s$L=s$h[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=s$H.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=s$H.create(),s$l=this.graphics;var s$_=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],s$d,s$Z);var s$N,s$m,s$u,s$x,s$t=this._aniSectionDic[this._aniClipIndex],s$b=0,s$q=0,s$Y=0,s$c=0,s$r=0,s$a=this._templet.srcBoneMatrixArr.length;for(s$r=s$t[s$q=0];s$q<s$a;s$q++)s$x=this._boneList[s$q],s$u=this._templet.srcBoneMatrixArr[s$q],s$x.resultTransform.scX=s$u.scX*this._curOriginalData[s$b++],s$x.resultTransform.skX=s$u.skX+this._curOriginalData[s$b++],s$x.resultTransform.skY=s$u.skY+this._curOriginalData[s$b++],s$x.resultTransform.scY=s$u.scY*this._curOriginalData[s$b++],s$x.resultTransform.x=s$u.x+this._curOriginalData[s$b++],s$x.resultTransform.y=s$u.y+this._curOriginalData[s$b++],8===this._templet.tMatrixDataLen&&(s$x.resultTransform.skewX=s$u.skewX+this._curOriginalData[s$b++],s$x.resultTransform.skewY=s$u.skewY+this._curOriginalData[s$b++]);var s$k,s$e={},s$w={};for(s$r+=s$t[1];s$q<s$r;s$q++)s$e[(s$k=s$_[s$q]).name]=this._curOriginalData[s$b++],s$w[s$k.name]=this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++];var s$s,s$A,s$y={},s$$={};for(s$r+=s$t[2];s$q<s$r;s$q++)s$y[(s$k=s$_[s$q]).name]=this._curOriginalData[s$b++],s$$[s$k.name]=this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++],this._curOriginalData[s$b++];if(this._pathDic)for(s$r+=s$t[3];s$q<s$r;s$q++){if(s$k=s$_[s$q],s$s=this._pathDic[s$k.name])switch(new s$Fd(s$k.extenData).getByte()){case 1:s$s.position=this._curOriginalData[s$b++];break;case 2:s$s.spacing=this._curOriginalData[s$b++];break;case 3:s$s.rotateMix=this._curOriginalData[s$b++],s$s.translateMix=this._curOriginalData[s$b++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(s$Ed.TEMP.identity()),this._ikArr)for(s$q=0,s$r=this._ikArr.length;s$q<s$r;s$q++)s$A=this._ikArr[s$q],s$y.hasOwnProperty(s$A.name)&&(s$A.bendDirection=s$y[s$A.name]),s$$.hasOwnProperty(s$A.name)&&(s$A.mix=s$$[s$A.name]),s$A.apply();if(this._pathDic)for(var s$O in this._pathDic)(s$s=this._pathDic[s$O]).apply(this._boneList,s$l);if(this._tfArr)for(s$q=0,s$c=this._tfArr.length;s$q<s$c;s$q++)this._tfArr[s$q].apply();for(s$q=0,s$c=this._boneList.length;s$q<s$c;s$q++)if(s$x=this._boneList[s$q],s$m=this._bindBoneBoneSlotDic[s$x.name],s$x.resultMatrix.copyTo(this._boneMatrixArray[s$q]),s$m)for(s$Y=0,s$r=s$m.length;s$Y<s$r;s$Y++)(s$N=s$m[s$Y])&&s$N.setParentMatrix(s$x.resultMatrix);var s$n,s$V,s$Q,s$g,s$F={},s$E=this._templet.deformAniArr;if(s$E&&0<s$E.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,s$q=0,s$r=this._boneSlotArray.length;s$q<s$r;s$q++)(s$N=this._boneSlotArray[s$q]).deformData=null;var s$I,s$p=s$E[this._aniClipIndex];for(s$I in s$n=s$p.default,this._setDeform(s$n,s$F,this._boneSlotArray,s$Z),s$p)"default"!=s$I&&s$I!=this._skinName&&(s$n=s$p[s$I],this._setDeform(s$n,s$F,this._boneSlotArray,s$Z));s$n=s$p[this._skinName],this._setDeform(s$n,s$F,this._boneSlotArray,s$Z)}if(this._drawOrder)for(s$q=0,s$r=this._drawOrder.length;s$q<s$r;s$q++)s$V=s$e[(s$N=this._boneSlotArray[this._drawOrder[s$q]]).name],s$Q=s$w[s$N.name],isNaN(s$Q)||(s$l.save(),s$l.alpha(s$Q)),isNaN(s$V)||-2==s$V||(this._templet.attachmentNames?s$N.showDisplayByName(this._templet.attachmentNames[s$V]):s$N.showDisplayByIndex(s$V)),s$F[this._drawOrder[s$q]]?(s$g=s$F[this._drawOrder[s$q]],s$N.currDisplayData&&s$g[s$N.currDisplayData.attachmentName]?s$N.deformData=s$g[s$N.currDisplayData.attachmentName]:s$N.deformData=null):s$N.deformData=null,isNaN(s$Q)?s$N.draw(s$l,this._boneMatrixArray,2==this._aniMode):s$N.draw(s$l,this._boneMatrixArray,2==this._aniMode,s$Q),isNaN(s$Q)||s$l.restore();else for(s$q=0,s$r=this._boneSlotArray.length;s$q<s$r;s$q++)s$V=s$e[(s$N=this._boneSlotArray[s$q]).name],s$Q=s$w[s$N.name],isNaN(s$Q)||(s$l.save(),s$l.alpha(s$Q)),isNaN(s$V)||-2==s$V||(this._templet.attachmentNames?s$N.showDisplayByName(this._templet.attachmentNames[s$V]):s$N.showDisplayByIndex(s$V)),s$F[s$q]?(s$g=s$F[s$q],s$N.currDisplayData&&s$g[s$N.currDisplayData.attachmentName]?s$N.deformData=s$g[s$N.currDisplayData.attachmentName]:s$N.deformData=null):s$N.deformData=null,isNaN(s$Q)?s$N.draw(s$l,this._boneMatrixArray,2==this._aniMode):s$N.draw(s$l,this._boneMatrixArray,2==this._aniMode,s$Q),isNaN(s$Q)||s$l.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,s$d,s$l):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,s$d,s$l)},s$d._setDeform=function(s$d,s$L,s$l,s$Z){if(s$d){var s$h,s$_,s$N,s$m=0,s$u=0,s$x=0;if(s$d)for(s$m=0,s$u=s$d.deformSlotDataList.length;s$m<s$u;s$m++)for(s$h=s$d.deformSlotDataList[s$m],s$x=0;s$x<s$h.deformSlotDisplayList.length;s$x++)s$N=s$l[(s$_=s$h.deformSlotDisplayList[s$x]).slotIndex],s$_.apply(s$Z,s$N),s$L[s$_.slotIndex]||(s$L[s$_.slotIndex]={}),s$L[s$_.slotIndex][s$_.attachment]=s$_.deformData}},s$d.getAnimNum=function(){return this._templet.getAnimationCount()},s$d.getAniNameByIndex=function(s$d){return this._templet.getAniNameByIndex(s$d)},s$d.getSlotByName=function(s$d){return this._boneSlotDic[s$d]},s$d.showSkinByName=function(s$d,s$L){void 0===s$L&&(s$L=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(s$d),s$L)},s$d.showSkinByIndex=function(s$d,s$L){void 0===s$L&&(s$L=!0);for(var s$l=0;s$l<this._boneSlotArray.length;s$l++)this._boneSlotArray[s$l].showSlotData(null,s$L);if(this._templet.showSkinByIndex(this._boneSlotDic,s$d,s$L)){var s$Z=this._templet.skinDataArray[s$d];this._skinIndex=s$d,this._skinName=s$Z.name}this._clearCache()},s$d.showSlotSkinByIndex=function(s$d,s$L){if(0!=this._aniMode){var s$l=this.getSlotByName(s$d);s$l&&s$l.showDisplayByIndex(s$L),this._clearCache()}},s$d.showSlotSkinByName=function(s$d,s$L){if(0!=this._aniMode){var s$l=this.getSlotByName(s$d);s$l&&s$l.showDisplayByName(s$L),this._clearCache()}},s$d.replaceSlotSkinName=function(s$d,s$L,s$l){if(0!=this._aniMode){var s$Z=this.getSlotByName(s$d);s$Z&&s$Z.replaceDisplayByName(s$L,s$l),this._clearCache()}},s$d.replaceSlotSkinByIndex=function(s$d,s$L,s$l){if(0!=this._aniMode){var s$Z=this.getSlotByName(s$d);s$Z&&s$Z.replaceDisplayByIndex(s$L,s$l),this._clearCache()}},s$d.setSlotSkin=function(s$d,s$L){if(0!=this._aniMode){var s$l=this.getSlotByName(s$d);s$l&&s$l.replaceSkin(s$L),this._clearCache()}},s$d._clearCache=function(){if(1==this._aniMode)for(var s$d=0,s$L=this._graphicsCache.length;s$d<s$L;s$d++){for(var s$l=0,s$Z=this._graphicsCache[s$d].length;s$l<s$Z;s$l++){var s$h=this._graphicsCache[s$d][s$l];s$h!=this.graphics&&s$H.recycle(s$h)}this._graphicsCache[s$d].length=0}},s$d.play=function(s$d,s$L,s$l,s$Z,s$h,s$_){void 0===s$l&&(s$l=!0),void 0===s$Z&&(s$Z=0),void 0===s$h&&(s$h=0),void 0===s$_&&(s$_=!0),this._indexControl=!1;var s$N=-1,s$m=NaN;if(s$m=s$L?2147483647:0,"string"==typeof s$d)for(var s$u=0,s$x=this._templet.getAnimationCount();s$u<s$x;s$u++){var s$t=this._templet.getAnimation(s$u);if(s$t&&s$d==s$t.name){s$N=s$u;break}}else s$N=s$d;-1<s$N&&s$N<this.getAnimNum()&&(this._aniClipIndex=s$N,(s$l||this._pause||this._currAniIndex!=s$N)&&(this._currAniIndex=s$N,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(s$N)),this._drawOrder=null,this._eventIndex=0,this._player.play(s$N,this._player.playbackRate,s$m,s$Z,s$h),s$_&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=s$b.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},s$d.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},s$d.playbackRate=function(s$d){this._player&&(this._player.playbackRate=s$d)},s$d.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},s$d.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=s$b.now(),this.timer.frameLoop(1,this,this._update,null,!0))},s$d._getGrahicsDataWithCache=function(s$d,s$L){return this._graphicsCache[s$d][s$L]},s$d._setGrahicsDataWithCache=function(s$d,s$L,s$l){this._graphicsCache[s$d][s$L]=s$l},s$d.destroy=function(s$d){void 0===s$d&&(s$d=!0),s$L.prototype.destroy.call(this,s$d),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},s$_(0,s$d,"url",function(){return this._aniPath},function(s$d){this.load(s$d)}),s$_(0,s$d,"index",function(){return this._index},function(s$d){this.player&&(this._index=s$d,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),s$_(0,s$d,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),s$_(0,s$d,"templet",function(){return this._templet}),s$_(0,s$d,"player",function(){return this._player}),s$l.useSimpleMeshInCanvas=!1,s$l}(s$_d),s$Q=function(s$L){function s$h(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,s$h.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}s$Z(s$h,"laya.ani.bone.Templet",s$L);var s$d=s$h.prototype;return s$d.getLoadList=function(){return this._loadList},s$d.loadAni=function(s$d){this._skBufferUrl=s$d,s$hd.loader.load(s$d,s$u.create(this,this.onComplete),null,"arraybuffer")},s$d.onComplete=function(s$d){if(this._isDestroyed)this.destroy();else{var s$L=s$x.getRes(this._skBufferUrl);s$L?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,s$L)):this.event("error","load failed:"+this._skBufferUrl)}},s$d.parseData=function(s$d,s$L,s$l){void 0===s$l&&(s$l=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=s$d,this._mainTexture&&s$a.isWebGL&&s$d.bitmap&&(s$d.bitmap.enableMerageInAtlas=!1),this._rate=s$l,this.parse(s$L)},s$d.buildArmature=function(s$d){return void 0===s$d&&(s$d=0),new s$V(this,s$d)},s$d.parse=function(s$d){s$L.prototype.parse.call(this,s$d),this._endLoaded(),this._aniVersion!=s$h.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+s$h.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},s$d._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var s$d=0;this._loadList=[];var s$L,s$l=new s$Fd(this.getPublicExtData()),s$Z=0,s$h=0,s$_=0,s$N=s$l.getInt32(),s$m=s$l.readUTFString(),s$u=s$m.split("\n");for(s$d=0;s$d<s$N;s$d++)s$L=this._path+s$u[2*s$d],s$m=s$u[2*s$d+1],s$l.getFloat32(),s$l.getFloat32(),s$Z=s$l.getFloat32(),s$h=s$l.getFloat32(),s$_=s$l.getFloat32(),isNaN(s$_)?0:s$_,s$_=s$l.getFloat32(),isNaN(s$_)?0:s$_,s$_=s$l.getFloat32(),isNaN(s$_)?s$Z:s$_,s$_=s$l.getFloat32(),isNaN(s$_)?s$h:s$_,-1==this._loadList.indexOf(s$L)&&this._loadList.push(s$L);this.event("inited",this)}},s$d._textureComplete=function(){for(var s$d,s$L,s$l=0,s$Z=this._loadList.length;s$l<s$Z;s$l++)s$L=this._loadList[s$l],s$d=this._textureDic[s$L]=s$x.getRes(s$L),s$a.isWebGL&&s$d&&s$d.bitmap&&(s$d.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},s$d._parsePublicExtData=function(){var s$d=0,s$L=0,s$l=0,s$Z=0,s$h=0;for(s$d=0,s$h=this.getAnimationCount();s$d<s$h;s$d++)this._graphicsCache.push([]);var s$_;s$_="Dragon"!=this._aniClassName;var s$N,s$m,s$u=new s$Fd(this.getPublicExtData()),s$x=0,s$t=0,s$b=0,s$q=0,s$Y=0,s$c=0,s$r=0,s$a=0,s$k=0,s$e=s$u.getInt32(),s$w=s$u.readUTFString(),s$s=s$w.split("\n");for(s$d=0;s$d<s$e;s$d++){if(s$N=this._mainTexture,s$m=this._path+s$s[2*s$d],s$w=s$s[2*s$d+1],null==this._mainTexture&&(s$N=this._textureDic[s$m]),!s$N)return this.event("error",this),void(this.isParseFail=!0);s$x=s$u.getFloat32(),s$t=s$u.getFloat32(),s$b=s$u.getFloat32(),s$q=s$u.getFloat32(),s$k=s$u.getFloat32(),s$Y=isNaN(s$k)?0:s$k,s$k=s$u.getFloat32(),s$c=isNaN(s$k)?0:s$k,s$k=s$u.getFloat32(),s$r=isNaN(s$k)?s$b:s$k,s$k=s$u.getFloat32(),s$a=isNaN(s$k)?s$q:s$k,this.subTextureDic[s$w]=s$Id.create(s$N,s$x,s$t,s$b,s$q,-s$Y,-s$c,s$r,s$a),s$N.alphaTexture&&(this.subTextureDic[s$w].alphaTexture=s$Id.create(s$N.alphaTexture,s$x,s$t,s$b,s$q,-s$Y,-s$c,s$r,s$a))}this._mainTexture=s$N;var s$A,s$y,s$$,s$O,s$n,s$V=s$u.getUint16();for(s$d=0;s$d<s$V;s$d++)(s$A=[]).push(s$u.getUint16()),s$A.push(s$u.getUint16()),s$A.push(s$u.getUint16()),s$A.push(s$u.getUint16()),this.aniSectionDic[s$d]=s$A;var s$Q,s$g=s$u.getInt16(),s$F={};for(s$d=0;s$d<s$g;s$d++)s$y=new s$pd,0==s$d?s$Q=s$y:s$y.root=s$Q,s$y.d=s$_?-1:1,s$O=s$u.readUTFString(),s$n=s$u.readUTFString(),s$y.length=s$u.getFloat32(),1==s$u.getByte()&&(s$y.inheritRotation=!1),1==s$u.getByte()&&(s$y.inheritScale=!1),s$y.name=s$O,s$n&&((s$$=s$F[s$n])?s$$.addChild(s$y):this.mRootBone=s$y),s$F[s$O]=s$y,this.mBoneArr.push(s$y);this.tMatrixDataLen=s$u.getUint16();var s$E,s$I,s$p=s$u.getUint16(),s$H=Math.floor(s$p/this.tMatrixDataLen),s$X=this.srcBoneMatrixArr;for(s$d=0;s$d<s$H;s$d++)(s$E=new s$Dd).scX=s$u.getFloat32(),s$E.skX=s$u.getFloat32(),s$E.skY=s$u.getFloat32(),s$E.scY=s$u.getFloat32(),s$E.x=s$u.getFloat32(),s$E.y=s$u.getFloat32(),8===this.tMatrixDataLen&&(s$E.skewX=s$u.getFloat32(),s$E.skewY=s$u.getFloat32()),s$X.push(s$E),(s$y=this.mBoneArr[s$d]).transform=s$E;var s$j,s$R=s$u.getUint16(),s$o=0;for(s$d=0;s$d<s$R;s$d++){for(s$I=new s$Sd,s$o=s$u.getUint16(),s$L=0;s$L<s$o;s$L++)s$I.boneNames.push(s$u.readUTFString()),s$I.boneIndexs.push(s$u.getInt16());s$I.name=s$u.readUTFString(),s$I.targetBoneName=s$u.readUTFString(),s$I.targetBoneIndex=s$u.getInt16(),s$I.bendDirection=s$u.getFloat32(),s$I.mix=s$u.getFloat32(),s$I.isSpine=s$_,this.ikArr.push(s$I)}var s$i,s$S=s$u.getUint16(),s$B=0;for(s$d=0;s$d<s$S;s$d++){for(s$j=new s$zd,s$B=s$u.getUint16(),s$L=0;s$L<s$B;s$L++)s$j.boneIndexs.push(s$u.getInt16());s$j.name=s$u.getUTFString(),s$j.targetIndex=s$u.getInt16(),s$j.rotateMix=s$u.getFloat32(),s$j.translateMix=s$u.getFloat32(),s$j.scaleMix=s$u.getFloat32(),s$j.shearMix=s$u.getFloat32(),s$j.offsetRotation=s$u.getFloat32(),s$j.offsetX=s$u.getFloat32(),s$j.offsetY=s$u.getFloat32(),s$j.offsetScaleX=s$u.getFloat32(),s$j.offsetScaleY=s$u.getFloat32(),s$j.offsetShearY=s$u.getFloat32(),this.tfArr.push(s$j)}var s$C=s$u.getUint16(),s$P=0;for(s$d=0;s$d<s$C;s$d++){for((s$i=new s$Bd).name=s$u.readUTFString(),s$P=s$u.getUint16(),s$L=0;s$L<s$P;s$L++)s$i.bones.push(s$u.getInt16());s$i.target=s$u.readUTFString(),s$i.positionMode=s$u.readUTFString(),s$i.spacingMode=s$u.readUTFString(),s$i.rotateMode=s$u.readUTFString(),s$i.offsetRotation=s$u.getFloat32(),s$i.position=s$u.getFloat32(),s$i.spacing=s$u.getFloat32(),s$i.rotateMix=s$u.getFloat32(),s$i.translateMix=s$u.getFloat32(),this.pathArr.push(s$i)}var s$T,s$z,s$D,s$G,s$K,s$v=0,s$J=0,s$f=0,s$U=NaN,s$W=0,s$M=s$u.getInt16();for(s$d=0;s$d<s$M;s$d++){var s$dd=s$u.getUint8(),s$Ld={};this.deformAniArr.push(s$Ld);for(var s$ld=0;s$ld<s$dd;s$ld++)for((s$T=new s$Xd).skinName=s$u.getUTFString(),s$Ld[s$T.skinName]=s$T,s$v=s$u.getInt16(),s$L=0;s$L<s$v;s$L++)for(s$z=new s$jd,s$T.deformSlotDataList.push(s$z),s$J=s$u.getInt16(),s$l=0;s$l<s$J;s$l++)for(s$D=new s$Rd,s$z.deformSlotDisplayList.push(s$D),s$D.slotIndex=s$u.getInt16(),s$D.attachment=s$u.getUTFString(),s$f=s$u.getInt16(),s$Z=0;s$Z<s$f;s$Z++)for(1==s$u.getByte()?s$D.tweenKeyList.push(!0):s$D.tweenKeyList.push(!1),s$U=s$u.getFloat32(),s$D.timeList.push(s$U),s$G=[],s$D.vectices.push(s$G),s$W=s$u.getInt16(),s$h=0;s$h<s$W;s$h++)s$G.push(s$u.getFloat32())}var s$Zd,s$hd,s$_d=s$u.getInt16(),s$Nd=0,s$md=0;for(s$d=0;s$d<s$_d;s$d++){for(s$Nd=s$u.getInt16(),s$K=[],s$L=0;s$L<s$Nd;s$L++){for((s$Zd=new s$od).time=s$u.getFloat32(),s$md=s$u.getInt16(),s$l=0;s$l<s$md;s$l++)s$Zd.drawOrder.push(s$u.getInt16());s$K.push(s$Zd)}this.drawOrderAniArr.push(s$K)}var s$ud,s$xd=s$u.getInt16(),s$td=0;for(s$d=0;s$d<s$xd;s$d++){for(s$td=s$u.getInt16(),s$hd=[],s$L=0;s$L<s$td;s$L++)(s$ud=new s$id).name=s$u.getUTFString(),s$ud.intValue=s$u.getInt32(),s$ud.floatValue=s$u.getFloat32(),s$ud.stringValue=s$u.getUTFString(),s$ud.time=s$u.getFloat32(),s$hd.push(s$ud);this.eventAniArr.push(s$hd)}var s$bd=s$u.getInt16();if(0<s$bd)for(this.attachmentNames=[],s$d=0;s$d<s$bd;s$d++)this.attachmentNames.push(s$u.getUTFString());var s$qd,s$Yd,s$cd=s$u.getInt16();for(s$d=0;s$d<s$cd;s$d++)(s$qd=new s$Hd).name=s$u.readUTFString(),s$qd.parent=s$u.readUTFString(),s$qd.attachmentName=s$u.readUTFString(),s$qd.srcDisplayIndex=s$qd.displayIndex=s$u.getInt16(),(s$qd.templet=this).boneSlotDic[s$qd.name]=s$qd,null==(s$Yd=this.bindBoneBoneSlotDic[s$qd.parent])&&(this.bindBoneBoneSlotDic[s$qd.parent]=s$Yd=[]),s$Yd.push(s$qd),this.boneSlotArray.push(s$qd);var s$rd,s$ad,s$kd,s$ed=s$u.readUTFString().split("\n"),s$wd=0,s$sd=s$u.getUint8(),s$Ad=0,s$yd=0,s$$d=0,s$Od=0,s$nd=0,s$Vd=0,s$Qd=0;for(s$d=0;s$d<s$sd;s$d++){for((s$rd=new s$Cd).name=s$ed[s$wd++],s$Ad=s$u.getUint8(),s$L=0;s$L<s$Ad;s$L++){for((s$ad=new s$Td).name=s$ed[s$wd++],s$qd=this.boneSlotDic[s$ad.name],s$yd=s$u.getUint8(),s$l=0;s$l<s$yd;s$l++){if(s$kd=new s$Pd,this.skinSlotDisplayDataArr.push(s$kd),s$kd.name=s$ed[s$wd++],s$kd.attachmentName=s$ed[s$wd++],s$kd.transform=new s$Dd,s$kd.transform.scX=s$u.getFloat32(),s$kd.transform.skX=s$u.getFloat32(),s$kd.transform.skY=s$u.getFloat32(),s$kd.transform.scY=s$u.getFloat32(),s$kd.transform.x=s$u.getFloat32(),s$kd.transform.y=s$u.getFloat32(),s$ad.displayArr.push(s$kd),s$kd.width=s$u.getFloat32(),s$kd.height=s$u.getFloat32(),s$kd.type=s$u.getUint8(),s$kd.verLen=s$u.getUint16(),0<(s$g=s$u.getUint16()))for(s$kd.bones=[],s$Z=0;s$Z<s$g;s$Z++){var s$gd=s$u.getUint16();s$kd.bones.push(s$gd)}if(0<(s$$d=s$u.getUint16()))for(s$kd.uvs=[],s$Z=0;s$Z<s$$d;s$Z++)s$kd.uvs.push(s$u.getFloat32());if(0<(s$Od=s$u.getUint16()))for(s$kd.weights=[],s$Z=0;s$Z<s$Od;s$Z++)s$kd.weights.push(s$u.getFloat32());if(0<(s$nd=s$u.getUint16()))for(s$kd.triangles=[],s$Z=0;s$Z<s$nd;s$Z++)s$kd.triangles.push(s$u.getUint16());if(0<(s$Vd=s$u.getUint16()))for(s$kd.vertices=[],s$Z=0;s$Z<s$Vd;s$Z++)s$kd.vertices.push(s$u.getFloat32());if(0<(s$Qd=s$u.getUint16()))for(s$kd.lengths=[],s$Z=0;s$Z<s$Qd;s$Z++)s$kd.lengths.push(s$u.getFloat32())}s$rd.slotArr.push(s$ad)}this.skinDic[s$rd.name]=s$rd,this.skinDataArray.push(s$rd)}1==s$u.getUint8()?(this.yReverseMatrix=new s$Ed(1,0,0,-1,0,0),s$Q&&s$Q.setTempMatrix(this.yReverseMatrix)):s$Q&&s$Q.setTempMatrix(new s$Ed),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},s$d.getTexture=function(s$d){var s$L=this.subTextureDic[s$d];return s$L||(s$L=this.subTextureDic[s$d.substr(0,s$d.length-1)]),null==s$L?this._mainTexture:s$L},s$d.showSkinByIndex=function(s$d,s$L,s$l){if(void 0===s$l&&(s$l=!0),s$L<0&&s$L>=this.skinDataArray.length)return!1;var s$Z,s$h,s$_=0,s$N=0,s$m=this.skinDataArray[s$L];if(s$m){for(s$_=0,s$N=s$m.slotArr.length;s$_<s$N;s$_++)(s$h=s$m.slotArr[s$_])&&(s$Z=s$d[s$h.name])&&(s$Z.showSlotData(s$h,s$l),s$l&&"undefined"!=s$Z.attachmentName&&"null"!=s$Z.attachmentName?s$Z.showDisplayByName(s$Z.attachmentName):s$Z.showDisplayByIndex(s$Z.displayIndex));return!0}return!1},s$d.getSkinIndexByName=function(s$d){for(var s$L=0,s$l=this.skinDataArray.length;s$L<s$l;s$L++)if(this.skinDataArray[s$L].name==s$d)return s$L;return-1},s$d.getGrahicsDataWithCache=function(s$d,s$L){return this._graphicsCache[s$d][s$L]},s$d.setGrahicsDataWithCache=function(s$d,s$L,s$l){this._graphicsCache[s$d][s$L]=s$l},s$d.destroy=function(){var s$d;for(var s$L in this._isDestroyed=!0,this.subTextureDic)(s$d=this.subTextureDic[s$L])&&s$d.destroy();for(s$L in this._textureDic)(s$d=this._textureDic[s$L])&&s$d.destroy();for(var s$l=0,s$Z=this.skinSlotDisplayDataArr.length;s$l<s$Z;s$l++)this.skinSlotDisplayDataArr[s$l].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete s$h.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},s$d.getAniNameByIndex=function(s$d){var s$L=this.getAnimation(s$d);return s$L?s$L.name:null},s$_(0,s$d,"rate",function(){return this._rate},function(s$d){this._rate=s$d}),s$h.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",s$h.TEMPLET_DICTIONARY=null,s$h}(s$X)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(s$d,s$L){"use strict";for(var s$l in Object.defineProperty(s$L,"__esModule",{value:!0}),Laya){var s$Z=Laya[s$l];s$Z&&s$Z.__isclass&&(s$L[s$l]=s$Z)}});