var _=wx.y$;import Sygame from"../utils/sysdk-wxapp";window.Sygame=Sygame;var config={game_id:_[31178],game_pkg:_[31179],partner_label:_[31180],partner_id:_[31181],game_ver:_[31182],is_auth:!1};window.config=config;var p$LUKNB=p$LKBNU();var HOST=_[31183];var p$LUKBN=null;var p$LKNBU=null;var partner_data={};var open_box_uv="";var click_box_uv="";function p$LKBNU(){var n={};return{order_data:{},init:function(e,t){e=e&&e.game_ver?e.game_ver:0,console.log(_[31184]);var o=this;var a;a=wx.getStorageSync(_[31185])?0:(a=o.uuid(16,32),wx.setStorageSync(_[31185],a),1),wx.getStorageSync(_[31186])||(r=o.uuid(16,32),wx.setStorageSync(_[31186],r));var r=wx.getLaunchOptionsSync();var n=r.scene||"";a&&r.query&&r.query.ad_code&&wx.setStorageSync(_[31187],r.query.ad_code),o.log(_[286],{install:a,scene:n}),Sygame.init(r),o=r.query&&r.query.invite?r.query.invite:"",r=r.query&&r.query.invite_type?r.query.invite_type:"",o&&(p$LKNBU={invite:o,invite_type:r,is_new:a,scene:n}),e&&this.checkGameVersion(e,function(e){t&&t(e)})},login:function(e,t){var o=this;console.log(_[31188]),n.login=_[30801]==typeof t?t:null,Sygame.syLogin().then(e=>{console.log(_[31189],e),1001===e.code?o.do_login(e):n.login&&n.login(1,{errMsg:e.message})})},do_login:function(e){var o=this;partner_data={openid:e.openid,uid:e.uid,session_key:e.session_key};var t=o.getPublicData();if(t.is_from_min=1,t.partner_data=JSON.stringify(partner_data),p$LKNBU&&_[281]==typeof p$LKNBU)for(var a in p$LKNBU)t[a]=p$LKNBU[a];wx.request({url:_[26860]+HOST+_[31190],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:t,success:function(e){if(console.log(_[31193],e),200===e.statusCode){if((e=e.data).state){partner_data.openid=e.data.ext;try{wx.setStorageSync(_[31194],e.data.sdk_token),wx.setStorageSync(_[31195],e.data.user_id),wx.setStorageSync(_[31196],e.data.username),e.data.ext&&wx.setStorageSync(_[31197],e.data.ext)}catch(e){}var t={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};n.login&&n.login(0,t)}else n.login&&n.login(1,{errMsg:e.msg});o.getShareInfo(_[31198],function(e){console.log(_[31199]),wx.onShareAppMessage(function(){return o.logStartShare(_[31198]),{title:e.title,imageUrl:e.img,query:e.query}})})}else n.login&&n.login(1,{errMsg:_[31200]})}})},share:function(e){n.share=_[30801]==typeof callback?callback:null;var t=e.type||_[31201];console.log(_[31202]+t),console.log(_[31203]),this.logStartShare(t),t={shareQuery:e.shareQuery||""},Sygame.goShareData(t)},logStartShare:function(e){var t=wx.getStorageSync(_[31194]);wx.request({url:_[26860]+HOST+_[31204],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,server_id:p$LUKBN?p$LUKBN.server_id:"",role_id:p$LUKBN?p$LUKBN.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,o){console.log(_[31205]),wx.getStorageSync(_[31194]),wx.request({url:_[26860]+HOST+_[31206],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var t;console.log(_[31207]),console.log(e),200==e.statusCode&&(t=e.data).state?o&&o(t.data):o&&o({develop:0})}})},getShareInfo:function(e,t){console.log(_[31208]);var o=wx.getStorageSync(_[31194]);wx.request({url:_[26860]+HOST+_[31209],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,type:e,server_id:p$LUKBN?p$LUKBN.server_id:"",role_id:p$LUKBN?p$LUKBN.role_id:"",no_log:1},success:function(e){console.log(_[31210]),console.log(e),200==e.statusCode?(e=e.data).state?t&&t(e.data):n.share&&n.share(1,{errMsg:_[31211]+e.msg}):n.share&&n.share(1,{errMsg:_[31212]})}})},updateShare:function(e,t,o,a,r,n){console.log(_[31213]);var i=wx.getStorageSync(_[31194]);wx.request({url:_[26860]+HOST+_[31214],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:t,is_new:o,role_id:a,sever_id:r,scene:n},success:function(e){console.log(_[31215]),console.log(e)}})},msgCheck:function(e,t){console.log(_[31216]);let o={data:{}};Sygame.syMsgSecCheck({content:e,scene:1}).then(e=>{1001==e.status?(o.statusCode=200,o.data.state=1,console.log(_[31217]+JSON.stringify(e))):(o.statusCode=200,o.data.state=0,console.log(_[31218]+JSON.stringify(e))),t&&t(o)})},pay:function(e,t){this.startPay(e,t)},startPay:function(e,t){console.log(_[31219],e);var o=this;n.pay=_[30801]==typeof t?t:null,t=wx.getStorageSync(_[31194]);var a=wx.getStorageSync(_[31197]);var r;t||a?(r=wx.getSystemInfoSync(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:t,session_key:a,platform:r.platform},o.order_data=e,(t=o.getPublicData()).order_data=JSON.stringify(e),t.is_from_min=1,wx.request({url:_[26860]+HOST+_[31220],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:t,success:function(e){console.log(_[31221]),console.log(e),200===e.statusCode?(e=e.data).state&&e.data.pay_data?""==e.data.ext?(console.log(_[31222]+JSON.stringify(e.data.pay_data)),Sygame.syPay(e.data.pay_data).then(e=>{console.log(_[31223],e)})):o.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):n.pay&&n.pay(1,{errMsg:e.errMsg}):n.login&&n.login(1,{errMsg:_[31200]})}})):n.pay&&n.pay(1,{errMsg:_[31224]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:_[31225]+e.ext2.cp_order_id+_[31226]+e.ext2.amount/100,extraData:{},envVersion:_[31227],success(e){}})},gamePay:function(e){var o=this;wx.request({url:_[26860]+HOST+_[31228]+config.partner_id+"/"+config.game_pkg,method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,pay_data:JSON.stringify(e),openid:partner_data.openid,session_key:partner_data.session_key},success:function(t){var e;console.log(_[31229],t),t.data.buyQuantity<=t.data.balance?(console.log(_[31230]),wx.showModal({title:_[31231],content:_[31232]+t.data.balance+_[31233]+t.data.buyQuantity+_[31234],showCancel:!1,confirmText:_[31235],success:function(){o.gameGoPay(t.data.callbackParams)}})):(console.log(_[31236]),e={mode:_[31237],env:t.data.env,offerId:t.data.offerId,currencyType:t.data.currencyType,buyQuantity:t.data.buyQuantity,zoneId:t.data.zoneId,platform:_[31238],success:function(e){_[31239]==e.errMsg&&o.gameGoPay(t.data.callbackParams)},fail:function(e){console.log(_[31240],e),-1!==e.errMsg.indexOf(_[31241])?n.pay&&n.pay(2,{errMsg:_[31242]}):n.pay&&n.pay(1,{errMsg:_[31243]+e.errMsg})},complete:function(e){}},console.log(_[31244],e),wx.requestMidasPayment(e))}})},gameGoPay:function(e){console.log(_[31245]),wx.request({url:_[26860]+HOST+_[31246]+config.partner_id+"/"+config.game_pkg,method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{orderid:e.orderid,price:e.price,item_id:e.item_id,other:e.other,openid:e.openid,sign:e.sign},success:function(e){console.log(_[31247],e),0===e.data.state&&n.pay&&n.pay(1,{errMsg:e.data.msg})},fail:function(){}})},logCreateRole:function(e){var t=wx.getStorageSync(_[31195]);var o=wx.getStorageSync(_[31196]);var a={};var r;a.user_id=t,a.user_name=o,a.role_id=e.roleid,a.role_lev=e.rolelevel,a.role_name=e.rolename,a.server_id=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[7],a),this.upRoleInfo(_[31248],e),p$LKNBU&&_[281]==typeof p$LKNBU&&(r={pf_uid:t,partner_uid:partner_data.openid,role_id:e.roleid,role_name:e.rolename,server_id:e.serverid,server_name:e.servername,invite_code:p$LKNBU.invite,p$LKNBU:JSON.stringify(p$LKNBU),partner_user_info:JSON.stringify(partner_data)},wx.request({url:_[26860]+HOST+_[31249]+config.partner_id+"/"+config.game_pkg,method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:r,success:function(e){console.log(_[31250]+JSON.stringify(r)),console.log(_[31251]+JSON.stringify(e))}}))},logEnterGame:function(e){var t=wx.getStorageSync(_[31195]);var o=wx.getStorageSync(_[31196]);var a={};a.user_id=t,a.user_name=o,a.role_id=e.roleid,a.role_lev=e.rolelevel,a.role_name=e.rolename,a.server_id=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[6035],a),this.upRoleInfo(_[31252],e),p$LKNBU&&this.updateShare(p$LKNBU.invite,p$LKNBU.invite_type,p$LKNBU.is_new,e.roleid,e.serverid,p$LKNBU.scene)},logRoleUpLevel:function(e){var t=wx.getStorageSync(_[31195]);var o=wx.getStorageSync(_[31196]);var a={};a.user_id=t,a.user_name=o,a.role_id=e.roleid,a.role_lev=e.rolelevel,a.role_name=e.rolename,a.server_id=e.serverid,e.roleid&&e.serverid&&(p$LUKBN={role_id:e.roleid,server_id:e.serverid}),this.log(_[31253],a),this.upRoleInfo(_[31254],e)},upRoleInfo:function(e,t){e={report_type:e,role_id:t.roleid,role_name:t.rolename,role_level:t.rolelevel,server_id:t.serverid,server_name:t.servername,role_power:t.rolepower||0,role_vip:0},Sygame.syReportRoleInfo(e).then(e=>{console.log(_[31255],e)})},getBoxList:function(e,o){console.log(_[31256]),e={page:e.page||0,count:e.count||15},Sygame.syGetBoxList(e).then(e=>{let t={data:{},state:0};1001==e.status&&(t.state=1,t.data=e.data),o&&o(t)})},openBox:function(t){console.log(_[31257]),""===(open_box_uv=wx.getStorageSync(_[31258]))&&(wx.setStorageSync(_[31258],0),open_box_uv=1),wx.request({url:_[31259],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{appid:Sygame.appid,wecha_id:partner_data.openid,uv:open_box_uv},success:function(e){t&&t(e.data)}})},clickBoxGame:function(o){console.log(_[31260]),""===(click_box_uv=wx.getStorageSync(_[31261]))&&(wx.setStorageSync(_[31261],0),click_box_uv=1),wx.request({url:_[31262],method:_[31191],dataType:_[6153],header:{"content-type":_[31192]},data:{appid:Sygame.appid,wecha_id:partner_data.openid,uv:click_box_uv,game_id:o.game_id,tunnel_id:o.tunnel_id,jump_appid:o.jump_appid,jump_path:o.jump_path},success:function(e){var t={appId:o.jump_appid,path:o.jump_path,success:function(e){console.log(_[31263],e)},fail:function(e){console.log(_[31264],e)}};wx.navigateToMiniProgram(t)}})},subscribeMessage:function(e,t){console.log(_[31265]+e),n.subscribeMessage=_[30801]==typeof t?t:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(_[31266]),console.log(e),n.subscribeMessage&&n.subscribeMessage(e)},fail(e){console.log(_[31267]),console.log(e),n.subscribeMessage&&n.subscribeMessage(e)}})},uuid:function(e,t){var o=_[31268].split("");var a,r=[];var n;if(e=e||o.length,t)for(a=0;a<t;a++)r[a]=o[0|Math.random()*e];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",a=0;a<36;a++)r[a]||(n=0|16*Math.random(),r[a]=o[19==a?3&n|8:n]);return r.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var t=wx.getStorageSync(_[31185]);var o=wx.getStorageSync(_[31186]);var a=wx.getStorageSync(_[31187]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:a,uuid:t,idfv:o,dname:e.model,mac:_[31269],net_type:0==e.wifiSignal?"4G":_[31270],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:_[31238]==e.platform?1:2}},log:function(e,t){var o=this.getPublicData();for(var a in t)o[a]=t[a];console.log(_[31271]+e),console.log(o),wx.request({url:_[26860]+HOST+_[31272]+e+_[31273]+encodeURIComponent(JSON.stringify(o))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){Sygame.syBindMobile()}}}function run(e,t,o){e in p$LUKNB&&p$LUKNB[e](t,o)}exports.init=function(e,t){run(_[367],e,t)},exports.login=function(e){run(_[31274],"",e)},exports.pay=function(e,t){run(_[31275],e,t)},exports.openService=function(){run(_[24733])},exports.logCreateRole=function(e,t,o,a,r){run(_[31276],{serverid:e,servername:t,roleid:o,rolename:a,rolelevel:r})},exports.logEnterGame=function(e,t,o,a,r,n,i){run(_[31277],{serverid:e,servername:t,roleid:o,rolename:a,rolelevel:r,rolecreatetime:n,rolepower:(i=i||{}).rolepower})},exports.logRoleUpLevel=function(e,t,o,a,r,n,i){run(_[31278],{serverid:e,servername:t,roleid:o,rolename:a,rolelevel:r,rolecreatetime:n,rolepower:(i=i||{}).rolepower})},exports.share=function(e){run(_[31201],{type:e})},exports.msgCheck=function(e,t){run(_[12792],e,t)},exports.getBoxList=function(e,t){run(_[31279],e,t)},exports.openBox=function(e){run(_[5488],e)},exports.clickBoxGame=function(e){run(_[31280],e)},exports.downloadClient=function(){run(_[31281])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(_[31282])},exports.weiduanHelper=function(){run(_[24623])},exports.subscribeMessage=function(e,t){run(_[31283],e,t)};