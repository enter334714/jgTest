var S=wx.$J;require(S[569968]),require(S[569969]);var config={game_id:256,game_pkg:S[569970],partner_label:S[569971],partner_id:S[569972],game_ver:S[569973],is_auth:!1,partner_game_id:S[569974],partenr_app_id:S[569975]};window.config=config;var $jI9A3S=$jIAS39();var HOST=S[569976];var $jI9AS3=null;var $jIA3S9=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function $jIAS39(){var a={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(S[569977]);var n=this;var t;t=wx.getStorageSync(S[569978])?0:(t=n.uuid(16,32),wx.setStorageSync(S[569978],t),1),wx.getStorageSync(S[569979])||(o=n.uuid(16,32),wx.setStorageSync(S[569979],o));var o=wx.getLaunchOptionsSync();var a=o.scene||"";t&&o.query&&o.query.ad_code&&wx.setStorageSync(S[569980],o.query.ad_code),n.log(S[540282],{install:t,scene:a}),wx.showShareMenu();n=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";n&&($jIA3S9={invite:n,invite_type:o,is_new:t,scene:a}),window.DDSDK.init(this.onSdkInited.bind(this)),e&&this.checkGameVersion(e,function(e){r&&r(e)}),DDSDK.logEvent(S[569981],{})},onSdkInited:function(){console.log(S[569982]),DDSDK.logEvent(S[569981],{})},login:function(e,r){console.log(S[569983]),a[S[569984]]=typeof r==S[569608]?r:null;var n=this;wx.login({success:function(e){console.log(e.code),DDSDK.getOpenId({code:e.code,gameId:config.partner_game_id,cb:function(e){console.log(e),partner_user_info={openid:e.data.openid},e.data.unionid&&(partner_user_info[S[569985]]=e.data.unionid);e=DDSDK.getChannel();partner_user_info[S[565876]]=e,n.do_login(partner_user_info)}})}})},do_login:function(e){var n=this;var r=n.getPublicData();if(r[S[569986]]=JSON.stringify(e),$jIA3S9&&typeof $jIA3S9==S[540277])for(var t in $jIA3S9)r[t]=$jIA3S9[t];wx.request({url:S[566101]+HOST+S[569987],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:r,success:function(e){if(console.log(S[569990]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.getStorageSync(S[569991])||wx.setStorageSync(S[569992],new Date),wx.setStorageSync(S[569993],e.data.sdk_token),wx.setStorageSync(S[569991],e.data.user_id),wx.setStorageSync(S[569994],e.data.username),e.data.ext&&wx.setStorageSync(S[569995],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};a[S[569984]]&&a[S[569984]](0,r)}else a[S[569984]]&&a[S[569984]](1,{errMsg:e.msg});n.getShareInfo(S[569996],function(e){console.log(S[569997]),wx.onShareAppMessage(function(){return n.logStartShare(S[569996]),{title:e.title,imageUrl:e.img,query:e.query}})})}else a[S[569984]]&&a[S[569984]](1,{errMsg:S[569998]})}})},share:function(e){a[S[569999]]=typeof callback==S[569608]?callback:null;var r=e.type||S[569999];console.log(S[57e4]+r);var n=this;this.getShareInfo(r,function(e){n.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(S[569993]);wx.request({url:S[566101]+HOST+S[570001],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:$jI9AS3?$jI9AS3.server_id:"",role_id:$jI9AS3?$jI9AS3.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,n){console.log(S[570002]);wx.getStorageSync(S[569993]);wx.request({url:S[566101]+HOST+S[570003],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(S[570004]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?n&&n(r.data):n&&n({develop:0})}})},getShareInfo:function(e,r){console.log(S[570005]);var n=wx.getStorageSync(S[569993]);wx.request({url:S[566101]+HOST+S[570006],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:n,type:e,server_id:$jI9AS3?$jI9AS3.server_id:"",role_id:$jI9AS3?$jI9AS3.role_id:"",no_log:1},success:function(e){console.log(S[570007]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):a[S[569999]]&&a[S[569999]](1,{errMsg:S[570008]+e.msg}):a[S[569999]]&&a[S[569999]](1,{errMsg:S[570009]})}})},updateShare:function(e,r,n,t,o,a){console.log(S[570010]);var i=wx.getStorageSync(S[569993]);wx.request({url:S[566101]+HOST+S[570011],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:n,role_id:t,sever_id:o,scene:a},success:function(e){console.log(S[570012]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(S[570013]+e),wx.request({url:S[566101]+HOST+S[570014]+config.partner_id+"/"+config.game_pkg,method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:{content:e,open_id:partner_user_info.openid},success:function(e){console.log(S[570015]+JSON.stringify(e)),console.log(e),r&&r(e)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(S[570016]+JSON.stringify(e));var n=this;a[S[570017]]=typeof r==S[569608]?r:null;r=wx.getStorageSync(S[569993]);var t=wx.getStorageSync(S[569995]);var o;r?(o=new Date(wx.getStorageSync(S[569992])).toDateString()===(new Date).toDateString(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform,openId:partner_user_info.openid,isNewUser:o?1:2,channel:partner_user_info.channel,unionId:partner_user_info.unionid},n.order_data=e,(r=n.getPublicData())[S[570019]]=JSON.stringify(e),wx.request({url:S[566101]+HOST+S[570020],method:S[569988],dataType:S[545987],header:{"content-type":S[569989]},data:r,success:function(e){console.log(S[570021]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?DDSDK.startPay(e.data.pay_data):n.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):a[S[570017]]&&a[S[570017]](1,{errMsg:e.msg}):a[S[569984]]&&a[S[569984]](1,{errMsg:S[569998]})}})):a[S[570017]]&&a[S[570017]](1,{errMsg:S[570018]})},logCreateRole:function(e){var r=wx.getStorageSync(S[569991]);var n=wx.getStorageSync(S[569994]);var t={};t[S[570022]]=r,t[S[570023]]=n,t[S[551052]]=e.roleid,t[S[570024]]=e.rolelevel,t[S[570025]]=e.rolename,t[S[551727]]=e.serverid,e.roleid&&e.serverid&&($jI9AS3={role_id:e.roleid,server_id:e.serverid}),this.log(S[540006],t),DDSDK.logEvent(S[570026],{})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:S[570027]+e.ext2.cpOrderNumber+S[570028]+e.ext2.amount,extraData:{},envVersion:S[570029],success(e){}})},logEnterGame:function(e){var r=wx.getStorageSync(S[569991]);var n=wx.getStorageSync(S[569994]);var t={};t[S[570022]]=r,t[S[570023]]=n,t[S[551052]]=e.roleid,t[S[570024]]=e.rolelevel,t[S[570025]]=e.rolename,t[S[551727]]=e.serverid,e.roleid&&e.serverid&&($jI9AS3={role_id:e.roleid,server_id:e.serverid}),this.log(S[545869],t),$jIA3S9&&this.updateShare($jIA3S9.invite,$jIA3S9.invite_type,$jIA3S9.is_new,e.roleid,e.serverid,$jIA3S9.scene);r=new Date(wx.getStorageSync(S[569992])).toDateString()===(new Date).toDateString();n=sysInfo.platform==S[570030]?S[570031]:S[570032];t={openId:partner_user_info.openid,isNewUser:r?1:2,os:n,role_id:e.roleid,server_id:e.serverid,app_id:config.partenr_app_id,unionId:partner_user_info.unionid};DDSDK.setAccount(t);r={account_id:partner_user_info.openid,role_id:e.roleid,server_id:e.serverid,server_name:e.servername,openId:partner_user_info.openid,os:n,model:sysInfo.model,unionId:partner_user_info.unionid};DDSDK.setUserInfo(r)},logRoleUpLevel:function(e){var r=wx.getStorageSync(S[569991]);var n=wx.getStorageSync(S[569994]);var t={};t[S[570022]]=r,t[S[570023]]=n,t[S[551052]]=e.roleid,t[S[570024]]=e.rolelevel,t[S[570025]]=e.rolename,t[S[551727]]=e.serverid,e.roleid&&e.serverid&&($jI9AS3={role_id:e.roleid,server_id:e.serverid,server_name:e.servername,role_name:e.rolename,role_level:e.rolelevel,role_createtime:e.rolecreatetime}),this.log(S[570033],t),20==e.rolelevel&&DDSDK.logEvent(S[570034],{role_id:e.roleid,server_id:e.serverid})},uuid:function(e,r){var n=S[570035].split("");var t,o=[];var a;if(e=e||n.length,r)for(t=0;t<r;t++)o[t]=n[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",t=0;t<36;t++)o[t]||(a=0|16*Math.random(),o[t]=n[19==t?3&a|8:a]);return o.join("")},getPublicData:function(){var e=wx.getStorageSync(S[569978]);var r=wx.getStorageSync(S[569979]);var n=wx.getStorageSync(S[569980]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:n,uuid:e,idfv:r,mac:S[570036],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":S[570037],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==S[570030]?1:2}},log:function(e,r){var n=this.getPublicData();for(var t in r)n[t]=r[t];console.log(S[570038]+e),console.log(n),wx.request({url:S[566101]+HOST+S[570039]+e+S[570040]+encodeURIComponent(JSON.stringify(n))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){var e={phone:"",roleId:$jI9AS3.role_id,serverId:$jI9AS3.sever_id};DDSDK.getCustomerServiceByFB(e)},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))},subscribeMessage:function(e,r){console.log(S[570041]+e),a[S[570042]]=typeof r==S[569608]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(S[570043]),console.log(e),a[S[570042]]&&a[S[570042]](e)},fail(e){console.log(S[570044]),console.log(e),a[S[570042]]&&a[S[570042]](e)}})}}}function run(e,r,n){e in $jI9A3S&&$jI9A3S[e](r,n)}exports.init=function(e,r){run(S[540363],e,r)},exports.login=function(e){run(S[569984],"",e)},exports.login=function(e){run(S[569984],"",e)},exports.pay=function(e,r){run(S[570017],e,r)},exports.openService=function(){run(S[565553])},exports.logCreateRole=function(e,r,n,t,o,a){run(S[570045],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o,rolecreatetime:a})},exports.logEnterGame=function(e,r,n,t,o,a){run(S[570046],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o,rolecreatetime:a})},exports.logRoleUpLevel=function(e,r,n,t,o,a){run(S[570047],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o,rolecreatetime:a})},exports.share=function(e){run(S[569999],{type:e})},exports.msgCheck=function(e,r){run(S[552419],e,r)},exports.downloadClient=function(){run(S[570048])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(S[570049])},exports.weiduanHelper=function(){run(S[564070])},exports.setMessageToFriendQuery=function(e,r){run(S[570050],e,r)},exports.subscribeMessage=function(e,r){run(S[570042],e,r)};