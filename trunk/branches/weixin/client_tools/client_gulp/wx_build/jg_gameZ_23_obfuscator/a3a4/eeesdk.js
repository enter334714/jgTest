var c=wx.$a;import RYSDK from"../utils/sdk";var config={game_id:156,game_pkg:c[533],partner_label:c[534],partner_id:c[535],game_ver:c[536],is_auth:!1};window.config=config;var j61EMB=j6EBM1();var HOST=c[537];var j61EBM=null;var j6EMB1=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;const rysdk=new RYSDK;function j6EBM1(){var t={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(c[538]);var o=this;var n;n=wx.getStorageSync(c[539])?0:(n=o.uuid(16,32),wx.setStorageSync(c[539],n),1),wx.getStorageSync(c[540])||(t=o.uuid(16,32),wx.setStorageSync(c[540],t));var t=wx.getLaunchOptionsSync();var a=t.scene||"";wx.showShareMenu(),n&&t.query&&t.query.ad_code&&wx.setStorageSync(c[541],t.query.ad_code),o.log(c[542],{install:n,scene:a});o=t.query&&t.query.invite?t.query.invite:"";t=t.query&&t.query.invite_type?t.query.invite_type:"";o&&(j6EMB1={invite:o,invite_type:t,is_new:n,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)});o={gid:156,pkid:2656,cid:3693,aid:195446,appid:0,appver:e};rysdk.ryInit(o).then(e=>{console.log(c[543],e)}).catch(e=>{console.log(c[544],e)})},login:function(e,r){console.log(c[545]),t[c[546]]=typeof r==c[378]?r:null;var o=this;rysdk.ryLogin().then(e=>{partner_user_info=e,o.do_login(e.info),console.log(c[547]+JSON.stringify(e))}).catch(e=>{console.warn(c[548],e)})},do_login:function(o){var n=this;var e=n.getPublicData();if(e[c[549]]=JSON.stringify(o),j6EMB1&&typeof j6EMB1==c[294])for(var r in j6EMB1)e[r]=j6EMB1[r];wx.request({url:c[550]+HOST+c[551],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:e,success:function(e){if(console.log(c[554]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(c[555],e.data.sdk_token),wx.setStorageSync(c[556],e.data.user_id),wx.setStorageSync(c[557],e.data.username),e.data.ext&&wx.setStorageSync(c[558],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0",isBindPhone:o.isBindPhone};t[c[546]]&&t[c[546]](0,r)}else t[c[546]]&&t[c[546]](1,{errMsg:e.msg});n.getShareInfo(c[559],function(e){console.log(c[560]),n.logStartShare(c[559]);var r={title:e.title,imageUrl:e.img,query:e.query};rysdk.shareMsg({}).then(e=>{console.log(c[561],e),r[c[562]]=e.msg.title,r[c[563]]=e.msg.img_url}).catch(e=>{console.log(c[564],e)}),console.log(c[565],r),wx.onShareAppMessage(function(){return n.logStartShare(c[559]),r})})}else t[c[546]]&&t[c[546]](1,{errMsg:c[566]})}})},share:function(e){t[c[567]]=typeof callback==c[378]?callback:null;var o=e.type||c[567];console.log(c[568]+o);var n=this;this.getShareInfo(o,function(r){n.logStartShare(o),rysdk.shareMsg({}).then(e=>{console.log(c[561],e),wx.shareAppMessage({title:e.msg.title,imageUrl:e.msg.img_url,query:r.query})}).catch(e=>{console.log(c[564],e)})})},logStartShare:function(e){var r=wx.getStorageSync(c[555]);wx.request({url:c[550]+HOST+c[569],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:j61EBM?j61EBM.server_id:"",role_id:j61EBM?j61EBM.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,o){console.log(c[570]);wx.getStorageSync(c[555]);wx.request({url:c[550]+HOST+c[571],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(c[572]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?o&&o(r.data):o&&o({develop:0})}})},getShareInfo:function(e,r){console.log(c[573]);var o=wx.getStorageSync(c[555]);wx.request({url:c[550]+HOST+c[574],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,type:e,server_id:j61EBM?j61EBM.server_id:"",role_id:j61EBM?j61EBM.role_id:"",no_log:1},success:function(e){console.log(c[575]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):t[c[567]]&&t[c[567]](1,{errMsg:c[576]+e.msg}):t[c[567]]&&t[c[567]](1,{errMsg:c[577]})}})},updateShare:function(e,r,o,n,t,a){console.log(c[578]);var i=wx.getStorageSync(c[555]);wx.request({url:c[550]+HOST+c[579],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:o,role_id:n,sever_id:t,scene:a},success:function(e){console.log(c[580]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(c[581]+e);let o={data:{}};rysdk.ryCheckWord({version:2,scene:4,content:e}).then(e=>{o.statusCode=200,o.data.state=1,r&&r(o)}).catch(e=>{o.statusCode=200,o.data.state=0,r&&r(o)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(c[582]+JSON.stringify(e));var o=this;t[c[583]]=typeof r==c[378]?r:null;r=wx.getStorageSync(c[555]);var n=wx.getStorageSync(c[558]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:n,platform:platform},o.order_data=e,(r=o.getPublicData())[c[585]]=JSON.stringify(e),wx.request({url:c[550]+HOST+c[586],method:c[552],dataType:c[505],header:{"content-type":c[553]},data:r,success:function(e){console.log(c[587]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?(console.log(c[588]+JSON.stringify(e.data.pay_data)),""==e.data.ext?rysdk.ryPay(e.data.pay_data).then(e=>{console.log(c[589],e)}).catch(e=>{console.log(c[590],e)}):o.extDo({ext1:e.data.ext,ext2:e.data.pay_data})):t[c[583]]&&t[c[583]](1,{errMsg:e.msg}):t[c[546]]&&t[c[546]](1,{errMsg:c[566]})}})):t[c[583]]&&t[c[583]](1,{errMsg:c[584]})},logCreateRole:function(e){var r=wx.getStorageSync(c[556]);var o=wx.getStorageSync(c[557]);var n={};n[c[591]]=r,n[c[592]]=o,n[c[593]]=e.roleid,n[c[594]]=e.rolelevel,n[c[595]]=e.rolename,n[c[596]]=e.serverid,e.roleid&&e.serverid&&(j61EBM={role_id:e.roleid,server_id:e.serverid}),this.log(c[295],n);r={server:e.serverid,roleid:e.roleid,role:e.rolename};rysdk.ryRole(r).then(e=>{console.log(e)}).catch(e=>{console.log(e)})},logEnterGame:function(e){var r=wx.getStorageSync(c[556]);var o=wx.getStorageSync(c[557]);var n={};n[c[591]]=r,n[c[592]]=o,n[c[593]]=e.roleid,n[c[594]]=e.rolelevel,n[c[595]]=e.rolename,n[c[596]]=e.serverid,e.roleid&&e.serverid&&(j61EBM={role_id:e.roleid,server_id:e.serverid}),this.log(c[597],n),j6EMB1&&this.updateShare(j6EMB1.invite,j6EMB1.invite_type,j6EMB1.is_new,e.roleid,e.serverid,j6EMB1.scene);r={server:e.serverid,roleid:e.roleid,role:e.rolename,rolelevel:e.rolelevel};rysdk.ryEntry(r).then(e=>{console.log(e)}).catch(e=>{console.log(e)})},logRoleUpLevel:function(e){var r=wx.getStorageSync(c[556]);var o=wx.getStorageSync(c[557]);var n={};n[c[591]]=r,n[c[592]]=o,n[c[593]]=e.roleid,n[c[594]]=e.rolelevel,n[c[595]]=e.rolename,n[c[596]]=e.serverid,e.roleid&&e.serverid&&(j61EBM={role_id:e.roleid,server_id:e.serverid}),this.log(c[598],n);r={server:e.serverid,roleid:e.roleid,role:e.rolename,rolelevel:e.rolelevel};rysdk.ryLevel(r).then(e=>{console.log(e)}).catch(e=>{console.log(e)})},uuid:function(e,r){var o=c[599].split("");var n,t=[];var a;if(e=e||o.length,r)for(n=0;n<r;n++)t[n]=o[0|Math.random()*e];else for(t[8]=t[13]=t[18]=t[23]="-",t[14]="4",n=0;n<36;n++)t[n]||(a=0|16*Math.random(),t[n]=o[19==n?3&a|8:a]);return t.join("")},getPublicData:function(){var e=wx.getStorageSync(c[539]);var r=wx.getStorageSync(c[540]);var o=wx.getStorageSync(c[541]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:o,uuid:e,idfv:r,mac:c[600],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":c[601],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==c[602]?1:2}},log:function(e,r){var o=this.getPublicData();for(var n in r)o[n]=r[n];console.log(c[603]+e),console.log(o),wx.request({url:c[550]+HOST+c[604]+e+c[605]+encodeURIComponent(JSON.stringify(o))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(e,r){rysdk.ryCheckTurnTerminalMsg({})},sendUrl:function(){rysdk.ryCheckTurnTerminalMsg({})},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))},setLoadingCmp:function(){},sendCode:function(e,r){console.log(c[606],e.phone),rysdk.rySendMessage({phone:e.phone}).then(e=>{r&&r(0,e)}).catch(e=>{r&&r(1,e)})},bindPhone:function(e,r){console.log(c[607],e.phone,e.code),rysdk.ryBindPhone({phone:e.phone,captcha:e.code}).then(e=>{r&&r(0,e)}).catch(e=>{r&&r(1,e)})},subscribeMessage:function(e,r){console.log(c[608]+e),t[c[609]]=typeof r==c[378]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(c[610]),console.log(e),t[c[609]]&&t[c[609]](e)},fail(e){console.log(c[611]),console.log(e),t[c[609]]&&t[c[609]](e)}})}}}function run(e,r,o){e in j61EMB&&j61EMB[e](r,o)}exports.init=function(e,r){run(c[612],e,r)},exports.login=function(e){run(c[546],"",e)},exports.login=function(e){run(c[546],"",e)},exports.pay=function(e,r){run(c[583],e,r)},exports.openService=function(){run(c[613])},exports.logCreateRole=function(e,r,o,n,t){run(c[614],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.logEnterGame=function(e,r,o,n,t){run(c[615],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.logRoleUpLevel=function(e,r,o,n,t){run(c[616],{serverid:e,servername:r,roleid:o,rolename:n,rolelevel:t})},exports.share=function(e){run(c[567],{type:e})},exports.msgCheck=function(e,r){run(c[617],e,r)},exports.downloadClient=function(){run(c[618])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(c[619])},exports.weiduanHelper=function(e,r){run(c[620],e,r)},exports.sendUrl=function(){run(c[621])},exports.setMessageToFriendQuery=function(e,r){run(c[622],e,r)},exports.setLoadingCmp=function(){run(c[623])},exports.sendCode=function(e,r){run(c[624],e,r)},exports.bindPhone=function(e,r){run(c[625],e,r)},exports.subscribeMessage=function(e,r){run(c[609],e,r)};