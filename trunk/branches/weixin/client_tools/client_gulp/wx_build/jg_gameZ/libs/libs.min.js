var Laya=window.Laya=function(z$t,z$V){var z$b={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(z$V,z$U){return 1==arguments.length?z$b.__presubstr.call(this,z$V):z$b.__presubstr.call(this,z$V,0<z$U?z$U:this.length+z$U)},__init:function(z$V){z$V.forEach(function(z$V){z$V.__init$&&z$V.__init$()})},__isClass:function(z$V){return z$V&&(z$V.__isclass||z$V==Object||z$V==String||z$V==Array)},__newvec:function(z$V,z$U){var z$r=[];z$r.length=z$V;for(var z$s=0;z$s<z$V;z$s++)z$r[z$s]=z$U;return z$r},__extend:function(z$V,z$U){for(var z$r in z$U)if(z$U.hasOwnProperty(z$r)){var z$s=Object.getOwnPropertyDescriptor(z$U,z$r),z$p=z$s.get,z$c=z$s.set;z$p||z$c?z$p&&z$c?Object.defineProperty(z$V,z$r,z$s):(z$p&&Object.defineProperty(z$V,z$r,z$p),z$c&&Object.defineProperty(z$V,z$r,z$c)):z$V[z$r]=z$U[z$r]}function z$R(){z$b.un(this,"constructor",z$V)}z$R.prototype=z$U.prototype,z$V.prototype=new z$R,z$b.un(z$V.prototype,"__imps",z$b.__copy({},z$U.prototype.__imps))},__copy:function(z$V,z$U){if(!z$U)return null;for(var z$r in z$V=z$V||{},z$U)z$V[z$r]=z$U[z$r];return z$V},__package:function(z$V,z$U){if(!z$b.__packages[z$V]){z$b.__packages[z$V]=!0;var z$r=z$t,z$s=z$V.split(".");if(1<z$s.length)for(var z$p=0,z$c=z$s.length-1;z$p<z$c;z$p++){var z$R=z$r[z$s[z$p]];z$r=z$R||(z$r[z$s[z$p]]={})}z$r[z$s[z$s.length-1]]||(z$r[z$s[z$s.length-1]]=z$U||{})}},__hasOwnProperty:function(z$V,z$U){return z$U=z$U||this,Object.hasOwnProperty.call(z$U,z$V)||function z$V(z$U,z$r){if(Object.hasOwnProperty.call(z$r.prototype,z$U))return!0;var z$s=z$r.prototype.__super;return null==z$s?null:z$V(z$U,z$s)}(z$V,z$U.__class)},__typeof:function(z$V,z$U){if(!z$V||!z$U)return!1;if(z$U===String)return"string"==typeof z$V;if(z$U===Number)return"number"==typeof z$V;if(z$U.__interface__)z$U=z$U.__interface__;else if("string"!=typeof z$U)return z$V instanceof z$U;return z$V.__imps&&z$V.__imps[z$U]||z$V.__class==z$U},__as:function(z$V,z$U){return this.__typeof(z$V,z$U)?z$V:null},__int:function(z$V){return z$V?parseInt(z$V):0},interface:function(z$V,z$U){z$b.__package(z$V,{});var z$r=z$b.__internals,z$s=z$r[z$V]=z$r[z$V]||{self:z$V};if(z$U){var z$p=z$U.split(",");z$s.extend=[];for(var z$c=0;z$c<z$p.length;z$c++){var z$R=z$p[z$c];z$r[z$R]=z$r[z$R]||{self:z$R},z$s.extend.push(z$r[z$R])}}var z$T=z$t,z$N=z$V.split(".");for(z$c=0;z$c<z$N.length-1;z$c++)z$T=z$T[z$N[z$c]];z$T[z$N[z$N.length-1]]={__interface__:z$V}},class:function(z$V,z$U,z$r,z$s){if(z$r&&z$b.__extend(z$V,z$r),z$U)if(z$b.__package(z$U,z$V),z$b.__classmap[z$U]=z$V,0<z$U.indexOf(".")){if(0==z$U.indexOf("laya.")){var z$p=z$U.split(".");z$s=z$s||z$p[z$p.length-1],z$b[z$s]&&console.log("Warning!,this class["+z$s+"] already exist:",z$b[z$s]),z$b[z$s]=z$V}}else"Main"==z$U?z$t.Main=z$V:"MainWX"==z$U?z$t.MainWX=z$V:(z$b[z$U]&&console.log("Error!,this class["+z$U+"] already exist:",z$b[z$U]),z$b[z$U]=z$V);var z$c=z$b.un,z$R=z$V.prototype;z$c(z$R,"hasOwnProperty",z$b.__hasOwnProperty),z$c(z$R,"__class",z$V),z$c(z$R,"__super",z$r),z$c(z$R,"__className",z$U),z$c(z$V,"__super",z$r),z$c(z$V,"__className",z$U),z$c(z$V,"__isclass",!0),z$c(z$V,"super",function(z$V){this.__super.call(z$V)})},imps:function(z$V,z$U){if(!z$U)return null;var z$p=z$V.__imps||z$b.un(z$V,"__imps",{});function z$c(z$V){var z$U,z$r;if((z$U=z$b.__internals[z$V])&&(z$p[z$V]=!0,z$r=z$U.extend))for(var z$s=0;z$s<z$r.length;z$s++)z$c(z$r[z$s].self)}for(var z$r in z$U)z$c(z$r)},superSet:function(z$V,z$U,z$r,z$s){var z$p=z$V.prototype["_$set_"+z$r];z$p&&z$p.call(z$U,z$s)},superGet:function(z$V,z$U,z$r){var z$s=z$V.prototype["_$get_"+z$r];return z$s?z$s.call(z$U):null},getset:function(z$V,z$U,z$r,z$s,z$p){z$V?(z$s&&(z$U["_$GET_"+z$r]=z$s),z$p&&(z$U["_$SET_"+z$r]=z$p)):(z$s&&z$b.un(z$U,"_$get_"+z$r,z$s),z$p&&z$b.un(z$U,"_$set_"+z$r,z$p)),z$s&&z$p?Object.defineProperty(z$U,z$r,{get:z$s,set:z$p,enumerable:!1,configurable:!0}):(z$s&&Object.defineProperty(z$U,z$r,{get:z$s,enumerable:!1,configurable:!0}),z$p&&Object.defineProperty(z$U,z$r,{set:z$p,enumerable:!1,configurable:!0}))},static:function(z$r,z$s){for(var z$p=0,z$V=z$s.length;z$p<z$V;z$p+=2)if("length"==z$s[z$p])z$r.length=z$s[z$p+1].call(z$r);else{function z$U(){var z$U=z$s[z$p],z$V=z$s[z$p+1];Object.defineProperty(z$r,z$U,{get:function(){return delete this[z$U],this[z$U]=z$V.call(this)},set:function(z$V){delete this[z$U],this[z$U]=z$V},enumerable:!0,configurable:!0})}z$U()}},un:function(z$V,z$U,z$r){return z$r||(z$r=z$V[z$U]),z$b.__propun.value=z$r,Object.defineProperty(z$V,z$U,z$b.__propun),z$r},uns:function(z$U,z$V){z$V.forEach(function(z$V){z$b.un(z$U,z$V)})}};return z$t.console=z$t.console||{log:function(){}},z$t.trace=z$t.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),z$b}(window,document);!function(z$V,z$U,z$r){z$r.un,z$r.uns,z$r.static,z$r.class,z$r.getset,z$r.__newvec}(window,document,Laya),function(z$R,z$U,z$y){z$y.un,z$y.uns;var z$N=z$y.static,z$b=z$y.class,z$q=z$y.getset;z$y.__newvec;z$y.interface("laya.runtime.IMarket"),z$y.interface("laya.filters.IFilter"),z$y.interface("laya.display.ILayout"),z$y.interface("laya.resource.IDispose"),z$y.interface("laya.runtime.IPlatform"),z$y.interface("laya.resource.IDestroy"),z$y.interface("laya.runtime.IConchNode"),z$y.interface("laya.filters.IFilterAction"),z$y.interface("laya.runtime.ICPlatformClass"),z$y.interface("laya.resource.ICreateResource"),z$y.interface("laya.runtime.IConchRenderObject"),z$y.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var z$w=function(){function z$c(){}return z$b(z$c,"laya.utils.RunDriver"),z$c.FILTER_ACTIONS=[],z$c.pixelRatio=-1,z$c._charSizeTestDiv=null,z$c.now=function(){return Date.now()},z$c.getWindow=function(){return z$R},z$c.getPixelRatio=function(){if(z$c.pixelRatio<0){var z$V=z$j.context,z$U=z$V.backingStorePixelRatio||z$V.webkitBackingStorePixelRatio||z$V.mozBackingStorePixelRatio||z$V.msBackingStorePixelRatio||z$V.oBackingStorePixelRatio||z$V.backingStorePixelRatio||1;(z$c.pixelRatio=(z$j.window.devicePixelRatio||1)/z$U)<1&&(z$c.pixelRatio=1)}return z$c.pixelRatio},z$c.getIncludeStr=function(z$V){return null},z$c.createShaderCondition=function(z$V){var z$U="(function() {return "+z$V+";})";return z$y._runScript(z$U)},z$c.fontMap=[],z$c.measureText=function(z$V,z$U){var z$r=z$c.hanzi.test(z$V);if(z$r&&z$c.fontMap[z$U])return z$c.fontMap[z$U];var z$s=z$j.context;z$s.font=z$U;var z$p=z$s.measureText(z$V);return z$p||(z$p={width:16,height:16}),z$r&&(z$c.fontMap[z$U]=z$p),z$p},z$c.getWebGLContext=function(z$V){},z$c.beginFlush=function(){},z$c.endFinish=function(){},z$c.addToAtlas=null,z$c.flashFlushImage=function(z$V){},z$c.drawToCanvas=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$OV.create("2D"),z$T=new z$a(z$r,z$s,z$R);return z$Z.renders[z$U]._fun(z$V,z$T,z$p,z$c),z$R},z$c.createParticleTemplate2D=null,z$c.createGLTextur=null,z$c.createWebGLContext2D=null,z$c.changeWebGLSize=function(z$V,z$U){},z$c.createRenderSprite=function(z$V,z$U){return new z$Z(z$V,z$U)},z$c.createFilterAction=function(z$V){return new z$O},z$c.createGraphics=function(){return new z$_},z$c.clear=function(z$V){z$m._context.ctx.clear()},z$c.cancelLoadByUrl=function(z$V){},z$c.clearAtlas=function(z$V){},z$c.isAtlas=function(z$V){return!1},z$c.addTextureToAtlas=function(z$V){},z$c.getTexturePixels=function(z$V,z$U,z$r,z$s,z$p){return null},z$c.skinAniSprite=function(){return null},z$c.update3DLoop=function(){},z$N(z$c,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),z$c}(),z$s=(z$q(1,z$y,"alertGlobalError",null,function(z$V){var z$c=0;z$j.window.onerror=z$V?function(z$V,z$U,z$r,z$s,z$p){z$c++<5&&z$p&&alert(z$p.stack||z$p)}:null}),z$y.init=function(z$V,z$U,z$r){for(var z$s=[],z$p=2,z$c=arguments.length;z$p<z$c;z$p++)z$s.push(arguments[z$p]);if(!z$y._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=z$y._arrayBufferSlice),z$y._isinit=!0,z$j.__init__(),z$x.__init__(),z$_.__init__(),z$y.timer=new z$F,z$y.scaleTimer=new z$F,z$y.loader=new z$NV,z$C.__init__(),z$p=0;for(var z$R=z$s.length;z$p<z$R;z$p++)z$s[z$p].enable&&z$s[z$p].enable();return z$G.__init__(),z$T.__init__(),z$$.__init__(),z$J.beginCheck(),z$y._currentStage=z$y.stage=new z$lV,z$y.stage.conchModel&&z$y.stage.conchModel.setRootNode(),z$y._getUrlPath(),z$y.render=new z$m(0,0),z$y.stage.size(z$V,z$U),z$Z.__init__(),z$S.__init__(),z$u.instance.__init__(z$y.stage,z$m.canvas),z$dV.__init__(),z$H.autoStopMusic=!0,z$I.__init__(),z$m.canvas}},z$y._getUrlPath=function(){var z$V=z$j.window.location,z$U=z$V.pathname;z$U=z$U&&":"==z$U.charAt(2)?z$U.substring(1):z$U,z$K.rootPath=z$K.basePath=z$K.getPath("file:"==z$V.protocol?z$U:z$V.protocol+"//"+z$V.host+z$V.pathname)},z$y._arrayBufferSlice=function(z$V,z$U){var z$r=new Uint8Array(this,z$V,z$U-z$V),z$s=new Uint8Array(z$r.length);return z$s.set(z$r),z$s.buffer},z$y._runScript=function(z$V){return z$j.window[z$y._evcode](z$V)},z$y.stage=null,z$y.timer=null,z$y.scaleTimer=null,z$y.loader=null,z$y.version="1.8.6",z$y.render=null,z$y._currentStage=null,z$y._isinit=!1,z$y.isDebug=!1,z$y.MiniAdpter={init:function(){z$R.navigator&&z$R.navigator.userAgent&&-1<z$R.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},z$N(z$y,["conchMarket",function(){return this.conchMarket=z$R.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=z$R.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function z$V(){}return z$b(z$V,"Config"),z$V.WebGLTextCacheCount=500,z$V.atlasEnable=!1,z$V.showCanvasMark=!1,z$V.animationInterval=50,z$V.isAntialias=!1,z$V.isAlpha=!1,z$V.premultipliedAlpha=!0,z$V.isStencil=!0,z$V.preserveDrawingBuffer=!1,z$V}()),z$t=function(){function z$t(){this._events=null}z$b(z$t,"laya.events.EventDispatcher");var z$V=z$t.prototype;return z$V.hasListener=function(z$V){return!!(this._events&&this._events[z$V])},z$V.getListener=function(z$V){return this._events?this._events[z$V]:null},z$V.event=function(z$V,z$U){if(!this._events||!this._events[z$V])return!1;var z$r=this._events[z$V];if(z$r.lock)z$r.queue||(z$r.queue=[]),z$r.queue.push(z$U);else{var z$s;for(z$r.lock=!0,z$r.cursor=z$r.head;z$r.cursor;)(z$s=z$r.cursor).recover?(z$r.head=z$r.tail=z$r.cursor=null,console.error("node is recover："+z$s.id)):(z$r.cursor=z$s.next,z$s.once&&z$t.delNode(z$r,z$s),z$s.method&&(null!=z$U?z$s.args?z$s.method.apply(z$s.caller,z$s.args.concat(z$U)):z$U instanceof Array?z$s.method.apply(z$s.caller,z$U):z$s.caller?z$s.method.call(z$s.caller,z$U):z$y.recordError("事件派发错误","node.caller:"+z$s.caller+"node.method:"+z$s.method+"data:"+z$U+"node.prev"+z$s.prev):z$s.method.apply(z$s.caller,z$s.args)),z$s.once&&z$t.recoverHandler(z$s));z$r.lock=!1,!z$r.head&&this._events&&this._events[z$V]==z$r&&delete this._events[z$V],z$r.queue&&z$r.queue.length&&this.event(z$V,z$r.queue.shift())}return!0},z$V.on=function(z$V,z$U,z$r,z$s){return this._createListener(z$V,z$U,z$r,z$s,!1)},z$V.once=function(z$V,z$U,z$r,z$s){return this._createListener(z$V,z$U,z$r,z$s,!0)},z$V._createListener=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=!0),z$c&&this.off(z$V,z$U,z$r,z$p);var z$R=z$t.createHandler(z$U||this,z$r,z$s,z$p);this._events||(this._events={});var z$T=this._events,z$N=z$T[z$V];return z$N?z$N.tail?(z$R.prev=z$N.tail,z$N.tail.next=z$R,z$N.tail=z$R):z$N.head=z$N.tail=z$R:z$T[z$V]={head:z$R,tail:z$R,cursor:null,lock:!1},this},z$V.off=function(z$V,z$U,z$r,z$s){if(void 0===z$s&&(z$s=!1),!this._events||!this._events[z$V])return this;for(var z$p=this._events[z$V],z$c=z$p.head;z$c;){if((!z$U||z$c.caller===z$U)&&z$c.method===z$r&&(!z$s||z$c.once)){z$t.delNode(z$p,z$c),z$p.cursor==z$c&&(z$p.cursor=z$c.next),z$t.recoverHandler(z$c);break}z$c=z$c.next}return this},z$V.offAll=function(z$V){var z$U=this._events;if(!z$U)return this;if(z$V)this._recoverHandlers(z$U[z$V]),delete z$U[z$V];else{for(var z$r in z$U)this._recoverHandlers(z$U[z$r]);this._events=null}return this},z$V._recoverHandlers=function(z$V){if(z$V){for(var z$U=z$V.head;z$U;){z$t.delNode(z$V,z$U);var z$r=z$U.next;z$t.recoverHandler(z$U),z$U=z$r}z$V.cursor=null}},z$V.isMouseEvent=function(z$V){return z$t.MOUSE_EVENTS[z$V]},z$t.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},z$t.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},z$t.delNode=function(z$V,z$U){z$U.prev?z$U.prev.next=z$U.next:z$V.head=z$U.next,z$U.next?z$U.next.prev=z$U.prev:z$V.tail=z$U.prev},z$t.createHandler=function(z$V,z$U,z$r,z$s){var z$p=500<z$t._freeHandler.length?z$t._freeHandler.shift():null;if(z$p)if(z$p.recover)z$p.recover=!1,z$p.caller=z$V,z$p.method=z$U,z$p.args=z$r,z$p.once=z$s;else{var z$c="";try{arguments.propertyIsEnumerable.caller}catch(z$V){z$c=z$V.stack}var z$R=z$p.caller?(z$p.caller.__proto__&&z$p.caller.__proto__.constructor&&z$p.caller.__proto__.constructor.name)+"|"+z$p.caller.__className+"|"+z$p.caller.name:"",z$T=z$p.method?z$p.method.name:"";z$y.recordError("EventDispatcher重复创建","caller="+z$R+"  method="+z$T+"  stack="+z$c),z$p={id:++z$t._nodeCount,caller:z$V,method:z$U,args:z$r,once:z$s,recover:!1}}else z$p={id:++z$t._nodeCount,caller:z$V,method:z$U,args:z$r,once:z$s,recover:!1};return z$p.prev=z$p.next=null,z$p},z$t.recoverHandler=function(z$V){if(z$V.recover){if(z$t._errorCount<5){z$t._errorCount++;var z$U="";try{arguments.propertyIsEnumerable.caller}catch(z$V){z$U=z$V.stack}var z$r=z$V.caller?(z$V.caller.__proto__&&z$V.caller.__proto__.constructor&&z$V.caller.__proto__.constructor.name)+"|"+z$V.caller.__className+"|"+z$V.caller.name:"",z$s=z$V.method?z$V.method.name:"";z$y.recordError("EventDispatcher重复回收","id="+z$V.id+"  caller="+z$r+"  method="+z$s+"  stack="+z$U)}z$V.caller=z$V.method=z$V.args=z$V.prev=null}else z$V.recover=!0,z$V.caller=z$V.method=z$V.args=z$V.prev=z$V.next=null,z$t._freeHandler&&z$t._freeHandler.length<3e3&&z$t._freeHandler.push(z$V)},z$t._freeHandler=[],z$t._nodeCount=0,z$t._errorCount=0,z$t}(),z$W=function(){function z$p(z$V,z$U,z$r,z$s){this.once=!1,void(this._id=0)===z$s&&(z$s=!1),this.setTo(z$V,z$U,z$r,z$s)}z$b(z$p,"laya.utils.Handler");var z$V=z$p.prototype;return z$V.setTo=function(z$V,z$U,z$r,z$s){return this._id=z$p._gid++,this.caller=z$V,this.method=z$U,this.args=z$r,this.once=z$s,this},z$V.run=function(){if(null==this.method)return null;var z$V=this._id,z$U=this.method.apply(this.caller,this.args);return this._id===z$V&&this.once&&this.recover(),z$U},z$V.runWith=function(z$V){if(null==this.method)return null;var z$U=this._id;if(null==z$V)var z$r=this.method.apply(this.caller,this.args);else z$r=this.args||z$V.unshift?this.args?this.method.apply(this.caller,this.args.concat(z$V)):this.method.apply(this.caller,z$V):this.method.call(this.caller,z$V);return this._id===z$U&&this.once&&this.recover(),z$r},z$V.clear=function(){return this.caller=null,this.method=null,this.args=null,this},z$V.recover=function(){0<this._id&&(this._id=0,this.clear())},z$p.create=function(z$V,z$U,z$r,z$s){return void 0===z$s&&(z$s=!0),new z$p(z$V,z$U,z$r,z$s)},z$p._gid=1,z$p}(),z$Q=function(){function z$V(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}z$b(z$V,"laya.display.BitmapFont");var z$U=z$V.prototype;return z$U.loadFont=function(z$V,z$U){this._path=z$V,this._complete=z$U,z$y.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],z$W.create(this,this.onLoaded))},z$U.onLoaded=function(){this.parseFont(z$TV.getRes(this._path),z$TV.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},z$U.parseFont=function(z$V,z$U){if(null!=z$V&&null!=z$U){this._texture=z$U;var z$r=z$V.getElementsByTagName("info");if(!z$r[0].getAttributeNode)return this.parseFont2(z$V,z$U);this.fontSize=parseInt(z$r[0].getAttributeNode("size").nodeValue);var z$s,z$p=z$r[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(z$p[0]),parseInt(z$p[1]),parseInt(z$p[2]),parseInt(z$p[3])],z$s=z$V.getElementsByTagName("char");var z$c=0;for(z$c=0;z$c<z$s.length;z$c++){var z$R=z$s[z$c],z$T=parseInt(z$R.getAttributeNode("id").nodeValue),z$N=parseInt(z$R.getAttributeNode("xoffset").nodeValue)/1,z$t=parseInt(z$R.getAttributeNode("yoffset").nodeValue)/1,z$b=parseInt(z$R.getAttributeNode("xadvance").nodeValue)/1,z$S=new z$n;z$S.x=parseInt(z$R.getAttributeNode("x").nodeValue),z$S.y=parseInt(z$R.getAttributeNode("y").nodeValue),z$S.width=parseInt(z$R.getAttributeNode("width").nodeValue),z$S.height=parseInt(z$R.getAttributeNode("height").nodeValue);var z$_=z$bV.create(z$U,z$S.x,z$S.y,z$S.width,z$S.height,z$N,z$t);this._maxWidth=Math.max(this._maxWidth,z$b+this.letterSpacing),this._fontCharDic[z$T]=z$_,this._fontWidthMap[z$T]=z$b}}},z$U.parseFont2=function(z$V,z$U){if(null!=z$V&&null!=z$U){this._texture=z$U;var z$r=z$V.getElementsByTagName("info");this.fontSize=parseInt(z$r[0].attributes.size.nodeValue);var z$s=z$r[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(z$s[0]),parseInt(z$s[1]),parseInt(z$s[2]),parseInt(z$s[3])];var z$p=z$V.getElementsByTagName("char"),z$c=0;for(z$c=0;z$c<z$p.length;z$c++){var z$R=z$p[z$c].attributes,z$T=parseInt(z$R.id.nodeValue),z$N=parseInt(z$R.xoffset.nodeValue)/1,z$t=parseInt(z$R.yoffset.nodeValue)/1,z$b=parseInt(z$R.xadvance.nodeValue)/1,z$S=new z$n;z$S.x=parseInt(z$R.x.nodeValue),z$S.y=parseInt(z$R.y.nodeValue),z$S.width=parseInt(z$R.width.nodeValue),z$S.height=parseInt(z$R.height.nodeValue);var z$_=z$bV.create(z$U,z$S.x,z$S.y,z$S.width,z$S.height,z$N,z$t);this._maxWidth=Math.max(this._maxWidth,z$b+this.letterSpacing),this._fontCharDic[z$T]=z$_,this._fontWidthMap[z$T]=z$b}}},z$U.getCharTexture=function(z$V){return this._fontCharDic[z$V.charCodeAt(0)]},z$U.destroy=function(){if(this._texture){for(var z$V in this._fontCharDic){var z$U=this._fontCharDic[z$V];z$U&&z$U.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},z$U.setSpaceWidth=function(z$V){this._spaceWidth=z$V},z$U.getCharWidth=function(z$V){var z$U=z$V.charCodeAt(0);return this._fontWidthMap[z$U]?this._fontWidthMap[z$U]+this.letterSpacing:" "==z$V?this._spaceWidth+this.letterSpacing:0},z$U.getTextWidth=function(z$V){for(var z$U=0,z$r=0,z$s=z$V.length;z$r<z$s;z$r++)z$U+=this.getCharWidth(z$V.charAt(z$r));return z$U},z$U.getMaxWidth=function(){return this._maxWidth},z$U.getMaxHeight=function(){return this.fontSize},z$U.drawText=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T=this.getTextWidth(z$V),z$N=0;"center"===z$p&&(z$N=(z$c-z$T)/2),"right"===z$p&&(z$N=z$c-z$T);for(var z$t=0,z$b=0,z$S=z$V.length;z$b<z$S;z$b++)(z$R=this.getCharTexture(z$V.charAt(z$b)))&&(z$U.graphics.drawTexture(z$R,z$r+z$t+z$N,z$s),z$t+=this.getCharWidth(z$V.charAt(z$b)))},z$V}(),z$T=function(){function z$r(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=z$r._TF_EMPTY}z$b(z$r,"laya.display.css.Style");var z$V=z$r.prototype;return z$V.getTransform=function(){return this._tf},z$V.setTransform=function(z$V){this._tf="none"!==z$V&&z$V?z$V:z$r._TF_EMPTY},z$V.setTranslateX=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.translateX=z$V},z$V.setTranslateY=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.translateY=z$V},z$V.setScaleX=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.scaleX=z$V},z$V.setScale=function(z$V,z$U){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.scaleX=z$V,this._tf.scaleY=z$U},z$V.setScaleY=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.scaleY=z$V},z$V.setRotate=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.rotate=z$V},z$V.setSkewX=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.skewX=z$V},z$V.setSkewY=function(z$V){this._tf===z$r._TF_EMPTY&&(this._tf=new z$p),this._tf.skewY=z$V},z$V.destroy=function(){this.scrollRect=null},z$V.render=function(z$V,z$U,z$r,z$s){},z$V.getCSSStyle=function(){return z$UV.EMPTY},z$V._enableLayout=function(){return!1},z$q(0,z$V,"scaleX",function(){return this._tf.scaleX},function(z$V){this.setScaleX(z$V)}),z$q(0,z$V,"transform",function(){return this.getTransform()},function(z$V){this.setTransform(z$V)}),z$q(0,z$V,"translateX",function(){return this._tf.translateX},function(z$V){this.setTranslateX(z$V)}),z$q(0,z$V,"translateY",function(){return this._tf.translateY},function(z$V){this.setTranslateY(z$V)}),z$q(0,z$V,"scaleY",function(){return this._tf.scaleY},function(z$V){this.setScaleY(z$V)}),z$q(0,z$V,"block",function(){return 0!=(1&this._type)}),z$q(0,z$V,"skewY",function(){return this._tf.skewY},function(z$V){this.setSkewY(z$V)}),z$q(0,z$V,"rotate",function(){return this._tf.rotate},function(z$V){this.setRotate(z$V)}),z$q(0,z$V,"skewX",function(){return this._tf.skewX},function(z$V){this.setSkewX(z$V)}),z$q(0,z$V,"paddingLeft",function(){return 0}),z$q(0,z$V,"paddingTop",function(){return 0}),z$q(0,z$V,"absolute",function(){return!0}),z$r.__init__=function(){z$r._TF_EMPTY=new z$p,z$r.EMPTY=new z$r},z$r.EMPTY=null,z$r._TF_EMPTY=null,z$r}(),z$G=function(){function z$U(z$V){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=z$B.create(z$U.defaultColor),this.family=z$U.defaultFamily,this.stroke=z$U._STROKE,this.size=z$U.defaultSize,z$V&&z$V!==z$U.EMPTY&&z$V.copyTo(this)}z$b(z$U,"laya.display.css.Font");var z$V=z$U.prototype;return z$V.set=function(z$V){this._text=null;for(var z$U=z$V.split(" "),z$r=0,z$s=z$U.length;z$r<z$s;z$r++){var z$p=z$U[z$r];switch(z$p){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<z$p.indexOf("px")&&(this.size=parseInt(z$p),this.family=z$U[z$r+1],z$r++)}},z$V.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},z$V.copyTo=function(z$V){z$V._type=this._type,z$V._text=this._text,z$V._weight=this._weight,z$V._color=this._color,z$V.family=this.family,z$V.stroke=this.stroke!=z$U._STROKE?this.stroke.slice():z$U._STROKE,z$V.indent=this.indent,z$V.size=this.size},z$q(0,z$V,"password",function(){return 0!=(1024&this._type)},function(z$V){z$V?this._type|=1024:this._type&=-1025}),z$q(0,z$V,"color",function(){return this._color.strColor},function(z$V){this._color=z$B.create(z$V)}),z$q(0,z$V,"italic",function(){return 0!=(512&this._type)},function(z$V){z$V?this._type|=512:this._type&=-513}),z$q(0,z$V,"bold",function(){return 0!=(2048&this._type)},function(z$V){z$V?this._type|=2048:this._type&=-2049}),z$q(0,z$V,"weight",function(){return""+this._weight},function(z$V){var z$U=0;switch(z$V){case"normal":break;case"bold":this.bold=!0,z$U=700;break;case"bolder":z$U=800;break;case"lighter":z$U=100;break;default:z$U=parseInt(z$V)}this._weight=z$U,this._text=null}),z$q(0,z$V,"decoration",function(){return this._decoration?this._decoration.value:null},function(z$V){var z$U=z$V.split(" ");switch(this._decoration||(this._decoration={}),z$U[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=z$U[0]}z$U[1]&&(this._decoration.color=z$B.create(z$U)),this._decoration.value=z$V}),z$U.__init__=function(){z$U.EMPTY=new z$U(null)},z$U.EMPTY=null,z$U.defaultColor="#000000",z$U.defaultSize=12,z$U.defaultFamily="Arial",z$U.defaultFont="12px Arial",z$U._STROKE=[0,"#000000"],z$U._ITALIC=512,z$U._PASSWORD=1024,z$U._BOLD=2048,z$U}(),z$p=function(){function z$V(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return z$b(z$V,"laya.display.css.TransformInfo"),z$V}(),z$_=function(){function z$S(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,z$m.isConchNode){this._nativeObj=new z$R._conchGraphics,this.id=this._nativeObj.conchID}}z$b(z$S,"laya.display.Graphics");var z$V=z$S.prototype;return z$V.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},z$V.clear=function(z$V){void 0===z$V&&(z$V=!1);var z$U=0,z$r=0;if(z$V){var z$s=this._one;if(this._cmds){for(z$r=this._cmds.length,z$U=0;z$U<z$r;z$U++)!(z$s=this._cmds[z$U])||z$s.callee!==z$m._context._drawTexture&&z$s.callee!==z$m._context._drawTextureWithTransform||(z$s[0]=null,z$S._cache.push(z$s));this._cmds.length=0}else z$s&&(!z$s||z$s.callee!==z$m._context._drawTexture&&z$s.callee!==z$m._context._drawTextureWithTransform||(z$s[0]=null,z$S._cache.push(z$s)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(z$U=0,z$r=this._vectorgraphArray.length;z$U<z$r;z$U++)z$Y.getInstance().deleteShape(this._vectorgraphArray[z$U]);this._vectorgraphArray.length=0}},z$V._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},z$V._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new z$r,this._graphicBounds._graphics=this)},z$V._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},z$V._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},z$V.getBounds=function(z$V){return void 0===z$V&&(z$V=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(z$V)},z$V.getBoundPoints=function(z$V){return void 0===z$V&&(z$V=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(z$V)},z$V._addCmd=function(z$V){this._cmds=this._cmds||[],z$V.callee=z$V.shift(),this._cmds.push(z$V)},z$V.setFilters=function(z$V){this._saveToCmd(z$m._context._setFilters,z$V)},z$V.drawTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$R&&(z$R=1),!z$V||z$R<.01)return null;z$s||(z$s=z$V.sourceWidth),z$p||(z$p=z$V.sourceHeight),z$R=z$R<0?0:1<z$R?1:z$R;var z$T,z$N=!z$m.isWebGL&&(z$j.onFirefox||z$j.onEdge||z$j.onIE||z$j.onSafari)?.5:0,z$t=z$s/z$V.sourceWidth,z$b=z$p/z$V.sourceHeight;return z$s=z$V.width*z$t,z$p=z$V.height*z$b,z$V.loaded&&(z$s<=0||z$p<=0)?null:(z$U+=z$V.offsetX*z$t,z$r+=z$V.offsetY*z$b,this._sp&&(this._sp._renderType|=512),z$U-=z$N,z$r-=z$N,z$s+=2*z$N,z$p+=2*z$N,z$S._cache.length?((z$T=z$S._cache.pop())[0]=z$V,z$T[1]=z$U,z$T[2]=z$r,z$T[3]=z$s,z$T[4]=z$p,z$T[5]=z$c,z$T[6]=z$R):z$T=[z$V,z$U,z$r,z$s,z$p,z$c,z$R],z$T.callee=z$c||1!=z$R?z$m._context._drawTextureWithTransform:z$m._context._drawTexture,null!=this._one||z$c||1!=z$R?this._saveToCmd(z$T.callee,z$T):(this._one=z$T,this._render=this._renderOneImg),z$V.loaded||z$V.once("loaded",this,this._textureLoaded,[z$V,z$T]),this._repaint(),z$T)},z$V.cleanByTexture=function(z$V,z$U,z$r,z$s,z$p){if(void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),!z$V)return this.clear();if(this._one&&this._render===this._renderOneImg){z$s||(z$s=z$V.sourceWidth),z$p||(z$p=z$V.sourceHeight);var z$c=z$s/z$V.sourceWidth,z$R=z$p/z$V.sourceHeight;z$s=z$V.width*z$c,z$p=z$V.height*z$R,z$U+=z$V.offsetX*z$c,z$r+=z$V.offsetY*z$R,this._one[0]=z$V,this._one[1]=z$U,this._one[2]=z$r,this._one[3]=z$s,this._one[4]=z$p,this._repaint()}else this.clear(),z$V&&this.drawTexture(z$V,z$U,z$r,z$s,z$p)},z$V.drawTextures=function(z$V,z$U){z$V&&this._saveToCmd(z$m._context._drawTextures,[z$V,z$U])},z$V.fillTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c="repeat"),z$V){var z$T=[z$V,z$U,z$r,z$s,z$p,z$c,z$R||z$D.EMPTY,{}];z$V.loaded||z$V.once("loaded",this,this._textureLoaded,[z$V,z$T]),this._saveToCmd(z$m._context._fillTexture,z$T)}},z$V._textureLoaded=function(z$V,z$U){z$U[3]=z$U[3]||z$V.width,z$U[4]=z$U[4]||z$V.height,this._repaint()},z$V.fillCircle=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$r.bitmap.enableMerageInAtlas=!1;var z$T=new Float32Array(2*(z$R+1)),z$N=new Float32Array(2*(z$R+1)),z$t=new Uint16Array(3*z$R),z$b=2*Math.PI/z$R,z$S=0;z$T[0]=z$s,z$T[1]=z$p,z$N[0]=z$s/z$r.width,z$N[1]=z$p/z$r.height;for(var z$_=2,z$G=0;z$G<z$R;z$G++){var z$q=z$c*Math.cos(z$S)+z$s,z$u=z$c*Math.sin(z$S)+z$p;z$T[z$_]=z$q,z$T[z$_+1]=z$u,z$N[z$_]=z$q/z$r.width,z$N[z$_+1]=z$u/z$r.height,z$S+=z$b,z$_+=2}for(z$G=z$_=0;z$G<z$R;z$G++)z$t[z$_++]=0,z$t[z$_++]=z$G+1,z$t[z$_++]=z$R+1<=z$G+2?1:z$G+2;this.drawTriangles(z$r,z$V,z$U,z$T,z$N,z$t)},z$V.drawTriangles=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){void 0===z$T&&(z$T=1),this._saveToCmd(z$m._context.drawTriangles,[z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t])},z$V._saveToCmd=function(z$V,z$U){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=z$U,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(z$U)),z$U.callee=z$V,this._repaint(),z$U},z$V.clipRect=function(z$V,z$U,z$r,z$s){this._saveToCmd(z$m._context._clipRect,[z$V,z$U,z$r,z$s])},z$V.fillText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){void 0===z$R&&(z$R=0),this._saveToCmd(z$m._context._fillText,[z$V,z$U,z$r,z$s||z$G.defaultFont,z$p,z$c])},z$V.fillBorderText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){this._saveToCmd(z$m._context._fillBorderText,[z$V,z$U,z$r,z$s||z$G.defaultFont,z$p,z$c,z$R,z$T])},z$V.strokeText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._saveToCmd(z$m._context._strokeText,[z$V,z$U,z$r,z$s||z$G.defaultFont,z$p,z$c,z$R])},z$V.alpha=function(z$V){z$V=z$V<0?0:1<z$V?1:z$V,this._saveToCmd(z$m._context._alpha,[z$V])},z$V.setAlpha=function(z$V){z$V=z$V<0?0:1<z$V?1:z$V,this._saveToCmd(z$m._context._setAlpha,[z$V])},z$V.transform=function(z$V,z$U,z$r){void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),this._saveToCmd(z$m._context._transform,[z$V,z$U,z$r])},z$V.rotate=function(z$V,z$U,z$r){void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),this._saveToCmd(z$m._context._rotate,[z$V,z$U,z$r])},z$V.scale=function(z$V,z$U,z$r,z$s){void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),this._saveToCmd(z$m._context._scale,[z$V,z$U,z$r,z$s])},z$V.translate=function(z$V,z$U){this._saveToCmd(z$m._context._translate,[z$V,z$U])},z$V.save=function(){this._saveToCmd(z$m._context._save,[])},z$V.restore=function(){this._saveToCmd(z$m._context._restore,[])},z$V.replaceText=function(z$V){this._repaint();var z$U=this._cmds;if(z$U){for(var z$r=z$U.length-1;-1<z$r;z$r--)if(this._isTextCmd(z$U[z$r].callee))return z$U[z$r][0].toUpperCase?z$U[z$r][0]=z$V:z$U[z$r][0].setText(z$V),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=z$V:this._one[0].setText(z$V),!0;return!1},z$V._isTextCmd=function(z$V){return z$V===z$m._context._fillText||z$V===z$m._context._fillBorderText||z$V===z$m._context._strokeText},z$V.replaceTextColor=function(z$V){this._repaint();var z$U=this._cmds;if(z$U)for(var z$r=z$U.length-1;-1<z$r;z$r--)this._isTextCmd(z$U[z$r].callee)&&(z$U[z$r][4]=z$V,z$U[z$r][0].toUpperCase||(z$U[z$r][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=z$V,this._one[0].toUpperCase||(this._one[0].changed=!0))},z$V.loadImage=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=this;void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0);var z$T=z$TV.getRes(z$V);function z$N(z$V){z$V&&(z$R.drawTexture(z$V,z$U,z$r,z$s,z$p),null!=z$c&&z$c.call(z$R._sp,z$V))}z$T?z$N(z$T):z$y.loader.load(z$V,z$W.create(null,z$N),null,"image")},z$V._renderEmpty=function(z$V,z$U,z$r,z$s){},z$V._renderAll=function(z$V,z$U,z$r,z$s){for(var z$p,z$c=this._cmds,z$R=0,z$T=z$c.length;z$R<z$T;z$R++)(z$p=z$c[z$R]).callee.call(z$U,z$r,z$s,z$p)},z$V._renderOne=function(z$V,z$U,z$r,z$s){this._one.callee.call(z$U,z$r,z$s,this._one)},z$V._renderOneImg=function(z$V,z$U,z$r,z$s){this._one.callee.call(z$U,z$r,z$s,this._one),2305!==z$V._renderType&&(z$V._renderType|=1)},z$V.drawLine=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=1);var z$R=0;z$m.isWebGL&&(z$R=z$Y.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(z$R));var z$T=z$c%2==0?0:.5,z$N=[z$V+z$T,z$U+z$T,z$r+z$T,z$s+z$T,z$p,z$c,z$R];this._saveToCmd(z$m._context._drawLine,z$N)},z$V.drawLines=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=1);var z$c=0;if(z$r&&!(z$r.length<4)){z$m.isWebGL&&(z$c=z$Y.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(z$c));var z$R=z$p%2==0?0:.5,z$T=[z$V+z$R,z$U+z$R,z$r,z$s,z$p,z$c];this._saveToCmd(z$m._context._drawLines,z$T)}},z$V.drawCurves=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=1);var z$c=[z$V,z$U,z$r,z$s,z$p];this._saveToCmd(z$m._context._drawCurves,z$c)},z$V.drawRect=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){void 0===z$R&&(z$R=1);var z$T=z$c?z$R/2:0,z$N=z$c?z$R:0,z$t=[z$V+z$T,z$U+z$T,z$r-z$N,z$s-z$N,z$p,z$c,z$R];this._saveToCmd(z$m._context._drawRect,z$t)},z$V.drawCircle=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=1);var z$R=z$p?z$c/2:0,z$T=0;z$m.isWebGL&&(z$T=z$Y.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(z$T));var z$N=[z$V,z$U,z$r-z$R,z$s,z$p,z$c,z$T];this._saveToCmd(z$m._context._drawCircle,z$N)},z$V.drawPie=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){void 0===z$T&&(z$T=1);var z$N=z$R?z$T/2:0,z$t=z$R?z$T:0,z$b=0;z$m.isWebGL&&(z$b=z$Y.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(z$b));var z$S=[z$V+z$N,z$U+z$N,z$r-z$t,z$s,z$p,z$c,z$R,z$T,z$b];z$S[3]=z$v.toRadian(z$s),z$S[4]=z$v.toRadian(z$p),this._saveToCmd(z$m._context._drawPie,z$S)},z$V.drawPoly=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=1);var z$R=0,z$T=!1;z$m.isWebGL&&(z$R=z$Y.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(z$R),z$T=!(6<z$r.length));var z$N=z$p?z$c%2==0?0:.5:0,z$t=[z$V+z$N,z$U+z$N,z$r,z$s,z$p,z$c,z$R,z$T];this._saveToCmd(z$m._context._drawPoly,z$t)},z$V.drawPath=function(z$V,z$U,z$r,z$s,z$p){var z$c=[z$V,z$U,z$r,z$s,z$p];this._saveToCmd(z$m._context._drawPath,z$c)},z$q(0,z$V,"cmds",function(){return this._cmds},function(z$V){this._sp&&(this._sp._renderType|=512),this._cmds=z$V,this._render=this._renderAll,this._repaint()}),z$S.__init__=function(){if(z$m.isConchNode){for(var z$V=laya.display.Graphics.prototype,z$U=z$j.window.ConchGraphics.prototype,z$r=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],z$s=0,z$p=z$r.length;z$s<=z$p;z$s++){var z$c=z$r[z$s];z$V[z$c]=z$U[z$c]}z$V._saveToCmd=null,z$U.drawImageS&&(z$V.drawTextures=function(z$V,z$U){if(z$V&&z$V.loaded&&z$V.bitmap&&z$V.source){var z$r=z$V.uv,z$s=z$V.bitmap.width,z$p=z$V.bitmap.height;this.drawImageS(z$V.bitmap.source,z$r[0]*z$s,z$r[1]*z$p,(z$r[2]-z$r[0])*z$s,(z$r[5]-z$r[3])*z$p,z$V.offsetX,z$V.offsetY,z$V.width,z$V.height,z$U)}}),z$V.drawTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$R&&(z$R=1),z$V)if(z$V.loaded){if(z$V.loaded&&z$V.bitmap&&z$V.source&&(z$s||(z$s=z$V.sourceWidth),z$p||(z$p=z$V.sourceHeight),z$R=z$R<0?0:1<z$R?1:z$R,z$s=z$s-z$V.sourceWidth+z$V.width,z$p=z$p-z$V.sourceHeight+z$V.height,!(z$s<=0||z$p<=0))){z$U+=z$V.offsetX,z$r+=z$V.offsetY;var z$T=z$V.uv,z$N=z$V.bitmap.width,z$t=z$V.bitmap.height;z$T[4]<z$T[0]&&z$T[5]<z$T[1]?this.drawImageM(z$V.bitmap.source,z$T[4]*z$N,z$T[5]*z$t,(z$T[0]-z$T[4])*z$N,(z$T[1]-z$T[5])*z$t,z$U,z$r,z$s,z$p,z$c,z$R):this.drawImageM(z$V.bitmap.source,z$T[0]*z$N,z$T[1]*z$t,(z$T[2]-z$T[0])*z$N,(z$T[5]-z$T[3])*z$t,z$U,z$r,z$s,z$p,z$c,z$R),this._repaint()}}else z$V.once("loaded",this,function(){this.drawTexture(z$V,z$U,z$r,z$s,z$p,z$c)})},z$V.fillTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c="repeat"),z$V&&z$V.loaded){var z$T,z$N=z$m._context.ctx,z$t=z$V.bitmap.width,z$b=z$V.bitmap.height,z$S=z$V.uv;z$T=z$V.uv!=z$bV.DEF_UV?z$N.createPattern(z$V.bitmap.source,z$c,z$S[0]*z$t,z$S[1]*z$b,(z$S[2]-z$S[0])*z$t,(z$S[5]-z$S[3])*z$b):z$N.createPattern(z$V.bitmap.source,z$c);var z$_=0,z$G=0;z$R&&(z$U+=z$R.x%z$V.width,z$r+=z$R.y%z$V.height,z$_-=z$R.x%z$V.width,z$G-=z$R.y%z$V.height),this._fillImage(z$T,z$U,z$r,z$_,z$G,z$s,z$p)}}}},z$S._cache=[],z$S}(),z$r=function(){function z$O(){this._cacheBoundsType=!1}z$b(z$O,"laya.display.GraphicsBounds");var z$V=z$O.prototype;return z$V.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},z$V.reset=function(){this._temp&&(this._temp.length=0)},z$V.getBounds=function(z$V){return void 0===z$V&&(z$V=!1),(!this._bounds||!this._temp||this._temp.length<1||z$V!=this._cacheBoundsType)&&(this._bounds=z$n._getWrapRec(this.getBoundPoints(z$V),this._bounds)),this._cacheBoundsType=z$V,this._bounds},z$V.getBoundPoints=function(z$V){return void 0===z$V&&(z$V=!1),(!this._temp||this._temp.length<1||z$V!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(z$V)),this._cacheBoundsType=z$V,this._rstBoundPoints=z$v.copyArray(this._rstBoundPoints,this._temp)},z$V._getCmdPoints=function(z$V){void 0===z$V&&(z$V=!1);var z$U,z$r,z$s=z$m._context,z$p=this._graphics.cmds;if((z$U=this._temp||(this._temp=[])).length=0,z$p||null==this._graphics._one||(z$O._tempCmds.length=0,z$O._tempCmds.push(this._graphics._one),z$p=z$O._tempCmds),!z$p)return z$U;(z$r=z$O._tempMatrixArrays).length=0;var z$c=z$O._initMatrix;z$c.identity();for(var z$R,z$T,z$N=z$O._tempMatrix,z$t=NaN,z$b=NaN,z$S=NaN,z$_=NaN,z$G=NaN,z$q=NaN,z$u=0,z$h=z$p.length;z$u<z$h;z$u++)if((z$R=z$p[z$u]).callee)switch(z$R.callee){case z$s._save:case 7:z$r.push(z$c),z$c=z$c.clone();break;case z$s._restore:case 8:z$c=z$r.pop();break;case z$s._scale:case 5:z$N.identity(),z$N.translate(-z$R[2],-z$R[3]),z$N.scale(z$R[0],z$R[1]),z$N.translate(z$R[2],z$R[3]),this._switchMatrix(z$c,z$N);break;case z$s._rotate:case 3:z$N.identity(),z$N.translate(-z$R[1],-z$R[2]),z$N.rotate(z$R[0]),z$N.translate(z$R[1],z$R[2]),this._switchMatrix(z$c,z$N);break;case z$s._translate:case 6:z$N.identity(),z$N.translate(z$R[0],z$R[1]),this._switchMatrix(z$c,z$N);break;case z$s._transform:case 4:z$N.identity(),z$N.translate(-z$R[1],-z$R[2]),z$N.concat(z$R[0]),z$N.translate(z$R[1],z$R[2]),this._switchMatrix(z$c,z$N);break;case 16:case 24:z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[0],z$R[1],z$R[2],z$R[3]),z$c);break;case 17:z$c.copyTo(z$N),z$N.concat(z$R[4]),z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[0],z$R[1],z$R[2],z$R[3]),z$N);break;case z$s._drawTexture:z$T=z$R[0],z$V?z$R[3]&&z$R[4]?z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$R[3],z$R[4]),z$c):(z$T=z$R[0],z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$T.width,z$T.height),z$c)):(z$t=(z$R[3]||z$T.sourceWidth)/z$T.width,z$b=(z$R[4]||z$T.sourceHeight)/z$T.height,z$S=z$t*z$T.sourceWidth,z$_=z$b*z$T.sourceHeight,z$G=0<z$T.offsetX?z$T.offsetX:0,z$q=0<z$T.offsetY?z$T.offsetY:0,z$G*=z$t,z$q*=z$b,z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1]-z$G,z$R[2]-z$q,z$S,z$_),z$c));break;case z$s._fillTexture:z$R[3]&&z$R[4]?z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$R[3],z$R[4]),z$c):(z$T=z$R[0],z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$T.width,z$T.height),z$c));break;case z$s._drawTextureWithTransform:var z$l;z$l=z$R[5]?(z$c.copyTo(z$N),z$N.concat(z$R[5]),z$N):z$c,z$V?z$R[3]&&z$R[4]?z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$R[3],z$R[4]),z$l):(z$T=z$R[0],z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1],z$R[2],z$T.width,z$T.height),z$l)):(z$T=z$R[0],z$t=(z$R[3]||z$T.sourceWidth)/z$T.width,z$b=(z$R[4]||z$T.sourceHeight)/z$T.height,z$S=z$t*z$T.sourceWidth,z$_=z$b*z$T.sourceHeight,z$G=0<z$T.offsetX?z$T.offsetX:0,z$q=0<z$T.offsetY?z$T.offsetY:0,z$G*=z$t,z$q*=z$b,z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[1]-z$G,z$R[2]-z$q,z$S,z$_),z$l));break;case z$s._drawRect:case 13:z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[0],z$R[1],z$R[2],z$R[3]),z$c);break;case z$s._drawCircle:case z$s._fillCircle:case 14:z$O._addPointArrToRst(z$U,z$n._getBoundPointS(z$R[0]-z$R[2],z$R[1]-z$R[2],z$R[2]+z$R[2],z$R[2]+z$R[2]),z$c);break;case z$s._drawLine:case 20:z$O._tempPoints.length=0;var z$W;z$W=.5*z$R[5],z$R[0]==z$R[2]?z$O._tempPoints.push(z$R[0]+z$W,z$R[1],z$R[2]+z$W,z$R[3],z$R[0]-z$W,z$R[1],z$R[2]-z$W,z$R[3]):z$R[1]==z$R[3]?z$O._tempPoints.push(z$R[0],z$R[1]+z$W,z$R[2],z$R[3]+z$W,z$R[0],z$R[1]-z$W,z$R[2],z$R[3]-z$W):z$O._tempPoints.push(z$R[0],z$R[1],z$R[2],z$R[3]),z$O._addPointArrToRst(z$U,z$O._tempPoints,z$c);break;case z$s._drawCurves:case 22:z$O._addPointArrToRst(z$U,z$L.I.getBezierPoints(z$R[2]),z$c,z$R[0],z$R[1]);break;case z$s._drawPoly:case z$s._drawLines:case 18:z$O._addPointArrToRst(z$U,z$R[2],z$c,z$R[0],z$R[1]);break;case z$s._drawPath:case 19:z$O._addPointArrToRst(z$U,this._getPathPoints(z$R[2]),z$c,z$R[0],z$R[1]);break;case z$s._drawPie:case 15:z$O._addPointArrToRst(z$U,this._getPiePoints(z$R[0],z$R[1],z$R[2],z$R[3],z$R[4]),z$c)}return 200<z$U.length?z$U=z$v.copyArray(z$U,z$n._getWrapRec(z$U)._getBoundPoints()):8<z$U.length&&(z$U=z$d.scanPList(z$U)),z$U},z$V._switchMatrix=function(z$V,z$U){z$U.concat(z$V),z$U.copyTo(z$V)},z$V._getPiePoints=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$O._tempPoints;z$O._tempPoints.length=0,z$c.push(z$V,z$U);var z$R=(z$p-z$s)%(2*Math.PI)/10,z$T=NaN,z$N=z$s;for(z$T=0;z$T<=10;z$T++)z$c.push(z$V+z$r*Math.cos(z$N),z$U+z$r*Math.sin(z$N)),z$N+=z$R;return z$c},z$V._getPathPoints=function(z$V){var z$U,z$r,z$s=0,z$p=z$O._tempPoints;for(z$p.length=0,z$U=z$V.length,z$s=0;z$s<z$U;z$s++)1<(z$r=z$V[z$s]).length&&(z$p.push(z$r[1],z$r[2]),3<z$r.length&&z$p.push(z$r[3],z$r[4]));return z$p},z$O._addPointArrToRst=function(z$V,z$U,z$r,z$s,z$p){void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0);var z$c,z$R=0;for(z$c=z$U.length,z$R=0;z$R<z$c;z$R+=2)z$O._addPointToRst(z$V,z$U[z$R]+z$s,z$U[z$R+1]+z$p,z$r)},z$O._addPointToRst=function(z$V,z$U,z$r,z$s){var z$p=z$D.TEMP;z$p.setTo(z$U||0,z$r||0),z$s.transformPoint(z$p),z$V.push(z$p.x,z$p.y)},z$O._tempPoints=[],z$O._tempMatrixArrays=[],z$O._tempCmds=[],z$N(z$O,["_tempMatrix",function(){return this._tempMatrix=new z$z},"_initMatrix",function(){return this._initMatrix=new z$z}]),z$O}(),z$c=function(){function z$V(){}z$b(z$V,"laya.events.Event");var z$U=z$V.prototype;return z$U.setTo=function(z$V,z$U,z$r){return this.type=z$V,this.currentTarget=z$U,this.target=z$r,this},z$U.stopPropagation=function(){this._stoped=!0},z$q(0,z$U,"stageY",function(){return z$y.stage.mouseY}),z$q(0,z$U,"charCode",function(){return this.nativeEvent.charCode}),z$q(0,z$U,"touches",function(){var z$V=this.nativeEvent.touches;if(z$V)for(var z$U=z$y.stage,z$r=0,z$s=z$V.length;z$r<z$s;z$r++){var z$p=z$V[z$r],z$c=z$D.TEMP;z$c.setTo(z$p.clientX,z$p.clientY),z$U._canvasTransform.invertTransformPoint(z$c),z$U.transform.invertTransformPoint(z$c),z$p.stageX=z$c.x,z$p.stageY=z$c.y}return z$V}),z$q(0,z$U,"keyLocation",function(){return this.nativeEvent.keyLocation}),z$q(0,z$U,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),z$q(0,z$U,"altKey",function(){return this.nativeEvent.altKey}),z$q(0,z$U,"shiftKey",function(){return this.nativeEvent.shiftKey}),z$q(0,z$U,"stageX",function(){return z$y.stage.mouseX}),z$V.EMPTY=new z$V,z$V.MOUSE_DOWN="mousedown",z$V.MOUSE_UP="mouseup",z$V.CLICK="click",z$V.RIGHT_MOUSE_DOWN="rightmousedown",z$V.RIGHT_MOUSE_UP="rightmouseup",z$V.RIGHT_CLICK="rightclick",z$V.MOUSE_MOVE="mousemove",z$V.MOUSE_OVER="mouseover",z$V.MOUSE_OUT="mouseout",z$V.MOUSE_WHEEL="mousewheel",z$V.ROLL_OVER="mouseover",z$V.ROLL_OUT="mouseout",z$V.DOUBLE_CLICK="doubleclick",z$V.CHANGE="change",z$V.CHANGED="changed",z$V.RESIZE="resize",z$V.ADDED="added",z$V.REMOVED="removed",z$V.DISPLAY="display",z$V.UNDISPLAY="undisplay",z$V.ERROR="error",z$V.COMPLETE="complete",z$V.LOADED="loaded",z$V.INITED="inited",z$V.PROGRESS="progress",z$V.INPUT="input",z$V.RENDER="render",z$V.OPEN="open",z$V.MESSAGE="message",z$V.CLOSE="close",z$V.KEY_DOWN="keydown",z$V.KEY_PRESS="keypress",z$V.KEY_UP="keyup",z$V.FRAME="enterframe",z$V.DRAG_START="dragstart",z$V.DRAG_MOVE="dragmove",z$V.DRAG_END="dragend",z$V.ENTER="enter",z$V.SELECT="select",z$V.BLUR="blur",z$V.FOCUS="focus",z$V.VISIBILITY_CHANGE="visibilitychange",z$V.FOCUS_CHANGE="focuschange",z$V.PLAYED="played",z$V.PAUSED="paused",z$V.STOPPED="stopped",z$V.START="start",z$V.END="end",z$V.ENABLE_CHANGED="enablechanged",z$V.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",z$V.COMPONENT_ADDED="componentadded",z$V.COMPONENT_REMOVED="componentremoved",z$V.LAYER_CHANGED="layerchanged",z$V.HIERARCHY_LOADED="hierarchyloaded",z$V.RECOVERED="recovered",z$V.RELEASED="released",z$V.LINK="link",z$V.LABEL="label",z$V.FULL_SCREEN_CHANGE="fullscreenchange",z$V.DEVICE_LOST="devicelost",z$V.MESH_CHANGED="meshchanged",z$V.MATERIAL_CHANGED="materialchanged",z$V.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",z$V.ANIMATION_CHANGED="animationchanged",z$V.TRIGGER_ENTER="triggerenter",z$V.TRIGGER_STAY="triggerstay",z$V.TRIGGER_EXIT="triggerexit",z$V.TRAIL_FILTER_CHANGE="trailfilterchange",z$V.DOMINO_FILTER_CHANGE="dominofilterchange",z$V}(),z$S=(function(){function z$V(){}z$b(z$V,"laya.events.Keyboard"),z$V.NUMBER_0=48,z$V.NUMBER_1=49,z$V.NUMBER_2=50,z$V.NUMBER_3=51,z$V.NUMBER_4=52,z$V.NUMBER_5=53,z$V.NUMBER_6=54,z$V.NUMBER_7=55,z$V.NUMBER_8=56,z$V.NUMBER_9=57,z$V.A=65,z$V.B=66,z$V.C=67,z$V.D=68,z$V.E=69,z$V.F=70,z$V.G=71,z$V.H=72,z$V.I=73,z$V.J=74,z$V.K=75,z$V.L=76,z$V.M=77,z$V.N=78,z$V.O=79,z$V.P=80,z$V.Q=81,z$V.R=82,z$V.S=83,z$V.T=84,z$V.U=85,z$V.V=86,z$V.W=87,z$V.X=88,z$V.Y=89,z$V.Z=90,z$V.F1=112,z$V.F2=113,z$V.F3=114,z$V.F4=115,z$V.F5=116,z$V.F6=117,z$V.F7=118,z$V.F8=119,z$V.F9=120,z$V.F10=121,z$V.F11=122,z$V.F12=123,z$V.F13=124,z$V.F14=125,z$V.F15=126,z$V.NUMPAD=21,z$V.NUMPAD_0=96,z$V.NUMPAD_1=97,z$V.NUMPAD_2=98,z$V.NUMPAD_3=99,z$V.NUMPAD_4=100,z$V.NUMPAD_5=101,z$V.NUMPAD_6=102,z$V.NUMPAD_7=103,z$V.NUMPAD_8=104,z$V.NUMPAD_9=105,z$V.NUMPAD_ADD=107,z$V.NUMPAD_DECIMAL=110,z$V.NUMPAD_DIVIDE=111,z$V.NUMPAD_ENTER=108,z$V.NUMPAD_MULTIPLY=106,z$V.NUMPAD_SUBTRACT=109,z$V.SEMICOLON=186,z$V.EQUAL=187,z$V.COMMA=188,z$V.MINUS=189,z$V.PERIOD=190,z$V.SLASH=191,z$V.BACKQUOTE=192,z$V.LEFTBRACKET=219,z$V.BACKSLASH=220,z$V.RIGHTBRACKET=221,z$V.QUOTE=222,z$V.ALTERNATE=18,z$V.BACKSPACE=8,z$V.CAPS_LOCK=20,z$V.COMMAND=15,z$V.CONTROL=17,z$V.DELETE=46,z$V.ENTER=13,z$V.ESCAPE=27,z$V.PAGE_UP=33,z$V.PAGE_DOWN=34,z$V.END=35,z$V.HOME=36,z$V.LEFT=37,z$V.UP=38,z$V.RIGHT=39,z$V.DOWN=40,z$V.SHIFT=16,z$V.SPACE=32,z$V.TAB=9,z$V.INSERT=45}(),function(){function z$p(){}return z$b(z$p,"laya.events.KeyBoardManager"),z$p.__init__=function(){z$p._addEvent("keydown"),z$p._addEvent("keypress"),z$p._addEvent("keyup")},z$p._addEvent=function(z$U){z$j.document.addEventListener(z$U,function(z$V){laya.events.KeyBoardManager._dispatch(z$V,z$U)},!0)},z$p._dispatch=function(z$V,z$U){if(z$p.enabled){z$p._event._stoped=!1,z$p._event.nativeEvent=z$V,z$p._event.keyCode=z$V.keyCode||z$V.which||z$V.charCode,"keydown"===z$U?z$p._pressKeys[z$p._event.keyCode]=!0:"keyup"===z$U&&(z$p._pressKeys[z$p._event.keyCode]=null);for(var z$r=z$y.stage.focus&&null!=z$y.stage.focus.event&&z$y.stage.focus.displayedInStage?z$y.stage.focus:z$y.stage,z$s=z$r;z$s;)z$s.event(z$U,z$p._event.setTo(z$U,z$s,z$r)),z$s=z$s.parent}},z$p.hasKeyDown=function(z$V){return z$p._pressKeys[z$V]},z$p._pressKeys={},z$p.enabled=!0,z$N(z$p,["_event",function(){return this._event=new z$c}]),z$p}()),z$u=(function(){function z$V(){}z$b(z$V,"laya.events.KeyLocation"),z$V.STANDARD=0,z$V.LEFT=1,z$V.RIGHT=2,z$V.NUM_PAD=3}(),function(){function z$t(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=z$j.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new z$c,this._matrix=new z$z,this._point=new z$D,this._rect=new z$n,this._prePoint=new z$D,this._curTouchID=NaN}z$b(z$t,"laya.events.MouseManager");var z$V=z$t.prototype;return z$V.__init__=function(z$V,z$U){var z$r=this;this._stage=z$V;var z$s=this,z$p=this._eventList;z$U.oncontextmenu=function(z$V){if(z$t.enabled)return!1},z$U.addEventListener("mousedown",function(z$V){z$t.enabled&&(z$j.onIE||z$V.preventDefault(),z$p.push(z$V),z$s.mouseDownTime=z$j.now())}),z$U.addEventListener("mouseup",function(z$V){z$t.enabled&&(z$V.preventDefault(),z$p.push(z$V),z$s.mouseDownTime=-z$j.now())},!0),z$U.addEventListener("mousemove",function(z$V){if(z$t.enabled){z$V.preventDefault();var z$U=z$j.now();if(z$U-z$s._lastMoveTimer<10)return;z$s._lastMoveTimer=z$U,z$p.push(z$V)}},!0),z$U.addEventListener("mouseout",function(z$V){z$t.enabled&&z$p.push(z$V)}),z$U.addEventListener("mouseover",function(z$V){z$t.enabled&&z$p.push(z$V)}),z$U.addEventListener("touchstart",function(z$V){z$t.enabled&&(z$p.push(z$V),z$t._isFirstTouch||z$dV.isInputting||z$V.preventDefault(),z$s.mouseDownTime=z$j.now())}),z$U.addEventListener("touchend",function(z$V){z$t.enabled?(z$t._isFirstTouch||z$dV.isInputting||z$V.preventDefault(),z$t._isFirstTouch=!1,z$p.push(z$V),z$s.mouseDownTime=-z$j.now()):z$r._curTouchID=NaN},!0),z$U.addEventListener("touchmove",function(z$V){z$t.enabled&&(z$V.preventDefault(),z$p.push(z$V))},!0),z$U.addEventListener("touchcancel",function(z$V){z$t.enabled?(z$V.preventDefault(),z$p.push(z$V)):z$r._curTouchID=NaN},!0),z$U.addEventListener("mousewheel",function(z$V){z$t.enabled&&z$p.push(z$V)}),z$U.addEventListener("DOMMouseScroll",function(z$V){z$t.enabled&&z$p.push(z$V)})},z$V.initEvent=function(z$V,z$U){var z$r;this._event._stoped=!1,this._event.nativeEvent=z$U||z$V,this._target=null,this._point.setTo(z$V.pageX||z$V.clientX,z$V.pageY||z$V.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=z$V.identifier||0,this._tTouchID=this._event.touchId,(z$r=z$h.I._event)._stoped=!1,z$r.nativeEvent=this._event.nativeEvent,z$r.touchId=this._event.touchId},z$V.checkMouseWheel=function(z$V){this._event.delta=z$V.wheelDelta?.025*z$V.wheelDelta:-z$V.detail;for(var z$U=z$h.I.getLastOvers(),z$r=0,z$s=z$U.length;z$r<z$s;z$r++){var z$p=z$U[z$r];z$p.event("mousewheel",this._event.setTo("mousewheel",z$p,this._target))}},z$V.onMouseMove=function(z$V){z$h.I.onMouseMove(z$V,this._tTouchID)},z$V.onMouseDown=function(z$V){if(z$dV.isInputting&&z$y.stage.focus&&z$y.stage.focus.focus&&!z$y.stage.focus.contains(this._target)){var z$U=z$y.stage.focus._tf||z$y.stage.focus,z$r=z$V._tf||z$V;z$r instanceof laya.display.Input&&z$r.multiline==z$U.multiline?z$U._focusOut():z$U.focus=!1}z$h.I.onMouseDown(z$V,this._tTouchID,this._isLeftMouse)},z$V.onMouseUp=function(z$V){z$h.I.onMouseUp(z$V,this._tTouchID,this._isLeftMouse)},z$V.check=function(z$V,z$U,z$r,z$s){this._point.setTo(z$U,z$r),z$V.fromParentPoint(this._point),z$U=this._point.x,z$r=this._point.y;var z$p=z$V.scrollRect;if(z$p&&(this._rect.setTo(z$p.x,z$p.y,z$p.width,z$p.height),!this._rect.contains(z$U,z$r)))return!1;if(!this.disableMouseEvent){if(z$V.hitTestPrior&&!z$V.mouseThrough&&!this.hitTest(z$V,z$U,z$r))return!1;for(var z$c=z$V._childs.length-1;-1<z$c;z$c--){var z$R=z$V._childs[z$c];if(!z$R.destroyed&&z$R.mouseEnabled&&z$R.visible&&this.check(z$R,z$U,z$r,z$s))return!0}}var z$T=!(!z$V.hitTestPrior||z$V.mouseThrough||this.disableMouseEvent)||this.hitTest(z$V,z$U,z$r);return z$T?(this._target=z$V,z$s.call(this,z$V)):z$s===this.onMouseUp&&z$V===this._stage&&(this._target=this._stage,z$s.call(this,this._target)),z$T},z$V.hitTest=function(z$V,z$U,z$r){var z$s=!1;if(z$V.scrollRect&&(z$U-=z$V.scrollRect.x,z$r-=z$V.scrollRect.y),z$V.hitArea instanceof laya.utils.HitArea)return z$V.hitArea.isHit(z$U,z$r);if(0<z$V.width&&0<z$V.height||z$V.mouseThrough||z$V.hitArea)if(z$V.mouseThrough)z$s=z$V.getGraphicBounds().contains(z$U,z$r);else{var z$p=this._rect;z$V.hitArea?z$p=z$V.hitArea:z$p.setTo(0,0,z$V.width,z$V.height),z$s=z$p.contains(z$U,z$r)}return z$s},z$V.runEvent=function(){var z$V=this._eventList.length;if(z$V){this.mouseEventTime=z$j.now();var z$U,z$r=0,z$s=0,z$p=0;try{for(;z$r<z$V;){var z$c=this._eventList[z$r];switch("mousemove"!==z$c.type&&(this._prePoint.x=this._prePoint.y=-1e6),z$c.type){case"mousedown":this._touchIDs[0]=this._id++,z$t._isTouchRespond?z$t._isTouchRespond=!1:(this._isLeftMouse=0===z$c.button,this.initEvent(z$c),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===z$c.button,this.initEvent(z$c),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-z$c.clientX)+Math.abs(this._prePoint.y-z$c.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=z$c.clientX,this._prePoint.y=z$c.clientY,this.initEvent(z$c),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":z$t._isTouchRespond=!0,this._isLeftMouse=!0;var z$R=z$c.changedTouches;for(z$s=0,z$p=z$R.length;z$s<z$p;z$s++)z$U=z$R[z$s],(z$t.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=z$U.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[z$U.identifier]=this._id++,this.initEvent(z$U,z$c),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":z$t._isTouchRespond=!0,this._isLeftMouse=!0;var z$T=z$c.changedTouches;for(z$s=0,z$p=z$T.length;z$s<z$p;z$s++)if(z$U=z$T[z$s],z$t.multiTouchEnabled||z$U.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(z$U,z$c);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var z$N=z$c.changedTouches;for(z$s=0,z$p=z$N.length;z$s<z$p;z$s++)z$U=z$N[z$s],(z$t.multiTouchEnabled||z$U.identifier==this._curTouchID)&&(this.initEvent(z$U,z$c),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(z$c);break;case"mouseout":z$h.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}z$r++}}catch(z$V){throw this._eventList.length=0,z$V}this._eventList.length=0}},z$t.enabled=!0,z$t.multiTouchEnabled=!0,z$t._isTouchRespond=!1,z$t._isFirstTouch=!0,z$N(z$t,["instance",function(){return this.instance=new z$t}]),z$t}()),z$h=function(){function z$q(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new z$c}z$b(z$q,"laya.events.TouchManager");var z$V=z$q.prototype;return z$V._clearTempArrs=function(){z$q._oldArr.length=0,z$q._newArr.length=0,z$q._tEleArr.length=0},z$V.getTouchFromArr=function(z$V,z$U){var z$r,z$s,z$p=0;for(z$r=z$U.length,z$p=0;z$p<z$r;z$p++)if((z$s=z$U[z$p]).id==z$V)return z$s;return null},z$V.removeTouchFromArr=function(z$V,z$U){var z$r=0;for(z$r=z$U.length-1;0<=z$r;z$r--)z$U[z$r].id==z$V&&z$U.splice(z$r,1)},z$V.createTouchO=function(z$V,z$U){var z$r;return(z$r=z$X.getItem("TouchData")||{}).id=z$U,z$r.tar=z$V,z$r},z$V.onMouseDown=function(z$V,z$U,z$r){var z$s,z$p,z$c,z$R;(void 0===z$r&&(z$r=!1),this.enable)&&(z$s=this.getTouchFromArr(z$U,this.preOvers),z$c=this.getEles(z$V,null,z$q._tEleArr),z$s?z$s.tar=z$V:(z$p=this.createTouchO(z$V,z$U),this.preOvers.push(z$p)),z$j.onMobile&&this.sendEvents(z$c,"mouseover",z$U),z$R=z$r?this.preDowns:this.preRightDowns,(z$s=this.getTouchFromArr(z$U,z$R))?z$s.tar=z$V:(z$p=this.createTouchO(z$V,z$U),z$R.push(z$p)),this.sendEvents(z$c,z$r?"mousedown":"rightmousedown",z$U),this._clearTempArrs())},z$V.sendEvents=function(z$V,z$U,z$r){void 0===z$r&&(z$r=0);var z$s,z$p,z$c,z$R=0;for(z$s=z$V.length,this._event._stoped=!1,z$p=z$V[0],z$R=0;z$R<z$s;z$R++){if((z$c=z$V[z$R]).destroyed)return;if(z$c.event(z$U,this._event.setTo(z$U,z$c,z$p)),this._event._stoped)break}},z$V.getEles=function(z$V,z$U,z$r){for(z$r?z$r.length=0:z$r=[];z$V&&z$V!=z$U;)z$r.push(z$V),z$V=z$V.parent;return z$r},z$V.checkMouseOutAndOverOfMove=function(z$V,z$U,z$r){if(void 0===z$r&&(z$r=0),z$U!=z$V){var z$s,z$p,z$c=0,z$R=0;if(z$U.contains(z$V))z$p=this.getEles(z$V,z$U,z$q._tEleArr),this.sendEvents(z$p,"mouseover",z$r);else if(z$V.contains(z$U))z$p=this.getEles(z$U,z$V,z$q._tEleArr),this.sendEvents(z$p,"mouseout",z$r);else{var z$T,z$N;(z$p=z$q._tEleArr).length=0,z$T=this.getEles(z$U,null,z$q._oldArr),z$N=this.getEles(z$V,null,z$q._newArr),z$R=z$T.length;var z$t=0;for(z$c=0;z$c<z$R;z$c++){if(z$s=z$T[z$c],0<=(z$t=z$N.indexOf(z$s))){z$N.splice(z$t,z$N.length-z$t);break}z$p.push(z$s)}0<z$p.length&&this.sendEvents(z$p,"mouseout",z$r),0<z$N.length&&this.sendEvents(z$N,"mouseover",z$r)}}},z$V.onMouseMove=function(z$V,z$U){var z$r,z$s;this.enable&&((z$r=this.getTouchFromArr(z$U,this.preOvers))?(this.checkMouseOutAndOverOfMove(z$V,z$r.tar),z$r.tar=z$V,z$s=this.getEles(z$V,null,z$q._tEleArr)):(z$s=this.getEles(z$V,null,z$q._tEleArr),this.sendEvents(z$s,"mouseover",z$U),this.preOvers.push(this.createTouchO(z$V,z$U))),this.sendEvents(z$s,"mousemove",z$U),this._clearTempArrs())},z$V.getLastOvers=function(){return(z$q._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,z$q._tEleArr):(z$q._tEleArr.push(z$y.stage),z$q._tEleArr)},z$V.stageMouseOut=function(){var z$V;z$V=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(z$V,"mouseout",0)},z$V.onMouseUp=function(z$V,z$U,z$r){if(void 0===z$r&&(z$r=!1),this.enable){var z$s,z$p,z$c,z$R,z$T,z$N,z$t=0,z$b=0,z$S=z$j.onMobile;if(z$p=this.getEles(z$V,null,z$q._tEleArr),this.sendEvents(z$p,z$r?"mouseup":"rightmouseup",z$U),z$N=z$r?this.preDowns:this.preRightDowns,z$s=this.getTouchFromArr(z$U,z$N)){var z$_,z$G=z$j.now();if(z$_=z$G-this._lastClickTime<300,this._lastClickTime=z$G,z$V==z$s.tar)z$T=z$p;else for(z$c=this.getEles(z$s.tar,null,z$q._oldArr),(z$T=z$q._newArr).length=0,z$b=z$c.length,z$t=0;z$t<z$b;z$t++)z$R=z$c[z$t],0<=z$p.indexOf(z$R)&&z$T.push(z$R);0<z$T.length&&this.sendEvents(z$T,z$r?"click":"rightclick",z$U),z$r&&z$_&&this.sendEvents(z$T,"doubleclick",z$U),this.removeTouchFromArr(z$U,z$N),z$s.tar=null,z$X.recover("TouchData",z$s)}else;(z$s=this.getTouchFromArr(z$U,this.preOvers))&&z$S&&((z$T=this.getEles(z$s.tar,null,z$T))&&0<z$T.length&&this.sendEvents(z$T,"mouseout",z$U),this.removeTouchFromArr(z$U,this.preOvers),z$s.tar=null,z$X.recover("TouchData",z$s)),this._clearTempArrs()}},z$q._oldArr=[],z$q._newArr=[],z$q._tEleArr=[],z$N(z$q,["I",function(){return this.I=new z$q}]),z$q}(),z$l=function(){function z$V(){this._action=null}z$b(z$V,"laya.filters.Filter");var z$U=z$V.prototype;return z$y.imps(z$U,{"laya.filters.IFilter":!0}),z$U.callNative=function(z$V){},z$q(0,z$U,"type",function(){return-1}),z$q(0,z$U,"action",function(){return this._action}),z$V.BLUR=16,z$V.COLOR=32,z$V.GLOW=8,z$V._filterStart=null,z$V._filterEnd=null,z$V._EndTarget=null,z$V._recycleScope=null,z$V._filter=null,z$V._useSrc=null,z$V._endSrc=null,z$V._useOut=null,z$V._endOut=null,z$V}(),z$O=function(){function z$V(){this.data=null}z$b(z$V,"laya.filters.ColorFilterAction");var z$U=z$V.prototype;return z$y.imps(z$U,{"laya.filters.IFilterAction":!0}),z$U.apply=function(z$V){var z$U=z$V.ctx.ctx,z$r=z$V.ctx.ctx.canvas;if(0==z$r.width||0==z$r.height)return z$r;for(var z$s,z$p=z$U.getImageData(0,0,z$r.width,z$r.height),z$c=z$p.data,z$R=0,z$T=z$c.length;z$R<z$T;z$R+=4)z$s=this.getColor(z$c[z$R],z$c[z$R+1],z$c[z$R+2],z$c[z$R+3]),0!=z$c[z$R+3]&&(z$c[z$R]=z$s[0],z$c[z$R+1]=z$s[1],z$c[z$R+2]=z$s[2],z$c[z$R+3]=z$s[3]);return z$U.putImageData(z$p,0,0),z$V},z$U.getColor=function(z$V,z$U,z$r,z$s){var z$p=[];if(this.data._mat&&this.data._alpha){var z$c=this.data._mat,z$R=this.data._alpha;z$p[0]=z$c[0]*z$V+z$c[1]*z$U+z$c[2]*z$r+z$c[3]*z$s+z$R[0],z$p[1]=z$c[4]*z$V+z$c[5]*z$U+z$c[6]*z$r+z$c[7]*z$s+z$R[1],z$p[2]=z$c[8]*z$V+z$c[9]*z$U+z$c[10]*z$r+z$c[11]*z$s+z$R[2],z$p[3]=z$c[12]*z$V+z$c[13]*z$U+z$c[14]*z$r+z$c[15]*z$s+z$R[3]}return z$p},z$V}(),z$L=(function(){function z$V(){}z$b(z$V,"laya.maths.Arith"),z$V.formatR=function(z$V){return z$V>Math.PI&&(z$V-=2*Math.PI),z$V<-Math.PI&&(z$V+=2*Math.PI),z$V},z$V.isPOT=function(z$V,z$U){return 0<z$V&&0==(z$V&z$V-1)&&0<z$U&&0==(z$U&z$U-1)},z$V.setMatToArray=function(z$V,z$U){z$V.a,z$V.b,z$V.c,z$V.d,z$V.tx,z$V.ty,z$U[0]=z$V.a,z$U[1]=z$V.b,z$U[4]=z$V.c,z$U[5]=z$V.d,z$U[12]=z$V.tx,z$U[13]=z$V.ty}}(),function(){function z$V(){this._controlPoints=[new z$D,new z$D,new z$D],this._calFun=this.getPoint2}z$b(z$V,"laya.maths.Bezier");var z$U=z$V.prototype;return z$U._switchPoint=function(z$V,z$U){var z$r=this._controlPoints.shift();z$r.setTo(z$V,z$U),this._controlPoints.push(z$r)},z$U.getPoint2=function(z$V,z$U){var z$r=this._controlPoints[0],z$s=this._controlPoints[1],z$p=this._controlPoints[2],z$c=Math.pow(1-z$V,2)*z$r.x+2*z$V*(1-z$V)*z$s.x+Math.pow(z$V,2)*z$p.x,z$R=Math.pow(1-z$V,2)*z$r.y+2*z$V*(1-z$V)*z$s.y+Math.pow(z$V,2)*z$p.y;z$U.push(z$c,z$R)},z$U.getPoint3=function(z$V,z$U){var z$r=this._controlPoints[0],z$s=this._controlPoints[1],z$p=this._controlPoints[2],z$c=this._controlPoints[3],z$R=Math.pow(1-z$V,3)*z$r.x+3*z$s.x*z$V*(1-z$V)*(1-z$V)+3*z$p.x*z$V*z$V*(1-z$V)+z$c.x*Math.pow(z$V,3),z$T=Math.pow(1-z$V,3)*z$r.y+3*z$s.y*z$V*(1-z$V)*(1-z$V)+3*z$p.y*z$V*z$V*(1-z$V)+z$c.y*Math.pow(z$V,3);z$U.push(z$R,z$T)},z$U.insertPoints=function(z$V,z$U){var z$r,z$s=NaN;for(z$r=1/(z$V=0<z$V?z$V:5),z$s=0;z$s<=1;z$s+=z$r)this._calFun(z$s,z$U)},z$U.getBezierPoints=function(z$V,z$U,z$r){void 0===z$U&&(z$U=5),void 0===z$r&&(z$r=2);var z$s,z$p,z$c=0;if((z$s=z$V.length)<2*(z$r+1))return[];switch(z$p=[],z$r){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=z$r;)this._controlPoints.push(new z$D);for(z$c=0;z$c<2*z$r;z$c+=2)this._switchPoint(z$V[z$c],z$V[z$c+1]);for(z$c=2*z$r;z$c<z$s;z$c+=2)this._switchPoint(z$V[z$c],z$V[z$c+1]),z$c/2%z$r==0&&this.insertPoints(z$U,z$p);return z$p},z$N(z$V,["I",function(){return this.I=new z$V}]),z$V}()),z$d=function(){function z$t(){}return z$b(z$t,"laya.maths.GrahamScan"),z$t.multiply=function(z$V,z$U,z$r){return(z$V.x-z$r.x)*(z$U.y-z$r.y)-(z$U.x-z$r.x)*(z$V.y-z$r.y)},z$t.dis=function(z$V,z$U){return(z$V.x-z$U.x)*(z$V.x-z$U.x)+(z$V.y-z$U.y)*(z$V.y-z$U.y)},z$t._getPoints=function(z$V,z$U,z$r){for(void 0===z$U&&(z$U=!1),z$t._mPointList||(z$t._mPointList=[]);z$t._mPointList.length<z$V;)z$t._mPointList.push(new z$D);return z$r||(z$r=[]),z$r.length=0,z$U?z$t.getFrom(z$r,z$t._mPointList,z$V):z$t.getFromR(z$r,z$t._mPointList,z$V),z$r},z$t.getFrom=function(z$V,z$U,z$r){var z$s=0;for(z$s=0;z$s<z$r;z$s++)z$V.push(z$U[z$s]);return z$V},z$t.getFromR=function(z$V,z$U,z$r){var z$s=0;for(z$s=0;z$s<z$r;z$s++)z$V.push(z$U.pop());return z$V},z$t.pListToPointList=function(z$V,z$U){void 0===z$U&&(z$U=!1);var z$r=0,z$s=z$V.length/2,z$p=z$t._getPoints(z$s,z$U,z$t._tempPointList);for(z$r=0;z$r<z$s;z$r++)z$p[z$r].setTo(z$V[z$r+z$r],z$V[z$r+z$r+1]);return z$p},z$t.pointListToPlist=function(z$V){var z$U,z$r=0,z$s=z$V.length,z$p=z$t._temPList;for(z$r=z$p.length=0;z$r<z$s;z$r++)z$U=z$V[z$r],z$p.push(z$U.x,z$U.y);return z$p},z$t.scanPList=function(z$V){return z$v.copyArray(z$V,z$t.pointListToPlist(z$t.scan(z$t.pListToPointList(z$V,!0))))},z$t.scan=function(z$V){var z$U,z$r,z$s,z$p=0,z$c=0,z$R=0,z$T=z$V.length,z$N={};for((z$r=z$t._temArr).length=0,z$p=(z$T=z$V.length)-1;0<=z$p;z$p--)z$s=(z$U=z$V[z$p]).x+"_"+z$U.y,z$N.hasOwnProperty(z$s)||(z$N[z$s]=!0,z$r.push(z$U));for(z$T=z$r.length,z$v.copyArray(z$V,z$r),z$p=1;z$p<z$T;z$p++)(z$V[z$p].y<z$V[z$R].y||z$V[z$p].y==z$V[z$R].y&&z$V[z$p].x<z$V[z$R].x)&&(z$R=z$p);for(z$U=z$V[0],z$V[0]=z$V[z$R],z$V[z$R]=z$U,z$p=1;z$p<z$T-1;z$p++){for(z$c=(z$R=z$p)+1;z$c<z$T;z$c++)(0<z$t.multiply(z$V[z$c],z$V[z$R],z$V[0])||0==z$t.multiply(z$V[z$c],z$V[z$R],z$V[0])&&z$t.dis(z$V[0],z$V[z$c])<z$t.dis(z$V[0],z$V[z$R]))&&(z$R=z$c);z$U=z$V[z$p],z$V[z$p]=z$V[z$R],z$V[z$R]=z$U}if((z$r=z$t._temArr).length=0,z$V.length<3)return z$v.copyArray(z$r,z$V);for(z$r.push(z$V[0],z$V[1],z$V[2]),z$p=3;z$p<z$T;z$p++){for(;2<=z$r.length&&0<=z$t.multiply(z$V[z$p],z$r[z$r.length-1],z$r[z$r.length-2]);)z$r.pop();z$V[z$p]&&z$r.push(z$V[z$p])}return z$r},z$t._mPointList=null,z$t._tempPointList=[],z$t._temPList=[],z$t._temArr=[],z$t}(),z$k=function(){function z$p(){}return z$b(z$p,"laya.maths.MathUtil"),z$p.subtractVector3=function(z$V,z$U,z$r){z$r[0]=z$V[0]-z$U[0],z$r[1]=z$V[1]-z$U[1],z$r[2]=z$V[2]-z$U[2]},z$p.lerp=function(z$V,z$U,z$r){return z$V*(1-z$r)+z$U*z$r},z$p.scaleVector3=function(z$V,z$U,z$r){z$r[0]=z$V[0]*z$U,z$r[1]=z$V[1]*z$U,z$r[2]=z$V[2]*z$U},z$p.lerpVector3=function(z$V,z$U,z$r,z$s){var z$p=z$V[0],z$c=z$V[1],z$R=z$V[2];z$s[0]=z$p+z$r*(z$U[0]-z$p),z$s[1]=z$c+z$r*(z$U[1]-z$c),z$s[2]=z$R+z$r*(z$U[2]-z$R)},z$p.lerpVector4=function(z$V,z$U,z$r,z$s){var z$p=z$V[0],z$c=z$V[1],z$R=z$V[2],z$T=z$V[3];z$s[0]=z$p+z$r*(z$U[0]-z$p),z$s[1]=z$c+z$r*(z$U[1]-z$c),z$s[2]=z$R+z$r*(z$U[2]-z$R),z$s[3]=z$T+z$r*(z$U[3]-z$T)},z$p.slerpQuaternionArray=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T,z$N,z$t,z$b,z$S,z$_=z$V[z$U+0],z$G=z$V[z$U+1],z$q=z$V[z$U+2],z$u=z$V[z$U+3],z$h=z$r[z$s+0],z$l=z$r[z$s+1],z$W=z$r[z$s+2],z$O=z$r[z$s+3];return(z$N=z$_*z$h+z$G*z$l+z$q*z$W+z$u*z$O)<0&&(z$N=-z$N,z$h=-z$h,z$l=-z$l,z$W=-z$W,z$O=-z$O),z$S=1e-6<1-z$N?(z$T=Math.acos(z$N),z$t=Math.sin(z$T),z$b=Math.sin((1-z$p)*z$T)/z$t,Math.sin(z$p*z$T)/z$t):(z$b=1-z$p,z$p),z$c[z$R+0]=z$b*z$_+z$S*z$h,z$c[z$R+1]=z$b*z$G+z$S*z$l,z$c[z$R+2]=z$b*z$q+z$S*z$W,z$c[z$R+3]=z$b*z$u+z$S*z$O,z$c},z$p.getRotation=function(z$V,z$U,z$r,z$s){return Math.atan2(z$s-z$U,z$r-z$V)/Math.PI*180},z$p.sortBigFirst=function(z$V,z$U){return z$V==z$U?0:z$V<z$U?1:-1},z$p.sortSmallFirst=function(z$V,z$U){return z$V==z$U?0:z$V<z$U?-1:1},z$p.sortNumBigFirst=function(z$V,z$U){return parseFloat(z$U)-parseFloat(z$V)},z$p.sortNumSmallFirst=function(z$V,z$U){return parseFloat(z$V)-parseFloat(z$U)},z$p.sortByKey=function(z$r,z$V,z$U){var z$s;return void 0===z$V&&(z$V=!1),void 0===z$U&&(z$U=!0),z$s=z$V?z$U?z$p.sortNumBigFirst:z$p.sortBigFirst:z$U?z$p.sortNumSmallFirst:z$p.sortSmallFirst,function(z$V,z$U){return z$s(z$V[z$r],z$U[z$r])}},z$p}(),z$z=function(){function z$r(z$V,z$U,z$r,z$s,z$p,z$c){this.inPool=!1,this.bTransform=!1,void 0===z$V&&(z$V=1),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=1),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=0),this.a=z$V,this.b=z$U,this.c=z$r,this.d=z$s,this.tx=z$p,this.ty=z$c,this._checkTransform()}z$b(z$r,"laya.maths.Matrix");var z$V=z$r.prototype;return z$V.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},z$V._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},z$V.setTranslate=function(z$V,z$U){return this.tx=z$V,this.ty=z$U,this},z$V.translate=function(z$V,z$U){return this.tx+=z$V,this.ty+=z$U,this},z$V.scale=function(z$V,z$U){this.a*=z$V,this.d*=z$U,this.c*=z$V,this.b*=z$U,this.tx*=z$V,this.ty*=z$U,this.bTransform=!0},z$V.rotate=function(z$V){var z$U=Math.cos(z$V),z$r=Math.sin(z$V),z$s=this.a,z$p=this.c,z$c=this.tx;this.a=z$s*z$U-this.b*z$r,this.b=z$s*z$r+this.b*z$U,this.c=z$p*z$U-this.d*z$r,this.d=z$p*z$r+this.d*z$U,this.tx=z$c*z$U-this.ty*z$r,this.ty=z$c*z$r+this.ty*z$U,this.bTransform=!0},z$V.skew=function(z$V,z$U){var z$r=Math.tan(z$V),z$s=Math.tan(z$U),z$p=this.a,z$c=this.b;return this.a+=z$s*this.c,this.b+=z$s*this.d,this.c+=z$r*z$p,this.d+=z$r*z$c,this},z$V.invertTransformPoint=function(z$V){var z$U=this.a,z$r=this.b,z$s=this.c,z$p=this.d,z$c=this.tx,z$R=z$U*z$p-z$r*z$s,z$T=z$p/z$R,z$N=-z$r/z$R,z$t=-z$s/z$R,z$b=z$U/z$R,z$S=(z$s*this.ty-z$p*z$c)/z$R,z$_=-(z$U*this.ty-z$r*z$c)/z$R;return z$V.setTo(z$T*z$V.x+z$t*z$V.y+z$S,z$N*z$V.x+z$b*z$V.y+z$_)},z$V.transformPoint=function(z$V){return z$V.setTo(this.a*z$V.x+this.c*z$V.y+this.tx,this.b*z$V.x+this.d*z$V.y+this.ty)},z$V.transformPointN=function(z$V){return z$V.setTo(this.a*z$V.x+this.c*z$V.y,this.b*z$V.x+this.d*z$V.y)},z$V.transformPointArray=function(z$V,z$U){for(var z$r=z$V.length,z$s=0;z$s<z$r;z$s+=2){var z$p=z$V[z$s],z$c=z$V[z$s+1];z$U[z$s]=this.a*z$p+this.c*z$c+this.tx,z$U[z$s+1]=this.b*z$p+this.d*z$c+this.ty}return z$U},z$V.transformPointArrayScale=function(z$V,z$U){for(var z$r=z$V.length,z$s=0;z$s<z$r;z$s+=2){var z$p=z$V[z$s],z$c=z$V[z$s+1];z$U[z$s]=this.a*z$p+this.c*z$c,z$U[z$s+1]=this.b*z$p+this.d*z$c}return z$U},z$V.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},z$V.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},z$V.invert=function(){var z$V=this.a,z$U=this.b,z$r=this.c,z$s=this.d,z$p=this.tx,z$c=z$V*z$s-z$U*z$r;return this.a=z$s/z$c,this.b=-z$U/z$c,this.c=-z$r/z$c,this.d=z$V/z$c,this.tx=(z$r*this.ty-z$s*z$p)/z$c,this.ty=-(z$V*this.ty-z$U*z$p)/z$c,this},z$V.setTo=function(z$V,z$U,z$r,z$s,z$p,z$c){return this.a=z$V,this.b=z$U,this.c=z$r,this.d=z$s,this.tx=z$p,this.ty=z$c,this},z$V.concat=function(z$V){var z$U=this.a,z$r=this.c,z$s=this.tx;return this.a=z$U*z$V.a+this.b*z$V.c,this.b=z$U*z$V.b+this.b*z$V.d,this.c=z$r*z$V.a+this.d*z$V.c,this.d=z$r*z$V.b+this.d*z$V.d,this.tx=z$s*z$V.a+this.ty*z$V.c+z$V.tx,this.ty=z$s*z$V.b+this.ty*z$V.d+z$V.ty,this},z$V.scaleEx=function(z$V,z$U){var z$r=this.a,z$s=this.b,z$p=this.c,z$c=this.d;0!==z$s||0!==z$p?(this.a=z$V*z$r,this.b=z$V*z$s,this.c=z$U*z$p):(this.a=z$V*z$r,this.b=0*z$c,this.c=0*z$r),this.d=z$U*z$c,this.bTransform=!0},z$V.rotateEx=function(z$V){var z$U=Math.cos(z$V),z$r=Math.sin(z$V),z$s=this.a,z$p=this.b,z$c=this.c,z$R=this.d;0!==z$p||0!==z$c?(this.a=z$U*z$s+z$r*z$c,this.b=z$U*z$p+z$r*z$R,this.c=-z$r*z$s+z$U*z$c,this.d=-z$r*z$p+z$U*z$R):(this.a=z$U*z$s,this.b=z$r*z$R,this.c=-z$r*z$s,this.d=z$U*z$R),this.bTransform=!0},z$V.clone=function(){var z$V=z$r.create();return z$V.a=this.a,z$V.b=this.b,z$V.c=this.c,z$V.d=this.d,z$V.tx=this.tx,z$V.ty=this.ty,z$V.bTransform=this.bTransform,z$V},z$V.copyTo=function(z$V){return z$V.a=this.a,z$V.b=this.b,z$V.c=this.c,z$V.d=this.d,z$V.tx=this.tx,z$V.ty=this.ty,z$V.bTransform=this.bTransform,z$V},z$V.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},z$V.destroy=function(){if(!this.inPool){var z$V=z$r._cache;this.inPool=!0,z$V._length||(z$V._length=0),(z$V[z$V._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},z$r.mul=function(z$V,z$U,z$r){var z$s=z$V.a,z$p=z$V.b,z$c=z$V.c,z$R=z$V.d,z$T=z$V.tx,z$N=z$V.ty,z$t=z$U.a,z$b=z$U.b,z$S=z$U.c,z$_=z$U.d,z$G=z$U.tx,z$q=z$U.ty;return 0!==z$b||0!==z$S?(z$r.a=z$s*z$t+z$p*z$S,z$r.b=z$s*z$b+z$p*z$_,z$r.c=z$c*z$t+z$R*z$S,z$r.d=z$c*z$b+z$R*z$_,z$r.tx=z$t*z$T+z$S*z$N+z$G,z$r.ty=z$b*z$T+z$_*z$N+z$q):(z$r.a=z$s*z$t,z$r.b=z$p*z$_,z$r.c=z$c*z$t,z$r.d=z$R*z$_,z$r.tx=z$t*z$T+z$G,z$r.ty=z$_*z$N+z$q),z$r},z$r.mul16=function(z$V,z$U,z$r){var z$s=z$V.a,z$p=z$V.b,z$c=z$V.c,z$R=z$V.d,z$T=z$V.tx,z$N=z$V.ty,z$t=z$U.a,z$b=z$U.b,z$S=z$U.c,z$_=z$U.d,z$G=z$U.tx,z$q=z$U.ty;return 0!==z$b||0!==z$S?(z$r[0]=z$s*z$t+z$p*z$S,z$r[1]=z$s*z$b+z$p*z$_,z$r[4]=z$c*z$t+z$R*z$S,z$r[5]=z$c*z$b+z$R*z$_,z$r[12]=z$t*z$T+z$S*z$N+z$G,z$r[13]=z$b*z$T+z$_*z$N+z$q):(z$r[0]=z$s*z$t,z$r[1]=z$p*z$_,z$r[4]=z$c*z$t,z$r[5]=z$R*z$_,z$r[12]=z$t*z$T+z$G,z$r[13]=z$_*z$N+z$q),z$r},z$r.mulPre=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=z$V.a,z$t=z$V.b,z$b=z$V.c,z$S=z$V.d,z$_=z$V.tx,z$G=z$V.ty;return 0!==z$r||0!==z$s?(z$T.a=z$N*z$U+z$t*z$s,z$T.b=z$N*z$r+z$t*z$p,z$T.c=z$b*z$U+z$S*z$s,z$T.d=z$b*z$r+z$S*z$p,z$T.tx=z$U*z$_+z$s*z$G+z$c,z$T.ty=z$r*z$_+z$p*z$G+z$R):(z$T.a=z$N*z$U,z$T.b=z$t*z$p,z$T.c=z$b*z$U,z$T.d=z$S*z$p,z$T.tx=z$U*z$_+z$c,z$T.ty=z$p*z$G+z$R),z$T},z$r.mulPos=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=z$V.a,z$t=z$V.b,z$b=z$V.c,z$S=z$V.d,z$_=z$V.tx,z$G=z$V.ty;return 0!==z$t||0!==z$b?(z$T.a=z$U*z$N+z$r*z$b,z$T.b=z$U*z$t+z$r*z$S,z$T.c=z$s*z$N+z$p*z$b,z$T.d=z$s*z$t+z$p*z$S,z$T.tx=z$N*z$c+z$b*z$R+z$_,z$T.ty=z$t*z$c+z$S*z$R+z$G):(z$T.a=z$U*z$N,z$T.b=z$r*z$S,z$T.c=z$s*z$N,z$T.d=z$p*z$S,z$T.tx=z$N*z$c+z$_,z$T.ty=z$S*z$R+z$G),z$T},z$r.preMul=function(z$V,z$U,z$r){var z$s=z$V.a,z$p=z$V.b,z$c=z$V.c,z$R=z$V.d,z$T=z$U.a,z$N=z$U.b,z$t=z$U.c,z$b=z$U.d,z$S=z$U.tx,z$_=z$U.ty;return z$r.a=z$T*z$s,z$r.b=z$r.c=0,z$r.d=z$b*z$R,z$r.tx=z$S*z$s+z$V.tx,z$r.ty=z$_*z$R+z$V.ty,0===z$N&&0===z$t&&0===z$p&&0===z$c||(z$r.a+=z$N*z$c,z$r.d+=z$t*z$p,z$r.b+=z$T*z$p+z$N*z$R,z$r.c+=z$t*z$s+z$b*z$c,z$r.tx+=z$_*z$c,z$r.ty+=z$S*z$p),z$r},z$r.preMulXY=function(z$V,z$U,z$r,z$s){var z$p=z$V.a,z$c=z$V.b,z$R=z$V.c,z$T=z$V.d;return z$s.a=z$p,z$s.b=z$c,z$s.c=z$R,z$s.d=z$T,z$s.tx=z$U*z$p+z$V.tx+z$r*z$R,z$s.ty=z$r*z$T+z$V.ty+z$U*z$c,z$s},z$r.create=function(){var z$V=z$r._cache,z$U=z$V._length?z$V[--z$V._length]:new z$r;return z$U.inPool=!1,z$U},z$r.EMPTY=new z$r,z$r.TEMP=new z$r,z$r._cache=[],z$r}(),z$D=function(){function z$V(z$V,z$U){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),this.x=z$V,this.y=z$U}z$b(z$V,"laya.maths.Point");var z$U=z$V.prototype;return z$U.setTo=function(z$V,z$U){return this.x=z$V,this.y=z$U,this},z$U.distance=function(z$V,z$U){return Math.sqrt((this.x-z$V)*(this.x-z$V)+(this.y-z$U)*(this.y-z$U))},z$U.toString=function(){return this.x+","+this.y},z$U.normalize=function(){var z$V=Math.sqrt(this.x*this.x+this.y*this.y);if(0<z$V){var z$U=1/z$V;this.x*=z$U,this.y*=z$U}},z$V.TEMP=new z$V,z$V.EMPTY=new z$V,z$V}(),z$n=function(){function z$t(z$V,z$U,z$r,z$s){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),this.x=z$V,this.y=z$U,this.width=z$r,this.height=z$s}z$b(z$t,"laya.maths.Rectangle");var z$V=z$t.prototype;return z$V.setTo=function(z$V,z$U,z$r,z$s){return this.x=z$V,this.y=z$U,this.width=z$r,this.height=z$s,this},z$V.copyFrom=function(z$V){return this.x=z$V.x,this.y=z$V.y,this.width=z$V.width,this.height=z$V.height,this},z$V.contains=function(z$V,z$U){return!(this.width<=0||this.height<=0)&&(z$V>=this.x&&z$V<this.right&&z$U>=this.y&&z$U<this.bottom)},z$V.intersects=function(z$V){return!(z$V.x>this.x+this.width||z$V.x+z$V.width<this.x||z$V.y>this.y+this.height||z$V.y+z$V.height<this.y)},z$V.intersection=function(z$V,z$U){return this.intersects(z$V)?(z$U||(z$U=new z$t),z$U.x=Math.max(this.x,z$V.x),z$U.y=Math.max(this.y,z$V.y),z$U.width=Math.min(this.right,z$V.right)-z$U.x,z$U.height=Math.min(this.bottom,z$V.bottom)-z$U.y,z$U):null},z$V.union=function(z$V,z$U){return z$U||(z$U=new z$t),this.clone(z$U),z$V.width<=0||z$V.height<=0?z$U:(z$U.addPoint(z$V.x,z$V.y),z$U.addPoint(z$V.right,z$V.bottom),this)},z$V.clone=function(z$V){return z$V||(z$V=new z$t),z$V.x=this.x,z$V.y=this.y,z$V.width=this.width,z$V.height=this.height,z$V},z$V.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},z$V.equals=function(z$V){return!(!z$V||z$V.x!==this.x||z$V.y!==this.y||z$V.width!==this.width||z$V.height!==this.height)},z$V.addPoint=function(z$V,z$U){return this.x>z$V&&(this.width+=this.x-z$V,this.x=z$V),this.y>z$U&&(this.height+=this.y-z$U,this.y=z$U),this.width<z$V-this.x&&(this.width=z$V-this.x),this.height<z$U-this.y&&(this.height=z$U-this.y),this},z$V._getBoundPoints=function(){var z$V=z$t._temB;return(z$V.length=0)==this.width||0==this.height||z$V.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),z$V},z$V.isEmpty=function(){return this.width<=0||this.height<=0},z$q(0,z$V,"right",function(){return this.x+this.width}),z$q(0,z$V,"bottom",function(){return this.y+this.height}),z$t._getBoundPointS=function(z$V,z$U,z$r,z$s){var z$p=z$t._temA;return(z$p.length=0)==z$r||0==z$s||z$p.push(z$V,z$U,z$V+z$r,z$U,z$V,z$U+z$s,z$V+z$r,z$U+z$s),z$p},z$t._getWrapRec=function(z$V,z$U){if(!z$V||z$V.length<1)return z$U?z$U.setTo(0,0,0,0):z$t.TEMP.setTo(0,0,0,0);z$U=z$U||new z$t;var z$r,z$s,z$p,z$c,z$R,z$T=z$V.length,z$N=z$D.TEMP;for(z$p=z$R=-(z$s=z$c=99999),z$r=0;z$r<z$T;z$r+=2)z$N.x=z$V[z$r],z$N.y=z$V[z$r+1],z$s=z$s<z$N.x?z$s:z$N.x,z$c=z$c<z$N.y?z$c:z$N.y,z$p=z$p>z$N.x?z$p:z$N.x,z$R=z$R>z$N.y?z$R:z$N.y;return z$U.setTo(z$s,z$c,z$p-z$s,z$R-z$c)},z$t.EMPTY=new z$t,z$t.TEMP=new z$t,z$t._temB=[],z$t._temA=[],z$t}(),z$H=function(){function z$N(){}return z$b(z$N,"laya.media.SoundManager"),z$q(1,z$N,"useAudioMusic",function(){return z$N._useAudioMusic},function(z$V){z$N._useAudioMusic=z$V,z$N._musicClass=z$V?z$rV:null}),z$q(1,z$N,"autoStopMusic",function(){return z$N._autoStopMusic},function(z$V){z$y.stage.off("blur",null,z$N._stageOnBlur),z$y.stage.off("focus",null,z$N._stageOnFocus),z$y.stage.off("visibilitychange",null,z$N._visibilityChange),(z$N._autoStopMusic=z$V)&&(z$y.stage.on("blur",null,z$N._stageOnBlur),z$y.stage.on("focus",null,z$N._stageOnFocus),z$y.stage.on("visibilitychange",null,z$N._visibilityChange))}),z$q(1,z$N,"muted",function(){return z$N._muted},function(z$V){z$V!=z$N._muted&&(z$V&&z$N.stopAllSound(),z$N.musicMuted=z$V,z$N._muted=z$V)}),z$q(1,z$N,"musicMuted",function(){return z$N._musicMuted},function(z$V){z$V!=z$N._musicMuted&&(z$V?(z$N._tMusic&&z$N._musicChannel&&!z$N._musicChannel.isStopped?z$N._musicChannel.pause():z$N._musicChannel=null,z$N._musicMuted=z$V):(z$N._musicMuted=z$V,z$N._tMusic&&z$N._musicChannel&&z$N._musicChannel.resume()))}),z$q(1,z$N,"soundMuted",function(){return z$N._soundMuted},function(z$V){z$N._soundMuted=z$V}),z$N.addChannel=function(z$V){0<=z$N._channels.indexOf(z$V)||(z$N._channels.push(z$V),z$N.autoReleaseSound&&0!=z$N._notUsedCount&&z$N._notUsedUrls[z$V.url]&&(delete z$N._notUsedUrls[z$V.url],0==--z$N._notUsedCount&&z$y.timer.clear(z$N,z$N.disposeSoundIfNotUsed)))},z$N.removeChannel=function(z$V){var z$U=z$N._channels,z$r=z$U.indexOf(z$V);if(-1!=z$r&&(z$U.splice(z$r,1),z$N.autoReleaseSound)){var z$s=z$V.url,z$p=z$N.defaultIntervals[z$s]||2e4;if(0<z$p){var z$c=!0;for(z$r=z$U.length-1;0<=z$r;z$r--)if(z$U[z$r].url==z$s){z$c=!1;break}z$c&&(z$N._notUsedUrls[z$s]=Date.now()+z$p,0==z$N._notUsedCount++&&z$y.timer.loop(1e4,z$N,z$N.disposeSoundIfNotUsed))}}},z$N.disposeSoundIfNotUsed=function(){var z$V=z$N._notUsedUrls;if(0!=z$N._notUsedCount){var z$U=Date.now();for(var z$r in z$V)z$U>=z$V[z$r]&&(delete z$V[z$r],--z$N._notUsedCount,z$N.destroySound(z$r));if(0!=z$N._notUsedCount)return}z$y.timer.clear(z$N,z$N.disposeSoundIfNotUsed)},z$N._visibilityChange=function(){z$y.stage.isVisibility?z$N._stageOnFocus():z$N._stageOnBlur()},z$N._stageOnBlur=function(){z$N._isActive=!1,z$N._musicChannel&&(z$N._musicChannel.isStopped||(z$N._blurPaused=!0,z$N._musicChannel.pause())),z$N.stopAllSound(),z$y.stage.once("mousedown",null,z$N._stageOnFocus)},z$N._recoverWebAudio=function(){z$cV.ctx&&"running"!=z$cV.ctx.state&&z$cV.ctx.resume&&z$cV.ctx.resume()},z$N._stageOnFocus=function(){if(z$N._isActive=!0,z$N._recoverWebAudio(),z$y.stage.off("mousedown",null,z$N._stageOnFocus),z$N._blurPaused){var z$V=z$N._musicChannel;z$V&&z$N._music&&z$V.isStopped&&(z$N._blurPaused=!1,z$N._music._disposed?z$N.playMusic(z$V.url,z$V.loops,z$V.startHandler,z$V.completeHandler,z$V.startTime):z$V.audioBuffer?z$V.resume():z$N._music.play(z$V.startTime,z$V.loops,z$V.startHandler,z$V))}},z$N.playSound=function(z$V,z$U,z$r,z$s,z$p,z$c){if(void 0===z$U&&(z$U=1),void 0===z$c&&(z$c=0),!z$V)return null;if(z$N._muted)return null;if(z$N._recoverWebAudio(),z$V==z$N._tMusic){if(z$N._musicMuted)return null}else{if(!z$N._isActive)return null;if(z$N._soundMuted)return null}var z$R,z$T=z$N._pool[z$V];return z$p||(z$p=z$N._soundClass),z$T||((z$T=new z$p).load(z$V),z$N._pool[z$V]=z$T),(z$R=z$T.play(z$c,z$U,z$r))?(z$V==z$N._tMusic&&(z$N._music=z$T,z$N._isActive||(z$N._blurPaused=!0,z$R.pause())),z$R.url=z$V,z$R.volume=z$V==z$N._tMusic?z$N.musicVolume:z$N.soundVolume,z$R.completeHandler=z$s,z$R):null},z$N.destroySound=function(z$V){var z$U=z$N._pool[z$V];z$U&&(delete z$N._pool[z$V],z$U.dispose())},z$N.playMusic=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$U&&(z$U=0),void 0===z$p&&(z$p=0),z$N._tMusic=z$V,z$N._musicChannel&&z$N._musicChannel.stop(),z$N._musicChannel=z$N.playSound(z$V,z$U,z$r,z$s,null,z$p)},z$N.stopSound=function(z$V){for(var z$U,z$r=z$N._channels.length-1;0<=z$r;z$r--)(z$U=z$N._channels[z$r]).url==z$V&&z$U.stop()},z$N.stopAll=function(){z$N._tMusic=null;var z$V=0;for(z$V=z$N._channels.length-1;0<=z$V;z$V--)z$N._channels[z$V].stop()},z$N.stopAllSound=function(){var z$V,z$U=0;for(z$U=z$N._channels.length-1;0<=z$U;z$U--)(z$V=z$N._channels[z$U]).url!=z$N._tMusic&&z$V.stop()},z$N.stopMusic=function(){z$N._musicChannel&&z$N._musicChannel.stop(),z$N._tMusic=null},z$N.setSoundVolume=function(z$V,z$U){if(z$U)z$N._setVolume(z$U,z$V);else{z$N.soundVolume=z$V;var z$r,z$s=0;for(z$s=z$N._channels.length-1;0<=z$s;z$s--)(z$r=z$N._channels[z$s]).url!=z$N._tMusic&&(z$r.volume=z$V)}},z$N.setMusicVolume=function(z$V){z$N.musicVolume=z$V,z$N._setVolume(z$N._tMusic,z$V)},z$N._setVolume=function(z$V,z$U){for(var z$r,z$s=z$N._channels.length-1;0<=z$s;z$s--)(z$r=z$N._channels[z$s]).url==z$V&&(z$r.volume=z$U)},z$N.musicVolume=1,z$N.soundVolume=1,z$N.playbackRate=1,z$N._useAudioMusic=!0,z$N._muted=!1,z$N._soundMuted=!1,z$N._musicMuted=!1,z$N._tMusic=null,z$N._musicChannel=null,z$N._music=null,z$N._channels=[],z$N._autoStopMusic=!1,z$N._blurPaused=!1,z$N._isActive=!0,z$N._soundClass=null,z$N._musicClass=null,z$N.autoReleaseSound=!0,z$N._pool={},z$N.defaultIntervals={},z$N._notUsedUrls={},z$N._notUsedCount=0,z$N}(),z$I=function(){var z$V;function z$r(){}return z$b(z$r,"laya.net.LocalStorage"),z$r.__init__=function(){z$r._baseClass||(z$r._baseClass=z$V).init(),z$r.items=z$r._baseClass.items,z$r.support=z$r._baseClass.support},z$r.setItem=function(z$V,z$U){z$r._baseClass.setItem(z$V,z$U)},z$r.getItem=function(z$V){return z$r._baseClass.getItem(z$V)},z$r.setJSON=function(z$V,z$U){z$r._baseClass.setJSON(z$V,z$U)},z$r.getJSON=function(z$V){return z$r._baseClass.getJSON(z$V)},z$r.removeItem=function(z$V){z$r._baseClass.removeItem(z$V)},z$r.clear=function(){z$r._baseClass.clear()},z$r._baseClass=null,z$r.items=null,z$r.support=!1,z$r.__init$=function(){z$V=function(){function z$r(){}return z$b(z$r,""),z$r.init=function(){try{z$r.support=!0,z$r.items=z$R.localStorage,z$r.setItem("laya","1"),z$r.removeItem("laya")}catch(z$V){z$r.support=!1}z$r.support||console.log("LocalStorage is not supprot or browser is private mode.")},z$r.setItem=function(z$V,z$U){try{z$r.support&&z$r.items.setItem(z$V,z$U)}catch(z$V){console.warn("set localStorage failed",z$V)}},z$r.getItem=function(z$V){return z$r.support?z$r.items.getItem(z$V):null},z$r.setJSON=function(z$V,z$U){try{z$r.support&&z$r.items.setItem(z$V,JSON.stringify(z$U))}catch(z$V){console.warn("set localStorage failed",z$V)}},z$r.getJSON=function(z$V){return JSON.parse(z$r.support?z$r.items.getItem(z$V):null)},z$r.removeItem=function(z$V){z$r.support&&z$r.items.removeItem(z$V)},z$r.clear=function(){z$r.support&&z$r.items.clear()},z$r.items=null,z$r.support=!1,z$r}()},z$r}(),z$E=(function(){function z$s(){}z$b(z$s,"laya.net.ResourceVersion"),z$s.enable=function(z$V,z$U,z$r){void 0===z$r&&(z$r=2),laya.net.ResourceVersion.type=z$r,z$y.loader.load(z$V,z$W.create(null,z$s.onManifestLoaded,[z$U]),null,"json"),z$K.customFormat=z$s.addVersionPrefix},z$s.onManifestLoaded=function(z$V,z$U){z$s.manifest=z$U,z$V.run(),z$U||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},z$s.addVersionPrefix=function(z$V){return z$s.manifest&&z$s.manifest[z$V]?2==z$s.type?z$s.manifest[z$V]:z$s.manifest[z$V]+"/"+z$V:z$V},z$s.FOLDER_VERSION=1,z$s.FILENAME_VERSION=2,z$s.manifest=null,z$s.type=1}(),function(){function z$V(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}z$b(z$V,"laya.net.TTFLoader");var z$U=z$V.prototype;return z$U.load=function(z$V){var z$U=(this._url=z$V).split(".ttf")[0].split("/");this.fontName=z$U[z$U.length-1],z$j.window.conch?this._loadConch():z$j.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},z$U._loadConch=function(){this._http=new z$RV,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},z$U._onHttpLoaded=function(z$V){z$j.window.conch.setFontFaceFromBuffer(this.fontName,z$V),this._clearHttp(),this._complete()},z$U._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},z$U._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},z$U._complete=function(){z$y.timer.clear(this,this._complete),z$y.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},z$U._checkComplete=function(){z$w.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},z$U._loadWithFontFace=function(){var z$V=new z$j.window.FontFace(this.fontName,"url('"+this._url+"')");z$j.window.document.fonts.add(z$V);var z$U=this;z$V.loaded.then(function(){z$U._complete()}),z$V.load()},z$U._createDiv=function(){this._div=z$j.createElement("div"),this._div.innerHTML="laya";var z$V=this._div.style;z$V.fontFamily=this.fontName,z$V.position="absolute",z$V.left="-100px",z$V.top="-100px",z$j.document.body.appendChild(this._div)},z$U._loadWithCSS=function(){var z$V=this,z$U=z$j.createElement("style");z$U.type="text/css",z$j.document.body.appendChild(z$U),z$U.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=z$w.measureText("LayaTTFFont",this._fontTxt).width;var z$r=this;z$U.onload=function(){z$y.timer.once(1e4,z$r,z$V._complete)},z$y.timer.loop(20,this,this._checkComplete),this._createDiv()},z$V._testString="LayaTTFFont",z$V}()),z$K=function(){function z$s(z$V){this._url=null,this._path=null,this._url=z$s.formatURL(z$V),this._path=z$s.getPath(z$V)}z$b(z$s,"laya.net.URL");var z$V=z$s.prototype;return z$q(0,z$V,"path",function(){return this._path}),z$q(0,z$V,"url",function(){return this._url}),z$s.formatURL=function(z$V,z$U){if(!z$V)return"null path";if(0<z$V.indexOf(":"))return z$V;null!=z$s.customFormat&&(z$V=z$s.customFormat(z$V,z$U));var z$r=z$V.charAt(0);if("."===z$r)return z$s.formatRelativePath((z$U||z$s.basePath)+z$V);if("~"===z$r)return z$s.rootPath+z$V.substring(1);if("d"===z$r){if(0===z$V.indexOf("data:image"))return z$V}else if("/"===z$r)return z$V;return(z$U||z$s.basePath)+z$V},z$s.formatRelativePath=function(z$V){for(var z$U=z$V.split("/"),z$r=0,z$s=z$U.length;z$r<z$s;z$r++)".."==z$U[z$r]&&(z$U.splice(z$r-1,2),z$r-=2);return z$U.join("/")},z$s.isAbsolute=function(z$V){return 0<z$V.indexOf(":")||"/"==z$V.charAt(0)},z$s.getPath=function(z$V){var z$U=z$V.lastIndexOf("/");return 0<z$U?z$V.substr(0,z$U+1):""},z$s.getFileName=function(z$V){var z$U=z$V.lastIndexOf("/");return 0<z$U?z$V.substr(z$U+1):z$V},z$s.version={},z$s.basePath="",z$s.rootPath="",z$s.customFormat=function(z$V){var z$U=z$s.version[z$V];return!z$m.isConchApp&&z$U&&(z$V+="?v="+z$U),z$V},z$s}(),z$m=function(){function z$p(z$V,z$U){this._timeId=0;var z$r=z$p._mainCanvas.source.style;z$r.position="absolute",z$r.top=z$r.left="0px",z$r.background="#000000",z$p._mainCanvas.source.id="layaCanvas";var z$s=laya.renders.Render.isWebGL;z$p._mainCanvas.source.width=z$V,z$p._mainCanvas.source.height=z$U,z$s&&z$p.WebGL.init(z$p._mainCanvas,z$V,z$U),z$j.container.appendChild(z$p._mainCanvas.source),(z$p._context=new z$a(z$V,z$U,z$s?null:z$p._mainCanvas)).ctx.setIsMainContext(),z$j.window.requestAnimationFrame(function z$V(z$U){z$j.window.requestAnimationFrame(z$V);z$y.stage._loop()}),z$y.stage.on("visibilitychange",this,this._onVisibilitychange)}z$b(z$p,"laya.renders.Render");var z$V=z$p.prototype;return z$V._onVisibilitychange=function(){z$y.stage.isVisibility?0!=this._timeId&&z$j.window.clearInterval(this._timeId):this._timeId=z$j.window.setInterval(this._enterFrame,1e3)},z$V._enterFrame=function(z$V){z$y.stage._loop()},z$q(1,z$p,"context",function(){return z$p._context}),z$q(1,z$p,"canvas",function(){return z$p._mainCanvas.source}),z$p._context=null,z$p._mainCanvas=null,z$p.WebGL=null,z$p.isConchNode=!1,z$p.isConchApp=!1,z$p.isConchWebGL=!1,z$p.isWebGL=!1,z$p.is3DMode=!1,z$p.optimizeTextureMemory=function(z$V,z$U){return!0},z$p.__init$=function(){z$R.ConchRenderType=z$R.ConchRenderType||1,z$R.ConchRenderType|=z$R.conch?4:0,z$p.isConchNode=5==(5&z$R.ConchRenderType),z$p.isConchApp=4==(4&z$R.ConchRenderType),z$p.isConchWebGL=6==z$R.ConchRenderType},z$p}(),z$a=function(){function z$R(z$V,z$U,z$r){this.x=0,this.y=0,this._drawTexture=function(z$V,z$U,z$r){z$r[0].loaded&&this.ctx.drawTexture(z$r[0],z$r[1],z$r[2],z$r[3],z$r[4],z$V,z$U)},this._fillTexture=function(z$V,z$U,z$r){z$r[0].loaded&&this.ctx.fillTexture(z$r[0],z$r[1]+z$V,z$r[2]+z$U,z$r[3],z$r[4],z$r[5],z$r[6],z$r[7])},this._drawTextureWithTransform=function(z$V,z$U,z$r){z$r[0].loaded&&this.ctx.drawTextureWithTransform(z$r[0],z$r[1],z$r[2],z$r[3],z$r[4],z$r[5],z$V,z$U,z$r[6])},this._fillQuadrangle=function(z$V,z$U,z$r){this.ctx.fillQuadrangle(z$r[0],z$r[1],z$r[2],z$r[3],z$r[4])},this._drawRect=function(z$V,z$U,z$r){var z$s=this.ctx;null!=z$r[4]&&(z$s.fillStyle=z$r[4],z$s.fillRect(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3],null)),null!=z$r[5]&&(z$s.strokeStyle=z$r[5],z$s.lineWidth=z$r[6],z$s.strokeRect(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3],z$r[6]))},this._drawPie=function(z$V,z$U,z$r){var z$s=this.ctx;z$m.isWebGL&&z$s.setPathId(z$r[8]),z$s.beginPath(),z$m.isWebGL?(z$s.movePath(z$r[0]+z$V,z$r[1]+z$U),z$s.moveTo(0,0)):z$s.moveTo(z$V+z$r[0],z$U+z$r[1]),z$s.arc(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3],z$r[4]),z$s.closePath(),this._fillAndStroke(z$r[5],z$r[6],z$r[7],!0)},this._clipRect=function(z$V,z$U,z$r){this.ctx.clipRect(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3])},this._fillRect=function(z$V,z$U,z$r){this.ctx.fillRect(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3],z$r[4])},this._drawCircle=function(z$V,z$U,z$r){var z$s=this.ctx;z$m.isWebGL&&z$s.setPathId(z$r[6]),z$e.drawCall++,z$s.beginPath(),z$m.isWebGL&&z$s.movePath(z$r[0]+z$V,z$r[1]+z$U),z$s.arc(z$r[0]+z$V,z$r[1]+z$U,z$r[2],0,z$R.PI2),z$s.closePath(),this._fillAndStroke(z$r[3],z$r[4],z$r[5],!0)},this._fillCircle=function(z$V,z$U,z$r){z$e.drawCall++;var z$s=this.ctx;z$s.beginPath(),z$s.fillStyle=z$r[3],z$s.arc(z$r[0]+z$V,z$r[1]+z$U,z$r[2],0,z$R.PI2),z$s.fill()},this._setShader=function(z$V,z$U,z$r){this.ctx.setShader(z$r[0])},this._drawLine=function(z$V,z$U,z$r){var z$s=this.ctx;z$m.isWebGL&&z$s.setPathId(z$r[6]),z$s.beginPath(),z$s.strokeStyle=z$r[4],z$s.lineWidth=z$r[5],z$m.isWebGL?(z$s.movePath(z$V,z$U),z$s.moveTo(z$r[0],z$r[1]),z$s.lineTo(z$r[2],z$r[3])):(z$s.moveTo(z$V+z$r[0],z$U+z$r[1]),z$s.lineTo(z$V+z$r[2],z$U+z$r[3])),z$s.stroke()},this._drawLines=function(z$V,z$U,z$r){var z$s=this.ctx;z$m.isWebGL&&z$s.setPathId(z$r[5]),z$s.beginPath(),z$V+=z$r[0],z$U+=z$r[1],z$m.isWebGL&&z$s.movePath(z$V,z$U),z$s.strokeStyle=z$r[3],z$s.lineWidth=z$r[4];var z$p=z$r[2],z$c=2,z$R=z$p.length;if(z$m.isWebGL)for(z$s.moveTo(z$p[0],z$p[1]);z$c<z$R;)z$s.lineTo(z$p[z$c++],z$p[z$c++]);else for(z$s.moveTo(z$V+z$p[0],z$U+z$p[1]);z$c<z$R;)z$s.lineTo(z$V+z$p[z$c++],z$U+z$p[z$c++]);z$s.stroke()},this._drawLinesWebGL=function(z$V,z$U,z$r){this.ctx.drawLines(z$V+this.x+z$r[0],z$U+this.y+z$r[1],z$r[2],z$r[3],z$r[4])},this._drawCurves=function(z$V,z$U,z$r){this.ctx.drawCurves(z$V,z$U,z$r)},this._draw=function(z$V,z$U,z$r){z$r[0].call(null,this,z$V,z$U)},this._transformByMatrix=function(z$V,z$U,z$r){this.ctx.transformByMatrix(z$r[0])},this._setTransform=function(z$V,z$U,z$r){this.ctx.setTransform(z$r[0],z$r[1],z$r[2],z$r[3],z$r[4],z$r[5])},this._setTransformByMatrix=function(z$V,z$U,z$r){this.ctx.setTransformByMatrix(z$r[0])},this._save=function(z$V,z$U,z$r){this.ctx.save()},this._restore=function(z$V,z$U,z$r){this.ctx.restore()},this._translate=function(z$V,z$U,z$r){this.ctx.translate(z$r[0],z$r[1])},this._transform=function(z$V,z$U,z$r){this.ctx.translate(z$r[1]+z$V,z$r[2]+z$U);var z$s=z$r[0];this.ctx.transform(z$s.a,z$s.b,z$s.c,z$s.d,z$s.tx,z$s.ty),this.ctx.translate(-z$V-z$r[1],-z$U-z$r[2])},this._rotate=function(z$V,z$U,z$r){this.ctx.translate(z$r[1]+z$V,z$r[2]+z$U),this.ctx.rotate(z$r[0]),this.ctx.translate(-z$V-z$r[1],-z$U-z$r[2])},this._scale=function(z$V,z$U,z$r){this.ctx.translate(z$r[2]+z$V,z$r[3]+z$U),this.ctx.scale(z$r[0],z$r[1]),this.ctx.translate(-z$V-z$r[2],-z$U-z$r[3])},this._alpha=function(z$V,z$U,z$r){this.ctx.globalAlpha*=z$r[0]},this._setAlpha=function(z$V,z$U,z$r){this.ctx.globalAlpha=z$r[0]},this._fillText=function(z$V,z$U,z$r){this.ctx.fillText(z$r[0],z$r[1]+z$V,z$r[2]+z$U,z$r[3],z$r[4],z$r[5])},this._strokeText=function(z$V,z$U,z$r){this.ctx.strokeText(z$r[0],z$r[1]+z$V,z$r[2]+z$U,z$r[3],z$r[4],z$r[5],z$r[6])},this._fillBorderText=function(z$V,z$U,z$r){this.ctx.fillBorderText(z$r[0],z$r[1]+z$V,z$r[2]+z$U,z$r[3],z$r[4],z$r[5],z$r[6],z$r[7])},this._blendMode=function(z$V,z$U,z$r){this.ctx.globalCompositeOperation=z$r[0]},this._beginClip=function(z$V,z$U,z$r){this.ctx.beginClip&&this.ctx.beginClip(z$V+z$r[0],z$U+z$r[1],z$r[2],z$r[3])},this._setIBVB=function(z$V,z$U,z$r){this.ctx.setIBVB(z$r[0]+z$V,z$r[1]+z$U,z$r[2],z$r[3],z$r[4],z$r[5],z$r[6],z$r[7])},this._fillTrangles=function(z$V,z$U,z$r){this.ctx.fillTrangles(z$r[0],z$r[1]+z$V,z$r[2]+z$U,z$r[3],z$r[4])},this._drawPath=function(z$V,z$U,z$r){var z$s=this.ctx;z$m.isWebGL&&z$s.setPathId(-1),z$s.beginPath(),z$V+=z$r[0],z$U+=z$r[1],z$m.isWebGL&&z$s.movePath(z$V,z$U);for(var z$p=z$r[2],z$c=0,z$R=z$p.length;z$c<z$R;z$c++){var z$T=z$p[z$c];switch(z$T[0]){case"moveTo":z$m.isWebGL?z$s.moveTo(z$T[1],z$T[2]):z$s.moveTo(z$V+z$T[1],z$U+z$T[2]);break;case"lineTo":z$m.isWebGL?z$s.lineTo(z$T[1],z$T[2]):z$s.lineTo(z$V+z$T[1],z$U+z$T[2]);break;case"arcTo":z$m.isWebGL?z$s.arcTo(z$T[1],z$T[2],z$T[3],z$T[4],z$T[5]):z$s.arcTo(z$V+z$T[1],z$U+z$T[2],z$V+z$T[3],z$U+z$T[4],z$T[5]);break;case"closePath":z$s.closePath()}}var z$N=z$r[3];null!=z$N&&(z$s.fillStyle=z$N.fillStyle,z$s.fill());var z$t=z$r[4];null!=z$t&&(z$s.strokeStyle=z$t.strokeStyle,z$s.lineWidth=z$t.lineWidth||1,z$s.lineJoin=z$t.lineJoin,z$s.lineCap=z$t.lineCap,z$s.miterLimit=z$t.miterLimit,z$s.stroke())},this.drawPoly=function(z$V,z$U,z$r){this.ctx.drawPoly(z$V+this.x+z$r[0],z$U+this.y+z$r[1],z$r[2],z$r[3],z$r[4],z$r[5],z$r[6])},this._drawPoly=function(z$V,z$U,z$r){var z$s=this.ctx,z$p=z$r[2],z$c=2,z$R=z$p.length;if(z$m.isWebGL)for(z$s.setPathId(z$r[6]),z$s.beginPath(),z$V+=z$r[0],z$U+=z$r[1],z$s.movePath(z$V,z$U),z$s.moveTo(z$p[0],z$p[1]);z$c<z$R;)z$s.lineTo(z$p[z$c++],z$p[z$c++]);else for(z$s.beginPath(),z$V+=z$r[0],z$U+=z$r[1],z$s.moveTo(z$V+z$p[0],z$U+z$p[1]);z$c<z$R;)z$s.lineTo(z$V+z$p[z$c++],z$U+z$p[z$c++]);z$s.closePath(),this._fillAndStroke(z$r[3],z$r[4],z$r[5],z$r[7])},this._drawSkin=function(z$V,z$U,z$r){var z$s=z$r[0];if(z$s){var z$p=this.ctx;z$s.render(z$p,z$V,z$U)}},this._drawParticle=function(z$V,z$U,z$r){this.ctx.drawParticle(z$V+this.x,z$U+this.y,z$r[0])},this._setFilters=function(z$V,z$U,z$r){this.ctx.setFilters(z$r)},z$r?this.ctx=z$r.getContext("2d"):(z$r=z$OV.create("3D"),this.ctx=z$w.createWebGLContext2D(z$r),z$r._setContext(this.ctx)),z$r.size(z$V,z$U),this.canvas=z$r}z$b(z$R,"laya.renders.RenderContext");var z$V=z$R.prototype;return z$V.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},z$V.drawTexture=function(z$V,z$U,z$r,z$s,z$p){z$V.loaded&&this.ctx.drawTexture(z$V,z$U,z$r,z$s,z$p,this.x,this.y)},z$V._drawTextures=function(z$V,z$U,z$r){z$r[0].loaded&&this.ctx.drawTextures(z$r[0],z$r[1],z$V+this.x,z$U+this.y)},z$V.drawTextureWithTransform=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$V.loaded&&this.ctx.drawTextureWithTransform(z$V,z$U,z$r,z$s,z$p,z$c,this.x,this.y,z$R)},z$V.fillQuadrangle=function(z$V,z$U,z$r,z$s,z$p){this.ctx.fillQuadrangle(z$V,z$U,z$r,z$s,z$p)},z$V.drawCanvas=function(z$V,z$U,z$r,z$s,z$p){this.ctx.drawCanvas(z$V,z$U+this.x,z$r+this.y,z$s,z$p)},z$V.drawRect=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=1);var z$R=this.ctx;z$R.strokeStyle=z$p,z$R.lineWidth=z$c,z$R.strokeRect(z$V+this.x,z$U+this.y,z$r,z$s,z$c)},z$V._fillAndStroke=function(z$V,z$U,z$r,z$s){void 0===z$s&&(z$s=!1);var z$p=this.ctx;null!=z$V&&(z$p.fillStyle=z$V,z$m.isWebGL?z$p.fill(z$s):z$p.fill()),null!=z$U&&0<z$r&&(z$p.strokeStyle=z$U,z$p.lineWidth=z$r,z$p.stroke())},z$V.clipRect=function(z$V,z$U,z$r,z$s){this.ctx.clipRect(z$V+this.x,z$U+this.y,z$r,z$s)},z$V.fillRect=function(z$V,z$U,z$r,z$s,z$p){this.ctx.fillRect(z$V+this.x,z$U+this.y,z$r,z$s,z$p)},z$V.drawCircle=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=1),z$e.drawCall++;var z$c=this.ctx;z$c.beginPath(),z$c.strokeStyle=z$s,z$c.lineWidth=z$p,z$c.arc(z$V+this.x,z$U+this.y,z$r,0,z$R.PI2),z$c.stroke()},z$V.drawTriangles=function(z$V,z$U,z$r){if(z$m.isWebGL)this.ctx.drawTriangles(z$r[0],z$V+z$r[1],z$U+z$r[2],z$r[3],z$r[4],z$r[5],z$r[6],z$r[7],z$r[8],z$r[9]);else{var z$s=z$r[5],z$p=0,z$c=z$s.length,z$R=this.ctx;for(z$p=0;z$p<z$c;z$p+=3){var z$T=2*z$s[z$p],z$N=2*z$s[z$p+1],z$t=2*z$s[z$p+2];z$R.drawTriangle(z$r[0],z$r[3],z$r[4],z$T,z$N,z$t,z$r[6],!0)}}},z$V.fillCircle=function(z$V,z$U,z$r,z$s){z$e.drawCall++;var z$p=this.ctx;z$p.beginPath(),z$p.fillStyle=z$s,z$p.arc(z$V+this.x,z$U+this.y,z$r,0,z$R.PI2),z$p.fill()},z$V.setShader=function(z$V){this.ctx.setShader(z$V)},z$V.drawLine=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=1);var z$R=this.ctx;z$R.beginPath(),z$R.strokeStyle=z$p,z$R.lineWidth=z$c,z$R.moveTo(this.x+z$V,this.y+z$U),z$R.lineTo(this.x+z$r,this.y+z$s),z$R.stroke()},z$V.clear=function(){this.ctx.clear()},z$V.transformByMatrix=function(z$V){this.ctx.transformByMatrix(z$V)},z$V.setTransform=function(z$V,z$U,z$r,z$s,z$p,z$c){this.ctx.setTransform(z$V,z$U,z$r,z$s,z$p,z$c)},z$V.setTransformByMatrix=function(z$V){this.ctx.setTransformByMatrix(z$V)},z$V.save=function(){this.ctx.save()},z$V.restore=function(){this.ctx.restore()},z$V.translate=function(z$V,z$U){this.ctx.translate(z$V,z$U)},z$V.transform=function(z$V,z$U,z$r,z$s,z$p,z$c){this.ctx.transform(z$V,z$U,z$r,z$s,z$p,z$c)},z$V.rotate=function(z$V){this.ctx.rotate(z$V)},z$V.scale=function(z$V,z$U){this.ctx.scale(z$V,z$U)},z$V.alpha=function(z$V){this.ctx.globalAlpha*=z$V},z$V.setAlpha=function(z$V){this.ctx.globalAlpha=z$V},z$V.fillWords=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$c&&(z$c=0),this.ctx.fillWords(z$V,z$U,z$r,z$s,z$p,z$c)},z$V.fillBorderWords=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this.ctx.fillBorderWords(z$V,z$U,z$r,z$s,z$p,z$c,z$R)},z$V.fillText=function(z$V,z$U,z$r,z$s,z$p,z$c){this.ctx.fillText(z$V,z$U+this.x,z$r+this.y,z$s,z$p,z$c)},z$V.strokeText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this.ctx.strokeText(z$V,z$U+this.x,z$r+this.y,z$s,z$p,z$c,z$R)},z$V.blendMode=function(z$V){this.ctx.globalCompositeOperation=z$V},z$V.flush=function(){this.ctx.flush&&this.ctx.flush()},z$V.addRenderObject=function(z$V){this.ctx.addRenderObject(z$V)},z$V.beginClip=function(z$V,z$U,z$r,z$s){this.ctx.beginClip&&this.ctx.beginClip(z$V,z$U,z$r,z$s)},z$V.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},z$V.fillTrangles=function(z$V,z$U,z$r){this.ctx.fillTrangles(z$r[0],z$r[1],z$r[2],z$r[3],4<z$r.length?z$r[4]:null)},z$R.PI2=2*Math.PI,z$R}(),z$Z=function(){function z$R(z$V,z$U){switch(this._next=z$U||z$R.NORENDER,z$V){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=z$l._filter);case 69905:return void(this._fun=z$R._initRenderFun)}this.onCreate(z$V)}z$b(z$R,"laya.renders.RenderSprite");var z$V=z$R.prototype;return z$V.onCreate=function(z$V){},z$V._style=function(z$V,z$U,z$r,z$s){z$V._style.render(z$V,z$U,z$r,z$s);var z$p=this._next;z$p._fun.call(z$p,z$V,z$U,z$r,z$s)},z$V._no=function(z$V,z$U,z$r,z$s){},z$V._custom=function(z$V,z$U,z$r,z$s){z$V.customRender(z$U,z$r,z$s);var z$p=z$V._style._tf;this._next._fun.call(this._next,z$V,z$U,z$r-z$p.translateX,z$s-z$p.translateY)},z$V._clip=function(z$V,z$U,z$r,z$s){var z$p=this._next;if(z$p!=z$R.NORENDER){var z$c=z$V._style.scrollRect;z$U.ctx.save(),z$U.ctx.clipRect(z$r,z$s,z$c.width,z$c.height),z$p._fun.call(z$p,z$V,z$U,z$r-z$c.x,z$s-z$c.y),z$U.ctx.restore()}},z$V._blend=function(z$V,z$U,z$r,z$s){var z$p=z$V._style;z$p.blendMode&&(z$U.ctx.globalCompositeOperation=z$p.blendMode);var z$c=this._next;z$c._fun.call(z$c,z$V,z$U,z$r,z$s),z$U.ctx.globalCompositeOperation="source-over"},z$V._mask=function(z$V,z$U,z$r,z$s){var z$p=this._next;z$p._fun.call(z$p,z$V,z$U,z$r,z$s);var z$c=z$V.mask;z$c&&(z$U.ctx.globalCompositeOperation="destination-in",(0<z$c.numChildren||!z$c.graphics._isOnlyOne())&&(z$c.cacheAsBitmap=!0),z$c.render(z$U,z$r-z$V.pivotX,z$s-z$V.pivotY)),z$U.ctx.globalCompositeOperation="source-over"},z$V._graphics=function(z$V,z$U,z$r,z$s){var z$p=z$V._style._tf;z$V._graphics&&z$V._graphics._render(z$V,z$U,z$r-z$p.translateX,z$s-z$p.translateY);var z$c=this._next;z$c._fun.call(z$c,z$V,z$U,z$r,z$s)},z$V._image=function(z$V,z$U,z$r,z$s){var z$p=z$V._style;z$U.ctx.drawTexture2(z$r,z$s,z$p._tf.translateX,z$p._tf.translateY,z$V.transform,z$p.alpha,z$p.blendMode,z$V._graphics._one)},z$V._image2=function(z$V,z$U,z$r,z$s){var z$p=z$V._style._tf;z$U.ctx.drawTexture2(z$r,z$s,z$p.translateX,z$p.translateY,z$V.transform,1,null,z$V._graphics._one)},z$V._alpha=function(z$V,z$U,z$r,z$s){var z$p;if(.01<(z$p=z$V._style.alpha)||z$V._needRepaint()){var z$c=z$U.ctx.globalAlpha;z$U.ctx.globalAlpha*=z$p;var z$R=this._next;z$R._fun.call(z$R,z$V,z$U,z$r,z$s),z$U.ctx.globalAlpha=z$c}},z$V._transform=function(z$V,z$U,z$r,z$s){var z$p=z$V.transform,z$c=this._next;z$p&&z$c!=z$R.NORENDER?(z$U.save(),z$U.transform(z$p.a,z$p.b,z$p.c,z$p.d,z$p.tx+z$r,z$p.ty+z$s),z$c._fun.call(z$c,z$V,z$U,0,0),z$U.restore()):z$c._fun.call(z$c,z$V,z$U,z$r,z$s)},z$V._childs=function(z$V,z$U,z$r,z$s){var z$p=z$V._style,z$c=z$p._tf;if(z$r=z$r-z$c.translateX+z$p.paddingLeft,z$s=z$s-z$c.translateY+z$p.paddingTop,z$p._calculation){var z$R=z$V._getWords();if(z$R){var z$T=z$p;z$T&&(z$T.stroke?z$U.fillBorderWords(z$R,z$r,z$s,z$T.font,z$T.color,z$T.strokeColor,z$T.stroke):z$U.fillWords(z$R,z$r,z$s,z$T.font,z$T.color,"none"!=z$T.textDecoration&&z$T.underLine?1:0))}}var z$N,z$t=z$V._childs,z$b=z$t.length;if(z$V.viewport||z$V.optimizeScrollRect&&z$V._style.scrollRect){var z$S=z$V.viewport||z$V._style.scrollRect,z$_=z$S.x,z$G=z$S.y,z$q=z$S.right,z$u=z$S.bottom,z$h=NaN,z$l=NaN;for(z$W=0;z$W<z$b;++z$W)(z$N=z$t[z$W]).visible&&(z$h=z$N._x)<z$q&&z$h+z$N.width>z$_&&(z$l=z$N._y)<z$u&&z$l+z$N.height>z$G&&z$N.render(z$U,z$r,z$s)}else for(var z$W=0;z$W<z$b;++z$W)(z$N=z$t[z$W])._style.visible&&z$N.render(z$U,z$r,z$s)},z$V._canvas=function(z$V,z$U,z$r,z$s){var z$p=z$V._$P.cacheCanvas;if(z$p){"bitmap"===z$p.type?z$e.canvasBitmap++:z$e.canvasNormal++;var z$c=z$p.ctx;if(z$V._needRepaint()||!z$c)this._canvas_repaint(z$V,z$U,z$r,z$s);else{var z$R=z$p._cacheRec;z$U.drawCanvas(z$c.canvas,z$r+z$R.x,z$s+z$R.y,z$R.width,z$R.height)}}else this._next._fun.call(this._next,z$V,z$U,z$r,z$s)},z$V._canvas_repaint=function(z$V,z$U,z$r,z$s){var z$p=z$V._$P.cacheCanvas,z$c=this._next;if(z$p){var z$R,z$T,z$N,z$t,z$b=z$p.ctx,z$S=z$V._needRepaint()||!z$b,z$_=z$p.type;if("bitmap"===z$_?z$e.canvasBitmap++:z$e.canvasNormal++,z$S){var z$G,z$q;z$p._cacheRec||(z$p._cacheRec=new z$n),z$m.isWebGL&&"bitmap"!==z$_?z$p._cacheRec.setTo(-z$V.pivotX,-z$V.pivotY,1,1):((z$t=z$V.getSelfBounds()).x=z$t.x-z$V.pivotX,z$t.y=z$t.y-z$V.pivotY,z$t.x=z$t.x-16,z$t.y=z$t.y-16,z$t.width=z$t.width+32,z$t.height=z$t.height+32,z$t.x=Math.floor(z$t.x+z$r)-z$r,z$t.y=Math.floor(z$t.y+z$s)-z$s,z$t.width=Math.floor(z$t.width),z$t.height=Math.floor(z$t.height),z$p._cacheRec.copyFrom(z$t)),z$t=z$p._cacheRec;var z$u,z$h=z$m.isWebGL?1:z$j.pixelRatio*z$y.stage.clientScaleX,z$l=z$m.isWebGL?1:z$j.pixelRatio*z$y.stage.clientScaleY;if(!z$m.isWebGL){var z$W,z$O=1,z$L=1;for(z$W=z$V;z$W&&z$W!=z$y.stage;)z$O*=z$W.scaleX,z$L*=z$W.scaleY,z$W=z$W.parent;z$m.isWebGL?(z$O<1&&(z$h*=z$O),z$L<1&&(z$l*=z$L)):(1<z$O&&(z$h*=z$O),1<z$L&&(z$l*=z$L))}if(z$V.scrollRect){var z$d=z$V.scrollRect;z$t.x-=z$d.x,z$t.y-=z$d.y}if(z$G=z$t.width*z$h,z$q=z$t.height*z$l,z$T=z$t.x,z$N=z$t.y,z$m.isWebGL&&"bitmap"===z$_&&(2048<z$G||2048<z$q))return console.warn("cache bitmap size larger than 2048,cache ignored"),z$p.ctx&&(z$X.recover("RenderContext",z$p.ctx),z$p.ctx.canvas.size(0,0),z$p.ctx=null),void z$c._fun.call(z$c,z$V,z$U,z$r,z$s);if(z$b||(z$b=z$p.ctx=z$X.getItem("RenderContext")||new z$a(z$G,z$q,z$OV.create("AUTO"))),z$b.ctx.sprite=z$V,(z$R=z$b.canvas).clear(),(z$R.width!=z$G||z$R.height!=z$q)&&z$R.size(z$G,z$q),"bitmap"===z$_?z$R.context.asBitmap=!0:"normal"===z$_&&(z$R.context.asBitmap=!1),1!=z$h||1!=z$l){var z$k=z$b.ctx;z$k.save(),z$k.scale(z$h,z$l),!z$m.isConchWebGL&&z$m.isConchApp&&(z$u=z$V._$P.cf)&&z$k.setFilterMatrix&&z$k.setFilterMatrix(z$u._mat,z$u._alpha),z$c._fun.call(z$c,z$V,z$b,-z$T,-z$N),z$k.restore(),z$m.isConchApp&&!z$m.isConchWebGL||z$V._applyFilters()}else z$k=z$b.ctx,!z$m.isConchWebGL&&z$m.isConchApp&&(z$u=z$V._$P.cf)&&z$k.setFilterMatrix&&z$k.setFilterMatrix(z$u._mat,z$u._alpha),z$c._fun.call(z$c,z$V,z$b,-z$T,-z$N),z$m.isConchApp&&!z$m.isConchWebGL||z$V._applyFilters();z$V._$P.staticCache&&(z$p.reCache=!1),z$e.canvasReCache++}else z$T=(z$t=z$p._cacheRec).x,z$N=z$t.y,z$R=z$b.canvas;z$U.drawCanvas(z$R,z$r+z$T,z$s+z$N,z$t.width,z$t.height)}else z$c._fun.call(z$c,z$V,z$b,z$r,z$s)},z$R.__init__=function(){var z$V,z$U,z$r=0;for(z$U=z$w.createRenderSprite(69905,null),z$V=z$R.renders.length=4096,z$r=0;z$r<z$V;z$r++)z$R.renders[z$r]=z$U;z$R.renders[0]=z$w.createRenderSprite(0,null),function(z$V,z$U){for(var z$r=0,z$s=0;z$s<z$V.length;z$s++)z$r|=z$V[z$s],z$R.renders[z$r]=z$U}([1,512,4,2],new z$R(1,null)),z$R.renders[513]=z$w.createRenderSprite(513,null),z$R.renders[517]=new z$R(517,null)},z$R._initRenderFun=function(z$V,z$U,z$r,z$s){var z$p=z$V._renderType;(z$R.renders[z$p]=z$R._getTypeRender(z$p))._fun(z$V,z$U,z$r,z$s)},z$R._getTypeRender=function(z$V){for(var z$U=null,z$r=2048;1<z$r;)z$r&z$V&&(z$U=z$w.createRenderSprite(z$r,z$U)),z$r>>=1;return z$U},z$R.IMAGE=1,z$R.ALPHA=2,z$R.TRANSFORM=4,z$R.BLEND=8,z$R.CANVAS=16,z$R.FILTERS=32,z$R.MASK=64,z$R.CLIP=128,z$R.STYLE=256,z$R.GRAPHICS=512,z$R.CUSTOM=1024,z$R.CHILDS=2048,z$R.INIT=69905,z$R.renders=[],z$R.NORENDER=new z$R(0,null),z$R}(),z$x=function(){function z$T(){this._repaint=!1}z$b(z$T,"laya.resource.Context");var z$V=z$T.prototype;return z$V.replaceReset=function(){var z$V,z$U,z$r=0;for(z$V=z$T.replaceKeys.length,z$r=0;z$r<z$V;z$r++)z$U=z$T.replaceKeys[z$r],this[z$T.newKeys[z$r]]=this[z$U]},z$V.replaceResotre=function(){this.__restore(),this.__reset()},z$V.setIsMainContext=function(){},z$V.drawTextures=function(z$V,z$U,z$r,z$s){z$e.drawCall+=z$U.length/2;for(var z$p=z$V.width,z$c=z$V.height,z$R=0,z$T=z$U.length;z$R<z$T;z$R+=2)this.drawTexture(z$V,z$U[z$R],z$U[z$R+1],z$p,z$c,z$r,z$s)},z$V.drawCanvas=function(z$V,z$U,z$r,z$s,z$p){z$e.drawCall++,this.drawImage(z$V.source,z$U,z$r,z$s,z$p)},z$V.fillRect=function(z$V,z$U,z$r,z$s,z$p){z$e.drawCall++,z$p&&(this.fillStyle=z$p),this.__fillRect(z$V,z$U,z$r,z$s)},z$V.fillText=function(z$V,z$U,z$r,z$s,z$p,z$c){z$e.drawCall++,3<arguments.length&&null!=z$s&&(this.font=z$s,this.fillStyle=z$p,this.textAlign=z$c,this.textBaseline="top"),this.__fillText(z$V,z$U,z$r)},z$V.fillBorderText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){z$e.drawCall++,this.font=z$s,this.fillStyle=z$p,this.textBaseline="top",this.strokeStyle=z$c,this.lineWidth=z$R,this.textAlign=z$T,this.__strokeText(z$V,z$U,z$r),this.__fillText(z$V,z$U,z$r)},z$V.strokeText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$e.drawCall++,3<arguments.length&&null!=z$s&&(this.font=z$s,this.strokeStyle=z$p,this.lineWidth=z$c,this.textAlign=z$R,this.textBaseline="top"),this.__strokeText(z$V,z$U,z$r)},z$V.transformByMatrix=function(z$V){this.transform(z$V.a,z$V.b,z$V.c,z$V.d,z$V.tx,z$V.ty)},z$V.setTransformByMatrix=function(z$V){this.setTransform(z$V.a,z$V.b,z$V.c,z$V.d,z$V.tx,z$V.ty)},z$V.clipRect=function(z$V,z$U,z$r,z$s){z$e.drawCall++,this.beginPath(),this.rect(z$V,z$U,z$r,z$s),this.clip()},z$V.drawTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$e.drawCall++;var z$T=z$V.uv,z$N=z$V.bitmap.width,z$t=z$V.bitmap.height;this.drawImage(z$V.source,z$T[0]*z$N,z$T[1]*z$t,(z$T[2]-z$T[0])*z$N,(z$T[5]-z$T[3])*z$t,z$U+z$c,z$r+z$R,z$s,z$p)},z$V.drawTextureWithTransform=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){z$e.drawCall++;var z$t=z$V.uv,z$b=z$V.bitmap.width,z$S=z$V.bitmap.height;this.save(),1!=z$N&&(this.globalAlpha*=z$N),z$c?(this.transform(z$c.a,z$c.b,z$c.c,z$c.d,z$c.tx+z$R,z$c.ty+z$T),this.drawImage(z$V.source,z$t[0]*z$b,z$t[1]*z$S,(z$t[2]-z$t[0])*z$b,(z$t[5]-z$t[3])*z$S,z$U,z$r,z$s,z$p)):this.drawImage(z$V.source,z$t[0]*z$b,z$t[1]*z$S,(z$t[2]-z$t[0])*z$b,(z$t[5]-z$t[3])*z$S,z$U+z$R,z$r+z$T,z$s,z$p),this.restore()},z$V.drawTexture2=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=z$T[0];if(z$N.loaded&&z$N.bitmap&&z$N.source){z$e.drawCall++;var z$t=1!==z$c;if(z$t){var z$b=this.globalAlpha;this.globalAlpha*=z$c}var z$S=z$N.uv,z$_=z$N.bitmap.width,z$G=z$N.bitmap.height;z$p?(this.save(),this.transform(z$p.a,z$p.b,z$p.c,z$p.d,z$p.tx+z$V,z$p.ty+z$U),this.drawImage(z$N.source,z$S[0]*z$_,z$S[1]*z$G,(z$S[2]-z$S[0])*z$_,(z$S[5]-z$S[3])*z$G,z$T[1]-z$r,z$T[2]-z$s,z$T[3],z$T[4]),this.restore()):this.drawImage(z$N.source,z$S[0]*z$_,z$S[1]*z$G,(z$S[2]-z$S[0])*z$_,(z$S[5]-z$S[3])*z$G,z$T[1]-z$r+z$V,z$T[2]-z$s+z$U,z$T[3],z$T[4]),z$t&&(this.globalAlpha=z$b)}},z$V.fillTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){if(!z$T.pat){if(z$V.uv!=z$bV.DEF_UV){var z$N=new z$OV("2D");z$N.getContext("2d"),z$N.size(z$V.width,z$V.height),z$N.context.drawTexture(z$V,0,0,z$V.width,z$V.height,0,0),z$V=new z$bV(z$N)}z$T.pat=this.createPattern(z$V.bitmap.source,z$c)}var z$t=z$U,z$b=z$r,z$S=0,z$_=0;z$R&&(z$t+=z$R.x%z$V.width,z$b+=z$R.y%z$V.height,z$S-=z$R.x%z$V.width,z$_-=z$R.y%z$V.height),this.translate(z$t,z$b),this.fillRect(z$S,z$_,z$s,z$p,z$T.pat),this.translate(-z$t,-z$b)},z$V.drawTriangle=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=z$V.bitmap,z$t=z$N.source,z$b=z$V.width,z$S=z$V.height,z$_=z$N.width,z$G=z$N.height,z$q=z$r[z$s]*z$_,z$u=z$r[z$p]*z$_,z$h=z$r[z$c]*z$_,z$l=z$r[z$s+1]*z$G,z$W=z$r[z$p+1]*z$G,z$O=z$r[z$c+1]*z$G,z$L=z$U[z$s],z$d=z$U[z$p],z$k=z$U[z$c],z$y=z$U[z$s+1],z$D=z$U[z$p+1],z$n=z$U[z$c+1];if(z$T){var z$I=(z$L+z$d+z$k)/3,z$Q=(z$y+z$D+z$n)/3,z$H=z$L-z$I,z$w=z$y-z$Q,z$z=Math.sqrt(z$H*z$H+z$w*z$w);z$L=z$I+z$H/z$z*(z$z+1),z$y=z$Q+z$w/z$z*(z$z+1),z$w=z$D-z$Q,z$d=z$I+(z$H=z$d-z$I)/(z$z=Math.sqrt(z$H*z$H+z$w*z$w))*(z$z+1),z$D=z$Q+z$w/z$z*(z$z+1),z$w=z$n-z$Q,z$k=z$I+(z$H=z$k-z$I)/(z$z=Math.sqrt(z$H*z$H+z$w*z$w))*(z$z+1),z$n=z$Q+z$w/z$z*(z$z+1)}this.save(),z$R&&this.transform(z$R.a,z$R.b,z$R.c,z$R.d,z$R.tx,z$R.ty),this.beginPath(),this.moveTo(z$L,z$y),this.lineTo(z$d,z$D),this.lineTo(z$k,z$n),this.closePath(),this.clip();var z$E=1/(z$q*z$W+z$l*z$h+z$u*z$O-z$W*z$h-z$l*z$u-z$q*z$O),z$K=z$L*z$W+z$l*z$k+z$d*z$O-z$W*z$k-z$l*z$d-z$L*z$O,z$m=z$q*z$d+z$L*z$h+z$u*z$k-z$d*z$h-z$L*z$u-z$q*z$k,z$a=z$q*z$W*z$k+z$l*z$d*z$h+z$L*z$u*z$O-z$L*z$W*z$h-z$l*z$u*z$k-z$q*z$d*z$O,z$Z=z$y*z$W+z$l*z$n+z$D*z$O-z$W*z$n-z$l*z$D-z$y*z$O,z$x=z$q*z$D+z$y*z$h+z$u*z$n-z$D*z$h-z$y*z$u-z$q*z$n,z$$=z$q*z$W*z$n+z$l*z$D*z$h+z$y*z$u*z$O-z$y*z$W*z$h-z$l*z$u*z$n-z$q*z$D*z$O;this.transform(z$K*z$E,z$Z*z$E,z$m*z$E,z$x*z$E,z$a*z$E,z$$*z$E),this.drawImage(z$t,z$V.uv[0]*z$_,z$V.uv[1]*z$G,z$b,z$S,z$V.uv[0]*z$_,z$V.uv[1]*z$G,z$b,z$S),this.restore()},z$V.flush=function(){return 0},z$V.fillWords=function(z$V,z$U,z$r,z$s,z$p,z$c){z$s&&(this.font=z$s),z$p&&(this.fillStyle=z$p);this.textBaseline="top",this.textAlign="left";for(var z$R=0,z$T=z$V.length;z$R<z$T;z$R++){var z$N=z$V[z$R];if(this.__fillText(z$N.char,z$N.x+z$U,z$N.y+z$r),1===z$c){var z$t=z$N.height,z$b=.5*z$N.style.letterSpacing;z$b||(z$b=0),this.beginPath(),this.strokeStyle=z$p,this.lineWidth=1,this.moveTo(z$U+z$N.x-z$b+.5,z$r+z$N.y+z$t+.5),this.lineTo(z$U+z$N.x+z$N.width+z$b+.5,z$r+z$N.y+z$t+.5),this.stroke()}}},z$V.fillBorderWords=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$s&&(this.font=z$s),z$p&&(this.fillStyle=z$p),this.textBaseline="top",this.lineWidth=z$R,this.textAlign="left",this.strokeStyle=z$c;for(var z$T=0,z$N=z$V.length;z$T<z$N;z$T++){var z$t=z$V[z$T];this.__strokeText(z$t.char,z$t.x+z$U,z$t.y+z$r),this.__fillText(z$t.char,z$t.x+z$U,z$t.y+z$r)}},z$V.destroy=function(){this.canvas.width=this.canvas.height=0},z$V.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},z$V.drawCurves=function(z$V,z$U,z$r){this.beginPath(),this.strokeStyle=z$r[3],this.lineWidth=z$r[4];var z$s=z$r[2];z$V+=z$r[0],z$U+=z$r[1],this.moveTo(z$V+z$s[0],z$U+z$s[1]);for(var z$p=2,z$c=z$s.length;z$p<z$c;)this.quadraticCurveTo(z$V+z$s[z$p++],z$U+z$s[z$p++],z$V+z$s[z$p++],z$U+z$s[z$p++]);this.stroke()},z$T.__init__=function(z$U){var z$r=laya.resource.Context.prototype;if(!(z$U=z$U||CanvasRenderingContext2D.prototype).inited){z$U.inited=!0,z$U.__fillText=z$U.fillText,z$U.__fillRect=z$U.fillRect,z$U.__strokeText=z$U.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(z$V){z$U[z$V]=z$r[z$V]})}},z$T.replaceCanvasGetSet=function(z$V,z$U){var z$r=Object.getOwnPropertyDescriptor(z$V,z$U);if(!z$r||!z$r.configurable)return!1;var z$s,z$p={};for(z$s in z$r)"set"!=z$s&&(z$p[z$s]=z$r[z$s]);var z$c=z$r.set;return z$p.set=function(z$V){z$c.call(this,z$V);var z$U=this.getContext("2d");z$U&&"__reset"in z$U&&z$U.__reset()},Object.defineProperty(z$V,z$U,z$p),!0},z$T.replaceGetSet=function(z$V,z$U){var z$r=Object.getOwnPropertyDescriptor(z$V,z$U);if(!z$r||!z$r.configurable)return!1;var z$s,z$p={};for(z$s in z$r)"set"!=z$s&&(z$p[z$s]=z$r[z$s]);var z$c=z$r.set,z$R="___"+z$U+"__";return z$T.newKeys.push(z$R),z$p.set=function(z$V){z$V!=this[z$R]&&(this[z$R]=z$V,z$c.call(this,z$V))},Object.defineProperty(z$V,z$U,z$p),!0},z$T._default=new z$T,z$T.newKeys=[],z$N(z$T,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),z$T}(),z$$=function(){function z$c(z$V){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++z$c._uniqueIDCounter,this._name=z$V||"Content Manager",z$c._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,z$c._resourceManagers.push(this),this._resources=[],this._records={}}z$b(z$c,"laya.resource.ResourceManager");var z$V=z$c.prototype;return z$y.imps(z$V,{"laya.resource.IDispose":!0}),z$V.getResourceByIndex=function(z$V){return this._resources[z$V]},z$V.getResourcesLength=function(){return this._resources.length},z$V.addResource=function(z$V){return z$V.resourceManager&&z$V.resourceManager.removeResource(z$V),-1===this._resources.indexOf(z$V)&&((z$V._resourceManager=this)._resources.push(z$V),this.addRecord(z$V.uri,z$V.__className,z$V.memorySize),this.addSize(z$V.memorySize),!0)},z$V.removeResource=function(z$V){var z$U=this._resources.indexOf(z$V);return-1!==z$U&&(this._resources.splice(z$U,1),z$V._resourceManager=null,this._memorySize-=z$V.memorySize,this.addRecord(z$V.uri,z$V.__className,-z$V.memorySize),!0)},z$V.unload=function(){for(var z$V=this._resources.slice(0,this._resources.length),z$U=0;z$U<z$V.length;z$U++){z$V[z$U].destroy()}z$V.length=0},z$V.dispose=function(){if(this===z$c._systemResourceManager)throw new Error("systemResourceManager不能被释放！");z$c._resourceManagers.splice(z$c._resourceManagers.indexOf(this),1),z$c._isResourceManagersSorted=!1;for(var z$V=this._resources.slice(0,this._resources.length),z$U=0;z$U<z$V.length;z$U++){var z$r=z$V[z$U];z$r.resourceManager.removeResource(z$r),z$r.destroy()}z$V.length=0},z$V.addSize=function(z$V){z$V&&(this.autoRelease&&0<z$V&&this._memorySize+z$V>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=z$V)},z$V.addRecord=function(z$V,z$U,z$r){DEBUG&&z$r&&!z$V&&console.error(z$V,z$U,z$r),z$V&&(this._records.hasOwnProperty(z$U+"|"+z$V)||(this._records[z$U+"|"+z$V]=0),this._records[z$U+"|"+z$V]+=z$r,DEBUG&&this._records[z$U+"|"+z$V]<0&&console.error(z$V,z$U,this._records[z$U+"|"+z$V]))},z$V.garbageCollection=function(z$V){var z$U=this._resources;(z$U=z$U.slice()).sort(function(z$V,z$U){if(!z$V||!z$U)throw new Error("a或b不能为空！");return z$V.released&&z$U.released?0:z$V.released?1:z$U.released?-1:z$V._lastUseFrameCount-z$U._lastUseFrameCount});for(var z$r=z$e.loopCount,z$s=0,z$p=z$U.length;z$s<z$p;z$s++){var z$c=z$U[z$s];if(!(1<z$r-z$c._lastUseFrameCount))return void(this._memorySize>=z$V&&(this._isOverflow=!0));if(z$c.releaseResource(),this._memorySize<z$V)return void(this._isOverflow=!1)}},z$q(0,z$V,"id",function(){return this._id}),z$q(0,z$V,"name",function(){return this._name},function(z$V){!z$V&&""===z$V||this._name===z$V||(this._name=z$V,z$c._isResourceManagersSorted=!1)}),z$q(0,z$V,"memorySize",function(){return this._memorySize}),z$q(0,z$V,"records",function(){return this._records}),z$q(1,z$c,"systemResourceManager",function(){return z$c._systemResourceManager}),z$c.__init__=function(){z$c.currentResourceManager=z$c.systemResourceManager},z$c.getLoadedResourceManagerByIndex=function(z$V){return z$c._resourceManagers[z$V]},z$c.getLoadedResourceManagersCount=function(){return z$c._resourceManagers.length},z$c.recreateContentManagers=function(z$V){void 0===z$V&&(z$V=!1);for(var z$U=z$c.currentResourceManager,z$r=0;z$r<z$c._resourceManagers.length;z$r++){z$c.currentResourceManager=z$c._resourceManagers[z$r];for(var z$s=0;z$s<z$c.currentResourceManager._resources.length;z$s++)z$c.currentResourceManager._resources[z$s].releaseResource(z$V),z$c.currentResourceManager._resources[z$s].activeResource(z$V)}z$c.currentResourceManager=z$U},z$c.releaseContentManagers=function(z$V){void 0===z$V&&(z$V=!1);for(var z$U=z$c.currentResourceManager,z$r=0;z$r<z$c._resourceManagers.length;z$r++){z$c.currentResourceManager=z$c._resourceManagers[z$r];for(var z$s=0;z$s<z$c.currentResourceManager._resources.length;z$s++){var z$p=z$c.currentResourceManager._resources[z$s];!z$p.released&&z$p.releaseResource(z$V)}}z$c.currentResourceManager=z$U},z$c._uniqueIDCounter=0,z$c._isResourceManagersSorted=!1,z$c._resourceManagers=[],z$N(z$c,["_systemResourceManager",function(){return this._systemResourceManager=new z$c("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=z$c._systemResourceManager}]),z$c}(),z$j=(function(){function z$V(){}z$b(z$V,"laya.system.System"),z$V.changeDefinition=function(z$V,z$U){z$y[z$V]=z$U;var z$r=z$V+"=classObj";z$y._runScript(z$r)},z$V.__init__=function(){z$m.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function z$r(){}return z$b(z$r,"laya.utils.Browser"),z$q(1,z$r,"pixelRatio",function(){return z$r.__init__(),-1<z$r.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:z$w.getPixelRatio()}),z$q(1,z$r,"height",function(){return z$r.__init__(),(z$y.stage&&z$y.stage.canvasRotation?z$r.clientWidth:z$r.clientHeight)*z$r.pixelRatio}),z$q(1,z$r,"clientWidth",function(){return z$r.__init__(),z$r.window.innerWidth||z$r.document.body.clientWidth}),z$q(1,z$r,"window",function(){return z$r.__init__(),z$r._window}),z$q(1,z$r,"clientHeight",function(){return z$r.__init__(),z$r.window.innerHeight||z$r.document.body.clientHeight||z$r.document.documentElement.clientHeight}),z$q(1,z$r,"width",function(){return z$r.__init__(),(z$y.stage&&z$y.stage.canvasRotation?z$r.clientHeight:z$r.clientWidth)*z$r.pixelRatio}),z$q(1,z$r,"container",function(){return z$r.__init__(),z$r._container||((z$r._container=z$r.createElement("div")).id="layaContainer",z$r.document.body.appendChild(z$r._container)),z$r._container},function(z$V){z$r._container=z$V}),z$q(1,z$r,"document",function(){return z$r.__init__(),z$r._document}),z$r.__init__=function(){if(!z$r._window){z$r._window=z$w.getWindow(),z$r._document=z$r.window.document,z$r._window.addEventListener("message",function(z$V){laya.utils.Browser._onMessage(z$V)},!1),z$r.document.__createElement=z$r.document.createElement,z$R.requestAnimationFrame=z$R.requestAnimationFrame||z$R.webkitRequestAnimationFrame||z$R.mozRequestAnimationFrame||z$R.oRequestAnimationFrame||z$R.msRequestAnimationFrame||function(z$V){return z$R.setTimeout(z$V,1e3/60)};var z$V=z$R.document.body.style;z$V["-webkit-user-select"]="none",z$V["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",z$r.userAgent=z$r.window.navigator.userAgent,z$r.onIOS=!!(z$r.u=z$r.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),z$r.onMobile=-1<z$r.u.indexOf("Mobile"),z$r.onIPhone=-1<z$r.u.indexOf("iPhone"),z$r.onMac=-1<z$r.u.indexOf("Mac OS X"),z$r.onIPad=-1<z$r.u.indexOf("iPad"),z$r.onAndroid=-1<z$r.u.indexOf("Android")||-1<z$r.u.indexOf("Adr"),z$r.onWP=-1<z$r.u.indexOf("Windows Phone"),z$r.onQQBrowser=-1<z$r.u.indexOf("QQBrowser"),z$r.onMQQBrowser=-1<z$r.u.indexOf("MQQBrowser")||-1<z$r.u.indexOf("Mobile")&&-1<z$r.u.indexOf("QQ"),z$r.onIE=!!z$r.window.ActiveXObject||"ActiveXObject"in z$r.window,z$r.onWeiXin=-1<z$r.u.indexOf("MicroMessenger"),z$r.onPC=!z$r.onMobile,z$r.onSafari=-1<z$r.u.indexOf("Safari"),z$r.onFirefox=-1<z$r.u.indexOf("Firefox"),z$r.onEdge=-1<z$r.u.indexOf("Edge"),z$r.onMiniGame=-1<z$r.u.indexOf("MiniGame"),z$r.onLimixiu=-1<z$r.u.indexOf("limixiu"),z$r.httpProtocol="http:"==z$r.window.location.protocol,z$r.onMiniGame&&null==z$r.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),z$r.webAudioEnabled=!!(z$r.window.AudioContext||z$r.window.webkitAudioContext||z$r.window.mozAudioContext),z$r.soundType=z$r.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",z$pV=z$r.webAudioEnabled?z$cV:z$rV,z$r.webAudioEnabled&&z$cV.initWebAudio(),z$rV._initMusicAudio(),z$r.enableTouch="ontouchstart"in z$R||z$R.DocumentTouch&&z$U instanceof DocumentTouch,z$R.focus(),z$H._soundClass=z$pV,z$H._musicClass=z$rV,z$m._mainCanvas=z$m._mainCanvas||z$OV.create("2D"),z$r.canvas||(z$r.canvas=z$OV.create("2D"),z$r.context=z$r.canvas.getContext("2d"))}},z$r._onMessage=function(z$V){if(z$V.data&&"size"==z$V.data.name){if(z$r.window.innerWidth=z$V.data.width,z$r.window.innerHeight=z$V.data.height,z$r.window.__innerHeight=z$V.data.clientHeight,!z$r.document.createEvent)return void console.warn("no document.createEvent");var z$U=z$r.document.createEvent("HTMLEvents");return z$U.initEvent("resize",!1,!1),void z$r.window.dispatchEvent(z$U)}},z$r.createElement=function(z$V){return z$r.__init__(),z$r.document.__createElement(z$V)},z$r.getElementById=function(z$V){return z$r.__init__(),z$r.document.getElementById(z$V)},z$r.removeElement=function(z$V){z$V&&z$V.parentNode&&z$V.parentNode.removeChild(z$V)},z$r.now=function(){return z$w.now()},z$r._window=null,z$r._document=null,z$r._container=null,z$r.userAgent=null,z$r.u=null,z$r.onIOS=!1,z$r.onMac=!1,z$r.onMobile=!1,z$r.onIPhone=!1,z$r.onIPad=!1,z$r.onAndroid=!1,z$r.onWP=!1,z$r.onQQBrowser=!1,z$r.onMQQBrowser=!1,z$r.onSafari=!1,z$r.onFirefox=!1,z$r.onEdge=!1,z$r.onIE=!1,z$r.onWeiXin=!1,z$r.onMiniGame=!1,z$r.onLimixiu=!1,z$r.onPC=!1,z$r.httpProtocol=!1,z$r.webAudioEnabled=!1,z$r.soundType=null,z$r.enableTouch=!1,z$r.canvas=null,z$r.context=null,z$r.__init$=function(){},z$r}()),z$o=function(){function z$U(z$V){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,z$V?(this._u8d_=new Uint8Array(z$V),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}z$b(z$U,"laya.utils.Byte");var z$V=z$U.prototype;return z$V.___resizeBuffer=function(z$U){try{var z$V=new Uint8Array(z$U);null!=this._u8d_&&(this._u8d_.length<=z$U?z$V.set(this._u8d_):z$V.set(this._u8d_.subarray(0,z$U))),this._u8d_=z$V,this._d_=new DataView(z$V.buffer)}catch(z$V){throw"___resizeBuffer err:"+z$U}},z$V.getString=function(){return this.rUTF(this.getUint16())},z$V.getFloat32Array=function(z$V,z$U){var z$r=z$V+z$U;z$r=z$r>this._length?this._length:z$r;var z$s=new Float32Array(this._d_.buffer.slice(z$V,z$r));return this._pos_=z$r,z$s},z$V.getUint8Array=function(z$V,z$U){var z$r=z$V+z$U;z$r=z$r>this._length?this._length:z$r;var z$s=new Uint8Array(this._d_.buffer.slice(z$V,z$r));return this._pos_=z$r,z$s},z$V.getInt16Array=function(z$V,z$U){var z$r=z$V+z$U;z$r=z$r>this._length?this._length:z$r;var z$s=new Int16Array(this._d_.buffer.slice(z$V,z$r));return this._pos_=z$r,z$s},z$V.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var z$V=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,z$V},z$V.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var z$V=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,z$V},z$V.writeFloat32=function(z$V){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,z$V,this._xd_),this._pos_+=4},z$V.writeFloat64=function(z$V){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,z$V,this._xd_),this._pos_+=8},z$V.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var z$V=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,z$V},z$V.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var z$V=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,z$V},z$V.writeInt32=function(z$V){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,z$V,this._xd_),this._pos_+=4},z$V.writeUint32=function(z$V){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,z$V,this._xd_),this._pos_+=4},z$V.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var z$V=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,z$V},z$V.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var z$V=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,z$V},z$V.writeUint16=function(z$V){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,z$V,this._xd_),this._pos_+=2},z$V.writeInt16=function(z$V){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,z$V,this._xd_),this._pos_+=2},z$V.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},z$V.writeUint8=function(z$V){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,z$V),this._pos_++},z$V._getUInt8=function(z$V){return this._d_.getUint8(z$V)},z$V._getUint16=function(z$V){return this._d_.getUint16(z$V,this._xd_)},z$V._getMatrix=function(){return new z$z(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},z$V.rUTF=function(z$V){for(var z$U=[],z$r=this._pos_+z$V,z$s=0,z$p=0,z$c=0,z$R=String.fromCharCode,z$T=this._u8d_;this._pos_<z$r;)(z$s=z$T[this._pos_++])<128?0!=z$s&&z$U.push(z$R(z$s)):z$s<224?z$U.push(z$R((63&z$s)<<6|127&z$T[this._pos_++])):z$s<240?(z$p=z$T[this._pos_++],z$U.push(z$R((31&z$s)<<12|(127&z$p)<<6|127&z$T[this._pos_++]))):(z$p=z$T[this._pos_++],z$c=z$T[this._pos_++],z$U.push(z$R((15&z$s)<<18|(127&z$p)<<12|z$c<<6&127|127&z$T[this._pos_++]))),0;return z$U.join("")},z$V.getCustomString=function(z$V){for(var z$U=[],z$r=0,z$s=0,z$p=0,z$c=String.fromCharCode,z$R=this._u8d_;0<z$V;)if((z$s=z$R[this._pos_])<128)z$U.push(z$c(z$s)),this._pos_++,z$V--;else for(z$r=z$s-128,this._pos_++,z$V-=z$r;0<z$r;)z$s=z$R[this._pos_++],z$p=z$R[this._pos_++],z$U.push(z$c(z$p<<8|z$s)),z$r--;return z$U.join("")},z$V.clear=function(){this._pos_=0,this.length=0},z$V.__getBuffer=function(){return this._d_.buffer},z$V.writeUTFBytes=function(z$V){for(var z$U=0,z$r=(z$V+="").length;z$U<z$r;z$U++){var z$s=z$V.charCodeAt(z$U);z$s<=127?this.writeByte(z$s):z$s<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|z$s>>6,128|63&z$s],this._pos_),this._pos_+=2):z$s<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|z$s>>12,128|z$s>>6&63,128|63&z$s],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|z$s>>18,128|z$s>>12&63,128|z$s>>6&63,128|63&z$s],this._pos_),this._pos_+=4)}},z$V.writeUTFString=function(z$V){var z$U=this.pos;this.writeUint16(1),this.writeUTFBytes(z$V);var z$r=this.pos-z$U-2;if(65536<=z$r)throw"writeUTFString byte len more than 65536";this._d_.setUint16(z$U,z$r,this._xd_)},z$V.readUTFString=function(){return this.readUTFBytes(this.getUint16())},z$V.getUTFString=function(){return this.readUTFString()},z$V.readUTFBytes=function(z$V){if(void 0===z$V&&(z$V=-1),0==z$V)return"";var z$U=this.bytesAvailable;if(z$U<z$V)throw"readUTFBytes error - Out of bounds";return z$V=0<z$V?z$V:z$U,this.rUTF(z$V)},z$V.getUTFBytes=function(z$V){return void 0===z$V&&(z$V=-1),this.readUTFBytes(z$V)},z$V.writeByte=function(z$V){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,z$V),this._pos_+=1},z$V.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},z$V.getByte=function(){return this.readByte()},z$V.ensureWrite=function(z$V){this._length<z$V&&(this._length=z$V),this._allocated_<z$V&&(this.length=z$V)},z$V.writeArrayBuffer=function(z$V,z$U,z$r){if(void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),z$U<0||z$r<0)throw"writeArrayBuffer error - Out of bounds";0==z$r&&(z$r=z$V.byteLength-z$U),this.ensureWrite(this._pos_+z$r);var z$s=new Uint8Array(z$V);this._u8d_.set(z$s.subarray(z$U,z$U+z$r),this._pos_),this._pos_+=z$r},z$q(0,z$V,"buffer",function(){var z$V=this._d_.buffer;return z$V.byteLength==this.length?z$V:z$V.slice(0,this.length)}),z$q(0,z$V,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(z$V){this._xd_="littleEndian"==z$V}),z$q(0,z$V,"length",function(){return this._length},function(z$V){this._allocated_<z$V?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(z$V,2*this._allocated_))):this._allocated_>z$V&&this.___resizeBuffer(this._allocated_=z$V),this._length=z$V}),z$q(0,z$V,"pos",function(){return this._pos_},function(z$V){this._pos_=z$V}),z$q(0,z$V,"bytesAvailable",function(){return this._length-this._pos_}),z$U.getSystemEndian=function(){if(!z$U._sysEndian){var z$V=new ArrayBuffer(2);new DataView(z$V).setInt16(0,256,!0),z$U._sysEndian=256===new Int16Array(z$V)[0]?"littleEndian":"bigEndian"}return z$U._sysEndian},z$U.BIG_ENDIAN="bigEndian",z$U.LITTLE_ENDIAN="littleEndian",z$U._sysEndian=null,z$U}(),z$J=function(){function z$p(){}return z$b(z$p,"laya.utils.CacheManager"),z$p.regCacheByFunction=function(z$V,z$U){var z$r;z$p.unRegCacheByFunction(z$V,z$U),z$r={tryDispose:z$V,getCacheList:z$U},z$p._cacheList.push(z$r)},z$p.unRegCacheByFunction=function(z$V,z$U){var z$r,z$s=0;for(z$r=z$p._cacheList.length,z$s=0;z$s<z$r;z$s++)if(z$p._cacheList[z$s].tryDispose==z$V&&z$p._cacheList[z$s].getCacheList==z$U)return void z$p._cacheList.splice(z$s,1)},z$p.forceDispose=function(){var z$V=0,z$U=z$p._cacheList.length;for(z$V=0;z$V<z$U;z$V++)z$p._cacheList[z$V].tryDispose(!0)},z$p.beginCheck=function(z$V){void 0===z$V&&(z$V=15e3),z$y.timer.loop(z$V,null,z$p._checkLoop)},z$p.stopCheck=function(){z$y.timer.clear(null,z$p._checkLoop)},z$p._checkLoop=function(){var z$V=z$p._cacheList;if(!(z$V.length<1)){var z$U,z$r=z$j.now(),z$s=0;for(z$U=z$s=z$V.length;0<z$s&&(z$V[z$p._index=++z$p._index%z$U].tryDispose(!1),!(z$j.now()-z$r>z$p.loopTimeLimit));)z$s--}},z$p.loopTimeLimit=2,z$p._cacheList=[],z$p._index=0,z$p}(),z$i=function(){function z$G(){}return z$b(z$G,"laya.utils.ClassUtils"),z$G.regClass=function(z$V,z$U){z$G._classMap[z$V]=z$U},z$G.getRegClass=function(z$V){return z$G._classMap[z$V]},z$G.getInstance=function(z$V){var z$U=z$G.getClass(z$V);return z$U?new z$U:(console.warn("[error] Undefined class:",z$V),null)},z$G.createByJson=function(z$V,z$U,z$r,z$s,z$p){"string"==typeof z$V&&(z$V=JSON.parse(z$V));var z$c=z$V.props;if(!z$U&&!(z$U=z$p?z$p.runWith(z$V):z$G.getInstance(z$c.runtime||z$V.type)))return null;var z$R=z$V.child;if(z$R)for(var z$T=0,z$N=z$R.length;z$T<z$N;z$T++){var z$t=z$R[z$T];if("render"!==z$t.props.name&&"render"!==z$t.props.renderType||!z$U._$set_itemRender)if("Graphic"==z$t.type)z$G.addGraphicsToSprite(z$t,z$U);else if(z$G.isDrawType(z$t.type))z$G.addGraphicToSprite(z$t,z$U,!0);else{var z$b=z$G.createByJson(z$t,null,z$r,z$s,z$p);"Script"==z$t.type?z$b.hasOwnProperty("owner")?z$b.owner=z$U:z$b.hasOwnProperty("target")&&(z$b.target=z$U):"mask"==z$t.props.renderType?z$U.mask=z$b:z$U.addChild(z$b)}else z$U.itemRender=z$t}if(z$c)for(var z$S in z$c){var z$_=z$c[z$S];"var"===z$S&&z$r?z$r[z$_]=z$U:z$_ instanceof Array&&"function"==typeof z$U[z$S]?z$U[z$S].apply(z$U,z$_):z$U[z$S]=z$_}return z$s&&z$V.customProps&&z$s.runWith([z$U,z$V]),z$U.created&&z$U.created(),z$U},z$G.addGraphicsToSprite=function(z$V,z$U){var z$r;if((z$r=z$V.child)&&!(z$r.length<1)){var z$s;z$s=z$G._getGraphicsFromSprite(z$V,z$U);var z$p=0,z$c=0;z$V.props&&(z$p=z$G._getObjVar(z$V.props,"x",0),z$c=z$G._getObjVar(z$V.props,"y",0)),0!=z$p&&0!=z$c&&z$s.translate(z$p,z$c);var z$R,z$T=0;for(z$R=z$r.length,z$T=0;z$T<z$R;z$T++)z$G._addGraphicToGraphics(z$r[z$T],z$s);0!=z$p&&0!=z$c&&z$s.translate(-z$p,-z$c)}},z$G.addGraphicToSprite=function(z$V,z$U,z$r){var z$s;void 0===z$r&&(z$r=!1),z$s=z$r?z$G._getGraphicsFromSprite(z$V,z$U):z$U.graphics,z$G._addGraphicToGraphics(z$V,z$s)},z$G._getGraphicsFromSprite=function(z$V,z$U){var z$r,z$s;if(!z$V||!z$V.props)return z$U.graphics;switch(z$s=z$V.props.renderType){case"hit":case"unHit":var z$p;z$U.hitArea||(z$U.hitArea=new z$A),(z$p=z$U.hitArea)[z$s]||(z$p[z$s]=new z$_),z$r=z$p[z$s]}return z$r||(z$r=z$U.graphics),z$r},z$G._getTransformData=function(z$V){var z$U;(z$V.hasOwnProperty("pivotX")||z$V.hasOwnProperty("pivotY"))&&(z$U=z$U||new z$z).translate(-z$G._getObjVar(z$V,"pivotX",0),-z$G._getObjVar(z$V,"pivotY",0));var z$r=z$G._getObjVar(z$V,"scaleX",1),z$s=z$G._getObjVar(z$V,"scaleY",1),z$p=z$G._getObjVar(z$V,"rotation",0);z$G._getObjVar(z$V,"skewX",0),z$G._getObjVar(z$V,"skewY",0);return 1==z$r&&1==z$s&&0==z$p||((z$U=z$U||new z$z).scale(z$r,z$s),z$U.rotate(.0174532922222222*z$p)),z$U},z$G._addGraphicToGraphics=function(z$V,z$U){var z$r,z$s;if((z$r=z$V.props)&&(z$s=z$G.DrawTypeDic[z$V.type])){var z$p,z$c;z$p=z$U;var z$R=z$G._getParams(z$r,z$s[1],z$s[2],z$s[3]);((z$c=z$G._tM)||1!=z$G._alpha)&&(z$p.save(),z$c&&z$p.transform(z$c),1!=z$G._alpha&&z$p.alpha(z$G._alpha)),z$p[z$s[0]].apply(z$p,z$R),(z$c||1!=z$G._alpha)&&z$p.restore()}},z$G._adptLineData=function(z$V){return z$V[2]=parseFloat(z$V[0])+parseFloat(z$V[2]),z$V[3]=parseFloat(z$V[1])+parseFloat(z$V[3]),z$V},z$G._adptTextureData=function(z$V){return z$V[0]=z$TV.getRes(z$V[0]),z$V},z$G._adptLinesData=function(z$V){return z$V[2]=z$G._getPointListByStr(z$V[2]),z$V},z$G.isDrawType=function(z$V){return"Image"!=z$V&&z$G.DrawTypeDic.hasOwnProperty(z$V)},z$G._getParams=function(z$V,z$U,z$r,z$s){var z$p;void 0===z$r&&(z$r=0),(z$p=z$G._temParam).length=z$U.length;var z$c,z$R,z$T=0;for(z$c=z$U.length,z$T=0;z$T<z$c;z$T++)z$p[z$T]=z$G._getObjVar(z$V,z$U[z$T][0],z$U[z$T][1]);return z$G._alpha=z$G._getObjVar(z$V,"alpha",1),z$R=z$G._getTransformData(z$V),z$G._tM=z$R?(z$r||(z$r=0),z$R.translate(z$p[z$r],z$p[z$r+1]),z$p[z$r]=z$p[z$r+1]=0,z$R):null,z$s&&z$G[z$s]&&(z$p=z$G[z$s](z$p)),z$p},z$G._getPointListByStr=function(z$V){var z$U,z$r,z$s=0;for(z$r=(z$U=z$V.split(",")).length,z$s=0;z$s<z$r;z$s++)z$U[z$s]=parseFloat(z$U[z$s]);return z$U},z$G._getObjVar=function(z$V,z$U,z$r){return z$V.hasOwnProperty(z$U)?z$V[z$U]:z$r},z$G._temParam=[],z$G._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},z$G.getClass=function(z$V){var z$U=z$G._classMap[z$V]||z$V;return"string"==typeof z$U?z$y.__classmap[z$U]:z$U},z$G._tM=null,z$G._alpha=NaN,z$N(z$G,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),z$G}(),z$B=function(){function z$c(z$V){if(this._color=[],"string"==typeof z$V){null===(this.strColor=z$V)&&(z$V="#000000"),"#"==z$V.charAt(0)&&(z$V=z$V.substr(1));var z$U=z$V.length;if(3==z$U||4==z$U){for(var z$r="",z$s=0;z$s<z$U;z$s++)z$r+=z$V[z$s]+z$V[z$s];z$V=z$r}var z$p=this.numColor=parseInt(z$V,16);if(8==z$V.length)return void(this._color=[parseInt(z$V.substr(0,2),16)/255,((16711680&z$p)>>16)/255,((65280&z$p)>>8)/255,(255&z$p)/255])}else z$p=this.numColor=z$V,this.strColor=z$v.toHexColor(z$p);this._color=[((16711680&z$p)>>16)/255,((65280&z$p)>>8)/255,(255&z$p)/255,1],this._color.__id=++z$c._COLODID}return z$b(z$c,"laya.utils.Color"),z$c._initDefault=function(){for(var z$V in z$c._DEFAULT={},z$c._COLOR_MAP)z$c._SAVE[z$V]=z$c._DEFAULT[z$V]=new z$c(z$c._COLOR_MAP[z$V]);return z$c._DEFAULT},z$c._initSaveMap=function(){for(var z$V in z$c._SAVE_SIZE=0,z$c._SAVE={},z$c._DEFAULT)z$c._SAVE[z$V]=z$c._DEFAULT[z$V]},z$c.create=function(z$V){var z$U=z$c._SAVE[z$V+""];return null!=z$U?z$U:(z$c._SAVE_SIZE<1e3||z$c._initSaveMap(),z$c._SAVE[z$V+""]=new z$c(z$V))},z$c._SAVE={},z$c._SAVE_SIZE=0,z$c._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},z$c._DEFAULT=z$c._initDefault(),z$c._COLODID=1,z$c}(),z$P=(function(){function z$V(){this._values=[],this._keys=[]}z$b(z$V,"laya.utils.Dictionary");var z$U=z$V.prototype;z$U.set=function(z$V,z$U){var z$r=this.indexOf(z$V);0<=z$r?this._values[z$r]=z$U:(this._keys.push(z$V),this._values.push(z$U))},z$U.indexOf=function(z$V){var z$U=this._keys.indexOf(z$V);return 0<=z$U?z$U:(z$V="string"==typeof z$V?Number(z$V):"number"==typeof z$V?z$V.toString():z$V,this._keys.indexOf(z$V))},z$U.get=function(z$V){var z$U=this.indexOf(z$V);return z$U<0?null:this._values[z$U]},z$U.remove=function(z$V){var z$U=this.indexOf(z$V);return 0<=z$U&&(this._keys.splice(z$U,1),this._values.splice(z$U,1),!0)},z$U.clear=function(){this._values.length=0,this._keys.length=0},z$q(0,z$U,"values",function(){return this._values}),z$q(0,z$U,"keys",function(){return this._keys})}(),function(){function z$V(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}z$b(z$V,"laya.utils.Dragging");var z$U=z$V.prototype;return z$U.start=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){void 0===z$T&&(z$T=.92),this.clearTimer(),this.target=z$V,this.area=z$U,this.hasInertia=z$r,this.elasticDistance=z$U?z$s:0,this.elasticBackTime=z$p,this.data=z$c,this._disableMouseEvent=z$R,this.ratio=z$T,1!=z$V.globalScaleX||1!=z$V.globalScaleY?this._parent=z$V.parent:this._parent=z$y.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,z$y.stage.on("mouseup",this,this.onStageMouseUp),z$y.stage.on("mouseout",this,this.onStageMouseUp),z$y.timer.frameLoop(1,this,this.loop)},z$U.clearTimer=function(){z$y.timer.clear(this,this.loop),z$y.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},z$U.stop=function(){this._dragging&&(z$u.instance.disableMouseEvent=!1,z$y.stage.off("mouseup",this,this.onStageMouseUp),z$y.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},z$U.loop=function(){var z$V=this._parent.getMousePoint(),z$U=z$V.x,z$r=z$V.y,z$s=z$U-this._lastX,z$p=z$r-this._lastY;if(this._clickOnly){if(!(1<Math.abs(z$s*z$y.stage._canvasTransform.getScaleX())||1<Math.abs(z$p*z$y.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),z$u.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(z$s,z$p);0==z$s&&0==z$p||(this._lastX=z$U,this._lastY=z$r,this.target.x+=z$s*this._elasticRateX,this.target.y+=z$p*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},z$U.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var z$V=this.area.x-this.target.x;else z$V=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-z$V/this.elasticDistance),this.target.y<this.area.y)var z$U=this.area.y-this.target.y;else z$U=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-z$U/this.elasticDistance)}},z$U.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},z$U.onStageMouseUp=function(z$V){if(z$u.instance.disableMouseEvent=!1,z$y.stage.off("mouseup",this,this.onStageMouseUp),z$y.stage.off("mouseout",this,this.onStageMouseUp),z$y.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var z$U=this._offsets.length,z$r=Math.min(z$U,6),z$s=this._offsets.length-z$r,z$p=z$U-1;z$s<z$p;z$p--)this._offsetY+=this._offsets[z$p--],this._offsetX+=this._offsets[z$p];this._offsetX=this._offsetX/z$r*2,this._offsetY=this._offsetY/z$r*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),z$y.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},z$U.checkElastic=function(){var z$V=NaN,z$U=NaN;if(this.target.x<this.area.x?z$V=this.area.x:this.target.x>this.area.x+this.area.width&&(z$V=this.area.x+this.area.width),this.target.y<this.area.y?z$U=this.area.y:this.target.y>this.area.y+this.area.height&&(z$U=this.area.y+this.area.height),isNaN(z$V)&&isNaN(z$U))this.clear();else{var z$r={};isNaN(z$V)||(z$r.x=z$V),isNaN(z$U)||(z$r.y=z$U),this._tween=z$g.to(this.target,z$r,this.elasticBackTime,z$M.sineOut,z$W.create(this,this.clear),0,!1,!1)}},z$U.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(z$y.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},z$U.clear=function(){if(this.target){this.clearTimer();var z$V=this.target;this.target=null,this._parent=null,z$V.event("dragend",this.data)}},z$V}()),z$M=function(){function z$T(){}return z$b(z$T,"laya.utils.Ease"),z$T.linearNone=function(z$V,z$U,z$r,z$s){return z$r*z$V/z$s+z$U},z$T.linearIn=function(z$V,z$U,z$r,z$s){return z$r*z$V/z$s+z$U},z$T.linearInOut=function(z$V,z$U,z$r,z$s){return z$r*z$V/z$s+z$U},z$T.linearOut=function(z$V,z$U,z$r,z$s){return z$r*z$V/z$s+z$U},z$T.bounceIn=function(z$V,z$U,z$r,z$s){return z$r-z$T.bounceOut(z$s-z$V,0,z$r,z$s)+z$U},z$T.bounceInOut=function(z$V,z$U,z$r,z$s){return z$V<.5*z$s?.5*z$T.bounceIn(2*z$V,0,z$r,z$s)+z$U:.5*z$T.bounceOut(2*z$V-z$s,0,z$r,z$s)+.5*z$r+z$U},z$T.bounceOut=function(z$V,z$U,z$r,z$s){return(z$V/=z$s)<1/2.75?z$r*(7.5625*z$V*z$V)+z$U:z$V<2/2.75?z$r*(7.5625*(z$V-=1.5/2.75)*z$V+.75)+z$U:z$V<2.5/2.75?z$r*(7.5625*(z$V-=2.25/2.75)*z$V+.9375)+z$U:z$r*(7.5625*(z$V-=2.625/2.75)*z$V+.984375)+z$U},z$T.backIn=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=1.70158),z$r*(z$V/=z$s)*z$V*((z$p+1)*z$V-z$p)+z$U},z$T.backInOut=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=1.70158),(z$V/=.5*z$s)<1?.5*z$r*(z$V*z$V*((1+(z$p*=1.525))*z$V-z$p))+z$U:z$r/2*((z$V-=2)*z$V*((1+(z$p*=1.525))*z$V+z$p)+2)+z$U},z$T.backOut=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=1.70158),z$r*((z$V=z$V/z$s-1)*z$V*((z$p+1)*z$V+z$p)+1)+z$U},z$T.elasticIn=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R;return void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=0),0==z$V?z$U:1==(z$V/=z$s)?z$U+z$r:(z$c||(z$c=.3*z$s),z$R=!z$p||0<z$r&&z$p<z$r||z$r<0&&z$p<-z$r?(z$p=z$r,z$c/4):z$c/z$T.PI2*Math.asin(z$r/z$p),-z$p*Math.pow(2,10*(z$V-=1))*Math.sin((z$V*z$s-z$R)*z$T.PI2/z$c)+z$U)},z$T.elasticInOut=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R;return void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=0),0==z$V?z$U:2==(z$V/=.5*z$s)?z$U+z$r:(z$c||(z$c=z$s*(.3*1.5)),z$R=!z$p||0<z$r&&z$p<z$r||z$r<0&&z$p<-z$r?(z$p=z$r,z$c/4):z$c/z$T.PI2*Math.asin(z$r/z$p),z$V<1?z$p*Math.pow(2,10*(z$V-=1))*Math.sin((z$V*z$s-z$R)*z$T.PI2/z$c)*-.5+z$U:z$p*Math.pow(2,-10*(z$V-=1))*Math.sin((z$V*z$s-z$R)*z$T.PI2/z$c)*.5+z$r+z$U)},z$T.elasticOut=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R;return void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=0),0==z$V?z$U:1==(z$V/=z$s)?z$U+z$r:(z$c||(z$c=.3*z$s),z$R=!z$p||0<z$r&&z$p<z$r||z$r<0&&z$p<-z$r?(z$p=z$r,z$c/4):z$c/z$T.PI2*Math.asin(z$r/z$p),z$p*Math.pow(2,-10*z$V)*Math.sin((z$V*z$s-z$R)*z$T.PI2/z$c)+z$r+z$U)},z$T.strongIn=function(z$V,z$U,z$r,z$s){return z$r*(z$V/=z$s)*z$V*z$V*z$V*z$V+z$U},z$T.strongInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*z$r*z$V*z$V*z$V*z$V*z$V+z$U:.5*z$r*((z$V-=2)*z$V*z$V*z$V*z$V+2)+z$U},z$T.strongOut=function(z$V,z$U,z$r,z$s){return z$r*((z$V=z$V/z$s-1)*z$V*z$V*z$V*z$V+1)+z$U},z$T.sineInOut=function(z$V,z$U,z$r,z$s){return.5*-z$r*(Math.cos(Math.PI*z$V/z$s)-1)+z$U},z$T.sineIn=function(z$V,z$U,z$r,z$s){return-z$r*Math.cos(z$V/z$s*z$T.HALF_PI)+z$r+z$U},z$T.sineOut=function(z$V,z$U,z$r,z$s){return z$r*Math.sin(z$V/z$s*z$T.HALF_PI)+z$U},z$T.quintIn=function(z$V,z$U,z$r,z$s){return z$r*(z$V/=z$s)*z$V*z$V*z$V*z$V+z$U},z$T.quintInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*z$r*z$V*z$V*z$V*z$V*z$V+z$U:.5*z$r*((z$V-=2)*z$V*z$V*z$V*z$V+2)+z$U},z$T.quintOut=function(z$V,z$U,z$r,z$s){return z$r*((z$V=z$V/z$s-1)*z$V*z$V*z$V*z$V+1)+z$U},z$T.quartIn=function(z$V,z$U,z$r,z$s){return z$r*(z$V/=z$s)*z$V*z$V*z$V+z$U},z$T.quartInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*z$r*z$V*z$V*z$V*z$V+z$U:.5*-z$r*((z$V-=2)*z$V*z$V*z$V-2)+z$U},z$T.quartOut=function(z$V,z$U,z$r,z$s){return-z$r*((z$V=z$V/z$s-1)*z$V*z$V*z$V-1)+z$U},z$T.cubicIn=function(z$V,z$U,z$r,z$s){return z$r*(z$V/=z$s)*z$V*z$V+z$U},z$T.cubicInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*z$r*z$V*z$V*z$V+z$U:.5*z$r*((z$V-=2)*z$V*z$V+2)+z$U},z$T.cubicOut=function(z$V,z$U,z$r,z$s){return z$r*((z$V=z$V/z$s-1)*z$V*z$V+1)+z$U},z$T.quadIn=function(z$V,z$U,z$r,z$s){return z$r*(z$V/=z$s)*z$V+z$U},z$T.quadInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*z$r*z$V*z$V+z$U:.5*-z$r*(--z$V*(z$V-2)-1)+z$U},z$T.quadOut=function(z$V,z$U,z$r,z$s){return-z$r*(z$V/=z$s)*(z$V-2)+z$U},z$T.expoIn=function(z$V,z$U,z$r,z$s){return 0==z$V?z$U:z$r*Math.pow(2,10*(z$V/z$s-1))+z$U-.001*z$r},z$T.expoInOut=function(z$V,z$U,z$r,z$s){return 0==z$V?z$U:z$V==z$s?z$U+z$r:(z$V/=.5*z$s)<1?.5*z$r*Math.pow(2,10*(z$V-1))+z$U:.5*z$r*(2-Math.pow(2,-10*--z$V))+z$U},z$T.expoOut=function(z$V,z$U,z$r,z$s){return z$V==z$s?z$U+z$r:z$r*(1-Math.pow(2,-10*z$V/z$s))+z$U},z$T.circIn=function(z$V,z$U,z$r,z$s){return-z$r*(Math.sqrt(1-(z$V/=z$s)*z$V)-1)+z$U},z$T.circInOut=function(z$V,z$U,z$r,z$s){return(z$V/=.5*z$s)<1?.5*-z$r*(Math.sqrt(1-z$V*z$V)-1)+z$U:.5*z$r*(Math.sqrt(1-(z$V-=2)*z$V)+1)+z$U},z$T.circOut=function(z$V,z$U,z$r,z$s){return z$r*Math.sqrt(1-(z$V=z$V/z$s-1)*z$V)+z$U},z$T.HALF_PI=.5*Math.PI,z$T.PI2=2*Math.PI,z$T}(),z$A=function(){function z$S(){this._hit=null,this._unHit=null}z$b(z$S,"laya.utils.HitArea");var z$V=z$S.prototype;return z$V.isHit=function(z$V,z$U){return!!z$S.isHitGraphic(z$V,z$U,this.hit)&&!z$S.isHitGraphic(z$V,z$U,this.unHit)},z$V.contains=function(z$V,z$U){return this.isHit(z$V,z$U)},z$q(0,z$V,"hit",function(){return this._hit||(this._hit=new z$_),this._hit},function(z$V){this._hit=z$V}),z$q(0,z$V,"unHit",function(){return this._unHit||(this._unHit=new z$_),this._unHit},function(z$V){this._unHit=z$V}),z$S.isHitGraphic=function(z$V,z$U,z$r){if(!z$r)return!1;var z$s;if(!(z$s=z$r.cmds)&&z$r._one&&((z$s=z$S._cmds).length=1,z$s[0]=z$r._one),!z$s)return!1;var z$p,z$c,z$R=0;for(z$p=z$s.length,z$R=0;z$R<z$p;z$R++)if(z$c=z$s[z$R]){var z$T=z$m._context;switch(z$c.callee){case z$T._translate:case 6:z$V-=z$c[0],z$U-=z$c[1]}if(z$S.isHitCmd(z$V,z$U,z$c))return!0}return!1},z$S.isHitCmd=function(z$V,z$U,z$r){if(!z$r)return!1;var z$s=z$m._context,z$p=!1;switch(z$r.callee){case z$s._drawRect:case 13:z$S._rec.setTo(z$r[0],z$r[1],z$r[2],z$r[3]),z$p=z$S._rec.contains(z$V,z$U);break;case z$s._drawCircle:case z$s._fillCircle:case 14:z$p=(z$V-=z$r[0])*z$V+(z$U-=z$r[1])*z$U<z$r[2]*z$r[2];break;case z$s._drawPoly:case 18:z$V-=z$r[0],z$U-=z$r[1],z$p=z$S.ptInPolygon(z$V,z$U,z$r[2])}return z$p},z$S.ptInPolygon=function(z$V,z$U,z$r){var z$s;(z$s=z$S._ptPoint).setTo(z$V,z$U);var z$p,z$c=0,z$R=NaN,z$T=NaN,z$N=NaN,z$t=NaN;z$p=z$r.length;for(var z$b=0;z$b<z$p;z$b+=2){if(z$R=z$r[z$b],z$T=z$r[z$b+1],z$N=z$r[(z$b+2)%z$p],z$T!=(z$t=z$r[(z$b+3)%z$p]))if(!(z$s.y<Math.min(z$T,z$t)))if(!(z$s.y>=Math.max(z$T,z$t)))(z$s.y-z$T)*(z$N-z$R)/(z$t-z$T)+z$R>z$s.x&&z$c++}return z$c%2==1},z$S._cmds=[],z$N(z$S,["_rec",function(){return this._rec=new z$n},"_ptPoint",function(){return this._ptPoint=new z$D}]),z$S}(),z$X=(function(){function z$p(z$V,z$U,z$r,z$s){this.char=z$V,this.charNum=z$V.charCodeAt(0),this._x=this._y=0,this.width=z$U,this.height=z$r,this.style=z$s,this.isWord=!z$p._isWordRegExp.test(z$V)}z$b(z$p,"laya.utils.HTMLChar");var z$V=z$p.prototype;z$y.imps(z$V,{"laya.display.ILayout":!0}),z$V.setSprite=function(z$V){this._sprite=z$V},z$V.getSprite=function(){return this._sprite},z$V._isChar=function(){return!0},z$V._getCSSStyle=function(){return this.style},z$q(0,z$V,"width",function(){return this._w},function(z$V){this._w=z$V}),z$q(0,z$V,"x",function(){return this._x},function(z$V){this._sprite&&(this._sprite.x=z$V),this._x=z$V}),z$q(0,z$V,"y",function(){return this._y},function(z$V){this._sprite&&(this._sprite.y=z$V),this._y=z$V}),z$q(0,z$V,"height",function(){return this._h},function(z$V){this._h=z$V}),z$p._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function z$U(){}z$b(z$U,"laya.utils.Log"),z$U.enable=function(){z$U._logdiv||(z$U._logdiv=z$j.window.document.createElement("div"),z$j.window.document.body.appendChild(z$U._logdiv),z$U._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},z$U.toggle=function(){var z$V=z$U._logdiv.style;"1px"==z$V.width?z$V.width=z$V.height="50%":z$V.width=z$V.height="1px"},z$U.print=function(z$V){z$U._logdiv&&(z$U.maxCount<=z$U._count&&z$U.clear(),z$U._count++,z$U._logdiv.innerText+=z$V+"\n",z$U._logdiv.scrollTop=z$U._logdiv.scrollHeight)},z$U.clear=function(){z$U._logdiv.innerText="",z$U._count=0},z$U._logdiv=null,z$U._count=0,z$U.maxCount=20}(),function(){function z$U(){}z$b(z$U,"laya.utils.Mouse"),z$q(1,z$U,"cursor",function(){return z$U._style.cursor},function(z$V){z$U._style.cursor=z$V}),z$U.hide=function(){"none"!=z$U.cursor&&(z$U._preCursor=z$U.cursor,z$U.cursor="none")},z$U.show=function(){"none"==z$U.cursor&&(z$U.cursor=z$U._preCursor?z$U._preCursor:"auto")},z$U._preCursor=null,z$N(z$U,["_style",function(){return this._style=z$j.document.body.style}])}(),function(){function z$c(){}return z$b(z$c,"laya.utils.Pool"),z$c.getPoolBySign=function(z$V){return z$c._poolDic[z$V]||(z$c._poolDic[z$V]=[])},z$c.clearBySign=function(z$V){z$c._poolDic[z$V]&&(z$c._poolDic[z$V].length=0)},z$c.recover=function(z$V,z$U){z$U.__InPool||(z$U.__InPool=!0,z$c.getPoolBySign(z$V).push(z$U))},z$c.getItemByClass=function(z$V,z$U){var z$r=z$c.getPoolBySign(z$V),z$s=z$r.length?z$r.pop():new z$U;return z$s.__InPool=!1,z$s},z$c.getItemByCreateFun=function(z$V,z$U,z$r){var z$s=z$c.getPoolBySign(z$V),z$p=z$s.length?z$s.pop():z$U.call(z$r);return z$p.__InPool=!1,z$p},z$c.getItem=function(z$V){var z$U=z$c.getPoolBySign(z$V),z$r=z$U.length?z$U.pop():null;return z$r&&(z$r.__InPool=!1),z$r},z$c._poolDic={},z$c.InPoolSign="__InPool",z$c}()),z$e=function(){function z$N(){}return z$b(z$N,"laya.utils.Stat"),z$q(1,z$N,"onclick",null,function(z$V){z$N._sp&&z$N._sp.on("click",z$N._sp,z$V),z$N._canvas&&(z$N._canvas.source.onclick=z$V,z$N._canvas.source.style.pointerEvents="")}),z$N.show=function(z$V,z$U,z$r){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),!z$m.isConchApp||z$m.isConchWebGL){if(z$m.isConchWebGL||z$j.onMiniGame||z$j.onLimixiu||(z$N._useCanvas=!0),z$N._show=!0,z$N._fpsData.length=60,z$N._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},z$N._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},z$N._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},z$N._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},z$m.isWebGL)if(z$N._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},z$m.is3DMode){if(z$N._view[0].title="FPS(3D)",z$N._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},z$N._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},z$N._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==z$r){var z$s=8;z$N._view[z$s++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},z$N._view[z$s++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},z$N._view[z$s++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==z$r){z$s=8;z$N._view[z$s++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},z$N._view[z$s++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else z$N._view[0].title="FPS(WebGL)",z$N._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else z$N._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};z$N._useCanvas?z$N.createUIPre(z$V,z$U):z$N.createUI(z$V,z$U),z$N.enable()}else z$j.window.conch.showFPS&&z$j.window.conch.showFPS(z$V,z$U)},z$N.createUIPre=function(z$V,z$U){var z$r=z$j.pixelRatio;z$N._width=170*z$r,z$N._vx=75*z$r,z$N._height=z$r*(12*z$N._view.length+3*z$r)+4,z$N._fontSize=12*z$r;for(var z$s=0;z$s<z$N._view.length;z$s++)z$N._view[z$s].x=4,z$N._view[z$s].y=z$s*z$N._fontSize+2*z$r;z$N._canvas||((z$N._canvas=new z$OV("2D")).size(z$N._width,z$N._height),(z$N._ctx=z$N._canvas.getContext("2d")).textBaseline="top",z$N._ctx.font=z$N._fontSize+"px Sans-serif",z$N._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+z$V+"px;top:"+z$U+"px;width:"+z$N._width/z$r+"px;height:"+z$N._height/z$r+"px;"),z$N._first=!0,z$N.loop(),z$N._first=!1,z$j.container.appendChild(z$N._canvas.source)},z$N.createUI=function(z$V,z$U){var z$r=z$N._sp,z$s=z$j.pixelRatio;z$r||(z$r=new z$SV,(z$N._leftText=new z$hV).pos(5,5),z$N._leftText.color="#ffffff",z$r.addChild(z$N._leftText),(z$N._txt=new z$hV).pos(80*z$s,5),z$N._txt.color="#ffffff",z$r.addChild(z$N._txt),z$N._sp=z$r),z$r.pos(z$V,z$U);for(var z$p="",z$c=0;z$c<z$N._view.length;z$c++){z$p+=z$N._view[z$c].title+"\n"}z$N._leftText.text=z$p;var z$R=170*z$s,z$T=z$s*(12*z$N._view.length+3*z$s)+4;z$N._txt.fontSize=z$N._fontSize*z$s,z$N._leftText.fontSize=z$N._fontSize*z$s,z$r.size(z$R,z$T),z$r.graphics.clear(),z$r.graphics.setAlpha(.5),z$r.graphics.drawRect(0,0,z$R,z$T,"#999999"),z$r.graphics.setAlpha(1),z$N.loop()},z$N.enable=function(){z$y.timer.frameLoop(1,z$N,z$N.loop)},z$N.hide=function(){z$N._show=!1,z$y.timer.clear(z$N,z$N.loop),z$N._canvas&&z$j.removeElement(z$N._canvas.source)},z$N.clear=function(){z$N.trianglesFaces=z$N.drawCall=z$N.shaderCall=z$N.spriteCount=z$N.spriteRenderUseCacheCount=z$N.treeNodeCollision=z$N.treeSpriteCollision=z$N.canvasNormal=z$N.canvasBitmap=z$N.canvasReCache=0},z$N.loop=function(){z$N._count++;var z$V=z$j.now();if(!(z$V-z$N._timer<1e3)){var z$U=z$N._count;if(z$N.FPS=Math.round(1e3*z$U/(z$V-z$N._timer)),z$N._show){z$N.trianglesFaces=Math.round(z$N.trianglesFaces/z$U),z$N.spriteCount=z$N._useCanvas?(z$N.drawCall=Math.round(z$N.drawCall/z$U)-2,z$N.shaderCall=Math.round(z$N.shaderCall/z$U),Math.round(z$N.spriteCount/z$U)-1):(z$N.drawCall=Math.round(z$N.drawCall/z$U)-2,z$N.shaderCall=Math.round(z$N.shaderCall/z$U)-4,Math.round(z$N.spriteCount/z$U)-4),z$N.spriteRenderUseCacheCount=Math.round(z$N.spriteRenderUseCacheCount/z$U),z$N.canvasNormal=Math.round(z$N.canvasNormal/z$U),z$N.canvasBitmap=Math.round(z$N.canvasBitmap/z$U),z$N.canvasReCache=Math.ceil(z$N.canvasReCache/z$U),z$N.treeNodeCollision=Math.round(z$N.treeNodeCollision/z$U),z$N.treeSpriteCollision=Math.round(z$N.treeSpriteCollision/z$U);var z$r=0<z$N.FPS?Math.floor(1e3/z$N.FPS).toString():" ";z$N._fpsStr=z$N.FPS+(z$N.renderSlow?" slow":"")+" "+z$r,z$N._spriteStr=z$N.spriteCount+(z$N.spriteRenderUseCacheCount?"/"+z$N.spriteRenderUseCacheCount:""),z$N._canvasStr=z$N.canvasReCache+"/"+z$N.canvasNormal+"/"+z$N.canvasBitmap,z$N.currentMemorySize=z$$.systemResourceManager.memorySize,z$N._useCanvas?z$N.renderInfoPre():z$N.renderInfo(),z$N.clear()}z$N._count=0,z$N._timer=z$V}},z$N.renderInfoPre=function(){if(z$N._canvas){var z$V=z$N._ctx;z$V.clearRect(z$N._first?0:z$N._vx,0,z$N._width,z$N._height);for(var z$U=z$m.WebGL.mainContext,z$r=0;z$r<z$N._view.length;z$r++){var z$s=z$N._view[z$r];z$N._first&&(z$V.fillStyle="white",z$V.fillText(z$s.title,z$s.x,z$s.y,null,null,null)),z$V.fillStyle=z$s.color;var z$p=-1;if((z$s=z$N._view[z$r]).varying){if(z$U)switch(z$s.varying){case 1:z$p=z$U.getParameter(z$U[z$s.value]);break;case 2:z$p=z$U.getExtension(z$s.value)}}else z$p=z$N[z$s.value];"M"==z$s.units&&(z$p=Math.floor(z$p/1048576*100)/100+" M"),"K"==z$s.units&&(z$p=Math.floor(z$p/1024*100)/100+" K"),"string"==z$s.units&&(z$p=z$p.match(/\d+\.?\d/i)),z$V.fillText(z$p+"",z$s.x+z$N._vx,z$s.y,null,null,null)}}},z$N.renderInfo=function(){for(var z$V="",z$U=z$m.WebGL.mainContext,z$r=0;z$r<z$N._view.length;z$r++){var z$s=z$N._view[z$r],z$p=-1;if(z$s.varying){if(z$U)switch(z$s.varying){case 1:z$p=z$U.getParameter(z$U[z$s.value]);break;case 2:z$p=z$U.getExtension(z$s.value)}}else z$p=z$N[z$s.value];"M"==z$s.units&&(z$p=Math.floor(z$p/1048576*100)/100+" M"),"K"==z$s.units&&(z$p=Math.floor(z$p/1024*100)/100+" K"),"string"==z$s.units&&(z$p=z$p.match(/\d+\.?\d/i)),z$V+=z$p+"\n"}z$N._txt.text=z$V},z$N.FPS=0,z$N.loopCount=0,z$N.shaderCall=0,z$N.drawCall=0,z$N.trianglesFaces=0,z$N.spriteCount=0,z$N.spriteRenderUseCacheCount=0,z$N.treeNodeCollision=0,z$N.treeSpriteCollision=0,z$N.canvasNormal=0,z$N.canvasBitmap=0,z$N.canvasReCache=0,z$N.renderSlow=!1,z$N.currentMemorySize=0,z$N._fpsStr=null,z$N._canvasStr=null,z$N._spriteStr=null,z$N._fpsData=[],z$N._timer=0,z$N._count=0,z$N._view=[],z$N._fontSize=12,z$N._txt=null,z$N._leftText=null,z$N._sp=null,z$N._show=!1,z$N._useCanvas=!1,z$N._canvas=null,z$N._ctx=null,z$N._first=!1,z$N._vx=NaN,z$N._width=0,z$N._height=100,z$N}(),z$F=(function(){function z$V(){this._strsToID={},this._idToStrs=[],this._length=0}z$b(z$V,"laya.utils.StringKey");var z$U=z$V.prototype;z$U.add=function(z$V){var z$U=this._strsToID[z$V];return null!=z$U?z$U:(this._idToStrs[this._length]=z$V,this._strsToID[z$V]=this._length++)},z$U.getID=function(z$V){var z$U=this._strsToID[z$V];return null==z$U?-1:z$U},z$U.getName=function(z$V){var z$U=this._idToStrs[z$V];return null==z$U?void 0:z$U}}(),function(){var z$t;function z$V(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}z$b(z$V,"laya.utils.Timer");var z$U=z$V.prototype;return z$U._init=function(){z$y.timer&&z$y.timer.frameLoop(1,this,this._update)},z$U._now=function(){return Date.now()},z$U._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var z$V=this.currFrame=this.currFrame+this.scale,z$U=this._now();this._delta=(z$U-this._lastTimer)*this.scale;var z$r=this.currTimer=this.currTimer+this._delta;z$y.isDebug&&6e4<Math.abs(z$U-this._lastTimer)&&console.error("系统时间错误！"+(z$U-this._lastTimer)),this._lastTimer=z$U;var z$s=this._handlers;for(z$R=this._count=0,z$T=z$s.length;z$R<z$T;z$R++)if(null!==(z$N=z$s[z$R]).method){var z$p=z$N.userFrame?z$V:z$r;if(z$p>=z$N.exeTime)if(z$N.repeat)if(z$N.jumpFrame)for(;z$p>=z$N.exeTime;)z$N.exeTime+=z$N.delay,z$N.run(!1);else z$N.exeTime+=z$N.delay,z$N.run(!1),z$p>z$N.exeTime&&(z$N.exeTime+=Math.ceil((z$p-z$N.exeTime)/z$N.delay)*z$N.delay);else z$N.run(!0)}else this._count++;(30<this._count||z$V%200==0)&&this._clearHandlers();for(var z$c=this._laters,z$R=0,z$T=z$c.length-1;z$R<=z$T;z$R++){var z$N=z$c[z$R];this._isIgnoreRecover(z$N)||(null!==z$N.method&&(delete this._map[z$N.key],z$N.run(!1)),this._recoverHandler(z$N)),z$R===z$T&&(z$T=z$c.length-1)}z$c.length=0}},z$U._clearHandlers=function(){for(var z$V=this._handlers,z$U=0,z$r=z$V.length;z$U<z$r;z$U++){var z$s=z$V[z$U];null!==z$s.method?this._temp.push(z$s):this._isIgnoreRecover(z$s)?this._temp.push(z$s):this._recoverHandler(z$s)}this._handlers=this._temp,this._temp=z$V,this._temp.length=0},z$U._recoverHandler=function(z$V){this._map[z$V.key]==z$V&&delete this._map[z$V.key],z$V.recover()},z$U._create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){if(!z$r)return z$p.apply(z$s,z$c),null;if(z$R){var z$N=this._getHandler(z$s,z$p);if(z$N)return z$N.repeat=z$U,z$N.userFrame=z$V,z$N.delay=z$r,z$N.ignoreRecover=z$T,z$N.caller=z$s,z$N.method=z$p,z$N.args=z$c,z$N.exeTime=z$r+(z$V?this.currFrame:this.currTimer+this._now()-this._lastTimer),z$N}return(z$N=z$t.create()).repeat=z$U,z$N.userFrame=z$V,z$N.delay=z$r,z$N.ignoreRecover=z$T,z$N.caller=z$s,z$N.method=z$p,z$N.args=z$c,z$N.exeTime=z$r+(z$V?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(z$N),this._handlers.push(z$N),z$N},z$U._indexHandler=function(z$V){var z$U=z$V.caller,z$r=z$V.method,z$s=z$U?z$U.$_GID||(z$U.$_GID=z$v.getGID()):0,z$p=z$r.$_TID||(z$r.$_TID=this._mid++);z$V.key=z$s+"_"+z$p,this._map[z$V.key]=z$V},z$U.once=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=!0),this._create(!1,!1,z$V,z$U,z$r,z$s,z$p,!1)},z$U.loop=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){void 0===z$p&&(z$p=!0),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!1);var z$T=this._create(!1,!0,z$V,z$U,z$r,z$s,z$p,z$R);z$T&&(z$T.jumpFrame=z$c)},z$U.frameOnce=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=!0),this._create(!0,!1,z$V,z$U,z$r,z$s,z$p,!1)},z$U.frameLoop=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$p&&(z$p=!0),void 0===z$c&&(z$c=!1),this._create(!0,!0,z$V,z$U,z$r,z$s,z$p,z$c)},z$U.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+z$t._freeCount},z$U.clear=function(z$V,z$U){var z$r=this._getHandler(z$V,z$U);return!(!z$r||this._isIgnoreRecover(z$r))&&(delete this._map[z$r.key],z$r.key=null,z$r.clear(),!0)},z$U.clearAll=function(z$V){if(z$V)for(var z$U=0,z$r=this._handlers.length;z$U<z$r;z$U++){var z$s=this._handlers[z$U];z$s.caller===z$V&&(this._isIgnoreRecover(z$s)||(delete this._map[z$s.key],z$s.key=null,z$s.clear()))}},z$U._getHandler=function(z$V,z$U){var z$r=z$V?z$V.$_GID||(z$V.$_GID=z$v.getGID()):0,z$s=z$U.$_TID||(z$U.$_TID=this._mid++);return this._map[z$r+"_"+z$s]},z$U._isIgnoreRecover=function(z$V){if(z$V.ignoreRecover||z$V.caller&&"IgnoreRecover"==z$V.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var z$U="";try{arguments.propertyIsEnumerable.caller}catch(z$V){z$U=z$V.stack}z$y.recordError("报错：核心定时器销毁忽略  "+z$U)}return!0}return!1},z$U.hasHandler=function(z$V,z$U){return this._map[z$V.$_GID+"_"+z$U.$_TID]},z$U.callLater=function(z$V,z$U,z$r){if(null==this._getHandler(z$V,z$U)){var z$s=z$t.create();z$s.caller=z$V,z$s.method=z$U,z$s.args=z$r,this._indexHandler(z$s),this._laters.push(z$s)}},z$U.runCallLater=function(z$V,z$U){var z$r=this._getHandler(z$V,z$U);z$r&&null!=z$r.method&&(this._isIgnoreRecover(z$r)||(delete this._map[z$r.key],z$r.run(!0)))},z$U.runTimer=function(z$V,z$U){this.runCallLater(z$V,z$U)},z$q(0,z$U,"delta",function(){return this._delta}),z$V.__init$=function(){z$t=function(){function z$U(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}z$b(z$U,"");var z$V=z$U.prototype;return z$V.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},z$V.recover=function(){this.clear(),this.args=z$U._freeHandler,z$U._freeHandler=this,z$U._freeCount++},z$V.run=function(z$V){var z$U=this.caller;if(z$U&&z$U.destroyed)return this.clear();var z$r=this.method,z$s=this.args;z$V&&this.clear(),null!=z$r&&(z$s?z$r.apply(z$U,z$s):z$r.call(z$U))},z$U._freeHandler=null,z$U._freeCount=0,z$U.create=function(){var z$V=z$U._freeHandler;return z$V?(z$U._freeHandler=z$V.args,--z$U._freeCount,z$V.args=null,z$V):new z$U},z$U}()},z$V}()),z$g=function(){function z$S(){this.gid=0}z$b(z$S,"laya.utils.Tween");var z$V=z$S.prototype;return z$V.to=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){return void 0===z$c&&(z$c=0),void 0===z$R&&(z$R=!1),this._create(z$V,z$U,z$r,z$s,z$p,z$c,z$R,!0,!1,!0)},z$V.from=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){return void 0===z$c&&(z$c=0),void 0===z$R&&(z$R=!1),this._create(z$V,z$U,z$r,z$s,z$p,z$c,z$R,!1,!1,!0)},z$V._create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){if(!z$V)throw new Error("Tween:target is null");this._target=z$V,this._duration=z$r,this._ease=z$s||z$U.ease||z$S.easeNone,this._complete=z$p||z$U.complete,this._delay=z$c,this._props=[],this._usedTimer=0,this._startTimer=z$j.now(),this._usedPool=z$N,this._delayParam=null,this.update=z$U.update;var z$b=z$V.$_GID||(z$V.$_GID=z$v.getGID());return z$S.tweenMap[z$b]?(z$R&&z$S.clearTween(z$V),z$S.tweenMap[z$b].push(this)):z$S.tweenMap[z$b]=[this],z$t?z$c<=0?this.firstStart(z$V,z$U,z$T):(this._delayParam=[z$V,z$U,z$T],z$y.scaleTimer.once(z$c,this,this.firstStart,this._delayParam)):this._initProps(z$V,z$U,z$T),this},z$V.firstStart=function(z$V,z$U,z$r){this._delayParam=null,z$V.destroyed?this.clear():(this._initProps(z$V,z$U,z$r),this._beginLoop())},z$V._initProps=function(z$V,z$U,z$r){for(var z$s in z$U)if("number"==typeof z$V[z$s]){var z$p=z$r?z$V[z$s]:z$U[z$s],z$c=z$r?z$U[z$s]:z$V[z$s];this._props.push([z$s,z$p,z$c-z$p]),z$r||(z$V[z$s]=z$p)}},z$V._beginLoop=function(){z$y.scaleTimer.frameLoop(1,this,this._doEase)},z$V._doEase=function(){this._updateEase(z$j.now())},z$V._updateEase=function(z$V){var z$U=this._target;if(z$U){if(z$U.destroyed)return z$S.clearTween(z$U);var z$r=this._usedTimer=z$V-this._startTimer-this._delay;if(!(z$r<0)){if(z$r>=this._duration)return this.complete();for(var z$s=0<z$r?this._ease(z$r,0,1,this._duration):0,z$p=this._props,z$c=0,z$R=z$p.length;z$c<z$R;z$c++){var z$T=z$p[z$c];z$U[z$T[0]]=z$T[1]+z$s*z$T[2]}this.update&&this.update.run()}}},z$V.complete=function(){if(this._target){z$y.scaleTimer.runTimer(this,this.firstStart);for(var z$V=this._target,z$U=this._props,z$r=this._complete,z$s=0,z$p=z$U.length;z$s<z$p;z$s++){var z$c=z$U[z$s];z$V[z$c[0]]=z$c[1]+z$c[2]}this.update&&this.update.run(),this.clear(),z$r&&z$r.run()}},z$V.pause=function(){z$y.scaleTimer.clear(this,this._beginLoop),z$y.scaleTimer.clear(this,this._doEase),z$y.scaleTimer.clear(this,this.firstStart);var z$V;(z$V=z$j.now()-this._startTimer-this._delay)<0&&(this._usedTimer=z$V)},z$V.setStartTime=function(z$V){this._startTimer=z$V},z$V.clear=function(){this._target&&(this._remove(),this._clear())},z$V._clear=function(){this.pause(),z$y.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,z$X.recover("tween",this))},z$V.recover=function(){this._usedPool=!0,this._clear()},z$V._remove=function(){var z$V=z$S.tweenMap[this._target.$_GID];if(z$V)for(var z$U=0,z$r=z$V.length;z$U<z$r;z$U++)if(z$V[z$U]===this){z$V.splice(z$U,1);break}},z$V.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=z$j.now(),this._delayParam)z$y.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var z$V=this._props,z$U=0,z$r=z$V.length;z$U<z$r;z$U++){var z$s=z$V[z$U];this._target[z$s[0]]=z$s[1]}z$y.scaleTimer.once(this._delay,this,this._beginLoop)}},z$V.resume=function(){this._usedTimer>=this._duration||(this._startTimer=z$j.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?z$y.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},z$q(0,z$V,"progress",null,function(z$V){var z$U=z$V*this._duration;this._startTimer=z$j.now()-this._delay-z$U}),z$S.to=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){return void 0===z$c&&(z$c=0),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=!0),z$X.getItemByClass("tween",z$S)._create(z$V,z$U,z$r,z$s,z$p,z$c,z$R,!0,z$T,!0)},z$S.from=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){return void 0===z$c&&(z$c=0),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=!0),z$X.getItemByClass("tween",z$S)._create(z$V,z$U,z$r,z$s,z$p,z$c,z$R,!1,z$T,!0)},z$S.clearAll=function(z$V){if(z$V&&z$V.$_GID){var z$U=z$S.tweenMap[z$V.$_GID];if(z$U){for(var z$r=0,z$s=z$U.length;z$r<z$s;z$r++)z$U[z$r]._clear();z$U.length=0}}},z$S.clear=function(z$V){z$V.clear()},z$S.clearTween=function(z$V){z$S.clearAll(z$V)},z$S.easeNone=function(z$V,z$U,z$r,z$s){return z$r*z$V/z$s+z$U},z$S.tweenMap={},z$S}(),z$v=function(){function z$T(){}return z$b(z$T,"laya.utils.Utils"),z$T.toRadian=function(z$V){return z$V*z$T._pi2},z$T.toAngle=function(z$V){return z$V*z$T._pi},z$T.toHexColor=function(z$V){if(z$V<0||isNaN(z$V))return null;for(var z$U=z$V.toString(16);z$U.length<6;)z$U="0"+z$U;return"#"+z$U},z$T.getGID=function(){return z$T._gid++},z$T.concatArray=function(z$V,z$U){if(!z$U)return z$V;if(!z$V)return z$U;var z$r=0,z$s=z$U.length;for(z$r=0;z$r<z$s;z$r++)z$V.push(z$U[z$r]);return z$V},z$T.clearArray=function(z$V){return z$V&&(z$V.length=0),z$V},z$T.copyArray=function(z$V,z$U){if(z$V||(z$V=[]),!z$U)return z$V;z$V.length=z$U.length;var z$r=0,z$s=z$U.length;for(z$r=0;z$r<z$s;z$r++)z$V[z$r]=z$U[z$r];return z$V},z$T.getGlobalRecByPoints=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R;return z$c=new z$D(z$U,z$r),z$c=z$V.localToGlobal(z$c),z$R=new z$D(z$s,z$p),z$R=z$V.localToGlobal(z$R),z$n._getWrapRec([z$c.x,z$c.y,z$R.x,z$R.y])},z$T.getGlobalPosAndScale=function(z$V){return z$T.getGlobalRecByPoints(z$V,0,0,1,1)},z$T.bind=function(z$V,z$U){return z$V.bind(z$U)},z$T.measureText=function(z$V,z$U){return z$w.measureText(z$V,z$U)},z$T.contextMeasureText=function(z$V){var z$U=z$j.context.measureText(z$V);return z$U||(z$U={width:16,height:16}),z$U},z$T.updateOrder=function(z$V){if(!z$V||z$V.length<2)return!1;for(var z$U,z$r=1,z$s=0,z$p=z$V.length,z$c=NaN;z$r<z$p;){for(z$U=z$V[z$s=z$r],z$c=z$V[z$s]._zOrder;-1<--z$s&&z$V[z$s]._zOrder>z$c;)z$V[z$s+1]=z$V[z$s];z$V[z$s+1]=z$U,z$r++}var z$R=z$U.parent.conchModel;if(z$R)if(null!=z$R.updateZOrder)z$R.updateZOrder();else{for(z$r=0;z$r<z$p;z$r++)z$R.removeChild(z$V[z$r].conchModel);for(z$r=0;z$r<z$p;z$r++)z$R.addChildAt(z$V[z$r].conchModel,z$r)}return!0},z$T.transPointList=function(z$V,z$U,z$r){var z$s=0,z$p=z$V.length;for(z$s=0;z$s<z$p;z$s+=2)z$V[z$s]+=z$U,z$V[z$s+1]+=z$r},z$T.parseInt=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r=z$j.window.parseInt(z$V,z$U);return isNaN(z$r)?0:z$r},z$T.getFileExtension=function(z$V){z$T._extReg.lastIndex=z$V.lastIndexOf(".");var z$U=z$T._extReg.exec(z$V);return z$U&&1<z$U.length?z$U[1].toLowerCase():null},z$T.getTransformRelativeToWindow=function(z$V,z$U,z$r){var z$s=z$y.stage,z$p=laya.utils.Utils.getGlobalPosAndScale(z$V),z$c=z$s._canvasTransform.clone(),z$R=z$c.tx,z$T=z$c.ty;z$c.rotate(-Math.PI/180*z$y.stage.canvasDegree),z$c.scale(z$y.stage.clientScaleX,z$y.stage.clientScaleY);var z$N=z$y.stage.canvasDegree%180!=0,z$t=NaN,z$b=NaN;z$N?(z$t=z$r+z$p.y,z$b=z$U+z$p.x,z$t*=z$c.d,z$b*=z$c.a,90==z$y.stage.canvasDegree?(z$t=z$R-z$t,z$b+=z$T):(z$t+=z$R,z$b=z$T-z$b)):(z$t=z$U+z$p.x,z$b=z$r+z$p.y,z$t*=z$c.a,z$b*=z$c.d,z$t+=z$R,z$b+=z$T);var z$S=NaN,z$_=NaN;return z$_=z$N?(z$S=z$c.d*z$p.height,z$c.a*z$p.width):(z$S=z$c.a*z$p.width,z$c.d*z$p.height),{x:z$t,y:z$b,scaleX:z$S,scaleY:z$_}},z$T.fitDOMElementInArea=function(z$V,z$U,z$r,z$s,z$p,z$c){z$V._fitLayaAirInitialized||(z$V._fitLayaAirInitialized=!0,z$V.style.transformOrigin=z$V.style.webKittransformOrigin="left top",z$V.style.position="absolute");var z$R=z$T.getTransformRelativeToWindow(z$U,z$r,z$s);z$V.style.transform=z$V.style.webkitTransform="scale("+z$R.scaleX+","+z$R.scaleY+") rotate("+z$y.stage.canvasDegree+"deg)",z$V.style.width=z$p+"px",z$V.style.height=z$c+"px",z$V.style.left=z$R.x+"px",z$V.style.top=z$R.y+"px"},z$T.isOkTextureList=function(z$V){if(!z$V)return!1;var z$U,z$r=0,z$s=z$V.length;for(z$r=0;z$r<z$s;z$r++)if(!(z$U=z$V[z$r])||!z$U.source)return!1;return!0},z$T.isOKCmdList=function(z$V){if(!z$V)return!1;var z$U,z$r,z$s=0,z$p=z$V.length,z$c=z$m._context;for(z$s=0;z$s<z$p;z$s++)switch((z$U=z$V[z$s]).callee){case z$c._drawTexture:case z$c._fillTexture:case z$c._drawTextureWithTransform:if(!(z$r=z$U[0])||!z$r.source)return!1}return!0},z$T._gid=1,z$T._pi=180/Math.PI,z$T._pi2=Math.PI/180,z$T._extReg=/\.(\w+)\??/g,z$T.parseXMLFromString=function(z$V){var z$U;if(z$V=z$V.replace(/>\s+</g,"><"),-1<(z$U=(new DOMParser).parseFromString(z$V,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(z$U.firstChild.firstChild.textContent);return z$U},z$T}(),z$Y=function(){function z$V(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],z$m.isWebGL&&z$J.regCacheByFunction(z$v.bind(this.startDispose,this),z$v.bind(this.getCacheList,this))}z$b(z$V,"laya.utils.VectorGraphManager");var z$U=z$V.prototype;return z$U.getId=function(){return this._id++},z$U.addShape=function(z$V,z$U){this.shapeDic[z$V]=z$U,this.useDic[z$V]||(this.useDic[z$V]=!0)},z$U.addLine=function(z$V,z$U){this.shapeLineDic[z$V]=z$U,this.shapeLineDic[z$V]||(this.shapeLineDic[z$V]=!0)},z$U.getShape=function(z$V){this._checkKey&&null!=this.useDic[z$V]&&(this.useDic[z$V]=!0)},z$U.deleteShape=function(z$V){this.shapeDic[z$V]&&(this.shapeDic[z$V]=null,delete this.shapeDic[z$V]),this.shapeLineDic[z$V]&&(this.shapeLineDic[z$V]=null,delete this.shapeLineDic[z$V]),null!=this.useDic[z$V]&&delete this.useDic[z$V]},z$U.getCacheList=function(){var z$V,z$U=[];for(z$V in this.shapeDic)z$U.push(this.shapeDic[z$V]);for(z$V in this.shapeLineDic)z$U.push(this.shapeLineDic[z$V]);return z$U},z$U.startDispose=function(z$V){var z$U;for(z$U in this.useDic)this.useDic[z$U]=!1;this._checkKey=!0},z$U.endDispose=function(){if(this._checkKey){var z$V;for(z$V in this.useDic)this.useDic[z$V]||this.deleteShape(z$V);this._checkKey=!1}},z$V.getInstance=function(){return z$V.instance=z$V.instance||new z$V},z$V.instance=null,z$V}(),z$C=function(){function z$s(){this._obj=null,this._obj=z$s.supportWeakMap?new z$j.window.WeakMap:{},z$s.supportWeakMap||z$s._maps.push(this)}z$b(z$s,"laya.utils.WeakObject");var z$V=z$s.prototype;return z$V.set=function(z$V,z$U){if(null!=z$V)if(z$s.supportWeakMap){var z$r=z$V;"string"!=typeof z$V&&"number"!=typeof z$V||(z$r=z$s._keys[z$V])||(z$r=z$s._keys[z$V]={k:z$V}),this._obj.set(z$r,z$U)}else"string"==typeof z$V||"number"==typeof z$V?this._obj[z$V]=z$U:(z$V.$_GID||(z$V.$_GID=z$v.getGID()),this._obj[z$V.$_GID]=z$U)},z$V.get=function(z$V){if(null==z$V)return null;if(z$s.supportWeakMap){var z$U="string"==typeof z$V||"number"==typeof z$V?z$s._keys[z$V]:z$V;return z$U?this._obj.get(z$U):null}return"string"==typeof z$V||"number"==typeof z$V?this._obj[z$V]:this._obj[z$V.$_GID]},z$V.del=function(z$V){if(null!=z$V)if(z$s.supportWeakMap){var z$U="string"==typeof z$V||"number"==typeof z$V?z$s._keys[z$V]:z$V;if(!z$U)return;this._obj.delete(z$U)}else"string"==typeof z$V||"number"==typeof z$V?delete this._obj[z$V]:delete this._obj[this._obj.$_GID]},z$V.has=function(z$V){if(null==z$V)return!1;if(z$s.supportWeakMap){var z$U="string"==typeof z$V||"number"==typeof z$V?z$s._keys[z$V]:z$V;return this._obj.has(z$U)}return"string"==typeof z$V||"number"==typeof z$V?null!=this._obj[z$V]:null!=this._obj[this._obj.$_GID]},z$s.__init__=function(){(z$s.supportWeakMap=null!=z$j.window.WeakMap)||z$y.timer.loop(z$s.delInterval,null,z$s.clearCache)},z$s.clearCache=function(){for(var z$V=0,z$U=z$s._maps.length;z$V<z$U;z$V++){z$s._maps[z$V]._obj={}}},z$s.supportWeakMap=!1,z$s.delInterval=3e5,z$s._keys={},z$s._maps=[],z$N(z$s,["I",function(){return this.I=new z$s}]),z$s}(),z$f=function(){function z$V(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}z$b(z$V,"laya.utils.WordText");var z$U=z$V.prototype;return z$U.setText=function(z$V){this.changed=!0,this._text=z$V},z$U.toString=function(){return this._text},z$U.charCodeAt=function(z$V){return this._text?this._text.charCodeAt(z$V):NaN},z$U.charAt=function(z$V){return this._text?this._text.charAt(z$V):null},z$q(0,z$U,"length",function(){return this._text?this._text.length:0}),z$V}(),z$VV=function(z$V){function z$R(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,z$R.__super.call(this),this._childs=z$R.ARRAY_EMPTY,this._$P=z$R.PROP_EMPTY,this.timer=z$y.scaleTimer,this.conchModel=z$m.isConchNode?this.createConchModel():null}z$b(z$R,"laya.display.Node",z$t);var z$U=z$R.prototype;return z$U._setBit=function(z$V,z$U){1==z$V&&(this._getBit(z$V)!=z$U&&this._updateDisplayedInstage());z$U?this._bits|=z$V:this._bits&=~z$V},z$U._getBit=function(z$V){return 0!=(this._bits&z$V)},z$U._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},z$U._setUpNoticeType=function(z$V){var z$U=this;for(z$U._setBit(z$V,!0),z$U=z$U.parent;z$U;){if(z$U._getBit(z$V))return;z$U._setBit(z$V,!0),z$U=z$U.parent}},z$U.on=function(z$V,z$U,z$r,z$s){return"display"!==z$V&&"undisplay"!==z$V||this._getBit(1)||this._setUpNoticeType(1),this._createListener(z$V,z$U,z$r,z$s,!1)},z$U.once=function(z$V,z$U,z$r,z$s){return"display"!==z$V&&"undisplay"!==z$V||this._getBit(1)||this._setUpNoticeType(1),this._createListener(z$V,z$U,z$r,z$s,!0)},z$U.createConchModel=function(){return null},z$U.destroy=function(z$V){void 0===z$V&&(z$V=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(z$V?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},z$U.destroyChildren=function(){if(this._childs)for(var z$V=this._childs.length-1;-1<z$V;z$V--)this._childs[z$V].destroy(!0)},z$U.addChild=function(z$V){if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),z$V._parent===this){var z$U=this.getChildIndex(z$V);z$U!==this._childs.length-1&&(this._childs.splice(z$U,1),this._childs.push(z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1)),this._childChanged())}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1),(z$V.parent=this)._childChanged();return z$V},z$U.addChildren=function(z$V){for(var z$U=arguments,z$r=0,z$s=z$U.length;z$r<z$s;)this.addChild(z$U[z$r++])},z$U.addChildAt=function(z$V,z$U){if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),0<=z$U&&z$U<=this._childs.length){if(z$V._parent===this){var z$r=this.getChildIndex(z$V);this._childs.splice(z$r,1),this._childs.splice(z$U,0,z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,z$U)),this._childChanged()}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(z$U,0,z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,z$U),z$V.parent=this;return z$V}throw new Error("appendChildAt:The index is out of bounds")},z$U.getChildIndex=function(z$V){return this._childs.indexOf(z$V)},z$U.getChildByName=function(z$V){var z$U=this._childs;if(z$U)for(var z$r=0,z$s=z$U.length;z$r<z$s;z$r++){var z$p=z$U[z$r];if(z$p.name===z$V)return z$p}return null},z$U._get$P=function(z$V){return this._$P[z$V]},z$U._set$P=function(z$V,z$U){return this.destroyed||(this._$P===z$R.PROP_EMPTY&&(this._$P={}),this._$P[z$V]=z$U),z$U},z$U.getChildAt=function(z$V){return this._childs[z$V]},z$U.setChildIndex=function(z$V,z$U){var z$r=this._childs;if(z$U<0||z$U>=z$r.length)throw new Error("setChildIndex:The index is out of bounds.");var z$s=this.getChildIndex(z$V);if(z$s<0)throw new Error("setChildIndex:node is must child of this object.");return z$r.splice(z$s,1),z$r.splice(z$U,0,z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,z$U)),this._childChanged(),z$V},z$U._childChanged=function(z$V){},z$U.removeChild=function(z$V){if(!this._childs)return z$V;var z$U=this._childs.indexOf(z$V);return this.removeChildAt(z$U)},z$U.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},z$U.removeChildByName=function(z$V){var z$U=this.getChildByName(z$V);return z$U&&this.removeChild(z$U),z$U},z$U.removeChildAt=function(z$V){var z$U=this.getChildAt(z$V);if(z$U){for(var z$r=this._childs.length-1,z$s=z$V;z$s<z$r;++z$s)this._childs[z$s]=this._childs[z$s+1];this._childs.length=z$r,this.conchModel&&this.conchModel.removeChild(z$U.conchModel),z$U.parent=null}return z$U},z$U.removeChildren=function(z$V,z$U){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=2147483647),this._childs&&0<this._childs.length){var z$r=this._childs;if(0===z$V&&z$c<=z$U){var z$s=z$r;this._childs=z$R.ARRAY_EMPTY}else z$s=z$r.splice(z$V,z$U-z$V);for(var z$p=0,z$c=z$s.length;z$p<z$c;z$p++)z$s[z$p].parent=null,this.conchModel&&this.conchModel.removeChild(z$s[z$p].conchModel)}return this},z$U.replaceChild=function(z$V,z$U){var z$r=this._childs.indexOf(z$U);return-1<z$r?(this._childs.splice(z$r,1,z$V),this.conchModel&&(this.conchModel.removeChild(z$U.conchModel),this.conchModel.addChildAt(z$V.conchModel,z$r)),z$U.parent=null,z$V.parent=this,z$V):null},z$U._updateDisplayedInstage=function(){var z$V;z$V=this;var z$U=z$y.stage;for(this._displayedInStage=!1;z$V;){if(z$V._getBit(1)){this._displayedInStage=z$V._displayedInStage;break}if(z$V==z$U||z$V._displayedInStage){this._displayedInStage=!0;break}z$V=z$V.parent}},z$U._setDisplay=function(z$V){this._displayedInStage!==z$V&&((this._displayedInStage=z$V)?this.event("display"):this.event("undisplay"))},z$U._displayChild=function(z$V,z$U){var z$r=z$V._childs;if(z$r)for(var z$s=0;z$s<z$r.length;z$s++){var z$p=z$r[z$s];z$p&&z$p._getBit(1)&&(0<z$p._childs.length?this._displayChild(z$p,z$U):z$p._setDisplay(z$U))}z$V._setDisplay(z$U)},z$U.contains=function(z$V){if(z$V===this)return!0;for(;z$V;){if(z$V.parent===this)return!0;z$V=z$V.parent}return!1},z$U.timerLoop=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$p&&(z$p=!0),void 0===z$c&&(z$c=!1),this.timer.loop(z$V,z$U,z$r,z$s,z$p,z$c)},z$U.timerOnce=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=!0),this.timer._create(!1,!1,z$V,z$U,z$r,z$s,z$p)},z$U.frameLoop=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=!0),this.timer._create(!0,!0,z$V,z$U,z$r,z$s,z$p)},z$U.frameOnce=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=!0),this.timer._create(!0,!1,z$V,z$U,z$r,z$s,z$p)},z$U.clearTimer=function(z$V,z$U){this.timer.clear(z$V,z$U)},z$q(0,z$U,"numChildren",function(){return this._childs.length}),z$q(0,z$U,"destroyed",function(){return this._destroyed}),z$q(0,z$U,"parent",function(){return this._parent},function(z$V){this._parent!==z$V&&(z$V?(this._parent=z$V,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),z$V.displayedInStage&&this._displayChild(this,!0)),z$V._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=z$V))}),z$q(0,z$U,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),z$R.ARRAY_EMPTY=[],z$R.PROP_EMPTY={},z$R.NOTICE_DISPLAY=1,z$R.MOUSEENABLE=2,z$R}(),z$UV=function(z$V){function z$_(z$V){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,z$_.__super.call(this),this._padding=z$_._PADDING,this._spacing=z$_._SPACING,this._aligns=z$_._ALIGNS,this._font=z$G.EMPTY,this._ower=z$V}z$b(z$_,"laya.display.css.CSSStyle",z$V);var z$U=z$_.prototype;return z$U.destroy=function(){this._ower=null,this._font=null,this._rect=null},z$U.inherit=function(z$V){this._font=z$V._font,this._spacing=z$V._spacing===z$_._SPACING?z$_._SPACING:z$V._spacing.slice(),this.lineHeight=z$V.lineHeight},z$U._widthAuto=function(){return 0!=(262144&this._type)},z$U.widthed=function(z$V){return 0!=(8&this._type)},z$U._calculation=function(z$V,z$U){if(z$U.indexOf("%")<0)return!1;var z$s=this._ower,z$p=z$s.parent,z$c=this._rect;function z$R(z$V,z$U,z$r){return z$V*z$r[0]+z$U*z$r[1]+z$r[2]}function z$r(z$V){var z$U=z$p.width,z$r=z$s.width;z$c.width&&(z$s.width=z$R(z$U,z$r,z$c.width)),z$c.height&&(z$s.height=z$R(z$U,z$r,z$c.height)),z$c.left&&(z$s.x=z$R(z$U,z$r,z$c.left)),z$c.top&&(z$s.y=z$R(z$U,z$r,z$c.top))}null===z$c&&(z$p._getCSSStyle()._type|=524288,z$p.on("resize",this,z$r),this._rect=z$c={input:{}});var z$T=z$U.split(" ");return z$T[0]=parseFloat(z$T[0])/100,1==z$T.length?z$T[1]=z$T[2]=0:(z$T[1]=parseFloat(z$T[1])/100,z$T[2]=parseFloat(z$T[2])),z$c[z$V]=z$T,z$c.input[z$V]=z$U,z$r(),!0},z$U.heighted=function(z$V){return 0!=(8192&this._type)},z$U.size=function(z$V,z$U){var z$r=this._ower,z$s=!1;-1!==z$V&&z$V!=this._ower.width&&(this._type|=8,this._ower.width=z$V,z$s=!0),-1!==z$U&&z$U!=this._ower.height&&(this._type|=8192,this._ower.height=z$U,z$s=!0),z$s&&(z$r._layoutLater(),524288&this._type&&z$r.event("resize",this))},z$U._getAlign=function(){return this._aligns[0]},z$U._getValign=function(){return this._aligns[1]},z$U._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},z$U._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new z$G(this._font))},z$U.render=function(z$V,z$U,z$r,z$s){var z$p=z$V.width,z$c=z$V.height;z$r-=z$V.pivotX,z$s-=z$V.pivotY,this._bgground&&null!=this._bgground.color&&z$U.ctx.fillRect(z$r,z$s,z$p,z$c,this._bgground.color),this._border&&this._border.color&&z$U.drawRect(z$r,z$s,z$p,z$c,this._border.color.strColor,this._border.size)},z$U.getCSSStyle=function(){return this},z$U.cssText=function(z$V){this.attrs(z$_.parseOneCSS(z$V,";"))},z$U.attrs=function(z$V){if(z$V)for(var z$U=0,z$r=z$V.length;z$U<z$r;z$U++){var z$s=z$V[z$U];this[z$s[0]]=z$s[1]}},z$U.setTransform=function(z$V){"none"===z$V?this._tf=z$T._TF_EMPTY:this.attrs(z$_.parseOneCSS(z$V,","))},z$U.translate=function(z$V,z$U){this._tf===z$T._TF_EMPTY&&(this._tf=new z$p),this._tf.translateX=z$V,this._tf.translateY=z$U},z$U.scale=function(z$V,z$U){this._tf===z$T._TF_EMPTY&&(this._tf=new z$p),this._tf.scaleX=z$V,this._tf.scaleY=z$U},z$U._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},z$q(0,z$U,"block",z$V.prototype._$get_block,function(z$V){z$V?this._type|=1:this._type&=-2}),z$q(0,z$U,"valign",function(){return z$_._valigndef[this._aligns[1]]},function(z$V){this._aligns===z$_._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=z$_._valigndef[z$V]}),z$q(0,z$U,"height",null,function(z$V){if(this._type|=8192,"string"==typeof z$V){if(this._calculation("height",z$V))return;z$V=parseInt(z$V)}this.size(-1,z$V)}),z$q(0,z$U,"width",null,function(z$V){if(this._type|=8,"string"==typeof z$V){var z$U=z$V.indexOf("auto");if(0<=z$U&&(this._type|=262144,z$V=z$V.substr(0,z$U)),this._calculation("width",z$V))return;z$V=parseInt(z$V)}this.size(z$V,-1)}),z$q(0,z$U,"fontWeight",function(){return this._font.weight},function(z$V){this._createFont().weight=z$V}),z$q(0,z$U,"left",null,function(z$V){var z$U=this._ower;if("string"==typeof z$V){if("center"===z$V?z$V="50% -50% 0":"right"===z$V&&(z$V="100% -100% 0"),this._calculation("left",z$V))return;z$V=parseInt(z$V)}z$U.x=z$V}),z$q(0,z$U,"_translate",null,function(z$V){this.translate(z$V[0],z$V[1])}),z$q(0,z$U,"absolute",function(){return 0!=(4&this._type)}),z$q(0,z$U,"top",null,function(z$V){var z$U=this._ower;if("string"==typeof z$V){if("middle"===z$V?z$V="50% -50% 0":"bottom"===z$V&&(z$V="100% -100% 0"),this._calculation("top",z$V))return;z$V=parseInt(z$V)}z$U.y=z$V}),z$q(0,z$U,"align",function(){return z$_._aligndef[this._aligns[0]]},function(z$V){this._aligns===z$_._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=z$_._aligndef[z$V]}),z$q(0,z$U,"bold",function(){return this._font.bold},function(z$V){this._createFont().bold=z$V}),z$q(0,z$U,"padding",function(){return this._padding},function(z$V){this._padding=z$V}),z$q(0,z$U,"leading",function(){return this._spacing[1]},function(z$V){"string"==typeof z$V&&(z$V=parseInt(z$V+"")),this._spacing===z$_._SPACING&&(this._spacing=[0,0]),this._spacing[1]=z$V}),z$q(0,z$U,"lineElement",function(){return 0!=(65536&this._type)},function(z$V){z$V?this._type|=65536:this._type&=-65537}),z$q(0,z$U,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(z$V){this.lineElement=!1,"right"===z$V?this._type|=32768:this._type&=-32769}),z$q(0,z$U,"textDecoration",function(){return this._font.decoration},function(z$V){this._createFont().decoration=z$V}),z$q(0,z$U,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(z$V){"nowrap"===z$V&&(this._type|=131072),"none"===z$V&&(this._type&=-131073)}),z$q(0,z$U,"background",null,function(z$V){z$V?(this._bgground||(this._bgground={}),this._bgground.color=z$V,this._ower.conchModel&&this._ower.conchModel.bgColor(z$V),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),z$q(0,z$U,"wordWrap",function(){return 0==(131072&this._type)},function(z$V){z$V?this._type&=-131073:this._type|=131072}),z$q(0,z$U,"color",function(){return this._font.color},function(z$V){this._createFont().color=z$V}),z$q(0,z$U,"password",function(){return this._font.password},function(z$V){this._createFont().password=z$V}),z$q(0,z$U,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(z$V){"none"===z$V?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=z$V),this._ower.conchModel&&this._ower.conchModel.bgColor(z$V),this._ower._renderType|=256}),z$q(0,z$U,"font",function(){return this._font.toString()},function(z$V){this._createFont().set(z$V)}),z$q(0,z$U,"weight",null,function(z$V){this._createFont().weight=z$V}),z$q(0,z$U,"letterSpacing",function(){return this._spacing[0]},function(z$V){"string"==typeof z$V&&(z$V=parseInt(z$V+"")),this._spacing===z$_._SPACING&&(this._spacing=[0,0]),this._spacing[0]=z$V}),z$q(0,z$U,"fontSize",function(){return this._font.size},function(z$V){this._createFont().size=z$V}),z$q(0,z$U,"italic",function(){return this._font.italic},function(z$V){this._createFont().italic=z$V}),z$q(0,z$U,"fontFamily",function(){return this._font.family},function(z$V){this._createFont().family=z$V}),z$q(0,z$U,"stroke",function(){return this._font.stroke[0]},function(z$V){this._createFont().stroke===z$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=z$V}),z$q(0,z$U,"strokeColor",function(){return this._font.stroke[1]},function(z$V){this._createFont().stroke===z$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=z$V}),z$q(0,z$U,"border",function(){return this._border?this._border.value:""},function(z$V){if("none"!=z$V){this._border||(this._border={});var z$U=(this._border.value=z$V).split(" ");if(this._border.color=z$B.create(z$U[z$U.length-1]),1==z$U.length)return this._border.size=1,void(this._border.type="solid");var z$r=0;0<z$U[0].indexOf("px")?(this._border.size=parseInt(z$U[0]),z$r++):this._border.size=1,this._border.type=z$U[z$r],this._ower._renderType|=256}else this._border=null}),z$q(0,z$U,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(z$V){z$V?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==z$V?null:z$B.create(z$V),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),z$q(0,z$U,"position",function(){return 4&this._type?"absolute":""},function(z$V){"absolute"==z$V?this._type|=4:this._type&=-5}),z$q(0,z$U,"display",null,function(z$V){switch(z$V){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),z$q(0,z$U,"paddingLeft",function(){return this.padding[3]}),z$q(0,z$U,"paddingTop",function(){return this.padding[0]}),z$q(0,z$U,"_scale",null,function(z$V){this._ower.scale(z$V[0],z$V[1])}),z$q(0,z$U,"_rotate",null,function(z$V){this._ower.rotation=z$V}),z$_.parseOneCSS=function(z$V,z$U){for(var z$r,z$s=[],z$p=z$V.split(z$U),z$c=0,z$R=z$p.length;z$c<z$R;z$c++){var z$T=z$p[z$c],z$N=z$T.indexOf(":"),z$t=z$T.substr(0,z$N).replace(/^\s+|\s+$/g,"");if(0!=z$t.length){var z$b=z$T.substr(z$N+1).replace(/^\s+|\s+$/g,""),z$S=[z$t,z$b];switch(z$t){case"italic":case"bold":z$S[1]="true"==z$b;break;case"line-height":z$S[0]="lineHeight",z$S[1]=parseInt(z$b);break;case"font-size":z$S[0]="fontSize",z$S[1]=parseInt(z$b);break;case"padding":1<(z$r=z$b.split(" ")).length||(z$r[1]=z$r[2]=z$r[3]=z$r[0]),z$S[1]=[parseInt(z$r[0]),parseInt(z$r[1]),parseInt(z$r[2]),parseInt(z$r[3])];break;case"rotate":z$S[0]="_rotate",z$S[1]=parseFloat(z$b);break;case"scale":z$r=z$b.split(" "),z$S[0]="_scale",z$S[1]=[parseFloat(z$r[0]),parseFloat(z$r[1])];break;case"translate":z$r=z$b.split(" "),z$S[0]="_translate",z$S[1]=[parseInt(z$r[0]),parseInt(z$r[1])];break;default:(z$S[0]=z$_._CSSTOVALUE[z$t])||(z$S[0]=z$t)}z$s.push(z$S)}}return z$s},z$_.parseCSS=function(z$V,z$U){for(var z$r;null!=(z$r=z$_._parseCSSRegExp.exec(z$V));)z$_.styleSheets[z$r[1]]=z$_.parseOneCSS(z$r[2],";")},z$_.EMPTY=new z$_(null),z$_._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},z$_._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),z$_._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},z$_._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},z$_.styleSheets={},z$_.ALIGN_CENTER=1,z$_.ALIGN_RIGHT=2,z$_.VALIGN_MIDDLE=1,z$_.VALIGN_BOTTOM=2,z$_._CSS_BLOCK=1,z$_._DISPLAY_NONE=2,z$_._ABSOLUTE=4,z$_._WIDTH_SET=8,z$_._PADDING=[0,0,0,0],z$_._RECT=[-1,-1,-1,-1],z$_._SPACING=[0,0],z$_._ALIGNS=[0,0,0],z$_.ADDLAYOUTED=512,z$_._NEWFONT=4096,z$_._HEIGHT_SET=8192,z$_._BACKGROUND_SET=16384,z$_._FLOAT_RIGHT=32768,z$_._LINE_ELEMENT=65536,z$_._NOWARP=131072,z$_._WIDTHAUTO=262144,z$_._LISTERRESZIE=524288,z$_}(z$T),z$rV=function(z$V){function z$R(){this.url=null,this.audio=null,this.loaded=!1,z$R.__super.call(this)}z$b(z$R,"laya.media.h5audio.AudioSound",z$t);var z$U=z$R.prototype;return z$U.dispose=function(){var z$V=z$R._audioCache[this.url];z$V&&(z$V.src="",delete z$R._audioCache[this.url])},z$U.load=function(z$V){var z$U;if(z$V=z$K.formatURL(z$V),(this.url=z$V)==z$H._tMusic?(z$R._initMusicAudio(),(z$U=z$R._musicAudio).src!=z$V&&(z$R._audioCache[z$U.src]=null,z$U=null)):z$U=z$R._audioCache[z$V],z$U&&2<=z$U.readyState)this.event("complete");else{z$U||(z$U=z$V==z$H._tMusic?(z$R._initMusicAudio(),z$R._musicAudio):z$j.createElement("audio"),(z$R._audioCache[z$V]=z$U).src=z$V),z$U.addEventListener("canplaythrough",z$s),z$U.addEventListener("error",z$p);var z$r=this;(this.audio=z$U).load?z$U.load():z$p()}function z$s(){z$c(),z$r.loaded=!0,z$r.event("complete")}function z$p(){z$U.load=null,z$c(),z$r.event("error")}function z$c(){z$U.removeEventListener("canplaythrough",z$s),z$U.removeEventListener("error",z$p)}},z$U.play=function(z$V,z$U,z$r){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),!this.url)return null;var z$s,z$p;if(!(z$s=this.url==z$H._tMusic?z$R._musicAudio:z$R._audioCache[this.url]))return null;z$p=z$X.getItem("audio:"+this.url),z$m.isConchApp?z$p||((z$p=z$j.createElement("audio")).src=this.url):this.url==z$H._tMusic?(z$R._initMusicAudio(),(z$p=z$R._musicAudio).src=this.url):z$p=z$p||z$s.cloneNode(!0);var z$c=new z$_V(z$p);return z$c.url=this.url,z$c.loops=z$U,z$c.startTime=z$V,z$c.startHandler=z$r,z$c.play(!1),z$H.addChannel(z$c),z$c},z$q(0,z$U,"duration",function(){var z$V;return(z$V=z$R._audioCache[this.url])?z$V.duration:0}),z$R._initMusicAudio=function(){z$R._musicAudio||(z$R._musicAudio||(z$R._musicAudio=z$j.createElement("audio")),z$m.isConchApp||z$j.document.addEventListener("mousedown",z$R._makeMusicOK))},z$R._makeMusicOK=function(){z$j.document.removeEventListener("mousedown",z$R._makeMusicOK),z$R._musicAudio.src?z$R._musicAudio.play():(z$R._musicAudio.src="",z$R._musicAudio.load())},z$R._audioCache={},z$R._musicAudio=null,z$R}(),z$sV=function(z$V){function z$U(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,z$U.__super.call(this)}z$b(z$U,"laya.media.SoundChannel",z$t);var z$r=z$U.prototype;return z$r.play=function(){},z$r.stop=function(){},z$r.pause=function(){},z$r.resume=function(){},z$r.__runComplete=function(z$V){z$V&&z$V.run()},z$q(0,z$r,"volume",function(){return 1},function(z$V){}),z$q(0,z$r,"position",function(){return 0}),z$q(0,z$r,"duration",function(){return 0}),z$U}(),z$pV=function(z$V){function z$U(){z$U.__super.call(this)}z$b(z$U,"laya.media.Sound",z$t);var z$r=z$U.prototype;return z$r.load=function(z$V){},z$r.play=function(z$V,z$U,z$r){return void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),null},z$r.dispose=function(){},z$q(0,z$r,"duration",function(){return 0}),z$U}(),z$cV=function(z$V){function z$p(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,z$p.__super.call(this)}z$b(z$p,"laya.media.webaudio.WebAudioSound",z$t);var z$U=z$p.prototype;return z$U.load=function(z$V){this.url=z$V,this.audioBuffer=z$p._dataCache[z$V],this.audioBuffer?this._loaded(this.audioBuffer):(z$p.e.on("loaded:"+z$V,this,this._loaded),z$p.e.on("err:"+z$V,this,this._err),z$p.__loadingSound[z$V]||(z$p.__loadingSound[z$V]=!0,z$y.loader.load(z$V,z$W.create(this,this.onloaded),null,z$TV.BUFFER,4,!1,null,!0)))},z$U.onloaded=function(z$V){z$V||this._err(),this._disposed?this._removeLoadEvents():(this.data=z$V,z$p.buffs.push({buffer:this.data,url:this.url}),z$p.decode())},z$U._err=function(){if(this._removeLoadEvents(),z$p.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var z$V,z$U,z$r,z$s=0;for(z$V=(z$U=this.__toPlays).length,z$s=0;z$s<z$V;z$s++)(z$r=z$U[z$s])[3]&&!z$r[3].isStopped&&z$r[3].event("error");this.__toPlays.length=0}},z$U._loaded=function(z$V){this._removeLoadEvents(),this._disposed||(this.audioBuffer=z$V,this.loaded=!0,this.event("complete"))},z$U._removeLoadEvents=function(){z$p.e.off("loaded:"+this.url,this,this._loaded),z$p.e.off("err:"+this.url,this,this._err)},z$U.__playAfterLoaded=function(){if(this.__toPlays){var z$V,z$U,z$r,z$s=0;for(z$V=(z$U=this.__toPlays).length,z$s=0;z$s<z$V;z$s++)(z$r=z$U[z$s])[3]&&!z$r[3].isStopped&&this.play(z$r[0],z$r[1],z$r[2],z$r[3]);this.__toPlays.length=0}},z$U.play=function(z$V,z$U,z$r,z$s){return void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),z$s=z$s||new z$GV,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([z$V,z$U,z$r,z$s]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),z$s.url=this.url,z$s.loops=z$U,z$s.audioBuffer=this.audioBuffer,z$s.startTime=z$V,z$s.startHandler=z$r,z$s.play(!1),z$H.addChannel(z$s),z$s},z$U.dispose=function(){this._disposed=!0,delete z$p._dataCache[this.url],delete z$p.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},z$q(0,z$U,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),z$p.decode=function(){if(!(z$p.buffs.length<=0||z$p.isDecoding))if(z$p.isDecoding=!0,(z$p.tInfo=z$p.buffs.shift())&&z$p.tInfo.buffer&&z$p.tInfo.buffer.byteLength)try{z$p.ctx.decodeAudioData(z$p.tInfo.buffer,z$p._done,z$p._fail)}catch(z$V){console.error("decodeAudioData error  byteLength:"+z$p.tInfo.buffer.byteLength+"  url:"+z$p.tInfo.url)}else z$p._fail()},z$p._done=function(z$V){z$p.e.event("loaded:"+z$p.tInfo.url,z$V),z$p._dataCache[z$p.tInfo.url]=z$V,z$p.isDecoding=!1,z$p.decode()},z$p._fail=function(){z$p.e.event("err:"+z$p.tInfo.url,null),z$p.isDecoding=!1,z$p.decode()},z$p._playEmptySound=function(){if(null!=z$p.ctx){if(z$p._emptySource&&(z$p._emptySource.stop(),z$p._emptySource.disconnect(0),!z$GV._tryCleanFailed))try{z$p._emptySource.buffer=null}catch(z$V){z$GV._tryCleanFailed=!0}var z$V=z$p.ctx.createBufferSource();z$V.buffer=z$p._miniBuffer,z$V.connect(z$p.ctx.destination),z$V.start(0,0,0),z$p._emptySource=z$V}},z$p._unlock=function(){z$p._unlocked||(z$p._playEmptySound(),"running"==z$p.ctx.state?(z$j.document.removeEventListener("mousedown",z$p._unlock,!0),z$j.document.removeEventListener("touchend",z$p._unlock,!0),z$j.document.removeEventListener("touchstart",z$p._unlock,!0),z$p._unlocked=!0):"suspended"==z$p.ctx.state&&z$H._recoverWebAudio())},z$p.initWebAudio=function(){"running"!=z$p.ctx.state&&(z$p._unlock(),z$j.document.addEventListener("mousedown",z$p._unlock,!0),z$j.document.addEventListener("touchend",z$p._unlock,!0),z$j.document.addEventListener("touchstart",z$p._unlock,!0))},z$p._emptySource=null,z$p._dataCache={},z$p.buffs=[],z$p.isDecoding=!1,z$p._unlocked=!1,z$p.tInfo=null,z$p.__loadingSound={},z$N(z$p,["window",function(){return this.window=z$j.window},"webAudioEnabled",function(){return this.webAudioEnabled=z$p.window.AudioContext||z$p.window.webkitAudioContext||z$p.window.mozAudioContext},"ctx",function(){return this.ctx=z$p.webAudioEnabled?new(z$p.window.AudioContext||z$p.window.webkitAudioContext||z$p.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=z$p.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new z$t}]),z$p}(),z$RV=function(z$V){function z$U(){this._responseType=null,this._data=null,z$U.__super.call(this),this._http=new z$j.window.XMLHttpRequest}z$b(z$U,"laya.net.HttpRequest",z$t);var z$r=z$U.prototype;return z$r.send=function(z$V,z$U,z$r,z$s,z$p){void 0===z$r&&(z$r="get"),void 0===z$s&&(z$s="text"),this._responseType=z$s,this._data=null;var z$c=this,z$R=this._http;if(z$R.open(z$r,z$V,!0),z$p)for(var z$T=0;z$T<z$p.length;z$T++)z$R.setRequestHeader(z$p[z$T++],z$p[z$T]);else z$m.isConchApp||(z$U&&"string"!=typeof z$U?z$R.setRequestHeader("Content-Type","application/json"):z$R.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));z$R.responseType="arraybuffer"!==z$s?"text":"arraybuffer",z$R.onerror=function(z$V){z$c._onError(z$V)},z$R.onabort=function(z$V){z$c._onAbort(z$V)},z$R.onprogress=function(z$V){z$c._onProgress(z$V)},z$R.onload=function(z$V){z$c._onLoad(z$V)},z$R.send(z$U)},z$r._onProgress=function(z$V){z$V&&z$V.lengthComputable&&this.event("progress",z$V.loaded/z$V.total)},z$r._onAbort=function(z$V){this.error("Request was aborted by user")},z$r._onError=function(z$V){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},z$r._onLoad=function(z$V){var z$U=this._http,z$r=void 0!==z$U.status?z$U.status:200;200===z$r||204===z$r||0===z$r?this.complete():this.error("["+z$U.status+"]"+z$U.statusText+":"+z$U.responseURL)},z$r.error=function(z$V){this.clear(),this.event("error",z$V)},z$r.complete=function(){this.clear();var z$U=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=z$v.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(z$V){z$U=!1,this.error(z$V.message)}z$U&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},z$r.clear=function(){var z$V=this._http;z$V.onerror=z$V.onabort=z$V.onprogress=z$V.onload=null},z$q(0,z$r,"url",function(){return this._http.responseURL}),z$q(0,z$r,"http",function(){return this._http}),z$q(0,z$r,"data",function(){return this._data}),z$U}(),z$TV=function(z$V){function z$I(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,z$I.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}z$b(z$I,"laya.net.Loader",z$t);var z$U=z$I.prototype;return z$U.load=function(z$V,z$U,z$r,z$s,z$p){if(z$V&&""!=z$V||console.error("Loader 加载的url不合法 "+z$V),void 0===z$r&&(z$r=!0),void 0===z$p&&(z$p=!1),0===(this._url=z$V).indexOf("data:image")?this._type=z$U="image":this._type=z$U||(z$U=this.getTypeFromUrl(z$V)),this._cache=z$r,this._data=null,!z$p&&z$I.loadedMap[z$V])return this._data=z$I.loadedMap[z$V],this.event("progress",1),void this.event("complete",this._data);if(z$s&&z$I.setGroup(z$V,z$s),null!=z$I.parserMap[z$U])return this._customParse=!0,void(z$I.parserMap[z$U]instanceof laya.utils.Handler?z$I.parserMap[z$U].runWith(this):z$I.parserMap[z$U].call(null,this));if("image"===z$U||"htmlimage"===z$U||"nativeimage"===z$U)return this._loadImage(z$V);if("ttf"===z$U)return this._loadTTF(z$V);switch(z$U){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:z$U}z$I.preLoadedMap[z$V]?this.onLoaded(z$I.preLoadedMap[z$V]):z$R.resMgrLoad(z$V,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},z$U.getTypeFromUrl=function(z$V){var z$U=z$v.getFileExtension(z$V);return z$U?z$I.typeMap[z$U]:(console.warn("Not recognize the resources suffix",z$V),"text")},z$U._loadTTF=function(z$V){z$V=z$K.formatURL(z$V);var z$U=new z$E;z$U.complete=z$W.create(this,this.onLoaded),z$U.load(z$V)},z$U._loadImage=function(z$V){z$R.imgMgrLoad(z$V,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},z$U._loadImageComplete=function(z$V,z$U,z$r){if(null!=z$r)if(z$r instanceof ArrayBuffer){var z$s=new DataView(z$r),z$p=new laya.webgl.resource.WebGLImage(new Uint8Array(z$r,8),z$V,0,!1,z$s.getUint32(0),z$s.getUint32(4));this.onLoaded(z$p)}else if(z$r instanceof z$bV)z$I.imgMgrSet[z$V]=z$U,z$R.imgMgrLock(z$V,z$I.imgMgrSet[z$V]),this._url=z$V,this.complete(z$r);else{var z$c=-1!=z$V.indexOf(".png",z$V.length-4)?6408:6407;z$p=new laya.webgl.resource.WebGLImage(z$r,z$V,z$c,!1,z$r.width,z$r.height);this.onLoaded(z$p)}else this.event("error","Load image failed")},z$U.imageCancel=function(z$V,z$U,z$r){z$R.imgMgrCancel(z$V,this._onImageCallback)},z$U._loadSound=function(z$V){var z$U=new z$H._soundClass,z$r=this;function z$s(){z$U.offAll()}z$U.on("complete",this,function(){z$s(),z$r.onLoaded(z$U)}),z$U.on("error",this,function(){z$s(),z$U.dispose(),z$r.event("error","Load sound failed")}),z$U.load(z$V)},z$U.onProgress=function(z$V){"atlas"===this._type?this.event("progress",.3*z$V):this.event("progress",z$V)},z$U.onError=function(z$V){this.event("error",z$V)},z$U._loadedComplete=function(z$V,z$U,z$r){if(null!=z$r)switch(this._type){case"atlas":case"plf":case"json":var z$s=new z$o(z$r);this.onLoaded(JSON.parse(z$s.readUTFBytes()));break;case"font":z$s=new z$o(z$r);this.onLoaded(z$v.parseXMLFromString(z$s.readUTFBytes()));break;default:this.onLoaded(z$r)}else this.event("error",z$V)},z$U.onLoaded=function(z$V){var z$U=this._type;if("plf"==z$U)this.parsePLFData(z$V),this.complete(z$V);else if("image"===z$U){var z$r=new z$bV(z$V);z$r.url=this._url,this.complete(z$r)}else if("sound"===z$U||"htmlimage"===z$U||"nativeimage"===z$U)this.complete(z$V);else if("atlas"===z$U){if(!z$V.src&&!z$V._setContext){if(!this._data){if((this._data=z$V).meta&&z$V.meta.image)for(var z$s=z$V.meta.image.split(","),z$p=0<=this._url.indexOf("/")?"/":"\\",z$c=this._url.lastIndexOf(z$p),z$R=0<=z$c?this._url.substr(0,z$c+1):"",z$T=0,z$N=z$s.length;z$T<z$N;z$T++)z$s[z$T]=z$R+z$s[z$T];else z$s=[this._url.replace(".json",".png")];z$s.reverse(),z$V.toLoads=z$s,z$V.pics=[]}return this.event("progress",.3+1/z$s.length*.6),this._loadImage(z$s.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(z$V),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var z$t=this._data.frames,z$b=this._url.split("?")[0],z$S=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:z$b.substring(0,z$b.lastIndexOf("."))+"/",z$_=this._data.pics,z$G=z$K.formatURL(this._url),z$q=z$I.atlasMap[z$G]||(z$I.atlasMap[z$G]=[]);z$q.dir=z$S;var z$u=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var z$h in z$u=parseFloat(this._data.meta.scale),z$t){var z$l,z$W=z$t[z$h],z$O=z$_[z$W.frame.idx?z$W.frame.idx:0],z$L=z$K.formatURL(z$S+z$h);z$O.scaleRate=z$u,z$l=z$bV.create(z$O,z$W.frame.x,z$W.frame.y,z$W.frame.w,z$W.frame.h,z$W.spriteSourceSize.x,z$W.spriteSourceSize.y,z$W.sourceSize.w,z$W.sourceSize.h),z$I.cacheRes(z$L,z$l),z$I.keepCache(this._url,z$S+z$h),z$l.url=z$L,z$q.push(z$L)}else for(z$h in z$t)z$O=z$_[(z$W=z$t[z$h]).frame.idx?z$W.frame.idx:0],z$L=z$K.formatURL(z$S+z$h),z$I.cacheRes(z$L,z$bV.create(z$O,z$W.frame.x,z$W.frame.y,z$W.frame.w,z$W.frame.h,z$W.spriteSourceSize.x,z$W.spriteSourceSize.y,z$W.sourceSize.w,z$W.sourceSize.h)),z$I.loadedMap[z$L].url=z$L,z$I.keepCache(this._url,z$S+z$h),z$q.push(z$L);delete this._data.pics,this.complete(this._data)}else if("font"==z$U){if(!z$V.src)return this._data=z$V,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var z$d=new z$Q;z$d.parseFont(this._data,z$V);var z$k=this._url.split(".fnt")[0].split("/"),z$y=z$k[z$k.length-1];z$hV.registerBitmapFont(z$y,z$d),this._data=z$d,this.complete(this._data)}else if("pkm"==z$U){var z$D=z$kV.create(z$V,this._url),z$n=new z$bV(z$D);z$n.url=this._url,this.complete(z$n)}else this.complete(z$V)},z$U.parsePLFData=function(z$V){var z$U,z$r,z$s;for(z$U in z$V)switch(z$s=z$V[z$U],z$U){case"json":case"text":for(z$r in z$s)z$I.preLoadedMap[z$K.formatURL(z$r)]=z$s[z$r];break;default:for(z$r in z$s)z$I.preLoadedMap[z$K.formatURL(z$r)]=z$s[z$r]}},z$U.complete=function(z$V){this._data=z$V,this._customParse?this.event("loaded",z$V instanceof Array?[z$V]:z$V):(z$I._loaders.push(this),z$I._isWorking||z$I.checkNext())},z$U.endLoad=function(z$V){z$V&&(this._data=z$V),this._cache&&z$I.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},z$q(0,z$U,"url",function(){return this._url}),z$q(0,z$U,"data",function(){return this._data}),z$q(0,z$U,"cache",function(){return this._cache}),z$q(0,z$U,"type",function(){return this._type}),z$I.checkNext=function(){z$I._isWorking=!0;for(var z$V=z$j.now();z$I._startIndex<z$I._loaders.length;)if(z$j.now(),z$I._loaders[z$I._startIndex].endLoad(),z$I._startIndex++,z$j.now()-z$V>z$I.maxTimeOut)return console.warn("loader callback cost a long time:"+(z$j.now()-z$V)+" url="+z$I._loaders[z$I._startIndex-1].url),void z$y.timer.frameOnce(1,null,z$I.checkNext);z$I._loaders.length=0,z$I._startIndex=0,z$I._isWorking=!1},z$I.clearRes=function(z$V,z$U){if(null!=z$V){void 0===z$U&&(z$U=!1),z$V=z$K.formatURL(z$V);var z$r=z$I.getAtlas(z$V);if(z$r){for(var z$s=0,z$p=z$r.length;z$s<z$p;z$s++){var z$c=z$r[z$s],z$R=z$I.getRes(z$c);delete z$I.loadedMap[z$c],z$I.clearCache(z$V.substring(z$K.basePath.length),z$c.substring(z$K.basePath.length)),z$R&&z$R.destroy(z$U)}z$r.length=0,delete z$I.atlasMap[z$V],delete z$I.loadedMap[z$V]}else{var z$T=z$I.loadedMap[z$V];z$T&&(delete z$I.loadedMap[z$V],z$T instanceof laya.resource.Texture&&z$T.bitmap&&z$T.destroy(z$U))}}},z$I.clearTextureRes=function(z$V){z$V=z$K.formatURL(z$V);var z$U=laya.net.Loader.getAtlas(z$V),z$r=z$U&&0<z$U.length?laya.net.Loader.getRes(z$U[0]):laya.net.Loader.getRes(z$V);z$r&&z$r.bitmap&&(z$m.isConchApp&&!z$m.isConchWebGL?z$r.bitmap.source.releaseTexture&&z$r.bitmap.source.releaseTexture():null==z$r.bitmap._atlaser&&z$r.bitmap.releaseResource(!0))},z$I.getRes=function(z$V){return z$I.loadedMap[z$K.formatURL(z$V)]},z$I.getAtlas=function(z$V){return z$I.atlasMap[z$K.formatURL(z$V)]},z$I.cacheRes=function(z$V,z$U){z$V=z$K.formatURL(z$V),null!=z$I.loadedMap[z$V]?console.warn("Resources already exist,is repeated loading:",z$V):z$I.loadedMap[z$V]=z$U},z$I.setGroup=function(z$V,z$U){z$I.groupMap[z$U]||(z$I.groupMap[z$U]=[]),z$I.groupMap[z$U].push(z$V)},z$I.clearResByGroup=function(z$V){if(z$I.groupMap[z$V]){var z$U=z$I.groupMap[z$V],z$r=0,z$s=z$U.length;for(z$r=0;z$r<z$s;z$r++)z$I.clearRes(z$U[z$r]);z$U.length=0}},z$I.keepCache=function(z$V,z$U){if(z$V&&z$U){var z$r=z$I.cacheSet[z$U];z$r?-1==z$r.indexOf(z$V)&&z$r.push(z$V):z$I.cacheSet[z$U]=[z$V]}},z$I.clearCache=function(z$V,z$U){if(z$V&&z$U){var z$r=z$I.cacheSet[z$U];if(z$r){var z$s=z$r.indexOf(z$V);if(-1!==z$s){var z$p=z$r.length-1;0==z$p?(delete z$I.cacheSet[z$U],0<z$I.imgMgrSet[z$U]?z$R.imgMgrFree(z$U,z$I.imgMgrSet[z$U]):z$I.clearRes(z$U,!0)):(z$r[z$s]=z$r[z$p],z$r.length=z$p)}}}},z$I.saveObject=function(z$V,z$U,z$r){if(z$U&&z$V){var z$s=z$I.objectSet[z$V];z$s?(console.warn("Loader.saveObject: "+z$V),z$s[0]=z$U,z$s[1]=z$r):z$I.objectSet[z$V]=[z$U,z$r,[]]}},z$I.findObject=function(z$V){if(z$V){var z$U=z$I.objectSet[z$V];if(z$U)return z$U[0]}return null},z$I.keepObject=function(z$V,z$U){if(z$V&&z$U){var z$r=z$I.objectSet[z$U];z$r&&-1===z$r[2].indexOf(z$V)&&z$r[2].push(z$V)}},z$I.clearObject=function(z$V,z$U){if(z$V&&z$U){var z$r=z$I.objectSet[z$U];if(z$r){var z$s=z$r[2],z$p=z$s.indexOf(z$V);if(-1!==z$p){var z$c=z$s.length-1;0==z$c?(delete z$I.objectSet[z$U],z$r[1]&&z$r[1].call(null,z$r[0])):(z$s[z$p]=z$s[z$c],z$s.length=z$c)}}}},z$I.TEXT="text",z$I.JSON="json",z$I.XML="xml",z$I.BUFFER="arraybuffer",z$I.IMAGE="image",z$I.SOUND="sound",z$I.ATLAS="atlas",z$I.FONT="font",z$I.TTF="ttf",z$I.PLF="plf",z$I.PKM="pkm",z$I.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},z$I.parserMap={},z$I.groupMap={},z$I.maxTimeOut=100,z$I.loadedMap={},z$I.preLoadedMap={},z$I.atlasMap={},z$I._loaders=[],z$I._isWorking=!1,z$I._startIndex=0,z$I.imgCache={},z$I.cacheSet={},z$I.objectSet={},z$I.imgMgrSet={},z$I}(),z$NV=function(z$V){var z$_;function z$G(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},z$G.__super.call(this);for(var z$V=0;z$V<this._maxPriority;z$V++)this._resInfos[z$V]=[]}z$b(z$G,"laya.net.LoaderManager",z$t);var z$U=z$G.prototype;return z$U.create=function(z$V,z$r,z$U,z$s,z$p,z$c,z$R,z$T){if(null==z$c&&(z$c=2),null==z$R&&(z$R=!0),z$V instanceof Array){var z$N=z$V,z$t=z$N.length,z$b=0;if(z$U)var z$S=z$W.create(z$U.caller,z$U.method,z$U.args,!1);for(var z$_=0;z$_<z$t;z$_++){var z$G=z$N[z$_];"string"==typeof z$G&&(z$G=z$N[z$_]={url:z$G}),z$G.progress=0}for(z$_=0;z$_<z$t;z$_++){z$G=z$N[z$_];var z$q=z$U?z$W.create(null,z$l,[z$G],!1):null,z$u=z$U||z$r?z$W.create(null,z$h,[z$G]):null;this._create(z$G.url,z$u,z$q,z$G.clas||z$s,z$G.params||z$p,null!=z$G.priority&&0<=z$G.priority?z$G.priority:z$c,z$R,z$G.group||z$T)}function z$h(z$V,z$U){z$b++,z$V.progress=1,z$b===z$t&&z$r&&z$r.run()}function z$l(z$V,z$U){z$V.progress=z$U;for(var z$r=0,z$s=0;z$s<z$t;z$s++){z$r+=z$N[z$s].progress}var z$p=z$r/z$t;z$S.runWith(z$p)}return!0}return this._create(z$V,z$r,z$U,z$s,z$p,z$c,z$R,z$T)},z$U._create=function(z$U,z$r,z$V,z$s,z$p,z$c,z$R,z$T){z$U&&""!=z$U||console.error("加载的url不合法 "+z$U),null==z$c&&(z$c=2),null==z$R&&(z$R=!0);var z$N=z$K.formatURL(z$U),z$t=this.getRes(z$N);if(z$t)!z$t.hasOwnProperty("loaded")||z$t.loaded?(z$V&&z$V.runWith(1),z$r&&z$r.run()):z$r&&z$y.loader._createListener(z$U,z$r.caller,z$r.method,z$r.args,!0,!1);else{var z$b=z$v.getFileExtension(z$U),z$S=z$G.createMap[z$b];if(!z$S)throw new Error("LoaderManager:unknown file("+z$U+") extension with: "+z$b+".");z$s||(z$s=z$S[0]);var z$_=z$S[1];if("atlas"==z$b)this.load(z$U,z$r,z$V,z$_,z$c,z$R);else{z$s===z$bV&&(z$_="htmlimage"),(z$t=z$s?new z$s:null).hasOwnProperty("_loaded")&&(z$t._loaded=!1),z$t._setUrl(z$U),z$T&&z$t._setGroup(z$T),this._createLoad(z$t,z$U,z$W.create(null,function(z$V){z$t&&!z$t.destroyed&&z$V&&z$t.onAsynLoaded.call(z$t,z$U,z$V,z$p),z$r&&z$r.run();z$y.loader.event(z$U)}),z$V,z$_,z$c,!1,z$T,!0),z$R&&this.cacheRes(z$N,z$t)}}return z$t},z$U.load=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){z$V&&""!=z$V||console.error("加载的url不合法 "+z$V);var z$N=this;if(null==z$p&&(z$p=2),null==z$c&&(z$c=!0),void 0===z$T&&(z$T=!1),z$V instanceof Array)return this._loadAssets(z$V,z$U,z$r,z$s,z$p,z$c,z$R);var z$t=z$TV.getRes(z$V);if(null!=z$t)z$y.timer.frameOnce(1,null,function(){z$r&&z$r.runWith(1),z$U&&z$U.runWith(z$t),z$N._loaderCount||z$N.event("complete")});else{var z$b=z$G._resMap[z$V];z$b?(z$U&&z$b._createListener("complete",z$U.caller,z$U.method,z$U.args,!1,!1),z$r&&z$b._createListener("progress",z$r.caller,z$r.method,z$r.args,!1,!1)):((z$b=this._infoPool.length?this._infoPool.pop():new z$_).url=z$V,z$b.clas=null,z$b.type=z$s,z$b.cache=z$c,z$b.group=z$R,z$b.ignoreCache=z$T,z$b.priority=z$p,z$U&&z$b.on("complete",z$U.caller,z$U.method,z$U.args),z$r&&z$b.on("progress",z$r.caller,z$r.method,z$r.args),z$G._resMap[z$V]=z$b,z$p=z$p<this._maxPriority?0<=z$p?z$p:0:this._maxPriority-1,this._resInfos[z$p].push(z$b),this._next())}return this},z$U.cancel=function(z$V,z$U,z$r){if(z$t=z$G._resMap[z$V]){z$U&&z$t.off("complete",z$U.caller,z$U.method,!1),z$r&&z$t.off("progress",z$r.caller,z$r.method,!1);var z$s=z$t.getListener("complete"),z$p=z$t.getListener("progress");if(!(z$s&&z$s.head||z$p&&z$p.head)){if(z$t.loader){var z$c=z$t.loader;z$c.imageCancel(z$V),z$c.offAll(),z$c._data=null,z$c._customParse=!1,z$c._url=null,z$c._class=null,z$c._type=null,this._loaders.push(z$c),this._loaderCount--,delete this._loaderMap[z$t.url]}for(var z$R=0;z$R<this._maxPriority;z$R++)for(var z$T=this._resInfos[z$R],z$N=z$T.length-1;-1<z$N;z$N--){var z$t;(z$t=z$T[z$N])&&z$t.url===z$V&&(z$T[z$N]=null,z$t.destroy(),z$t.offAll(),this._infoPool.push(z$t))}delete z$G._resMap[z$V],this._next()}}},z$U._createLoad=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){var z$t=this;if(null==z$c&&(z$c=2),null==z$R&&(z$R=!0),void 0===z$N&&(z$N=!1),z$U instanceof Array)return this._loadAssets(z$U,z$r,z$s,z$p,z$c,z$R,z$T);var z$b=z$TV.getRes(z$U);if(null!=z$b)z$y.timer.frameOnce(1,null,function(){z$s&&z$s.runWith(1),z$r&&z$r.runWith(z$b),z$t._loaderCount||z$t.event("complete")});else{var z$S=z$G._resMap[z$U];z$S?(z$r&&z$S._createListener("complete",z$r.caller,z$r.method,z$r.args,!1,!1),z$s&&z$S._createListener("progress",z$s.caller,z$s.method,z$s.args,!1,!1)):((z$S=this._infoPool.length?this._infoPool.pop():new z$_).url=z$U,z$S.clas=z$V,z$S.type=z$p,z$S.cache=z$R,z$S.group=z$T,z$S.ignoreCache=z$N,z$S.priority=z$c,z$r&&z$S.on("complete",z$r.caller,z$r.method,z$r.args),z$s&&z$S.on("progress",z$s.caller,z$s.method,z$s.args),z$G._resMap[z$U]=z$S,z$c=z$c<this._maxPriority?0<=z$c?z$c:0:this._maxPriority-1,this._resInfos[z$c].push(z$S),this._next())}return this},z$U._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var z$V=0;z$V<this._maxPriority;z$V++)for(var z$U=this._resInfos[z$V];0<z$U.length;){var z$r=z$U.shift();if(z$r)return this._doLoad(z$r)}this._loaderCount||this.event("complete")}},z$U._doLoad=function(z$U){var z$r=this._loaders.length?this._loaders.pop():new z$TV;this._loaderCount++,(this._loaderMap[z$U.url]=z$r).on("complete",null,z$p),z$r.on("progress",null,function(z$V){z$U.event("progress",z$V)}),z$r.on("error",null,function(z$V){z$p(null)}),z$U.loader=z$r;var z$s=this;function z$p(z$V){z$r.offAll(),z$r._data=null,z$r._customParse=!1,z$r._url=null,z$r._class=null,z$r._type=null,z$s._loaders.push(z$r),z$s._loaderCount--,delete z$s._loaderMap[z$U.url],z$s._endLoad(z$U,z$V instanceof Array?[z$V]:z$V),z$s._next()}z$r._class=z$U.clas,1<=z$U.priority?(z$r.priority=z$U.priority,z$r.realTime=!1):(z$r.priority=0,z$r.realTime=!0),z$r.load(z$U.url,z$U.type,z$U.cache,z$U.group,z$U.ignoreCache)},z$U._endLoad=function(z$V,z$U){var z$r=z$V.url;if(null==z$U){var z$s=this._failRes[z$r]||0;if(z$s<this.retryNum)return console.warn("[warn]Retry to load:",z$r),this._failRes[z$r]=z$s+1,void z$y.timer.once(this.retryDelay,this,this._addReTry,[z$V],!1);console.warn("[error]Failed to load:",z$r),this.event("error",z$r)}this._failRes[z$r]&&(this._failRes[z$r]=0),delete z$G._resMap[z$r],z$V.event("complete",z$U),z$V.destroy(),z$V.offAll(),this._infoPool.push(z$V)},z$U._addReTry=function(z$V){this._resInfos[this._maxPriority-1].push(z$V),this._next()},z$U.clearRes=function(z$V,z$U){void 0===z$U&&(z$U=!1),z$TV.clearRes(z$V,z$U)},z$U.getRes=function(z$V){return z$TV.getRes(z$V)},z$U.cacheRes=function(z$V,z$U){z$TV.cacheRes(z$V,z$U)},z$U.clearTextureRes=function(z$V){z$TV.clearTextureRes(z$V)},z$U.setGroup=function(z$V,z$U){z$TV.setGroup(z$V,z$U)},z$U.clearResByGroup=function(z$V){z$TV.clearResByGroup(z$V)},z$U.clearUnLoaded=function(){for(var z$V=0;z$V<this._maxPriority;z$V++){for(var z$U=this._resInfos[z$V],z$r=z$U.length-1;-1<z$r;z$r--){var z$s=z$U[z$r];z$s&&(z$s.destroy(),z$s.offAll(),this._infoPool.push(z$s))}z$U.length=0}this._loaderCount=0,z$G._resMap={}},z$U.cancelLoadByUrls=function(z$V){if(z$V)for(var z$U=0,z$r=z$V.length;z$U<z$r;z$U++)this.cancelLoadByUrl(z$V[z$U])},z$U.cancelLoadByUrl=function(z$V){for(var z$U=0;z$U<this._maxPriority;z$U++)for(var z$r=this._resInfos[z$U],z$s=z$r.length-1;-1<z$s;z$s--){var z$p=z$r[z$s];z$p&&z$p.url===z$V&&(z$r[z$s]=null,z$p.destroy(),z$p.offAll(),this._infoPool.push(z$p))}z$G._resMap[z$V]&&delete z$G._resMap[z$V]},z$U._loadAssets=function(z$V,z$r,z$R,z$U,z$s,z$p,z$c){null==z$s&&(z$s=2),null==z$p&&(z$p=!0);for(var z$T=z$V.length,z$N=0,z$t=0,z$b=[],z$S=!0,z$_=0;z$_<z$T;z$_++){var z$G=z$V[z$_];if(!z$G)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+z$V);"string"==typeof z$G&&(z$G={url:z$G,type:z$U,size:1,priority:z$s}),z$G.size||(z$G.size=1),z$G.progress=0,z$t+=z$G.size,z$b.push(z$G);var z$q=z$R?z$W.create(null,z$l,[z$G],!1):null,z$u=z$r||z$R?z$W.create(null,z$h,[z$G]):null;this.load(z$G.url,z$u,z$q,z$G.type,null!=z$G.priority&&0<=z$G.priority?z$G.priority:2,z$p,z$G.group||z$c)}function z$h(z$V,z$U){z$N++,z$V.progress=1,z$U||(z$S=!1),z$N===z$T&&z$r&&z$r.runWith(z$S)}function z$l(z$V,z$U){if(null!=z$R){z$V.progress=z$U;for(var z$r=0,z$s=0;z$s<z$b.length;z$s++){var z$p=z$b[z$s];z$r+=z$p.size*z$p.progress}var z$c=z$r/z$t;z$R.runWith(z$c)}}return this},z$G.cacheRes=function(z$V,z$U){z$TV.cacheRes(z$V,z$U)},z$G._resMap={},z$N(z$G,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),z$G.__init$=function(){z$_=function(z$V){function z$U(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,z$U.__super.call(this)}return z$b(z$U,"",z$t),z$U.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},z$U}()},z$G}(),z$tV=(function(z$V){function z$p(z$V){z$p.__super.call(this),z$V||(z$V=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var z$U=0,z$r=0,z$s=0;z$s<20;z$s++)z$s%5!=4?this._mat[z$U++]=z$V[z$s]:this._alpha[z$r++]=z$V[z$s];this._action=z$w.createFilterAction(32),this._action.data=this}z$b(z$p,"laya.filters.ColorFilter",z$l);var z$U=z$p.prototype;z$y.imps(z$U,{"laya.filters.IFilter":!0}),z$U.callNative=function(z$V){z$V._$P.cf=this;z$V.conchModel&&z$V.conchModel.setFilterMatrix&&z$V.conchModel.setFilterMatrix(this._mat,this._alpha)},z$q(0,z$U,"type",function(){return 32}),z$q(0,z$U,"action",function(){return this._action})}(),function(z$V){function z$s(z$V,z$U,z$r){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===z$U&&(z$U=0),z$s.__super.call(this),this._byteClass=z$r||z$o,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,z$V&&0<z$U&&z$U<65535&&this.connect(z$V,z$U)}z$b(z$s,"laya.net.Socket",z$t);var z$U=z$s.prototype;z$U.connect=function(z$V,z$U){var z$r="ws://"+z$V+":"+z$U;z$r="https:"==z$j.window.location.protocol?"wss://"+z$V+":"+z$U:"ws://"+z$V+":"+z$U,this.connectByUrl(z$r)},z$U.connectByUrl=function(z$V){var z$U=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new z$j.window.WebSocket(z$V,this.protocols):this._socket=new z$j.window.WebSocket(z$V),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(z$V){z$U._onOpen(z$V)},this._socket.onmessage=function(z$V){z$U._onMessage(z$V)},this._socket.onclose=function(z$V){z$U._onClose(z$V)},this._socket.onerror=function(z$V){z$U._onError(z$V)}},z$U.cleanSocket=function(){try{this._socket.close()}catch(z$V){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},z$U.close=function(){if(null!=this._socket)try{this._socket.close()}catch(z$V){}},z$U._onOpen=function(z$V){this._connected=!0,this.event("open",z$V)},z$U._onMessage=function(z$V){if(z$V&&z$V.data){var z$U=z$V.data;if(this.disableInput&&z$U)this.event("message",z$U);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var z$r=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,z$U&&("string"==typeof z$U?this._input.writeUTFBytes(z$U):this._input.writeArrayBuffer(z$U),this._addInputPosition=this._input.pos,this._input.pos=z$r),this.event("message",z$U)}}},z$U._onClose=function(z$V){this._connected=!1,this.event("close",z$V)},z$U._onError=function(z$V){this.event("error",z$V)},z$U.send=function(z$V){this._socket.send(z$V)},z$U.flush=function(){if(this._output&&0<this._output.length){var z$U;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(z$V){z$U=z$V}this._output.endian=this.endian,this._output.clear(),z$U&&this.event("error",z$U)}},z$q(0,z$U,"input",function(){return this._input}),z$q(0,z$U,"output",function(){return this._output}),z$q(0,z$U,"connected",function(){return this._connected}),z$q(0,z$U,"endian",function(){return this._endian},function(z$V){this._endian=z$V,null!=this._input&&(this._input.endian=z$V),null!=this._output&&(this._output.endian=z$V)}),z$s.LITTLE_ENDIAN="littleEndian",z$s.BIG_ENDIAN="bigEndian"}(),function(z$V){function z$T(){z$T.__super.call(this),this._$1__id=++z$T._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(z$T._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,z$$.currentResourceManager&&z$$.currentResourceManager.addResource(this)}z$b(z$T,"laya.resource.Resource",z$t);var z$U=z$T.prototype;return z$y.imps(z$U,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),z$U._setUrl=function(z$V){var z$U;this._url!==z$V&&(this._url&&((z$U=z$T._urlResourcesMap[this._url]).splice(z$U.indexOf(this),1),0===z$U.length&&delete z$T._urlResourcesMap[this._url]),z$V&&((z$U=z$T._urlResourcesMap[z$V])||(z$T._urlResourcesMap[z$V]=z$U=[]),z$U.push(this)),this._url=z$V)},z$U._getGroup=function(){return this._group},z$U._setGroup=function(z$V){var z$U;this._group!==z$V&&(this._group&&((z$U=z$T._groupResourcesMap[this._group]).splice(z$U.indexOf(this),1),0===z$U.length&&delete z$T._groupResourcesMap[this._group]),z$V&&((z$U=z$T._groupResourcesMap[z$V])||(z$T._groupResourcesMap[z$V]=z$U=[]),z$U.push(this)),this._group=z$V)},z$U._addReference=function(){this._referenceCount++},z$U._removeReference=function(){this._referenceCount--},z$U._clearReference=function(){this._referenceCount=0},z$U._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},z$U.recreateResource=function(){this.completeCreate()},z$U.disposeResource=function(){},z$U.activeResource=function(z$V){void 0===z$V&&(z$V=!1),this._lastUseFrameCount=z$e.loopCount,!this._destroyed&&this.__loaded&&(this._released||z$V)&&this.recreateResource()},z$U.releaseResource=function(z$V){return void 0===z$V&&(z$V=!0),!(!z$V&&this.lock)&&(!(this._released&&!z$V)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},z$U.onAsynLoaded=function(z$V,z$U,z$r){throw new Error("Resource: must override this function!")},z$U.destroy=function(){var z$V;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete z$T._idResourcesMap[this.id],this._url&&((z$V=z$T._urlResourcesMap[this._url])&&(z$V.splice(z$V.indexOf(this),1),0===z$V.length&&delete z$T._urlResourcesMap[this.url]),z$TV.clearRes(this._url),this.__loaded||z$w.cancelLoadByUrl(this._url)),this._group&&((z$V=z$T._groupResourcesMap[this._group]).splice(z$V.indexOf(this),1),0===z$V.length&&delete z$T._groupResourcesMap[this.url]))},z$U.completeCreate=function(){this._released=!1,this.event("recovered",this)},z$U.dispose=function(){this.destroy()},z$q(0,z$U,"memorySize",function(){return this._memorySize},function(z$V){var z$U=z$V-this._memorySize;this._memorySize=z$V,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,z$U),this.resourceManager&&this.resourceManager.addSize(z$U)}),z$q(0,z$U,"_loaded",null,function(z$V){this.__loaded=z$V}),z$q(0,z$U,"loaded",function(){return this.__loaded}),z$q(0,z$U,"id",function(){return this._$1__id}),z$q(0,z$U,"destroyed",function(){return this._destroyed}),z$q(0,z$U,"group",function(){return this._getGroup()},function(z$V){this._setGroup(z$V)}),z$q(0,z$U,"resourceManager",function(){return this._resourceManager}),z$q(0,z$U,"url",function(){return this._url}),z$q(0,z$U,"released",function(){return this._released}),z$q(0,z$U,"referenceCount",function(){return this._referenceCount}),z$T.getResourceByID=function(z$V){return z$T._idResourcesMap[z$V]},z$T.getResourceByURL=function(z$V,z$U){return void 0===z$U&&(z$U=0),null==z$T._urlResourcesMap[z$V]?null:z$T._urlResourcesMap[z$V][z$U]},z$T.getResourceCountByURL=function(z$V){return z$T._urlResourcesMap[z$V].length},z$T.destroyUnusedResources=function(z$V){var z$U;if(z$V){var z$r=z$T._groupResourcesMap[z$V];if(z$r)for(var z$s=z$r.slice(),z$p=0,z$c=z$s.length;z$p<z$c;z$p++)(z$U=z$s[z$p]).lock||0!==z$U._referenceCount||z$U.destroy()}else for(var z$R in z$T._idResourcesMap)(z$U=z$T._idResourcesMap[z$R]).lock||0!==z$U._referenceCount||z$U.destroy()},z$T._uniqueIDCounter=0,z$T._idResourcesMap={},z$T._urlResourcesMap={},z$T._groupResourcesMap={},z$T}()),z$bV=function(z$V){function z$I(z$V,z$U){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,z$I.__super.call(this),z$V&&null!=z$V._addReference&&z$V._addReference(),this.setTo(z$V,z$U)}z$b(z$I,"laya.resource.Texture",z$t);var z$U=z$I.prototype;return z$U._setUrl=function(z$V){this.url=z$V},z$U.setTo=function(z$V,z$U){if(z$V instanceof z$R.HTMLElement){var z$r=z$OV.create("2D",z$V);this.bitmap=z$r}else this.bitmap=z$V;if(this.uv=z$U||z$I.DEF_UV,z$V){this._w=z$V.width,this._h=z$V.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var z$s=this;if(this._loaded)z$w.addToAtlas&&z$w.addToAtlas(z$s);else{var z$p=z$V;z$p instanceof laya.resource.HTMLImage&&z$p.image&&z$p.image.addEventListener("load",function(z$V){z$w.addToAtlas&&z$w.addToAtlas(z$s)},!1)}}},z$U.active=function(){this.bitmap&&this.bitmap.activeResource()},z$U.destroy=function(z$V){if(void 0===z$V&&(z$V=!1),this.alphaTexture&&(this.alphaTexture.destroy(z$V),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var z$U=this.bitmap;z$V?(z$m.isConchApp&&z$U.source&&z$U.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,z$U.dispose(),z$U._clearReference()):(z$U._removeReference(),0==z$U.referenceCount&&(z$m.isConchApp&&z$U.source&&z$U.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,z$U.dispose())),this.url&&this===z$y.loader.getRes(this.url)&&z$y.loader.clearRes(this.url,z$V),this._loaded=!1}},z$U.load=function(z$V){var z$U=this;this._loaded=!1,z$V=z$K.customFormat(z$V);var z$r=this.bitmap||(this.bitmap=z$kV.create(z$V));z$r.uri=z$V,z$r&&z$r._addReference();var z$s=this;z$r.onload=function(){z$r.onload=null,z$s._loaded=!0,z$U.sourceWidth=z$U._w=z$r.width,z$U.sourceHeight=z$U._h=z$r.height,z$s.event("loaded",this),z$w.addToAtlas&&z$w.addToAtlas(z$s)}},z$U.addTextureToAtlas=function(z$V){z$w.addTextureToAtlas(this)},z$U.getPixels=function(z$V,z$U,z$r,z$s){if(z$m.isConchApp){var z$p=this.bitmap;if(z$p.source&&z$p.source.getImageData){var z$c=z$p.source.getImageData(z$V,z$U,z$r,z$s),z$R=new Uint8Array(z$c);return Array.from(z$R)}return null}return z$m.isWebGL?z$w.getTexturePixels(this,z$V,z$U,z$r,z$s):(z$j.canvas.size(z$r,z$s),z$j.canvas.clear(),z$j.context.drawTexture(this,-z$V,-z$U,this.width,this.height,0,0),z$j.context.getImageData(0,0,z$r,z$s).data)},z$U.onAsynLoaded=function(z$V,z$U){if(z$U){if("function"!=typeof z$U._addReference)throw new Error("bitmap._addReference is not a function. "+z$U.className+" "+typeof z$U._addReference+" "+z$U.constructor);z$U._addReference()}this.setTo(z$U,this.uv),this._loaded&&this.event("loaded",this)},z$q(0,z$U,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),z$q(0,z$U,"loaded",function(){return this._loaded}),z$q(0,z$U,"released",function(){return!this.bitmap||this.bitmap.released}),z$q(0,z$U,"width",function(){return this._w?this._w:this.uv&&this.uv!==z$I.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(z$V){this._w=z$V,this.sourceWidth||(this.sourceWidth=z$V)}),z$q(0,z$U,"repeat",function(){return!z$m.isWebGL||!this.bitmap||this.bitmap.repeat},function(z$V){z$V&&z$m.isWebGL&&this.bitmap&&(this.bitmap.repeat=z$V)&&(this.bitmap.enableMerageInAtlas=!1)}),z$q(0,z$U,"height",function(){return this._h?this._h:this.uv&&this.uv!==z$I.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(z$V){this._h=z$V,this.sourceHeight||(this.sourceHeight=z$V)}),z$q(0,z$U,"isLinearSampling",function(){return!z$m.isWebGL||9728!=this.bitmap.minFifter},function(z$V){!z$V&&z$m.isWebGL&&(z$V||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),z$I.moveUV=function(z$V,z$U,z$r){for(var z$s=0;z$s<8;z$s+=2)z$r[z$s]+=z$V,z$r[z$s+1]+=z$U;return z$r},z$I.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){void 0===z$c&&(z$c=0),void 0===z$R&&(z$R=0),void 0===z$T&&(z$T=0),void 0===z$N&&(z$N=0);var z$t=z$V instanceof laya.resource.Texture,z$b=z$t?z$V.uv:z$I.DEF_UV,z$S=z$t?z$V.bitmap:z$V,z$_=z$w.isAtlas(z$S);if(z$_){var z$G=z$S._atlaser,z$q=z$V._atlasID;if(-1==z$q)throw new Error("create texture error");z$S=z$G._inAtlasTextureBitmapValue[z$q],z$b=z$G._inAtlasTextureOriUVValue[z$q]}var z$u=new z$I(z$S,null);z$S.width&&z$U+z$s>z$S.width&&(z$s=z$S.width-z$U),z$S.height&&z$r+z$p>z$S.height&&(z$p=z$S.height-z$r),z$u.width=z$s,z$u.height=z$p,z$u.offsetX=z$c,z$u.offsetY=z$R,z$u.sourceWidth=z$T||z$s,z$u.sourceHeight=z$N||z$p;var z$h=1/z$S.width,z$l=1/z$S.height;z$U*=z$h,z$r*=z$l,z$s*=z$h,z$p*=z$l;var z$W=z$u.uv[0],z$O=z$u.uv[1],z$L=z$u.uv[4],z$d=z$u.uv[5],z$k=z$L-z$W,z$y=z$d-z$O,z$D=z$I.moveUV(z$b[0],z$b[1],[z$U,z$r,z$U+z$s,z$r,z$U+z$s,z$r+z$p,z$U,z$r+z$p]);z$u.uv=[z$W+z$D[0]*z$k,z$O+z$D[1]*z$y,z$L-(1-z$D[2])*z$k,z$O+z$D[3]*z$y,z$L-(1-z$D[4])*z$k,z$d-(1-z$D[5])*z$y,z$W+z$D[6]*z$k,z$d-(1-z$D[7])*z$y],z$_&&z$u.addTextureToAtlas();var z$n=z$S.scaleRate;return z$n&&1!=z$n?(z$u.sourceWidth/=z$n,z$u.sourceHeight/=z$n,z$u.width/=z$n,z$u.height/=z$n,z$u.scaleRate=z$n,z$u.offsetX/=z$n,z$u.offsetY/=z$n):z$u.scaleRate=1,z$u},z$I.createFromTexture=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$V.scaleRate;1!=z$c&&(z$U*=z$c,z$r*=z$c,z$s*=z$c,z$p*=z$c);var z$R=z$n.TEMP.setTo(z$U-z$V.offsetX,z$r-z$V.offsetY,z$s,z$p),z$T=z$R.intersection(z$I._rect1.setTo(0,0,z$V.width,z$V.height),z$I._rect2);if(!z$T)return null;var z$N=z$I.create(z$V,z$T.x,z$T.y,z$T.width,z$T.height,z$T.x-z$R.x,z$T.y-z$R.y,z$s,z$p);if(z$N.bitmap&&z$N.bitmap._removeReference)return z$N.bitmap._removeReference(),z$N;var z$t="bitmap:"+(z$N.bitmap?z$N.bitmap.constructor?z$N.bitmap.constructor.name:z$N.bitmap.__className:"")+", url:"+(z$V.url+" | "+(z$N.bitmap?z$N.bitmap.url:z$V.url))+", x="+z$U+",y="+z$r+",width="+z$s+",height="+z$p+", result="+(z$T?z$T.x+","+z$T.y+","+z$T.width+","+z$T.height:"null")+", rect="+z$R.x+","+z$R.y+","+z$R.width+","+z$R.height;throw new Error("报错：bitmap._removeReference is not a function  "+z$t)},z$I.DEF_UV=[0,0,1,0,1,1,0,1],z$I.INV_UV=[0,1,1,1,1,0,0,0],z$I._rect1=new z$n,z$I._rect2=new z$n,z$I}(),z$V=function(z$V){var z$T;function z$c(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,z$c.__super.call(this)}z$b(z$c,"laya.utils.TimeLine",z$t);var z$U=z$c.prototype;return z$U.to=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=0),this._create(z$V,z$U,z$r,z$s,z$p,!0)},z$U.from=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=0),this._create(z$V,z$U,z$r,z$s,z$p,!1)},z$U._create=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$X.getItemByClass("tweenData",z$T);return z$R.isTo=z$c,z$R.type=0,z$R.target=z$V,z$R.duration=z$r,z$R.data=z$U,z$R.startTime=this._startTime+z$p,z$R.endTime=z$R.startTime+z$R.duration,z$R.ease=z$s,this._startTime=Math.max(z$R.endTime,this._startTime),this._tweenDataList.push(z$R),this._startTimeSort=!0,this._endTimeSort=!0,this},z$U.addLabel=function(z$V,z$U){var z$r=z$X.getItemByClass("tweenData",z$T);return z$r.type=1,z$r.data=z$V,z$r.endTime=z$r.startTime=this._startTime+z$U,this._labelDic||(this._labelDic={}),this._labelDic[z$V]=z$r,this._tweenDataList.push(z$r),this},z$U.removeLabel=function(z$V){if(this._labelDic&&this._labelDic[z$V]){var z$U=this._labelDic[z$V];if(z$U){var z$r=this._tweenDataList.indexOf(z$U);-1<z$r&&this._tweenDataList.splice(z$r,1)}delete this._labelDic[z$V]}},z$U.gotoTime=function(z$V){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var z$U,z$r,z$s,z$p;for(var z$c in this._firstTweenDic)if(z$r=this._firstTweenDic[z$c])for(var z$R in z$r)z$r.diyTarget.hasOwnProperty(z$R)&&(z$r.diyTarget[z$R]=z$r[z$R]);for(z$c in this._tweenDic)(z$U=this._tweenDic[z$c]).clear(),delete this._tweenDic[z$c];if(this._index=0,this._gidIndex=0,this._currTime=z$V,this._lastTime=z$j.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=z$s=this._tweenDataList.concat(),z$s.sort(function(z$V,z$U){return z$V.endTime>z$U.endTime?1:z$V.endTime<z$U.endTime?-1:0})}else z$s=this._endTweenDataList;for(var z$T=0,z$N=z$s.length;z$T<z$N;z$T++)if(0==(z$p=z$s[z$T]).type){if(!(z$V>=z$p.endTime))break;this._index=Math.max(this._index,z$T+1);var z$t=z$p.data;if(z$p.isTo)for(var z$b in z$t)z$p.target[z$b]=z$t[z$b]}for(z$T=0,z$N=this._tweenDataList.length;z$T<z$N;z$T++)0==(z$p=this._tweenDataList[z$T]).type&&z$V>=z$p.startTime&&z$V<z$p.endTime&&(this._index=Math.max(this._index,z$T+1),this._gidIndex++,(z$U=z$X.getItemByClass("tween",z$g))._create(z$p.target,z$p.data,z$p.duration,z$p.ease,z$W.create(this,this._animComplete,[this._gidIndex]),0,!1,z$p.isTo,!0,!1),z$U.setStartTime(this._currTime-(z$V-z$p.startTime)),z$U._updateEase(this._currTime),z$U.gid=this._gidIndex,this._tweenDic[this._gidIndex]=z$U)}},z$U.gotoLabel=function(z$V){if(null!=this._labelDic){var z$U=this._labelDic[z$V];z$U&&this.gotoTime(z$U.startTime)}},z$U.pause=function(){z$y.timer.clear(this,this._update)},z$U.resume=function(){this.play(this._currTime,this._loopKey)},z$U.play=function(z$V,z$U){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(z$V,z$U){return z$V.startTime>z$U.startTime?1:z$V.startTime<z$U.startTime?-1:0});for(var z$r=0,z$s=this._tweenDataList.length;z$r<z$s;z$r++){var z$p=this._tweenDataList[z$r];if(null!=z$p&&0==z$p.type){var z$c=z$p.target,z$R=z$c.$_GID||(z$c.$_GID=z$v.getGID()),z$T=null;for(var z$N in null==this._firstTweenDic[z$R]?((z$T={}).diyTarget=z$c,this._firstTweenDic[z$R]=z$T):z$T=this._firstTweenDic[z$R],z$p.data)null==z$T[z$N]&&(z$T[z$N]=z$c[z$N])}}}"string"==typeof z$V?this.gotoLabel(z$V):this.gotoTime(z$V),this._loopKey=z$U,this._lastTime=z$j.now(),z$y.timer.frameLoop(1,this,this._update)}},z$U._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var z$V in this._tweenDic)(z$U=this._tweenDic[z$V]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var z$U,z$r=z$j.now(),z$s=z$r-this._lastTime,z$p=this._currTime+=z$s*this.scale;for(z$V in this._lastTime=z$r,this._tweenDic)(z$U=this._tweenDic[z$V])._updateEase(z$p);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var z$c=this._tweenDataList[this._index];z$p>=z$c.startTime&&(this._index++,0==z$c.type?(this._gidIndex++,(z$U=z$X.getItemByClass("tween",z$g))._create(z$c.target,z$c.data,z$c.duration,z$c.ease,z$W.create(this,this._animComplete,[this._gidIndex]),0,!1,z$c.isTo,!0,!1),z$U.setStartTime(z$p),z$U.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=z$U)._updateEase(z$p)):this.event("label",z$c.data))}},z$U._animComplete=function(z$V){this._tweenDic[z$V]&&delete this._tweenDic[z$V]},z$U._complete=function(){this.event("complete")},z$U.reset=function(){var z$V;if(this._labelDic)for(z$V in this._labelDic)delete this._labelDic[z$V];for(z$V in this._tweenDic)this._tweenDic[z$V].clear(),delete this._tweenDic[z$V];for(z$V in this._firstTweenDic)delete this._firstTweenDic[z$V];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var z$U,z$r=0;for(z$U=this._tweenDataList.length,z$r=0;z$r<z$U;z$r++)this._tweenDataList[z$r]&&this._tweenDataList[z$r].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,z$y.timer.clear(this,this._update)},z$U.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},z$q(0,z$U,"index",function(){return this._frameIndex},function(z$V){this._frameIndex=z$V,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),z$q(0,z$U,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),z$c.to=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=0),(new z$c).to(z$V,z$U,z$r,z$s,z$p)},z$c.from=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$p&&(z$p=0),(new z$c).from(z$V,z$U,z$r,z$s,z$p)},z$c.__init$=function(){z$T=function(){function z$V(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return z$b(z$V,""),z$V.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,z$X.recover("tweenData",this)},z$V}()},z$c}(),z$SV=function(z$p){function z$r(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,z$r.__super.call(this),this._style=z$T.EMPTY}z$b(z$r,"laya.display.Sprite",z$p);var z$V=z$r.prototype;return z$y.imps(z$V,{"laya.display.ILayout":!0}),z$V.createConchModel=function(){return new ConchNode},z$V.destroy=function(z$V){if(void 0===z$V&&(z$V=!0),this._releaseMem(),!this._destroyed){this.filters=null;var z$U=this.mask;z$U&&(this.mask=null,z$U.destroy(z$V))}z$p.prototype.destroy.call(this,z$V),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},z$V.updateZOrder=function(){z$v.updateOrder(this._childs)&&this.repaint()},z$V.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},z$V.setBounds=function(z$V){this._set$P("uBounds",z$V)},z$V.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new z$n),z$n._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},z$V.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new z$n),z$n._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},z$V._boundPointsToParent=function(z$V){void 0===z$V&&(z$V=!1);var z$U=0,z$r=0;this._style&&(z$U=this._style._tf.translateX,z$r=this._style._tf.translateY,z$V=z$V||0!==this._style._tf.rotate,this._style.scrollRect&&(z$U+=this._style.scrollRect.x,z$r+=this._style.scrollRect.y));var z$s=this._getBoundPointsM(z$V);if(!z$s||z$s.length<1)return z$s;if(8!=z$s.length&&(z$s=z$V?z$d.scanPList(z$s):z$n._getWrapRec(z$s,z$n.TEMP)._getBoundPoints()),!this.transform)return z$v.transPointList(z$s,this._x-z$U,this._y-z$r),z$s;var z$p=z$D.TEMP,z$c=0,z$R=z$s.length;for(z$c=0;z$c<z$R;z$c+=2)z$p.x=z$s[z$c],z$p.y=z$s[z$c+1],this.toParentPoint(z$p),z$s[z$c]=z$p.x,z$s[z$c+1]=z$p.y;return z$s},z$V.getGraphicBounds=function(z$V){return void 0===z$V&&(z$V=!1),this._graphics?this._graphics.getBounds(z$V):z$n.TEMP.setTo(0,0,0,0)},z$V._getBoundPointsM=function(z$V){if(void 0===z$V&&(z$V=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var z$U=z$v.clearArray(this._$P.temBM),z$r=z$n.TEMP;return z$r.copyFrom(this.scrollRect),z$v.concatArray(z$U,z$r._getBoundPoints()),z$U}for(var z$s,z$p,z$c,z$R=this._graphics?this._graphics.getBoundPoints():z$v.clearArray(this._$P.temBM),z$T=0,z$N=(z$c=this._childs).length;z$T<z$N;z$T++)(z$s=z$c[z$T])instanceof laya.display.Sprite&&1==z$s.visible&&(z$p=z$s._boundPointsToParent(z$V))&&(z$R=z$R?z$v.concatArray(z$R,z$p):z$p);return z$R},z$V.getStyle=function(){return this._style===z$T.EMPTY&&(this._style=new z$T),this._style},z$V.setStyle=function(z$V){this._style=z$V},z$V._adjustTransform=function(){this._tfChanged=!1;var z$V,z$U=this._style._tf,z$r=z$U.scaleX,z$s=z$U.scaleY;if(z$U.rotate||1!==z$r||1!==z$s||z$U.skewX||z$U.skewY){(z$V=this._transform||(this._transform=z$z.create())).bTransform=!0;var z$p=.0174532922222222*(z$U.rotate-z$U.skewX),z$c=.0174532922222222*(z$U.rotate+z$U.skewY),z$R=Math.cos(z$c),z$T=Math.sin(z$c),z$N=Math.sin(z$p),z$t=Math.cos(z$p);return z$V.a=z$r*z$R,z$V.b=z$r*z$T,z$V.c=-z$s*z$N,z$V.d=z$s*z$t,z$V.tx=z$V.ty=0,z$V}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,z$V},z$V.pos=function(z$V,z$U,z$r){if(void 0===z$r&&(z$r=!1),this._x!==z$V||this._y!==z$U){if(this.destroyed)return this;if(z$r){this._x=z$V,this._y=z$U,this.conchModel&&this.conchModel.pos(this._x,this._y);var z$s=this._parent;z$s&&0===z$s._repaint&&(z$s._repaint=1,z$s.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=z$V,this.y=z$U}return this},z$V.pivot=function(z$V,z$U){return this.pivotX=z$V,this.pivotY=z$U,this},z$V.size=function(z$V,z$U){return this.width=z$V,this.height=z$U,this},z$V.scale=function(z$V,z$U,z$r){void 0===z$r&&(z$r=!1);var z$s=this.getStyle(),z$p=z$s._tf;if(z$p.scaleX!=z$V||z$p.scaleY!=z$U){if(this.destroyed)return this;if(z$r){z$s.setScale(z$V,z$U),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(z$V,z$U),this._renderType|=4;var z$c=this._parent;z$c&&0===z$c._repaint&&(z$c._repaint=1,z$c.parentRepaint())}else this.scaleX=z$V,this.scaleY=z$U}return this},z$V.skew=function(z$V,z$U){return this.skewX=z$V,this.skewY=z$U,this},z$V.render=function(z$V,z$U,z$r){z$e.spriteCount++,z$Z.renders[this._renderType]._fun(this,z$V,z$U+this._x,z$r+this._y),this._repaint=0},z$V.drawToCanvas=function(z$V,z$U,z$r,z$s){if(z$m.isConchNode){var z$p=z$OV.create("2D");return new z$a(z$V,z$U,z$p).ctx.setCanvasType(1),this.conchModel.drawToCanvas(z$p.source,z$r,z$s),z$p}return z$w.drawToCanvas(this,this._renderType,z$V,z$U,z$r,z$s)},z$V.customRender=function(z$V,z$U,z$r){this._renderType|=1024},z$V._applyFilters=function(){var z$V;if(!z$m.isWebGL&&((z$V=this._$P.filters)&&!(z$V.length<1)))for(var z$U=0,z$r=z$V.length;z$U<z$r;z$U++)z$V[z$U].action.apply(this._$P.cacheCanvas)},z$V._isHaveGlowFilter=function(){var z$V,z$U=0;if(this.filters)for(z$U=0;z$U<this.filters.length;z$U++)if(8==this.filters[z$U].type)return!0;for(z$U=0,z$V=this._childs.length;z$U<z$V;z$U++)if(this._childs[z$U]._isHaveGlowFilter())return!0;return!1},z$V.localToGlobal=function(z$V,z$U){void 0===z$U&&(z$U=!1),!0===z$U&&(z$V=new z$D(z$V.x,z$V.y));for(var z$r=this;z$r&&z$r!=z$y.stage;)z$V=z$r.toParentPoint(z$V),z$r=z$r.parent;return z$V},z$V.globalToLocal=function(z$V,z$U){void 0===z$U&&(z$U=!1),z$U&&(z$V=new z$D(z$V.x,z$V.y));for(var z$r=this,z$s=[];z$r&&z$r!=z$y.stage;)z$s.push(z$r),z$r=z$r.parent;for(var z$p=z$s.length-1;0<=z$p;)z$V=(z$r=z$s[z$p]).fromParentPoint(z$V),z$p--;return z$V},z$V.toParentPoint=function(z$V){if(!z$V)return z$V;z$V.x-=this.pivotX,z$V.y-=this.pivotY,this.transform&&this._transform.transformPoint(z$V),z$V.x+=this._x,z$V.y+=this._y;var z$U=this._style.scrollRect;return z$U&&(z$V.x-=z$U.x,z$V.y-=z$U.y),z$V},z$V.fromParentPoint=function(z$V){if(!z$V)return z$V;z$V.x-=this._x,z$V.y-=this._y;var z$U=this._style.scrollRect;return z$U&&(z$V.x+=z$U.x,z$V.y+=z$U.y),this.transform&&this._transform.invertTransformPoint(z$V),z$V.x+=this.pivotX,z$V.y+=this.pivotY,z$V},z$V.on=function(z$V,z$U,z$r,z$s){return 1!==this._mouseEnableState&&this.isMouseEvent(z$V)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(z$V,z$U,z$r,z$s,!1)):z$p.prototype.on.call(this,z$V,z$U,z$r,z$s)},z$V.once=function(z$V,z$U,z$r,z$s){return 1!==this._mouseEnableState&&this.isMouseEvent(z$V)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(z$V,z$U,z$r,z$s,!0)):z$p.prototype.once.call(this,z$V,z$U,z$r,z$s)},z$V._$2__onDisplay=function(){if(1!==this._mouseEnableState){var z$V=this;for(z$V=z$V.parent;z$V&&1!==z$V._mouseEnableState&&!z$V._getBit(2);)z$V.mouseEnabled=!0,z$V._setBit(2,!0),z$V=z$V.parent}},z$V.loadImage=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=this;return void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),this.graphics.loadImage(z$V,z$U,z$r,z$s,z$p,function(z$V){z$R.destroyed||(z$R.size(z$U+(z$s||z$V.width),z$r+(z$p||z$V.height)),z$R.repaint(),z$c&&z$c.runWith(z$V))}),this},z$V.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},z$V._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},z$V._childChanged=function(z$V){this._childs.length?this._renderType|=2048:this._renderType&=-2049,z$V&&this._get$P("hasZorder")&&z$y.timer.callLater(this,this.updateZOrder),this.repaint()},z$V.parentRepaint=function(){var z$V=this._parent;z$V&&0===z$V._repaint&&(z$V._repaint=1,z$V.parentRepaint())},z$V.startDrag=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){void 0===z$U&&(z$U=!1),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=300),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=.92),this._$P.dragging||this._set$P("dragging",new z$P),this._$P.dragging.start(this,z$V,z$U,z$r,z$s,z$p,z$c,z$R)},z$V.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},z$V._releaseMem=function(){if(this._$P){var z$V=this._$P.cacheCanvas;z$V&&z$V.ctx&&(z$X.recover("RenderContext",z$V.ctx),z$V.ctx.canvas.size(0,0),z$V.ctx=null);var z$U=this._$P._filterCache;z$U&&(z$U.destroy(),z$U.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},z$V._setDisplay=function(z$V){z$V||this._releaseMem(),z$p.prototype._setDisplay.call(this,z$V)},z$V.hitTestPoint=function(z$V,z$U){var z$r=this.globalToLocal(z$D.TEMP.setTo(z$V,z$U));return z$V=z$r.x,z$U=z$r.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?z$n.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(z$V,z$U)},z$V.getMousePoint=function(){return this.globalToLocal(z$D.TEMP.setTo(z$y.stage.mouseX,z$y.stage.mouseY))},z$V._getWords=function(){return null},z$V._addChildsToLayout=function(z$V){var z$U=this._getWords();if(null==z$U&&0==this._childs.length)return!1;if(z$U)for(var z$r=0,z$s=z$U.length;z$r<z$s;z$r++)z$V.push(z$U[z$r]);z$r=0;for(var z$p=this._childs.length;z$r<z$p;++z$r){var z$c=this._childs[z$r];z$c._style._enableLayout()&&z$c._addToLayout(z$V)}return!0},z$V._addToLayout=function(z$V){this._style.absolute||(this._style.block?z$V.push(this):this._addChildsToLayout(z$V)&&(this.x=this.y=0))},z$V._isChar=function(){return!1},z$V._getCSSStyle=function(){return this._style.getCSSStyle()},z$V._setAttributes=function(z$V,z$U){switch(z$V){case"x":this.x=parseFloat(z$U);break;case"y":this.y=parseFloat(z$U);break;case"width":this.width=parseFloat(z$U);break;case"height":this.height=parseFloat(z$U);break;default:this[z$V]=z$U}},z$V._layoutLater=function(){this.parent&&this.parent._layoutLater()},z$q(0,z$V,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(z$V){this._optimizeScrollRect!=z$V&&(this._optimizeScrollRect=z$V,this.conchModel&&this.conchModel.optimizeScrollRect(z$V))}),z$q(0,z$V,"customRenderEnable",null,function(z$V){if(z$V&&(this._renderType|=1024,z$m.isConchNode)){z$r.CustomList.push(this);var z$U=new z$OV("2d");z$U._setContext(new CanvasRenderingContext2D),this.customContext=new z$a(0,0,z$U),z$U.context.setCanvasType&&z$U.context.setCanvasType(2),this.conchModel.custom(z$U.context)}}),z$q(0,z$V,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(z$V){this.cacheAs=z$V?this._$P.hasFilter?"none":"normal":"none"}),z$q(0,z$V,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(z$V){var z$U=this._$P.cacheCanvas;if(z$V!==(z$U?z$U.type:"none")){if("none"!==z$V)this._getBit(1)||this._setUpNoticeType(1),z$U||(z$U=this._set$P("cacheCanvas",z$X.getItemByClass("cacheCanvas",Object))),z$U.type=z$V,z$U.reCache=!0,this._renderType|=16,"bitmap"==z$V&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(z$U){var z$r=z$U;z$r&&z$r.ctx&&(z$X.recover("RenderContext",z$r.ctx),z$r.ctx.canvas.size(0,0),z$r.ctx=null),z$X.recover("cacheCanvas",z$U)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),z$q(0,z$V,"zOrder",function(){return this._zOrder},function(z$V){this._zOrder!=z$V&&(this._zOrder=z$V,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(z$V),this._parent&&(z$V&&this._parent._set$P("hasZorder",!0),z$y.timer.callLater(this._parent,this.updateZOrder)))}),z$q(0,z$V,"rotation",function(){return this._style._tf.rotate},function(z$V){var z$U=this.getStyle();if(z$U._tf.rotate!==z$V){z$U.setRotate(z$V),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(z$V),this._renderType|=4;var z$r=this._parent;z$r&&0===z$r._repaint&&(z$r._repaint=1,z$r.parentRepaint())}}),z$q(0,z$V,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(z$V){this._width!==z$V&&(this._width=z$V,this.conchModel&&this.conchModel.size(z$V,this._height),this.repaint())}),z$q(0,z$V,"x",function(){return this._x},function(z$V){if(this._x!==z$V){if(this.destroyed)return;this._x=z$V,this.conchModel&&this.conchModel.pos(z$V,this._y);var z$U=this._parent;z$U&&0===z$U._repaint&&(z$U._repaint=1,z$U.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),z$q(0,z$V,"globalScaleY",function(){for(var z$V=1,z$U=this;z$U&&z$U!==z$y.stage;)z$V*=z$U.scaleY,z$U=z$U.parent;return z$V}),z$q(0,z$V,"hitArea",function(){return this._$P.hitArea},function(z$V){this._set$P("hitArea",z$V)}),z$q(0,z$V,"staticCache",function(){return this._$P.staticCache},function(z$V){this._set$P("staticCache",z$V),z$V||this.reCache()}),z$q(0,z$V,"texture",function(){return this._texture},function(z$V){this._texture!=z$V&&(this._texture=z$V,this.graphics.cleanByTexture(z$V,0,0))}),z$q(0,z$V,"y",function(){return this._y},function(z$V){if(this._y!==z$V){if(this.destroyed)return;this._y=z$V,this.conchModel&&this.conchModel.pos(this._x,z$V);var z$U=this._parent;z$U&&0===z$U._repaint&&(z$U._repaint=1,z$U.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),z$q(0,z$V,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(z$V){this._height!==z$V&&(this._height=z$V,this.conchModel&&this.conchModel.size(this._width,z$V),this.repaint())}),z$q(0,z$V,"blendMode",function(){return this._style.blendMode},function(z$V){this.getStyle().blendMode=z$V,this.conchModel&&this.conchModel.blendMode(z$V),z$V&&"source-over"!=z$V?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),z$q(0,z$V,"scaleX",function(){return this._style._tf.scaleX},function(z$V){var z$U=this.getStyle();if(z$U._tf.scaleX!==z$V){z$U.setScaleX(z$V),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(z$V,z$U._tf.scaleY),this._renderType|=4;var z$r=this._parent;z$r&&0===z$r._repaint&&(z$r._repaint=1,z$r.parentRepaint())}}),z$q(0,z$V,"scaleY",function(){return this._style._tf.scaleY},function(z$V){var z$U=this.getStyle();if(z$U._tf.scaleY!==z$V){z$U.setScaleY(z$V),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(z$U._tf.scaleX,z$V),this._renderType|=4;var z$r=this._parent;z$r&&0===z$r._repaint&&(z$r._repaint=1,z$r.parentRepaint())}}),z$q(0,z$V,"stage",function(){return z$y.stage}),z$q(0,z$V,"skewX",function(){return this._style._tf.skewX},function(z$V){var z$U=this.getStyle();if(z$U._tf.skewX!==z$V){z$U.setSkewX(z$V),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(z$V,z$U._tf.skewY),this._renderType|=4;var z$r=this._parent;z$r&&0===z$r._repaint&&(z$r._repaint=1,z$r.parentRepaint())}}),z$q(0,z$V,"scrollRect",function(){return this._style.scrollRect},function(z$V){this.getStyle().scrollRect=z$V,this.repaint(),z$V?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(z$V.x,z$V.y,z$V.width,z$V.height)):(this._renderType&=-129,this.conchModel&&(z$r.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),z$q(0,z$V,"skewY",function(){return this._style._tf.skewY},function(z$V){var z$U=this.getStyle();if(z$U._tf.skewY!==z$V){z$U.setSkewY(z$V),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(z$U._tf.skewX,z$V),this._renderType|=4;var z$r=this._parent;z$r&&0===z$r._repaint&&(z$r._repaint=1,z$r.parentRepaint())}}),z$q(0,z$V,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(z$V){this._tfChanged=!1,(this._transform=z$V)&&(this._x=z$V.tx,this._y=z$V.ty,z$V.tx=z$V.ty=0,this.conchModel&&this.conchModel.transform(z$V.a,z$V.b,z$V.c,z$V.d,this._x,this._y)),z$V?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),z$q(0,z$V,"pivotX",function(){return this._style._tf.translateX},function(z$V){this.getStyle().setTranslateX(z$V),this.conchModel&&this.conchModel.pivot(z$V,this._style._tf.translateY),this.repaint()}),z$q(0,z$V,"pivotY",function(){return this._style._tf.translateY},function(z$V){this.getStyle().setTranslateY(z$V),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,z$V),this.repaint()}),z$q(0,z$V,"alpha",function(){return this._style.alpha},function(z$V){this._style&&this._style.alpha!==z$V&&(z$V=z$V<0?0:1<z$V?1:z$V,this.getStyle().alpha=z$V,this.conchModel&&this.conchModel.alpha(z$V),1!==z$V?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),z$q(0,z$V,"visible",function(){return this._style.visible},function(z$V){this._style&&this._style.visible!==z$V&&(this.getStyle().visible=z$V,this.conchModel&&this.conchModel.visible(z$V),this.parentRepaint())}),z$q(0,z$V,"graphics",function(){return this._graphics||(this.graphics=z$w.createGraphics())},function(z$V){this._graphics&&(this._graphics._sp=null),(this._graphics=z$V)?(this._renderType&=-2,this._renderType|=512,(z$V._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(z$r.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),z$q(0,z$V,"filters",function(){return this._$P.filters},function(z$V){z$V&&0===z$V.length&&(z$V=null),this._$P.filters!=z$V&&(this._set$P("filters",z$V?z$V.slice():null),z$m.isConchApp&&(this.conchModel&&(z$r.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),z$m.isWebGL&&(z$V&&z$V.length?this._renderType|=32:this._renderType&=-33),z$V&&0<z$V.length?(this._getBit(1)||this._setUpNoticeType(1),z$m.isWebGL&&1==z$V.length&&z$V[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(z$m.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),z$q(0,z$V,"parent",z$p.prototype._$get_parent,function(z$V){z$y.superSet(z$VV,this,"parent",z$V),z$V&&this._getBit(2)&&this._$2__onDisplay()}),z$q(0,z$V,"mask",function(){return this._$P._mask},function(z$V){z$V&&this.mask&&this.mask._$P.maskParent||(z$V?(this.cacheAs="bitmap",this._set$P("_mask",z$V),z$V._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",z$V),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(z$V?z$V.conchModel:null),this._renderType|=64,this.parentRepaint())}),z$q(0,z$V,"mouseEnabled",function(){return 1<this._mouseEnableState},function(z$V){this._mouseEnableState=z$V?2:1}),z$q(0,z$V,"globalScaleX",function(){for(var z$V=1,z$U=this;z$U&&z$U!==z$y.stage;)z$V*=z$U.scaleX,z$U=z$U.parent;return z$V}),z$q(0,z$V,"mouseX",function(){return this.getMousePoint().x}),z$q(0,z$V,"mouseY",function(){return this.getMousePoint().y}),z$r.fromImage=function(z$V){return(new z$r).loadImage(z$V)},z$r._cachePool=[],z$r.CustomList=[],z$N(z$r,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=z$R.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),z$r}(z$VV),z$_V=function(z$V){function z$U(z$V){this._audio=null,this._onEnd=null,this._resumePlay=null,z$U.__super.call(this),this._onEnd=z$v.bind(this.__onEnd,this),this._resumePlay=z$v.bind(this.__resumePlay,this),z$V.addEventListener("ended",this._onEnd),this._audio=z$V}z$b(z$U,"laya.media.h5audio.AudioSoundChannel",z$sV);var z$r=z$U.prototype;return z$r.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(z$y.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},z$r.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,z$j.container.appendChild(this._audio),this._audio.play()}catch(z$V){this.event("error")}},z$r.play=function(z$V){this.isStopped=!1;try{this._audio.playbackRate=z$H.playbackRate,this._audio.currentTime=this.startTime}catch(z$V){return void this._audio.addEventListener("canplay",this._resumePlay)}z$H.addChannel(this),z$j.container.appendChild(this._audio),!z$V&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},z$r.stop=function(){this.isStopped=!0,z$H.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&z$m.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),z$j.onIE||this._audio!=z$rV._musicAudio&&z$X.recover("audio:"+this.url,this._audio),z$j.removeElement(this._audio),this._audio=null)},z$r.pause=function(){this.isStopped=!0,z$H.removeChannel(this),"pause"in this._audio&&this._audio.pause()},z$r.resume=function(){this._audio&&(this.isStopped=!1,z$H.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},z$q(0,z$r,"position",function(){return this._audio?this._audio.currentTime:0}),z$q(0,z$r,"duration",function(){return this._audio?this._audio.duration:0}),z$q(0,z$r,"volume",function(){return this._audio?this._audio.volume:1},function(z$V){this._audio&&(this._audio.volume=z$V)}),z$U}(),z$GV=function(z$V){function z$U(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=z$cV.ctx,z$U.__super.call(this),this._onPlayEnd=z$v.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}z$b(z$U,"laya.media.webaudio.WebAudioSoundChannel",z$sV);var z$r=z$U.prototype;return z$r.play=function(z$V){if(z$H.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var z$U=this.context,z$r=this.gain,z$s=z$U.createBufferSource();(this.bufferSource=z$s).buffer=this.audioBuffer,z$s.connect(z$r),z$r&&z$r.disconnect(),z$r.connect(z$U.destination),z$s.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=z$j.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(z$s.loop=!0),z$s.playbackRate.setTargetAtTime?z$s.playbackRate.setTargetAtTime(z$H.playbackRate,this.context.currentTime,.1):z$s.playbackRate.value=z$H.playbackRate,z$s.start(0,this.startTime),!z$V&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},z$r.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(z$y.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},z$r._clearBufferSource=function(){if(this.bufferSource){var z$V=this.bufferSource;z$V.stop?z$V.stop(0):z$V.noteOff(0),z$V.disconnect(0),z$V.onended=null,z$U._tryCleanFailed||this._tryClearBuffer(z$V),this.bufferSource=null}},z$r._tryClearBuffer=function(z$V){try{z$V.buffer=null}catch(z$V){z$U._tryCleanFailed=!0}},z$r.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,z$H.removeChannel(this),this.startHandler=null,this.completeHandler=null},z$r.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,z$H.removeChannel(this)},z$r.resume=function(){this.startTime=this._pauseTime,this.play(!1)},z$q(0,z$r,"position",function(){return this.bufferSource?(z$j.now()-this._startTime)/1e3+this.startTime:0}),z$q(0,z$r,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),z$q(0,z$r,"volume",function(){return this._volume},function(z$V){this.isStopped||(this._volume=z$V,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(z$V,this.context.currentTime,.1):this.gain.gain.value=z$V)}),z$U._tryCleanFailed=!1,z$U}(),z$qV=function(z$V){function z$U(){z$U.__super.call(this),this._w=0,this._h=0}z$b(z$U,"laya.resource.Bitmap",z$tV);var z$r=z$U.prototype;return z$q(0,z$r,"width",function(){return this._w}),z$q(0,z$r,"height",function(){return this._h}),z$q(0,z$r,"source",function(){return this._source}),z$U}(),z$uV=function(z$U){function z$V(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,z$V.__super.call(this),this._interval=z$s.animationInterval,this._setUpNoticeType(1)}z$b(z$V,"laya.display.AnimationPlayerBase",z$U);var z$r=z$V.prototype;return z$r.play=function(z$V,z$U,z$r,z$s){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=!0),void 0===z$r&&(z$r=""),void 0===z$s&&(z$s=!0),this._isPlaying=!0,this.index="string"==typeof z$V?this._getFrameByLabel(z$V):z$V,this.loop=z$U,this._actionName=z$r,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},z$r._getFrameByLabel=function(z$V){var z$U=0;for(z$U=0;z$U<this._count;z$U++)if(this._labels[z$U]&&0<=this._labels[z$U].indexOf(z$V))return z$U;return 0},z$r._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},z$r._setControlNode=function(z$V){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=z$V)&&z$V!=this&&(z$V.on("display",this,this._checkResumePlaying),z$V.on("undisplay",this,this._checkResumePlaying))},z$r._setDisplay=function(z$V){z$U.prototype._setDisplay.call(this,z$V),this._checkResumePlaying()},z$r._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},z$r.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},z$r.addLabel=function(z$V,z$U){this._labels||(this._labels={}),this._labels[z$U]||(this._labels[z$U]=[]),this._labels[z$U].push(z$V)},z$r.removeLabel=function(z$V){if(z$V){if(this._labels)for(var z$U in this._labels)this._removeLabelFromLabelList(this._labels[z$U],z$V)}else this._labels=null},z$r._removeLabelFromLabelList=function(z$V,z$U){if(z$V)for(var z$r=z$V.length-1;0<=z$r;z$r--)z$V[z$r]==z$U&&z$V.splice(z$r,1)},z$r.gotoAndStop=function(z$V){this.index="string"==typeof z$V?this._getFrameByLabel(z$V):z$V,this.stop()},z$r._displayToIndex=function(z$V){},z$r.clear=function(){this.stop(),this._labels=null},z$q(0,z$r,"interval",function(){return this._interval},function(z$V){this._interval!=z$V&&(this._frameRateChanged=!0,this._interval=z$V,this._isPlaying&&0<z$V&&this.timerLoop(z$V,this,this._frameLoop,null,!0,!0))}),z$q(0,z$r,"isPlaying",function(){return this._isPlaying}),z$q(0,z$r,"index",function(){return this._index},function(z$V){if(this._index=z$V,this._displayToIndex(z$V),this._labels&&this._labels[z$V])for(var z$U=this._labels[z$V],z$r=0,z$s=z$U.length;z$r<z$s;z$r++)this.event("label",z$U[z$r])}),z$q(0,z$r,"count",function(){return this._count}),z$V.WRAP_POSITIVE=0,z$V.WRAP_REVERSE=1,z$V.WRAP_PINGPONG=2,z$V}(z$SV),z$hV=function(z$U){function z$G(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,z$G.__super.call(this),this.overflow=z$G.VISIBLE,this._style=new z$UV(this),this._style.wordWrap=!1}z$b(z$G,"laya.display.Text",z$U);var z$V=z$G.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._lines=null,this._words&&(this._words.length=0,this._words=null)},z$V._getBoundPointsM=function(z$V){void 0===z$V&&(z$V=!1);var z$U=z$n.TEMP;return z$U.setTo(0,0,this.width,this.height),z$U._getBoundPoints()},z$V.getGraphicBounds=function(z$V){void 0===z$V&&(z$V=!1);var z$U=z$n.TEMP;return z$U.setTo(0,0,this.width,this.height),z$U},z$V._getCSSStyle=function(){return this._style},z$V.lang=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b){if(z$V=z$G.langPacks&&z$G.langPacks[z$V]?z$G.langPacks[z$V]:z$V,arguments.length<2)this._text=z$V;else{for(var z$S=0,z$_=arguments.length;z$S<z$_;z$S++)z$V=z$V.replace("{"+z$S+"}",arguments[z$S+1]);this._text=z$V}},z$V._isPassWordMode=function(){var z$V=this._style.password;return"prompt"in this&&this.prompt==this._text&&(z$V=!1),z$V},z$V._getPassWordTxt=function(z$V){var z$U;z$U="";for(var z$r=z$V.length;0<z$r;z$r--)z$U+="●";return z$U},z$V.renderText=function(z$V,z$U){var z$r=this.graphics;z$r.clear(!0);var z$s=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(z$j.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);z$j.context.font=z$s;var z$p=this.padding,z$c=z$p[3],z$R="left",z$T=this._lines,z$N=this.leading+this._charSize.height,z$t=this._currBitmapFont;z$t&&(z$N=this.leading+z$t.getMaxHeight());var z$b=z$p[0];if(!z$t&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(z$R="right",z$c=this._width-z$p[1]):"center"==this.align&&(z$R="center",z$c=.5*this._width+z$p[3]-z$p[1])),0<this._height){var z$S=this._textHeight>this._height?"top":this.valign;"middle"===z$S?z$b=.5*(this._height-z$U*z$N)+z$p[0]-z$p[2]:"bottom"===z$S&&(z$b=this._height-z$U*z$N-z$p[2])}var z$_=this._style;if(z$t&&z$t.autoScaleSize)var z$G=z$t.fontSize/this.fontSize;if(this._clipPoint)if(z$r.save(),z$t&&z$t.autoScaleSize){var z$q=0,z$u=0;z$q=this._width?this._width-z$p[3]-z$p[1]:this._textWidth,z$u=this._height?this._height-z$p[0]-z$p[2]:this._textHeight,z$q*=z$G,z$u*=z$G,z$r.clipRect(z$p[3],z$p[0],z$q,z$u)}else z$r.clipRect(z$p[3],z$p[0],this._width?this._width-z$p[3]-z$p[1]:this._textWidth,this._height?this._height-z$p[0]-z$p[2]:this._textHeight);var z$h=z$_.password;"prompt"in this&&this.prompt==this._text&&(z$h=!1);for(var z$l=0,z$W=0,z$O=Math.min(this._lines.length,z$U+z$V)||1,z$L=z$V;z$L<z$O;z$L++){var z$d,z$k=z$T[z$L];if(z$h){var z$y=z$k.length;z$k="";for(var z$D=z$y;0<z$D;z$D--)z$k+="●"}if(z$l=z$c-(this._clipPoint?this._clipPoint.x:0),z$W=z$b+z$N*z$L-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(z$R,z$l,z$W,z$L),z$t){var z$n=this.width;z$t.autoScaleSize&&(z$n=this.width*z$G),z$t.drawText(z$k,this,z$l,z$W,this.align,z$n)}else z$m.isWebGL?(this._words||(this._words=[]),(z$d=this._words.length>z$L-z$V?this._words[z$L-z$V]:new z$f).setText(z$k)):z$d=z$k,z$_.stroke?z$r.fillBorderText(z$d,z$l,z$W,z$s,this.color,z$_.strokeColor,z$_.stroke,z$R):z$r.fillText(z$d,z$l,z$W,z$s,this.color,z$R)}if(z$t&&z$t.autoScaleSize){var z$I=1/z$G;this.scale(z$I,z$I)}this._clipPoint&&z$r.restore(),this._startX=z$c,this._startY=z$b},z$V.drawUnderline=function(z$V,z$U,z$r,z$s){var z$p=this._lineWidths[z$s];switch(z$V){case"center":z$U-=z$p/2;break;case"right":z$U-=z$p}z$r+=this._charSize.height,this._graphics.drawLine(z$U,z$r,z$U+z$p,z$r,this.underlineColor||this.color,1)},z$V.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);z$j.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new z$D(0,0)):this._clipPoint=null;var z$V=this._lines.length;if(this.overflow!=z$G.VISIBLE){var z$U=this.overflow==z$G.HIDDEN?Math.floor:Math.ceil;z$V=Math.min(z$V,z$U((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var z$r=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(z$r,z$V),this.repaint()},z$V.evalTextSize=function(){var z$V,z$U=NaN;z$V=Math.max.apply(this,this._lineWidths),z$U=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],z$V==this._textWidth&&z$U==this._textHeight||(this._textWidth=z$V,this._textHeight=z$U,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},z$V.checkEnabledViewportOrNot=function(){return this.overflow==z$G.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},z$V.changeText=function(z$V){this._text!==z$V&&(this.lang(z$V+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},z$V.parseLines=function(z$V){var z$U=this.wordWrap||this.overflow==z$G.HIDDEN;if(z$U)var z$r=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var z$s=z$v.contextMeasureText(z$G._testWord);z$m.isConchApp&&0===z$s.width&&0===z$s.height&&(z$s=z$v.contextMeasureText("W")),this._charSize.width=z$s.width,this._charSize.height=z$s.height||this.fontSize}for(var z$p=z$V.replace(/\r\n/g,"\n").split("\n"),z$c=0,z$R=z$p.length;z$c<z$R;z$c++){var z$T=z$p[z$c];z$U?this.parseLine(z$T,z$r):(this._lineWidths.push(this.getTextWidth(z$T)),this._lines.push(z$T))}},z$V.parseLine=function(z$V,z$U){z$j.context;var z$r,z$s=this._lines,z$p=0,z$c=NaN,z$R=NaN,z$T=0;if((z$c=this.getTextWidth(z$V))<=z$U)return z$s.push(z$V),void this._lineWidths.push(z$c);z$c=this._charSize.width,0==(z$p=Math.floor(z$U/z$c))&&(z$p=1),z$R=z$c=this.getTextWidth(z$V.substring(0,z$p));for(var z$N=z$p,z$t=z$V.length;z$N<z$t;z$N++)if(z$U<(z$R+=z$c=this.getTextWidth(z$V.charAt(z$N))))if(this.wordWrap){var z$b=z$V.substring(z$T,z$N);if(z$b.charCodeAt(z$b.length-1)<255?(z$r=/(?:\w|-)+$/.exec(z$b))&&(z$N=z$r.index+z$T,0==z$r.index?z$N+=z$b.length:z$b=z$V.substring(z$T,z$N)):z$G.RightToLeft&&(z$r=/([\u0600-\u06FF])+$/.exec(z$b))&&(z$N=z$r.index+z$T,0==z$r.index?z$N+=z$b.length:z$b=z$V.substring(z$T,z$N)),z$s.push(z$b),this._lineWidths.push(z$R-z$c),!((z$T=z$N)+z$p<z$t)){z$s.push(z$V.substring(z$T,z$t)),this._lineWidths.push(this.getTextWidth(z$s[z$s.length-1])),z$T=-1;break}z$N+=z$p,z$R=z$c=this.getTextWidth(z$V.substring(z$T,z$N)),z$N--}else if(this.overflow==z$G.HIDDEN)return z$s.push(z$V.substring(0,z$N)),void this._lineWidths.push(this.getTextWidth(z$s[z$s.length-1]));this.wordWrap&&-1!=z$T&&(z$s.push(z$V.substring(z$T,z$t)),this._lineWidths.push(this.getTextWidth(z$s[z$s.length-1])))},z$V.getTextWidth=function(z$V){return this._currBitmapFont?this._currBitmapFont.getTextWidth(z$V):z$v.contextMeasureText(z$V).width},z$V.getWordWrapWidth=function(){var z$V=this.padding,z$U=NaN;return(z$U=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(z$U=this.wordWrap?100:z$j.width),z$U<=0&&(z$U=100),z$U-z$V[3]-z$V[1]},z$V.getCharPoint=function(z$V,z$U){this._isChanged&&z$y.timer.runCallLater(this,this.typeset);for(var z$r=0,z$s=this._lines,z$p=0,z$c=0,z$R=z$s.length;z$c<z$R;z$c++){if(z$V<(z$r+=z$s[z$c].length)){var z$T=z$c;break}z$p=z$r}var z$N=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;z$j.context.font=z$N;var z$t=this.getTextWidth(this._text.substring(z$p,z$V));return(z$U||new z$D).setTo(this._startX+z$t-(this._clipPoint?this._clipPoint.x:0),this._startY+z$T*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},z$q(0,z$V,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(z$V){z$V!=this._width&&(z$y.superSet(z$SV,this,"width",z$V),this.isChanged=!0)}),z$q(0,z$V,"textWidth",function(){return this._isChanged&&z$y.timer.runCallLater(this,this.typeset),this._textWidth}),z$q(0,z$V,"height",function(){return this._height?this._height:this.textHeight},function(z$V){z$V!=this._height&&(z$y.superSet(z$SV,this,"height",z$V),this.isChanged=!0)}),z$q(0,z$V,"textHeight",function(){return this._isChanged&&z$y.timer.runCallLater(this,this.typeset),this._textHeight}),z$q(0,z$V,"padding",function(){return this._getCSSStyle().padding},function(z$V){this._getCSSStyle().padding=z$V,this.isChanged=!0}),z$q(0,z$V,"bold",function(){return this._getCSSStyle().bold},function(z$V){this._getCSSStyle().bold=z$V,this.isChanged=!0}),z$q(0,z$V,"text",function(){return this._text||""},function(z$V){this._text!==z$V&&(this.lang(z$V+""),this.isChanged=!0,this.event("change"))}),z$q(0,z$V,"color",function(){return this._getCSSStyle().color},function(z$V){this._getCSSStyle().color!=z$V&&(this._getCSSStyle().color=z$V,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),z$q(0,z$V,"font",function(){return this._getCSSStyle().fontFamily},function(z$V){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),z$G._bitmapFonts&&z$G._bitmapFonts[z$V]&&(this._currBitmapFont=z$G._bitmapFonts[z$V]),this._getCSSStyle().fontFamily=z$V,this.isChanged=!0}),z$q(0,z$V,"fontSize",function(){return this._getCSSStyle().fontSize},function(z$V){this._getCSSStyle().fontSize=z$V,this.isChanged=!0}),z$q(0,z$V,"italic",function(){return this._getCSSStyle().italic},function(z$V){this._getCSSStyle().italic=z$V,this.isChanged=!0}),z$q(0,z$V,"align",function(){return this._getCSSStyle().align},function(z$V){this._getCSSStyle().align=z$V,this.isChanged=!0}),z$q(0,z$V,"valign",function(){return this._getCSSStyle().valign},function(z$V){this._getCSSStyle().valign=z$V,this.isChanged=!0}),z$q(0,z$V,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(z$V){this._getCSSStyle().wordWrap=z$V,this.isChanged=!0}),z$q(0,z$V,"leading",function(){return this._getCSSStyle().leading},function(z$V){this._getCSSStyle().leading=z$V,this.isChanged=!0}),z$q(0,z$V,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(z$V){this._getCSSStyle().backgroundColor=z$V,this.isChanged=!0}),z$q(0,z$V,"borderColor",function(){return this._getCSSStyle().borderColor},function(z$V){this._getCSSStyle().borderColor=z$V,this.isChanged=!0}),z$q(0,z$V,"stroke",function(){return this._getCSSStyle().stroke},function(z$V){this._getCSSStyle().stroke=z$V,this.isChanged=!0}),z$q(0,z$V,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(z$V){this._getCSSStyle().strokeColor=z$V,this.isChanged=!0}),z$q(0,z$V,"isChanged",null,function(z$V){this._isChanged!==z$V&&(this._isChanged=z$V)&&z$y.timer.callLater(this,this.typeset)}),z$q(0,z$V,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(z$V){if(!(this.overflow!=z$G.SCROLL||this.textWidth<this._width)&&this._clipPoint){z$V=z$V<this.padding[3]?this.padding[3]:z$V;var z$U=this._textWidth-this._width;z$V=z$U<z$V?z$U:z$V;var z$r=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=z$V,this.renderText(this._lastVisibleLineIndex,z$r)}}),z$q(0,z$V,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(z$V){if(!(this.overflow!=z$G.SCROLL||this.textHeight<this._height)&&this._clipPoint){z$V=z$V<this.padding[0]?this.padding[0]:z$V;var z$U=this._textHeight-this._height,z$r=(z$V=z$U<z$V?z$U:z$V)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=z$r;var z$s=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=z$V,this.renderText(z$r,z$s)}}),z$q(0,z$V,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),z$q(0,z$V,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),z$q(0,z$V,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),z$q(0,z$V,"underlineColor",function(){return this._underlineColor},function(z$V){this._underlineColor=z$V,this._isChanged=!0,this.typeset()}),z$G.registerBitmapFont=function(z$V,z$U){z$G._bitmapFonts||(z$G._bitmapFonts={}),z$G._bitmapFonts[z$V]=z$U},z$G.unregisterBitmapFont=function(z$V,z$U){if(void 0===z$U&&(z$U=!0),z$G._bitmapFonts&&z$G._bitmapFonts[z$V]){var z$r=z$G._bitmapFonts[z$V];z$U&&z$r.destroy(),delete z$G._bitmapFonts[z$V]}},z$G.setTextRightToLeft=function(){var z$V;(z$V=z$j.canvas.source.style).display="none",z$V.position="absolute",z$V.direction="rtl",z$m._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,z$j.document.body.appendChild(z$j.canvas.source)},z$G.supportFont=function(z$V){z$j.context.font="10px sans-serif";var z$U=z$v.contextMeasureText("abcji").width;z$j.context.font="10px "+z$V;var z$r=z$v.contextMeasureText("abcji").width;return console.log(z$U,z$r),z$U!==z$r},z$G._testWord="游",z$G.langPacks=null,z$G.VISIBLE="visible",z$G.SCROLL="scroll",z$G.HIDDEN="hidden",z$G.CharacterCache=!0,z$G.RightToLeft=!1,z$G._bitmapFonts=null,z$N(z$G,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),z$G}(z$SV),z$lV=function(z$S){function z$R(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",z$R.__super.call(this),this.offset=new z$D,this._canvasTransform=new z$z,this._previousOrientation=z$j.window.orientation;var z$U=this;this.transform=z$z.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var z$V=z$j.window,z$r=this;z$V.addEventListener("focus",function(){z$U._isFocused=!0,z$r.event("focus"),z$r.event("focuschange")}),z$V.addEventListener("blur",function(){z$U._isFocused=!1,z$r.event("blur"),z$r.event("focuschange"),z$r._isInputting()&&(z$dV.inputElement.target.focus=!1)});var z$s="visibilityState",z$p="visibilitychange",z$c=z$V.document;void 0!==z$c.hidden?(z$p="visibilitychange",z$s="visibilityState"):void 0!==z$c.mozHidden?(z$p="mozvisibilitychange",z$s="mozVisibilityState"):void 0!==z$c.msHidden?(z$p="msvisibilitychange",z$s="msVisibilityState"):void 0!==z$c.webkitHidden&&(z$p="webkitvisibilitychange",z$s="webkitVisibilityState"),z$V.document.addEventListener(z$p,function(){"hidden"==z$j.document[z$s]?z$r._setStageVisible(!1):z$r._setStageVisible(!0)}),z$V.document.addEventListener("qbrowserVisibilityChange",function(z$V){z$r._setStageVisible(!z$V.hidden)}),z$V.addEventListener("resize",function(){var z$V=z$j.window.orientation;null!=z$V&&z$V!=z$U._previousOrientation&&z$r._isInputting()&&(z$dV.inputElement.target.focus=!1),z$U._previousOrientation=z$V,z$r._isInputting()||z$r._resetCanvas()}),z$V.addEventListener("orientationchange",function(z$V){z$r._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),z$j.onMobile&&this.on("mousedown",this,this._onmouseMove)}z$b(z$R,"laya.display.Stage",z$S);var z$V=z$R.prototype;return z$V._setStageVisible=function(z$V){this._isVisibility!=z$V&&(this._isVisibility=z$V,this._isVisibility||this._isInputting()&&(z$dV.inputElement.target.focus=!1),this.event("visibilitychange"))},z$V._isInputting=function(){return z$j.onMobile&&z$dV.isInputting},z$V._changeCanvasSize=function(){this.setScreenSize(z$j.clientWidth*z$j.pixelRatio,z$j.clientHeight*z$j.pixelRatio)},z$V._resetCanvas=function(){if(this.screenAdaptationEnabled){var z$V=z$m._mainCanvas;z$V.source.style;z$V.size(1,1),z$y.timer.once(100,this,this._changeCanvasSize)}},z$V.setScreenSize=function(z$V,z$U){var z$r=!1;if("none"!==this._screenMode&&(z$r=(z$V/z$U<1?"vertical":"horizontal")!==this._screenMode)){var z$s=z$U;z$U=z$V,z$V=z$s}this.canvasRotation=z$r;var z$p=z$m._mainCanvas,z$c=z$p.source.style,z$R=this._canvasTransform.identity(),z$T=this._scaleMode,z$N=z$V/this.designWidth,z$t=z$U/this.designHeight,z$b=this.designWidth,z$S=this.designHeight,z$_=z$V,z$G=z$U,z$q=z$j.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,z$T){case"noscale":z$N=z$t=1,z$_=this.designWidth,z$G=this.designHeight;break;case"showall":z$N=z$t=Math.min(z$N,z$t),z$b=z$_=Math.round(this.designWidth*z$N),z$S=z$G=Math.round(this.designHeight*z$t);break;case"noborder":z$N=z$t=Math.max(z$N,z$t),z$_=Math.round(this.designWidth*z$N),z$G=Math.round(this.designHeight*z$t);break;case"full":z$N=z$t=1,this._width=z$b=z$V,this._height=z$S=z$U;break;case"fixedwidth":z$t=z$N,this._height=z$S=Math.round(z$U/z$N);break;case"fixedheight":z$N=z$t,this._width=z$b=Math.round(z$V/z$t);break;case"fixedauto":z$V/z$U<this.designWidth/this.designHeight?(z$t=z$N,this._height=z$S=Math.round(z$U/z$N)):(z$N=z$t,this._width=z$b=Math.round(z$V/z$t))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,z$b=z$b+1&2147483646,z$S=z$S+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),z$N*=this.scaleX,z$t*=this.scaleY,1===z$N&&1===z$t?this.transform.identity():(this.transform.a=this._formatData(z$N/(z$_/z$b)),this.transform.d=this._formatData(z$t/(z$G/z$S)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),z$p.size(z$b,z$S),z$w.changeWebGLSize(z$b,z$S),z$R.scale(z$_/z$b/z$q,z$G/z$S/z$q),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(z$V-z$_)/z$q:this.offset.x=.5*(z$V-z$_)/z$q,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(z$U-z$G)/z$q:this.offset.y=.5*(z$U-z$G)/z$q,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),z$R.translate(this.offset.x,this.offset.y),this.canvasDegree=0,z$r&&("horizontal"===this._screenMode?(z$R.rotate(Math.PI/2),z$R.translate(z$U/z$q,0),this.canvasDegree=90):(z$R.rotate(-Math.PI/2),z$R.translate(0,z$V/z$q),this.canvasDegree=-90)),z$R.a=this._formatData(z$R.a),z$R.d=this._formatData(z$R.d),z$R.tx=this._formatData(z$R.tx),z$R.ty=this._formatData(z$R.ty),z$c.transformOrigin=z$c.webkitTransformOrigin=z$c.msTransformOrigin=z$c.mozTransformOrigin=z$c.oTransformOrigin="0px 0px 0px",z$c.transform=z$c.webkitTransform=z$c.msTransform=z$c.mozTransform=z$c.oTransform="matrix("+z$R.toString()+")",z$R.translate(parseInt(z$c.left)||0,parseInt(z$c.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},z$V._formatData=function(z$V){return Math.abs(z$V)<1e-6?0:Math.abs(1-z$V)<.001?0<z$V?1:-1:z$V},z$V.getMousePoint=function(){return z$D.TEMP.setTo(this.mouseX,this.mouseY)},z$V.repaint=function(){this._repaint=1},z$V.parentRepaint=function(){},z$V._loop=function(){return this.render(z$m.context,0,0),!0},z$V._onmouseMove=function(z$V){this._mouseMoveTime=z$j.now()},z$V.getTimeFromFrameStart=function(){return z$j.now()-this._frameStartTime},z$V.render=function(z$V,z$U,z$r){if("sleep"===this._frameRate&&!z$m.isConchApp){var z$s=z$j.now();if(!(1e3<=z$s-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(z$e.loopCount++,z$u.instance.runEvent(),z$y.timer._update()));this._frameStartTime=z$s}if(this._renderCount++,z$m.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=z$j.now();var z$p="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),z$c=this._renderCount%2==0;if(z$e.renderSlow=!z$p,z$p||z$c||z$m.isConchApp){var z$R;z$e.loopCount++,z$u.instance.runEvent(),z$y.timer._update(),z$w.update3DLoop();var z$T=0,z$N=0;if(z$m.isConchNode)for(z$T=0,z$N=this._scenes.length;z$T<z$N;z$T++)(z$R=this._scenes[z$T])&&z$R._updateSceneConch();else for(z$T=0,z$N=this._scenes.length;z$T<z$N;z$T++)(z$R=this._scenes[z$T])&&z$R._updateScene();if(z$m.isConchNode){var z$t=z$SV.CustomList;for(z$T=0,z$N=z$t.length;z$T<z$N;z$T++){var z$b=z$t[z$T];z$b.customRender(z$b.customContext,0,0)}return}}z$m.isConchNode||this.renderingEnabled&&(z$p||!z$c||z$m.isConchWebGL)&&(z$m.isWebGL?z$m.WebGL.mainContext&&!z$m.WebGL.mainContext.isContextLost()&&(z$V.clear(),z$S.prototype.render.call(this,z$V,z$U,z$r),z$e._show&&z$e._sp&&z$e._sp.render(z$V,z$U,z$r),z$w.clear(this._bgColor),z$w.beginFlush(),z$V.flush(),z$w.endFinish(),z$Y.instance&&z$Y.getInstance().endDispose()):(z$w.clear(this._bgColor),z$S.prototype.render.call(this,z$V,z$U,z$r),z$e._show&&z$e._sp&&z$e._sp.render(z$V,z$U,z$r)))}else this._renderCount%5==0&&(z$e.loopCount++,z$u.instance.runEvent(),z$y.timer._update())},z$V._requestFullscreen=function(){var z$V=z$j.document.documentElement;z$V.requestFullscreen?z$V.requestFullscreen():z$V.mozRequestFullScreen?z$V.mozRequestFullScreen():z$V.webkitRequestFullscreen?z$V.webkitRequestFullscreen():z$V.msRequestFullscreen&&z$V.msRequestFullscreen()},z$V._fullScreenChanged=function(){z$y.stage.event("fullscreenchange")},z$V.exitFullscreen=function(){var z$V=z$j.document;z$V.exitFullscreen?z$V.exitFullscreen():z$V.mozCancelFullScreen?z$V.mozCancelFullScreen():z$V.webkitExitFullscreen&&z$V.webkitExitFullscreen()},z$q(0,z$V,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),z$q(0,z$V,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),z$q(0,z$V,"frameRate",function(){return this._frameRate},function(z$V){if(this._frameRate=z$V,z$m.isConchApp)switch(this._frameRate){case"slow":z$j.window.conch&&z$j.window.conchConfig.setSlowFrame&&z$j.window.conchConfig.setSlowFrame(!0);break;case"fast":z$j.window.conch&&z$j.window.conchConfig.setSlowFrame&&z$j.window.conchConfig.setSlowFrame(!1);break;case"mouse":z$j.window.conch&&z$j.window.conchConfig.setMouseFrame&&z$j.window.conchConfig.setMouseFrame(2e3);break;case"sleep":z$j.window.conch&&z$j.window.conchConfig.setLimitFPS&&z$j.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),z$q(0,z$V,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),z$q(0,z$V,"width",z$S.prototype._$get_width,function(z$V){this.designWidth=z$V,z$y.superSet(z$SV,this,"width",z$V),z$y.timer.callLater(this,this._changeCanvasSize)}),z$q(0,z$V,"alignH",function(){return this._alignH},function(z$V){this._alignH=z$V,z$y.timer.callLater(this,this._changeCanvasSize)}),z$q(0,z$V,"isFocused",function(){return this._isFocused}),z$q(0,z$V,"height",z$S.prototype._$get_height,function(z$V){this.designHeight=z$V,z$y.superSet(z$SV,this,"height",z$V),z$y.timer.callLater(this,this._changeCanvasSize)}),z$q(0,z$V,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||z$z.create()},z$S.prototype._$set_transform),z$q(0,z$V,"isVisibility",function(){return this._isVisibility}),z$q(0,z$V,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),z$q(0,z$V,"scaleMode",function(){return this._scaleMode},function(z$V){this._scaleMode=z$V,z$y.timer.callLater(this,this._changeCanvasSize)}),z$q(0,z$V,"alignV",function(){return this._alignV},function(z$V){this._alignV=z$V,z$y.timer.callLater(this,this._changeCanvasSize)}),z$q(0,z$V,"bgColor",function(){return this._bgColor},function(z$V){this._bgColor=z$V,this.conchModel&&this.conchModel.bgColor(z$V),z$m.isWebGL&&(z$V?z$R._wgColor=z$B.create(z$V)._color:z$j.onMiniGame||(z$R._wgColor=null)),z$j.onLimixiu?z$R._wgColor=z$B.create(z$V)._color:z$m.canvas.style.background=z$V||"none"}),z$q(0,z$V,"mouseX",function(){return Math.round(z$u.instance.mouseX/this.clientScaleX)}),z$q(0,z$V,"mouseY",function(){return Math.round(z$u.instance.mouseY/this.clientScaleY)}),z$q(0,z$V,"screenMode",function(){return this._screenMode},function(z$V){this._screenMode=z$V}),z$q(0,z$V,"visible",z$S.prototype._$get_visible,function(z$V){this.visible!==z$V&&(z$y.superSet(z$SV,this,"visible",z$V),z$m._mainCanvas.source.style.visibility=z$V?"visible":"hidden")}),z$q(0,z$V,"fullScreenEnabled",null,function(z$V){var z$U=z$j.document,z$r=z$m.canvas;z$V?(z$r.addEventListener("mousedown",this._requestFullscreen),z$r.addEventListener("touchstart",this._requestFullscreen),z$U.addEventListener("fullscreenchange",this._fullScreenChanged),z$U.addEventListener("mozfullscreenchange",this._fullScreenChanged),z$U.addEventListener("webkitfullscreenchange",this._fullScreenChanged),z$U.addEventListener("msfullscreenchange",this._fullScreenChanged)):(z$r.removeEventListener("mousedown",this._requestFullscreen),z$r.removeEventListener("touchstart",this._requestFullscreen),z$U.removeEventListener("fullscreenchange",this._fullScreenChanged),z$U.removeEventListener("mozfullscreenchange",this._fullScreenChanged),z$U.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),z$U.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),z$R.SCALE_NOSCALE="noscale",z$R.SCALE_EXACTFIT="exactfit",z$R.SCALE_SHOWALL="showall",z$R.SCALE_NOBORDER="noborder",z$R.SCALE_FULL="full",z$R.SCALE_FIXED_WIDTH="fixedwidth",z$R.SCALE_FIXED_HEIGHT="fixedheight",z$R.SCALE_FIXED_AUTO="fixedauto",z$R.ALIGN_LEFT="left",z$R.ALIGN_RIGHT="right",z$R.ALIGN_CENTER="center",z$R.ALIGN_TOP="top",z$R.ALIGN_MIDDLE="middle",z$R.ALIGN_BOTTOM="bottom",z$R.SCREEN_NONE="none",z$R.SCREEN_HORIZONTAL="horizontal",z$R.SCREEN_VERTICAL="vertical",z$R.FRAME_FAST="fast",z$R.FRAME_SLOW="slow",z$R.FRAME_MOUSE="mouse",z$R.FRAME_SLEEP="sleep",z$R.FRAME_MOUSE_THREDHOLD=2e3,z$N(z$R,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),z$R}(z$SV),z$WV=(function(z$V){function z$U(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,z$U.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}z$b(z$U,"laya.media.SoundNode",z$SV);var z$r=z$U.prototype;z$r._onParentChange=function(){this.target=this.parent},z$r.play=function(z$V,z$U){void 0===z$V&&(z$V=1),isNaN(z$V)&&(z$V=1),this.url&&(this.stop(),this._channel=z$H.playSound(this.url,z$V,null,z$U))},z$r.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},z$r._setPlayAction=function(z$V,z$U,z$r,z$s){void 0===z$s&&(z$s=!0),this[z$r]&&z$V&&(z$s?z$V.on(z$U,this,this[z$r]):z$V.off(z$U,this,this[z$r]))},z$r._setPlayActions=function(z$V,z$U,z$r,z$s){if(void 0===z$s&&(z$s=!0),z$V&&z$U){var z$p,z$c=z$U.split(","),z$R=0;for(z$p=z$c.length,z$R=0;z$R<z$p;z$R++)this._setPlayAction(z$V,z$c[z$R],z$r,z$s)}},z$q(0,z$r,"playEvent",null,function(z$V){(this._playEvents=z$V)&&this._tar&&this._setPlayActions(this._tar,z$V,"play")}),z$q(0,z$r,"target",null,function(z$V){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=z$V,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),z$q(0,z$r,"stopEvent",null,function(z$V){(this._stopEvents=z$V)&&this._tar&&this._setPlayActions(this._tar,z$V,"stop")})}(),function(z$V){function z$U(){this._src=null,this._onload=null,this._onerror=null,z$U.__super.call(this)}z$b(z$U,"laya.resource.FileBitmap",z$qV);var z$r=z$U.prototype;return z$q(0,z$r,"src",function(){return this._src},function(z$V){this._src=z$V}),z$q(0,z$r,"onload",null,function(z$V){}),z$q(0,z$r,"onerror",null,function(z$V){}),z$U}()),z$OV=function(z$V){function z$r(z$V,z$U){this._is2D=!1,z$r.__super.call(this);var z$s=this;if(this._source=this,"2D"===z$V||"AUTO"===z$V&&!z$m.isWebGL){this._is2D=!0,this._source=z$U||z$j.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var z$p=this;z$p.getContext=function(z$V,z$U){if(z$s._ctx)return z$s._ctx;var z$r=z$s._ctx=z$s._source.getContext(z$V,z$U);return z$r&&(z$r._canvas=z$p,z$m.isFlash||z$j.onLimixiu||(z$r.size=function(z$V,z$U){})),z$r}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}z$b(z$r,"laya.resource.HTMLCanvas",z$qV);var z$U=z$r.prototype;return z$U.clear=function(){this._ctx&&this._ctx.clear()},z$U.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},z$U.release=function(){},z$U._setContext=function(z$V){this._ctx=z$V},z$U.getContext=function(z$V,z$U){return this._ctx?this._ctx:this._ctx=z$r._createContext(this)},z$U.getMemSize=function(){return 0},z$U.size=function(z$V,z$U){(this._w!=z$V||this._h!=z$U||this._source&&(this._source.width!=z$V||this._source.height!=z$U))&&(this._w=z$V,this._h=z$U,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(z$V,z$U),this._source&&(this._source.height=z$U,this._source.width=z$V))},z$U.getCanvas=function(){return this._source},z$U.toBase64=function(z$V,z$U,z$r){if(this._source)if(z$m.isConchApp&&this._source.toBase64)this._source.toBase64(z$V,z$U,z$r);else{var z$s=this._source.toDataURL(z$V,z$U);z$r.call(this,z$s)}},z$q(0,z$U,"context",function(){return this._ctx}),z$q(0,z$U,"asBitmap",null,function(z$V){}),z$r.create=function(z$V,z$U){return new z$r(z$V,z$U)},z$r.TYPE2D="2D",z$r.TYPE3D="3D",z$r.TYPEAUTO="AUTO",z$r._createContext=null,z$r}(),z$LV=(function(z$V){function z$N(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){throw z$N.__super.call(this),new Error("不允许new！")}z$b(z$N,"laya.resource.HTMLSubImage",z$qV),z$N.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){return void 0===z$T&&(z$T=!1),new z$N(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T)}}(),function(z$V){function z$S(){this._frames=null,this._url=null,z$S.__super.call(this),this._setControlNode(this)}z$b(z$S,"laya.display.Animation",z$V);var z$U=z$S.prototype;z$U.destroy=function(z$V){void 0===z$V&&(z$V=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,z$V),this._frames=null,this._labels=null},z$U.play=function(z$V,z$U,z$r,z$s){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=!0),void 0===z$r&&(z$r=""),void 0===z$s&&(z$s=!0),z$r&&this._setFramesFromCache(z$r,z$s),this._isPlaying=!0,this.index="string"==typeof z$V?this._getFrameByLabel(z$V):z$V,this.loop=z$U,this._actionName=z$r,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},z$U._setFramesFromCache=function(z$V,z$U){var z$r;return void 0===z$U&&(z$U=!1),this._url&&(z$V=this._url+"#"+z$V),z$V&&z$S.framesMap[z$V]?((z$r=z$S.framesMap[z$V])instanceof Array?(this._frames=z$S.framesMap[z$V],this._count=this._frames.length):(z$r.nodeRoot&&(z$S.framesMap[z$V]=this._parseGraphicAnimationByData(z$r),z$r=z$S.framesMap[z$V]),this._frames=z$r.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=z$r.interval),this._labels=this._copyLabels(z$r.labels)),!0):(z$U&&console.log("ani not found:",z$V),!1)},z$U._copyLabels=function(z$V){if(!z$V)return null;var z$U,z$r;for(z$r in z$U={},z$V)z$U[z$r]=z$v.copyArray([],z$V[z$r]);return z$U},z$U._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&z$V.prototype._frameLoop.call(this)},z$U._displayToIndex=function(z$V){this._frames&&(this.graphics=this._frames[z$V])},z$U.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},z$U.loadImages=function(z$V,z$U){return void 0===z$U&&(z$U=""),this._url="",this._setFramesFromCache(z$U)||(this.frames=z$S.framesMap[z$U]?z$S.framesMap[z$U]:z$S.createFrames(z$V,z$U)),this},z$U.loadAtlas=function(z$U,z$r,z$s){void 0===z$s&&(z$s=""),this._url="";var z$p=this;function z$V(z$V){z$U===z$V&&(z$p.frames=z$S.framesMap[z$s]?z$S.framesMap[z$s]:z$S.createFrames(z$U,z$s),z$r&&z$r.run())}return z$p._setFramesFromCache(z$s)||(z$TV.getAtlas(z$U)?z$V(z$U):z$y.loader.load(z$U,z$W.create(null,z$V,[z$U]),null,"atlas")),this},z$U.loadAnimation=function(z$V,z$U,z$r){this._url=z$V;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,z$U&&z$U.run()):!z$r||z$TV.getAtlas(z$r)?this._loadAnimationData(z$V,z$U,z$r):z$y.loader.load(z$r,z$W.create(this,this._loadAnimationData,[z$V,z$U,z$r]),null,"atlas"),this},z$U._loadAnimationData=function(z$T,z$N,z$V){var z$t=this;if(!z$V||z$TV.getAtlas(z$V)){var z$b=this;z$TV.getRes(z$T)?z$U(z$T):z$y.loader.load(z$T,z$W.create(null,z$U,[z$T]),null,"json"),z$TV.clearRes(z$T)}else console.warn("atlas load fail:"+z$V);function z$U(z$V){if(z$TV.getRes(z$V)&&z$T===z$V){var z$U;if(z$S.framesMap[z$T+"#"])z$b._setFramesFromCache(z$t._actionName,!0),z$t.index=0,z$t._checkResumePlaying();else{var z$r=z$b._parseGraphicAnimation(z$TV.getRes(z$T));if(!z$r)return;var z$s,z$p=z$r.animationList,z$c=0,z$R=z$p.length;for(z$c=0;z$c<z$R;z$c++)z$U=z$p[z$c],z$S.framesMap[z$T+"#"+z$U.name]=z$U,z$s||(z$s=z$U);z$s&&(z$S.framesMap[z$T+"#"]=z$s,z$b._setFramesFromCache(z$t._actionName,!0),z$t.index=0),z$t._checkResumePlaying()}z$N&&z$N.run()}}},z$U._parseGraphicAnimation=function(z$V){return z$yV.parseAnimationData(z$V)},z$U._parseGraphicAnimationByData=function(z$V){return z$yV.parseAnimationByData(z$V)},z$q(0,z$U,"frames",function(){return this._frames},function(z$V){(this._frames=z$V)&&(this._count=z$V.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),z$q(0,z$U,"autoPlay",null,function(z$V){z$V?this.play():this.stop()}),z$q(0,z$U,"source",null,function(z$V){-1<z$V.indexOf(".ani")?this.loadAnimation(z$V):-1<z$V.indexOf(".json")||-1<z$V.indexOf("als")||-1<z$V.indexOf("atlas")?this.loadAtlas(z$V):this.loadImages(z$V.split(","))}),z$q(0,z$U,"autoAnimation",null,function(z$V){this.play(0,!0,z$V,!1)}),z$S.createFrames=function(z$V,z$U){var z$r,z$s,z$p=0,z$c=0;if("string"==typeof z$V){var z$R=z$TV.getAtlas(z$V);if(z$R&&z$R.length)for(z$r=[],z$p=0,z$c=z$R.length;z$p<z$c;z$p++)(z$s=new z$w.createGraphics).drawTexture(z$TV.getRes(z$R[z$p]),0,0),z$r.push(z$s)}else if(z$V instanceof Array)for(z$r=[],z$p=0,z$c=z$V.length;z$p<z$c;z$p++)(z$s=new z$w.createGraphics).loadImage(z$V[z$p],0,0),z$r.push(z$s);return z$U&&(z$S.framesMap[z$U]=z$r),z$r},z$S.clearCache=function(z$V){var z$U,z$r=z$S.framesMap,z$s=z$V+"#";for(z$U in z$r)z$U!==z$V&&0!=z$U.indexOf(z$s)||delete z$S.framesMap[z$U]},z$S.framesMap={}}(z$uV),function(z$V){function z$c(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,z$c.__super.call(this),null==z$c._sortIndexFun&&(z$c._sortIndexFun=z$k.sortByKey("index",!1,!0))}z$b(z$c,"laya.display.FrameAnimation",z$V);var z$U=z$c.prototype;return z$U._setUp=function(z$V,z$U){this._labels=null,this._animationNewFrames=null,this._targetDic=z$V,this._animationData=z$U,this.interval=1e3/z$U.frameRate,z$U.parsed?(this._count=z$U.count,this._labels=z$U.labels,this._animationNewFrames=z$U.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),z$U.parsed=!0,z$U.labels=this._labels,z$U.count=this._count,z$U.animationNewFrames=this._animationNewFrames},z$U.clear=function(){z$V.prototype.clear.call(this),this._targetDic=null,this._animationData=null},z$U._displayToIndex=function(z$V){if(this._animationData){z$V<0&&(z$V=0),z$V>this._count&&(z$V=this._count);var z$U=this._animationData.nodes,z$r=0,z$s=z$U.length;for(z$r=0;z$r<z$s;z$r++)this._displayNodeToFrame(z$U[z$r],z$V)}},z$U._displayNodeToFrame=function(z$V,z$U,z$r){z$r||(z$r=this._targetDic);var z$s=z$r[z$V.target];if(z$s){var z$p,z$c,z$R,z$T=z$V.frames,z$N=z$V.keys,z$t=0,z$b=z$N.length;for(z$t=0;z$t<z$b;z$t++)z$R=(z$c=z$T[z$p=z$N[z$t]]).length>z$U?z$c[z$U]:z$c[z$c.length-1],z$s[z$p]=z$R}},z$U._calculateDatas=function(){if(this._animationData){var z$V,z$U=this._animationData.nodes,z$r=0,z$s=z$U.length;for(z$r=this._count=0;z$r<z$s;z$r++)z$V=z$U[z$r],this._calculateNodeKeyFrames(z$V);this._count+=1}},z$U._calculateNodeKeyFrames=function(z$V){var z$U,z$r,z$s=z$V.keyframes,z$p=z$V.target;for(z$U in z$V.frames||(z$V.frames={}),z$V.keys?z$V.keys.length=0:z$V.keys=[],z$V.initValues||(z$V.initValues={}),z$s)z$r=z$s[z$U],z$V.frames[z$U]||(z$V.frames[z$U]=[]),this._targetDic&&this._targetDic[z$p]&&(z$V.initValues[z$U]=this._targetDic[z$p][z$U]),z$r.sort(z$c._sortIndexFun),z$V.keys.push(z$U),this._calculateNodePropFrames(z$r,z$V.frames[z$U],z$U,z$p)},z$U.resetToInitState=function(){if(this._targetDic&&this._animationData){var z$V,z$U,z$r=this._animationData.nodes,z$s=0,z$p=z$r.length;for(z$s=0;z$s<z$p;z$s++)if(z$U=(z$V=z$r[z$s]).initValues){var z$c,z$R=this._targetDic[z$V.target];if(z$R)for(z$c in z$U)z$R[z$c]=z$U[z$c]}}},z$U._calculateNodePropFrames=function(z$V,z$U,z$r,z$s){var z$p=0,z$c=z$V.length-1;if(0<z$c){for(z$U.length=z$V[z$c].index+1,z$p=0;z$p<z$c;z$p++)this._dealKeyFrame(z$V[z$p]),this._calculateFrameValues(z$V[z$p],z$V[z$p+1],z$U);this._dealKeyFrame(z$V[z$p])}0==z$c&&(z$U[z$V[0].index]=z$V[0].value,this._animationNewFrames&&(this._animationNewFrames[z$V[0].index]=!0))},z$U._dealKeyFrame=function(z$V){z$V.label&&""!=z$V.label&&this.addLabel(z$V.label,z$V.index)},z$U._calculateFrameValues=function(z$V,z$U,z$r){var z$s,z$p=0,z$c=z$V.index,z$R=z$U.index,z$T=z$V.value,z$N=z$U.value-z$V.value,z$t=z$R-z$c;if(z$R>this._count&&(this._count=z$R),z$V.tween)for(null==(z$s=z$M[z$V.tweenMethod])&&(z$s=z$M.linearNone),z$p=z$c;z$p<z$R;z$p++)z$r[z$p]=z$s(z$p-z$c,z$T,z$N,z$t),this._animationNewFrames&&(this._animationNewFrames[z$p]=!0);else for(z$p=z$c;z$p<z$R;z$p++)z$r[z$p]=z$T;this._animationNewFrames&&(this._animationNewFrames[z$V.index]=!0,this._animationNewFrames[z$U.index]=!0),z$r[z$U.index]=z$U.value},z$c._sortIndexFun=null,z$c}(z$uV)),z$dV=function(z$U){function z$p(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",z$p.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=z$hV.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}z$b(z$p,"laya.display.Input",z$U);var z$V=z$p.prototype;return z$V.setSelection=function(z$V,z$U){this.focus=!0,laya.display.Input.inputElement.selectionStart=z$V,laya.display.Input.inputElement.selectionEnd=z$U},z$V._onUnDisplay=function(z$V){this.focus=!1},z$V._onMouseDown=function(z$V){this.focus=!0},z$V._syncInputTransform=function(){var z$V=this.nativeInput,z$U=z$v.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),z$r=this._width-this.padding[1]-this.padding[3],z$s=this._height-this.padding[0]-this.padding[2];z$m.isConchApp?(z$V.setScale(z$U.scaleX,z$U.scaleY),z$V.setSize(z$r,z$s),z$V.setPos(z$U.x,z$U.y)):(z$p.inputContainer.style.transform=z$p.inputContainer.style.webkitTransform="scale("+z$U.scaleX+","+z$U.scaleY+") rotate("+z$y.stage.canvasDegree+"deg)",z$V.style.width=z$r+"px",z$V.style.height=z$s+"px",z$p.inputContainer.style.left=z$U.x+"px",z$p.inputContainer.style.top=z$U.y+"px")},z$V.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},z$V._setInputMethod=function(){z$p.input.parentElement&&z$p.inputContainer.removeChild(z$p.input),z$p.area.parentElement&&z$p.inputContainer.removeChild(z$p.area),z$p.inputElement=this._multiline?z$p.area:z$p.input,z$p.inputContainer.appendChild(z$p.inputElement),z$hV.RightToLeft&&(z$p.inputElement.style.direction="rtl")},z$V._focusIn=function(){laya.display.Input.isInputting=!0;var z$V=this.nativeInput;this._focus=!0;var z$U=z$V.style;z$U.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),z$V.readOnly=!this._editable,z$m.isConchApp&&(z$V.setType(this._type),z$V.setForbidEdit(!this._editable)),z$V.maxLength=this._maxChars;this.padding;if(z$V.type=this._type,z$V.value=this._content,z$V.placeholder=this._prompt,z$y.stage.off("keydown",this,this._onKeyDown),z$y.stage.on("keydown",this,this._onKeyDown),(z$y.stage.focus=this).event("focus"),z$j.onPC&&z$V.focus(),!z$j.onMiniGame){this._text;this._text=null}this.typeset(),z$V.setColor(this._originColor),z$V.setFontSize(this.fontSize),z$V.setFontFace(z$j.onIPhone&&z$hV._fontFamilyMap[this.font]||this.font),z$m.isConchApp&&z$V.setMultiAble&&z$V.setMultiAble(this._multiline),z$U.lineHeight=this.leading+this.fontSize+"px",z$U.fontStyle=this.italic?"italic":"normal",z$U.fontWeight=this.bold?"bold":"normal",z$U.textAlign=this.align,z$U.padding="0 0",this._syncInputTransform(),!z$m.isConchApp&&z$j.onPC&&z$y.timer.frameLoop(1,this,this._syncInputTransform)},z$V._setPromptColor=function(){(z$p.promptStyleDOM=z$j.getElementById("promptStyle"))||((z$p.promptStyleDOM=z$j.createElement("style")).setAttribute("id","promptStyle"),z$j.document.head.appendChild(z$p.promptStyleDOM)),z$p.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},z$V._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(z$y.superSet(z$hV,this,"text",this._content),z$y.superSet(z$hV,this,"color",this._originColor)):(z$y.superSet(z$hV,this,"text",this._prompt),z$y.superSet(z$hV,this,"color",this._promptColor)),z$y.stage.off("keydown",this,this._onKeyDown),z$y.stage.focus=null,this.event("blur"),z$m.isConchApp&&this.nativeInput.blur(),z$j.onPC&&z$y.timer.clear(this,this._syncInputTransform)},z$V._onKeyDown=function(z$V){13===z$V.keyCode&&(z$j.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},z$V.changeText=function(z$V){this._content=z$V,this._focus?(this.nativeInput.value=z$V||"",this.event("change")):z$U.prototype.changeText.call(this,z$V)},z$q(0,z$V,"color",z$U.prototype._$get_color,function(z$V){this._focus&&this.nativeInput.setColor(z$V),z$y.superSet(z$hV,this,"color",this._content?z$V:this._promptColor),this._originColor=z$V}),z$q(0,z$V,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(z$V){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),z$q(0,z$V,"multiline",function(){return this._multiline},function(z$V){this._multiline=z$V,this.valign=z$V?"top":"middle"}),z$q(0,z$V,"maxChars",function(){return this._maxChars},function(z$V){z$V<=0&&(z$V=1e5),this._maxChars=z$V}),z$q(0,z$V,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(z$V){z$y.superSet(z$hV,this,"color",this._originColor),z$V+="",this._focus?(this.nativeInput.value=z$V||"",this.event("change")):(this._multiline||(z$V=z$V.replace(/\r?\n/g,"")),(this._content=z$V)?z$y.superSet(z$hV,this,"text",z$V):(z$y.superSet(z$hV,this,"text",this._prompt),z$y.superSet(z$hV,this,"color",this.promptColor)))}),z$q(0,z$V,"nativeInput",function(){return this._multiline?z$p.area:z$p.input}),z$q(0,z$V,"prompt",function(){return this._prompt},function(z$V){!this._text&&z$V&&z$y.superSet(z$hV,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?z$y.superSet(z$hV,this,"text",this._text==this._prompt?z$V:this._text):z$y.superSet(z$hV,this,"text",z$V),this._prompt=z$hV.langPacks&&z$hV.langPacks[z$V]?z$hV.langPacks[z$V]:z$V}),z$q(0,z$V,"focus",function(){return this._focus},function(z$V){var z$U=this.nativeInput;this._focus!==z$V&&(z$V?(z$U.target?z$U.target._focusOut():this._setInputMethod(),(z$U.target=this)._focusIn()):(z$U.target=null,this._focusOut(),z$j.document.body.scrollTop=0,z$U.blur(),z$m.isConchApp?z$U.setPos(-1e4,-1e4):z$p.inputContainer.contains(z$U)&&z$p.inputContainer.removeChild(z$U)))}),z$q(0,z$V,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(z$V){z$V?(-1<(z$V="[^"+z$V+"]").indexOf("^^")&&(z$V=z$V.replace("^^","")),this._restrictPattern=new RegExp(z$V,"g")):this._restrictPattern=null}),z$q(0,z$V,"editable",function(){return this._editable},function(z$V){this._editable=z$V,z$m.isConchApp&&z$p.input.setForbidEdit(!z$V)}),z$q(0,z$V,"promptColor",function(){return this._promptColor},function(z$V){this._promptColor=z$V,this._content||z$y.superSet(z$hV,this,"color",z$V)}),z$q(0,z$V,"type",function(){return this._type},function(z$V){this._getCSSStyle().password="password"==z$V,this._type=z$V,z$m.isConchApp&&this.nativeInput.setType(z$V)}),z$q(0,z$V,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(z$V){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),z$q(0,z$V,"asPassword",function(){return this._getCSSStyle().password},function(z$V){this._getCSSStyle().password=z$V,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),z$p.__init__=function(){z$p._createInputElement(),z$j.onMobile&&z$m.canvas.addEventListener(z$p.IOS_IFRAME?z$j.onMiniGame?"touchend":"click":"touchend",z$p._popupInputMethod)},z$p._popupInputMethod=function(z$V){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},z$p._createInputElement=function(){z$p._initInput(z$p.area=z$j.createElement("textarea")),z$p._initInput(z$p.input=z$j.createElement("input")),(z$p.inputContainer=z$j.createElement("div")).style.position="absolute",z$p.inputContainer.style.zIndex=1e5,z$j.container.appendChild(z$p.inputContainer),z$p.inputContainer.setPos=function(z$V,z$U){z$p.inputContainer.style.left=z$V+"px",z$p.inputContainer.style.top=z$U+"px"}},z$p._initInput=function(z$U){var z$V=z$U.style;z$V.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",z$V.resize="none",z$V.backgroundColor="transparent",z$V.border="none",z$V.outline="none",z$V.zIndex=1,z$U.addEventListener("input",z$p._processInputting),z$U.addEventListener("mousemove",z$p._stopEvent),z$U.addEventListener("mousedown",z$p._stopEvent),z$U.addEventListener("touchmove",z$p._stopEvent),z$U.setFontFace=function(z$V){z$U.style.fontFamily=z$V},z$m.isConchApp||(z$U.setColor=function(z$V){z$U.style.color=z$V},z$U.setFontSize=function(z$V){z$U.style.fontSize=z$V+"px"})},z$p._processInputting=function(z$V){var z$U=laya.display.Input.inputElement.target;if(z$U){var z$r=laya.display.Input.inputElement.value;z$U._restrictPattern&&(z$r=z$r.replace(/\u2006|\x27/g,""),z$U._restrictPattern.test(z$r)&&(z$r=z$r.replace(z$U._restrictPattern,""),laya.display.Input.inputElement.value=z$r)),z$U._text=z$r,z$U.event("input")}},z$p._stopEvent=function(z$V){"touchmove"==z$V.type&&z$V.preventDefault(),z$V.stopPropagation&&z$V.stopPropagation()},z$p.TYPE_TEXT="text",z$p.TYPE_PASSWORD="password",z$p.TYPE_EMAIL="email",z$p.TYPE_URL="url",z$p.TYPE_NUMBER="number",z$p.TYPE_RANGE="range",z$p.TYPE_DATE="date",z$p.TYPE_MONTH="month",z$p.TYPE_WEEK="week",z$p.TYPE_TIME="time",z$p.TYPE_DATE_TIME="datetime",z$p.TYPE_DATE_TIME_LOCAL="datetime-local",z$p.TYPE_SEARCH="search",z$p.input=null,z$p.area=null,z$p.inputElement=null,z$p.inputContainer=null,z$p.confirmButton=null,z$p.promptStyleDOM=null,z$p.inputHeight=45,z$p.isInputting=!1,z$p.stageMatrix=null,z$N(z$p,["IOS_IFRAME",function(){return this.IOS_IFRAME=z$j.onIOS&&z$j.window.top!=z$j.window.self}]),z$p}(z$hV),z$kV=function(z$V){function z$r(z$V,z$U){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,z$r.__super.call(this),z$V&&this._init_(z$V,z$U)}z$b(z$r,"laya.resource.HTMLImage",z$WV);var z$U=z$r.prototype;return z$U._init_=function(z$V,z$U){this._src=z$V,this._source=new z$j.window.Image,z$U&&(z$U.onload&&(this.onload=z$U.onload),z$U.onerror&&(this.onerror=z$U.onerror),z$U.onCreate&&z$U.onCreate(this)),0!=z$V.indexOf("data:image")&&(this._source.crossOrigin=""),z$V&&(this._source.src=z$V)},z$U.recreateResource=function(){var z$V=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var z$U=this;this._source=new z$j.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(z$U._needReleaseAgain)return z$U._needReleaseAgain=!1,z$U._source.onload=null,void(z$U._source=null);z$U._source.onload=null,z$U.memorySize=z$V._w*z$V._h*4,z$U._recreateLock=!1,z$U.completeCreate()},this._source.src=this._src}},z$U.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},z$U.onresize=function(){this._w=this._source.width,this._h=this._source.height},z$q(0,z$U,"onload",null,function(z$V){var z$U=this;this._onload=z$V,this._source&&(this._source.onload=null!=this._onload?function(){z$U.onresize(),z$U._onload()}:null)}),z$q(0,z$U,"onerror",null,function(z$V){var z$U=this;this._onerror=z$V,this._source&&(this._source.onerror=null!=this._onerror?function(){z$U._onerror()}:null)}),z$q(0,z$U,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(z$V){this._enableMerageInAtlas=z$V,z$m.isConchApp&&this._source&&(this._source.enableMerageInAtlas=z$V)}),z$r.create=function(z$V,z$U){return new z$r(z$V,z$U)},z$r}(),z$yV=(function(z$c){function z$V(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,z$V.__super.call(this)}z$b(z$V,"laya.display.EffectAnimation",z$c);var z$U=z$V.prototype;z$U._onOtherBegin=function(z$V){z$V!=this&&this.stop()},z$U.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},z$U._onPlayAction=function(){this.play(0,!1)},z$U.play=function(z$V,z$U,z$r,z$s){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=!0),void 0===z$r&&(z$r=""),void 0===z$s&&(z$s=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,z$V,z$U,z$r,z$s))},z$U._recordInitData=function(){if(this._aniKeys){var z$V,z$U,z$r=0;for(z$V=this._aniKeys.length,z$r=0;z$r<z$V;z$r++)z$U=this._aniKeys[z$r],this._initData[z$U]=this._target[z$U]}},z$U._displayToIndex=function(z$V){if(this._animationData){z$V<0&&(z$V=0),z$V>this._count&&(z$V=this._count);var z$U=this._animationData.nodes,z$r=0,z$s=z$U.length;for(z$s=1<z$s?1:z$s,z$r=0;z$r<z$s;z$r++)this._displayNodeToFrame(z$U[z$r],z$V)}},z$U._displayNodeToFrame=function(z$V,z$U,z$r){if(this._target){var z$s;z$s=this._target;var z$p,z$c,z$R,z$T,z$N=z$V.frames,z$t=z$V.keys,z$b=0,z$S=z$t.length;z$T=z$V.secondFrames;var z$_,z$G,z$q,z$u,z$h=0;for(z$b=0;z$b<z$S;z$b++)z$c=z$N[z$p=z$t[z$b]],z$R=-1==(z$h=z$T[z$p])?this._initData[z$p]:z$U<z$h?(z$q=(z$G=z$V.keyframes[z$p])[0]).tween?(null==(z$_=z$M[z$q.tweenMethod])&&(z$_=z$M.linearNone),z$u=z$G[1],z$_(z$U,this._initData[z$p],z$u.value-this._initData[z$p],z$u.index)):this._initData[z$p]:z$c.length>z$U?z$c[z$U]:z$c[z$c.length-1],z$s[z$p]=z$R}},z$U._calculateNodeKeyFrames=function(z$V){z$c.prototype._calculateNodeKeyFrames.call(this,z$V);var z$U,z$r,z$s,z$p=z$V.keyframes;z$V.target;for(z$U in z$s={},z$V.secondFrames=z$s,z$p)(z$r=z$p[z$U]).length<=1?z$s[z$U]=-1:z$s[z$U]=z$r[1].index},z$q(0,z$U,"target",function(){return this._target},function(z$V){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=z$V,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),z$q(0,z$U,"playEvent",null,function(z$V){(this._playEvents=z$V)&&this.addEvent()}),z$q(0,z$U,"effectData",null,function(z$V){var z$U;z$V&&((z$U=z$V.animations)&&z$U[0]&&(this._setUp({},z$U[0]),z$U[0].nodes&&z$U[0].nodes[0]&&(this._aniKeys=z$U[0].nodes[0].keys)))}),z$q(0,z$U,"effectClass",null,function(z$V){var z$U,z$r;(this._effectClass=z$i.getClass(z$V),this._effectClass)&&((z$U=this._effectClass.uiView)&&(z$r=z$U.animations)&&z$r[0]&&(this._setUp({},z$r[0]),z$r[0].nodes&&z$r[0].nodes[0]&&(this._aniKeys=z$r[0].nodes[0].keys)))}),z$V.EffectAnimationBegin="effectanimationbegin"}(z$LV),function(z$U){var z$Q;function z$H(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,z$H.__super.call(this)}z$b(z$H,"laya.utils.GraphicAnimation",z$U);var z$V=z$H.prototype;return z$V._parseNodeList=function(z$V){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[z$V.compId]=z$V.props,z$V.compId&&this._nodeList.push(z$V.compId);var z$U=z$V.child;if(z$U){var z$r=0,z$s=z$U.length;for(z$r=0;z$r<z$s;z$r++)this._parseNodeList(z$U[z$r])}},z$V._calGraphicData=function(z$V){var z$U;if(this._setUp(null,z$V),this._createGraphicData(),this._nodeIDAniDic)for(z$U in this._nodeIDAniDic)this._nodeIDAniDic[z$U]=null},z$V._createGraphicData=function(){var z$V,z$U=[],z$r=0,z$s=this.count,z$p=this._animationNewFrames;for(z$p||(z$p=[]),z$r=0;z$r<z$s;z$r++)!z$p[z$r]&&z$V||(z$V=this._createFrameGraphic(z$r)),z$U.push(z$V);this._gList=z$U},z$V._createFrameGraphic=function(z$V){var z$U=z$w.createGraphics();return z$H._rootMatrix||(z$H._rootMatrix=new z$z),this._updateNodeGraphic(this._rootNode,z$V,z$H._rootMatrix,z$U),z$U},z$V._updateNodeGraphic=function(z$V,z$U,z$r,z$s,z$p){var z$c;void 0===z$p&&(z$p=1);var z$R,z$T,z$N,z$t=(z$c=this._nodeGDic[z$V.compId]=this._getNodeGraphicData(z$V.compId,z$U,this._nodeGDic[z$V.compId])).alpha*z$p;if(!(z$t<.01)&&(z$c.resultTransform||(z$c.resultTransform=z$z.create()),z$R=z$c.resultTransform,z$z.mul(z$c.transform,z$r,z$R),z$c.skin&&(z$T=this._getTextureByUrl(z$c.skin))&&(z$R._checkTransform()?(z$s.drawTexture(z$T,0,0,z$c.width,z$c.height,z$R,z$t),z$c.resultTransform=null):z$s.drawTexture(z$T,z$R.tx,z$R.ty,z$c.width,z$c.height,null,z$t)),z$N=z$V.child)){var z$b,z$S=0;for(z$b=z$N.length,z$S=0;z$S<z$b;z$S++)this._updateNodeGraphic(z$N[z$S],z$U,z$R,z$s,z$t)}},z$V._updateNoChilds=function(z$V,z$U){if(z$V.skin){var z$r=this._getTextureByUrl(z$V.skin);if(z$r){var z$s=z$V.transform;z$s._checkTransform();!z$s.bTransform?z$U.drawTexture(z$r,z$s.tx,z$s.ty,z$V.width,z$V.height,null,z$V.alpha):z$U.drawTexture(z$r,0,0,z$V.width,z$V.height,z$s.clone(),z$V.alpha)}}},z$V._updateNodeGraphic2=function(z$V,z$U,z$r){var z$s;if(z$s=this._nodeGDic[z$V.compId]=this._getNodeGraphicData(z$V.compId,z$U,this._nodeGDic[z$V.compId]),z$V.child){var z$p=z$s.transform;z$p._checkTransform();var z$c,z$R;z$R=(z$c=!z$p.bTransform)&&(0!=z$p.tx||0!=z$p.ty);var z$T,z$N,z$t;if((z$T=z$p.bTransform||1!=z$s.alpha)&&z$r.save(),1!=z$s.alpha&&z$r.alpha(z$s.alpha),z$c?z$R&&z$r.translate(z$p.tx,z$p.ty):z$r.transform(z$p.clone()),z$N=z$V.child,z$s.skin&&(z$t=this._getTextureByUrl(z$s.skin))&&z$r.drawTexture(z$t,0,0,z$s.width,z$s.height),z$N){var z$b,z$S=0;for(z$b=z$N.length,z$S=0;z$S<z$b;z$S++)this._updateNodeGraphic2(z$N[z$S],z$U,z$r)}z$T?z$r.restore():z$c?z$R&&z$r.translate(-z$p.tx,-z$p.ty):z$r.transform(z$p.clone().invert())}else this._updateNoChilds(z$s,z$r)},z$V._calculateNodeKeyFrames=function(z$V){z$U.prototype._calculateNodeKeyFrames.call(this,z$V),this._nodeIDAniDic[z$V.target]=z$V},z$V.getNodeDataByID=function(z$V){return this._nodeIDAniDic[z$V]},z$V._getParams=function(z$V,z$U,z$r,z$s){var z$p=z$H._temParam;z$p.length=z$U.length;var z$c=0,z$R=z$U.length;for(z$c=0;z$c<z$R;z$c++)z$p[z$c]=this._getObjVar(z$V,z$U[z$c][0],z$r,z$U[z$c][1],z$s);return z$p},z$V._getObjVar=function(z$V,z$U,z$r,z$s,z$p){if(z$V.hasOwnProperty(z$U)){var z$c=z$V[z$U];if(z$r>=z$c.length&&(z$r=z$c.length-1),null!=z$V[z$U][z$r])return z$V[z$U][z$r]}return z$p.hasOwnProperty(z$U)?z$p[z$U]:z$s},z$V._getNodeGraphicData=function(z$V,z$U,z$r){z$r||(z$r=z$Q.create()),z$r.transform?z$r.transform.identity():z$r.transform=z$z.create();var z$s=this.getNodeDataByID(z$V);if(!z$s)return z$r;var z$p,z$c,z$R=z$s.frames,z$T=this._getParams(z$R,z$H._drawTextureCmd,z$U,this._nodeDefaultProps[z$V]),z$N=z$T[0],z$t=NaN,z$b=NaN,z$S=z$T[5],z$_=z$T[6],z$G=z$T[13],z$q=z$T[14],z$u=z$T[7],z$h=z$T[8],z$l=z$T[9],z$W=z$T[11],z$O=z$T[12];z$t=z$T[3],z$b=z$T[4],0!=z$t&&0!=z$b||(z$N=null),-1==z$t&&(z$t=0),-1==z$b&&(z$b=0),z$r.skin=z$N,z$r.width=z$t,z$r.height=z$b,z$N&&((z$p=this._getTextureByUrl(z$N))?(z$t||(z$t=z$p.sourceWidth),z$b||(z$b=z$p.sourceHeight)):console.warn("lost skin:",z$N,",you may load pics first")),z$r.alpha=z$T[10],z$c=z$r.transform,0!=z$G&&(z$S=z$G*z$t),0!=z$q&&(z$_=z$q*z$b),0==z$S&&0==z$_||z$c.translate(-z$S,-z$_);var z$L=null;if(z$l||1!==z$u||1!==z$h||z$W||z$O){(z$L=z$H._tempMt).identity(),z$L.bTransform=!0;var z$d=.0174532922222222*(z$l-z$W),z$k=.0174532922222222*(z$l+z$O),z$y=Math.cos(z$k),z$D=Math.sin(z$k),z$n=Math.sin(z$d),z$I=Math.cos(z$d);z$L.a=z$u*z$y,z$L.b=z$u*z$D,z$L.c=-z$h*z$n,z$L.d=z$h*z$I,z$L.tx=z$L.ty=0}return z$L&&(z$c=z$z.mul(z$c,z$L,z$c)),z$c.translate(z$T[1],z$T[2]),z$r},z$V._getTextureByUrl=function(z$V){return z$TV.getRes(z$V)},z$V.setAniData=function(z$V,z$U){if(z$V.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=z$V,this._parseNodeList(z$V);var z$r,z$s={},z$p=[],z$c=z$V.animations,z$R=0,z$T=z$c.length;for(z$R=0;z$R<z$T;z$R++)if(z$r=z$c[z$R],this._labels=null,(!z$U||z$U==z$r.name)&&z$r){try{this._calGraphicData(z$r)}catch(z$V){console.warn("parse animation fail:"+z$r.name+",empty animation created"),this._gList=[]}var z$N={};z$N.interval=1e3/z$r.frameRate,z$N.frames=this._gList,z$N.labels=this._labels,z$N.name=z$r.name,z$p.push(z$N),z$s[z$r.name]=z$N}this.animationList=z$p,this.animationDic=z$s}z$H._temParam.length=0},z$V.parseByData=function(z$V){var z$U,z$r;z$U=z$V.nodeRoot,z$r=z$V.aniO,delete z$V.nodeRoot,delete z$V.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=z$U,this._parseNodeList(z$U),this._labels=null;try{this._calGraphicData(z$r)}catch(z$V){console.warn("parse animation fail:"+z$r.name+",empty animation created"),this._gList=[]}var z$s=z$V;return z$s.interval=1e3/z$r.frameRate,z$s.frames=this._gList,z$s.labels=this._labels,z$s.name=z$r.name,z$s},z$V.setUpAniData=function(z$V){if(z$V.animations){var z$U,z$r={},z$s=[],z$p=z$V.animations,z$c=0,z$R=z$p.length;for(z$c=0;z$c<z$R;z$c++)if(z$U=z$p[z$c]){var z$T={};z$T.name=z$U.name,z$T.aniO=z$U,z$T.nodeRoot=z$V,z$s.push(z$T),z$r[z$U.name]=z$T}this.animationList=z$s,this.animationDic=z$r}},z$V._clear=function(){var z$V,z$U;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(z$V in this._nodeGDic)(z$U=this._nodeGDic[z$V])&&z$U.recover();this._nodeGDic=null},z$H.parseAnimationByData=function(z$V){var z$U;return z$H._I||(z$H._I=new z$H),z$U=z$H._I.parseByData(z$V),z$H._I._clear(),z$U},z$H.parseAnimationData=function(z$V){var z$U;return z$H._I||(z$H._I=new z$H),z$H._I.setUpAniData(z$V),(z$U={}).animationList=z$H._I.animationList,z$U.animationDic=z$H._I.animationDic,z$H._I._clear(),z$U},z$H._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],z$H._temParam=[],z$H._I=null,z$H._rootMatrix=null,z$N(z$H,["_tempMt",function(){return this._tempMt=new z$z}]),z$H.__init$=function(){z$Q=function(){function z$V(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return z$b(z$V,""),z$V.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),z$X.recover("GraphicNode",this)},z$V.create=function(){return z$X.getItemByClass("GraphicNode",z$V)},z$V}()},z$H}(z$LV));z$y.__init([z$t,z$NV,z$m,z$j,z$F,z$I,z$V,z$yV])}(window,document,Laya),function(z$V,z$U,z$r){z$r.un,z$r.uns,z$r.static;var z$s=z$r.class;z$r.getset,z$r.__newvec;new(function(){function z$V(){}return z$s(z$V,"LayaMain"),z$V}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}}),function(z$V,z$U,z$k){z$k.un,z$k.uns;var z$R=z$k.static,z$_=z$k.class,z$s=z$k.getset,z$c=z$k.__newvec,z$b=laya.maths.Arith,z$S=laya.maths.Bezier,z$r=laya.resource.Bitmap,z$G=laya.utils.Browser,z$N=laya.utils.Byte,z$q=laya.utils.Color,z$y=(laya.filters.ColorFilter,z$k.Config),z$p=laya.resource.Context,z$D=(laya.events.Event,laya.filters.Filter),z$T=laya.display.Graphics,z$t=laya.resource.HTMLCanvas,z$u=(laya.utils.HTMLChar,laya.resource.HTMLImage),z$h=laya.resource.HTMLSubImage,z$n=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),z$I=laya.maths.Point,z$Q=laya.maths.Rectangle,z$l=laya.renders.Render,z$W=(laya.renders.RenderContext,laya.renders.RenderSprite),z$O=laya.resource.Resource,z$L=laya.resource.ResourceManager,z$d=laya.utils.RunDriver,z$H=laya.display.Sprite,z$w=laya.display.Stage,z$z=laya.utils.Stat,z$E=laya.utils.StringKey,z$K=(laya.display.css.Style,laya.system.System),z$m=laya.display.Text,z$a=laya.resource.Texture,z$Z=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),z$x=laya.utils.VectorGraphManager;laya.utils.WordText;z$k.interface("laya.webgl.shapes.IShape"),z$k.interface("laya.webgl.submit.ISubmit"),z$k.interface("laya.webgl.text.ICharSegment"),z$k.interface("laya.webgl.canvas.save.ISaveData"),z$k.interface("laya.webgl.resource.IMergeAtlasBitmap"),z$k.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var z$$=function(){function z$V(){}z$_(z$V,"laya.filters.webgl.FilterActionGL");var z$U=z$V.prototype;return z$k.imps(z$U,{"laya.filters.IFilterActionGL":!0}),z$U.setValue=function(z$V){},z$U.setValueMix=function(z$V){},z$U.apply3d=function(z$V,z$U,z$r,z$s,z$p){return null},z$U.apply=function(z$V){return null},z$s(0,z$U,"typeMix",function(){return 0}),z$V}(),z$j=function(){function z$V(){}return z$_(z$V,"laya.webgl.shader.ShaderValue"),z$V}(),z$o=function(){var z$s,z$p;function z$V(z$V,z$U,z$r){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new z$p,void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),this._cells=null,this._rowInfo=null,this._init(z$V,z$U),this._atlasID=z$r}z$_(z$V,"laya.webgl.atlas.AtlasGrid");var z$U=z$V.prototype;return z$U.getAltasID=function(){return this._atlasID},z$U.setAltasID=function(z$V){0<=z$V&&(this._atlasID=z$V)},z$U.addTex=function(z$V,z$U,z$r){var z$s=this._get(z$U,z$r);return 0==z$s.ret||(this._fill(z$s.x,z$s.y,z$U,z$r,z$V),this._texCount++),z$s},z$U._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},z$U._init=function(z$V,z$U){if(this._width=z$V,this._height=z$U,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=z$c(this._height);for(var z$r=0;z$r<this._height;z$r++)this._rowInfo[z$r]=new z$s;return this._clear(),!0},z$U._get=function(z$V,z$U){var z$r=new z$i;if(z$V>=this._failSize.width&&z$U>=this._failSize.height)return z$r;for(var z$s=-1,z$p=-1,z$c=this._width,z$R=this._height,z$T=this._cells,z$N=0;z$N<z$R;z$N++)if(!(this._rowInfo[z$N].spaceCount<z$V))for(var z$t=0;z$t<z$c;){var z$b=3*(z$N*z$c+z$t);if(0!=z$T[z$b]||z$T[1+z$b]<z$V||z$T[2+z$b]<z$U)z$t+=z$T[1+z$b];else{z$s=z$t,z$p=z$N;for(var z$S=0;z$S<z$V;z$S++)if(z$T[3*z$S+z$b+2]<z$U){z$s=-1;break}if(!(z$s<0))return z$r.ret=!0,z$r.x=z$s,z$r.y=z$p,z$r;z$t+=z$T[1+z$b]}}return z$r},z$U._fill=function(z$V,z$U,z$r,z$s,z$p){var z$c=this._width,z$R=this._height;this._check(z$V+z$r<=z$c&&z$U+z$s<=z$R);for(var z$T=z$U;z$T<z$s+z$U;++z$T){this._check(this._rowInfo[z$T].spaceCount>=z$r),this._rowInfo[z$T].spaceCount-=z$r;for(var z$N=0;z$N<z$r;z$N++){var z$t=3*(z$V+z$T*z$c+z$N);this._check(0==this._cells[z$t]),this._cells[z$t]=z$p,this._cells[1+z$t]=z$r,this._cells[2+z$t]=z$s}}if(0<z$V)for(z$T=0;z$T<z$s;++z$T){var z$b=0;for(z$N=z$V-1;0<=z$N&&0==this._cells[3*((z$U+z$T)*z$c+z$N)];--z$N,++z$b);for(z$N=z$b;0<z$N;--z$N)this._cells[3*((z$U+z$T)*z$c+z$V-z$N)+1]=z$N,this._check(0<z$N)}if(0<z$U)for(z$N=z$V;z$N<z$V+z$r;++z$N){for(z$b=0,z$T=z$U-1;0<=z$T&&0==this._cells[3*(z$N+z$T*z$c)];--z$T,z$b++);for(z$T=z$b;0<z$T;--z$T)this._cells[3*(z$N+(z$U-z$T)*z$c)+2]=z$T,this._check(0<z$T)}},z$U._check=function(z$V){0==z$V&&console.log("xtexMerger 错误啦")},z$U._clear=function(){for(var z$V=this._texCount=0;z$V<this._height;z$V++)this._rowInfo[z$V].spaceCount=this._width;for(var z$U=0;z$U<this._height;z$U++)for(var z$r=0;z$r<this._width;z$r++){var z$s=3*(z$U*this._width+z$r);this._cells[z$s]=0,this._cells[1+z$s]=this._width-z$r,this._cells[2+z$s]=this._width-z$U}this._failSize.width=this._width+1,this._failSize.height=this._height+1},z$V.__init$=function(){z$s=function(){function z$V(){this.spaceCount=0}return z$_(z$V,""),z$V}(),z$p=function(){function z$V(){this.width=0,this.height=0}return z$_(z$V,""),z$V}()},z$V}(),z$J=function(){function z$l(z$V,z$U,z$r,z$s){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=z$V,this._height=z$U,this._gridSize=z$r,this._maxAtlaserCount=z$s,this._gridNumX=z$V/z$r,this._gridNumY=z$U/z$r,this._curAtlasIndex=0,this._atlaserArray=[]}z$_(z$l,"laya.webgl.atlas.AtlasResourceManager");var z$V=z$l.prototype;return z$V.setAtlasParam=function(z$V,z$U,z$r,z$s){if(1==this._setAtlasParam)return z$l._sid_=0,this._width=z$V,this._height=z$U,this._gridSize=z$r,this._maxAtlaserCount=z$s,this._gridNumX=z$V/z$r,this._gridNumY=z$U/z$r,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},z$V.pushData=function(z$V){var z$U,z$r=z$V.bitmap,z$s=-1,z$p=null,z$c=0,z$R=0;for(z$c=0,z$U=this._atlaserArray.length;z$c<z$U&&(z$R=(this._curAtlasIndex+z$c)%z$U,-1==(z$s=(z$p=this._atlaserArray[z$R]).findBitmapIsExist(z$r)));z$c++);if(-1!=z$s){var z$T=z$p.InAtlasWebGLImagesOffsetValue[z$s];return z$q=z$T[0],z$u=z$T[1],z$p.addToAtlas(z$V,z$q,z$u),!0}this._setAtlasParam=!1;for(var z$N=Math.ceil((z$V.bitmap.width+2)/this._gridSize),z$t=Math.ceil((z$V.bitmap.height+2)/this._gridSize),z$b=!1,z$S=0;z$S<2;z$S++){var z$_=this._maxAtlaserCount;for(z$c=0;z$c<z$_;z$c++){z$R=(this._curAtlasIndex+z$c)%z$_,this._atlaserArray.length-1>=z$R||this._atlaserArray.push(new z$QV(this._gridNumX,this._gridNumY,this._width,this._height,z$l._sid_++));var z$G=this._atlaserArray[z$R],z$q=0,z$u=0,z$h=z$G.addTex(1,z$N,z$t);if(z$h.ret){z$q=z$h.x*this._gridSize+1,z$u=z$h.y*this._gridSize+1,z$r.lock=!0,z$G.addToAtlasTexture(z$r,z$q,z$u),z$G.addToAtlas(z$V,z$q,z$u),z$b=!0,this._curAtlasIndex=z$R;break}}if(z$b)break;this._atlaserArray.push(new z$QV(this._gridNumX,this._gridNumY,this._width,this._height,z$l._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return z$b||console.log(">>>AtlasManager pushData error"),z$b},z$V.addToAtlas=function(z$V){laya.webgl.atlas.AtlasResourceManager.instance.pushData(z$V)},z$V.garbageCollection=function(){if(!0===this._needGC){for(var z$V=this._atlaserArray.length-this._maxAtlaserCount,z$U=0;z$U<z$V;z$U++)this._atlaserArray[z$U].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+z$V),this._atlaserArray.splice(0,z$V),this._needGC=!1}return!0},z$V.freeAll=function(){for(var z$V=0,z$U=this._atlaserArray.length;z$V<z$U;z$V++)this._atlaserArray[z$V].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},z$V.getAtlaserCount=function(){return this._atlaserArray.length},z$V.getAtlaserByIndex=function(z$V){return this._atlaserArray[z$V]},z$s(1,z$l,"instance",function(){return z$l._Instance||(z$l._Instance=new z$l(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),z$l._Instance}),z$s(1,z$l,"enabled",function(){return z$y.atlasEnable}),z$s(1,z$l,"atlasLimitWidth",function(){return z$l._atlasLimitWidth},function(z$V){z$l._atlasLimitWidth=z$V}),z$s(1,z$l,"atlasLimitHeight",function(){return z$l._atlasLimitHeight},function(z$V){z$l._atlasLimitHeight=z$V}),z$l._enable=function(){z$y.atlasEnable=!0},z$l._disable=function(){z$y.atlasEnable=!1},z$l.__init__=function(){z$l.atlasTextureWidth=2048,z$l.atlasTextureHeight=2048,z$l.maxTextureCount=6,z$l.atlasLimitWidth=512,z$l.atlasLimitHeight=512},z$l._atlasLimitWidth=0,z$l._atlasLimitHeight=0,z$l.gridSize=16,z$l.atlasTextureWidth=0,z$l.atlasTextureHeight=0,z$l.maxTextureCount=0,z$l._atlasRestore=0,z$l.BOARDER_TYPE_NO=0,z$l.BOARDER_TYPE_RIGHT=1,z$l.BOARDER_TYPE_LEFT=2,z$l.BOARDER_TYPE_BOTTOM=4,z$l.BOARDER_TYPE_TOP=8,z$l.BOARDER_TYPE_ALL=15,z$l._sid_=0,z$l._Instance=null,z$l}(),z$i=function(){function z$V(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return z$_(z$V,"laya.webgl.atlas.MergeFillInfo"),z$V}(),z$B=function(){function z$U(){}return z$_(z$U,"laya.webgl.canvas.BlendMode"),z$U._init_=function(z$V){z$U.fns=[z$U.BlendNormal,z$U.BlendAdd,z$U.BlendMultiply,z$U.BlendScreen,z$U.BlendOverlay,z$U.BlendLight,z$U.BlendMask,z$U.BlendDestinationOut],z$U.targetFns=[z$U.BlendNormalTarget,z$U.BlendAddTarget,z$U.BlendMultiplyTarget,z$U.BlendScreenTarget,z$U.BlendOverlayTarget,z$U.BlendLightTarget,z$U.BlendMask,z$U.BlendDestinationOut]},z$U.BlendNormal=function(z$V){z$V.blendFunc(1,771)},z$U.BlendAdd=function(z$V){z$V.blendFunc(1,772)},z$U.BlendMultiply=function(z$V){z$V.blendFunc(774,771)},z$U.BlendScreen=function(z$V){z$V.blendFunc(1,1)},z$U.BlendOverlay=function(z$V){z$V.blendFunc(1,769)},z$U.BlendLight=function(z$V){z$V.blendFunc(1,1)},z$U.BlendNormalTarget=function(z$V){z$V.blendFunc(1,771)},z$U.BlendAddTarget=function(z$V){z$V.blendFunc(1,772)},z$U.BlendMultiplyTarget=function(z$V){z$V.blendFunc(774,771)},z$U.BlendScreenTarget=function(z$V){z$V.blendFunc(1,1)},z$U.BlendOverlayTarget=function(z$V){z$V.blendFunc(1,769)},z$U.BlendLightTarget=function(z$V){z$V.blendFunc(1,1)},z$U.BlendMask=function(z$V){z$V.blendFunc(0,770)},z$U.BlendDestinationOut=function(z$V){z$V.blendFunc(0,0)},z$U.activeBlendFunction=null,z$U.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],z$U.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},z$U.NORMAL="normal",z$U.ADD="add",z$U.MULTIPLY="multiply",z$U.SCREEN="screen",z$U.LIGHT="light",z$U.OVERLAY="overlay",z$U.DESTINATIONOUT="destination-out",z$U.fns=[],z$U.targetFns=[],z$U}(),z$P=function(){function z$r(z$V){this._color=z$q.create("black"),this.setValue(z$V)}z$_(z$r,"laya.webgl.canvas.DrawStyle");var z$V=z$r.prototype;return z$V.setValue=function(z$V){if(z$V){if("string"==typeof z$V)return void(this._color=z$q.create(z$V));if(z$V instanceof laya.utils.Color)return void(this._color=z$V)}},z$V.reset=function(){this._color=z$q.create("black")},z$V.equal=function(z$V){return"string"==typeof z$V?this._color.strColor===z$V:z$V instanceof laya.utils.Color&&this._color.numColor===z$V.numColor},z$V.toColorStr=function(){return this._color.strColor},z$r.create=function(z$V){var z$U;if(z$V&&("string"==typeof z$V?z$U=z$q.create(z$V):z$V instanceof laya.utils.Color&&(z$U=z$V),z$U))return z$U._drawStyle||(z$U._drawStyle=new z$r(z$V));return laya.webgl.canvas.DrawStyle.DEFAULT},z$R(z$r,["DEFAULT",function(){return this.DEFAULT=new z$r("#000000")}]),z$r}(),z$M=function(){function z$V(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];z$LV.mainContext;this.ib=z$CV.create(35048),this.vb=z$fV.create(5)}z$_(z$V,"laya.webgl.canvas.Path");var z$U=z$V.prototype;return z$U.addPoint=function(z$V,z$U){this.tempArray.push(z$V,z$U)},z$U.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},z$U.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},z$U.polygon=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R;return this.geomatrys.push(this._curGeomatry=z$R=new z$EV(z$V,z$U,z$r,z$s,z$p,z$c)),z$s||(z$R.fill=!1),null==z$c&&(z$R.borderWidth=0),z$R},z$U.setGeomtry=function(z$V){this.geomatrys.push(this._curGeomatry=z$V)},z$U.drawLine=function(z$V,z$U,z$r,z$s,z$p){var z$c;return this.closePath?this.geomatrys.push(this._curGeomatry=z$c=new z$zV(z$V,z$U,z$r,z$s,z$p)):this.geomatrys.push(this._curGeomatry=z$c=new z$wV(z$V,z$U,z$r,z$s,z$p)),z$c.fill=!1,z$c},z$U.update=function(){var z$V=this.ib._byteLength,z$U=this.geomatrys.length;this.offset=z$V;for(var z$r=this.geoStart;z$r<z$U;z$r++)this.geomatrys[z$r].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=z$U,this.count=(this.ib._byteLength-z$V)/z$uV.BYTES_PIDX},z$U.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},z$U.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},z$V}(),z$A=function(){function z$T(){}z$_(z$T,"laya.webgl.canvas.save.SaveBase");var z$V=z$T.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!1},z$V.restore=function(z$V){this._dataObj[this._valueName]=this._value,(z$T._cache[z$T._cache._length++]=this)._newSubmit&&(z$V._curSubmit=z$cV.RENDERBASE,z$V._renderKey=0)},z$T._createArray=function(){var z$V=[];return z$V._length=0,z$V},z$T._init=function(){var z$V=z$T._namemap={};return z$V[1]="ALPHA",z$V[2]="fillStyle",z$V[8]="font",z$V[256]="lineWidth",z$V[512]="strokeStyle",z$V[8192]="_mergeID",z$V[1024]=z$V[2048]=z$V[4096]=[],z$V[16384]="textBaseline",z$V[32768]="textAlign",z$V[65536]="_nBlendType",z$V[1048576]="shader",z$V[2097152]="filters",z$V},z$T.save=function(z$V,z$U,z$r,z$s){if((z$V._saveMark._saveuse&z$U)!==z$U){z$V._saveMark._saveuse|=z$U;var z$p=z$T._cache,z$c=0<z$p._length?z$p[--z$p._length]:new z$T;z$c._value=z$r[z$c._valueName=z$T._namemap[z$U]],z$c._dataObj=z$r,z$c._newSubmit=z$s;var z$R=z$V._save;z$R[z$R._length++]=z$c}},z$T._cache=laya.webgl.canvas.save.SaveBase._createArray(),z$T._namemap=z$T._init(),z$T}(),z$X=function(){function z$c(){this._clipRect=new z$Q}z$_(z$c,"laya.webgl.canvas.save.SaveClipRect");var z$V=z$c.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!1},z$V.restore=function(z$V){z$V._clipRect=this._clipSaveRect,(z$c._cache[z$c._cache._length++]=this)._submitScissor.submitLength=z$V._submits._length-this._submitScissor.submitIndex,z$V._curSubmit=z$cV.RENDERBASE,z$V._renderKey=0},z$c.save=function(z$V,z$U){if(131072!=(131072&z$V._saveMark._saveuse)){z$V._saveMark._saveuse|=131072;var z$r=z$c._cache,z$s=0<z$r._length?z$r[--z$r._length]:new z$c;z$s._clipSaveRect=z$V._clipRect,z$V._clipRect=z$s._clipRect.copyFrom(z$V._clipRect),z$s._submitScissor=z$U;var z$p=z$V._save;z$p[z$p._length++]=z$s}},z$R(z$c,["_cache",function(){return this._cache=z$A._createArray()}]),z$c}(),z$e=function(){function z$G(){this._contextX=0,this._contextY=0,this._clipRect=new z$Q,this._rect=new z$Q,this._matrix=new z$n}z$_(z$G,"laya.webgl.canvas.save.SaveClipRectStencil");var z$V=z$G.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!1},z$V.restore=function(z$V){z$bV.restore(z$V,this._rect,this._saveMatrix,this._contextX,this._contextY),z$V._clipRect=this._clipSaveRect,z$V._curMat=this._saveMatrix,z$V._x=this._contextX,z$V._y=this._contextY,z$G._cache[z$G._cache._length++]=this,z$V._curSubmit=z$cV.RENDERBASE},z$G.save=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){if(262144!=(262144&z$V._saveMark._saveuse)){z$V._saveMark._saveuse|=262144;var z$b=z$G._cache,z$S=0<z$b._length?z$b[--z$b._length]:new z$G;z$S._clipSaveRect=z$V._clipRect,z$S._clipRect.setTo(z$R,z$T,z$N,z$t),z$V._clipRect=z$S._clipRect,z$S._rect.x=z$r,z$S._rect.y=z$s,z$S._rect.width=z$p,z$S._rect.height=z$c,z$S._contextX=z$V._x,z$S._contextY=z$V._y,z$S._saveMatrix=z$V._curMat,z$V._curMat.copyTo(z$S._matrix),z$V._curMat=z$S._matrix,z$S._submitStencil=z$U;var z$_=z$V._save;z$_[z$_._length++]=z$S}},z$R(z$G,["_cache",function(){return this._cache=z$A._createArray()}]),z$G}(),z$F=function(){function z$s(){this._saveuse=0}z$_(z$s,"laya.webgl.canvas.save.SaveMark");var z$V=z$s.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!0},z$V.restore=function(z$V){z$V._saveMark=this._preSaveMark,z$s._no[z$s._no._length++]=this},z$s.Create=function(z$V){var z$U=z$s._no,z$r=0<z$U._length?z$U[--z$U._length]:new z$s;return z$r._saveuse=0,z$r._preSaveMark=z$V._saveMark,z$V._saveMark=z$r},z$R(z$s,["_no",function(){return this._no=z$A._createArray()}]),z$s}(),z$g=function(){function z$c(){this._matrix=new z$n}z$_(z$c,"laya.webgl.canvas.save.SaveTransform");var z$V=z$c.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!1},z$V.restore=function(z$V){z$V._curMat=this._savematrix,z$c._no[z$c._no._length++]=this},z$c.save=function(z$V){var z$U=z$V._saveMark;if(2048!=(2048&z$U._saveuse)){z$U._saveuse|=2048;var z$r=z$c._no,z$s=0<z$r._length?z$r[--z$r._length]:new z$c;z$s._savematrix=z$V._curMat,z$V._curMat=z$V._curMat.copyTo(z$s._matrix);var z$p=z$V._save;z$p[z$p._length++]=z$s}},z$R(z$c,["_no",function(){return this._no=z$A._createArray()}]),z$c}(),z$v=function(){function z$p(){}z$_(z$p,"laya.webgl.canvas.save.SaveTranslate");var z$V=z$p.prototype;return z$k.imps(z$V,{"laya.webgl.canvas.save.ISaveData":!0}),z$V.isSaveMark=function(){return!1},z$V.restore=function(z$V){z$V._curMat;z$V._x=this._x,z$V._y=this._y,z$p._no[z$p._no._length++]=this},z$p.save=function(z$V){var z$U=z$p._no,z$r=0<z$U._length?z$U[--z$U._length]:new z$p;z$r._x=z$V._x,z$r._y=z$V._y;var z$s=z$V._save;z$s[z$s._length++]=z$r},z$R(z$p,["_no",function(){return this._no=z$A._createArray()}]),z$p}(),z$Y=function(){function z$V(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new z$Q}z$_(z$V,"laya.webgl.resource.RenderTargetMAX");var z$U=z$V.prototype;return z$U.setSP=function(z$V){this._sp=z$V},z$U.size=function(z$V,z$U){var z$r=this;this._width!==z$V||this._height!==z$U?(this.repaint=!0,this._width=z$V,this._height=z$U,this.target?this.target.size(z$V,z$U):this.target=z$xV.create(z$V,z$U),this.target.hasListener("recovered")||this.target.on("recovered",this,function(z$V){z$k.timer.callLater(z$r._sp,z$r._sp.repaint)})):this.target.size(z$V,z$U)},z$U._flushToTarget=function(z$V,z$U){if(!z$U._destroy){var z$r=z$WV.worldScissorTest,z$s=z$WV.worldClipRect;z$WV.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,z$WV.worldScissorTest=!1,z$LV.mainContext.disable(3089);var z$p=z$WV.worldAlpha,z$c=z$WV.worldMatrix4,z$R=z$WV.worldMatrix,z$T=z$WV.worldFilters,z$N=z$WV.worldShaderDefines;if(z$WV.worldMatrix=z$n.EMPTY,z$WV.restoreTempArray(),z$WV.worldMatrix4=z$WV.TEMPMAT4_ARRAY,z$WV.worldAlpha=1,z$WV.worldFilters=null,z$WV.worldShaderDefines=null,z$ZV.activeShader=null,z$U.start(),z$y.showCanvasMark?z$U.clear(0,1,0,.3):z$U.clear(0,0,0,0),z$V.flush(),z$U.end(),z$ZV.activeShader=null,z$WV.worldAlpha=z$p,z$WV.worldMatrix4=z$c,z$WV.worldMatrix=z$R,z$WV.worldFilters=z$T,z$WV.worldShaderDefines=z$N,z$WV.worldScissorTest=z$r){var z$t=z$WV.height-z$s.y-z$s.height;z$LV.mainContext.scissor(z$s.x,z$t,z$s.width,z$s.height),z$LV.mainContext.enable(3089)}z$WV.worldClipRect=z$s}},z$U.flush=function(z$V){this.repaint&&(this._flushToTarget(z$V,this.target),this.repaint=!1)},z$U.drawTo=function(z$V,z$U,z$r,z$s,z$p){z$V.drawTexture(this.target.getTexture(),z$U,z$r,z$s,z$p,0,0)},z$U.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},z$V}(),z$C=function(){function z$V(){this.ALPHA=1,this.shaderType=0,this.defines=new z$HV}return z$_(z$V,"laya.webgl.shader.d2.Shader2D"),z$V.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},z$V.__init__=function(){var z$V,z$U;z$FV.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),z$FV.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),z$FV.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),z$FV.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),z$FV.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),z$FV.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),z$FV.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),z$FV.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),z$V="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",z$U='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',z$FV.preCompile2D(0,1,z$V,z$U,null),z$V="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",z$U='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',z$FV.preCompile2D(0,2,z$V,z$U,null),z$V="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",z$U="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",z$FV.preCompile2D(0,4,z$V,z$U,null),z$V="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",z$U='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',z$FV.preCompile2D(0,256,z$V,z$U,null),z$V="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",z$U="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",z$FV.preCompile2D(0,512,z$V,z$U,null)},z$V}(),z$f=function(){function z$U(z$V,z$U,z$r){this._value=0,this._name2int=z$V,this._int2name=z$U,this._int2nameMap=z$r}z$_(z$U,"laya.webgl.shader.ShaderDefines");var z$V=z$U.prototype;return z$V.add=function(z$V){return"string"==typeof z$V&&(z$V=this._name2int[z$V]),this._value|=z$V,this._value},z$V.addInt=function(z$V){return this._value|=z$V,this._value},z$V.remove=function(z$V){return"string"==typeof z$V&&(z$V=this._name2int[z$V]),this._value&=~z$V,this._value},z$V.isDefine=function(z$V){return(this._value&z$V)===z$V},z$V.getValue=function(){return this._value},z$V.setValue=function(z$V){this._value=z$V},z$V.toNameDic=function(){var z$V=this._int2nameMap[this._value];return z$V||z$U._toText(this._value,this._int2name,this._int2nameMap)},z$U._reg=function(z$V,z$U,z$r,z$s){z$s[z$r[z$V]=z$U]=z$V},z$U._toText=function(z$V,z$U,z$r){var z$s=z$r[z$V];if(z$s)return z$s;for(var z$p={},z$c=1,z$R=0;z$R<32&&!(z$V<(z$c=1<<z$R));z$R++)if(z$V&z$c){var z$T=z$U[z$c];z$T&&(z$p[z$T]="")}return z$r[z$V]=z$p},z$U._toInt=function(z$V,z$U){for(var z$r=z$V.split("."),z$s=0,z$p=0,z$c=z$r.length;z$p<z$c;z$p++){var z$R=z$U[z$r[z$p]];if(!z$R)throw new Error("Defines to int err:"+z$V+"/"+z$r[z$p]);z$s|=z$R}return z$s},z$U}(),z$VV=function(){function z$R(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new z$n}z$_(z$R,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var z$V=z$R.prototype;return z$V.init=function(z$V,z$U,z$r){if(z$U)this._vs=z$U;else{this._vs=[];var z$s=z$V.width,z$p=z$V.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(z$s,0,1,0,1,1,1,1),this._vs.push(z$s,z$p,1,1,1,1,1,1),this._vs.push(0,z$p,0,1,1,1,1,1)}z$r?this._ps=z$r:(z$R._defaultPS||(z$R._defaultPS=[]).push(0,1,3,3,1,2),this._ps=z$R._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=z$V},z$V.init2=function(z$V,z$U,z$r,z$s,z$p){this.transform&&(this.transform=null),z$r?this._ps=z$r:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=z$s,this._uvs=z$p,this.mEleNum=this._ps.length,this.mTexture=z$V,(z$l.isConchNode||z$l.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},z$V._initMyData=function(){var z$V=0,z$U=0,z$r=4*this._verticles.length;this._vs=z$R._tempVS;var z$s=!1;if(z$l.isConchNode||z$l.isConchApp?(this._vs.length=z$r,z$s=!0):this._vs.length<z$r&&(this._vs.length=z$r,z$s=!0),z$R._tVSLen=z$r,z$s)for(;z$V<z$r;)this._vs[z$V]=this._verticles[z$U],this._vs[z$V+1]=this._verticles[z$U+1],this._vs[z$V+2]=this._uvs[z$U],this._vs[z$V+3]=this._uvs[z$U+1],this._vs[z$V+4]=1,this._vs[z$V+5]=1,this._vs[z$V+6]=1,this._vs[z$V+7]=1,z$V+=8,z$U+=2;else for(;z$V<z$r;)this._vs[z$V]=this._verticles[z$U],this._vs[z$V+1]=this._verticles[z$U+1],this._vs[z$V+2]=this._uvs[z$U],this._vs[z$V+3]=this._uvs[z$U+1],z$V+=8,z$U+=2},z$V.getData2=function(z$V,z$U,z$r){var z$s;this.mVBBuffer=z$V,this.mIBBuffer=z$U,this._initMyData(),z$V.appendEx2(this._vs,Float32Array,z$R._tVSLen,4),this._indexStart=z$U._byteLength,(z$s=z$R._tempIB).length<this._ps.length&&(z$s.length=this._ps.length);for(var z$p=0,z$c=this._ps.length;z$p<z$c;z$p++)z$s[z$p]=this._ps[z$p]+z$r;z$U.appendEx2(z$s,Uint16Array,this._ps.length,2)},z$V.getData=function(z$V,z$U,z$r){if(this.mVBBuffer=z$V,this.mIBBuffer=z$U,z$V.append(this.mVBData),this._indexStart=z$U._byteLength,this.mIBData.start!=z$r){for(var z$s=0,z$p=this._ps.length;z$s<z$p;z$s++)this.mIBData[z$s]=this._ps[z$s]+z$r;this.mIBData.start=z$r}z$U.append(this.mIBData)},z$V.render=function(z$V,z$U,z$r){if(z$l.isWebGL&&this.mTexture){z$V._renderKey=0,z$V._shader2D.glTexture=null,z$UV.getInstance().addSkinMesh(this);var z$s=z$cV.createShape(z$V,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,z$DV.create(512,0));this.transform||(this.transform=z$n.EMPTY),this.transform.translate(z$U,z$r),z$n.mul(this.transform,z$V._curMat,this._tempMatrix),this.transform.translate(-z$U,-z$r);var z$p=z$s.shaderValue,z$c=z$p.u_mmat2||z$WV.getMatrArray();z$WV.mat2MatArray(this._tempMatrix,z$c),z$p.textureHost=this.mTexture,z$p.offsetX=0,z$p.offsetY=0,z$p.u_mmat2=z$c,z$p.ALPHA=z$V._shader2D.ALPHA,z$V._submits[z$V._submits._length++]=z$s}else z$l.isConchApp&&this.mTexture&&(this.transform||(this.transform=z$n.EMPTY),z$V.setSkinMesh&&z$V.setSkinMesh(z$U,z$r,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},z$R._tempVS=[],z$R._tempIB=[],z$R._defaultPS=null,z$R._tVSLen=0,z$R}(),z$UV=function(){function z$V(){this.ib=null,this.vb=null;z$LV.mainContext;this.ib=z$CV.create(35048),this.vb=z$fV.create(8)}z$_(z$V,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var z$U=z$V.prototype;return z$U.addSkinMesh=function(z$V){z$V.getData2(this.vb,this.ib,this.vb._byteLength/32)},z$U.reset=function(){this.vb.clear(),this.ib.clear()},z$V.getInstance=function(){return z$V.instance=z$V.instance||new z$V},z$V.instance=null,z$V}(),z$rV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===z$N&&(z$N=0),this.x=z$V,this.y=z$U,this.width=z$r,this.height=z$s,this.edges=z$p,this.color=z$c,this.borderWidth=z$R,this.borderColor=z$T}z$_(z$V,"laya.webgl.shapes.BasePoly");var z$U=z$V.prototype;return z$k.imps(z$U,{"laya.webgl.shapes.IShape":!0}),z$U.getData=function(z$V,z$U,z$r){},z$U.rebuild=function(z$V){},z$U.setMatrix=function(z$V){},z$U.needUpdate=function(z$V){return!0},z$U.sector=function(z$V,z$U,z$r){var z$s=this.x,z$p=this.y,z$c=this.edges,z$R=(this.r1-this.r0)/z$c,z$T=this.width,z$N=this.height,z$t=this.color,z$b=(z$t>>16&255)/255,z$S=(z$t>>8&255)/255,z$_=(255&z$t)/255;z$V.push(z$s,z$p,z$b,z$S,z$_);for(var z$G=0;z$G<z$c+1;z$G++)z$V.push(z$s+Math.sin(z$R*z$G+this.r0)*z$T,z$p+Math.cos(z$R*z$G+this.r0)*z$N),z$V.push(z$b,z$S,z$_);for(z$G=0;z$G<z$c;z$G++)z$U.push(z$r,z$r+z$G+1,z$r+z$G+2)},z$U.createLine2=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T,z$N,z$t,z$b,z$S,z$_,z$G,z$q,z$u,z$h,z$l,z$W,z$O,z$L,z$d,z$k,z$y,z$D,z$n,z$I=z$V.concat(),z$Q=z$p,z$H=this.borderColor,z$w=(z$H>>16&255)/255,z$z=(z$H>>8&255)/255,z$E=(255&z$H)/255,z$K=z$I.length/2,z$m=z$s,z$a=z$r/2;z$N=z$I[0],z$t=z$I[1],z$u=z$N-(z$b=z$I[2]),z$q=(z$q=-(z$t-(z$S=z$I[3])))/(z$n=Math.sqrt(z$q*z$q+z$u*z$u))*z$a,z$u=z$u/z$n*z$a,z$Q.push(z$N-z$q+this.x,z$t-z$u+this.y,z$w,z$z,z$E,z$N+z$q+this.x,z$t+z$u+this.y,z$w,z$z,z$E);for(var z$Z=1;z$Z<z$K-1;z$Z++)z$N=z$I[2*(z$Z-1)],z$t=z$I[2*(z$Z-1)+1],z$b=z$I[2*z$Z],z$S=z$I[2*z$Z+1],z$_=z$I[2*(z$Z+1)],z$G=z$I[2*(z$Z+1)+1],z$u=z$N-z$b,z$l=z$b-z$_,z$L=(-(z$q=(z$q=-(z$t-z$S))/(z$n=Math.sqrt(z$q*z$q+z$u*z$u))*z$a)+z$N)*(-(z$u=z$u/z$n*z$a)+z$S)-(-z$q+z$b)*(-z$u+z$t),z$y=(-(z$h=(z$h=-(z$S-z$G))/(z$n=Math.sqrt(z$h*z$h+z$l*z$l))*z$a)+z$_)*(-(z$l=z$l/z$n*z$a)+z$S)-(-z$h+z$b)*(-z$l+z$G),z$D=(z$W=-z$u+z$t-(-z$u+z$S))*(z$k=-z$h+z$b-(-z$h+z$_))-(z$d=-z$l+z$G-(-z$l+z$S))*(z$O=-z$q+z$b-(-z$q+z$N)),Math.abs(z$D)<.1?(z$D+=10.1,z$Q.push(z$b-z$q+this.x,z$S-z$u+this.y,z$w,z$z,z$E,z$b+z$q+this.x,z$S+z$u+this.y,z$w,z$z,z$E)):(((z$R=(z$O*z$y-z$k*z$L)/z$D)-z$b)*(z$R-z$b)+((z$T=(z$d*z$L-z$W*z$y)/z$D)-z$S)+(z$T-z$S),z$Q.push(z$R+this.x,z$T+this.y,z$w,z$z,z$E,z$b-(z$R-z$b)+this.x,z$S-(z$T-z$S)+this.y,z$w,z$z,z$E));z$N=z$I[z$I.length-4],z$t=z$I[z$I.length-3],z$u=z$N-(z$b=z$I[z$I.length-2]),z$q=(z$q=-(z$t-(z$S=z$I[z$I.length-1])))/(z$n=Math.sqrt(z$q*z$q+z$u*z$u))*z$a,z$u=z$u/z$n*z$a,z$Q.push(z$b-z$q+this.x,z$S-z$u+this.y,z$w,z$z,z$E,z$b+z$q+this.x,z$S+z$u+this.y,z$w,z$z,z$E);var z$x=z$c;for(z$Z=1;z$Z<z$x;z$Z++)z$U.push(z$m+2*(z$Z-1),z$m+2*(z$Z-1)+1,z$m+2*z$Z+1,z$m+2*z$Z+1,z$m+2*z$Z,z$m+2*(z$Z-1));return z$Q},z$U.createLine=function(z$V,z$U,z$r,z$s){var z$p=z$V.concat(),z$c=z$V,z$R=this.borderColor,z$T=(z$R>>16&255)/255,z$N=(z$R>>8&255)/255,z$t=(255&z$R)/255;z$p.splice(0,5);var z$b,z$S,z$_,z$G,z$q,z$u,z$h,z$l,z$W,z$O,z$L,z$d,z$k,z$y,z$D,z$n,z$I,z$Q,z$H,z$w,z$z=z$p.length/5,z$E=z$s,z$K=z$r/2;z$_=z$p[0],z$G=z$p[1],z$O=z$_-(z$q=z$p[5]),z$W=(z$W=-(z$G-(z$u=z$p[6])))/(z$w=Math.sqrt(z$W*z$W+z$O*z$O))*z$K,z$O=z$O/z$w*z$K,z$c.push(z$_-z$W,z$G-z$O,z$T,z$N,z$t,z$_+z$W,z$G+z$O,z$T,z$N,z$t);for(var z$m=1;z$m<z$z-1;z$m++)z$_=z$p[5*(z$m-1)],z$G=z$p[5*(z$m-1)+1],z$q=z$p[5*z$m],z$u=z$p[5*z$m+1],z$h=z$p[5*(z$m+1)],z$l=z$p[5*(z$m+1)+1],z$O=z$_-z$q,z$d=z$q-z$h,z$D=(-(z$W=(z$W=-(z$G-z$u))/(z$w=Math.sqrt(z$W*z$W+z$O*z$O))*z$K)+z$_)*(-(z$O=z$O/z$w*z$K)+z$u)-(-z$W+z$q)*(-z$O+z$G),z$Q=(-(z$L=(z$L=-(z$u-z$l))/(z$w=Math.sqrt(z$L*z$L+z$d*z$d))*z$K)+z$h)*(-(z$d=z$d/z$w*z$K)+z$u)-(-z$L+z$q)*(-z$d+z$l),z$H=(z$k=-z$O+z$G-(-z$O+z$u))*(z$I=-z$L+z$q-(-z$L+z$h))-(z$n=-z$d+z$l-(-z$d+z$u))*(z$y=-z$W+z$q-(-z$W+z$_)),Math.abs(z$H)<.1?(z$H+=10.1,z$c.push(z$q-z$W,z$u-z$O,z$T,z$N,z$t,z$q+z$W,z$u+z$O,z$T,z$N,z$t)):(((z$b=(z$y*z$Q-z$I*z$D)/z$H)-z$q)*(z$b-z$q)+((z$S=(z$n*z$D-z$k*z$Q)/z$H)-z$u)+(z$S-z$u),z$c.push(z$b,z$S,z$T,z$N,z$t,z$q-(z$b-z$q),z$u-(z$S-z$u),z$T,z$N,z$t));z$_=z$p[z$p.length-10],z$G=z$p[z$p.length-9],z$O=z$_-(z$q=z$p[z$p.length-5]),z$W=(z$W=-(z$G-(z$u=z$p[z$p.length-4])))/(z$w=Math.sqrt(z$W*z$W+z$O*z$O))*z$K,z$O=z$O/z$w*z$K,z$c.push(z$q-z$W,z$u-z$O,z$T,z$N,z$t,z$q+z$W,z$u+z$O,z$T,z$N,z$t);var z$a=this.edges+1;for(z$m=1;z$m<z$a;z$m++)z$U.push(z$E+2*(z$m-1),z$E+2*(z$m-1)+1,z$E+2*z$m+1,z$E+2*z$m+1,z$E+2*z$m,z$E+2*(z$m-1));return z$c},z$U.createLoopLine=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$V.concat(),z$T=z$p||z$V,z$N=this.borderColor,z$t=(z$N>>16&255)/255,z$b=(z$N>>8&255)/255,z$S=(255&z$N)/255;z$R.splice(0,5);var z$_=[z$R[0],z$R[1]],z$G=[z$R[z$R.length-5],z$R[z$R.length-4]],z$q=z$G[0]+.5*(z$_[0]-z$G[0]),z$u=z$G[1]+.5*(z$_[1]-z$G[1]);z$R.unshift(z$q,z$u,0,0,0),z$R.push(z$q,z$u,0,0,0);var z$h,z$l,z$W,z$O,z$L,z$d,z$k,z$y,z$D,z$n,z$I,z$Q,z$H,z$w,z$z,z$E,z$K,z$m,z$a,z$Z,z$x=z$R.length/5,z$$=z$s,z$j=z$r/2;z$W=z$R[0],z$O=z$R[1],z$n=z$W-(z$L=z$R[5]),z$D=(z$D=-(z$O-(z$d=z$R[6])))/(z$Z=Math.sqrt(z$D*z$D+z$n*z$n))*z$j,z$n=z$n/z$Z*z$j,z$T.push(z$W-z$D,z$O-z$n,z$t,z$b,z$S,z$W+z$D,z$O+z$n,z$t,z$b,z$S);for(var z$o=1;z$o<z$x-1;z$o++)z$W=z$R[5*(z$o-1)],z$O=z$R[5*(z$o-1)+1],z$L=z$R[5*z$o],z$d=z$R[5*z$o+1],z$k=z$R[5*(z$o+1)],z$y=z$R[5*(z$o+1)+1],z$n=z$W-z$L,z$Q=z$L-z$k,z$z=(-(z$D=(z$D=-(z$O-z$d))/(z$Z=Math.sqrt(z$D*z$D+z$n*z$n))*z$j)+z$W)*(-(z$n=z$n/z$Z*z$j)+z$d)-(-z$D+z$L)*(-z$n+z$O),z$m=(-(z$I=(z$I=-(z$d-z$y))/(z$Z=Math.sqrt(z$I*z$I+z$Q*z$Q))*z$j)+z$k)*(-(z$Q=z$Q/z$Z*z$j)+z$d)-(-z$I+z$L)*(-z$Q+z$y),z$a=(z$H=-z$n+z$O-(-z$n+z$d))*(z$K=-z$I+z$L-(-z$I+z$k))-(z$E=-z$Q+z$y-(-z$Q+z$d))*(z$w=-z$D+z$L-(-z$D+z$W)),Math.abs(z$a)<.1?(z$a+=10.1,z$T.push(z$L-z$D,z$d-z$n,z$t,z$b,z$S,z$L+z$D,z$d+z$n,z$t,z$b,z$S)):(((z$h=(z$w*z$m-z$K*z$z)/z$a)-z$L)*(z$h-z$L)+((z$l=(z$E*z$z-z$H*z$m)/z$a)-z$d)+(z$l-z$d),z$T.push(z$h,z$l,z$t,z$b,z$S,z$L-(z$h-z$L),z$d-(z$l-z$d),z$t,z$b,z$S));z$c&&(z$U=z$c);var z$J=this.edges+1;for(z$o=1;z$o<z$J;z$o++)z$U.push(z$$+2*(z$o-1),z$$+2*(z$o-1)+1,z$$+2*z$o+1,z$$+2*z$o+1,z$$+2*z$o,z$$+2*(z$o-1));return z$U.push(z$$+2*(z$o-1),z$$+2*(z$o-1)+1,z$$+1,z$$+1,z$$,z$$+2*(z$o-1)),z$T},z$V}(),z$sV=function(){function z$u(){}return z$_(z$u,"laya.webgl.shapes.Earcut"),z$u.earcut=function(z$V,z$U,z$r){z$r=z$r||2;var z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b=z$U&&z$U.length,z$S=z$b?z$U[0]*z$r:z$V.length,z$_=z$u.linkedList(z$V,0,z$S,z$r,!0),z$G=[];if(!z$_)return z$G;if(z$b&&(z$_=z$u.eliminateHoles(z$V,z$U,z$_,z$r)),z$V.length>80*z$r){z$s=z$c=z$V[0],z$p=z$R=z$V[1];for(var z$q=z$r;z$q<z$S;z$q+=z$r)(z$T=z$V[z$q])<z$s&&(z$s=z$T),(z$N=z$V[z$q+1])<z$p&&(z$p=z$N),z$c<z$T&&(z$c=z$T),z$R<z$N&&(z$R=z$N);z$t=0!==(z$t=Math.max(z$c-z$s,z$R-z$p))?1/z$t:0}return z$u.earcutLinked(z$_,z$G,z$r,z$s,z$p,z$t),z$G},z$u.linkedList=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R;if(z$p===0<z$u.signedArea(z$V,z$U,z$r,z$s))for(z$c=z$U;z$c<z$r;z$c+=z$s)z$R=z$u.insertNode(z$c,z$V[z$c],z$V[z$c+1],z$R);else for(z$c=z$r-z$s;z$U<=z$c;z$c-=z$s)z$R=z$u.insertNode(z$c,z$V[z$c],z$V[z$c+1],z$R);return z$R&&z$u.equals(z$R,z$R.next)&&(z$u.removeNode(z$R),z$R=z$R.next),z$R},z$u.filterPoints=function(z$V,z$U){if(!z$V)return z$V;z$U||(z$U=z$V);var z$r,z$s=z$V;do{if(z$r=!1,z$s.steiner||!z$u.equals(z$s,z$s.next)&&0!==z$u.area(z$s.prev,z$s,z$s.next))z$s=z$s.next;else{if(z$u.removeNode(z$s),(z$s=z$U=z$s.prev)===z$s.next)break;z$r=!0}}while(z$r||z$s!==z$U);return z$U},z$u.earcutLinked=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(z$V){!z$R&&z$c&&z$u.indexCurve(z$V,z$s,z$p,z$c);for(var z$T,z$N,z$t=z$V;z$V.prev!==z$V.next;)if(z$T=z$V.prev,z$N=z$V.next,z$c?z$u.isEarHashed(z$V,z$s,z$p,z$c):z$u.isEar(z$V))z$U.push(z$T.i/z$r),z$U.push(z$V.i/z$r),z$U.push(z$N.i/z$r),z$u.removeNode(z$V),z$V=z$N.next,z$t=z$N.next;else if((z$V=z$N)===z$t){z$R?1===z$R?(z$V=z$u.cureLocalIntersections(z$V,z$U,z$r),z$u.earcutLinked(z$V,z$U,z$r,z$s,z$p,z$c,2)):2===z$R&&z$u.splitEarcut(z$V,z$U,z$r,z$s,z$p,z$c):z$u.earcutLinked(z$u.filterPoints(z$V,null),z$U,z$r,z$s,z$p,z$c,1);break}}},z$u.isEar=function(z$V){var z$U=z$V.prev,z$r=z$V,z$s=z$V.next;if(0<=z$u.area(z$U,z$r,z$s))return!1;for(var z$p=z$V.next.next;z$p!==z$V.prev;){if(z$u.pointInTriangle(z$U.x,z$U.y,z$r.x,z$r.y,z$s.x,z$s.y,z$p.x,z$p.y)&&0<=z$u.area(z$p.prev,z$p,z$p.next))return!1;z$p=z$p.next}return!0},z$u.isEarHashed=function(z$V,z$U,z$r,z$s){var z$p=z$V.prev,z$c=z$V,z$R=z$V.next;if(0<=z$u.area(z$p,z$c,z$R))return!1;for(var z$T=z$p.x<z$c.x?z$p.x<z$R.x?z$p.x:z$R.x:z$c.x<z$R.x?z$c.x:z$R.x,z$N=z$p.y<z$c.y?z$p.y<z$R.y?z$p.y:z$R.y:z$c.y<z$R.y?z$c.y:z$R.y,z$t=z$p.x>z$c.x?z$p.x>z$R.x?z$p.x:z$R.x:z$c.x>z$R.x?z$c.x:z$R.x,z$b=z$p.y>z$c.y?z$p.y>z$R.y?z$p.y:z$R.y:z$c.y>z$R.y?z$c.y:z$R.y,z$S=z$u.zOrder(z$T,z$N,z$U,z$r,z$s),z$_=z$u.zOrder(z$t,z$b,z$U,z$r,z$s),z$G=z$V.nextZ;z$G&&z$G.z<=z$_;){if(z$G!==z$V.prev&&z$G!==z$V.next&&z$u.pointInTriangle(z$p.x,z$p.y,z$c.x,z$c.y,z$R.x,z$R.y,z$G.x,z$G.y)&&0<=z$u.area(z$G.prev,z$G,z$G.next))return!1;z$G=z$G.nextZ}for(z$G=z$V.prevZ;z$G&&z$G.z>=z$S;){if(z$G!==z$V.prev&&z$G!==z$V.next&&z$u.pointInTriangle(z$p.x,z$p.y,z$c.x,z$c.y,z$R.x,z$R.y,z$G.x,z$G.y)&&0<=z$u.area(z$G.prev,z$G,z$G.next))return!1;z$G=z$G.prevZ}return!0},z$u.cureLocalIntersections=function(z$V,z$U,z$r){var z$s=z$V;do{var z$p=z$s.prev,z$c=z$s.next.next;!z$u.equals(z$p,z$c)&&z$u.intersects(z$p,z$s,z$s.next,z$c)&&z$u.locallyInside(z$p,z$c)&&z$u.locallyInside(z$c,z$p)&&(z$U.push(z$p.i/z$r),z$U.push(z$s.i/z$r),z$U.push(z$c.i/z$r),z$u.removeNode(z$s),z$u.removeNode(z$s.next),z$s=z$V=z$c),z$s=z$s.next}while(z$s!==z$V);return z$s},z$u.splitEarcut=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$V;do{for(var z$T=z$R.next.next;z$T!==z$R.prev;){if(z$R.i!==z$T.i&&z$u.isValidDiagonal(z$R,z$T)){var z$N=z$u.splitPolygon(z$R,z$T);return z$R=z$u.filterPoints(z$R,z$R.next),z$N=z$u.filterPoints(z$N,z$N.next),z$u.earcutLinked(z$R,z$U,z$r,z$s,z$p,z$c),void z$u.earcutLinked(z$N,z$U,z$r,z$s,z$p,z$c)}z$T=z$T.next}z$R=z$R.next}while(z$R!==z$V)},z$u.eliminateHoles=function(z$V,z$U,z$r,z$s){var z$p,z$c,z$R,z$T,z$N,z$t=[];for(z$p=0,z$c=z$U.length;z$p<z$c;z$p++)z$R=z$U[z$p]*z$s,z$T=z$p<z$c-1?z$U[z$p+1]*z$s:z$V.length,(z$N=z$u.linkedList(z$V,z$R,z$T,z$s,!1))===z$N.next&&(z$N.steiner=!0),z$t.push(z$u.getLeftmost(z$N));for(z$t.sort(z$u.compareX),z$p=0;z$p<z$t.length;z$p++)z$u.eliminateHole(z$t[z$p],z$r),z$r=z$u.filterPoints(z$r,z$r.next);return z$r},z$u.compareX=function(z$V,z$U){return z$V.x-z$U.x},z$u.eliminateHole=function(z$V,z$U){if(z$U=z$u.findHoleBridge(z$V,z$U)){var z$r=z$u.splitPolygon(z$U,z$V);z$u.filterPoints(z$r,z$r.next)}},z$u.findHoleBridge=function(z$V,z$U){var z$r,z$s=z$U,z$p=z$V.x,z$c=z$V.y,z$R=-1/0;do{if(z$c<=z$s.y&&z$c>=z$s.next.y&&z$s.next.y!==z$s.y){var z$T=z$s.x+(z$c-z$s.y)*(z$s.next.x-z$s.x)/(z$s.next.y-z$s.y);if(z$T<=z$p&&z$R<z$T){if((z$R=z$T)===z$p){if(z$c===z$s.y)return z$s;if(z$c===z$s.next.y)return z$s.next}z$r=z$s.x<z$s.next.x?z$s:z$s.next}}z$s=z$s.next}while(z$s!==z$U);if(!z$r)return null;if(z$p===z$R)return z$r.prev;var z$N,z$t=z$r,z$b=z$r.x,z$S=z$r.y,z$_=1/0;for(z$s=z$r.next;z$s!==z$t;)z$p>=z$s.x&&z$s.x>=z$b&&z$p!==z$s.x&&z$u.pointInTriangle(z$c<z$S?z$p:z$R,z$c,z$b,z$S,z$c<z$S?z$R:z$p,z$c,z$s.x,z$s.y)&&((z$N=Math.abs(z$c-z$s.y)/(z$p-z$s.x))<z$_||z$N===z$_&&z$s.x>z$r.x)&&z$u.locallyInside(z$s,z$V)&&(z$r=z$s,z$_=z$N),z$s=z$s.next;return z$r},z$u.indexCurve=function(z$V,z$U,z$r,z$s){for(var z$p=z$V;null===z$p.z&&(z$p.z=z$u.zOrder(z$p.x,z$p.y,z$U,z$r,z$s)),z$p.prevZ=z$p.prev,z$p.nextZ=z$p.next,(z$p=z$p.next)!==z$V;);z$p.prevZ.nextZ=null,z$p.prevZ=null,z$u.sortLinked(z$p)},z$u.sortLinked=function(z$V){var z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t=1;do{for(z$r=z$V,z$c=z$V=null,z$R=0;z$r;){for(z$R++,z$s=z$r,z$U=z$T=0;z$U<z$t&&(z$T++,z$s=z$s.nextZ);z$U++);for(z$N=z$t;0<z$T||0<z$N&&z$s;)0!==z$T&&(0===z$N||!z$s||z$r.z<=z$s.z)?(z$r=(z$p=z$r).nextZ,z$T--):(z$s=(z$p=z$s).nextZ,z$N--),z$c?z$c.nextZ=z$p:z$V=z$p,z$p.prevZ=z$c,z$c=z$p;z$r=z$s}z$c.nextZ=null,z$t*=2}while(1<z$R);return z$V},z$u.zOrder=function(z$V,z$U,z$r,z$s,z$p){return(z$V=1431655765&((z$V=858993459&((z$V=252645135&((z$V=16711935&((z$V=32767*(z$V-z$r)*z$p)|z$V<<8))|z$V<<4))|z$V<<2))|z$V<<1))|(z$U=1431655765&((z$U=858993459&((z$U=252645135&((z$U=16711935&((z$U=32767*(z$U-z$s)*z$p)|z$U<<8))|z$U<<4))|z$U<<2))|z$U<<1))<<1},z$u.getLeftmost=function(z$V){for(var z$U=z$V,z$r=z$V;z$U.x<z$r.x&&(z$r=z$U),(z$U=z$U.next)!==z$V;);return z$r},z$u.pointInTriangle=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){return 0<=(z$p-z$R)*(z$U-z$T)-(z$V-z$R)*(z$c-z$T)&&0<=(z$V-z$R)*(z$s-z$T)-(z$r-z$R)*(z$U-z$T)&&0<=(z$r-z$R)*(z$c-z$T)-(z$p-z$R)*(z$s-z$T)},z$u.isValidDiagonal=function(z$V,z$U){return z$V.next.i!==z$U.i&&z$V.prev.i!==z$U.i&&!z$u.intersectsPolygon(z$V,z$U)&&z$u.locallyInside(z$V,z$U)&&z$u.locallyInside(z$U,z$V)&&z$u.middleInside(z$V,z$U)},z$u.area=function(z$V,z$U,z$r){return(z$U.y-z$V.y)*(z$r.x-z$U.x)-(z$U.x-z$V.x)*(z$r.y-z$U.y)},z$u.equals=function(z$V,z$U){return z$V.x===z$U.x&&z$V.y===z$U.y},z$u.intersects=function(z$V,z$U,z$r,z$s){return!!(z$u.equals(z$V,z$U)&&z$u.equals(z$r,z$s)||z$u.equals(z$V,z$s)&&z$u.equals(z$r,z$U))||0<z$u.area(z$V,z$U,z$r)!=0<z$u.area(z$V,z$U,z$s)&&0<z$u.area(z$r,z$s,z$V)!=0<z$u.area(z$r,z$s,z$U)},z$u.intersectsPolygon=function(z$V,z$U){var z$r=z$V;do{if(z$r.i!==z$V.i&&z$r.next.i!==z$V.i&&z$r.i!==z$U.i&&z$r.next.i!==z$U.i&&z$u.intersects(z$r,z$r.next,z$V,z$U))return!0;z$r=z$r.next}while(z$r!==z$V);return!1},z$u.locallyInside=function(z$V,z$U){return z$u.area(z$V.prev,z$V,z$V.next)<0?0<=z$u.area(z$V,z$U,z$V.next)&&0<=z$u.area(z$V,z$V.prev,z$U):z$u.area(z$V,z$U,z$V.prev)<0||z$u.area(z$V,z$V.next,z$U)<0},z$u.middleInside=function(z$V,z$U){for(var z$r=z$V,z$s=!1,z$p=(z$V.x+z$U.x)/2,z$c=(z$V.y+z$U.y)/2;z$r.y>z$c!=z$r.next.y>z$c&&z$r.next.y!==z$r.y&&z$p<(z$r.next.x-z$r.x)*(z$c-z$r.y)/(z$r.next.y-z$r.y)+z$r.x&&(z$s=!z$s),(z$r=z$r.next)!==z$V;);return z$s},z$u.splitPolygon=function(z$V,z$U){var z$r=new z$pV(z$V.i,z$V.x,z$V.y),z$s=new z$pV(z$U.i,z$U.x,z$U.y),z$p=z$V.next,z$c=z$U.prev;return(z$V.next=z$U).prev=z$V,(z$r.next=z$p).prev=z$r,(z$s.next=z$r).prev=z$s,(z$c.next=z$s).prev=z$c,z$s},z$u.insertNode=function(z$V,z$U,z$r,z$s){var z$p=new z$pV(z$V,z$U,z$r);return z$s?(z$p.next=z$s.next,(z$p.prev=z$s).next.prev=z$p,z$s.next=z$p):(z$p.prev=z$p).next=z$p,z$p},z$u.removeNode=function(z$V){z$V.next.prev=z$V.prev,z$V.prev.next=z$V.next,z$V.prevZ&&(z$V.prevZ.nextZ=z$V.nextZ),z$V.nextZ&&(z$V.nextZ.prevZ=z$V.prevZ)},z$u.signedArea=function(z$V,z$U,z$r,z$s){for(var z$p=0,z$c=z$U,z$R=z$r-z$s;z$c<z$r;z$c+=z$s)z$p+=(z$V[z$R]-z$V[z$c])*(z$V[z$c+1]+z$V[z$R+1]),z$R=z$c;return z$p},z$u}(),z$pV=function(){function z$V(z$V,z$U,z$r){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=z$V,this.x=z$U,this.y=z$r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return z$_(z$V,"laya.webgl.shapes.EarcutNode"),z$V}(),z$cV=(function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this.lineWidth=z$V,this.lineColor=z$U,this.lineAlpha=z$r,this.fillColor=z$s,this.fillAlpha=z$p,this.shape=z$R,this.fill=z$c}z$_(z$V,"laya.webgl.shapes.GeometryData");var z$U=z$V.prototype;z$U.clone=function(){return new z$V(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},z$U.getIndexData=function(){return null},z$U.getVertexData=function(){return null},z$U.destroy=function(){this.shape=null}}(),function(){function z$V(z$V){if(z$V instanceof Float32Array)this.points=z$V;else if(z$V instanceof Array){z$V.length;this.points=new Float32Array(z$V)}}z$_(z$V,"laya.webgl.shapes.Vertex");var z$U=z$V.prototype;z$k.imps(z$U,{"laya.webgl.shapes.IShape":!0}),z$U.getData=function(z$V,z$U,z$r){},z$U.needUpdate=function(z$V){return!1},z$U.rebuild=function(z$V){},z$U.setMatrix=function(z$V){}}(),function(){function z$N(z$V){void 0===z$V&&(z$V=1e4),this._renderType=z$V}z$_(z$N,"laya.webgl.submit.Submit");var z$V=z$N.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V.releaseRender=function(){var z$V=z$N._cache;(z$V[z$V._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},z$V.getRenderType=function(){return this._renderType},z$V.renderSubmit=function(){if(0===this._numEle)return 1;var z$V=this.shaderValue.textureHost;if(z$V){var z$U=z$V.source;if(!z$V.bitmap||!z$U)return 1;this.shaderValue.texture=z$U,z$V.alphaTexture&&z$V.alphaTexture.source&&(this.shaderValue.texture1=z$V.alphaTexture.source)}this._vb.bind_upload(this._ib);var z$r=z$LV.mainContext;return this.shaderValue.upload(),z$B.activeBlendFunction!==this._blendFn&&(z$r.enable(3042),this._blendFn(z$r),z$B.activeBlendFunction=this._blendFn),z$z.drawCall++,z$z.trianglesFaces+=this._numEle/3,z$r.drawElements(4,this._numEle,5123,this._startIdx),1},z$N.__init__=function(){var z$V=z$N.RENDERBASE=new z$N(-1);z$V.shaderValue=new z$DV(0,0),z$V.shaderValue.ALPHA=-1234},z$N.createSubmit=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$N._cache._length?z$N._cache[--z$N._cache._length]:new z$N;null==z$r&&((z$r=z$c._selfVb||(z$c._selfVb=z$fV.create(-1))).clear(),z$s=0),z$c._ib=z$U,z$c._vb=z$r,z$c._startIdx=z$s*z$uV.BYTES_PIDX,z$c._numEle=0;var z$R=z$V._nBlendType;z$c._blendFn=z$V._targets?z$B.targetFns[z$R]:z$B.fns[z$R],z$c.shaderValue=z$p,z$c.shaderValue.setValue(z$V._shader2D);var z$T=z$V._shader2D.filters;return z$T&&z$c.shaderValue.setFilters(z$T),z$c},z$N.createShape=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$N._cache._length?z$N._cache[--z$N._cache._length]:new z$N;z$R._ib=z$U,z$R._vb=z$r,z$R._numEle=z$s,z$R._startIdx=z$p,z$R.shaderValue=z$c,z$R.shaderValue.setValue(z$V._shader2D);var z$T=z$V._nBlendType;return z$R._blendFn=z$V._targets?z$B.targetFns[z$T]:z$B.fns[z$T],z$R},z$N.TYPE_2D=1e4,z$N.TYPE_CANVAS=10003,z$N.TYPE_CMDSETRT=10004,z$N.TYPE_CUSTOM=10005,z$N.TYPE_BLURRT=10006,z$N.TYPE_CMDDESTORYPRERT=10007,z$N.TYPE_DISABLESTENCIL=10008,z$N.TYPE_OTHERIBVB=10009,z$N.TYPE_PRIMITIVE=10010,z$N.TYPE_RT=10011,z$N.TYPE_BLUR_RT=10012,z$N.TYPE_TARGET=10013,z$N.TYPE_CHANGE_VALUE=10014,z$N.TYPE_SHAPE=10015,z$N.TYPE_TEXTURE=10016,z$N.TYPE_FILLTEXTURE=10017,z$N.RENDERBASE=null,z$N._cache=((z$N._cache=[])._length=0,z$N._cache),z$N}()),z$RV=function(){function z$s(){this.fun=null,this.args=null}z$_(z$s,"laya.webgl.submit.SubmitCMD");var z$V=z$s.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V.renderSubmit=function(){return this.fun.apply(null,this.args),1},z$V.getRenderType=function(){return 0},z$V.releaseRender=function(){var z$V=z$s._cache;z$V[z$V._length++]=this},z$s.create=function(z$V,z$U){var z$r=z$s._cache._length?z$s._cache[--z$s._cache._length]:new z$s;return z$r.fun=z$U,z$r.args=z$V,z$r},z$s._cache=((z$s._cache=[])._length=0,z$s._cache),z$s}(),z$TV=function(){function z$U(){this.variables={}}z$_(z$U,"laya.webgl.submit.SubmitCMDScope");var z$V=z$U.prototype;return z$V.getValue=function(z$V){return this.variables[z$V]},z$V.addValue=function(z$V,z$U){return this.variables[z$V]=z$U},z$V.setValue=function(z$V,z$U){return this.variables.hasOwnProperty(z$V)?this.variables[z$V]=z$U:null},z$V.clear=function(){for(var z$V in this.variables)delete this.variables[z$V]},z$V.recycle=function(){this.clear(),z$U.POOL.push(this)},z$U.create=function(){var z$V=z$U.POOL.pop();return z$V||(z$V=new z$U),z$V},z$U.POOL=[],z$U}(),z$NV=function(){function z$S(){this.offset=0,this.startIndex=0,this._mat=z$n.create()}z$_(z$S,"laya.webgl.submit.SubmitOtherIBVB");var z$V=z$S.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V.releaseRender=function(){var z$V=z$S._cache;(z$V[z$V._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},z$V.getRenderType=function(){return 10009},z$V.renderSubmit=function(){var z$V=this._shaderValue.textureHost;if(z$V){var z$U=z$V.source;if(!z$V.bitmap||!z$U)return 1;this._shaderValue.texture=z$U}this._vb.bind_upload(this._ib);var z$r=z$WV.worldMatrix4,z$s=z$n.TEMP;z$n.mulPre(this._mat,z$r[0],z$r[1],z$r[4],z$r[5],z$r[12],z$r[13],z$s);var z$p=z$WV.worldMatrix4=z$S.tempMatrix4;z$p[0]=z$s.a,z$p[1]=z$s.b,z$p[4]=z$s.c,z$p[5]=z$s.d,z$p[12]=z$s.tx,z$p[13]=z$s.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var z$c=z$LV.mainContext;return z$B.activeBlendFunction!==this._blendFn&&(z$c.enable(3042),this._blendFn(z$c),z$B.activeBlendFunction=this._blendFn),z$z.drawCall++,z$z.trianglesFaces+=this._numEle/3,z$c.drawElements(4,this._numEle,5123,this.startIndex),z$WV.worldMatrix4=z$r,z$ZV.activeShader=null,1},z$S.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){void 0===z$N&&(z$N=0);var z$t=z$S._cache._length?z$S._cache[--z$S._cache._length]:new z$S;z$t._ib=z$r,z$t._vb=z$U,z$t._numEle=z$s,z$t._shader=z$p,z$t._shaderValue=z$c;var z$b=z$V._nBlendType;switch(z$t._blendFn=z$V._targets?z$B.targetFns[z$b]:z$B.fns[z$b],z$N){case 0:z$t.offset=0,z$t.startIndex=z$T/(z$uV.BYTES_PE*z$U.vertexStride)*1.5,z$t.startIndex*=z$uV.BYTES_PIDX;break;case 1:z$t.startIndex=z$R,z$t.offset=z$T}return z$t},z$S._cache=((z$S._cache=[])._length=0,z$S._cache),z$S.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z$S}(),z$tV=function(){function z$r(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new z$Q,this.screenRect=new z$Q}z$_(z$r,"laya.webgl.submit.SubmitScissor");var z$V=z$r.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V._scissor=function(z$V,z$U,z$r,z$s){var z$p=z$WV.worldMatrix4,z$c=z$p[0],z$R=z$p[5],z$T=z$p[12],z$N=z$p[13];if(z$s*=z$R,(z$r*=z$c)<1||z$s<1)return!1;var z$t=(z$V=z$V*z$c+z$T)+z$r,z$b=(z$U=z$U*z$R+z$N)+z$s;z$V<0&&(z$r=z$t-(z$V=0)),z$U<0&&(z$s=z$b-(z$U=0));var z$S=z$WV.worldClipRect;if(z$V=Math.max(z$V,z$S.x),z$U=Math.max(z$U,z$S.y),z$r=Math.min(z$t,z$S.right)-z$V,z$s=Math.min(z$b,z$S.bottom)-z$U,z$r<1||z$s<1)return!1;var z$_=z$WV.worldScissorTest;return this.screenRect.copyFrom(z$S),z$S.x=z$V,z$S.y=z$U,z$S.width=z$r,z$S.height=z$s,z$WV.worldScissorTest=!0,z$U=z$WV.height-z$U-z$s,z$LV.mainContext.scissor(z$V,z$U,z$r,z$s),z$LV.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),z$_?(z$U=z$WV.height-this.screenRect.y-this.screenRect.height,z$LV.mainContext.scissor(this.screenRect.x,z$U,this.screenRect.width,this.screenRect.height),z$LV.mainContext.enable(3089)):(z$LV.mainContext.disable(3089),z$WV.worldScissorTest=!1),z$S.copyFrom(this.screenRect),!0},z$V._scissorWithTagart=function(z$V,z$U,z$r,z$s){if(z$r<1||z$s<1)return!1;var z$p=z$V+z$r,z$c=z$U+z$s;z$V<0&&(z$r=z$p-(z$V=0)),z$U<0&&(z$s=z$c-(z$U=0));var z$R=z$WV.worldClipRect;if(z$V=Math.max(z$V,z$R.x),z$U=Math.max(z$U,z$R.y),z$r=Math.min(z$p,z$R.right)-z$V,z$s=Math.min(z$c,z$R.bottom)-z$U,z$r<1||z$s<1)return!1;var z$T=z$WV.worldScissorTest;return this.screenRect.copyFrom(z$R),z$WV.worldScissorTest=!0,z$R.x=z$V,z$R.y=z$U,z$R.width=z$r,z$R.height=z$s,z$U=z$WV.height-z$U-z$s,z$LV.mainContext.scissor(z$V,z$U,z$r,z$s),z$LV.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),z$T?(z$U=z$WV.height-this.screenRect.y-this.screenRect.height,z$LV.mainContext.scissor(this.screenRect.x,z$U,this.screenRect.width,this.screenRect.height),z$LV.mainContext.enable(3089)):(z$LV.mainContext.disable(3089),z$WV.worldScissorTest=!1),z$R.copyFrom(this.screenRect),!0},z$V.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},z$V.getRenderType=function(){return 0},z$V.releaseRender=function(){var z$V=z$r._cache;(z$V[z$V._length++]=this).context=null},z$r.create=function(z$V){var z$U=z$r._cache._length?z$r._cache[--z$r._cache._length]:new z$r;return z$U.context=z$V,z$U},z$r._cache=((z$r._cache=[])._length=0,z$r._cache),z$r}(),z$bV=function(){function z$N(){this.step=0,this.blendMode=null,this.level=0}z$_(z$N,"laya.webgl.submit.SubmitStencil");var z$V=z$N.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},z$V.getRenderType=function(){return 0},z$V.releaseRender=function(){var z$V=z$N._cache;z$V[z$V._length++]=this},z$V.do1=function(){var z$V=z$LV.mainContext;z$V.enable(2960),z$V.clear(1024),z$V.colorMask(!1,!1,!1,!1),z$V.stencilFunc(514,this.level,255),z$V.stencilOp(7680,7680,7682)},z$V.do2=function(){var z$V=z$LV.mainContext;z$V.stencilFunc(514,this.level+1,255),z$V.colorMask(!0,!0,!0,!0),z$V.stencilOp(7680,7680,7680)},z$V.do3=function(){var z$V=z$LV.mainContext;z$V.colorMask(!0,!0,!0,!0),z$V.stencilOp(7680,7680,7680),z$V.clear(1024),z$V.disable(2960)},z$V.do4=function(){var z$V=z$LV.mainContext;0==this.level&&(z$V.enable(2960),z$V.clear(1024)),z$V.colorMask(!1,!1,!1,!1),z$V.stencilFunc(519,0,255),z$V.stencilOp(7680,7680,7682)},z$V.do5=function(){var z$V=z$LV.mainContext;z$V.stencilFunc(514,this.level,255),z$V.colorMask(!0,!0,!0,!0),z$V.stencilOp(7680,7680,7680)},z$V.do6=function(){var z$V=z$LV.mainContext;z$B.targetFns[z$B.TOINT[this.blendMode]](z$V)},z$V.do7=function(){var z$V=z$LV.mainContext;z$V.colorMask(!1,!1,!1,!1),z$V.stencilOp(7680,7680,7683)},z$V.do8=function(){var z$V=z$LV.mainContext;z$V.colorMask(!0,!0,!0,!0),z$V.stencilFunc(514,this.level,255),z$V.stencilOp(7680,7680,7680)},z$N.restore=function(z$V,z$U,z$r,z$s,z$p){var z$c;if((z$V._renderKey=0)<z$N._mask&&z$N._mask--,0==z$N._mask)z$c=laya.webgl.submit.SubmitStencil.create(3),z$V.addRenderObject(z$c),z$V._curSubmit=z$cV.RENDERBASE;else{z$c=laya.webgl.submit.SubmitStencil.create(7),z$V.addRenderObject(z$c);var z$R=z$V._vb;z$R._byteLength;if(z$hV.fillRectImgVb(z$R,null,z$U.x,z$U.y,z$U.width,z$U.height,z$a.DEF_UV,z$r,z$s,z$p,0,0)){z$V._shader2D.glTexture=null;var z$T=z$V._curSubmit=z$cV.createSubmit(z$V,z$V._ib,z$R,(z$R._byteLength-64)/32*3,z$DV.create(2,0));z$T.shaderValue.ALPHA=1,z$V._submits[z$V._submits._length++]=z$T,z$V._curSubmit._numEle+=6,z$V._curSubmit=z$cV.RENDERBASE}else alert("clipRect calc stencil rect error");z$c=laya.webgl.submit.SubmitStencil.create(8),z$V.addRenderObject(z$c)}},z$N.restore2=function(z$V,z$U){var z$r;(z$V._renderKey=0)<z$N._mask&&z$N._mask--,0==z$N._mask?(z$r=laya.webgl.submit.SubmitStencil.create(3),z$V.addRenderObject(z$r),z$V._curSubmit=z$cV.RENDERBASE):(z$r=laya.webgl.submit.SubmitStencil.create(7),z$V.addRenderObject(z$r),z$V._submits[z$V._submits._length++]=z$U,z$r=laya.webgl.submit.SubmitStencil.create(8),z$V.addRenderObject(z$r))},z$N.create=function(z$V){var z$U=z$N._cache._length?z$N._cache[--z$N._cache._length]:new z$N;return 5==(z$U.step=z$V)&&++z$N._mask,z$U.level=z$N._mask,z$U},z$N._cache=((z$N._cache=[])._length=0,z$N._cache),z$N._mask=0,z$N}(),z$SV=function(){function z$T(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}z$_(z$T,"laya.webgl.submit.SubmitTarget");var z$V=z$T.prototype;return z$k.imps(z$V,{"laya.webgl.submit.ISubmit":!0}),z$V.renderSubmit=function(){this._vb.bind_upload(this._ib);var z$V=this.scope.getValue(this.proName);return z$V&&(this.shaderValue.texture=z$V.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[z$V.width,z$V.height]),this.shaderValue.upload(),this.blend(),z$z.drawCall++,z$z.trianglesFaces+=this._numEle/3,z$LV.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},z$V.blend=function(){if(z$B.activeBlendFunction!==z$B.fns[this.blendType]){var z$V=z$LV.mainContext;z$V.enable(3042),z$B.fns[this.blendType](z$V),z$B.activeBlendFunction=z$B.fns[this.blendType]}},z$V.getRenderType=function(){return 0},z$V.releaseRender=function(){var z$V=z$T._cache;(z$V[z$V._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},z$T.create=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$T._cache._length?z$T._cache[--z$T._cache._length]:new z$T;return z$R._ib=z$U,z$R._vb=z$r,z$R.proName=z$c,z$R._startIdx=z$s*z$uV.BYTES_PIDX,z$R._numEle=0,z$R.blendType=z$V._nBlendType,z$R.shaderValue=z$p,z$R.shaderValue.setValue(z$V._shader2D),z$R},z$T._cache=((z$T._cache=[])._length=0,z$T._cache),z$T}(),z$_V=function(){function z$V(){this._sourceStr=null}z$_(z$V,"laya.webgl.text.CharSegment");var z$U=z$V.prototype;return z$k.imps(z$U,{"laya.webgl.text.ICharSegment":!0}),z$U.textToSpit=function(z$V){this._sourceStr=z$V},z$U.getChar=function(z$V){return this._sourceStr.charAt(z$V)},z$U.getCharCode=function(z$V){return this._sourceStr.charCodeAt(z$V)},z$U.length=function(){return this._sourceStr.length},z$V}(),z$GV=function(){var z$V;function z$z(){}return z$_(z$z,"laya.webgl.text.DrawText"),z$z.__init__=function(){z$z._charsTemp=new Array,z$z._drawValue=new z$V,z$z._charSeg=new z$_V},z$z.customCharSeg=function(z$V){z$z._charSeg=z$V},z$z.getChar=function(z$V,z$U,z$r){var z$s=z$AV.createOneChar(z$V,z$r);return-1!=z$U&&(z$z._charsCache[z$U]=z$s),z$s},z$z._drawSlow=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_,z$G,z$q){var z$u,z$h,z$l=z$z._drawValue.value(z$c,z$T,z$N,z$t,z$_,z$G,z$q),z$W=0,z$O=0,z$L=z$z._charsTemp,z$d=0,z$k=NaN;if(z$s)for(z$L.length=z$s.length,z$W=0,z$O=z$s.length;z$W<z$O;z$W++)(z$h=z$s[z$W])&&(z$k=z$h.charNum+z$l.txtID,z$L[z$W]=z$u=z$z._charsCache[z$k]||z$z.getChar(z$h.char,z$k,z$l),z$u.active());else{var z$y=z$r instanceof laya.utils.WordText?z$r.toString():z$r;if(z$m.CharacterCache){z$z._charSeg.textToSpit(z$y);var z$D=z$z._charSeg.length();for(z$W=0,z$O=z$L.length=z$D;z$W<z$O;z$W++)z$k=z$z._charSeg.getCharCode(z$W)+z$l.txtID,z$L[z$W]=z$u=z$z._charsCache[z$k]||z$z.getChar(z$z._charSeg.getChar(z$W),z$k,z$l),z$u.active(),z$d+=z$u.cw}else z$L.length=0,(z$u=z$z.getChar(z$y,-1,z$l)).active(),z$d+=z$u.cw,z$L[0]=z$u}var z$n=0;null!==z$R&&"left"!==z$R&&(z$n=-("center"==z$R?z$d/2:z$d));var z$I,z$Q,z$H=NaN,z$w=0;if(z$s)for(z$W=0,z$O=z$L.length;z$W<z$O;z$W++)z$u=z$L[z$W],z$h=z$s[z$W],z$u&&z$h&&!z$u.isSpace&&(z$H=z$u.borderSize,z$I=z$u.texture,z$U._drawText(z$I,z$b+z$n+z$h.x*z$_-z$H,z$S+z$h.y*z$G-z$H,z$I.width,z$I.height,z$p,0,0,0,0));else{for(z$W=0,z$O=z$L.length;z$W<z$O;z$W++)(z$u=z$L[z$W])&&!z$u.isSpace&&(z$H=z$u.borderSize,z$I=z$u.texture,z$U._drawText(z$I,z$b+z$n-z$H,z$S-z$H,z$I.width,z$I.height,z$p,0,0,0,0),z$V&&((z$Q=z$V[z$w++])||(z$Q=z$V[z$w-1]=[]),z$Q[0]=z$I,z$Q[1]=z$n-z$H,z$Q[2]=-z$H)),z$n+=z$u.cw;z$V&&(z$V.length=z$w)}},z$z._drawFast=function(z$V,z$U,z$r,z$s,z$p){for(var z$c,z$R,z$T=0,z$N=z$V.length;z$T<z$N;z$T++)(z$c=(z$R=z$V[z$T])[0]).active(),z$U._drawText(z$c,z$s+z$R[1],z$p+z$R[2],z$c.width,z$c.height,z$r,0,0,0,0)},z$z.drawText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S){if(void 0===z$S&&(z$S=0),!(z$U&&0===z$U.length||z$r&&0===z$r.length)){var z$_=z$s.a,z$G=z$s.d;(0!==z$s.b||0!==z$s.c)&&(z$_=z$G=1);var z$q=1!==z$_||1!==z$G;if(z$q&&z$k.stage.transform){var z$u=z$k.stage.transform;z$q=z$u.a===z$_&&z$u.d===z$G}else z$q=!1;if(z$q){var z$h=(z$s=z$s.copyTo(z$yV._tmpMatrix)).tx,z$l=z$s.ty;z$s.scale(1/z$_,1/z$G),z$s._checkTransform(),z$t*=z$_,z$b*=z$G,z$t+=z$h-z$s.tx,z$b+=z$l-z$s.ty}else z$_=z$G=1;if(z$r)z$z._drawSlow(null,z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$_,z$G,z$S);else{if(null===z$U.toUpperCase){var z$W=z$_+1e5*z$G,z$O=z$U;return void(z$O.changed||z$O.id!==z$W?(z$O.id=z$W,z$O.changed=!1,z$z._drawSlow(z$O.save,z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$_,z$G,z$S)):z$z._drawFast(z$O.save,z$V,z$s,z$t,z$b))}var z$L=z$U+z$p.toString()+z$R+z$T+z$N+z$_+z$G+z$c,z$d=z$z._textsCache[z$L];z$m.CharacterCache?z$d?z$z._drawFast(z$d,z$V,z$s,z$t,z$b):(z$z._textsCache.__length||(z$z._textsCache.__length=0),z$z._textsCache.__length>z$y.WebGLTextCacheCount&&((z$z._textsCache={}).__length=0,z$z._curPoolIndex=0),z$z._textCachesPool[z$z._curPoolIndex]?(z$d=z$z._textsCache[z$L]=z$z._textCachesPool[z$z._curPoolIndex]).length=0:z$z._textCachesPool[z$z._curPoolIndex]=z$d=z$z._textsCache[z$L]=[],z$z._textsCache.__length++,z$z._curPoolIndex++,z$z._drawSlow(z$d,z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$_,z$G,z$S)):z$z._drawSlow(z$d,z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$_,z$G,z$S)}}},z$z._charsTemp=null,z$z._textCachesPool=[],z$z._curPoolIndex=0,z$z._charsCache={},z$z._textsCache={},z$z._drawValue=null,z$z.d=[],z$z._charSeg=null,z$z.__init$=function(){z$V=function(){function z$N(){}return z$_(z$N,""),z$N.prototype.value=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this.font=z$V,this.fillColor=z$U,this.borderColor=z$r,this.lineWidth=z$s,this.scaleX=z$p,this.scaleY=z$c,this.underLine=z$R;var z$T=z$V.toString()+z$p+z$c+z$s+(z$U?z$U.toLowerCase():" ")+(z$r?z$r.toLowerCase():" ")+z$R;return this.txtID=z$N._keymap[z$T],this.txtID||(this.txtID=1e-7*++z$N._keymapCount,z$N._keymap[z$T]=this.txtID),this},z$N.clear=function(){z$N._keymap={},z$N._keymapCount=1},z$N._keymap={},z$N._keymapCount=1,z$N}()},z$z}(),z$qV=function(){function z$p(z$V){this._index=0,this._size=14,this._italic=-2,z$p._cache2=z$p._cache2||[],this.setFont(z$V||"14px Arial")}z$_(z$p,"laya.webgl.text.FontInContext");var z$V=z$p.prototype;return z$V.setFont=function(z$V){var z$U=z$p._cache2[z$V];if(z$U)this._words=z$U[0],this._size=z$U[1];else{this._words=z$V.split(" ");for(var z$r=0,z$s=this._words.length;z$r<z$s;z$r++)if(0<this._words[z$r].indexOf("px")){this._index=z$r;break}this._size=parseInt(this._words[this._index]),z$p._cache2[z$V]=[this._words,this._size]}this._text=null,this._italic=-2},z$V.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},z$V.hasType=function(z$V){for(var z$U=0,z$r=this._words.length;z$U<z$r;z$U++)if(this._words[z$U]===z$V)return z$U;return-1},z$V.removeType=function(z$V){for(var z$U=0,z$r=this._words.length;z$U<z$r;z$U++)if(this._words[z$U]===z$V){this._words.splice(z$U,1),this._index>z$U&&this._index--;break}this._text=null,this._italic=-2},z$V.copyTo=function(z$V){return z$V._text=this._text,z$V._size=this._size,z$V._index=this._index,z$V._words=this._words.slice(),z$V._italic=-2,z$V},z$V.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},z$s(0,z$V,"size",function(){return this._size},function(z$V){this._size=z$V,this._words[this._index]=z$V+"px",this._text=null}),z$p.create=function(z$V){var z$U=z$p._cache[z$V];return z$U||(z$U=z$p._cache[z$V]=new z$p(z$V))},z$p.EMPTY=new z$p,z$p._cache={},z$p._cache2=null,z$p}(),z$uV=function(){function z$V(){}return z$_(z$V,"laya.webgl.utils.CONST3D2D"),z$V.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z$V.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],z$V.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],z$V._TMPARRAY=[],z$V._OFFSETX=0,z$V._OFFSETY=0,z$R(z$V,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),z$V}(),z$hV=function(){function z$q(){}return z$_(z$q,"laya.webgl.utils.GlUtils"),z$q.make2DProjection=function(z$V,z$U,z$r){return[2/z$V,0,0,0,0,-2/z$U,0,0,0,0,2/z$r,0,-1,1,0,1]},z$q.fillIBQuadrangle=function(z$V,z$U){if(65535/4<z$U)throw Error("IBQuadrangle count:"+z$U+" must<:"+Math.floor(65535/4));z$U=Math.floor(z$U),z$V._resizeBuffer(6*(z$U+1)*2,!1),z$V.byteLength=z$V.bufferLength;for(var z$r=z$V.getUint16Array(),z$s=0,z$p=0;z$p<z$U;z$p++)z$r[z$s++]=4*z$p,z$r[z$s++]=4*z$p+2,z$r[z$s++]=4*z$p+1,z$r[z$s++]=4*z$p,z$r[z$s++]=4*z$p+3,z$r[z$s++]=4*z$p+2;return z$V.setNeedUpload(),!0},z$q.expandIBQuadrangle=function(z$V,z$U){z$V.bufferLength>=6*z$U*2||z$q.fillIBQuadrangle(z$V,z$U)},z$q.mathCeilPowerOfTwo=function(z$V){return z$V--,z$V|=z$V>>1,z$V|=z$V>>2,z$V|=z$V>>4,z$V|=z$V>>8,z$V|=z$V>>16,++z$V},z$q.fillQuadrangleImgVb=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=16+(z$V._byteLength>>2);z$V.byteLength=z$N<<2;var z$t=z$V.getFloat32Array();z$t[(z$N-=16)+2]=z$p[0],z$t[z$N+3]=z$p[1],z$t[z$N+6]=z$p[2],z$t[z$N+7]=z$p[3],z$t[z$N+10]=z$p[4],z$t[z$N+11]=z$p[5],z$t[z$N+14]=z$p[6],z$t[z$N+15]=z$p[7];var z$b=z$c.a,z$S=z$c.b,z$_=z$c.c,z$G=z$c.d;if(1!==z$b||0!==z$S||0!==z$_||1!==z$G){z$c.bTransform=!0;var z$q=z$c.tx+z$R,z$u=z$c.ty+z$T;z$t[z$N]=(z$s[0]+z$U)*z$b+(z$s[1]+z$r)*z$_+z$q,z$t[z$N+1]=(z$s[0]+z$U)*z$S+(z$s[1]+z$r)*z$G+z$u,z$t[z$N+4]=(z$s[2]+z$U)*z$b+(z$s[3]+z$r)*z$_+z$q,z$t[z$N+5]=(z$s[2]+z$U)*z$S+(z$s[3]+z$r)*z$G+z$u,z$t[z$N+8]=(z$s[4]+z$U)*z$b+(z$s[5]+z$r)*z$_+z$q,z$t[z$N+9]=(z$s[4]+z$U)*z$S+(z$s[5]+z$r)*z$G+z$u,z$t[z$N+12]=(z$s[6]+z$U)*z$b+(z$s[7]+z$r)*z$_+z$q,z$t[z$N+13]=(z$s[6]+z$U)*z$S+(z$s[7]+z$r)*z$G+z$u}else z$c.bTransform=!1,z$U+=z$c.tx+z$R,z$r+=z$c.ty+z$T,z$t[z$N]=z$U+z$s[0],z$t[z$N+1]=z$r+z$s[1],z$t[z$N+4]=z$U+z$s[2],z$t[z$N+5]=z$r+z$s[3],z$t[z$N+8]=z$U+z$s[4],z$t[z$N+9]=z$r+z$s[5],z$t[z$N+12]=z$U+z$s[6],z$t[z$N+13]=z$r+z$s[7];return z$V._upload=!0},z$q.fillTranglesVB=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T=(z$V._byteLength>>2)+z$s.length;z$V.byteLength=z$T<<2;var z$N=z$V.getFloat32Array();z$T-=z$s.length;for(var z$t=z$s.length,z$b=z$p.a,z$S=z$p.b,z$_=z$p.c,z$G=z$p.d,z$q=0;z$q<z$t;z$q+=4)if(z$N[z$T+z$q+2]=z$s[z$q+2],z$N[z$T+z$q+3]=z$s[z$q+3],1!==z$b||0!==z$S||0!==z$_||1!==z$G){z$p.bTransform=!0;var z$u=z$p.tx+z$c,z$h=z$p.ty+z$R;z$N[z$T+z$q]=(z$s[z$q]+z$U)*z$b+(z$s[z$q+1]+z$r)*z$_+z$u,z$N[z$T+z$q+1]=(z$s[z$q]+z$U)*z$S+(z$s[z$q+1]+z$r)*z$G+z$h}else z$p.bTransform=!1,z$U+=z$p.tx+z$c,z$r+=z$p.ty+z$R,z$N[z$T+z$q]=z$U+z$s[z$q],z$N[z$T+z$q+1]=z$r+z$s[z$q+1];return z$V._upload=!0},z$q.copyPreImgVb=function(z$V,z$U,z$r){var z$s=z$V._byteLength>>2;z$V.byteLength=z$s+16<<2;for(var z$p=z$V.getFloat32Array(),z$c=0,z$R=z$s-16;z$c<4;z$c++)z$p[z$s]=z$p[z$R]+z$U,++z$R,z$p[++z$s]=z$p[z$R]+z$r,++z$R,z$p[++z$s]=z$p[z$R],++z$R,z$p[++z$s]=z$p[z$R],++z$s,++z$R;z$V._upload=!0},z$q.fillRectImgVb=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_){void 0===z$_&&(z$_=!1);var z$G,z$q,z$u,z$h,z$l,z$W,z$O,z$L,z$d,z$k,z$y,z$D,z$n,z$I,z$Q,z$H,z$w=1,z$z=z$T.a,z$E=z$T.b,z$K=z$T.c,z$m=z$T.d,z$a=z$U&&z$U.width<99999999;if(1!==z$z||0!==z$E||0!==z$K||1!==z$m?(z$T.bTransform=!0,0===z$E&&0===z$K&&(z$w=23,z$d=z$p+z$r,z$k=z$c+z$s,z$G=z$z*z$r+(z$y=z$T.tx+z$N),z$u=z$z*z$d+z$y,z$q=z$m*z$s+(z$D=z$T.ty+z$t),z$h=z$m*z$k+z$D)):(z$w=23,z$T.bTransform=!1,z$u=(z$G=z$r+z$T.tx+z$N)+z$p,z$h=(z$q=z$s+z$T.ty+z$t)+z$c),z$a&&(z$l=z$U.x,z$W=z$U.y,z$O=z$U.width+z$l,z$L=z$U.height+z$W),1!==z$w){if(Math.min(z$G,z$u)>=z$O)return!1;if(Math.min(z$q,z$h)>=z$L)return!1;if(Math.max(z$u,z$G)<=z$l)return!1;if(Math.max(z$h,z$q)<=z$W)return!1}var z$Z=z$V._byteLength>>2;z$V.byteLength=16+z$Z<<2;var z$x=z$V.getFloat32Array();switch(z$x[2+z$Z]=z$R[0],z$x[3+z$Z]=z$R[1],z$x[6+z$Z]=z$R[2],z$x[7+z$Z]=z$R[3],z$x[10+z$Z]=z$R[4],z$x[11+z$Z]=z$R[5],z$x[14+z$Z]=z$R[6],z$x[15+z$Z]=z$R[7],z$w){case 1:z$y=z$T.tx+z$N,z$D=z$T.ty+z$t;var z$$=z$z*z$r,z$j=z$K*z$s,z$o=z$m*z$s,z$J=z$E*z$r,z$i=z$z*(z$d=z$p+z$r),z$B=z$K*(z$k=z$c+z$s),z$P=z$m*z$k,z$M=z$E*z$d;z$_?(z$n=z$$+z$j+z$y,z$Q=Math.round(z$n)-z$n,z$I=z$o+z$J+z$D,z$H=Math.round(z$I)-z$I,z$x[z$Z]=z$n+z$Q,z$x[1+z$Z]=z$I+z$H,z$x[4+z$Z]=z$i+z$j+z$y+z$Q,z$x[5+z$Z]=z$o+z$M+z$D+z$H,z$x[8+z$Z]=z$i+z$B+z$y+z$Q,z$x[9+z$Z]=z$P+z$M+z$D+z$H,z$x[12+z$Z]=z$$+z$B+z$y+z$Q,z$x[13+z$Z]=z$P+z$J+z$D+z$H):(z$x[z$Z]=z$$+z$j+z$y,z$x[1+z$Z]=z$o+z$J+z$D,z$x[4+z$Z]=z$i+z$j+z$y,z$x[5+z$Z]=z$o+z$M+z$D,z$x[8+z$Z]=z$i+z$B+z$y,z$x[9+z$Z]=z$P+z$M+z$D,z$x[12+z$Z]=z$$+z$B+z$y,z$x[13+z$Z]=z$P+z$J+z$D);break;case 23:z$_?(z$n=z$G+z$b,z$Q=Math.round(z$n)-z$n,z$I=z$q,z$H=Math.round(z$I)-z$I,z$x[z$Z]=z$n+z$Q,z$x[1+z$Z]=z$I+z$H,z$x[4+z$Z]=z$u+z$b+z$Q,z$x[5+z$Z]=z$q+z$H,z$x[8+z$Z]=z$u+z$Q,z$x[9+z$Z]=z$h+z$H,z$x[12+z$Z]=z$G+z$Q,z$x[13+z$Z]=z$h+z$H):(z$x[z$Z]=z$G+z$b,z$x[1+z$Z]=z$q,z$x[4+z$Z]=z$u+z$b,z$x[5+z$Z]=z$q,z$x[8+z$Z]=z$u,z$x[9+z$Z]=z$h,z$x[12+z$Z]=z$G,z$x[13+z$Z]=z$h)}return z$V._upload=!0},z$q.fillLineVb=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=.5*z$R,z$t=z$q._fillLineArray,z$b=-(z$s-z$c),z$S=z$r-z$p,z$_=Math.sqrt(z$b*z$b+z$S*z$S);z$b/=z$_,z$S/=z$_,z$b*=z$N,z$S*=z$N,z$t[0]=z$r-z$b,z$t[1]=z$s-z$S,z$t[4]=z$r+z$b,z$t[5]=z$s+z$S,z$t[8]=z$p+z$b,z$t[9]=z$c+z$S,z$t[12]=z$p-z$b,z$t[13]=z$c-z$S,z$T&&z$T.transformPointArray(z$t,z$t);var z$G=16+(z$V._byteLength>>2);return z$V.byteLength=z$G<<2,z$V.insertData(z$t,z$G-16),!0},z$q._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z$q}(),z$lV=(function(){function z$N(){}z$_(z$N,"laya.webgl.utils.MatirxArray"),z$N.ArrayMul=function(z$V,z$U,z$r){if(z$V)if(z$U)for(var z$s=NaN,z$p=NaN,z$c=NaN,z$R=NaN,z$T=0;z$T<4;z$T++)z$s=z$V[z$T],z$p=z$V[z$T+4],z$c=z$V[z$T+8],z$R=z$V[z$T+12],z$r[z$T]=z$s*z$U[0]+z$p*z$U[1]+z$c*z$U[2]+z$R*z$U[3],z$r[z$T+4]=z$s*z$U[4]+z$p*z$U[5]+z$c*z$U[6]+z$R*z$U[7],z$r[z$T+8]=z$s*z$U[8]+z$p*z$U[9]+z$c*z$U[10]+z$R*z$U[11],z$r[z$T+12]=z$s*z$U[12]+z$p*z$U[13]+z$c*z$U[14]+z$R*z$U[15];else z$N.copyArray(z$V,z$r);else z$N.copyArray(z$U,z$r)},z$N.copyArray=function(z$V,z$U){if(z$V&&z$U)for(var z$r=0;z$r<z$V.length;z$r++)z$U[z$r]=z$V[z$r]}}(),function(){function z$U(z$V,z$U,z$r){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=z$V,this._vb=new z$fV(z$V,35048),z$U&&this._vb._resizeBuffer(z$U,!1),this._ib=new z$CV,z$r&&this._ib._resizeBuffer(z$r,!1)}z$_(z$U,"laya.webgl.utils.Mesh2D");var z$V=z$U.prototype;return z$V.cloneWithNewVB=function(){var z$V=new z$U(this._stride,0,0);return z$V._ib=this._ib,z$V._quadNum=this._quadNum,z$V._attribInfo=this._attribInfo,z$V},z$V.cloneWithNewVBIB=function(){var z$V=new z$U(this._stride,0,0);return z$V._attribInfo=this._attribInfo,z$V},z$V.getVBW=function(){return this._vb.setNeedUpload(),this._vb},z$V.getVBR=function(){return this._vb},z$V.getIBR=function(){return this._ib},z$V.getIBW=function(){return this._ib.setNeedUpload(),this._ib},z$V.createQuadIB=function(z$V){this._quadNum=z$V,this._ib._resizeBuffer(6*z$V*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var z$U=this._ib.getUint16Array(),z$r=0,z$s=0,z$p=0;z$p<z$V;z$p++)z$U[z$r++]=z$s,z$U[z$r++]=z$s+2,z$U[z$r++]=z$s+1,z$U[z$r++]=z$s,z$U[z$r++]=z$s+3,z$U[z$r++]=z$s+2,z$s+=4;this._ib.setNeedUpload()},z$V.setAttributes=function(z$V){if(this._attribInfo=z$V,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},z$V.getEleNum=function(){return this._ib.getBuffer().byteLength/2},z$V.releaseMesh=function(){},z$V.destroy=function(){},z$V.clearVB=function(){this._vb.clear()},z$U._gvaoid=0,z$U}()),z$WV=function(){function z$p(){}return z$_(z$p,"laya.webgl.utils.RenderState2D"),z$p.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},z$p.mat2MatArray=function(z$V,z$U){var z$r=z$V,z$s=z$U;return z$s[0]=z$r.a,z$s[1]=z$r.b,z$s[2]=z$p.EMPTYMAT4_ARRAY[2],z$s[3]=z$p.EMPTYMAT4_ARRAY[3],z$s[4]=z$r.c,z$s[5]=z$r.d,z$s[6]=z$p.EMPTYMAT4_ARRAY[6],z$s[7]=z$p.EMPTYMAT4_ARRAY[7],z$s[8]=z$p.EMPTYMAT4_ARRAY[8],z$s[9]=z$p.EMPTYMAT4_ARRAY[9],z$s[10]=z$p.EMPTYMAT4_ARRAY[10],z$s[11]=z$p.EMPTYMAT4_ARRAY[11],z$s[12]=z$r.tx,z$s[13]=z$r.ty,z$s[14]=z$p.EMPTYMAT4_ARRAY[14],z$s[15]=z$p.EMPTYMAT4_ARRAY[15],z$U},z$p.restoreTempArray=function(){z$p.TEMPMAT4_ARRAY[0]=1,z$p.TEMPMAT4_ARRAY[1]=0,z$p.TEMPMAT4_ARRAY[4]=0,z$p.TEMPMAT4_ARRAY[5]=1,z$p.TEMPMAT4_ARRAY[12]=0,z$p.TEMPMAT4_ARRAY[13]=0},z$p.clear=function(){z$p.worldScissorTest=!1,z$p.worldShaderDefines=null,z$p.worldFilters=null,z$p.worldAlpha=1,z$p.worldClipRect.x=z$p.worldClipRect.y=0,z$p.worldClipRect.width=z$p.width,z$p.worldClipRect.height=z$p.height,z$p.curRenderTarget=null},z$p._MAXSIZE=99999999,z$p.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z$p.worldMatrix4=z$p.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z$p.worldAlpha=1,z$p.worldScissorTest=!1,z$p.worldFilters=null,z$p.worldShaderDefines=null,z$p.curRenderTarget=null,z$p.width=0,z$p.height=0,z$R(z$p,["worldMatrix",function(){return this.worldMatrix=new z$n},"worldClipRect",function(){return this.worldClipRect=new z$Q(0,0,99999999,99999999)}]),z$p}(),z$OV=function(){var z$W,z$r;function z$O(z$V,z$U,z$r,z$s,z$p){var z$c=this;function z$R(z$V){var z$U=[],z$r=new z$W(z$U);return z$c._compileToTree(z$r,z$V.split("\n"),0,z$U,z$p),z$r}var z$T=z$G.now();this._VS=z$R(z$U),this._PS=z$R(z$r),this._nameMap=z$s,2<z$G.now()-z$T&&console.log("ShaderCompile use time:"+(z$G.now()-z$T)+"  size:"+z$U.length+"/"+z$r.length)}z$_(z$O,"laya.webgl.utils.ShaderCompile");var z$V=z$O.prototype;return z$V._compileToTree=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_=0,z$G=0,z$q=0,z$u=0;for(z$G=z$r;z$G<z$U.length;z$G++)if(!((z$T=z$U[z$G]).length<1)&&0!==(z$_=z$T.indexOf("//"))){if(0<=z$_&&(z$T=z$T.substr(0,z$_)),z$c=z$S||new z$W(z$s),z$S=null,z$c.text=z$T,z$c.noCompile=!0,0<=(z$_=z$T.indexOf("#"))){for(z$N="#",z$u=z$_+1,z$q=z$T.length;z$u<z$q;z$u++){var z$h=z$T.charAt(z$u);if(" "===z$h||"\t"===z$h||"\r"===z$h||"\n"===z$h||"?"===z$h)break;z$N+=z$h}switch(z$c.name=z$N){case"#ifdef":case"#ifndef":if(z$c.src=z$T,z$c.noCompile=null!=z$T.match(/[!&|()=<>]/),z$c.noCompile?console.log("function():Boolean{return "+z$T.substr(z$_+z$c.name.length)+"}"):(z$b=z$T.replace(/^\s*/,"").split(/\s+/),z$c.setCondition(z$b[1],"#ifdef"===z$N?1:2),z$c.text="//"+z$c.text),z$c.setParent(z$V),z$V=z$c,z$p)for(z$b=z$T.substr(z$u).split(z$O._splitToWordExps3),z$u=0;z$u<z$b.length;z$u++)(z$T=z$b[z$u]).length&&(z$p[z$T]=!0);continue;case"#if":if(z$c.src=z$T,z$c.noCompile=!0,z$c.setParent(z$V),z$V=z$c,z$p)for(z$b=z$T.substr(z$u).split(z$O._splitToWordExps3),z$u=0;z$u<z$b.length;z$u++)(z$T=z$b[z$u]).length&&"defined"!=z$T&&(z$p[z$T]=!0);continue;case"#else":z$c.src=z$T,z$R=(z$V=z$V.parent).childs[z$V.childs.length-1],z$c.noCompile=z$R.noCompile,z$c.noCompile||(z$c.condition=z$R.condition,z$c.conditionType=1==z$R.conditionType?2:1,z$c.text="//"+z$c.text+" "+z$R.text+" "+z$c.conditionType),z$c.setParent(z$V),z$V=z$c;continue;case"#endif":z$R=(z$V=z$V.parent).childs[z$V.childs.length-1],z$c.noCompile=z$R.noCompile,z$c.noCompile||(z$c.text="//"+z$c.text),z$c.setParent(z$V);continue;case"#include":z$b=z$O.splitToWords(z$T,null);var z$l=z$O.includes[z$b[1]];if(!z$l)throw"ShaderCompile error no this include file:"+z$b[1];if((z$_=z$b[0].indexOf("?"))<0){z$c.setParent(z$V),z$T=z$l.getWith("with"==z$b[2]?z$b[3]:null),this._compileToTree(z$c,z$T.split("\n"),0,z$s,z$p),z$c.text="";continue}z$c.setCondition(z$b[0].substr(z$_+1),1),z$c.text=z$l.getWith("with"==z$b[2]?z$b[3]:null);break;case"#import":z$t=(z$b=z$O.splitToWords(z$T,null))[1],z$s.push({node:z$c,file:z$O.includes[z$t],ofs:z$c.text.length});continue}}else{if((z$R=z$V.childs[z$V.childs.length-1])&&!z$R.name){0<z$s.length&&z$O.splitToWords(z$T,z$R),z$S=z$c,z$R.text+="\n"+z$T;continue}0<z$s.length&&z$O.splitToWords(z$T,z$c)}z$c.setParent(z$V)}},z$V.createShader=function(z$V,z$U,z$r){var z$s={},z$p="";if(z$V)for(var z$c in z$V)z$p+="#define "+z$c+"\n",z$s[z$c]=!0;var z$R=this._VS.toscript(z$s,[]),z$T=this._PS.toscript(z$s,[]);return(z$r||z$FV.create)(z$p+z$R.join("\n"),z$p+z$T.join("\n"),z$U,this._nameMap)},z$O._parseOne=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R={type:z$O.shaderParamsMap[z$r[z$s+1]],name:z$r[z$s+2],size:isNaN(parseInt(z$r[z$s+3]))?1:parseInt(z$r[z$s+3])};return z$c&&("attribute"==z$p?z$V.push(z$R):z$U.push(z$R)),":"==z$r[z$s+3]&&(z$R.type=z$r[z$s+4],z$s+=2),z$s+=2},z$O.addInclude=function(z$V,z$U){if(!z$U||0===z$U.length)throw new Error("add shader include file err:"+z$V);if(z$O.includes[z$V])throw new Error("add shader include file err, has add:"+z$V);z$O.includes[z$V]=new z$r(z$U)},z$O.preGetParams=function(z$V,z$U){var z$r=[z$V,z$U],z$s={},z$p=[],z$c=[],z$R={},z$T=[];z$s.attributes=z$p,z$s.uniforms=z$c,z$s.defines=z$R;for(var z$N=0,z$t=0,z$b=0;z$b<2;z$b++){z$r[z$b]=z$r[z$b].replace(z$O._removeAnnotation,"");var z$S,z$_=z$r[z$b].match(z$O._reg);for(z$N=0,z$t=z$_.length;z$N<z$t;z$N++){var z$G=z$_[z$N];if("attribute"==z$G||"uniform"==z$G)z$N=z$O._parseOne(z$p,z$c,z$_,z$N,z$G,!0);else{if("#define"==z$G){z$T[z$G=z$_[++z$N]]=1;continue}if("#ifdef"==z$G){z$R[z$S=z$_[++z$N]]=z$R[z$S]||[];for(z$N++;z$N<z$t;z$N++)if("attribute"==(z$G=z$_[z$N])||"uniform"==z$G)z$N=z$O._parseOne(z$p,z$c,z$_,z$N,z$G,z$T[z$S]);else if("#else"==z$G)for(z$N++;z$N<z$t;z$N++)if("attribute"==(z$G=z$_[z$N])||"uniform"==z$G)z$N=z$O._parseOne(z$p,z$c,z$_,z$N,z$G,!z$T[z$S]);else if("#endif"==z$G)break}}}}return z$s},z$O.splitToWords=function(z$V,z$U){for(var z$r,z$s,z$p=[],z$c=-1,z$R=0,z$T=z$V.length;z$R<z$T;z$R++)if(z$r=z$V.charAt(z$R),0<=" \t=+-*/&%!<>()'\",;".indexOf(z$r)){if(0<=z$c&&1<z$R-z$c&&(z$s=z$V.substr(z$c,z$R-z$c),z$p.push(z$s)),'"'==z$r||"'"==z$r){var z$N=z$V.indexOf(z$r,z$R+1);if(z$N<0)throw"Sharder err:"+z$V;z$p.push(z$V.substr(z$R+1,z$N-z$R-1)),z$R=z$N,z$c=-1;continue}"("==z$r&&z$U&&0<z$p.length&&(z$s=z$p[z$p.length-1]+";","vec4;main;".indexOf(z$s)<0&&(z$U.useFuns+=z$s)),z$c=-1}else z$c<0&&(z$c=z$R);return z$c<z$T&&1<z$T-z$c&&(z$s=z$V.substr(z$c,z$T-z$c),z$p.push(z$s)),z$p},z$O.IFDEF_NO=0,z$O.IFDEF_YES=1,z$O.IFDEF_ELSE=2,z$O.IFDEF_PARENT=3,z$O._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),z$O._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),z$O._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),z$O.includes={},z$R(z$O,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),z$O.__init$=function(){z$W=function(){function z$r(z$V){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=z$V}z$_(z$r,"");var z$V=z$r.prototype;return z$V.setParent=function(z$V){z$V.childs.push(this),this.z=z$V.z+1,this.parent=z$V},z$V.setCondition=function(z$V,z$U){z$V&&(this.conditionType=z$U,z$V=z$V.replace(/(\s*$)/g,""),this.condition=function(){return this[z$V]},this.condition.__condition=z$V)},z$V.toscript=function(z$V,z$U){return this._toscript(z$V,z$U,++z$r.__id)},z$V._toscript=function(z$s,z$p,z$c){if(this.childs.length<1&&!this.text)return z$p;z$p.length;if(this.condition){var z$V=!!this.condition.call(z$s);if(2===this.conditionType&&(z$V=!z$V),!z$V)return z$p}if(this.text&&z$p.push(this.text),0<this.childs.length&&this.childs.forEach(function(z$V,z$U,z$r){z$V._toscript(z$s,z$p,z$c)}),0<this.includefiles.length&&0<this.useFuns.length)for(var z$U,z$r=0,z$R=this.includefiles.length;z$r<z$R;z$r++)this.includefiles[z$r].curUseID!=z$c&&0<(z$U=this.includefiles[z$r].file.getFunsScript(this.useFuns)).length&&(this.includefiles[z$r].curUseID=z$c,z$p[0]=z$U+z$p[0]);return z$p},z$r.__id=1,z$r}(),z$r=function(){function z$V(z$V){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=z$V;for(var z$U=0,z$r=0,z$s=0;!((z$U=z$V.indexOf("#begin",z$U))<0);){for(z$s=z$U+5;!((z$s=z$V.indexOf("#end",z$s))<0)&&"i"===z$V.charAt(z$s+4);)z$s+=5;if(z$s<0)throw"add include err,no #end:"+z$V;z$r=z$V.indexOf("\n",z$U);var z$p=z$O.splitToWords(z$V.substr(z$U,z$r-z$U),null);"code"==z$p[1]?this.codes[z$p[2]]=z$V.substr(z$r+1,z$s-z$r-1):"function"==z$p[1]&&(z$r=z$V.indexOf("function",z$U),z$r+="function".length,this.funs[z$p[3]]=z$V.substr(z$r+1,z$s-z$r-1),this.funnames+=z$p[3]+";"),z$U=z$s+1}}z$_(z$V,"");var z$U=z$V.prototype;return z$U.getWith=function(z$V){var z$U=z$V?this.codes[z$V]:this.script;if(!z$U)throw"get with error:"+z$V;return z$U},z$U.getFunsScript=function(z$V){var z$U="";for(var z$r in this.funs)0<=z$V.indexOf(z$r+";")&&(z$U+=this.funs[z$r]);return z$U},z$V}()},z$O}(),z$LV=function(){function z$R(){}return z$_(z$R,"laya.webgl.WebGL"),z$R._uint8ArraySlice=function(){for(var z$V=this.length,z$U=new Uint8Array(this.length),z$r=0;z$r<z$V;z$r++)z$U[z$r]=this[z$r];return z$U},z$R._float32ArraySlice=function(){for(var z$V=this.length,z$U=new Float32Array(this.length),z$r=0;z$r<z$V;z$r++)z$U[z$r]=this[z$r];return z$U},z$R._uint16ArraySlice=function(z$V){var z$U,z$r=arguments,z$s=0,z$p=0;if(0===z$r.length)for(z$s=this.length,z$U=new Uint16Array(z$s),z$p=0;z$p<z$s;z$p++)z$U[z$p]=this[z$p];else if(2===z$r.length){var z$c=z$r[0],z$R=z$r[1];if(z$c<z$R)for(z$s=z$R-z$c,z$U=new Uint16Array(z$s),z$p=z$c;z$p<z$R;z$p++)z$U[z$p-z$c]=this[z$p];else z$U=new Uint16Array(0)}return z$U},z$R.expandContext=function(){var z$V=z$p.prototype,z$U=CanvasRenderingContext2D.prototype;z$U.fillTrangles=z$V.fillTrangles,z$gV.__int__(null),z$U.setIBVB=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){void 0===z$N&&(z$N=0),void 0===z$t&&(z$t=0),null===z$r&&(this._ib=this._ib||z$CV.QuadrangleIB,z$r=this._ib,z$hV.expandIBQuadrangle(z$r,z$s._byteLength/64+8)),this._setIBVB(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t)},z$U.fillTrangles=function(z$V,z$U,z$r,z$s,z$p){this._curMat=this._curMat||z$n.create(),this._vb=this._vb||z$fV.create(),this._ib||(this._ib=z$CV.create(),z$hV.fillIBQuadrangle(this._ib,z$R/4));var z$c=this._vb,z$R=z$s.length>>4;z$hV.fillTranglesVB(z$c,z$U,z$r,z$s,z$p||this._curMat,0,0),z$hV.expandIBQuadrangle(this._ib,z$c._byteLength/64+8);var z$T=new z$DV(1,0);z$T.textureHost=z$V;var z$N=new z$YV("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");z$c._vertType=3,this._setIBVB(z$U,z$r,this._ib,z$c,6*z$R,z$p,z$N,z$T,0,0)}},z$R.enable=function(){if(z$G.__init__(),z$l.isConchApp&&!z$l.isConchWebGL)return z$d.skinAniSprite=function(){return new z$VV},z$R.expandContext(),!1;if(z$d.getWebGLContext=function(z$V){for(var z$U,z$r=["webgl","experimental-webgl","webkit-3d","moz-webgl"],z$s=0;z$s<z$r.length;z$s++){try{z$U=z$V.getContext(z$r[z$s],{stencil:z$y.isStencil,alpha:z$y.isAlpha,antialias:z$y.isAntialias,premultipliedAlpha:z$y.premultipliedAlpha,preserveDrawingBuffer:z$y.preserveDrawingBuffer})}catch(z$V){}if(z$U)return z$U}return null},null==(z$R.mainContext=z$R.mainContext||z$d.getWebGLContext(z$l._mainCanvas)))return!1;if(z$l.isWebGL)return!0;z$u.create=function(z$V,z$U){return new z$VU(z$V,z$U)},z$h.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){return new z$eV(z$V,z$U,z$r,z$s,z$p,z$c,z$R)},z$l.WebGL=z$R,z$l.isWebGL=!0,z$GV.__init__(),z$d.createRenderSprite=function(z$V,z$U){return new z$nV(z$V,z$U)},z$d.createWebGLContext2D=function(z$V){return new z$yV(z$V)},z$d.changeWebGLSize=function(z$V,z$U){laya.webgl.WebGL.onStageResize(z$V,z$U)},z$d.createGraphics=function(){return new z$kV};var z$V=z$d.createFilterAction;return z$d.createFilterAction=z$V||function(z$V){return new z$IV},z$d.clear=function(z$V){z$WV.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var z$U=z$l.context.ctx,z$r=0==z$U._submits._length||z$y.preserveDrawingBuffer?z$q.create(z$V)._color:z$w._wgColor;z$r&&z$U.clearBG(z$r[0],z$r[1],z$r[2],z$r[3]),z$WV.clear()},z$d.addToAtlas=function(z$V,z$U){void 0===z$U&&(z$U=!1);var z$r=z$V.bitmap;z$l.optimizeTextureMemory(z$V.url,z$V)?z$k.__typeof(z$r,"laya.webgl.resource.IMergeAtlasBitmap")&&z$r.allowMerageInAtlas&&z$r.on("recovered",z$V,z$V.addTextureToAtlas):z$r.enableMerageInAtlas=!1},z$d.isAtlas=function(z$V){return z$V instanceof laya.webgl.atlas.AtlasWebGLCanvas},z$J._enable(),z$d.beginFlush=function(){for(var z$V=z$J.instance,z$U=z$V.getAtlaserCount(),z$r=0;z$r<z$U;z$r++){var z$s=z$V.getAtlaserByIndex(z$r).texture;z$s._flashCacheImageNeedFlush&&z$d.flashFlushImage(z$s)}},z$d.drawToCanvas=function(z$V,z$U,z$r,z$s,z$p,z$c){(z$r<=0||z$s<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),z$r|=0,z$s|=0,z$p|=0,z$c|=0;var z$R=z$xV.create(z$r,z$s,6408,5121,0,!1);z$R.start(),z$R.clear(0,0,0,0),z$l.context.clear(),z$W.renders[z$U]._fun(z$V,z$l.context,z$p,z$WV.height-z$s+z$c),z$l.context.flush(),z$R.end();var z$T=z$R.getData(0,0,z$r,z$s);if(z$R.recycle(),z$T.byteLength==z$r*z$s*4){var z$N=new z$MV;z$N._canvas=z$G.createElement("canvas"),z$N.size(z$r,z$s);var z$t=z$N._canvas.getContext("2d");z$G.canvas.size(z$r,z$s);var z$b=z$G.context,z$S=z$b.createImageData(z$r,z$s);return z$S.data.set(new Uint8ClampedArray(z$T.buffer)),z$N._imgData=z$S,z$b.putImageData(z$S,0,0),z$t.save(),z$t.translate(0,z$s),z$t.scale(1,-1),z$t.drawImage(z$G.canvas.source,0,0),z$t.restore(),z$N}console.log("drawToCanvas error: w:"+z$r+",h:"+z$s+",datalen:"+z$T.byteLength)},z$d.createFilterAction=function(z$V){var z$U;switch(z$V){case 32:z$U=new z$IV}return z$U},z$d.addTextureToAtlas=function(z$V){z$V._uvID++,z$J._atlasRestore++,z$V.bitmap.enableMerageInAtlas&&z$J.instance.addToAtlas(z$V)},z$d.getTexturePixels=function(z$V,z$U,z$r,z$s,z$p){z$l.context.ctx.clear();var z$c=new z$H;z$c.graphics.drawTexture(z$V,-z$U,-z$r);var z$R=z$xV.create(z$s,z$p);z$R.start(),z$R.clear(0,0,0,0),z$c.render(z$l.context,0,0),z$l.context.ctx.flush(),z$R.end();for(var z$T=z$R.getData(0,0,z$s,z$p),z$N=[],z$t=0,z$b=z$p-1;0<=z$b;z$b--)for(var z$S=0;z$S<z$s;z$S++)z$t=4*(z$b*z$s+z$S),z$N.push(z$T[z$t]),z$N.push(z$T[z$t+1]),z$N.push(z$T[z$t+2]),z$N.push(z$T[z$t+3]);return z$N},z$d.skinAniSprite=function(){return new z$VV},z$t.create=function(z$V,z$U){var z$r=new z$MV;return z$r._imgData=z$U,z$r.flipY=!1,z$r},z$D._filterStart=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$V.getValue("bounds"),z$R=z$xV.create(z$c.width,z$c.height);if(z$R.start(),z$R.clear(0,0,0,0),z$V.addValue("src",z$R),z$V.addValue("ScissorTest",z$WV.worldScissorTest),z$WV.worldScissorTest){var z$T=new z$Q;z$T.copyFrom(z$r.ctx._clipRect),z$V.addValue("clipRect",z$T),z$WV.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},z$D._filterEnd=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$V.getValue("bounds");z$V.getValue("src").end();var z$R=z$xV.create(z$c.width,z$c.height);z$R.start(),z$R.clear(0,0,0,0),z$V.addValue("out",z$R),z$U._set$P("_filterCache",z$R),z$U._set$P("_isHaveGlowFilter",z$V.getValue("_isHaveGlowFilter"))},z$D._EndTarget=function(z$V,z$U){if(z$V.getValue("src").recycle(),z$V.getValue("out").end(),z$V.getValue("ScissorTest")){z$WV.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),z$U.ctx.save();var z$r=z$V.getValue("clipRect");z$U.ctx.clipRect(z$r.x,z$r.y,z$r.width,z$r.height)}},z$D._useSrc=function(z$V){var z$U=z$V.getValue("out");z$U.end(),(z$U=z$V.getValue("src")).start(),z$U.clear(0,0,0,0)},z$D._endSrc=function(z$V){z$V.getValue("src").end()},z$D._useOut=function(z$V){var z$U=z$V.getValue("src");z$U.end(),(z$U=z$V.getValue("out")).start(),z$U.clear(0,0,0,0)},z$D._endOut=function(z$V){z$V.getValue("out").end()},z$D._recycleScope=function(z$V){z$V.recycle()},z$D._filter=function(z$V,z$U,z$r,z$s){var z$p=this._next;if(z$p){var z$c,z$R,z$T=z$V.filters,z$N=z$T.length;if(1==z$N&&32==z$T[0].type)return z$U.ctx.save(),z$U.ctx.setFilters([z$T[0]]),z$p._fun.call(z$p,z$V,z$U,z$r,z$s),void z$U.ctx.restore();var z$t=z$TV.create(),z$b=z$I.TEMP,z$S=z$U.ctx._getTransformMatrix(),z$_=z$n.create();z$S.copyTo(z$_);var z$G=0,z$q=0,z$u=!1,z$h=z$V._$P._filterCache?z$V._$P._filterCache:null;if(!z$h||z$V._repaint){z$u=z$V._isHaveGlowFilter(),z$t.addValue("_isHaveGlowFilter",z$u),z$u&&(z$G=50,z$q=25),(z$R=new z$Q).copyFrom(z$V.getSelfBounds()),z$R.x+=z$V.x,z$R.y+=z$V.y,z$R.x-=z$V.pivotX+4,z$R.y-=z$V.pivotY+4;var z$l=z$R.x,z$W=z$R.y;if(z$R.width+=z$G+8,z$R.height+=z$G+8,z$b.x=z$R.x*z$_.a+z$R.y*z$_.c,z$b.y=z$R.y*z$_.d+z$R.x*z$_.b,z$R.x=z$b.x,z$R.y=z$b.y,z$b.x=z$R.width*z$_.a+z$R.height*z$_.c,z$b.y=z$R.height*z$_.d+z$R.width*z$_.b,z$R.width=z$b.x,z$R.height=z$b.y,z$R.width<=0||z$R.height<=0)return;z$h&&z$h.recycle(),z$t.addValue("bounds",z$R);var z$O=z$RV.create([z$t,z$V,z$U,0,0],z$D._filterStart);z$U.addRenderObject(z$O),z$U.ctx._renderKey=0,z$U.ctx._shader2D.glTexture=null;var z$L=z$V.x-z$l+z$q,z$d=z$V.y-z$W+z$q;z$p._fun.call(z$p,z$V,z$U,z$L,z$d),z$O=z$RV.create([z$t,z$V,z$U,0,0],z$D._filterEnd),z$U.addRenderObject(z$O);for(var z$k=0;z$k<z$N;z$k++){0!=z$k&&(z$O=z$RV.create([z$t],z$D._useSrc),z$U.addRenderObject(z$O),z$c=z$DV.create(1,0),z$n.TEMP.identity(),z$U.ctx.drawTarget(z$t,0,0,z$R.width,z$R.height,z$n.TEMP,"out",z$c,null,z$B.TOINT.overlay),z$O=z$RV.create([z$t],z$D._useOut),z$U.addRenderObject(z$O)),z$T[z$k].action.apply3d(z$t,z$V,z$U,0,0)}z$O=z$RV.create([z$t,z$U],z$D._EndTarget),z$U.addRenderObject(z$O)}else{if((z$u=!!z$V._$P._isHaveGlowFilter&&z$V._$P._isHaveGlowFilter)&&(z$G=50,z$q=25),(z$R=z$V.getBounds()).width<=0||z$R.height<=0)return;z$R.width+=z$G,z$R.height+=z$G,z$b.x=z$R.x*z$_.a+z$R.y*z$_.c,z$b.y=z$R.y*z$_.d+z$R.x*z$_.b,z$R.x=z$b.x,z$R.y=z$b.y,z$b.x=z$R.width*z$_.a+z$R.height*z$_.c,z$b.y=z$R.height*z$_.d+z$R.width*z$_.b,z$R.width=z$b.x,z$R.height=z$b.y,z$t.addValue("out",z$h)}z$r=z$r-z$q-z$V.x,z$s=z$s-z$q-z$V.y,z$b.setTo(z$r,z$s),z$_.transformPoint(z$b),z$r=z$b.x+z$R.x,z$s=z$b.y+z$R.y,z$c=z$DV.create(1,0),z$n.TEMP.identity(),z$U.ctx.drawTarget(z$t,z$r,z$s,z$R.width,z$R.height,z$n.TEMP,"out",z$c,null,z$B.TOINT.overlay),z$O=z$RV.create([z$t],z$D._recycleScope),z$U.addRenderObject(z$O),z$_.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=z$R._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=z$R._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=z$R._uint8ArraySlice),!0},z$R.onStageResize=function(z$V,z$U){null!=z$R.mainContext&&(z$R.mainContext.viewport(0,0,z$V,z$U),z$WV.width=z$V,z$WV.height=z$U)},z$R.onInvalidGLRes=function(){z$J.instance.freeAll(),z$L.releaseContentManagers(!0),z$R.doNodeRepaint(z$k.stage),z$R.mainContext.viewport(0,0,z$WV.width,z$WV.height),z$k.stage.event("devicelost")},z$R.doNodeRepaint=function(z$V){0==z$V.numChildren&&z$V.repaint();for(var z$U=0;z$U<z$V.numChildren;z$U++)z$R.doNodeRepaint(z$V.getChildAt(z$U))},z$R.init=function(z$V,z$U,z$r){z$R.mainCanvas=z$V,z$t._createContext=function(z$V){return new z$yV(z$V)},z$MV._createContext=function(z$V){return new z$yV(z$V)};var z$s=laya.webgl.WebGL.mainContext;if(null!=z$s.getShaderPrecisionFormat){var z$p=z$s.getShaderPrecisionFormat(35633,36338),z$c=z$s.getShaderPrecisionFormat(35632,36338);z$R.shaderHighPrecision=!(!z$p.precision||!z$c.precision)}else z$R.shaderHighPrecision=!1;if(z$R.compressAstc=z$s.getExtension("WEBGL_compressed_texture_astc"),z$R.compressAtc=z$s.getExtension("WEBGL_compressed_texture_atc"),z$R.compressEtc=z$s.getExtension("WEBGL_compressed_texture_etc"),z$R.compressEtc1=z$s.getExtension("WEBGL_compressed_texture_etc1"),z$R.compressPvrtc=z$s.getExtension("WEBGL_compressed_texture_pvrtc"),z$R.compressS3tc=z$s.getExtension("WEBGL_compressed_texture_s3tc"),z$R.compressS3tc_srgb=z$s.getExtension("WEBGL_compressed_texture_s3tc_srgb"),z$R.compressAstc=z$R.compressAstc?z$R.compressAstc:{},z$R.compressAtc=z$R.compressAtc?z$R.compressAtc:{},z$R.compressEtc=z$R.compressEtc?z$R.compressEtc:{},z$R.compressEtc1=z$R.compressEtc1?z$R.compressEtc1:{},z$R.compressPvrtc=z$R.compressPvrtc?z$R.compressPvrtc:{},z$R.compressS3tc=z$R.compressS3tc?z$R.compressS3tc:{},z$R.compressS3tc_srgb=z$R.compressS3tc_srgb?z$R.compressS3tc_srgb:{},z$s.deleteTexture1=z$s.deleteTexture,z$s.deleteTexture=function(z$V){z$V==z$dV.curBindTexValue&&(z$dV.curBindTexValue=null),z$s.deleteTexture1(z$V)},z$R.onStageResize(z$U,z$r),null==z$R.mainContext)throw new Error("webGL getContext err!");z$K.__init__(),z$J.__init__(),z$HV.__init__(),z$cV.__init__(),z$yV.__init__(),z$DV.__init__(),z$C.__init__(),z$gV.__int__(z$s),z$B._init_(z$s),z$l.isConchApp&&conch.setOnInvalidGLRes(z$R.onInvalidGLRes)},z$R.mainCanvas=null,z$R.antialias=!0,z$R.shaderHighPrecision=!1,z$R._bg_null=[0,0,0,0],z$R}(),z$dV=function(){function z$s(){}return z$_(z$s,"laya.webgl.WebGLContext"),z$s.UseProgram=function(z$V){return z$s._useProgram!==z$V&&(z$LV.mainContext.useProgram(z$V),z$s._useProgram=z$V,!0)},z$s.setDepthTest=function(z$V,z$U){z$U!==z$s._depthTest&&((z$s._depthTest=z$U)?z$V.enable(2929):z$V.disable(2929))},z$s.setDepthMask=function(z$V,z$U){z$U!==z$s._depthMask&&(z$s._depthMask=z$U,z$V.depthMask(z$U))},z$s.setDepthFunc=function(z$V,z$U){z$U!==z$s._depthFunc&&(z$s._depthFunc=z$U,z$V.depthFunc(z$U))},z$s.setBlend=function(z$V,z$U){z$U!==z$s._blend&&((z$s._blend=z$U)?z$V.enable(3042):z$V.disable(3042))},z$s.setBlendFunc=function(z$V,z$U,z$r){(z$U!==z$s._sFactor||z$r!==z$s._dFactor)&&(z$s._sFactor=z$U,z$s._dFactor=z$r,z$V.blendFunc(z$U,z$r))},z$s.setCullFace=function(z$V,z$U){z$U!==z$s._cullFace&&((z$s._cullFace=z$U)?z$V.enable(2884):z$V.disable(2884))},z$s.setFrontFace=function(z$V,z$U){z$U!==z$s._frontFace&&(z$s._frontFace=z$U,z$V.frontFace(z$U))},z$s.bindTexture=function(z$V,z$U,z$r){z$V.bindTexture(z$U,z$r),z$s.curBindTexTarget=z$U,z$s.curBindTexValue=z$r},z$s.DEPTH_BUFFER_BIT=256,z$s.STENCIL_BUFFER_BIT=1024,z$s.COLOR_BUFFER_BIT=16384,z$s.POINTS=0,z$s.LINES=1,z$s.LINE_LOOP=2,z$s.LINE_STRIP=3,z$s.TRIANGLES=4,z$s.TRIANGLE_STRIP=5,z$s.TRIANGLE_FAN=6,z$s.ZERO=0,z$s.ONE=1,z$s.SRC_COLOR=768,z$s.ONE_MINUS_SRC_COLOR=769,z$s.SRC_ALPHA=770,z$s.ONE_MINUS_SRC_ALPHA=771,z$s.DST_ALPHA=772,z$s.ONE_MINUS_DST_ALPHA=773,z$s.DST_COLOR=774,z$s.ONE_MINUS_DST_COLOR=775,z$s.SRC_ALPHA_SATURATE=776,z$s.FUNC_ADD=32774,z$s.BLEND_EQUATION=32777,z$s.BLEND_EQUATION_RGB=32777,z$s.BLEND_EQUATION_ALPHA=34877,z$s.FUNC_SUBTRACT=32778,z$s.FUNC_REVERSE_SUBTRACT=32779,z$s.BLEND_DST_RGB=32968,z$s.BLEND_SRC_RGB=32969,z$s.BLEND_DST_ALPHA=32970,z$s.BLEND_SRC_ALPHA=32971,z$s.CONSTANT_COLOR=32769,z$s.ONE_MINUS_CONSTANT_COLOR=32770,z$s.CONSTANT_ALPHA=32771,z$s.ONE_MINUS_CONSTANT_ALPHA=32772,z$s.BLEND_COLOR=32773,z$s.ARRAY_BUFFER=34962,z$s.ELEMENT_ARRAY_BUFFER=34963,z$s.ARRAY_BUFFER_BINDING=34964,z$s.ELEMENT_ARRAY_BUFFER_BINDING=34965,z$s.STREAM_DRAW=35040,z$s.STATIC_DRAW=35044,z$s.DYNAMIC_DRAW=35048,z$s.BUFFER_SIZE=34660,z$s.BUFFER_USAGE=34661,z$s.CURRENT_VERTEX_ATTRIB=34342,z$s.FRONT=1028,z$s.BACK=1029,z$s.CULL_FACE=2884,z$s.FRONT_AND_BACK=1032,z$s.BLEND=3042,z$s.DITHER=3024,z$s.STENCIL_TEST=2960,z$s.DEPTH_TEST=2929,z$s.SCISSOR_TEST=3089,z$s.POLYGON_OFFSET_FILL=32823,z$s.SAMPLE_ALPHA_TO_COVERAGE=32926,z$s.SAMPLE_COVERAGE=32928,z$s.NO_ERROR=0,z$s.INVALID_ENUM=1280,z$s.INVALID_VALUE=1281,z$s.INVALID_OPERATION=1282,z$s.OUT_OF_MEMORY=1285,z$s.CW=2304,z$s.CCW=2305,z$s.LINE_WIDTH=2849,z$s.ALIASED_POINT_SIZE_RANGE=33901,z$s.ALIASED_LINE_WIDTH_RANGE=33902,z$s.CULL_FACE_MODE=2885,z$s.FRONT_FACE=2886,z$s.DEPTH_RANGE=2928,z$s.DEPTH_WRITEMASK=2930,z$s.DEPTH_CLEAR_VALUE=2931,z$s.DEPTH_FUNC=2932,z$s.STENCIL_CLEAR_VALUE=2961,z$s.STENCIL_FUNC=2962,z$s.STENCIL_FAIL=2964,z$s.STENCIL_PASS_DEPTH_FAIL=2965,z$s.STENCIL_PASS_DEPTH_PASS=2966,z$s.STENCIL_REF=2967,z$s.STENCIL_VALUE_MASK=2963,z$s.STENCIL_WRITEMASK=2968,z$s.STENCIL_BACK_FUNC=34816,z$s.STENCIL_BACK_FAIL=34817,z$s.STENCIL_BACK_PASS_DEPTH_FAIL=34818,z$s.STENCIL_BACK_PASS_DEPTH_PASS=34819,z$s.STENCIL_BACK_REF=36003,z$s.STENCIL_BACK_VALUE_MASK=36004,z$s.STENCIL_BACK_WRITEMASK=36005,z$s.VIEWPORT=2978,z$s.SCISSOR_BOX=3088,z$s.COLOR_CLEAR_VALUE=3106,z$s.COLOR_WRITEMASK=3107,z$s.UNPACK_ALIGNMENT=3317,z$s.PACK_ALIGNMENT=3333,z$s.MAX_TEXTURE_SIZE=3379,z$s.MAX_VIEWPORT_DIMS=3386,z$s.SUBPIXEL_BITS=3408,z$s.RED_BITS=3410,z$s.GREEN_BITS=3411,z$s.BLUE_BITS=3412,z$s.ALPHA_BITS=3413,z$s.DEPTH_BITS=3414,z$s.STENCIL_BITS=3415,z$s.POLYGON_OFFSET_UNITS=10752,z$s.POLYGON_OFFSET_FACTOR=32824,z$s.TEXTURE_BINDING_2D=32873,z$s.SAMPLE_BUFFERS=32936,z$s.SAMPLES=32937,z$s.SAMPLE_COVERAGE_VALUE=32938,z$s.SAMPLE_COVERAGE_INVERT=32939,z$s.NUM_COMPRESSED_TEXTURE_FORMATS=34466,z$s.COMPRESSED_TEXTURE_FORMATS=34467,z$s.DONT_CARE=4352,z$s.FASTEST=4353,z$s.NICEST=4354,z$s.GENERATE_MIPMAP_HINT=33170,z$s.BYTE=5120,z$s.UNSIGNED_BYTE=5121,z$s.SHORT=5122,z$s.UNSIGNED_SHORT=5123,z$s.INT=5124,z$s.UNSIGNED_INT=5125,z$s.FLOAT=5126,z$s.DEPTH_COMPONENT=6402,z$s.ALPHA=6406,z$s.RGB=6407,z$s.RGBA=6408,z$s.LUMINANCE=6409,z$s.LUMINANCE_ALPHA=6410,z$s.UNSIGNED_SHORT_4_4_4_4=32819,z$s.UNSIGNED_SHORT_5_5_5_1=32820,z$s.UNSIGNED_SHORT_5_6_5=33635,z$s.FRAGMENT_SHADER=35632,z$s.VERTEX_SHADER=35633,z$s.MAX_VERTEX_ATTRIBS=34921,z$s.MAX_VERTEX_UNIFORM_VECTORS=36347,z$s.MAX_VARYING_VECTORS=36348,z$s.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,z$s.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,z$s.MAX_TEXTURE_IMAGE_UNITS=34930,z$s.MAX_FRAGMENT_UNIFORM_VECTORS=36349,z$s.SHADER_TYPE=35663,z$s.DELETE_STATUS=35712,z$s.LINK_STATUS=35714,z$s.VALIDATE_STATUS=35715,z$s.ATTACHED_SHADERS=35717,z$s.ACTIVE_UNIFORMS=35718,z$s.ACTIVE_ATTRIBUTES=35721,z$s.SHADING_LANGUAGE_VERSION=35724,z$s.CURRENT_PROGRAM=35725,z$s.NEVER=512,z$s.LESS=513,z$s.EQUAL=514,z$s.LEQUAL=515,z$s.GREATER=516,z$s.NOTEQUAL=517,z$s.GEQUAL=518,z$s.ALWAYS=519,z$s.KEEP=7680,z$s.REPLACE=7681,z$s.INCR=7682,z$s.DECR=7683,z$s.INVERT=5386,z$s.INCR_WRAP=34055,z$s.DECR_WRAP=34056,z$s.VENDOR=7936,z$s.RENDERER=7937,z$s.VERSION=7938,z$s.NEAREST=9728,z$s.LINEAR=9729,z$s.NEAREST_MIPMAP_NEAREST=9984,z$s.LINEAR_MIPMAP_NEAREST=9985,z$s.NEAREST_MIPMAP_LINEAR=9986,z$s.LINEAR_MIPMAP_LINEAR=9987,z$s.TEXTURE_MAG_FILTER=10240,z$s.TEXTURE_MIN_FILTER=10241,z$s.TEXTURE_WRAP_S=10242,z$s.TEXTURE_WRAP_T=10243,z$s.TEXTURE_2D=3553,z$s.TEXTURE=5890,z$s.TEXTURE_CUBE_MAP=34067,z$s.TEXTURE_BINDING_CUBE_MAP=34068,z$s.TEXTURE_CUBE_MAP_POSITIVE_X=34069,z$s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,z$s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,z$s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,z$s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,z$s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,z$s.MAX_CUBE_MAP_TEXTURE_SIZE=34076,z$s.TEXTURE0=33984,z$s.TEXTURE1=33985,z$s.TEXTURE2=33986,z$s.TEXTURE3=33987,z$s.TEXTURE4=33988,z$s.TEXTURE5=33989,z$s.TEXTURE6=33990,z$s.TEXTURE7=33991,z$s.TEXTURE8=33992,z$s.TEXTURE9=33993,z$s.TEXTURE10=33994,z$s.TEXTURE11=33995,z$s.TEXTURE12=33996,z$s.TEXTURE13=33997,z$s.TEXTURE14=33998,z$s.TEXTURE15=33999,z$s.TEXTURE16=34e3,z$s.TEXTURE17=34001,z$s.TEXTURE18=34002,z$s.TEXTURE19=34003,z$s.TEXTURE20=34004,z$s.TEXTURE21=34005,z$s.TEXTURE22=34006,z$s.TEXTURE23=34007,z$s.TEXTURE24=34008,z$s.TEXTURE25=34009,z$s.TEXTURE26=34010,z$s.TEXTURE27=34011,z$s.TEXTURE28=34012,z$s.TEXTURE29=34013,z$s.TEXTURE30=34014,z$s.TEXTURE31=34015,z$s.ACTIVE_TEXTURE=34016,z$s.REPEAT=10497,z$s.CLAMP_TO_EDGE=33071,z$s.MIRRORED_REPEAT=33648,z$s.FLOAT_VEC2=35664,z$s.FLOAT_VEC3=35665,z$s.FLOAT_VEC4=35666,z$s.INT_VEC2=35667,z$s.INT_VEC3=35668,z$s.INT_VEC4=35669,z$s.BOOL=35670,z$s.BOOL_VEC2=35671,z$s.BOOL_VEC3=35672,z$s.BOOL_VEC4=35673,z$s.FLOAT_MAT2=35674,z$s.FLOAT_MAT3=35675,z$s.FLOAT_MAT4=35676,z$s.SAMPLER_2D=35678,z$s.SAMPLER_CUBE=35680,z$s.VERTEX_ATTRIB_ARRAY_ENABLED=34338,z$s.VERTEX_ATTRIB_ARRAY_SIZE=34339,z$s.VERTEX_ATTRIB_ARRAY_STRIDE=34340,z$s.VERTEX_ATTRIB_ARRAY_TYPE=34341,z$s.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,z$s.VERTEX_ATTRIB_ARRAY_POINTER=34373,z$s.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,z$s.COMPILE_STATUS=35713,z$s.LOW_FLOAT=36336,z$s.MEDIUM_FLOAT=36337,z$s.HIGH_FLOAT=36338,z$s.LOW_INT=36339,z$s.MEDIUM_INT=36340,z$s.HIGH_INT=36341,z$s.FRAMEBUFFER=36160,z$s.RENDERBUFFER=36161,z$s.RGBA4=32854,z$s.RGB5_A1=32855,z$s.RGB565=36194,z$s.DEPTH_COMPONENT16=33189,z$s.STENCIL_INDEX=6401,z$s.STENCIL_INDEX8=36168,z$s.DEPTH_STENCIL=34041,z$s.RENDERBUFFER_WIDTH=36162,z$s.RENDERBUFFER_HEIGHT=36163,z$s.RENDERBUFFER_INTERNAL_FORMAT=36164,z$s.RENDERBUFFER_RED_SIZE=36176,z$s.RENDERBUFFER_GREEN_SIZE=36177,z$s.RENDERBUFFER_BLUE_SIZE=36178,z$s.RENDERBUFFER_ALPHA_SIZE=36179,z$s.RENDERBUFFER_DEPTH_SIZE=36180,z$s.RENDERBUFFER_STENCIL_SIZE=36181,z$s.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,z$s.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,z$s.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,z$s.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,z$s.COLOR_ATTACHMENT0=36064,z$s.DEPTH_ATTACHMENT=36096,z$s.STENCIL_ATTACHMENT=36128,z$s.DEPTH_STENCIL_ATTACHMENT=33306,z$s.NONE=0,z$s.FRAMEBUFFER_COMPLETE=36053,z$s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,z$s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,z$s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,z$s.FRAMEBUFFER_UNSUPPORTED=36061,z$s.FRAMEBUFFER_BINDING=36006,z$s.RENDERBUFFER_BINDING=36007,z$s.MAX_RENDERBUFFER_SIZE=34024,z$s.INVALID_FRAMEBUFFER_OPERATION=1286,z$s.UNPACK_FLIP_Y_WEBGL=37440,z$s.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,z$s.CONTEXT_LOST_WEBGL=37442,z$s.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,z$s.BROWSER_DEFAULT_WEBGL=37444,z$s._useProgram=null,z$s._depthTest=!0,z$s._depthMask=!0,z$s._blend=!1,z$s._cullFace=!1,z$s.curBindTexTarget=null,z$s.curBindTexValue=null,z$R(z$s,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),z$s}(),z$kV=function(z$V){function z$U(){z$U.__super.call(this)}z$_(z$U,"laya.webgl.display.GraphicsGL",z$T);var z$r=z$U.prototype;return z$r.setShader=function(z$V){this._saveToCmd(z$l.context._setShader,[z$V])},z$r.setIBVB=function(z$V,z$U,z$r,z$s,z$p,z$c){this._saveToCmd(z$l.context._setIBVB,[z$V,z$U,z$r,z$s,z$p,z$c])},z$r.drawParticle=function(z$V,z$U,z$r){var z$s=z$d.createParticleTemplate2D(z$r);z$s.x=z$V,z$s.y=z$U,this._saveToCmd(z$l.context._drawParticle,[z$s])},z$U}(),z$yV=function(z$V){var z$r;function z$o(z$V){this._x=0,this._y=0,this._id=++z$o._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,z$o.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=z$o.MAXCLIPRECT,this.mOutPoint,this._canvas=z$V,this._canvas._addReference(),z$o._contextcount++,z$l.isFlash?(this._ib=z$CV.create(35044),z$hV.fillIBQuadrangle(this._ib,16)):this._ib=z$CV.QuadrangleIB,this.clear()}z$_(z$o,"laya.webgl.canvas.WebGLContext2D",z$p);var z$U=z$o.prototype;return z$U.setIsMainContext=function(){this._isMain=!0},z$U.clearBG=function(z$V,z$U,z$r,z$s){var z$p=z$LV.mainContext;z$p.clearColor(z$V,z$U,z$r,z$s),z$p.clear(16384)},z$U._getSubmits=function(){return this._submits},z$U._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var z$V=0,z$U=this._submits._length;z$V<z$U;z$V++)this._submits[z$V].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},z$U.destroy=function(){--z$o._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=z$CV.QuadrangleIB&&this._ib.releaseResource()},z$U.clear=function(){this._submits||(this._other=z$r.DEFAULT,this._curMat=z$n.create(),this._vb=z$fV.create(-1),this._submits=[],this._save=[z$F.Create(this)],this._save.length=10,this._shader2D=new z$C,this._triangleMesh=z$aV.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=z$r.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=z$o.MAXCLIPRECT,this._curSubmit=z$cV.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=z$P.DEFAULT;for(var z$V=0,z$U=this._submits._length;z$V<z$U;z$V++)this._submits[z$V].releaseRender(),this._submits[z$V]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},z$U.size=function(z$V,z$U){if(this._width!=z$V||this._height!=z$U)if(0==z$V||0==z$U){0!=this._vb._byteLength&&(this._width=z$V,this._height=z$U,this._vb.clear(),this._vb.upload());for(var z$r=0,z$s=this._submits._length;z$r<z$s;z$r++)this._submits[z$r].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=z$V,this._height=z$U,this._targets&&this._targets.size(z$V,z$U),this._canvas.memorySize-=this._canvas.memorySize;0===z$V&&0===z$U&&this._releaseMem()},z$U._getTransformMatrix=function(){return this._curMat},z$U.translate=function(z$V,z$U){0===z$V&&0===z$U||(z$v.save(this),this._curMat.bTransform&&(z$g.save(this),this._curMat.transformPointN(z$I.TEMP.setTo(z$V,z$U)),z$V=z$I.TEMP.x,z$U=z$I.TEMP.y),this._x+=z$V,this._y+=z$U)},z$U.save=function(){this._save[this._save._length++]=z$F.Create(this)},z$U.restore=function(){var z$V=this._save._length;if(!(z$V<1))for(var z$U=z$V-1;0<=z$U;z$U--){var z$r=this._save[z$U];if(z$r.restore(this),z$r.isSaveMark())return void(this._save._length=z$U)}},z$U._fillText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){void 0===z$t&&(z$t=0);var z$b=this._shader2D,z$S=this._curSubmit.shaderValue,z$_=z$p?z$qV.create(z$p):this._other.font;if(z$J.enabled)z$b.ALPHA!==z$S.ALPHA&&(z$b.glTexture=null),z$GV.drawText(this,z$V,z$U,this._curMat,z$_,z$N||this._other.textAlign,z$c,z$R,z$T,z$r,z$s,z$t);else{this._shader2D.defines.getValue();var z$G=z$c?z$q.create(z$c)._color:z$b.colorAdd;z$b.ALPHA===z$S.ALPHA&&z$G===z$b.colorAdd&&z$S.colorAdd===z$b.colorAdd||(z$b.glTexture=null,z$b.colorAdd=z$G),z$GV.drawText(this,z$V,z$U,this._curMat,z$_,z$N||this._other.textAlign,z$c,z$R,z$T,z$r,z$s,z$t)}},z$U.fillWords=function(z$V,z$U,z$r,z$s,z$p,z$c){this._fillText(null,z$V,z$U,z$r,z$s,z$p,null,-1,null,z$c)},z$U.fillBorderWords=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._fillBorderText(null,z$V,z$U,z$r,z$s,z$p,z$c,z$R,null)},z$U.fillText=function(z$V,z$U,z$r,z$s,z$p,z$c){this._fillText(z$V,null,z$U,z$r,z$s,z$p,null,-1,z$c)},z$U.strokeText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._fillText(z$V,null,z$U,z$r,z$s,null,z$p,z$c||1,z$R)},z$U.fillBorderText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){this._fillBorderText(z$V,null,z$U,z$r,z$s,z$p,z$c,z$R,z$T)},z$U._fillBorderText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){if(!z$J.enabled)return this._fillText(z$V,z$U,z$r,z$s,z$p,null,z$R,z$T||1,z$N),void this._fillText(z$V,z$U,z$r,z$s,z$p,z$c,null,-1,z$N);var z$t=this._shader2D,z$b=this._curSubmit.shaderValue;z$t.ALPHA!==z$b.ALPHA&&(z$t.glTexture=null);var z$S=z$p?(z$o._fontTemp.setFont(z$p),z$o._fontTemp):this._other.font;z$GV.drawText(this,z$V,z$U,this._curMat,z$S,z$N||this._other.textAlign,z$c,z$R,z$T||1,z$r,z$s,0)},z$U.fillRect=function(z$V,z$U,z$r,z$s,z$p){var z$c=this._vb;if(z$hV.fillRectImgVb(z$c,this._clipRect,z$V,z$U,z$r,z$s,z$a.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var z$R=this._shader2D.fillStyle;z$p&&(this._shader2D.fillStyle=z$P.create(z$p));var z$T=this._shader2D,z$N=this._curSubmit.shaderValue;if(z$T.fillStyle!==z$N.fillStyle||z$T.ALPHA!==z$N.ALPHA){z$T.glTexture=null;var z$t=this._curSubmit=z$cV.createSubmit(this,this._ib,z$c,(z$c._byteLength-64)/32*3,z$DV.create(2,0));z$t.shaderValue.color=z$T.fillStyle._color._color,z$t.shaderValue.ALPHA=z$T.ALPHA,this._submits[this._submits._length++]=z$t}this._curSubmit._numEle+=6,this._shader2D.fillStyle=z$R}},z$U.fillTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){if(z$V.loaded&&z$V.bitmap&&z$V.source){var z$N=this._vb,z$t=z$V.bitmap.width,z$b=z$V.bitmap.height,z$S=z$V.uv,z$_=z$R.x%z$V.width,z$G=z$R.y%z$V.height;if(z$t!=z$T.w||z$b!=z$T.h){if(!z$T.w&&!z$T.h)switch(z$T.oy=z$T.ox=0,z$c){case"repeat":z$T.width=z$s,z$T.height=z$p;break;case"repeat-x":z$T.width=z$s,z$G<0?z$V.height+z$G>z$p?z$T.height=z$p:z$T.height=z$V.height+z$G:(z$T.oy=z$G,z$V.height+z$G>z$p?z$T.height=z$p-z$G:z$T.height=z$V.height);break;case"repeat-y":z$_<0?z$V.width+z$_>z$s?z$T.width=z$s:z$T.width=z$V.width+z$_:(z$T.ox=z$_,z$V.width+z$_>z$s?z$T.width=z$s-z$_:z$T.width=z$V.width),z$T.height=z$p;break;case"no-repeat":z$_<0?z$V.width+z$_>z$s?z$T.width=z$s:z$T.width=z$V.width+z$_:(z$T.ox=z$_,z$V.width+z$_>z$s?z$T.width=z$s-z$_:z$T.width=z$V.width),z$G<0?z$V.height+z$G>z$p?z$T.height=z$p:z$T.height=z$V.height+z$G:(z$T.oy=z$G,z$V.height+z$G>z$p?z$T.height=z$p-z$G:z$T.height=z$V.height);break;default:z$T.width=z$s,z$T.height=z$p}z$T.w=z$t,z$T.h=z$b,z$T.uv=[0,0,z$T.width/z$t,0,z$T.width/z$t,z$T.height/z$b,0,z$T.height/z$b]}if(z$U+=z$T.ox,z$r+=z$T.oy,z$_-=z$T.ox,z$G-=z$T.oy,z$hV.fillRectImgVb(z$N,this._clipRect,z$U,z$r,z$T.width,z$T.height,z$T.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var z$q=z$mV.create(this,this._ib,z$N,(z$N._byteLength-64)/32*3,z$DV.create(256,0)),z$u=(this._submits[this._submits._length++]=z$q).shaderValue;z$u.textureHost=z$V;var z$h=z$S[0]*z$t,z$l=z$S[1]*z$b,z$W=(z$S[2]-z$S[0])*z$t,z$O=(z$S[5]-z$S[3])*z$b,z$L=-z$_/z$t,z$d=-z$G/z$b;z$u.u_TexRange[0]=z$h/z$t,z$u.u_TexRange[1]=z$W/z$t,z$u.u_TexRange[2]=z$l/z$b,z$u.u_TexRange[3]=z$O/z$b,z$u.u_offset[0]=z$L,z$u.u_offset[1]=z$d,z$J.enabled&&!this._isMain&&z$q.addTexture(z$V,(z$N._byteLength>>2)-16),(this._curSubmit=z$q)._renderType=10017,z$q._numEle+=6}}else this.sprite&&z$k.timer.callLater(this,this._repaintSprite)},z$U.setShader=function(z$V){z$A.save(this,1048576,this._shader2D,!0),this._shader2D.shader=z$V},z$U.setFilters=function(z$V){z$A.save(this,2097152,this._shader2D,!0),this._shader2D.filters=z$V,this._curSubmit=z$cV.RENDERBASE,this._renderKey=0,this._drawCount++},z$U.drawTexture=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._drawTextureM(z$V,z$U,z$r,z$s,z$p,z$c,z$R,null,1)},z$U.addTextureVb=function(z$V,z$U,z$r){var z$s=this._curSubmit._vb||this._vb,z$p=z$s._byteLength>>2;z$s.byteLength=z$p+16<<2;for(var z$c=z$s.getFloat32Array(),z$R=0;z$R<16;z$R+=4)z$c[z$p++]=z$V[z$R]+z$U,z$c[z$p++]=z$V[z$R+1]+z$r,z$c[z$p++]=z$V[z$R+2],z$c[z$p++]=z$V[z$R+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),z$s._upload=!0},z$U.willDrawTexture=function(z$V,z$U){if(!(z$V.loaded&&z$V.bitmap&&z$V.source))return this.sprite&&z$k.timer.callLater(this,this._repaintSprite),0;var z$r=z$V.bitmap,z$s=z$r.id+this._shader2D.ALPHA*z$U+10016;if(z$s==this._renderKey)return z$s;var z$p=this._shader2D,z$c=z$p.ALPHA,z$R=this._curSubmit.shaderValue;z$p.ALPHA*=z$U,this._renderKey=z$s,this._drawCount++,z$p.glTexture=z$r;var z$T=this._vb,z$N=null,z$t=z$T._byteLength/32*3,z$b=z$R.textureHost&&z$R.textureHost==z$V&&z$R.textureHost.alphaTexture==z$V.alphaTexture;return z$N=z$mV.create(this,this._ib,z$T,z$t,z$DV.create(1,0)),(this._submits[this._submits._length++]=z$N).shaderValue.textureHost=z$V,z$N._renderType=10016,z$N._preIsSameTextureShader=10016===this._curSubmit._renderType&&z$p.ALPHA===z$R.ALPHA&&z$b,this._curSubmit=z$N,z$p.ALPHA=z$c,z$s},z$U.drawTextures=function(z$V,z$U,z$r,z$s){if(z$V.loaded&&z$V.bitmap&&z$V.source){var z$p=this._clipRect;if(this._clipRect=z$o.MAXCLIPRECT,this._drawTextureM(z$V,z$U[0],z$U[1],z$V.width,z$V.height,z$r,z$s,null,1)){if(this._clipRect=z$p,z$z.drawCall++,!(z$U.length<4)){for(var z$c=this._curSubmit._vb||this._vb,z$R=this._curMat.a,z$T=this._curMat.d,z$N=2,z$t=z$U.length;z$N<z$t;z$N+=2)z$hV.copyPreImgVb(z$c,(z$U[z$N]-z$U[z$N-2])*z$R,(z$U[z$N+1]-z$U[z$N-1])*z$T),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&z$k.timer.callLater(this,this._repaintSprite)},z$U._drawTextureM=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){if(!z$V.loaded||!z$V.source)return this.sprite&&z$k.timer.callLater(this,this._repaintSprite),!1;var z$t=this._curSubmit._vb||this._vb,z$b=z$V.bitmap;z$U+=z$c,z$r+=z$R,this._drawCount++;var z$S=z$b.id+this._shader2D.ALPHA*z$N+10016;if(z$S!=this._renderKey){this._renderKey=z$S;var z$_=this._curSubmit.shaderValue,z$G=this._shader2D,z$q=z$G.ALPHA;z$G.ALPHA*=z$N,z$G.glTexture=z$b;var z$u=this._vb,z$h=null,z$l=z$u._byteLength/32*3,z$W=z$_.textureHost&&z$_.textureHost==z$V&&z$_.textureHost.alphaTexture==z$V.alphaTexture;z$h=z$mV.create(this,this._ib,z$u,z$l,z$DV.create(1,0)),(this._submits[this._submits._length++]=z$h).shaderValue.textureHost=z$V,z$h._renderType=10016,z$h._preIsSameTextureShader=10016===this._curSubmit._renderType&&z$G.ALPHA===z$_.ALPHA&&z$W,this._curSubmit=z$h,z$t=this._curSubmit._vb||this._vb,z$G.ALPHA=z$q}return!!z$hV.fillRectImgVb(z$t,this._clipRect,z$U,z$r,z$s||z$V.width,z$p||z$V.height,z$V.uv,z$T||this._curMat,this._x,this._y,0,0)&&(z$J.enabled&&!this._isMain&&this._curSubmit.addTexture(z$V,(z$t._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},z$U._repaintSprite=function(){this.sprite&&this.sprite.repaint()},z$U._drawText=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){var z$b=z$V.bitmap;this._drawCount++;var z$S=z$b.id+this._shader2D.ALPHA+10016;if(z$S!=this._renderKey){this._renderKey=z$S;var z$_=this._curSubmit.shaderValue,z$G=this._shader2D;z$G.glTexture=z$b;var z$q=this._vb,z$u=null,z$h=z$q._byteLength/32*3,z$l=z$_.textureHost&&z$_.textureHost==z$V&&z$_.textureHost.alphaTexture==z$V.alphaTexture;(z$u=z$J.enabled?z$mV.create(this,this._ib,z$q,z$h,z$DV.create(1,0)):z$mV.create(this,this._ib,z$q,z$h,z$vV.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&z$G.ALPHA===z$_.ALPHA&&z$l,(this._submits[this._submits._length++]=z$u).shaderValue.textureHost=z$V,z$u._renderType=10016,this._curSubmit=z$u}z$V.active();var z$W=this._curSubmit._vb||this._vb;z$hV.fillRectImgVb(z$W,this._clipRect,z$U+z$R,z$r+z$T,z$s||z$V.width,z$p||z$V.height,z$V.uv,z$c||this._curMat,this._x,this._y,z$N,z$t,!0)&&(z$J.enabled&&!this._isMain&&this._curSubmit.addTexture(z$V,(z$W._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},z$U.drawTextureWithTransform=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){if(z$c){var z$t=this._curMat,z$b=this._x,z$S=this._y;(0!==z$R||0!==z$T)&&(this._x=z$R*z$t.a+z$T*z$t.c,this._y=z$T*z$t.d+z$R*z$t.b),z$c&&z$t.bTransform?(z$n.mul(z$c,z$t,z$o._tmpMatrix),(z$c=z$o._tmpMatrix)._checkTransform()):(this._x+=z$t.tx,this._y+=z$t.ty),this._drawTextureM(z$V,z$U,z$r,z$s,z$p,0,0,z$c,z$N),this._x=z$b,this._y=z$S}else this._drawTextureM(z$V,z$U,z$r,z$s,z$p,z$R,z$T,null,z$N)},z$U.fillQuadrangle=function(z$V,z$U,z$r,z$s,z$p){var z$c=this._curSubmit,z$R=this._vb,z$T=this._shader2D,z$N=z$c.shaderValue;if(this._renderKey=0,z$V.bitmap){var z$t=z$V.bitmap;z$T.glTexture==z$t&&z$T.ALPHA===z$N.ALPHA||(z$T.glTexture=z$t,(z$c=this._curSubmit=z$cV.createSubmit(this,this._ib,z$R,z$R._byteLength/32*3,z$DV.create(1,0))).shaderValue.glTexture=z$t,this._submits[this._submits._length++]=z$c),z$hV.fillQuadrangleImgVb(z$R,z$U,z$r,z$s,z$V.uv,z$p||this._curMat,this._x,this._y)}else z$c.shaderValue.fillStyle&&z$c.shaderValue.fillStyle.equal(z$V)&&z$T.ALPHA===z$N.ALPHA||(z$T.glTexture=null,(z$c=this._curSubmit=z$cV.createSubmit(this,this._ib,z$R,z$R._byteLength/32*3,z$DV.create(2,0))).shaderValue.defines.add(2),z$c.shaderValue.fillStyle=z$P.create(z$V),this._submits[this._submits._length++]=z$c),z$hV.fillQuadrangleImgVb(z$R,z$U,z$r,z$s,z$a.DEF_UV,z$p||this._curMat,this._x,this._y);z$c._numEle+=6},z$U.drawTexture2=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){if(0!=z$c){var z$N=this._curMat;if(this._x=z$V*z$N.a+z$U*z$N.c,this._y=z$U*z$N.d+z$V*z$N.b,z$p&&(z$p=z$N.bTransform||z$p.bTransform?(z$n.mul(z$p,z$N,z$o._tmpMatrix),z$o._tmpMatrix):(this._x+=z$p.tx+z$N.tx,this._y+=z$p.ty+z$N.ty,z$n.EMPTY)),1!==z$c||z$R){var z$t=this._shader2D.ALPHA,z$b=this._nBlendType;this._shader2D.ALPHA=z$c,z$R&&(this._nBlendType=z$B.TOINT(z$R)),this._drawTextureM(z$T[0],z$T[1]-z$r,z$T[2]-z$s,z$T[3],z$T[4],0,0,z$p,1),this._shader2D.ALPHA=z$t,this._nBlendType=z$b}else this._drawTextureM(z$T[0],z$T[1]-z$r,z$T[2]-z$s,z$T[3],z$T[4],0,0,z$p,1);this._x=this._y=0}},z$U.drawCanvas=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$V.context;if(this._renderKey=0,z$c._targets)this._submits[this._submits._length++]=z$KV.create(z$c,0,null),this._curSubmit=z$cV.RENDERBASE,z$c._targets.drawTo(this,z$U,z$r,z$s,z$p);else{var z$R=this._submits[this._submits._length++]=z$KV.create(z$c,this._shader2D.ALPHA,this._shader2D.filters),z$T=z$s/z$V.width,z$N=z$p/z$V.height,z$t=z$R._matrix;this._curMat.copyTo(z$t),1!=z$T&&1!=z$N&&z$t.scale(z$T,z$N);var z$b=z$t.tx,z$S=z$t.ty;z$t.tx=z$t.ty=0,z$t.transformPoint(z$I.TEMP.setTo(z$U,z$r)),z$t.translate(z$I.TEMP.x+z$b,z$I.TEMP.y+z$S),this._curSubmit=z$cV.RENDERBASE}z$y.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=z$c._targets?"yellow":"green",this.strokeRect(z$U-1,z$r-1,z$s+2,z$p+2,1),this.strokeRect(z$U,z$r,z$s,z$p,1),this.restore())},z$U.drawTarget=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){void 0===z$t&&(z$t=-1);var z$b=this._vb;if(z$hV.fillRectImgVb(z$b,this._clipRect,z$U,z$r,z$s,z$p,z$N||z$a.DEF_UV,z$c||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var z$S=this._curSubmit=z$SV.create(this,this._ib,z$b,(z$b._byteLength-64)/32*3,z$T,z$R);z$S.blendType=-1==z$t?this._nBlendType:z$t,z$S.scope=z$V,this._submits[this._submits._length++]=z$S,this._curSubmit._numEle+=6}},z$U.mixRGBandAlpha=function(z$V){return this._mixRGBandAlpha(z$V,this._shader2D.ALPHA)},z$U._mixRGBandAlpha=function(z$V,z$U){var z$r=(4278190080&z$V)>>>24;return 0!=z$r?z$r*=z$U:z$r=255*z$U,16777215&z$V|z$r<<24},z$U.drawTriangles=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){if(!z$V.loaded||!z$V.source)return this.sprite&&z$k.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;z$V.bitmap;var z$b=this._mixRGBandAlpha(4294967295,z$T),z$S=(z$s.length,z$c.length);this._renderKey=-1;var z$_=this._curSubmit=z$mV.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,z$DV.create(1,0));return z$_.shaderValue.textureHost=z$V,z$_._renderType=10016,this._submits[this._submits._length++]=z$_,z$R?(z$o._tmpMatrix.a=z$R.a,z$o._tmpMatrix.b=z$R.b,z$o._tmpMatrix.c=z$R.c,z$o._tmpMatrix.d=z$R.d,z$o._tmpMatrix.tx=z$R.tx+z$U,z$o._tmpMatrix.ty=z$R.ty+z$r,z$n.mul(z$o._tmpMatrix,this._curMat,z$o._tmpMatrix)):(z$o._tmpMatrix.a=this._curMat.a,z$o._tmpMatrix.b=this._curMat.b,z$o._tmpMatrix.c=this._curMat.c,z$o._tmpMatrix.d=this._curMat.d,z$o._tmpMatrix.tx=this._curMat.tx+z$U,z$o._tmpMatrix.ty=this._curMat.ty+z$r),this._triangleMesh.addData(z$s,z$p,z$c,z$o._tmpMatrix,z$b,this),this._curSubmit._numEle+=z$S,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},z$U.transform=function(z$V,z$U,z$r,z$s,z$p,z$c){z$g.save(this),z$n.mul(z$n.TEMP.setTo(z$V,z$U,z$r,z$s,z$p,z$c),this._curMat,this._curMat),this._curMat._checkTransform()},z$U.setTransformByMatrix=function(z$V){z$V.copyTo(this._curMat)},z$U.transformByMatrix=function(z$V){z$g.save(this),z$n.mul(z$V,this._curMat,this._curMat),this._curMat._checkTransform()},z$U.rotate=function(z$V){z$g.save(this),this._curMat.rotateEx(z$V)},z$U.scale=function(z$V,z$U){z$g.save(this),this._curMat.scaleEx(z$V,z$U)},z$U.clipRect=function(z$V,z$U,z$r,z$s){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var z$p=z$bV.create(4);this.addRenderObject(z$p);var z$c=this._vb,z$R=z$c._byteLength>>2;if(z$hV.fillRectImgVb(z$c,null,z$V,z$U,z$r,z$s,z$a.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var z$T=this._curSubmit=z$cV.createSubmit(this,this._ib,z$c,(z$c._byteLength-64)/32*3,z$DV.create(2,0));z$T.shaderValue.ALPHA=1,this._submits[this._submits._length++]=z$T,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var z$N=z$bV.create(5);this.addRenderObject(z$N);var z$t=z$c.getFloat32Array(),z$b=Math.min(Math.min(Math.min(z$t[0+z$R],z$t[4+z$R]),z$t[8+z$R]),z$t[12+z$R]),z$S=Math.max(Math.max(Math.max(z$t[0+z$R],z$t[4+z$R]),z$t[8+z$R]),z$t[12+z$R]),z$_=Math.min(Math.min(Math.min(z$t[1+z$R],z$t[5+z$R]),z$t[9+z$R]),z$t[13+z$R]),z$G=Math.max(Math.max(Math.max(z$t[1+z$R],z$t[5+z$R]),z$t[9+z$R]),z$t[13+z$R]);z$e.save(this,z$N,z$V,z$U,z$r,z$s,z$b,z$_,z$S-z$b,z$G-z$_),this._curSubmit=z$cV.RENDERBASE}else{z$r*=this._curMat.a,z$s*=this._curMat.d;var z$q=z$I.TEMP;this._curMat.transformPoint(z$q.setTo(z$V,z$U)),z$r<0&&(z$q.x=z$q.x+z$r,z$r=-z$r),z$s<0&&(z$q.y=z$q.y+z$s,z$s=-z$s),this._renderKey=0;var z$u=this._curSubmit=z$tV.create(this);(this._submits[this._submits._length++]=z$u).submitIndex=this._submits._length,z$u.submitLength=9999999,z$X.save(this,z$u);var z$h=this._clipRect,z$l=z$h.x,z$W=z$h.y,z$O=z$q.x+z$r,z$L=z$q.y+z$s;z$l<z$q.x&&(z$h.x=z$q.x),z$W<z$q.y&&(z$h.y=z$q.y),z$h.width=Math.min(z$O,z$l+z$h.width)-z$h.x,z$h.height=Math.min(z$L,z$W+z$h.height)-z$h.y,this._shader2D.glTexture=null,z$u.clipRect.copyFrom(z$h),this._curSubmit=z$cV.RENDERBASE}},z$U.setIBVB=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b){if(void 0===z$N&&(z$N=0),void 0===z$t&&(z$t=0),void 0===z$b&&(z$b=0),null===z$r){if(z$l.isFlash){var z$S=z$s;z$S._selfIB||(z$S._selfIB=z$CV.create(35044)),z$S._selfIB.clear(),z$r=z$S._selfIB}else z$r=this._ib;z$hV.expandIBQuadrangle(z$r,z$s._byteLength/(4*z$s.vertexStride*4))}if(!z$T||!z$R)throw Error("setIBVB must input:shader shaderValues");var z$_=z$NV.create(this,z$s,z$r,z$p,z$R,z$T,z$N,z$t,z$b);z$c||(z$c=z$n.EMPTY),z$c.translate(z$V,z$U),z$n.mul(z$c,this._curMat,z$_._mat),z$c.translate(-z$V,-z$U),this._submits[this._submits._length++]=z$_,this._curSubmit=z$cV.RENDERBASE,this._renderKey=0},z$U.addRenderObject=function(z$V){this._submits[this._submits._length++]=z$V},z$U.fillTrangles=function(z$V,z$U,z$r,z$s,z$p){var z$c=this._curSubmit,z$R=this._vb,z$T=this._shader2D,z$N=z$c.shaderValue,z$t=z$s.length>>4,z$b=z$V.bitmap;this._renderKey=0,z$T.glTexture==z$b&&z$T.ALPHA===z$N.ALPHA||((z$c=this._curSubmit=z$cV.createSubmit(this,this._ib,z$R,z$R._byteLength/32*3,z$DV.create(1,0))).shaderValue.textureHost=z$V,this._submits[this._submits._length++]=z$c),z$hV.fillTranglesVB(z$R,z$U,z$r,z$s,z$p||this._curMat,this._x,this._y),z$c._numEle+=6*z$t},z$U.submitElement=function(z$V,z$U){var z$r=this._submits;for(z$U<0&&(z$U=z$r._length);z$V<z$U;)z$V+=z$r[z$V].renderSubmit()},z$U.finish=function(){z$LV.mainContext.finish()},z$U.flush=function(){var z$V=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(z$V>this._ib.bufferLength/12&&z$hV.expandIBQuadrangle(this._ib,z$V),!this._isMain&&z$J.enabled&&z$J._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=z$J._atlasRestore;for(var z$U=this._submits,z$r=0,z$s=z$U._length;z$r<z$s;z$r++){var z$p=z$U[z$r];10016===z$p.getRenderType()&&z$p.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),z$UV.instance&&z$UV.getInstance().reset();var z$c;for(z$r=0,z$c=this.meshlist.length;z$r<z$c;z$r++){var z$R=this.meshlist[z$r];z$R.canReuse?z$R.releaseMesh():z$R.destroy()}return this.meshlist.length=0,this._curSubmit=z$cV.RENDERBASE,this._renderKey=0,this._triangleMesh=z$aV.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},z$U.setPathId=function(z$V){if(this.mId=z$V,-1!=this.mId){this.mHaveKey=!1;var z$U=z$x.getInstance();z$U.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,z$U.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},z$U.movePath=function(z$V,z$U){var z$r=z$V,z$s=z$U;z$V=this._curMat.a*z$r+this._curMat.c*z$s+this._curMat.tx,z$U=this._curMat.b*z$r+this._curMat.d*z$s+this._curMat.ty,this.mX+=z$V,this.mY+=z$U},z$U.beginPath=function(){var z$V=this._getPath();z$V.tempArray.length=0,z$V.closePath=!1,this.mX=0,this.mY=0},z$U.closePath=function(){this._path.closePath=!0},z$U.fill=function(z$V){void 0===z$V&&(z$V=!1);var z$U=this._getPath();this.drawPoly(0,0,z$U.tempArray,this.fillStyle._color.numColor,0,0,z$V)},z$U.stroke=function(){var z$V=this._getPath();if(0<this.lineWidth){if(-1==this.mId)z$V.drawLine(0,0,z$V.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var z$U=z$x.getInstance().shapeLineDic[this.mId];z$U.rebuild(z$V.tempArray),z$V.setGeomtry(z$U)}else z$x.getInstance().addLine(this.mId,z$V.drawLine(0,0,z$V.tempArray,this.lineWidth,this.strokeStyle._color.numColor));z$V.update();var z$r=[this.mX,this.mY],z$s=z$cV.createShape(this,z$V.ib,z$V.vb,z$V.count,z$V.offset,z$DV.create(4,0));z$s.shaderValue.ALPHA=this._shader2D.ALPHA,z$s.shaderValue.u_pos=z$r,z$s.shaderValue.u_mmat2=z$WV.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=z$s,this._renderKey=-1}},z$U.line=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=this._curSubmit,z$T=this._vb;if(z$hV.fillLineVb(z$T,this._clipRect,z$V,z$U,z$r,z$s,z$p,z$c)){this._renderKey=0;var z$N=this._shader2D,z$t=z$R.shaderValue;z$N.strokeStyle===z$t.strokeStyle&&z$N.ALPHA===z$t.ALPHA||(z$N.glTexture=null,(z$R=this._curSubmit=z$cV.createSubmit(this,this._ib,z$T,(z$T._byteLength-64)/32*3,z$DV.create(2,0))).shaderValue.strokeStyle=z$N.strokeStyle,z$R.shaderValue.mainID=2,z$R.shaderValue.ALPHA=z$N.ALPHA,this._submits[this._submits._length++]=z$R),z$R._numEle+=6}},z$U.moveTo=function(z$V,z$U,z$r){void 0===z$r&&(z$r=!0);var z$s=this._getPath();if(z$r){var z$p=z$V,z$c=z$U;z$V=this._curMat.a*z$p+this._curMat.c*z$c,z$U=this._curMat.b*z$p+this._curMat.d*z$c}z$s.addPoint(z$V,z$U)},z$U.lineTo=function(z$V,z$U,z$r){void 0===z$r&&(z$r=!0);var z$s=this._getPath();if(z$r){var z$p=z$V,z$c=z$U;z$V=this._curMat.a*z$p+this._curMat.c*z$c,z$U=this._curMat.b*z$p+this._curMat.d*z$c}z$s.addPoint(z$V,z$U)},z$U.drawCurves=function(z$V,z$U,z$r){this.setPathId(-1),this.beginPath(),this.strokeStyle=z$r[3],this.lineWidth=z$r[4];var z$s=z$r[2];z$V+=z$r[0],z$U+=z$r[1],this.movePath(z$V,z$U),this.moveTo(z$s[0],z$s[1]);for(var z$p=2,z$c=z$s.length;z$p<z$c;)this.quadraticCurveTo(z$s[z$p++],z$s[z$p++],z$s[z$p++],z$s[z$p++]);this.stroke()},z$U.arcTo=function(z$V,z$U,z$r,z$s,z$p){if(-1==this.mId||!this.mHaveKey){var z$c=0,z$R=0,z$T=0,z$N=this._getPath();this._curMat.copyTo(z$o._tmpMatrix),z$o._tmpMatrix.tx=z$o._tmpMatrix.ty=0,z$o._tempPoint.setTo(z$N.getEndPointX(),z$N.getEndPointY()),z$o._tmpMatrix.invertTransformPoint(z$o._tempPoint);var z$t=z$o._tempPoint.x-z$V,z$b=z$o._tempPoint.y-z$U,z$S=Math.sqrt(z$t*z$t+z$b*z$b);if(!(z$S<=1e-6)){var z$_=z$t/z$S,z$G=z$b/z$S,z$q=z$r-z$V,z$u=z$s-z$U,z$h=z$q*z$q+z$u*z$u,z$l=Math.sqrt(z$h);if(!(z$l<=1e-6)){var z$W=z$q/z$l,z$O=z$u/z$l,z$L=z$_+z$W,z$d=z$G+z$O,z$k=Math.sqrt(z$L*z$L+z$d*z$d);if(!(z$k<=1e-6)){var z$y=z$L/z$k,z$D=z$d/z$k,z$n=Math.acos(z$y*z$_+z$D*z$G),z$I=Math.PI/2-z$n,z$Q=(z$S=z$p/Math.tan(z$I))*z$_+z$V,z$H=z$S*z$G+z$U,z$w=Math.sqrt(z$S*z$S+z$p*z$p),z$z=z$V+z$y*z$w,z$E=z$U+z$D*z$w,z$K=0,z$m=0;if(0<=z$_*z$O-z$G*z$W){var z$a=2*z$I/z$o.SEGNUM;z$K=Math.sin(z$a),z$m=Math.cos(z$a)}else z$a=2*-z$I/z$o.SEGNUM,z$K=Math.sin(z$a),z$m=Math.cos(z$a);z$R=this._curMat.a*z$Q+this._curMat.c*z$H,z$T=this._curMat.b*z$Q+this._curMat.d*z$H,z$R==this._path.getEndPointX()&&z$T==this._path.getEndPointY()||z$N.addPoint(z$R,z$T);var z$Z=z$Q-z$z,z$x=z$H-z$E;for(z$c=0;z$c<z$o.SEGNUM;z$c++){var z$$=z$Z*z$m+z$x*z$K,z$j=-z$Z*z$K+z$x*z$m;z$R=z$$+z$z,z$T=z$j+z$E,z$V=this._curMat.a*z$R+this._curMat.c*z$T,z$T=z$U=this._curMat.b*z$R+this._curMat.d*z$T,(z$R=z$V)==this._path.getEndPointX()&&z$T==this._path.getEndPointY()||z$N.addPoint(z$R,z$T),z$Z=z$$,z$x=z$j}}}}}},z$U.arc=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!0),-1!=this.mId){var z$T=z$x.getInstance().shapeDic[this.mId];if(z$T&&this.mHaveKey&&!z$T.needUpdate(this._curMat))return;z$U=z$V=0}var z$N,z$t=0,z$b=0,z$S=0,z$_=0,z$G=0,z$q=0,z$u=0;if(z$b=z$p-z$s,z$c)if(Math.abs(z$b)>=2*Math.PI)z$b=2*-Math.PI;else for(;0<z$b;)z$b-=2*Math.PI;else if(Math.abs(z$b)>=2*Math.PI)z$b=2*Math.PI;else for(;z$b<0;)z$b+=2*Math.PI;z$N=z$b/(z$u=z$r<101?Math.max(10,z$b*z$r/5):z$r<201?Math.max(10,z$b*z$r/20):Math.max(10,z$b*z$r/40))/2,z$S=Math.abs(4/3*(1-Math.cos(z$N))/Math.sin(z$N)),z$c&&(z$S=-z$S);var z$h=this._getPath(),z$l=NaN,z$W=NaN;for(z$q=0;z$q<=z$u;z$q++)z$t=z$s+z$b*(z$q/z$u),z$_=z$V+Math.cos(z$t)*z$r,z$G=z$U+Math.sin(z$t)*z$r,z$R&&(z$l=z$_,z$W=z$G,z$_=this._curMat.a*z$l+this._curMat.c*z$W,z$G=this._curMat.b*z$l+this._curMat.d*z$W),z$_==this._path.getEndPointX()&&z$G==this._path.getEndPointY()||z$h.addPoint(z$_,z$G);z$_=z$V+Math.cos(z$p)*z$r,z$G=z$U+Math.sin(z$p)*z$r,z$R&&(z$l=z$_,z$W=z$G,z$_=this._curMat.a*z$l+this._curMat.c*z$W,z$G=this._curMat.b*z$l+this._curMat.d*z$W),z$_==this._path.getEndPointX()&&z$G==this._path.getEndPointY()||z$h.addPoint(z$_,z$G)},z$U.quadraticCurveTo=function(z$V,z$U,z$r,z$s){var z$p=z$S.I,z$c=z$r,z$R=z$s;z$r=this._curMat.a*z$c+this._curMat.c*z$R,z$s=this._curMat.b*z$c+this._curMat.d*z$R,z$c=z$V,z$R=z$U,z$V=this._curMat.a*z$c+this._curMat.c*z$R,z$U=this._curMat.b*z$c+this._curMat.d*z$R;for(var z$T=z$p.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),z$V,z$U,z$r,z$s],30,2),z$N=0,z$t=z$T.length/2;z$N<z$t;z$N++)this.lineTo(z$T[2*z$N],z$T[2*z$N+1],!1);this.lineTo(z$r,z$s,!1)},z$U.rect=function(z$V,z$U,z$r,z$s){this._other=this._other.make(),this._other.path||(this._other.path=new z$M),this._other.path.rect(z$V,z$U,z$r,z$s)},z$U.strokeRect=function(z$V,z$U,z$r,z$s,z$p){var z$c=.5*z$p;this.line(z$V-z$c,z$U,z$V+z$r+z$c,z$U,z$p,this._curMat),this.line(z$V+z$r,z$U,z$V+z$r,z$U+z$s,z$p,this._curMat),this.line(z$V,z$U,z$V,z$U+z$s,z$p,this._curMat),this.line(z$V-z$c,z$U+z$s,z$V+z$r+z$c,z$U+z$s,z$p,this._curMat)},z$U.clip=function(){},z$U.drawPoly=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){void 0===z$R&&(z$R=!1),this._renderKey=0,this._shader2D.glTexture=null;var z$T=this._getPath();if(-1==this.mId)z$T.polygon(z$V,z$U,z$r,z$s,z$p||1,z$c);else if(this.mHaveKey){var z$N=z$x.getInstance().shapeDic[this.mId];z$N.setMatrix(this._curMat),z$N.rebuild(z$T.tempArray),z$T.setGeomtry(z$N)}else{var z$t=z$T.polygon(z$V,z$U,z$r,z$s,z$p||1,z$c);z$x.getInstance().addShape(this.mId,z$t),z$t.setMatrix(this._curMat)}z$T.update();var z$b,z$S=[this.mX,this.mY];if((z$b=z$cV.createShape(this,z$T.ib,z$T.vb,z$T.count,z$T.offset,z$DV.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,z$b.shaderValue.u_pos=z$S,z$b.shaderValue.u_mmat2=z$WV.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=z$b,0<z$p){if(this.mHaveLineKey){var z$_=z$x.getInstance().shapeLineDic[this.mId];z$_.rebuild(z$T.tempArray),z$T.setGeomtry(z$_)}else z$x.getInstance().addShape(this.mId,z$T.drawLine(z$V,z$U,z$r,z$p,z$c));z$T.update(),(z$b=z$cV.createShape(this,z$T.ib,z$T.vb,z$T.count,z$T.offset,z$DV.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,z$b.shaderValue.u_mmat2=z$WV.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=z$b}},z$U.drawParticle=function(z$V,z$U,z$r){z$r.x=z$V,z$r.y=z$U,this._submits[this._submits._length++]=z$r},z$U._getPath=function(){return this._path||(this._path=new z$M)},z$s(0,z$U,"globalCompositeOperation",function(){return z$B.NAMES[this._nBlendType]},function(z$V){var z$U=z$B.TOINT[z$V];null==z$U||this._nBlendType===z$U||(z$A.save(this,65536,this,!0),this._curSubmit=z$cV.RENDERBASE,this._renderKey=0,this._nBlendType=z$U)}),z$s(0,z$U,"strokeStyle",function(){return this._shader2D.strokeStyle},function(z$V){this._shader2D.strokeStyle.equal(z$V)||(z$A.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=z$P.create(z$V))}),z$s(0,z$U,"globalAlpha",function(){return this._shader2D.ALPHA},function(z$V){(z$V=Math.floor(1e3*z$V)/1e3)!=this._shader2D.ALPHA&&(z$A.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=z$V)}),z$s(0,z$U,"asBitmap",null,function(z$V){if(z$V){if(this._targets||(this._targets=new z$Y),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),z$s(0,z$U,"fillStyle",function(){return this._shader2D.fillStyle},function(z$V){this._shader2D.fillStyle.equal(z$V)||(z$A.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=z$P.create(z$V))}),z$s(0,z$U,"textAlign",function(){return this._other.textAlign},function(z$V){this._other.textAlign===z$V||(this._other=this._other.make(),z$A.save(this,32768,this._other,!1),this._other.textAlign=z$V)}),z$s(0,z$U,"lineWidth",function(){return this._other.lineWidth},function(z$V){this._other.lineWidth===z$V||(this._other=this._other.make(),z$A.save(this,256,this._other,!1),this._other.lineWidth=z$V)}),z$s(0,z$U,"textBaseline",function(){return this._other.textBaseline},function(z$V){this._other.textBaseline===z$V||(this._other=this._other.make(),z$A.save(this,16384,this._other,!1),this._other.textBaseline=z$V)}),z$s(0,z$U,"font",null,function(z$V){z$V!=this._other.font.toString()&&(this._other=this._other.make(),z$A.save(this,8,this._other,!1),this._other.font===z$qV.EMPTY?this._other.font=new z$qV(z$V):this._other.font.setFont(z$V))}),z$o.__init__=function(){z$r.DEFAULT=new z$r},z$o._tempPoint=new z$I,z$o._SUBMITVBSIZE=32e3,z$o._MAXSIZE=99999999,z$o._RECTVBSIZE=16,z$o.MAXCLIPRECT=new z$Q(0,0,99999999,99999999),z$o._COUNT=0,z$o._tmpMatrix=new z$n,z$o.SEGNUM=32,z$o._contextcount=0,z$R(z$o,["_fontTemp",function(){return this._fontTemp=new z$qV},"_drawStyleTemp",function(){return this._drawStyleTemp=new z$P(null)}]),z$o.__init$=function(){z$r=function(){function z$V(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=z$qV.EMPTY}z$_(z$V,"");var z$U=z$V.prototype;return z$U.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=z$qV.EMPTY},z$U.make=function(){return this===z$V.DEFAULT?new z$V:this},z$V.DEFAULT=null,z$V}()},z$o}(),z$DV=function(z$V){function z$s(z$V,z$U){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,z$s.__super.call(this),this.defines=new z$HV,this.position=z$s._POSITION,this.mainID=z$V,this.subID=z$U,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=z$V|z$U,this._inClassCache=z$s._cache[this._cacheID],0<z$V&&!this._inClassCache&&(this._inClassCache=z$s._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}z$_(z$s,"laya.webgl.shader.d2.value.Value2D",z$j);var z$U=z$s.prototype;return z$U.setValue=function(z$V){},z$U.refresh=function(){var z$V=this.size;return z$V[0]=z$WV.width,z$V[1]=z$WV.height,this.alpha=this.ALPHA*z$WV.worldAlpha,this.mmat=z$WV.worldMatrix4,this},z$U._ShaderWithCompile=function(){return z$FV.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,z$YV.create)},z$U._withWorldShaderDefines=function(){var z$V=z$WV.worldShaderDefines,z$U=z$FV.sharders[this.mainID|this.defines._value|z$V.getValue()];if(!z$U){var z$r,z$s={};for(z$r in this.defines.toNameDic())z$s[z$r]="";for(z$r in z$V.toNameDic())z$s[z$r]="";z$U=z$FV.withCompile2D(0,this.mainID,z$s,this.mainID|this.defines._value|z$V.getValue(),z$YV.create)}var z$p=z$WV.worldFilters;if(!z$p)return z$U;for(var z$c,z$R=z$p.length,z$T=0;z$T<z$R;z$T++)(z$c=z$p[z$T])&&z$c.action.setValue(this);return z$U},z$U.upload=function(){var z$V=z$WV;this.alpha=this.ALPHA*z$V.worldAlpha,z$WV.worldMatrix4!==z$WV.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),z$LV.shaderHighPrecision&&this.defines.add(1024);var z$U,z$r=z$V.worldShaderDefines?this._withWorldShaderDefines():z$FV.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=z$V.width,this.size[1]=z$V.height,this.mmat=z$V.worldMatrix4,z$ZV.activeShader!==z$r?z$r._shaderValueWidth!==z$V.width||z$r._shaderValueHeight!==z$V.height?(z$r._shaderValueWidth=z$V.width,z$r._shaderValueHeight=z$V.height):z$U=z$r._params2dQuick2||z$r._make2dQuick2():z$r._shaderValueWidth!==z$V.width||z$r._shaderValueHeight!==z$V.height?(z$r._shaderValueWidth=z$V.width,z$r._shaderValueHeight=z$V.height):z$U=z$r._params2dQuick1||z$r._make2dQuick1(),z$r.upload(this,z$U)},z$U.setFilters=function(z$V){if(this.filters=z$V)for(var z$U,z$r=z$V.length,z$s=0;z$s<z$r;z$s++)(z$U=z$V[z$s])&&(this.defines.add(z$U.type),z$U.action.setValue(this))},z$U.clear=function(){this.defines.setValue(this.subID)},z$U.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},z$s._initone=function(z$V,z$U){z$s._typeClass[z$V]=z$U,z$s._cache[z$V]=[],z$s._cache[z$V]._length=0},z$s.__init__=function(){z$s._POSITION=[2,5126,!1,4*z$uV.BYTES_PE,0],z$s._TEXCOORD=[2,5126,!1,4*z$uV.BYTES_PE,2*z$uV.BYTES_PE],z$s._initone(2,z$oV),z$s._initone(4,z$BV),z$s._initone(256,z$JV),z$s._initone(512,z$jV),z$s._initone(1,z$iV),z$s._initone(65,z$vV),z$s._initone(9,z$iV)},z$s.create=function(z$V,z$U){var z$r=z$s._cache[z$V|z$U];return z$r._length?z$r[--z$r._length]:new z$s._typeClass[z$V|z$U](z$U)},z$s._POSITION=null,z$s._TEXCOORD=null,z$s._cache=[],z$s._typeClass=[],z$s.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z$s}(),z$nV=function(z$V){function z$h(z$V,z$U){z$h.__super.call(this,z$V,z$U)}z$_(z$h,"laya.webgl.utils.RenderSprite3D",z$W);var z$U=z$h.prototype;return z$U.onCreate=function(z$V){switch(z$V){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},z$U._mask=function(z$V,z$U,z$r,z$s){var z$p,z$c,z$R=this._next,z$T=z$V.mask;if(z$T){z$U.ctx.save();var z$N=z$U.ctx.globalCompositeOperation,z$t=new z$Q;if(z$t.copyFrom(z$T.getBounds()),z$t.width=Math.round(z$t.width),z$t.height=Math.round(z$t.height),z$t.x=Math.round(z$t.x),z$t.y=Math.round(z$t.y),0<z$t.width&&0<z$t.height){var z$b=z$V._style._tf,z$S=z$TV.create();z$S.addValue("bounds",z$t),z$p=z$RV.create([z$S,z$U],laya.webgl.utils.RenderSprite3D.tmpTarget),z$U.addRenderObject(z$p),z$T.render(z$U,-z$t.x,-z$t.y),z$p=z$RV.create([z$S],laya.webgl.utils.RenderSprite3D.endTmpTarget),z$U.addRenderObject(z$p),z$U.ctx.save(),z$U.clipRect(z$r-z$b.translateX+z$t.x,z$s-z$b.translateY+z$t.y,z$t.width,z$t.height),z$R._fun.call(z$R,z$V,z$U,z$r,z$s),z$U.ctx.restore(),z$c=z$bV.create(6),z$N=z$U.ctx.globalCompositeOperation,z$c.blendMode="mask",z$U.addRenderObject(z$c),z$n.TEMP.identity();var z$_=z$DV.create(1,0),z$G=z$a.INV_UV,z$q=z$t.width,z$u=z$t.height;(z$t.width<32||z$t.height<32)&&((z$G=z$h.tempUV)[0]=0,z$G[1]=0,z$G[2]=32<=z$t.width?1:z$t.width/32,z$G[3]=0,z$G[4]=32<=z$t.width?1:z$t.width/32,z$G[5]=32<=z$t.height?1:z$t.height/32,z$G[6]=0,z$G[7]=32<=z$t.height?1:z$t.height/32,z$t.width=32<=z$t.width?z$t.width:32,z$t.height=32<=z$t.height?z$t.height:32,z$G[1]*=-1,z$G[3]*=-1,z$G[5]*=-1,z$G[7]*=-1,z$G[1]+=1,z$G[3]+=1,z$G[5]+=1,z$G[7]+=1),z$U.ctx.drawTarget(z$S,z$r+z$t.x-z$b.translateX,z$s+z$t.y-z$b.translateY,z$q,z$u,z$n.TEMP,"tmpTarget",z$_,z$G,6),z$p=z$RV.create([z$S],laya.webgl.utils.RenderSprite3D.recycleTarget),z$U.addRenderObject(z$p),(z$c=z$bV.create(6)).blendMode=z$N,z$U.addRenderObject(z$c)}z$U.ctx.restore()}else z$R._fun.call(z$R,z$V,z$U,z$r,z$s)},z$U._blend=function(z$V,z$U,z$r,z$s){var z$p=z$V._style,z$c=this._next;z$p.blendMode?(z$U.ctx.save(),z$U.ctx.globalCompositeOperation=z$p.blendMode,z$c._fun.call(z$c,z$V,z$U,z$r,z$s),z$U.ctx.restore()):z$c._fun.call(z$c,z$V,z$U,z$r,z$s)},z$U._transform=function(z$V,z$U,z$r,z$s){var z$p=z$V.transform,z$c=this._next;if(z$p&&z$c!=z$W.NORENDER){var z$R=z$U.ctx;z$V._style;z$p.tx=z$r,z$p.ty=z$s;var z$T=z$R._getTransformMatrix(),z$N=z$T.clone();z$n.mul(z$p,z$T,z$T),z$T._checkTransform(),z$p.tx=z$p.ty=0,z$c._fun.call(z$c,z$V,z$U,0,0),z$N.copyTo(z$T),z$N.destroy()}else z$c._fun.call(z$c,z$V,z$U,z$r,z$s)},z$h.tmpTarget=function(z$V,z$U){var z$r=z$V.getValue("bounds"),z$s=z$xV.create(z$r.width,z$r.height);z$s.start(),z$s.clear(0,0,0,0),z$V.addValue("tmpTarget",z$s)},z$h.endTmpTarget=function(z$V){z$V.getValue("tmpTarget").end()},z$h.recycleTarget=function(z$V){z$V.getValue("tmpTarget").recycle(),z$V.recycle()},z$R(z$h,["tempUV",function(){return this.tempUV=new Array(8)}]),z$h}(),z$IV=function(z$V){function z$U(){this.data=null,z$U.__super.call(this)}z$_(z$U,"laya.filters.webgl.ColorFilterActionGL",z$$);var z$r=z$U.prototype;return z$k.imps(z$r,{"laya.filters.IFilterActionGL":!0}),z$r.setValue=function(z$V){z$V.colorMat=this.data._mat,z$V.colorAlpha=this.data._alpha},z$r.apply3d=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$V.getValue("bounds"),z$R=z$DV.create(1,0);z$R.setFilters([this.data]);var z$T=z$n.TEMP;z$T.identity(),z$r.ctx.drawTarget(z$V,0,0,z$c.width,z$c.height,z$T,"src",z$R)},z$U}(),z$QV=function(z$V){function z$c(z$V,z$U,z$r,z$s,z$p){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,z$c.__super.call(this,z$V,z$U,z$p),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new z$PV,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=z$r,this._atlasCanvas.height=z$s,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}z$_(z$c,"laya.webgl.atlas.Atlaser",z$o);var z$U=z$c.prototype;return z$U.computeUVinAtlasTexture=function(z$V,z$U,z$r,z$s){var z$p=z$J.atlasTextureWidth,z$c=z$J.atlasTextureHeight,z$R=z$r/z$p,z$T=z$s/z$c,z$N=(z$r+z$V.bitmap.width)/z$p,z$t=(z$s+z$V.bitmap.height)/z$c,z$b=z$V.bitmap.width/z$p,z$S=z$V.bitmap.height/z$c;z$V.uv=[z$R+z$U[0]*z$b,z$T+z$U[1]*z$S,z$N-(1-z$U[2])*z$b,z$T+z$U[3]*z$S,z$N-(1-z$U[4])*z$b,z$t-(1-z$U[5])*z$S,z$R+z$U[6]*z$b,z$t-(1-z$U[7])*z$S]},z$U.findBitmapIsExist=function(z$V){if(z$V instanceof laya.webgl.resource.WebGLImage){var z$U=z$V,z$r=z$U.url,z$s=this._InAtlasWebGLImagesKey[z$r||z$U.id];if(z$s)return z$s.offsetInfoID}return-1},z$U.addToAtlasTexture=function(z$V,z$U,z$r){if(z$V instanceof laya.webgl.resource.WebGLImage){var z$s=z$V,z$p=z$s.url;this._InAtlasWebGLImagesKey[z$p||z$s.id]={bitmap:z$V,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([z$U,z$r])}this._atlasCanvas.texSubImage2D(z$U,z$r,z$V.atlasSource),z$V.clearAtlasSource()},z$U.addToAtlas=function(z$V,z$U,z$r){z$V._atlasID=this._inAtlasTextureKey.length;var z$s=z$V.uv.slice(),z$p=z$V.bitmap;this._inAtlasTextureKey.push(z$V),this._inAtlasTextureOriUVValue.push(z$s),this._inAtlasTextureBitmapValue.push(z$p),this.computeUVinAtlasTexture(z$V,z$s,z$U,z$r),z$V.bitmap=this._atlasCanvas},z$U.clear=function(){for(var z$V=0,z$U=this._inAtlasTextureKey.length;z$V<z$U;z$V++)this._inAtlasTextureKey[z$V].bitmap=this._inAtlasTextureBitmapValue[z$V],this._inAtlasTextureKey[z$V].uv=this._inAtlasTextureOriUVValue[z$V],this._inAtlasTextureKey[z$V]._atlasID=-1,this._inAtlasTextureKey[z$V].bitmap.lock=!1,this._inAtlasTextureKey[z$V].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},z$U.dispose=function(){this.clear(),this._atlasCanvas.destroy()},z$s(0,z$U,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),z$s(0,z$U,"texture",function(){return this._atlasCanvas}),z$s(0,z$U,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),z$c}(),z$HV=function(z$V){function z$r(){z$r.__super.call(this,z$r.__name2int,z$r.__int2name,z$r.__int2nameMap)}return z$_(z$r,"laya.webgl.shader.d2.ShaderDefines2D",z$f),z$r.__init__=function(){z$r.reg("TEXTURE2D",1),z$r.reg("COLOR2D",2),z$r.reg("PRIMITIVE",4),z$r.reg("GLOW_FILTER",8),z$r.reg("BLUR_FILTER",16),z$r.reg("COLOR_FILTER",32),z$r.reg("COLOR_ADD",64),z$r.reg("WORLDMAT",128),z$r.reg("FILLTEXTURE",256),z$r.reg("FSHIGHPRECISION",1024),z$r.reg("TXTALPHA",2048),z$r.reg("TXTCOMPRESS",4096)},z$r.reg=function(z$V,z$U){z$f._reg(z$V,z$U,z$r.__name2int,z$r.__int2name)},z$r.toText=function(z$V,z$U,z$r){return z$f._toText(z$V,z$U,z$r)},z$r.toInt=function(z$V){return z$f._toInt(z$V,z$r.__name2int)},z$r.TEXTURE2D=1,z$r.COLOR2D=2,z$r.PRIMITIVE=4,z$r.FILTERGLOW=8,z$r.FILTERBLUR=16,z$r.FILTERCOLOR=32,z$r.COLORADD=64,z$r.WORLDMAT=128,z$r.FILLTEXTURE=256,z$r.SKINMESH=512,z$r.SHADERDEFINE_FSHIGHPRECISION=1024,z$r.TXTALPHA=2048,z$r.TXTCOMPRESS=4096,z$r.__name2int={},z$r.__int2name=[],z$r.__int2nameMap=[],z$r}(),z$wV=(function(z$V){function z$T(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$T.__super.call(this,z$V,z$U,z$r,z$s,40,z$p,z$c,z$R)}z$_(z$T,"laya.webgl.shapes.Ellipse",z$rV)}(),function(z$V){function z$c(z$V,z$U,z$r,z$s,z$p){this._points=[],this.rebuild(z$r),z$c.__super.call(this,z$V,z$U,0,0,0,z$p,z$s,z$p,0)}z$_(z$c,"laya.webgl.shapes.Line",z$rV);var z$U=z$c.prototype;return z$U.rebuild=function(z$V){var z$U=z$V.length;z$U!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(z$U/2-1)),this.mFloat32Array=new Float32Array(5*z$U)),this._points.length=0;for(var z$r=NaN,z$s=NaN,z$p=-1,z$c=-1,z$R=z$V.length/2,z$T=0;z$T<z$R;z$T++)z$r=z$V[2*z$T],z$s=z$V[2*z$T+1],(.01<Math.abs(z$p-z$r)||.01<Math.abs(z$c-z$s))&&this._points.push(z$r,z$s),z$p=z$r,z$c=z$s},z$U.getData=function(z$V,z$U,z$r){var z$s=[],z$p=[];0<this.borderWidth&&this.createLine2(this._points,z$s,this.borderWidth,z$r,z$p,this._points.length/2),this.mUint16Array.set(z$s,0),this.mFloat32Array.set(z$p,0),z$V.append(this.mUint16Array),z$U.append(this.mFloat32Array)},z$c}()),z$zV=function(z$V){function z$S(z$V,z$U,z$r,z$s,z$p){this._points=[];for(var z$c=NaN,z$R=NaN,z$T=-1,z$N=-1,z$t=z$r.length/2-1,z$b=0;z$b<z$t;z$b++)z$c=z$r[2*z$b],z$R=z$r[2*z$b+1],(.01<Math.abs(z$T-z$c)||.01<Math.abs(z$N-z$R))&&this._points.push(z$c,z$R),z$T=z$c,z$N=z$R;z$c=z$r[2*z$t],z$R=z$r[2*z$t+1],z$T=this._points[0],z$N=this._points[1],(.01<Math.abs(z$T-z$c)||.01<Math.abs(z$N-z$R))&&this._points.push(z$c,z$R),z$S.__super.call(this,z$V,z$U,0,0,this._points.length/2,0,z$s,z$p)}z$_(z$S,"laya.webgl.shapes.LoopLine",z$rV);var z$U=z$S.prototype;return z$U.getData=function(z$V,z$U,z$r){if(0<this.borderWidth){for(var z$s=this.color,z$p=(z$s>>16&255)/255,z$c=(z$s>>8&255)/255,z$R=(255&z$s)/255,z$T=[],z$N=0,z$t=0,z$b=[],z$S=Math.floor(this._points.length/2),z$_=0;z$_<z$S;z$_++)z$N=this._points[2*z$_],z$t=this._points[2*z$_+1],z$T.push(this.x+z$N,this.y+z$t,z$p,z$c,z$R);this.createLoopLine(z$T,z$b,this.borderWidth,z$r+z$T.length/5),z$V.append(new Uint16Array(z$b)),z$U.append(new Float32Array(z$T))}},z$U.createLoopLine=function(z$V,z$U,z$r,z$s,z$p,z$c){z$V.length;var z$R=z$V.concat(),z$T=z$p||z$V,z$N=this.borderColor,z$t=(z$N>>16&255)/255,z$b=(z$N>>8&255)/255,z$S=(255&z$N)/255,z$_=[z$R[0],z$R[1]],z$G=[z$R[z$R.length-5],z$R[z$R.length-4]],z$q=z$G[0]+.5*(z$_[0]-z$G[0]),z$u=z$G[1]+.5*(z$_[1]-z$G[1]);z$R.unshift(z$q,z$u,0,0,0),z$R.push(z$q,z$u,0,0,0);var z$h,z$l,z$W,z$O,z$L,z$d,z$k,z$y,z$D,z$n,z$I,z$Q,z$H,z$w,z$z,z$E,z$K,z$m,z$a,z$Z,z$x=z$R.length/5,z$$=z$s,z$j=z$r/2;z$W=z$R[0],z$O=z$R[1],z$n=z$W-(z$L=z$R[5]),z$D=(z$D=-(z$O-(z$d=z$R[6])))/(z$Z=Math.sqrt(z$D*z$D+z$n*z$n))*z$j,z$n=z$n/z$Z*z$j,z$T.push(z$W-z$D,z$O-z$n,z$t,z$b,z$S,z$W+z$D,z$O+z$n,z$t,z$b,z$S);for(var z$o=1;z$o<z$x-1;z$o++)z$W=z$R[5*(z$o-1)],z$O=z$R[5*(z$o-1)+1],z$L=z$R[5*z$o],z$d=z$R[5*z$o+1],z$k=z$R[5*(z$o+1)],z$y=z$R[5*(z$o+1)+1],z$n=z$W-z$L,z$Q=z$L-z$k,z$z=(-(z$D=(z$D=-(z$O-z$d))/(z$Z=Math.sqrt(z$D*z$D+z$n*z$n))*z$j)+z$W)*(-(z$n=z$n/z$Z*z$j)+z$d)-(-z$D+z$L)*(-z$n+z$O),z$m=(-(z$I=(z$I=-(z$d-z$y))/(z$Z=Math.sqrt(z$I*z$I+z$Q*z$Q))*z$j)+z$k)*(-(z$Q=z$Q/z$Z*z$j)+z$d)-(-z$I+z$L)*(-z$Q+z$y),z$a=(z$H=-z$n+z$O-(-z$n+z$d))*(z$K=-z$I+z$L-(-z$I+z$k))-(z$E=-z$Q+z$y-(-z$Q+z$d))*(z$w=-z$D+z$L-(-z$D+z$W)),Math.abs(z$a)<.1?(z$a+=10.1,z$T.push(z$L-z$D,z$d-z$n,z$t,z$b,z$S,z$L+z$D,z$d+z$n,z$t,z$b,z$S)):(((z$h=(z$w*z$m-z$K*z$z)/z$a)-z$L)*(z$h-z$L)+((z$l=(z$E*z$z-z$H*z$m)/z$a)-z$d)+(z$l-z$d),z$T.push(z$h,z$l,z$t,z$b,z$S,z$L-(z$h-z$L),z$d-(z$l-z$d),z$t,z$b,z$S));z$c&&(z$U=z$c);var z$J=this.edges+1;for(z$o=1;z$o<z$J;z$o++)z$U.push(z$$+2*(z$o-1),z$$+2*(z$o-1)+1,z$$+2*z$o+1,z$$+2*z$o+1,z$$+2*z$o,z$$+2*(z$o-1));return z$U.push(z$$+2*(z$o-1),z$$+2*(z$o-1)+1,z$$+1,z$$+1,z$$,z$$+2*(z$o-1)),z$T},z$S}(),z$EV=function(z$V){function z$R(z$V,z$U,z$r,z$s,z$p,z$c){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=z$n.create(),this._points=z$r.slice(0,z$r.length),z$R.__super.call(this,z$V,z$U,0,0,this._points.length/2,z$s,z$p,z$c)}z$_(z$R,"laya.webgl.shapes.Polygon",z$rV);var z$U=z$R.prototype;return z$U.rebuild=function(z$V){this._repaint||(this._points.length=0,this._points=this._points.concat(z$V))},z$U.setMatrix=function(z$V){z$V.copyTo(this._mat)},z$U.needUpdate=function(z$V){return this._repaint=this._mat.a==z$V.a&&this._mat.b==z$V.b&&this._mat.c==z$V.c&&this._mat.d==z$V.d&&this._mat.tx==z$V.tx&&this._mat.ty==z$V.ty,!this._repaint},z$U.getData=function(z$V,z$U,z$r){var z$s,z$p=0,z$c=this._points,z$R=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=z$r){for(this._start=z$r,z$s=[],z$R=this.earcutTriangles.length,z$p=0;z$p<z$R;z$p++)z$s.push(this.earcutTriangles[z$p]+z$r);this.mUint16Array=new Uint16Array(z$s)}}else{this._start=z$r,z$s=[];var z$T=[],z$N=[],z$t=this.color,z$b=(z$t>>16&255)/255,z$S=(z$t>>8&255)/255,z$_=(255&z$t)/255;for(z$R=Math.floor(z$c.length/2),z$p=0;z$p<z$R;z$p++)z$T.push(this.x+z$c[2*z$p],this.y+z$c[2*z$p+1],z$b,z$S,z$_),z$N.push(this.x+z$c[2*z$p],this.y+z$c[2*z$p+1]);for(this.earcutTriangles=z$sV.earcut(z$N,null,2),z$R=this.earcutTriangles.length,z$p=0;z$p<z$R;z$p++)z$s.push(this.earcutTriangles[z$p]+z$r);this.mUint16Array=new Uint16Array(z$s),this.mFloat32Array=new Float32Array(z$T)}z$V.append(this.mUint16Array),z$U.append(this.mFloat32Array)},z$R}(),z$KV=function(z$V){function z$c(){this._matrix=new z$n,this._matrix4=z$uV.defaultMatrix4.concat(),z$c.__super.call(this,1e4),this.shaderValue=new z$DV(0,0)}z$_(z$c,"laya.webgl.submit.SubmitCanvas",z$cV);var z$U=z$c.prototype;return z$U.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var z$V=z$WV.worldAlpha,z$U=z$WV.worldMatrix4,z$r=z$WV.worldMatrix,z$s=z$WV.worldFilters,z$p=z$WV.worldShaderDefines,z$c=this.shaderValue,z$R=this._matrix,z$T=this._matrix4,z$N=z$n.TEMP;return z$n.mul(z$R,z$r,z$N),z$T[0]=z$N.a,z$T[1]=z$N.b,z$T[4]=z$N.c,z$T[5]=z$N.d,z$T[12]=z$N.tx,z$T[13]=z$N.ty,z$WV.worldMatrix=z$N.clone(),z$WV.worldMatrix4=z$T,z$WV.worldAlpha=z$WV.worldAlpha*z$c.alpha,z$c.filters&&z$c.filters.length&&(z$WV.worldFilters=z$c.filters,z$WV.worldShaderDefines=z$c.defines),this._ctx_src.flush(),z$WV.worldAlpha=z$V,z$WV.worldMatrix4=z$U,z$WV.worldMatrix.destroy(),z$WV.worldMatrix=z$r,z$WV.worldFilters=z$s,z$WV.worldShaderDefines=z$p,1},z$U.releaseRender=function(){var z$V=z$c._cache;this._ctx_src=null,z$V[z$V._length++]=this},z$U.getRenderType=function(){return 10003},z$c.create=function(z$V,z$U,z$r){var z$s=z$c._cache._length?z$c._cache[--z$c._cache._length]:new z$c;z$s._ctx_src=z$V;var z$p=z$s.shaderValue;return z$p.alpha=z$U,z$p.defines.setValue(0),z$r&&z$r.length&&z$p.setFilters(z$r),z$s},z$c._cache=((z$c._cache=[])._length=0,z$c._cache),z$c}(),z$mV=function(z$V){function z$t(z$V){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===z$V&&(z$V=1e4),z$t.__super.call(this,z$V)}z$_(z$t,"laya.webgl.submit.SubmitTexture",z$cV);var z$U=z$t.prototype;return z$U.releaseRender=function(){var z$V=z$t._cache;(z$V[z$V._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},z$U.addTexture=function(z$V,z$U){this._texsID[this._texs.length]=z$V._uvID,this._texs.push(z$V),this._vbPos.push(z$U)},z$U.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var z$V=this.shaderValue.textureHost.bitmap;if(null!==z$V)for(var z$U=this._vb.getFloat32Array(),z$r=0,z$s=this._texs.length;z$r<z$s;z$r++){var z$p=this._texs[z$r];z$p.active();var z$c=z$p.uv;if(this._texsID[z$r]!==z$p._uvID){this._texsID[z$r]=z$p._uvID;var z$R=this._vbPos[z$r];z$U[z$R+2]=z$c[0],z$U[z$R+3]=z$c[1],z$U[z$R+6]=z$c[2],z$U[z$R+7]=z$c[3],z$U[z$R+10]=z$c[4],z$U[z$R+11]=z$c[5],z$U[z$R+14]=z$c[6],z$U[z$R+15]=z$c[7],this._vb.setNeedUpload()}z$p.bitmap!==z$V&&(this._isSameTexture=!1)}}},z$U.renderSubmit=function(){if(0===this._numEle)return z$t._shaderSet=!1,1;var z$V=this.shaderValue.textureHost;if(z$V){var z$U=z$V.source;if(!z$V.bitmap||!z$U)return z$t._shaderSet=!1,1;this.shaderValue.texture=z$U,z$V.alphaTexture&&z$V.alphaTexture.source&&(this.shaderValue.texture1=z$V.alphaTexture.source)}this._vb.bind_upload(this._ib);var z$r=z$LV.mainContext;if(z$B.activeBlendFunction!==this._blendFn&&(z$r.enable(3042),this._blendFn(z$r),z$B.activeBlendFunction=this._blendFn),z$z.drawCall++,z$z.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&z$ZV.activeShader&&z$t._shaderSet?(z$ZV.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&z$ZV.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),z$t._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var z$s=z$V.bitmap,z$p=0,z$c=z$ZV.activeShader,z$R=0,z$T=this._texs.length;z$R<z$T;z$R++){var z$N=this._texs[z$R];z$N.bitmap===z$s&&z$R+1!==z$T||(z$c.uploadTexture2D(z$N.source),z$r.drawElements(4,6*(z$R-z$p+1),5123,this._startIdx+6*z$p*z$uV.BYTES_PIDX),z$s=z$N.bitmap,z$p=z$R)}else z$r.drawElements(4,this._numEle,5123,this._startIdx);return 1},z$t.create=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$t._cache._length?z$t._cache[--z$t._cache._length]:new z$t;null==z$r&&((z$r=z$c._selfVb||(z$c._selfVb=z$fV.create(-1))).clear(),z$s=0),z$c._ib=z$U,z$c._vb=z$r,z$c._startIdx=z$s*z$uV.BYTES_PIDX,z$c._numEle=0;var z$R=z$V._nBlendType;z$c._blendFn=z$V._targets?z$B.targetFns[z$R]:z$B.fns[z$R],z$c.shaderValue=z$p,z$c.shaderValue.setValue(z$V._shader2D);var z$T=z$V._shader2D.filters;return z$T&&z$c.shaderValue.setFilters(z$T),z$c},z$t._cache=((z$t._cache=[])._length=0,z$t._cache),z$t._shaderSet=!0,z$t}(),z$aV=function(z$V){function z$l(){z$l.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}z$_(z$l,"laya.webgl.utils.MeshTexture",z$lV);var z$U=z$l.prototype;return z$U.addData=function(z$V,z$U,z$r,z$s,z$p,z$c){for(var z$R=z$V.length/2,z$T=this._vb.needSize(z$R*z$l.const_stride)>>2,z$N=this._vb.getFloat32Array(),z$t=0,z$b=0;z$b<z$R;z$b++){var z$S=z$V[z$t],z$_=z$V[z$t+1],z$G=z$S*z$s.a+z$_*z$s.c+z$s.tx,z$q=z$S*z$s.b+z$_*z$s.d+z$s.ty;z$N[z$T++]=z$G,z$N[z$T++]=z$q,z$N[z$T++]=z$U[z$t],z$N[z$T++]=z$U[z$t+1],z$t+=2}this._vb.setNeedUpload();var z$u=this.vertNum;if(0<z$u){(z$R=z$r.length)>z$l.tmpIdx.length&&(z$l.tmpIdx=new Uint16Array(z$R));for(var z$h=0;z$h<z$R;z$h++)z$l.tmpIdx[z$h]=z$r[z$h]+z$u;this._ib.appendU16Array(z$l.tmpIdx,z$r.length)}else this._ib.append(z$r);this._ib.setNeedUpload(),this.vertNum+=z$R,this.indexNum+=z$r.length},z$U.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},z$U.destroy=function(){this._ib.destroy(),this._vb.destroy()},z$l.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new z$l},z$l.const_stride=16,z$l._POOL=[],z$R(z$l,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),z$l}(),z$ZV=function(z$V){function z$U(){z$U.__super.call(this),this.lock=!0}return z$_(z$U,"laya.webgl.shader.BaseShader",z$O),z$U.activeShader=null,z$U.bindShader=null,z$U}(),z$xV=function(z$U){function z$b(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===z$r&&(z$r=6408),void 0===z$s&&(z$s=5121),void 0===z$p&&(z$p=34041),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=-1),void 0===z$N&&(z$N=-1),this._type=1,this._w=z$V,this._h=z$U,this._surfaceFormat=z$r,this._surfaceType=z$s,this._depthStencilFormat=z$p,z$l.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=z$c,this._repeat=z$R,this._minFifter=z$T,this._magFifter=z$N,this._createWebGLRenderTarget(),this.bitmap.lock=!0,z$b.__super.call(this,this.bitmap,z$a.INV_UV)}z$_(z$b,"laya.webgl.resource.RenderTarget2D",z$U);var z$V=z$b.prototype;return z$k.imps(z$V,{"laya.resource.IDispose":!0}),z$V.getType=function(){return this._type},z$V.getTexture=function(){return this},z$V.size=function(z$V,z$U){this._w==z$V&&this._h==z$U||(this._w=z$V,this._h=z$U,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},z$V.release=function(){this.destroy()},z$V.recycle=function(){z$b.POOL.push(this)},z$V.start=function(){var z$V=z$LV.mainContext;return this._preRenderTarget=z$WV.curRenderTarget,z$WV.curRenderTarget=this,z$V.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(z$V.viewport(0,0,this._w,this._h),this._svWidth=z$WV.width,this._svHeight=z$WV.height,z$WV.width=this._w,z$WV.height=this._h,z$ZV.activeShader=null),this},z$V.clear=function(z$V,z$U,z$r,z$s){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=1);var z$p=z$LV.mainContext;z$p.clearColor(z$V,z$U,z$r,z$s);var z$c=16384;switch(this._depthStencilFormat){case 33189:z$c|=256;break;case 36168:z$c|=1024;break;case 34041:z$c|=256,z$c|=1024}z$p.clear(z$c)},z$V.end=function(){var z$V=z$LV.mainContext;z$V.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,z$WV.curRenderTarget=this._preRenderTarget,1==this._type?(z$V.viewport(0,0,this._svWidth,this._svHeight),z$WV.width=this._svWidth,z$WV.height=this._svHeight,z$ZV.activeShader=null):z$V.viewport(0,0,z$k.stage.width,z$k.stage.height)},z$V.getData=function(z$V,z$U,z$r,z$s){var z$p=z$LV.mainContext;if(z$p.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===z$p.checkFramebufferStatus(36160)))return z$p.bindFramebuffer(36160,null),null;var z$c=new Uint8Array(this._w*this._h*4);return z$p.readPixels(z$V,z$U,z$r,z$s,this._surfaceFormat,this._surfaceType,z$c),z$p.bindFramebuffer(36160,null),z$c},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,z$U.prototype.destroy.call(this))},z$V.dispose=function(){},z$V._createWebGLRenderTarget=function(){this.bitmap=new z$XV(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(z$V){this.event("recovered")})},z$s(0,z$V,"surfaceFormat",function(){return this._surfaceFormat}),z$s(0,z$V,"magFifter",function(){return this._magFifter}),z$s(0,z$V,"surfaceType",function(){return this._surfaceType}),z$s(0,z$V,"mipMap",function(){return this._mipMap}),z$s(0,z$V,"depthStencilFormat",function(){return this._depthStencilFormat}),z$s(0,z$V,"minFifter",function(){return this._minFifter}),z$s(0,z$V,"source",function(){return this._alreadyResolved?z$k.superGet(z$a,this,"source"):null}),z$b.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){void 0===z$r&&(z$r=6408),void 0===z$s&&(z$s=5121),void 0===z$p&&(z$p=34041),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=-1),void 0===z$N&&(z$N=-1);var z$t=z$b.POOL.pop();return z$t||(z$t=new z$b(z$V,z$U)),z$t.bitmap&&z$t._w==z$V&&z$t._h==z$U&&z$t._surfaceFormat==z$r&&z$t._surfaceType==z$s&&z$t._depthStencilFormat==z$p&&z$t._mipMap==z$c&&z$t._repeat==z$R&&z$t._minFifter==z$T&&z$t._magFifter==z$N||(z$t._w=z$V,z$t._h=z$U,z$t._surfaceFormat=z$r,z$t._surfaceType=z$s,z$t._depthStencilFormat=z$p,z$l.isConchWebGL&&34041===z$t._depthStencilFormat&&(z$t._depthStencilFormat=33189),z$t._mipMap=z$c,z$t._repeat=z$R,z$t._minFifter=z$T,z$t._magFifter=z$N,z$t.release(),z$t._createWebGLRenderTarget()),z$t},z$b.TYPE2D=1,z$b.TYPE3D=2,z$b.POOL=[],z$b}(z$a),z$$V=function(z$V){function z$U(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,z$U.__super.call(this),z$U._gl=z$LV.mainContext}z$_(z$U,"laya.webgl.utils.Buffer",z$O);var z$r=z$U.prototype;return z$r._bind=function(){this.activeResource(),z$U._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(z$U._bindVertexBuffer=this._glBuffer),z$U._gl.bindBuffer(this._bufferType,z$U._bindActive[this._bufferType]=this._glBuffer),z$ZV.activeShader=null)},z$r.recreateResource=function(){this._glBuffer||(this._glBuffer=z$U._gl.createBuffer()),this.completeCreate()},z$r.disposeResource=function(){this._glBuffer&&(z$LV.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},z$s(0,z$r,"bufferUsage",function(){return this._bufferUsage}),z$U._gl=null,z$U._bindActive={},z$U._bindVertexBuffer=null,z$U._enableAtributes=[],z$U}(),z$jV=function(z$V){function z$r(z$V){this.texcoord=null,this.offsetX=300,this.offsetY=0,z$r.__super.call(this,512,0);var z$U=8*z$uV.BYTES_PE;this.position=[2,5126,!1,z$U,0],this.texcoord=[2,5126,!1,z$U,2*z$uV.BYTES_PE],this.color=[4,5126,!1,z$U,4*z$uV.BYTES_PE]}return z$_(z$r,"laya.webgl.shader.d2.skinAnishader.SkinSV",z$DV),z$r}(),z$oV=function(z$V){function z$U(z$V){z$U.__super.call(this,2,0),this.color=[]}return z$_(z$U,"laya.webgl.shader.d2.value.Color2dSV",z$DV),z$U.prototype.setValue=function(z$V){z$V.fillStyle&&(this.color=z$V.fillStyle._color._color),z$V.strokeStyle&&(this.color=z$V.strokeStyle._color._color)},z$U}(),z$JV=function(z$V){function z$U(z$V){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=z$DV._TEXCOORD,z$U.__super.call(this,256,0)}z$_(z$U,"laya.webgl.shader.d2.value.FillTextureSV",z$DV);var z$r=z$U.prototype;return z$r.setValue=function(z$V){this.ALPHA=z$V.ALPHA,z$V.filters&&this.setFilters(z$V.filters)},z$r.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},z$U}(),z$iV=function(z$V){function z$U(z$V){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=z$DV._TEXCOORD,void 0===z$V&&(z$V=0),z$U.__super.call(this,1,z$V)}z$_(z$U,"laya.webgl.shader.d2.value.TextureSV",z$DV);var z$r=z$U.prototype;return z$r.setValue=function(z$V){this.ALPHA=z$V.ALPHA,z$V.filters&&this.setFilters(z$V.filters)},z$r.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},z$U}(),z$BV=function(z$V){function z$U(z$V){this.a_color=null,this.u_pos=[0,0],z$U.__super.call(this,4,0),this.position=[2,5126,!1,5*z$uV.BYTES_PE,0],this.a_color=[3,5126,!1,5*z$uV.BYTES_PE,2*z$uV.BYTES_PE]}return z$_(z$U,"laya.webgl.shader.d2.value.PrimitiveSV",z$DV),z$U}(),z$PV=function(z$V){function z$U(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,z$U.__super.call(this)}z$_(z$U,"laya.webgl.atlas.AtlasWebGLCanvas",z$V);var z$r=z$U.prototype;return z$r.recreateResource=function(){var z$V=z$LV.mainContext,z$U=this._source=z$V.createTexture(),z$r=z$dV.curBindTexTarget,z$s=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,z$U),z$V.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),z$V.texParameteri(3553,10241,9729),z$V.texParameteri(3553,10240,9729),z$V.texParameteri(3553,10242,33071),z$V.texParameteri(3553,10243,33071),z$r&&z$s&&z$dV.bindTexture(z$V,z$r,z$s),this.memorySize=this._w*this._h*4,this.completeCreate()},z$r.disposeResource=function(){this._source&&(z$LV.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},z$r.texSubImage2D=function(z$V,z$U,z$r){if(z$l.isFlash){this._flashCacheImage||(this._flashCacheImage=z$u.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var z$s=z$r.bitmapdata;this._flashCacheImage._image.copyPixels(z$s,0,0,z$s.width,z$s.height,z$V,z$U),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var z$p=z$LV.mainContext,z$c=z$dV.curBindTexTarget,z$R=z$dV.curBindTexValue;z$dV.bindTexture(z$p,3553,this._source),z$p.pixelStorei(37441,!0),0<=z$V-1&&z$p.texSubImage2D(3553,0,z$V-1,z$U,6408,5121,z$r),z$V+1<=this._w&&z$p.texSubImage2D(3553,0,z$V+1,z$U,6408,5121,z$r),0<=z$U-1&&z$p.texSubImage2D(3553,0,z$V,z$U-1,6408,5121,z$r),z$U+1<=this._h&&z$p.texSubImage2D(3553,0,z$V,z$U+1,6408,5121,z$r),z$p.texSubImage2D(3553,0,z$V,z$U,6408,5121,z$r),z$p.pixelStorei(37441,!1),z$c&&z$R&&z$dV.bindTexture(z$p,z$c,z$R)}},z$r.texSubImage2DPixel=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$LV.mainContext,z$R=z$dV.curBindTexTarget,z$T=z$dV.curBindTexValue;z$dV.bindTexture(z$c,3553,this._source);var z$N=new Uint8Array(z$p.data);z$c.pixelStorei(37441,!0),z$c.texSubImage2D(3553,0,z$V,z$U,z$r,z$s,6408,5121,z$N),z$c.pixelStorei(37441,!1),z$R&&z$T&&z$dV.bindTexture(z$c,z$R,z$T)},z$s(0,z$r,"width",z$V.prototype._$get_width,function(z$V){this._w=z$V}),z$s(0,z$r,"height",z$V.prototype._$get_height,function(z$V){this._h=z$V}),z$U}(z$r),z$MV=function(z$V){function z$p(){this.flipY=!0,this.alwaysChange=!1,z$p.__super.call(this)}z$_(z$p,"laya.webgl.resource.WebGLCanvas",z$r);var z$U=z$p.prototype;return z$U.getCanvas=function(){return this._canvas},z$U.clear=function(){this._ctx&&this._ctx.clear()},z$U.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},z$U._setContext=function(z$V){this._ctx=z$V},z$U.getContext=function(z$V,z$U){return this._ctx?this._ctx:this._ctx=z$p._createContext(this)},z$U.size=function(z$V,z$U){this._w==z$V&&this._h==z$U||(this._w=z$V,this._h=z$U,this._ctx&&this._ctx.size(z$V,z$U),this._canvas&&(this._canvas.height=z$U,this._canvas.width=z$V))},z$U.activeResource=function(z$V){void 0===z$V&&(z$V=!1),this._source||this.recreateResource()},z$U.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},z$U.disposeResource=function(){this._source&&!this.iscpuSource&&(z$LV.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},z$U.createWebGlTexture=function(){var z$V=z$LV.mainContext;this._canvas;var z$U=this._source=z$V.createTexture();this.iscpuSource=!1;var z$r=z$dV.curBindTexTarget,z$s=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,z$U),z$V.pixelStorei(37440,this.flipY?1:0),z$p.premulAlpha&&z$V.pixelStorei(37441,!0),z$V.texImage2D(3553,0,6408,6408,5121,this._imgData),z$p.premulAlpha&&z$V.pixelStorei(37441,!1),z$V.texParameteri(3553,10240,9729),z$V.texParameteri(3553,10241,9729),z$V.texParameteri(3553,10242,33071),z$V.texParameteri(3553,10243,33071),z$V.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,z$r&&z$s&&z$dV.bindTexture(z$V,z$r,z$s)},z$U.reloadCanvasData=function(){var z$V=z$LV.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var z$U=z$dV.curBindTexTarget,z$r=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,this._source),z$p.premulAlpha&&z$V.pixelStorei(37441,!0),z$V.texImage2D(3553,0,6408,6408,5121,this._imgData),z$p.premulAlpha&&z$V.pixelStorei(37441,!1),z$V.pixelStorei(37440,0),z$U&&z$r&&z$dV.bindTexture(z$V,z$U,z$r)},z$U.texSubImage2D=function(z$V,z$U,z$r){var z$s=z$LV.mainContext,z$p=z$dV.curBindTexTarget,z$c=z$dV.curBindTexValue;z$dV.bindTexture(z$s,3553,this._source),z$s.pixelStorei(37441,!0),z$s.texSubImage2D(3553,0,z$U,z$r,6408,5121,z$V._source),z$s.pixelStorei(37441,!1),z$p&&z$c&&z$dV.bindTexture(z$s,z$p,z$c)},z$U.toBase64=function(z$V,z$U,z$r){var z$s=null;this._canvas&&(z$s=this._canvas.toDataURL(z$V,z$U)),z$r.call(this,z$s)},z$s(0,z$U,"context",function(){return this._ctx}),z$s(0,z$U,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),z$s(0,z$U,"asBitmap",null,function(z$V){this._ctx&&(this._ctx.asBitmap=z$V)}),z$p._createContext=null,z$p.premulAlpha=!1,z$p}(),z$AV=function(z$V){function z$c(z$V,z$U){this.CborderSize=12,z$c.__super.call(this),this.char=z$V,this.isSpace=" "===z$V,this.xs=z$U.scaleX,this.ys=z$U.scaleY,this.font=z$U.font.toString(),this.fontSize=z$U.font.size,this.fillColor=z$U.fillColor,this.borderColor=z$U.borderColor,this.lineWidth=z$U.lineWidth,this.underLine=z$U.underLine;var z$r,z$s=z$l.isConchApp;z$s?((z$r=ConchTextCanvas)._source=ConchTextCanvas,z$r._source.canvas=ConchTextCanvas):z$r=z$G.canvas.source,this.canvas=z$r,this._enableMerageInAtlas=!0,this._ctx=z$s?z$r:this.canvas.getContext("2d",void 0);var z$p=z$Z.measureText(this.char,this.font);this.cw=z$p.width*this.xs,this.ch=(z$p.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new z$a(this)}z$_(z$c,"laya.webgl.resource.WebGLCharImage",z$r);var z$U=z$c.prototype;return z$k.imps(z$U,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),z$U.active=function(){this.texture.active()},z$U.recreateResource=function(){var z$V=z$l.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),z$V){var z$U=this.fontSize;1==this.xs&&1==this.ys||(z$U=parseInt(z$U*(this.xs>this.ys?this.xs:this.ys)+""));var z$r="normal 100 "+this.font;z$r=z$r.replace(z$c._fontSizeReg,z$U),this.borderColor&&(z$r+=" 1 "+this.borderColor),this._ctx.font=z$r,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,z$m.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var z$s=this._ctx.measureText(this.char);z$s||(z$s={width:16});var z$p=z$s.width+1;this._ctx.lineTo(z$p,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},z$U.onresize=function(z$V,z$U){this._w=z$V,this._h=z$U,this._allowMerageInAtlas=!0},z$U.clearAtlasSource=function(){},z$s(0,z$U,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),z$s(0,z$U,"atlasSource",function(){return this.canvas}),z$s(0,z$U,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(z$V){this._enableMerageInAtlas=z$V}),z$c.createOneChar=function(z$V,z$U){return new z$c(z$V,z$U)},z$c._fontSizeReg=new RegExp("\\d+(?=px)","g"),z$c}(),z$XV=function(z$V){function z$t(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){void 0===z$r&&(z$r=6408),void 0===z$s&&(z$s=5121),void 0===z$p&&(z$p=34041),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=-1),void 0===z$N&&(z$N=1),z$t.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=z$V,this._h=z$U,this._surfaceFormat=z$r,this._surfaceType=z$s,this._depthStencilFormat=z$p,this._mipMap=z$c,this._repeat=z$R,this._minFifter=z$T,this._magFifter=z$N}z$_(z$t,"laya.webgl.resource.WebGLRenderTarget",z$r);var z$U=z$t.prototype;return z$U.recreateResource=function(){var z$V=z$LV.mainContext;this._frameBuffer||(this._frameBuffer=z$V.createFramebuffer()),this._source||(this._source=z$V.createTexture());var z$U=z$dV.curBindTexTarget,z$r=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,this._source),z$V.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var z$s=this._minFifter,z$p=this._magFifter,z$c=this._repeat?10497:33071,z$R=z$b.isPOT(this._w,this._h);if(z$R?(this._mipMap?-1!==z$s||(z$s=9987):-1!==z$s||(z$s=9729),-1!==z$p||(z$p=9729),z$V.texParameteri(3553,10241,z$s),z$V.texParameteri(3553,10240,z$p),z$V.texParameteri(3553,10242,z$c),z$V.texParameteri(3553,10243,z$c),this._mipMap&&z$V.generateMipmap(3553)):(-1!==z$s||(z$s=9729),-1!==z$p||(z$p=9729),z$V.texParameteri(3553,10241,z$s),z$V.texParameteri(3553,10240,z$p),z$V.texParameteri(3553,10242,33071),z$V.texParameteri(3553,10243,33071)),z$V.bindFramebuffer(36160,this._frameBuffer),z$V.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=z$V.createRenderbuffer()),z$V.bindRenderbuffer(36161,this._depthStencilBuffer),z$V.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:z$V.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:z$V.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:z$V.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}z$V.bindFramebuffer(36160,null),z$U&&z$r&&z$dV.bindTexture(z$V,z$U,z$r),z$V.bindRenderbuffer(36161,null),z$R&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},z$U.disposeResource=function(){this._frameBuffer&&(z$LV.mainContext.deleteTexture(this._source),z$LV.mainContext.deleteFramebuffer(this._frameBuffer),z$LV.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},z$s(0,z$U,"depthStencilBuffer",function(){return this._depthStencilBuffer}),z$s(0,z$U,"frameBuffer",function(){return this._frameBuffer}),z$t}(),z$eV=function(z$V){function z$T(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this.offsetX=0,this.offsetY=0,z$T.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=z$c,this.canvas=z$V,this._ctx=z$V.getContext("2d",void 0),this._w=z$s,this._h=z$p,this.offsetX=z$U,this.offsetY=z$r,this.src=z$R,this._enableMerageInAtlas=!0,z$J.enabled&&this._w<z$J.atlasLimitWidth&&this._h<z$J.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}z$_(z$T,"laya.webgl.resource.WebGLSubImage",z$r);var z$U=z$T.prototype;return z$k.imps(z$U,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),z$U.size=function(z$V,z$U){this._w=z$V,this._h=z$U,this._ctx&&this._ctx.size(z$V,z$U),this.canvas&&(this.canvas.height=z$U,this.canvas.width=z$V)},z$U.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},z$U.createWebGlTexture=function(){var z$V=z$LV.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var z$U=this._source=z$V.createTexture(),z$r=z$dV.curBindTexTarget,z$s=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,z$U),z$V.pixelStorei(37441,!0),z$V.texImage2D(3553,0,6408,6408,5121,this.canvas),z$V.pixelStorei(37441,!1);var z$p=this.minFifter,z$c=this.magFifter,z$R=this.repeat?10497:33071,z$T=z$b.isPOT(this.width,this.height);z$T?(this.mipmap?-1!==z$p||(z$p=9987):-1!==z$p||(z$p=9729),-1!==z$c||(z$c=9729),z$V.texParameteri(3553,10240,z$c),z$V.texParameteri(3553,10241,z$p),z$V.texParameteri(3553,10242,z$R),z$V.texParameteri(3553,10243,z$R),this.mipmap&&z$V.generateMipmap(3553)):(-1!==z$p||(z$p=9729),-1!==z$c||(z$c=9729),z$V.texParameteri(3553,10241,z$p),z$V.texParameteri(3553,10240,z$c),z$V.texParameteri(3553,10242,33071),z$V.texParameteri(3553,10243,33071)),z$r&&z$s&&z$dV.bindTexture(z$V,z$r,z$s),this.canvas=null,z$T&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},z$U.disposeResource=function(){z$J.enabled&&this._allowMerageInAtlas||!this._source||(z$LV.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},z$U.clearAtlasSource=function(){},z$s(0,z$U,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),z$s(0,z$U,"atlasSource",function(){return this.canvas}),z$s(0,z$U,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(z$V){this._allowMerageInAtlas=z$V}),z$T}(),z$FV=function(z$V){function z$t(z$V,z$U,z$r,z$s){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,z$t.__super.call(this),!z$V||!z$U)throw"Shader Error";this._id=++z$t._count,this._vs=z$V,this._ps=z$U,this._nameMap=z$s||{},null!=z$r&&(z$t.sharders[z$r]=this)}z$_(z$t,"laya.webgl.shader.Shader",z$ZV);var z$U=z$t.prototype;return z$U.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},z$U.disposeResource=function(){z$LV.mainContext.deleteShader(this._vshader),z$LV.mainContext.deleteShader(this._pshader),z$LV.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},z$U._compile=function(){if(!z$LV.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var z$V=[this._vs,this._ps],z$U=z$LV.mainContext;if(this._program=z$U.createProgram(),this._vshader=z$t._createShader(z$U,z$V[0],35633),this._pshader=z$t._createShader(z$U,z$V[1],35632),z$U.attachShader(this._program,this._vshader),z$U.attachShader(this._program,this._pshader),z$U.linkProgram(this._program),!z$l.isConchApp&&!z$U.getProgramParameter(this._program,35714))throw z$U.getProgramInfoLog(this._program);var z$r,z$s,z$p=0,z$c=0;for(z$c=z$l.isConchApp?z$U.getProgramParameterEx(this._vs,this._ps,"",35721):z$U.getProgramParameter(this._program,35721),z$p=0;z$p<z$c;z$p++){var z$R=null;z$r={vartype:"attribute",glfun:null,ivartype:0,attrib:z$R=z$l.isConchApp?z$U.getActiveAttribEx(this._vs,this._ps,"",z$p):z$U.getActiveAttrib(this._program,z$p),location:z$U.getAttribLocation(this._program,z$R.name),name:z$R.name,type:z$R.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(z$r)}var z$T=0;for(z$T=z$l.isConchApp?z$U.getProgramParameterEx(this._vs,this._ps,"",35718):z$U.getProgramParameter(this._program,35718),z$p=0;z$p<z$T;z$p++){var z$N=null;z$N=z$l.isConchApp?z$U.getActiveUniformEx(this._vs,this._ps,"",z$p):z$U.getActiveUniform(this._program,z$p),0<(z$r={vartype:"uniform",glfun:null,ivartype:1,attrib:z$R,location:z$U.getUniformLocation(this._program,z$N.name),name:z$N.name,type:z$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(z$r.name=z$r.name.substr(0,z$r.name.length-3),z$r.isArray=!0,z$r.location=z$U.getUniformLocation(this._program,z$r.name)),this._params.push(z$r)}for(z$p=0,z$s=this._params.length;z$p<z$s;z$p++)if((z$r=this._params[z$p]).indexOfParams=z$p,z$r.index=1,z$r.value=[z$r.location,null],z$r.codename=z$r.name,z$r.name=this._nameMap[z$r.codename]?this._nameMap[z$r.codename]:z$r.codename,(this._paramsMap[z$r.name]=z$r)._this=this,z$r.uploadedValue=[],"attribute"!==z$r.vartype)switch(z$r.type){case 5124:z$r.fun=z$r.isArray?this._uniform1iv:this._uniform1i;break;case 5126:z$r.fun=z$r.isArray?this._uniform1fv:this._uniform1f;break;case 35664:z$r.fun=z$r.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:z$r.fun=z$r.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:z$r.fun=z$r.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:z$r.fun=this._uniform_sampler2D;break;case 35680:z$r.fun=this._uniform_samplerCube;break;case 35676:z$r.glfun=z$U.uniformMatrix4fv,z$r.fun=this._uniformMatrix4fv;break;case 35670:z$r.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else z$r.fun=this._attribute}},z$U.getUniform=function(z$V){return this._paramsMap[z$V]},z$U._attribute=function(z$V,z$U){var z$r=z$LV.mainContext,z$s=z$$V._enableAtributes,z$p=z$V.location;return z$s[z$p]||z$r.enableVertexAttribArray(z$p),z$r.vertexAttribPointer(z$p,z$U[0],z$U[1],z$U[2],z$U[3],z$U[4]+this._offset),z$s[z$p]=z$$V._bindVertexBuffer,1},z$U._uniform1f=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U?(z$LV.mainContext.uniform1f(z$V.location,z$r[0]=z$U),1):0},z$U._uniform1fv=function(z$V,z$U){if(z$U.length<4){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$LV.mainContext.uniform1fv(z$V.location,z$U),z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3],1):0}return z$LV.mainContext.uniform1fv(z$V.location,z$U),1},z$U._uniform_vec2=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]?(z$LV.mainContext.uniform2f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1]),1):0},z$U._uniform_vec2v=function(z$V,z$U){if(z$U.length<2){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$LV.mainContext.uniform2fv(z$V.location,z$U),z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3],1):0}return z$LV.mainContext.uniform2fv(z$V.location,z$U),1},z$U._uniform_vec3=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]?(z$LV.mainContext.uniform3f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2]),1):0},z$U._uniform_vec3v=function(z$V,z$U){return z$LV.mainContext.uniform3fv(z$V.location,z$U),1},z$U._uniform_vec4=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$LV.mainContext.uniform4f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3]),1):0},z$U._uniform_vec4v=function(z$V,z$U){return z$LV.mainContext.uniform4fv(z$V.location,z$U),1},z$U._uniformMatrix2fv=function(z$V,z$U){return z$LV.mainContext.uniformMatrix2fv(z$V.location,!1,z$U),1},z$U._uniformMatrix3fv=function(z$V,z$U){return z$LV.mainContext.uniformMatrix3fv(z$V.location,!1,z$U),1},z$U._uniformMatrix4fv=function(z$V,z$U){return z$LV.mainContext.uniformMatrix4fv(z$V.location,!1,z$U),1},z$U._uniform1i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U?(z$LV.mainContext.uniform1i(z$V.location,z$r[0]=z$U),1):0},z$U._uniform1iv=function(z$V,z$U){return z$LV.mainContext.uniform1iv(z$V.location,z$U),1},z$U._uniform_ivec2=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]?(z$LV.mainContext.uniform2i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1]),1):0},z$U._uniform_ivec2v=function(z$V,z$U){return z$LV.mainContext.uniform2iv(z$V.location,z$U),1},z$U._uniform_vec3i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]?(z$LV.mainContext.uniform3i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2]),1):0},z$U._uniform_vec3vi=function(z$V,z$U){return z$LV.mainContext.uniform3iv(z$V.location,z$U),1},z$U._uniform_vec4i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$LV.mainContext.uniform4i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3]),1):0},z$U._uniform_vec4vi=function(z$V,z$U){return z$LV.mainContext.uniform4iv(z$V.location,z$U),1},z$U._uniform_sampler2D=function(z$V,z$U){var z$r=z$LV.mainContext,z$s=z$V.uploadedValue;return null==z$s[0]?(z$s[0]=this._curActTexIndex,z$r.uniform1i(z$V.location,this._curActTexIndex),z$r.activeTexture(z$t._TEXTURES[this._curActTexIndex]),z$dV.bindTexture(z$r,3553,z$U),this._curActTexIndex++,1):(z$r.activeTexture(z$t._TEXTURES[z$s[0]]),z$dV.bindTexture(z$r,3553,z$U),0)},z$U._uniform_samplerCube=function(z$V,z$U){var z$r=z$LV.mainContext,z$s=z$V.uploadedValue;return null==z$s[0]?(z$s[0]=this._curActTexIndex,z$r.uniform1i(z$V.location,this._curActTexIndex),z$r.activeTexture(z$t._TEXTURES[this._curActTexIndex]),z$dV.bindTexture(z$r,34067,z$U),this._curActTexIndex++,1):(z$r.activeTexture(z$t._TEXTURES[z$s[0]]),z$dV.bindTexture(z$r,34067,z$U),0)},z$U._noSetValue=function(z$V){console.log("no....:"+z$V.name)},z$U.uploadOne=function(z$V,z$U){this.activeResource(),z$dV.UseProgram(this._program);var z$r=this._paramsMap[z$V];z$r.fun.call(this,z$r,z$U)},z$U.uploadTexture2D=function(z$V){z$z.shaderCall++;var z$U=z$LV.mainContext;z$U.activeTexture(33984),z$dV.bindTexture(z$U,3553,z$V)},z$U.uploadTexture2D1=function(z$V){z$z.shaderCall++;var z$U=z$LV.mainContext;z$U.activeTexture(33985),z$dV.bindTexture(z$U,3553,z$V)},z$U.upload=function(z$V,z$U){z$ZV.activeShader=z$ZV.bindShader=this,this._lastUseFrameCount===z$z.loopCount||this.activeResource(),z$dV.UseProgram(this._program),this._reCompile?(z$U=this._params,this._reCompile=!1):z$U=z$U||this._params;z$LV.mainContext;for(var z$r,z$s,z$p=z$U.length,z$c=0,z$R=0;z$R<z$p;z$R++)null!==(z$s=z$V[(z$r=z$U[z$R]).name])&&(z$c+=z$r.fun.call(this,z$r,z$s));z$z.shaderCall+=z$c},z$U.uploadArray=function(z$V,z$U,z$r){z$ZV.activeShader=this,(z$ZV.bindShader=this).activeResource(),z$dV.UseProgram(this._program);this._params;for(var z$s,z$p,z$c=0,z$R=z$U-2;0<=z$R;z$R-=2)(z$p=this._paramsMap[z$V[z$R]])&&null!=(z$s=z$V[z$R+1])&&(z$r&&z$r[z$p.name]&&z$r[z$p.name].bind(),z$c+=z$p.fun.call(this,z$p,z$s));z$z.shaderCall+=z$c},z$U.getParams=function(){return this._params},z$t.getShader=function(z$V){return z$t.sharders[z$V]},z$t.create=function(z$V,z$U,z$r,z$s){return new z$t(z$V,z$U,z$r,z$s)},z$t.withCompile=function(z$V,z$U,z$r,z$s){if(z$r&&z$t.sharders[z$r])return z$t.sharders[z$r];var z$p=z$t._preCompileShader[2e-4*z$V];if(!z$p)throw new Error("withCompile shader err!"+z$V);return z$p.createShader(z$U,z$r,z$s)},z$t.withCompile2D=function(z$V,z$U,z$r,z$s,z$p){if(z$s&&z$t.sharders[z$s])return z$t.sharders[z$s];var z$c=z$t._preCompileShader[2e-4*z$V+z$U];if(!z$c)throw new Error("withCompile shader err!"+z$V+" "+z$U);return z$c.createShader(z$r,z$s,z$p)},z$t.addInclude=function(z$V,z$U){z$OV.addInclude(z$V,z$U)},z$t.preCompile=function(z$V,z$U,z$r,z$s){var z$p=2e-4*z$V;z$t._preCompileShader[z$p]=new z$OV(z$p,z$U,z$r,z$s)},z$t.preCompile2D=function(z$V,z$U,z$r,z$s,z$p){var z$c=2e-4*z$V+z$U;z$t._preCompileShader[z$c]=new z$OV(z$c,z$r,z$s,z$p)},z$t._createShader=function(z$V,z$U,z$r){var z$s=z$V.createShader(z$r);return z$V.shaderSource(z$s,z$U),z$V.compileShader(z$s),z$s},z$t._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],z$t._count=0,z$t._preCompileShader={},z$t.SHADERNAME2ID=2e-4,z$t.sharders=((z$t.sharders=[]).length=32,z$t.sharders),z$R(z$t,["nameKey",function(){return this.nameKey=new z$E}]),z$t}(),z$gV=function(z$V){function z$U(){this._maxsize=0,this._upload=!0,this._uploadSize=0,z$U.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}z$_(z$U,"laya.webgl.utils.Buffer2D",z$V);var z$r=z$U.prototype;return z$r.needSize=function(z$V){var z$U=this._byteLength;if(z$V){var z$r=this._byteLength+z$V;z$r<=this._buffer.byteLength||this._resizeBuffer(z$r<<1,!0),this._byteLength=z$r}return z$U},z$r._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),z$z.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,z$$V._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),z$$V._gl.bufferSubData(this._bufferType,0,this._buffer)},z$r._bufferSubData=function(z$V,z$U,z$r){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),this._maxsize=Math.max(this._maxsize,this._byteLength),z$z.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,z$$V._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),z$U||z$r){var z$s=this._buffer.slice(z$U,z$r);z$$V._gl.bufferSubData(this._bufferType,z$V,z$s)}else z$$V._gl.bufferSubData(this._bufferType,z$V,this._buffer)},z$r._checkArrayUse=function(){},z$r._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},z$r._bind_subUpload=function(z$V,z$U,z$r){return void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(z$V,z$U,z$r),!0)},z$r._resizeBuffer=function(z$V,z$U){if(z$V<this._buffer.byteLength)return this;if(this.memorySize=z$V,z$U&&this._buffer&&0<this._buffer.byteLength){var z$r=new ArrayBuffer(z$V);new Uint8Array(z$r).set(new Uint8Array(this._buffer),0),this._buffer=z$r}else this._buffer=new ArrayBuffer(z$V);return this._checkArrayUse(),this._upload=!0,this},z$r.append=function(z$V){this._upload=!0;var z$U,z$r;z$U=z$V.byteLength,z$V instanceof Uint8Array?(this._resizeBuffer(this._byteLength+z$U,!0),z$r=new Uint8Array(this._buffer,this._byteLength)):z$V instanceof Uint16Array?(this._resizeBuffer(this._byteLength+z$U,!0),z$r=new Uint16Array(this._buffer,this._byteLength)):z$V instanceof Float32Array&&(this._resizeBuffer(this._byteLength+z$U,!0),z$r=new Float32Array(this._buffer,this._byteLength)),z$r.set(z$V,0),this._byteLength+=z$U,this._checkArrayUse()},z$r.appendU16Array=function(z$V,z$U){this._resizeBuffer(this._byteLength+2*z$U,!0);for(var z$r=new Uint16Array(this._buffer,this._byteLength,z$U),z$s=0;z$s<z$U;z$s++)z$r[z$s]=z$V[z$s];this._byteLength+=2*z$U,this._checkArrayUse()},z$r.appendEx=function(z$V,z$U){this._upload=!0;var z$r;z$r=z$V.byteLength,this._resizeBuffer(this._byteLength+z$r,!0),new z$U(this._buffer,this._byteLength).set(z$V,0),this._byteLength+=z$r,this._checkArrayUse()},z$r.appendEx2=function(z$V,z$U,z$r,z$s){void 0===z$s&&(z$s=1),this._upload=!0;var z$p,z$c;z$p=z$r*z$s,this._resizeBuffer(this._byteLength+z$p,!0),z$c=new z$U(this._buffer,this._byteLength);var z$R=0;for(z$R=0;z$R<z$r;z$R++)z$c[z$R]=z$V[z$R];this._byteLength+=z$p,this._checkArrayUse()},z$r.getBuffer=function(){return this._buffer},z$r.setNeedUpload=function(){this._upload=!0},z$r.getNeedUpload=function(){return this._upload},z$r.upload=function(){var z$V=this._bind_upload();return z$$V._gl.bindBuffer(this._bufferType,null),z$$V._bindActive[this._bufferType]=null,z$ZV.activeShader=null,z$V},z$r.subUpload=function(z$V,z$U,z$r){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0);var z$s=this._bind_subUpload();return z$$V._gl.bindBuffer(this._bufferType,null),z$$V._bindActive[this._bufferType]=null,z$ZV.activeShader=null,z$s},z$r.disposeResource=function(){z$V.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},z$r.clear=function(){this._byteLength=0,this._upload=!0},z$s(0,z$r,"bufferLength",function(){return this._buffer.byteLength}),z$s(0,z$r,"byteLength",null,function(z$V){this._byteLength!==z$V&&(z$V<=this._buffer.byteLength||this._resizeBuffer(2*z$V+256,!0),this._byteLength=z$V)}),z$U.__int__=function(z$V){z$CV.QuadrangleIB=z$CV.create(35044),z$hV.fillIBQuadrangle(z$CV.QuadrangleIB,16)},z$U.FLOAT32=4,z$U.SHORT=2,z$U}(z$$V),z$vV=(function(z$U){function z$r(z$V){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,z$r.__super.call(this,9)}z$_(z$r,"laya.webgl.shader.d2.value.GlowSV",z$U);var z$V=z$r.prototype;z$V.setValue=function(z$V){z$U.prototype.setValue.call(this,z$V)},z$V.clear=function(){z$U.prototype.clear.call(this)}}(z$iV),function(z$V){function z$U(z$V){z$U.__super.call(this,64),this.defines.add(64)}z$_(z$U,"laya.webgl.shader.d2.value.TextSV",z$V);var z$r=z$U.prototype;return z$r.release=function(){(z$U.pool[z$U._length++]=this).clear()},z$r.clear=function(){z$V.prototype.clear.call(this)},z$U.create=function(){return z$U._length?z$U.pool[--z$U._length]:new z$U(null)},z$U.pool=[],z$U._length=0,z$U}(z$iV)),z$YV=function(z$V){function z$p(z$V,z$U,z$r,z$s){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,z$p.__super.call(this,z$V,z$U,z$r,z$s)}z$_(z$p,"laya.webgl.shader.d2.Shader2X",z$V);var z$U=z$p.prototype;return z$U.upload2dQuick1=function(z$V){this.upload(z$V,this._params2dQuick1||this._make2dQuick1())},z$U._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var z$V,z$U=this._params,z$r=0,z$s=z$U.length;z$r<z$s;z$r++)z$V=z$U[z$r],(z$l.isFlash||"size"!==z$V.name&&"position"!==z$V.name&&"texcoord"!==z$V.name)&&this._params2dQuick1.push(z$V)}return this._params2dQuick1},z$U.disposeResource=function(){z$V.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},z$U.upload2dQuick2=function(z$V){this.upload(z$V,this._params2dQuick2||this._make2dQuick2())},z$U._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var z$V,z$U=this._params,z$r=0,z$s=z$U.length;z$r<z$s;z$r++)z$V=z$U[z$r],(z$l.isFlash||"size"!==z$V.name)&&this._params2dQuick2.push(z$V)}return this._params2dQuick2},z$p.create=function(z$V,z$U,z$r,z$s){return new z$p(z$V,z$U,z$r,z$s)},z$p}(z$FV),z$CV=function(z$V){function z$U(z$V){this._uint8Array=null,this._uint16Array=null,void 0===z$V&&(z$V=35044),z$U.__super.call(this),this._bufferUsage=z$V,this._bufferType=34963,z$l.isFlash||(this._buffer=new ArrayBuffer(8))}z$_(z$U,"laya.webgl.utils.IndexBuffer2D",z$gV);var z$r=z$U.prototype;return z$r._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},z$r.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},z$r.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},z$r.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},z$U.QuadrangleIB=null,z$U.create=function(z$V){return void 0===z$V&&(z$V=35044),new z$U(z$V)},z$U}(),z$fV=function(z$V){function z$r(z$V,z$U){this._floatArray32=null,this._vertexStride=0,z$r.__super.call(this),this._vertexStride=z$V,this._bufferUsage=z$U,this._bufferType=34962,z$l.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}z$_(z$r,"laya.webgl.utils.VertexBuffer2D",z$V);var z$U=z$r.prototype;return z$U.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},z$U.bind=function(z$V){z$V&&z$V._bind(),this._bind()},z$U.insertData=function(z$V,z$U){this.getFloat32Array().set(z$V,z$U),this._upload=!0},z$U.bind_upload=function(z$V){z$V._bind_upload()||z$V._bind(),this._bind_upload()||this._bind()},z$U._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},z$U.disposeResource=function(){z$V.prototype.disposeResource.call(this)},z$U.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},z$s(0,z$U,"vertexStride",function(){return this._vertexStride}),z$r.create=function(z$V,z$U){return void 0===z$U&&(z$U=35048),new z$r(z$V,z$U)},z$r}(z$gV),z$VU=function(z$V){function z$T(z$V,z$U,z$r,z$s,z$p,z$c){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===z$r&&(z$r=6408),void 0===z$s&&(z$s=!0),z$T.__super.call(this,z$V,z$U),z$V){if(this._format=z$r,this._mipmap=z$s,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof z$V)this._url=z$V,this._src=z$V,this._image=new z$G.window.Image,z$U&&(z$U.onload&&(this.onload=z$U.onload),z$U.onerror&&(this.onerror=z$U.onerror),z$U.onCreate&&z$U.onCreate(this)),this._image.crossOrigin=z$V&&0==z$V.indexOf("data:")?null:"",z$V&&(this._image.src=z$V);else if(z$V instanceof ArrayBuffer){this._src=z$U,this._url=this._src;var z$R=new z$N(z$V);z$R.readUTFBytes(4),z$R.readUTFBytes(2),z$R.getInt16();z$R.endian="bigEndian",this._w=z$R.getInt16(),this._h=z$R.getInt16();z$R.getInt16(),z$R.getInt16();this._image=new Uint8Array(z$V,z$R.pos),this._format=z$LV.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,z$J.enabled&&this._w<z$J.atlasLimitWidth&&this._h<z$J.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(z$V instanceof Uint8Array))return this._src=z$U,this._url=this._src,this._image=z$V.source||z$V,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=z$U,this._url=this._src,this._w=z$p,this._h=z$c,this._image=z$V,this._format=0===z$r?z$V.byteLength/(z$p*z$c)==4?6408:6407:z$r}this._$5__enableMerageInAtlas=!0}}z$_(z$T,"laya.webgl.resource.WebGLImage",z$u);var z$U=z$T.prototype;return z$k.imps(z$U,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),z$U._init_=function(z$V,z$U){},z$U._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var z$V=z$LV.mainContext,z$U=this._source=z$V.createTexture(),z$r=z$dV.curBindTexTarget,z$s=z$dV.curBindTexValue;z$dV.bindTexture(z$V,3553,z$U);var z$p=this.minFifter,z$c=this.magFifter,z$R=this.repeat?10497:33071,z$T=z$b.isPOT(this._w,this._h),z$N=!1;switch(z$T?(this.mipmap?-1!==z$p||(z$p=9987):-1!==z$p||(z$p=9729),-1!==z$c||(z$c=9729),z$V.texParameteri(3553,10241,z$p),z$V.texParameteri(3553,10240,z$c),z$V.texParameteri(3553,10242,z$R),z$V.texParameteri(3553,10243,z$R),this.mipmap&&z$V.generateMipmap(3553)):(-1!==z$p||(z$p=9729),-1!==z$c||(z$c=9729),z$V.texParameteri(3553,10241,z$p),z$V.texParameteri(3553,10240,z$c),z$V.texParameteri(3553,10242,33071),z$V.texParameteri(3553,10243,33071)),z$V.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&z$V.pixelStorei(z$V.UNPACK_ALIGNMENT,1),z$V.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&z$V.pixelStorei(z$V.UNPACK_ALIGNMENT,1),z$V.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:z$N=!0,z$V.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case z$LV.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:z$N=!0,z$V.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}z$V.pixelStorei(37441,!1),z$r&&z$s&&z$dV.bindTexture(z$V,z$r,z$s),this.uri||(this.uri=this._url),z$N?this.memorySize=this._image.length:z$T&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},z$U.recreateResource=function(){var z$V=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var z$U=this;this._image=new z$G.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(z$U._needReleaseAgain)return z$U._needReleaseAgain=!1,z$U._image.onload=null,void(z$U._image=null);z$U._allowMerageInAtlas&&z$U._enableMerageInAtlas?(z$V.memorySize=0,z$V._recreateLock=!1):z$U._createWebGlTexture(),z$U.completeCreate()},this._image.src=this._src}},z$U.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&z$LV.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},z$U.onresize=function(){this._w=this._image.width,this._h=this._image.height,z$J.enabled&&this._w<z$J.atlasLimitWidth&&this._h<z$J.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},z$U.clearAtlasSource=function(){this._image=null},z$s(0,z$U,"format",function(){return this._format}),z$s(0,z$U,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(z$V){this._$5__enableMerageInAtlas=z$V}),z$s(0,z$U,"mipmap",function(){return this._mipmap}),z$s(0,z$U,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),z$s(0,z$U,"atlasSource",function(){return this._image}),z$s(0,z$U,"onload",null,function(z$V){var z$U=this;this._onload=z$V,this._image&&(this._image.onload=null!=this._onload?function(){z$U.onresize(),z$U._onload()}:null)}),z$s(0,z$U,"onerror",null,function(z$V){var z$U=this;this._onerror=z$V,this._image&&(this._image.onerror=null!=this._onerror?function(){z$U._onerror()}:null)}),z$T}();z$k.__init([z$GV,z$o,z$yV,z$OV])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}}),function(z$c,z$V,z$s){z$s.un,z$s.uns;var z$p=z$s.static,z$R=z$s.class,z$T=z$s.getset,z$N=(z$s.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),z$q=laya.utils.ClassUtils,z$S=(laya.events.Event,laya.utils.HTMLChar),z$t=laya.net.Loader,z$b=(laya.display.Node,laya.maths.Rectangle),z$_=laya.renders.Render,z$G=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),z$u=laya.utils.Stat,z$Z=laya.display.Text,z$h=laya.resource.Texture,z$l=laya.net.URL,z$W=laya.utils.Utils,z$O=function(){function z$G(){}return z$R(z$G,"laya.html.utils.HTMLParse"),z$G.parse=function(z$V,z$U,z$r){z$U=(z$U="<root>"+(z$U=z$U.replace(/<br>/g,"<br/>"))+"</root>").replace(z$G.spacePattern,z$G.char255);var z$s=z$W.parseXMLFromString(z$U);z$G._parseXML(z$V,z$s.childNodes[0].childNodes,z$r)},z$G._parseXML=function(z$V,z$U,z$r,z$s){var z$p=0,z$c=0;if(z$U.join||z$U.item)for(z$p=0,z$c=z$U.length;z$p<z$c;++z$p)z$G._parseXML(z$V,z$U[z$p],z$r,z$s);else{var z$R,z$T,z$N;if(3==z$U.nodeType)return void(z$V instanceof laya.html.dom.HTMLDivElement?(null==z$U.nodeName&&(z$U.nodeName="#text"),z$T=z$U.nodeName.toLowerCase(),0<(z$N=z$U.textContent.replace(/^\s+|\s+$/g,"")).length&&(z$R=z$q.getInstance(z$T))&&(z$V.addChild(z$R),z$R.innerTEXT=z$N.replace(z$G.char255AndOneSpacePattern," "))):0<(z$N=z$U.textContent.replace(/^\s+|\s+$/g,"")).length&&(z$V.innerTEXT=z$N.replace(z$G.char255AndOneSpacePattern," ")));if("#comment"==(z$T=z$U.nodeName.toLowerCase()))return;if(z$R=z$q.getInstance(z$T)){(z$R=z$V.addChild(z$R)).URI=z$r,z$R.href=z$s;var z$t=z$U.attributes;if(z$t&&0<z$t.length)for(z$p=0,z$c=z$t.length;z$p<z$c;++z$p){var z$b=z$t[z$p],z$S=z$b.nodeName,z$_=z$b.value;z$R._setAttributes(z$S,z$_)}z$G._parseXML(z$R,z$U.childNodes,z$r,z$R.href)}else z$G._parseXML(z$V,z$U.childNodes,z$r,z$s)}},z$G.char255=String.fromCharCode(255),z$G.spacePattern=/&nbsp;|&#160;/g,z$G.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),z$G}(),z$L=function(){function z$a(){}return z$R(z$a,"laya.html.utils.Layout"),z$a.later=function(z$V){null==z$a._will&&(z$a._will=[],z$s.stage.frameLoop(1,null,function(){if(!(z$a._will.length<1)){for(var z$V=0;z$V<z$a._will.length;z$V++)laya.html.utils.Layout.layout(z$a._will[z$V]);z$a._will.length=0}})),z$a._will.push(z$V)},z$a.layout=function(z$V){if(!z$V||!z$V._style)return null;if(0==(512&z$V._style._type))return null;z$V.getStyle()._type&=-513;var z$U=z$a._multiLineLayout(z$V);return z$_.isConchApp&&z$V.layaoutCallNative&&z$V.layaoutCallNative(),z$U},z$a._multiLineLayout=function(z$V){if(z$Z.RightToLeft)return z$a._multiLineLayout2(z$V);var z$U=new Array;z$V._addChildsToLayout(z$U);var z$r,z$s,z$p,z$c,z$R,z$T=0,z$N=z$U.length,z$t=z$V._getCSSStyle(),z$b=z$t.letterSpacing,z$S=z$t.leading,z$_=z$t.lineHeight,z$G=z$t._widthAuto()||!z$t.wordWrap,z$q=z$G?999999:z$V.width,z$u=(z$V.height,0),z$h=z$t.italic?z$t.fontSize/3:0,z$l=z$t._getAlign(),z$W=z$t._getValign(),z$O=0!==z$W||0!==z$l||0!=z$_,z$L=0,z$d=0,z$k=0,z$y=0,z$D=new Array,z$n=z$D[0]=new z$x,z$I=!1,z$Q=!1;z$n.h=0,z$t.italic&&(z$q-=z$t.fontSize/3);var z$H=0,z$w=!0;function z$z(){z$n.y=z$d,z$d+=z$n.h+z$S,0==z$n.h&&(z$d+=z$_),z$n.mWidth=z$H,z$H=0,z$n=new z$x,z$D.push(z$n),z$n.h=0,z$I=!(z$w=!(z$L=0))}for(z$T=0;z$T<z$N;z$T++)if(null!=(z$r=z$U[z$T]))if(z$w=!1,z$r instanceof laya.html.dom.HTMLBrElement)z$z(),z$n.y=z$d;else{if(z$r._isChar()){if((z$c=z$r).isWord)z$I=z$Q||"\n"===z$c.char,z$n.wordStartIndex=z$n.elements.length;else{if(z$k=z$c.width+z$c.style.letterSpacin,0<z$D.length&&z$q<z$L+z$k&&0<z$n.wordStartIndex){var z$E;z$E=z$n.elements.length-z$n.wordStartIndex+1,z$n.elements.length=z$n.wordStartIndex,z$T-=z$E,z$z();continue}z$I=!1,z$H+=z$c.width}z$k=z$c.width+z$b,z$y=z$c.height,z$Q=!1,(z$I=z$I||z$q<z$L+z$k)&&z$z(),z$n.minTextHeight=Math.min(z$n.minTextHeight,z$r.height)}else z$s=z$r._getCSSStyle(),z$R=z$r,z$p=z$s.padding,0===z$s._getCssFloat()||(z$O=!0),z$I=z$Q||z$s.lineElement,z$k=z$R.width*z$R._style._tf.scaleX+z$p[1]+z$p[3]+z$b,z$y=z$R.height*z$R._style._tf.scaleY+z$p[0]+z$p[2],z$Q=z$s.lineElement,(z$I=z$I||z$q<z$L+z$k&&z$s.wordWrap)&&z$z();z$n.elements.push(z$r),z$n.h=Math.max(z$n.h,z$y),z$r.x=z$L,z$r.y=z$d,z$L+=z$k,z$n.w=z$L-z$b,z$n.y=z$d,z$u=Math.max(z$L+z$h,z$u)}else z$w||(z$L+=z$a.DIV_ELEMENT_PADDING),z$n.wordStartIndex=z$n.elements.length;if(z$d=z$n.y+z$n.h,z$O){var z$K=0,z$m=z$q;for(z$G&&0<z$V.width&&(z$m=z$V.width),z$T=0,z$N=z$D.length;z$T<z$N;z$T++)z$D[z$T].updatePos(0,z$m,z$T,z$K,z$l,z$W,z$_),z$K+=Math.max(z$_,z$D[z$T].h+z$S);z$d=z$K}return z$G&&(z$V.width=z$u),z$d>z$V.height&&(z$V.height=z$d),[z$u,z$d]},z$a._multiLineLayout2=function(z$V){var z$U=new Array;z$V._addChildsToLayout(z$U);var z$r,z$s,z$p,z$c,z$R,z$T=0,z$N=z$U.length,z$t=z$V._getCSSStyle(),z$b=z$t.letterSpacing,z$S=z$t.leading,z$_=z$t.lineHeight,z$G=z$t._widthAuto()||!z$t.wordWrap,z$q=z$G?999999:z$V.width,z$u=(z$V.height,0),z$h=z$t.italic?z$t.fontSize/3:0,z$l=2-z$t._getAlign(),z$W=z$t._getValign(),z$O=0!==z$W||0!=z$l||0!=z$_,z$L=0,z$d=0,z$k=0,z$y=0,z$D=new Array,z$n=z$D[0]=new z$x,z$I=!1,z$Q=!1;z$n.h=0,z$t.italic&&(z$q-=z$t.fontSize/3);var z$H=0,z$w=!0;function z$z(){z$n.y=z$d,z$d+=z$n.h+z$S,0==z$n.h&&(z$d+=z$_),z$n.mWidth=z$H,z$H=0,z$n=new z$x,z$D.push(z$n),z$n.h=0,z$I=!(z$w=!(z$L=0))}for(z$T=0;z$T<z$N;z$T++)if(null!=(z$r=z$U[z$T]))if(z$w=!1,z$r instanceof laya.html.dom.HTMLBrElement)z$z(),z$n.y=z$d;else{if(z$r._isChar()){if((z$c=z$r).isWord)z$I=z$Q||"\n"===z$c.char,z$n.wordStartIndex=z$n.elements.length;else{if(0<z$D.length&&z$q<z$L+z$k&&0<z$n.wordStartIndex){var z$E;z$E=z$n.elements.length-z$n.wordStartIndex+1,z$n.elements.length=z$n.wordStartIndex,z$T-=z$E,z$z();continue}z$I=!1,z$H+=z$c.width}z$k=z$c.width+z$b,z$y=z$c.height,z$Q=!1,(z$I=z$I||z$q<z$L+z$k)&&z$z(),z$n.minTextHeight=Math.min(z$n.minTextHeight,z$r.height)}else z$s=z$r._getCSSStyle(),z$R=z$r,z$p=z$s.padding,0===z$s._getCssFloat()||(z$O=!0),z$I=z$Q||z$s.lineElement,z$k=z$R.width*z$R._style._tf.scaleX+z$p[1]+z$p[3]+z$b,z$y=z$R.height*z$R._style._tf.scaleY+z$p[0]+z$p[2],z$Q=z$s.lineElement,(z$I=z$I||z$q<z$L+z$k&&z$s.wordWrap)&&z$z();z$n.elements.push(z$r),z$n.h=Math.max(z$n.h,z$y),z$r.x=z$L,z$r.y=z$d,z$L+=z$k,z$n.w=z$L-z$b,z$n.y=z$d,z$u=Math.max(z$L+z$h,z$u)}else z$w||(z$L+=z$a.DIV_ELEMENT_PADDING),z$n.wordStartIndex=z$n.elements.length;if(z$d=z$n.y+z$n.h,z$O){var z$K=0,z$m=z$q;for(z$T=0,z$N=z$D.length;z$T<z$N;z$T++)z$D[z$T].updatePos(0,z$m,z$T,z$K,z$l,z$W,z$_),z$K+=Math.max(z$_,z$D[z$T].h+z$S);z$d=z$K}for(z$G&&(z$V.width=z$u),z$d>z$V.height&&(z$V.height=z$d),z$T=0,z$N=z$D.length;z$T<z$N;z$T++)z$D[z$T].revertOrder(z$q);return[z$u,z$d]},z$a._will=null,z$a.DIV_ELEMENT_PADDING=0,z$a}(),z$x=function(){function z$V(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}z$R(z$V,"laya.html.utils.LayoutLine");var z$U=z$V.prototype;return z$U.updatePos=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T,z$N=0;0<this.elements.length&&(z$N=(z$T=this.elements[this.elements.length-1]).x+z$T.width-this.elements[0].x);var z$t=0,z$b=NaN;1===z$p&&(z$t=(z$U-z$N)/2),2===z$p&&(z$t=z$U-z$N),0===z$R||0!=z$c||(z$c=1);for(var z$S=0,z$_=this.elements.length;z$S<z$_;z$S++){var z$G=(z$T=this.elements[z$S])._getCSSStyle();switch(0!==z$t&&(z$T.x+=z$t),z$G._getValign()){case 0:z$T.y=z$s;break;case 1:var z$q=0;99999!=this.minTextHeight&&(z$q=this.minTextHeight);var z$u=(z$q+z$R)/2;z$u=Math.max(z$u,this.h),z$b=(laya.html.dom.HTMLImageElement,z$s+z$u-z$T.height),z$T.y=z$b;break;case 2:z$T.y=z$s+(z$R-z$T.height)}}},z$U.revertOrder=function(z$V){var z$U;if(0<this.elements.length){var z$r,z$s=0;for(z$r=this.elements.length,z$s=0;z$s<z$r;z$s++)(z$U=this.elements[z$s]).x=z$V-z$U.x-z$U.width}},z$V}(),z$d=function(z$r){function z$U(){this.URI=null,this._href=null,z$U.__super.call(this),this._text=z$U._EMPTYTEXT,this.setStyle(new z$N(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}z$R(z$U,"laya.html.dom.HTMLElement",z$r);var z$V=z$U.prototype;return z$V.layaoutCallNative=function(){var z$V=0;if(this._childs&&0<(z$V=this._childs.length))for(var z$U=0;z$U<z$V;z$U++)this._childs[z$U].layaoutCallNative&&this._childs[z$U].layaoutCallNative();var z$r=this._getWords();z$r?laya.html.dom.HTMLElement.fillWords(this,z$r,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},z$V.appendChild=function(z$V){return this.addChild(z$V)},z$V._getWords2=function(){var z$V=this._text.text;if(!z$V||0===z$V.length)return null;var z$U,z$r,z$s=0,z$p=0;if(this._text.drawWords)z$r=this._text.drawWords;else{for(z$p=(z$U=z$V.split(" ")).length-1,z$r=[],z$s=0;z$s<z$p;z$s++)z$r.push(z$U[z$s]," ");0<=z$p&&z$r.push(z$U[z$p]),this._text.drawWords=z$r}var z$c,z$R=this._text.words;if(z$R&&z$R.length===z$r.length)return z$R;null===z$R&&(this._text.words=z$R=[]),z$R.length=z$r.length;var z$T=this.style,z$N=z$T.font;for(z$s=0,z$p=z$r.length;z$s<z$p;z$s++){z$c=z$W.measureText(z$r[z$s],z$N);var z$t=z$R[z$s]=new z$S(z$r[z$s],z$c.width,z$c.height||z$T.fontSize,z$T);if(1<z$t.char.length&&(z$t.charNum=z$t.char),this.href){var z$b=new z$G;this.addChild(z$b),z$t.setSprite(z$b)}}return z$R},z$V._getWords=function(){if(!z$Z.CharacterCache)return this._getWords2();var z$V=this._text.text;if(!z$V||0===z$V.length)return null;var z$U,z$r=this._text.words;if(z$r&&z$r.length===z$V.length)return z$r;null===z$r&&(this._text.words=z$r=[]),z$r.length=z$V.length;for(var z$s=this.style,z$p=z$s.font,z$c=0,z$R=z$V.length;z$c<z$R;z$c++)if(z$U=z$W.measureText(z$V.charAt(z$c),z$p)){var z$T=z$r[z$c]=new z$S(z$V.charAt(z$c),z$U.width,z$U.height||z$s.fontSize,z$s);if(this.href){var z$N=new z$G;this.addChild(z$N),z$T.setSprite(z$N)}}else console.warn("_getWords size is null"+z$V.charAt(z$c),z$p);return z$r},z$V.showLinkSprite=function(){var z$V=this._text.words;if(z$V)for(var z$U,z$r,z$s=[],z$p=0;z$p<z$V.length;z$p++)z$r=z$V[z$p],(z$U=new z$G).graphics.drawRect(0,0,z$r.width,z$r.height,"#ff0000"),z$U.width=z$r.width,z$U.height=z$r.height,this.addChild(z$U),z$s.push(z$U)},z$V._layoutLater=function(){var z$V=this.style;512&z$V._type||(z$V.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&z$V.block?(z$L.later(this),z$V._type|=512):this.parent&&this.parent._layoutLater())},z$V._setAttributes=function(z$V,z$U){switch(z$V){case"style":return void this.style.cssText(z$U);case"class":return void(this.className=z$U)}z$r.prototype._setAttributes.call(this,z$V,z$U)},z$V.updateHref=function(){if(null!=this._href){var z$V=this._getWords();if(z$V)for(var z$U,z$r,z$s=0;z$s<z$V.length;z$s++)(z$r=(z$U=z$V[z$s]).getSprite())&&(z$r.size(z$U.width,z$U.height),z$r.on("click",this,this.onLinkHandler))}},z$V.onLinkHandler=function(z$V){switch(z$V.type){case"click":for(var z$U=this;z$U;)z$U.event("link",[this.href]),z$U=z$U.parent}},z$V.formatURL=function(z$V){return this.URI?z$l.formatURL(z$V,this.URI?this.URI.path:null):z$V},z$T(0,z$V,"href",function(){return this._href},function(z$V){null!=(this._href=z$V)&&(this._getCSSStyle().underLine=1,this.updateHref())}),z$T(0,z$V,"color",null,function(z$V){this.style.color=z$V}),z$T(0,z$V,"onClick",null,function(z$V){z$s._runScript("fn=function(event){"+z$V+";}"),this.on("click",this,void 0)}),z$T(0,z$V,"id",null,function(z$V){z$k.document.setElementById(z$V,this)}),z$T(0,z$V,"innerTEXT",function(){return this._text.text},function(z$V){this.text=z$V}),z$T(0,z$V,"style",function(){return this._style}),z$T(0,z$V,"text",function(){return this._text.text},function(z$V){this._text==z$U._EMPTYTEXT?this._text={text:z$V,words:null}:(this._text.text=z$V,this._text.words&&(this._text.words.length=0)),z$_.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),z$T(0,z$V,"parent",z$r.prototype._$get_parent,function(z$V){if(z$V instanceof laya.html.dom.HTMLElement){var z$U=z$V;this.URI||(this.URI=z$U.URI),this.style.inherit(z$U.style)}z$s.superSet(z$G,this,"parent",z$V)}),z$T(0,z$V,"className",null,function(z$V){this.style.attrs(z$k.document.styleSheets["."+z$V])}),z$U.fillWords=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$V.graphics.clear();for(var z$T=0,z$N=z$U.length;z$T<z$N;z$T++){var z$t=z$U[z$T];z$V.graphics.fillText(z$t.char,z$t.x+z$r,z$t.y+z$s,z$p,z$c,"left",z$R)}},z$U._EMPTYTEXT={text:null,words:null},z$U}(z$G),z$U=(function(z$V){function z$U(){z$U.__super.call(this),this.style.lineElement=!0,this.style.block=!0}z$R(z$U,"laya.html.dom.HTMLBrElement",z$d)}(),function(z$V){function z$U(){this.contextHeight=NaN,this.contextWidth=NaN,z$U.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}z$R(z$U,"laya.html.dom.HTMLDivElement",z$V);var z$r=z$U.prototype;return z$r.appendHTML=function(z$V){z$O.parse(this,z$V,this.URI),this.layout()},z$r._addChildsToLayout=function(z$U){var z$V=this._getWords();if(null==z$V&&0==this._childs.length)return!1;z$V&&z$V.forEach(function(z$V){z$U.push(z$V)});for(var z$r=!0,z$s=0,z$p=this._childs.length;z$s<z$p;z$s++){var z$c=this._childs[z$s];z$r?z$r=!1:z$U.push(null),z$c._addToLayout(z$U)}return!0},z$r._addToLayout=function(z$V){this.layout()},z$r.layout=function(){if(this.style){this.style._type|=512;var z$V=z$L.layout(this);if(z$V){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new z$b);var z$U=this._$P.mHtmlBounds;z$U.x=z$U.y=0,z$U.width=this.contextWidth=z$V[0],z$U.height=this.contextHeight=z$V[1],this.setBounds(z$U)}}},z$T(0,z$r,"height",function(){return this._height?this._height:this.contextHeight},z$V.prototype._$set_height),z$T(0,z$r,"innerHTML",null,function(z$V){this.destroyChildren(),this.appendHTML(z$V)}),z$T(0,z$r,"width",function(){return this._width?this._width:this.contextWidth},function(z$V){var z$U=!1;z$U=0===z$V?z$V!=this._width:z$V!=this.width,z$s.superSet(z$d,this,"width",z$V),z$U&&this.layout()}),z$U}(z$d)),z$k=function(z$V){function z$U(){this.all=new Array,this.styleSheets=z$N.styleSheets,z$U.__super.call(this)}z$R(z$U,"laya.html.dom.HTMLDocument",z$d);var z$r=z$U.prototype;return z$r.getElementById=function(z$V){return this.all[z$V]},z$r.setElementById=function(z$V,z$U){this.all[z$V]=z$U},z$p(z$U,["document",function(){return this.document=new z$U}]),z$U}();(function(z$V){function z$U(){this._tex=null,this._url=null,this._renderArgs=[],z$U.__super.call(this),this.style.block=!0}z$R(z$U,"laya.html.dom.HTMLImageElement",z$d);var z$r=z$U.prototype;z$r._addToLayout=function(z$V){!this._style.absolute&&z$V.push(this)},z$r.render=function(z$V,z$U,z$r){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(z$u.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,z$V.ctx.drawTexture2(z$U,z$r,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},z$r.layaoutCallNative=function(){var z$V=0;if(this._childs&&0<(z$V=this._childs.length))for(var z$U=0;z$U<z$V;z$U++)this._childs[z$U].layaoutCallNative&&this._childs[z$U].layaoutCallNative()},z$T(0,z$r,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(z$V){this._width!==z$V&&(this._width=z$V,this._style.width=z$V,this.repaint())}),z$T(0,z$r,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(z$V){this._height!==z$V&&(this._height=z$V,this._style.height=z$V,this.repaint())}),z$r.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),z$t.clearCache(this,this._url),this._tex=null),z$d.prototype.destroy.call(this)},z$r.onloaded=function(){var z$V=this._style;z$V&&!z$V.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),z$V&&!z$V.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),z$_.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},z$r._loadImageComplete=function(z$V,z$U,z$r){if(!this._destroyed)if(null!=z$r)if(z$r instanceof ArrayBuffer){var z$s=new DataView(z$r);new laya.webgl.resource.WebGLImage(new Uint8Array(z$r,8),z$V,0,!1,z$s.getUint32(0),z$s.getUint32(4));this.onloaded()}else if(z$r instanceof z$h)z$t.imgMgrSet[z$V]=z$U,z$c.imgMgrLock(z$V,z$t.imgMgrSet[z$V]),this._url=z$V,this._tex=z$r,z$t.keepCache(this,z$V),z$t.cacheRes(z$V,this._tex),this.onloaded();else{var z$p=-1!=z$V.indexOf(".png",z$V.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(z$r,z$V,z$p,!1,z$r.width,z$r.height);this.onloaded()}else this.event("error","Load image failed")},z$T(0,z$r,"src",null,function(z$V){(z$V=this.formatURL(z$V),this._url!=z$V)&&(null!=this._tex&&(z$t.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=z$V,(this._tex=z$t.getRes(z$V))?(z$t.keepCache(this,z$V),this.onloaded()):z$c.imgMgrLoad(z$V,this._loadImageComplete.bind(this),2,!1))})})(),function(z$V){function z$U(){this.type=null,z$U.__super.call(this),this.visible=!1}z$R(z$U,"laya.html.dom.HTMLLinkElement",z$V);var z$r=z$U.prototype;z$r._onload=function(z$V){switch(this.type){case"text/css":z$N.parseCSS(z$V,this.URI)}},z$T(0,z$r,"href",z$V.prototype._$get_href,function(z$V){var z$U=this;z$V=this.formatURL(z$V),this.URI=new z$l(z$V);var z$r=new z$t;z$r.once("complete",null,function(z$V){z$U._onload(z$V)}),z$r.load(z$V,"text")}),z$U._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(z$d),function(z$V){function z$U(){z$U.__super.call(this),this.visible=!1}z$R(z$U,"laya.html.dom.HTMLStyleElement",z$V),z$T(0,z$U.prototype,"text",z$V.prototype._$get_text,function(z$V){z$N.parseCSS(z$V,null)})}(z$d),function(z$V){function z$U(){z$U.__super.call(this),this._getCSSStyle().valign="middle"}z$R(z$U,"laya.html.dom.HTMLIframeElement",z$V),z$T(0,z$U.prototype,"href",z$V.prototype._$get_href,function(z$r){var z$s=this;z$r=this.formatURL(z$r);var z$V=new z$t;z$V.once("complete",null,function(z$V){var z$U=z$s.URI;z$s.URI=new z$l(z$r),z$s.innerHTML=z$V,!z$U||(z$s.URI=z$U)}),z$V.load(z$r,"text")})}(z$U)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}}),function(z$p,z$V,z$u){z$u.un,z$u.uns;var z$s=z$u.static,z$c=z$u.class,z$R=z$u.getset,z$r=(z$u.__newvec,laya.display.Animation),z$h=(laya.utils.Browser,laya.utils.ClassUtils),z$T=laya.filters.ColorFilter,z$N=laya.utils.Ease,z$t=laya.events.Event,z$b=(laya.events.EventDispatcher,laya.display.css.Font),z$S=laya.display.FrameAnimation,z$U=laya.display.Graphics,z$_=laya.utils.Handler,z$G=laya.display.Input,z$W=laya.net.Loader,z$q=(laya.display.Node,laya.maths.Point),z$l=laya.maths.Rectangle,z$O=laya.renders.Render,z$L=laya.display.Sprite,z$d=laya.display.Text,z$k=laya.resource.Texture,z$y=laya.utils.Tween,z$D=laya.utils.Utils,z$n=laya.utils.WeakObject;z$u.interface("laya.ui.IItem"),z$u.interface("laya.ui.ISelect"),z$u.interface("laya.ui.IRender"),z$u.interface("laya.ui.IComponent"),z$u.interface("laya.ui.IBox","IComponent");var z$I=function(){function z$V(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return z$c(z$V,"laya.ui.LayoutStyle"),z$s(z$V,["EMPTY",function(){return this.EMPTY=new z$V}]),z$V}(),z$Q=function(){function z$V(){}return z$c(z$V,"laya.ui.Styles"),z$V.labelColor="#000000",z$V.buttonStateNum=3,z$V.scrollBarMinNum=15,z$V.scrollBarDelayTime=500,z$s(z$V,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),z$V}(),z$H=function(){function z$p(){}return z$c(z$p,"laya.ui.UIUtils"),z$p.fillArray=function(z$V,z$U,z$r){var z$s=z$V.concat();if(z$U)for(var z$p=z$U.split(","),z$c=0,z$R=Math.min(z$s.length,z$p.length);z$c<z$R;z$c++){var z$T=z$p[z$c];z$s[z$c]="true"==z$T||"false"!=z$T&&z$T,null!=z$r&&(z$s[z$c]=z$r(z$T))}return z$s},z$p.toColor=function(z$V){return z$D.toHexColor(z$V)},z$p.gray=function(z$V,z$U){void 0===z$U&&(z$U=!0),z$U?z$p.addFilter(z$V,z$p.grayFilter):z$p.clearFilter(z$V,z$T)},z$p.addFilter=function(z$V,z$U){var z$r=z$V.filters||[];z$r.push(z$U),z$V.filters=z$r},z$p.clearFilter=function(z$V,z$U){var z$r=z$V.filters;if(null!=z$r&&0<z$r.length){for(var z$s=z$r.length-1;-1<z$s;z$s--){var z$p=z$r[z$s];z$u.__typeof(z$p,z$U)&&z$r.splice(z$s,1)}z$V.filters=z$r}},z$p._getReplaceStr=function(z$V){return z$p.escapeSequence[z$V]},z$p.adptString=function(z$V){return z$V.replace(/\\(\w)/g,z$p._getReplaceStr)},z$p.getBindFun=function(z$V){var z$U=z$p._funMap.get(z$V);if(null==z$U){var z$r='"'+z$V+'"',z$s="(function(data){if(data==null)return;with(data){try{\nreturn "+(z$r=z$r.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";z$U=z$u._runScript(z$s),z$p._funMap.set(z$V,z$U)}return z$U},z$s(z$p,["grayFilter",function(){return this.grayFilter=new z$T([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new z$n}]),z$p}(),z$w=function(){function z$V(){}return z$c(z$V,"UIConfig"),z$V.touchScrollEnable=!0,z$V.mouseWheelEnable=!0,z$V.showButtons=!0,z$V.popupBgColor="#000000",z$V.popupBgAlpha=.5,z$V.closeDialogOnSide=!0,z$V}(),z$z=function(z$r){function z$l(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,z$l.__super.call(this),this._weakKeys=[]}z$c(z$l,"laya.ui.AutoBitmap",z$r);var z$V=z$l.prototype;return z$V.destroy=function(){if(z$W.clearObject(this,this._weakKey),this._weakKeys){for(var z$V=0,z$U=this._weakKeys.length;z$V<z$U;++z$V)z$W.clearObject(this,this._weakKeys[z$V]);this._weakKeys=null}z$r.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},z$V._setChanged=function(){this._isChanged||(this._isChanged=!0,z$u.timer.callLater(this,this.changeSource))},z$V.changeSource=function(){this._isChanged=!1;var z$V=this._source;if(z$V&&z$V.bitmap){var z$U=this.width,z$r=this.height,z$s=this._sizeGrid,z$p=z$V.sourceWidth,z$c=z$V.sourceHeight;if(!z$s||z$p===z$U&&z$c===z$r)this.cleanByTexture(z$V,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,z$U,z$r);else{z$W.clearObject(this,this._weakKey),z$V.$_GID||(z$V.$_GID=z$D.getGID());var z$R=z$V.$_GID+"."+z$U+"."+z$r+"."+z$s.join("."),z$T=z$W.findObject(z$R);if(z$D.isOKCmdList(z$T))return this._weakKey=z$R,z$W.keepObject(this,this._weakKey),void(this.cmds=z$T);this.clear();var z$N,z$t,z$b=z$s[0],z$S=z$s[1],z$_=z$s[2],z$G=z$s[3],z$q=z$s[4],z$u=!1;if(z$U==z$p&&(z$G=z$S=0),z$r==z$c&&(z$b=z$_=0),z$U<z$G+z$S){var z$h=z$U;z$u=!0,z$U=z$G+z$S,this.save(),this.clipRect(0,0,z$h,z$r)}z$G&&z$b&&(z$N=z$l.getTexture(z$V,0,0,z$G,z$b),z$t=this._weakKeys[0],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[0]=z$N.weakKey),this.drawTexture(z$N,0,0,z$G,z$b)):(z$W.clearObject(this,z$t),this._weakKeys[0]="")),z$S&&z$b&&(z$N=z$l.getTexture(z$V,z$p-z$S,0,z$S,z$b),z$t=this._weakKeys[1],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[1]=z$N.weakKey),this.drawTexture(z$N,z$U-z$S,0,z$S,z$b)):(z$W.clearObject(this,z$t),this._weakKeys[1]="")),z$G&&z$_&&(z$N=z$l.getTexture(z$V,0,z$c-z$_,z$G,z$_),z$t=this._weakKeys[2],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[2]=z$N.weakKey),this.drawTexture(z$N,0,z$r-z$_,z$G,z$_)):(z$W.clearObject(this,z$t),this._weakKeys[2]="")),z$S&&z$_&&(z$N=z$l.getTexture(z$V,z$p-z$S,z$c-z$_,z$S,z$_),z$t=this._weakKeys[3],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[3]=z$N.weakKey),this.drawTexture(z$N,z$U-z$S,z$r-z$_,z$S,z$_)):(z$W.clearObject(this,z$t),this._weakKeys[3]="")),z$b&&(z$N=z$l.getTexture(z$V,z$G,0,z$p-z$G-z$S,z$b),z$t=this._weakKeys[4],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[4]=z$N.weakKey),this.drawBitmap(z$q,z$N,z$G,0,z$U-z$G-z$S,z$b)):(z$W.clearObject(this,z$t),this._weakKeys[4]="")),z$_&&(z$N=z$l.getTexture(z$V,z$G,z$c-z$_,z$p-z$G-z$S,z$_),z$t=this._weakKeys[5],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[5]=z$N.weakKey),this.drawBitmap(z$q,z$N,z$G,z$r-z$_,z$U-z$G-z$S,z$_)):(z$W.clearObject(this,z$t),this._weakKeys[5]="")),z$G&&(z$N=z$l.getTexture(z$V,0,z$b,z$G,z$c-z$b-z$_),z$t=this._weakKeys[6],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[6]=z$N.weakKey),this.drawBitmap(z$q,z$N,0,z$b,z$G,z$r-z$b-z$_)):(z$W.clearObject(this,z$t),this._weakKeys[6]="")),z$S&&(z$N=z$l.getTexture(z$V,z$p-z$S,z$b,z$S,z$c-z$b-z$_),z$t=this._weakKeys[7],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[7]=z$N.weakKey),this.drawBitmap(z$q,z$N,z$U-z$S,z$b,z$S,z$r-z$b-z$_)):(z$W.clearObject(this,z$t),this._weakKeys[7]="")),z$N=z$l.getTexture(z$V,z$G,z$b,z$p-z$G-z$S,z$c-z$b-z$_),z$t=this._weakKeys[8],z$N?(z$t!=z$N.weakKey&&(z$W.clearObject(this,z$t),z$W.keepObject(this,z$N.weakKey),this._weakKeys[8]=z$N.weakKey),this.drawBitmap(z$q,z$N,z$G,z$b,z$U-z$G-z$S,z$r-z$b-z$_)):(z$W.clearObject(this,z$t),this._weakKeys[8]=""),z$u&&this.restore(),this.autoCacheCmd&&!z$O.isConchApp&&(z$W.saveObject(z$R,this.cmds,null),this._weakKey=z$R,z$W.keepObject(this,this._weakKey))}this._repaint()}},z$V.drawBitmap=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=0),z$p<.1||z$c<.1||(!z$V||z$U.width==z$p&&z$U.height==z$c?this.drawTexture(z$U,z$r,z$s,z$p,z$c):this.fillTexture(z$U,z$r,z$s,z$p,z$c))},z$V.clear=function(z$V){void 0===z$V&&(z$V=!0),z$r.prototype.clear.call(this,!1)},z$R(0,z$V,"sizeGrid",function(){return this._sizeGrid},function(z$V){this._sizeGrid=z$V,this._setChanged()}),z$R(0,z$V,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(z$V){this._width!=z$V&&(this._width=z$V,this._setChanged())}),z$R(0,z$V,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(z$V){this._height!=z$V&&(this._height=z$V,this._setChanged())}),z$R(0,z$V,"source",function(){return this._source},function(z$V){z$V?(this._source=z$V,this._setChanged()):(this._source=null,this.clear())}),z$l.getTexture=function(z$V,z$U,z$r,z$s,z$p){z$s<=0&&(z$s=1),z$p<=0&&(z$p=1),z$V.$_GID||(z$V.$_GID=z$D.getGID());var z$c=z$V.$_GID+"."+z$U+"."+z$r+"."+z$s+"."+z$p,z$R=z$W.findObject(z$c);if((!z$R||!z$R.source)&&(z$R=z$k.createFromTexture(z$V,z$U,z$r,z$s,z$p))){if(z$V.alphaTexture){var z$T=z$V.width/z$V.alphaTexture.width;z$R.alphaTexture=z$k.createFromTexture(z$V.alphaTexture,z$U/z$T,z$r/z$T,z$s/z$T,z$p/z$T)}z$W.saveObject(z$c,z$R),z$R.weakKey=z$c}return z$R},z$l}(z$U),z$E=(function(z$V){function z$U(){z$U.__super.call(this)}z$c(z$U,"laya.ui.UIEvent",z$t),z$U.SHOW_TIP="showtip",z$U.HIDE_TIP="hidetip"}(),function(z$U){function z$V(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,z$V.__super.call(this),this._layout=z$I.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}z$c(z$V,"laya.ui.Component",z$U);var z$r=z$V.prototype;return z$u.imps(z$r,{"laya.ui.IComponent":!0}),z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},z$r.preinitialize=function(){},z$r.createChildren=function(){},z$r.initialize=function(){},z$r.callLater=function(z$V,z$U){z$u.timer.callLater(this,z$V,z$U)},z$r.runCallLater=function(z$V){z$u.timer.runCallLater(this,z$V)},z$r.commitMeasure=function(){},z$r.changeSize=function(){this.event("resize")},z$r.getLayout=function(){return this._layout===z$I.EMPTY&&(this._layout=new z$I),this._layout},z$r._setLayoutEnabled=function(z$V){this._layout&&this._layout.enable!=z$V&&(this._layout.enable=z$V,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},z$r.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},z$r.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},z$r.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},z$r.resetLayoutX=function(){var z$V=this._layout;if(isNaN(z$V.anchorX)||(this.pivotX=z$V.anchorX*this.width),this.layoutEnabled){var z$U=this.parent;z$U&&(isNaN(z$V.centerX)?isNaN(z$V.left)?isNaN(z$V.right)||(this.x=Math.round(z$U.width-this.displayWidth-z$V.right+this.pivotX*this.scaleX)):(this.x=Math.round(z$V.left+this.pivotX*this.scaleX),isNaN(z$V.right)||(this.width=(z$U._width-z$V.left-z$V.right)/(this.scaleX||.01))):this.x=Math.round(.5*(z$U.width-this.displayWidth)+z$V.centerX+this.pivotX*this.scaleX))}},z$r.resetLayoutY=function(){var z$V=this._layout;if(isNaN(z$V.anchorY)||(this.pivotY=z$V.anchorY*this.height),this.layoutEnabled){var z$U=this.parent;z$U&&(isNaN(z$V.centerY)?isNaN(z$V.top)?isNaN(z$V.bottom)||(this.y=Math.round(z$U.height-this.displayHeight-z$V.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(z$V.top+this.pivotY*this.scaleY),isNaN(z$V.bottom)||(this.height=(z$U._height-z$V.top-z$V.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(z$U.height-this.displayHeight)+z$V.centerY+this.pivotY*this.scaleY))}},z$r.onMouseOver=function(z$V){z$u.stage.event("showtip",this._toolTip)},z$r.onMouseOut=function(z$V){z$u.stage.event("hidetip",this._toolTip)},z$R(0,z$r,"displayWidth",function(){return this.width*this.scaleX}),z$R(0,z$r,"width",function(){return this._width?this._width:this.measureWidth},function(z$V){this._width!=z$V&&(this._width=z$V,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),z$R(0,z$r,"measureWidth",function(){var z$V=0;this.commitMeasure();for(var z$U=this.numChildren-1;-1<z$U;z$U--){var z$r=this.getChildAt(z$U);z$r.visible&&(z$V=Math.max(z$r.x+z$r.width*z$r.scaleX,z$V))}return z$V}),z$R(0,z$r,"displayHeight",function(){return this.height*this.scaleY}),z$R(0,z$r,"height",function(){return this._height?this._height:this.measureHeight},function(z$V){this._height!=z$V&&(this._height=z$V,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),z$R(0,z$r,"dataSource",function(){return this._dataSource},function(z$V){for(var z$U in this._dataSource=z$V,this._dataSource)this.hasOwnProperty(z$U)&&"function"!=typeof this[z$U]&&(this[z$U]=this._dataSource[z$U])}),z$R(0,z$r,"scaleY",z$U.prototype._$get_scaleY,function(z$V){z$u.superGet(z$L,this,"scaleY")!=z$V&&(z$u.superSet(z$L,this,"scaleY",z$V),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),z$R(0,z$r,"measureHeight",function(){var z$V=0;this.commitMeasure();for(var z$U=this.numChildren-1;-1<z$U;z$U--){var z$r=this.getChildAt(z$U);z$r.visible&&(z$V=Math.max(z$r.y+z$r.height*z$r.scaleY,z$V))}return z$V}),z$R(0,z$r,"scaleX",z$U.prototype._$get_scaleX,function(z$V){z$u.superGet(z$L,this,"scaleX")!=z$V&&(z$u.superSet(z$L,this,"scaleX",z$V),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),z$R(0,z$r,"top",function(){return this._layout.top},function(z$V){z$V!=this._layout.top&&(this.getLayout().top=z$V,this._setLayoutEnabled(!0)),this.resetLayoutY()}),z$R(0,z$r,"bottom",function(){return this._layout.bottom},function(z$V){z$V!=this._layout.bottom&&(this.getLayout().bottom=z$V,this._setLayoutEnabled(!0)),this.resetLayoutY()}),z$R(0,z$r,"left",function(){return this._layout.left},function(z$V){z$V!=this._layout.left&&(this.getLayout().left=z$V,this._setLayoutEnabled(!0)),this.resetLayoutX()}),z$R(0,z$r,"right",function(){return this._layout.right},function(z$V){z$V!=this._layout.right&&(this.getLayout().right=z$V,this._setLayoutEnabled(!0)),this.resetLayoutX()}),z$R(0,z$r,"centerX",function(){return this._layout.centerX},function(z$V){z$V!=this._layout.centerX&&(this.getLayout().centerX=z$V,this._setLayoutEnabled(!0)),this.resetLayoutX()}),z$R(0,z$r,"centerY",function(){return this._layout.centerY},function(z$V){z$V!=this._layout.centerY&&(this.getLayout().centerY=z$V,this._setLayoutEnabled(!0)),this.resetLayoutY()}),z$R(0,z$r,"anchorX",function(){return this._layout.anchorX},function(z$V){z$V!=this._layout.anchorX&&(this.getLayout().anchorX=z$V,this._setLayoutEnabled(!0)),this.resetLayoutX()}),z$R(0,z$r,"anchorY",function(){return this._layout.anchorY},function(z$V){z$V!=this._layout.anchorY&&(this.getLayout().anchorY=z$V,this._setLayoutEnabled(!0)),this.resetLayoutY()}),z$R(0,z$r,"tag",function(){return this._tag},function(z$V){this._tag=z$V}),z$R(0,z$r,"toolTip",function(){return this._toolTip},function(z$V){this._toolTip!=z$V&&(null!=(this._toolTip=z$V)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),z$R(0,z$r,"comXml",function(){return this._comXml},function(z$V){this._comXml=z$V}),z$R(0,z$r,"gray",function(){return this._gray},function(z$V){z$V!==this._gray&&(this._gray=z$V,z$H.gray(this,z$V))}),z$R(0,z$r,"disabled",function(){return this._disabled},function(z$V){z$V!==this._disabled&&(this.gray=this._disabled=z$V,this.mouseEnabled=!z$V)}),z$V}(z$L)),z$K=function(z$V){function z$U(){this.lockLayer=null,this.popupEffect=function(z$V){z$V.scale(1,1),z$y.from(z$V,{x:z$u.stage.width/2,y:z$u.stage.height/2,scaleX:0,scaleY:0},300,z$N.backOut,z$_.create(this,this.doOpen,[z$V]))},this.closeEffect=function(z$V,z$U){z$y.to(z$V,{x:z$u.stage.width/2,y:z$u.stage.height/2,scaleX:0,scaleY:0},300,z$N.strongOut,z$_.create(this,this.doClose,[z$V,z$U]))},z$U.__super.call(this),this.maskLayer=new z$L,this.popupEffectHandler=z$_.create(this,this.popupEffect,null,!1),this.closeEffectHandler=z$_.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,z$u.stage.addChild(this),z$u.stage.on("resize",this,this._onResize),z$w.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}z$c(z$U,"laya.ui.DialogManager",z$L);var z$r=z$U.prototype;return z$r._closeOnSide=function(){var z$V=this.getChildAt(this.numChildren-1);z$V instanceof laya.ui.Dialog&&z$V.close("side")},z$r.setLockView=function(z$V){this.lockLayer||(this.lockLayer=new z$m,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(z$u.stage.width,z$u.stage.height)),this.lockLayer.removeChildren(),z$V&&(z$V.centerX=z$V.centerY=0,this.lockLayer.addChild(z$V))},z$r._onResize=function(z$V){var z$U=this.maskLayer.width=z$u.stage.width,z$r=this.maskLayer.height=z$u.stage.height;this.lockLayer&&this.lockLayer.size(z$U,z$r),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,z$U,z$r,z$w.popupBgColor),this.maskLayer.alpha=z$w.popupBgAlpha;for(var z$s=this.numChildren-1;-1<z$s;z$s--){var z$p=this.getChildAt(z$s);z$p.popupCenter&&this._centerDialog(z$p)}},z$r._centerDialog=function(z$V){z$V.x=Math.round((z$u.stage.width-z$V.width>>1)+z$V.pivotX),z$V.y=Math.round((z$u.stage.height-z$V.height>>1)+z$V.pivotY)},z$r.open=function(z$V,z$U,z$r){void 0===z$U&&(z$U=!1),void 0===z$r&&(z$r=!1),z$U&&this._closeAll(),z$V.popupCenter&&this._centerDialog(z$V),this.addChild(z$V),(z$V.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),z$r&&null!=z$V.popupEffect?z$V.popupEffect.runWith(z$V):this.doOpen(z$V),this.event("open")},z$r.doOpen=function(z$V){z$V.onOpened()},z$r.lock=function(z$V){this.lockLayer&&(z$V?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},z$r.close=function(z$V,z$U,z$r){void 0===z$r&&(z$r=!1),z$r&&null!=z$V.closeEffect?z$V.closeEffect.runWith([z$V,z$U]):this.doClose(z$V,z$U),this.event("close")},z$r.doClose=function(z$V,z$U){z$V.removeSelf(),z$V.isModal&&this._checkMask(),z$V.closeHandler&&z$V.closeHandler.runWith(z$U),z$V.onClosed(z$U)},z$r.closeAll=function(){this._closeAll(),this.event("close")},z$r._closeAll=function(){for(var z$V=this.numChildren-1;-1<z$V;z$V--){var z$U=this.getChildAt(z$V);z$U&&null!=z$U.close&&this.doClose(z$U)}},z$r.getDialogsByGroup=function(z$V){for(var z$U=[],z$r=this.numChildren-1;-1<z$r;z$r--){var z$s=this.getChildAt(z$r);z$s&&z$s.group===z$V&&z$U.push(z$s)}return z$U},z$r.closeByGroup=function(z$V){for(var z$U=[],z$r=this.numChildren-1;-1<z$r;z$r--){var z$s=this.getChildAt(z$r);z$s&&z$s.group===z$V&&(z$s.close(),z$U.push(z$s))}return z$U},z$r._checkMask=function(){this.maskLayer.removeSelf();for(var z$V=this.numChildren-1;-1<z$V;z$V--){var z$U=this.getChildAt(z$V);if(z$U&&z$U.isModal)return void this.addChildAt(this.maskLayer,z$V)}},z$U}(),z$m=function(z$V){function z$U(){z$U.__super.call(this)}z$c(z$U,"laya.ui.Box",z$V);var z$r=z$U.prototype;return z$u.imps(z$r,{"laya.ui.IBox":!0}),z$R(0,z$r,"dataSource",z$V.prototype._$get_dataSource,function(z$V){for(var z$U in this._dataSource=z$V){var z$r=this.getChildByName(z$U);z$r?z$r.dataSource=z$V[z$U]:this.hasOwnProperty(z$U)&&"function"!=typeof this[z$U]&&(this[z$U]=z$V[z$U])}}),z$U}(z$E),z$a=function(z$U){function z$r(z$V,z$U){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,z$r.__super.call(this),this._labelColors=z$Q.buttonLabelColors,this._stateNum=z$Q.buttonStateNum,void 0===z$U&&(z$U=""),this.skin=z$V,this.label=z$U}z$c(z$r,"laya.ui.Button",z$U);var z$V=z$r.prototype;return z$u.imps(z$V,{"laya.ui.ISelect":!0}),z$V.destroy=function(z$V){this.clearEvent(),z$W.clearCache(this,this._skin),z$W.clearObject(this,this._weakKey),void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(z$V),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},z$V.clearEvent=function(){this._skin&&z$p.atalsNotify&&z$p.atalsNotify.off(this._skin,this,this._setBtnSource)},z$V.createChildren=function(){this.graphics=this._bitmap=new z$z},z$V.createText=function(){this._text||(this._text=new z$d,this._text.overflow=z$d.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},z$V.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},z$V.onMouse=function(z$V){if(!1!==this.toggle||!this._selected)return"click"===z$V.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=z$r.stateMap[z$V.type]))},z$V.changeClips=function(){var z$V=z$W.getRes(this._skin);if(z$V)if(this._skin&&""!=this._skin){z$W.clearObject(this,this._weakKey);var z$U=z$V.sourceWidth,z$r=z$V.sourceHeight/this._stateNum;z$V.$_GID||(z$V.$_GID=z$D.getGID());var z$s=z$V.$_GID+"-"+this._stateNum,z$p=z$W.findObject(z$s);if(z$D.isOkTextureList(z$p)||(z$p=null),z$p)this._weakKey=z$s,z$W.keepObject(this,this._weakKey),this._sources=z$p;else{if(this._sources=[],1===this._stateNum)this._sources.push(z$V);else for(var z$c=0;z$c<this._stateNum;z$c++){var z$R=z$k.createFromTexture(z$V,0,z$r*z$c,z$U,z$r);if(z$V.alphaTexture){var z$T=z$V.width/z$V.alphaTexture.width;z$R.alphaTexture=z$k.createFromTexture(z$V.alphaTexture,0/z$T,z$r*z$c/z$T,z$U/z$T,z$r/z$T)}this._sources.push(z$R)}z$W.saveObject(z$s,this._sources),this._weakKey=z$s,z$W.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||z$U,this._bitmap.height=this._height||z$r,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=z$U)}else console.warn("lose skin ",this._skin,this.name,this.__className)},z$V.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var z$V=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[z$V]),this.label&&(this._text.color=this._labelColors[z$V],this._strokeColors&&(this._text.strokeColor=this._strokeColors[z$V]))},z$V._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},z$R(0,z$V,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(z$V){this.createText(),this._text.strokeColor=z$V}),z$R(0,z$V,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){if(this._skin!=z$V)if(this.clearEvent(),z$W.clearCache(this,this._skin),this._skin=z$V,z$W.keepCache(this,this._skin),z$W.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var z$U=z$p.resAtalsObj&&z$p.resAtalsObj[this._skin];z$U?(z$p.atalsNotify&&z$p.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=z$U.sourceW),0==this.height&&(this.height=z$U.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),z$V._setBtnSource=function(z$V,z$U){z$V===this._skin&&z$U&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},z$R(0,z$V,"state",function(){return this._state},function(z$V){this._state!=z$V&&(this._state=z$V,this._setStateChanged())}),z$R(0,z$V,"text",function(){return this.createText(),this._text}),z$R(0,z$V,"stateNum",function(){return this._stateNum},function(z$V){"string"==typeof z$V&&(z$V=parseInt(z$V)),this._stateNum!=z$V&&(this._stateNum=z$V<1?1:3<z$V?3:z$V,this.callLater(this.changeClips))}),z$R(0,z$V,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(z$V){this._strokeColors=z$H.fillArray(z$Q.buttonLabelColors,z$V,String),this._setStateChanged()}),z$R(0,z$V,"labelColors",function(){return this._labelColors.join(",")},function(z$V){this._labelColors=z$H.fillArray(z$Q.buttonLabelColors,z$V,String),this._setStateChanged()}),z$R(0,z$V,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),z$R(0,z$V,"label",function(){return this._text?this._text.text:null},function(z$V){(this._text||z$V)&&(this.createText(),this._text.text!=z$V&&(z$V&&!this._text.parent&&this.addChild(this._text),this._text.text=(z$V+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),z$R(0,z$V,"selected",function(){return this._selected},function(z$V){this._selected!=z$V&&(this._selected=z$V,this.state=this._selected?2:0,this.event("change"))}),z$R(0,z$V,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(z$V){this.createText(),this._text.padding=z$H.fillArray(z$Q.labelPadding,z$V,Number)}),z$R(0,z$V,"labelSize",function(){return this.createText(),this._text.fontSize},function(z$V){this.createText(),this._text.fontSize=z$V}),z$R(0,z$V,"labelStroke",function(){return this.createText(),this._text.stroke},function(z$V){this.createText(),this._text.stroke=z$V}),z$R(0,z$V,"labelBold",function(){return this.createText(),this._text.bold},function(z$V){this.createText(),this._text.bold=z$V}),z$R(0,z$V,"labelFont",function(){return this.createText(),this._text.font},function(z$V){this.createText(),this._text.font=z$V}),z$R(0,z$V,"labelAlign",function(){return this.createText(),this._text.align},function(z$V){this.createText(),this._text.align=z$V}),z$R(0,z$V,"clickHandler",function(){return this._clickHandler},function(z$V){this._clickHandler=z$V}),z$R(0,z$V,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(z$V){this._bitmap.sizeGrid=z$H.fillArray(z$Q.defaultSizeGrid,z$V,Number)}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$E,this,"width",z$V),this._autoSize&&(this._bitmap.width=z$V,this._text&&(this._text.width=z$V))}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$E,this,"height",z$V),this._autoSize&&(this._bitmap.height=z$V,this._text&&(this._text.height=z$V))}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)||"string"==typeof z$V?this.label=z$V+"":z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(z$V){this._bitmap._offset=z$V?z$H.fillArray([1,1],z$V,Number):[]}),z$s(z$r,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),z$r}(z$E),z$Z=function(z$U){function z$s(z$V,z$U,z$r){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,z$s.__super.call(this),void 0===z$U&&(z$U=1),void 0===z$r&&(z$r=1),this._clipX=z$U,this._clipY=z$r,this.skin=z$V}z$c(z$s,"laya.ui.Clip",z$U);var z$V=z$s.prototype;return z$V.destroy=function(z$V){this.clearEvent(),this.clearLoad(),z$W.clearCache(this,this._skin),z$W.clearObject(this,this._weakKey),void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},z$V.dispose=function(){this.destroy(!0),z$u.loader.clearRes(this._skin)},z$V.createChildren=function(){this.graphics=this._bitmap=new z$z},z$V._onDisplay=function(z$V){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},z$V.changeClip=function(){if(this._clipChanged=!1,this._skin){var z$V=z$W.getRes(this._skin);if(z$V)this.loadComplete(this._skin,z$V);else{if(z$p.resAtalsObj&&z$p.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=z$_.create(this,this.loadComplete,[this._skin]),this._progress=null,z$u.loader.load(this._skin,this._complete,this._progress)}}},z$V.loadComplete=function(z$V,z$U){if(z$V===this._skin&&z$U){z$W.clearObject(this,this._weakKey);var z$r=this._clipWidth||Math.ceil(z$U.sourceWidth/this._clipX),z$s=this._clipHeight||Math.ceil(z$U.sourceHeight/this._clipY),z$p=this._skin+z$r+z$s,z$c=z$W.findObject(z$p);if(z$D.isOkTextureList(z$c)||(z$c=null),z$c)this._weakKey=z$p,z$W.keepObject(this,this._weakKey),this._sources=z$c;else{this._sources=[];for(var z$R=0;z$R<this._clipY;z$R++)for(var z$T=0;z$T<this._clipX;z$T++){var z$N=z$k.createFromTexture(z$U,z$r*z$T,z$s*z$R,z$r,z$s);if(z$U.alphaTexture){var z$t=z$U.width/z$U.alphaTexture.width;z$N.alphaTexture=z$k.createFromTexture(z$U.alphaTexture,z$r*z$T/z$t,z$s*z$R/z$t,z$r/z$t,z$s/z$t)}this._sources.push(z$N)}z$W.saveObject(z$p,this._sources),this._weakKey=z$p,z$W.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},z$V.play=function(z$V,z$U){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=-1),this._isPlaying=!0,this.index=z$V,this._toIndex=z$U,this._index++,z$u.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},z$V._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},z$V.stop=function(){this._isPlaying=!1,z$u.timer.clear(this,this._loop),this.event("complete")},z$V._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},z$R(0,z$V,"interval",function(){return this._interval},function(z$V){this._interval!=z$V&&(this._interval=z$V,this._isPlaying&&this.play())}),z$V.clearEvent=function(){this._skin&&z$p.atalsNotify&&z$p.atalsNotify.off(this._skin,this,this._setBtnSource)},z$V.clearLoad=function(){this._skin&&((this._complete||this._progress)&&z$u.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},z$R(0,z$V,"skin",function(){return this._skin},function(z$V){if(this._skin!=z$V)if(this.clearLoad(),this.clearEvent(),z$W.clearCache(this,this._skin),this._skin=z$V){z$W.keepCache(this,this._skin);var z$U=z$W.getRes(z$V),z$r=z$p.resAtalsObj&&z$p.resAtalsObj[this._skin];!z$U&&z$r?z$p.atalsNotify&&z$p.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),z$V._setBtnSource=function(z$V,z$U){z$V===this._skin&&z$U&&(this.loadComplete(z$V,z$U),this.clearEvent())},z$R(0,z$V,"sources",function(){return this._sources},function(z$V){this._sources=z$V,this.index=this._index,this.event("loaded")}),z$R(0,z$V,"clipX",function(){return this._clipX},function(z$V){this._clipX=z$V||1,this._setClipChanged()}),z$R(0,z$V,"clipY",function(){return this._clipY},function(z$V){this._clipY=z$V||1,this._setClipChanged()}),z$R(0,z$V,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),z$R(0,z$V,"clipWidth",function(){return this._clipWidth},function(z$V){this._clipWidth=z$V,this._setClipChanged()}),z$R(0,z$V,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(z$V){this._bitmap.sizeGrid=z$H.fillArray(z$Q.defaultSizeGrid,z$V,Number)}),z$R(0,z$V,"group",function(){return this._group},function(z$V){z$V&&this._skin&&z$W.setGroup(this._skin,z$V),this._group=z$V}),z$R(0,z$V,"clipHeight",function(){return this._clipHeight},function(z$V){this._clipHeight=z$V,this._setClipChanged()}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$E,this,"width",z$V),this._bitmap.width=z$V}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$E,this,"height",z$V),this._bitmap.height=z$V}),z$R(0,z$V,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),z$R(0,z$V,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),z$R(0,z$V,"index",function(){return this._index},function(z$V){this._index=z$V,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[z$V]),this.event("change")}),z$R(0,z$V,"autoPlay",function(){return this._autoPlay},function(z$V){this._autoPlay!=z$V&&((this._autoPlay=z$V)?this.play():this.stop())}),z$R(0,z$V,"isPlaying",function(){return this._isPlaying},function(z$V){this._isPlaying=z$V}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)&&Math.floor(z$V)==z$V||"string"==typeof z$V?this.index=parseInt(z$V):z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"bitmap",function(){return this._bitmap}),z$s}(z$E),z$x=function(z$U){function z$V(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,z$V.__super.call(this)}z$c(z$V,"laya.ui.ColorPicker",z$U);var z$r=z$V.prototype;return z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._colorPanel&&this._colorPanel.destroy(z$V),this._colorButton&&this._colorButton.destroy(z$V),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},z$r.createChildren=function(){this.addChild(this._colorButton=new z$a),this._colorPanel=new z$m,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new z$L),this._colorPanel.addChild(this._colorBlock=new z$L),this._colorPanel.addChild(this._colorInput=new z$G)},z$r.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},z$r.onPanelMouseDown=function(z$V){z$V.stopPropagation()},z$r.changePanel=function(){this._panelChanged=!1;var z$V=this._colorPanel.graphics;z$V.clear(),z$V.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(z$V=this._colorTiles.graphics).clear();for(var z$U=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],z$r=0;z$r<12;z$r++)for(var z$s=0;z$s<20;z$s++){var z$p=0;z$p=0===z$s?z$U[z$r]:1===z$s?0:51*(((3*z$r+z$s/6)%3<<0)+3*(z$r/6<<0))<<16|z$s%6*51<<8|(z$r<<0)%6*51;var z$c=z$H.toColor(z$p);this._colors.push(z$c);var z$R=z$s*this._gridSize,z$T=z$r*this._gridSize;z$V.drawRect(z$R,z$T,this._gridSize,this._gridSize,z$c,"#000000")}},z$r.onColorButtonClick=function(z$V){this._colorPanel.parent?this.close():this.open()},z$r.open=function(){var z$V=this.localToGlobal(new z$q),z$U=z$V.x+this._colorPanel.width<=z$u.stage.width?z$V.x:z$u.stage.width-this._colorPanel.width,z$r=z$V.y+this._colorButton.height;z$r=z$r+this._colorPanel.height<=z$u.stage.height?z$r:z$V.y-this._colorPanel.height,this._colorPanel.pos(z$U,z$r),this._colorPanel.zOrder=1001,z$u._currentStage.addChild(this._colorPanel),z$u.stage.on("mousedown",this,this.removeColorBox)},z$r.close=function(){z$u.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},z$r.removeColorBox=function(z$V){this.close()},z$r.onColorFieldKeyDown=function(z$V){13==z$V.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),z$V.stopPropagation())},z$r.onColorInputChange=function(z$V){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},z$r.onColorTilesClick=function(z$V){this.selectedColor=this.getColorByMouse(),this.close()},z$r.onColorTilesMouseMove=function(z$V){this._colorInput.focus=!1;var z$U=this.getColorByMouse();this._colorInput.text=z$U,this.drawBlock(z$U)},z$r.getColorByMouse=function(){var z$V=this._colorTiles.getMousePoint(),z$U=Math.floor(z$V.x/this._gridSize),z$r=Math.floor(z$V.y/this._gridSize);return this._colors[20*z$r+z$U]},z$r.drawBlock=function(z$V){var z$U=this._colorBlock.graphics;z$U.clear();var z$r=z$V||"#ffffff";z$U.drawRect(0,0,50,20,z$r,this._borderColor),z$V||z$U.drawLine(0,0,50,20,"#ff0000")},z$r.changeColor=function(){var z$V=this.graphics;z$V.clear();var z$U=this._selectedColor||"#000000";z$V.drawRect(0,0,this._colorButton.width,this._colorButton.height,z$U)},z$r._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},z$R(0,z$r,"inputBgColor",function(){return this._inputBgColor},function(z$V){this._inputBgColor=z$V,this._setPanelChanged()}),z$R(0,z$r,"selectedColor",function(){return this._selectedColor},function(z$V){this._selectedColor!=z$V&&(this._selectedColor=this._colorInput.text=z$V,this.drawBlock(z$V),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",z$t.EMPTY.setTo("change",this,this)))}),z$R(0,z$r,"skin",function(){return this._colorButton.skin},function(z$V){this._colorButton.skin=z$V,this.changeColor()}),z$R(0,z$r,"bgColor",function(){return this._bgColor},function(z$V){this._bgColor=z$V,this._setPanelChanged()}),z$R(0,z$r,"borderColor",function(){return this._borderColor},function(z$V){this._borderColor=z$V,this._setPanelChanged()}),z$R(0,z$r,"inputColor",function(){return this._inputColor},function(z$V){this._inputColor=z$V,this._setPanelChanged()}),z$V}(z$E),z$$=function(z$U){function z$r(z$V,z$U){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,z$r.__super.call(this),this._itemColors=z$Q.comboBoxItemColors,this.skin=z$V,this.labels=z$U}z$c(z$r,"laya.ui.ComboBox",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._button&&this._button.destroy(z$V),this._list&&this._list.destroy(z$V),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},z$V.createChildren=function(){this.addChild(this._button=new z$a),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},z$V._createList=function(){this._list=new z$e,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},z$V._setListEvent=function(z$V){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=z$_.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},z$V.onListDown=function(z$V){z$V.stopPropagation()},z$V.onScrollBarDown=function(z$V){z$V.stopPropagation()},z$V.onButtonMouseDown=function(z$V){this.callLater(this.switchTo,[!this._isOpen])},z$V.changeList=function(){this._listChanged=!1;var z$V=this.width-2,z$U=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:z$V,height:this._itemHeight,fontSize:this._itemSize,color:z$U}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},z$V.onlistItemMouse=function(z$V,z$U){var z$r=z$V.type;if("mouseover"===z$r||"mouseout"===z$r){if(this._isCustomList)return;var z$s=this._list.getCell(z$U);if(!z$s)return;var z$p=z$s.getChildByName("label");z$p&&("mouseover"===z$r?(z$p.bgColor=this._itemColors[0],z$p.color=this._itemColors[1]):(z$p.bgColor=null,z$p.color=this._itemColors[2]))}else"click"===z$r&&(this.selectedIndex=z$U,this.isOpen=!1)},z$V.switchTo=function(z$V){this.isOpen=z$V},z$V.changeOpen=function(){this.isOpen=!this._isOpen},z$V.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var z$V=this._list.graphics;z$V.clear(),z$V.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var z$U=this._list.array||[],z$r=z$U.length=0,z$s=this._labels.length;z$r<z$s;z$r++)z$U.push({label:this._labels[z$r]});this._list.height=this._listHeight,this._list.array=z$U},z$V.changeSelected=function(){this._button.label=this.selectedLabel},z$V._onStageMouseWheel=function(z$V){this._list&&!this._list.contains(z$V.target)&&this.removeList(null)},z$V.removeList=function(z$V){z$u.stage.off("mousedown",this,this.removeList),z$u.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},z$R(0,z$V,"selectedIndex",function(){return this._selectedIndex},function(z$V){this._selectedIndex!=z$V&&(this._selectedIndex=z$V,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[z$t.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),z$R(0,z$V,"measureHeight",function(){return this._button.height}),z$R(0,z$V,"skin",function(){return this._button.skin},function(z$V){this._button.skin!=z$V&&(this._button.skin=z$V,this._listChanged=!0)}),z$R(0,z$V,"measureWidth",function(){return this._button.width}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$E,this,"width",z$V),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),z$R(0,z$V,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(z$V){this.selectedIndex=this._labels.indexOf(z$V)}),z$R(0,z$V,"labels",function(){return this._labels.join(",")},function(z$V){0<this._labels.length&&(this.selectedIndex=-1),z$V?this._labels=z$V.split(","):this._labels.length=0,this._itemChanged=!0}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$E,this,"height",z$V),this._button.height=this._height}),z$R(0,z$V,"selectHandler",function(){return this._selectHandler},function(z$V){this._selectHandler=z$V}),z$R(0,z$V,"visibleNum",function(){return this._visibleNum},function(z$V){this._visibleNum=z$V,this._listChanged=!0}),z$R(0,z$V,"labelBold",function(){return this._button.text.bold},function(z$V){this._button.text.bold=z$V}),z$R(0,z$V,"itemColors",function(){return String(this._itemColors)},function(z$V){this._itemColors=z$H.fillArray(this._itemColors,z$V,String),this._listChanged=!0}),z$R(0,z$V,"itemSize",function(){return this._itemSize},function(z$V){this._itemSize=z$V,this._listChanged=!0}),z$R(0,z$V,"scrollBar",function(){return this.list.scrollBar}),z$R(0,z$V,"isOpen",function(){return this._isOpen},function(z$V){if(this._isOpen!=z$V)if(this._isOpen=z$V,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var z$U=this.localToGlobal(z$q.TEMP.setTo(0,0)),z$r=z$U.y+this._button.height;z$r=z$r+this._listHeight<=z$u.stage.height?z$r:z$U.y-this._listHeight,this._list.pos(z$U.x,z$r),this._list.zOrder=1001,z$u._currentStage.addChild(this._list),z$u.stage.once("mousedown",this,this.removeList),z$u.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),z$R(0,z$V,"scrollBarSkin",function(){return this._scrollBarSkin},function(z$V){this._scrollBarSkin=z$V}),z$R(0,z$V,"sizeGrid",function(){return this._button.sizeGrid},function(z$V){this._button.sizeGrid=z$V}),z$R(0,z$V,"button",function(){return this._button}),z$R(0,z$V,"list",function(){return this._list||this._createList(),this._list},function(z$V){z$V&&(z$V.removeSelf(),this._isCustomList=!0,this._list=z$V,this._setListEvent(z$V),this._itemHeight=z$V.getCell(0).height+z$V.spaceY)}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)&&Math.floor(z$V)==z$V||"string"==typeof z$V?this.selectedIndex=parseInt(z$V):z$V instanceof Array?this.labels=z$V.join(","):z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"labelColors",function(){return this._button.labelColors},function(z$V){this._button.labelColors!=z$V&&(this._button.labelColors=z$V)}),z$R(0,z$V,"labelPadding",function(){return this._button.text.padding.join(",")},function(z$V){this._button.text.padding=z$H.fillArray(z$Q.labelPadding,z$V,Number)}),z$R(0,z$V,"labelSize",function(){return this._button.text.fontSize},function(z$V){this._button.text.fontSize=z$V}),z$R(0,z$V,"labelFont",function(){return this._button.text.font},function(z$V){this._button.text.font=z$V}),z$R(0,z$V,"stateNum",function(){return this._button.stateNum},function(z$V){this._button.stateNum=z$V}),z$r}(z$E),z$j=function(z$U){function z$r(z$V){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,z$r.__super.call(this),this._showButtons=z$w.showButtons,this._touchScrollEnable=z$w.touchScrollEnable,this._mouseWheelEnable=z$w.mouseWheelEnable,this.skin=z$V,this.max=1}z$c(z$r,"laya.ui.ScrollBar",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),this.stopScroll(),this.target=null,z$U.prototype.destroy.call(this,z$V),this.upButton&&this.upButton.destroy(z$V),this.downButton&&this.downButton.destroy(z$V),this.slider&&this.slider.destroy(z$V),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},z$V.createChildren=function(){this.addChild(this.slider=new z$o),this.addChild(this.upButton=new z$a),this.addChild(this.downButton=new z$a)},z$V.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},z$V.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},z$V.onButtonMouseDown=function(z$V){var z$U=z$V.currentTarget===this.upButton;this.slide(z$U),z$u.timer.once(z$Q.scrollBarDelayTime,this,this.startLoop,[z$U]),z$u.stage.once("mouseup",this,this.onStageMouseUp)},z$V.startLoop=function(z$V){z$u.timer.frameLoop(1,this,this.slide,[z$V])},z$V.slide=function(z$V){z$V?this.value-=this._scrollSize:this.value+=this._scrollSize},z$V.onStageMouseUp=function(z$V){z$u.timer.clear(this,this.startLoop),z$u.timer.clear(this,this.slide)},z$V.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},z$V.changeSize=function(){z$U.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},z$V.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},z$V.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},z$V.setScroll=function(z$V,z$U,z$r){this.runCallLater(this.changeSize),this.slider.setSlider(z$V,z$U,z$r),this.slider.bar.visible=0<z$U,!this._hide&&this.autoHide&&(this.visible=!1)},z$V.onTargetMouseWheel=function(z$V){this.value-=z$V.delta*this._scrollSize,this.target=this._target},z$V.onTargetMouseDown=function(z$V){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new z$q),this._lastPoint.setTo(z$u.stage.mouseX,z$u.stage.mouseY),z$u.timer.clear(this,this.tweenMove),z$y.clearTween(this),z$u.stage.once("mouseup",this,this.onStageMouseUp2),z$u.stage.once("mouseout",this,this.onStageMouseUp2),z$u.timer.frameLoop(1,this,this.loop)},z$V.loop=function(){var z$V=z$u.stage.mouseY,z$U=z$u.stage.mouseX;if(this._lastOffset=this.isVertical?z$V-this._lastPoint.y:z$U-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?z$u.stage._canvasTransform.getScaleY():z$u.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=z$U,this._lastPoint.y=z$V,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},z$V.onStageMouseUp2=function(z$V){if(z$u.stage.off("mouseup",this,this.onStageMouseUp2),z$u.stage.off("mouseout",this,this.onStageMouseUp2),z$u.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?z$y.to(this,{value:this.min},this.elasticBackTime,z$N.sineOut,z$_.create(this,this.elasticOver)):this._value>this.max&&z$y.to(this,{value:this.max},this.elasticBackTime,z$N.sineOut,z$_.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?z$u.stage.mouseY-this._lastPoint.y:z$u.stage.mouseX-this._lastPoint.x);for(var z$U=0,z$r=Math.min(this._offsets.length,3),z$s=0;z$s<z$r;z$s++)z$U+=this._offsets[this._offsets.length-1-z$s];if(this._lastOffset=z$U/z$r,(z$U=Math.abs(this._lastOffset))<2)return void this.event("end");60<z$U&&(this._lastOffset=0<this._lastOffset?60:-60);var z$p=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));z$u.timer.frameLoop(1,this,this.tweenMove,[z$p])}},z$V.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&z$y.to(this,{alpha:0},500),this.event("end")},z$V.tweenMove=function(z$V){this._lastOffset*=this.rollRatio;var z$U=NaN;if(0<z$V&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,z$U=.5*-(this.min-z$V-this.value),this._lastOffset>z$U&&(this._lastOffset=z$U)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,z$U=.5*-(this.max+z$V-this.value),this._lastOffset<z$U&&(this._lastOffset=z$U))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(z$u.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?z$y.to(this,{value:this.min},this.elasticBackTime,z$N.sineOut,z$_.create(this,this.elasticOver)):this._value>this.max?z$y.to(this,{value:this.max},this.elasticBackTime,z$N.sineOut,z$_.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&z$y.to(this,{alpha:0},500)}},z$V.stopScroll=function(){this.onStageMouseUp2(null),z$u.timer.clear(this,this.tweenMove),z$y.clearTween(this)},z$R(0,z$V,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){this._skin!=z$V&&(this._skin=z$V,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),z$R(0,z$V,"max",function(){return this.slider.max},function(z$V){this.slider.max=z$V}),z$R(0,z$V,"showButtons",function(){return this._showButtons},function(z$V){this._showButtons=z$V,this.callLater(this.changeScrollBar)}),z$R(0,z$V,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),z$R(0,z$V,"min",function(){return this.slider.min},function(z$V){this.slider.min=z$V}),z$R(0,z$V,"value",function(){return this._value},function(z$V){z$V!==this._value&&(this._value=z$V,this._isElastic||(this.slider._value!=z$V&&(this.slider._value=z$V,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),z$R(0,z$V,"isVertical",function(){return this.slider.isVertical},function(z$V){this.slider.isVertical=z$V}),z$R(0,z$V,"sizeGrid",function(){return this.slider.sizeGrid},function(z$V){this.slider.sizeGrid=z$V}),z$R(0,z$V,"scrollSize",function(){return this._scrollSize},function(z$V){this._scrollSize=z$V}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)||"string"==typeof z$V?this.value=Number(z$V):z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"thumbPercent",function(){return this._thumbPercent},function(z$V){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),z$V=1<=z$V?.99:z$V,this._thumbPercent=z$V,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*z$V,z$Q.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*z$V,z$Q.scrollBarMinNum))}),z$R(0,z$V,"target",function(){return this._target},function(z$V){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=z$V)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),z$R(0,z$V,"hide",function(){return this._hide},function(z$V){this._hide=z$V,this.visible=!z$V}),z$R(0,z$V,"touchScrollEnable",function(){return this._touchScrollEnable},function(z$V){this._touchScrollEnable=z$V,this.target=this._target}),z$R(0,z$V,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(z$V){this._mouseWheelEnable=z$V,this.target=this._target}),z$R(0,z$V,"tick",function(){return this.slider.tick},function(z$V){this.slider.tick=z$V}),z$r}(z$E),z$o=function(z$U){function z$r(z$V){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,z$r.__super.call(this),this.skin=z$V}z$c(z$r,"laya.ui.Slider",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._bg&&this._bg.destroy(z$V),this._bar&&this._bar.destroy(z$V),this._progress&&this._progress.destroy(z$V),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},z$V.createChildren=function(){this.addChild(this._bg=new z$J),this.addChild(this._bar=new z$a)},z$V.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},z$V.onBarMouseDown=function(z$V){this._globalSacle||(this._globalSacle=new z$q),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=z$u.stage.mouseX,this._ty=z$u.stage.mouseY,z$u.stage.on("mousemove",this,this.mouseMove),z$u.stage.once("mouseup",this,this.mouseUp),z$u.stage.once("mouseout",this,this.mouseUp),this.showValueText()},z$V.showValueText=function(){if(this.showLabel){var z$V=laya.ui.Slider.label;this.addChild(z$V),z$V.textField.changeText(this._value+""),this.isVertical?(z$V.x=this._bar.x+20,z$V.y=.5*(this._bar.height-z$V.height)+this._bar.y):(z$V.y=this._bar.y-20,z$V.x=.5*(this._bar.width-z$V.width)+this._bar.x)}},z$V.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},z$V.mouseUp=function(z$V){z$u.stage.off("mousemove",this,this.mouseMove),z$u.stage.off("mouseup",this,this.mouseUp),z$u.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},z$V.mouseMove=function(z$V){var z$U=this._value;this.isVertical?(this._bar.y+=(z$u.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(z$u.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=z$u.stage.mouseX,this._ty=z$u.stage.mouseY;var z$r=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*z$r)/z$r,this._value!=z$U&&this.sendChangeEvent(),this.showValueText()},z$V.sendChangeEvent=function(z$V){void 0===z$V&&(z$V="change"),this.event(z$V),this.changeHandler&&this.changeHandler.runWith(this._value)},z$V.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},z$V.changeSize=function(){z$U.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},z$V.setSlider=function(z$V,z$U,z$r){this._value=-1,this._min=z$V,this._max=z$V<z$U?z$U:z$V,this.value=z$r<z$V?z$V:z$U<z$r?z$U:z$r},z$V.changeValue=function(){var z$V=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*z$V)/z$V,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var z$U=this._max-this._min;0===z$U&&(z$U=1),this.isVertical?(this._bar.y=(this._value-this._min)/z$U*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/z$U*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},z$V.onBgMouseDown=function(z$V){var z$U=this._bg.getMousePoint();this.isVertical?this.value=z$U.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=z$U.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},z$R(0,z$V,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){if(this._skin!=z$V){this._skin=z$V,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var z$U=this._skin.replace(".png","$progress.png");z$W.getRes(z$U)&&(this._progress||(this.addChild(this._progress=new z$J),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=z$U),this.setBarPoint(),this.callLater(this.changeValue)}}),z$R(0,z$V,"allowClickBack",function(){return this._allowClickBack},function(z$V){this._allowClickBack!=z$V&&((this._allowClickBack=z$V)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),z$R(0,z$V,"max",function(){return this._max},function(z$V){this._max!=z$V&&(this._max=z$V,this.callLater(this.changeValue))}),z$R(0,z$V,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),z$R(0,z$V,"tick",function(){return this._tick},function(z$V){this._tick!=z$V&&(this._tick=z$V,this.callLater(this.changeValue))}),z$R(0,z$V,"sizeGrid",function(){return this._bg.sizeGrid},function(z$V){this._bg.sizeGrid=z$V,this._bar.sizeGrid=z$V,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),z$R(0,z$V,"min",function(){return this._min},function(z$V){this._min!=z$V&&(this._min=z$V,this.callLater(this.changeValue))}),z$R(0,z$V,"value",function(){return this._value},function(z$V){if(this._value!=z$V){var z$U=this._value;this._value=z$V,this.changeValue(),this._value!=z$U&&this.sendChangeEvent()}}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)||"string"==typeof z$V?this.value=Number(z$V):z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"bar",function(){return this._bar}),z$s(z$r,["label",function(){return this.label=new z$i}]),z$r}(z$E),z$J=function(z$U){function z$r(z$V){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,z$r.__super.call(this),this.skin=z$V}z$c(z$r,"laya.ui.Image",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,z$W.clearCache(this,this._skin)},z$V.dispose=function(){this.destroy(!0),z$W.clearCache(this,this._skin),this.clearEvent()},z$V.createChildren=function(){this.graphics=this._bitmap=new z$z},z$V.setSource=function(z$V,z$U){z$V===this._skin&&z$U&&(this.source=z$U,this.onCompResize(),this.clearEvent())},z$V.clearEvent=function(){this._skin&&z$p.atalsNotify&&z$p.atalsNotify.off(this._skin,this,this.setSource)},z$V.clearLoad=function(){this._skin&&((this._complete||this._progress)&&z$u.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},z$R(0,z$V,"source",function(){return this._bitmap.source},function(z$V){this._bitmap&&(this._bitmap.source=z$V,this.event("loaded"),this.repaint())}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"string"==typeof(this._dataSource=z$V)?this.skin=z$V:z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"measureHeight",function(){return this._bitmap.height}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){if(this._skin!=z$V)if(z$W.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=z$V){z$W.keepCache(this,this._skin);var z$U=z$W.getRes(z$V),z$r=z$p.resAtalsObj&&z$p.resAtalsObj[this._skin];z$U?(this.source=z$U,this.onCompResize()):z$r?(z$p.atalsNotify&&z$p.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=z$r.sourceW),0==this.height&&(this.height=z$r.sourceH)):(this._complete=z$_.create(this,this.setSource,[this._skin]),this._progress=null,z$u.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),z$R(0,z$V,"group",function(){return this._group},function(z$V){z$V&&this._skin&&z$W.setGroup(this._skin,z$V),this._group=z$V}),z$R(0,z$V,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(z$V){this._bitmap.sizeGrid=z$H.fillArray(z$Q.defaultSizeGrid,z$V,Number)}),z$R(0,z$V,"measureWidth",function(){return this._bitmap.width}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$E,this,"width",z$V),this._bitmap.width=0==z$V?1e-7:z$V}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$E,this,"height",z$V),this._bitmap.height=0==z$V?1e-7:z$V}),z$r}(z$E),z$i=function(z$U){function z$r(z$V){this._tf=null,z$r.__super.call(this),void 0===z$V&&(z$V=""),z$b.defaultColor=z$Q.labelColor,this.text=z$V}z$c(z$r,"laya.ui.Label",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._tf=null},z$V.createChildren=function(){this.addChild(this._tf=new z$d)},z$V.changeText=function(z$V){this._tf.changeText(z$V)},z$R(0,z$V,"padding",function(){return this._tf.padding.join(",")},function(z$V){this._tf.padding=z$H.fillArray(z$Q.labelPadding,z$V,Number)}),z$R(0,z$V,"bold",function(){return this._tf.bold},function(z$V){this._tf.bold=z$V}),z$R(0,z$V,"align",function(){return this._tf.align},function(z$V){this._tf.align=z$V}),z$R(0,z$V,"text",function(){return this._tf.text},function(z$V){this._tf.text!=z$V&&(z$V&&(z$V=z$H.adptString(z$V+"")),this._tf.text=z$V,this.event("change"),this._width&&this._height||this.onCompResize())}),z$R(0,z$V,"italic",function(){return this._tf.italic},function(z$V){this._tf.italic=z$V}),z$R(0,z$V,"wordWrap",function(){return this._tf.wordWrap},function(z$V){this._tf.wordWrap=z$V}),z$R(0,z$V,"font",function(){return this._tf.font},function(z$V){this._tf.font=z$V}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)||"string"==typeof z$V?this.text=z$V+"":z$u.superSet(z$E,this,"dataSource",z$V)}),z$R(0,z$V,"color",function(){return this._tf.color},function(z$V){this._tf.color=z$V}),z$R(0,z$V,"valign",function(){return this._tf.valign},function(z$V){this._tf.valign=z$V}),z$R(0,z$V,"leading",function(){return this._tf.leading},function(z$V){this._tf.leading=z$V}),z$R(0,z$V,"fontSize",function(){return this._tf.fontSize},function(z$V){this._tf.fontSize=z$V}),z$R(0,z$V,"bgColor",function(){return this._tf.bgColor},function(z$V){this._tf.bgColor=z$V}),z$R(0,z$V,"borderColor",function(){return this._tf.borderColor},function(z$V){this._tf.borderColor=z$V}),z$R(0,z$V,"stroke",function(){return this._tf.stroke},function(z$V){this._tf.stroke=z$V}),z$R(0,z$V,"strokeColor",function(){return this._tf.strokeColor},function(z$V){this._tf.strokeColor=z$V}),z$R(0,z$V,"textField",function(){return this._tf}),z$R(0,z$V,"measureWidth",function(){return this._tf.width}),z$R(0,z$V,"measureHeight",function(){return this._tf.height}),z$R(0,z$V,"width",function(){return this._width||this._tf.text?z$u.superGet(z$E,this,"width"):0},function(z$V){z$u.superSet(z$E,this,"width",z$V),this._tf.width=z$V}),z$R(0,z$V,"height",function(){return this._height||this._tf.text?z$u.superGet(z$E,this,"height"):0},function(z$V){z$u.superSet(z$E,this,"height",z$V),this._tf.height=z$V}),z$R(0,z$V,"overflow",function(){return this._tf.overflow},function(z$V){this._tf.overflow=z$V}),z$R(0,z$V,"underline",function(){return this._tf.underline},function(z$V){this._tf.underline=z$V}),z$R(0,z$V,"underlineColor",function(){return this._tf.underlineColor},function(z$V){this._tf.underlineColor=z$V}),z$r}(z$E),z$B=function(z$U){function z$r(z$V){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,z$r.__super.call(this),this.skin=z$V}z$c(z$r,"laya.ui.ProgressBar",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._bg&&this._bg.destroy(z$V),this._bar&&this._bar.destroy(z$V),this._bg=this._bar=null,this.changeHandler=null},z$V.createChildren=function(){this.addChild(this._bg=new z$J),this.addChild(this._bar=new z$J)},z$V.changeValue=function(){if(this.sizeGrid){var z$V=this.sizeGrid.split(","),z$U=Number(z$V[3]),z$r=Number(z$V[1]),z$s=(this.width-z$U-z$r)*this._value;this._bar.width=z$U+z$r+z$s,this._bar.visible=this._bar.width>z$U+z$r}else this._bar.width=this.width*this._value},z$R(0,z$V,"measureHeight",function(){return this._bg.height}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){this._skin!=z$V&&(this._skin=z$V,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),z$R(0,z$V,"measureWidth",function(){return this._bg.width}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$E,this,"height",z$V),this._bg.height=this._height,this._bar.height=this._height}),z$R(0,z$V,"bar",function(){return this._bar}),z$R(0,z$V,"value",function(){return this._value},function(z$V){this._value!=z$V&&(z$V=1<z$V?1:z$V<0?0:z$V,this._value=z$V,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(z$V))}),z$R(0,z$V,"bg",function(){return this._bg}),z$R(0,z$V,"sizeGrid",function(){return this._bg.sizeGrid},function(z$V){this._bg.sizeGrid=this._bar.sizeGrid=z$V}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$E,this,"width",z$V),this._bg.width=this._width,this.callLater(this.changeValue)}),z$R(0,z$V,"dataSource",z$U.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)||"string"==typeof z$V?this.value=Number(z$V):z$u.superSet(z$E,this,"dataSource",z$V)}),z$r}(z$E),z$P=(function(z$V){function z$r(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,z$r.__super.call(this),this._tipBox=new z$E,this._tipBox.addChild(this._tipText=new z$d),this._tipText.x=this._tipText.y=5,this._tipText.color=z$r.tipTextColor,this._defaultTipHandler=this._showDefaultTip,z$u.stage.on("showtip",this,this._onStageShowTip),z$u.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}z$c(z$r,"laya.ui.TipManager",z$E);var z$U=z$r.prototype;z$U._onStageHideTip=function(z$V){z$u.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},z$U._onStageShowTip=function(z$V){z$u.timer.once(z$r.tipDelay,this,this._showTip,[z$V],!0)},z$U._showTip=function(z$V){if("string"==typeof z$V){var z$U=String(z$V);Boolean(z$U)&&this._defaultTipHandler(z$U)}else z$V instanceof laya.utils.Handler?z$V.run():"function"==typeof z$V&&z$V.apply();z$u.stage.on("mousemove",this,this._onStageMouseMove),z$u.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},z$U._onStageMouseDown=function(z$V){this.closeAll()},z$U._onStageMouseMove=function(z$V){this._showToStage(this,z$r.offsetX,z$r.offsetY)},z$U._showToStage=function(z$V,z$U,z$r){void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0);var z$s=z$V.getBounds();z$V.x=z$u.stage.mouseX+z$U,z$V.y=z$u.stage.mouseY+z$r,z$V.x+z$s.width>z$u.stage.width&&(z$V.x-=z$s.width+z$U),z$V.y+z$s.height>z$u.stage.height&&(z$V.y-=z$s.height+z$r)},z$U.closeAll=function(){z$u.timer.clear(this,this._showTip),z$u.stage.off("mousemove",this,this._onStageMouseMove),z$u.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},z$U.showDislayTip=function(z$V){this.addChild(z$V),this._showToStage(this),z$u._currentStage.addChild(this)},z$U._showDefaultTip=function(z$V){this._tipText.text=z$V;var z$U=this._tipBox.graphics;z$U.clear(),z$U.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,z$r.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),z$u._currentStage.addChild(this)},z$R(0,z$U,"defaultTipHandler",function(){return this._defaultTipHandler},function(z$V){this._defaultTipHandler=z$V}),z$r.offsetX=10,z$r.offsetY=15,z$r.tipTextColor="#ffffff",z$r.tipBackColor="#111111",z$r.tipDelay=200}(),function(z$V){var z$G;function z$q(){this._idMap=null,this._aniList=null,this._watchMap={},z$q.__super.call(this)}z$c(z$q,"laya.ui.View",z$m);var z$U=z$q.prototype;return z$U.createView=function(z$V){if(z$V.animations&&!this._idMap&&(this._idMap={}),z$q.createComp(z$V,this,this),z$V.animations){var z$U,z$r,z$s=[],z$p=z$V.animations,z$c=0,z$R=z$p.length;for(z$c=0;z$c<z$R;z$c++){switch(z$U=new z$S,z$r=z$p[z$c],z$U._setUp(this._idMap,z$r),(this[z$r.name]=z$U)._setControlNode(this),z$r.action){case 1:z$U.play(0,!1);break;case 2:z$U.play(0,!0)}z$s.push(z$U)}this._aniList=z$s}0<this._width&&null==z$V.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},z$U.onEvent=function(z$V,z$U){},z$U.loadUI=function(z$V){var z$U=z$q.uiMap[z$V];z$U&&this.createView(z$U)},z$U.destroy=function(z$V){void 0===z$V&&(z$V=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,z$V)},z$U.changeData=function(z$V){var z$U=this._watchMap[z$V];if(z$U){console.log("change",z$V);for(var z$r=0,z$s=z$U.length;z$r<z$s;z$r++){z$U[z$r].exe(this)}}},z$q._regs=function(){for(var z$V in z$q.uiClassMap)z$h.regClass(z$V,z$q.uiClassMap[z$V])},z$q.createComp=function(z$V,z$U,z$r,z$s){if(!(z$U=z$U||z$q.getCompInstance(z$V)))return console.warn("can not create:"+z$V.type),null;var z$p=z$V.child;if(z$p)for(var z$c=z$U instanceof laya.ui.List,z$R=0,z$T=z$p.length;z$R<z$T;z$R++){var z$N=z$p[z$R];if(!z$U.hasOwnProperty("itemRender")||"render"!=z$N.props.name&&"render"!==z$N.props.renderType)if("Graphic"==z$N.type)z$h.addGraphicsToSprite(z$N,z$U);else if(z$h.isDrawType(z$N.type))z$h.addGraphicToSprite(z$N,z$U,!0);else{if(z$c){var z$t=[],z$b=z$q.createComp(z$N,null,z$r,z$t);z$t.length&&(z$b._$bindData=z$t)}else z$b=z$q.createComp(z$N,null,z$r,z$s);"Script"==z$N.type?"owner"in z$b?z$b.owner=z$U:"target"in z$b&&(z$b.target=z$U):"mask"==z$N.props.renderType||"mask"==z$N.props.name?z$U.mask=z$b:z$b instanceof laya.display.Sprite&&z$U.addChild(z$b)}else z$U.itemRender=z$N}var z$S=z$V.props;for(var z$_ in z$S){var z$G=z$S[z$_];z$q.eventDic[z$_]?z$G&&z$r&&z$U.on(z$_,z$r,z$r.onEvent,[z$G]):z$q.setCompValue(z$U,z$_,z$G,z$r,z$s)}return z$u.__typeof(z$U,"laya.ui.IItem")&&z$U.initItems(),z$V.compId&&z$r&&z$r._idMap&&(z$r._idMap[z$V.compId]=z$U),z$U},z$q.setCompValue=function(z$V,z$U,z$r,z$s,z$p){if("string"==typeof z$r&&-1<z$r.indexOf("${")){if(z$q._sheet||(z$q._sheet=z$h.getClass("laya.data.Table")),!z$q._sheet)return void console.warn("Can not find class Sheet");if(z$p)z$p.push(z$V,z$U,z$r);else if(z$s){-1==z$r.indexOf("].")&&(z$r=z$r.replace(".","[0]."));var z$c,z$R,z$T=new z$G(z$V,z$U,z$r);z$T.exe(z$s);for(var z$N=z$r.replace(/\[.*?\]\./g,".");null!=(z$c=z$q._parseWatchData.exec(z$N));){for(var z$t=z$c[1];null!=(z$R=z$q._parseKeyWord.exec(z$t));){var z$b=z$R[0],z$S=z$s._watchMap[z$b]||(z$s._watchMap[z$b]=[]);z$S.push(z$T),z$q._sheet.I.notifer.on(z$b,z$s,z$s.changeData,[z$b])}(z$S=z$s._watchMap[z$t]||(z$s._watchMap[z$t]=[])).push(z$T),z$q._sheet.I.notifer.on(z$t,z$s,z$s.changeData,[z$t])}}}else if("var"===z$U&&z$s)z$s[z$r]=z$V;else if("onClick"==z$U){var z$_=z$u._runScript("(function(){"+z$r+"})");z$V.on("click",z$s,z$_)}else z$V[z$U]="true"===z$r||"false"!==z$r&&z$r},z$q.getCompInstance=function(z$V){var z$U,z$r=z$V.props?z$V.props.runtime:null;return z$U=z$r?z$q.viewClassMap[z$r]||z$q.uiClassMap[z$r]||z$u.__classmap[z$r]:z$q.uiClassMap[z$V.type],z$V.props&&z$V.props.hasOwnProperty("renderType")&&"instance"==z$V.props.renderType?z$U.instance:z$U?new z$U:null},z$q.regComponent=function(z$V,z$U){z$q.uiClassMap[z$V]=z$U,z$h.regClass(z$V,z$U)},z$q.regViewRuntime=function(z$V,z$U){z$q.viewClassMap[z$V]=z$U},z$q.uiMap={},z$q.viewClassMap={},z$q._sheet=null,z$s(z$q,["uiClassMap",function(){return this.uiClassMap={ViewStack:z$VV,LinkButton:z$a,TextArea:z$tV,ColorPicker:z$x,Box:z$m,Button:z$a,CheckBox:z$M,Clip:z$Z,ComboBox:z$$,Component:z$E,HScrollBar:z$F,HSlider:z$v,Image:z$J,Label:z$i,List:z$e,Panel:z$g,ProgressBar:z$B,Radio:z$C,RadioGroup:z$TV,ScrollBar:z$j,Slider:z$o,Tab:z$NV,TextInput:z$rV,View:z$q,VScrollBar:z$UV,VSlider:z$sV,Tree:z$f,HBox:z$cV,VBox:z$RV,Sprite:z$L,Animation:z$r,Text:z$d,FontClip:z$X}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),z$q.__init$=function(){z$q._regs(),z$G=function(){function z$V(z$V,z$U,z$r){this.comp=null,this.prop=null,this.value=null,this.comp=z$V,this.prop=z$U,this.value=z$r}return z$c(z$V,""),z$V.prototype.exe=function(z$V){var z$U=z$H.getBindFun(this.value);this.comp[this.prop]=z$U.call(this,z$V)},z$V}()},z$q}()),z$M=function(z$V){function z$r(z$V,z$U){void 0===z$U&&(z$U=""),z$r.__super.call(this,z$V,z$U)}z$c(z$r,"laya.ui.CheckBox",z$V);var z$U=z$r.prototype;return z$U.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},z$U.initialize=function(){z$V.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},z$R(0,z$U,"dataSource",z$V.prototype._$get_dataSource,function(z$V){"boolean"==typeof(this._dataSource=z$V)?this.selected=z$V:"string"==typeof z$V?this.selected="true"===z$V:z$u.superSet(z$a,this,"dataSource",z$V)}),z$r}(z$a),z$A=function(z$V){function z$U(){this._space=0,this._align="none",this._itemChanged=!1,z$U.__super.call(this)}z$c(z$U,"laya.ui.LayoutBox",z$m);var z$r=z$U.prototype;return z$r.addChild=function(z$V){return z$V.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,z$V)},z$r.onResize=function(z$V){this._setItemChanged()},z$r.addChildAt=function(z$V,z$U){return z$V.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,z$V,z$U)},z$r.removeChild=function(z$V){return z$V.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,z$V)},z$r.removeChildAt=function(z$V){return this.getChildAt(z$V).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,z$V)},z$r.refresh=function(){this._setItemChanged()},z$r.changeItems=function(){this._itemChanged=!1},z$r.sortItem=function(z$V){z$V&&z$V.sort(function(z$V,z$U){return z$V.y-z$U.y})},z$r._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},z$R(0,z$r,"space",function(){return this._space},function(z$V){this._space=z$V,this._setItemChanged()}),z$R(0,z$r,"align",function(){return this._align},function(z$V){this._align=z$V,this._setItemChanged()}),z$U}(),z$X=function(z$U){function z$r(z$V,z$U){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,z$r.__super.call(this),z$V&&(this.skin=z$V),z$U&&(this.sheet=z$U)}z$c(z$r,"laya.ui.FontClip",z$U);var z$V=z$r.prototype;return z$V.createChildren=function(){this._bitmap=new z$z,this.on("loaded",this,this._onClipLoaded)},z$V._onClipLoaded=function(){this.callLater(this.changeValue)},z$V.changeValue=function(){var z$V;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),z$V=this._sources[0]))){var z$U="horizontal"===this._direction;z$U?(this._wordsW=this._valueArr.length*(z$V.sourceWidth+this.spaceX),this._wordsH=z$V.sourceHeight):(this._wordsW=z$V.sourceWidth,this._wordsH=(z$V.sourceHeight+this.spaceY)*this._valueArr.length);var z$r=0;if(this._width)switch(this._align){case"center":z$r=.5*(this._width-this._wordsW);break;case"right":z$r=this._width-this._wordsW;break;default:z$r=0}for(var z$s=0,z$p=this._valueArr.length;z$s<z$p;z$s++){var z$c=this._indexMap[this._valueArr.charAt(z$s)];this.sources[z$c]&&(z$V=this.sources[z$c],z$U?this.graphics.drawTexture(z$V,z$r+z$s*(z$V.sourceWidth+this.spaceX),0,z$V.sourceWidth,z$V.sourceHeight):this.graphics.drawTexture(z$V,0+z$r,z$s*(z$V.sourceHeight+this.spaceY),z$V.sourceWidth,z$V.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),z$U.prototype.destroy.call(this,z$V)},z$R(0,z$V,"sheet",function(){return this._sheet},function(z$V){z$V+="";var z$U=(this._sheet=z$V).split(" ");this._clipX=String(z$U[0]).length,this.clipY=z$U.length,this._indexMap={};for(var z$r=0;z$r<this._clipY;z$r++)for(var z$s=z$U[z$r].split(""),z$p=0,z$c=z$s.length;z$p<z$c;z$p++)this._indexMap[z$s[z$p]]=z$r*this._clipX+z$p}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$Z,this,"height",z$V),this.callLater(this.changeValue)}),z$R(0,z$V,"direction",function(){return this._direction},function(z$V){this._direction=z$V,this.callLater(this.changeValue)}),z$R(0,z$V,"value",function(){return this._valueArr?this._valueArr:""},function(z$V){z$V+="",this._valueArr=z$V,this.callLater(this.changeValue)}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$Z,this,"width",z$V),this.callLater(this.changeValue)}),z$R(0,z$V,"spaceX",function(){return this._spaceX},function(z$V){this._spaceX=z$V,"horizontal"===this._direction&&this.callLater(this.changeValue)}),z$R(0,z$V,"spaceY",function(){return this._spaceY},function(z$V){this._spaceY=z$V,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),z$R(0,z$V,"align",function(){return this._align},function(z$V){this._align=z$V,this.callLater(this.changeValue)}),z$R(0,z$V,"measureWidth",function(){return this._wordsW}),z$R(0,z$V,"measureHeight",function(){return this._wordsH}),z$r}(z$Z),z$e=function(z$V){function z$U(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new z$q,z$U.__super.call(this)}z$c(z$U,"laya.ui.List",z$V);var z$r=z$U.prototype;return z$u.imps(z$r,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),this._content&&this._content.destroy(z$V),this._scrollBar&&this._scrollBar.destroy(z$V),laya.ui.Component.prototype.destroy.call(this,z$V),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},z$r.createChildren=function(){this.addChild(this._content=new z$m)},z$r.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=z$u.superGet(z$m,this,"cacheAs")),z$u.superSet(z$m,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},z$r.onScrollEnd=function(){z$u.superSet(z$m,this,"cacheAs",this._$P.cacheAs)},z$r._removePreScrollBar=function(){var z$V=this.removeChildByName("scrollBar");z$V&&z$V.destroy(!0)},z$r.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var z$V=this._getOneCell(),z$U=z$V.width+this._spaceX||1,z$r=z$V.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/z$U):Math.ceil(this._width/z$U)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/z$r):Math.round(this._height/z$r));var z$s=this._width?this._width:z$U*this.repeatX-this._spaceX,z$p=this._height?this._height:z$r*this.repeatY-this._spaceY;this._cellSize=this._isVertical?z$r:z$U,this._cellOffset=this._isVertical?z$r*Math.max(this._repeatY2,this._repeatY)-z$p-this._spaceY:z$U*Math.max(this._repeatX2,this._repeatX)-z$s-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=z$p:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=z$s),this.setContentSize(z$s,z$p);var z$c=this._isVertical?this.repeatX:this.repeatY,z$R=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,z$c,z$R),this._createdLine=z$R,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},z$r._getOneCell=function(){if(0===this._cells.length){var z$V=this.createItem();if(this._offset.setTo(z$V.x,z$V.y),this.cacheContent)return z$V;this._cells.push(z$V)}return this._cells[0]},z$r._createItems=function(z$V,z$U,z$r){var z$s=this._content,z$p=this._getOneCell(),z$c=z$p.width+this._spaceX,z$R=z$p.height+this._spaceY;if(this.cacheContent){var z$T=new z$m;z$T.cacheAsBitmap=!0,z$T.pos((this._isVertical?0:z$V)*z$c,(this._isVertical?z$V:0)*z$R),this._content.addChild(z$T),this._content.optimizeScrollRect=!0,z$s=z$T}else{for(var z$N=[],z$t=this._cells.length-1;-1<z$t;z$t--){var z$b=this._cells[z$t];z$b.removeSelf(),z$N.push(z$b)}this._cells.length=0}for(var z$S=z$V;z$S<z$r;z$S++)for(var z$_=0;z$_<z$U;z$_++)(z$p=z$N&&z$N.length?z$N.pop():this.createItem()).x=(this._isVertical?z$_:z$S)*z$c-z$s.x,z$p.y=(this._isVertical?z$S:z$_)*z$R-z$s.y,z$p.name="item"+(z$S*z$U+z$_),z$s.addChild(z$p),this.addCell(z$p)},z$r.createItem=function(){var z$V=[];if("function"==typeof this._itemRender)var z$U=new this._itemRender;else z$U=z$P.createComp(this._itemRender,null,null,z$V);if(0==z$V.length&&z$U._watchMap){var z$r=z$U._watchMap;for(var z$s in z$r)for(var z$p=z$r[z$s],z$c=0;z$c<z$p.length;z$c++){var z$R=z$p[z$c];z$V.push(z$R.comp,z$R.prop,z$R.value)}}return z$V.length&&(z$U._$bindData=z$V),z$U},z$r.addCell=function(z$V){z$V.on("click",this,this.onCellMouse),z$V.on("rightclick",this,this.onCellMouse),z$V.on("mouseover",this,this.onCellMouse),z$V.on("mouseout",this,this.onCellMouse),z$V.on("mousedown",this,this.onCellMouse),z$V.on("mouseup",this,this.onCellMouse),this._cells.push(z$V)},z$r.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var z$V=0,z$U=z$V=0;z$U<1e4;z$U++){var z$r=this.getChildByName("item"+z$U);if(!z$r)break;this.addCell(z$r),z$V++}this.repeatY=z$V}},z$r.setContentSize=function(z$V,z$U){this._content.width=z$V,this._content.height=z$U,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new z$l),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,z$V,z$U),this._content.scrollRect=this._content.scrollRect),this.event("resize")},z$r.onCellMouse=function(z$V){"mousedown"===z$V.type&&(this._isMoved=!1);var z$U=z$V.currentTarget,z$r=this._startIndex+this._cells.indexOf(z$U);z$r<0||("click"===z$V.type||"rightclick"===z$V.type?this.selectEnable&&!this._isMoved?this.selectedIndex=z$r:this.changeCellState(z$U,!0,0):"mouseover"!==z$V.type&&"mouseout"!==z$V.type||this._selectedIndex===z$r||this.changeCellState(z$U,"mouseover"===z$V.type,0),this.mouseHandler&&this.mouseHandler.runWith([z$V,z$r]))},z$r.changeCellState=function(z$V,z$U,z$r){var z$s=z$V.getChildByName("selectBox");z$s&&(this.selectEnable=!0,z$s.visible=z$U,z$s.index=z$r)},z$r.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},z$r.onScrollBarChange=function(z$V){this.runCallLater(this.changeCells);var z$U=this._scrollBar.value,z$r=this._isVertical?this.repeatX:this.repeatY,z$s=this._isVertical?this.repeatY:this.repeatX,z$p=Math.floor(z$U/this._cellSize);if(this.cacheContent)z$R=z$s+1,this._createdLine-z$p<z$R&&(this._createItems(this._createdLine,z$r,this._createdLine+z$R),this.renderItems(this._createdLine*z$r,0),this._createdLine+=z$R);else{var z$c=z$p*z$r,z$R=0;if(z$c>this._startIndex){z$R=z$c-this._startIndex;var z$T=!0,z$N=this._startIndex+z$r*(z$s+1);this._isMoved=!0}else z$c<this._startIndex&&(z$R=this._startIndex-z$c,z$T=!1,z$N=this._startIndex-1,this._isMoved=!0);for(var z$t=0;z$t<z$R;z$t++){if(z$T){var z$b=this._cells.shift();this._cells[this._cells.length]=z$b;var z$S=z$N+z$t}else z$b=this._cells.pop(),this._cells.unshift(z$b),z$S=z$N-z$t;var z$_=Math.floor(z$S/z$r)*this._cellSize;this._isVertical?z$b.y=z$_:z$b.x=z$_,this.renderItem(z$b,z$S)}this._startIndex=z$c,this.changeSelectStatus()}var z$G=this._content.scrollRect;this._isVertical?(z$G.y=z$U-this._offset.y,z$G.x=-this._offset.x):(z$G.y=-this._offset.y,z$G.x=z$U-this._offset.x),this._content.scrollRect=z$G},z$r.posCell=function(z$V,z$U){if(this._scrollBar){var z$r=this._isVertical?this.repeatX:this.repeatY,z$s=(this._isVertical?this.repeatY:this.repeatX,Math.floor(z$U/z$r)*this._cellSize);this._isVertical?z$V.y=z$s:z$V.x=z$s}},z$r.changeSelectStatus=function(){for(var z$V=0,z$U=this._cells.length;z$V<z$U;z$V++)this.changeCellState(this._cells[z$V],this._selectedIndex===this._startIndex+z$V,1)},z$r.renderItems=function(z$V,z$U){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0);for(var z$r=z$V,z$s=z$U||this._cells.length;z$r<z$s;z$r++)this.renderItem(this._cells[z$r],this._startIndex+z$r);this.changeSelectStatus()},z$r.renderItem=function(z$V,z$U){this._array&&0<=z$U&&z$U<this._array.length?(z$V.visible=!0,z$V._$bindData?(z$V._dataSource=this._array[z$U],this._bindData(z$V,this._array[z$U])):z$V.dataSource=this._array[z$U],this.cacheContent||this.posCell(z$V,z$U),this.hasListener("render")&&this.event("render",[z$V,z$U]),this.renderHandler&&this.renderHandler.runWith([z$V,z$U])):(z$V.visible=!1,z$V.dataSource=null)},z$r._bindData=function(z$V,z$U){for(var z$r=z$V._$bindData,z$s=0,z$p=z$r.length;z$s<z$p;z$s++){var z$c=z$r[z$s++],z$R=z$r[z$s++],z$T=z$r[z$s],z$N=z$H.getBindFun(z$T);z$c[z$R]=z$N.call(this,z$U)}},z$r.refresh=function(){this.array=this._array},z$r.getItem=function(z$V){return-1<z$V&&z$V<this._array.length?this._array[z$V]:null},z$r.changeItem=function(z$V,z$U){-1<z$V&&z$V<this._array.length&&(this._array[z$V]=z$U,z$V>=this._startIndex&&z$V<this._startIndex+this._cells.length&&this.renderItem(this.getCell(z$V),z$V))},z$r.setItem=function(z$V,z$U){this.changeItem(z$V,z$U)},z$r.addItem=function(z$V){this._array.push(z$V),this.array=this._array},z$r.addItemAt=function(z$V,z$U){this._array.splice(z$U,0,z$V),this.array=this._array},z$r.deleteItem=function(z$V){this._array.splice(z$V,1),this.array=this._array},z$r.getCell=function(z$V){return this.runCallLater(this.changeCells),-1<z$V&&this._cells?this._cells[(z$V-this._startIndex)%this._cells.length]:null},z$r.scrollTo=function(z$V){if(this._scrollBar){var z$U=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(z$V/z$U)*this._cellSize}else this.startIndex=z$V},z$r.tweenTo=function(z$V,z$U,z$r){if(void 0===z$U&&(z$U=200),this._scrollBar){var z$s=this._isVertical?this.repeatX:this.repeatY;z$y.to(this._scrollBar,{value:Math.floor(z$V/z$s)*this._cellSize},z$U,null,z$r,0,!0)}else this.startIndex=z$V,z$r&&z$r.run()},z$r._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},z$r.commitMeasure=function(){this.runCallLater(this.changeCells)},z$R(0,z$r,"cacheAs",z$V.prototype._$get_cacheAs,function(z$V){z$u.superSet(z$m,this,"cacheAs",z$V),this._scrollBar&&(this._$P.cacheAs=null,"none"!==z$V?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),z$R(0,z$r,"content",function(){return this._content}),z$R(0,z$r,"height",z$V.prototype._$get_height,function(z$V){z$V!=this._height&&(z$u.superSet(z$m,this,"height",z$V),this._setCellChanged())}),z$R(0,z$r,"itemRender",function(){return this._itemRender},function(z$V){if(this._itemRender!=z$V){this._itemRender=z$V;for(var z$U=this._cells.length-1;-1<z$U;z$U--)this._cells[z$U].destroy();this._cells.length=0,this._setCellChanged()}}),z$R(0,z$r,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(z$V){this._removePreScrollBar();var z$U=new z$UV;z$U.name="scrollBar",z$U.right=0,z$V&&" "!=z$V&&(z$U.skin=z$V),this.scrollBar=z$U,this.addChild(z$U),this._setCellChanged()}),z$R(0,z$r,"page",function(){return this._page},function(z$V){this._page=z$V,this._array&&(this._page=0<z$V?z$V:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),z$R(0,z$r,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(z$V){this._removePreScrollBar();var z$U=new z$F;z$U.name="scrollBar",z$U.bottom=0,z$V&&" "!=z$V&&(z$U.skin=z$V),this.scrollBar=z$U,this.addChild(z$U),this._setCellChanged()}),z$R(0,z$r,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(z$V){this._repeatX=z$V,this._setCellChanged()}),z$R(0,z$r,"scrollBar",function(){return this._scrollBar},function(z$V){this._scrollBar!=z$V&&(this._scrollBar=z$V)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),z$R(0,z$r,"width",z$V.prototype._$get_width,function(z$V){z$V!=this._width&&(z$u.superSet(z$m,this,"width",z$V),this._setCellChanged())}),z$R(0,z$r,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(z$V){this._repeatY=z$V,this._setCellChanged()}),z$R(0,z$r,"spaceX",function(){return this._spaceX},function(z$V){this._spaceX=z$V,this._setCellChanged()}),z$R(0,z$r,"spaceY",function(){return this._spaceY},function(z$V){this._spaceY=z$V,this._setCellChanged()}),z$R(0,z$r,"selectedIndex",function(){return this._selectedIndex},function(z$V){this._selectedIndex!=z$V&&(this._selectedIndex=z$V,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(z$V),this.startIndex=this._startIndex)}),z$R(0,z$r,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(z$V){this.selectedIndex=this._array.indexOf(z$V)}),z$R(0,z$r,"length",function(){return this._array?this._array.length:0}),z$R(0,z$r,"selection",function(){return this.getCell(this._selectedIndex)},function(z$V){this.selectedIndex=this._startIndex+this._cells.indexOf(z$V)}),z$R(0,z$r,"startIndex",function(){return this._startIndex},function(z$V){this._startIndex=0<z$V?z$V:0,this.callLater(this.renderItems)}),z$R(0,z$r,"array",function(){return this._array},function(z$V){this.runCallLater(this.changeCells),this._array=z$V||[];var z$U=this._array.length;if(this.totalPage=Math.ceil(z$U/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<z$U?this._selectedIndex:z$U-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var z$r=this._isVertical?this.repeatX:this.repeatY,z$s=this._isVertical?this.repeatY:this.repeatX,z$p=Math.ceil(z$U/z$r);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=z$s/z$p,this._scrollBar.setScroll(0,(z$p-z$s)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),z$R(0,z$r,"dataSource",z$V.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)&&Math.floor(z$V)==z$V||"string"==typeof z$V?this.selectedIndex=parseInt(z$V):z$V instanceof Array?this.array=z$V:z$u.superSet(z$m,this,"dataSource",z$V)}),z$R(0,z$r,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),z$U}(z$m),z$F=function(z$V){function z$U(){z$U.__super.call(this)}return z$c(z$U,"laya.ui.HScrollBar",z$V),z$U.prototype.initialize=function(){z$V.prototype.initialize.call(this),this.slider.isVertical=!1},z$U}(z$j),z$g=function(z$V){function z$U(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,z$U.__super.call(this),this.width=this.height=100}z$c(z$U,"laya.ui.Panel",z$V);var z$r=z$U.prototype;return z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),laya.ui.Component.prototype.destroy.call(this,z$V),this._content&&this._content.destroy(z$V),this._vScrollBar&&this._vScrollBar.destroy(z$V),this._hScrollBar&&this._hScrollBar.destroy(z$V),this._vScrollBar=null,this._hScrollBar=null,this._content=null},z$r.destroyChildren=function(){this._content.destroyChildren()},z$r.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new z$m)},z$r.addChild=function(z$V){return z$V.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(z$V)},z$r.onResize=function(){this._setScrollChanged()},z$r.addChildAt=function(z$V,z$U){return z$V.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(z$V,z$U)},z$r.removeChild=function(z$V){return z$V.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(z$V)},z$r.removeChildAt=function(z$V){return this.getChildAt(z$V).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(z$V)},z$r.removeChildren=function(z$V,z$U){return void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=2147483647),this._content.removeChildren(z$V,z$U),this._setScrollChanged(),this},z$r.getChildAt=function(z$V){return this._content.getChildAt(z$V)},z$r.getChildByName=function(z$V){return this._content.getChildByName(z$V)},z$r.getChildIndex=function(z$V){return this._content.getChildIndex(z$V)},z$r.changeScroll=function(){this._scrollChanged=!1;var z$V=this.contentWidth||1,z$U=this.contentHeight||1,z$r=this._vScrollBar,z$s=this._hScrollBar,z$p=z$r&&z$U>this._height,z$c=z$s&&z$V>this._width,z$R=z$p?this._width-z$r.width:this._width,z$T=z$c?this._height-z$s.height:this._height;z$r&&(z$r.x=this._width-z$r.width,z$r.y=0,z$r.height=this._height-(z$c?z$s.height:0),z$r.scrollSize=Math.max(.033*this._height,1),z$r.thumbPercent=z$T/z$U,z$r.setScroll(0,z$U-z$T,z$r.value)),z$s&&(z$s.x=0,z$s.y=this._height-z$s.height,z$s.width=this._width-(z$p?z$r.width:0),z$s.scrollSize=Math.max(.033*this._width,1),z$s.thumbPercent=z$R/z$V,z$s.setScroll(0,z$V-z$R,z$s.value))},z$r.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},z$r.setContentSize=function(z$V,z$U){var z$r=this._content;z$r.width=z$V,z$r.height=z$U,z$r.scrollRect||(z$r.scrollRect=new z$l),z$r.scrollRect.setTo(0,0,z$V,z$U),z$r.scrollRect=z$r.scrollRect},z$r.onScrollBarChange=function(z$V){var z$U=this._content.scrollRect;if(z$U){var z$r=Math.round(z$V.value);z$V.isVertical?z$U.y=z$r:z$U.x=z$r,this._content.scrollRect=z$U}},z$r.scrollTo=function(z$V,z$U){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),this.vScrollBar&&(this.vScrollBar.value=z$U),this.hScrollBar&&(this.hScrollBar.value=z$V)},z$r.refresh=function(){this.changeScroll()},z$r.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=z$u.superGet(z$m,this,"cacheAs")),z$u.superSet(z$m,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},z$r.onScrollEnd=function(){z$u.superSet(z$m,this,"cacheAs",this._$P.cacheAs)},z$r._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},z$R(0,z$r,"numChildren",function(){return this._content.numChildren}),z$R(0,z$r,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(z$V){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new z$F),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=z$V}),z$R(0,z$r,"contentWidth",function(){for(var z$V=0,z$U=this._content.numChildren-1;-1<z$U;z$U--){var z$r=this._content.getChildAt(z$U);z$V=Math.max(z$r.x+z$r.width*z$r.scaleX,z$V)}return z$V}),z$R(0,z$r,"contentHeight",function(){for(var z$V=0,z$U=this._content.numChildren-1;-1<z$U;z$U--){var z$r=this._content.getChildAt(z$U);z$V=Math.max(z$r.y+z$r.height*z$r.scaleY,z$V)}return z$V}),z$R(0,z$r,"width",z$V.prototype._$get_width,function(z$V){z$u.superSet(z$m,this,"width",z$V),this._setScrollChanged()}),z$R(0,z$r,"hScrollBar",function(){return this._hScrollBar}),z$R(0,z$r,"content",function(){return this._content}),z$R(0,z$r,"height",z$V.prototype._$get_height,function(z$V){z$u.superSet(z$m,this,"height",z$V),this._setScrollChanged()}),z$R(0,z$r,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(z$V){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new z$UV),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=z$V}),z$R(0,z$r,"vScrollBar",function(){return this._vScrollBar}),z$R(0,z$r,"cacheAs",z$V.prototype._$get_cacheAs,function(z$V){z$u.superSet(z$m,this,"cacheAs",z$V),this._$P.cacheAs=null,"none"!==z$V?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),z$U}(z$m),z$v=function(z$V){function z$U(z$V){z$U.__super.call(this,z$V),this.isVertical=!1}return z$c(z$U,"laya.ui.HSlider",z$o),z$U}(),z$Y=function(z$V){function z$r(z$V,z$U){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,z$r.__super.call(this),this.skin=z$U,this.labels=z$V}z$c(z$r,"laya.ui.UIGroup",z$V);var z$U=z$r.prototype;return z$u.imps(z$U,{"laya.ui.IItem":!0}),z$U.preinitialize=function(){this.mouseEnabled=!0},z$U.destroy=function(z$V){void 0===z$V&&(z$V=!0),laya.ui.Component.prototype.destroy.call(this,z$V),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},z$U.addItem=function(z$V,z$U){void 0===z$U&&(z$U=!0);var z$r=z$V,z$s=this._items.length;if(z$r.name="item"+z$s,this.addChild(z$r),this.initItems(),z$U&&0<z$s){var z$p=this._items[z$s-1];"horizontal"==this._direction?z$r.x=z$p.x+z$p.width+this._space:z$r.y=z$p.y+z$p.height+this._space}else z$U&&(z$r.x=0,z$r.y=0);return z$s},z$U.delItem=function(z$V,z$U){void 0===z$U&&(z$U=!0);var z$r=this._items.indexOf(z$V);if(-1!=z$r){var z$s=z$V;this.removeChild(z$s);for(var z$p=z$r+1,z$c=this._items.length;z$p<z$c;z$p++){var z$R=this._items[z$p];z$R.name="item"+(z$p-1),z$U&&("horizontal"==this._direction?z$R.x-=z$s.width+this._space:z$R.y-=z$s.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var z$T;z$T=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=z$T}}},z$U.initItems=function(){this._items||(this._items=[]);for(var z$V=this._items.length=0;z$V<1e4;z$V++){var z$U=this.getChildByName("item"+z$V);if(null==z$U)break;this._items.push(z$U),z$U.selected=z$V===this._selectedIndex,z$U.clickHandler=z$_.create(this,this.itemClick,[z$V],!1)}},z$U.itemClick=function(z$V){this.selectedIndex=z$V},z$U.setSelect=function(z$V,z$U){this._items&&-1<z$V&&z$V<this._items.length&&(this._items[z$V].selected=z$U)},z$U.createItem=function(z$V,z$U){return null},z$U.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var z$V=0,z$U=0,z$r=this._items.length;z$U<z$r;z$U++){var z$s=this._items[z$U];this._skin&&(z$s.skin=this._skin),this._labelColors&&(z$s.labelColors=this._labelColors),this._labelSize&&(z$s.labelSize=this._labelSize),this._labelStroke&&(z$s.labelStroke=this._labelStroke),this._labelStrokeColor&&(z$s.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(z$s.strokeColors=this._strokeColors),this._labelBold&&(z$s.labelBold=this._labelBold),this._labelPadding&&(z$s.labelPadding=this._labelPadding),this._labelAlign&&(z$s.labelAlign=this._labelAlign),this._stateNum&&(z$s.stateNum=this._stateNum),this._labelFont&&(z$s.labelFont=this._labelFont),"horizontal"===this._direction?(z$s.y=0,z$s.x=z$V,z$V+=z$s.width+this._space):(z$s.x=0,z$s.y=z$V,z$V+=z$s.height+this._space)}this.changeSize()},z$U.commitMeasure=function(){this.runCallLater(this.changeLabels)},z$U._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},z$R(0,z$U,"labelStrokeColor",function(){return this._labelStrokeColor},function(z$V){this._labelStrokeColor!=z$V&&(this._labelStrokeColor=z$V,this._setLabelChanged())}),z$R(0,z$U,"skin",function(){return this._skin},function(z$V){this._skin!=z$V&&(this._skin=z$V,this._setLabelChanged())}),z$R(0,z$U,"selectedIndex",function(){return this._selectedIndex},function(z$V){this._selectedIndex!=z$V&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=z$V,this.setSelect(z$V,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),z$R(0,z$U,"labels",function(){return this._labels},function(z$V){if(this._labels!=z$V){if(this._labels=z$V,this.removeChildren(),this._setLabelChanged(),this._labels)for(var z$U=this._labels.split(","),z$r=0,z$s=z$U.length;z$r<z$s;z$r++){var z$p=this.createItem(this._skin,z$U[z$r]);z$p.name="item"+z$r,this.addChild(z$p)}this.initItems()}}),z$R(0,z$U,"strokeColors",function(){return this._strokeColors},function(z$V){this._strokeColors!=z$V&&(this._strokeColors=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelColors",function(){return this._labelColors},function(z$V){this._labelColors!=z$V&&(this._labelColors=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelStroke",function(){return this._labelStroke},function(z$V){this._labelStroke!=z$V&&(this._labelStroke=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelSize",function(){return this._labelSize},function(z$V){this._labelSize!=z$V&&(this._labelSize=z$V,this._setLabelChanged())}),z$R(0,z$U,"stateNum",function(){return this._stateNum},function(z$V){this._stateNum!=z$V&&(this._stateNum=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelBold",function(){return this._labelBold},function(z$V){this._labelBold!=z$V&&(this._labelBold=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelFont",function(){return this._labelFont},function(z$V){this._labelFont!=z$V&&(this._labelFont=z$V,this._setLabelChanged())}),z$R(0,z$U,"labelPadding",function(){return this._labelPadding},function(z$V){this._labelPadding!=z$V&&(this._labelPadding=z$V,this._setLabelChanged())}),z$R(0,z$U,"direction",function(){return this._direction},function(z$V){this._direction=z$V,this._setLabelChanged()}),z$R(0,z$U,"space",function(){return this._space},function(z$V){this._space=z$V,this._setLabelChanged()}),z$R(0,z$U,"items",function(){return this._items}),z$R(0,z$U,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(z$V){this.selectedIndex=this._items.indexOf(z$V)}),z$R(0,z$U,"dataSource",z$V.prototype._$get_dataSource,function(z$V){"number"==typeof(this._dataSource=z$V)&&Math.floor(z$V)==z$V||"string"==typeof z$V?this.selectedIndex=parseInt(z$V):z$V instanceof Array?this.labels=z$V.join(","):z$u.superSet(z$m,this,"dataSource",z$V)}),z$r}(z$m),z$C=function(z$U){function z$r(z$V,z$U){this._value=null,void 0===z$U&&(z$U=""),z$r.__super.call(this,z$V,z$U)}z$c(z$r,"laya.ui.Radio",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._value=null},z$V.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},z$V.initialize=function(){z$U.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},z$V.onClick=function(z$V){this.selected=!0},z$R(0,z$V,"value",function(){return null!=this._value?this._value:this.label},function(z$V){this._value=z$V}),z$r}(z$a),z$f=function(z$V){function z$U(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,z$U.__super.call(this),this.width=this.height=200}z$c(z$U,"laya.ui.Tree",z$V);var z$r=z$U.prototype;return z$u.imps(z$r,{"laya.ui.IRender":!0}),z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),laya.ui.Component.prototype.destroy.call(this,z$V),this._list&&this._list.destroy(z$V),this._list=null,this._source=null,this._renderHandler=null},z$r.createChildren=function(){this.addChild(this._list=new z$e),this._list.renderHandler=z$_.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},z$r.onListChange=function(z$V){this.event("change")},z$r.getArray=function(){var z$V,z$U=[];for(var z$r in this._source)z$V=this._source[z$r],this.getParentOpenStatus(z$V)&&(z$V.x=this._spaceLeft*this.getDepth(z$V),z$U.push(z$V));return z$U},z$r.getDepth=function(z$V,z$U){return void 0===z$U&&(z$U=0),null==z$V.nodeParent?z$U:this.getDepth(z$V.nodeParent,z$U+1)},z$r.getParentOpenStatus=function(z$V){var z$U=z$V.nodeParent;return null==z$U||!!z$U.isOpen&&(null==z$U.nodeParent||this.getParentOpenStatus(z$U))},z$r.renderItem=function(z$V,z$U){var z$r=z$V.dataSource;if(z$r){z$V.left=z$r.x;var z$s=z$V.getChildByName("arrow");z$s&&(z$r.hasChild?(z$s.visible=!0,z$s.index=z$r.isOpen?1:0,z$s.tag=z$U,z$s.off("click",this,this.onArrowClick),z$s.on("click",this,this.onArrowClick)):z$s.visible=!1);var z$p=z$V.getChildByName("folder");z$p&&(2==z$p.clipY?z$p.index=z$r.isDirectory?0:1:z$p.index=z$r.isDirectory?z$r.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([z$V,z$U])}},z$r.onArrowClick=function(z$V){var z$U=z$V.currentTarget.tag;this._list.array[z$U].isOpen=!this._list.array[z$U].isOpen,this.event("open"),this._list.array=this.getArray()},z$r.setItemState=function(z$V,z$U){this._list.array[z$V]&&(this._list.array[z$V].isOpen=z$U,this._list.array=this.getArray())},z$r.fresh=function(){this._list.array=this.getArray(),this.repaint()},z$r.parseXml=function(z$V,z$U,z$r,z$s){var z$p,z$c=z$V.childNodes,z$R=z$c.length;if(!z$s){z$p={};var z$T,z$N=z$V.attributes;for(var z$t in z$N){var z$b=(z$T=z$N[z$t]).nodeName,z$S=z$T.nodeValue;z$p[z$b]="true"==z$S||"false"!=z$S&&z$S}z$p.nodeParent=z$r,0<z$R&&(z$p.isDirectory=!0),z$p.hasChild=0<z$R,z$U.push(z$p)}for(var z$_=0;z$_<z$R;z$_++){var z$G=z$c[z$_];this.parseXml(z$G,z$U,z$p,!1)}},z$r.parseOpenStatus=function(z$V,z$U){for(var z$r=0,z$s=z$U.length;z$r<z$s;z$r++){var z$p=z$U[z$r];if(z$p.isDirectory)for(var z$c=0,z$R=z$V.length;z$c<z$R;z$c++){var z$T=z$V[z$c];if(z$T.isDirectory&&this.isSameParent(z$T,z$p)&&z$p.label==z$T.label){z$p.isOpen=z$T.isOpen;break}}}},z$r.isSameParent=function(z$V,z$U){return null==z$V.nodeParent&&null==z$U.nodeParent||null!=z$V.nodeParent&&null!=z$U.nodeParent&&(z$V.nodeParent.label==z$U.nodeParent.label&&this.isSameParent(z$V.nodeParent,z$U.nodeParent))},z$r.filter=function(z$V){if(Boolean(z$V)){var z$U=[];this.getFilterSource(this._source,z$U,z$V),this._list.array=z$U}else this._list.array=this.getArray()},z$r.getFilterSource=function(z$V,z$U,z$r){var z$s;for(var z$p in z$r=z$r.toLocaleLowerCase(),z$V)!(z$s=z$V[z$p]).isDirectory&&-1<String(z$s.label).toLowerCase().indexOf(z$r)&&(z$s.x=0,z$U.push(z$s)),z$s.child&&0<z$s.child.length&&this.getFilterSource(z$s.child,z$U,z$r)},z$R(0,z$r,"spaceBottom",function(){return this._list.spaceY},function(z$V){this._list.spaceY=z$V}),z$R(0,z$r,"keepStatus",function(){return this._keepStatus},function(z$V){this._keepStatus=z$V}),z$R(0,z$r,"itemRender",function(){return this._list.itemRender},function(z$V){this._list.itemRender=z$V}),z$R(0,z$r,"array",function(){return this._list.array},function(z$V){this._keepStatus&&this._list.array&&z$V&&this.parseOpenStatus(this._list.array,z$V),this._source=z$V,this._list.array=this.getArray()}),z$R(0,z$r,"mouseHandler",function(){return this._list.mouseHandler},function(z$V){this._list.mouseHandler=z$V}),z$R(0,z$r,"dataSource",z$V.prototype._$get_dataSource,function(z$V){this._dataSource=z$V,z$u.superSet(z$m,this,"dataSource",z$V)}),z$R(0,z$r,"source",function(){return this._source}),z$R(0,z$r,"scrollBar",function(){return this._list.scrollBar}),z$R(0,z$r,"list",function(){return this._list}),z$R(0,z$r,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(z$V){this._list.vScrollBarSkin=z$V}),z$R(0,z$r,"renderHandler",function(){return this._renderHandler},function(z$V){this._renderHandler=z$V}),z$R(0,z$r,"selectedIndex",function(){return this._list.selectedIndex},function(z$V){this._list.selectedIndex=z$V}),z$R(0,z$r,"spaceLeft",function(){return this._spaceLeft},function(z$V){this._spaceLeft=z$V}),z$R(0,z$r,"selectedItem",function(){return this._list.selectedItem},function(z$V){this._list.selectedItem=z$V}),z$R(0,z$r,"width",z$V.prototype._$get_width,function(z$V){z$u.superSet(z$m,this,"width",z$V),this._list.width=z$V}),z$R(0,z$r,"height",z$V.prototype._$get_height,function(z$V){z$u.superSet(z$m,this,"height",z$V),this._list.height=z$V}),z$R(0,z$r,"xml",null,function(z$V){var z$U=[];this.parseXml(z$V.childNodes[0],z$U,null,!0),this.array=z$U}),z$R(0,z$r,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),z$U}(z$m),z$VV=function(z$V){function z$U(){this._items=null,this._selectedIndex=0,z$U.__super.call(this),this._setIndexHandler=z$_.create(this,this.setIndex,null,!1)}z$c(z$U,"laya.ui.ViewStack",z$V);var z$r=z$U.prototype;return z$u.imps(z$r,{"laya.ui.IItem":!0}),z$r.setItems=function(z$V){this.removeChildren();for(var z$U=0,z$r=0,z$s=z$V.length;z$r<z$s;z$r++){var z$p=z$V[z$r];z$p&&(z$p.name="item"+z$U,this.addChild(z$p),z$U++)}this.initItems()},z$r.addItem=function(z$V){z$V.name="item"+this._items.length,this.addChild(z$V),this.initItems()},z$r.initItems=function(){this._items=[];for(var z$V=0;z$V<1e4;z$V++){var z$U=this.getChildByName("item"+z$V);if(null==z$U)break;this._items.push(z$U),z$U.visible=z$V==this._selectedIndex}},z$r.setSelect=function(z$V,z$U){this._items&&-1<z$V&&z$V<this._items.length&&(this._items[z$V].visible=z$U)},z$r.setIndex=function(z$V){this.selectedIndex=z$V},z$R(0,z$r,"dataSource",z$V.prototype._$get_dataSource,function(z$V){if("number"==typeof(this._dataSource=z$V)&&Math.floor(z$V)==z$V||"string"==typeof z$V)this.selectedIndex=parseInt(z$V);else for(var z$U in this._dataSource)this.hasOwnProperty(z$U)&&(this[z$U]=this._dataSource[z$U])}),z$R(0,z$r,"selectedIndex",function(){return this._selectedIndex},function(z$V){this._selectedIndex!=z$V&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=z$V,this.setSelect(this._selectedIndex,!0))}),z$R(0,z$r,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(z$V){this.selectedIndex=this._items.indexOf(z$V)}),z$R(0,z$r,"items",function(){return this._items}),z$R(0,z$r,"setIndexHandler",function(){return this._setIndexHandler},function(z$V){this._setIndexHandler=z$V}),z$U}(z$m),z$UV=function(z$V){function z$U(){z$U.__super.call(this)}return z$c(z$U,"laya.ui.VScrollBar",z$j),z$U}(),z$rV=function(z$U){function z$r(z$V){this._bg=null,this._skin=null,z$r.__super.call(this),void 0===z$V&&(z$V=""),this.text=z$V,this.skin=this.skin}z$c(z$r,"laya.ui.TextInput",z$U);var z$V=z$r.prototype;return z$V.preinitialize=function(){this.mouseEnabled=!0},z$V.destroy=function(z$V){z$W.clearCache(this,this._skin),void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._bg&&this._bg.destroy(),this._bg=null},z$V.createChildren=function(){this.addChild(this._tf=new z$G),this._tf.padding=z$Q.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},z$V._onFocus=function(){this.event("focus",this)},z$V._onBlur=function(){this.event("blur",this)},z$V._onInput=function(){this.event("input",this)},z$V._onEnter=function(){this.event("enter",this)},z$V.initialize=function(){this.width=128,this.height=22},z$V.select=function(){this._tf.select()},z$V.setSelection=function(z$V,z$U){this._tf.setSelection(z$V,z$U)},z$R(0,z$V,"text",z$U.prototype._$get_text,function(z$V){this._tf.text!=z$V&&(z$V+="",this._tf.text=z$V,this.event("change"))}),z$R(0,z$V,"bg",function(){return this._bg},function(z$V){this.graphics=this._bg=z$V}),z$R(0,z$V,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(z$V){this._tf.inputElementYAdjuster=z$V}),z$R(0,z$V,"multiline",function(){return this._tf.multiline},function(z$V){this._tf.multiline=z$V}),z$R(0,z$V,"skin",function(){return this._skin},function(z$V){this._skin!=z$V&&(z$W.clearCache(this,this._skin),this._skin=z$V,this._bg||(this.graphics=this._bg=new z$z),z$W.keepCache(this,this._skin),this._bg.source=z$W.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),z$R(0,z$V,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(z$V){this._bg||(this.graphics=this._bg=new z$z),this._bg.sizeGrid=z$H.fillArray(z$Q.defaultSizeGrid,z$V,Number)}),z$R(0,z$V,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(z$V){this._tf.inputElementXAdjuster=z$V}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$i,this,"width",z$V),this._bg&&(this._bg.width=z$V)}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$i,this,"height",z$V),this._bg&&(this._bg.height=z$V)}),z$R(0,z$V,"editable",function(){return this._tf.editable},function(z$V){this._tf.editable=z$V}),z$R(0,z$V,"restrict",function(){return this._tf.restrict},function(z$V){this._tf.restrict=z$V}),z$R(0,z$V,"prompt",function(){return this._tf.prompt},function(z$V){this._tf.prompt=z$V}),z$R(0,z$V,"promptColor",function(){return this._tf.promptColor},function(z$V){this._tf.promptColor=z$V}),z$R(0,z$V,"maxChars",function(){return this._tf.maxChars},function(z$V){this._tf.maxChars=z$V}),z$R(0,z$V,"focus",function(){return this._tf.focus},function(z$V){this._tf.focus=z$V}),z$R(0,z$V,"type",function(){return this._tf.type},function(z$V){this._tf.type=z$V}),z$R(0,z$V,"asPassword",function(){return this._tf.asPassword},function(z$V){this._tf.asPassword=z$V}),z$r}(z$i),z$sV=function(z$V){function z$U(){z$U.__super.call(this)}return z$c(z$U,"laya.ui.VSlider",z$o),z$U}(),z$pV=function(z$V){function z$s(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,z$s.__super.call(this)}z$c(z$s,"laya.ui.Dialog",z$V);var z$U=z$s.prototype;return z$U.initialize=function(){this.popupEffect=z$s.manager.popupEffectHandler,this.closeEffect=z$s.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},z$U._dealDragArea=function(){var z$V=this.getChildByName("drag");z$V&&(this.dragArea=z$V.x+","+z$V.y+","+z$V.width+","+z$V.height,z$V.removeSelf())},z$U._onClick=function(z$V){var z$U=z$V.target;if(z$U)switch(z$U.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(z$U.name)}},z$U.show=function(z$V,z$U){void 0===z$V&&(z$V=!1),void 0===z$U&&(z$U=!0),this._open(!1,z$V,z$U)},z$U.popup=function(z$V,z$U){void 0===z$V&&(z$V=!1),void 0===z$U&&(z$U=!0),this._open(!0,z$V,z$U)},z$U._open=function(z$V,z$U,z$r){z$s.manager.lock(!1),this.isModal=z$V,z$s.manager.open(this,z$U,z$r)},z$U.onOpened=function(){},z$U.close=function(z$V,z$U){void 0===z$U&&(z$U=!0),z$s.manager.close(this,z$V,z$U)},z$U.onClosed=function(z$V){},z$U._onMouseDown=function(z$V){var z$U=this.getMousePoint();this._dragArea.contains(z$U.x,z$U.y)?this.startDrag():this.stopDrag()},z$R(0,z$U,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(z$V){if(z$V){var z$U=z$H.fillArray([0,0,0,0],z$V,Number);this._dragArea=new z$l(z$U[0],z$U[1],z$U[2],z$U[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),z$R(0,z$U,"isPopup",function(){return null!=this.parent}),z$R(0,z$U,"zOrder",z$V.prototype._$get_zOrder,function(z$V){z$u.superSet(z$P,this,"zOrder",z$V),z$s.manager._checkMask()}),z$R(1,z$s,"manager",function(){return z$s._manager=z$s._manager||new z$K},function(z$V){z$s._manager=z$V}),z$s.setLockView=function(z$V){z$s.manager.setLockView(z$V)},z$s.lock=function(z$V){z$s.manager.lock(z$V)},z$s.closeAll=function(){z$s.manager.closeAll()},z$s.getDialogsByGroup=function(z$V){return z$s.manager.getDialogsByGroup(z$V)},z$s.closeByGroup=function(z$V){return z$s.manager.closeByGroup(z$V)},z$s.CLOSE="close",z$s.CANCEL="cancel",z$s.SURE="sure",z$s.NO="no",z$s.OK="ok",z$s.YES="yes",z$s._manager=null,z$s}(z$P),z$cV=function(z$V){function z$U(){z$U.__super.call(this)}z$c(z$U,"laya.ui.HBox",z$V);var z$r=z$U.prototype;return z$r.sortItem=function(z$V){z$V&&z$V.sort(function(z$V,z$U){return z$V.x-z$U.x})},z$r.changeItems=function(){this._itemChanged=!1;for(var z$V=[],z$U=0,z$r=0,z$s=this.numChildren;z$r<z$s;z$r++){var z$p=this.getChildAt(z$r);z$p&&z$p.layoutEnabled&&(z$V.push(z$p),z$U=this._height?this._height:Math.max(z$U,z$p.height*z$p.scaleY))}this.sortItem(z$V);var z$c=0;for(z$r=0,z$s=z$V.length;z$r<z$s;z$r++)(z$p=z$V[z$r]).x=z$c,z$c+=z$p.width*z$p.scaleX+this._space,"top"==this._align?z$p.y=0:"middle"==this._align?z$p.y=.5*(z$U-z$p.height*z$p.scaleY):"bottom"==this._align&&(z$p.y=z$U-z$p.height*z$p.scaleY);this.changeSize()},z$R(0,z$r,"height",z$V.prototype._$get_height,function(z$V){this._height!=z$V&&(z$u.superSet(z$A,this,"height",z$V),this.callLater(this.changeItems))}),z$U.NONE="none",z$U.TOP="top",z$U.MIDDLE="middle",z$U.BOTTOM="bottom",z$U}(z$A),z$RV=function(z$V){function z$U(){z$U.__super.call(this)}z$c(z$U,"laya.ui.VBox",z$V);var z$r=z$U.prototype;return z$r.changeItems=function(){this._itemChanged=!1;for(var z$V=[],z$U=0,z$r=0,z$s=this.numChildren;z$r<z$s;z$r++){var z$p=this.getChildAt(z$r);z$p&&z$p.layoutEnabled&&(z$V.push(z$p),z$U=this._width?this._width:Math.max(z$U,z$p.width*z$p.scaleX))}this.sortItem(z$V);var z$c=0;for(z$r=0,z$s=z$V.length;z$r<z$s;z$r++)(z$p=z$V[z$r]).y=z$c,z$c+=z$p.height*z$p.scaleY+this._space,"left"==this._align?z$p.x=0:"center"==this._align?z$p.x=.5*(z$U-z$p.width*z$p.scaleX):"right"==this._align&&(z$p.x=z$U-z$p.width*z$p.scaleX);this.changeSize()},z$R(0,z$r,"width",z$V.prototype._$get_width,function(z$V){this._width!=z$V&&(z$u.superSet(z$A,this,"width",z$V),this.callLater(this.changeItems))}),z$U.NONE="none",z$U.LEFT="left",z$U.CENTER="center",z$U.RIGHT="right",z$U}(z$A),z$TV=function(z$V){function z$U(){z$U.__super.call(this)}return z$c(z$U,"laya.ui.RadioGroup",z$Y),z$U.prototype.createItem=function(z$V,z$U){return new z$C(z$V,z$U)},z$U}(),z$NV=function(z$V){function z$U(){z$U.__super.call(this)}return z$c(z$U,"laya.ui.Tab",z$Y),z$U.prototype.createItem=function(z$V,z$U){return new z$a(z$V,z$U)},z$U}(),z$tV=function(z$U){function z$r(z$V){this._vScrollBar=null,this._hScrollBar=null,void 0===z$V&&(z$V=""),z$r.__super.call(this,z$V)}z$c(z$r,"laya.ui.TextArea",z$U);var z$V=z$r.prototype;return z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},z$V.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},z$V.onVBarChanged=function(z$V){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},z$V.onHBarChanged=function(z$V){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},z$V.changeScroll=function(){var z$V=this._vScrollBar&&0<this._tf.maxScrollY,z$U=this._hScrollBar&&0<this._tf.maxScrollX,z$r=z$V?this._width-this._vScrollBar.width:this._width,z$s=z$U?this._height-this._hScrollBar.height:this._height,z$p=this._tf.padding||z$Q.labelPadding;this._tf.width=z$r,this._tf.height=z$s,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-z$p[2],this._vScrollBar.y=z$p[1],this._vScrollBar.height=this._height-(z$U?this._hScrollBar.height:0)-z$p[1]-z$p[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=z$s/Math.max(this._tf.textHeight,z$s),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=z$V),this._hScrollBar&&(this._hScrollBar.x=z$p[0],this._hScrollBar.y=this._height-this._hScrollBar.height-z$p[3],this._hScrollBar.width=this._width-(z$V?this._vScrollBar.width:0)-z$p[0]-z$p[2],this._hScrollBar.scrollSize=Math.max(.033*z$r,1),this._hScrollBar.thumbPercent=z$r/Math.max(this._tf.textWidth,z$r),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=z$U)},z$V.scrollTo=function(z$V){this.commitMeasure(),this._tf.scrollY=z$V},z$R(0,z$V,"scrollY",function(){return this._tf.scrollY}),z$R(0,z$V,"width",z$U.prototype._$get_width,function(z$V){z$u.superSet(z$rV,this,"width",z$V),this.callLater(this.changeScroll)}),z$R(0,z$V,"hScrollBar",function(){return this._hScrollBar}),z$R(0,z$V,"height",z$U.prototype._$get_height,function(z$V){z$u.superSet(z$rV,this,"height",z$V),this.callLater(this.changeScroll)}),z$R(0,z$V,"maxScrollX",function(){return this._tf.maxScrollX}),z$R(0,z$V,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(z$V){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new z$UV),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=z$V}),z$R(0,z$V,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(z$V){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new z$F),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=z$V}),z$R(0,z$V,"vScrollBar",function(){return this._vScrollBar}),z$R(0,z$V,"maxScrollY",function(){return this._tf.maxScrollY}),z$R(0,z$V,"scrollX",function(){return this._tf.scrollX}),z$r}(z$rV);!function(z$V){function z$U(){this._uiView=null,this.isCloseOther=!1,z$U.__super.call(this)}z$c(z$U,"laya.ui.AsynDialog",z$pV);var z$r=z$U.prototype;z$r.createView=function(z$V){this._uiView=z$V},z$r._open=function(z$V,z$U,z$r){this.isModal=z$V,this.isCloseOther=z$U,z$pV.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},z$r.onCreated=function(){this.createUI(),this.onOpen()},z$r.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},z$r.onOpen=function(){z$pV.manager.open(this,this.isCloseOther),z$pV.manager.lock(!1)},z$r.close=function(z$V,z$U){void 0===z$U&&(z$U=!0),z$pV.manager.close(this),this.onClose()},z$r.onClose=function(){},z$r.destroy=function(z$V){void 0===z$V&&(z$V=!0),laya.ui.View.prototype.destroy.call(this,z$V),this._uiView=null,this.onDestroy()},z$r.onDestroy=function(){}}();z$u.__init([z$P])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}}),function(z$_,z$V,z$d){z$d.un,z$d.uns;var z$S=z$d.static,z$G=z$d.class,z$q=z$d.getset,z$s=z$d.__newvec,z$L=laya.maths.Arith,z$R=laya.webgl.atlas.AtlasResourceManager,z$r=laya.webgl.shader.BaseShader,z$E=laya.utils.Browser,z$T=laya.webgl.utils.Buffer,z$k=laya.utils.Byte,z$p=laya.utils.ClassUtils,z$N=z$d.Config,z$c=(laya.events.Event,laya.events.EventDispatcher),z$Q=laya.utils.Handler,z$l=laya.net.Loader,z$U=laya.net.LoaderManager,z$t=(laya.maths.MathUtil,laya.display.Node),z$u=laya.renders.Render,z$b=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),z$h=laya.resource.Resource,z$W=laya.utils.RunDriver,z$O=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),z$y=laya.display.Sprite,z$D=laya.utils.Stat,z$n=laya.utils.StringKey,z$H=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),z$I=laya.utils.Utils,z$w=laya.webgl.WebGL,z$z=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;z$d.interface("laya.d3.core.IClone"),z$d.interface("laya.d3.graphics.IVertex"),z$d.interface("laya.d3.core.render.IUpdate"),z$d.interface("laya.d3.core.scene.ITreeNode"),z$d.interface("laya.d3.core.render.IRenderable");(function(){function z$a(){}z$G(z$a,"laya.d3.animation.AnimationClipParser01"),z$a.READ_DATA=function(){z$a._DATA.offset=z$a._reader.getUint32(),z$a._DATA.size=z$a._reader.getUint32()},z$a.READ_BLOCK=function(){for(var z$V=z$a._BLOCK.count=z$a._reader.getUint16(),z$U=z$a._BLOCK.blockStarts=[],z$r=z$a._BLOCK.blockLengths=[],z$s=0;z$s<z$V;z$s++)z$U.push(z$a._reader.getUint32()),z$r.push(z$a._reader.getUint32())},z$a.READ_STRINGS=function(){var z$V=z$a._reader.getUint32(),z$U=z$a._reader.getUint16(),z$r=z$a._reader.pos;z$a._reader.pos=z$V+z$a._DATA.offset;for(var z$s=0;z$s<z$U;z$s++)z$a._strings[z$s]=z$a._reader.readUTFString();z$a._reader.pos=z$r},z$a.parse=function(z$V,z$U){z$a._animationClip=z$V;(z$a._reader=z$U).__getBuffer();z$a.READ_DATA(),z$a.READ_BLOCK(),z$a.READ_STRINGS();for(var z$r=0,z$s=z$a._BLOCK.count;z$r<z$s;z$r++){var z$p=z$U.getUint16(),z$c=z$a._strings[z$p],z$R=z$a["READ_"+z$c];if(null==z$R)throw new Error("model file err,no this function:"+z$p+" "+z$c);z$R.call()}},z$a.READ_ANIMATIONS=function(){var z$V,z$U=0,z$r=0,z$s=z$a._reader,z$p=z$s.__getBuffer(),z$c=[],z$R=z$s.getUint8();for(z$c.length=z$R,z$U=0;z$U<z$R;z$U++)z$c[z$U]=z$s.getUint16();var z$T=[],z$N=z$s.getUint16();for(z$T.length=z$N,z$U=0;z$U<z$N;z$U++)z$T[z$U]=z$s.getFloat32();var z$t=z$a._animationClip;z$t.name=z$a._strings[z$s.getUint16()];var z$b=z$t._duration=z$s.getFloat32();z$t.islooping=!!z$s.getByte(),z$t._frameRate=z$s.getInt16();var z$S=z$s.getInt16(),z$_=z$t._nodes=new Array;z$_.length=z$S,(z$t._publicClipDatas=[]).length=z$S;var z$G=z$t._nodesMap={},z$q=0,z$u=0;for(z$U=0;z$U<z$S;z$U++){z$V=z$_[z$U]=new z$B;var z$h=z$s.getUint16(),z$l=z$V.path=[];for(z$l.length=z$h,z$r=0;z$r<z$h;z$r++)z$l[z$r]=z$a._strings[z$s.getUint16()];var z$W=z$l.join("/"),z$O=z$G[z$W];z$O||(z$G[z$W]=z$O=[]),z$O.push(z$V);var z$L=z$s.getInt16();-1!==z$L&&(z$V.componentType=z$a._strings[z$L]);var z$d=z$J._propertyIndexDic[z$a._strings[z$s.getUint16()]];if(null==z$d)throw new Error("AnimationClipParser01:unknown property name.");var z$k=z$d<4,z$y=!z$k||z$k&&""===z$l[0];(z$V._cacheProperty=z$y)?z$q++:z$u++,z$V.propertyNameID=z$d;var z$D=z$c[z$s.getUint8()];z$V.keyFrameWidth=z$D/4;var z$n=z$V.keyFrames=[],z$I=z$n.length=z$s.getUint16(),z$Q=null,z$H=NaN;for(z$r=0;z$r<z$I;z$r++){var z$w=z$n[z$r]=new z$i;z$H=z$w.startTime=z$T[z$s.getUint16()];var z$z=z$s.pos;z$w.inTangent=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$z=z$s.pos,z$w.outTangent=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$z=z$s.pos,z$w.data=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$Q&&(z$Q.next=z$w,z$Q.duration=z$H-z$Q.startTime),z$Q=z$w}z$w.next=null,z$w.duration=z$b-z$H}var z$E=z$t._nodeToCachePropertyMap=new Int32Array(z$S),z$K=z$t._cachePropertyMap=new Int32Array(z$q),z$m=z$t._unCachePropertyMap=new Int32Array(z$u);for(z$q=z$u=0,z$U=0;z$U<z$S;z$U++)(z$V=z$_[z$U])._cacheProperty?(z$E[z$U]=z$q,z$K[z$q++]=z$U):z$m[z$u++]=z$U},z$a._animationClip=null,z$a._reader=null,z$a._strings=[],z$S(z$a,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function z$j(){}z$G(z$j,"laya.d3.animation.AnimationClipParser02"),z$j.READ_DATA=function(){z$j._DATA.offset=z$j._reader.getUint32(),z$j._DATA.size=z$j._reader.getUint32()},z$j.READ_BLOCK=function(){for(var z$V=z$j._BLOCK.count=z$j._reader.getUint16(),z$U=z$j._BLOCK.blockStarts=[],z$r=z$j._BLOCK.blockLengths=[],z$s=0;z$s<z$V;z$s++)z$U.push(z$j._reader.getUint32()),z$r.push(z$j._reader.getUint32())},z$j.READ_STRINGS=function(){var z$V=z$j._reader.getUint32(),z$U=z$j._reader.getUint16(),z$r=z$j._reader.pos;z$j._reader.pos=z$V+z$j._DATA.offset;for(var z$s=0;z$s<z$U;z$s++)z$j._strings[z$s]=z$j._reader.readUTFString();z$j._reader.pos=z$r},z$j.parse=function(z$V,z$U){z$j._animationClip=z$V;(z$j._reader=z$U).__getBuffer();z$j.READ_DATA(),z$j.READ_BLOCK(),z$j.READ_STRINGS();for(var z$r=0,z$s=z$j._BLOCK.count;z$r<z$s;z$r++){var z$p=z$U.getUint16(),z$c=z$j._strings[z$p],z$R=z$j["READ_"+z$c];if(null==z$R)throw new Error("model file err,no this function:"+z$p+" "+z$c);z$R.call()}},z$j.READ_ANIMATIONS=function(){var z$V,z$U=0,z$r=0,z$s=z$j._reader,z$p=z$s.__getBuffer(),z$c=[],z$R=z$s.getUint8();for(z$c.length=z$R,z$U=0;z$U<z$R;z$U++)z$c[z$U]=z$s.getUint16();var z$T=[],z$N=z$s.getUint16();for(z$T.length=z$N,z$U=0;z$U<z$N;z$U++)z$T[z$U]=z$s.getFloat32();var z$t=z$j._animationClip;z$t.name=z$j._strings[z$s.getUint16()];var z$b=z$t._duration=z$s.getFloat32();z$t.islooping=!!z$s.getByte(),z$t._frameRate=z$s.getInt16();var z$S=z$s.getInt16(),z$_=z$t._nodes=new Array;z$_.length=z$S,(z$t._publicClipDatas=[]).length=z$S;var z$G=z$t._nodesMap={},z$q=0,z$u=0;for(z$U=0;z$U<z$S;z$U++){z$V=z$_[z$U]=new z$B;var z$h=z$s.getUint16(),z$l=z$V.path=[];for(z$l.length=z$h,z$r=0;z$r<z$h;z$r++)z$l[z$r]=z$j._strings[z$s.getUint16()];var z$W=z$l.join("/"),z$O=z$G[z$W];z$O||(z$G[z$W]=z$O=[]),z$O.push(z$V);var z$L=z$s.getInt16();-1!==z$L&&(z$V.componentType=z$j._strings[z$L]);var z$d=z$J._propertyIndexDic[z$j._strings[z$s.getUint16()]];if(null==z$d)throw new Error("AnimationClipParser02:unknown property name.");var z$k=z$d<4,z$y=!z$k||z$k&&""===z$l[0];(z$V._cacheProperty=z$y)?z$q++:z$u++,z$V.propertyNameID=z$d;var z$D=z$c[z$s.getUint8()];z$V.keyFrameWidth=z$D/4;var z$n=z$V.keyFrames=[],z$I=z$n.length=z$s.getUint16(),z$Q=null,z$H=NaN;for(z$r=0;z$r<z$I;z$r++){var z$w=z$n[z$r]=new z$i;z$H=z$w.startTime=z$T[z$s.getUint16()];var z$z=z$s.pos;z$w.inTangent=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$z=z$s.pos,z$w.outTangent=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$z=z$s.pos,z$w.data=new Float32Array(z$p.slice(z$z,z$z+z$D)),z$s.pos+=z$D,z$Q&&(z$Q.next=z$w,z$Q.duration=z$H-z$Q.startTime),z$Q=z$w}z$w.next=null,z$w.duration=z$b-z$H}var z$E=z$s.getUint16();for(z$U=0;z$U<z$E;z$U++){var z$K,z$m=new z$o;z$m.time=z$s.getFloat32(),z$m.eventName=z$j._strings[z$s.getUint16()];var z$a=z$s.getUint16();for(0<z$a&&(z$m.params=z$K=[]),z$r=0;z$r<z$a;z$r++){switch(z$s.getByte()){case 0:z$K.push(!!z$s.getByte());break;case 1:z$K.push(z$s.getInt32());break;case 2:z$K.push(z$s.getFloat32());break;case 3:z$K.push(z$j._strings[z$s.getUint16()]);break;default:throw new Error("unknown type.")}}z$t.addEvent(z$m)}var z$Z=z$t._nodeToCachePropertyMap=new Int32Array(z$S),z$x=z$t._cachePropertyMap=new Int32Array(z$q),z$$=z$t._unCachePropertyMap=new Int32Array(z$u);for(z$q=z$u=0,z$U=0;z$U<z$S;z$U++)(z$V=z$_[z$U])._cacheProperty?(z$Z[z$U]=z$q,z$x[z$q++]=z$U):z$$[z$u++]=z$U},z$j._animationClip=null,z$j._reader=null,z$j._strings=[],z$S(z$j,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var z$o=function(){function z$V(){this.time=NaN,this.eventName=null,this.params=null}return z$G(z$V,"laya.d3.animation.AnimationEvent"),z$V}(),z$J=function(){function z$s(){this._childs=[],this.transform=new z$WU(this)}z$G(z$s,"laya.d3.animation.AnimationNode");var z$V=z$s.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.addChild=function(z$V){z$V._parent=this,z$V.transform.setParent(this.transform),this._childs.push(z$V)},z$V.removeChild=function(z$V){var z$U=this._childs.indexOf(z$V);-1!==z$U&&this._childs.splice(z$U,1)},z$V.getChildByName=function(z$V){for(var z$U=0,z$r=this._childs.length;z$U<z$r;z$U++){var z$s=this._childs[z$U];if(z$s.name===z$V)return z$s}return null},z$V.getChildByIndex=function(z$V){return this._childs[z$V]},z$V.getChildCount=function(){return this._childs.length},z$V.cloneTo=function(z$V){var z$U=z$V;z$U.name=this.name;for(var z$r=0,z$s=this._childs.length;z$r<z$s;z$r++){var z$p=this._childs[z$r],z$c=z$p.clone();z$U.addChild(z$c);var z$R=z$p.transform,z$T=z$c.transform;z$T.setLocalPosition(z$R.getLocalPosition()),z$T.setLocalRotation(z$R.getLocalRotation()),z$T.setLocalScale(z$R.getLocalScale()),z$T._localRotationEuler=z$R._localRotationEuler,z$T._setWorldMatrixIgnoreUpdate(z$R.getWorldMatrix())}},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$s.__init__=function(){z$s.registerAnimationNodeProperty("localPosition",z$s._getLocalPosition,z$s._setLocalPosition),z$s.registerAnimationNodeProperty("localRotation",z$s._getLocalRotation,z$s._setLocalRotation),z$s.registerAnimationNodeProperty("localScale",z$s._getLocalScale,z$s._setLocalScale),z$s.registerAnimationNodeProperty("localRotationEuler",z$s._getLocalRotationEuler,z$s._setLocalRotationEuler),z$s.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",z$s._getParticleRenderSharedMaterialTintColor,z$s._setParticleRenderSharedMaterialTintColor),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",z$s._getMeshRenderSharedMaterialTilingOffset,z$s._setMeshRenderSharedMaterialTilingOffset),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",z$s._getMeshRenderSharedMaterialAlbedo,z$s._setMeshRenderSharedMaterialAlbedo),z$s.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",z$s._getSkinnedMeshRenderSharedMaterialTilingOffset,z$s._setSkinnedMeshRenderSharedMaterialTilingOffset),z$s.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",z$s._getSkinnedMeshRenderSharedMaterialAlbedo,z$s._setSkinnedMeshRenderSharedMaterialAlbedo),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",z$s._getMeshRenderSharedMaterialAlbedo,z$s._setMeshRenderSharedMaterialAlbedo),z$s.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",z$s._getSkinnedMeshRenderSharedMaterialAlbedo,z$s._setSkinnedMeshRenderSharedMaterialAlbedo),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",z$s._getMeshRenderSharedMaterialIntensity,z$s._setMeshRenderSharedMaterialIntensity),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",z$s._getMeshRenderSharedMaterialAlpha,z$s._setMeshRenderSharedMaterialAlpha),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",z$s._getMeshRenderSharedMaterialAlphaColor,z$s._setMeshRenderSharedMaterialAlphaColor),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",z$s._getMeshRenderSharedMaterialBaseColor,z$s._setMeshRenderSharedMaterialBaseColor),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",z$s._getMeshRenderSharedMaterialDissolve,z$s._setMeshRenderSharedMaterialDissolve),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",z$s._getMeshRenderSharedMaterialDissolveSpeed,z$s._setMeshRenderSharedMaterialDissolveSpeed),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",z$s._getMeshRenderSharedMaterialMMultiplier,z$s._setMeshRenderSharedMaterialMMultiplier),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",z$s._getMeshRenderSharedMaterialBaseScrollSpeedX,z$s._setMeshRenderSharedMaterialBaseScrollSpeedX),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",z$s._getMeshRenderSharedMaterialBaseScrollSpeedY,z$s._setMeshRenderSharedMaterialBaseScrollSpeedY),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",z$s._getMeshRenderSharedMaterialSecondScrollSpeedX,z$s._setMeshRenderSharedMaterialSecondScrollSpeedX),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",z$s._getMeshRenderSharedMaterialSecondScrollSpeedY,z$s._setMeshRenderSharedMaterialSecondScrollSpeedY),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",z$s._getMeshRenderSharedMaterialDetailTilingOffset,z$s._setMeshRenderSharedMaterialDetailTilingOffset),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",z$s._getMeshRenderSharedMaterialDissolveTilingOffset,z$s._setMeshRenderSharedMaterialDissolveTilingOffset),z$s.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",z$s._getMeshRenderSharedMaterialMaskTilingOffset,z$s._setMeshRenderSharedMaterialMaskTilingOffset)},z$s.registerAnimationNodeProperty=function(z$V,z$U,z$r){if(z$s._propertyIndexDic[z$V])throw new Error("AnimationNode: this propertyName has registered.");z$s._propertyIndexDic[z$V]=z$s._propertyIDCounter,z$s._propertyGetFuncs[z$s._propertyIDCounter]=z$U,z$s._propertySetFuncs[z$s._propertyIDCounter]=z$r,z$s._propertyIDCounter++},z$s._getLocalPosition=function(z$V,z$U){return z$V?z$V.transform.getLocalPosition():z$U._transform.localPosition.elements},z$s._setLocalPosition=function(z$V,z$U,z$r){if(z$V)z$V.transform.setLocalPosition(z$r);else{var z$s=z$U._transform,z$p=z$s.localPosition;z$p.elements=z$r,z$s.localPosition=z$p}},z$s._getLocalRotation=function(z$V,z$U){return z$V?z$V.transform.getLocalRotation():z$U._transform.localRotation.elements},z$s._setLocalRotation=function(z$V,z$U,z$r){if(z$V)z$V.transform.setLocalRotation(z$r);else{var z$s=z$U._transform,z$p=z$s.localRotation;z$p.elements=z$r,z$s.localRotation=z$p}},z$s._getLocalScale=function(z$V,z$U){return z$V?z$V.transform.getLocalScale():z$U._transform.localScale.elements},z$s._setLocalScale=function(z$V,z$U,z$r){if(z$V)z$V.transform.setLocalScale(z$r);else{var z$s=z$U._transform,z$p=z$s.localScale;z$p.elements=z$r,z$s.localScale=z$p}},z$s._getLocalRotationEuler=function(z$V,z$U){return z$V?z$V.transform.getLocalRotationEuler():z$U._transform.localRotationEuler.elements},z$s._setLocalRotationEuler=function(z$V,z$U,z$r){if(z$V)z$V.transform.setLocalRotationEuler(z$r);else{var z$s=z$U._transform,z$p=z$s.localRotationEuler;z$p.elements=z$r,z$s.localRotationEuler=z$p}},z$s._getMeshRenderSharedMaterialTilingOffset=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return z$U.meshRender.sharedMaterial.tilingOffset.elements},z$s._setMeshRenderSharedMaterialTilingOffset=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).tilingOffset).elements=z$r,z$s.tilingOffset=z$p)}else(z$p=(z$s=z$U.meshRender.material).tilingOffset).elements=z$r,z$s.tilingOffset=z$p},z$s._getMeshRenderSharedMaterialAlbedo=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.albedoColor.elements:null}return z$U.meshRender.sharedMaterial.albedoColor.elements},z$s._setMeshRenderSharedMaterialAlbedo=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).albedoColor).elements=z$r,z$s.albedoColor=z$p)}else(z$p=(z$s=z$U.meshRender.material).albedoColor).elements=z$r,z$s.albedoColor=z$p},z$s._getSkinnedMeshRenderSharedMaterialTilingOffset=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return z$U.skinnedMeshRender.sharedMaterial.tilingOffset.elements},z$s._setSkinnedMeshRenderSharedMaterialTilingOffset=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.skinnedMeshRender.material).tilingOffset).elements=z$r,z$s.tilingOffset=z$p)}else(z$p=(z$s=z$U.skinnedMeshRender.material).tilingOffset).elements=z$r,z$s.tilingOffset=z$p},z$s._getSkinnedMeshRenderSharedMaterialAlbedo=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return z$U.skinnedMeshRender.sharedMaterial.albedoColor.elements},z$s._setSkinnedMeshRenderSharedMaterialAlbedo=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.skinnedMeshRender.material).albedoColor).elements=z$r,z$s.albedoColor=z$p)}else(z$p=(z$s=z$U.skinnedMeshRender.material).albedoColor).elements=z$r,z$s.albedoColor=z$p},z$s._getParticleRenderSharedMaterialTintColor=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.particleRender.sharedMaterial.tintColor.elements:null}return z$U.particleRender.sharedMaterial.tintColor.elements},z$s._setParticleRenderSharedMaterialTintColor=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.particleRender.material).tintColor).elements=z$r,z$s.tintColor=z$p)}else(z$p=(z$s=z$U.particleRender.material).tintColor).elements=z$r,z$s.tintColor=z$p},z$s._getMeshRenderSharedMaterialAlphaColor=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.alphaColor.elements:null}return z$U.meshRender.sharedMaterial.alphaColor.elements},z$s._setMeshRenderSharedMaterialAlphaColor=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).alphaColor).elements=z$r,z$s.alphaColor=z$p)}else(z$p=(z$s=z$U.meshRender.material).alphaColor).elements=z$r,z$s.alphaColor=z$p},z$s._getMeshRenderSharedMaterialBaseColor=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.baseColor.elements:null}return z$U.meshRender.sharedMaterial.baseColor.elements},z$s._setMeshRenderSharedMaterialBaseColor=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).baseColor).elements=z$r,z$s.baseColor=z$p)}else(z$p=(z$s=z$U.meshRender.material).baseColor).elements=z$r,z$s.baseColor=z$p},z$s._getMeshRenderSharedMaterialDissolve=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.dissolve:0}return z$U.meshRender.sharedMaterial.dissolve},z$s._setMeshRenderSharedMaterialDissolve=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.dissolve=z$r[0])}else z$U.meshRender.material.dissolve=z$r[0]},z$s._getMeshRenderSharedMaterialDissolveSpeed=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.dissolveSpeed:0}return z$U.meshRender.sharedMaterial.dissolveSpeed},z$s._setMeshRenderSharedMaterialDissolveSpeed=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.dissolveSpeed=z$r[0])}else z$U.meshRender.material.dissolveSpeed=z$r[0]},z$s._getMeshRenderSharedMaterialMMultiplier=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.mMultiplier:0}return z$U.meshRender.sharedMaterial.mMultiplier},z$s._setMeshRenderSharedMaterialMMultiplier=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.mMultiplier=z$r[0])}else z$U.meshRender.material.mMultiplier=z$r[0]},z$s._getMeshRenderSharedMaterialBaseScrollSpeedX=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return z$U.meshRender.sharedMaterial.baseScrollSpeedX},z$s._setMeshRenderSharedMaterialBaseScrollSpeedX=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.baseScrollSpeedX=z$r[0])}else z$U.meshRender.material.baseScrollSpeedX=z$r[0]},z$s._getMeshRenderSharedMaterialBaseScrollSpeedY=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return z$U.meshRender.sharedMaterial.baseScrollSpeedY},z$s._setMeshRenderSharedMaterialBaseScrollSpeedY=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.baseScrollSpeedY=z$r[0])}else z$U.meshRender.material.baseScrollSpeedY=z$r[0]},z$s._getMeshRenderSharedMaterialSecondScrollSpeedX=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return z$U.meshRender.sharedMaterial.secondScrollSpeedX},z$s._setMeshRenderSharedMaterialSecondScrollSpeedX=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.secondScrollSpeedX=z$r[0])}else z$U.meshRender.material.secondScrollSpeedX=z$r[0]},z$s._getMeshRenderSharedMaterialSecondScrollSpeedY=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return z$U.meshRender.sharedMaterial.secondScrollSpeedY},z$s._setMeshRenderSharedMaterialSecondScrollSpeedY=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.secondScrollSpeedY=z$r[0])}else z$U.meshRender.material.secondScrollSpeedY=z$r[0]},z$s._getMeshRenderSharedMaterialAlpha=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.alpha:0}return z$U.meshRender.sharedMaterial.alpha},z$s._setMeshRenderSharedMaterialAlpha=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.alpha=z$r[0])}else z$U.meshRender.material.alpha=z$r[0]},z$s._getMeshRenderSharedMaterialIntensity=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.intensity:0}return z$U.meshRender.sharedMaterial.intensity},z$s._setMeshRenderSharedMaterialIntensity=function(z$V,z$U,z$r){if(z$V){var z$s=z$V.transform._entity;z$s&&(z$s.owner.meshRender.material.intensity=z$r[0])}else z$U.meshRender.material.intensity=z$r[0]},z$s._getMeshRenderSharedMaterialDetailTilingOffset=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return z$U.meshRender.sharedMaterial.detailTilingOffset.elements},z$s._setMeshRenderSharedMaterialDetailTilingOffset=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).detailTilingOffset).elements=z$r,z$s.detailTilingOffset=z$p)}else(z$p=(z$s=z$U.meshRender.material).detailTilingOffset).elements=z$r,z$s.detailTilingOffset=z$p},z$s._getMeshRenderSharedMaterialDissolveTilingOffset=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return z$U.meshRender.sharedMaterial.dissolveTilingOffset.elements},z$s._setMeshRenderSharedMaterialDissolveTilingOffset=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).dissolveTilingOffset).elements=z$r,z$s.dissolveTilingOffset=z$p)}else(z$p=(z$s=z$U.meshRender.material).dissolveTilingOffset).elements=z$r,z$s.dissolveTilingOffset=z$p},z$s._getMeshRenderSharedMaterialMaskTilingOffset=function(z$V,z$U){if(z$V){var z$r=z$V.transform._entity;return z$r?z$r.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return z$U.meshRender.sharedMaterial.maskTilingOffset.elements},z$s._setMeshRenderSharedMaterialMaskTilingOffset=function(z$V,z$U,z$r){var z$s,z$p;if(z$V){var z$c=z$V.transform._entity;z$c&&((z$p=(z$s=z$c.owner.meshRender.material).maskTilingOffset).elements=z$r,z$s.maskTilingOffset=z$p)}else(z$p=(z$s=z$U.meshRender.material).maskTilingOffset).elements=z$r,z$s.maskTilingOffset=z$p},z$s._propertyIDCounter=0,z$s._propertyIndexDic={},z$s._propertySetFuncs=[],z$s._propertyGetFuncs=[],z$s}(),z$i=function(){function z$V(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return z$G(z$V,"laya.d3.animation.Keyframe"),z$V}(),z$B=function(){function z$V(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return z$G(z$V,"laya.d3.animation.KeyframeNode"),z$V}(),z$K=(function(){function z$V(){this._tempVector30=new z$RU,this._tempVector31=new z$RU,this._tempVector32=new z$RU,this._a=new z$RU,this._b=new z$RU,this._c=new z$RU,this._d=new z$RU}z$G(z$V,"laya.d3.core.glitter.SplineCurvePositionVelocity");var z$U=z$V.prototype;z$U.Init=function(z$V,z$U,z$r,z$s){z$V.cloneTo(this._d),z$U.cloneTo(this._c),z$RU.scale(z$V,2,this._a),z$RU.scale(z$r,2,this._tempVector30),z$RU.subtract(this._a,this._tempVector30,this._a),z$RU.add(this._a,z$U,this._a),z$RU.add(this._a,z$s,this._a),z$RU.scale(z$r,3,this._b),z$RU.scale(z$V,3,this._tempVector30),z$RU.subtract(this._b,this._tempVector30,this._b),z$RU.subtract(this._b,z$s,this._b),z$RU.scale(z$U,2,this._tempVector30),z$RU.subtract(this._b,this._tempVector30,this._b)},z$U.Slerp=function(z$V,z$U){z$RU.scale(this._a,z$V*z$V*z$V,this._tempVector30),z$RU.scale(this._b,z$V*z$V,this._tempVector31),z$RU.scale(this._c,z$V,this._tempVector32),z$RU.add(this._tempVector30,this._tempVector31,z$U),z$RU.add(z$U,this._tempVector32,z$U),z$RU.add(z$U,this._d,z$U)}}(),function(){function z$x(z$V,z$U,z$r,z$s){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=z$V,this._h=z$U,this._minHeight=z$r,this._maxHeight=z$s}z$G(z$x,"laya.d3.core.HeightMap");var z$V=z$x.prototype;z$V._inBounds=function(z$V,z$U){return 0<=z$V&&z$V<this._h&&0<=z$U&&z$U<this._w},z$V.getHeight=function(z$V,z$U){return this._inBounds(z$V,z$U)?this._datas[z$V][z$U]:NaN},z$q(0,z$V,"width",function(){return this._w}),z$q(0,z$V,"height",function(){return this._h}),z$q(0,z$V,"maxHeight",function(){return this._maxHeight}),z$q(0,z$V,"minHeight",function(){return this._minHeight}),z$x.creatFromMesh=function(z$V,z$U,z$r,z$s){for(var z$p=[],z$c=[],z$R=z$V.getSubMeshCount(),z$T=0;z$T<z$R;z$T++){for(var z$N=z$V.getSubMesh(z$T),z$t=z$N._getVertexBuffer(),z$b=z$t.getData(),z$S=[],z$_=0;z$_<z$b.length;z$_+=z$t.vertexDeclaration.vertexStride/4){var z$G=new z$RU(z$b[z$_+0],z$b[z$_+1],z$b[z$_+2]);z$S.push(z$G)}z$p.push(z$S);var z$q=z$N._getIndexBuffer();z$c.push(z$q.getData())}var z$u=z$V.boundingBox,z$h=z$u.min.x,z$l=z$u.min.z,z$W=z$u.max.x,z$O=z$u.max.z,z$L=z$u.min.y,z$d=z$u.max.y,z$k=z$W-z$h,z$y=z$O-z$l,z$D=z$s.elements[0]=z$k/(z$U-1),z$n=z$s.elements[1]=z$y/(z$r-1),z$I=new z$x(z$U,z$r,z$L,z$d),z$Q=z$x._tempRay,z$H=z$Q.direction.elements;z$H[0]=0,z$H[1]=-1,z$H[2]=0;var z$w=z$d+.1;z$Q.origin.elements[1]=z$w;for(var z$z=0;z$z<z$r;z$z++){var z$E=z$l+z$z*z$n;z$I._datas[z$z]=[];for(var z$K=0;z$K<z$U;z$K++){var z$m=z$h+z$K*z$D,z$a=z$Q.origin.elements;z$a[0]=z$m,z$a[2]=z$E;var z$Z=z$x._getPosition(z$Q,z$p,z$c);z$I._datas[z$z][z$K]=z$Z===Number.MAX_VALUE?NaN:z$w-z$Z}}return z$I},z$x.createFromImage=function(z$V,z$U,z$r){for(var z$s=z$V.width,z$p=z$V.height,z$c=new z$x(z$s,z$p,z$U,z$r),z$R=(z$r-z$U)/254,z$T=z$V.getPixels(),z$N=0,z$t=0;z$t<z$p;z$t++)for(var z$b=z$c._datas[z$t]=[],z$S=0;z$S<z$s;z$S++){var z$_=z$T[z$N++],z$G=z$T[z$N++],z$q=z$T[z$N++],z$u=z$T[z$N++];z$b[z$S]=255==z$_&&255==z$G&&255==z$q&&255==z$u?NaN:(z$_+z$G+z$q)/3*z$R+z$U}return z$c},z$x._getPosition=function(z$V,z$U,z$r){for(var z$s=Number.MAX_VALUE,z$p=0;z$p<z$U.length;z$p++)for(var z$c=z$U[z$p],z$R=z$r[z$p],z$T=0;z$T<z$R.length;z$T+=3){var z$N=z$c[z$R[z$T+0]],z$t=z$c[z$R[z$T+1]],z$b=z$c[z$R[z$T+2]],z$S=z$qU.rayIntersectsTriangle(z$V,z$N,z$t,z$b);!isNaN(z$S)&&z$S<z$s&&(z$s=z$S)}return z$s},z$S(z$x,["_tempRay",function(){return this._tempRay=new z$pU(new z$RU,new z$RU)}])}(),function(){function z$p(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}z$G(z$p,"laya.d3.core.Layer");var z$V=z$p.prototype;return z$V._binarySearchIndex=function(){for(var z$V=0,z$U=z$p._collsionTestList.length-1,z$r=0;z$V<=z$U;){z$r=Math.floor((z$V+z$U)/2);var z$s=z$p._collsionTestList[z$r];if(z$s==this._number)return z$r;z$s>this._number?z$U=z$r-1:z$V=z$r+1}return z$V},z$V._addCollider=function(z$V){0===this._colliders.length&&z$p._collsionTestList.splice(this._binarySearchIndex(),0,this._number),z$V._isRigidbody?(this._colliders.unshift(z$V),this._nonRigidbodyOffset++):this._colliders.push(z$V)},z$V._removeCollider=function(z$V){var z$U=this._colliders.indexOf(z$V);z$U<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(z$U,1),0===this._colliders.length&&z$p._collsionTestList.splice(z$p._collsionTestList.indexOf(this._number),1)},z$q(0,z$V,"number",function(){return this._number}),z$q(0,z$V,"visible",function(){return this._visible},function(z$V){this._visible=z$V,z$p._visibleLayers=z$V?z$p._visibleLayers|this.mask:z$p._visibleLayers&~this.mask}),z$q(0,z$V,"mask",function(){return this._mask}),z$q(1,z$p,"visibleLayers",function(){return z$p._visibleLayers},function(z$V){z$p._visibleLayers=z$V;for(var z$U=0,z$r=z$p._layerList.length;z$U<z$r;z$U++){var z$s=z$p._layerList[z$U];z$s._visible=0!=(z$s._mask&z$p._visibleLayers)}}),z$p.__init__=function(){z$p._layerList.length=31;for(var z$V=0;z$V<31;z$V++){var z$U=new z$p;z$p._layerList[z$V]=z$U,0===z$V?(z$U.name="Default Layer",z$U.visible=!0):(z$U.name="Layer-"+z$V,z$U.visible=!1),z$U._number=z$V,z$U._mask=Math.pow(2,z$V)}z$p.currentCreationLayer=z$p._layerList[0]},z$p.getLayerByNumber=function(z$V){if(z$V<0||30<z$V)throw new Error("无法返回指定Layer，该number超出范围！");return z$p._layerList[z$V]},z$p.getLayerByName=function(z$V){for(var z$U=0;z$U<31;z$U++)if(z$p._layerList[z$U].name===z$V)return z$p._layerList[z$U];throw new Error("无法返回指定Layer,该name不存在")},z$p.isVisible=function(z$V){return 0!=(z$V&z$p._currentCameraCullingMask&z$p._visibleLayers)},z$p._layerList=[],z$p._visibleLayers=2147483647,z$p._collsionTestList=[],z$p._currentCameraCullingMask=2147483647,z$p.maxCount=31,z$p.currentCreationLayer=null,z$p}()),z$m=(function(){function z$V(z$V,z$U,z$r){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=z$V,this._minCount=z$U,this._maxCount=z$r}z$G(z$V,"laya.d3.core.particleShuriKen.module.Burst");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.cloneTo=function(z$V){var z$U=z$V;z$U._time=this._time,z$U._minCount=this._minCount,z$U._maxCount=this._maxCount},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"time",function(){return this._time}),z$q(0,z$U,"minCount",function(){return this._minCount}),z$q(0,z$U,"maxCount",function(){return this._maxCount})}(),function(){function z$V(z$V){this._color=null,this.enbale=!1,this._color=z$V}z$G(z$V,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var z$U=z$V.prototype;z$U.cloneTo=function(z$V){var z$U=z$V;this._color.cloneTo(z$U._color),z$U.enbale=this.enbale},z$U.clone=function(){var z$V;switch(this._color.type){case 0:z$V=z$Z.createByConstant(this._color.constant.clone());break;case 1:z$V=z$Z.createByGradient(this._color.gradient.clone());break;case 2:z$V=z$Z.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:z$V=z$Z.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var z$U=new this.constructor(z$V);return z$U.enbale=this.enbale,z$U},z$q(0,z$U,"color",function(){return this._color})}(),function(){function z$V(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}z$G(z$V,"laya.d3.core.particleShuriKen.module.Emission");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),z$U._destroy=function(){this._bursts=null,this._destroyed=!0},z$U.getBurstsCount=function(){return this._bursts.length},z$U.getBurstByIndex=function(z$V){return this._bursts[z$V]},z$U.addBurst=function(z$V){var z$U=this._bursts.length;if(0<z$U)for(var z$r=0;z$r<z$U;z$r++)this._bursts[z$r].time>z$V.time&&this._bursts.splice(z$r,0,z$V);this._bursts.push(z$V)},z$U.removeBurst=function(z$V){var z$U=this._bursts.indexOf(z$V);-1!==z$U&&this._bursts.splice(z$U,1)},z$U.removeBurstByIndex=function(z$V){this._bursts.splice(z$V,1)},z$U.clearBurst=function(){this._bursts.length=0},z$U.cloneTo=function(z$V){var z$U=z$V,z$r=z$U._bursts;z$r.length=this._bursts.length;for(var z$s=0,z$p=this._bursts.length;z$s<z$p;z$s++){var z$c=z$r[z$s];z$c?this._bursts[z$s].cloneTo(z$c):z$r[z$s]=this._bursts[z$s].clone()}z$U._emissionRate=this._emissionRate,z$U.enbale=this.enbale},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"destroyed",function(){return this._destroyed}),z$q(0,z$U,"emissionRate",function(){return this._emissionRate},function(z$V){if(z$V<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=z$V})}(),function(){function z$s(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}z$G(z$s,"laya.d3.core.particleShuriKen.module.FrameOverTime");var z$V=z$s.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,z$U._constant=this._constant,this._overTime.cloneTo(z$U._overTime),z$U._constantMin=this._constantMin,z$U._constantMax=this._constantMax,this._overTimeMin.cloneTo(z$U._overTimeMin),this._overTimeMax.cloneTo(z$U._overTimeMax)},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"frameOverTimeData",function(){return this._overTime}),z$q(0,z$V,"constant",function(){return this._constant}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"frameOverTimeDataMin",function(){return this._overTimeMin}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"frameOverTimeDataMax",function(){return this._overTimeMax}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$s.createByConstant=function(z$V){var z$U=new z$s;return z$U._type=0,z$U._constant=z$V,z$U},z$s.createByOverTime=function(z$V){var z$U=new z$s;return z$U._type=1,z$U._overTime=z$V,z$U},z$s.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$s;return z$r._type=2,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$s.createByRandomTwoOverTime=function(z$V,z$U){var z$r=new z$s;return z$r._type=3,z$r._overTimeMin=z$V,z$r._overTimeMax=z$U,z$r},z$s}()),z$a=function(){function z$t(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}z$G(z$t,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var z$V=z$t.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,z$U._separateAxes=this._separateAxes,z$U._constant=this._constant,this._constantSeparate.cloneTo(z$U._constantSeparate),this._gradient.cloneTo(z$U._gradient),this._gradientX.cloneTo(z$U._gradientX),this._gradientY.cloneTo(z$U._gradientY),this._gradientZ.cloneTo(z$U._gradientZ),z$U._constantMin=this._constantMin,z$U._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(z$U._constantMinSeparate),this._constantMaxSeparate.cloneTo(z$U._constantMaxSeparate),this._gradientMin.cloneTo(z$U._gradientMin),this._gradientMax.cloneTo(z$U._gradientMax),this._gradientXMin.cloneTo(z$U._gradientXMin),this._gradientXMax.cloneTo(z$U._gradientXMax),this._gradientYMin.cloneTo(z$U._gradientYMin),this._gradientYMax.cloneTo(z$U._gradientYMax),this._gradientZMin.cloneTo(z$U._gradientZMin),this._gradientZMax.cloneTo(z$U._gradientZMax)},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"gradientZ",function(){return this._gradientZ}),z$q(0,z$V,"constant",function(){return this._constant}),z$q(0,z$V,"gradient",function(){return this._gradient}),z$q(0,z$V,"separateAxes",function(){return this._separateAxes}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"constantSeparate",function(){return this._constantSeparate}),z$q(0,z$V,"gradientX",function(){return this._gradientX}),z$q(0,z$V,"gradientY",function(){return this._gradientY}),z$q(0,z$V,"gradientW",function(){return this._gradientW}),z$q(0,z$V,"gradientMin",function(){return this._gradientMin}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"gradientMax",function(){return this._gradientMax}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$q(0,z$V,"gradientWMin",function(){return this._gradientWMin}),z$q(0,z$V,"constantMinSeparate",function(){return this._constantMinSeparate}),z$q(0,z$V,"constantMaxSeparate",function(){return this._constantMaxSeparate}),z$q(0,z$V,"gradientXMin",function(){return this._gradientXMin}),z$q(0,z$V,"gradientXMax",function(){return this._gradientXMax}),z$q(0,z$V,"gradientWMax",function(){return this._gradientWMax}),z$q(0,z$V,"gradientYMin",function(){return this._gradientYMin}),z$q(0,z$V,"gradientYMax",function(){return this._gradientYMax}),z$q(0,z$V,"gradientZMin",function(){return this._gradientZMin}),z$q(0,z$V,"gradientZMax",function(){return this._gradientZMax}),z$t.createByConstant=function(z$V){var z$U=new z$t;return z$U._type=0,z$U._separateAxes=!1,z$U._constant=z$V,z$U},z$t.createByConstantSeparate=function(z$V){var z$U=new z$t;return z$U._type=0,z$U._separateAxes=!0,z$U._constantSeparate=z$V,z$U},z$t.createByGradient=function(z$V){var z$U=new z$t;return z$U._type=1,z$U._separateAxes=!1,z$U._gradient=z$V,z$U},z$t.createByGradientSeparate=function(z$V,z$U,z$r,z$s){var z$p=new z$t;return z$p._type=1,z$p._separateAxes=!0,z$p._gradientX=z$V,z$p._gradientY=z$U,z$p._gradientZ=z$r,z$p._gradientW=z$s,z$p},z$t.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$t;return z$r._type=2,z$r._separateAxes=!1,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$t.createByRandomTwoConstantSeparate=function(z$V,z$U){var z$r=new z$t;return z$r._type=2,z$r._separateAxes=!0,z$r._constantMinSeparate=z$V,z$r._constantMaxSeparate=z$U,z$r},z$t.createByRandomTwoGradient=function(z$V,z$U){var z$r=new z$t;return z$r._type=3,z$r._separateAxes=!1,z$r._gradientMin=z$V,z$r._gradientMax=z$U,z$r},z$t.createByRandomTwoGradientSeparate=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){var z$N=new z$t;return z$N._type=3,z$N._separateAxes=!0,z$N._gradientXMin=z$V,z$N._gradientXMax=z$U,z$N._gradientYMin=z$r,z$N._gradientYMax=z$s,z$N._gradientZMin=z$p,z$N._gradientZMax=z$c,z$N._gradientWMin=z$R,z$N._gradientWMax=z$T,z$N},z$t}(),z$Z=function(){function z$s(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}z$G(z$s,"laya.d3.core.particleShuriKen.module.GradientColor");var z$V=z$s.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,this._constant.cloneTo(z$U._constant),this._constantMin.cloneTo(z$U._constantMin),this._constantMax.cloneTo(z$U._constantMax),this._gradient.cloneTo(z$U._gradient),this._gradientMin.cloneTo(z$U._gradientMin),this._gradientMax.cloneTo(z$U._gradientMax)},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"gradient",function(){return this._gradient}),z$q(0,z$V,"constant",function(){return this._constant}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"gradientMin",function(){return this._gradientMin}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"gradientMax",function(){return this._gradientMax}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$s.createByConstant=function(z$V){var z$U=new z$s;return z$U._type=0,z$U._constant=z$V,z$U},z$s.createByGradient=function(z$V){var z$U=new z$s;return z$U._type=1,z$U._gradient=z$V,z$U},z$s.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$s;return z$r._type=2,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$s.createByRandomTwoGradient=function(z$V,z$U){var z$r=new z$s;return z$r._type=3,z$r._gradientMin=z$V,z$r._gradientMax=z$U,z$r},z$s}(),z$x=(function(){function z$V(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}z$G(z$V,"laya.d3.core.particleShuriKen.module.GradientDataColor");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.addAlpha=function(z$V,z$U){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==z$V&&(z$V=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=z$V,this._alphaElements[this._alphaCurrentLength++]=z$U):DEBUG},z$U.addRGB=function(z$V,z$U){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==z$V&&(z$V=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=z$V,this._rgbElements[this._rgbCurrentLength++]=z$U.x,this._rgbElements[this._rgbCurrentLength++]=z$U.y,this._rgbElements[this._rgbCurrentLength++]=z$U.z):DEBUG},z$U.cloneTo=function(z$V){var z$U=z$V,z$r=0,z$s=0;z$U._alphaCurrentLength=this._alphaCurrentLength;var z$p=z$U._alphaElements;for(z$p.length=this._alphaElements.length,z$r=0,z$s=this._alphaElements.length;z$r<z$s;z$r++)z$p[z$r]=this._alphaElements[z$r];z$U._rgbCurrentLength=this._rgbCurrentLength;var z$c=z$U._rgbElements;for(z$c.length=this._rgbElements.length,z$r=0,z$s=this._rgbElements.length;z$r<z$s;z$r++)z$c[z$r]=this._rgbElements[z$r]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),z$q(0,z$U,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function z$V(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}z$G(z$V,"laya.d3.core.particleShuriKen.module.GradientDataInt");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.add=function(z$V,z$U){this._currentLength<8?(6===this._currentLength&&1!==z$V&&(z$V=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=z$V,this._elements[this._currentLength++]=z$U):console.log("Warning:data count must lessEqual than 4")},z$U.cloneTo=function(z$V){var z$U=z$V;z$U._currentLength=this._currentLength;var z$r=z$U._elements;z$r.length=this._elements.length;for(var z$s=0,z$p=this._elements.length;z$s<z$p;z$s++)z$r[z$s]=this._elements[z$s]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"gradientCount",function(){return this._currentLength/2})}(),function(){function z$V(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}z$G(z$V,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.add=function(z$V,z$U){this._currentLength<8?(6===this._currentLength&&1!==z$V&&(z$V=1,DEBUG),this._elements[this._currentLength++]=z$V,this._elements[this._currentLength++]=z$U):DEBUG},z$U.getKeyByIndex=function(z$V){return this._elements[2*z$V]},z$U.getValueByIndex=function(z$V){return this._elements[2*z$V+1]},z$U.getAverageValue=function(){for(var z$V=0,z$U=this._currentLength-2;z$V<z$U;z$V+=2){this._elements[z$V+1];this._elements[z$V+3],this._elements[z$V+2]-this._elements[z$V]}return 0},z$U.cloneTo=function(z$V){var z$U=z$V;z$U._currentLength=this._currentLength;var z$r=z$U._elements;z$r.length=this._elements.length;for(var z$s=0,z$p=this._elements.length;z$s<z$p;z$s++)z$r[z$s]=this._elements[z$s]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"gradientCount",function(){return this._currentLength/2})}(),function(){function z$V(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}z$G(z$V,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.add=function(z$V,z$U){this._currentLength<8?(6===this._currentLength&&1!==z$V&&(z$V=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=z$V,this._elements[this._currentLength++]=z$U.x,this._elements[this._currentLength++]=z$U.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},z$U.cloneTo=function(z$V){var z$U=z$V;z$U._currentLength=this._currentLength;var z$r=z$U._elements;z$r.length=this._elements.length;for(var z$s=0,z$p=this._elements.length;z$s<z$p;z$s++)z$r[z$s]=this._elements[z$s]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"gradientCount",function(){return this._currentLength/3})}(),function(){function z$T(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}z$G(z$T,"laya.d3.core.particleShuriKen.module.GradientSize");var z$V=z$T.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.getMaxSizeInGradient=function(){var z$V=0,z$U=0,z$r=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(z$V=0,z$U=this._gradientX.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientX.getValueByIndex(z$V));for(z$V=0,z$U=this._gradientY.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientY.getValueByIndex(z$V))}else for(z$V=0,z$U=this._gradient.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradient.getValueByIndex(z$V));break;case 1:z$r=this._separateAxes?(z$r=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),z$r=Math.max(z$r,this._constantMinSeparate.y),Math.max(z$r,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(z$V=0,z$U=this._gradientXMin.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientXMin.getValueByIndex(z$V));for(z$V=0,z$U=this._gradientXMax.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientXMax.getValueByIndex(z$V));for(z$V=0,z$U=this._gradientYMin.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientYMin.getValueByIndex(z$V));for(z$V=0,z$U=this._gradientZMax.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientZMax.getValueByIndex(z$V))}else{for(z$V=0,z$U=this._gradientMin.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientMin.getValueByIndex(z$V));for(z$V=0,z$U=this._gradientMax.gradientCount;z$V<z$U;z$V++)z$r=Math.max(z$r,this._gradientMax.getValueByIndex(z$V))}}return z$r},z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,z$U._separateAxes=this._separateAxes,this._gradient.cloneTo(z$U._gradient),this._gradientX.cloneTo(z$U._gradientX),this._gradientY.cloneTo(z$U._gradientY),this._gradientZ.cloneTo(z$U._gradientZ),z$U._constantMin=this._constantMin,z$U._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(z$U._constantMinSeparate),this._constantMaxSeparate.cloneTo(z$U._constantMaxSeparate),this._gradientMin.cloneTo(z$U._gradientMin),this._gradientMax.cloneTo(z$U._gradientMax),this._gradientXMin.cloneTo(z$U._gradientXMin),this._gradientXMax.cloneTo(z$U._gradientXMax),this._gradientYMin.cloneTo(z$U._gradientYMin),this._gradientYMax.cloneTo(z$U._gradientYMax),this._gradientZMin.cloneTo(z$U._gradientZMin),this._gradientZMax.cloneTo(z$U._gradientZMax)},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"gradientZ",function(){return this._gradientZ}),z$q(0,z$V,"gradient",function(){return this._gradient}),z$q(0,z$V,"separateAxes",function(){return this._separateAxes}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"gradientMin",function(){return this._gradientMin}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"gradientX",function(){return this._gradientX}),z$q(0,z$V,"gradientY",function(){return this._gradientY}),z$q(0,z$V,"gradientMax",function(){return this._gradientMax}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$q(0,z$V,"constantMinSeparate",function(){return this._constantMinSeparate}),z$q(0,z$V,"constantMaxSeparate",function(){return this._constantMaxSeparate}),z$q(0,z$V,"gradientXMin",function(){return this._gradientXMin}),z$q(0,z$V,"gradientXMax",function(){return this._gradientXMax}),z$q(0,z$V,"gradientYMin",function(){return this._gradientYMin}),z$q(0,z$V,"gradientYMax",function(){return this._gradientYMax}),z$q(0,z$V,"gradientZMin",function(){return this._gradientZMin}),z$q(0,z$V,"gradientZMax",function(){return this._gradientZMax}),z$T.createByGradient=function(z$V){var z$U=new z$T;return z$U._type=0,z$U._separateAxes=!1,z$U._gradient=z$V,z$U},z$T.createByGradientSeparate=function(z$V,z$U,z$r){var z$s=new z$T;return z$s._type=0,z$s._separateAxes=!0,z$s._gradientX=z$V,z$s._gradientY=z$U,z$s._gradientZ=z$r,z$s},z$T.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$T;return z$r._type=1,z$r._separateAxes=!1,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$T.createByRandomTwoConstantSeparate=function(z$V,z$U){var z$r=new z$T;return z$r._type=1,z$r._separateAxes=!0,z$r._constantMinSeparate=z$V,z$r._constantMaxSeparate=z$U,z$r},z$T.createByRandomTwoGradient=function(z$V,z$U){var z$r=new z$T;return z$r._type=2,z$r._separateAxes=!1,z$r._gradientMin=z$V,z$r._gradientMax=z$U,z$r},z$T.createByRandomTwoGradientSeparate=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=new z$T;return z$R._type=2,z$R._separateAxes=!0,z$R._gradientXMin=z$V,z$R._gradientXMax=z$U,z$R._gradientYMin=z$r,z$R._gradientYMax=z$s,z$R._gradientZMin=z$p,z$R._gradientZMax=z$c,z$R},z$T}()),z$$=function(){function z$T(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}z$G(z$T,"laya.d3.core.particleShuriKen.module.GradientVelocity");var z$V=z$T.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,this._constant.cloneTo(z$U._constant),this._gradientX.cloneTo(z$U._gradientX),this._gradientY.cloneTo(z$U._gradientY),this._gradientZ.cloneTo(z$U._gradientZ),this._constantMin.cloneTo(z$U._constantMin),this._constantMax.cloneTo(z$U._constantMax),this._gradientXMin.cloneTo(z$U._gradientXMin),this._gradientXMax.cloneTo(z$U._gradientXMax),this._gradientYMin.cloneTo(z$U._gradientYMin),this._gradientYMax.cloneTo(z$U._gradientYMax),this._gradientZMin.cloneTo(z$U._gradientZMin),this._gradientZMax.cloneTo(z$U._gradientZMax)},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"gradientZ",function(){return this._gradientZ}),z$q(0,z$V,"constant",function(){return this._constant}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"gradientXMax",function(){return this._gradientXMax}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"gradientX",function(){return this._gradientX}),z$q(0,z$V,"gradientY",function(){return this._gradientY}),z$q(0,z$V,"gradientXMin",function(){return this._gradientXMin}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$q(0,z$V,"gradientYMin",function(){return this._gradientYMin}),z$q(0,z$V,"gradientYMax",function(){return this._gradientYMax}),z$q(0,z$V,"gradientZMin",function(){return this._gradientZMin}),z$q(0,z$V,"gradientZMax",function(){return this._gradientZMax}),z$T.createByConstant=function(z$V){var z$U=new z$T;return z$U._type=0,z$U._constant=z$V,z$U},z$T.createByGradient=function(z$V,z$U,z$r){var z$s=new z$T;return z$s._type=1,z$s._gradientX=z$V,z$s._gradientY=z$U,z$s._gradientZ=z$r,z$s},z$T.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$T;return z$r._type=2,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$T.createByRandomTwoGradient=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=new z$T;return z$R._type=3,z$R._gradientXMin=z$V,z$R._gradientXMax=z$U,z$R._gradientYMin=z$r,z$R._gradientYMax=z$s,z$R._gradientZMin=z$p,z$R._gradientZMax=z$c,z$R},z$T}(),z$j=(function(){function z$V(z$V){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=z$V}z$G(z$V,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.cloneTo=function(z$V){var z$U=z$V;this._angularVelocity.cloneTo(z$U._angularVelocity),z$U.enbale=this.enbale},z$U.clone=function(){var z$V;switch(this._angularVelocity.type){case 0:z$V=this._angularVelocity.separateAxes?z$a.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):z$a.createByConstant(this._angularVelocity.constant);break;case 1:z$V=this._angularVelocity.separateAxes?z$a.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):z$a.createByGradient(this._angularVelocity.gradient.clone());break;case 2:z$V=this._angularVelocity.separateAxes?z$a.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):z$a.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:z$V=this._angularVelocity.separateAxes?z$a.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):z$a.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var z$U=new this.constructor(z$V);return z$U.enbale=this.enbale,z$U},z$q(0,z$U,"angularVelocity",function(){return this._angularVelocity})}(),function(){function z$V(){this.enable=!1,this.randomDirection=!1}z$G(z$V,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U._getShapeBoundBox=function(z$V){throw new Error("BaseShape: must override it.")},z$U._getSpeedBoundBox=function(z$V){throw new Error("BaseShape: must override it.")},z$U.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){throw new Error("BaseShape: must override it.")},z$U._calculateProceduralBounds=function(z$V,z$U,z$r){this._getShapeBoundBox(z$V);var z$s=z$V.min,z$p=z$V.max;z$RU.multiply(z$s,z$U,z$s),z$RU.multiply(z$p,z$U,z$p);var z$c=new z$gV(new z$RU,new z$RU);this.randomDirection?(z$c.min=new z$RU(-1,-1,-1),z$c.max=new z$RU(1,1,1)):this._getSpeedBoundBox(z$c);var z$R=new z$gV(new z$RU,new z$RU),z$T=z$R.min,z$N=z$R.max;z$RU.scale(z$c.min,z$r.y,z$T),z$RU.scale(z$c.max,z$r.y,z$N),z$RU.add(z$V.min,z$T,z$T),z$RU.add(z$V.max,z$N,z$N),z$RU.min(z$V.min,z$T,z$V.min),z$RU.max(z$V.max,z$T,z$V.max);var z$t=new z$gV(new z$RU,new z$RU),z$b=z$t.min,z$S=z$t.max;z$RU.scale(z$c.min,z$r.x,z$b),z$RU.scale(z$c.max,z$r.x,z$S),z$RU.min(z$t.min,z$S,z$T),z$RU.max(z$t.min,z$S,z$N),z$RU.min(z$V.min,z$T,z$V.min),z$RU.max(z$V.max,z$T,z$V.max)},z$U.cloneTo=function(z$V){z$V.enable=this.enable},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$V}()),z$P=function(){function z$c(){}return z$G(z$c,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),z$c._randomPointUnitArcCircle=function(z$V,z$U,z$r){var z$s=z$U.elements,z$p=NaN;z$p=z$r?z$r.getFloat()*z$V:Math.random()*z$V,z$s[0]=Math.cos(z$p),z$s[1]=Math.sin(z$p)},z$c._randomPointInsideUnitArcCircle=function(z$V,z$U,z$r){var z$s=z$U.elements;z$c._randomPointUnitArcCircle(z$V,z$U,z$r);var z$p=NaN;z$p=z$r?Math.pow(z$r.getFloat(),.5):Math.pow(Math.random(),.5),z$s[0]=z$s[0]*z$p,z$s[1]=z$s[1]*z$p},z$c._randomPointUnitCircle=function(z$V,z$U){var z$r=z$V.elements,z$s=NaN;z$s=z$U?z$U.getFloat()*Math.PI*2:Math.random()*Math.PI*2,z$r[0]=Math.cos(z$s),z$r[1]=Math.sin(z$s)},z$c._randomPointInsideUnitCircle=function(z$V,z$U){var z$r=z$V.elements;z$c._randomPointUnitCircle(z$V);var z$s=NaN;z$s=z$U?Math.pow(z$U.getFloat(),.5):Math.pow(Math.random(),.5),z$r[0]=z$r[0]*z$s,z$r[1]=z$r[1]*z$s},z$c._randomPointUnitSphere=function(z$V,z$U){var z$r=z$V.elements,z$s=NaN,z$p=NaN;z$p=z$U?(z$s=z$r[2]=2*z$U.getFloat()-1,z$U.getFloat()*Math.PI*2):(z$s=z$r[2]=2*Math.random()-1,Math.random()*Math.PI*2);var z$c=Math.sqrt(1-z$s*z$s);z$r[0]=z$c*Math.cos(z$p),z$r[1]=z$c*Math.sin(z$p)},z$c._randomPointInsideUnitSphere=function(z$V,z$U){var z$r=z$V.elements;z$c._randomPointUnitSphere(z$V);var z$s=NaN;z$s=z$U?Math.pow(z$U.getFloat(),1/3):Math.pow(Math.random(),1/3),z$r[0]=z$r[0]*z$s,z$r[1]=z$r[1]*z$s,z$r[2]=z$r[2]*z$s},z$c._randomPointInsideHalfUnitBox=function(z$V,z$U){var z$r=z$V.elements;z$U?(z$r[0]=z$U.getFloat()-.5,z$r[1]=z$U.getFloat()-.5,z$r[2]=z$U.getFloat()-.5):(z$r[0]=Math.random()-.5,z$r[1]=Math.random()-.5,z$r[2]=Math.random()-.5)},z$c}(),z$M=(function(){function z$V(z$V){this._size=null,this.enbale=!1,this._size=z$V}z$G(z$V,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.cloneTo=function(z$V){var z$U=z$V;this._size.cloneTo(z$U._size),z$U.enbale=this.enbale},z$U.clone=function(){var z$V;switch(this._size.type){case 0:z$V=this._size.separateAxes?z$x.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):z$x.createByGradient(this._size.gradient.clone());break;case 1:z$V=this._size.separateAxes?z$x.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):z$x.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:z$V=this._size.separateAxes?z$x.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):z$x.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var z$U=new this.constructor(z$V);return z$U.enbale=this.enbale,z$U},z$q(0,z$U,"size",function(){return this._size})}(),function(){function z$s(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}z$G(z$s,"laya.d3.core.particleShuriKen.module.StartFrame");var z$V=z$s.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.cloneTo=function(z$V){var z$U=z$V;z$U._type=this._type,z$U._constant=this._constant,z$U._constantMin=this._constantMin,z$U._constantMax=this._constantMax},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$V,"constant",function(){return this._constant}),z$q(0,z$V,"type",function(){return this._type}),z$q(0,z$V,"constantMin",function(){return this._constantMin}),z$q(0,z$V,"constantMax",function(){return this._constantMax}),z$s.createByConstant=function(z$V){var z$U=new z$s;return z$U._type=0,z$U._constant=z$V,z$U},z$s.createByRandomTwoConstant=function(z$V,z$U){var z$r=new z$s;return z$r._type=1,z$r._constantMin=z$V,z$r._constantMax=z$U,z$r},z$s}()),z$A=(function(){function z$V(z$V,z$U){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new z$cU(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=z$V,this._startFrame=z$U}z$G(z$V,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.cloneTo=function(z$V){var z$U=z$V;this.tiles.cloneTo(z$U.tiles),z$U.type=this.type,z$U.randomRow=this.randomRow,this._frame.cloneTo(z$U._frame),this._startFrame.cloneTo(z$U._startFrame),z$U.cycles=this.cycles,z$U.enableUVChannels=this.enableUVChannels,z$U.enable=this.enable},z$U.clone=function(){var z$V,z$U;switch(this._frame.type){case 0:z$V=z$m.createByConstant(this._frame.constant);break;case 1:z$V=z$m.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:z$V=z$m.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:z$V=z$m.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:z$U=z$M.createByConstant(this._startFrame.constant);break;case 1:z$U=z$M.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var z$r=new this.constructor(z$V,z$U);return this.tiles.cloneTo(z$r.tiles),z$r.type=this.type,z$r.randomRow=this.randomRow,z$r.cycles=this.cycles,z$r.enableUVChannels=this.enableUVChannels,z$r.enable=this.enable,z$r},z$q(0,z$U,"frame",function(){return this._frame}),z$q(0,z$U,"startFrame",function(){return this._startFrame})}(),function(){function z$V(z$V){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=z$V}z$G(z$V,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.cloneTo=function(z$V){var z$U=z$V;this._velocity.cloneTo(z$U._velocity),z$U.enbale=this.enbale,z$U.space=this.space},z$U.clone=function(){var z$V;switch(this._velocity.type){case 0:z$V=z$$.createByConstant(this._velocity.constant.clone());break;case 1:z$V=z$$.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:z$V=z$$.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:z$V=z$$.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var z$U=new this.constructor(z$V);return z$U.enbale=this.enbale,z$U.space=this.space,z$U},z$q(0,z$U,"velocity",function(){return this._velocity})}(),function(){function z$V(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new z$_U,this._vb=z$jU.create(z$V._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=z$$U.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=z$ZU.nameKey.getID("LINE"),this._shaderCompile=z$DU._preCompileShader[this._sharderNameID]}z$G(z$V,"laya.d3.core.PhasorSpriter3D");var z$U=z$V.prototype;return z$U.line=function(z$V,z$U,z$r,z$s){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(z$V.x,z$V.y,z$V.z,z$U.x,z$U.y,z$U.z,z$U.w),this.addVertex(z$r.x,z$r.y,z$r.z,z$s.x,z$s.y,z$s.z,z$s.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},z$U.circle=function(z$V,z$U,z$r,z$s,z$p,z$c){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*z$U,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/z$U,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*z$V,Math.cos(this._tempNumver0)*z$V,0,z$r,z$s,z$p,z$c),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},z$U.plane=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=z$s/2,this._tempNumver1=z$p/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(z$V-this._tempNumver0,z$U+this._tempNumver1,z$r,z$c,z$R,z$T,z$N),this.addVertex(z$V+this._tempNumver0,z$U+this._tempNumver1,z$r,z$c,z$R,z$T,z$N),this.addVertex(z$V-this._tempNumver0,z$U-this._tempNumver1,z$r,z$c,z$R,z$T,z$N),this.addVertex(z$V+this._tempNumver0,z$U-this._tempNumver1,z$r,z$c,z$R,z$T,z$N),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},z$U.box=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=z$s/2,this._tempNumver1=z$p/2,this._tempNumver2=z$c/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(z$V-this._tempNumver0,z$U+this._tempNumver1,z$r+this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V+this._tempNumver0,z$U+this._tempNumver1,z$r+this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V-this._tempNumver0,z$U-this._tempNumver1,z$r+this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V+this._tempNumver0,z$U-this._tempNumver1,z$r+this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V+this._tempNumver0,z$U+this._tempNumver1,z$r-this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V-this._tempNumver0,z$U+this._tempNumver1,z$r-this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V+this._tempNumver0,z$U-this._tempNumver1,z$r-this._tempNumver2,z$R,z$T,z$N,z$t),this.addVertex(z$V-this._tempNumver0,z$U-this._tempNumver1,z$r-this._tempNumver2,z$R,z$T,z$N,z$t),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},z$U.cone=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*z$r+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*z$r>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/z$r,this.addVertexIndex(0,z$U,0,z$s,z$p,z$c,z$R,this._tempUint0),this.addVertexIndex(0,0,0,z$s,z$p,z$c,z$R,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<z$r;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(z$V*this._tempNumver2,0,z$V*this._tempNumver3,z$s,z$p,z$c,z$R,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==z$r-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(z$V*this._tempNumver2,0,z$V*this._tempNumver3,z$s,z$p,z$c,z$R,this._tempUint0+(this._tempInt0+z$r)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==z$r-1?this.addIndexes(this._tempUint1+z$r+2):this.addIndexes(this._tempUint1+this._tempInt0+z$r+1),this.addIndexes(this._tempUint1+this._tempInt0+z$r),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},z$U.boundingBoxLine=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(z$V,z$p,z$c,z$R,z$T,z$N,z$t),this.addVertex(z$s,z$p,z$c,z$R,z$T,z$N,z$t),this.addVertex(z$V,z$U,z$c,z$R,z$T,z$N,z$t),this.addVertex(z$s,z$U,z$c,z$R,z$T,z$N,z$t),this.addVertex(z$s,z$p,z$r,z$R,z$T,z$N,z$t),this.addVertex(z$V,z$p,z$r,z$R,z$T,z$N,z$t),this.addVertex(z$s,z$U,z$r,z$R,z$T,z$N,z$t),this.addVertex(z$V,z$U,z$r,z$R,z$T,z$N,z$t),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},z$U.addVertex=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=z$V,this._vbData[this._posInVBData+1]=z$U,this._vbData[this._posInVBData+2]=z$r,this._vbData[this._posInVBData+3]=z$s,this._vbData[this._posInVBData+4]=z$p,this._vbData[this._posInVBData+5]=z$c,this._vbData[this._posInVBData+6]=z$R,this._posInVBData+=this._floatSizePerVer,this},z$U.addVertexIndex=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){return this._hasBegun||this.addVertexIndexException(),this._vbData[z$T]=z$V,this._vbData[z$T+1]=z$U,this._vbData[z$T+2]=z$r,this._vbData[z$T+3]=z$s,this._vbData[z$T+4]=z$p,this._vbData[z$T+5]=z$c,this._vbData[z$T+6]=z$R,(z$T+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=z$T),this},z$U.addIndexes=function(z$V){var z$U=arguments;this._hasBegun||this.addVertexIndexException();for(var z$r=0;z$r<z$U.length;z$r++)this._ibData[this._posInIBData]=z$U[z$r],this._posInIBData++;return this},z$U.begin=function(z$V,z$U){return this._hasBegun&&this.beginException0(),1!==z$V&&4!==z$V&&this.beginException1(),this._primitiveType=z$V,this._camera=z$U,this._hasBegun=!0,this},z$U.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},z$U.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(z$V._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),z$D.drawCall++,z$w.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},z$U.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},z$U.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},z$U.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},z$U.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},z$U.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},z$U.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(28,[new z$RV(0,"vector3",0),new z$RV(12,"vector4",1)])}]),z$V}()),z$X=function(){function z$V(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++z$V._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new z$_U}z$G(z$V,"laya.d3.core.render.RenderElement");var z$U=z$V.prototype;return z$U.getDynamicBatchBakedVertexs=function(z$V){for(var z$U=this._renderObj._getVertexBuffer(z$V),z$r=z$U.getData().slice(),z$s=z$U.vertexDeclaration,z$p=z$s.getVertexElementByUsage(0).offset/4,z$c=z$s.getVertexElementByUsage(3).offset/4,z$R=this._sprite3D.transform,z$T=z$R.worldMatrix,z$N=z$R.rotation,z$t=z$s.vertexStride/4,z$b=0,z$S=z$r.length;z$b<z$S;z$b+=z$t){var z$_=z$b+z$p,z$G=z$b+z$c;z$hU.transformVector3ArrayToVector3ArrayCoordinate(z$r,z$_,z$T,z$r,z$_),z$hU.transformVector3ArrayByQuat(z$r,z$G,z$N,z$r,z$G)}return z$r},z$U.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},z$U._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},z$q(0,z$U,"id",function(){return this._id}),z$q(0,z$U,"renderObj",function(){return this._renderObj},function(z$V){this._renderObj!==z$V&&(this._renderObj=z$V)}),z$V._uniqueIDCounter=0,z$V}(),z$e=function(){function z$U(z$V){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++z$U._uniqueIDCounter,this._needSort=!1,this._scene=z$V,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}z$G(z$U,"laya.d3.core.render.RenderQueue");var z$V=z$U.prototype;return z$V._sortOpaqueFunc=function(z$V,z$U){if(z$V._render&&z$U._render){var z$r=z$V._material.renderQueue-z$U._material.renderQueue;return 0==z$r?z$V._render._distanceForSort-z$U._render._distanceForSort:z$r}return 0},z$V._sortAlphaFunc=function(z$V,z$U){if(z$V._render&&z$U._render){var z$r=z$V._material.renderQueue-z$U._material.renderQueue;return 0==z$r?z$U._render._distanceForSort-z$V._render._distanceForSort:z$r}return 0},z$V._begainRenderElement=function(z$V,z$U,z$r){return!!z$U._beforeRender(z$V)},z$V._sortAlpha=function(z$V){z$U._cameraPosition=z$V,this._finalElements.sort(this._sortAlphaFunc)},z$V._sortOpaque=function(z$V){z$U._cameraPosition=z$V,this._finalElements.sort(this._sortOpaqueFunc)},z$V._preRender=function(z$V){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},z$V._render=function(z$V,z$U){for(var z$r,z$s,z$p,z$c,z$R,z$T,z$N=z$D.loopCount,z$t=this._scene,z$b=z$V.camera,z$S=(z$b.id,!1),z$_=0,z$G=this._finalElements.length;z$_<z$G;z$_++){var z$q,z$u,z$h,z$l=this._finalElements[z$_];if(null!=z$l._onPreRenderFunction&&z$l._onPreRenderFunction.call(z$l._sprite3D,z$V),0===z$l._type){if(z$V.owner=z$h=z$l._sprite3D,z$V.renderElement=z$l,z$h._preRenderUpdateComponents(z$V),z$q=z$l.renderObj,z$u=z$l._material,this._begainRenderElement(z$V,z$q,z$u)){if(z$r=z$q._getVertexBuffers(),!(z$p=(z$s=z$q._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[z$s.id]){this._errorRecord[z$s.id]=1;var z$W="vertexBuffer:"+("("+z$s._destroyed+","+z$s._released+","+z$s._referenceCount+","+z$s._buffer+")")+", material:"+(z$u?z$u.__className+"("+z$u._destroyed+","+z$u._released+")":"null")+", owner:"+(z$h?z$h.__className+"("+z$h._destroyed+","+z$h._activeInHierarchy+","+z$h._displayedInStage+")":"null")+", renderObj:"+(z$q?z$q.__className+"("+z$q._destroyed+","+z$q._released+","+z$q._referenceCount+")":"")+", parent:, url:"+(z$h?z$h.url:"")+", disposeStack:"+z$s.disposeStack;z$d.recordError("报错：unknown vertexDeclaration  "+z$W)}continue}if(z$S=(z$c=z$V._shader=z$u._getShader(z$t._shaderDefineValue,z$p.shaderDefineValue,z$h._shaderDefineValue)).bind()||z$N!==z$c._uploadLoopCount,z$r){if(z$c._uploadVertexBuffer!==z$r||z$S){for(var z$O=0;z$O<z$r.length;z$O++){var z$L=z$r[z$O];z$c.uploadAttributesX(z$L.vertexDeclaration.shaderValues.data,z$L)}z$c._uploadVertexBuffer=z$r}}else(z$c._uploadVertexBuffer!==z$s||z$S)&&(z$c.uploadAttributes(z$p.shaderValues.data,null),z$c._uploadVertexBuffer=z$s);(z$c._uploadScene!==z$t||z$S)&&(z$c.uploadSceneUniforms(z$t._shaderValues.data),z$c._uploadScene=z$t),(z$b!==z$c._uploadCamera||z$c._uploadSprite3D!==z$h||z$S)&&(z$c.uploadSpriteUniforms(z$h._shaderValues.data),z$c._uploadSprite3D=z$h),(z$b!==z$c._uploadCamera||z$S)&&(z$c.uploadCameraUniforms(z$b._shaderValues.data),z$c._uploadCamera=z$b),(z$c._uploadMaterial!==z$u||z$S)&&(z$u._upload(),z$c._uploadMaterial=z$u),z$R!==z$u?(z$u._setRenderStateBlendDepth(),z$u._setRenderStateFrontFace(z$U,z$h.transform),z$R=z$u,z$T=z$h):z$T!==z$h&&(z$u._setRenderStateFrontFace(z$U,z$h.transform),z$T=z$h),z$q._render(z$V),z$c._uploadLoopCount=z$N}z$h._postRenderUpdateComponents(z$V)}else if(2===z$l._type){z$l.renderObj;z$V.owner=z$h=z$l._sprite3D,z$V.renderElement=z$l,z$V._batchIndexStart=z$l._tempBatchIndexStart,z$V._batchIndexEnd=z$l._tempBatchIndexEnd,z$q=z$l.renderObj,z$u=z$l._material,this._begainRenderElement(z$V,z$q,z$u)&&(z$p=(z$s=z$q._getVertexBuffer(0)).vertexDeclaration,z$S=(z$c=z$V._shader=z$u._getShader(z$t._shaderDefineValue,z$p.shaderDefineValue,z$h._shaderDefineValue)).bind()||z$N!==z$c._uploadLoopCount,(z$c._uploadVertexBuffer!==z$s||z$S)&&(z$c.uploadAttributes(z$p.shaderValues.data,null),z$c._uploadVertexBuffer=z$s),(z$c._uploadScene!==z$t||z$S)&&(z$c.uploadSceneUniforms(z$t._shaderValues.data),z$c._uploadScene=z$t),(z$b!==z$c._uploadCamera||z$c._uploadSprite3D!==z$h||z$S)&&(z$c.uploadSpriteUniforms(z$h._shaderValues.data),z$c._uploadSprite3D=z$h),(z$b!==z$c._uploadCamera||z$S)&&(z$c.uploadCameraUniforms(z$b._shaderValues.data),z$c._uploadCamera=z$b),(z$c._uploadMaterial!==z$u||z$S)&&(z$u._upload(),z$c._uploadMaterial=z$u),z$R!==z$u?(z$u._setRenderStateBlendDepth(),z$u._setRenderStateFrontFace(z$U,z$h.transform),z$R=z$u,z$T=z$h):z$T!==z$h&&(z$u._setRenderStateFrontFace(z$U,z$h.transform),z$T=z$h),z$q._render(z$V),z$c._uploadLoopCount=z$N)}}},z$V._renderShadow=function(z$V,z$U){for(var z$r,z$s,z$p,z$c,z$R,z$T=z$D.loopCount,z$N=this._scene,z$t=z$V.camera,z$b=!1,z$S=0,z$_=this._finalElements.length;z$S<z$_;z$S++){var z$G,z$q,z$u,z$h=this._finalElements[z$S];0===z$h._type&&(z$V.owner=z$u=z$h._sprite3D,z$U||z$u._projectionViewWorldUpdateCamera===z$t&&z$u._projectionViewWorldUpdateLoopCount===z$D.loopCount||(z$u._render._renderUpdate(z$V._projectionViewMatrix),z$u._projectionViewWorldUpdateLoopCount=z$D.loopCount,z$u._projectionViewWorldUpdateCamera=z$t),z$V.renderElement=z$h,z$u._preRenderUpdateComponents(z$V),z$G=z$h.renderObj,z$q=z$h._material,this._begainRenderElement(z$V,z$G,null)&&(z$s=(z$r=z$G._getVertexBuffer(0)).vertexDeclaration,z$b=(z$p=z$V._shader=z$q._getShader(z$N._shaderDefineValue,z$s.shaderDefineValue,z$u._shaderDefineValue)).bind()||z$T!==z$p._uploadLoopCount,(z$p._uploadVertexBuffer!==z$r||z$b)&&(z$p.uploadAttributes(z$s.shaderValues.data,null),z$p._uploadVertexBuffer=z$r),(z$t!==z$p._uploadCamera||z$p._uploadSprite3D!==z$u||z$b)&&(z$p.uploadSpriteUniforms(z$u._shaderValues.data),z$p._uploadSprite3D=z$u),(z$t!==z$p._uploadCamera||z$b)&&(z$p.uploadCameraUniforms(z$t._shaderValues.data),z$p._uploadCamera=z$t),(z$p._uploadMaterial!==z$q||z$b)&&(z$q._upload(),z$p._uploadMaterial=z$q),z$p._uploadRenderElement,z$c!==z$q?(z$q._setRenderStateFrontFace(!1,z$u.transform),z$c=z$q,z$R=z$u):z$R!==z$u&&(z$q._setRenderStateFrontFace(!1,z$u.transform),z$R=z$u),z$G._render(z$V),z$p._uploadLoopCount=z$T),z$u._postRenderUpdateComponents(z$V))}},z$V._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},z$V._addRenderElement=function(z$V){this._renderElements.push(z$V),this._needSort=!0},z$V._addDynamicBatchElement=function(z$V){this._dynamicBatchCombineRenderElements.push(z$V)},z$q(0,z$V,"id",function(){return this._id}),z$U._uniqueIDCounter=0,z$U._cameraPosition=null,z$U}(),z$F=function(){function z$V(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return z$G(z$V,"laya.d3.core.render.RenderState"),z$V.clientWidth=0,z$V.clientHeight=0,z$V}(),z$g=function(){function z$R(z$V,z$U){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new z$YV(new z$RU,0),this._corners=[new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU],this._boundingBoxCenter=new z$RU,this._children=z$s(8),this._objects=[],this._tempBoundBoxCorners=[new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU],this._scene=z$V,this._currentDepth=z$U}z$G(z$R,"laya.d3.core.scene.OctreeNode");var z$V=z$R.prototype;return z$d.imps(z$V,{"laya.d3.core.scene.ITreeNode":!0}),z$V.init=function(z$V,z$U){var z$r=new z$RU,z$s=new z$RU;z$RU.scale(z$U,-.5,z$r),z$RU.scale(z$U,.5,z$s),z$RU.add(z$r,z$V,z$r),z$RU.add(z$s,z$V,z$s),this.exactBox=new z$gV(z$r,z$s),this.relaxBox=new z$gV(z$r,z$s)},z$V.addTreeNode=function(z$V){1===Collision.boxContainsBox(this._relaxBox,z$V.boundingBox)?this.addNodeDown(z$V,0):this.addObject(z$V)},z$V.addChild=function(z$V){var z$U=this._children[z$V];if(null==z$U){z$U=new z$R(this._scene,this._currentDepth+1),(this._children[z$V]=z$U)._parent=this,z$RU.subtract(this._exactBox.max,this._exactBox.min,z$R.tempSize),z$RU.multiply(z$R.tempSize,z$R._octreeSplit[z$V],z$R.tempCenter),z$RU.add(this._exactBox.min,z$R.tempCenter,z$R.tempCenter),z$RU.scale(z$R.tempSize,.25,z$R.tempSize);var z$r=new z$RU,z$s=new z$RU;z$RU.subtract(z$R.tempCenter,z$R.tempSize,z$r),z$RU.add(z$R.tempCenter,z$R.tempSize,z$s),z$U.exactBox=new z$gV(z$r,z$s),z$RU.scale(z$R.tempSize,z$R.relax,z$R.tempSize);var z$p=new z$RU,z$c=new z$RU;z$RU.subtract(z$R.tempCenter,z$R.tempSize,z$p),z$RU.add(z$R.tempCenter,z$R.tempSize,z$c),z$U.relaxBox=new z$gV(z$p,z$c)}return z$U},z$V.addObject=function(z$V){(z$V._treeNode=this)._objects.push(z$V)},z$V.removeObject=function(z$V){if(z$V._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var z$U=this._objects.indexOf(z$V);return-1!==z$U&&(this._objects.splice(z$U,1),!0)},z$V.clearObject=function(){this._objects.length=0},z$V.addNodeUp=function(z$V,z$U){this._parent&&1!==Collision.boxContainsBox(this._exactBox,z$V.boundingBox)?this._parent.addNodeUp(z$V,z$U-1):this.addNodeDown(z$V,z$U)},z$V.addNodeDown=function(z$V,z$U){if(z$U<this._scene.treeLevel){var z$r=this.inChildIndex(z$V.boundingBoxCenter),z$s=this.addChild(z$r);1===Collision.boxContainsBox(z$s._relaxBox,z$V.boundingBox)?z$s.addNodeDown(z$V,++z$U):this.addObject(z$V)}else this.addObject(z$V)},z$V.inChildIndex=function(z$V){return 4*(z$V.z<this._boundingBoxCenter.z?0:1)+2*(z$V.y<this._boundingBoxCenter.y?0:1)+(z$V.x<this._boundingBoxCenter.x?0:1)},z$V.updateObject=function(z$V){1===Collision.boxContainsBox(this._relaxBox,z$V.boundingBox)?(this.removeObject(z$V),z$V._treeNode=null,this.addNodeDown(z$V,this._currentDepth)):this._parent&&(this.removeObject(z$V),z$V._treeNode=null,this._parent.addNodeUp(z$V,this._currentDepth-1))},z$V.cullingObjects=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R=0,z$T=0,z$N=0,z$t=this._scene._dynamicBatchManager;for(z$R=0,z$c=this._objects.length;z$R<z$c;z$R++){var z$b=this._objects[z$R];if(z$K.isVisible(z$b._owner.layer.mask)&&z$b.enable){if(z$U&&(z$D.treeSpriteCollision+=1,0===z$V.containsBoundSphere(z$b.boundingSphere)))continue;z$b._renderUpdate(z$p),z$b._distanceForSort=z$RU.distance(z$b.boundingSphere.center,z$s)+z$b.sortingFudge;var z$S=z$b._renderElements;for(z$T=0,z$N=z$S.length;z$T<z$N;z$T++){var z$_=z$S[z$T],z$G=z$_._staticBatch;if(z$G&&z$G._material===z$_._material)z$G._addBatchRenderElement(z$_);else{var z$q=z$_.renderObj;z$q.triangleCount<10&&1===z$q._vertexBufferCount&&z$q._getIndexBuffer()&&z$_._material.renderQueue<2&&z$_._canDynamicBatch&&!z$b._owner.isStatic?z$t._addPrepareRenderElement(z$_):this._scene.getRenderQueue(z$_._material.renderQueue)._addRenderElement(z$_)}}}}for(z$R=0;z$R<8;z$R++){var z$u=this._children[z$R];if(null!=z$u){var z$h=z$U;if(z$U){var z$l=z$V.containsBoundBox(z$u._relaxBox);if(z$D.treeNodeCollision+=1,0===z$l)continue;z$h=2===z$l}z$u.cullingObjects(z$V,z$h,z$r,z$s,z$p)}}},z$V.cullingShadowObjects=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R=0,z$T=0,z$N=0;this._scene._dynamicBatchManager;for(z$R=0,z$c=this._objects.length;z$R<z$c;z$R++){var z$t=this._objects[z$R];if(z$t.castShadow&&z$K.isVisible(z$t._owner.layer.mask)&&z$t.enable){if(z$r&&0===z$V[0].containsBoundSphere(z$t.boundingSphere))continue;for(var z$b=1,z$S=z$V.length;z$b<z$S;z$b++){var z$_=z$U[z$b-1];if(0!==z$V[z$b].containsBoundSphere(z$t.boundingSphere)){var z$G=z$t._renderElements;for(z$T=0,z$N=z$G.length;z$T<z$N;z$T++)z$_._addRenderElement(z$G[z$T])}}}}for(z$R=0;z$R<8;z$R++){var z$q=this._children[z$R];if(null!=z$q){var z$u=z$r;if(z$r){var z$h=z$V[0].containsBoundBox(z$q._relaxBox);if(0===z$h)continue;z$u=2===z$h}z$q.cullingShadowObjects(z$V,z$U,z$u,z$s,z$p)}}},z$V.cullingShadowObjectsOnePSSM=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T=z$U[0],z$N=0,z$t=0,z$b=0;for(z$N=0,z$R=this._objects.length;z$N<z$R;z$N++){var z$S=this._objects[z$N];if(z$S.castShadow&&z$K.isVisible(z$S._owner.layer.mask)&&z$S.enable){if(z$s&&0===z$V.containsBoundSphere(z$S.boundingSphere))continue;z$S._renderUpdate(z$r);var z$_=z$S._renderElements;for(z$t=0,z$b=z$_.length;z$t<z$b;z$t++)z$T._addRenderElement(z$_[z$t])}}for(z$N=0;z$N<8;z$N++){var z$G=this._children[z$N];if(null!=z$G){var z$q=z$s;if(z$s){var z$u=z$V.containsBoundBox(z$G._relaxBox);if(0===z$u)continue;z$q=2===z$u}z$G.cullingShadowObjectsOnePSSM(z$V,z$U,z$r,z$q,z$p,z$c)}}},z$V.renderBoudingBox=function(z$V){this._renderBoudingBox(z$V);for(var z$U=0;z$U<8;++z$U){var z$r=this._children[z$U];z$r&&z$r.renderBoudingBox(z$V)}},z$V.buildAllChild=function(z$V){if(z$V<this._scene.treeLevel)for(var z$U=0;z$U<8;z$U++){this.addChild(z$U).buildAllChild(z$V+1)}},z$V._renderBoudingBox=function(z$V){},z$q(0,z$V,"exactBox",function(){return this._exactBox},function(z$V){this._exactBox=z$V,z$RU.add(z$V.min,z$V.max,this._boundingBoxCenter),z$RU.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),z$q(0,z$V,"relaxBox",function(){return this._relaxBox},function(z$V){(this._relaxBox=z$V).getCorners(this._corners),z$YV.createfromPoints(this._corners,this._boundingSphere)}),z$R.debugMode=!1,z$R.relax=1.15,z$R.CHILDNUM=8,z$S(z$R,["tempVector0",function(){return this.tempVector0=new z$RU},"tempSize",function(){return this.tempSize=new z$RU},"tempCenter",function(){return this.tempCenter=new z$RU},"_octreeSplit",function(){return this._octreeSplit=[new z$RU(.25,.25,.25),new z$RU(.75,.25,.25),new z$RU(.25,.75,.25),new z$RU(.75,.75,.25),new z$RU(.25,.25,.75),new z$RU(.75,.25,.75),new z$RU(.25,.75,.75),new z$RU(.75,.75,.75)]}]),z$R}(),z$v=(function(){function z$V(){}z$G(z$V,"laya.d3.core.scene.SceneManager")}(),function(){function z$V(z$V,z$U,z$r,z$s){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===z$V&&(z$V=1),void 0===z$U&&(z$U=1),void 0===z$r&&(z$r=1),void 0===z$s&&(z$s=1),this._r=z$V,this._g=z$U,this._b=z$r,this._a=z$s}return z$G(z$V,"laya.d3.core.trail.module.Color",null,"Color$1"),z$V.prototype.cloneTo=function(z$V){z$V._r=this._r,z$V._g=this._g,z$V._b=this._b,z$V._a=this._a},z$S(z$V,["RED",function(){return this.RED=new z$V(1,0,0,1)},"GREEN",function(){return this.GREEN=new z$V(0,1,0,1)},"BLUE",function(){return this.BLUE=new z$V(0,0,1,1)},"CYAN",function(){return this.CYAN=new z$V(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new z$V(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new z$V(1,0,1,1)},"GRAY",function(){return this.GRAY=new z$V(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new z$V(1,1,1,1)},"BLACK",function(){return this.BLACK=new z$V(0,0,0,1)}]),z$V}()),z$Y=(function(){function z$V(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}z$G(z$V,"laya.d3.core.trail.module.Gradient");var z$U=z$V.prototype;z$U.setKeys=function(z$V,z$U){var z$r,z$s;this._colorKeys=z$V;for(var z$p=this.index=0;z$p<z$V.length;z$p++){var z$c=(z$r=z$V[z$p]).color;this._colorKeyData[this.index++]=z$c._r,this._colorKeyData[this.index++]=z$c._g,this._colorKeyData[this.index++]=z$c._b,this._colorKeyData[this.index++]=z$r.time}this._alphaKeys=z$U;for(var z$R=this.index=0;z$R<z$U.length;z$R++)z$s=z$U[z$R],this._alphaKeyData[this.index++]=z$s.alpha,this._alphaKeyData[this.index++]=z$s.time},z$U.cloneTo=function(z$V){var z$U=0,z$r=0,z$s=this.colorKeys,z$p=[];for(z$U=0,z$r=z$s.length;z$U<z$r;z$U++){var z$c=new z$C;z$s[z$U].cloneTo(z$c),z$p.push(z$c)}var z$R=this.alphaKeys,z$T=[];for(z$U=0,z$r=z$R.length;z$U<z$r;z$U++){var z$N=new z$Y;z$R[z$U].cloneTo(z$N),z$T.push(z$N)}z$V.setKeys(z$p,z$T)},z$q(0,z$U,"mode",function(){return this._mode},function(z$V){this._mode=z$V}),z$q(0,z$U,"colorKeys",function(){return this._colorKeys},function(z$V){this._colorKeys=z$V;for(var z$U=this.index=0;z$U<z$V.length;z$U++){var z$r=z$V[z$U],z$s=z$r.color;this._colorKeyData[this.index++]=z$s._r,this._colorKeyData[this.index++]=z$s._g,this._colorKeyData[this.index++]=z$s._b,this._colorKeyData[this.index++]=z$r.time}}),z$q(0,z$U,"alphaKeys",function(){return this._alphaKeys},function(z$V){this._alphaKeys=z$V;for(var z$U=this.index=0;z$U<z$V.length;z$U++){var z$r=z$V[z$U];this._alphaKeyData[this.index++]=z$r.alpha,this._alphaKeyData[this.index++]=z$r.time}})}(),function(){function z$V(z$V,z$U){this._alpha=NaN,this._time=NaN,void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),this._alpha=z$V,this._time=z$U}z$G(z$V,"laya.d3.core.trail.module.GradientAlphaKey");var z$U=z$V.prototype;return z$U.cloneTo=function(z$V){z$V.alpha=this.alpha,z$V.time=this.time},z$q(0,z$U,"alpha",function(){return this._alpha},function(z$V){this._alpha=z$V}),z$q(0,z$U,"time",function(){return this._time},function(z$V){this._time=z$V}),z$V}()),z$C=function(){function z$V(z$V,z$U){this._color=null,this._time=NaN,void 0===z$U&&(z$U=0),this._color=z$V||new z$v,this._time=z$U}z$G(z$V,"laya.d3.core.trail.module.GradientColorKey");var z$U=z$V.prototype;return z$U.cloneTo=function(z$V){this.color.cloneTo(z$V.color),z$V.time=this.time},z$q(0,z$U,"color",function(){return this._color},function(z$V){this._color=z$V}),z$q(0,z$U,"time",function(){return this._time},function(z$V){this._time=z$V}),z$V}(),z$f=(function(){function z$V(){}z$G(z$V,"laya.d3.core.trail.module.GradientMode"),z$V.Blend=0,z$V.Fixed=1}(),function(){function z$V(){}z$G(z$V,"laya.d3.core.trail.module.TextureMode"),z$V.Stretch=0,z$V.Tile=1}(),function(){function z$V(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}z$G(z$V,"laya.d3.core.trail.module.TrailKeyFrame"),z$V.prototype.cloneTo=function(z$V){z$V.time=this.time,z$V.inTangent=this.inTangent,z$V.outTangent=this.outTangent,z$V.value=this.value}}(),function(){function z$U(z$V){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new z$RU,this._curPosition=new z$RU,this._delVector3=new z$RU,this._lastFixedVertexPosition=new z$RU,this._pointAtoBVector3=new z$RU,this._pointA=new z$RU,this._pointB=new z$RU,this._owner=z$V,this._id=z$U.renderElementCount++,0==this._id?z$V._owner.transform.position.cloneTo(this._lastPosition):z$V._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new z$jU(z$f.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new z$jU(z$f.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}z$G(z$U,"laya.d3.core.trail.TrailRenderElement");var z$V=z$U.prototype;z$d.imps(z$V,{"laya.d3.core.render.IRenderable":!0}),z$V._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},z$V._addTrailByFirstPosition=function(z$V,z$U){z$RU.subtract(z$U,z$V,this._delVector3),z$RU.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),z$RU.normalize(this._pointAtoBVector3,this._pointAtoBVector3),z$RU.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(z$V),z$V.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},z$V._addTrailByNextPosition=function(z$V){z$RU.subtract(z$V,this._lastFixedVertexPosition,this._delVector3),z$RU.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),z$RU.normalize(this._pointAtoBVector3,this._pointAtoBVector3),z$RU.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=z$RU.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=z$CV.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(z$V),z$V.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(z$V),this._virtualVerticesCount=2)},z$V._updateVerticesByPosition=function(z$V){this._pointe=z$V.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},z$V._updateVertexBuffer2=function(){var z$V,z$U=0,z$r=0,z$s=0;for(z$s=0,z$V=(this._verticesCount+this._virtualVerticesCount)/2;z$s<z$V;z$s++)z$r=0==this._owner.textureMode?(this._VerticesToTailLength[z$s]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[z$s],this._vertices2[z$U++]=1-z$r,this._vertices2[z$U++]=1-z$r;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},z$V._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},z$V._updateDisappear=function(){var z$V,z$U=0;for(z$U=this._curDisappearIndex,z$V=(this._verticesCount+this._virtualVerticesCount)/2;z$U<z$V;z$U++)this._owner._curtime-this._everyGroupVertexBirthTime[z$U]>=this._owner.time+z$CV.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},z$V._beforeRender=function(z$V){return this._camera=z$V.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),z$RU.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},z$V._render=function(z$V){this._isDead||(z$w.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),z$D.drawCall++,z$D.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},z$V._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),0===z$V?this._vertexBuffer1:1===z$V?this._vertexBuffer2:null},z$V._getVertexBuffers=function(){return this._vertexBuffers},z$V._getIndexBuffer=function(){return null},z$V.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},z$V._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},z$q(0,z$V,"_vertexBufferCount",function(){return this._vertexBuffers.length}),z$q(0,z$V,"triangleCount",function(){return 0}),z$U.renderElementCount=0}(),function(){function z$V(){}z$G(z$V,"laya.d3.core.trail.VertexTrail");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration1}),z$q(1,z$V,"vertexDeclaration1",function(){return z$V._vertexDeclaration1}),z$q(1,z$V,"vertexDeclaration2",function(){return z$V._vertexDeclaration2}),z$S(z$V,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new z$cV(32,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",41),new z$RV(24,"single",33),new z$RV(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new z$cV(4,[new z$RV(0,"single",38)])}]),z$V}()),z$VV=function(){function z$L(z$V){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=z$V}z$G(z$L,"laya.d3.graphics.DynamicBatch");var z$V=z$L.prototype;return z$d.imps(z$V,{"laya.d3.core.render.IRenderable":!0}),z$V._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),0===z$V?this._vertexBuffer:null},z$V._getIndexBuffer=function(){return this._indexBuffer},z$V._getCombineRenderElementFromPool=function(z$V,z$U,z$r){var z$s=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return z$s||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=z$s=new z$X,z$s._sprite3D=new z$eU),z$s._sprite3D._render._renderUpdate(z$r),z$s},z$V._getRenderElement=function(z$V,z$U,z$r){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*z$L.maxVertexCount),this._indexDatas=new Uint16Array(z$L.maxIndexCount),this._vertexBuffer=z$jU.create(this._vertexDeclaration,z$L.maxVertexCount,35048),this._indexBuffer=z$$U.create("ushort",z$L.maxIndexCount,35048));for(var z$s=this._merageElements.length=0,z$p=0,z$c=0,z$R=this._combineRenderElements.length;z$c<z$R;z$c++){var z$T=this._combineRenderElements[z$c],z$N=z$T.getDynamicBatchBakedVertexs(0),z$t=z$T.getBakedIndices(),z$b=z$T._sprite3D.transform._isFrontFaceInvert,z$S=z$s/(this._vertexDeclaration.vertexStride/4),z$_=z$p,z$G=z$_+z$t.length;z$T._tempBatchIndexStart=z$_,z$T._tempBatchIndexEnd=z$G,this._indexDatas.set(z$t,z$p);var z$q=0;if(z$b)for(z$q=z$_;z$q<z$G;z$q+=3){this._indexDatas[z$q]=z$S+this._indexDatas[z$q];var z$u=this._indexDatas[z$q+1],z$h=this._indexDatas[z$q+2];this._indexDatas[z$q+1]=z$S+z$h,this._indexDatas[z$q+2]=z$S+z$u}else for(z$q=z$_;z$q<z$G;z$q+=3)this._indexDatas[z$q]=z$S+this._indexDatas[z$q],this._indexDatas[z$q+1]=z$S+this._indexDatas[z$q+1],this._indexDatas[z$q+2]=z$S+this._indexDatas[z$q+2];z$p+=z$t.length,this._vertexDatas.set(z$N,z$s),z$s+=z$N.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),z$c=this._combineRenderElementPoolIndex=0,z$R=this._materials.length;z$c<z$R;z$c++){var z$l=this._getCombineRenderElementFromPool(z$V,z$U,z$r);z$l._type=2,z$l._staticBatch=null;var z$W=(z$l.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[z$c]]._tempBatchIndexStart,z$O=z$c+1===this._materialToRenderElementsOffsets.length?z$p:this._combineRenderElements[this._materialToRenderElementsOffsets[z$c+1]]._tempBatchIndexStart;z$l._tempBatchIndexStart=z$W,z$l._tempBatchIndexEnd=z$O,z$l._material=this._materials[z$c],this._merageElements.push(z$l)}},z$V._addCombineRenderObjTest=function(z$V){var z$U=z$V.renderObj,z$r=this._currentCombineIndexCount+z$U._getIndexBuffer().indexCount,z$s=this._currentCombineVertexCount+z$U._getVertexBuffer().vertexCount;return!(z$L.maxVertexCount<z$s||z$L.maxIndexCount<z$r)},z$V._addCombineRenderObj=function(z$V){var z$U=z$V.renderObj;this._combineRenderElements.push(z$V),this._currentCombineIndexCount=this._currentCombineIndexCount+z$U._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+z$U._getVertexBuffer().vertexCount},z$V._addCombineMaterial=function(z$V){this._materials.push(z$V)},z$V._addMaterialToRenderElementOffset=function(z$V){this._materialToRenderElementsOffsets.push(z$V)},z$V._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},z$V._addToRenderQueue=function(z$V,z$U,z$r,z$s){this._getRenderElement(z$U,z$r,z$s);for(var z$p=0,z$c=this._materials.length;z$p<z$c;z$p++)z$V.getRenderQueue(this._materials[z$p].renderQueue)._addDynamicBatchElement(this._merageElements[z$p])},z$V._beforeRender=function(z$V){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},z$V._render=function(z$V){var z$U=z$V._batchIndexEnd-z$V._batchIndexStart;z$w.mainContext.drawElements(4,z$U,5123,2*z$V._batchIndexStart),z$D.drawCall++,z$D.trianglesFaces+=z$U/3},z$V._getVertexBuffers=function(){return null},z$q(0,z$V,"_vertexBufferCount",function(){return 1}),z$q(0,z$V,"triangleCount",function(){return this._indexBuffer.indexCount/3}),z$q(0,z$V,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),z$L.maxVertexCount=2e4,z$L.maxIndexCount=4e4,z$L.maxCombineTriangleCount=10,z$L}(),z$UV=function(){function z$L(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}z$G(z$L,"laya.d3.graphics.DynamicBatchManager");var z$V=z$L.prototype;return z$V.getDynamicBatch=function(z$V,z$U){var z$r,z$s=z$V.id.toString()+z$U;return this._dynamicBatches[z$s]?z$r=this._dynamicBatches[z$s]:this._dynamicBatches[z$s]=z$r=new z$VV(z$V),z$r},z$V._garbageCollection=function(){for(var z$V in this._dynamicBatches)0===this._dynamicBatches[z$V].combineRenderElementsCount&&delete this._dynamicBatches[z$V]},z$V._addPrepareRenderElement=function(z$V){this._prepareDynamicBatchCombineElements.push(z$V)},z$V._finishCombineDynamicBatch=function(z$V){var z$U,z$r,z$s;this._prepareDynamicBatchCombineElements.sort(z$L._sortPrepareDynamicBatch);for(var z$p,z$c,z$R,z$T,z$N,z$t=-1,z$b=!0,z$S=0,z$_=-1,z$G=0,z$q=this._prepareDynamicBatchCombineElements.length;z$G<z$q;z$G++){var z$u=(z$c=this._prepareDynamicBatchCombineElements[z$G]).renderObj._getVertexBuffer(0).vertexDeclaration,z$h=z$r!==z$u;z$h&&(z$S=0,z$r=z$u);var z$l=z$S!==z$t;if(z$l&&(z$t=z$S),(z$h||z$l)&&(z$R=this.getDynamicBatch(z$u,z$S),z$U=null),z$b)if(z$R._addCombineRenderObjTest(z$c)){if(z$U!==(z$p=z$c._material))z$T&&(z$V.getRenderQueue(z$N._material.renderQueue)._addRenderElement(z$N),z$N=z$T=null,z$_=-1),z$T=z$p,z$_=z$R.combineRenderElementsCount,z$N=z$c,z$U=z$p;else if(z$T){var z$W=z$N.renderObj,z$O=z$c.renderObj;z$W._getVertexBuffer().vertexCount+z$O._getVertexBuffer().vertexCount>z$VV.maxVertexCount||z$W._getIndexBuffer().indexCount+z$O._getIndexBuffer().indexCount>z$VV.maxIndexCount?(z$V.getRenderQueue(z$N._material.renderQueue)._addRenderElement(z$N),z$T=z$p,z$_=z$R.combineRenderElementsCount,z$N=z$c):(z$R._addCombineMaterial(z$T),z$R._addMaterialToRenderElementOffset(z$_),z$R._addCombineRenderObj(z$N),z$N=z$T=null,z$_=-1,z$R._addCombineRenderObj(z$c))}else z$R._addCombineRenderObj(z$c);z$b=!0}else z$T&&(z$V.getRenderQueue(z$N._material.renderQueue)._addRenderElement(z$N),z$N=z$T=null,z$_=-1),z$S++,z$b=!1;else z$s=this._prepareDynamicBatchCombineElements[z$G-1],z$R._addMaterialToRenderElementOffset(z$R.combineRenderElementsCount),z$U=z$s._material,z$R._addCombineMaterial(z$U),z$R._addCombineRenderObj(z$s),z$b=!0,z$U!==(z$p=z$c._material)?(z$T=z$p,z$_=z$R.combineRenderElementsCount,z$N=z$c):z$R._addCombineRenderObj(z$c),z$U=z$p}z$T&&(z$V.getRenderQueue(z$N._material.renderQueue)._addRenderElement(z$N),z$N=z$T=null,z$_=-1),this._prepareDynamicBatchCombineElements.length=0},z$V._clearRenderElements=function(){for(var z$V in this._dynamicBatches)this._dynamicBatches[z$V]._clearRenderElements()},z$V._addToRenderQueue=function(z$V,z$U,z$r,z$s){for(var z$p in this._dynamicBatches){var z$c=this._dynamicBatches[z$p];0<z$c.combineRenderElementsCount&&z$c._addToRenderQueue(z$V,z$U,z$r,z$s)}},z$V.dispose=function(){this._dynamicBatches=null},z$L._sortPrepareDynamicBatch=function(z$V,z$U){return z$V._mainSortID-z$U._mainSortID},z$L}(),z$rV=function(){function z$V(){}return z$G(z$V,"laya.d3.graphics.FrustumCulling"),z$V.renderShadowObjectCulling=function(z$V,z$U,z$r,z$s,z$p){var z$c=0,z$R=0,z$T=0,z$N=0;for(z$c=0,z$T=z$r.length;z$c<z$T;z$c++){var z$t=z$r[z$c];z$t&&z$t._clearRenderElements()}var z$b,z$S,z$_,z$G=z$V._cullingRenders;if(1<z$p){for(z$c=0,z$T=z$V._cullingRendersLength;z$c<z$T;z$c++)if((z$b=z$G[z$c]).castShadow&&z$K.isVisible(z$b._owner.layer.mask)&&z$b.enable)for(var z$q=1,z$u=z$U.length;z$q<z$u;z$q++)if(z$S=z$r[z$q-1],0!==z$U[z$q].containsBoundSphere(z$b.boundingSphere))for(z$R=0,z$N=(z$_=z$b._renderElements).length;z$R<z$N;z$R++)z$S._addRenderElement(z$_[z$R])}else for(z$c=0,z$T=z$V._cullingRendersLength;z$c<z$T;z$c++)if((z$b=z$G[z$c]).castShadow&&z$K.isVisible(z$b._owner.layer.mask)&&z$b.enable&&0!==z$U[0].containsBoundSphere(z$b.boundingSphere))for(z$b._renderUpdate(z$s),z$S=z$r[0],z$R=0,z$N=(z$_=z$b._renderElements).length;z$R<z$N;z$R++)z$S._addRenderElement(z$_[z$R])},z$V.renderShadowObjectCullingOctree=function(z$V,z$U,z$r,z$s,z$p){for(var z$c=0,z$R=z$r.length;z$c<z$R;z$c++){var z$T=z$r[z$c];z$T&&z$T._clearRenderElements()}1<z$p?z$V.treeRoot.cullingShadowObjects(z$U,z$r,!0,0,z$V):z$V.treeRoot.cullingShadowObjectsOnePSSM(z$U[0],z$r,z$s,!0,0,z$V)},z$V.renderObjectCulling=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=0,z$T=0,z$N=0,z$t=0,z$b=z$U._quenes,z$S=z$U._dynamicBatchManager,z$_=z$U._cullingRenders;for(z$R=0,z$T=z$b.length;z$R<z$T;z$R++){var z$G=z$b[z$R];z$G&&z$G._clearRenderElements()}var z$q=z$sV._staticBatchManagers;for(z$R=0,z$T=z$q.length;z$R<z$T;z$R++)z$q[z$R]._clearRenderElements();z$S._clearRenderElements();var z$u=z$r.transform.position;for(z$R=0,z$T=z$U._cullingRendersLength;z$R<z$T;z$R++){var z$h=z$_[z$R];if(z$K.isVisible(z$h._owner.layer.mask)&&z$h.enable&&0!==z$V.containsBoundSphere(z$h.boundingSphere)&&z$h._renderUpdate(z$c)){z$h._distanceForSort=z$RU.distance(z$h.boundingSphere.center,z$u)+z$h.sortingFudge;var z$l=z$h._renderElements;for(z$N=0,z$t=z$l.length;z$N<z$t;z$N++){var z$W=z$l[z$N],z$O=z$W._staticBatch;if(z$O&&z$O._material===z$W._material)z$O._addBatchRenderElement(z$W);else{var z$L=z$W.renderObj;z$L.triangleCount<10&&1===z$L._vertexBufferCount&&z$L._getIndexBuffer()&&z$W._material.renderQueue<2&&z$W._canDynamicBatch&&!z$h._owner.isStatic?z$S._addPrepareRenderElement(z$W):z$U.getRenderQueue(z$W._material.renderQueue)._addRenderElement(z$W)}}}}for(z$R=0,z$T=z$q.length;z$R<z$T;z$R++)z$q[z$R]._addToRenderQueue(z$U,z$s,z$p,z$c);z$S._finishCombineDynamicBatch(z$U),z$S._addToRenderQueue(z$U,z$s,z$p,z$c)},z$V.renderObjectCullingOctree=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=0,z$T=0,z$N=z$U._quenes,z$t=z$U._dynamicBatchManager;for(z$R=0,z$T=z$N.length;z$R<z$T;z$R++){var z$b=z$N[z$R];z$b&&z$b._clearRenderElements()}var z$S=z$sV._staticBatchManagers;for(z$R=0,z$T=z$S.length;z$R<z$T;z$R++)z$S[z$R]._clearRenderElements();for(z$t._clearRenderElements(),z$U._cullingRenders.length=0,z$U.treeRoot.cullingObjects(z$V,!0,0,z$r.transform.position,z$c),z$R=0,z$T=z$S.length;z$R<z$T;z$R++)z$S[z$R]._addToRenderQueue(z$U,z$s,z$p,z$c);z$t._finishCombineDynamicBatch(z$U),z$t._addToRenderQueue(z$U,z$s,z$p,z$c)},z$V.renderObjectCullingNoBoundFrustum=function(z$V,z$U,z$r,z$s,z$p){var z$c=0,z$R=0,z$T=0,z$N=0,z$t=z$V._quenes,z$b=z$V._dynamicBatchManager,z$S=z$V._cullingRenders;for(z$c=0,z$R=z$t.length;z$c<z$R;z$c++){var z$_=z$t[z$c];z$_&&z$_._clearRenderElements()}var z$G=z$sV._staticBatchManagers;for(z$c=0,z$R=z$G.length;z$c<z$R;z$c++)z$G[z$c]._clearRenderElements();z$b._clearRenderElements();var z$q=z$U.transform.position;for(z$c=0,z$R=z$V._cullingRendersLength;z$c<z$R;z$c++){var z$u=z$S[z$c];if(z$K.isVisible(z$u._owner.layer.mask)&&z$u.enable){z$u._renderUpdate(z$p),z$u._distanceForSort=z$RU.distance(z$u.boundingSphere.center,z$q)+z$u.sortingFudge;var z$h=z$u._renderElements;for(z$T=0,z$N=z$h.length;z$T<z$N;z$T++){var z$l=z$h[z$T],z$W=z$l._staticBatch;if(z$W&&z$W._material===z$l._material)z$W._addBatchRenderElement(z$l);else{var z$O=z$l.renderObj;z$O.triangleCount<10&&1===z$O._vertexBufferCount&&z$O._getIndexBuffer()&&z$l._material.renderQueue<2&&z$l._canDynamicBatch&&!z$u._owner.isStatic?z$b._addPrepareRenderElement(z$l):z$V.getRenderQueue(z$l._material.renderQueue)._addRenderElement(z$l)}}}}for(z$c=0,z$R=z$G.length;z$c<z$R;z$c++)z$G[z$c]._addToRenderQueue(z$V,z$r,z$s,z$p);z$b._finishCombineDynamicBatch(z$V),z$b._addToRenderQueue(z$V,z$r,z$s,z$p)},z$V}(),z$sV=function(){function z$c(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}z$G(z$c,"laya.d3.graphics.StaticBatchManager");var z$V=z$c.prototype;return z$V._finishInit=function(){for(var z$V in this._staticBatches)this._staticBatches[z$V]._finishInit();this._initBatchRenderElements.length=0},z$V._initStaticBatchs=function(z$V){throw new Error("StaticBatchManager:must override this function.")},z$V._addInitBatchSprite=function(z$V){for(var z$U=z$V._render._renderElements,z$r=0,z$s=z$U.length;z$r<z$s;z$r++)this._initBatchRenderElements.push(z$U[z$r])},z$V._clearRenderElements=function(){for(var z$V in this._staticBatches)this._staticBatches[z$V]._clearRenderElements()},z$V._garbageCollection=function(z$V){var z$U=z$V._staticBatch,z$r=z$U._initBatchRenderElements,z$s=z$r.indexOf(z$V);z$r.splice(z$s,1),0===z$r.length&&(z$U.dispose(),delete this._staticBatches[z$U._key])},z$V._addToRenderQueue=function(z$V,z$U,z$r,z$s){for(var z$p in this._staticBatches){var z$c=this._staticBatches[z$p];0<z$c._batchRenderElements.length&&z$c._updateToRenderQueue(z$V,z$s)}},z$V.dispose=function(){this._staticBatches=null},z$c._addToStaticBatchQueue=function(z$V){z$V instanceof laya.d3.core.RenderableSprite3D&&z$V._addToInitStaticBatchManager();for(var z$U=0,z$r=z$V.numChildren;z$U<z$r;z$U++)z$c._addToStaticBatchQueue(z$V._childs[z$U])},z$c.combine=function(z$V,z$U){var z$r,z$s=0,z$p=0;if(z$U)for(z$s=0,z$p=z$U.length;z$s<z$p;z$s++){z$U[z$s]._addToInitStaticBatchManager()}else z$V&&z$c._addToStaticBatchQueue(z$V);for(z$s=0,z$p=z$c._staticBatchManagers.length;z$s<z$p;z$s++)(z$r=z$c._staticBatchManagers[z$s])._initStaticBatchs(z$V),z$r._finishInit()},z$c._staticBatchManagers=[],z$c}(),z$pV=function(){function z$V(z$V,z$U,z$r){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=z$V,this._manager=z$U,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=z$r}z$G(z$V,"laya.d3.graphics.StaticBatch");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),z$U._binarySearch=function(z$V){for(var z$U=0,z$r=this._batchRenderElements.length-1,z$s=0;z$U<=z$r;)z$s=Math.floor((z$U+z$r)/2),this._compareBatchRenderElement(this._batchRenderElements[z$s],z$V)?z$r=z$s-1:z$U=z$s+1;return z$U},z$U._compareBatchRenderElement=function(z$V,z$U){throw new Error("StaticBatch:must override this function.")},z$U._getVertexDecLightMap=function(z$V){return z$V===z$$V.vertexDeclaration?z$KV.vertexDeclaration:z$V===z$xV.vertexDeclaration?z$EV.vertexDeclaration:z$V===z$nV.vertexDeclaration?z$LV.vertexDeclaration:z$V===z$iV.vertexDeclaration?null:z$V===z$uV.vertexDeclaration?z$hV.vertexDeclaration:z$V===z$oV.vertexDeclaration?z$aV.vertexDeclaration:z$V===z$wV.vertexDeclaration?z$zV.vertexDeclaration:z$V===z$jV.vertexDeclaration?z$mV.vertexDeclaration:z$V===z$xV.vertexDeclaration?z$EV.vertexDeclaration:z$V===z$IV.vertexDeclaration?z$dV.vertexDeclaration:z$V===z$iV.vertexDeclaration?null:z$V===z$uV.vertexDeclaration?z$hV.vertexDeclaration:z$V===z$JV.vertexDeclaration?z$ZV.vertexDeclaration:z$V===z$wV.vertexDeclaration?z$zV.vertexDeclaration:z$V},z$U._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},z$U._addBatchRenderElement=function(z$V){this._batchRenderElements.splice(this._binarySearch(z$V),0,z$V)},z$U._updateToRenderQueue=function(z$V,z$U){this._combineRenderElementPoolIndex=0,this._getRenderElement(z$V.getRenderQueue(this._material.renderQueue)._renderElements,z$V,z$U)},z$U._getRenderElement=function(z$V,z$U,z$r){throw new Error("StaticBatch:must override this function.")},z$U._finishInit=function(){throw new Error("StaticBatch:must override this function.")},z$U._clearRenderElements=function(){this._batchRenderElements.length=0},z$U.dispose=function(){},z$U._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),null},z$U._getIndexBuffer=function(){return null},z$U._beforeRender=function(z$V){return!0},z$U._render=function(z$V){},z$U._getVertexBuffers=function(){return null},z$q(0,z$U,"_vertexBufferCount",function(){return 1}),z$q(0,z$U,"triangleCount",function(){return 0}),z$V.combine=function(z$V){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),z$sV.combine(z$V)},z$V.maxBatchVertexCount=65535,z$V}(),z$cV=function(){function z$R(z$V,z$U){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++z$R._uniqueIDCounter,this._id>z$R.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",z$R.maxVertexDeclaration);this._shaderValues=new z$_U,this._vertexElementsDic={},this._vertexStride=z$V,this._vertexElements=z$U;for(var z$r=0;z$r<z$U.length;z$r++){var z$s=z$U[z$r],z$p=z$s.elementUsage;this._vertexElementsDic[z$p]=z$s;var z$c=[z$R._getTypeSize(z$s.elementFormat)/4,5126,!1,this._vertexStride,z$s.offset];switch(this._shaderValues.setValue(z$p,z$c),z$p){case 1:this._addShaderDefine(z$DU.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(z$DU.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(z$DU.SHADERDEFINE_UV1)}}}z$G(z$R,"laya.d3.graphics.VertexDeclaration");var z$V=z$R.prototype;return z$V._addShaderDefine=function(z$V){this._shaderDefineValue|=z$V},z$V._removeShaderDefine=function(z$V){this._shaderDefineValue&=~z$V},z$V.getVertexElements=function(){return this._vertexElements.slice()},z$V.getVertexElementByUsage=function(z$V){return this._vertexElementsDic[z$V]},z$V.unBinding=function(){},z$q(0,z$V,"shaderDefineValue",function(){return this._shaderDefineValue}),z$q(0,z$V,"id",function(){return this._id}),z$q(0,z$V,"vertexStride",function(){return this._vertexStride}),z$q(0,z$V,"shaderValues",function(){return this._shaderValues}),z$R._getTypeSize=function(z$V){switch(z$V){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},z$R.getVertexStride=function(z$V){for(var z$U=0,z$r=0;z$r<z$V.Length;z$r++){var z$s=z$V[z$r],z$p=z$s.offset+z$R._getTypeSize(z$s.elementFormat);z$U<z$p&&(z$U=z$p)}return z$U},z$R._maxVertexDeclarationBit=1e3,z$R._uniqueIDCounter=1,z$S(z$R,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),z$R}(),z$RV=function(){function z$V(z$V,z$U,z$r){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=z$V,this.elementFormat=z$U,this.elementUsage=z$r}return z$G(z$V,"laya.d3.graphics.VertexElement"),z$V}(),z$TV=(function(){function z$V(){}z$G(z$V,"laya.d3.graphics.VertexElementFormat"),z$V.Single="single",z$V.Vector2="vector2",z$V.Vector3="vector3",z$V.Vector4="vector4",z$V.Color="color",z$V.Byte4="byte4",z$V.Short2="short2",z$V.Short4="short4",z$V.NormalizedShort2="normalizedshort2",z$V.NormalizedShort4="normalizedshort4",z$V.HalfVector2="halfvector2",z$V.HalfVector4="halfvector4"}(),function(){function z$V(){}z$G(z$V,"laya.d3.graphics.VertexElementUsage"),z$V.POSITION0=0,z$V.COLOR0=1,z$V.TEXTURECOORDINATE0=2,z$V.NORMAL0=3,z$V.BINORMAL0=4,z$V.TANGENT0=5,z$V.BLENDINDICES0=6,z$V.BLENDWEIGHT0=7,z$V.DEPTH0=8,z$V.FOG0=9,z$V.POINTSIZE0=10,z$V.SAMPLE0=11,z$V.TESSELLATEFACTOR0=12,z$V.COLOR1=13,z$V.NEXTTEXTURECOORDINATE0=14,z$V.TEXTURECOORDINATE1=15,z$V.NEXTTEXTURECOORDINATE1=16,z$V.CORNERTEXTURECOORDINATE0=17,z$V.VELOCITY0=18,z$V.STARTCOLOR0=19,z$V.STARTSIZE=20,z$V.AGEADDSCALE0=21,z$V.STARTROTATION=22,z$V.ENDCOLOR0=23,z$V.STARTLIFETIME=24,z$V.TIME0=33,z$V.SHAPEPOSITIONSTARTLIFETIME=30,z$V.DIRECTIONTIME=32,z$V.SIZEROTATION0=27,z$V.RADIUS0=28,z$V.RADIAN0=29,z$V.STARTSPEED=31,z$V.RANDOM0=34,z$V.RANDOM1=35,z$V.SIMULATIONWORLDPOSTION=36,z$V.SIMULATIONWORLDROTATION=37,z$V.TEXTURECOORDINATE0X=38,z$V.TEXTURECOORDINATE0X1=39,z$V.TEXTURECOORDINATE0Y=40,z$V.OFFSETVECTOR=41}(),function(){function z$V(z$V,z$U,z$r){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=z$V,this._textureCoordinate0=z$U,this._time=z$r}z$G(z$V,"laya.d3.graphics.VertexGlitter");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate0}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"time",function(){return this._time}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(24,[new z$RV(0,"vector3",0),new z$RV(12,"vector2",2),new z$RV(20,"single",33)])}])}(),function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=z$V,this._position=z$U,this._velocity=z$r,this._startColor=z$s,this._endColor=z$p,this._sizeRotation=z$c,this._radius=z$R,this._radian=z$T,this._ageAddScale=z$N,this._time=z$t}z$G(z$V,"laya.d3.graphics.VertexParticle");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"endColor",function(){return this._endColor}),z$q(0,z$U,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),z$q(0,z$U,"sizeRotation",function(){return this._sizeRotation}),z$q(0,z$U,"velocity",function(){return this._velocity}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"startColor",function(){return this._startColor}),z$q(0,z$U,"radius",function(){return this._radius}),z$q(0,z$U,"radian",function(){return this._radian}),z$q(0,z$U,"ageAddScale",function(){return this._ageAddScale}),z$q(0,z$U,"time",function(){return this._time}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(116,[new z$RV(0,"vector4",17),new z$RV(16,"vector3",0),new z$RV(28,"vector3",18),new z$RV(40,"vector4",19),new z$RV(56,"vector4",23),new z$RV(72,"vector3",27),new z$RV(84,"vector2",28),new z$RV(92,"vector4",29),new z$RV(108,"single",24),new z$RV(112,"single",33)])}])}(),function(){function z$V(z$V){this._position=null,this._position=z$V}z$G(z$V,"laya.d3.graphics.VertexPosition");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(12,[new z$RV(0,"vector3",0)])}]),z$V}()),z$NV=function(){function z$V(z$V,z$U){this._position=null,this._normal=null,this._position=z$V,this._normal=z$U}z$G(z$V,"laya.d3.graphics.VertexPositionNormal");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(24,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3)])}]),z$V}(),z$tV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._color=null,this._position=z$V,this._normal=z$U,this._color=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColor");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(40,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1)])}]),z$V}(),z$bV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._blendIndex=z$s,this._blendWeight=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorSkin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(72,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6)])}]),z$V}(),z$SV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._tangent=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(88,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6),new z$RV(72,"vector4",5)])}]),z$V}(),z$_V=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._tangent=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(84,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6),new z$RV(72,"vector3",5)])}]),z$V}(),z$GV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._tangent=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(56,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector4",5)])}]),z$V}(),z$qV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._tangent=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(52,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector3",5)])}]),z$V}(),z$uV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(48,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2)])}]),z$V}(),z$hV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(56,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15)])}]),z$V}(),z$lV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._blendIndex=z$c,this._blendWeight=z$R}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(88,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15),new z$RV(56,"vector4",7),new z$RV(72,"vector4",6)])}]),z$V}(),z$WV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._tangent=z$c,this._blendIndex=z$R,this._blendWeight=z$T}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(104,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15),new z$RV(56,"vector4",7),new z$RV(72,"vector4",6),new z$RV(88,"vector4",5)])}]),z$V}(),z$OV=function(){function z$V(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$U.VertexPositionNormalColorTexture0SkinTangent=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._tangent=z$c,this._blendIndex=z$R,this._blendWeight=z$T},z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(100,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15),new z$RV(56,"vector4",7),new z$RV(72,"vector4",6),new z$RV(88,"vector3",5)])}]),z$V}(),z$LV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._tangent=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(72,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15),new z$RV(56,"vector4",5)])}]),z$V}(),z$dV=function(){function z$V(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$U.VertexPositionNormalColorTexture0Tangent=function(z$V,z$U,z$r,z$s,z$p,z$c){this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._tangent=z$c},z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(68,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector2",15),new z$RV(56,"vector3",5)])}]),z$V}(),z$kV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(80,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector4",7),new z$RV(64,"vector4",6)])}]),z$V}(),z$yV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s,this._tangent=z$p,this._blendIndex=z$c,this._blendWeight=z$R}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(96,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector4",7),new z$RV(64,"vector4",6),new z$RV(80,"vector4",5)])}]),z$V}(),z$DV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s,this._tangent=z$p,this._blendIndex=z$c,this._blendWeight=z$R}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(92,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector4",7),new z$RV(64,"vector4",6),new z$RV(80,"vector3",5)])}]),z$V}(),z$nV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s,this._tangent=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(64,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector4",5)])}]),z$V}(),z$IV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._color=z$r,this._textureCoordinate=z$s,this._tangent=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"color",function(){return this._color}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(60,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",1),new z$RV(40,"vector2",2),new z$RV(48,"vector3",5)])}]),z$V}(),z$QV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._tangent=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNormalSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(40,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector4",5)])}]),z$V}(),z$HV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._tangent=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(36,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector3",5)])}]),z$V}(),z$wV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(32,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2)])}]),z$V}(),z$zV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(40,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15)])}]),z$V}(),z$EV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(72,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6)])}]),z$V}(),z$KV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s,this._tangent=z$p,this._blendIndex=z$c,this._blendWeight=z$R}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(88,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6),new z$RV(72,"vector4",5)])}]),z$V}(),z$mV=function(){function z$V(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$U.VertexPositionNormalTexture0SkinTangent=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s,this._tangent=z$p,this._blendIndex=z$c,this._blendWeight=z$R},z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(84,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15),new z$RV(40,"vector4",7),new z$RV(56,"vector4",6),new z$RV(72,"vector3",5)])}]),z$V}(),z$aV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s,this._tangent=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(56,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15),new z$RV(40,"vector4",5)])}]),z$V}(),z$ZV=function(){function z$V(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$U.VertexPositionNormalTexture0Tangent=function(z$V,z$U,z$r,z$s,z$p){this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$r,this._textureCoordinate1=z$s,this._tangent=z$p},z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(52,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15),new z$RV(40,"vector3",5)])}]),z$V}(),z$xV=function(){function z$V(z$V,z$U,z$r,z$s,z$p){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r,this._blendIndex=z$s,this._blendWeight=z$p}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTextureSkin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(64,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector4",7),new z$RV(48,"vector4",6)])}]),z$V}(),z$$V=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r,this._tangent=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(80,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector4",7),new z$RV(48,"vector4",6),new z$RV(64,"vector4",5)])}]),z$V}(),z$jV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r,this._tangent=z$s,this._blendIndex=z$p,this._blendWeight=z$c}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(76,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector4",7),new z$RV(48,"vector4",6),new z$RV(64,"vector3",5)])}]),z$V}(),z$oV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r,this._tangent=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(48,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector4",5)])}]),z$V}(),z$JV=function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r,this._tangent=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionNormalTextureTangent");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(44,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector3",5)])}]),z$V}(),z$iV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNTBTexture");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(56,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector3",5),new z$RV(36,"vector3",4),new z$RV(48,"vector2",2)])}]),z$V}(),z$BV=function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=z$V,this._normal=z$U,this._textureCoordinate0=z$s,this._textureCoordinate1=z$p,this._tangent=z$c,z$r=z$r,this._blendIndex=z$R,this._blendWeight=z$T}z$G(z$V,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"tangent",function(){return this._tangent}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(0,z$U,"textureCoordinate1",function(){return this._textureCoordinate1}),z$q(0,z$U,"blendIndex",function(){return this._blendIndex}),z$q(0,z$U,"blendWeight",function(){return this._blendWeight}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(96,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector3",5),new z$RV(36,"vector3",4),new z$RV(48,"vector2",2),new z$RV(56,"vector2",15),new z$RV(64,"vector4",7),new z$RV(80,"vector4",6)])}]),z$V}(),z$PV=function(){function z$V(z$V,z$U,z$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=z$V,this._normal=z$U,this._textureCoordinate=z$r}z$G(z$V,"laya.d3.graphics.VertexPositionNTBTextureSkin");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"textureCoordinate",function(){return this._textureCoordinate}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(88,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector3",5),new z$RV(36,"vector3",4),new z$RV(48,"vector2",2),new z$RV(56,"vector4",7),new z$RV(72,"vector4",6)])}]),z$V}(),z$MV=(function(){function z$V(z$V,z$U,z$r,z$s){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=z$V,this._normal=z$U,this._textureCoord0=z$r,this._textureCoord1=z$s}z$G(z$V,"laya.d3.graphics.VertexPositionTerrain");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"normal",function(){return this._normal}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoord0",function(){return this._textureCoord0}),z$q(0,z$U,"textureCoord1",function(){return this._textureCoord1}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(40,[new z$RV(0,"vector3",0),new z$RV(12,"vector3",3),new z$RV(24,"vector2",2),new z$RV(32,"vector2",15)])}])}(),function(){function z$V(z$V,z$U){this._position=null,this._textureCoordinate0=null,this._position=z$V,this._textureCoordinate0=z$U}z$G(z$V,"laya.d3.graphics.VertexPositionTexture0");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"position",function(){return this._position}),z$q(0,z$U,"textureCoordinate0",function(){return this._textureCoordinate0}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(20,[new z$RV(0,"vector3",0),new z$RV(12,"vector2",2)])}]),z$V}()),z$AV=(function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_,z$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=z$V,this._positionStartLifeTime=z$U,this._velocity=z$r,this._startColor=z$s,this._startSize=z$p,this._startRotation0=z$c,this._startRotation1=z$R,this._startRotation2=z$T,this._startLifeTime=z$N,this._time=z$t,this._startSpeed=z$b,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=z$G}z$G(z$V,"laya.d3.graphics.VertexShurikenParticleBillboard");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),z$q(0,z$U,"random1",function(){return this._randoms1}),z$q(0,z$U,"startRotation2",function(){return this._startRotation2}),z$q(0,z$U,"positionStartLifeTime",function(){return this._positionStartLifeTime}),z$q(0,z$U,"velocity",function(){return this._velocity}),z$q(0,z$U,"random0",function(){return this._randoms0}),z$q(0,z$U,"startSize",function(){return this._startSize}),z$q(0,z$U,"startColor",function(){return this._startColor}),z$q(0,z$U,"startRotation0",function(){return this._startRotation0}),z$q(0,z$U,"startRotation1",function(){return this._startRotation1}),z$q(0,z$U,"startLifeTime",function(){return this._startLifeTime}),z$q(0,z$U,"time",function(){return this._time}),z$q(0,z$U,"startSpeed",function(){return this._startSpeed}),z$q(0,z$U,"simulationWorldPostion",function(){return this._simulationWorldPostion}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(152,[new z$RV(0,"vector4",17),new z$RV(16,"vector4",30),new z$RV(32,"vector4",32),new z$RV(48,"vector4",19),new z$RV(64,"vector3",20),new z$RV(76,"vector3",22),new z$RV(88,"single",31),new z$RV(92,"vector4",34),new z$RV(108,"vector4",35),new z$RV(124,"vector3",36),new z$RV(136,"vector4",37)])}])}(),function(){function z$V(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_,z$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=z$V,this._positionStartLifeTime=z$U,this._velocity=z$r,this._startColor=z$s,this._startSize=z$p,this._startRotation0=z$c,this._startRotation1=z$R,this._startRotation2=z$T,this._startLifeTime=z$N,this._time=z$t,this._startSpeed=z$b,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=z$G}z$G(z$V,"laya.d3.graphics.VertexShurikenParticleMesh");var z$U=z$V.prototype;z$d.imps(z$U,{"laya.d3.graphics.IVertex":!0}),z$q(0,z$U,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),z$q(0,z$U,"velocity",function(){return this._velocity}),z$q(0,z$U,"position",function(){return this._positionStartLifeTime}),z$q(0,z$U,"random0",function(){return this._randoms0}),z$q(0,z$U,"startSize",function(){return this._startSize}),z$q(0,z$U,"startColor",function(){return this._startColor}),z$q(0,z$U,"startRotation0",function(){return this._startRotation0}),z$q(0,z$U,"startRotation1",function(){return this._startRotation1}),z$q(0,z$U,"random1",function(){return this._randoms1}),z$q(0,z$U,"startRotation2",function(){return this._startRotation2}),z$q(0,z$U,"startLifeTime",function(){return this._startLifeTime}),z$q(0,z$U,"time",function(){return this._time}),z$q(0,z$U,"startSpeed",function(){return this._startSpeed}),z$q(0,z$U,"simulationWorldPostion",function(){return this._simulationWorldPostion}),z$q(0,z$U,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$q(1,z$V,"vertexDeclaration",function(){return z$V._vertexDeclaration}),z$S(z$V,["_vertexDeclaration",function(){return this._vertexDeclaration=new z$cV(172,[new z$RV(0,"vector3",0),new z$RV(12,"vector4",1),new z$RV(28,"vector2",2),new z$RV(36,"vector4",30),new z$RV(52,"vector4",32),new z$RV(68,"vector4",19),new z$RV(84,"vector3",20),new z$RV(96,"vector3",22),new z$RV(108,"single",31),new z$RV(112,"vector4",34),new z$RV(128,"vector4",35),new z$RV(144,"vector3",36),new z$RV(156,"vector4",37)])}])}(),function(){function z$O(z$V,z$U,z$r,z$s,z$p,z$c){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=z$r,this._materials=z$s,this._subMeshes=z$p,this._materialMap=z$c,this._version=z$U,this._onLoaded(z$V)}z$G(z$O,"laya.d3.loaders.LoadModelV01");var z$V=z$O.prototype;return z$V._onLoaded=function(z$V){this._readData=z$V,this.READ_BLOCK();for(var z$U=0;z$U<this._BLOCK.count;z$U++){var z$r=this._readData.getUint16(),z$s=this._strings[z$r],z$p=this["READ_"+z$s];if(null==z$p)throw new Error("model file err,no this function:"+z$r+" "+z$s);if(!z$p.call(this))break}return this._mesh},z$V.onError=function(){},z$V._readString=function(){return this._strings[this._readData.getUint16()]},z$V.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},z$V.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},z$V.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var z$V=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var z$U=0;z$U<this._STRINGS.size;z$U++)this._strings[z$U]=this._readData.readUTFString();return this._readData.pos=z$V,!0},z$V.READ_MATERIAL=function(){var z$V=this._readData.getUint16(),z$U=(this._readString(),this._readString());return this._materials[z$V]="null"!==z$U?z$l.getRes(this._materialMap[z$U]):new z$HU,!0},z$V.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var z$V,z$U=this._readData.__getBuffer(),z$r=0,z$s=this._readData.getUint32(),z$p=this._readData.getUint32(),z$c=(new Float32Array(z$U.slice(z$s+this._DATA.offset,z$s+this._DATA.offset+z$p)),this._readData.getUint32()),z$R=this._readData.getUint32(),z$T=new Float32Array(z$U.slice(z$c+this._DATA.offset,z$c+this._DATA.offset+z$R));for(this.mesh._inverseBindPoses=[],z$r=0,z$V=z$T.length;z$r<z$V;z$r+=16){var z$N=new z$VU(z$T[z$r+0],z$T[z$r+1],z$T[z$r+2],z$T[z$r+3],z$T[z$r+4],z$T[z$r+5],z$T[z$r+6],z$T[z$r+7],z$T[z$r+8],z$T[z$r+9],z$T[z$r+10],z$T[z$r+11],z$T[z$r+12],z$T[z$r+13],z$T[z$r+14],z$T[z$r+15]);this.mesh._inverseBindPoses.push(z$N)}break;default:throw new Error("LoadModel:unknown version.")}return!0},z$V.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var z$V=this._readString();this._shaderAttributes=z$V.match(z$O._attrReg);var z$U=this._readData.getUint32(),z$r=this._readData.getUint32(),z$s=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),z$p=this._readData.getUint32(),z$c=this._readData.getUint32(),z$R=this._readData.getUint32(),z$T=this._readData.__getBuffer(),z$N=new z$tU(this._mesh),z$t=this._getVertexDeclaration(),z$b=z$jU.create(z$t,z$p/z$t.vertexStride,35044,!0),z$S=z$s+this._DATA.offset,z$_=z$T.slice(z$S,z$S+z$p);z$b.setData(new Float32Array(z$_));for(var z$G=(z$N._vertexBuffer=z$b).vertexDeclaration.getVertexElements(),z$q=0;z$q<z$G.length;z$q++)z$N._bufferUsage[z$G[z$q].elementUsage]=z$b;var z$u=z$$U.create("ushort",z$r/2,35044,!0),z$h=z$U+this._DATA.offset,z$l=z$T.slice(z$h,z$h+z$r);z$u.setData(new Uint16Array(z$l)),z$N._indexBuffer=z$u;var z$W=z$T.slice(z$c+this._DATA.offset,z$c+this._DATA.offset+z$R);return z$N._boneIndicesList[0]=new Uint8Array(z$W),this._subMeshes.push(z$N),!0},z$V.READ_DATAAREA=function(){return!1},z$V._getVertexDeclaration=function(){for(var z$V,z$U=!1,z$r=!1,z$s=!1,z$p=!1,z$c=!1,z$R=!1,z$T=!1,z$N=!1,z$t=!1,z$b=0;z$b<this._shaderAttributes.length;z$b+=8)switch(this._shaderAttributes[z$b]){case"POSITION":z$U=!0;break;case"NORMAL":z$r=!0;break;case"COLOR":z$s=!0;break;case"UV":z$p=!0;break;case"UV1":z$c=!0;break;case"BLENDWEIGHT":z$T=!0;break;case"BLENDINDICES":z$N=!0;break;case"TANGENT":z$R=!0;break;case"BINORMAL":z$t=!0}return z$U&&z$r&&z$s&&z$p&&z$c&&z$T&&z$N&&z$R?z$V=z$OV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$c&&z$T&&z$N?z$V=z$lV.vertexDeclaration:z$U&&z$r&&z$p&&z$c&&z$T&&z$N&&z$R?z$V=z$mV.vertexDeclaration:z$U&&z$r&&z$p&&z$c&&z$T&&z$N?z$V=z$EV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$T&&z$N&&z$R?z$V=z$DV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$T&&z$N?z$V=z$kV.vertexDeclaration:z$U&&z$r&&z$R&&z$t&&z$p&&z$T&&z$N?z$V=z$PV.vertexDeclaration:z$U&&z$r&&z$p&&z$T&&z$N&&z$R?z$V=z$jV.vertexDeclaration:z$U&&z$r&&z$p&&z$T&&z$N?z$V=z$xV.vertexDeclaration:z$U&&z$r&&z$s&&z$T&&z$N&&z$R?z$V=z$_V.vertexDeclaration:z$U&&z$r&&z$s&&z$T&&z$N?z$V=z$bV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$c&&z$R?z$V=z$dV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$c?z$V=z$hV.vertexDeclaration:z$U&&z$r&&z$p&&z$c&&z$R?z$V=z$ZV.vertexDeclaration:z$U&&z$r&&z$p&&z$c?z$V=z$zV.vertexDeclaration:z$U&&z$r&&z$s&&z$p&&z$R?z$V=z$IV.vertexDeclaration:z$U&&z$r&&z$p&&z$R&&z$t?z$V=z$iV.vertexDeclaration:z$U&&z$r&&z$s&&z$p?z$V=z$uV.vertexDeclaration:z$U&&z$r&&z$p&&z$R?z$V=z$JV.vertexDeclaration:z$U&&z$r&&z$p?z$V=z$wV.vertexDeclaration:z$U&&z$r&&z$s&&z$R?z$V=z$qV.vertexDeclaration:z$U&&z$r&&z$s&&(z$V=z$tV.vertexDeclaration),z$V},z$q(0,z$V,"mesh",function(){return this._mesh}),z$O._attrReg=new RegExp("(\\w+)|([:,;])","g"),z$O}()),z$XV=function(){function z$y(){}return z$G(z$y,"laya.d3.loaders.LoadModelV02"),z$y.parse=function(z$V,z$U,z$r,z$s,z$p,z$c){z$y._mesh=z$r,z$y._materials=z$s,z$y._subMeshes=z$p,z$y._materialMap=z$c,z$y._version=z$U,z$y._readData=z$V,z$y.READ_DATA(),z$y.READ_BLOCK(),z$y.READ_STRINGS();for(var z$R=0,z$T=z$y._BLOCK.count;z$R<z$T;z$R++){z$y._readData.pos=z$y._BLOCK.blockStarts[z$R];var z$N=z$y._readData.getUint16(),z$t=z$y._strings[z$N],z$b=z$y["READ_"+z$t];if(null==z$b)throw new Error("model file err,no this function:"+z$N+" "+z$t);z$b.call()}z$y._strings.length=0,z$y._readData=null,z$y._version=null,z$y._mesh=null,z$y._materials=null,z$y._subMeshes=null,z$y._materialMap=null},z$y._readString=function(){return z$y._strings[z$y._readData.getUint16()]},z$y.READ_DATA=function(){z$y._DATA.offset=z$y._readData.getUint32(),z$y._DATA.size=z$y._readData.getUint32()},z$y.READ_BLOCK=function(){for(var z$V=z$y._BLOCK.count=z$y._readData.getUint16(),z$U=z$y._BLOCK.blockStarts=[],z$r=z$y._BLOCK.blockLengths=[],z$s=0;z$s<z$V;z$s++)z$U.push(z$y._readData.getUint32()),z$r.push(z$y._readData.getUint32())},z$y.READ_STRINGS=function(){var z$V=z$y._readData.getUint32(),z$U=z$y._readData.getUint16(),z$r=z$y._readData.pos;z$y._readData.pos=z$V+z$y._DATA.offset;for(var z$s=0;z$s<z$U;z$s++)z$y._strings[z$s]=z$y._readData.readUTFString();z$y._readData.pos=z$r},z$y.READ_MATERIAL=function(){z$y._readString(),z$y._readString();var z$V=z$y._readString();return""!==z$V&&z$y._materials.push(z$l.getRes(z$y._materialMap[z$V])),!0},z$y.READ_MESH=function(){z$y._readString();var z$V,z$U=z$y._readData.__getBuffer(),z$r=0,z$s=z$y._readData.getInt16(),z$p=z$y._DATA.offset;for(z$r=0;z$r<z$s;z$r++){var z$c=z$p+z$y._readData.getUint32(),z$R=z$y._readData.getUint32(),z$T=new Float32Array(z$U.slice(z$c,z$c+z$R)),z$N=z$y._readString().match(z$y._attrReg),z$t=z$y._getVertexDeclaration(z$N),z$b=z$jU.create(z$t,4*z$T.length/z$t.vertexStride,35044,!0);z$b.setData(z$T),z$y._mesh._vertexBuffers.push(z$b)}var z$S=z$p+z$y._readData.getUint32(),z$_=z$y._readData.getUint32(),z$G=new Uint16Array(z$U.slice(z$S,z$S+z$_)),z$q=z$$U.create("ushort",z$_/2,35044,!0);z$q.setData(z$G),z$y._mesh._indexBuffer=z$q;var z$u=z$y._mesh._boneNames=[],z$h=z$y._readData.getUint16();for(z$u.length=z$h,z$r=0;z$r<z$h;z$r++)z$u[z$r]=z$y._strings[z$y._readData.getUint16()];var z$l=z$y._readData.getUint32(),z$W=z$y._readData.getUint32(),z$O=(new Float32Array(z$U.slice(z$p+z$l,z$p+z$l+z$W)),z$y._readData.getUint32()),z$L=z$y._readData.getUint32(),z$d=new Float32Array(z$U.slice(z$p+z$O,z$p+z$O+z$L));for(z$y._mesh._inverseBindPoses=[],z$r=0,z$V=z$d.length;z$r<z$V;z$r+=16){var z$k=new z$VU(z$d[z$r+0],z$d[z$r+1],z$d[z$r+2],z$d[z$r+3],z$d[z$r+4],z$d[z$r+5],z$d[z$r+6],z$d[z$r+7],z$d[z$r+8],z$d[z$r+9],z$d[z$r+10],z$d[z$r+11],z$d[z$r+12],z$d[z$r+13],z$d[z$r+14],z$d[z$r+15]);z$y._mesh._inverseBindPoses.push(z$k)}return z$y._mesh._skinnedDatas=new Float32Array(16*z$d.length),!0},z$y.READ_SUBMESH=function(){var z$V=z$y._readData.__getBuffer(),z$U=new z$tU(z$y._mesh),z$r=z$y._readData.getInt16(),z$s=z$y._readData.getUint32(),z$p=z$y._readData.getUint32();z$U._vertexBuffer=z$y._mesh._vertexBuffers[z$r],z$U._vertexStart=z$s,z$U._vertexCount=z$p;var z$c=z$y._readData.getUint32(),z$R=z$y._readData.getUint32(),z$T=z$y._mesh._indexBuffer;z$U._indexBuffer=z$T,z$U._indexStart=z$c,z$U._indexCount=z$R,z$U._indices=new Uint16Array(z$T.getData().buffer,2*z$c,z$R);var z$N=z$y._DATA.offset,z$t=z$U._subIndexBufferStart,z$b=z$U._subIndexBufferCount,z$S=z$U._boneIndicesList,z$_=z$y._readData.getUint16();z$t.length=z$_,z$b.length=z$_,z$S.length=z$_;for(var z$G=0;z$G<z$_;z$G++){z$t[z$G]=z$y._readData.getUint32(),z$b[z$G]=z$y._readData.getUint32();var z$q=z$y._readData.getUint32(),z$u=z$y._readData.getUint32();z$U._boneIndicesList[z$G]=new Uint8Array(z$V.slice(z$N+z$q,z$N+z$q+z$u))}return z$y._subMeshes.push(z$U),!0},z$y._getVertexDeclaration=function(z$V){for(var z$U,z$r=!1,z$s=!1,z$p=!1,z$c=!1,z$R=!1,z$T=!1,z$N=!1,z$t=!1,z$b=!1,z$S=0;z$S<z$V.length;z$S++)switch(z$V[z$S]){case"POSITION":z$r=!0;break;case"NORMAL":z$s=!0;break;case"COLOR":z$p=!0;break;case"UV":z$c=!0;break;case"UV1":z$R=!0;break;case"BLENDWEIGHT":z$N=!0;break;case"BLENDINDICES":z$t=!0;break;case"TANGENT":z$T=!0;break;case"BINORMAL":z$b=!0}return z$r&&z$s&&z$p&&z$c&&z$R&&z$N&&z$t&&z$T?z$U=z$OV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$R&&z$N&&z$t?z$U=z$lV.vertexDeclaration:z$r&&z$s&&z$c&&z$R&&z$N&&z$t&&z$T?z$U=z$mV.vertexDeclaration:z$r&&z$s&&z$c&&z$R&&z$N&&z$t?z$U=z$EV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$N&&z$t&&z$T?z$U=z$DV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$N&&z$t?z$U=z$kV.vertexDeclaration:z$r&&z$s&&z$c&&z$N&&z$t&&z$T?z$U=z$jV.vertexDeclaration:z$r&&z$s&&z$c&&z$N&&z$t?z$U=z$xV.vertexDeclaration:z$r&&z$s&&z$p&&z$N&&z$t&&z$T?z$U=z$_V.vertexDeclaration:z$r&&z$s&&z$p&&z$N&&z$t?z$U=z$bV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$R&&z$T?z$U=z$dV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$R?z$U=z$hV.vertexDeclaration:z$r&&z$s&&z$c&&z$R&&z$T?z$U=z$ZV.vertexDeclaration:z$r&&z$s&&z$c&&z$R?z$U=z$zV.vertexDeclaration:z$r&&z$s&&z$p&&z$c&&z$T?z$U=z$IV.vertexDeclaration:z$r&&z$s&&z$c&&z$T&&z$b?z$U=z$iV.vertexDeclaration:z$r&&z$s&&z$p&&z$c?z$U=z$uV.vertexDeclaration:z$r&&z$s&&z$c&&z$T?z$U=z$JV.vertexDeclaration:z$r&&z$s&&z$c?z$U=z$wV.vertexDeclaration:z$r&&z$s&&z$p&&z$T?z$U=z$qV.vertexDeclaration:z$r&&z$s&&z$p&&(z$U=z$tV.vertexDeclaration),z$U},z$y._attrReg=new RegExp("(\\w+)|([:,;])","g"),z$y._strings=[],z$y._readData=null,z$y._version=null,z$y._mesh=null,z$y._materials=null,z$y._subMeshes=null,z$y._materialMap=null,z$S(z$y,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),z$y}(),z$eV=function(){function z$k(){}return z$G(z$k,"laya.d3.loaders.LoadModelV03"),z$k.parse=function(z$V,z$U,z$r,z$s,z$p){z$k._mesh=z$r,z$k._subMeshes=z$s,z$k._materialMap=z$p,z$k._version=z$U,z$k._readData=z$V,z$k.READ_DATA(),z$k.READ_BLOCK(),z$k.READ_STRINGS();for(var z$c=0,z$R=z$k._BLOCK.count;z$c<z$R;z$c++){z$k._readData.pos=z$k._BLOCK.blockStarts[z$c];var z$T=z$k._readData.getUint16(),z$N=z$k._strings[z$T],z$t=z$k["READ_"+z$N];if(null==z$t)throw new Error("model file err,no this function:"+z$T+" "+z$N);z$t.call()}z$k._strings.length=0,z$k._readData=null,z$k._version=null,z$k._mesh=null,z$k._subMeshes=null,z$k._materialMap=null},z$k._readString=function(){return z$k._strings[z$k._readData.getUint16()]},z$k.READ_DATA=function(){z$k._DATA.offset=z$k._readData.getUint32(),z$k._DATA.size=z$k._readData.getUint32()},z$k.READ_BLOCK=function(){for(var z$V=z$k._BLOCK.count=z$k._readData.getUint16(),z$U=z$k._BLOCK.blockStarts=[],z$r=z$k._BLOCK.blockLengths=[],z$s=0;z$s<z$V;z$s++)z$U.push(z$k._readData.getUint32()),z$r.push(z$k._readData.getUint32())},z$k.READ_STRINGS=function(){var z$V=z$k._readData.getUint32(),z$U=z$k._readData.getUint16(),z$r=z$k._readData.pos;z$k._readData.pos=z$V+z$k._DATA.offset;for(var z$s=0;z$s<z$U;z$s++)z$k._strings[z$s]=z$k._readData.readUTFString();z$k._readData.pos=z$r},z$k.READ_MESH=function(){var z$V,z$U=z$k._readString(),z$r=z$k._readData.__getBuffer(),z$s=0,z$p=z$k._readData.getInt16(),z$c=z$k._DATA.offset;for(z$s=0;z$s<z$p;z$s++){var z$R,z$T=z$c+z$k._readData.getUint32(),z$N=z$k._readData.getUint32(),z$t=new Float32Array(z$r.slice(z$T,z$T+z$N)),z$b=z$k._readString();switch(z$k._version){case"LAYAMODEL:03":z$R=z$k._vertexDeclarationMap_Discard[z$b];break;case"LAYAMODEL:0301":z$R=z$k._vertexDeclarationMap[z$b];break;default:throw new Error("LoadModelV03: unknown version.")}if(!z$R)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+z$k._version+"  bufferAttribute="+z$b+"  name="+z$U+"  url="+(z$k._mesh?z$k._mesh.url:"null"));var z$S=z$jU.create(z$R,4*z$t.length/z$R.vertexStride,35044,!0,z$k._mesh._url+"_"+z$s);z$S.setData(z$t),z$k._mesh._vertexBuffers.push(z$S)}var z$_=z$c+z$k._readData.getUint32(),z$G=z$k._readData.getUint32(),z$q=new Uint16Array(z$r.slice(z$_,z$_+z$G)),z$u=z$$U.create("ushort",z$G/2,35044,!0,z$k._mesh._url);z$u.setData(z$q),z$k._mesh._indexBuffer=z$u;var z$h=z$k._mesh._boneNames=[],z$l=z$k._readData.getUint16();for(z$h.length=z$l,z$s=0;z$s<z$l;z$s++)z$h[z$s]=z$k._strings[z$k._readData.getUint16()];z$k._readData.pos+=8;var z$W=z$k._readData.getUint32(),z$O=z$k._readData.getUint32(),z$L=new Float32Array(z$r.slice(z$c+z$W,z$c+z$W+z$O));for(z$k._mesh._inverseBindPoses=[],z$s=0,z$V=z$L.length;z$s<z$V;z$s+=16){var z$d=new z$VU(z$L[z$s+0],z$L[z$s+1],z$L[z$s+2],z$L[z$s+3],z$L[z$s+4],z$L[z$s+5],z$L[z$s+6],z$L[z$s+7],z$L[z$s+8],z$L[z$s+9],z$L[z$s+10],z$L[z$s+11],z$L[z$s+12],z$L[z$s+13],z$L[z$s+14],z$L[z$s+15]);z$k._mesh._inverseBindPoses.push(z$d)}return z$k._mesh._skinnedDatas=new Float32Array(16*z$L.length),!0},z$k.READ_SUBMESH=function(){var z$V=z$k._readData.__getBuffer(),z$U=new z$tU(z$k._mesh),z$r=z$k._readData.getInt16(),z$s=z$k._readData.getUint32(),z$p=z$k._readData.getUint32();z$U._vertexBuffer=z$k._mesh._vertexBuffers[z$r],z$U._vertexStart=z$s,z$U._vertexCount=z$p;var z$c=z$k._readData.getUint32(),z$R=z$k._readData.getUint32(),z$T=z$k._mesh._indexBuffer;z$U._indexBuffer=z$T,z$U._indexStart=z$c,z$U._indexCount=z$R,z$U._indices=new Uint16Array(z$T.getData().buffer,2*z$c,z$R);var z$N=z$k._DATA.offset,z$t=z$U._subIndexBufferStart,z$b=z$U._subIndexBufferCount,z$S=z$U._boneIndicesList,z$_=z$k._readData.getUint16();z$t.length=z$_,z$b.length=z$_,z$S.length=z$_;for(var z$G=0;z$G<z$_;z$G++){z$t[z$G]=z$k._readData.getUint32(),z$b[z$G]=z$k._readData.getUint32();var z$q=z$k._readData.getUint32(),z$u=z$k._readData.getUint32();z$S[z$G]=new Uint8Array(z$V.slice(z$N+z$q,z$N+z$q+z$u))}return z$k._subMeshes.push(z$U),!0},z$k._strings=[],z$k._readData=null,z$k._version=null,z$k._mesh=null,z$k._subMeshes=null,z$k._materialMap=null,z$S(z$k,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":z$OV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":z$lV.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":z$BV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":z$mV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":z$EV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":z$DV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":z$kV.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":z$jV.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":z$xV.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":z$_V.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":z$bV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":z$dV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":z$hV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":z$ZV.vertexDeclaration,"POSITION,NORMAL,UV,UV1":z$zV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":z$IV.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":z$iV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":z$uV.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":z$JV.vertexDeclaration,"POSITION,NORMAL,UV":z$wV.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":z$qV.vertexDeclaration,"POSITION,NORMAL,COLOR":z$tV.vertexDeclaration,"POSITION,NORMAL,TANGENT":z$HV.vertexDeclaration,"POSITION,NORMAL":z$NV.vertexDeclaration,"POSITION,UV":z$MV.vertexDeclaration,POSITION:z$TV.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":z$WV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":z$lV.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":z$BV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":z$KV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":z$EV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":z$yV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":z$kV.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":z$$V.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":z$xV.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":z$SV.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":z$bV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":z$LV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":z$hV.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":z$aV.vertexDeclaration,"POSITION,NORMAL,UV,UV1":z$zV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":z$nV.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":z$iV.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":z$uV.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":z$oV.vertexDeclaration,"POSITION,NORMAL,UV":z$wV.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":z$GV.vertexDeclaration,"POSITION,NORMAL,COLOR":z$tV.vertexDeclaration,"POSITION,NORMAL,TANGENT":z$QV.vertexDeclaration,"POSITION,NORMAL":z$NV.vertexDeclaration,"POSITION,UV":z$MV.vertexDeclaration,POSITION:z$TV.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),z$k}(),z$FV=function(){function z$T(){}return z$G(z$T,"laya.d3.loaders.MeshReader"),z$T.read=function(z$V,z$U,z$r,z$s,z$p){var z$c=new z$k(z$V);z$c.pos=0;var z$R=z$c.readUTFString();switch(z$R){case"LAYAMODEL:01":case"LAYASKINANI:01":z$T._readVersion01(z$c,z$R,z$U,z$r,z$s,z$p);break;case"LAYAMODEL:02":z$XV.parse(z$c,z$R,z$U,z$r,z$s,z$p);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":z$eV.parse(z$c,z$R,z$U,z$s,z$p);break;default:throw new Error("MeshReader: unknown mesh version.")}z$U._setSubMeshes(z$s)},z$T._readVersion01=function(z$V,z$U,z$r,z$s,z$p,z$c){new z$AV(z$V,z$U,z$r,z$s,z$p,z$c)},z$T}(),z$gV=function(){function z$V(z$V,z$U){this.min=null,this.max=null,this.min=z$V,this.max=z$U}z$G(z$V,"laya.d3.math.BoundBox");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.getCorners=function(z$V){z$V.length=8;var z$U=this.min.elements,z$r=this.max.elements,z$s=z$U[0],z$p=z$U[1],z$c=z$U[2],z$R=z$r[0],z$T=z$r[1],z$N=z$r[2];z$V[0]=new z$RU(z$s,z$T,z$N),z$V[1]=new z$RU(z$R,z$T,z$N),z$V[2]=new z$RU(z$R,z$p,z$N),z$V[3]=new z$RU(z$s,z$p,z$N),z$V[4]=new z$RU(z$s,z$T,z$c),z$V[5]=new z$RU(z$R,z$T,z$c),z$V[6]=new z$RU(z$R,z$p,z$c),z$V[7]=new z$RU(z$s,z$p,z$c)},z$U.toDefault=function(){this.min.toDefault(),this.max.toDefault()},z$U.cloneTo=function(z$V){var z$U=z$V;this.min.cloneTo(z$U.min),this.max.cloneTo(z$U.max)},z$U.clone=function(){var z$V=new this.constructor(new z$RU,new z$RU);return this.cloneTo(z$V),z$V},z$V.createfromPoints=function(z$V,z$U){if(null==z$V)throw new Error("points");var z$r=z$U.min,z$s=z$U.max,z$p=z$r.elements;z$p[0]=Number.MAX_VALUE,z$p[1]=Number.MAX_VALUE,z$p[2]=Number.MAX_VALUE;var z$c=z$s.elements;z$c[0]=-Number.MAX_VALUE,z$c[1]=-Number.MAX_VALUE,z$c[2]=-Number.MAX_VALUE;for(var z$R=0,z$T=z$V.length;z$R<z$T;++z$R)z$RU.min(z$r,z$V[z$R],z$r),z$RU.max(z$s,z$V[z$R],z$s)},z$V.merge=function(z$V,z$U,z$r){z$RU.min(z$V.min,z$U.min,z$r.min),z$RU.max(z$V.max,z$U.max,z$r.max)},z$V}(),z$vV=function(){function z$t(z$V){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=z$V,this._near=new z$UU(new z$RU),this._far=new z$UU(new z$RU),this._left=new z$UU(new z$RU),this._right=new z$UU(new z$RU),this._top=new z$UU(new z$RU),this._bottom=new z$UU(new z$RU),z$t._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}z$G(z$t,"laya.d3.math.BoundFrustum");var z$V=z$t.prototype;return z$V.equalsBoundFrustum=function(z$V){return this._matrix.equalsOtherMatrix(z$V.matrix)},z$V.equalsObj=function(z$V){if(z$V instanceof laya.d3.math.BoundFrustum){var z$U=z$V;return this.equalsBoundFrustum(z$U)}return!1},z$V.getPlane=function(z$V){switch(z$V){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},z$V.getCorners=function(z$V){z$t._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(z$V[0]),z$t._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(z$V[1]),z$t._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(z$V[2]),z$t._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(z$V[3]),z$t._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(z$V[4]),z$t._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(z$V[5]),z$t._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(z$V[6]),z$t._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(z$V[7])},z$V.containsPoint=function(z$V){for(var z$U=z$UU.PlaneIntersectionType_Front,z$r=z$UU.PlaneIntersectionType_Front,z$s=0;z$s<6;z$s++){switch(z$s){case 0:z$r=Collision.intersectsPlaneAndPoint(this._near,z$V);break;case 1:z$r=Collision.intersectsPlaneAndPoint(this._far,z$V);break;case 2:z$r=Collision.intersectsPlaneAndPoint(this._left,z$V);break;case 3:z$r=Collision.intersectsPlaneAndPoint(this._right,z$V);break;case 4:z$r=Collision.intersectsPlaneAndPoint(this._top,z$V);break;case 5:z$r=Collision.intersectsPlaneAndPoint(this._bottom,z$V)}switch(z$r){case z$UU.PlaneIntersectionType_Back:return 0;case z$UU.PlaneIntersectionType_Intersecting:z$U=z$UU.PlaneIntersectionType_Intersecting}}switch(z$U){case z$UU.PlaneIntersectionType_Intersecting:return 2;default:return 1}},z$V.containsBoundBox=function(z$V){for(var z$U,z$r=z$t._tempV30,z$s=z$t._tempV31,z$p=1,z$c=0;z$c<6;z$c++){if(z$U=this.getPlane(z$c),this._getBoxToPlanePVertexNVertex(z$V,z$U.normal,z$r,z$s),Collision.intersectsPlaneAndPoint(z$U,z$r)===z$UU.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(z$U,z$s)===z$UU.PlaneIntersectionType_Back&&(z$p=2)}return z$p},z$V.containsBoundSphere=function(z$V){for(var z$U=z$UU.PlaneIntersectionType_Front,z$r=z$UU.PlaneIntersectionType_Front,z$s=0;z$s<6;z$s++){switch(z$s){case 0:z$r=Collision.intersectsPlaneAndSphere(this._near,z$V);break;case 1:z$r=Collision.intersectsPlaneAndSphere(this._far,z$V);break;case 2:z$r=Collision.intersectsPlaneAndSphere(this._left,z$V);break;case 3:z$r=Collision.intersectsPlaneAndSphere(this._right,z$V);break;case 4:z$r=Collision.intersectsPlaneAndSphere(this._top,z$V);break;case 5:z$r=Collision.intersectsPlaneAndSphere(this._bottom,z$V)}switch(z$r){case z$UU.PlaneIntersectionType_Back:return 0;case z$UU.PlaneIntersectionType_Intersecting:z$U=z$UU.PlaneIntersectionType_Intersecting}}switch(z$U){case z$UU.PlaneIntersectionType_Intersecting:return 2;default:return 1}},z$V._getBoxToPlanePVertexNVertex=function(z$V,z$U,z$r,z$s){var z$p=z$V.min,z$c=z$p.elements,z$R=z$V.max,z$T=z$R.elements,z$N=z$U.elements,z$t=z$N[0],z$b=z$N[1],z$S=z$N[2];z$p.cloneTo(z$r);var z$_=z$r.elements;0<=z$t&&(z$_[0]=z$T[0]),0<=z$b&&(z$_[1]=z$T[1]),0<=z$S&&(z$_[2]=z$T[2]),z$R.cloneTo(z$s);var z$G=z$s.elements;0<=z$t&&(z$G[0]=z$c[0]),0<=z$b&&(z$G[1]=z$c[1]),0<=z$S&&(z$G[2]=z$c[2])},z$q(0,z$V,"top",function(){return this._top}),z$q(0,z$V,"matrix",function(){return this._matrix},function(z$V){this._matrix=z$V,z$t._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),z$q(0,z$V,"near",function(){return this._near}),z$q(0,z$V,"far",function(){return this._far}),z$q(0,z$V,"left",function(){return this._left}),z$q(0,z$V,"right",function(){return this._right}),z$q(0,z$V,"bottom",function(){return this._bottom}),z$t._getPlanesFromMatrix=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T=z$V.elements,z$N=z$T[0],z$t=z$T[1],z$b=z$T[2],z$S=z$T[3],z$_=z$T[4],z$G=z$T[5],z$q=z$T[6],z$u=z$T[7],z$h=z$T[8],z$l=z$T[9],z$W=z$T[10],z$O=z$T[11],z$L=z$T[12],z$d=z$T[13],z$k=z$T[14],z$y=z$T[15],z$D=z$U.normal.elements;z$D[0]=z$S+z$b,z$D[1]=z$u+z$q,z$D[2]=z$O+z$W,z$U.distance=z$y+z$k,z$U.normalize();var z$n=z$r.normal.elements;z$n[0]=z$S-z$b,z$n[1]=z$u-z$q,z$n[2]=z$O-z$W,z$r.distance=z$y-z$k,z$r.normalize();var z$I=z$s.normal.elements;z$I[0]=z$S+z$N,z$I[1]=z$u+z$_,z$I[2]=z$O+z$h,z$s.distance=z$y+z$L,z$s.normalize();var z$Q=z$p.normal.elements;z$Q[0]=z$S-z$N,z$Q[1]=z$u-z$_,z$Q[2]=z$O-z$h,z$p.distance=z$y-z$L,z$p.normalize();var z$H=z$c.normal.elements;z$H[0]=z$S-z$t,z$H[1]=z$u-z$G,z$H[2]=z$O-z$l,z$c.distance=z$y-z$d,z$c.normalize();var z$w=z$R.normal.elements;z$w[0]=z$S+z$t,z$w[1]=z$u+z$G,z$w[2]=z$O+z$l,z$R.distance=z$y+z$d,z$R.normalize()},z$t._get3PlaneInterPoint=function(z$V,z$U,z$r){var z$s=z$V.normal,z$p=z$U.normal,z$c=z$r.normal;z$RU.cross(z$p,z$c,z$t._tempV30),z$RU.cross(z$c,z$s,z$t._tempV31),z$RU.cross(z$s,z$p,z$t._tempV32);var z$R=z$RU.dot(z$s,z$t._tempV30),z$T=z$RU.dot(z$p,z$t._tempV31),z$N=z$RU.dot(z$c,z$t._tempV32);return z$RU.scale(z$t._tempV30,-z$V.distance/z$R,z$t._tempV33),z$RU.scale(z$t._tempV31,-z$U.distance/z$T,z$t._tempV34),z$RU.scale(z$t._tempV32,-z$r.distance/z$N,z$t._tempV35),z$RU.add(z$t._tempV33,z$t._tempV34,z$t._tempV36),z$RU.add(z$t._tempV35,z$t._tempV36,z$t._tempV37),z$t._tempV37},z$S(z$t,["_tempV30",function(){return this._tempV30=new z$RU},"_tempV31",function(){return this._tempV31=new z$RU},"_tempV32",function(){return this._tempV32=new z$RU},"_tempV33",function(){return this._tempV33=new z$RU},"_tempV34",function(){return this._tempV34=new z$RU},"_tempV35",function(){return this._tempV35=new z$RU},"_tempV36",function(){return this._tempV36=new z$RU},"_tempV37",function(){return this._tempV37=new z$RU}]),z$t}(),z$YV=function(){function z$b(z$V,z$U){this.center=null,this.radius=NaN,this.center=z$V,this.radius=z$U}z$G(z$b,"laya.d3.math.BoundSphere");var z$V=z$b.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.toDefault=function(){this.center.toDefault(),this.radius=0},z$V.intersectsRayDistance=function(z$V){return Collision.intersectsRayAndSphereRD(z$V,this)},z$V.intersectsRayPoint=function(z$V,z$U){return Collision.intersectsRayAndSphereRP(z$V,this,z$U)},z$V.cloneTo=function(z$V){var z$U=z$V;this.center.cloneTo(z$U.center),z$U.radius=this.radius},z$V.clone=function(){var z$V=new this.constructor(new z$RU,new z$RU);return this.cloneTo(z$V),z$V},z$b.createFromSubPoints=function(z$V,z$U,z$r,z$s){if(null==z$V)throw new Error("points");if(z$U<0||z$U>=z$V.length)throw new Error("start"+z$U+"Must be in the range [0, "+(z$V.length-1)+"]");if(z$r<0||z$U+z$r>z$V.length)throw new Error("count"+z$r+"Must be in the range <= "+z$V.length+"}");var z$p=z$U+z$r,z$c=z$b._tempVector3;z$c.elements[0]=0,z$c.elements[1]=0,z$c.elements[2]=0;for(var z$R=z$U;z$R<z$p;++z$R)z$RU.add(z$V[z$R],z$c,z$c);var z$T=z$s.center;z$RU.scale(z$c,1/z$r,z$T);var z$N=0;for(z$R=z$U;z$R<z$p;++z$R){var z$t=z$RU.distanceSquared(z$T,z$V[z$R]);z$N<z$t&&(z$N=z$t)}z$s.radius=Math.sqrt(z$N)},z$b.createfromPoints=function(z$V,z$U){if(null==z$V)throw new Error("points");z$b.createFromSubPoints(z$V,0,z$V.length,z$U)},z$S(z$b,["_tempVector3",function(){return this._tempVector3=new z$RU}]),z$b}(),z$CV=(function(){function z$V(){}z$G(z$V,"laya.d3.math.ContainmentType"),z$V.Disjoint=0,z$V.Contains=1,z$V.Intersects=2}(),function(){function z$r(){}return z$G(z$r,"laya.d3.math.MathUtils3D"),z$r.isZero=function(z$V){return Math.abs(z$V)<z$r.zeroTolerance},z$r.nearEqual=function(z$V,z$U){return!!z$r.isZero(z$V-z$U)},z$r.fastInvSqrt=function(z$V){return z$r.isZero(z$V)?z$V:1/Math.sqrt(z$V)},z$S(z$r,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),z$r}()),z$fV=function(){function z$N(){var z$V=this.elements=new Float32Array(9);z$V[0]=1,z$V[1]=0,z$V[2]=0,z$V[3]=0,z$V[4]=1,z$V[5]=0,z$V[6]=0,z$V[7]=0,z$V[8]=1}z$G(z$N,"laya.d3.math.Matrix3x3");var z$V=z$N.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.determinant=function(){var z$V=this.elements,z$U=z$V[0],z$r=z$V[1],z$s=z$V[2],z$p=z$V[3],z$c=z$V[4],z$R=z$V[5],z$T=z$V[6],z$N=z$V[7],z$t=z$V[8];return z$U*(z$t*z$c-z$R*z$N)+z$r*(-z$t*z$p+z$R*z$T)+z$s*(z$N*z$p-z$c*z$T)},z$V.translate=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements,z$p=z$V.elements,z$c=z$s[0],z$R=z$s[1],z$T=z$s[2],z$N=z$s[3],z$t=z$s[4],z$b=z$s[5],z$S=z$s[6],z$_=z$s[7],z$G=z$s[8],z$q=z$p[0],z$u=z$p[1];z$r[0]=z$c,z$r[1]=z$R,z$r[2]=z$T,z$r[3]=z$N,z$r[4]=z$t,z$r[5]=z$b,z$r[6]=z$q*z$c+z$u*z$N+z$S,z$r[7]=z$q*z$R+z$u*z$t+z$_,z$r[8]=z$q*z$T+z$u*z$b+z$G},z$V.rotate=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=z$s[4],z$t=z$s[5],z$b=z$s[6],z$S=z$s[7],z$_=z$s[8],z$G=Math.sin(z$V),z$q=Math.cos(z$V);z$r[0]=z$q*z$p+z$G*z$T,z$r[1]=z$q*z$c+z$G*z$N,z$r[2]=z$q*z$R+z$G*z$t,z$r[3]=z$q*z$T-z$G*z$p,z$r[4]=z$q*z$N-z$G*z$c,z$r[5]=z$q*z$t-z$G*z$R,z$r[6]=z$b,z$r[7]=z$S,z$r[8]=z$_},z$V.scale=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements,z$p=z$V.elements,z$c=z$p[0],z$R=z$p[1];z$r[0]=z$c*z$s[0],z$r[1]=z$c*z$s[1],z$r[2]=z$c*z$s[2],z$r[3]=z$R*z$s[3],z$r[4]=z$R*z$s[4],z$r[5]=z$R*z$s[5],z$r[6]=z$s[6],z$r[7]=z$s[7],z$r[8]=z$s[8]},z$V.invert=function(z$V){var z$U=z$V.elements,z$r=this.elements,z$s=z$r[0],z$p=z$r[1],z$c=z$r[2],z$R=z$r[3],z$T=z$r[4],z$N=z$r[5],z$t=z$r[6],z$b=z$r[7],z$S=z$r[8],z$_=z$S*z$T-z$N*z$b,z$G=-z$S*z$R+z$N*z$t,z$q=z$b*z$R-z$T*z$t,z$u=z$s*z$_+z$p*z$G+z$c*z$q;z$u||(z$V=null),z$u=1/z$u,z$U[0]=z$_*z$u,z$U[1]=(-z$S*z$p+z$c*z$b)*z$u,z$U[2]=(z$N*z$p-z$c*z$T)*z$u,z$U[3]=z$G*z$u,z$U[4]=(z$S*z$s-z$c*z$t)*z$u,z$U[5]=(-z$N*z$s+z$c*z$R)*z$u,z$U[6]=z$q*z$u,z$U[7]=(-z$b*z$s+z$p*z$t)*z$u,z$U[8]=(z$T*z$s-z$p*z$R)*z$u},z$V.transpose=function(z$V){var z$U=z$V.elements,z$r=this.elements;if(z$V===this){var z$s=z$r[1],z$p=z$r[2],z$c=z$r[5];z$U[1]=z$r[3],z$U[2]=z$r[6],z$U[3]=z$s,z$U[5]=z$r[7],z$U[6]=z$p,z$U[7]=z$c}else z$U[0]=z$r[0],z$U[1]=z$r[3],z$U[2]=z$r[6],z$U[3]=z$r[1],z$U[4]=z$r[4],z$U[5]=z$r[7],z$U[6]=z$r[2],z$U[7]=z$r[5],z$U[8]=z$r[8]},z$V.identity=function(){var z$V=this.elements;z$V[0]=1,z$V[1]=0,z$V[2]=0,z$V[3]=0,z$V[4]=1,z$V[5]=0,z$V[6]=0,z$V[7]=0,z$V[8]=1},z$V.cloneTo=function(z$V){var z$U,z$r,z$s;if((z$r=this.elements)!==(z$s=z$V.elements))for(z$U=0;z$U<9;++z$U)z$s[z$U]=z$r[z$U]},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$N.createFromTranslation=function(z$V,z$U){z$U.elements;var z$r=z$V.elements;z$U[0]=1,z$U[1]=0,z$U[2]=0,z$U[3]=0,z$U[4]=1,z$U[5]=0,z$U[6]=z$r[0],z$U[7]=z$r[1],z$U[8]=1},z$N.createFromRotation=function(z$V,z$U){var z$r=z$U.elements,z$s=Math.sin(z$V),z$p=Math.cos(z$V);z$r[0]=z$p,z$r[1]=z$s,z$r[2]=0,z$r[3]=-z$s,z$r[4]=z$p,z$r[5]=0,z$r[6]=0,z$r[7]=0,z$r[8]=1},z$N.createFromScaling=function(z$V,z$U){var z$r=z$U.elements,z$s=z$V.elements;z$r[0]=z$s[0],z$r[1]=0,z$r[2]=0,z$r[3]=0,z$r[4]=z$s[1],z$r[5]=0,z$r[6]=0,z$r[7]=0,z$r[8]=1},z$N.createFromMatrix4x4=function(z$V,z$U){z$U[0]=z$V[0],z$U[1]=z$V[1],z$U[2]=z$V[2],z$U[3]=z$V[4],z$U[4]=z$V[5],z$U[5]=z$V[6],z$U[6]=z$V[8],z$U[7]=z$V[9],z$U[8]=z$V[10]},z$N.multiply=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements,z$R=z$p[0],z$T=z$p[1],z$N=z$p[2],z$t=z$p[3],z$b=z$p[4],z$S=z$p[5],z$_=z$p[6],z$G=z$p[7],z$q=z$p[8],z$u=z$c[0],z$h=z$c[1],z$l=z$c[2],z$W=z$c[3],z$O=z$c[4],z$L=z$c[5],z$d=z$c[6],z$k=z$c[7],z$y=z$c[8];z$s[0]=z$u*z$R+z$h*z$t+z$l*z$_,z$s[1]=z$u*z$T+z$h*z$b+z$l*z$G,z$s[2]=z$u*z$N+z$h*z$S+z$l*z$q,z$s[3]=z$W*z$R+z$O*z$t+z$L*z$_,z$s[4]=z$W*z$T+z$O*z$b+z$L*z$G,z$s[5]=z$W*z$N+z$O*z$S+z$L*z$q,z$s[6]=z$d*z$R+z$k*z$t+z$y*z$_,z$s[7]=z$d*z$T+z$k*z$b+z$y*z$G,z$s[8]=z$d*z$N+z$k*z$S+z$y*z$q},z$N.lookAt=function(z$V,z$U,z$r,z$s){z$RU.subtract(z$V,z$U,z$N._tempV30),z$RU.normalize(z$N._tempV30,z$N._tempV30),z$RU.cross(z$r,z$N._tempV30,z$N._tempV31),z$RU.normalize(z$N._tempV31,z$N._tempV31),z$RU.cross(z$N._tempV30,z$N._tempV31,z$N._tempV32);var z$p=z$N._tempV30.elements,z$c=z$N._tempV31.elements,z$R=z$N._tempV32.elements,z$T=z$s.elements;z$T[0]=z$c[0],z$T[3]=z$c[1],z$T[6]=z$c[2],z$T[1]=z$R[0],z$T[4]=z$R[1],z$T[7]=z$R[2],z$T[2]=z$p[0],z$T[5]=z$p[1],z$T[8]=z$p[2]},z$N.DEFAULT=new z$N,z$S(z$N,["_tempV30",function(){return this._tempV30=new z$RU},"_tempV31",function(){return this._tempV31=new z$RU},"_tempV32",function(){return this._tempV32=new z$RU}]),z$N}(),z$VU=function(){function z$n(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S,z$_,z$G,z$q,z$u){void 0===z$V&&(z$V=1),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=1),void 0===z$R&&(z$R=0),void 0===z$T&&(z$T=0),void 0===z$N&&(z$N=0),void 0===z$t&&(z$t=0),void 0===z$b&&(z$b=1),void 0===z$S&&(z$S=0),void 0===z$_&&(z$_=0),void 0===z$G&&(z$G=0),void 0===z$q&&(z$q=0),void 0===z$u&&(z$u=1);var z$h=this.elements=new Float32Array(16);z$h[0]=z$V,z$h[1]=z$U,z$h[2]=z$r,z$h[3]=z$s,z$h[4]=z$p,z$h[5]=z$c,z$h[6]=z$R,z$h[7]=z$T,z$h[8]=z$N,z$h[9]=z$t,z$h[10]=z$b,z$h[11]=z$S,z$h[12]=z$_,z$h[13]=z$G,z$h[14]=z$q,z$h[15]=z$u}z$G(z$n,"laya.d3.math.Matrix4x4");var z$V=z$n.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.getElementByRowColumn=function(z$V,z$U){if(z$V<0||3<z$V)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(z$U<0||3<z$U)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*z$V+z$U]},z$V.setElementByRowColumn=function(z$V,z$U,z$r){if(z$V<0||3<z$V)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(z$U<0||3<z$U)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*z$V+z$U]=z$r},z$V.equalsOtherMatrix=function(z$V){var z$U=this.elements,z$r=z$V.elements;return z$CV.nearEqual(z$U[0],z$r[0])&&z$CV.nearEqual(z$U[1],z$r[1])&&z$CV.nearEqual(z$U[2],z$r[2])&&z$CV.nearEqual(z$U[3],z$r[3])&&z$CV.nearEqual(z$U[4],z$r[4])&&z$CV.nearEqual(z$U[5],z$r[5])&&z$CV.nearEqual(z$U[6],z$r[6])&&z$CV.nearEqual(z$U[7],z$r[7])&&z$CV.nearEqual(z$U[8],z$r[8])&&z$CV.nearEqual(z$U[9],z$r[9])&&z$CV.nearEqual(z$U[10],z$r[10])&&z$CV.nearEqual(z$U[11],z$r[11])&&z$CV.nearEqual(z$U[12],z$r[12])&&z$CV.nearEqual(z$U[13],z$r[13])&&z$CV.nearEqual(z$U[14],z$r[14])&&z$CV.nearEqual(z$U[15],z$r[15])},z$V.decomposeTransRotScale=function(z$V,z$U,z$r){var z$s=z$n._tempMatrix4x4;return this.decomposeTransRotMatScale(z$V,z$s,z$r)?(z$rU.createFromMatrix4x4(z$s,z$U),!0):(z$U.identity(),!1)},z$V.decomposeTransRotMatScale=function(z$V,z$U,z$r){var z$s=this.elements,z$p=z$V.elements,z$c=z$U.elements,z$R=z$r.elements;z$p[0]=z$s[12],z$p[1]=z$s[13],z$p[2]=z$s[14];var z$T=z$s[0],z$N=z$s[1],z$t=z$s[2],z$b=z$s[4],z$S=z$s[5],z$_=z$s[6],z$G=z$s[8],z$q=z$s[9],z$u=z$s[10],z$h=z$R[0]=Math.sqrt(z$T*z$T+z$N*z$N+z$t*z$t),z$l=z$R[1]=Math.sqrt(z$b*z$b+z$S*z$S+z$_*z$_),z$W=z$R[2]=Math.sqrt(z$G*z$G+z$q*z$q+z$u*z$u);if(z$CV.isZero(z$h)||z$CV.isZero(z$l)||z$CV.isZero(z$W))return z$c[1]=z$c[2]=z$c[3]=z$c[4]=z$c[6]=z$c[7]=z$c[8]=z$c[9]=z$c[11]=z$c[12]=z$c[13]=z$c[14]=0,z$c[0]=z$c[5]=z$c[10]=z$c[15]=1,!1;var z$O=z$n._tempVector0,z$L=z$O.elements;z$L[0]=z$G/z$W,z$L[1]=z$q/z$W,z$L[2]=z$u/z$W;var z$d=z$n._tempVector1,z$k=z$d.elements;z$k[0]=z$T/z$h,z$k[1]=z$N/z$h,z$k[2]=z$t/z$h;var z$y=z$n._tempVector2;z$RU.cross(z$O,z$d,z$y);var z$D=z$n._tempVector1;return z$RU.cross(z$y,z$O,z$D),z$c[3]=z$c[7]=z$c[11]=z$c[12]=z$c[13]=z$c[14]=0,z$c[15]=1,z$c[0]=z$D.x,z$c[1]=z$D.y,z$c[2]=z$D.z,z$c[4]=z$y.x,z$c[5]=z$y.y,z$c[6]=z$y.z,z$c[8]=z$O.x,z$c[9]=z$O.y,z$c[10]=z$O.z,z$c[0]*z$T+z$c[1]*z$N+z$c[2]*z$t<0&&(z$R[0]=-z$h),z$c[4]*z$b+z$c[5]*z$S+z$c[6]*z$_<0&&(z$R[1]=-z$l),z$c[8]*z$G+z$c[9]*z$q+z$c[10]*z$u<0&&(z$R[2]=-z$W),!0},z$V.decomposeYawPitchRoll=function(z$V){var z$U=z$V.elements,z$r=Math.asin(-this.elements[9]);z$U[1]=z$r,Math.cos(z$r)>z$CV.zeroTolerance?(z$U[2]=Math.atan2(this.elements[1],this.elements[5]),z$U[0]=Math.atan2(this.elements[8],this.elements[10])):(z$U[2]=Math.atan2(-this.elements[4],this.elements[0]),z$U[0]=0)},z$V.normalize=function(){var z$V=this.elements,z$U=z$V[0],z$r=z$V[1],z$s=z$V[2],z$p=Math.sqrt(z$U*z$U+z$r*z$r+z$s*z$s);if(!z$p)return z$V[0]=0,z$V[1]=0,void(z$V[2]=0);1!=z$p&&(z$p=1/z$p,z$V[0]=z$U*z$p,z$V[1]=z$r*z$p,z$V[2]=z$s*z$p)},z$V.transpose=function(){var z$V,z$U;return z$U=(z$V=this.elements)[1],z$V[1]=z$V[4],z$V[4]=z$U,z$U=z$V[2],z$V[2]=z$V[8],z$V[8]=z$U,z$U=z$V[3],z$V[3]=z$V[12],z$V[12]=z$U,z$U=z$V[6],z$V[6]=z$V[9],z$V[9]=z$U,z$U=z$V[7],z$V[7]=z$V[13],z$V[13]=z$U,z$U=z$V[11],z$V[11]=z$V[14],z$V[14]=z$U,this},z$V.invert=function(z$V){var z$U=this.elements,z$r=z$V.elements,z$s=z$U[0],z$p=z$U[1],z$c=z$U[2],z$R=z$U[3],z$T=z$U[4],z$N=z$U[5],z$t=z$U[6],z$b=z$U[7],z$S=z$U[8],z$_=z$U[9],z$G=z$U[10],z$q=z$U[11],z$u=z$U[12],z$h=z$U[13],z$l=z$U[14],z$W=z$U[15],z$O=z$s*z$N-z$p*z$T,z$L=z$s*z$t-z$c*z$T,z$d=z$s*z$b-z$R*z$T,z$k=z$p*z$t-z$c*z$N,z$y=z$p*z$b-z$R*z$N,z$D=z$c*z$b-z$R*z$t,z$n=z$S*z$h-z$_*z$u,z$I=z$S*z$l-z$G*z$u,z$Q=z$S*z$W-z$q*z$u,z$H=z$_*z$l-z$G*z$h,z$w=z$_*z$W-z$q*z$h,z$z=z$G*z$W-z$q*z$l,z$E=z$O*z$z-z$L*z$w+z$d*z$H+z$k*z$Q-z$y*z$I+z$D*z$n;0!==Math.abs(z$E)&&(z$E=1/z$E,z$r[0]=(z$N*z$z-z$t*z$w+z$b*z$H)*z$E,z$r[1]=(z$c*z$w-z$p*z$z-z$R*z$H)*z$E,z$r[2]=(z$h*z$D-z$l*z$y+z$W*z$k)*z$E,z$r[3]=(z$G*z$y-z$_*z$D-z$q*z$k)*z$E,z$r[4]=(z$t*z$Q-z$T*z$z-z$b*z$I)*z$E,z$r[5]=(z$s*z$z-z$c*z$Q+z$R*z$I)*z$E,z$r[6]=(z$l*z$d-z$u*z$D-z$W*z$L)*z$E,z$r[7]=(z$S*z$D-z$G*z$d+z$q*z$L)*z$E,z$r[8]=(z$T*z$w-z$N*z$Q+z$b*z$n)*z$E,z$r[9]=(z$p*z$Q-z$s*z$w-z$R*z$n)*z$E,z$r[10]=(z$u*z$y-z$h*z$d+z$W*z$O)*z$E,z$r[11]=(z$_*z$d-z$S*z$y-z$q*z$O)*z$E,z$r[12]=(z$N*z$I-z$T*z$H-z$t*z$n)*z$E,z$r[13]=(z$s*z$H-z$p*z$I+z$c*z$n)*z$E,z$r[14]=(z$h*z$L-z$u*z$k-z$l*z$O)*z$E,z$r[15]=(z$S*z$k-z$_*z$L+z$G*z$O)*z$E)},z$V.identity=function(){var z$V=this.elements;z$V[1]=z$V[2]=z$V[3]=z$V[4]=z$V[6]=z$V[7]=z$V[8]=z$V[9]=z$V[11]=z$V[12]=z$V[13]=z$V[14]=0,z$V[0]=z$V[5]=z$V[10]=z$V[15]=1},z$V.cloneTo=function(z$V){var z$U,z$r,z$s;if((z$r=this.elements)!==(z$s=z$V.elements))for(z$U=0;z$U<16;++z$U)z$s[z$U]=z$r[z$U]},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$V.getTranslationVector=function(z$V){var z$U=this.elements,z$r=z$V.elements;z$r[0]=z$U[12],z$r[1]=z$U[13],z$r[2]=z$U[14]},z$V.setTranslationVector=function(z$V){var z$U=this.elements,z$r=z$V.elements;z$U[12]=z$r[0],z$U[13]=z$r[1],z$U[14]=z$r[2]},z$V.getForward=function(z$V){var z$U=this.elements,z$r=z$V.elements;z$r[0]=-z$U[8],z$r[1]=-z$U[9],z$r[2]=-z$U[10]},z$V.setForward=function(z$V){var z$U=this.elements,z$r=z$V.elements;z$U[8]=-z$r[0],z$U[9]=-z$r[1],z$U[10]=-z$r[2]},z$n.createRotationX=function(z$V,z$U){var z$r=z$U.elements,z$s=Math.sin(z$V),z$p=Math.cos(z$V);z$r[1]=z$r[2]=z$r[3]=z$r[4]=z$r[7]=z$r[8]=z$r[11]=z$r[12]=z$r[13]=z$r[14]=0,z$r[0]=z$r[15]=1,z$r[5]=z$r[10]=z$p,z$r[6]=z$s,z$r[9]=-z$s},z$n.createRotationY=function(z$V,z$U){var z$r=z$U.elements,z$s=Math.sin(z$V),z$p=Math.cos(z$V);z$r[1]=z$r[3]=z$r[4]=z$r[6]=z$r[7]=z$r[9]=z$r[11]=z$r[12]=z$r[13]=z$r[14]=0,z$r[5]=z$r[15]=1,z$r[0]=z$r[10]=z$p,z$r[2]=-z$s,z$r[8]=z$s},z$n.createRotationZ=function(z$V,z$U){var z$r=z$U.elements,z$s=Math.sin(z$V),z$p=Math.cos(z$V);z$r[2]=z$r[3]=z$r[6]=z$r[7]=z$r[8]=z$r[9]=z$r[11]=z$r[12]=z$r[13]=z$r[14]=0,z$r[10]=z$r[15]=1,z$r[0]=z$r[5]=z$p,z$r[1]=z$s,z$r[4]=-z$s},z$n.createRotationYawPitchRoll=function(z$V,z$U,z$r,z$s){z$rU.createFromYawPitchRoll(z$V,z$U,z$r,z$n._tempQuaternion),z$n.createRotationQuaternion(z$n._tempQuaternion,z$s)},z$n.createRotationAxis=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=Math.cos(z$U),z$N=Math.sin(z$U),z$t=z$p*z$p,z$b=z$c*z$c,z$S=z$R*z$R,z$_=z$p*z$c,z$G=z$p*z$R,z$q=z$c*z$R,z$u=z$r.elements;z$u[3]=z$u[7]=z$u[11]=z$u[12]=z$u[13]=z$u[14]=0,z$u[15]=1,z$u[0]=z$t+z$T*(1-z$t),z$u[1]=z$_-z$T*z$_+z$N*z$R,z$u[2]=z$G-z$T*z$G-z$N*z$c,z$u[4]=z$_-z$T*z$_-z$N*z$R,z$u[5]=z$b+z$T*(1-z$b),z$u[6]=z$q-z$T*z$q+z$N*z$p,z$u[8]=z$G-z$T*z$G+z$N*z$c,z$u[9]=z$q-z$T*z$q-z$N*z$p,z$u[10]=z$S+z$T*(1-z$S)},z$n.createRotationQuaternion=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0],z$c=z$r[1],z$R=z$r[2],z$T=z$r[3],z$N=z$p*z$p,z$t=z$c*z$c,z$b=z$R*z$R,z$S=z$p*z$c,z$_=z$R*z$T,z$G=z$R*z$p,z$q=z$c*z$T,z$u=z$c*z$R,z$h=z$p*z$T;z$s[3]=z$s[7]=z$s[11]=z$s[12]=z$s[13]=z$s[14]=0,z$s[15]=1,z$s[0]=1-2*(z$t+z$b),z$s[1]=2*(z$S+z$_),z$s[2]=2*(z$G-z$q),z$s[4]=2*(z$S-z$_),z$s[5]=1-2*(z$b+z$N),z$s[6]=2*(z$u+z$h),z$s[8]=2*(z$G+z$q),z$s[9]=2*(z$u-z$h),z$s[10]=1-2*(z$t+z$N)},z$n.createTranslate=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;z$s[4]=z$s[8]=z$s[1]=z$s[9]=z$s[2]=z$s[6]=z$s[3]=z$s[7]=z$s[11]=0,z$s[0]=z$s[5]=z$s[10]=z$s[15]=1,z$s[12]=z$r[0],z$s[13]=z$r[1],z$s[14]=z$r[2]},z$n.createScaling=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;z$s[0]=z$r[0],z$s[5]=z$r[1],z$s[10]=z$r[2],z$s[1]=z$s[4]=z$s[8]=z$s[12]=z$s[9]=z$s[13]=z$s[2]=z$s[6]=z$s[14]=z$s[3]=z$s[7]=z$s[11]=0,z$s[15]=1},z$n.multiply=function(z$V,z$U,z$r){var z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b;for(z$p=z$r.elements,z$c=z$V.elements,z$p===(z$R=z$U.elements)&&(z$R=z$R.slice()),z$s=0;z$s<4;z$s++)z$T=z$c[z$s],z$N=z$c[z$s+4],z$t=z$c[z$s+8],z$b=z$c[z$s+12],z$p[z$s]=z$T*z$R[0]+z$N*z$R[1]+z$t*z$R[2]+z$b*z$R[3],z$p[z$s+4]=z$T*z$R[4]+z$N*z$R[5]+z$t*z$R[6]+z$b*z$R[7],z$p[z$s+8]=z$T*z$R[8]+z$N*z$R[9]+z$t*z$R[10]+z$b*z$R[11],z$p[z$s+12]=z$T*z$R[12]+z$N*z$R[13]+z$t*z$R[14]+z$b*z$R[15]},z$n.createFromQuaternion=function(z$V,z$U){var z$r=z$U.elements,z$s=z$V.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=z$p+z$p,z$t=z$c+z$c,z$b=z$R+z$R,z$S=z$p*z$N,z$_=z$c*z$N,z$G=z$c*z$t,z$q=z$R*z$N,z$u=z$R*z$t,z$h=z$R*z$b,z$l=z$T*z$N,z$W=z$T*z$t,z$O=z$T*z$b;z$r[0]=1-z$G-z$h,z$r[1]=z$_+z$O,z$r[2]=z$q-z$W,z$r[3]=0,z$r[4]=z$_-z$O,z$r[5]=1-z$S-z$h,z$r[6]=z$u+z$l,z$r[7]=0,z$r[8]=z$q+z$W,z$r[9]=z$u-z$l,z$r[10]=1-z$S-z$G,z$r[11]=0,z$r[12]=0,z$r[13]=0,z$r[14]=0,z$r[15]=1},z$n.createAffineTransformation=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements,z$c=z$U.elements,z$R=z$r.elements,z$T=z$s.elements,z$N=z$c[0],z$t=z$c[1],z$b=z$c[2],z$S=z$c[3],z$_=z$N+z$N,z$G=z$t+z$t,z$q=z$b+z$b,z$u=z$N*z$_,z$h=z$N*z$G,z$l=z$N*z$q,z$W=z$t*z$G,z$O=z$t*z$q,z$L=z$b*z$q,z$d=z$S*z$_,z$k=z$S*z$G,z$y=z$S*z$q,z$D=z$R[0],z$n=z$R[1],z$I=z$R[2];z$T[0]=(1-(z$W+z$L))*z$D,z$T[1]=(z$h+z$y)*z$D,z$T[2]=(z$l-z$k)*z$D,z$T[3]=0,z$T[4]=(z$h-z$y)*z$n,z$T[5]=(1-(z$u+z$L))*z$n,z$T[6]=(z$O+z$d)*z$n,z$T[7]=0,z$T[8]=(z$l+z$k)*z$I,z$T[9]=(z$O-z$d)*z$I,z$T[10]=(1-(z$u+z$W))*z$I,z$T[11]=0,z$T[12]=z$p[0],z$T[13]=z$p[1],z$T[14]=z$p[2],z$T[15]=1},z$n.createLookAt=function(z$V,z$U,z$r,z$s){var z$p=z$s.elements,z$c=z$n._tempVector0,z$R=z$n._tempVector1,z$T=z$n._tempVector2;z$RU.subtract(z$V,z$U,z$T),z$RU.normalize(z$T,z$T),z$RU.cross(z$r,z$T,z$c),z$RU.normalize(z$c,z$c),z$RU.cross(z$T,z$c,z$R),z$s.identity(),z$p[0]=z$c.x,z$p[4]=z$c.y,z$p[8]=z$c.z,z$p[1]=z$R.x,z$p[5]=z$R.y,z$p[9]=z$R.z,z$p[2]=z$T.x,z$p[6]=z$T.y,z$p[10]=z$T.z,z$p[12]=-z$RU.dot(z$c,z$V),z$p[13]=-z$RU.dot(z$R,z$V),z$p[14]=-z$RU.dot(z$T,z$V)},z$n.createPerspective=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$p.elements,z$R=1/Math.tan(z$V/2),z$T=1/(z$r-z$s);z$c[0]=z$R/z$U,z$c[5]=z$R,z$c[10]=(z$s+z$r)*z$T,z$c[11]=-1,z$c[14]=2*z$s*z$r*z$T,z$c[1]=z$c[2]=z$c[3]=z$c[4]=z$c[6]=z$c[7]=z$c[8]=z$c[9]=z$c[12]=z$c[13]=z$c[15]=0},z$n.createOrthoOffCenterRH=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T=z$R.elements,z$N=1/(z$V-z$U),z$t=1/(z$r-z$s),z$b=1/(z$p-z$c);z$T[1]=z$T[2]=z$T[3]=z$T[4]=z$T[6]=z$T[7]=z$T[8]=z$T[9]=z$T[11]=0,z$T[15]=1,z$T[0]=-2*z$N,z$T[5]=-2*z$t,z$T[10]=2*z$b,z$T[12]=(z$V+z$U)*z$N,z$T[13]=(z$s+z$r)*z$t,z$T[14]=(z$c+z$p)*z$b},z$n.translation=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;z$s[0]=z$s[5]=z$s[10]=z$s[15]=1,z$s[12]=z$r[0],z$s[13]=z$r[1],z$s[14]=z$r[2]},z$S(z$n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new z$n},"_tempVector0",function(){return this._tempVector0=new z$RU},"_tempVector1",function(){return this._tempVector1=new z$RU},"_tempVector2",function(){return this._tempVector2=new z$RU},"_tempQuaternion",function(){return this._tempQuaternion=new z$rU},"DEFAULT",function(){return this.DEFAULT=new z$n},"ZERO",function(){return this.ZERO=new z$n(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),z$n}(),z$UU=(function(){function z$O(z$V,z$U){this.extents=null,this.transformation=null,this.extents=z$V,this.transformation=z$U}z$G(z$O,"laya.d3.math.OrientedBoundBox");var z$V=z$O.prototype;z$V.getCorners=function(z$V){var z$U=z$O._tempV30.elements,z$r=z$O._tempV31.elements,z$s=z$O._tempV32.elements,z$p=this.extents.elements;z$U[0]=z$p[0],z$U[1]=z$U[2]=0,z$r[1]=z$p[1],z$r[0]=z$r[2]=0,z$s[2]=z$p[2],z$s[0]=z$s[1]=0,z$RU.TransformNormal(z$O._tempV30,this.transformation,z$O._tempV30),z$RU.TransformNormal(z$O._tempV31,this.transformation,z$O._tempV31),z$RU.TransformNormal(z$O._tempV32,this.transformation,z$O._tempV32);var z$c=z$O._tempV33;this.transformation.getTranslationVector(z$c),z$V.length=8,z$RU.add(z$c,z$O._tempV30,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV32,z$V[0]),z$RU.add(z$c,z$O._tempV30,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV32,z$V[1]),z$RU.subtract(z$c,z$O._tempV30,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV32,z$V[2]),z$RU.subtract(z$c,z$O._tempV30,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV32,z$V[3]),z$RU.add(z$c,z$O._tempV30,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV32,z$V[4]),z$RU.add(z$c,z$O._tempV30,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV32,z$V[5]),z$RU.subtract(z$c,z$O._tempV30,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV32,z$V[6]),z$RU.subtract(z$c,z$O._tempV30,z$O._tempV34),z$RU.subtract(z$O._tempV34,z$O._tempV31,z$O._tempV34),z$RU.add(z$O._tempV34,z$O._tempV32,z$V[7])},z$V.transform=function(z$V){z$VU.multiply(this.transformation,z$V,this.transformation)},z$V.scale=function(z$V){z$RU.multiply(this.extents,z$V,this.extents)},z$V.translate=function(z$V){this.transformation.getTranslationVector(z$O._tempV30),z$RU.add(z$O._tempV30,z$V,z$O._tempV31),this.transformation.setTranslationVector(z$O._tempV31)},z$V.Size=function(z$V){z$RU.scale(this.extents,2,z$V)},z$V.getSize=function(z$V){var z$U=this.extents.elements;z$O._tempV30.x=z$U[0],z$O._tempV31.y=z$U[1],z$O._tempV32.z=z$U[2],z$RU.TransformNormal(z$O._tempV30,this.transformation,z$O._tempV30),z$RU.TransformNormal(z$O._tempV31,this.transformation,z$O._tempV31),z$RU.TransformNormal(z$O._tempV31,this.transformation,z$O._tempV32);var z$r=z$V.elements;z$r[0]=z$RU.scalarLength(z$O._tempV30),z$r[1]=z$RU.scalarLength(z$O._tempV31),z$r[2]=z$RU.scalarLength(z$O._tempV32)},z$V.getSizeSquared=function(z$V){var z$U=this.extents.elements;z$O._tempV30.x=z$U[0],z$O._tempV31.y=z$U[1],z$O._tempV32.z=z$U[2],z$RU.TransformNormal(z$O._tempV30,this.transformation,z$O._tempV30),z$RU.TransformNormal(z$O._tempV31,this.transformation,z$O._tempV31),z$RU.TransformNormal(z$O._tempV31,this.transformation,z$O._tempV32);var z$r=z$V.elements;z$r[0]=z$RU.scalarLengthSquared(z$O._tempV30),z$r[1]=z$RU.scalarLengthSquared(z$O._tempV31),z$r[2]=z$RU.scalarLengthSquared(z$O._tempV32)},z$V.getCenter=function(z$V){this.transformation.getTranslationVector(z$V)},z$V.containsPoint=function(z$V){var z$U=this.extents.elements,z$r=z$U[0],z$s=z$U[1],z$p=z$U[2];this.transformation.invert(z$O._tempM0),z$RU.transformCoordinate(z$V,z$O._tempM0,z$O._tempV30);var z$c=z$O._tempV30.elements,z$R=Math.abs(z$c[0]),z$T=Math.abs(z$c[1]),z$N=Math.abs(z$c[2]);return z$CV.nearEqual(z$R,z$r)&&z$CV.nearEqual(z$T,z$s)&&z$CV.nearEqual(z$N,z$p)?2:z$R<z$r&&z$T<z$s&&z$N<z$p?1:0},z$V.containsPoints=function(z$V){var z$U=this.extents.elements,z$r=z$U[0],z$s=z$U[1],z$p=z$U[2];this.transformation.invert(z$O._tempM0);for(var z$c=!0,z$R=!1,z$T=0;z$T<z$V.length;z$T++){z$RU.transformCoordinate(z$V[z$T],z$O._tempM0,z$O._tempV30);var z$N=z$O._tempV30.elements,z$t=Math.abs(z$N[0]),z$b=Math.abs(z$N[1]),z$S=Math.abs(z$N[2]);z$CV.nearEqual(z$t,z$r)&&z$CV.nearEqual(z$b,z$s)&&z$CV.nearEqual(z$S,z$p)&&(z$R=!0),z$t<z$r&&z$b<z$s&&z$S<z$p?z$R=!0:z$c=!1}return z$c?1:z$R?2:0},z$V.containsSphere=function(z$V,z$U){void 0===z$U&&(z$U=!1);var z$r=this.extents.elements,z$s=z$r[0],z$p=z$r[1],z$c=z$r[2],z$R=z$V.radius;this.transformation.invert(z$O._tempM0),z$RU.transformCoordinate(z$V.center,z$O._tempM0,z$O._tempV30);var z$T=NaN;if(z$T=z$U?z$R:(z$RU.scale(z$RU.UnitX,z$R,z$O._tempV31),z$RU.TransformNormal(z$O._tempV31,z$O._tempM0,z$O._tempV31),z$RU.scalarLength(z$O._tempV31)),z$RU.scale(this.extents,-1,z$O._tempV32),z$RU.Clamp(z$O._tempV30,z$O._tempV32,this.extents,z$O._tempV33),z$T*z$T<z$RU.distanceSquared(z$O._tempV30,z$O._tempV33))return 0;var z$N=z$O._tempV30.elements,z$t=z$N[0],z$b=z$N[1],z$S=z$N[2],z$_=z$O._tempV32.elements,z$G=z$_[0],z$q=z$_[1],z$u=z$_[2];return z$G+z$T<=z$t&&z$t<=z$s-z$T&&z$T<z$s-z$G&&z$q+z$T<=z$b&&z$b<=z$p-z$T&&z$T<z$p-z$q&&z$u+z$T<=z$S&&z$S<=z$c-z$T&&z$T<z$c-z$u?1:2},z$V.containsOrientedBoundBox=function(z$V){var z$U=0,z$r=0;z$V.getCorners(z$O._corners);var z$s=this.containsPoints(z$O._corners);if(0!=z$s)return z$s;var z$p=this.extents.elements;z$V.extents.cloneTo(z$O._tempV35);var z$c=z$O._tempV35.elements;z$O._getRows(this.transformation,z$O._rows1),z$O._getRows(z$V.transformation,z$O._rows2);var z$R=NaN;for(z$U=0;z$U<4;z$U++)for(z$r=0;z$r<4;z$r++)3==z$U||3==z$r?(z$O._tempM0.setElementByRowColumn(z$U,z$r,0),z$O._tempM1.setElementByRowColumn(z$U,z$r,0)):(z$R=z$RU.dot(z$O._rows1[z$U],z$O._rows2[z$r]),z$O._tempM0.setElementByRowColumn(z$U,z$r,z$R),z$O._tempM1.setElementByRowColumn(z$U,z$r,Math.abs(z$R)));z$V.getCenter(z$O._tempV34),this.getCenter(z$O._tempV36),z$RU.subtract(z$O._tempV34,z$O._tempV36,z$O._tempV30);var z$T=z$O._tempV31.elements;z$T[0]=z$RU.dot(z$O._tempV30,z$O._rows1[0]),z$T[1]=z$RU.dot(z$O._tempV30,z$O._rows1[1]),z$T[2]=z$RU.dot(z$O._tempV30,z$O._rows1[2]);var z$N=z$O._tempV32.elements,z$t=z$O._tempV33.elements;for(z$U=0;z$U<3;z$U++)if(z$N[0]=z$O._tempM1.getElementByRowColumn(z$U,0),z$N[1]=z$O._tempM1.getElementByRowColumn(z$U,1),z$N[2]=z$O._tempM1.getElementByRowColumn(z$U,2),z$p[z$U]+z$RU.dot(z$O._tempV35,z$O._tempV32)<Math.abs(z$T[z$U]))return 0;for(z$r=0;z$r<3;z$r++)if(z$N[0]=z$O._tempM1.getElementByRowColumn(0,z$r),z$N[1]=z$O._tempM1.getElementByRowColumn(1,z$r),z$N[2]=z$O._tempM1.getElementByRowColumn(2,z$r),z$t[0]=z$O._tempM0.getElementByRowColumn(0,z$r),z$t[1]=z$O._tempM0.getElementByRowColumn(1,z$r),z$t[2]=z$O._tempM0.getElementByRowColumn(2,z$r),z$RU.dot(this.extents,z$O._tempV32)+z$c[z$r]<Math.abs(z$RU.dot(z$O._tempV31,z$O._tempV33)))return 0;for(z$U=0;z$U<3;z$U++)for(z$r=0;z$r<3;z$r++){var z$b=(z$U+1)%3,z$S=(z$U+2)%3,z$_=(z$r+1)%3,z$G=(z$r+2)%3;if(z$p[z$b]*z$O._tempM1.getElementByRowColumn(z$S,z$r)+z$p[z$S]*z$O._tempM1.getElementByRowColumn(z$b,z$r)+(z$c[z$_]*z$O._tempM1.getElementByRowColumn(z$U,z$G)+z$c[z$G]*z$O._tempM1.getElementByRowColumn(z$U,z$_))<Math.abs(z$T[z$S]*z$O._tempM0.getElementByRowColumn(z$b,z$r)-z$T[z$b]*z$O._tempM0.getElementByRowColumn(z$S,z$r)))return 0}return 2},z$V.containsLine=function(z$V,z$U){z$O._corners[0]=z$V,z$O._corners[1]=z$U;var z$r=this.containsPoints(z$O._corners);if(0!=z$r)return z$r;var z$s=this.extents.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2];this.transformation.invert(z$O._tempM0),z$RU.transformCoordinate(z$V,z$O._tempM0,z$O._tempV30),z$RU.transformCoordinate(z$U,z$O._tempM0,z$O._tempV31),z$RU.add(z$O._tempV30,z$O._tempV31,z$O._tempV32),z$RU.scale(z$O._tempV32,.5,z$O._tempV32),z$RU.subtract(z$O._tempV30,z$O._tempV32,z$O._tempV33);var z$T=z$O._tempV33.elements,z$N=z$T[0],z$t=z$T[1],z$b=z$T[2],z$S=z$O._tempV34.elements,z$_=z$S[0]=Math.abs(z$T[0]),z$G=z$S[1]=Math.abs(z$T[1]),z$q=z$S[2]=Math.abs(z$T[2]),z$u=z$O._tempV32.elements,z$h=z$u[0],z$l=z$u[1],z$W=z$u[2];return Math.abs(z$h)>z$p+z$_?0:Math.abs(z$l)>z$c+z$G?0:Math.abs(z$W)>z$R+z$q?0:Math.abs(z$l*z$b-z$W*z$t)>z$c*z$q+z$R*z$G?0:Math.abs(z$h*z$b-z$W*z$N)>z$p*z$q+z$R*z$_?0:Math.abs(z$h*z$t-z$l*z$N)>z$p*z$G+z$c*z$_?0:2},z$V.containsBoundBox=function(z$V){var z$U=0,z$r=0,z$s=z$V.min,z$p=z$V.max;z$V.getCorners(z$O._corners);var z$c=this.containsPoints(z$O._corners);if(0!=z$c)return z$c;z$RU.subtract(z$p,z$s,z$O._tempV30),z$RU.scale(z$O._tempV30,.5,z$O._tempV30),z$RU.add(z$s,z$O._tempV30,z$O._tempV30),z$RU.subtract(z$p,z$O._tempV30,z$O._tempV31);var z$R=this.extents.elements,z$T=z$O._tempV31.elements;z$O._getRows(this.transformation,z$O._rows1),this.transformation.invert(z$O._tempM0);for(z$U=0;z$U<3;z$U++)for(z$r=0;z$r<3;z$r++)z$O._tempM1.setElementByRowColumn(z$U,z$r,Math.abs(z$O._tempM0.getElementByRowColumn(z$U,z$r)));this.getCenter(z$O._tempV35),z$RU.subtract(z$O._tempV30,z$O._tempV35,z$O._tempV32);var z$N=z$O._tempV31.elements;z$N[0]=z$RU.dot(z$O._tempV32,z$O._rows1[0]),z$N[1]=z$RU.dot(z$O._tempV32,z$O._rows1[1]),z$N[2]=z$RU.dot(z$O._tempV32,z$O._rows1[2]);var z$t=z$O._tempV33.elements,z$b=z$O._tempV34.elements;for(z$U=0;z$U<3;z$U++)if(z$t[0]=z$O._tempM1.getElementByRowColumn(z$U,0),z$t[1]=z$O._tempM1.getElementByRowColumn(z$U,1),z$t[2]=z$O._tempM1.getElementByRowColumn(z$U,2),z$R[z$U]+z$RU.dot(z$O._tempV31,z$O._tempV33)<Math.abs(z$N[z$U]))return 0;for(z$r=0;z$r<3;z$r++)if(z$t[0]=z$O._tempM1.getElementByRowColumn(0,z$r),z$t[1]=z$O._tempM1.getElementByRowColumn(1,z$r),z$t[2]=z$O._tempM1.getElementByRowColumn(2,z$r),z$b[0]=z$O._tempM0.getElementByRowColumn(0,z$r),z$b[1]=z$O._tempM0.getElementByRowColumn(1,z$r),z$b[2]=z$O._tempM0.getElementByRowColumn(2,z$r),z$RU.dot(this.extents,z$O._tempV33)+z$T[z$r]<Math.abs(z$RU.dot(z$O._tempV31,z$O._tempV34)))return 0;for(z$U=0;z$U<3;z$U++)for(z$r=0;z$r<3;z$r++){var z$S=(z$U+1)%3,z$_=(z$U+2)%3,z$G=(z$r+1)%3,z$q=(z$r+2)%3;if(z$R[z$S]*z$O._tempM1.getElementByRowColumn(z$_,z$r)+z$R[z$_]*z$O._tempM1.getElementByRowColumn(z$S,z$r)+(z$T[z$G]*z$O._tempM1.getElementByRowColumn(z$U,z$q)+z$T[z$q]*z$O._tempM1.getElementByRowColumn(z$U,z$G))<Math.abs(z$N[z$_]*z$O._tempM0.getElementByRowColumn(z$S,z$r)-z$N[z$S]*z$O._tempM0.getElementByRowColumn(z$_,z$r)))return 0}return 2},z$V.intersectsRay=function(z$V,z$U){z$RU.scale(this.extents,-1,z$O._tempV30),this.transformation.invert(z$O._tempM0),z$RU.TransformNormal(z$V.direction,z$O._tempM0,z$O._ray.direction),z$RU.transformCoordinate(z$V.origin,z$O._tempM0,z$O._ray.origin),z$O._boxBound1.min=z$O._tempV30,z$O._boxBound1.max=this.extents;var z$r=Collision.intersectsRayAndBoxRP(z$O._ray,z$O._boxBound1,z$U);return-1!==z$r&&z$RU.transformCoordinate(z$U,this.transformation,z$U),z$r},z$V._getLocalCorners=function(z$V){z$V.length=8;var z$U=this.extents.elements;z$O._tempV30.x=z$U[0],z$O._tempV31.y=z$U[1],z$O._tempV32.z=z$U[2],z$RU.add(z$O._tempV30,z$O._tempV31,z$O._tempV33),z$RU.add(z$O._tempV33,z$O._tempV32,z$V[0]),z$RU.add(z$O._tempV30,z$O._tempV31,z$O._tempV33),z$RU.subtract(z$O._tempV33,z$O._tempV32,z$V[1]),z$RU.subtract(z$O._tempV31,z$O._tempV30,z$O._tempV33),z$RU.subtract(z$O._tempV33,z$O._tempV30,z$V[2]),z$RU.subtract(z$O._tempV31,z$O._tempV30,z$O._tempV33),z$RU.add(z$O._tempV33,z$O._tempV32,z$V[3]),z$RU.subtract(z$O._tempV30,z$O._tempV31,z$O._tempV33),z$RU.add(z$O._tempV33,z$O._tempV32,z$V[4]),z$RU.subtract(z$O._tempV30,z$O._tempV31,z$O._tempV33),z$RU.subtract(z$O._tempV33,z$O._tempV32,z$V[5]),z$RU.scale(z$V[0],-1,z$V[6]),z$RU.subtract(z$O._tempV32,z$O._tempV30,z$O._tempV33),z$RU.subtract(z$O._tempV33,z$O._tempV31,z$V[7])},z$V.equals=function(z$V){return this.extents==z$V.extents&&this.transformation==z$V.transformation},z$V.cloneTo=function(z$V){var z$U=z$V;this.extents.cloneTo(z$U.extents),this.transformation.cloneTo(z$U.transformation)},z$O.createByBoundBox=function(z$V,z$U){var z$r=z$V.min,z$s=z$V.max;z$RU.subtract(z$s,z$r,z$O._tempV30),z$RU.scale(z$O._tempV30,.5,z$O._tempV30),z$RU.add(z$r,z$O._tempV30,z$O._tempV31),z$RU.subtract(z$s,z$O._tempV31,z$O._tempV32),z$VU.translation(z$O._tempV31,z$O._tempM0);var z$p=z$O._tempV32.clone(),z$c=z$O._tempM0.clone();z$U.extents=z$p,z$U.transformation=z$c},z$O.createByMinAndMaxVertex=function(z$V,z$U){return z$RU.subtract(z$U,z$V,z$O._tempV30),z$RU.scale(z$O._tempV30,.5,z$O._tempV30),z$RU.add(z$V,z$O._tempV30,z$O._tempV31),z$RU.subtract(z$U,z$O._tempV31,z$O._tempV32),z$VU.translation(z$O._tempV31,z$O._tempM0),new z$O(z$O._tempV32,z$O._tempM0)},z$O._getRows=function(z$V,z$U){z$U.length=3;var z$r=z$V.elements,z$s=z$U[0].elements;z$s[0]=z$r[0],z$s[1]=z$r[1],z$s[2]=z$r[2];var z$p=z$U[1].elements;z$p[0]=z$r[4],z$p[1]=z$r[5],z$p[2]=z$r[6];var z$c=z$U[2].elements;z$c[0]=z$r[8],z$c[1]=z$r[9],z$c[2]=z$r[10]},z$O.getObbtoObbMatrix4x4=function(z$V,z$U,z$r,z$s){var z$p=z$V.transformation,z$c=z$U.transformation;if(z$r){z$O._getRows(z$p,z$O._rows1),z$O._getRows(z$c,z$O._rows2);for(var z$R=0;z$R<3;z$R++)for(var z$T=0;z$T<3;z$T++)z$s.setElementByRowColumn(z$R,z$T,z$RU.dot(z$O._rows2[z$R],z$O._rows1[z$T]));z$U.getCenter(z$O._tempV30),z$V.getCenter(z$O._tempV31),z$RU.subtract(z$O._tempV30,z$O._tempV31,z$O._tempV32);var z$N=z$s.elements;z$N[12]=z$RU.dot(z$O._tempV32,z$O._rows1[0]),z$N[13]=z$RU.dot(z$O._tempV32,z$O._rows1[1]),z$N[14]=z$RU.dot(z$O._tempV32,z$O._rows1[2]),z$N[15]=1}else z$p.invert(z$O._tempM0),z$VU.multiply(z$c,z$O._tempM0,z$s)},z$O.merge=function(z$V,z$U,z$r){var z$s=z$V.extents,z$p=z$V.transformation;z$O.getObbtoObbMatrix4x4(z$V,z$U,z$r,z$O._tempM0),z$U._getLocalCorners(z$O._corners),z$RU.transformCoordinate(z$O._corners[0],z$O._tempM0,z$O._corners[0]),z$RU.transformCoordinate(z$O._corners[1],z$O._tempM0,z$O._corners[1]),z$RU.transformCoordinate(z$O._corners[2],z$O._tempM0,z$O._corners[2]),z$RU.transformCoordinate(z$O._corners[3],z$O._tempM0,z$O._corners[3]),z$RU.transformCoordinate(z$O._corners[4],z$O._tempM0,z$O._corners[4]),z$RU.transformCoordinate(z$O._corners[5],z$O._tempM0,z$O._corners[5]),z$RU.transformCoordinate(z$O._corners[6],z$O._tempM0,z$O._corners[6]),z$RU.transformCoordinate(z$O._corners[7],z$O._tempM0,z$O._corners[7]),z$RU.scale(z$s,-1,z$O._boxBound1.min),z$s.cloneTo(z$O._boxBound1.max),z$gV.createfromPoints(z$O._corners,z$O._boxBound2),z$gV.merge(z$O._boxBound2,z$O._boxBound1,z$O._boxBound3);var z$c=z$O._boxBound3.min,z$R=z$O._boxBound3.max;z$RU.subtract(z$R,z$c,z$O._tempV30),z$RU.scale(z$O._tempV30,.5,z$O._tempV30),z$RU.add(z$c,z$O._tempV30,z$O._tempV32),z$RU.subtract(z$R,z$O._tempV32,z$s),z$RU.transformCoordinate(z$O._tempV32,z$p,z$O._tempV33)},z$S(z$O,["_tempV30",function(){return this._tempV30=new z$RU},"_tempV31",function(){return this._tempV31=new z$RU},"_tempV32",function(){return this._tempV32=new z$RU},"_tempV33",function(){return this._tempV33=new z$RU},"_tempV34",function(){return this._tempV34=new z$RU},"_tempV35",function(){return this._tempV35=new z$RU},"_tempV36",function(){return this._tempV36=new z$RU},"_tempM0",function(){return this._tempM0=new z$VU},"_tempM1",function(){return this._tempM1=new z$VU},"_corners",function(){return this._corners=[new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU]},"_rows1",function(){return this._rows1=[new z$RU,new z$RU,new z$RU]},"_rows2",function(){return this._rows2=[new z$RU,new z$RU,new z$RU]},"_ray",function(){return this._ray=new z$pU(new z$RU,new z$RU)},"_boxBound1",function(){return this._boxBound1=new z$gV(new z$RU,new z$RU)},"_boxBound2",function(){return this._boxBound2=new z$gV(new z$RU,new z$RU)},"_boxBound3",function(){return this._boxBound3=new z$gV(new z$RU,new z$RU)}])}(),function(){function z$d(z$V,z$U){this.normal=null,this.distance=NaN,void 0===z$U&&(z$U=0),this.normal=z$V,this.distance=z$U}return z$G(z$d,"laya.d3.math.Plane"),z$d.prototype.normalize=function(){var z$V=this.normal.elements,z$U=z$V[0],z$r=z$V[1],z$s=z$V[2],z$p=1/Math.sqrt(z$U*z$U+z$r*z$r+z$s*z$s);z$V[0]=z$U*z$p,z$V[1]=z$r*z$p,z$V[2]=z$s*z$p,this.distance*=z$p},z$d.createPlaneBy3P=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$U.elements,z$c=z$r.elements,z$R=z$p[0]-z$s[0],z$T=z$p[1]-z$s[1],z$N=z$p[2]-z$s[2],z$t=z$c[0]-z$s[0],z$b=z$c[1]-z$s[1],z$S=z$c[2]-z$s[2],z$_=z$T*z$S-z$N*z$b,z$G=z$N*z$t-z$R*z$S,z$q=z$R*z$b-z$T*z$t,z$u=1/Math.sqrt(z$_*z$_+z$G*z$G+z$q*z$q),z$h=z$_*z$u,z$l=z$G*z$u,z$W=z$q*z$u,z$O=z$d._TEMPVec3.elements;z$O[0]=z$h,z$O[1]=z$l,z$O[2]=z$W;var z$L=-(z$h*z$s[0]+z$l*z$s[1]+z$W*z$s[2]);return new z$d(z$d._TEMPVec3,z$L)},z$d.PlaneIntersectionType_Back=0,z$d.PlaneIntersectionType_Front=1,z$d.PlaneIntersectionType_Intersecting=2,z$S(z$d,["_TEMPVec3",function(){return this._TEMPVec3=new z$RU}]),z$d}()),z$rU=function(){function z$p(z$V,z$U,z$r,z$s){this.elements=new Float32Array(4),void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=1),this.elements[0]=z$V,this.elements[1]=z$U,this.elements[2]=z$r,this.elements[3]=z$s}z$G(z$p,"laya.d3.math.Quaternion");var z$V=z$p.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.scaling=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements;z$r[0]=z$s[0]*z$V,z$r[1]=z$s[1]*z$V,z$r[2]=z$s[2]*z$V,z$r[3]=z$s[3]*z$V},z$V.normalize=function(z$V){var z$U=z$V.elements,z$r=this.elements,z$s=z$r[0],z$p=z$r[1],z$c=z$r[2],z$R=z$r[3],z$T=z$s*z$s+z$p*z$p+z$c*z$c+z$R*z$R;0<z$T&&(z$T=1/Math.sqrt(z$T),z$U[0]=z$s*z$T,z$U[1]=z$p*z$T,z$U[2]=z$c*z$T,z$U[3]=z$R*z$T)},z$V.length=function(){var z$V=this.elements,z$U=z$V[0],z$r=z$V[1],z$s=z$V[2],z$p=z$V[3];return Math.sqrt(z$U*z$U+z$r*z$r+z$s*z$s+z$p*z$p)},z$V.rotateX=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements;z$V*=.5;var z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=Math.sin(z$V),z$t=Math.cos(z$V);z$r[0]=z$p*z$t+z$T*z$N,z$r[1]=z$c*z$t+z$R*z$N,z$r[2]=z$R*z$t-z$c*z$N,z$r[3]=z$T*z$t-z$p*z$N},z$V.rotateY=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements;z$V*=.5;var z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=Math.sin(z$V),z$t=Math.cos(z$V);z$r[0]=z$p*z$t-z$R*z$N,z$r[1]=z$c*z$t+z$T*z$N,z$r[2]=z$R*z$t+z$p*z$N,z$r[3]=z$T*z$t-z$c*z$N},z$V.rotateZ=function(z$V,z$U){var z$r=z$U.elements,z$s=this.elements;z$V*=.5;var z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=Math.sin(z$V),z$t=Math.cos(z$V);z$r[0]=z$p*z$t+z$c*z$N,z$r[1]=z$c*z$t-z$p*z$N,z$r[2]=z$R*z$t+z$T*z$N,z$r[3]=z$T*z$t-z$R*z$N},z$V.getYawPitchRoll=function(z$V){z$RU.transformQuat(z$RU.ForwardRH,this,z$p.TEMPVector31),z$RU.transformQuat(z$RU.Up,this,z$p.TEMPVector32);var z$U=z$p.TEMPVector32.elements;z$p.angleTo(z$RU.ZERO,z$p.TEMPVector31,z$p.TEMPVector33);var z$r=z$p.TEMPVector33.elements;z$r[0]==Math.PI/2?(z$r[1]=z$p.arcTanAngle(z$U[2],z$U[0]),z$r[2]=0):z$r[0]==-Math.PI/2?(z$r[1]=z$p.arcTanAngle(-z$U[2],-z$U[0]),z$r[2]=0):(z$VU.createRotationY(-z$r[1],z$p.TEMPMatrix0),z$VU.createRotationX(-z$r[0],z$p.TEMPMatrix1),z$RU.transformCoordinate(z$p.TEMPVector32,z$p.TEMPMatrix0,z$p.TEMPVector32),z$RU.transformCoordinate(z$p.TEMPVector32,z$p.TEMPMatrix1,z$p.TEMPVector32),z$r[2]=z$p.arcTanAngle(z$U[1],-z$U[0])),z$r[1]<=-Math.PI&&(z$r[1]=Math.PI),z$r[2]<=-Math.PI&&(z$r[2]=Math.PI),z$r[1]>=Math.PI&&z$r[2]>=Math.PI&&(z$r[1]=0,z$r[2]=0,z$r[0]=Math.PI-z$r[0]);var z$s=z$V.elements;z$s[0]=z$r[1],z$s[1]=z$r[0],z$s[2]=z$r[2]},z$V.invert=function(z$V){var z$U=z$V.elements,z$r=this.elements,z$s=z$r[0],z$p=z$r[1],z$c=z$r[2],z$R=z$r[3],z$T=z$s*z$s+z$p*z$p+z$c*z$c+z$R*z$R,z$N=z$T?1/z$T:0;z$U[0]=-z$s*z$N,z$U[1]=-z$p*z$N,z$U[2]=-z$c*z$N,z$U[3]=z$R*z$N},z$V.identity=function(){var z$V=this.elements;z$V[0]=0,z$V[1]=0,z$V[2]=0,z$V[3]=1},z$V.fromArray=function(z$V,z$U){void 0===z$U&&(z$U=0),this.elements[0]=z$V[z$U+0],this.elements[1]=z$V[z$U+1],this.elements[2]=z$V[z$U+2],this.elements[3]=z$V[z$U+3]},z$V.cloneTo=function(z$V){var z$U,z$r,z$s;if((z$r=this.elements)!==(z$s=z$V.elements))for(z$U=0;z$U<4;++z$U)z$s[z$U]=z$r[z$U]},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$V.equals=function(z$V){var z$U=this.elements,z$r=z$V.elements;return z$CV.nearEqual(z$U[0],z$r[0])&&z$CV.nearEqual(z$U[1],z$r[1])&&z$CV.nearEqual(z$U[2],z$r[2])&&z$CV.nearEqual(z$U[3],z$r[3])},z$V.lengthSquared=function(){var z$V=this.elements[0],z$U=this.elements[1],z$r=this.elements[2],z$s=this.elements[3];return z$V*z$V+z$U*z$U+z$r*z$r+z$s*z$s},z$q(0,z$V,"x",function(){return this.elements[0]}),z$q(0,z$V,"y",function(){return this.elements[1]}),z$q(0,z$V,"z",function(){return this.elements[2]}),z$q(0,z$V,"w",function(){return this.elements[3]}),z$p.createFromYawPitchRoll=function(z$V,z$U,z$r,z$s){var z$p=.5*z$r,z$c=.5*z$U,z$R=.5*z$V,z$T=Math.sin(z$p),z$N=Math.cos(z$p),z$t=Math.sin(z$c),z$b=Math.cos(z$c),z$S=Math.sin(z$R),z$_=Math.cos(z$R),z$G=z$s.elements;z$G[0]=z$_*z$t*z$N+z$S*z$b*z$T,z$G[1]=z$S*z$b*z$N-z$_*z$t*z$T,z$G[2]=z$_*z$b*z$T-z$S*z$t*z$N,z$G[3]=z$_*z$b*z$N+z$S*z$t*z$T},z$p.multiply=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$U.elements,z$c=z$r.elements,z$R=z$s[0],z$T=z$s[1],z$N=z$s[2],z$t=z$s[3],z$b=z$p[0],z$S=z$p[1],z$_=z$p[2],z$G=z$p[3],z$q=z$T*z$_-z$N*z$S,z$u=z$N*z$b-z$R*z$_,z$h=z$R*z$S-z$T*z$b,z$l=z$R*z$b+z$T*z$S+z$N*z$_;z$c[0]=z$R*z$G+z$b*z$t+z$q,z$c[1]=z$T*z$G+z$S*z$t+z$u,z$c[2]=z$N*z$G+z$_*z$t+z$h,z$c[3]=z$t*z$G-z$l},z$p.arcTanAngle=function(z$V,z$U){return 0==z$V?1==z$U?Math.PI/2:-Math.PI/2:0<z$V?Math.atan(z$U/z$V):z$V<0?0<z$U?Math.atan(z$U/z$V)+Math.PI:Math.atan(z$U/z$V)-Math.PI:0},z$p.angleTo=function(z$V,z$U,z$r){z$RU.subtract(z$U,z$V,z$p.TEMPVector30),z$RU.normalize(z$p.TEMPVector30,z$p.TEMPVector30),z$r.elements[0]=Math.asin(z$p.TEMPVector30.y),z$r.elements[1]=z$p.arcTanAngle(-z$p.TEMPVector30.z,-z$p.TEMPVector30.x)},z$p.createFromAxisAngle=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements;z$U*=.5;var z$c=Math.sin(z$U);z$s[0]=z$c*z$p[0],z$s[1]=z$c*z$p[1],z$s[2]=z$c*z$p[2],z$s[3]=Math.cos(z$U)},z$p.createFromMatrix3x3=function(z$V,z$U){var z$r,z$s=z$U.elements,z$p=z$V.elements,z$c=z$p[0]+z$p[4]+z$p[8];if(0<z$c)z$r=Math.sqrt(z$c+1),z$s[3]=.5*z$r,z$r=.5/z$r,z$s[0]=(z$p[5]-z$p[7])*z$r,z$s[1]=(z$p[6]-z$p[2])*z$r,z$s[2]=(z$p[1]-z$p[3])*z$r;else{var z$R=0;z$p[4]>z$p[0]&&(z$R=1),z$p[8]>z$p[3*z$R+z$R]&&(z$R=2);var z$T=(z$R+1)%3,z$N=(z$R+2)%3;z$r=Math.sqrt(z$p[3*z$R+z$R]-z$p[3*z$T+z$T]-z$p[3*z$N+z$N]+1),z$s[z$R]=.5*z$r,z$r=.5/z$r,z$s[3]=(z$p[3*z$T+z$N]-z$p[3*z$N+z$T])*z$r,z$s[z$T]=(z$p[3*z$T+z$R]+z$p[3*z$R+z$T])*z$r,z$s[z$N]=(z$p[3*z$N+z$R]+z$p[3*z$R+z$N])*z$r}},z$p.createFromMatrix4x4=function(z$V,z$U){var z$r,z$s,z$p=z$V.elements,z$c=z$U.elements,z$R=z$p[0]+z$p[5]+z$p[10];0<z$R?(z$r=Math.sqrt(z$R+1),z$c[3]=.5*z$r,z$r=.5/z$r,z$c[0]=(z$p[6]-z$p[9])*z$r,z$c[1]=(z$p[8]-z$p[2])*z$r,z$c[2]=(z$p[1]-z$p[4])*z$r):z$p[0]>=z$p[5]&&z$p[0]>=z$p[10]?(z$s=.5/(z$r=Math.sqrt(1+z$p[0]-z$p[5]-z$p[10])),z$c[0]=.5*z$r,z$c[1]=(z$p[1]+z$p[4])*z$s,z$c[2]=(z$p[2]+z$p[8])*z$s,z$c[3]=(z$p[6]-z$p[9])*z$s):z$p[5]>z$p[10]?(z$s=.5/(z$r=Math.sqrt(1+z$p[5]-z$p[0]-z$p[10])),z$c[0]=(z$p[4]+z$p[1])*z$s,z$c[1]=.5*z$r,z$c[2]=(z$p[9]+z$p[6])*z$s,z$c[3]=(z$p[8]-z$p[2])*z$s):(z$s=.5/(z$r=Math.sqrt(1+z$p[10]-z$p[0]-z$p[5])),z$c[0]=(z$p[8]+z$p[2])*z$s,z$c[1]=(z$p[9]+z$p[6])*z$s,z$c[2]=.5*z$r,z$c[3]=(z$p[1]-z$p[4])*z$s)},z$p.slerp=function(z$V,z$U,z$r,z$s){var z$p,z$c,z$R,z$T,z$N,z$t=z$V.elements,z$b=z$U.elements,z$S=z$s.elements,z$_=z$t[0],z$G=z$t[1],z$q=z$t[2],z$u=z$t[3],z$h=z$b[0],z$l=z$b[1],z$W=z$b[2],z$O=z$b[3];return(z$c=z$_*z$h+z$G*z$l+z$q*z$W+z$u*z$O)<0&&(z$c=-z$c,z$h=-z$h,z$l=-z$l,z$W=-z$W,z$O=-z$O),z$N=1e-6<1-z$c?(z$p=Math.acos(z$c),z$R=Math.sin(z$p),z$T=Math.sin((1-z$r)*z$p)/z$R,Math.sin(z$r*z$p)/z$R):(z$T=1-z$r,z$r),z$S[0]=z$T*z$_+z$N*z$h,z$S[1]=z$T*z$G+z$N*z$l,z$S[2]=z$T*z$q+z$N*z$W,z$S[3]=z$T*z$u+z$N*z$O,z$S},z$p.lerp=function(z$V,z$U,z$r,z$s){var z$p=z$s.elements,z$c=z$V.elements,z$R=z$U.elements,z$T=z$c[0],z$N=z$c[1],z$t=z$c[2],z$b=z$c[3];z$p[0]=z$T+z$r*(z$R[0]-z$T),z$p[1]=z$N+z$r*(z$R[1]-z$N),z$p[2]=z$t+z$r*(z$R[2]-z$t),z$p[3]=z$b+z$r*(z$R[3]-z$b)},z$p.add=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]+z$c[0],z$s[1]=z$p[1]+z$c[1],z$s[2]=z$p[2]+z$c[2],z$s[3]=z$p[3]+z$c[3]},z$p.dot=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;return z$r[0]*z$s[0]+z$r[1]*z$s[1]+z$r[2]*z$s[2]+z$r[3]*z$s[3]},z$p.rotationLookAt=function(z$V,z$U,z$r){z$p.lookAt(z$RU.ZERO,z$V,z$U,z$r)},z$p.lookAt=function(z$V,z$U,z$r,z$s){z$fV.lookAt(z$V,z$U,z$r,z$p._tempMatrix3x3),z$p.rotationMatrix(z$p._tempMatrix3x3,z$s)},z$p.invert=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$V.lengthSquared();z$CV.isZero(z$p)||(z$p=1/z$p,z$s[0]=-z$r[0]*z$p,z$s[1]=-z$r[1]*z$p,z$s[2]=-z$r[2]*z$p,z$s[3]=z$r[3]*z$p)},z$p.rotationMatrix=function(z$V,z$U){var z$r=z$V.elements,z$s=z$r[0],z$p=z$r[1],z$c=z$r[2],z$R=z$r[3],z$T=z$r[4],z$N=z$r[5],z$t=z$r[6],z$b=z$r[7],z$S=z$r[8],z$_=z$U.elements,z$G=NaN,z$q=NaN,z$u=z$s+z$T+z$S;0<z$u?(z$G=Math.sqrt(z$u+1),z$_[3]=.5*z$G,z$G=.5/z$G,z$_[0]=(z$N-z$b)*z$G,z$_[1]=(z$t-z$c)*z$G,z$_[2]=(z$p-z$R)*z$G):z$T<=z$s&&z$S<=z$s?(z$q=.5/(z$G=Math.sqrt(1+z$s-z$T-z$S)),z$_[0]=.5*z$G,z$_[1]=(z$p+z$R)*z$q,z$_[2]=(z$c+z$t)*z$q,z$_[3]=(z$N-z$b)*z$q):z$S<z$T?(z$q=.5/(z$G=Math.sqrt(1+z$T-z$s-z$S)),z$_[0]=(z$R+z$p)*z$q,z$_[1]=.5*z$G,z$_[2]=(z$b+z$N)*z$q,z$_[3]=(z$t-z$c)*z$q):(z$q=.5/(z$G=Math.sqrt(1+z$S-z$s-z$T)),z$_[0]=(z$t+z$c)*z$q,z$_[1]=(z$b+z$N)*z$q,z$_[2]=.5*z$G,z$_[3]=(z$p-z$R)*z$q)},z$p.DEFAULT=new z$p,z$S(z$p,["TEMPVector30",function(){return this.TEMPVector30=new z$RU},"TEMPVector31",function(){return this.TEMPVector31=new z$RU},"TEMPVector32",function(){return this.TEMPVector32=new z$RU},"TEMPVector33",function(){return this.TEMPVector33=new z$RU},"TEMPMatrix0",function(){return this.TEMPMatrix0=new z$VU},"TEMPMatrix1",function(){return this.TEMPMatrix1=new z$VU},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new z$fV},"NAN",function(){return this.NAN=new z$p(NaN,NaN,NaN,NaN)}]),z$p}(),z$sU=function(){function z$V(z$V){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=z$V,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}z$G(z$V,"laya.d3.math.Rand");var z$U=z$V.prototype;return z$U.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},z$U.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},z$U.getSignedFloat=function(){return 2*this.getFloat()-1},z$q(0,z$U,"seed",function(){return this.seeds[0]},function(z$V){this.seeds[0]=z$V,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),z$V.getFloatFromInt=function(z$V){return 1/8388607*(8388607&z$V)},z$V.getByteFromInt=function(z$V){return(8388607&z$V)>>>15},z$V}(),z$pU=(function(){function z$p(z$V){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(z$V instanceof Array)||4!==z$V.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|z$V[0],this._state0L=0|z$V[1],this._state1U=0|z$V[2],this._state1L=0|z$V[3]}z$G(z$p,"laya.d3.math.RandX");var z$V=z$p.prototype;z$V.randomint=function(){var z$V=this._state0U,z$U=this._state0L,z$r=this._state1U,z$s=this._state1L,z$p=(z$s>>>0)+(z$U>>>0),z$c=z$r+z$V+(z$p/2>>>31)>>>0,z$R=z$p>>>0,z$T=0,z$N=0;z$T=(z$V^=z$T=z$V<<23|(-512&z$U)>>>9)^(this._state0U=z$r),z$N=(z$U^=z$N=z$U<<23)^(this._state0L=z$s);z$T^=z$V>>>18,z$N^=z$U>>>18|(262143&z$V)<<14;return z$T^=z$r>>>5,z$N^=z$s>>>5|(31&z$r)<<27,this._state1U=z$T,this._state1L=z$N,[z$c,z$R]},z$V.random=function(){var z$V=this.randomint(),z$U=z$V[0],z$r=1023<<20|z$U>>>12,z$s=0|(z$V[1]>>>12|(4095&z$U)<<20);return z$p._CONVERTION_BUFFER.setUint32(0,z$r,!1),z$p._CONVERTION_BUFFER.setUint32(4,z$s,!1),z$sU._CONVERTION_BUFFER.getFloat64(0,!1)-1},z$S(z$p,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new z$sU([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function z$V(z$V,z$U){this.origin=null,this.direction=null,this.origin=z$V,this.direction=z$U}return z$G(z$V,"laya.d3.math.Ray"),z$V}()),z$cU=function(){function z$V(z$V,z$U){this.elements=new Float32Array(2),void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0);var z$r=this.elements;z$r[0]=z$V,z$r[1]=z$U}z$G(z$V,"laya.d3.math.Vector2");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.fromArray=function(z$V,z$U){void 0===z$U&&(z$U=0),this.elements[0]=z$V[z$U+0],this.elements[1]=z$V[z$U+1]},z$U.cloneTo=function(z$V){var z$U=z$V.elements,z$r=this.elements;z$U[0]=z$r[0],z$U[1]=z$r[1]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"x",function(){return this.elements[0]},function(z$V){this.elements[0]=z$V}),z$q(0,z$U,"y",function(){return this.elements[1]},function(z$V){this.elements[1]=z$V}),z$V.scale=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements;z$s[0]=z$p[0]*z$U,z$s[1]=z$p[1]*z$U},z$S(z$V,["ZERO",function(){return this.ZERO=new z$V(0,0)},"ONE",function(){return this.ONE=new z$V(1,1)}]),z$V}(),z$RU=function(){function z$b(z$V,z$U,z$r){this.elements=new Float32Array(3),void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0);var z$s=this.elements;z$s[0]=z$V,z$s[1]=z$U,z$s[2]=z$r}z$G(z$b,"laya.d3.math.Vector3");var z$V=z$b.prototype;return z$d.imps(z$V,{"laya.d3.core.IClone":!0}),z$V.fromArray=function(z$V,z$U){void 0===z$U&&(z$U=0),this.elements[0]=z$V[z$U+0],this.elements[1]=z$V[z$U+1],this.elements[2]=z$V[z$U+2]},z$V.cloneTo=function(z$V){var z$U=z$V.elements,z$r=this.elements;z$U[0]=z$r[0],z$U[1]=z$r[1],z$U[2]=z$r[2]},z$V.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$V.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},z$V.reset=function(z$V,z$U,z$r){this.elements[0]=z$V,this.elements[1]=z$U,this.elements[2]=z$r},z$q(0,z$V,"x",function(){return this.elements[0]},function(z$V){this.elements[0]=z$V}),z$q(0,z$V,"y",function(){return this.elements[1]},function(z$V){this.elements[1]=z$V}),z$q(0,z$V,"z",function(){return this.elements[2]},function(z$V){this.elements[2]=z$V}),z$b.distanceSquared=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0]-z$s[0],z$c=z$r[1]-z$s[1],z$R=z$r[2]-z$s[2];return z$p*z$p+z$c*z$c+z$R*z$R},z$b.distance=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0]-z$s[0],z$c=z$r[1]-z$s[1],z$R=z$r[2]-z$s[2];return Math.sqrt(z$p*z$p+z$c*z$c+z$R*z$R)},z$b.min=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=Math.min(z$p[0],z$c[0]),z$s[1]=Math.min(z$p[1],z$c[1]),z$s[2]=Math.min(z$p[2],z$c[2])},z$b.max=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=Math.max(z$p[0],z$c[0]),z$s[1]=Math.max(z$p[1],z$c[1]),z$s[2]=Math.max(z$p[2],z$c[2])},z$b.transformQuat=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements,z$R=z$p[0],z$T=z$p[1],z$N=z$p[2],z$t=z$c[0],z$b=z$c[1],z$S=z$c[2],z$_=z$c[3],z$G=z$_*z$R+z$b*z$N-z$S*z$T,z$q=z$_*z$T+z$S*z$R-z$t*z$N,z$u=z$_*z$N+z$t*z$T-z$b*z$R,z$h=-z$t*z$R-z$b*z$T-z$S*z$N;z$s[0]=z$G*z$_+z$h*-z$t+z$q*-z$S-z$u*-z$b,z$s[1]=z$q*z$_+z$h*-z$b+z$u*-z$t-z$G*-z$S,z$s[2]=z$u*z$_+z$h*-z$S+z$G*-z$b-z$q*-z$t},z$b.scalarLength=function(z$V){var z$U=z$V.elements,z$r=z$U[0],z$s=z$U[1],z$p=z$U[2];return Math.sqrt(z$r*z$r+z$s*z$s+z$p*z$p)},z$b.scalarLengthSquared=function(z$V){var z$U=z$V.elements,z$r=z$U[0],z$s=z$U[1],z$p=z$U[2];return z$r*z$r+z$s*z$s+z$p*z$p},z$b.normalize=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0],z$c=z$r[1],z$R=z$r[2],z$T=z$p*z$p+z$c*z$c+z$R*z$R;0<z$T&&(z$T=1/Math.sqrt(z$T),z$s[0]=z$r[0]*z$T,z$s[1]=z$r[1]*z$T,z$s[2]=z$r[2]*z$T)},z$b.multiply=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]*z$c[0],z$s[1]=z$p[1]*z$c[1],z$s[2]=z$p[2]*z$c[2]},z$b.scale=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements;z$s[0]=z$p[0]*z$U,z$s[1]=z$p[1]*z$U,z$s[2]=z$p[2]*z$U},z$b.lerp=function(z$V,z$U,z$r,z$s){var z$p=z$s.elements,z$c=z$V.elements,z$R=z$U.elements,z$T=z$c[0],z$N=z$c[1],z$t=z$c[2];z$p[0]=z$T+z$r*(z$R[0]-z$T),z$p[1]=z$N+z$r*(z$R[1]-z$N),z$p[2]=z$t+z$r*(z$R[2]-z$t)},z$b.transformV3ToV3=function(z$V,z$U,z$r){var z$s=z$b._tempVector4;z$b.transformV3ToV4(z$V,z$U,z$s);var z$p=z$s.elements,z$c=z$r.elements;z$c[0]=z$p[0],z$c[1]=z$p[1],z$c[2]=z$p[2]},z$b.transformV3ToV4=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$U.elements,z$N=z$r.elements;z$N[0]=z$p*z$T[0]+z$c*z$T[4]+z$R*z$T[8]+z$T[12],z$N[1]=z$p*z$T[1]+z$c*z$T[5]+z$R*z$T[9]+z$T[13],z$N[2]=z$p*z$T[2]+z$c*z$T[6]+z$R*z$T[10]+z$T[14],z$N[3]=z$p*z$T[3]+z$c*z$T[7]+z$R*z$T[11]+z$T[15]},z$b.TransformNormal=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$U.elements,z$N=z$r.elements;z$N[0]=z$p*z$T[0]+z$c*z$T[4]+z$R*z$T[8],z$N[1]=z$p*z$T[1]+z$c*z$T[5]+z$R*z$T[9],z$N[2]=z$p*z$T[2]+z$c*z$T[6]+z$R*z$T[10]},z$b.transformCoordinate=function(z$V,z$U,z$r){var z$s=z$b._tempVector4.elements,z$p=z$V.elements,z$c=z$p[0],z$R=z$p[1],z$T=z$p[2],z$N=z$U.elements;z$s[0]=z$c*z$N[0]+z$R*z$N[4]+z$T*z$N[8]+z$N[12],z$s[1]=z$c*z$N[1]+z$R*z$N[5]+z$T*z$N[9]+z$N[13],z$s[2]=z$c*z$N[2]+z$R*z$N[6]+z$T*z$N[10]+z$N[14],z$s[3]=1/(z$c*z$N[3]+z$R*z$N[7]+z$T*z$N[11]+z$N[15]);var z$t=z$r.elements;z$t[0]=z$s[0]*z$s[3],z$t[1]=z$s[1]*z$s[3],z$t[2]=z$s[2]*z$s[3]},z$b.Clamp=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements,z$c=z$p[0],z$R=z$p[1],z$T=z$p[2],z$N=z$U.elements,z$t=z$N[0],z$b=z$N[1],z$S=z$N[2],z$_=z$r.elements,z$G=z$_[0],z$q=z$_[1],z$u=z$_[2],z$h=z$s.elements;z$c=(z$c=z$G<z$c?z$G:z$c)<z$t?z$t:z$c,z$R=(z$R=z$q<z$R?z$q:z$R)<z$b?z$b:z$R,z$T=(z$T=z$u<z$T?z$u:z$T)<z$S?z$S:z$T,z$h[0]=z$c,z$h[1]=z$R,z$h[2]=z$T},z$b.add=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]+z$c[0],z$s[1]=z$p[1]+z$c[1],z$s[2]=z$p[2]+z$c[2]},z$b.subtract=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]-z$c[0],z$s[1]=z$p[1]-z$c[1],z$s[2]=z$p[2]-z$c[2]},z$b.cross=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$U.elements,z$c=z$r.elements,z$R=z$s[0],z$T=z$s[1],z$N=z$s[2],z$t=z$p[0],z$b=z$p[1],z$S=z$p[2];z$c[0]=z$T*z$S-z$N*z$b,z$c[1]=z$N*z$t-z$R*z$S,z$c[2]=z$R*z$b-z$T*z$t},z$b.dot=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;return z$r[0]*z$s[0]+z$r[1]*z$s[1]+z$r[2]*z$s[2]},z$b.equals=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;return z$CV.nearEqual(Math.abs(z$r[0]),Math.abs(z$s[0]))&&z$CV.nearEqual(Math.abs(z$r[1]),Math.abs(z$s[1]))&&z$CV.nearEqual(Math.abs(z$r[2]),Math.abs(z$s[2]))},z$b.ZERO=new z$b(0,0,0),z$b.ONE=new z$b(1,1,1),z$b.NegativeUnitX=new z$b(-1,0,0),z$b.UnitX=new z$b(1,0,0),z$b.UnitY=new z$b(0,1,0),z$b.UnitZ=new z$b(0,0,1),z$b.ForwardRH=new z$b(0,0,-1),z$b.ForwardLH=new z$b(0,0,1),z$b.Up=new z$b(0,1,0),z$b.NAN=new z$b(NaN,NaN,NaN),z$S(z$b,["_tempVector4",function(){return this._tempVector4=new z$TU}]),z$b}(),z$TU=function(){function z$V(z$V,z$U,z$r,z$s){this.elements=new Float32Array(4),void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=0);var z$p=this.elements;z$p[0]=z$V,z$p[1]=z$U,z$p[2]=z$r,z$p[3]=z$s}z$G(z$V,"laya.d3.math.Vector4");var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U.fromArray=function(z$V,z$U){void 0===z$U&&(z$U=0),this.elements[0]=z$V[z$U+0],this.elements[1]=z$V[z$U+1],this.elements[2]=z$V[z$U+2],this.elements[3]=z$V[z$U+3]},z$U.cloneTo=function(z$V){var z$U=z$V.elements,z$r=this.elements;z$U[0]=z$r[0],z$U[1]=z$r[1],z$U[2]=z$r[2],z$U[3]=z$r[3]},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$U.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},z$U.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},z$q(0,z$U,"x",function(){return this.elements[0]},function(z$V){this.elements[0]=z$V}),z$q(0,z$U,"y",function(){return this.elements[1]},function(z$V){this.elements[1]=z$V}),z$q(0,z$U,"z",function(){return this.elements[2]},function(z$V){this.elements[2]=z$V}),z$q(0,z$U,"w",function(){return this.elements[3]},function(z$V){this.elements[3]=z$V}),z$V.lerp=function(z$V,z$U,z$r,z$s){var z$p=z$s.elements,z$c=z$V.elements,z$R=z$U.elements,z$T=z$c[0],z$N=z$c[1],z$t=z$c[2],z$b=z$c[3];z$p[0]=z$T+z$r*(z$R[0]-z$T),z$p[1]=z$N+z$r*(z$R[1]-z$N),z$p[2]=z$t+z$r*(z$R[2]-z$t),z$p[3]=z$b+z$r*(z$R[3]-z$b)},z$V.transformByM4x4=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$s[0],z$c=z$s[1],z$R=z$s[2],z$T=z$s[3],z$N=z$U.elements,z$t=z$r.elements;z$t[0]=z$p*z$N[0]+z$c*z$N[4]+z$R*z$N[8]+z$T*z$N[12],z$t[1]=z$p*z$N[1]+z$c*z$N[5]+z$R*z$N[9]+z$T*z$N[13],z$t[2]=z$p*z$N[2]+z$c*z$N[6]+z$R*z$N[10]+z$T*z$N[14],z$t[3]=z$p*z$N[3]+z$c*z$N[7]+z$R*z$N[11]+z$T*z$N[15]},z$V.equals=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;return z$CV.nearEqual(Math.abs(z$r[0]),Math.abs(z$s[0]))&&z$CV.nearEqual(Math.abs(z$r[1]),Math.abs(z$s[1]))&&z$CV.nearEqual(Math.abs(z$r[2]),Math.abs(z$s[2]))&&z$CV.nearEqual(Math.abs(z$r[3]),Math.abs(z$s[3]))},z$V.normalize=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$V.length();0<z$p&&(z$s[0]=z$r[0]*z$p,z$s[1]=z$r[1]*z$p,z$s[2]=z$r[2]*z$p,z$s[3]=z$r[3]*z$p)},z$V.add=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]+z$c[0],z$s[1]=z$p[1]+z$c[1],z$s[2]=z$p[2]+z$c[2],z$s[3]=z$p[3]+z$c[3]},z$V.subtract=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]-z$c[0],z$s[1]=z$p[1]-z$c[1],z$s[2]=z$p[2]-z$c[2],z$s[3]=z$p[3]-z$c[3]},z$V.multiply=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=z$p[0]*z$c[0],z$s[1]=z$p[1]*z$c[1],z$s[2]=z$p[2]*z$c[2],z$s[3]=z$p[3]*z$c[3]},z$V.scale=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements;z$s[0]=z$p[0]*z$U,z$s[1]=z$p[1]*z$U,z$s[2]=z$p[2]*z$U,z$s[3]=z$p[3]*z$U},z$V.Clamp=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements,z$c=z$p[0],z$R=z$p[1],z$T=z$p[2],z$N=z$p[3],z$t=z$U.elements,z$b=z$t[0],z$S=z$t[1],z$_=z$t[2],z$G=z$t[3],z$q=z$r.elements,z$u=z$q[0],z$h=z$q[1],z$l=z$q[2],z$W=z$q[3],z$O=z$s.elements;z$c=(z$c=z$u<z$c?z$u:z$c)<z$b?z$b:z$c,z$R=(z$R=z$h<z$R?z$h:z$R)<z$S?z$S:z$R,z$T=(z$T=z$l<z$T?z$l:z$T)<z$_?z$_:z$T,z$N=(z$N=z$W<z$N?z$W:z$N)<z$G?z$G:z$N,z$O[0]=z$c,z$O[1]=z$R,z$O[2]=z$T,z$O[3]=z$N},z$V.distanceSquared=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0]-z$s[0],z$c=z$r[1]-z$s[1],z$R=z$r[2]-z$s[2],z$T=z$r[3]-z$s[3];return z$p*z$p+z$c*z$c+z$R*z$R+z$T*z$T},z$V.distance=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements,z$p=z$r[0]-z$s[0],z$c=z$r[1]-z$s[1],z$R=z$r[2]-z$s[2],z$T=z$r[3]-z$s[3];return Math.sqrt(z$p*z$p+z$c*z$c+z$R*z$R+z$T*z$T)},z$V.dot=function(z$V,z$U){var z$r=z$V.elements,z$s=z$U.elements;return z$r[0]*z$s[0]+z$r[1]*z$s[1]+z$r[2]*z$s[2]+z$r[3]*z$s[3]},z$V.min=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=Math.min(z$p[0],z$c[0]),z$s[1]=Math.min(z$p[1],z$c[1]),z$s[2]=Math.min(z$p[2],z$c[2]),z$s[3]=Math.min(z$p[3],z$c[3])},z$V.max=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U.elements;z$s[0]=Math.max(z$p[0],z$c[0]),z$s[1]=Math.max(z$p[1],z$c[1]),z$s[2]=Math.max(z$p[2],z$c[2]),z$s[3]=Math.max(z$p[3],z$c[3])},z$S(z$V,["ZERO",function(){return this.ZERO=new z$V},"ONE",function(){return this.ONE=new z$V(1,1,1,1)},"UnitX",function(){return this.UnitX=new z$V(1,0,0,0)},"UnitY",function(){return this.UnitY=new z$V(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new z$V(0,0,1,0)},"UnitW",function(){return this.UnitW=new z$V(0,0,0,1)}]),z$V}(),z$NU=function(){function z$c(z$V,z$U,z$r,z$s){this.minDepth=0,this.maxDepth=1,this.x=z$V,this.y=z$U,this.width=z$r,this.height=z$s}z$G(z$c,"laya.d3.math.Viewport");var z$V=z$c.prototype;return z$V.project=function(z$V,z$U,z$r){z$RU.transformV3ToV3(z$V,z$U,z$r);var z$s=z$V.elements,z$p=z$U.elements,z$c=z$r.elements,z$R=z$s[0]*z$p[3]+z$s[1]*z$p[7]+z$s[2]*z$p[11]+z$p[15];1!==z$R&&(z$c[0]=z$c[0]/z$R,z$c[1]=z$c[1]/z$R,z$c[2]=z$c[2]/z$R),z$c[0]=.5*(z$c[0]+1)*this.width+this.x,z$c[1]=.5*(1-z$c[1])*this.height+this.y,z$c[2]=z$c[2]*(this.maxDepth-this.minDepth)+this.minDepth},z$V.unprojectFromMat=function(z$V,z$U,z$r){var z$s=z$V.elements,z$p=z$U.elements,z$c=z$r.elements;z$c[0]=(z$s[0]-this.x)/this.width*2-1,z$c[1]=-((z$s[1]-this.y)/this.height*2-1);var z$R=(this.maxDepth-this.minDepth)/2;z$c[2]=(z$s[2]-this.minDepth-z$R)/z$R;var z$T=z$c[0]*z$p[3]+z$c[1]*z$p[7]+z$c[2]*z$p[11]+z$p[15];z$RU.transformV3ToV3(z$r,z$U,z$r),1!==z$T&&(z$c[0]=z$c[0]/z$T,z$c[1]=z$c[1]/z$T,z$c[2]=z$c[2]/z$T)},z$V.unprojectFromWVP=function(z$V,z$U,z$r,z$s,z$p){z$VU.multiply(z$U,z$r,z$c._tempMatrix4x4),z$s&&z$VU.multiply(z$c._tempMatrix4x4,z$s,z$c._tempMatrix4x4),z$c._tempMatrix4x4.invert(z$c._tempMatrix4x4),this.unprojectFromMat(z$V,z$c._tempMatrix4x4,z$p)},z$S(z$c,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new z$VU}]),z$c}(),z$tU=function(){function z$H(z$V){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=z$V,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}z$G(z$H,"laya.d3.resource.models.SubMesh");var z$V=z$H.prototype;return z$d.imps(z$V,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),z$V._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),0===z$V?this._vertexBuffer:null},z$V._getIndexBuffer=function(){return this._indexBuffer},z$V._getStaticBatchBakedVertexs=function(z$V,z$U){var z$r,z$s,z$p=this._vertexBuffer,z$c=z$p.vertexDeclaration,z$R=z$c.getVertexElementByUsage(0).offset/4,z$T=z$c.getVertexElementByUsage(3).offset/4,z$N=z$U.meshRender.lightmapScaleOffset,z$t=0,z$b=0,z$S=0,z$_=0,z$G=0,z$q=0;if(z$N)if(z$s=z$c.getVertexElementByUsage(15))z$S=z$c.vertexStride/4,z$r=0<this._vertexCount?z$p.getData().slice(this._vertexStart*z$S,(this._vertexStart+this._vertexCount)*z$S):z$p.getData().slice(),z$_=z$s.offset/4;else{z$S=(z$q=z$c.vertexStride/4)+2,z$r=this._vertexCount?new Float32Array(this._vertexCount*(z$p.vertexDeclaration.vertexStride/4+2)):new Float32Array(z$p.vertexCount*(z$p.vertexDeclaration.vertexStride/4+2)),z$_=(z$G=z$c.getVertexElementByUsage(2).offset/4)+2;var z$u=z$p.getData();for(z$t=0,z$b=z$u.length/z$q;z$t<z$b;z$t++){var z$h=0;z$h=0<this._vertexCount?(this._vertexStart+z$t)*z$q:z$t*z$q;var z$l=z$t*z$S,z$W=0;for(z$W=0;z$W<z$_;z$W++)z$r[z$l+z$W]=z$u[z$h+z$W];for(z$W=z$_;z$W<z$q;z$W++)z$r[z$l+z$W+2]=z$u[z$h+z$W]}}else z$S=z$c.vertexStride/4,z$r=this._vertexCount?z$p.getData().slice(this._vertexStart*z$S,(this._vertexStart+this._vertexCount)*z$S):z$p.getData().slice();if(z$V){var z$O=z$V.worldMatrix,z$L=z$H._tempMatrix4x40;z$O.invert(z$L);var z$d=z$H._tempMatrix4x41,z$k=z$U.transform.worldMatrix;z$VU.multiply(z$L,z$k,z$d)}else z$d=z$U.transform.worldMatrix;var z$y=z$H._tempQuaternion0;for(z$d.decomposeTransRotScale(z$H._tempVector30,z$y,z$H._tempVector31),z$t=0,z$b=z$r.length/z$S;z$t<z$b;z$t++){var z$D=z$t*z$S+z$R,z$n=z$t*z$S+z$T;if(z$hU.transformVector3ArrayToVector3ArrayCoordinate(z$r,z$D,z$d,z$r,z$D),z$hU.transformVector3ArrayByQuat(z$r,z$n,z$y,z$r,z$n),z$N){var z$I=z$t*z$S+z$_;if(z$s)z$hU.transformLightingMapTexcoordByUV1Array(z$r,z$I,z$N,z$r,z$I);else{var z$Q=z$t*z$q+z$G;z$hU.transformLightingMapTexcoordByUV0Array(z$u,z$Q,z$N,z$r,z$I)}}}return z$r},z$V._getVertexBuffers=function(){return null},z$V._beforeRender=function(z$V){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},z$V._render=function(z$V){var z$U,z$r=0,z$s=z$V.renderElement;if(1<this._indexCount){var z$p=this._boneIndicesList.length;if(1<z$p){for(var z$c=0;z$c<z$p;z$c++)(z$U=z$s._skinAnimationDatas||this._skinAnimationDatas)&&(z$s._shaderValue.setValue(0,z$U[z$c]),z$V._shader.uploadRenderElementUniforms(z$s._shaderValue.data)),z$w.mainContext.drawElements(4,this._subIndexBufferCount[z$c],5123,2*this._subIndexBufferStart[z$c]);z$D.drawCall+=z$p}else(z$U=z$s._skinAnimationDatas||this._skinAnimationDatas)&&(z$s._shaderValue.setValue(0,z$U[0]),z$V._shader.uploadRenderElementUniforms(z$s._shaderValue.data)),z$w.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),z$D.drawCall++;z$r=this._indexCount}else z$r=this._indexBuffer.indexCount,(z$U=z$s._skinAnimationDatas||this._skinAnimationDatas)&&(z$s._shaderValue.setValue(0,z$U[0]),z$V._shader.uploadRenderElementUniforms(z$s._shaderValue.data)),z$w.mainContext.drawElements(4,z$r,5123,0),z$D.drawCall++;z$D.trianglesFaces+=z$r/3},z$V.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},z$V.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},z$q(0,z$V,"_vertexBufferCount",function(){return 1}),z$q(0,z$V,"triangleCount",function(){return this._indexBuffer.indexCount/3}),z$S(z$H,["_tempVector30",function(){return this._tempVector30=new z$RU},"_tempVector31",function(){return this._tempVector31=new z$RU},"_tempQuaternion0",function(){return this._tempQuaternion0=new z$rU},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new z$VU},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new z$VU}]),z$H}(),z$bU=function(){function z$V(z$V){this.defineCounter=0,this.defines=null,z$V?(this.defineCounter=z$V.defineCounter,this.defines=z$V.defines.slice()):(this.defineCounter=0,this.defines=[])}return z$G(z$V,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),z$V.prototype.registerDefine=function(z$V){var z$U=Math.pow(2,this.defineCounter++);return this.defines[z$U]=z$V,z$U},z$V}(),z$SU=function(){function z$V(){}return z$G(z$V,"laya.d3.shader.ShaderInit3D"),z$V.__init__=function(){var z$V,z$U;z$DU._globalRegDefine("HIGHPRECISION",z$DU.SHADERDEFINE_HIGHPRECISION),z$DU._globalRegDefine("FOG",z$DU.SHADERDEFINE_FOG),z$DU._globalRegDefine("DIRECTIONLIGHT",z$DU.SHADERDEFINE_DIRECTIONLIGHT),z$DU._globalRegDefine("POINTLIGHT",z$DU.SHADERDEFINE_POINTLIGHT),z$DU._globalRegDefine("SPOTLIGHT",z$DU.SHADERDEFINE_SPOTLIGHT),z$DU._globalRegDefine("UV",z$DU.SHADERDEFINE_UV0),z$DU._globalRegDefine("COLOR",z$DU.SHADERDEFINE_COLOR),z$DU._globalRegDefine("UV1",z$DU.SHADERDEFINE_UV1),z$DU._globalRegDefine("CASTSHADOW",z$GU.SHADERDEFINE_CAST_SHADOW),z$DU._globalRegDefine("SHADOWMAP_PSSM1",z$GU.SHADERDEFINE_SHADOW_PSSM1),z$DU._globalRegDefine("SHADOWMAP_PSSM2",z$GU.SHADERDEFINE_SHADOW_PSSM2),z$DU._globalRegDefine("SHADOWMAP_PSSM3",z$GU.SHADERDEFINE_SHADOW_PSSM3),z$DU._globalRegDefine("SHADOWMAP_PCF_NO",z$GU.SHADERDEFINE_SHADOW_PCF_NO),z$DU._globalRegDefine("SHADOWMAP_PCF1",z$GU.SHADERDEFINE_SHADOW_PCF1),z$DU._globalRegDefine("SHADOWMAP_PCF2",z$GU.SHADERDEFINE_SHADOW_PCF2),z$DU._globalRegDefine("SHADOWMAP_PCF3",z$GU.SHADERDEFINE_SHADOW_PCF3),z$DU._globalRegDefine("DEPTHFOG",z$DU.SAHDERDEFINE_DEPTHFOG),z$ZU.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),z$ZU.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),z$V={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},z$U={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var z$r=z$ZU.nameKey.add("SIMPLE");shaderCompile=z$DU.add(z$r,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',z$V,z$U),z$xU.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),z$xU.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),z$xU.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),z$xU.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),z$xU.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),z$xU.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),z$xU.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),z$xU.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),z$xU.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},z$V}(),z$_U=function(){function z$V(){this._data=null,this._data=[]}z$G(z$V,"laya.d3.shader.ValusArray");var z$U=z$V.prototype;return z$U.setValue=function(z$V,z$U){this._data[z$V]=z$U},z$q(0,z$U,"data",function(){return this._data}),z$V}(),z$GU=function(){function z$V(){}return z$V.SHADERDEFINE_RECEIVE_SHADOW=1,z$V.SHADERDEFINE_CAST_SHADOW=512,z$V.SHADERDEFINE_SHADOW_PSSM1=1024,z$V.SHADERDEFINE_SHADOW_PSSM2=2048,z$V.SHADERDEFINE_SHADOW_PSSM3=4096,z$V.SHADERDEFINE_SHADOW_PCF_NO=8192,z$V.SHADERDEFINE_SHADOW_PCF1=16384,z$V.SHADERDEFINE_SHADOW_PCF2=32768,z$V.SHADERDEFINE_SHADOW_PCF3=65536,z$V.MAX_PSSM_COUNT=3,z$V}(),z$qU=function(){function z$e(){}return z$G(z$e,"laya.d3.utils.Picker"),z$e.calculateCursorRay=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$V.elements[0],z$T=z$V.elements[1],z$N=z$e._tempVector30,z$t=z$N.elements;z$t[0]=z$R,z$t[1]=z$T,z$t[2]=z$U.minDepth;var z$b=z$e._tempVector31,z$S=z$b.elements;z$S[0]=z$R,z$S[1]=z$T,z$S[2]=z$U.maxDepth;var z$_=z$c.origin,z$G=z$e._tempVector32;z$U.unprojectFromWVP(z$N,z$r,z$s,z$p,z$_),z$U.unprojectFromWVP(z$b,z$r,z$s,z$p,z$G);var z$q=z$c.direction.elements;z$q[0]=z$G.x-z$_.x,z$q[1]=z$G.y-z$_.y,z$q[2]=z$G.z-z$_.z,z$RU.normalize(z$c.direction,z$c.direction)},z$e.rayIntersectsPositionsAndIndices=function(z$V,z$U,z$r,z$s,z$p){for(var z$c=z$r.vertexStride/4,z$R=z$r.getVertexElementByUsage(0).offset/4,z$T=Number.MAX_VALUE,z$N=-1,z$t=-1,z$b=-1,z$S=0;z$S<z$s.length;z$S+=3){var z$_=z$e._tempVector35,z$G=z$_.elements,z$q=z$s[z$S]*z$c,z$u=z$q+z$R;z$G[0]=z$U[z$u],z$G[1]=z$U[1+z$u],z$G[2]=z$U[2+z$u];var z$h=z$e._tempVector36,z$l=z$h.elements,z$W=z$s[z$S+1]*z$c,z$O=z$W+z$R;z$l[0]=z$U[z$O],z$l[1]=z$U[1+z$O],z$l[2]=z$U[2+z$O];var z$L=z$e._tempVector37,z$d=z$L.elements,z$k=z$s[z$S+2]*z$c,z$y=z$k+z$R;z$d[0]=z$U[z$y],z$d[1]=z$U[1+z$y],z$d[2]=z$U[2+z$y];var z$D=laya.d3.utils.Picker.rayIntersectsTriangle(z$V,z$_,z$h,z$L);!isNaN(z$D)&&z$D<z$T&&(z$T=z$D,z$N=z$q,z$t=z$W,z$b=z$k)}if(z$T===Number.MAX_VALUE)return z$p.position.toDefault(),z$p.distance=Number.MAX_VALUE,z$p.trianglePositions[0].toDefault(),z$p.trianglePositions[1].toDefault(),z$p.trianglePositions[2].toDefault(),z$p.triangleNormals[0].toDefault(),z$p.triangleNormals[1].toDefault(),z$p.triangleNormals[2].toDefault(),!1;z$p.distance=z$T,z$RU.scale(z$V.direction,z$T,z$p.position),z$RU.add(z$V.origin,z$p.position,z$p.position);var z$n=z$p.trianglePositions,z$I=z$n[0],z$Q=z$n[1],z$H=z$n[2],z$w=z$I.elements,z$z=z$Q.elements,z$E=z$H.elements,z$K=z$N+z$R;z$w[0]=z$U[z$K],z$w[1]=z$U[z$K+1],z$w[2]=z$U[z$K+2];var z$m=z$t+z$R;z$z[0]=z$U[z$m],z$z[1]=z$U[z$m+1],z$z[2]=z$U[z$m+2];var z$a=z$b+z$R;z$E[0]=z$U[z$a],z$E[1]=z$U[z$a+1],z$E[2]=z$U[z$a+2];var z$Z=z$r.getVertexElementByUsage(3);if(z$Z){var z$x=z$Z.offset/4,z$$=z$p.triangleNormals,z$j=z$$[0],z$o=z$$[1],z$J=z$$[2],z$i=z$j.elements,z$B=z$o.elements,z$P=z$J.elements,z$M=z$N+z$x;z$i[0]=z$U[z$M],z$i[1]=z$U[z$M+1],z$i[2]=z$U[z$M+2];var z$A=z$t+z$x;z$B[0]=z$U[z$A],z$B[1]=z$U[z$A+1],z$B[2]=z$U[z$A+2];var z$X=z$b+z$x;z$P[0]=z$U[z$X],z$P[1]=z$U[z$X+1],z$P[2]=z$U[z$X+2]}return!0},z$e.rayIntersectsTriangle=function(z$V,z$U,z$r,z$s){var z$p=z$e._tempVector30,z$c=z$e._tempVector31;z$RU.subtract(z$r,z$U,z$p),z$RU.subtract(z$s,z$U,z$c);var z$R,z$T=z$e._tempVector32;if(z$RU.cross(z$V.direction,z$c,z$T),(z$R=z$RU.dot(z$p,z$T))>-Number.MIN_VALUE&&z$R<Number.MIN_VALUE)return Number.NaN;var z$N,z$t=1/z$R,z$b=z$e._tempVector33;if(z$RU.subtract(z$V.origin,z$U,z$b),z$N=z$RU.dot(z$b,z$T),(z$N*=z$t)<0||1<z$N)return Number.NaN;var z$S,z$_,z$G=z$e._tempVector34;return z$RU.cross(z$b,z$p,z$G),z$S=z$RU.dot(z$V.direction,z$G),(z$S*=z$t)<0||1<z$N+z$S?Number.NaN:(z$_=z$RU.dot(z$c,z$G),(z$_*=z$t)<0?Number.NaN:z$_)},z$S(z$e,["_tempVector30",function(){return this._tempVector30=new z$RU},"_tempVector31",function(){return this._tempVector31=new z$RU},"_tempVector32",function(){return this._tempVector32=new z$RU},"_tempVector33",function(){return this._tempVector33=new z$RU},"_tempVector34",function(){return this._tempVector34=new z$RU},"_tempVector35",function(){return this._tempVector35=new z$RU},"_tempVector36",function(){return this._tempVector36=new z$RU},"_tempVector37",function(){return this._tempVector37=new z$RU}]),z$e}(),z$uU=(function(){function z$V(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new z$RU,new z$RU,new z$RU],this.trianglePositions.length=3,this.triangleNormals=[new z$RU,new z$RU,new z$RU],this.triangleNormals.length=3,this.position=new z$RU}z$G(z$V,"laya.d3.utils.RaycastHit"),z$V.prototype.cloneTo=function(z$V){z$V.distance=this.distance,this.trianglePositions[0].cloneTo(z$V.trianglePositions[0]),this.trianglePositions[1].cloneTo(z$V.trianglePositions[1]),this.trianglePositions[2].cloneTo(z$V.trianglePositions[2]),this.triangleNormals[0].cloneTo(z$V.triangleNormals[0]),this.triangleNormals[1].cloneTo(z$V.triangleNormals[1]),this.triangleNormals[2].cloneTo(z$V.triangleNormals[2]),this.position.cloneTo(z$V.position),z$V.sprite3D=this.sprite3D}}(),function(){function z$V(z$V,z$U){this._width=0,this._height=0,this._width=z$V,this._height=z$U}z$G(z$V,"laya.d3.utils.Size");var z$U=z$V.prototype;return z$q(0,z$U,"width",function(){return-1===this._width?z$F.clientWidth:this._width}),z$q(0,z$U,"height",function(){return-1===this._height?z$F.clientHeight:this._height}),z$q(1,z$V,"fullScreen",function(){return new z$V(-1,-1)}),z$V}()),z$hU=function(){function z$K(){}return z$G(z$K,"laya.d3.utils.Utils3D"),z$K._rotationTransformScaleSkinAnimation=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S){var z$_,z$G,z$q,z$u,z$h,z$l=z$K._tempArray16_0,z$W=z$K._tempArray16_1,z$O=z$K._tempArray16_2,z$L=z$s+z$s,z$d=z$p+z$p,z$k=z$c+z$c,z$y=z$s*z$L,z$D=z$p*z$L,z$n=z$p*z$d,z$I=z$c*z$L,z$Q=z$c*z$d,z$H=z$c*z$k,z$w=z$R*z$L,z$z=z$R*z$d,z$E=z$R*z$k;for(z$l[15]=1,z$l[0]=1-z$n-z$H,z$l[1]=z$D+z$E,z$l[2]=z$I-z$z,z$l[4]=z$D-z$E,z$l[5]=1-z$y-z$H,z$l[6]=z$Q+z$w,z$l[8]=z$I+z$z,z$l[9]=z$Q-z$w,z$l[10]=1-z$y-z$n,z$W[15]=1,z$W[0]=z$T,z$W[5]=z$N,z$W[10]=z$t,z$_=0;z$_<4;z$_++)z$G=z$l[z$_],z$q=z$l[z$_+4],z$u=z$l[z$_+8],z$h=z$l[z$_+12],z$O[z$_]=z$G,z$O[z$_+4]=z$q,z$O[z$_+8]=z$u,z$O[z$_+12]=z$G*z$V+z$q*z$U+z$u*z$r+z$h;for(z$_=0;z$_<4;z$_++)z$G=z$O[z$_],z$q=z$O[z$_+4],z$u=z$O[z$_+8],z$h=z$O[z$_+12],z$b[z$_+z$S]=z$G*z$W[0]+z$q*z$W[1]+z$u*z$W[2]+z$h*z$W[3],z$b[z$_+z$S+4]=z$G*z$W[4]+z$q*z$W[5]+z$u*z$W[6]+z$h*z$W[7],z$b[z$_+z$S+8]=z$G*z$W[8]+z$q*z$W[9]+z$u*z$W[10]+z$h*z$W[11],z$b[z$_+z$S+12]=z$G*z$W[12]+z$q*z$W[13]+z$u*z$W[14]+z$h*z$W[15]},z$K._createNodeByJson=function(z$V,z$U,z$r,z$s){if(!z$r)switch(z$U.type){case"Sprite3D":z$r=new z$aU;break;case"MeshSprite3D":z$r=new z$eU;break;case"SkinnedMeshSprite3D":z$r=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":z$r=new ShuriKenParticle3D;break;case"TrailSprite3D":z$r=new TrailSprite3D;break;case"Terrain":z$r=new Terrain;break;case"Camera":z$r=new z$XU;break;case"DirectionLight":z$r=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var z$p=z$U.props;if(z$p)for(var z$c in z$p)z$r[z$c]=z$p[z$c];var z$R=z$U.customProps;z$R&&(z$r instanceof laya.d3.core.Sprite3D?(z$r._parseBaseCustomProps(z$R),z$r._parseCustomProps(z$V,z$s,z$R,z$U),z$r._parseCustomComponent(z$V,z$s,z$U.components)):z$r._parseCustomProps(z$V,z$s,z$R,z$U));var z$T=z$U.child;if(z$T)for(var z$N=0,z$t=z$T.length;z$N<z$t;z$N++){var z$b=z$K._createNodeByJson(z$V,z$T[z$N],null,z$s);z$r.addChild(z$b)}return z$r},z$K._computeBoneAndAnimationDatasByBindPoseMatrxix=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T,z$N=0,z$t=0,z$b=z$V.length;for(z$R=0;z$R<z$b;z$N+=z$V[z$R].keyframeWidth,z$t+=16,z$R++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(z$U[z$N+0],z$U[z$N+1],z$U[z$N+2],z$U[z$N+3],z$U[z$N+4],z$U[z$N+5],z$U[z$N+6],z$U[z$N+7],z$U[z$N+8],z$U[z$N+9],z$s,z$t),0!=z$R&&(z$T=16*z$V[z$R].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(z$s,z$T,z$s,z$t,z$s,z$t));var z$S=z$r.length;for(z$R=0;z$R<z$S;z$R++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(z$s,16*z$c[z$R],z$r[z$R],z$p,16*z$R)},z$K._computeAnimationDatasByArrayAndMatrixFast=function(z$V,z$U,z$r,z$s){for(var z$p=0,z$c=z$V.length;z$p<z$c;z$p++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(z$U,16*z$s[z$p],z$V[z$p],z$r,16*z$p)},z$K._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R,z$T=0,z$N=0,z$t=z$V.length;for(z$c=0;z$c<z$t;z$T+=z$V[z$c].keyframeWidth,z$N+=16,z$c++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(z$U[z$T+7],z$U[z$T+8],z$U[z$T+9],z$U[z$T+3],z$U[z$T+4],z$U[z$T+5],z$U[z$T+6],z$U[z$T+0],z$U[z$T+1],z$U[z$T+2],z$s,z$N),0!=z$c&&(z$R=16*z$V[z$c].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(z$s,z$R,z$s,z$N,z$s,z$N));var z$b=z$r.length;for(z$c=0;z$c<z$b;z$c++){var z$S=16*z$c;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(z$s,z$S,z$r[z$c],z$p,z$S)}},z$K._computeAnimationDatasByArrayAndMatrixFastOld=function(z$V,z$U,z$r){for(var z$s=z$V.length,z$p=0;z$p<z$s;z$p++){var z$c=16*z$p;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(z$U,z$c,z$V[z$p],z$r,z$c)}},z$K._computeRootAnimationData=function(z$V,z$U,z$r){for(var z$s=0,z$p=0,z$c=0,z$R=z$V.length;z$s<z$R;z$p+=z$V[z$s].keyframeWidth,z$c+=16,z$s++)laya.d3.utils.Utils3D.createAffineTransformationArray(z$U[z$p+0],z$U[z$p+1],z$U[z$p+2],z$U[z$p+3],z$U[z$p+4],z$U[z$p+5],z$U[z$p+6],z$U[z$p+7],z$U[z$p+8],z$U[z$p+9],z$r,z$c)},z$K.transformVector3ArrayByQuat=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$r.elements,z$R=z$V[z$U],z$T=z$V[z$U+1],z$N=z$V[z$U+2],z$t=z$c[0],z$b=z$c[1],z$S=z$c[2],z$_=z$c[3],z$G=z$_*z$R+z$b*z$N-z$S*z$T,z$q=z$_*z$T+z$S*z$R-z$t*z$N,z$u=z$_*z$N+z$t*z$T-z$b*z$R,z$h=-z$t*z$R-z$b*z$T-z$S*z$N;z$s[z$p]=z$G*z$_+z$h*-z$t+z$q*-z$S-z$u*-z$b,z$s[z$p+1]=z$q*z$_+z$h*-z$b+z$u*-z$t-z$G*-z$S,z$s[z$p+2]=z$u*z$_+z$h*-z$S+z$G*-z$b-z$q*-z$t},z$K.mulMatrixByArray=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T,z$N,z$t,z$b;if(z$p===z$r){for(z$r=z$K._tempArray16_3,z$R=0;z$R<16;++z$R)z$r[z$R]=z$p[z$c+z$R];z$s=0}for(z$R=0;z$R<4;z$R++)z$T=z$V[z$U+z$R],z$N=z$V[z$U+z$R+4],z$t=z$V[z$U+z$R+8],z$b=z$V[z$U+z$R+12],z$p[z$c+z$R]=z$T*z$r[z$s+0]+z$N*z$r[z$s+1]+z$t*z$r[z$s+2]+z$b*z$r[z$s+3],z$p[z$c+z$R+4]=z$T*z$r[z$s+4]+z$N*z$r[z$s+5]+z$t*z$r[z$s+6]+z$b*z$r[z$s+7],z$p[z$c+z$R+8]=z$T*z$r[z$s+8]+z$N*z$r[z$s+9]+z$t*z$r[z$s+10]+z$b*z$r[z$s+11],z$p[z$c+z$R+12]=z$T*z$r[z$s+12]+z$N*z$r[z$s+13]+z$t*z$r[z$s+14]+z$b*z$r[z$s+15]},z$K.mulMatrixByArrayFast=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T,z$N,z$t,z$b;for(z$R=0;z$R<4;z$R++)z$T=z$V[z$U+z$R],z$N=z$V[z$U+z$R+4],z$t=z$V[z$U+z$R+8],z$b=z$V[z$U+z$R+12],z$p[z$c+z$R]=z$T*z$r[z$s+0]+z$N*z$r[z$s+1]+z$t*z$r[z$s+2]+z$b*z$r[z$s+3],z$p[z$c+z$R+4]=z$T*z$r[z$s+4]+z$N*z$r[z$s+5]+z$t*z$r[z$s+6]+z$b*z$r[z$s+7],z$p[z$c+z$R+8]=z$T*z$r[z$s+8]+z$N*z$r[z$s+9]+z$t*z$r[z$s+10]+z$b*z$r[z$s+11],z$p[z$c+z$R+12]=z$T*z$r[z$s+12]+z$N*z$r[z$s+13]+z$t*z$r[z$s+14]+z$b*z$r[z$s+15]},z$K.mulMatrixByArrayAndMatrixFast=function(z$V,z$U,z$r,z$s,z$p){var z$c,z$R,z$T,z$N,z$t,z$b=z$r.elements,z$S=z$b[0],z$_=z$b[1],z$G=z$b[2],z$q=z$b[3],z$u=z$b[4],z$h=z$b[5],z$l=z$b[6],z$W=z$b[7],z$O=z$b[8],z$L=z$b[9],z$d=z$b[10],z$k=z$b[11],z$y=z$b[12],z$D=z$b[13],z$n=z$b[14],z$I=z$b[15],z$Q=z$U,z$H=z$U+4,z$w=z$U+8,z$z=z$U+12,z$E=z$p,z$K=z$p+4,z$m=z$p+8,z$a=z$p+12;for(z$c=0;z$c<4;z$c++)z$R=z$V[z$Q+z$c],z$T=z$V[z$H+z$c],z$N=z$V[z$w+z$c],z$t=z$V[z$z+z$c],z$s[z$E+z$c]=z$R*z$S+z$T*z$_+z$N*z$G+z$t*z$q,z$s[z$K+z$c]=z$R*z$u+z$T*z$h+z$N*z$l+z$t*z$W,z$s[z$m+z$c]=z$R*z$O+z$T*z$L+z$N*z$d+z$t*z$k,z$s[z$a+z$c]=z$R*z$y+z$T*z$D+z$N*z$n+z$t*z$I},z$K.createAffineTransformationArray=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S){var z$_=z$s+z$s,z$G=z$p+z$p,z$q=z$c+z$c,z$u=z$s*z$_,z$h=z$s*z$G,z$l=z$s*z$q,z$W=z$p*z$G,z$O=z$p*z$q,z$L=z$c*z$q,z$d=z$R*z$_,z$k=z$R*z$G,z$y=z$R*z$q;z$b[z$S+0]=(1-(z$W+z$L))*z$T,z$b[z$S+1]=(z$h+z$y)*z$T,z$b[z$S+2]=(z$l-z$k)*z$T,z$b[z$S+3]=0,z$b[z$S+4]=(z$h-z$y)*z$N,z$b[z$S+5]=(1-(z$u+z$L))*z$N,z$b[z$S+6]=(z$O+z$d)*z$N,z$b[z$S+7]=0,z$b[z$S+8]=(z$l+z$k)*z$t,z$b[z$S+9]=(z$O-z$d)*z$t,z$b[z$S+10]=(1-(z$u+z$W))*z$t,z$b[z$S+11]=0,z$b[z$S+12]=z$V,z$b[z$S+13]=z$U,z$b[z$S+14]=z$r,z$b[z$S+15]=1},z$K.transformVector3ArrayToVector3ArrayCoordinate=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$K._tempArray4_0,z$R=z$V[z$U+0],z$T=z$V[z$U+1],z$N=z$V[z$U+2],z$t=z$r.elements;z$c[0]=z$R*z$t[0]+z$T*z$t[4]+z$N*z$t[8]+z$t[12],z$c[1]=z$R*z$t[1]+z$T*z$t[5]+z$N*z$t[9]+z$t[13],z$c[2]=z$R*z$t[2]+z$T*z$t[6]+z$N*z$t[10]+z$t[14],z$c[3]=1/(z$R*z$t[3]+z$T*z$t[7]+z$N*z$t[11]+z$t[15]),z$s[z$p+0]=z$c[0]*z$c[3],z$s[z$p+1]=z$c[1]*z$c[3],z$s[z$p+2]=z$c[2]*z$c[3]},z$K.transformLightingMapTexcoordByUV0Array=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$r.elements;z$s[z$p+0]=z$V[z$U+0]*z$c[0]+z$c[2],z$s[z$p+1]=(z$V[z$U+1]-1)*z$c[1]+z$c[3]},z$K.transformLightingMapTexcoordByUV1Array=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$r.elements;z$s[z$p+0]=z$V[z$U+0]*z$c[0]+z$c[2],z$s[z$p+1]=1+z$V[z$U+1]*z$c[1]+z$c[3]},z$K.getURLVerion=function(z$V){var z$U=z$V.indexOf("?");return 0<=z$U?z$V.substr(z$U):null},z$K._quaternionCreateFromYawPitchRollArray=function(z$V,z$U,z$r,z$s){var z$p=.5*z$r,z$c=.5*z$U,z$R=.5*z$V,z$T=Math.sin(z$p),z$N=Math.cos(z$p),z$t=Math.sin(z$c),z$b=Math.cos(z$c),z$S=Math.sin(z$R),z$_=Math.cos(z$R);z$s[0]=z$_*z$t*z$N+z$S*z$b*z$T,z$s[1]=z$S*z$b*z$N-z$_*z$t*z$T,z$s[2]=z$_*z$b*z$T-z$S*z$t*z$N,z$s[3]=z$_*z$b*z$N+z$S*z$t*z$T},z$K._createAffineTransformationArray=function(z$V,z$U,z$r,z$s){var z$p=z$U[0],z$c=z$U[1],z$R=z$U[2],z$T=z$U[3],z$N=z$p+z$p,z$t=z$c+z$c,z$b=z$R+z$R,z$S=z$p*z$N,z$_=z$p*z$t,z$G=z$p*z$b,z$q=z$c*z$t,z$u=z$c*z$b,z$h=z$R*z$b,z$l=z$T*z$N,z$W=z$T*z$t,z$O=z$T*z$b,z$L=z$r[0],z$d=z$r[1],z$k=z$r[2];z$s[0]=(1-(z$q+z$h))*z$L,z$s[1]=(z$_+z$O)*z$L,z$s[2]=(z$G-z$W)*z$L,z$s[3]=0,z$s[4]=(z$_-z$O)*z$d,z$s[5]=(1-(z$S+z$h))*z$d,z$s[6]=(z$u+z$l)*z$d,z$s[7]=0,z$s[8]=(z$G+z$W)*z$k,z$s[9]=(z$u-z$l)*z$k,z$s[10]=(1-(z$S+z$q))*z$k,z$s[11]=0,z$s[12]=z$V[0],z$s[13]=z$V[1],z$s[14]=z$V[2],z$s[15]=1},z$K._mulMatrixArray=function(z$V,z$U,z$r,z$s){var z$p,z$c,z$R,z$T,z$N,z$t=z$U.elements,z$b=z$t[0],z$S=z$t[1],z$_=z$t[2],z$G=z$t[3],z$q=z$t[4],z$u=z$t[5],z$h=z$t[6],z$l=z$t[7],z$W=z$t[8],z$O=z$t[9],z$L=z$t[10],z$d=z$t[11],z$k=z$t[12],z$y=z$t[13],z$D=z$t[14],z$n=z$t[15],z$I=z$s,z$Q=z$s+4,z$H=z$s+8,z$w=z$s+12;for(z$p=0;z$p<4;z$p++)z$c=z$V[z$p],z$R=z$V[z$p+4],z$T=z$V[z$p+8],z$N=z$V[z$p+12],z$r[z$I+z$p]=z$c*z$b+z$R*z$S+z$T*z$_+z$N*z$G,z$r[z$Q+z$p]=z$c*z$q+z$R*z$u+z$T*z$h+z$N*z$l,z$r[z$H+z$p]=z$c*z$W+z$R*z$O+z$T*z$L+z$N*z$d,z$r[z$w+z$p]=z$c*z$k+z$R*z$y+z$T*z$D+z$N*z$n},z$K.getYawPitchRoll=function(z$V,z$U){z$K.transformQuat(z$RU.ForwardRH,z$V,z$rU.TEMPVector31),z$K.transformQuat(z$RU.Up,z$V,z$rU.TEMPVector32);var z$r=z$rU.TEMPVector32.elements;z$K.angleTo(z$RU.ZERO,z$rU.TEMPVector31,z$rU.TEMPVector33);var z$s=z$rU.TEMPVector33.elements;z$s[0]==Math.PI/2?(z$s[1]=z$K.arcTanAngle(z$r[2],z$r[0]),z$s[2]=0):z$s[0]==-Math.PI/2?(z$s[1]=z$K.arcTanAngle(-z$r[2],-z$r[0]),z$s[2]=0):(z$VU.createRotationY(-z$s[1],z$rU.TEMPMatrix0),z$VU.createRotationX(-z$s[0],z$rU.TEMPMatrix1),z$RU.transformCoordinate(z$rU.TEMPVector32,z$rU.TEMPMatrix0,z$rU.TEMPVector32),z$RU.transformCoordinate(z$rU.TEMPVector32,z$rU.TEMPMatrix1,z$rU.TEMPVector32),z$s[2]=z$K.arcTanAngle(z$r[1],-z$r[0])),z$s[1]<=-Math.PI&&(z$s[1]=Math.PI),z$s[2]<=-Math.PI&&(z$s[2]=Math.PI),z$s[1]>=Math.PI&&z$s[2]>=Math.PI&&(z$s[1]=0,z$s[2]=0,z$s[0]=Math.PI-z$s[0]),z$U[0]=z$s[1],z$U[1]=z$s[0],z$U[2]=z$s[2]},z$K.arcTanAngle=function(z$V,z$U){return 0==z$V?1==z$U?Math.PI/2:-Math.PI/2:0<z$V?Math.atan(z$U/z$V):z$V<0?0<z$U?Math.atan(z$U/z$V)+Math.PI:Math.atan(z$U/z$V)-Math.PI:0},z$K.angleTo=function(z$V,z$U,z$r){z$RU.subtract(z$U,z$V,z$rU.TEMPVector30),z$RU.normalize(z$rU.TEMPVector30,z$rU.TEMPVector30),z$r.elements[0]=Math.asin(z$rU.TEMPVector30.y),z$r.elements[1]=z$K.arcTanAngle(-z$rU.TEMPVector30.z,-z$rU.TEMPVector30.x)},z$K.transformQuat=function(z$V,z$U,z$r){var z$s=z$r.elements,z$p=z$V.elements,z$c=z$U,z$R=z$p[0],z$T=z$p[1],z$N=z$p[2],z$t=z$c[0],z$b=z$c[1],z$S=z$c[2],z$_=z$c[3],z$G=z$_*z$R+z$b*z$N-z$S*z$T,z$q=z$_*z$T+z$S*z$R-z$t*z$N,z$u=z$_*z$N+z$t*z$T-z$b*z$R,z$h=-z$t*z$R-z$b*z$T-z$S*z$N;z$s[0]=z$G*z$_+z$h*-z$t+z$q*-z$S-z$u*-z$b,z$s[1]=z$q*z$_+z$h*-z$b+z$u*-z$t-z$G*-z$S,z$s[2]=z$u*z$_+z$h*-z$S+z$G*-z$b-z$q*-z$t},z$K.quaterionNormalize=function(z$V,z$U){var z$r=z$V[0],z$s=z$V[1],z$p=z$V[2],z$c=z$V[3],z$R=z$r*z$r+z$s*z$s+z$p*z$p+z$c*z$c;0<z$R&&(z$R=1/Math.sqrt(z$R),z$U[0]=z$r*z$R,z$U[1]=z$s*z$R,z$U[2]=z$p*z$R,z$U[3]=z$c*z$R)},z$K.matrix4x4MultiplyFFF=function(z$V,z$U,z$r){var z$s,z$p,z$c,z$R,z$T;if(z$r===z$U)for(z$U=new Float32Array(16),z$s=0;z$s<16;++z$s)z$U[z$s]=z$r[z$s];for(z$s=0;z$s<4;z$s++)z$p=z$V[z$s],z$c=z$V[z$s+4],z$R=z$V[z$s+8],z$T=z$V[z$s+12],z$r[z$s]=z$p*z$U[0]+z$c*z$U[1]+z$R*z$U[2]+z$T*z$U[3],z$r[z$s+4]=z$p*z$U[4]+z$c*z$U[5]+z$R*z$U[6]+z$T*z$U[7],z$r[z$s+8]=z$p*z$U[8]+z$c*z$U[9]+z$R*z$U[10]+z$T*z$U[11],z$r[z$s+12]=z$p*z$U[12]+z$c*z$U[13]+z$R*z$U[14]+z$T*z$U[15]},z$K.matrix4x4MultiplyMFM=function(z$V,z$U,z$r){z$K.matrix4x4MultiplyFFF(z$V.elements,z$U,z$r.elements)},z$S(z$K,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new z$RU},"_tempVector3_1",function(){return this._tempVector3_1=new z$RU},"_tempVector3_2",function(){return this._tempVector3_2=new z$RU},"_tempVector3_3",function(){return this._tempVector3_3=new z$RU},"_tempVector3_4",function(){return this._tempVector3_4=new z$RU},"_tempVector3_5",function(){return this._tempVector3_5=new z$RU},"_tempVector3_6",function(){return this._tempVector3_6=new z$RU},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),z$K}(),z$lU=function(){function z$z(){}return z$G(z$z,"Laya3D"),z$z._cancelLoadByUrl=function(z$V){z$d.loader.cancelLoadByUrl(z$V),z$z._innerFirstLevelLoaderManager.cancelLoadByUrl(z$V),z$z._innerSecondLevelLoaderManager.cancelLoadByUrl(z$V),z$z._innerThirdLevelLoaderManager.cancelLoadByUrl(z$V),z$z._innerFourthLevelLoaderManager.cancelLoadByUrl(z$V)},z$z._changeWebGLSize=function(z$V,z$U){z$w.onStageResize(z$V,z$U),z$F.clientWidth=z$V,z$F.clientHeight=z$U},z$z.__init__=function(){var z$V=z$U.createMap;z$V.lh=[z$aU,"SPRITE3DHIERARCHY"],z$V.ls=[z$mU,"SPRITE3DHIERARCHY"],z$V.lm=[z$iU,"MESH"],z$V.lmat=[z$xU,"MATERIAL"],z$V.jpg=[z$PU,"nativeimage"],z$V.jpeg=[z$PU,"nativeimage"],z$V.png=[z$PU,"nativeimage"],z$V.pkm=[z$PU,"arraybuffer"],z$V.raw=[z$oU,"arraybuffer"],z$V.mipmaps=[z$oU,"arraybuffer"],z$l.parserMap.SPRITE3DHIERARCHY=z$z._loadHierarchy,z$l.parserMap.MESH=z$z._loadMesh,z$l.parserMap.MATERIAL=z$z._loadMaterial,z$l.parserMap.TEXTURECUBE=z$z._loadTextureCube,z$l.parserMap.TERRAIN=z$z._loadTerrain,z$z._innerFirstLevelLoaderManager.on("error",null,z$z._eventLoadManagerError),z$z._innerSecondLevelLoaderManager.on("error",null,z$z._eventLoadManagerError),z$z._innerThirdLevelLoaderManager.on("error",null,z$z._eventLoadManagerError),z$z._innerFourthLevelLoaderManager.on("error",null,z$z._eventLoadManagerError)},z$z.READ_BLOCK=function(){return z$z._readData.pos+=4,!0},z$z.READ_DATA=function(){return z$z._DATA.offset=z$z._readData.getUint32(),z$z._DATA.size=z$z._readData.getUint32(),!0},z$z.READ_STRINGS=function(){var z$V=[],z$U={offset:0,size:0};z$U.offset=z$z._readData.getUint16(),z$U.size=z$z._readData.getUint16();z$z._readData.pos;z$z._readData.pos=z$U.offset+z$z._DATA.offset;for(var z$r=0;z$r<z$U.size;z$r++){var z$s=z$z._readData.readUTFString();-1===z$s.lastIndexOf(".lmat")&&-1===z$s.lastIndexOf(".lpbr")||z$V.push(z$s)}return z$V},z$z.formatRelativePath=function(z$V,z$U){var z$r;if("."===z$U.charAt(0)){for(var z$s=(z$V+z$U).split("/"),z$p=0,z$c=z$s.length;z$p<z$c;z$p++)if(".."==z$s[z$p]){var z$R=z$p-1;0<z$R&&".."!==z$s[z$R]&&(z$s.splice(z$R,2),z$p-=2)}z$r=z$s.join("/")}else z$r=z$V+z$U;return null!=z$H.customFormat&&(z$r=z$H.customFormat(z$r,null)),z$r},z$z._eventLoadManagerError=function(z$V){z$d.loader.event("error",z$V)},z$z._addHierarchyInnerUrls=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R=z$z.formatRelativePath(z$s,z$p);z$r&&(z$R+=z$r),z$V.push({url:z$R,clas:z$c}),z$U[z$p]=z$R},z$z._getSprite3DHierarchyInnerUrls=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){var z$T,z$N=0,z$t=0;switch(z$V.type){case"Scene":var z$b=z$V.customProps.lightmaps;for(z$N=0,z$t=z$b.length;z$N<z$t;z$N++){var z$S=z$b[z$N].replace(".exr",".png");z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$S,z$PU)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var z$_;if(z$V.instanceParams)(z$_=z$V.instanceParams.loadPath)&&z$z._addHierarchyInnerUrls(z$U,z$p,z$c,z$R,z$_,z$iU);else{(z$_=(z$T=z$V.customProps).meshPath)&&z$z._addHierarchyInnerUrls(z$U,z$p,z$c,z$R,z$_,z$iU);var z$G=z$T.materials;if(z$G)for(z$N=0,z$t=z$G.length;z$N<z$t;z$N++){for(var z$q=z$G[z$N],z$u=z$q.type.split("."),z$h=z$E.window,z$l=0,z$W=z$u.length;z$l<z$W;++z$l){z$h=z$h[this.clasPaths[z$l]]}if("function"!=typeof z$h)throw"_getSprite3DHierarchyInnerUrls 错误: "+z$q.type+" 不是类";z$z._addHierarchyInnerUrls(z$r,z$p,z$c,z$R,z$q.path,z$h)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var z$O=(z$T=z$V.customProps).meshPath;z$O&&z$z._addHierarchyInnerUrls(z$U,z$p,z$c,z$R,z$O,z$iU);var z$L=z$T.material;if(z$L){z$u=z$L.type.split("."),z$h=z$E.window;for(z$l=0,z$W=z$u.length;z$l<z$W;++z$l){z$h=z$h[this.clasPaths[z$l]]}z$z._addHierarchyInnerUrls(z$r,z$p,z$c,z$R,z$L.path,z$h)}else{var z$d=z$T.materialPath;if(z$d)z$z._addHierarchyInnerUrls(z$r,z$p,z$c,z$R,z$d,ShurikenParticleMaterial);else{var z$k=z$T.texturePath;z$k&&z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$k,z$PU)}}break;case"Terrain":z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$V.customProps.dataPath,TerrainRes)}var z$y=z$V.components;for(var z$D in z$y){var z$n=z$y[z$D];switch(z$D){case"Animator":var z$I=z$n.avatarPath;if(z$I)z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$I,Avatar);else{var z$Q=z$n.avatar;z$Q&&z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$Q.path,Avatar)}var z$H=z$n.clipPaths;for(z$N=0,z$t=z$H.length;z$N<z$t;z$N++)z$z._addHierarchyInnerUrls(z$s,z$p,z$c,z$R,z$H[z$N],AnimationClip)}}var z$w=z$V.child;for(z$N=0,z$t=z$w.length;z$N<z$t;z$N++)z$z._getSprite3DHierarchyInnerUrls(z$w[z$N],z$U,z$r,z$s,z$p,z$c,z$R)},z$z._loadHierarchy=function(z$V){z$V.on("loaded",null,z$z._onHierarchylhLoaded,[z$V,z$V._class._getGroup()]),z$V.load(z$V.url,"json",!1,null,!0)},z$z._onHierarchylhLoaded=function(z$V,z$U,z$r){if(z$V._class.destroyed)z$V.endLoad();else{var z$s=z$V.url,z$p=z$hU.getURLVerion(z$s),z$c=z$H.getPath(z$s),z$R=[],z$T=[],z$N=[],z$t={};z$z._getSprite3DHierarchyInnerUrls(z$r,z$R,z$T,z$N,z$t,z$p,z$c);var z$b=z$R.length+z$T.length+z$N.length,z$S=z$b+1,z$_=1/z$S;if(z$z._onProcessChange(z$V,0,z$_,1),0<z$N.length){var z$G=z$b/z$S,z$q=z$Q.create(null,z$z._onProcessChange,[z$V,z$_,z$G],!1);z$z._innerFourthLevelLoaderManager.create(z$N,z$Q.create(null,z$z._onHierarchyInnerForthLevResouLoaded,[z$V,z$U,z$q,z$r,z$t,z$R,z$T,z$_+z$G*z$N.length,z$G]),z$q,null,null,1,!0,z$U)}else z$z._onHierarchyInnerForthLevResouLoaded(z$V,z$U,null,z$r,z$t,z$R,z$T,z$_,z$G)}},z$z._onHierarchyInnerForthLevResouLoaded=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){if(z$V._class.destroyed)z$V.endLoad();else if(z$r&&z$r.recover(),0<z$R.length){var z$t=z$Q.create(null,z$z._onProcessChange,[z$V,z$T,z$N],!1);z$z._innerSecondLevelLoaderManager.create(z$R,z$Q.create(null,z$z._onHierarchyInnerSecondLevResouLoaded,[z$V,z$U,z$t,z$s,z$p,z$c,z$T+z$N*z$R.length,z$N]),z$r,null,null,1,!0,z$U)}else z$z._onHierarchyInnerSecondLevResouLoaded(z$V,z$U,null,z$s,z$p,z$c,z$T,z$N)},z$z._onHierarchyInnerSecondLevResouLoaded=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T){if(z$V._class.destroyed)z$V.endLoad();else if(z$r&&z$r.recover(),0<z$c.length){var z$N=z$Q.create(null,z$z._onProcessChange,[z$V,z$R,z$T],!1);z$z._innerFirstLevelLoaderManager.create(z$c,z$Q.create(null,z$z._onHierarchyInnerFirstLevResouLoaded,[z$V,z$N,z$s,z$p]),z$r,null,null,1,!0,z$U)}else z$z._onHierarchyInnerFirstLevResouLoaded(z$V,null,z$s,z$p)},z$z._onHierarchyInnerFirstLevResouLoaded=function(z$V,z$U,z$r,z$s){z$U&&z$U.recover(),z$V.endLoad([z$r,z$s])},z$z._loadTerrain=function(z$V){z$V.on("loaded",null,z$z._onTerrainLtLoaded,[z$V,z$V._class._getGroup()]),z$V.load(z$V.url,"json",!1,null,!0)},z$z._onTerrainLtLoaded=function(z$V,z$U,z$r){if(z$V._class.destroyed)z$V.endLoad();else{var z$s,z$p,z$c=z$V.url,z$R=z$hU.getURLVerion(z$c),z$T=z$H.getPath(z$c),z$N=[],z$t={},z$b=0,z$S=0,z$_=z$r.heightData;z$s=z$_.url,z$p=z$z.formatRelativePath(z$T,z$s),z$R&&(z$p+=z$R),z$s=z$t[z$s]=z$p;var z$G=z$r.detailTexture;for(z$b=0,z$S=z$G.length;z$b<z$S;z$b++)z$N.push({url:z$G[z$b].diffuse});var z$q=z$r.normalMap;for(z$b=0,z$S=z$q.length;z$b<z$S;z$b++)z$N.push({url:z$q[z$b]});var z$u=z$r.alphaMap;for(z$b=0,z$S=z$u.length;z$b<z$S;z$b++)z$N.push({url:z$u[z$b],params:[!1,!1,6408,!0]});for(z$b=0,z$S=z$N.length;z$b<z$S;z$b++){var z$h=z$N[z$b].url;z$p=z$z.formatRelativePath(z$T,z$h),z$R&&(z$p+=z$R),z$N[z$b].url=z$p,z$t[z$h]=z$p}var z$l=z$N.length,z$W=z$l+2,z$O=1/z$W;z$z._onProcessChange(z$V,0,z$O,1);var z$L={heightMapLoaded:!1,texturesLoaded:!1},z$d=z$Q.create(null,z$z._onProcessChange,[z$V,z$O,z$O],!1);z$z._innerFourthLevelLoaderManager.create(z$s,z$Q.create(null,z$z._onTerrainHeightMapLoaded,[z$V,z$d,z$r,z$t,z$L]),z$d,null,[z$_.numX,z$_.numZ,z$_.bitType,z$_.value],1,!0,z$U);var z$k=z$Q.create(null,z$z._onProcessChange,[z$V,2*z$O,z$l/z$W],!1);z$z._innerFourthLevelLoaderManager.create(z$N,z$Q.create(null,z$z._onTerrainTexturesLoaded,[z$V,z$k,z$r,z$t,z$L]),z$k,null,null,1,!0,z$U)}},z$z._onTerrainHeightMapLoaded=function(z$V,z$U,z$r,z$s,z$p){z$p.heightMapLoaded=!0,z$p.texturesLoaded&&(z$V.endLoad([z$r,z$s]),z$U.recover())},z$z._onTerrainTexturesLoaded=function(z$V,z$U,z$r,z$s,z$p){z$p.texturesLoaded=!0,z$p.heightMapLoaded&&(z$V.endLoad([z$r,z$s]),z$U.recover())},z$z._loadMesh=function(z$V){z$V.on("loaded",null,z$z._onMeshLmLoaded,[z$V,z$V._class._getGroup()]),z$V.load(z$V.url,"arraybuffer",!1,null,!0)},z$z._onMeshLmLoaded=function(z$V,z$U,z$r){if(z$V._class.destroyed)z$V.endLoad();else{var z$s,z$p,z$c,z$R=z$V.url,z$T=z$hU.getURLVerion(z$R),z$N=z$H.getPath(z$R),z$t={},z$b=0,z$S=0;switch((z$z._readData=new z$k(z$r)).pos=0,z$z._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var z$_=z$z._readData.getUint32();z$z._readData.pos=z$z._readData.pos+4,z$S=z$z._readData.getUint16(),z$z._readData.pos=z$z._readData.pos+8*z$S;var z$G=z$z._readData.getUint32();for(z$S=z$z._readData.getUint16(),z$z._readData.pos=z$_+z$G,z$s=[],z$b=0;z$b<z$S;z$b++){var z$q=z$z._readData.readUTFString();-1!==z$q.lastIndexOf(".lmat")&&z$s.push(z$q)}break;default:for(z$z.READ_BLOCK(),z$b=0;z$b<2;z$b++){var z$u=z$z._readData.getUint16(),z$h=z$z._strings[z$u],z$l=z$z["READ_"+z$h];if(null==z$l)throw new Error("model file err,no this function:"+z$u+" "+z$h);1===z$b?z$s=z$l.call():z$l.call()}}for(z$b=0,z$c=z$s.length;z$b<z$c;z$b++){var z$W=z$s[z$b];z$p=z$z.formatRelativePath(z$N,z$W),z$T&&(z$p+=z$T),z$s[z$b]=z$p,z$t[z$W]=z$p}if(0<z$s.length){z$z._onProcessChange(z$V,0,.5,1);var z$O=z$Q.create(null,z$z._onProcessChange,[z$V,.5,.5],!1);z$z._innerSecondLevelLoaderManager.create(z$s,z$Q.create(null,z$z._onMeshMateialLoaded,[z$V,z$O,z$r,z$t]),z$O,null,null,1,!0,z$U)}else z$V.endLoad([z$r,z$t])}},z$z._onMeshMateialLoaded=function(z$V,z$U,z$r,z$s){z$V.endLoad([z$r,z$s]),z$U.recover()},z$z._getMaterialTexturePath=function(z$V,z$U,z$r){var z$s=z$V.length-4;return z$V.indexOf(".dds")!=z$s&&z$V.indexOf(".tga")!=z$s&&z$V.indexOf(".exr")!=z$s&&z$V.indexOf(".DDS")!=z$s&&z$V.indexOf(".TGA")!=z$s&&z$V.indexOf(".EXR")!=z$s||(z$V=z$V.substr(0,z$s)+".png"),z$V=z$z.formatRelativePath(z$r,z$V),z$U&&(z$V+=z$U),z$V},z$z._loadMaterial=function(z$V){z$V.on("loaded",null,z$z._onMaterilLmatLoaded,[z$V,z$V._class._getGroup()]),z$V.load(z$V.url,"json",!1,null,!0)},z$z._onMaterilLmatLoaded=function(z$V,z$U,z$r){if(z$V._class.destroyed)z$V.endLoad();else{var z$s,z$p=z$V.url,z$c=z$hU.getURLVerion(z$p),z$R=z$H.getPath(z$p),z$T=[],z$N={},z$t=z$r.customProps,z$b=z$r.version;if(z$b)switch(z$b){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var z$S=z$r.props.textures,z$_=0,z$G=z$S.length;z$_<z$G;z$_++){var z$q=z$S[z$_],z$u=z$q.path;if(z$u){var z$h=z$u.length-4;z$u.indexOf(".exr")!=z$h&&z$u.indexOf(".EXR")!=z$h||(z$u=z$u.substr(0,z$h)+".png"),z$s=z$z.formatRelativePath(z$R,z$u),z$c&&(z$s+=z$c),z$T.push({url:z$s,params:z$q.params}),z$N[z$u]=z$s}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var z$l=z$t.diffuseTexture.texture2D;if(z$l&&(z$s=z$z._getMaterialTexturePath(z$l,z$c,z$R),z$T.push(z$s),z$N[z$l]=z$s),z$t.normalTexture){var z$W=z$t.normalTexture.texture2D;z$W&&(z$s=z$z._getMaterialTexturePath(z$W,z$c,z$R),z$T.push(z$s),z$N[z$W]=z$s)}if(z$t.specularTexture){var z$O=z$t.specularTexture.texture2D;z$O&&(z$s=z$z._getMaterialTexturePath(z$O,z$c,z$R),z$T.push(z$s),z$N[z$O]=z$s)}if(z$t.emissiveTexture){var z$L=z$t.emissiveTexture.texture2D;z$L&&(z$s=z$z._getMaterialTexturePath(z$L,z$c,z$R),z$T.push(z$s),z$N[z$L]=z$s)}if(z$t.ambientTexture){var z$d=z$t.ambientTexture.texture2D;z$d&&(z$s=z$z._getMaterialTexturePath(z$d,z$c,z$R),z$T.push(z$s),z$N[z$d]=z$s)}if(z$t.reflectTexture){var z$k=z$t.reflectTexture.texture2D;z$k&&(z$s=z$z._getMaterialTexturePath(z$k,z$c,z$R),z$T.push(z$s),z$N[z$k]=z$s)}}var z$y=z$T.length,z$D=z$y+1,z$n=1/z$D;if(z$z._onProcessChange(z$V,0,z$n,1),0<z$y){var z$I=z$Q.create(null,z$z._onProcessChange,[z$V,z$n,z$y/z$D],!1);z$z._innerFourthLevelLoaderManager.create(z$T,z$Q.create(null,z$z._onMateialTexturesLoaded,[z$V,z$I,z$r,z$N]),z$I,z$PU,null,1,!0,z$U)}else z$z._onMateialTexturesLoaded(z$V,null,z$r,null)}},z$z._onMateialTexturesLoaded=function(z$V,z$U,z$r,z$s){z$V.endLoad([z$r,z$s]),z$U&&z$U.recover()},z$z._loadTextureCube=function(z$V){z$V.on("loaded",null,z$z._onTextureCubeLtcLoaded,[z$V]),z$V.load(z$V.url,"json",!1,null,!0)},z$z._onTextureCubeLtcLoaded=function(z$V,z$U){if(z$V._class.destroyed)z$V.endLoad();else{var z$r=z$H.getPath(z$V.url),z$s=[z$z.formatRelativePath(z$r,z$U.px),z$z.formatRelativePath(z$r,z$U.nx),z$z.formatRelativePath(z$r,z$U.py),z$z.formatRelativePath(z$r,z$U.ny),z$z.formatRelativePath(z$r,z$U.pz),z$z.formatRelativePath(z$r,z$U.nz)];z$z._onProcessChange(z$V,0,1/7,1);var z$p=z$Q.create(null,z$z._onProcessChange,[z$V,1/7,6/7],!1);z$z._innerFourthLevelLoaderManager.load(z$s,z$Q.create(null,z$z._onTextureCubeImagesLoaded,[z$V,z$s,z$p]),z$p,"nativeimage")}},z$z._onTextureCubeImagesLoaded=function(z$V,z$U,z$r){var z$s=[];z$s.length=6;for(var z$p=0;z$p<6;z$p++){var z$c=z$U[z$p];z$s[z$p]=z$l.getRes(z$c),z$l.clearRes(z$c)}z$V.endLoad(z$s),z$r.recover()},z$z._onProcessChange=function(z$V,z$U,z$r,z$s){(z$s=z$U+z$s*z$r)<1&&z$V.event("progress",z$s)},z$z.init=function(z$V,z$U,z$r,z$s,z$p,z$c){if(void 0===z$r&&(z$r=!1),void 0===z$s&&(z$s=!1),void 0===z$p&&(z$p=!0),void 0===z$c&&(z$c=!0),z$W.update3DLoop=function(){},z$W.cancelLoadByUrl=function(z$V){z$z._cancelLoadByUrl(z$V)},z$N.isAntialias=z$r,z$N.isAlpha=z$s,z$N.premultipliedAlpha=z$p,z$N.isStencil=z$c,!z$w.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");z$W.changeWebGLSize=z$z._changeWebGLSize,z$u.is3DMode=!0,z$d.init(z$V,z$U),z$K.__init__(),z$SU.__init__(),z$eU.__init__(),z$J.__init__(),z$z.__init__(),z$R.maxTextureCount=2,(z$z.debugMode||z$g.debugMode)&&(z$z._debugPhasorSprite=new z$A)},z$z.HIERARCHY="SPRITE3DHIERARCHY",z$z.MESH="MESH",z$z.MATERIAL="MATERIAL",z$z.PBRMATERIAL="PBRMTL",z$z.TEXTURECUBE="TEXTURECUBE",z$z.TERRAIN="TERRAIN",z$z._readData=null,z$z._debugPhasorSprite=null,z$z.debugMode=!1,z$S(z$z,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new z$U},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new z$U},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new z$U},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new z$U}]),z$z}(),z$WU=function(z$V){function z$p(z$V){z$p.__super.call(this),this._owner=z$V,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}z$G(z$p,"laya.d3.animation.AnimationTransform3D",z$c);var z$U=z$p.prototype;return z$U._getlocalMatrix=function(){return this._localUpdate&&(z$hU._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},z$U._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldTransform()}},z$U._setWorldMatrixAndUpdate=function(z$V){if(this._worldMatrix=z$V,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var z$U=this._getlocalMatrix(),z$r=0;z$r<16;++z$r)this._worldMatrix[z$r]=z$U[z$r];else z$hU.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},z$U._setWorldMatrixNoUpdate=function(z$V){this._worldMatrix=z$V},z$U._setWorldMatrixIgnoreUpdate=function(z$V){this._worldMatrix=z$V,this._worldUpdate=!1},z$U.getLocalPosition=function(){return this._localPosition},z$U.setLocalPosition=function(z$V){if(this._parent)this._localPosition=z$V,this._localUpdate=!0,this._onWorldTransform();else{var z$U=this._entity.owner._transform,z$r=this._entity.localPosition,z$s=z$r.elements;z$s[0]=z$V[0],z$s[1]=z$V[1],z$s[2]=z$V[2],z$U.localPosition=z$r}},z$U.getLocalRotation=function(){if(this._localQuaternionUpdate){var z$V=this._localRotationEuler;z$hU._quaternionCreateFromYawPitchRollArray(z$V[1]/z$p._angleToRandin,z$V[0]/z$p._angleToRandin,z$V[2]/z$p._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},z$U.setLocalRotation=function(z$V){if(this._parent)this._localRotation=z$V,z$hU.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var z$U=this._entity.owner._transform,z$r=this._entity.localRotation,z$s=z$r.elements;z$s[0]=z$V[0],z$s[1]=z$V[1],z$s[2]=z$V[2],z$s[3]=z$V[3],z$U.localRotation=z$r}},z$U.getLocalScale=function(){return this._localScale},z$U.setLocalScale=function(z$V){if(this._parent)this._localScale=z$V,this._localUpdate=!0,this._onWorldTransform();else{var z$U=this._entity.owner._transform,z$r=this._entity.localScale,z$s=z$r.elements;z$s[0]=z$V[0],z$s[1]=z$V[1],z$s[2]=z$V[2],z$U.localScale=z$r}},z$U.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){z$hU.getYawPitchRoll(this._localRotation,z$p._tempVector3);var z$V=z$p._tempVector3,z$U=this._localRotationEuler;z$U[0]=z$V[1]*z$p._angleToRandin,z$U[1]=z$V[0]*z$p._angleToRandin,z$U[2]=z$V[2]*z$p._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},z$U.setLocalRotationEuler=function(z$V){if(this._parent)z$hU._quaternionCreateFromYawPitchRollArray(z$V[1]/z$p._angleToRandin,z$V[0]/z$p._angleToRandin,z$V[2]/z$p._angleToRandin,this._localRotation),this._localRotationEuler=z$V,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var z$U=this._entity.owner._transform,z$r=this._entity.localRotationEuler,z$s=z$r.elements;z$s[0]=z$V[0],z$s[1]=z$V[1],z$s[2]=z$V[2],z$U.localRotationEuler=z$r}},z$U.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)z$hU.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var z$V=this._getlocalMatrix(),z$U=0;z$U<16;++z$U)this._worldMatrix[z$U]=z$V[z$U];this._worldUpdate=!1}return this._worldMatrix},z$U.setParent=function(z$V){if(this._parent!==z$V){if(this._parent){var z$U=this._parent._childs,z$r=z$U.indexOf(this);z$U.splice(z$r,1)}z$V&&(z$V._childs.push(this),z$V&&this._onWorldTransform()),this._parent=z$V}},z$S(z$p,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),z$p}(),z$OU=function(z$V){function z$U(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,z$U.__super.call(this),this._destroyed=!1,this._id=z$U._uniqueIDCounter,z$U._uniqueIDCounter++}z$G(z$U,"laya.d3.component.Component3D",z$c);var z$r=z$U.prototype;return z$d.imps(z$r,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),z$r._initialize=function(z$V){this._owner=z$V,this._enable=!0,this.started=!1,this._load(z$V)},z$r._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},z$r._load=function(z$V){},z$r._start=function(z$V){},z$r._update=function(z$V){},z$r._lateUpdate=function(z$V){},z$r._preRenderUpdate=function(z$V){},z$r._postRenderUpdate=function(z$V){},z$r._unload=function(z$V){this.offAll()},z$r._cloneTo=function(z$V){},z$q(0,z$r,"id",function(){return this._id}),z$q(0,z$r,"destroyed",function(){return this._destroyed}),z$q(0,z$r,"owner",function(){return this._owner}),z$q(0,z$r,"enable",function(){return this._enable},function(z$V){this._enable!==z$V&&(this._enable=z$V,this.event("enablechanged",this._enable))}),z$q(0,z$r,"isSingleton",function(){return z$U._isSingleton}),z$U._isSingleton=!0,z$U._uniqueIDCounter=1,z$U}(),z$LU=function(z$V){function z$U(){this._destroyed=!1,z$U.__super.call(this),this._destroyed=!1}z$G(z$U,"laya.d3.core.GeometryFilter",z$c);var z$r=z$U.prototype;return z$d.imps(z$r,{"laya.resource.IDestroy":!0}),z$r._destroy=function(){this.offAll(),this._destroyed=!0},z$q(0,z$r,"_isAsyncLoaded",function(){return!0}),z$q(0,z$r,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),z$q(0,z$r,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),z$q(0,z$r,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),z$q(0,z$r,"destroyed",function(){return this._destroyed}),z$U}(),z$dU=function(z$V){function z$s(z$V){z$s.__super.call(this),this._id=++z$s._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new z$gV(new z$RU,new z$RU),this._boundingBoxCenter=new z$RU,this._boundingSphere=new z$YV(new z$RU,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=z$V,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}z$G(z$s,"laya.d3.core.render.BaseRender",z$c);var z$U=z$s.prototype;return z$d.imps(z$U,{"laya.resource.IDestroy":!0}),z$U._changeMaterialReference=function(z$V,z$U){z$V&&z$V._removeReference(),z$U._addReference()},z$U._getInstanceMaterial=function(z$V,z$U){var z$r=new z$V.constructor;return z$V.cloneTo(z$r),z$r.name=z$r.name+"(Instance)",this._materialsInstance[z$U]=!0,this._changeMaterialReference(this._materials[z$U],z$r),this._materials[z$U]=z$r},z$U._setShaderValuelightMap=function(z$V){this._setShaderValueTexture(3,z$V)},z$U._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},z$U._renderRenderableBoundBox=function(){var z$V=z$lU._debugPhasorSprite,z$U=this.boundingBox,z$r=z$s._tempBoundBoxCorners;z$U.getCorners(z$r),z$V.line(z$r[0],z$s._greenColor,z$r[1],z$s._greenColor),z$V.line(z$r[2],z$s._greenColor,z$r[3],z$s._greenColor),z$V.line(z$r[4],z$s._greenColor,z$r[5],z$s._greenColor),z$V.line(z$r[6],z$s._greenColor,z$r[7],z$s._greenColor),z$V.line(z$r[0],z$s._greenColor,z$r[3],z$s._greenColor),z$V.line(z$r[1],z$s._greenColor,z$r[2],z$s._greenColor),z$V.line(z$r[2],z$s._greenColor,z$r[6],z$s._greenColor),z$V.line(z$r[3],z$s._greenColor,z$r[7],z$s._greenColor),z$V.line(z$r[0],z$s._greenColor,z$r[4],z$s._greenColor),z$V.line(z$r[1],z$s._greenColor,z$r[5],z$s._greenColor),z$V.line(z$r[4],z$s._greenColor,z$r[7],z$s._greenColor),z$V.line(z$r[5],z$s._greenColor,z$r[6],z$s._greenColor)},z$U._calculateBoundingSphere=function(){throw"BaseRender: must override it."},z$U._calculateBoundingBox=function(){throw"BaseRender: must override it."},z$U._setShaderValueTexture=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U)},z$U._setShaderValueMatrix4x4=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U?z$U.elements:null)},z$U._setShaderValueColor=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U?z$U.elements:null)},z$U._setShaderValueBuffer=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U)},z$U._setShaderValueInt=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U)},z$U._setShaderValueBool=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U)},z$U._setShaderValueNumber=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U)},z$U._setShaderValueVector2=function(z$V,z$U){this._owner._shaderValues.setValue(z$V,z$U?z$U.elements:null)},z$U._addShaderDefine=function(z$V){this._owner._shaderDefineValue|=z$V},z$U._removeShaderDefine=function(z$V){this._owner._shaderDefineValue&=~z$V},z$U._renderUpdate=function(z$V){return!0},z$U._applyLightMapParams=function(){if(0<=this._lightmapIndex){var z$V=this._owner.scene;if(z$V){var z$U=z$V.getlightmaps()[this._lightmapIndex];z$U?(this._addShaderDefine(z$AU.SAHDERDEFINE_LIGHTMAP),z$U.loaded?this._setShaderValuelightMap(z$U):z$U.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(z$AU.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(z$AU.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(z$AU.SAHDERDEFINE_LIGHTMAP)},z$U._updateOctreeNode=function(){var z$V=this._treeNode;z$V&&this._octreeNodeNeedChange&&(z$V.updateObject(this),this._octreeNodeNeedChange=!1)},z$U._destroy=function(){this.offAll();var z$V=0,z$U=0;for(z$V=0,z$U=this._renderElements.length;z$V<z$U;z$V++)this._renderElements[z$V]._destroy();for(z$V=0,z$U=this._materials.length;z$V<z$U;z$V++)this._materials[z$V]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},z$q(0,z$U,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),z$q(0,z$U,"id",function(){return this._id}),z$q(0,z$U,"material",function(){var z$V=this._materials[0];if(z$V&&!this._materialsInstance[0]){var z$U=this._getInstanceMaterial(z$V,0);this.event("materialchanged",[this,0,z$U])}return this._materials[0]},function(z$V){this.sharedMaterial=z$V}),z$q(0,z$U,"sharedMaterial",function(){return this._materials[0]},function(z$V){var z$U=this._materials[0];z$U!==z$V&&(this._materials[0]=z$V,this._materialsInstance[0]=!1,this._changeMaterialReference(z$U,z$V),this.event("materialchanged",[this,0,z$V]))}),z$q(0,z$U,"lightmapIndex",function(){return this._lightmapIndex},function(z$V){this._lightmapIndex=z$V,this._applyLightMapParams()}),z$q(0,z$U,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(z$V){this._lightmapScaleOffset=z$V,this._setShaderValueColor(2,z$V),this._addShaderDefine(z$AU.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),z$q(0,z$U,"enable",function(){return this._enable},function(z$V){this._enable=z$V,this.event("enablechanged",[this,z$V])}),z$q(0,z$U,"materials",function(){for(var z$V=0,z$U=this._materials.length;z$V<z$U;z$V++)if(!this._materialsInstance[z$V]){var z$r=this._getInstanceMaterial(this._materials[z$V],z$V);this.event("materialchanged",[this,z$V,z$r])}return this._materials.slice()},function(z$V){this.sharedMaterials=z$V}),z$q(0,z$U,"sharedMaterials",function(){return this._materials.slice()},function(z$V){if(!z$V)throw new Error("MeshRender: shadredMaterials value can't be null.");var z$U=z$V.length;this._materialsInstance.length=z$U;for(var z$r=0;z$r<z$U;z$r++){var z$s=this._materials[z$r];z$s!==z$V[z$r]&&(this._materialsInstance[z$r]=!1,this._changeMaterialReference(z$s,z$V[z$r]),this.event("materialchanged",[this,z$r,z$V[z$r]]))}this._materials=z$V}),z$q(0,z$U,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),z$q(0,z$U,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var z$V=this.boundingBox;z$RU.add(z$V.min,z$V.max,this._boundingBoxCenter),z$RU.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),z$q(0,z$U,"receiveShadow",function(){return this._receiveShadow},function(z$V){this._receiveShadow!==z$V&&((this._receiveShadow=z$V)?this._addShaderDefine(z$GU.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(z$GU.SHADERDEFINE_RECEIVE_SHADOW))}),z$q(0,z$U,"destroyed",function(){return this._destroyed}),z$s._uniqueIDCounter=0,z$S(z$s,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU,new z$RU]},"_greenColor",function(){return this._greenColor=new z$TU(0,1,0,1)}]),z$s}(),z$kU=function(z$V){function z$T(z$V){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,z$T.__super.call(this),this._localPosition=new z$RU,this._localRotation=new z$rU(0,0,0,1),this._localScale=new z$RU(1,1,1),this._localRotationEuler=new z$RU,this._localMatrix=new z$VU,this._position=new z$RU,this._rotation=new z$rU(0,0,0,1),this._scale=new z$RU(1,1,1),this._worldMatrix=new z$VU,this._forward=new z$RU,this._up=new z$RU,this._right=new z$RU,this._owner=z$V,this._childs=[]}z$G(z$T,"laya.d3.core.Transform3D",z$c);var z$U=z$T.prototype;return z$U._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)z$VU.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var z$V=z$T._tempVector30;z$RU.multiply(this.pivot,this._localScale,z$V);var z$U=z$T._tempVector31;z$RU.subtract(z$V,this.pivot,z$U);var z$r=z$T._tempVector32,z$s=this.localRotation;z$RU.transformQuat(z$V,z$s,z$r),z$RU.subtract(z$r,z$V,z$r);var z$p=z$T._tempVector33;z$RU.subtract(this._localPosition,z$U,z$p),z$RU.subtract(z$p,z$r,z$p),z$VU.createAffineTransformation(z$p,z$s,this._localScale,this._localMatrix)}},z$U._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldPositionRotationTransform()}},z$U._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldPositionScaleTransform()}},z$U._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldPositionTransform()}},z$U._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldPositionRotationTransform()}},z$U._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldPositionScaleTransform()}},z$U._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._onWorldTransform()}},z$U.translate=function(z$V,z$U){void 0===z$U&&(z$U=!0),z$U?(z$VU.createFromQuaternion(this.localRotation,z$T._tempMatrix0),z$RU.transformCoordinate(z$V,z$T._tempMatrix0,z$T._tempVector30),z$RU.add(this.localPosition,z$T._tempVector30,this._localPosition),this.localPosition=this._localPosition):(z$RU.add(this.position,z$V,this._position),this.position=this._position)},z$U.rotate=function(z$V,z$U,z$r){var z$s;void 0===z$U&&(z$U=!0),void 0===z$r&&(z$r=!0),z$s=z$r?z$V:(z$RU.scale(z$V,Math.PI/180,z$T._tempVector30),z$T._tempVector30),z$rU.createFromYawPitchRoll(z$s.y,z$s.x,z$s.z,z$T._tempQuaternion0),z$U?(z$rU.multiply(this._localRotation,z$T._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(z$rU.multiply(z$T._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},z$U.lookAt=function(z$V,z$U,z$r){void 0===z$r&&(z$r=!1);var z$s,z$p=z$V.elements;if(z$r){if(z$s=this._localPosition.elements,Math.abs(z$s[0]-z$p[0])<z$CV.zeroTolerance&&Math.abs(z$s[1]-z$p[1])<z$CV.zeroTolerance&&Math.abs(z$s[2]-z$p[2])<z$CV.zeroTolerance)return;z$rU.lookAt(this._localPosition,z$V,z$U,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var z$c=this.position;if(z$s=z$c.elements,Math.abs(z$s[0]-z$p[0])<z$CV.zeroTolerance&&Math.abs(z$s[1]-z$p[1])<z$CV.zeroTolerance&&Math.abs(z$s[2]-z$p[2])<z$CV.zeroTolerance)return;z$rU.lookAt(z$c,z$V,z$U,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},z$q(0,z$U,"_isFrontFaceInvert",function(){var z$V=this.scale,z$U=z$V.x<0;return z$V.y<0&&(z$U=!z$U),z$V.z<0&&(z$U=!z$U),z$U}),z$q(0,z$U,"owner",function(){return this._owner}),z$q(0,z$U,"localRotation",function(){if(this._localQuaternionUpdate){var z$V=this._localRotationEuler.elements;z$rU.createFromYawPitchRoll(z$V[1]/z$T._angleToRandin,z$V[0]/z$T._angleToRandin,z$V[2]/z$T._angleToRandin,this._localRotation)}return this._localRotation},function(z$V){this._localRotation=z$V,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),z$q(0,z$U,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?z$VU.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(z$V){null===this._parent?z$V.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),z$VU.multiply(this._localMatrix,z$V,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=z$V,this._worldUpdate=!1}),z$q(0,z$U,"worldNeedUpdate",function(){return this._worldUpdate}),z$q(0,z$U,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(z$V){this._localMatrix=z$V,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),z$q(0,z$U,"dummy",function(){return this._dummy},function(z$V){this._dummy!==z$V&&(this._dummy&&(this._dummy._entity=null),z$V&&(z$V._entity=this),this._dummy=z$V)}),z$q(0,z$U,"localPosition",function(){return this._localPosition},function(z$V){this._localPosition=z$V,this._localUpdate=!0,this._onWorldPositionTransform()}),z$q(0,z$U,"position",function(){if(this._positionUpdate){if(null!=this._parent){var z$V=this._parent.position;z$RU.multiply(this._localPosition,this._parent.scale,z$T._tempVector30),z$RU.transformQuat(z$T._tempVector30,this._parent.rotation,z$T._tempVector30),z$RU.add(z$V,z$T._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(z$V){if(null!=this._parent){z$RU.subtract(z$V,this._parent.position,this._localPosition);var z$U=this._parent.scale.elements,z$r=z$U[0],z$s=z$U[1],z$p=z$U[2];if(1!==z$r||1!==z$s||1!==z$p){var z$c=z$T._tempVector30,z$R=z$c.elements;z$R[0]=1/z$r,z$R[1]=1/z$s,z$R[2]=1/z$p,z$RU.multiply(this._localPosition,z$c,this._localPosition)}this._parent.rotation.invert(z$T._tempQuaternion0),z$RU.transformQuat(this._localPosition,z$T._tempQuaternion0,this._localPosition)}else z$V.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=z$V,this._positionUpdate=!1}),z$q(0,z$U,"localScale",function(){return this._localScale},function(z$V){this._localScale=z$V,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),z$q(0,z$U,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(z$T._tempVector30);var z$V=z$T._tempVector30.elements,z$U=this._localRotationEuler.elements;z$U[0]=z$V[1]*z$T._angleToRandin,z$U[1]=z$V[0]*z$T._angleToRandin,z$U[2]=z$V[2]*z$T._angleToRandin}return this._localRotationEuler},function(z$V){this._localRotationEuler=z$V,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),z$q(0,z$U,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?z$rU.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(z$V){null!=this._parent?(this._parent.rotation.invert(z$T._tempQuaternion0),z$rU.multiply(z$V,z$T._tempQuaternion0,this._localRotation)):z$V.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=z$V,this._rotationUpdate=!1}),z$q(0,z$U,"scale",function(){return this._scaleUpdate&&(null!==this._parent?z$RU.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(z$V){if(null!==this._parent){var z$U=this._parent.scale.elements,z$r=z$T._tempVector30.elements;z$r[0]=1/z$U[0],z$r[1]=1/z$U[1],z$r[2]=1/z$U[2],z$RU.multiply(z$V,z$T._tempVector30,this._localScale)}else z$V.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=z$V,this._scaleUpdate=!1}),z$q(0,z$U,"rotationEuler",null,function(z$V){z$rU.createFromYawPitchRoll(z$V.y,z$V.x,z$V.z,this._rotation),this.rotation=this._rotation}),z$q(0,z$U,"forward",function(){var z$V=this.worldMatrix.elements;return this._forward.elements[0]=-z$V[8],this._forward.elements[1]=-z$V[9],this._forward.elements[2]=-z$V[10],this._forward}),z$q(0,z$U,"up",function(){var z$V=this.worldMatrix.elements;return this._up.elements[0]=z$V[4],this._up.elements[1]=z$V[5],this._up.elements[2]=z$V[6],this._up}),z$q(0,z$U,"right",function(){var z$V=this.worldMatrix.elements;return this._right.elements[0]=z$V[0],this._right.elements[1]=z$V[1],this._right.elements[2]=z$V[2],this._right}),z$q(0,z$U,"parent",function(){return this._parent},function(z$V){if(this._parent!==z$V){if(this._parent){var z$U=this._parent._childs,z$r=z$U.indexOf(this);z$U.splice(z$r,1)}z$V&&(z$V._childs.push(this),z$V&&this._onWorldTransform()),this._parent=z$V}}),z$S(z$T,["_tempVector30",function(){return this._tempVector30=new z$RU},"_tempVector31",function(){return this._tempVector31=new z$RU},"_tempVector32",function(){return this._tempVector32=new z$RU},"_tempVector33",function(){return this._tempVector33=new z$RU},"_tempQuaternion0",function(){return this._tempQuaternion0=new z$rU},"_tempMatrix0",function(){return this._tempMatrix0=new z$VU},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),z$T}(),z$yU=(function(z$V){function z$U(){this._rotation=0,this._matNeedUpdte=!1,z$U.__super.call(this),this._matrix=new z$VU,this._offset=new z$cU,this._tiling=new z$cU(1,1)}z$G(z$U,"laya.d3.core.TransformUV",z$c);var z$r=z$U.prototype;z$d.imps(z$r,{"laya.d3.core.IClone":!0}),z$r._updateMatrix=function(){z$U._tempOffsetV3.elements[0]=this._offset.x,z$U._tempOffsetV3.elements[1]=this._offset.y,z$rU.createFromYawPitchRoll(0,0,this._rotation,z$U._tempRotationQua),z$U._tempTitlingV3.elements[0]=this._tiling.x,z$U._tempTitlingV3.elements[1]=this._tiling.y,z$VU.createAffineTransformation(z$U._tempOffsetV3,z$U._tempRotationQua,z$U._tempTitlingV3,this._matrix)},z$r.cloneTo=function(z$V){z$V._matrix=this._matrix.clone(),z$V._offset=this._offset.clone(),z$V._rotation=this._rotation,z$V._tiling=this._tiling.clone()},z$r.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$r,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),z$q(0,z$r,"tiling",function(){return this._tiling},function(z$V){this._tiling=z$V,this._matNeedUpdte=!0}),z$q(0,z$r,"offset",function(){return this._offset},function(z$V){this._offset=z$V,this._matNeedUpdte=!0}),z$q(0,z$r,"rotation",function(){return this._rotation},function(z$V){this._rotation=z$V,this._matNeedUpdte=!0}),z$S(z$U,["_tempOffsetV3",function(){return this._tempOffsetV3=new z$RU(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new z$rU},"_tempTitlingV3",function(){return this._tempTitlingV3=new z$RU(1,1,1)}])}(),function(z$r){function z$V(){this.x=NaN,this.y=NaN,this.z=NaN,z$V.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}z$G(z$V,"laya.d3.core.particleShuriKen.module.shape.BoxShape",z$r);var z$U=z$V.prototype;z$U._getShapeBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=.5*-this.x,z$U[1]=.5*-this.y,z$U[2]=.5*-this.z;var z$r=z$V.max.elements;z$r[0]=.5*this.x,z$r[1]=.5*this.y,z$r[2]=.5*this.z},z$U._getSpeedBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=0,z$U[1]=0,z$U[2]=0;var z$r=z$V.max.elements;z$r[0]=0,z$r[1]=1,z$r[2]=0},z$U.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements,z$c=z$U.elements;z$r?(z$r.seed=z$s[16],z$P._randomPointInsideHalfUnitBox(z$V,z$r),z$s[16]=z$r.seed):z$P._randomPointInsideHalfUnitBox(z$V),z$p[0]=this.x*z$p[0],z$p[1]=this.y*z$p[1],z$p[2]=this.z*z$p[2],this.randomDirection?z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U):(z$c[0]=0,z$c[1]=0,z$c[2]=1)},z$U.cloneTo=function(z$V){z$r.prototype.cloneTo.call(this,z$V);var z$U=z$V;z$U.x=this.x,z$U.y=this.y,z$U.z=this.z,z$U.randomDirection=this.randomDirection}}(z$j),function(z$r){function z$R(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,z$R.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}z$G(z$R,"laya.d3.core.particleShuriKen.module.shape.CircleShape",z$r);var z$V=z$R.prototype;z$V._getShapeBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[2]=-this.radius,z$U[1]=0;var z$r=z$V.max.elements;z$r[0]=z$r[2]=this.radius,z$r[1]=0},z$V._getSpeedBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[1]=-1,z$U[2]=0;var z$r=z$V.max.elements;z$r[0]=z$r[1]=1,z$r[2]=0},z$V.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements,z$c=z$R._tempPositionPoint.elements;z$r?(z$r.seed=z$s[16],this.emitFromEdge?z$P._randomPointUnitArcCircle(this.arc,z$R._tempPositionPoint,z$r):z$P._randomPointInsideUnitArcCircle(this.arc,z$R._tempPositionPoint,z$r),z$s[16]=z$r.seed):this.emitFromEdge?z$P._randomPointUnitArcCircle(this.arc,z$R._tempPositionPoint):z$P._randomPointInsideUnitArcCircle(this.arc,z$R._tempPositionPoint),z$p[0]=-z$c[0],z$p[1]=z$c[1],z$p[2]=0,z$RU.scale(z$V,this.radius,z$V),this.randomDirection?z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U):z$V.cloneTo(z$U)},z$V.cloneTo=function(z$V){z$r.prototype.cloneTo.call(this,z$V);var z$U=z$V;z$U.radius=this.radius,z$U.arc=this.arc,z$U.emitFromEdge=this.emitFromEdge,z$U.randomDirection=this.randomDirection},z$S(z$R,["_tempPositionPoint",function(){return this._tempPositionPoint=new z$cU}])}(z$j),function(z$r){function z$_(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,z$_.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}z$G(z$_,"laya.d3.core.particleShuriKen.module.shape.ConeShape",z$r);var z$V=z$_.prototype;z$V._getShapeBoundBox=function(z$V){var z$U=this.radius+this.length*Math.sin(this.angle),z$r=this.length*Math.cos(this.angle),z$s=z$V.min.elements;z$s[0]=z$s[1]=-z$U,z$s[2]=0;var z$p=z$V.max.elements;z$p[0]=z$p[1]=z$U,z$p[2]=z$r},z$V._getSpeedBoundBox=function(z$V){var z$U=Math.sin(this.angle),z$r=z$V.min.elements;z$r[0]=z$r[1]=-z$U,z$r[2]=0;var z$s=z$V.max.elements;z$s[0]=z$r[1]=z$U,z$s[2]=1},z$V.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){var z$p,z$c=z$V.elements,z$R=z$U.elements,z$T=z$_._tempPositionPoint.elements,z$N=NaN,z$t=NaN,z$b=Math.cos(this.angle),z$S=Math.sin(this.angle);switch(this.emitType){case 0:z$r?(z$r.seed=z$s[16],z$P._randomPointInsideUnitCircle(z$_._tempPositionPoint,z$r),z$s[16]=z$r.seed):z$P._randomPointInsideUnitCircle(z$_._tempPositionPoint),z$N=z$T[0],z$t=z$T[1],z$c[0]=z$N*this.radius,z$c[1]=z$t*this.radius,z$c[2]=0,this.randomDirection?(z$r?(z$r.seed=z$s[17],z$P._randomPointInsideUnitCircle(z$_._tempDirectionPoint,z$r),z$s[17]=z$r.seed):z$P._randomPointInsideUnitCircle(z$_._tempDirectionPoint),z$p=z$_._tempDirectionPoint.elements,z$R[0]=z$p[0]*z$S,z$R[1]=z$p[1]*z$S):(z$R[0]=z$N*z$S,z$R[1]=z$t*z$S),z$R[2]=z$b;break;case 1:z$r?(z$r.seed=z$s[16],z$P._randomPointUnitCircle(z$_._tempPositionPoint,z$r),z$s[16]=z$r.seed):z$P._randomPointUnitCircle(z$_._tempPositionPoint),z$N=z$T[0],z$t=z$T[1],z$c[0]=z$N*this.radius,z$c[1]=z$t*this.radius,z$c[2]=0,this.randomDirection?(z$r?(z$r.seed=z$s[17],z$P._randomPointInsideUnitCircle(z$_._tempDirectionPoint,z$r),z$s[17]=z$r.seed):z$P._randomPointInsideUnitCircle(z$_._tempDirectionPoint),z$p=z$_._tempDirectionPoint.elements,z$R[0]=z$p[0]*z$S,z$R[1]=z$p[1]*z$S):(z$R[0]=z$N*z$S,z$R[1]=z$t*z$S),z$R[2]=z$b;break;case 2:z$r?(z$r.seed=z$s[16],z$P._randomPointInsideUnitCircle(z$_._tempPositionPoint,z$r)):z$P._randomPointInsideUnitCircle(z$_._tempPositionPoint),z$N=z$T[0],z$t=z$T[1],z$c[0]=z$N*this.radius,z$c[1]=z$t*this.radius,z$R[z$c[2]=0]=z$N*z$S,z$R[1]=z$t*z$S,z$R[2]=z$b,z$RU.normalize(z$U,z$U),z$r?(z$RU.scale(z$U,this.length*z$r.getFloat(),z$U),z$s[16]=z$r.seed):z$RU.scale(z$U,this.length*Math.random(),z$U),z$RU.add(z$V,z$U,z$V),this.randomDirection&&(z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U));break;case 3:z$r?(z$r.seed=z$s[16],z$P._randomPointUnitCircle(z$_._tempPositionPoint,z$r)):z$P._randomPointUnitCircle(z$_._tempPositionPoint),z$N=z$T[0],z$t=z$T[1],z$c[0]=z$N*this.radius,z$c[1]=z$t*this.radius,z$R[z$c[2]=0]=z$N*z$S,z$R[1]=z$t*z$S,z$R[2]=z$b,z$RU.normalize(z$U,z$U),z$r?(z$RU.scale(z$U,this.length*z$r.getFloat(),z$U),z$s[16]=z$r.seed):z$RU.scale(z$U,this.length*Math.random(),z$U),z$RU.add(z$V,z$U,z$V),this.randomDirection&&(z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U));break;default:throw new Error("ConeShape:emitType is invalid.")}},z$V.cloneTo=function(z$V){z$r.prototype.cloneTo.call(this,z$V);var z$U=z$V;z$U.angle=this.angle,z$U.radius=this.radius,z$U.length=this.length,z$U.emitType=this.emitType,z$U.randomDirection=this.randomDirection},z$S(z$_,["_tempPositionPoint",function(){return this._tempPositionPoint=new z$cU},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new z$cU}])}(z$j),function(z$r){function z$V(){this.radius=NaN,this.emitFromShell=!1,z$V.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}z$G(z$V,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",z$r);var z$U=z$V.prototype;z$U._getShapeBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[1]=z$U[2]=-this.radius;var z$r=z$V.max.elements;z$r[0]=z$r[1]=this.radius,z$r[2]=0},z$U._getSpeedBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[1]=-1,z$U[2]=0;var z$r=z$V.max.elements;z$r[0]=z$r[1]=z$r[2]=1},z$U.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){var z$p=z$V.elements;z$r?(z$r.seed=z$s[16],this.emitFromShell?z$P._randomPointUnitSphere(z$V,z$r):z$P._randomPointInsideUnitSphere(z$V,z$r),z$s[16]=z$r.seed):this.emitFromShell?z$P._randomPointUnitSphere(z$V):z$P._randomPointInsideUnitSphere(z$V),z$RU.scale(z$V,this.radius,z$V);var z$c=z$p[2];z$c<0&&(z$p[2]=-1*z$c),this.randomDirection?z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U):z$V.cloneTo(z$U)},z$U.cloneTo=function(z$V){z$r.prototype.cloneTo.call(this,z$V);var z$U=z$V;z$U.radius=this.radius,z$U.emitFromShell=this.emitFromShell,z$U.randomDirection=this.randomDirection}}(z$j),function(z$r){function z$V(){this.radius=NaN,this.emitFromShell=!1,z$V.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}z$G(z$V,"laya.d3.core.particleShuriKen.module.shape.SphereShape",z$r);var z$U=z$V.prototype;z$U._getShapeBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[1]=z$U[2]=-this.radius;var z$r=z$V.max.elements;z$r[0]=z$r[1]=z$r[2]=this.radius},z$U._getSpeedBoundBox=function(z$V){var z$U=z$V.min.elements;z$U[0]=z$U[1]=z$U[2]=-1;var z$r=z$V.max.elements;z$r[0]=z$r[1]=z$r[2]=1},z$U.generatePositionAndDirection=function(z$V,z$U,z$r,z$s){z$r?(z$r.seed=z$s[16],this.emitFromShell?z$P._randomPointUnitSphere(z$V,z$r):z$P._randomPointInsideUnitSphere(z$V,z$r),z$s[16]=z$r.seed):this.emitFromShell?z$P._randomPointUnitSphere(z$V):z$P._randomPointInsideUnitSphere(z$V),z$RU.scale(z$V,this.radius,z$V),this.randomDirection?z$r?(z$r.seed=z$s[17],z$P._randomPointUnitSphere(z$U,z$r),z$s[17]=z$r.seed):z$P._randomPointUnitSphere(z$U):z$V.cloneTo(z$U)},z$U.cloneTo=function(z$V){z$r.prototype.cloneTo.call(this,z$V);var z$U=z$V;z$U.radius=this.radius,z$U.emitFromShell=this.emitFromShell,z$U.randomDirection=this.randomDirection}}(z$j),function(z$V){function z$U(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,z$U.__super.call(this)}return z$G(z$U,"laya.d3.core.render.SubMeshRenderElement",z$X),z$U}()),z$DU=function(z$V){function z$h(z$V,z$U,z$r,z$s,z$p,z$c){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=z$V,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[z$GU.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[z$AU.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[z$AU.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[z$HU.SHADERDEFINE_ALPHATEST]="ALPHATEST";z$h.__super.call(this,z$V,z$U,z$r,null,{}),this._attributeMap=z$s;var z$R;for(z$R in z$p){var z$T=z$p[z$R];switch(z$T[1]){case 0:this._renderElementUniformMap[z$R]=z$T[0];break;case 1:this._materialUniformMap[z$R]=z$T[0];break;case 2:this._spriteUniformMap[z$R]=z$T[0];break;case 3:this._cameraUniformMap[z$R]=z$T[0];break;case 4:this._sceneUniformMap[z$R]=z$T[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}z$G(z$h,"laya.d3.shader.ShaderCompile3D",z$O);var z$U=z$h.prototype;return z$U._definesToNameDic=function(z$V,z$U){for(var z$r={},z$s=1,z$p=0;z$p<32&&!(z$V<(z$s=1<<z$p));z$p++)if(z$V&z$s){var z$c=z$U[z$s];z$c&&(z$r[z$c]="")}return z$r},z$U.withCompile=function(z$V,z$U,z$r,z$s){var z$p,z$c,z$R;if(z$c=this.sharders[z$V])if(z$R=z$c[z$U]){if(z$p=z$R[z$r])return z$p}else z$R=z$c[z$U]=[];else z$R=(z$c=this.sharders[z$V]=[])[z$U]=[];var z$T,z$N=this._definesToNameDic(z$V,z$h._globalInt2name),z$t=this._definesToNameDic(z$U,this._spriteInt2name),z$b=this._definesToNameDic(z$r,this._materialInt2name),z$S={},z$_="";if(z$N)for(z$T in z$N)z$_+="#define "+z$T+"\n",z$S[z$T]=!0;if(z$t)for(z$T in z$t)z$_+="#define "+z$T+"\n",z$S[z$T]=!0;if(z$b)for(z$T in z$b)z$_+="#define "+z$T+"\n",z$S[z$T]=!0;var z$G=z$ZU.nameKey.getName(this._name)+" compile ("+z$V+","+z$U+","+z$r+")",z$q=this._VS.toscript(z$S,[]),z$u=this._PS.toscript(z$S,[]);z$E.now();if(z$p=z$ZU.create(z$_+z$q.join("\n"),z$_+z$u.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,z$s,z$G),z$R[z$r]=z$p,laya.d3.shader.ShaderCompile3D.debugMode)z$E.now();return z$p},z$U.precompileShaderWithShaderDefine=function(z$V,z$U,z$r){this.withCompile(z$V,z$U,z$r,!0)},z$U.addMaterialDefines=function(z$V){var z$U=z$V.defines;for(var z$r in z$U){var z$s=z$U[z$r],z$p=parseInt(z$r);this._materialInt2name[z$p]=z$s,this._materialName2Int[z$s]=z$p}},z$U.addSpriteDefines=function(z$V){var z$U=z$V.defines;for(var z$r in z$U){var z$s=z$U[z$r],z$p=parseInt(z$r);this._spriteInt2name[z$p]=z$s,this._spriteName2Int[z$s]=z$p}},z$U.getMaterialDefineByName=function(z$V){return this._materialName2Int[z$V]},z$U.registerMaterialDefine=function(z$V){var z$U=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[z$U]=z$V,this._materialName2Int[z$V]=z$U},z$U.registerSpriteDefine=function(z$V){var z$U=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[z$U]=z$V,this._spriteName2Int[z$V]=z$U},z$h._globalRegDefine=function(z$V,z$U){z$h._globalInt2name[z$U]=z$V},z$h.add=function(z$V,z$U,z$r,z$s,z$p){return laya.d3.shader.ShaderCompile3D._preCompileShader[z$V]=new z$h(z$V,z$U,z$r,z$s,z$p,z$O.includes)},z$h.get=function(z$V){return laya.d3.shader.ShaderCompile3D._preCompileShader[z$ZU.nameKey.getID(z$V)]},z$h._preCompileShader={},z$h._globalInt2name=[],z$h.debugMode=!1,z$h.SHADERDEFINE_HIGHPRECISION=1,z$h.SHADERDEFINE_FOG=4,z$h.SHADERDEFINE_DIRECTIONLIGHT=8,z$h.SHADERDEFINE_POINTLIGHT=16,z$h.SHADERDEFINE_SPOTLIGHT=32,z$h.SHADERDEFINE_UV0=64,z$h.SHADERDEFINE_COLOR=128,z$h.SHADERDEFINE_UV1=256,z$h.SAHDERDEFINE_DEPTHFOG=131072,z$h}(),z$nU=function(z$V){function z$q(){z$q.__super.call(this)}z$G(z$q,"laya.d3.graphics.MeshSprite3DStaticBatchManager",z$sV);var z$U=z$q.prototype;return z$U._getStaticBatch=function(z$V,z$U,z$r,z$s){var z$p,z$c;return z$c=z$V?z$V.id.toString()+z$r.id.toString()+z$U.id.toString()+z$s.toString():z$r.id.toString()+z$U.id.toString()+z$s.toString(),this._staticBatches[z$c]?z$p=this._staticBatches[z$c]:this._staticBatches[z$c]=z$p=new z$IU(z$c,this,z$V,z$U,z$r),z$p},z$U._initStaticBatchs=function(z$V){var z$U,z$r;this._initBatchRenderElements.sort(z$q._sortPrepareStaticBatch);for(var z$s,z$p=!1,z$c=0,z$R=0,z$T=this._initBatchRenderElements.length;z$R<z$T;z$R++){var z$N,z$t=this._initBatchRenderElements[z$R],z$b=z$t.renderObj._getVertexBuffer(0);z$t._sprite3D;if(z$r===z$b.vertexDeclaration&&z$U===z$t._material)if(z$p)z$s._addCombineBatchRenderObjTest(z$t)?(z$N=z$t._staticBatch)!==z$s&&(z$N&&z$N._deleteCombineBatchRenderObj(z$t),z$s._addCombineBatchRenderObj(z$t)):(z$p=!1,z$c++);else{var z$S=this._initBatchRenderElements[z$R-1],z$_=z$S.renderObj,z$G=z$t.renderObj;z$p=!(65535<z$_._getVertexBuffer().vertexCount+z$G._getVertexBuffer().vertexCount)&&(z$s=this._getStaticBatch(z$V,z$r,z$U,z$c),(z$N=z$S._staticBatch)!==z$s&&(z$N&&z$N._deleteCombineBatchRenderObj(z$S),z$s._addCombineBatchRenderObj(z$S)),(z$N=z$t._staticBatch)!==z$s&&(z$N&&z$N._deleteCombineBatchRenderObj(z$t),z$s._addCombineBatchRenderObj(z$t)),!0)}else z$p=!1,z$c=0;z$U=z$t._material,z$r=z$b.vertexDeclaration}},z$q._sortPrepareStaticBatch=function(z$V,z$U){var z$r=z$V._render,z$s=z$U._render,z$p=z$r.lightmapIndex-z$s.lightmapIndex;if(0!=z$p)return z$p;var z$c=z$r.receiveShadow-z$s.receiveShadow;if(0!=z$c)return z$c;var z$R=z$V._mainSortID-z$U._mainSortID;return 0==z$R?z$V.renderObj.triangleCount-z$U.renderObj.triangleCount:z$R},z$q}(),z$IU=function(z$V){function z$c(z$V,z$U,z$r,z$s,z$p){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,z$c.__super.call(this,z$V,z$U,z$r),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=z$s,this._material=z$p}z$G(z$c,"laya.d3.graphics.SubMeshStaticBatch",z$pV);var z$U=z$c.prototype;return z$U._compareBatchRenderElement=function(z$V,z$U){return z$V._batchIndexStart>z$U._batchIndexStart},z$U._addCombineBatchRenderObjTest=function(z$V){var z$U=z$V.renderObj._vertexCount;return!(65535<(0<z$U?this._currentCombineVertexCount+z$U:this._currentCombineVertexCount+z$V.renderObj._getVertexBuffer().vertexCount))},z$U._addCombineBatchRenderObj=function(z$V){var z$U=z$V.renderObj,z$r=z$U._vertexCount;this._initBatchRenderElements.push(z$V),z$V._staticBatch=this,0<z$r?(this._currentCombineIndexCount+=z$U._indexCount,this._currentCombineVertexCount+=z$r):(this._currentCombineIndexCount=this._currentCombineIndexCount+z$U._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+z$U._getVertexBuffer().vertexCount),this._needFinishCombine=!0},z$U._deleteCombineBatchRenderObj=function(z$V){var z$U=z$V.renderObj,z$r=this._initBatchRenderElements.indexOf(z$V);if(-1!==z$r){this._initBatchRenderElements.splice(z$r,1),z$V._staticBatch=null;var z$s=z$U._vertexCount;0<z$s?(this._currentCombineIndexCount=this._currentCombineIndexCount-z$U._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-z$s):(this._currentCombineIndexCount=this._currentCombineIndexCount-z$U._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-z$U._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},z$U._finishInit=function(){if(this._needFinishCombine){var z$V=0,z$U=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var z$r=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),z$s=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=z$jU.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=z$$U.create("ushort",this._currentCombineIndexCount,35044);for(var z$p=0,z$c=this._initBatchRenderElements.length;z$p<z$c;z$p++){var z$R=this._initBatchRenderElements[z$p],z$T=z$R.renderObj,z$N=z$T._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,z$R._sprite3D),z$t=z$T.getIndices(),z$b=z$R._sprite3D.transform._isFrontFaceInvert,z$S=z$V/(this._vertexDeclaration.vertexStride/4)-z$T._vertexStart,z$_=z$U,z$G=z$_+z$t.length;z$R._batchIndexStart=z$_,z$R._batchIndexEnd=z$G,z$s.set(z$t,z$U);var z$q=0;if(z$b)for(z$q=z$_;z$q<z$G;z$q+=3){z$s[z$q]=z$S+z$s[z$q];var z$u=z$s[z$q+1],z$h=z$s[z$q+2];z$s[z$q+1]=z$S+z$h,z$s[z$q+2]=z$S+z$u}else for(z$q=z$_;z$q<z$G;z$q+=3)z$s[z$q]=z$S+z$s[z$q],z$s[z$q+1]=z$S+z$s[z$q+1],z$s[z$q+2]=z$S+z$s[z$q+2];z$U+=z$t.length,z$r.set(z$N,z$V),z$V+=z$N.length}this._vertexBuffer.setData(z$r),this._indexBuffer.setData(z$s),this._needFinishCombine=!1}},z$U._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new z$yU)},z$U._getRenderElement=function(z$V,z$U,z$r){for(var z$s,z$p,z$c=this._batchRenderElements.length,z$R=!0,z$T=0;z$T<z$c;z$T++){var z$N,z$t,z$b=(z$p=this._batchRenderElements[z$T])._sprite3D._render;if(0!==z$T&&(z$R=(z$N=(z$s=this._batchRenderElements[z$T-1])._sprite3D._render).lightmapIndex!==z$b.lightmapIndex||z$N.receiveShadow!==z$b.receiveShadow||z$s._batchIndexEnd!==z$p._batchIndexStart),z$R){(z$t=this._getCombineRenderElementFromPool()).renderObj=this,z$t._material=this._material,z$t._batchIndexStart=z$p._batchIndexStart,z$t._batchIndexEnd=z$p._batchIndexEnd;var z$S=z$b.lightmapIndex,z$_=z$S+1,z$G=this._batchOwnerIndices[z$_];z$G||(z$G=this._batchOwnerIndices[z$_]=[]);var z$q,z$u=z$G[z$p._render.receiveShadow?1:0];void 0===z$u?(z$G[z$b.receiveShadow?1:0]=this._batchOwners.length,(z$q=new z$eU(null,"StaticBatchMeshSprite3D"))._scene=z$U,z$q._transform=this._rootOwner?this._rootOwner._transform:null,z$q._render.lightmapIndex=z$S,z$q._render.receiveShadow=z$p._render.receiveShadow,this._batchOwners.push(z$q)):z$q=this._batchOwners[z$u],z$q._render._renderUpdate(z$r),z$t._sprite3D=z$q,z$V.push(z$t)}else z$t._batchIndexEnd=z$p._batchIndexEnd}},z$U._beforeRender=function(z$V){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},z$U._render=function(z$V){var z$U=z$V.renderElement,z$r=z$U._batchIndexStart,z$s=z$U._batchIndexEnd-z$r;z$w.mainContext.drawElements(4,z$s,5123,2*z$r),z$D.drawCall++,z$D.trianglesFaces+=z$s/3},z$U.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},z$U._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),this._vertexBuffer},z$c}(),z$QU=function(z$V){function z$U(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,z$U.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}z$G(z$U,"laya.d3.core.ComponentNode",z$t);var z$r=z$U.prototype;return z$r.addComponent=function(z$V){var z$U,z$r=this._componentsMap.indexOf(z$V);if(-1===z$r)z$U=[],this._componentsMap.push(z$V),this._typeComponentsIndices.push(z$U);else if(z$U=this._typeComponentsIndices[z$r],this._components[z$U[0]].isSingleton)throw new Error("无法单实例创建"+z$V+"组件，"+z$V+"组件已存在！");var z$s=z$p.getInstance(z$V);return z$U.push(this._components.length),this._components.push(z$s),z$s instanceof laya.d3.component.Script&&this._scripts.push(z$s),z$s._initialize(this),z$s},z$r._removeComponent=function(z$V,z$U){var z$r=this._typeComponentsIndices[z$V],z$s=z$r[z$U],z$p=this._components[z$s];this._components.splice(z$s,1),z$p instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(z$p),1),z$r.splice(z$U,1),0===z$r.length&&(this._typeComponentsIndices.splice(z$V,1),this._componentsMap.splice(z$V,1));for(var z$c=0,z$R=this._componentsMap.length;z$c<z$R;z$c++)for(var z$T=(z$r=this._typeComponentsIndices[z$c]).length-1;0<=z$T;z$T--){var z$N=z$r[z$T];if(!(z$s<z$N))break;z$r[z$T]=--z$N}z$p._destroy()},z$r.getComponentByType=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r=this._componentsMap.indexOf(z$V);return-1===z$r?null:this._components[this._typeComponentsIndices[z$r][z$U]]},z$r.getComponentsByType=function(z$V,z$U){var z$r=this._componentsMap.indexOf(z$V);if(-1!==z$r){var z$s=this._typeComponentsIndices[z$r],z$p=z$s.length;z$U.length=z$p;for(var z$c=0;z$c<z$p;z$c++)z$U[z$c]=this._components[z$s[z$c]]}else z$U.length=0},z$r.getComponentByIndex=function(z$V){return this._components[z$V]},z$r.removeComponentByType=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r=this._componentsMap.indexOf(z$V);-1!==z$r&&this._removeComponent(z$r,z$U)},z$r.removeComponentsByType=function(z$V){var z$U=this._componentsMap.indexOf(z$V);if(-1!==z$U)for(var z$r=this._typeComponentsIndices[z$U],z$s=0,z$p=z$r.length;z$s<z$p;z$r.length<z$p?z$p--:z$s++)this._removeComponent(z$U,z$s)},z$r.removeAllComponent=function(){for(var z$V=0,z$U=this._componentsMap.length;z$V<z$U;this._componentsMap.length<z$U?z$U--:z$V++)this.removeComponentsByType(this._componentsMap[z$V])},z$r._updateComponents=function(z$V){for(var z$U=0,z$r=this._components.length;z$U<z$r;z$U++){var z$s=this._components[z$U];!z$s.started&&(z$s._start(z$V),z$s.started=!0),z$s.enable&&z$s._update(z$V)}},z$r._lateUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._lateUpdate(z$V)}},z$r._preRenderUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._preRenderUpdate(z$V)}},z$r._postRenderUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._postRenderUpdate(z$V)}},z$U}(),z$HU=function(z$s){function z$V(){z$V.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new z$_U,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new z$TU(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}z$G(z$V,"laya.d3.core.material.BaseMaterial",z$s);var z$U=z$V.prototype;return z$d.imps(z$U,{"laya.d3.core.IClone":!0}),z$U._addShaderDefine=function(z$V){this._shaderDefineValue|=z$V},z$U._removeShaderDefine=function(z$V){this._shaderDefineValue&=~z$V},z$U._addDisablePublicShaderDefine=function(z$V){this._disablePublicShaderDefine|=z$V},z$U._removeDisablePublicShaderDefine=function(z$V){this._disablePublicShaderDefine&=~z$V},z$U._setBuffer=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U),this._values[z$V]=z$U},z$U._getBuffer=function(z$V){return this._values[z$V]},z$U._setMatrix4x4=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U?z$U.elements:null),this._values[z$V]=z$U},z$U._getMatrix4x4=function(z$V){return this._values[z$V]},z$U._setInt=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U),this._values[z$V]=z$U},z$U._getInt=function(z$V){return this._values[z$V]},z$U._setNumber=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U),this._values[z$V]=z$U},z$U._getNumber=function(z$V){return this._values[z$V]},z$U._setBool=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U),this._values[z$V]=z$U},z$U._getBool=function(z$V){return this._values[z$V]},z$U._setVector2=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U?z$U.elements:null),this._values[z$V]=z$U},z$U._getVector2=function(z$V){return this._values[z$V]},z$U._setColor=function(z$V,z$U){this._shaderValues.setValue(z$V,z$U?z$U.elements:null),this._values[z$V]=z$U},z$U._getColor=function(z$V){return this._values[z$V]},z$U._setTexture=function(z$V,z$U){var z$r=this._values[z$V];this._values[z$V]=z$U,this._shaderValues.setValue(z$V,z$U),0<this.referenceCount&&(z$r&&z$r._removeReference(),z$U&&z$U._addReference())},z$U._getTexture=function(z$V){return this._values[z$V]},z$U._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},z$U._getShader=function(z$V,z$U,z$r){var z$s=(z$V|z$U)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(z$s,z$r,this._shaderDefineValue),this._shader},z$U._setRenderStateBlendDepth=function(){var z$V=z$w.mainContext;switch(z$z.setDepthMask(z$V,this.depthWrite),0===this.depthTest?z$z.setDepthTest(z$V,!1):(z$z.setDepthTest(z$V,!0),z$z.setDepthFunc(z$V,this.depthTest)),this.blend){case 0:z$z.setBlend(z$V,!1);break;case 1:z$z.setBlend(z$V,!0),z$z.setBlendFunc(z$V,this.srcBlend,this.dstBlend);break;case 2:z$z.setBlend(z$V,!0)}},z$U._setRenderStateFrontFace=function(z$V,z$U){var z$r=z$w.mainContext,z$s=0;switch(this.cull){case 0:z$z.setCullFace(z$r,!1);break;case 1:z$z.setCullFace(z$r,!0),z$s=z$V?z$U&&z$U._isFrontFaceInvert?2305:2304:z$U&&z$U._isFrontFaceInvert?2304:2305,z$z.setFrontFace(z$r,z$s);break;case 2:z$z.setCullFace(z$r,!0),z$s=z$V?z$U&&z$U._isFrontFaceInvert?2304:2305:z$U&&z$U._isFrontFaceInvert?2305:2304,z$z.setFrontFace(z$r,z$s)}},z$U.onAsynLoaded=function(z$V,z$U,z$r){var z$s=z$U[0],z$p=z$U[1];switch(z$s.version){case"LAYAMATERIAL:01":var z$c=0,z$R=0,z$T=z$s.props;for(var z$N in z$T)switch(z$N){case"vectors":var z$t=z$T[z$N];for(z$c=0,z$R=z$t.length;z$c<z$R;z$c++){var z$b=z$t[z$c],z$S=z$b.value;switch(z$S.length){case 2:this[z$b.name]=new z$cU(z$S[0],z$S[1]);break;case 3:this[z$b.name]=new z$RU(z$S[0],z$S[1],z$S[2]);break;case 4:this[z$b.name]=new z$TU(z$S[0],z$S[1],z$S[2],z$S[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var z$_=z$T[z$N];for(z$c=0,z$R=z$_.length;z$c<z$R;z$c++){var z$G=z$_[z$c],z$q=z$G.path;z$q&&(this[z$G.name]=z$l.getRes(z$p[z$q]))}break;case"defines":var z$u=z$T[z$N];for(z$c=0,z$R=z$u.length;z$c<z$R;z$c++){var z$h=this._shaderCompile.getMaterialDefineByName(z$u[z$c]);this._addShaderDefine(z$h)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[z$N]=z$T[z$N];break;case"renderQueue":switch(z$T[z$N]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[z$N]=z$T[z$N]}break;case"LAYAMATERIAL:02":for(z$N in z$T=z$s.props)switch(z$N){case"vectors":for(z$c=0,z$R=(z$t=z$T[z$N]).length;z$c<z$R;z$c++)switch((z$S=(z$b=z$t[z$c]).value).length){case 2:this[z$b.name]=new z$cU(z$S[0],z$S[1]);break;case 3:this[z$b.name]=new z$RU(z$S[0],z$S[1],z$S[2]);break;case 4:this[z$b.name]=new z$TU(z$S[0],z$S[1],z$S[2],z$S[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(z$c=0,z$R=(z$_=z$T[z$N]).length;z$c<z$R;z$c++)(z$q=(z$G=z$_[z$c]).path)&&(this[z$G.name]=z$l.getRes(z$p[z$q]));break;case"defines":for(z$c=0,z$R=(z$u=z$T[z$N]).length;z$c<z$R;z$c++)z$h=this._shaderCompile.getMaterialDefineByName(z$u[z$c]),this._addShaderDefine(z$h);break;default:this[z$N]=z$T[z$N]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},z$U._addReference=function(){z$s.prototype._addReference.call(this);for(var z$V=0,z$U=this._values.length;z$V<z$U;z$V++){var z$r=this._values[z$V];z$r&&z$r instanceof laya.d3.resource.BaseTexture&&z$r._addReference()}},z$U._removeReference=function(){z$s.prototype._removeReference.call(this);for(var z$V=0,z$U=this._values.length;z$V<z$U;z$V++){var z$r=this._values[z$V];z$r&&z$r instanceof laya.d3.resource.BaseTexture&&z$r._removeReference()}},z$U.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},z$U.setShaderName=function(z$V){var z$U=z$ZU.nameKey.getID(z$V);if(-1===z$U)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=z$DU._preCompileShader[z$U]},z$U.cloneTo=function(z$V){var z$U=z$V;z$U.name=this.name,z$U.cull=this.cull,z$U.blend=this.blend,z$U.srcBlend=this.srcBlend,z$U.dstBlend=this.dstBlend,z$U.srcBlendRGB=this.srcBlendRGB,z$U.dstBlendRGB=this.dstBlendRGB,z$U.srcBlendAlpha=this.srcBlendAlpha,z$U.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(z$U.blendConstColor),z$U.blendEquation=this.blendEquation,z$U.blendEquationRGB=this.blendEquationRGB,z$U.blendEquationAlpha=this.blendEquationAlpha,z$U.depthTest=this.depthTest,z$U.depthWrite=this.depthWrite,z$U.renderQueue=this.renderQueue,z$U._shader=this._shader,z$U._disablePublicShaderDefine=this._disablePublicShaderDefine,z$U._shaderDefineValue=this._shaderDefineValue;var z$r,z$s=0,z$p=z$U._shaderValues;z$U._shaderValues.data.length=this._shaderValues.data.length;var z$c=this._values.length,z$R=z$U._values;for(z$s=0,z$r=z$R.length=z$c;z$s<z$r;z$s++){var z$T=this._values[z$s];if(z$T)if("number"==typeof z$T)z$R[z$s]=z$T,z$p.data[z$s]=z$T;else if("number"==typeof z$T&&Math.floor(z$T)==z$T)z$R[z$s]=z$T,z$p.data[z$s]=z$T;else if("boolean"==typeof z$T)z$R[z$s]=z$T,z$p.data[z$s]=z$T;else if(z$T instanceof laya.d3.math.Vector2){var z$N=z$R[z$s]||(z$R[z$s]=new z$cU);z$T.cloneTo(z$N),z$p.data[z$s]=z$N.elements}else if(z$T instanceof laya.d3.math.Vector3){var z$t=z$R[z$s]||(z$R[z$s]=new z$RU);z$T.cloneTo(z$t),z$p.data[z$s]=z$t.elements}else if(z$T instanceof laya.d3.math.Vector4){var z$b=z$R[z$s]||(z$R[z$s]=new z$TU);z$T.cloneTo(z$b),z$p.data[z$s]=z$b.elements}else if(z$T instanceof laya.d3.math.Matrix4x4){var z$S=z$R[z$s]||(z$R[z$s]=new z$VU);z$T.cloneTo(z$S),z$p.data[z$s]=z$S.elements}else z$T instanceof laya.d3.resource.BaseTexture&&(z$R[z$s]=z$T,z$p.data[z$s]=z$T)}},z$U.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$q(0,z$U,"alphaTestValue",function(){return this._getNumber(0)},function(z$V){this._setNumber(0,z$V)}),z$q(0,z$U,"alphaTest",function(){return this._alphaTest},function(z$V){(this._alphaTest=z$V)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),z$V.__init__=function(){z$V.SHADERDEFINE_ALPHATEST=z$V.shaderDefines.registerDefine("ALPHATEST")},z$V.RENDERQUEUE_OPAQUE=2e3,z$V.RENDERQUEUE_ALPHATEST=2450,z$V.RENDERQUEUE_TRANSPARENT=3e3,z$V.CULL_NONE=0,z$V.CULL_FRONT=1,z$V.CULL_BACK=2,z$V.BLEND_DISABLE=0,z$V.BLEND_ENABLE_ALL=1,z$V.BLEND_ENABLE_SEPERATE=2,z$V.BLENDPARAM_ZERO=0,z$V.BLENDPARAM_ONE=1,z$V.BLENDPARAM_SRC_COLOR=768,z$V.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,z$V.BLENDPARAM_DST_COLOR=774,z$V.BLENDPARAM_ONE_MINUS_DST_COLOR=775,z$V.BLENDPARAM_SRC_ALPHA=770,z$V.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,z$V.BLENDPARAM_DST_ALPHA=772,z$V.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,z$V.BLENDPARAM_SRC_ALPHA_SATURATE=776,z$V.BLENDEQUATION_ADD=0,z$V.BLENDEQUATION_SUBTRACT=1,z$V.BLENDEQUATION_REVERSE_SUBTRACT=2,z$V.DEPTHTEST_OFF=0,z$V.DEPTHTEST_NEVER=512,z$V.DEPTHTEST_LESS=513,z$V.DEPTHTEST_EQUAL=514,z$V.DEPTHTEST_LEQUAL=515,z$V.DEPTHTEST_GREATER=516,z$V.DEPTHTEST_NOTEQUAL=517,z$V.DEPTHTEST_GEQUAL=518,z$V.DEPTHTEST_ALWAYS=519,z$V.SHADERDEFINE_ALPHATEST=1,z$V.ALPHATESTVALUE=0,z$S(z$V,["shaderDefines",function(){return this.shaderDefines=new z$bU}]),z$V}(z$h),z$wU=function(z$V){function z$U(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,z$U.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}z$G(z$U,"laya.d3.resource.BaseTexture",z$h);var z$r=z$U.prototype;return z$q(0,z$r,"width",function(){return this._width}),z$q(0,z$r,"repeat",function(){return this._repeat},function(z$V){if(this._repeat!==z$V&&(this._repeat=z$V,this._source)){var z$U=z$w.mainContext;z$z.bindTexture(z$U,this._type,this._source),z$L.isPOT(this._width,this._height)&&this._repeat?(z$U.texParameteri(this._type,10242,10497),z$U.texParameteri(this._type,10243,10497)):(z$U.texParameteri(this._type,10242,33071),z$U.texParameteri(this._type,10243,33071))}}),z$q(0,z$r,"height",function(){return this._height}),z$q(0,z$r,"magFifter",function(){return this._magFifter},function(z$V){(this._magFifter=z$V)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(z$V)}),z$q(0,z$r,"wrapModeV",function(){return this._wrapModeV}),z$q(0,z$r,"size",function(){return this._size}),z$q(0,z$r,"wrapModeU",function(){return this._wrapModeU}),z$q(0,z$r,"mipmap",function(){return this._mipmap},function(z$V){this._mipmap=z$V,this._mipmap!=z$V&&this._conchTexture&&this._conchTexture.setMipMap(z$V)}),z$q(0,z$r,"minFifter",function(){return this._minFifter},function(z$V){this._minFifter=z$V,this._minFifter!=z$V&&this._conchTexture&&this._conchTexture.setMinFifter(z$V)}),z$q(0,z$r,"format",function(){return this._format}),z$q(0,z$r,"source",function(){return this.activeResource(),this._source}),z$q(0,z$r,"defaulteTexture",function(){return z$BU.grayTexture}),z$U.WARPMODE_REPEAT=0,z$U.WARPMODE_CLAMP=1,z$U}(),z$zU=function(z$V){function z$U(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,z$U.__super.call(this),this._boundingBoxCorners=z$s(8,null)}z$G(z$U,"laya.d3.resource.models.BaseMesh",z$h);var z$r=z$U.prototype;return z$r._getPositions=function(){throw new Error("未Override,请重载该属性！")},z$r._generateBoundingObject=function(){this._boundingSphere=new z$YV(new z$RU,0),z$YV.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new z$gV(new z$RU,new z$RU),z$gV.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},z$r.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},z$r.getRenderElement=function(z$V){throw new Error("未Override,请重载该属性！")},z$q(0,z$r,"subMeshCount",function(){return this._subMeshCount}),z$q(0,z$r,"boundingBox",function(){return this._boundingBox}),z$q(0,z$r,"boundingBoxCorners",function(){return this._boundingBoxCorners}),z$q(0,z$r,"boundingSphere",function(){return this._boundingSphere}),z$U}(),z$EU=(function(z$V){function z$U(){z$U.__super.call(this)}z$G(z$U,"laya.d3.component.Script",z$OU);var z$r=z$U.prototype;z$r.onTriggerEnter=function(z$V){},z$r.onTriggerExit=function(z$V){},z$r.onTriggerStay=function(z$V){},z$q(0,z$r,"isSingleton",function(){return z$U._isSingleton}),z$U._isSingleton=!1}(),function(z$V){function z$U(z$V){this._owner=null,this._sharedMesh=null,z$U.__super.call(this),this._owner=z$V}z$G(z$U,"laya.d3.core.MeshFilter",z$V);var z$r=z$U.prototype;return z$r._sharedMeshLoaded=function(){this.event("loaded")},z$r._destroy=function(){z$V.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},z$q(0,z$r,"sharedMesh",function(){return this._sharedMesh},function(z$V){var z$U=this._sharedMesh;z$U&&z$U._removeReference(),(this._sharedMesh=z$V)._addReference(),this.event("meshchanged",[this,z$U,z$V]),z$V.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),z$q(0,z$r,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),z$q(0,z$r,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),z$q(0,z$r,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),z$q(0,z$r,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),z$U}(z$LU)),z$KU=function(z$V){function z$U(z$V){z$U.__super.call(this,z$V),z$V.meshFilter.on("meshchanged",this,this._onMeshChanged)}z$G(z$U,"laya.d3.core.MeshRender",z$dU);var z$r=z$U.prototype;return z$r._onMeshChanged=function(z$V,z$U,z$r){z$r.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:z$r.once("loaded",this,this._onMeshLoaed)},z$r._onMeshLoaed=function(z$V,z$U){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},z$r._calculateBoundingSphereByInitSphere=function(z$V){var z$U=NaN,z$r=this._owner.transform,z$s=z$r.scale.elements,z$p=Math.abs(z$s[0]),z$c=Math.abs(z$s[1]),z$R=Math.abs(z$s[2]);z$U=z$c<=z$p&&z$R<=z$p?z$p:z$R<=z$c?z$c:z$R,z$RU.transformCoordinate(z$V.center,z$r.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=z$V.radius*z$U},z$r._calculateBoundBoxByInitCorners=function(z$V){for(var z$U=this._owner.transform.worldMatrix,z$r=0;z$r<8;z$r++)z$RU.transformCoordinate(z$V[z$r],z$U,z$dU._tempBoundBoxCorners[z$r]);z$gV.createfromPoints(z$dU._tempBoundBoxCorners,this._boundingBox)},z$r._calculateBoundingSphere=function(){var z$V=this._owner.meshFilter.sharedMesh;null==z$V||null==z$V.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(z$V.boundingSphere)},z$r._calculateBoundingBox=function(){var z$V=this._owner.meshFilter.sharedMesh;null==z$V||null==z$V.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(z$V.boundingBoxCorners)},z$r._renderUpdate=function(z$V){var z$U=this._owner.transform;if(z$U){this._setShaderValueMatrix4x4(0,z$U.worldMatrix);var z$r=this._owner.getProjectionViewWorldMatrix(z$V);this._setShaderValueMatrix4x4(1,z$r)}else this._setShaderValueMatrix4x4(0,z$VU.DEFAULT),this._setShaderValueMatrix4x4(1,z$V);return z$lU.debugMode&&this._renderRenderableBoundBox(),!0},z$U}(),z$mU=function(z$U){function z$s(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,z$s.__super.call(this),this._renderState=new z$F,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new z$_U,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new z$UV,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new z$RU(.7,.7,.7),this.ambientColor=new z$RU(.212,.227,.259),z$w.shaderHighPrecision&&this.addShaderDefine(z$DU.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}z$G(z$s,"laya.d3.core.scene.Scene",z$U);var z$V=z$s.prototype;return z$d.imps(z$V,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),z$V._setUrl=function(z$V){this._url=z$V},z$V._getGroup=function(){return this._group},z$V._setGroup=function(z$V){this._group=z$V},z$V._display=function(){z$d.stage._scenes.push(this),z$d.stage._scenes.sort(z$s._sortScenes);for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++){var z$r=this._childs[z$V];z$r.active&&z$r._activeHierarchy()}},z$V._unDisplay=function(){var z$V=z$d.stage._scenes;z$V.splice(z$V.indexOf(this),1);for(var z$U=0,z$r=this._childs.length;z$U<z$r;z$U++){var z$s=this._childs[z$U];z$s.active&&z$s._inActiveHierarchy()}},z$V._addChild3D=function(z$V){z$V.transform._onWorldTransform(),z$V._setBelongScene(this),this.displayedInStage&&z$V.active&&z$V._activeHierarchy()},z$V._removeChild3D=function(z$V){z$V.transform.parent=null,this.displayedInStage&&z$V.active&&z$V._inActiveHierarchy(),z$V._setUnBelongScene()},z$V.initOctree=function(z$V,z$U,z$r,z$s,z$p){void 0===z$p&&(z$p=6),this.treeSize=new z$RU(z$V,z$U,z$r),this.treeLevel=z$p,this.treeRoot=new z$g(this,0),this.treeRoot.init(z$s,this.treeSize)},z$V._prepareUpdateToRenderState=function(z$V,z$U){z$U.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,z$U.scene=this},z$V._prepareSceneToRender=function(z$V){var z$U=this._lights.length;if(0<z$U)for(var z$r=0,z$s=0;z$s<z$U&&!(this._lights[z$s]._prepareToScene(z$V)&&++z$r>=this._enableLightCount);z$s++);},z$V._updateChilds=function(z$V){for(var z$U=0,z$r=this._childs.length;z$U<z$r;++z$U)this._childs[z$U]._update(z$V)},z$V._preRenderScene=function(z$V,z$U,z$r){var z$s,z$p=z$U._viewMatrix,z$c=z$U._projectionMatrix,z$R=z$U._projectionViewMatrix,z$T=0,z$N=z$U.camera;for(z$N.useOcclusionCulling?this.treeRoot?z$rV.renderObjectCullingOctree(z$r,this,z$N,z$p,z$c,z$R):z$rV.renderObjectCulling(z$r,this,z$N,z$p,z$c,z$R):z$rV.renderObjectCullingNoBoundFrustum(this,z$N,z$p,z$c,z$R),z$T=0,z$s=this._quenes.length;z$T<z$s;z$T++)this._quenes[z$T]&&this._quenes[z$T]._preRender(z$U)},z$V._clear=function(z$V,z$U){var z$r=z$U._viewport,z$s=z$U.camera,z$p=z$r.x,z$c=z$s.renderTargetSize.height-z$r.y-z$r.height,z$R=z$r.width,z$T=z$r.height;z$V.viewport(z$p,z$c,z$R,z$T);var z$N=256,z$t=z$s.renderTarget;switch(z$s.clearFlag){case 0:var z$b=z$s.clearColor;if(z$b){z$V.enable(3089),z$V.scissor(z$p,z$c,z$R,z$T);var z$S=z$b.elements;z$V.clearColor(z$S[0],z$S[1],z$S[2],z$S[3]),z$N|=16384}if(z$t)switch(z$b||(z$N=16384),z$t.depthStencilFormat){case 33189:z$N|=256;break;case 36168:z$N|=1024;break;case 34041:z$N|=256,z$N|=1024}z$V.clear(z$N),z$b&&z$V.disable(3089);break;case 1:case 2:if(z$t)switch(z$N=16384,z$t.depthStencilFormat){case 33189:z$N|=256;break;case 36168:z$N|=1024;break;case 34041:z$N|=256,z$N|=1024}z$V.clear(z$N);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},z$V._renderScene=function(z$V,z$U){var z$r,z$s,z$p=z$U.camera,z$c=0;for(z$c=0;z$c<2;z$c++)(z$s=this._quenes[z$c])&&(z$p.renderTarget?z$s._render(z$U,!0):z$s._render(z$U,!1));if(1===z$p.clearFlag){var z$R=z$p.sky;z$R&&(z$z.setCullFace(z$V,!1),z$z.setDepthFunc(z$V,515),z$z.setDepthMask(z$V,!1),z$R._render(z$U),z$z.setDepthFunc(z$V,513),z$z.setDepthMask(z$V,!0))}for(z$c=2,z$r=this._quenes.length;z$c<z$r;z$c++)(z$s=this._quenes[z$c])&&(z$s._sortAlpha(z$U.camera.transform.position),z$p.renderTarget?z$s._render(z$U,!0):z$s._render(z$U,!1))},z$V._set3DRenderConfig=function(z$V){z$V.disable(3042),z$z._blend=!1,z$V.blendFunc(770,771),z$z._sFactor=770,z$z._dFactor=771,z$V.disable(2929),z$z._depthTest=!1,z$V.enable(2884),z$z._cullFace=!0,z$V.depthMask(1),z$z._depthMask=!0,z$V.frontFace(2304),z$z._frontFace=2304},z$V._set2DRenderConfig=function(z$V){z$z.setBlend(z$V,!0),z$z.setBlendFunc(z$V,1,771),z$z.setDepthTest(z$V,!1),z$z.setCullFace(z$V,!1),z$z.setDepthMask(z$V,!0),z$z.setFrontFace(z$V,2305),z$V.viewport(0,0,z$b.width,z$b.height)},z$V._parseCustomProps=function(z$V,z$U,z$r,z$s){var z$p=z$s.customProps.lightmaps,z$c=z$p.length,z$R=this._lightmaps;z$R.length=z$c;for(var z$T=0;z$T<z$c;z$T++)z$R[z$T]=z$l.getRes(z$U[z$p[z$T].replace(".exr",".png")]);this.setlightmaps(z$R);var z$N=z$s.customProps.ambientColor;z$N&&(this.ambientColor=new z$RU(z$N[0],z$N[1],z$N[2]));var z$t=z$s.customProps.fogColor;z$t&&(this.fogColor=new z$RU(z$t[0],z$t[1],z$t[2]))},z$V._addLight=function(z$V){this._lights.indexOf(z$V)<0&&this._lights.push(z$V)},z$V._removeLight=function(z$V){var z$U=this._lights.indexOf(z$V);0<=z$U&&this._lights.splice(z$U,1)},z$V._updateScene=function(){var z$V=this._renderState;this._prepareUpdateToRenderState(z$w.mainContext,z$V),this._updateComponents(z$V),this._updateChilds(z$V),this._lateUpdateComponents(z$V),this._time+=z$V.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},z$V._updateSceneConch=function(){var z$V=this._renderState;this._prepareUpdateToRenderState(z$w.mainContext,z$V),this._updateComponents(z$V),this._lateUpdateComponents(z$V),this._prepareSceneToRender(z$V);for(var z$U=0,z$r=this._cameraPool.length;z$U<z$r;z$U++){var z$s=this._cameraPool[z$U];(z$V.camera=z$s)._prepareCameraToRender()}},z$V._preRenderShadow=function(z$V,z$U,z$r,z$s,z$p){this.treeRoot?z$rV.renderShadowObjectCullingOctree(this,z$U,z$r,z$s,z$p):z$rV.renderShadowObjectCulling(this,z$U,z$r,z$s,z$p);for(var z$c=0,z$R=z$r.length;z$c<z$R;z$c++)z$r[z$c]&&z$r[z$c]._preRender(z$V)},z$V._renderShadowMap=function(z$V,z$U,z$r){var z$s=this.parallelSplitShadowMaps[0];z$s._calcAllLightCameraInfo(z$r);var z$p,z$c,z$R,z$T=z$s.PSSMNum;if(this._preRenderShadow(z$U,z$s._lightCulling,z$s._shadowQuenes,z$s._lightVPMatrix[0],z$T),this.addShaderDefine(z$GU.SHADERDEFINE_CAST_SHADOW),1<z$T)for(var z$N=0;z$N<z$T;z$N++)z$p=z$s.getRenderTarget(z$N+1),z$s.beginRenderTarget(z$N+1),z$V.clearColor(1,1,1,1),z$V.clear(16640),z$V.viewport(0,0,z$p.width,z$p.height),z$U.camera=z$R=z$s.getLightCamera(z$N),z$R._prepareCameraToRender(),z$R._prepareCameraViewProject(z$R.viewMatrix,z$R.projectionMatrix),z$U._projectionViewMatrix=z$s._lightVPMatrix[z$N+1],(z$c=z$s._shadowQuenes[z$N])._preRender(z$U),z$c._renderShadow(z$U,!1),z$s.endRenderTarget(z$N+1);else z$p=z$s.getRenderTarget(1),z$s.beginRenderTarget(1),z$V.clearColor(1,1,1,1),z$V.clear(16640),z$V.viewport(0,0,z$p.width,z$p.height),z$U.camera=z$R=z$s.getLightCamera(0),z$R._prepareCameraToRender(),z$R._prepareCameraViewProject(z$R.viewMatrix,z$R.projectionMatrix),z$U._projectionViewMatrix=z$s._lightVPMatrix[0],(z$c=z$s._shadowQuenes[0])._preRender(z$U),z$c._renderShadow(z$U,!0),z$s.endRenderTarget(1);this.removeShaderDefine(z$GU.SHADERDEFINE_CAST_SHADOW)},z$V.addTreeNode=function(z$V){this.treeRoot.addTreeNode(z$V)},z$V.removeTreeNode=function(z$V){this.treeSize&&z$V._treeNode&&z$V._treeNode.removeObject(z$V)},z$V.setlightmaps=function(z$V){this._lightmaps=z$V;for(var z$U=0,z$r=this._renderableSprite3Ds.length;z$U<z$r;z$U++)this._renderableSprite3Ds[z$U]._render._applyLightMapParams()},z$V.getlightmaps=function(){return this._lightmaps},z$V.addChildAt=function(z$V,z$U){if(!(z$V instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(z$V&&z$V.__className));if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),0<=z$U&&z$U<=this._childs.length){if(z$V._parent===this){var z$r=this.getChildIndex(z$V);this._childs.splice(z$r,1),this._childs.splice(z$U,0,z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,z$U)),this._childChanged()}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$t.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(z$U,0,z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,z$U),(z$V.parent=this)._addChild3D(z$V);return z$V}throw new Error("appendChildAt:The index is out of bounds")},z$V.addChild=function(z$V){if(!(z$V instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),z$V._parent===this){var z$U=this.getChildIndex(z$V);z$U!==this._childs.length-1&&(this._childs.splice(z$U,1),this._childs.push(z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1)),this._childChanged())}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$t.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1),(z$V.parent=this)._childChanged(),this._addChild3D(z$V);return z$V},z$V.removeChildAt=function(z$V){var z$U=this.getChildAt(z$V);return z$U&&(this._removeChild3D(z$U),this._childs.splice(z$V,1),this.conchModel&&this.conchModel.removeChild(z$U.conchModel),z$U.parent=null),z$U},z$V.removeChildren=function(z$V,z$U){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=2147483647),this._childs&&0<this._childs.length){var z$r=this._childs;if(0===z$V&&z$c<=z$U){var z$s=z$r;this._childs=z$t.ARRAY_EMPTY}else z$s=z$r.splice(z$V,z$U-z$V);for(var z$p=0,z$c=z$s.length;z$p<z$c;z$p++)this._removeChild3D(z$s[z$p]),z$s[z$p].parent=null,this.conchModel&&this.conchModel.removeChild(z$s[z$p].conchModel)}return this},z$V.addFrustumCullingObject=function(z$V){this.treeRoot?this.addTreeNode(z$V):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(z$V):this._cullingRenders[this._cullingRendersLength]=z$V,z$V._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},z$V.removeFrustumCullingObject=function(z$V){if(this.treeRoot)this.removeTreeNode(z$V);else{this._cullingRendersLength--;var z$U=z$V._indexInSceneFrustumCullingObjects;if(z$U!==this._cullingRendersLength){var z$r=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[z$U]=z$r)._indexInSceneFrustumCullingObjects=z$U,z$V._indexInSceneFrustumCullingObjects=-1}}},z$V.getRenderQueue=function(z$V){return z$V<3e3?this._quenes[1]||(this._quenes[1]=new z$e(this)):this._quenes[2]||(this._quenes[2]=new z$e(this))},z$V.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new z$e(this)},z$V.addShaderDefine=function(z$V){this._shaderDefineValue|=z$V},z$V.removeShaderDefine=function(z$V){this._shaderDefineValue&=~z$V},z$V.addScript=function(z$V){return this._addComponent(z$V)},z$V.getScriptByType=function(z$V,z$U){return void 0===z$U&&(z$U=0),this._getComponentByType(z$V,z$U)},z$V.getScriptsByType=function(z$V,z$U){this._getComponentsByType(z$V,z$U)},z$V.getScriptByIndex=function(z$V){return this._getComponentByIndex(z$V)},z$V.removeScriptByType=function(z$V,z$U){void 0===z$U&&(z$U=0),this._removeComponentByType(z$V,z$U)},z$V.removeScriptsByType=function(z$V){this._removeComponentByType(z$V)},z$V.removeAllScript=function(){this._removeAllComponent()},z$V.render=function(z$V,z$U,z$r){(z$u._context.ctx._renderKey=0)<this._childs.length&&z$V.addRenderObject(this)},z$V.renderSubmit=function(){var z$V=z$w.mainContext,z$U=this._renderState;this._set3DRenderConfig(z$V),this._prepareSceneToRender(this._renderState);var z$r,z$s=0,z$p=0;if(z$lU.debugMode||z$g.debugMode)for(z$s=0,z$p=this._cameraPool.length;z$s<z$p;z$s++)z$r=this._cameraPool[z$s],z$lU._debugPhasorSprite.begin(1,z$r),z$r.activeInHierarchy&&z$r._renderCamera(z$V,z$U,this),z$lU._debugPhasorSprite.end();else for(z$s=0,z$p=this._cameraPool.length;z$s<z$p;z$s++)(z$r=this._cameraPool[z$s]).activeInHierarchy&&z$r._renderCamera(z$V,z$U,this);return this._set2DRenderConfig(z$V),1},z$V.onAsynLoaded=function(z$V,z$U,z$r){var z$s=z$U[0];if("Scene"!==z$s.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var z$p=z$U[1];z$hU._createNodeByJson(this,z$s,this,z$p),this.event("hierarchyloaded",[this]),this.__loaded=!0},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),this.destroyed||(z$U.prototype.destroy.call(this,z$V),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,z$l.clearRes(this.url),this.loaded||z$lU._cancelLoadByUrl(this.url))},z$V.getRenderType=function(){return 0},z$V.releaseRender=function(){},z$V._addComponent=function(z$V){var z$U,z$r=this._componentsMap.indexOf(z$V);if(-1===z$r)z$U=[],this._componentsMap.push(z$V),this._typeComponentsIndices.push(z$U);else if(z$U=this._typeComponentsIndices[z$r],this._components[z$U[0]].isSingleton)throw new Error("无法单实例创建"+z$V+"组件，"+z$V+"组件已存在！");var z$s=z$p.getInstance(z$V);z$U.push(this._components.length),this._components.push(z$s);return z$s._initialize(this),z$s},z$V._removeComponent=function(z$V,z$U){var z$r=this._typeComponentsIndices[z$V],z$s=z$r[z$U],z$p=this._components[z$s];this._components.splice(z$s,1),z$r.splice(z$U,1),0===z$r.length&&(this._typeComponentsIndices.splice(z$V,1),this._componentsMap.splice(z$V,1));for(var z$c=0,z$R=this._componentsMap.length;z$c<z$R;z$c++)for(var z$T=(z$r=this._typeComponentsIndices[z$c]).length-1;0<=z$T;z$T--){var z$N=z$r[z$T];if(!(z$s<z$N))break;z$r[z$T]=--z$N}z$p._destroy()},z$V._getComponentByType=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r=this._componentsMap.indexOf(z$V);return-1===z$r?null:this._components[this._typeComponentsIndices[z$r][z$U]]},z$V._getComponentsByType=function(z$V,z$U){var z$r=this._componentsMap.indexOf(z$V);if(-1!==z$r){var z$s=this._typeComponentsIndices[z$r],z$p=z$s.length;z$U.length=z$p;for(var z$c=0;z$c<z$p;z$c++)z$U[z$c]=this._components[z$s[z$c]]}else z$U.length=0},z$V._getComponentByIndex=function(z$V){return this._components[z$V]},z$V._removeComponentByType=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r=this._componentsMap.indexOf(z$V);-1!==z$r&&this._removeComponent(z$r,z$U)},z$V._removeComponentsByType=function(z$V){var z$U=this._componentsMap.indexOf(z$V);if(-1!==z$U)for(var z$r=this._typeComponentsIndices[z$U],z$s=0,z$p=z$r.length;z$s<z$p;z$r.length<z$p?z$p--:z$s++)this._removeComponent(z$U,z$s)},z$V._removeAllComponent=function(){for(var z$V=0,z$U=this._componentsMap.length;z$V<z$U;this._componentsMap.length<z$U?z$U--:z$V++)this._removeComponentsByType(this._componentsMap[z$V])},z$V._updateComponents=function(z$V){for(var z$U=0,z$r=this._components.length;z$U<z$r;z$U++){var z$s=this._components[z$U];!z$s.started&&(z$s._start(z$V),z$s.started=!0),z$s.enable&&z$s._update(z$V)}},z$V._lateUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._lateUpdate(z$V)}},z$V._preRenderUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._preRenderUpdate(z$V)}},z$V._postRenderUpdateComponents=function(z$V){for(var z$U=0;z$U<this._components.length;z$U++){var z$r=this._components[z$U];!z$r.started&&(z$r._start(z$V),z$r.started=!0),z$r.enable&&z$r._postRenderUpdate(z$V)}},z$q(0,z$V,"_loaded",null,function(z$V){this.__loaded=z$V}),z$q(0,z$V,"fogColor",function(){return this._fogColor},function(z$V){this._fogColor=z$V,this._shaderValues.setValue(0,z$V.elements)}),z$q(0,z$V,"enableFog",function(){return this._enableFog},function(z$V){this._enableFog!==z$V&&((this._enableFog=z$V)?(this.addShaderDefine(z$DU.SHADERDEFINE_FOG),this.removeShaderDefine(z$DU.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(z$DU.SHADERDEFINE_FOG))}),z$q(0,z$V,"url",function(){return this._url}),z$q(0,z$V,"loaded",function(){return this.__loaded}),z$q(0,z$V,"enableDepthFog",function(){return this._enableDepthFog},function(z$V){this._enableDepthFog!=z$V&&((this._enableDepthFog=z$V)?(this.addShaderDefine(z$DU.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(z$DU.SHADERDEFINE_FOG)):this.removeShaderDefine(z$DU.SAHDERDEFINE_DEPTHFOG))}),z$q(0,z$V,"fogStart",function(){return this._fogStart},function(z$V){this._fogStart=z$V,this._shaderValues.setValue(1,z$V)}),z$q(0,z$V,"fogRange",function(){return this._fogRange},function(z$V){this._fogRange=z$V,this._shaderValues.setValue(2,z$V)}),z$q(0,z$V,"ambientColor",function(){return this._ambientColor},function(z$V){this._ambientColor=z$V,this._shaderValues.setValue(21,z$V.elements)}),z$q(0,z$V,"scene",function(){return this}),z$q(0,z$V,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),z$s._sortScenes=function(z$V,z$U){if(z$V.parent!==z$d.stage||z$U.parent!==z$d.stage)return z$V.parent!==z$d.stage&&z$U.parent!==z$d.stage?z$s._sortScenes(z$V.parent,z$U.parent):z$V.parent===z$d.stage?-1:1;var z$r=z$d.stage._childs;return z$r.indexOf(z$V)-z$r.indexOf(z$U)},z$s.load=function(z$V){return z$d.loader.create(z$V,null,null,z$s)},z$s.FOGCOLOR=0,z$s.FOGSTART=1,z$s.FOGRANGE=2,z$s.LIGHTDIRECTION=3,z$s.LIGHTDIRCOLOR=4,z$s.POINTLIGHTPOS=5,z$s.POINTLIGHTRANGE=6,z$s.POINTLIGHTATTENUATION=7,z$s.POINTLIGHTCOLOR=8,z$s.SPOTLIGHTPOS=9,z$s.SPOTLIGHTDIRECTION=10,z$s.SPOTLIGHTSPOT=11,z$s.SPOTLIGHTRANGE=12,z$s.SPOTLIGHTATTENUATION=13,z$s.SPOTLIGHTCOLOR=14,z$s.SHADOWDISTANCE=15,z$s.SHADOWLIGHTVIEWPROJECT=16,z$s.SHADOWMAPPCFOFFSET=17,z$s.SHADOWMAPTEXTURE1=18,z$s.SHADOWMAPTEXTURE2=19,z$s.SHADOWMAPTEXTURE3=20,z$s.AMBIENTCOLOR=21,z$s.TIME=22,z$s}(z$y),z$aU=function(z$V){function z$U(z$V){z$U.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new z$VU,this._shaderValues=new z$_U,this._colliders=[],this._id=++z$U._uniqueIDCounter,this._transform=new z$kU(this),this.name=z$V||"Sprite3D-"+z$U._nameNumberCounter++,this.layer=z$K.currentCreationLayer,this.active=!0}z$G(z$U,"laya.d3.core.Sprite3D",z$QU);var z$r=z$U.prototype;return z$d.imps(z$r,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),z$r._setUrl=function(z$V){this._url=z$V},z$r._getGroup=function(){return this._group},z$r._setGroup=function(z$V){this._group=z$V},z$r._addChild3D=function(z$V){z$V.transform.parent=this.transform,this._hierarchyAnimator&&(!z$V._hierarchyAnimator&&z$V._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(z$V,!0,[z$V.name])),this._scene&&(z$V._setBelongScene(this._scene),this._activeInHierarchy&&z$V._active&&z$V._activeHierarchy())},z$r._removeChild3D=function(z$V){z$V.transform.parent=null,this._scene&&(this._activeInHierarchy&&z$V._active&&z$V._inActiveHierarchy(),z$V._setUnBelongScene()),this._hierarchyAnimator&&(z$V._hierarchyAnimator==this._hierarchyAnimator&&z$V._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(z$V,!1,[z$V.name]))},z$r._parseBaseCustomProps=function(z$V){var z$U=this.transform.localPosition;z$V.translate?(z$U.fromArray(z$V.translate),z$U.x*=100,z$U.y*=100,z$U.z*=100):z$U.elements.fill(0),this.transform.localPosition=z$U;var z$r=this.transform.localRotation;z$V.rotation?z$r.fromArray(z$V.rotation):z$r.fromArray([0,0,0,-1]),this.transform.localRotation=z$r;var z$s=this.transform.localScale;z$V.scale?z$s.fromArray(z$V.scale):z$s.elements.fill(1),this.transform.localScale=z$s;var z$p=z$V.layer;null!=z$p&&(this.layer=z$K.getLayerByNumber(z$p))},z$r._parseCustomComponent=function(z$V,z$U,z$r){for(var z$s in z$r){var z$p=z$r[z$s];switch(z$s){case"Animator":var z$c=this.addComponent(Animator);if(z$p.avatarPath)z$c.avatar=z$l.getRes(z$U[z$p.avatarPath]);else{var z$R=z$p.avatar;if(z$R){z$c.avatar=z$l.getRes(z$U[z$R.path]);var z$T=z$R.linkSprites;z$T&&z$V.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[z$c,z$T])}}for(var z$N=z$p.clipPaths,z$t=z$N.length,z$b=0;z$b<z$t;z$b++)z$c.addClip(z$l.getRes(z$U[z$N[z$b]]));z$c.clip=z$l.getRes(z$U[z$N[0]]);var z$S=z$p.playOnWake;void 0!==z$S&&(z$c.playOnWake=z$S);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var z$_=this.addComponent(SphereCollider);z$_.isTrigger=z$p.isTrigger;var z$G=z$_.center;z$G.fromArray(z$p.center),z$_.center=z$G,z$_.radius=z$p.radius;break;case"BoxCollider":var z$q=this.addComponent(BoxCollider);z$q.isTrigger=z$p.isTrigger,z$q.center.fromArray(z$p.center);var z$u=z$q.size;z$u.fromArray(z$p.size),z$q.size=z$u;break;case"MeshCollider":this.addComponent(MeshCollider)}}},z$r._onRootNodeHierarchyLoaded=function(z$V,z$U){for(var z$r in z$U){for(var z$s=this,z$p=z$U[z$r],z$c=0,z$R=z$p.length;z$c<z$R;z$c++){var z$T=z$p[z$c];if(""===z$T)break;if(!(z$s=z$s.getChildByName(z$T)))break}z$s&&z$V.linkSprite3DToAvatarNode(z$r,z$s)}},z$r._setHierarchyAnimator=function(z$V,z$U){this._changeHierarchyAnimator(z$V);for(var z$r=0,z$s=this._childs.length;z$r<z$s;z$r++){var z$p=this._childs[z$r];z$p._hierarchyAnimator==z$U&&z$p._setHierarchyAnimator(z$V,z$U)}},z$r._clearHierarchyAnimator=function(z$V,z$U){this._changeHierarchyAnimator(z$U);for(var z$r=0,z$s=this._childs.length;z$r<z$s;z$r++){var z$p=this._childs[z$r];z$p._hierarchyAnimator==z$V&&z$p._clearHierarchyAnimator(z$V,z$U)}},z$r._getAnimatorToLinkSprite3D=function(z$V,z$U,z$r){var z$s=this.getComponentByType(Animator);if(z$s&&(z$s.avatar?z$s.avatar._version||z$V._setAnimatorToLinkAvatar(z$s,z$U):z$V._setAnimatorToLinkSprite3DNoAvatar(z$s,z$U,z$r)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){z$r.unshift(this._parent.name);var z$p=this._parent;z$p._hierarchyAnimator&&z$p._getAnimatorToLinkSprite3D(z$V,z$U,z$r)}},z$r._setAnimatorToLinkSprite3DNoAvatar=function(z$V,z$U,z$r){var z$s=0,z$p=0;for(z$s=0,z$p=z$V.getClipCount();z$s<z$p;z$s++)z$V._handleSpriteOwnersBySprite(z$s,z$U,z$r,this);for(z$s=0,z$p=this._childs.length;z$s<z$p;z$s++){var z$c=this._childs[z$s],z$R=z$r.length;z$r.push(z$c.name),z$c._setAnimatorToLinkSprite3DNoAvatar(z$V,z$U,z$r),z$r.splice(z$R,1)}},z$r._changeHierarchyAnimator=function(z$V){this._hierarchyAnimator=z$V},z$r._isLinkSpriteToAnimationNode=function(z$V,z$U,z$r){var z$s=z$V._avatarNodes.indexOf(z$U),z$p=z$V._cacheSpriteToNodesMap;if(z$r)this._transform.dummy=z$U.transform,z$V._cacheNodesToSpriteMap[z$s]=z$p.length,z$p.push(z$s);else{this._transform.dummy=null;var z$c=z$V._cacheNodesToSpriteMap[z$s];z$V._cacheNodesToSpriteMap[z$s]=null,z$p.splice(z$c,1)}},z$r._setBelongScene=function(z$V){this._scene=z$V;for(var z$U=0,z$r=this._childs.length;z$U<z$r;z$U++)this._childs[z$U]._setBelongScene(z$V)},z$r._setUnBelongScene=function(){this._scene=null;for(var z$V=0,z$U=this._childs.length;z$V<z$U;z$V++)this._childs[z$V]._setUnBelongScene()},z$r._activeHierarchy=function(){var z$V=0,z$U=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),z$V=0,z$U=this._colliders.length;z$V<z$U;z$V++)this._layer._addCollider(this._colliders[z$V]);for(this.event("activeinhierarchychanged",!0),z$V=0,z$U=this._childs.length;z$V<z$U;z$V++){var z$r=this._childs[z$V];z$r._active&&z$r._activeHierarchy()}},z$r._inActiveHierarchy=function(){var z$V=0,z$U=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),z$V=0,z$U=this._colliders.length;z$V<z$U;z$V++){var z$r=this._colliders[z$V];z$r._clearCollsionMap(),this._layer._removeCollider(z$r)}for(this.event("activeinhierarchychanged",!1),z$V=0,z$U=this._childs.length;z$V<z$U;z$V++){var z$s=this._childs[z$V];z$s._active&&z$s._inActiveHierarchy()}},z$r.addComponent=function(z$V){var z$U,z$r=this._componentsMap.indexOf(z$V);if(-1===z$r)z$U=[],this._componentsMap.push(z$V),this._typeComponentsIndices.push(z$U);else if(z$U=this._typeComponentsIndices[z$r],this._components[z$U[0]].isSingleton)throw new Error("无法单实例创建"+z$V+"组件，"+z$V+"组件已存在！");var z$s=z$p.getInstance(z$V);return z$U.push(this._components.length),this._components.push(z$s),z$s instanceof laya.d3.component.Script&&this._scripts.push(z$s),z$s._initialize(this),z$s},z$r._removeComponent=function(z$V,z$U){var z$r,z$s=0,z$p=this._typeComponentsIndices[z$V],z$c=z$p[z$U],z$R=this._components[z$c];for(z$R instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(z$R),1),z$p.splice(z$U,1),0===z$p.length&&(this._typeComponentsIndices.splice(z$V,1),this._componentsMap.splice(z$V,1)),z$s=0,z$r=this._componentsMap.length;z$s<z$r;z$s++)for(var z$T=(z$p=this._typeComponentsIndices[z$s]).length-1;0<=z$T;z$T--){var z$N=z$p[z$T];if(!(z$c<z$N))break;z$p[z$T]=--z$N}z$R._destroy()},z$r._clearSelfRenderObjects=function(){},z$r._addSelfRenderObjects=function(){},z$r._parseCustomProps=function(z$V,z$U,z$r,z$s){},z$r._updateChilds=function(z$V){var z$U=this._childs.length;if(0!==z$U)for(var z$r=0;z$r<z$U;++z$r)this._childs[z$r]._update(z$V)},z$r._getSortID=function(z$V,z$U){return 1e3*z$U.id+z$V._getVertexBuffer().vertexDeclaration.id},z$r._update=function(z$V){(z$V.owner=this)._activeInHierarchy&&(this._updateComponents(z$V),this._lateUpdateComponents(z$V),z$D.spriteCount++,this._childs.length&&this._updateChilds(z$V))},z$r.getProjectionViewWorldMatrix=function(z$V){return z$VU.multiply(z$V,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},z$r.loadHierarchy=function(z$V){this.addChild(laya.d3.core.Sprite3D.load(z$V))},z$r.addChildAt=function(z$V,z$U){if(!(z$V instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),0<=z$U&&z$U<=this._childs.length){if(z$V._parent===this){var z$r=this.getChildIndex(z$V);this._childs.splice(z$r,1),this._childs.splice(z$U,0,z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,z$U)),this._childChanged()}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$t.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(z$U,0,z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,z$U),(z$V.parent=this)._addChild3D(z$V);return z$V}throw new Error("appendChildAt:The index is out of bounds")},z$r.addChild=function(z$V){if(!(z$V instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!z$V||this.destroyed||z$V===this)return z$V;if(z$V.zOrder&&this._set$P("hasZorder",!0),z$V._parent===this){var z$U=this.getChildIndex(z$V);z$U!==this._childs.length-1&&(this._childs.splice(z$U,1),this._childs.push(z$V),this.conchModel&&(this.conchModel.removeChild(z$V.conchModel),this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1)),this._childChanged())}else z$V.parent&&z$V.parent.removeChild(z$V),this._childs===z$t.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(z$V),this.conchModel&&this.conchModel.addChildAt(z$V.conchModel,this._childs.length-1),(z$V.parent=this)._childChanged(),this._addChild3D(z$V);return z$V},z$r.removeChildAt=function(z$V){var z$U=this.getChildAt(z$V);return z$U&&(this._removeChild3D(z$U),this._childs.splice(z$V,1),this.conchModel&&this.conchModel.removeChild(z$U.conchModel),z$U.parent=null),z$U},z$r.removeChildren=function(z$V,z$U){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=2147483647),this._childs&&0<this._childs.length){var z$r=this._childs;if(0===z$V&&z$c<=z$U){var z$s=z$r;this._childs=z$t.ARRAY_EMPTY}else z$s=z$r.splice(z$V,z$U-z$V);for(var z$p=0,z$c=z$s.length;z$p<z$c;z$p++)this._removeChild3D(z$s[z$p]),z$s[z$p].parent=null,this.conchModel&&this.conchModel.removeChild(z$s[z$p].conchModel)}return this},z$r.onAsynLoaded=function(z$V,z$U,z$r){var z$s=z$U[0];if("Sprite3D"!==z$s.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var z$p=z$U[1];z$hU._createNodeByJson(this,z$s,this,z$p),this.event("hierarchyloaded",[this]),this.__loaded=!0},z$r.cloneTo=function(z$V){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var z$U=z$V;z$U.name=this.name,z$U._destroyed=this._destroyed,z$U.timer=this.timer,z$U._$P=this._$P,z$U.active=this._active;var z$r=z$U.transform.localPosition;this.transform.localPosition.cloneTo(z$r),z$U.transform.localPosition=z$r;var z$s=z$U.transform.localRotation;this.transform.localRotation.cloneTo(z$s),z$U.transform.localRotation=z$s;var z$p=z$U.transform.localScale;this.transform.localScale.cloneTo(z$p),z$U.transform.localScale=z$p,z$U.isStatic=this.isStatic;var z$c=0,z$R=0;for(z$c=0,z$R=this._componentsMap.length;z$c<z$R;z$c++){var z$T=z$U.addComponent(this._componentsMap[z$c]);this._components[z$c]._cloneTo(z$T)}for(z$c=0,z$R=this._childs.length;z$c<z$R;z$c++)z$U.addChild(this._childs[z$c].clone());var z$N=z$U.getComponentByType(Animator);if(z$N){var z$t=z$N._linkSpritesData;if(z$t)for(var z$b in z$t){for(var z$S=z$t[z$b],z$_=z$U,z$G=0,z$q=z$S.length;z$G<z$q&&(z$_=z$_.getChildByName(z$S[z$G]));z$G++);if(z$_){var z$u=z$N._avatarNodeMap[z$b];z$_._isLinkSpriteToAnimationNode(z$N,z$u,!0)}}}},z$r.clone=function(){var z$V=new this.constructor;return this.cloneTo(z$V),z$V},z$r.destroy=function(z$V){if(void 0===z$V&&(z$V=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,z$V);var z$U,z$r=0;for(z$r=0,z$U=this._components.length;z$r<z$U;z$r++)this._components[z$r]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,z$l.clearRes(this.url),this.loaded||z$lU._cancelLoadByUrl(this.url)}},z$r._handleSpriteToAvatar=function(z$V,z$U){z$V._avatarNodes;var z$r=z$V._avatarNodeMap[this.name];z$r&&z$r.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(z$V,z$r,z$U)},z$r._setAnimatorToLinkAvatar=function(z$V,z$U){this._handleSpriteToAvatar(z$V,z$U);for(var z$r=0,z$s=this._childs.length;z$r<z$s;z$r++){this._childs[z$r]._setAnimatorToLinkAvatar(z$V,z$U)}},z$q(0,z$r,"activeInHierarchy",function(){return this._activeInHierarchy}),z$q(0,z$r,"_loaded",null,function(z$V){this.__loaded=z$V}),z$q(0,z$r,"active",function(){return this._active},function(z$V){this._active!==z$V&&(this._active=z$V,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(z$V?this._activeHierarchy():this._inActiveHierarchy()))}),z$q(0,z$r,"componentsCount",function(){return this._components.length}),z$q(0,z$r,"loaded",function(){return this.__loaded}),z$q(0,z$r,"id",function(){return this._id}),z$q(0,z$r,"url",function(){return this._url}),z$q(0,z$r,"layer",function(){return this._layer},function(z$V){if(this._layer!==z$V){if(!z$V)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var z$U=0,z$r=this._colliders.length;if(this._layer)for(z$U=0;z$U<z$r;z$U++)this._layer._removeCollider(this._colliders[z$U]);for(z$U=0;z$U<z$r;z$U++)z$V._addCollider(this._colliders[z$U])}this._layer=z$V,this.event("layerchanged",z$V)}}),z$q(0,z$r,"scene",function(){return this._scene}),z$q(0,z$r,"transform",function(){return this._transform}),z$U.instantiate=function(z$V,z$U,z$r,z$s,z$p){void 0===z$r&&(z$r=!0);var z$c=z$V.clone();z$U&&z$U.addChild(z$c);var z$R=z$c.transform;if(z$r){var z$T=z$R.worldMatrix;z$V.transform.worldMatrix.cloneTo(z$T),z$R.worldMatrix=z$T}else z$s&&(z$R.position=z$s),z$p&&(z$R.rotation=z$p);return z$c},z$U.load=function(z$V){return z$d.loader.create(z$V,null,null,z$U)},z$U.WORLDMATRIX=0,z$U.MVPMATRIX=1,z$U._uniqueIDCounter=0,z$U._nameNumberCounter=0,z$U}(),z$ZU=function(z$V){function z$b(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],z$b.__super.call(this),!z$V||!z$U)throw"Shader Error";this._id=++z$b._count,this._vs=z$V,this._ps=z$U,this._attributeMap=z$r,this._sceneUniformMap=z$s,this._cameraUniformMap=z$p,this._spriteUniformMap=z$c,this._materialUniformMap=z$R,this._renderElementUniformMap=z$T,this._precompile=z$N,this._define=z$t,this._precompile&&z$b.extCompileObj&&z$b.extCompileFunc?z$b.extCompileFunc.call(z$b.extCompileObj,z$V,z$U,z$t):this.recreateResource()}z$G(z$b,"laya.d3.shader.Shader3D",z$r);var z$U=z$b.prototype;return z$U.recreateResource=function(){z$E.now();this._compile(),this.completeCreate(),this.memorySize=0},z$U.disposeResource=function(){z$w.mainContext.deleteShader(this._vshader),z$w.mainContext.deleteShader(this._pshader),z$w.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},z$U._compile=function(){if(!z$w.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var z$V=[this._vs,this._ps],z$U=z$w.mainContext;if(this._program=z$U.createProgram(),this._vshader=z$b._createShader(z$U,z$V[0],35633),this._pshader=z$b._createShader(z$U,z$V[1],35632),z$U.attachShader(this._program,this._vshader),z$U.attachShader(this._program,this._pshader),z$U.linkProgram(this._program),!z$u.isConchApp&&z$DU.debugMode&&!z$U.getProgramParameter(this._program,35714))throw z$U.getProgramInfoLog(this._program);var z$r,z$s=0,z$p=0,z$c=0;for(z$c=z$u.isConchApp?z$U.getProgramParameterEx(this._vs,this._ps,"",35721):z$U.getProgramParameter(this._program,35721),z$s=0;z$s<z$c;z$s++){var z$R=null;z$r={vartype:"attribute",ivartype:0,attrib:z$R=z$u.isConchApp?z$U.getActiveAttribEx(this._vs,this._ps,"",z$s):z$U.getActiveAttrib(this._program,z$s),location:z$U.getAttribLocation(this._program,z$R.name),name:z$R.name,type:z$R.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(z$r)}var z$T=0;for(z$T=z$u.isConchApp?z$U.getProgramParameterEx(this._vs,this._ps,"",35718):z$U.getProgramParameter(this._program,35718),z$s=0;z$s<z$T;z$s++){var z$N=null;z$N=z$u.isConchApp?z$U.getActiveUniformEx(this._vs,this._ps,"",z$s):z$U.getActiveUniform(this._program,z$s),0<(z$r={vartype:"uniform",ivartype:1,attrib:z$R,location:z$U.getUniformLocation(this._program,z$N.name),name:z$N.name,type:z$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(z$r.name=z$r.name.substr(0,z$r.name.length-3),z$r.isArray=!0,z$r.location=z$U.getUniformLocation(this._program,z$r.name)),this._uniformParams.push(z$r)}for(z$s=0,z$p=this._attributeParams.length;z$s<z$p;z$s++)(z$r=this._attributeParams[z$s]).indexOfParams=z$s,z$r.index=1,z$r.value=[z$r.location,null],z$r.codename=z$r.name,z$r.name=null!=this._attributeMap[z$r.codename]?this._attributeMap[z$r.codename]:z$r.codename,this._attributeParamsMap.push(z$r.name),this._attributeParamsMap.push(z$r),z$r._this=this,z$r.uploadedValue=[],z$r.fun=this._attribute;for(z$s=0,z$p=this._uniformParams.length;z$s<z$p;z$s++)switch((z$r=this._uniformParams[z$s]).indexOfParams=z$s,z$r.index=1,z$r.value=[z$r.location,null],z$r.codename=z$r.name,null!=this._sceneUniformMap[z$r.codename]?(z$r.name=this._sceneUniformMap[z$r.codename],this._sceneUniformParamsMap.push(z$r.name),this._sceneUniformParamsMap.push(z$r)):null!=this._cameraUniformMap[z$r.codename]?(z$r.name=this._cameraUniformMap[z$r.codename],this._cameraUniformParamsMap.push(z$r.name),this._cameraUniformParamsMap.push(z$r)):null!=this._spriteUniformMap[z$r.codename]?(z$r.name=this._spriteUniformMap[z$r.codename],this._spriteUniformParamsMap.push(z$r.name),this._spriteUniformParamsMap.push(z$r)):null!=this._materialUniformMap[z$r.codename]?(z$r.name=this._materialUniformMap[z$r.codename],this._materialUniformParamsMap.push(z$r.name),this._materialUniformParamsMap.push(z$r)):null!=this._renderElementUniformMap[z$r.codename]?(z$r.name=this._renderElementUniformMap[z$r.codename],this._renderElementUniformParamsMap.push(z$r.name),this._renderElementUniformParamsMap.push(z$r)):console.log("Shader:can't find uinform name:"+z$r.codename+" in shader file."),z$r._this=this,z$r.uploadedValue=[],z$r.type){case 5124:z$r.fun=z$r.isArray?this._uniform1iv:this._uniform1i;break;case 5126:z$r.fun=z$r.isArray?this._uniform1fv:this._uniform1f;break;case 35664:z$r.fun=z$r.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:z$r.fun=z$r.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:z$r.fun=z$r.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:z$r.fun=this._uniform_sampler2D;break;case 35680:z$r.fun=this._uniform_samplerCube;break;case 35676:z$r.fun=this._uniformMatrix4fv;break;case 35670:z$r.fun=this._uniform1i;break;case 35674:z$r.fun=this._uinformMatrix2fv;break;case 35675:z$r.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},z$U._attribute=function(z$V,z$U){var z$r=z$w.mainContext,z$s=z$T._enableAtributes,z$p=z$V.location;return z$s[z$p]||z$r.enableVertexAttribArray(z$p),z$r.vertexAttribPointer(z$p,z$U[0],z$U[1],z$U[2],z$U[3],z$U[4]),z$s[z$p]=z$T._bindVertexBuffer,1},z$U._uniform1f=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U?(z$w.mainContext.uniform1f(z$V.location,z$r[0]=z$U),1):0},z$U._uniform1fv=function(z$V,z$U){if(z$U.length<4){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$w.mainContext.uniform1fv(z$V.location,z$U),z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3],1):0}return z$w.mainContext.uniform1fv(z$V.location,z$U),1},z$U._uniform_vec2=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]?(z$w.mainContext.uniform2f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1]),1):0},z$U._uniform_vec2v=function(z$V,z$U){if(z$U.length<2){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$w.mainContext.uniform2fv(z$V.location,z$U),z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3],1):0}return z$w.mainContext.uniform2fv(z$V.location,z$U),1},z$U._uniform_vec3=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]?(z$w.mainContext.uniform3f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2]),1):0},z$U._uniform_vec3v=function(z$V,z$U){return z$w.mainContext.uniform3fv(z$V.location,z$U),1},z$U._uniform_vec4=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$w.mainContext.uniform4f(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3]),1):0},z$U._uniform_vec4v=function(z$V,z$U){return z$w.mainContext.uniform4fv(z$V.location,z$U),1},z$U._uniformMatrix2fv=function(z$V,z$U){return z$w.mainContext.uniformMatrix2fv(z$V.location,!1,z$U),1},z$U._uniformMatrix3fv=function(z$V,z$U){return z$w.mainContext.uniformMatrix3fv(z$V.location,!1,z$U),1},z$U._uniformMatrix4fv=function(z$V,z$U){return z$w.mainContext.uniformMatrix4fv(z$V.location,!1,z$U),1},z$U._uinformMatrix2fv=function(z$V,z$U){return z$w.mainContext.uniformMatrix2fv(z$V.location,!1,z$U),1},z$U._uinformMatrix3fv=function(z$V,z$U){return z$w.mainContext.uniformMatrix3fv(z$V.location,!1,z$U),1},z$U._uniform1i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U?(z$w.mainContext.uniform1i(z$V.location,z$r[0]=z$U),1):0},z$U._uniform1iv=function(z$V,z$U){return z$w.mainContext.uniform1iv(z$V.location,z$U),1},z$U._uniform_ivec2=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]?(z$w.mainContext.uniform2i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1]),1):0},z$U._uniform_ivec2v=function(z$V,z$U){return z$w.mainContext.uniform2iv(z$V.location,z$U),1},z$U._uniform_vec3i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]?(z$w.mainContext.uniform3i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2]),1):0},z$U._uniform_vec3vi=function(z$V,z$U){return z$w.mainContext.uniform3iv(z$V.location,z$U),1},z$U._uniform_vec4i=function(z$V,z$U){var z$r=z$V.uploadedValue;return z$r[0]!==z$U[0]||z$r[1]!==z$U[1]||z$r[2]!==z$U[2]||z$r[3]!==z$U[3]?(z$w.mainContext.uniform4i(z$V.location,z$r[0]=z$U[0],z$r[1]=z$U[1],z$r[2]=z$U[2],z$r[3]=z$U[3]),1):0},z$U._uniform_vec4vi=function(z$V,z$U){return z$w.mainContext.uniform4iv(z$V.location,z$U),1},z$U._uniform_sampler2D=function(z$V,z$U){var z$r=z$U.source||z$U.defaulteTexture.source,z$s=z$w.mainContext,z$p=z$V.uploadedValue;if(null!=z$p[0])return z$s.activeTexture(z$b._TEXTURES[z$p[0]]),z$r&&z$z.bindTexture(z$s,3553,z$r),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return z$p[0]=this._curActTexIndex,z$s.uniform1i(z$V.location,this._curActTexIndex),z$s.activeTexture(z$b._TEXTURES[this._curActTexIndex]),z$r&&z$z.bindTexture(z$s,3553,z$r),this._curActTexIndex++,1},z$U._uniform_samplerCube=function(z$V,z$U){var z$r=z$U.source||z$U.defaulteTexture.source,z$s=z$w.mainContext,z$p=z$V.uploadedValue;if(null!=z$p[0])return z$s.activeTexture(z$b._TEXTURES[z$p[0]]),z$r?z$z.bindTexture(z$s,34067,z$r):z$z.bindTexture(z$s,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return z$p[0]=this._curActTexIndex,z$s.uniform1i(z$V.location,this._curActTexIndex),z$s.activeTexture(z$b._TEXTURES[this._curActTexIndex]),z$r?z$z.bindTexture(z$s,34067,z$r):z$z.bindTexture(z$s,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},z$U._noSetValue=function(z$V){console.log("no....:"+z$V.name)},z$U.bind=function(){return z$r.activeShader=this,(z$r.bindShader=this).activeResource(),z$z.UseProgram(this._program)},z$U.uploadAttributes=function(z$V,z$U){for(var z$r,z$s,z$p=0,z$c=0,z$R=this._attributeParamsMap.length;z$c<z$R;z$c+=2)z$s=this._attributeParamsMap[z$c+1],null!=(z$r=z$V[this._attributeParamsMap[z$c]])&&(z$U&&z$U[z$s.name]&&z$U[z$s.name].bind(),z$p+=z$s.fun.call(this,z$s,z$r));z$D.shaderCall+=z$p},z$U.uploadAttributesX=function(z$V,z$U){for(var z$r,z$s,z$p=0,z$c=0,z$R=this._attributeParamsMap.length;z$c<z$R;z$c+=2)z$s=this._attributeParamsMap[z$c+1],null!=(z$r=z$V[this._attributeParamsMap[z$c]])&&(z$U._bind(),z$p+=z$s.fun.call(this,z$s,z$r));z$D.shaderCall+=z$p},z$U.uploadSceneUniforms=function(z$V){for(var z$U,z$r,z$s=0,z$p=0,z$c=this._sceneUniformParamsMap.length;z$p<z$c;z$p+=2)z$r=this._sceneUniformParamsMap[z$p+1],null!=(z$U=z$V[this._sceneUniformParamsMap[z$p]])&&(z$s+=z$r.fun.call(this,z$r,z$U));z$D.shaderCall+=z$s},z$U.uploadCameraUniforms=function(z$V){for(var z$U,z$r,z$s=0,z$p=0,z$c=this._cameraUniformParamsMap.length;z$p<z$c;z$p+=2)z$r=this._cameraUniformParamsMap[z$p+1],null!=(z$U=z$V[this._cameraUniformParamsMap[z$p]])&&(z$s+=z$r.fun.call(this,z$r,z$U));z$D.shaderCall+=z$s},z$U.uploadSpriteUniforms=function(z$V){for(var z$U,z$r,z$s=0,z$p=0,z$c=this._spriteUniformParamsMap.length;z$p<z$c;z$p+=2)z$r=this._spriteUniformParamsMap[z$p+1],null!=(z$U=z$V[this._spriteUniformParamsMap[z$p]])&&(z$s+=z$r.fun.call(this,z$r,z$U));z$D.shaderCall+=z$s},z$U.uploadMaterialUniforms=function(z$V){for(var z$U,z$r,z$s=0,z$p=0,z$c=this._materialUniformParamsMap.length;z$p<z$c;z$p+=2)z$r=this._materialUniformParamsMap[z$p+1],null!=(z$U=z$V[this._materialUniformParamsMap[z$p]])&&(z$s+=z$r.fun.call(this,z$r,z$U));z$D.shaderCall+=z$s},z$U.uploadRenderElementUniforms=function(z$V){for(var z$U,z$r,z$s=0,z$p=0,z$c=this._renderElementUniformParamsMap.length;z$p<z$c;z$p+=2)z$r=this._renderElementUniformParamsMap[z$p+1],null!=(z$U=z$V[this._renderElementUniformParamsMap[z$p]])&&(z$s+=z$r.fun.call(this,z$r,z$U));z$D.shaderCall+=z$s},z$b.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return new z$b(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t)},z$b.addInclude=function(z$V,z$U){z$O.addInclude(z$V,z$U)},z$b._createShader=function(z$V,z$U,z$r){var z$s=z$V.createShader(z$r);if(z$V.shaderSource(z$s,z$U),z$V.compileShader(z$s),z$DU.debugMode&&!z$V.getShaderParameter(z$s,35713))throw z$V.getShaderInfoLog(z$s);return z$s},z$b.PERIOD_RENDERELEMENT=0,z$b.PERIOD_MATERIAL=1,z$b.PERIOD_SPRITE=2,z$b.PERIOD_CAMERA=3,z$b.PERIOD_SCENE=4,z$b._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],z$b._count=0,z$b._preCompile=!1,z$b.extCompileFunc=null,z$b.extCompileObj=null,z$S(z$b,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new z$n}]),z$b}(),z$xU=function(z$T){function z$N(){this._transformUV=null,z$N.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new z$RU(.6,.6,.6)),this._setColor(10,new z$RU(1,1,1)),this._setColor(11,new z$TU(1,1,1,8)),this._setColor(12,new z$RU(1,1,1)),this._setColor(7,new z$TU(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new z$TU(1,1,0,0)),this.renderMode=1}z$G(z$N,"laya.d3.core.material.StandardMaterial",z$T);var z$V=z$N.prototype;return z$V.disableLight=function(){this._addDisablePublicShaderDefine(z$DU.SHADERDEFINE_POINTLIGHT|z$DU.SHADERDEFINE_SPOTLIGHT|z$DU.SHADERDEFINE_DIRECTIONLIGHT)},z$V.disableFog=function(){this._addDisablePublicShaderDefine(z$DU.SHADERDEFINE_FOG)},z$V.onAsynLoaded=function(z$V,z$U,z$r){var z$s=z$U[0];if(z$s.version)z$T.prototype.onAsynLoaded.call(this,z$V,z$U,z$r);else{var z$p=z$U[1],z$c=z$s.props;for(var z$R in z$c)this[z$R]=z$c[z$R];z$N._parseStandardMaterial(z$p,this,z$s),this._endLoaded()}},z$V.cloneTo=function(z$V){z$T.prototype.cloneTo.call(this,z$V);var z$U=z$V;this._transformUV&&(z$U._transformUV=this._transformUV.clone())},z$q(0,z$V,"ambientColor",function(){return this._getColor(9)},function(z$V){this._setColor(9,z$V)}),z$q(0,z$V,"ambientTexture",function(){return this._getTexture(5)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,z$V)}),z$q(0,z$V,"renderMode",null,function(z$V){switch(z$V){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(z$N.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(z$V)}),z$q(0,z$V,"reflectColor",function(){return this._getColor(12)},function(z$V){this._setColor(12,z$V)}),z$q(0,z$V,"tilingOffset",function(){return this._getColor(15)},function(z$V){if(z$V){var z$U=z$V.elements;1!=z$U[0]||1!=z$U[1]||0!=z$U[2]||0!=z$U[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,z$V)}),z$q(0,z$V,"albedo",function(){return this._getColor(7)},function(z$V){this._setColor(7,z$V)}),z$q(0,z$V,"diffuseColor",function(){return this._getColor(10)},function(z$V){this._setColor(10,z$V)}),z$q(0,z$V,"albedoColor",function(){return this._getColor(7)},function(z$V){this._setColor(7,z$V)}),z$q(0,z$V,"specularColor",function(){return this._getColor(11)},function(z$V){this._setColor(11,z$V)}),z$q(0,z$V,"diffuseTexture",function(){return this._getTexture(1)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,z$V)}),z$q(0,z$V,"normalTexture",function(){return this._getTexture(2)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,z$V)}),z$q(0,z$V,"specularTexture",function(){return this._getTexture(3)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,z$V)}),z$q(0,z$V,"emissiveTexture",function(){return this._getTexture(4)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,z$V)}),z$q(0,z$V,"reflectTexture",function(){return this._getTexture(6)},function(z$V){z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,z$V)}),z$q(0,z$V,"transformUV",function(){return this._transformUV},function(z$V){this._transformUV=z$V,this._setMatrix4x4(13,z$V.matrix),z$V?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,z$V.matrix.elements,0)}),z$N.__init__=function(){z$N.SHADERDEFINE_DIFFUSEMAP=z$N.shaderDefines.registerDefine("DIFFUSEMAP"),z$N.SHADERDEFINE_NORMALMAP=z$N.shaderDefines.registerDefine("NORMALMAP"),z$N.SHADERDEFINE_SPECULARMAP=z$N.shaderDefines.registerDefine("SPECULARMAP"),z$N.SHADERDEFINE_EMISSIVEMAP=z$N.shaderDefines.registerDefine("EMISSIVEMAP"),z$N.SHADERDEFINE_AMBIENTMAP=z$N.shaderDefines.registerDefine("AMBIENTMAP"),z$N.SHADERDEFINE_REFLECTMAP=z$N.shaderDefines.registerDefine("REFLECTMAP"),z$N.SHADERDEFINE_UVTRANSFORM=z$N.shaderDefines.registerDefine("UVTRANSFORM"),z$N.SHADERDEFINE_TILINGOFFSET=z$N.shaderDefines.registerDefine("TILINGOFFSET"),z$N.SHADERDEFINE_ADDTIVEFOG=z$N.shaderDefines.registerDefine("ADDTIVEFOG")},z$N.load=function(z$V){return z$d.loader.create(z$V,null,null,z$N)},z$N._parseStandardMaterial=function(z$V,z$U,z$r){var z$s=z$r.customProps,z$p=z$s.ambientColor;z$U.ambientColor=new z$RU(z$p[0],z$p[1],z$p[2]);var z$c=z$s.diffuseColor;z$U.diffuseColor=new z$RU(z$c[0],z$c[1],z$c[2]);var z$R=z$s.specularColor;z$U.specularColor=new z$TU(z$R[0],z$R[1],z$R[2],z$R[3]);var z$T=z$s.reflectColor;z$U.reflectColor=new z$RU(z$T[0],z$T[1],z$T[2]);var z$N=z$s.albedoColor;z$N&&(z$U.albedo=new z$TU(z$N[0],z$N[1],z$N[2],z$N[3]));var z$t=z$s.diffuseTexture.texture2D;z$t&&(z$U.diffuseTexture=z$l.getRes(z$V[z$t]));var z$b=z$s.normalTexture.texture2D;z$b&&(z$U.normalTexture=z$l.getRes(z$V[z$b]));var z$S=z$s.specularTexture.texture2D;z$S&&(z$U.specularTexture=z$l.getRes(z$V[z$S]));var z$_=z$s.emissiveTexture.texture2D;z$_&&(z$U.emissiveTexture=z$l.getRes(z$V[z$_]));var z$G=z$s.ambientTexture.texture2D;z$G&&(z$U.ambientTexture=z$l.getRes(z$V[z$G]));var z$q=z$s.reflectTexture.texture2D;z$q&&(z$U.reflectTexture=z$l.getRes(z$V[z$q]))},z$N.RENDERMODE_OPAQUE=1,z$N.RENDERMODE_OPAQUEDOUBLEFACE=2,z$N.RENDERMODE_CUTOUT=3,z$N.RENDERMODE_CUTOUTDOUBLEFACE=4,z$N.RENDERMODE_TRANSPARENT=13,z$N.RENDERMODE_TRANSPARENTDOUBLEFACE=14,z$N.RENDERMODE_ADDTIVE=15,z$N.RENDERMODE_ADDTIVEDOUBLEFACE=16,z$N.RENDERMODE_DEPTHREAD_TRANSPARENT=5,z$N.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,z$N.RENDERMODE_DEPTHREAD_ADDTIVE=7,z$N.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,z$N.RENDERMODE_NONDEPTH_TRANSPARENT=9,z$N.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,z$N.RENDERMODE_NONDEPTH_ADDTIVE=11,z$N.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,z$N.SHADERDEFINE_DIFFUSEMAP=0,z$N.SHADERDEFINE_NORMALMAP=0,z$N.SHADERDEFINE_SPECULARMAP=0,z$N.SHADERDEFINE_EMISSIVEMAP=0,z$N.SHADERDEFINE_AMBIENTMAP=0,z$N.SHADERDEFINE_REFLECTMAP=0,z$N.SHADERDEFINE_UVTRANSFORM=0,z$N.SHADERDEFINE_TILINGOFFSET=0,z$N.SHADERDEFINE_ADDTIVEFOG=0,z$N.DIFFUSETEXTURE=1,z$N.NORMALTEXTURE=2,z$N.SPECULARTEXTURE=3,z$N.EMISSIVETEXTURE=4,z$N.AMBIENTTEXTURE=5,z$N.REFLECTTEXTURE=6,z$N.ALBEDO=7,z$N.UVANIAGE=8,z$N.MATERIALAMBIENT=9,z$N.MATERIALDIFFUSE=10,z$N.MATERIALSPECULAR=11,z$N.MATERIALREFLECT=12,z$N.UVMATRIX=13,z$N.UVAGE=14,z$N.TILINGOFFSET=15,z$S(z$N,["defaultMaterial",function(){var z$V=new z$N;return z$V.lock=!0,this.defaultMaterial=z$V},"shaderDefines",function(){return this.shaderDefines=new z$bU(z$HU.shaderDefines)}]),z$N}(z$HU),z$$U=function(z$V){function z$R(z$V,z$U,z$r,z$s,z$p){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===z$r&&(z$r=35044),void 0===z$s&&(z$s=!1),z$R.__super.call(this),this._indexType=z$V,this._indexCount=z$U,this._bufferUsage=z$r,this._bufferType=34963,this._canRead=z$s;var z$c;if("ushort"==z$V)this._indexTypeByteCount=2;else{if("ubyte"!=z$V)throw new Error("unidentification index type.");this._indexTypeByteCount=1}z$c=this._indexTypeByteCount*z$U,this._byteLength=z$c,this._bind(),z$T._gl.bufferData(this._bufferType,z$c,this._bufferUsage),this.uri=z$p,z$s?("ushort"==z$V?this._buffer=new Uint16Array(z$U):"ubyte"==z$V&&(this._buffer=new Uint8Array(z$U)),this.memorySize=2*z$c):this.memorySize=z$c}z$G(z$R,"laya.d3.graphics.IndexBuffer3D",z$V);var z$U=z$R.prototype;return z$U.setData=function(z$V,z$U,z$r,z$s){void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=4294967295);var z$p=0;if("ushort"==this._indexType?(z$p=2,0===z$r&&4294967295===z$s||(z$V=new Uint16Array(z$V.buffer,z$r*z$p,z$s))):"ubyte"==this._indexType&&(z$p=1,0===z$r&&4294967295===z$s||(z$V=new Uint8Array(z$V.buffer,z$r*z$p,z$s))),this._bind(),z$T._gl.bufferSubData(this._bufferType,z$U*z$p,z$V),this._canRead)if(0!==z$U||0!==z$r||4294967295!==z$s){var z$c=this._buffer.length-z$U;z$c<z$s&&(z$s=z$c);for(var z$R=0;z$R<z$s;z$R++)this._buffer[z$U+z$R]=z$V[z$R]}else this._buffer=z$V},z$U.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},z$U.disposeResource=function(){z$V.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},z$q(0,z$U,"indexType",function(){return this._indexType}),z$q(0,z$U,"indexTypeByteCount",function(){return this._indexTypeByteCount}),z$q(0,z$U,"indexCount",function(){return this._indexCount}),z$q(0,z$U,"canRead",function(){return this._canRead}),z$R.INDEXTYPE_UBYTE="ubyte",z$R.INDEXTYPE_USHORT="ushort",z$R.create=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$r&&(z$r=35044),void 0===z$s&&(z$s=!1),new z$R(z$V,z$U,z$r,z$s,z$p)},z$R}(z$T),z$jU=function(z$c){function z$R(z$V,z$U,z$r,z$s,z$p){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===z$s&&(z$s=!1),z$R.__super.call(this),this._vertexDeclaration=z$V,this._vertexCount=z$U,this._bufferUsage=z$r,this._bufferType=34962,this._canRead=z$s,this.uri=z$p,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*z$U,this._bind(),z$T._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),z$s&&(this._buffer=new Float32Array(this._byteLength/4))}z$G(z$R,"laya.d3.graphics.VertexBuffer3D",z$c);var z$V=z$R.prototype;return z$V.bindWithIndexBuffer=function(z$V){z$V&&z$V._bind(),this._bind()},z$V.setData=function(z$V,z$U,z$r,z$s){if(void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=4294967295),0===z$r&&4294967295===z$s||(z$V=new Float32Array(z$V.buffer,4*z$r,z$s)),this._bind(),z$T._gl.bufferSubData(this._bufferType,4*z$U,z$V),this._canRead)if(0!==z$U||0!==z$r||4294967295!==z$s){var z$p=this._buffer.length-z$U;z$p<z$s&&(z$s=z$p);for(var z$c=0;z$c<z$s;z$c++)this._buffer[z$U+z$c]=z$V[z$c]}else this._buffer=z$V},z$V.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},z$V.disposeResource=function(){for(var z$V=z$w.mainContext,z$U=this._vertexDeclaration.getVertexElements(),z$r=z$T._enableAtributes,z$s=0,z$p=z$U.length;z$s<z$p;z$s++)z$r[z$s]===this._glBuffer&&(z$V.disableVertexAttribArray(z$s),z$r[z$s]=null);z$c.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},z$q(0,z$V,"vertexDeclaration",function(){return this._vertexDeclaration}),z$q(0,z$V,"vertexCount",function(){return this._vertexCount}),z$q(0,z$V,"canRead",function(){return this._canRead}),z$R.create=function(z$V,z$U,z$r,z$s,z$p){return void 0===z$r&&(z$r=35044),void 0===z$s&&(z$s=!1),new z$R(z$V,z$U,z$r,z$s,z$p)},z$R}(z$T),z$oU=function(z$V){function z$O(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,z$O.__super.call(this),this._type=3553}z$G(z$O,"laya.d3.resource.DataTexture2D",z$wU);var z$U=z$O.prototype;return z$U.genDebugMipmaps=function(){var z$V=[];return z$V.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),z$V.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),z$V.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),z$V.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),z$V.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),z$V.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),z$V.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),z$V.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),z$V.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),z$V.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),z$V},z$U._onTextureLoaded=function(z$V){},z$U._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var z$V=z$w.mainContext,z$U=this._source=z$V.createTexture(),z$r=this._width,z$s=this._height,z$p=z$z.curBindTexTarget,z$c=z$z.curBindTexValue,z$R=!1;if(z$z.bindTexture(z$V,this._type,z$U),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var z$T=0;z$V.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var z$N=0;z$N<this._mipmaps.length;z$N++){if(this._mipmaps[z$N].byteLength!=z$t*z$b*4)throw"mipmap size error  level:"+z$N;z$V.texSubImage2D(this._type,0,z$O.simLodRect[z$T++],z$O.simLodRect[z$T++],z$O.simLodRect[z$T++],z$O.simLodRect[z$T++],6408,5121,new Uint8Array(this._mipmaps[z$N]))}this.minFifter=9729,this.magFifter=9729}else{var z$t=this._width,z$b=this._height;for(z$T=0,z$V.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),z$N=0;z$N<this._mipmaps.length;z$N++){if(this._mipmaps[z$N].byteLength!=z$t*z$b*4)throw"mipmap size error  level:"+z$N;z$V.texImage2D(this._type,z$N,6408,z$t,z$b,0,6408,5121,new Uint8Array(this._mipmaps[z$N])),(z$t/=2)<1&&(z$t=1),(z$b/=2)<1&&(z$b=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&z$V.pixelStorei(z$V.UNPACK_ALIGNMENT,1),z$V.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var z$S=0,z$_=!1,z$G=!1;this._buffer.byteLength==4*z$r*z$s?(z$S=6408,z$_=!0):this._buffer.byteLength==3*z$r*z$s?(z$S=6407,z$G=!0):z$S=this._format,z$_||z$G?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),z$G&&z$V.pixelStorei(z$V.UNPACK_ALIGNMENT,1),z$V.texImage2D(this._type,0,z$S,z$r,z$s,0,z$S,5121,this._buffer)):z$V&&z$S==z$V.ALPHA?(z$V.texImage2D(3553,0,z$S,z$r,z$s,0,z$S,z$V.UNSIGNED_BYTE,this._buffer),z$R=!0):0!=z$S&&(z$V.compressedTexImage2D(3553,0,z$S,z$r,z$s,0,this._buffer),z$R=!0)}var z$q=this._minFifter,z$u=this._magFifter,z$h=0==this._wrapModeU?10497:33071,z$l=0==this._wrapModeV?10497:33071,z$W=z$L.isPOT(z$r,z$s);z$W?(this._mipmap||this._mipmaps?-1!==z$q||(z$q=9987):-1!==z$q||(z$q=9729),-1!==z$u||(z$u=9729),z$V.texParameteri(this._type,10241,z$q),z$V.texParameteri(this._type,10240,z$u),z$V.texParameteri(this._type,10242,z$h),z$V.texParameteri(this._type,10243,z$l),this._mipmap&&z$V.generateMipmap(this._type)):(-1!==z$q||(z$q=9729),-1!==z$u||(z$u=9729),z$V.texParameteri(this._type,10241,z$q),z$V.texParameteri(this._type,10240,z$u),z$V.texParameteri(this._type,10242,33071),z$V.texParameteri(this._type,10243,33071)),z$p&&z$c&&z$z.bindTexture(z$V,z$p,z$c),this.memorySize=z$R?this._buffer.length:z$W?z$r*z$s*4*(1+1/3):z$r*z$s*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},z$U.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},z$U.onAsynLoaded=function(z$V,z$U,z$r){var z$s;z$r&&(z$s=z$r[0].call(this,z$U)),z$s&&(this._width=z$s.width,this._height=z$s.height,this._buffer=z$s.data),this._src=z$V,this._size=new z$uU(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},z$U.getPixels=function(){return new Uint8Array(this._buffer)},z$U.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(z$w.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},z$q(0,z$U,"src",function(){return this._src}),z$O.create=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){if(void 0===z$s&&(z$s=9729),void 0===z$p&&(z$p=9729),void 0===z$c&&(z$c=!0),!z$V||z$V.byteLength<z$U*z$r*4)throw"DataTexture2D create error";var z$T=new z$O;return z$T.uri=z$R,z$T._buffer=z$V,z$T._width=z$U,z$T._height=z$r,z$T._mipmap=z$c,z$T._magFifter=z$s,z$T._minFifter=z$p,z$T._size=new z$uU(z$T._width,z$T._height),z$T._conchTexture?alert("怎么给runtime传递datatexture数据"):z$T.activeResource(),z$T},z$O.load=function(z$V,z$U,z$r,z$s,z$p){if(void 0===z$U&&(z$U=0),void 0===z$r&&(z$r=0),void 0===z$s&&(z$s=9729),void 0===z$p&&(z$p=9729),"mipmaps"===z$I.getFileExtension(z$V)){var z$c=z$d.loader.create(z$V,null,null,z$O,[function(z$V){this._mipmaps=[];var z$U=new Uint32Array(z$V);this._width=z$U[0];var z$r=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,z$r=1024),this._width!=z$r)throw"现在只支持512x256的环境贴图。当前的是"+z$U[0];this._height=z$U[1];for(var z$s=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,z$p=this._height,z$c=8;;){var z$R=z$s*z$p*4;if(z$c+z$R>z$V.byteLength)throw"load mipmaps data size error ";var z$T=new Uint8Array(z$V,z$c,z$R);if(this._mipmaps.push(z$T),z$c+=z$R,1==z$s&&1==z$p)break;(z$s/=2)<1&&(z$s=1),(z$p/=2)<1&&(z$p=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){z$c.simLodInfo=new Float32Array(40);for(var z$R=0;z$R<z$c.simLodInfo.length;)z$c.simLodInfo[z$R]=(z$O.simLodRect[z$R]+.5)/1024,z$R++,z$c.simLodInfo[z$R]=(z$O.simLodRect[z$R]+.5)/256,z$R++,z$c.simLodInfo[z$R]=Math.max(z$O.simLodRect[z$R]-1,.1)/1024,z$R++,z$c.simLodInfo[z$R]=Math.max(z$O.simLodRect[z$R]-1.5,.1)/256,z$R++}return z$c}if("number"==typeof z$U)return z$d.loader.create(z$V,null,null,z$O,[function(z$V){return this._width=z$U,this._height=z$r,this._buffer=z$V,null}]);if("function"==typeof z$U)return z$d.loader.create(z$V,null,null,z$O,[z$U]);throw new Error("unknown params.")},z$O.lodasatlas=!1,z$S(z$O,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),z$O}(),z$JU=function(z$V){function z$U(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,z$U.__super.call(this)}z$G(z$U,"laya.d3.resource.models.PrimitiveMesh",z$zU);var z$r=z$U.prototype;return z$d.imps(z$r,{"laya.d3.core.render.IRenderable":!0}),z$r._getVertexBuffer=function(z$V){return void 0===z$V&&(z$V=0),0===z$V?this._vertexBuffer:null},z$r._getVertexBuffers=function(){return null},z$r._getIndexBuffer=function(){return this._indexBuffer},z$r._getPositions=function(){var z$V,z$U=[],z$r=this._vertexBuffer.vertexDeclaration.getVertexElements(),z$s=0;for(z$s=0;z$s<z$r.length;z$s++){var z$p=z$r[z$s];if("vector3"===z$p.elementFormat&&0===z$p.elementUsage){z$V=z$p;break}}var z$c=this._vertexBuffer.getData();for(z$s=0;z$s<z$c.length;z$s+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var z$R=z$s+z$V.offset/4,z$T=new z$RU(z$c[z$R+0],z$c[z$R+1],z$c[z$R+2]);z$U.push(z$T)}return z$U},z$r.getRenderElement=function(z$V){return this},z$r.getRenderElementsCount=function(){return 1},z$r.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},z$r._beforeRender=function(z$V){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},z$r._render=function(z$V){z$w.mainContext.drawElements(4,this._numberIndices,5123,0),z$D.drawCall++,z$D.trianglesFaces+=this._numberIndices/3},z$q(0,z$r,"_vertexBufferCount",function(){return 1}),z$q(0,z$r,"triangleCount",function(){return this._indexBuffer.indexCount/3}),z$U}(),z$iU=function(z$V){function z$U(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,z$U.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}z$G(z$U,"laya.d3.resource.models.Mesh",z$zU);var z$r=z$U.prototype;return z$r._getPositions=function(){var z$V,z$U,z$r,z$s,z$p,z$c=[],z$R=0,z$T=0,z$N=0;if(0!==this._vertexBuffers.length){var z$t=this._vertexBuffers.length;for(z$R=0;z$R<z$t;z$R++){for(z$r=(z$V=this._vertexBuffers[z$R]).vertexDeclaration.getVertexElements(),z$T=0;z$T<z$r.length;z$T++)if("vector3"===(z$s=z$r[z$T]).elementFormat&&0===z$s.elementUsage){z$U=z$s;break}for(z$p=z$V.getData(),z$T=0;z$T<z$p.length;z$T+=z$V.vertexDeclaration.vertexStride/4)z$N=z$T+z$U.offset/4,z$c.push(new z$RU(z$p[z$N+0],z$p[z$N+1],z$p[z$N+2]))}}else{var z$b=this._subMeshes.length;for(z$R=0;z$R<z$b;z$R++){for(z$r=(z$V=this._subMeshes[z$R]._getVertexBuffer()).vertexDeclaration.getVertexElements(),z$T=0;z$T<z$r.length;z$T++)if("vector3"===(z$s=z$r[z$T]).elementFormat&&0===z$s.elementUsage){z$U=z$s;break}for(z$p=z$V.getData(),z$T=0;z$T<z$p.length;z$T+=z$V.vertexDeclaration.vertexStride/4)z$N=z$T+z$U.offset/4,z$c.push(new z$RU(z$p[z$N+0],z$p[z$N+1],z$p[z$N+2]))}}return z$c},z$r._setSubMeshes=function(z$V){this._subMeshes=z$V,this._subMeshCount=z$V.length;for(var z$U=0;z$U<this._subMeshCount;z$U++)z$V[z$U]._indexInMesh=z$U;this._positions=this._getPositions(),this._generateBoundingObject()},z$r.onAsynLoaded=function(z$V,z$U,z$r){var z$s=z$U[0],z$p=z$U[1];z$FV.read(z$s,this,this._materials,this._subMeshes,z$p),this.completeCreate(),this._endLoaded()},z$r.getSubMesh=function(z$V){return this._subMeshes[z$V]},z$r.getSubMeshCount=function(){return this._subMeshes.length},z$r.getRenderElementsCount=function(){return this._subMeshes.length},z$r.getRenderElement=function(z$V){return this._subMeshes[z$V]},z$r.disposeResource=function(){for(var z$V=0;z$V<this._subMeshes.length;z$V++)this._subMeshes[z$V].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},z$q(0,z$r,"materials",function(){return this._materials.slice()}),z$q(0,z$r,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),z$U.load=function(z$V){return z$d.loader.create(z$V,null,null,z$U)},z$U}(),z$BU=(function(z$V){function z$t(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===z$r&&(z$r=6408),void 0===z$s&&(z$s=5121),void 0===z$p&&(z$p=33189),void 0===z$c&&(z$c=!1),void 0===z$R&&(z$R=!1),void 0===z$T&&(z$T=-1),void 0===z$N&&(z$N=-1),z$t.__super.call(this),this._type=3553,this._width=z$V,this._height=z$U,this._size=new z$uU(z$V,z$U),this._surfaceFormat=z$r,this._surfaceType=z$s,this._depthStencilFormat=z$p,z$u.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=z$c,this._repeat=z$R,this._minFifter=z$T,this._magFifter=z$N,this.activeResource(),this._alreadyResolved=!0}z$G(z$t,"laya.d3.resource.RenderTexture",z$wU);var z$U=z$t.prototype;z$U.recreateResource=function(){var z$V=z$w.mainContext;this._frameBuffer=z$V.createFramebuffer(),this._source=z$V.createTexture();var z$U=z$z.curBindTexTarget,z$r=z$z.curBindTexValue;z$z.bindTexture(z$V,this._type,this._source),z$V.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var z$s=this._minFifter,z$p=this._magFifter,z$c=this._repeat?10497:33071;if(z$L.isPOT(this._width,this._height)?(this._mipmap?-1!==z$s||(z$s=9987):-1!==z$s||(z$s=9729),-1!==z$p||(z$p=9729),z$V.texParameteri(this._type,10241,z$s),z$V.texParameteri(this._type,10240,z$p),z$V.texParameteri(this._type,10242,z$c),z$V.texParameteri(this._type,10243,z$c),this._mipmap&&z$V.generateMipmap(this._type)):(-1!==z$s||(z$s=9729),-1!==z$p||(z$p=9729),z$V.texParameteri(this._type,10241,z$s),z$V.texParameteri(this._type,10240,z$p),z$V.texParameteri(this._type,10242,33071),z$V.texParameteri(this._type,10243,33071)),z$U&&z$r&&z$z.bindTexture(z$V,z$U,z$r),z$V.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=z$V.createRenderbuffer(),z$V.bindRenderbuffer(36161,this._depthStencilBuffer),z$V.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),z$V.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:z$V.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:z$V.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:z$V.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}z$V.framebufferTexture2D(36160,36064,3553,this._source,0),z$V.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},z$U.start=function(){z$w.mainContext.bindFramebuffer(36160,this.frameBuffer),(z$t._currentRenderTarget=this)._alreadyResolved=!1},z$U.end=function(){z$w.mainContext.bindFramebuffer(36160,null),z$t._currentRenderTarget=null,this._alreadyResolved=!0},z$U.getData=function(z$V,z$U,z$r,z$s){var z$p=z$w.mainContext;if(z$p.bindFramebuffer(36160,this._frameBuffer),!(36053===z$p.checkFramebufferStatus(36160)))return z$p.bindFramebuffer(36160,null),null;var z$c=new Uint8Array(this._width*this._height*4);return z$p.readPixels(z$V,z$U,z$r,z$s,this._surfaceFormat,this._surfaceType,z$c),z$p.bindFramebuffer(36160,null),z$c},z$U.disposeResource=function(){if(this._frameBuffer){var z$V=z$w.mainContext;z$V.deleteTexture(this._source),z$V.deleteFramebuffer(this._frameBuffer),z$V.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},z$q(0,z$U,"surfaceFormat",function(){return this._surfaceFormat}),z$q(0,z$U,"surfaceType",function(){return this._surfaceType}),z$q(0,z$U,"depthStencilFormat",function(){return this._depthStencilFormat}),z$q(0,z$U,"source",function(){return this._alreadyResolved?z$d.superGet(z$wU,this,"source"):null}),z$q(0,z$U,"depthStencilBuffer",function(){return this._depthStencilBuffer}),z$q(0,z$U,"frameBuffer",function(){return this._frameBuffer}),z$t._currentRenderTarget=null}(),function(z$V){function z$U(z$V){this._color=null,this._pixels=null,z$U.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new z$uU(this.width,this.height),this._color=z$V,this._pixels=new Uint8Array([255*z$V.x,255*z$V.y,255*z$V.z,255*z$V.w]),this.uri="SolidColorTexture2D_"+this.id}z$G(z$U,"laya.d3.resource.SolidColorTexture2D",z$wU);var z$r=z$U.prototype;return z$r._createWebGlTexture=function(){var z$V=z$w.mainContext,z$U=this._source=z$V.createTexture(),z$r=this._width,z$s=this._height,z$p=z$z.curBindTexTarget,z$c=z$z.curBindTexValue;z$z.bindTexture(z$V,this._type,z$U),z$V.texImage2D(this._type,0,6408,z$r,z$s,0,6408,5121,this._pixels);var z$R=this._minFifter,z$T=this._magFifter,z$N=this._repeat?10497:33071,z$t=z$L.isPOT(z$r,z$s);z$t?(this._mipmap?-1!==z$R||(z$R=9987):-1!==z$R||(z$R=9729),-1!==z$T||(z$T=9729),z$V.texParameteri(this._type,10241,z$R),z$V.texParameteri(this._type,10240,z$T),z$V.texParameteri(this._type,10242,z$N),z$V.texParameteri(this._type,10243,z$N),this._mipmap&&z$V.generateMipmap(this._type)):(-1!==z$R||(z$R=9729),-1!==z$T||(z$T=9729),z$V.texParameteri(this._type,10241,z$R),z$V.texParameteri(this._type,10240,z$T),z$V.texParameteri(this._type,10242,33071),z$V.texParameteri(this._type,10243,33071)),z$p&&z$c&&z$z.bindTexture(z$V,z$p,z$c),this.memorySize=z$t?z$r*z$s*4*(1+1/3):z$r*z$s*4},z$r.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},z$r.disposeResource=function(){this._source&&(z$w.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},z$S(z$U,["magentaTexture",function(){var z$V=new z$U(new z$TU(1,0,1,1));return z$V.lock=!0,this.magentaTexture=z$V},"grayTexture",function(){var z$V=new z$U(new z$TU(.5,.5,.5,1));return z$V.lock=!0,this.grayTexture=z$V}]),z$U}()),z$PU=function(z$V){function z$p(z$V,z$U,z$r,z$s){this._canRead=!1,this._image=null,this._pixels=null,void 0===z$V&&(z$V=!1),void 0===z$U&&(z$U=!0),void 0===z$r&&(z$r=6408),void 0===z$s&&(z$s=!0),z$p.__super.call(this),this._type=3553,this._repeat=z$U,this._canRead=z$V,this._format=z$r,this._mipmap=z$s}z$G(z$p,"laya.d3.resource.Texture2D",z$wU);var z$U=z$p.prototype;return z$U._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var z$V=z$w.mainContext,z$U=this._source=z$V.createTexture(),z$r=this._width,z$s=this._height,z$p=z$z.curBindTexTarget,z$c=z$z.curBindTexValue;switch(z$z.bindTexture(z$V,this._type,z$U),this._format){case 6407:case 6408:this._canRead?z$V.texImage2D(this._type,0,this._format,z$r,z$s,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?z$V.texImage2D(this._type,0,this._image._format,z$r,z$s,0,this._image._format,5121,this._image.atlasSource):z$V.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case z$w.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:z$V.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var z$R=this._minFifter,z$T=this._magFifter,z$N=this._repeat?10497:33071,z$t=0==this._wrapModeU?10497:33071,z$b=0==this._wrapModeV?10497:33071,z$S=z$L.isPOT(z$r,z$s);z$S?(this._mipmap?-1!==z$R||(z$R=9987):-1!==z$R||(z$R=9729),-1!==z$T||(z$T=9729),z$V.texParameteri(this._type,10241,z$R),z$V.texParameteri(this._type,10240,z$T),z$V.texParameteri(this._type,10242,z$N),z$V.texParameteri(this._type,10243,z$N),z$V.texParameteri(this._type,10242,z$t),z$V.texParameteri(this._type,10243,z$b),this._mipmap&&z$V.generateMipmap(this._type)):(-1!==z$R||(z$R=9729),-1!==z$T||(z$T=9729),z$V.texParameteri(this._type,10241,z$R),z$V.texParameteri(this._type,10240,z$T),z$V.texParameteri(this._type,10242,33071),z$V.texParameteri(this._type,10243,33071)),z$p&&z$c&&z$z.bindTexture(z$V,z$p,z$c),this._image.onload=null,this._image=null,this.memorySize=z$S?z$r*z$s*4*(1+1/3):z$r*z$s*4},z$U.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},z$U.onAsynLoaded=function(z$V,z$U,z$r){if(z$r){var z$s=z$r[0];void 0!==z$s&&(this._canRead=z$s);var z$p=z$r[1];void 0!==z$p&&(this._repeat=z$p);var z$c=z$r[2];void 0!==z$c&&(this._format=z$c);var z$R=z$r[3];void 0!==z$R&&(this._mipmap=z$R);var z$T=z$r.wrapModeU;void 0!==z$T&&(this._wrapModeU=z$T);var z$N=z$r.wrapModeV;void 0!==z$N&&(this._wrapModeV=z$N)}switch(this._format){case 6407:case 6408:var z$t=(this._image=z$U).width,z$b=z$U.height;this._width=z$t,this._height=z$b,this._size=new z$uU(z$t,z$b),this._canRead&&(z$u.isConchApp?z$U instanceof z$_.HTMLElement&&(this._pixels=new Uint8Array(z$U.getImageData(0,0,z$t,z$b))):(z$E.canvas.size(z$t,z$b),z$E.canvas.clear(),z$E.context.drawImage(z$U,0,0,z$t,z$b),this._pixels=new Uint8Array(z$E.context.getImageData(0,0,z$t,z$b).data.buffer)));break;case z$w.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var z$S=new z$k(z$U);z$S.readUTFBytes(4),z$S.readUTFBytes(2),z$S.getInt16();z$S.endian="bigEndian",this._width=z$S.getInt16(),this._height=z$S.getInt16(),this._size=new z$uU(this._width,this._height);z$S.getInt16(),z$S.getInt16();this._image=new Uint8Array(z$U,z$S.pos)}this.recreateResource(),this._endLoaded()},z$U.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},z$U.disposeResource=function(){this._source&&(z$w.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},z$q(0,z$U,"_src",function(){return this.url}),z$q(0,z$U,"src",function(){return this.url}),z$p.load=function(z$V){return z$d.loader.create(z$V,null,null,z$p)},z$p}(),z$MU=function(z$U){function z$r(z$V,z$U){z$r.__super.call(this),void 0===z$V&&(z$V=.3),void 0===z$U&&(z$U=1e3),this._tempVector3=new z$RU,this._position=new z$RU,this._up=new z$RU,this._forward=new z$RU,this._right=new z$RU,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=z$uU.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=z$V,this._farPlane=z$U,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),z$d.stage.on("resize",this,this._onScreenSizeChanged)}z$G(z$r,"laya.d3.core.BaseCamera",z$U);var z$V=z$r.prototype;return z$V._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var z$V=this.scene._cameraPool,z$U=z$V.length-1,z$r=0;z$r<z$U;z$r++)if(z$V[z$r].renderingOrder>z$V[z$U].renderingOrder){var z$s=z$V[z$r];z$V[z$r]=z$V[z$U],z$V[z$U]=z$s}},z$V._calculateProjectionMatrix=function(){},z$V._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},z$V._prepareCameraToRender=function(){z$K._currentCameraCullingMask=this.cullingMask;var z$V=this._shaderValues;z$V.setValue(0,this.transform.position.elements),z$V.setValue(5,this.forward.elements),z$V.setValue(6,this.up.elements)},z$V._prepareCameraViewProject=function(z$V,z$U){var z$r=this._shaderValues;z$r.setValue(1,z$V.elements),z$r.setValue(2,z$U.elements)},z$V._renderCamera=function(z$V,z$U,z$r){},z$V.addLayer=function(z$V){29!==z$V.number&&30!=z$V.number&&(this.cullingMask=this.cullingMask|z$V.mask)},z$V.removeLayer=function(z$V){29!==z$V.number&&30!=z$V.number&&(this.cullingMask=this.cullingMask&~z$V.mask)},z$V.addAllLayers=function(){this.cullingMask=2147483647},z$V.removeAllLayers=function(){this.cullingMask=0|z$K.getLayerByNumber(29).mask|z$K.getLayerByNumber(30).mask},z$V.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},z$V.moveForward=function(z$V){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=z$V,this.transform.translate(this._tempVector3)},z$V.moveRight=function(z$V){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=z$V,this.transform.translate(this._tempVector3)},z$V.moveVertical=function(z$V){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=z$V,this.transform.translate(this._tempVector3,!1)},z$V._addSelfRenderObjects=function(){var z$V=this.scene._cameraPool,z$U=z$V.length;if(0<z$U){for(var z$r=z$U-1;0<=z$r;z$r--)if(this.renderingOrder<=z$V[z$r].renderingOrder){z$V.splice(z$r+1,0,this);break}}else z$V.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},z$V._clearSelfRenderObjects=function(){var z$V=this.scene._cameraPool;z$V.splice(z$V.indexOf(this),1)},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,z$d.stage.off("resize",this,this._onScreenSizeChanged),z$U.prototype.destroy.call(this,z$V)},z$q(0,z$V,"sky",function(){return this._sky},function(z$V){(this._sky=z$V)._ownerCamera=this}),z$q(0,z$V,"forward",function(){var z$V=this.transform.worldMatrix.elements,z$U=this._forward.elements;return z$U[0]=-z$V[8],z$U[1]=-z$V[9],z$U[2]=-z$V[10],this._forward}),z$q(0,z$V,"position",function(){var z$V=this.transform.worldMatrix.elements,z$U=this._position.elements;return z$U[0]=z$V[12],z$U[1]=z$V[13],z$U[2]=z$V[14],this._position}),z$q(0,z$V,"renderTarget",function(){return this._renderTarget},function(z$V){null!=(this._renderTarget=z$V)&&(this._renderTargetSize=z$V.size)}),z$q(0,z$V,"up",function(){var z$V=this.transform.worldMatrix.elements,z$U=this._up.elements;return z$U[0]=z$V[4],z$U[1]=z$V[5],z$U[2]=z$V[6],this._up}),z$q(0,z$V,"right",function(){var z$V=this.transform.worldMatrix.elements,z$U=this._right.elements;return z$U[0]=z$V[0],z$U[1]=z$V[1],z$U[2]=z$V[2],this._right}),z$q(0,z$V,"renderTargetSize",function(){return this._renderTargetSize},function(z$V){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"fieldOfView",function(){return this._fieldOfView},function(z$V){this._fieldOfView=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"nearPlane",function(){return this._nearPlane},function(z$V){this._nearPlane=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"farPlane",function(){return this._farPlane},function(z$V){this._farPlane=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"orthographic",function(){return this._orthographic},function(z$V){this._orthographic=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(z$V){this._orthographicVerticalSize=z$V,this._calculateProjectionMatrix()}),z$q(0,z$V,"renderingOrder",function(){return this._renderingOrder},function(z$V){this._renderingOrder=z$V,this._sortCamerasByRenderingOrder()}),z$r.CAMERAPOS=0,z$r.VIEWMATRIX=1,z$r.PROJECTMATRIX=2,z$r.VPMATRIX=3,z$r.VPMATRIX_NO_TRANSLATE=4,z$r.CAMERADIRECTION=5,z$r.CAMERAUP=6,z$r.ENVIRONMENTDIFFUSE=7,z$r.ENVIRONMENTSPECULAR=8,z$r.SIMLODINFO=9,z$r.DIFFUSEIRRADMATR=10,z$r.DIFFUSEIRRADMATG=11,z$r.DIFFUSEIRRADMATB=12,z$r.HDREXPOSURE=13,z$r.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",z$r.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",z$r.CLEARFLAG_SOLIDCOLOR=0,z$r.CLEARFLAG_SKY=1,z$r.CLEARFLAG_DEPTHONLY=2,z$r.CLEARFLAG_NONE=3,z$S(z$r,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new z$VU(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new z$VU},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new z$VU}]),z$r}(z$aU),z$AU=function(z$r){function z$U(z$V){this._render=null,this._geometryFilter=null,z$U.__super.call(this,z$V)}z$G(z$U,"laya.d3.core.RenderableSprite3D",z$r);var z$V=z$U.prototype;return z$V._addToInitStaticBatchManager=function(){},z$V._setBelongScene=function(z$V){z$r.prototype._setBelongScene.call(this,z$V),z$V._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},z$V._setUnBelongScene=function(){var z$V=this._scene._renderableSprite3Ds,z$U=z$V.indexOf(this);z$V.splice(z$U,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),z$r.prototype._setUnBelongScene.call(this)},z$V._update=function(z$V){(z$V.owner=this)._activeInHierarchy&&(this._updateComponents(z$V),this._render._updateOctreeNode(),this._lateUpdateComponents(z$V),z$D.spriteCount++,this._childs.length&&this._updateChilds(z$V))},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$r.prototype.destroy.call(this,z$V),this._render._destroy(),this._render=null},z$U.__init__=function(){z$U.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=z$U.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),z$U.SAHDERDEFINE_LIGHTMAP=z$U.shaderDefines.registerDefine("LIGHTMAP")},z$U.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,z$U.SAHDERDEFINE_LIGHTMAP=4,z$U.LIGHTMAPSCALEOFFSET=2,z$U.LIGHTMAP=3,z$S(z$U,["shaderDefines",function(){return this.shaderDefines=new z$bU}]),z$U}(z$aU),z$XU=(function(z$V){function z$s(z$V,z$U,z$r){this._long=NaN,this._width=NaN,this._height=NaN,void 0===z$V&&(z$V=1),void 0===z$U&&(z$U=1),void 0===z$r&&(z$r=1),z$s.__super.call(this),this._long=z$V,this._width=z$U,this._height=z$r,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}z$G(z$s,"laya.d3.resource.models.BoxMesh",z$JU);var z$U=z$s.prototype;z$U.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var z$V=z$wV.vertexDeclaration,z$U=(z$V.vertexStride,this._long/2),z$r=this._height/2,z$s=this._width/2,z$p=new Float32Array([-z$U,z$r,-z$s,0,1,0,0,0,z$U,z$r,-z$s,0,1,0,1,0,z$U,z$r,z$s,0,1,0,1,1,-z$U,z$r,z$s,0,1,0,0,1,-z$U,-z$r,-z$s,0,-1,0,0,1,z$U,-z$r,-z$s,0,-1,0,1,1,z$U,-z$r,z$s,0,-1,0,1,0,-z$U,-z$r,z$s,0,-1,0,0,0,-z$U,z$r,-z$s,-1,0,0,0,0,-z$U,z$r,z$s,-1,0,0,1,0,-z$U,-z$r,z$s,-1,0,0,1,1,-z$U,-z$r,-z$s,-1,0,0,0,1,z$U,z$r,-z$s,1,0,0,1,0,z$U,z$r,z$s,1,0,0,0,0,z$U,-z$r,z$s,1,0,0,0,1,z$U,-z$r,-z$s,1,0,0,1,1,-z$U,z$r,z$s,0,0,1,0,0,z$U,z$r,z$s,0,0,1,1,0,z$U,-z$r,z$s,0,0,1,1,1,-z$U,-z$r,z$s,0,0,1,0,1,-z$U,z$r,-z$s,0,0,-1,1,0,z$U,z$r,-z$s,0,0,-1,0,0,z$U,-z$r,-z$s,0,0,-1,0,1,-z$U,-z$r,-z$s,0,0,-1,1,1]),z$c=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new z$jU(z$V,this._numberVertices,35044,!0),this._indexBuffer=new z$$U("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(z$p),this._indexBuffer.setData(z$c),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},z$q(0,z$U,"long",function(){return this._long},function(z$V){this._long!==z$V&&(this._long=z$V,this.releaseResource(),this.activeResource())}),z$q(0,z$U,"width",function(){return this._width},function(z$V){this._width!==z$V&&(this._width=z$V,this.releaseResource(),this.activeResource())}),z$q(0,z$U,"height",function(){return this._height},function(z$V){this._height!==z$V&&(this._height=z$V,this.releaseResource(),this.activeResource())})}(),function(z$V){function z$p(z$V,z$U,z$r,z$s){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===z$V&&(z$V=10),void 0===z$U&&(z$U=10),void 0===z$r&&(z$r=10),void 0===z$s&&(z$s=10),z$p.__super.call(this),this._long=z$V,this._width=z$U,this._stacks=z$r,this._slices=z$s,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}z$G(z$p,"laya.d3.resource.models.PlaneMesh",z$JU);var z$U=z$p.prototype;z$U.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var z$V=new Uint16Array(this._numberIndices),z$U=z$wV.vertexDeclaration,z$r=z$U.vertexStride/4,z$s=new Float32Array(this._numberVertices*z$r),z$p=this._long/2,z$c=this._width/2,z$R=this._long/this._stacks,z$T=this._width/this._slices,z$N=0,z$t=0;z$t<=this._slices;z$t++)for(var z$b=0;z$b<=this._stacks;z$b++)z$s[z$N++]=z$b*z$R-z$p,z$s[z$N++]=0,z$s[z$N++]=z$t*z$T-z$c,z$s[z$N++]=0,z$s[z$N++]=1,z$s[z$N++]=0,z$s[z$N++]=1*z$b/this._stacks,z$s[z$N++]=1*z$t/this._slices;var z$S=0;for(z$t=0;z$t<this._slices;z$t++)for(z$b=0;z$b<this._stacks;z$b++)z$V[z$S++]=(z$t+1)*(this._stacks+1)+z$b,z$V[z$S++]=z$t*(this._stacks+1)+z$b,z$V[z$S++]=(z$t+1)*(this._stacks+1)+z$b+1,z$V[z$S++]=z$t*(this._stacks+1)+z$b,z$V[z$S++]=z$t*(this._stacks+1)+z$b+1,z$V[z$S++]=(z$t+1)*(this._stacks+1)+z$b+1;this._vertexBuffer=new z$jU(z$U,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new z$$U("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(z$s),this._indexBuffer.setData(z$V),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},z$q(0,z$U,"long",function(){return this._long},function(z$V){this._long!==z$V&&(this._long=z$V,this.releaseResource(),this.activeResource())}),z$q(0,z$U,"width",function(){return this._width},function(z$V){this._width!==z$V&&(this._width=z$V,this.releaseResource(),this.activeResource())}),z$q(0,z$U,"stacks",function(){return this._stacks},function(z$V){this._stacks!==z$V&&(this._stacks=z$V,this.releaseResource(),this.activeResource())}),z$q(0,z$U,"slices",function(){return this._slices},function(z$V){this._slices!==z$V&&(this._slices=z$V,this.releaseResource(),this.activeResource())})}(),function(z$V){function z$R(z$V,z$U,z$r){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=.3),void 0===z$r&&(z$r=1e3),this._viewMatrix=new z$VU,this._projectionMatrix=new z$VU,this._projectionViewMatrix=new z$VU,this._viewport=new z$NU(0,0,0,0),this._normalizedViewport=new z$NU(0,0,1,1),this._aspectRatio=z$V,this._boundFrustumUpdate=!0,this._boundFrustum=new z$vV(z$VU.DEFAULT),z$R.__super.call(this,z$U,z$r),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}z$G(z$R,"laya.d3.core.Camera",z$MU);var z$U=z$R.prototype;return z$U._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},z$U._parseCustomProps=function(z$V,z$U,z$r,z$s){var z$p=z$r.clearColor;this.clearColor=new z$TU(z$p[0],z$p[1],z$p[2],z$p[3]);var z$c=z$r.viewport;this.normalizedViewport=new z$NU(z$c[0],z$c[1],z$c[2],z$c[3])},z$U._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var z$V=this.orthographicVerticalSize*this.aspectRatio*.5,z$U=.5*this.orthographicVerticalSize;z$VU.createOrthoOffCenterRH(-z$V,z$V,-z$U,z$U,this.nearPlane,this.farPlane,this._projectionMatrix)}else z$VU.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},z$U._update=function(z$V){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,z$V)},z$U._renderCamera=function(z$V,z$U,z$r){var z$s,z$p;z$r.parallelSplitShadowMaps[0]&&z$r._renderShadowMap(z$V,z$U,this),(z$U.camera=this)._prepareCameraToRender(),z$r._preRenderUpdateComponents(z$U),z$s=z$U._viewMatrix=this.viewMatrix;var z$c=this._renderTarget;z$c?(z$c.start(),z$VU.multiply(z$MU._invertYScaleMatrix,this._projectionMatrix,z$MU._invertYProjectionMatrix),z$VU.multiply(z$MU._invertYScaleMatrix,this.projectionViewMatrix,z$MU._invertYProjectionViewMatrix),z$p=z$U._projectionMatrix=z$MU._invertYProjectionMatrix,z$U._projectionViewMatrix=z$MU._invertYProjectionViewMatrix):(z$p=z$U._projectionMatrix=this._projectionMatrix,z$U._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(z$s,z$p),z$U._viewport=this.viewport,z$r._preRenderScene(z$V,z$U,this.boundFrustum),z$r._clear(z$V,z$U),z$r._renderScene(z$V,z$U),z$r._postRenderUpdateComponents(z$U),z$c&&z$c.end()},z$U.viewportPointToRay=function(z$V,z$U){z$qU.calculateCursorRay(z$V,this.viewport,this._projectionMatrix,this.viewMatrix,null,z$U)},z$U.normalizedViewportPointToRay=function(z$V,z$U){var z$r=z$R._tempVector20,z$s=this.viewport,z$p=z$V.elements,z$c=z$r.elements;z$c[0]=z$p[0]*z$s.width,z$c[1]=z$p[1]*z$s.height,z$qU.calculateCursorRay(z$r,this.viewport,this._projectionMatrix,this.viewMatrix,null,z$U)},z$U.worldToViewportPoint=function(z$V,z$U){z$VU.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(z$V,this._projectionViewMatrix,z$U);var z$r=z$U.elements;z$r[0]=z$r[0]/z$d.stage.clientScaleX,z$r[1]=z$r[1]/z$d.stage.clientScaleY},z$U.worldToNormalizedViewportPoint=function(z$V,z$U){z$VU.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(z$V,this._projectionViewMatrix,z$U);var z$r=z$U.elements;z$r[0]=z$r[0]/z$d.stage.clientScaleX,z$r[1]=z$r[1]/z$d.stage.clientScaleY},z$U.convertScreenCoordToOrthographicCoord=function(z$V,z$U){if(this._orthographic){var z$r=z$F.clientWidth,z$s=z$F.clientHeight,z$p=this.orthographicVerticalSize*this.aspectRatio/z$r,z$c=this.orthographicVerticalSize/z$s,z$R=z$V.elements,z$T=z$U.elements;return z$T[0]=(-z$r/2+z$R[0])*z$p,z$T[1]=(z$s/2-z$R[1])*z$c,z$T[2]=(this.nearPlane-this.farPlane)*(z$R[2]+1)/2-this.nearPlane,z$RU.transformCoordinate(z$U,this.transform.worldMatrix,z$U),!0}return!1},z$q(0,z$U,"projectionViewMatrix",function(){return z$VU.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),z$q(0,z$U,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var z$V=this.viewport;return z$V.width/z$V.height},function(z$V){if(z$V<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=z$V,this._calculateProjectionMatrix()}),z$q(0,z$U,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),z$q(0,z$U,"needViewport",function(){var z$V=this.normalizedViewport;return 0===z$V.x&&0===z$V.y&&1===z$V.width&&1===z$V.height}),z$q(0,z$U,"viewport",function(){if(this._viewportExpressedInClipSpace){var z$V=this._normalizedViewport,z$U=this.renderTargetSize,z$r=z$U.width,z$s=z$U.height;this._viewport.x=z$V.x*z$r,this._viewport.y=z$V.y*z$s,this._viewport.width=z$V.width*z$r,this._viewport.height=z$V.height*z$s}return this._viewport},function(z$V){if(null!=this.renderTarget&&(z$V.x<0||z$V.y<0||0==z$V.width||0==z$V.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=z$V,this._calculateProjectionMatrix()}),z$q(0,z$U,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var z$V=this._viewport,z$U=this.renderTargetSize,z$r=z$U.width,z$s=z$U.height;this._normalizedViewport.x=z$V.x/z$r,this._normalizedViewport.y=z$V.y/z$s,this._normalizedViewport.width=z$V.width/z$r,this._normalizedViewport.height=z$V.height/z$s}return this._normalizedViewport},function(z$V){z$V.x<0&&(z$V.x=0,console.warn("Camera: viewport.x must large than 0.0.")),z$V.y<0&&(z$V.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<z$V.x+z$V.width&&(z$V.width=1-z$V.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<z$V.y+z$V.height&&(z$V.height=1-z$V.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=z$V,this._calculateProjectionMatrix()}),z$q(0,z$U,"projectionMatrix",function(){return this._projectionMatrix},function(z$V){this._projectionMatrix=z$V,this._useUserProjectionMatrix=!0}),z$q(0,z$U,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),z$S(z$R,["_tempVector20",function(){return this._tempVector20=new z$cU}]),z$R}()),z$eU=function(z$r){function z$s(z$V,z$U){z$s.__super.call(this,z$U),this._geometryFilter=new z$EU(this),this._render=new z$KU(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),z$V&&(this._geometryFilter.sharedMesh=z$V)instanceof laya.d3.resource.models.Mesh&&(z$V.loaded?this._render.sharedMaterials=z$V.materials:z$V.once("loaded",this,this._applyMeshMaterials))}z$G(z$s,"laya.d3.core.MeshSprite3D",z$r);var z$V=z$s.prototype;return z$V._changeRenderObjectByMesh=function(z$V){var z$U=this._render._renderElements,z$r=z$U[z$V];z$r||(z$r=z$U[z$V]=new z$yU),z$r._render=this._render;var z$s=this._render.sharedMaterials[z$V];z$s||(z$s=z$xU.defaultMaterial);var z$p=this._geometryFilter.sharedMesh.getRenderElement(z$V);return z$r._mainSortID=this._getSortID(z$p,z$s),z$r._sprite3D=this,z$r.renderObj=z$p,z$r._material=z$s,z$r},z$V._changeRenderObjectByMaterial=function(z$V,z$U){var z$r=this._render._renderElements[z$V];z$U||(z$U=z$xU.defaultMaterial);var z$s=this._geometryFilter.sharedMesh.getRenderElement(z$V);return z$r._mainSortID=this._getSortID(z$s,z$U),z$r._sprite3D=this,z$r.renderObj=z$s,z$r._material=z$U,z$r},z$V._changeRenderObjectsByMesh=function(){var z$V=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=z$V;for(var z$U=0;z$U<z$V;z$U++)this._changeRenderObjectByMesh(z$U)},z$V._onMeshChanged=function(z$V){var z$U=z$V.sharedMesh;z$U.loaded?this._changeRenderObjectsByMesh():z$U.once("loaded",this,this._onMeshLoaded)},z$V._onMeshLoaded=function(z$V){z$V===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},z$V._onMaterialChanged=function(z$V,z$U,z$r){z$U<this._render._renderElements.length&&this._changeRenderObjectByMaterial(z$U,z$r)},z$V._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},z$V._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},z$V._parseCustomProps=function(z$V,z$U,z$r,z$s){var z$p=this.meshRender,z$c=z$r.lightmapIndex;null!=z$c&&(z$p.lightmapIndex=z$c);var z$R,z$T,z$N=z$r.lightmapScaleOffset;if(z$N&&(z$p.lightmapScaleOffset=new z$TU(z$N[0],z$N[1],z$N[2],z$N[3])),z$s.instanceParams)(z$R=z$s.instanceParams.loadPath)&&(z$T=z$l.getRes(z$U[z$R]),(this.meshFilter.sharedMesh=z$T).loaded?z$p.sharedMaterials=z$T.materials:z$T.once("loaded",this,this._applyMeshMaterials));else{(z$R=z$r.meshPath)&&(z$T=z$l.getRes(z$U[z$R]),this.meshFilter.sharedMesh=z$T);var z$t=z$r.materials;if(z$t){var z$b=z$p.sharedMaterials,z$S=z$t.length;z$b.length=z$S;for(var z$_=0;z$_<z$S;z$_++)z$b[z$_]=z$l.getRes(z$U[z$t[z$_].path]);z$p.sharedMaterials=z$b}}},z$V._applyMeshMaterials=function(z$V){for(var z$U=this._render.sharedMaterials,z$r=z$V.materials,z$s=0,z$p=z$r.length;z$s<z$p;z$s++)z$U[z$s]||(z$U[z$s]=z$r[z$s]);this._render.sharedMaterials=z$U},z$V._addToInitStaticBatchManager=function(){z$s._staticBatchManager._addInitBatchSprite(this)},z$V.cloneTo=function(z$V){var z$U=z$V;z$U._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var z$r=this._render,z$s=z$U._render;z$s.enable=z$r.enable,z$s.sharedMaterials=z$r.sharedMaterials,z$s.castShadow=z$r.castShadow;var z$p=z$r.lightmapScaleOffset;z$p&&(z$s.lightmapScaleOffset=z$p.clone()),z$s.lightmapIndex=z$r.lightmapIndex,z$s.receiveShadow=z$r.receiveShadow,z$s.sortingFudge=z$r.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,z$V)},z$V.destroy=function(z$V){if(void 0===z$V&&(z$V=!0),!this.destroyed){var z$U=this.meshFilter.sharedMesh;null!=z$U&&(z$U.loaded||z$U.off("loaded",this,this._applyMeshMaterials)),z$r.prototype.destroy.call(this,z$V),this._geometryFilter._destroy()}},z$q(0,z$V,"meshFilter",function(){return this._geometryFilter}),z$q(0,z$V,"meshRender",function(){return this._render}),z$s.__init__=function(){z$sV._staticBatchManagers.push(z$s._staticBatchManager)},z$s.load=function(z$V){return z$d.loader.create(z$V,null,null,z$s)},z$S(z$s,["_staticBatchManager",function(){return this._staticBatchManager=new z$nU}]),z$s}(z$AU)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}}),function(z$V,z$U,z$pV){z$pV.un,z$pV.uns;var z$r=z$pV.static,z$s=z$pV.class,z$c=z$pV.getset,z$u=z$pV.__newvec,z$T=laya.maths.Bezier,z$S=laya.utils.Browser,z$wV=laya.utils.Byte,z$p=(laya.events.Event,laya.events.EventDispatcher),z$R=laya.display.Graphics,z$N=(laya.resource.HTMLCanvas,laya.utils.Handler),z$t=laya.net.Loader,z$_=laya.maths.MathUtil,z$zV=laya.maths.Matrix,z$h=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),z$b=(laya.renders.RenderContext,laya.resource.Resource),z$G=laya.utils.RunDriver,z$cV=laya.display.Sprite,z$q=laya.utils.Stat,z$EV=laya.resource.Texture,z$l=(laya.net.URL,laya.utils.Utils),z$z=function(){function z$V(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return z$s(z$V,"laya.ani.AnimationContent"),z$V}(),z$E=function(){function z$V(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return z$s(z$V,"laya.ani.AnimationNodeContent"),z$V}(),z$O=function(){function z$V(){}return z$s(z$V,"laya.ani.AnimationParser01"),z$V.parse=function(z$V,z$U){var z$r=z$U.__getBuffer(),z$s=0,z$p=0,z$c=0,z$R=0,z$T=0,z$N=0,z$t=0,z$b=z$U.readUTFString();z$V._aniClassName=z$b;var z$S,z$_=z$U.readUTFString().split("\n"),z$G=z$U.getUint8(),z$q=z$U.getUint32(),z$u=z$U.getUint32();0<z$q&&(z$S=z$r.slice(z$q,z$u));var z$h=new z$wV(z$S);for(0<z$u&&(z$V._publicExtData=z$r.slice(z$u,z$r.byteLength)),z$V._useParent=!!z$U.getUint8(),z$V._anis.length=z$G,z$s=0;z$s<z$G;z$s++){var z$l=z$V._anis[z$s]=new z$z;z$l.nodes=new Array;var z$W=z$l.name=z$_[z$U.getUint16()];z$V._aniMap[z$W]=z$s,z$l.bone3DMap={},z$l.playTime=z$U.getFloat32(),z$l.playTime<=0&&console.error("播放时间不能为0  url="+z$V.url+" name="+z$l.name);var z$O=z$l.nodes.length=z$U.getUint8();for(z$p=z$l.totalKeyframeDatasLength=0;z$p<z$O;z$p++){var z$L=z$l.nodes[z$p]=new z$E;z$L.childs=[];var z$d=z$U.getInt16();0<=z$d&&(z$L.name=z$_[z$d],z$l.bone3DMap[z$L.name]=z$p),z$L.keyFrame=new Array,z$L.parentIndex=z$U.getInt16(),-1==z$L.parentIndex?z$L.parent=null:z$L.parent=z$l.nodes[z$L.parentIndex],z$L.lerpType=z$U.getUint8();var z$k=z$U.getUint32();z$h.pos=z$k;var z$y=z$L.keyframeWidth=z$h.getUint16();if(z$l.totalKeyframeDatasLength+=z$y,0===z$L.lerpType||1===z$L.lerpType)for(z$L.interpolationMethod=[],z$L.interpolationMethod.length=z$y,z$c=0;z$c<z$y;z$c++)z$L.interpolationMethod[z$c]=z$a.interpolation[z$h.getUint8()];null!=z$L.parent&&z$L.parent.childs.push(z$L);var z$D=z$U.getUint16();0<z$D&&(z$L.extenData=z$r.slice(z$U.pos,z$U.pos+z$D),z$U.pos+=z$D);var z$n,z$I=z$U.getUint16(),z$Q=0;for(z$c=0,z$R=z$L.keyFrame.length=z$I;z$c<z$R;z$c++){if((z$n=z$L.keyFrame[z$c]=new z$K).duration=z$U.getFloat32(),z$n.startTime=z$Q,2===z$L.lerpType){z$n.interpolationData=[];var z$H,z$w=z$U.getUint8();switch(z$H=z$U.getFloat32()){case 254:for(z$n.interpolationData.length=z$y,z$t=0;z$t<z$y;z$t++)z$n.interpolationData[z$t]=0;break;case 255:for(z$n.interpolationData.length=z$y,z$t=0;z$t<z$y;z$t++)z$n.interpolationData[z$t]=5;break;default:for(z$n.interpolationData.push(z$H),z$N=1;z$N<z$w;z$N++)z$n.interpolationData.push(z$U.getFloat32())}}for(z$n.data=new Float32Array(z$y),z$T=0;z$T<z$y;z$T++)z$n.data[z$T]=z$U.getFloat32(),-1e-8<z$n.data[z$T]&&z$n.data[z$T]<1e-8&&(z$n.data[z$T]=0);z$Q+=z$n.duration}z$n.startTime=z$l.playTime,z$L.playTime=z$l.playTime,z$V._calculateKeyFrame(z$L,z$I,z$y)}}},z$V}(),z$L=function(){function z$d(){}return z$s(z$d,"laya.ani.AnimationParser02"),z$d.READ_DATA=function(){z$d._DATA.offset=z$d._reader.getUint32(),z$d._DATA.size=z$d._reader.getUint32()},z$d.READ_BLOCK=function(){for(var z$V=z$d._BLOCK.count=z$d._reader.getUint16(),z$U=z$d._BLOCK.blockStarts=[],z$r=z$d._BLOCK.blockLengths=[],z$s=0;z$s<z$V;z$s++)z$U.push(z$d._reader.getUint32()),z$r.push(z$d._reader.getUint32())},z$d.READ_STRINGS=function(){var z$V=z$d._reader.getUint32(),z$U=z$d._reader.getUint16(),z$r=z$d._reader.pos;z$d._reader.pos=z$V+z$d._DATA.offset;for(var z$s=0;z$s<z$U;z$s++)z$d._strings[z$s]=z$d._reader.readUTFString();z$d._reader.pos=z$r},z$d.parse=function(z$V,z$U){z$d._templet=z$V;(z$d._reader=z$U).__getBuffer();z$d.READ_DATA(),z$d.READ_BLOCK(),z$d.READ_STRINGS();for(var z$r=0,z$s=z$d._BLOCK.count;z$r<z$s;z$r++){var z$p=z$U.getUint16(),z$c=z$d._strings[z$p],z$R=z$d["READ_"+z$c];if(null==z$R)throw new Error("model file err,no this function:"+z$p+" "+z$c);z$R.call()}},z$d.READ_ANIMATIONS=function(){var z$V=z$d._reader,z$U=z$V.__getBuffer(),z$r=0,z$s=0,z$p=0,z$c=0,z$R=z$V.getUint16(),z$T=[];for(z$T.length=z$R,z$r=0;z$r<z$R;z$r++)z$T[z$r]=z$a.interpolation[z$V.getByte()];var z$N=z$V.getUint8();for(z$d._templet._anis.length=z$N,z$r=0;z$r<z$N;z$r++){var z$t=z$d._templet._anis[z$r]={};z$t.nodes=new Array;var z$b=z$t.name=z$d._strings[z$V.getUint16()];z$d._templet._aniMap[z$b]=z$r,z$t.bone3DMap={},z$t.playTime=z$V.getFloat32();var z$S=z$t.nodes.length=z$V.getInt16();for(z$s=z$t.totalKeyframeDatasLength=0;z$s<z$S;z$s++){var z$_=z$t.nodes[z$s]={};z$_.keyframeWidth=z$R,z$_.childs=[];var z$G=z$V.getUint16();0<=z$G&&(z$_.name=z$d._strings[z$G],z$t.bone3DMap[z$_.name]=z$s),z$_.keyFrame=new Array,z$_.parentIndex=z$V.getInt16(),-1==z$_.parentIndex?z$_.parent=null:z$_.parent=z$t.nodes[z$_.parentIndex],z$t.totalKeyframeDatasLength+=z$R,z$_.interpolationMethod=z$T,null!=z$_.parent&&z$_.parent.childs.push(z$_);var z$q=z$V.getUint16(),z$u=null,z$h=null;for(z$p=0,z$c=z$_.keyFrame.length=z$q;z$p<z$c;z$p++){(z$u=z$_.keyFrame[z$p]={}).startTime=z$V.getFloat32(),z$h&&(z$h.duration=z$u.startTime-z$h.startTime);var z$l=z$d._DATA.offset,z$W=z$V.getUint32(),z$O=4*z$R,z$L=z$U.slice(z$l+z$W,z$l+z$W+z$O);z$u.data=new Float32Array(z$L),z$h=z$u}z$u.duration=0,z$_.playTime=z$t.playTime,z$d._templet._calculateKeyFrame(z$_,z$q,z$R)}}},z$d._templet=null,z$d._reader=null,z$d._strings=[],z$r(z$d,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),z$d}(),z$KV=(function(){function z$V(){}z$s(z$V,"laya.ani.AnimationState"),z$V.stopped=0,z$V.paused=1,z$V.playing=2}(),function(){function z$p(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new z$AV,this.resultMatrix=new z$zV,this._children=[]}z$s(z$p,"laya.ani.bone.Bone");var z$V=z$p.prototype;return z$V.setTempMatrix=function(z$V){this._tempMatrix=z$V;var z$U,z$r=0;for(z$r=0,z$U=this._children.length;z$r<z$U;z$r++)this._children[z$r].setTempMatrix(this._tempMatrix)},z$V.update=function(z$V){var z$U;if(this.rotation=this.transform.skX,z$V)z$U=this.resultTransform.getMatrix(),z$zV.mul(z$U,z$V,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)z$U=this.resultTransform.getMatrix(),z$zV.mul(z$U,this.parentBone.resultMatrix,this.resultMatrix);else{var z$r=this.parentBone,z$s=NaN,z$p=NaN,z$c=NaN,z$R=this.parentBone.resultMatrix;z$U=this.resultTransform.getMatrix();var z$T=z$R.a*z$U.tx+z$R.c*z$U.ty+z$R.tx,z$N=z$R.b*z$U.tx+z$R.d*z$U.ty+z$R.ty,z$t=new z$zV;this.inheritRotation?(z$s=Math.atan2(z$r.resultMatrix.b,z$r.resultMatrix.a),z$p=Math.cos(z$s),z$c=Math.sin(z$s),z$t.setTo(z$p,z$c,-z$c,z$p,0,0),z$zV.mul(this._tempMatrix,z$t,z$zV.TEMP),z$zV.TEMP.copyTo(z$t),z$U=this.resultTransform.getMatrix(),z$zV.mul(z$U,z$t,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,z$U=this.resultTransform.getMatrix(),z$zV.TEMP.identity(),z$zV.TEMP.d=this.d,z$zV.mul(z$U,z$zV.TEMP,this.resultMatrix)),this.resultMatrix.tx=z$T,this.resultMatrix.ty=z$N}else(z$U=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var z$b,z$S=0;for(z$S=0,z$b=this._children.length;z$S<z$b;z$S++)this._children[z$S].update()},z$V.updateChild=function(){var z$V,z$U=0;for(z$U=0,z$V=this._children.length;z$U<z$V;z$U++)this._children[z$U].update()},z$V.setRotation=function(z$V){this._sprite&&(this._sprite.rotation=180*z$V/Math.PI)},z$V.updateDraw=function(z$V,z$U){z$p.ShowBones&&!z$p.ShowBones[this.name]||(this._sprite||(this._sprite=new z$cV,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),z$pV.stage.addChild(this._sprite)),this._sprite.x=z$V+this.resultMatrix.tx,this._sprite.y=z$U+this.resultMatrix.ty);var z$r,z$s=0;for(z$s=0,z$r=this._children.length;z$s<z$r;z$s++)this._children[z$s].updateDraw(z$V,z$U)},z$V.addChild=function(z$V){this._children.push(z$V),z$V.parentBone=this},z$V.findBone=function(z$V){if(this.name==z$V)return this;var z$U,z$r,z$s=0;for(z$s=0,z$U=this._children.length;z$s<z$U;z$s++)if(z$r=this._children[z$s].findBone(z$V))return z$r;return null},z$V.localToWorld=function(z$V){var z$U=z$V[0],z$r=z$V[1];z$V[0]=z$U*this.resultMatrix.a+z$r*this.resultMatrix.c+this.resultMatrix.tx,z$V[1]=z$U*this.resultMatrix.b+z$r*this.resultMatrix.d+this.resultMatrix.ty},z$p.ShowBones={},z$p}()),z$mV=function(){function z$u(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}z$s(z$u,"laya.ani.bone.BoneSlot");var z$V=z$u.prototype;return z$V.showSlotData=function(z$V,z$U){void 0===z$U&&(z$U=!0),this.currSlotData=z$V,z$U&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},z$V.showDisplayByName=function(z$V){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(z$V))},z$V.replaceDisplayByName=function(z$V,z$U){if(this.currSlotData){var z$r;z$r=this.currSlotData.getDisplayByName(z$V);var z$s;z$s=this.currSlotData.getDisplayByName(z$U),this.replaceDisplayByIndex(z$r,z$s)}},z$V.replaceDisplayByIndex=function(z$V,z$U){this.currSlotData&&(this._replaceDic[z$V]=z$U,this.displayIndex==z$V&&this.showDisplayByIndex(z$V))},z$V.showDisplayByIndex=function(z$V){if(null!=this._replaceDic[z$V]&&(z$V=this._replaceDic[z$V]),this.currSlotData&&-1<z$V&&z$V<this.currSlotData.displayArr.length){if(this.displayIndex=z$V,this.currDisplayData=this.currSlotData.displayArr[z$V],this.currDisplayData){var z$U=this.currDisplayData.name;this.currTexture=this.templet.getTexture(z$U),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!z$h.isConchApp||z$h.isConchApp&&"0.9.15"<z$cV.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},z$V.replaceSkin=function(z$V){this._diyTexture=z$V,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},z$V.setParentMatrix=function(z$V){this._parentMatrix=z$V},z$V.draw=function(z$V,z$U,z$r,z$s){if(void 0===z$r&&(z$r=!1),void 0===z$s&&(z$s=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var z$p,z$c=this.currTexture;switch(this._diyTexture&&(z$c=this._diyTexture),this.currDisplayData.type){case 0:if(z$V){var z$R=this.getDisplayMatrix();if(this._parentMatrix){var z$T=!1;if(z$R){var z$N;if(z$zV.mul(z$R,this._parentMatrix,z$zV.TEMP),z$N=z$r?(null==this._resultMatrix&&(this._resultMatrix=new z$zV),this._resultMatrix):new z$zV,!z$h.isWebGL&&this.currDisplayData.uvs||z$h.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var z$t=z$u._tempMatrix;z$t.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(z$t.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(z$T=!0,z$t.rotate(-Math.PI/2)),z$zV.mul(z$t,z$zV.TEMP,z$N)}else z$zV.TEMP.copyTo(z$N);z$T?z$V.drawTexture(z$c,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,z$N):z$V.drawTexture(z$c,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,z$N)}}}break;case 1:if(null==(z$p=z$r?(null==this._skinSprite&&(this._skinSprite=z$u.createSkinMesh()),this._skinSprite):z$u.createSkinMesh()))return;var z$b;if(null==this.currDisplayData.bones){var z$S,z$_=this.currDisplayData.weights;this.deformData&&(z$_=this.deformData),z$S=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=z$y.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=z$y.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=z$_;this.currDisplayData.triangles.length;z$b=this.currDisplayData.triangles,z$p.init2(z$c,null,z$b,this._mVerticleArr,z$S);var z$G,z$q=this.getDisplayMatrix();if(this._parentMatrix)if(z$q)z$zV.mul(z$q,this._parentMatrix,z$zV.TEMP),z$G=z$r?(null==this._resultMatrix&&(this._resultMatrix=new z$zV),this._resultMatrix):new z$zV,z$zV.TEMP.copyTo(z$G),z$p.transform=z$G}else this.skinMesh(z$U,z$p,z$s);z$V.drawSkin(z$p);break;case 2:if(null==(z$p=z$r?(null==this._skinSprite&&(this._skinSprite=z$u.createSkinMesh()),this._skinSprite):z$u.createSkinMesh()))return;this.skinMesh(z$U,z$p,z$s),z$V.drawSkin(z$p)}}},z$V.skinMesh=function(z$V,z$U,z$r){var z$s,z$p=this.currTexture,z$c=this.currDisplayData.bones;z$s=this._diyTexture?(z$p=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=z$y.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=z$y.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var z$R,z$T,z$N=this.currDisplayData.weights,z$t=this.currDisplayData.triangles,z$b=0,z$S=0,z$_=0,z$G=NaN,z$q=NaN,z$u=0,z$h=0,z$l=[],z$W=0,z$O=0;if(this.deformData&&0<this.deformData.length){var z$L=0;for(z$W=0,z$O=z$c.length;z$W<z$O;){for(z$_=z$c[z$W++]+z$W,z$S=z$b=0;z$W<z$_;z$W++)z$T=z$V[z$c[z$W]],z$G=z$N[z$u]+this.deformData[z$L++],z$q=z$N[z$u+1]+this.deformData[z$L++],z$h=z$N[z$u+2],z$b+=(z$G*z$T.a+z$q*z$T.c+z$T.tx)*z$h,z$S+=(z$G*z$T.b+z$q*z$T.d+z$T.ty)*z$h,z$u+=3;z$l.push(z$b,z$S)}}else for(z$W=0,z$O=z$c.length;z$W<z$O;){for(z$_=z$c[z$W++]+z$W,z$S=z$b=0;z$W<z$_;z$W++)z$T=z$V[z$c[z$W]],z$G=z$N[z$u],z$q=z$N[z$u+1],z$h=z$N[z$u+2],z$b+=(z$G*z$T.a+z$q*z$T.c+z$T.tx)*z$h,z$S+=(z$G*z$T.b+z$q*z$T.d+z$T.ty)*z$h,z$u+=3;z$l.push(z$b,z$S)}this._mVerticleArr=z$l,z$R=z$t,z$U.init2(z$p,null,z$R,this._mVerticleArr,z$s)},z$V.drawBonePoint=function(z$V){z$V&&this._parentMatrix&&z$V.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},z$V.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},z$V.getMatrix=function(){return this._resultMatrix},z$V.copy=function(){var z$V=new z$u;return z$V.type="copy",z$V.name=this.name,z$V.attachmentName=this.attachmentName,z$V.srcDisplayIndex=this.srcDisplayIndex,z$V.parent=this.parent,z$V.displayIndex=this.displayIndex,z$V.templet=this.templet,z$V.currSlotData=this.currSlotData,z$V.currTexture=this.currTexture,z$V.currDisplayData=this.currDisplayData,z$V},z$u.createSkinMesh=function(){return z$h.isWebGL||z$h.isConchApp?z$G.skinAniSprite():(z$h.isWebGL,null)},z$r(z$u,["_tempMatrix",function(){return this._tempMatrix=new z$zV}]),z$u}(),z$aV=function(){function z$V(){this.skinName=null,this.deformSlotDataList=[]}return z$s(z$V,"laya.ani.bone.DeformAniData"),z$V}(),z$ZV=function(){function z$V(){this.deformSlotDisplayList=[]}return z$s(z$V,"laya.ani.bone.DeformSlotData"),z$V}(),z$xV=function(){function z$V(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}z$s(z$V,"laya.ani.bone.DeformSlotDisplayData");var z$U=z$V.prototype;return z$U.binarySearch1=function(z$V,z$U){var z$r=0,z$s=z$V.length-2;if(0==z$s)return 1;for(var z$p=z$s>>>1;;){if(z$V[Math.floor(z$p+1)]<=z$U?z$r=z$p+1:z$s=z$p,z$r==z$s)return z$r+1;z$p=z$r+z$s>>>1}return 0},z$U.apply=function(z$V,z$U,z$r){if(void 0===z$r&&(z$r=1),z$V+=.05,!(this.timeList.length<=0)){var z$s=0;if(!(z$V<this.timeList[0])){var z$p=this.vectices[0].length,z$c=[],z$R=this.binarySearch1(this.timeList,z$V);if(this.frameIndex=z$R,z$V>=this.timeList[this.timeList.length-1]){var z$T=this.vectices[this.vectices.length-1];if(z$r<1)for(z$s=0;z$s<z$p;z$s++)z$c[z$s]+=(z$T[z$s]-z$c[z$s])*z$r;else for(z$s=0;z$s<z$p;z$s++)z$c[z$s]=z$T[z$s];this.deformData=z$c}else{this.tweenKeyList[this.frameIndex];var z$N=this.vectices[this.frameIndex-1],z$t=this.vectices[this.frameIndex],z$b=this.timeList[this.frameIndex-1],z$S=this.timeList[this.frameIndex];z$r=this.tweenKeyList[z$R-1]?(z$V-z$b)/(z$S-z$b):0;var z$_=NaN;for(z$s=0;z$s<z$p;z$s++)z$_=z$N[z$s],z$c[z$s]=z$_+(z$t[z$s]-z$_)*z$r;this.deformData=z$c}}}},z$V}(),z$$V=function(){function z$V(){this.time=NaN,this.drawOrder=[]}return z$s(z$V,"laya.ani.bone.DrawOrderData"),z$V}(),z$jV=function(){function z$V(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return z$s(z$V,"laya.ani.bone.EventData"),z$V}(),z$W=function(){function z$sV(z$V,z$U){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=z$V,this._targetBone=z$U[z$V.targetBoneIndex],this.isSpine=z$V.isSpine,null==this._bones&&(this._bones=[]);for(var z$r=this._bones.length=0,z$s=z$V.boneIndexs.length;z$r<z$s;z$r++)this._bones.push(z$U[z$V.boneIndexs[z$r]]);this.name=z$V.name,this.mix=z$V.mix,this.bendDirection=z$V.bendDirection}z$s(z$sV,"laya.ani.bone.IkConstraint");var z$V=z$sV.prototype;return z$V.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},z$V._applyIk1=function(z$V,z$U,z$r,z$s){var z$p=z$V.parentBone,z$c=1/(z$p.resultMatrix.a*z$p.resultMatrix.d-z$p.resultMatrix.b*z$p.resultMatrix.c),z$R=z$U-z$p.resultMatrix.tx,z$T=z$r-z$p.resultMatrix.ty,z$N=(z$R*z$p.resultMatrix.d-z$T*z$p.resultMatrix.c)*z$c-z$V.transform.x,z$t=(z$T*z$p.resultMatrix.a-z$R*z$p.resultMatrix.b)*z$c-z$V.transform.y,z$b=Math.atan2(z$t,z$N)*z$sV.radDeg-0-z$V.transform.skX;z$V.transform.scX<0&&(z$b+=180),180<z$b?z$b-=360:z$b<-180&&(z$b+=360),z$V.transform.skX=z$V.transform.skY=z$V.transform.skX+z$b*z$s,z$V.update()},z$V.updatePos=function(z$V,z$U){this._sp&&this._sp.pos(z$V,z$U)},z$V._applyIk2=function(z$V,z$U,z$r,z$s,z$p,z$c){if(0!=z$c){var z$R=z$V.resultTransform.x,z$T=z$V.resultTransform.y,z$N=z$V.transform.scX,z$t=z$V.transform.scY,z$b=z$U.transform.scX,z$S=0,z$_=0,z$G=0;z$G=z$N<0?(z$N=-z$N,z$S=180,-1):(z$S=0,1),z$t<0&&(z$t=-z$t,z$G=-z$G),z$_=z$b<0?(z$b=-z$b,180):0;var z$q=z$U.resultTransform.x,z$u=NaN,z$h=NaN,z$l=NaN,z$W=z$V.resultMatrix.a,z$O=z$V.resultMatrix.c,z$L=z$V.resultMatrix.b,z$d=z$V.resultMatrix.d,z$k=Math.abs(z$N-z$t)<=1e-4;z$l=z$k?(z$h=z$W*z$q+z$O*(z$u=z$U.resultTransform.y)+z$V.resultMatrix.tx,z$L*z$q+z$d*z$u+z$V.resultMatrix.ty):(z$u=0,z$h=z$W*z$q+z$V.resultMatrix.tx,z$L*z$q+z$V.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new z$cV,z$pV.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(z$r,z$s,15,"#ffff00"),this._sp.graphics.drawCircle(z$h,z$l,15,"#ff00ff")),z$V.setRotation(Math.atan2(z$l-z$V.resultMatrix.ty,z$h-z$V.resultMatrix.tx));var z$y=z$V.parentBone;z$W=z$y.resultMatrix.a,z$O=z$y.resultMatrix.c,z$L=z$y.resultMatrix.b;var z$D=1/(z$W*(z$d=z$y.resultMatrix.d)-z$O*z$L),z$n=z$r-z$y.resultMatrix.tx,z$I=z$s-z$y.resultMatrix.ty,z$Q=(z$n*z$d-z$I*z$O)*z$D-z$R,z$H=(z$I*z$W-z$n*z$L)*z$D-z$T,z$w=((z$n=z$h-z$y.resultMatrix.tx)*z$d-(z$I=z$l-z$y.resultMatrix.ty)*z$O)*z$D-z$R,z$z=(z$I*z$W-z$n*z$L)*z$D-z$T,z$E=Math.sqrt(z$w*z$w+z$z*z$z),z$K=z$U.length*z$b,z$m=NaN,z$a=NaN;if(z$k){var z$Z=(z$Q*z$Q+z$H*z$H-z$E*z$E-(z$K*=z$N)*z$K)/(2*z$E*z$K);z$Z<-1?z$Z=-1:1<z$Z&&(z$Z=1),z$a=Math.acos(z$Z)*z$p,z$W=z$E+z$K*z$Z,z$O=z$K*Math.sin(z$a),z$m=Math.atan2(z$H*z$W-z$Q*z$O,z$Q*z$W+z$H*z$O)}else{var z$x=(z$W=z$N*z$K)*z$W,z$$=(z$O=z$t*z$K)*z$O,z$j=z$Q*z$Q+z$H*z$H,z$o=Math.atan2(z$H,z$Q),z$J=-2*z$$*z$E,z$i=z$$-z$x;if(0<(z$d=z$J*z$J-4*z$i*(z$L=z$$*z$E*z$E+z$x*z$j-z$x*z$$))){var z$B=Math.sqrt(z$d);z$J<0&&(z$B=-z$B);var z$P=(z$B=-(z$J+z$B)/2)/z$i,z$M=z$L/z$B,z$A=Math.abs(z$P)<Math.abs(z$M)?z$P:z$M;z$A*z$A<=z$j&&(z$I=Math.sqrt(z$j-z$A*z$A)*z$p,z$m=z$o-Math.atan2(z$I,z$A),z$a=Math.atan2(z$I/z$t,(z$A-z$E)/z$N))}var z$X=0,z$e=Number.MAX_VALUE,z$F=0,z$g=0,z$v=0,z$Y=0,z$C=0,z$f=0;z$Y<(z$d=(z$n=z$E+z$W)*z$n)&&(z$v=0,z$Y=z$d,z$C=z$n),(z$d=(z$n=z$E-z$W)*z$n)<z$e&&(z$X=Math.PI,z$e=z$d,z$F=z$n);var z$VV=Math.acos(-z$W*z$E/(z$x-z$$));(z$d=(z$n=z$W*Math.cos(z$VV)+z$E)*z$n+(z$I=z$O*Math.sin(z$VV))*z$I)<z$e&&(z$X=z$VV,z$e=z$d,z$F=z$n,z$g=z$I),z$Y<z$d&&(z$v=z$VV,z$Y=z$d,z$C=z$n,z$f=z$I),z$a=z$j<=(z$e+z$Y)/2?(z$m=z$o-Math.atan2(z$g*z$p,z$F),z$X*z$p):(z$m=z$o-Math.atan2(z$f*z$p,z$C),z$v*z$p)}var z$UV=Math.atan2(z$u,z$q)*z$G,z$rV=z$V.resultTransform.skX;180<(z$m=(z$m-z$UV)*z$sV.radDeg+z$S-z$rV)?z$m-=360:z$m<-180&&(z$m+=360),z$V.resultTransform.x=z$R,z$V.resultTransform.y=z$T,z$V.resultTransform.skX=z$V.resultTransform.skY=z$rV+z$m*z$c,z$rV=z$U.resultTransform.skX,180<(z$a=((z$a+z$UV)*z$sV.radDeg-0)*z$G+z$_-(z$rV%=360))?z$a-=360:z$a<-180&&(z$a+=360),z$U.resultTransform.x=z$q,z$U.resultTransform.y=z$u,z$U.resultTransform.skX=z$U.resultTransform.skY=z$U.resultTransform.skY+z$a*z$c,z$V.update()}},z$V._applyIk3=function(z$V,z$U,z$r,z$s,z$p,z$c){if(0!=z$c){var z$R,z$T,z$N=z$U.resultMatrix.a*z$U.length,z$t=z$U.resultMatrix.b*z$U.length,z$b=z$N*z$N+z$t*z$t,z$S=Math.sqrt(z$b),z$_=z$V.resultMatrix.tx,z$G=z$V.resultMatrix.ty,z$q=z$U.resultMatrix.tx,z$u=z$U.resultMatrix.ty,z$h=z$q-z$_,z$l=z$u-z$G,z$W=z$h*z$h+z$l*z$l,z$O=Math.sqrt(z$W),z$L=(z$h=z$r-z$V.resultMatrix.tx)*z$h+(z$l=z$s-z$V.resultMatrix.ty)*z$l,z$d=Math.sqrt(z$L);if(z$S+z$O<=z$d||z$d+z$S<=z$O||z$d+z$O<=z$S){var z$k=NaN;z$q=z$_+(z$k=z$S+z$O<=z$d?1:-1)*(z$r-z$_)*z$O/z$d,z$u=z$G+z$k*(z$s-z$G)*z$O/z$d}else{var z$y=(z$W-z$b+z$L)/(2*z$L),z$D=Math.sqrt(z$W-z$y*z$y*z$L)/z$d,z$n=z$_+z$h*z$y,z$I=z$G+z$l*z$y,z$Q=-z$l*z$D,z$H=z$h*z$D;z$u=0<z$p?(z$q=z$n-z$Q,z$I-z$H):(z$q=z$n+z$Q,z$I+z$H)}z$R=z$q,z$T=z$u,this.isDebug&&(this._sp||(this._sp=new z$cV,z$pV.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(z$_,z$G,15,"#ff00ff"),this._sp.graphics.drawCircle(z$r,z$s,15,"#ffff00"),this._sp.graphics.drawCircle(z$R,z$T,15,"#ff00ff"));var z$w,z$z;z$w=Math.atan2(z$T-z$V.resultMatrix.ty,z$R-z$V.resultMatrix.tx),z$V.setRotation(z$w),(z$z=z$sV._tempMatrix).identity(),z$z.rotate(z$w),z$z.scale(z$V.resultMatrix.getScaleX(),z$V.resultMatrix.getScaleY()),z$z.translate(z$V.resultMatrix.tx,z$V.resultMatrix.ty),z$z.copyTo(z$V.resultMatrix),z$V.updateChild();var z$E,z$K;z$E=Math.atan2(z$s-z$T,z$r-z$R),z$U.setRotation(z$E),(z$K=z$sV._tempMatrix).identity(),z$K.rotate(z$E),z$K.scale(z$U.resultMatrix.getScaleX(),z$U.resultMatrix.getScaleY()),z$K.translate(z$R,z$T),z$z.copyTo(z$U.resultMatrix),z$U.updateChild()}},z$r(z$sV,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new z$zV}]),z$sV}(),z$oV=function(){function z$V(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return z$s(z$V,"laya.ani.bone.IkConstraintData"),z$V}(),z$d=function(){function z$K(z$V,z$U){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=z$V,this.position=z$V.position,this.spacing=z$V.spacing,this.rotateMix=z$V.rotateMix,this.translateMix=z$V.translateMix,this.bones=[];for(var z$r=this.data.bones,z$s=0,z$p=z$r.length;z$s<z$p;z$s++)this.bones.push(z$U[z$r[z$s]])}z$s(z$K,"laya.ani.bone.PathConstraint");var z$V=z$K.prototype;return z$V.apply=function(z$V,z$U){if(this.target){var z$r=this.translateMix,z$s=this.translateMix,z$p=0<z$s,z$c=this.data.spacingMode,z$R="length"==z$c,z$T=this.data.rotateMode,z$N="tangent"==z$T,z$t="chainScale"==z$T,z$b=[],z$S=this.bones.length,z$_=z$N?z$S:z$S+1,z$G=[];(this._spaces=z$G)[0]=this.position;var z$q=this.spacing;if(z$t||z$R)for(var z$u=0,z$h=z$_-1;z$u<z$h;){var z$l=this.bones[z$u],z$W=z$l.length,z$O=z$W*z$l.resultMatrix.a,z$L=z$W*z$l.resultMatrix.b;z$W=Math.sqrt(z$O*z$O+z$L*z$L),z$t&&(z$b[z$u]=z$W),z$G[++z$u]=z$R?Math.max(0,z$W+z$q):z$q}else for(z$u=1;z$u<z$_;z$u++)z$G[z$u]=z$q;var z$d=this.computeWorldPositions(this.target,z$V,z$U,z$_,z$N,"percent"==this.data.positionMode,"percent"==z$c);if(this._debugKey){for(z$u=0;z$u<z$d.length;z$u++)z$U.drawCircle(z$d[z$u++],z$d[z$u++],5,"#00ff00");var z$k=[];for(z$u=0;z$u<z$d.length;z$u++)z$k.push(z$d[z$u++],z$d[z$u++]);z$U.drawLines(0,0,z$k,"#ff0000")}var z$y=z$d[0],z$D=z$d[1],z$n=this.data.offsetRotation,z$I="chain"==z$T&&0==z$n,z$Q=NaN;for(z$u=0,z$Q=3;z$u<z$S;z$u++,z$Q+=3){(z$l=this.bones[z$u]).resultMatrix.tx+=(z$y-z$l.resultMatrix.tx)*z$r,z$l.resultMatrix.ty+=(z$D-z$l.resultMatrix.ty)*z$r;var z$H=(z$O=z$d[z$Q])-z$y,z$w=(z$L=z$d[z$Q+1])-z$D;if(z$t&&0!=(z$W=z$b[z$u])){var z$z=(Math.sqrt(z$H*z$H+z$w*z$w)/z$W-1)*z$s+1;z$l.resultMatrix.a*=z$z,z$l.resultMatrix.c*=z$z}if(z$y=z$O,z$D=z$L,z$p){var z$E=z$l.resultMatrix.a,z$K=z$l.resultMatrix.c,z$m=z$l.resultMatrix.b,z$a=z$l.resultMatrix.d,z$Z=NaN,z$x=NaN,z$$=NaN;z$Z=z$N?z$d[z$Q-1]:0==z$G[z$u+1]?z$d[z$Q+2]:Math.atan2(z$w,z$H),z$Z-=Math.atan2(z$m,z$E)-z$n/180*Math.PI,z$I&&(z$x=Math.cos(z$Z),z$$=Math.sin(z$Z),z$y+=((z$W=z$l.length)*(z$x*z$E-z$$*z$m)-z$H)*z$s,z$D+=(z$W*(z$$*z$E+z$x*z$m)-z$w)*z$s),z$Z>Math.PI?z$Z-=2*Math.PI:z$Z<-Math.PI&&(z$Z+=2*Math.PI),z$Z*=z$s,z$x=Math.cos(z$Z),z$$=Math.sin(z$Z),z$l.resultMatrix.a=z$x*z$E-z$$*z$m,z$l.resultMatrix.c=z$x*z$K-z$$*z$a,z$l.resultMatrix.b=z$$*z$E+z$x*z$m,z$l.resultMatrix.d=z$$*z$K+z$x*z$a}}}},z$V.computeWorldVertices2=function(z$V,z$U,z$r,z$s,z$p,z$c){var z$R,z$T,z$N=z$V.currDisplayData.bones,z$t=z$V.currDisplayData.weights,z$b=z$V.currDisplayData.triangles,z$S=0,z$_=0,z$G=0,z$q=0,z$u=0,z$h=0,z$l=0,z$W=0,z$O=0,z$L=0,z$d=0;if(null!=z$N){for(z$S=0;z$S<z$r;z$S+=2)z$_+=(z$q=z$N[z$_])+1,z$G+=z$q;var z$k=z$U;for(z$u=z$c,z$h=3*z$G;z$u<z$s;z$u+=2){for(z$W=z$l=0,z$q=z$N[z$_++],z$q+=z$_;z$_<z$q;z$_++,z$h+=3){z$R=z$k[z$N[z$_]].resultMatrix,z$O=z$t[z$h],z$L=z$t[z$h+1];var z$y=z$t[z$h+2];z$l+=(z$O*z$R.a+z$L*z$R.c+z$R.tx)*z$y,z$W+=(z$O*z$R.b+z$L*z$R.d+z$R.ty)*z$y}z$p[z$u]=z$l,z$p[z$u+1]=z$W}}else{var z$D,z$n;if(z$b||(z$b=z$t),z$V.deformData&&(z$b=z$V.deformData),z$D=z$V.parent,z$U)for(z$d=z$U.length,z$S=0;z$S<z$d;z$S++)if(z$U[z$S].name==z$D){z$T=z$U[z$S];break}z$T&&(z$n=z$T.resultMatrix),z$n||(z$n=z$K._tempMt);var z$I=z$n.tx,z$Q=z$n.ty,z$H=z$n.a,z$w=z$n.b,z$z=z$n.c,z$E=z$n.d;for(z$T&&(z$E*=z$T.d),z$_=z$r,z$u=z$c;z$u<z$s;z$_+=2,z$u+=2)z$O=z$b[z$_],z$L=z$b[z$_+1],z$p[z$u]=z$O*z$H+z$L*z$w+z$I,z$p[z$u+1]=-(z$O*z$z+z$L*z$E+z$Q)}},z$V.computeWorldPositions=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R){z$V.currDisplayData.bones,z$V.currDisplayData.weights,z$V.currDisplayData.triangles;var z$T=[],z$N=0,z$t=z$V.currDisplayData.verLen,z$b=this.position,z$S=this._spaces,z$_=[],z$G=[],z$q=z$t/6,z$u=-1,z$h=NaN,z$l=0,z$W=0,z$O=NaN,z$L=NaN,z$d=NaN,z$k=NaN;if(z$q--,z$t-=4,this.computeWorldVertices2(z$V,z$U,2,z$t,z$T,0),this._debugKey)for(z$N=0;z$N<z$T.length;)z$r.drawCircle(z$T[z$N++],z$T[z$N++],10,"#ff0000");z$_=z$T,this._curves.length=z$q;var z$y=this._curves,z$D=z$_[z$h=0],z$n=z$_[1],z$I=0,z$Q=0,z$H=0,z$w=0,z$z=0,z$E=0,z$K=NaN,z$m=NaN,z$a=NaN,z$Z=NaN,z$x=NaN,z$$=NaN,z$j=NaN,z$o=NaN,z$J=0;for(z$N=0,z$J=2;z$N<z$q;z$N++,z$J+=6)z$I=z$_[z$J],z$Q=z$_[z$J+1],z$H=z$_[z$J+2],z$w=z$_[z$J+3],z$x=2*(z$K=.1875*(z$D-2*z$I+z$H))+(z$a=.09375*(3*(z$I-z$H)-z$D+(z$z=z$_[z$J+4]))),z$$=2*(z$m=.1875*(z$n-2*z$Q+z$w))+(z$Z=.09375*(3*(z$Q-z$w)-z$n+(z$E=z$_[z$J+5]))),z$j=.75*(z$I-z$D)+z$K+.16666667*z$a,z$o=.75*(z$Q-z$n)+z$m+.16666667*z$Z,z$h+=Math.sqrt(z$j*z$j+z$o*z$o),z$j+=z$x,z$o+=z$$,z$x+=z$a,z$$+=z$Z,z$h+=Math.sqrt(z$j*z$j+z$o*z$o),z$j+=z$x,z$o+=z$$,z$h+=Math.sqrt(z$j*z$j+z$o*z$o),z$j+=z$x+z$a,z$o+=z$$+z$Z,z$h+=Math.sqrt(z$j*z$j+z$o*z$o),z$y[z$N]=z$h,z$D=z$z,z$n=z$E;if(z$c&&(z$b*=z$h),z$R)for(z$N=0;z$N<z$s;z$N++)z$S[z$N]*=z$h;var z$i=this._segments,z$B=0,z$P=0;for(z$P=z$W=z$l=z$N=0;z$N<z$s;z$N++,z$l+=3)if((z$O=z$b+=z$L=z$S[z$N])<0)this.addBeforePosition(z$O,z$_,0,z$G,z$l);else if(z$h<z$O)this.addAfterPosition(z$O-z$h,z$_,z$t-4,z$G,z$l);else{for(;;z$W++)if(!((z$k=z$y[z$W])<z$O)){0==z$W?z$O/=z$k:z$O=(z$O-(z$d=z$y[z$W-1]))/(z$k-z$d);break}if(z$W!=z$u){var z$M=6*(z$u=z$W);for(z$D=z$_[z$M],z$n=z$_[z$M+1],z$I=z$_[z$M+2],z$Q=z$_[z$M+3],z$H=z$_[z$M+4],z$w=z$_[z$M+5],z$x=2*(z$K=.03*(z$D-2*z$I+z$H))+(z$a=.006*(3*(z$I-z$H)-z$D+(z$z=z$_[z$M+6]))),z$$=2*(z$m=.03*(z$n-2*z$Q+z$w))+(z$Z=.006*(3*(z$Q-z$w)-z$n+(z$E=z$_[z$M+7]))),z$j=.3*(z$I-z$D)+z$K+.16666667*z$a,z$o=.3*(z$Q-z$n)+z$m+.16666667*z$Z,z$B=Math.sqrt(z$j*z$j+z$o*z$o),z$i[0]=z$B,z$M=1;z$M<8;z$M++)z$j+=z$x,z$o+=z$$,z$x+=z$a,z$$+=z$Z,z$B+=Math.sqrt(z$j*z$j+z$o*z$o),z$i[z$M]=z$B;z$j+=z$x,z$o+=z$$,z$B+=Math.sqrt(z$j*z$j+z$o*z$o),z$i[8]=z$B,z$j+=z$x+z$a,z$o+=z$$+z$Z,z$B+=Math.sqrt(z$j*z$j+z$o*z$o),z$i[9]=z$B,z$P=0}for(z$O*=z$B;;z$P++)if(!((z$k=z$i[z$P])<z$O)){0==z$P?z$O/=z$k:z$O=z$P+(z$O-(z$d=z$i[z$P-1]))/(z$k-z$d);break}this.addCurvePosition(.1*z$O,z$D,z$n,z$I,z$Q,z$H,z$w,z$z,z$E,z$G,z$l,z$p||0<z$N&&0==z$L)}return z$G},z$V.addBeforePosition=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$U[z$r],z$R=z$U[z$r+1],z$T=z$U[z$r+2]-z$c,z$N=z$U[z$r+3]-z$R,z$t=Math.atan2(z$N,z$T);z$s[z$p]=z$c+z$V*Math.cos(z$t),z$s[z$p+1]=z$R+z$V*Math.sin(z$t),z$s[z$p+2]=z$t},z$V.addAfterPosition=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$U[z$r+2],z$R=z$U[z$r+3],z$T=z$c-z$U[z$r],z$N=z$R-z$U[z$r+1],z$t=Math.atan2(z$N,z$T);z$s[z$p]=z$c+z$V*Math.cos(z$t),z$s[z$p+1]=z$R+z$V*Math.sin(z$t),z$s[z$p+2]=z$t},z$V.addCurvePosition=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b,z$S){0==z$V&&(z$V=1e-4);var z$_=z$V*z$V,z$G=z$_*z$V,z$q=1-z$V,z$u=z$q*z$q,z$h=z$u*z$q,z$l=z$q*z$V,z$W=3*z$l,z$O=z$q*z$W,z$L=z$W*z$V,z$d=z$U*z$h+z$s*z$O+z$c*z$L+z$T*z$G,z$k=z$r*z$h+z$p*z$O+z$R*z$L+z$N*z$G;z$t[z$b]=z$d,z$t[z$b+1]=z$k,z$t[z$b+2]=z$S?Math.atan2(z$k-(z$r*z$u+z$p*z$l*2+z$R*z$_),z$d-(z$U*z$u+z$s*z$l*2+z$c*z$_)):0},z$K.NONE=-1,z$K.BEFORE=-2,z$K.AFTER=-3,z$r(z$K,["_tempMt",function(){return this._tempMt=new z$zV}]),z$K}(),z$JV=function(){function z$V(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return z$s(z$V,"laya.ani.bone.PathConstraintData"),z$V}(),z$iV=function(){function z$V(){this.name=null,this.slotArr=[]}return z$s(z$V,"laya.ani.bone.SkinData"),z$V}(),z$BV=function(){function z$V(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}z$s(z$V,"laya.ani.bone.SkinSlotDisplayData");var z$U=z$V.prototype;return z$U.createTexture=function(z$V){return this.texture||(this.texture=new z$EV(z$V.bitmap,this.uvs),z$V.bitmap.alphaTexture&&(this.texture.alphaTexture=new z$EV(z$V.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=z$V.height,this.texture.height=z$V.width,this.texture.offsetX=-z$V.offsetX,this.texture.offsetY=-z$V.offsetY,this.texture.sourceWidth=z$V.sourceHeight,this.texture.sourceHeight=z$V.sourceWidth):(this.texture.width=z$V.width,this.texture.height=z$V.height,this.texture.offsetX=-z$V.offsetX,this.texture.offsetY=-z$V.offsetY,this.texture.sourceWidth=z$V.sourceWidth,this.texture.sourceHeight=z$V.sourceHeight),z$h.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},z$U.destory=function(){this.texture&&this.texture.destroy()},z$V}(),z$PV=function(){function z$V(){this.name=null,this.displayArr=[]}return z$s(z$V,"laya.ani.bone.SlotData"),z$V.prototype.getDisplayByName=function(z$V){for(var z$U=0,z$r=this.displayArr.length;z$U<z$r;z$U++)if(this.displayArr[z$U].attachmentName==z$V)return z$U;return-1},z$V}(),z$k=function(){function z$V(z$V,z$U){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=z$u(2,0),this._data=z$V,null==this._bones&&(this._bones=[]),this.target=z$U[z$V.targetIndex];var z$r,z$s=0;for(z$s=0,z$r=z$V.boneIndexs.length;z$s<z$r;z$s++)this._bones.push(z$U[z$V.boneIndexs[z$s]]);this.rotateMix=z$V.rotateMix,this.translateMix=z$V.translateMix,this.scaleMix=z$V.scaleMix,this.shearMix=z$V.shearMix}return z$s(z$V,"laya.ani.bone.TfConstraint"),z$V.prototype.apply=function(){for(var z$V,z$U=this.target.resultMatrix.a,z$r=this.target.resultMatrix.b,z$s=this.target.resultMatrix.c,z$p=this.target.resultMatrix.d,z$c=0,z$R=this._bones.length;z$c<z$R;z$c++){if(z$V=this._bones[z$c],0<this.rotateMix){var z$T=z$V.resultMatrix.a,z$N=z$V.resultMatrix.b,z$t=z$V.resultMatrix.c,z$b=z$V.resultMatrix.d,z$S=Math.atan2(z$s,z$U)-Math.atan2(z$t,z$T)+this._data.offsetRotation*Math.PI/180;z$S>Math.PI?z$S-=2*Math.PI:z$S<-Math.PI&&(z$S+=2*Math.PI),z$S*=this.rotateMix;var z$_=Math.cos(z$S),z$G=Math.sin(z$S);z$V.resultMatrix.a=z$_*z$T-z$G*z$t,z$V.resultMatrix.b=z$_*z$N-z$G*z$b,z$V.resultMatrix.c=z$G*z$T+z$_*z$t,z$V.resultMatrix.d=z$G*z$N+z$_*z$b}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),z$V.resultMatrix.tx+=(this._temp[0]-z$V.resultMatrix.tx)*this.translateMix,z$V.resultMatrix.ty+=(this._temp[1]-z$V.resultMatrix.ty)*this.translateMix,z$V.updateChild()),0<this.scaleMix){var z$q=Math.sqrt(z$V.resultMatrix.a*z$V.resultMatrix.a+z$V.resultMatrix.c*z$V.resultMatrix.c),z$u=Math.sqrt(z$U*z$U+z$s*z$s),z$h=1e-5<z$q?(z$q+(z$u-z$q+this._data.offsetScaleX)*this.scaleMix)/z$q:0;z$V.resultMatrix.a*=z$h,z$V.resultMatrix.c*=z$h,z$q=Math.sqrt(z$V.resultMatrix.b*z$V.resultMatrix.b+z$V.resultMatrix.d*z$V.resultMatrix.d),z$u=Math.sqrt(z$r*z$r+z$p*z$p),z$h=1e-5<z$q?(z$q+(z$u-z$q+this._data.offsetScaleY)*this.scaleMix)/z$q:0,z$V.resultMatrix.b*=z$h,z$V.resultMatrix.d*=z$h}if(0<this.shearMix){z$N=z$V.resultMatrix.b,z$b=z$V.resultMatrix.d;var z$l=Math.atan2(z$b,z$N);(z$S=Math.atan2(z$p,z$r)-Math.atan2(z$s,z$U)-(z$l-Math.atan2(z$V.resultMatrix.c,z$V.resultMatrix.a)))>Math.PI?z$S-=2*Math.PI:z$S<-Math.PI&&(z$S+=2*Math.PI),z$S=z$l+(z$S+this._data.offsetShearY*Math.PI/180)*this.shearMix,z$h=Math.sqrt(z$N*z$N+z$b*z$b),z$V.resultMatrix.b=Math.cos(z$S)*z$h,z$V.resultMatrix.d=Math.sin(z$S)*z$h}}},z$V}(),z$MV=function(){function z$V(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return z$s(z$V,"laya.ani.bone.TfConstraintData"),z$V}(),z$AV=function(){function z$V(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}z$s(z$V,"laya.ani.bone.Transform");var z$U=z$V.prototype;return z$U.initData=function(z$V){null!=z$V.x&&(this.x=z$V.x),null!=z$V.y&&(this.y=z$V.y),null!=z$V.skX&&(this.skX=z$V.skX),null!=z$V.skY&&(this.skY=z$V.skY),null!=z$V.scX&&(this.scX=z$V.scX),null!=z$V.scY&&(this.scY=z$V.scY)},z$U.getMatrix=function(){var z$V;return(z$V=this.mMatrix?this.mMatrix:this.mMatrix=new z$zV).identity(),z$V.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(z$V,this.skewX*Math.PI/180,this.skewY*Math.PI/180),z$V.rotate(this.skX*Math.PI/180),z$V.translate(this.x,this.y),z$V},z$U.skew=function(z$V,z$U,z$r){var z$s=Math.sin(z$r),z$p=Math.cos(z$r),z$c=Math.sin(z$U),z$R=Math.cos(z$U);return z$V.setTo(z$V.a*z$R-z$V.b*z$s,z$V.a*z$c+z$V.b*z$p,z$V.c*z$R-z$V.d*z$s,z$V.c*z$c+z$V.d*z$p,z$V.tx*z$R-z$V.ty*z$s,z$V.tx*z$c+z$V.ty*z$p),z$V},z$V}(),z$y=function(){function z$V(){}return z$s(z$V,"laya.ani.bone.UVTools"),z$V.getRelativeUV=function(z$V,z$U,z$r){var z$s=z$V[0],z$p=z$V[2]-z$V[0],z$c=z$V[1],z$R=z$V[5]-z$V[1];z$r||(z$r=[]),z$r.length=z$U.length;var z$T,z$N=0;z$T=z$r.length;var z$t=1/z$p,z$b=1/z$R;for(z$N=0;z$N<z$T;z$N+=2)z$r[z$N]=(z$U[z$N]-z$s)*z$t,z$r[z$N+1]=(z$U[z$N+1]-z$c)*z$b;return z$r},z$V.getAbsoluteUV=function(z$V,z$U,z$r){if(0==z$V[0]&&0==z$V[1]&&1==z$V[4]&&1==z$V[5])return z$r?(z$l.copyArray(z$r,z$U),z$r):z$U;var z$s=z$V[0],z$p=z$V[2]-z$V[0],z$c=z$V[1],z$R=z$V[5]-z$V[1];z$r||(z$r=[]),z$r.length=z$U.length;var z$T,z$N=0;for(z$T=z$r.length,z$N=0;z$N<z$T;z$N+=2)z$r[z$N]=z$U[z$N]*z$p+z$s,z$r[z$N+1]=z$U[z$N+1]*z$R+z$c;return z$r},z$V}(),z$K=function(){function z$V(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return z$s(z$V,"laya.ani.KeyFramesContent"),z$V}(),z$D=function(){function z$b(){}return z$s(z$b,"laya.ani.math.BezierLerp"),z$b.getBezierRate=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$b._getBezierParamKey(z$U,z$r,z$s,z$p),z$R=100*z$c+z$V;if(z$b._bezierResultCache[z$R])return z$b._bezierResultCache[z$R];var z$T,z$N=z$b._getBezierPoints(z$U,z$r,z$s,z$p,z$c),z$t=0;for(z$T=z$N.length,z$t=0;z$t<z$T;z$t+=2)if(z$V<=z$N[z$t])return z$b._bezierResultCache[z$R]=z$N[z$t+1],z$N[z$t+1];return z$b._bezierResultCache[z$R]=1},z$b._getBezierParamKey=function(z$V,z$U,z$r,z$s){return 100*(100*(100*(100*z$V+z$U)+z$r)+z$s)},z$b._getBezierPoints=function(z$V,z$U,z$r,z$s,z$p){return z$b._bezierPointsCache[z$p]?z$b._bezierPointsCache[z$p]:(z$c=[0,0,z$V,z$U,z$r,z$s,1,1],z$R=(new z$T).getBezierPoints(z$c,100,3),z$b._bezierPointsCache[z$p]=z$R);var z$c,z$R},z$b._bezierResultCache={},z$b._bezierPointsCache={},z$b}(),z$n=function(z$V){function z$U(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,z$U.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}z$s(z$U,"laya.ani.AnimationPlayer",z$p);var z$r=z$U.prototype;return z$pV.imps(z$r,{"laya.resource.IDestroy":!0}),z$r._onTempletLoadedComputeFullKeyframeIndices=function(z$V,z$U,z$r){this._templet===z$r&&this._cachePlayRate===z$V&&this._cacheFrameRate===z$U&&this._computeFullKeyframeIndices()},z$r._computeFullKeyframeIndices=function(){for(var z$V=this._fullFrames=[],z$U=this._templet,z$r=this._cacheFrameRateInterval*this._cachePlayRate,z$s=0,z$p=z$U.getAnimationCount();z$s<z$p;z$s++){for(var z$c=[],z$R=0,z$T=z$U.getAnimation(z$s).nodes.length;z$R<z$T;z$R++){for(var z$N=z$U.getAnimation(z$s).nodes[z$R],z$t=Math.floor(z$N.playTime/z$r+.01),z$b=new Uint16Array(z$t+1),z$S=-1,z$_=0,z$G=z$N.keyFrame.length;z$_<z$G;z$_++){var z$q=z$N.keyFrame[z$_],z$u=z$q.startTime,z$h=z$u+z$q.duration+z$r;do{for(var z$l=Math.floor(z$u/z$r+.5),z$W=z$S+1;z$W<z$l;z$W++)z$b[z$W]=z$_;z$b[z$S=z$l]=z$_,z$u+=z$r}while(z$u<=z$h)}z$c.push(z$b)}z$V.push(z$c)}},z$r._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},z$r._calculatePlayDuration=function(){if(0!==this.state){var z$V=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=z$V),this._playEnd>z$V&&(this._playEnd=z$V),this._playDuration=this._playEnd-this._playStart}},z$r._setPlayParams=function(z$V,z$U){this._currentTime=z$V,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/z$U+.01),0),this._currentFrameTime=this._currentKeyframeIndex*z$U},z$r._setPlayParamsWhenStop=function(z$V,z$U){this._currentTime=z$V,this._currentKeyframeIndex=Math.max(Math.floor(z$V/z$U+.01),0),this._currentFrameTime=this._currentKeyframeIndex*z$U,this._currentAnimationClipIndex=-1},z$r._update=function(z$V){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var z$U=this._cacheFrameRateInterval*this._cachePlayRate,z$r=0;this._startUpdateLoopCount!==z$q.loopCount&&(z$r=z$V*this.playbackRate,this._elapsedPlaybackTime+=z$r);var z$s=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=z$s)return this._setPlayParamsWhenStop(z$s,z$U),void this.event("stopped");if(z$r+=this._currentTime,0<z$s)if(z$s<=z$r)do{if(z$r-=z$s,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(z$s,z$U),this._stopWhenCircleFinish=!1,void this.event("stopped");z$r<z$s&&(this._setPlayParams(z$r,z$U),this.event("complete"))}while(z$s<=z$r);else this._setPlayParams(z$r,z$U);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(z$s,z$U),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},z$r._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},z$r.play=function(z$V,z$U,z$r,z$s,z$p){if(void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=1),void 0===z$r&&(z$r=2147483647),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(z$r<0||z$s<0||z$p<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==z$p&&z$p<z$s)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=z$U,this._overallDuration=z$r,this._playStart=z$s,this._playEnd=z$p,this._paused=!1,this._currentAnimationClipIndex=z$V,this._currentKeyframeIndex=0,this._startUpdateLoopCount=z$q.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},z$r.playByFrame=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$V&&(z$V=0),void 0===z$U&&(z$U=1),void 0===z$r&&(z$r=2147483647),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=30);var z$R=1e3/z$c;this.play(z$V,z$U,z$r,z$s*z$R,z$p*z$R)},z$r.stop=function(z$V){void 0===z$V&&(z$V=!0),z$V?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},z$c(0,z$r,"playEnd",function(){return this._playEnd}),z$c(0,z$r,"templet",function(){return this._templet},function(z$V){0===!this.state&&this.stop(!0),this._templet!==z$V&&((this._templet=z$V).loaded?this._computeFullKeyframeIndices():z$V.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),z$c(0,z$r,"playStart",function(){return this._playStart}),z$c(0,z$r,"playDuration",function(){return this._playDuration}),z$c(0,z$r,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),z$c(0,z$r,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),z$c(0,z$r,"overallDuration",function(){return this._overallDuration}),z$c(0,z$r,"currentFrameTime",function(){return this._currentFrameTime}),z$c(0,z$r,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),z$c(0,z$r,"currentPlayTime",function(){return this._currentTime+this._playStart}),z$c(0,z$r,"cachePlayRate",function(){return this._cachePlayRate},function(z$V){this._cachePlayRate!==z$V&&(this._cachePlayRate=z$V,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[z$V,this._cacheFrameRate])))}),z$c(0,z$r,"cacheFrameRate",function(){return this._cacheFrameRate},function(z$V){this._cacheFrameRate!==z$V&&(this._cacheFrameRate=z$V,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,z$V])))}),z$c(0,z$r,"currentTime",null,function(z$V){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(z$V<this._playStart||z$V>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=z$q.loopCount;var z$U=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=z$V,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/z$U),0),this._currentFrameTime=this._currentKeyframeIndex*z$U}}),z$c(0,z$r,"paused",function(){return this._paused},function(z$V){(this._paused=z$V)&&this.event("paused")}),z$c(0,z$r,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),z$c(0,z$r,"destroyed",function(){return this._destroyed}),z$U}(),z$m=function(z$V){function z$U(){z$U.__super.call(this),z$h.isConchNode&&(this.drawSkin=function(z$V){z$V.transform||(z$V.transform=z$zV.EMPTY),this._addCmd([z$V]),this.setSkinMesh&&this.setSkinMesh(z$V._ps,z$V.mVBData,z$V.mEleNum,0,z$V.mTexture,z$V.transform)})}return z$s(z$U,"laya.ani.GraphicsAni",z$R),z$U.prototype.drawSkin=function(z$V){var z$U=[z$V];this._saveToCmd(z$h._context._drawSkin,z$U)},z$U.create=function(){return z$U._caches.pop()||new z$U},z$U.recycle=function(z$V){z$V.clear(),z$U._caches.push(z$V)},z$U._caches=[],z$U}(),z$a=function(z$V){function z$W(){this._aniMap={},this.unfixedLastAniIndex=-1,z$W.__super.call(this),this._anis=new Array}z$s(z$W,"laya.ani.AnimationTemplet",z$b);var z$U=z$W.prototype;return z$U.parse=function(z$V){var z$U=new z$wV(z$V);this._aniVersion=z$U.readUTFString(),z$O.parse(this,z$U)},z$U._calculateKeyFrame=function(z$V,z$U,z$r){var z$s=z$V.keyFrame;z$s[z$U]=z$s[0];for(var z$p=0;z$p<z$U;z$p++){var z$c=z$s[z$p];z$c.nextData=0===z$c.duration?z$c.data:z$s[z$p+1].data}z$s.length--},z$U.onAsynLoaded=function(z$V,z$U,z$r){var z$s=new z$wV(z$U);switch(this._aniVersion=z$s.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":z$L.parse(this,z$s);break;default:z$O.parse(this,z$s)}this._endLoaded()},z$U.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},z$U.getAnimationCount=function(){return this._anis.length},z$U.getAnimation=function(z$V){return this._anis[z$V]},z$U.getAniDuration=function(z$V){return this._anis[z$V].playTime},z$U.getNodes=function(z$V){return this._anis[z$V].nodes},z$U.getNodeIndexWithName=function(z$V,z$U){return this._anis[z$V].bone3DMap[z$U]},z$U.getNodeCount=function(z$V){return this._anis[z$V].nodes.length},z$U.getTotalkeyframesLength=function(z$V){return this._anis[z$V].totalKeyframeDatasLength},z$U.getPublicExtData=function(){return this._publicExtData},z$U.getAnimationDataWithCache=function(z$V,z$U,z$r,z$s){var z$p=z$U[z$r];if(z$p){var z$c=z$p[z$V];return z$c?z$c[z$s]:null}return null},z$U.setAnimationDataWithCache=function(z$V,z$U,z$r,z$s,z$p){var z$c=z$U[z$r]||(z$U[z$r]={});(z$c[z$V]||(z$c[z$V]=[]))[z$s]=z$p},z$U.getOriginalData=function(z$V,z$U,z$r,z$s,z$p){for(var z$c=this._anis[z$V].nodes,z$R=0,z$T=0,z$N=z$c.length,z$t=0;z$T<z$N;z$T++){var z$b,z$S=z$c[z$T];z$b=z$S.keyFrame[z$r[z$T][z$s]],z$S.dataOffset=z$t;var z$_=z$p-z$b.startTime,z$G=z$S.lerpType;if(z$G)switch(z$G){case 0:case 1:for(z$R=0;z$R<z$S.keyframeWidth;)z$R+=z$S.interpolationMethod[z$R](z$S,z$R,z$U,z$t+z$R,z$b.data,z$_,null,z$b.duration,z$b.nextData);break;case 2:var z$q=z$b.interpolationData,z$u=z$q.length,z$h=0;for(z$R=0;z$R<z$u;){var z$l=z$q[z$R];switch(z$l){case 6:case 7:z$R+=z$W.interpolation[z$l](z$S,z$h,z$U,z$t+z$h,z$b.data,z$_,null,z$b.duration,z$b.nextData,z$q,z$R+1);break;default:z$R+=z$W.interpolation[z$l](z$S,z$h,z$U,z$t+z$h,z$b.data,z$_,null,z$b.duration,z$b.nextData)}z$h++}}else for(z$R=0;z$R<z$S.keyframeWidth;)z$R+=z$S.interpolationMethod[z$R](z$S,z$R,z$U,z$t+z$R,z$b.data,z$_,null,z$b.duration,z$b.nextData);z$t+=z$S.keyframeWidth}},z$U.getNodesCurrentFrameIndex=function(z$V,z$U){var z$r=this._anis[z$V].nodes;z$V!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(z$r.length),this.unfixedCurrentTimes=new Float32Array(z$r.length),this.unfixedLastAniIndex=z$V);for(var z$s=0,z$p=z$r.length;z$s<z$p;z$s++){var z$c=z$r[z$s];for(z$U<this.unfixedCurrentTimes[z$s]&&(this.unfixedCurrentFrameIndexes[z$s]=0),this.unfixedCurrentTimes[z$s]=z$U;this.unfixedCurrentFrameIndexes[z$s]<z$c.keyFrame.length&&!(z$c.keyFrame[this.unfixedCurrentFrameIndexes[z$s]].startTime>this.unfixedCurrentTimes[z$s]);)this.unfixedCurrentFrameIndexes[z$s]++;this.unfixedCurrentFrameIndexes[z$s]--}return this.unfixedCurrentFrameIndexes},z$U.getOriginalDataUnfixedRate=function(z$V,z$U,z$r){var z$s=this._anis[z$V].nodes;z$V!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(z$s.length),this.unfixedCurrentTimes=new Float32Array(z$s.length),this.unfixedKeyframes=z$u(z$s.length),this.unfixedLastAniIndex=z$V);for(var z$p=0,z$c=0,z$R=z$s.length,z$T=0;z$c<z$R;z$c++){var z$N=z$s[z$c];for(z$r<this.unfixedCurrentTimes[z$c]&&(this.unfixedCurrentFrameIndexes[z$c]=0),this.unfixedCurrentTimes[z$c]=z$r;this.unfixedCurrentFrameIndexes[z$c]<z$N.keyFrame.length&&!(z$N.keyFrame[this.unfixedCurrentFrameIndexes[z$c]].startTime>this.unfixedCurrentTimes[z$c]);)this.unfixedKeyframes[z$c]=z$N.keyFrame[this.unfixedCurrentFrameIndexes[z$c]],this.unfixedCurrentFrameIndexes[z$c]++;var z$t=this.unfixedKeyframes[z$c];z$N.dataOffset=z$T;var z$b=z$r-z$t.startTime;if(z$N.lerpType)switch(z$N.lerpType){case 0:case 1:for(z$p=0;z$p<z$N.keyframeWidth;)z$p+=z$N.interpolationMethod[z$p](z$N,z$p,z$U,z$T+z$p,z$t.data,z$b,null,z$t.duration,z$t.nextData);break;case 2:var z$S=z$t.interpolationData,z$_=z$S.length,z$G=0;for(z$p=0;z$p<z$_;){var z$q=z$S[z$p];switch(z$q){case 6:case 7:z$p+=z$W.interpolation[z$q](z$N,z$G,z$U,z$T+z$G,z$t.data,z$b,null,z$t.duration,z$t.nextData,z$S,z$p+1);break;default:z$p+=z$W.interpolation[z$q](z$N,z$G,z$U,z$T+z$G,z$t.data,z$b,null,z$t.duration,z$t.nextData)}z$G++}}else for(z$p=0;z$p<z$N.keyframeWidth;)z$p+=z$N.interpolationMethod[z$p](z$N,z$p,z$U,z$T+z$p,z$t.data,z$b,null,z$t.duration,z$t.nextData);z$T+=z$N.keyframeWidth}},z$W._LinearInterpolation_0=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){var z$b=0===z$T?0:z$c/z$T;return z$r[z$s]=(1-z$b)*z$p[z$U]+z$b*z$N[z$U],1},z$W._QuaternionInterpolation_1=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){var z$b=0===z$T?0:z$c/z$T;return z$_.slerpQuaternionArray(z$p,z$U,z$N,z$U,z$b,z$r,z$s),4},z$W._AngleInterpolation_2=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return 0},z$W._RadiansInterpolation_3=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return 0},z$W._Matrix4x4Interpolation_4=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){for(var z$b=0;z$b<16;z$b++,z$U++)z$r[z$s+z$b]=z$p[z$U]+z$c*z$R[z$U];return 16},z$W._NoInterpolation_5=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t){return z$r[z$s]=z$p[z$U],1},z$W._BezierInterpolation_6=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b){return void 0===z$b&&(z$b=0),z$r[z$s]=z$p[z$U]+(z$N[z$U]-z$p[z$U])*z$D.getBezierRate(z$c/z$T,z$t[z$b],z$t[z$b+1],z$t[z$b+2],z$t[z$b+3]),5},z$W._BezierInterpolation_7=function(z$V,z$U,z$r,z$s,z$p,z$c,z$R,z$T,z$N,z$t,z$b){return void 0===z$b&&(z$b=0),z$r[z$s]=z$t[z$b+4]+z$t[z$b+5]*z$D.getBezierRate((.001*z$c+z$t[z$b+6])/z$t[z$b+7],z$t[z$b],z$t[z$b+1],z$t[z$b+2],z$t[z$b+3]),9},z$W.load=function(z$V){return z$pV.loader.create(z$V,null,null,z$W)},z$W.interpolation=[z$W._LinearInterpolation_0,z$W._QuaternionInterpolation_1,z$W._AngleInterpolation_2,z$W._RadiansInterpolation_3,z$W._Matrix4x4Interpolation_4,z$W._NoInterpolation_5,z$W._BezierInterpolation_6,z$W._BezierInterpolation_7],z$W}(),z$I=function(z$U){function z$r(z$V,z$U){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,z$r.__super.call(this),void 0===z$U&&(z$U=0),z$V&&this.init(z$V,z$U)}z$s(z$r,"laya.ani.bone.Skeleton",z$U);var z$V=z$r.prototype;return z$V.init=function(z$V,z$U){void 0===z$U&&(z$U=0);var z$r,z$s,z$p,z$c=0,z$R=0;if(1==z$U)for(this._graphicsCache=[],z$c=0,z$R=z$V.getAnimationCount();z$c<z$R;z$c++)this._graphicsCache.push([]);if(this._yReverseMatrix=z$V.yReverseMatrix,this._aniMode=z$U,this._templet=z$V,this._player=new z$n,this._player.cacheFrameRate=z$V.rate,this._player.templet=z$V,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=z$V.mBoneArr,this._rootBone=z$V.mRootBone,this._aniSectionDic=z$V.aniSectionDic,0<z$V.ikArr.length)for(this._ikArr=[],z$c=0,z$R=z$V.ikArr.length;z$c<z$R;z$c++)this._ikArr.push(new z$W(z$V.ikArr[z$c],this._boneList));if(0<z$V.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),z$c=0,z$R=z$V.pathArr.length;z$c<z$R;z$c++)z$r=z$V.pathArr[z$c],z$s=new z$d(z$r,this._boneList),(z$p=this._boneSlotDic[z$r.name])&&((z$s=new z$d(z$r,this._boneList)).target=z$p),this._pathDic[z$r.name]=z$s;if(0<z$V.tfArr.length)for(this._tfArr=[],z$c=0,z$R=z$V.tfArr.length;z$c<z$R;z$c++)this._tfArr.push(new z$k(z$V.tfArr[z$c],this._boneList));if(0<z$V.skinDataArray.length){var z$T=this._templet.skinDataArray[this._skinIndex];this._skinName=z$T.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},z$V.load=function(z$V,z$U,z$r){},z$V._onLoaded=function(){},z$V._parseComplete=function(){var z$V=z$Q.TEMPLET_DICTIONARY[this._aniPath];z$V&&(this.init(z$V,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},z$V._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},z$V._onPlay=function(){this.event("played")},z$V._onStop=function(){var z$V,z$U=this._templet.eventAniArr[this._aniClipIndex];if(z$U&&this._eventIndex<z$U.length)for(;this._eventIndex<z$U.length;this._eventIndex++)(z$V=z$U[this._eventIndex]).time>=this._player.playStart&&z$V.time<=this._player.playEnd&&this.event("label",z$V);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},z$V._onPause=function(){this.event("paused")},z$V._parseSrcBoneMatrix=function(){var z$V=0,z$U=0;for(z$U=this._templet.srcBoneMatrixArr.length,z$V=0;z$V<z$U;z$V++)this._boneMatrixArray.push(new z$zV);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var z$r,z$s,z$p=this._templet.boneSlotArray;for(z$V=0,z$U=z$p.length;z$V<z$U;z$V++)z$r=z$p[z$V],null==(z$s=this._bindBoneBoneSlotDic[z$r.parent])&&(this._bindBoneBoneSlotDic[z$r.parent]=z$s=[]),this._boneSlotDic[z$r.name]=z$r=z$r.copy(),z$s.push(z$r),this._boneSlotArray.push(z$r)}},z$V._emitMissedEvents=function(z$V,z$U,z$r){void 0===z$r&&(z$r=0);var z$s=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(z$s){var z$p,z$c,z$R=0;for(z$p=z$s.length,z$R=z$r;z$R<z$p;z$R++)(z$c=z$s[z$R]).time>=this._player.playStart&&z$c.time<=this._player.playEnd&&this.event("label",z$c)}},z$V._update=function(z$V){if(void 0===z$V&&(z$V=!0),!(this._pause||z$V&&this._indexControl)){var z$U=this.timer.currTimer,z$r=this._player.currentKeyframeIndex,z$s=z$U-this._lastTime;if(z$V?this._player._update(z$s):z$r=-1,this._lastTime=z$U,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<z$s&&this._clipIndex==z$r&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var z$p;this._lastUpdateAniClipIndex=this._aniClipIndex,z$r>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var z$c,z$R=this._templet.eventAniArr[this._aniClipIndex];if(z$R&&this._eventIndex<z$R.length&&((z$p=z$R[this._eventIndex]).time>=this._player.playStart&&z$p.time<=this._player.playEnd?this._player.currentPlayTime>=z$p.time&&(this.event("label",z$p),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(z$c=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=z$c&&(this.graphics=z$c));var z$T=0,z$N=0;for(z$N=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,z$N-1)&&0<z$N;)z$N--;if(z$N<this._clipIndex)for(z$T=z$N;z$T<this._clipIndex;z$T++)this._createGraphics(z$T)}else if(1==this._aniMode){if(z$c=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=z$c&&(this.graphics=z$c));for(z$N=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,z$N-1)&&0<z$N;)z$N--;if(z$N<this._clipIndex)for(z$T=z$N;z$T<this._clipIndex;z$T++)this._createGraphics(z$T)}this._createGraphics()}}},z$V._createGraphics=function(z$V){void 0===z$V&&(z$V=-1),-1==z$V&&(z$V=this._clipIndex);var z$U,z$r,z$s=z$V*this._player.cacheFrameRateInterval,z$p=this._templet.drawOrderAniArr[this._aniClipIndex];if(z$p&&0<z$p.length)for(this._drawOrderIndex=0,z$U=z$p[this._drawOrderIndex];z$s>=z$U.time&&(this._drawOrder=z$U.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=z$p.length));)z$U=z$p[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=z$m.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=z$m.create(),z$r=this.graphics;var z$c=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],z$V,z$s);var z$R,z$T,z$N,z$t,z$b=this._aniSectionDic[this._aniClipIndex],z$S=0,z$_=0,z$G=0,z$q=0,z$u=0,z$h=this._templet.srcBoneMatrixArr.length;for(z$u=z$b[z$_=0];z$_<z$h;z$_++)z$t=this._boneList[z$_],z$N=this._templet.srcBoneMatrixArr[z$_],z$t.resultTransform.scX=z$N.scX*this._curOriginalData[z$S++],z$t.resultTransform.skX=z$N.skX+this._curOriginalData[z$S++],z$t.resultTransform.skY=z$N.skY+this._curOriginalData[z$S++],z$t.resultTransform.scY=z$N.scY*this._curOriginalData[z$S++],z$t.resultTransform.x=z$N.x+this._curOriginalData[z$S++],z$t.resultTransform.y=z$N.y+this._curOriginalData[z$S++],8===this._templet.tMatrixDataLen&&(z$t.resultTransform.skewX=z$N.skewX+this._curOriginalData[z$S++],z$t.resultTransform.skewY=z$N.skewY+this._curOriginalData[z$S++]);var z$l,z$W={},z$O={};for(z$u+=z$b[1];z$_<z$u;z$_++)z$W[(z$l=z$c[z$_]).name]=this._curOriginalData[z$S++],z$O[z$l.name]=this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++];var z$L,z$d,z$k={},z$y={};for(z$u+=z$b[2];z$_<z$u;z$_++)z$k[(z$l=z$c[z$_]).name]=this._curOriginalData[z$S++],z$y[z$l.name]=this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++],this._curOriginalData[z$S++];if(this._pathDic)for(z$u+=z$b[3];z$_<z$u;z$_++){if(z$l=z$c[z$_],z$L=this._pathDic[z$l.name])switch(new z$wV(z$l.extenData).getByte()){case 1:z$L.position=this._curOriginalData[z$S++];break;case 2:z$L.spacing=this._curOriginalData[z$S++];break;case 3:z$L.rotateMix=this._curOriginalData[z$S++],z$L.translateMix=this._curOriginalData[z$S++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(z$zV.TEMP.identity()),this._ikArr)for(z$_=0,z$u=this._ikArr.length;z$_<z$u;z$_++)z$d=this._ikArr[z$_],z$k.hasOwnProperty(z$d.name)&&(z$d.bendDirection=z$k[z$d.name]),z$y.hasOwnProperty(z$d.name)&&(z$d.mix=z$y[z$d.name]),z$d.apply();if(this._pathDic)for(var z$D in this._pathDic)(z$L=this._pathDic[z$D]).apply(this._boneList,z$r);if(this._tfArr)for(z$_=0,z$q=this._tfArr.length;z$_<z$q;z$_++)this._tfArr[z$_].apply();for(z$_=0,z$q=this._boneList.length;z$_<z$q;z$_++)if(z$t=this._boneList[z$_],z$T=this._bindBoneBoneSlotDic[z$t.name],z$t.resultMatrix.copyTo(this._boneMatrixArray[z$_]),z$T)for(z$G=0,z$u=z$T.length;z$G<z$u;z$G++)(z$R=z$T[z$G])&&z$R.setParentMatrix(z$t.resultMatrix);var z$n,z$I,z$Q,z$H,z$w={},z$z=this._templet.deformAniArr;if(z$z&&0<z$z.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,z$_=0,z$u=this._boneSlotArray.length;z$_<z$u;z$_++)(z$R=this._boneSlotArray[z$_]).deformData=null;var z$E,z$K=z$z[this._aniClipIndex];for(z$E in z$n=z$K.default,this._setDeform(z$n,z$w,this._boneSlotArray,z$s),z$K)"default"!=z$E&&z$E!=this._skinName&&(z$n=z$K[z$E],this._setDeform(z$n,z$w,this._boneSlotArray,z$s));z$n=z$K[this._skinName],this._setDeform(z$n,z$w,this._boneSlotArray,z$s)}if(this._drawOrder)for(z$_=0,z$u=this._drawOrder.length;z$_<z$u;z$_++)z$I=z$W[(z$R=this._boneSlotArray[this._drawOrder[z$_]]).name],z$Q=z$O[z$R.name],isNaN(z$Q)||(z$r.save(),z$r.alpha(z$Q)),isNaN(z$I)||-2==z$I||(this._templet.attachmentNames?z$R.showDisplayByName(this._templet.attachmentNames[z$I]):z$R.showDisplayByIndex(z$I)),z$w[this._drawOrder[z$_]]?(z$H=z$w[this._drawOrder[z$_]],z$R.currDisplayData&&z$H[z$R.currDisplayData.attachmentName]?z$R.deformData=z$H[z$R.currDisplayData.attachmentName]:z$R.deformData=null):z$R.deformData=null,isNaN(z$Q)?z$R.draw(z$r,this._boneMatrixArray,2==this._aniMode):z$R.draw(z$r,this._boneMatrixArray,2==this._aniMode,z$Q),isNaN(z$Q)||z$r.restore();else for(z$_=0,z$u=this._boneSlotArray.length;z$_<z$u;z$_++)z$I=z$W[(z$R=this._boneSlotArray[z$_]).name],z$Q=z$O[z$R.name],isNaN(z$Q)||(z$r.save(),z$r.alpha(z$Q)),isNaN(z$I)||-2==z$I||(this._templet.attachmentNames?z$R.showDisplayByName(this._templet.attachmentNames[z$I]):z$R.showDisplayByIndex(z$I)),z$w[z$_]?(z$H=z$w[z$_],z$R.currDisplayData&&z$H[z$R.currDisplayData.attachmentName]?z$R.deformData=z$H[z$R.currDisplayData.attachmentName]:z$R.deformData=null):z$R.deformData=null,isNaN(z$Q)?z$R.draw(z$r,this._boneMatrixArray,2==this._aniMode):z$R.draw(z$r,this._boneMatrixArray,2==this._aniMode,z$Q),isNaN(z$Q)||z$r.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,z$V,z$r):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,z$V,z$r)},z$V._setDeform=function(z$V,z$U,z$r,z$s){if(z$V){var z$p,z$c,z$R,z$T=0,z$N=0,z$t=0;if(z$V)for(z$T=0,z$N=z$V.deformSlotDataList.length;z$T<z$N;z$T++)for(z$p=z$V.deformSlotDataList[z$T],z$t=0;z$t<z$p.deformSlotDisplayList.length;z$t++)z$R=z$r[(z$c=z$p.deformSlotDisplayList[z$t]).slotIndex],z$c.apply(z$s,z$R),z$U[z$c.slotIndex]||(z$U[z$c.slotIndex]={}),z$U[z$c.slotIndex][z$c.attachment]=z$c.deformData}},z$V.getAnimNum=function(){return this._templet.getAnimationCount()},z$V.getAniNameByIndex=function(z$V){return this._templet.getAniNameByIndex(z$V)},z$V.getSlotByName=function(z$V){return this._boneSlotDic[z$V]},z$V.showSkinByName=function(z$V,z$U){void 0===z$U&&(z$U=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(z$V),z$U)},z$V.showSkinByIndex=function(z$V,z$U){void 0===z$U&&(z$U=!0);for(var z$r=0;z$r<this._boneSlotArray.length;z$r++)this._boneSlotArray[z$r].showSlotData(null,z$U);if(this._templet.showSkinByIndex(this._boneSlotDic,z$V,z$U)){var z$s=this._templet.skinDataArray[z$V];this._skinIndex=z$V,this._skinName=z$s.name}this._clearCache()},z$V.showSlotSkinByIndex=function(z$V,z$U){if(0!=this._aniMode){var z$r=this.getSlotByName(z$V);z$r&&z$r.showDisplayByIndex(z$U),this._clearCache()}},z$V.showSlotSkinByName=function(z$V,z$U){if(0!=this._aniMode){var z$r=this.getSlotByName(z$V);z$r&&z$r.showDisplayByName(z$U),this._clearCache()}},z$V.replaceSlotSkinName=function(z$V,z$U,z$r){if(0!=this._aniMode){var z$s=this.getSlotByName(z$V);z$s&&z$s.replaceDisplayByName(z$U,z$r),this._clearCache()}},z$V.replaceSlotSkinByIndex=function(z$V,z$U,z$r){if(0!=this._aniMode){var z$s=this.getSlotByName(z$V);z$s&&z$s.replaceDisplayByIndex(z$U,z$r),this._clearCache()}},z$V.setSlotSkin=function(z$V,z$U){if(0!=this._aniMode){var z$r=this.getSlotByName(z$V);z$r&&z$r.replaceSkin(z$U),this._clearCache()}},z$V._clearCache=function(){if(1==this._aniMode)for(var z$V=0,z$U=this._graphicsCache.length;z$V<z$U;z$V++){for(var z$r=0,z$s=this._graphicsCache[z$V].length;z$r<z$s;z$r++){var z$p=this._graphicsCache[z$V][z$r];z$p!=this.graphics&&z$m.recycle(z$p)}this._graphicsCache[z$V].length=0}},z$V.play=function(z$V,z$U,z$r,z$s,z$p,z$c){void 0===z$r&&(z$r=!0),void 0===z$s&&(z$s=0),void 0===z$p&&(z$p=0),void 0===z$c&&(z$c=!0),this._indexControl=!1;var z$R=-1,z$T=NaN;if(z$T=z$U?2147483647:0,"string"==typeof z$V)for(var z$N=0,z$t=this._templet.getAnimationCount();z$N<z$t;z$N++){var z$b=this._templet.getAnimation(z$N);if(z$b&&z$V==z$b.name){z$R=z$N;break}}else z$R=z$V;-1<z$R&&z$R<this.getAnimNum()&&(this._aniClipIndex=z$R,(z$r||this._pause||this._currAniIndex!=z$R)&&(this._currAniIndex=z$R,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(z$R)),this._drawOrder=null,this._eventIndex=0,this._player.play(z$R,this._player.playbackRate,z$T,z$s,z$p),z$c&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=z$S.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},z$V.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},z$V.playbackRate=function(z$V){this._player&&(this._player.playbackRate=z$V)},z$V.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},z$V.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=z$S.now(),this.timer.frameLoop(1,this,this._update,null,!0))},z$V._getGrahicsDataWithCache=function(z$V,z$U){return this._graphicsCache[z$V][z$U]},z$V._setGrahicsDataWithCache=function(z$V,z$U,z$r){this._graphicsCache[z$V][z$U]=z$r},z$V.destroy=function(z$V){void 0===z$V&&(z$V=!0),z$U.prototype.destroy.call(this,z$V),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},z$c(0,z$V,"url",function(){return this._aniPath},function(z$V){this.load(z$V)}),z$c(0,z$V,"index",function(){return this._index},function(z$V){this.player&&(this._index=z$V,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),z$c(0,z$V,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),z$c(0,z$V,"templet",function(){return this._templet}),z$c(0,z$V,"player",function(){return this._player}),z$r.useSimpleMeshInCanvas=!1,z$r}(z$cV),z$Q=function(z$U){function z$p(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,z$p.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}z$s(z$p,"laya.ani.bone.Templet",z$U);var z$V=z$p.prototype;return z$V.getLoadList=function(){return this._loadList},z$V.loadAni=function(z$V){this._skBufferUrl=z$V,z$pV.loader.load(z$V,z$N.create(this,this.onComplete),null,"arraybuffer")},z$V.onComplete=function(z$V){if(this._isDestroyed)this.destroy();else{var z$U=z$t.getRes(this._skBufferUrl);z$U?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,z$U)):this.event("error","load failed:"+this._skBufferUrl)}},z$V.parseData=function(z$V,z$U,z$r){void 0===z$r&&(z$r=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=z$V,this._mainTexture&&z$h.isWebGL&&z$V.bitmap&&(z$V.bitmap.enableMerageInAtlas=!1),this._rate=z$r,this.parse(z$U)},z$V.buildArmature=function(z$V){return void 0===z$V&&(z$V=0),new z$I(this,z$V)},z$V.parse=function(z$V){z$U.prototype.parse.call(this,z$V),this._endLoaded(),this._aniVersion!=z$p.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+z$p.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},z$V._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var z$V=0;this._loadList=[];var z$U,z$r=new z$wV(this.getPublicExtData()),z$s=0,z$p=0,z$c=0,z$R=z$r.getInt32(),z$T=z$r.readUTFString(),z$N=z$T.split("\n");for(z$V=0;z$V<z$R;z$V++)z$U=this._path+z$N[2*z$V],z$T=z$N[2*z$V+1],z$r.getFloat32(),z$r.getFloat32(),z$s=z$r.getFloat32(),z$p=z$r.getFloat32(),z$c=z$r.getFloat32(),isNaN(z$c)?0:z$c,z$c=z$r.getFloat32(),isNaN(z$c)?0:z$c,z$c=z$r.getFloat32(),isNaN(z$c)?z$s:z$c,z$c=z$r.getFloat32(),isNaN(z$c)?z$p:z$c,-1==this._loadList.indexOf(z$U)&&this._loadList.push(z$U);this.event("inited",this)}},z$V._textureComplete=function(){for(var z$V,z$U,z$r=0,z$s=this._loadList.length;z$r<z$s;z$r++)z$U=this._loadList[z$r],z$V=this._textureDic[z$U]=z$t.getRes(z$U),z$h.isWebGL&&z$V&&z$V.bitmap&&(z$V.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},z$V._parsePublicExtData=function(){var z$V=0,z$U=0,z$r=0,z$s=0,z$p=0;for(z$V=0,z$p=this.getAnimationCount();z$V<z$p;z$V++)this._graphicsCache.push([]);var z$c;z$c="Dragon"!=this._aniClassName;var z$R,z$T,z$N=new z$wV(this.getPublicExtData()),z$t=0,z$b=0,z$S=0,z$_=0,z$G=0,z$q=0,z$u=0,z$h=0,z$l=0,z$W=z$N.getInt32(),z$O=z$N.readUTFString(),z$L=z$O.split("\n");for(z$V=0;z$V<z$W;z$V++){if(z$R=this._mainTexture,z$T=this._path+z$L[2*z$V],z$O=z$L[2*z$V+1],null==this._mainTexture&&(z$R=this._textureDic[z$T]),!z$R)return this.event("error",this),void(this.isParseFail=!0);z$t=z$N.getFloat32(),z$b=z$N.getFloat32(),z$S=z$N.getFloat32(),z$_=z$N.getFloat32(),z$l=z$N.getFloat32(),z$G=isNaN(z$l)?0:z$l,z$l=z$N.getFloat32(),z$q=isNaN(z$l)?0:z$l,z$l=z$N.getFloat32(),z$u=isNaN(z$l)?z$S:z$l,z$l=z$N.getFloat32(),z$h=isNaN(z$l)?z$_:z$l,this.subTextureDic[z$O]=z$EV.create(z$R,z$t,z$b,z$S,z$_,-z$G,-z$q,z$u,z$h),z$R.alphaTexture&&(this.subTextureDic[z$O].alphaTexture=z$EV.create(z$R.alphaTexture,z$t,z$b,z$S,z$_,-z$G,-z$q,z$u,z$h))}this._mainTexture=z$R;var z$d,z$k,z$y,z$D,z$n,z$I=z$N.getUint16();for(z$V=0;z$V<z$I;z$V++)(z$d=[]).push(z$N.getUint16()),z$d.push(z$N.getUint16()),z$d.push(z$N.getUint16()),z$d.push(z$N.getUint16()),this.aniSectionDic[z$V]=z$d;var z$Q,z$H=z$N.getInt16(),z$w={};for(z$V=0;z$V<z$H;z$V++)z$k=new z$KV,0==z$V?z$Q=z$k:z$k.root=z$Q,z$k.d=z$c?-1:1,z$D=z$N.readUTFString(),z$n=z$N.readUTFString(),z$k.length=z$N.getFloat32(),1==z$N.getByte()&&(z$k.inheritRotation=!1),1==z$N.getByte()&&(z$k.inheritScale=!1),z$k.name=z$D,z$n&&((z$y=z$w[z$n])?z$y.addChild(z$k):this.mRootBone=z$k),z$w[z$D]=z$k,this.mBoneArr.push(z$k);this.tMatrixDataLen=z$N.getUint16();var z$z,z$E,z$K=z$N.getUint16(),z$m=Math.floor(z$K/this.tMatrixDataLen),z$a=this.srcBoneMatrixArr;for(z$V=0;z$V<z$m;z$V++)(z$z=new z$AV).scX=z$N.getFloat32(),z$z.skX=z$N.getFloat32(),z$z.skY=z$N.getFloat32(),z$z.scY=z$N.getFloat32(),z$z.x=z$N.getFloat32(),z$z.y=z$N.getFloat32(),8===this.tMatrixDataLen&&(z$z.skewX=z$N.getFloat32(),z$z.skewY=z$N.getFloat32()),z$a.push(z$z),(z$k=this.mBoneArr[z$V]).transform=z$z;var z$Z,z$x=z$N.getUint16(),z$$=0;for(z$V=0;z$V<z$x;z$V++){for(z$E=new z$oV,z$$=z$N.getUint16(),z$U=0;z$U<z$$;z$U++)z$E.boneNames.push(z$N.readUTFString()),z$E.boneIndexs.push(z$N.getInt16());z$E.name=z$N.readUTFString(),z$E.targetBoneName=z$N.readUTFString(),z$E.targetBoneIndex=z$N.getInt16(),z$E.bendDirection=z$N.getFloat32(),z$E.mix=z$N.getFloat32(),z$E.isSpine=z$c,this.ikArr.push(z$E)}var z$j,z$o=z$N.getUint16(),z$J=0;for(z$V=0;z$V<z$o;z$V++){for(z$Z=new z$MV,z$J=z$N.getUint16(),z$U=0;z$U<z$J;z$U++)z$Z.boneIndexs.push(z$N.getInt16());z$Z.name=z$N.getUTFString(),z$Z.targetIndex=z$N.getInt16(),z$Z.rotateMix=z$N.getFloat32(),z$Z.translateMix=z$N.getFloat32(),z$Z.scaleMix=z$N.getFloat32(),z$Z.shearMix=z$N.getFloat32(),z$Z.offsetRotation=z$N.getFloat32(),z$Z.offsetX=z$N.getFloat32(),z$Z.offsetY=z$N.getFloat32(),z$Z.offsetScaleX=z$N.getFloat32(),z$Z.offsetScaleY=z$N.getFloat32(),z$Z.offsetShearY=z$N.getFloat32(),this.tfArr.push(z$Z)}var z$i=z$N.getUint16(),z$B=0;for(z$V=0;z$V<z$i;z$V++){for((z$j=new z$JV).name=z$N.readUTFString(),z$B=z$N.getUint16(),z$U=0;z$U<z$B;z$U++)z$j.bones.push(z$N.getInt16());z$j.target=z$N.readUTFString(),z$j.positionMode=z$N.readUTFString(),z$j.spacingMode=z$N.readUTFString(),z$j.rotateMode=z$N.readUTFString(),z$j.offsetRotation=z$N.getFloat32(),z$j.position=z$N.getFloat32(),z$j.spacing=z$N.getFloat32(),z$j.rotateMix=z$N.getFloat32(),z$j.translateMix=z$N.getFloat32(),this.pathArr.push(z$j)}var z$P,z$M,z$A,z$X,z$e,z$F=0,z$g=0,z$v=0,z$Y=NaN,z$C=0,z$f=z$N.getInt16();for(z$V=0;z$V<z$f;z$V++){var z$VV=z$N.getUint8(),z$UV={};this.deformAniArr.push(z$UV);for(var z$rV=0;z$rV<z$VV;z$rV++)for((z$P=new z$aV).skinName=z$N.getUTFString(),z$UV[z$P.skinName]=z$P,z$F=z$N.getInt16(),z$U=0;z$U<z$F;z$U++)for(z$M=new z$ZV,z$P.deformSlotDataList.push(z$M),z$g=z$N.getInt16(),z$r=0;z$r<z$g;z$r++)for(z$A=new z$xV,z$M.deformSlotDisplayList.push(z$A),z$A.slotIndex=z$N.getInt16(),z$A.attachment=z$N.getUTFString(),z$v=z$N.getInt16(),z$s=0;z$s<z$v;z$s++)for(1==z$N.getByte()?z$A.tweenKeyList.push(!0):z$A.tweenKeyList.push(!1),z$Y=z$N.getFloat32(),z$A.timeList.push(z$Y),z$X=[],z$A.vectices.push(z$X),z$C=z$N.getInt16(),z$p=0;z$p<z$C;z$p++)z$X.push(z$N.getFloat32())}var z$sV,z$pV,z$cV=z$N.getInt16(),z$RV=0,z$TV=0;for(z$V=0;z$V<z$cV;z$V++){for(z$RV=z$N.getInt16(),z$e=[],z$U=0;z$U<z$RV;z$U++){for((z$sV=new z$$V).time=z$N.getFloat32(),z$TV=z$N.getInt16(),z$r=0;z$r<z$TV;z$r++)z$sV.drawOrder.push(z$N.getInt16());z$e.push(z$sV)}this.drawOrderAniArr.push(z$e)}var z$NV,z$tV=z$N.getInt16(),z$bV=0;for(z$V=0;z$V<z$tV;z$V++){for(z$bV=z$N.getInt16(),z$pV=[],z$U=0;z$U<z$bV;z$U++)(z$NV=new z$jV).name=z$N.getUTFString(),z$NV.intValue=z$N.getInt32(),z$NV.floatValue=z$N.getFloat32(),z$NV.stringValue=z$N.getUTFString(),z$NV.time=z$N.getFloat32(),z$pV.push(z$NV);this.eventAniArr.push(z$pV)}var z$SV=z$N.getInt16();if(0<z$SV)for(this.attachmentNames=[],z$V=0;z$V<z$SV;z$V++)this.attachmentNames.push(z$N.getUTFString());var z$_V,z$GV,z$qV=z$N.getInt16();for(z$V=0;z$V<z$qV;z$V++)(z$_V=new z$mV).name=z$N.readUTFString(),z$_V.parent=z$N.readUTFString(),z$_V.attachmentName=z$N.readUTFString(),z$_V.srcDisplayIndex=z$_V.displayIndex=z$N.getInt16(),(z$_V.templet=this).boneSlotDic[z$_V.name]=z$_V,null==(z$GV=this.bindBoneBoneSlotDic[z$_V.parent])&&(this.bindBoneBoneSlotDic[z$_V.parent]=z$GV=[]),z$GV.push(z$_V),this.boneSlotArray.push(z$_V);var z$uV,z$hV,z$lV,z$WV=z$N.readUTFString().split("\n"),z$OV=0,z$LV=z$N.getUint8(),z$dV=0,z$kV=0,z$yV=0,z$DV=0,z$nV=0,z$IV=0,z$QV=0;for(z$V=0;z$V<z$LV;z$V++){for((z$uV=new z$iV).name=z$WV[z$OV++],z$dV=z$N.getUint8(),z$U=0;z$U<z$dV;z$U++){for((z$hV=new z$PV).name=z$WV[z$OV++],z$_V=this.boneSlotDic[z$hV.name],z$kV=z$N.getUint8(),z$r=0;z$r<z$kV;z$r++){if(z$lV=new z$BV,this.skinSlotDisplayDataArr.push(z$lV),z$lV.name=z$WV[z$OV++],z$lV.attachmentName=z$WV[z$OV++],z$lV.transform=new z$AV,z$lV.transform.scX=z$N.getFloat32(),z$lV.transform.skX=z$N.getFloat32(),z$lV.transform.skY=z$N.getFloat32(),z$lV.transform.scY=z$N.getFloat32(),z$lV.transform.x=z$N.getFloat32(),z$lV.transform.y=z$N.getFloat32(),z$hV.displayArr.push(z$lV),z$lV.width=z$N.getFloat32(),z$lV.height=z$N.getFloat32(),z$lV.type=z$N.getUint8(),z$lV.verLen=z$N.getUint16(),0<(z$H=z$N.getUint16()))for(z$lV.bones=[],z$s=0;z$s<z$H;z$s++){var z$HV=z$N.getUint16();z$lV.bones.push(z$HV)}if(0<(z$yV=z$N.getUint16()))for(z$lV.uvs=[],z$s=0;z$s<z$yV;z$s++)z$lV.uvs.push(z$N.getFloat32());if(0<(z$DV=z$N.getUint16()))for(z$lV.weights=[],z$s=0;z$s<z$DV;z$s++)z$lV.weights.push(z$N.getFloat32());if(0<(z$nV=z$N.getUint16()))for(z$lV.triangles=[],z$s=0;z$s<z$nV;z$s++)z$lV.triangles.push(z$N.getUint16());if(0<(z$IV=z$N.getUint16()))for(z$lV.vertices=[],z$s=0;z$s<z$IV;z$s++)z$lV.vertices.push(z$N.getFloat32());if(0<(z$QV=z$N.getUint16()))for(z$lV.lengths=[],z$s=0;z$s<z$QV;z$s++)z$lV.lengths.push(z$N.getFloat32())}z$uV.slotArr.push(z$hV)}this.skinDic[z$uV.name]=z$uV,this.skinDataArray.push(z$uV)}1==z$N.getUint8()?(this.yReverseMatrix=new z$zV(1,0,0,-1,0,0),z$Q&&z$Q.setTempMatrix(this.yReverseMatrix)):z$Q&&z$Q.setTempMatrix(new z$zV),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},z$V.getTexture=function(z$V){var z$U=this.subTextureDic[z$V];return z$U||(z$U=this.subTextureDic[z$V.substr(0,z$V.length-1)]),null==z$U?this._mainTexture:z$U},z$V.showSkinByIndex=function(z$V,z$U,z$r){if(void 0===z$r&&(z$r=!0),z$U<0&&z$U>=this.skinDataArray.length)return!1;var z$s,z$p,z$c=0,z$R=0,z$T=this.skinDataArray[z$U];if(z$T){for(z$c=0,z$R=z$T.slotArr.length;z$c<z$R;z$c++)(z$p=z$T.slotArr[z$c])&&(z$s=z$V[z$p.name])&&(z$s.showSlotData(z$p,z$r),z$r&&"undefined"!=z$s.attachmentName&&"null"!=z$s.attachmentName?z$s.showDisplayByName(z$s.attachmentName):z$s.showDisplayByIndex(z$s.displayIndex));return!0}return!1},z$V.getSkinIndexByName=function(z$V){for(var z$U=0,z$r=this.skinDataArray.length;z$U<z$r;z$U++)if(this.skinDataArray[z$U].name==z$V)return z$U;return-1},z$V.getGrahicsDataWithCache=function(z$V,z$U){return this._graphicsCache[z$V][z$U]},z$V.setGrahicsDataWithCache=function(z$V,z$U,z$r){this._graphicsCache[z$V][z$U]=z$r},z$V.destroy=function(){var z$V;for(var z$U in this._isDestroyed=!0,this.subTextureDic)(z$V=this.subTextureDic[z$U])&&z$V.destroy();for(z$U in this._textureDic)(z$V=this._textureDic[z$U])&&z$V.destroy();for(var z$r=0,z$s=this.skinSlotDisplayDataArr.length;z$r<z$s;z$r++)this.skinSlotDisplayDataArr[z$r].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete z$p.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},z$V.getAniNameByIndex=function(z$V){var z$U=this.getAnimation(z$V);return z$U?z$U.name:null},z$c(0,z$V,"rate",function(){return this._rate},function(z$V){this._rate=z$V}),z$p.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",z$p.TEMPLET_DICTIONARY=null,z$p}(z$a)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(z$V,z$U){"use strict";for(var z$r in Object.defineProperty(z$U,"__esModule",{value:!0}),Laya){var z$s=Laya[z$r];z$s&&z$s.__isclass&&(z$U[z$r]=z$s)}});