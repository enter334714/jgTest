var Q=wx.$I;import sdk from"./iiiiHELP.js";var config={game_id:256,game_pkg:Q[149476],partner_label:Q[149477],partner_id:Q[149478],game_ver:Q[149479],is_auth:!1,partner_app_id:26,partner_mp_id:Q[149480]};window.config=config;var $iEGRXD=$iERDXG();var HOST=Q[149481];var $iEGRDX=null;var $iERXDG=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;var checkHandler=null;var loginHandler=null;var requestCallback=!1;function $iERDXG(){var n={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(Q[149482]);var t=this;var a;a=wx.getStorageSync(Q[149483])?0:(a=t.uuid(16,32),wx.setStorageSync(Q[149483],a),1),wx.getStorageSync(Q[149484])||(o=t.uuid(16,32),wx.setStorageSync(Q[149484],o));var o=wx.getLaunchOptionsSync();var n=o.scene||"";a&&o.query&&o.query.ad_code&&wx.setStorageSync(Q[149485],o.query.ad_code),t.log(Q[120287],{install:a,scene:n}),wx.showShareMenu();t=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";t&&($iERXDG={invite:t,invite_type:o,is_new:a,scene:n}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(Q[149486]),n[Q[149487]]=typeof r==Q[149051]?r:null;var t=this;let a=wx.getLaunchOptionsSync();sdk.init({app_id:config.partner_app_id,mp_id:config.partner_mp_id,showLoading:!1}).then(e=>{sdk.login({data:{state:a.query.state||a.query.scene||""},confg:{showLoading:!1}}).then(e=>{partner_user_info=e.data,t.do_login(e.data),console.log(Q[149488]+JSON.stringify(e))})})},do_login:function(e){var a=this;var r=a.getPublicData();if(r[Q[149489]]=JSON.stringify(e),$iERXDG&&typeof $iERXDG==Q[120282])for(var t in $iERXDG)r[t]=$iERXDG[t];var o=Date.now();wx.request({url:Q[145954]+HOST+Q[149490],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:r,success:function(e){if(console.log(Q[149491]+JSON.stringify(e)),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,200==e.statusCode){var r=e.data;if(r.state){try{wx.setStorageSync(Q[149492],r.data.sdk_token),wx.setStorageSync(Q[149493],r.data.user_id),wx.setStorageSync(Q[149494],r.data.username),r.data.ext&&wx.setStorageSync(Q[149495],r.data.ext)}catch(e){}var t={userid:r.data.user_id,account:r.data.nick_name,token:r.data.token,invite_uid:r.data.invite_uid||"",invite_nickname:r.data.invite_nickname||"",invite_head_img:r.data.invite_head_img||"",head_img:r.data.head_img||"",is_client:r.data.is_client||"0",ios_pay:r.data.ios_pay||"0"};n[Q[149487]]&&n[Q[149487]](0,t)}else n[Q[149487]]&&n[Q[149487]](1,{type:Q[149496],errMsg:r.msg,time:Date.now()-o,res:e});a.getShareInfo(Q[149497],function(e){console.log(Q[149498]),wx.onShareAppMessage(function(){return a.logStartShare(Q[149497]),{title:e.title,imageUrl:e.img,query:e.query}})})}else n[Q[149487]]&&n[Q[149487]](1,{type:Q[149496],errMsg:Q[149499],time:Date.now()-o,res:e})},fail:function(e){console.log(Q[149500]),console.log(e),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,n[Q[149487]]&&n[Q[149487]](1,{type:Q[149501],errMsg:e.errMsg,time:Date.now()-o,res:e})}}),requestCallback||(loginHandler=setTimeout(function(){console.log(Q[149502]),n[Q[149487]]&&n[Q[149487]](1,{type:Q[149503],errMsg:Q[149504],time:Date.now()-o}),n[Q[149487]]=null},2e4))},share:function(e){n[Q[149505]]=typeof callback==Q[149051]?callback:null;var t=e.type||Q[149505];console.log(Q[149506]+t);var a=this;this.getShareInfo(t,function(e){a.logStartShare(t);var r=e.query;sdk.getShareInfo({data:{path:Q[149507]}}).then(e=>{wx.onShareAppMessage(function(){return{title:e.data.title,imageUrl:e.data.image,query:"state="+e.data.state+"&"+r}})})}),sdk.addShareInfo({data:{to_target:"wx"}}).then(e=>{})},logStartShare:function(e){var r=wx.getStorageSync(Q[149492]);wx.request({url:Q[145954]+HOST+Q[149508],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:$iEGRDX?$iEGRDX.server_id:"",role_id:$iEGRDX?$iEGRDX.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,r){console.log(Q[149509]),n[Q[127229]]=typeof r==Q[149051]?r:null;wx.getStorageSync(Q[149492]);wx.request({url:Q[145954]+HOST+Q[149510],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(Q[149511]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,200==e.statusCode&&(r=e.data).state?n[Q[127229]]&&n[Q[127229]](r.data):n[Q[127229]]&&n[Q[127229]]({develop:0})},fail:function(e){console.log(Q[149512]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,n[Q[127229]]&&n[Q[127229]]({develop:0})}}),requestCallback||(checkHandler=setTimeout(function(){console.log(Q[149513]),n[Q[127229]]&&n[Q[127229]]({develop:0}),n[Q[127229]]=null},1e4))},getShareInfo:function(e,r){console.log(Q[149514]);var t=wx.getStorageSync(Q[149492]);wx.request({url:Q[145954]+HOST+Q[149515],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:$iEGRDX?$iEGRDX.server_id:"",role_id:$iEGRDX?$iEGRDX.role_id:"",no_log:1},success:function(e){console.log(Q[149516]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):n[Q[149505]]&&n[Q[149505]](1,{errMsg:Q[149517]+e.msg}):n[Q[149505]]&&n[Q[149505]](1,{errMsg:Q[149518]})}})},updateShare:function(e,r,t,a,o,n){console.log(Q[149519]);var i=wx.getStorageSync(Q[149492]);wx.request({url:Q[145954]+HOST+Q[149520],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:a,sever_id:o,scene:n},success:function(e){console.log(Q[149521]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(Q[149522]+e);let t={data:{}};sdk.checkMsg({data:{content:e}}).then(e=>{console.log(Q[149523]+JSON.stringify(e)),e.msg==Q[130052]?(t.statusCode=200,t.data.state=1):(t.statusCode=0,t.data.state=0),r&&r(t)},e=>{console.log(e),t.statusCode=0,t.data.state=0,r&&r(t)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(Q[149524]+JSON.stringify(e));n[Q[149525]]=typeof r==Q[149051]?r:null;r=wx.getStorageSync(Q[149492]);var t=wx.getStorageSync(Q[149495]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform},this.order_data=e,(r=this.getPublicData())[Q[149527]]=JSON.stringify(e),wx.request({url:Q[145954]+HOST+Q[149528],method:Q[149416],dataType:Q[125939],header:{"content-type":Q[149417]},data:r,success:function(e){console.log(Q[149529]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?sdk.checkPay({data:{"order-currency":Q[149530],"order-cp_order_id":e.data.pay_data.orderId,"order-product_price":e.data.pay_data.amount,"order-product_id":e.data.pay_data.productId,"order-product_cnt":1,"order-product_name":e.data.pay_data.productName,"order-product_desc":e.data.pay_data.productDec,"order-ext":e.data.pay_data.orderId,"role-event":"5","role-server_id":e.data.pay_data.serverId,"role-server_name":e.data.pay_data.serverName,"role-role_id":e.data.pay_data.roleId,"role-role_name":e.data.pay_data.roleName,"role-role_level":e.data.pay_data.roleLevel,"role-role_vip":0}}).then(e=>{console.log(Q[149531]+JSON.stringify(e))}):n[Q[149525]]&&n[Q[149525]](1,{errMsg:e.msg}):n[Q[149487]]&&n[Q[149487]](1,{errMsg:Q[149499]})}})):n[Q[149525]]&&n[Q[149525]](1,{errMsg:Q[149526]})},logCreateRole:function(e){var r=wx.getStorageSync(Q[149493]);var t=wx.getStorageSync(Q[149494]);var a={};a[Q[149532]]=r,a[Q[149533]]=t,a[Q[130987]]=e.roleid,a[Q[149534]]=e.rolelevel,a[Q[149535]]=e.rolename,a[Q[131662]]=e.serverid,e.roleid&&e.serverid&&($iEGRDX={role_id:e.roleid,server_id:e.serverid}),this.log(Q[120006],a),sdk.updateRole({data:{"role-event":"2","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{},e=>{})},logEnterGame:function(e){var r=wx.getStorageSync(Q[149493]);var t=wx.getStorageSync(Q[149494]);var a={};a[Q[149532]]=r,a[Q[149533]]=t,a[Q[130987]]=e.roleid,a[Q[149534]]=e.rolelevel,a[Q[149535]]=e.rolename,a[Q[131662]]=e.serverid,e.roleid&&e.serverid&&($iEGRDX={role_id:e.roleid,server_id:e.serverid}),this.log(Q[125821],a),$iERXDG&&this.updateShare($iERXDG.invite,$iERXDG.invite_type,$iERXDG.is_new,e.roleid,e.serverid,$iERXDG.scene),sdk.updateRole({data:{"role-event":"1","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{},e=>{})},logRoleUpLevel:function(e){var r=wx.getStorageSync(Q[149493]);var t=wx.getStorageSync(Q[149494]);var a={};a[Q[149532]]=r,a[Q[149533]]=t,a[Q[130987]]=e.roleid,a[Q[149534]]=e.rolelevel,a[Q[149535]]=e.rolename,a[Q[131662]]=e.serverid,e.roleid&&e.serverid&&($iEGRDX={role_id:e.roleid,server_id:e.serverid}),this.log(Q[149536],a)},uuid:function(e,r){var t=Q[149537].split("");var a,o=[];var n;if(e=e||t.length,r)for(a=0;a<r;a++)o[a]=t[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",a=0;a<36;a++)o[a]||(n=0|16*Math.random(),o[a]=t[19==a?3&n|8:n]);return o.join("")},getPublicData:function(){var e=wx.getStorageSync(Q[149483]);var r=wx.getStorageSync(Q[149484]);var t=wx.getStorageSync(Q[149485]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:Q[149538],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":Q[149539],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==Q[149411]?1:2}},log:function(e,r){var t=this.getPublicData();for(var a in r)t[a]=r[a];console.log(Q[149540]+e),console.log(t),wx.request({url:Q[145954]+HOST+Q[149541]+e+Q[149542]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,r,t){e in $iEGRXD&&$iEGRXD[e](r,t)}exports.init=function(e,r){run(Q[120368],e,r)},exports.login=function(e){run(Q[149487],"",e)},exports.login=function(e){run(Q[149487],"",e)},exports.pay=function(e,r){run(Q[149525],e,r)},exports.openService=function(){run(Q[145403])},exports.logCreateRole=function(e,r,t,a,o){run(Q[149543],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.logEnterGame=function(e,r,t,a,o){run(Q[149544],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.logRoleUpLevel=function(e,r,t,a,o){run(Q[149545],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.share=function(e){run(Q[149505],{type:e})},exports.msgCheck=function(e,r){run(Q[132351],e,r)},exports.downloadClient=function(){run(Q[149546])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(Q[149547])},exports.weiduanHelper=function(){run(Q[143953])},exports.setMessageToFriendQuery=function(e,r){run(Q[149548],e,r)};