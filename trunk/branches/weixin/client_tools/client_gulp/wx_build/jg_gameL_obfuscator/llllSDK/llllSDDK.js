var W=wx.$l;import Dall from"./llllHELP";var config={game_id:W[30281],game_pkg:W[30282],partner_id:"19",game_ver:W[30283],is_auth:!1,from:null,tmpId:{1:W[30284],2:W[30285],3:W[30286]},min_app_id:""};window.config=config;var $LBHDT0=$LBD0TH();var HOST=W[30270];var t;var t_second=0;var t_max=300;var $LBHD0T=null;var $LBDT0H=null;var $LBDTH0=null;var checkHandler=null;var loginHandler=null;var requestCallback=!1;var ad_info=null;function $LBD0TH(){var i={};return{order_data:{},init:function(e,o){e=e&&e.game_ver?e.game_ver:0;console.log(W[30287]);var t=this;var n=wx.getStorageSync(W[30288]);var r;r=n?0:(n=t.uuid(16,32),wx.setStorageSync(W[30288],n),1),wx.getStorageSync(W[30289])||(a=t.uuid(16,32),wx.setStorageSync(W[30289],a));var a=wx.getLaunchOptionsSync();var i=a.scene||"";console.log(W[30290]),console.log(a),r&&a.query&&a.query.ad_code&&wx.setStorageSync(W[30291],a.query.ad_code),a.query&&a.query.from&&""!=a.query.from?(r&&wx.setStorageSync(W[30292],a.query.from),config.from=a.query.from):(s=wx.getStorageSync(W[30292]))||""==s||(config.from=s),console.log(W[30293]+config.from),t.log(W[1135],{install:r,scene:i}),wx.showShareMenu();var s=a.query&&a.query.invite?a.query.invite:"";t=a.query&&a.query.invite_type?a.query.invite_type:"";s&&($LBDT0H={invite:s,invite_type:t,is_new:r,scene:i}),e&&this.checkGameVersion(e,function(e){o&&o(e)}),ad_info={temp_info:a,temp_uuid:n,temp_is_new:r}},adLog:function(e){var o=ad_info.temp_info;var t=ad_info.temp_is_new;var n=ad_info.temp_uuid;o.query.hasOwnProperty(W[30294])&&o.query.hasOwnProperty(W[30295])&&t&&((t=o.query)[W[30296]]=n,t[W[30297]]=e,o=W[30298]+this.convertObj(t),console.log(W[30299]+o),wx.request({url:o}))},convertObj:function(e){var o=[];for(var t in e){var n=e[t];n.constructor==Array?n.forEach(function(e){o.push(t+"="+e)}):o.push(t+"="+n)}return o.join("&")},login:function(e,o){console.log(W[30300]);var t=this;i[W[690]]=typeof o==W[30187]?o:null,config.is_auth?wx.getSetting({success:function(e){var o;e.authSetting[W[30301]]?(console.log(W[30302]),t.do_login()):(console.log(W[30303]),wx.hideLoading({}),(e=wx.getSystemInfoSync()).screenWidth,e.screenHeight,(o=wx.createUserInfoButton({type:W[210],text:W[30304],withCredentials:!1,style:{top:e.windowHeight/2+e.windowHeight/4,left:e.windowWidth/2-100,width:200,height:40,lineHeight:40,backgroundColor:W[30305],color:W[89],textAlign:W[45],fontSize:16,borderRadius:4}})).show(),o.onTap(e=>{console.log(e),$LTH0D({title:W[30306]}),e.errMsg==W[30307]?t.do_login({head_img:e.userInfo.avatarUrl||"",nick_name:e.userInfo.nickName||""}):t.do_login(),o.destroy()}))},fail:function(){console.log(W[30308]),t.do_login()}}):(console.log(W[30309]+config.is_auth),t.do_login())},do_login:function(t){var a=this;wx.login({success:function(e){if(console.log(W[30310]+JSON.stringify(e)),e.code){var n=a.getPublicData();if(n[W[30311]]=1,n[W[24724]]=e.code,n[W[30312]]=t?t.nick_name:"",n[W[30313]]=t?t.head_img:"",$LBDT0H&&typeof $LBDT0H==W[1130])for(var o in $LBDT0H)n[o]=$LBDT0H[o];var r;config.is_auth?wx.getUserInfo({success:function(e){var o=e.encryptedData;var t=e.iv;e=e.signature;n[W[30314]]=o,n.iv=t,n[W[30315]]=e,wx.request({url:W[26570]+HOST+W[30316],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:n,success:function(e){if(console.log(W[30317]),console.log(e),200==e.statusCode){e=e.data;if(e.state){var o={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};try{a.adLog(e.data.openid)}catch(e){console.log(W[30318]+JSON.stringify(e))}try{wx.setStorageSync(W[30319],e.data.sdk_token),wx.setStorageSync(W[30320],e.data.user_id),wx.setStorageSync(W[30271],e.data.username),e.data.ext&&wx.setStorageSync(W[30321],e.data.ext)}catch(e){}i[W[690]]&&i[W[690]](0,o)}else i[W[690]]&&i[W[690]](1,{errMsg:e.msg});a.getShareInfo(W[30322],function(e){console.log(W[30323]),wx.onShareAppMessage(function(){return a.logStartShare(W[30322]),{title:e.title,imageUrl:e.img,query:e.query}})})}else i[W[690]]&&i[W[690]](1,{errMsg:W[30324]})},fail:function(e){i[W[690]]&&i[W[690]](1,{errMsg:e.errMsg})}})},fail:function(e){i[W[690]]&&i[W[690]](1,{errMsg:e.errMsg})}}):(r=Date.now(),wx.request({url:W[26570]+HOST+W[30316],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:n,success:function(e){if(console.log(W[30317]),console.log(e),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,200==e.statusCode){var o=e.data;if(o.state){var t={userid:o.data.user_id,account:o.data.nick_name,token:o.data.token,invite_uid:o.data.invite_uid||"",invite_nickname:o.data.invite_nickname||"",invite_head_img:o.data.invite_head_img||"",head_img:o.data.head_img||"",is_client:o.data.is_client||"0",ios_pay:o.data.ios_pay||"0"};try{a.adLog(o.data.openid)}catch(e){console.log(W[30318]+JSON.stringify(e))}try{wx.setStorageSync(W[30319],o.data.sdk_token),wx.setStorageSync(W[30320],o.data.user_id),wx.setStorageSync(W[30271],o.data.username),o.data.ext&&wx.setStorageSync(W[30321],o.data.ext)}catch(e){}i[W[690]]&&i[W[690]](0,t)}else i[W[690]]&&i[W[690]](1,{type:W[30325],errMsg:o.msg,time:Date.now()-r,res:e});a.getShareInfo(W[30322],function(e){console.log(W[30323]),wx.onShareAppMessage(function(){return a.logStartShare(W[30322]),{title:e.title,imageUrl:e.img,query:e.query}})})}else i[W[690]]&&i[W[690]](1,{type:W[30325],errMsg:W[30324],time:Date.now()-r,res:e})},fail:function(e){console.log(W[30326]),console.log(e),a.log(W[187],{event:W[30327]}),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,i[W[690]]&&i[W[690]](1,{type:W[30328],errMsg:e.errMsg,time:Date.now()-r,res:e})}}),requestCallback||(loginHandler=setTimeout(function(){console.log(W[30329]),a.log(W[187],{event:W[30330]}),i[W[690]]&&i[W[690]](1,{type:W[30331],errMsg:W[30332],time:Date.now()-r}),i[W[690]]=null},2e4)))}else i[W[690]]&&i[W[690]](1,{type:W[30333],errMsg:e.errMsg,res:e})},fail:function(e){console.log(W[30334]+JSON.stringify(e)),-1<e.errMsg.indexOf(W[30335])||e.errMsg.indexOf(W[30336]),i[W[690]]&&i[W[690]](1,{type:W[30337],errMsg:e.errMsg,res:e})}})},share:function(e){i[W[786]]=typeof callback==W[30187]?callback:null;var o=e.type||W[786];console.log(W[30338]+o);var t=this;this.getShareInfo(o,function(e){t.logStartShare(o),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var o=wx.getStorageSync(W[30319]);wx.request({url:W[26570]+HOST+W[30339],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,server_id:$LBHD0T?$LBHD0T.server_id:"",role_id:$LBHD0T?$LBHD0T.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,o){console.log(W[30340]),i[W[7953]]=typeof o==W[30187]?o:null;wx.getStorageSync(W[30319]);wx.request({url:W[26570]+HOST+W[30341],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){console.log(W[30342]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,200==e.statusCode?(e=e.data,config.min_app_id=e.data.min_app_id,e.state?i[W[7953]]&&i[W[7953]](e.data):i[W[7953]]&&i[W[7953]]({develop:0})):i[W[7953]]&&i[W[7953]]({develop:0})},fail:function(e){console.log(W[30343]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,i[W[7953]]&&i[W[7953]]({develop:0})}}),requestCallback||(checkHandler=setTimeout(function(){console.log(W[30344]),i[W[7953]]&&i[W[7953]]({develop:0}),i[W[7953]]=null},1e4))},getShareInfo:function(e,o){console.log(W[30345]);var t=wx.getStorageSync(W[30319]);wx.request({url:W[26570]+HOST+W[30346],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:$LBHD0T?$LBHD0T.server_id:"",role_id:$LBHD0T?$LBHD0T.role_id:"",no_log:1},success:function(e){console.log(W[30347]),console.log(e),200==e.statusCode?(e=e.data).state?o&&o(e.data):i[W[786]]&&i[W[786]](1,{errMsg:W[30348]+e.msg}):i[W[786]]&&i[W[786]](1,{errMsg:W[30349]})}})},updateShare:function(e,o,t,n,r,a){console.log(W[30350]);var i=wx.getStorageSync(W[30319]);wx.request({url:W[26570]+HOST+W[30351],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:o,is_new:t,role_id:n,sever_id:r,scene:a},success:function(e){console.log(W[30352]),console.log(e)}})},msgCheck:function(e,o){console.log(W[30353]);var t=wx.getStorageSync(W[30319]);wx.request({url:W[26570]+HOST+W[30354],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,content:e},success:function(e){console.log(W[30355]),console.log(e),o&&o(e)}})},pay:function(e,o){var t=this;wx.checkSession({success:function(){t.startPay(e,o)},fail:function(){console.log(W[30356]),t.login({},function(){t.startPay(e,o)})}})},startPay:function(e,o){console.log(W[30357]),console.log(e);var t=this;i[W[768]]=typeof o==W[30187]?o:null;o=wx.getStorageSync(W[30319]);var n=wx.getStorageSync(W[30321]);var r;o&&n?(r=wx.getSystemInfoSync(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:o,session_key:n,platform:r.platform},t.order_data=e,(o=t.getPublicData())[W[30359]]=JSON.stringify(e),o[W[30311]]=1,wx.request({url:W[26570]+HOST+W[30360],method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:o,success:function(e){console.log(W[30361]),console.log(e),200==e.statusCode?(e=e.data).state?typeof wx.requestPayment==W[30141]?r.platform==W[559]||r.platform==W[562]?e.data.is_android_pay?1==e.data.ios_pay_type?t.kfPay(e.data):2==e.data.ios_pay_type&&t.xiaoPay(e.data):t.gamePay(e.data):e.data.is_ios_pay?1==e.data.ios_pay_type?t.kfPay(e.data):2==e.data.ios_pay_type&&t.xiaoPay(e.data):wx.showModal({title:W[30362],content:W[30363],confirmText:W[30364],showCancel:!1}):t.minPay(e.data):i[W[768]]&&i[W[768]](1,{errMsg:e.msg}):i[W[768]]&&i[W[768]](1,{errMsg:W[30324]})}})):i[W[768]]&&i[W[768]](1,{errMsg:W[30358]})},xiaoPay:function(e){wx.navigateToMiniProgram({appId:config.min_app_id,path:W[30365]+e.orderId+W[30366]+e.money,extraData:{},envVersion:W[30279],success(e){}})},minPay:function(o){var t=this;wx.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(e){e.errMsg==W[30367]&&(e={cpOrderNo:t.order_data.cpbill,orderNo:o.orderId,amount:t.order_data.price,extension:t.order_data.extension},i[W[768]]&&i[W[768]](0,e))},fail:function(e){e.errMsg==W[30368]?i[W[768]]&&i[W[768]](2,{errMsg:W[30369]}):i[W[768]]&&i[W[768]](1,{errMsg:W[30370]+e.err_desc})},complete:function(e){}})},gamePay:function(o){var t=this;o.buyQuantity<=o.balance?(console.log(W[30371]),wx.showModal({title:W[30362],content:W[30372]+o.balance+W[30373]+o.buyQuantity+W[30374],showCancel:!1,confirmText:W[30364],success:function(){t.gameGoPay(o)}})):(console.log(W[30375]),wx.requestMidasPayment({mode:W[30376],env:o.env,offerId:o.offerId,currencyType:o.currencyType,platform:o.platform,buyQuantity:o.buyQuantity,zoneId:o.zoneId,success:function(e){e.errMsg==W[30377]&&t.gameGoPay(o)},fail:function(e){console.log(W[30378]+JSON.stringify(e)),-1!==e.errMsg.indexOf(W[30379])?i[W[768]]&&i[W[768]](2,{errMsg:W[30369]}):i[W[768]]&&i[W[768]](1,{errMsg:W[30370]+e.errMsg})},complete:function(e){}}))},kfPay:function(e){$LBDTH0=e.orderId,wx.showModal({title:W[30362],content:W[30380],showCancel:!1,confirmText:W[30364],success:function(){var e={showMessageCard:!0,sendMessageTitle:W[30381],sendMessageImg:W[30382]};wx.openCustomerServiceConversation(e)}})},gameGoPay:function(o,e){console.log(W[30383]);var t=this;var n=wx.getStorageSync(W[30321]);wx.request({url:W[26570]+HOST+W[30384]+config.partner_id+"/"+config.game_pkg+"/",method:W[660],dataType:W[6668],header:{"content-type":W[825]},data:{order_id:o.orderId,time:o.time,sign:o.sign,session_key:n},success:function(e){console.log(W[30385]),console.log(e),200==e.statusCode&&(1==e.data.state?(e={cpOrderNo:t.order_data.cpbill,orderNo:o.orderId,amount:t.order_data.price,extension:t.order_data.extension},i[W[768]]&&i[W[768]](0,e)):i[W[768]]&&i[W[768]](1,{errMsg:W[30386]}))},fail:function(){}})},logCreateRole:function(e){var o=wx.getStorageSync(W[30320]);var t=wx.getStorageSync(W[30271]);var n={};n[W[30387]]=o,n[W[30388]]=t,n[W[11697]]=e.roleid,n[W[30389]]=e.rolelevel,n[W[30390]]=e.rolename,n[W[158]]=e.serverid,e.roleid&&e.serverid&&($LBHD0T={role_id:e.roleid,server_id:e.serverid}),this.log(W[7],n)},logEnterGame:function(e){var o=wx.getStorageSync(W[30320]);var t=wx.getStorageSync(W[30271]);var n={};n[W[30387]]=o,n[W[30388]]=t,n[W[11697]]=e.roleid,n[W[30389]]=e.rolelevel,n[W[30390]]=e.rolename,n[W[158]]=e.serverid,e.roleid&&e.serverid&&($LBHD0T={role_id:e.roleid,server_id:e.serverid}),this.log(W[6550],n),$LBDT0H&&this.updateShare($LBDT0H.invite,$LBDT0H.invite_type,$LBDT0H.is_new,e.roleid,e.serverid,$LBDT0H.scene)},logRoleUpLevel:function(e){var o=wx.getStorageSync(W[30320]);var t=wx.getStorageSync(W[30271]);var n={};n[W[30387]]=o,n[W[30388]]=t,n[W[11697]]=e.roleid,n[W[30389]]=e.rolelevel,n[W[30390]]=e.rolename,n[W[158]]=e.serverid,e.roleid&&e.serverid&&($LBHD0T={role_id:e.roleid,server_id:e.serverid}),this.log(W[30391],n)},uuid:function(e,o){var t=W[30392].split("");var n,r=[];var a;if(e=e||t.length,o)for(n=0;n<o;n++)r[n]=t[0|Math.random()*e];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",n=0;n<36;n++)r[n]||(a=0|16*Math.random(),r[n]=t[19==n?3&a|8:a]);return r.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var o=wx.getStorageSync(W[30288]);var t=wx.getStorageSync(W[30289]);var n=wx.getStorageSync(W[30291]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,ad_code:n,uuid:o,idfv:t,dname:e.model,mac:W[30393],net_type:0==e.wifiSignal?"4G":W[30394],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:e.platform==W[559]?1:2}},subscribeWhatsNew:function(e,o){wx.requestSubscribeWhatsNew({msgType:1,success(e){console.log(e),o(e.confirm)},fail(e){console.error(e),o(!1)}})},subscriptionsSetting:function(e,o){wx.getWhatsNewSubscriptionsSetting({msgType:1,success(e){console.log(e),o(e.status)},fail(e){console.error(e),o(0)}})},log:function(e,o){var t=this.getPublicData();for(var n in o)t[n]=o[n];console.log(W[30395]+e),console.log(t),wx.request({url:W[26570]+HOST+W[30396]+e+W[30397]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},subscribeMessage:function(e,o){console.log(W[30398]+e),i[W[797]]=typeof o==W[30187]?o:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(W[30399]),console.log(e),i[W[797]]&&i[W[797]](e)},fail(e){console.log(W[30400]),console.log(e),i[W[797]]&&i[W[797]](e)}})},weiduanHelper:function(){(new Dall).stebutonanimation(config.partner_id,config.game_pkg,config.game_id)}}}function run(e,o,t){e in $LBHDT0&&$LBHDT0[e](o,t)}exports.init=function(e,o){run(W[371],e,o)},exports.login=function(e){run(W[690],"",e)},exports.pay=function(e,o){run(W[768],e,o)},exports.openService=function(){run(W[787])},exports.logCreateRole=function(e,o,t,n,r){run(W[781],{serverid:e,servername:o,roleid:t,rolename:n,rolelevel:r})},exports.logEnterGame=function(e,o,t,n,r){run(W[783],{serverid:e,servername:o,roleid:t,rolename:n,rolelevel:r})},exports.logRoleUpLevel=function(e,o,t,n,r){run(W[785],{serverid:e,servername:o,roleid:t,rolename:n,rolelevel:r})},exports.share=function(e){run(W[786],{type:e})},exports.msgCheck=function(e,o){run(W[641],e,o)},exports.downloadClient=function(){run(W[30401])},exports.subscribeMessage=function(e,o){run(W[797],e,o)},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(W[30402])},exports.weiduanHelper=function(){run(W[789])},exports.subscribeWhatsNew=function(e,o){run(W[747],e,o)},exports.subscriptionsSetting=function(e,o){run(W[803],e,o)};