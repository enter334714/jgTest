var Laya=window.Laya=function(Lj,La){var Lk={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(La,Lb){return 1==arguments.length?Lk.__presubstr.call(this,La):Lk.__presubstr.call(this,La,0<Lb?Lb:this.length+Lb)},__init:function(La){La.forEach(function(La){La.__init$&&La.__init$()})},__isClass:function(La){return La&&(La.__isclass||La==Object||La==String||La==Array)},__newvec:function(La,Lb){var Lc=[];Lc.length=La;for(var Ld=0;Ld<La;Ld++)Lc[Ld]=Lb;return Lc},__extend:function(La,Lb){for(var Lc in Lb)if(Lb.hasOwnProperty(Lc)){var Ld=Object.getOwnPropertyDescriptor(Lb,Lc),Le=Ld.get,Lf=Ld.set;Le||Lf?Le&&Lf?Object.defineProperty(La,Lc,Ld):(Le&&Object.defineProperty(La,Lc,Le),Lf&&Object.defineProperty(La,Lc,Lf)):La[Lc]=Lb[Lc]}function Lg(){Lk.un(this,"constructor",La)}Lg.prototype=Lb.prototype,La.prototype=new Lg,Lk.un(La.prototype,"__imps",Lk.__copy({},Lb.prototype.__imps))},__copy:function(La,Lb){if(!Lb)return null;for(var Lc in La=La||{},Lb)La[Lc]=Lb[Lc];return La},__package:function(La,Lb){if(!Lk.__packages[La]){Lk.__packages[La]=!0;var Lc=Lj,Ld=La.split(".");if(1<Ld.length)for(var Le=0,Lf=Ld.length-1;Le<Lf;Le++){var Lg=Lc[Ld[Le]];Lc=Lg||(Lc[Ld[Le]]={})}Lc[Ld[Ld.length-1]]||(Lc[Ld[Ld.length-1]]=Lb||{})}},__hasOwnProperty:function(La,Lb){return Lb=Lb||this,Object.hasOwnProperty.call(Lb,La)||function La(Lb,Lc){if(Object.hasOwnProperty.call(Lc.prototype,Lb))return!0;var Ld=Lc.prototype.__super;return null==Ld?null:La(Lb,Ld)}(La,Lb.__class)},__typeof:function(La,Lb){if(!La||!Lb)return!1;if(Lb===String)return"string"==typeof La;if(Lb===Number)return"number"==typeof La;if(Lb.__interface__)Lb=Lb.__interface__;else if("string"!=typeof Lb)return La instanceof Lb;return La.__imps&&La.__imps[Lb]||La.__class==Lb},__as:function(La,Lb){return this.__typeof(La,Lb)?La:null},__int:function(La){return La?parseInt(La):0},interface:function(La,Lb){Lk.__package(La,{});var Lc=Lk.__internals,Ld=Lc[La]=Lc[La]||{self:La};if(Lb){var Le=Lb.split(",");Ld.extend=[];for(var Lf=0;Lf<Le.length;Lf++){var Lg=Le[Lf];Lc[Lg]=Lc[Lg]||{self:Lg},Ld.extend.push(Lc[Lg])}}var Lh=Lj,Li=La.split(".");for(Lf=0;Lf<Li.length-1;Lf++)Lh=Lh[Li[Lf]];Lh[Li[Li.length-1]]={__interface__:La}},class:function(La,Lb,Lc,Ld){if(Lc&&Lk.__extend(La,Lc),Lb)if(Lk.__package(Lb,La),Lk.__classmap[Lb]=La,0<Lb.indexOf(".")){if(0==Lb.indexOf("laya.")){var Le=Lb.split(".");Ld=Ld||Le[Le.length-1],Lk[Ld]&&console.log("Warning!,this class["+Ld+"] already exist:",Lk[Ld]),Lk[Ld]=La}}else"Main"==Lb?Lj.Main=La:"MainWX"==Lb?Lj.MainWX=La:(Lk[Lb]&&console.log("Error!,this class["+Lb+"] already exist:",Lk[Lb]),Lk[Lb]=La);var Lf=Lk.un,Lg=La.prototype;Lf(Lg,"hasOwnProperty",Lk.__hasOwnProperty),Lf(Lg,"__class",La),Lf(Lg,"__super",Lc),Lf(Lg,"__className",Lb),Lf(La,"__super",Lc),Lf(La,"__className",Lb),Lf(La,"__isclass",!0),Lf(La,"super",function(La){this.__super.call(La)})},imps:function(La,Lb){if(!Lb)return null;var Le=La.__imps||Lk.un(La,"__imps",{});function Lf(La){var Lb,Lc;if((Lb=Lk.__internals[La])&&(Le[La]=!0,Lc=Lb.extend))for(var Ld=0;Ld<Lc.length;Ld++)Lf(Lc[Ld].self)}for(var Lc in Lb)Lf(Lc)},superSet:function(La,Lb,Lc,Ld){var Le=La.prototype["_$set_"+Lc];Le&&Le.call(Lb,Ld)},superGet:function(La,Lb,Lc){var Ld=La.prototype["_$get_"+Lc];return Ld?Ld.call(Lb):null},getset:function(La,Lb,Lc,Ld,Le){La?(Ld&&(Lb["_$GET_"+Lc]=Ld),Le&&(Lb["_$SET_"+Lc]=Le)):(Ld&&Lk.un(Lb,"_$get_"+Lc,Ld),Le&&Lk.un(Lb,"_$set_"+Lc,Le)),Ld&&Le?Object.defineProperty(Lb,Lc,{get:Ld,set:Le,enumerable:!1,configurable:!0}):(Ld&&Object.defineProperty(Lb,Lc,{get:Ld,enumerable:!1,configurable:!0}),Le&&Object.defineProperty(Lb,Lc,{set:Le,enumerable:!1,configurable:!0}))},static:function(Lc,Ld){for(var Le=0,La=Ld.length;Le<La;Le+=2)if("length"==Ld[Le])Lc.length=Ld[Le+1].call(Lc);else{function Lb(){var Lb=Ld[Le],La=Ld[Le+1];Object.defineProperty(Lc,Lb,{get:function(){return delete this[Lb],this[Lb]=La.call(this)},set:function(La){delete this[Lb],this[Lb]=La},enumerable:!0,configurable:!0})}Lb()}},un:function(La,Lb,Lc){return Lc||(Lc=La[Lb]),Lk.__propun.value=Lc,Object.defineProperty(La,Lb,Lk.__propun),Lc},uns:function(Lb,La){La.forEach(function(La){Lk.un(Lb,La)})}};return Lj.console=Lj.console||{log:function(){}},Lj.trace=Lj.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),Lk}(window,document);!function(La,Lb,Lc){Lc.un,Lc.uns,Lc.static,Lc.class,Lc.getset,Lc.__newvec}(window,document,Laya),function(Ln,Lb,Lz){Lz.un,Lz.uns;var Li=Lz.static,Lq=Lz.class,Lk=Lz.getset;Lz.__newvec;Lz.interface("laya.runtime.IMarket"),Lz.interface("laya.filters.IFilter"),Lz.interface("laya.display.ILayout"),Lz.interface("laya.resource.IDispose"),Lz.interface("laya.runtime.IPlatform"),Lz.interface("laya.resource.IDestroy"),Lz.interface("laya.runtime.IConchNode"),Lz.interface("laya.filters.IFilterAction"),Lz.interface("laya.runtime.ICPlatformClass"),Lz.interface("laya.resource.ICreateResource"),Lz.interface("laya.runtime.IConchRenderObject"),Lz.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var LF=function(){function Lf(){}return Lq(Lf,"laya.utils.RunDriver"),Lf.FILTER_ACTIONS=[],Lf.pixelRatio=-1,Lf._charSizeTestDiv=null,Lf.now=function(){return Date.now()},Lf.getWindow=function(){return Ln},Lf.getPixelRatio=function(){if(Lf.pixelRatio<0){var La=LO.context,Lb=La.backingStorePixelRatio||La.webkitBackingStorePixelRatio||La.mozBackingStorePixelRatio||La.msBackingStorePixelRatio||La.oBackingStorePixelRatio||La.backingStorePixelRatio||1;(Lf.pixelRatio=(LO.window.devicePixelRatio||1)/Lb)<1&&(Lf.pixelRatio=1)}return Lf.pixelRatio},Lf.getIncludeStr=function(La){return null},Lf.createShaderCondition=function(La){var Lb="(function() {return "+La+";})";return Lz._runScript(Lb)},Lf.fontMap=[],Lf.measureText=function(La,Lb){var Lc=Lf.hanzi.test(La);if(Lc&&Lf.fontMap[Lb])return Lf.fontMap[Lb];var Ld=LO.context;Ld.font=Lb;var Le=Ld.measureText(La);return Le||(Le={width:16,height:16}),Lc&&(Lf.fontMap[Lb]=Le),Le},Lf.getWebGLContext=function(La){},Lf.beginFlush=function(){},Lf.endFinish=function(){},Lf.addToAtlas=null,Lf.flashFlushImage=function(La){},Lf.drawToCanvas=function(La,Lb,Lc,Ld,Le,Lf){var Lg=Lta.create("2D"),Lh=new LK(Lc,Ld,Lg);return LL.renders[Lb]._fun(La,Lh,Le,Lf),Lg},Lf.createParticleTemplate2D=null,Lf.createGLTextur=null,Lf.createWebGLContext2D=null,Lf.changeWebGLSize=function(La,Lb){},Lf.createRenderSprite=function(La,Lb){return new LL(La,Lb)},Lf.createFilterAction=function(La){return new Lg},Lf.createGraphics=function(){return new Lm},Lf.clear=function(La){LJ._context.ctx.clear()},Lf.cancelLoadByUrl=function(La){},Lf.clearAtlas=function(La){},Lf.isAtlas=function(La){return!1},Lf.addTextureToAtlas=function(La){},Lf.getTexturePixels=function(La,Lb,Lc,Ld,Le){return null},Lf.skinAniSprite=function(){return null},Lf.update3DLoop=function(){},Li(Lf,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Lf}(),Ld=(Lk(1,Lz,"alertGlobalError",null,function(La){var Lf=0;LO.window.onerror=La?function(La,Lb,Lc,Ld,Le){Lf++<5&&Le&&alert(Le.stack||Le)}:null}),Lz.init=function(La,Lb,Lc){for(var Ld=[],Le=2,Lf=arguments.length;Le<Lf;Le++)Ld.push(arguments[Le]);if(!Lz._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Lz._arrayBufferSlice),Lz._isinit=!0,LO.__init__(),LM.__init__(),Lm.__init__(),Lz.timer=new LY,Lz.scaleTimer=new LY,Lz.loader=new Lia,Lw.__init__(),Le=0;for(var Lg=Ld.length;Le<Lg;Le++)Ld[Le].enable&&Ld[Le].enable();return Lo.__init__(),Lh.__init__(),LN.__init__(),LQ.beginCheck(),Lz._currentStage=Lz.stage=new Lra,Lz.stage.conchModel&&Lz.stage.conchModel.setRootNode(),Lz._getUrlPath(),Lz.render=new LJ(0,0),Lz.stage.size(La,Lb),LL.__init__(),Ll.__init__(),Lp.instance.__init__(Lz.stage,LJ.canvas),Lva.__init__(),LE.autoStopMusic=!0,LC.__init__(),LJ.canvas}},Lz._getUrlPath=function(){var La=LO.window.location,Lb=La.pathname;Lb=Lb&&":"==Lb.charAt(2)?Lb.substring(1):Lb,LI.rootPath=LI.basePath=LI.getPath("file:"==La.protocol?Lb:La.protocol+"//"+La.host+La.pathname)},Lz._arrayBufferSlice=function(La,Lb){var Lc=new Uint8Array(this,La,Lb-La),Ld=new Uint8Array(Lc.length);return Ld.set(Lc),Ld.buffer},Lz._runScript=function(La){return LO.window[Lz._evcode](La)},Lz.stage=null,Lz.timer=null,Lz.scaleTimer=null,Lz.loader=null,Lz.version="1.8.6",Lz.render=null,Lz._currentStage=null,Lz._isinit=!1,Lz.isDebug=!1,Lz.MiniAdpter={init:function(){Ln.navigator&&Ln.navigator.userAgent&&-1<Ln.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Li(Lz,["conchMarket",function(){return this.conchMarket=Ln.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=Ln.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function La(){}return Lq(La,"Config"),La.WebGLTextCacheCount=500,La.atlasEnable=!1,La.showCanvasMark=!1,La.animationInterval=50,La.isAntialias=!1,La.isAlpha=!1,La.premultipliedAlpha=!0,La.isStencil=!0,La.preserveDrawingBuffer=!1,La}()),Lj=function(){function Lj(){this._events=null}Lq(Lj,"laya.events.EventDispatcher");var La=Lj.prototype;return La.hasListener=function(La){return!!(this._events&&this._events[La])},La.getListener=function(La){return this._events?this._events[La]:null},La.event=function(La,Lb){if(!this._events||!this._events[La])return!1;var Lc=this._events[La];if(Lc.lock)Lc.queue||(Lc.queue=[]),Lc.queue.push(Lb);else{var Ld;for(Lc.lock=!0,Lc.cursor=Lc.head;Lc.cursor;)(Ld=Lc.cursor).recover?(Lc.head=Lc.tail=Lc.cursor=null,console.error("node is recover："+Ld.id)):(Lc.cursor=Ld.next,Ld.once&&Lj.delNode(Lc,Ld),Ld.method&&(null!=Lb?Ld.args?Ld.method.apply(Ld.caller,Ld.args.concat(Lb)):Lb instanceof Array?Ld.method.apply(Ld.caller,Lb):Ld.caller?Ld.method.call(Ld.caller,Lb):Lz.recordError("事件派发错误","node.caller:"+Ld.caller+"node.method:"+Ld.method+"data:"+Lb+"node.prev"+Ld.prev):Ld.method.apply(Ld.caller,Ld.args)),Ld.once&&Lj.recoverHandler(Ld));Lc.lock=!1,!Lc.head&&this._events&&this._events[La]==Lc&&delete this._events[La],Lc.queue&&Lc.queue.length&&this.event(La,Lc.queue.shift())}return!0},La.on=function(La,Lb,Lc,Ld){return this._createListener(La,Lb,Lc,Ld,!1)},La.once=function(La,Lb,Lc,Ld){return this._createListener(La,Lb,Lc,Ld,!0)},La._createListener=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=!0),Lf&&this.off(La,Lb,Lc,Le);var Lg=Lj.createHandler(Lb||this,Lc,Ld,Le);this._events||(this._events={});var Lh=this._events,Li=Lh[La];return Li?Li.tail?(Lg.prev=Li.tail,Li.tail.next=Lg,Li.tail=Lg):Li.head=Li.tail=Lg:Lh[La]={head:Lg,tail:Lg,cursor:null,lock:!1},this},La.off=function(La,Lb,Lc,Ld){if(void 0===Ld&&(Ld=!1),!this._events||!this._events[La])return this;for(var Le=this._events[La],Lf=Le.head;Lf;){if((!Lb||Lf.caller===Lb)&&Lf.method===Lc&&(!Ld||Lf.once)){Lj.delNode(Le,Lf),Le.cursor==Lf&&(Le.cursor=Lf.next),Lj.recoverHandler(Lf);break}Lf=Lf.next}return this},La.offAll=function(La){var Lb=this._events;if(!Lb)return this;if(La)this._recoverHandlers(Lb[La]),delete Lb[La];else{for(var Lc in Lb)this._recoverHandlers(Lb[Lc]);this._events=null}return this},La._recoverHandlers=function(La){if(La){for(var Lb=La.head;Lb;){Lj.delNode(La,Lb);var Lc=Lb.next;Lj.recoverHandler(Lb),Lb=Lc}La.cursor=null}},La.isMouseEvent=function(La){return Lj.MOUSE_EVENTS[La]},Lj.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},Lj.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},Lj.delNode=function(La,Lb){Lb.prev?Lb.prev.next=Lb.next:La.head=Lb.next,Lb.next?Lb.next.prev=Lb.prev:La.tail=Lb.prev},Lj.createHandler=function(La,Lb,Lc,Ld){var Le=500<Lj._freeHandler.length?Lj._freeHandler.shift():null;if(Le)if(Le.recover)Le.recover=!1,Le.caller=La,Le.method=Lb,Le.args=Lc,Le.once=Ld;else{var Lf="";try{arguments.propertyIsEnumerable.caller}catch(La){Lf=La.stack}var Lg=Le.caller?(Le.caller.__proto__&&Le.caller.__proto__.constructor&&Le.caller.__proto__.constructor.name)+"|"+Le.caller.__className+"|"+Le.caller.name:"",Lh=Le.method?Le.method.name:"";Lz.recordError("EventDispatcher重复创建","caller="+Lg+"  method="+Lh+"  stack="+Lf),Le={id:++Lj._nodeCount,caller:La,method:Lb,args:Lc,once:Ld,recover:!1}}else Le={id:++Lj._nodeCount,caller:La,method:Lb,args:Lc,once:Ld,recover:!1};return Le.prev=Le.next=null,Le},Lj.recoverHandler=function(La){if(La.recover){if(Lj._errorCount<5){Lj._errorCount++;var Lb="";try{arguments.propertyIsEnumerable.caller}catch(La){Lb=La.stack}var Lc=La.caller?(La.caller.__proto__&&La.caller.__proto__.constructor&&La.caller.__proto__.constructor.name)+"|"+La.caller.__className+"|"+La.caller.name:"",Ld=La.method?La.method.name:"";Lz.recordError("EventDispatcher重复回收","id="+La.id+"  caller="+Lc+"  method="+Ld+"  stack="+Lb)}La.caller=La.method=La.args=La.prev=null}else La.recover=!0,La.caller=La.method=La.args=La.prev=La.next=null,Lj._freeHandler&&Lj._freeHandler.length<3e3&&Lj._freeHandler.push(La)},Lj._freeHandler=[],Lj._nodeCount=0,Lj._errorCount=0,Lj}(),Ls=function(){function Le(La,Lb,Lc,Ld){this.once=!1,void(this._id=0)===Ld&&(Ld=!1),this.setTo(La,Lb,Lc,Ld)}Lq(Le,"laya.utils.Handler");var La=Le.prototype;return La.setTo=function(La,Lb,Lc,Ld){return this._id=Le._gid++,this.caller=La,this.method=Lb,this.args=Lc,this.once=Ld,this},La.run=function(){if(null==this.method)return null;var La=this._id,Lb=this.method.apply(this.caller,this.args);return this._id===La&&this.once&&this.recover(),Lb},La.runWith=function(La){if(null==this.method)return null;var Lb=this._id;if(null==La)var Lc=this.method.apply(this.caller,this.args);else Lc=this.args||La.unshift?this.args?this.method.apply(this.caller,this.args.concat(La)):this.method.apply(this.caller,La):this.method.call(this.caller,La);return this._id===Lb&&this.once&&this.recover(),Lc},La.clear=function(){return this.caller=null,this.method=null,this.args=null,this},La.recover=function(){0<this._id&&(this._id=0,this.clear())},Le.create=function(La,Lb,Lc,Ld){return void 0===Ld&&(Ld=!0),new Le(La,Lb,Lc,Ld)},Le._gid=1,Le}(),LD=function(){function La(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Lq(La,"laya.display.BitmapFont");var Lb=La.prototype;return Lb.loadFont=function(La,Lb){this._path=La,this._complete=Lb,Lz.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Ls.create(this,this.onLoaded))},Lb.onLoaded=function(){this.parseFont(Lha.getRes(this._path),Lha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Lb.parseFont=function(La,Lb){if(null!=La&&null!=Lb){this._texture=Lb;var Lc=La.getElementsByTagName("info");if(!Lc[0].getAttributeNode)return this.parseFont2(La,Lb);this.fontSize=parseInt(Lc[0].getAttributeNode("size").nodeValue);var Ld,Le=Lc[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(Le[0]),parseInt(Le[1]),parseInt(Le[2]),parseInt(Le[3])],Ld=La.getElementsByTagName("char");var Lf=0;for(Lf=0;Lf<Ld.length;Lf++){var Lg=Ld[Lf],Lh=parseInt(Lg.getAttributeNode("id").nodeValue),Li=parseInt(Lg.getAttributeNode("xoffset").nodeValue)/1,Lj=parseInt(Lg.getAttributeNode("yoffset").nodeValue)/1,Lk=parseInt(Lg.getAttributeNode("xadvance").nodeValue)/1,Ll=new LB;Ll.x=parseInt(Lg.getAttributeNode("x").nodeValue),Ll.y=parseInt(Lg.getAttributeNode("y").nodeValue),Ll.width=parseInt(Lg.getAttributeNode("width").nodeValue),Ll.height=parseInt(Lg.getAttributeNode("height").nodeValue);var Lm=Lka.create(Lb,Ll.x,Ll.y,Ll.width,Ll.height,Li,Lj);this._maxWidth=Math.max(this._maxWidth,Lk+this.letterSpacing),this._fontCharDic[Lh]=Lm,this._fontWidthMap[Lh]=Lk}}},Lb.parseFont2=function(La,Lb){if(null!=La&&null!=Lb){this._texture=Lb;var Lc=La.getElementsByTagName("info");this.fontSize=parseInt(Lc[0].attributes.size.nodeValue);var Ld=Lc[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Ld[0]),parseInt(Ld[1]),parseInt(Ld[2]),parseInt(Ld[3])];var Le=La.getElementsByTagName("char"),Lf=0;for(Lf=0;Lf<Le.length;Lf++){var Lg=Le[Lf].attributes,Lh=parseInt(Lg.id.nodeValue),Li=parseInt(Lg.xoffset.nodeValue)/1,Lj=parseInt(Lg.yoffset.nodeValue)/1,Lk=parseInt(Lg.xadvance.nodeValue)/1,Ll=new LB;Ll.x=parseInt(Lg.x.nodeValue),Ll.y=parseInt(Lg.y.nodeValue),Ll.width=parseInt(Lg.width.nodeValue),Ll.height=parseInt(Lg.height.nodeValue);var Lm=Lka.create(Lb,Ll.x,Ll.y,Ll.width,Ll.height,Li,Lj);this._maxWidth=Math.max(this._maxWidth,Lk+this.letterSpacing),this._fontCharDic[Lh]=Lm,this._fontWidthMap[Lh]=Lk}}},Lb.getCharTexture=function(La){return this._fontCharDic[La.charCodeAt(0)]},Lb.destroy=function(){if(this._texture){for(var La in this._fontCharDic){var Lb=this._fontCharDic[La];Lb&&Lb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Lb.setSpaceWidth=function(La){this._spaceWidth=La},Lb.getCharWidth=function(La){var Lb=La.charCodeAt(0);return this._fontWidthMap[Lb]?this._fontWidthMap[Lb]+this.letterSpacing:" "==La?this._spaceWidth+this.letterSpacing:0},Lb.getTextWidth=function(La){for(var Lb=0,Lc=0,Ld=La.length;Lc<Ld;Lc++)Lb+=this.getCharWidth(La.charAt(Lc));return Lb},Lb.getMaxWidth=function(){return this._maxWidth},Lb.getMaxHeight=function(){return this.fontSize},Lb.drawText=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh=this.getTextWidth(La),Li=0;"center"===Le&&(Li=(Lf-Lh)/2),"right"===Le&&(Li=Lf-Lh);for(var Lj=0,Lk=0,Ll=La.length;Lk<Ll;Lk++)(Lg=this.getCharTexture(La.charAt(Lk)))&&(Lb.graphics.drawTexture(Lg,Lc+Lj+Li,Ld),Lj+=this.getCharWidth(La.charAt(Lk)))},La}(),Lh=function(){function Lc(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=Lc._TF_EMPTY}Lq(Lc,"laya.display.css.Style");var La=Lc.prototype;return La.getTransform=function(){return this._tf},La.setTransform=function(La){this._tf="none"!==La&&La?La:Lc._TF_EMPTY},La.setTranslateX=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.translateX=La},La.setTranslateY=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.translateY=La},La.setScaleX=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.scaleX=La},La.setScale=function(La,Lb){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.scaleX=La,this._tf.scaleY=Lb},La.setScaleY=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.scaleY=La},La.setRotate=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.rotate=La},La.setSkewX=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.skewX=La},La.setSkewY=function(La){this._tf===Lc._TF_EMPTY&&(this._tf=new Le),this._tf.skewY=La},La.destroy=function(){this.scrollRect=null},La.render=function(La,Lb,Lc,Ld){},La.getCSSStyle=function(){return Lba.EMPTY},La._enableLayout=function(){return!1},Lk(0,La,"scaleX",function(){return this._tf.scaleX},function(La){this.setScaleX(La)}),Lk(0,La,"transform",function(){return this.getTransform()},function(La){this.setTransform(La)}),Lk(0,La,"translateX",function(){return this._tf.translateX},function(La){this.setTranslateX(La)}),Lk(0,La,"translateY",function(){return this._tf.translateY},function(La){this.setTranslateY(La)}),Lk(0,La,"scaleY",function(){return this._tf.scaleY},function(La){this.setScaleY(La)}),Lk(0,La,"block",function(){return 0!=(1&this._type)}),Lk(0,La,"skewY",function(){return this._tf.skewY},function(La){this.setSkewY(La)}),Lk(0,La,"rotate",function(){return this._tf.rotate},function(La){this.setRotate(La)}),Lk(0,La,"skewX",function(){return this._tf.skewX},function(La){this.setSkewX(La)}),Lk(0,La,"paddingLeft",function(){return 0}),Lk(0,La,"paddingTop",function(){return 0}),Lk(0,La,"absolute",function(){return!0}),Lc.__init__=function(){Lc._TF_EMPTY=new Le,Lc.EMPTY=new Lc},Lc.EMPTY=null,Lc._TF_EMPTY=null,Lc}(),Lo=function(){function Lb(La){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=LS.create(Lb.defaultColor),this.family=Lb.defaultFamily,this.stroke=Lb._STROKE,this.size=Lb.defaultSize,La&&La!==Lb.EMPTY&&La.copyTo(this)}Lq(Lb,"laya.display.css.Font");var La=Lb.prototype;return La.set=function(La){this._text=null;for(var Lb=La.split(" "),Lc=0,Ld=Lb.length;Lc<Ld;Lc++){var Le=Lb[Lc];switch(Le){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<Le.indexOf("px")&&(this.size=parseInt(Le),this.family=Lb[Lc+1],Lc++)}},La.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},La.copyTo=function(La){La._type=this._type,La._text=this._text,La._weight=this._weight,La._color=this._color,La.family=this.family,La.stroke=this.stroke!=Lb._STROKE?this.stroke.slice():Lb._STROKE,La.indent=this.indent,La.size=this.size},Lk(0,La,"password",function(){return 0!=(1024&this._type)},function(La){La?this._type|=1024:this._type&=-1025}),Lk(0,La,"color",function(){return this._color.strColor},function(La){this._color=LS.create(La)}),Lk(0,La,"italic",function(){return 0!=(512&this._type)},function(La){La?this._type|=512:this._type&=-513}),Lk(0,La,"bold",function(){return 0!=(2048&this._type)},function(La){La?this._type|=2048:this._type&=-2049}),Lk(0,La,"weight",function(){return""+this._weight},function(La){var Lb=0;switch(La){case"normal":break;case"bold":this.bold=!0,Lb=700;break;case"bolder":Lb=800;break;case"lighter":Lb=100;break;default:Lb=parseInt(La)}this._weight=Lb,this._text=null}),Lk(0,La,"decoration",function(){return this._decoration?this._decoration.value:null},function(La){var Lb=La.split(" ");switch(this._decoration||(this._decoration={}),Lb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Lb[0]}Lb[1]&&(this._decoration.color=LS.create(Lb)),this._decoration.value=La}),Lb.__init__=function(){Lb.EMPTY=new Lb(null)},Lb.EMPTY=null,Lb.defaultColor="#000000",Lb.defaultSize=12,Lb.defaultFamily="Arial",Lb.defaultFont="12px Arial",Lb._STROKE=[0,"#000000"],Lb._ITALIC=512,Lb._PASSWORD=1024,Lb._BOLD=2048,Lb}(),Le=function(){function La(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Lq(La,"laya.display.css.TransformInfo"),La}(),Lm=function(){function Ll(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,LJ.isConchNode){this._nativeObj=new Ln._conchGraphics,this.id=this._nativeObj.conchID}}Lq(Ll,"laya.display.Graphics");var La=Ll.prototype;return La.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},La.clear=function(La){void 0===La&&(La=!1);var Lb=0,Lc=0;if(La){var Ld=this._one;if(this._cmds){for(Lc=this._cmds.length,Lb=0;Lb<Lc;Lb++)!(Ld=this._cmds[Lb])||Ld.callee!==LJ._context._drawTexture&&Ld.callee!==LJ._context._drawTextureWithTransform||(Ld[0]=null,Ll._cache.push(Ld));this._cmds.length=0}else Ld&&(!Ld||Ld.callee!==LJ._context._drawTexture&&Ld.callee!==LJ._context._drawTextureWithTransform||(Ld[0]=null,Ll._cache.push(Ld)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Lb=0,Lc=this._vectorgraphArray.length;Lb<Lc;Lb++)L_.getInstance().deleteShape(this._vectorgraphArray[Lb]);this._vectorgraphArray.length=0}},La._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},La._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new Lc,this._graphicBounds._graphics=this)},La._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},La._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},La.getBounds=function(La){return void 0===La&&(La=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(La)},La.getBoundPoints=function(La){return void 0===La&&(La=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(La)},La._addCmd=function(La){this._cmds=this._cmds||[],La.callee=La.shift(),this._cmds.push(La)},La.setFilters=function(La){this._saveToCmd(LJ._context._setFilters,La)},La.drawTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lg&&(Lg=1),!La||Lg<.01)return null;Ld||(Ld=La.sourceWidth),Le||(Le=La.sourceHeight),Lg=Lg<0?0:1<Lg?1:Lg;var Lh,Li=!LJ.isWebGL&&(LO.onFirefox||LO.onEdge||LO.onIE||LO.onSafari)?.5:0,Lj=Ld/La.sourceWidth,Lk=Le/La.sourceHeight;return Ld=La.width*Lj,Le=La.height*Lk,La.loaded&&(Ld<=0||Le<=0)?null:(Lb+=La.offsetX*Lj,Lc+=La.offsetY*Lk,this._sp&&(this._sp._renderType|=512),Lb-=Li,Lc-=Li,Ld+=2*Li,Le+=2*Li,Ll._cache.length?((Lh=Ll._cache.pop())[0]=La,Lh[1]=Lb,Lh[2]=Lc,Lh[3]=Ld,Lh[4]=Le,Lh[5]=Lf,Lh[6]=Lg):Lh=[La,Lb,Lc,Ld,Le,Lf,Lg],Lh.callee=Lf||1!=Lg?LJ._context._drawTextureWithTransform:LJ._context._drawTexture,null!=this._one||Lf||1!=Lg?this._saveToCmd(Lh.callee,Lh):(this._one=Lh,this._render=this._renderOneImg),La.loaded||La.once("loaded",this,this._textureLoaded,[La,Lh]),this._repaint(),Lh)},La.cleanByTexture=function(La,Lb,Lc,Ld,Le){if(void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),!La)return this.clear();if(this._one&&this._render===this._renderOneImg){Ld||(Ld=La.sourceWidth),Le||(Le=La.sourceHeight);var Lf=Ld/La.sourceWidth,Lg=Le/La.sourceHeight;Ld=La.width*Lf,Le=La.height*Lg,Lb+=La.offsetX*Lf,Lc+=La.offsetY*Lg,this._one[0]=La,this._one[1]=Lb,this._one[2]=Lc,this._one[3]=Ld,this._one[4]=Le,this._repaint()}else this.clear(),La&&this.drawTexture(La,Lb,Lc,Ld,Le)},La.drawTextures=function(La,Lb){La&&this._saveToCmd(LJ._context._drawTextures,[La,Lb])},La.fillTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lf&&(Lf="repeat"),La){var Lh=[La,Lb,Lc,Ld,Le,Lf,Lg||LA.EMPTY,{}];La.loaded||La.once("loaded",this,this._textureLoaded,[La,Lh]),this._saveToCmd(LJ._context._fillTexture,Lh)}},La._textureLoaded=function(La,Lb){Lb[3]=Lb[3]||La.width,Lb[4]=Lb[4]||La.height,this._repaint()},La.fillCircle=function(La,Lb,Lc,Ld,Le,Lf,Lg){Lc.bitmap.enableMerageInAtlas=!1;var Lh=new Float32Array(2*(Lg+1)),Li=new Float32Array(2*(Lg+1)),Lj=new Uint16Array(3*Lg),Lk=2*Math.PI/Lg,Ll=0;Lh[0]=Ld,Lh[1]=Le,Li[0]=Ld/Lc.width,Li[1]=Le/Lc.height;for(var Lm=2,Ln=0;Ln<Lg;Ln++){var Lo=Lf*Math.cos(Ll)+Ld,Lp=Lf*Math.sin(Ll)+Le;Lh[Lm]=Lo,Lh[Lm+1]=Lp,Li[Lm]=Lo/Lc.width,Li[Lm+1]=Lp/Lc.height,Ll+=Lk,Lm+=2}for(Ln=Lm=0;Ln<Lg;Ln++)Lj[Lm++]=0,Lj[Lm++]=Ln+1,Lj[Lm++]=Lg+1<=Ln+2?1:Ln+2;this.drawTriangles(Lc,La,Lb,Lh,Li,Lj)},La.drawTriangles=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){void 0===Lh&&(Lh=1),this._saveToCmd(LJ._context.drawTriangles,[La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj])},La._saveToCmd=function(La,Lb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Lb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Lb)),Lb.callee=La,this._repaint(),Lb},La.clipRect=function(La,Lb,Lc,Ld){this._saveToCmd(LJ._context._clipRect,[La,Lb,Lc,Ld])},La.fillText=function(La,Lb,Lc,Ld,Le,Lf,Lg){void 0===Lg&&(Lg=0),this._saveToCmd(LJ._context._fillText,[La,Lb,Lc,Ld||Lo.defaultFont,Le,Lf])},La.fillBorderText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){this._saveToCmd(LJ._context._fillBorderText,[La,Lb,Lc,Ld||Lo.defaultFont,Le,Lf,Lg,Lh])},La.strokeText=function(La,Lb,Lc,Ld,Le,Lf,Lg){this._saveToCmd(LJ._context._strokeText,[La,Lb,Lc,Ld||Lo.defaultFont,Le,Lf,Lg])},La.alpha=function(La){La=La<0?0:1<La?1:La,this._saveToCmd(LJ._context._alpha,[La])},La.setAlpha=function(La){La=La<0?0:1<La?1:La,this._saveToCmd(LJ._context._setAlpha,[La])},La.transform=function(La,Lb,Lc){void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),this._saveToCmd(LJ._context._transform,[La,Lb,Lc])},La.rotate=function(La,Lb,Lc){void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),this._saveToCmd(LJ._context._rotate,[La,Lb,Lc])},La.scale=function(La,Lb,Lc,Ld){void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),this._saveToCmd(LJ._context._scale,[La,Lb,Lc,Ld])},La.translate=function(La,Lb){this._saveToCmd(LJ._context._translate,[La,Lb])},La.save=function(){this._saveToCmd(LJ._context._save,[])},La.restore=function(){this._saveToCmd(LJ._context._restore,[])},La.replaceText=function(La){this._repaint();var Lb=this._cmds;if(Lb){for(var Lc=Lb.length-1;-1<Lc;Lc--)if(this._isTextCmd(Lb[Lc].callee))return Lb[Lc][0].toUpperCase?Lb[Lc][0]=La:Lb[Lc][0].setText(La),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=La:this._one[0].setText(La),!0;return!1},La._isTextCmd=function(La){return La===LJ._context._fillText||La===LJ._context._fillBorderText||La===LJ._context._strokeText},La.replaceTextColor=function(La){this._repaint();var Lb=this._cmds;if(Lb)for(var Lc=Lb.length-1;-1<Lc;Lc--)this._isTextCmd(Lb[Lc].callee)&&(Lb[Lc][4]=La,Lb[Lc][0].toUpperCase||(Lb[Lc][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=La,this._one[0].toUpperCase||(this._one[0].changed=!0))},La.loadImage=function(La,Lb,Lc,Ld,Le,Lf){var Lg=this;void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0);var Lh=Lha.getRes(La);function Li(La){La&&(Lg.drawTexture(La,Lb,Lc,Ld,Le),null!=Lf&&Lf.call(Lg._sp,La))}Lh?Li(Lh):Lz.loader.load(La,Ls.create(null,Li),null,"image")},La._renderEmpty=function(La,Lb,Lc,Ld){},La._renderAll=function(La,Lb,Lc,Ld){for(var Le,Lf=this._cmds,Lg=0,Lh=Lf.length;Lg<Lh;Lg++)(Le=Lf[Lg]).callee.call(Lb,Lc,Ld,Le)},La._renderOne=function(La,Lb,Lc,Ld){this._one.callee.call(Lb,Lc,Ld,this._one)},La._renderOneImg=function(La,Lb,Lc,Ld){this._one.callee.call(Lb,Lc,Ld,this._one),2305!==La._renderType&&(La._renderType|=1)},La.drawLine=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=1);var Lg=0;LJ.isWebGL&&(Lg=L_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Lg));var Lh=Lf%2==0?0:.5,Li=[La+Lh,Lb+Lh,Lc+Lh,Ld+Lh,Le,Lf,Lg];this._saveToCmd(LJ._context._drawLine,Li)},La.drawLines=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=1);var Lf=0;if(Lc&&!(Lc.length<4)){LJ.isWebGL&&(Lf=L_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Lf));var Lg=Le%2==0?0:.5,Lh=[La+Lg,Lb+Lg,Lc,Ld,Le,Lf];this._saveToCmd(LJ._context._drawLines,Lh)}},La.drawCurves=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=1);var Lf=[La,Lb,Lc,Ld,Le];this._saveToCmd(LJ._context._drawCurves,Lf)},La.drawRect=function(La,Lb,Lc,Ld,Le,Lf,Lg){void 0===Lg&&(Lg=1);var Lh=Lf?Lg/2:0,Li=Lf?Lg:0,Lj=[La+Lh,Lb+Lh,Lc-Li,Ld-Li,Le,Lf,Lg];this._saveToCmd(LJ._context._drawRect,Lj)},La.drawCircle=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=1);var Lg=Le?Lf/2:0,Lh=0;LJ.isWebGL&&(Lh=L_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Lh));var Li=[La,Lb,Lc-Lg,Ld,Le,Lf,Lh];this._saveToCmd(LJ._context._drawCircle,Li)},La.drawPie=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){void 0===Lh&&(Lh=1);var Li=Lg?Lh/2:0,Lj=Lg?Lh:0,Lk=0;LJ.isWebGL&&(Lk=L_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Lk));var Ll=[La+Li,Lb+Li,Lc-Lj,Ld,Le,Lf,Lg,Lh,Lk];Ll[3]=L$.toRadian(Ld),Ll[4]=L$.toRadian(Le),this._saveToCmd(LJ._context._drawPie,Ll)},La.drawPoly=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=1);var Lg=0,Lh=!1;LJ.isWebGL&&(Lg=L_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Lg),Lh=!(6<Lc.length));var Li=Le?Lf%2==0?0:.5:0,Lj=[La+Li,Lb+Li,Lc,Ld,Le,Lf,Lg,Lh];this._saveToCmd(LJ._context._drawPoly,Lj)},La.drawPath=function(La,Lb,Lc,Ld,Le){var Lf=[La,Lb,Lc,Ld,Le];this._saveToCmd(LJ._context._drawPath,Lf)},Lk(0,La,"cmds",function(){return this._cmds},function(La){this._sp&&(this._sp._renderType|=512),this._cmds=La,this._render=this._renderAll,this._repaint()}),Ll.__init__=function(){if(LJ.isConchNode){for(var La=laya.display.Graphics.prototype,Lb=LO.window.ConchGraphics.prototype,Lc=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Ld=0,Le=Lc.length;Ld<=Le;Ld++){var Lf=Lc[Ld];La[Lf]=Lb[Lf]}La._saveToCmd=null,Lb.drawImageS&&(La.drawTextures=function(La,Lb){if(La&&La.loaded&&La.bitmap&&La.source){var Lc=La.uv,Ld=La.bitmap.width,Le=La.bitmap.height;this.drawImageS(La.bitmap.source,Lc[0]*Ld,Lc[1]*Le,(Lc[2]-Lc[0])*Ld,(Lc[5]-Lc[3])*Le,La.offsetX,La.offsetY,La.width,La.height,Lb)}}),La.drawTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lg&&(Lg=1),La)if(La.loaded){if(La.loaded&&La.bitmap&&La.source&&(Ld||(Ld=La.sourceWidth),Le||(Le=La.sourceHeight),Lg=Lg<0?0:1<Lg?1:Lg,Ld=Ld-La.sourceWidth+La.width,Le=Le-La.sourceHeight+La.height,!(Ld<=0||Le<=0))){Lb+=La.offsetX,Lc+=La.offsetY;var Lh=La.uv,Li=La.bitmap.width,Lj=La.bitmap.height;Lh[4]<Lh[0]&&Lh[5]<Lh[1]?this.drawImageM(La.bitmap.source,Lh[4]*Li,Lh[5]*Lj,(Lh[0]-Lh[4])*Li,(Lh[1]-Lh[5])*Lj,Lb,Lc,Ld,Le,Lf,Lg):this.drawImageM(La.bitmap.source,Lh[0]*Li,Lh[1]*Lj,(Lh[2]-Lh[0])*Li,(Lh[5]-Lh[3])*Lj,Lb,Lc,Ld,Le,Lf,Lg),this._repaint()}}else La.once("loaded",this,function(){this.drawTexture(La,Lb,Lc,Ld,Le,Lf)})},La.fillTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lf&&(Lf="repeat"),La&&La.loaded){var Lh,Li=LJ._context.ctx,Lj=La.bitmap.width,Lk=La.bitmap.height,Ll=La.uv;Lh=La.uv!=Lka.DEF_UV?Li.createPattern(La.bitmap.source,Lf,Ll[0]*Lj,Ll[1]*Lk,(Ll[2]-Ll[0])*Lj,(Ll[5]-Ll[3])*Lk):Li.createPattern(La.bitmap.source,Lf);var Lm=0,Ln=0;Lg&&(Lb+=Lg.x%La.width,Lc+=Lg.y%La.height,Lm-=Lg.x%La.width,Ln-=Lg.y%La.height),this._fillImage(Lh,Lb,Lc,Lm,Ln,Ld,Le)}}}},Ll._cache=[],Ll}(),Lc=function(){function Lt(){this._cacheBoundsType=!1}Lq(Lt,"laya.display.GraphicsBounds");var La=Lt.prototype;return La.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},La.reset=function(){this._temp&&(this._temp.length=0)},La.getBounds=function(La){return void 0===La&&(La=!1),(!this._bounds||!this._temp||this._temp.length<1||La!=this._cacheBoundsType)&&(this._bounds=LB._getWrapRec(this.getBoundPoints(La),this._bounds)),this._cacheBoundsType=La,this._bounds},La.getBoundPoints=function(La){return void 0===La&&(La=!1),(!this._temp||this._temp.length<1||La!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(La)),this._cacheBoundsType=La,this._rstBoundPoints=L$.copyArray(this._rstBoundPoints,this._temp)},La._getCmdPoints=function(La){void 0===La&&(La=!1);var Lb,Lc,Ld=LJ._context,Le=this._graphics.cmds;if((Lb=this._temp||(this._temp=[])).length=0,Le||null==this._graphics._one||(Lt._tempCmds.length=0,Lt._tempCmds.push(this._graphics._one),Le=Lt._tempCmds),!Le)return Lb;(Lc=Lt._tempMatrixArrays).length=0;var Lf=Lt._initMatrix;Lf.identity();for(var Lg,Lh,Li=Lt._tempMatrix,Lj=NaN,Lk=NaN,Ll=NaN,Lm=NaN,Ln=NaN,Lo=NaN,Lp=0,Lq=Le.length;Lp<Lq;Lp++)if((Lg=Le[Lp]).callee)switch(Lg.callee){case Ld._save:case 7:Lc.push(Lf),Lf=Lf.clone();break;case Ld._restore:case 8:Lf=Lc.pop();break;case Ld._scale:case 5:Li.identity(),Li.translate(-Lg[2],-Lg[3]),Li.scale(Lg[0],Lg[1]),Li.translate(Lg[2],Lg[3]),this._switchMatrix(Lf,Li);break;case Ld._rotate:case 3:Li.identity(),Li.translate(-Lg[1],-Lg[2]),Li.rotate(Lg[0]),Li.translate(Lg[1],Lg[2]),this._switchMatrix(Lf,Li);break;case Ld._translate:case 6:Li.identity(),Li.translate(Lg[0],Lg[1]),this._switchMatrix(Lf,Li);break;case Ld._transform:case 4:Li.identity(),Li.translate(-Lg[1],-Lg[2]),Li.concat(Lg[0]),Li.translate(Lg[1],Lg[2]),this._switchMatrix(Lf,Li);break;case 16:case 24:Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[0],Lg[1],Lg[2],Lg[3]),Lf);break;case 17:Lf.copyTo(Li),Li.concat(Lg[4]),Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[0],Lg[1],Lg[2],Lg[3]),Li);break;case Ld._drawTexture:Lh=Lg[0],La?Lg[3]&&Lg[4]?Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lg[3],Lg[4]),Lf):(Lh=Lg[0],Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lh.width,Lh.height),Lf)):(Lj=(Lg[3]||Lh.sourceWidth)/Lh.width,Lk=(Lg[4]||Lh.sourceHeight)/Lh.height,Ll=Lj*Lh.sourceWidth,Lm=Lk*Lh.sourceHeight,Ln=0<Lh.offsetX?Lh.offsetX:0,Lo=0<Lh.offsetY?Lh.offsetY:0,Ln*=Lj,Lo*=Lk,Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1]-Ln,Lg[2]-Lo,Ll,Lm),Lf));break;case Ld._fillTexture:Lg[3]&&Lg[4]?Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lg[3],Lg[4]),Lf):(Lh=Lg[0],Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lh.width,Lh.height),Lf));break;case Ld._drawTextureWithTransform:var Lr;Lr=Lg[5]?(Lf.copyTo(Li),Li.concat(Lg[5]),Li):Lf,La?Lg[3]&&Lg[4]?Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lg[3],Lg[4]),Lr):(Lh=Lg[0],Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1],Lg[2],Lh.width,Lh.height),Lr)):(Lh=Lg[0],Lj=(Lg[3]||Lh.sourceWidth)/Lh.width,Lk=(Lg[4]||Lh.sourceHeight)/Lh.height,Ll=Lj*Lh.sourceWidth,Lm=Lk*Lh.sourceHeight,Ln=0<Lh.offsetX?Lh.offsetX:0,Lo=0<Lh.offsetY?Lh.offsetY:0,Ln*=Lj,Lo*=Lk,Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[1]-Ln,Lg[2]-Lo,Ll,Lm),Lr));break;case Ld._drawRect:case 13:Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[0],Lg[1],Lg[2],Lg[3]),Lf);break;case Ld._drawCircle:case Ld._fillCircle:case 14:Lt._addPointArrToRst(Lb,LB._getBoundPointS(Lg[0]-Lg[2],Lg[1]-Lg[2],Lg[2]+Lg[2],Lg[2]+Lg[2]),Lf);break;case Ld._drawLine:case 20:Lt._tempPoints.length=0;var Ls;Ls=.5*Lg[5],Lg[0]==Lg[2]?Lt._tempPoints.push(Lg[0]+Ls,Lg[1],Lg[2]+Ls,Lg[3],Lg[0]-Ls,Lg[1],Lg[2]-Ls,Lg[3]):Lg[1]==Lg[3]?Lt._tempPoints.push(Lg[0],Lg[1]+Ls,Lg[2],Lg[3]+Ls,Lg[0],Lg[1]-Ls,Lg[2],Lg[3]-Ls):Lt._tempPoints.push(Lg[0],Lg[1],Lg[2],Lg[3]),Lt._addPointArrToRst(Lb,Lt._tempPoints,Lf);break;case Ld._drawCurves:case 22:Lt._addPointArrToRst(Lb,Lu.I.getBezierPoints(Lg[2]),Lf,Lg[0],Lg[1]);break;case Ld._drawPoly:case Ld._drawLines:case 18:Lt._addPointArrToRst(Lb,Lg[2],Lf,Lg[0],Lg[1]);break;case Ld._drawPath:case 19:Lt._addPointArrToRst(Lb,this._getPathPoints(Lg[2]),Lf,Lg[0],Lg[1]);break;case Ld._drawPie:case 15:Lt._addPointArrToRst(Lb,this._getPiePoints(Lg[0],Lg[1],Lg[2],Lg[3],Lg[4]),Lf)}return 200<Lb.length?Lb=L$.copyArray(Lb,LB._getWrapRec(Lb)._getBoundPoints()):8<Lb.length&&(Lb=Lv.scanPList(Lb)),Lb},La._switchMatrix=function(La,Lb){Lb.concat(La),Lb.copyTo(La)},La._getPiePoints=function(La,Lb,Lc,Ld,Le){var Lf=Lt._tempPoints;Lt._tempPoints.length=0,Lf.push(La,Lb);var Lg=(Le-Ld)%(2*Math.PI)/10,Lh=NaN,Li=Ld;for(Lh=0;Lh<=10;Lh++)Lf.push(La+Lc*Math.cos(Li),Lb+Lc*Math.sin(Li)),Li+=Lg;return Lf},La._getPathPoints=function(La){var Lb,Lc,Ld=0,Le=Lt._tempPoints;for(Le.length=0,Lb=La.length,Ld=0;Ld<Lb;Ld++)1<(Lc=La[Ld]).length&&(Le.push(Lc[1],Lc[2]),3<Lc.length&&Le.push(Lc[3],Lc[4]));return Le},Lt._addPointArrToRst=function(La,Lb,Lc,Ld,Le){void 0===Ld&&(Ld=0),void 0===Le&&(Le=0);var Lf,Lg=0;for(Lf=Lb.length,Lg=0;Lg<Lf;Lg+=2)Lt._addPointToRst(La,Lb[Lg]+Ld,Lb[Lg+1]+Le,Lc)},Lt._addPointToRst=function(La,Lb,Lc,Ld){var Le=LA.TEMP;Le.setTo(Lb||0,Lc||0),Ld.transformPoint(Le),La.push(Le.x,Le.y)},Lt._tempPoints=[],Lt._tempMatrixArrays=[],Lt._tempCmds=[],Li(Lt,["_tempMatrix",function(){return this._tempMatrix=new LG},"_initMatrix",function(){return this._initMatrix=new LG}]),Lt}(),Lf=function(){function La(){}Lq(La,"laya.events.Event");var Lb=La.prototype;return Lb.setTo=function(La,Lb,Lc){return this.type=La,this.currentTarget=Lb,this.target=Lc,this},Lb.stopPropagation=function(){this._stoped=!0},Lk(0,Lb,"stageY",function(){return Lz.stage.mouseY}),Lk(0,Lb,"charCode",function(){return this.nativeEvent.charCode}),Lk(0,Lb,"touches",function(){var La=this.nativeEvent.touches;if(La)for(var Lb=Lz.stage,Lc=0,Ld=La.length;Lc<Ld;Lc++){var Le=La[Lc],Lf=LA.TEMP;Lf.setTo(Le.clientX,Le.clientY),Lb._canvasTransform.invertTransformPoint(Lf),Lb.transform.invertTransformPoint(Lf),Le.stageX=Lf.x,Le.stageY=Lf.y}return La}),Lk(0,Lb,"keyLocation",function(){return this.nativeEvent.keyLocation}),Lk(0,Lb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),Lk(0,Lb,"altKey",function(){return this.nativeEvent.altKey}),Lk(0,Lb,"shiftKey",function(){return this.nativeEvent.shiftKey}),Lk(0,Lb,"stageX",function(){return Lz.stage.mouseX}),La.EMPTY=new La,La.MOUSE_DOWN="mousedown",La.MOUSE_UP="mouseup",La.CLICK="click",La.RIGHT_MOUSE_DOWN="rightmousedown",La.RIGHT_MOUSE_UP="rightmouseup",La.RIGHT_CLICK="rightclick",La.MOUSE_MOVE="mousemove",La.MOUSE_OVER="mouseover",La.MOUSE_OUT="mouseout",La.MOUSE_WHEEL="mousewheel",La.ROLL_OVER="mouseover",La.ROLL_OUT="mouseout",La.DOUBLE_CLICK="doubleclick",La.CHANGE="change",La.CHANGED="changed",La.RESIZE="resize",La.ADDED="added",La.REMOVED="removed",La.DISPLAY="display",La.UNDISPLAY="undisplay",La.ERROR="error",La.COMPLETE="complete",La.LOADED="loaded",La.INITED="inited",La.PROGRESS="progress",La.INPUT="input",La.RENDER="render",La.OPEN="open",La.MESSAGE="message",La.CLOSE="close",La.KEY_DOWN="keydown",La.KEY_PRESS="keypress",La.KEY_UP="keyup",La.FRAME="enterframe",La.DRAG_START="dragstart",La.DRAG_MOVE="dragmove",La.DRAG_END="dragend",La.ENTER="enter",La.SELECT="select",La.BLUR="blur",La.FOCUS="focus",La.VISIBILITY_CHANGE="visibilitychange",La.FOCUS_CHANGE="focuschange",La.PLAYED="played",La.PAUSED="paused",La.STOPPED="stopped",La.START="start",La.END="end",La.ENABLE_CHANGED="enablechanged",La.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",La.COMPONENT_ADDED="componentadded",La.COMPONENT_REMOVED="componentremoved",La.LAYER_CHANGED="layerchanged",La.HIERARCHY_LOADED="hierarchyloaded",La.RECOVERED="recovered",La.RELEASED="released",La.LINK="link",La.LABEL="label",La.FULL_SCREEN_CHANGE="fullscreenchange",La.DEVICE_LOST="devicelost",La.MESH_CHANGED="meshchanged",La.MATERIAL_CHANGED="materialchanged",La.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",La.ANIMATION_CHANGED="animationchanged",La.TRIGGER_ENTER="triggerenter",La.TRIGGER_STAY="triggerstay",La.TRIGGER_EXIT="triggerexit",La.TRAIL_FILTER_CHANGE="trailfilterchange",La.DOMINO_FILTER_CHANGE="dominofilterchange",La}(),Ll=(function(){function La(){}Lq(La,"laya.events.Keyboard"),La.NUMBER_0=48,La.NUMBER_1=49,La.NUMBER_2=50,La.NUMBER_3=51,La.NUMBER_4=52,La.NUMBER_5=53,La.NUMBER_6=54,La.NUMBER_7=55,La.NUMBER_8=56,La.NUMBER_9=57,La.A=65,La.B=66,La.C=67,La.D=68,La.E=69,La.F=70,La.G=71,La.H=72,La.I=73,La.J=74,La.K=75,La.L=76,La.M=77,La.N=78,La.O=79,La.P=80,La.Q=81,La.R=82,La.S=83,La.T=84,La.U=85,La.V=86,La.W=87,La.X=88,La.Y=89,La.Z=90,La.F1=112,La.F2=113,La.F3=114,La.F4=115,La.F5=116,La.F6=117,La.F7=118,La.F8=119,La.F9=120,La.F10=121,La.F11=122,La.F12=123,La.F13=124,La.F14=125,La.F15=126,La.NUMPAD=21,La.NUMPAD_0=96,La.NUMPAD_1=97,La.NUMPAD_2=98,La.NUMPAD_3=99,La.NUMPAD_4=100,La.NUMPAD_5=101,La.NUMPAD_6=102,La.NUMPAD_7=103,La.NUMPAD_8=104,La.NUMPAD_9=105,La.NUMPAD_ADD=107,La.NUMPAD_DECIMAL=110,La.NUMPAD_DIVIDE=111,La.NUMPAD_ENTER=108,La.NUMPAD_MULTIPLY=106,La.NUMPAD_SUBTRACT=109,La.SEMICOLON=186,La.EQUAL=187,La.COMMA=188,La.MINUS=189,La.PERIOD=190,La.SLASH=191,La.BACKQUOTE=192,La.LEFTBRACKET=219,La.BACKSLASH=220,La.RIGHTBRACKET=221,La.QUOTE=222,La.ALTERNATE=18,La.BACKSPACE=8,La.CAPS_LOCK=20,La.COMMAND=15,La.CONTROL=17,La.DELETE=46,La.ENTER=13,La.ESCAPE=27,La.PAGE_UP=33,La.PAGE_DOWN=34,La.END=35,La.HOME=36,La.LEFT=37,La.UP=38,La.RIGHT=39,La.DOWN=40,La.SHIFT=16,La.SPACE=32,La.TAB=9,La.INSERT=45}(),function(){function Le(){}return Lq(Le,"laya.events.KeyBoardManager"),Le.__init__=function(){Le._addEvent("keydown"),Le._addEvent("keypress"),Le._addEvent("keyup")},Le._addEvent=function(Lb){LO.document.addEventListener(Lb,function(La){laya.events.KeyBoardManager._dispatch(La,Lb)},!0)},Le._dispatch=function(La,Lb){if(Le.enabled){Le._event._stoped=!1,Le._event.nativeEvent=La,Le._event.keyCode=La.keyCode||La.which||La.charCode,"keydown"===Lb?Le._pressKeys[Le._event.keyCode]=!0:"keyup"===Lb&&(Le._pressKeys[Le._event.keyCode]=null);for(var Lc=Lz.stage.focus&&null!=Lz.stage.focus.event&&Lz.stage.focus.displayedInStage?Lz.stage.focus:Lz.stage,Ld=Lc;Ld;)Ld.event(Lb,Le._event.setTo(Lb,Ld,Lc)),Ld=Ld.parent}},Le.hasKeyDown=function(La){return Le._pressKeys[La]},Le._pressKeys={},Le.enabled=!0,Li(Le,["_event",function(){return this._event=new Lf}]),Le}()),Lp=(function(){function La(){}Lq(La,"laya.events.KeyLocation"),La.STANDARD=0,La.LEFT=1,La.RIGHT=2,La.NUM_PAD=3}(),function(){function Lk(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=LO.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Lf,this._matrix=new LG,this._point=new LA,this._rect=new LB,this._prePoint=new LA,this._curTouchID=NaN}Lq(Lk,"laya.events.MouseManager");var La=Lk.prototype;return La.__init__=function(La,Lb){var Lc=this;this._stage=La;var Ld=this,Le=this._eventList;Lb.oncontextmenu=function(La){if(Lk.enabled)return!1},Lb.addEventListener("mousedown",function(La){Lk.enabled&&(LO.onIE||La.preventDefault(),Le.push(La),Ld.mouseDownTime=LO.now())}),Lb.addEventListener("mouseup",function(La){Lk.enabled&&(La.preventDefault(),Le.push(La),Ld.mouseDownTime=-LO.now())},!0),Lb.addEventListener("mousemove",function(La){if(Lk.enabled){La.preventDefault();var Lb=LO.now();if(Lb-Ld._lastMoveTimer<10)return;Ld._lastMoveTimer=Lb,Le.push(La)}},!0),Lb.addEventListener("mouseout",function(La){Lk.enabled&&Le.push(La)}),Lb.addEventListener("mouseover",function(La){Lk.enabled&&Le.push(La)}),Lb.addEventListener("touchstart",function(La){Lk.enabled&&(Le.push(La),Lk._isFirstTouch||Lva.isInputting||La.preventDefault(),Ld.mouseDownTime=LO.now())}),Lb.addEventListener("touchend",function(La){Lk.enabled?(Lk._isFirstTouch||Lva.isInputting||La.preventDefault(),Lk._isFirstTouch=!1,Le.push(La),Ld.mouseDownTime=-LO.now()):Lc._curTouchID=NaN},!0),Lb.addEventListener("touchmove",function(La){Lk.enabled&&(La.preventDefault(),Le.push(La))},!0),Lb.addEventListener("touchcancel",function(La){Lk.enabled?(La.preventDefault(),Le.push(La)):Lc._curTouchID=NaN},!0),Lb.addEventListener("mousewheel",function(La){Lk.enabled&&Le.push(La)}),Lb.addEventListener("DOMMouseScroll",function(La){Lk.enabled&&Le.push(La)})},La.initEvent=function(La,Lb){var Lc;this._event._stoped=!1,this._event.nativeEvent=Lb||La,this._target=null,this._point.setTo(La.pageX||La.clientX,La.pageY||La.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=La.identifier||0,this._tTouchID=this._event.touchId,(Lc=Lr.I._event)._stoped=!1,Lc.nativeEvent=this._event.nativeEvent,Lc.touchId=this._event.touchId},La.checkMouseWheel=function(La){this._event.delta=La.wheelDelta?.025*La.wheelDelta:-La.detail;for(var Lb=Lr.I.getLastOvers(),Lc=0,Ld=Lb.length;Lc<Ld;Lc++){var Le=Lb[Lc];Le.event("mousewheel",this._event.setTo("mousewheel",Le,this._target))}},La.onMouseMove=function(La){Lr.I.onMouseMove(La,this._tTouchID)},La.onMouseDown=function(La){if(Lva.isInputting&&Lz.stage.focus&&Lz.stage.focus.focus&&!Lz.stage.focus.contains(this._target)){var Lb=Lz.stage.focus._tf||Lz.stage.focus,Lc=La._tf||La;Lc instanceof laya.display.Input&&Lc.multiline==Lb.multiline?Lb._focusOut():Lb.focus=!1}Lr.I.onMouseDown(La,this._tTouchID,this._isLeftMouse)},La.onMouseUp=function(La){Lr.I.onMouseUp(La,this._tTouchID,this._isLeftMouse)},La.check=function(La,Lb,Lc,Ld){this._point.setTo(Lb,Lc),La.fromParentPoint(this._point),Lb=this._point.x,Lc=this._point.y;var Le=La.scrollRect;if(Le&&(this._rect.setTo(Le.x,Le.y,Le.width,Le.height),!this._rect.contains(Lb,Lc)))return!1;if(!this.disableMouseEvent){if(La.hitTestPrior&&!La.mouseThrough&&!this.hitTest(La,Lb,Lc))return!1;for(var Lf=La._childs.length-1;-1<Lf;Lf--){var Lg=La._childs[Lf];if(!Lg.destroyed&&Lg.mouseEnabled&&Lg.visible&&this.check(Lg,Lb,Lc,Ld))return!0}}var Lh=!(!La.hitTestPrior||La.mouseThrough||this.disableMouseEvent)||this.hitTest(La,Lb,Lc);return Lh?(this._target=La,Ld.call(this,La)):Ld===this.onMouseUp&&La===this._stage&&(this._target=this._stage,Ld.call(this,this._target)),Lh},La.hitTest=function(La,Lb,Lc){var Ld=!1;if(La.scrollRect&&(Lb-=La.scrollRect.x,Lc-=La.scrollRect.y),La.hitArea instanceof laya.utils.HitArea)return La.hitArea.isHit(Lb,Lc);if(0<La.width&&0<La.height||La.mouseThrough||La.hitArea)if(La.mouseThrough)Ld=La.getGraphicBounds().contains(Lb,Lc);else{var Le=this._rect;La.hitArea?Le=La.hitArea:Le.setTo(0,0,La.width,La.height),Ld=Le.contains(Lb,Lc)}return Ld},La.runEvent=function(){var La=this._eventList.length;if(La){var Lb=this;Lb.mouseEventTime=LO.now();var Lc,Ld=0,Le=0,Lf=0;try{for(;Ld<La;){var Lg=this._eventList[Ld];switch("mousemove"!==Lg.type&&(this._prePoint.x=this._prePoint.y=-1e6),Lg.type){case"mousedown":this._touchIDs[0]=this._id++,Lk._isTouchRespond?Lk._isTouchRespond=!1:(Lb._isLeftMouse=0===Lg.button,Lb.initEvent(Lg),Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseDown));break;case"mouseup":Lb._isLeftMouse=0===Lg.button,Lb.initEvent(Lg),Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-Lg.clientX)+Math.abs(this._prePoint.y-Lg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=Lg.clientX,this._prePoint.y=Lg.clientY,Lb.initEvent(Lg),Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseMove));break;case"touchstart":Lk._isTouchRespond=!0,Lb._isLeftMouse=!0;var Lh=Lg.changedTouches;for(Le=0,Lf=Lh.length;Le<Lf;Le++)Lc=Lh[Le],(Lk.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=Lc.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[Lc.identifier]=this._id++,Lb.initEvent(Lc,Lg),Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseDown));break;case"touchend":case"touchcancel":Lk._isTouchRespond=!0,Lb._isLeftMouse=!0;var Li=Lg.changedTouches;for(Le=0,Lf=Li.length;Le<Lf;Le++)if(Lc=Li[Le],Lk.multiTouchEnabled||Lc.identifier==this._curTouchID){this._curTouchID=NaN,Lb.initEvent(Lc,Lg);Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseUp)||Lb.onMouseUp(null)}break;case"touchmove":var Lj=Lg.changedTouches;for(Le=0,Lf=Lj.length;Le<Lf;Le++)Lc=Lj[Le],(Lk.multiTouchEnabled||Lc.identifier==this._curTouchID)&&(Lb.initEvent(Lc,Lg),Lb.check(Lb._stage,Lb.mouseX,Lb.mouseY,Lb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Lb.checkMouseWheel(Lg);break;case"mouseout":Lr.I.stageMouseOut();break;case"mouseover":Lb._stage.event("mouseover",Lb._event.setTo("mouseover",Lb._stage,Lb._stage))}Ld++}}catch(La){throw this._eventList.length=0,La}this._eventList.length=0}},Lk.enabled=!0,Lk.multiTouchEnabled=!0,Lk._isTouchRespond=!1,Lk._isFirstTouch=!0,Li(Lk,["instance",function(){return this.instance=new Lk}]),Lk}()),Lr=function(){function Lo(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Lf}Lq(Lo,"laya.events.TouchManager");var La=Lo.prototype;return La._clearTempArrs=function(){Lo._oldArr.length=0,Lo._newArr.length=0,Lo._tEleArr.length=0},La.getTouchFromArr=function(La,Lb){var Lc,Ld,Le=0;for(Lc=Lb.length,Le=0;Le<Lc;Le++)if((Ld=Lb[Le]).id==La)return Ld;return null},La.removeTouchFromArr=function(La,Lb){var Lc=0;for(Lc=Lb.length-1;0<=Lc;Lc--)Lb[Lc].id==La&&Lb.splice(Lc,1)},La.createTouchO=function(La,Lb){var Lc;return(Lc=LW.getItem("TouchData")||{}).id=Lb,Lc.tar=La,Lc},La.onMouseDown=function(La,Lb,Lc){var Ld,Le,Lf,Lg;(void 0===Lc&&(Lc=!1),this.enable)&&(Ld=this.getTouchFromArr(Lb,this.preOvers),Lf=this.getEles(La,null,Lo._tEleArr),Ld?Ld.tar=La:(Le=this.createTouchO(La,Lb),this.preOvers.push(Le)),LO.onMobile&&this.sendEvents(Lf,"mouseover",Lb),Lg=Lc?this.preDowns:this.preRightDowns,(Ld=this.getTouchFromArr(Lb,Lg))?Ld.tar=La:(Le=this.createTouchO(La,Lb),Lg.push(Le)),this.sendEvents(Lf,Lc?"mousedown":"rightmousedown",Lb),this._clearTempArrs())},La.sendEvents=function(La,Lb,Lc){void 0===Lc&&(Lc=0);var Ld,Le,Lf,Lg=0;for(Ld=La.length,this._event._stoped=!1,Le=La[0],Lg=0;Lg<Ld;Lg++){if((Lf=La[Lg]).destroyed)return;if(Lf.event(Lb,this._event.setTo(Lb,Lf,Le)),this._event._stoped)break}},La.getEles=function(La,Lb,Lc){for(Lc?Lc.length=0:Lc=[];La&&La!=Lb;)Lc.push(La),La=La.parent;return Lc},La.checkMouseOutAndOverOfMove=function(La,Lb,Lc){if(void 0===Lc&&(Lc=0),Lb!=La){var Ld,Le,Lf=0,Lg=0;if(Lb.contains(La))Le=this.getEles(La,Lb,Lo._tEleArr),this.sendEvents(Le,"mouseover",Lc);else if(La.contains(Lb))Le=this.getEles(Lb,La,Lo._tEleArr),this.sendEvents(Le,"mouseout",Lc);else{var Lh,Li;(Le=Lo._tEleArr).length=0,Lh=this.getEles(Lb,null,Lo._oldArr),Li=this.getEles(La,null,Lo._newArr),Lg=Lh.length;var Lj=0;for(Lf=0;Lf<Lg;Lf++){if(Ld=Lh[Lf],0<=(Lj=Li.indexOf(Ld))){Li.splice(Lj,Li.length-Lj);break}Le.push(Ld)}0<Le.length&&this.sendEvents(Le,"mouseout",Lc),0<Li.length&&this.sendEvents(Li,"mouseover",Lc)}}},La.onMouseMove=function(La,Lb){var Lc,Ld;this.enable&&((Lc=this.getTouchFromArr(Lb,this.preOvers))?(this.checkMouseOutAndOverOfMove(La,Lc.tar),Lc.tar=La,Ld=this.getEles(La,null,Lo._tEleArr)):(Ld=this.getEles(La,null,Lo._tEleArr),this.sendEvents(Ld,"mouseover",Lb),this.preOvers.push(this.createTouchO(La,Lb))),this.sendEvents(Ld,"mousemove",Lb),this._clearTempArrs())},La.getLastOvers=function(){return(Lo._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,Lo._tEleArr):(Lo._tEleArr.push(Lz.stage),Lo._tEleArr)},La.stageMouseOut=function(){var La;La=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(La,"mouseout",0)},La.onMouseUp=function(La,Lb,Lc){if(void 0===Lc&&(Lc=!1),this.enable){var Ld,Le,Lf,Lg,Lh,Li,Lj=0,Lk=0,Ll=LO.onMobile;if(Le=this.getEles(La,null,Lo._tEleArr),this.sendEvents(Le,Lc?"mouseup":"rightmouseup",Lb),Li=Lc?this.preDowns:this.preRightDowns,Ld=this.getTouchFromArr(Lb,Li)){var Lm,Ln=LO.now();if(Lm=Ln-this._lastClickTime<300,this._lastClickTime=Ln,La==Ld.tar)Lh=Le;else for(Lf=this.getEles(Ld.tar,null,Lo._oldArr),(Lh=Lo._newArr).length=0,Lk=Lf.length,Lj=0;Lj<Lk;Lj++)Lg=Lf[Lj],0<=Le.indexOf(Lg)&&Lh.push(Lg);0<Lh.length&&this.sendEvents(Lh,Lc?"click":"rightclick",Lb),Lc&&Lm&&this.sendEvents(Lh,"doubleclick",Lb),this.removeTouchFromArr(Lb,Li),Ld.tar=null,LW.recover("TouchData",Ld)}else;(Ld=this.getTouchFromArr(Lb,this.preOvers))&&Ll&&((Lh=this.getEles(Ld.tar,null,Lh))&&0<Lh.length&&this.sendEvents(Lh,"mouseout",Lb),this.removeTouchFromArr(Lb,this.preOvers),Ld.tar=null,LW.recover("TouchData",Ld)),this._clearTempArrs()}},Lo._oldArr=[],Lo._newArr=[],Lo._tEleArr=[],Li(Lo,["I",function(){return this.I=new Lo}]),Lo}(),Lt=function(){function La(){this._action=null}Lq(La,"laya.filters.Filter");var Lb=La.prototype;return Lz.imps(Lb,{"laya.filters.IFilter":!0}),Lb.callNative=function(La){},Lk(0,Lb,"type",function(){return-1}),Lk(0,Lb,"action",function(){return this._action}),La.BLUR=16,La.COLOR=32,La.GLOW=8,La._filterStart=null,La._filterEnd=null,La._EndTarget=null,La._recycleScope=null,La._filter=null,La._useSrc=null,La._endSrc=null,La._useOut=null,La._endOut=null,La}(),Lg=function(){function La(){this.data=null}Lq(La,"laya.filters.ColorFilterAction");var Lb=La.prototype;return Lz.imps(Lb,{"laya.filters.IFilterAction":!0}),Lb.apply=function(La){var Lb=La.ctx.ctx,Lc=La.ctx.ctx.canvas;if(0==Lc.width||0==Lc.height)return Lc;for(var Ld,Le=Lb.getImageData(0,0,Lc.width,Lc.height),Lf=Le.data,Lg=0,Lh=Lf.length;Lg<Lh;Lg+=4)Ld=this.getColor(Lf[Lg],Lf[Lg+1],Lf[Lg+2],Lf[Lg+3]),0!=Lf[Lg+3]&&(Lf[Lg]=Ld[0],Lf[Lg+1]=Ld[1],Lf[Lg+2]=Ld[2],Lf[Lg+3]=Ld[3]);return Lb.putImageData(Le,0,0),La},Lb.getColor=function(La,Lb,Lc,Ld){var Le=[];if(this.data._mat&&this.data._alpha){var Lf=this.data._mat,Lg=this.data._alpha;Le[0]=Lf[0]*La+Lf[1]*Lb+Lf[2]*Lc+Lf[3]*Ld+Lg[0],Le[1]=Lf[4]*La+Lf[5]*Lb+Lf[6]*Lc+Lf[7]*Ld+Lg[1],Le[2]=Lf[8]*La+Lf[9]*Lb+Lf[10]*Lc+Lf[11]*Ld+Lg[2],Le[3]=Lf[12]*La+Lf[13]*Lb+Lf[14]*Lc+Lf[15]*Ld+Lg[3]}return Le},La}(),Lu=(function(){function La(){}Lq(La,"laya.maths.Arith"),La.formatR=function(La){return La>Math.PI&&(La-=2*Math.PI),La<-Math.PI&&(La+=2*Math.PI),La},La.isPOT=function(La,Lb){return 0<La&&0==(La&La-1)&&0<Lb&&0==(Lb&Lb-1)},La.setMatToArray=function(La,Lb){La.a,La.b,La.c,La.d,La.tx,La.ty,Lb[0]=La.a,Lb[1]=La.b,Lb[4]=La.c,Lb[5]=La.d,Lb[12]=La.tx,Lb[13]=La.ty}}(),function(){function La(){this._controlPoints=[new LA,new LA,new LA],this._calFun=this.getPoint2}Lq(La,"laya.maths.Bezier");var Lb=La.prototype;return Lb._switchPoint=function(La,Lb){var Lc=this._controlPoints.shift();Lc.setTo(La,Lb),this._controlPoints.push(Lc)},Lb.getPoint2=function(La,Lb){var Lc=this._controlPoints[0],Ld=this._controlPoints[1],Le=this._controlPoints[2],Lf=Math.pow(1-La,2)*Lc.x+2*La*(1-La)*Ld.x+Math.pow(La,2)*Le.x,Lg=Math.pow(1-La,2)*Lc.y+2*La*(1-La)*Ld.y+Math.pow(La,2)*Le.y;Lb.push(Lf,Lg)},Lb.getPoint3=function(La,Lb){var Lc=this._controlPoints[0],Ld=this._controlPoints[1],Le=this._controlPoints[2],Lf=this._controlPoints[3],Lg=Math.pow(1-La,3)*Lc.x+3*Ld.x*La*(1-La)*(1-La)+3*Le.x*La*La*(1-La)+Lf.x*Math.pow(La,3),Lh=Math.pow(1-La,3)*Lc.y+3*Ld.y*La*(1-La)*(1-La)+3*Le.y*La*La*(1-La)+Lf.y*Math.pow(La,3);Lb.push(Lg,Lh)},Lb.insertPoints=function(La,Lb){var Lc,Ld=NaN;for(Lc=1/(La=0<La?La:5),Ld=0;Ld<=1;Ld+=Lc)this._calFun(Ld,Lb)},Lb.getBezierPoints=function(La,Lb,Lc){void 0===Lb&&(Lb=5),void 0===Lc&&(Lc=2);var Ld,Le,Lf=0;if((Ld=La.length)<2*(Lc+1))return[];switch(Le=[],Lc){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=Lc;)this._controlPoints.push(new LA);for(Lf=0;Lf<2*Lc;Lf+=2)this._switchPoint(La[Lf],La[Lf+1]);for(Lf=2*Lc;Lf<Ld;Lf+=2)this._switchPoint(La[Lf],La[Lf+1]),Lf/2%Lc==0&&this.insertPoints(Lb,Le);return Le},Li(La,["I",function(){return this.I=new La}]),La}()),Lv=function(){function Lj(){}return Lq(Lj,"laya.maths.GrahamScan"),Lj.multiply=function(La,Lb,Lc){return(La.x-Lc.x)*(Lb.y-Lc.y)-(Lb.x-Lc.x)*(La.y-Lc.y)},Lj.dis=function(La,Lb){return(La.x-Lb.x)*(La.x-Lb.x)+(La.y-Lb.y)*(La.y-Lb.y)},Lj._getPoints=function(La,Lb,Lc){for(void 0===Lb&&(Lb=!1),Lj._mPointList||(Lj._mPointList=[]);Lj._mPointList.length<La;)Lj._mPointList.push(new LA);return Lc||(Lc=[]),Lc.length=0,Lb?Lj.getFrom(Lc,Lj._mPointList,La):Lj.getFromR(Lc,Lj._mPointList,La),Lc},Lj.getFrom=function(La,Lb,Lc){var Ld=0;for(Ld=0;Ld<Lc;Ld++)La.push(Lb[Ld]);return La},Lj.getFromR=function(La,Lb,Lc){var Ld=0;for(Ld=0;Ld<Lc;Ld++)La.push(Lb.pop());return La},Lj.pListToPointList=function(La,Lb){void 0===Lb&&(Lb=!1);var Lc=0,Ld=La.length/2,Le=Lj._getPoints(Ld,Lb,Lj._tempPointList);for(Lc=0;Lc<Ld;Lc++)Le[Lc].setTo(La[Lc+Lc],La[Lc+Lc+1]);return Le},Lj.pointListToPlist=function(La){var Lb,Lc=0,Ld=La.length,Le=Lj._temPList;for(Lc=Le.length=0;Lc<Ld;Lc++)Lb=La[Lc],Le.push(Lb.x,Lb.y);return Le},Lj.scanPList=function(La){return L$.copyArray(La,Lj.pointListToPlist(Lj.scan(Lj.pListToPointList(La,!0))))},Lj.scan=function(La){var Lb,Lc,Ld,Le=0,Lf=0,Lg=0,Lh=La.length,Li={};for((Lc=Lj._temArr).length=0,Le=(Lh=La.length)-1;0<=Le;Le--)Ld=(Lb=La[Le]).x+"_"+Lb.y,Li.hasOwnProperty(Ld)||(Li[Ld]=!0,Lc.push(Lb));for(Lh=Lc.length,L$.copyArray(La,Lc),Le=1;Le<Lh;Le++)(La[Le].y<La[Lg].y||La[Le].y==La[Lg].y&&La[Le].x<La[Lg].x)&&(Lg=Le);for(Lb=La[0],La[0]=La[Lg],La[Lg]=Lb,Le=1;Le<Lh-1;Le++){for(Lf=(Lg=Le)+1;Lf<Lh;Lf++)(0<Lj.multiply(La[Lf],La[Lg],La[0])||0==Lj.multiply(La[Lf],La[Lg],La[0])&&Lj.dis(La[0],La[Lf])<Lj.dis(La[0],La[Lg]))&&(Lg=Lf);Lb=La[Le],La[Le]=La[Lg],La[Lg]=Lb}if((Lc=Lj._temArr).length=0,La.length<3)return L$.copyArray(Lc,La);for(Lc.push(La[0],La[1],La[2]),Le=3;Le<Lh;Le++){for(;2<=Lc.length&&0<=Lj.multiply(La[Le],Lc[Lc.length-1],Lc[Lc.length-2]);)Lc.pop();La[Le]&&Lc.push(La[Le])}return Lc},Lj._mPointList=null,Lj._tempPointList=[],Lj._temPList=[],Lj._temArr=[],Lj}(),Ly=function(){function Le(){}return Lq(Le,"laya.maths.MathUtil"),Le.subtractVector3=function(La,Lb,Lc){Lc[0]=La[0]-Lb[0],Lc[1]=La[1]-Lb[1],Lc[2]=La[2]-Lb[2]},Le.lerp=function(La,Lb,Lc){return La*(1-Lc)+Lb*Lc},Le.scaleVector3=function(La,Lb,Lc){Lc[0]=La[0]*Lb,Lc[1]=La[1]*Lb,Lc[2]=La[2]*Lb},Le.lerpVector3=function(La,Lb,Lc,Ld){var Le=La[0],Lf=La[1],Lg=La[2];Ld[0]=Le+Lc*(Lb[0]-Le),Ld[1]=Lf+Lc*(Lb[1]-Lf),Ld[2]=Lg+Lc*(Lb[2]-Lg)},Le.lerpVector4=function(La,Lb,Lc,Ld){var Le=La[0],Lf=La[1],Lg=La[2],Lh=La[3];Ld[0]=Le+Lc*(Lb[0]-Le),Ld[1]=Lf+Lc*(Lb[1]-Lf),Ld[2]=Lg+Lc*(Lb[2]-Lg),Ld[3]=Lh+Lc*(Lb[3]-Lh)},Le.slerpQuaternionArray=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh,Li,Lj,Lk,Ll,Lm=La[Lb+0],Ln=La[Lb+1],Lo=La[Lb+2],Lp=La[Lb+3],Lq=Lc[Ld+0],Lr=Lc[Ld+1],Ls=Lc[Ld+2],Lt=Lc[Ld+3];return(Li=Lm*Lq+Ln*Lr+Lo*Ls+Lp*Lt)<0&&(Li=-Li,Lq=-Lq,Lr=-Lr,Ls=-Ls,Lt=-Lt),Ll=1e-6<1-Li?(Lh=Math.acos(Li),Lj=Math.sin(Lh),Lk=Math.sin((1-Le)*Lh)/Lj,Math.sin(Le*Lh)/Lj):(Lk=1-Le,Le),Lf[Lg+0]=Lk*Lm+Ll*Lq,Lf[Lg+1]=Lk*Ln+Ll*Lr,Lf[Lg+2]=Lk*Lo+Ll*Ls,Lf[Lg+3]=Lk*Lp+Ll*Lt,Lf},Le.getRotation=function(La,Lb,Lc,Ld){return Math.atan2(Ld-Lb,Lc-La)/Math.PI*180},Le.sortBigFirst=function(La,Lb){return La==Lb?0:La<Lb?1:-1},Le.sortSmallFirst=function(La,Lb){return La==Lb?0:La<Lb?-1:1},Le.sortNumBigFirst=function(La,Lb){return parseFloat(Lb)-parseFloat(La)},Le.sortNumSmallFirst=function(La,Lb){return parseFloat(La)-parseFloat(Lb)},Le.sortByKey=function(Lc,La,Lb){var Ld;return void 0===La&&(La=!1),void 0===Lb&&(Lb=!0),Ld=La?Lb?Le.sortNumBigFirst:Le.sortBigFirst:Lb?Le.sortNumSmallFirst:Le.sortSmallFirst,function(La,Lb){return Ld(La[Lc],Lb[Lc])}},Le}(),LG=function(){function Lc(La,Lb,Lc,Ld,Le,Lf){this.inPool=!1,this.bTransform=!1,void 0===La&&(La=1),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=1),void 0===Le&&(Le=0),void 0===Lf&&(Lf=0),this.a=La,this.b=Lb,this.c=Lc,this.d=Ld,this.tx=Le,this.ty=Lf,this._checkTransform()}Lq(Lc,"laya.maths.Matrix");var La=Lc.prototype;return La.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},La._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},La.setTranslate=function(La,Lb){return this.tx=La,this.ty=Lb,this},La.translate=function(La,Lb){return this.tx+=La,this.ty+=Lb,this},La.scale=function(La,Lb){this.a*=La,this.d*=Lb,this.c*=La,this.b*=Lb,this.tx*=La,this.ty*=Lb,this.bTransform=!0},La.rotate=function(La){var Lb=Math.cos(La),Lc=Math.sin(La),Ld=this.a,Le=this.c,Lf=this.tx;this.a=Ld*Lb-this.b*Lc,this.b=Ld*Lc+this.b*Lb,this.c=Le*Lb-this.d*Lc,this.d=Le*Lc+this.d*Lb,this.tx=Lf*Lb-this.ty*Lc,this.ty=Lf*Lc+this.ty*Lb,this.bTransform=!0},La.skew=function(La,Lb){var Lc=Math.tan(La),Ld=Math.tan(Lb),Le=this.a,Lf=this.b;return this.a+=Ld*this.c,this.b+=Ld*this.d,this.c+=Lc*Le,this.d+=Lc*Lf,this},La.invertTransformPoint=function(La){var Lb=this.a,Lc=this.b,Ld=this.c,Le=this.d,Lf=this.tx,Lg=Lb*Le-Lc*Ld,Lh=Le/Lg,Li=-Lc/Lg,Lj=-Ld/Lg,Lk=Lb/Lg,Ll=(Ld*this.ty-Le*Lf)/Lg,Lm=-(Lb*this.ty-Lc*Lf)/Lg;return La.setTo(Lh*La.x+Lj*La.y+Ll,Li*La.x+Lk*La.y+Lm)},La.transformPoint=function(La){return La.setTo(this.a*La.x+this.c*La.y+this.tx,this.b*La.x+this.d*La.y+this.ty)},La.transformPointN=function(La){return La.setTo(this.a*La.x+this.c*La.y,this.b*La.x+this.d*La.y)},La.transformPointArray=function(La,Lb){for(var Lc=La.length,Ld=0;Ld<Lc;Ld+=2){var Le=La[Ld],Lf=La[Ld+1];Lb[Ld]=this.a*Le+this.c*Lf+this.tx,Lb[Ld+1]=this.b*Le+this.d*Lf+this.ty}return Lb},La.transformPointArrayScale=function(La,Lb){for(var Lc=La.length,Ld=0;Ld<Lc;Ld+=2){var Le=La[Ld],Lf=La[Ld+1];Lb[Ld]=this.a*Le+this.c*Lf,Lb[Ld+1]=this.b*Le+this.d*Lf}return Lb},La.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},La.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},La.invert=function(){var La=this.a,Lb=this.b,Lc=this.c,Ld=this.d,Le=this.tx,Lf=La*Ld-Lb*Lc;return this.a=Ld/Lf,this.b=-Lb/Lf,this.c=-Lc/Lf,this.d=La/Lf,this.tx=(Lc*this.ty-Ld*Le)/Lf,this.ty=-(La*this.ty-Lb*Le)/Lf,this},La.setTo=function(La,Lb,Lc,Ld,Le,Lf){return this.a=La,this.b=Lb,this.c=Lc,this.d=Ld,this.tx=Le,this.ty=Lf,this},La.concat=function(La){var Lb=this.a,Lc=this.c,Ld=this.tx;return this.a=Lb*La.a+this.b*La.c,this.b=Lb*La.b+this.b*La.d,this.c=Lc*La.a+this.d*La.c,this.d=Lc*La.b+this.d*La.d,this.tx=Ld*La.a+this.ty*La.c+La.tx,this.ty=Ld*La.b+this.ty*La.d+La.ty,this},La.scaleEx=function(La,Lb){var Lc=this.a,Ld=this.b,Le=this.c,Lf=this.d;0!==Ld||0!==Le?(this.a=La*Lc,this.b=La*Ld,this.c=Lb*Le):(this.a=La*Lc,this.b=0*Lf,this.c=0*Lc),this.d=Lb*Lf,this.bTransform=!0},La.rotateEx=function(La){var Lb=Math.cos(La),Lc=Math.sin(La),Ld=this.a,Le=this.b,Lf=this.c,Lg=this.d;0!==Le||0!==Lf?(this.a=Lb*Ld+Lc*Lf,this.b=Lb*Le+Lc*Lg,this.c=-Lc*Ld+Lb*Lf,this.d=-Lc*Le+Lb*Lg):(this.a=Lb*Ld,this.b=Lc*Lg,this.c=-Lc*Ld,this.d=Lb*Lg),this.bTransform=!0},La.clone=function(){var La=Lc.create();return La.a=this.a,La.b=this.b,La.c=this.c,La.d=this.d,La.tx=this.tx,La.ty=this.ty,La.bTransform=this.bTransform,La},La.copyTo=function(La){return La.a=this.a,La.b=this.b,La.c=this.c,La.d=this.d,La.tx=this.tx,La.ty=this.ty,La.bTransform=this.bTransform,La},La.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},La.destroy=function(){if(!this.inPool){var La=Lc._cache;this.inPool=!0,La._length||(La._length=0),(La[La._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},Lc.mul=function(La,Lb,Lc){var Ld=La.a,Le=La.b,Lf=La.c,Lg=La.d,Lh=La.tx,Li=La.ty,Lj=Lb.a,Lk=Lb.b,Ll=Lb.c,Lm=Lb.d,Ln=Lb.tx,Lo=Lb.ty;return 0!==Lk||0!==Ll?(Lc.a=Ld*Lj+Le*Ll,Lc.b=Ld*Lk+Le*Lm,Lc.c=Lf*Lj+Lg*Ll,Lc.d=Lf*Lk+Lg*Lm,Lc.tx=Lj*Lh+Ll*Li+Ln,Lc.ty=Lk*Lh+Lm*Li+Lo):(Lc.a=Ld*Lj,Lc.b=Le*Lm,Lc.c=Lf*Lj,Lc.d=Lg*Lm,Lc.tx=Lj*Lh+Ln,Lc.ty=Lm*Li+Lo),Lc},Lc.mul16=function(La,Lb,Lc){var Ld=La.a,Le=La.b,Lf=La.c,Lg=La.d,Lh=La.tx,Li=La.ty,Lj=Lb.a,Lk=Lb.b,Ll=Lb.c,Lm=Lb.d,Ln=Lb.tx,Lo=Lb.ty;return 0!==Lk||0!==Ll?(Lc[0]=Ld*Lj+Le*Ll,Lc[1]=Ld*Lk+Le*Lm,Lc[4]=Lf*Lj+Lg*Ll,Lc[5]=Lf*Lk+Lg*Lm,Lc[12]=Lj*Lh+Ll*Li+Ln,Lc[13]=Lk*Lh+Lm*Li+Lo):(Lc[0]=Ld*Lj,Lc[1]=Le*Lm,Lc[4]=Lf*Lj,Lc[5]=Lg*Lm,Lc[12]=Lj*Lh+Ln,Lc[13]=Lm*Li+Lo),Lc},Lc.mulPre=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=La.a,Lj=La.b,Lk=La.c,Ll=La.d,Lm=La.tx,Ln=La.ty;return 0!==Lc||0!==Ld?(Lh.a=Li*Lb+Lj*Ld,Lh.b=Li*Lc+Lj*Le,Lh.c=Lk*Lb+Ll*Ld,Lh.d=Lk*Lc+Ll*Le,Lh.tx=Lb*Lm+Ld*Ln+Lf,Lh.ty=Lc*Lm+Le*Ln+Lg):(Lh.a=Li*Lb,Lh.b=Lj*Le,Lh.c=Lk*Lb,Lh.d=Ll*Le,Lh.tx=Lb*Lm+Lf,Lh.ty=Le*Ln+Lg),Lh},Lc.mulPos=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=La.a,Lj=La.b,Lk=La.c,Ll=La.d,Lm=La.tx,Ln=La.ty;return 0!==Lj||0!==Lk?(Lh.a=Lb*Li+Lc*Lk,Lh.b=Lb*Lj+Lc*Ll,Lh.c=Ld*Li+Le*Lk,Lh.d=Ld*Lj+Le*Ll,Lh.tx=Li*Lf+Lk*Lg+Lm,Lh.ty=Lj*Lf+Ll*Lg+Ln):(Lh.a=Lb*Li,Lh.b=Lc*Ll,Lh.c=Ld*Li,Lh.d=Le*Ll,Lh.tx=Li*Lf+Lm,Lh.ty=Ll*Lg+Ln),Lh},Lc.preMul=function(La,Lb,Lc){var Ld=La.a,Le=La.b,Lf=La.c,Lg=La.d,Lh=Lb.a,Li=Lb.b,Lj=Lb.c,Lk=Lb.d,Ll=Lb.tx,Lm=Lb.ty;return Lc.a=Lh*Ld,Lc.b=Lc.c=0,Lc.d=Lk*Lg,Lc.tx=Ll*Ld+La.tx,Lc.ty=Lm*Lg+La.ty,0===Li&&0===Lj&&0===Le&&0===Lf||(Lc.a+=Li*Lf,Lc.d+=Lj*Le,Lc.b+=Lh*Le+Li*Lg,Lc.c+=Lj*Ld+Lk*Lf,Lc.tx+=Lm*Lf,Lc.ty+=Ll*Le),Lc},Lc.preMulXY=function(La,Lb,Lc,Ld){var Le=La.a,Lf=La.b,Lg=La.c,Lh=La.d;return Ld.a=Le,Ld.b=Lf,Ld.c=Lg,Ld.d=Lh,Ld.tx=Lb*Le+La.tx+Lc*Lg,Ld.ty=Lc*Lh+La.ty+Lb*Lf,Ld},Lc.create=function(){var La=Lc._cache,Lb=La._length?La[--La._length]:new Lc;return Lb.inPool=!1,Lb},Lc.EMPTY=new Lc,Lc.TEMP=new Lc,Lc._cache=[],Lc}(),LA=function(){function La(La,Lb){void 0===La&&(La=0),void 0===Lb&&(Lb=0),this.x=La,this.y=Lb}Lq(La,"laya.maths.Point");var Lb=La.prototype;return Lb.setTo=function(La,Lb){return this.x=La,this.y=Lb,this},Lb.distance=function(La,Lb){return Math.sqrt((this.x-La)*(this.x-La)+(this.y-Lb)*(this.y-Lb))},Lb.toString=function(){return this.x+","+this.y},Lb.normalize=function(){var La=Math.sqrt(this.x*this.x+this.y*this.y);if(0<La){var Lb=1/La;this.x*=Lb,this.y*=Lb}},La.TEMP=new La,La.EMPTY=new La,La}(),LB=function(){function Lj(La,Lb,Lc,Ld){void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),this.x=La,this.y=Lb,this.width=Lc,this.height=Ld}Lq(Lj,"laya.maths.Rectangle");var La=Lj.prototype;return La.setTo=function(La,Lb,Lc,Ld){return this.x=La,this.y=Lb,this.width=Lc,this.height=Ld,this},La.copyFrom=function(La){return this.x=La.x,this.y=La.y,this.width=La.width,this.height=La.height,this},La.contains=function(La,Lb){return!(this.width<=0||this.height<=0)&&(La>=this.x&&La<this.right&&Lb>=this.y&&Lb<this.bottom)},La.intersects=function(La){return!(La.x>this.x+this.width||La.x+La.width<this.x||La.y>this.y+this.height||La.y+La.height<this.y)},La.intersection=function(La,Lb){return this.intersects(La)?(Lb||(Lb=new Lj),Lb.x=Math.max(this.x,La.x),Lb.y=Math.max(this.y,La.y),Lb.width=Math.min(this.right,La.right)-Lb.x,Lb.height=Math.min(this.bottom,La.bottom)-Lb.y,Lb):null},La.union=function(La,Lb){return Lb||(Lb=new Lj),this.clone(Lb),La.width<=0||La.height<=0?Lb:(Lb.addPoint(La.x,La.y),Lb.addPoint(La.right,La.bottom),this)},La.clone=function(La){return La||(La=new Lj),La.x=this.x,La.y=this.y,La.width=this.width,La.height=this.height,La},La.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},La.equals=function(La){return!(!La||La.x!==this.x||La.y!==this.y||La.width!==this.width||La.height!==this.height)},La.addPoint=function(La,Lb){return this.x>La&&(this.width+=this.x-La,this.x=La),this.y>Lb&&(this.height+=this.y-Lb,this.y=Lb),this.width<La-this.x&&(this.width=La-this.x),this.height<Lb-this.y&&(this.height=Lb-this.y),this},La._getBoundPoints=function(){var La=Lj._temB;return(La.length=0)==this.width||0==this.height||La.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),La},La.isEmpty=function(){return this.width<=0||this.height<=0},Lk(0,La,"right",function(){return this.x+this.width}),Lk(0,La,"bottom",function(){return this.y+this.height}),Lj._getBoundPointS=function(La,Lb,Lc,Ld){var Le=Lj._temA;return(Le.length=0)==Lc||0==Ld||Le.push(La,Lb,La+Lc,Lb,La,Lb+Ld,La+Lc,Lb+Ld),Le},Lj._getWrapRec=function(La,Lb){if(!La||La.length<1)return Lb?Lb.setTo(0,0,0,0):Lj.TEMP.setTo(0,0,0,0);Lb=Lb||new Lj;var Lc,Ld,Le,Lf,Lg,Lh=La.length,Li=LA.TEMP;for(Le=Lg=-(Ld=Lf=99999),Lc=0;Lc<Lh;Lc+=2)Li.x=La[Lc],Li.y=La[Lc+1],Ld=Ld<Li.x?Ld:Li.x,Lf=Lf<Li.y?Lf:Li.y,Le=Le>Li.x?Le:Li.x,Lg=Lg>Li.y?Lg:Li.y;return Lb.setTo(Ld,Lf,Le-Ld,Lg-Lf)},Lj.EMPTY=new Lj,Lj.TEMP=new Lj,Lj._temB=[],Lj._temA=[],Lj}(),LE=function(){function Li(){}return Lq(Li,"laya.media.SoundManager"),Lk(1,Li,"useAudioMusic",function(){return Li._useAudioMusic},function(La){Li._useAudioMusic=La,Li._musicClass=La?Lca:null}),Lk(1,Li,"autoStopMusic",function(){return Li._autoStopMusic},function(La){Lz.stage.off("blur",null,Li._stageOnBlur),Lz.stage.off("focus",null,Li._stageOnFocus),Lz.stage.off("visibilitychange",null,Li._visibilityChange),(Li._autoStopMusic=La)&&(Lz.stage.on("blur",null,Li._stageOnBlur),Lz.stage.on("focus",null,Li._stageOnFocus),Lz.stage.on("visibilitychange",null,Li._visibilityChange))}),Lk(1,Li,"muted",function(){return Li._muted},function(La){La!=Li._muted&&(La&&Li.stopAllSound(),Li.musicMuted=La,Li._muted=La)}),Lk(1,Li,"musicMuted",function(){return Li._musicMuted},function(La){La!=Li._musicMuted&&(La?(Li._tMusic&&Li._musicChannel&&!Li._musicChannel.isStopped?Li._musicChannel.pause():Li._musicChannel=null,Li._musicMuted=La):(Li._musicMuted=La,Li._tMusic&&Li._musicChannel&&Li._musicChannel.resume()))}),Lk(1,Li,"soundMuted",function(){return Li._soundMuted},function(La){Li._soundMuted=La}),Li.addChannel=function(La){0<=Li._channels.indexOf(La)||(Li._channels.push(La),Li.autoReleaseSound&&0!=Li._notUsedCount&&Li._notUsedUrls[La.url]&&(delete Li._notUsedUrls[La.url],0==--Li._notUsedCount&&Lz.timer.clear(Li,Li.disposeSoundIfNotUsed)))},Li.removeChannel=function(La){var Lb=Li._channels,Lc=Lb.indexOf(La);if(-1!=Lc&&(Lb.splice(Lc,1),Li.autoReleaseSound)){var Ld=La.url,Le=Li.defaultIntervals[Ld]||2e4;if(0<Le){var Lf=!0;for(Lc=Lb.length-1;0<=Lc;Lc--)if(Lb[Lc].url==Ld){Lf=!1;break}Lf&&(Li._notUsedUrls[Ld]=Date.now()+Le,0==Li._notUsedCount++&&Lz.timer.loop(1e4,Li,Li.disposeSoundIfNotUsed))}}},Li.disposeSoundIfNotUsed=function(){var La=Li._notUsedUrls;if(0!=Li._notUsedCount){var Lb=Date.now();for(var Lc in La)Lb>=La[Lc]&&(delete La[Lc],--Li._notUsedCount,Li.destroySound(Lc));if(0!=Li._notUsedCount)return}Lz.timer.clear(Li,Li.disposeSoundIfNotUsed)},Li._visibilityChange=function(){Lz.stage.isVisibility?Li._stageOnFocus():Li._stageOnBlur()},Li._stageOnBlur=function(){Li._isActive=!1,Li._musicChannel&&(Li._musicChannel.isStopped||(Li._blurPaused=!0,Li._musicChannel.pause())),Li.stopAllSound(),Lz.stage.once("mousedown",null,Li._stageOnFocus)},Li._recoverWebAudio=function(){Lfa.ctx&&"running"!=Lfa.ctx.state&&Lfa.ctx.resume&&Lfa.ctx.resume()},Li._stageOnFocus=function(){if(Li._isActive=!0,Li._recoverWebAudio(),Lz.stage.off("mousedown",null,Li._stageOnFocus),Li._blurPaused){var La=Li._musicChannel;La&&Li._music&&La.isStopped&&(Li._blurPaused=!1,Li._music._disposed?Li.playMusic(La.url,La.loops,La.startHandler,La.completeHandler,La.startTime):La.audioBuffer?La.resume():Li._music.play(La.startTime,La.loops,La.startHandler,La))}},Li.playSound=function(La,Lb,Lc,Ld,Le,Lf){if(void 0===Lb&&(Lb=1),void 0===Lf&&(Lf=0),!La)return null;if(Li._muted)return null;if(Li._recoverWebAudio(),La==Li._tMusic){if(Li._musicMuted)return null}else{if(!Li._isActive)return null;if(Li._soundMuted)return null}var Lg,Lh=Li._pool[La];return Le||(Le=Li._soundClass),Lh||((Lh=new Le).load(La),Li._pool[La]=Lh),(Lg=Lh.play(Lf,Lb,Lc))?(La==Li._tMusic&&(Li._music=Lh,Li._isActive||(Li._blurPaused=!0,Lg.pause())),Lg.url=La,Lg.volume=La==Li._tMusic?Li.musicVolume:Li.soundVolume,Lg.completeHandler=Ld,Lg):null},Li.destroySound=function(La){var Lb=Li._pool[La];Lb&&(delete Li._pool[La],Lb.dispose())},Li.playMusic=function(La,Lb,Lc,Ld,Le){return void 0===Lb&&(Lb=0),void 0===Le&&(Le=0),Li._tMusic=La,Li._musicChannel&&Li._musicChannel.stop(),Li._musicChannel=Li.playSound(La,Lb,Lc,Ld,null,Le)},Li.stopSound=function(La){for(var Lb,Lc=Li._channels.length-1;0<=Lc;Lc--)(Lb=Li._channels[Lc]).url==La&&Lb.stop()},Li.stopAll=function(){Li._tMusic=null;var La=0;for(La=Li._channels.length-1;0<=La;La--)Li._channels[La].stop()},Li.stopAllSound=function(){var La,Lb=0;for(Lb=Li._channels.length-1;0<=Lb;Lb--)(La=Li._channels[Lb]).url!=Li._tMusic&&La.stop()},Li.stopMusic=function(){Li._musicChannel&&Li._musicChannel.stop(),Li._tMusic=null},Li.setSoundVolume=function(La,Lb){if(Lb)Li._setVolume(Lb,La);else{Li.soundVolume=La;var Lc,Ld=0;for(Ld=Li._channels.length-1;0<=Ld;Ld--)(Lc=Li._channels[Ld]).url!=Li._tMusic&&(Lc.volume=La)}},Li.setMusicVolume=function(La){Li.musicVolume=La,Li._setVolume(Li._tMusic,La)},Li._setVolume=function(La,Lb){for(var Lc,Ld=Li._channels.length-1;0<=Ld;Ld--)(Lc=Li._channels[Ld]).url==La&&(Lc.volume=Lb)},Li.musicVolume=1,Li.soundVolume=1,Li.playbackRate=1,Li._useAudioMusic=!0,Li._muted=!1,Li._soundMuted=!1,Li._musicMuted=!1,Li._tMusic=null,Li._musicChannel=null,Li._music=null,Li._channels=[],Li._autoStopMusic=!1,Li._blurPaused=!1,Li._isActive=!0,Li._soundClass=null,Li._musicClass=null,Li.autoReleaseSound=!0,Li._pool={},Li.defaultIntervals={},Li._notUsedUrls={},Li._notUsedCount=0,Li}(),LC=function(){var La;function Lc(){}return Lq(Lc,"laya.net.LocalStorage"),Lc.__init__=function(){Lc._baseClass||(Lc._baseClass=La).init(),Lc.items=Lc._baseClass.items,Lc.support=Lc._baseClass.support},Lc.setItem=function(La,Lb){Lc._baseClass.setItem(La,Lb)},Lc.getItem=function(La){return Lc._baseClass.getItem(La)},Lc.setJSON=function(La,Lb){Lc._baseClass.setJSON(La,Lb)},Lc.getJSON=function(La){return Lc._baseClass.getJSON(La)},Lc.removeItem=function(La){Lc._baseClass.removeItem(La)},Lc.clear=function(){Lc._baseClass.clear()},Lc._baseClass=null,Lc.items=null,Lc.support=!1,Lc.__init$=function(){La=function(){function Lc(){}return Lq(Lc,""),Lc.init=function(){try{Lc.support=!0,Lc.items=Ln.localStorage,Lc.setItem("laya","1"),Lc.removeItem("laya")}catch(La){Lc.support=!1}Lc.support||console.log("LocalStorage is not supprot or browser is private mode.")},Lc.setItem=function(La,Lb){try{Lc.support&&Lc.items.setItem(La,Lb)}catch(La){console.warn("set localStorage failed",La)}},Lc.getItem=function(La){return Lc.support?Lc.items.getItem(La):null},Lc.setJSON=function(La,Lb){try{Lc.support&&Lc.items.setItem(La,JSON.stringify(Lb))}catch(La){console.warn("set localStorage failed",La)}},Lc.getJSON=function(La){return JSON.parse(Lc.support?Lc.items.getItem(La):null)},Lc.removeItem=function(La){Lc.support&&Lc.items.removeItem(La)},Lc.clear=function(){Lc.support&&Lc.items.clear()},Lc.items=null,Lc.support=!1,Lc}()},Lc}(),LH=(function(){function Ld(){}Lq(Ld,"laya.net.ResourceVersion"),Ld.enable=function(La,Lb,Lc){void 0===Lc&&(Lc=2),laya.net.ResourceVersion.type=Lc,Lz.loader.load(La,Ls.create(null,Ld.onManifestLoaded,[Lb]),null,"json"),LI.customFormat=Ld.addVersionPrefix},Ld.onManifestLoaded=function(La,Lb){Ld.manifest=Lb,La.run(),Lb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Ld.addVersionPrefix=function(La){return Ld.manifest&&Ld.manifest[La]?2==Ld.type?Ld.manifest[La]:Ld.manifest[La]+"/"+La:La},Ld.FOLDER_VERSION=1,Ld.FILENAME_VERSION=2,Ld.manifest=null,Ld.type=1}(),function(){function La(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Lq(La,"laya.net.TTFLoader");var Lb=La.prototype;return Lb.load=function(La){var Lb=(this._url=La).split(".ttf")[0].split("/");this.fontName=Lb[Lb.length-1],LO.window.conch?this._loadConch():LO.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Lb._loadConch=function(){this._http=new Lga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Lb._onHttpLoaded=function(La){LO.window.conch.setFontFaceFromBuffer(this.fontName,La),this._clearHttp(),this._complete()},Lb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Lb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Lb._complete=function(){Lz.timer.clear(this,this._complete),Lz.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Lb._checkComplete=function(){LF.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Lb._loadWithFontFace=function(){var La=new LO.window.FontFace(this.fontName,"url('"+this._url+"')");LO.window.document.fonts.add(La);var Lb=this;La.loaded.then(function(){Lb._complete()}),La.load()},Lb._createDiv=function(){this._div=LO.createElement("div"),this._div.innerHTML="laya";var La=this._div.style;La.fontFamily=this.fontName,La.position="absolute",La.left="-100px",La.top="-100px",LO.document.body.appendChild(this._div)},Lb._loadWithCSS=function(){var La=this,Lb=LO.createElement("style");Lb.type="text/css",LO.document.body.appendChild(Lb),Lb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=LF.measureText("LayaTTFFont",this._fontTxt).width;var Lc=this;Lb.onload=function(){Lz.timer.once(1e4,Lc,La._complete)},Lz.timer.loop(20,this,this._checkComplete),this._createDiv()},La._testString="LayaTTFFont",La}()),LI=function(){function Ld(La){this._url=null,this._path=null,this._url=Ld.formatURL(La),this._path=Ld.getPath(La)}Lq(Ld,"laya.net.URL");var La=Ld.prototype;return Lk(0,La,"path",function(){return this._path}),Lk(0,La,"url",function(){return this._url}),Ld.formatURL=function(La,Lb){if(!La)return"null path";if(0<La.indexOf(":"))return La;null!=Ld.customFormat&&(La=Ld.customFormat(La,Lb));var Lc=La.charAt(0);if("."===Lc)return Ld.formatRelativePath((Lb||Ld.basePath)+La);if("~"===Lc)return Ld.rootPath+La.substring(1);if("d"===Lc){if(0===La.indexOf("data:image"))return La}else if("/"===Lc)return La;return(Lb||Ld.basePath)+La},Ld.formatRelativePath=function(La){for(var Lb=La.split("/"),Lc=0,Ld=Lb.length;Lc<Ld;Lc++)".."==Lb[Lc]&&(Lb.splice(Lc-1,2),Lc-=2);return Lb.join("/")},Ld.isAbsolute=function(La){return 0<La.indexOf(":")||"/"==La.charAt(0)},Ld.getPath=function(La){var Lb=La.lastIndexOf("/");return 0<Lb?La.substr(0,Lb+1):""},Ld.getFileName=function(La){var Lb=La.lastIndexOf("/");return 0<Lb?La.substr(Lb+1):La},Ld.version={},Ld.basePath="",Ld.rootPath="",Ld.customFormat=function(La){var Lb=Ld.version[La];return!LJ.isConchApp&&Lb&&(La+="?v="+Lb),La},Ld}(),LJ=function(){function Le(La,Lb){this._timeId=0;var Lc=Le._mainCanvas.source.style;Lc.position="absolute",Lc.top=Lc.left="0px",Lc.background="#000000",Le._mainCanvas.source.id="layaCanvas";var Ld=laya.renders.Render.isWebGL;Le._mainCanvas.source.width=La,Le._mainCanvas.source.height=Lb,Ld&&Le.WebGL.init(Le._mainCanvas,La,Lb),LO.container.appendChild(Le._mainCanvas.source),(Le._context=new LK(La,Lb,Ld?null:Le._mainCanvas)).ctx.setIsMainContext(),LO.window.requestAnimationFrame(function La(Lb){LO.window.requestAnimationFrame(La);Lz.stage._loop(Lb)}),Lz.stage.on("visibilitychange",this,this._onVisibilitychange)}Lq(Le,"laya.renders.Render");var La=Le.prototype;return La._onVisibilitychange=function(){Lz.stage.isVisibility?0!=this._timeId&&LO.window.clearInterval(this._timeId):this._timeId=LO.window.setInterval(this._enterFrame,1e3)},La._enterFrame=function(La){Lz.stage._loop(0)},Lk(1,Le,"context",function(){return Le._context}),Lk(1,Le,"canvas",function(){return Le._mainCanvas.source}),Le._context=null,Le._mainCanvas=null,Le.WebGL=null,Le.isConchNode=!1,Le.isConchApp=!1,Le.isConchWebGL=!1,Le.isWebGL=!1,Le.is3DMode=!1,Le.optimizeTextureMemory=function(La,Lb){return!0},Le.__init$=function(){Ln.ConchRenderType=Ln.ConchRenderType||1,Ln.ConchRenderType|=Ln.conch?4:0,Le.isConchNode=5==(5&Ln.ConchRenderType),Le.isConchApp=4==(4&Ln.ConchRenderType),Le.isConchWebGL=6==Ln.ConchRenderType},Le}(),LK=function(){function Lg(La,Lb,Lc){this.x=0,this.y=0,this._drawTexture=function(La,Lb,Lc){Lc[0].loaded&&this.ctx.drawTexture(Lc[0],Lc[1],Lc[2],Lc[3],Lc[4],La,Lb)},this._fillTexture=function(La,Lb,Lc){Lc[0].loaded&&this.ctx.fillTexture(Lc[0],Lc[1]+La,Lc[2]+Lb,Lc[3],Lc[4],Lc[5],Lc[6],Lc[7])},this._drawTextureWithTransform=function(La,Lb,Lc){Lc[0].loaded&&this.ctx.drawTextureWithTransform(Lc[0],Lc[1],Lc[2],Lc[3],Lc[4],Lc[5],La,Lb,Lc[6])},this._fillQuadrangle=function(La,Lb,Lc){this.ctx.fillQuadrangle(Lc[0],Lc[1],Lc[2],Lc[3],Lc[4])},this._drawRect=function(La,Lb,Lc){var Ld=this.ctx;null!=Lc[4]&&(Ld.fillStyle=Lc[4],Ld.fillRect(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3],null)),null!=Lc[5]&&(Ld.strokeStyle=Lc[5],Ld.lineWidth=Lc[6],Ld.strokeRect(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3],Lc[6]))},this._drawPie=function(La,Lb,Lc){var Ld=this.ctx;LJ.isWebGL&&Ld.setPathId(Lc[8]),Ld.beginPath(),LJ.isWebGL?(Ld.movePath(Lc[0]+La,Lc[1]+Lb),Ld.moveTo(0,0)):Ld.moveTo(La+Lc[0],Lb+Lc[1]),Ld.arc(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3],Lc[4]),Ld.closePath(),this._fillAndStroke(Lc[5],Lc[6],Lc[7],!0)},this._clipRect=function(La,Lb,Lc){this.ctx.clipRect(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3])},this._fillRect=function(La,Lb,Lc){this.ctx.fillRect(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3],Lc[4])},this._drawCircle=function(La,Lb,Lc){var Ld=this.ctx;LJ.isWebGL&&Ld.setPathId(Lc[6]),LX.drawCall++,Ld.beginPath(),LJ.isWebGL&&Ld.movePath(Lc[0]+La,Lc[1]+Lb),Ld.arc(Lc[0]+La,Lc[1]+Lb,Lc[2],0,Lg.PI2),Ld.closePath(),this._fillAndStroke(Lc[3],Lc[4],Lc[5],!0)},this._fillCircle=function(La,Lb,Lc){LX.drawCall++;var Ld=this.ctx;Ld.beginPath(),Ld.fillStyle=Lc[3],Ld.arc(Lc[0]+La,Lc[1]+Lb,Lc[2],0,Lg.PI2),Ld.fill()},this._setShader=function(La,Lb,Lc){this.ctx.setShader(Lc[0])},this._drawLine=function(La,Lb,Lc){var Ld=this.ctx;LJ.isWebGL&&Ld.setPathId(Lc[6]),Ld.beginPath(),Ld.strokeStyle=Lc[4],Ld.lineWidth=Lc[5],LJ.isWebGL?(Ld.movePath(La,Lb),Ld.moveTo(Lc[0],Lc[1]),Ld.lineTo(Lc[2],Lc[3])):(Ld.moveTo(La+Lc[0],Lb+Lc[1]),Ld.lineTo(La+Lc[2],Lb+Lc[3])),Ld.stroke()},this._drawLines=function(La,Lb,Lc){var Ld=this.ctx;LJ.isWebGL&&Ld.setPathId(Lc[5]),Ld.beginPath(),La+=Lc[0],Lb+=Lc[1],LJ.isWebGL&&Ld.movePath(La,Lb),Ld.strokeStyle=Lc[3],Ld.lineWidth=Lc[4];var Le=Lc[2],Lf=2,Lg=Le.length;if(LJ.isWebGL)for(Ld.moveTo(Le[0],Le[1]);Lf<Lg;)Ld.lineTo(Le[Lf++],Le[Lf++]);else for(Ld.moveTo(La+Le[0],Lb+Le[1]);Lf<Lg;)Ld.lineTo(La+Le[Lf++],Lb+Le[Lf++]);Ld.stroke()},this._drawLinesWebGL=function(La,Lb,Lc){this.ctx.drawLines(La+this.x+Lc[0],Lb+this.y+Lc[1],Lc[2],Lc[3],Lc[4])},this._drawCurves=function(La,Lb,Lc){this.ctx.drawCurves(La,Lb,Lc)},this._draw=function(La,Lb,Lc){Lc[0].call(null,this,La,Lb)},this._transformByMatrix=function(La,Lb,Lc){this.ctx.transformByMatrix(Lc[0])},this._setTransform=function(La,Lb,Lc){this.ctx.setTransform(Lc[0],Lc[1],Lc[2],Lc[3],Lc[4],Lc[5])},this._setTransformByMatrix=function(La,Lb,Lc){this.ctx.setTransformByMatrix(Lc[0])},this._save=function(La,Lb,Lc){this.ctx.save()},this._restore=function(La,Lb,Lc){this.ctx.restore()},this._translate=function(La,Lb,Lc){this.ctx.translate(Lc[0],Lc[1])},this._transform=function(La,Lb,Lc){this.ctx.translate(Lc[1]+La,Lc[2]+Lb);var Ld=Lc[0];this.ctx.transform(Ld.a,Ld.b,Ld.c,Ld.d,Ld.tx,Ld.ty),this.ctx.translate(-La-Lc[1],-Lb-Lc[2])},this._rotate=function(La,Lb,Lc){this.ctx.translate(Lc[1]+La,Lc[2]+Lb),this.ctx.rotate(Lc[0]),this.ctx.translate(-La-Lc[1],-Lb-Lc[2])},this._scale=function(La,Lb,Lc){this.ctx.translate(Lc[2]+La,Lc[3]+Lb),this.ctx.scale(Lc[0],Lc[1]),this.ctx.translate(-La-Lc[2],-Lb-Lc[3])},this._alpha=function(La,Lb,Lc){this.ctx.globalAlpha*=Lc[0]},this._setAlpha=function(La,Lb,Lc){this.ctx.globalAlpha=Lc[0]},this._fillText=function(La,Lb,Lc){this.ctx.fillText(Lc[0],Lc[1]+La,Lc[2]+Lb,Lc[3],Lc[4],Lc[5])},this._strokeText=function(La,Lb,Lc){this.ctx.strokeText(Lc[0],Lc[1]+La,Lc[2]+Lb,Lc[3],Lc[4],Lc[5],Lc[6])},this._fillBorderText=function(La,Lb,Lc){this.ctx.fillBorderText(Lc[0],Lc[1]+La,Lc[2]+Lb,Lc[3],Lc[4],Lc[5],Lc[6],Lc[7])},this._blendMode=function(La,Lb,Lc){this.ctx.globalCompositeOperation=Lc[0]},this._beginClip=function(La,Lb,Lc){this.ctx.beginClip&&this.ctx.beginClip(La+Lc[0],Lb+Lc[1],Lc[2],Lc[3])},this._setIBVB=function(La,Lb,Lc){this.ctx.setIBVB(Lc[0]+La,Lc[1]+Lb,Lc[2],Lc[3],Lc[4],Lc[5],Lc[6],Lc[7])},this._fillTrangles=function(La,Lb,Lc){this.ctx.fillTrangles(Lc[0],Lc[1]+La,Lc[2]+Lb,Lc[3],Lc[4])},this._drawPath=function(La,Lb,Lc){var Ld=this.ctx;LJ.isWebGL&&Ld.setPathId(-1),Ld.beginPath(),La+=Lc[0],Lb+=Lc[1],LJ.isWebGL&&Ld.movePath(La,Lb);for(var Le=Lc[2],Lf=0,Lg=Le.length;Lf<Lg;Lf++){var Lh=Le[Lf];switch(Lh[0]){case"moveTo":LJ.isWebGL?Ld.moveTo(Lh[1],Lh[2]):Ld.moveTo(La+Lh[1],Lb+Lh[2]);break;case"lineTo":LJ.isWebGL?Ld.lineTo(Lh[1],Lh[2]):Ld.lineTo(La+Lh[1],Lb+Lh[2]);break;case"arcTo":LJ.isWebGL?Ld.arcTo(Lh[1],Lh[2],Lh[3],Lh[4],Lh[5]):Ld.arcTo(La+Lh[1],Lb+Lh[2],La+Lh[3],Lb+Lh[4],Lh[5]);break;case"closePath":Ld.closePath()}}var Li=Lc[3];null!=Li&&(Ld.fillStyle=Li.fillStyle,Ld.fill());var Lj=Lc[4];null!=Lj&&(Ld.strokeStyle=Lj.strokeStyle,Ld.lineWidth=Lj.lineWidth||1,Ld.lineJoin=Lj.lineJoin,Ld.lineCap=Lj.lineCap,Ld.miterLimit=Lj.miterLimit,Ld.stroke())},this.drawPoly=function(La,Lb,Lc){this.ctx.drawPoly(La+this.x+Lc[0],Lb+this.y+Lc[1],Lc[2],Lc[3],Lc[4],Lc[5],Lc[6])},this._drawPoly=function(La,Lb,Lc){var Ld=this.ctx,Le=Lc[2],Lf=2,Lg=Le.length;if(LJ.isWebGL)for(Ld.setPathId(Lc[6]),Ld.beginPath(),La+=Lc[0],Lb+=Lc[1],Ld.movePath(La,Lb),Ld.moveTo(Le[0],Le[1]);Lf<Lg;)Ld.lineTo(Le[Lf++],Le[Lf++]);else for(Ld.beginPath(),La+=Lc[0],Lb+=Lc[1],Ld.moveTo(La+Le[0],Lb+Le[1]);Lf<Lg;)Ld.lineTo(La+Le[Lf++],Lb+Le[Lf++]);Ld.closePath(),this._fillAndStroke(Lc[3],Lc[4],Lc[5],Lc[7])},this._drawSkin=function(La,Lb,Lc){var Ld=Lc[0];if(Ld){var Le=this.ctx;Ld.render(Le,La,Lb)}},this._drawParticle=function(La,Lb,Lc){this.ctx.drawParticle(La+this.x,Lb+this.y,Lc[0])},this._setFilters=function(La,Lb,Lc){this.ctx.setFilters(Lc)},Lc?this.ctx=Lc.getContext("2d"):(Lc=Lta.create("3D"),this.ctx=LF.createWebGLContext2D(Lc),Lc._setContext(this.ctx)),Lc.size(La,Lb),this.canvas=Lc}Lq(Lg,"laya.renders.RenderContext");var La=Lg.prototype;return La.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},La.drawTexture=function(La,Lb,Lc,Ld,Le){La.loaded&&this.ctx.drawTexture(La,Lb,Lc,Ld,Le,this.x,this.y)},La._drawTextures=function(La,Lb,Lc){Lc[0].loaded&&this.ctx.drawTextures(Lc[0],Lc[1],La+this.x,Lb+this.y)},La.drawTextureWithTransform=function(La,Lb,Lc,Ld,Le,Lf,Lg){La.loaded&&this.ctx.drawTextureWithTransform(La,Lb,Lc,Ld,Le,Lf,this.x,this.y,Lg)},La.fillQuadrangle=function(La,Lb,Lc,Ld,Le){this.ctx.fillQuadrangle(La,Lb,Lc,Ld,Le)},La.drawCanvas=function(La,Lb,Lc,Ld,Le){this.ctx.drawCanvas(La,Lb+this.x,Lc+this.y,Ld,Le)},La.drawRect=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=1);var Lg=this.ctx;Lg.strokeStyle=Le,Lg.lineWidth=Lf,Lg.strokeRect(La+this.x,Lb+this.y,Lc,Ld,Lf)},La._fillAndStroke=function(La,Lb,Lc,Ld){void 0===Ld&&(Ld=!1);var Le=this.ctx;null!=La&&(Le.fillStyle=La,LJ.isWebGL?Le.fill(Ld):Le.fill()),null!=Lb&&0<Lc&&(Le.strokeStyle=Lb,Le.lineWidth=Lc,Le.stroke())},La.clipRect=function(La,Lb,Lc,Ld){this.ctx.clipRect(La+this.x,Lb+this.y,Lc,Ld)},La.fillRect=function(La,Lb,Lc,Ld,Le){this.ctx.fillRect(La+this.x,Lb+this.y,Lc,Ld,Le)},La.drawCircle=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=1),LX.drawCall++;var Lf=this.ctx;Lf.beginPath(),Lf.strokeStyle=Ld,Lf.lineWidth=Le,Lf.arc(La+this.x,Lb+this.y,Lc,0,Lg.PI2),Lf.stroke()},La.drawTriangles=function(La,Lb,Lc){if(LJ.isWebGL)this.ctx.drawTriangles(Lc[0],La+Lc[1],Lb+Lc[2],Lc[3],Lc[4],Lc[5],Lc[6],Lc[7],Lc[8],Lc[9]);else{var Ld=Lc[5],Le=0,Lf=Ld.length,Lg=this.ctx;for(Le=0;Le<Lf;Le+=3){var Lh=2*Ld[Le],Li=2*Ld[Le+1],Lj=2*Ld[Le+2];Lg.drawTriangle(Lc[0],Lc[3],Lc[4],Lh,Li,Lj,Lc[6],!0)}}},La.fillCircle=function(La,Lb,Lc,Ld){LX.drawCall++;var Le=this.ctx;Le.beginPath(),Le.fillStyle=Ld,Le.arc(La+this.x,Lb+this.y,Lc,0,Lg.PI2),Le.fill()},La.setShader=function(La){this.ctx.setShader(La)},La.drawLine=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=1);var Lg=this.ctx;Lg.beginPath(),Lg.strokeStyle=Le,Lg.lineWidth=Lf,Lg.moveTo(this.x+La,this.y+Lb),Lg.lineTo(this.x+Lc,this.y+Ld),Lg.stroke()},La.clear=function(){this.ctx.clear()},La.transformByMatrix=function(La){this.ctx.transformByMatrix(La)},La.setTransform=function(La,Lb,Lc,Ld,Le,Lf){this.ctx.setTransform(La,Lb,Lc,Ld,Le,Lf)},La.setTransformByMatrix=function(La){this.ctx.setTransformByMatrix(La)},La.save=function(){this.ctx.save()},La.restore=function(){this.ctx.restore()},La.translate=function(La,Lb){this.ctx.translate(La,Lb)},La.transform=function(La,Lb,Lc,Ld,Le,Lf){this.ctx.transform(La,Lb,Lc,Ld,Le,Lf)},La.rotate=function(La){this.ctx.rotate(La)},La.scale=function(La,Lb){this.ctx.scale(La,Lb)},La.alpha=function(La){this.ctx.globalAlpha*=La},La.setAlpha=function(La){this.ctx.globalAlpha=La},La.fillWords=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lf&&(Lf=0),this.ctx.fillWords(La,Lb,Lc,Ld,Le,Lf)},La.fillBorderWords=function(La,Lb,Lc,Ld,Le,Lf,Lg){this.ctx.fillBorderWords(La,Lb,Lc,Ld,Le,Lf,Lg)},La.fillText=function(La,Lb,Lc,Ld,Le,Lf){this.ctx.fillText(La,Lb+this.x,Lc+this.y,Ld,Le,Lf)},La.strokeText=function(La,Lb,Lc,Ld,Le,Lf,Lg){this.ctx.strokeText(La,Lb+this.x,Lc+this.y,Ld,Le,Lf,Lg)},La.blendMode=function(La){this.ctx.globalCompositeOperation=La},La.flush=function(){this.ctx.flush&&this.ctx.flush()},La.addRenderObject=function(La){this.ctx.addRenderObject(La)},La.beginClip=function(La,Lb,Lc,Ld){this.ctx.beginClip&&this.ctx.beginClip(La,Lb,Lc,Ld)},La.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},La.fillTrangles=function(La,Lb,Lc){this.ctx.fillTrangles(Lc[0],Lc[1],Lc[2],Lc[3],4<Lc.length?Lc[4]:null)},Lg.PI2=2*Math.PI,Lg}(),LL=function(){function Lg(La,Lb){switch(this._next=Lb||Lg.NORENDER,La){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=Lt._filter);case 69905:return void(this._fun=Lg._initRenderFun)}this.onCreate(La)}Lq(Lg,"laya.renders.RenderSprite");var La=Lg.prototype;return La.onCreate=function(La){},La._style=function(La,Lb,Lc,Ld){La._style.render(La,Lb,Lc,Ld);var Le=this._next;Le._fun.call(Le,La,Lb,Lc,Ld)},La._no=function(La,Lb,Lc,Ld){},La._custom=function(La,Lb,Lc,Ld){La.customRender(Lb,Lc,Ld);var Le=La._style._tf;this._next._fun.call(this._next,La,Lb,Lc-Le.translateX,Ld-Le.translateY)},La._clip=function(La,Lb,Lc,Ld){var Le=this._next;if(Le!=Lg.NORENDER){var Lf=La._style.scrollRect;Lb.ctx.save(),Lb.ctx.clipRect(Lc,Ld,Lf.width,Lf.height),Le._fun.call(Le,La,Lb,Lc-Lf.x,Ld-Lf.y),Lb.ctx.restore()}},La._blend=function(La,Lb,Lc,Ld){var Le=La._style;Le.blendMode&&(Lb.ctx.globalCompositeOperation=Le.blendMode);var Lf=this._next;Lf._fun.call(Lf,La,Lb,Lc,Ld),Lb.ctx.globalCompositeOperation="source-over"},La._mask=function(La,Lb,Lc,Ld){var Le=this._next;Le._fun.call(Le,La,Lb,Lc,Ld);var Lf=La.mask;Lf&&(Lb.ctx.globalCompositeOperation="destination-in",(0<Lf.numChildren||!Lf.graphics._isOnlyOne())&&(Lf.cacheAsBitmap=!0),Lf.render(Lb,Lc-La.pivotX,Ld-La.pivotY)),Lb.ctx.globalCompositeOperation="source-over"},La._graphics=function(La,Lb,Lc,Ld){var Le=La._style._tf;La._graphics&&La._graphics._render(La,Lb,Lc-Le.translateX,Ld-Le.translateY);var Lf=this._next;Lf._fun.call(Lf,La,Lb,Lc,Ld)},La._image=function(La,Lb,Lc,Ld){var Le=La._style;Lb.ctx.drawTexture2(Lc,Ld,Le._tf.translateX,Le._tf.translateY,La.transform,Le.alpha,Le.blendMode,La._graphics._one)},La._image2=function(La,Lb,Lc,Ld){var Le=La._style._tf;Lb.ctx.drawTexture2(Lc,Ld,Le.translateX,Le.translateY,La.transform,1,null,La._graphics._one)},La._alpha=function(La,Lb,Lc,Ld){var Le;if(.01<(Le=La._style.alpha)||La._needRepaint()){var Lf=Lb.ctx.globalAlpha;Lb.ctx.globalAlpha*=Le;var Lg=this._next;Lg._fun.call(Lg,La,Lb,Lc,Ld),Lb.ctx.globalAlpha=Lf}},La._transform=function(La,Lb,Lc,Ld){var Le=La.transform,Lf=this._next;Le&&Lf!=Lg.NORENDER?(Lb.save(),Lb.transform(Le.a,Le.b,Le.c,Le.d,Le.tx+Lc,Le.ty+Ld),Lf._fun.call(Lf,La,Lb,0,0),Lb.restore()):Lf._fun.call(Lf,La,Lb,Lc,Ld)},La._childs=function(La,Lb,Lc,Ld){var Le=La._style,Lf=Le._tf;if(Lc=Lc-Lf.translateX+Le.paddingLeft,Ld=Ld-Lf.translateY+Le.paddingTop,Le._calculation){var Lg=La._getWords();if(Lg){var Lh=Le;Lh&&(Lh.stroke?Lb.fillBorderWords(Lg,Lc,Ld,Lh.font,Lh.color,Lh.strokeColor,Lh.stroke):Lb.fillWords(Lg,Lc,Ld,Lh.font,Lh.color,"none"!=Lh.textDecoration&&Lh.underLine?1:0))}}var Li,Lj=La._childs,Lk=Lj.length;if(La.viewport||La.optimizeScrollRect&&La._style.scrollRect){var Ll=La.viewport||La._style.scrollRect,Lm=Ll.x,Ln=Ll.y,Lo=Ll.right,Lp=Ll.bottom,Lq=NaN,Lr=NaN;for(Ls=0;Ls<Lk;++Ls)(Li=Lj[Ls]).visible&&(Lq=Li._x)<Lo&&Lq+Li.width>Lm&&(Lr=Li._y)<Lp&&Lr+Li.height>Ln&&Li.render(Lb,Lc,Ld)}else for(var Ls=0;Ls<Lk;++Ls)(Li=Lj[Ls])._style.visible&&Li.render(Lb,Lc,Ld)},La._canvas=function(La,Lb,Lc,Ld){var Le=La._$P.cacheCanvas;if(Le){"bitmap"===Le.type?LX.canvasBitmap++:LX.canvasNormal++;var Lf=Le.ctx;if(La._needRepaint()||!Lf)this._canvas_repaint(La,Lb,Lc,Ld);else{var Lg=Le._cacheRec;Lb.drawCanvas(Lf.canvas,Lc+Lg.x,Ld+Lg.y,Lg.width,Lg.height)}}else this._next._fun.call(this._next,La,Lb,Lc,Ld)},La._canvas_repaint=function(La,Lb,Lc,Ld){var Le=La._$P.cacheCanvas,Lf=this._next;if(Le){var Lg,Lh,Li,Lj,Lk=Le.ctx,Ll=La._needRepaint()||!Lk,Lm=Le.type;if("bitmap"===Lm?LX.canvasBitmap++:LX.canvasNormal++,Ll){var Ln,Lo;Le._cacheRec||(Le._cacheRec=new LB),LJ.isWebGL&&"bitmap"!==Lm?Le._cacheRec.setTo(-La.pivotX,-La.pivotY,1,1):((Lj=La.getSelfBounds()).x=Lj.x-La.pivotX,Lj.y=Lj.y-La.pivotY,Lj.x=Lj.x-16,Lj.y=Lj.y-16,Lj.width=Lj.width+32,Lj.height=Lj.height+32,Lj.x=Math.floor(Lj.x+Lc)-Lc,Lj.y=Math.floor(Lj.y+Ld)-Ld,Lj.width=Math.floor(Lj.width),Lj.height=Math.floor(Lj.height),Le._cacheRec.copyFrom(Lj)),Lj=Le._cacheRec;var Lp,Lq=LJ.isWebGL?1:LO.pixelRatio*Lz.stage.clientScaleX,Lr=LJ.isWebGL?1:LO.pixelRatio*Lz.stage.clientScaleY;if(!LJ.isWebGL){var Ls,Lt=1,Lu=1;for(Ls=La;Ls&&Ls!=Lz.stage;)Lt*=Ls.scaleX,Lu*=Ls.scaleY,Ls=Ls.parent;LJ.isWebGL?(Lt<1&&(Lq*=Lt),Lu<1&&(Lr*=Lu)):(1<Lt&&(Lq*=Lt),1<Lu&&(Lr*=Lu))}if(La.scrollRect){var Lv=La.scrollRect;Lj.x-=Lv.x,Lj.y-=Lv.y}if(Ln=Lj.width*Lq,Lo=Lj.height*Lr,Lh=Lj.x,Li=Lj.y,LJ.isWebGL&&"bitmap"===Lm&&(2048<Ln||2048<Lo))return console.warn("cache bitmap size larger than 2048,cache ignored"),Le.ctx&&(LW.recover("RenderContext",Le.ctx),Le.ctx.canvas.size(0,0),Le.ctx=null),void Lf._fun.call(Lf,La,Lb,Lc,Ld);if(Lk||(Lk=Le.ctx=LW.getItem("RenderContext")||new LK(Ln,Lo,Lta.create("AUTO"))),Lk.ctx.sprite=La,(Lg=Lk.canvas).clear(),(Lg.width!=Ln||Lg.height!=Lo)&&Lg.size(Ln,Lo),"bitmap"===Lm?Lg.context.asBitmap=!0:"normal"===Lm&&(Lg.context.asBitmap=!1),1!=Lq||1!=Lr){var Ly=Lk.ctx;Ly.save(),Ly.scale(Lq,Lr),!LJ.isConchWebGL&&LJ.isConchApp&&(Lp=La._$P.cf)&&Ly.setFilterMatrix&&Ly.setFilterMatrix(Lp._mat,Lp._alpha),Lf._fun.call(Lf,La,Lk,-Lh,-Li),Ly.restore(),LJ.isConchApp&&!LJ.isConchWebGL||La._applyFilters()}else Ly=Lk.ctx,!LJ.isConchWebGL&&LJ.isConchApp&&(Lp=La._$P.cf)&&Ly.setFilterMatrix&&Ly.setFilterMatrix(Lp._mat,Lp._alpha),Lf._fun.call(Lf,La,Lk,-Lh,-Li),LJ.isConchApp&&!LJ.isConchWebGL||La._applyFilters();La._$P.staticCache&&(Le.reCache=!1),LX.canvasReCache++}else Lh=(Lj=Le._cacheRec).x,Li=Lj.y,Lg=Lk.canvas;Lb.drawCanvas(Lg,Lc+Lh,Ld+Li,Lj.width,Lj.height)}else Lf._fun.call(Lf,La,Lk,Lc,Ld)},Lg.__init__=function(){var La,Lb,Lc=0;for(Lb=LF.createRenderSprite(69905,null),La=Lg.renders.length=4096,Lc=0;Lc<La;Lc++)Lg.renders[Lc]=Lb;Lg.renders[0]=LF.createRenderSprite(0,null),function(La,Lb){for(var Lc=0,Ld=0;Ld<La.length;Ld++)Lc|=La[Ld],Lg.renders[Lc]=Lb}([1,512,4,2],new Lg(1,null)),Lg.renders[513]=LF.createRenderSprite(513,null),Lg.renders[517]=new Lg(517,null)},Lg._initRenderFun=function(La,Lb,Lc,Ld){var Le=La._renderType;(Lg.renders[Le]=Lg._getTypeRender(Le))._fun(La,Lb,Lc,Ld)},Lg._getTypeRender=function(La){for(var Lb=null,Lc=2048;1<Lc;)Lc&La&&(Lb=LF.createRenderSprite(Lc,Lb)),Lc>>=1;return Lb},Lg.IMAGE=1,Lg.ALPHA=2,Lg.TRANSFORM=4,Lg.BLEND=8,Lg.CANVAS=16,Lg.FILTERS=32,Lg.MASK=64,Lg.CLIP=128,Lg.STYLE=256,Lg.GRAPHICS=512,Lg.CUSTOM=1024,Lg.CHILDS=2048,Lg.INIT=69905,Lg.renders=[],Lg.NORENDER=new Lg(0,null),Lg}(),LM=function(){function Lh(){this._repaint=!1}Lq(Lh,"laya.resource.Context");var La=Lh.prototype;return La.replaceReset=function(){var La,Lb,Lc=0;for(La=Lh.replaceKeys.length,Lc=0;Lc<La;Lc++)Lb=Lh.replaceKeys[Lc],this[Lh.newKeys[Lc]]=this[Lb]},La.replaceResotre=function(){this.__restore(),this.__reset()},La.setIsMainContext=function(){},La.drawTextures=function(La,Lb,Lc,Ld){LX.drawCall+=Lb.length/2;for(var Le=La.width,Lf=La.height,Lg=0,Lh=Lb.length;Lg<Lh;Lg+=2)this.drawTexture(La,Lb[Lg],Lb[Lg+1],Le,Lf,Lc,Ld)},La.drawCanvas=function(La,Lb,Lc,Ld,Le){LX.drawCall++,this.drawImage(La.source,Lb,Lc,Ld,Le)},La.fillRect=function(La,Lb,Lc,Ld,Le){LX.drawCall++,Le&&(this.fillStyle=Le),this.__fillRect(La,Lb,Lc,Ld)},La.fillText=function(La,Lb,Lc,Ld,Le,Lf){LX.drawCall++,3<arguments.length&&null!=Ld&&(this.font=Ld,this.fillStyle=Le,this.textAlign=Lf,this.textBaseline="top"),this.__fillText(La,Lb,Lc)},La.fillBorderText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){LX.drawCall++,this.font=Ld,this.fillStyle=Le,this.textBaseline="top",this.strokeStyle=Lf,this.lineWidth=Lg,this.textAlign=Lh,this.__strokeText(La,Lb,Lc),this.__fillText(La,Lb,Lc)},La.strokeText=function(La,Lb,Lc,Ld,Le,Lf,Lg){LX.drawCall++,3<arguments.length&&null!=Ld&&(this.font=Ld,this.strokeStyle=Le,this.lineWidth=Lf,this.textAlign=Lg,this.textBaseline="top"),this.__strokeText(La,Lb,Lc)},La.transformByMatrix=function(La){this.transform(La.a,La.b,La.c,La.d,La.tx,La.ty)},La.setTransformByMatrix=function(La){this.setTransform(La.a,La.b,La.c,La.d,La.tx,La.ty)},La.clipRect=function(La,Lb,Lc,Ld){LX.drawCall++,this.beginPath(),this.rect(La,Lb,Lc,Ld),this.clip()},La.drawTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){LX.drawCall++;var Lh=La.uv,Li=La.bitmap.width,Lj=La.bitmap.height;this.drawImage(La.source,Lh[0]*Li,Lh[1]*Lj,(Lh[2]-Lh[0])*Li,(Lh[5]-Lh[3])*Lj,Lb+Lf,Lc+Lg,Ld,Le)},La.drawTextureWithTransform=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){LX.drawCall++;var Lj=La.uv,Lk=La.bitmap.width,Ll=La.bitmap.height;this.save(),1!=Li&&(this.globalAlpha*=Li),Lf?(this.transform(Lf.a,Lf.b,Lf.c,Lf.d,Lf.tx+Lg,Lf.ty+Lh),this.drawImage(La.source,Lj[0]*Lk,Lj[1]*Ll,(Lj[2]-Lj[0])*Lk,(Lj[5]-Lj[3])*Ll,Lb,Lc,Ld,Le)):this.drawImage(La.source,Lj[0]*Lk,Lj[1]*Ll,(Lj[2]-Lj[0])*Lk,(Lj[5]-Lj[3])*Ll,Lb+Lg,Lc+Lh,Ld,Le),this.restore()},La.drawTexture2=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=Lh[0];if(Li.loaded&&Li.bitmap&&Li.source){LX.drawCall++;var Lj=1!==Lf;if(Lj){var Lk=this.globalAlpha;this.globalAlpha*=Lf}var Ll=Li.uv,Lm=Li.bitmap.width,Ln=Li.bitmap.height;Le?(this.save(),this.transform(Le.a,Le.b,Le.c,Le.d,Le.tx+La,Le.ty+Lb),this.drawImage(Li.source,Ll[0]*Lm,Ll[1]*Ln,(Ll[2]-Ll[0])*Lm,(Ll[5]-Ll[3])*Ln,Lh[1]-Lc,Lh[2]-Ld,Lh[3],Lh[4]),this.restore()):this.drawImage(Li.source,Ll[0]*Lm,Ll[1]*Ln,(Ll[2]-Ll[0])*Lm,(Ll[5]-Ll[3])*Ln,Lh[1]-Lc+La,Lh[2]-Ld+Lb,Lh[3],Lh[4]),Lj&&(this.globalAlpha=Lk)}},La.fillTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){if(!Lh.pat){if(La.uv!=Lka.DEF_UV){var Li=new Lta("2D");Li.getContext("2d"),Li.size(La.width,La.height),Li.context.drawTexture(La,0,0,La.width,La.height,0,0),La=new Lka(Li)}Lh.pat=this.createPattern(La.bitmap.source,Lf)}var Lj=Lb,Lk=Lc,Ll=0,Lm=0;Lg&&(Lj+=Lg.x%La.width,Lk+=Lg.y%La.height,Ll-=Lg.x%La.width,Lm-=Lg.y%La.height),this.translate(Lj,Lk),this.fillRect(Ll,Lm,Ld,Le,Lh.pat),this.translate(-Lj,-Lk)},La.drawTriangle=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=La.bitmap,Lj=Li.source,Lk=La.width,Ll=La.height,Lm=Li.width,Ln=Li.height,Lo=Lc[Ld]*Lm,Lp=Lc[Le]*Lm,Lq=Lc[Lf]*Lm,Lr=Lc[Ld+1]*Ln,Ls=Lc[Le+1]*Ln,Lt=Lc[Lf+1]*Ln,Lu=Lb[Ld],Lv=Lb[Le],Ly=Lb[Lf],Lz=Lb[Ld+1],LA=Lb[Le+1],LB=Lb[Lf+1];if(Lh){var LC=(Lu+Lv+Ly)/3,LD=(Lz+LA+LB)/3,LE=Lu-LC,LF=Lz-LD,LG=Math.sqrt(LE*LE+LF*LF);Lu=LC+LE/LG*(LG+1),Lz=LD+LF/LG*(LG+1),LF=LA-LD,Lv=LC+(LE=Lv-LC)/(LG=Math.sqrt(LE*LE+LF*LF))*(LG+1),LA=LD+LF/LG*(LG+1),LF=LB-LD,Ly=LC+(LE=Ly-LC)/(LG=Math.sqrt(LE*LE+LF*LF))*(LG+1),LB=LD+LF/LG*(LG+1)}this.save(),Lg&&this.transform(Lg.a,Lg.b,Lg.c,Lg.d,Lg.tx,Lg.ty),this.beginPath(),this.moveTo(Lu,Lz),this.lineTo(Lv,LA),this.lineTo(Ly,LB),this.closePath(),this.clip();var LH=1/(Lo*Ls+Lr*Lq+Lp*Lt-Ls*Lq-Lr*Lp-Lo*Lt),LI=Lu*Ls+Lr*Ly+Lv*Lt-Ls*Ly-Lr*Lv-Lu*Lt,LJ=Lo*Lv+Lu*Lq+Lp*Ly-Lv*Lq-Lu*Lp-Lo*Ly,LK=Lo*Ls*Ly+Lr*Lv*Lq+Lu*Lp*Lt-Lu*Ls*Lq-Lr*Lp*Ly-Lo*Lv*Lt,LL=Lz*Ls+Lr*LB+LA*Lt-Ls*LB-Lr*LA-Lz*Lt,LM=Lo*LA+Lz*Lq+Lp*LB-LA*Lq-Lz*Lp-Lo*LB,LN=Lo*Ls*LB+Lr*LA*Lq+Lz*Lp*Lt-Lz*Ls*Lq-Lr*Lp*LB-Lo*LA*Lt;this.transform(LI*LH,LL*LH,LJ*LH,LM*LH,LK*LH,LN*LH),this.drawImage(Lj,La.uv[0]*Lm,La.uv[1]*Ln,Lk,Ll,La.uv[0]*Lm,La.uv[1]*Ln,Lk,Ll),this.restore()},La.flush=function(){return 0},La.fillWords=function(La,Lb,Lc,Ld,Le,Lf){Ld&&(this.font=Ld),Le&&(this.fillStyle=Le);this.textBaseline="top",this.textAlign="left";for(var Lg=0,Lh=La.length;Lg<Lh;Lg++){var Li=La[Lg];if(this.__fillText(Li.char,Li.x+Lb,Li.y+Lc),1===Lf){var Lj=Li.height,Lk=.5*Li.style.letterSpacing;Lk||(Lk=0),this.beginPath(),this.strokeStyle=Le,this.lineWidth=1,this.moveTo(Lb+Li.x-Lk+.5,Lc+Li.y+Lj+.5),this.lineTo(Lb+Li.x+Li.width+Lk+.5,Lc+Li.y+Lj+.5),this.stroke()}}},La.fillBorderWords=function(La,Lb,Lc,Ld,Le,Lf,Lg){Ld&&(this.font=Ld),Le&&(this.fillStyle=Le),this.textBaseline="top",this.lineWidth=Lg,this.textAlign="left",this.strokeStyle=Lf;for(var Lh=0,Li=La.length;Lh<Li;Lh++){var Lj=La[Lh];this.__strokeText(Lj.char,Lj.x+Lb,Lj.y+Lc),this.__fillText(Lj.char,Lj.x+Lb,Lj.y+Lc)}},La.destroy=function(){this.canvas.width=this.canvas.height=0},La.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},La.drawCurves=function(La,Lb,Lc){this.beginPath(),this.strokeStyle=Lc[3],this.lineWidth=Lc[4];var Ld=Lc[2];La+=Lc[0],Lb+=Lc[1],this.moveTo(La+Ld[0],Lb+Ld[1]);for(var Le=2,Lf=Ld.length;Le<Lf;)this.quadraticCurveTo(La+Ld[Le++],Lb+Ld[Le++],La+Ld[Le++],Lb+Ld[Le++]);this.stroke()},Lh.__init__=function(Lb){var Lc=laya.resource.Context.prototype;if(!(Lb=Lb||CanvasRenderingContext2D.prototype).inited){Lb.inited=!0,Lb.__fillText=Lb.fillText,Lb.__fillRect=Lb.fillRect,Lb.__strokeText=Lb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(La){Lb[La]=Lc[La]})}},Lh.replaceCanvasGetSet=function(La,Lb){var Lc=Object.getOwnPropertyDescriptor(La,Lb);if(!Lc||!Lc.configurable)return!1;var Ld,Le={};for(Ld in Lc)"set"!=Ld&&(Le[Ld]=Lc[Ld]);var Lf=Lc.set;return Le.set=function(La){Lf.call(this,La);var Lb=this.getContext("2d");Lb&&"__reset"in Lb&&Lb.__reset()},Object.defineProperty(La,Lb,Le),!0},Lh.replaceGetSet=function(La,Lb){var Lc=Object.getOwnPropertyDescriptor(La,Lb);if(!Lc||!Lc.configurable)return!1;var Ld,Le={};for(Ld in Lc)"set"!=Ld&&(Le[Ld]=Lc[Ld]);var Lf=Lc.set,Lg="___"+Lb+"__";return Lh.newKeys.push(Lg),Le.set=function(La){La!=this[Lg]&&(this[Lg]=La,Lf.call(this,La))},Object.defineProperty(La,Lb,Le),!0},Lh._default=new Lh,Lh.newKeys=[],Li(Lh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),Lh}(),LN=function(){function Lf(La){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Lf._uniqueIDCounter,this._name=La||"Content Manager",Lf._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Lf._resourceManagers.push(this),this._resources=[],this._records={}}Lq(Lf,"laya.resource.ResourceManager");var La=Lf.prototype;return Lz.imps(La,{"laya.resource.IDispose":!0}),La.getResourceByIndex=function(La){return this._resources[La]},La.getResourcesLength=function(){return this._resources.length},La.addResource=function(La){return La.resourceManager&&La.resourceManager.removeResource(La),-1===this._resources.indexOf(La)&&((La._resourceManager=this)._resources.push(La),this.addRecord(La.uri,La.__className,La.memorySize),this.addSize(La.memorySize),!0)},La.removeResource=function(La){var Lb=this._resources.indexOf(La);return-1!==Lb&&(this._resources.splice(Lb,1),La._resourceManager=null,this._memorySize-=La.memorySize,this.addRecord(La.uri,La.__className,-La.memorySize),!0)},La.unload=function(){for(var La=this._resources.slice(0,this._resources.length),Lb=0;Lb<La.length;Lb++){La[Lb].destroy()}La.length=0},La.dispose=function(){if(this===Lf._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Lf._resourceManagers.splice(Lf._resourceManagers.indexOf(this),1),Lf._isResourceManagersSorted=!1;for(var La=this._resources.slice(0,this._resources.length),Lb=0;Lb<La.length;Lb++){var Lc=La[Lb];Lc.resourceManager.removeResource(Lc),Lc.destroy()}La.length=0},La.addSize=function(La){La&&(this.autoRelease&&0<La&&this._memorySize+La>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=La)},La.addRecord=function(La,Lb,Lc){DEBUG&&Lc&&!La&&console.error(La,Lb,Lc)},La.garbageCollection=function(La){var Lb=this._resources;(Lb=Lb.slice()).sort(function(La,Lb){if(!La||!Lb)throw new Error("a或b不能为空！");return La.released&&Lb.released?0:La.released?1:Lb.released?-1:La._lastUseFrameCount-Lb._lastUseFrameCount});for(var Lc=LX.loopCount,Ld=0,Le=Lb.length;Ld<Le;Ld++){var Lf=Lb[Ld];if(!(1<Lc-Lf._lastUseFrameCount))return void(this._memorySize>=La&&(this._isOverflow=!0));if(Lf.releaseResource(),this._memorySize<La)return void(this._isOverflow=!1)}},Lk(0,La,"id",function(){return this._id}),Lk(0,La,"name",function(){return this._name},function(La){!La&&""===La||this._name===La||(this._name=La,Lf._isResourceManagersSorted=!1)}),Lk(0,La,"memorySize",function(){return this._memorySize}),Lk(0,La,"records",function(){return this._records}),Lk(1,Lf,"systemResourceManager",function(){return Lf._systemResourceManager}),Lf.__init__=function(){Lf.currentResourceManager=Lf.systemResourceManager},Lf.getLoadedResourceManagerByIndex=function(La){return Lf._resourceManagers[La]},Lf.getLoadedResourceManagersCount=function(){return Lf._resourceManagers.length},Lf.recreateContentManagers=function(La){void 0===La&&(La=!1);for(var Lb=Lf.currentResourceManager,Lc=0;Lc<Lf._resourceManagers.length;Lc++){Lf.currentResourceManager=Lf._resourceManagers[Lc];for(var Ld=0;Ld<Lf.currentResourceManager._resources.length;Ld++)Lf.currentResourceManager._resources[Ld].releaseResource(La),Lf.currentResourceManager._resources[Ld].activeResource(La)}Lf.currentResourceManager=Lb},Lf.releaseContentManagers=function(La){void 0===La&&(La=!1);for(var Lb=Lf.currentResourceManager,Lc=0;Lc<Lf._resourceManagers.length;Lc++){Lf.currentResourceManager=Lf._resourceManagers[Lc];for(var Ld=0;Ld<Lf.currentResourceManager._resources.length;Ld++){var Le=Lf.currentResourceManager._resources[Ld];!Le.released&&Le.releaseResource(La)}}Lf.currentResourceManager=Lb},Lf._uniqueIDCounter=0,Lf._isResourceManagersSorted=!1,Lf._resourceManagers=[],Li(Lf,["_systemResourceManager",function(){return this._systemResourceManager=new Lf("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Lf._systemResourceManager}]),Lf}(),LO=(function(){function La(){}Lq(La,"laya.system.System"),La.changeDefinition=function(La,Lb){Lz[La]=Lb;var Lc=La+"=classObj";Lz._runScript(Lc)},La.__init__=function(){LJ.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function Lc(){}return Lq(Lc,"laya.utils.Browser"),Lk(1,Lc,"pixelRatio",function(){return Lc.__init__(),-1<Lc.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:LF.getPixelRatio()}),Lk(1,Lc,"height",function(){return Lc.__init__(),(Lz.stage&&Lz.stage.canvasRotation?Lc.clientWidth:Lc.clientHeight)*Lc.pixelRatio}),Lk(1,Lc,"clientWidth",function(){return Lc.__init__(),Lc.window.innerWidth||Lc.document.body.clientWidth}),Lk(1,Lc,"window",function(){return Lc.__init__(),Lc._window}),Lk(1,Lc,"clientHeight",function(){return Lc.__init__(),Lc.window.innerHeight||Lc.document.body.clientHeight||Lc.document.documentElement.clientHeight}),Lk(1,Lc,"width",function(){return Lc.__init__(),(Lz.stage&&Lz.stage.canvasRotation?Lc.clientHeight:Lc.clientWidth)*Lc.pixelRatio}),Lk(1,Lc,"container",function(){return Lc.__init__(),Lc._container||((Lc._container=Lc.createElement("div")).id="layaContainer",Lc.document.body.appendChild(Lc._container)),Lc._container},function(La){Lc._container=La}),Lk(1,Lc,"document",function(){return Lc.__init__(),Lc._document}),Lc.__init__=function(){if(!Lc._window){Lc._window=LF.getWindow(),Lc._document=Lc.window.document,Lc._window.addEventListener("message",function(La){laya.utils.Browser._onMessage(La)},!1),Lc.document.__createElement=Lc.document.createElement,Ln.requestAnimationFrame=Ln.requestAnimationFrame||Ln.webkitRequestAnimationFrame||Ln.mozRequestAnimationFrame||Ln.oRequestAnimationFrame||Ln.msRequestAnimationFrame||function(La){return Ln.setTimeout(La,1e3/60)};var La=Ln.document.body.style;La["-webkit-user-select"]="none",La["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",Lc.userAgent=Lc.window.navigator.userAgent,Lc.onIOS=!!(Lc.u=Lc.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),Lc.onMobile=-1<Lc.u.indexOf("Mobile"),Lc.onIPhone=-1<Lc.u.indexOf("iPhone"),Lc.onMac=-1<Lc.u.indexOf("Mac OS X"),Lc.onIPad=-1<Lc.u.indexOf("iPad"),Lc.onAndroid=-1<Lc.u.indexOf("Android")||-1<Lc.u.indexOf("Adr"),Lc.onWP=-1<Lc.u.indexOf("Windows Phone"),Lc.onQQBrowser=-1<Lc.u.indexOf("QQBrowser"),Lc.onMQQBrowser=-1<Lc.u.indexOf("MQQBrowser")||-1<Lc.u.indexOf("Mobile")&&-1<Lc.u.indexOf("QQ"),Lc.onIE=!!Lc.window.ActiveXObject||"ActiveXObject"in Lc.window,Lc.onWeiXin=-1<Lc.u.indexOf("MicroMessenger"),Lc.onPC=!Lc.onMobile,Lc.onSafari=-1<Lc.u.indexOf("Safari"),Lc.onFirefox=-1<Lc.u.indexOf("Firefox"),Lc.onEdge=-1<Lc.u.indexOf("Edge"),Lc.onMiniGame=-1<Lc.u.indexOf("MiniGame"),Lc.onLimixiu=-1<Lc.u.indexOf("limixiu"),Lc.httpProtocol="http:"==Lc.window.location.protocol,Lc.onMiniGame&&null==Lc.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),Lc.webAudioEnabled=!!(Lc.window.AudioContext||Lc.window.webkitAudioContext||Lc.window.mozAudioContext),Lc.soundType=Lc.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",Lea=Lc.webAudioEnabled?Lfa:Lca,Lc.webAudioEnabled&&Lfa.initWebAudio(),Lca._initMusicAudio(),Lc.enableTouch="ontouchstart"in Ln||Ln.DocumentTouch&&Lb instanceof DocumentTouch,Ln.focus(),LE._soundClass=Lea,LE._musicClass=Lca,LJ._mainCanvas=LJ._mainCanvas||Lta.create("2D"),Lc.canvas||(Lc.canvas=Lta.create("2D"),Lc.context=Lc.canvas.getContext("2d"))}},Lc._onMessage=function(La){if(La.data&&"size"==La.data.name){if(Lc.window.innerWidth=La.data.width,Lc.window.innerHeight=La.data.height,Lc.window.__innerHeight=La.data.clientHeight,!Lc.document.createEvent)return void console.warn("no document.createEvent");var Lb=Lc.document.createEvent("HTMLEvents");return Lb.initEvent("resize",!1,!1),void Lc.window.dispatchEvent(Lb)}},Lc.createElement=function(La){return Lc.__init__(),Lc.document.__createElement(La)},Lc.getElementById=function(La){return Lc.__init__(),Lc.document.getElementById(La)},Lc.removeElement=function(La){La&&La.parentNode&&La.parentNode.removeChild(La)},Lc.now=function(){return LF.now()},Lc._window=null,Lc._document=null,Lc._container=null,Lc.userAgent=null,Lc.u=null,Lc.onIOS=!1,Lc.onMac=!1,Lc.onMobile=!1,Lc.onIPhone=!1,Lc.onIPad=!1,Lc.onAndroid=!1,Lc.onWP=!1,Lc.onQQBrowser=!1,Lc.onMQQBrowser=!1,Lc.onSafari=!1,Lc.onFirefox=!1,Lc.onEdge=!1,Lc.onIE=!1,Lc.onWeiXin=!1,Lc.onMiniGame=!1,Lc.onLimixiu=!1,Lc.onPC=!1,Lc.httpProtocol=!1,Lc.webAudioEnabled=!1,Lc.soundType=null,Lc.enableTouch=!1,Lc.canvas=null,Lc.context=null,Lc.__init$=function(){},Lc}()),LP=function(){function Lb(La){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,La?(this._u8d_=new Uint8Array(La),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Lq(Lb,"laya.utils.Byte");var La=Lb.prototype;return La.___resizeBuffer=function(Lb){try{var La=new Uint8Array(Lb);null!=this._u8d_&&(this._u8d_.length<=Lb?La.set(this._u8d_):La.set(this._u8d_.subarray(0,Lb))),this._u8d_=La,this._d_=new DataView(La.buffer)}catch(La){throw"___resizeBuffer err:"+Lb}},La.getString=function(){return this.rUTF(this.getUint16())},La.getFloat32Array=function(La,Lb){var Lc=La+Lb;Lc=Lc>this._length?this._length:Lc;var Ld=new Float32Array(this._d_.buffer.slice(La,Lc));return this._pos_=Lc,Ld},La.getUint8Array=function(La,Lb){var Lc=La+Lb;Lc=Lc>this._length?this._length:Lc;var Ld=new Uint8Array(this._d_.buffer.slice(La,Lc));return this._pos_=Lc,Ld},La.getInt16Array=function(La,Lb){var Lc=La+Lb;Lc=Lc>this._length?this._length:Lc;var Ld=new Int16Array(this._d_.buffer.slice(La,Lc));return this._pos_=Lc,Ld},La.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var La=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,La},La.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var La=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,La},La.writeFloat32=function(La){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,La,this._xd_),this._pos_+=4},La.writeFloat64=function(La){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,La,this._xd_),this._pos_+=8},La.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var La=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,La},La.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var La=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,La},La.writeInt32=function(La){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,La,this._xd_),this._pos_+=4},La.writeUint32=function(La){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,La,this._xd_),this._pos_+=4},La.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var La=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,La},La.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var La=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,La},La.writeUint16=function(La){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,La,this._xd_),this._pos_+=2},La.writeInt16=function(La){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,La,this._xd_),this._pos_+=2},La.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},La.writeUint8=function(La){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,La),this._pos_++},La._getUInt8=function(La){return this._d_.getUint8(La)},La._getUint16=function(La){return this._d_.getUint16(La,this._xd_)},La._getMatrix=function(){return new LG(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},La.rUTF=function(La){for(var Lb=[],Lc=this._pos_+La,Ld=0,Le=0,Lf=0,Lg=String.fromCharCode,Lh=this._u8d_;this._pos_<Lc;)(Ld=Lh[this._pos_++])<128?0!=Ld&&Lb.push(Lg(Ld)):Ld<224?Lb.push(Lg((63&Ld)<<6|127&Lh[this._pos_++])):Ld<240?(Le=Lh[this._pos_++],Lb.push(Lg((31&Ld)<<12|(127&Le)<<6|127&Lh[this._pos_++]))):(Le=Lh[this._pos_++],Lf=Lh[this._pos_++],Lb.push(Lg((15&Ld)<<18|(127&Le)<<12|Lf<<6&127|127&Lh[this._pos_++]))),0;return Lb.join("")},La.getCustomString=function(La){for(var Lb=[],Lc=0,Ld=0,Le=0,Lf=String.fromCharCode,Lg=this._u8d_;0<La;)if((Ld=Lg[this._pos_])<128)Lb.push(Lf(Ld)),this._pos_++,La--;else for(Lc=Ld-128,this._pos_++,La-=Lc;0<Lc;)Ld=Lg[this._pos_++],Le=Lg[this._pos_++],Lb.push(Lf(Le<<8|Ld)),Lc--;return Lb.join("")},La.clear=function(){this._pos_=0,this.length=0},La.__getBuffer=function(){return this._d_.buffer},La.writeUTFBytes=function(La){for(var Lb=0,Lc=(La+="").length;Lb<Lc;Lb++){var Ld=La.charCodeAt(Lb);Ld<=127?this.writeByte(Ld):Ld<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Ld>>6,128|63&Ld],this._pos_),this._pos_+=2):Ld<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Ld>>12,128|Ld>>6&63,128|63&Ld],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Ld>>18,128|Ld>>12&63,128|Ld>>6&63,128|63&Ld],this._pos_),this._pos_+=4)}},La.writeUTFString=function(La){var Lb=this.pos;this.writeUint16(1),this.writeUTFBytes(La);var Lc=this.pos-Lb-2;if(65536<=Lc)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Lb,Lc,this._xd_)},La.readUTFString=function(){return this.readUTFBytes(this.getUint16())},La.getUTFString=function(){return this.readUTFString()},La.readUTFBytes=function(La){if(void 0===La&&(La=-1),0==La)return"";var Lb=this.bytesAvailable;if(Lb<La)throw"readUTFBytes error - Out of bounds";return La=0<La?La:Lb,this.rUTF(La)},La.getUTFBytes=function(La){return void 0===La&&(La=-1),this.readUTFBytes(La)},La.writeByte=function(La){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,La),this._pos_+=1},La.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},La.getByte=function(){return this.readByte()},La.ensureWrite=function(La){this._length<La&&(this._length=La),this._allocated_<La&&(this.length=La)},La.writeArrayBuffer=function(La,Lb,Lc){if(void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),Lb<0||Lc<0)throw"writeArrayBuffer error - Out of bounds";0==Lc&&(Lc=La.byteLength-Lb),this.ensureWrite(this._pos_+Lc);var Ld=new Uint8Array(La);this._u8d_.set(Ld.subarray(Lb,Lb+Lc),this._pos_),this._pos_+=Lc},Lk(0,La,"buffer",function(){var La=this._d_.buffer;return La.byteLength==this.length?La:La.slice(0,this.length)}),Lk(0,La,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(La){this._xd_="littleEndian"==La}),Lk(0,La,"length",function(){return this._length},function(La){this._allocated_<La?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(La,2*this._allocated_))):this._allocated_>La&&this.___resizeBuffer(this._allocated_=La),this._length=La}),Lk(0,La,"pos",function(){return this._pos_},function(La){this._pos_=La}),Lk(0,La,"bytesAvailable",function(){return this._length-this._pos_}),Lb.getSystemEndian=function(){if(!Lb._sysEndian){var La=new ArrayBuffer(2);new DataView(La).setInt16(0,256,!0),Lb._sysEndian=256===new Int16Array(La)[0]?"littleEndian":"bigEndian"}return Lb._sysEndian},Lb.BIG_ENDIAN="bigEndian",Lb.LITTLE_ENDIAN="littleEndian",Lb._sysEndian=null,Lb}(),LQ=function(){function Le(){}return Lq(Le,"laya.utils.CacheManager"),Le.regCacheByFunction=function(La,Lb){var Lc;Le.unRegCacheByFunction(La,Lb),Lc={tryDispose:La,getCacheList:Lb},Le._cacheList.push(Lc)},Le.unRegCacheByFunction=function(La,Lb){var Lc,Ld=0;for(Lc=Le._cacheList.length,Ld=0;Ld<Lc;Ld++)if(Le._cacheList[Ld].tryDispose==La&&Le._cacheList[Ld].getCacheList==Lb)return void Le._cacheList.splice(Ld,1)},Le.forceDispose=function(){var La=0,Lb=Le._cacheList.length;for(La=0;La<Lb;La++)Le._cacheList[La].tryDispose(!0)},Le.beginCheck=function(La){void 0===La&&(La=15e3),Lz.timer.loop(La,null,Le._checkLoop)},Le.stopCheck=function(){Lz.timer.clear(null,Le._checkLoop)},Le._checkLoop=function(){var La=Le._cacheList;if(!(La.length<1)){var Lb,Lc=LO.now(),Ld=0;for(Lb=Ld=La.length;0<Ld&&(La[Le._index=++Le._index%Lb].tryDispose(!1),!(LO.now()-Lc>Le.loopTimeLimit));)Ld--}},Le.loopTimeLimit=2,Le._cacheList=[],Le._index=0,Le}(),LR=function(){function Ln(){}return Lq(Ln,"laya.utils.ClassUtils"),Ln.regClass=function(La,Lb){Ln._classMap[La]=Lb},Ln.getRegClass=function(La){return Ln._classMap[La]},Ln.getInstance=function(La){var Lb=Ln.getClass(La);return Lb?new Lb:(console.warn("[error] Undefined class:",La),null)},Ln.createByJson=function(La,Lb,Lc,Ld,Le){"string"==typeof La&&(La=JSON.parse(La));var Lf=La.props;if(!Lb&&!(Lb=Le?Le.runWith(La):Ln.getInstance(Lf.runtime||La.type)))return null;var Lg=La.child;if(Lg)for(var Lh=0,Li=Lg.length;Lh<Li;Lh++){var Lj=Lg[Lh];if("render"!==Lj.props.name&&"render"!==Lj.props.renderType||!Lb._$set_itemRender)if("Graphic"==Lj.type)Ln.addGraphicsToSprite(Lj,Lb);else if(Ln.isDrawType(Lj.type))Ln.addGraphicToSprite(Lj,Lb,!0);else{var Lk=Ln.createByJson(Lj,null,Lc,Ld,Le);"Script"==Lj.type?Lk.hasOwnProperty("owner")?Lk.owner=Lb:Lk.hasOwnProperty("target")&&(Lk.target=Lb):"mask"==Lj.props.renderType?Lb.mask=Lk:Lb.addChild(Lk)}else Lb.itemRender=Lj}if(Lf)for(var Ll in Lf){var Lm=Lf[Ll];"var"===Ll&&Lc?Lc[Lm]=Lb:Lm instanceof Array&&"function"==typeof Lb[Ll]?Lb[Ll].apply(Lb,Lm):Lb[Ll]=Lm}return Ld&&La.customProps&&Ld.runWith([Lb,La]),Lb.created&&Lb.created(),Lb},Ln.addGraphicsToSprite=function(La,Lb){var Lc;if((Lc=La.child)&&!(Lc.length<1)){var Ld;Ld=Ln._getGraphicsFromSprite(La,Lb);var Le=0,Lf=0;La.props&&(Le=Ln._getObjVar(La.props,"x",0),Lf=Ln._getObjVar(La.props,"y",0)),0!=Le&&0!=Lf&&Ld.translate(Le,Lf);var Lg,Lh=0;for(Lg=Lc.length,Lh=0;Lh<Lg;Lh++)Ln._addGraphicToGraphics(Lc[Lh],Ld);0!=Le&&0!=Lf&&Ld.translate(-Le,-Lf)}},Ln.addGraphicToSprite=function(La,Lb,Lc){var Ld;void 0===Lc&&(Lc=!1),Ld=Lc?Ln._getGraphicsFromSprite(La,Lb):Lb.graphics,Ln._addGraphicToGraphics(La,Ld)},Ln._getGraphicsFromSprite=function(La,Lb){var Lc,Ld;if(!La||!La.props)return Lb.graphics;switch(Ld=La.props.renderType){case"hit":case"unHit":var Le;Lb.hitArea||(Lb.hitArea=new LV),(Le=Lb.hitArea)[Ld]||(Le[Ld]=new Lm),Lc=Le[Ld]}return Lc||(Lc=Lb.graphics),Lc},Ln._getTransformData=function(La){var Lb;(La.hasOwnProperty("pivotX")||La.hasOwnProperty("pivotY"))&&(Lb=Lb||new LG).translate(-Ln._getObjVar(La,"pivotX",0),-Ln._getObjVar(La,"pivotY",0));var Lc=Ln._getObjVar(La,"scaleX",1),Ld=Ln._getObjVar(La,"scaleY",1),Le=Ln._getObjVar(La,"rotation",0);Ln._getObjVar(La,"skewX",0),Ln._getObjVar(La,"skewY",0);return 1==Lc&&1==Ld&&0==Le||((Lb=Lb||new LG).scale(Lc,Ld),Lb.rotate(.0174532922222222*Le)),Lb},Ln._addGraphicToGraphics=function(La,Lb){var Lc,Ld;if((Lc=La.props)&&(Ld=Ln.DrawTypeDic[La.type])){var Le,Lf;Le=Lb;var Lg=Ln._getParams(Lc,Ld[1],Ld[2],Ld[3]);((Lf=Ln._tM)||1!=Ln._alpha)&&(Le.save(),Lf&&Le.transform(Lf),1!=Ln._alpha&&Le.alpha(Ln._alpha)),Le[Ld[0]].apply(Le,Lg),(Lf||1!=Ln._alpha)&&Le.restore()}},Ln._adptLineData=function(La){return La[2]=parseFloat(La[0])+parseFloat(La[2]),La[3]=parseFloat(La[1])+parseFloat(La[3]),La},Ln._adptTextureData=function(La){return La[0]=Lha.getRes(La[0]),La},Ln._adptLinesData=function(La){return La[2]=Ln._getPointListByStr(La[2]),La},Ln.isDrawType=function(La){return"Image"!=La&&Ln.DrawTypeDic.hasOwnProperty(La)},Ln._getParams=function(La,Lb,Lc,Ld){var Le;void 0===Lc&&(Lc=0),(Le=Ln._temParam).length=Lb.length;var Lf,Lg,Lh=0;for(Lf=Lb.length,Lh=0;Lh<Lf;Lh++)Le[Lh]=Ln._getObjVar(La,Lb[Lh][0],Lb[Lh][1]);return Ln._alpha=Ln._getObjVar(La,"alpha",1),Lg=Ln._getTransformData(La),Ln._tM=Lg?(Lc||(Lc=0),Lg.translate(Le[Lc],Le[Lc+1]),Le[Lc]=Le[Lc+1]=0,Lg):null,Ld&&Ln[Ld]&&(Le=Ln[Ld](Le)),Le},Ln._getPointListByStr=function(La){var Lb,Lc,Ld=0;for(Lc=(Lb=La.split(",")).length,Ld=0;Ld<Lc;Ld++)Lb[Ld]=parseFloat(Lb[Ld]);return Lb},Ln._getObjVar=function(La,Lb,Lc){return La.hasOwnProperty(Lb)?La[Lb]:Lc},Ln._temParam=[],Ln._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Ln.getClass=function(La){var Lb=Ln._classMap[La]||La;return"string"==typeof Lb?Lz.__classmap[Lb]:Lb},Ln._tM=null,Ln._alpha=NaN,Li(Ln,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Ln}(),LS=function(){function Lf(La){if(this._color=[],"string"==typeof La){null===(this.strColor=La)&&(La="#000000"),"#"==La.charAt(0)&&(La=La.substr(1));var Lb=La.length;if(3==Lb||4==Lb){for(var Lc="",Ld=0;Ld<Lb;Ld++)Lc+=La[Ld]+La[Ld];La=Lc}var Le=this.numColor=parseInt(La,16);if(8==La.length)return void(this._color=[parseInt(La.substr(0,2),16)/255,((16711680&Le)>>16)/255,((65280&Le)>>8)/255,(255&Le)/255])}else Le=this.numColor=La,this.strColor=L$.toHexColor(Le);this._color=[((16711680&Le)>>16)/255,((65280&Le)>>8)/255,(255&Le)/255,1],this._color.__id=++Lf._COLODID}return Lq(Lf,"laya.utils.Color"),Lf._initDefault=function(){for(var La in Lf._DEFAULT={},Lf._COLOR_MAP)Lf._SAVE[La]=Lf._DEFAULT[La]=new Lf(Lf._COLOR_MAP[La]);return Lf._DEFAULT},Lf._initSaveMap=function(){for(var La in Lf._SAVE_SIZE=0,Lf._SAVE={},Lf._DEFAULT)Lf._SAVE[La]=Lf._DEFAULT[La]},Lf.create=function(La){var Lb=Lf._SAVE[La+""];return null!=Lb?Lb:(Lf._SAVE_SIZE<1e3||Lf._initSaveMap(),Lf._SAVE[La+""]=new Lf(La))},Lf._SAVE={},Lf._SAVE_SIZE=0,Lf._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Lf._DEFAULT=Lf._initDefault(),Lf._COLODID=1,Lf}(),LT=(function(){function La(){this._values=[],this._keys=[]}Lq(La,"laya.utils.Dictionary");var Lb=La.prototype;Lb.set=function(La,Lb){var Lc=this.indexOf(La);0<=Lc?this._values[Lc]=Lb:(this._keys.push(La),this._values.push(Lb))},Lb.indexOf=function(La){var Lb=this._keys.indexOf(La);return 0<=Lb?Lb:(La="string"==typeof La?Number(La):"number"==typeof La?La.toString():La,this._keys.indexOf(La))},Lb.get=function(La){var Lb=this.indexOf(La);return Lb<0?null:this._values[Lb]},Lb.remove=function(La){var Lb=this.indexOf(La);return 0<=Lb&&(this._keys.splice(Lb,1),this._values.splice(Lb,1),!0)},Lb.clear=function(){this._values.length=0,this._keys.length=0},Lk(0,Lb,"values",function(){return this._values}),Lk(0,Lb,"keys",function(){return this._keys})}(),function(){function La(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Lq(La,"laya.utils.Dragging");var Lb=La.prototype;return Lb.start=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){void 0===Lh&&(Lh=.92),this.clearTimer(),this.target=La,this.area=Lb,this.hasInertia=Lc,this.elasticDistance=Lb?Ld:0,this.elasticBackTime=Le,this.data=Lf,this._disableMouseEvent=Lg,this.ratio=Lh,1!=La.globalScaleX||1!=La.globalScaleY?this._parent=La.parent:this._parent=Lz.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Lz.stage.on("mouseup",this,this.onStageMouseUp),Lz.stage.on("mouseout",this,this.onStageMouseUp),Lz.timer.frameLoop(1,this,this.loop)},Lb.clearTimer=function(){Lz.timer.clear(this,this.loop),Lz.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Lb.stop=function(){this._dragging&&(Lp.instance.disableMouseEvent=!1,Lz.stage.off("mouseup",this,this.onStageMouseUp),Lz.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Lb.loop=function(){var La=this._parent.getMousePoint(),Lb=La.x,Lc=La.y,Ld=Lb-this._lastX,Le=Lc-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Ld*Lz.stage._canvasTransform.getScaleX())||1<Math.abs(Le*Lz.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),Lp.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Ld,Le);0==Ld&&0==Le||(this._lastX=Lb,this._lastY=Lc,this.target.x+=Ld*this._elasticRateX,this.target.y+=Le*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Lb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var La=this.area.x-this.target.x;else La=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-La/this.elasticDistance),this.target.y<this.area.y)var Lb=this.area.y-this.target.y;else Lb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Lb/this.elasticDistance)}},Lb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Lb.onStageMouseUp=function(La){if(Lp.instance.disableMouseEvent=!1,Lz.stage.off("mouseup",this,this.onStageMouseUp),Lz.stage.off("mouseout",this,this.onStageMouseUp),Lz.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Lb=this._offsets.length,Lc=Math.min(Lb,6),Ld=this._offsets.length-Lc,Le=Lb-1;Ld<Le;Le--)this._offsetY+=this._offsets[Le--],this._offsetX+=this._offsets[Le];this._offsetX=this._offsetX/Lc*2,this._offsetY=this._offsetY/Lc*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Lz.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Lb.checkElastic=function(){var La=NaN,Lb=NaN;if(this.target.x<this.area.x?La=this.area.x:this.target.x>this.area.x+this.area.width&&(La=this.area.x+this.area.width),this.target.y<this.area.y?Lb=this.area.y:this.target.y>this.area.y+this.area.height&&(Lb=this.area.y+this.area.height),isNaN(La)&&isNaN(Lb))this.clear();else{var Lc={};isNaN(La)||(Lc.x=La),isNaN(Lb)||(Lc.y=Lb),this._tween=LZ.to(this.target,Lc,this.elasticBackTime,LU.sineOut,Ls.create(this,this.clear),0,!1,!1)}},Lb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Lz.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Lb.clear=function(){if(this.target){this.clearTimer();var La=this.target;this.target=null,this._parent=null,La.event("dragend",this.data)}},La}()),LU=function(){function Lh(){}return Lq(Lh,"laya.utils.Ease"),Lh.linearNone=function(La,Lb,Lc,Ld){return Lc*La/Ld+Lb},Lh.linearIn=function(La,Lb,Lc,Ld){return Lc*La/Ld+Lb},Lh.linearInOut=function(La,Lb,Lc,Ld){return Lc*La/Ld+Lb},Lh.linearOut=function(La,Lb,Lc,Ld){return Lc*La/Ld+Lb},Lh.bounceIn=function(La,Lb,Lc,Ld){return Lc-Lh.bounceOut(Ld-La,0,Lc,Ld)+Lb},Lh.bounceInOut=function(La,Lb,Lc,Ld){return La<.5*Ld?.5*Lh.bounceIn(2*La,0,Lc,Ld)+Lb:.5*Lh.bounceOut(2*La-Ld,0,Lc,Ld)+.5*Lc+Lb},Lh.bounceOut=function(La,Lb,Lc,Ld){return(La/=Ld)<1/2.75?Lc*(7.5625*La*La)+Lb:La<2/2.75?Lc*(7.5625*(La-=1.5/2.75)*La+.75)+Lb:La<2.5/2.75?Lc*(7.5625*(La-=2.25/2.75)*La+.9375)+Lb:Lc*(7.5625*(La-=2.625/2.75)*La+.984375)+Lb},Lh.backIn=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=1.70158),Lc*(La/=Ld)*La*((Le+1)*La-Le)+Lb},Lh.backInOut=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=1.70158),(La/=.5*Ld)<1?.5*Lc*(La*La*((1+(Le*=1.525))*La-Le))+Lb:Lc/2*((La-=2)*La*((1+(Le*=1.525))*La+Le)+2)+Lb},Lh.backOut=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=1.70158),Lc*((La=La/Ld-1)*La*((Le+1)*La+Le)+1)+Lb},Lh.elasticIn=function(La,Lb,Lc,Ld,Le,Lf){var Lg;return void 0===Le&&(Le=0),void 0===Lf&&(Lf=0),0==La?Lb:1==(La/=Ld)?Lb+Lc:(Lf||(Lf=.3*Ld),Lg=!Le||0<Lc&&Le<Lc||Lc<0&&Le<-Lc?(Le=Lc,Lf/4):Lf/Lh.PI2*Math.asin(Lc/Le),-Le*Math.pow(2,10*(La-=1))*Math.sin((La*Ld-Lg)*Lh.PI2/Lf)+Lb)},Lh.elasticInOut=function(La,Lb,Lc,Ld,Le,Lf){var Lg;return void 0===Le&&(Le=0),void 0===Lf&&(Lf=0),0==La?Lb:2==(La/=.5*Ld)?Lb+Lc:(Lf||(Lf=Ld*(.3*1.5)),Lg=!Le||0<Lc&&Le<Lc||Lc<0&&Le<-Lc?(Le=Lc,Lf/4):Lf/Lh.PI2*Math.asin(Lc/Le),La<1?Le*Math.pow(2,10*(La-=1))*Math.sin((La*Ld-Lg)*Lh.PI2/Lf)*-.5+Lb:Le*Math.pow(2,-10*(La-=1))*Math.sin((La*Ld-Lg)*Lh.PI2/Lf)*.5+Lc+Lb)},Lh.elasticOut=function(La,Lb,Lc,Ld,Le,Lf){var Lg;return void 0===Le&&(Le=0),void 0===Lf&&(Lf=0),0==La?Lb:1==(La/=Ld)?Lb+Lc:(Lf||(Lf=.3*Ld),Lg=!Le||0<Lc&&Le<Lc||Lc<0&&Le<-Lc?(Le=Lc,Lf/4):Lf/Lh.PI2*Math.asin(Lc/Le),Le*Math.pow(2,-10*La)*Math.sin((La*Ld-Lg)*Lh.PI2/Lf)+Lc+Lb)},Lh.strongIn=function(La,Lb,Lc,Ld){return Lc*(La/=Ld)*La*La*La*La+Lb},Lh.strongInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*Lc*La*La*La*La*La+Lb:.5*Lc*((La-=2)*La*La*La*La+2)+Lb},Lh.strongOut=function(La,Lb,Lc,Ld){return Lc*((La=La/Ld-1)*La*La*La*La+1)+Lb},Lh.sineInOut=function(La,Lb,Lc,Ld){return.5*-Lc*(Math.cos(Math.PI*La/Ld)-1)+Lb},Lh.sineIn=function(La,Lb,Lc,Ld){return-Lc*Math.cos(La/Ld*Lh.HALF_PI)+Lc+Lb},Lh.sineOut=function(La,Lb,Lc,Ld){return Lc*Math.sin(La/Ld*Lh.HALF_PI)+Lb},Lh.quintIn=function(La,Lb,Lc,Ld){return Lc*(La/=Ld)*La*La*La*La+Lb},Lh.quintInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*Lc*La*La*La*La*La+Lb:.5*Lc*((La-=2)*La*La*La*La+2)+Lb},Lh.quintOut=function(La,Lb,Lc,Ld){return Lc*((La=La/Ld-1)*La*La*La*La+1)+Lb},Lh.quartIn=function(La,Lb,Lc,Ld){return Lc*(La/=Ld)*La*La*La+Lb},Lh.quartInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*Lc*La*La*La*La+Lb:.5*-Lc*((La-=2)*La*La*La-2)+Lb},Lh.quartOut=function(La,Lb,Lc,Ld){return-Lc*((La=La/Ld-1)*La*La*La-1)+Lb},Lh.cubicIn=function(La,Lb,Lc,Ld){return Lc*(La/=Ld)*La*La+Lb},Lh.cubicInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*Lc*La*La*La+Lb:.5*Lc*((La-=2)*La*La+2)+Lb},Lh.cubicOut=function(La,Lb,Lc,Ld){return Lc*((La=La/Ld-1)*La*La+1)+Lb},Lh.quadIn=function(La,Lb,Lc,Ld){return Lc*(La/=Ld)*La+Lb},Lh.quadInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*Lc*La*La+Lb:.5*-Lc*(--La*(La-2)-1)+Lb},Lh.quadOut=function(La,Lb,Lc,Ld){return-Lc*(La/=Ld)*(La-2)+Lb},Lh.expoIn=function(La,Lb,Lc,Ld){return 0==La?Lb:Lc*Math.pow(2,10*(La/Ld-1))+Lb-.001*Lc},Lh.expoInOut=function(La,Lb,Lc,Ld){return 0==La?Lb:La==Ld?Lb+Lc:(La/=.5*Ld)<1?.5*Lc*Math.pow(2,10*(La-1))+Lb:.5*Lc*(2-Math.pow(2,-10*--La))+Lb},Lh.expoOut=function(La,Lb,Lc,Ld){return La==Ld?Lb+Lc:Lc*(1-Math.pow(2,-10*La/Ld))+Lb},Lh.circIn=function(La,Lb,Lc,Ld){return-Lc*(Math.sqrt(1-(La/=Ld)*La)-1)+Lb},Lh.circInOut=function(La,Lb,Lc,Ld){return(La/=.5*Ld)<1?.5*-Lc*(Math.sqrt(1-La*La)-1)+Lb:.5*Lc*(Math.sqrt(1-(La-=2)*La)+1)+Lb},Lh.circOut=function(La,Lb,Lc,Ld){return Lc*Math.sqrt(1-(La=La/Ld-1)*La)+Lb},Lh.HALF_PI=.5*Math.PI,Lh.PI2=2*Math.PI,Lh}(),LV=function(){function Ll(){this._hit=null,this._unHit=null}Lq(Ll,"laya.utils.HitArea");var La=Ll.prototype;return La.isHit=function(La,Lb){return!!Ll.isHitGraphic(La,Lb,this.hit)&&!Ll.isHitGraphic(La,Lb,this.unHit)},La.contains=function(La,Lb){return this.isHit(La,Lb)},Lk(0,La,"hit",function(){return this._hit||(this._hit=new Lm),this._hit},function(La){this._hit=La}),Lk(0,La,"unHit",function(){return this._unHit||(this._unHit=new Lm),this._unHit},function(La){this._unHit=La}),Ll.isHitGraphic=function(La,Lb,Lc){if(!Lc)return!1;var Ld;if(!(Ld=Lc.cmds)&&Lc._one&&((Ld=Ll._cmds).length=1,Ld[0]=Lc._one),!Ld)return!1;var Le,Lf,Lg=0;for(Le=Ld.length,Lg=0;Lg<Le;Lg++)if(Lf=Ld[Lg]){var Lh=LJ._context;switch(Lf.callee){case Lh._translate:case 6:La-=Lf[0],Lb-=Lf[1]}if(Ll.isHitCmd(La,Lb,Lf))return!0}return!1},Ll.isHitCmd=function(La,Lb,Lc){if(!Lc)return!1;var Ld=LJ._context,Le=!1;switch(Lc.callee){case Ld._drawRect:case 13:Ll._rec.setTo(Lc[0],Lc[1],Lc[2],Lc[3]),Le=Ll._rec.contains(La,Lb);break;case Ld._drawCircle:case Ld._fillCircle:case 14:Le=(La-=Lc[0])*La+(Lb-=Lc[1])*Lb<Lc[2]*Lc[2];break;case Ld._drawPoly:case 18:La-=Lc[0],Lb-=Lc[1],Le=Ll.ptInPolygon(La,Lb,Lc[2])}return Le},Ll.ptInPolygon=function(La,Lb,Lc){var Ld;(Ld=Ll._ptPoint).setTo(La,Lb);var Le,Lf=0,Lg=NaN,Lh=NaN,Li=NaN,Lj=NaN;Le=Lc.length;for(var Lk=0;Lk<Le;Lk+=2){if(Lg=Lc[Lk],Lh=Lc[Lk+1],Li=Lc[(Lk+2)%Le],Lh!=(Lj=Lc[(Lk+3)%Le]))if(!(Ld.y<Math.min(Lh,Lj)))if(!(Ld.y>=Math.max(Lh,Lj)))(Ld.y-Lh)*(Li-Lg)/(Lj-Lh)+Lg>Ld.x&&Lf++}return Lf%2==1},Ll._cmds=[],Li(Ll,["_rec",function(){return this._rec=new LB},"_ptPoint",function(){return this._ptPoint=new LA}]),Ll}(),LW=(function(){function Le(La,Lb,Lc,Ld){this.char=La,this.charNum=La.charCodeAt(0),this._x=this._y=0,this.width=Lb,this.height=Lc,this.style=Ld,this.isWord=!Le._isWordRegExp.test(La)}Lq(Le,"laya.utils.HTMLChar");var La=Le.prototype;Lz.imps(La,{"laya.display.ILayout":!0}),La.setSprite=function(La){this._sprite=La},La.getSprite=function(){return this._sprite},La._isChar=function(){return!0},La._getCSSStyle=function(){return this.style},Lk(0,La,"width",function(){return this._w},function(La){this._w=La}),Lk(0,La,"x",function(){return this._x},function(La){this._sprite&&(this._sprite.x=La),this._x=La}),Lk(0,La,"y",function(){return this._y},function(La){this._sprite&&(this._sprite.y=La),this._y=La}),Lk(0,La,"height",function(){return this._h},function(La){this._h=La}),Le._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Lb(){}Lq(Lb,"laya.utils.Log"),Lb.enable=function(){Lb._logdiv||(Lb._logdiv=LO.window.document.createElement("div"),LO.window.document.body.appendChild(Lb._logdiv),Lb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Lb.toggle=function(){var La=Lb._logdiv.style;"1px"==La.width?La.width=La.height="50%":La.width=La.height="1px"},Lb.print=function(La){Lb._logdiv&&(Lb.maxCount<=Lb._count&&Lb.clear(),Lb._count++,Lb._logdiv.innerText+=La+"\n",Lb._logdiv.scrollTop=Lb._logdiv.scrollHeight)},Lb.clear=function(){Lb._logdiv.innerText="",Lb._count=0},Lb._logdiv=null,Lb._count=0,Lb.maxCount=20}(),function(){function Lb(){}Lq(Lb,"laya.utils.Mouse"),Lk(1,Lb,"cursor",function(){return Lb._style.cursor},function(La){Lb._style.cursor=La}),Lb.hide=function(){"none"!=Lb.cursor&&(Lb._preCursor=Lb.cursor,Lb.cursor="none")},Lb.show=function(){"none"==Lb.cursor&&(Lb.cursor=Lb._preCursor?Lb._preCursor:"auto")},Lb._preCursor=null,Li(Lb,["_style",function(){return this._style=LO.document.body.style}])}(),function(){function Lf(){}return Lq(Lf,"laya.utils.Pool"),Lf.getPoolBySign=function(La){return Lf._poolDic[La]||(Lf._poolDic[La]=[])},Lf.clearBySign=function(La){Lf._poolDic[La]&&(Lf._poolDic[La].length=0)},Lf.recover=function(La,Lb){Lb.__InPool||(Lb.__InPool=!0,Lf.getPoolBySign(La).push(Lb))},Lf.getItemByClass=function(La,Lb){var Lc=Lf.getPoolBySign(La),Ld=Lc.length?Lc.pop():new Lb;return Ld.__InPool=!1,Ld},Lf.getItemByCreateFun=function(La,Lb,Lc){var Ld=Lf.getPoolBySign(La),Le=Ld.length?Ld.pop():Lb.call(Lc);return Le.__InPool=!1,Le},Lf.getItem=function(La){var Lb=Lf.getPoolBySign(La),Lc=Lb.length?Lb.pop():null;return Lc&&(Lc.__InPool=!1),Lc},Lf._poolDic={},Lf.InPoolSign="__InPool",Lf}()),LX=function(){function Li(){}return Lq(Li,"laya.utils.Stat"),Lk(1,Li,"onclick",null,function(La){Li._sp&&Li._sp.on("click",Li._sp,La),Li._canvas&&(Li._canvas.source.onclick=La,Li._canvas.source.style.pointerEvents="")}),Li.show=function(La,Lb,Lc){if(void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),!LJ.isConchApp||LJ.isConchWebGL){if(LJ.isConchWebGL||LO.onMiniGame||LO.onLimixiu||(Li._useCanvas=!0),Li._show=!0,Li._fpsData.length=60,Li._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Li._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Li._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Li._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},LJ.isWebGL)if(Li._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},LJ.is3DMode){if(Li._view[0].title="FPS(3D)",Li._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Li._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Li._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==Lc){var Ld=8;Li._view[Ld++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Li._view[Ld++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Li._view[Ld++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==Lc){Ld=8;Li._view[Ld++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Li._view[Ld++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Li._view[0].title="FPS(WebGL)",Li._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Li._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Li._useCanvas?Li.createUIPre(La,Lb):Li.createUI(La,Lb),Li.enable()}else LO.window.conch.showFPS&&LO.window.conch.showFPS(La,Lb)},Li.createUIPre=function(La,Lb){var Lc=LO.pixelRatio;Li._width=170*Lc,Li._vx=75*Lc,Li._height=Lc*(12*Li._view.length+3*Lc)+4,Li._fontSize=12*Lc;for(var Ld=0;Ld<Li._view.length;Ld++)Li._view[Ld].x=4,Li._view[Ld].y=Ld*Li._fontSize+2*Lc;Li._canvas||((Li._canvas=new Lta("2D")).size(Li._width,Li._height),(Li._ctx=Li._canvas.getContext("2d")).textBaseline="top",Li._ctx.font=Li._fontSize+"px Sans-serif",Li._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+La+"px;top:"+Lb+"px;width:"+Li._width/Lc+"px;height:"+Li._height/Lc+"px;"),Li._first=!0,Li.loop(),Li._first=!1,LO.container.appendChild(Li._canvas.source)},Li.createUI=function(La,Lb){var Lc=Li._sp,Ld=LO.pixelRatio;Lc||(Lc=new Lla,(Li._leftText=new Lqa).pos(5,5),Li._leftText.color="#ffffff",Lc.addChild(Li._leftText),(Li._txt=new Lqa).pos(80*Ld,5),Li._txt.color="#ffffff",Lc.addChild(Li._txt),Li._sp=Lc),Lc.pos(La,Lb);for(var Le="",Lf=0;Lf<Li._view.length;Lf++){Le+=Li._view[Lf].title+"\n"}Li._leftText.text=Le;var Lg=170*Ld,Lh=Ld*(12*Li._view.length+3*Ld)+4;Li._txt.fontSize=Li._fontSize*Ld,Li._leftText.fontSize=Li._fontSize*Ld,Lc.size(Lg,Lh),Lc.graphics.clear(),Lc.graphics.setAlpha(.5),Lc.graphics.drawRect(0,0,Lg,Lh,"#999999"),Lc.graphics.setAlpha(1),Li.loop()},Li.enable=function(){Lz.timer.frameLoop(1,Li,Li.loop)},Li.hide=function(){Li._show=!1,Lz.timer.clear(Li,Li.loop),Li._canvas&&LO.removeElement(Li._canvas.source)},Li.clear=function(){Li.trianglesFaces=Li.drawCall=Li.shaderCall=Li.spriteCount=Li.spriteRenderUseCacheCount=Li.treeNodeCollision=Li.treeSpriteCollision=Li.canvasNormal=Li.canvasBitmap=Li.canvasReCache=0},Li.loop=function(){Li._count++;var La=LO.now();if(!(La-Li._timer<1e3)){var Lb=Li._count;if(Li.FPS=Math.round(1e3*Lb/(La-Li._timer)),Li._show){Li.trianglesFaces=Math.round(Li.trianglesFaces/Lb),Li.spriteCount=Li._useCanvas?(Li.drawCall=Math.round(Li.drawCall/Lb)-2,Li.shaderCall=Math.round(Li.shaderCall/Lb),Math.round(Li.spriteCount/Lb)-1):(Li.drawCall=Math.round(Li.drawCall/Lb)-2,Li.shaderCall=Math.round(Li.shaderCall/Lb)-4,Math.round(Li.spriteCount/Lb)-4),Li.spriteRenderUseCacheCount=Math.round(Li.spriteRenderUseCacheCount/Lb),Li.canvasNormal=Math.round(Li.canvasNormal/Lb),Li.canvasBitmap=Math.round(Li.canvasBitmap/Lb),Li.canvasReCache=Math.ceil(Li.canvasReCache/Lb),Li.treeNodeCollision=Math.round(Li.treeNodeCollision/Lb),Li.treeSpriteCollision=Math.round(Li.treeSpriteCollision/Lb);var Lc=0<Li.FPS?Math.floor(1e3/Li.FPS).toString():" ";Li._fpsStr=Li.FPS+(Li.renderSlow?" slow":"")+" "+Lc,Li._spriteStr=Li.spriteCount+(Li.spriteRenderUseCacheCount?"/"+Li.spriteRenderUseCacheCount:""),Li._canvasStr=Li.canvasReCache+"/"+Li.canvasNormal+"/"+Li.canvasBitmap,Li.currentMemorySize=LN.systemResourceManager.memorySize,Li._useCanvas?Li.renderInfoPre():Li.renderInfo(),Li.clear()}Li._count=0,Li._timer=La}},Li.renderInfoPre=function(){if(Li._canvas){var La=Li._ctx;La.clearRect(Li._first?0:Li._vx,0,Li._width,Li._height);for(var Lb=LJ.WebGL.mainContext,Lc=0;Lc<Li._view.length;Lc++){var Ld=Li._view[Lc];Li._first&&(La.fillStyle="white",La.fillText(Ld.title,Ld.x,Ld.y,null,null,null)),La.fillStyle=Ld.color;var Le=-1;if((Ld=Li._view[Lc]).varying){if(Lb)switch(Ld.varying){case 1:Le=Lb.getParameter(Lb[Ld.value]);break;case 2:Le=Lb.getExtension(Ld.value)}}else Le=Li[Ld.value];"M"==Ld.units&&(Le=Math.floor(Le/1048576*100)/100+" M"),"K"==Ld.units&&(Le=Math.floor(Le/1024*100)/100+" K"),"string"==Ld.units&&(Le=Le.match(/\d+\.?\d/i)),La.fillText(Le+"",Ld.x+Li._vx,Ld.y,null,null,null)}}},Li.renderInfo=function(){for(var La="",Lb=LJ.WebGL.mainContext,Lc=0;Lc<Li._view.length;Lc++){var Ld=Li._view[Lc],Le=-1;if(Ld.varying){if(Lb)switch(Ld.varying){case 1:Le=Lb.getParameter(Lb[Ld.value]);break;case 2:Le=Lb.getExtension(Ld.value)}}else Le=Li[Ld.value];"M"==Ld.units&&(Le=Math.floor(Le/1048576*100)/100+" M"),"K"==Ld.units&&(Le=Math.floor(Le/1024*100)/100+" K"),"string"==Ld.units&&(Le=Le.match(/\d+\.?\d/i)),La+=Le+"\n"}Li._txt.text=La},Li.FPS=0,Li.loopCount=0,Li.shaderCall=0,Li.drawCall=0,Li.trianglesFaces=0,Li.spriteCount=0,Li.spriteRenderUseCacheCount=0,Li.treeNodeCollision=0,Li.treeSpriteCollision=0,Li.canvasNormal=0,Li.canvasBitmap=0,Li.canvasReCache=0,Li.renderSlow=!1,Li.currentMemorySize=0,Li._fpsStr=null,Li._canvasStr=null,Li._spriteStr=null,Li._fpsData=[],Li._timer=0,Li._count=0,Li._view=[],Li._fontSize=12,Li._txt=null,Li._leftText=null,Li._sp=null,Li._show=!1,Li._useCanvas=!1,Li._canvas=null,Li._ctx=null,Li._first=!1,Li._vx=NaN,Li._width=0,Li._height=100,Li}(),LY=(function(){function La(){this._strsToID={},this._idToStrs=[],this._length=0}Lq(La,"laya.utils.StringKey");var Lb=La.prototype;Lb.add=function(La){var Lb=this._strsToID[La];return null!=Lb?Lb:(this._idToStrs[this._length]=La,this._strsToID[La]=this._length++)},Lb.getID=function(La){var Lb=this._strsToID[La];return null==Lb?-1:Lb},Lb.getName=function(La){var Lb=this._idToStrs[La];return null==Lb?void 0:Lb}}(),function(){var Lj;function La(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Lq(La,"laya.utils.Timer");var Lb=La.prototype;return Lb._init=function(){Lz.timer&&Lz.timer.frameLoop(1,this,this._update)},Lb._now=function(){return Date.now()},Lb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var La=this.currFrame=this.currFrame+this.scale,Lb=this._now();this._delta=(Lb-this._lastTimer)*this.scale;var Lc=this.currTimer=this.currTimer+this._delta;Lz.isDebug&&6e4<Math.abs(Lb-this._lastTimer)&&console.error("系统时间错误！"+(Lb-this._lastTimer)),this._lastTimer=Lb;var Ld=this._handlers;for(Lg=this._count=0,Lh=Ld.length;Lg<Lh;Lg++)if(null!==(Li=Ld[Lg]).method){var Le=Li.userFrame?La:Lc;if(Le>=Li.exeTime)if(Li.repeat)if(Li.jumpFrame)for(;Le>=Li.exeTime;)Li.exeTime+=Li.delay,Li.run(!1);else Li.exeTime+=Li.delay,Li.run(!1),Le>Li.exeTime&&(Li.exeTime+=Math.ceil((Le-Li.exeTime)/Li.delay)*Li.delay);else Li.run(!0)}else this._count++;(30<this._count||La%200==0)&&this._clearHandlers();for(var Lf=this._laters,Lg=0,Lh=Lf.length-1;Lg<=Lh;Lg++){var Li=Lf[Lg];this._isIgnoreRecover(Li)||(null!==Li.method&&(delete this._map[Li.key],Li.run(!1)),this._recoverHandler(Li)),Lg===Lh&&(Lh=Lf.length-1)}Lf.length=0}},Lb._clearHandlers=function(){for(var La=this._handlers,Lb=0,Lc=La.length;Lb<Lc;Lb++){var Ld=La[Lb];null!==Ld.method?this._temp.push(Ld):this._isIgnoreRecover(Ld)?this._temp.push(Ld):this._recoverHandler(Ld)}this._handlers=this._temp,this._temp=La,this._temp.length=0},Lb._recoverHandler=function(La){this._map[La.key]==La&&delete this._map[La.key],La.recover()},Lb._create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){if(!Lc)return Le.apply(Ld,Lf),null;if(Lg){var Li=this._getHandler(Ld,Le);if(Li)return Li.repeat=Lb,Li.userFrame=La,Li.delay=Lc,Li.ignoreRecover=Lh,Li.caller=Ld,Li.method=Le,Li.args=Lf,Li.exeTime=Lc+(La?this.currFrame:this.currTimer+this._now()-this._lastTimer),Li}return(Li=Lj.create()).repeat=Lb,Li.userFrame=La,Li.delay=Lc,Li.ignoreRecover=Lh,Li.caller=Ld,Li.method=Le,Li.args=Lf,Li.exeTime=Lc+(La?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Li),this._handlers.push(Li),Li},Lb._indexHandler=function(La){var Lb=La.caller,Lc=La.method,Ld=Lb?Lb.$_GID||(Lb.$_GID=L$.getGID()):0,Le=Lc.$_TID||(Lc.$_TID=this._mid++);La.key=Ld+"_"+Le,this._map[La.key]=La},Lb.once=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=!0),this._create(!1,!1,La,Lb,Lc,Ld,Le,!1)},Lb.loop=function(La,Lb,Lc,Ld,Le,Lf,Lg){void 0===Le&&(Le=!0),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!1);var Lh=this._create(!1,!0,La,Lb,Lc,Ld,Le,Lg);Lh&&(Lh.jumpFrame=Lf)},Lb.frameOnce=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=!0),this._create(!0,!1,La,Lb,Lc,Ld,Le,!1)},Lb.frameLoop=function(La,Lb,Lc,Ld,Le,Lf){void 0===Le&&(Le=!0),void 0===Lf&&(Lf=!1),this._create(!0,!0,La,Lb,Lc,Ld,Le,Lf)},Lb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+Lj._freeCount},Lb.clear=function(La,Lb){var Lc=this._getHandler(La,Lb);return!(!Lc||this._isIgnoreRecover(Lc))&&(delete this._map[Lc.key],Lc.key=null,Lc.clear(),!0)},Lb.clearAll=function(La){if(La)for(var Lb=0,Lc=this._handlers.length;Lb<Lc;Lb++){var Ld=this._handlers[Lb];Ld.caller===La&&(this._isIgnoreRecover(Ld)||(delete this._map[Ld.key],Ld.key=null,Ld.clear()))}},Lb._getHandler=function(La,Lb){var Lc=La?La.$_GID||(La.$_GID=L$.getGID()):0,Ld=Lb.$_TID||(Lb.$_TID=this._mid++);return this._map[Lc+"_"+Ld]},Lb._isIgnoreRecover=function(La){if(La.ignoreRecover||La.caller&&"IgnoreRecover"==La.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Lb="";try{arguments.propertyIsEnumerable.caller}catch(La){Lb=La.stack}Lz.recordError("报错：核心定时器销毁忽略  "+Lb)}return!0}return!1},Lb.hasHandler=function(La,Lb){return this._map[La.$_GID+"_"+Lb.$_TID]},Lb.callLater=function(La,Lb,Lc){if(null==this._getHandler(La,Lb)){var Ld=Lj.create();Ld.caller=La,Ld.method=Lb,Ld.args=Lc,this._indexHandler(Ld),this._laters.push(Ld)}},Lb.runCallLater=function(La,Lb){var Lc=this._getHandler(La,Lb);Lc&&null!=Lc.method&&(this._isIgnoreRecover(Lc)||(delete this._map[Lc.key],Lc.run(!0)))},Lb.runTimer=function(La,Lb){this.runCallLater(La,Lb)},Lk(0,Lb,"delta",function(){return this._delta}),La.__init$=function(){Lj=function(){function Lb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Lq(Lb,"");var La=Lb.prototype;return La.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},La.recover=function(){this.clear(),this.args=Lb._freeHandler,Lb._freeHandler=this,Lb._freeCount++},La.run=function(La){var Lb=this.caller;if(Lb&&Lb.destroyed)return this.clear();var Lc=this.method,Ld=this.args;La&&this.clear(),null!=Lc&&(Ld?Lc.apply(Lb,Ld):Lc.call(Lb))},Lb._freeHandler=null,Lb._freeCount=0,Lb.create=function(){var La=Lb._freeHandler;return La?(Lb._freeHandler=La.args,--Lb._freeCount,La.args=null,La):new Lb},Lb}()},La}()),LZ=function(){function Ll(){this.gid=0}Lq(Ll,"laya.utils.Tween");var La=Ll.prototype;return La.to=function(La,Lb,Lc,Ld,Le,Lf,Lg){return void 0===Lf&&(Lf=0),void 0===Lg&&(Lg=!1),this._create(La,Lb,Lc,Ld,Le,Lf,Lg,!0,!1,!0)},La.from=function(La,Lb,Lc,Ld,Le,Lf,Lg){return void 0===Lf&&(Lf=0),void 0===Lg&&(Lg=!1),this._create(La,Lb,Lc,Ld,Le,Lf,Lg,!1,!1,!0)},La._create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){if(!La)throw new Error("Tween:target is null");this._target=La,this._duration=Lc,this._ease=Ld||Lb.ease||Ll.easeNone,this._complete=Le||Lb.complete,this._delay=Lf,this._props=[],this._usedTimer=0,this._startTimer=LO.now(),this._usedPool=Li,this._delayParam=null,this.update=Lb.update;var Lk=La.$_GID||(La.$_GID=L$.getGID());return Ll.tweenMap[Lk]?(Lg&&Ll.clearTween(La),Ll.tweenMap[Lk].push(this)):Ll.tweenMap[Lk]=[this],Lj?Lf<=0?this.firstStart(La,Lb,Lh):(this._delayParam=[La,Lb,Lh],Lz.scaleTimer.once(Lf,this,this.firstStart,this._delayParam)):this._initProps(La,Lb,Lh),this},La.firstStart=function(La,Lb,Lc){this._delayParam=null,La.destroyed?this.clear():(this._initProps(La,Lb,Lc),this._beginLoop())},La._initProps=function(La,Lb,Lc){for(var Ld in Lb)if("number"==typeof La[Ld]){var Le=Lc?La[Ld]:Lb[Ld],Lf=Lc?Lb[Ld]:La[Ld];this._props.push([Ld,Le,Lf-Le]),Lc||(La[Ld]=Le)}},La._beginLoop=function(){Lz.scaleTimer.frameLoop(1,this,this._doEase)},La._doEase=function(){this._updateEase(LO.now())},La._updateEase=function(La){var Lb=this._target;if(Lb){if(Lb.destroyed)return Ll.clearTween(Lb);var Lc=this._usedTimer=La-this._startTimer-this._delay;if(!(Lc<0)){if(Lc>=this._duration)return this.complete();for(var Ld=0<Lc?this._ease(Lc,0,1,this._duration):0,Le=this._props,Lf=0,Lg=Le.length;Lf<Lg;Lf++){var Lh=Le[Lf];Lb[Lh[0]]=Lh[1]+Ld*Lh[2]}this.update&&this.update.run()}}},La.complete=function(){if(this._target){Lz.scaleTimer.runTimer(this,this.firstStart);for(var La=this._target,Lb=this._props,Lc=this._complete,Ld=0,Le=Lb.length;Ld<Le;Ld++){var Lf=Lb[Ld];La[Lf[0]]=Lf[1]+Lf[2]}this.update&&this.update.run(),this.clear(),Lc&&Lc.run()}},La.pause=function(){Lz.scaleTimer.clear(this,this._beginLoop),Lz.scaleTimer.clear(this,this._doEase),Lz.scaleTimer.clear(this,this.firstStart);var La;(La=LO.now()-this._startTimer-this._delay)<0&&(this._usedTimer=La)},La.setStartTime=function(La){this._startTimer=La},La.clear=function(){this._target&&(this._remove(),this._clear())},La._clear=function(){this.pause(),Lz.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,LW.recover("tween",this))},La.recover=function(){this._usedPool=!0,this._clear()},La._remove=function(){var La=Ll.tweenMap[this._target.$_GID];if(La)for(var Lb=0,Lc=La.length;Lb<Lc;Lb++)if(La[Lb]===this){La.splice(Lb,1);break}},La.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=LO.now(),this._delayParam)Lz.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var La=this._props,Lb=0,Lc=La.length;Lb<Lc;Lb++){var Ld=La[Lb];this._target[Ld[0]]=Ld[1]}Lz.scaleTimer.once(this._delay,this,this._beginLoop)}},La.resume=function(){this._usedTimer>=this._duration||(this._startTimer=LO.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Lz.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},Lk(0,La,"progress",null,function(La){var Lb=La*this._duration;this._startTimer=LO.now()-this._delay-Lb}),Ll.to=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){return void 0===Lf&&(Lf=0),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=!0),LW.getItemByClass("tween",Ll)._create(La,Lb,Lc,Ld,Le,Lf,Lg,!0,Lh,!0)},Ll.from=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){return void 0===Lf&&(Lf=0),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=!0),LW.getItemByClass("tween",Ll)._create(La,Lb,Lc,Ld,Le,Lf,Lg,!1,Lh,!0)},Ll.clearAll=function(La){if(La&&La.$_GID){var Lb=Ll.tweenMap[La.$_GID];if(Lb){for(var Lc=0,Ld=Lb.length;Lc<Ld;Lc++)Lb[Lc]._clear();Lb.length=0}}},Ll.clear=function(La){La.clear()},Ll.clearTween=function(La){Ll.clearAll(La)},Ll.easeNone=function(La,Lb,Lc,Ld){return Lc*La/Ld+Lb},Ll.tweenMap={},Ll}(),L$=function(){function Lh(){}return Lq(Lh,"laya.utils.Utils"),Lh.toRadian=function(La){return La*Lh._pi2},Lh.toAngle=function(La){return La*Lh._pi},Lh.toHexColor=function(La){if(La<0||isNaN(La))return null;for(var Lb=La.toString(16);Lb.length<6;)Lb="0"+Lb;return"#"+Lb},Lh.getGID=function(){return Lh._gid++},Lh.concatArray=function(La,Lb){if(!Lb)return La;if(!La)return Lb;var Lc=0,Ld=Lb.length;for(Lc=0;Lc<Ld;Lc++)La.push(Lb[Lc]);return La},Lh.clearArray=function(La){return La&&(La.length=0),La},Lh.copyArray=function(La,Lb){if(La||(La=[]),!Lb)return La;La.length=Lb.length;var Lc=0,Ld=Lb.length;for(Lc=0;Lc<Ld;Lc++)La[Lc]=Lb[Lc];return La},Lh.getGlobalRecByPoints=function(La,Lb,Lc,Ld,Le){var Lf,Lg;return Lf=new LA(Lb,Lc),Lf=La.localToGlobal(Lf),Lg=new LA(Ld,Le),Lg=La.localToGlobal(Lg),LB._getWrapRec([Lf.x,Lf.y,Lg.x,Lg.y])},Lh.getGlobalPosAndScale=function(La){return Lh.getGlobalRecByPoints(La,0,0,1,1)},Lh.bind=function(La,Lb){return La.bind(Lb)},Lh.measureText=function(La,Lb){return LF.measureText(La,Lb)},Lh.contextMeasureText=function(La){var Lb=LO.context.measureText(La);return Lb||(Lb={width:16,height:16}),Lb},Lh.updateOrder=function(La){if(!La||La.length<2)return!1;for(var Lb,Lc=1,Ld=0,Le=La.length,Lf=NaN;Lc<Le;){for(Lb=La[Ld=Lc],Lf=La[Ld]._zOrder;-1<--Ld&&La[Ld]._zOrder>Lf;)La[Ld+1]=La[Ld];La[Ld+1]=Lb,Lc++}var Lg=Lb.parent.conchModel;if(Lg)if(null!=Lg.updateZOrder)Lg.updateZOrder();else{for(Lc=0;Lc<Le;Lc++)Lg.removeChild(La[Lc].conchModel);for(Lc=0;Lc<Le;Lc++)Lg.addChildAt(La[Lc].conchModel,Lc)}return!0},Lh.transPointList=function(La,Lb,Lc){var Ld=0,Le=La.length;for(Ld=0;Ld<Le;Ld+=2)La[Ld]+=Lb,La[Ld+1]+=Lc},Lh.parseInt=function(La,Lb){void 0===Lb&&(Lb=0);var Lc=LO.window.parseInt(La,Lb);return isNaN(Lc)?0:Lc},Lh.getFileExtension=function(La){Lh._extReg.lastIndex=La.lastIndexOf(".");var Lb=Lh._extReg.exec(La);return Lb&&1<Lb.length?Lb[1].toLowerCase():null},Lh.getTransformRelativeToWindow=function(La,Lb,Lc){var Ld=Lz.stage,Le=laya.utils.Utils.getGlobalPosAndScale(La),Lf=Ld._canvasTransform.clone(),Lg=Lf.tx,Lh=Lf.ty;Lf.rotate(-Math.PI/180*Lz.stage.canvasDegree),Lf.scale(Lz.stage.clientScaleX,Lz.stage.clientScaleY);var Li=Lz.stage.canvasDegree%180!=0,Lj=NaN,Lk=NaN;Li?(Lj=Lc+Le.y,Lk=Lb+Le.x,Lj*=Lf.d,Lk*=Lf.a,90==Lz.stage.canvasDegree?(Lj=Lg-Lj,Lk+=Lh):(Lj+=Lg,Lk=Lh-Lk)):(Lj=Lb+Le.x,Lk=Lc+Le.y,Lj*=Lf.a,Lk*=Lf.d,Lj+=Lg,Lk+=Lh);var Ll=NaN,Lm=NaN;return Lm=Li?(Ll=Lf.d*Le.height,Lf.a*Le.width):(Ll=Lf.a*Le.width,Lf.d*Le.height),{x:Lj,y:Lk,scaleX:Ll,scaleY:Lm}},Lh.fitDOMElementInArea=function(La,Lb,Lc,Ld,Le,Lf){La._fitLayaAirInitialized||(La._fitLayaAirInitialized=!0,La.style.transformOrigin=La.style.webKittransformOrigin="left top",La.style.position="absolute");var Lg=Lh.getTransformRelativeToWindow(Lb,Lc,Ld);La.style.transform=La.style.webkitTransform="scale("+Lg.scaleX+","+Lg.scaleY+") rotate("+Lz.stage.canvasDegree+"deg)",La.style.width=Le+"px",La.style.height=Lf+"px",La.style.left=Lg.x+"px",La.style.top=Lg.y+"px"},Lh.isOkTextureList=function(La){if(!La)return!1;var Lb,Lc=0,Ld=La.length;for(Lc=0;Lc<Ld;Lc++)if(!(Lb=La[Lc])||!Lb.source)return!1;return!0},Lh.isOKCmdList=function(La){if(!La)return!1;var Lb,Lc,Ld=0,Le=La.length,Lf=LJ._context;for(Ld=0;Ld<Le;Ld++)switch((Lb=La[Ld]).callee){case Lf._drawTexture:case Lf._fillTexture:case Lf._drawTextureWithTransform:if(!(Lc=Lb[0])||!Lc.source)return!1}return!0},Lh._gid=1,Lh._pi=180/Math.PI,Lh._pi2=Math.PI/180,Lh._extReg=/\.(\w+)\??/g,Lh.parseXMLFromString=function(La){var Lb;if(La=La.replace(/>\s+</g,"><"),-1<(Lb=(new DOMParser).parseFromString(La,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Lb.firstChild.firstChild.textContent+",  "+La);return Lb},Lh}(),L_=function(){function La(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],LJ.isWebGL&&LQ.regCacheByFunction(L$.bind(this.startDispose,this),L$.bind(this.getCacheList,this))}Lq(La,"laya.utils.VectorGraphManager");var Lb=La.prototype;return Lb.getId=function(){return this._id++},Lb.addShape=function(La,Lb){this.shapeDic[La]=Lb,this.useDic[La]||(this.useDic[La]=!0)},Lb.addLine=function(La,Lb){this.shapeLineDic[La]=Lb,this.shapeLineDic[La]||(this.shapeLineDic[La]=!0)},Lb.getShape=function(La){this._checkKey&&null!=this.useDic[La]&&(this.useDic[La]=!0)},Lb.deleteShape=function(La){this.shapeDic[La]&&(this.shapeDic[La]=null,delete this.shapeDic[La]),this.shapeLineDic[La]&&(this.shapeLineDic[La]=null,delete this.shapeLineDic[La]),null!=this.useDic[La]&&delete this.useDic[La]},Lb.getCacheList=function(){var La,Lb=[];for(La in this.shapeDic)Lb.push(this.shapeDic[La]);for(La in this.shapeLineDic)Lb.push(this.shapeLineDic[La]);return Lb},Lb.startDispose=function(La){var Lb;for(Lb in this.useDic)this.useDic[Lb]=!1;this._checkKey=!0},Lb.endDispose=function(){if(this._checkKey){var La;for(La in this.useDic)this.useDic[La]||this.deleteShape(La);this._checkKey=!1}},La.getInstance=function(){return La.instance=La.instance||new La},La.instance=null,La}(),Lw=function(){function Ld(){this._obj=null,this._obj=Ld.supportWeakMap?new LO.window.WeakMap:{},Ld.supportWeakMap||Ld._maps.push(this)}Lq(Ld,"laya.utils.WeakObject");var La=Ld.prototype;return La.set=function(La,Lb){if(null!=La)if(Ld.supportWeakMap){var Lc=La;"string"!=typeof La&&"number"!=typeof La||(Lc=Ld._keys[La])||(Lc=Ld._keys[La]={k:La}),this._obj.set(Lc,Lb)}else"string"==typeof La||"number"==typeof La?this._obj[La]=Lb:(La.$_GID||(La.$_GID=L$.getGID()),this._obj[La.$_GID]=Lb)},La.get=function(La){if(null==La)return null;if(Ld.supportWeakMap){var Lb="string"==typeof La||"number"==typeof La?Ld._keys[La]:La;return Lb?this._obj.get(Lb):null}return"string"==typeof La||"number"==typeof La?this._obj[La]:this._obj[La.$_GID]},La.del=function(La){if(null!=La)if(Ld.supportWeakMap){var Lb="string"==typeof La||"number"==typeof La?Ld._keys[La]:La;if(!Lb)return;this._obj.delete(Lb)}else"string"==typeof La||"number"==typeof La?delete this._obj[La]:delete this._obj[this._obj.$_GID]},La.has=function(La){if(null==La)return!1;if(Ld.supportWeakMap){var Lb="string"==typeof La||"number"==typeof La?Ld._keys[La]:La;return this._obj.has(Lb)}return"string"==typeof La||"number"==typeof La?null!=this._obj[La]:null!=this._obj[this._obj.$_GID]},Ld.__init__=function(){(Ld.supportWeakMap=null!=LO.window.WeakMap)||Lz.timer.loop(Ld.delInterval,null,Ld.clearCache)},Ld.clearCache=function(){for(var La=0,Lb=Ld._maps.length;La<Lb;La++){Ld._maps[La]._obj={}}},Ld.supportWeakMap=!1,Ld.delInterval=3e5,Ld._keys={},Ld._maps=[],Li(Ld,["I",function(){return this.I=new Ld}]),Ld}(),Lx=function(){function La(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Lq(La,"laya.utils.WordText");var Lb=La.prototype;return Lb.setText=function(La){this.changed=!0,this._text=La},Lb.toString=function(){return this._text},Lb.charCodeAt=function(La){return this._text?this._text.charCodeAt(La):NaN},Lb.charAt=function(La){return this._text?this._text.charAt(La):null},Lk(0,Lb,"length",function(){return this._text?this._text.length:0}),La}(),Laa=function(La){function Lg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,Lg.__super.call(this),this._childs=Lg.ARRAY_EMPTY,this._$P=Lg.PROP_EMPTY,this.timer=Lz.scaleTimer,this.conchModel=LJ.isConchNode?this.createConchModel():null}Lq(Lg,"laya.display.Node",Lj);var Lb=Lg.prototype;return Lb._setBit=function(La,Lb){1==La&&(this._getBit(La)!=Lb&&this._updateDisplayedInstage());Lb?this._bits|=La:this._bits&=~La},Lb._getBit=function(La){return 0!=(this._bits&La)},Lb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Lb._setUpNoticeType=function(La){var Lb=this;for(Lb._setBit(La,!0),Lb=Lb.parent;Lb;){if(Lb._getBit(La))return;Lb._setBit(La,!0),Lb=Lb.parent}},Lb.on=function(La,Lb,Lc,Ld){return"display"!==La&&"undisplay"!==La||this._getBit(1)||this._setUpNoticeType(1),this._createListener(La,Lb,Lc,Ld,!1)},Lb.once=function(La,Lb,Lc,Ld){return"display"!==La&&"undisplay"!==La||this._getBit(1)||this._setUpNoticeType(1),this._createListener(La,Lb,Lc,Ld,!0)},Lb.createConchModel=function(){return null},Lb.destroy=function(La){void 0===La&&(La=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(La?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Lb.destroyChildren=function(){if(this._childs)for(var La=this._childs.length-1;-1<La;La--)this._childs[La].destroy(!0)},Lb.addChild=function(La){if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),La._parent===this){var Lb=this.getChildIndex(La);Lb!==this._childs.length-1&&(this._childs.splice(Lb,1),this._childs.push(La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,this._childs.length-1)),this._childChanged())}else La.parent&&La.parent.removeChild(La),this._childs===Lg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,this._childs.length-1),(La.parent=this)._childChanged();return La},Lb.addChildren=function(La){for(var Lb=arguments,Lc=0,Ld=Lb.length;Lc<Ld;)this.addChild(Lb[Lc++])},Lb.addChildAt=function(La,Lb){if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),0<=Lb&&Lb<=this._childs.length){if(La._parent===this){var Lc=this.getChildIndex(La);this._childs.splice(Lc,1),this._childs.splice(Lb,0,La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,Lb)),this._childChanged()}else La.parent&&La.parent.removeChild(La),this._childs===Lg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Lb,0,La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,Lb),La.parent=this;return La}throw new Error("appendChildAt:The index is out of bounds")},Lb.getChildIndex=function(La){return this._childs.indexOf(La)},Lb.getChildByName=function(La){var Lb=this._childs;if(Lb)for(var Lc=0,Ld=Lb.length;Lc<Ld;Lc++){var Le=Lb[Lc];if(Le.name===La)return Le}return null},Lb._get$P=function(La){return this._$P[La]},Lb._set$P=function(La,Lb){return this.destroyed||(this._$P===Lg.PROP_EMPTY&&(this._$P={}),this._$P[La]=Lb),Lb},Lb.getChildAt=function(La){return this._childs[La]},Lb.setChildIndex=function(La,Lb){var Lc=this._childs;if(Lb<0||Lb>=Lc.length)throw new Error("setChildIndex:The index is out of bounds.");var Ld=this.getChildIndex(La);if(Ld<0)throw new Error("setChildIndex:node is must child of this object.");return Lc.splice(Ld,1),Lc.splice(Lb,0,La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,Lb)),this._childChanged(),La},Lb._childChanged=function(La){},Lb.removeChild=function(La){if(!this._childs)return La;var Lb=this._childs.indexOf(La);return this.removeChildAt(Lb)},Lb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Lb.removeChildByName=function(La){var Lb=this.getChildByName(La);return Lb&&this.removeChild(Lb),Lb},Lb.removeChildAt=function(La){var Lb=this.getChildAt(La);if(Lb){for(var Lc=this._childs.length-1,Ld=La;Ld<Lc;++Ld)this._childs[Ld]=this._childs[Ld+1];this._childs.length=Lc,this.conchModel&&this.conchModel.removeChild(Lb.conchModel),Lb.parent=null}return Lb},Lb.removeChildren=function(La,Lb){if(void 0===La&&(La=0),void 0===Lb&&(Lb=2147483647),this._childs&&0<this._childs.length){var Lc=this._childs;if(0===La&&Lf<=Lb){var Ld=Lc;this._childs=Lg.ARRAY_EMPTY}else Ld=Lc.splice(La,Lb-La);for(var Le=0,Lf=Ld.length;Le<Lf;Le++)Ld[Le].parent=null,this.conchModel&&this.conchModel.removeChild(Ld[Le].conchModel)}return this},Lb.replaceChild=function(La,Lb){var Lc=this._childs.indexOf(Lb);return-1<Lc?(this._childs.splice(Lc,1,La),this.conchModel&&(this.conchModel.removeChild(Lb.conchModel),this.conchModel.addChildAt(La.conchModel,Lc)),Lb.parent=null,La.parent=this,La):null},Lb._updateDisplayedInstage=function(){var La;La=this;var Lb=Lz.stage;for(this._displayedInStage=!1;La;){if(La._getBit(1)){this._displayedInStage=La._displayedInStage;break}if(La==Lb||La._displayedInStage){this._displayedInStage=!0;break}La=La.parent}},Lb._setDisplay=function(La){this._displayedInStage!==La&&((this._displayedInStage=La)?this.event("display"):this.event("undisplay"))},Lb._displayChild=function(La,Lb){var Lc=La._childs;if(Lc)for(var Ld=0;Ld<Lc.length;Ld++){var Le=Lc[Ld];Le&&Le._getBit(1)&&(0<Le._childs.length?this._displayChild(Le,Lb):Le._setDisplay(Lb))}La._setDisplay(Lb)},Lb.contains=function(La){if(La===this)return!0;for(;La;){if(La.parent===this)return!0;La=La.parent}return!1},Lb.timerLoop=function(La,Lb,Lc,Ld,Le,Lf){void 0===Le&&(Le=!0),void 0===Lf&&(Lf=!1),this.timer.loop(La,Lb,Lc,Ld,Le,Lf)},Lb.timerOnce=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=!0),this.timer._create(!1,!1,La,Lb,Lc,Ld,Le)},Lb.frameLoop=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=!0),this.timer._create(!0,!0,La,Lb,Lc,Ld,Le)},Lb.frameOnce=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=!0),this.timer._create(!0,!1,La,Lb,Lc,Ld,Le)},Lb.clearTimer=function(La,Lb){this.timer.clear(La,Lb)},Lk(0,Lb,"numChildren",function(){return this._childs.length}),Lk(0,Lb,"destroyed",function(){return this._destroyed}),Lk(0,Lb,"parent",function(){return this._parent},function(La){this._parent!==La&&(La?(this._parent=La,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),La.displayedInStage&&this._displayChild(this,!0)),La._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=La))}),Lk(0,Lb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),Lg.ARRAY_EMPTY=[],Lg.PROP_EMPTY={},Lg.NOTICE_DISPLAY=1,Lg.MOUSEENABLE=2,Lg}(),Lba=function(La){function Lm(La){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Lm.__super.call(this),this._padding=Lm._PADDING,this._spacing=Lm._SPACING,this._aligns=Lm._ALIGNS,this._font=Lo.EMPTY,this._ower=La}Lq(Lm,"laya.display.css.CSSStyle",La);var Lb=Lm.prototype;return Lb.destroy=function(){this._ower=null,this._font=null,this._rect=null},Lb.inherit=function(La){this._font=La._font,this._spacing=La._spacing===Lm._SPACING?Lm._SPACING:La._spacing.slice(),this.lineHeight=La.lineHeight},Lb._widthAuto=function(){return 0!=(262144&this._type)},Lb.widthed=function(La){return 0!=(8&this._type)},Lb._calculation=function(La,Lb){if(Lb.indexOf("%")<0)return!1;var Ld=this._ower,Le=Ld.parent,Lf=this._rect;function Lg(La,Lb,Lc){return La*Lc[0]+Lb*Lc[1]+Lc[2]}function Lc(La){var Lb=Le.width,Lc=Ld.width;Lf.width&&(Ld.width=Lg(Lb,Lc,Lf.width)),Lf.height&&(Ld.height=Lg(Lb,Lc,Lf.height)),Lf.left&&(Ld.x=Lg(Lb,Lc,Lf.left)),Lf.top&&(Ld.y=Lg(Lb,Lc,Lf.top))}null===Lf&&(Le._getCSSStyle()._type|=524288,Le.on("resize",this,Lc),this._rect=Lf={input:{}});var Lh=Lb.split(" ");return Lh[0]=parseFloat(Lh[0])/100,1==Lh.length?Lh[1]=Lh[2]=0:(Lh[1]=parseFloat(Lh[1])/100,Lh[2]=parseFloat(Lh[2])),Lf[La]=Lh,Lf.input[La]=Lb,Lc(),!0},Lb.heighted=function(La){return 0!=(8192&this._type)},Lb.size=function(La,Lb){var Lc=this._ower,Ld=!1;-1!==La&&La!=this._ower.width&&(this._type|=8,this._ower.width=La,Ld=!0),-1!==Lb&&Lb!=this._ower.height&&(this._type|=8192,this._ower.height=Lb,Ld=!0),Ld&&(Lc._layoutLater(),524288&this._type&&Lc.event("resize",this))},Lb._getAlign=function(){return this._aligns[0]},Lb._getValign=function(){return this._aligns[1]},Lb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Lb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Lo(this._font))},Lb.render=function(La,Lb,Lc,Ld){var Le=La.width,Lf=La.height;Lc-=La.pivotX,Ld-=La.pivotY,this._bgground&&null!=this._bgground.color&&Lb.ctx.fillRect(Lc,Ld,Le,Lf,this._bgground.color),this._border&&this._border.color&&Lb.drawRect(Lc,Ld,Le,Lf,this._border.color.strColor,this._border.size)},Lb.getCSSStyle=function(){return this},Lb.cssText=function(La){this.attrs(Lm.parseOneCSS(La,";"))},Lb.attrs=function(La){if(La)for(var Lb=0,Lc=La.length;Lb<Lc;Lb++){var Ld=La[Lb];this[Ld[0]]=Ld[1]}},Lb.setTransform=function(La){"none"===La?this._tf=Lh._TF_EMPTY:this.attrs(Lm.parseOneCSS(La,","))},Lb.translate=function(La,Lb){this._tf===Lh._TF_EMPTY&&(this._tf=new Le),this._tf.translateX=La,this._tf.translateY=Lb},Lb.scale=function(La,Lb){this._tf===Lh._TF_EMPTY&&(this._tf=new Le),this._tf.scaleX=La,this._tf.scaleY=Lb},Lb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},Lk(0,Lb,"block",La.prototype._$get_block,function(La){La?this._type|=1:this._type&=-2}),Lk(0,Lb,"valign",function(){return Lm._valigndef[this._aligns[1]]},function(La){this._aligns===Lm._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Lm._valigndef[La]}),Lk(0,Lb,"height",null,function(La){if(this._type|=8192,"string"==typeof La){if(this._calculation("height",La))return;La=parseInt(La)}this.size(-1,La)}),Lk(0,Lb,"width",null,function(La){if(this._type|=8,"string"==typeof La){var Lb=La.indexOf("auto");if(0<=Lb&&(this._type|=262144,La=La.substr(0,Lb)),this._calculation("width",La))return;La=parseInt(La)}this.size(La,-1)}),Lk(0,Lb,"fontWeight",function(){return this._font.weight},function(La){this._createFont().weight=La}),Lk(0,Lb,"left",null,function(La){var Lb=this._ower;if("string"==typeof La){if("center"===La?La="50% -50% 0":"right"===La&&(La="100% -100% 0"),this._calculation("left",La))return;La=parseInt(La)}Lb.x=La}),Lk(0,Lb,"_translate",null,function(La){this.translate(La[0],La[1])}),Lk(0,Lb,"absolute",function(){return 0!=(4&this._type)}),Lk(0,Lb,"top",null,function(La){var Lb=this._ower;if("string"==typeof La){if("middle"===La?La="50% -50% 0":"bottom"===La&&(La="100% -100% 0"),this._calculation("top",La))return;La=parseInt(La)}Lb.y=La}),Lk(0,Lb,"align",function(){return Lm._aligndef[this._aligns[0]]},function(La){this._aligns===Lm._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Lm._aligndef[La]}),Lk(0,Lb,"bold",function(){return this._font.bold},function(La){this._createFont().bold=La}),Lk(0,Lb,"padding",function(){return this._padding},function(La){this._padding=La}),Lk(0,Lb,"leading",function(){return this._spacing[1]},function(La){"string"==typeof La&&(La=parseInt(La+"")),this._spacing===Lm._SPACING&&(this._spacing=[0,0]),this._spacing[1]=La}),Lk(0,Lb,"lineElement",function(){return 0!=(65536&this._type)},function(La){La?this._type|=65536:this._type&=-65537}),Lk(0,Lb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(La){this.lineElement=!1,"right"===La?this._type|=32768:this._type&=-32769}),Lk(0,Lb,"textDecoration",function(){return this._font.decoration},function(La){this._createFont().decoration=La}),Lk(0,Lb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(La){"nowrap"===La&&(this._type|=131072),"none"===La&&(this._type&=-131073)}),Lk(0,Lb,"background",null,function(La){La?(this._bgground||(this._bgground={}),this._bgground.color=La,this._ower.conchModel&&this._ower.conchModel.bgColor(La),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),Lk(0,Lb,"wordWrap",function(){return 0==(131072&this._type)},function(La){La?this._type&=-131073:this._type|=131072}),Lk(0,Lb,"color",function(){return this._font.color},function(La){this._createFont().color=La}),Lk(0,Lb,"password",function(){return this._font.password},function(La){this._createFont().password=La}),Lk(0,Lb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(La){"none"===La?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=La),this._ower.conchModel&&this._ower.conchModel.bgColor(La),this._ower._renderType|=256}),Lk(0,Lb,"font",function(){return this._font.toString()},function(La){this._createFont().set(La)}),Lk(0,Lb,"weight",null,function(La){this._createFont().weight=La}),Lk(0,Lb,"letterSpacing",function(){return this._spacing[0]},function(La){"string"==typeof La&&(La=parseInt(La+"")),this._spacing===Lm._SPACING&&(this._spacing=[0,0]),this._spacing[0]=La}),Lk(0,Lb,"fontSize",function(){return this._font.size},function(La){this._createFont().size=La}),Lk(0,Lb,"italic",function(){return this._font.italic},function(La){this._createFont().italic=La}),Lk(0,Lb,"fontFamily",function(){return this._font.family},function(La){this._createFont().family=La}),Lk(0,Lb,"stroke",function(){return this._font.stroke[0]},function(La){this._createFont().stroke===Lo._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=La}),Lk(0,Lb,"strokeColor",function(){return this._font.stroke[1]},function(La){this._createFont().stroke===Lo._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=La}),Lk(0,Lb,"border",function(){return this._border?this._border.value:""},function(La){if("none"!=La){this._border||(this._border={});var Lb=(this._border.value=La).split(" ");if(this._border.color=LS.create(Lb[Lb.length-1]),1==Lb.length)return this._border.size=1,void(this._border.type="solid");var Lc=0;0<Lb[0].indexOf("px")?(this._border.size=parseInt(Lb[0]),Lc++):this._border.size=1,this._border.type=Lb[Lc],this._ower._renderType|=256}else this._border=null}),Lk(0,Lb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(La){La?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==La?null:LS.create(La),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),Lk(0,Lb,"position",function(){return 4&this._type?"absolute":""},function(La){"absolute"==La?this._type|=4:this._type&=-5}),Lk(0,Lb,"display",null,function(La){switch(La){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),Lk(0,Lb,"paddingLeft",function(){return this.padding[3]}),Lk(0,Lb,"paddingTop",function(){return this.padding[0]}),Lk(0,Lb,"_scale",null,function(La){this._ower.scale(La[0],La[1])}),Lk(0,Lb,"_rotate",null,function(La){this._ower.rotation=La}),Lm.parseOneCSS=function(La,Lb){for(var Lc,Ld=[],Le=La.split(Lb),Lf=0,Lg=Le.length;Lf<Lg;Lf++){var Lh=Le[Lf],Li=Lh.indexOf(":"),Lj=Lh.substr(0,Li).replace(/^\s+|\s+$/g,"");if(0!=Lj.length){var Lk=Lh.substr(Li+1).replace(/^\s+|\s+$/g,""),Ll=[Lj,Lk];switch(Lj){case"italic":case"bold":Ll[1]="true"==Lk;break;case"line-height":Ll[0]="lineHeight",Ll[1]=parseInt(Lk);break;case"font-size":Ll[0]="fontSize",Ll[1]=parseInt(Lk);break;case"padding":1<(Lc=Lk.split(" ")).length||(Lc[1]=Lc[2]=Lc[3]=Lc[0]),Ll[1]=[parseInt(Lc[0]),parseInt(Lc[1]),parseInt(Lc[2]),parseInt(Lc[3])];break;case"rotate":Ll[0]="_rotate",Ll[1]=parseFloat(Lk);break;case"scale":Lc=Lk.split(" "),Ll[0]="_scale",Ll[1]=[parseFloat(Lc[0]),parseFloat(Lc[1])];break;case"translate":Lc=Lk.split(" "),Ll[0]="_translate",Ll[1]=[parseInt(Lc[0]),parseInt(Lc[1])];break;default:(Ll[0]=Lm._CSSTOVALUE[Lj])||(Ll[0]=Lj)}Ld.push(Ll)}}return Ld},Lm.parseCSS=function(La,Lb){for(var Lc;null!=(Lc=Lm._parseCSSRegExp.exec(La));)Lm.styleSheets[Lc[1]]=Lm.parseOneCSS(Lc[2],";")},Lm.EMPTY=new Lm(null),Lm._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Lm._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Lm._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Lm._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Lm.styleSheets={},Lm.ALIGN_CENTER=1,Lm.ALIGN_RIGHT=2,Lm.VALIGN_MIDDLE=1,Lm.VALIGN_BOTTOM=2,Lm._CSS_BLOCK=1,Lm._DISPLAY_NONE=2,Lm._ABSOLUTE=4,Lm._WIDTH_SET=8,Lm._PADDING=[0,0,0,0],Lm._RECT=[-1,-1,-1,-1],Lm._SPACING=[0,0],Lm._ALIGNS=[0,0,0],Lm.ADDLAYOUTED=512,Lm._NEWFONT=4096,Lm._HEIGHT_SET=8192,Lm._BACKGROUND_SET=16384,Lm._FLOAT_RIGHT=32768,Lm._LINE_ELEMENT=65536,Lm._NOWARP=131072,Lm._WIDTHAUTO=262144,Lm._LISTERRESZIE=524288,Lm}(Lh),Lca=function(La){function Lg(){this.url=null,this.audio=null,this.loaded=!1,Lg.__super.call(this)}Lq(Lg,"laya.media.h5audio.AudioSound",Lj);var Lb=Lg.prototype;return Lb.dispose=function(){var La=Lg._audioCache[this.url];La&&(La.src="",delete Lg._audioCache[this.url])},Lb.load=function(La){var Lb;if(La=LI.formatURL(La),(this.url=La)==LE._tMusic?(Lg._initMusicAudio(),(Lb=Lg._musicAudio).src!=La&&(Lg._audioCache[Lb.src]=null,Lb=null)):Lb=Lg._audioCache[La],Lb&&2<=Lb.readyState)this.event("complete");else{Lb||(Lb=La==LE._tMusic?(Lg._initMusicAudio(),Lg._musicAudio):LO.createElement("audio"),(Lg._audioCache[La]=Lb).src=La),Lb.addEventListener("canplaythrough",Ld),Lb.addEventListener("error",Le);var Lc=this;(this.audio=Lb).load?Lb.load():Le()}function Ld(){Lf(),Lc.loaded=!0,Lc.event("complete")}function Le(){Lb.load=null,Lf(),Lc.event("error")}function Lf(){Lb.removeEventListener("canplaythrough",Ld),Lb.removeEventListener("error",Le)}},Lb.play=function(La,Lb,Lc){if(void 0===La&&(La=0),void 0===Lb&&(Lb=0),!this.url)return null;var Ld,Le;if(!(Ld=this.url==LE._tMusic?Lg._musicAudio:Lg._audioCache[this.url]))return null;Le=LW.getItem("audio:"+this.url),LJ.isConchApp?Le||((Le=LO.createElement("audio")).src=this.url):this.url==LE._tMusic?(Lg._initMusicAudio(),(Le=Lg._musicAudio).src=this.url):Le=Le||Ld.cloneNode(!0);var Lf=new Lma(Le);return Lf.url=this.url,Lf.loops=Lb,Lf.startTime=La,Lf.startHandler=Lc,Lf.play(!1),LE.addChannel(Lf),Lf},Lk(0,Lb,"duration",function(){var La;return(La=Lg._audioCache[this.url])?La.duration:0}),Lg._initMusicAudio=function(){Lg._musicAudio||(Lg._musicAudio||(Lg._musicAudio=LO.createElement("audio")),LJ.isConchApp||LO.document.addEventListener("mousedown",Lg._makeMusicOK))},Lg._makeMusicOK=function(){LO.document.removeEventListener("mousedown",Lg._makeMusicOK),Lg._musicAudio.src?Lg._musicAudio.play():(Lg._musicAudio.src="",Lg._musicAudio.load())},Lg._audioCache={},Lg._musicAudio=null,Lg}(),Lda=function(La){function Lb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Lb.__super.call(this)}Lq(Lb,"laya.media.SoundChannel",Lj);var Lc=Lb.prototype;return Lc.play=function(){},Lc.stop=function(){},Lc.pause=function(){},Lc.resume=function(){},Lc.__runComplete=function(La){La&&La.run()},Lk(0,Lc,"volume",function(){return 1},function(La){}),Lk(0,Lc,"position",function(){return 0}),Lk(0,Lc,"duration",function(){return 0}),Lb}(),Lea=function(La){function Lb(){Lb.__super.call(this)}Lq(Lb,"laya.media.Sound",Lj);var Lc=Lb.prototype;return Lc.load=function(La){},Lc.play=function(La,Lb,Lc){return void 0===La&&(La=0),void 0===Lb&&(Lb=0),null},Lc.dispose=function(){},Lk(0,Lc,"duration",function(){return 0}),Lb}(),Lfa=function(La){function Le(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,Le.__super.call(this)}Lq(Le,"laya.media.webaudio.WebAudioSound",Lj);var Lb=Le.prototype;return Lb.load=function(La){this.url=La,this.audioBuffer=Le._dataCache[La],this.audioBuffer?this._loaded(this.audioBuffer):(Le.e.on("loaded:"+La,this,this._loaded),Le.e.on("err:"+La,this,this._err),Le.__loadingSound[La]||(Le.__loadingSound[La]=!0,Lz.loader.load(La,Ls.create(this,this.onloaded),null,Lha.BUFFER,4,!1,null,!0)))},Lb.onloaded=function(La){La||this._err(),this._disposed?this._removeLoadEvents():(this.data=La,Le.buffs.push({buffer:this.data,url:this.url}),Le.decode())},Lb._err=function(){if(this._removeLoadEvents(),Le.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var La,Lb,Lc,Ld=0;for(La=(Lb=this.__toPlays).length,Ld=0;Ld<La;Ld++)(Lc=Lb[Ld])[3]&&!Lc[3].isStopped&&Lc[3].event("error");this.__toPlays.length=0}},Lb._loaded=function(La){this._removeLoadEvents(),this._disposed||(this.audioBuffer=La,this.loaded=!0,this.event("complete"))},Lb._removeLoadEvents=function(){Le.e.off("loaded:"+this.url,this,this._loaded),Le.e.off("err:"+this.url,this,this._err)},Lb.__playAfterLoaded=function(){if(this.__toPlays){var La,Lb,Lc,Ld=0;for(La=(Lb=this.__toPlays).length,Ld=0;Ld<La;Ld++)(Lc=Lb[Ld])[3]&&!Lc[3].isStopped&&this.play(Lc[0],Lc[1],Lc[2],Lc[3]);this.__toPlays.length=0}},Lb.play=function(La,Lb,Lc,Ld){return void 0===La&&(La=0),void 0===Lb&&(Lb=0),Ld=Ld||new Lna,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([La,Lb,Lc,Ld]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Ld.url=this.url,Ld.loops=Lb,Ld.audioBuffer=this.audioBuffer,Ld.startTime=La,Ld.startHandler=Lc,Ld.play(!1),LE.addChannel(Ld),Ld},Lb.dispose=function(){this._disposed=!0,delete Le._dataCache[this.url],delete Le.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},Lk(0,Lb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Le.decode=function(){if(!(Le.buffs.length<=0||Le.isDecoding))if(Le.isDecoding=!0,(Le.tInfo=Le.buffs.shift())&&Le.tInfo.buffer&&Le.tInfo.buffer.byteLength)try{Le.ctx.decodeAudioData(Le.tInfo.buffer,Le._done,Le._fail)}catch(La){console.error("decodeAudioData error  byteLength:"+Le.tInfo.buffer.byteLength+"  url:"+Le.tInfo.url)}else Le._fail()},Le._done=function(La){Le.e.event("loaded:"+Le.tInfo.url,La),Le._dataCache[Le.tInfo.url]=La,Le.isDecoding=!1,Le.decode()},Le._fail=function(){Le.e.event("err:"+Le.tInfo.url,null),Le.isDecoding=!1,Le.decode()},Le._playEmptySound=function(){if(null!=Le.ctx){if(Le._emptySource&&(Le._emptySource.stop(),Le._emptySource.disconnect(0),!Lna._tryCleanFailed))try{Le._emptySource.buffer=null}catch(La){Lna._tryCleanFailed=!0}var La=Le.ctx.createBufferSource();La.buffer=Le._miniBuffer,La.connect(Le.ctx.destination),La.start(0,0,0),Le._emptySource=La}},Le._unlock=function(){Le._unlocked||(Le._playEmptySound(),"running"==Le.ctx.state?(LO.document.removeEventListener("mousedown",Le._unlock,!0),LO.document.removeEventListener("touchend",Le._unlock,!0),LO.document.removeEventListener("touchstart",Le._unlock,!0),Le._unlocked=!0):"suspended"==Le.ctx.state&&LE._recoverWebAudio())},Le.initWebAudio=function(){"running"!=Le.ctx.state&&(Le._unlock(),LO.document.addEventListener("mousedown",Le._unlock,!0),LO.document.addEventListener("touchend",Le._unlock,!0),LO.document.addEventListener("touchstart",Le._unlock,!0))},Le._emptySource=null,Le._dataCache={},Le.buffs=[],Le.isDecoding=!1,Le._unlocked=!1,Le.tInfo=null,Le.__loadingSound={},Li(Le,["window",function(){return this.window=LO.window},"webAudioEnabled",function(){return this.webAudioEnabled=Le.window.AudioContext||Le.window.webkitAudioContext||Le.window.mozAudioContext},"ctx",function(){return this.ctx=Le.webAudioEnabled?new(Le.window.AudioContext||Le.window.webkitAudioContext||Le.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=Le.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new Lj}]),Le}(),Lga=function(La){function Lb(){this._responseType=null,this._data=null,Lb.__super.call(this),this._http=new LO.window.XMLHttpRequest}Lq(Lb,"laya.net.HttpRequest",Lj);var Lc=Lb.prototype;return Lc.send=function(La,Lb,Lc,Ld,Le){void 0===Lc&&(Lc="get"),void 0===Ld&&(Ld="text"),this._responseType=Ld,this._data=null;var Lf=this,Lg=this._http;if(Lg.open(Lc,La,!0),Le)for(var Lh=0;Lh<Le.length;Lh++)Lg.setRequestHeader(Le[Lh++],Le[Lh]);else LJ.isConchApp||(Lb&&"string"!=typeof Lb?Lg.setRequestHeader("Content-Type","application/json"):Lg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));Lg.responseType="arraybuffer"!==Ld?"text":"arraybuffer",Lg.onerror=function(La){Lf._onError(La)},Lg.onabort=function(La){Lf._onAbort(La)},Lg.onprogress=function(La){Lf._onProgress(La)},Lg.onload=function(La){Lf._onLoad(La)},Lg.send(Lb)},Lc._onProgress=function(La){La&&La.lengthComputable&&this.event("progress",La.loaded/La.total)},Lc._onAbort=function(La){this.error("Request was aborted by user")},Lc._onError=function(La){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},Lc._onLoad=function(La){var Lb=this._http,Lc=void 0!==Lb.status?Lb.status:200;200===Lc||204===Lc||0===Lc?this.complete():this.error("["+Lb.status+"]"+Lb.statusText+":"+Lb.responseURL)},Lc.error=function(La){this.clear(),this.event("error",La)},Lc.complete=function(){this.clear();var Lb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=L$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(La){Lb=!1,this.error(La.message)}Lb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},Lc.clear=function(){var La=this._http;La.onerror=La.onabort=La.onprogress=La.onload=null},Lk(0,Lc,"url",function(){return this._http.responseURL}),Lk(0,Lc,"http",function(){return this._http}),Lk(0,Lc,"data",function(){return this._data}),Lb}(),Lha=function(La){function LC(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,LC.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}Lq(LC,"laya.net.Loader",Lj);var Lb=LC.prototype;return Lb.load=function(La,Lb,Lc,Ld,Le){if(La&&""!=La||console.error("Loader 加载的url不合法 "+La),void 0===Lc&&(Lc=!0),void 0===Le&&(Le=!1),this._url=La,this._base64=!1,0===La.indexOf("data:image")?(this._base64=!0,this._type=Lb="image"):this._type=Lb||(Lb=this.getTypeFromUrl(La)),this._cache=Lc,this._data=null,!Le&&LC.loadedMap[La])return this._data=LC.loadedMap[La],this.event("progress",1),void this.event("complete",this._data);if(Ld&&LC.setGroup(La,Ld),null!=LC.parserMap[Lb])return this._customParse=!0,void(LC.parserMap[Lb]instanceof laya.utils.Handler?LC.parserMap[Lb].runWith(this):LC.parserMap[Lb].call(null,this));if("image"===Lb||"htmlimage"===Lb||"nativeimage"===Lb)return this._loadImage(La);if("ttf"===Lb)return this._loadTTF(La);switch(Lb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Lb}LC.preLoadedMap[La]?this.onLoaded(LC.preLoadedMap[La]):Ln.resMgrLoad(La,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Lb.getTypeFromUrl=function(La){var Lb=L$.getFileExtension(La);return Lb?LC.typeMap[Lb]:(console.warn("Not recognize the resources suffix",La),"text")},Lb._loadTTF=function(La){La=LI.formatURL(La);var Lb=new LH;Lb.complete=Ls.create(this,this.onLoaded),Lb.load(La)},Lb._loadBase64Image=function(Lb){Lb=LI.formatURL(Lb);var Lc,La=this;function Ld(){Lc.onload=null,Lc.onerror=null,delete LC.imgCache[Lb]}function Le(){Ld(),La.onLoaded(Lc)}function Lf(){Ld(),La.event("error","Load image failed")}"nativeimage"===this._type?((Lc=new LO.window.Image).crossOrigin="",Lc.onload=Le,Lc.onerror=Lf,Lc.src=Lb,LC.imgCache[Lb]=Lc):new Lya.create(Lb,{onload:Le,onerror:Lf,onCreate:function(La){Lc=La,LC.imgCache[Lb]=La}})},Lb._loadImage=function(La){this._base64?this._loadBase64Image(La):Ln.imgMgrLoad(La,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Lb._loadImageComplete=function(La,Lb,Lc){if(null!=Lc)if(Lc instanceof ArrayBuffer){var Ld=new DataView(Lc),Le=new laya.webgl.resource.WebGLImage(new Uint8Array(Lc,8),La,0,!1,Ld.getUint32(0),Ld.getUint32(4));this.onLoaded(Le)}else if(Lc instanceof Lka)LC.imgMgrSet[La]=Lb,Ln.imgMgrLock(La,LC.imgMgrSet[La]),this._url=La,this.complete(Lc);else{var Lf=-1!=La.indexOf(".png",La.length-4)?6408:6407;Le=new laya.webgl.resource.WebGLImage(Lc,La,Lf,!1,Lc.width,Lc.height);this.onLoaded(Le)}else this.event("error","Load image failed")},Lb.imageCancel=function(La,Lb,Lc){Ln.imgMgrCancel&&Ln.imgMgrCancel(La,this._onImageCallback)},Lb._loadSound=function(La){var Lb=new LE._soundClass,Lc=this;function Ld(){Lb.offAll()}Lb.on("complete",this,function(){Ld(),Lc.onLoaded(Lb)}),Lb.on("error",this,function(){Ld(),Lb.dispose(),Lc.event("error","Load sound failed")}),Lb.load(La)},Lb.onProgress=function(La){"atlas"===this._type?this.event("progress",.3*La):this.event("progress",La)},Lb.onError=function(La){this.event("error",La)},Lb._loadedComplete=function(La,Lb,Lc){if(null!=Lc)switch(this._type){case"atlas":case"plf":case"json":var Ld=new LP(Lc);this.onLoaded(JSON.parse(Ld.readUTFBytes()));break;case"font":Ld=new LP(Lc);this.onLoaded(L$.parseXMLFromString(Ld.readUTFBytes()));break;default:this.onLoaded(Lc)}else this.event("error",La)},Lb.onLoaded=function(La){var Lb=this._type;if("plf"==Lb)this.parsePLFData(La),this.complete(La);else if("image"===Lb){var Lc=new Lka(La);Lc.url=this._url,this.complete(Lc)}else if("sound"===Lb||"htmlimage"===Lb||"nativeimage"===Lb)this.complete(La);else if("atlas"===Lb){if(!La.src&&!La._setContext){if(!this._data){if((this._data=La).meta&&La.meta.image)for(var Ld=La.meta.image.split(","),Le=0<=this._url.indexOf("/")?"/":"\\",Lf=this._url.lastIndexOf(Le),Lg=0<=Lf?this._url.substr(0,Lf+1):"",Lh=0,Li=Ld.length;Lh<Li;Lh++)Ld[Lh]=Lg+Ld[Lh];else Ld=[this._url.replace(".json",".png")];Ld.reverse(),La.toLoads=Ld,La.pics=[]}return this.event("progress",.3+1/Ld.length*.6),this._loadImage(Ld.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(La),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var Lj=this._data.frames,Lk=this._url.split("?")[0],Ll=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:Lk.substring(0,Lk.lastIndexOf("."))+"/",Lm=this._data.pics,Ln=LI.formatURL(this._url),Lo=LC.atlasMap[Ln]||(LC.atlasMap[Ln]=[]);Lo.dir=Ll;var Lp=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Lq in Lp=parseFloat(this._data.meta.scale),Lj){var Lr,Ls=Lj[Lq],Lt=Lm[Ls.frame.idx?Ls.frame.idx:0],Lu=LI.formatURL(Ll+Lq);Lt.scaleRate=Lp,Lr=Lka.create(Lt,Ls.frame.x,Ls.frame.y,Ls.frame.w,Ls.frame.h,Ls.spriteSourceSize.x,Ls.spriteSourceSize.y,Ls.sourceSize.w,Ls.sourceSize.h),LC.cacheRes(Lu,Lr),LC.keepCache(this._url,Ll+Lq),Lr.url=Lu,Lo.push(Lu)}else for(Lq in Lj)Lt=Lm[(Ls=Lj[Lq]).frame.idx?Ls.frame.idx:0],Lu=LI.formatURL(Ll+Lq),LC.cacheRes(Lu,Lka.create(Lt,Ls.frame.x,Ls.frame.y,Ls.frame.w,Ls.frame.h,Ls.spriteSourceSize.x,Ls.spriteSourceSize.y,Ls.sourceSize.w,Ls.sourceSize.h)),LC.loadedMap[Lu].url=Lu,LC.keepCache(this._url,Ll+Lq),Lo.push(Lu);delete this._data.pics,this.complete(this._data)}else if("font"==Lb){if(!La.src)return this._data=La,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var Lv=new LD;Lv.parseFont(this._data,La);var Ly=this._url.split(".fnt")[0].split("/"),Lz=Ly[Ly.length-1];Lqa.registerBitmapFont(Lz,Lv),this._data=Lv,this.complete(this._data)}else if("pkm"==Lb){var LA=Lya.create(La,this._url),LB=new Lka(LA);LB.url=this._url,this.complete(LB)}else this.complete(La)},Lb.parsePLFData=function(La){var Lb,Lc,Ld;for(Lb in La)switch(Ld=La[Lb],Lb){case"json":case"text":for(Lc in Ld)LC.preLoadedMap[LI.formatURL(Lc)]=Ld[Lc];break;default:for(Lc in Ld)LC.preLoadedMap[LI.formatURL(Lc)]=Ld[Lc]}},Lb.complete=function(La){this._data=La,this._customParse?this.event("loaded",La instanceof Array?[La]:La):(LC._loaders.push(this),LC._isWorking||LC.checkNext())},Lb.endLoad=function(La){La&&(this._data=La),this._cache&&LC.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},Lk(0,Lb,"url",function(){return this._url}),Lk(0,Lb,"data",function(){return this._data}),Lk(0,Lb,"cache",function(){return this._cache}),Lk(0,Lb,"type",function(){return this._type}),LC.checkNext=function(){LC._isWorking=!0;for(var La=LO.now();LC._startIndex<LC._loaders.length;)if(LO.now(),LC._loaders[LC._startIndex].endLoad(),LC._startIndex++,LO.now()-La>LC.maxTimeOut)return console.warn("loader callback cost a long time:"+(LO.now()-La)+" url="+LC._loaders[LC._startIndex-1].url),void Lz.timer.frameOnce(1,null,LC.checkNext);LC._loaders.length=0,LC._startIndex=0,LC._isWorking=!1},LC.clearRes=function(La,Lb){if(null!=La){void 0===Lb&&(Lb=!1),La=LI.formatURL(La);var Lc=LC.getAtlas(La);if(Lc){for(var Ld=0,Le=Lc.length;Ld<Le;Ld++){var Lf=Lc[Ld],Lg=LC.getRes(Lf);delete LC.loadedMap[Lf],LC.clearCache(La.substring(LI.basePath.length),Lf.substring(LI.basePath.length)),Lg&&Lg.destroy(Lb)}Lc.length=0,delete LC.atlasMap[La],delete LC.loadedMap[La]}else{var Lh=LC.loadedMap[La];Lh&&(delete LC.loadedMap[La],Lh instanceof laya.resource.Texture&&Lh.bitmap&&Lh.destroy(Lb))}}},LC.clearTextureRes=function(La){La=LI.formatURL(La);var Lb=laya.net.Loader.getAtlas(La),Lc=Lb&&0<Lb.length?laya.net.Loader.getRes(Lb[0]):laya.net.Loader.getRes(La);Lc&&Lc.bitmap&&(LJ.isConchApp&&!LJ.isConchWebGL?Lc.bitmap.source.releaseTexture&&Lc.bitmap.source.releaseTexture():null==Lc.bitmap._atlaser&&Lc.bitmap.releaseResource(!0))},LC.getRes=function(La){return LC.loadedMap[LI.formatURL(La)]},LC.getAtlas=function(La){return LC.atlasMap[LI.formatURL(La)]},LC.cacheRes=function(La,Lb){La=LI.formatURL(La),null!=LC.loadedMap[La]?console.warn("Resources already exist,is repeated loading:",La):LC.loadedMap[La]=Lb},LC.setGroup=function(La,Lb){LC.groupMap[Lb]||(LC.groupMap[Lb]=[]),LC.groupMap[Lb].push(La)},LC.clearResByGroup=function(La){if(LC.groupMap[La]){var Lb=LC.groupMap[La],Lc=0,Ld=Lb.length;for(Lc=0;Lc<Ld;Lc++)LC.clearRes(Lb[Lc]);Lb.length=0}},LC.keepCache=function(La,Lb){if(La&&Lb){var Lc=LC.cacheSet[Lb];Lc?-1==Lc.indexOf(La)&&Lc.push(La):LC.cacheSet[Lb]=[La]}},LC.clearCache=function(La,Lb){if(La&&Lb){var Lc=LC.cacheSet[Lb];if(Lc){var Ld=Lc.indexOf(La);if(-1!==Ld){var Le=Lc.length-1;0==Le?(delete LC.cacheSet[Lb],0<LC.imgMgrSet[Lb]?Ln.imgMgrFree(Lb,LC.imgMgrSet[Lb]):LC.clearRes(Lb,!0)):(Lc[Ld]=Lc[Le],Lc.length=Le)}}}},LC.saveObject=function(La,Lb,Lc){if(Lb&&La){var Ld=LC.objectSet[La];Ld?(console.warn("Loader.saveObject: "+La),Ld[0]=Lb,Ld[1]=Lc):LC.objectSet[La]=[Lb,Lc,[]]}},LC.findObject=function(La){if(La){var Lb=LC.objectSet[La];if(Lb)return Lb[0]}return null},LC.keepObject=function(La,Lb){if(La&&Lb){var Lc=LC.objectSet[Lb];Lc&&-1===Lc[2].indexOf(La)&&Lc[2].push(La)}},LC.clearObject=function(La,Lb){if(La&&Lb){var Lc=LC.objectSet[Lb];if(Lc){var Ld=Lc[2],Le=Ld.indexOf(La);if(-1!==Le){var Lf=Ld.length-1;0==Lf?(delete LC.objectSet[Lb],Lc[1]&&Lc[1].call(null,Lc[0])):(Ld[Le]=Ld[Lf],Ld.length=Lf)}}}},LC.TEXT="text",LC.JSON="json",LC.XML="xml",LC.BUFFER="arraybuffer",LC.IMAGE="image",LC.SOUND="sound",LC.ATLAS="atlas",LC.FONT="font",LC.TTF="ttf",LC.PLF="plf",LC.PKM="pkm",LC.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},LC.parserMap={},LC.groupMap={},LC.maxTimeOut=100,LC.loadedMap={},LC.preLoadedMap={},LC.atlasMap={},LC._loaders=[],LC._isWorking=!1,LC._startIndex=0,LC.imgCache={},LC.cacheSet={},LC.objectSet={},LC.imgMgrSet={},LC}(),Lia=function(La){var Lm;function Ln(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Ln.__super.call(this);for(var La=0;La<this._maxPriority;La++)this._resInfos[La]=[]}Lq(Ln,"laya.net.LoaderManager",Lj);var Lb=Ln.prototype;return Lb.create=function(La,Lc,Lb,Ld,Le,Lf,Lg,Lh){if(null==Lf&&(Lf=2),null==Lg&&(Lg=!0),La instanceof Array){var Li=La,Lj=Li.length,Lk=0;if(Lb)var Ll=Ls.create(Lb.caller,Lb.method,Lb.args,!1);for(var Lm=0;Lm<Lj;Lm++){var Ln=Li[Lm];"string"==typeof Ln&&(Ln=Li[Lm]={url:Ln}),Ln.progress=0}for(Lm=0;Lm<Lj;Lm++){Ln=Li[Lm];var Lo=Lb?Ls.create(null,Lr,[Ln],!1):null,Lp=Lb||Lc?Ls.create(null,Lq,[Ln]):null;this._create(Ln.url,Lp,Lo,Ln.clas||Ld,Ln.params||Le,null!=Ln.priority&&0<=Ln.priority?Ln.priority:Lf,Lg,Ln.group||Lh)}function Lq(La,Lb){Lk++,La.progress=1,Lk===Lj&&Lc&&Lc.run()}function Lr(La,Lb){La.progress=Lb;for(var Lc=0,Ld=0;Ld<Lj;Ld++){Lc+=Li[Ld].progress}var Le=Lc/Lj;Ll.runWith(Le)}return!0}return this._create(La,Lc,Lb,Ld,Le,Lf,Lg,Lh)},Lb._create=function(Lb,Lc,La,Ld,Le,Lf,Lg,Lh){Lb&&""!=Lb||console.error("加载的url不合法 "+Lb),null==Lf&&(Lf=2),null==Lg&&(Lg=!0);var Li=LI.formatURL(Lb),Lj=this.getRes(Li);if(Lj)!Lj.hasOwnProperty("loaded")||Lj.loaded?(La&&La.runWith(1),Lc&&Lc.run()):Lc&&Lz.loader._createListener(Lb,Lc.caller,Lc.method,Lc.args,!0,!1);else{var Lk=L$.getFileExtension(Lb),Ll=Ln.createMap[Lk];if(!Ll)throw new Error("LoaderManager:unknown file("+Lb+") extension with: "+Lk+".");Ld||(Ld=Ll[0]);var Lm=Ll[1];if("atlas"==Lk)this.load(Lb,Lc,La,Lm,Lf,Lg);else{Ld===Lka&&(Lm="htmlimage"),(Lj=Ld?new Ld:null).hasOwnProperty("_loaded")&&(Lj._loaded=!1),Lj._setUrl(Lb),Lh&&Lj._setGroup(Lh),this._createLoad(Lj,Lb,Ls.create(null,function(La){Lj&&!Lj.destroyed&&La&&Lj.onAsynLoaded.call(Lj,Lb,La,Le),Lc&&Lc.run();Lz.loader.event(Lb)}),La,Lm,Lf,!1,Lh,!0),Lg&&this.cacheRes(Li,Lj)}}return Lj},Lb.load=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){La&&""!=La||console.error("加载的url不合法 "+La);var Li=this;if(null==Le&&(Le=2),null==Lf&&(Lf=!0),void 0===Lh&&(Lh=!1),La instanceof Array)return this._loadAssets(La,Lb,Lc,Ld,Le,Lf,Lg);var Lj=Lha.getRes(La);if(null!=Lj)Lz.timer.frameOnce(1,null,function(){Lc&&Lc.runWith(1),Lb&&Lb.runWith(Lj),Li._loaderCount||Li.event("complete")});else{var Lk=Ln._resMap[La];Lk?(Lb&&Lk._createListener("complete",Lb.caller,Lb.method,Lb.args,!1,!1),Lc&&Lk._createListener("progress",Lc.caller,Lc.method,Lc.args,!1,!1)):((Lk=this._infoPool.length?this._infoPool.pop():new Lm).url=La,Lk.clas=null,Lk.type=Ld,Lk.cache=Lf,Lk.group=Lg,Lk.ignoreCache=Lh,Lk.priority=Le,Lb&&Lk.on("complete",Lb.caller,Lb.method,Lb.args),Lc&&Lk.on("progress",Lc.caller,Lc.method,Lc.args),Ln._resMap[La]=Lk,Le=Le<this._maxPriority?0<=Le?Le:0:this._maxPriority-1,this._resInfos[Le].push(Lk),this._next())}return this},Lb.cancel=function(La,Lb,Lc){if(Lj=Ln._resMap[La]){Lb&&Lj.off("complete",Lb.caller,Lb.method,!1),Lc&&Lj.off("progress",Lc.caller,Lc.method,!1);var Ld=Lj.getListener("complete"),Le=Lj.getListener("progress");if(!(Ld&&Ld.head||Le&&Le.head)){if(Lj.loader){var Lf=Lj.loader;Lf.imageCancel(La),Lf.offAll(),Lf._data=null,Lf._customParse=!1,Lf._url=null,Lf._class=null,Lf._type=null,this._loaders.push(Lf),this._loaderCount--,delete this._loaderMap[Lj.url]}for(var Lg=0;Lg<this._maxPriority;Lg++)for(var Lh=this._resInfos[Lg],Li=Lh.length-1;-1<Li;Li--){var Lj;(Lj=Lh[Li])&&Lj.url===La&&(Lh[Li]=null,Lj.destroy(),Lj.offAll(),this._infoPool.push(Lj))}delete Ln._resMap[La],this._next()}}},Lb._createLoad=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){var Lj=this;if(null==Lf&&(Lf=2),null==Lg&&(Lg=!0),void 0===Li&&(Li=!1),Lb instanceof Array)return this._loadAssets(Lb,Lc,Ld,Le,Lf,Lg,Lh);var Lk=Lha.getRes(Lb);if(null!=Lk)Lz.timer.frameOnce(1,null,function(){Ld&&Ld.runWith(1),Lc&&Lc.runWith(Lk),Lj._loaderCount||Lj.event("complete")});else{var Ll=Ln._resMap[Lb];Ll?(Lc&&Ll._createListener("complete",Lc.caller,Lc.method,Lc.args,!1,!1),Ld&&Ll._createListener("progress",Ld.caller,Ld.method,Ld.args,!1,!1)):((Ll=this._infoPool.length?this._infoPool.pop():new Lm).url=Lb,Ll.clas=La,Ll.type=Le,Ll.cache=Lg,Ll.group=Lh,Ll.ignoreCache=Li,Ll.priority=Lf,Lc&&Ll.on("complete",Lc.caller,Lc.method,Lc.args),Ld&&Ll.on("progress",Ld.caller,Ld.method,Ld.args),Ln._resMap[Lb]=Ll,Lf=Lf<this._maxPriority?0<=Lf?Lf:0:this._maxPriority-1,this._resInfos[Lf].push(Ll),this._next())}return this},Lb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var La=0;La<this._maxPriority;La++)for(var Lb=this._resInfos[La];0<Lb.length;){var Lc=Lb.shift();if(Lc)return this._doLoad(Lc)}this._loaderCount||this.event("complete")}},Lb._doLoad=function(Lb){var Lc=this._loaders.length?this._loaders.pop():new Lha;this._loaderCount++,(this._loaderMap[Lb.url]=Lc).on("complete",null,Le),Lc.on("progress",null,function(La){Lb.event("progress",La)}),Lc.on("error",null,function(La){Le(null)}),Lb.loader=Lc;var Ld=this;function Le(La){Lc.offAll(),Lc._data=null,Lc._customParse=!1,Lc._url=null,Lc._class=null,Lc._type=null,Ld._loaders.push(Lc),Ld._loaderCount--,delete Ld._loaderMap[Lb.url],Ld._endLoad(Lb,La instanceof Array?[La]:La),Ld._next()}Lc._class=Lb.clas,1<=Lb.priority?(Lc.priority=Lb.priority,Lc.realTime=!1):(Lc.priority=0,Lc.realTime=!0),Lc.load(Lb.url,Lb.type,Lb.cache,Lb.group,Lb.ignoreCache)},Lb._endLoad=function(La,Lb){var Lc=La.url;if(null==Lb){var Ld=this._failRes[Lc]||0;if(Ld<this.retryNum)return console.warn("[warn]Retry to load:",Lc),this._failRes[Lc]=Ld+1,void Lz.timer.once(this.retryDelay,this,this._addReTry,[La],!1);console.warn("[error]Failed to load:",Lc),this.event("error",Lc)}this._failRes[Lc]&&(this._failRes[Lc]=0),delete Ln._resMap[Lc],La.event("complete",Lb),La.destroy(),La.offAll(),this._infoPool.push(La)},Lb._addReTry=function(La){this._resInfos[this._maxPriority-1].push(La),this._next()},Lb.clearRes=function(La,Lb){void 0===Lb&&(Lb=!1),Lha.clearRes(La,Lb)},Lb.getRes=function(La){return Lha.getRes(La)},Lb.cacheRes=function(La,Lb){Lha.cacheRes(La,Lb)},Lb.clearTextureRes=function(La){Lha.clearTextureRes(La)},Lb.setGroup=function(La,Lb){Lha.setGroup(La,Lb)},Lb.clearResByGroup=function(La){Lha.clearResByGroup(La)},Lb.clearUnLoaded=function(){for(var La=0;La<this._maxPriority;La++){for(var Lb=this._resInfos[La],Lc=Lb.length-1;-1<Lc;Lc--){var Ld=Lb[Lc];Ld&&(Ld.destroy(),Ld.offAll(),this._infoPool.push(Ld))}Lb.length=0}this._loaderCount=0,Ln._resMap={}},Lb.cancelLoadByUrls=function(La){if(La)for(var Lb=0,Lc=La.length;Lb<Lc;Lb++)this.cancelLoadByUrl(La[Lb])},Lb.cancelLoadByUrl=function(La){for(var Lb=0;Lb<this._maxPriority;Lb++)for(var Lc=this._resInfos[Lb],Ld=Lc.length-1;-1<Ld;Ld--){var Le=Lc[Ld];Le&&Le.url===La&&(Lc[Ld]=null,Le.destroy(),Le.offAll(),this._infoPool.push(Le))}Ln._resMap[La]&&delete Ln._resMap[La]},Lb._loadAssets=function(La,Lc,Lg,Lb,Ld,Le,Lf){null==Ld&&(Ld=2),null==Le&&(Le=!0);for(var Lh=La.length,Li=0,Lj=0,Lk=[],Ll=!0,Lm=0;Lm<Lh;Lm++){var Ln=La[Lm];if(!Ln)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+La);"string"==typeof Ln&&(Ln={url:Ln,type:Lb,size:1,priority:Ld}),Ln.size||(Ln.size=1),Ln.progress=0,Lj+=Ln.size,Lk.push(Ln);var Lo=Lg?Ls.create(null,Lr,[Ln],!1):null,Lp=Lc||Lg?Ls.create(null,Lq,[Ln]):null;this.load(Ln.url,Lp,Lo,Ln.type,null!=Ln.priority&&0<=Ln.priority?Ln.priority:2,Le,Ln.group||Lf)}function Lq(La,Lb){Li++,La.progress=1,Lb||(Ll=!1),Li===Lh&&Lc&&Lc.runWith(Ll)}function Lr(La,Lb){if(null!=Lg){La.progress=Lb;for(var Lc=0,Ld=0;Ld<Lk.length;Ld++){var Le=Lk[Ld];Lc+=Le.size*Le.progress}var Lf=Lc/Lj;Lg.runWith(Lf)}}return this},Ln.cacheRes=function(La,Lb){Lha.cacheRes(La,Lb)},Ln._resMap={},Li(Ln,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Ln.__init$=function(){Lm=function(La){function Lb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,Lb.__super.call(this)}return Lq(Lb,"",Lj),Lb.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},Lb}()},Ln}(),Lja=(function(La){function Le(La){Le.__super.call(this),La||(La=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Lb=0,Lc=0,Ld=0;Ld<20;Ld++)Ld%5!=4?this._mat[Lb++]=La[Ld]:this._alpha[Lc++]=La[Ld];this._action=LF.createFilterAction(32),this._action.data=this}Lq(Le,"laya.filters.ColorFilter",Lt);var Lb=Le.prototype;Lz.imps(Lb,{"laya.filters.IFilter":!0}),Lb.callNative=function(La){La._$P.cf=this;La.conchModel&&La.conchModel.setFilterMatrix&&La.conchModel.setFilterMatrix(this._mat,this._alpha)},Lk(0,Lb,"type",function(){return 32}),Lk(0,Lb,"action",function(){return this._action})}(),function(La){function Ld(La,Lb,Lc){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Lb&&(Lb=0),Ld.__super.call(this),this._byteClass=Lc||LP,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,La&&0<Lb&&Lb<65535&&this.connect(La,Lb)}Lq(Ld,"laya.net.Socket",Lj);var Lb=Ld.prototype;Lb.connect=function(La,Lb){var Lc="ws://"+La+":"+Lb;Lc="https:"==LO.window.location.protocol?"wss://"+La+":"+Lb:"ws://"+La+":"+Lb,this.connectByUrl(Lc)},Lb.connectByUrl=function(La){var Lb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new LO.window.WebSocket(La,this.protocols):this._socket=new LO.window.WebSocket(La),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(La){Lb._onOpen(La)},this._socket.onmessage=function(La){Lb._onMessage(La)},this._socket.onclose=function(La){Lb._onClose(La)},this._socket.onerror=function(La){Lb._onError(La)}},Lb.cleanSocket=function(){try{this._socket.close()}catch(La){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Lb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(La){}},Lb._onOpen=function(La){this._connected=!0,this.event("open",La)},Lb._onMessage=function(La){if(La&&La.data){var Lb=La.data;if(this.disableInput&&Lb)this.event("message",Lb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var Lc=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Lb&&("string"==typeof Lb?this._input.writeUTFBytes(Lb):this._input.writeArrayBuffer(Lb),this._addInputPosition=this._input.pos,this._input.pos=Lc),this.event("message",Lb)}}},Lb._onClose=function(La){this._connected=!1,this.event("close",La)},Lb._onError=function(La){this.event("error",La)},Lb.send=function(La){this._socket.send(La)},Lb.flush=function(){if(this._output&&0<this._output.length){var Lb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(La){Lb=La}this._output.endian=this.endian,this._output.clear(),Lb&&this.event("error",Lb)}},Lk(0,Lb,"input",function(){return this._input}),Lk(0,Lb,"output",function(){return this._output}),Lk(0,Lb,"connected",function(){return this._connected}),Lk(0,Lb,"endian",function(){return this._endian},function(La){this._endian=La,null!=this._input&&(this._input.endian=La),null!=this._output&&(this._output.endian=La)}),Ld.LITTLE_ENDIAN="littleEndian",Ld.BIG_ENDIAN="bigEndian"}(),function(La){function Lh(){Lh.__super.call(this),this._$1__id=++Lh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(Lh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,LN.currentResourceManager&&LN.currentResourceManager.addResource(this)}Lq(Lh,"laya.resource.Resource",Lj);var Lb=Lh.prototype;return Lz.imps(Lb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Lb._setUrl=function(La){var Lb;this._url!==La&&(this._url&&((Lb=Lh._urlResourcesMap[this._url]).splice(Lb.indexOf(this),1),0===Lb.length&&delete Lh._urlResourcesMap[this._url]),La&&((Lb=Lh._urlResourcesMap[La])||(Lh._urlResourcesMap[La]=Lb=[]),Lb.push(this)),this._url=La)},Lb._getGroup=function(){return this._group},Lb._setGroup=function(La){var Lb;this._group!==La&&(this._group&&((Lb=Lh._groupResourcesMap[this._group]).splice(Lb.indexOf(this),1),0===Lb.length&&delete Lh._groupResourcesMap[this._group]),La&&((Lb=Lh._groupResourcesMap[La])||(Lh._groupResourcesMap[La]=Lb=[]),Lb.push(this)),this._group=La)},Lb._addReference=function(){this._referenceCount++},Lb._removeReference=function(){this._referenceCount--},Lb._clearReference=function(){this._referenceCount=0},Lb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Lb.recreateResource=function(){this.completeCreate()},Lb.disposeResource=function(){},Lb.activeResource=function(La){void 0===La&&(La=!1),this._lastUseFrameCount=LX.loopCount,!this._destroyed&&this.__loaded&&(this._released||La)&&this.recreateResource()},Lb.releaseResource=function(La){return void 0===La&&(La=!0),!(!La&&this.lock)&&(!(this._released&&!La)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Lb.onAsynLoaded=function(La,Lb,Lc){throw new Error("Resource: must override this function!")},Lb.destroy=function(){var La;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete Lh._idResourcesMap[this.id],this._url&&((La=Lh._urlResourcesMap[this._url])&&(La.splice(La.indexOf(this),1),0===La.length&&delete Lh._urlResourcesMap[this.url]),Lha.clearRes(this._url),this.__loaded||LF.cancelLoadByUrl(this._url)),this._group&&((La=Lh._groupResourcesMap[this._group]).splice(La.indexOf(this),1),0===La.length&&delete Lh._groupResourcesMap[this.url]))},Lb.completeCreate=function(){this._released=!1,this.event("recovered",this)},Lb.dispose=function(){this.destroy()},Lk(0,Lb,"memorySize",function(){return this._memorySize},function(La){var Lb=La-this._memorySize;this._memorySize=La,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Lb),this.resourceManager&&this.resourceManager.addSize(Lb)}),Lk(0,Lb,"_loaded",null,function(La){this.__loaded=La}),Lk(0,Lb,"loaded",function(){return this.__loaded}),Lk(0,Lb,"id",function(){return this._$1__id}),Lk(0,Lb,"destroyed",function(){return this._destroyed}),Lk(0,Lb,"group",function(){return this._getGroup()},function(La){this._setGroup(La)}),Lk(0,Lb,"resourceManager",function(){return this._resourceManager}),Lk(0,Lb,"url",function(){return this._url}),Lk(0,Lb,"released",function(){return this._released}),Lk(0,Lb,"referenceCount",function(){return this._referenceCount}),Lh.getResourceByID=function(La){return Lh._idResourcesMap[La]},Lh.getResourceByURL=function(La,Lb){return void 0===Lb&&(Lb=0),null==Lh._urlResourcesMap[La]?null:Lh._urlResourcesMap[La][Lb]},Lh.getResourceCountByURL=function(La){return Lh._urlResourcesMap[La].length},Lh.destroyUnusedResources=function(La){var Lb;if(La){var Lc=Lh._groupResourcesMap[La];if(Lc)for(var Ld=Lc.slice(),Le=0,Lf=Ld.length;Le<Lf;Le++)(Lb=Ld[Le]).lock||0!==Lb._referenceCount||Lb.destroy()}else for(var Lg in Lh._idResourcesMap)(Lb=Lh._idResourcesMap[Lg]).lock||0!==Lb._referenceCount||Lb.destroy()},Lh._uniqueIDCounter=0,Lh._idResourcesMap={},Lh._urlResourcesMap={},Lh._groupResourcesMap={},Lh}()),Lka=function(La){function LC(La,Lb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,LC.__super.call(this),La&&null!=La._addReference&&La._addReference(),this.setTo(La,Lb)}Lq(LC,"laya.resource.Texture",Lj);var Lb=LC.prototype;return Lb._setUrl=function(La){this.url=La},Lb.setTo=function(La,Lb){if(La instanceof Ln.HTMLElement){var Lc=Lta.create("2D",La);this.bitmap=Lc}else this.bitmap=La;if(this.uv=Lb||LC.DEF_UV,La){this._w=La.width,this._h=La.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Ld=this;if(this._loaded)LF.addToAtlas&&LF.addToAtlas(Ld);else{var Le=La;Le instanceof laya.resource.HTMLImage&&Le.image&&Le.image.addEventListener("load",function(La){LF.addToAtlas&&LF.addToAtlas(Ld)},!1)}}},Lb.active=function(){this.bitmap&&this.bitmap.activeResource()},Lb.destroy=function(La){if(void 0===La&&(La=!1),this.alphaTexture&&(this.alphaTexture.destroy(La),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Lb=this.bitmap;La?(LJ.isConchApp&&Lb.source&&Lb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Lb.dispose(),Lb._clearReference()):(Lb._removeReference(),0==Lb.referenceCount&&(LJ.isConchApp&&Lb.source&&Lb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Lb.dispose())),this.url&&this===Lz.loader.getRes(this.url)&&Lz.loader.clearRes(this.url,La),this._loaded=!1}},Lb.load=function(La){var Lb=this;this._loaded=!1,La=LI.customFormat(La);var Lc=this.bitmap||(this.bitmap=Lya.create(La));Lc.uri=La,Lc&&Lc._addReference();var Ld=this;Lc.onload=function(){Lc.onload=null,Ld._loaded=!0,Lb.sourceWidth=Lb._w=Lc.width,Lb.sourceHeight=Lb._h=Lc.height,Ld.event("loaded",this),LF.addToAtlas&&LF.addToAtlas(Ld)}},Lb.addTextureToAtlas=function(La){LF.addTextureToAtlas(this)},Lb.getPixels=function(La,Lb,Lc,Ld){if(LJ.isConchApp){var Le=this.bitmap;if(Le.source&&Le.source.getImageData){var Lf=Le.source.getImageData(La,Lb,Lc,Ld),Lg=new Uint8Array(Lf);return Array.from(Lg)}return null}return LJ.isWebGL?LF.getTexturePixels(this,La,Lb,Lc,Ld):(LO.canvas.size(Lc,Ld),LO.canvas.clear(),LO.context.drawTexture(this,-La,-Lb,this.width,this.height,0,0),LO.context.getImageData(0,0,Lc,Ld).data)},Lb.onAsynLoaded=function(La,Lb){if(Lb){if("function"!=typeof Lb._addReference)throw new Error("bitmap._addReference is not a function. "+Lb.className+" "+typeof Lb._addReference+" "+Lb.constructor);Lb._addReference()}this.setTo(Lb,this.uv),this._loaded&&this.event("loaded",this)},Lk(0,Lb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),Lk(0,Lb,"loaded",function(){return this._loaded}),Lk(0,Lb,"released",function(){return!this.bitmap||this.bitmap.released}),Lk(0,Lb,"width",function(){return this._w?this._w:this.uv&&this.uv!==LC.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(La){this._w=La,this.sourceWidth||(this.sourceWidth=La)}),Lk(0,Lb,"repeat",function(){return!LJ.isWebGL||!this.bitmap||this.bitmap.repeat},function(La){La&&LJ.isWebGL&&this.bitmap&&(this.bitmap.repeat=La)&&(this.bitmap.enableMerageInAtlas=!1)}),Lk(0,Lb,"height",function(){return this._h?this._h:this.uv&&this.uv!==LC.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(La){this._h=La,this.sourceHeight||(this.sourceHeight=La)}),Lk(0,Lb,"isLinearSampling",function(){return!LJ.isWebGL||9728!=this.bitmap.minFifter},function(La){!La&&LJ.isWebGL&&(La||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),LC.moveUV=function(La,Lb,Lc){for(var Ld=0;Ld<8;Ld+=2)Lc[Ld]+=La,Lc[Ld+1]+=Lb;return Lc},LC.create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){void 0===Lf&&(Lf=0),void 0===Lg&&(Lg=0),void 0===Lh&&(Lh=0),void 0===Li&&(Li=0);var Lj=La instanceof laya.resource.Texture,Lk=Lj?La.uv:LC.DEF_UV,Ll=Lj?La.bitmap:La,Lm=LF.isAtlas(Ll);if(Lm){var Ln=Ll._atlaser,Lo=La._atlasID;if(-1==Lo)throw new Error("create texture error");Ll=Ln._inAtlasTextureBitmapValue[Lo],Lk=Ln._inAtlasTextureOriUVValue[Lo]}var Lp=new LC(Ll,null);Ll.width&&Lb+Ld>Ll.width&&(Ld=Ll.width-Lb),Ll.height&&Lc+Le>Ll.height&&(Le=Ll.height-Lc),Lp.width=Ld,Lp.height=Le,Lp.offsetX=Lf,Lp.offsetY=Lg,Lp.sourceWidth=Lh||Ld,Lp.sourceHeight=Li||Le;var Lq=1/Ll.width,Lr=1/Ll.height;Lb*=Lq,Lc*=Lr,Ld*=Lq,Le*=Lr;var Ls=Lp.uv[0],Lt=Lp.uv[1],Lu=Lp.uv[4],Lv=Lp.uv[5],Ly=Lu-Ls,Lz=Lv-Lt,LA=LC.moveUV(Lk[0],Lk[1],[Lb,Lc,Lb+Ld,Lc,Lb+Ld,Lc+Le,Lb,Lc+Le]);Lp.uv=[Ls+LA[0]*Ly,Lt+LA[1]*Lz,Lu-(1-LA[2])*Ly,Lt+LA[3]*Lz,Lu-(1-LA[4])*Ly,Lv-(1-LA[5])*Lz,Ls+LA[6]*Ly,Lv-(1-LA[7])*Lz],Lm&&Lp.addTextureToAtlas();var LB=Ll.scaleRate;return LB&&1!=LB?(Lp.sourceWidth/=LB,Lp.sourceHeight/=LB,Lp.width/=LB,Lp.height/=LB,Lp.scaleRate=LB,Lp.offsetX/=LB,Lp.offsetY/=LB):Lp.scaleRate=1,Lp},LC.createFromTexture=function(La,Lb,Lc,Ld,Le){var Lf=La.scaleRate;1!=Lf&&(Lb*=Lf,Lc*=Lf,Ld*=Lf,Le*=Lf);var Lg=LB.TEMP.setTo(Lb-La.offsetX,Lc-La.offsetY,Ld,Le),Lh=Lg.intersection(LC._rect1.setTo(0,0,La.width,La.height),LC._rect2);if(!Lh)return null;var Li=LC.create(La,Lh.x,Lh.y,Lh.width,Lh.height,Lh.x-Lg.x,Lh.y-Lg.y,Ld,Le);if(Li.bitmap&&Li.bitmap._removeReference)return Li.bitmap._removeReference(),Li;var Lj="bitmap:"+(Li.bitmap?Li.bitmap.constructor?Li.bitmap.constructor.name:Li.bitmap.__className:"")+", url:"+(La.url+" | "+(Li.bitmap?Li.bitmap.url:La.url))+", x="+Lb+",y="+Lc+",width="+Ld+",height="+Le+", result="+(Lh?Lh.x+","+Lh.y+","+Lh.width+","+Lh.height:"null")+", rect="+Lg.x+","+Lg.y+","+Lg.width+","+Lg.height;throw new Error("报错：bitmap._removeReference is not a function  "+Lj)},LC.DEF_UV=[0,0,1,0,1,1,0,1],LC.INV_UV=[0,1,1,1,1,0,0,0],LC._rect1=new LB,LC._rect2=new LB,LC}(),La=function(La){var Lh;function Lf(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Lf.__super.call(this)}Lq(Lf,"laya.utils.TimeLine",Lj);var Lb=Lf.prototype;return Lb.to=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=0),this._create(La,Lb,Lc,Ld,Le,!0)},Lb.from=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=0),this._create(La,Lb,Lc,Ld,Le,!1)},Lb._create=function(La,Lb,Lc,Ld,Le,Lf){var Lg=LW.getItemByClass("tweenData",Lh);return Lg.isTo=Lf,Lg.type=0,Lg.target=La,Lg.duration=Lc,Lg.data=Lb,Lg.startTime=this._startTime+Le,Lg.endTime=Lg.startTime+Lg.duration,Lg.ease=Ld,this._startTime=Math.max(Lg.endTime,this._startTime),this._tweenDataList.push(Lg),this._startTimeSort=!0,this._endTimeSort=!0,this},Lb.addLabel=function(La,Lb){var Lc=LW.getItemByClass("tweenData",Lh);return Lc.type=1,Lc.data=La,Lc.endTime=Lc.startTime=this._startTime+Lb,this._labelDic||(this._labelDic={}),this._labelDic[La]=Lc,this._tweenDataList.push(Lc),this},Lb.removeLabel=function(La){if(this._labelDic&&this._labelDic[La]){var Lb=this._labelDic[La];if(Lb){var Lc=this._tweenDataList.indexOf(Lb);-1<Lc&&this._tweenDataList.splice(Lc,1)}delete this._labelDic[La]}},Lb.gotoTime=function(La){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Lb,Lc,Ld,Le;for(var Lf in this._firstTweenDic)if(Lc=this._firstTweenDic[Lf])for(var Lg in Lc)Lc.diyTarget.hasOwnProperty(Lg)&&(Lc.diyTarget[Lg]=Lc[Lg]);for(Lf in this._tweenDic)(Lb=this._tweenDic[Lf]).clear(),delete this._tweenDic[Lf];if(this._index=0,this._gidIndex=0,this._currTime=La,this._lastTime=LO.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Ld=this._tweenDataList.concat(),Ld.sort(function(La,Lb){return La.endTime>Lb.endTime?1:La.endTime<Lb.endTime?-1:0})}else Ld=this._endTweenDataList;for(var Lh=0,Li=Ld.length;Lh<Li;Lh++)if(0==(Le=Ld[Lh]).type){if(!(La>=Le.endTime))break;this._index=Math.max(this._index,Lh+1);var Lj=Le.data;if(Le.isTo)for(var Lk in Lj)Le.target[Lk]=Lj[Lk]}for(Lh=0,Li=this._tweenDataList.length;Lh<Li;Lh++)0==(Le=this._tweenDataList[Lh]).type&&La>=Le.startTime&&La<Le.endTime&&(this._index=Math.max(this._index,Lh+1),this._gidIndex++,(Lb=LW.getItemByClass("tween",LZ))._create(Le.target,Le.data,Le.duration,Le.ease,Ls.create(this,this._animComplete,[this._gidIndex]),0,!1,Le.isTo,!0,!1),Lb.setStartTime(this._currTime-(La-Le.startTime)),Lb._updateEase(this._currTime),Lb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Lb)}},Lb.gotoLabel=function(La){if(null!=this._labelDic){var Lb=this._labelDic[La];Lb&&this.gotoTime(Lb.startTime)}},Lb.pause=function(){Lz.timer.clear(this,this._update)},Lb.resume=function(){this.play(this._currTime,this._loopKey)},Lb.play=function(La,Lb){if(void 0===La&&(La=0),void 0===Lb&&(Lb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(La,Lb){return La.startTime>Lb.startTime?1:La.startTime<Lb.startTime?-1:0});for(var Lc=0,Ld=this._tweenDataList.length;Lc<Ld;Lc++){var Le=this._tweenDataList[Lc];if(null!=Le&&0==Le.type){var Lf=Le.target,Lg=Lf.$_GID||(Lf.$_GID=L$.getGID()),Lh=null;for(var Li in null==this._firstTweenDic[Lg]?((Lh={}).diyTarget=Lf,this._firstTweenDic[Lg]=Lh):Lh=this._firstTweenDic[Lg],Le.data)null==Lh[Li]&&(Lh[Li]=Lf[Li])}}}"string"==typeof La?this.gotoLabel(La):this.gotoTime(La),this._loopKey=Lb,this._lastTime=LO.now(),Lz.timer.frameLoop(1,this,this._update)}},Lb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var La in this._tweenDic)(Lb=this._tweenDic[La]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Lb,Lc=LO.now(),Ld=Lc-this._lastTime,Le=this._currTime+=Ld*this.scale;for(La in this._lastTime=Lc,this._tweenDic)(Lb=this._tweenDic[La])._updateEase(Le);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Lf=this._tweenDataList[this._index];Le>=Lf.startTime&&(this._index++,0==Lf.type?(this._gidIndex++,(Lb=LW.getItemByClass("tween",LZ))._create(Lf.target,Lf.data,Lf.duration,Lf.ease,Ls.create(this,this._animComplete,[this._gidIndex]),0,!1,Lf.isTo,!0,!1),Lb.setStartTime(Le),Lb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Lb)._updateEase(Le)):this.event("label",Lf.data))}},Lb._animComplete=function(La){this._tweenDic[La]&&delete this._tweenDic[La]},Lb._complete=function(){this.event("complete")},Lb.reset=function(){var La;if(this._labelDic)for(La in this._labelDic)delete this._labelDic[La];for(La in this._tweenDic)this._tweenDic[La].clear(),delete this._tweenDic[La];for(La in this._firstTweenDic)delete this._firstTweenDic[La];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Lb,Lc=0;for(Lb=this._tweenDataList.length,Lc=0;Lc<Lb;Lc++)this._tweenDataList[Lc]&&this._tweenDataList[Lc].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Lz.timer.clear(this,this._update)},Lb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},Lk(0,Lb,"index",function(){return this._frameIndex},function(La){this._frameIndex=La,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),Lk(0,Lb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Lf.to=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=0),(new Lf).to(La,Lb,Lc,Ld,Le)},Lf.from=function(La,Lb,Lc,Ld,Le){return void 0===Le&&(Le=0),(new Lf).from(La,Lb,Lc,Ld,Le)},Lf.__init$=function(){Lh=function(){function La(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Lq(La,""),La.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,LW.recover("tweenData",this)},La}()},Lf}(),Lla=function(Le){function Lc(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,Lc.__super.call(this),this._style=Lh.EMPTY}Lq(Lc,"laya.display.Sprite",Le);var La=Lc.prototype;return Lz.imps(La,{"laya.display.ILayout":!0}),La.createConchModel=function(){return new ConchNode},La.destroy=function(La){if(void 0===La&&(La=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Lb=this.mask;Lb&&(this.mask=null,Lb.destroy(La))}Le.prototype.destroy.call(this,La),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},La.updateZOrder=function(){L$.updateOrder(this._childs)&&this.repaint()},La.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},La.setBounds=function(La){this._set$P("uBounds",La)},La.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new LB),LB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},La.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new LB),LB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},La._boundPointsToParent=function(La){void 0===La&&(La=!1);var Lb=0,Lc=0;this._style&&(Lb=this._style._tf.translateX,Lc=this._style._tf.translateY,La=La||0!==this._style._tf.rotate,this._style.scrollRect&&(Lb+=this._style.scrollRect.x,Lc+=this._style.scrollRect.y));var Ld=this._getBoundPointsM(La);if(!Ld||Ld.length<1)return Ld;if(8!=Ld.length&&(Ld=La?Lv.scanPList(Ld):LB._getWrapRec(Ld,LB.TEMP)._getBoundPoints()),!this.transform)return L$.transPointList(Ld,this._x-Lb,this._y-Lc),Ld;var Le=LA.TEMP,Lf=0,Lg=Ld.length;for(Lf=0;Lf<Lg;Lf+=2)Le.x=Ld[Lf],Le.y=Ld[Lf+1],this.toParentPoint(Le),Ld[Lf]=Le.x,Ld[Lf+1]=Le.y;return Ld},La.getGraphicBounds=function(La){return void 0===La&&(La=!1),this._graphics?this._graphics.getBounds(La):LB.TEMP.setTo(0,0,0,0)},La._getBoundPointsM=function(La){if(void 0===La&&(La=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Lb=L$.clearArray(this._$P.temBM),Lc=LB.TEMP;return Lc.copyFrom(this.scrollRect),L$.concatArray(Lb,Lc._getBoundPoints()),Lb}for(var Ld,Le,Lf,Lg=this._graphics?this._graphics.getBoundPoints():L$.clearArray(this._$P.temBM),Lh=0,Li=(Lf=this._childs).length;Lh<Li;Lh++)(Ld=Lf[Lh])instanceof laya.display.Sprite&&1==Ld.visible&&(Le=Ld._boundPointsToParent(La))&&(Lg=Lg?L$.concatArray(Lg,Le):Le);return Lg},La.getStyle=function(){return this._style===Lh.EMPTY&&(this._style=new Lh),this._style},La.setStyle=function(La){this._style=La},La._adjustTransform=function(){this._tfChanged=!1;var La,Lb=this._style._tf,Lc=Lb.scaleX,Ld=Lb.scaleY;if(Lb.rotate||1!==Lc||1!==Ld||Lb.skewX||Lb.skewY){(La=this._transform||(this._transform=LG.create())).bTransform=!0;var Le=.0174532922222222*(Lb.rotate-Lb.skewX),Lf=.0174532922222222*(Lb.rotate+Lb.skewY),Lg=Math.cos(Lf),Lh=Math.sin(Lf),Li=Math.sin(Le),Lj=Math.cos(Le);return La.a=Lc*Lg,La.b=Lc*Lh,La.c=-Ld*Li,La.d=Ld*Lj,La.tx=La.ty=0,La}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,La},La.pos=function(La,Lb,Lc){if(void 0===Lc&&(Lc=!1),this._x!==La||this._y!==Lb){if(this.destroyed)return this;if(Lc){this._x=La,this._y=Lb,this.conchModel&&this.conchModel.pos(this._x,this._y);var Ld=this._parent;Ld&&0===Ld._repaint&&(Ld._repaint=1,Ld.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=La,this.y=Lb}return this},La.pivot=function(La,Lb){return this.pivotX=La,this.pivotY=Lb,this},La.size=function(La,Lb){return this.width=La,this.height=Lb,this},La.scale=function(La,Lb,Lc){void 0===Lc&&(Lc=!1);var Ld=this.getStyle(),Le=Ld._tf;if(Le.scaleX!=La||Le.scaleY!=Lb){if(this.destroyed)return this;if(Lc){Ld.setScale(La,Lb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(La,Lb),this._renderType|=4;var Lf=this._parent;Lf&&0===Lf._repaint&&(Lf._repaint=1,Lf.parentRepaint())}else this.scaleX=La,this.scaleY=Lb}return this},La.skew=function(La,Lb){return this.skewX=La,this.skewY=Lb,this},La.render=function(La,Lb,Lc){LX.spriteCount++,LL.renders[this._renderType]._fun(this,La,Lb+this._x,Lc+this._y),this._repaint=0},La.drawToCanvas=function(La,Lb,Lc,Ld){if(LJ.isConchNode){var Le=Lta.create("2D");return new LK(La,Lb,Le).ctx.setCanvasType(1),this.conchModel.drawToCanvas(Le.source,Lc,Ld),Le}return LF.drawToCanvas(this,this._renderType,La,Lb,Lc,Ld)},La.customRender=function(La,Lb,Lc){this._renderType|=1024},La._applyFilters=function(){var La;if(!LJ.isWebGL&&((La=this._$P.filters)&&!(La.length<1)))for(var Lb=0,Lc=La.length;Lb<Lc;Lb++)La[Lb].action.apply(this._$P.cacheCanvas)},La._isHaveGlowFilter=function(){var La,Lb=0;if(this.filters)for(Lb=0;Lb<this.filters.length;Lb++)if(8==this.filters[Lb].type)return!0;for(Lb=0,La=this._childs.length;Lb<La;Lb++)if(this._childs[Lb]._isHaveGlowFilter())return!0;return!1},La.localToGlobal=function(La,Lb){void 0===Lb&&(Lb=!1),!0===Lb&&(La=new LA(La.x,La.y));for(var Lc=this;Lc&&Lc!=Lz.stage;)La=Lc.toParentPoint(La),Lc=Lc.parent;return La},La.globalToLocal=function(La,Lb){void 0===Lb&&(Lb=!1),Lb&&(La=new LA(La.x,La.y));for(var Lc=this,Ld=[];Lc&&Lc!=Lz.stage;)Ld.push(Lc),Lc=Lc.parent;for(var Le=Ld.length-1;0<=Le;)La=(Lc=Ld[Le]).fromParentPoint(La),Le--;return La},La.toParentPoint=function(La){if(!La)return La;La.x-=this.pivotX,La.y-=this.pivotY,this.transform&&this._transform.transformPoint(La),La.x+=this._x,La.y+=this._y;var Lb=this._style.scrollRect;return Lb&&(La.x-=Lb.x,La.y-=Lb.y),La},La.fromParentPoint=function(La){if(!La)return La;La.x-=this._x,La.y-=this._y;var Lb=this._style.scrollRect;return Lb&&(La.x+=Lb.x,La.y+=Lb.y),this.transform&&this._transform.invertTransformPoint(La),La.x+=this.pivotX,La.y+=this.pivotY,La},La.on=function(La,Lb,Lc,Ld){return 1!==this._mouseEnableState&&this.isMouseEvent(La)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(La,Lb,Lc,Ld,!1)):Le.prototype.on.call(this,La,Lb,Lc,Ld)},La.once=function(La,Lb,Lc,Ld){return 1!==this._mouseEnableState&&this.isMouseEvent(La)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(La,Lb,Lc,Ld,!0)):Le.prototype.once.call(this,La,Lb,Lc,Ld)},La._$2__onDisplay=function(){if(1!==this._mouseEnableState){var La=this;for(La=La.parent;La&&1!==La._mouseEnableState&&!La._getBit(2);)La.mouseEnabled=!0,La._setBit(2,!0),La=La.parent}},La.loadImage=function(La,Lb,Lc,Ld,Le,Lf){var Lg=this;return void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),this.graphics.loadImage(La,Lb,Lc,Ld,Le,function(La){Lg.destroyed||(Lg.size(Lb+(Ld||La.width),Lc+(Le||La.height)),Lg.repaint(),Lf&&Lf.runWith(La))}),this},La.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},La._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},La._childChanged=function(La){this._childs.length?this._renderType|=2048:this._renderType&=-2049,La&&this._get$P("hasZorder")&&Lz.timer.callLater(this,this.updateZOrder),this.repaint()},La.parentRepaint=function(){var La=this._parent;La&&0===La._repaint&&(La._repaint=1,La.parentRepaint())},La.startDrag=function(La,Lb,Lc,Ld,Le,Lf,Lg){void 0===Lb&&(Lb=!1),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=300),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=.92),this._$P.dragging||this._set$P("dragging",new LT),this._$P.dragging.start(this,La,Lb,Lc,Ld,Le,Lf,Lg)},La.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},La._releaseMem=function(){if(this._$P){var La=this._$P.cacheCanvas;La&&La.ctx&&(LW.recover("RenderContext",La.ctx),La.ctx.canvas.size(0,0),La.ctx=null);var Lb=this._$P._filterCache;Lb&&(Lb.destroy(),Lb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},La._setDisplay=function(La){La||this._releaseMem(),Le.prototype._setDisplay.call(this,La)},La.hitTestPoint=function(La,Lb){var Lc=this.globalToLocal(LA.TEMP.setTo(La,Lb));return La=Lc.x,Lb=Lc.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?LB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(La,Lb)},La.getMousePoint=function(){return this.globalToLocal(LA.TEMP.setTo(Lz.stage.mouseX,Lz.stage.mouseY))},La._getWords=function(){return null},La._addChildsToLayout=function(La){var Lb=this._getWords();if(null==Lb&&0==this._childs.length)return!1;if(Lb)for(var Lc=0,Ld=Lb.length;Lc<Ld;Lc++)La.push(Lb[Lc]);Lc=0;for(var Le=this._childs.length;Lc<Le;++Lc){var Lf=this._childs[Lc];Lf._style._enableLayout()&&Lf._addToLayout(La)}return!0},La._addToLayout=function(La){this._style.absolute||(this._style.block?La.push(this):this._addChildsToLayout(La)&&(this.x=this.y=0))},La._isChar=function(){return!1},La._getCSSStyle=function(){return this._style.getCSSStyle()},La._setAttributes=function(La,Lb){switch(La){case"x":this.x=parseFloat(Lb);break;case"y":this.y=parseFloat(Lb);break;case"width":this.width=parseFloat(Lb);break;case"height":this.height=parseFloat(Lb);break;default:this[La]=Lb}},La._layoutLater=function(){this.parent&&this.parent._layoutLater()},Lk(0,La,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(La){this._optimizeScrollRect!=La&&(this._optimizeScrollRect=La,this.conchModel&&this.conchModel.optimizeScrollRect(La))}),Lk(0,La,"customRenderEnable",null,function(La){if(La&&(this._renderType|=1024,LJ.isConchNode)){Lc.CustomList.push(this);var Lb=new Lta("2d");Lb._setContext(new CanvasRenderingContext2D),this.customContext=new LK(0,0,Lb),Lb.context.setCanvasType&&Lb.context.setCanvasType(2),this.conchModel.custom(Lb.context)}}),Lk(0,La,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(La){this.cacheAs=La?this._$P.hasFilter?"none":"normal":"none"}),Lk(0,La,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(La){var Lb=this._$P.cacheCanvas;if(La!==(Lb?Lb.type:"none")){if("none"!==La)this._getBit(1)||this._setUpNoticeType(1),Lb||(Lb=this._set$P("cacheCanvas",LW.getItemByClass("cacheCanvas",Object))),Lb.type=La,Lb.reCache=!0,this._renderType|=16,"bitmap"==La&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Lb){var Lc=Lb;Lc&&Lc.ctx&&(LW.recover("RenderContext",Lc.ctx),Lc.ctx.canvas.size(0,0),Lc.ctx=null),LW.recover("cacheCanvas",Lb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),Lk(0,La,"zOrder",function(){return this._zOrder},function(La){this._zOrder!=La&&(this._zOrder=La,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(La),this._parent&&(La&&this._parent._set$P("hasZorder",!0),Lz.timer.callLater(this._parent,this.updateZOrder)))}),Lk(0,La,"rotation",function(){return this._style._tf.rotate},function(La){var Lb=this.getStyle();if(Lb._tf.rotate!==La){Lb.setRotate(La),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(La),this._renderType|=4;var Lc=this._parent;Lc&&0===Lc._repaint&&(Lc._repaint=1,Lc.parentRepaint())}}),Lk(0,La,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(La){this._width!==La&&(this._width=La,this.conchModel&&this.conchModel.size(La,this._height),this.repaint())}),Lk(0,La,"x",function(){return this._x},function(La){if(this._x!==La){if(this.destroyed)return;this._x=La,this.conchModel&&this.conchModel.pos(La,this._y);var Lb=this._parent;Lb&&0===Lb._repaint&&(Lb._repaint=1,Lb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Lk(0,La,"globalScaleY",function(){for(var La=1,Lb=this;Lb&&Lb!==Lz.stage;)La*=Lb.scaleY,Lb=Lb.parent;return La}),Lk(0,La,"hitArea",function(){return this._$P.hitArea},function(La){this._set$P("hitArea",La)}),Lk(0,La,"staticCache",function(){return this._$P.staticCache},function(La){this._set$P("staticCache",La),La||this.reCache()}),Lk(0,La,"texture",function(){return this._texture},function(La){this._texture!=La&&(this._texture=La,this.graphics.cleanByTexture(La,0,0))}),Lk(0,La,"y",function(){return this._y},function(La){if(this._y!==La){if(this.destroyed)return;this._y=La,this.conchModel&&this.conchModel.pos(this._x,La);var Lb=this._parent;Lb&&0===Lb._repaint&&(Lb._repaint=1,Lb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Lk(0,La,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(La){this._height!==La&&(this._height=La,this.conchModel&&this.conchModel.size(this._width,La),this.repaint())}),Lk(0,La,"blendMode",function(){return this._style.blendMode},function(La){this.getStyle().blendMode=La,this.conchModel&&this.conchModel.blendMode(La),La&&"source-over"!=La?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),Lk(0,La,"scaleX",function(){return this._style._tf.scaleX},function(La){var Lb=this.getStyle();if(Lb._tf.scaleX!==La){Lb.setScaleX(La),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(La,Lb._tf.scaleY),this._renderType|=4;var Lc=this._parent;Lc&&0===Lc._repaint&&(Lc._repaint=1,Lc.parentRepaint())}}),Lk(0,La,"scaleY",function(){return this._style._tf.scaleY},function(La){var Lb=this.getStyle();if(Lb._tf.scaleY!==La){Lb.setScaleY(La),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Lb._tf.scaleX,La),this._renderType|=4;var Lc=this._parent;Lc&&0===Lc._repaint&&(Lc._repaint=1,Lc.parentRepaint())}}),Lk(0,La,"stage",function(){return Lz.stage}),Lk(0,La,"skewX",function(){return this._style._tf.skewX},function(La){var Lb=this.getStyle();if(Lb._tf.skewX!==La){Lb.setSkewX(La),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(La,Lb._tf.skewY),this._renderType|=4;var Lc=this._parent;Lc&&0===Lc._repaint&&(Lc._repaint=1,Lc.parentRepaint())}}),Lk(0,La,"scrollRect",function(){return this._style.scrollRect},function(La){this.getStyle().scrollRect=La,this.repaint(),La?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(La.x,La.y,La.width,La.height)):(this._renderType&=-129,this.conchModel&&(Lc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),Lk(0,La,"skewY",function(){return this._style._tf.skewY},function(La){var Lb=this.getStyle();if(Lb._tf.skewY!==La){Lb.setSkewY(La),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Lb._tf.skewX,La),this._renderType|=4;var Lc=this._parent;Lc&&0===Lc._repaint&&(Lc._repaint=1,Lc.parentRepaint())}}),Lk(0,La,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(La){this._tfChanged=!1,(this._transform=La)&&(this._x=La.tx,this._y=La.ty,La.tx=La.ty=0,this.conchModel&&this.conchModel.transform(La.a,La.b,La.c,La.d,this._x,this._y)),La?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),Lk(0,La,"pivotX",function(){return this._style._tf.translateX},function(La){this.getStyle().setTranslateX(La),this.conchModel&&this.conchModel.pivot(La,this._style._tf.translateY),this.repaint()}),Lk(0,La,"pivotY",function(){return this._style._tf.translateY},function(La){this.getStyle().setTranslateY(La),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,La),this.repaint()}),Lk(0,La,"alpha",function(){return this._style.alpha},function(La){this._style&&this._style.alpha!==La&&(La=La<0?0:1<La?1:La,this.getStyle().alpha=La,this.conchModel&&this.conchModel.alpha(La),1!==La?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),Lk(0,La,"visible",function(){return this._style.visible},function(La){this._style&&this._style.visible!==La&&(this.getStyle().visible=La,this.conchModel&&this.conchModel.visible(La),this.parentRepaint())}),Lk(0,La,"graphics",function(){return this._graphics||(this.graphics=LF.createGraphics())},function(La){this._graphics&&(this._graphics._sp=null),(this._graphics=La)?(this._renderType&=-2,this._renderType|=512,(La._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(Lc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),Lk(0,La,"filters",function(){return this._$P.filters},function(La){La&&0===La.length&&(La=null),this._$P.filters!=La&&(this._set$P("filters",La?La.slice():null),LJ.isConchApp&&(this.conchModel&&(Lc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),LJ.isWebGL&&(La&&La.length?this._renderType|=32:this._renderType&=-33),La&&0<La.length?(this._getBit(1)||this._setUpNoticeType(1),LJ.isWebGL&&1==La.length&&La[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(LJ.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),Lk(0,La,"parent",Le.prototype._$get_parent,function(La){Lz.superSet(Laa,this,"parent",La),La&&this._getBit(2)&&this._$2__onDisplay()}),Lk(0,La,"mask",function(){return this._$P._mask},function(La){La&&this.mask&&this.mask._$P.maskParent||(La?(this.cacheAs="bitmap",this._set$P("_mask",La),La._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",La),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(La?La.conchModel:null),this._renderType|=64,this.parentRepaint())}),Lk(0,La,"mouseEnabled",function(){return 1<this._mouseEnableState},function(La){this._mouseEnableState=La?2:1}),Lk(0,La,"globalScaleX",function(){for(var La=1,Lb=this;Lb&&Lb!==Lz.stage;)La*=Lb.scaleX,Lb=Lb.parent;return La}),Lk(0,La,"mouseX",function(){return this.getMousePoint().x}),Lk(0,La,"mouseY",function(){return this.getMousePoint().y}),Lc.fromImage=function(La){return(new Lc).loadImage(La)},Lc._cachePool=[],Lc.CustomList=[],Li(Lc,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=Ln.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),Lc}(Laa),Lma=function(La){function Lb(La){this._audio=null,this._onEnd=null,this._resumePlay=null,Lb.__super.call(this),this._onEnd=L$.bind(this.__onEnd,this),this._resumePlay=L$.bind(this.__resumePlay,this),La.addEventListener("ended",this._onEnd),this._audio=La}Lq(Lb,"laya.media.h5audio.AudioSoundChannel",Lda);var Lc=Lb.prototype;return Lc.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Lz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Lc.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,LO.container.appendChild(this._audio),this._audio.play()}catch(La){this.event("error")}},Lc.play=function(La){this.isStopped=!1;try{this._audio.playbackRate=LE.playbackRate,this._audio.currentTime=this.startTime}catch(La){return void this._audio.addEventListener("canplay",this._resumePlay)}LE.addChannel(this),LO.container.appendChild(this._audio),!La&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},Lc.stop=function(){this.isStopped=!0,LE.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&LJ.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),LO.onIE||this._audio!=Lca._musicAudio&&LW.recover("audio:"+this.url,this._audio),LO.removeElement(this._audio),this._audio=null)},Lc.pause=function(){this.isStopped=!0,LE.removeChannel(this),"pause"in this._audio&&this._audio.pause()},Lc.resume=function(){this._audio&&(this.isStopped=!1,LE.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},Lk(0,Lc,"position",function(){return this._audio?this._audio.currentTime:0}),Lk(0,Lc,"duration",function(){return this._audio?this._audio.duration:0}),Lk(0,Lc,"volume",function(){return this._audio?this._audio.volume:1},function(La){this._audio&&(this._audio.volume=La)}),Lb}(),Lna=function(La){function Lb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Lfa.ctx,Lb.__super.call(this),this._onPlayEnd=L$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Lq(Lb,"laya.media.webaudio.WebAudioSoundChannel",Lda);var Lc=Lb.prototype;return Lc.play=function(La){if(LE.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Lb=this.context,Lc=this.gain,Ld=Lb.createBufferSource();(this.bufferSource=Ld).buffer=this.audioBuffer,Ld.connect(Lc),Lc&&Lc.disconnect(),Lc.connect(Lb.destination),Ld.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=LO.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Ld.loop=!0),Ld.playbackRate.setTargetAtTime?Ld.playbackRate.setTargetAtTime(LE.playbackRate,this.context.currentTime,.1):Ld.playbackRate.value=LE.playbackRate,Ld.start(0,this.startTime),!La&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},Lc.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Lz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Lc._clearBufferSource=function(){if(this.bufferSource){var La=this.bufferSource;La.stop?La.stop(0):La.noteOff(0),La.disconnect(0),La.onended=null,Lb._tryCleanFailed||this._tryClearBuffer(La),this.bufferSource=null}},Lc._tryClearBuffer=function(La){try{La.buffer=null}catch(La){Lb._tryCleanFailed=!0}},Lc.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,LE.removeChannel(this),this.startHandler=null,this.completeHandler=null},Lc.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,LE.removeChannel(this)},Lc.resume=function(){this.startTime=this._pauseTime,this.play(!1)},Lk(0,Lc,"position",function(){return this.bufferSource?(LO.now()-this._startTime)/1e3+this.startTime:0}),Lk(0,Lc,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Lk(0,Lc,"volume",function(){return this._volume},function(La){this.isStopped||(this._volume=La,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(La,this.context.currentTime,.1):this.gain.gain.value=La)}),Lb._tryCleanFailed=!1,Lb}(),Loa=function(La){function Lb(){Lb.__super.call(this),this._w=0,this._h=0}Lq(Lb,"laya.resource.Bitmap",Lja);var Lc=Lb.prototype;return Lk(0,Lc,"width",function(){return this._w}),Lk(0,Lc,"height",function(){return this._h}),Lk(0,Lc,"source",function(){return this._source}),Lb}(),Lpa=function(Lb){function La(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,La.__super.call(this),this._interval=Ld.animationInterval,this._setUpNoticeType(1)}Lq(La,"laya.display.AnimationPlayerBase",Lb);var Lc=La.prototype;return Lc.play=function(La,Lb,Lc,Ld){void 0===La&&(La=0),void 0===Lb&&(Lb=!0),void 0===Lc&&(Lc=""),void 0===Ld&&(Ld=!0),this._isPlaying=!0,this.index="string"==typeof La?this._getFrameByLabel(La):La,this.loop=Lb,this._actionName=Lc,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Lc._getFrameByLabel=function(La){var Lb=0;for(Lb=0;Lb<this._count;Lb++)if(this._labels[Lb]&&0<=this._labels[Lb].indexOf(La))return Lb;return 0},Lc._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},Lc._setControlNode=function(La){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=La)&&La!=this&&(La.on("display",this,this._checkResumePlaying),La.on("undisplay",this,this._checkResumePlaying))},Lc._setDisplay=function(La){Lb.prototype._setDisplay.call(this,La),this._checkResumePlaying()},Lc._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},Lc.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},Lc.addLabel=function(La,Lb){this._labels||(this._labels={}),this._labels[Lb]||(this._labels[Lb]=[]),this._labels[Lb].push(La)},Lc.removeLabel=function(La){if(La){if(this._labels)for(var Lb in this._labels)this._removeLabelFromLabelList(this._labels[Lb],La)}else this._labels=null},Lc._removeLabelFromLabelList=function(La,Lb){if(La)for(var Lc=La.length-1;0<=Lc;Lc--)La[Lc]==Lb&&La.splice(Lc,1)},Lc.gotoAndStop=function(La){this.index="string"==typeof La?this._getFrameByLabel(La):La,this.stop()},Lc._displayToIndex=function(La){},Lc.clear=function(){this.stop(),this._labels=null},Lk(0,Lc,"interval",function(){return this._interval},function(La){this._interval!=La&&(this._frameRateChanged=!0,this._interval=La,this._isPlaying&&0<La&&this.timerLoop(La,this,this._frameLoop,null,!0,!0))}),Lk(0,Lc,"isPlaying",function(){return this._isPlaying}),Lk(0,Lc,"index",function(){return this._index},function(La){if(this._index=La,this._displayToIndex(La),this._labels&&this._labels[La])for(var Lb=this._labels[La],Lc=0,Ld=Lb.length;Lc<Ld;Lc++)this.event("label",Lb[Lc])}),Lk(0,Lc,"count",function(){return this._count}),La.WRAP_POSITIVE=0,La.WRAP_REVERSE=1,La.WRAP_PINGPONG=2,La}(Lla),Lqa=function(Lb){function Lp(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Lp.__super.call(this),this.overflow=Lp.VISIBLE,this._style=new Lba(this),this._style.wordWrap=!1}Lq(Lp,"laya.display.Text",Lb);var La=Lp.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._lines=null,this._words&&(this._words.length=0,this._words=null)},La._getBoundPointsM=function(La){void 0===La&&(La=!1);var Lb=LB.TEMP;return Lb.setTo(0,0,this.width,this.height),Lb._getBoundPoints()},La.getGraphicBounds=function(La){void 0===La&&(La=!1);var Lb=LB.TEMP;return Lb.setTo(0,0,this.width,this.height),Lb},La._getCSSStyle=function(){return this._style},La.lang=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk){if(La=Lp.langPacks&&Lp.langPacks[La]?Lp.langPacks[La]:La,arguments.length<2)this._text=La;else{for(var Ll=0,Lm=arguments.length;Ll<Lm;Ll++)La=La.replace("{"+Ll+"}",arguments[Ll+1]);this._text=La}},La._isPassWordMode=function(){var La=this._style.password;return"prompt"in this&&this.prompt==this._text&&(La=!1),La},La._getPassWordTxt=function(La){var Lb;Lb="";for(var Lc=La.length;0<Lc;Lc--)Lb+="●";return Lb},La.renderText=function(La,Lb){var Lc=this.graphics;Lc.clear(!0);var Ld=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(LO.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);LO.context.font=Ld;var Le=this.padding,Lf=Le[3],Lg="left",Lh=this._lines,Li=this.leading+this._charSize.height,Lj=this._currBitmapFont;Lj&&(Li=this.leading+Lj.getMaxHeight());var Lk=Le[0];if(!Lj&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(Lg="right",Lf=this._width-Le[1]):"center"==this.align&&(Lg="center",Lf=.5*this._width+Le[3]-Le[1])),0<this._height){var Ll=this._textHeight>this._height?"top":this.valign;"middle"===Ll?Lk=.5*(this._height-Lb*Li)+Le[0]-Le[2]:"bottom"===Ll&&(Lk=this._height-Lb*Li-Le[2])}var Lm=this._style;if(Lj&&Lj.autoScaleSize)var Ln=Lj.fontSize/this.fontSize;if(this._clipPoint)if(Lc.save(),Lj&&Lj.autoScaleSize){var Lo=0,Lp=0;Lo=this._width?this._width-Le[3]-Le[1]:this._textWidth,Lp=this._height?this._height-Le[0]-Le[2]:this._textHeight,Lo*=Ln,Lp*=Ln,Lc.clipRect(Le[3],Le[0],Lo,Lp)}else Lc.clipRect(Le[3],Le[0],this._width?this._width-Le[3]-Le[1]:this._textWidth,this._height?this._height-Le[0]-Le[2]:this._textHeight);var Lq=Lm.password;"prompt"in this&&this.prompt==this._text&&(Lq=!1);for(var Lr=0,Ls=0,Lt=Math.min(this._lines.length,Lb+La)||1,Lu=La;Lu<Lt;Lu++){var Lv,Ly=Lh[Lu];if(Lq){var Lz=Ly.length;Ly="";for(var LA=Lz;0<LA;LA--)Ly+="●"}if(Lr=Lf-(this._clipPoint?this._clipPoint.x:0),Ls=Lk+Li*Lu-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(Lg,Lr,Ls,Lu),Lj){var LB=this.width;Lj.autoScaleSize&&(LB=this.width*Ln),Lj.drawText(Ly,this,Lr,Ls,this.align,LB)}else LJ.isWebGL?(this._words||(this._words=[]),(Lv=this._words.length>Lu-La?this._words[Lu-La]:new Lx).setText(Ly)):Lv=Ly,Lm.stroke?Lc.fillBorderText(Lv,Lr,Ls,Ld,this.color,Lm.strokeColor,Lm.stroke,Lg):Lc.fillText(Lv,Lr,Ls,Ld,this.color,Lg)}if(Lj&&Lj.autoScaleSize){var LC=1/Ln;this.scale(LC,LC)}this._clipPoint&&Lc.restore(),this._startX=Lf,this._startY=Lk},La.drawUnderline=function(La,Lb,Lc,Ld){var Le=this._lineWidths[Ld];switch(La){case"center":Lb-=Le/2;break;case"right":Lb-=Le}Lc+=this._charSize.height,this._graphics.drawLine(Lb,Lc,Lb+Le,Lc,this.underlineColor||this.color,1)},La.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);LO.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new LA(0,0)):this._clipPoint=null;var La=this._lines.length;if(this.overflow!=Lp.VISIBLE){var Lb=this.overflow==Lp.HIDDEN?Math.floor:Math.ceil;La=Math.min(La,Lb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var Lc=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(Lc,La),this.repaint()},La.evalTextSize=function(){var La,Lb=NaN;La=Math.max.apply(this,this._lineWidths),Lb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],La==this._textWidth&&Lb==this._textHeight||(this._textWidth=La,this._textHeight=Lb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},La.checkEnabledViewportOrNot=function(){return this.overflow==Lp.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},La.changeText=function(La){this._text!==La&&(this.lang(La+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},La.parseLines=function(La){var Lb=this.wordWrap||this.overflow==Lp.HIDDEN;if(Lb)var Lc=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Ld=L$.contextMeasureText(Lp._testWord);LJ.isConchApp&&0===Ld.width&&0===Ld.height&&(Ld=L$.contextMeasureText("W")),this._charSize.width=Ld.width,this._charSize.height=Ld.height||this.fontSize}for(var Le=La.replace(/\r\n/g,"\n").split("\n"),Lf=0,Lg=Le.length;Lf<Lg;Lf++){var Lh=Le[Lf];Lb?this.parseLine(Lh,Lc):(this._lineWidths.push(this.getTextWidth(Lh)),this._lines.push(Lh))}},La.parseLine=function(La,Lb){LO.context;var Lc,Ld=this._lines,Le=0,Lf=NaN,Lg=NaN,Lh=0;if((Lf=this.getTextWidth(La))<=Lb)return Ld.push(La),void this._lineWidths.push(Lf);if(Lp.WordSplitStr&&0==new RegExp(Lp.WordSplitStr,"g").test(La))return Ld.push(La),void this._lineWidths.push(Lf);Lf=this._charSize.width,0==(Le=Math.floor(Lb/Lf))&&(Le=1),Lg=Lf=this.getTextWidth(La.substring(0,Le));for(var Li=Le,Lj=La.length;Li<Lj;Li++)if(Lb<(Lg+=Lf=this.getTextWidth(La.charAt(Li))))if(this.wordWrap){var Lk=La.substring(Lh,Li);if(Lp.WordSplitArr){var Ll=-1,Lm=0;for(Lm=0;Lm<Lp.WordSplitArr.length;Lm++)Ll=Math.max(Ll,Lk.lastIndexOf(Lp.WordSplitArr[Lm]));if(-1==Ll){var Ln=La.substring(Lh,La.length);for(Lm=0;Lm<Lp.WordSplitArr.length;Lm++){var Lo=Ln.indexOf(Lp.WordSplitArr[Lm]);Ll=0<=Ll?0<=Lo?Math.min(Ll,Lo):Ll:Lo}Lk=-1==Ll?(Li=La.length,Ln):(Li=Ll+1+Lh,La.substring(Lh,Li))}else Li=Ll+1+Lh,Lk=La.substring(Lh,Li);Ld.push(Lk),this._lineWidths.push(this.getTextWidth(Ld[Ld.length-1])),Lg=0,Lh=Li}else{if(Lk.charCodeAt(Lk.length-1)<255?(Lc=/(?:\w|-)+$/.exec(Lk))&&(Li=Lc.index+Lh,0==Lc.index?Li+=Lk.length:Lk=La.substring(Lh,Li)):Lp.RightToLeft&&(Lc=/([\u0600-\u06FF])+$/.exec(Lk))&&(Li=Lc.index+Lh,0==Lc.index?Li+=Lk.length:Lk=La.substring(Lh,Li)),Ld.push(Lk),this._lineWidths.push(Lg-Lf),!((Lh=Li)+Le<Lj)){Ld.push(La.substring(Lh,Lj)),this._lineWidths.push(this.getTextWidth(Ld[Ld.length-1])),Lh=-1;break}Li+=Le,Lg=Lf=this.getTextWidth(La.substring(Lh,Li)),Li--}}else if(this.overflow==Lp.HIDDEN)return Ld.push(La.substring(0,Li)),void this._lineWidths.push(this.getTextWidth(Ld[Ld.length-1]));this.wordWrap&&-1!=Lh&&Lh<Lj&&(Ld.push(La.substring(Lh,Lj)),this._lineWidths.push(this.getTextWidth(Ld[Ld.length-1])))},La.getTextWidth=function(La){return this._currBitmapFont?this._currBitmapFont.getTextWidth(La):L$.contextMeasureText(La).width},La.getWordWrapWidth=function(){var La=this.padding,Lb=NaN;return(Lb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Lb=this.wordWrap?100:LO.width),Lb<=0&&(Lb=100),Lb-La[3]-La[1]},La.getCharPoint=function(La,Lb){this._isChanged&&Lz.timer.runCallLater(this,this.typeset);for(var Lc=0,Ld=this._lines,Le=0,Lf=0,Lg=Ld.length;Lf<Lg;Lf++){if(La<(Lc+=Ld[Lf].length)){var Lh=Lf;break}Le=Lc}var Li=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;LO.context.font=Li;var Lj=this.getTextWidth(this._text.substring(Le,La));return(Lb||new LA).setTo(this._startX+Lj-(this._clipPoint?this._clipPoint.x:0),this._startY+Lh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},Lk(0,La,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(La){La!=this._width&&(Lz.superSet(Lla,this,"width",La),this.isChanged=!0)}),Lk(0,La,"textWidth",function(){return this._isChanged&&Lz.timer.runCallLater(this,this.typeset),this._textWidth}),Lk(0,La,"height",function(){return this._height?this._height:this.textHeight},function(La){La!=this._height&&(Lz.superSet(Lla,this,"height",La),this.isChanged=!0)}),Lk(0,La,"textHeight",function(){return this._isChanged&&Lz.timer.runCallLater(this,this.typeset),this._textHeight}),Lk(0,La,"padding",function(){return this._getCSSStyle().padding},function(La){this._getCSSStyle().padding=La,this.isChanged=!0}),Lk(0,La,"bold",function(){return this._getCSSStyle().bold},function(La){this._getCSSStyle().bold=La,this.isChanged=!0}),Lk(0,La,"text",function(){return this._text||""},function(La){this._text!==La&&(this.lang(La+""),this.isChanged=!0,this.event("change"))}),Lk(0,La,"color",function(){return this._getCSSStyle().color},function(La){this._getCSSStyle().color!=La&&(this._getCSSStyle().color=La,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),Lk(0,La,"font",function(){return this._getCSSStyle().fontFamily},function(La){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Lp._bitmapFonts&&Lp._bitmapFonts[La]&&(this._currBitmapFont=Lp._bitmapFonts[La]),this._getCSSStyle().fontFamily=La,this.isChanged=!0}),Lk(0,La,"fontSize",function(){return this._getCSSStyle().fontSize},function(La){this._getCSSStyle().fontSize=La,this.isChanged=!0}),Lk(0,La,"italic",function(){return this._getCSSStyle().italic},function(La){this._getCSSStyle().italic=La,this.isChanged=!0}),Lk(0,La,"align",function(){return this._getCSSStyle().align},function(La){this._getCSSStyle().align=La,this.isChanged=!0}),Lk(0,La,"valign",function(){return this._getCSSStyle().valign},function(La){this._getCSSStyle().valign=La,this.isChanged=!0}),Lk(0,La,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(La){this._getCSSStyle().wordWrap=La,this.isChanged=!0}),Lk(0,La,"leading",function(){return this._getCSSStyle().leading},function(La){this._getCSSStyle().leading=La,this.isChanged=!0}),Lk(0,La,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(La){this._getCSSStyle().backgroundColor=La,this.isChanged=!0}),Lk(0,La,"borderColor",function(){return this._getCSSStyle().borderColor},function(La){this._getCSSStyle().borderColor=La,this.isChanged=!0}),Lk(0,La,"stroke",function(){return this._getCSSStyle().stroke},function(La){this._getCSSStyle().stroke=La,this.isChanged=!0}),Lk(0,La,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(La){this._getCSSStyle().strokeColor=La,this.isChanged=!0}),Lk(0,La,"isChanged",null,function(La){this._isChanged!==La&&(this._isChanged=La)&&Lz.timer.callLater(this,this.typeset)}),Lk(0,La,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(La){if(!(this.overflow!=Lp.SCROLL||this.textWidth<this._width)&&this._clipPoint){La=La<this.padding[3]?this.padding[3]:La;var Lb=this._textWidth-this._width;La=Lb<La?Lb:La;var Lc=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=La,this.renderText(this._lastVisibleLineIndex,Lc)}}),Lk(0,La,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(La){if(!(this.overflow!=Lp.SCROLL||this.textHeight<this._height)&&this._clipPoint){La=La<this.padding[0]?this.padding[0]:La;var Lb=this._textHeight-this._height,Lc=(La=Lb<La?Lb:La)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=Lc;var Ld=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=La,this.renderText(Lc,Ld)}}),Lk(0,La,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),Lk(0,La,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),Lk(0,La,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),Lk(0,La,"underlineColor",function(){return this._underlineColor},function(La){this._underlineColor=La,this._isChanged=!0,this.typeset()}),Lp.registerBitmapFont=function(La,Lb){Lp._bitmapFonts||(Lp._bitmapFonts={}),Lp._bitmapFonts[La]=Lb},Lp.unregisterBitmapFont=function(La,Lb){if(void 0===Lb&&(Lb=!0),Lp._bitmapFonts&&Lp._bitmapFonts[La]){var Lc=Lp._bitmapFonts[La];Lb&&Lc.destroy(),delete Lp._bitmapFonts[La]}},Lp.setTextRightToLeft=function(){var La;(La=LO.canvas.source.style).display="none",La.position="absolute",La.direction="rtl",LJ._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,LO.document.body.appendChild(LO.canvas.source)},Lp.supportFont=function(La){LO.context.font="10px sans-serif";var Lb=L$.contextMeasureText("abcji").width;LO.context.font="10px "+La;var Lc=L$.contextMeasureText("abcji").width;return console.log(Lb,Lc),Lb!==Lc},Lp._testWord="游",Lp.langPacks=null,Lp.VISIBLE="visible",Lp.SCROLL="scroll",Lp.HIDDEN="hidden",Lp.CharacterCache=!0,Lp.RightToLeft=!1,Lp.WordSplitArr=null,Lp.WordSplitStr=null,Lp._bitmapFonts=null,Li(Lp,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Lp}(Lla),Lra=function(Lm){function Lg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",Lg.__super.call(this),this.offset=new LA,this._canvasTransform=new LG,this._previousOrientation=LO.window.orientation;var Lb=this;this.transform=LG.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0,this._lastStamp=0;var La=LO.window,Lc=this;La.addEventListener("focus",function(){Lb._isFocused=!0,Lc.event("focus"),Lc.event("focuschange")}),La.addEventListener("blur",function(){Lb._isFocused=!1,Lc.event("blur"),Lc.event("focuschange"),Lc._isInputting()&&(Lva.inputElement.target.focus=!1)});var Ld="visibilityState",Le="visibilitychange",Lf=La.document;void 0!==Lf.hidden?(Le="visibilitychange",Ld="visibilityState"):void 0!==Lf.mozHidden?(Le="mozvisibilitychange",Ld="mozVisibilityState"):void 0!==Lf.msHidden?(Le="msvisibilitychange",Ld="msVisibilityState"):void 0!==Lf.webkitHidden&&(Le="webkitvisibilitychange",Ld="webkitVisibilityState"),La.document.addEventListener(Le,function(){"hidden"==LO.document[Ld]?Lc._setStageVisible(!1):Lc._setStageVisible(!0)}),La.document.addEventListener("qbrowserVisibilityChange",function(La){Lc._setStageVisible(!La.hidden)}),La.addEventListener("resize",function(){var La=LO.window.orientation;null!=La&&La!=Lb._previousOrientation&&Lc._isInputting()&&(Lva.inputElement.target.focus=!1),Lb._previousOrientation=La,Lc._isInputting()||Lc._resetCanvas()}),La.addEventListener("orientationchange",function(La){Lc._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),LO.onMobile&&this.on("mousedown",this,this._onmouseMove)}Lq(Lg,"laya.display.Stage",Lm);var La=Lg.prototype;return La._setStageVisible=function(La){this._isVisibility!=La&&(this._isVisibility=La,this._isVisibility||this._isInputting()&&(Lva.inputElement.target.focus=!1),this.event("visibilitychange"))},La._isInputting=function(){return LO.onMobile&&Lva.isInputting},La._changeCanvasSize=function(){this.setScreenSize(LO.clientWidth*LO.pixelRatio,LO.clientHeight*LO.pixelRatio)},La._resetCanvas=function(){if(this.screenAdaptationEnabled){var La=LJ._mainCanvas;La.source.style;La.size(1,1),Lz.timer.once(100,this,this._changeCanvasSize)}},La.setScreenSize=function(La,Lb){var Lc=!1;if("none"!==this._screenMode&&(Lc=(La/Lb<1?"vertical":"horizontal")!==this._screenMode)){var Ld=Lb;Lb=La,La=Ld}this.canvasRotation=Lc;var Le=LJ._mainCanvas,Lf=Le.source.style,Lg=this._canvasTransform.identity(),Lh=this._scaleMode,Li=La/this.designWidth,Lj=Lb/this.designHeight,Lk=this.designWidth,Ll=this.designHeight,Lm=La,Ln=Lb,Lo=LO.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,Lh){case"noscale":Li=Lj=1,Lm=this.designWidth,Ln=this.designHeight;break;case"showall":Li=Lj=Math.min(Li,Lj),Lk=Lm=Math.round(this.designWidth*Li),Ll=Ln=Math.round(this.designHeight*Lj);break;case"noborder":Li=Lj=Math.max(Li,Lj),Lm=Math.round(this.designWidth*Li),Ln=Math.round(this.designHeight*Lj);break;case"full":Li=Lj=1,this._width=Lk=La,this._height=Ll=Lb;break;case"fixedwidth":Lj=Li,this._height=Ll=Math.round(Lb/Li);break;case"fixedheight":Li=Lj,this._width=Lk=Math.round(La/Lj);break;case"fixedauto":La/Lb<this.designWidth/this.designHeight?(Lj=Li,this._height=Ll=Math.round(Lb/Li)):(Li=Lj,this._width=Lk=Math.round(La/Lj))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,Lk=Lk+1&2147483646,Ll=Ll+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Li*=this.scaleX,Lj*=this.scaleY,1===Li&&1===Lj?this.transform.identity():(this.transform.a=this._formatData(Li/(Lm/Lk)),this.transform.d=this._formatData(Lj/(Ln/Ll)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),Le.size(Lk,Ll),LF.changeWebGLSize(Lk,Ll),Lg.scale(Lm/Lk/Lo,Ln/Ll/Lo),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(La-Lm)/Lo:this.offset.x=.5*(La-Lm)/Lo,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Lb-Ln)/Lo:this.offset.y=.5*(Lb-Ln)/Lo,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),Lg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,Lc&&("horizontal"===this._screenMode?(Lg.rotate(Math.PI/2),Lg.translate(Lb/Lo,0),this.canvasDegree=90):(Lg.rotate(-Math.PI/2),Lg.translate(0,La/Lo),this.canvasDegree=-90)),Lg.a=this._formatData(Lg.a),Lg.d=this._formatData(Lg.d),Lg.tx=this._formatData(Lg.tx),Lg.ty=this._formatData(Lg.ty),Lf.transformOrigin=Lf.webkitTransformOrigin=Lf.msTransformOrigin=Lf.mozTransformOrigin=Lf.oTransformOrigin="0px 0px 0px",Lf.transform=Lf.webkitTransform=Lf.msTransform=Lf.mozTransform=Lf.oTransform="matrix("+Lg.toString()+")",Lg.translate(parseInt(Lf.left)||0,parseInt(Lf.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},La._formatData=function(La){return Math.abs(La)<1e-6?0:Math.abs(1-La)<.001?0<La?1:-1:La},La.getMousePoint=function(){return LA.TEMP.setTo(this.mouseX,this.mouseY)},La.repaint=function(){this._repaint=1},La.parentRepaint=function(){},La._loop=function(La){return this.render(LJ.context,0,0,La),!0},La._onmouseMove=function(La){this._mouseMoveTime=LO.now()},La.getTimeFromFrameStart=function(){return LO.now()-this._frameStartTime},La.render=function(La,Lb,Lc,Ld){if(!(3!=Ln.ENV&&0<Ld&&Ld-this._lastStamp<16)){if(this._lastStamp=Ld,"sleep"===this._frameRate&&!LJ.isConchApp){var Le=LO.now();if(!(200<=Le-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(LX.loopCount++,Lp.instance.runEvent(),Lz.timer._update()));this._frameStartTime=Le}if(this._renderCount++,LJ.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=LO.now();var Lf="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Lg=this._renderCount%2==0;if(LX.renderSlow=!Lf,Lf||Lg||LJ.isConchApp){var Lh;LX.loopCount++,Lp.instance.runEvent(),Lz.timer._update(),LF.update3DLoop();var Li=0,Lj=0;if(LJ.isConchNode)for(Li=0,Lj=this._scenes.length;Li<Lj;Li++)(Lh=this._scenes[Li])&&Lh._updateSceneConch();else for(Li=0,Lj=this._scenes.length;Li<Lj;Li++)(Lh=this._scenes[Li])&&Lh._updateScene();if(LJ.isConchNode){var Lk=Lla.CustomList;for(Li=0,Lj=Lk.length;Li<Lj;Li++){var Ll=Lk[Li];Ll.customRender(Ll.customContext,0,0)}return}}LJ.isConchNode||this.renderingEnabled&&(Lf||!Lg||LJ.isConchWebGL)&&(LJ.isWebGL?LJ.WebGL.mainContext&&!LJ.WebGL.mainContext.isContextLost()&&(La.clear(),Lm.prototype.render.call(this,La,Lb,Lc),LX._show&&LX._sp&&LX._sp.render(La,Lb,Lc),LF.clear(this._bgColor),LF.beginFlush(),La.flush(),LF.endFinish(),L_.instance&&L_.getInstance().endDispose()):(LF.clear(this._bgColor),Lm.prototype.render.call(this,La,Lb,Lc),LX._show&&LX._sp&&LX._sp.render(La,Lb,Lc)))}else this._renderCount%5==0&&(LX.loopCount++,Lp.instance.runEvent(),Lz.timer._update())}},La._requestFullscreen=function(){var La=LO.document.documentElement;La.requestFullscreen?La.requestFullscreen():La.mozRequestFullScreen?La.mozRequestFullScreen():La.webkitRequestFullscreen?La.webkitRequestFullscreen():La.msRequestFullscreen&&La.msRequestFullscreen()},La._fullScreenChanged=function(){Lz.stage.event("fullscreenchange")},La.exitFullscreen=function(){var La=LO.document;La.exitFullscreen?La.exitFullscreen():La.mozCancelFullScreen?La.mozCancelFullScreen():La.webkitExitFullscreen&&La.webkitExitFullscreen()},Lk(0,La,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),Lk(0,La,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),Lk(0,La,"frameRate",function(){return this._frameRate},function(La){if(this._frameRate=La,LJ.isConchApp)switch(this._frameRate){case"slow":LO.window.conch&&LO.window.conchConfig.setSlowFrame&&LO.window.conchConfig.setSlowFrame(!0);break;case"fast":LO.window.conch&&LO.window.conchConfig.setSlowFrame&&LO.window.conchConfig.setSlowFrame(!1);break;case"mouse":LO.window.conch&&LO.window.conchConfig.setMouseFrame&&LO.window.conchConfig.setMouseFrame(2e3);break;case"sleep":LO.window.conch&&LO.window.conchConfig.setLimitFPS&&LO.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),Lk(0,La,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),Lk(0,La,"width",Lm.prototype._$get_width,function(La){this.designWidth=La,Lz.superSet(Lla,this,"width",La),Lz.timer.callLater(this,this._changeCanvasSize)}),Lk(0,La,"alignH",function(){return this._alignH},function(La){this._alignH=La,Lz.timer.callLater(this,this._changeCanvasSize)}),Lk(0,La,"isFocused",function(){return this._isFocused}),Lk(0,La,"height",Lm.prototype._$get_height,function(La){this.designHeight=La,Lz.superSet(Lla,this,"height",La),Lz.timer.callLater(this,this._changeCanvasSize)}),Lk(0,La,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||LG.create()},Lm.prototype._$set_transform),Lk(0,La,"isVisibility",function(){return this._isVisibility}),Lk(0,La,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),Lk(0,La,"scaleMode",function(){return this._scaleMode},function(La){this._scaleMode=La,Lz.timer.callLater(this,this._changeCanvasSize)}),Lk(0,La,"alignV",function(){return this._alignV},function(La){this._alignV=La,Lz.timer.callLater(this,this._changeCanvasSize)}),Lk(0,La,"bgColor",function(){return this._bgColor},function(La){this._bgColor=La,this.conchModel&&this.conchModel.bgColor(La),LJ.isWebGL&&(La?Lg._wgColor=LS.create(La)._color:LO.onMiniGame||(Lg._wgColor=null)),LO.onLimixiu?Lg._wgColor=LS.create(La)._color:LJ.canvas.style.background=La||"none"}),Lk(0,La,"mouseX",function(){return Math.round(Lp.instance.mouseX/this.clientScaleX)}),Lk(0,La,"mouseY",function(){return Math.round(Lp.instance.mouseY/this.clientScaleY)}),Lk(0,La,"screenMode",function(){return this._screenMode},function(La){this._screenMode=La}),Lk(0,La,"visible",Lm.prototype._$get_visible,function(La){this.visible!==La&&(Lz.superSet(Lla,this,"visible",La),LJ._mainCanvas.source.style.visibility=La?"visible":"hidden")}),Lk(0,La,"fullScreenEnabled",null,function(La){var Lb=LO.document,Lc=LJ.canvas;La?(Lc.addEventListener("mousedown",this._requestFullscreen),Lc.addEventListener("touchstart",this._requestFullscreen),Lb.addEventListener("fullscreenchange",this._fullScreenChanged),Lb.addEventListener("mozfullscreenchange",this._fullScreenChanged),Lb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Lb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(Lc.removeEventListener("mousedown",this._requestFullscreen),Lc.removeEventListener("touchstart",this._requestFullscreen),Lb.removeEventListener("fullscreenchange",this._fullScreenChanged),Lb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Lb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Lb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),Lg.SCALE_NOSCALE="noscale",Lg.SCALE_EXACTFIT="exactfit",Lg.SCALE_SHOWALL="showall",Lg.SCALE_NOBORDER="noborder",Lg.SCALE_FULL="full",Lg.SCALE_FIXED_WIDTH="fixedwidth",Lg.SCALE_FIXED_HEIGHT="fixedheight",Lg.SCALE_FIXED_AUTO="fixedauto",Lg.ALIGN_LEFT="left",Lg.ALIGN_RIGHT="right",Lg.ALIGN_CENTER="center",Lg.ALIGN_TOP="top",Lg.ALIGN_MIDDLE="middle",Lg.ALIGN_BOTTOM="bottom",Lg.SCREEN_NONE="none",Lg.SCREEN_HORIZONTAL="horizontal",Lg.SCREEN_VERTICAL="vertical",Lg.FRAME_FAST="fast",Lg.FRAME_SLOW="slow",Lg.FRAME_MOUSE="mouse",Lg.FRAME_SLEEP="sleep",Lg.FRAME_MOUSE_THREDHOLD=2e3,Li(Lg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),Lg}(Lla),Lsa=(function(La){function Lb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Lb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Lq(Lb,"laya.media.SoundNode",Lla);var Lc=Lb.prototype;Lc._onParentChange=function(){this.target=this.parent},Lc.play=function(La,Lb){void 0===La&&(La=1),isNaN(La)&&(La=1),this.url&&(this.stop(),this._channel=LE.playSound(this.url,La,null,Lb))},Lc.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},Lc._setPlayAction=function(La,Lb,Lc,Ld){void 0===Ld&&(Ld=!0),this[Lc]&&La&&(Ld?La.on(Lb,this,this[Lc]):La.off(Lb,this,this[Lc]))},Lc._setPlayActions=function(La,Lb,Lc,Ld){if(void 0===Ld&&(Ld=!0),La&&Lb){var Le,Lf=Lb.split(","),Lg=0;for(Le=Lf.length,Lg=0;Lg<Le;Lg++)this._setPlayAction(La,Lf[Lg],Lc,Ld)}},Lk(0,Lc,"playEvent",null,function(La){(this._playEvents=La)&&this._tar&&this._setPlayActions(this._tar,La,"play")}),Lk(0,Lc,"target",null,function(La){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=La,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),Lk(0,Lc,"stopEvent",null,function(La){(this._stopEvents=La)&&this._tar&&this._setPlayActions(this._tar,La,"stop")})}(),function(La){function Lb(){this._src=null,this._onload=null,this._onerror=null,Lb.__super.call(this)}Lq(Lb,"laya.resource.FileBitmap",Loa);var Lc=Lb.prototype;return Lk(0,Lc,"src",function(){return this._src},function(La){this._src=La}),Lk(0,Lc,"onload",null,function(La){}),Lk(0,Lc,"onerror",null,function(La){}),Lb}()),Lta=function(La){function Lc(La,Lb){this._is2D=!1,Lc.__super.call(this);var Ld=this;if(this._source=this,"2D"===La||"AUTO"===La&&!LJ.isWebGL){this._is2D=!0,this._source=Lb||LO.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var Le=this;Le.getContext=function(La,Lb){if(Ld._ctx)return Ld._ctx;var Lc=Ld._ctx=Ld._source.getContext(La,Lb);return Lc&&(Lc._canvas=Le,LJ.isFlash||LO.onLimixiu||(Lc.size=function(La,Lb){})),Lc}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Lq(Lc,"laya.resource.HTMLCanvas",Loa);var Lb=Lc.prototype;return Lb.clear=function(){this._ctx&&this._ctx.clear()},Lb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Lb.release=function(){},Lb._setContext=function(La){this._ctx=La},Lb.getContext=function(La,Lb){return this._ctx?this._ctx:this._ctx=Lc._createContext(this)},Lb.getMemSize=function(){return 0},Lb.size=function(La,Lb){(this._w!=La||this._h!=Lb||this._source&&(this._source.width!=La||this._source.height!=Lb))&&(this._w=La,this._h=Lb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(La,Lb),this._source&&(this._source.height=Lb,this._source.width=La))},Lb.getCanvas=function(){return this._source},Lb.toBase64=function(La,Lb,Lc){if(this._source)if(LJ.isConchApp&&this._source.toBase64)this._source.toBase64(La,Lb,Lc);else{var Ld=this._source.toDataURL(La,Lb);Lc.call(this,Ld)}},Lk(0,Lb,"context",function(){return this._ctx}),Lk(0,Lb,"asBitmap",null,function(La){}),Lc.create=function(La,Lb){return new Lc(La,Lb)},Lc.TYPE2D="2D",Lc.TYPE3D="3D",Lc.TYPEAUTO="AUTO",Lc._createContext=null,Lc}(),Lua=(function(La){function Li(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){throw Li.__super.call(this),new Error("不允许new！")}Lq(Li,"laya.resource.HTMLSubImage",Loa),Li.create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){return void 0===Lh&&(Lh=!1),new Li(La,Lb,Lc,Ld,Le,Lf,Lg,Lh)}}(),function(La){function Ll(){this._frames=null,this._url=null,Ll.__super.call(this),this._setControlNode(this)}Lq(Ll,"laya.display.Animation",La);var Lb=Ll.prototype;Lb.destroy=function(La){void 0===La&&(La=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,La),this._frames=null,this._labels=null},Lb.play=function(La,Lb,Lc,Ld){void 0===La&&(La=0),void 0===Lb&&(Lb=!0),void 0===Lc&&(Lc=""),void 0===Ld&&(Ld=!0),Lc&&this._setFramesFromCache(Lc,Ld),this._isPlaying=!0,this.index="string"==typeof La?this._getFrameByLabel(La):La,this.loop=Lb,this._actionName=Lc,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Lb._setFramesFromCache=function(La,Lb){var Lc;return void 0===Lb&&(Lb=!1),this._url&&(La=this._url+"#"+La),La&&Ll.framesMap[La]?((Lc=Ll.framesMap[La])instanceof Array?(this._frames=Ll.framesMap[La],this._count=this._frames.length):(Lc.nodeRoot&&(Ll.framesMap[La]=this._parseGraphicAnimationByData(Lc),Lc=Ll.framesMap[La]),this._frames=Lc.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=Lc.interval),this._labels=this._copyLabels(Lc.labels)),!0):(Lb&&console.log("ani not found:",La),!1)},Lb._copyLabels=function(La){if(!La)return null;var Lb,Lc;for(Lc in Lb={},La)Lb[Lc]=L$.copyArray([],La[Lc]);return Lb},Lb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&La.prototype._frameLoop.call(this)},Lb._displayToIndex=function(La){this._frames&&(this.graphics=this._frames[La])},Lb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Lb.loadImages=function(La,Lb){return void 0===Lb&&(Lb=""),this._url="",this._setFramesFromCache(Lb)||(this.frames=Ll.framesMap[Lb]?Ll.framesMap[Lb]:Ll.createFrames(La,Lb)),this},Lb.loadAtlas=function(Lb,Lc,Ld){void 0===Ld&&(Ld=""),this._url="";var Le=this;function La(La){Lb===La&&(Le.frames=Ll.framesMap[Ld]?Ll.framesMap[Ld]:Ll.createFrames(Lb,Ld),Lc&&Lc.run())}return Le._setFramesFromCache(Ld)||(Lha.getAtlas(Lb)?La(Lb):Lz.loader.load(Lb,Ls.create(null,La,[Lb]),null,"atlas")),this},Lb.loadAnimation=function(La,Lb,Lc){this._url=La;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Lb&&Lb.run()):!Lc||Lha.getAtlas(Lc)?this._loadAnimationData(La,Lb,Lc):Lz.loader.load(Lc,Ls.create(this,this._loadAnimationData,[La,Lb,Lc]),null,"atlas"),this},Lb._loadAnimationData=function(Lh,Li,La){var Lj=this;if(!La||Lha.getAtlas(La)){var Lk=this;Lha.getRes(Lh)?Lb(Lh):Lz.loader.load(Lh,Ls.create(null,Lb,[Lh]),null,"json"),Lha.clearRes(Lh)}else console.warn("atlas load fail:"+La);function Lb(La){if(Lha.getRes(La)&&Lh===La){var Lb;if(Ll.framesMap[Lh+"#"])Lk._setFramesFromCache(Lj._actionName,!0),Lj.index=0,Lj._checkResumePlaying();else{var Lc=Lk._parseGraphicAnimation(Lha.getRes(Lh));if(!Lc)return;var Ld,Le=Lc.animationList,Lf=0,Lg=Le.length;for(Lf=0;Lf<Lg;Lf++)Lb=Le[Lf],Ll.framesMap[Lh+"#"+Lb.name]=Lb,Ld||(Ld=Lb);Ld&&(Ll.framesMap[Lh+"#"]=Ld,Lk._setFramesFromCache(Lj._actionName,!0),Lj.index=0),Lj._checkResumePlaying()}Li&&Li.run()}}},Lb._parseGraphicAnimation=function(La){return Lza.parseAnimationData(La)},Lb._parseGraphicAnimationByData=function(La){return Lza.parseAnimationByData(La)},Lk(0,Lb,"frames",function(){return this._frames},function(La){(this._frames=La)&&(this._count=La.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),Lk(0,Lb,"autoPlay",null,function(La){La?this.play():this.stop()}),Lk(0,Lb,"source",null,function(La){-1<La.indexOf(".ani")?this.loadAnimation(La):-1<La.indexOf(".json")||-1<La.indexOf("als")||-1<La.indexOf("atlas")?this.loadAtlas(La):this.loadImages(La.split(","))}),Lk(0,Lb,"autoAnimation",null,function(La){this.play(0,!0,La,!1)}),Ll.createFrames=function(La,Lb){var Lc,Ld,Le=0,Lf=0;if("string"==typeof La){var Lg=Lha.getAtlas(La);if(Lg&&Lg.length)for(Lc=[],Le=0,Lf=Lg.length;Le<Lf;Le++)(Ld=new LF.createGraphics).drawTexture(Lha.getRes(Lg[Le]),0,0),Lc.push(Ld)}else if(La instanceof Array)for(Lc=[],Le=0,Lf=La.length;Le<Lf;Le++)(Ld=new LF.createGraphics).loadImage(La[Le],0,0),Lc.push(Ld);return Lb&&(Ll.framesMap[Lb]=Lc),Lc},Ll.clearCache=function(La){var Lb,Lc=Ll.framesMap,Ld=La+"#";for(Lb in Lc)Lb!==La&&0!=Lb.indexOf(Ld)||delete Ll.framesMap[Lb]},Ll.framesMap={}}(Lpa),function(La){function Lf(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Lf.__super.call(this),null==Lf._sortIndexFun&&(Lf._sortIndexFun=Ly.sortByKey("index",!1,!0))}Lq(Lf,"laya.display.FrameAnimation",La);var Lb=Lf.prototype;return Lb._setUp=function(La,Lb){this._labels=null,this._animationNewFrames=null,this._targetDic=La,this._animationData=Lb,this.interval=1e3/Lb.frameRate,Lb.parsed?(this._count=Lb.count,this._labels=Lb.labels,this._animationNewFrames=Lb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Lb.parsed=!0,Lb.labels=this._labels,Lb.count=this._count,Lb.animationNewFrames=this._animationNewFrames},Lb.clear=function(){La.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Lb._displayToIndex=function(La){if(this._animationData){La<0&&(La=0),La>this._count&&(La=this._count);var Lb=this._animationData.nodes,Lc=0,Ld=Lb.length;for(Lc=0;Lc<Ld;Lc++)this._displayNodeToFrame(Lb[Lc],La)}},Lb._displayNodeToFrame=function(La,Lb,Lc){Lc||(Lc=this._targetDic);var Ld=Lc[La.target];if(Ld){var Le,Lf,Lg,Lh=La.frames,Li=La.keys,Lj=0,Lk=Li.length;for(Lj=0;Lj<Lk;Lj++)Lg=(Lf=Lh[Le=Li[Lj]]).length>Lb?Lf[Lb]:Lf[Lf.length-1],Ld[Le]=Lg}},Lb._calculateDatas=function(){if(this._animationData){var La,Lb=this._animationData.nodes,Lc=0,Ld=Lb.length;for(Lc=this._count=0;Lc<Ld;Lc++)La=Lb[Lc],this._calculateNodeKeyFrames(La);this._count+=1}},Lb._calculateNodeKeyFrames=function(La){var Lb,Lc,Ld=La.keyframes,Le=La.target;for(Lb in La.frames||(La.frames={}),La.keys?La.keys.length=0:La.keys=[],La.initValues||(La.initValues={}),Ld)Lc=Ld[Lb],La.frames[Lb]||(La.frames[Lb]=[]),this._targetDic&&this._targetDic[Le]&&(La.initValues[Lb]=this._targetDic[Le][Lb]),Lc.sort(Lf._sortIndexFun),La.keys.push(Lb),this._calculateNodePropFrames(Lc,La.frames[Lb],Lb,Le)},Lb.resetToInitState=function(){if(this._targetDic&&this._animationData){var La,Lb,Lc=this._animationData.nodes,Ld=0,Le=Lc.length;for(Ld=0;Ld<Le;Ld++)if(Lb=(La=Lc[Ld]).initValues){var Lf,Lg=this._targetDic[La.target];if(Lg)for(Lf in Lb)Lg[Lf]=Lb[Lf]}}},Lb._calculateNodePropFrames=function(La,Lb,Lc,Ld){var Le=0,Lf=La.length-1;if(0<Lf){for(Lb.length=La[Lf].index+1,Le=0;Le<Lf;Le++)this._dealKeyFrame(La[Le]),this._calculateFrameValues(La[Le],La[Le+1],Lb);this._dealKeyFrame(La[Le])}0==Lf&&(Lb[La[0].index]=La[0].value,this._animationNewFrames&&(this._animationNewFrames[La[0].index]=!0))},Lb._dealKeyFrame=function(La){La.label&&""!=La.label&&this.addLabel(La.label,La.index)},Lb._calculateFrameValues=function(La,Lb,Lc){var Ld,Le=0,Lf=La.index,Lg=Lb.index,Lh=La.value,Li=Lb.value-La.value,Lj=Lg-Lf;if(Lg>this._count&&(this._count=Lg),La.tween)for(null==(Ld=LU[La.tweenMethod])&&(Ld=LU.linearNone),Le=Lf;Le<Lg;Le++)Lc[Le]=Ld(Le-Lf,Lh,Li,Lj),this._animationNewFrames&&(this._animationNewFrames[Le]=!0);else for(Le=Lf;Le<Lg;Le++)Lc[Le]=Lh;this._animationNewFrames&&(this._animationNewFrames[La.index]=!0,this._animationNewFrames[Lb.index]=!0),Lc[Lb.index]=Lb.value},Lf._sortIndexFun=null,Lf}(Lpa)),Lva=function(Lb){function Lf(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",Lf.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Lqa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Lq(Lf,"laya.display.Input",Lb);var La=Lf.prototype;return La.setSelection=function(La,Lb){this.focus=!0,laya.display.Input.inputElement.selectionStart=La,laya.display.Input.inputElement.selectionEnd=Lb},La._onUnDisplay=function(La){this.focus=!1},La._onMouseDown=function(La){this.focus=!0},La._syncInputTransform=function(){var La=this.nativeInput,Lb=L$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),Lc=this._width-this.padding[1]-this.padding[3],Ld=this._height-this.padding[0]-this.padding[2];if(LJ.isConchApp)La.setScale(Lb.scaleX,Lb.scaleY),La.setSize(Lc,Ld),La.setPos(Lb.x,Lb.y);else{var Le=1===LO.scroll_input_top;Le&&La.style.backgroundColor&&(La.style.backgroundColor=null),Lf.inputContainer.style.transform=Lf.inputContainer.style.webkitTransform="scale("+Lb.scaleX+","+Lb.scaleY+") rotate("+Lz.stage.canvasDegree+"deg)",La.style.width=Le?"720px":Lc+"px",La.style.height=Ld+"px",Lf.inputContainer.style.left=Le?"0px":Lb.x+"px",Lf.inputContainer.style.top=Le?"0px":Lb.y+"px"}},La.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},La._setInputMethod=function(){Lf.input.parentElement&&Lf.inputContainer.removeChild(Lf.input),Lf.area.parentElement&&Lf.inputContainer.removeChild(Lf.area),Lf.inputElement=this._multiline?Lf.area:Lf.input,Lf.inputContainer.appendChild(Lf.inputElement),Lqa.RightToLeft&&(Lf.inputElement.style.direction="rtl")},La._focusIn=function(){laya.display.Input.isInputting=!0;var La=this.nativeInput;this._focus=!0;var Lb=La.style;Lb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),La.readOnly=!this._editable,LJ.isConchApp&&(La.setType(this._type),La.setForbidEdit(!this._editable)),La.maxLength=this._maxChars;this.padding;if(La.type=this._type,La.value=this._content,La.placeholder=this._prompt,Lz.stage.off("keydown",this,this._onKeyDown),Lz.stage.on("keydown",this,this._onKeyDown),(Lz.stage.focus=this).event("focus"),LO.onPC&&La.focus(),!LO.onMiniGame){this._text;this._text=null}this.typeset(),La.setColor(this._originColor),La.setFontSize(this.fontSize),La.setFontFace(LO.onIPhone&&Lqa._fontFamilyMap[this.font]||this.font),LJ.isConchApp&&La.setMultiAble&&La.setMultiAble(this._multiline),Lb.lineHeight=this.leading+this.fontSize+"px",Lb.fontStyle=this.italic?"italic":"normal",Lb.fontWeight=this.bold?"bold":"normal",Lb.textAlign=this.align,Lb.padding="0 0",this._syncInputTransform(),!LJ.isConchApp&&LO.onPC&&Lz.timer.frameLoop(1,this,this._syncInputTransform)},La._setPromptColor=function(){(Lf.promptStyleDOM=LO.getElementById("promptStyle"))||((Lf.promptStyleDOM=LO.createElement("style")).setAttribute("id","promptStyle"),LO.document.head.appendChild(Lf.promptStyleDOM)),Lf.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},La._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Lz.superSet(Lqa,this,"text",this._content),Lz.superSet(Lqa,this,"color",this._originColor)):(Lz.superSet(Lqa,this,"text",this._prompt),Lz.superSet(Lqa,this,"color",this._promptColor)),Lz.stage.off("keydown",this,this._onKeyDown),Lz.stage.focus=null,this.event("blur"),LJ.isConchApp&&this.nativeInput.blur(),LO.onPC&&Lz.timer.clear(this,this._syncInputTransform)},La._onKeyDown=function(La){13===La.keyCode&&(LO.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},La.changeText=function(La){this._content=La,this._focus?(this.nativeInput.value=La||"",this.event("change")):Lb.prototype.changeText.call(this,La)},Lk(0,La,"color",Lb.prototype._$get_color,function(La){this._focus&&this.nativeInput.setColor(La),Lz.superSet(Lqa,this,"color",this._content?La:this._promptColor),this._originColor=La}),Lk(0,La,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(La){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),Lk(0,La,"multiline",function(){return this._multiline},function(La){this._multiline=La,this.valign=La?"top":"middle"}),Lk(0,La,"maxChars",function(){return this._maxChars},function(La){La<=0&&(La=1e5),this._maxChars=La}),Lk(0,La,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(La){Lz.superSet(Lqa,this,"color",this._originColor),La+="",this._focus?(this.nativeInput.value=La||"",this.event("change")):(this._multiline||(La=La.replace(/\r?\n/g,"")),(this._content=La)?Lz.superSet(Lqa,this,"text",La):(Lz.superSet(Lqa,this,"text",this._prompt),Lz.superSet(Lqa,this,"color",this.promptColor)))}),Lk(0,La,"nativeInput",function(){return this._multiline?Lf.area:Lf.input}),Lk(0,La,"prompt",function(){return this._prompt},function(La){!this._text&&La&&Lz.superSet(Lqa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Lz.superSet(Lqa,this,"text",this._text==this._prompt?La:this._text):Lz.superSet(Lqa,this,"text",La),this._prompt=Lqa.langPacks&&Lqa.langPacks[La]?Lqa.langPacks[La]:La}),Lk(0,La,"focus",function(){return this._focus},function(La){var Lb=this.nativeInput;this._focus!==La&&(La?(Lb.target?Lb.target._focusOut():this._setInputMethod(),(Lb.target=this)._focusIn()):(Lb.target=null,this._focusOut(),LO.document.body.scrollTop=0,Lb.blur(),LJ.isConchApp?Lb.setPos(-1e4,-1e4):Lf.inputContainer.contains(Lb)&&Lf.inputContainer.removeChild(Lb)))}),Lk(0,La,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(La){La?(-1<(La="[^"+La+"]").indexOf("^^")&&(La=La.replace("^^","")),this._restrictPattern=new RegExp(La,"g")):this._restrictPattern=null}),Lk(0,La,"editable",function(){return this._editable},function(La){this._editable=La,LJ.isConchApp&&Lf.input.setForbidEdit(!La)}),Lk(0,La,"promptColor",function(){return this._promptColor},function(La){this._promptColor=La,this._content||Lz.superSet(Lqa,this,"color",La)}),Lk(0,La,"type",function(){return this._type},function(La){this._getCSSStyle().password="password"==La,this._type=La,LJ.isConchApp&&this.nativeInput.setType(La)}),Lk(0,La,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(La){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),Lk(0,La,"asPassword",function(){return this._getCSSStyle().password},function(La){this._getCSSStyle().password=La,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),Lf.__init__=function(){Lf._createInputElement(),LO.onMobile&&LJ.canvas.addEventListener(Lf.IOS_IFRAME?LO.onMiniGame?"touchend":"click":"touchend",Lf._popupInputMethod)},Lf._popupInputMethod=function(La){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},Lf._createInputElement=function(){Lf._initInput(Lf.area=LO.createElement("textarea")),Lf._initInput(Lf.input=LO.createElement("input")),(Lf.inputContainer=LO.createElement("div")).style.position="absolute",Lf.inputContainer.style.zIndex=1e5,LO.container.appendChild(Lf.inputContainer),Lf.inputContainer.setPos=function(La,Lb){Lf.inputContainer.style.left=La+"px",Lf.inputContainer.style.top=Lb+"px"}},Lf._initInput=function(Lb){var La=Lb.style;La.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",La.resize="none",La.backgroundColor="transparent",La.border="none",La.outline="none",La.zIndex=1,Lb.addEventListener("input",Lf._processInputting),Lb.addEventListener("mousemove",Lf._stopEvent),Lb.addEventListener("mousedown",Lf._stopEvent),Lb.addEventListener("touchmove",Lf._stopEvent),Lb.setFontFace=function(La){Lb.style.fontFamily=La},LJ.isConchApp||(Lb.setColor=function(La){Lb.style.color=La},Lb.setFontSize=function(La){Lb.style.fontSize=La+"px"})},Lf._processInputting=function(La){var Lb=laya.display.Input.inputElement.target;if(Lb){var Lc=laya.display.Input.inputElement.value;Lb._restrictPattern&&(Lc=Lc.replace(/\u2006|\x27/g,""),Lb._restrictPattern.test(Lc)&&(Lc=Lc.replace(Lb._restrictPattern,""),laya.display.Input.inputElement.value=Lc)),Lb._text=Lc,Lb.event("input")}},Lf._stopEvent=function(La){"touchmove"==La.type&&La.preventDefault(),La.stopPropagation&&La.stopPropagation()},Lf.TYPE_TEXT="text",Lf.TYPE_PASSWORD="password",Lf.TYPE_EMAIL="email",Lf.TYPE_URL="url",Lf.TYPE_NUMBER="number",Lf.TYPE_RANGE="range",Lf.TYPE_DATE="date",Lf.TYPE_MONTH="month",Lf.TYPE_WEEK="week",Lf.TYPE_TIME="time",Lf.TYPE_DATE_TIME="datetime",Lf.TYPE_DATE_TIME_LOCAL="datetime-local",Lf.TYPE_SEARCH="search",Lf.input=null,Lf.area=null,Lf.inputElement=null,Lf.inputContainer=null,Lf.confirmButton=null,Lf.promptStyleDOM=null,Lf.inputHeight=45,Lf.isInputting=!1,Lf.stageMatrix=null,Li(Lf,["IOS_IFRAME",function(){return this.IOS_IFRAME=LO.onIOS&&LO.window.top!=LO.window.self}]),Lf}(Lqa),Lya=function(La){function Lc(La,Lb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,Lc.__super.call(this),La&&this._init_(La,Lb)}Lq(Lc,"laya.resource.HTMLImage",Lsa);var Lb=Lc.prototype;return Lb._init_=function(La,Lb){this._src=La,this._source=new LO.window.Image,Lb&&(Lb.onload&&(this.onload=Lb.onload),Lb.onerror&&(this.onerror=Lb.onerror),Lb.onCreate&&Lb.onCreate(this)),0!=La.indexOf("data:image")&&(this._source.crossOrigin=""),La&&(this._source.src=La)},Lb.recreateResource=function(){var La=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Lb=this;this._source=new LO.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Lb._needReleaseAgain)return Lb._needReleaseAgain=!1,Lb._source.onload=null,void(Lb._source=null);Lb._source.onload=null,Lb.memorySize=La._w*La._h*4,Lb._recreateLock=!1,Lb.completeCreate()},this._source.src=this._src}},Lb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Lb.onresize=function(){this._w=this._source.width,this._h=this._source.height},Lk(0,Lb,"onload",null,function(La){var Lb=this;this._onload=La,this._source&&(this._source.onload=null!=this._onload?function(){Lb.onresize(),Lb._onload()}:null)}),Lk(0,Lb,"onerror",null,function(La){var Lb=this;this._onerror=La,this._source&&(this._source.onerror=null!=this._onerror?function(){Lb._onerror()}:null)}),Lk(0,Lb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(La){this._enableMerageInAtlas=La,LJ.isConchApp&&this._source&&(this._source.enableMerageInAtlas=La)}),Lc.create=function(La,Lb){return new Lc(La,Lb)},Lc}(),Lza=(function(Lf){function La(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,La.__super.call(this)}Lq(La,"laya.display.EffectAnimation",Lf);var Lb=La.prototype;Lb._onOtherBegin=function(La){La!=this&&this.stop()},Lb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Lb._onPlayAction=function(){this.play(0,!1)},Lb.play=function(La,Lb,Lc,Ld){void 0===La&&(La=0),void 0===Lb&&(Lb=!0),void 0===Lc&&(Lc=""),void 0===Ld&&(Ld=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,La,Lb,Lc,Ld))},Lb._recordInitData=function(){if(this._aniKeys){var La,Lb,Lc=0;for(La=this._aniKeys.length,Lc=0;Lc<La;Lc++)Lb=this._aniKeys[Lc],this._initData[Lb]=this._target[Lb]}},Lb._displayToIndex=function(La){if(this._animationData){La<0&&(La=0),La>this._count&&(La=this._count);var Lb=this._animationData.nodes,Lc=0,Ld=Lb.length;for(Ld=1<Ld?1:Ld,Lc=0;Lc<Ld;Lc++)this._displayNodeToFrame(Lb[Lc],La)}},Lb._displayNodeToFrame=function(La,Lb,Lc){if(this._target){var Ld;Ld=this._target;var Le,Lf,Lg,Lh,Li=La.frames,Lj=La.keys,Lk=0,Ll=Lj.length;Lh=La.secondFrames;var Lm,Ln,Lo,Lp,Lq=0;for(Lk=0;Lk<Ll;Lk++)Lf=Li[Le=Lj[Lk]],Lg=-1==(Lq=Lh[Le])?this._initData[Le]:Lb<Lq?(Lo=(Ln=La.keyframes[Le])[0]).tween?(null==(Lm=LU[Lo.tweenMethod])&&(Lm=LU.linearNone),Lp=Ln[1],Lm(Lb,this._initData[Le],Lp.value-this._initData[Le],Lp.index)):this._initData[Le]:Lf.length>Lb?Lf[Lb]:Lf[Lf.length-1],Ld[Le]=Lg}},Lb._calculateNodeKeyFrames=function(La){Lf.prototype._calculateNodeKeyFrames.call(this,La);var Lb,Lc,Ld,Le=La.keyframes;La.target;for(Lb in Ld={},La.secondFrames=Ld,Le)(Lc=Le[Lb]).length<=1?Ld[Lb]=-1:Ld[Lb]=Lc[1].index},Lk(0,Lb,"target",function(){return this._target},function(La){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=La,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),Lk(0,Lb,"playEvent",null,function(La){(this._playEvents=La)&&this.addEvent()}),Lk(0,Lb,"effectData",null,function(La){var Lb;La&&((Lb=La.animations)&&Lb[0]&&(this._setUp({},Lb[0]),Lb[0].nodes&&Lb[0].nodes[0]&&(this._aniKeys=Lb[0].nodes[0].keys)))}),Lk(0,Lb,"effectClass",null,function(La){var Lb,Lc;(this._effectClass=LR.getClass(La),this._effectClass)&&((Lb=this._effectClass.uiView)&&(Lc=Lb.animations)&&Lc[0]&&(this._setUp({},Lc[0]),Lc[0].nodes&&Lc[0].nodes[0]&&(this._aniKeys=Lc[0].nodes[0].keys)))}),La.EffectAnimationBegin="effectanimationbegin"}(Lua),function(Lb){var LD;function LE(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,LE.__super.call(this)}Lq(LE,"laya.utils.GraphicAnimation",Lb);var La=LE.prototype;return La._parseNodeList=function(La){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[La.compId]=La.props,La.compId&&this._nodeList.push(La.compId);var Lb=La.child;if(Lb){var Lc=0,Ld=Lb.length;for(Lc=0;Lc<Ld;Lc++)this._parseNodeList(Lb[Lc])}},La._calGraphicData=function(La){var Lb;if(this._setUp(null,La),this._createGraphicData(),this._nodeIDAniDic)for(Lb in this._nodeIDAniDic)this._nodeIDAniDic[Lb]=null},La._createGraphicData=function(){var La,Lb=[],Lc=0,Ld=this.count,Le=this._animationNewFrames;for(Le||(Le=[]),Lc=0;Lc<Ld;Lc++)!Le[Lc]&&La||(La=this._createFrameGraphic(Lc)),Lb.push(La);this._gList=Lb},La._createFrameGraphic=function(La){var Lb=LF.createGraphics();return LE._rootMatrix||(LE._rootMatrix=new LG),this._updateNodeGraphic(this._rootNode,La,LE._rootMatrix,Lb),Lb},La._updateNodeGraphic=function(La,Lb,Lc,Ld,Le){var Lf;void 0===Le&&(Le=1);var Lg,Lh,Li,Lj=(Lf=this._nodeGDic[La.compId]=this._getNodeGraphicData(La.compId,Lb,this._nodeGDic[La.compId])).alpha*Le;if(!(Lj<.01)&&(Lf.resultTransform||(Lf.resultTransform=LG.create()),Lg=Lf.resultTransform,LG.mul(Lf.transform,Lc,Lg),Lf.skin&&(Lh=this._getTextureByUrl(Lf.skin))&&(Lg._checkTransform()?(Ld.drawTexture(Lh,0,0,Lf.width,Lf.height,Lg,Lj),Lf.resultTransform=null):Ld.drawTexture(Lh,Lg.tx,Lg.ty,Lf.width,Lf.height,null,Lj)),Li=La.child)){var Lk,Ll=0;for(Lk=Li.length,Ll=0;Ll<Lk;Ll++)this._updateNodeGraphic(Li[Ll],Lb,Lg,Ld,Lj)}},La._updateNoChilds=function(La,Lb){if(La.skin){var Lc=this._getTextureByUrl(La.skin);if(Lc){var Ld=La.transform;Ld._checkTransform();!Ld.bTransform?Lb.drawTexture(Lc,Ld.tx,Ld.ty,La.width,La.height,null,La.alpha):Lb.drawTexture(Lc,0,0,La.width,La.height,Ld.clone(),La.alpha)}}},La._updateNodeGraphic2=function(La,Lb,Lc){var Ld;if(Ld=this._nodeGDic[La.compId]=this._getNodeGraphicData(La.compId,Lb,this._nodeGDic[La.compId]),La.child){var Le=Ld.transform;Le._checkTransform();var Lf,Lg;Lg=(Lf=!Le.bTransform)&&(0!=Le.tx||0!=Le.ty);var Lh,Li,Lj;if((Lh=Le.bTransform||1!=Ld.alpha)&&Lc.save(),1!=Ld.alpha&&Lc.alpha(Ld.alpha),Lf?Lg&&Lc.translate(Le.tx,Le.ty):Lc.transform(Le.clone()),Li=La.child,Ld.skin&&(Lj=this._getTextureByUrl(Ld.skin))&&Lc.drawTexture(Lj,0,0,Ld.width,Ld.height),Li){var Lk,Ll=0;for(Lk=Li.length,Ll=0;Ll<Lk;Ll++)this._updateNodeGraphic2(Li[Ll],Lb,Lc)}Lh?Lc.restore():Lf?Lg&&Lc.translate(-Le.tx,-Le.ty):Lc.transform(Le.clone().invert())}else this._updateNoChilds(Ld,Lc)},La._calculateNodeKeyFrames=function(La){Lb.prototype._calculateNodeKeyFrames.call(this,La),this._nodeIDAniDic[La.target]=La},La.getNodeDataByID=function(La){return this._nodeIDAniDic[La]},La._getParams=function(La,Lb,Lc,Ld){var Le=LE._temParam;Le.length=Lb.length;var Lf=0,Lg=Lb.length;for(Lf=0;Lf<Lg;Lf++)Le[Lf]=this._getObjVar(La,Lb[Lf][0],Lc,Lb[Lf][1],Ld);return Le},La._getObjVar=function(La,Lb,Lc,Ld,Le){if(La.hasOwnProperty(Lb)){var Lf=La[Lb];if(Lc>=Lf.length&&(Lc=Lf.length-1),null!=La[Lb][Lc])return La[Lb][Lc]}return Le.hasOwnProperty(Lb)?Le[Lb]:Ld},La._getNodeGraphicData=function(La,Lb,Lc){Lc||(Lc=LD.create()),Lc.transform?Lc.transform.identity():Lc.transform=LG.create();var Ld=this.getNodeDataByID(La);if(!Ld)return Lc;var Le,Lf,Lg=Ld.frames,Lh=this._getParams(Lg,LE._drawTextureCmd,Lb,this._nodeDefaultProps[La]),Li=Lh[0],Lj=NaN,Lk=NaN,Ll=Lh[5],Lm=Lh[6],Ln=Lh[13],Lo=Lh[14],Lp=Lh[7],Lq=Lh[8],Lr=Lh[9],Ls=Lh[11],Lt=Lh[12];Lj=Lh[3],Lk=Lh[4],0!=Lj&&0!=Lk||(Li=null),-1==Lj&&(Lj=0),-1==Lk&&(Lk=0),Lc.skin=Li,Lc.width=Lj,Lc.height=Lk,Li&&((Le=this._getTextureByUrl(Li))?(Lj||(Lj=Le.sourceWidth),Lk||(Lk=Le.sourceHeight)):console.warn("lost skin:",Li,",you may load pics first")),Lc.alpha=Lh[10],Lf=Lc.transform,0!=Ln&&(Ll=Ln*Lj),0!=Lo&&(Lm=Lo*Lk),0==Ll&&0==Lm||Lf.translate(-Ll,-Lm);var Lu=null;if(Lr||1!==Lp||1!==Lq||Ls||Lt){(Lu=LE._tempMt).identity(),Lu.bTransform=!0;var Lv=.0174532922222222*(Lr-Ls),Ly=.0174532922222222*(Lr+Lt),Lz=Math.cos(Ly),LA=Math.sin(Ly),LB=Math.sin(Lv),LC=Math.cos(Lv);Lu.a=Lp*Lz,Lu.b=Lp*LA,Lu.c=-Lq*LB,Lu.d=Lq*LC,Lu.tx=Lu.ty=0}return Lu&&(Lf=LG.mul(Lf,Lu,Lf)),Lf.translate(Lh[1],Lh[2]),Lc},La._getTextureByUrl=function(La){return Lha.getRes(La)},La.setAniData=function(La,Lb){if(La.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=La,this._parseNodeList(La);var Lc,Ld={},Le=[],Lf=La.animations,Lg=0,Lh=Lf.length;for(Lg=0;Lg<Lh;Lg++)if(Lc=Lf[Lg],this._labels=null,(!Lb||Lb==Lc.name)&&Lc){try{this._calGraphicData(Lc)}catch(La){console.warn("parse animation fail:"+Lc.name+",empty animation created"),this._gList=[]}var Li={};Li.interval=1e3/Lc.frameRate,Li.frames=this._gList,Li.labels=this._labels,Li.name=Lc.name,Le.push(Li),Ld[Lc.name]=Li}this.animationList=Le,this.animationDic=Ld}LE._temParam.length=0},La.parseByData=function(La){var Lb,Lc;Lb=La.nodeRoot,Lc=La.aniO,delete La.nodeRoot,delete La.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Lb,this._parseNodeList(Lb),this._labels=null;try{this._calGraphicData(Lc)}catch(La){console.warn("parse animation fail:"+Lc.name+",empty animation created"),this._gList=[]}var Ld=La;return Ld.interval=1e3/Lc.frameRate,Ld.frames=this._gList,Ld.labels=this._labels,Ld.name=Lc.name,Ld},La.setUpAniData=function(La){if(La.animations){var Lb,Lc={},Ld=[],Le=La.animations,Lf=0,Lg=Le.length;for(Lf=0;Lf<Lg;Lf++)if(Lb=Le[Lf]){var Lh={};Lh.name=Lb.name,Lh.aniO=Lb,Lh.nodeRoot=La,Ld.push(Lh),Lc[Lb.name]=Lh}this.animationList=Ld,this.animationDic=Lc}},La._clear=function(){var La,Lb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(La in this._nodeGDic)(Lb=this._nodeGDic[La])&&Lb.recover();this._nodeGDic=null},LE.parseAnimationByData=function(La){var Lb;return LE._I||(LE._I=new LE),Lb=LE._I.parseByData(La),LE._I._clear(),Lb},LE.parseAnimationData=function(La){var Lb;return LE._I||(LE._I=new LE),LE._I.setUpAniData(La),(Lb={}).animationList=LE._I.animationList,Lb.animationDic=LE._I.animationDic,LE._I._clear(),Lb},LE._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],LE._temParam=[],LE._I=null,LE._rootMatrix=null,Li(LE,["_tempMt",function(){return this._tempMt=new LG}]),LE.__init$=function(){LD=function(){function La(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Lq(La,""),La.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),LW.recover("GraphicNode",this)},La.create=function(){return LW.getItemByClass("GraphicNode",La)},La}()},LE}(Lua));Lz.__init([Lj,Lia,LJ,LO,LY,LC,La,Lza])}(window,document,Laya),function(La,Lb,Lc){Lc.un,Lc.uns,Lc.static;var Ld=Lc.class;Lc.getset,Lc.__newvec;new(function(){function La(){}return Ld(La,"LayaMain"),La}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(Le,La,Ly){Ly.un,Ly.uns;var Lg=Ly.static,Lm=Ly.class,Ld=Ly.getset,Lf=Ly.__newvec,Lk=laya.maths.Arith,Ll=laya.maths.Bezier,Lc=laya.resource.Bitmap,Ln=laya.utils.Browser,Li=laya.utils.Byte,Lo=laya.utils.Color,Lz=(laya.filters.ColorFilter,Ly.Config),Lh=laya.resource.Context,LA=(laya.events.Event,laya.filters.Filter),Lj=laya.display.Graphics,Lp=laya.resource.HTMLCanvas,Lq=(laya.utils.HTMLChar,laya.resource.HTMLImage),Lb=laya.resource.HTMLSubImage,LB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),LC=laya.maths.Point,LD=laya.maths.Rectangle,Lr=laya.renders.Render,Ls=(laya.renders.RenderContext,laya.renders.RenderSprite),Lt=laya.resource.Resource,Lu=laya.resource.ResourceManager,Lv=laya.utils.RunDriver,LE=laya.display.Sprite,LF=laya.display.Stage,LG=laya.utils.Stat,LH=laya.utils.StringKey,LI=(laya.display.css.Style,laya.system.System),LJ=laya.display.Text,LK=laya.resource.Texture,LL=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),LM=laya.utils.VectorGraphManager;laya.utils.WordText;Ly.interface("laya.webgl.shapes.IShape"),Ly.interface("laya.webgl.submit.ISubmit"),Ly.interface("laya.webgl.text.ICharSegment"),Ly.interface("laya.webgl.canvas.save.ISaveData"),Ly.interface("laya.webgl.resource.IMergeAtlasBitmap"),Ly.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var LN=function(){function La(){}Lm(La,"laya.filters.webgl.FilterActionGL");var Lb=La.prototype;return Ly.imps(Lb,{"laya.filters.IFilterActionGL":!0}),Lb.setValue=function(La){},Lb.setValueMix=function(La){},Lb.apply3d=function(La,Lb,Lc,Ld,Le){return null},Lb.apply=function(La){return null},Ld(0,Lb,"typeMix",function(){return 0}),La}(),LO=function(){function La(){}return Lm(La,"laya.webgl.shader.ShaderValue"),La}(),LP=function(){var Ld,Le;function La(La,Lb,Lc){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new Le,void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),this._cells=null,this._rowInfo=null,this._init(La,Lb),this._atlasID=Lc}Lm(La,"laya.webgl.atlas.AtlasGrid");var Lb=La.prototype;return Lb.getAltasID=function(){return this._atlasID},Lb.setAltasID=function(La){0<=La&&(this._atlasID=La)},Lb.addTex=function(La,Lb,Lc){var Ld=this._get(Lb,Lc);return 0==Ld.ret||(this._fill(Ld.x,Ld.y,Lb,Lc,La),this._texCount++),Ld},Lb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Lb._init=function(La,Lb){if(this._width=La,this._height=Lb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Lf(this._height);for(var Lc=0;Lc<this._height;Lc++)this._rowInfo[Lc]=new Ld;return this._clear(),!0},Lb._get=function(La,Lb){var Lc=new LR;if(La>=this._failSize.width&&Lb>=this._failSize.height)return Lc;for(var Ld=-1,Le=-1,Lf=this._width,Lg=this._height,Lh=this._cells,Li=0;Li<Lg;Li++)if(!(this._rowInfo[Li].spaceCount<La))for(var Lj=0;Lj<Lf;){var Lk=3*(Li*Lf+Lj);if(0!=Lh[Lk]||Lh[1+Lk]<La||Lh[2+Lk]<Lb)Lj+=Lh[1+Lk];else{Ld=Lj,Le=Li;for(var Ll=0;Ll<La;Ll++)if(Lh[3*Ll+Lk+2]<Lb){Ld=-1;break}if(!(Ld<0))return Lc.ret=!0,Lc.x=Ld,Lc.y=Le,Lc;Lj+=Lh[1+Lk]}}return Lc},Lb._fill=function(La,Lb,Lc,Ld,Le){var Lf=this._width,Lg=this._height;this._check(La+Lc<=Lf&&Lb+Ld<=Lg);for(var Lh=Lb;Lh<Ld+Lb;++Lh){this._check(this._rowInfo[Lh].spaceCount>=Lc),this._rowInfo[Lh].spaceCount-=Lc;for(var Li=0;Li<Lc;Li++){var Lj=3*(La+Lh*Lf+Li);this._check(0==this._cells[Lj]),this._cells[Lj]=Le,this._cells[1+Lj]=Lc,this._cells[2+Lj]=Ld}}if(0<La)for(Lh=0;Lh<Ld;++Lh){var Lk=0;for(Li=La-1;0<=Li&&0==this._cells[3*((Lb+Lh)*Lf+Li)];--Li,++Lk);for(Li=Lk;0<Li;--Li)this._cells[3*((Lb+Lh)*Lf+La-Li)+1]=Li,this._check(0<Li)}if(0<Lb)for(Li=La;Li<La+Lc;++Li){for(Lk=0,Lh=Lb-1;0<=Lh&&0==this._cells[3*(Li+Lh*Lf)];--Lh,Lk++);for(Lh=Lk;0<Lh;--Lh)this._cells[3*(Li+(Lb-Lh)*Lf)+2]=Lh,this._check(0<Lh)}},Lb._check=function(La){0==La&&console.log("xtexMerger 错误啦")},Lb._clear=function(){for(var La=this._texCount=0;La<this._height;La++)this._rowInfo[La].spaceCount=this._width;for(var Lb=0;Lb<this._height;Lb++)for(var Lc=0;Lc<this._width;Lc++){var Ld=3*(Lb*this._width+Lc);this._cells[Ld]=0,this._cells[1+Ld]=this._width-Lc,this._cells[2+Ld]=this._width-Lb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},La.__init$=function(){Ld=function(){function La(){this.spaceCount=0}return Lm(La,""),La}(),Le=function(){function La(){this.width=0,this.height=0}return Lm(La,""),La}()},La}(),LQ=function(){function Lr(La,Lb,Lc,Ld){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=La,this._height=Lb,this._gridSize=Lc,this._maxAtlaserCount=Ld,this._gridNumX=La/Lc,this._gridNumY=Lb/Lc,this._curAtlasIndex=0,this._atlaserArray=[]}Lm(Lr,"laya.webgl.atlas.AtlasResourceManager");var La=Lr.prototype;return La.setAtlasParam=function(La,Lb,Lc,Ld){if(1==this._setAtlasParam)return Lr._sid_=0,this._width=La,this._height=Lb,this._gridSize=Lc,this._maxAtlaserCount=Ld,this._gridNumX=La/Lc,this._gridNumY=Lb/Lc,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},La.pushData=function(La){var Lb,Lc=La.bitmap,Ld=-1,Le=null,Lf=0,Lg=0;for(Lf=0,Lb=this._atlaserArray.length;Lf<Lb&&(Lg=(this._curAtlasIndex+Lf)%Lb,-1==(Ld=(Le=this._atlaserArray[Lg]).findBitmapIsExist(Lc)));Lf++);if(-1!=Ld){var Lh=Le.InAtlasWebGLImagesOffsetValue[Ld];return Lo=Lh[0],Lp=Lh[1],Le.addToAtlas(La,Lo,Lp),!0}this._setAtlasParam=!1;for(var Li=Math.ceil((La.bitmap.width+2)/this._gridSize),Lj=Math.ceil((La.bitmap.height+2)/this._gridSize),Lk=!1,Ll=0;Ll<2;Ll++){var Lm=this._maxAtlaserCount;for(Lf=0;Lf<Lm;Lf++){Lg=(this._curAtlasIndex+Lf)%Lm,this._atlaserArray.length-1>=Lg||this._atlaserArray.push(new LDa(this._gridNumX,this._gridNumY,this._width,this._height,Lr._sid_++));var Ln=this._atlaserArray[Lg],Lo=0,Lp=0,Lq=Ln.addTex(1,Li,Lj);if(Lq.ret){Lo=Lq.x*this._gridSize+1,Lp=Lq.y*this._gridSize+1,Lc.lock=!0,Ln.addToAtlasTexture(Lc,Lo,Lp),Ln.addToAtlas(La,Lo,Lp),Lk=!0,this._curAtlasIndex=Lg;break}}if(Lk)break;this._atlaserArray.push(new LDa(this._gridNumX,this._gridNumY,this._width,this._height,Lr._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return Lk||console.log(">>>AtlasManager pushData error"),Lk},La.addToAtlas=function(La){laya.webgl.atlas.AtlasResourceManager.instance.pushData(La)},La.garbageCollection=function(){if(!0===this._needGC){for(var La=this._atlaserArray.length-this._maxAtlaserCount,Lb=0;Lb<La;Lb++)this._atlaserArray[Lb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+La),this._atlaserArray.splice(0,La),this._needGC=!1}return!0},La.freeAll=function(){for(var La=0,Lb=this._atlaserArray.length;La<Lb;La++)this._atlaserArray[La].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},La.getAtlaserCount=function(){return this._atlaserArray.length},La.getAtlaserByIndex=function(La){return this._atlaserArray[La]},Ld(1,Lr,"instance",function(){return Lr._Instance||(Lr._Instance=new Lr(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),Lr._Instance}),Ld(1,Lr,"enabled",function(){return Lz.atlasEnable}),Ld(1,Lr,"atlasLimitWidth",function(){return Lr._atlasLimitWidth},function(La){Lr._atlasLimitWidth=La}),Ld(1,Lr,"atlasLimitHeight",function(){return Lr._atlasLimitHeight},function(La){Lr._atlasLimitHeight=La}),Lr._enable=function(){Lz.atlasEnable=!0},Lr._disable=function(){Lz.atlasEnable=!1},Lr.__init__=function(){Lr.atlasTextureWidth=2048,Lr.atlasTextureHeight=2048,Lr.maxTextureCount=6,Lr.atlasLimitWidth=512,Lr.atlasLimitHeight=512},Lr._atlasLimitWidth=0,Lr._atlasLimitHeight=0,Lr.gridSize=16,Lr.atlasTextureWidth=0,Lr.atlasTextureHeight=0,Lr.maxTextureCount=0,Lr._atlasRestore=0,Lr.BOARDER_TYPE_NO=0,Lr.BOARDER_TYPE_RIGHT=1,Lr.BOARDER_TYPE_LEFT=2,Lr.BOARDER_TYPE_BOTTOM=4,Lr.BOARDER_TYPE_TOP=8,Lr.BOARDER_TYPE_ALL=15,Lr._sid_=0,Lr._Instance=null,Lr}(),LR=function(){function La(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Lm(La,"laya.webgl.atlas.MergeFillInfo"),La}(),LS=function(){function Lb(){}return Lm(Lb,"laya.webgl.canvas.BlendMode"),Lb._init_=function(La){Lb.fns=[Lb.BlendNormal,Lb.BlendAdd,Lb.BlendMultiply,Lb.BlendScreen,Lb.BlendOverlay,Lb.BlendLight,Lb.BlendMask,Lb.BlendDestinationOut],Lb.targetFns=[Lb.BlendNormalTarget,Lb.BlendAddTarget,Lb.BlendMultiplyTarget,Lb.BlendScreenTarget,Lb.BlendOverlayTarget,Lb.BlendLightTarget,Lb.BlendMask,Lb.BlendDestinationOut]},Lb.BlendNormal=function(La){La.blendFunc(1,771)},Lb.BlendAdd=function(La){La.blendFunc(1,772)},Lb.BlendMultiply=function(La){La.blendFunc(774,771)},Lb.BlendScreen=function(La){La.blendFunc(1,1)},Lb.BlendOverlay=function(La){La.blendFunc(1,769)},Lb.BlendLight=function(La){La.blendFunc(1,1)},Lb.BlendNormalTarget=function(La){La.blendFunc(1,771)},Lb.BlendAddTarget=function(La){La.blendFunc(1,772)},Lb.BlendMultiplyTarget=function(La){La.blendFunc(774,771)},Lb.BlendScreenTarget=function(La){La.blendFunc(1,1)},Lb.BlendOverlayTarget=function(La){La.blendFunc(1,769)},Lb.BlendLightTarget=function(La){La.blendFunc(1,1)},Lb.BlendMask=function(La){La.blendFunc(0,770)},Lb.BlendDestinationOut=function(La){La.blendFunc(0,0)},Lb.activeBlendFunction=null,Lb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Lb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Lb.NORMAL="normal",Lb.ADD="add",Lb.MULTIPLY="multiply",Lb.SCREEN="screen",Lb.LIGHT="light",Lb.OVERLAY="overlay",Lb.DESTINATIONOUT="destination-out",Lb.fns=[],Lb.targetFns=[],Lb}(),LT=function(){function Lc(La){this._color=Lo.create("black"),this.setValue(La)}Lm(Lc,"laya.webgl.canvas.DrawStyle");var La=Lc.prototype;return La.setValue=function(La){if(La){if("string"==typeof La)return void(this._color=Lo.create(La));if(La instanceof laya.utils.Color)return void(this._color=La)}},La.reset=function(){this._color=Lo.create("black")},La.equal=function(La){return"string"==typeof La?this._color.strColor===La:La instanceof laya.utils.Color&&this._color.numColor===La.numColor},La.toColorStr=function(){return this._color.strColor},Lc.create=function(La){var Lb;if(La&&("string"==typeof La?Lb=Lo.create(La):La instanceof laya.utils.Color&&(Lb=La),Lb))return Lb._drawStyle||(Lb._drawStyle=new Lc(La));return laya.webgl.canvas.DrawStyle.DEFAULT},Lg(Lc,["DEFAULT",function(){return this.DEFAULT=new Lc("#000000")}]),Lc}(),LU=function(){function La(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];Lua.mainContext;this.ib=Lwa.create(35048),this.vb=Lxa.create(5)}Lm(La,"laya.webgl.canvas.Path");var Lb=La.prototype;return Lb.addPoint=function(La,Lb){this.tempArray.push(La,Lb)},Lb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Lb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Lb.polygon=function(La,Lb,Lc,Ld,Le,Lf){var Lg;return this.geomatrys.push(this._curGeomatry=Lg=new LHa(La,Lb,Lc,Ld,Le,Lf)),Ld||(Lg.fill=!1),null==Lf&&(Lg.borderWidth=0),Lg},Lb.setGeomtry=function(La){this.geomatrys.push(this._curGeomatry=La)},Lb.drawLine=function(La,Lb,Lc,Ld,Le){var Lf;return this.closePath?this.geomatrys.push(this._curGeomatry=Lf=new LGa(La,Lb,Lc,Ld,Le)):this.geomatrys.push(this._curGeomatry=Lf=new LFa(La,Lb,Lc,Ld,Le)),Lf.fill=!1,Lf},Lb.update=function(){var La=this.ib._byteLength,Lb=this.geomatrys.length;this.offset=La;for(var Lc=this.geoStart;Lc<Lb;Lc++)this.geomatrys[Lc].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Lb,this.count=(this.ib._byteLength-La)/Lpa.BYTES_PIDX},Lb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Lb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},La}(),LV=function(){function Lh(){}Lm(Lh,"laya.webgl.canvas.save.SaveBase");var La=Lh.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!1},La.restore=function(La){this._dataObj[this._valueName]=this._value,(Lh._cache[Lh._cache._length++]=this)._newSubmit&&(La._curSubmit=Lfa.RENDERBASE,La._renderKey=0)},Lh._createArray=function(){var La=[];return La._length=0,La},Lh._init=function(){var La=Lh._namemap={};return La[1]="ALPHA",La[2]="fillStyle",La[8]="font",La[256]="lineWidth",La[512]="strokeStyle",La[8192]="_mergeID",La[1024]=La[2048]=La[4096]=[],La[16384]="textBaseline",La[32768]="textAlign",La[65536]="_nBlendType",La[1048576]="shader",La[2097152]="filters",La},Lh.save=function(La,Lb,Lc,Ld){if((La._saveMark._saveuse&Lb)!==Lb){La._saveMark._saveuse|=Lb;var Le=Lh._cache,Lf=0<Le._length?Le[--Le._length]:new Lh;Lf._value=Lc[Lf._valueName=Lh._namemap[Lb]],Lf._dataObj=Lc,Lf._newSubmit=Ld;var Lg=La._save;Lg[Lg._length++]=Lf}},Lh._cache=laya.webgl.canvas.save.SaveBase._createArray(),Lh._namemap=Lh._init(),Lh}(),LW=function(){function Lf(){this._clipRect=new LD}Lm(Lf,"laya.webgl.canvas.save.SaveClipRect");var La=Lf.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!1},La.restore=function(La){La._clipRect=this._clipSaveRect,(Lf._cache[Lf._cache._length++]=this)._submitScissor.submitLength=La._submits._length-this._submitScissor.submitIndex,La._curSubmit=Lfa.RENDERBASE,La._renderKey=0},Lf.save=function(La,Lb){if(131072!=(131072&La._saveMark._saveuse)){La._saveMark._saveuse|=131072;var Lc=Lf._cache,Ld=0<Lc._length?Lc[--Lc._length]:new Lf;Ld._clipSaveRect=La._clipRect,La._clipRect=Ld._clipRect.copyFrom(La._clipRect),Ld._submitScissor=Lb;var Le=La._save;Le[Le._length++]=Ld}},Lg(Lf,["_cache",function(){return this._cache=LV._createArray()}]),Lf}(),LX=function(){function Ln(){this._contextX=0,this._contextY=0,this._clipRect=new LD,this._rect=new LD,this._matrix=new LB}Lm(Ln,"laya.webgl.canvas.save.SaveClipRectStencil");var La=Ln.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!1},La.restore=function(La){Lka.restore(La,this._rect,this._saveMatrix,this._contextX,this._contextY),La._clipRect=this._clipSaveRect,La._curMat=this._saveMatrix,La._x=this._contextX,La._y=this._contextY,Ln._cache[Ln._cache._length++]=this,La._curSubmit=Lfa.RENDERBASE},Ln.save=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){if(262144!=(262144&La._saveMark._saveuse)){La._saveMark._saveuse|=262144;var Lk=Ln._cache,Ll=0<Lk._length?Lk[--Lk._length]:new Ln;Ll._clipSaveRect=La._clipRect,Ll._clipRect.setTo(Lg,Lh,Li,Lj),La._clipRect=Ll._clipRect,Ll._rect.x=Lc,Ll._rect.y=Ld,Ll._rect.width=Le,Ll._rect.height=Lf,Ll._contextX=La._x,Ll._contextY=La._y,Ll._saveMatrix=La._curMat,La._curMat.copyTo(Ll._matrix),La._curMat=Ll._matrix,Ll._submitStencil=Lb;var Lm=La._save;Lm[Lm._length++]=Ll}},Lg(Ln,["_cache",function(){return this._cache=LV._createArray()}]),Ln}(),LY=function(){function Ld(){this._saveuse=0}Lm(Ld,"laya.webgl.canvas.save.SaveMark");var La=Ld.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!0},La.restore=function(La){La._saveMark=this._preSaveMark,Ld._no[Ld._no._length++]=this},Ld.Create=function(La){var Lb=Ld._no,Lc=0<Lb._length?Lb[--Lb._length]:new Ld;return Lc._saveuse=0,Lc._preSaveMark=La._saveMark,La._saveMark=Lc},Lg(Ld,["_no",function(){return this._no=LV._createArray()}]),Ld}(),LZ=function(){function Lf(){this._matrix=new LB}Lm(Lf,"laya.webgl.canvas.save.SaveTransform");var La=Lf.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!1},La.restore=function(La){La._curMat=this._savematrix,Lf._no[Lf._no._length++]=this},Lf.save=function(La){var Lb=La._saveMark;if(2048!=(2048&Lb._saveuse)){Lb._saveuse|=2048;var Lc=Lf._no,Ld=0<Lc._length?Lc[--Lc._length]:new Lf;Ld._savematrix=La._curMat,La._curMat=La._curMat.copyTo(Ld._matrix);var Le=La._save;Le[Le._length++]=Ld}},Lg(Lf,["_no",function(){return this._no=LV._createArray()}]),Lf}(),L$=function(){function Le(){}Lm(Le,"laya.webgl.canvas.save.SaveTranslate");var La=Le.prototype;return Ly.imps(La,{"laya.webgl.canvas.save.ISaveData":!0}),La.isSaveMark=function(){return!1},La.restore=function(La){La._curMat;La._x=this._x,La._y=this._y,Le._no[Le._no._length++]=this},Le.save=function(La){var Lb=Le._no,Lc=0<Lb._length?Lb[--Lb._length]:new Le;Lc._x=La._x,Lc._y=La._y;var Ld=La._save;Ld[Ld._length++]=Lc},Lg(Le,["_no",function(){return this._no=LV._createArray()}]),Le}(),L_=function(){function La(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new LD}Lm(La,"laya.webgl.resource.RenderTargetMAX");var Lb=La.prototype;return Lb.setSP=function(La){this._sp=La},Lb.size=function(La,Lb){var Lc=this;this._width!==La||this._height!==Lb?(this.repaint=!0,this._width=La,this._height=Lb,this.target?this.target.size(La,Lb):this.target=LMa.create(La,Lb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(La){Ly.timer.callLater(Lc._sp,Lc._sp.repaint)})):this.target.size(La,Lb)},Lb._flushToTarget=function(La,Lb){if(!Lb._destroy){var Lc=Lsa.worldScissorTest,Ld=Lsa.worldClipRect;Lsa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,Lsa.worldScissorTest=!1,Lua.mainContext.disable(3089);var Le=Lsa.worldAlpha,Lf=Lsa.worldMatrix4,Lg=Lsa.worldMatrix,Lh=Lsa.worldFilters,Li=Lsa.worldShaderDefines;if(Lsa.worldMatrix=LB.EMPTY,Lsa.restoreTempArray(),Lsa.worldMatrix4=Lsa.TEMPMAT4_ARRAY,Lsa.worldAlpha=1,Lsa.worldFilters=null,Lsa.worldShaderDefines=null,LLa.activeShader=null,Lb.start(),Lz.showCanvasMark?Lb.clear(0,1,0,.3):Lb.clear(0,0,0,0),La.flush(),Lb.end(),LLa.activeShader=null,Lsa.worldAlpha=Le,Lsa.worldMatrix4=Lf,Lsa.worldMatrix=Lg,Lsa.worldFilters=Lh,Lsa.worldShaderDefines=Li,Lsa.worldScissorTest=Lc){var Lj=Lsa.height-Ld.y-Ld.height;Lua.mainContext.scissor(Ld.x,Lj,Ld.width,Ld.height),Lua.mainContext.enable(3089)}Lsa.worldClipRect=Ld}},Lb.flush=function(La){this.repaint&&(this._flushToTarget(La,this.target),this.repaint=!1)},Lb.drawTo=function(La,Lb,Lc,Ld,Le){La.drawTexture(this.target.getTexture(),Lb,Lc,Ld,Le,0,0)},Lb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},La}(),Lw=function(){function La(){this.ALPHA=1,this.shaderType=0,this.defines=new LEa}return Lm(La,"laya.webgl.shader.d2.Shader2D"),La.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},La.__init__=function(){var La,Lb;LYa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),LYa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),LYa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),LYa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),LYa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),LYa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),LYa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),LYa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),La="attribute vec4 position;\n",La+="attribute vec2 texcoord;\n",La+="uniform vec2 size;\n\n",La+="#ifdef WORLDMAT\n",La+="  uniform mat4 mmat;\n",La+="#endif\n",La+="varying vec2 v_texcoord;\n",La+="void main() {\n",La+="  #ifdef WORLDMAT\n",La+="  vec4 pos=mmat*position;\n",La+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",La+="  #else\n",La+="  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",La+="  #endif\n\n",La+="  v_texcoord = texcoord;\n",La+="}",Lb="precision mediump float;\n",Lb+="varying vec2 v_texcoord;\n",Lb+="uniform sampler2D texture;\n\n",Lb+="#ifdef COLORMUL\n",Lb+="  uniform vec4 colorMul;\n",Lb+="#endif\n\n",Lb+="#ifdef TXTALPHA\n",Lb+="  uniform sampler2D texture1;\n",Lb+="#endif\n\n",Lb+="uniform float alpha;\n",Lb+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',Lb+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',Lb+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',Lb+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',Lb+="void main() {\n",Lb+="   vec4 color= texture2D(texture, v_texcoord);\n\n",Lb+="   #ifdef TXTCOMPRESS\n",Lb+="      color.rgb *= color.a;\n",Lb+="   #endif\n\n",Lb+="   #ifdef TXTALPHA\n",Lb+="      color.rgba *= texture2D(texture1, v_texcoord).a;\n",Lb+="   #endif\n\n",Lb+="   color.a*=alpha;\n",Lb+="   color.rgb*=alpha;\n",Lb+="   #ifdef COLORMUL\n",Lb+="      color.rgba *= colorMul;\n",Lb+="   #endif\n\n",Lb+="   gl_FragColor=color;\n",Lb+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',Lb+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',Lb+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',Lb+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',Lb+="}",LYa.preCompile2D(0,1,La,Lb,null),La="attribute vec4 position;\n",La+="uniform vec2 size;\n",La+="uniform mat4 mmat;\n",La+="void main() {\n",La+="  vec4 pos=mmat*position;\n",La+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",La+="}",Lb="precision mediump float;\n",Lb+="uniform vec4 color;\n",Lb+="uniform float alpha;\n",Lb+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',Lb+="void main() {\n",Lb+="\t vec4 a = vec4(color.r, color.g, color.b, color.a);\n",Lb+="\t a.w = alpha;\n",Lb+="\t a.xyz *= alpha;\n",Lb+="\t gl_FragColor = a;\n",Lb+='\t #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',Lb+="}",LYa.preCompile2D(0,2,La,Lb,null),La="attribute vec4 position;\n",La+="attribute vec3 a_color;\n",La+="uniform mat4 mmat;\n",La+="uniform mat4 u_mmat2;\n",La+="uniform vec2 u_pos;\n",La+="uniform vec2 size;\n",La+="varying vec3 color;\n",La+="void main(){\n",La+="  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n",La+="  vec4 pos=mmat*u_mmat2*tPos;\n",La+="  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",La+="  color=a_color;\n",La+="}",Lb="precision mediump float;\n",Lb+="varying vec3 color;\n",Lb+="uniform float alpha;\n",Lb+="void main(){\n",Lb+="  gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n",Lb+="\t gl_FragColor.rgb*=alpha;\n",Lb+="}",LYa.preCompile2D(0,4,La,Lb,null),La="attribute vec4 position;\n",La+="attribute vec2 texcoord;\n",La+="uniform vec2 size;\n\n",La+="#ifdef WORLDMAT\n",La+="  uniform mat4 mmat;\n",La+="#endif\n",La+="varying vec2 v_texcoord;\n",La+="void main() {\n",La+="  #ifdef WORLDMAT\n",La+="    vec4 pos=mmat*position;\n",La+="    gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",La+="  #else\n",La+="    gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n",La+="  #endif\n\n",La+="  v_texcoord = texcoord;\n",La+="}",Lb="#ifdef FSHIGHPRECISION\n",Lb+="   precision highp float;\n",Lb+="#else\n",Lb+="   precision mediump float;\n",Lb+="#endif\n",Lb+="varying vec2 v_texcoord;\n",Lb+="uniform sampler2D texture;\n\n",Lb+="#ifdef TXTALPHA\n",Lb+="   uniform sampler2D texture1;\n",Lb+="#endif\n\n",Lb+="uniform float alpha;\n",Lb+="uniform vec4 u_TexRange;\n",Lb+="uniform vec2 u_offset;\n",Lb+='#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n',Lb+='#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n',Lb+='#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n',Lb+='#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\n',Lb+="void main() {\n",Lb+="   vec2 newTexCoord;\n",Lb+="   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n",Lb+="   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n",Lb+="   vec4 color= texture2D(texture, newTexCoord);\n\n",Lb+="   #ifdef TXTALPHA\n",Lb+="      color.a = texture2D(texture1, newTexCoord).a;\n",Lb+="   #endif\n\n",Lb+="   color.a*=alpha;\n",Lb+="   gl_FragColor=color;\n",Lb+='   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";\n',Lb+='   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n',Lb+='   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n',Lb+='   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n',Lb+="}",LYa.preCompile2D(0,256,La,Lb,null),La="attribute vec2 position;\n",La+="attribute vec2 texcoord;\n",La+="attribute vec4 color;\n",La+="uniform vec2 size;\n",La+="uniform float offsetX;\n",La+="uniform float offsetY;\n",La+="uniform mat4 mmat;\n",La+="uniform mat4 u_mmat2;\n",La+="varying vec2 v_texcoord;\n",La+="varying vec4 v_color;\n",La+="void main() {\n",La+="  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n",La+="  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n",La+="  v_color = color;\n",La+="  v_color.rgb *= v_color.a;\n",La+="  v_texcoord = texcoord;  \n",La+="}",Lb="precision mediump float;\n",Lb+="varying vec2 v_texcoord;\n",Lb+="varying vec4 v_color;\n",Lb+="uniform sampler2D texture;\n\n",Lb+="#ifdef TXTALPHA\n",Lb+="  uniform sampler2D texture1;\n",Lb+="#endif\n\n",Lb+="uniform float alpha;\n",Lb+="void main() {\n",Lb+="\t vec4 t_color = texture2D(texture, v_texcoord);\n\n",Lb+="  #ifdef TXTALPHA\n",Lb+="    t_color.a = texture2D(texture1, v_texcoord).a;\n",Lb+="  #endif\n\n",Lb+="\t gl_FragColor = t_color.rgba * v_color;\n",Lb+="\t gl_FragColor *= alpha;\n",Lb+="}",LYa.preCompile2D(0,512,La,Lb,null)},La}(),Lx=function(){function Lb(La,Lb,Lc){this._value=0,this._name2int=La,this._int2name=Lb,this._int2nameMap=Lc}Lm(Lb,"laya.webgl.shader.ShaderDefines");var La=Lb.prototype;return La.add=function(La){return"string"==typeof La&&(La=this._name2int[La]),this._value|=La,this._value},La.addInt=function(La){return this._value|=La,this._value},La.remove=function(La){return"string"==typeof La&&(La=this._name2int[La]),this._value&=~La,this._value},La.isDefine=function(La){return(this._value&La)===La},La.getValue=function(){return this._value},La.setValue=function(La){this._value=La},La.toNameDic=function(){var La=this._int2nameMap[this._value];return La||Lb._toText(this._value,this._int2name,this._int2nameMap)},Lb._reg=function(La,Lb,Lc,Ld){Ld[Lc[La]=Lb]=La},Lb._toText=function(La,Lb,Lc){var Ld=Lc[La];if(Ld)return Ld;for(var Le={},Lf=1,Lg=0;Lg<32&&!(La<(Lf=1<<Lg));Lg++)if(La&Lf){var Lh=Lb[Lf];Lh&&(Le[Lh]="")}return Lc[La]=Le},Lb._toInt=function(La,Lb){for(var Lc=La.split("."),Ld=0,Le=0,Lf=Lc.length;Le<Lf;Le++){var Lg=Lb[Lc[Le]];if(!Lg)throw new Error("Defines to int err:"+La+"/"+Lc[Le]);Ld|=Lg}return Ld},Lb}(),Laa=function(){function Lg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new LB}Lm(Lg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var La=Lg.prototype;return La.init=function(La,Lb,Lc){if(Lb)this._vs=Lb;else{this._vs=[];var Ld=La.width,Le=La.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Ld,0,1,0,1,1,1,1),this._vs.push(Ld,Le,1,1,1,1,1,1),this._vs.push(0,Le,0,1,1,1,1,1)}Lc?this._ps=Lc:(Lg._defaultPS||(Lg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=Lg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=La},La.init2=function(La,Lb,Lc,Ld,Le){this.transform&&(this.transform=null),Lc?this._ps=Lc:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Ld,this._uvs=Le,this.mEleNum=this._ps.length,this.mTexture=La,(Lr.isConchNode||Lr.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},La._initMyData=function(){var La=0,Lb=0,Lc=4*this._verticles.length;this._vs=Lg._tempVS;var Ld=!1;if(Lr.isConchNode||Lr.isConchApp?(this._vs.length=Lc,Ld=!0):this._vs.length<Lc&&(this._vs.length=Lc,Ld=!0),Lg._tVSLen=Lc,Ld)for(;La<Lc;)this._vs[La]=this._verticles[Lb],this._vs[La+1]=this._verticles[Lb+1],this._vs[La+2]=this._uvs[Lb],this._vs[La+3]=this._uvs[Lb+1],this._vs[La+4]=1,this._vs[La+5]=1,this._vs[La+6]=1,this._vs[La+7]=1,La+=8,Lb+=2;else for(;La<Lc;)this._vs[La]=this._verticles[Lb],this._vs[La+1]=this._verticles[Lb+1],this._vs[La+2]=this._uvs[Lb],this._vs[La+3]=this._uvs[Lb+1],La+=8,Lb+=2},La.getData2=function(La,Lb,Lc){var Ld;this.mVBBuffer=La,this.mIBBuffer=Lb,this._initMyData(),La.appendEx2(this._vs,Float32Array,Lg._tVSLen,4),this._indexStart=Lb._byteLength,(Ld=Lg._tempIB).length<this._ps.length&&(Ld.length=this._ps.length);for(var Le=0,Lf=this._ps.length;Le<Lf;Le++)Ld[Le]=this._ps[Le]+Lc;Lb.appendEx2(Ld,Uint16Array,this._ps.length,2)},La.getData=function(La,Lb,Lc){if(this.mVBBuffer=La,this.mIBBuffer=Lb,La.append(this.mVBData),this._indexStart=Lb._byteLength,this.mIBData.start!=Lc){for(var Ld=0,Le=this._ps.length;Ld<Le;Ld++)this.mIBData[Ld]=this._ps[Ld]+Lc;this.mIBData.start=Lc}Lb.append(this.mIBData)},La.render=function(La,Lb,Lc){if(Lr.isWebGL&&this.mTexture){La._renderKey=0,La._shader2D.glTexture=null,Lba.getInstance().addSkinMesh(this);var Ld=Lfa.createShape(La,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,LAa.create(512,0));this.transform||(this.transform=LB.EMPTY),this.transform.translate(Lb,Lc),LB.mul(this.transform,La._curMat,this._tempMatrix),this.transform.translate(-Lb,-Lc);var Le=Ld.shaderValue,Lf=Le.u_mmat2||Lsa.getMatrArray();Lsa.mat2MatArray(this._tempMatrix,Lf),Le.textureHost=this.mTexture,Le.offsetX=0,Le.offsetY=0,Le.u_mmat2=Lf,Le.ALPHA=La._shader2D.ALPHA,La._submits[La._submits._length++]=Ld}else Lr.isConchApp&&this.mTexture&&(this.transform||(this.transform=LB.EMPTY),La.setSkinMesh&&La.setSkinMesh(Lb,Lc,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},Lg._tempVS=[],Lg._tempIB=[],Lg._defaultPS=null,Lg._tVSLen=0,Lg}(),Lba=function(){function La(){this.ib=null,this.vb=null;Lua.mainContext;this.ib=Lwa.create(35048),this.vb=Lxa.create(8)}Lm(La,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Lb=La.prototype;return Lb.addSkinMesh=function(La){La.getData2(this.vb,this.ib,this.vb._byteLength/32)},Lb.reset=function(){this.vb.clear(),this.ib.clear()},La.getInstance=function(){return La.instance=La.instance||new La},La.instance=null,La}(),Lca=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Li&&(Li=0),this.x=La,this.y=Lb,this.width=Lc,this.height=Ld,this.edges=Le,this.color=Lf,this.borderWidth=Lg,this.borderColor=Lh}Lm(La,"laya.webgl.shapes.BasePoly");var Lb=La.prototype;return Ly.imps(Lb,{"laya.webgl.shapes.IShape":!0}),Lb.getData=function(La,Lb,Lc){},Lb.rebuild=function(La){},Lb.setMatrix=function(La){},Lb.needUpdate=function(La){return!0},Lb.sector=function(La,Lb,Lc){var Ld=this.x,Le=this.y,Lf=this.edges,Lg=(this.r1-this.r0)/Lf,Lh=this.width,Li=this.height,Lj=this.color,Lk=(Lj>>16&255)/255,Ll=(Lj>>8&255)/255,Lm=(255&Lj)/255;La.push(Ld,Le,Lk,Ll,Lm);for(var Ln=0;Ln<Lf+1;Ln++)La.push(Ld+Math.sin(Lg*Ln+this.r0)*Lh,Le+Math.cos(Lg*Ln+this.r0)*Li),La.push(Lk,Ll,Lm);for(Ln=0;Ln<Lf;Ln++)Lb.push(Lc,Lc+Ln+1,Lc+Ln+2)},Lb.createLine2=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln,Lo,Lp,Lq,Lr,Ls,Lt,Lu,Lv,Ly,Lz,LA,LB,LC=La.concat(),LD=Le,LE=this.borderColor,LF=(LE>>16&255)/255,LG=(LE>>8&255)/255,LH=(255&LE)/255,LI=LC.length/2,LJ=Ld,LK=Lc/2;Li=LC[0],Lj=LC[1],Lp=Li-(Lk=LC[2]),Lo=(Lo=-(Lj-(Ll=LC[3])))/(LB=Math.sqrt(Lo*Lo+Lp*Lp))*LK,Lp=Lp/LB*LK,LD.push(Li-Lo+this.x,Lj-Lp+this.y,LF,LG,LH,Li+Lo+this.x,Lj+Lp+this.y,LF,LG,LH);for(var LL=1;LL<LI-1;LL++)Li=LC[2*(LL-1)],Lj=LC[2*(LL-1)+1],Lk=LC[2*LL],Ll=LC[2*LL+1],Lm=LC[2*(LL+1)],Ln=LC[2*(LL+1)+1],Lp=Li-Lk,Lr=Lk-Lm,Lu=(-(Lo=(Lo=-(Lj-Ll))/(LB=Math.sqrt(Lo*Lo+Lp*Lp))*LK)+Li)*(-(Lp=Lp/LB*LK)+Ll)-(-Lo+Lk)*(-Lp+Lj),Lz=(-(Lq=(Lq=-(Ll-Ln))/(LB=Math.sqrt(Lq*Lq+Lr*Lr))*LK)+Lm)*(-(Lr=Lr/LB*LK)+Ll)-(-Lq+Lk)*(-Lr+Ln),LA=(Ls=-Lp+Lj-(-Lp+Ll))*(Ly=-Lq+Lk-(-Lq+Lm))-(Lv=-Lr+Ln-(-Lr+Ll))*(Lt=-Lo+Lk-(-Lo+Li)),Math.abs(LA)<.1?(LA+=10.1,LD.push(Lk-Lo+this.x,Ll-Lp+this.y,LF,LG,LH,Lk+Lo+this.x,Ll+Lp+this.y,LF,LG,LH)):(((Lg=(Lt*Lz-Ly*Lu)/LA)-Lk)*(Lg-Lk)+((Lh=(Lv*Lu-Ls*Lz)/LA)-Ll)+(Lh-Ll),LD.push(Lg+this.x,Lh+this.y,LF,LG,LH,Lk-(Lg-Lk)+this.x,Ll-(Lh-Ll)+this.y,LF,LG,LH));Li=LC[LC.length-4],Lj=LC[LC.length-3],Lp=Li-(Lk=LC[LC.length-2]),Lo=(Lo=-(Lj-(Ll=LC[LC.length-1])))/(LB=Math.sqrt(Lo*Lo+Lp*Lp))*LK,Lp=Lp/LB*LK,LD.push(Lk-Lo+this.x,Ll-Lp+this.y,LF,LG,LH,Lk+Lo+this.x,Ll+Lp+this.y,LF,LG,LH);var LM=Lf;for(LL=1;LL<LM;LL++)Lb.push(LJ+2*(LL-1),LJ+2*(LL-1)+1,LJ+2*LL+1,LJ+2*LL+1,LJ+2*LL,LJ+2*(LL-1));return LD},Lb.createLine=function(La,Lb,Lc,Ld){var Le=La.concat(),Lf=La,Lg=this.borderColor,Lh=(Lg>>16&255)/255,Li=(Lg>>8&255)/255,Lj=(255&Lg)/255;Le.splice(0,5);var Lk,Ll,Lm,Ln,Lo,Lp,Lq,Lr,Ls,Lt,Lu,Lv,Ly,Lz,LA,LB,LC,LD,LE,LF,LG=Le.length/5,LH=Ld,LI=Lc/2;Lm=Le[0],Ln=Le[1],Lt=Lm-(Lo=Le[5]),Ls=(Ls=-(Ln-(Lp=Le[6])))/(LF=Math.sqrt(Ls*Ls+Lt*Lt))*LI,Lt=Lt/LF*LI,Lf.push(Lm-Ls,Ln-Lt,Lh,Li,Lj,Lm+Ls,Ln+Lt,Lh,Li,Lj);for(var LJ=1;LJ<LG-1;LJ++)Lm=Le[5*(LJ-1)],Ln=Le[5*(LJ-1)+1],Lo=Le[5*LJ],Lp=Le[5*LJ+1],Lq=Le[5*(LJ+1)],Lr=Le[5*(LJ+1)+1],Lt=Lm-Lo,Lv=Lo-Lq,LA=(-(Ls=(Ls=-(Ln-Lp))/(LF=Math.sqrt(Ls*Ls+Lt*Lt))*LI)+Lm)*(-(Lt=Lt/LF*LI)+Lp)-(-Ls+Lo)*(-Lt+Ln),LD=(-(Lu=(Lu=-(Lp-Lr))/(LF=Math.sqrt(Lu*Lu+Lv*Lv))*LI)+Lq)*(-(Lv=Lv/LF*LI)+Lp)-(-Lu+Lo)*(-Lv+Lr),LE=(Ly=-Lt+Ln-(-Lt+Lp))*(LC=-Lu+Lo-(-Lu+Lq))-(LB=-Lv+Lr-(-Lv+Lp))*(Lz=-Ls+Lo-(-Ls+Lm)),Math.abs(LE)<.1?(LE+=10.1,Lf.push(Lo-Ls,Lp-Lt,Lh,Li,Lj,Lo+Ls,Lp+Lt,Lh,Li,Lj)):(((Lk=(Lz*LD-LC*LA)/LE)-Lo)*(Lk-Lo)+((Ll=(LB*LA-Ly*LD)/LE)-Lp)+(Ll-Lp),Lf.push(Lk,Ll,Lh,Li,Lj,Lo-(Lk-Lo),Lp-(Ll-Lp),Lh,Li,Lj));Lm=Le[Le.length-10],Ln=Le[Le.length-9],Lt=Lm-(Lo=Le[Le.length-5]),Ls=(Ls=-(Ln-(Lp=Le[Le.length-4])))/(LF=Math.sqrt(Ls*Ls+Lt*Lt))*LI,Lt=Lt/LF*LI,Lf.push(Lo-Ls,Lp-Lt,Lh,Li,Lj,Lo+Ls,Lp+Lt,Lh,Li,Lj);var LK=this.edges+1;for(LJ=1;LJ<LK;LJ++)Lb.push(LH+2*(LJ-1),LH+2*(LJ-1)+1,LH+2*LJ+1,LH+2*LJ+1,LH+2*LJ,LH+2*(LJ-1));return Lf},Lb.createLoopLine=function(La,Lb,Lc,Ld,Le,Lf){var Lg=La.concat(),Lh=Le||La,Li=this.borderColor,Lj=(Li>>16&255)/255,Lk=(Li>>8&255)/255,Ll=(255&Li)/255;Lg.splice(0,5);var Lm=[Lg[0],Lg[1]],Ln=[Lg[Lg.length-5],Lg[Lg.length-4]],Lo=Ln[0]+.5*(Lm[0]-Ln[0]),Lp=Ln[1]+.5*(Lm[1]-Ln[1]);Lg.unshift(Lo,Lp,0,0,0),Lg.push(Lo,Lp,0,0,0);var Lq,Lr,Ls,Lt,Lu,Lv,Ly,Lz,LA,LB,LC,LD,LE,LF,LG,LH,LI,LJ,LK,LL,LM=Lg.length/5,LN=Ld,LO=Lc/2;Ls=Lg[0],Lt=Lg[1],LB=Ls-(Lu=Lg[5]),LA=(LA=-(Lt-(Lv=Lg[6])))/(LL=Math.sqrt(LA*LA+LB*LB))*LO,LB=LB/LL*LO,Lh.push(Ls-LA,Lt-LB,Lj,Lk,Ll,Ls+LA,Lt+LB,Lj,Lk,Ll);for(var LP=1;LP<LM-1;LP++)Ls=Lg[5*(LP-1)],Lt=Lg[5*(LP-1)+1],Lu=Lg[5*LP],Lv=Lg[5*LP+1],Ly=Lg[5*(LP+1)],Lz=Lg[5*(LP+1)+1],LB=Ls-Lu,LD=Lu-Ly,LG=(-(LA=(LA=-(Lt-Lv))/(LL=Math.sqrt(LA*LA+LB*LB))*LO)+Ls)*(-(LB=LB/LL*LO)+Lv)-(-LA+Lu)*(-LB+Lt),LJ=(-(LC=(LC=-(Lv-Lz))/(LL=Math.sqrt(LC*LC+LD*LD))*LO)+Ly)*(-(LD=LD/LL*LO)+Lv)-(-LC+Lu)*(-LD+Lz),LK=(LE=-LB+Lt-(-LB+Lv))*(LI=-LC+Lu-(-LC+Ly))-(LH=-LD+Lz-(-LD+Lv))*(LF=-LA+Lu-(-LA+Ls)),Math.abs(LK)<.1?(LK+=10.1,Lh.push(Lu-LA,Lv-LB,Lj,Lk,Ll,Lu+LA,Lv+LB,Lj,Lk,Ll)):(((Lq=(LF*LJ-LI*LG)/LK)-Lu)*(Lq-Lu)+((Lr=(LH*LG-LE*LJ)/LK)-Lv)+(Lr-Lv),Lh.push(Lq,Lr,Lj,Lk,Ll,Lu-(Lq-Lu),Lv-(Lr-Lv),Lj,Lk,Ll));Lf&&(Lb=Lf);var LQ=this.edges+1;for(LP=1;LP<LQ;LP++)Lb.push(LN+2*(LP-1),LN+2*(LP-1)+1,LN+2*LP+1,LN+2*LP+1,LN+2*LP,LN+2*(LP-1));return Lb.push(LN+2*(LP-1),LN+2*(LP-1)+1,LN+1,LN+1,LN,LN+2*(LP-1)),Lh},La}(),Lda=function(){function Lp(){}return Lm(Lp,"laya.webgl.shapes.Earcut"),Lp.earcut=function(La,Lb,Lc){Lc=Lc||2;var Ld,Le,Lf,Lg,Lh,Li,Lj,Lk=Lb&&Lb.length,Ll=Lk?Lb[0]*Lc:La.length,Lm=Lp.linkedList(La,0,Ll,Lc,!0),Ln=[];if(!Lm)return Ln;if(Lk&&(Lm=Lp.eliminateHoles(La,Lb,Lm,Lc)),La.length>80*Lc){Ld=Lf=La[0],Le=Lg=La[1];for(var Lo=Lc;Lo<Ll;Lo+=Lc)(Lh=La[Lo])<Ld&&(Ld=Lh),(Li=La[Lo+1])<Le&&(Le=Li),Lf<Lh&&(Lf=Lh),Lg<Li&&(Lg=Li);Lj=0!==(Lj=Math.max(Lf-Ld,Lg-Le))?1/Lj:0}return Lp.earcutLinked(Lm,Ln,Lc,Ld,Le,Lj),Ln},Lp.linkedList=function(La,Lb,Lc,Ld,Le){var Lf,Lg;if(Le===0<Lp.signedArea(La,Lb,Lc,Ld))for(Lf=Lb;Lf<Lc;Lf+=Ld)Lg=Lp.insertNode(Lf,La[Lf],La[Lf+1],Lg);else for(Lf=Lc-Ld;Lb<=Lf;Lf-=Ld)Lg=Lp.insertNode(Lf,La[Lf],La[Lf+1],Lg);return Lg&&Lp.equals(Lg,Lg.next)&&(Lp.removeNode(Lg),Lg=Lg.next),Lg},Lp.filterPoints=function(La,Lb){if(!La)return La;Lb||(Lb=La);var Lc,Ld=La;do{if(Lc=!1,Ld.steiner||!Lp.equals(Ld,Ld.next)&&0!==Lp.area(Ld.prev,Ld,Ld.next))Ld=Ld.next;else{if(Lp.removeNode(Ld),(Ld=Lb=Ld.prev)===Ld.next)break;Lc=!0}}while(Lc||Ld!==Lb);return Lb},Lp.earcutLinked=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(La){!Lg&&Lf&&Lp.indexCurve(La,Ld,Le,Lf);for(var Lh,Li,Lj=La;La.prev!==La.next;)if(Lh=La.prev,Li=La.next,Lf?Lp.isEarHashed(La,Ld,Le,Lf):Lp.isEar(La))Lb.push(Lh.i/Lc),Lb.push(La.i/Lc),Lb.push(Li.i/Lc),Lp.removeNode(La),La=Li.next,Lj=Li.next;else if((La=Li)===Lj){Lg?1===Lg?(La=Lp.cureLocalIntersections(La,Lb,Lc),Lp.earcutLinked(La,Lb,Lc,Ld,Le,Lf,2)):2===Lg&&Lp.splitEarcut(La,Lb,Lc,Ld,Le,Lf):Lp.earcutLinked(Lp.filterPoints(La,null),Lb,Lc,Ld,Le,Lf,1);break}}},Lp.isEar=function(La){var Lb=La.prev,Lc=La,Ld=La.next;if(0<=Lp.area(Lb,Lc,Ld))return!1;for(var Le=La.next.next;Le!==La.prev;){if(Lp.pointInTriangle(Lb.x,Lb.y,Lc.x,Lc.y,Ld.x,Ld.y,Le.x,Le.y)&&0<=Lp.area(Le.prev,Le,Le.next))return!1;Le=Le.next}return!0},Lp.isEarHashed=function(La,Lb,Lc,Ld){var Le=La.prev,Lf=La,Lg=La.next;if(0<=Lp.area(Le,Lf,Lg))return!1;for(var Lh=Le.x<Lf.x?Le.x<Lg.x?Le.x:Lg.x:Lf.x<Lg.x?Lf.x:Lg.x,Li=Le.y<Lf.y?Le.y<Lg.y?Le.y:Lg.y:Lf.y<Lg.y?Lf.y:Lg.y,Lj=Le.x>Lf.x?Le.x>Lg.x?Le.x:Lg.x:Lf.x>Lg.x?Lf.x:Lg.x,Lk=Le.y>Lf.y?Le.y>Lg.y?Le.y:Lg.y:Lf.y>Lg.y?Lf.y:Lg.y,Ll=Lp.zOrder(Lh,Li,Lb,Lc,Ld),Lm=Lp.zOrder(Lj,Lk,Lb,Lc,Ld),Ln=La.nextZ;Ln&&Ln.z<=Lm;){if(Ln!==La.prev&&Ln!==La.next&&Lp.pointInTriangle(Le.x,Le.y,Lf.x,Lf.y,Lg.x,Lg.y,Ln.x,Ln.y)&&0<=Lp.area(Ln.prev,Ln,Ln.next))return!1;Ln=Ln.nextZ}for(Ln=La.prevZ;Ln&&Ln.z>=Ll;){if(Ln!==La.prev&&Ln!==La.next&&Lp.pointInTriangle(Le.x,Le.y,Lf.x,Lf.y,Lg.x,Lg.y,Ln.x,Ln.y)&&0<=Lp.area(Ln.prev,Ln,Ln.next))return!1;Ln=Ln.prevZ}return!0},Lp.cureLocalIntersections=function(La,Lb,Lc){var Ld=La;do{var Le=Ld.prev,Lf=Ld.next.next;!Lp.equals(Le,Lf)&&Lp.intersects(Le,Ld,Ld.next,Lf)&&Lp.locallyInside(Le,Lf)&&Lp.locallyInside(Lf,Le)&&(Lb.push(Le.i/Lc),Lb.push(Ld.i/Lc),Lb.push(Lf.i/Lc),Lp.removeNode(Ld),Lp.removeNode(Ld.next),Ld=La=Lf),Ld=Ld.next}while(Ld!==La);return Ld},Lp.splitEarcut=function(La,Lb,Lc,Ld,Le,Lf){var Lg=La;do{for(var Lh=Lg.next.next;Lh!==Lg.prev;){if(Lg.i!==Lh.i&&Lp.isValidDiagonal(Lg,Lh)){var Li=Lp.splitPolygon(Lg,Lh);return Lg=Lp.filterPoints(Lg,Lg.next),Li=Lp.filterPoints(Li,Li.next),Lp.earcutLinked(Lg,Lb,Lc,Ld,Le,Lf),void Lp.earcutLinked(Li,Lb,Lc,Ld,Le,Lf)}Lh=Lh.next}Lg=Lg.next}while(Lg!==La)},Lp.eliminateHoles=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj=[];for(Le=0,Lf=Lb.length;Le<Lf;Le++)Lg=Lb[Le]*Ld,Lh=Le<Lf-1?Lb[Le+1]*Ld:La.length,(Li=Lp.linkedList(La,Lg,Lh,Ld,!1))===Li.next&&(Li.steiner=!0),Lj.push(Lp.getLeftmost(Li));for(Lj.sort(Lp.compareX),Le=0;Le<Lj.length;Le++)Lp.eliminateHole(Lj[Le],Lc),Lc=Lp.filterPoints(Lc,Lc.next);return Lc},Lp.compareX=function(La,Lb){return La.x-Lb.x},Lp.eliminateHole=function(La,Lb){if(Lb=Lp.findHoleBridge(La,Lb)){var Lc=Lp.splitPolygon(Lb,La);Lp.filterPoints(Lc,Lc.next)}},Lp.findHoleBridge=function(La,Lb){var Lc,Ld=Lb,Le=La.x,Lf=La.y,Lg=-1/0;do{if(Lf<=Ld.y&&Lf>=Ld.next.y&&Ld.next.y!==Ld.y){var Lh=Ld.x+(Lf-Ld.y)*(Ld.next.x-Ld.x)/(Ld.next.y-Ld.y);if(Lh<=Le&&Lg<Lh){if((Lg=Lh)===Le){if(Lf===Ld.y)return Ld;if(Lf===Ld.next.y)return Ld.next}Lc=Ld.x<Ld.next.x?Ld:Ld.next}}Ld=Ld.next}while(Ld!==Lb);if(!Lc)return null;if(Le===Lg)return Lc.prev;var Li,Lj=Lc,Lk=Lc.x,Ll=Lc.y,Lm=1/0;for(Ld=Lc.next;Ld!==Lj;)Le>=Ld.x&&Ld.x>=Lk&&Le!==Ld.x&&Lp.pointInTriangle(Lf<Ll?Le:Lg,Lf,Lk,Ll,Lf<Ll?Lg:Le,Lf,Ld.x,Ld.y)&&((Li=Math.abs(Lf-Ld.y)/(Le-Ld.x))<Lm||Li===Lm&&Ld.x>Lc.x)&&Lp.locallyInside(Ld,La)&&(Lc=Ld,Lm=Li),Ld=Ld.next;return Lc},Lp.indexCurve=function(La,Lb,Lc,Ld){for(var Le=La;null===Le.z&&(Le.z=Lp.zOrder(Le.x,Le.y,Lb,Lc,Ld)),Le.prevZ=Le.prev,Le.nextZ=Le.next,(Le=Le.next)!==La;);Le.prevZ.nextZ=null,Le.prevZ=null,Lp.sortLinked(Le)},Lp.sortLinked=function(La){var Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj=1;do{for(Lc=La,Lf=La=null,Lg=0;Lc;){for(Lg++,Ld=Lc,Lb=Lh=0;Lb<Lj&&(Lh++,Ld=Ld.nextZ);Lb++);for(Li=Lj;0<Lh||0<Li&&Ld;)0!==Lh&&(0===Li||!Ld||Lc.z<=Ld.z)?(Lc=(Le=Lc).nextZ,Lh--):(Ld=(Le=Ld).nextZ,Li--),Lf?Lf.nextZ=Le:La=Le,Le.prevZ=Lf,Lf=Le;Lc=Ld}Lf.nextZ=null,Lj*=2}while(1<Lg);return La},Lp.zOrder=function(La,Lb,Lc,Ld,Le){return(La=1431655765&((La=858993459&((La=252645135&((La=16711935&((La=32767*(La-Lc)*Le)|La<<8))|La<<4))|La<<2))|La<<1))|(Lb=1431655765&((Lb=858993459&((Lb=252645135&((Lb=16711935&((Lb=32767*(Lb-Ld)*Le)|Lb<<8))|Lb<<4))|Lb<<2))|Lb<<1))<<1},Lp.getLeftmost=function(La){for(var Lb=La,Lc=La;Lb.x<Lc.x&&(Lc=Lb),(Lb=Lb.next)!==La;);return Lc},Lp.pointInTriangle=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){return 0<=(Le-Lg)*(Lb-Lh)-(La-Lg)*(Lf-Lh)&&0<=(La-Lg)*(Ld-Lh)-(Lc-Lg)*(Lb-Lh)&&0<=(Lc-Lg)*(Lf-Lh)-(Le-Lg)*(Ld-Lh)},Lp.isValidDiagonal=function(La,Lb){return La.next.i!==Lb.i&&La.prev.i!==Lb.i&&!Lp.intersectsPolygon(La,Lb)&&Lp.locallyInside(La,Lb)&&Lp.locallyInside(Lb,La)&&Lp.middleInside(La,Lb)},Lp.area=function(La,Lb,Lc){return(Lb.y-La.y)*(Lc.x-Lb.x)-(Lb.x-La.x)*(Lc.y-Lb.y)},Lp.equals=function(La,Lb){return La.x===Lb.x&&La.y===Lb.y},Lp.intersects=function(La,Lb,Lc,Ld){return!!(Lp.equals(La,Lb)&&Lp.equals(Lc,Ld)||Lp.equals(La,Ld)&&Lp.equals(Lc,Lb))||0<Lp.area(La,Lb,Lc)!=0<Lp.area(La,Lb,Ld)&&0<Lp.area(Lc,Ld,La)!=0<Lp.area(Lc,Ld,Lb)},Lp.intersectsPolygon=function(La,Lb){var Lc=La;do{if(Lc.i!==La.i&&Lc.next.i!==La.i&&Lc.i!==Lb.i&&Lc.next.i!==Lb.i&&Lp.intersects(Lc,Lc.next,La,Lb))return!0;Lc=Lc.next}while(Lc!==La);return!1},Lp.locallyInside=function(La,Lb){return Lp.area(La.prev,La,La.next)<0?0<=Lp.area(La,Lb,La.next)&&0<=Lp.area(La,La.prev,Lb):Lp.area(La,Lb,La.prev)<0||Lp.area(La,La.next,Lb)<0},Lp.middleInside=function(La,Lb){for(var Lc=La,Ld=!1,Le=(La.x+Lb.x)/2,Lf=(La.y+Lb.y)/2;Lc.y>Lf!=Lc.next.y>Lf&&Lc.next.y!==Lc.y&&Le<(Lc.next.x-Lc.x)*(Lf-Lc.y)/(Lc.next.y-Lc.y)+Lc.x&&(Ld=!Ld),(Lc=Lc.next)!==La;);return Ld},Lp.splitPolygon=function(La,Lb){var Lc=new Lea(La.i,La.x,La.y),Ld=new Lea(Lb.i,Lb.x,Lb.y),Le=La.next,Lf=Lb.prev;return(La.next=Lb).prev=La,(Lc.next=Le).prev=Lc,(Ld.next=Lc).prev=Ld,(Lf.next=Ld).prev=Lf,Ld},Lp.insertNode=function(La,Lb,Lc,Ld){var Le=new Lea(La,Lb,Lc);return Ld?(Le.next=Ld.next,(Le.prev=Ld).next.prev=Le,Ld.next=Le):(Le.prev=Le).next=Le,Le},Lp.removeNode=function(La){La.next.prev=La.prev,La.prev.next=La.next,La.prevZ&&(La.prevZ.nextZ=La.nextZ),La.nextZ&&(La.nextZ.prevZ=La.prevZ)},Lp.signedArea=function(La,Lb,Lc,Ld){for(var Le=0,Lf=Lb,Lg=Lc-Ld;Lf<Lc;Lf+=Ld)Le+=(La[Lg]-La[Lf])*(La[Lf+1]+La[Lg+1]),Lg=Lf;return Le},Lp}(),Lea=function(){function La(La,Lb,Lc){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=La,this.x=Lb,this.y=Lc,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Lm(La,"laya.webgl.shapes.EarcutNode"),La}(),Lfa=(function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg){this.lineWidth=La,this.lineColor=Lb,this.lineAlpha=Lc,this.fillColor=Ld,this.fillAlpha=Le,this.shape=Lg,this.fill=Lf}Lm(La,"laya.webgl.shapes.GeometryData");var Lb=La.prototype;Lb.clone=function(){return new La(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Lb.getIndexData=function(){return null},Lb.getVertexData=function(){return null},Lb.destroy=function(){this.shape=null}}(),function(){function La(La){if(La instanceof Float32Array)this.points=La;else if(La instanceof Array){La.length;this.points=new Float32Array(La)}}Lm(La,"laya.webgl.shapes.Vertex");var Lb=La.prototype;Ly.imps(Lb,{"laya.webgl.shapes.IShape":!0}),Lb.getData=function(La,Lb,Lc){},Lb.needUpdate=function(La){return!1},Lb.rebuild=function(La){},Lb.setMatrix=function(La){}}(),function(){function Li(La){void 0===La&&(La=1e4),this._renderType=La}Lm(Li,"laya.webgl.submit.Submit");var La=Li.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La.releaseRender=function(){var La=Li._cache;(La[La._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},La.getRenderType=function(){return this._renderType},La.renderSubmit=function(){if(0===this._numEle)return 1;var La=this.shaderValue.textureHost;if(La){var Lb=La.source;if(!La.bitmap||!Lb)return 1;this.shaderValue.texture=Lb,La.alphaTexture&&La.alphaTexture.source&&(this.shaderValue.texture1=La.alphaTexture.source)}this._vb.bind_upload(this._ib);var Lc=Lua.mainContext;return this.shaderValue.upload(),LS.activeBlendFunction!==this._blendFn&&(Lc.enable(3042),this._blendFn(Lc),LS.activeBlendFunction=this._blendFn),LG.drawCall++,LG.trianglesFaces+=this._numEle/3,Lc.drawElements(4,this._numEle,5123,this._startIdx),1},Li.__init__=function(){var La=Li.RENDERBASE=new Li(-1);La.shaderValue=new LAa(0,0),La.shaderValue.ALPHA=-1234},Li.createSubmit=function(La,Lb,Lc,Ld,Le){var Lf=Li._cache._length?Li._cache[--Li._cache._length]:new Li;null==Lc&&((Lc=Lf._selfVb||(Lf._selfVb=Lxa.create(-1))).clear(),Ld=0),Lf._ib=Lb,Lf._vb=Lc,Lf._startIdx=Ld*Lpa.BYTES_PIDX,Lf._numEle=0;var Lg=La._nBlendType;Lf._blendFn=La._targets?LS.targetFns[Lg]:LS.fns[Lg],Lf.shaderValue=Le,Lf.shaderValue.setValue(La._shader2D);var Lh=La._shader2D.filters;return Lh&&Lf.shaderValue.setFilters(Lh),Lf},Li.createShape=function(La,Lb,Lc,Ld,Le,Lf){var Lg=Li._cache._length?Li._cache[--Li._cache._length]:new Li;Lg._ib=Lb,Lg._vb=Lc,Lg._numEle=Ld,Lg._startIdx=Le,Lg.shaderValue=Lf,Lg.shaderValue.setValue(La._shader2D);var Lh=La._nBlendType;return Lg._blendFn=La._targets?LS.targetFns[Lh]:LS.fns[Lh],Lg},Li.TYPE_2D=1e4,Li.TYPE_CANVAS=10003,Li.TYPE_CMDSETRT=10004,Li.TYPE_CUSTOM=10005,Li.TYPE_BLURRT=10006,Li.TYPE_CMDDESTORYPRERT=10007,Li.TYPE_DISABLESTENCIL=10008,Li.TYPE_OTHERIBVB=10009,Li.TYPE_PRIMITIVE=10010,Li.TYPE_RT=10011,Li.TYPE_BLUR_RT=10012,Li.TYPE_TARGET=10013,Li.TYPE_CHANGE_VALUE=10014,Li.TYPE_SHAPE=10015,Li.TYPE_TEXTURE=10016,Li.TYPE_FILLTEXTURE=10017,Li.RENDERBASE=null,Li._cache=((Li._cache=[])._length=0,Li._cache),Li}()),Lga=function(){function Ld(){this.fun=null,this.args=null}Lm(Ld,"laya.webgl.submit.SubmitCMD");var La=Ld.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La.renderSubmit=function(){return this.fun.apply(null,this.args),1},La.getRenderType=function(){return 0},La.releaseRender=function(){var La=Ld._cache;La[La._length++]=this},Ld.create=function(La,Lb){var Lc=Ld._cache._length?Ld._cache[--Ld._cache._length]:new Ld;return Lc.fun=Lb,Lc.args=La,Lc},Ld._cache=((Ld._cache=[])._length=0,Ld._cache),Ld}(),Lha=function(){function Lb(){this.variables={}}Lm(Lb,"laya.webgl.submit.SubmitCMDScope");var La=Lb.prototype;return La.getValue=function(La){return this.variables[La]},La.addValue=function(La,Lb){return this.variables[La]=Lb},La.setValue=function(La,Lb){return this.variables.hasOwnProperty(La)?this.variables[La]=Lb:null},La.clear=function(){for(var La in this.variables)delete this.variables[La]},La.recycle=function(){this.clear(),Lb.POOL.push(this)},Lb.create=function(){var La=Lb.POOL.pop();return La||(La=new Lb),La},Lb.POOL=[],Lb}(),Lia=function(){function Ll(){this.offset=0,this.startIndex=0,this._mat=LB.create()}Lm(Ll,"laya.webgl.submit.SubmitOtherIBVB");var La=Ll.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La.releaseRender=function(){var La=Ll._cache;(La[La._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},La.getRenderType=function(){return 10009},La.renderSubmit=function(){var La=this._shaderValue.textureHost;if(La){var Lb=La.source;if(!La.bitmap||!Lb)return 1;this._shaderValue.texture=Lb}this._vb.bind_upload(this._ib);var Lc=Lsa.worldMatrix4,Ld=LB.TEMP;LB.mulPre(this._mat,Lc[0],Lc[1],Lc[4],Lc[5],Lc[12],Lc[13],Ld);var Le=Lsa.worldMatrix4=Ll.tempMatrix4;Le[0]=Ld.a,Le[1]=Ld.b,Le[4]=Ld.c,Le[5]=Ld.d,Le[12]=Ld.tx,Le[13]=Ld.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Lf=Lua.mainContext;return LS.activeBlendFunction!==this._blendFn&&(Lf.enable(3042),this._blendFn(Lf),LS.activeBlendFunction=this._blendFn),LG.drawCall++,LG.trianglesFaces+=this._numEle/3,Lf.drawElements(4,this._numEle,5123,this.startIndex),Lsa.worldMatrix4=Lc,LLa.activeShader=null,1},Ll.create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){void 0===Li&&(Li=0);var Lj=Ll._cache._length?Ll._cache[--Ll._cache._length]:new Ll;Lj._ib=Lc,Lj._vb=Lb,Lj._numEle=Ld,Lj._shader=Le,Lj._shaderValue=Lf;var Lk=La._nBlendType;switch(Lj._blendFn=La._targets?LS.targetFns[Lk]:LS.fns[Lk],Li){case 0:Lj.offset=0,Lj.startIndex=Lh/(Lpa.BYTES_PE*Lb.vertexStride)*1.5,Lj.startIndex*=Lpa.BYTES_PIDX;break;case 1:Lj.startIndex=Lg,Lj.offset=Lh}return Lj},Ll._cache=((Ll._cache=[])._length=0,Ll._cache),Ll.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ll}(),Lja=function(){function Lc(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new LD,this.screenRect=new LD}Lm(Lc,"laya.webgl.submit.SubmitScissor");var La=Lc.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La._scissor=function(La,Lb,Lc,Ld){var Le=Lsa.worldMatrix4,Lf=Le[0],Lg=Le[5],Lh=Le[12],Li=Le[13];if(Ld*=Lg,(Lc*=Lf)<1||Ld<1)return!1;var Lj=(La=La*Lf+Lh)+Lc,Lk=(Lb=Lb*Lg+Li)+Ld;La<0&&(Lc=Lj-(La=0)),Lb<0&&(Ld=Lk-(Lb=0));var Ll=Lsa.worldClipRect;if(La=Math.max(La,Ll.x),Lb=Math.max(Lb,Ll.y),Lc=Math.min(Lj,Ll.right)-La,Ld=Math.min(Lk,Ll.bottom)-Lb,Lc<1||Ld<1)return!1;var Lm=Lsa.worldScissorTest;return this.screenRect.copyFrom(Ll),Ll.x=La,Ll.y=Lb,Ll.width=Lc,Ll.height=Ld,Lsa.worldScissorTest=!0,Lb=Lsa.height-Lb-Ld,Lua.mainContext.scissor(La,Lb,Lc,Ld),Lua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Lm?(Lb=Lsa.height-this.screenRect.y-this.screenRect.height,Lua.mainContext.scissor(this.screenRect.x,Lb,this.screenRect.width,this.screenRect.height),Lua.mainContext.enable(3089)):(Lua.mainContext.disable(3089),Lsa.worldScissorTest=!1),Ll.copyFrom(this.screenRect),!0},La._scissorWithTagart=function(La,Lb,Lc,Ld){if(Lc<1||Ld<1)return!1;var Le=La+Lc,Lf=Lb+Ld;La<0&&(Lc=Le-(La=0)),Lb<0&&(Ld=Lf-(Lb=0));var Lg=Lsa.worldClipRect;if(La=Math.max(La,Lg.x),Lb=Math.max(Lb,Lg.y),Lc=Math.min(Le,Lg.right)-La,Ld=Math.min(Lf,Lg.bottom)-Lb,Lc<1||Ld<1)return!1;var Lh=Lsa.worldScissorTest;return this.screenRect.copyFrom(Lg),Lsa.worldScissorTest=!0,Lg.x=La,Lg.y=Lb,Lg.width=Lc,Lg.height=Ld,Lb=Lsa.height-Lb-Ld,Lua.mainContext.scissor(La,Lb,Lc,Ld),Lua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Lh?(Lb=Lsa.height-this.screenRect.y-this.screenRect.height,Lua.mainContext.scissor(this.screenRect.x,Lb,this.screenRect.width,this.screenRect.height),Lua.mainContext.enable(3089)):(Lua.mainContext.disable(3089),Lsa.worldScissorTest=!1),Lg.copyFrom(this.screenRect),!0},La.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},La.getRenderType=function(){return 0},La.releaseRender=function(){var La=Lc._cache;(La[La._length++]=this).context=null},Lc.create=function(La){var Lb=Lc._cache._length?Lc._cache[--Lc._cache._length]:new Lc;return Lb.context=La,Lb},Lc._cache=((Lc._cache=[])._length=0,Lc._cache),Lc}(),Lka=function(){function Li(){this.step=0,this.blendMode=null,this.level=0}Lm(Li,"laya.webgl.submit.SubmitStencil");var La=Li.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},La.getRenderType=function(){return 0},La.releaseRender=function(){var La=Li._cache;La[La._length++]=this},La.do1=function(){var La=Lua.mainContext;La.enable(2960),La.clear(1024),La.colorMask(!1,!1,!1,!1),La.stencilFunc(514,this.level,255),La.stencilOp(7680,7680,7682)},La.do2=function(){var La=Lua.mainContext;La.stencilFunc(514,this.level+1,255),La.colorMask(!0,!0,!0,!0),La.stencilOp(7680,7680,7680)},La.do3=function(){var La=Lua.mainContext;La.colorMask(!0,!0,!0,!0),La.stencilOp(7680,7680,7680),La.clear(1024),La.disable(2960)},La.do4=function(){var La=Lua.mainContext;0==this.level&&(La.enable(2960),La.clear(1024)),La.colorMask(!1,!1,!1,!1),La.stencilFunc(519,0,255),La.stencilOp(7680,7680,7682)},La.do5=function(){var La=Lua.mainContext;La.stencilFunc(514,this.level,255),La.colorMask(!0,!0,!0,!0),La.stencilOp(7680,7680,7680)},La.do6=function(){var La=Lua.mainContext;LS.targetFns[LS.TOINT[this.blendMode]](La)},La.do7=function(){var La=Lua.mainContext;La.colorMask(!1,!1,!1,!1),La.stencilOp(7680,7680,7683)},La.do8=function(){var La=Lua.mainContext;La.colorMask(!0,!0,!0,!0),La.stencilFunc(514,this.level,255),La.stencilOp(7680,7680,7680)},Li.restore=function(La,Lb,Lc,Ld,Le){var Lf;if((La._renderKey=0)<Li._mask&&Li._mask--,0==Li._mask)Lf=laya.webgl.submit.SubmitStencil.create(3),La.addRenderObject(Lf),La._curSubmit=Lfa.RENDERBASE;else{Lf=laya.webgl.submit.SubmitStencil.create(7),La.addRenderObject(Lf);var Lg=La._vb;Lg._byteLength;if(Lqa.fillRectImgVb(Lg,null,Lb.x,Lb.y,Lb.width,Lb.height,LK.DEF_UV,Lc,Ld,Le,0,0)){La._shader2D.glTexture=null;var Lh=La._curSubmit=Lfa.createSubmit(La,La._ib,Lg,(Lg._byteLength-64)/32*3,LAa.create(2,0));Lh.shaderValue.ALPHA=1,La._submits[La._submits._length++]=Lh,La._curSubmit._numEle+=6,La._curSubmit=Lfa.RENDERBASE}else alert("clipRect calc stencil rect error");Lf=laya.webgl.submit.SubmitStencil.create(8),La.addRenderObject(Lf)}},Li.restore2=function(La,Lb){var Lc;(La._renderKey=0)<Li._mask&&Li._mask--,0==Li._mask?(Lc=laya.webgl.submit.SubmitStencil.create(3),La.addRenderObject(Lc),La._curSubmit=Lfa.RENDERBASE):(Lc=laya.webgl.submit.SubmitStencil.create(7),La.addRenderObject(Lc),La._submits[La._submits._length++]=Lb,Lc=laya.webgl.submit.SubmitStencil.create(8),La.addRenderObject(Lc))},Li.create=function(La){var Lb=Li._cache._length?Li._cache[--Li._cache._length]:new Li;return 5==(Lb.step=La)&&++Li._mask,Lb.level=Li._mask,Lb},Li._cache=((Li._cache=[])._length=0,Li._cache),Li._mask=0,Li}(),Lla=function(){function Lh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Lm(Lh,"laya.webgl.submit.SubmitTarget");var La=Lh.prototype;return Ly.imps(La,{"laya.webgl.submit.ISubmit":!0}),La.renderSubmit=function(){this._vb.bind_upload(this._ib);var La=this.scope.getValue(this.proName);return La&&(this.shaderValue.texture=La.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[La.width,La.height]),this.shaderValue.upload(),this.blend(),LG.drawCall++,LG.trianglesFaces+=this._numEle/3,Lua.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},La.blend=function(){if(LS.activeBlendFunction!==LS.fns[this.blendType]){var La=Lua.mainContext;La.enable(3042),LS.fns[this.blendType](La),LS.activeBlendFunction=LS.fns[this.blendType]}},La.getRenderType=function(){return 0},La.releaseRender=function(){var La=Lh._cache;(La[La._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Lh.create=function(La,Lb,Lc,Ld,Le,Lf){var Lg=Lh._cache._length?Lh._cache[--Lh._cache._length]:new Lh;return Lg._ib=Lb,Lg._vb=Lc,Lg.proName=Lf,Lg._startIdx=Ld*Lpa.BYTES_PIDX,Lg._numEle=0,Lg.blendType=La._nBlendType,Lg.shaderValue=Le,Lg.shaderValue.setValue(La._shader2D),Lg},Lh._cache=((Lh._cache=[])._length=0,Lh._cache),Lh}(),Lma=function(){function La(){this._sourceStr=null}Lm(La,"laya.webgl.text.CharSegment");var Lb=La.prototype;return Ly.imps(Lb,{"laya.webgl.text.ICharSegment":!0}),Lb.textToSpit=function(La){this._sourceStr=La},Lb.getChar=function(La){return this._sourceStr.charAt(La)},Lb.getCharCode=function(La){return this._sourceStr.charCodeAt(La)},Lb.length=function(){return this._sourceStr.length},La}(),Lna=function(){var La;function LG(){}return Lm(LG,"laya.webgl.text.DrawText"),LG.__init__=function(){LG._charsTemp=new Array,LG._drawValue=new La,LG._charSeg=new Lma},LG.customCharSeg=function(La){LG._charSeg=La},LG.getChar=function(La,Lb,Lc){var Ld=LVa.createOneChar(La,Lc);return-1!=Lb&&(LG._charsCache[Lb]=Ld),Ld},LG._drawSlow=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln,Lo){var Lp,Lq,Lr=LG._drawValue.value(Lf,Lh,Li,Lj,Lm,Ln,Lo),Ls=0,Lt=0,Lu=LG._charsTemp,Lv=0,Ly=NaN;if(Ld)for(Lu.length=Ld.length,Ls=0,Lt=Ld.length;Ls<Lt;Ls++)(Lq=Ld[Ls])&&(Ly=Lq.charNum+Lr.txtID,Lu[Ls]=Lp=LG._charsCache[Ly]||LG.getChar(Lq.char,Ly,Lr),Lp.active());else{var Lz=Lc instanceof laya.utils.WordText?Lc.toString():Lc;if(LJ.CharacterCache){LG._charSeg.textToSpit(Lz);var LA=LG._charSeg.length();for(Ls=0,Lt=Lu.length=LA;Ls<Lt;Ls++)Ly=LG._charSeg.getCharCode(Ls)+Lr.txtID,Lu[Ls]=Lp=LG._charsCache[Ly]||LG.getChar(LG._charSeg.getChar(Ls),Ly,Lr),Lp.active(),Lv+=Lp.cw}else Lu.length=0,(Lp=LG.getChar(Lz,-1,Lr)).active(),Lv+=Lp.cw,Lu[0]=Lp}var LB=0;null!==Lg&&"left"!==Lg&&(LB=-("center"==Lg?Lv/2:Lv));var LC,LD,LE=NaN,LF=0;if(Ld)for(Ls=0,Lt=Lu.length;Ls<Lt;Ls++)Lp=Lu[Ls],Lq=Ld[Ls],Lp&&Lq&&!Lp.isSpace&&(LE=Lp.borderSize,LC=Lp.texture,Lb._drawText(LC,Lk+LB+Lq.x*Lm-LE,Ll+Lq.y*Ln-LE,LC.width,LC.height,Le,0,0,0,0));else{for(Ls=0,Lt=Lu.length;Ls<Lt;Ls++)(Lp=Lu[Ls])&&!Lp.isSpace&&(LE=Lp.borderSize,LC=Lp.texture,Lb._drawText(LC,Lk+LB-LE,Ll-LE,LC.width,LC.height,Le,0,0,0,0),La&&((LD=La[LF++])||(LD=La[LF-1]=[]),LD[0]=LC,LD[1]=LB-LE,LD[2]=-LE)),LB+=Lp.cw;La&&(La.length=LF)}},LG._drawFast=function(La,Lb,Lc,Ld,Le){for(var Lf,Lg,Lh=0,Li=La.length;Lh<Li;Lh++)(Lf=(Lg=La[Lh])[0]).active(),Lb._drawText(Lf,Ld+Lg[1],Le+Lg[2],Lf.width,Lf.height,Lc,0,0,0,0)},LG.drawText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll){if(void 0===Ll&&(Ll=0),!(Lb&&0===Lb.length||Lc&&0===Lc.length)){var Lm=Ld.a,Ln=Ld.d;(0!==Ld.b||0!==Ld.c)&&(Lm=Ln=1);var Lo=1!==Lm||1!==Ln;if(Lo&&Ly.stage.transform){var Lp=Ly.stage.transform;Lo=Lp.a===Lm&&Lp.d===Ln}else Lo=!1;if(Lo){var Lq=(Ld=Ld.copyTo(Lza._tmpMatrix)).tx,Lr=Ld.ty;Ld.scale(1/Lm,1/Ln),Ld._checkTransform(),Lj*=Lm,Lk*=Ln,Lj+=Lq-Ld.tx,Lk+=Lr-Ld.ty}else Lm=Ln=1;if(Lc)LG._drawSlow(null,La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Lm,Ln,Ll);else{if(null===Lb.toUpperCase){var Ls=Lm+1e5*Ln,Lt=Lb;return void(Lt.changed||Lt.id!==Ls?(Lt.id=Ls,Lt.changed=!1,LG._drawSlow(Lt.save,La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Lm,Ln,Ll)):LG._drawFast(Lt.save,La,Ld,Lj,Lk))}var Lu=Lb+Le.toString()+Lg+Lh+Li+Lm+Ln+Lf,Lv=LG._textsCache[Lu];LJ.CharacterCache?Lv?LG._drawFast(Lv,La,Ld,Lj,Lk):(LG._textsCache.__length||(LG._textsCache.__length=0),LG._textsCache.__length>Lz.WebGLTextCacheCount&&((LG._textsCache={}).__length=0,LG._curPoolIndex=0),LG._textCachesPool[LG._curPoolIndex]?(Lv=LG._textsCache[Lu]=LG._textCachesPool[LG._curPoolIndex]).length=0:LG._textCachesPool[LG._curPoolIndex]=Lv=LG._textsCache[Lu]=[],LG._textsCache.__length++,LG._curPoolIndex++,LG._drawSlow(Lv,La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Lm,Ln,Ll)):LG._drawSlow(Lv,La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Lm,Ln,Ll)}}},LG._charsTemp=null,LG._textCachesPool=[],LG._curPoolIndex=0,LG._charsCache={},LG._textsCache={},LG._drawValue=null,LG.d=[],LG._charSeg=null,LG.__init$=function(){La=function(){function Li(){}return Lm(Li,""),Li.prototype.value=function(La,Lb,Lc,Ld,Le,Lf,Lg){this.font=La,this.fillColor=Lb,this.borderColor=Lc,this.lineWidth=Ld,this.scaleX=Le,this.scaleY=Lf,this.underLine=Lg;var Lh=La.toString()+Le+Lf+Ld+(Lb?Lb.toLowerCase():" ")+(Lc?Lc.toLowerCase():" ")+Lg;return this.txtID=Li._keymap[Lh],this.txtID||(this.txtID=1e-7*++Li._keymapCount,Li._keymap[Lh]=this.txtID),this},Li.clear=function(){Li._keymap={},Li._keymapCount=1},Li._keymap={},Li._keymapCount=1,Li}()},LG}(),Loa=function(){function Le(La){this._index=0,this._size=14,this._italic=-2,Le._cache2=Le._cache2||[],this.setFont(La||"14px Arial")}Lm(Le,"laya.webgl.text.FontInContext");var La=Le.prototype;return La.setFont=function(La){var Lb=Le._cache2[La];if(Lb)this._words=Lb[0],this._size=Lb[1];else{this._words=La.split(" ");for(var Lc=0,Ld=this._words.length;Lc<Ld;Lc++)if(0<this._words[Lc].indexOf("px")){this._index=Lc;break}this._size=parseInt(this._words[this._index]),Le._cache2[La]=[this._words,this._size]}this._text=null,this._italic=-2},La.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},La.hasType=function(La){for(var Lb=0,Lc=this._words.length;Lb<Lc;Lb++)if(this._words[Lb]===La)return Lb;return-1},La.removeType=function(La){for(var Lb=0,Lc=this._words.length;Lb<Lc;Lb++)if(this._words[Lb]===La){this._words.splice(Lb,1),this._index>Lb&&this._index--;break}this._text=null,this._italic=-2},La.copyTo=function(La){return La._text=this._text,La._size=this._size,La._index=this._index,La._words=this._words.slice(),La._italic=-2,La},La.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Ld(0,La,"size",function(){return this._size},function(La){this._size=La,this._words[this._index]=La+"px",this._text=null}),Le.create=function(La){var Lb=Le._cache[La];return Lb||(Lb=Le._cache[La]=new Le(La))},Le.EMPTY=new Le,Le._cache={},Le._cache2=null,Le}(),Lpa=function(){function La(){}return Lm(La,"laya.webgl.utils.CONST3D2D"),La.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],La.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],La.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],La._TMPARRAY=[],La._OFFSETX=0,La._OFFSETY=0,Lg(La,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),La}(),Lqa=function(){function Lo(){}return Lm(Lo,"laya.webgl.utils.GlUtils"),Lo.make2DProjection=function(La,Lb,Lc){return[2/La,0,0,0,0,-2/Lb,0,0,0,0,2/Lc,0,-1,1,0,1]},Lo.fillIBQuadrangle=function(La,Lb){if(65535/4<Lb)throw Error("IBQuadrangle count:"+Lb+" must<:"+Math.floor(65535/4));Lb=Math.floor(Lb),La._resizeBuffer(6*(Lb+1)*2,!1),La.byteLength=La.bufferLength;for(var Lc=La.getUint16Array(),Ld=0,Le=0;Le<Lb;Le++)Lc[Ld++]=4*Le,Lc[Ld++]=4*Le+2,Lc[Ld++]=4*Le+1,Lc[Ld++]=4*Le,Lc[Ld++]=4*Le+3,Lc[Ld++]=4*Le+2;return La.setNeedUpload(),!0},Lo.expandIBQuadrangle=function(La,Lb){La.bufferLength>=6*Lb*2||Lo.fillIBQuadrangle(La,Lb)},Lo.mathCeilPowerOfTwo=function(La){return La--,La|=La>>1,La|=La>>2,La|=La>>4,La|=La>>8,La|=La>>16,++La},Lo.fillQuadrangleImgVb=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=16+(La._byteLength>>2);La.byteLength=Li<<2;var Lj=La.getFloat32Array();Lj[(Li-=16)+2]=Le[0],Lj[Li+3]=Le[1],Lj[Li+6]=Le[2],Lj[Li+7]=Le[3],Lj[Li+10]=Le[4],Lj[Li+11]=Le[5],Lj[Li+14]=Le[6],Lj[Li+15]=Le[7];var Lk=Lf.a,Ll=Lf.b,Lm=Lf.c,Ln=Lf.d;if(1!==Lk||0!==Ll||0!==Lm||1!==Ln){Lf.bTransform=!0;var Lo=Lf.tx+Lg,Lp=Lf.ty+Lh;Lj[Li]=(Ld[0]+Lb)*Lk+(Ld[1]+Lc)*Lm+Lo,Lj[Li+1]=(Ld[0]+Lb)*Ll+(Ld[1]+Lc)*Ln+Lp,Lj[Li+4]=(Ld[2]+Lb)*Lk+(Ld[3]+Lc)*Lm+Lo,Lj[Li+5]=(Ld[2]+Lb)*Ll+(Ld[3]+Lc)*Ln+Lp,Lj[Li+8]=(Ld[4]+Lb)*Lk+(Ld[5]+Lc)*Lm+Lo,Lj[Li+9]=(Ld[4]+Lb)*Ll+(Ld[5]+Lc)*Ln+Lp,Lj[Li+12]=(Ld[6]+Lb)*Lk+(Ld[7]+Lc)*Lm+Lo,Lj[Li+13]=(Ld[6]+Lb)*Ll+(Ld[7]+Lc)*Ln+Lp}else Lf.bTransform=!1,Lb+=Lf.tx+Lg,Lc+=Lf.ty+Lh,Lj[Li]=Lb+Ld[0],Lj[Li+1]=Lc+Ld[1],Lj[Li+4]=Lb+Ld[2],Lj[Li+5]=Lc+Ld[3],Lj[Li+8]=Lb+Ld[4],Lj[Li+9]=Lc+Ld[5],Lj[Li+12]=Lb+Ld[6],Lj[Li+13]=Lc+Ld[7];return La._upload=!0},Lo.fillTranglesVB=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh=(La._byteLength>>2)+Ld.length;La.byteLength=Lh<<2;var Li=La.getFloat32Array();Lh-=Ld.length;for(var Lj=Ld.length,Lk=Le.a,Ll=Le.b,Lm=Le.c,Ln=Le.d,Lo=0;Lo<Lj;Lo+=4)if(Li[Lh+Lo+2]=Ld[Lo+2],Li[Lh+Lo+3]=Ld[Lo+3],1!==Lk||0!==Ll||0!==Lm||1!==Ln){Le.bTransform=!0;var Lp=Le.tx+Lf,Lq=Le.ty+Lg;Li[Lh+Lo]=(Ld[Lo]+Lb)*Lk+(Ld[Lo+1]+Lc)*Lm+Lp,Li[Lh+Lo+1]=(Ld[Lo]+Lb)*Ll+(Ld[Lo+1]+Lc)*Ln+Lq}else Le.bTransform=!1,Lb+=Le.tx+Lf,Lc+=Le.ty+Lg,Li[Lh+Lo]=Lb+Ld[Lo],Li[Lh+Lo+1]=Lc+Ld[Lo+1];return La._upload=!0},Lo.copyPreImgVb=function(La,Lb,Lc){var Ld=La._byteLength>>2;La.byteLength=Ld+16<<2;for(var Le=La.getFloat32Array(),Lf=0,Lg=Ld-16;Lf<4;Lf++)Le[Ld]=Le[Lg]+Lb,++Lg,Le[++Ld]=Le[Lg]+Lc,++Lg,Le[++Ld]=Le[Lg],++Lg,Le[++Ld]=Le[Lg],++Ld,++Lg;La._upload=!0},Lo.fillRectImgVb=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm){void 0===Lm&&(Lm=!1);var Ln,Lo,Lp,Lq,Lr,Ls,Lt,Lu,Lv,Ly,Lz,LA,LB,LC,LD,LE,LF=1,LG=Lh.a,LH=Lh.b,LI=Lh.c,LJ=Lh.d,LK=Lb&&Lb.width<99999999;if(1!==LG||0!==LH||0!==LI||1!==LJ?(Lh.bTransform=!0,0===LH&&0===LI&&(LF=23,Lv=Le+Lc,Ly=Lf+Ld,Ln=LG*Lc+(Lz=Lh.tx+Li),Lp=LG*Lv+Lz,Lo=LJ*Ld+(LA=Lh.ty+Lj),Lq=LJ*Ly+LA)):(LF=23,Lh.bTransform=!1,Lp=(Ln=Lc+Lh.tx+Li)+Le,Lq=(Lo=Ld+Lh.ty+Lj)+Lf),LK&&(Lr=Lb.x,Ls=Lb.y,Lt=Lb.width+Lr,Lu=Lb.height+Ls),1!==LF){if(Math.min(Ln,Lp)>=Lt)return!1;if(Math.min(Lo,Lq)>=Lu)return!1;if(Math.max(Lp,Ln)<=Lr)return!1;if(Math.max(Lq,Lo)<=Ls)return!1}var LL=La._byteLength>>2;La.byteLength=16+LL<<2;var LM=La.getFloat32Array();switch(LM[2+LL]=Lg[0],LM[3+LL]=Lg[1],LM[6+LL]=Lg[2],LM[7+LL]=Lg[3],LM[10+LL]=Lg[4],LM[11+LL]=Lg[5],LM[14+LL]=Lg[6],LM[15+LL]=Lg[7],LF){case 1:Lz=Lh.tx+Li,LA=Lh.ty+Lj;var LN=LG*Lc,LO=LI*Ld,LP=LJ*Ld,LQ=LH*Lc,LR=LG*(Lv=Le+Lc),LS=LI*(Ly=Lf+Ld),LT=LJ*Ly,LU=LH*Lv;Lm?(LB=LN+LO+Lz,LD=Math.round(LB)-LB,LC=LP+LQ+LA,LE=Math.round(LC)-LC,LM[LL]=LB+LD,LM[1+LL]=LC+LE,LM[4+LL]=LR+LO+Lz+LD,LM[5+LL]=LP+LU+LA+LE,LM[8+LL]=LR+LS+Lz+LD,LM[9+LL]=LT+LU+LA+LE,LM[12+LL]=LN+LS+Lz+LD,LM[13+LL]=LT+LQ+LA+LE):(LM[LL]=LN+LO+Lz,LM[1+LL]=LP+LQ+LA,LM[4+LL]=LR+LO+Lz,LM[5+LL]=LP+LU+LA,LM[8+LL]=LR+LS+Lz,LM[9+LL]=LT+LU+LA,LM[12+LL]=LN+LS+Lz,LM[13+LL]=LT+LQ+LA);break;case 23:Lm?(LB=Ln+Lk,LD=Math.round(LB)-LB,LC=Lo,LE=Math.round(LC)-LC,LM[LL]=LB+LD,LM[1+LL]=LC+LE,LM[4+LL]=Lp+Lk+LD,LM[5+LL]=Lo+LE,LM[8+LL]=Lp+LD,LM[9+LL]=Lq+LE,LM[12+LL]=Ln+LD,LM[13+LL]=Lq+LE):(LM[LL]=Ln+Lk,LM[1+LL]=Lo,LM[4+LL]=Lp+Lk,LM[5+LL]=Lo,LM[8+LL]=Lp,LM[9+LL]=Lq,LM[12+LL]=Ln,LM[13+LL]=Lq)}return La._upload=!0},Lo.fillLineVb=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=.5*Lg,Lj=Lo._fillLineArray,Lk=-(Ld-Lf),Ll=Lc-Le,Lm=Math.sqrt(Lk*Lk+Ll*Ll);Lk/=Lm,Ll/=Lm,Lk*=Li,Ll*=Li,Lj[0]=Lc-Lk,Lj[1]=Ld-Ll,Lj[4]=Lc+Lk,Lj[5]=Ld+Ll,Lj[8]=Le+Lk,Lj[9]=Lf+Ll,Lj[12]=Le-Lk,Lj[13]=Lf-Ll,Lh&&Lh.transformPointArray(Lj,Lj);var Ln=16+(La._byteLength>>2);return La.byteLength=Ln<<2,La.insertData(Lj,Ln-16),!0},Lo._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Lo}(),Lra=(function(){function Li(){}Lm(Li,"laya.webgl.utils.MatirxArray"),Li.ArrayMul=function(La,Lb,Lc){if(La)if(Lb)for(var Ld=NaN,Le=NaN,Lf=NaN,Lg=NaN,Lh=0;Lh<4;Lh++)Ld=La[Lh],Le=La[Lh+4],Lf=La[Lh+8],Lg=La[Lh+12],Lc[Lh]=Ld*Lb[0]+Le*Lb[1]+Lf*Lb[2]+Lg*Lb[3],Lc[Lh+4]=Ld*Lb[4]+Le*Lb[5]+Lf*Lb[6]+Lg*Lb[7],Lc[Lh+8]=Ld*Lb[8]+Le*Lb[9]+Lf*Lb[10]+Lg*Lb[11],Lc[Lh+12]=Ld*Lb[12]+Le*Lb[13]+Lf*Lb[14]+Lg*Lb[15];else Li.copyArray(La,Lc);else Li.copyArray(Lb,Lc)},Li.copyArray=function(La,Lb){if(La&&Lb)for(var Lc=0;Lc<La.length;Lc++)Lb[Lc]=La[Lc]}}(),function(){function Lb(La,Lb,Lc){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=La,this._vb=new Lxa(La,35048),Lb&&this._vb._resizeBuffer(Lb,!1),this._ib=new Lwa,Lc&&this._ib._resizeBuffer(Lc,!1)}Lm(Lb,"laya.webgl.utils.Mesh2D");var La=Lb.prototype;return La.cloneWithNewVB=function(){var La=new Lb(this._stride,0,0);return La._ib=this._ib,La._quadNum=this._quadNum,La._attribInfo=this._attribInfo,La},La.cloneWithNewVBIB=function(){var La=new Lb(this._stride,0,0);return La._attribInfo=this._attribInfo,La},La.getVBW=function(){return this._vb.setNeedUpload(),this._vb},La.getVBR=function(){return this._vb},La.getIBR=function(){return this._ib},La.getIBW=function(){return this._ib.setNeedUpload(),this._ib},La.createQuadIB=function(La){this._quadNum=La,this._ib._resizeBuffer(6*La*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Lb=this._ib.getUint16Array(),Lc=0,Ld=0,Le=0;Le<La;Le++)Lb[Lc++]=Ld,Lb[Lc++]=Ld+2,Lb[Lc++]=Ld+1,Lb[Lc++]=Ld,Lb[Lc++]=Ld+3,Lb[Lc++]=Ld+2,Ld+=4;this._ib.setNeedUpload()},La.setAttributes=function(La){if(this._attribInfo=La,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},La.getEleNum=function(){return this._ib.getBuffer().byteLength/2},La.releaseMesh=function(){},La.destroy=function(){},La.clearVB=function(){this._vb.clear()},Lb._gvaoid=0,Lb}()),Lsa=function(){function Le(){}return Lm(Le,"laya.webgl.utils.RenderState2D"),Le.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Le.mat2MatArray=function(La,Lb){var Lc=La,Ld=Lb;return Ld[0]=Lc.a,Ld[1]=Lc.b,Ld[2]=Le.EMPTYMAT4_ARRAY[2],Ld[3]=Le.EMPTYMAT4_ARRAY[3],Ld[4]=Lc.c,Ld[5]=Lc.d,Ld[6]=Le.EMPTYMAT4_ARRAY[6],Ld[7]=Le.EMPTYMAT4_ARRAY[7],Ld[8]=Le.EMPTYMAT4_ARRAY[8],Ld[9]=Le.EMPTYMAT4_ARRAY[9],Ld[10]=Le.EMPTYMAT4_ARRAY[10],Ld[11]=Le.EMPTYMAT4_ARRAY[11],Ld[12]=Lc.tx,Ld[13]=Lc.ty,Ld[14]=Le.EMPTYMAT4_ARRAY[14],Ld[15]=Le.EMPTYMAT4_ARRAY[15],Lb},Le.restoreTempArray=function(){Le.TEMPMAT4_ARRAY[0]=1,Le.TEMPMAT4_ARRAY[1]=0,Le.TEMPMAT4_ARRAY[4]=0,Le.TEMPMAT4_ARRAY[5]=1,Le.TEMPMAT4_ARRAY[12]=0,Le.TEMPMAT4_ARRAY[13]=0},Le.clear=function(){Le.worldScissorTest=!1,Le.worldShaderDefines=null,Le.worldFilters=null,Le.worldAlpha=1,Le.worldClipRect.x=Le.worldClipRect.y=0,Le.worldClipRect.width=Le.width,Le.worldClipRect.height=Le.height,Le.curRenderTarget=null},Le._MAXSIZE=99999999,Le.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Le.worldMatrix4=Le.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Le.worldAlpha=1,Le.worldScissorTest=!1,Le.worldFilters=null,Le.worldShaderDefines=null,Le.curRenderTarget=null,Le.width=0,Le.height=0,Lg(Le,["worldMatrix",function(){return this.worldMatrix=new LB},"worldClipRect",function(){return this.worldClipRect=new LD(0,0,99999999,99999999)}]),Le}(),Lta=function(){var Ls,Lc;function Lt(La,Lb,Lc,Ld,Le){var Lf=this;function Lg(La){var Lb=[],Lc=new Ls(Lb);return Lf._compileToTree(Lc,La.split("\n"),0,Lb,Le),Lc}var Lh=Ln.now();this._VS=Lg(Lb),this._PS=Lg(Lc),this._nameMap=Ld,2<Ln.now()-Lh&&console.log("ShaderCompile use time:"+(Ln.now()-Lh)+"  size:"+Lb.length+"/"+Lc.length)}Lm(Lt,"laya.webgl.utils.ShaderCompile");var La=Lt.prototype;return La._compileToTree=function(La,Lb,Lc,Ld,Le){var Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm=0,Ln=0,Lo=0,Lp=0;for(Ln=Lc;Ln<Lb.length;Ln++)if(!((Lh=Lb[Ln]).length<1)&&0!==(Lm=Lh.indexOf("//"))){if(0<=Lm&&(Lh=Lh.substr(0,Lm)),Lf=Ll||new Ls(Ld),Ll=null,Lf.text=Lh,Lf.noCompile=!0,0<=(Lm=Lh.indexOf("#"))){for(Li="#",Lp=Lm+1,Lo=Lh.length;Lp<Lo;Lp++){var Lq=Lh.charAt(Lp);if(" "===Lq||"\t"===Lq||"\r"===Lq||"\n"===Lq||"?"===Lq)break;Li+=Lq}switch(Lf.name=Li){case"#ifdef":case"#ifndef":if(Lf.src=Lh,Lf.noCompile=null!=Lh.match(/[!&|()=<>]/),Lf.noCompile?console.log("function():Boolean{return "+Lh.substr(Lm+Lf.name.length)+"}"):(Lk=Lh.replace(/^\s*/,"").split(/\s+/),Lf.setCondition(Lk[1],"#ifdef"===Li?1:2),Lf.text="//"+Lf.text),Lf.setParent(La),La=Lf,Le)for(Lk=Lh.substr(Lp).split(Lt._splitToWordExps3),Lp=0;Lp<Lk.length;Lp++)(Lh=Lk[Lp]).length&&(Le[Lh]=!0);continue;case"#if":if(Lf.src=Lh,Lf.noCompile=!0,Lf.setParent(La),La=Lf,Le)for(Lk=Lh.substr(Lp).split(Lt._splitToWordExps3),Lp=0;Lp<Lk.length;Lp++)(Lh=Lk[Lp]).length&&"defined"!=Lh&&(Le[Lh]=!0);continue;case"#else":Lf.src=Lh,Lg=(La=La.parent).childs[La.childs.length-1],Lf.noCompile=Lg.noCompile,Lf.noCompile||(Lf.condition=Lg.condition,Lf.conditionType=1==Lg.conditionType?2:1,Lf.text="//"+Lf.text+" "+Lg.text+" "+Lf.conditionType),Lf.setParent(La),La=Lf;continue;case"#endif":Lg=(La=La.parent).childs[La.childs.length-1],Lf.noCompile=Lg.noCompile,Lf.noCompile||(Lf.text="//"+Lf.text),Lf.setParent(La);continue;case"#include":Lk=Lt.splitToWords(Lh,null);var Lr=Lt.includes[Lk[1]];if(!Lr)throw"ShaderCompile error no this include file:"+Lk[1];if((Lm=Lk[0].indexOf("?"))<0){Lf.setParent(La),Lh=Lr.getWith("with"==Lk[2]?Lk[3]:null),this._compileToTree(Lf,Lh.split("\n"),0,Ld,Le),Lf.text="";continue}Lf.setCondition(Lk[0].substr(Lm+1),1),Lf.text=Lr.getWith("with"==Lk[2]?Lk[3]:null);break;case"#import":Lj=(Lk=Lt.splitToWords(Lh,null))[1],Ld.push({node:Lf,file:Lt.includes[Lj],ofs:Lf.text.length});continue}}else{if((Lg=La.childs[La.childs.length-1])&&!Lg.name){0<Ld.length&&Lt.splitToWords(Lh,Lg),Ll=Lf,Lg.text+="\n"+Lh;continue}0<Ld.length&&Lt.splitToWords(Lh,Lf)}Lf.setParent(La)}},La.createShader=function(La,Lb,Lc){var Ld={},Le="";if(La)for(var Lf in La)Le+="#define "+Lf+"\n",Ld[Lf]=!0;var Lg=this._VS.toscript(Ld,[]),Lh=this._PS.toscript(Ld,[]);return(Lc||LYa.create)(Le+Lg.join("\n"),Le+Lh.join("\n"),Lb,this._nameMap)},Lt._parseOne=function(La,Lb,Lc,Ld,Le,Lf){var Lg={type:Lt.shaderParamsMap[Lc[Ld+1]],name:Lc[Ld+2],size:isNaN(parseInt(Lc[Ld+3]))?1:parseInt(Lc[Ld+3])};return Lf&&("attribute"==Le?La.push(Lg):Lb.push(Lg)),":"==Lc[Ld+3]&&(Lg.type=Lc[Ld+4],Ld+=2),Ld+=2},Lt.addInclude=function(La,Lb){if(!Lb||0===Lb.length)throw new Error("add shader include file err:"+La);if(Lt.includes[La])throw new Error("add shader include file err, has add:"+La);Lt.includes[La]=new Lc(Lb)},Lt.preGetParams=function(La,Lb){var Lc=[La,Lb],Ld={},Le=[],Lf=[],Lg={},Lh=[];Ld.attributes=Le,Ld.uniforms=Lf,Ld.defines=Lg;for(var Li=0,Lj=0,Lk=0;Lk<2;Lk++){Lc[Lk]=Lc[Lk].replace(Lt._removeAnnotation,"");var Ll,Lm=Lc[Lk].match(Lt._reg);for(Li=0,Lj=Lm.length;Li<Lj;Li++){var Ln=Lm[Li];if("attribute"==Ln||"uniform"==Ln)Li=Lt._parseOne(Le,Lf,Lm,Li,Ln,!0);else{if("#define"==Ln){Lh[Ln=Lm[++Li]]=1;continue}if("#ifdef"==Ln){Lg[Ll=Lm[++Li]]=Lg[Ll]||[];for(Li++;Li<Lj;Li++)if("attribute"==(Ln=Lm[Li])||"uniform"==Ln)Li=Lt._parseOne(Le,Lf,Lm,Li,Ln,Lh[Ll]);else if("#else"==Ln)for(Li++;Li<Lj;Li++)if("attribute"==(Ln=Lm[Li])||"uniform"==Ln)Li=Lt._parseOne(Le,Lf,Lm,Li,Ln,!Lh[Ll]);else if("#endif"==Ln)break}}}}return Ld},Lt.splitToWords=function(La,Lb){for(var Lc,Ld,Le=[],Lf=-1,Lg=0,Lh=La.length;Lg<Lh;Lg++)if(Lc=La.charAt(Lg),0<=" \t=+-*/&%!<>()'\",;".indexOf(Lc)){if(0<=Lf&&1<Lg-Lf&&(Ld=La.substr(Lf,Lg-Lf),Le.push(Ld)),'"'==Lc||"'"==Lc){var Li=La.indexOf(Lc,Lg+1);if(Li<0)throw"Sharder err:"+La;Le.push(La.substr(Lg+1,Li-Lg-1)),Lg=Li,Lf=-1;continue}"("==Lc&&Lb&&0<Le.length&&(Ld=Le[Le.length-1]+";","vec4;main;".indexOf(Ld)<0&&(Lb.useFuns+=Ld)),Lf=-1}else Lf<0&&(Lf=Lg);return Lf<Lh&&1<Lh-Lf&&(Ld=La.substr(Lf,Lh-Lf),Le.push(Ld)),Le},Lt.IFDEF_NO=0,Lt.IFDEF_YES=1,Lt.IFDEF_ELSE=2,Lt.IFDEF_PARENT=3,Lt._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Lt._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Lt._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Lt.includes={},Lg(Lt,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),Lt.__init$=function(){Ls=function(){function Lc(La){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=La}Lm(Lc,"");var La=Lc.prototype;return La.setParent=function(La){La.childs.push(this),this.z=La.z+1,this.parent=La},La.setCondition=function(La,Lb){La&&(this.conditionType=Lb,La=La.replace(/(\s*$)/g,""),this.condition=function(){return this[La]},this.condition.__condition=La)},La.toscript=function(La,Lb){return this._toscript(La,Lb,++Lc.__id)},La._toscript=function(Ld,Le,Lf){if(this.childs.length<1&&!this.text)return Le;Le.length;if(this.condition){var La=!!this.condition.call(Ld);if(2===this.conditionType&&(La=!La),!La)return Le}if(this.text&&Le.push(this.text),0<this.childs.length&&this.childs.forEach(function(La,Lb,Lc){La._toscript(Ld,Le,Lf)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Lb,Lc=0,Lg=this.includefiles.length;Lc<Lg;Lc++)this.includefiles[Lc].curUseID!=Lf&&0<(Lb=this.includefiles[Lc].file.getFunsScript(this.useFuns)).length&&(this.includefiles[Lc].curUseID=Lf,Le[0]=Lb+Le[0]);return Le},Lc.__id=1,Lc}(),Lc=function(){function La(La){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=La;for(var Lb=0,Lc=0,Ld=0;!((Lb=La.indexOf("#begin",Lb))<0);){for(Ld=Lb+5;!((Ld=La.indexOf("#end",Ld))<0)&&"i"===La.charAt(Ld+4);)Ld+=5;if(Ld<0)throw"add include err,no #end:"+La;Lc=La.indexOf("\n",Lb);var Le=Lt.splitToWords(La.substr(Lb,Lc-Lb),null);"code"==Le[1]?this.codes[Le[2]]=La.substr(Lc+1,Ld-Lc-1):"function"==Le[1]&&(Lc=La.indexOf("function",Lb),Lc+="function".length,this.funs[Le[3]]=La.substr(Lc+1,Ld-Lc-1),this.funnames+=Le[3]+";"),Lb=Ld+1}}Lm(La,"");var Lb=La.prototype;return Lb.getWith=function(La){var Lb=La?this.codes[La]:this.script;if(!Lb)throw"get with error:"+La;return Lb},Lb.getFunsScript=function(La){var Lb="";for(var Lc in this.funs)0<=La.indexOf(Lc+";")&&(Lb+=this.funs[Lc]);return Lb},La}()},Lt}(),Lua=function(){function Lg(){}return Lm(Lg,"laya.webgl.WebGL"),Lg._uint8ArraySlice=function(){for(var La=this.length,Lb=new Uint8Array(this.length),Lc=0;Lc<La;Lc++)Lb[Lc]=this[Lc];return Lb},Lg._float32ArraySlice=function(){for(var La=this.length,Lb=new Float32Array(this.length),Lc=0;Lc<La;Lc++)Lb[Lc]=this[Lc];return Lb},Lg._uint16ArraySlice=function(La){var Lb,Lc=arguments,Ld=0,Le=0;if(0===Lc.length)for(Ld=this.length,Lb=new Uint16Array(Ld),Le=0;Le<Ld;Le++)Lb[Le]=this[Le];else if(2===Lc.length){var Lf=Lc[0],Lg=Lc[1];if(Lf<Lg)for(Ld=Lg-Lf,Lb=new Uint16Array(Ld),Le=Lf;Le<Lg;Le++)Lb[Le-Lf]=this[Le];else Lb=new Uint16Array(0)}return Lb},Lg.expandContext=function(){var La=Lh.prototype,Lb=CanvasRenderingContext2D.prototype;Lb.fillTrangles=La.fillTrangles,LZa.__int__(null),Lb.setIBVB=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){void 0===Li&&(Li=0),void 0===Lj&&(Lj=0),null===Lc&&(this._ib=this._ib||Lwa.QuadrangleIB,Lc=this._ib,Lqa.expandIBQuadrangle(Lc,Ld._byteLength/64+8)),this._setIBVB(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj)},Lb.fillTrangles=function(La,Lb,Lc,Ld,Le){this._curMat=this._curMat||LB.create(),this._vb=this._vb||Lxa.create(),this._ib||(this._ib=Lwa.create(),Lqa.fillIBQuadrangle(this._ib,Lg/4));var Lf=this._vb,Lg=Ld.length>>4;Lqa.fillTranglesVB(Lf,Lb,Lc,Ld,Le||this._curMat,0,0),Lqa.expandIBQuadrangle(this._ib,Lf._byteLength/64+8);var Lh=new LAa(1,0);Lh.textureHost=La;var Li=new L_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Lf._vertType=3,this._setIBVB(Lb,Lc,this._ib,Lf,6*Lg,Le,Li,Lh,0,0)}},Lg.enable=function(){if(Ln.__init__(),Lr.isConchApp&&!Lr.isConchWebGL)return Lv.skinAniSprite=function(){return new Laa},Lg.expandContext(),!1;if(Lv.getWebGLContext=function(La){for(var Lb,Lc=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Ld=0;Ld<Lc.length;Ld++){try{Lb=La.getContext(Lc[Ld],{stencil:Lz.isStencil,alpha:Lz.isAlpha,antialias:Lz.isAntialias,premultipliedAlpha:Lz.premultipliedAlpha,preserveDrawingBuffer:Lz.preserveDrawingBuffer})}catch(La){}if(Lb)return Lb}return null},null==(Lg.mainContext=Lg.mainContext||Lv.getWebGLContext(Lr._mainCanvas)))return!1;if(Lr.isWebGL)return!0;Lq.create=function(La,Lb){return new Lab(La,Lb)},Lb.create=function(La,Lb,Lc,Ld,Le,Lf,Lg){return new LXa(La,Lb,Lc,Ld,Le,Lf,Lg)},Lr.WebGL=Lg,Lr.isWebGL=!0,Lna.__init__(),Lv.createRenderSprite=function(La,Lb){return new LBa(La,Lb)},Lv.createWebGLContext2D=function(La){return new Lza(La)},Lv.changeWebGLSize=function(La,Lb){laya.webgl.WebGL.onStageResize(La,Lb)},Lv.createGraphics=function(){return new Lya};var La=Lv.createFilterAction;return Lv.createFilterAction=La||function(La){return new LCa},Lv.clear=function(La){Lsa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Lb=Lr.context.ctx,Lc=0==Lb._submits._length||Lz.preserveDrawingBuffer?Lo.create(La)._color:LF._wgColor;Lc&&Lb.clearBG(Lc[0],Lc[1],Lc[2],Lc[3]),Lsa.clear()},Lv.addToAtlas=function(La,Lb){void 0===Lb&&(Lb=!1);var Lc=La.bitmap;Lr.optimizeTextureMemory(La.url,La)?Ly.__typeof(Lc,"laya.webgl.resource.IMergeAtlasBitmap")&&Lc.allowMerageInAtlas&&Lc.on("recovered",La,La.addTextureToAtlas):Lc.enableMerageInAtlas=!1},Lv.isAtlas=function(La){return La instanceof laya.webgl.atlas.AtlasWebGLCanvas},LQ._enable(),Lv.beginFlush=function(){for(var La=LQ.instance,Lb=La.getAtlaserCount(),Lc=0;Lc<Lb;Lc++){var Ld=La.getAtlaserByIndex(Lc).texture;Ld._flashCacheImageNeedFlush&&Lv.flashFlushImage(Ld)}},Lv.drawToCanvas=function(La,Lb,Lc,Ld,Le,Lf){(Lc<=0||Ld<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),Lc|=0,Ld|=0,Le|=0,Lf|=0;var Lg=LMa.create(Lc,Ld,6408,5121,0,!1);Lg.start(),Lg.clear(0,0,0,0),Lr.context.clear(),Ls.renders[Lb]._fun(La,Lr.context,Le,Lsa.height-Ld+Lf),Lr.context.flush(),Lg.end();var Lh=Lg.getData(0,0,Lc,Ld);if(Lg.recycle(),Lh.byteLength==Lc*Ld*4){var Li=new LUa;Li._canvas=Ln.createElement("canvas"),Li.size(Lc,Ld);var Lj=Li._canvas.getContext("2d");Ln.canvas.size(Lc,Ld);var Lk=Ln.context,Ll=Lk.createImageData(Lc,Ld);return Ll.data.set(new Uint8ClampedArray(Lh.buffer)),Li._imgData=Ll,Lk.putImageData(Ll,0,0),Lj.save(),Lj.translate(0,Ld),Lj.scale(1,-1),Lj.drawImage(Ln.canvas.source,0,0),Lj.restore(),Li}console.log("drawToCanvas error: w:"+Lc+",h:"+Ld+",datalen:"+Lh.byteLength)},Lv.createFilterAction=function(La){var Lb;switch(La){case 32:Lb=new LCa}return Lb},Lv.addTextureToAtlas=function(La){La._uvID++,LQ._atlasRestore++,La.bitmap.enableMerageInAtlas&&LQ.instance.addToAtlas(La)},Lv.getTexturePixels=function(La,Lb,Lc,Ld,Le){Lr.context.ctx.clear();var Lf=new LE;Lf.graphics.drawTexture(La,-Lb,-Lc);var Lg=LMa.create(Ld,Le);Lg.start(),Lg.clear(0,0,0,0),Lf.render(Lr.context,0,0),Lr.context.ctx.flush(),Lg.end();for(var Lh=Lg.getData(0,0,Ld,Le),Li=[],Lj=0,Lk=Le-1;0<=Lk;Lk--)for(var Ll=0;Ll<Ld;Ll++)Lj=4*(Lk*Ld+Ll),Li.push(Lh[Lj]),Li.push(Lh[Lj+1]),Li.push(Lh[Lj+2]),Li.push(Lh[Lj+3]);return Li},Lv.skinAniSprite=function(){return new Laa},Lp.create=function(La,Lb){var Lc=new LUa;return Lc._imgData=Lb,Lc.flipY=!1,Lc},LA._filterStart=function(La,Lb,Lc,Ld,Le){var Lf=La.getValue("bounds"),Lg=LMa.create(Lf.width,Lf.height);if(Lg.start(),Lg.clear(0,0,0,0),La.addValue("src",Lg),La.addValue("ScissorTest",Lsa.worldScissorTest),Lsa.worldScissorTest){var Lh=new LD;Lh.copyFrom(Lc.ctx._clipRect),La.addValue("clipRect",Lh),Lsa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},LA._filterEnd=function(La,Lb,Lc,Ld,Le){var Lf=La.getValue("bounds");La.getValue("src").end();var Lg=LMa.create(Lf.width,Lf.height);Lg.start(),Lg.clear(0,0,0,0),La.addValue("out",Lg),Lb._set$P("_filterCache",Lg),Lb._set$P("_isHaveGlowFilter",La.getValue("_isHaveGlowFilter"))},LA._EndTarget=function(La,Lb){if(La.getValue("src").recycle(),La.getValue("out").end(),La.getValue("ScissorTest")){Lsa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Lb.ctx.save();var Lc=La.getValue("clipRect");Lb.ctx.clipRect(Lc.x,Lc.y,Lc.width,Lc.height)}},LA._useSrc=function(La){var Lb=La.getValue("out");Lb.end(),(Lb=La.getValue("src")).start(),Lb.clear(0,0,0,0)},LA._endSrc=function(La){La.getValue("src").end()},LA._useOut=function(La){var Lb=La.getValue("src");Lb.end(),(Lb=La.getValue("out")).start(),Lb.clear(0,0,0,0)},LA._endOut=function(La){La.getValue("out").end()},LA._recycleScope=function(La){La.recycle()},LA._filter=function(La,Lb,Lc,Ld){var Le=this._next;if(Le){var Lf,Lg,Lh=La.filters,Li=Lh.length;if(1==Li&&32==Lh[0].type)return Lb.ctx.save(),Lb.ctx.setFilters([Lh[0]]),Le._fun.call(Le,La,Lb,Lc,Ld),void Lb.ctx.restore();var Lj=Lha.create(),Lk=LC.TEMP,Ll=Lb.ctx._getTransformMatrix(),Lm=LB.create();Ll.copyTo(Lm);var Ln=0,Lo=0,Lp=!1,Lq=La._$P._filterCache?La._$P._filterCache:null;if(!Lq||La._repaint){Lp=La._isHaveGlowFilter(),Lj.addValue("_isHaveGlowFilter",Lp),Lp&&(Ln=50,Lo=25),(Lg=new LD).copyFrom(La.getSelfBounds()),Lg.x+=La.x,Lg.y+=La.y,Lg.x-=La.pivotX+4,Lg.y-=La.pivotY+4;var Lr=Lg.x,Ls=Lg.y;if(Lg.width+=Ln+8,Lg.height+=Ln+8,Lk.x=Lg.x*Lm.a+Lg.y*Lm.c,Lk.y=Lg.y*Lm.d+Lg.x*Lm.b,Lg.x=Lk.x,Lg.y=Lk.y,Lk.x=Lg.width*Lm.a+Lg.height*Lm.c,Lk.y=Lg.height*Lm.d+Lg.width*Lm.b,Lg.width=Lk.x,Lg.height=Lk.y,Lg.width<=0||Lg.height<=0)return;Lq&&Lq.recycle(),Lj.addValue("bounds",Lg);var Lt=Lga.create([Lj,La,Lb,0,0],LA._filterStart);Lb.addRenderObject(Lt),Lb.ctx._renderKey=0,Lb.ctx._shader2D.glTexture=null;var Lu=La.x-Lr+Lo,Lv=La.y-Ls+Lo;Le._fun.call(Le,La,Lb,Lu,Lv),Lt=Lga.create([Lj,La,Lb,0,0],LA._filterEnd),Lb.addRenderObject(Lt);for(var Ly=0;Ly<Li;Ly++){0!=Ly&&(Lt=Lga.create([Lj],LA._useSrc),Lb.addRenderObject(Lt),Lf=LAa.create(1,0),LB.TEMP.identity(),Lb.ctx.drawTarget(Lj,0,0,Lg.width,Lg.height,LB.TEMP,"out",Lf,null,LS.TOINT.overlay),Lt=Lga.create([Lj],LA._useOut),Lb.addRenderObject(Lt)),Lh[Ly].action.apply3d(Lj,La,Lb,0,0)}Lt=Lga.create([Lj,Lb],LA._EndTarget),Lb.addRenderObject(Lt)}else{if((Lp=!!La._$P._isHaveGlowFilter&&La._$P._isHaveGlowFilter)&&(Ln=50,Lo=25),(Lg=La.getBounds()).width<=0||Lg.height<=0)return;Lg.width+=Ln,Lg.height+=Ln,Lk.x=Lg.x*Lm.a+Lg.y*Lm.c,Lk.y=Lg.y*Lm.d+Lg.x*Lm.b,Lg.x=Lk.x,Lg.y=Lk.y,Lk.x=Lg.width*Lm.a+Lg.height*Lm.c,Lk.y=Lg.height*Lm.d+Lg.width*Lm.b,Lg.width=Lk.x,Lg.height=Lk.y,Lj.addValue("out",Lq)}Lc=Lc-Lo-La.x,Ld=Ld-Lo-La.y,Lk.setTo(Lc,Ld),Lm.transformPoint(Lk),Lc=Lk.x+Lg.x,Ld=Lk.y+Lg.y,Lf=LAa.create(1,0),LB.TEMP.identity(),Lb.ctx.drawTarget(Lj,Lc,Ld,Lg.width,Lg.height,LB.TEMP,"out",Lf,null,LS.TOINT.overlay),Lt=Lga.create([Lj],LA._recycleScope),Lb.addRenderObject(Lt),Lm.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=Lg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=Lg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Lg._uint8ArraySlice),!0},Lg.onStageResize=function(La,Lb){null!=Lg.mainContext&&(Lg.mainContext.viewport(0,0,La,Lb),Lsa.width=La,Lsa.height=Lb)},Lg.onInvalidGLRes=function(){LQ.instance.freeAll(),Lu.releaseContentManagers(!0),Lg.doNodeRepaint(Ly.stage),Lg.mainContext.viewport(0,0,Lsa.width,Lsa.height),Ly.stage.event("devicelost")},Lg.doNodeRepaint=function(La){0==La.numChildren&&La.repaint();for(var Lb=0;Lb<La.numChildren;Lb++)Lg.doNodeRepaint(La.getChildAt(Lb))},Lg.init=function(La,Lb,Lc){Lg.mainCanvas=La,Lp._createContext=function(La){return new Lza(La)},LUa._createContext=function(La){return new Lza(La)};var Ld=laya.webgl.WebGL.mainContext;if(null!=Ld.getShaderPrecisionFormat){var Le=Ld.getShaderPrecisionFormat(35633,36338),Lf=Ld.getShaderPrecisionFormat(35632,36338);Lg.shaderHighPrecision=!(!Le.precision||!Lf.precision)}else Lg.shaderHighPrecision=!1;if(Lg.compressAstc=Ld.getExtension("WEBGL_compressed_texture_astc"),Lg.compressAtc=Ld.getExtension("WEBGL_compressed_texture_atc"),Lg.compressEtc=Ld.getExtension("WEBGL_compressed_texture_etc"),Lg.compressEtc1=Ld.getExtension("WEBGL_compressed_texture_etc1"),Lg.compressPvrtc=Ld.getExtension("WEBGL_compressed_texture_pvrtc"),Lg.compressS3tc=Ld.getExtension("WEBGL_compressed_texture_s3tc"),Lg.compressS3tc_srgb=Ld.getExtension("WEBGL_compressed_texture_s3tc_srgb"),Lg.compressAstc=Lg.compressAstc?Lg.compressAstc:{},Lg.compressAtc=Lg.compressAtc?Lg.compressAtc:{},Lg.compressEtc=Lg.compressEtc?Lg.compressEtc:{},Lg.compressEtc1=Lg.compressEtc1?Lg.compressEtc1:{},Lg.compressPvrtc=Lg.compressPvrtc?Lg.compressPvrtc:{},Lg.compressS3tc=Lg.compressS3tc?Lg.compressS3tc:{},Lg.compressS3tc_srgb=Lg.compressS3tc_srgb?Lg.compressS3tc_srgb:{},Ld.deleteTexture1=Ld.deleteTexture,Ld.deleteTexture=function(La){La==Lva.curBindTexValue&&(Lva.curBindTexValue=null),Ld.deleteTexture1(La)},Lg.onStageResize(Lb,Lc),null==Lg.mainContext)throw new Error("webGL getContext err!");LI.__init__(),LQ.__init__(),LEa.__init__(),Lfa.__init__(),Lza.__init__(),LAa.__init__(),Lw.__init__(),LZa.__int__(Ld),LS._init_(Ld),Lr.isConchApp&&conch.setOnInvalidGLRes(Lg.onInvalidGLRes)},Lg.mainCanvas=null,Lg.antialias=!0,Lg.shaderHighPrecision=!1,Lg._bg_null=[0,0,0,0],Lg}(),Lva=function(){function Ld(){}return Lm(Ld,"laya.webgl.WebGLContext"),Ld.UseProgram=function(La){return Ld._useProgram!==La&&(Lua.mainContext.useProgram(La),Ld._useProgram=La,!0)},Ld.setDepthTest=function(La,Lb){Lb!==Ld._depthTest&&((Ld._depthTest=Lb)?La.enable(2929):La.disable(2929))},Ld.setDepthMask=function(La,Lb){Lb!==Ld._depthMask&&(Ld._depthMask=Lb,La.depthMask(Lb))},Ld.setDepthFunc=function(La,Lb){Lb!==Ld._depthFunc&&(Ld._depthFunc=Lb,La.depthFunc(Lb))},Ld.setBlend=function(La,Lb){Lb!==Ld._blend&&((Ld._blend=Lb)?La.enable(3042):La.disable(3042))},Ld.setBlendFunc=function(La,Lb,Lc){(Lb!==Ld._sFactor||Lc!==Ld._dFactor)&&(Ld._sFactor=Lb,Ld._dFactor=Lc,La.blendFunc(Lb,Lc))},Ld.setCullFace=function(La,Lb){Lb!==Ld._cullFace&&((Ld._cullFace=Lb)?La.enable(2884):La.disable(2884))},Ld.setFrontFace=function(La,Lb){Lb!==Ld._frontFace&&(Ld._frontFace=Lb,La.frontFace(Lb))},Ld.bindTexture=function(La,Lb,Lc){La.bindTexture(Lb,Lc),Ld.curBindTexTarget=Lb,Ld.curBindTexValue=Lc},Ld.DEPTH_BUFFER_BIT=256,Ld.STENCIL_BUFFER_BIT=1024,Ld.COLOR_BUFFER_BIT=16384,Ld.POINTS=0,Ld.LINES=1,Ld.LINE_LOOP=2,Ld.LINE_STRIP=3,Ld.TRIANGLES=4,Ld.TRIANGLE_STRIP=5,Ld.TRIANGLE_FAN=6,Ld.ZERO=0,Ld.ONE=1,Ld.SRC_COLOR=768,Ld.ONE_MINUS_SRC_COLOR=769,Ld.SRC_ALPHA=770,Ld.ONE_MINUS_SRC_ALPHA=771,Ld.DST_ALPHA=772,Ld.ONE_MINUS_DST_ALPHA=773,Ld.DST_COLOR=774,Ld.ONE_MINUS_DST_COLOR=775,Ld.SRC_ALPHA_SATURATE=776,Ld.FUNC_ADD=32774,Ld.BLEND_EQUATION=32777,Ld.BLEND_EQUATION_RGB=32777,Ld.BLEND_EQUATION_ALPHA=34877,Ld.FUNC_SUBTRACT=32778,Ld.FUNC_REVERSE_SUBTRACT=32779,Ld.BLEND_DST_RGB=32968,Ld.BLEND_SRC_RGB=32969,Ld.BLEND_DST_ALPHA=32970,Ld.BLEND_SRC_ALPHA=32971,Ld.CONSTANT_COLOR=32769,Ld.ONE_MINUS_CONSTANT_COLOR=32770,Ld.CONSTANT_ALPHA=32771,Ld.ONE_MINUS_CONSTANT_ALPHA=32772,Ld.BLEND_COLOR=32773,Ld.ARRAY_BUFFER=34962,Ld.ELEMENT_ARRAY_BUFFER=34963,Ld.ARRAY_BUFFER_BINDING=34964,Ld.ELEMENT_ARRAY_BUFFER_BINDING=34965,Ld.STREAM_DRAW=35040,Ld.STATIC_DRAW=35044,Ld.DYNAMIC_DRAW=35048,Ld.BUFFER_SIZE=34660,Ld.BUFFER_USAGE=34661,Ld.CURRENT_VERTEX_ATTRIB=34342,Ld.FRONT=1028,Ld.BACK=1029,Ld.CULL_FACE=2884,Ld.FRONT_AND_BACK=1032,Ld.BLEND=3042,Ld.DITHER=3024,Ld.STENCIL_TEST=2960,Ld.DEPTH_TEST=2929,Ld.SCISSOR_TEST=3089,Ld.POLYGON_OFFSET_FILL=32823,Ld.SAMPLE_ALPHA_TO_COVERAGE=32926,Ld.SAMPLE_COVERAGE=32928,Ld.NO_ERROR=0,Ld.INVALID_ENUM=1280,Ld.INVALID_VALUE=1281,Ld.INVALID_OPERATION=1282,Ld.OUT_OF_MEMORY=1285,Ld.CW=2304,Ld.CCW=2305,Ld.LINE_WIDTH=2849,Ld.ALIASED_POINT_SIZE_RANGE=33901,Ld.ALIASED_LINE_WIDTH_RANGE=33902,Ld.CULL_FACE_MODE=2885,Ld.FRONT_FACE=2886,Ld.DEPTH_RANGE=2928,Ld.DEPTH_WRITEMASK=2930,Ld.DEPTH_CLEAR_VALUE=2931,Ld.DEPTH_FUNC=2932,Ld.STENCIL_CLEAR_VALUE=2961,Ld.STENCIL_FUNC=2962,Ld.STENCIL_FAIL=2964,Ld.STENCIL_PASS_DEPTH_FAIL=2965,Ld.STENCIL_PASS_DEPTH_PASS=2966,Ld.STENCIL_REF=2967,Ld.STENCIL_VALUE_MASK=2963,Ld.STENCIL_WRITEMASK=2968,Ld.STENCIL_BACK_FUNC=34816,Ld.STENCIL_BACK_FAIL=34817,Ld.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Ld.STENCIL_BACK_PASS_DEPTH_PASS=34819,Ld.STENCIL_BACK_REF=36003,Ld.STENCIL_BACK_VALUE_MASK=36004,Ld.STENCIL_BACK_WRITEMASK=36005,Ld.VIEWPORT=2978,Ld.SCISSOR_BOX=3088,Ld.COLOR_CLEAR_VALUE=3106,Ld.COLOR_WRITEMASK=3107,Ld.UNPACK_ALIGNMENT=3317,Ld.PACK_ALIGNMENT=3333,Ld.MAX_TEXTURE_SIZE=3379,Ld.MAX_VIEWPORT_DIMS=3386,Ld.SUBPIXEL_BITS=3408,Ld.RED_BITS=3410,Ld.GREEN_BITS=3411,Ld.BLUE_BITS=3412,Ld.ALPHA_BITS=3413,Ld.DEPTH_BITS=3414,Ld.STENCIL_BITS=3415,Ld.POLYGON_OFFSET_UNITS=10752,Ld.POLYGON_OFFSET_FACTOR=32824,Ld.TEXTURE_BINDING_2D=32873,Ld.SAMPLE_BUFFERS=32936,Ld.SAMPLES=32937,Ld.SAMPLE_COVERAGE_VALUE=32938,Ld.SAMPLE_COVERAGE_INVERT=32939,Ld.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Ld.COMPRESSED_TEXTURE_FORMATS=34467,Ld.DONT_CARE=4352,Ld.FASTEST=4353,Ld.NICEST=4354,Ld.GENERATE_MIPMAP_HINT=33170,Ld.BYTE=5120,Ld.UNSIGNED_BYTE=5121,Ld.SHORT=5122,Ld.UNSIGNED_SHORT=5123,Ld.INT=5124,Ld.UNSIGNED_INT=5125,Ld.FLOAT=5126,Ld.DEPTH_COMPONENT=6402,Ld.ALPHA=6406,Ld.RGB=6407,Ld.RGBA=6408,Ld.LUMINANCE=6409,Ld.LUMINANCE_ALPHA=6410,Ld.UNSIGNED_SHORT_4_4_4_4=32819,Ld.UNSIGNED_SHORT_5_5_5_1=32820,Ld.UNSIGNED_SHORT_5_6_5=33635,Ld.FRAGMENT_SHADER=35632,Ld.VERTEX_SHADER=35633,Ld.MAX_VERTEX_ATTRIBS=34921,Ld.MAX_VERTEX_UNIFORM_VECTORS=36347,Ld.MAX_VARYING_VECTORS=36348,Ld.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Ld.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Ld.MAX_TEXTURE_IMAGE_UNITS=34930,Ld.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Ld.SHADER_TYPE=35663,Ld.DELETE_STATUS=35712,Ld.LINK_STATUS=35714,Ld.VALIDATE_STATUS=35715,Ld.ATTACHED_SHADERS=35717,Ld.ACTIVE_UNIFORMS=35718,Ld.ACTIVE_ATTRIBUTES=35721,Ld.SHADING_LANGUAGE_VERSION=35724,Ld.CURRENT_PROGRAM=35725,Ld.NEVER=512,Ld.LESS=513,Ld.EQUAL=514,Ld.LEQUAL=515,Ld.GREATER=516,Ld.NOTEQUAL=517,Ld.GEQUAL=518,Ld.ALWAYS=519,Ld.KEEP=7680,Ld.REPLACE=7681,Ld.INCR=7682,Ld.DECR=7683,Ld.INVERT=5386,Ld.INCR_WRAP=34055,Ld.DECR_WRAP=34056,Ld.VENDOR=7936,Ld.RENDERER=7937,Ld.VERSION=7938,Ld.NEAREST=9728,Ld.LINEAR=9729,Ld.NEAREST_MIPMAP_NEAREST=9984,Ld.LINEAR_MIPMAP_NEAREST=9985,Ld.NEAREST_MIPMAP_LINEAR=9986,Ld.LINEAR_MIPMAP_LINEAR=9987,Ld.TEXTURE_MAG_FILTER=10240,Ld.TEXTURE_MIN_FILTER=10241,Ld.TEXTURE_WRAP_S=10242,Ld.TEXTURE_WRAP_T=10243,Ld.TEXTURE_2D=3553,Ld.TEXTURE=5890,Ld.TEXTURE_CUBE_MAP=34067,Ld.TEXTURE_BINDING_CUBE_MAP=34068,Ld.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Ld.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Ld.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Ld.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Ld.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Ld.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Ld.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Ld.TEXTURE0=33984,Ld.TEXTURE1=33985,Ld.TEXTURE2=33986,Ld.TEXTURE3=33987,Ld.TEXTURE4=33988,Ld.TEXTURE5=33989,Ld.TEXTURE6=33990,Ld.TEXTURE7=33991,Ld.TEXTURE8=33992,Ld.TEXTURE9=33993,Ld.TEXTURE10=33994,Ld.TEXTURE11=33995,Ld.TEXTURE12=33996,Ld.TEXTURE13=33997,Ld.TEXTURE14=33998,Ld.TEXTURE15=33999,Ld.TEXTURE16=34e3,Ld.TEXTURE17=34001,Ld.TEXTURE18=34002,Ld.TEXTURE19=34003,Ld.TEXTURE20=34004,Ld.TEXTURE21=34005,Ld.TEXTURE22=34006,Ld.TEXTURE23=34007,Ld.TEXTURE24=34008,Ld.TEXTURE25=34009,Ld.TEXTURE26=34010,Ld.TEXTURE27=34011,Ld.TEXTURE28=34012,Ld.TEXTURE29=34013,Ld.TEXTURE30=34014,Ld.TEXTURE31=34015,Ld.ACTIVE_TEXTURE=34016,Ld.REPEAT=10497,Ld.CLAMP_TO_EDGE=33071,Ld.MIRRORED_REPEAT=33648,Ld.FLOAT_VEC2=35664,Ld.FLOAT_VEC3=35665,Ld.FLOAT_VEC4=35666,Ld.INT_VEC2=35667,Ld.INT_VEC3=35668,Ld.INT_VEC4=35669,Ld.BOOL=35670,Ld.BOOL_VEC2=35671,Ld.BOOL_VEC3=35672,Ld.BOOL_VEC4=35673,Ld.FLOAT_MAT2=35674,Ld.FLOAT_MAT3=35675,Ld.FLOAT_MAT4=35676,Ld.SAMPLER_2D=35678,Ld.SAMPLER_CUBE=35680,Ld.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Ld.VERTEX_ATTRIB_ARRAY_SIZE=34339,Ld.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Ld.VERTEX_ATTRIB_ARRAY_TYPE=34341,Ld.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Ld.VERTEX_ATTRIB_ARRAY_POINTER=34373,Ld.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Ld.COMPILE_STATUS=35713,Ld.LOW_FLOAT=36336,Ld.MEDIUM_FLOAT=36337,Ld.HIGH_FLOAT=36338,Ld.LOW_INT=36339,Ld.MEDIUM_INT=36340,Ld.HIGH_INT=36341,Ld.FRAMEBUFFER=36160,Ld.RENDERBUFFER=36161,Ld.RGBA4=32854,Ld.RGB5_A1=32855,Ld.RGB565=36194,Ld.DEPTH_COMPONENT16=33189,Ld.STENCIL_INDEX=6401,Ld.STENCIL_INDEX8=36168,Ld.DEPTH_STENCIL=34041,Ld.RENDERBUFFER_WIDTH=36162,Ld.RENDERBUFFER_HEIGHT=36163,Ld.RENDERBUFFER_INTERNAL_FORMAT=36164,Ld.RENDERBUFFER_RED_SIZE=36176,Ld.RENDERBUFFER_GREEN_SIZE=36177,Ld.RENDERBUFFER_BLUE_SIZE=36178,Ld.RENDERBUFFER_ALPHA_SIZE=36179,Ld.RENDERBUFFER_DEPTH_SIZE=36180,Ld.RENDERBUFFER_STENCIL_SIZE=36181,Ld.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Ld.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Ld.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Ld.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Ld.COLOR_ATTACHMENT0=36064,Ld.DEPTH_ATTACHMENT=36096,Ld.STENCIL_ATTACHMENT=36128,Ld.DEPTH_STENCIL_ATTACHMENT=33306,Ld.NONE=0,Ld.FRAMEBUFFER_COMPLETE=36053,Ld.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Ld.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Ld.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Ld.FRAMEBUFFER_UNSUPPORTED=36061,Ld.FRAMEBUFFER_BINDING=36006,Ld.RENDERBUFFER_BINDING=36007,Ld.MAX_RENDERBUFFER_SIZE=34024,Ld.INVALID_FRAMEBUFFER_OPERATION=1286,Ld.UNPACK_FLIP_Y_WEBGL=37440,Ld.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Ld.CONTEXT_LOST_WEBGL=37442,Ld.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Ld.BROWSER_DEFAULT_WEBGL=37444,Ld._useProgram=null,Ld._depthTest=!0,Ld._depthMask=!0,Ld._blend=!1,Ld._cullFace=!1,Ld.curBindTexTarget=null,Ld.curBindTexValue=null,Lg(Ld,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Ld}(),Lya=function(La){function Lb(){Lb.__super.call(this)}Lm(Lb,"laya.webgl.display.GraphicsGL",Lj);var Lc=Lb.prototype;return Lc.setShader=function(La){this._saveToCmd(Lr.context._setShader,[La])},Lc.setIBVB=function(La,Lb,Lc,Ld,Le,Lf){this._saveToCmd(Lr.context._setIBVB,[La,Lb,Lc,Ld,Le,Lf])},Lc.drawParticle=function(La,Lb,Lc){var Ld=Lv.createParticleTemplate2D(Lc);Ld.x=La,Ld.y=Lb,this._saveToCmd(Lr.context._drawParticle,[Ld])},Lb}(),Lza=function(La){var Lc;function LP(La){this._x=0,this._y=0,this._id=++LP._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,LP.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=LP.MAXCLIPRECT,this.mOutPoint,this._canvas=La,this._canvas._addReference(),LP._contextcount++,Lr.isFlash?(this._ib=Lwa.create(35044),Lqa.fillIBQuadrangle(this._ib,16)):this._ib=Lwa.QuadrangleIB,this.clear()}Lm(LP,"laya.webgl.canvas.WebGLContext2D",Lh);var Lb=LP.prototype;return Lb.setIsMainContext=function(){this._isMain=!0},Lb.clearBG=function(La,Lb,Lc,Ld){var Le=Lua.mainContext;Le.clearColor(La,Lb,Lc,Ld),Le.clear(16384)},Lb._getSubmits=function(){return this._submits},Lb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var La=0,Lb=this._submits._length;La<Lb;La++)this._submits[La].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Lb.destroy=function(){--LP._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=Lwa.QuadrangleIB&&this._ib.releaseResource()},Lb.clear=function(){this._submits||(this._other=Lc.DEFAULT,this._curMat=LB.create(),this._vb=Lxa.create(-1),this._submits=[],this._save=[LY.Create(this)],this._save.length=10,this._shader2D=new Lw,this._triangleMesh=LKa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=Lc.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=LP.MAXCLIPRECT,this._curSubmit=Lfa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=LT.DEFAULT;for(var La=0,Lb=this._submits._length;La<Lb;La++)this._submits[La].releaseRender(),this._submits[La]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Lb.size=function(La,Lb){if(this._width!=La||this._height!=Lb)if(0==La||0==Lb){0!=this._vb._byteLength&&(this._width=La,this._height=Lb,this._vb.clear(),this._vb.upload());for(var Lc=0,Ld=this._submits._length;Lc<Ld;Lc++)this._submits[Lc].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=La,this._height=Lb,this._targets&&this._targets.size(La,Lb),this._canvas.memorySize-=this._canvas.memorySize;0===La&&0===Lb&&this._releaseMem()},Lb._getTransformMatrix=function(){return this._curMat},Lb.translate=function(La,Lb){0===La&&0===Lb||(L$.save(this),this._curMat.bTransform&&(LZ.save(this),this._curMat.transformPointN(LC.TEMP.setTo(La,Lb)),La=LC.TEMP.x,Lb=LC.TEMP.y),this._x+=La,this._y+=Lb)},Lb.save=function(){this._save[this._save._length++]=LY.Create(this)},Lb.restore=function(){var La=this._save._length;if(!(La<1))for(var Lb=La-1;0<=Lb;Lb--){var Lc=this._save[Lb];if(Lc.restore(this),Lc.isSaveMark())return void(this._save._length=Lb)}},Lb._fillText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){void 0===Lj&&(Lj=0);var Lk=this._shader2D,Ll=this._curSubmit.shaderValue,Lm=Le?Loa.create(Le):this._other.font;if(LQ.enabled)Lk.ALPHA!==Ll.ALPHA&&(Lk.glTexture=null),Lna.drawText(this,La,Lb,this._curMat,Lm,Li||this._other.textAlign,Lf,Lg,Lh,Lc,Ld,Lj);else{this._shader2D.defines.getValue();var Ln=Lf?Lo.create(Lf)._color:Lk.colorAdd;Lk.ALPHA===Ll.ALPHA&&Ln===Lk.colorAdd&&Ll.colorAdd===Lk.colorAdd||(Lk.glTexture=null,Lk.colorAdd=Ln),Lna.drawText(this,La,Lb,this._curMat,Lm,Li||this._other.textAlign,Lf,Lg,Lh,Lc,Ld,Lj)}},Lb.fillWords=function(La,Lb,Lc,Ld,Le,Lf){this._fillText(null,La,Lb,Lc,Ld,Le,null,-1,null,Lf)},Lb.fillBorderWords=function(La,Lb,Lc,Ld,Le,Lf,Lg){this._fillBorderText(null,La,Lb,Lc,Ld,Le,Lf,Lg,null)},Lb.fillText=function(La,Lb,Lc,Ld,Le,Lf){this._fillText(La,null,Lb,Lc,Ld,Le,null,-1,Lf)},Lb.strokeText=function(La,Lb,Lc,Ld,Le,Lf,Lg){this._fillText(La,null,Lb,Lc,Ld,null,Le,Lf||1,Lg)},Lb.fillBorderText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){this._fillBorderText(La,null,Lb,Lc,Ld,Le,Lf,Lg,Lh)},Lb._fillBorderText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){if(!LQ.enabled)return this._fillText(La,Lb,Lc,Ld,Le,null,Lg,Lh||1,Li),void this._fillText(La,Lb,Lc,Ld,Le,Lf,null,-1,Li);var Lj=this._shader2D,Lk=this._curSubmit.shaderValue;Lj.ALPHA!==Lk.ALPHA&&(Lj.glTexture=null);var Ll=Le?(LP._fontTemp.setFont(Le),LP._fontTemp):this._other.font;Lna.drawText(this,La,Lb,this._curMat,Ll,Li||this._other.textAlign,Lf,Lg,Lh||1,Lc,Ld,0)},Lb.fillRect=function(La,Lb,Lc,Ld,Le){var Lf=this._vb;if(Lqa.fillRectImgVb(Lf,this._clipRect,La,Lb,Lc,Ld,LK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Lg=this._shader2D.fillStyle;Le&&(this._shader2D.fillStyle=LT.create(Le));var Lh=this._shader2D,Li=this._curSubmit.shaderValue;if(Lh.fillStyle!==Li.fillStyle||Lh.ALPHA!==Li.ALPHA){Lh.glTexture=null;var Lj=this._curSubmit=Lfa.createSubmit(this,this._ib,Lf,(Lf._byteLength-64)/32*3,LAa.create(2,0));Lj.shaderValue.color=Lh.fillStyle._color._color,Lj.shaderValue.ALPHA=Lh.ALPHA,this._submits[this._submits._length++]=Lj}this._curSubmit._numEle+=6,this._shader2D.fillStyle=Lg}},Lb.fillTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){if(La.loaded&&La.bitmap&&La.source){var Li=this._vb,Lj=La.bitmap.width,Lk=La.bitmap.height,Ll=La.uv,Lm=Lg.x%La.width,Ln=Lg.y%La.height;if(Lj!=Lh.w||Lk!=Lh.h){if(!Lh.w&&!Lh.h)switch(Lh.oy=Lh.ox=0,Lf){case"repeat":Lh.width=Ld,Lh.height=Le;break;case"repeat-x":Lh.width=Ld,Ln<0?La.height+Ln>Le?Lh.height=Le:Lh.height=La.height+Ln:(Lh.oy=Ln,La.height+Ln>Le?Lh.height=Le-Ln:Lh.height=La.height);break;case"repeat-y":Lm<0?La.width+Lm>Ld?Lh.width=Ld:Lh.width=La.width+Lm:(Lh.ox=Lm,La.width+Lm>Ld?Lh.width=Ld-Lm:Lh.width=La.width),Lh.height=Le;break;case"no-repeat":Lm<0?La.width+Lm>Ld?Lh.width=Ld:Lh.width=La.width+Lm:(Lh.ox=Lm,La.width+Lm>Ld?Lh.width=Ld-Lm:Lh.width=La.width),Ln<0?La.height+Ln>Le?Lh.height=Le:Lh.height=La.height+Ln:(Lh.oy=Ln,La.height+Ln>Le?Lh.height=Le-Ln:Lh.height=La.height);break;default:Lh.width=Ld,Lh.height=Le}Lh.w=Lj,Lh.h=Lk,Lh.uv=[0,0,Lh.width/Lj,0,Lh.width/Lj,Lh.height/Lk,0,Lh.height/Lk]}if(Lb+=Lh.ox,Lc+=Lh.oy,Lm-=Lh.ox,Ln-=Lh.oy,Lqa.fillRectImgVb(Li,this._clipRect,Lb,Lc,Lh.width,Lh.height,Lh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Lo=LJa.create(this,this._ib,Li,(Li._byteLength-64)/32*3,LAa.create(256,0)),Lp=(this._submits[this._submits._length++]=Lo).shaderValue;Lp.textureHost=La;var Lq=Ll[0]*Lj,Lr=Ll[1]*Lk,Ls=(Ll[2]-Ll[0])*Lj,Lt=(Ll[5]-Ll[3])*Lk,Lu=-Lm/Lj,Lv=-Ln/Lk;Lp.u_TexRange[0]=Lq/Lj,Lp.u_TexRange[1]=Ls/Lj,Lp.u_TexRange[2]=Lr/Lk,Lp.u_TexRange[3]=Lt/Lk,Lp.u_offset[0]=Lu,Lp.u_offset[1]=Lv,LQ.enabled&&!this._isMain&&Lo.addTexture(La,(Li._byteLength>>2)-16),(this._curSubmit=Lo)._renderType=10017,Lo._numEle+=6}}else this.sprite&&Ly.timer.callLater(this,this._repaintSprite)},Lb.setShader=function(La){LV.save(this,1048576,this._shader2D,!0),this._shader2D.shader=La},Lb.setFilters=function(La){LV.save(this,2097152,this._shader2D,!0),this._shader2D.filters=La,this._curSubmit=Lfa.RENDERBASE,this._renderKey=0,this._drawCount++},Lb.drawTexture=function(La,Lb,Lc,Ld,Le,Lf,Lg){this._drawTextureM(La,Lb,Lc,Ld,Le,Lf,Lg,null,1)},Lb.addTextureVb=function(La,Lb,Lc){var Ld=this._curSubmit._vb||this._vb,Le=Ld._byteLength>>2;Ld.byteLength=Le+16<<2;for(var Lf=Ld.getFloat32Array(),Lg=0;Lg<16;Lg+=4)Lf[Le++]=La[Lg]+Lb,Lf[Le++]=La[Lg+1]+Lc,Lf[Le++]=La[Lg+2],Lf[Le++]=La[Lg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Ld._upload=!0},Lb.willDrawTexture=function(La,Lb){if(!(La.loaded&&La.bitmap&&La.source))return this.sprite&&Ly.timer.callLater(this,this._repaintSprite),0;var Lc=La.bitmap,Ld=Lc.id+this._shader2D.ALPHA*Lb+10016;if(Ld==this._renderKey)return Ld;var Le=this._shader2D,Lf=Le.ALPHA,Lg=this._curSubmit.shaderValue;Le.ALPHA*=Lb,this._renderKey=Ld,this._drawCount++,Le.glTexture=Lc;var Lh=this._vb,Li=null,Lj=Lh._byteLength/32*3,Lk=Lg.textureHost&&Lg.textureHost==La&&Lg.textureHost.alphaTexture==La.alphaTexture;return Li=LJa.create(this,this._ib,Lh,Lj,LAa.create(1,0)),(this._submits[this._submits._length++]=Li).shaderValue.textureHost=La,Li._renderType=10016,Li._preIsSameTextureShader=10016===this._curSubmit._renderType&&Le.ALPHA===Lg.ALPHA&&Lk,this._curSubmit=Li,Le.ALPHA=Lf,Ld},Lb.drawTextures=function(La,Lb,Lc,Ld){if(La.loaded&&La.bitmap&&La.source){var Le=this._clipRect;if(this._clipRect=LP.MAXCLIPRECT,this._drawTextureM(La,Lb[0],Lb[1],La.width,La.height,Lc,Ld,null,1)){if(this._clipRect=Le,LG.drawCall++,!(Lb.length<4)){for(var Lf=this._curSubmit._vb||this._vb,Lg=this._curMat.a,Lh=this._curMat.d,Li=2,Lj=Lb.length;Li<Lj;Li+=2)Lqa.copyPreImgVb(Lf,(Lb[Li]-Lb[Li-2])*Lg,(Lb[Li+1]-Lb[Li-1])*Lh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&Ly.timer.callLater(this,this._repaintSprite)},Lb._drawTextureM=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){if(!La.loaded||!La.source)return this.sprite&&Ly.timer.callLater(this,this._repaintSprite),!1;var Lj=this._curSubmit._vb||this._vb,Lk=La.bitmap;Lb+=Lf,Lc+=Lg,this._drawCount++;var Ll=Lk.id+this._shader2D.ALPHA*Li+10016;if(Ll!=this._renderKey){this._renderKey=Ll;var Lm=this._curSubmit.shaderValue,Ln=this._shader2D,Lo=Ln.ALPHA;Ln.ALPHA*=Li,Ln.glTexture=Lk;var Lp=this._vb,Lq=null,Lr=Lp._byteLength/32*3,Ls=Lm.textureHost&&Lm.textureHost==La&&Lm.textureHost.alphaTexture==La.alphaTexture;Lq=LJa.create(this,this._ib,Lp,Lr,LAa.create(1,0)),(this._submits[this._submits._length++]=Lq).shaderValue.textureHost=La,Lq._renderType=10016,Lq._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ln.ALPHA===Lm.ALPHA&&Ls,this._curSubmit=Lq,Lj=this._curSubmit._vb||this._vb,Ln.ALPHA=Lo}return!!Lqa.fillRectImgVb(Lj,this._clipRect,Lb,Lc,Ld||La.width,Le||La.height,La.uv,Lh||this._curMat,this._x,this._y,0,0)&&(LQ.enabled&&!this._isMain&&this._curSubmit.addTexture(La,(Lj._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Lb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Lb._drawText=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){var Lk=La.bitmap;this._drawCount++;var Ll=Lk.id+this._shader2D.ALPHA+10016;if(Ll!=this._renderKey){this._renderKey=Ll;var Lm=this._curSubmit.shaderValue,Ln=this._shader2D;Ln.glTexture=Lk;var Lo=this._vb,Lp=null,Lq=Lo._byteLength/32*3,Lr=Lm.textureHost&&Lm.textureHost==La&&Lm.textureHost.alphaTexture==La.alphaTexture;(Lp=LQ.enabled?LJa.create(this,this._ib,Lo,Lq,LAa.create(1,0)):LJa.create(this,this._ib,Lo,Lq,L$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ln.ALPHA===Lm.ALPHA&&Lr,(this._submits[this._submits._length++]=Lp).shaderValue.textureHost=La,Lp._renderType=10016,this._curSubmit=Lp}La.active();var Ls=this._curSubmit._vb||this._vb;Lqa.fillRectImgVb(Ls,this._clipRect,Lb+Lg,Lc+Lh,Ld||La.width,Le||La.height,La.uv,Lf||this._curMat,this._x,this._y,Li,Lj,!0)&&(LQ.enabled&&!this._isMain&&this._curSubmit.addTexture(La,(Ls._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Lb.drawTextureWithTransform=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){if(Lf){var Lj=this._curMat,Lk=this._x,Ll=this._y;(0!==Lg||0!==Lh)&&(this._x=Lg*Lj.a+Lh*Lj.c,this._y=Lh*Lj.d+Lg*Lj.b),Lf&&Lj.bTransform?(LB.mul(Lf,Lj,LP._tmpMatrix),(Lf=LP._tmpMatrix)._checkTransform()):(this._x+=Lj.tx,this._y+=Lj.ty),this._drawTextureM(La,Lb,Lc,Ld,Le,0,0,Lf,Li),this._x=Lk,this._y=Ll}else this._drawTextureM(La,Lb,Lc,Ld,Le,Lg,Lh,null,Li)},Lb.fillQuadrangle=function(La,Lb,Lc,Ld,Le){var Lf=this._curSubmit,Lg=this._vb,Lh=this._shader2D,Li=Lf.shaderValue;if(this._renderKey=0,La.bitmap){var Lj=La.bitmap;Lh.glTexture==Lj&&Lh.ALPHA===Li.ALPHA||(Lh.glTexture=Lj,(Lf=this._curSubmit=Lfa.createSubmit(this,this._ib,Lg,Lg._byteLength/32*3,LAa.create(1,0))).shaderValue.glTexture=Lj,this._submits[this._submits._length++]=Lf),Lqa.fillQuadrangleImgVb(Lg,Lb,Lc,Ld,La.uv,Le||this._curMat,this._x,this._y)}else Lf.shaderValue.fillStyle&&Lf.shaderValue.fillStyle.equal(La)&&Lh.ALPHA===Li.ALPHA||(Lh.glTexture=null,(Lf=this._curSubmit=Lfa.createSubmit(this,this._ib,Lg,Lg._byteLength/32*3,LAa.create(2,0))).shaderValue.defines.add(2),Lf.shaderValue.fillStyle=LT.create(La),this._submits[this._submits._length++]=Lf),Lqa.fillQuadrangleImgVb(Lg,Lb,Lc,Ld,LK.DEF_UV,Le||this._curMat,this._x,this._y);Lf._numEle+=6},Lb.drawTexture2=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){if(0!=Lf){var Li=this._curMat;if(this._x=La*Li.a+Lb*Li.c,this._y=Lb*Li.d+La*Li.b,Le&&(Le=Li.bTransform||Le.bTransform?(LB.mul(Le,Li,LP._tmpMatrix),LP._tmpMatrix):(this._x+=Le.tx+Li.tx,this._y+=Le.ty+Li.ty,LB.EMPTY)),1!==Lf||Lg){var Lj=this._shader2D.ALPHA,Lk=this._nBlendType;this._shader2D.ALPHA=Lf,Lg&&(this._nBlendType=LS.TOINT(Lg)),this._drawTextureM(Lh[0],Lh[1]-Lc,Lh[2]-Ld,Lh[3],Lh[4],0,0,Le,1),this._shader2D.ALPHA=Lj,this._nBlendType=Lk}else this._drawTextureM(Lh[0],Lh[1]-Lc,Lh[2]-Ld,Lh[3],Lh[4],0,0,Le,1);this._x=this._y=0}},Lb.drawCanvas=function(La,Lb,Lc,Ld,Le){var Lf=La.context;if(this._renderKey=0,Lf._targets)this._submits[this._submits._length++]=LIa.create(Lf,0,null),this._curSubmit=Lfa.RENDERBASE,Lf._targets.drawTo(this,Lb,Lc,Ld,Le);else{var Lg=this._submits[this._submits._length++]=LIa.create(Lf,this._shader2D.ALPHA,this._shader2D.filters),Lh=Ld/La.width,Li=Le/La.height,Lj=Lg._matrix;this._curMat.copyTo(Lj),1!=Lh&&1!=Li&&Lj.scale(Lh,Li);var Lk=Lj.tx,Ll=Lj.ty;Lj.tx=Lj.ty=0,Lj.transformPoint(LC.TEMP.setTo(Lb,Lc)),Lj.translate(LC.TEMP.x+Lk,LC.TEMP.y+Ll),this._curSubmit=Lfa.RENDERBASE}Lz.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Lf._targets?"yellow":"green",this.strokeRect(Lb-1,Lc-1,Ld+2,Le+2,1),this.strokeRect(Lb,Lc,Ld,Le,1),this.restore())},Lb.drawTarget=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){void 0===Lj&&(Lj=-1);var Lk=this._vb;if(Lqa.fillRectImgVb(Lk,this._clipRect,Lb,Lc,Ld,Le,Li||LK.DEF_UV,Lf||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var Ll=this._curSubmit=Lla.create(this,this._ib,Lk,(Lk._byteLength-64)/32*3,Lh,Lg);Ll.blendType=-1==Lj?this._nBlendType:Lj,Ll.scope=La,this._submits[this._submits._length++]=Ll,this._curSubmit._numEle+=6}},Lb.mixRGBandAlpha=function(La){return this._mixRGBandAlpha(La,this._shader2D.ALPHA)},Lb._mixRGBandAlpha=function(La,Lb){var Lc=(4278190080&La)>>>24;return 0!=Lc?Lc*=Lb:Lc=255*Lb,16777215&La|Lc<<24},Lb.drawTriangles=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){if(!La.loaded||!La.source)return this.sprite&&Ly.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;La.bitmap;var Lk=this._mixRGBandAlpha(4294967295,Lh),Ll=(Ld.length,Lf.length);this._renderKey=-1;var Lm=this._curSubmit=LJa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,LAa.create(1,0));return Lm.shaderValue.textureHost=La,Lm._renderType=10016,this._submits[this._submits._length++]=Lm,Lg?(LP._tmpMatrix.a=Lg.a,LP._tmpMatrix.b=Lg.b,LP._tmpMatrix.c=Lg.c,LP._tmpMatrix.d=Lg.d,LP._tmpMatrix.tx=Lg.tx+Lb,LP._tmpMatrix.ty=Lg.ty+Lc,LB.mul(LP._tmpMatrix,this._curMat,LP._tmpMatrix)):(LP._tmpMatrix.a=this._curMat.a,LP._tmpMatrix.b=this._curMat.b,LP._tmpMatrix.c=this._curMat.c,LP._tmpMatrix.d=this._curMat.d,LP._tmpMatrix.tx=this._curMat.tx+Lb,LP._tmpMatrix.ty=this._curMat.ty+Lc),this._triangleMesh.addData(Ld,Le,Lf,LP._tmpMatrix,Lk,this),this._curSubmit._numEle+=Ll,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Lb.transform=function(La,Lb,Lc,Ld,Le,Lf){LZ.save(this),LB.mul(LB.TEMP.setTo(La,Lb,Lc,Ld,Le,Lf),this._curMat,this._curMat),this._curMat._checkTransform()},Lb.setTransformByMatrix=function(La){La.copyTo(this._curMat)},Lb.transformByMatrix=function(La){LZ.save(this),LB.mul(La,this._curMat,this._curMat),this._curMat._checkTransform()},Lb.rotate=function(La){LZ.save(this),this._curMat.rotateEx(La)},Lb.scale=function(La,Lb){LZ.save(this),this._curMat.scaleEx(La,Lb)},Lb.clipRect=function(La,Lb,Lc,Ld){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var Le=Lka.create(4);this.addRenderObject(Le);var Lf=this._vb,Lg=Lf._byteLength>>2;if(Lqa.fillRectImgVb(Lf,null,La,Lb,Lc,Ld,LK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var Lh=this._curSubmit=Lfa.createSubmit(this,this._ib,Lf,(Lf._byteLength-64)/32*3,LAa.create(2,0));Lh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=Lh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Li=Lka.create(5);this.addRenderObject(Li);var Lj=Lf.getFloat32Array(),Lk=Math.min(Math.min(Math.min(Lj[0+Lg],Lj[4+Lg]),Lj[8+Lg]),Lj[12+Lg]),Ll=Math.max(Math.max(Math.max(Lj[0+Lg],Lj[4+Lg]),Lj[8+Lg]),Lj[12+Lg]),Lm=Math.min(Math.min(Math.min(Lj[1+Lg],Lj[5+Lg]),Lj[9+Lg]),Lj[13+Lg]),Ln=Math.max(Math.max(Math.max(Lj[1+Lg],Lj[5+Lg]),Lj[9+Lg]),Lj[13+Lg]);LX.save(this,Li,La,Lb,Lc,Ld,Lk,Lm,Ll-Lk,Ln-Lm),this._curSubmit=Lfa.RENDERBASE}else{Lc*=this._curMat.a,Ld*=this._curMat.d;var Lo=LC.TEMP;this._curMat.transformPoint(Lo.setTo(La,Lb)),Lc<0&&(Lo.x=Lo.x+Lc,Lc=-Lc),Ld<0&&(Lo.y=Lo.y+Ld,Ld=-Ld),this._renderKey=0;var Lp=this._curSubmit=Lja.create(this);(this._submits[this._submits._length++]=Lp).submitIndex=this._submits._length,Lp.submitLength=9999999,LW.save(this,Lp);var Lq=this._clipRect,Lr=Lq.x,Ls=Lq.y,Lt=Lo.x+Lc,Lu=Lo.y+Ld;Lr<Lo.x&&(Lq.x=Lo.x),Ls<Lo.y&&(Lq.y=Lo.y),Lq.width=Math.min(Lt,Lr+Lq.width)-Lq.x,Lq.height=Math.min(Lu,Ls+Lq.height)-Lq.y,this._shader2D.glTexture=null,Lp.clipRect.copyFrom(Lq),this._curSubmit=Lfa.RENDERBASE}},Lb.setIBVB=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk){if(void 0===Li&&(Li=0),void 0===Lj&&(Lj=0),void 0===Lk&&(Lk=0),null===Lc){if(Lr.isFlash){var Ll=Ld;Ll._selfIB||(Ll._selfIB=Lwa.create(35044)),Ll._selfIB.clear(),Lc=Ll._selfIB}else Lc=this._ib;Lqa.expandIBQuadrangle(Lc,Ld._byteLength/(4*Ld.vertexStride*4))}if(!Lh||!Lg)throw Error("setIBVB must input:shader shaderValues");var Lm=Lia.create(this,Ld,Lc,Le,Lg,Lh,Li,Lj,Lk);Lf||(Lf=LB.EMPTY),Lf.translate(La,Lb),LB.mul(Lf,this._curMat,Lm._mat),Lf.translate(-La,-Lb),this._submits[this._submits._length++]=Lm,this._curSubmit=Lfa.RENDERBASE,this._renderKey=0},Lb.addRenderObject=function(La){this._submits[this._submits._length++]=La},Lb.fillTrangles=function(La,Lb,Lc,Ld,Le){var Lf=this._curSubmit,Lg=this._vb,Lh=this._shader2D,Li=Lf.shaderValue,Lj=Ld.length>>4,Lk=La.bitmap;this._renderKey=0,Lh.glTexture==Lk&&Lh.ALPHA===Li.ALPHA||((Lf=this._curSubmit=Lfa.createSubmit(this,this._ib,Lg,Lg._byteLength/32*3,LAa.create(1,0))).shaderValue.textureHost=La,this._submits[this._submits._length++]=Lf),Lqa.fillTranglesVB(Lg,Lb,Lc,Ld,Le||this._curMat,this._x,this._y),Lf._numEle+=6*Lj},Lb.submitElement=function(La,Lb){var Lc=this._submits;for(Lb<0&&(Lb=Lc._length);La<Lb;)La+=Lc[La].renderSubmit()},Lb.finish=function(){Lua.mainContext.finish()},Lb.flush=function(){var La=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(La>this._ib.bufferLength/12&&Lqa.expandIBQuadrangle(this._ib,La),!this._isMain&&LQ.enabled&&LQ._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=LQ._atlasRestore;for(var Lb=this._submits,Lc=0,Ld=Lb._length;Lc<Ld;Lc++){var Le=Lb[Lc];10016===Le.getRenderType()&&Le.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Lba.instance&&Lba.getInstance().reset();var Lf;for(Lc=0,Lf=this.meshlist.length;Lc<Lf;Lc++){var Lg=this.meshlist[Lc];Lg.canReuse?Lg.releaseMesh():Lg.destroy()}return this.meshlist.length=0,this._curSubmit=Lfa.RENDERBASE,this._renderKey=0,this._triangleMesh=LKa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Lb.setPathId=function(La){if(this.mId=La,-1!=this.mId){this.mHaveKey=!1;var Lb=LM.getInstance();Lb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Lb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Lb.movePath=function(La,Lb){var Lc=La,Ld=Lb;La=this._curMat.a*Lc+this._curMat.c*Ld+this._curMat.tx,Lb=this._curMat.b*Lc+this._curMat.d*Ld+this._curMat.ty,this.mX+=La,this.mY+=Lb},Lb.beginPath=function(){var La=this._getPath();La.tempArray.length=0,La.closePath=!1,this.mX=0,this.mY=0},Lb.closePath=function(){this._path.closePath=!0},Lb.fill=function(La){void 0===La&&(La=!1);var Lb=this._getPath();this.drawPoly(0,0,Lb.tempArray,this.fillStyle._color.numColor,0,0,La)},Lb.stroke=function(){var La=this._getPath();if(0<this.lineWidth){if(-1==this.mId)La.drawLine(0,0,La.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Lb=LM.getInstance().shapeLineDic[this.mId];Lb.rebuild(La.tempArray),La.setGeomtry(Lb)}else LM.getInstance().addLine(this.mId,La.drawLine(0,0,La.tempArray,this.lineWidth,this.strokeStyle._color.numColor));La.update();var Lc=[this.mX,this.mY],Ld=Lfa.createShape(this,La.ib,La.vb,La.count,La.offset,LAa.create(4,0));Ld.shaderValue.ALPHA=this._shader2D.ALPHA,Ld.shaderValue.u_pos=Lc,Ld.shaderValue.u_mmat2=Lsa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Ld,this._renderKey=-1}},Lb.line=function(La,Lb,Lc,Ld,Le,Lf){var Lg=this._curSubmit,Lh=this._vb;if(Lqa.fillLineVb(Lh,this._clipRect,La,Lb,Lc,Ld,Le,Lf)){this._renderKey=0;var Li=this._shader2D,Lj=Lg.shaderValue;Li.strokeStyle===Lj.strokeStyle&&Li.ALPHA===Lj.ALPHA||(Li.glTexture=null,(Lg=this._curSubmit=Lfa.createSubmit(this,this._ib,Lh,(Lh._byteLength-64)/32*3,LAa.create(2,0))).shaderValue.strokeStyle=Li.strokeStyle,Lg.shaderValue.mainID=2,Lg.shaderValue.ALPHA=Li.ALPHA,this._submits[this._submits._length++]=Lg),Lg._numEle+=6}},Lb.moveTo=function(La,Lb,Lc){void 0===Lc&&(Lc=!0);var Ld=this._getPath();if(Lc){var Le=La,Lf=Lb;La=this._curMat.a*Le+this._curMat.c*Lf,Lb=this._curMat.b*Le+this._curMat.d*Lf}Ld.addPoint(La,Lb)},Lb.lineTo=function(La,Lb,Lc){void 0===Lc&&(Lc=!0);var Ld=this._getPath();if(Lc){var Le=La,Lf=Lb;La=this._curMat.a*Le+this._curMat.c*Lf,Lb=this._curMat.b*Le+this._curMat.d*Lf}Ld.addPoint(La,Lb)},Lb.drawCurves=function(La,Lb,Lc){this.setPathId(-1),this.beginPath(),this.strokeStyle=Lc[3],this.lineWidth=Lc[4];var Ld=Lc[2];La+=Lc[0],Lb+=Lc[1],this.movePath(La,Lb),this.moveTo(Ld[0],Ld[1]);for(var Le=2,Lf=Ld.length;Le<Lf;)this.quadraticCurveTo(Ld[Le++],Ld[Le++],Ld[Le++],Ld[Le++]);this.stroke()},Lb.arcTo=function(La,Lb,Lc,Ld,Le){if(-1==this.mId||!this.mHaveKey){var Lf=0,Lg=0,Lh=0,Li=this._getPath();this._curMat.copyTo(LP._tmpMatrix),LP._tmpMatrix.tx=LP._tmpMatrix.ty=0,LP._tempPoint.setTo(Li.getEndPointX(),Li.getEndPointY()),LP._tmpMatrix.invertTransformPoint(LP._tempPoint);var Lj=LP._tempPoint.x-La,Lk=LP._tempPoint.y-Lb,Ll=Math.sqrt(Lj*Lj+Lk*Lk);if(!(Ll<=1e-6)){var Lm=Lj/Ll,Ln=Lk/Ll,Lo=Lc-La,Lp=Ld-Lb,Lq=Lo*Lo+Lp*Lp,Lr=Math.sqrt(Lq);if(!(Lr<=1e-6)){var Ls=Lo/Lr,Lt=Lp/Lr,Lu=Lm+Ls,Lv=Ln+Lt,Ly=Math.sqrt(Lu*Lu+Lv*Lv);if(!(Ly<=1e-6)){var Lz=Lu/Ly,LA=Lv/Ly,LB=Math.acos(Lz*Lm+LA*Ln),LC=Math.PI/2-LB,LD=(Ll=Le/Math.tan(LC))*Lm+La,LE=Ll*Ln+Lb,LF=Math.sqrt(Ll*Ll+Le*Le),LG=La+Lz*LF,LH=Lb+LA*LF,LI=0,LJ=0;if(0<=Lm*Lt-Ln*Ls){var LK=2*LC/LP.SEGNUM;LI=Math.sin(LK),LJ=Math.cos(LK)}else LK=2*-LC/LP.SEGNUM,LI=Math.sin(LK),LJ=Math.cos(LK);Lg=this._curMat.a*LD+this._curMat.c*LE,Lh=this._curMat.b*LD+this._curMat.d*LE,Lg==this._path.getEndPointX()&&Lh==this._path.getEndPointY()||Li.addPoint(Lg,Lh);var LL=LD-LG,LM=LE-LH;for(Lf=0;Lf<LP.SEGNUM;Lf++){var LN=LL*LJ+LM*LI,LO=-LL*LI+LM*LJ;Lg=LN+LG,Lh=LO+LH,La=this._curMat.a*Lg+this._curMat.c*Lh,Lh=Lb=this._curMat.b*Lg+this._curMat.d*Lh,(Lg=La)==this._path.getEndPointX()&&Lh==this._path.getEndPointY()||Li.addPoint(Lg,Lh),LL=LN,LM=LO}}}}}},Lb.arc=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!0),-1!=this.mId){var Lh=LM.getInstance().shapeDic[this.mId];if(Lh&&this.mHaveKey&&!Lh.needUpdate(this._curMat))return;Lb=La=0}var Li,Lj=0,Lk=0,Ll=0,Lm=0,Ln=0,Lo=0,Lp=0;if(Lk=Le-Ld,Lf)if(Math.abs(Lk)>=2*Math.PI)Lk=2*-Math.PI;else for(;0<Lk;)Lk-=2*Math.PI;else if(Math.abs(Lk)>=2*Math.PI)Lk=2*Math.PI;else for(;Lk<0;)Lk+=2*Math.PI;Li=Lk/(Lp=Lc<101?Math.max(10,Lk*Lc/5):Lc<201?Math.max(10,Lk*Lc/20):Math.max(10,Lk*Lc/40))/2,Ll=Math.abs(4/3*(1-Math.cos(Li))/Math.sin(Li)),Lf&&(Ll=-Ll);var Lq=this._getPath(),Lr=NaN,Ls=NaN;for(Lo=0;Lo<=Lp;Lo++)Lj=Ld+Lk*(Lo/Lp),Lm=La+Math.cos(Lj)*Lc,Ln=Lb+Math.sin(Lj)*Lc,Lg&&(Lr=Lm,Ls=Ln,Lm=this._curMat.a*Lr+this._curMat.c*Ls,Ln=this._curMat.b*Lr+this._curMat.d*Ls),Lm==this._path.getEndPointX()&&Ln==this._path.getEndPointY()||Lq.addPoint(Lm,Ln);Lm=La+Math.cos(Le)*Lc,Ln=Lb+Math.sin(Le)*Lc,Lg&&(Lr=Lm,Ls=Ln,Lm=this._curMat.a*Lr+this._curMat.c*Ls,Ln=this._curMat.b*Lr+this._curMat.d*Ls),Lm==this._path.getEndPointX()&&Ln==this._path.getEndPointY()||Lq.addPoint(Lm,Ln)},Lb.quadraticCurveTo=function(La,Lb,Lc,Ld){var Le=Ll.I,Lf=Lc,Lg=Ld;Lc=this._curMat.a*Lf+this._curMat.c*Lg,Ld=this._curMat.b*Lf+this._curMat.d*Lg,Lf=La,Lg=Lb,La=this._curMat.a*Lf+this._curMat.c*Lg,Lb=this._curMat.b*Lf+this._curMat.d*Lg;for(var Lh=Le.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),La,Lb,Lc,Ld],30,2),Li=0,Lj=Lh.length/2;Li<Lj;Li++)this.lineTo(Lh[2*Li],Lh[2*Li+1],!1);this.lineTo(Lc,Ld,!1)},Lb.rect=function(La,Lb,Lc,Ld){this._other=this._other.make(),this._other.path||(this._other.path=new LU),this._other.path.rect(La,Lb,Lc,Ld)},Lb.strokeRect=function(La,Lb,Lc,Ld,Le){var Lf=.5*Le;this.line(La-Lf,Lb,La+Lc+Lf,Lb,Le,this._curMat),this.line(La+Lc,Lb,La+Lc,Lb+Ld,Le,this._curMat),this.line(La,Lb,La,Lb+Ld,Le,this._curMat),this.line(La-Lf,Lb+Ld,La+Lc+Lf,Lb+Ld,Le,this._curMat)},Lb.clip=function(){},Lb.drawPoly=function(La,Lb,Lc,Ld,Le,Lf,Lg){void 0===Lg&&(Lg=!1),this._renderKey=0,this._shader2D.glTexture=null;var Lh=this._getPath();if(-1==this.mId)Lh.polygon(La,Lb,Lc,Ld,Le||1,Lf);else if(this.mHaveKey){var Li=LM.getInstance().shapeDic[this.mId];Li.setMatrix(this._curMat),Li.rebuild(Lh.tempArray),Lh.setGeomtry(Li)}else{var Lj=Lh.polygon(La,Lb,Lc,Ld,Le||1,Lf);LM.getInstance().addShape(this.mId,Lj),Lj.setMatrix(this._curMat)}Lh.update();var Lk,Ll=[this.mX,this.mY];if((Lk=Lfa.createShape(this,Lh.ib,Lh.vb,Lh.count,Lh.offset,LAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Lk.shaderValue.u_pos=Ll,Lk.shaderValue.u_mmat2=Lsa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Lk,0<Le){if(this.mHaveLineKey){var Lm=LM.getInstance().shapeLineDic[this.mId];Lm.rebuild(Lh.tempArray),Lh.setGeomtry(Lm)}else LM.getInstance().addShape(this.mId,Lh.drawLine(La,Lb,Lc,Le,Lf));Lh.update(),(Lk=Lfa.createShape(this,Lh.ib,Lh.vb,Lh.count,Lh.offset,LAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Lk.shaderValue.u_mmat2=Lsa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Lk}},Lb.drawParticle=function(La,Lb,Lc){Lc.x=La,Lc.y=Lb,this._submits[this._submits._length++]=Lc},Lb._getPath=function(){return this._path||(this._path=new LU)},Ld(0,Lb,"globalCompositeOperation",function(){return LS.NAMES[this._nBlendType]},function(La){var Lb=LS.TOINT[La];null==Lb||this._nBlendType===Lb||(LV.save(this,65536,this,!0),this._curSubmit=Lfa.RENDERBASE,this._renderKey=0,this._nBlendType=Lb)}),Ld(0,Lb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(La){this._shader2D.strokeStyle.equal(La)||(LV.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=LT.create(La))}),Ld(0,Lb,"globalAlpha",function(){return this._shader2D.ALPHA},function(La){(La=Math.floor(1e3*La)/1e3)!=this._shader2D.ALPHA&&(LV.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=La)}),Ld(0,Lb,"asBitmap",null,function(La){if(La){if(this._targets||(this._targets=new L_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Ld(0,Lb,"fillStyle",function(){return this._shader2D.fillStyle},function(La){this._shader2D.fillStyle.equal(La)||(LV.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=LT.create(La))}),Ld(0,Lb,"textAlign",function(){return this._other.textAlign},function(La){this._other.textAlign===La||(this._other=this._other.make(),LV.save(this,32768,this._other,!1),this._other.textAlign=La)}),Ld(0,Lb,"lineWidth",function(){return this._other.lineWidth},function(La){this._other.lineWidth===La||(this._other=this._other.make(),LV.save(this,256,this._other,!1),this._other.lineWidth=La)}),Ld(0,Lb,"textBaseline",function(){return this._other.textBaseline},function(La){this._other.textBaseline===La||(this._other=this._other.make(),LV.save(this,16384,this._other,!1),this._other.textBaseline=La)}),Ld(0,Lb,"font",null,function(La){La!=this._other.font.toString()&&(this._other=this._other.make(),LV.save(this,8,this._other,!1),this._other.font===Loa.EMPTY?this._other.font=new Loa(La):this._other.font.setFont(La))}),LP.__init__=function(){Lc.DEFAULT=new Lc},LP._tempPoint=new LC,LP._SUBMITVBSIZE=32e3,LP._MAXSIZE=99999999,LP._RECTVBSIZE=16,LP.MAXCLIPRECT=new LD(0,0,99999999,99999999),LP._COUNT=0,LP._tmpMatrix=new LB,LP.SEGNUM=32,LP._contextcount=0,Lg(LP,["_fontTemp",function(){return this._fontTemp=new Loa},"_drawStyleTemp",function(){return this._drawStyleTemp=new LT(null)}]),LP.__init$=function(){Lc=function(){function La(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=Loa.EMPTY}Lm(La,"");var Lb=La.prototype;return Lb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=Loa.EMPTY},Lb.make=function(){return this===La.DEFAULT?new La:this},La.DEFAULT=null,La}()},LP}(),LAa=function(La){function Ld(La,Lb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Ld.__super.call(this),this.defines=new LEa,this.position=Ld._POSITION,this.mainID=La,this.subID=Lb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.colorMul=Le.ShieldColor?Lo.create(Le.ShieldColor)._color:null,this.glTexture=null,this.u_mmat2=null,this._cacheID=La|Lb,this._inClassCache=Ld._cache[this._cacheID],0<La&&!this._inClassCache&&(this._inClassCache=Ld._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Lm(Ld,"laya.webgl.shader.d2.value.Value2D",LO);var Lb=Ld.prototype;return Lb.setValue=function(La){},Lb.refresh=function(){var La=this.size;return La[0]=Lsa.width,La[1]=Lsa.height,this.alpha=this.ALPHA*Lsa.worldAlpha,this.mmat=Lsa.worldMatrix4,this},Lb._ShaderWithCompile=function(){return LYa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,L_a.create)},Lb._withWorldShaderDefines=function(){var La=Lsa.worldShaderDefines,Lb=LYa.sharders[this.mainID|this.defines._value|La.getValue()];if(!Lb){var Lc,Ld={};for(Lc in this.defines.toNameDic())Ld[Lc]="";for(Lc in La.toNameDic())Ld[Lc]="";Lb=LYa.withCompile2D(0,this.mainID,Ld,this.mainID|this.defines._value|La.getValue(),L_a.create)}var Le=Lsa.worldFilters;if(!Le)return Lb;for(var Lf,Lg=Le.length,Lh=0;Lh<Lg;Lh++)(Lf=Le[Lh])&&Lf.action.setValue(this);return Lb},Lb.upload=function(){var La=Lsa;this.alpha=this.ALPHA*La.worldAlpha,Lsa.worldMatrix4!==Lsa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),Le.ShieldColor&&!this.colorMul?this.colorMul=Le.ShieldColor?Lo.create(Le.ShieldColor)._color:null:!Le.ShieldColor&&this.colorMul&&(this.colorMul=null),this.colorMul?this.defines.add(16384):this.defines.remove(16384),Lua.shaderHighPrecision&&this.defines.add(1024);var Lb,Lc=La.worldShaderDefines?this._withWorldShaderDefines():LYa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=La.width,this.size[1]=La.height,this.mmat=La.worldMatrix4,LLa.activeShader!==Lc?Lc._shaderValueWidth!==La.width||Lc._shaderValueHeight!==La.height?(Lc._shaderValueWidth=La.width,Lc._shaderValueHeight=La.height):Lb=Lc._params2dQuick2||Lc._make2dQuick2():Lc._shaderValueWidth!==La.width||Lc._shaderValueHeight!==La.height?(Lc._shaderValueWidth=La.width,Lc._shaderValueHeight=La.height):Lb=Lc._params2dQuick1||Lc._make2dQuick1(),Lc.upload(this,Lb)},Lb.setFilters=function(La){if(this.filters=La)for(var Lb,Lc=La.length,Ld=0;Ld<Lc;Ld++)(Lb=La[Ld])&&(this.defines.add(Lb.type),Lb.action.setValue(this))},Lb.clear=function(){this.defines.setValue(this.subID)},Lb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Ld._initone=function(La,Lb){Ld._typeClass[La]=Lb,Ld._cache[La]=[],Ld._cache[La]._length=0},Ld.__init__=function(){Ld._POSITION=[2,5126,!1,4*Lpa.BYTES_PE,0],Ld._TEXCOORD=[2,5126,!1,4*Lpa.BYTES_PE,2*Lpa.BYTES_PE],Ld._initone(2,LPa),Ld._initone(4,LSa),Ld._initone(256,LQa),Ld._initone(512,LOa),Ld._initone(1,LRa),Ld._initone(65,L$a),Ld._initone(9,LRa)},Ld.create=function(La,Lb){var Lc=Ld._cache[La|Lb];return Lc._length?Lc[--Lc._length]:new Ld._typeClass[La|Lb](Lb)},Ld._POSITION=null,Ld._TEXCOORD=null,Ld._cache=[],Ld._typeClass=[],Ld.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ld}(),LBa=function(La){function Lq(La,Lb){Lq.__super.call(this,La,Lb)}Lm(Lq,"laya.webgl.utils.RenderSprite3D",Ls);var Lb=Lq.prototype;return Lb.onCreate=function(La){switch(La){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Lb._mask=function(La,Lb,Lc,Ld){var Le,Lf,Lg=this._next,Lh=La.mask;if(Lh){Lb.ctx.save();var Li=Lb.ctx.globalCompositeOperation,Lj=new LD;if(Lj.copyFrom(Lh.getBounds()),Lj.width=Math.round(Lj.width),Lj.height=Math.round(Lj.height),Lj.x=Math.round(Lj.x),Lj.y=Math.round(Lj.y),0<Lj.width&&0<Lj.height){var Lk=La._style._tf,Ll=Lha.create();Ll.addValue("bounds",Lj),Le=Lga.create([Ll,Lb],laya.webgl.utils.RenderSprite3D.tmpTarget),Lb.addRenderObject(Le),Lh.render(Lb,-Lj.x,-Lj.y),Le=Lga.create([Ll],laya.webgl.utils.RenderSprite3D.endTmpTarget),Lb.addRenderObject(Le),Lb.ctx.save(),Lb.clipRect(Lc-Lk.translateX+Lj.x,Ld-Lk.translateY+Lj.y,Lj.width,Lj.height),Lg._fun.call(Lg,La,Lb,Lc,Ld),Lb.ctx.restore(),Lf=Lka.create(6),Li=Lb.ctx.globalCompositeOperation,Lf.blendMode="mask",Lb.addRenderObject(Lf),LB.TEMP.identity();var Lm=LAa.create(1,0),Ln=LK.INV_UV,Lo=Lj.width,Lp=Lj.height;(Lj.width<32||Lj.height<32)&&((Ln=Lq.tempUV)[0]=0,Ln[1]=0,Ln[2]=32<=Lj.width?1:Lj.width/32,Ln[3]=0,Ln[4]=32<=Lj.width?1:Lj.width/32,Ln[5]=32<=Lj.height?1:Lj.height/32,Ln[6]=0,Ln[7]=32<=Lj.height?1:Lj.height/32,Lj.width=32<=Lj.width?Lj.width:32,Lj.height=32<=Lj.height?Lj.height:32,Ln[1]*=-1,Ln[3]*=-1,Ln[5]*=-1,Ln[7]*=-1,Ln[1]+=1,Ln[3]+=1,Ln[5]+=1,Ln[7]+=1),Lb.ctx.drawTarget(Ll,Lc+Lj.x-Lk.translateX,Ld+Lj.y-Lk.translateY,Lo,Lp,LB.TEMP,"tmpTarget",Lm,Ln,6),Le=Lga.create([Ll],laya.webgl.utils.RenderSprite3D.recycleTarget),Lb.addRenderObject(Le),(Lf=Lka.create(6)).blendMode=Li,Lb.addRenderObject(Lf)}Lb.ctx.restore()}else Lg._fun.call(Lg,La,Lb,Lc,Ld)},Lb._blend=function(La,Lb,Lc,Ld){var Le=La._style,Lf=this._next;Le.blendMode?(Lb.ctx.save(),Lb.ctx.globalCompositeOperation=Le.blendMode,Lf._fun.call(Lf,La,Lb,Lc,Ld),Lb.ctx.restore()):Lf._fun.call(Lf,La,Lb,Lc,Ld)},Lb._transform=function(La,Lb,Lc,Ld){var Le=La.transform,Lf=this._next;if(Le&&Lf!=Ls.NORENDER){var Lg=Lb.ctx;La._style;Le.tx=Lc,Le.ty=Ld;var Lh=Lg._getTransformMatrix(),Li=Lh.clone();LB.mul(Le,Lh,Lh),Lh._checkTransform(),Le.tx=Le.ty=0,Lf._fun.call(Lf,La,Lb,0,0),Li.copyTo(Lh),Li.destroy()}else Lf._fun.call(Lf,La,Lb,Lc,Ld)},Lq.tmpTarget=function(La,Lb){var Lc=La.getValue("bounds"),Ld=LMa.create(Lc.width,Lc.height);Ld.start(),Ld.clear(0,0,0,0),La.addValue("tmpTarget",Ld)},Lq.endTmpTarget=function(La){La.getValue("tmpTarget").end()},Lq.recycleTarget=function(La){La.getValue("tmpTarget").recycle(),La.recycle()},Lg(Lq,["tempUV",function(){return this.tempUV=new Array(8)}]),Lq}(),LCa=function(La){function Lb(){this.data=null,Lb.__super.call(this)}Lm(Lb,"laya.filters.webgl.ColorFilterActionGL",LN);var Lc=Lb.prototype;return Ly.imps(Lc,{"laya.filters.IFilterActionGL":!0}),Lc.setValue=function(La){La.colorMat=this.data._mat,La.colorAlpha=this.data._alpha},Lc.apply3d=function(La,Lb,Lc,Ld,Le){var Lf=La.getValue("bounds"),Lg=LAa.create(1,0);Lg.setFilters([this.data]);var Lh=LB.TEMP;Lh.identity(),Lc.ctx.drawTarget(La,0,0,Lf.width,Lf.height,Lh,"src",Lg)},Lb}(),LDa=function(La){function Lf(La,Lb,Lc,Ld,Le){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Lf.__super.call(this,La,Lb,Le),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new LTa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=Lc,this._atlasCanvas.height=Ld,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Lm(Lf,"laya.webgl.atlas.Atlaser",LP);var Lb=Lf.prototype;return Lb.computeUVinAtlasTexture=function(La,Lb,Lc,Ld){var Le=LQ.atlasTextureWidth,Lf=LQ.atlasTextureHeight,Lg=Lc/Le,Lh=Ld/Lf,Li=(Lc+La.bitmap.width)/Le,Lj=(Ld+La.bitmap.height)/Lf,Lk=La.bitmap.width/Le,Ll=La.bitmap.height/Lf;La.uv=[Lg+Lb[0]*Lk,Lh+Lb[1]*Ll,Li-(1-Lb[2])*Lk,Lh+Lb[3]*Ll,Li-(1-Lb[4])*Lk,Lj-(1-Lb[5])*Ll,Lg+Lb[6]*Lk,Lj-(1-Lb[7])*Ll]},Lb.findBitmapIsExist=function(La){if(La instanceof laya.webgl.resource.WebGLImage){var Lb=La,Lc=Lb.url,Ld=this._InAtlasWebGLImagesKey[Lc||Lb.id];if(Ld)return Ld.offsetInfoID}return-1},Lb.addToAtlasTexture=function(La,Lb,Lc){if(La instanceof laya.webgl.resource.WebGLImage){var Ld=La,Le=Ld.url;this._InAtlasWebGLImagesKey[Le||Ld.id]={bitmap:La,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Lb,Lc])}this._atlasCanvas.texSubImage2D(Lb,Lc,La.atlasSource),La.clearAtlasSource()},Lb.addToAtlas=function(La,Lb,Lc){La._atlasID=this._inAtlasTextureKey.length;var Ld=La.uv.slice(),Le=La.bitmap;this._inAtlasTextureKey.push(La),this._inAtlasTextureOriUVValue.push(Ld),this._inAtlasTextureBitmapValue.push(Le),this.computeUVinAtlasTexture(La,Ld,Lb,Lc),La.bitmap=this._atlasCanvas},Lb.clear=function(){for(var La=0,Lb=this._inAtlasTextureKey.length;La<Lb;La++)this._inAtlasTextureKey[La].bitmap=this._inAtlasTextureBitmapValue[La],this._inAtlasTextureKey[La].uv=this._inAtlasTextureOriUVValue[La],this._inAtlasTextureKey[La]._atlasID=-1,this._inAtlasTextureKey[La].bitmap.lock=!1,this._inAtlasTextureKey[La].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Lb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Ld(0,Lb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Ld(0,Lb,"texture",function(){return this._atlasCanvas}),Ld(0,Lb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Lf}(),LEa=function(La){function Lc(){Lc.__super.call(this,Lc.__name2int,Lc.__int2name,Lc.__int2nameMap)}return Lm(Lc,"laya.webgl.shader.d2.ShaderDefines2D",Lx),Lc.__init__=function(){Lc.reg("TEXTURE2D",1),Lc.reg("COLOR2D",2),Lc.reg("PRIMITIVE",4),Lc.reg("GLOW_FILTER",8),Lc.reg("BLUR_FILTER",16),Lc.reg("COLOR_FILTER",32),Lc.reg("COLOR_ADD",64),Lc.reg("WORLDMAT",128),Lc.reg("FILLTEXTURE",256),Lc.reg("FSHIGHPRECISION",1024),Lc.reg("TXTALPHA",2048),Lc.reg("TXTCOMPRESS",4096),Lc.reg("COLORMUL",16384)},Lc.reg=function(La,Lb){Lx._reg(La,Lb,Lc.__name2int,Lc.__int2name)},Lc.toText=function(La,Lb,Lc){return Lx._toText(La,Lb,Lc)},Lc.toInt=function(La){return Lx._toInt(La,Lc.__name2int)},Lc.TEXTURE2D=1,Lc.COLOR2D=2,Lc.PRIMITIVE=4,Lc.FILTERGLOW=8,Lc.FILTERBLUR=16,Lc.FILTERCOLOR=32,Lc.COLORADD=64,Lc.WORLDMAT=128,Lc.FILLTEXTURE=256,Lc.SKINMESH=512,Lc.SHADERDEFINE_FSHIGHPRECISION=1024,Lc.TXTALPHA=2048,Lc.TXTCOMPRESS=4096,Lc.COLORMUL=16384,Lc.__name2int={},Lc.__int2name=[],Lc.__int2nameMap=[],Lc}(),LFa=(function(La){function Lh(La,Lb,Lc,Ld,Le,Lf,Lg){Lh.__super.call(this,La,Lb,Lc,Ld,40,Le,Lf,Lg)}Lm(Lh,"laya.webgl.shapes.Ellipse",Lca)}(),function(La){function Lf(La,Lb,Lc,Ld,Le){this._points=[],this.rebuild(Lc),Lf.__super.call(this,La,Lb,0,0,0,Le,Ld,Le,0)}Lm(Lf,"laya.webgl.shapes.Line",Lca);var Lb=Lf.prototype;return Lb.rebuild=function(La){var Lb=La.length;Lb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Lb/2-1)),this.mFloat32Array=new Float32Array(5*Lb)),this._points.length=0;for(var Lc=NaN,Ld=NaN,Le=-1,Lf=-1,Lg=La.length/2,Lh=0;Lh<Lg;Lh++)Lc=La[2*Lh],Ld=La[2*Lh+1],(.01<Math.abs(Le-Lc)||.01<Math.abs(Lf-Ld))&&this._points.push(Lc,Ld),Le=Lc,Lf=Ld},Lb.getData=function(La,Lb,Lc){var Ld=[],Le=[];0<this.borderWidth&&this.createLine2(this._points,Ld,this.borderWidth,Lc,Le,this._points.length/2),this.mUint16Array.set(Ld,0),this.mFloat32Array.set(Le,0),La.append(this.mUint16Array),Lb.append(this.mFloat32Array)},Lf}()),LGa=function(La){function Ll(La,Lb,Lc,Ld,Le){this._points=[];for(var Lf=NaN,Lg=NaN,Lh=-1,Li=-1,Lj=Lc.length/2-1,Lk=0;Lk<Lj;Lk++)Lf=Lc[2*Lk],Lg=Lc[2*Lk+1],(.01<Math.abs(Lh-Lf)||.01<Math.abs(Li-Lg))&&this._points.push(Lf,Lg),Lh=Lf,Li=Lg;Lf=Lc[2*Lj],Lg=Lc[2*Lj+1],Lh=this._points[0],Li=this._points[1],(.01<Math.abs(Lh-Lf)||.01<Math.abs(Li-Lg))&&this._points.push(Lf,Lg),Ll.__super.call(this,La,Lb,0,0,this._points.length/2,0,Ld,Le)}Lm(Ll,"laya.webgl.shapes.LoopLine",Lca);var Lb=Ll.prototype;return Lb.getData=function(La,Lb,Lc){if(0<this.borderWidth){for(var Ld=this.color,Le=(Ld>>16&255)/255,Lf=(Ld>>8&255)/255,Lg=(255&Ld)/255,Lh=[],Li=0,Lj=0,Lk=[],Ll=Math.floor(this._points.length/2),Lm=0;Lm<Ll;Lm++)Li=this._points[2*Lm],Lj=this._points[2*Lm+1],Lh.push(this.x+Li,this.y+Lj,Le,Lf,Lg);this.createLoopLine(Lh,Lk,this.borderWidth,Lc+Lh.length/5),La.append(new Uint16Array(Lk)),Lb.append(new Float32Array(Lh))}},Lb.createLoopLine=function(La,Lb,Lc,Ld,Le,Lf){La.length;var Lg=La.concat(),Lh=Le||La,Li=this.borderColor,Lj=(Li>>16&255)/255,Lk=(Li>>8&255)/255,Ll=(255&Li)/255,Lm=[Lg[0],Lg[1]],Ln=[Lg[Lg.length-5],Lg[Lg.length-4]],Lo=Ln[0]+.5*(Lm[0]-Ln[0]),Lp=Ln[1]+.5*(Lm[1]-Ln[1]);Lg.unshift(Lo,Lp,0,0,0),Lg.push(Lo,Lp,0,0,0);var Lq,Lr,Ls,Lt,Lu,Lv,Ly,Lz,LA,LB,LC,LD,LE,LF,LG,LH,LI,LJ,LK,LL,LM=Lg.length/5,LN=Ld,LO=Lc/2;Ls=Lg[0],Lt=Lg[1],LB=Ls-(Lu=Lg[5]),LA=(LA=-(Lt-(Lv=Lg[6])))/(LL=Math.sqrt(LA*LA+LB*LB))*LO,LB=LB/LL*LO,Lh.push(Ls-LA,Lt-LB,Lj,Lk,Ll,Ls+LA,Lt+LB,Lj,Lk,Ll);for(var LP=1;LP<LM-1;LP++)Ls=Lg[5*(LP-1)],Lt=Lg[5*(LP-1)+1],Lu=Lg[5*LP],Lv=Lg[5*LP+1],Ly=Lg[5*(LP+1)],Lz=Lg[5*(LP+1)+1],LB=Ls-Lu,LD=Lu-Ly,LG=(-(LA=(LA=-(Lt-Lv))/(LL=Math.sqrt(LA*LA+LB*LB))*LO)+Ls)*(-(LB=LB/LL*LO)+Lv)-(-LA+Lu)*(-LB+Lt),LJ=(-(LC=(LC=-(Lv-Lz))/(LL=Math.sqrt(LC*LC+LD*LD))*LO)+Ly)*(-(LD=LD/LL*LO)+Lv)-(-LC+Lu)*(-LD+Lz),LK=(LE=-LB+Lt-(-LB+Lv))*(LI=-LC+Lu-(-LC+Ly))-(LH=-LD+Lz-(-LD+Lv))*(LF=-LA+Lu-(-LA+Ls)),Math.abs(LK)<.1?(LK+=10.1,Lh.push(Lu-LA,Lv-LB,Lj,Lk,Ll,Lu+LA,Lv+LB,Lj,Lk,Ll)):(((Lq=(LF*LJ-LI*LG)/LK)-Lu)*(Lq-Lu)+((Lr=(LH*LG-LE*LJ)/LK)-Lv)+(Lr-Lv),Lh.push(Lq,Lr,Lj,Lk,Ll,Lu-(Lq-Lu),Lv-(Lr-Lv),Lj,Lk,Ll));Lf&&(Lb=Lf);var LQ=this.edges+1;for(LP=1;LP<LQ;LP++)Lb.push(LN+2*(LP-1),LN+2*(LP-1)+1,LN+2*LP+1,LN+2*LP+1,LN+2*LP,LN+2*(LP-1));return Lb.push(LN+2*(LP-1),LN+2*(LP-1)+1,LN+1,LN+1,LN,LN+2*(LP-1)),Lh},Ll}(),LHa=function(La){function Lg(La,Lb,Lc,Ld,Le,Lf){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=LB.create(),this._points=Lc.slice(0,Lc.length),Lg.__super.call(this,La,Lb,0,0,this._points.length/2,Ld,Le,Lf)}Lm(Lg,"laya.webgl.shapes.Polygon",Lca);var Lb=Lg.prototype;return Lb.rebuild=function(La){this._repaint||(this._points.length=0,this._points=this._points.concat(La))},Lb.setMatrix=function(La){La.copyTo(this._mat)},Lb.needUpdate=function(La){return this._repaint=this._mat.a==La.a&&this._mat.b==La.b&&this._mat.c==La.c&&this._mat.d==La.d&&this._mat.tx==La.tx&&this._mat.ty==La.ty,!this._repaint},Lb.getData=function(La,Lb,Lc){var Ld,Le=0,Lf=this._points,Lg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=Lc){for(this._start=Lc,Ld=[],Lg=this.earcutTriangles.length,Le=0;Le<Lg;Le++)Ld.push(this.earcutTriangles[Le]+Lc);this.mUint16Array=new Uint16Array(Ld)}}else{this._start=Lc,Ld=[];var Lh=[],Li=[],Lj=this.color,Lk=(Lj>>16&255)/255,Ll=(Lj>>8&255)/255,Lm=(255&Lj)/255;for(Lg=Math.floor(Lf.length/2),Le=0;Le<Lg;Le++)Lh.push(this.x+Lf[2*Le],this.y+Lf[2*Le+1],Lk,Ll,Lm),Li.push(this.x+Lf[2*Le],this.y+Lf[2*Le+1]);for(this.earcutTriangles=Lda.earcut(Li,null,2),Lg=this.earcutTriangles.length,Le=0;Le<Lg;Le++)Ld.push(this.earcutTriangles[Le]+Lc);this.mUint16Array=new Uint16Array(Ld),this.mFloat32Array=new Float32Array(Lh)}La.append(this.mUint16Array),Lb.append(this.mFloat32Array)},Lg}(),LIa=function(La){function Lf(){this._matrix=new LB,this._matrix4=Lpa.defaultMatrix4.concat(),Lf.__super.call(this,1e4),this.shaderValue=new LAa(0,0)}Lm(Lf,"laya.webgl.submit.SubmitCanvas",Lfa);var Lb=Lf.prototype;return Lb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var La=Lsa.worldAlpha,Lb=Lsa.worldMatrix4,Lc=Lsa.worldMatrix,Ld=Lsa.worldFilters,Le=Lsa.worldShaderDefines,Lf=this.shaderValue,Lg=this._matrix,Lh=this._matrix4,Li=LB.TEMP;return LB.mul(Lg,Lc,Li),Lh[0]=Li.a,Lh[1]=Li.b,Lh[4]=Li.c,Lh[5]=Li.d,Lh[12]=Li.tx,Lh[13]=Li.ty,Lsa.worldMatrix=Li.clone(),Lsa.worldMatrix4=Lh,Lsa.worldAlpha=Lsa.worldAlpha*Lf.alpha,Lf.filters&&Lf.filters.length&&(Lsa.worldFilters=Lf.filters,Lsa.worldShaderDefines=Lf.defines),this._ctx_src.flush(),Lsa.worldAlpha=La,Lsa.worldMatrix4=Lb,Lsa.worldMatrix.destroy(),Lsa.worldMatrix=Lc,Lsa.worldFilters=Ld,Lsa.worldShaderDefines=Le,1},Lb.releaseRender=function(){var La=Lf._cache;this._ctx_src=null,La[La._length++]=this},Lb.getRenderType=function(){return 10003},Lf.create=function(La,Lb,Lc){var Ld=Lf._cache._length?Lf._cache[--Lf._cache._length]:new Lf;Ld._ctx_src=La;var Le=Ld.shaderValue;return Le.alpha=Lb,Le.defines.setValue(0),Lc&&Lc.length&&Le.setFilters(Lc),Ld},Lf._cache=((Lf._cache=[])._length=0,Lf._cache),Lf}(),LJa=function(La){function Lj(La){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===La&&(La=1e4),Lj.__super.call(this,La)}Lm(Lj,"laya.webgl.submit.SubmitTexture",Lfa);var Lb=Lj.prototype;return Lb.releaseRender=function(){var La=Lj._cache;(La[La._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Lb.addTexture=function(La,Lb){this._texsID[this._texs.length]=La._uvID,this._texs.push(La),this._vbPos.push(Lb)},Lb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var La=this.shaderValue.textureHost.bitmap;if(null!==La)for(var Lb=this._vb.getFloat32Array(),Lc=0,Ld=this._texs.length;Lc<Ld;Lc++){var Le=this._texs[Lc];Le.active();var Lf=Le.uv;if(this._texsID[Lc]!==Le._uvID){this._texsID[Lc]=Le._uvID;var Lg=this._vbPos[Lc];Lb[Lg+2]=Lf[0],Lb[Lg+3]=Lf[1],Lb[Lg+6]=Lf[2],Lb[Lg+7]=Lf[3],Lb[Lg+10]=Lf[4],Lb[Lg+11]=Lf[5],Lb[Lg+14]=Lf[6],Lb[Lg+15]=Lf[7],this._vb.setNeedUpload()}Le.bitmap!==La&&(this._isSameTexture=!1)}}},Lb.renderSubmit=function(){if(0===this._numEle)return Lj._shaderSet=!1,1;var La=this.shaderValue.textureHost;if(La){var Lb=La.source;if(!La.bitmap||!Lb)return Lj._shaderSet=!1,1;this.shaderValue.texture=Lb,La.alphaTexture&&La.alphaTexture.source&&(this.shaderValue.texture1=La.alphaTexture.source)}this._vb.bind_upload(this._ib);var Lc=Lua.mainContext;if(LS.activeBlendFunction!==this._blendFn&&(Lc.enable(3042),this._blendFn(Lc),LS.activeBlendFunction=this._blendFn),LG.drawCall++,LG.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&LLa.activeShader&&Lj._shaderSet?(LLa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&LLa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),Lj._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Ld=La.bitmap,Le=0,Lf=LLa.activeShader,Lg=0,Lh=this._texs.length;Lg<Lh;Lg++){var Li=this._texs[Lg];Li.bitmap===Ld&&Lg+1!==Lh||(Lf.uploadTexture2D(Li.source),Lc.drawElements(4,6*(Lg-Le+1),5123,this._startIdx+6*Le*Lpa.BYTES_PIDX),Ld=Li.bitmap,Le=Lg)}else Lc.drawElements(4,this._numEle,5123,this._startIdx);return 1},Lj.create=function(La,Lb,Lc,Ld,Le){var Lf=Lj._cache._length?Lj._cache[--Lj._cache._length]:new Lj;null==Lc&&((Lc=Lf._selfVb||(Lf._selfVb=Lxa.create(-1))).clear(),Ld=0),Lf._ib=Lb,Lf._vb=Lc,Lf._startIdx=Ld*Lpa.BYTES_PIDX,Lf._numEle=0;var Lg=La._nBlendType;Lf._blendFn=La._targets?LS.targetFns[Lg]:LS.fns[Lg],Lf.shaderValue=Le,Lf.shaderValue.setValue(La._shader2D);var Lh=La._shader2D.filters;return Lh&&Lf.shaderValue.setFilters(Lh),Lf},Lj._cache=((Lj._cache=[])._length=0,Lj._cache),Lj._shaderSet=!0,Lj}(),LKa=function(La){function Lr(){Lr.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Lm(Lr,"laya.webgl.utils.MeshTexture",Lra);var Lb=Lr.prototype;return Lb.addData=function(La,Lb,Lc,Ld,Le,Lf){for(var Lg=La.length/2,Lh=this._vb.needSize(Lg*Lr.const_stride)>>2,Li=this._vb.getFloat32Array(),Lj=0,Lk=0;Lk<Lg;Lk++){var Ll=La[Lj],Lm=La[Lj+1],Ln=Ll*Ld.a+Lm*Ld.c+Ld.tx,Lo=Ll*Ld.b+Lm*Ld.d+Ld.ty;Li[Lh++]=Ln,Li[Lh++]=Lo,Li[Lh++]=Lb[Lj],Li[Lh++]=Lb[Lj+1],Lj+=2}this._vb.setNeedUpload();var Lp=this.vertNum;if(0<Lp){(Lg=Lc.length)>Lr.tmpIdx.length&&(Lr.tmpIdx=new Uint16Array(Lg));for(var Lq=0;Lq<Lg;Lq++)Lr.tmpIdx[Lq]=Lc[Lq]+Lp;this._ib.appendU16Array(Lr.tmpIdx,Lc.length)}else this._ib.append(Lc);this._ib.setNeedUpload(),this.vertNum+=Lg,this.indexNum+=Lc.length},Lb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Lb.destroy=function(){this._ib.destroy(),this._vb.destroy()},Lr.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new Lr},Lr.const_stride=16,Lr._POOL=[],Lg(Lr,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),Lr}(),LLa=function(La){function Lb(){Lb.__super.call(this),this.lock=!0}return Lm(Lb,"laya.webgl.shader.BaseShader",Lt),Lb.activeShader=null,Lb.bindShader=null,Lb}(),LMa=function(Lb){function Lk(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===Lc&&(Lc=6408),void 0===Ld&&(Ld=5121),void 0===Le&&(Le=34041),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=-1),void 0===Li&&(Li=-1),this._type=1,this._w=La,this._h=Lb,this._surfaceFormat=Lc,this._surfaceType=Ld,this._depthStencilFormat=Le,Lr.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Lf,this._repeat=Lg,this._minFifter=Lh,this._magFifter=Li,this._createWebGLRenderTarget(),this.bitmap.lock=!0,Lk.__super.call(this,this.bitmap,LK.INV_UV)}Lm(Lk,"laya.webgl.resource.RenderTarget2D",Lb);var La=Lk.prototype;return Ly.imps(La,{"laya.resource.IDispose":!0}),La.getType=function(){return this._type},La.getTexture=function(){return this},La.size=function(La,Lb){this._w==La&&this._h==Lb||(this._w=La,this._h=Lb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},La.release=function(){this.destroy()},La.recycle=function(){Lk.POOL.push(this)},La.start=function(){var La=Lua.mainContext;return this._preRenderTarget=Lsa.curRenderTarget,Lsa.curRenderTarget=this,La.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(La.viewport(0,0,this._w,this._h),this._svWidth=Lsa.width,this._svHeight=Lsa.height,Lsa.width=this._w,Lsa.height=this._h,LLa.activeShader=null),this},La.clear=function(La,Lb,Lc,Ld){void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=1);var Le=Lua.mainContext;Le.clearColor(La,Lb,Lc,Ld);var Lf=16384;switch(this._depthStencilFormat){case 33189:Lf|=256;break;case 36168:Lf|=1024;break;case 34041:Lf|=256,Lf|=1024}Le.clear(Lf)},La.end=function(){var La=Lua.mainContext;La.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,Lsa.curRenderTarget=this._preRenderTarget,1==this._type?(La.viewport(0,0,this._svWidth,this._svHeight),Lsa.width=this._svWidth,Lsa.height=this._svHeight,LLa.activeShader=null):La.viewport(0,0,Ly.stage.width,Ly.stage.height)},La.getData=function(La,Lb,Lc,Ld){var Le=Lua.mainContext;if(Le.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===Le.checkFramebufferStatus(36160)))return Le.bindFramebuffer(36160,null),null;var Lf=new Uint8Array(this._w*this._h*4);return Le.readPixels(La,Lb,Lc,Ld,this._surfaceFormat,this._surfaceType,Lf),Le.bindFramebuffer(36160,null),Lf},La.destroy=function(La){void 0===La&&(La=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Lb.prototype.destroy.call(this))},La.dispose=function(){},La._createWebGLRenderTarget=function(){this.bitmap=new LWa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(La){this.event("recovered")})},Ld(0,La,"surfaceFormat",function(){return this._surfaceFormat}),Ld(0,La,"magFifter",function(){return this._magFifter}),Ld(0,La,"surfaceType",function(){return this._surfaceType}),Ld(0,La,"mipMap",function(){return this._mipMap}),Ld(0,La,"depthStencilFormat",function(){return this._depthStencilFormat}),Ld(0,La,"minFifter",function(){return this._minFifter}),Ld(0,La,"source",function(){return this._alreadyResolved?Ly.superGet(LK,this,"source"):null}),Lk.create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){void 0===Lc&&(Lc=6408),void 0===Ld&&(Ld=5121),void 0===Le&&(Le=34041),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=-1),void 0===Li&&(Li=-1);var Lj=Lk.POOL.pop();return Lj||(Lj=new Lk(La,Lb)),Lj.bitmap&&Lj._w==La&&Lj._h==Lb&&Lj._surfaceFormat==Lc&&Lj._surfaceType==Ld&&Lj._depthStencilFormat==Le&&Lj._mipMap==Lf&&Lj._repeat==Lg&&Lj._minFifter==Lh&&Lj._magFifter==Li||(Lj._w=La,Lj._h=Lb,Lj._surfaceFormat=Lc,Lj._surfaceType=Ld,Lj._depthStencilFormat=Le,Lr.isConchWebGL&&34041===Lj._depthStencilFormat&&(Lj._depthStencilFormat=33189),Lj._mipMap=Lf,Lj._repeat=Lg,Lj._minFifter=Lh,Lj._magFifter=Li,Lj.release(),Lj._createWebGLRenderTarget()),Lj},Lk.TYPE2D=1,Lk.TYPE3D=2,Lk.POOL=[],Lk}(LK),LNa=function(La){function Lb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Lb.__super.call(this),Lb._gl=Lua.mainContext}Lm(Lb,"laya.webgl.utils.Buffer",Lt);var Lc=Lb.prototype;return Lc._bind=function(){this.activeResource(),Lb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Lb._bindVertexBuffer=this._glBuffer),Lb._gl.bindBuffer(this._bufferType,Lb._bindActive[this._bufferType]=this._glBuffer),LLa.activeShader=null)},Lc.recreateResource=function(){this._glBuffer||(this._glBuffer=Lb._gl.createBuffer()),this.completeCreate()},Lc.disposeResource=function(){this._glBuffer&&(Lua.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Ld(0,Lc,"bufferUsage",function(){return this._bufferUsage}),Lb._gl=null,Lb._bindActive={},Lb._bindVertexBuffer=null,Lb._enableAtributes=[],Lb}(),LOa=function(La){function Lc(La){this.texcoord=null,this.offsetX=300,this.offsetY=0,Lc.__super.call(this,512,0);var Lb=8*Lpa.BYTES_PE;this.position=[2,5126,!1,Lb,0],this.texcoord=[2,5126,!1,Lb,2*Lpa.BYTES_PE],this.color=[4,5126,!1,Lb,4*Lpa.BYTES_PE]}return Lm(Lc,"laya.webgl.shader.d2.skinAnishader.SkinSV",LAa),Lc}(),LPa=function(La){function Lb(La){Lb.__super.call(this,2,0),this.color=[]}return Lm(Lb,"laya.webgl.shader.d2.value.Color2dSV",LAa),Lb.prototype.setValue=function(La){La.fillStyle&&(this.color=La.fillStyle._color._color),La.strokeStyle&&(this.color=La.strokeStyle._color._color)},Lb}(),LQa=function(La){function Lb(La){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=LAa._TEXCOORD,Lb.__super.call(this,256,0)}Lm(Lb,"laya.webgl.shader.d2.value.FillTextureSV",LAa);var Lc=Lb.prototype;return Lc.setValue=function(La){this.ALPHA=La.ALPHA,La.filters&&this.setFilters(La.filters)},Lc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Lb}(),LRa=function(La){function Lb(La){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=LAa._TEXCOORD,void 0===La&&(La=0),Lb.__super.call(this,1,La)}Lm(Lb,"laya.webgl.shader.d2.value.TextureSV",LAa);var Lc=Lb.prototype;return Lc.setValue=function(La){this.ALPHA=La.ALPHA,La.filters&&this.setFilters(La.filters)},Lc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Lb}(),LSa=function(La){function Lb(La){this.a_color=null,this.u_pos=[0,0],Lb.__super.call(this,4,0),this.position=[2,5126,!1,5*Lpa.BYTES_PE,0],this.a_color=[3,5126,!1,5*Lpa.BYTES_PE,2*Lpa.BYTES_PE]}return Lm(Lb,"laya.webgl.shader.d2.value.PrimitiveSV",LAa),Lb}(),LTa=function(La){function Lb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Lb.__super.call(this)}Lm(Lb,"laya.webgl.atlas.AtlasWebGLCanvas",La);var Lc=Lb.prototype;return Lc.recreateResource=function(){var La=Lua.mainContext,Lb=this._source=La.createTexture(),Lc=Lva.curBindTexTarget,Ld=Lva.curBindTexValue;Lva.bindTexture(La,3553,Lb),La.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),La.texParameteri(3553,10241,9729),La.texParameteri(3553,10240,9729),La.texParameteri(3553,10242,33071),La.texParameteri(3553,10243,33071),Lc&&Ld&&Lva.bindTexture(La,Lc,Ld),this.memorySize=this._w*this._h*4,this.completeCreate()},Lc.disposeResource=function(){this._source&&(Lua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Lc.texSubImage2D=function(La,Lb,Lc){if(Lr.isFlash){this._flashCacheImage||(this._flashCacheImage=Lq.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Ld=Lc.bitmapdata;this._flashCacheImage._image.copyPixels(Ld,0,0,Ld.width,Ld.height,La,Lb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var Le=Lua.mainContext,Lf=Lva.curBindTexTarget,Lg=Lva.curBindTexValue;Lva.bindTexture(Le,3553,this._source),Le.pixelStorei(37441,!0),0<=La-1&&Le.texSubImage2D(3553,0,La-1,Lb,6408,5121,Lc),La+1<=this._w&&Le.texSubImage2D(3553,0,La+1,Lb,6408,5121,Lc),0<=Lb-1&&Le.texSubImage2D(3553,0,La,Lb-1,6408,5121,Lc),Lb+1<=this._h&&Le.texSubImage2D(3553,0,La,Lb+1,6408,5121,Lc),Le.texSubImage2D(3553,0,La,Lb,6408,5121,Lc),Le.pixelStorei(37441,!1),Lf&&Lg&&Lva.bindTexture(Le,Lf,Lg)}},Lc.texSubImage2DPixel=function(La,Lb,Lc,Ld,Le){var Lf=Lua.mainContext,Lg=Lva.curBindTexTarget,Lh=Lva.curBindTexValue;Lva.bindTexture(Lf,3553,this._source);var Li=new Uint8Array(Le.data);Lf.pixelStorei(37441,!0),Lf.texSubImage2D(3553,0,La,Lb,Lc,Ld,6408,5121,Li),Lf.pixelStorei(37441,!1),Lg&&Lh&&Lva.bindTexture(Lf,Lg,Lh)},Ld(0,Lc,"width",La.prototype._$get_width,function(La){this._w=La}),Ld(0,Lc,"height",La.prototype._$get_height,function(La){this._h=La}),Lb}(Lc),LUa=function(La){function Le(){this.flipY=!0,this.alwaysChange=!1,Le.__super.call(this)}Lm(Le,"laya.webgl.resource.WebGLCanvas",Lc);var Lb=Le.prototype;return Lb.getCanvas=function(){return this._canvas},Lb.clear=function(){this._ctx&&this._ctx.clear()},Lb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Lb._setContext=function(La){this._ctx=La},Lb.getContext=function(La,Lb){return this._ctx?this._ctx:this._ctx=Le._createContext(this)},Lb.size=function(La,Lb){this._w==La&&this._h==Lb||(this._w=La,this._h=Lb,this._ctx&&this._ctx.size(La,Lb),this._canvas&&(this._canvas.height=Lb,this._canvas.width=La))},Lb.activeResource=function(La){void 0===La&&(La=!1),this._source||this.recreateResource()},Lb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Lb.disposeResource=function(){this._source&&!this.iscpuSource&&(Lua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Lb.createWebGlTexture=function(){var La=Lua.mainContext;this._canvas;var Lb=this._source=La.createTexture();this.iscpuSource=!1;var Lc=Lva.curBindTexTarget,Ld=Lva.curBindTexValue;Lva.bindTexture(La,3553,Lb),La.pixelStorei(37440,this.flipY?1:0),Le.premulAlpha&&La.pixelStorei(37441,!0),La.texImage2D(3553,0,6408,6408,5121,this._imgData),Le.premulAlpha&&La.pixelStorei(37441,!1),La.texParameteri(3553,10240,9729),La.texParameteri(3553,10241,9729),La.texParameteri(3553,10242,33071),La.texParameteri(3553,10243,33071),La.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,Lc&&Ld&&Lva.bindTexture(La,Lc,Ld)},Lb.reloadCanvasData=function(){var La=Lua.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Lb=Lva.curBindTexTarget,Lc=Lva.curBindTexValue;Lva.bindTexture(La,3553,this._source),Le.premulAlpha&&La.pixelStorei(37441,!0),La.texImage2D(3553,0,6408,6408,5121,this._imgData),Le.premulAlpha&&La.pixelStorei(37441,!1),La.pixelStorei(37440,0),Lb&&Lc&&Lva.bindTexture(La,Lb,Lc)},Lb.texSubImage2D=function(La,Lb,Lc){var Ld=Lua.mainContext,Le=Lva.curBindTexTarget,Lf=Lva.curBindTexValue;Lva.bindTexture(Ld,3553,this._source),Ld.pixelStorei(37441,!0),Ld.texSubImage2D(3553,0,Lb,Lc,6408,5121,La._source),Ld.pixelStorei(37441,!1),Le&&Lf&&Lva.bindTexture(Ld,Le,Lf)},Lb.toBase64=function(La,Lb,Lc){var Ld=null;this._canvas&&(Ld=this._canvas.toDataURL(La,Lb)),Lc.call(this,Ld)},Ld(0,Lb,"context",function(){return this._ctx}),Ld(0,Lb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Ld(0,Lb,"asBitmap",null,function(La){this._ctx&&(this._ctx.asBitmap=La)}),Le._createContext=null,Le.premulAlpha=!1,Le}(),LVa=function(La){function Lf(La,Lb){this.CborderSize=12,Lf.__super.call(this),this.char=La,this.isSpace=" "===La,this.xs=Lb.scaleX,this.ys=Lb.scaleY,this.font=Lb.font.toString(),this.fontSize=Lb.font.size,this.fillColor=Lb.fillColor,this.borderColor=Lb.borderColor,this.lineWidth=Lb.lineWidth,this.underLine=Lb.underLine;var Lc,Ld=Lr.isConchApp;Ld?((Lc=ConchTextCanvas)._source=ConchTextCanvas,Lc._source.canvas=ConchTextCanvas):Lc=Ln.canvas.source,this.canvas=Lc,this._enableMerageInAtlas=!0,this._ctx=Ld?Lc:this.canvas.getContext("2d",void 0);var Le=LL.measureText(this.char,this.font);this.cw=Le.width*this.xs,this.ch=(Le.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new LK(this)}Lm(Lf,"laya.webgl.resource.WebGLCharImage",Lc);var Lb=Lf.prototype;return Ly.imps(Lb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Lb.active=function(){this.texture.active()},Lb.recreateResource=function(){var La=Lr.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),La){var Lb=this.fontSize;1==this.xs&&1==this.ys||(Lb=parseInt(Lb*(this.xs>this.ys?this.xs:this.ys)+""));var Lc="normal 100 "+this.font;Lc=Lc.replace(Lf._fontSizeReg,Lb),this.borderColor&&(Lc+=" 1 "+this.borderColor),this._ctx.font=Lc,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,LJ.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Ld=this._ctx.measureText(this.char);Ld||(Ld={width:16});var Le=Ld.width+1;this._ctx.lineTo(Le,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Lb.onresize=function(La,Lb){this._w=La,this._h=Lb,this._allowMerageInAtlas=!0},Lb.clearAtlasSource=function(){},Ld(0,Lb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ld(0,Lb,"atlasSource",function(){return this.canvas}),Ld(0,Lb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(La){this._enableMerageInAtlas=La}),Lf.createOneChar=function(La,Lb){return new Lf(La,Lb)},Lf._fontSizeReg=new RegExp("\\d+(?=px)","g"),Lf}(),LWa=function(La){function Lj(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){void 0===Lc&&(Lc=6408),void 0===Ld&&(Ld=5121),void 0===Le&&(Le=34041),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=-1),void 0===Li&&(Li=1),Lj.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=La,this._h=Lb,this._surfaceFormat=Lc,this._surfaceType=Ld,this._depthStencilFormat=Le,this._mipMap=Lf,this._repeat=Lg,this._minFifter=Lh,this._magFifter=Li}Lm(Lj,"laya.webgl.resource.WebGLRenderTarget",Lc);var Lb=Lj.prototype;return Lb.recreateResource=function(){var La=Lua.mainContext;this._frameBuffer||(this._frameBuffer=La.createFramebuffer()),this._source||(this._source=La.createTexture());var Lb=Lva.curBindTexTarget,Lc=Lva.curBindTexValue;Lva.bindTexture(La,3553,this._source),La.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Ld=this._minFifter,Le=this._magFifter,Lf=this._repeat?10497:33071,Lg=Lk.isPOT(this._w,this._h);if(Lg?(this._mipMap?-1!==Ld||(Ld=9987):-1!==Ld||(Ld=9729),-1!==Le||(Le=9729),La.texParameteri(3553,10241,Ld),La.texParameteri(3553,10240,Le),La.texParameteri(3553,10242,Lf),La.texParameteri(3553,10243,Lf),this._mipMap&&La.generateMipmap(3553)):(-1!==Ld||(Ld=9729),-1!==Le||(Le=9729),La.texParameteri(3553,10241,Ld),La.texParameteri(3553,10240,Le),La.texParameteri(3553,10242,33071),La.texParameteri(3553,10243,33071)),La.bindFramebuffer(36160,this._frameBuffer),La.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=La.createRenderbuffer()),La.bindRenderbuffer(36161,this._depthStencilBuffer),La.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:La.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:La.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:La.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}La.bindFramebuffer(36160,null),Lb&&Lc&&Lva.bindTexture(La,Lb,Lc),La.bindRenderbuffer(36161,null),Lg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Lb.disposeResource=function(){this._frameBuffer&&(Lua.mainContext.deleteTexture(this._source),Lua.mainContext.deleteFramebuffer(this._frameBuffer),Lua.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},Ld(0,Lb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Ld(0,Lb,"frameBuffer",function(){return this._frameBuffer}),Lj}(),LXa=function(La){function Lh(La,Lb,Lc,Ld,Le,Lf,Lg){this.offsetX=0,this.offsetY=0,Lh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Lf,this.canvas=La,this._ctx=La.getContext("2d",void 0),this._w=Ld,this._h=Le,this.offsetX=Lb,this.offsetY=Lc,this.src=Lg,this._enableMerageInAtlas=!0,LQ.enabled&&this._w<LQ.atlasLimitWidth&&this._h<LQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Lm(Lh,"laya.webgl.resource.WebGLSubImage",Lc);var Lb=Lh.prototype;return Ly.imps(Lb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Lb.size=function(La,Lb){this._w=La,this._h=Lb,this._ctx&&this._ctx.size(La,Lb),this.canvas&&(this.canvas.height=Lb,this.canvas.width=La)},Lb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Lb.createWebGlTexture=function(){var La=Lua.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Lb=this._source=La.createTexture(),Lc=Lva.curBindTexTarget,Ld=Lva.curBindTexValue;Lva.bindTexture(La,3553,Lb),La.pixelStorei(37441,!0),La.texImage2D(3553,0,6408,6408,5121,this.canvas),La.pixelStorei(37441,!1);var Le=this.minFifter,Lf=this.magFifter,Lg=this.repeat?10497:33071,Lh=Lk.isPOT(this.width,this.height);Lh?(this.mipmap?-1!==Le||(Le=9987):-1!==Le||(Le=9729),-1!==Lf||(Lf=9729),La.texParameteri(3553,10240,Lf),La.texParameteri(3553,10241,Le),La.texParameteri(3553,10242,Lg),La.texParameteri(3553,10243,Lg),this.mipmap&&La.generateMipmap(3553)):(-1!==Le||(Le=9729),-1!==Lf||(Lf=9729),La.texParameteri(3553,10241,Le),La.texParameteri(3553,10240,Lf),La.texParameteri(3553,10242,33071),La.texParameteri(3553,10243,33071)),Lc&&Ld&&Lva.bindTexture(La,Lc,Ld),this.canvas=null,Lh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Lb.disposeResource=function(){LQ.enabled&&this._allowMerageInAtlas||!this._source||(Lua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Lb.clearAtlasSource=function(){},Ld(0,Lb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ld(0,Lb,"atlasSource",function(){return this.canvas}),Ld(0,Lb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(La){this._allowMerageInAtlas=La}),Lh}(),LYa=function(La){function Lj(La,Lb,Lc,Ld){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,Lj.__super.call(this),!La||!Lb)throw"Shader Error";this._id=++Lj._count,this._vs=La,this._ps=Lb,this._nameMap=Ld||{},null!=Lc&&(Lj.sharders[Lc]=this)}Lm(Lj,"laya.webgl.shader.Shader",LLa);var Lb=Lj.prototype;return Lb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Lb.disposeResource=function(){Lua.mainContext.deleteShader(this._vshader),Lua.mainContext.deleteShader(this._pshader),Lua.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Lb._compile=function(){if(!Lua.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var La=[this._vs,this._ps],Lb=Lua.mainContext;if(this._program=Lb.createProgram(),this._vshader=Lj._createShader(Lb,La[0],35633),this._pshader=Lj._createShader(Lb,La[1],35632),Lb.attachShader(this._program,this._vshader),Lb.attachShader(this._program,this._pshader),Lb.linkProgram(this._program),!Lr.isConchApp&&!Lb.getProgramParameter(this._program,35714))throw Lb.getProgramInfoLog(this._program);var Lc,Ld,Le=0,Lf=0;for(Lf=Lr.isConchApp?Lb.getProgramParameterEx(this._vs,this._ps,"",35721):Lb.getProgramParameter(this._program,35721),Le=0;Le<Lf;Le++){var Lg=null;Lc={vartype:"attribute",glfun:null,ivartype:0,attrib:Lg=Lr.isConchApp?Lb.getActiveAttribEx(this._vs,this._ps,"",Le):Lb.getActiveAttrib(this._program,Le),location:Lb.getAttribLocation(this._program,Lg.name),name:Lg.name,type:Lg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(Lc)}var Lh=0;for(Lh=Lr.isConchApp?Lb.getProgramParameterEx(this._vs,this._ps,"",35718):Lb.getProgramParameter(this._program,35718),Le=0;Le<Lh;Le++){var Li=null;Li=Lr.isConchApp?Lb.getActiveUniformEx(this._vs,this._ps,"",Le):Lb.getActiveUniform(this._program,Le),0<(Lc={vartype:"uniform",glfun:null,ivartype:1,attrib:Lg,location:Lb.getUniformLocation(this._program,Li.name),name:Li.name,type:Li.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Lc.name=Lc.name.substr(0,Lc.name.length-3),Lc.isArray=!0,Lc.location=Lb.getUniformLocation(this._program,Lc.name)),this._params.push(Lc)}for(Le=0,Ld=this._params.length;Le<Ld;Le++)if((Lc=this._params[Le]).indexOfParams=Le,Lc.index=1,Lc.value=[Lc.location,null],Lc.codename=Lc.name,Lc.name=this._nameMap[Lc.codename]?this._nameMap[Lc.codename]:Lc.codename,(this._paramsMap[Lc.name]=Lc)._this=this,Lc.uploadedValue=[],"attribute"!==Lc.vartype)switch(Lc.type){case 5124:Lc.fun=Lc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Lc.fun=Lc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Lc.fun=Lc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Lc.fun=Lc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Lc.fun=Lc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Lc.fun=this._uniform_sampler2D;break;case 35680:Lc.fun=this._uniform_samplerCube;break;case 35676:Lc.glfun=Lb.uniformMatrix4fv,Lc.fun=this._uniformMatrix4fv;break;case 35670:Lc.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else Lc.fun=this._attribute}},Lb.getUniform=function(La){return this._paramsMap[La]},Lb._attribute=function(La,Lb){var Lc=Lua.mainContext,Ld=LNa._enableAtributes,Le=La.location;return Ld[Le]||Lc.enableVertexAttribArray(Le),Lc.vertexAttribPointer(Le,Lb[0],Lb[1],Lb[2],Lb[3],Lb[4]+this._offset),Ld[Le]=LNa._bindVertexBuffer,1},Lb._uniform1f=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb?(Lua.mainContext.uniform1f(La.location,Lc[0]=Lb),1):0},Lb._uniform1fv=function(La,Lb){if(Lb.length<4){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(Lua.mainContext.uniform1fv(La.location,Lb),Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3],1):0}return Lua.mainContext.uniform1fv(La.location,Lb),1},Lb._uniform_vec2=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]?(Lua.mainContext.uniform2f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1]),1):0},Lb._uniform_vec2v=function(La,Lb){if(Lb.length<2){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(Lua.mainContext.uniform2fv(La.location,Lb),Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3],1):0}return Lua.mainContext.uniform2fv(La.location,Lb),1},Lb._uniform_vec3=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]?(Lua.mainContext.uniform3f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2]),1):0},Lb._uniform_vec3v=function(La,Lb){return Lua.mainContext.uniform3fv(La.location,Lb),1},Lb._uniform_vec4=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(Lua.mainContext.uniform4f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3]),1):0},Lb._uniform_vec4v=function(La,Lb){return Lua.mainContext.uniform4fv(La.location,Lb),1},Lb._uniformMatrix2fv=function(La,Lb){return Lua.mainContext.uniformMatrix2fv(La.location,!1,Lb),1},Lb._uniformMatrix3fv=function(La,Lb){return Lua.mainContext.uniformMatrix3fv(La.location,!1,Lb),1},Lb._uniformMatrix4fv=function(La,Lb){return Lua.mainContext.uniformMatrix4fv(La.location,!1,Lb),1},Lb._uniform1i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb?(Lua.mainContext.uniform1i(La.location,Lc[0]=Lb),1):0},Lb._uniform1iv=function(La,Lb){return Lua.mainContext.uniform1iv(La.location,Lb),1},Lb._uniform_ivec2=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]?(Lua.mainContext.uniform2i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1]),1):0},Lb._uniform_ivec2v=function(La,Lb){return Lua.mainContext.uniform2iv(La.location,Lb),1},Lb._uniform_vec3i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]?(Lua.mainContext.uniform3i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2]),1):0},Lb._uniform_vec3vi=function(La,Lb){return Lua.mainContext.uniform3iv(La.location,Lb),1},Lb._uniform_vec4i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(Lua.mainContext.uniform4i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3]),1):0},Lb._uniform_vec4vi=function(La,Lb){return Lua.mainContext.uniform4iv(La.location,Lb),1},Lb._uniform_sampler2D=function(La,Lb){var Lc=Lua.mainContext,Ld=La.uploadedValue;return null==Ld[0]?(Ld[0]=this._curActTexIndex,Lc.uniform1i(La.location,this._curActTexIndex),Lc.activeTexture(Lj._TEXTURES[this._curActTexIndex]),Lva.bindTexture(Lc,3553,Lb),this._curActTexIndex++,1):(Lc.activeTexture(Lj._TEXTURES[Ld[0]]),Lva.bindTexture(Lc,3553,Lb),0)},Lb._uniform_samplerCube=function(La,Lb){var Lc=Lua.mainContext,Ld=La.uploadedValue;return null==Ld[0]?(Ld[0]=this._curActTexIndex,Lc.uniform1i(La.location,this._curActTexIndex),Lc.activeTexture(Lj._TEXTURES[this._curActTexIndex]),Lva.bindTexture(Lc,34067,Lb),this._curActTexIndex++,1):(Lc.activeTexture(Lj._TEXTURES[Ld[0]]),Lva.bindTexture(Lc,34067,Lb),0)},Lb._noSetValue=function(La){console.log("no....:"+La.name)},Lb.uploadOne=function(La,Lb){this.activeResource(),Lva.UseProgram(this._program);var Lc=this._paramsMap[La];Lc.fun.call(this,Lc,Lb)},Lb.uploadTexture2D=function(La){LG.shaderCall++;var Lb=Lua.mainContext;Lb.activeTexture(33984),Lva.bindTexture(Lb,3553,La)},Lb.uploadTexture2D1=function(La){LG.shaderCall++;var Lb=Lua.mainContext;Lb.activeTexture(33985),Lva.bindTexture(Lb,3553,La)},Lb.upload=function(La,Lb){LLa.activeShader=LLa.bindShader=this,this._lastUseFrameCount===LG.loopCount||this.activeResource(),Lva.UseProgram(this._program),this._reCompile?(Lb=this._params,this._reCompile=!1):Lb=Lb||this._params;Lua.mainContext;for(var Lc,Ld,Le=Lb.length,Lf=0,Lg=0;Lg<Le;Lg++)null!==(Ld=La[(Lc=Lb[Lg]).name])&&(Lf+=Lc.fun.call(this,Lc,Ld));LG.shaderCall+=Lf},Lb.uploadArray=function(La,Lb,Lc){LLa.activeShader=this,(LLa.bindShader=this).activeResource(),Lva.UseProgram(this._program);this._params;for(var Ld,Le,Lf=0,Lg=Lb-2;0<=Lg;Lg-=2)(Le=this._paramsMap[La[Lg]])&&null!=(Ld=La[Lg+1])&&(Lc&&Lc[Le.name]&&Lc[Le.name].bind(),Lf+=Le.fun.call(this,Le,Ld));LG.shaderCall+=Lf},Lb.getParams=function(){return this._params},Lj.getShader=function(La){return Lj.sharders[La]},Lj.create=function(La,Lb,Lc,Ld){return new Lj(La,Lb,Lc,Ld)},Lj.withCompile=function(La,Lb,Lc,Ld){if(Lc&&Lj.sharders[Lc])return Lj.sharders[Lc];var Le=Lj._preCompileShader[2e-4*La];if(!Le)throw new Error("withCompile shader err!"+La);return Le.createShader(Lb,Lc,Ld)},Lj.withCompile2D=function(La,Lb,Lc,Ld,Le){if(Ld&&Lj.sharders[Ld])return Lj.sharders[Ld];var Lf=Lj._preCompileShader[2e-4*La+Lb];if(!Lf)throw new Error("withCompile shader err!"+La+" "+Lb);return Lf.createShader(Lc,Ld,Le)},Lj.addInclude=function(La,Lb){Lta.addInclude(La,Lb)},Lj.preCompile=function(La,Lb,Lc,Ld){var Le=2e-4*La;Lj._preCompileShader[Le]=new Lta(Le,Lb,Lc,Ld)},Lj.preCompile2D=function(La,Lb,Lc,Ld,Le){var Lf=2e-4*La+Lb;Lj._preCompileShader[Lf]=new Lta(Lf,Lc,Ld,Le)},Lj._createShader=function(La,Lb,Lc){var Ld=La.createShader(Lc);return La.shaderSource(Ld,Lb),La.compileShader(Ld),Ld},Lj._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],Lj._count=0,Lj._preCompileShader={},Lj.SHADERNAME2ID=2e-4,Lj.sharders=((Lj.sharders=[]).length=32,Lj.sharders),Lg(Lj,["nameKey",function(){return this.nameKey=new LH}]),Lj}(),LZa=function(La){function Lb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Lb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Lm(Lb,"laya.webgl.utils.Buffer2D",La);var Lc=Lb.prototype;return Lc.needSize=function(La){var Lb=this._byteLength;if(La){var Lc=this._byteLength+La;Lc<=this._buffer.byteLength||this._resizeBuffer(Lc<<1,!0),this._byteLength=Lc}return Lb},Lc._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),LG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,LNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),LNa._gl.bufferSubData(this._bufferType,0,this._buffer)},Lc._bufferSubData=function(La,Lb,Lc){if(void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),this._maxsize=Math.max(this._maxsize,this._byteLength),LG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,LNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Lb||Lc){var Ld=this._buffer.slice(Lb,Lc);LNa._gl.bufferSubData(this._bufferType,La,Ld)}else LNa._gl.bufferSubData(this._bufferType,La,this._buffer)},Lc._checkArrayUse=function(){},Lc._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},Lc._bind_subUpload=function(La,Lb,Lc){return void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(La,Lb,Lc),!0)},Lc._resizeBuffer=function(La,Lb){if(La<this._buffer.byteLength)return this;if(this.memorySize=La,Lb&&this._buffer&&0<this._buffer.byteLength){var Lc=new ArrayBuffer(La);new Uint8Array(Lc).set(new Uint8Array(this._buffer),0),this._buffer=Lc}else this._buffer=new ArrayBuffer(La);return this._checkArrayUse(),this._upload=!0,this},Lc.append=function(La){this._upload=!0;var Lb,Lc;Lb=La.byteLength,La instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Lb,!0),Lc=new Uint8Array(this._buffer,this._byteLength)):La instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Lb,!0),Lc=new Uint16Array(this._buffer,this._byteLength)):La instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Lb,!0),Lc=new Float32Array(this._buffer,this._byteLength)),Lc.set(La,0),this._byteLength+=Lb,this._checkArrayUse()},Lc.appendU16Array=function(La,Lb){this._resizeBuffer(this._byteLength+2*Lb,!0);for(var Lc=new Uint16Array(this._buffer,this._byteLength,Lb),Ld=0;Ld<Lb;Ld++)Lc[Ld]=La[Ld];this._byteLength+=2*Lb,this._checkArrayUse()},Lc.appendEx=function(La,Lb){this._upload=!0;var Lc;Lc=La.byteLength,this._resizeBuffer(this._byteLength+Lc,!0),new Lb(this._buffer,this._byteLength).set(La,0),this._byteLength+=Lc,this._checkArrayUse()},Lc.appendEx2=function(La,Lb,Lc,Ld){void 0===Ld&&(Ld=1),this._upload=!0;var Le,Lf;Le=Lc*Ld,this._resizeBuffer(this._byteLength+Le,!0),Lf=new Lb(this._buffer,this._byteLength);var Lg=0;for(Lg=0;Lg<Lc;Lg++)Lf[Lg]=La[Lg];this._byteLength+=Le,this._checkArrayUse()},Lc.getBuffer=function(){return this._buffer},Lc.setNeedUpload=function(){this._upload=!0},Lc.getNeedUpload=function(){return this._upload},Lc.upload=function(){var La=this._bind_upload();return LNa._gl.bindBuffer(this._bufferType,null),LNa._bindActive[this._bufferType]=null,LLa.activeShader=null,La},Lc.subUpload=function(La,Lb,Lc){void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0);var Ld=this._bind_subUpload();return LNa._gl.bindBuffer(this._bufferType,null),LNa._bindActive[this._bufferType]=null,LLa.activeShader=null,Ld},Lc.disposeResource=function(){La.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},Lc.clear=function(){this._byteLength=0,this._upload=!0},Ld(0,Lc,"bufferLength",function(){return this._buffer.byteLength}),Ld(0,Lc,"byteLength",null,function(La){this._byteLength!==La&&(La<=this._buffer.byteLength||this._resizeBuffer(2*La+256,!0),this._byteLength=La)}),Lb.__int__=function(La){Lwa.QuadrangleIB=Lwa.create(35044),Lqa.fillIBQuadrangle(Lwa.QuadrangleIB,16)},Lb.FLOAT32=4,Lb.SHORT=2,Lb}(LNa),L$a=(function(Lb){function Lc(La){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,Lc.__super.call(this,9)}Lm(Lc,"laya.webgl.shader.d2.value.GlowSV",Lb);var La=Lc.prototype;La.setValue=function(La){Lb.prototype.setValue.call(this,La)},La.clear=function(){Lb.prototype.clear.call(this)}}(LRa),function(La){function Lb(La){Lb.__super.call(this,64),this.defines.add(64)}Lm(Lb,"laya.webgl.shader.d2.value.TextSV",La);var Lc=Lb.prototype;return Lc.release=function(){(Lb.pool[Lb._length++]=this).clear()},Lc.clear=function(){La.prototype.clear.call(this)},Lb.create=function(){return Lb._length?Lb.pool[--Lb._length]:new Lb(null)},Lb.pool=[],Lb._length=0,Lb}(LRa)),L_a=function(La){function Le(La,Lb,Lc,Ld){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,Le.__super.call(this,La,Lb,Lc,Ld)}Lm(Le,"laya.webgl.shader.d2.Shader2X",La);var Lb=Le.prototype;return Lb.upload2dQuick1=function(La){this.upload(La,this._params2dQuick1||this._make2dQuick1())},Lb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var La,Lb=this._params,Lc=0,Ld=Lb.length;Lc<Ld;Lc++)La=Lb[Lc],(Lr.isFlash||"size"!==La.name&&"position"!==La.name&&"texcoord"!==La.name)&&this._params2dQuick1.push(La)}return this._params2dQuick1},Lb.disposeResource=function(){La.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Lb.upload2dQuick2=function(La){this.upload(La,this._params2dQuick2||this._make2dQuick2())},Lb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var La,Lb=this._params,Lc=0,Ld=Lb.length;Lc<Ld;Lc++)La=Lb[Lc],(Lr.isFlash||"size"!==La.name)&&this._params2dQuick2.push(La)}return this._params2dQuick2},Le.create=function(La,Lb,Lc,Ld){return new Le(La,Lb,Lc,Ld)},Le}(LYa),Lwa=function(La){function Lb(La){this._uint8Array=null,this._uint16Array=null,void 0===La&&(La=35044),Lb.__super.call(this),this._bufferUsage=La,this._bufferType=34963,Lr.isFlash||(this._buffer=new ArrayBuffer(8))}Lm(Lb,"laya.webgl.utils.IndexBuffer2D",LZa);var Lc=Lb.prototype;return Lc._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},Lc.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},Lc.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},Lc.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Lb.QuadrangleIB=null,Lb.create=function(La){return void 0===La&&(La=35044),new Lb(La)},Lb}(),Lxa=function(La){function Lc(La,Lb){this._floatArray32=null,this._vertexStride=0,Lc.__super.call(this),this._vertexStride=La,this._bufferUsage=Lb,this._bufferType=34962,Lr.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Lm(Lc,"laya.webgl.utils.VertexBuffer2D",La);var Lb=Lc.prototype;return Lb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Lb.bind=function(La){La&&La._bind(),this._bind()},Lb.insertData=function(La,Lb){this.getFloat32Array().set(La,Lb),this._upload=!0},Lb.bind_upload=function(La){La._bind_upload()||La._bind(),this._bind_upload()||this._bind()},Lb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Lb.disposeResource=function(){La.prototype.disposeResource.call(this)},Lb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Ld(0,Lb,"vertexStride",function(){return this._vertexStride}),Lc.create=function(La,Lb){return void 0===Lb&&(Lb=35048),new Lc(La,Lb)},Lc}(LZa),Lab=function(La){function Lh(La,Lb,Lc,Ld,Le,Lf){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===Lc&&(Lc=6408),void 0===Ld&&(Ld=!0),Lh.__super.call(this,La,Lb),La){if(this._format=Lc,this._mipmap=Ld,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof La)this._url=La,this._src=La,this._image=new Ln.window.Image,Lb&&(Lb.onload&&(this.onload=Lb.onload),Lb.onerror&&(this.onerror=Lb.onerror),Lb.onCreate&&Lb.onCreate(this)),this._image.crossOrigin=La&&0==La.indexOf("data:")?null:"",La&&(this._image.src=La);else if(La instanceof ArrayBuffer){this._src=Lb,this._url=this._src;var Lg=new Li(La);Lg.readUTFBytes(4),Lg.readUTFBytes(2),Lg.getInt16();Lg.endian="bigEndian",this._w=Lg.getInt16(),this._h=Lg.getInt16();Lg.getInt16(),Lg.getInt16();this._image=new Uint8Array(La,Lg.pos),this._format=Lua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,LQ.enabled&&this._w<LQ.atlasLimitWidth&&this._h<LQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(La instanceof Uint8Array))return this._src=Lb,this._url=this._src,this._image=La.source||La,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Lb,this._url=this._src,this._w=Le,this._h=Lf,this._image=La,this._format=0===Lc?La.byteLength/(Le*Lf)==4?6408:6407:Lc}this._$5__enableMerageInAtlas=!0}}Lm(Lh,"laya.webgl.resource.WebGLImage",Lq);var Lb=Lh.prototype;return Ly.imps(Lb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Lb._init_=function(La,Lb){},Lb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var La=Lua.mainContext,Lb=this._source=La.createTexture(),Lc=Lva.curBindTexTarget,Ld=Lva.curBindTexValue;Lva.bindTexture(La,3553,Lb);var Le=this.minFifter,Lf=this.magFifter,Lg=this.repeat?10497:33071,Lh=Lk.isPOT(this._w,this._h),Li=!1;switch(Lh?(this.mipmap?-1!==Le||(Le=9987):-1!==Le||(Le=9729),-1!==Lf||(Lf=9729),La.texParameteri(3553,10241,Le),La.texParameteri(3553,10240,Lf),La.texParameteri(3553,10242,Lg),La.texParameteri(3553,10243,Lg),this.mipmap&&La.generateMipmap(3553)):(-1!==Le||(Le=9729),-1!==Lf||(Lf=9729),La.texParameteri(3553,10241,Le),La.texParameteri(3553,10240,Lf),La.texParameteri(3553,10242,33071),La.texParameteri(3553,10243,33071)),La.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&La.pixelStorei(La.UNPACK_ALIGNMENT,1),La.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&La.pixelStorei(La.UNPACK_ALIGNMENT,1),La.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Li=!0,La.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case Lua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Li=!0,La.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}La.pixelStorei(37441,!1),Lc&&Ld&&Lva.bindTexture(La,Lc,Ld),this.uri||(this.uri=this._url),Li?this.memorySize=this._image.length:Lh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Lb.recreateResource=function(){var La=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Lb=this;this._image=new Ln.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Lb._needReleaseAgain)return Lb._needReleaseAgain=!1,Lb._image.onload=null,void(Lb._image=null);Lb._allowMerageInAtlas&&Lb._enableMerageInAtlas?(La.memorySize=0,La._recreateLock=!1):Lb._createWebGlTexture(),Lb.completeCreate()},this._image.src=this._src}},Lb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&Lua.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Lb.onresize=function(){this._w=this._image.width,this._h=this._image.height,LQ.enabled&&this._w<LQ.atlasLimitWidth&&this._h<LQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Lb.clearAtlasSource=function(){this._image=null},Ld(0,Lb,"format",function(){return this._format}),Ld(0,Lb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(La){this._$5__enableMerageInAtlas=La}),Ld(0,Lb,"mipmap",function(){return this._mipmap}),Ld(0,Lb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ld(0,Lb,"atlasSource",function(){return this._image}),Ld(0,Lb,"onload",null,function(La){var Lb=this;this._onload=La,this._image&&(this._image.onload=null!=this._onload?function(){Lb.onresize(),Lb._onload()}:null)}),Ld(0,Lb,"onerror",null,function(La){var Lb=this;this._onerror=La,this._image&&(this._image.onerror=null!=this._onerror?function(){Lb._onerror()}:null)}),Lh}();Ly.__init([Lna,LP,Lza,Lta])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(Lf,La,LT){LT.un,LT.uns;var Ld=LT.static,Le=LT.class,Lg=LT.getset,Lh=(LT.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),Lo=laya.utils.ClassUtils,Ll=(laya.events.Event,laya.utils.HTMLChar),Li=laya.net.Loader,Lj=(laya.display.Node,laya.maths.Rectangle),Lk=laya.renders.Render,Lm=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Ln=laya.utils.Stat,LU=laya.display.Text,Lp=laya.resource.Texture,Lq=laya.net.URL,Lr=laya.utils.Utils,Ls=function(){function Ln(){}return Le(Ln,"laya.html.utils.HTMLParse"),Ln.parse=function(La,Lb,Lc){Lb=(Lb="<root>"+(Lb=Lb.replace(/<br>/g,"<br/>"))+"</root>").replace(Ln.spacePattern,Ln.char255);var Ld=Lr.parseXMLFromString(Lb);Ln._parseXML(La,Ld.childNodes[0].childNodes,Lc)},Ln._parseXML=function(La,Lb,Lc,Ld){var Le=0,Lf=0;if(Lb.join||Lb.item)for(Le=0,Lf=Lb.length;Le<Lf;++Le)Ln._parseXML(La,Lb[Le],Lc,Ld);else{var Lg,Lh,Li;if(3==Lb.nodeType)return void(La instanceof laya.html.dom.HTMLDivElement?(null==Lb.nodeName&&(Lb.nodeName="#text"),Lh=Lb.nodeName.toLowerCase(),0<(Li=Lb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Lg=Lo.getInstance(Lh))&&(La.addChild(Lg),Lg.innerTEXT=Li.replace(Ln.char255AndOneSpacePattern," "))):0<(Li=Lb.textContent.replace(/^\s+|\s+$/g,"")).length&&(La.innerTEXT=Li.replace(Ln.char255AndOneSpacePattern," ")));if("#comment"==(Lh=Lb.nodeName.toLowerCase()))return;if(Lg=Lo.getInstance(Lh)){(Lg=La.addChild(Lg)).URI=Lc,Lg.href=Ld;var Lj=Lb.attributes;if(Lj&&0<Lj.length)for(Le=0,Lf=Lj.length;Le<Lf;++Le){var Lk=Lj[Le],Ll=Lk.nodeName,Lm=Lk.value;Lg._setAttributes(Ll,Lm)}Ln._parseXML(Lg,Lb.childNodes,Lc,Lg.href)}else Ln._parseXML(La,Lb.childNodes,Lc,Ld)}},Ln.char255=String.fromCharCode(255),Ln.spacePattern=/&nbsp;|&#160;/g,Ln.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Ln}(),Lt=function(){function LS(){}return Le(LS,"laya.html.utils.Layout"),LS.later=function(La){null==LS._will&&(LS._will=[],LT.stage.frameLoop(1,null,function(){if(!(LS._will.length<1)){for(var La=0;La<LS._will.length;La++)laya.html.utils.Layout.layout(LS._will[La]);LS._will.length=0}})),LS._will.push(La)},LS.layout=function(La){if(!La||!La._style)return null;if(0==(512&La._style._type))return null;La.getStyle()._type&=-513;var Lb=LS._multiLineLayout(La);return Lk.isConchApp&&La.layaoutCallNative&&La.layaoutCallNative(),Lb},LS._multiLineLayout=function(La){if(LU.RightToLeft)return LS._multiLineLayout2(La);var Lb=new Array;La._addChildsToLayout(Lb);var Lc,Ld,Le,Lf,Lg,Lh=0,Li=Lb.length,Lj=La._getCSSStyle(),Lk=Lj.letterSpacing,Ll=Lj.leading,Lm=Lj.lineHeight,Ln=Lj._widthAuto()||!Lj.wordWrap,Lo=Ln?999999:La.width,Lp=(La.height,0),Lq=Lj.italic?Lj.fontSize/3:0,Lr=Lj._getAlign(),Ls=Lj._getValign(),Lt=0!==Ls||0!==Lr||0!=Lm,Lu=0,Lv=0,Ly=0,Lz=0,LA=new Array,LB=LA[0]=new LV,LC=!1,LD=!1;LB.h=0,Lj.italic&&(Lo-=Lj.fontSize/3);var LE=0,LF=!0;function LG(){LB.y=Lv,Lv+=LB.h+Ll,0==LB.h&&(Lv+=Lm),LB.mWidth=LE,LE=0,LB=new LV,LA.push(LB),LB.h=0,LC=!(LF=!(Lu=0))}if(LU.WordSplitArr&&LU.WordSplitArr.length){var LH,LI=[],LJ=[],LK=0,LL=0,LM=0;for(Lh=0;Lh<Li;Lh++)if(LH=Lb[Lh],LJ.push(LH),LH?(LM+=LL=LH instanceof laya.html.dom.HTMLBrElement?0:LH._isChar()?LH.width+Lk:(Le=LH._getCSSStyle().padding,LH.width*LH._style._tf.scaleX+Le[1]+Le[3]+Lk),LK+=LL,LH&&LH instanceof laya.html.dom.HTMLBrElement||LH&&"\n"===LH.char||Lh==Li-1?(LI.push(LJ),LJ=[],LM=0):-1!=LT.Text.WordSplitArr.indexOf(LH.char)&&(LI.push(LJ),LJ=[],LM=0)):(LM+=LS.DIV_ELEMENT_PADDING,LK+=LS.DIV_ELEMENT_PADDING),LH&&LH instanceof laya.html.dom.HTMLBrElement||LH&&"\n"===LH.char||Lh==Li-1||Lo<LK){LK=LM;for(var LN=0;LN<LI.length;LN++)for(var LO=0;LO<LI[LN].length;LO++)null!=(Lc=LI[LN][LO])?(LF=!1,Lc instanceof laya.html.dom.HTMLBrElement?LB.y=Lv:(Lc._isChar()?((Lf=Lc).isWord?LB.wordStartIndex=LB.elements.length:(Ly=Lf.width+Lf.style.letterSpacing,LE+=Lf.width),Ly=Lf.width+Lk,Lz=Lf.height,LB.minTextHeight=Math.min(LB.minTextHeight,Lc.height)):(Ld=Lc._getCSSStyle(),Lg=Lc,Le=Ld.padding,0===Ld._getCssFloat()||(Lt=!0),LC=LD||Ld.lineElement,Ly=Lg.width*Lg._style._tf.scaleX+Le[1]+Le[3]+Lk,Lz=Lg.height*Lg._style._tf.scaleY+Le[0]+Le[2]),LB.elements.push(Lc),LB.h=Math.max(LB.h,Lz),Lc.x=Lu,Lc.y=Lv,Lu+=Ly,LB.w=Lu-Lk,LB.y=Lv,Lp=Math.max(Lu+Lq,Lp))):(LF||(Lu+=LS.DIV_ELEMENT_PADDING),LB.wordStartIndex=LB.elements.length);LI=[],Lh<Li-1&&LG()}}else for(Lh=0;Lh<Li;Lh++)if(null!=(Lc=Lb[Lh]))if(LF=!1,Lc instanceof laya.html.dom.HTMLBrElement)LG(),LB.y=Lv;else{if(Lc._isChar()){if((Lf=Lc).isWord)LC=LD||"\n"===Lf.char,LB.wordStartIndex=LB.elements.length;else{if(Ly=Lf.width+Lf.style.letterSpacing,0<LA.length&&Lo<Lu+Ly&&0<LB.wordStartIndex){var LP;LP=LB.elements.length-LB.wordStartIndex+1,LB.elements.length=LB.wordStartIndex,Lh-=LP,LG();continue}LC=!1,LE+=Lf.width}Ly=Lf.width+Lk,Lz=Lf.height,LD=!1,(LC=LC||Lo<Lu+Ly)&&LG(),LB.minTextHeight=Math.min(LB.minTextHeight,Lc.height)}else Ld=Lc._getCSSStyle(),Lg=Lc,Le=Ld.padding,0===Ld._getCssFloat()||(Lt=!0),LC=LD||Ld.lineElement,Ly=Lg.width*Lg._style._tf.scaleX+Le[1]+Le[3]+Lk,Lz=Lg.height*Lg._style._tf.scaleY+Le[0]+Le[2],LD=Ld.lineElement,(LC=LC||Lo<Lu+Ly&&Ld.wordWrap)&&LG();LB.elements.push(Lc),LB.h=Math.max(LB.h,Lz),Lc.x=Lu,Lc.y=Lv,Lu+=Ly,LB.w=Lu-Lk,LB.y=Lv,Lp=Math.max(Lu+Lq,Lp)}else LF||(Lu+=LS.DIV_ELEMENT_PADDING),LB.wordStartIndex=LB.elements.length;if(Lv=LB.y+LB.h,Lt){var LQ=0,LR=Lo;for(Ln&&0<La.width&&(LR=La.width),Lh=0,Li=LA.length;Lh<Li;Lh++)LA[Lh].updatePos(0,LR,Lh,LQ,Lr,Ls,Lm),LQ+=Math.max(Lm,LA[Lh].h+Ll);Lv=LQ}return Ln&&(La.width=Lp),Lv>La.height&&(La.height=Lv),[Lp,Lv]},LS._multiLineLayout2=function(La){var Lb=new Array;La._addChildsToLayout(Lb);var Lc,Ld,Le,Lf,Lg,Lh=0,Li=Lb.length,Lj=La._getCSSStyle(),Lk=Lj.letterSpacing,Ll=Lj.leading,Lm=Lj.lineHeight,Ln=Lj._widthAuto()||!Lj.wordWrap,Lo=Ln?999999:La.width,Lp=(La.height,0),Lq=Lj.italic?Lj.fontSize/3:0,Lr=2-Lj._getAlign(),Ls=Lj._getValign(),Lt=0!==Ls||0!=Lr||0!=Lm,Lu=0,Lv=0,Ly=0,Lz=0,LA=new Array,LB=LA[0]=new LV,LC=!1,LD=!1;LB.h=0,Lj.italic&&(Lo-=Lj.fontSize/3);var LE=0,LF=!0;function LG(){LB.y=Lv,Lv+=LB.h+Ll,0==LB.h&&(Lv+=Lm),LB.mWidth=LE,LE=0,LB=new LV,LA.push(LB),LB.h=0,LC=!(LF=!(Lu=0))}if(LU.WordSplitArr&&LU.WordSplitArr.length){var LH,LI=[],LJ=[],LK=0,LL=0,LM=0;for(Lh=0;Lh<Li;Lh++)if(LH=Lb[Lh],LJ.push(LH),LH?(LM+=LL=LH instanceof laya.html.dom.HTMLBrElement?0:LH._isChar()?LH.width+Lk:(Le=LH._getCSSStyle().padding,LH.width*LH._style._tf.scaleX+Le[1]+Le[3]+Lk),LK+=LL,LH&&LH instanceof laya.html.dom.HTMLBrElement||LH&&"\n"===LH.char||Lh==Li-1?(LI.push(LJ),LJ=[],LM=0):-1!=LT.Text.WordSplitArr.indexOf(LH.char)&&(LI.push(LJ),LJ=[],LM=0)):(LM+=LS.DIV_ELEMENT_PADDING,LK+=LS.DIV_ELEMENT_PADDING),LH&&LH instanceof laya.html.dom.HTMLBrElement||LH&&"\n"===LH.char||Lh==Li-1||Lo<LK){LK=LM;for(var LN=0;LN<LI.length;LN++)for(var LO=0;LO<LI[LN].length;LO++)null!=(Lc=LI[LN][LO])?(LF=!1,Lc instanceof laya.html.dom.HTMLBrElement?LB.y=Lv:(Lc._isChar()?((Lf=Lc).isWord?LB.wordStartIndex=LB.elements.length:(Ly=Lf.width+Lf.style.letterSpacing,LE+=Lf.width),Ly=Lf.width+Lk,Lz=Lf.height,LB.minTextHeight=Math.min(LB.minTextHeight,Lc.height)):(Ld=Lc._getCSSStyle(),Lg=Lc,Le=Ld.padding,0===Ld._getCssFloat()||(Lt=!0),LC=LD||Ld.lineElement,Ly=Lg.width*Lg._style._tf.scaleX+Le[1]+Le[3]+Lk,Lz=Lg.height*Lg._style._tf.scaleY+Le[0]+Le[2]),LB.elements.push(Lc),LB.h=Math.max(LB.h,Lz),Lc.x=Lu,Lc.y=Lv,Lu+=Ly,LB.w=Lu-Lk,LB.y=Lv,Lp=Math.max(Lu+Lq,Lp))):(LF||(Lu+=LS.DIV_ELEMENT_PADDING),LB.wordStartIndex=LB.elements.length);LI=[],Lh<Li-1&&LG()}}else for(Lh=0;Lh<Li;Lh++)if(null!=(Lc=Lb[Lh]))if(LF=!1,Lc instanceof laya.html.dom.HTMLBrElement)LG(),LB.y=Lv;else{if(Lc._isChar()){if((Lf=Lc).isWord)LC=LD||"\n"===Lf.char,LB.wordStartIndex=LB.elements.length;else{if(0<LA.length&&Lo<Lu+Ly&&0<LB.wordStartIndex){var LP;LP=LB.elements.length-LB.wordStartIndex+1,LB.elements.length=LB.wordStartIndex,Lh-=LP,LG();continue}LC=!1,LE+=Lf.width}Ly=Lf.width+Lk,Lz=Lf.height,LD=!1,(LC=LC||Lo<Lu+Ly)&&LG(),LB.minTextHeight=Math.min(LB.minTextHeight,Lc.height)}else Ld=Lc._getCSSStyle(),Lg=Lc,Le=Ld.padding,0===Ld._getCssFloat()||(Lt=!0),LC=LD||Ld.lineElement,Ly=Lg.width*Lg._style._tf.scaleX+Le[1]+Le[3]+Lk,Lz=Lg.height*Lg._style._tf.scaleY+Le[0]+Le[2],LD=Ld.lineElement,(LC=LC||Lo<Lu+Ly&&Ld.wordWrap)&&LG();LB.elements.push(Lc),LB.h=Math.max(LB.h,Lz),Lc.x=Lu,Lc.y=Lv,Lu+=Ly,LB.w=Lu-Lk,LB.y=Lv,Lp=Math.max(Lu+Lq,Lp)}else LF||(Lu+=LS.DIV_ELEMENT_PADDING),LB.wordStartIndex=LB.elements.length;if(Lv=LB.y+LB.h,Lt){var LQ=0,LR=Lo;for(Lh=0,Li=LA.length;Lh<Li;Lh++)LA[Lh].updatePos(0,LR,Lh,LQ,Lr,Ls,Lm),LQ+=Math.max(Lm,LA[Lh].h+Ll);Lv=LQ}for(Ln&&(La.width=Lp),Lv>La.height&&(La.height=Lv),Lh=0,Li=LA.length;Lh<Li;Lh++)LA[Lh].revertOrder(Lo);return[Lp,Lv]},LS._will=null,LS.DIV_ELEMENT_PADDING=0,LS}(),LV=function(){function La(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}Le(La,"laya.html.utils.LayoutLine");var Lb=La.prototype;return Lb.updatePos=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh,Li=0;0<this.elements.length&&(Li=(Lh=this.elements[this.elements.length-1]).x+Lh.width-this.elements[0].x);var Lj=0,Lk=NaN;1===Le&&(Lj=(Lb-Li)/2),2===Le&&(Lj=Lb-Li),0===Lg||0!=Lf||(Lf=1);for(var Ll=0,Lm=this.elements.length;Ll<Lm;Ll++){var Ln=(Lh=this.elements[Ll])._getCSSStyle();switch(0!==Lj&&(Lh.x+=Lj),Ln._getValign()){case 0:Lh.y=Ld;break;case 1:var Lo=0;99999!=this.minTextHeight&&(Lo=this.minTextHeight);var Lp=(Lo+Lg)/2;Lp=Math.max(Lp,this.h),Lk=(laya.html.dom.HTMLImageElement,Ld+Lp-Lh.height),Lh.y=Lk;break;case 2:Lh.y=Ld+(Lg-Lh.height)}}},Lb.revertOrder=function(La){var Lb;if(0<this.elements.length){var Lc,Ld=0;for(Lc=this.elements.length,Ld=0;Ld<Lc;Ld++)(Lb=this.elements[Ld]).x=La-Lb.x-Lb.width}},La}(),Lu=function(Lc){function Lb(){this.URI=null,this._href=null,Lb.__super.call(this),this._text=Lb._EMPTYTEXT,this.setStyle(new Lh(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}Le(Lb,"laya.html.dom.HTMLElement",Lc);var La=Lb.prototype;return La.layaoutCallNative=function(){var La=0;if(this._childs&&0<(La=this._childs.length))for(var Lb=0;Lb<La;Lb++)this._childs[Lb].layaoutCallNative&&this._childs[Lb].layaoutCallNative();var Lc=this._getWords();Lc?laya.html.dom.HTMLElement.fillWords(this,Lc,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},La.appendChild=function(La){return this.addChild(La)},La._getWords2=function(){var La=this._text.text;if(!La||0===La.length)return null;var Lb,Lc,Ld=0,Le=0;if(this._text.drawWords)Lc=this._text.drawWords;else{for(Le=(Lb=La.split(" ")).length-1,Lc=[],Ld=0;Ld<Le;Ld++)Lc.push(Lb[Ld]," ");0<=Le&&Lc.push(Lb[Le]),this._text.drawWords=Lc}var Lf,Lg=this._text.words;if(Lg&&Lg.length===Lc.length)return Lg;null===Lg&&(this._text.words=Lg=[]),Lg.length=Lc.length;var Lh=this.style,Li=Lh.font;for(Ld=0,Le=Lc.length;Ld<Le;Ld++){Lf=Lr.measureText(Lc[Ld],Li);var Lj=Lg[Ld]=new Ll(Lc[Ld],Lf.width,Lf.height||Lh.fontSize,Lh);if(1<Lj.char.length&&(Lj.charNum=Lj.char),this.href){var Lk=new Lm;this.addChild(Lk),Lj.setSprite(Lk)}}return Lg},La._getWords=function(){if(!LU.CharacterCache)return this._getWords2();var La=this._text.text;if(!La||0===La.length)return null;var Lb,Lc=this._text.words;if(Lc&&Lc.length===La.length)return Lc;null===Lc&&(this._text.words=Lc=[]),Lc.length=La.length;for(var Ld=this.style,Le=Ld.font,Lf=0,Lg=La.length;Lf<Lg;Lf++)if(Lb=Lr.measureText(La.charAt(Lf),Le)){var Lh=Lc[Lf]=new Ll(La.charAt(Lf),Lb.width,Lb.height||Ld.fontSize,Ld);if(this.href){var Li=new Lm;this.addChild(Li),Lh.setSprite(Li)}}else console.warn("_getWords size is null"+La.charAt(Lf),Le);return Lc},La.showLinkSprite=function(){var La=this._text.words;if(La)for(var Lb,Lc,Ld=[],Le=0;Le<La.length;Le++)Lc=La[Le],(Lb=new Lm).graphics.drawRect(0,0,Lc.width,Lc.height,"#ff0000"),Lb.width=Lc.width,Lb.height=Lc.height,this.addChild(Lb),Ld.push(Lb)},La._layoutLater=function(){var La=this.style;512&La._type||(La.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&La.block?(Lt.later(this),La._type|=512):this.parent&&this.parent._layoutLater())},La._setAttributes=function(La,Lb){switch(La){case"style":return void this.style.cssText(Lb);case"class":return void(this.className=Lb)}Lc.prototype._setAttributes.call(this,La,Lb)},La.updateHref=function(){if(null!=this._href){var La=this._getWords();if(La)for(var Lb,Lc,Ld=0;Ld<La.length;Ld++)(Lc=(Lb=La[Ld]).getSprite())&&(Lc.size(Lb.width,Lb.height),Lc.on("click",this,this.onLinkHandler))}},La.onLinkHandler=function(La){switch(La.type){case"click":for(var Lb=this;Lb;)Lb.event("link",[this.href]),Lb=Lb.parent}},La.formatURL=function(La){return this.URI?Lq.formatURL(La,this.URI?this.URI.path:null):La},Lg(0,La,"href",function(){return this._href},function(La){null!=(this._href=La)&&(this._getCSSStyle().underLine=1,this.updateHref())}),Lg(0,La,"color",null,function(La){this.style.color=La}),Lg(0,La,"onClick",null,function(La){LT._runScript("fn=function(event){"+La+";}"),this.on("click",this,void 0)}),Lg(0,La,"id",null,function(La){Lv.document.setElementById(La,this)}),Lg(0,La,"innerTEXT",function(){return this._text.text},function(La){this.text=La}),Lg(0,La,"style",function(){return this._style}),Lg(0,La,"text",function(){return this._text.text},function(La){this._text==Lb._EMPTYTEXT?this._text={text:La,words:null}:(this._text.text=La,this._text.words&&(this._text.words.length=0)),Lk.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),Lg(0,La,"parent",Lc.prototype._$get_parent,function(La){if(La instanceof laya.html.dom.HTMLElement){var Lb=La;this.URI||(this.URI=Lb.URI),this.style.inherit(Lb.style)}LT.superSet(Lm,this,"parent",La)}),Lg(0,La,"className",null,function(La){this.style.attrs(Lv.document.styleSheets["."+La])}),Lb.fillWords=function(La,Lb,Lc,Ld,Le,Lf,Lg){La.graphics.clear();for(var Lh=0,Li=Lb.length;Lh<Li;Lh++){var Lj=Lb[Lh];La.graphics.fillText(Lj.char,Lj.x+Lc,Lj.y+Ld,Le,Lf,"left",Lg)}},Lb._EMPTYTEXT={text:null,words:null},Lb}(Lm),Lb=(function(La){function Lb(){Lb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}Le(Lb,"laya.html.dom.HTMLBrElement",Lu)}(),function(La){function Lb(){this.contextHeight=NaN,this.contextWidth=NaN,Lb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}Le(Lb,"laya.html.dom.HTMLDivElement",La);var Lc=Lb.prototype;return Lc.appendHTML=function(La){Ls.parse(this,La,this.URI),this.layout()},Lc._addChildsToLayout=function(Lb){var La=this._getWords();if(null==La&&0==this._childs.length)return!1;La&&La.forEach(function(La){Lb.push(La)});for(var Lc=!0,Ld=0,Le=this._childs.length;Ld<Le;Ld++){var Lf=this._childs[Ld];Lc?Lc=!1:Lb.push(null),Lf._addToLayout(Lb)}return!0},Lc._addToLayout=function(La){this.layout()},Lc.layout=function(){if(this.style){this.style._type|=512;var La=Lt.layout(this);if(La){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new Lj);var Lb=this._$P.mHtmlBounds;Lb.x=Lb.y=0,Lb.width=this.contextWidth=La[0],Lb.height=this.contextHeight=La[1],this.setBounds(Lb)}}},Lg(0,Lc,"height",function(){return this._height?this._height:this.contextHeight},La.prototype._$set_height),Lg(0,Lc,"innerHTML",null,function(La){this.destroyChildren(),this.appendHTML(La)}),Lg(0,Lc,"width",function(){return this._width?this._width:this.contextWidth},function(La){var Lb=!1;Lb=0===La?La!=this._width:La!=this.width,LT.superSet(Lu,this,"width",La),Lb&&this.layout()}),Lb}(Lu)),Lv=function(La){function Lb(){this.all=new Array,this.styleSheets=Lh.styleSheets,Lb.__super.call(this)}Le(Lb,"laya.html.dom.HTMLDocument",Lu);var Lc=Lb.prototype;return Lc.getElementById=function(La){return this.all[La]},Lc.setElementById=function(La,Lb){this.all[La]=Lb},Ld(Lb,["document",function(){return this.document=new Lb}]),Lb}();(function(La){function Lb(){this._tex=null,this._url=null,this._renderArgs=[],Lb.__super.call(this),this.style.block=!0}Le(Lb,"laya.html.dom.HTMLImageElement",Lu);var Lc=Lb.prototype;Lc._addToLayout=function(La){!this._style.absolute&&La.push(this)},Lc.render=function(La,Lb,Lc){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Ln.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,La.ctx.drawTexture2(Lb,Lc,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},Lc.layaoutCallNative=function(){var La=0;if(this._childs&&0<(La=this._childs.length))for(var Lb=0;Lb<La;Lb++)this._childs[Lb].layaoutCallNative&&this._childs[Lb].layaoutCallNative()},Lg(0,Lc,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(La){this._width!==La&&(this._width=La,this._style.width=La,this.repaint())}),Lg(0,Lc,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(La){this._height!==La&&(this._height=La,this._style.height=La,this.repaint())}),Lc.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),Li.clearCache(this,this._url),this._tex=null),Lu.prototype.destroy.call(this)},Lc.onloaded=function(){var La=this._style;La&&!La.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),La&&!La.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Lk.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},Lc._loadImageComplete=function(La,Lb,Lc){if(!this._destroyed)if(null!=Lc)if(Lc instanceof ArrayBuffer){var Ld=new DataView(Lc);new laya.webgl.resource.WebGLImage(new Uint8Array(Lc,8),La,0,!1,Ld.getUint32(0),Ld.getUint32(4));this.onloaded()}else if(Lc instanceof Lp)Li.imgMgrSet[La]=Lb,Lf.imgMgrLock(La,Li.imgMgrSet[La]),this._url=La,this._tex=Lc,Li.keepCache(this,La),Li.cacheRes(La,this._tex),this.onloaded();else{var Le=-1!=La.indexOf(".png",La.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(Lc,La,Le,!1,Lc.width,Lc.height);this.onloaded()}else this.event("error","Load image failed")},Lg(0,Lc,"src",null,function(La){(La=this.formatURL(La),this._url!=La)&&(null!=this._tex&&(Li.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=La,(this._tex=Li.getRes(La))?(Li.keepCache(this,La),this.onloaded()):Lf.imgMgrLoad(La,this._loadImageComplete.bind(this),2,!1))})})(),function(La){function Lb(){this.type=null,Lb.__super.call(this),this.visible=!1}Le(Lb,"laya.html.dom.HTMLLinkElement",La);var Lc=Lb.prototype;Lc._onload=function(La){switch(this.type){case"text/css":Lh.parseCSS(La,this.URI)}},Lg(0,Lc,"href",La.prototype._$get_href,function(La){var Lb=this;La=this.formatURL(La),this.URI=new Lq(La);var Lc=new Li;Lc.once("complete",null,function(La){Lb._onload(La)}),Lc.load(La,"text")}),Lb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(Lu),function(La){function Lb(){Lb.__super.call(this),this.visible=!1}Le(Lb,"laya.html.dom.HTMLStyleElement",La),Lg(0,Lb.prototype,"text",La.prototype._$get_text,function(La){Lh.parseCSS(La,null)})}(Lu),function(La){function Lb(){Lb.__super.call(this),this._getCSSStyle().valign="middle"}Le(Lb,"laya.html.dom.HTMLIframeElement",La),Lg(0,Lb.prototype,"href",La.prototype._$get_href,function(Lc){var Ld=this;Lc=this.formatURL(Lc);var La=new Li;La.once("complete",null,function(La){var Lb=Ld.URI;Ld.URI=new Lq(Lc),Ld.innerHTML=La,!Lb||(Ld.URI=Lb)}),La.load(Lc,"text")})}(Lb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(Le,La,Lp){Lp.un,Lp.uns;var Ld=Lp.static,Lf=Lp.class,Lg=Lp.getset,Lc=(Lp.__newvec,laya.display.Animation),Lq=(laya.utils.Browser,laya.utils.ClassUtils),Lh=laya.filters.ColorFilter,Li=laya.utils.Ease,Lj=laya.events.Event,Lk=(laya.events.EventDispatcher,laya.display.css.Font),Ll=laya.display.FrameAnimation,Lb=laya.display.Graphics,Lm=laya.utils.Handler,Ln=laya.display.Input,Ls=laya.net.Loader,Lo=(laya.display.Node,laya.maths.Point),Lr=laya.maths.Rectangle,Lt=laya.renders.Render,Lu=laya.display.Sprite,Lv=laya.display.Text,Ly=laya.resource.Texture,Lz=laya.utils.Tween,LA=laya.utils.Utils,LB=laya.utils.WeakObject;Lp.interface("laya.ui.IItem"),Lp.interface("laya.ui.ISelect"),Lp.interface("laya.ui.IRender"),Lp.interface("laya.ui.IComponent"),Lp.interface("laya.ui.IBox","IComponent");var LC=function(){function La(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Lf(La,"laya.ui.LayoutStyle"),Ld(La,["EMPTY",function(){return this.EMPTY=new La}]),La}(),LD=function(){function La(){}return Lf(La,"laya.ui.Styles"),La.labelColor="#000000",La.buttonStateNum=3,La.scrollBarMinNum=15,La.scrollBarDelayTime=500,Ld(La,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),La}(),LE=function(){function Le(){}return Lf(Le,"laya.ui.UIUtils"),Le.fillArray=function(La,Lb,Lc){var Ld=La.concat();if(Lb)for(var Le=Lb.split(","),Lf=0,Lg=Math.min(Ld.length,Le.length);Lf<Lg;Lf++){var Lh=Le[Lf];Ld[Lf]="true"==Lh||"false"!=Lh&&Lh,null!=Lc&&(Ld[Lf]=Lc(Lh))}return Ld},Le.toColor=function(La){return LA.toHexColor(La)},Le.gray=function(La,Lb){void 0===Lb&&(Lb=!0),Lb?Le.addFilter(La,Le.grayFilter):Le.clearFilter(La,Lh)},Le.addFilter=function(La,Lb){var Lc=La.filters||[];Lc.push(Lb),La.filters=Lc},Le.clearFilter=function(La,Lb){var Lc=La.filters;if(null!=Lc&&0<Lc.length){for(var Ld=Lc.length-1;-1<Ld;Ld--){var Le=Lc[Ld];Lp.__typeof(Le,Lb)&&Lc.splice(Ld,1)}La.filters=Lc}},Le._getReplaceStr=function(La){return Le.escapeSequence[La]},Le.adptString=function(La){return La.replace(/\\(\w)/g,Le._getReplaceStr)},Le.getBindFun=function(La){var Lb=Le._funMap.get(La);if(null==Lb){var Lc='"'+La+'"',Ld="(function(data){if(data==null)return;with(data){try{\nreturn "+(Lc=Lc.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Lb=Lp._runScript(Ld),Le._funMap.set(La,Lb)}return Lb},Ld(Le,["grayFilter",function(){return this.grayFilter=new Lh([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new LB}]),Le}(),LF=function(){function La(){}return Lf(La,"UIConfig"),La.touchScrollEnable=!0,La.mouseWheelEnable=!0,La.showButtons=!0,La.popupBgColor="#000000",La.popupBgAlpha=.5,La.closeDialogOnSide=!0,La}(),LG=function(Lc){function Lr(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,Lr.__super.call(this),this._weakKeys=[]}Lf(Lr,"laya.ui.AutoBitmap",Lc);var La=Lr.prototype;return La.destroy=function(){if(Ls.clearObject(this,this._weakKey),this._weakKeys){for(var La=0,Lb=this._weakKeys.length;La<Lb;++La)Ls.clearObject(this,this._weakKeys[La]);this._weakKeys=null}Lc.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},La._setChanged=function(){this._isChanged||(this._isChanged=!0,Lp.timer.callLater(this,this.changeSource))},La.changeSource=function(){this._isChanged=!1;var La=this._source;if(La&&La.bitmap){var Lb=this.width,Lc=this.height,Ld=this._sizeGrid,Le=La.sourceWidth,Lf=La.sourceHeight;if(!Ld||Le===Lb&&Lf===Lc)this.cleanByTexture(La,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Lb,Lc);else{Ls.clearObject(this,this._weakKey),La.$_GID||(La.$_GID=LA.getGID());var Lg=La.$_GID+"."+Lb+"."+Lc+"."+Ld.join("."),Lh=Ls.findObject(Lg);if(LA.isOKCmdList(Lh))return this._weakKey=Lg,Ls.keepObject(this,this._weakKey),void(this.cmds=Lh);this.clear();var Li,Lj,Lk=Ld[0],Ll=Ld[1],Lm=Ld[2],Ln=Ld[3],Lo=Ld[4],Lp=!1;if(Lb==Le&&(Ln=Ll=0),Lc==Lf&&(Lk=Lm=0),Lb<Ln+Ll){var Lq=Lb;Lp=!0,Lb=Ln+Ll,this.save(),this.clipRect(0,0,Lq,Lc)}Ln&&Lk&&(Li=Lr.getTexture(La,0,0,Ln,Lk),Lj=this._weakKeys[0],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[0]=Li.weakKey),this.drawTexture(Li,0,0,Ln,Lk)):(Ls.clearObject(this,Lj),this._weakKeys[0]="")),Ll&&Lk&&(Li=Lr.getTexture(La,Le-Ll,0,Ll,Lk),Lj=this._weakKeys[1],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[1]=Li.weakKey),this.drawTexture(Li,Lb-Ll,0,Ll,Lk)):(Ls.clearObject(this,Lj),this._weakKeys[1]="")),Ln&&Lm&&(Li=Lr.getTexture(La,0,Lf-Lm,Ln,Lm),Lj=this._weakKeys[2],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[2]=Li.weakKey),this.drawTexture(Li,0,Lc-Lm,Ln,Lm)):(Ls.clearObject(this,Lj),this._weakKeys[2]="")),Ll&&Lm&&(Li=Lr.getTexture(La,Le-Ll,Lf-Lm,Ll,Lm),Lj=this._weakKeys[3],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[3]=Li.weakKey),this.drawTexture(Li,Lb-Ll,Lc-Lm,Ll,Lm)):(Ls.clearObject(this,Lj),this._weakKeys[3]="")),Lk&&(Li=Lr.getTexture(La,Ln,0,Le-Ln-Ll,Lk),Lj=this._weakKeys[4],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[4]=Li.weakKey),this.drawBitmap(Lo,Li,Ln,0,Lb-Ln-Ll,Lk)):(Ls.clearObject(this,Lj),this._weakKeys[4]="")),Lm&&(Li=Lr.getTexture(La,Ln,Lf-Lm,Le-Ln-Ll,Lm),Lj=this._weakKeys[5],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[5]=Li.weakKey),this.drawBitmap(Lo,Li,Ln,Lc-Lm,Lb-Ln-Ll,Lm)):(Ls.clearObject(this,Lj),this._weakKeys[5]="")),Ln&&(Li=Lr.getTexture(La,0,Lk,Ln,Lf-Lk-Lm),Lj=this._weakKeys[6],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[6]=Li.weakKey),this.drawBitmap(Lo,Li,0,Lk,Ln,Lc-Lk-Lm)):(Ls.clearObject(this,Lj),this._weakKeys[6]="")),Ll&&(Li=Lr.getTexture(La,Le-Ll,Lk,Ll,Lf-Lk-Lm),Lj=this._weakKeys[7],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[7]=Li.weakKey),this.drawBitmap(Lo,Li,Lb-Ll,Lk,Ll,Lc-Lk-Lm)):(Ls.clearObject(this,Lj),this._weakKeys[7]="")),Li=Lr.getTexture(La,Ln,Lk,Le-Ln-Ll,Lf-Lk-Lm),Lj=this._weakKeys[8],Li?(Lj!=Li.weakKey&&(Ls.clearObject(this,Lj),Ls.keepObject(this,Li.weakKey),this._weakKeys[8]=Li.weakKey),this.drawBitmap(Lo,Li,Ln,Lk,Lb-Ln-Ll,Lc-Lk-Lm)):(Ls.clearObject(this,Lj),this._weakKeys[8]=""),Lp&&this.restore(),this.autoCacheCmd&&!Lt.isConchApp&&(Ls.saveObject(Lg,this.cmds,null),this._weakKey=Lg,Ls.keepObject(this,this._weakKey))}this._repaint()}},La.drawBitmap=function(La,Lb,Lc,Ld,Le,Lf){void 0===Le&&(Le=0),void 0===Lf&&(Lf=0),Le<.1||Lf<.1||(!La||Lb.width==Le&&Lb.height==Lf?this.drawTexture(Lb,Lc,Ld,Le,Lf):this.fillTexture(Lb,Lc,Ld,Le,Lf))},La.clear=function(La){void 0===La&&(La=!0),Lc.prototype.clear.call(this,!1)},Lg(0,La,"sizeGrid",function(){return this._sizeGrid},function(La){this._sizeGrid=La,this._setChanged()}),Lg(0,La,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(La){this._width!=La&&(this._width=La,this._setChanged())}),Lg(0,La,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(La){this._height!=La&&(this._height=La,this._setChanged())}),Lg(0,La,"source",function(){return this._source},function(La){La?(this._source=La,this._setChanged()):(this._source=null,this.clear())}),Lr.getTexture=function(La,Lb,Lc,Ld,Le){Ld<=0&&(Ld=1),Le<=0&&(Le=1),La.$_GID||(La.$_GID=LA.getGID());var Lf=La.$_GID+"."+Lb+"."+Lc+"."+Ld+"."+Le,Lg=Ls.findObject(Lf);if((!Lg||!Lg.source)&&(Lg=Ly.createFromTexture(La,Lb,Lc,Ld,Le))){if(La.alphaTexture){var Lh=La.width/La.alphaTexture.width;Lg.alphaTexture=Ly.createFromTexture(La.alphaTexture,Lb/Lh,Lc/Lh,Ld/Lh,Le/Lh)}Ls.saveObject(Lf,Lg),Lg.weakKey=Lf}return Lg},Lr}(Lb),LH=(function(La){function Lb(){Lb.__super.call(this)}Lf(Lb,"laya.ui.UIEvent",Lj),Lb.SHOW_TIP="showtip",Lb.HIDE_TIP="hidetip"}(),function(Lb){function La(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,La.__super.call(this),this._layout=LC.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Lf(La,"laya.ui.Component",Lb);var Lc=La.prototype;return Lp.imps(Lc,{"laya.ui.IComponent":!0}),Lc.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},Lc.preinitialize=function(){},Lc.createChildren=function(){},Lc.initialize=function(){},Lc.callLater=function(La,Lb){Lp.timer.callLater(this,La,Lb)},Lc.runCallLater=function(La){Lp.timer.runCallLater(this,La)},Lc.commitMeasure=function(){},Lc.changeSize=function(){this.event("resize")},Lc.getLayout=function(){return this._layout===LC.EMPTY&&(this._layout=new LC),this._layout},Lc._setLayoutEnabled=function(La){this._layout&&this._layout.enable!=La&&(this._layout.enable=La,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},Lc.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},Lc.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},Lc.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},Lc.resetLayoutX=function(){var La=this._layout;if(isNaN(La.anchorX)||(this.pivotX=La.anchorX*this.width),this.layoutEnabled){var Lb=this.parent;Lb&&(isNaN(La.centerX)?isNaN(La.left)?isNaN(La.right)||(this.x=Math.round(Lb.width-this.displayWidth-La.right+this.pivotX*this.scaleX)):(this.x=Math.round(La.left+this.pivotX*this.scaleX),isNaN(La.right)||(this.width=(Lb._width-La.left-La.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Lb.width-this.displayWidth)+La.centerX+this.pivotX*this.scaleX))}},Lc.resetLayoutY=function(){var La=this._layout;if(isNaN(La.anchorY)||(this.pivotY=La.anchorY*this.height),this.layoutEnabled){var Lb=this.parent;Lb&&(isNaN(La.centerY)?isNaN(La.top)?isNaN(La.bottom)||(this.y=Math.round(Lb.height-this.displayHeight-La.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(La.top+this.pivotY*this.scaleY),isNaN(La.bottom)||(this.height=(Lb._height-La.top-La.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Lb.height-this.displayHeight)+La.centerY+this.pivotY*this.scaleY))}},Lc.onMouseOver=function(La){Lp.stage.event("showtip",this._toolTip)},Lc.onMouseOut=function(La){Lp.stage.event("hidetip",this._toolTip)},Lg(0,Lc,"displayWidth",function(){return this.width*this.scaleX}),Lg(0,Lc,"width",function(){return this._width?this._width:this.measureWidth},function(La){this._width!=La&&(this._width=La,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),Lg(0,Lc,"measureWidth",function(){var La=0;this.commitMeasure();for(var Lb=this.numChildren-1;-1<Lb;Lb--){var Lc=this.getChildAt(Lb);Lc.visible&&(La=Math.max(Lc.x+Lc.width*Lc.scaleX,La))}return La}),Lg(0,Lc,"displayHeight",function(){return this.height*this.scaleY}),Lg(0,Lc,"height",function(){return this._height?this._height:this.measureHeight},function(La){this._height!=La&&(this._height=La,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),Lg(0,Lc,"dataSource",function(){return this._dataSource},function(La){for(var Lb in this._dataSource=La,this._dataSource)this.hasOwnProperty(Lb)&&"function"!=typeof this[Lb]&&(this[Lb]=this._dataSource[Lb])}),Lg(0,Lc,"scaleY",Lb.prototype._$get_scaleY,function(La){Lp.superGet(Lu,this,"scaleY")!=La&&(Lp.superSet(Lu,this,"scaleY",La),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),Lg(0,Lc,"measureHeight",function(){var La=0;this.commitMeasure();for(var Lb=this.numChildren-1;-1<Lb;Lb--){var Lc=this.getChildAt(Lb);Lc.visible&&(La=Math.max(Lc.y+Lc.height*Lc.scaleY,La))}return La}),Lg(0,Lc,"scaleX",Lb.prototype._$get_scaleX,function(La){Lp.superGet(Lu,this,"scaleX")!=La&&(Lp.superSet(Lu,this,"scaleX",La),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),Lg(0,Lc,"top",function(){return this._layout.top},function(La){La!=this._layout.top&&(this.getLayout().top=La,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Lg(0,Lc,"bottom",function(){return this._layout.bottom},function(La){La!=this._layout.bottom&&(this.getLayout().bottom=La,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Lg(0,Lc,"left",function(){return this._layout.left},function(La){La!=this._layout.left&&(this.getLayout().left=La,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Lg(0,Lc,"right",function(){return this._layout.right},function(La){La!=this._layout.right&&(this.getLayout().right=La,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Lg(0,Lc,"centerX",function(){return this._layout.centerX},function(La){La!=this._layout.centerX&&(this.getLayout().centerX=La,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Lg(0,Lc,"centerY",function(){return this._layout.centerY},function(La){La!=this._layout.centerY&&(this.getLayout().centerY=La,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Lg(0,Lc,"anchorX",function(){return this._layout.anchorX},function(La){La!=this._layout.anchorX&&(this.getLayout().anchorX=La,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Lg(0,Lc,"anchorY",function(){return this._layout.anchorY},function(La){La!=this._layout.anchorY&&(this.getLayout().anchorY=La,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Lg(0,Lc,"tag",function(){return this._tag},function(La){this._tag=La}),Lg(0,Lc,"toolTip",function(){return this._toolTip},function(La){this._toolTip!=La&&(null!=(this._toolTip=La)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),Lg(0,Lc,"comXml",function(){return this._comXml},function(La){this._comXml=La}),Lg(0,Lc,"gray",function(){return this._gray},function(La){La!==this._gray&&(this._gray=La,LE.gray(this,La))}),Lg(0,Lc,"disabled",function(){return this._disabled},function(La){La!==this._disabled&&(this.gray=this._disabled=La,this.mouseEnabled=!La)}),La}(Lu)),LI=function(La){function Lb(){this.lockLayer=null,this.popupEffect=function(La){La.scale(1,1),Lz.from(La,{x:Lp.stage.width/2,y:Lp.stage.height/2,scaleX:0,scaleY:0},300,Li.backOut,Lm.create(this,this.doOpen,[La]))},this.closeEffect=function(La,Lb){Lz.to(La,{x:Lp.stage.width/2,y:Lp.stage.height/2,scaleX:0,scaleY:0},300,Li.strongOut,Lm.create(this,this.doClose,[La,Lb]))},Lb.__super.call(this),this.maskLayer=new Lu,this.popupEffectHandler=Lm.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Lm.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Lp.stage.addChild(this),Lp.stage.on("resize",this,this._onResize),LF.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Lf(Lb,"laya.ui.DialogManager",Lu);var Lc=Lb.prototype;return Lc._closeOnSide=function(){var La=this.getChildAt(this.numChildren-1);La instanceof laya.ui.Dialog&&La.close("side")},Lc.setLockView=function(La){this.lockLayer||(this.lockLayer=new LJ,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Lp.stage.width,Lp.stage.height)),this.lockLayer.removeChildren(),La&&(La.centerX=La.centerY=0,this.lockLayer.addChild(La))},Lc._onResize=function(La){var Lb=this.maskLayer.width=Lp.stage.width,Lc=this.maskLayer.height=Lp.stage.height;this.lockLayer&&this.lockLayer.size(Lb,Lc),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Lb,Lc,LF.popupBgColor),this.maskLayer.alpha=LF.popupBgAlpha;for(var Ld=this.numChildren-1;-1<Ld;Ld--){var Le=this.getChildAt(Ld);Le.popupCenter&&this._centerDialog(Le)}},Lc._centerDialog=function(La){La.x=Math.round((Lp.stage.width-La.width>>1)+La.pivotX),La.y=Math.round((Lp.stage.height-La.height>>1)+La.pivotY)},Lc.open=function(La,Lb,Lc){void 0===Lb&&(Lb=!1),void 0===Lc&&(Lc=!1),Lb&&this._closeAll(),La.popupCenter&&this._centerDialog(La),this.addChild(La),(La.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),Lc&&null!=La.popupEffect?La.popupEffect.runWith(La):this.doOpen(La),this.event("open")},Lc.doOpen=function(La){La.onOpened()},Lc.lock=function(La){this.lockLayer&&(La?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},Lc.close=function(La,Lb,Lc){void 0===Lc&&(Lc=!1),Lc&&null!=La.closeEffect?La.closeEffect.runWith([La,Lb]):this.doClose(La,Lb),this.event("close")},Lc.doClose=function(La,Lb){La.removeSelf(),La.isModal&&this._checkMask(),La.closeHandler&&La.closeHandler.runWith(Lb),La.onClosed(Lb)},Lc.closeAll=function(){this._closeAll(),this.event("close")},Lc._closeAll=function(){for(var La=this.numChildren-1;-1<La;La--){var Lb=this.getChildAt(La);Lb&&null!=Lb.close&&this.doClose(Lb)}},Lc.getDialogsByGroup=function(La){for(var Lb=[],Lc=this.numChildren-1;-1<Lc;Lc--){var Ld=this.getChildAt(Lc);Ld&&Ld.group===La&&Lb.push(Ld)}return Lb},Lc.closeByGroup=function(La){for(var Lb=[],Lc=this.numChildren-1;-1<Lc;Lc--){var Ld=this.getChildAt(Lc);Ld&&Ld.group===La&&(Ld.close(),Lb.push(Ld))}return Lb},Lc._checkMask=function(){this.maskLayer.removeSelf();for(var La=this.numChildren-1;-1<La;La--){var Lb=this.getChildAt(La);if(Lb&&Lb.isModal)return void this.addChildAt(this.maskLayer,La)}},Lb}(),LJ=function(La){function Lb(){Lb.__super.call(this)}Lf(Lb,"laya.ui.Box",La);var Lc=Lb.prototype;return Lp.imps(Lc,{"laya.ui.IBox":!0}),Lg(0,Lc,"dataSource",La.prototype._$get_dataSource,function(La){for(var Lb in this._dataSource=La){var Lc=this.getChildByName(Lb);Lc?Lc.dataSource=La[Lb]:this.hasOwnProperty(Lb)&&"function"!=typeof this[Lb]&&(this[Lb]=La[Lb])}}),Lb}(LH),LK=function(Lb){function Lc(La,Lb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,Lc.__super.call(this),this._labelColors=LD.buttonLabelColors,this._stateNum=LD.buttonStateNum,void 0===Lb&&(Lb=""),this.skin=La,this.label=Lb}Lf(Lc,"laya.ui.Button",Lb);var La=Lc.prototype;return Lp.imps(La,{"laya.ui.ISelect":!0}),La.destroy=function(La){this.clearEvent(),Ls.clearCache(this,this._skin),Ls.clearObject(this,this._weakKey),void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(La),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},La.clearEvent=function(){this._skin&&Le.atalsNotify&&Le.atalsNotify.off(this._skin,this,this._setBtnSource)},La.createChildren=function(){this.graphics=this._bitmap=new LG},La.createText=function(){this._text||(this._text=new Lv,this._text.overflow=Lv.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},La.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},La.onMouse=function(La){if(!1!==this.toggle||!this._selected)return"click"===La.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=Lc.stateMap[La.type]))},La.changeClips=function(){var La=Ls.getRes(this._skin);if(La)if(this._skin&&""!=this._skin){Ls.clearObject(this,this._weakKey);var Lb=La.sourceWidth,Lc=La.sourceHeight/this._stateNum;La.$_GID||(La.$_GID=LA.getGID());var Ld=La.$_GID+"-"+this._stateNum,Le=Ls.findObject(Ld);if(LA.isOkTextureList(Le)||(Le=null),Le)this._weakKey=Ld,Ls.keepObject(this,this._weakKey),this._sources=Le;else{if(this._sources=[],1===this._stateNum)this._sources.push(La);else for(var Lf=0;Lf<this._stateNum;Lf++){var Lg=Ly.createFromTexture(La,0,Lc*Lf,Lb,Lc);if(La.alphaTexture){var Lh=La.width/La.alphaTexture.width;Lg.alphaTexture=Ly.createFromTexture(La.alphaTexture,0/Lh,Lc*Lf/Lh,Lb/Lh,Lc/Lh)}this._sources.push(Lg)}Ls.saveObject(Ld,this._sources),this._weakKey=Ld,Ls.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Lb,this._bitmap.height=this._height||Lc,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Lb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},La.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var La=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[La]),this.label&&(this._text.color=this._labelColors[La],this._strokeColors&&(this._text.strokeColor=this._strokeColors[La]))},La._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},Lg(0,La,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(La){this.createText(),this._text.strokeColor=La}),Lg(0,La,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),Lg(0,La,"skin",function(){return this._skin},function(La){if(this._skin!=La)if(this.clearEvent(),Ls.clearCache(this,this._skin),this._skin=La,Ls.keepCache(this,this._skin),Ls.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var Lb=Le.resAtalsObj&&Le.resAtalsObj[this._skin];Lb?(Le.atalsNotify&&Le.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=Lb.sourceW),0==this.height&&(this.height=Lb.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),La._setBtnSource=function(La,Lb){La===this._skin&&Lb&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},Lg(0,La,"state",function(){return this._state},function(La){this._state!=La&&(this._state=La,this._setStateChanged())}),Lg(0,La,"text",function(){return this.createText(),this._text}),Lg(0,La,"stateNum",function(){return this._stateNum},function(La){"string"==typeof La&&(La=parseInt(La)),this._stateNum!=La&&(this._stateNum=La<1?1:3<La?3:La,this.callLater(this.changeClips))}),Lg(0,La,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(La){this._strokeColors=LE.fillArray(LD.buttonLabelColors,La,String),this._setStateChanged()}),Lg(0,La,"labelColors",function(){return this._labelColors.join(",")},function(La){this._labelColors=LE.fillArray(LD.buttonLabelColors,La,String),this._setStateChanged()}),Lg(0,La,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),Lg(0,La,"label",function(){return this._text?this._text.text:null},function(La){(this._text||La)&&(this.createText(),this._text.text!=La&&(La&&!this._text.parent&&this.addChild(this._text),this._text.text=(La+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),Lg(0,La,"selected",function(){return this._selected},function(La){this._selected!=La&&(this._selected=La,this.state=this._selected?2:0,this.event("change"))}),Lg(0,La,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(La){this.createText(),this._text.padding=LE.fillArray(LD.labelPadding,La,Number)}),Lg(0,La,"labelSize",function(){return this.createText(),this._text.fontSize},function(La){this.createText(),this._text.fontSize=La}),Lg(0,La,"labelStroke",function(){return this.createText(),this._text.stroke},function(La){this.createText(),this._text.stroke=La}),Lg(0,La,"labelBold",function(){return this.createText(),this._text.bold},function(La){this.createText(),this._text.bold=La}),Lg(0,La,"labelFont",function(){return this.createText(),this._text.font},function(La){this.createText(),this._text.font=La}),Lg(0,La,"labelAlign",function(){return this.createText(),this._text.align},function(La){this.createText(),this._text.align=La}),Lg(0,La,"clickHandler",function(){return this._clickHandler},function(La){this._clickHandler=La}),Lg(0,La,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(La){this._bitmap.sizeGrid=LE.fillArray(LD.defaultSizeGrid,La,Number)}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LH,this,"width",La),this._autoSize&&(this._bitmap.width=La,this._text&&(this._text.width=La))}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LH,this,"height",La),this._autoSize&&(this._bitmap.height=La,this._text&&(this._text.height=La))}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)||"string"==typeof La?this.label=La+"":Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(La){this._bitmap._offset=La?LE.fillArray([1,1],La,Number):[]}),Ld(Lc,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),Lc}(LH),LL=function(Lb){function Ld(La,Lb,Lc){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,Ld.__super.call(this),void 0===Lb&&(Lb=1),void 0===Lc&&(Lc=1),this._clipX=Lb,this._clipY=Lc,this.skin=La}Lf(Ld,"laya.ui.Clip",Lb);var La=Ld.prototype;return La.destroy=function(La){this.clearEvent(),this.clearLoad(),Ls.clearCache(this,this._skin),Ls.clearObject(this,this._weakKey),void 0===La&&(La=!0),Lb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},La.dispose=function(){this.destroy(!0),Lp.loader.clearRes(this._skin)},La.createChildren=function(){this.graphics=this._bitmap=new LG},La._onDisplay=function(La){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},La.changeClip=function(){if(this._clipChanged=!1,this._skin){var La=Ls.getRes(this._skin);if(La)this.loadComplete(this._skin,La);else{if(Le.resAtalsObj&&Le.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=Lm.create(this,this.loadComplete,[this._skin]),this._progress=null,Lp.loader.load(this._skin,this._complete,this._progress)}}},La.loadComplete=function(La,Lb){if(La===this._skin&&Lb){Ls.clearObject(this,this._weakKey);var Lc=this._clipWidth||Math.ceil(Lb.sourceWidth/this._clipX),Ld=this._clipHeight||Math.ceil(Lb.sourceHeight/this._clipY),Le=this._skin+Lc+Ld,Lf=Ls.findObject(Le);if(LA.isOkTextureList(Lf)||(Lf=null),Lf)this._weakKey=Le,Ls.keepObject(this,this._weakKey),this._sources=Lf;else{this._sources=[];for(var Lg=0;Lg<this._clipY;Lg++)for(var Lh=0;Lh<this._clipX;Lh++){var Li=Ly.createFromTexture(Lb,Lc*Lh,Ld*Lg,Lc,Ld);if(Lb.alphaTexture){var Lj=Lb.width/Lb.alphaTexture.width;Li.alphaTexture=Ly.createFromTexture(Lb.alphaTexture,Lc*Lh/Lj,Ld*Lg/Lj,Lc/Lj,Ld/Lj)}this._sources.push(Li)}Ls.saveObject(Le,this._sources),this._weakKey=Le,Ls.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},La.play=function(La,Lb){void 0===La&&(La=0),void 0===Lb&&(Lb=-1),this._isPlaying=!0,this.index=La,this._toIndex=Lb,this._index++,Lp.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},La._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},La.stop=function(){this._isPlaying=!1,Lp.timer.clear(this,this._loop),this.event("complete")},La._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},Lg(0,La,"interval",function(){return this._interval},function(La){this._interval!=La&&(this._interval=La,this._isPlaying&&this.play())}),La.clearEvent=function(){this._skin&&Le.atalsNotify&&Le.atalsNotify.off(this._skin,this,this._setBtnSource)},La.clearLoad=function(){this._skin&&((this._complete||this._progress)&&Lp.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},Lg(0,La,"skin",function(){return this._skin},function(La){if(this._skin!=La)if(this.clearLoad(),this.clearEvent(),Ls.clearCache(this,this._skin),this._skin=La){Ls.keepCache(this,this._skin);var Lb=Ls.getRes(La),Lc=Le.resAtalsObj&&Le.resAtalsObj[this._skin];!Lb&&Lc?Le.atalsNotify&&Le.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),La._setBtnSource=function(La,Lb){La===this._skin&&Lb&&(this.loadComplete(La,Lb),this.clearEvent())},Lg(0,La,"sources",function(){return this._sources},function(La){this._sources=La,this.index=this._index,this.event("loaded")}),Lg(0,La,"clipX",function(){return this._clipX},function(La){this._clipX=La||1,this._setClipChanged()}),Lg(0,La,"clipY",function(){return this._clipY},function(La){this._clipY=La||1,this._setClipChanged()}),Lg(0,La,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),Lg(0,La,"clipWidth",function(){return this._clipWidth},function(La){this._clipWidth=La,this._setClipChanged()}),Lg(0,La,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(La){this._bitmap.sizeGrid=LE.fillArray(LD.defaultSizeGrid,La,Number)}),Lg(0,La,"group",function(){return this._group},function(La){La&&this._skin&&Ls.setGroup(this._skin,La),this._group=La}),Lg(0,La,"clipHeight",function(){return this._clipHeight},function(La){this._clipHeight=La,this._setClipChanged()}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LH,this,"width",La),this._bitmap.width=La}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LH,this,"height",La),this._bitmap.height=La}),Lg(0,La,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),Lg(0,La,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),Lg(0,La,"index",function(){return this._index},function(La){this._index=La,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[La]),this.event("change")}),Lg(0,La,"autoPlay",function(){return this._autoPlay},function(La){this._autoPlay!=La&&((this._autoPlay=La)?this.play():this.stop())}),Lg(0,La,"isPlaying",function(){return this._isPlaying},function(La){this._isPlaying=La}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)&&Math.floor(La)==La||"string"==typeof La?this.index=parseInt(La):Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"bitmap",function(){return this._bitmap}),Ld}(LH),LM=function(Lb){function La(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,La.__super.call(this)}Lf(La,"laya.ui.ColorPicker",Lb);var Lc=La.prototype;return Lc.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._colorPanel&&this._colorPanel.destroy(La),this._colorButton&&this._colorButton.destroy(La),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},Lc.createChildren=function(){this.addChild(this._colorButton=new LK),this._colorPanel=new LJ,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new Lu),this._colorPanel.addChild(this._colorBlock=new Lu),this._colorPanel.addChild(this._colorInput=new Ln)},Lc.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},Lc.onPanelMouseDown=function(La){La.stopPropagation()},Lc.changePanel=function(){this._panelChanged=!1;var La=this._colorPanel.graphics;La.clear(),La.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(La=this._colorTiles.graphics).clear();for(var Lb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],Lc=0;Lc<12;Lc++)for(var Ld=0;Ld<20;Ld++){var Le=0;Le=0===Ld?Lb[Lc]:1===Ld?0:51*(((3*Lc+Ld/6)%3<<0)+3*(Lc/6<<0))<<16|Ld%6*51<<8|(Lc<<0)%6*51;var Lf=LE.toColor(Le);this._colors.push(Lf);var Lg=Ld*this._gridSize,Lh=Lc*this._gridSize;La.drawRect(Lg,Lh,this._gridSize,this._gridSize,Lf,"#000000")}},Lc.onColorButtonClick=function(La){this._colorPanel.parent?this.close():this.open()},Lc.open=function(){var La=this.localToGlobal(new Lo),Lb=La.x+this._colorPanel.width<=Lp.stage.width?La.x:Lp.stage.width-this._colorPanel.width,Lc=La.y+this._colorButton.height;Lc=Lc+this._colorPanel.height<=Lp.stage.height?Lc:La.y-this._colorPanel.height,this._colorPanel.pos(Lb,Lc),this._colorPanel.zOrder=1001,Lp._currentStage.addChild(this._colorPanel),Lp.stage.on("mousedown",this,this.removeColorBox)},Lc.close=function(){Lp.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},Lc.removeColorBox=function(La){this.close()},Lc.onColorFieldKeyDown=function(La){13==La.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),La.stopPropagation())},Lc.onColorInputChange=function(La){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},Lc.onColorTilesClick=function(La){this.selectedColor=this.getColorByMouse(),this.close()},Lc.onColorTilesMouseMove=function(La){this._colorInput.focus=!1;var Lb=this.getColorByMouse();this._colorInput.text=Lb,this.drawBlock(Lb)},Lc.getColorByMouse=function(){var La=this._colorTiles.getMousePoint(),Lb=Math.floor(La.x/this._gridSize),Lc=Math.floor(La.y/this._gridSize);return this._colors[20*Lc+Lb]},Lc.drawBlock=function(La){var Lb=this._colorBlock.graphics;Lb.clear();var Lc=La||"#ffffff";Lb.drawRect(0,0,50,20,Lc,this._borderColor),La||Lb.drawLine(0,0,50,20,"#ff0000")},Lc.changeColor=function(){var La=this.graphics;La.clear();var Lb=this._selectedColor||"#000000";La.drawRect(0,0,this._colorButton.width,this._colorButton.height,Lb)},Lc._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},Lg(0,Lc,"inputBgColor",function(){return this._inputBgColor},function(La){this._inputBgColor=La,this._setPanelChanged()}),Lg(0,Lc,"selectedColor",function(){return this._selectedColor},function(La){this._selectedColor!=La&&(this._selectedColor=this._colorInput.text=La,this.drawBlock(La),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",Lj.EMPTY.setTo("change",this,this)))}),Lg(0,Lc,"skin",function(){return this._colorButton.skin},function(La){this._colorButton.skin=La,this.changeColor()}),Lg(0,Lc,"bgColor",function(){return this._bgColor},function(La){this._bgColor=La,this._setPanelChanged()}),Lg(0,Lc,"borderColor",function(){return this._borderColor},function(La){this._borderColor=La,this._setPanelChanged()}),Lg(0,Lc,"inputColor",function(){return this._inputColor},function(La){this._inputColor=La,this._setPanelChanged()}),La}(LH),LN=function(Lb){function Lc(La,Lb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,Lc.__super.call(this),this._itemColors=LD.comboBoxItemColors,this.skin=La,this.labels=Lb}Lf(Lc,"laya.ui.ComboBox",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._button&&this._button.destroy(La),this._list&&this._list.destroy(La),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},La.createChildren=function(){this.addChild(this._button=new LK),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},La._createList=function(){this._list=new LX,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},La._setListEvent=function(La){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Lm.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},La.onListDown=function(La){La.stopPropagation()},La.onScrollBarDown=function(La){La.stopPropagation()},La.onButtonMouseDown=function(La){this.callLater(this.switchTo,[!this._isOpen])},La.changeList=function(){this._listChanged=!1;var La=this.width-2,Lb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:La,height:this._itemHeight,fontSize:this._itemSize,color:Lb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},La.onlistItemMouse=function(La,Lb){var Lc=La.type;if("mouseover"===Lc||"mouseout"===Lc){if(this._isCustomList)return;var Ld=this._list.getCell(Lb);if(!Ld)return;var Le=Ld.getChildByName("label");Le&&("mouseover"===Lc?(Le.bgColor=this._itemColors[0],Le.color=this._itemColors[1]):(Le.bgColor=null,Le.color=this._itemColors[2]))}else"click"===Lc&&(this.selectedIndex=Lb,this.isOpen=!1)},La.switchTo=function(La){this.isOpen=La},La.changeOpen=function(){this.isOpen=!this._isOpen},La.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var La=this._list.graphics;La.clear(),La.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Lb=this._list.array||[],Lc=Lb.length=0,Ld=this._labels.length;Lc<Ld;Lc++)Lb.push({label:this._labels[Lc]});this._list.height=this._listHeight,this._list.array=Lb},La.changeSelected=function(){this._button.label=this.selectedLabel},La._onStageMouseWheel=function(La){this._list&&!this._list.contains(La.target)&&this.removeList(null)},La.removeList=function(La){Lp.stage.off("mousedown",this,this.removeList),Lp.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},Lg(0,La,"selectedIndex",function(){return this._selectedIndex},function(La){this._selectedIndex!=La&&(this._selectedIndex=La,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[Lj.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),Lg(0,La,"measureHeight",function(){return this._button.height}),Lg(0,La,"skin",function(){return this._button.skin},function(La){this._button.skin!=La&&(this._button.skin=La,this._listChanged=!0)}),Lg(0,La,"measureWidth",function(){return this._button.width}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LH,this,"width",La),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),Lg(0,La,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(La){this.selectedIndex=this._labels.indexOf(La)}),Lg(0,La,"labels",function(){return this._labels.join(",")},function(La){0<this._labels.length&&(this.selectedIndex=-1),La?this._labels=La.split(","):this._labels.length=0,this._itemChanged=!0}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LH,this,"height",La),this._button.height=this._height}),Lg(0,La,"selectHandler",function(){return this._selectHandler},function(La){this._selectHandler=La}),Lg(0,La,"visibleNum",function(){return this._visibleNum},function(La){this._visibleNum=La,this._listChanged=!0}),Lg(0,La,"labelBold",function(){return this._button.text.bold},function(La){this._button.text.bold=La}),Lg(0,La,"itemColors",function(){return String(this._itemColors)},function(La){this._itemColors=LE.fillArray(this._itemColors,La,String),this._listChanged=!0}),Lg(0,La,"itemSize",function(){return this._itemSize},function(La){this._itemSize=La,this._listChanged=!0}),Lg(0,La,"scrollBar",function(){return this.list.scrollBar}),Lg(0,La,"isOpen",function(){return this._isOpen},function(La){if(this._isOpen!=La)if(this._isOpen=La,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Lb=this.localToGlobal(Lo.TEMP.setTo(0,0)),Lc=Lb.y+this._button.height;Lc=Lc+this._listHeight<=Lp.stage.height?Lc:Lb.y-this._listHeight,this._list.pos(Lb.x,Lc),this._list.zOrder=1001,Lp._currentStage.addChild(this._list),Lp.stage.once("mousedown",this,this.removeList),Lp.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),Lg(0,La,"scrollBarSkin",function(){return this._scrollBarSkin},function(La){this._scrollBarSkin=La}),Lg(0,La,"sizeGrid",function(){return this._button.sizeGrid},function(La){this._button.sizeGrid=La}),Lg(0,La,"button",function(){return this._button}),Lg(0,La,"list",function(){return this._list||this._createList(),this._list},function(La){La&&(La.removeSelf(),this._isCustomList=!0,this._list=La,this._setListEvent(La),this._itemHeight=La.getCell(0).height+La.spaceY)}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)&&Math.floor(La)==La||"string"==typeof La?this.selectedIndex=parseInt(La):La instanceof Array?this.labels=La.join(","):Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"labelColors",function(){return this._button.labelColors},function(La){this._button.labelColors!=La&&(this._button.labelColors=La)}),Lg(0,La,"labelPadding",function(){return this._button.text.padding.join(",")},function(La){this._button.text.padding=LE.fillArray(LD.labelPadding,La,Number)}),Lg(0,La,"labelSize",function(){return this._button.text.fontSize},function(La){this._button.text.fontSize=La}),Lg(0,La,"labelFont",function(){return this._button.text.font},function(La){this._button.text.font=La}),Lg(0,La,"stateNum",function(){return this._button.stateNum},function(La){this._button.stateNum=La}),Lc}(LH),LO=function(Lb){function Lc(La){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,Lc.__super.call(this),this._showButtons=LF.showButtons,this._touchScrollEnable=LF.touchScrollEnable,this._mouseWheelEnable=LF.mouseWheelEnable,this.skin=La,this.max=1}Lf(Lc,"laya.ui.ScrollBar",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),this.stopScroll(),this.target=null,Lb.prototype.destroy.call(this,La),this.upButton&&this.upButton.destroy(La),this.downButton&&this.downButton.destroy(La),this.slider&&this.slider.destroy(La),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},La.createChildren=function(){this.addChild(this.slider=new LP),this.addChild(this.upButton=new LK),this.addChild(this.downButton=new LK)},La.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},La.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},La.onButtonMouseDown=function(La){var Lb=La.currentTarget===this.upButton;this.slide(Lb),Lp.timer.once(LD.scrollBarDelayTime,this,this.startLoop,[Lb]),Lp.stage.once("mouseup",this,this.onStageMouseUp)},La.startLoop=function(La){Lp.timer.frameLoop(1,this,this.slide,[La])},La.slide=function(La){La?this.value-=this._scrollSize:this.value+=this._scrollSize},La.onStageMouseUp=function(La){Lp.timer.clear(this,this.startLoop),Lp.timer.clear(this,this.slide)},La.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},La.changeSize=function(){Lb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},La.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},La.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},La.setScroll=function(La,Lb,Lc){this.runCallLater(this.changeSize),this.slider.setSlider(La,Lb,Lc),this.slider.bar.visible=0<Lb,!this._hide&&this.autoHide&&(this.visible=!1)},La.onTargetMouseWheel=function(La){this.value-=La.delta*this._scrollSize,this.target=this._target},La.onTargetMouseDown=function(La){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new Lo),this._lastPoint.setTo(Lp.stage.mouseX,Lp.stage.mouseY),Lp.timer.clear(this,this.tweenMove),Lz.clearTween(this),Lp.stage.once("mouseup",this,this.onStageMouseUp2),Lp.stage.once("mouseout",this,this.onStageMouseUp2),Lp.timer.frameLoop(1,this,this.loop)},La.loop=function(){var La=Lp.stage.mouseY,Lb=Lp.stage.mouseX;if(this._lastOffset=this.isVertical?La-this._lastPoint.y:Lb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Lp.stage._canvasTransform.getScaleY():Lp.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Lb,this._lastPoint.y=La,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},La.onStageMouseUp2=function(La){if(Lp.stage.off("mouseup",this,this.onStageMouseUp2),Lp.stage.off("mouseout",this,this.onStageMouseUp2),Lp.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Lz.to(this,{value:this.min},this.elasticBackTime,Li.sineOut,Lm.create(this,this.elasticOver)):this._value>this.max&&Lz.to(this,{value:this.max},this.elasticBackTime,Li.sineOut,Lm.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Lp.stage.mouseY-this._lastPoint.y:Lp.stage.mouseX-this._lastPoint.x);for(var Lb=0,Lc=Math.min(this._offsets.length,3),Ld=0;Ld<Lc;Ld++)Lb+=this._offsets[this._offsets.length-1-Ld];if(this._lastOffset=Lb/Lc,(Lb=Math.abs(this._lastOffset))<2)return void this.event("end");60<Lb&&(this._lastOffset=0<this._lastOffset?60:-60);var Le=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Lp.timer.frameLoop(1,this,this.tweenMove,[Le])}},La.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Lz.to(this,{alpha:0},500),this.event("end")},La.tweenMove=function(La){this._lastOffset*=this.rollRatio;var Lb=NaN;if(0<La&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Lb=.5*-(this.min-La-this.value),this._lastOffset>Lb&&(this._lastOffset=Lb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Lb=.5*-(this.max+La-this.value),this._lastOffset<Lb&&(this._lastOffset=Lb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Lp.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Lz.to(this,{value:this.min},this.elasticBackTime,Li.sineOut,Lm.create(this,this.elasticOver)):this._value>this.max?Lz.to(this,{value:this.max},this.elasticBackTime,Li.sineOut,Lm.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Lz.to(this,{alpha:0},500)}},La.stopScroll=function(){this.onStageMouseUp2(null),Lp.timer.clear(this,this.tweenMove),Lz.clearTween(this)},Lg(0,La,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),Lg(0,La,"skin",function(){return this._skin},function(La){this._skin!=La&&(this._skin=La,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),Lg(0,La,"max",function(){return this.slider.max},function(La){this.slider.max=La}),Lg(0,La,"showButtons",function(){return this._showButtons},function(La){this._showButtons=La,this.callLater(this.changeScrollBar)}),Lg(0,La,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),Lg(0,La,"min",function(){return this.slider.min},function(La){this.slider.min=La}),Lg(0,La,"value",function(){return this._value},function(La){La!==this._value&&(this._value=La,this._isElastic||(this.slider._value!=La&&(this.slider._value=La,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),Lg(0,La,"isVertical",function(){return this.slider.isVertical},function(La){this.slider.isVertical=La}),Lg(0,La,"sizeGrid",function(){return this.slider.sizeGrid},function(La){this.slider.sizeGrid=La}),Lg(0,La,"scrollSize",function(){return this._scrollSize},function(La){this._scrollSize=La}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)||"string"==typeof La?this.value=Number(La):Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"thumbPercent",function(){return this._thumbPercent},function(La){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),La=1<=La?.99:La,this._thumbPercent=La,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*La,LD.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*La,LD.scrollBarMinNum))}),Lg(0,La,"target",function(){return this._target},function(La){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=La)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),Lg(0,La,"hide",function(){return this._hide},function(La){this._hide=La,this.visible=!La}),Lg(0,La,"touchScrollEnable",function(){return this._touchScrollEnable},function(La){this._touchScrollEnable=La,this.target=this._target}),Lg(0,La,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(La){this._mouseWheelEnable=La,this.target=this._target}),Lg(0,La,"tick",function(){return this.slider.tick},function(La){this.slider.tick=La}),Lc}(LH),LP=function(Lb){function Lc(La){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,Lc.__super.call(this),this.skin=La}Lf(Lc,"laya.ui.Slider",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._bg&&this._bg.destroy(La),this._bar&&this._bar.destroy(La),this._progress&&this._progress.destroy(La),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},La.createChildren=function(){this.addChild(this._bg=new LQ),this.addChild(this._bar=new LK)},La.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},La.onBarMouseDown=function(La){this._globalSacle||(this._globalSacle=new Lo),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Lp.stage.mouseX,this._ty=Lp.stage.mouseY,Lp.stage.on("mousemove",this,this.mouseMove),Lp.stage.once("mouseup",this,this.mouseUp),Lp.stage.once("mouseout",this,this.mouseUp),this.showValueText()},La.showValueText=function(){if(this.showLabel){var La=laya.ui.Slider.label;this.addChild(La),La.textField.changeText(this._value+""),this.isVertical?(La.x=this._bar.x+20,La.y=.5*(this._bar.height-La.height)+this._bar.y):(La.y=this._bar.y-20,La.x=.5*(this._bar.width-La.width)+this._bar.x)}},La.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},La.mouseUp=function(La){Lp.stage.off("mousemove",this,this.mouseMove),Lp.stage.off("mouseup",this,this.mouseUp),Lp.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},La.mouseMove=function(La){var Lb=this._value;this.isVertical?(this._bar.y+=(Lp.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Lp.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Lp.stage.mouseX,this._ty=Lp.stage.mouseY;var Lc=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Lc)/Lc,this._value!=Lb&&this.sendChangeEvent(),this.showValueText()},La.sendChangeEvent=function(La){void 0===La&&(La="change"),this.event(La),this.changeHandler&&this.changeHandler.runWith(this._value)},La.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},La.changeSize=function(){Lb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},La.setSlider=function(La,Lb,Lc){this._value=-1,this._min=La,this._max=La<Lb?Lb:La,this.value=Lc<La?La:Lb<Lc?Lb:Lc},La.changeValue=function(){var La=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*La)/La,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Lb=this._max-this._min;0===Lb&&(Lb=1),this.isVertical?(this._bar.y=(this._value-this._min)/Lb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Lb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},La.onBgMouseDown=function(La){var Lb=this._bg.getMousePoint();this.isVertical?this.value=Lb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Lb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},Lg(0,La,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),Lg(0,La,"skin",function(){return this._skin},function(La){if(this._skin!=La){this._skin=La,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Lb=this._skin.replace(".png","$progress.png");Ls.getRes(Lb)&&(this._progress||(this.addChild(this._progress=new LQ),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Lb),this.setBarPoint(),this.callLater(this.changeValue)}}),Lg(0,La,"allowClickBack",function(){return this._allowClickBack},function(La){this._allowClickBack!=La&&((this._allowClickBack=La)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),Lg(0,La,"max",function(){return this._max},function(La){this._max!=La&&(this._max=La,this.callLater(this.changeValue))}),Lg(0,La,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),Lg(0,La,"tick",function(){return this._tick},function(La){this._tick!=La&&(this._tick=La,this.callLater(this.changeValue))}),Lg(0,La,"sizeGrid",function(){return this._bg.sizeGrid},function(La){this._bg.sizeGrid=La,this._bar.sizeGrid=La,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),Lg(0,La,"min",function(){return this._min},function(La){this._min!=La&&(this._min=La,this.callLater(this.changeValue))}),Lg(0,La,"value",function(){return this._value},function(La){if(this._value!=La){var Lb=this._value;this._value=La,this.changeValue(),this._value!=Lb&&this.sendChangeEvent()}}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)||"string"==typeof La?this.value=Number(La):Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"bar",function(){return this._bar}),Ld(Lc,["label",function(){return this.label=new LR}]),Lc}(LH),LQ=function(Lb){function Lc(La){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,Lc.__super.call(this),this.skin=La}Lf(Lc,"laya.ui.Image",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,Ls.clearCache(this,this._skin)},La.dispose=function(){this.destroy(!0),Ls.clearCache(this,this._skin),this.clearEvent()},La.createChildren=function(){this.graphics=this._bitmap=new LG},La.setSource=function(La,Lb){this.destroyed||La===this._skin&&Lb&&(this.source=Lb,this.onCompResize(),this.clearEvent())},La.clearEvent=function(){this._skin&&Le.atalsNotify&&Le.atalsNotify.off(this._skin,this,this.setSource)},La.clearLoad=function(){this._skin&&((this._complete||this._progress)&&Lp.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},Lg(0,La,"source",function(){return this._bitmap.source},function(La){this._bitmap&&(this._bitmap.source=La,this.event("loaded"),this.repaint())}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"string"==typeof(this._dataSource=La)?this.skin=La:Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"measureHeight",function(){return this._bitmap.height}),Lg(0,La,"skin",function(){return this._skin},function(La){if(this._skin!=La)if(Ls.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=La){Ls.keepCache(this,this._skin);var Lb=Ls.getRes(La),Lc=Le.resAtalsObj&&Le.resAtalsObj[this._skin];Lb?(this.source=Lb,this.onCompResize()):Lc?(Le.atalsNotify&&Le.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=Lc.sourceW),0==this.height&&(this.height=Lc.sourceH)):(this._complete=Lm.create(this,this.setSource,[this._skin]),this._progress=null,Lp.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),Lg(0,La,"group",function(){return this._group},function(La){La&&this._skin&&Ls.setGroup(this._skin,La),this._group=La}),Lg(0,La,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(La){this._bitmap.sizeGrid=LE.fillArray(LD.defaultSizeGrid,La,Number)}),Lg(0,La,"measureWidth",function(){return this._bitmap.width}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LH,this,"width",La),this._bitmap.width=0==La?1e-7:La}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LH,this,"height",La),this._bitmap.height=0==La?1e-7:La}),Lc}(LH),LR=function(Lb){function Lc(La){this._tf=null,Lc.__super.call(this),void 0===La&&(La=""),Lk.defaultColor=LD.labelColor,this.text=La}Lf(Lc,"laya.ui.Label",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._tf=null},La.createChildren=function(){this.addChild(this._tf=new Lv)},La.changeText=function(La){this._tf.changeText(La)},Lg(0,La,"padding",function(){return this._tf.padding.join(",")},function(La){this._tf.padding=LE.fillArray(LD.labelPadding,La,Number)}),Lg(0,La,"bold",function(){return this._tf.bold},function(La){this._tf.bold=La}),Lg(0,La,"align",function(){return this._tf.align},function(La){this._tf.align=La}),Lg(0,La,"text",function(){return this._tf.text},function(La){this._tf.text!=La&&(La&&(La=LE.adptString(La+"")),this._tf.text=La,this.event("change"),this._width&&this._height||this.onCompResize())}),Lg(0,La,"italic",function(){return this._tf.italic},function(La){this._tf.italic=La}),Lg(0,La,"wordWrap",function(){return this._tf.wordWrap},function(La){this._tf.wordWrap=La}),Lg(0,La,"font",function(){return this._tf.font},function(La){this._tf.font=La}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)||"string"==typeof La?this.text=La+"":Lp.superSet(LH,this,"dataSource",La)}),Lg(0,La,"color",function(){return this._tf.color},function(La){this._tf.color=La}),Lg(0,La,"valign",function(){return this._tf.valign},function(La){this._tf.valign=La}),Lg(0,La,"leading",function(){return this._tf.leading},function(La){this._tf.leading=La}),Lg(0,La,"fontSize",function(){return this._tf.fontSize},function(La){this._tf.fontSize=La}),Lg(0,La,"bgColor",function(){return this._tf.bgColor},function(La){this._tf.bgColor=La}),Lg(0,La,"borderColor",function(){return this._tf.borderColor},function(La){this._tf.borderColor=La}),Lg(0,La,"stroke",function(){return this._tf.stroke},function(La){this._tf.stroke=La}),Lg(0,La,"strokeColor",function(){return this._tf.strokeColor},function(La){this._tf.strokeColor=La}),Lg(0,La,"textField",function(){return this._tf}),Lg(0,La,"measureWidth",function(){return this._tf.width}),Lg(0,La,"measureHeight",function(){return this._tf.height}),Lg(0,La,"width",function(){return this._width||this._tf.text?Lp.superGet(LH,this,"width"):0},function(La){Lp.superSet(LH,this,"width",La),this._tf.width=La}),Lg(0,La,"height",function(){return this._height||this._tf.text?Lp.superGet(LH,this,"height"):0},function(La){Lp.superSet(LH,this,"height",La),this._tf.height=La}),Lg(0,La,"overflow",function(){return this._tf.overflow},function(La){this._tf.overflow=La}),Lg(0,La,"underline",function(){return this._tf.underline},function(La){this._tf.underline=La}),Lg(0,La,"underlineColor",function(){return this._tf.underlineColor},function(La){this._tf.underlineColor=La}),Lc}(LH),LS=function(Lb){function Lc(La){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,Lc.__super.call(this),this.skin=La}Lf(Lc,"laya.ui.ProgressBar",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._bg&&this._bg.destroy(La),this._bar&&this._bar.destroy(La),this._bg=this._bar=null,this.changeHandler=null},La.createChildren=function(){this.addChild(this._bg=new LQ),this.addChild(this._bar=new LQ)},La.changeValue=function(){if(this.sizeGrid){var La=this.sizeGrid.split(","),Lb=Number(La[3]),Lc=Number(La[1]),Ld=(this.width-Lb-Lc)*this._value;this._bar.width=Lb+Lc+Ld,this._bar.visible=this._bar.width>Lb+Lc}else this._bar.width=this.width*this._value},Lg(0,La,"measureHeight",function(){return this._bg.height}),Lg(0,La,"skin",function(){return this._skin},function(La){this._skin!=La&&(this._skin=La,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),Lg(0,La,"measureWidth",function(){return this._bg.width}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LH,this,"height",La),this._bg.height=this._height,this._bar.height=this._height}),Lg(0,La,"bar",function(){return this._bar}),Lg(0,La,"value",function(){return this._value},function(La){this._value!=La&&(La=1<La?1:La<0?0:La,this._value=La,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(La))}),Lg(0,La,"bg",function(){return this._bg}),Lg(0,La,"sizeGrid",function(){return this._bg.sizeGrid},function(La){this._bg.sizeGrid=this._bar.sizeGrid=La}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LH,this,"width",La),this._bg.width=this._width,this.callLater(this.changeValue)}),Lg(0,La,"dataSource",Lb.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)||"string"==typeof La?this.value=Number(La):Lp.superSet(LH,this,"dataSource",La)}),Lc}(LH),LT=(function(La){function Lc(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,Lc.__super.call(this),this._tipBox=new LH,this._tipBox.addChild(this._tipText=new Lv),this._tipText.x=this._tipText.y=5,this._tipText.color=Lc.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Lp.stage.on("showtip",this,this._onStageShowTip),Lp.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Lf(Lc,"laya.ui.TipManager",LH);var Lb=Lc.prototype;Lb._onStageHideTip=function(La){Lp.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Lb._onStageShowTip=function(La){Lp.timer.once(Lc.tipDelay,this,this._showTip,[La],!0)},Lb._showTip=function(La){if("string"==typeof La){var Lb=String(La);Boolean(Lb)&&this._defaultTipHandler(Lb)}else La instanceof laya.utils.Handler?La.run():"function"==typeof La&&La.apply();Lp.stage.on("mousemove",this,this._onStageMouseMove),Lp.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Lb._onStageMouseDown=function(La){this.closeAll()},Lb._onStageMouseMove=function(La){this._showToStage(this,Lc.offsetX,Lc.offsetY)},Lb._showToStage=function(La,Lb,Lc){void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0);var Ld=La.getBounds();La.x=Lp.stage.mouseX+Lb,La.y=Lp.stage.mouseY+Lc,La.x+Ld.width>Lp.stage.width&&(La.x-=Ld.width+Lb),La.y+Ld.height>Lp.stage.height&&(La.y-=Ld.height+Lc)},Lb.closeAll=function(){Lp.timer.clear(this,this._showTip),Lp.stage.off("mousemove",this,this._onStageMouseMove),Lp.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Lb.showDislayTip=function(La){this.addChild(La),this._showToStage(this),Lp._currentStage.addChild(this)},Lb._showDefaultTip=function(La){this._tipText.text=La;var Lb=this._tipBox.graphics;Lb.clear(),Lb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,Lc.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Lp._currentStage.addChild(this)},Lg(0,Lb,"defaultTipHandler",function(){return this._defaultTipHandler},function(La){this._defaultTipHandler=La}),Lc.offsetX=10,Lc.offsetY=15,Lc.tipTextColor="#ffffff",Lc.tipBackColor="#111111",Lc.tipDelay=200}(),function(La){var Ln;function Lo(){this._idMap=null,this._aniList=null,this._watchMap={},Lo.__super.call(this)}Lf(Lo,"laya.ui.View",LJ);var Lb=Lo.prototype;return Lb.createView=function(La){if(La.animations&&!this._idMap&&(this._idMap={}),Lo.createComp(La,this,this),La.animations){var Lb,Lc,Ld=[],Le=La.animations,Lf=0,Lg=Le.length;for(Lf=0;Lf<Lg;Lf++){switch(Lb=new Ll,Lc=Le[Lf],Lb._setUp(this._idMap,Lc),(this[Lc.name]=Lb)._setControlNode(this),Lc.action){case 1:Lb.play(0,!1);break;case 2:Lb.play(0,!0)}Ld.push(Lb)}this._aniList=Ld}0<this._width&&null==La.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Lb.onEvent=function(La,Lb){},Lb.loadUI=function(La){var Lb=Lo.uiMap[La];Lb&&this.createView(Lb)},Lb.destroy=function(La){void 0===La&&(La=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,La)},Lb.changeData=function(La){var Lb=this._watchMap[La];if(Lb){console.log("change",La);for(var Lc=0,Ld=Lb.length;Lc<Ld;Lc++){Lb[Lc].exe(this)}}},Lo._regs=function(){for(var La in Lo.uiClassMap)Lq.regClass(La,Lo.uiClassMap[La])},Lo.createComp=function(La,Lb,Lc,Ld){if(!(Lb=Lb||Lo.getCompInstance(La)))return console.warn("can not create:"+La.type),null;var Le=La.child;if(Le)for(var Lf=Lb instanceof laya.ui.List,Lg=0,Lh=Le.length;Lg<Lh;Lg++){var Li=Le[Lg];if(!Lb.hasOwnProperty("itemRender")||"render"!=Li.props.name&&"render"!==Li.props.renderType)if("Graphic"==Li.type)Lq.addGraphicsToSprite(Li,Lb);else if(Lq.isDrawType(Li.type))Lq.addGraphicToSprite(Li,Lb,!0);else{if(Lf){var Lj=[],Lk=Lo.createComp(Li,null,Lc,Lj);Lj.length&&(Lk._$bindData=Lj)}else Lk=Lo.createComp(Li,null,Lc,Ld);"Script"==Li.type?"owner"in Lk?Lk.owner=Lb:"target"in Lk&&(Lk.target=Lb):"mask"==Li.props.renderType||"mask"==Li.props.name?Lb.mask=Lk:Lk instanceof laya.display.Sprite&&Lb.addChild(Lk)}else Lb.itemRender=Li}var Ll=La.props;for(var Lm in Ll){var Ln=Ll[Lm];Lo.eventDic[Lm]?Ln&&Lc&&Lb.on(Lm,Lc,Lc.onEvent,[Ln]):Lo.setCompValue(Lb,Lm,Ln,Lc,Ld)}return Lp.__typeof(Lb,"laya.ui.IItem")&&Lb.initItems(),La.compId&&Lc&&Lc._idMap&&(Lc._idMap[La.compId]=Lb),Lb},Lo.setCompValue=function(La,Lb,Lc,Ld,Le){if("string"==typeof Lc&&-1<Lc.indexOf("${")){if(Lo._sheet||(Lo._sheet=Lq.getClass("laya.data.Table")),!Lo._sheet)return void console.warn("Can not find class Sheet");if(Le)Le.push(La,Lb,Lc);else if(Ld){-1==Lc.indexOf("].")&&(Lc=Lc.replace(".","[0]."));var Lf,Lg,Lh=new Ln(La,Lb,Lc);Lh.exe(Ld);for(var Li=Lc.replace(/\[.*?\]\./g,".");null!=(Lf=Lo._parseWatchData.exec(Li));){for(var Lj=Lf[1];null!=(Lg=Lo._parseKeyWord.exec(Lj));){var Lk=Lg[0],Ll=Ld._watchMap[Lk]||(Ld._watchMap[Lk]=[]);Ll.push(Lh),Lo._sheet.I.notifer.on(Lk,Ld,Ld.changeData,[Lk])}(Ll=Ld._watchMap[Lj]||(Ld._watchMap[Lj]=[])).push(Lh),Lo._sheet.I.notifer.on(Lj,Ld,Ld.changeData,[Lj])}}}else if("var"===Lb&&Ld)Ld[Lc]=La;else if("onClick"==Lb){var Lm=Lp._runScript("(function(){"+Lc+"})");La.on("click",Ld,Lm)}else La[Lb]="true"===Lc||"false"!==Lc&&Lc},Lo.getCompInstance=function(La){var Lb,Lc=La.props?La.props.runtime:null;return Lb=Lc?Lo.viewClassMap[Lc]||Lo.uiClassMap[Lc]||Lp.__classmap[Lc]:Lo.uiClassMap[La.type],La.props&&La.props.hasOwnProperty("renderType")&&"instance"==La.props.renderType?Lb.instance:Lb?new Lb:null},Lo.regComponent=function(La,Lb){Lo.uiClassMap[La]=Lb,Lq.regClass(La,Lb)},Lo.regViewRuntime=function(La,Lb){Lo.viewClassMap[La]=Lb},Lo.uiMap={},Lo.viewClassMap={},Lo._sheet=null,Ld(Lo,["uiClassMap",function(){return this.uiClassMap={ViewStack:Laa,LinkButton:LK,TextArea:Lja,ColorPicker:LM,Box:LJ,Button:LK,CheckBox:LU,Clip:LL,ComboBox:LN,Component:LH,HScrollBar:LY,HSlider:L$,Image:LQ,Label:LR,List:LX,Panel:LZ,ProgressBar:LS,Radio:Lw,RadioGroup:Lha,ScrollBar:LO,Slider:LP,Tab:Lia,TextInput:Lca,View:Lo,VScrollBar:Lba,VSlider:Lda,Tree:Lx,HBox:Lfa,VBox:Lga,Sprite:Lu,Animation:Lc,Text:Lv,FontClip:LW}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),Lo.__init$=function(){Lo._regs(),Ln=function(){function La(La,Lb,Lc){this.comp=null,this.prop=null,this.value=null,this.comp=La,this.prop=Lb,this.value=Lc}return Lf(La,""),La.prototype.exe=function(La){var Lb=LE.getBindFun(this.value);this.comp[this.prop]=Lb.call(this,La)},La}()},Lo}()),LU=function(La){function Lc(La,Lb){void 0===Lb&&(Lb=""),Lc.__super.call(this,La,Lb)}Lf(Lc,"laya.ui.CheckBox",La);var Lb=Lc.prototype;return Lb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Lb.initialize=function(){La.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},Lg(0,Lb,"dataSource",La.prototype._$get_dataSource,function(La){"boolean"==typeof(this._dataSource=La)?this.selected=La:"string"==typeof La?this.selected="true"===La:Lp.superSet(LK,this,"dataSource",La)}),Lc}(LK),LV=function(La){function Lb(){this._space=0,this._align="none",this._itemChanged=!1,Lb.__super.call(this)}Lf(Lb,"laya.ui.LayoutBox",LJ);var Lc=Lb.prototype;return Lc.addChild=function(La){return La.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,La)},Lc.onResize=function(La){this._setItemChanged()},Lc.addChildAt=function(La,Lb){return La.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,La,Lb)},Lc.removeChild=function(La){return La.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,La)},Lc.removeChildAt=function(La){return this.getChildAt(La).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,La)},Lc.refresh=function(){this._setItemChanged()},Lc.changeItems=function(){this._itemChanged=!1},Lc.sortItem=function(La){La&&La.sort(function(La,Lb){return La.y-Lb.y})},Lc._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},Lg(0,Lc,"space",function(){return this._space},function(La){this._space=La,this._setItemChanged()}),Lg(0,Lc,"align",function(){return this._align},function(La){this._align=La,this._setItemChanged()}),Lb}(),LW=function(Lb){function Lc(La,Lb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,Lc.__super.call(this),La&&(this.skin=La),Lb&&(this.sheet=Lb)}Lf(Lc,"laya.ui.FontClip",Lb);var La=Lc.prototype;return La.createChildren=function(){this._bitmap=new LG,this.on("loaded",this,this._onClipLoaded)},La._onClipLoaded=function(){this.callLater(this.changeValue)},La.changeValue=function(){var La;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),La=this._sources[0]))){var Lb="horizontal"===this._direction;Lb?(this._wordsW=this._valueArr.length*(La.sourceWidth+this.spaceX),this._wordsH=La.sourceHeight):(this._wordsW=La.sourceWidth,this._wordsH=(La.sourceHeight+this.spaceY)*this._valueArr.length);var Lc=0;if(this._width)switch(this._align){case"center":Lc=.5*(this._width-this._wordsW);break;case"right":Lc=this._width-this._wordsW;break;default:Lc=0}for(var Ld=0,Le=this._valueArr.length;Ld<Le;Ld++){var Lf=this._indexMap[this._valueArr.charAt(Ld)];this.sources[Lf]&&(La=this.sources[Lf],Lb?this.graphics.drawTexture(La,Lc+Ld*(La.sourceWidth+this.spaceX),0,La.sourceWidth,La.sourceHeight):this.graphics.drawTexture(La,0+Lc,Ld*(La.sourceHeight+this.spaceY),La.sourceWidth,La.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},La.destroy=function(La){void 0===La&&(La=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Lb.prototype.destroy.call(this,La)},Lg(0,La,"sheet",function(){return this._sheet},function(La){La+="";var Lb=(this._sheet=La).split(" ");this._clipX=String(Lb[0]).length,this.clipY=Lb.length,this._indexMap={};for(var Lc=0;Lc<this._clipY;Lc++)for(var Ld=Lb[Lc].split(""),Le=0,Lf=Ld.length;Le<Lf;Le++)this._indexMap[Ld[Le]]=Lc*this._clipX+Le}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LL,this,"height",La),this.callLater(this.changeValue)}),Lg(0,La,"direction",function(){return this._direction},function(La){this._direction=La,this.callLater(this.changeValue)}),Lg(0,La,"value",function(){return this._valueArr?this._valueArr:""},function(La){La+="",this._valueArr=La,this.callLater(this.changeValue)}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LL,this,"width",La),this.callLater(this.changeValue)}),Lg(0,La,"spaceX",function(){return this._spaceX},function(La){this._spaceX=La,"horizontal"===this._direction&&this.callLater(this.changeValue)}),Lg(0,La,"spaceY",function(){return this._spaceY},function(La){this._spaceY=La,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),Lg(0,La,"align",function(){return this._align},function(La){this._align=La,this.callLater(this.changeValue)}),Lg(0,La,"measureWidth",function(){return this._wordsW}),Lg(0,La,"measureHeight",function(){return this._wordsH}),Lc}(LL),LX=function(La){function Lb(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new Lo,Lb.__super.call(this)}Lf(Lb,"laya.ui.List",La);var Lc=Lb.prototype;return Lp.imps(Lc,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),Lc.destroy=function(La){void 0===La&&(La=!0),this._content&&this._content.destroy(La),this._scrollBar&&this._scrollBar.destroy(La),laya.ui.Component.prototype.destroy.call(this,La),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},Lc.createChildren=function(){this.addChild(this._content=new LJ)},Lc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Lp.superGet(LJ,this,"cacheAs")),Lp.superSet(LJ,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},Lc.onScrollEnd=function(){Lp.superSet(LJ,this,"cacheAs",this._$P.cacheAs)},Lc._removePreScrollBar=function(){var La=this.removeChildByName("scrollBar");La&&La.destroy(!0)},Lc.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var La=this._getOneCell(),Lb=La.width+this._spaceX||1,Lc=La.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Lb):Math.ceil(this._width/Lb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/Lc):Math.round(this._height/Lc));var Ld=this._width?this._width:Lb*this.repeatX-this._spaceX,Le=this._height?this._height:Lc*this.repeatY-this._spaceY;this._cellSize=this._isVertical?Lc:Lb,this._cellOffset=this._isVertical?Lc*Math.max(this._repeatY2,this._repeatY)-Le-this._spaceY:Lb*Math.max(this._repeatX2,this._repeatX)-Ld-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=Le:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Ld),this.setContentSize(Ld,Le);var Lf=this._isVertical?this.repeatX:this.repeatY,Lg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Lf,Lg),this._createdLine=Lg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},Lc._getOneCell=function(){if(0===this._cells.length){var La=this.createItem();if(this._offset.setTo(La.x,La.y),this.cacheContent)return La;this._cells.push(La)}return this._cells[0]},Lc._createItems=function(La,Lb,Lc){var Ld=this._content,Le=this._getOneCell(),Lf=Le.width+this._spaceX,Lg=Le.height+this._spaceY;if(this.cacheContent){var Lh=new LJ;Lh.cacheAsBitmap=!0,Lh.pos((this._isVertical?0:La)*Lf,(this._isVertical?La:0)*Lg),this._content.addChild(Lh),this._content.optimizeScrollRect=!0,Ld=Lh}else{for(var Li=[],Lj=this._cells.length-1;-1<Lj;Lj--){var Lk=this._cells[Lj];Lk.removeSelf(),Li.push(Lk)}this._cells.length=0}for(var Ll=La;Ll<Lc;Ll++)for(var Lm=0;Lm<Lb;Lm++)(Le=Li&&Li.length?Li.pop():this.createItem()).x=(this._isVertical?Lm:Ll)*Lf-Ld.x,Le.y=(this._isVertical?Ll:Lm)*Lg-Ld.y,Le.name="item"+(Ll*Lb+Lm),Ld.addChild(Le),this.addCell(Le)},Lc.createItem=function(){var La=[];if("function"==typeof this._itemRender)var Lb=new this._itemRender;else Lb=LT.createComp(this._itemRender,null,null,La);if(0==La.length&&Lb._watchMap){var Lc=Lb._watchMap;for(var Ld in Lc)for(var Le=Lc[Ld],Lf=0;Lf<Le.length;Lf++){var Lg=Le[Lf];La.push(Lg.comp,Lg.prop,Lg.value)}}return La.length&&(Lb._$bindData=La),Lb},Lc.addCell=function(La){La.on("click",this,this.onCellMouse),La.on("rightclick",this,this.onCellMouse),La.on("mouseover",this,this.onCellMouse),La.on("mouseout",this,this.onCellMouse),La.on("mousedown",this,this.onCellMouse),La.on("mouseup",this,this.onCellMouse),this._cells.push(La)},Lc.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var La=0,Lb=La=0;Lb<1e4;Lb++){var Lc=this.getChildByName("item"+Lb);if(!Lc)break;this.addCell(Lc),La++}this.repeatY=La}},Lc.setContentSize=function(La,Lb){this._content.width=La,this._content.height=Lb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new Lr),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,La,Lb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},Lc.onCellMouse=function(La){"mousedown"===La.type&&(this._isMoved=!1);var Lb=La.currentTarget,Lc=this._startIndex+this._cells.indexOf(Lb);Lc<0||("click"===La.type||"rightclick"===La.type?this.selectEnable&&!this._isMoved?this.selectedIndex=Lc:this.changeCellState(Lb,!0,0):"mouseover"!==La.type&&"mouseout"!==La.type||this._selectedIndex===Lc||this.changeCellState(Lb,"mouseover"===La.type,0),this.mouseHandler&&this.mouseHandler.runWith([La,Lc]))},Lc.changeCellState=function(La,Lb,Lc){var Ld=La.getChildByName("selectBox");Ld&&(this.selectEnable=!0,Ld.visible=Lb,Ld.index=Lc)},Lc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},Lc.onScrollBarChange=function(La){this.runCallLater(this.changeCells);var Lb=this._scrollBar.value,Lc=this._isVertical?this.repeatX:this.repeatY,Ld=this._isVertical?this.repeatY:this.repeatX,Le=Math.floor(Lb/this._cellSize);if(this.cacheContent)Lg=Ld+1,this._createdLine-Le<Lg&&(this._createItems(this._createdLine,Lc,this._createdLine+Lg),this.renderItems(this._createdLine*Lc,0),this._createdLine+=Lg);else{var Lf=Le*Lc,Lg=0;if(Lf>this._startIndex){Lg=Lf-this._startIndex;var Lh=!0,Li=this._startIndex+Lc*(Ld+1);this._isMoved=!0}else Lf<this._startIndex&&(Lg=this._startIndex-Lf,Lh=!1,Li=this._startIndex-1,this._isMoved=!0);for(var Lj=0;Lj<Lg;Lj++){if(Lh){var Lk=this._cells.shift();this._cells[this._cells.length]=Lk;var Ll=Li+Lj}else Lk=this._cells.pop(),this._cells.unshift(Lk),Ll=Li-Lj;var Lm=Math.floor(Ll/Lc)*this._cellSize;this._isVertical?Lk.y=Lm:Lk.x=Lm,this.renderItem(Lk,Ll)}this._startIndex=Lf,this.changeSelectStatus()}var Ln=this._content.scrollRect;this._isVertical?(Ln.y=Lb-this._offset.y,Ln.x=-this._offset.x):(Ln.y=-this._offset.y,Ln.x=Lb-this._offset.x),this._content.scrollRect=Ln},Lc.posCell=function(La,Lb){if(this._scrollBar){var Lc=this._isVertical?this.repeatX:this.repeatY,Ld=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Lb/Lc)*this._cellSize);this._isVertical?La.y=Ld:La.x=Ld}},Lc.changeSelectStatus=function(){for(var La=0,Lb=this._cells.length;La<Lb;La++)this.changeCellState(this._cells[La],this._selectedIndex===this._startIndex+La,1)},Lc.renderItems=function(La,Lb){void 0===La&&(La=0),void 0===Lb&&(Lb=0);for(var Lc=La,Ld=Lb||this._cells.length;Lc<Ld;Lc++)this.renderItem(this._cells[Lc],this._startIndex+Lc);this.changeSelectStatus(),this._twDone=!0},Lc.renderItem=function(La,Lb){this._array&&0<=Lb&&Lb<this._array.length?(La.visible=!0,La._$bindData?(La._dataSource=this._array[Lb],this._bindData(La,this._array[Lb])):La.dataSource=this._array[Lb],this.cacheContent||this.posCell(La,Lb),this.hasListener("render")&&this.event("render",[La,Lb]),this.renderHandler&&this.renderHandler.runWith([La,Lb]),this.renderTwHandler&&this.renderTwHandler.runWith([La,Lb])):(La.visible=!1,La.dataSource=null)},Lc._bindData=function(La,Lb){for(var Lc=La._$bindData,Ld=0,Le=Lc.length;Ld<Le;Ld++){var Lf=Lc[Ld++],Lg=Lc[Ld++],Lh=Lc[Ld],Li=LE.getBindFun(Lh);Lf[Lg]=Li.call(this,Lb)}},Lc.refresh=function(){this.array=this._array},Lc.getItem=function(La){return-1<La&&La<this._array.length?this._array[La]:null},Lc.changeItem=function(La,Lb){-1<La&&La<this._array.length&&(this._array[La]=Lb,La>=this._startIndex&&La<this._startIndex+this._cells.length&&this.renderItem(this.getCell(La),La))},Lc.setItem=function(La,Lb){this.changeItem(La,Lb)},Lc.addItem=function(La){this._array.push(La),this.array=this._array},Lc.addItemAt=function(La,Lb){this._array.splice(Lb,0,La),this.array=this._array},Lc.deleteItem=function(La){this._array.splice(La,1),this.array=this._array},Lc.getCell=function(La){return this.runCallLater(this.changeCells),-1<La&&this._cells?this._cells[(La-this._startIndex)%this._cells.length]:null},Lc.scrollTo=function(La){if(this._scrollBar){var Lb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(La/Lb)*this._cellSize}else this.startIndex=La},Lc.tweenTo=function(La,Lb,Lc){if(void 0===Lb&&(Lb=200),this._scrollBar){var Ld=this._isVertical?this.repeatX:this.repeatY;Lz.to(this._scrollBar,{value:Math.floor(La/Ld)*this._cellSize},Lb,null,Lc,0,!0)}else this.startIndex=La,Lc&&Lc.run()},Lc._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},Lc.commitMeasure=function(){this.runCallLater(this.changeCells)},Lg(0,Lc,"cacheAs",La.prototype._$get_cacheAs,function(La){Lp.superSet(LJ,this,"cacheAs",La),this._scrollBar&&(this._$P.cacheAs=null,"none"!==La?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),Lg(0,Lc,"content",function(){return this._content}),Lg(0,Lc,"height",La.prototype._$get_height,function(La){La!=this._height&&(Lp.superSet(LJ,this,"height",La),this._setCellChanged())}),Lg(0,Lc,"itemRender",function(){return this._itemRender},function(La){if(this._itemRender!=La){this._itemRender=La;for(var Lb=this._cells.length-1;-1<Lb;Lb--)this._cells[Lb].destroy();this._cells.length=0,this._setCellChanged()}}),Lg(0,Lc,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(La){this._removePreScrollBar();var Lb=new Lba;Lb.name="scrollBar",Lb.right=0,La&&" "!=La&&(Lb.skin=La),this.scrollBar=Lb,this.addChild(Lb),this._setCellChanged()}),Lg(0,Lc,"page",function(){return this._page},function(La){this._page=La,this._array&&(this._page=0<La?La:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),Lg(0,Lc,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(La){this._removePreScrollBar();var Lb=new LY;Lb.name="scrollBar",Lb.bottom=0,La&&" "!=La&&(Lb.skin=La),this.scrollBar=Lb,this.addChild(Lb),this._setCellChanged()}),Lg(0,Lc,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(La){this._repeatX=La,this._setCellChanged()}),Lg(0,Lc,"scrollBar",function(){return this._scrollBar},function(La){this._scrollBar!=La&&(this._scrollBar=La)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),Lg(0,Lc,"width",La.prototype._$get_width,function(La){La!=this._width&&(Lp.superSet(LJ,this,"width",La),this._setCellChanged())}),Lg(0,Lc,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(La){this._repeatY=La,this._setCellChanged()}),Lg(0,Lc,"spaceX",function(){return this._spaceX},function(La){this._spaceX=La,this._setCellChanged()}),Lg(0,Lc,"spaceY",function(){return this._spaceY},function(La){this._spaceY=La,this._setCellChanged()}),Lg(0,Lc,"selectedIndex",function(){return this._selectedIndex},function(La){this._selectedIndex!=La&&(this._selectedIndex=La,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(La),this.startIndex=this._startIndex)}),Lg(0,Lc,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(La){this.selectedIndex=this._array.indexOf(La)}),Lg(0,Lc,"length",function(){return this._array?this._array.length:0}),Lg(0,Lc,"selection",function(){return this.getCell(this._selectedIndex)},function(La){this.selectedIndex=this._startIndex+this._cells.indexOf(La)}),Lg(0,Lc,"startIndex",function(){return this._startIndex},function(La){this._startIndex=0<La?La:0,this.callLater(this.renderItems)}),Lg(0,Lc,"twSwitch",function(){return this._twSwitch},function(La){this._twSwitch=La}),Lg(0,Lc,"twDone",function(){return this._twDone},function(La){this._twDone=La}),Lg(0,Lc,"array",function(){return this._array},function(La){this.runCallLater(this.changeCells),this._array=La||[];var Lb=this._array.length;if(this.totalPage=Math.ceil(Lb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Lb?this._selectedIndex:Lb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var Lc=this._isVertical?this.repeatX:this.repeatY,Ld=this._isVertical?this.repeatY:this.repeatX,Le=Math.ceil(Lb/Lc);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Ld/Le,this._scrollBar.setScroll(0,(Le-Ld)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),Lg(0,Lc,"dataSource",La.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)&&Math.floor(La)==La||"string"==typeof La?this.selectedIndex=parseInt(La):La instanceof Array?this.array=La:Lp.superSet(LJ,this,"dataSource",La)}),Lg(0,Lc,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Lb}(LJ),LY=function(La){function Lb(){Lb.__super.call(this)}return Lf(Lb,"laya.ui.HScrollBar",La),Lb.prototype.initialize=function(){La.prototype.initialize.call(this),this.slider.isVertical=!1},Lb}(LO),LZ=function(La){function Lb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Lb.__super.call(this),this.width=this.height=100}Lf(Lb,"laya.ui.Panel",La);var Lc=Lb.prototype;return Lc.destroy=function(La){void 0===La&&(La=!0),laya.ui.Component.prototype.destroy.call(this,La),this._content&&this._content.destroy(La),this._vScrollBar&&this._vScrollBar.destroy(La),this._hScrollBar&&this._hScrollBar.destroy(La),this._vScrollBar=null,this._hScrollBar=null,this._content=null},Lc.destroyChildren=function(){this._content.destroyChildren()},Lc.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new LJ)},Lc.addChild=function(La){return La.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(La)},Lc.onResize=function(){this._setScrollChanged()},Lc.addChildAt=function(La,Lb){return La.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(La,Lb)},Lc.removeChild=function(La){return La.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(La)},Lc.removeChildAt=function(La){return this.getChildAt(La).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(La)},Lc.removeChildren=function(La,Lb){return void 0===La&&(La=0),void 0===Lb&&(Lb=2147483647),this._content.removeChildren(La,Lb),this._setScrollChanged(),this},Lc.getChildAt=function(La){return this._content.getChildAt(La)},Lc.getChildByName=function(La){return this._content.getChildByName(La)},Lc.getChildIndex=function(La){return this._content.getChildIndex(La)},Lc.changeScroll=function(){this._scrollChanged=!1;var La=this.contentWidth||1,Lb=this.contentHeight||1,Lc=this._vScrollBar,Ld=this._hScrollBar,Le=Lc&&Lb>this._height,Lf=Ld&&La>this._width,Lg=Le?this._width-Lc.width:this._width,Lh=Lf?this._height-Ld.height:this._height;Lc&&(Lc.x=this._width-Lc.width,Lc.y=0,Lc.height=this._height-(Lf?Ld.height:0),Lc.scrollSize=Math.max(.033*this._height,1),Lc.thumbPercent=Lh/Lb,Lc.setScroll(0,Lb-Lh,Lc.value)),Ld&&(Ld.x=0,Ld.y=this._height-Ld.height,Ld.width=this._width-(Le?Lc.width:0),Ld.scrollSize=Math.max(.033*this._width,1),Ld.thumbPercent=Lg/La,Ld.setScroll(0,La-Lg,Ld.value))},Lc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},Lc.setContentSize=function(La,Lb){var Lc=this._content;Lc.width=La,Lc.height=Lb,Lc.scrollRect||(Lc.scrollRect=new Lr),Lc.scrollRect.setTo(0,0,La,Lb),Lc.scrollRect=Lc.scrollRect},Lc.onScrollBarChange=function(La){var Lb=this._content.scrollRect;if(Lb){var Lc=Math.round(La.value);La.isVertical?Lb.y=Lc:Lb.x=Lc,this._content.scrollRect=Lb}},Lc.scrollTo=function(La,Lb){void 0===La&&(La=0),void 0===Lb&&(Lb=0),this.vScrollBar&&(this.vScrollBar.value=Lb),this.hScrollBar&&(this.hScrollBar.value=La)},Lc.refresh=function(){this.changeScroll()},Lc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Lp.superGet(LJ,this,"cacheAs")),Lp.superSet(LJ,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},Lc.onScrollEnd=function(){Lp.superSet(LJ,this,"cacheAs",this._$P.cacheAs)},Lc._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},Lg(0,Lc,"numChildren",function(){return this._content.numChildren}),Lg(0,Lc,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(La){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new LY),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=La}),Lg(0,Lc,"contentWidth",function(){for(var La=0,Lb=this._content.numChildren-1;-1<Lb;Lb--){var Lc=this._content.getChildAt(Lb);La=Math.max(Lc.x+Lc.width*Lc.scaleX,La)}return La}),Lg(0,Lc,"contentHeight",function(){for(var La=0,Lb=this._content.numChildren-1;-1<Lb;Lb--){var Lc=this._content.getChildAt(Lb);La=Math.max(Lc.y+Lc.height*Lc.scaleY,La)}return La}),Lg(0,Lc,"width",La.prototype._$get_width,function(La){Lp.superSet(LJ,this,"width",La),this._setScrollChanged()}),Lg(0,Lc,"hScrollBar",function(){return this._hScrollBar}),Lg(0,Lc,"content",function(){return this._content}),Lg(0,Lc,"height",La.prototype._$get_height,function(La){Lp.superSet(LJ,this,"height",La),this._setScrollChanged()}),Lg(0,Lc,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(La){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Lba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=La}),Lg(0,Lc,"vScrollBar",function(){return this._vScrollBar}),Lg(0,Lc,"cacheAs",La.prototype._$get_cacheAs,function(La){Lp.superSet(LJ,this,"cacheAs",La),this._$P.cacheAs=null,"none"!==La?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Lb}(LJ),L$=function(La){function Lb(La){Lb.__super.call(this,La),this.isVertical=!1}return Lf(Lb,"laya.ui.HSlider",LP),Lb}(),L_=function(La){function Lc(La,Lb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,Lc.__super.call(this),this.skin=Lb,this.labels=La}Lf(Lc,"laya.ui.UIGroup",La);var Lb=Lc.prototype;return Lp.imps(Lb,{"laya.ui.IItem":!0}),Lb.preinitialize=function(){this.mouseEnabled=!0},Lb.destroy=function(La){void 0===La&&(La=!0),laya.ui.Component.prototype.destroy.call(this,La),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Lb.addItem=function(La,Lb){void 0===Lb&&(Lb=!0);var Lc=La,Ld=this._items.length;if(Lc.name="item"+Ld,this.addChild(Lc),this.initItems(),Lb&&0<Ld){var Le=this._items[Ld-1];"horizontal"==this._direction?Lc.x=Le.x+Le.width+this._space:Lc.y=Le.y+Le.height+this._space}else Lb&&(Lc.x=0,Lc.y=0);return Ld},Lb.delItem=function(La,Lb){void 0===Lb&&(Lb=!0);var Lc=this._items.indexOf(La);if(-1!=Lc){var Ld=La;this.removeChild(Ld);for(var Le=Lc+1,Lf=this._items.length;Le<Lf;Le++){var Lg=this._items[Le];Lg.name="item"+(Le-1),Lb&&("horizontal"==this._direction?Lg.x-=Ld.width+this._space:Lg.y-=Ld.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var Lh;Lh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=Lh}}},Lb.initItems=function(){this._items||(this._items=[]);for(var La=this._items.length=0;La<1e4;La++){var Lb=this.getChildByName("item"+La);if(null==Lb)break;this._items.push(Lb),Lb.selected=La===this._selectedIndex,Lb.clickHandler=Lm.create(this,this.itemClick,[La],!1)}},Lb.itemClick=function(La){this.selectedIndex=La},Lb.setSelect=function(La,Lb){this._items&&-1<La&&La<this._items.length&&(this._items[La].selected=Lb)},Lb.createItem=function(La,Lb){return null},Lb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var La=0,Lb=0,Lc=this._items.length;Lb<Lc;Lb++){var Ld=this._items[Lb];this._skin&&(Ld.skin=this._skin),this._labelColors&&(Ld.labelColors=this._labelColors),this._labelSize&&(Ld.labelSize=this._labelSize),this._labelStroke&&(Ld.labelStroke=this._labelStroke),this._labelStrokeColor&&(Ld.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Ld.strokeColors=this._strokeColors),this._labelBold&&(Ld.labelBold=this._labelBold),this._labelPadding&&(Ld.labelPadding=this._labelPadding),this._labelAlign&&(Ld.labelAlign=this._labelAlign),this._stateNum&&(Ld.stateNum=this._stateNum),this._labelFont&&(Ld.labelFont=this._labelFont),"horizontal"===this._direction?(Ld.y=0,Ld.x=La,La+=Ld.width+this._space):(Ld.x=0,Ld.y=La,La+=Ld.height+this._space)}this.changeSize()},Lb.commitMeasure=function(){this.runCallLater(this.changeLabels)},Lb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},Lg(0,Lb,"labelStrokeColor",function(){return this._labelStrokeColor},function(La){this._labelStrokeColor!=La&&(this._labelStrokeColor=La,this._setLabelChanged())}),Lg(0,Lb,"skin",function(){return this._skin},function(La){this._skin!=La&&(this._skin=La,this._setLabelChanged())}),Lg(0,Lb,"selectedIndex",function(){return this._selectedIndex},function(La){this._selectedIndex!=La&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=La,this.setSelect(La,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),Lg(0,Lb,"labels",function(){return this._labels},function(La){if(this._labels!=La){if(this._labels=La,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Lb=this._labels.split(","),Lc=0,Ld=Lb.length;Lc<Ld;Lc++){var Le=this.createItem(this._skin,Lb[Lc]);Le.name="item"+Lc,this.addChild(Le)}this.initItems()}}),Lg(0,Lb,"strokeColors",function(){return this._strokeColors},function(La){this._strokeColors!=La&&(this._strokeColors=La,this._setLabelChanged())}),Lg(0,Lb,"labelColors",function(){return this._labelColors},function(La){this._labelColors!=La&&(this._labelColors=La,this._setLabelChanged())}),Lg(0,Lb,"labelStroke",function(){return this._labelStroke},function(La){this._labelStroke!=La&&(this._labelStroke=La,this._setLabelChanged())}),Lg(0,Lb,"labelSize",function(){return this._labelSize},function(La){this._labelSize!=La&&(this._labelSize=La,this._setLabelChanged())}),Lg(0,Lb,"stateNum",function(){return this._stateNum},function(La){this._stateNum!=La&&(this._stateNum=La,this._setLabelChanged())}),Lg(0,Lb,"labelBold",function(){return this._labelBold},function(La){this._labelBold!=La&&(this._labelBold=La,this._setLabelChanged())}),Lg(0,Lb,"labelFont",function(){return this._labelFont},function(La){this._labelFont!=La&&(this._labelFont=La,this._setLabelChanged())}),Lg(0,Lb,"labelPadding",function(){return this._labelPadding},function(La){this._labelPadding!=La&&(this._labelPadding=La,this._setLabelChanged())}),Lg(0,Lb,"direction",function(){return this._direction},function(La){this._direction=La,this._setLabelChanged()}),Lg(0,Lb,"space",function(){return this._space},function(La){this._space=La,this._setLabelChanged()}),Lg(0,Lb,"items",function(){return this._items}),Lg(0,Lb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(La){this.selectedIndex=this._items.indexOf(La)}),Lg(0,Lb,"dataSource",La.prototype._$get_dataSource,function(La){"number"==typeof(this._dataSource=La)&&Math.floor(La)==La||"string"==typeof La?this.selectedIndex=parseInt(La):La instanceof Array?this.labels=La.join(","):Lp.superSet(LJ,this,"dataSource",La)}),Lc}(LJ),Lw=function(Lb){function Lc(La,Lb){this._value=null,void 0===Lb&&(Lb=""),Lc.__super.call(this,La,Lb)}Lf(Lc,"laya.ui.Radio",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._value=null},La.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},La.initialize=function(){Lb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},La.onClick=function(La){this.selected=!0},Lg(0,La,"value",function(){return null!=this._value?this._value:this.label},function(La){this._value=La}),Lc}(LK),Lx=function(La){function Lb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Lb.__super.call(this),this.width=this.height=200}Lf(Lb,"laya.ui.Tree",La);var Lc=Lb.prototype;return Lp.imps(Lc,{"laya.ui.IRender":!0}),Lc.destroy=function(La){void 0===La&&(La=!0),laya.ui.Component.prototype.destroy.call(this,La),this._list&&this._list.destroy(La),this._list=null,this._source=null,this._renderHandler=null},Lc.createChildren=function(){this.addChild(this._list=new LX),this._list.renderHandler=Lm.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},Lc.onListChange=function(La){this.event("change")},Lc.getArray=function(){var La,Lb=[];for(var Lc in this._source)La=this._source[Lc],this.getParentOpenStatus(La)&&(La.x=this._spaceLeft*this.getDepth(La),Lb.push(La));return Lb},Lc.getDepth=function(La,Lb){return void 0===Lb&&(Lb=0),null==La.nodeParent?Lb:this.getDepth(La.nodeParent,Lb+1)},Lc.getParentOpenStatus=function(La){var Lb=La.nodeParent;return null==Lb||!!Lb.isOpen&&(null==Lb.nodeParent||this.getParentOpenStatus(Lb))},Lc.renderItem=function(La,Lb){var Lc=La.dataSource;if(Lc){La.left=Lc.x;var Ld=La.getChildByName("arrow");Ld&&(Lc.hasChild?(Ld.visible=!0,Ld.index=Lc.isOpen?1:0,Ld.tag=Lb,Ld.off("click",this,this.onArrowClick),Ld.on("click",this,this.onArrowClick)):Ld.visible=!1);var Le=La.getChildByName("folder");Le&&(2==Le.clipY?Le.index=Lc.isDirectory?0:1:Le.index=Lc.isDirectory?Lc.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([La,Lb])}},Lc.onArrowClick=function(La){var Lb=La.currentTarget.tag;this._list.array[Lb].isOpen=!this._list.array[Lb].isOpen,this.event("open"),this._list.array=this.getArray()},Lc.setItemState=function(La,Lb){this._list.array[La]&&(this._list.array[La].isOpen=Lb,this._list.array=this.getArray())},Lc.fresh=function(){this._list.array=this.getArray(),this.repaint()},Lc.parseXml=function(La,Lb,Lc,Ld){var Le,Lf=La.childNodes,Lg=Lf.length;if(!Ld){Le={};var Lh,Li=La.attributes;for(var Lj in Li){var Lk=(Lh=Li[Lj]).nodeName,Ll=Lh.nodeValue;Le[Lk]="true"==Ll||"false"!=Ll&&Ll}Le.nodeParent=Lc,0<Lg&&(Le.isDirectory=!0),Le.hasChild=0<Lg,Lb.push(Le)}for(var Lm=0;Lm<Lg;Lm++){var Ln=Lf[Lm];this.parseXml(Ln,Lb,Le,!1)}},Lc.parseOpenStatus=function(La,Lb){for(var Lc=0,Ld=Lb.length;Lc<Ld;Lc++){var Le=Lb[Lc];if(Le.isDirectory)for(var Lf=0,Lg=La.length;Lf<Lg;Lf++){var Lh=La[Lf];if(Lh.isDirectory&&this.isSameParent(Lh,Le)&&Le.label==Lh.label){Le.isOpen=Lh.isOpen;break}}}},Lc.isSameParent=function(La,Lb){return null==La.nodeParent&&null==Lb.nodeParent||null!=La.nodeParent&&null!=Lb.nodeParent&&(La.nodeParent.label==Lb.nodeParent.label&&this.isSameParent(La.nodeParent,Lb.nodeParent))},Lc.filter=function(La){if(Boolean(La)){var Lb=[];this.getFilterSource(this._source,Lb,La),this._list.array=Lb}else this._list.array=this.getArray()},Lc.getFilterSource=function(La,Lb,Lc){var Ld;for(var Le in Lc=Lc.toLocaleLowerCase(),La)!(Ld=La[Le]).isDirectory&&-1<String(Ld.label).toLowerCase().indexOf(Lc)&&(Ld.x=0,Lb.push(Ld)),Ld.child&&0<Ld.child.length&&this.getFilterSource(Ld.child,Lb,Lc)},Lg(0,Lc,"spaceBottom",function(){return this._list.spaceY},function(La){this._list.spaceY=La}),Lg(0,Lc,"keepStatus",function(){return this._keepStatus},function(La){this._keepStatus=La}),Lg(0,Lc,"itemRender",function(){return this._list.itemRender},function(La){this._list.itemRender=La}),Lg(0,Lc,"array",function(){return this._list.array},function(La){this._keepStatus&&this._list.array&&La&&this.parseOpenStatus(this._list.array,La),this._source=La,this._list.array=this.getArray()}),Lg(0,Lc,"mouseHandler",function(){return this._list.mouseHandler},function(La){this._list.mouseHandler=La}),Lg(0,Lc,"dataSource",La.prototype._$get_dataSource,function(La){this._dataSource=La,Lp.superSet(LJ,this,"dataSource",La)}),Lg(0,Lc,"source",function(){return this._source}),Lg(0,Lc,"scrollBar",function(){return this._list.scrollBar}),Lg(0,Lc,"list",function(){return this._list}),Lg(0,Lc,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(La){this._list.vScrollBarSkin=La}),Lg(0,Lc,"renderHandler",function(){return this._renderHandler},function(La){this._renderHandler=La}),Lg(0,Lc,"selectedIndex",function(){return this._list.selectedIndex},function(La){this._list.selectedIndex=La}),Lg(0,Lc,"spaceLeft",function(){return this._spaceLeft},function(La){this._spaceLeft=La}),Lg(0,Lc,"selectedItem",function(){return this._list.selectedItem},function(La){this._list.selectedItem=La}),Lg(0,Lc,"width",La.prototype._$get_width,function(La){Lp.superSet(LJ,this,"width",La),this._list.width=La}),Lg(0,Lc,"height",La.prototype._$get_height,function(La){Lp.superSet(LJ,this,"height",La),this._list.height=La}),Lg(0,Lc,"xml",null,function(La){var Lb=[];this.parseXml(La.childNodes[0],Lb,null,!0),this.array=Lb}),Lg(0,Lc,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Lb}(LJ),Laa=function(La){function Lb(){this._items=null,this._selectedIndex=0,Lb.__super.call(this),this._setIndexHandler=Lm.create(this,this.setIndex,null,!1)}Lf(Lb,"laya.ui.ViewStack",La);var Lc=Lb.prototype;return Lp.imps(Lc,{"laya.ui.IItem":!0}),Lc.setItems=function(La){this.removeChildren();for(var Lb=0,Lc=0,Ld=La.length;Lc<Ld;Lc++){var Le=La[Lc];Le&&(Le.name="item"+Lb,this.addChild(Le),Lb++)}this.initItems()},Lc.addItem=function(La){La.name="item"+this._items.length,this.addChild(La),this.initItems()},Lc.initItems=function(){this._items=[];for(var La=0;La<1e4;La++){var Lb=this.getChildByName("item"+La);if(null==Lb)break;this._items.push(Lb),Lb.visible=La==this._selectedIndex}},Lc.setSelect=function(La,Lb){this._items&&-1<La&&La<this._items.length&&(this._items[La].visible=Lb)},Lc.setIndex=function(La){this.selectedIndex=La},Lg(0,Lc,"dataSource",La.prototype._$get_dataSource,function(La){if("number"==typeof(this._dataSource=La)&&Math.floor(La)==La||"string"==typeof La)this.selectedIndex=parseInt(La);else for(var Lb in this._dataSource)this.hasOwnProperty(Lb)&&(this[Lb]=this._dataSource[Lb])}),Lg(0,Lc,"selectedIndex",function(){return this._selectedIndex},function(La){this._selectedIndex!=La&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=La,this.setSelect(this._selectedIndex,!0))}),Lg(0,Lc,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(La){this.selectedIndex=this._items.indexOf(La)}),Lg(0,Lc,"items",function(){return this._items}),Lg(0,Lc,"setIndexHandler",function(){return this._setIndexHandler},function(La){this._setIndexHandler=La}),Lb}(LJ),Lba=function(La){function Lb(){Lb.__super.call(this)}return Lf(Lb,"laya.ui.VScrollBar",LO),Lb}(),Lca=function(Lb){function Lc(La){this._bg=null,this._skin=null,Lc.__super.call(this),void 0===La&&(La=""),this.text=La,this.skin=this.skin}Lf(Lc,"laya.ui.TextInput",Lb);var La=Lc.prototype;return La.preinitialize=function(){this.mouseEnabled=!0},La.destroy=function(La){Ls.clearCache(this,this._skin),void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._bg&&this._bg.destroy(),this._bg=null},La.createChildren=function(){this.addChild(this._tf=new Ln),this._tf.padding=LD.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},La._onFocus=function(){this.event("focus",this)},La._onBlur=function(){this.event("blur",this)},La._onInput=function(){this.event("input",this)},La._onEnter=function(){this.event("enter",this)},La.initialize=function(){this.width=128,this.height=22},La.select=function(){this._tf.select()},La.setSelection=function(La,Lb){this._tf.setSelection(La,Lb)},Lg(0,La,"text",Lb.prototype._$get_text,function(La){this._tf.text!=La&&(La+="",this._tf.text=La,this.event("change"))}),Lg(0,La,"bg",function(){return this._bg},function(La){this.graphics=this._bg=La}),Lg(0,La,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(La){this._tf.inputElementYAdjuster=La}),Lg(0,La,"multiline",function(){return this._tf.multiline},function(La){this._tf.multiline=La}),Lg(0,La,"skin",function(){return this._skin},function(La){this._skin!=La&&(Ls.clearCache(this,this._skin),this._skin=La,this._bg||(this.graphics=this._bg=new LG),Ls.keepCache(this,this._skin),this._bg.source=Ls.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),Lg(0,La,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(La){this._bg||(this.graphics=this._bg=new LG),this._bg.sizeGrid=LE.fillArray(LD.defaultSizeGrid,La,Number)}),Lg(0,La,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(La){this._tf.inputElementXAdjuster=La}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(LR,this,"width",La),this._bg&&(this._bg.width=La)}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(LR,this,"height",La),this._bg&&(this._bg.height=La)}),Lg(0,La,"editable",function(){return this._tf.editable},function(La){this._tf.editable=La}),Lg(0,La,"restrict",function(){return this._tf.restrict},function(La){this._tf.restrict=La}),Lg(0,La,"prompt",function(){return this._tf.prompt},function(La){this._tf.prompt=La}),Lg(0,La,"promptColor",function(){return this._tf.promptColor},function(La){this._tf.promptColor=La}),Lg(0,La,"maxChars",function(){return this._tf.maxChars},function(La){this._tf.maxChars=La}),Lg(0,La,"focus",function(){return this._tf.focus},function(La){this._tf.focus=La}),Lg(0,La,"type",function(){return this._tf.type},function(La){this._tf.type=La}),Lg(0,La,"asPassword",function(){return this._tf.asPassword},function(La){this._tf.asPassword=La}),Lc}(LR),Lda=function(La){function Lb(){Lb.__super.call(this)}return Lf(Lb,"laya.ui.VSlider",LP),Lb}(),Lea=function(La){function Ld(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Ld.__super.call(this)}Lf(Ld,"laya.ui.Dialog",La);var Lb=Ld.prototype;return Lb.initialize=function(){this.popupEffect=Ld.manager.popupEffectHandler,this.closeEffect=Ld.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Lb._dealDragArea=function(){var La=this.getChildByName("drag");La&&(this.dragArea=La.x+","+La.y+","+La.width+","+La.height,La.removeSelf())},Lb._onClick=function(La){var Lb=La.target;if(Lb)switch(Lb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Lb.name)}},Lb.show=function(La,Lb){void 0===La&&(La=!1),void 0===Lb&&(Lb=!0),this._open(!1,La,Lb)},Lb.popup=function(La,Lb){void 0===La&&(La=!1),void 0===Lb&&(Lb=!0),this._open(!0,La,Lb)},Lb._open=function(La,Lb,Lc){Ld.manager.lock(!1),this.isModal=La,Ld.manager.open(this,Lb,Lc)},Lb.onOpened=function(){},Lb.close=function(La,Lb){void 0===Lb&&(Lb=!0),Ld.manager.close(this,La,Lb)},Lb.onClosed=function(La){},Lb._onMouseDown=function(La){var Lb=this.getMousePoint();this._dragArea.contains(Lb.x,Lb.y)?this.startDrag():this.stopDrag()},Lg(0,Lb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(La){if(La){var Lb=LE.fillArray([0,0,0,0],La,Number);this._dragArea=new Lr(Lb[0],Lb[1],Lb[2],Lb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),Lg(0,Lb,"isPopup",function(){return null!=this.parent}),Lg(0,Lb,"zOrder",La.prototype._$get_zOrder,function(La){Lp.superSet(LT,this,"zOrder",La),Ld.manager._checkMask()}),Lg(1,Ld,"manager",function(){return Ld._manager=Ld._manager||new LI},function(La){Ld._manager=La}),Ld.setLockView=function(La){Ld.manager.setLockView(La)},Ld.lock=function(La){Ld.manager.lock(La)},Ld.closeAll=function(){Ld.manager.closeAll()},Ld.getDialogsByGroup=function(La){return Ld.manager.getDialogsByGroup(La)},Ld.closeByGroup=function(La){return Ld.manager.closeByGroup(La)},Ld.CLOSE="close",Ld.CANCEL="cancel",Ld.SURE="sure",Ld.NO="no",Ld.OK="ok",Ld.YES="yes",Ld._manager=null,Ld}(LT),Lfa=function(La){function Lb(){Lb.__super.call(this)}Lf(Lb,"laya.ui.HBox",La);var Lc=Lb.prototype;return Lc.sortItem=function(La){La&&La.sort(function(La,Lb){return La.x-Lb.x})},Lc.changeItems=function(){this._itemChanged=!1;for(var La=[],Lb=0,Lc=0,Ld=this.numChildren;Lc<Ld;Lc++){var Le=this.getChildAt(Lc);Le&&Le.layoutEnabled&&(La.push(Le),Lb=this._height?this._height:Math.max(Lb,Le.height*Le.scaleY))}this.sortItem(La);var Lf=0;for(Lc=0,Ld=La.length;Lc<Ld;Lc++)(Le=La[Lc]).x=Lf,Lf+=Le.width*Le.scaleX+this._space,"top"==this._align?Le.y=0:"middle"==this._align?Le.y=.5*(Lb-Le.height*Le.scaleY):"bottom"==this._align&&(Le.y=Lb-Le.height*Le.scaleY);this.changeSize()},Lg(0,Lc,"height",La.prototype._$get_height,function(La){this._height!=La&&(Lp.superSet(LV,this,"height",La),this.callLater(this.changeItems))}),Lb.NONE="none",Lb.TOP="top",Lb.MIDDLE="middle",Lb.BOTTOM="bottom",Lb}(LV),Lga=function(La){function Lb(){Lb.__super.call(this)}Lf(Lb,"laya.ui.VBox",La);var Lc=Lb.prototype;return Lc.changeItems=function(){this._itemChanged=!1;for(var La=[],Lb=0,Lc=0,Ld=this.numChildren;Lc<Ld;Lc++){var Le=this.getChildAt(Lc);Le&&Le.layoutEnabled&&(La.push(Le),Lb=this._width?this._width:Math.max(Lb,Le.width*Le.scaleX))}this.sortItem(La);var Lf=0;for(Lc=0,Ld=La.length;Lc<Ld;Lc++)(Le=La[Lc]).y=Lf,Lf+=Le.height*Le.scaleY+this._space,"left"==this._align?Le.x=0:"center"==this._align?Le.x=.5*(Lb-Le.width*Le.scaleX):"right"==this._align&&(Le.x=Lb-Le.width*Le.scaleX);this.changeSize()},Lg(0,Lc,"width",La.prototype._$get_width,function(La){this._width!=La&&(Lp.superSet(LV,this,"width",La),this.callLater(this.changeItems))}),Lb.NONE="none",Lb.LEFT="left",Lb.CENTER="center",Lb.RIGHT="right",Lb}(LV),Lha=function(La){function Lb(){Lb.__super.call(this)}return Lf(Lb,"laya.ui.RadioGroup",L_),Lb.prototype.createItem=function(La,Lb){return new Lw(La,Lb)},Lb}(),Lia=function(La){function Lb(){Lb.__super.call(this)}return Lf(Lb,"laya.ui.Tab",L_),Lb.prototype.createItem=function(La,Lb){return new LK(La,Lb)},Lb}(),Lja=function(Lb){function Lc(La){this._vScrollBar=null,this._hScrollBar=null,void 0===La&&(La=""),Lc.__super.call(this,La)}Lf(Lc,"laya.ui.TextArea",Lb);var La=Lc.prototype;return La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},La.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},La.onVBarChanged=function(La){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},La.onHBarChanged=function(La){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},La.changeScroll=function(){var La=this._vScrollBar&&0<this._tf.maxScrollY,Lb=this._hScrollBar&&0<this._tf.maxScrollX,Lc=La?this._width-this._vScrollBar.width:this._width,Ld=Lb?this._height-this._hScrollBar.height:this._height,Le=this._tf.padding||LD.labelPadding;this._tf.width=Lc,this._tf.height=Ld,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-Le[2],this._vScrollBar.y=Le[1],this._vScrollBar.height=this._height-(Lb?this._hScrollBar.height:0)-Le[1]-Le[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Ld/Math.max(this._tf.textHeight,Ld),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=La),this._hScrollBar&&(this._hScrollBar.x=Le[0],this._hScrollBar.y=this._height-this._hScrollBar.height-Le[3],this._hScrollBar.width=this._width-(La?this._vScrollBar.width:0)-Le[0]-Le[2],this._hScrollBar.scrollSize=Math.max(.033*Lc,1),this._hScrollBar.thumbPercent=Lc/Math.max(this._tf.textWidth,Lc),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Lb)},La.scrollTo=function(La){this.commitMeasure(),this._tf.scrollY=La},Lg(0,La,"scrollY",function(){return this._tf.scrollY}),Lg(0,La,"width",Lb.prototype._$get_width,function(La){Lp.superSet(Lca,this,"width",La),this.callLater(this.changeScroll)}),Lg(0,La,"hScrollBar",function(){return this._hScrollBar}),Lg(0,La,"height",Lb.prototype._$get_height,function(La){Lp.superSet(Lca,this,"height",La),this.callLater(this.changeScroll)}),Lg(0,La,"maxScrollX",function(){return this._tf.maxScrollX}),Lg(0,La,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(La){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Lba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=La}),Lg(0,La,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(La){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new LY),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=La}),Lg(0,La,"vScrollBar",function(){return this._vScrollBar}),Lg(0,La,"maxScrollY",function(){return this._tf.maxScrollY}),Lg(0,La,"scrollX",function(){return this._tf.scrollX}),Lc}(Lca);!function(La){function Lb(){this._uiView=null,this.isCloseOther=!1,Lb.__super.call(this)}Lf(Lb,"laya.ui.AsynDialog",Lea);var Lc=Lb.prototype;Lc.createView=function(La){this._uiView=La},Lc._open=function(La,Lb,Lc){this.isModal=La,this.isCloseOther=Lb,Lea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},Lc.onCreated=function(){this.createUI(),this.onOpen()},Lc.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},Lc.onOpen=function(){Lea.manager.open(this,this.isCloseOther),Lea.manager.lock(!1)},Lc.close=function(La,Lb){void 0===Lb&&(Lb=!0),Lea.manager.close(this),this.onClose()},Lc.onClose=function(){},Lc.destroy=function(La){void 0===La&&(La=!0),laya.ui.View.prototype.destroy.call(this,La),this._uiView=null,this.onDestroy()},Lc.onDestroy=function(){}}();Lp.__init([LT])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(Lm,La,Lv){Lv.un,Lv.uns;var Ll=Lv.static,Ln=Lv.class,Lo=Lv.getset,Ld=Lv.__newvec,Lu=laya.maths.Arith,Lg=laya.webgl.atlas.AtlasResourceManager,Lc=laya.webgl.shader.BaseShader,LH=laya.utils.Browser,Lh=laya.webgl.utils.Buffer,Ly=laya.utils.Byte,Le=laya.utils.ClassUtils,Li=Lv.Config,Lf=(laya.events.Event,laya.events.EventDispatcher),LD=laya.utils.Handler,Lr=laya.net.Loader,Lb=laya.net.LoaderManager,Lj=(laya.maths.MathUtil,laya.display.Node),Lp=laya.renders.Render,Lk=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Lq=laya.resource.Resource,Ls=laya.utils.RunDriver,Lt=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Lz=laya.display.Sprite,LA=laya.utils.Stat,LB=laya.utils.StringKey,LE=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),LC=laya.utils.Utils,LF=laya.webgl.WebGL,LG=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;Lv.interface("laya.d3.core.IClone"),Lv.interface("laya.d3.graphics.IVertex"),Lv.interface("laya.d3.core.render.IUpdate"),Lv.interface("laya.d3.core.scene.ITreeNode"),Lv.interface("laya.d3.core.render.IRenderable");(function(){function LK(){}Ln(LK,"laya.d3.animation.AnimationClipParser01"),LK.READ_DATA=function(){LK._DATA.offset=LK._reader.getUint32(),LK._DATA.size=LK._reader.getUint32()},LK.READ_BLOCK=function(){for(var La=LK._BLOCK.count=LK._reader.getUint16(),Lb=LK._BLOCK.blockStarts=[],Lc=LK._BLOCK.blockLengths=[],Ld=0;Ld<La;Ld++)Lb.push(LK._reader.getUint32()),Lc.push(LK._reader.getUint32())},LK.READ_STRINGS=function(){var La=LK._reader.getUint32(),Lb=LK._reader.getUint16(),Lc=LK._reader.pos;LK._reader.pos=La+LK._DATA.offset;for(var Ld=0;Ld<Lb;Ld++)LK._strings[Ld]=LK._reader.readUTFString();LK._reader.pos=Lc},LK.parse=function(La,Lb){LK._animationClip=La;(LK._reader=Lb).__getBuffer();LK.READ_DATA(),LK.READ_BLOCK(),LK.READ_STRINGS();for(var Lc=0,Ld=LK._BLOCK.count;Lc<Ld;Lc++){var Le=Lb.getUint16(),Lf=LK._strings[Le],Lg=LK["READ_"+Lf];if(null==Lg)throw new Error("model file err,no this function:"+Le+" "+Lf);Lg.call()}},LK.READ_ANIMATIONS=function(){var La,Lb=0,Lc=0,Ld=LK._reader,Le=Ld.__getBuffer(),Lf=[],Lg=Ld.getUint8();for(Lf.length=Lg,Lb=0;Lb<Lg;Lb++)Lf[Lb]=Ld.getUint16();var Lh=[],Li=Ld.getUint16();for(Lh.length=Li,Lb=0;Lb<Li;Lb++)Lh[Lb]=Ld.getFloat32();var Lj=LK._animationClip;Lj.name=LK._strings[Ld.getUint16()];var Lk=Lj._duration=Ld.getFloat32();Lj.islooping=!!Ld.getByte(),Lj._frameRate=Ld.getInt16();var Ll=Ld.getInt16(),Lm=Lj._nodes=new Array;Lm.length=Ll,(Lj._publicClipDatas=[]).length=Ll;var Ln=Lj._nodesMap={},Lo=0,Lp=0;for(Lb=0;Lb<Ll;Lb++){La=Lm[Lb]=new LS;var Lq=Ld.getUint16(),Lr=La.path=[];for(Lr.length=Lq,Lc=0;Lc<Lq;Lc++)Lr[Lc]=LK._strings[Ld.getUint16()];var Ls=Lr.join("/"),Lt=Ln[Ls];Lt||(Ln[Ls]=Lt=[]),Lt.push(La);var Lu=Ld.getInt16();-1!==Lu&&(La.componentType=LK._strings[Lu]);var Lv=LQ._propertyIndexDic[LK._strings[Ld.getUint16()]];if(null==Lv)throw new Error("AnimationClipParser01:unknown property name.");var Ly=Lv<4,Lz=!Ly||Ly&&""===Lr[0];(La._cacheProperty=Lz)?Lo++:Lp++,La.propertyNameID=Lv;var LA=Lf[Ld.getUint8()];La.keyFrameWidth=LA/4;var LB=La.keyFrames=[],LC=LB.length=Ld.getUint16(),LD=null,LE=NaN;for(Lc=0;Lc<LC;Lc++){var LF=LB[Lc]=new LR;LE=LF.startTime=Lh[Ld.getUint16()];var LG=Ld.pos;LF.inTangent=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LG=Ld.pos,LF.outTangent=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LG=Ld.pos,LF.data=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LD&&(LD.next=LF,LD.duration=LE-LD.startTime),LD=LF}LF.next=null,LF.duration=Lk-LE}var LH=Lj._nodeToCachePropertyMap=new Int32Array(Ll),LI=Lj._cachePropertyMap=new Int32Array(Lo),LJ=Lj._unCachePropertyMap=new Int32Array(Lp);for(Lo=Lp=0,Lb=0;Lb<Ll;Lb++)(La=Lm[Lb])._cacheProperty?(LH[Lb]=Lo,LI[Lo++]=Lb):LJ[Lp++]=Lb},LK._animationClip=null,LK._reader=null,LK._strings=[],Ll(LK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function LO(){}Ln(LO,"laya.d3.animation.AnimationClipParser02"),LO.READ_DATA=function(){LO._DATA.offset=LO._reader.getUint32(),LO._DATA.size=LO._reader.getUint32()},LO.READ_BLOCK=function(){for(var La=LO._BLOCK.count=LO._reader.getUint16(),Lb=LO._BLOCK.blockStarts=[],Lc=LO._BLOCK.blockLengths=[],Ld=0;Ld<La;Ld++)Lb.push(LO._reader.getUint32()),Lc.push(LO._reader.getUint32())},LO.READ_STRINGS=function(){var La=LO._reader.getUint32(),Lb=LO._reader.getUint16(),Lc=LO._reader.pos;LO._reader.pos=La+LO._DATA.offset;for(var Ld=0;Ld<Lb;Ld++)LO._strings[Ld]=LO._reader.readUTFString();LO._reader.pos=Lc},LO.parse=function(La,Lb){LO._animationClip=La;(LO._reader=Lb).__getBuffer();LO.READ_DATA(),LO.READ_BLOCK(),LO.READ_STRINGS();for(var Lc=0,Ld=LO._BLOCK.count;Lc<Ld;Lc++){var Le=Lb.getUint16(),Lf=LO._strings[Le],Lg=LO["READ_"+Lf];if(null==Lg)throw new Error("model file err,no this function:"+Le+" "+Lf);Lg.call()}},LO.READ_ANIMATIONS=function(){var La,Lb=0,Lc=0,Ld=LO._reader,Le=Ld.__getBuffer(),Lf=[],Lg=Ld.getUint8();for(Lf.length=Lg,Lb=0;Lb<Lg;Lb++)Lf[Lb]=Ld.getUint16();var Lh=[],Li=Ld.getUint16();for(Lh.length=Li,Lb=0;Lb<Li;Lb++)Lh[Lb]=Ld.getFloat32();var Lj=LO._animationClip;Lj.name=LO._strings[Ld.getUint16()];var Lk=Lj._duration=Ld.getFloat32();Lj.islooping=!!Ld.getByte(),Lj._frameRate=Ld.getInt16();var Ll=Ld.getInt16(),Lm=Lj._nodes=new Array;Lm.length=Ll,(Lj._publicClipDatas=[]).length=Ll;var Ln=Lj._nodesMap={},Lo=0,Lp=0;for(Lb=0;Lb<Ll;Lb++){La=Lm[Lb]=new LS;var Lq=Ld.getUint16(),Lr=La.path=[];for(Lr.length=Lq,Lc=0;Lc<Lq;Lc++)Lr[Lc]=LO._strings[Ld.getUint16()];var Ls=Lr.join("/"),Lt=Ln[Ls];Lt||(Ln[Ls]=Lt=[]),Lt.push(La);var Lu=Ld.getInt16();-1!==Lu&&(La.componentType=LO._strings[Lu]);var Lv=LQ._propertyIndexDic[LO._strings[Ld.getUint16()]];if(null==Lv)throw new Error("AnimationClipParser02:unknown property name.");var Ly=Lv<4,Lz=!Ly||Ly&&""===Lr[0];(La._cacheProperty=Lz)?Lo++:Lp++,La.propertyNameID=Lv;var LA=Lf[Ld.getUint8()];La.keyFrameWidth=LA/4;var LB=La.keyFrames=[],LC=LB.length=Ld.getUint16(),LD=null,LE=NaN;for(Lc=0;Lc<LC;Lc++){var LF=LB[Lc]=new LR;LE=LF.startTime=Lh[Ld.getUint16()];var LG=Ld.pos;LF.inTangent=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LG=Ld.pos,LF.outTangent=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LG=Ld.pos,LF.data=new Float32Array(Le.slice(LG,LG+LA)),Ld.pos+=LA,LD&&(LD.next=LF,LD.duration=LE-LD.startTime),LD=LF}LF.next=null,LF.duration=Lk-LE}var LH=Ld.getUint16();for(Lb=0;Lb<LH;Lb++){var LI,LJ=new LP;LJ.time=Ld.getFloat32(),LJ.eventName=LO._strings[Ld.getUint16()];var LK=Ld.getUint16();for(0<LK&&(LJ.params=LI=[]),Lc=0;Lc<LK;Lc++){switch(Ld.getByte()){case 0:LI.push(!!Ld.getByte());break;case 1:LI.push(Ld.getInt32());break;case 2:LI.push(Ld.getFloat32());break;case 3:LI.push(LO._strings[Ld.getUint16()]);break;default:throw new Error("unknown type.")}}Lj.addEvent(LJ)}var LL=Lj._nodeToCachePropertyMap=new Int32Array(Ll),LM=Lj._cachePropertyMap=new Int32Array(Lo),LN=Lj._unCachePropertyMap=new Int32Array(Lp);for(Lo=Lp=0,Lb=0;Lb<Ll;Lb++)(La=Lm[Lb])._cacheProperty?(LL[Lb]=Lo,LM[Lo++]=Lb):LN[Lp++]=Lb},LO._animationClip=null,LO._reader=null,LO._strings=[],Ll(LO,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var LP=function(){function La(){this.time=NaN,this.eventName=null,this.params=null}return Ln(La,"laya.d3.animation.AnimationEvent"),La}(),LQ=function(){function Ld(){this._childs=[],this.transform=new Lsb(this)}Ln(Ld,"laya.d3.animation.AnimationNode");var La=Ld.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.addChild=function(La){La._parent=this,La.transform.setParent(this.transform),this._childs.push(La)},La.removeChild=function(La){var Lb=this._childs.indexOf(La);-1!==Lb&&this._childs.splice(Lb,1)},La.getChildByName=function(La){for(var Lb=0,Lc=this._childs.length;Lb<Lc;Lb++){var Ld=this._childs[Lb];if(Ld.name===La)return Ld}return null},La.getChildByIndex=function(La){return this._childs[La]},La.getChildCount=function(){return this._childs.length},La.cloneTo=function(La){var Lb=La;Lb.name=this.name;for(var Lc=0,Ld=this._childs.length;Lc<Ld;Lc++){var Le=this._childs[Lc],Lf=Le.clone();Lb.addChild(Lf);var Lg=Le.transform,Lh=Lf.transform;Lh.setLocalPosition(Lg.getLocalPosition()),Lh.setLocalRotation(Lg.getLocalRotation()),Lh.setLocalScale(Lg.getLocalScale()),Lh._localRotationEuler=Lg._localRotationEuler,Lh._setWorldMatrixIgnoreUpdate(Lg.getWorldMatrix())}},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Ld.__init__=function(){Ld.registerAnimationNodeProperty("localPosition",Ld._getLocalPosition,Ld._setLocalPosition),Ld.registerAnimationNodeProperty("localRotation",Ld._getLocalRotation,Ld._setLocalRotation),Ld.registerAnimationNodeProperty("localScale",Ld._getLocalScale,Ld._setLocalScale),Ld.registerAnimationNodeProperty("localRotationEuler",Ld._getLocalRotationEuler,Ld._setLocalRotationEuler),Ld.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Ld._getParticleRenderSharedMaterialTintColor,Ld._setParticleRenderSharedMaterialTintColor),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Ld._getMeshRenderSharedMaterialTilingOffset,Ld._setMeshRenderSharedMaterialTilingOffset),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Ld._getMeshRenderSharedMaterialAlbedo,Ld._setMeshRenderSharedMaterialAlbedo),Ld.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Ld._getSkinnedMeshRenderSharedMaterialTilingOffset,Ld._setSkinnedMeshRenderSharedMaterialTilingOffset),Ld.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Ld._getSkinnedMeshRenderSharedMaterialAlbedo,Ld._setSkinnedMeshRenderSharedMaterialAlbedo),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Ld._getMeshRenderSharedMaterialAlbedo,Ld._setMeshRenderSharedMaterialAlbedo),Ld.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Ld._getSkinnedMeshRenderSharedMaterialAlbedo,Ld._setSkinnedMeshRenderSharedMaterialAlbedo),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Ld._getMeshRenderSharedMaterialIntensity,Ld._setMeshRenderSharedMaterialIntensity),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Ld._getMeshRenderSharedMaterialAlpha,Ld._setMeshRenderSharedMaterialAlpha),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Ld._getMeshRenderSharedMaterialAlphaColor,Ld._setMeshRenderSharedMaterialAlphaColor),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Ld._getMeshRenderSharedMaterialBaseColor,Ld._setMeshRenderSharedMaterialBaseColor),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Ld._getMeshRenderSharedMaterialDissolve,Ld._setMeshRenderSharedMaterialDissolve),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Ld._getMeshRenderSharedMaterialDissolveSpeed,Ld._setMeshRenderSharedMaterialDissolveSpeed),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Ld._getMeshRenderSharedMaterialMMultiplier,Ld._setMeshRenderSharedMaterialMMultiplier),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Ld._getMeshRenderSharedMaterialBaseScrollSpeedX,Ld._setMeshRenderSharedMaterialBaseScrollSpeedX),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Ld._getMeshRenderSharedMaterialBaseScrollSpeedY,Ld._setMeshRenderSharedMaterialBaseScrollSpeedY),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Ld._getMeshRenderSharedMaterialSecondScrollSpeedX,Ld._setMeshRenderSharedMaterialSecondScrollSpeedX),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Ld._getMeshRenderSharedMaterialSecondScrollSpeedY,Ld._setMeshRenderSharedMaterialSecondScrollSpeedY),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Ld._getMeshRenderSharedMaterialDetailTilingOffset,Ld._setMeshRenderSharedMaterialDetailTilingOffset),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Ld._getMeshRenderSharedMaterialDissolveTilingOffset,Ld._setMeshRenderSharedMaterialDissolveTilingOffset),Ld.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Ld._getMeshRenderSharedMaterialMaskTilingOffset,Ld._setMeshRenderSharedMaterialMaskTilingOffset)},Ld.registerAnimationNodeProperty=function(La,Lb,Lc){if(Ld._propertyIndexDic[La])throw new Error("AnimationNode: this propertyName has registered.");Ld._propertyIndexDic[La]=Ld._propertyIDCounter,Ld._propertyGetFuncs[Ld._propertyIDCounter]=Lb,Ld._propertySetFuncs[Ld._propertyIDCounter]=Lc,Ld._propertyIDCounter++},Ld._getLocalPosition=function(La,Lb){return La?La.transform.getLocalPosition():Lb._transform.localPosition.elements},Ld._setLocalPosition=function(La,Lb,Lc){if(La)La.transform.setLocalPosition(Lc);else{var Ld=Lb._transform,Le=Ld.localPosition;Le.elements=Lc,Ld.localPosition=Le}},Ld._getLocalRotation=function(La,Lb){return La?La.transform.getLocalRotation():Lb._transform.localRotation.elements},Ld._setLocalRotation=function(La,Lb,Lc){if(La)La.transform.setLocalRotation(Lc);else{var Ld=Lb._transform,Le=Ld.localRotation;Le.elements=Lc,Ld.localRotation=Le}},Ld._getLocalScale=function(La,Lb){return La?La.transform.getLocalScale():Lb._transform.localScale.elements},Ld._setLocalScale=function(La,Lb,Lc){if(La)La.transform.setLocalScale(Lc);else{var Ld=Lb._transform,Le=Ld.localScale;Le.elements=Lc,Ld.localScale=Le}},Ld._getLocalRotationEuler=function(La,Lb){return La?La.transform.getLocalRotationEuler():Lb._transform.localRotationEuler.elements},Ld._setLocalRotationEuler=function(La,Lb,Lc){if(La)La.transform.setLocalRotationEuler(Lc);else{var Ld=Lb._transform,Le=Ld.localRotationEuler;Le.elements=Lc,Ld.localRotationEuler=Le}},Ld._getMeshRenderSharedMaterialTilingOffset=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Lb.meshRender.sharedMaterial.tilingOffset.elements},Ld._setMeshRenderSharedMaterialTilingOffset=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).tilingOffset).elements=Lc,Ld.tilingOffset=Le)}else(Le=(Ld=Lb.meshRender.material).tilingOffset).elements=Lc,Ld.tilingOffset=Le},Ld._getMeshRenderSharedMaterialAlbedo=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Lb.meshRender.sharedMaterial.albedoColor.elements},Ld._setMeshRenderSharedMaterialAlbedo=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).albedoColor).elements=Lc,Ld.albedoColor=Le)}else(Le=(Ld=Lb.meshRender.material).albedoColor).elements=Lc,Ld.albedoColor=Le},Ld._getSkinnedMeshRenderSharedMaterialTilingOffset=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Lb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Ld._setSkinnedMeshRenderSharedMaterialTilingOffset=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.skinnedMeshRender.material).tilingOffset).elements=Lc,Ld.tilingOffset=Le)}else(Le=(Ld=Lb.skinnedMeshRender.material).tilingOffset).elements=Lc,Ld.tilingOffset=Le},Ld._getSkinnedMeshRenderSharedMaterialAlbedo=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Lb.skinnedMeshRender.sharedMaterial.albedoColor.elements},Ld._setSkinnedMeshRenderSharedMaterialAlbedo=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.skinnedMeshRender.material).albedoColor).elements=Lc,Ld.albedoColor=Le)}else(Le=(Ld=Lb.skinnedMeshRender.material).albedoColor).elements=Lc,Ld.albedoColor=Le},Ld._getParticleRenderSharedMaterialTintColor=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.particleRender.sharedMaterial.tintColor.elements:null}return Lb.particleRender.sharedMaterial.tintColor.elements},Ld._setParticleRenderSharedMaterialTintColor=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.particleRender.material).tintColor).elements=Lc,Ld.tintColor=Le)}else(Le=(Ld=Lb.particleRender.material).tintColor).elements=Lc,Ld.tintColor=Le},Ld._getMeshRenderSharedMaterialAlphaColor=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Lb.meshRender.sharedMaterial.alphaColor.elements},Ld._setMeshRenderSharedMaterialAlphaColor=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).alphaColor).elements=Lc,Ld.alphaColor=Le)}else(Le=(Ld=Lb.meshRender.material).alphaColor).elements=Lc,Ld.alphaColor=Le},Ld._getMeshRenderSharedMaterialBaseColor=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.baseColor.elements:null}return Lb.meshRender.sharedMaterial.baseColor.elements},Ld._setMeshRenderSharedMaterialBaseColor=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).baseColor).elements=Lc,Ld.baseColor=Le)}else(Le=(Ld=Lb.meshRender.material).baseColor).elements=Lc,Ld.baseColor=Le},Ld._getMeshRenderSharedMaterialDissolve=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.dissolve:0}return Lb.meshRender.sharedMaterial.dissolve},Ld._setMeshRenderSharedMaterialDissolve=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.dissolve=Lc[0])}else Lb.meshRender.material.dissolve=Lc[0]},Ld._getMeshRenderSharedMaterialDissolveSpeed=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Lb.meshRender.sharedMaterial.dissolveSpeed},Ld._setMeshRenderSharedMaterialDissolveSpeed=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.dissolveSpeed=Lc[0])}else Lb.meshRender.material.dissolveSpeed=Lc[0]},Ld._getMeshRenderSharedMaterialMMultiplier=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.mMultiplier:0}return Lb.meshRender.sharedMaterial.mMultiplier},Ld._setMeshRenderSharedMaterialMMultiplier=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.mMultiplier=Lc[0])}else Lb.meshRender.material.mMultiplier=Lc[0]},Ld._getMeshRenderSharedMaterialBaseScrollSpeedX=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Lb.meshRender.sharedMaterial.baseScrollSpeedX},Ld._setMeshRenderSharedMaterialBaseScrollSpeedX=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.baseScrollSpeedX=Lc[0])}else Lb.meshRender.material.baseScrollSpeedX=Lc[0]},Ld._getMeshRenderSharedMaterialBaseScrollSpeedY=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Lb.meshRender.sharedMaterial.baseScrollSpeedY},Ld._setMeshRenderSharedMaterialBaseScrollSpeedY=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.baseScrollSpeedY=Lc[0])}else Lb.meshRender.material.baseScrollSpeedY=Lc[0]},Ld._getMeshRenderSharedMaterialSecondScrollSpeedX=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Lb.meshRender.sharedMaterial.secondScrollSpeedX},Ld._setMeshRenderSharedMaterialSecondScrollSpeedX=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.secondScrollSpeedX=Lc[0])}else Lb.meshRender.material.secondScrollSpeedX=Lc[0]},Ld._getMeshRenderSharedMaterialSecondScrollSpeedY=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Lb.meshRender.sharedMaterial.secondScrollSpeedY},Ld._setMeshRenderSharedMaterialSecondScrollSpeedY=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.secondScrollSpeedY=Lc[0])}else Lb.meshRender.material.secondScrollSpeedY=Lc[0]},Ld._getMeshRenderSharedMaterialAlpha=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.alpha:0}return Lb.meshRender.sharedMaterial.alpha},Ld._setMeshRenderSharedMaterialAlpha=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.alpha=Lc[0])}else Lb.meshRender.material.alpha=Lc[0]},Ld._getMeshRenderSharedMaterialIntensity=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.intensity:0}return Lb.meshRender.sharedMaterial.intensity},Ld._setMeshRenderSharedMaterialIntensity=function(La,Lb,Lc){if(La){var Ld=La.transform._entity;Ld&&(Ld.owner.meshRender.material.intensity=Lc[0])}else Lb.meshRender.material.intensity=Lc[0]},Ld._getMeshRenderSharedMaterialDetailTilingOffset=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Lb.meshRender.sharedMaterial.detailTilingOffset.elements},Ld._setMeshRenderSharedMaterialDetailTilingOffset=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).detailTilingOffset).elements=Lc,Ld.detailTilingOffset=Le)}else(Le=(Ld=Lb.meshRender.material).detailTilingOffset).elements=Lc,Ld.detailTilingOffset=Le},Ld._getMeshRenderSharedMaterialDissolveTilingOffset=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Lb.meshRender.sharedMaterial.dissolveTilingOffset.elements},Ld._setMeshRenderSharedMaterialDissolveTilingOffset=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).dissolveTilingOffset).elements=Lc,Ld.dissolveTilingOffset=Le)}else(Le=(Ld=Lb.meshRender.material).dissolveTilingOffset).elements=Lc,Ld.dissolveTilingOffset=Le},Ld._getMeshRenderSharedMaterialMaskTilingOffset=function(La,Lb){if(La){var Lc=La.transform._entity;return Lc?Lc.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Lb.meshRender.sharedMaterial.maskTilingOffset.elements},Ld._setMeshRenderSharedMaterialMaskTilingOffset=function(La,Lb,Lc){var Ld,Le;if(La){var Lf=La.transform._entity;Lf&&((Le=(Ld=Lf.owner.meshRender.material).maskTilingOffset).elements=Lc,Ld.maskTilingOffset=Le)}else(Le=(Ld=Lb.meshRender.material).maskTilingOffset).elements=Lc,Ld.maskTilingOffset=Le},Ld._propertyIDCounter=0,Ld._propertyIndexDic={},Ld._propertySetFuncs=[],Ld._propertyGetFuncs=[],Ld}(),LR=function(){function La(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Ln(La,"laya.d3.animation.Keyframe"),La}(),LS=function(){function La(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Ln(La,"laya.d3.animation.KeyframeNode"),La}(),LI=(function(){function La(){this._tempVector30=new Lgb,this._tempVector31=new Lgb,this._tempVector32=new Lgb,this._a=new Lgb,this._b=new Lgb,this._c=new Lgb,this._d=new Lgb}Ln(La,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Lb=La.prototype;Lb.Init=function(La,Lb,Lc,Ld){La.cloneTo(this._d),Lb.cloneTo(this._c),Lgb.scale(La,2,this._a),Lgb.scale(Lc,2,this._tempVector30),Lgb.subtract(this._a,this._tempVector30,this._a),Lgb.add(this._a,Lb,this._a),Lgb.add(this._a,Ld,this._a),Lgb.scale(Lc,3,this._b),Lgb.scale(La,3,this._tempVector30),Lgb.subtract(this._b,this._tempVector30,this._b),Lgb.subtract(this._b,Ld,this._b),Lgb.scale(Lb,2,this._tempVector30),Lgb.subtract(this._b,this._tempVector30,this._b)},Lb.Slerp=function(La,Lb){Lgb.scale(this._a,La*La*La,this._tempVector30),Lgb.scale(this._b,La*La,this._tempVector31),Lgb.scale(this._c,La,this._tempVector32),Lgb.add(this._tempVector30,this._tempVector31,Lb),Lgb.add(Lb,this._tempVector32,Lb),Lgb.add(Lb,this._d,Lb)}}(),function(){function LM(La,Lb,Lc,Ld){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=La,this._h=Lb,this._minHeight=Lc,this._maxHeight=Ld}Ln(LM,"laya.d3.core.HeightMap");var La=LM.prototype;La._inBounds=function(La,Lb){return 0<=La&&La<this._h&&0<=Lb&&Lb<this._w},La.getHeight=function(La,Lb){return this._inBounds(La,Lb)?this._datas[La][Lb]:NaN},Lo(0,La,"width",function(){return this._w}),Lo(0,La,"height",function(){return this._h}),Lo(0,La,"maxHeight",function(){return this._maxHeight}),Lo(0,La,"minHeight",function(){return this._minHeight}),LM.creatFromMesh=function(La,Lb,Lc,Ld){for(var Le=[],Lf=[],Lg=La.getSubMeshCount(),Lh=0;Lh<Lg;Lh++){for(var Li=La.getSubMesh(Lh),Lj=Li._getVertexBuffer(),Lk=Lj.getData(),Ll=[],Lm=0;Lm<Lk.length;Lm+=Lj.vertexDeclaration.vertexStride/4){var Ln=new Lgb(Lk[Lm+0],Lk[Lm+1],Lk[Lm+2]);Ll.push(Ln)}Le.push(Ll);var Lo=Li._getIndexBuffer();Lf.push(Lo.getData())}var Lp=La.boundingBox,Lq=Lp.min.x,Lr=Lp.min.z,Ls=Lp.max.x,Lt=Lp.max.z,Lu=Lp.min.y,Lv=Lp.max.y,Ly=Ls-Lq,Lz=Lt-Lr,LA=Ld.elements[0]=Ly/(Lb-1),LB=Ld.elements[1]=Lz/(Lc-1),LC=new LM(Lb,Lc,Lu,Lv),LD=LM._tempRay,LE=LD.direction.elements;LE[0]=0,LE[1]=-1,LE[2]=0;var LF=Lv+.1;LD.origin.elements[1]=LF;for(var LG=0;LG<Lc;LG++){var LH=Lr+LG*LB;LC._datas[LG]=[];for(var LI=0;LI<Lb;LI++){var LJ=Lq+LI*LA,LK=LD.origin.elements;LK[0]=LJ,LK[2]=LH;var LL=LM._getPosition(LD,Le,Lf);LC._datas[LG][LI]=LL===Number.MAX_VALUE?NaN:LF-LL}}return LC},LM.createFromImage=function(La,Lb,Lc){for(var Ld=La.width,Le=La.height,Lf=new LM(Ld,Le,Lb,Lc),Lg=(Lc-Lb)/254,Lh=La.getPixels(),Li=0,Lj=0;Lj<Le;Lj++)for(var Lk=Lf._datas[Lj]=[],Ll=0;Ll<Ld;Ll++){var Lm=Lh[Li++],Ln=Lh[Li++],Lo=Lh[Li++],Lp=Lh[Li++];Lk[Ll]=255==Lm&&255==Ln&&255==Lo&&255==Lp?NaN:(Lm+Ln+Lo)/3*Lg+Lb}return Lf},LM._getPosition=function(La,Lb,Lc){for(var Ld=Number.MAX_VALUE,Le=0;Le<Lb.length;Le++)for(var Lf=Lb[Le],Lg=Lc[Le],Lh=0;Lh<Lg.length;Lh+=3){var Li=Lf[Lg[Lh+0]],Lj=Lf[Lg[Lh+1]],Lk=Lf[Lg[Lh+2]],Ll=Lob.rayIntersectsTriangle(La,Li,Lj,Lk);!isNaN(Ll)&&Ll<Ld&&(Ld=Ll)}return Ld},Ll(LM,["_tempRay",function(){return this._tempRay=new Leb(new Lgb,new Lgb)}])}(),function(){function Le(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Ln(Le,"laya.d3.core.Layer");var La=Le.prototype;return La._binarySearchIndex=function(){for(var La=0,Lb=Le._collsionTestList.length-1,Lc=0;La<=Lb;){Lc=Math.floor((La+Lb)/2);var Ld=Le._collsionTestList[Lc];if(Ld==this._number)return Lc;Ld>this._number?Lb=Lc-1:La=Lc+1}return La},La._addCollider=function(La){0===this._colliders.length&&Le._collsionTestList.splice(this._binarySearchIndex(),0,this._number),La._isRigidbody?(this._colliders.unshift(La),this._nonRigidbodyOffset++):this._colliders.push(La)},La._removeCollider=function(La){var Lb=this._colliders.indexOf(La);Lb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Lb,1),0===this._colliders.length&&Le._collsionTestList.splice(Le._collsionTestList.indexOf(this._number),1)},Lo(0,La,"number",function(){return this._number}),Lo(0,La,"visible",function(){return this._visible},function(La){this._visible=La,Le._visibleLayers=La?Le._visibleLayers|this.mask:Le._visibleLayers&~this.mask}),Lo(0,La,"mask",function(){return this._mask}),Lo(1,Le,"visibleLayers",function(){return Le._visibleLayers},function(La){Le._visibleLayers=La;for(var Lb=0,Lc=Le._layerList.length;Lb<Lc;Lb++){var Ld=Le._layerList[Lb];Ld._visible=0!=(Ld._mask&Le._visibleLayers)}}),Le.__init__=function(){Le._layerList.length=31;for(var La=0;La<31;La++){var Lb=new Le;Le._layerList[La]=Lb,0===La?(Lb.name="Default Layer",Lb.visible=!0):(Lb.name="Layer-"+La,Lb.visible=!1),Lb._number=La,Lb._mask=Math.pow(2,La)}Le.currentCreationLayer=Le._layerList[0]},Le.getLayerByNumber=function(La){if(La<0||30<La)throw new Error("无法返回指定Layer，该number超出范围！");return Le._layerList[La]},Le.getLayerByName=function(La){for(var Lb=0;Lb<31;Lb++)if(Le._layerList[Lb].name===La)return Le._layerList[Lb];throw new Error("无法返回指定Layer,该name不存在")},Le.isVisible=function(La){return 0!=(La&Le._currentCameraCullingMask&Le._visibleLayers)},Le._layerList=[],Le._visibleLayers=2147483647,Le._collsionTestList=[],Le._currentCameraCullingMask=2147483647,Le.maxCount=31,Le.currentCreationLayer=null,Le}()),LJ=(function(){function La(La,Lb,Lc){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=La,this._minCount=Lb,this._maxCount=Lc}Ln(La,"laya.d3.core.particleShuriKen.module.Burst");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.cloneTo=function(La){var Lb=La;Lb._time=this._time,Lb._minCount=this._minCount,Lb._maxCount=this._maxCount},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"time",function(){return this._time}),Lo(0,Lb,"minCount",function(){return this._minCount}),Lo(0,Lb,"maxCount",function(){return this._maxCount})}(),function(){function La(La){this._color=null,this.enbale=!1,this._color=La}Ln(La,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Lb=La.prototype;Lb.cloneTo=function(La){var Lb=La;this._color.cloneTo(Lb._color),Lb.enbale=this.enbale},Lb.clone=function(){var La;switch(this._color.type){case 0:La=LL.createByConstant(this._color.constant.clone());break;case 1:La=LL.createByGradient(this._color.gradient.clone());break;case 2:La=LL.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:La=LL.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Lb=new this.constructor(La);return Lb.enbale=this.enbale,Lb},Lo(0,Lb,"color",function(){return this._color})}(),function(){function La(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Ln(La,"laya.d3.core.particleShuriKen.module.Emission");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Lb._destroy=function(){this._bursts=null,this._destroyed=!0},Lb.getBurstsCount=function(){return this._bursts.length},Lb.getBurstByIndex=function(La){return this._bursts[La]},Lb.addBurst=function(La){var Lb=this._bursts.length;if(0<Lb)for(var Lc=0;Lc<Lb;Lc++)this._bursts[Lc].time>La.time&&this._bursts.splice(Lc,0,La);this._bursts.push(La)},Lb.removeBurst=function(La){var Lb=this._bursts.indexOf(La);-1!==Lb&&this._bursts.splice(Lb,1)},Lb.removeBurstByIndex=function(La){this._bursts.splice(La,1)},Lb.clearBurst=function(){this._bursts.length=0},Lb.cloneTo=function(La){var Lb=La,Lc=Lb._bursts;Lc.length=this._bursts.length;for(var Ld=0,Le=this._bursts.length;Ld<Le;Ld++){var Lf=Lc[Ld];Lf?this._bursts[Ld].cloneTo(Lf):Lc[Ld]=this._bursts[Ld].clone()}Lb._emissionRate=this._emissionRate,Lb.enbale=this.enbale},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"destroyed",function(){return this._destroyed}),Lo(0,Lb,"emissionRate",function(){return this._emissionRate},function(La){if(La<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=La})}(),function(){function Ld(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Ln(Ld,"laya.d3.core.particleShuriKen.module.FrameOverTime");var La=Ld.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.cloneTo=function(La){var Lb=La;Lb._type=this._type,Lb._constant=this._constant,this._overTime.cloneTo(Lb._overTime),Lb._constantMin=this._constantMin,Lb._constantMax=this._constantMax,this._overTimeMin.cloneTo(Lb._overTimeMin),this._overTimeMax.cloneTo(Lb._overTimeMax)},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"frameOverTimeData",function(){return this._overTime}),Lo(0,La,"constant",function(){return this._constant}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"frameOverTimeDataMin",function(){return this._overTimeMin}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"frameOverTimeDataMax",function(){return this._overTimeMax}),Lo(0,La,"constantMax",function(){return this._constantMax}),Ld.createByConstant=function(La){var Lb=new Ld;return Lb._type=0,Lb._constant=La,Lb},Ld.createByOverTime=function(La){var Lb=new Ld;return Lb._type=1,Lb._overTime=La,Lb},Ld.createByRandomTwoConstant=function(La,Lb){var Lc=new Ld;return Lc._type=2,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Ld.createByRandomTwoOverTime=function(La,Lb){var Lc=new Ld;return Lc._type=3,Lc._overTimeMin=La,Lc._overTimeMax=Lb,Lc},Ld}()),LK=function(){function Lj(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Ln(Lj,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var La=Lj.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.cloneTo=function(La){var Lb=La;Lb._type=this._type,Lb._separateAxes=this._separateAxes,Lb._constant=this._constant,this._constantSeparate.cloneTo(Lb._constantSeparate),this._gradient.cloneTo(Lb._gradient),this._gradientX.cloneTo(Lb._gradientX),this._gradientY.cloneTo(Lb._gradientY),this._gradientZ.cloneTo(Lb._gradientZ),Lb._constantMin=this._constantMin,Lb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Lb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Lb._constantMaxSeparate),this._gradientMin.cloneTo(Lb._gradientMin),this._gradientMax.cloneTo(Lb._gradientMax),this._gradientXMin.cloneTo(Lb._gradientXMin),this._gradientXMax.cloneTo(Lb._gradientXMax),this._gradientYMin.cloneTo(Lb._gradientYMin),this._gradientYMax.cloneTo(Lb._gradientYMax),this._gradientZMin.cloneTo(Lb._gradientZMin),this._gradientZMax.cloneTo(Lb._gradientZMax)},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"gradientZ",function(){return this._gradientZ}),Lo(0,La,"constant",function(){return this._constant}),Lo(0,La,"gradient",function(){return this._gradient}),Lo(0,La,"separateAxes",function(){return this._separateAxes}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"constantSeparate",function(){return this._constantSeparate}),Lo(0,La,"gradientX",function(){return this._gradientX}),Lo(0,La,"gradientY",function(){return this._gradientY}),Lo(0,La,"gradientW",function(){return this._gradientW}),Lo(0,La,"gradientMin",function(){return this._gradientMin}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"gradientMax",function(){return this._gradientMax}),Lo(0,La,"constantMax",function(){return this._constantMax}),Lo(0,La,"gradientWMin",function(){return this._gradientWMin}),Lo(0,La,"constantMinSeparate",function(){return this._constantMinSeparate}),Lo(0,La,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Lo(0,La,"gradientXMin",function(){return this._gradientXMin}),Lo(0,La,"gradientXMax",function(){return this._gradientXMax}),Lo(0,La,"gradientWMax",function(){return this._gradientWMax}),Lo(0,La,"gradientYMin",function(){return this._gradientYMin}),Lo(0,La,"gradientYMax",function(){return this._gradientYMax}),Lo(0,La,"gradientZMin",function(){return this._gradientZMin}),Lo(0,La,"gradientZMax",function(){return this._gradientZMax}),Lj.createByConstant=function(La){var Lb=new Lj;return Lb._type=0,Lb._separateAxes=!1,Lb._constant=La,Lb},Lj.createByConstantSeparate=function(La){var Lb=new Lj;return Lb._type=0,Lb._separateAxes=!0,Lb._constantSeparate=La,Lb},Lj.createByGradient=function(La){var Lb=new Lj;return Lb._type=1,Lb._separateAxes=!1,Lb._gradient=La,Lb},Lj.createByGradientSeparate=function(La,Lb,Lc,Ld){var Le=new Lj;return Le._type=1,Le._separateAxes=!0,Le._gradientX=La,Le._gradientY=Lb,Le._gradientZ=Lc,Le._gradientW=Ld,Le},Lj.createByRandomTwoConstant=function(La,Lb){var Lc=new Lj;return Lc._type=2,Lc._separateAxes=!1,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Lj.createByRandomTwoConstantSeparate=function(La,Lb){var Lc=new Lj;return Lc._type=2,Lc._separateAxes=!0,Lc._constantMinSeparate=La,Lc._constantMaxSeparate=Lb,Lc},Lj.createByRandomTwoGradient=function(La,Lb){var Lc=new Lj;return Lc._type=3,Lc._separateAxes=!1,Lc._gradientMin=La,Lc._gradientMax=Lb,Lc},Lj.createByRandomTwoGradientSeparate=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li=new Lj;return Li._type=3,Li._separateAxes=!0,Li._gradientXMin=La,Li._gradientXMax=Lb,Li._gradientYMin=Lc,Li._gradientYMax=Ld,Li._gradientZMin=Le,Li._gradientZMax=Lf,Li._gradientWMin=Lg,Li._gradientWMax=Lh,Li},Lj}(),LL=function(){function Ld(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Ln(Ld,"laya.d3.core.particleShuriKen.module.GradientColor");var La=Ld.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.cloneTo=function(La){var Lb=La;Lb._type=this._type,this._constant.cloneTo(Lb._constant),this._constantMin.cloneTo(Lb._constantMin),this._constantMax.cloneTo(Lb._constantMax),this._gradient.cloneTo(Lb._gradient),this._gradientMin.cloneTo(Lb._gradientMin),this._gradientMax.cloneTo(Lb._gradientMax)},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"gradient",function(){return this._gradient}),Lo(0,La,"constant",function(){return this._constant}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"gradientMin",function(){return this._gradientMin}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"gradientMax",function(){return this._gradientMax}),Lo(0,La,"constantMax",function(){return this._constantMax}),Ld.createByConstant=function(La){var Lb=new Ld;return Lb._type=0,Lb._constant=La,Lb},Ld.createByGradient=function(La){var Lb=new Ld;return Lb._type=1,Lb._gradient=La,Lb},Ld.createByRandomTwoConstant=function(La,Lb){var Lc=new Ld;return Lc._type=2,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Ld.createByRandomTwoGradient=function(La,Lb){var Lc=new Ld;return Lc._type=3,Lc._gradientMin=La,Lc._gradientMax=Lb,Lc},Ld}(),LM=(function(){function La(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Ln(La,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.addAlpha=function(La,Lb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==La&&(La=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=La,this._alphaElements[this._alphaCurrentLength++]=Lb):DEBUG},Lb.addRGB=function(La,Lb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==La&&(La=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=La,this._rgbElements[this._rgbCurrentLength++]=Lb.x,this._rgbElements[this._rgbCurrentLength++]=Lb.y,this._rgbElements[this._rgbCurrentLength++]=Lb.z):DEBUG},Lb.cloneTo=function(La){var Lb=La,Lc=0,Ld=0;Lb._alphaCurrentLength=this._alphaCurrentLength;var Le=Lb._alphaElements;for(Le.length=this._alphaElements.length,Lc=0,Ld=this._alphaElements.length;Lc<Ld;Lc++)Le[Lc]=this._alphaElements[Lc];Lb._rgbCurrentLength=this._rgbCurrentLength;var Lf=Lb._rgbElements;for(Lf.length=this._rgbElements.length,Lc=0,Ld=this._rgbElements.length;Lc<Ld;Lc++)Lf[Lc]=this._rgbElements[Lc]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),Lo(0,Lb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function La(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Ln(La,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.add=function(La,Lb){this._currentLength<8?(6===this._currentLength&&1!==La&&(La=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=La,this._elements[this._currentLength++]=Lb):console.log("Warning:data count must lessEqual than 4")},Lb.cloneTo=function(La){var Lb=La;Lb._currentLength=this._currentLength;var Lc=Lb._elements;Lc.length=this._elements.length;for(var Ld=0,Le=this._elements.length;Ld<Le;Ld++)Lc[Ld]=this._elements[Ld]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"gradientCount",function(){return this._currentLength/2})}(),function(){function La(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Ln(La,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.add=function(La,Lb){this._currentLength<8?(6===this._currentLength&&1!==La&&(La=1,DEBUG),this._elements[this._currentLength++]=La,this._elements[this._currentLength++]=Lb):DEBUG},Lb.getKeyByIndex=function(La){return this._elements[2*La]},Lb.getValueByIndex=function(La){return this._elements[2*La+1]},Lb.getAverageValue=function(){for(var La=0,Lb=this._currentLength-2;La<Lb;La+=2){this._elements[La+1];this._elements[La+3],this._elements[La+2]-this._elements[La]}return 0},Lb.cloneTo=function(La){var Lb=La;Lb._currentLength=this._currentLength;var Lc=Lb._elements;Lc.length=this._elements.length;for(var Ld=0,Le=this._elements.length;Ld<Le;Ld++)Lc[Ld]=this._elements[Ld]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"gradientCount",function(){return this._currentLength/2})}(),function(){function La(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Ln(La,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.add=function(La,Lb){this._currentLength<8?(6===this._currentLength&&1!==La&&(La=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=La,this._elements[this._currentLength++]=Lb.x,this._elements[this._currentLength++]=Lb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Lb.cloneTo=function(La){var Lb=La;Lb._currentLength=this._currentLength;var Lc=Lb._elements;Lc.length=this._elements.length;for(var Ld=0,Le=this._elements.length;Ld<Le;Ld++)Lc[Ld]=this._elements[Ld]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"gradientCount",function(){return this._currentLength/3})}(),function(){function Lh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Ln(Lh,"laya.d3.core.particleShuriKen.module.GradientSize");var La=Lh.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.getMaxSizeInGradient=function(){var La=0,Lb=0,Lc=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(La=0,Lb=this._gradientX.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientX.getValueByIndex(La));for(La=0,Lb=this._gradientY.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientY.getValueByIndex(La))}else for(La=0,Lb=this._gradient.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradient.getValueByIndex(La));break;case 1:Lc=this._separateAxes?(Lc=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),Lc=Math.max(Lc,this._constantMinSeparate.y),Math.max(Lc,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(La=0,Lb=this._gradientXMin.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientXMin.getValueByIndex(La));for(La=0,Lb=this._gradientXMax.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientXMax.getValueByIndex(La));for(La=0,Lb=this._gradientYMin.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientYMin.getValueByIndex(La));for(La=0,Lb=this._gradientZMax.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientZMax.getValueByIndex(La))}else{for(La=0,Lb=this._gradientMin.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientMin.getValueByIndex(La));for(La=0,Lb=this._gradientMax.gradientCount;La<Lb;La++)Lc=Math.max(Lc,this._gradientMax.getValueByIndex(La))}}return Lc},La.cloneTo=function(La){var Lb=La;Lb._type=this._type,Lb._separateAxes=this._separateAxes,this._gradient.cloneTo(Lb._gradient),this._gradientX.cloneTo(Lb._gradientX),this._gradientY.cloneTo(Lb._gradientY),this._gradientZ.cloneTo(Lb._gradientZ),Lb._constantMin=this._constantMin,Lb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Lb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Lb._constantMaxSeparate),this._gradientMin.cloneTo(Lb._gradientMin),this._gradientMax.cloneTo(Lb._gradientMax),this._gradientXMin.cloneTo(Lb._gradientXMin),this._gradientXMax.cloneTo(Lb._gradientXMax),this._gradientYMin.cloneTo(Lb._gradientYMin),this._gradientYMax.cloneTo(Lb._gradientYMax),this._gradientZMin.cloneTo(Lb._gradientZMin),this._gradientZMax.cloneTo(Lb._gradientZMax)},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"gradientZ",function(){return this._gradientZ}),Lo(0,La,"gradient",function(){return this._gradient}),Lo(0,La,"separateAxes",function(){return this._separateAxes}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"gradientMin",function(){return this._gradientMin}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"gradientX",function(){return this._gradientX}),Lo(0,La,"gradientY",function(){return this._gradientY}),Lo(0,La,"gradientMax",function(){return this._gradientMax}),Lo(0,La,"constantMax",function(){return this._constantMax}),Lo(0,La,"constantMinSeparate",function(){return this._constantMinSeparate}),Lo(0,La,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Lo(0,La,"gradientXMin",function(){return this._gradientXMin}),Lo(0,La,"gradientXMax",function(){return this._gradientXMax}),Lo(0,La,"gradientYMin",function(){return this._gradientYMin}),Lo(0,La,"gradientYMax",function(){return this._gradientYMax}),Lo(0,La,"gradientZMin",function(){return this._gradientZMin}),Lo(0,La,"gradientZMax",function(){return this._gradientZMax}),Lh.createByGradient=function(La){var Lb=new Lh;return Lb._type=0,Lb._separateAxes=!1,Lb._gradient=La,Lb},Lh.createByGradientSeparate=function(La,Lb,Lc){var Ld=new Lh;return Ld._type=0,Ld._separateAxes=!0,Ld._gradientX=La,Ld._gradientY=Lb,Ld._gradientZ=Lc,Ld},Lh.createByRandomTwoConstant=function(La,Lb){var Lc=new Lh;return Lc._type=1,Lc._separateAxes=!1,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Lh.createByRandomTwoConstantSeparate=function(La,Lb){var Lc=new Lh;return Lc._type=1,Lc._separateAxes=!0,Lc._constantMinSeparate=La,Lc._constantMaxSeparate=Lb,Lc},Lh.createByRandomTwoGradient=function(La,Lb){var Lc=new Lh;return Lc._type=2,Lc._separateAxes=!1,Lc._gradientMin=La,Lc._gradientMax=Lb,Lc},Lh.createByRandomTwoGradientSeparate=function(La,Lb,Lc,Ld,Le,Lf){var Lg=new Lh;return Lg._type=2,Lg._separateAxes=!0,Lg._gradientXMin=La,Lg._gradientXMax=Lb,Lg._gradientYMin=Lc,Lg._gradientYMax=Ld,Lg._gradientZMin=Le,Lg._gradientZMax=Lf,Lg},Lh}()),LN=function(){function Lh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Ln(Lh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var La=Lh.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.cloneTo=function(La){var Lb=La;Lb._type=this._type,this._constant.cloneTo(Lb._constant),this._gradientX.cloneTo(Lb._gradientX),this._gradientY.cloneTo(Lb._gradientY),this._gradientZ.cloneTo(Lb._gradientZ),this._constantMin.cloneTo(Lb._constantMin),this._constantMax.cloneTo(Lb._constantMax),this._gradientXMin.cloneTo(Lb._gradientXMin),this._gradientXMax.cloneTo(Lb._gradientXMax),this._gradientYMin.cloneTo(Lb._gradientYMin),this._gradientYMax.cloneTo(Lb._gradientYMax),this._gradientZMin.cloneTo(Lb._gradientZMin),this._gradientZMax.cloneTo(Lb._gradientZMax)},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"gradientZ",function(){return this._gradientZ}),Lo(0,La,"constant",function(){return this._constant}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"gradientXMax",function(){return this._gradientXMax}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"gradientX",function(){return this._gradientX}),Lo(0,La,"gradientY",function(){return this._gradientY}),Lo(0,La,"gradientXMin",function(){return this._gradientXMin}),Lo(0,La,"constantMax",function(){return this._constantMax}),Lo(0,La,"gradientYMin",function(){return this._gradientYMin}),Lo(0,La,"gradientYMax",function(){return this._gradientYMax}),Lo(0,La,"gradientZMin",function(){return this._gradientZMin}),Lo(0,La,"gradientZMax",function(){return this._gradientZMax}),Lh.createByConstant=function(La){var Lb=new Lh;return Lb._type=0,Lb._constant=La,Lb},Lh.createByGradient=function(La,Lb,Lc){var Ld=new Lh;return Ld._type=1,Ld._gradientX=La,Ld._gradientY=Lb,Ld._gradientZ=Lc,Ld},Lh.createByRandomTwoConstant=function(La,Lb){var Lc=new Lh;return Lc._type=2,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Lh.createByRandomTwoGradient=function(La,Lb,Lc,Ld,Le,Lf){var Lg=new Lh;return Lg._type=3,Lg._gradientXMin=La,Lg._gradientXMax=Lb,Lg._gradientYMin=Lc,Lg._gradientYMax=Ld,Lg._gradientZMin=Le,Lg._gradientZMax=Lf,Lg},Lh}(),LO=(function(){function La(La){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=La}Ln(La,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.cloneTo=function(La){var Lb=La;this._angularVelocity.cloneTo(Lb._angularVelocity),Lb.enbale=this.enbale},Lb.clone=function(){var La;switch(this._angularVelocity.type){case 0:La=this._angularVelocity.separateAxes?LK.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):LK.createByConstant(this._angularVelocity.constant);break;case 1:La=this._angularVelocity.separateAxes?LK.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):LK.createByGradient(this._angularVelocity.gradient.clone());break;case 2:La=this._angularVelocity.separateAxes?LK.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):LK.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:La=this._angularVelocity.separateAxes?LK.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):LK.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Lb=new this.constructor(La);return Lb.enbale=this.enbale,Lb},Lo(0,Lb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function La(){this.enable=!1,this.randomDirection=!1}Ln(La,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb._getShapeBoundBox=function(La){throw new Error("BaseShape: must override it.")},Lb._getSpeedBoundBox=function(La){throw new Error("BaseShape: must override it.")},Lb.generatePositionAndDirection=function(La,Lb,Lc,Ld){throw new Error("BaseShape: must override it.")},Lb._calculateProceduralBounds=function(La,Lb,Lc){this._getShapeBoundBox(La);var Ld=La.min,Le=La.max;Lgb.multiply(Ld,Lb,Ld),Lgb.multiply(Le,Lb,Le);var Lf=new LZa(new Lgb,new Lgb);this.randomDirection?(Lf.min=new Lgb(-1,-1,-1),Lf.max=new Lgb(1,1,1)):this._getSpeedBoundBox(Lf);var Lg=new LZa(new Lgb,new Lgb),Lh=Lg.min,Li=Lg.max;Lgb.scale(Lf.min,Lc.y,Lh),Lgb.scale(Lf.max,Lc.y,Li),Lgb.add(La.min,Lh,Lh),Lgb.add(La.max,Li,Li),Lgb.min(La.min,Lh,La.min),Lgb.max(La.max,Lh,La.max);var Lj=new LZa(new Lgb,new Lgb),Lk=Lj.min,Ll=Lj.max;Lgb.scale(Lf.min,Lc.x,Lk),Lgb.scale(Lf.max,Lc.x,Ll),Lgb.min(Lj.min,Ll,Lh),Lgb.max(Lj.min,Ll,Li),Lgb.min(La.min,Lh,La.min),Lgb.max(La.max,Lh,La.max)},Lb.cloneTo=function(La){La.enable=this.enable},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},La}()),LT=function(){function Lf(){}return Ln(Lf,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Lf._randomPointUnitArcCircle=function(La,Lb,Lc){var Ld=Lb.elements,Le=NaN;Le=Lc?Lc.getFloat()*La:Math.random()*La,Ld[0]=Math.cos(Le),Ld[1]=Math.sin(Le)},Lf._randomPointInsideUnitArcCircle=function(La,Lb,Lc){var Ld=Lb.elements;Lf._randomPointUnitArcCircle(La,Lb,Lc);var Le=NaN;Le=Lc?Math.pow(Lc.getFloat(),.5):Math.pow(Math.random(),.5),Ld[0]=Ld[0]*Le,Ld[1]=Ld[1]*Le},Lf._randomPointUnitCircle=function(La,Lb){var Lc=La.elements,Ld=NaN;Ld=Lb?Lb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,Lc[0]=Math.cos(Ld),Lc[1]=Math.sin(Ld)},Lf._randomPointInsideUnitCircle=function(La,Lb){var Lc=La.elements;Lf._randomPointUnitCircle(La);var Ld=NaN;Ld=Lb?Math.pow(Lb.getFloat(),.5):Math.pow(Math.random(),.5),Lc[0]=Lc[0]*Ld,Lc[1]=Lc[1]*Ld},Lf._randomPointUnitSphere=function(La,Lb){var Lc=La.elements,Ld=NaN,Le=NaN;Le=Lb?(Ld=Lc[2]=2*Lb.getFloat()-1,Lb.getFloat()*Math.PI*2):(Ld=Lc[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Lf=Math.sqrt(1-Ld*Ld);Lc[0]=Lf*Math.cos(Le),Lc[1]=Lf*Math.sin(Le)},Lf._randomPointInsideUnitSphere=function(La,Lb){var Lc=La.elements;Lf._randomPointUnitSphere(La);var Ld=NaN;Ld=Lb?Math.pow(Lb.getFloat(),1/3):Math.pow(Math.random(),1/3),Lc[0]=Lc[0]*Ld,Lc[1]=Lc[1]*Ld,Lc[2]=Lc[2]*Ld},Lf._randomPointInsideHalfUnitBox=function(La,Lb){var Lc=La.elements;Lb?(Lc[0]=Lb.getFloat()-.5,Lc[1]=Lb.getFloat()-.5,Lc[2]=Lb.getFloat()-.5):(Lc[0]=Math.random()-.5,Lc[1]=Math.random()-.5,Lc[2]=Math.random()-.5)},Lf}(),LU=(function(){function La(La){this._size=null,this.enbale=!1,this._size=La}Ln(La,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.cloneTo=function(La){var Lb=La;this._size.cloneTo(Lb._size),Lb.enbale=this.enbale},Lb.clone=function(){var La;switch(this._size.type){case 0:La=this._size.separateAxes?LM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):LM.createByGradient(this._size.gradient.clone());break;case 1:La=this._size.separateAxes?LM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):LM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:La=this._size.separateAxes?LM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):LM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Lb=new this.constructor(La);return Lb.enbale=this.enbale,Lb},Lo(0,Lb,"size",function(){return this._size})}(),function(){function Ld(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Ln(Ld,"laya.d3.core.particleShuriKen.module.StartFrame");var La=Ld.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.cloneTo=function(La){var Lb=La;Lb._type=this._type,Lb._constant=this._constant,Lb._constantMin=this._constantMin,Lb._constantMax=this._constantMax},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,La,"constant",function(){return this._constant}),Lo(0,La,"type",function(){return this._type}),Lo(0,La,"constantMin",function(){return this._constantMin}),Lo(0,La,"constantMax",function(){return this._constantMax}),Ld.createByConstant=function(La){var Lb=new Ld;return Lb._type=0,Lb._constant=La,Lb},Ld.createByRandomTwoConstant=function(La,Lb){var Lc=new Ld;return Lc._type=1,Lc._constantMin=La,Lc._constantMax=Lb,Lc},Ld}()),LV=(function(){function La(La,Lb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Lfb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=La,this._startFrame=Lb}Ln(La,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.cloneTo=function(La){var Lb=La;this.tiles.cloneTo(Lb.tiles),Lb.type=this.type,Lb.randomRow=this.randomRow,this._frame.cloneTo(Lb._frame),this._startFrame.cloneTo(Lb._startFrame),Lb.cycles=this.cycles,Lb.enableUVChannels=this.enableUVChannels,Lb.enable=this.enable},Lb.clone=function(){var La,Lb;switch(this._frame.type){case 0:La=LJ.createByConstant(this._frame.constant);break;case 1:La=LJ.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:La=LJ.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:La=LJ.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Lb=LU.createByConstant(this._startFrame.constant);break;case 1:Lb=LU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var Lc=new this.constructor(La,Lb);return this.tiles.cloneTo(Lc.tiles),Lc.type=this.type,Lc.randomRow=this.randomRow,Lc.cycles=this.cycles,Lc.enableUVChannels=this.enableUVChannels,Lc.enable=this.enable,Lc},Lo(0,Lb,"frame",function(){return this._frame}),Lo(0,Lb,"startFrame",function(){return this._startFrame})}(),function(){function La(La){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=La}Ln(La,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.cloneTo=function(La){var Lb=La;this._velocity.cloneTo(Lb._velocity),Lb.enbale=this.enbale,Lb.space=this.space},Lb.clone=function(){var La;switch(this._velocity.type){case 0:La=LN.createByConstant(this._velocity.constant.clone());break;case 1:La=LN.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:La=LN.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:La=LN.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Lb=new this.constructor(La);return Lb.enbale=this.enbale,Lb.space=this.space,Lb},Lo(0,Lb,"velocity",function(){return this._velocity})}(),function(){function La(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Lmb,this._vb=LOb.create(La._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=LNb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=LLb.nameKey.getID("LINE"),this._shaderCompile=LAb._preCompileShader[this._sharderNameID]}Ln(La,"laya.d3.core.PhasorSpriter3D");var Lb=La.prototype;return Lb.line=function(La,Lb,Lc,Ld){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(La.x,La.y,La.z,Lb.x,Lb.y,Lb.z,Lb.w),this.addVertex(Lc.x,Lc.y,Lc.z,Ld.x,Ld.y,Ld.z,Ld.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Lb.circle=function(La,Lb,Lc,Ld,Le,Lf){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Lb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Lb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*La,Math.cos(this._tempNumver0)*La,0,Lc,Ld,Le,Lf),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Lb.plane=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Ld/2,this._tempNumver1=Le/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(La-this._tempNumver0,Lb+this._tempNumver1,Lc,Lf,Lg,Lh,Li),this.addVertex(La+this._tempNumver0,Lb+this._tempNumver1,Lc,Lf,Lg,Lh,Li),this.addVertex(La-this._tempNumver0,Lb-this._tempNumver1,Lc,Lf,Lg,Lh,Li),this.addVertex(La+this._tempNumver0,Lb-this._tempNumver1,Lc,Lf,Lg,Lh,Li),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Lb.box=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Ld/2,this._tempNumver1=Le/2,this._tempNumver2=Lf/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(La-this._tempNumver0,Lb+this._tempNumver1,Lc+this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La+this._tempNumver0,Lb+this._tempNumver1,Lc+this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La-this._tempNumver0,Lb-this._tempNumver1,Lc+this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La+this._tempNumver0,Lb-this._tempNumver1,Lc+this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La+this._tempNumver0,Lb+this._tempNumver1,Lc-this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La-this._tempNumver0,Lb+this._tempNumver1,Lc-this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La+this._tempNumver0,Lb-this._tempNumver1,Lc-this._tempNumver2,Lg,Lh,Li,Lj),this.addVertex(La-this._tempNumver0,Lb-this._tempNumver1,Lc-this._tempNumver2,Lg,Lh,Li,Lj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Lb.cone=function(La,Lb,Lc,Ld,Le,Lf,Lg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*Lc+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*Lc>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/Lc,this.addVertexIndex(0,Lb,0,Ld,Le,Lf,Lg,this._tempUint0),this.addVertexIndex(0,0,0,Ld,Le,Lf,Lg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<Lc;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(La*this._tempNumver2,0,La*this._tempNumver3,Ld,Le,Lf,Lg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==Lc-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(La*this._tempNumver2,0,La*this._tempNumver3,Ld,Le,Lf,Lg,this._tempUint0+(this._tempInt0+Lc)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==Lc-1?this.addIndexes(this._tempUint1+Lc+2):this.addIndexes(this._tempUint1+this._tempInt0+Lc+1),this.addIndexes(this._tempUint1+this._tempInt0+Lc),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Lb.boundingBoxLine=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(La,Le,Lf,Lg,Lh,Li,Lj),this.addVertex(Ld,Le,Lf,Lg,Lh,Li,Lj),this.addVertex(La,Lb,Lf,Lg,Lh,Li,Lj),this.addVertex(Ld,Lb,Lf,Lg,Lh,Li,Lj),this.addVertex(Ld,Le,Lc,Lg,Lh,Li,Lj),this.addVertex(La,Le,Lc,Lg,Lh,Li,Lj),this.addVertex(Ld,Lb,Lc,Lg,Lh,Li,Lj),this.addVertex(La,Lb,Lc,Lg,Lh,Li,Lj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Lb.addVertex=function(La,Lb,Lc,Ld,Le,Lf,Lg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=La,this._vbData[this._posInVBData+1]=Lb,this._vbData[this._posInVBData+2]=Lc,this._vbData[this._posInVBData+3]=Ld,this._vbData[this._posInVBData+4]=Le,this._vbData[this._posInVBData+5]=Lf,this._vbData[this._posInVBData+6]=Lg,this._posInVBData+=this._floatSizePerVer,this},Lb.addVertexIndex=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){return this._hasBegun||this.addVertexIndexException(),this._vbData[Lh]=La,this._vbData[Lh+1]=Lb,this._vbData[Lh+2]=Lc,this._vbData[Lh+3]=Ld,this._vbData[Lh+4]=Le,this._vbData[Lh+5]=Lf,this._vbData[Lh+6]=Lg,(Lh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=Lh),this},Lb.addIndexes=function(La){var Lb=arguments;this._hasBegun||this.addVertexIndexException();for(var Lc=0;Lc<Lb.length;Lc++)this._ibData[this._posInIBData]=Lb[Lc],this._posInIBData++;return this},Lb.begin=function(La,Lb){return this._hasBegun&&this.beginException0(),1!==La&&4!==La&&this.beginException1(),this._primitiveType=La,this._camera=Lb,this._hasBegun=!0,this},Lb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Lb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(La._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),LA.drawCall++,LF.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Lb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Lb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Lb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Lb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Lb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Lb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(28,[new Lga(0,"vector3",0),new Lga(12,"vector4",1)])}]),La}()),LW=function(){function La(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++La._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Lmb}Ln(La,"laya.d3.core.render.RenderElement");var Lb=La.prototype;return Lb.getDynamicBatchBakedVertexs=function(La){for(var Lb=this._renderObj._getVertexBuffer(La),Lc=Lb.getData().slice(),Ld=Lb.vertexDeclaration,Le=Ld.getVertexElementByUsage(0).offset/4,Lf=Ld.getVertexElementByUsage(3).offset/4,Lg=this._sprite3D.transform,Lh=Lg.worldMatrix,Li=Lg.rotation,Lj=Ld.vertexStride/4,Lk=0,Ll=Lc.length;Lk<Ll;Lk+=Lj){var Lm=Lk+Le,Ln=Lk+Lf;Lqb.transformVector3ArrayToVector3ArrayCoordinate(Lc,Lm,Lh,Lc,Lm),Lqb.transformVector3ArrayByQuat(Lc,Ln,Li,Lc,Ln)}return Lc},Lb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Lb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},Lo(0,Lb,"id",function(){return this._id}),Lo(0,Lb,"renderObj",function(){return this._renderObj},function(La){this._renderObj!==La&&(this._renderObj=La)}),La._uniqueIDCounter=0,La}(),LX=function(){function Lb(La){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Lb._uniqueIDCounter,this._needSort=!1,this._scene=La,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Ln(Lb,"laya.d3.core.render.RenderQueue");var La=Lb.prototype;return La._sortOpaqueFunc=function(La,Lb){if(La._render&&Lb._render){var Lc=La._material.renderQueue-Lb._material.renderQueue;return 0==Lc?La._material.constructor&&Lb._material.constructor&&La._material.constructor.name&&Lb._material.constructor.name&&La._material.constructor.name==La._material.constructor.name&&La._sprite3D&&Lb._sprite3D&&La._sprite3D.name&&Lb._sprite3D.name&&La._sprite3D.name===Lb._sprite3D.name?0:La._render._distanceForSort-Lb._render._distanceForSort:Lc}return 0},La._sortAlphaFunc=function(La,Lb){if(La._render&&Lb._render){var Lc=La._material.renderQueue-Lb._material.renderQueue;return 0==Lc?La._material.constructor&&Lb._material.constructor&&La._material.constructor.name&&Lb._material.constructor.name&&La._material.constructor.name==La._material.constructor.name&&La._sprite3D&&Lb._sprite3D&&La._sprite3D.name&&Lb._sprite3D.name&&La._sprite3D.name===Lb._sprite3D.name?0:Lb._render._distanceForSort-La._render._distanceForSort:Lc}return 0},La._begainRenderElement=function(La,Lb,Lc){return!!Lb._beforeRender(La)},La._sortAlpha=function(La){Lb._cameraPosition=La,this._finalElements.sort(this._sortAlphaFunc)},La._sortOpaque=function(La){Lb._cameraPosition=La,this._finalElements.sort(this._sortOpaqueFunc)},La._preRender=function(La){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},La._render=function(La,Lb){for(var Lc,Ld,Le,Lf,Lg,Lh,Li=LA.loopCount,Lj=this._scene,Lk=La.camera,Ll=(Lk.id,!1),Lm=0,Ln=this._finalElements.length;Lm<Ln;Lm++){var Lo,Lp,Lq,Lr=this._finalElements[Lm];if(null!=Lr._onPreRenderFunction&&Lr._onPreRenderFunction.call(Lr._sprite3D,La),0===Lr._type){if(La.owner=Lq=Lr._sprite3D,La.renderElement=Lr,Lq._preRenderUpdateComponents(La),Lo=Lr.renderObj,Lp=Lr._material,this._begainRenderElement(La,Lo,Lp)){if(Lc=Lo._getVertexBuffers(),!(Le=(Ld=Lo._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Ld.id]){this._errorRecord[Ld.id]=1;var Ls="vertexBuffer:"+("("+Ld._destroyed+","+Ld._released+","+Ld._referenceCount+","+Ld._buffer+")")+", material:"+(Lp?Lp.__className+"("+Lp._destroyed+","+Lp._released+")":"null")+", owner:"+(Lq?Lq.__className+"("+Lq._destroyed+","+Lq._activeInHierarchy+","+Lq._displayedInStage+")":"null")+", renderObj:"+(Lo?Lo.__className+"("+Lo._destroyed+","+Lo._released+","+Lo._referenceCount+")":"")+", parent:, url:"+(Lq?Lq.url:"")+", disposeStack:"+Ld.disposeStack;Lv.recordError("报错：unknown vertexDeclaration  "+Ls)}continue}if(Ll=(Lf=La._shader=Lp._getShader(Lj._shaderDefineValue,Le.shaderDefineValue,Lq._shaderDefineValue)).bind()||Li!==Lf._uploadLoopCount,Lc){if(Lf._uploadVertexBuffer!==Lc||Ll){for(var Lt=0;Lt<Lc.length;Lt++){var Lu=Lc[Lt];Lf.uploadAttributesX(Lu.vertexDeclaration.shaderValues.data,Lu)}Lf._uploadVertexBuffer=Lc}}else(Lf._uploadVertexBuffer!==Ld||Ll)&&(Lf.uploadAttributes(Le.shaderValues.data,null),Lf._uploadVertexBuffer=Ld);(Lf._uploadScene!==Lj||Ll)&&(Lf.uploadSceneUniforms(Lj._shaderValues.data),Lf._uploadScene=Lj),(Lk!==Lf._uploadCamera||Lf._uploadSprite3D!==Lq||Ll)&&(Lf.uploadSpriteUniforms(Lq._shaderValues.data),Lf._uploadSprite3D=Lq),(Lk!==Lf._uploadCamera||Ll)&&(Lf.uploadCameraUniforms(Lk._shaderValues.data),Lf._uploadCamera=Lk),(Lf._uploadMaterial!==Lp||Ll)&&(Lp._upload(),Lf._uploadMaterial=Lp),Lg!==Lp?(Lp._setRenderStateBlendDepth(),Lp._setRenderStateFrontFace(Lb,Lq.transform),Lg=Lp,Lh=Lq):Lh!==Lq&&(Lp._setRenderStateFrontFace(Lb,Lq.transform),Lh=Lq),Lo._render(La),Lf._uploadLoopCount=Li}Lq._postRenderUpdateComponents(La)}else if(2===Lr._type){Lr.renderObj;La.owner=Lq=Lr._sprite3D,La.renderElement=Lr,La._batchIndexStart=Lr._tempBatchIndexStart,La._batchIndexEnd=Lr._tempBatchIndexEnd,Lo=Lr.renderObj,Lp=Lr._material,this._begainRenderElement(La,Lo,Lp)&&(Le=(Ld=Lo._getVertexBuffer(0)).vertexDeclaration,Ll=(Lf=La._shader=Lp._getShader(Lj._shaderDefineValue,Le.shaderDefineValue,Lq._shaderDefineValue)).bind()||Li!==Lf._uploadLoopCount,(Lf._uploadVertexBuffer!==Ld||Ll)&&(Lf.uploadAttributes(Le.shaderValues.data,null),Lf._uploadVertexBuffer=Ld),(Lf._uploadScene!==Lj||Ll)&&(Lf.uploadSceneUniforms(Lj._shaderValues.data),Lf._uploadScene=Lj),(Lk!==Lf._uploadCamera||Lf._uploadSprite3D!==Lq||Ll)&&(Lf.uploadSpriteUniforms(Lq._shaderValues.data),Lf._uploadSprite3D=Lq),(Lk!==Lf._uploadCamera||Ll)&&(Lf.uploadCameraUniforms(Lk._shaderValues.data),Lf._uploadCamera=Lk),(Lf._uploadMaterial!==Lp||Ll)&&(Lp._upload(),Lf._uploadMaterial=Lp),Lg!==Lp?(Lp._setRenderStateBlendDepth(),Lp._setRenderStateFrontFace(Lb,Lq.transform),Lg=Lp,Lh=Lq):Lh!==Lq&&(Lp._setRenderStateFrontFace(Lb,Lq.transform),Lh=Lq),Lo._render(La),Lf._uploadLoopCount=Li)}}},La._renderShadow=function(La,Lb){for(var Lc,Ld,Le,Lf,Lg,Lh=LA.loopCount,Li=this._scene,Lj=La.camera,Lk=!1,Ll=0,Lm=this._finalElements.length;Ll<Lm;Ll++){var Ln,Lo,Lp,Lq=this._finalElements[Ll];0===Lq._type&&(La.owner=Lp=Lq._sprite3D,Lb||Lp._projectionViewWorldUpdateCamera===Lj&&Lp._projectionViewWorldUpdateLoopCount===LA.loopCount||(Lp._render._renderUpdate(La._projectionViewMatrix),Lp._projectionViewWorldUpdateLoopCount=LA.loopCount,Lp._projectionViewWorldUpdateCamera=Lj),La.renderElement=Lq,Lp._preRenderUpdateComponents(La),Ln=Lq.renderObj,Lo=Lq._material,this._begainRenderElement(La,Ln,null)&&(Ld=(Lc=Ln._getVertexBuffer(0)).vertexDeclaration,Lk=(Le=La._shader=Lo._getShader(Li._shaderDefineValue,Ld.shaderDefineValue,Lp._shaderDefineValue)).bind()||Lh!==Le._uploadLoopCount,(Le._uploadVertexBuffer!==Lc||Lk)&&(Le.uploadAttributes(Ld.shaderValues.data,null),Le._uploadVertexBuffer=Lc),(Lj!==Le._uploadCamera||Le._uploadSprite3D!==Lp||Lk)&&(Le.uploadSpriteUniforms(Lp._shaderValues.data),Le._uploadSprite3D=Lp),(Lj!==Le._uploadCamera||Lk)&&(Le.uploadCameraUniforms(Lj._shaderValues.data),Le._uploadCamera=Lj),(Le._uploadMaterial!==Lo||Lk)&&(Lo._upload(),Le._uploadMaterial=Lo),Le._uploadRenderElement,Lf!==Lo?(Lo._setRenderStateFrontFace(!1,Lp.transform),Lf=Lo,Lg=Lp):Lg!==Lp&&(Lo._setRenderStateFrontFace(!1,Lp.transform),Lg=Lp),Ln._render(La),Le._uploadLoopCount=Lh),Lp._postRenderUpdateComponents(La))}},La._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},La._addRenderElement=function(La){this._renderElements.push(La),this._needSort=!0},La._addDynamicBatchElement=function(La){this._dynamicBatchCombineRenderElements.push(La)},Lo(0,La,"id",function(){return this._id}),Lb._uniqueIDCounter=0,Lb._cameraPosition=null,Lb}(),LY=function(){function La(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Ln(La,"laya.d3.core.render.RenderState"),La.clientWidth=0,La.clientHeight=0,La}(),LZ=function(){function Lg(La,Lb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new L_a(new Lgb,0),this._corners=[new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb],this._boundingBoxCenter=new Lgb,this._children=Ld(8),this._objects=[],this._tempBoundBoxCorners=[new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb],this._scene=La,this._currentDepth=Lb}Ln(Lg,"laya.d3.core.scene.OctreeNode");var La=Lg.prototype;return Lv.imps(La,{"laya.d3.core.scene.ITreeNode":!0}),La.init=function(La,Lb){var Lc=new Lgb,Ld=new Lgb;Lgb.scale(Lb,-.5,Lc),Lgb.scale(Lb,.5,Ld),Lgb.add(Lc,La,Lc),Lgb.add(Ld,La,Ld),this.exactBox=new LZa(Lc,Ld),this.relaxBox=new LZa(Lc,Ld)},La.addTreeNode=function(La){1===Collision.boxContainsBox(this._relaxBox,La.boundingBox)?this.addNodeDown(La,0):this.addObject(La)},La.addChild=function(La){var Lb=this._children[La];if(null==Lb){Lb=new Lg(this._scene,this._currentDepth+1),(this._children[La]=Lb)._parent=this,Lgb.subtract(this._exactBox.max,this._exactBox.min,Lg.tempSize),Lgb.multiply(Lg.tempSize,Lg._octreeSplit[La],Lg.tempCenter),Lgb.add(this._exactBox.min,Lg.tempCenter,Lg.tempCenter),Lgb.scale(Lg.tempSize,.25,Lg.tempSize);var Lc=new Lgb,Ld=new Lgb;Lgb.subtract(Lg.tempCenter,Lg.tempSize,Lc),Lgb.add(Lg.tempCenter,Lg.tempSize,Ld),Lb.exactBox=new LZa(Lc,Ld),Lgb.scale(Lg.tempSize,Lg.relax,Lg.tempSize);var Le=new Lgb,Lf=new Lgb;Lgb.subtract(Lg.tempCenter,Lg.tempSize,Le),Lgb.add(Lg.tempCenter,Lg.tempSize,Lf),Lb.relaxBox=new LZa(Le,Lf)}return Lb},La.addObject=function(La){(La._treeNode=this)._objects.push(La)},La.removeObject=function(La){if(La._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Lb=this._objects.indexOf(La);return-1!==Lb&&(this._objects.splice(Lb,1),!0)},La.clearObject=function(){this._objects.length=0},La.addNodeUp=function(La,Lb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,La.boundingBox)?this._parent.addNodeUp(La,Lb-1):this.addNodeDown(La,Lb)},La.addNodeDown=function(La,Lb){if(Lb<this._scene.treeLevel){var Lc=this.inChildIndex(La.boundingBoxCenter),Ld=this.addChild(Lc);1===Collision.boxContainsBox(Ld._relaxBox,La.boundingBox)?Ld.addNodeDown(La,++Lb):this.addObject(La)}else this.addObject(La)},La.inChildIndex=function(La){return 4*(La.z<this._boundingBoxCenter.z?0:1)+2*(La.y<this._boundingBoxCenter.y?0:1)+(La.x<this._boundingBoxCenter.x?0:1)},La.updateObject=function(La){1===Collision.boxContainsBox(this._relaxBox,La.boundingBox)?(this.removeObject(La),La._treeNode=null,this.addNodeDown(La,this._currentDepth)):this._parent&&(this.removeObject(La),La._treeNode=null,this._parent.addNodeUp(La,this._currentDepth-1))},La.cullingObjects=function(La,Lb,Lc,Ld,Le){var Lf,Lg=0,Lh=0,Li=0,Lj=this._scene._dynamicBatchManager;for(Lg=0,Lf=this._objects.length;Lg<Lf;Lg++){var Lk=this._objects[Lg];if(LI.isVisible(Lk._owner.layer.mask)&&Lk.enable){if(Lb&&(LA.treeSpriteCollision+=1,0===La.containsBoundSphere(Lk.boundingSphere)))continue;Lk._renderUpdate(Le),Lk._distanceForSort=Lgb.distance(Lk.boundingSphere.center,Ld)+Lk.sortingFudge;var Ll=Lk._renderElements;for(Lh=0,Li=Ll.length;Lh<Li;Lh++){var Lm=Ll[Lh],Ln=Lm._staticBatch;if(Ln&&Ln._material===Lm._material)Ln._addBatchRenderElement(Lm);else{var Lo=Lm.renderObj;Lo.triangleCount<10&&1===Lo._vertexBufferCount&&Lo._getIndexBuffer()&&Lm._material.renderQueue<2&&Lm._canDynamicBatch&&!Lk._owner.isStatic?Lj._addPrepareRenderElement(Lm):this._scene.getRenderQueue(Lm._material.renderQueue)._addRenderElement(Lm)}}}}for(Lg=0;Lg<8;Lg++){var Lp=this._children[Lg];if(null!=Lp){var Lq=Lb;if(Lb){var Lr=La.containsBoundBox(Lp._relaxBox);if(LA.treeNodeCollision+=1,0===Lr)continue;Lq=2===Lr}Lp.cullingObjects(La,Lq,Lc,Ld,Le)}}},La.cullingShadowObjects=function(La,Lb,Lc,Ld,Le){var Lf,Lg=0,Lh=0,Li=0;this._scene._dynamicBatchManager;for(Lg=0,Lf=this._objects.length;Lg<Lf;Lg++){var Lj=this._objects[Lg];if(Lj.castShadow&&LI.isVisible(Lj._owner.layer.mask)&&Lj.enable){if(Lc&&0===La[0].containsBoundSphere(Lj.boundingSphere))continue;for(var Lk=1,Ll=La.length;Lk<Ll;Lk++){var Lm=Lb[Lk-1];if(0!==La[Lk].containsBoundSphere(Lj.boundingSphere)){var Ln=Lj._renderElements;for(Lh=0,Li=Ln.length;Lh<Li;Lh++)Lm._addRenderElement(Ln[Lh])}}}}for(Lg=0;Lg<8;Lg++){var Lo=this._children[Lg];if(null!=Lo){var Lp=Lc;if(Lc){var Lq=La[0].containsBoundBox(Lo._relaxBox);if(0===Lq)continue;Lp=2===Lq}Lo.cullingShadowObjects(La,Lb,Lp,Ld,Le)}}},La.cullingShadowObjectsOnePSSM=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh=Lb[0],Li=0,Lj=0,Lk=0;for(Li=0,Lg=this._objects.length;Li<Lg;Li++){var Ll=this._objects[Li];if(Ll.castShadow&&LI.isVisible(Ll._owner.layer.mask)&&Ll.enable){if(Ld&&0===La.containsBoundSphere(Ll.boundingSphere))continue;Ll._renderUpdate(Lc);var Lm=Ll._renderElements;for(Lj=0,Lk=Lm.length;Lj<Lk;Lj++)Lh._addRenderElement(Lm[Lj])}}for(Li=0;Li<8;Li++){var Ln=this._children[Li];if(null!=Ln){var Lo=Ld;if(Ld){var Lp=La.containsBoundBox(Ln._relaxBox);if(0===Lp)continue;Lo=2===Lp}Ln.cullingShadowObjectsOnePSSM(La,Lb,Lc,Lo,Le,Lf)}}},La.renderBoudingBox=function(La){this._renderBoudingBox(La);for(var Lb=0;Lb<8;++Lb){var Lc=this._children[Lb];Lc&&Lc.renderBoudingBox(La)}},La.buildAllChild=function(La){if(La<this._scene.treeLevel)for(var Lb=0;Lb<8;Lb++){this.addChild(Lb).buildAllChild(La+1)}},La._renderBoudingBox=function(La){},Lo(0,La,"exactBox",function(){return this._exactBox},function(La){this._exactBox=La,Lgb.add(La.min,La.max,this._boundingBoxCenter),Lgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),Lo(0,La,"relaxBox",function(){return this._relaxBox},function(La){(this._relaxBox=La).getCorners(this._corners),L_a.createfromPoints(this._corners,this._boundingSphere)}),Lg.debugMode=!1,Lg.relax=1.15,Lg.CHILDNUM=8,Ll(Lg,["tempVector0",function(){return this.tempVector0=new Lgb},"tempSize",function(){return this.tempSize=new Lgb},"tempCenter",function(){return this.tempCenter=new Lgb},"_octreeSplit",function(){return this._octreeSplit=[new Lgb(.25,.25,.25),new Lgb(.75,.25,.25),new Lgb(.25,.75,.25),new Lgb(.75,.75,.25),new Lgb(.25,.25,.75),new Lgb(.75,.25,.75),new Lgb(.25,.75,.75),new Lgb(.75,.75,.75)]}]),Lg}(),L$=(function(){function La(){}Ln(La,"laya.d3.core.scene.SceneManager")}(),function(){function La(La,Lb,Lc,Ld){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===La&&(La=1),void 0===Lb&&(Lb=1),void 0===Lc&&(Lc=1),void 0===Ld&&(Ld=1),this._r=La,this._g=Lb,this._b=Lc,this._a=Ld}return Ln(La,"laya.d3.core.trail.module.Color",null,"Color$1"),La.prototype.cloneTo=function(La){La._r=this._r,La._g=this._g,La._b=this._b,La._a=this._a},Ll(La,["RED",function(){return this.RED=new La(1,0,0,1)},"GREEN",function(){return this.GREEN=new La(0,1,0,1)},"BLUE",function(){return this.BLUE=new La(0,0,1,1)},"CYAN",function(){return this.CYAN=new La(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new La(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new La(1,0,1,1)},"GRAY",function(){return this.GRAY=new La(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new La(1,1,1,1)},"BLACK",function(){return this.BLACK=new La(0,0,0,1)}]),La}()),L_=(function(){function La(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Ln(La,"laya.d3.core.trail.module.Gradient");var Lb=La.prototype;Lb.setKeys=function(La,Lb){var Lc,Ld;this._colorKeys=La;for(var Le=this.index=0;Le<La.length;Le++){var Lf=(Lc=La[Le]).color;this._colorKeyData[this.index++]=Lf._r,this._colorKeyData[this.index++]=Lf._g,this._colorKeyData[this.index++]=Lf._b,this._colorKeyData[this.index++]=Lc.time}this._alphaKeys=Lb;for(var Lg=this.index=0;Lg<Lb.length;Lg++)Ld=Lb[Lg],this._alphaKeyData[this.index++]=Ld.alpha,this._alphaKeyData[this.index++]=Ld.time},Lb.cloneTo=function(La){var Lb=0,Lc=0,Ld=this.colorKeys,Le=[];for(Lb=0,Lc=Ld.length;Lb<Lc;Lb++){var Lf=new Lw;Ld[Lb].cloneTo(Lf),Le.push(Lf)}var Lg=this.alphaKeys,Lh=[];for(Lb=0,Lc=Lg.length;Lb<Lc;Lb++){var Li=new L_;Lg[Lb].cloneTo(Li),Lh.push(Li)}La.setKeys(Le,Lh)},Lo(0,Lb,"mode",function(){return this._mode},function(La){this._mode=La}),Lo(0,Lb,"colorKeys",function(){return this._colorKeys},function(La){this._colorKeys=La;for(var Lb=this.index=0;Lb<La.length;Lb++){var Lc=La[Lb],Ld=Lc.color;this._colorKeyData[this.index++]=Ld._r,this._colorKeyData[this.index++]=Ld._g,this._colorKeyData[this.index++]=Ld._b,this._colorKeyData[this.index++]=Lc.time}}),Lo(0,Lb,"alphaKeys",function(){return this._alphaKeys},function(La){this._alphaKeys=La;for(var Lb=this.index=0;Lb<La.length;Lb++){var Lc=La[Lb];this._alphaKeyData[this.index++]=Lc.alpha,this._alphaKeyData[this.index++]=Lc.time}})}(),function(){function La(La,Lb){this._alpha=NaN,this._time=NaN,void 0===La&&(La=0),void 0===Lb&&(Lb=0),this._alpha=La,this._time=Lb}Ln(La,"laya.d3.core.trail.module.GradientAlphaKey");var Lb=La.prototype;return Lb.cloneTo=function(La){La.alpha=this.alpha,La.time=this.time},Lo(0,Lb,"alpha",function(){return this._alpha},function(La){this._alpha=La}),Lo(0,Lb,"time",function(){return this._time},function(La){this._time=La}),La}()),Lw=function(){function La(La,Lb){this._color=null,this._time=NaN,void 0===Lb&&(Lb=0),this._color=La||new L$,this._time=Lb}Ln(La,"laya.d3.core.trail.module.GradientColorKey");var Lb=La.prototype;return Lb.cloneTo=function(La){this.color.cloneTo(La.color),La.time=this.time},Lo(0,Lb,"color",function(){return this._color},function(La){this._color=La}),Lo(0,Lb,"time",function(){return this._time},function(La){this._time=La}),La}(),Lx=(function(){function La(){}Ln(La,"laya.d3.core.trail.module.GradientMode"),La.Blend=0,La.Fixed=1}(),function(){function La(){}Ln(La,"laya.d3.core.trail.module.TextureMode"),La.Stretch=0,La.Tile=1}(),function(){function La(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Ln(La,"laya.d3.core.trail.module.TrailKeyFrame"),La.prototype.cloneTo=function(La){La.time=this.time,La.inTangent=this.inTangent,La.outTangent=this.outTangent,La.value=this.value}}(),function(){function Lb(La){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new Lgb,this._curPosition=new Lgb,this._delVector3=new Lgb,this._lastFixedVertexPosition=new Lgb,this._pointAtoBVector3=new Lgb,this._pointA=new Lgb,this._pointB=new Lgb,this._owner=La,this._id=Lb.renderElementCount++,0==this._id?La._owner.transform.position.cloneTo(this._lastPosition):La._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new LOb(Lx.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new LOb(Lx.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Ln(Lb,"laya.d3.core.trail.TrailRenderElement");var La=Lb.prototype;Lv.imps(La,{"laya.d3.core.render.IRenderable":!0}),La._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},La._addTrailByFirstPosition=function(La,Lb){Lgb.subtract(Lb,La,this._delVector3),Lgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Lgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Lgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(La),La.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},La._addTrailByNextPosition=function(La){Lgb.subtract(La,this._lastFixedVertexPosition,this._delVector3),Lgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Lgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Lgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=Lgb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=Lwa.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(La),La.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(La),this._virtualVerticesCount=2)},La._updateVerticesByPosition=function(La){this._pointe=La.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},La._updateVertexBuffer2=function(){var La,Lb=0,Lc=0,Ld=0;for(Ld=0,La=(this._verticesCount+this._virtualVerticesCount)/2;Ld<La;Ld++)Lc=0==this._owner.textureMode?(this._VerticesToTailLength[Ld]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Ld],this._vertices2[Lb++]=1-Lc,this._vertices2[Lb++]=1-Lc;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},La._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},La._updateDisappear=function(){var La,Lb=0;for(Lb=this._curDisappearIndex,La=(this._verticesCount+this._virtualVerticesCount)/2;Lb<La;Lb++)this._owner._curtime-this._everyGroupVertexBirthTime[Lb]>=this._owner.time+Lwa.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},La._beforeRender=function(La){return this._camera=La.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),Lgb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},La._render=function(La){this._isDead||(LF.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),LA.drawCall++,LA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},La._getVertexBuffer=function(La){return void 0===La&&(La=0),0===La?this._vertexBuffer1:1===La?this._vertexBuffer2:null},La._getVertexBuffers=function(){return this._vertexBuffers},La._getIndexBuffer=function(){return null},La.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},La._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},Lo(0,La,"_vertexBufferCount",function(){return this._vertexBuffers.length}),Lo(0,La,"triangleCount",function(){return 0}),Lb.renderElementCount=0}(),function(){function La(){}Ln(La,"laya.d3.core.trail.VertexTrail");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration1}),Lo(1,La,"vertexDeclaration1",function(){return La._vertexDeclaration1}),Lo(1,La,"vertexDeclaration2",function(){return La._vertexDeclaration2}),Ll(La,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Lfa(32,[new Lga(0,"vector3",0),new Lga(12,"vector3",41),new Lga(24,"single",33),new Lga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Lfa(4,[new Lga(0,"single",38)])}]),La}()),Laa=function(){function Lu(La){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=La}Ln(Lu,"laya.d3.graphics.DynamicBatch");var La=Lu.prototype;return Lv.imps(La,{"laya.d3.core.render.IRenderable":!0}),La._getVertexBuffer=function(La){return void 0===La&&(La=0),0===La?this._vertexBuffer:null},La._getIndexBuffer=function(){return this._indexBuffer},La._getCombineRenderElementFromPool=function(La,Lb,Lc){var Ld=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Ld||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Ld=new LW,Ld._sprite3D=new LXb),Ld._sprite3D._render._renderUpdate(Lc),Ld},La._getRenderElement=function(La,Lb,Lc){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*Lu.maxVertexCount),this._indexDatas=new Uint16Array(Lu.maxIndexCount),this._vertexBuffer=LOb.create(this._vertexDeclaration,Lu.maxVertexCount,35048),this._indexBuffer=LNb.create("ushort",Lu.maxIndexCount,35048));for(var Ld=this._merageElements.length=0,Le=0,Lf=0,Lg=this._combineRenderElements.length;Lf<Lg;Lf++){var Lh=this._combineRenderElements[Lf],Li=Lh.getDynamicBatchBakedVertexs(0),Lj=Lh.getBakedIndices(),Lk=Lh._sprite3D.transform._isFrontFaceInvert,Ll=Ld/(this._vertexDeclaration.vertexStride/4),Lm=Le,Ln=Lm+Lj.length;Lh._tempBatchIndexStart=Lm,Lh._tempBatchIndexEnd=Ln,this._indexDatas.set(Lj,Le);var Lo=0;if(Lk)for(Lo=Lm;Lo<Ln;Lo+=3){this._indexDatas[Lo]=Ll+this._indexDatas[Lo];var Lp=this._indexDatas[Lo+1],Lq=this._indexDatas[Lo+2];this._indexDatas[Lo+1]=Ll+Lq,this._indexDatas[Lo+2]=Ll+Lp}else for(Lo=Lm;Lo<Ln;Lo+=3)this._indexDatas[Lo]=Ll+this._indexDatas[Lo],this._indexDatas[Lo+1]=Ll+this._indexDatas[Lo+1],this._indexDatas[Lo+2]=Ll+this._indexDatas[Lo+2];Le+=Lj.length,this._vertexDatas.set(Li,Ld),Ld+=Li.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Lf=this._combineRenderElementPoolIndex=0,Lg=this._materials.length;Lf<Lg;Lf++){var Lr=this._getCombineRenderElementFromPool(La,Lb,Lc);Lr._type=2,Lr._staticBatch=null;var Ls=(Lr.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Lf]]._tempBatchIndexStart,Lt=Lf+1===this._materialToRenderElementsOffsets.length?Le:this._combineRenderElements[this._materialToRenderElementsOffsets[Lf+1]]._tempBatchIndexStart;Lr._tempBatchIndexStart=Ls,Lr._tempBatchIndexEnd=Lt,Lr._material=this._materials[Lf],this._merageElements.push(Lr)}},La._addCombineRenderObjTest=function(La){var Lb=La.renderObj,Lc=this._currentCombineIndexCount+Lb._getIndexBuffer().indexCount,Ld=this._currentCombineVertexCount+Lb._getVertexBuffer().vertexCount;return!(Lu.maxVertexCount<Ld||Lu.maxIndexCount<Lc)},La._addCombineRenderObj=function(La){var Lb=La.renderObj;this._combineRenderElements.push(La),this._currentCombineIndexCount=this._currentCombineIndexCount+Lb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Lb._getVertexBuffer().vertexCount},La._addCombineMaterial=function(La){this._materials.push(La)},La._addMaterialToRenderElementOffset=function(La){this._materialToRenderElementsOffsets.push(La)},La._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},La._addToRenderQueue=function(La,Lb,Lc,Ld){this._getRenderElement(Lb,Lc,Ld);for(var Le=0,Lf=this._materials.length;Le<Lf;Le++)La.getRenderQueue(this._materials[Le].renderQueue)._addDynamicBatchElement(this._merageElements[Le])},La._beforeRender=function(La){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},La._render=function(La){var Lb=La._batchIndexEnd-La._batchIndexStart;LF.mainContext.drawElements(4,Lb,5123,2*La._batchIndexStart),LA.drawCall++,LA.trianglesFaces+=Lb/3},La._getVertexBuffers=function(){return null},Lo(0,La,"_vertexBufferCount",function(){return 1}),Lo(0,La,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Lo(0,La,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),Lu.maxVertexCount=2e4,Lu.maxIndexCount=4e4,Lu.maxCombineTriangleCount=10,Lu}(),Lba=function(){function Lu(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Ln(Lu,"laya.d3.graphics.DynamicBatchManager");var La=Lu.prototype;return La.getDynamicBatch=function(La,Lb){var Lc,Ld=La.id.toString()+Lb;return this._dynamicBatches[Ld]?Lc=this._dynamicBatches[Ld]:this._dynamicBatches[Ld]=Lc=new Laa(La),Lc},La._garbageCollection=function(){for(var La in this._dynamicBatches)0===this._dynamicBatches[La].combineRenderElementsCount&&delete this._dynamicBatches[La]},La._addPrepareRenderElement=function(La){this._prepareDynamicBatchCombineElements.push(La)},La._finishCombineDynamicBatch=function(La){var Lb,Lc,Ld;this._prepareDynamicBatchCombineElements.sort(Lu._sortPrepareDynamicBatch);for(var Le,Lf,Lg,Lh,Li,Lj=-1,Lk=!0,Ll=0,Lm=-1,Ln=0,Lo=this._prepareDynamicBatchCombineElements.length;Ln<Lo;Ln++){var Lp=(Lf=this._prepareDynamicBatchCombineElements[Ln]).renderObj._getVertexBuffer(0).vertexDeclaration,Lq=Lc!==Lp;Lq&&(Ll=0,Lc=Lp);var Lr=Ll!==Lj;if(Lr&&(Lj=Ll),(Lq||Lr)&&(Lg=this.getDynamicBatch(Lp,Ll),Lb=null),Lk)if(Lg._addCombineRenderObjTest(Lf)){if(Lb!==(Le=Lf._material))Lh&&(La.getRenderQueue(Li._material.renderQueue)._addRenderElement(Li),Li=Lh=null,Lm=-1),Lh=Le,Lm=Lg.combineRenderElementsCount,Li=Lf,Lb=Le;else if(Lh){var Ls=Li.renderObj,Lt=Lf.renderObj;Ls._getVertexBuffer().vertexCount+Lt._getVertexBuffer().vertexCount>Laa.maxVertexCount||Ls._getIndexBuffer().indexCount+Lt._getIndexBuffer().indexCount>Laa.maxIndexCount?(La.getRenderQueue(Li._material.renderQueue)._addRenderElement(Li),Lh=Le,Lm=Lg.combineRenderElementsCount,Li=Lf):(Lg._addCombineMaterial(Lh),Lg._addMaterialToRenderElementOffset(Lm),Lg._addCombineRenderObj(Li),Li=Lh=null,Lm=-1,Lg._addCombineRenderObj(Lf))}else Lg._addCombineRenderObj(Lf);Lk=!0}else Lh&&(La.getRenderQueue(Li._material.renderQueue)._addRenderElement(Li),Li=Lh=null,Lm=-1),Ll++,Lk=!1;else Ld=this._prepareDynamicBatchCombineElements[Ln-1],Lg._addMaterialToRenderElementOffset(Lg.combineRenderElementsCount),Lb=Ld._material,Lg._addCombineMaterial(Lb),Lg._addCombineRenderObj(Ld),Lk=!0,Lb!==(Le=Lf._material)?(Lh=Le,Lm=Lg.combineRenderElementsCount,Li=Lf):Lg._addCombineRenderObj(Lf),Lb=Le}Lh&&(La.getRenderQueue(Li._material.renderQueue)._addRenderElement(Li),Li=Lh=null,Lm=-1),this._prepareDynamicBatchCombineElements.length=0},La._clearRenderElements=function(){for(var La in this._dynamicBatches)this._dynamicBatches[La]._clearRenderElements()},La._addToRenderQueue=function(La,Lb,Lc,Ld){for(var Le in this._dynamicBatches){var Lf=this._dynamicBatches[Le];0<Lf.combineRenderElementsCount&&Lf._addToRenderQueue(La,Lb,Lc,Ld)}},La.dispose=function(){this._dynamicBatches=null},Lu._sortPrepareDynamicBatch=function(La,Lb){return La._mainSortID-Lb._mainSortID},Lu}(),Lca=function(){function La(){}return Ln(La,"laya.d3.graphics.FrustumCulling"),La.renderShadowObjectCulling=function(La,Lb,Lc,Ld,Le){var Lf=0,Lg=0,Lh=0,Li=0;for(Lf=0,Lh=Lc.length;Lf<Lh;Lf++){var Lj=Lc[Lf];Lj&&Lj._clearRenderElements()}var Lk,Ll,Lm,Ln=La._cullingRenders;if(1<Le){for(Lf=0,Lh=La._cullingRendersLength;Lf<Lh;Lf++)if((Lk=Ln[Lf]).castShadow&&LI.isVisible(Lk._owner.layer.mask)&&Lk.enable)for(var Lo=1,Lp=Lb.length;Lo<Lp;Lo++)if(Ll=Lc[Lo-1],0!==Lb[Lo].containsBoundSphere(Lk.boundingSphere))for(Lg=0,Li=(Lm=Lk._renderElements).length;Lg<Li;Lg++)Ll._addRenderElement(Lm[Lg])}else for(Lf=0,Lh=La._cullingRendersLength;Lf<Lh;Lf++)if((Lk=Ln[Lf]).castShadow&&LI.isVisible(Lk._owner.layer.mask)&&Lk.enable&&0!==Lb[0].containsBoundSphere(Lk.boundingSphere))for(Lk._renderUpdate(Ld),Ll=Lc[0],Lg=0,Li=(Lm=Lk._renderElements).length;Lg<Li;Lg++)Ll._addRenderElement(Lm[Lg])},La.renderShadowObjectCullingOctree=function(La,Lb,Lc,Ld,Le){for(var Lf=0,Lg=Lc.length;Lf<Lg;Lf++){var Lh=Lc[Lf];Lh&&Lh._clearRenderElements()}1<Le?La.treeRoot.cullingShadowObjects(Lb,Lc,!0,0,La):La.treeRoot.cullingShadowObjectsOnePSSM(Lb[0],Lc,Ld,!0,0,La)},La.renderObjectCulling=function(La,Lb,Lc,Ld,Le,Lf){var Lg=0,Lh=0,Li=0,Lj=0,Lk=Lb._quenes,Ll=Lb._dynamicBatchManager,Lm=Lb._cullingRenders;for(Lg=0,Lh=Lk.length;Lg<Lh;Lg++){var Ln=Lk[Lg];Ln&&Ln._clearRenderElements()}var Lo=Lda._staticBatchManagers;for(Lg=0,Lh=Lo.length;Lg<Lh;Lg++)Lo[Lg]._clearRenderElements();Ll._clearRenderElements();var Lp=Lc.transform.position;for(Lg=0,Lh=Lb._cullingRendersLength;Lg<Lh;Lg++){var Lq=Lm[Lg];if(LI.isVisible(Lq._owner.layer.mask)&&Lq.enable&&0!==La.containsBoundSphere(Lq.boundingSphere)&&Lq._renderUpdate(Lf)){Lq._distanceForSort=Lgb.distance(Lq.boundingSphere.center,Lp)+Lq.sortingFudge;var Lr=Lq._renderElements;for(Li=0,Lj=Lr.length;Li<Lj;Li++){var Ls=Lr[Li],Lt=Ls._staticBatch;if(Lt&&Lt._material===Ls._material)Lt._addBatchRenderElement(Ls);else{var Lu=Ls.renderObj;Lu.triangleCount<10&&1===Lu._vertexBufferCount&&Lu._getIndexBuffer()&&Ls._material.renderQueue<2&&Ls._canDynamicBatch&&!Lq._owner.isStatic?Ll._addPrepareRenderElement(Ls):Lb.getRenderQueue(Ls._material.renderQueue)._addRenderElement(Ls)}}}}for(Lg=0,Lh=Lo.length;Lg<Lh;Lg++)Lo[Lg]._addToRenderQueue(Lb,Ld,Le,Lf);Ll._finishCombineDynamicBatch(Lb),Ll._addToRenderQueue(Lb,Ld,Le,Lf)},La.renderObjectCullingOctree=function(La,Lb,Lc,Ld,Le,Lf){var Lg=0,Lh=0,Li=Lb._quenes,Lj=Lb._dynamicBatchManager;for(Lg=0,Lh=Li.length;Lg<Lh;Lg++){var Lk=Li[Lg];Lk&&Lk._clearRenderElements()}var Ll=Lda._staticBatchManagers;for(Lg=0,Lh=Ll.length;Lg<Lh;Lg++)Ll[Lg]._clearRenderElements();for(Lj._clearRenderElements(),Lb._cullingRenders.length=0,Lb.treeRoot.cullingObjects(La,!0,0,Lc.transform.position,Lf),Lg=0,Lh=Ll.length;Lg<Lh;Lg++)Ll[Lg]._addToRenderQueue(Lb,Ld,Le,Lf);Lj._finishCombineDynamicBatch(Lb),Lj._addToRenderQueue(Lb,Ld,Le,Lf)},La.renderObjectCullingNoBoundFrustum=function(La,Lb,Lc,Ld,Le){var Lf=0,Lg=0,Lh=0,Li=0,Lj=La._quenes,Lk=La._dynamicBatchManager,Ll=La._cullingRenders;for(Lf=0,Lg=Lj.length;Lf<Lg;Lf++){var Lm=Lj[Lf];Lm&&Lm._clearRenderElements()}var Ln=Lda._staticBatchManagers;for(Lf=0,Lg=Ln.length;Lf<Lg;Lf++)Ln[Lf]._clearRenderElements();Lk._clearRenderElements();var Lo=Lb.transform.position;for(Lf=0,Lg=La._cullingRendersLength;Lf<Lg;Lf++){var Lp=Ll[Lf];if(LI.isVisible(Lp._owner.layer.mask)&&Lp.enable){Lp._renderUpdate(Le),Lp._distanceForSort=Lgb.distance(Lp.boundingSphere.center,Lo)+Lp.sortingFudge;var Lq=Lp._renderElements;for(Lh=0,Li=Lq.length;Lh<Li;Lh++){var Lr=Lq[Lh],Ls=Lr._staticBatch;if(Ls&&Ls._material===Lr._material)Ls._addBatchRenderElement(Lr);else{var Lt=Lr.renderObj;Lt.triangleCount<10&&1===Lt._vertexBufferCount&&Lt._getIndexBuffer()&&Lr._material.renderQueue<2&&Lr._canDynamicBatch&&!Lp._owner.isStatic?Lk._addPrepareRenderElement(Lr):La.getRenderQueue(Lr._material.renderQueue)._addRenderElement(Lr)}}}}for(Lf=0,Lg=Ln.length;Lf<Lg;Lf++)Ln[Lf]._addToRenderQueue(La,Lc,Ld,Le);Lk._finishCombineDynamicBatch(La),Lk._addToRenderQueue(La,Lc,Ld,Le)},La}(),Lda=function(){function Lf(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Ln(Lf,"laya.d3.graphics.StaticBatchManager");var La=Lf.prototype;return La._finishInit=function(){for(var La in this._staticBatches)this._staticBatches[La]._finishInit();this._initBatchRenderElements.length=0},La._initStaticBatchs=function(La){throw new Error("StaticBatchManager:must override this function.")},La._addInitBatchSprite=function(La){for(var Lb=La._render._renderElements,Lc=0,Ld=Lb.length;Lc<Ld;Lc++)this._initBatchRenderElements.push(Lb[Lc])},La._clearRenderElements=function(){for(var La in this._staticBatches)this._staticBatches[La]._clearRenderElements()},La._garbageCollection=function(La){var Lb=La._staticBatch,Lc=Lb._initBatchRenderElements,Ld=Lc.indexOf(La);Lc.splice(Ld,1),0===Lc.length&&(Lb.dispose(),delete this._staticBatches[Lb._key])},La._addToRenderQueue=function(La,Lb,Lc,Ld){for(var Le in this._staticBatches){var Lf=this._staticBatches[Le];0<Lf._batchRenderElements.length&&Lf._updateToRenderQueue(La,Ld)}},La.dispose=function(){this._staticBatches=null},Lf._addToStaticBatchQueue=function(La){La instanceof laya.d3.core.RenderableSprite3D&&La._addToInitStaticBatchManager();for(var Lb=0,Lc=La.numChildren;Lb<Lc;Lb++)Lf._addToStaticBatchQueue(La._childs[Lb])},Lf.combine=function(La,Lb){var Lc,Ld=0,Le=0;if(Lb)for(Ld=0,Le=Lb.length;Ld<Le;Ld++){Lb[Ld]._addToInitStaticBatchManager()}else La&&Lf._addToStaticBatchQueue(La);for(Ld=0,Le=Lf._staticBatchManagers.length;Ld<Le;Ld++)(Lc=Lf._staticBatchManagers[Ld])._initStaticBatchs(La),Lc._finishInit()},Lf._staticBatchManagers=[],Lf}(),Lea=function(){function La(La,Lb,Lc){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=La,this._manager=Lb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=Lc}Ln(La,"laya.d3.graphics.StaticBatch");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Lb._binarySearch=function(La){for(var Lb=0,Lc=this._batchRenderElements.length-1,Ld=0;Lb<=Lc;)Ld=Math.floor((Lb+Lc)/2),this._compareBatchRenderElement(this._batchRenderElements[Ld],La)?Lc=Ld-1:Lb=Ld+1;return Lb},Lb._compareBatchRenderElement=function(La,Lb){throw new Error("StaticBatch:must override this function.")},Lb._getVertexDecLightMap=function(La){return La===LNa.vertexDeclaration?LIa.vertexDeclaration:La===LMa.vertexDeclaration?LHa.vertexDeclaration:La===LBa.vertexDeclaration?Lua.vertexDeclaration:La===LRa.vertexDeclaration?null:La===Lpa.vertexDeclaration?Lqa.vertexDeclaration:La===LPa.vertexDeclaration?LKa.vertexDeclaration:La===LFa.vertexDeclaration?LGa.vertexDeclaration:La===LOa.vertexDeclaration?LJa.vertexDeclaration:La===LMa.vertexDeclaration?LHa.vertexDeclaration:La===LCa.vertexDeclaration?Lva.vertexDeclaration:La===LRa.vertexDeclaration?null:La===Lpa.vertexDeclaration?Lqa.vertexDeclaration:La===LQa.vertexDeclaration?LLa.vertexDeclaration:La===LFa.vertexDeclaration?LGa.vertexDeclaration:La},Lb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Lb._addBatchRenderElement=function(La){this._batchRenderElements.splice(this._binarySearch(La),0,La)},Lb._updateToRenderQueue=function(La,Lb){this._combineRenderElementPoolIndex=0,this._getRenderElement(La.getRenderQueue(this._material.renderQueue)._renderElements,La,Lb)},Lb._getRenderElement=function(La,Lb,Lc){throw new Error("StaticBatch:must override this function.")},Lb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Lb._clearRenderElements=function(){this._batchRenderElements.length=0},Lb.dispose=function(){},Lb._getVertexBuffer=function(La){return void 0===La&&(La=0),null},Lb._getIndexBuffer=function(){return null},Lb._beforeRender=function(La){return!0},Lb._render=function(La){},Lb._getVertexBuffers=function(){return null},Lo(0,Lb,"_vertexBufferCount",function(){return 1}),Lo(0,Lb,"triangleCount",function(){return 0}),La.combine=function(La){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Lda.combine(La)},La.maxBatchVertexCount=65535,La}(),Lfa=function(){function Lg(La,Lb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++Lg._uniqueIDCounter,this._id>Lg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",Lg.maxVertexDeclaration);this._shaderValues=new Lmb,this._vertexElementsDic={},this._vertexStride=La,this._vertexElements=Lb;for(var Lc=0;Lc<Lb.length;Lc++){var Ld=Lb[Lc],Le=Ld.elementUsage;this._vertexElementsDic[Le]=Ld;var Lf=[Lg._getTypeSize(Ld.elementFormat)/4,5126,!1,this._vertexStride,Ld.offset];switch(this._shaderValues.setValue(Le,Lf),Le){case 1:this._addShaderDefine(LAb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(LAb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(LAb.SHADERDEFINE_UV1)}}}Ln(Lg,"laya.d3.graphics.VertexDeclaration");var La=Lg.prototype;return La._addShaderDefine=function(La){this._shaderDefineValue|=La},La._removeShaderDefine=function(La){this._shaderDefineValue&=~La},La.getVertexElements=function(){return this._vertexElements.slice()},La.getVertexElementByUsage=function(La){return this._vertexElementsDic[La]},La.unBinding=function(){},Lo(0,La,"shaderDefineValue",function(){return this._shaderDefineValue}),Lo(0,La,"id",function(){return this._id}),Lo(0,La,"vertexStride",function(){return this._vertexStride}),Lo(0,La,"shaderValues",function(){return this._shaderValues}),Lg._getTypeSize=function(La){switch(La){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},Lg.getVertexStride=function(La){for(var Lb=0,Lc=0;Lc<La.Length;Lc++){var Ld=La[Lc],Le=Ld.offset+Lg._getTypeSize(Ld.elementFormat);Lb<Le&&(Lb=Le)}return Lb},Lg._maxVertexDeclarationBit=1e3,Lg._uniqueIDCounter=1,Ll(Lg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),Lg}(),Lga=function(){function La(La,Lb,Lc){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=La,this.elementFormat=Lb,this.elementUsage=Lc}return Ln(La,"laya.d3.graphics.VertexElement"),La}(),Lha=(function(){function La(){}Ln(La,"laya.d3.graphics.VertexElementFormat"),La.Single="single",La.Vector2="vector2",La.Vector3="vector3",La.Vector4="vector4",La.Color="color",La.Byte4="byte4",La.Short2="short2",La.Short4="short4",La.NormalizedShort2="normalizedshort2",La.NormalizedShort4="normalizedshort4",La.HalfVector2="halfvector2",La.HalfVector4="halfvector4"}(),function(){function La(){}Ln(La,"laya.d3.graphics.VertexElementUsage"),La.POSITION0=0,La.COLOR0=1,La.TEXTURECOORDINATE0=2,La.NORMAL0=3,La.BINORMAL0=4,La.TANGENT0=5,La.BLENDINDICES0=6,La.BLENDWEIGHT0=7,La.DEPTH0=8,La.FOG0=9,La.POINTSIZE0=10,La.SAMPLE0=11,La.TESSELLATEFACTOR0=12,La.COLOR1=13,La.NEXTTEXTURECOORDINATE0=14,La.TEXTURECOORDINATE1=15,La.NEXTTEXTURECOORDINATE1=16,La.CORNERTEXTURECOORDINATE0=17,La.VELOCITY0=18,La.STARTCOLOR0=19,La.STARTSIZE=20,La.AGEADDSCALE0=21,La.STARTROTATION=22,La.ENDCOLOR0=23,La.STARTLIFETIME=24,La.TIME0=33,La.SHAPEPOSITIONSTARTLIFETIME=30,La.DIRECTIONTIME=32,La.SIZEROTATION0=27,La.RADIUS0=28,La.RADIAN0=29,La.STARTSPEED=31,La.RANDOM0=34,La.RANDOM1=35,La.SIMULATIONWORLDPOSTION=36,La.SIMULATIONWORLDROTATION=37,La.TEXTURECOORDINATE0X=38,La.TEXTURECOORDINATE0X1=39,La.TEXTURECOORDINATE0Y=40,La.OFFSETVECTOR=41}(),function(){function La(La,Lb,Lc){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=La,this._textureCoordinate0=Lb,this._time=Lc}Ln(La,"laya.d3.graphics.VertexGlitter");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate0}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"time",function(){return this._time}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(24,[new Lga(0,"vector3",0),new Lga(12,"vector2",2),new Lga(20,"single",33)])}])}(),function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=La,this._position=Lb,this._velocity=Lc,this._startColor=Ld,this._endColor=Le,this._sizeRotation=Lf,this._radius=Lg,this._radian=Lh,this._ageAddScale=Li,this._time=Lj}Ln(La,"laya.d3.graphics.VertexParticle");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"endColor",function(){return this._endColor}),Lo(0,Lb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Lo(0,Lb,"sizeRotation",function(){return this._sizeRotation}),Lo(0,Lb,"velocity",function(){return this._velocity}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"startColor",function(){return this._startColor}),Lo(0,Lb,"radius",function(){return this._radius}),Lo(0,Lb,"radian",function(){return this._radian}),Lo(0,Lb,"ageAddScale",function(){return this._ageAddScale}),Lo(0,Lb,"time",function(){return this._time}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(116,[new Lga(0,"vector4",17),new Lga(16,"vector3",0),new Lga(28,"vector3",18),new Lga(40,"vector4",19),new Lga(56,"vector4",23),new Lga(72,"vector3",27),new Lga(84,"vector2",28),new Lga(92,"vector4",29),new Lga(108,"single",24),new Lga(112,"single",33)])}])}(),function(){function La(La){this._position=null,this._position=La}Ln(La,"laya.d3.graphics.VertexPosition");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(12,[new Lga(0,"vector3",0)])}]),La}()),Lia=function(){function La(La,Lb){this._position=null,this._normal=null,this._position=La,this._normal=Lb}Ln(La,"laya.d3.graphics.VertexPositionNormal");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(24,[new Lga(0,"vector3",0),new Lga(12,"vector3",3)])}]),La}(),Lja=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._color=null,this._position=La,this._normal=Lb,this._color=Lc}Ln(La,"laya.d3.graphics.VertexPositionNormalColor");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(40,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1)])}]),La}(),Lka=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=La,this._normal=Lb,this._color=Lc,this._blendIndex=Ld,this._blendWeight=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalColorSkin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(72,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector4",7),new Lga(56,"vector4",6)])}]),La}(),Lla=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._tangent=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(88,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector4",7),new Lga(56,"vector4",6),new Lga(72,"vector4",5)])}]),La}(),Lma=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._tangent=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(84,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector4",7),new Lga(56,"vector4",6),new Lga(72,"vector3",5)])}]),La}(),Lna=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._tangent=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(56,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector4",5)])}]),La}(),Loa=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._tangent=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(52,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector3",5)])}]),La}(),Lpa=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(48,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2)])}]),La}(),Lqa=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(56,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15)])}]),La}(),Lra=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._blendIndex=Lf,this._blendWeight=Lg}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(88,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15),new Lga(56,"vector4",7),new Lga(72,"vector4",6)])}]),La}(),Lsa=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._tangent=Lf,this._blendIndex=Lg,this._blendWeight=Lh}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(104,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15),new Lga(56,"vector4",7),new Lga(72,"vector4",6),new Lga(88,"vector4",5)])}]),La}(),Lta=function(){function La(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lb.VertexPositionNormalColorTexture0SkinTangent=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._tangent=Lf,this._blendIndex=Lg,this._blendWeight=Lh},Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(100,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15),new Lga(56,"vector4",7),new Lga(72,"vector4",6),new Lga(88,"vector3",5)])}]),La}(),Lua=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._tangent=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(72,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15),new Lga(56,"vector4",5)])}]),La}(),Lva=function(){function La(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lb.VertexPositionNormalColorTexture0Tangent=function(La,Lb,Lc,Ld,Le,Lf){this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._tangent=Lf},Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(68,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector2",15),new Lga(56,"vector3",5)])}]),La}(),Lya=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(80,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector4",7),new Lga(64,"vector4",6)])}]),La}(),Lza=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld,this._tangent=Le,this._blendIndex=Lf,this._blendWeight=Lg}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(96,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector4",7),new Lga(64,"vector4",6),new Lga(80,"vector4",5)])}]),La}(),LAa=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld,this._tangent=Le,this._blendIndex=Lf,this._blendWeight=Lg}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(92,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector4",7),new Lga(64,"vector4",6),new Lga(80,"vector3",5)])}]),La}(),LBa=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld,this._tangent=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(64,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector4",5)])}]),La}(),LCa=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=La,this._normal=Lb,this._color=Lc,this._textureCoordinate=Ld,this._tangent=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"color",function(){return this._color}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(60,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",1),new Lga(40,"vector2",2),new Lga(48,"vector3",5)])}]),La}(),LDa=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._tangent=null,this._position=La,this._normal=Lb,this._tangent=Lc}Ln(La,"laya.d3.graphics.VertexPositionNormalSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(40,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector4",5)])}]),La}(),LEa=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._tangent=null,this._position=La,this._normal=Lb,this._tangent=Lc}Ln(La,"laya.d3.graphics.VertexPositionNormalTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(36,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector3",5)])}]),La}(),LFa=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(32,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2)])}]),La}(),LGa=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(40,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15)])}]),La}(),LHa=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(72,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15),new Lga(40,"vector4",7),new Lga(56,"vector4",6)])}]),La}(),LIa=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld,this._tangent=Le,this._blendIndex=Lf,this._blendWeight=Lg}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(88,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15),new Lga(40,"vector4",7),new Lga(56,"vector4",6),new Lga(72,"vector4",5)])}]),La}(),LJa=function(){function La(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lb.VertexPositionNormalTexture0SkinTangent=function(La,Lb,Lc,Ld,Le,Lf,Lg){this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld,this._tangent=Le,this._blendIndex=Lf,this._blendWeight=Lg},Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(84,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15),new Lga(40,"vector4",7),new Lga(56,"vector4",6),new Lga(72,"vector3",5)])}]),La}(),LKa=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld,this._tangent=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(56,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15),new Lga(40,"vector4",5)])}]),La}(),LLa=function(){function La(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Ln(La,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lb.VertexPositionNormalTexture0Tangent=function(La,Lb,Lc,Ld,Le){this._position=La,this._normal=Lb,this._textureCoordinate0=Lc,this._textureCoordinate1=Ld,this._tangent=Le},Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(52,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15),new Lga(40,"vector3",5)])}]),La}(),LMa=function(){function La(La,Lb,Lc,Ld,Le){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc,this._blendIndex=Ld,this._blendWeight=Le}Ln(La,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(64,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector4",7),new Lga(48,"vector4",6)])}]),La}(),LNa=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc,this._tangent=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(80,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector4",7),new Lga(48,"vector4",6),new Lga(64,"vector4",5)])}]),La}(),LOa=function(){function La(La,Lb,Lc,Ld,Le,Lf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc,this._tangent=Ld,this._blendIndex=Le,this._blendWeight=Lf}Ln(La,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(76,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector4",7),new Lga(48,"vector4",6),new Lga(64,"vector3",5)])}]),La}(),LPa=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc,this._tangent=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(48,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector4",5)])}]),La}(),LQa=function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc,this._tangent=Ld}Ln(La,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(44,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector3",5)])}]),La}(),LRa=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc}Ln(La,"laya.d3.graphics.VertexPositionNTBTexture");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(56,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector3",5),new Lga(36,"vector3",4),new Lga(48,"vector2",2)])}]),La}(),LSa=function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=La,this._normal=Lb,this._textureCoordinate0=Ld,this._textureCoordinate1=Le,this._tangent=Lf,Lc=Lc,this._blendIndex=Lg,this._blendWeight=Lh}Ln(La,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"tangent",function(){return this._tangent}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(0,Lb,"textureCoordinate1",function(){return this._textureCoordinate1}),Lo(0,Lb,"blendIndex",function(){return this._blendIndex}),Lo(0,Lb,"blendWeight",function(){return this._blendWeight}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(96,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector3",5),new Lga(36,"vector3",4),new Lga(48,"vector2",2),new Lga(56,"vector2",15),new Lga(64,"vector4",7),new Lga(80,"vector4",6)])}]),La}(),LTa=function(){function La(La,Lb,Lc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=La,this._normal=Lb,this._textureCoordinate=Lc}Ln(La,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"textureCoordinate",function(){return this._textureCoordinate}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(88,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector3",5),new Lga(36,"vector3",4),new Lga(48,"vector2",2),new Lga(56,"vector4",7),new Lga(72,"vector4",6)])}]),La}(),LUa=(function(){function La(La,Lb,Lc,Ld){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=La,this._normal=Lb,this._textureCoord0=Lc,this._textureCoord1=Ld}Ln(La,"laya.d3.graphics.VertexPositionTerrain");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"normal",function(){return this._normal}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoord0",function(){return this._textureCoord0}),Lo(0,Lb,"textureCoord1",function(){return this._textureCoord1}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(40,[new Lga(0,"vector3",0),new Lga(12,"vector3",3),new Lga(24,"vector2",2),new Lga(32,"vector2",15)])}])}(),function(){function La(La,Lb){this._position=null,this._textureCoordinate0=null,this._position=La,this._textureCoordinate0=Lb}Ln(La,"laya.d3.graphics.VertexPositionTexture0");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"position",function(){return this._position}),Lo(0,Lb,"textureCoordinate0",function(){return this._textureCoordinate0}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(20,[new Lga(0,"vector3",0),new Lga(12,"vector2",2)])}]),La}()),LVa=(function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=La,this._positionStartLifeTime=Lb,this._velocity=Lc,this._startColor=Ld,this._startSize=Le,this._startRotation0=Lf,this._startRotation1=Lg,this._startRotation2=Lh,this._startLifeTime=Li,this._time=Lj,this._startSpeed=Lk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Ln}Ln(La,"laya.d3.graphics.VertexShurikenParticleBillboard");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Lo(0,Lb,"random1",function(){return this._randoms1}),Lo(0,Lb,"startRotation2",function(){return this._startRotation2}),Lo(0,Lb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),Lo(0,Lb,"velocity",function(){return this._velocity}),Lo(0,Lb,"random0",function(){return this._randoms0}),Lo(0,Lb,"startSize",function(){return this._startSize}),Lo(0,Lb,"startColor",function(){return this._startColor}),Lo(0,Lb,"startRotation0",function(){return this._startRotation0}),Lo(0,Lb,"startRotation1",function(){return this._startRotation1}),Lo(0,Lb,"startLifeTime",function(){return this._startLifeTime}),Lo(0,Lb,"time",function(){return this._time}),Lo(0,Lb,"startSpeed",function(){return this._startSpeed}),Lo(0,Lb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(152,[new Lga(0,"vector4",17),new Lga(16,"vector4",30),new Lga(32,"vector4",32),new Lga(48,"vector4",19),new Lga(64,"vector3",20),new Lga(76,"vector3",22),new Lga(88,"single",31),new Lga(92,"vector4",34),new Lga(108,"vector4",35),new Lga(124,"vector3",36),new Lga(136,"vector4",37)])}])}(),function(){function La(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=La,this._positionStartLifeTime=Lb,this._velocity=Lc,this._startColor=Ld,this._startSize=Le,this._startRotation0=Lf,this._startRotation1=Lg,this._startRotation2=Lh,this._startLifeTime=Li,this._time=Lj,this._startSpeed=Lk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Ln}Ln(La,"laya.d3.graphics.VertexShurikenParticleMesh");var Lb=La.prototype;Lv.imps(Lb,{"laya.d3.graphics.IVertex":!0}),Lo(0,Lb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Lo(0,Lb,"velocity",function(){return this._velocity}),Lo(0,Lb,"position",function(){return this._positionStartLifeTime}),Lo(0,Lb,"random0",function(){return this._randoms0}),Lo(0,Lb,"startSize",function(){return this._startSize}),Lo(0,Lb,"startColor",function(){return this._startColor}),Lo(0,Lb,"startRotation0",function(){return this._startRotation0}),Lo(0,Lb,"startRotation1",function(){return this._startRotation1}),Lo(0,Lb,"random1",function(){return this._randoms1}),Lo(0,Lb,"startRotation2",function(){return this._startRotation2}),Lo(0,Lb,"startLifeTime",function(){return this._startLifeTime}),Lo(0,Lb,"time",function(){return this._time}),Lo(0,Lb,"startSpeed",function(){return this._startSpeed}),Lo(0,Lb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Lo(0,Lb,"vertexDeclaration",function(){return La._vertexDeclaration}),Lo(1,La,"vertexDeclaration",function(){return La._vertexDeclaration}),Ll(La,["_vertexDeclaration",function(){return this._vertexDeclaration=new Lfa(172,[new Lga(0,"vector3",0),new Lga(12,"vector4",1),new Lga(28,"vector2",2),new Lga(36,"vector4",30),new Lga(52,"vector4",32),new Lga(68,"vector4",19),new Lga(84,"vector3",20),new Lga(96,"vector3",22),new Lga(108,"single",31),new Lga(112,"vector4",34),new Lga(128,"vector4",35),new Lga(144,"vector3",36),new Lga(156,"vector4",37)])}])}(),function(){function Lt(La,Lb,Lc,Ld,Le,Lf){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=Lc,this._materials=Ld,this._subMeshes=Le,this._materialMap=Lf,this._version=Lb,this._onLoaded(La)}Ln(Lt,"laya.d3.loaders.LoadModelV01");var La=Lt.prototype;return La._onLoaded=function(La){this._readData=La,this.READ_BLOCK();for(var Lb=0;Lb<this._BLOCK.count;Lb++){var Lc=this._readData.getUint16(),Ld=this._strings[Lc],Le=this["READ_"+Ld];if(null==Le)throw new Error("model file err,no this function:"+Lc+" "+Ld);if(!Le.call(this))break}return this._mesh},La.onError=function(){},La._readString=function(){return this._strings[this._readData.getUint16()]},La.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},La.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},La.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var La=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Lb=0;Lb<this._STRINGS.size;Lb++)this._strings[Lb]=this._readData.readUTFString();return this._readData.pos=La,!0},La.READ_MATERIAL=function(){var La=this._readData.getUint16(),Lb=(this._readString(),this._readString());return this._materials[La]="null"!==Lb?Lr.getRes(this._materialMap[Lb]):new LEb,!0},La.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var La,Lb=this._readData.__getBuffer(),Lc=0,Ld=this._readData.getUint32(),Le=this._readData.getUint32(),Lf=(new Float32Array(Lb.slice(Ld+this._DATA.offset,Ld+this._DATA.offset+Le)),this._readData.getUint32()),Lg=this._readData.getUint32(),Lh=new Float32Array(Lb.slice(Lf+this._DATA.offset,Lf+this._DATA.offset+Lg));for(this.mesh._inverseBindPoses=[],Lc=0,La=Lh.length;Lc<La;Lc+=16){var Li=new Lab(Lh[Lc+0],Lh[Lc+1],Lh[Lc+2],Lh[Lc+3],Lh[Lc+4],Lh[Lc+5],Lh[Lc+6],Lh[Lc+7],Lh[Lc+8],Lh[Lc+9],Lh[Lc+10],Lh[Lc+11],Lh[Lc+12],Lh[Lc+13],Lh[Lc+14],Lh[Lc+15]);this.mesh._inverseBindPoses.push(Li)}break;default:throw new Error("LoadModel:unknown version.")}return!0},La.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var La=this._readString();this._shaderAttributes=La.match(Lt._attrReg);var Lb=this._readData.getUint32(),Lc=this._readData.getUint32(),Ld=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),Le=this._readData.getUint32(),Lf=this._readData.getUint32(),Lg=this._readData.getUint32(),Lh=this._readData.__getBuffer(),Li=new Ljb(this._mesh),Lj=this._getVertexDeclaration(),Lk=LOb.create(Lj,Le/Lj.vertexStride,35044,!0),Ll=Ld+this._DATA.offset,Lm=Lh.slice(Ll,Ll+Le);Lk.setData(new Float32Array(Lm));for(var Ln=(Li._vertexBuffer=Lk).vertexDeclaration.getVertexElements(),Lo=0;Lo<Ln.length;Lo++)Li._bufferUsage[Ln[Lo].elementUsage]=Lk;var Lp=LNb.create("ushort",Lc/2,35044,!0),Lq=Lb+this._DATA.offset,Lr=Lh.slice(Lq,Lq+Lc);Lp.setData(new Uint16Array(Lr)),Li._indexBuffer=Lp;var Ls=Lh.slice(Lf+this._DATA.offset,Lf+this._DATA.offset+Lg);return Li._boneIndicesList[0]=new Uint8Array(Ls),this._subMeshes.push(Li),!0},La.READ_DATAAREA=function(){return!1},La._getVertexDeclaration=function(){for(var La,Lb=!1,Lc=!1,Ld=!1,Le=!1,Lf=!1,Lg=!1,Lh=!1,Li=!1,Lj=!1,Lk=0;Lk<this._shaderAttributes.length;Lk+=8)switch(this._shaderAttributes[Lk]){case"POSITION":Lb=!0;break;case"NORMAL":Lc=!0;break;case"COLOR":Ld=!0;break;case"UV":Le=!0;break;case"UV1":Lf=!0;break;case"BLENDWEIGHT":Lh=!0;break;case"BLENDINDICES":Li=!0;break;case"TANGENT":Lg=!0;break;case"BINORMAL":Lj=!0}return Lb&&Lc&&Ld&&Le&&Lf&&Lh&&Li&&Lg?La=Lta.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lf&&Lh&&Li?La=Lra.vertexDeclaration:Lb&&Lc&&Le&&Lf&&Lh&&Li&&Lg?La=LJa.vertexDeclaration:Lb&&Lc&&Le&&Lf&&Lh&&Li?La=LHa.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lh&&Li&&Lg?La=LAa.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lh&&Li?La=Lya.vertexDeclaration:Lb&&Lc&&Lg&&Lj&&Le&&Lh&&Li?La=LTa.vertexDeclaration:Lb&&Lc&&Le&&Lh&&Li&&Lg?La=LOa.vertexDeclaration:Lb&&Lc&&Le&&Lh&&Li?La=LMa.vertexDeclaration:Lb&&Lc&&Ld&&Lh&&Li&&Lg?La=Lma.vertexDeclaration:Lb&&Lc&&Ld&&Lh&&Li?La=Lka.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lf&&Lg?La=Lva.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lf?La=Lqa.vertexDeclaration:Lb&&Lc&&Le&&Lf&&Lg?La=LLa.vertexDeclaration:Lb&&Lc&&Le&&Lf?La=LGa.vertexDeclaration:Lb&&Lc&&Ld&&Le&&Lg?La=LCa.vertexDeclaration:Lb&&Lc&&Le&&Lg&&Lj?La=LRa.vertexDeclaration:Lb&&Lc&&Ld&&Le?La=Lpa.vertexDeclaration:Lb&&Lc&&Le&&Lg?La=LQa.vertexDeclaration:Lb&&Lc&&Le?La=LFa.vertexDeclaration:Lb&&Lc&&Ld&&Lg?La=Loa.vertexDeclaration:Lb&&Lc&&Ld&&(La=Lja.vertexDeclaration),La},Lo(0,La,"mesh",function(){return this._mesh}),Lt._attrReg=new RegExp("(\\w+)|([:,;])","g"),Lt}()),LWa=function(){function Lz(){}return Ln(Lz,"laya.d3.loaders.LoadModelV02"),Lz.parse=function(La,Lb,Lc,Ld,Le,Lf){Lz._mesh=Lc,Lz._materials=Ld,Lz._subMeshes=Le,Lz._materialMap=Lf,Lz._version=Lb,Lz._readData=La,Lz.READ_DATA(),Lz.READ_BLOCK(),Lz.READ_STRINGS();for(var Lg=0,Lh=Lz._BLOCK.count;Lg<Lh;Lg++){Lz._readData.pos=Lz._BLOCK.blockStarts[Lg];var Li=Lz._readData.getUint16(),Lj=Lz._strings[Li],Lk=Lz["READ_"+Lj];if(null==Lk)throw new Error("model file err,no this function:"+Li+" "+Lj);Lk.call()}Lz._strings.length=0,Lz._readData=null,Lz._version=null,Lz._mesh=null,Lz._materials=null,Lz._subMeshes=null,Lz._materialMap=null},Lz._readString=function(){return Lz._strings[Lz._readData.getUint16()]},Lz.READ_DATA=function(){Lz._DATA.offset=Lz._readData.getUint32(),Lz._DATA.size=Lz._readData.getUint32()},Lz.READ_BLOCK=function(){for(var La=Lz._BLOCK.count=Lz._readData.getUint16(),Lb=Lz._BLOCK.blockStarts=[],Lc=Lz._BLOCK.blockLengths=[],Ld=0;Ld<La;Ld++)Lb.push(Lz._readData.getUint32()),Lc.push(Lz._readData.getUint32())},Lz.READ_STRINGS=function(){var La=Lz._readData.getUint32(),Lb=Lz._readData.getUint16(),Lc=Lz._readData.pos;Lz._readData.pos=La+Lz._DATA.offset;for(var Ld=0;Ld<Lb;Ld++)Lz._strings[Ld]=Lz._readData.readUTFString();Lz._readData.pos=Lc},Lz.READ_MATERIAL=function(){Lz._readString(),Lz._readString();var La=Lz._readString();return""!==La&&Lz._materials.push(Lr.getRes(Lz._materialMap[La])),!0},Lz.READ_MESH=function(){Lz._readString();var La,Lb=Lz._readData.__getBuffer(),Lc=0,Ld=Lz._readData.getInt16(),Le=Lz._DATA.offset;for(Lc=0;Lc<Ld;Lc++){var Lf=Le+Lz._readData.getUint32(),Lg=Lz._readData.getUint32(),Lh=new Float32Array(Lb.slice(Lf,Lf+Lg)),Li=Lz._readString().match(Lz._attrReg),Lj=Lz._getVertexDeclaration(Li),Lk=LOb.create(Lj,4*Lh.length/Lj.vertexStride,35044,!0);Lk.setData(Lh),Lz._mesh._vertexBuffers.push(Lk)}var Ll=Le+Lz._readData.getUint32(),Lm=Lz._readData.getUint32(),Ln=new Uint16Array(Lb.slice(Ll,Ll+Lm)),Lo=LNb.create("ushort",Lm/2,35044,!0);Lo.setData(Ln),Lz._mesh._indexBuffer=Lo;var Lp=Lz._mesh._boneNames=[],Lq=Lz._readData.getUint16();for(Lp.length=Lq,Lc=0;Lc<Lq;Lc++)Lp[Lc]=Lz._strings[Lz._readData.getUint16()];var Lr=Lz._readData.getUint32(),Ls=Lz._readData.getUint32(),Lt=(new Float32Array(Lb.slice(Le+Lr,Le+Lr+Ls)),Lz._readData.getUint32()),Lu=Lz._readData.getUint32(),Lv=new Float32Array(Lb.slice(Le+Lt,Le+Lt+Lu));for(Lz._mesh._inverseBindPoses=[],Lc=0,La=Lv.length;Lc<La;Lc+=16){var Ly=new Lab(Lv[Lc+0],Lv[Lc+1],Lv[Lc+2],Lv[Lc+3],Lv[Lc+4],Lv[Lc+5],Lv[Lc+6],Lv[Lc+7],Lv[Lc+8],Lv[Lc+9],Lv[Lc+10],Lv[Lc+11],Lv[Lc+12],Lv[Lc+13],Lv[Lc+14],Lv[Lc+15]);Lz._mesh._inverseBindPoses.push(Ly)}return Lz._mesh._skinnedDatas=new Float32Array(16*Lv.length),!0},Lz.READ_SUBMESH=function(){var La=Lz._readData.__getBuffer(),Lb=new Ljb(Lz._mesh),Lc=Lz._readData.getInt16(),Ld=Lz._readData.getUint32(),Le=Lz._readData.getUint32();Lb._vertexBuffer=Lz._mesh._vertexBuffers[Lc],Lb._vertexStart=Ld,Lb._vertexCount=Le;var Lf=Lz._readData.getUint32(),Lg=Lz._readData.getUint32(),Lh=Lz._mesh._indexBuffer;Lb._indexBuffer=Lh,Lb._indexStart=Lf,Lb._indexCount=Lg,Lb._indices=new Uint16Array(Lh.getData().buffer,2*Lf,Lg);var Li=Lz._DATA.offset,Lj=Lb._subIndexBufferStart,Lk=Lb._subIndexBufferCount,Ll=Lb._boneIndicesList,Lm=Lz._readData.getUint16();Lj.length=Lm,Lk.length=Lm,Ll.length=Lm;for(var Ln=0;Ln<Lm;Ln++){Lj[Ln]=Lz._readData.getUint32(),Lk[Ln]=Lz._readData.getUint32();var Lo=Lz._readData.getUint32(),Lp=Lz._readData.getUint32();Lb._boneIndicesList[Ln]=new Uint8Array(La.slice(Li+Lo,Li+Lo+Lp))}return Lz._subMeshes.push(Lb),!0},Lz._getVertexDeclaration=function(La){for(var Lb,Lc=!1,Ld=!1,Le=!1,Lf=!1,Lg=!1,Lh=!1,Li=!1,Lj=!1,Lk=!1,Ll=0;Ll<La.length;Ll++)switch(La[Ll]){case"POSITION":Lc=!0;break;case"NORMAL":Ld=!0;break;case"COLOR":Le=!0;break;case"UV":Lf=!0;break;case"UV1":Lg=!0;break;case"BLENDWEIGHT":Li=!0;break;case"BLENDINDICES":Lj=!0;break;case"TANGENT":Lh=!0;break;case"BINORMAL":Lk=!0}return Lc&&Ld&&Le&&Lf&&Lg&&Li&&Lj&&Lh?Lb=Lta.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Lg&&Li&&Lj?Lb=Lra.vertexDeclaration:Lc&&Ld&&Lf&&Lg&&Li&&Lj&&Lh?Lb=LJa.vertexDeclaration:Lc&&Ld&&Lf&&Lg&&Li&&Lj?Lb=LHa.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Li&&Lj&&Lh?Lb=LAa.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Li&&Lj?Lb=Lya.vertexDeclaration:Lc&&Ld&&Lf&&Li&&Lj&&Lh?Lb=LOa.vertexDeclaration:Lc&&Ld&&Lf&&Li&&Lj?Lb=LMa.vertexDeclaration:Lc&&Ld&&Le&&Li&&Lj&&Lh?Lb=Lma.vertexDeclaration:Lc&&Ld&&Le&&Li&&Lj?Lb=Lka.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Lg&&Lh?Lb=Lva.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Lg?Lb=Lqa.vertexDeclaration:Lc&&Ld&&Lf&&Lg&&Lh?Lb=LLa.vertexDeclaration:Lc&&Ld&&Lf&&Lg?Lb=LGa.vertexDeclaration:Lc&&Ld&&Le&&Lf&&Lh?Lb=LCa.vertexDeclaration:Lc&&Ld&&Lf&&Lh&&Lk?Lb=LRa.vertexDeclaration:Lc&&Ld&&Le&&Lf?Lb=Lpa.vertexDeclaration:Lc&&Ld&&Lf&&Lh?Lb=LQa.vertexDeclaration:Lc&&Ld&&Lf?Lb=LFa.vertexDeclaration:Lc&&Ld&&Le&&Lh?Lb=Loa.vertexDeclaration:Lc&&Ld&&Le&&(Lb=Lja.vertexDeclaration),Lb},Lz._attrReg=new RegExp("(\\w+)|([:,;])","g"),Lz._strings=[],Lz._readData=null,Lz._version=null,Lz._mesh=null,Lz._materials=null,Lz._subMeshes=null,Lz._materialMap=null,Ll(Lz,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Lz}(),LXa=function(){function Ly(){}return Ln(Ly,"laya.d3.loaders.LoadModelV03"),Ly.parse=function(La,Lb,Lc,Ld,Le){Ly._mesh=Lc,Ly._subMeshes=Ld,Ly._materialMap=Le,Ly._version=Lb,Ly._readData=La,Ly.READ_DATA(),Ly.READ_BLOCK(),Ly.READ_STRINGS();for(var Lf=0,Lg=Ly._BLOCK.count;Lf<Lg;Lf++){Ly._readData.pos=Ly._BLOCK.blockStarts[Lf];var Lh=Ly._readData.getUint16(),Li=Ly._strings[Lh],Lj=Ly["READ_"+Li];if(null==Lj)throw new Error("model file err,no this function:"+Lh+" "+Li);Lj.call()}Ly._strings.length=0,Ly._readData=null,Ly._version=null,Ly._mesh=null,Ly._subMeshes=null,Ly._materialMap=null},Ly._readString=function(){return Ly._strings[Ly._readData.getUint16()]},Ly.READ_DATA=function(){Ly._DATA.offset=Ly._readData.getUint32(),Ly._DATA.size=Ly._readData.getUint32()},Ly.READ_BLOCK=function(){for(var La=Ly._BLOCK.count=Ly._readData.getUint16(),Lb=Ly._BLOCK.blockStarts=[],Lc=Ly._BLOCK.blockLengths=[],Ld=0;Ld<La;Ld++)Lb.push(Ly._readData.getUint32()),Lc.push(Ly._readData.getUint32())},Ly.READ_STRINGS=function(){var La=Ly._readData.getUint32(),Lb=Ly._readData.getUint16(),Lc=Ly._readData.pos;Ly._readData.pos=La+Ly._DATA.offset;for(var Ld=0;Ld<Lb;Ld++)Ly._strings[Ld]=Ly._readData.readUTFString();Ly._readData.pos=Lc},Ly.READ_MESH=function(){var La,Lb=Ly._readString(),Lc=Ly._readData.__getBuffer(),Ld=0,Le=Ly._readData.getInt16(),Lf=Ly._DATA.offset;for(Ld=0;Ld<Le;Ld++){var Lg,Lh=Lf+Ly._readData.getUint32(),Li=Ly._readData.getUint32(),Lj=new Float32Array(Lc.slice(Lh,Lh+Li)),Lk=Ly._readString();switch(Ly._version){case"LAYAMODEL:03":Lg=Ly._vertexDeclarationMap_Discard[Lk];break;case"LAYAMODEL:0301":Lg=Ly._vertexDeclarationMap[Lk];break;default:throw new Error("LoadModelV03: unknown version.")}if(!Lg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+Ly._version+"  bufferAttribute="+Lk+"  name="+Lb+"  url="+(Ly._mesh?Ly._mesh.url:"null"));var Ll=LOb.create(Lg,4*Lj.length/Lg.vertexStride,35044,!0,Ly._mesh._url+"_"+Ld);Ll.setData(Lj),Ly._mesh._vertexBuffers.push(Ll)}var Lm=Lf+Ly._readData.getUint32(),Ln=Ly._readData.getUint32(),Lo=new Uint16Array(Lc.slice(Lm,Lm+Ln)),Lp=LNb.create("ushort",Ln/2,35044,!0,Ly._mesh._url);Lp.setData(Lo),Ly._mesh._indexBuffer=Lp;var Lq=Ly._mesh._boneNames=[],Lr=Ly._readData.getUint16();for(Lq.length=Lr,Ld=0;Ld<Lr;Ld++)Lq[Ld]=Ly._strings[Ly._readData.getUint16()];Ly._readData.pos+=8;var Ls=Ly._readData.getUint32(),Lt=Ly._readData.getUint32(),Lu=new Float32Array(Lc.slice(Lf+Ls,Lf+Ls+Lt));for(Ly._mesh._inverseBindPoses=[],Ld=0,La=Lu.length;Ld<La;Ld+=16){var Lv=new Lab(Lu[Ld+0],Lu[Ld+1],Lu[Ld+2],Lu[Ld+3],Lu[Ld+4],Lu[Ld+5],Lu[Ld+6],Lu[Ld+7],Lu[Ld+8],Lu[Ld+9],Lu[Ld+10],Lu[Ld+11],Lu[Ld+12],Lu[Ld+13],Lu[Ld+14],Lu[Ld+15]);Ly._mesh._inverseBindPoses.push(Lv)}return Ly._mesh._skinnedDatas=new Float32Array(16*Lu.length),!0},Ly.READ_SUBMESH=function(){var La=Ly._readData.__getBuffer(),Lb=new Ljb(Ly._mesh),Lc=Ly._readData.getInt16(),Ld=Ly._readData.getUint32(),Le=Ly._readData.getUint32();Lb._vertexBuffer=Ly._mesh._vertexBuffers[Lc],Lb._vertexStart=Ld,Lb._vertexCount=Le;var Lf=Ly._readData.getUint32(),Lg=Ly._readData.getUint32(),Lh=Ly._mesh._indexBuffer;Lb._indexBuffer=Lh,Lb._indexStart=Lf,Lb._indexCount=Lg,Lb._indices=new Uint16Array(Lh.getData().buffer,2*Lf,Lg);var Li=Ly._DATA.offset,Lj=Lb._subIndexBufferStart,Lk=Lb._subIndexBufferCount,Ll=Lb._boneIndicesList,Lm=Ly._readData.getUint16();Lj.length=Lm,Lk.length=Lm,Ll.length=Lm;for(var Ln=0;Ln<Lm;Ln++){Lj[Ln]=Ly._readData.getUint32(),Lk[Ln]=Ly._readData.getUint32();var Lo=Ly._readData.getUint32(),Lp=Ly._readData.getUint32();Ll[Ln]=new Uint8Array(La.slice(Li+Lo,Li+Lo+Lp))}return Ly._subMeshes.push(Lb),!0},Ly._strings=[],Ly._readData=null,Ly._version=null,Ly._mesh=null,Ly._subMeshes=null,Ly._materialMap=null,Ll(Ly,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Lta.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Lra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":LSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":LJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":LHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":LAa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Lya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":LOa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":LMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Lma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Lka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Lva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Lqa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":LLa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":LGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":LCa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":LRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Lpa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":LQa.vertexDeclaration,"POSITION,NORMAL,UV":LFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Loa.vertexDeclaration,"POSITION,NORMAL,COLOR":Lja.vertexDeclaration,"POSITION,NORMAL,TANGENT":LEa.vertexDeclaration,"POSITION,NORMAL":Lia.vertexDeclaration,"POSITION,UV":LUa.vertexDeclaration,POSITION:Lha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Lsa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Lra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":LSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":LIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":LHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Lza.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Lya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":LNa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":LMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Lla.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Lka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Lua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Lqa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":LKa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":LGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":LBa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":LRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Lpa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":LPa.vertexDeclaration,"POSITION,NORMAL,UV":LFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Lna.vertexDeclaration,"POSITION,NORMAL,COLOR":Lja.vertexDeclaration,"POSITION,NORMAL,TANGENT":LDa.vertexDeclaration,"POSITION,NORMAL":Lia.vertexDeclaration,"POSITION,UV":LUa.vertexDeclaration,POSITION:Lha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Ly}(),LYa=function(){function Lh(){}return Ln(Lh,"laya.d3.loaders.MeshReader"),Lh.read=function(La,Lb,Lc,Ld,Le){var Lf=new Ly(La);Lf.pos=0;var Lg=Lf.readUTFString();switch(Lg){case"LAYAMODEL:01":case"LAYASKINANI:01":Lh._readVersion01(Lf,Lg,Lb,Lc,Ld,Le);break;case"LAYAMODEL:02":LWa.parse(Lf,Lg,Lb,Lc,Ld,Le);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":LXa.parse(Lf,Lg,Lb,Ld,Le);break;default:throw new Error("MeshReader: unknown mesh version.")}Lb._setSubMeshes(Ld)},Lh._readVersion01=function(La,Lb,Lc,Ld,Le,Lf){new LVa(La,Lb,Lc,Ld,Le,Lf)},Lh}(),LZa=function(){function La(La,Lb){this.min=null,this.max=null,this.min=La,this.max=Lb}Ln(La,"laya.d3.math.BoundBox");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.getCorners=function(La){La.length=8;var Lb=this.min.elements,Lc=this.max.elements,Ld=Lb[0],Le=Lb[1],Lf=Lb[2],Lg=Lc[0],Lh=Lc[1],Li=Lc[2];La[0]=new Lgb(Ld,Lh,Li),La[1]=new Lgb(Lg,Lh,Li),La[2]=new Lgb(Lg,Le,Li),La[3]=new Lgb(Ld,Le,Li),La[4]=new Lgb(Ld,Lh,Lf),La[5]=new Lgb(Lg,Lh,Lf),La[6]=new Lgb(Lg,Le,Lf),La[7]=new Lgb(Ld,Le,Lf)},Lb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Lb.cloneTo=function(La){var Lb=La;this.min.cloneTo(Lb.min),this.max.cloneTo(Lb.max)},Lb.clone=function(){var La=new this.constructor(new Lgb,new Lgb);return this.cloneTo(La),La},La.createfromPoints=function(La,Lb){if(null==La)throw new Error("points");var Lc=Lb.min,Ld=Lb.max,Le=Lc.elements;Le[0]=Number.MAX_VALUE,Le[1]=Number.MAX_VALUE,Le[2]=Number.MAX_VALUE;var Lf=Ld.elements;Lf[0]=-Number.MAX_VALUE,Lf[1]=-Number.MAX_VALUE,Lf[2]=-Number.MAX_VALUE;for(var Lg=0,Lh=La.length;Lg<Lh;++Lg)Lgb.min(Lc,La[Lg],Lc),Lgb.max(Ld,La[Lg],Ld)},La.merge=function(La,Lb,Lc){Lgb.min(La.min,Lb.min,Lc.min),Lgb.max(La.max,Lb.max,Lc.max)},La}(),L$a=function(){function Lj(La){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=La,this._near=new Lbb(new Lgb),this._far=new Lbb(new Lgb),this._left=new Lbb(new Lgb),this._right=new Lbb(new Lgb),this._top=new Lbb(new Lgb),this._bottom=new Lbb(new Lgb),Lj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Ln(Lj,"laya.d3.math.BoundFrustum");var La=Lj.prototype;return La.equalsBoundFrustum=function(La){return this._matrix.equalsOtherMatrix(La.matrix)},La.equalsObj=function(La){if(La instanceof laya.d3.math.BoundFrustum){var Lb=La;return this.equalsBoundFrustum(Lb)}return!1},La.getPlane=function(La){switch(La){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},La.getCorners=function(La){Lj._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(La[0]),Lj._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(La[1]),Lj._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(La[2]),Lj._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(La[3]),Lj._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(La[4]),Lj._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(La[5]),Lj._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(La[6]),Lj._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(La[7])},La.containsPoint=function(La){for(var Lb=Lbb.PlaneIntersectionType_Front,Lc=Lbb.PlaneIntersectionType_Front,Ld=0;Ld<6;Ld++){switch(Ld){case 0:Lc=Collision.intersectsPlaneAndPoint(this._near,La);break;case 1:Lc=Collision.intersectsPlaneAndPoint(this._far,La);break;case 2:Lc=Collision.intersectsPlaneAndPoint(this._left,La);break;case 3:Lc=Collision.intersectsPlaneAndPoint(this._right,La);break;case 4:Lc=Collision.intersectsPlaneAndPoint(this._top,La);break;case 5:Lc=Collision.intersectsPlaneAndPoint(this._bottom,La)}switch(Lc){case Lbb.PlaneIntersectionType_Back:return 0;case Lbb.PlaneIntersectionType_Intersecting:Lb=Lbb.PlaneIntersectionType_Intersecting}}switch(Lb){case Lbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},La.containsBoundBox=function(La){for(var Lb,Lc=Lj._tempV30,Ld=Lj._tempV31,Le=1,Lf=0;Lf<6;Lf++){if(Lb=this.getPlane(Lf),this._getBoxToPlanePVertexNVertex(La,Lb.normal,Lc,Ld),Collision.intersectsPlaneAndPoint(Lb,Lc)===Lbb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Lb,Ld)===Lbb.PlaneIntersectionType_Back&&(Le=2)}return Le},La.containsBoundSphere=function(La){for(var Lb=Lbb.PlaneIntersectionType_Front,Lc=Lbb.PlaneIntersectionType_Front,Ld=0;Ld<6;Ld++){switch(Ld){case 0:Lc=Collision.intersectsPlaneAndSphere(this._near,La);break;case 1:Lc=Collision.intersectsPlaneAndSphere(this._far,La);break;case 2:Lc=Collision.intersectsPlaneAndSphere(this._left,La);break;case 3:Lc=Collision.intersectsPlaneAndSphere(this._right,La);break;case 4:Lc=Collision.intersectsPlaneAndSphere(this._top,La);break;case 5:Lc=Collision.intersectsPlaneAndSphere(this._bottom,La)}switch(Lc){case Lbb.PlaneIntersectionType_Back:return 0;case Lbb.PlaneIntersectionType_Intersecting:Lb=Lbb.PlaneIntersectionType_Intersecting}}switch(Lb){case Lbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},La._getBoxToPlanePVertexNVertex=function(La,Lb,Lc,Ld){var Le=La.min,Lf=Le.elements,Lg=La.max,Lh=Lg.elements,Li=Lb.elements,Lj=Li[0],Lk=Li[1],Ll=Li[2];Le.cloneTo(Lc);var Lm=Lc.elements;0<=Lj&&(Lm[0]=Lh[0]),0<=Lk&&(Lm[1]=Lh[1]),0<=Ll&&(Lm[2]=Lh[2]),Lg.cloneTo(Ld);var Ln=Ld.elements;0<=Lj&&(Ln[0]=Lf[0]),0<=Lk&&(Ln[1]=Lf[1]),0<=Ll&&(Ln[2]=Lf[2])},Lo(0,La,"top",function(){return this._top}),Lo(0,La,"matrix",function(){return this._matrix},function(La){this._matrix=La,Lj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),Lo(0,La,"near",function(){return this._near}),Lo(0,La,"far",function(){return this._far}),Lo(0,La,"left",function(){return this._left}),Lo(0,La,"right",function(){return this._right}),Lo(0,La,"bottom",function(){return this._bottom}),Lj._getPlanesFromMatrix=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh=La.elements,Li=Lh[0],Lj=Lh[1],Lk=Lh[2],Ll=Lh[3],Lm=Lh[4],Ln=Lh[5],Lo=Lh[6],Lp=Lh[7],Lq=Lh[8],Lr=Lh[9],Ls=Lh[10],Lt=Lh[11],Lu=Lh[12],Lv=Lh[13],Ly=Lh[14],Lz=Lh[15],LA=Lb.normal.elements;LA[0]=Ll+Lk,LA[1]=Lp+Lo,LA[2]=Lt+Ls,Lb.distance=Lz+Ly,Lb.normalize();var LB=Lc.normal.elements;LB[0]=Ll-Lk,LB[1]=Lp-Lo,LB[2]=Lt-Ls,Lc.distance=Lz-Ly,Lc.normalize();var LC=Ld.normal.elements;LC[0]=Ll+Li,LC[1]=Lp+Lm,LC[2]=Lt+Lq,Ld.distance=Lz+Lu,Ld.normalize();var LD=Le.normal.elements;LD[0]=Ll-Li,LD[1]=Lp-Lm,LD[2]=Lt-Lq,Le.distance=Lz-Lu,Le.normalize();var LE=Lf.normal.elements;LE[0]=Ll-Lj,LE[1]=Lp-Ln,LE[2]=Lt-Lr,Lf.distance=Lz-Lv,Lf.normalize();var LF=Lg.normal.elements;LF[0]=Ll+Lj,LF[1]=Lp+Ln,LF[2]=Lt+Lr,Lg.distance=Lz+Lv,Lg.normalize()},Lj._get3PlaneInterPoint=function(La,Lb,Lc){var Ld=La.normal,Le=Lb.normal,Lf=Lc.normal;Lgb.cross(Le,Lf,Lj._tempV30),Lgb.cross(Lf,Ld,Lj._tempV31),Lgb.cross(Ld,Le,Lj._tempV32);var Lg=Lgb.dot(Ld,Lj._tempV30),Lh=Lgb.dot(Le,Lj._tempV31),Li=Lgb.dot(Lf,Lj._tempV32);return Lgb.scale(Lj._tempV30,-La.distance/Lg,Lj._tempV33),Lgb.scale(Lj._tempV31,-Lb.distance/Lh,Lj._tempV34),Lgb.scale(Lj._tempV32,-Lc.distance/Li,Lj._tempV35),Lgb.add(Lj._tempV33,Lj._tempV34,Lj._tempV36),Lgb.add(Lj._tempV35,Lj._tempV36,Lj._tempV37),Lj._tempV37},Ll(Lj,["_tempV30",function(){return this._tempV30=new Lgb},"_tempV31",function(){return this._tempV31=new Lgb},"_tempV32",function(){return this._tempV32=new Lgb},"_tempV33",function(){return this._tempV33=new Lgb},"_tempV34",function(){return this._tempV34=new Lgb},"_tempV35",function(){return this._tempV35=new Lgb},"_tempV36",function(){return this._tempV36=new Lgb},"_tempV37",function(){return this._tempV37=new Lgb}]),Lj}(),L_a=function(){function Lk(La,Lb){this.center=null,this.radius=NaN,this.center=La,this.radius=Lb}Ln(Lk,"laya.d3.math.BoundSphere");var La=Lk.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.toDefault=function(){this.center.toDefault(),this.radius=0},La.intersectsRayDistance=function(La){return Collision.intersectsRayAndSphereRD(La,this)},La.intersectsRayPoint=function(La,Lb){return Collision.intersectsRayAndSphereRP(La,this,Lb)},La.cloneTo=function(La){var Lb=La;this.center.cloneTo(Lb.center),Lb.radius=this.radius},La.clone=function(){var La=new this.constructor(new Lgb,new Lgb);return this.cloneTo(La),La},Lk.createFromSubPoints=function(La,Lb,Lc,Ld){if(null==La)throw new Error("points");if(Lb<0||Lb>=La.length)throw new Error("start"+Lb+"Must be in the range [0, "+(La.length-1)+"]");if(Lc<0||Lb+Lc>La.length)throw new Error("count"+Lc+"Must be in the range <= "+La.length+"}");var Le=Lb+Lc,Lf=Lk._tempVector3;Lf.elements[0]=0,Lf.elements[1]=0,Lf.elements[2]=0;for(var Lg=Lb;Lg<Le;++Lg)Lgb.add(La[Lg],Lf,Lf);var Lh=Ld.center;Lgb.scale(Lf,1/Lc,Lh);var Li=0;for(Lg=Lb;Lg<Le;++Lg){var Lj=Lgb.distanceSquared(Lh,La[Lg]);Li<Lj&&(Li=Lj)}Ld.radius=Math.sqrt(Li)},Lk.createfromPoints=function(La,Lb){if(null==La)throw new Error("points");Lk.createFromSubPoints(La,0,La.length,Lb)},Ll(Lk,["_tempVector3",function(){return this._tempVector3=new Lgb}]),Lk}(),Lwa=(function(){function La(){}Ln(La,"laya.d3.math.ContainmentType"),La.Disjoint=0,La.Contains=1,La.Intersects=2}(),function(){function Lc(){}return Ln(Lc,"laya.d3.math.MathUtils3D"),Lc.isZero=function(La){return Math.abs(La)<Lc.zeroTolerance},Lc.nearEqual=function(La,Lb){return!!Lc.isZero(La-Lb)},Lc.fastInvSqrt=function(La){return Lc.isZero(La)?La:1/Math.sqrt(La)},Ll(Lc,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),Lc}()),Lxa=function(){function Li(){var La=this.elements=new Float32Array(9);La[0]=1,La[1]=0,La[2]=0,La[3]=0,La[4]=1,La[5]=0,La[6]=0,La[7]=0,La[8]=1}Ln(Li,"laya.d3.math.Matrix3x3");var La=Li.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.determinant=function(){var La=this.elements,Lb=La[0],Lc=La[1],Ld=La[2],Le=La[3],Lf=La[4],Lg=La[5],Lh=La[6],Li=La[7],Lj=La[8];return Lb*(Lj*Lf-Lg*Li)+Lc*(-Lj*Le+Lg*Lh)+Ld*(Li*Le-Lf*Lh)},La.translate=function(La,Lb){var Lc=Lb.elements,Ld=this.elements,Le=La.elements,Lf=Ld[0],Lg=Ld[1],Lh=Ld[2],Li=Ld[3],Lj=Ld[4],Lk=Ld[5],Ll=Ld[6],Lm=Ld[7],Ln=Ld[8],Lo=Le[0],Lp=Le[1];Lc[0]=Lf,Lc[1]=Lg,Lc[2]=Lh,Lc[3]=Li,Lc[4]=Lj,Lc[5]=Lk,Lc[6]=Lo*Lf+Lp*Li+Ll,Lc[7]=Lo*Lg+Lp*Lj+Lm,Lc[8]=Lo*Lh+Lp*Lk+Ln},La.rotate=function(La,Lb){var Lc=Lb.elements,Ld=this.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Ld[4],Lj=Ld[5],Lk=Ld[6],Ll=Ld[7],Lm=Ld[8],Ln=Math.sin(La),Lo=Math.cos(La);Lc[0]=Lo*Le+Ln*Lh,Lc[1]=Lo*Lf+Ln*Li,Lc[2]=Lo*Lg+Ln*Lj,Lc[3]=Lo*Lh-Ln*Le,Lc[4]=Lo*Li-Ln*Lf,Lc[5]=Lo*Lj-Ln*Lg,Lc[6]=Lk,Lc[7]=Ll,Lc[8]=Lm},La.scale=function(La,Lb){var Lc=Lb.elements,Ld=this.elements,Le=La.elements,Lf=Le[0],Lg=Le[1];Lc[0]=Lf*Ld[0],Lc[1]=Lf*Ld[1],Lc[2]=Lf*Ld[2],Lc[3]=Lg*Ld[3],Lc[4]=Lg*Ld[4],Lc[5]=Lg*Ld[5],Lc[6]=Ld[6],Lc[7]=Ld[7],Lc[8]=Ld[8]},La.invert=function(La){var Lb=La.elements,Lc=this.elements,Ld=Lc[0],Le=Lc[1],Lf=Lc[2],Lg=Lc[3],Lh=Lc[4],Li=Lc[5],Lj=Lc[6],Lk=Lc[7],Ll=Lc[8],Lm=Ll*Lh-Li*Lk,Ln=-Ll*Lg+Li*Lj,Lo=Lk*Lg-Lh*Lj,Lp=Ld*Lm+Le*Ln+Lf*Lo;Lp||(La=null),Lp=1/Lp,Lb[0]=Lm*Lp,Lb[1]=(-Ll*Le+Lf*Lk)*Lp,Lb[2]=(Li*Le-Lf*Lh)*Lp,Lb[3]=Ln*Lp,Lb[4]=(Ll*Ld-Lf*Lj)*Lp,Lb[5]=(-Li*Ld+Lf*Lg)*Lp,Lb[6]=Lo*Lp,Lb[7]=(-Lk*Ld+Le*Lj)*Lp,Lb[8]=(Lh*Ld-Le*Lg)*Lp},La.transpose=function(La){var Lb=La.elements,Lc=this.elements;if(La===this){var Ld=Lc[1],Le=Lc[2],Lf=Lc[5];Lb[1]=Lc[3],Lb[2]=Lc[6],Lb[3]=Ld,Lb[5]=Lc[7],Lb[6]=Le,Lb[7]=Lf}else Lb[0]=Lc[0],Lb[1]=Lc[3],Lb[2]=Lc[6],Lb[3]=Lc[1],Lb[4]=Lc[4],Lb[5]=Lc[7],Lb[6]=Lc[2],Lb[7]=Lc[5],Lb[8]=Lc[8]},La.identity=function(){var La=this.elements;La[0]=1,La[1]=0,La[2]=0,La[3]=0,La[4]=1,La[5]=0,La[6]=0,La[7]=0,La[8]=1},La.cloneTo=function(La){var Lb,Lc,Ld;if((Lc=this.elements)!==(Ld=La.elements))for(Lb=0;Lb<9;++Lb)Ld[Lb]=Lc[Lb]},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Li.createFromTranslation=function(La,Lb){Lb.elements;var Lc=La.elements;Lb[0]=1,Lb[1]=0,Lb[2]=0,Lb[3]=0,Lb[4]=1,Lb[5]=0,Lb[6]=Lc[0],Lb[7]=Lc[1],Lb[8]=1},Li.createFromRotation=function(La,Lb){var Lc=Lb.elements,Ld=Math.sin(La),Le=Math.cos(La);Lc[0]=Le,Lc[1]=Ld,Lc[2]=0,Lc[3]=-Ld,Lc[4]=Le,Lc[5]=0,Lc[6]=0,Lc[7]=0,Lc[8]=1},Li.createFromScaling=function(La,Lb){var Lc=Lb.elements,Ld=La.elements;Lc[0]=Ld[0],Lc[1]=0,Lc[2]=0,Lc[3]=0,Lc[4]=Ld[1],Lc[5]=0,Lc[6]=0,Lc[7]=0,Lc[8]=1},Li.createFromMatrix4x4=function(La,Lb){Lb[0]=La[0],Lb[1]=La[1],Lb[2]=La[2],Lb[3]=La[4],Lb[4]=La[5],Lb[5]=La[6],Lb[6]=La[8],Lb[7]=La[9],Lb[8]=La[10]},Li.multiply=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements,Lg=Le[0],Lh=Le[1],Li=Le[2],Lj=Le[3],Lk=Le[4],Ll=Le[5],Lm=Le[6],Ln=Le[7],Lo=Le[8],Lp=Lf[0],Lq=Lf[1],Lr=Lf[2],Ls=Lf[3],Lt=Lf[4],Lu=Lf[5],Lv=Lf[6],Ly=Lf[7],Lz=Lf[8];Ld[0]=Lp*Lg+Lq*Lj+Lr*Lm,Ld[1]=Lp*Lh+Lq*Lk+Lr*Ln,Ld[2]=Lp*Li+Lq*Ll+Lr*Lo,Ld[3]=Ls*Lg+Lt*Lj+Lu*Lm,Ld[4]=Ls*Lh+Lt*Lk+Lu*Ln,Ld[5]=Ls*Li+Lt*Ll+Lu*Lo,Ld[6]=Lv*Lg+Ly*Lj+Lz*Lm,Ld[7]=Lv*Lh+Ly*Lk+Lz*Ln,Ld[8]=Lv*Li+Ly*Ll+Lz*Lo},Li.lookAt=function(La,Lb,Lc,Ld){Lgb.subtract(La,Lb,Li._tempV30),Lgb.normalize(Li._tempV30,Li._tempV30),Lgb.cross(Lc,Li._tempV30,Li._tempV31),Lgb.normalize(Li._tempV31,Li._tempV31),Lgb.cross(Li._tempV30,Li._tempV31,Li._tempV32);var Le=Li._tempV30.elements,Lf=Li._tempV31.elements,Lg=Li._tempV32.elements,Lh=Ld.elements;Lh[0]=Lf[0],Lh[3]=Lf[1],Lh[6]=Lf[2],Lh[1]=Lg[0],Lh[4]=Lg[1],Lh[7]=Lg[2],Lh[2]=Le[0],Lh[5]=Le[1],Lh[8]=Le[2]},Li.DEFAULT=new Li,Ll(Li,["_tempV30",function(){return this._tempV30=new Lgb},"_tempV31",function(){return this._tempV31=new Lgb},"_tempV32",function(){return this._tempV32=new Lgb}]),Li}(),Lab=function(){function LB(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln,Lo,Lp){void 0===La&&(La=1),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lf&&(Lf=1),void 0===Lg&&(Lg=0),void 0===Lh&&(Lh=0),void 0===Li&&(Li=0),void 0===Lj&&(Lj=0),void 0===Lk&&(Lk=1),void 0===Ll&&(Ll=0),void 0===Lm&&(Lm=0),void 0===Ln&&(Ln=0),void 0===Lo&&(Lo=0),void 0===Lp&&(Lp=1);var Lq=this.elements=new Float32Array(16);Lq[0]=La,Lq[1]=Lb,Lq[2]=Lc,Lq[3]=Ld,Lq[4]=Le,Lq[5]=Lf,Lq[6]=Lg,Lq[7]=Lh,Lq[8]=Li,Lq[9]=Lj,Lq[10]=Lk,Lq[11]=Ll,Lq[12]=Lm,Lq[13]=Ln,Lq[14]=Lo,Lq[15]=Lp}Ln(LB,"laya.d3.math.Matrix4x4");var La=LB.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.getElementByRowColumn=function(La,Lb){if(La<0||3<La)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Lb<0||3<Lb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*La+Lb]},La.setElementByRowColumn=function(La,Lb,Lc){if(La<0||3<La)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Lb<0||3<Lb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*La+Lb]=Lc},La.equalsOtherMatrix=function(La){var Lb=this.elements,Lc=La.elements;return Lwa.nearEqual(Lb[0],Lc[0])&&Lwa.nearEqual(Lb[1],Lc[1])&&Lwa.nearEqual(Lb[2],Lc[2])&&Lwa.nearEqual(Lb[3],Lc[3])&&Lwa.nearEqual(Lb[4],Lc[4])&&Lwa.nearEqual(Lb[5],Lc[5])&&Lwa.nearEqual(Lb[6],Lc[6])&&Lwa.nearEqual(Lb[7],Lc[7])&&Lwa.nearEqual(Lb[8],Lc[8])&&Lwa.nearEqual(Lb[9],Lc[9])&&Lwa.nearEqual(Lb[10],Lc[10])&&Lwa.nearEqual(Lb[11],Lc[11])&&Lwa.nearEqual(Lb[12],Lc[12])&&Lwa.nearEqual(Lb[13],Lc[13])&&Lwa.nearEqual(Lb[14],Lc[14])&&Lwa.nearEqual(Lb[15],Lc[15])},La.decomposeTransRotScale=function(La,Lb,Lc){var Ld=LB._tempMatrix4x4;return this.decomposeTransRotMatScale(La,Ld,Lc)?(Lcb.createFromMatrix4x4(Ld,Lb),!0):(Lb.identity(),!1)},La.decomposeTransRotMatScale=function(La,Lb,Lc){var Ld=this.elements,Le=La.elements,Lf=Lb.elements,Lg=Lc.elements;Le[0]=Ld[12],Le[1]=Ld[13],Le[2]=Ld[14];var Lh=Ld[0],Li=Ld[1],Lj=Ld[2],Lk=Ld[4],Ll=Ld[5],Lm=Ld[6],Ln=Ld[8],Lo=Ld[9],Lp=Ld[10],Lq=Lg[0]=Math.sqrt(Lh*Lh+Li*Li+Lj*Lj),Lr=Lg[1]=Math.sqrt(Lk*Lk+Ll*Ll+Lm*Lm),Ls=Lg[2]=Math.sqrt(Ln*Ln+Lo*Lo+Lp*Lp);if(Lwa.isZero(Lq)||Lwa.isZero(Lr)||Lwa.isZero(Ls))return Lf[1]=Lf[2]=Lf[3]=Lf[4]=Lf[6]=Lf[7]=Lf[8]=Lf[9]=Lf[11]=Lf[12]=Lf[13]=Lf[14]=0,Lf[0]=Lf[5]=Lf[10]=Lf[15]=1,!1;var Lt=LB._tempVector0,Lu=Lt.elements;Lu[0]=Ln/Ls,Lu[1]=Lo/Ls,Lu[2]=Lp/Ls;var Lv=LB._tempVector1,Ly=Lv.elements;Ly[0]=Lh/Lq,Ly[1]=Li/Lq,Ly[2]=Lj/Lq;var Lz=LB._tempVector2;Lgb.cross(Lt,Lv,Lz);var LA=LB._tempVector1;return Lgb.cross(Lz,Lt,LA),Lf[3]=Lf[7]=Lf[11]=Lf[12]=Lf[13]=Lf[14]=0,Lf[15]=1,Lf[0]=LA.x,Lf[1]=LA.y,Lf[2]=LA.z,Lf[4]=Lz.x,Lf[5]=Lz.y,Lf[6]=Lz.z,Lf[8]=Lt.x,Lf[9]=Lt.y,Lf[10]=Lt.z,Lf[0]*Lh+Lf[1]*Li+Lf[2]*Lj<0&&(Lg[0]=-Lq),Lf[4]*Lk+Lf[5]*Ll+Lf[6]*Lm<0&&(Lg[1]=-Lr),Lf[8]*Ln+Lf[9]*Lo+Lf[10]*Lp<0&&(Lg[2]=-Ls),!0},La.decomposeYawPitchRoll=function(La){var Lb=La.elements,Lc=Math.asin(-this.elements[9]);Lb[1]=Lc,Math.cos(Lc)>Lwa.zeroTolerance?(Lb[2]=Math.atan2(this.elements[1],this.elements[5]),Lb[0]=Math.atan2(this.elements[8],this.elements[10])):(Lb[2]=Math.atan2(-this.elements[4],this.elements[0]),Lb[0]=0)},La.normalize=function(){var La=this.elements,Lb=La[0],Lc=La[1],Ld=La[2],Le=Math.sqrt(Lb*Lb+Lc*Lc+Ld*Ld);if(!Le)return La[0]=0,La[1]=0,void(La[2]=0);1!=Le&&(Le=1/Le,La[0]=Lb*Le,La[1]=Lc*Le,La[2]=Ld*Le)},La.transpose=function(){var La,Lb;return Lb=(La=this.elements)[1],La[1]=La[4],La[4]=Lb,Lb=La[2],La[2]=La[8],La[8]=Lb,Lb=La[3],La[3]=La[12],La[12]=Lb,Lb=La[6],La[6]=La[9],La[9]=Lb,Lb=La[7],La[7]=La[13],La[13]=Lb,Lb=La[11],La[11]=La[14],La[14]=Lb,this},La.invert=function(La){var Lb=this.elements,Lc=La.elements,Ld=Lb[0],Le=Lb[1],Lf=Lb[2],Lg=Lb[3],Lh=Lb[4],Li=Lb[5],Lj=Lb[6],Lk=Lb[7],Ll=Lb[8],Lm=Lb[9],Ln=Lb[10],Lo=Lb[11],Lp=Lb[12],Lq=Lb[13],Lr=Lb[14],Ls=Lb[15],Lt=Ld*Li-Le*Lh,Lu=Ld*Lj-Lf*Lh,Lv=Ld*Lk-Lg*Lh,Ly=Le*Lj-Lf*Li,Lz=Le*Lk-Lg*Li,LA=Lf*Lk-Lg*Lj,LB=Ll*Lq-Lm*Lp,LC=Ll*Lr-Ln*Lp,LD=Ll*Ls-Lo*Lp,LE=Lm*Lr-Ln*Lq,LF=Lm*Ls-Lo*Lq,LG=Ln*Ls-Lo*Lr,LH=Lt*LG-Lu*LF+Lv*LE+Ly*LD-Lz*LC+LA*LB;0!==Math.abs(LH)&&(LH=1/LH,Lc[0]=(Li*LG-Lj*LF+Lk*LE)*LH,Lc[1]=(Lf*LF-Le*LG-Lg*LE)*LH,Lc[2]=(Lq*LA-Lr*Lz+Ls*Ly)*LH,Lc[3]=(Ln*Lz-Lm*LA-Lo*Ly)*LH,Lc[4]=(Lj*LD-Lh*LG-Lk*LC)*LH,Lc[5]=(Ld*LG-Lf*LD+Lg*LC)*LH,Lc[6]=(Lr*Lv-Lp*LA-Ls*Lu)*LH,Lc[7]=(Ll*LA-Ln*Lv+Lo*Lu)*LH,Lc[8]=(Lh*LF-Li*LD+Lk*LB)*LH,Lc[9]=(Le*LD-Ld*LF-Lg*LB)*LH,Lc[10]=(Lp*Lz-Lq*Lv+Ls*Lt)*LH,Lc[11]=(Lm*Lv-Ll*Lz-Lo*Lt)*LH,Lc[12]=(Li*LC-Lh*LE-Lj*LB)*LH,Lc[13]=(Ld*LE-Le*LC+Lf*LB)*LH,Lc[14]=(Lq*Lu-Lp*Ly-Lr*Lt)*LH,Lc[15]=(Ll*Ly-Lm*Lu+Ln*Lt)*LH)},La.identity=function(){var La=this.elements;La[1]=La[2]=La[3]=La[4]=La[6]=La[7]=La[8]=La[9]=La[11]=La[12]=La[13]=La[14]=0,La[0]=La[5]=La[10]=La[15]=1},La.cloneTo=function(La){var Lb,Lc,Ld;if((Lc=this.elements)!==(Ld=La.elements))for(Lb=0;Lb<16;++Lb)Ld[Lb]=Lc[Lb]},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},La.getTranslationVector=function(La){var Lb=this.elements,Lc=La.elements;Lc[0]=Lb[12],Lc[1]=Lb[13],Lc[2]=Lb[14]},La.setTranslationVector=function(La){var Lb=this.elements,Lc=La.elements;Lb[12]=Lc[0],Lb[13]=Lc[1],Lb[14]=Lc[2]},La.getForward=function(La){var Lb=this.elements,Lc=La.elements;Lc[0]=-Lb[8],Lc[1]=-Lb[9],Lc[2]=-Lb[10]},La.setForward=function(La){var Lb=this.elements,Lc=La.elements;Lb[8]=-Lc[0],Lb[9]=-Lc[1],Lb[10]=-Lc[2]},LB.createRotationX=function(La,Lb){var Lc=Lb.elements,Ld=Math.sin(La),Le=Math.cos(La);Lc[1]=Lc[2]=Lc[3]=Lc[4]=Lc[7]=Lc[8]=Lc[11]=Lc[12]=Lc[13]=Lc[14]=0,Lc[0]=Lc[15]=1,Lc[5]=Lc[10]=Le,Lc[6]=Ld,Lc[9]=-Ld},LB.createRotationY=function(La,Lb){var Lc=Lb.elements,Ld=Math.sin(La),Le=Math.cos(La);Lc[1]=Lc[3]=Lc[4]=Lc[6]=Lc[7]=Lc[9]=Lc[11]=Lc[12]=Lc[13]=Lc[14]=0,Lc[5]=Lc[15]=1,Lc[0]=Lc[10]=Le,Lc[2]=-Ld,Lc[8]=Ld},LB.createRotationZ=function(La,Lb){var Lc=Lb.elements,Ld=Math.sin(La),Le=Math.cos(La);Lc[2]=Lc[3]=Lc[6]=Lc[7]=Lc[8]=Lc[9]=Lc[11]=Lc[12]=Lc[13]=Lc[14]=0,Lc[10]=Lc[15]=1,Lc[0]=Lc[5]=Le,Lc[1]=Ld,Lc[4]=-Ld},LB.createRotationYawPitchRoll=function(La,Lb,Lc,Ld){Lcb.createFromYawPitchRoll(La,Lb,Lc,LB._tempQuaternion),LB.createRotationQuaternion(LB._tempQuaternion,Ld)},LB.createRotationAxis=function(La,Lb,Lc){var Ld=La.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Math.cos(Lb),Li=Math.sin(Lb),Lj=Le*Le,Lk=Lf*Lf,Ll=Lg*Lg,Lm=Le*Lf,Ln=Le*Lg,Lo=Lf*Lg,Lp=Lc.elements;Lp[3]=Lp[7]=Lp[11]=Lp[12]=Lp[13]=Lp[14]=0,Lp[15]=1,Lp[0]=Lj+Lh*(1-Lj),Lp[1]=Lm-Lh*Lm+Li*Lg,Lp[2]=Ln-Lh*Ln-Li*Lf,Lp[4]=Lm-Lh*Lm-Li*Lg,Lp[5]=Lk+Lh*(1-Lk),Lp[6]=Lo-Lh*Lo+Li*Le,Lp[8]=Ln-Lh*Ln+Li*Lf,Lp[9]=Lo-Lh*Lo-Li*Le,Lp[10]=Ll+Lh*(1-Ll)},LB.createRotationQuaternion=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0],Lf=Lc[1],Lg=Lc[2],Lh=Lc[3],Li=Le*Le,Lj=Lf*Lf,Lk=Lg*Lg,Ll=Le*Lf,Lm=Lg*Lh,Ln=Lg*Le,Lo=Lf*Lh,Lp=Lf*Lg,Lq=Le*Lh;Ld[3]=Ld[7]=Ld[11]=Ld[12]=Ld[13]=Ld[14]=0,Ld[15]=1,Ld[0]=1-2*(Lj+Lk),Ld[1]=2*(Ll+Lm),Ld[2]=2*(Ln-Lo),Ld[4]=2*(Ll-Lm),Ld[5]=1-2*(Lk+Li),Ld[6]=2*(Lp+Lq),Ld[8]=2*(Ln+Lo),Ld[9]=2*(Lp-Lq),Ld[10]=1-2*(Lj+Li)},LB.createTranslate=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;Ld[4]=Ld[8]=Ld[1]=Ld[9]=Ld[2]=Ld[6]=Ld[3]=Ld[7]=Ld[11]=0,Ld[0]=Ld[5]=Ld[10]=Ld[15]=1,Ld[12]=Lc[0],Ld[13]=Lc[1],Ld[14]=Lc[2]},LB.createScaling=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;Ld[0]=Lc[0],Ld[5]=Lc[1],Ld[10]=Lc[2],Ld[1]=Ld[4]=Ld[8]=Ld[12]=Ld[9]=Ld[13]=Ld[2]=Ld[6]=Ld[14]=Ld[3]=Ld[7]=Ld[11]=0,Ld[15]=1},LB.multiply=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh,Li,Lj,Lk;for(Le=Lc.elements,Lf=La.elements,Le===(Lg=Lb.elements)&&(Lg=Lg.slice()),Ld=0;Ld<4;Ld++)Lh=Lf[Ld],Li=Lf[Ld+4],Lj=Lf[Ld+8],Lk=Lf[Ld+12],Le[Ld]=Lh*Lg[0]+Li*Lg[1]+Lj*Lg[2]+Lk*Lg[3],Le[Ld+4]=Lh*Lg[4]+Li*Lg[5]+Lj*Lg[6]+Lk*Lg[7],Le[Ld+8]=Lh*Lg[8]+Li*Lg[9]+Lj*Lg[10]+Lk*Lg[11],Le[Ld+12]=Lh*Lg[12]+Li*Lg[13]+Lj*Lg[14]+Lk*Lg[15]},LB.createFromQuaternion=function(La,Lb){var Lc=Lb.elements,Ld=La.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Le+Le,Lj=Lf+Lf,Lk=Lg+Lg,Ll=Le*Li,Lm=Lf*Li,Ln=Lf*Lj,Lo=Lg*Li,Lp=Lg*Lj,Lq=Lg*Lk,Lr=Lh*Li,Ls=Lh*Lj,Lt=Lh*Lk;Lc[0]=1-Ln-Lq,Lc[1]=Lm+Lt,Lc[2]=Lo-Ls,Lc[3]=0,Lc[4]=Lm-Lt,Lc[5]=1-Ll-Lq,Lc[6]=Lp+Lr,Lc[7]=0,Lc[8]=Lo+Ls,Lc[9]=Lp-Lr,Lc[10]=1-Ll-Ln,Lc[11]=0,Lc[12]=0,Lc[13]=0,Lc[14]=0,Lc[15]=1},LB.createAffineTransformation=function(La,Lb,Lc,Ld){var Le=La.elements,Lf=Lb.elements,Lg=Lc.elements,Lh=Ld.elements,Li=Lf[0],Lj=Lf[1],Lk=Lf[2],Ll=Lf[3],Lm=Li+Li,Ln=Lj+Lj,Lo=Lk+Lk,Lp=Li*Lm,Lq=Li*Ln,Lr=Li*Lo,Ls=Lj*Ln,Lt=Lj*Lo,Lu=Lk*Lo,Lv=Ll*Lm,Ly=Ll*Ln,Lz=Ll*Lo,LA=Lg[0],LB=Lg[1],LC=Lg[2];Lh[0]=(1-(Ls+Lu))*LA,Lh[1]=(Lq+Lz)*LA,Lh[2]=(Lr-Ly)*LA,Lh[3]=0,Lh[4]=(Lq-Lz)*LB,Lh[5]=(1-(Lp+Lu))*LB,Lh[6]=(Lt+Lv)*LB,Lh[7]=0,Lh[8]=(Lr+Ly)*LC,Lh[9]=(Lt-Lv)*LC,Lh[10]=(1-(Lp+Ls))*LC,Lh[11]=0,Lh[12]=Le[0],Lh[13]=Le[1],Lh[14]=Le[2],Lh[15]=1},LB.createLookAt=function(La,Lb,Lc,Ld){var Le=Ld.elements,Lf=LB._tempVector0,Lg=LB._tempVector1,Lh=LB._tempVector2;Lgb.subtract(La,Lb,Lh),Lgb.normalize(Lh,Lh),Lgb.cross(Lc,Lh,Lf),Lgb.normalize(Lf,Lf),Lgb.cross(Lh,Lf,Lg),Ld.identity(),Le[0]=Lf.x,Le[4]=Lf.y,Le[8]=Lf.z,Le[1]=Lg.x,Le[5]=Lg.y,Le[9]=Lg.z,Le[2]=Lh.x,Le[6]=Lh.y,Le[10]=Lh.z,Le[12]=-Lgb.dot(Lf,La),Le[13]=-Lgb.dot(Lg,La),Le[14]=-Lgb.dot(Lh,La)},LB.createPerspective=function(La,Lb,Lc,Ld,Le){var Lf=Le.elements,Lg=1/Math.tan(La/2),Lh=1/(Lc-Ld);Lf[0]=Lg/Lb,Lf[5]=Lg,Lf[10]=(Ld+Lc)*Lh,Lf[11]=-1,Lf[14]=2*Ld*Lc*Lh,Lf[1]=Lf[2]=Lf[3]=Lf[4]=Lf[6]=Lf[7]=Lf[8]=Lf[9]=Lf[12]=Lf[13]=Lf[15]=0},LB.createOrthoOffCenterRH=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh=Lg.elements,Li=1/(La-Lb),Lj=1/(Lc-Ld),Lk=1/(Le-Lf);Lh[1]=Lh[2]=Lh[3]=Lh[4]=Lh[6]=Lh[7]=Lh[8]=Lh[9]=Lh[11]=0,Lh[15]=1,Lh[0]=-2*Li,Lh[5]=-2*Lj,Lh[10]=2*Lk,Lh[12]=(La+Lb)*Li,Lh[13]=(Ld+Lc)*Lj,Lh[14]=(Lf+Le)*Lk},LB.translation=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;Ld[0]=Ld[5]=Ld[10]=Ld[15]=1,Ld[12]=Lc[0],Ld[13]=Lc[1],Ld[14]=Lc[2]},Ll(LB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new LB},"_tempVector0",function(){return this._tempVector0=new Lgb},"_tempVector1",function(){return this._tempVector1=new Lgb},"_tempVector2",function(){return this._tempVector2=new Lgb},"_tempQuaternion",function(){return this._tempQuaternion=new Lcb},"DEFAULT",function(){return this.DEFAULT=new LB},"ZERO",function(){return this.ZERO=new LB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),LB}(),Lbb=(function(){function Lt(La,Lb){this.extents=null,this.transformation=null,this.extents=La,this.transformation=Lb}Ln(Lt,"laya.d3.math.OrientedBoundBox");var La=Lt.prototype;La.getCorners=function(La){var Lb=Lt._tempV30.elements,Lc=Lt._tempV31.elements,Ld=Lt._tempV32.elements,Le=this.extents.elements;Lb[0]=Le[0],Lb[1]=Lb[2]=0,Lc[1]=Le[1],Lc[0]=Lc[2]=0,Ld[2]=Le[2],Ld[0]=Ld[1]=0,Lgb.TransformNormal(Lt._tempV30,this.transformation,Lt._tempV30),Lgb.TransformNormal(Lt._tempV31,this.transformation,Lt._tempV31),Lgb.TransformNormal(Lt._tempV32,this.transformation,Lt._tempV32);var Lf=Lt._tempV33;this.transformation.getTranslationVector(Lf),La.length=8,Lgb.add(Lf,Lt._tempV30,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV32,La[0]),Lgb.add(Lf,Lt._tempV30,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV32,La[1]),Lgb.subtract(Lf,Lt._tempV30,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV32,La[2]),Lgb.subtract(Lf,Lt._tempV30,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV32,La[3]),Lgb.add(Lf,Lt._tempV30,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV32,La[4]),Lgb.add(Lf,Lt._tempV30,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV32,La[5]),Lgb.subtract(Lf,Lt._tempV30,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV32,La[6]),Lgb.subtract(Lf,Lt._tempV30,Lt._tempV34),Lgb.subtract(Lt._tempV34,Lt._tempV31,Lt._tempV34),Lgb.add(Lt._tempV34,Lt._tempV32,La[7])},La.transform=function(La){Lab.multiply(this.transformation,La,this.transformation)},La.scale=function(La){Lgb.multiply(this.extents,La,this.extents)},La.translate=function(La){this.transformation.getTranslationVector(Lt._tempV30),Lgb.add(Lt._tempV30,La,Lt._tempV31),this.transformation.setTranslationVector(Lt._tempV31)},La.Size=function(La){Lgb.scale(this.extents,2,La)},La.getSize=function(La){var Lb=this.extents.elements;Lt._tempV30.x=Lb[0],Lt._tempV31.y=Lb[1],Lt._tempV32.z=Lb[2],Lgb.TransformNormal(Lt._tempV30,this.transformation,Lt._tempV30),Lgb.TransformNormal(Lt._tempV31,this.transformation,Lt._tempV31),Lgb.TransformNormal(Lt._tempV31,this.transformation,Lt._tempV32);var Lc=La.elements;Lc[0]=Lgb.scalarLength(Lt._tempV30),Lc[1]=Lgb.scalarLength(Lt._tempV31),Lc[2]=Lgb.scalarLength(Lt._tempV32)},La.getSizeSquared=function(La){var Lb=this.extents.elements;Lt._tempV30.x=Lb[0],Lt._tempV31.y=Lb[1],Lt._tempV32.z=Lb[2],Lgb.TransformNormal(Lt._tempV30,this.transformation,Lt._tempV30),Lgb.TransformNormal(Lt._tempV31,this.transformation,Lt._tempV31),Lgb.TransformNormal(Lt._tempV31,this.transformation,Lt._tempV32);var Lc=La.elements;Lc[0]=Lgb.scalarLengthSquared(Lt._tempV30),Lc[1]=Lgb.scalarLengthSquared(Lt._tempV31),Lc[2]=Lgb.scalarLengthSquared(Lt._tempV32)},La.getCenter=function(La){this.transformation.getTranslationVector(La)},La.containsPoint=function(La){var Lb=this.extents.elements,Lc=Lb[0],Ld=Lb[1],Le=Lb[2];this.transformation.invert(Lt._tempM0),Lgb.transformCoordinate(La,Lt._tempM0,Lt._tempV30);var Lf=Lt._tempV30.elements,Lg=Math.abs(Lf[0]),Lh=Math.abs(Lf[1]),Li=Math.abs(Lf[2]);return Lwa.nearEqual(Lg,Lc)&&Lwa.nearEqual(Lh,Ld)&&Lwa.nearEqual(Li,Le)?2:Lg<Lc&&Lh<Ld&&Li<Le?1:0},La.containsPoints=function(La){var Lb=this.extents.elements,Lc=Lb[0],Ld=Lb[1],Le=Lb[2];this.transformation.invert(Lt._tempM0);for(var Lf=!0,Lg=!1,Lh=0;Lh<La.length;Lh++){Lgb.transformCoordinate(La[Lh],Lt._tempM0,Lt._tempV30);var Li=Lt._tempV30.elements,Lj=Math.abs(Li[0]),Lk=Math.abs(Li[1]),Ll=Math.abs(Li[2]);Lwa.nearEqual(Lj,Lc)&&Lwa.nearEqual(Lk,Ld)&&Lwa.nearEqual(Ll,Le)&&(Lg=!0),Lj<Lc&&Lk<Ld&&Ll<Le?Lg=!0:Lf=!1}return Lf?1:Lg?2:0},La.containsSphere=function(La,Lb){void 0===Lb&&(Lb=!1);var Lc=this.extents.elements,Ld=Lc[0],Le=Lc[1],Lf=Lc[2],Lg=La.radius;this.transformation.invert(Lt._tempM0),Lgb.transformCoordinate(La.center,Lt._tempM0,Lt._tempV30);var Lh=NaN;if(Lh=Lb?Lg:(Lgb.scale(Lgb.UnitX,Lg,Lt._tempV31),Lgb.TransformNormal(Lt._tempV31,Lt._tempM0,Lt._tempV31),Lgb.scalarLength(Lt._tempV31)),Lgb.scale(this.extents,-1,Lt._tempV32),Lgb.Clamp(Lt._tempV30,Lt._tempV32,this.extents,Lt._tempV33),Lh*Lh<Lgb.distanceSquared(Lt._tempV30,Lt._tempV33))return 0;var Li=Lt._tempV30.elements,Lj=Li[0],Lk=Li[1],Ll=Li[2],Lm=Lt._tempV32.elements,Ln=Lm[0],Lo=Lm[1],Lp=Lm[2];return Ln+Lh<=Lj&&Lj<=Ld-Lh&&Lh<Ld-Ln&&Lo+Lh<=Lk&&Lk<=Le-Lh&&Lh<Le-Lo&&Lp+Lh<=Ll&&Ll<=Lf-Lh&&Lh<Lf-Lp?1:2},La.containsOrientedBoundBox=function(La){var Lb=0,Lc=0;La.getCorners(Lt._corners);var Ld=this.containsPoints(Lt._corners);if(0!=Ld)return Ld;var Le=this.extents.elements;La.extents.cloneTo(Lt._tempV35);var Lf=Lt._tempV35.elements;Lt._getRows(this.transformation,Lt._rows1),Lt._getRows(La.transformation,Lt._rows2);var Lg=NaN;for(Lb=0;Lb<4;Lb++)for(Lc=0;Lc<4;Lc++)3==Lb||3==Lc?(Lt._tempM0.setElementByRowColumn(Lb,Lc,0),Lt._tempM1.setElementByRowColumn(Lb,Lc,0)):(Lg=Lgb.dot(Lt._rows1[Lb],Lt._rows2[Lc]),Lt._tempM0.setElementByRowColumn(Lb,Lc,Lg),Lt._tempM1.setElementByRowColumn(Lb,Lc,Math.abs(Lg)));La.getCenter(Lt._tempV34),this.getCenter(Lt._tempV36),Lgb.subtract(Lt._tempV34,Lt._tempV36,Lt._tempV30);var Lh=Lt._tempV31.elements;Lh[0]=Lgb.dot(Lt._tempV30,Lt._rows1[0]),Lh[1]=Lgb.dot(Lt._tempV30,Lt._rows1[1]),Lh[2]=Lgb.dot(Lt._tempV30,Lt._rows1[2]);var Li=Lt._tempV32.elements,Lj=Lt._tempV33.elements;for(Lb=0;Lb<3;Lb++)if(Li[0]=Lt._tempM1.getElementByRowColumn(Lb,0),Li[1]=Lt._tempM1.getElementByRowColumn(Lb,1),Li[2]=Lt._tempM1.getElementByRowColumn(Lb,2),Le[Lb]+Lgb.dot(Lt._tempV35,Lt._tempV32)<Math.abs(Lh[Lb]))return 0;for(Lc=0;Lc<3;Lc++)if(Li[0]=Lt._tempM1.getElementByRowColumn(0,Lc),Li[1]=Lt._tempM1.getElementByRowColumn(1,Lc),Li[2]=Lt._tempM1.getElementByRowColumn(2,Lc),Lj[0]=Lt._tempM0.getElementByRowColumn(0,Lc),Lj[1]=Lt._tempM0.getElementByRowColumn(1,Lc),Lj[2]=Lt._tempM0.getElementByRowColumn(2,Lc),Lgb.dot(this.extents,Lt._tempV32)+Lf[Lc]<Math.abs(Lgb.dot(Lt._tempV31,Lt._tempV33)))return 0;for(Lb=0;Lb<3;Lb++)for(Lc=0;Lc<3;Lc++){var Lk=(Lb+1)%3,Ll=(Lb+2)%3,Lm=(Lc+1)%3,Ln=(Lc+2)%3;if(Le[Lk]*Lt._tempM1.getElementByRowColumn(Ll,Lc)+Le[Ll]*Lt._tempM1.getElementByRowColumn(Lk,Lc)+(Lf[Lm]*Lt._tempM1.getElementByRowColumn(Lb,Ln)+Lf[Ln]*Lt._tempM1.getElementByRowColumn(Lb,Lm))<Math.abs(Lh[Ll]*Lt._tempM0.getElementByRowColumn(Lk,Lc)-Lh[Lk]*Lt._tempM0.getElementByRowColumn(Ll,Lc)))return 0}return 2},La.containsLine=function(La,Lb){Lt._corners[0]=La,Lt._corners[1]=Lb;var Lc=this.containsPoints(Lt._corners);if(0!=Lc)return Lc;var Ld=this.extents.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2];this.transformation.invert(Lt._tempM0),Lgb.transformCoordinate(La,Lt._tempM0,Lt._tempV30),Lgb.transformCoordinate(Lb,Lt._tempM0,Lt._tempV31),Lgb.add(Lt._tempV30,Lt._tempV31,Lt._tempV32),Lgb.scale(Lt._tempV32,.5,Lt._tempV32),Lgb.subtract(Lt._tempV30,Lt._tempV32,Lt._tempV33);var Lh=Lt._tempV33.elements,Li=Lh[0],Lj=Lh[1],Lk=Lh[2],Ll=Lt._tempV34.elements,Lm=Ll[0]=Math.abs(Lh[0]),Ln=Ll[1]=Math.abs(Lh[1]),Lo=Ll[2]=Math.abs(Lh[2]),Lp=Lt._tempV32.elements,Lq=Lp[0],Lr=Lp[1],Ls=Lp[2];return Math.abs(Lq)>Le+Lm?0:Math.abs(Lr)>Lf+Ln?0:Math.abs(Ls)>Lg+Lo?0:Math.abs(Lr*Lk-Ls*Lj)>Lf*Lo+Lg*Ln?0:Math.abs(Lq*Lk-Ls*Li)>Le*Lo+Lg*Lm?0:Math.abs(Lq*Lj-Lr*Li)>Le*Ln+Lf*Lm?0:2},La.containsBoundBox=function(La){var Lb=0,Lc=0,Ld=La.min,Le=La.max;La.getCorners(Lt._corners);var Lf=this.containsPoints(Lt._corners);if(0!=Lf)return Lf;Lgb.subtract(Le,Ld,Lt._tempV30),Lgb.scale(Lt._tempV30,.5,Lt._tempV30),Lgb.add(Ld,Lt._tempV30,Lt._tempV30),Lgb.subtract(Le,Lt._tempV30,Lt._tempV31);var Lg=this.extents.elements,Lh=Lt._tempV31.elements;Lt._getRows(this.transformation,Lt._rows1),this.transformation.invert(Lt._tempM0);for(Lb=0;Lb<3;Lb++)for(Lc=0;Lc<3;Lc++)Lt._tempM1.setElementByRowColumn(Lb,Lc,Math.abs(Lt._tempM0.getElementByRowColumn(Lb,Lc)));this.getCenter(Lt._tempV35),Lgb.subtract(Lt._tempV30,Lt._tempV35,Lt._tempV32);var Li=Lt._tempV31.elements;Li[0]=Lgb.dot(Lt._tempV32,Lt._rows1[0]),Li[1]=Lgb.dot(Lt._tempV32,Lt._rows1[1]),Li[2]=Lgb.dot(Lt._tempV32,Lt._rows1[2]);var Lj=Lt._tempV33.elements,Lk=Lt._tempV34.elements;for(Lb=0;Lb<3;Lb++)if(Lj[0]=Lt._tempM1.getElementByRowColumn(Lb,0),Lj[1]=Lt._tempM1.getElementByRowColumn(Lb,1),Lj[2]=Lt._tempM1.getElementByRowColumn(Lb,2),Lg[Lb]+Lgb.dot(Lt._tempV31,Lt._tempV33)<Math.abs(Li[Lb]))return 0;for(Lc=0;Lc<3;Lc++)if(Lj[0]=Lt._tempM1.getElementByRowColumn(0,Lc),Lj[1]=Lt._tempM1.getElementByRowColumn(1,Lc),Lj[2]=Lt._tempM1.getElementByRowColumn(2,Lc),Lk[0]=Lt._tempM0.getElementByRowColumn(0,Lc),Lk[1]=Lt._tempM0.getElementByRowColumn(1,Lc),Lk[2]=Lt._tempM0.getElementByRowColumn(2,Lc),Lgb.dot(this.extents,Lt._tempV33)+Lh[Lc]<Math.abs(Lgb.dot(Lt._tempV31,Lt._tempV34)))return 0;for(Lb=0;Lb<3;Lb++)for(Lc=0;Lc<3;Lc++){var Ll=(Lb+1)%3,Lm=(Lb+2)%3,Ln=(Lc+1)%3,Lo=(Lc+2)%3;if(Lg[Ll]*Lt._tempM1.getElementByRowColumn(Lm,Lc)+Lg[Lm]*Lt._tempM1.getElementByRowColumn(Ll,Lc)+(Lh[Ln]*Lt._tempM1.getElementByRowColumn(Lb,Lo)+Lh[Lo]*Lt._tempM1.getElementByRowColumn(Lb,Ln))<Math.abs(Li[Lm]*Lt._tempM0.getElementByRowColumn(Ll,Lc)-Li[Ll]*Lt._tempM0.getElementByRowColumn(Lm,Lc)))return 0}return 2},La.intersectsRay=function(La,Lb){Lgb.scale(this.extents,-1,Lt._tempV30),this.transformation.invert(Lt._tempM0),Lgb.TransformNormal(La.direction,Lt._tempM0,Lt._ray.direction),Lgb.transformCoordinate(La.origin,Lt._tempM0,Lt._ray.origin),Lt._boxBound1.min=Lt._tempV30,Lt._boxBound1.max=this.extents;var Lc=Collision.intersectsRayAndBoxRP(Lt._ray,Lt._boxBound1,Lb);return-1!==Lc&&Lgb.transformCoordinate(Lb,this.transformation,Lb),Lc},La._getLocalCorners=function(La){La.length=8;var Lb=this.extents.elements;Lt._tempV30.x=Lb[0],Lt._tempV31.y=Lb[1],Lt._tempV32.z=Lb[2],Lgb.add(Lt._tempV30,Lt._tempV31,Lt._tempV33),Lgb.add(Lt._tempV33,Lt._tempV32,La[0]),Lgb.add(Lt._tempV30,Lt._tempV31,Lt._tempV33),Lgb.subtract(Lt._tempV33,Lt._tempV32,La[1]),Lgb.subtract(Lt._tempV31,Lt._tempV30,Lt._tempV33),Lgb.subtract(Lt._tempV33,Lt._tempV30,La[2]),Lgb.subtract(Lt._tempV31,Lt._tempV30,Lt._tempV33),Lgb.add(Lt._tempV33,Lt._tempV32,La[3]),Lgb.subtract(Lt._tempV30,Lt._tempV31,Lt._tempV33),Lgb.add(Lt._tempV33,Lt._tempV32,La[4]),Lgb.subtract(Lt._tempV30,Lt._tempV31,Lt._tempV33),Lgb.subtract(Lt._tempV33,Lt._tempV32,La[5]),Lgb.scale(La[0],-1,La[6]),Lgb.subtract(Lt._tempV32,Lt._tempV30,Lt._tempV33),Lgb.subtract(Lt._tempV33,Lt._tempV31,La[7])},La.equals=function(La){return this.extents==La.extents&&this.transformation==La.transformation},La.cloneTo=function(La){var Lb=La;this.extents.cloneTo(Lb.extents),this.transformation.cloneTo(Lb.transformation)},Lt.createByBoundBox=function(La,Lb){var Lc=La.min,Ld=La.max;Lgb.subtract(Ld,Lc,Lt._tempV30),Lgb.scale(Lt._tempV30,.5,Lt._tempV30),Lgb.add(Lc,Lt._tempV30,Lt._tempV31),Lgb.subtract(Ld,Lt._tempV31,Lt._tempV32),Lab.translation(Lt._tempV31,Lt._tempM0);var Le=Lt._tempV32.clone(),Lf=Lt._tempM0.clone();Lb.extents=Le,Lb.transformation=Lf},Lt.createByMinAndMaxVertex=function(La,Lb){return Lgb.subtract(Lb,La,Lt._tempV30),Lgb.scale(Lt._tempV30,.5,Lt._tempV30),Lgb.add(La,Lt._tempV30,Lt._tempV31),Lgb.subtract(Lb,Lt._tempV31,Lt._tempV32),Lab.translation(Lt._tempV31,Lt._tempM0),new Lt(Lt._tempV32,Lt._tempM0)},Lt._getRows=function(La,Lb){Lb.length=3;var Lc=La.elements,Ld=Lb[0].elements;Ld[0]=Lc[0],Ld[1]=Lc[1],Ld[2]=Lc[2];var Le=Lb[1].elements;Le[0]=Lc[4],Le[1]=Lc[5],Le[2]=Lc[6];var Lf=Lb[2].elements;Lf[0]=Lc[8],Lf[1]=Lc[9],Lf[2]=Lc[10]},Lt.getObbtoObbMatrix4x4=function(La,Lb,Lc,Ld){var Le=La.transformation,Lf=Lb.transformation;if(Lc){Lt._getRows(Le,Lt._rows1),Lt._getRows(Lf,Lt._rows2);for(var Lg=0;Lg<3;Lg++)for(var Lh=0;Lh<3;Lh++)Ld.setElementByRowColumn(Lg,Lh,Lgb.dot(Lt._rows2[Lg],Lt._rows1[Lh]));Lb.getCenter(Lt._tempV30),La.getCenter(Lt._tempV31),Lgb.subtract(Lt._tempV30,Lt._tempV31,Lt._tempV32);var Li=Ld.elements;Li[12]=Lgb.dot(Lt._tempV32,Lt._rows1[0]),Li[13]=Lgb.dot(Lt._tempV32,Lt._rows1[1]),Li[14]=Lgb.dot(Lt._tempV32,Lt._rows1[2]),Li[15]=1}else Le.invert(Lt._tempM0),Lab.multiply(Lf,Lt._tempM0,Ld)},Lt.merge=function(La,Lb,Lc){var Ld=La.extents,Le=La.transformation;Lt.getObbtoObbMatrix4x4(La,Lb,Lc,Lt._tempM0),Lb._getLocalCorners(Lt._corners),Lgb.transformCoordinate(Lt._corners[0],Lt._tempM0,Lt._corners[0]),Lgb.transformCoordinate(Lt._corners[1],Lt._tempM0,Lt._corners[1]),Lgb.transformCoordinate(Lt._corners[2],Lt._tempM0,Lt._corners[2]),Lgb.transformCoordinate(Lt._corners[3],Lt._tempM0,Lt._corners[3]),Lgb.transformCoordinate(Lt._corners[4],Lt._tempM0,Lt._corners[4]),Lgb.transformCoordinate(Lt._corners[5],Lt._tempM0,Lt._corners[5]),Lgb.transformCoordinate(Lt._corners[6],Lt._tempM0,Lt._corners[6]),Lgb.transformCoordinate(Lt._corners[7],Lt._tempM0,Lt._corners[7]),Lgb.scale(Ld,-1,Lt._boxBound1.min),Ld.cloneTo(Lt._boxBound1.max),LZa.createfromPoints(Lt._corners,Lt._boxBound2),LZa.merge(Lt._boxBound2,Lt._boxBound1,Lt._boxBound3);var Lf=Lt._boxBound3.min,Lg=Lt._boxBound3.max;Lgb.subtract(Lg,Lf,Lt._tempV30),Lgb.scale(Lt._tempV30,.5,Lt._tempV30),Lgb.add(Lf,Lt._tempV30,Lt._tempV32),Lgb.subtract(Lg,Lt._tempV32,Ld),Lgb.transformCoordinate(Lt._tempV32,Le,Lt._tempV33)},Ll(Lt,["_tempV30",function(){return this._tempV30=new Lgb},"_tempV31",function(){return this._tempV31=new Lgb},"_tempV32",function(){return this._tempV32=new Lgb},"_tempV33",function(){return this._tempV33=new Lgb},"_tempV34",function(){return this._tempV34=new Lgb},"_tempV35",function(){return this._tempV35=new Lgb},"_tempV36",function(){return this._tempV36=new Lgb},"_tempM0",function(){return this._tempM0=new Lab},"_tempM1",function(){return this._tempM1=new Lab},"_corners",function(){return this._corners=[new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb]},"_rows1",function(){return this._rows1=[new Lgb,new Lgb,new Lgb]},"_rows2",function(){return this._rows2=[new Lgb,new Lgb,new Lgb]},"_ray",function(){return this._ray=new Leb(new Lgb,new Lgb)},"_boxBound1",function(){return this._boxBound1=new LZa(new Lgb,new Lgb)},"_boxBound2",function(){return this._boxBound2=new LZa(new Lgb,new Lgb)},"_boxBound3",function(){return this._boxBound3=new LZa(new Lgb,new Lgb)}])}(),function(){function Lv(La,Lb){this.normal=null,this.distance=NaN,void 0===Lb&&(Lb=0),this.normal=La,this.distance=Lb}return Ln(Lv,"laya.d3.math.Plane"),Lv.prototype.normalize=function(){var La=this.normal.elements,Lb=La[0],Lc=La[1],Ld=La[2],Le=1/Math.sqrt(Lb*Lb+Lc*Lc+Ld*Ld);La[0]=Lb*Le,La[1]=Lc*Le,La[2]=Ld*Le,this.distance*=Le},Lv.createPlaneBy3P=function(La,Lb,Lc){var Ld=La.elements,Le=Lb.elements,Lf=Lc.elements,Lg=Le[0]-Ld[0],Lh=Le[1]-Ld[1],Li=Le[2]-Ld[2],Lj=Lf[0]-Ld[0],Lk=Lf[1]-Ld[1],Ll=Lf[2]-Ld[2],Lm=Lh*Ll-Li*Lk,Ln=Li*Lj-Lg*Ll,Lo=Lg*Lk-Lh*Lj,Lp=1/Math.sqrt(Lm*Lm+Ln*Ln+Lo*Lo),Lq=Lm*Lp,Lr=Ln*Lp,Ls=Lo*Lp,Lt=Lv._TEMPVec3.elements;Lt[0]=Lq,Lt[1]=Lr,Lt[2]=Ls;var Lu=-(Lq*Ld[0]+Lr*Ld[1]+Ls*Ld[2]);return new Lv(Lv._TEMPVec3,Lu)},Lv.PlaneIntersectionType_Back=0,Lv.PlaneIntersectionType_Front=1,Lv.PlaneIntersectionType_Intersecting=2,Ll(Lv,["_TEMPVec3",function(){return this._TEMPVec3=new Lgb}]),Lv}()),Lcb=function(){function Le(La,Lb,Lc,Ld){this.elements=new Float32Array(4),void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=1),this.elements[0]=La,this.elements[1]=Lb,this.elements[2]=Lc,this.elements[3]=Ld}Ln(Le,"laya.d3.math.Quaternion");var La=Le.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.scaling=function(La,Lb){var Lc=Lb.elements,Ld=this.elements;Lc[0]=Ld[0]*La,Lc[1]=Ld[1]*La,Lc[2]=Ld[2]*La,Lc[3]=Ld[3]*La},La.normalize=function(La){var Lb=La.elements,Lc=this.elements,Ld=Lc[0],Le=Lc[1],Lf=Lc[2],Lg=Lc[3],Lh=Ld*Ld+Le*Le+Lf*Lf+Lg*Lg;0<Lh&&(Lh=1/Math.sqrt(Lh),Lb[0]=Ld*Lh,Lb[1]=Le*Lh,Lb[2]=Lf*Lh,Lb[3]=Lg*Lh)},La.length=function(){var La=this.elements,Lb=La[0],Lc=La[1],Ld=La[2],Le=La[3];return Math.sqrt(Lb*Lb+Lc*Lc+Ld*Ld+Le*Le)},La.rotateX=function(La,Lb){var Lc=Lb.elements,Ld=this.elements;La*=.5;var Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Math.sin(La),Lj=Math.cos(La);Lc[0]=Le*Lj+Lh*Li,Lc[1]=Lf*Lj+Lg*Li,Lc[2]=Lg*Lj-Lf*Li,Lc[3]=Lh*Lj-Le*Li},La.rotateY=function(La,Lb){var Lc=Lb.elements,Ld=this.elements;La*=.5;var Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Math.sin(La),Lj=Math.cos(La);Lc[0]=Le*Lj-Lg*Li,Lc[1]=Lf*Lj+Lh*Li,Lc[2]=Lg*Lj+Le*Li,Lc[3]=Lh*Lj-Lf*Li},La.rotateZ=function(La,Lb){var Lc=Lb.elements,Ld=this.elements;La*=.5;var Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Math.sin(La),Lj=Math.cos(La);Lc[0]=Le*Lj+Lf*Li,Lc[1]=Lf*Lj-Le*Li,Lc[2]=Lg*Lj+Lh*Li,Lc[3]=Lh*Lj-Lg*Li},La.getYawPitchRoll=function(La){Lgb.transformQuat(Lgb.ForwardRH,this,Le.TEMPVector31),Lgb.transformQuat(Lgb.Up,this,Le.TEMPVector32);var Lb=Le.TEMPVector32.elements;Le.angleTo(Lgb.ZERO,Le.TEMPVector31,Le.TEMPVector33);var Lc=Le.TEMPVector33.elements;Lc[0]==Math.PI/2?(Lc[1]=Le.arcTanAngle(Lb[2],Lb[0]),Lc[2]=0):Lc[0]==-Math.PI/2?(Lc[1]=Le.arcTanAngle(-Lb[2],-Lb[0]),Lc[2]=0):(Lab.createRotationY(-Lc[1],Le.TEMPMatrix0),Lab.createRotationX(-Lc[0],Le.TEMPMatrix1),Lgb.transformCoordinate(Le.TEMPVector32,Le.TEMPMatrix0,Le.TEMPVector32),Lgb.transformCoordinate(Le.TEMPVector32,Le.TEMPMatrix1,Le.TEMPVector32),Lc[2]=Le.arcTanAngle(Lb[1],-Lb[0])),Lc[1]<=-Math.PI&&(Lc[1]=Math.PI),Lc[2]<=-Math.PI&&(Lc[2]=Math.PI),Lc[1]>=Math.PI&&Lc[2]>=Math.PI&&(Lc[1]=0,Lc[2]=0,Lc[0]=Math.PI-Lc[0]);var Ld=La.elements;Ld[0]=Lc[1],Ld[1]=Lc[0],Ld[2]=Lc[2]},La.invert=function(La){var Lb=La.elements,Lc=this.elements,Ld=Lc[0],Le=Lc[1],Lf=Lc[2],Lg=Lc[3],Lh=Ld*Ld+Le*Le+Lf*Lf+Lg*Lg,Li=Lh?1/Lh:0;Lb[0]=-Ld*Li,Lb[1]=-Le*Li,Lb[2]=-Lf*Li,Lb[3]=Lg*Li},La.identity=function(){var La=this.elements;La[0]=0,La[1]=0,La[2]=0,La[3]=1},La.fromArray=function(La,Lb){void 0===Lb&&(Lb=0),this.elements[0]=La[Lb+0],this.elements[1]=La[Lb+1],this.elements[2]=La[Lb+2],this.elements[3]=La[Lb+3]},La.cloneTo=function(La){var Lb,Lc,Ld;if((Lc=this.elements)!==(Ld=La.elements))for(Lb=0;Lb<4;++Lb)Ld[Lb]=Lc[Lb]},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},La.equals=function(La){var Lb=this.elements,Lc=La.elements;return Lwa.nearEqual(Lb[0],Lc[0])&&Lwa.nearEqual(Lb[1],Lc[1])&&Lwa.nearEqual(Lb[2],Lc[2])&&Lwa.nearEqual(Lb[3],Lc[3])},La.lengthSquared=function(){var La=this.elements[0],Lb=this.elements[1],Lc=this.elements[2],Ld=this.elements[3];return La*La+Lb*Lb+Lc*Lc+Ld*Ld},Lo(0,La,"x",function(){return this.elements[0]}),Lo(0,La,"y",function(){return this.elements[1]}),Lo(0,La,"z",function(){return this.elements[2]}),Lo(0,La,"w",function(){return this.elements[3]}),Le.createFromYawPitchRoll=function(La,Lb,Lc,Ld){var Le=.5*Lc,Lf=.5*Lb,Lg=.5*La,Lh=Math.sin(Le),Li=Math.cos(Le),Lj=Math.sin(Lf),Lk=Math.cos(Lf),Ll=Math.sin(Lg),Lm=Math.cos(Lg),Ln=Ld.elements;Ln[0]=Lm*Lj*Li+Ll*Lk*Lh,Ln[1]=Ll*Lk*Li-Lm*Lj*Lh,Ln[2]=Lm*Lk*Lh-Ll*Lj*Li,Ln[3]=Lm*Lk*Li+Ll*Lj*Lh},Le.multiply=function(La,Lb,Lc){var Ld=La.elements,Le=Lb.elements,Lf=Lc.elements,Lg=Ld[0],Lh=Ld[1],Li=Ld[2],Lj=Ld[3],Lk=Le[0],Ll=Le[1],Lm=Le[2],Ln=Le[3],Lo=Lh*Lm-Li*Ll,Lp=Li*Lk-Lg*Lm,Lq=Lg*Ll-Lh*Lk,Lr=Lg*Lk+Lh*Ll+Li*Lm;Lf[0]=Lg*Ln+Lk*Lj+Lo,Lf[1]=Lh*Ln+Ll*Lj+Lp,Lf[2]=Li*Ln+Lm*Lj+Lq,Lf[3]=Lj*Ln-Lr},Le.arcTanAngle=function(La,Lb){return 0==La?1==Lb?Math.PI/2:-Math.PI/2:0<La?Math.atan(Lb/La):La<0?0<Lb?Math.atan(Lb/La)+Math.PI:Math.atan(Lb/La)-Math.PI:0},Le.angleTo=function(La,Lb,Lc){Lgb.subtract(Lb,La,Le.TEMPVector30),Lgb.normalize(Le.TEMPVector30,Le.TEMPVector30),Lc.elements[0]=Math.asin(Le.TEMPVector30.y),Lc.elements[1]=Le.arcTanAngle(-Le.TEMPVector30.z,-Le.TEMPVector30.x)},Le.createFromAxisAngle=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements;Lb*=.5;var Lf=Math.sin(Lb);Ld[0]=Lf*Le[0],Ld[1]=Lf*Le[1],Ld[2]=Lf*Le[2],Ld[3]=Math.cos(Lb)},Le.createFromMatrix3x3=function(La,Lb){var Lc,Ld=Lb.elements,Le=La.elements,Lf=Le[0]+Le[4]+Le[8];if(0<Lf)Lc=Math.sqrt(Lf+1),Ld[3]=.5*Lc,Lc=.5/Lc,Ld[0]=(Le[5]-Le[7])*Lc,Ld[1]=(Le[6]-Le[2])*Lc,Ld[2]=(Le[1]-Le[3])*Lc;else{var Lg=0;Le[4]>Le[0]&&(Lg=1),Le[8]>Le[3*Lg+Lg]&&(Lg=2);var Lh=(Lg+1)%3,Li=(Lg+2)%3;Lc=Math.sqrt(Le[3*Lg+Lg]-Le[3*Lh+Lh]-Le[3*Li+Li]+1),Ld[Lg]=.5*Lc,Lc=.5/Lc,Ld[3]=(Le[3*Lh+Li]-Le[3*Li+Lh])*Lc,Ld[Lh]=(Le[3*Lh+Lg]+Le[3*Lg+Lh])*Lc,Ld[Li]=(Le[3*Li+Lg]+Le[3*Lg+Li])*Lc}},Le.createFromMatrix4x4=function(La,Lb){var Lc,Ld,Le=La.elements,Lf=Lb.elements,Lg=Le[0]+Le[5]+Le[10];0<Lg?(Lc=Math.sqrt(Lg+1),Lf[3]=.5*Lc,Lc=.5/Lc,Lf[0]=(Le[6]-Le[9])*Lc,Lf[1]=(Le[8]-Le[2])*Lc,Lf[2]=(Le[1]-Le[4])*Lc):Le[0]>=Le[5]&&Le[0]>=Le[10]?(Ld=.5/(Lc=Math.sqrt(1+Le[0]-Le[5]-Le[10])),Lf[0]=.5*Lc,Lf[1]=(Le[1]+Le[4])*Ld,Lf[2]=(Le[2]+Le[8])*Ld,Lf[3]=(Le[6]-Le[9])*Ld):Le[5]>Le[10]?(Ld=.5/(Lc=Math.sqrt(1+Le[5]-Le[0]-Le[10])),Lf[0]=(Le[4]+Le[1])*Ld,Lf[1]=.5*Lc,Lf[2]=(Le[9]+Le[6])*Ld,Lf[3]=(Le[8]-Le[2])*Ld):(Ld=.5/(Lc=Math.sqrt(1+Le[10]-Le[0]-Le[5])),Lf[0]=(Le[8]+Le[2])*Ld,Lf[1]=(Le[9]+Le[6])*Ld,Lf[2]=.5*Lc,Lf[3]=(Le[1]-Le[4])*Ld)},Le.slerp=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj=La.elements,Lk=Lb.elements,Ll=Ld.elements,Lm=Lj[0],Ln=Lj[1],Lo=Lj[2],Lp=Lj[3],Lq=Lk[0],Lr=Lk[1],Ls=Lk[2],Lt=Lk[3];return(Lf=Lm*Lq+Ln*Lr+Lo*Ls+Lp*Lt)<0&&(Lf=-Lf,Lq=-Lq,Lr=-Lr,Ls=-Ls,Lt=-Lt),Li=1e-6<1-Lf?(Le=Math.acos(Lf),Lg=Math.sin(Le),Lh=Math.sin((1-Lc)*Le)/Lg,Math.sin(Lc*Le)/Lg):(Lh=1-Lc,Lc),Ll[0]=Lh*Lm+Li*Lq,Ll[1]=Lh*Ln+Li*Lr,Ll[2]=Lh*Lo+Li*Ls,Ll[3]=Lh*Lp+Li*Lt,Ll},Le.lerp=function(La,Lb,Lc,Ld){var Le=Ld.elements,Lf=La.elements,Lg=Lb.elements,Lh=Lf[0],Li=Lf[1],Lj=Lf[2],Lk=Lf[3];Le[0]=Lh+Lc*(Lg[0]-Lh),Le[1]=Li+Lc*(Lg[1]-Li),Le[2]=Lj+Lc*(Lg[2]-Lj),Le[3]=Lk+Lc*(Lg[3]-Lk)},Le.add=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]+Lf[0],Ld[1]=Le[1]+Lf[1],Ld[2]=Le[2]+Lf[2],Ld[3]=Le[3]+Lf[3]},Le.dot=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;return Lc[0]*Ld[0]+Lc[1]*Ld[1]+Lc[2]*Ld[2]+Lc[3]*Ld[3]},Le.rotationLookAt=function(La,Lb,Lc){Le.lookAt(Lgb.ZERO,La,Lb,Lc)},Le.lookAt=function(La,Lb,Lc,Ld){Lxa.lookAt(La,Lb,Lc,Le._tempMatrix3x3),Le.rotationMatrix(Le._tempMatrix3x3,Ld)},Le.invert=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=La.lengthSquared();Lwa.isZero(Le)||(Le=1/Le,Ld[0]=-Lc[0]*Le,Ld[1]=-Lc[1]*Le,Ld[2]=-Lc[2]*Le,Ld[3]=Lc[3]*Le)},Le.rotationMatrix=function(La,Lb){var Lc=La.elements,Ld=Lc[0],Le=Lc[1],Lf=Lc[2],Lg=Lc[3],Lh=Lc[4],Li=Lc[5],Lj=Lc[6],Lk=Lc[7],Ll=Lc[8],Lm=Lb.elements,Ln=NaN,Lo=NaN,Lp=Ld+Lh+Ll;0<Lp?(Ln=Math.sqrt(Lp+1),Lm[3]=.5*Ln,Ln=.5/Ln,Lm[0]=(Li-Lk)*Ln,Lm[1]=(Lj-Lf)*Ln,Lm[2]=(Le-Lg)*Ln):Lh<=Ld&&Ll<=Ld?(Lo=.5/(Ln=Math.sqrt(1+Ld-Lh-Ll)),Lm[0]=.5*Ln,Lm[1]=(Le+Lg)*Lo,Lm[2]=(Lf+Lj)*Lo,Lm[3]=(Li-Lk)*Lo):Ll<Lh?(Lo=.5/(Ln=Math.sqrt(1+Lh-Ld-Ll)),Lm[0]=(Lg+Le)*Lo,Lm[1]=.5*Ln,Lm[2]=(Lk+Li)*Lo,Lm[3]=(Lj-Lf)*Lo):(Lo=.5/(Ln=Math.sqrt(1+Ll-Ld-Lh)),Lm[0]=(Lj+Lf)*Lo,Lm[1]=(Lk+Li)*Lo,Lm[2]=.5*Ln,Lm[3]=(Le-Lg)*Lo)},Le.DEFAULT=new Le,Ll(Le,["TEMPVector30",function(){return this.TEMPVector30=new Lgb},"TEMPVector31",function(){return this.TEMPVector31=new Lgb},"TEMPVector32",function(){return this.TEMPVector32=new Lgb},"TEMPVector33",function(){return this.TEMPVector33=new Lgb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Lab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Lab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Lxa},"NAN",function(){return this.NAN=new Le(NaN,NaN,NaN,NaN)}]),Le}(),Ldb=function(){function La(La){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=La,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Ln(La,"laya.d3.math.Rand");var Lb=La.prototype;return Lb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Lb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Lb.getSignedFloat=function(){return 2*this.getFloat()-1},Lo(0,Lb,"seed",function(){return this.seeds[0]},function(La){this.seeds[0]=La,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),La.getFloatFromInt=function(La){return 1/8388607*(8388607&La)},La.getByteFromInt=function(La){return(8388607&La)>>>15},La}(),Leb=(function(){function Le(La){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(La instanceof Array)||4!==La.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|La[0],this._state0L=0|La[1],this._state1U=0|La[2],this._state1L=0|La[3]}Ln(Le,"laya.d3.math.RandX");var La=Le.prototype;La.randomint=function(){var La=this._state0U,Lb=this._state0L,Lc=this._state1U,Ld=this._state1L,Le=(Ld>>>0)+(Lb>>>0),Lf=Lc+La+(Le/2>>>31)>>>0,Lg=Le>>>0,Lh=0,Li=0;Lh=(La^=Lh=La<<23|(-512&Lb)>>>9)^(this._state0U=Lc),Li=(Lb^=Li=Lb<<23)^(this._state0L=Ld);Lh^=La>>>18,Li^=Lb>>>18|(262143&La)<<14;return Lh^=Lc>>>5,Li^=Ld>>>5|(31&Lc)<<27,this._state1U=Lh,this._state1L=Li,[Lf,Lg]},La.random=function(){var La=this.randomint(),Lb=La[0],Lc=1023<<20|Lb>>>12,Ld=0|(La[1]>>>12|(4095&Lb)<<20);return Le._CONVERTION_BUFFER.setUint32(0,Lc,!1),Le._CONVERTION_BUFFER.setUint32(4,Ld,!1),Ldb._CONVERTION_BUFFER.getFloat64(0,!1)-1},Ll(Le,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Ldb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function La(La,Lb){this.origin=null,this.direction=null,this.origin=La,this.direction=Lb}return Ln(La,"laya.d3.math.Ray"),La}()),Lfb=function(){function La(La,Lb){this.elements=new Float32Array(2),void 0===La&&(La=0),void 0===Lb&&(Lb=0);var Lc=this.elements;Lc[0]=La,Lc[1]=Lb}Ln(La,"laya.d3.math.Vector2");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.fromArray=function(La,Lb){void 0===Lb&&(Lb=0),this.elements[0]=La[Lb+0],this.elements[1]=La[Lb+1]},Lb.cloneTo=function(La){var Lb=La.elements,Lc=this.elements;Lb[0]=Lc[0],Lb[1]=Lc[1]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"x",function(){return this.elements[0]},function(La){this.elements[0]=La}),Lo(0,Lb,"y",function(){return this.elements[1]},function(La){this.elements[1]=La}),La.scale=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements;Ld[0]=Le[0]*Lb,Ld[1]=Le[1]*Lb},Ll(La,["ZERO",function(){return this.ZERO=new La(0,0)},"ONE",function(){return this.ONE=new La(1,1)}]),La}(),Lgb=function(){function Lk(La,Lb,Lc){this.elements=new Float32Array(3),void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0);var Ld=this.elements;Ld[0]=La,Ld[1]=Lb,Ld[2]=Lc}Ln(Lk,"laya.d3.math.Vector3");var La=Lk.prototype;return Lv.imps(La,{"laya.d3.core.IClone":!0}),La.fromArray=function(La,Lb){void 0===Lb&&(Lb=0),this.elements[0]=La[Lb+0],this.elements[1]=La[Lb+1],this.elements[2]=La[Lb+2]},La.cloneTo=function(La){var Lb=La.elements,Lc=this.elements;Lb[0]=Lc[0],Lb[1]=Lc[1],Lb[2]=Lc[2]},La.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},La.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},La.reset=function(La,Lb,Lc){this.elements[0]=La,this.elements[1]=Lb,this.elements[2]=Lc},Lo(0,La,"x",function(){return this.elements[0]},function(La){this.elements[0]=La}),Lo(0,La,"y",function(){return this.elements[1]},function(La){this.elements[1]=La}),Lo(0,La,"z",function(){return this.elements[2]},function(La){this.elements[2]=La}),Lk.distanceSquared=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0]-Ld[0],Lf=Lc[1]-Ld[1],Lg=Lc[2]-Ld[2];return Le*Le+Lf*Lf+Lg*Lg},Lk.distance=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0]-Ld[0],Lf=Lc[1]-Ld[1],Lg=Lc[2]-Ld[2];return Math.sqrt(Le*Le+Lf*Lf+Lg*Lg)},Lk.min=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Math.min(Le[0],Lf[0]),Ld[1]=Math.min(Le[1],Lf[1]),Ld[2]=Math.min(Le[2],Lf[2])},Lk.max=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Math.max(Le[0],Lf[0]),Ld[1]=Math.max(Le[1],Lf[1]),Ld[2]=Math.max(Le[2],Lf[2])},Lk.transformQuat=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements,Lg=Le[0],Lh=Le[1],Li=Le[2],Lj=Lf[0],Lk=Lf[1],Ll=Lf[2],Lm=Lf[3],Ln=Lm*Lg+Lk*Li-Ll*Lh,Lo=Lm*Lh+Ll*Lg-Lj*Li,Lp=Lm*Li+Lj*Lh-Lk*Lg,Lq=-Lj*Lg-Lk*Lh-Ll*Li;Ld[0]=Ln*Lm+Lq*-Lj+Lo*-Ll-Lp*-Lk,Ld[1]=Lo*Lm+Lq*-Lk+Lp*-Lj-Ln*-Ll,Ld[2]=Lp*Lm+Lq*-Ll+Ln*-Lk-Lo*-Lj},Lk.scalarLength=function(La){var Lb=La.elements,Lc=Lb[0],Ld=Lb[1],Le=Lb[2];return Math.sqrt(Lc*Lc+Ld*Ld+Le*Le)},Lk.scalarLengthSquared=function(La){var Lb=La.elements,Lc=Lb[0],Ld=Lb[1],Le=Lb[2];return Lc*Lc+Ld*Ld+Le*Le},Lk.normalize=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0],Lf=Lc[1],Lg=Lc[2],Lh=Le*Le+Lf*Lf+Lg*Lg;0<Lh&&(Lh=1/Math.sqrt(Lh),Ld[0]=Lc[0]*Lh,Ld[1]=Lc[1]*Lh,Ld[2]=Lc[2]*Lh)},Lk.multiply=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]*Lf[0],Ld[1]=Le[1]*Lf[1],Ld[2]=Le[2]*Lf[2]},Lk.scale=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements;Ld[0]=Le[0]*Lb,Ld[1]=Le[1]*Lb,Ld[2]=Le[2]*Lb},Lk.lerp=function(La,Lb,Lc,Ld){var Le=Ld.elements,Lf=La.elements,Lg=Lb.elements,Lh=Lf[0],Li=Lf[1],Lj=Lf[2];Le[0]=Lh+Lc*(Lg[0]-Lh),Le[1]=Li+Lc*(Lg[1]-Li),Le[2]=Lj+Lc*(Lg[2]-Lj)},Lk.transformV3ToV3=function(La,Lb,Lc){var Ld=Lk._tempVector4;Lk.transformV3ToV4(La,Lb,Ld);var Le=Ld.elements,Lf=Lc.elements;Lf[0]=Le[0],Lf[1]=Le[1],Lf[2]=Le[2]},Lk.transformV3ToV4=function(La,Lb,Lc){var Ld=La.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Lb.elements,Li=Lc.elements;Li[0]=Le*Lh[0]+Lf*Lh[4]+Lg*Lh[8]+Lh[12],Li[1]=Le*Lh[1]+Lf*Lh[5]+Lg*Lh[9]+Lh[13],Li[2]=Le*Lh[2]+Lf*Lh[6]+Lg*Lh[10]+Lh[14],Li[3]=Le*Lh[3]+Lf*Lh[7]+Lg*Lh[11]+Lh[15]},Lk.TransformNormal=function(La,Lb,Lc){var Ld=La.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Lb.elements,Li=Lc.elements;Li[0]=Le*Lh[0]+Lf*Lh[4]+Lg*Lh[8],Li[1]=Le*Lh[1]+Lf*Lh[5]+Lg*Lh[9],Li[2]=Le*Lh[2]+Lf*Lh[6]+Lg*Lh[10]},Lk.transformCoordinate=function(La,Lb,Lc){var Ld=Lk._tempVector4.elements,Le=La.elements,Lf=Le[0],Lg=Le[1],Lh=Le[2],Li=Lb.elements;Ld[0]=Lf*Li[0]+Lg*Li[4]+Lh*Li[8]+Li[12],Ld[1]=Lf*Li[1]+Lg*Li[5]+Lh*Li[9]+Li[13],Ld[2]=Lf*Li[2]+Lg*Li[6]+Lh*Li[10]+Li[14],Ld[3]=1/(Lf*Li[3]+Lg*Li[7]+Lh*Li[11]+Li[15]);var Lj=Lc.elements;Lj[0]=Ld[0]*Ld[3],Lj[1]=Ld[1]*Ld[3],Lj[2]=Ld[2]*Ld[3]},Lk.Clamp=function(La,Lb,Lc,Ld){var Le=La.elements,Lf=Le[0],Lg=Le[1],Lh=Le[2],Li=Lb.elements,Lj=Li[0],Lk=Li[1],Ll=Li[2],Lm=Lc.elements,Ln=Lm[0],Lo=Lm[1],Lp=Lm[2],Lq=Ld.elements;Lf=(Lf=Ln<Lf?Ln:Lf)<Lj?Lj:Lf,Lg=(Lg=Lo<Lg?Lo:Lg)<Lk?Lk:Lg,Lh=(Lh=Lp<Lh?Lp:Lh)<Ll?Ll:Lh,Lq[0]=Lf,Lq[1]=Lg,Lq[2]=Lh},Lk.add=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]+Lf[0],Ld[1]=Le[1]+Lf[1],Ld[2]=Le[2]+Lf[2]},Lk.subtract=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]-Lf[0],Ld[1]=Le[1]-Lf[1],Ld[2]=Le[2]-Lf[2]},Lk.cross=function(La,Lb,Lc){var Ld=La.elements,Le=Lb.elements,Lf=Lc.elements,Lg=Ld[0],Lh=Ld[1],Li=Ld[2],Lj=Le[0],Lk=Le[1],Ll=Le[2];Lf[0]=Lh*Ll-Li*Lk,Lf[1]=Li*Lj-Lg*Ll,Lf[2]=Lg*Lk-Lh*Lj},Lk.dot=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;return Lc[0]*Ld[0]+Lc[1]*Ld[1]+Lc[2]*Ld[2]},Lk.equals=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;return Lwa.nearEqual(Math.abs(Lc[0]),Math.abs(Ld[0]))&&Lwa.nearEqual(Math.abs(Lc[1]),Math.abs(Ld[1]))&&Lwa.nearEqual(Math.abs(Lc[2]),Math.abs(Ld[2]))},Lk.ZERO=new Lk(0,0,0),Lk.ONE=new Lk(1,1,1),Lk.NegativeUnitX=new Lk(-1,0,0),Lk.UnitX=new Lk(1,0,0),Lk.UnitY=new Lk(0,1,0),Lk.UnitZ=new Lk(0,0,1),Lk.ForwardRH=new Lk(0,0,-1),Lk.ForwardLH=new Lk(0,0,1),Lk.Up=new Lk(0,1,0),Lk.NAN=new Lk(NaN,NaN,NaN),Ll(Lk,["_tempVector4",function(){return this._tempVector4=new Lhb}]),Lk}(),Lhb=function(){function La(La,Lb,Lc,Ld){this.elements=new Float32Array(4),void 0===La&&(La=0),void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=0);var Le=this.elements;Le[0]=La,Le[1]=Lb,Le[2]=Lc,Le[3]=Ld}Ln(La,"laya.d3.math.Vector4");var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb.fromArray=function(La,Lb){void 0===Lb&&(Lb=0),this.elements[0]=La[Lb+0],this.elements[1]=La[Lb+1],this.elements[2]=La[Lb+2],this.elements[3]=La[Lb+3]},Lb.cloneTo=function(La){var Lb=La.elements,Lc=this.elements;Lb[0]=Lc[0],Lb[1]=Lc[1],Lb[2]=Lc[2],Lb[3]=Lc[3]},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Lb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},Lo(0,Lb,"x",function(){return this.elements[0]},function(La){this.elements[0]=La}),Lo(0,Lb,"y",function(){return this.elements[1]},function(La){this.elements[1]=La}),Lo(0,Lb,"z",function(){return this.elements[2]},function(La){this.elements[2]=La}),Lo(0,Lb,"w",function(){return this.elements[3]},function(La){this.elements[3]=La}),La.lerp=function(La,Lb,Lc,Ld){var Le=Ld.elements,Lf=La.elements,Lg=Lb.elements,Lh=Lf[0],Li=Lf[1],Lj=Lf[2],Lk=Lf[3];Le[0]=Lh+Lc*(Lg[0]-Lh),Le[1]=Li+Lc*(Lg[1]-Li),Le[2]=Lj+Lc*(Lg[2]-Lj),Le[3]=Lk+Lc*(Lg[3]-Lk)},La.transformByM4x4=function(La,Lb,Lc){var Ld=La.elements,Le=Ld[0],Lf=Ld[1],Lg=Ld[2],Lh=Ld[3],Li=Lb.elements,Lj=Lc.elements;Lj[0]=Le*Li[0]+Lf*Li[4]+Lg*Li[8]+Lh*Li[12],Lj[1]=Le*Li[1]+Lf*Li[5]+Lg*Li[9]+Lh*Li[13],Lj[2]=Le*Li[2]+Lf*Li[6]+Lg*Li[10]+Lh*Li[14],Lj[3]=Le*Li[3]+Lf*Li[7]+Lg*Li[11]+Lh*Li[15]},La.equals=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;return Lwa.nearEqual(Math.abs(Lc[0]),Math.abs(Ld[0]))&&Lwa.nearEqual(Math.abs(Lc[1]),Math.abs(Ld[1]))&&Lwa.nearEqual(Math.abs(Lc[2]),Math.abs(Ld[2]))&&Lwa.nearEqual(Math.abs(Lc[3]),Math.abs(Ld[3]))},La.normalize=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=La.length();0<Le&&(Ld[0]=Lc[0]*Le,Ld[1]=Lc[1]*Le,Ld[2]=Lc[2]*Le,Ld[3]=Lc[3]*Le)},La.add=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]+Lf[0],Ld[1]=Le[1]+Lf[1],Ld[2]=Le[2]+Lf[2],Ld[3]=Le[3]+Lf[3]},La.subtract=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]-Lf[0],Ld[1]=Le[1]-Lf[1],Ld[2]=Le[2]-Lf[2],Ld[3]=Le[3]-Lf[3]},La.multiply=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Le[0]*Lf[0],Ld[1]=Le[1]*Lf[1],Ld[2]=Le[2]*Lf[2],Ld[3]=Le[3]*Lf[3]},La.scale=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements;Ld[0]=Le[0]*Lb,Ld[1]=Le[1]*Lb,Ld[2]=Le[2]*Lb,Ld[3]=Le[3]*Lb},La.Clamp=function(La,Lb,Lc,Ld){var Le=La.elements,Lf=Le[0],Lg=Le[1],Lh=Le[2],Li=Le[3],Lj=Lb.elements,Lk=Lj[0],Ll=Lj[1],Lm=Lj[2],Ln=Lj[3],Lo=Lc.elements,Lp=Lo[0],Lq=Lo[1],Lr=Lo[2],Ls=Lo[3],Lt=Ld.elements;Lf=(Lf=Lp<Lf?Lp:Lf)<Lk?Lk:Lf,Lg=(Lg=Lq<Lg?Lq:Lg)<Ll?Ll:Lg,Lh=(Lh=Lr<Lh?Lr:Lh)<Lm?Lm:Lh,Li=(Li=Ls<Li?Ls:Li)<Ln?Ln:Li,Lt[0]=Lf,Lt[1]=Lg,Lt[2]=Lh,Lt[3]=Li},La.distanceSquared=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0]-Ld[0],Lf=Lc[1]-Ld[1],Lg=Lc[2]-Ld[2],Lh=Lc[3]-Ld[3];return Le*Le+Lf*Lf+Lg*Lg+Lh*Lh},La.distance=function(La,Lb){var Lc=La.elements,Ld=Lb.elements,Le=Lc[0]-Ld[0],Lf=Lc[1]-Ld[1],Lg=Lc[2]-Ld[2],Lh=Lc[3]-Ld[3];return Math.sqrt(Le*Le+Lf*Lf+Lg*Lg+Lh*Lh)},La.dot=function(La,Lb){var Lc=La.elements,Ld=Lb.elements;return Lc[0]*Ld[0]+Lc[1]*Ld[1]+Lc[2]*Ld[2]+Lc[3]*Ld[3]},La.min=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Math.min(Le[0],Lf[0]),Ld[1]=Math.min(Le[1],Lf[1]),Ld[2]=Math.min(Le[2],Lf[2]),Ld[3]=Math.min(Le[3],Lf[3])},La.max=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb.elements;Ld[0]=Math.max(Le[0],Lf[0]),Ld[1]=Math.max(Le[1],Lf[1]),Ld[2]=Math.max(Le[2],Lf[2]),Ld[3]=Math.max(Le[3],Lf[3])},Ll(La,["ZERO",function(){return this.ZERO=new La},"ONE",function(){return this.ONE=new La(1,1,1,1)},"UnitX",function(){return this.UnitX=new La(1,0,0,0)},"UnitY",function(){return this.UnitY=new La(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new La(0,0,1,0)},"UnitW",function(){return this.UnitW=new La(0,0,0,1)}]),La}(),Lib=function(){function Lf(La,Lb,Lc,Ld){this.minDepth=0,this.maxDepth=1,this.x=La,this.y=Lb,this.width=Lc,this.height=Ld}Ln(Lf,"laya.d3.math.Viewport");var La=Lf.prototype;return La.project=function(La,Lb,Lc){Lgb.transformV3ToV3(La,Lb,Lc);var Ld=La.elements,Le=Lb.elements,Lf=Lc.elements,Lg=Ld[0]*Le[3]+Ld[1]*Le[7]+Ld[2]*Le[11]+Le[15];1!==Lg&&(Lf[0]=Lf[0]/Lg,Lf[1]=Lf[1]/Lg,Lf[2]=Lf[2]/Lg),Lf[0]=.5*(Lf[0]+1)*this.width+this.x,Lf[1]=.5*(1-Lf[1])*this.height+this.y,Lf[2]=Lf[2]*(this.maxDepth-this.minDepth)+this.minDepth},La.unprojectFromMat=function(La,Lb,Lc){var Ld=La.elements,Le=Lb.elements,Lf=Lc.elements;Lf[0]=(Ld[0]-this.x)/this.width*2-1,Lf[1]=-((Ld[1]-this.y)/this.height*2-1);var Lg=(this.maxDepth-this.minDepth)/2;Lf[2]=(Ld[2]-this.minDepth-Lg)/Lg;var Lh=Lf[0]*Le[3]+Lf[1]*Le[7]+Lf[2]*Le[11]+Le[15];Lgb.transformV3ToV3(Lc,Lb,Lc),1!==Lh&&(Lf[0]=Lf[0]/Lh,Lf[1]=Lf[1]/Lh,Lf[2]=Lf[2]/Lh)},La.unprojectFromWVP=function(La,Lb,Lc,Ld,Le){Lab.multiply(Lb,Lc,Lf._tempMatrix4x4),Ld&&Lab.multiply(Lf._tempMatrix4x4,Ld,Lf._tempMatrix4x4),Lf._tempMatrix4x4.invert(Lf._tempMatrix4x4),this.unprojectFromMat(La,Lf._tempMatrix4x4,Le)},Ll(Lf,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Lab}]),Lf}(),Ljb=function(){function LE(La){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=La,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Ln(LE,"laya.d3.resource.models.SubMesh");var La=LE.prototype;return Lv.imps(La,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),La._getVertexBuffer=function(La){return void 0===La&&(La=0),0===La?this._vertexBuffer:null},La._getIndexBuffer=function(){return this._indexBuffer},La._getStaticBatchBakedVertexs=function(La,Lb){var Lc,Ld,Le=this._vertexBuffer,Lf=Le.vertexDeclaration,Lg=Lf.getVertexElementByUsage(0).offset/4,Lh=Lf.getVertexElementByUsage(3).offset/4,Li=Lb.meshRender.lightmapScaleOffset,Lj=0,Lk=0,Ll=0,Lm=0,Ln=0,Lo=0;if(Li)if(Ld=Lf.getVertexElementByUsage(15))Ll=Lf.vertexStride/4,Lc=0<this._vertexCount?Le.getData().slice(this._vertexStart*Ll,(this._vertexStart+this._vertexCount)*Ll):Le.getData().slice(),Lm=Ld.offset/4;else{Ll=(Lo=Lf.vertexStride/4)+2,Lc=this._vertexCount?new Float32Array(this._vertexCount*(Le.vertexDeclaration.vertexStride/4+2)):new Float32Array(Le.vertexCount*(Le.vertexDeclaration.vertexStride/4+2)),Lm=(Ln=Lf.getVertexElementByUsage(2).offset/4)+2;var Lp=Le.getData();for(Lj=0,Lk=Lp.length/Lo;Lj<Lk;Lj++){var Lq=0;Lq=0<this._vertexCount?(this._vertexStart+Lj)*Lo:Lj*Lo;var Lr=Lj*Ll,Ls=0;for(Ls=0;Ls<Lm;Ls++)Lc[Lr+Ls]=Lp[Lq+Ls];for(Ls=Lm;Ls<Lo;Ls++)Lc[Lr+Ls+2]=Lp[Lq+Ls]}}else Ll=Lf.vertexStride/4,Lc=this._vertexCount?Le.getData().slice(this._vertexStart*Ll,(this._vertexStart+this._vertexCount)*Ll):Le.getData().slice();if(La){var Lt=La.worldMatrix,Lu=LE._tempMatrix4x40;Lt.invert(Lu);var Lv=LE._tempMatrix4x41,Ly=Lb.transform.worldMatrix;Lab.multiply(Lu,Ly,Lv)}else Lv=Lb.transform.worldMatrix;var Lz=LE._tempQuaternion0;for(Lv.decomposeTransRotScale(LE._tempVector30,Lz,LE._tempVector31),Lj=0,Lk=Lc.length/Ll;Lj<Lk;Lj++){var LA=Lj*Ll+Lg,LB=Lj*Ll+Lh;if(Lqb.transformVector3ArrayToVector3ArrayCoordinate(Lc,LA,Lv,Lc,LA),Lqb.transformVector3ArrayByQuat(Lc,LB,Lz,Lc,LB),Li){var LC=Lj*Ll+Lm;if(Ld)Lqb.transformLightingMapTexcoordByUV1Array(Lc,LC,Li,Lc,LC);else{var LD=Lj*Lo+Ln;Lqb.transformLightingMapTexcoordByUV0Array(Lp,LD,Li,Lc,LC)}}}return Lc},La._getVertexBuffers=function(){return null},La._beforeRender=function(La){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},La._render=function(La){var Lb,Lc=0,Ld=La.renderElement;if(1<this._indexCount){var Le=this._boneIndicesList.length;if(1<Le){for(var Lf=0;Lf<Le;Lf++)(Lb=Ld._skinAnimationDatas||this._skinAnimationDatas)&&(Ld._shaderValue.setValue(0,Lb[Lf]),La._shader.uploadRenderElementUniforms(Ld._shaderValue.data)),LF.mainContext.drawElements(4,this._subIndexBufferCount[Lf],5123,2*this._subIndexBufferStart[Lf]);LA.drawCall+=Le}else(Lb=Ld._skinAnimationDatas||this._skinAnimationDatas)&&(Ld._shaderValue.setValue(0,Lb[0]),La._shader.uploadRenderElementUniforms(Ld._shaderValue.data)),LF.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),LA.drawCall++;Lc=this._indexCount}else Lc=this._indexBuffer.indexCount,(Lb=Ld._skinAnimationDatas||this._skinAnimationDatas)&&(Ld._shaderValue.setValue(0,Lb[0]),La._shader.uploadRenderElementUniforms(Ld._shaderValue.data)),LF.mainContext.drawElements(4,Lc,5123,0),LA.drawCall++;LA.trianglesFaces+=Lc/3},La.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},La.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},Lo(0,La,"_vertexBufferCount",function(){return 1}),Lo(0,La,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Ll(LE,["_tempVector30",function(){return this._tempVector30=new Lgb},"_tempVector31",function(){return this._tempVector31=new Lgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Lcb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Lab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Lab}]),LE}(),Lkb=function(){function La(La){this.defineCounter=0,this.defines=null,La?(this.defineCounter=La.defineCounter,this.defines=La.defines.slice()):(this.defineCounter=0,this.defines=[])}return Ln(La,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),La.prototype.registerDefine=function(La){var Lb=Math.pow(2,this.defineCounter++);return this.defines[Lb]=La,Lb},La}(),Llb=function(){function La(){}return Ln(La,"laya.d3.shader.ShaderInit3D"),La.__init__=function(){var La,Lb;LAb._globalRegDefine("HIGHPRECISION",LAb.SHADERDEFINE_HIGHPRECISION),LAb._globalRegDefine("FOG",LAb.SHADERDEFINE_FOG),LAb._globalRegDefine("DIRECTIONLIGHT",LAb.SHADERDEFINE_DIRECTIONLIGHT),LAb._globalRegDefine("POINTLIGHT",LAb.SHADERDEFINE_POINTLIGHT),LAb._globalRegDefine("SPOTLIGHT",LAb.SHADERDEFINE_SPOTLIGHT),LAb._globalRegDefine("UV",LAb.SHADERDEFINE_UV0),LAb._globalRegDefine("COLOR",LAb.SHADERDEFINE_COLOR),LAb._globalRegDefine("UV1",LAb.SHADERDEFINE_UV1),LAb._globalRegDefine("CASTSHADOW",Lnb.SHADERDEFINE_CAST_SHADOW),LAb._globalRegDefine("SHADOWMAP_PSSM1",Lnb.SHADERDEFINE_SHADOW_PSSM1),LAb._globalRegDefine("SHADOWMAP_PSSM2",Lnb.SHADERDEFINE_SHADOW_PSSM2),LAb._globalRegDefine("SHADOWMAP_PSSM3",Lnb.SHADERDEFINE_SHADOW_PSSM3),LAb._globalRegDefine("SHADOWMAP_PCF_NO",Lnb.SHADERDEFINE_SHADOW_PCF_NO),LAb._globalRegDefine("SHADOWMAP_PCF1",Lnb.SHADERDEFINE_SHADOW_PCF1),LAb._globalRegDefine("SHADOWMAP_PCF2",Lnb.SHADERDEFINE_SHADOW_PCF2),LAb._globalRegDefine("SHADOWMAP_PCF3",Lnb.SHADERDEFINE_SHADOW_PCF3),LAb._globalRegDefine("DEPTHFOG",LAb.SAHDERDEFINE_DEPTHFOG),LLb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),LLb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),La={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Lb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var Lc=LLb.nameKey.add("SIMPLE");var Ld=LAb.add(Lc,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',La,Lb);LMb.SHADERDEFINE_DIFFUSEMAP=Ld.registerMaterialDefine("DIFFUSEMAP"),LMb.SHADERDEFINE_NORMALMAP=Ld.registerMaterialDefine("NORMALMAP"),LMb.SHADERDEFINE_SPECULARMAP=Ld.registerMaterialDefine("SPECULARMAP"),LMb.SHADERDEFINE_EMISSIVEMAP=Ld.registerMaterialDefine("EMISSIVEMAP"),LMb.SHADERDEFINE_AMBIENTMAP=Ld.registerMaterialDefine("AMBIENTMAP"),LMb.SHADERDEFINE_REFLECTMAP=Ld.registerMaterialDefine("REFLECTMAP"),LMb.SHADERDEFINE_UVTRANSFORM=Ld.registerMaterialDefine("UVTRANSFORM"),LMb.SHADERDEFINE_TILINGOFFSET=Ld.registerMaterialDefine("TILINGOFFSET"),LMb.SHADERDEFINE_ADDTIVEFOG=Ld.registerMaterialDefine("ADDTIVEFOG")},La}(),Lmb=function(){function La(){this._data=null,this._data=[]}Ln(La,"laya.d3.shader.ValusArray");var Lb=La.prototype;return Lb.setValue=function(La,Lb){this._data[La]=Lb},Lo(0,Lb,"data",function(){return this._data}),La}(),Lnb=function(){function La(){}return La.SHADERDEFINE_RECEIVE_SHADOW=1,La.SHADERDEFINE_CAST_SHADOW=512,La.SHADERDEFINE_SHADOW_PSSM1=1024,La.SHADERDEFINE_SHADOW_PSSM2=2048,La.SHADERDEFINE_SHADOW_PSSM3=4096,La.SHADERDEFINE_SHADOW_PCF_NO=8192,La.SHADERDEFINE_SHADOW_PCF1=16384,La.SHADERDEFINE_SHADOW_PCF2=32768,La.SHADERDEFINE_SHADOW_PCF3=65536,La.MAX_PSSM_COUNT=3,La}(),Lob=function(){function LX(){}return Ln(LX,"laya.d3.utils.Picker"),LX.calculateCursorRay=function(La,Lb,Lc,Ld,Le,Lf){var Lg=La.elements[0],Lh=La.elements[1],Li=LX._tempVector30,Lj=Li.elements;Lj[0]=Lg,Lj[1]=Lh,Lj[2]=Lb.minDepth;var Lk=LX._tempVector31,Ll=Lk.elements;Ll[0]=Lg,Ll[1]=Lh,Ll[2]=Lb.maxDepth;var Lm=Lf.origin,Ln=LX._tempVector32;Lb.unprojectFromWVP(Li,Lc,Ld,Le,Lm),Lb.unprojectFromWVP(Lk,Lc,Ld,Le,Ln);var Lo=Lf.direction.elements;Lo[0]=Ln.x-Lm.x,Lo[1]=Ln.y-Lm.y,Lo[2]=Ln.z-Lm.z,Lgb.normalize(Lf.direction,Lf.direction)},LX.rayIntersectsPositionsAndIndices=function(La,Lb,Lc,Ld,Le){for(var Lf=Lc.vertexStride/4,Lg=Lc.getVertexElementByUsage(0).offset/4,Lh=Number.MAX_VALUE,Li=-1,Lj=-1,Lk=-1,Ll=0;Ll<Ld.length;Ll+=3){var Lm=LX._tempVector35,Ln=Lm.elements,Lo=Ld[Ll]*Lf,Lp=Lo+Lg;Ln[0]=Lb[Lp],Ln[1]=Lb[1+Lp],Ln[2]=Lb[2+Lp];var Lq=LX._tempVector36,Lr=Lq.elements,Ls=Ld[Ll+1]*Lf,Lt=Ls+Lg;Lr[0]=Lb[Lt],Lr[1]=Lb[1+Lt],Lr[2]=Lb[2+Lt];var Lu=LX._tempVector37,Lv=Lu.elements,Ly=Ld[Ll+2]*Lf,Lz=Ly+Lg;Lv[0]=Lb[Lz],Lv[1]=Lb[1+Lz],Lv[2]=Lb[2+Lz];var LA=laya.d3.utils.Picker.rayIntersectsTriangle(La,Lm,Lq,Lu);!isNaN(LA)&&LA<Lh&&(Lh=LA,Li=Lo,Lj=Ls,Lk=Ly)}if(Lh===Number.MAX_VALUE)return Le.position.toDefault(),Le.distance=Number.MAX_VALUE,Le.trianglePositions[0].toDefault(),Le.trianglePositions[1].toDefault(),Le.trianglePositions[2].toDefault(),Le.triangleNormals[0].toDefault(),Le.triangleNormals[1].toDefault(),Le.triangleNormals[2].toDefault(),!1;Le.distance=Lh,Lgb.scale(La.direction,Lh,Le.position),Lgb.add(La.origin,Le.position,Le.position);var LB=Le.trianglePositions,LC=LB[0],LD=LB[1],LE=LB[2],LF=LC.elements,LG=LD.elements,LH=LE.elements,LI=Li+Lg;LF[0]=Lb[LI],LF[1]=Lb[LI+1],LF[2]=Lb[LI+2];var LJ=Lj+Lg;LG[0]=Lb[LJ],LG[1]=Lb[LJ+1],LG[2]=Lb[LJ+2];var LK=Lk+Lg;LH[0]=Lb[LK],LH[1]=Lb[LK+1],LH[2]=Lb[LK+2];var LL=Lc.getVertexElementByUsage(3);if(LL){var LM=LL.offset/4,LN=Le.triangleNormals,LO=LN[0],LP=LN[1],LQ=LN[2],LR=LO.elements,LS=LP.elements,LT=LQ.elements,LU=Li+LM;LR[0]=Lb[LU],LR[1]=Lb[LU+1],LR[2]=Lb[LU+2];var LV=Lj+LM;LS[0]=Lb[LV],LS[1]=Lb[LV+1],LS[2]=Lb[LV+2];var LW=Lk+LM;LT[0]=Lb[LW],LT[1]=Lb[LW+1],LT[2]=Lb[LW+2]}return!0},LX.rayIntersectsTriangle=function(La,Lb,Lc,Ld){var Le=LX._tempVector30,Lf=LX._tempVector31;Lgb.subtract(Lc,Lb,Le),Lgb.subtract(Ld,Lb,Lf);var Lg,Lh=LX._tempVector32;if(Lgb.cross(La.direction,Lf,Lh),(Lg=Lgb.dot(Le,Lh))>-Number.MIN_VALUE&&Lg<Number.MIN_VALUE)return Number.NaN;var Li,Lj=1/Lg,Lk=LX._tempVector33;if(Lgb.subtract(La.origin,Lb,Lk),Li=Lgb.dot(Lk,Lh),(Li*=Lj)<0||1<Li)return Number.NaN;var Ll,Lm,Ln=LX._tempVector34;return Lgb.cross(Lk,Le,Ln),Ll=Lgb.dot(La.direction,Ln),(Ll*=Lj)<0||1<Li+Ll?Number.NaN:(Lm=Lgb.dot(Lf,Ln),(Lm*=Lj)<0?Number.NaN:Lm)},Ll(LX,["_tempVector30",function(){return this._tempVector30=new Lgb},"_tempVector31",function(){return this._tempVector31=new Lgb},"_tempVector32",function(){return this._tempVector32=new Lgb},"_tempVector33",function(){return this._tempVector33=new Lgb},"_tempVector34",function(){return this._tempVector34=new Lgb},"_tempVector35",function(){return this._tempVector35=new Lgb},"_tempVector36",function(){return this._tempVector36=new Lgb},"_tempVector37",function(){return this._tempVector37=new Lgb}]),LX}(),Lpb=(function(){function La(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new Lgb,new Lgb,new Lgb],this.trianglePositions.length=3,this.triangleNormals=[new Lgb,new Lgb,new Lgb],this.triangleNormals.length=3,this.position=new Lgb}Ln(La,"laya.d3.utils.RaycastHit"),La.prototype.cloneTo=function(La){La.distance=this.distance,this.trianglePositions[0].cloneTo(La.trianglePositions[0]),this.trianglePositions[1].cloneTo(La.trianglePositions[1]),this.trianglePositions[2].cloneTo(La.trianglePositions[2]),this.triangleNormals[0].cloneTo(La.triangleNormals[0]),this.triangleNormals[1].cloneTo(La.triangleNormals[1]),this.triangleNormals[2].cloneTo(La.triangleNormals[2]),this.position.cloneTo(La.position),La.sprite3D=this.sprite3D}}(),function(){function La(La,Lb){this._width=0,this._height=0,this._width=La,this._height=Lb}Ln(La,"laya.d3.utils.Size");var Lb=La.prototype;return Lo(0,Lb,"width",function(){return-1===this._width?LY.clientWidth:this._width}),Lo(0,Lb,"height",function(){return-1===this._height?LY.clientHeight:this._height}),Lo(1,La,"fullScreen",function(){return new La(-1,-1)}),La}()),Lqb=function(){function LI(){}return Ln(LI,"laya.d3.utils.Utils3D"),LI._rotationTransformScaleSkinAnimation=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll){var Lm,Ln,Lo,Lp,Lq,Lr=LI._tempArray16_0,Ls=LI._tempArray16_1,Lt=LI._tempArray16_2,Lu=Ld+Ld,Lv=Le+Le,Ly=Lf+Lf,Lz=Ld*Lu,LA=Le*Lu,LB=Le*Lv,LC=Lf*Lu,LD=Lf*Lv,LE=Lf*Ly,LF=Lg*Lu,LG=Lg*Lv,LH=Lg*Ly;for(Lr[15]=1,Lr[0]=1-LB-LE,Lr[1]=LA+LH,Lr[2]=LC-LG,Lr[4]=LA-LH,Lr[5]=1-Lz-LE,Lr[6]=LD+LF,Lr[8]=LC+LG,Lr[9]=LD-LF,Lr[10]=1-Lz-LB,Ls[15]=1,Ls[0]=Lh,Ls[5]=Li,Ls[10]=Lj,Lm=0;Lm<4;Lm++)Ln=Lr[Lm],Lo=Lr[Lm+4],Lp=Lr[Lm+8],Lq=Lr[Lm+12],Lt[Lm]=Ln,Lt[Lm+4]=Lo,Lt[Lm+8]=Lp,Lt[Lm+12]=Ln*La+Lo*Lb+Lp*Lc+Lq;for(Lm=0;Lm<4;Lm++)Ln=Lt[Lm],Lo=Lt[Lm+4],Lp=Lt[Lm+8],Lq=Lt[Lm+12],Lk[Lm+Ll]=Ln*Ls[0]+Lo*Ls[1]+Lp*Ls[2]+Lq*Ls[3],Lk[Lm+Ll+4]=Ln*Ls[4]+Lo*Ls[5]+Lp*Ls[6]+Lq*Ls[7],Lk[Lm+Ll+8]=Ln*Ls[8]+Lo*Ls[9]+Lp*Ls[10]+Lq*Ls[11],Lk[Lm+Ll+12]=Ln*Ls[12]+Lo*Ls[13]+Lp*Ls[14]+Lq*Ls[15]},LI._createNodeByJson=function(La,Lb,Lc,Ld){if(!Lc)switch(Lb.type){case"Sprite3D":Lc=new LKb;break;case"MeshSprite3D":Lc=new LXb;break;case"SkinnedMeshSprite3D":Lc=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":Lc=new ShuriKenParticle3D;break;case"TrailSprite3D":Lc=new TrailSprite3D;break;case"Terrain":Lc=new Terrain;break;case"Camera":Lc=new LWb;break;case"DirectionLight":Lc=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var Le=Lb.props;if(Le)for(var Lf in Le)Lc[Lf]=Le[Lf];var Lg=Lb.customProps;Lg&&(Lc instanceof laya.d3.core.Sprite3D?(Lc._parseBaseCustomProps(Lg),Lc._parseCustomProps(La,Ld,Lg,Lb),Lc._parseCustomComponent(La,Ld,Lb.components)):Lc._parseCustomProps(La,Ld,Lg,Lb));var Lh=Lb.child;if(Lh)for(var Li=0,Lj=Lh.length;Li<Lj;Li++){var Lk=LI._createNodeByJson(La,Lh[Li],null,Ld);Lc.addChild(Lk)}return Lc},LI._computeBoneAndAnimationDatasByBindPoseMatrxix=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh,Li=0,Lj=0,Lk=La.length;for(Lg=0;Lg<Lk;Li+=La[Lg].keyframeWidth,Lj+=16,Lg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Lb[Li+0],Lb[Li+1],Lb[Li+2],Lb[Li+3],Lb[Li+4],Lb[Li+5],Lb[Li+6],Lb[Li+7],Lb[Li+8],Lb[Li+9],Ld,Lj),0!=Lg&&(Lh=16*La[Lg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Ld,Lh,Ld,Lj,Ld,Lj));var Ll=Lc.length;for(Lg=0;Lg<Ll;Lg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Ld,16*Lf[Lg],Lc[Lg],Le,16*Lg)},LI._computeAnimationDatasByArrayAndMatrixFast=function(La,Lb,Lc,Ld){for(var Le=0,Lf=La.length;Le<Lf;Le++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Lb,16*Ld[Le],La[Le],Lc,16*Le)},LI._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(La,Lb,Lc,Ld,Le){var Lf,Lg,Lh=0,Li=0,Lj=La.length;for(Lf=0;Lf<Lj;Lh+=La[Lf].keyframeWidth,Li+=16,Lf++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Lb[Lh+7],Lb[Lh+8],Lb[Lh+9],Lb[Lh+3],Lb[Lh+4],Lb[Lh+5],Lb[Lh+6],Lb[Lh+0],Lb[Lh+1],Lb[Lh+2],Ld,Li),0!=Lf&&(Lg=16*La[Lf].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Ld,Lg,Ld,Li,Ld,Li));var Lk=Lc.length;for(Lf=0;Lf<Lk;Lf++){var Ll=16*Lf;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Ld,Ll,Lc[Lf],Le,Ll)}},LI._computeAnimationDatasByArrayAndMatrixFastOld=function(La,Lb,Lc){for(var Ld=La.length,Le=0;Le<Ld;Le++){var Lf=16*Le;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Lb,Lf,La[Le],Lc,Lf)}},LI._computeRootAnimationData=function(La,Lb,Lc){for(var Ld=0,Le=0,Lf=0,Lg=La.length;Ld<Lg;Le+=La[Ld].keyframeWidth,Lf+=16,Ld++)laya.d3.utils.Utils3D.createAffineTransformationArray(Lb[Le+0],Lb[Le+1],Lb[Le+2],Lb[Le+3],Lb[Le+4],Lb[Le+5],Lb[Le+6],Lb[Le+7],Lb[Le+8],Lb[Le+9],Lc,Lf)},LI.transformVector3ArrayByQuat=function(La,Lb,Lc,Ld,Le){var Lf=Lc.elements,Lg=La[Lb],Lh=La[Lb+1],Li=La[Lb+2],Lj=Lf[0],Lk=Lf[1],Ll=Lf[2],Lm=Lf[3],Ln=Lm*Lg+Lk*Li-Ll*Lh,Lo=Lm*Lh+Ll*Lg-Lj*Li,Lp=Lm*Li+Lj*Lh-Lk*Lg,Lq=-Lj*Lg-Lk*Lh-Ll*Li;Ld[Le]=Ln*Lm+Lq*-Lj+Lo*-Ll-Lp*-Lk,Ld[Le+1]=Lo*Lm+Lq*-Lk+Lp*-Lj-Ln*-Ll,Ld[Le+2]=Lp*Lm+Lq*-Ll+Ln*-Lk-Lo*-Lj},LI.mulMatrixByArray=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh,Li,Lj,Lk;if(Le===Lc){for(Lc=LI._tempArray16_3,Lg=0;Lg<16;++Lg)Lc[Lg]=Le[Lf+Lg];Ld=0}for(Lg=0;Lg<4;Lg++)Lh=La[Lb+Lg],Li=La[Lb+Lg+4],Lj=La[Lb+Lg+8],Lk=La[Lb+Lg+12],Le[Lf+Lg]=Lh*Lc[Ld+0]+Li*Lc[Ld+1]+Lj*Lc[Ld+2]+Lk*Lc[Ld+3],Le[Lf+Lg+4]=Lh*Lc[Ld+4]+Li*Lc[Ld+5]+Lj*Lc[Ld+6]+Lk*Lc[Ld+7],Le[Lf+Lg+8]=Lh*Lc[Ld+8]+Li*Lc[Ld+9]+Lj*Lc[Ld+10]+Lk*Lc[Ld+11],Le[Lf+Lg+12]=Lh*Lc[Ld+12]+Li*Lc[Ld+13]+Lj*Lc[Ld+14]+Lk*Lc[Ld+15]},LI.mulMatrixByArrayFast=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh,Li,Lj,Lk;for(Lg=0;Lg<4;Lg++)Lh=La[Lb+Lg],Li=La[Lb+Lg+4],Lj=La[Lb+Lg+8],Lk=La[Lb+Lg+12],Le[Lf+Lg]=Lh*Lc[Ld+0]+Li*Lc[Ld+1]+Lj*Lc[Ld+2]+Lk*Lc[Ld+3],Le[Lf+Lg+4]=Lh*Lc[Ld+4]+Li*Lc[Ld+5]+Lj*Lc[Ld+6]+Lk*Lc[Ld+7],Le[Lf+Lg+8]=Lh*Lc[Ld+8]+Li*Lc[Ld+9]+Lj*Lc[Ld+10]+Lk*Lc[Ld+11],Le[Lf+Lg+12]=Lh*Lc[Ld+12]+Li*Lc[Ld+13]+Lj*Lc[Ld+14]+Lk*Lc[Ld+15]},LI.mulMatrixByArrayAndMatrixFast=function(La,Lb,Lc,Ld,Le){var Lf,Lg,Lh,Li,Lj,Lk=Lc.elements,Ll=Lk[0],Lm=Lk[1],Ln=Lk[2],Lo=Lk[3],Lp=Lk[4],Lq=Lk[5],Lr=Lk[6],Ls=Lk[7],Lt=Lk[8],Lu=Lk[9],Lv=Lk[10],Ly=Lk[11],Lz=Lk[12],LA=Lk[13],LB=Lk[14],LC=Lk[15],LD=Lb,LE=Lb+4,LF=Lb+8,LG=Lb+12,LH=Le,LI=Le+4,LJ=Le+8,LK=Le+12;for(Lf=0;Lf<4;Lf++)Lg=La[LD+Lf],Lh=La[LE+Lf],Li=La[LF+Lf],Lj=La[LG+Lf],Ld[LH+Lf]=Lg*Ll+Lh*Lm+Li*Ln+Lj*Lo,Ld[LI+Lf]=Lg*Lp+Lh*Lq+Li*Lr+Lj*Ls,Ld[LJ+Lf]=Lg*Lt+Lh*Lu+Li*Lv+Lj*Ly,Ld[LK+Lf]=Lg*Lz+Lh*LA+Li*LB+Lj*LC},LI.createAffineTransformationArray=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll){var Lm=Ld+Ld,Ln=Le+Le,Lo=Lf+Lf,Lp=Ld*Lm,Lq=Ld*Ln,Lr=Ld*Lo,Ls=Le*Ln,Lt=Le*Lo,Lu=Lf*Lo,Lv=Lg*Lm,Ly=Lg*Ln,Lz=Lg*Lo;Lk[Ll+0]=(1-(Ls+Lu))*Lh,Lk[Ll+1]=(Lq+Lz)*Lh,Lk[Ll+2]=(Lr-Ly)*Lh,Lk[Ll+3]=0,Lk[Ll+4]=(Lq-Lz)*Li,Lk[Ll+5]=(1-(Lp+Lu))*Li,Lk[Ll+6]=(Lt+Lv)*Li,Lk[Ll+7]=0,Lk[Ll+8]=(Lr+Ly)*Lj,Lk[Ll+9]=(Lt-Lv)*Lj,Lk[Ll+10]=(1-(Lp+Ls))*Lj,Lk[Ll+11]=0,Lk[Ll+12]=La,Lk[Ll+13]=Lb,Lk[Ll+14]=Lc,Lk[Ll+15]=1},LI.transformVector3ArrayToVector3ArrayCoordinate=function(La,Lb,Lc,Ld,Le){var Lf=LI._tempArray4_0,Lg=La[Lb+0],Lh=La[Lb+1],Li=La[Lb+2],Lj=Lc.elements;Lf[0]=Lg*Lj[0]+Lh*Lj[4]+Li*Lj[8]+Lj[12],Lf[1]=Lg*Lj[1]+Lh*Lj[5]+Li*Lj[9]+Lj[13],Lf[2]=Lg*Lj[2]+Lh*Lj[6]+Li*Lj[10]+Lj[14],Lf[3]=1/(Lg*Lj[3]+Lh*Lj[7]+Li*Lj[11]+Lj[15]),Ld[Le+0]=Lf[0]*Lf[3],Ld[Le+1]=Lf[1]*Lf[3],Ld[Le+2]=Lf[2]*Lf[3]},LI.transformLightingMapTexcoordByUV0Array=function(La,Lb,Lc,Ld,Le){var Lf=Lc.elements;Ld[Le+0]=La[Lb+0]*Lf[0]+Lf[2],Ld[Le+1]=(La[Lb+1]-1)*Lf[1]+Lf[3]},LI.transformLightingMapTexcoordByUV1Array=function(La,Lb,Lc,Ld,Le){var Lf=Lc.elements;Ld[Le+0]=La[Lb+0]*Lf[0]+Lf[2],Ld[Le+1]=1+La[Lb+1]*Lf[1]+Lf[3]},LI.getURLVerion=function(La){var Lb=La.indexOf("?");return 0<=Lb?La.substr(Lb):null},LI._quaternionCreateFromYawPitchRollArray=function(La,Lb,Lc,Ld){var Le=.5*Lc,Lf=.5*Lb,Lg=.5*La,Lh=Math.sin(Le),Li=Math.cos(Le),Lj=Math.sin(Lf),Lk=Math.cos(Lf),Ll=Math.sin(Lg),Lm=Math.cos(Lg);Ld[0]=Lm*Lj*Li+Ll*Lk*Lh,Ld[1]=Ll*Lk*Li-Lm*Lj*Lh,Ld[2]=Lm*Lk*Lh-Ll*Lj*Li,Ld[3]=Lm*Lk*Li+Ll*Lj*Lh},LI._createAffineTransformationArray=function(La,Lb,Lc,Ld){var Le=Lb[0],Lf=Lb[1],Lg=Lb[2],Lh=Lb[3],Li=Le+Le,Lj=Lf+Lf,Lk=Lg+Lg,Ll=Le*Li,Lm=Le*Lj,Ln=Le*Lk,Lo=Lf*Lj,Lp=Lf*Lk,Lq=Lg*Lk,Lr=Lh*Li,Ls=Lh*Lj,Lt=Lh*Lk,Lu=Lc[0],Lv=Lc[1],Ly=Lc[2];Ld[0]=(1-(Lo+Lq))*Lu,Ld[1]=(Lm+Lt)*Lu,Ld[2]=(Ln-Ls)*Lu,Ld[3]=0,Ld[4]=(Lm-Lt)*Lv,Ld[5]=(1-(Ll+Lq))*Lv,Ld[6]=(Lp+Lr)*Lv,Ld[7]=0,Ld[8]=(Ln+Ls)*Ly,Ld[9]=(Lp-Lr)*Ly,Ld[10]=(1-(Ll+Lo))*Ly,Ld[11]=0,Ld[12]=La[0],Ld[13]=La[1],Ld[14]=La[2],Ld[15]=1},LI._mulMatrixArray=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj=Lb.elements,Lk=Lj[0],Ll=Lj[1],Lm=Lj[2],Ln=Lj[3],Lo=Lj[4],Lp=Lj[5],Lq=Lj[6],Lr=Lj[7],Ls=Lj[8],Lt=Lj[9],Lu=Lj[10],Lv=Lj[11],Ly=Lj[12],Lz=Lj[13],LA=Lj[14],LB=Lj[15],LC=Ld,LD=Ld+4,LE=Ld+8,LF=Ld+12;for(Le=0;Le<4;Le++)Lf=La[Le],Lg=La[Le+4],Lh=La[Le+8],Li=La[Le+12],Lc[LC+Le]=Lf*Lk+Lg*Ll+Lh*Lm+Li*Ln,Lc[LD+Le]=Lf*Lo+Lg*Lp+Lh*Lq+Li*Lr,Lc[LE+Le]=Lf*Ls+Lg*Lt+Lh*Lu+Li*Lv,Lc[LF+Le]=Lf*Ly+Lg*Lz+Lh*LA+Li*LB},LI.getYawPitchRoll=function(La,Lb){LI.transformQuat(Lgb.ForwardRH,La,Lcb.TEMPVector31),LI.transformQuat(Lgb.Up,La,Lcb.TEMPVector32);var Lc=Lcb.TEMPVector32.elements;LI.angleTo(Lgb.ZERO,Lcb.TEMPVector31,Lcb.TEMPVector33);var Ld=Lcb.TEMPVector33.elements;Ld[0]==Math.PI/2?(Ld[1]=LI.arcTanAngle(Lc[2],Lc[0]),Ld[2]=0):Ld[0]==-Math.PI/2?(Ld[1]=LI.arcTanAngle(-Lc[2],-Lc[0]),Ld[2]=0):(Lab.createRotationY(-Ld[1],Lcb.TEMPMatrix0),Lab.createRotationX(-Ld[0],Lcb.TEMPMatrix1),Lgb.transformCoordinate(Lcb.TEMPVector32,Lcb.TEMPMatrix0,Lcb.TEMPVector32),Lgb.transformCoordinate(Lcb.TEMPVector32,Lcb.TEMPMatrix1,Lcb.TEMPVector32),Ld[2]=LI.arcTanAngle(Lc[1],-Lc[0])),Ld[1]<=-Math.PI&&(Ld[1]=Math.PI),Ld[2]<=-Math.PI&&(Ld[2]=Math.PI),Ld[1]>=Math.PI&&Ld[2]>=Math.PI&&(Ld[1]=0,Ld[2]=0,Ld[0]=Math.PI-Ld[0]),Lb[0]=Ld[1],Lb[1]=Ld[0],Lb[2]=Ld[2]},LI.arcTanAngle=function(La,Lb){return 0==La?1==Lb?Math.PI/2:-Math.PI/2:0<La?Math.atan(Lb/La):La<0?0<Lb?Math.atan(Lb/La)+Math.PI:Math.atan(Lb/La)-Math.PI:0},LI.angleTo=function(La,Lb,Lc){Lgb.subtract(Lb,La,Lcb.TEMPVector30),Lgb.normalize(Lcb.TEMPVector30,Lcb.TEMPVector30),Lc.elements[0]=Math.asin(Lcb.TEMPVector30.y),Lc.elements[1]=LI.arcTanAngle(-Lcb.TEMPVector30.z,-Lcb.TEMPVector30.x)},LI.transformQuat=function(La,Lb,Lc){var Ld=Lc.elements,Le=La.elements,Lf=Lb,Lg=Le[0],Lh=Le[1],Li=Le[2],Lj=Lf[0],Lk=Lf[1],Ll=Lf[2],Lm=Lf[3],Ln=Lm*Lg+Lk*Li-Ll*Lh,Lo=Lm*Lh+Ll*Lg-Lj*Li,Lp=Lm*Li+Lj*Lh-Lk*Lg,Lq=-Lj*Lg-Lk*Lh-Ll*Li;Ld[0]=Ln*Lm+Lq*-Lj+Lo*-Ll-Lp*-Lk,Ld[1]=Lo*Lm+Lq*-Lk+Lp*-Lj-Ln*-Ll,Ld[2]=Lp*Lm+Lq*-Ll+Ln*-Lk-Lo*-Lj},LI.quaterionNormalize=function(La,Lb){var Lc=La[0],Ld=La[1],Le=La[2],Lf=La[3],Lg=Lc*Lc+Ld*Ld+Le*Le+Lf*Lf;0<Lg&&(Lg=1/Math.sqrt(Lg),Lb[0]=Lc*Lg,Lb[1]=Ld*Lg,Lb[2]=Le*Lg,Lb[3]=Lf*Lg)},LI.matrix4x4MultiplyFFF=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh;if(Lc===Lb)for(Lb=new Float32Array(16),Ld=0;Ld<16;++Ld)Lb[Ld]=Lc[Ld];for(Ld=0;Ld<4;Ld++)Le=La[Ld],Lf=La[Ld+4],Lg=La[Ld+8],Lh=La[Ld+12],Lc[Ld]=Le*Lb[0]+Lf*Lb[1]+Lg*Lb[2]+Lh*Lb[3],Lc[Ld+4]=Le*Lb[4]+Lf*Lb[5]+Lg*Lb[6]+Lh*Lb[7],Lc[Ld+8]=Le*Lb[8]+Lf*Lb[9]+Lg*Lb[10]+Lh*Lb[11],Lc[Ld+12]=Le*Lb[12]+Lf*Lb[13]+Lg*Lb[14]+Lh*Lb[15]},LI.matrix4x4MultiplyMFM=function(La,Lb,Lc){LI.matrix4x4MultiplyFFF(La.elements,Lb,Lc.elements)},Ll(LI,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new Lgb},"_tempVector3_1",function(){return this._tempVector3_1=new Lgb},"_tempVector3_2",function(){return this._tempVector3_2=new Lgb},"_tempVector3_3",function(){return this._tempVector3_3=new Lgb},"_tempVector3_4",function(){return this._tempVector3_4=new Lgb},"_tempVector3_5",function(){return this._tempVector3_5=new Lgb},"_tempVector3_6",function(){return this._tempVector3_6=new Lgb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),LI}(),Lrb=function(){function LG(){}return Ln(LG,"Laya3D"),LG._cancelLoadByUrl=function(La){Lv.loader.cancelLoadByUrl(La),LG._innerFirstLevelLoaderManager.cancelLoadByUrl(La),LG._innerSecondLevelLoaderManager.cancelLoadByUrl(La),LG._innerThirdLevelLoaderManager.cancelLoadByUrl(La),LG._innerFourthLevelLoaderManager.cancelLoadByUrl(La)},LG._changeWebGLSize=function(La,Lb){LF.onStageResize(La,Lb),LY.clientWidth=La,LY.clientHeight=Lb},LG.__init__=function(){var La=Lb.createMap;La.lh=[LKb,"SPRITE3DHIERARCHY"],La.ls=[LJb,"SPRITE3DHIERARCHY"],La.lm=[LRb,"MESH"],La.lmat=[LMb,"MATERIAL"],La.jpg=[LTb,"nativeimage"],La.jpeg=[LTb,"nativeimage"],La.png=[LTb,"nativeimage"],La.pkm=[LTb,"arraybuffer"],La.raw=[LPb,"arraybuffer"],La.mipmaps=[LPb,"arraybuffer"],Lr.parserMap.SPRITE3DHIERARCHY=LG._loadHierarchy,Lr.parserMap.MESH=LG._loadMesh,Lr.parserMap.MATERIAL=LG._loadMaterial,Lr.parserMap.TEXTURECUBE=LG._loadTextureCube,Lr.parserMap.TERRAIN=LG._loadTerrain,LG._innerFirstLevelLoaderManager.on("error",null,LG._eventLoadManagerError),LG._innerSecondLevelLoaderManager.on("error",null,LG._eventLoadManagerError),LG._innerThirdLevelLoaderManager.on("error",null,LG._eventLoadManagerError),LG._innerFourthLevelLoaderManager.on("error",null,LG._eventLoadManagerError)},LG.READ_BLOCK=function(){return LG._readData.pos+=4,!0},LG.READ_DATA=function(){return LG._DATA.offset=LG._readData.getUint32(),LG._DATA.size=LG._readData.getUint32(),!0},LG.READ_STRINGS=function(){var La=[],Lb={offset:0,size:0};Lb.offset=LG._readData.getUint16(),Lb.size=LG._readData.getUint16();LG._readData.pos;LG._readData.pos=Lb.offset+LG._DATA.offset;for(var Lc=0;Lc<Lb.size;Lc++){var Ld=LG._readData.readUTFString();-1===Ld.lastIndexOf(".lmat")&&-1===Ld.lastIndexOf(".lpbr")||La.push(Ld)}return La},LG.formatRelativePath=function(La,Lb){var Lc;if("."===Lb.charAt(0)){for(var Ld=(La+Lb).split("/"),Le=0,Lf=Ld.length;Le<Lf;Le++)if(".."==Ld[Le]){var Lg=Le-1;0<Lg&&".."!==Ld[Lg]&&(Ld.splice(Lg,2),Le-=2)}Lc=Ld.join("/")}else Lc=La+Lb;return null!=LE.customFormat&&(Lc=LE.customFormat(Lc,null)),Lc},LG._eventLoadManagerError=function(La){Lv.loader.event("error",La)},LG._addHierarchyInnerUrls=function(La,Lb,Lc,Ld,Le,Lf){var Lg=LG.formatRelativePath(Ld,Le);Lc&&(Lg+=Lc),La.push({url:Lg,clas:Lf}),Lb[Le]=Lg},LG._getSprite3DHierarchyInnerUrls=function(La,Lb,Lc,Ld,Le,Lf,Lg){var Lh,Li=0,Lj=0;switch(La.type){case"Scene":var Lk=La.customProps.lightmaps;for(Li=0,Lj=Lk.length;Li<Lj;Li++){var Ll=Lk[Li].replace(".exr",".png");LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,Ll,LTb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Lm;if(La.instanceParams)(Lm=La.instanceParams.loadPath)&&LG._addHierarchyInnerUrls(Lb,Le,Lf,Lg,Lm,LRb);else{(Lm=(Lh=La.customProps).meshPath)&&LG._addHierarchyInnerUrls(Lb,Le,Lf,Lg,Lm,LRb);var Ln=Lh.materials;if(Ln)for(Li=0,Lj=Ln.length;Li<Lj;Li++){for(var Lo=Ln[Li],Lp=Lo.type.split("."),Lq=LH.window,Lr=0,Ls=Lp.length;Lr<Ls;++Lr){Lq=Lq[this.clasPaths[Lr]]}if("function"!=typeof Lq)throw"_getSprite3DHierarchyInnerUrls 错误: "+Lo.type+" 不是类";LG._addHierarchyInnerUrls(Lc,Le,Lf,Lg,Lo.path,Lq)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var Lt=(Lh=La.customProps).meshPath;Lt&&LG._addHierarchyInnerUrls(Lb,Le,Lf,Lg,Lt,LRb);var Lu=Lh.material;if(Lu){Lp=Lu.type.split("."),Lq=LH.window;for(Lr=0,Ls=Lp.length;Lr<Ls;++Lr){Lq=Lq[this.clasPaths[Lr]]}LG._addHierarchyInnerUrls(Lc,Le,Lf,Lg,Lu.path,Lq)}else{var Lv=Lh.materialPath;if(Lv)LG._addHierarchyInnerUrls(Lc,Le,Lf,Lg,Lv,ShurikenParticleMaterial);else{var Ly=Lh.texturePath;Ly&&LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,Ly,LTb)}}break;case"Terrain":LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,La.customProps.dataPath,TerrainRes)}var Lz=La.components;for(var LA in Lz){var LB=Lz[LA];switch(LA){case"Animator":var LC=LB.avatarPath;if(LC)LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,LC,Avatar);else{var LD=LB.avatar;LD&&LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,LD.path,Avatar)}var LE=LB.clipPaths;for(Li=0,Lj=LE.length;Li<Lj;Li++)LG._addHierarchyInnerUrls(Ld,Le,Lf,Lg,LE[Li],AnimationClip)}}var LF=La.child;for(Li=0,Lj=LF.length;Li<Lj;Li++)LG._getSprite3DHierarchyInnerUrls(LF[Li],Lb,Lc,Ld,Le,Lf,Lg)},LG._loadHierarchy=function(La){La.on("loaded",null,LG._onHierarchylhLoaded,[La,La._class._getGroup()]),La.load(La.url,"json",!1,null,!0)},LG._onHierarchylhLoaded=function(La,Lb,Lc){if(La._class.destroyed)La.endLoad();else{var Ld=La.url,Le=Lqb.getURLVerion(Ld),Lf=LE.getPath(Ld),Lg=[],Lh=[],Li=[],Lj={};LG._getSprite3DHierarchyInnerUrls(Lc,Lg,Lh,Li,Lj,Le,Lf);var Lk=Lg.length+Lh.length+Li.length,Ll=Lk+1,Lm=1/Ll;if(LG._onProcessChange(La,0,Lm,1),0<Li.length){var Ln=Lk/Ll,Lo=LD.create(null,LG._onProcessChange,[La,Lm,Ln],!1);LG._innerFourthLevelLoaderManager.create(Li,LD.create(null,LG._onHierarchyInnerForthLevResouLoaded,[La,Lb,Lo,Lc,Lj,Lg,Lh,Lm+Ln*Li.length,Ln]),Lo,null,null,1,!0,Lb)}else LG._onHierarchyInnerForthLevResouLoaded(La,Lb,null,Lc,Lj,Lg,Lh,Lm,Ln)}},LG._onHierarchyInnerForthLevResouLoaded=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){if(La._class.destroyed)La.endLoad();else if(Lc&&Lc.recover(),0<Lg.length){var Lj=LD.create(null,LG._onProcessChange,[La,Lh,Li],!1);LG._innerSecondLevelLoaderManager.create(Lg,LD.create(null,LG._onHierarchyInnerSecondLevResouLoaded,[La,Lb,Lj,Ld,Le,Lf,Lh+Li*Lg.length,Li]),Lc,null,null,1,!0,Lb)}else LG._onHierarchyInnerSecondLevResouLoaded(La,Lb,null,Ld,Le,Lf,Lh,Li)},LG._onHierarchyInnerSecondLevResouLoaded=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){if(La._class.destroyed)La.endLoad();else if(Lc&&Lc.recover(),0<Lf.length){var Li=LD.create(null,LG._onProcessChange,[La,Lg,Lh],!1);LG._innerFirstLevelLoaderManager.create(Lf,LD.create(null,LG._onHierarchyInnerFirstLevResouLoaded,[La,Li,Ld,Le]),Lc,null,null,1,!0,Lb)}else LG._onHierarchyInnerFirstLevResouLoaded(La,null,Ld,Le)},LG._onHierarchyInnerFirstLevResouLoaded=function(La,Lb,Lc,Ld){Lb&&Lb.recover(),La.endLoad([Lc,Ld])},LG._loadTerrain=function(La){La.on("loaded",null,LG._onTerrainLtLoaded,[La,La._class._getGroup()]),La.load(La.url,"json",!1,null,!0)},LG._onTerrainLtLoaded=function(La,Lb,Lc){if(La._class.destroyed)La.endLoad();else{var Ld,Le,Lf=La.url,Lg=Lqb.getURLVerion(Lf),Lh=LE.getPath(Lf),Li=[],Lj={},Lk=0,Ll=0,Lm=Lc.heightData;Ld=Lm.url,Le=LG.formatRelativePath(Lh,Ld),Lg&&(Le+=Lg),Ld=Lj[Ld]=Le;var Ln=Lc.detailTexture;for(Lk=0,Ll=Ln.length;Lk<Ll;Lk++)Li.push({url:Ln[Lk].diffuse});var Lo=Lc.normalMap;for(Lk=0,Ll=Lo.length;Lk<Ll;Lk++)Li.push({url:Lo[Lk]});var Lp=Lc.alphaMap;for(Lk=0,Ll=Lp.length;Lk<Ll;Lk++)Li.push({url:Lp[Lk],params:[!1,!1,6408,!0]});for(Lk=0,Ll=Li.length;Lk<Ll;Lk++){var Lq=Li[Lk].url;Le=LG.formatRelativePath(Lh,Lq),Lg&&(Le+=Lg),Li[Lk].url=Le,Lj[Lq]=Le}var Lr=Li.length,Ls=Lr+2,Lt=1/Ls;LG._onProcessChange(La,0,Lt,1);var Lu={heightMapLoaded:!1,texturesLoaded:!1},Lv=LD.create(null,LG._onProcessChange,[La,Lt,Lt],!1);LG._innerFourthLevelLoaderManager.create(Ld,LD.create(null,LG._onTerrainHeightMapLoaded,[La,Lv,Lc,Lj,Lu]),Lv,null,[Lm.numX,Lm.numZ,Lm.bitType,Lm.value],1,!0,Lb);var Ly=LD.create(null,LG._onProcessChange,[La,2*Lt,Lr/Ls],!1);LG._innerFourthLevelLoaderManager.create(Li,LD.create(null,LG._onTerrainTexturesLoaded,[La,Ly,Lc,Lj,Lu]),Ly,null,null,1,!0,Lb)}},LG._onTerrainHeightMapLoaded=function(La,Lb,Lc,Ld,Le){Le.heightMapLoaded=!0,Le.texturesLoaded&&(La.endLoad([Lc,Ld]),Lb.recover())},LG._onTerrainTexturesLoaded=function(La,Lb,Lc,Ld,Le){Le.texturesLoaded=!0,Le.heightMapLoaded&&(La.endLoad([Lc,Ld]),Lb.recover())},LG._loadMesh=function(La){La.on("loaded",null,LG._onMeshLmLoaded,[La,La._class._getGroup()]),La.load(La.url,"arraybuffer",!1,null,!0)},LG._onMeshLmLoaded=function(La,Lb,Lc){if(La._class.destroyed)La.endLoad();else{var Ld,Le,Lf,Lg=La.url,Lh=Lqb.getURLVerion(Lg),Li=LE.getPath(Lg),Lj={},Lk=0,Ll=0;switch((LG._readData=new Ly(Lc)).pos=0,LG._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Lm=LG._readData.getUint32();LG._readData.pos=LG._readData.pos+4,Ll=LG._readData.getUint16(),LG._readData.pos=LG._readData.pos+8*Ll;var Ln=LG._readData.getUint32();for(Ll=LG._readData.getUint16(),LG._readData.pos=Lm+Ln,Ld=[],Lk=0;Lk<Ll;Lk++){var Lo=LG._readData.readUTFString();-1!==Lo.lastIndexOf(".lmat")&&Ld.push(Lo)}break;default:for(LG.READ_BLOCK(),Lk=0;Lk<2;Lk++){var Lp=LG._readData.getUint16(),Lq=LG._strings[Lp],Lr=LG["READ_"+Lq];if(null==Lr)throw new Error("model file err,no this function:"+Lp+" "+Lq);1===Lk?Ld=Lr.call():Lr.call()}}for(Lk=0,Lf=Ld.length;Lk<Lf;Lk++){var Ls=Ld[Lk];Le=LG.formatRelativePath(Li,Ls),Lh&&(Le+=Lh),Ld[Lk]=Le,Lj[Ls]=Le}if(0<Ld.length){LG._onProcessChange(La,0,.5,1);var Lt=LD.create(null,LG._onProcessChange,[La,.5,.5],!1);LG._innerSecondLevelLoaderManager.create(Ld,LD.create(null,LG._onMeshMateialLoaded,[La,Lt,Lc,Lj]),Lt,null,null,1,!0,Lb)}else La.endLoad([Lc,Lj])}},LG._onMeshMateialLoaded=function(La,Lb,Lc,Ld){La.endLoad([Lc,Ld]),Lb.recover()},LG._getMaterialTexturePath=function(La,Lb,Lc){var Ld=La.length-4;return La.indexOf(".dds")!=Ld&&La.indexOf(".tga")!=Ld&&La.indexOf(".exr")!=Ld&&La.indexOf(".DDS")!=Ld&&La.indexOf(".TGA")!=Ld&&La.indexOf(".EXR")!=Ld||(La=La.substr(0,Ld)+".png"),La=LG.formatRelativePath(Lc,La),Lb&&(La+=Lb),La},LG._loadMaterial=function(La){La.on("loaded",null,LG._onMaterilLmatLoaded,[La,La._class._getGroup()]),La.load(La.url,"json",!1,null,!0)},LG._onMaterilLmatLoaded=function(La,Lb,Lc){if(La._class.destroyed)La.endLoad();else{var Ld,Le=La.url,Lf=Lqb.getURLVerion(Le),Lg=LE.getPath(Le),Lh=[],Li={},Lj=Lc.customProps,Lk=Lc.version;if(Lk)switch(Lk){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var Ll=Lc.props.textures,Lm=0,Ln=Ll.length;Lm<Ln;Lm++){var Lo=Ll[Lm],Lp=Lo.path;if(Lp){var Lq=Lp.length-4;Lp.indexOf(".exr")!=Lq&&Lp.indexOf(".EXR")!=Lq||(Lp=Lp.substr(0,Lq)+".png"),Ld=LG.formatRelativePath(Lg,Lp),Lf&&(Ld+=Lf),Lh.push({url:Ld,params:Lo.params}),Li[Lp]=Ld}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var Lr=Lj.diffuseTexture.texture2D;if(Lr&&(Ld=LG._getMaterialTexturePath(Lr,Lf,Lg),Lh.push(Ld),Li[Lr]=Ld),Lj.normalTexture){var Ls=Lj.normalTexture.texture2D;Ls&&(Ld=LG._getMaterialTexturePath(Ls,Lf,Lg),Lh.push(Ld),Li[Ls]=Ld)}if(Lj.specularTexture){var Lt=Lj.specularTexture.texture2D;Lt&&(Ld=LG._getMaterialTexturePath(Lt,Lf,Lg),Lh.push(Ld),Li[Lt]=Ld)}if(Lj.emissiveTexture){var Lu=Lj.emissiveTexture.texture2D;Lu&&(Ld=LG._getMaterialTexturePath(Lu,Lf,Lg),Lh.push(Ld),Li[Lu]=Ld)}if(Lj.ambientTexture){var Lv=Lj.ambientTexture.texture2D;Lv&&(Ld=LG._getMaterialTexturePath(Lv,Lf,Lg),Lh.push(Ld),Li[Lv]=Ld)}if(Lj.reflectTexture){var Ly=Lj.reflectTexture.texture2D;Ly&&(Ld=LG._getMaterialTexturePath(Ly,Lf,Lg),Lh.push(Ld),Li[Ly]=Ld)}}var Lz=Lh.length,LA=Lz+1,LB=1/LA;if(LG._onProcessChange(La,0,LB,1),0<Lz){var LC=LD.create(null,LG._onProcessChange,[La,LB,Lz/LA],!1);LG._innerFourthLevelLoaderManager.create(Lh,LD.create(null,LG._onMateialTexturesLoaded,[La,LC,Lc,Li]),LC,LTb,null,1,!0,Lb)}else LG._onMateialTexturesLoaded(La,null,Lc,null)}},LG._onMateialTexturesLoaded=function(La,Lb,Lc,Ld){La.endLoad([Lc,Ld]),Lb&&Lb.recover()},LG._loadTextureCube=function(La){La.on("loaded",null,LG._onTextureCubeLtcLoaded,[La]),La.load(La.url,"json",!1,null,!0)},LG._onTextureCubeLtcLoaded=function(La,Lb){if(La._class.destroyed)La.endLoad();else{var Lc=LE.getPath(La.url),Ld=[LG.formatRelativePath(Lc,Lb.px),LG.formatRelativePath(Lc,Lb.nx),LG.formatRelativePath(Lc,Lb.py),LG.formatRelativePath(Lc,Lb.ny),LG.formatRelativePath(Lc,Lb.pz),LG.formatRelativePath(Lc,Lb.nz)];LG._onProcessChange(La,0,1/7,1);var Le=LD.create(null,LG._onProcessChange,[La,1/7,6/7],!1);LG._innerFourthLevelLoaderManager.load(Ld,LD.create(null,LG._onTextureCubeImagesLoaded,[La,Ld,Le]),Le,"nativeimage")}},LG._onTextureCubeImagesLoaded=function(La,Lb,Lc){var Ld=[];Ld.length=6;for(var Le=0;Le<6;Le++){var Lf=Lb[Le];Ld[Le]=Lr.getRes(Lf),Lr.clearRes(Lf)}La.endLoad(Ld),Lc.recover()},LG._onProcessChange=function(La,Lb,Lc,Ld){(Ld=Lb+Ld*Lc)<1&&La.event("progress",Ld)},LG.init=function(La,Lb,Lc,Ld,Le,Lf){if(void 0===Lc&&(Lc=!1),void 0===Ld&&(Ld=!1),void 0===Le&&(Le=!0),void 0===Lf&&(Lf=!0),Ls.update3DLoop=function(){},Ls.cancelLoadByUrl=function(La){LG._cancelLoadByUrl(La)},Li.isAntialias=Lc,Li.isAlpha=Ld,Li.premultipliedAlpha=Le,Li.isStencil=Lf,!LF.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");Ls.changeWebGLSize=LG._changeWebGLSize,Lp.is3DMode=!0,Lv.init(La,Lb),LI.__init__(),Llb.__init__(),LXb.__init__(),LQ.__init__(),LG.__init__(),Lg.maxTextureCount=2,(LG.debugMode||LZ.debugMode)&&(LG._debugPhasorSprite=new LV)},LG.HIERARCHY="SPRITE3DHIERARCHY",LG.MESH="MESH",LG.MATERIAL="MATERIAL",LG.PBRMATERIAL="PBRMTL",LG.TEXTURECUBE="TEXTURECUBE",LG.TERRAIN="TERRAIN",LG._readData=null,LG._debugPhasorSprite=null,LG.debugMode=!1,Ll(LG,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Lb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Lb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Lb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Lb}]),LG}(),Lsb=function(La){function Le(La){Le.__super.call(this),this._owner=La,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Ln(Le,"laya.d3.animation.AnimationTransform3D",Lf);var Lb=Le.prototype;return Lb._getlocalMatrix=function(){return this._localUpdate&&(Lqb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Lb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldTransform()}},Lb._setWorldMatrixAndUpdate=function(La){if(this._worldMatrix=La,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Lb=this._getlocalMatrix(),Lc=0;Lc<16;++Lc)this._worldMatrix[Lc]=Lb[Lc];else Lqb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Lb._setWorldMatrixNoUpdate=function(La){this._worldMatrix=La},Lb._setWorldMatrixIgnoreUpdate=function(La){this._worldMatrix=La,this._worldUpdate=!1},Lb.getLocalPosition=function(){return this._localPosition},Lb.setLocalPosition=function(La){if(this._parent)this._localPosition=La,this._localUpdate=!0,this._onWorldTransform();else{var Lb=this._entity.owner._transform,Lc=this._entity.localPosition,Ld=Lc.elements;Ld[0]=La[0],Ld[1]=La[1],Ld[2]=La[2],Lb.localPosition=Lc}},Lb.getLocalRotation=function(){if(this._localQuaternionUpdate){var La=this._localRotationEuler;Lqb._quaternionCreateFromYawPitchRollArray(La[1]/Le._angleToRandin,La[0]/Le._angleToRandin,La[2]/Le._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Lb.setLocalRotation=function(La){if(this._parent)this._localRotation=La,Lqb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Lb=this._entity.owner._transform,Lc=this._entity.localRotation,Ld=Lc.elements;Ld[0]=La[0],Ld[1]=La[1],Ld[2]=La[2],Ld[3]=La[3],Lb.localRotation=Lc}},Lb.getLocalScale=function(){return this._localScale},Lb.setLocalScale=function(La){if(this._parent)this._localScale=La,this._localUpdate=!0,this._onWorldTransform();else{var Lb=this._entity.owner._transform,Lc=this._entity.localScale,Ld=Lc.elements;Ld[0]=La[0],Ld[1]=La[1],Ld[2]=La[2],Lb.localScale=Lc}},Lb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Lqb.getYawPitchRoll(this._localRotation,Le._tempVector3);var La=Le._tempVector3,Lb=this._localRotationEuler;Lb[0]=La[1]*Le._angleToRandin,Lb[1]=La[0]*Le._angleToRandin,Lb[2]=La[2]*Le._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Lb.setLocalRotationEuler=function(La){if(this._parent)Lqb._quaternionCreateFromYawPitchRollArray(La[1]/Le._angleToRandin,La[0]/Le._angleToRandin,La[2]/Le._angleToRandin,this._localRotation),this._localRotationEuler=La,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Lb=this._entity.owner._transform,Lc=this._entity.localRotationEuler,Ld=Lc.elements;Ld[0]=La[0],Ld[1]=La[1],Ld[2]=La[2],Lb.localRotationEuler=Lc}},Lb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Lqb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var La=this._getlocalMatrix(),Lb=0;Lb<16;++Lb)this._worldMatrix[Lb]=La[Lb];this._worldUpdate=!1}return this._worldMatrix},Lb.setParent=function(La){if(this._parent!==La){if(this._parent){var Lb=this._parent._childs,Lc=Lb.indexOf(this);Lb.splice(Lc,1)}La&&(La._childs.push(this),La&&this._onWorldTransform()),this._parent=La}},Ll(Le,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Le}(),Ltb=function(La){function Lb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Lb.__super.call(this),this._destroyed=!1,this._id=Lb._uniqueIDCounter,Lb._uniqueIDCounter++}Ln(Lb,"laya.d3.component.Component3D",Lf);var Lc=Lb.prototype;return Lv.imps(Lc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),Lc._initialize=function(La){this._owner=La,this._enable=!0,this.started=!1,this._load(La)},Lc._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},Lc._load=function(La){},Lc._start=function(La){},Lc._update=function(La){},Lc._lateUpdate=function(La){},Lc._preRenderUpdate=function(La){},Lc._postRenderUpdate=function(La){},Lc._unload=function(La){this.offAll()},Lc._cloneTo=function(La){},Lo(0,Lc,"id",function(){return this._id}),Lo(0,Lc,"destroyed",function(){return this._destroyed}),Lo(0,Lc,"owner",function(){return this._owner}),Lo(0,Lc,"enable",function(){return this._enable},function(La){this._enable!==La&&(this._enable=La,this.event("enablechanged",this._enable))}),Lo(0,Lc,"isSingleton",function(){return Lb._isSingleton}),Lb._isSingleton=!0,Lb._uniqueIDCounter=1,Lb}(),Lub=function(La){function Lb(){this._destroyed=!1,Lb.__super.call(this),this._destroyed=!1}Ln(Lb,"laya.d3.core.GeometryFilter",Lf);var Lc=Lb.prototype;return Lv.imps(Lc,{"laya.resource.IDestroy":!0}),Lc._destroy=function(){this.offAll(),this._destroyed=!0},Lo(0,Lc,"_isAsyncLoaded",function(){return!0}),Lo(0,Lc,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),Lo(0,Lc,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),Lo(0,Lc,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),Lo(0,Lc,"destroyed",function(){return this._destroyed}),Lb}(),Lvb=function(La){function Ld(La){Ld.__super.call(this),this._id=++Ld._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new LZa(new Lgb,new Lgb),this._boundingBoxCenter=new Lgb,this._boundingSphere=new L_a(new Lgb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=La,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Ln(Ld,"laya.d3.core.render.BaseRender",Lf);var Lb=Ld.prototype;return Lv.imps(Lb,{"laya.resource.IDestroy":!0}),Lb._changeMaterialReference=function(La,Lb){La&&La._removeReference(),Lb._addReference()},Lb._getInstanceMaterial=function(La,Lb){var Lc=new La.constructor;return La.cloneTo(Lc),Lc.name=Lc.name+"(Instance)",this._materialsInstance[Lb]=!0,this._changeMaterialReference(this._materials[Lb],Lc),this._materials[Lb]=Lc},Lb._setShaderValuelightMap=function(La){this._setShaderValueTexture(3,La)},Lb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Lb._renderRenderableBoundBox=function(){var La=Lrb._debugPhasorSprite,Lb=this.boundingBox,Lc=Ld._tempBoundBoxCorners;Lb.getCorners(Lc),La.line(Lc[0],Ld._greenColor,Lc[1],Ld._greenColor),La.line(Lc[2],Ld._greenColor,Lc[3],Ld._greenColor),La.line(Lc[4],Ld._greenColor,Lc[5],Ld._greenColor),La.line(Lc[6],Ld._greenColor,Lc[7],Ld._greenColor),La.line(Lc[0],Ld._greenColor,Lc[3],Ld._greenColor),La.line(Lc[1],Ld._greenColor,Lc[2],Ld._greenColor),La.line(Lc[2],Ld._greenColor,Lc[6],Ld._greenColor),La.line(Lc[3],Ld._greenColor,Lc[7],Ld._greenColor),La.line(Lc[0],Ld._greenColor,Lc[4],Ld._greenColor),La.line(Lc[1],Ld._greenColor,Lc[5],Ld._greenColor),La.line(Lc[4],Ld._greenColor,Lc[7],Ld._greenColor),La.line(Lc[5],Ld._greenColor,Lc[6],Ld._greenColor)},Lb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Lb._calculateBoundingBox=function(){throw"BaseRender: must override it."},Lb._setShaderValueTexture=function(La,Lb){this._owner._shaderValues.setValue(La,Lb)},Lb._setShaderValueMatrix4x4=function(La,Lb){this._owner._shaderValues.setValue(La,Lb?Lb.elements:null)},Lb._setShaderValueColor=function(La,Lb){this._owner._shaderValues.setValue(La,Lb?Lb.elements:null)},Lb._setShaderValueBuffer=function(La,Lb){this._owner._shaderValues.setValue(La,Lb)},Lb._setShaderValueInt=function(La,Lb){this._owner._shaderValues.setValue(La,Lb)},Lb._setShaderValueBool=function(La,Lb){this._owner._shaderValues.setValue(La,Lb)},Lb._setShaderValueNumber=function(La,Lb){this._owner._shaderValues.setValue(La,Lb)},Lb._setShaderValueVector2=function(La,Lb){this._owner._shaderValues.setValue(La,Lb?Lb.elements:null)},Lb._addShaderDefine=function(La){this._owner._shaderDefineValue|=La},Lb._removeShaderDefine=function(La){this._owner._shaderDefineValue&=~La},Lb._renderUpdate=function(La){return!0},Lb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var La=this._owner.scene;if(La){var Lb=La.getlightmaps()[this._lightmapIndex];Lb?(this._addShaderDefine(LVb.SAHDERDEFINE_LIGHTMAP),Lb.loaded?this._setShaderValuelightMap(Lb):Lb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(LVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(LVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(LVb.SAHDERDEFINE_LIGHTMAP)},Lb._updateOctreeNode=function(){var La=this._treeNode;La&&this._octreeNodeNeedChange&&(La.updateObject(this),this._octreeNodeNeedChange=!1)},Lb._destroy=function(){this.offAll();var La=0,Lb=0;for(La=0,Lb=this._renderElements.length;La<Lb;La++)this._renderElements[La]._destroy();for(La=0,Lb=this._materials.length;La<Lb;La++)this._materials[La]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},Lo(0,Lb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),Lo(0,Lb,"id",function(){return this._id}),Lo(0,Lb,"material",function(){var La=this._materials[0];if(La&&!this._materialsInstance[0]){var Lb=this._getInstanceMaterial(La,0);this.event("materialchanged",[this,0,Lb])}return this._materials[0]},function(La){this.sharedMaterial=La}),Lo(0,Lb,"sharedMaterial",function(){return this._materials[0]},function(La){var Lb=this._materials[0];Lb!==La&&(this._materials[0]=La,this._materialsInstance[0]=!1,this._changeMaterialReference(Lb,La),this.event("materialchanged",[this,0,La]))}),Lo(0,Lb,"lightmapIndex",function(){return this._lightmapIndex},function(La){this._lightmapIndex=La,this._applyLightMapParams()}),Lo(0,Lb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(La){this._lightmapScaleOffset=La,this._setShaderValueColor(2,La),this._addShaderDefine(LVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),Lo(0,Lb,"enable",function(){return this._enable},function(La){this._enable=La,this.event("enablechanged",[this,La])}),Lo(0,Lb,"materials",function(){for(var La=0,Lb=this._materials.length;La<Lb;La++)if(!this._materialsInstance[La]){var Lc=this._getInstanceMaterial(this._materials[La],La);this.event("materialchanged",[this,La,Lc])}return this._materials.slice()},function(La){this.sharedMaterials=La}),Lo(0,Lb,"sharedMaterials",function(){return this._materials.slice()},function(La){if(!La)throw new Error("MeshRender: shadredMaterials value can't be null.");var Lb=La.length;this._materialsInstance.length=Lb;for(var Lc=0;Lc<Lb;Lc++){var Ld=this._materials[Lc];Ld!==La[Lc]&&(this._materialsInstance[Lc]=!1,this._changeMaterialReference(Ld,La[Lc]),this.event("materialchanged",[this,Lc,La[Lc]]))}this._materials=La}),Lo(0,Lb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),Lo(0,Lb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var La=this.boundingBox;Lgb.add(La.min,La.max,this._boundingBoxCenter),Lgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),Lo(0,Lb,"receiveShadow",function(){return this._receiveShadow},function(La){this._receiveShadow!==La&&((this._receiveShadow=La)?this._addShaderDefine(Lnb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Lnb.SHADERDEFINE_RECEIVE_SHADOW))}),Lo(0,Lb,"destroyed",function(){return this._destroyed}),Ld._uniqueIDCounter=0,Ll(Ld,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb,new Lgb]},"_greenColor",function(){return this._greenColor=new Lhb(0,1,0,1)}]),Ld}(),Lyb=function(La){function Lh(La){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,Lh.__super.call(this),this._localPosition=new Lgb,this._localRotation=new Lcb(0,0,0,1),this._localScale=new Lgb(1,1,1),this._localRotationEuler=new Lgb,this._localMatrix=new Lab,this._position=new Lgb,this._rotation=new Lcb(0,0,0,1),this._scale=new Lgb(1,1,1),this._worldMatrix=new Lab,this._forward=new Lgb,this._up=new Lgb,this._right=new Lgb,this._owner=La,this._childs=[]}Ln(Lh,"laya.d3.core.Transform3D",Lf);var Lb=Lh.prototype;return Lb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Lab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var La=Lh._tempVector30;Lgb.multiply(this.pivot,this._localScale,La);var Lb=Lh._tempVector31;Lgb.subtract(La,this.pivot,Lb);var Lc=Lh._tempVector32,Ld=this.localRotation;Lgb.transformQuat(La,Ld,Lc),Lgb.subtract(Lc,La,Lc);var Le=Lh._tempVector33;Lgb.subtract(this._localPosition,Lb,Le),Lgb.subtract(Le,Lc,Le),Lab.createAffineTransformation(Le,Ld,this._localScale,this._localMatrix)}},Lb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldPositionRotationTransform()}},Lb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldPositionScaleTransform()}},Lb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldPositionTransform()}},Lb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldPositionRotationTransform()}},Lb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldPositionScaleTransform()}},Lb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._onWorldTransform()}},Lb.translate=function(La,Lb){void 0===Lb&&(Lb=!0),Lb?(Lab.createFromQuaternion(this.localRotation,Lh._tempMatrix0),Lgb.transformCoordinate(La,Lh._tempMatrix0,Lh._tempVector30),Lgb.add(this.localPosition,Lh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(Lgb.add(this.position,La,this._position),this.position=this._position)},Lb.rotate=function(La,Lb,Lc){var Ld;void 0===Lb&&(Lb=!0),void 0===Lc&&(Lc=!0),Ld=Lc?La:(Lgb.scale(La,Math.PI/180,Lh._tempVector30),Lh._tempVector30),Lcb.createFromYawPitchRoll(Ld.y,Ld.x,Ld.z,Lh._tempQuaternion0),Lb?(Lcb.multiply(this._localRotation,Lh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Lcb.multiply(Lh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Lb.lookAt=function(La,Lb,Lc){void 0===Lc&&(Lc=!1);var Ld,Le=La.elements;if(Lc){if(Ld=this._localPosition.elements,Math.abs(Ld[0]-Le[0])<Lwa.zeroTolerance&&Math.abs(Ld[1]-Le[1])<Lwa.zeroTolerance&&Math.abs(Ld[2]-Le[2])<Lwa.zeroTolerance)return;Lcb.lookAt(this._localPosition,La,Lb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Lf=this.position;if(Ld=Lf.elements,Math.abs(Ld[0]-Le[0])<Lwa.zeroTolerance&&Math.abs(Ld[1]-Le[1])<Lwa.zeroTolerance&&Math.abs(Ld[2]-Le[2])<Lwa.zeroTolerance)return;Lcb.lookAt(Lf,La,Lb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},Lo(0,Lb,"_isFrontFaceInvert",function(){var La=this.scale,Lb=La.x<0;return La.y<0&&(Lb=!Lb),La.z<0&&(Lb=!Lb),Lb}),Lo(0,Lb,"owner",function(){return this._owner}),Lo(0,Lb,"localRotation",function(){if(this._localQuaternionUpdate){var La=this._localRotationEuler.elements;Lcb.createFromYawPitchRoll(La[1]/Lh._angleToRandin,La[0]/Lh._angleToRandin,La[2]/Lh._angleToRandin,this._localRotation)}return this._localRotation},function(La){this._localRotation=La,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Lo(0,Lb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Lab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(La){null===this._parent?La.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Lab.multiply(this._localMatrix,La,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=La,this._worldUpdate=!1}),Lo(0,Lb,"worldNeedUpdate",function(){return this._worldUpdate}),Lo(0,Lb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(La){this._localMatrix=La,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),Lo(0,Lb,"dummy",function(){return this._dummy},function(La){this._dummy!==La&&(this._dummy&&(this._dummy._entity=null),La&&(La._entity=this),this._dummy=La)}),Lo(0,Lb,"localPosition",function(){return this._localPosition},function(La){this._localPosition=La,this._localUpdate=!0,this._onWorldPositionTransform()}),Lo(0,Lb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var La=this._parent.position;Lgb.multiply(this._localPosition,this._parent.scale,Lh._tempVector30),Lgb.transformQuat(Lh._tempVector30,this._parent.rotation,Lh._tempVector30),Lgb.add(La,Lh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(La){if(null!=this._parent){Lgb.subtract(La,this._parent.position,this._localPosition);var Lb=this._parent.scale.elements,Lc=Lb[0],Ld=Lb[1],Le=Lb[2];if(1!==Lc||1!==Ld||1!==Le){var Lf=Lh._tempVector30,Lg=Lf.elements;Lg[0]=1/Lc,Lg[1]=1/Ld,Lg[2]=1/Le,Lgb.multiply(this._localPosition,Lf,this._localPosition)}this._parent.rotation.invert(Lh._tempQuaternion0),Lgb.transformQuat(this._localPosition,Lh._tempQuaternion0,this._localPosition)}else La.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=La,this._positionUpdate=!1}),Lo(0,Lb,"localScale",function(){return this._localScale},function(La){this._localScale=La,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),Lo(0,Lb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(Lh._tempVector30);var La=Lh._tempVector30.elements,Lb=this._localRotationEuler.elements;Lb[0]=La[1]*Lh._angleToRandin,Lb[1]=La[0]*Lh._angleToRandin,Lb[2]=La[2]*Lh._angleToRandin}return this._localRotationEuler},function(La){this._localRotationEuler=La,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Lo(0,Lb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Lcb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(La){null!=this._parent?(this._parent.rotation.invert(Lh._tempQuaternion0),Lcb.multiply(La,Lh._tempQuaternion0,this._localRotation)):La.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=La,this._rotationUpdate=!1}),Lo(0,Lb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?Lgb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(La){if(null!==this._parent){var Lb=this._parent.scale.elements,Lc=Lh._tempVector30.elements;Lc[0]=1/Lb[0],Lc[1]=1/Lb[1],Lc[2]=1/Lb[2],Lgb.multiply(La,Lh._tempVector30,this._localScale)}else La.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=La,this._scaleUpdate=!1}),Lo(0,Lb,"rotationEuler",null,function(La){Lcb.createFromYawPitchRoll(La.y,La.x,La.z,this._rotation),this.rotation=this._rotation}),Lo(0,Lb,"forward",function(){var La=this.worldMatrix.elements;return this._forward.elements[0]=-La[8],this._forward.elements[1]=-La[9],this._forward.elements[2]=-La[10],this._forward}),Lo(0,Lb,"up",function(){var La=this.worldMatrix.elements;return this._up.elements[0]=La[4],this._up.elements[1]=La[5],this._up.elements[2]=La[6],this._up}),Lo(0,Lb,"right",function(){var La=this.worldMatrix.elements;return this._right.elements[0]=La[0],this._right.elements[1]=La[1],this._right.elements[2]=La[2],this._right}),Lo(0,Lb,"parent",function(){return this._parent},function(La){if(this._parent!==La){if(this._parent){var Lb=this._parent._childs,Lc=Lb.indexOf(this);Lb.splice(Lc,1)}La&&(La._childs.push(this),La&&this._onWorldTransform()),this._parent=La}}),Ll(Lh,["_tempVector30",function(){return this._tempVector30=new Lgb},"_tempVector31",function(){return this._tempVector31=new Lgb},"_tempVector32",function(){return this._tempVector32=new Lgb},"_tempVector33",function(){return this._tempVector33=new Lgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Lcb},"_tempMatrix0",function(){return this._tempMatrix0=new Lab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Lh}(),Lzb=(function(La){function Lb(){this._rotation=0,this._matNeedUpdte=!1,Lb.__super.call(this),this._matrix=new Lab,this._offset=new Lfb,this._tiling=new Lfb(1,1)}Ln(Lb,"laya.d3.core.TransformUV",Lf);var Lc=Lb.prototype;Lv.imps(Lc,{"laya.d3.core.IClone":!0}),Lc._updateMatrix=function(){Lb._tempOffsetV3.elements[0]=this._offset.x,Lb._tempOffsetV3.elements[1]=this._offset.y,Lcb.createFromYawPitchRoll(0,0,this._rotation,Lb._tempRotationQua),Lb._tempTitlingV3.elements[0]=this._tiling.x,Lb._tempTitlingV3.elements[1]=this._tiling.y,Lab.createAffineTransformation(Lb._tempOffsetV3,Lb._tempRotationQua,Lb._tempTitlingV3,this._matrix)},Lc.cloneTo=function(La){La._matrix=this._matrix.clone(),La._offset=this._offset.clone(),La._rotation=this._rotation,La._tiling=this._tiling.clone()},Lc.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lc,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),Lo(0,Lc,"tiling",function(){return this._tiling},function(La){this._tiling=La,this._matNeedUpdte=!0}),Lo(0,Lc,"offset",function(){return this._offset},function(La){this._offset=La,this._matNeedUpdte=!0}),Lo(0,Lc,"rotation",function(){return this._rotation},function(La){this._rotation=La,this._matNeedUpdte=!0}),Ll(Lb,["_tempOffsetV3",function(){return this._tempOffsetV3=new Lgb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Lcb},"_tempTitlingV3",function(){return this._tempTitlingV3=new Lgb(1,1,1)}])}(),function(Lc){function La(){this.x=NaN,this.y=NaN,this.z=NaN,La.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Ln(La,"laya.d3.core.particleShuriKen.module.shape.BoxShape",Lc);var Lb=La.prototype;Lb._getShapeBoundBox=function(La){var Lb=La.min.elements;Lb[0]=.5*-this.x,Lb[1]=.5*-this.y,Lb[2]=.5*-this.z;var Lc=La.max.elements;Lc[0]=.5*this.x,Lc[1]=.5*this.y,Lc[2]=.5*this.z},Lb._getSpeedBoundBox=function(La){var Lb=La.min.elements;Lb[0]=0,Lb[1]=0,Lb[2]=0;var Lc=La.max.elements;Lc[0]=0,Lc[1]=1,Lc[2]=0},Lb.generatePositionAndDirection=function(La,Lb,Lc,Ld){var Le=La.elements,Lf=Lb.elements;Lc?(Lc.seed=Ld[16],LT._randomPointInsideHalfUnitBox(La,Lc),Ld[16]=Lc.seed):LT._randomPointInsideHalfUnitBox(La),Le[0]=this.x*Le[0],Le[1]=this.y*Le[1],Le[2]=this.z*Le[2],this.randomDirection?Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb):(Lf[0]=0,Lf[1]=0,Lf[2]=1)},Lb.cloneTo=function(La){Lc.prototype.cloneTo.call(this,La);var Lb=La;Lb.x=this.x,Lb.y=this.y,Lb.z=this.z,Lb.randomDirection=this.randomDirection}}(LO),function(Lc){function Lg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,Lg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Ln(Lg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",Lc);var La=Lg.prototype;La._getShapeBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[2]=-this.radius,Lb[1]=0;var Lc=La.max.elements;Lc[0]=Lc[2]=this.radius,Lc[1]=0},La._getSpeedBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[1]=-1,Lb[2]=0;var Lc=La.max.elements;Lc[0]=Lc[1]=1,Lc[2]=0},La.generatePositionAndDirection=function(La,Lb,Lc,Ld){var Le=La.elements,Lf=Lg._tempPositionPoint.elements;Lc?(Lc.seed=Ld[16],this.emitFromEdge?LT._randomPointUnitArcCircle(this.arc,Lg._tempPositionPoint,Lc):LT._randomPointInsideUnitArcCircle(this.arc,Lg._tempPositionPoint,Lc),Ld[16]=Lc.seed):this.emitFromEdge?LT._randomPointUnitArcCircle(this.arc,Lg._tempPositionPoint):LT._randomPointInsideUnitArcCircle(this.arc,Lg._tempPositionPoint),Le[0]=-Lf[0],Le[1]=Lf[1],Le[2]=0,Lgb.scale(La,this.radius,La),this.randomDirection?Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb):La.cloneTo(Lb)},La.cloneTo=function(La){Lc.prototype.cloneTo.call(this,La);var Lb=La;Lb.radius=this.radius,Lb.arc=this.arc,Lb.emitFromEdge=this.emitFromEdge,Lb.randomDirection=this.randomDirection},Ll(Lg,["_tempPositionPoint",function(){return this._tempPositionPoint=new Lfb}])}(LO),function(Lc){function Lm(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Lm.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Ln(Lm,"laya.d3.core.particleShuriKen.module.shape.ConeShape",Lc);var La=Lm.prototype;La._getShapeBoundBox=function(La){var Lb=this.radius+this.length*Math.sin(this.angle),Lc=this.length*Math.cos(this.angle),Ld=La.min.elements;Ld[0]=Ld[1]=-Lb,Ld[2]=0;var Le=La.max.elements;Le[0]=Le[1]=Lb,Le[2]=Lc},La._getSpeedBoundBox=function(La){var Lb=Math.sin(this.angle),Lc=La.min.elements;Lc[0]=Lc[1]=-Lb,Lc[2]=0;var Ld=La.max.elements;Ld[0]=Lc[1]=Lb,Ld[2]=1},La.generatePositionAndDirection=function(La,Lb,Lc,Ld){var Le,Lf=La.elements,Lg=Lb.elements,Lh=Lm._tempPositionPoint.elements,Li=NaN,Lj=NaN,Lk=Math.cos(this.angle),Ll=Math.sin(this.angle);switch(this.emitType){case 0:Lc?(Lc.seed=Ld[16],LT._randomPointInsideUnitCircle(Lm._tempPositionPoint,Lc),Ld[16]=Lc.seed):LT._randomPointInsideUnitCircle(Lm._tempPositionPoint),Li=Lh[0],Lj=Lh[1],Lf[0]=Li*this.radius,Lf[1]=Lj*this.radius,Lf[2]=0,this.randomDirection?(Lc?(Lc.seed=Ld[17],LT._randomPointInsideUnitCircle(Lm._tempDirectionPoint,Lc),Ld[17]=Lc.seed):LT._randomPointInsideUnitCircle(Lm._tempDirectionPoint),Le=Lm._tempDirectionPoint.elements,Lg[0]=Le[0]*Ll,Lg[1]=Le[1]*Ll):(Lg[0]=Li*Ll,Lg[1]=Lj*Ll),Lg[2]=Lk;break;case 1:Lc?(Lc.seed=Ld[16],LT._randomPointUnitCircle(Lm._tempPositionPoint,Lc),Ld[16]=Lc.seed):LT._randomPointUnitCircle(Lm._tempPositionPoint),Li=Lh[0],Lj=Lh[1],Lf[0]=Li*this.radius,Lf[1]=Lj*this.radius,Lf[2]=0,this.randomDirection?(Lc?(Lc.seed=Ld[17],LT._randomPointInsideUnitCircle(Lm._tempDirectionPoint,Lc),Ld[17]=Lc.seed):LT._randomPointInsideUnitCircle(Lm._tempDirectionPoint),Le=Lm._tempDirectionPoint.elements,Lg[0]=Le[0]*Ll,Lg[1]=Le[1]*Ll):(Lg[0]=Li*Ll,Lg[1]=Lj*Ll),Lg[2]=Lk;break;case 2:Lc?(Lc.seed=Ld[16],LT._randomPointInsideUnitCircle(Lm._tempPositionPoint,Lc)):LT._randomPointInsideUnitCircle(Lm._tempPositionPoint),Li=Lh[0],Lj=Lh[1],Lf[0]=Li*this.radius,Lf[1]=Lj*this.radius,Lg[Lf[2]=0]=Li*Ll,Lg[1]=Lj*Ll,Lg[2]=Lk,Lgb.normalize(Lb,Lb),Lc?(Lgb.scale(Lb,this.length*Lc.getFloat(),Lb),Ld[16]=Lc.seed):Lgb.scale(Lb,this.length*Math.random(),Lb),Lgb.add(La,Lb,La),this.randomDirection&&(Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb));break;case 3:Lc?(Lc.seed=Ld[16],LT._randomPointUnitCircle(Lm._tempPositionPoint,Lc)):LT._randomPointUnitCircle(Lm._tempPositionPoint),Li=Lh[0],Lj=Lh[1],Lf[0]=Li*this.radius,Lf[1]=Lj*this.radius,Lg[Lf[2]=0]=Li*Ll,Lg[1]=Lj*Ll,Lg[2]=Lk,Lgb.normalize(Lb,Lb),Lc?(Lgb.scale(Lb,this.length*Lc.getFloat(),Lb),Ld[16]=Lc.seed):Lgb.scale(Lb,this.length*Math.random(),Lb),Lgb.add(La,Lb,La),this.randomDirection&&(Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb));break;default:throw new Error("ConeShape:emitType is invalid.")}},La.cloneTo=function(La){Lc.prototype.cloneTo.call(this,La);var Lb=La;Lb.angle=this.angle,Lb.radius=this.radius,Lb.length=this.length,Lb.emitType=this.emitType,Lb.randomDirection=this.randomDirection},Ll(Lm,["_tempPositionPoint",function(){return this._tempPositionPoint=new Lfb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Lfb}])}(LO),function(Lc){function La(){this.radius=NaN,this.emitFromShell=!1,La.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Ln(La,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",Lc);var Lb=La.prototype;Lb._getShapeBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[1]=Lb[2]=-this.radius;var Lc=La.max.elements;Lc[0]=Lc[1]=this.radius,Lc[2]=0},Lb._getSpeedBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[1]=-1,Lb[2]=0;var Lc=La.max.elements;Lc[0]=Lc[1]=Lc[2]=1},Lb.generatePositionAndDirection=function(La,Lb,Lc,Ld){var Le=La.elements;Lc?(Lc.seed=Ld[16],this.emitFromShell?LT._randomPointUnitSphere(La,Lc):LT._randomPointInsideUnitSphere(La,Lc),Ld[16]=Lc.seed):this.emitFromShell?LT._randomPointUnitSphere(La):LT._randomPointInsideUnitSphere(La),Lgb.scale(La,this.radius,La);var Lf=Le[2];Lf<0&&(Le[2]=-1*Lf),this.randomDirection?Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb):La.cloneTo(Lb)},Lb.cloneTo=function(La){Lc.prototype.cloneTo.call(this,La);var Lb=La;Lb.radius=this.radius,Lb.emitFromShell=this.emitFromShell,Lb.randomDirection=this.randomDirection}}(LO),function(Lc){function La(){this.radius=NaN,this.emitFromShell=!1,La.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Ln(La,"laya.d3.core.particleShuriKen.module.shape.SphereShape",Lc);var Lb=La.prototype;Lb._getShapeBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[1]=Lb[2]=-this.radius;var Lc=La.max.elements;Lc[0]=Lc[1]=Lc[2]=this.radius},Lb._getSpeedBoundBox=function(La){var Lb=La.min.elements;Lb[0]=Lb[1]=Lb[2]=-1;var Lc=La.max.elements;Lc[0]=Lc[1]=Lc[2]=1},Lb.generatePositionAndDirection=function(La,Lb,Lc,Ld){Lc?(Lc.seed=Ld[16],this.emitFromShell?LT._randomPointUnitSphere(La,Lc):LT._randomPointInsideUnitSphere(La,Lc),Ld[16]=Lc.seed):this.emitFromShell?LT._randomPointUnitSphere(La):LT._randomPointInsideUnitSphere(La),Lgb.scale(La,this.radius,La),this.randomDirection?Lc?(Lc.seed=Ld[17],LT._randomPointUnitSphere(Lb,Lc),Ld[17]=Lc.seed):LT._randomPointUnitSphere(Lb):La.cloneTo(Lb)},Lb.cloneTo=function(La){Lc.prototype.cloneTo.call(this,La);var Lb=La;Lb.radius=this.radius,Lb.emitFromShell=this.emitFromShell,Lb.randomDirection=this.randomDirection}}(LO),function(La){function Lb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Lb.__super.call(this)}return Ln(Lb,"laya.d3.core.render.SubMeshRenderElement",LW),Lb}()),LAb=function(La){function Lq(La,Lb,Lc,Ld,Le,Lf){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=La,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Lnb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[LVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[LVb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[LEb.SHADERDEFINE_ALPHATEST]="ALPHATEST";Lq.__super.call(this,La,Lb,Lc,null,{}),this._attributeMap=Ld;var Lg;for(Lg in Le){var Lh=Le[Lg];switch(Lh[1]){case 0:this._renderElementUniformMap[Lg]=Lh[0];break;case 1:this._materialUniformMap[Lg]=Lh[0];break;case 2:this._spriteUniformMap[Lg]=Lh[0];break;case 3:this._cameraUniformMap[Lg]=Lh[0];break;case 4:this._sceneUniformMap[Lg]=Lh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Ln(Lq,"laya.d3.shader.ShaderCompile3D",Lt);var Lb=Lq.prototype;return Lb._definesToNameDic=function(La,Lb){for(var Lc={},Ld=1,Le=0;Le<32&&!(La<(Ld=1<<Le));Le++)if(La&Ld){var Lf=Lb[Ld];Lf&&(Lc[Lf]="")}return Lc},Lb.withCompile=function(La,Lb,Lc,Ld){var Le,Lf,Lg;if(Lf=this.sharders[La])if(Lg=Lf[Lb]){if(Le=Lg[Lc])return Le}else Lg=Lf[Lb]=[];else Lg=(Lf=this.sharders[La]=[])[Lb]=[];var Lh,Li=this._definesToNameDic(La,Lq._globalInt2name),Lj=this._definesToNameDic(Lb,this._spriteInt2name),Lk=this._definesToNameDic(Lc,this._materialInt2name),Ll={},Lm="";if(Li)for(Lh in Li)Lm+="#define "+Lh+"\n",Ll[Lh]=!0;if(Lj)for(Lh in Lj)Lm+="#define "+Lh+"\n",Ll[Lh]=!0;if(Lk)for(Lh in Lk)Lm+="#define "+Lh+"\n",Ll[Lh]=!0;var Ln=LLb.nameKey.getName(this._name)+" compile ("+La+","+Lb+","+Lc+")",Lo=this._VS.toscript(Ll,[]),Lp=this._PS.toscript(Ll,[]);LH.now();if(Le=LLb.create(Lm+Lo.join("\n"),Lm+Lp.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Ld,Ln),Lg[Lc]=Le,laya.d3.shader.ShaderCompile3D.debugMode)LH.now();return Le},Lb.precompileShaderWithShaderDefine=function(La,Lb,Lc){this.withCompile(La,Lb,Lc,!0)},Lb.addMaterialDefines=function(La){var Lb=La.defines;for(var Lc in Lb){var Ld=Lb[Lc],Le=parseInt(Lc);this._materialInt2name[Le]=Ld,this._materialName2Int[Ld]=Le}},Lb.addSpriteDefines=function(La){var Lb=La.defines;for(var Lc in Lb){var Ld=Lb[Lc],Le=parseInt(Lc);this._spriteInt2name[Le]=Ld,this._spriteName2Int[Ld]=Le}},Lb.getMaterialDefineByName=function(La){return this._materialName2Int[La]},Lb.registerMaterialDefine=function(La){var Lb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Lb]=La,this._materialName2Int[La]=Lb},Lb.registerSpriteDefine=function(La){var Lb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Lb]=La,this._spriteName2Int[La]=Lb},Lq._globalRegDefine=function(La,Lb){Lq._globalInt2name[Lb]=La},Lq.add=function(La,Lb,Lc,Ld,Le){return laya.d3.shader.ShaderCompile3D._preCompileShader[La]=new Lq(La,Lb,Lc,Ld,Le,Lt.includes)},Lq.get=function(La){return laya.d3.shader.ShaderCompile3D._preCompileShader[LLb.nameKey.getID(La)]},Lq._preCompileShader={},Lq._globalInt2name=[],Lq.debugMode=!1,Lq.SHADERDEFINE_HIGHPRECISION=1,Lq.SHADERDEFINE_FOG=4,Lq.SHADERDEFINE_DIRECTIONLIGHT=8,Lq.SHADERDEFINE_POINTLIGHT=16,Lq.SHADERDEFINE_SPOTLIGHT=32,Lq.SHADERDEFINE_UV0=64,Lq.SHADERDEFINE_COLOR=128,Lq.SHADERDEFINE_UV1=256,Lq.SAHDERDEFINE_DEPTHFOG=131072,Lq}(),LBb=function(La){function Lo(){Lo.__super.call(this)}Ln(Lo,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Lda);var Lb=Lo.prototype;return Lb._getStaticBatch=function(La,Lb,Lc,Ld){var Le,Lf;return Lf=La?La.id.toString()+Lc.id.toString()+Lb.id.toString()+Ld.toString():Lc.id.toString()+Lb.id.toString()+Ld.toString(),this._staticBatches[Lf]?Le=this._staticBatches[Lf]:this._staticBatches[Lf]=Le=new LCb(Lf,this,La,Lb,Lc),Le},Lb._initStaticBatchs=function(La){var Lb,Lc;this._initBatchRenderElements.sort(Lo._sortPrepareStaticBatch);for(var Ld,Le=!1,Lf=0,Lg=0,Lh=this._initBatchRenderElements.length;Lg<Lh;Lg++){var Li,Lj=this._initBatchRenderElements[Lg],Lk=Lj.renderObj._getVertexBuffer(0);Lj._sprite3D;if(Lc===Lk.vertexDeclaration&&Lb===Lj._material)if(Le)Ld._addCombineBatchRenderObjTest(Lj)?(Li=Lj._staticBatch)!==Ld&&(Li&&Li._deleteCombineBatchRenderObj(Lj),Ld._addCombineBatchRenderObj(Lj)):(Le=!1,Lf++);else{var Ll=this._initBatchRenderElements[Lg-1],Lm=Ll.renderObj,Ln=Lj.renderObj;Le=!(65535<Lm._getVertexBuffer().vertexCount+Ln._getVertexBuffer().vertexCount)&&(Ld=this._getStaticBatch(La,Lc,Lb,Lf),(Li=Ll._staticBatch)!==Ld&&(Li&&Li._deleteCombineBatchRenderObj(Ll),Ld._addCombineBatchRenderObj(Ll)),(Li=Lj._staticBatch)!==Ld&&(Li&&Li._deleteCombineBatchRenderObj(Lj),Ld._addCombineBatchRenderObj(Lj)),!0)}else Le=!1,Lf=0;Lb=Lj._material,Lc=Lk.vertexDeclaration}},Lo._sortPrepareStaticBatch=function(La,Lb){var Lc=La._render,Ld=Lb._render,Le=Lc.lightmapIndex-Ld.lightmapIndex;if(0!=Le)return Le;var Lf=Lc.receiveShadow-Ld.receiveShadow;if(0!=Lf)return Lf;var Lg=La._mainSortID-Lb._mainSortID;return 0==Lg?La.renderObj.triangleCount-Lb.renderObj.triangleCount:Lg},Lo}(),LCb=function(La){function Lf(La,Lb,Lc,Ld,Le){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Lf.__super.call(this,La,Lb,Lc),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Ld,this._material=Le}Ln(Lf,"laya.d3.graphics.SubMeshStaticBatch",Lea);var Lb=Lf.prototype;return Lb._compareBatchRenderElement=function(La,Lb){return La._batchIndexStart>Lb._batchIndexStart},Lb._addCombineBatchRenderObjTest=function(La){var Lb=La.renderObj._vertexCount;return!(65535<(0<Lb?this._currentCombineVertexCount+Lb:this._currentCombineVertexCount+La.renderObj._getVertexBuffer().vertexCount))},Lb._addCombineBatchRenderObj=function(La){var Lb=La.renderObj,Lc=Lb._vertexCount;this._initBatchRenderElements.push(La),La._staticBatch=this,0<Lc?(this._currentCombineIndexCount+=Lb._indexCount,this._currentCombineVertexCount+=Lc):(this._currentCombineIndexCount=this._currentCombineIndexCount+Lb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Lb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Lb._deleteCombineBatchRenderObj=function(La){var Lb=La.renderObj,Lc=this._initBatchRenderElements.indexOf(La);if(-1!==Lc){this._initBatchRenderElements.splice(Lc,1),La._staticBatch=null;var Ld=Lb._vertexCount;0<Ld?(this._currentCombineIndexCount=this._currentCombineIndexCount-Lb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Ld):(this._currentCombineIndexCount=this._currentCombineIndexCount-Lb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Lb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Lb._finishInit=function(){if(this._needFinishCombine){var La=0,Lb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var Lc=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Ld=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=LOb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=LNb.create("ushort",this._currentCombineIndexCount,35044);for(var Le=0,Lf=this._initBatchRenderElements.length;Le<Lf;Le++){var Lg=this._initBatchRenderElements[Le],Lh=Lg.renderObj,Li=Lh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,Lg._sprite3D),Lj=Lh.getIndices(),Lk=Lg._sprite3D.transform._isFrontFaceInvert,Ll=La/(this._vertexDeclaration.vertexStride/4)-Lh._vertexStart,Lm=Lb,Ln=Lm+Lj.length;Lg._batchIndexStart=Lm,Lg._batchIndexEnd=Ln,Ld.set(Lj,Lb);var Lo=0;if(Lk)for(Lo=Lm;Lo<Ln;Lo+=3){Ld[Lo]=Ll+Ld[Lo];var Lp=Ld[Lo+1],Lq=Ld[Lo+2];Ld[Lo+1]=Ll+Lq,Ld[Lo+2]=Ll+Lp}else for(Lo=Lm;Lo<Ln;Lo+=3)Ld[Lo]=Ll+Ld[Lo],Ld[Lo+1]=Ll+Ld[Lo+1],Ld[Lo+2]=Ll+Ld[Lo+2];Lb+=Lj.length,Lc.set(Li,La),La+=Li.length}this._vertexBuffer.setData(Lc),this._indexBuffer.setData(Ld),this._needFinishCombine=!1}},Lb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Lzb)},Lb._getRenderElement=function(La,Lb,Lc){for(var Ld,Le,Lf=this._batchRenderElements.length,Lg=!0,Lh=0;Lh<Lf;Lh++){var Li,Lj,Lk=(Le=this._batchRenderElements[Lh])._sprite3D._render;if(0!==Lh&&(Lg=(Li=(Ld=this._batchRenderElements[Lh-1])._sprite3D._render).lightmapIndex!==Lk.lightmapIndex||Li.receiveShadow!==Lk.receiveShadow||Ld._batchIndexEnd!==Le._batchIndexStart),Lg){(Lj=this._getCombineRenderElementFromPool()).renderObj=this,Lj._material=this._material,Lj._batchIndexStart=Le._batchIndexStart,Lj._batchIndexEnd=Le._batchIndexEnd;var Ll=Lk.lightmapIndex,Lm=Ll+1,Ln=this._batchOwnerIndices[Lm];Ln||(Ln=this._batchOwnerIndices[Lm]=[]);var Lo,Lp=Ln[Le._render.receiveShadow?1:0];void 0===Lp?(Ln[Lk.receiveShadow?1:0]=this._batchOwners.length,(Lo=new LXb(null,"StaticBatchMeshSprite3D"))._scene=Lb,Lo._transform=this._rootOwner?this._rootOwner._transform:null,Lo._render.lightmapIndex=Ll,Lo._render.receiveShadow=Le._render.receiveShadow,this._batchOwners.push(Lo)):Lo=this._batchOwners[Lp],Lo._render._renderUpdate(Lc),Lj._sprite3D=Lo,La.push(Lj)}else Lj._batchIndexEnd=Le._batchIndexEnd}},Lb._beforeRender=function(La){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Lb._render=function(La){var Lb=La.renderElement,Lc=Lb._batchIndexStart,Ld=Lb._batchIndexEnd-Lc;LF.mainContext.drawElements(4,Ld,5123,2*Lc),LA.drawCall++,LA.trianglesFaces+=Ld/3},Lb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Lb._getVertexBuffer=function(La){return void 0===La&&(La=0),this._vertexBuffer},Lf}(),LDb=function(La){function Lb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Lb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Ln(Lb,"laya.d3.core.ComponentNode",Lj);var Lc=Lb.prototype;return Lc.addComponent=function(La){var Lb,Lc=this._componentsMap.indexOf(La);if(-1===Lc)Lb=[],this._componentsMap.push(La),this._typeComponentsIndices.push(Lb);else if(Lb=this._typeComponentsIndices[Lc],this._components[Lb[0]].isSingleton)throw new Error("无法单实例创建"+La+"组件，"+La+"组件已存在！");var Ld=Le.getInstance(La);return Lb.push(this._components.length),this._components.push(Ld),Ld instanceof laya.d3.component.Script&&this._scripts.push(Ld),Ld._initialize(this),Ld},Lc._removeComponent=function(La,Lb){var Lc=this._typeComponentsIndices[La],Ld=Lc[Lb],Le=this._components[Ld];this._components.splice(Ld,1),Le instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Le),1),Lc.splice(Lb,1),0===Lc.length&&(this._typeComponentsIndices.splice(La,1),this._componentsMap.splice(La,1));for(var Lf=0,Lg=this._componentsMap.length;Lf<Lg;Lf++)for(var Lh=(Lc=this._typeComponentsIndices[Lf]).length-1;0<=Lh;Lh--){var Li=Lc[Lh];if(!(Ld<Li))break;Lc[Lh]=--Li}Le._destroy()},Lc.getComponentByType=function(La,Lb){void 0===Lb&&(Lb=0);var Lc=this._componentsMap.indexOf(La);return-1===Lc?null:this._components[this._typeComponentsIndices[Lc][Lb]]},Lc.getComponentsByType=function(La,Lb){var Lc=this._componentsMap.indexOf(La);if(-1!==Lc){var Ld=this._typeComponentsIndices[Lc],Le=Ld.length;Lb.length=Le;for(var Lf=0;Lf<Le;Lf++)Lb[Lf]=this._components[Ld[Lf]]}else Lb.length=0},Lc.getComponentByIndex=function(La){return this._components[La]},Lc.removeComponentByType=function(La,Lb){void 0===Lb&&(Lb=0);var Lc=this._componentsMap.indexOf(La);-1!==Lc&&this._removeComponent(Lc,Lb)},Lc.removeComponentsByType=function(La){var Lb=this._componentsMap.indexOf(La);if(-1!==Lb)for(var Lc=this._typeComponentsIndices[Lb],Ld=0,Le=Lc.length;Ld<Le;Lc.length<Le?Le--:Ld++)this._removeComponent(Lb,Ld)},Lc.removeAllComponent=function(){for(var La=0,Lb=this._componentsMap.length;La<Lb;this._componentsMap.length<Lb?Lb--:La++)this.removeComponentsByType(this._componentsMap[La])},Lc._updateComponents=function(La){for(var Lb=0,Lc=this._components.length;Lb<Lc;Lb++){var Ld=this._components[Lb];!Ld.started&&(Ld._start(La),Ld.started=!0),Ld.enable&&Ld._update(La)}},Lc._lateUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._lateUpdate(La)}},Lc._preRenderUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._preRenderUpdate(La)}},Lc._postRenderUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._postRenderUpdate(La)}},Lb}(),LEb=function(Ld){function La(){La.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Lmb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Lhb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Ln(La,"laya.d3.core.material.BaseMaterial",Ld);var Lb=La.prototype;return Lv.imps(Lb,{"laya.d3.core.IClone":!0}),Lb._addShaderDefine=function(La){this._shaderDefineValue|=La},Lb._removeShaderDefine=function(La){this._shaderDefineValue&=~La},Lb._addDisablePublicShaderDefine=function(La){this._disablePublicShaderDefine|=La},Lb._removeDisablePublicShaderDefine=function(La){this._disablePublicShaderDefine&=~La},Lb._setBuffer=function(La,Lb){this._shaderValues.setValue(La,Lb),this._values[La]=Lb},Lb._getBuffer=function(La){return this._values[La]},Lb._setMatrix4x4=function(La,Lb){this._shaderValues.setValue(La,Lb?Lb.elements:null),this._values[La]=Lb},Lb._getMatrix4x4=function(La){return this._values[La]},Lb._setInt=function(La,Lb){this._shaderValues.setValue(La,Lb),this._values[La]=Lb},Lb._getInt=function(La){return this._values[La]},Lb._setNumber=function(La,Lb){this._shaderValues.setValue(La,Lb),this._values[La]=Lb},Lb._getNumber=function(La){return this._values[La]},Lb._setBool=function(La,Lb){this._shaderValues.setValue(La,Lb),this._values[La]=Lb},Lb._getBool=function(La){return this._values[La]},Lb._setVector2=function(La,Lb){this._shaderValues.setValue(La,Lb?Lb.elements:null),this._values[La]=Lb},Lb._getVector2=function(La){return this._values[La]},Lb._setColor=function(La,Lb){this._shaderValues.setValue(La,Lb?Lb.elements:null),this._values[La]=Lb},Lb._getColor=function(La){return this._values[La]},Lb._setTexture=function(La,Lb){var Lc=this._values[La];this._values[La]=Lb,this._shaderValues.setValue(La,Lb),0<this.referenceCount&&(Lc&&Lc._removeReference(),Lb&&Lb._addReference())},Lb._getTexture=function(La){return this._values[La]},Lb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Lb._getShader=function(La,Lb,Lc){var Ld=(La|Lb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Ld,Lc,this._shaderDefineValue),this._shader},Lb._setRenderStateBlendDepth=function(){var La=LF.mainContext;switch(LG.setDepthMask(La,this.depthWrite),0===this.depthTest?LG.setDepthTest(La,!1):(LG.setDepthTest(La,!0),LG.setDepthFunc(La,this.depthTest)),this.blend){case 0:LG.setBlend(La,!1);break;case 1:LG.setBlend(La,!0),LG.setBlendFunc(La,this.srcBlend,this.dstBlend);break;case 2:LG.setBlend(La,!0)}},Lb._setRenderStateFrontFace=function(La,Lb){var Lc=LF.mainContext,Ld=0;switch(this.cull){case 0:LG.setCullFace(Lc,!1);break;case 1:LG.setCullFace(Lc,!0),Ld=La?Lb&&Lb._isFrontFaceInvert?2305:2304:Lb&&Lb._isFrontFaceInvert?2304:2305,LG.setFrontFace(Lc,Ld);break;case 2:LG.setCullFace(Lc,!0),Ld=La?Lb&&Lb._isFrontFaceInvert?2304:2305:Lb&&Lb._isFrontFaceInvert?2305:2304,LG.setFrontFace(Lc,Ld)}},Lb.onAsynLoaded=function(La,Lb,Lc){var Ld=Lb[0],Le=Lb[1];switch(Ld.version){case"LAYAMATERIAL:01":var Lf=0,Lg=0,Lh=Ld.props;for(var Li in Lh)switch(Li){case"vectors":var Lj=Lh[Li];for(Lf=0,Lg=Lj.length;Lf<Lg;Lf++){var Lk=Lj[Lf],Ll=Lk.value;switch(Ll.length){case 2:this[Lk.name]=new Lfb(Ll[0],Ll[1]);break;case 3:this[Lk.name]=new Lgb(Ll[0],Ll[1],Ll[2]);break;case 4:this[Lk.name]=new Lhb(Ll[0],Ll[1],Ll[2],Ll[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Lm=Lh[Li];for(Lf=0,Lg=Lm.length;Lf<Lg;Lf++){var Ln=Lm[Lf],Lo=Ln.path;Lo&&(this[Ln.name]=Lr.getRes(Le[Lo]))}break;case"defines":var Lp=Lh[Li];for(Lf=0,Lg=Lp.length;Lf<Lg;Lf++){var Lq=this._shaderCompile.getMaterialDefineByName(Lp[Lf]);this._addShaderDefine(Lq)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Li]=Lh[Li];break;case"renderQueue":switch(Lh[Li]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Li]=Lh[Li]}break;case"LAYAMATERIAL:02":for(Li in Lh=Ld.props)switch(Li){case"vectors":for(Lf=0,Lg=(Lj=Lh[Li]).length;Lf<Lg;Lf++)switch((Ll=(Lk=Lj[Lf]).value).length){case 2:this[Lk.name]=new Lfb(Ll[0],Ll[1]);break;case 3:this[Lk.name]=new Lgb(Ll[0],Ll[1],Ll[2]);break;case 4:this[Lk.name]=new Lhb(Ll[0],Ll[1],Ll[2],Ll[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Lf=0,Lg=(Lm=Lh[Li]).length;Lf<Lg;Lf++)(Lo=(Ln=Lm[Lf]).path)&&(this[Ln.name]=Lr.getRes(Le[Lo]));break;case"defines":for(Lf=0,Lg=(Lp=Lh[Li]).length;Lf<Lg;Lf++)Lq=this._shaderCompile.getMaterialDefineByName(Lp[Lf]),this._addShaderDefine(Lq);break;default:this[Li]=Lh[Li]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Lb._addReference=function(){Ld.prototype._addReference.call(this);for(var La=0,Lb=this._values.length;La<Lb;La++){var Lc=this._values[La];Lc&&Lc instanceof laya.d3.resource.BaseTexture&&Lc._addReference()}},Lb._removeReference=function(){Ld.prototype._removeReference.call(this);for(var La=0,Lb=this._values.length;La<Lb;La++){var Lc=this._values[La];Lc&&Lc instanceof laya.d3.resource.BaseTexture&&Lc._removeReference()}},Lb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Lb.setShaderName=function(La){var Lb=LLb.nameKey.getID(La);if(-1===Lb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=LAb._preCompileShader[Lb]},Lb.cloneTo=function(La){var Lb=La;Lb.name=this.name,Lb.cull=this.cull,Lb.blend=this.blend,Lb.srcBlend=this.srcBlend,Lb.dstBlend=this.dstBlend,Lb.srcBlendRGB=this.srcBlendRGB,Lb.dstBlendRGB=this.dstBlendRGB,Lb.srcBlendAlpha=this.srcBlendAlpha,Lb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Lb.blendConstColor),Lb.blendEquation=this.blendEquation,Lb.blendEquationRGB=this.blendEquationRGB,Lb.blendEquationAlpha=this.blendEquationAlpha,Lb.depthTest=this.depthTest,Lb.depthWrite=this.depthWrite,Lb.renderQueue=this.renderQueue,Lb._shader=this._shader,Lb._disablePublicShaderDefine=this._disablePublicShaderDefine,Lb._shaderDefineValue=this._shaderDefineValue;var Lc,Ld=0,Le=Lb._shaderValues;Lb._shaderValues.data.length=this._shaderValues.data.length;var Lf=this._values.length,Lg=Lb._values;for(Ld=0,Lc=Lg.length=Lf;Ld<Lc;Ld++){var Lh=this._values[Ld];if(Lh)if("number"==typeof Lh)Lg[Ld]=Lh,Le.data[Ld]=Lh;else if("number"==typeof Lh&&Math.floor(Lh)==Lh)Lg[Ld]=Lh,Le.data[Ld]=Lh;else if("boolean"==typeof Lh)Lg[Ld]=Lh,Le.data[Ld]=Lh;else if(Lh instanceof laya.d3.math.Vector2){var Li=Lg[Ld]||(Lg[Ld]=new Lfb);Lh.cloneTo(Li),Le.data[Ld]=Li.elements}else if(Lh instanceof laya.d3.math.Vector3){var Lj=Lg[Ld]||(Lg[Ld]=new Lgb);Lh.cloneTo(Lj),Le.data[Ld]=Lj.elements}else if(Lh instanceof laya.d3.math.Vector4){var Lk=Lg[Ld]||(Lg[Ld]=new Lhb);Lh.cloneTo(Lk),Le.data[Ld]=Lk.elements}else if(Lh instanceof laya.d3.math.Matrix4x4){var Ll=Lg[Ld]||(Lg[Ld]=new Lab);Lh.cloneTo(Ll),Le.data[Ld]=Ll.elements}else Lh instanceof laya.d3.resource.BaseTexture&&(Lg[Ld]=Lh,Le.data[Ld]=Lh)}},Lb.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lo(0,Lb,"alphaTestValue",function(){return this._getNumber(0)},function(La){this._setNumber(0,La)}),Lo(0,Lb,"alphaTest",function(){return this._alphaTest},function(La){(this._alphaTest=La)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),La.__init__=function(){La.SHADERDEFINE_ALPHATEST=La.shaderDefines.registerDefine("ALPHATEST")},La.RENDERQUEUE_OPAQUE=2e3,La.RENDERQUEUE_ALPHATEST=2450,La.RENDERQUEUE_TRANSPARENT=3e3,La.CULL_NONE=0,La.CULL_FRONT=1,La.CULL_BACK=2,La.BLEND_DISABLE=0,La.BLEND_ENABLE_ALL=1,La.BLEND_ENABLE_SEPERATE=2,La.BLENDPARAM_ZERO=0,La.BLENDPARAM_ONE=1,La.BLENDPARAM_SRC_COLOR=768,La.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,La.BLENDPARAM_DST_COLOR=774,La.BLENDPARAM_ONE_MINUS_DST_COLOR=775,La.BLENDPARAM_SRC_ALPHA=770,La.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,La.BLENDPARAM_DST_ALPHA=772,La.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,La.BLENDPARAM_SRC_ALPHA_SATURATE=776,La.BLENDEQUATION_ADD=0,La.BLENDEQUATION_SUBTRACT=1,La.BLENDEQUATION_REVERSE_SUBTRACT=2,La.DEPTHTEST_OFF=0,La.DEPTHTEST_NEVER=512,La.DEPTHTEST_LESS=513,La.DEPTHTEST_EQUAL=514,La.DEPTHTEST_LEQUAL=515,La.DEPTHTEST_GREATER=516,La.DEPTHTEST_NOTEQUAL=517,La.DEPTHTEST_GEQUAL=518,La.DEPTHTEST_ALWAYS=519,La.SHADERDEFINE_ALPHATEST=1,La.ALPHATESTVALUE=0,Ll(La,["shaderDefines",function(){return this.shaderDefines=new Lkb}]),La}(Lq),LFb=function(La){function Lb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Lb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Ln(Lb,"laya.d3.resource.BaseTexture",Lq);var Lc=Lb.prototype;return Lo(0,Lc,"width",function(){return this._width}),Lo(0,Lc,"repeat",function(){return this._repeat},function(La){if(this._repeat!==La&&(this._repeat=La,this._source)){var Lb=LF.mainContext;LG.bindTexture(Lb,this._type,this._source),Lu.isPOT(this._width,this._height)&&this._repeat?(Lb.texParameteri(this._type,10242,10497),Lb.texParameteri(this._type,10243,10497)):(Lb.texParameteri(this._type,10242,33071),Lb.texParameteri(this._type,10243,33071))}}),Lo(0,Lc,"height",function(){return this._height}),Lo(0,Lc,"magFifter",function(){return this._magFifter},function(La){(this._magFifter=La)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(La)}),Lo(0,Lc,"wrapModeV",function(){return this._wrapModeV}),Lo(0,Lc,"size",function(){return this._size}),Lo(0,Lc,"wrapModeU",function(){return this._wrapModeU}),Lo(0,Lc,"mipmap",function(){return this._mipmap},function(La){this._mipmap=La,this._mipmap!=La&&this._conchTexture&&this._conchTexture.setMipMap(La)}),Lo(0,Lc,"minFifter",function(){return this._minFifter},function(La){this._minFifter=La,this._minFifter!=La&&this._conchTexture&&this._conchTexture.setMinFifter(La)}),Lo(0,Lc,"format",function(){return this._format}),Lo(0,Lc,"source",function(){return this.activeResource(),this._source}),Lo(0,Lc,"defaulteTexture",function(){return LSb.grayTexture}),Lb.WARPMODE_REPEAT=0,Lb.WARPMODE_CLAMP=1,Lb}(),LGb=function(La){function Lb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Lb.__super.call(this),this._boundingBoxCorners=Ld(8,null)}Ln(Lb,"laya.d3.resource.models.BaseMesh",Lq);var Lc=Lb.prototype;return Lc._getPositions=function(){throw new Error("未Override,请重载该属性！")},Lc._generateBoundingObject=function(){this._boundingSphere=new L_a(new Lgb,0),L_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new LZa(new Lgb,new Lgb),LZa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},Lc.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},Lc.getRenderElement=function(La){throw new Error("未Override,请重载该属性！")},Lo(0,Lc,"subMeshCount",function(){return this._subMeshCount}),Lo(0,Lc,"boundingBox",function(){return this._boundingBox}),Lo(0,Lc,"boundingBoxCorners",function(){return this._boundingBoxCorners}),Lo(0,Lc,"boundingSphere",function(){return this._boundingSphere}),Lb}(),LHb=(function(La){function Lb(){Lb.__super.call(this)}Ln(Lb,"laya.d3.component.Script",Ltb);var Lc=Lb.prototype;Lc.onTriggerEnter=function(La){},Lc.onTriggerExit=function(La){},Lc.onTriggerStay=function(La){},Lo(0,Lc,"isSingleton",function(){return Lb._isSingleton}),Lb._isSingleton=!1}(),function(La){function Lb(La){this._owner=null,this._sharedMesh=null,Lb.__super.call(this),this._owner=La}Ln(Lb,"laya.d3.core.MeshFilter",La);var Lc=Lb.prototype;return Lc._sharedMeshLoaded=function(){this.event("loaded")},Lc._destroy=function(){La.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},Lo(0,Lc,"sharedMesh",function(){return this._sharedMesh},function(La){var Lb=this._sharedMesh;Lb&&Lb._removeReference(),(this._sharedMesh=La)._addReference(),this.event("meshchanged",[this,Lb,La]),La.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),Lo(0,Lc,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),Lo(0,Lc,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),Lo(0,Lc,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),Lo(0,Lc,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Lb}(Lub)),LIb=function(La){function Lb(La){Lb.__super.call(this,La),La.meshFilter.on("meshchanged",this,this._onMeshChanged)}Ln(Lb,"laya.d3.core.MeshRender",Lvb);var Lc=Lb.prototype;return Lc._onMeshChanged=function(La,Lb,Lc){Lc.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:Lc.once("loaded",this,this._onMeshLoaed)},Lc._onMeshLoaed=function(La,Lb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},Lc._calculateBoundingSphereByInitSphere=function(La){var Lb=NaN,Lc=this._owner.transform,Ld=Lc.scale.elements,Le=Math.abs(Ld[0]),Lf=Math.abs(Ld[1]),Lg=Math.abs(Ld[2]);Lb=Lf<=Le&&Lg<=Le?Le:Lg<=Lf?Lf:Lg,Lgb.transformCoordinate(La.center,Lc.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=La.radius*Lb},Lc._calculateBoundBoxByInitCorners=function(La){for(var Lb=this._owner.transform.worldMatrix,Lc=0;Lc<8;Lc++)Lgb.transformCoordinate(La[Lc],Lb,Lvb._tempBoundBoxCorners[Lc]);LZa.createfromPoints(Lvb._tempBoundBoxCorners,this._boundingBox)},Lc._calculateBoundingSphere=function(){var La=this._owner.meshFilter.sharedMesh;null==La||null==La.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(La.boundingSphere)},Lc._calculateBoundingBox=function(){var La=this._owner.meshFilter.sharedMesh;null==La||null==La.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(La.boundingBoxCorners)},Lc._renderUpdate=function(La){var Lb=this._owner.transform;if(Lb){this._setShaderValueMatrix4x4(0,Lb.worldMatrix);var Lc=this._owner.getProjectionViewWorldMatrix(La);this._setShaderValueMatrix4x4(1,Lc)}else this._setShaderValueMatrix4x4(0,Lab.DEFAULT),this._setShaderValueMatrix4x4(1,La);return Lrb.debugMode&&this._renderRenderableBoundBox(),!0},Lb}(),LJb=function(Lb){function Ld(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Ld.__super.call(this),this._renderState=new LY,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Lmb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Lba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new Lgb(.7,.7,.7),this.ambientColor=new Lgb(.212,.227,.259),LF.shaderHighPrecision&&this.addShaderDefine(LAb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Ln(Ld,"laya.d3.core.scene.Scene",Lb);var La=Ld.prototype;return Lv.imps(La,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),La._setUrl=function(La){this._url=La},La._getGroup=function(){return this._group},La._setGroup=function(La){this._group=La},La._display=function(){Lv.stage._scenes.push(this),Lv.stage._scenes.sort(Ld._sortScenes);for(var La=0,Lb=this._childs.length;La<Lb;La++){var Lc=this._childs[La];Lc.active&&Lc._activeHierarchy()}},La._unDisplay=function(){var La=Lv.stage._scenes;La.splice(La.indexOf(this),1);for(var Lb=0,Lc=this._childs.length;Lb<Lc;Lb++){var Ld=this._childs[Lb];Ld.active&&Ld._inActiveHierarchy()}},La._addChild3D=function(La){La.transform._onWorldTransform(),La._setBelongScene(this),this.displayedInStage&&La.active&&La._activeHierarchy()},La._removeChild3D=function(La){La.transform.parent=null,this.displayedInStage&&La.active&&La._inActiveHierarchy(),La._setUnBelongScene()},La.initOctree=function(La,Lb,Lc,Ld,Le){void 0===Le&&(Le=6),this.treeSize=new Lgb(La,Lb,Lc),this.treeLevel=Le,this.treeRoot=new LZ(this,0),this.treeRoot.init(Ld,this.treeSize)},La._prepareUpdateToRenderState=function(La,Lb){Lb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Lb.scene=this},La._prepareSceneToRender=function(La){var Lb=this._lights.length;if(0<Lb)for(var Lc=0,Ld=0;Ld<Lb&&!(this._lights[Ld]._prepareToScene(La)&&++Lc>=this._enableLightCount);Ld++);},La._updateChilds=function(La){for(var Lb=0,Lc=this._childs.length;Lb<Lc;++Lb)this._childs[Lb]._update(La)},La._preRenderScene=function(La,Lb,Lc){var Ld,Le=Lb._viewMatrix,Lf=Lb._projectionMatrix,Lg=Lb._projectionViewMatrix,Lh=0,Li=Lb.camera;for(Li.useOcclusionCulling?this.treeRoot?Lca.renderObjectCullingOctree(Lc,this,Li,Le,Lf,Lg):Lca.renderObjectCulling(Lc,this,Li,Le,Lf,Lg):Lca.renderObjectCullingNoBoundFrustum(this,Li,Le,Lf,Lg),Lh=0,Ld=this._quenes.length;Lh<Ld;Lh++)this._quenes[Lh]&&this._quenes[Lh]._preRender(Lb)},La._clear=function(La,Lb){var Lc=Lb._viewport,Ld=Lb.camera,Le=Lc.x,Lf=Ld.renderTargetSize.height-Lc.y-Lc.height,Lg=Lc.width,Lh=Lc.height;La.viewport(Le,Lf,Lg,Lh);var Li=256,Lj=Ld.renderTarget;switch(Ld.clearFlag){case 0:var Lk=Ld.clearColor;if(Lk){La.enable(3089),La.scissor(Le,Lf,Lg,Lh);var Ll=Lk.elements;La.clearColor(Ll[0],Ll[1],Ll[2],Ll[3]),Li|=16384}if(Lj)switch(Lk||(Li=16384),Lj.depthStencilFormat){case 33189:Li|=256;break;case 36168:Li|=1024;break;case 34041:Li|=256,Li|=1024}La.clear(Li),Lk&&La.disable(3089);break;case 1:case 2:if(Lj)switch(Li=16384,Lj.depthStencilFormat){case 33189:Li|=256;break;case 36168:Li|=1024;break;case 34041:Li|=256,Li|=1024}La.clear(Li);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},La._renderScene=function(La,Lb){var Lc,Ld,Le=Lb.camera,Lf=0;for(Lf=0;Lf<2;Lf++)(Ld=this._quenes[Lf])&&(Le.renderTarget?Ld._render(Lb,!0):Ld._render(Lb,!1));if(1===Le.clearFlag){var Lg=Le.sky;Lg&&(LG.setCullFace(La,!1),LG.setDepthFunc(La,515),LG.setDepthMask(La,!1),Lg._render(Lb),LG.setDepthFunc(La,513),LG.setDepthMask(La,!0))}for(Lf=2,Lc=this._quenes.length;Lf<Lc;Lf++)(Ld=this._quenes[Lf])&&(Ld._sortAlpha(Lb.camera.transform.position),Le.renderTarget?Ld._render(Lb,!0):Ld._render(Lb,!1))},La._set3DRenderConfig=function(La){La.disable(3042),LG._blend=!1,La.blendFunc(770,771),LG._sFactor=770,LG._dFactor=771,La.disable(2929),LG._depthTest=!1,La.enable(2884),LG._cullFace=!0,La.depthMask(1),LG._depthMask=!0,La.frontFace(2304),LG._frontFace=2304},La._set2DRenderConfig=function(La){LG.setBlend(La,!0),LG.setBlendFunc(La,1,771),LG.setDepthTest(La,!1),LG.setCullFace(La,!1),LG.setDepthMask(La,!0),LG.setFrontFace(La,2305),La.viewport(0,0,Lk.width,Lk.height)},La._parseCustomProps=function(La,Lb,Lc,Ld){var Le=Ld.customProps.lightmaps,Lf=Le.length,Lg=this._lightmaps;Lg.length=Lf;for(var Lh=0;Lh<Lf;Lh++)Lg[Lh]=Lr.getRes(Lb[Le[Lh].replace(".exr",".png")]);this.setlightmaps(Lg);var Li=Ld.customProps.ambientColor;Li&&(this.ambientColor=new Lgb(Li[0],Li[1],Li[2]));var Lj=Ld.customProps.fogColor;Lj&&(this.fogColor=new Lgb(Lj[0],Lj[1],Lj[2]))},La._addLight=function(La){this._lights.indexOf(La)<0&&this._lights.push(La)},La._removeLight=function(La){var Lb=this._lights.indexOf(La);0<=Lb&&this._lights.splice(Lb,1)},La._updateScene=function(){var La=this._renderState;this._prepareUpdateToRenderState(LF.mainContext,La),this._updateComponents(La),this._updateChilds(La),this._lateUpdateComponents(La),this._time+=La.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},La._updateSceneConch=function(){var La=this._renderState;this._prepareUpdateToRenderState(LF.mainContext,La),this._updateComponents(La),this._lateUpdateComponents(La),this._prepareSceneToRender(La);for(var Lb=0,Lc=this._cameraPool.length;Lb<Lc;Lb++){var Ld=this._cameraPool[Lb];(La.camera=Ld)._prepareCameraToRender()}},La._preRenderShadow=function(La,Lb,Lc,Ld,Le){this.treeRoot?Lca.renderShadowObjectCullingOctree(this,Lb,Lc,Ld,Le):Lca.renderShadowObjectCulling(this,Lb,Lc,Ld,Le);for(var Lf=0,Lg=Lc.length;Lf<Lg;Lf++)Lc[Lf]&&Lc[Lf]._preRender(La)},La._renderShadowMap=function(La,Lb,Lc){var Ld=this.parallelSplitShadowMaps[0];Ld._calcAllLightCameraInfo(Lc);var Le,Lf,Lg,Lh=Ld.PSSMNum;if(this._preRenderShadow(Lb,Ld._lightCulling,Ld._shadowQuenes,Ld._lightVPMatrix[0],Lh),this.addShaderDefine(Lnb.SHADERDEFINE_CAST_SHADOW),1<Lh)for(var Li=0;Li<Lh;Li++)Le=Ld.getRenderTarget(Li+1),Ld.beginRenderTarget(Li+1),La.clearColor(1,1,1,1),La.clear(16640),La.viewport(0,0,Le.width,Le.height),Lb.camera=Lg=Ld.getLightCamera(Li),Lg._prepareCameraToRender(),Lg._prepareCameraViewProject(Lg.viewMatrix,Lg.projectionMatrix),Lb._projectionViewMatrix=Ld._lightVPMatrix[Li+1],(Lf=Ld._shadowQuenes[Li])._preRender(Lb),Lf._renderShadow(Lb,!1),Ld.endRenderTarget(Li+1);else Le=Ld.getRenderTarget(1),Ld.beginRenderTarget(1),La.clearColor(1,1,1,1),La.clear(16640),La.viewport(0,0,Le.width,Le.height),Lb.camera=Lg=Ld.getLightCamera(0),Lg._prepareCameraToRender(),Lg._prepareCameraViewProject(Lg.viewMatrix,Lg.projectionMatrix),Lb._projectionViewMatrix=Ld._lightVPMatrix[0],(Lf=Ld._shadowQuenes[0])._preRender(Lb),Lf._renderShadow(Lb,!0),Ld.endRenderTarget(1);this.removeShaderDefine(Lnb.SHADERDEFINE_CAST_SHADOW)},La.addTreeNode=function(La){this.treeRoot.addTreeNode(La)},La.removeTreeNode=function(La){this.treeSize&&La._treeNode&&La._treeNode.removeObject(La)},La.setlightmaps=function(La){this._lightmaps=La;for(var Lb=0,Lc=this._renderableSprite3Ds.length;Lb<Lc;Lb++)this._renderableSprite3Ds[Lb]._render._applyLightMapParams()},La.getlightmaps=function(){return this._lightmaps},La.addChildAt=function(La,Lb){if(!(La instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(La&&La.__className));if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),0<=Lb&&Lb<=this._childs.length){if(La._parent===this){var Lc=this.getChildIndex(La);this._childs.splice(Lc,1),this._childs.splice(Lb,0,La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,Lb)),this._childChanged()}else La.parent&&La.parent.removeChild(La),this._childs===Lj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Lb,0,La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,Lb),(La.parent=this)._addChild3D(La);return La}throw new Error("appendChildAt:The index is out of bounds")},La.addChild=function(La){if(!(La instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),La._parent===this){var Lb=this.getChildIndex(La);Lb!==this._childs.length-1&&(this._childs.splice(Lb,1),this._childs.push(La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,this._childs.length-1)),this._childChanged())}else La.parent&&La.parent.removeChild(La),this._childs===Lj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,this._childs.length-1),(La.parent=this)._childChanged(),this._addChild3D(La);return La},La.removeChildAt=function(La){var Lb=this.getChildAt(La);return Lb&&(this._removeChild3D(Lb),this._childs.splice(La,1),this.conchModel&&this.conchModel.removeChild(Lb.conchModel),Lb.parent=null),Lb},La.removeChildren=function(La,Lb){if(void 0===La&&(La=0),void 0===Lb&&(Lb=2147483647),this._childs&&0<this._childs.length){var Lc=this._childs;if(0===La&&Lf<=Lb){var Ld=Lc;this._childs=Lj.ARRAY_EMPTY}else Ld=Lc.splice(La,Lb-La);for(var Le=0,Lf=Ld.length;Le<Lf;Le++)this._removeChild3D(Ld[Le]),Ld[Le].parent=null,this.conchModel&&this.conchModel.removeChild(Ld[Le].conchModel)}return this},La.addFrustumCullingObject=function(La){this.treeRoot?this.addTreeNode(La):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(La):this._cullingRenders[this._cullingRendersLength]=La,La._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},La.removeFrustumCullingObject=function(La){if(this.treeRoot)this.removeTreeNode(La);else{this._cullingRendersLength--;var Lb=La._indexInSceneFrustumCullingObjects;if(Lb!==this._cullingRendersLength){var Lc=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Lb]=Lc)._indexInSceneFrustumCullingObjects=Lb,La._indexInSceneFrustumCullingObjects=-1}}},La.getRenderQueue=function(La){return La<3e3?this._quenes[1]||(this._quenes[1]=new LX(this)):this._quenes[2]||(this._quenes[2]=new LX(this))},La.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new LX(this)},La.addShaderDefine=function(La){this._shaderDefineValue|=La},La.removeShaderDefine=function(La){this._shaderDefineValue&=~La},La.addScript=function(La){return this._addComponent(La)},La.getScriptByType=function(La,Lb){return void 0===Lb&&(Lb=0),this._getComponentByType(La,Lb)},La.getScriptsByType=function(La,Lb){this._getComponentsByType(La,Lb)},La.getScriptByIndex=function(La){return this._getComponentByIndex(La)},La.removeScriptByType=function(La,Lb){void 0===Lb&&(Lb=0),this._removeComponentByType(La,Lb)},La.removeScriptsByType=function(La){this._removeComponentByType(La)},La.removeAllScript=function(){this._removeAllComponent()},La.render=function(La,Lb,Lc){(Lp._context.ctx._renderKey=0)<this._childs.length&&La.addRenderObject(this)},La.renderSubmit=function(){var La=LF.mainContext,Lb=this._renderState;this._set3DRenderConfig(La),this._prepareSceneToRender(this._renderState);var Lc,Ld=0,Le=0;if(Lrb.debugMode||LZ.debugMode)for(Ld=0,Le=this._cameraPool.length;Ld<Le;Ld++)Lc=this._cameraPool[Ld],Lrb._debugPhasorSprite.begin(1,Lc),Lc.activeInHierarchy&&Lc._renderCamera(La,Lb,this),Lrb._debugPhasorSprite.end();else for(Ld=0,Le=this._cameraPool.length;Ld<Le;Ld++)(Lc=this._cameraPool[Ld]).activeInHierarchy&&Lc._renderCamera(La,Lb,this);return this._set2DRenderConfig(La),1},La.onAsynLoaded=function(La,Lb,Lc){var Ld=Lb[0];if("Scene"!==Ld.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var Le=Lb[1];Lqb._createNodeByJson(this,Ld,this,Le),this.event("hierarchyloaded",[this]),this.__loaded=!0},La.destroy=function(La){void 0===La&&(La=!0),this.destroyed||(Lb.prototype.destroy.call(this,La),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,Lr.clearRes(this.url),this.loaded||Lrb._cancelLoadByUrl(this.url))},La.getRenderType=function(){return 0},La.releaseRender=function(){},La._addComponent=function(La){var Lb,Lc=this._componentsMap.indexOf(La);if(-1===Lc)Lb=[],this._componentsMap.push(La),this._typeComponentsIndices.push(Lb);else if(Lb=this._typeComponentsIndices[Lc],this._components[Lb[0]].isSingleton)throw new Error("无法单实例创建"+La+"组件，"+La+"组件已存在！");var Ld=Le.getInstance(La);Lb.push(this._components.length),this._components.push(Ld);return Ld._initialize(this),Ld},La._removeComponent=function(La,Lb){var Lc=this._typeComponentsIndices[La],Ld=Lc[Lb],Le=this._components[Ld];this._components.splice(Ld,1),Lc.splice(Lb,1),0===Lc.length&&(this._typeComponentsIndices.splice(La,1),this._componentsMap.splice(La,1));for(var Lf=0,Lg=this._componentsMap.length;Lf<Lg;Lf++)for(var Lh=(Lc=this._typeComponentsIndices[Lf]).length-1;0<=Lh;Lh--){var Li=Lc[Lh];if(!(Ld<Li))break;Lc[Lh]=--Li}Le._destroy()},La._getComponentByType=function(La,Lb){void 0===Lb&&(Lb=0);var Lc=this._componentsMap.indexOf(La);return-1===Lc?null:this._components[this._typeComponentsIndices[Lc][Lb]]},La._getComponentsByType=function(La,Lb){var Lc=this._componentsMap.indexOf(La);if(-1!==Lc){var Ld=this._typeComponentsIndices[Lc],Le=Ld.length;Lb.length=Le;for(var Lf=0;Lf<Le;Lf++)Lb[Lf]=this._components[Ld[Lf]]}else Lb.length=0},La._getComponentByIndex=function(La){return this._components[La]},La._removeComponentByType=function(La,Lb){void 0===Lb&&(Lb=0);var Lc=this._componentsMap.indexOf(La);-1!==Lc&&this._removeComponent(Lc,Lb)},La._removeComponentsByType=function(La){var Lb=this._componentsMap.indexOf(La);if(-1!==Lb)for(var Lc=this._typeComponentsIndices[Lb],Ld=0,Le=Lc.length;Ld<Le;Lc.length<Le?Le--:Ld++)this._removeComponent(Lb,Ld)},La._removeAllComponent=function(){for(var La=0,Lb=this._componentsMap.length;La<Lb;this._componentsMap.length<Lb?Lb--:La++)this._removeComponentsByType(this._componentsMap[La])},La._updateComponents=function(La){for(var Lb=0,Lc=this._components.length;Lb<Lc;Lb++){var Ld=this._components[Lb];!Ld.started&&(Ld._start(La),Ld.started=!0),Ld.enable&&Ld._update(La)}},La._lateUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._lateUpdate(La)}},La._preRenderUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._preRenderUpdate(La)}},La._postRenderUpdateComponents=function(La){for(var Lb=0;Lb<this._components.length;Lb++){var Lc=this._components[Lb];!Lc.started&&(Lc._start(La),Lc.started=!0),Lc.enable&&Lc._postRenderUpdate(La)}},Lo(0,La,"_loaded",null,function(La){this.__loaded=La}),Lo(0,La,"fogColor",function(){return this._fogColor},function(La){this._fogColor=La,this._shaderValues.setValue(0,La.elements)}),Lo(0,La,"enableFog",function(){return this._enableFog},function(La){this._enableFog!==La&&((this._enableFog=La)?(this.addShaderDefine(LAb.SHADERDEFINE_FOG),this.removeShaderDefine(LAb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(LAb.SHADERDEFINE_FOG))}),Lo(0,La,"url",function(){return this._url}),Lo(0,La,"loaded",function(){return this.__loaded}),Lo(0,La,"enableDepthFog",function(){return this._enableDepthFog},function(La){this._enableDepthFog!=La&&((this._enableDepthFog=La)?(this.addShaderDefine(LAb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(LAb.SHADERDEFINE_FOG)):this.removeShaderDefine(LAb.SAHDERDEFINE_DEPTHFOG))}),Lo(0,La,"fogStart",function(){return this._fogStart},function(La){this._fogStart=La,this._shaderValues.setValue(1,La)}),Lo(0,La,"fogRange",function(){return this._fogRange},function(La){this._fogRange=La,this._shaderValues.setValue(2,La)}),Lo(0,La,"ambientColor",function(){return this._ambientColor},function(La){this._ambientColor=La,this._shaderValues.setValue(21,La.elements)}),Lo(0,La,"scene",function(){return this}),Lo(0,La,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Ld._sortScenes=function(La,Lb){if(La.parent!==Lv.stage||Lb.parent!==Lv.stage)return La.parent!==Lv.stage&&Lb.parent!==Lv.stage?Ld._sortScenes(La.parent,Lb.parent):La.parent===Lv.stage?-1:1;var Lc=Lv.stage._childs;return Lc.indexOf(La)-Lc.indexOf(Lb)},Ld.load=function(La){return Lv.loader.create(La,null,null,Ld)},Ld.FOGCOLOR=0,Ld.FOGSTART=1,Ld.FOGRANGE=2,Ld.LIGHTDIRECTION=3,Ld.LIGHTDIRCOLOR=4,Ld.POINTLIGHTPOS=5,Ld.POINTLIGHTRANGE=6,Ld.POINTLIGHTATTENUATION=7,Ld.POINTLIGHTCOLOR=8,Ld.SPOTLIGHTPOS=9,Ld.SPOTLIGHTDIRECTION=10,Ld.SPOTLIGHTSPOT=11,Ld.SPOTLIGHTRANGE=12,Ld.SPOTLIGHTATTENUATION=13,Ld.SPOTLIGHTCOLOR=14,Ld.SHADOWDISTANCE=15,Ld.SHADOWLIGHTVIEWPROJECT=16,Ld.SHADOWMAPPCFOFFSET=17,Ld.SHADOWMAPTEXTURE1=18,Ld.SHADOWMAPTEXTURE2=19,Ld.SHADOWMAPTEXTURE3=20,Ld.AMBIENTCOLOR=21,Ld.TIME=22,Ld}(Lz),LKb=function(La){function Lb(La){Lb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Lab,this._shaderValues=new Lmb,this._colliders=[],this._id=++Lb._uniqueIDCounter,this._transform=new Lyb(this),this.name=La||"Sprite3D-"+Lb._nameNumberCounter++,this.layer=LI.currentCreationLayer,this.active=!0}Ln(Lb,"laya.d3.core.Sprite3D",LDb);var Lc=Lb.prototype;return Lv.imps(Lc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),Lc._setUrl=function(La){this._url=La},Lc._getGroup=function(){return this._group},Lc._setGroup=function(La){this._group=La},Lc._addChild3D=function(La){La.transform.parent=this.transform,this._hierarchyAnimator&&(!La._hierarchyAnimator&&La._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(La,!0,[La.name])),this._scene&&(La._setBelongScene(this._scene),this._activeInHierarchy&&La._active&&La._activeHierarchy())},Lc._removeChild3D=function(La){La.transform.parent=null,this._scene&&(this._activeInHierarchy&&La._active&&La._inActiveHierarchy(),La._setUnBelongScene()),this._hierarchyAnimator&&(La._hierarchyAnimator==this._hierarchyAnimator&&La._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(La,!1,[La.name]))},Lc._parseBaseCustomProps=function(La){var Lb=this.transform.localPosition;La.translate?(Lb.fromArray(La.translate),Lb.x*=100,Lb.y*=100,Lb.z*=100):Lb.elements.fill(0),this.transform.localPosition=Lb;var Lc=this.transform.localRotation;La.rotation?Lc.fromArray(La.rotation):Lc.fromArray([0,0,0,-1]),this.transform.localRotation=Lc;var Ld=this.transform.localScale;La.scale?Ld.fromArray(La.scale):Ld.elements.fill(1),this.transform.localScale=Ld;var Le=La.layer;null!=Le&&(this.layer=LI.getLayerByNumber(Le))},Lc._parseCustomComponent=function(La,Lb,Lc){for(var Ld in Lc){var Le=Lc[Ld];switch(Ld){case"Animator":var Lf=this.addComponent(Animator);if(Le.avatarPath)Lf.avatar=Lr.getRes(Lb[Le.avatarPath]);else{var Lg=Le.avatar;if(Lg){Lf.avatar=Lr.getRes(Lb[Lg.path]);var Lh=Lg.linkSprites;Lh&&La.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Lf,Lh])}}for(var Li=Le.clipPaths,Lj=Li.length,Lk=0;Lk<Lj;Lk++)Lf.addClip(Lr.getRes(Lb[Li[Lk]]));Lf.clip=Lr.getRes(Lb[Li[0]]);var Ll=Le.playOnWake;void 0!==Ll&&(Lf.playOnWake=Ll);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Lm=this.addComponent(SphereCollider);Lm.isTrigger=Le.isTrigger;var Ln=Lm.center;Ln.fromArray(Le.center),Lm.center=Ln,Lm.radius=Le.radius;break;case"BoxCollider":var Lo=this.addComponent(BoxCollider);Lo.isTrigger=Le.isTrigger,Lo.center.fromArray(Le.center);var Lp=Lo.size;Lp.fromArray(Le.size),Lo.size=Lp;break;case"MeshCollider":this.addComponent(MeshCollider)}}},Lc._onRootNodeHierarchyLoaded=function(La,Lb){for(var Lc in Lb){for(var Ld=this,Le=Lb[Lc],Lf=0,Lg=Le.length;Lf<Lg;Lf++){var Lh=Le[Lf];if(""===Lh)break;if(!(Ld=Ld.getChildByName(Lh)))break}Ld&&La.linkSprite3DToAvatarNode(Lc,Ld)}},Lc._setHierarchyAnimator=function(La,Lb){this._changeHierarchyAnimator(La);for(var Lc=0,Ld=this._childs.length;Lc<Ld;Lc++){var Le=this._childs[Lc];Le._hierarchyAnimator==Lb&&Le._setHierarchyAnimator(La,Lb)}},Lc._clearHierarchyAnimator=function(La,Lb){this._changeHierarchyAnimator(Lb);for(var Lc=0,Ld=this._childs.length;Lc<Ld;Lc++){var Le=this._childs[Lc];Le._hierarchyAnimator==La&&Le._clearHierarchyAnimator(La,Lb)}},Lc._getAnimatorToLinkSprite3D=function(La,Lb,Lc){var Ld=this.getComponentByType(Animator);if(Ld&&(Ld.avatar?Ld.avatar._version||La._setAnimatorToLinkAvatar(Ld,Lb):La._setAnimatorToLinkSprite3DNoAvatar(Ld,Lb,Lc)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){Lc.unshift(this._parent.name);var Le=this._parent;Le._hierarchyAnimator&&Le._getAnimatorToLinkSprite3D(La,Lb,Lc)}},Lc._setAnimatorToLinkSprite3DNoAvatar=function(La,Lb,Lc){var Ld=0,Le=0;for(Ld=0,Le=La.getClipCount();Ld<Le;Ld++)La._handleSpriteOwnersBySprite(Ld,Lb,Lc,this);for(Ld=0,Le=this._childs.length;Ld<Le;Ld++){var Lf=this._childs[Ld],Lg=Lc.length;Lc.push(Lf.name),Lf._setAnimatorToLinkSprite3DNoAvatar(La,Lb,Lc),Lc.splice(Lg,1)}},Lc._changeHierarchyAnimator=function(La){this._hierarchyAnimator=La},Lc._isLinkSpriteToAnimationNode=function(La,Lb,Lc){var Ld=La._avatarNodes.indexOf(Lb),Le=La._cacheSpriteToNodesMap;if(Lc)this._transform.dummy=Lb.transform,La._cacheNodesToSpriteMap[Ld]=Le.length,Le.push(Ld);else{this._transform.dummy=null;var Lf=La._cacheNodesToSpriteMap[Ld];La._cacheNodesToSpriteMap[Ld]=null,Le.splice(Lf,1)}},Lc._setBelongScene=function(La){this._scene=La;for(var Lb=0,Lc=this._childs.length;Lb<Lc;Lb++)this._childs[Lb]._setBelongScene(La)},Lc._setUnBelongScene=function(){this._scene=null;for(var La=0,Lb=this._childs.length;La<Lb;La++)this._childs[La]._setUnBelongScene()},Lc._activeHierarchy=function(){var La=0,Lb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),La=0,Lb=this._colliders.length;La<Lb;La++)this._layer._addCollider(this._colliders[La]);for(this.event("activeinhierarchychanged",!0),La=0,Lb=this._childs.length;La<Lb;La++){var Lc=this._childs[La];Lc._active&&Lc._activeHierarchy()}},Lc._inActiveHierarchy=function(){var La=0,Lb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),La=0,Lb=this._colliders.length;La<Lb;La++){var Lc=this._colliders[La];Lc._clearCollsionMap(),this._layer._removeCollider(Lc)}for(this.event("activeinhierarchychanged",!1),La=0,Lb=this._childs.length;La<Lb;La++){var Ld=this._childs[La];Ld._active&&Ld._inActiveHierarchy()}},Lc.addComponent=function(La){var Lb,Lc=this._componentsMap.indexOf(La);if(-1===Lc)Lb=[],this._componentsMap.push(La),this._typeComponentsIndices.push(Lb);else if(Lb=this._typeComponentsIndices[Lc],this._components[Lb[0]].isSingleton)throw new Error("无法单实例创建"+La+"组件，"+La+"组件已存在！");var Ld=Le.getInstance(La);return Lb.push(this._components.length),this._components.push(Ld),Ld instanceof laya.d3.component.Script&&this._scripts.push(Ld),Ld._initialize(this),Ld},Lc._removeComponent=function(La,Lb){var Lc,Ld=0,Le=this._typeComponentsIndices[La],Lf=Le[Lb],Lg=this._components[Lf];for(Lg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Lg),1),Le.splice(Lb,1),0===Le.length&&(this._typeComponentsIndices.splice(La,1),this._componentsMap.splice(La,1)),Ld=0,Lc=this._componentsMap.length;Ld<Lc;Ld++)for(var Lh=(Le=this._typeComponentsIndices[Ld]).length-1;0<=Lh;Lh--){var Li=Le[Lh];if(!(Lf<Li))break;Le[Lh]=--Li}Lg._destroy()},Lc._clearSelfRenderObjects=function(){},Lc._addSelfRenderObjects=function(){},Lc._parseCustomProps=function(La,Lb,Lc,Ld){},Lc._updateChilds=function(La){var Lb=this._childs.length;if(0!==Lb)for(var Lc=0;Lc<Lb;++Lc)this._childs[Lc]._update(La)},Lc._getSortID=function(La,Lb){return 1e3*Lb.id+La._getVertexBuffer().vertexDeclaration.id},Lc._update=function(La){(La.owner=this)._activeInHierarchy&&(this._updateComponents(La),this._lateUpdateComponents(La),LA.spriteCount++,this._childs.length&&this._updateChilds(La))},Lc.getProjectionViewWorldMatrix=function(La){return Lab.multiply(La,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},Lc.loadHierarchy=function(La){this.addChild(laya.d3.core.Sprite3D.load(La))},Lc.addChildAt=function(La,Lb){if(!(La instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),0<=Lb&&Lb<=this._childs.length){if(La._parent===this){var Lc=this.getChildIndex(La);this._childs.splice(Lc,1),this._childs.splice(Lb,0,La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,Lb)),this._childChanged()}else La.parent&&La.parent.removeChild(La),this._childs===Lj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Lb,0,La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,Lb),(La.parent=this)._addChild3D(La);return La}throw new Error("appendChildAt:The index is out of bounds")},Lc.addChild=function(La){if(!(La instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!La||this.destroyed||La===this)return La;if(La.zOrder&&this._set$P("hasZorder",!0),La._parent===this){var Lb=this.getChildIndex(La);Lb!==this._childs.length-1&&(this._childs.splice(Lb,1),this._childs.push(La),this.conchModel&&(this.conchModel.removeChild(La.conchModel),this.conchModel.addChildAt(La.conchModel,this._childs.length-1)),this._childChanged())}else La.parent&&La.parent.removeChild(La),this._childs===Lj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(La),this.conchModel&&this.conchModel.addChildAt(La.conchModel,this._childs.length-1),(La.parent=this)._childChanged(),this._addChild3D(La);return La},Lc.removeChildAt=function(La){var Lb=this.getChildAt(La);return Lb&&(this._removeChild3D(Lb),this._childs.splice(La,1),this.conchModel&&this.conchModel.removeChild(Lb.conchModel),Lb.parent=null),Lb},Lc.removeChildren=function(La,Lb){if(void 0===La&&(La=0),void 0===Lb&&(Lb=2147483647),this._childs&&0<this._childs.length){var Lc=this._childs;if(0===La&&Lf<=Lb){var Ld=Lc;this._childs=Lj.ARRAY_EMPTY}else Ld=Lc.splice(La,Lb-La);for(var Le=0,Lf=Ld.length;Le<Lf;Le++)this._removeChild3D(Ld[Le]),Ld[Le].parent=null,this.conchModel&&this.conchModel.removeChild(Ld[Le].conchModel)}return this},Lc.onAsynLoaded=function(La,Lb,Lc){var Ld=Lb[0];if("Sprite3D"!==Ld.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var Le=Lb[1];Lqb._createNodeByJson(this,Ld,this,Le),this.event("hierarchyloaded",[this]),this.__loaded=!0},Lc.cloneTo=function(La){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Lb=La;Lb.name=this.name,Lb._destroyed=this._destroyed,Lb.timer=this.timer,Lb._$P=this._$P,Lb.active=this._active;var Lc=Lb.transform.localPosition;this.transform.localPosition.cloneTo(Lc),Lb.transform.localPosition=Lc;var Ld=Lb.transform.localRotation;this.transform.localRotation.cloneTo(Ld),Lb.transform.localRotation=Ld;var Le=Lb.transform.localScale;this.transform.localScale.cloneTo(Le),Lb.transform.localScale=Le,Lb.isStatic=this.isStatic;var Lf=0,Lg=0;for(Lf=0,Lg=this._componentsMap.length;Lf<Lg;Lf++){var Lh=Lb.addComponent(this._componentsMap[Lf]);this._components[Lf]._cloneTo(Lh)}for(Lf=0,Lg=this._childs.length;Lf<Lg;Lf++)Lb.addChild(this._childs[Lf].clone());var Li=Lb.getComponentByType(Animator);if(Li){var Lj=Li._linkSpritesData;if(Lj)for(var Lk in Lj){for(var Ll=Lj[Lk],Lm=Lb,Ln=0,Lo=Ll.length;Ln<Lo&&(Lm=Lm.getChildByName(Ll[Ln]));Ln++);if(Lm){var Lp=Li._avatarNodeMap[Lk];Lm._isLinkSpriteToAnimationNode(Li,Lp,!0)}}}},Lc.clone=function(){var La=new this.constructor;return this.cloneTo(La),La},Lc.destroy=function(La){if(void 0===La&&(La=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,La);var Lb,Lc=0;for(Lc=0,Lb=this._components.length;Lc<Lb;Lc++)this._components[Lc]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,Lr.clearRes(this.url),this.loaded||Lrb._cancelLoadByUrl(this.url)}},Lc._handleSpriteToAvatar=function(La,Lb){La._avatarNodes;var Lc=La._avatarNodeMap[this.name];Lc&&Lc.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(La,Lc,Lb)},Lc._setAnimatorToLinkAvatar=function(La,Lb){this._handleSpriteToAvatar(La,Lb);for(var Lc=0,Ld=this._childs.length;Lc<Ld;Lc++){this._childs[Lc]._setAnimatorToLinkAvatar(La,Lb)}},Lo(0,Lc,"activeInHierarchy",function(){return this._activeInHierarchy}),Lo(0,Lc,"_loaded",null,function(La){this.__loaded=La}),Lo(0,Lc,"active",function(){return this._active},function(La){this._active!==La&&(this._active=La,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(La?this._activeHierarchy():this._inActiveHierarchy()))}),Lo(0,Lc,"componentsCount",function(){return this._components.length}),Lo(0,Lc,"loaded",function(){return this.__loaded}),Lo(0,Lc,"id",function(){return this._id}),Lo(0,Lc,"url",function(){return this._url}),Lo(0,Lc,"layer",function(){return this._layer},function(La){if(this._layer!==La){if(!La)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Lb=0,Lc=this._colliders.length;if(this._layer)for(Lb=0;Lb<Lc;Lb++)this._layer._removeCollider(this._colliders[Lb]);for(Lb=0;Lb<Lc;Lb++)La._addCollider(this._colliders[Lb])}this._layer=La,this.event("layerchanged",La)}}),Lo(0,Lc,"scene",function(){return this._scene}),Lo(0,Lc,"transform",function(){return this._transform}),Lb.instantiate=function(La,Lb,Lc,Ld,Le){void 0===Lc&&(Lc=!0);var Lf=La.clone();Lb&&Lb.addChild(Lf);var Lg=Lf.transform;if(Lc){var Lh=Lg.worldMatrix;La.transform.worldMatrix.cloneTo(Lh),Lg.worldMatrix=Lh}else Ld&&(Lg.position=Ld),Le&&(Lg.rotation=Le);return Lf},Lb.load=function(La){return Lv.loader.create(La,null,null,Lb)},Lb.WORLDMATRIX=0,Lb.MVPMATRIX=1,Lb._uniqueIDCounter=0,Lb._nameNumberCounter=0,Lb}(),LLb=function(La){function Lk(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],Lk.__super.call(this),!La||!Lb)throw"Shader Error";this._id=++Lk._count,this._vs=La,this._ps=Lb,this._attributeMap=Lc,this._sceneUniformMap=Ld,this._cameraUniformMap=Le,this._spriteUniformMap=Lf,this._materialUniformMap=Lg,this._renderElementUniformMap=Lh,this._precompile=Li,this._define=Lj,this._precompile&&Lk.extCompileObj&&Lk.extCompileFunc?Lk.extCompileFunc.call(Lk.extCompileObj,La,Lb,Lj):this.recreateResource()}Ln(Lk,"laya.d3.shader.Shader3D",Lc);var Lb=Lk.prototype;return Lb.recreateResource=function(){LH.now();this._compile(),this.completeCreate(),this.memorySize=0},Lb.disposeResource=function(){LF.mainContext.deleteShader(this._vshader),LF.mainContext.deleteShader(this._pshader),LF.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Lb._compile=function(){if(!LF.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var La=[this._vs,this._ps],Lb=LF.mainContext;if(this._program=Lb.createProgram(),this._vshader=Lk._createShader(Lb,La[0],35633),this._pshader=Lk._createShader(Lb,La[1],35632),Lb.attachShader(this._program,this._vshader),Lb.attachShader(this._program,this._pshader),Lb.linkProgram(this._program),!Lp.isConchApp&&LAb.debugMode&&!Lb.getProgramParameter(this._program,35714))throw Lb.getProgramInfoLog(this._program);var Lc,Ld=0,Le=0,Lf=0;for(Lf=Lp.isConchApp?Lb.getProgramParameterEx(this._vs,this._ps,"",35721):Lb.getProgramParameter(this._program,35721),Ld=0;Ld<Lf;Ld++){var Lg=null;Lc={vartype:"attribute",ivartype:0,attrib:Lg=Lp.isConchApp?Lb.getActiveAttribEx(this._vs,this._ps,"",Ld):Lb.getActiveAttrib(this._program,Ld),location:Lb.getAttribLocation(this._program,Lg.name),name:Lg.name,type:Lg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(Lc)}var Lh=0;for(Lh=Lp.isConchApp?Lb.getProgramParameterEx(this._vs,this._ps,"",35718):Lb.getProgramParameter(this._program,35718),Ld=0;Ld<Lh;Ld++){var Li=null;Li=Lp.isConchApp?Lb.getActiveUniformEx(this._vs,this._ps,"",Ld):Lb.getActiveUniform(this._program,Ld),0<(Lc={vartype:"uniform",ivartype:1,attrib:Lg,location:Lb.getUniformLocation(this._program,Li.name),name:Li.name,type:Li.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Lc.name=Lc.name.substr(0,Lc.name.length-3),Lc.isArray=!0,Lc.location=Lb.getUniformLocation(this._program,Lc.name)),this._uniformParams.push(Lc)}for(Ld=0,Le=this._attributeParams.length;Ld<Le;Ld++)(Lc=this._attributeParams[Ld]).indexOfParams=Ld,Lc.index=1,Lc.value=[Lc.location,null],Lc.codename=Lc.name,Lc.name=null!=this._attributeMap[Lc.codename]?this._attributeMap[Lc.codename]:Lc.codename,this._attributeParamsMap.push(Lc.name),this._attributeParamsMap.push(Lc),Lc._this=this,Lc.uploadedValue=[],Lc.fun=this._attribute;for(Ld=0,Le=this._uniformParams.length;Ld<Le;Ld++)switch((Lc=this._uniformParams[Ld]).indexOfParams=Ld,Lc.index=1,Lc.value=[Lc.location,null],Lc.codename=Lc.name,null!=this._sceneUniformMap[Lc.codename]?(Lc.name=this._sceneUniformMap[Lc.codename],this._sceneUniformParamsMap.push(Lc.name),this._sceneUniformParamsMap.push(Lc)):null!=this._cameraUniformMap[Lc.codename]?(Lc.name=this._cameraUniformMap[Lc.codename],this._cameraUniformParamsMap.push(Lc.name),this._cameraUniformParamsMap.push(Lc)):null!=this._spriteUniformMap[Lc.codename]?(Lc.name=this._spriteUniformMap[Lc.codename],this._spriteUniformParamsMap.push(Lc.name),this._spriteUniformParamsMap.push(Lc)):null!=this._materialUniformMap[Lc.codename]?(Lc.name=this._materialUniformMap[Lc.codename],this._materialUniformParamsMap.push(Lc.name),this._materialUniformParamsMap.push(Lc)):null!=this._renderElementUniformMap[Lc.codename]?(Lc.name=this._renderElementUniformMap[Lc.codename],this._renderElementUniformParamsMap.push(Lc.name),this._renderElementUniformParamsMap.push(Lc)):console.log("Shader:can't find uinform name:"+Lc.codename+" in shader file."),Lc._this=this,Lc.uploadedValue=[],Lc.type){case 5124:Lc.fun=Lc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Lc.fun=Lc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Lc.fun=Lc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Lc.fun=Lc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Lc.fun=Lc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Lc.fun=this._uniform_sampler2D;break;case 35680:Lc.fun=this._uniform_samplerCube;break;case 35676:Lc.fun=this._uniformMatrix4fv;break;case 35670:Lc.fun=this._uniform1i;break;case 35674:Lc.fun=this._uinformMatrix2fv;break;case 35675:Lc.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Lb._attribute=function(La,Lb){var Lc=LF.mainContext,Ld=Lh._enableAtributes,Le=La.location;return Ld[Le]||Lc.enableVertexAttribArray(Le),Lc.vertexAttribPointer(Le,Lb[0],Lb[1],Lb[2],Lb[3],Lb[4]),Ld[Le]=Lh._bindVertexBuffer,1},Lb._uniform1f=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb?(LF.mainContext.uniform1f(La.location,Lc[0]=Lb),1):0},Lb._uniform1fv=function(La,Lb){if(Lb.length<4){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(LF.mainContext.uniform1fv(La.location,Lb),Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3],1):0}return LF.mainContext.uniform1fv(La.location,Lb),1},Lb._uniform_vec2=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]?(LF.mainContext.uniform2f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1]),1):0},Lb._uniform_vec2v=function(La,Lb){if(Lb.length<2){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(LF.mainContext.uniform2fv(La.location,Lb),Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3],1):0}return LF.mainContext.uniform2fv(La.location,Lb),1},Lb._uniform_vec3=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]?(LF.mainContext.uniform3f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2]),1):0},Lb._uniform_vec3v=function(La,Lb){return LF.mainContext.uniform3fv(La.location,Lb),1},Lb._uniform_vec4=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(LF.mainContext.uniform4f(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3]),1):0},Lb._uniform_vec4v=function(La,Lb){return LF.mainContext.uniform4fv(La.location,Lb),1},Lb._uniformMatrix2fv=function(La,Lb){return LF.mainContext.uniformMatrix2fv(La.location,!1,Lb),1},Lb._uniformMatrix3fv=function(La,Lb){return LF.mainContext.uniformMatrix3fv(La.location,!1,Lb),1},Lb._uniformMatrix4fv=function(La,Lb){return LF.mainContext.uniformMatrix4fv(La.location,!1,Lb),1},Lb._uinformMatrix2fv=function(La,Lb){return LF.mainContext.uniformMatrix2fv(La.location,!1,Lb),1},Lb._uinformMatrix3fv=function(La,Lb){return LF.mainContext.uniformMatrix3fv(La.location,!1,Lb),1},Lb._uniform1i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb?(LF.mainContext.uniform1i(La.location,Lc[0]=Lb),1):0},Lb._uniform1iv=function(La,Lb){return LF.mainContext.uniform1iv(La.location,Lb),1},Lb._uniform_ivec2=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]?(LF.mainContext.uniform2i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1]),1):0},Lb._uniform_ivec2v=function(La,Lb){return LF.mainContext.uniform2iv(La.location,Lb),1},Lb._uniform_vec3i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]?(LF.mainContext.uniform3i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2]),1):0},Lb._uniform_vec3vi=function(La,Lb){return LF.mainContext.uniform3iv(La.location,Lb),1},Lb._uniform_vec4i=function(La,Lb){var Lc=La.uploadedValue;return Lc[0]!==Lb[0]||Lc[1]!==Lb[1]||Lc[2]!==Lb[2]||Lc[3]!==Lb[3]?(LF.mainContext.uniform4i(La.location,Lc[0]=Lb[0],Lc[1]=Lb[1],Lc[2]=Lb[2],Lc[3]=Lb[3]),1):0},Lb._uniform_vec4vi=function(La,Lb){return LF.mainContext.uniform4iv(La.location,Lb),1},Lb._uniform_sampler2D=function(La,Lb){var Lc=Lb.source||Lb.defaulteTexture.source,Ld=LF.mainContext,Le=La.uploadedValue;if(null!=Le[0])return Ld.activeTexture(Lk._TEXTURES[Le[0]]),Lc&&LG.bindTexture(Ld,3553,Lc),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Le[0]=this._curActTexIndex,Ld.uniform1i(La.location,this._curActTexIndex),Ld.activeTexture(Lk._TEXTURES[this._curActTexIndex]),Lc&&LG.bindTexture(Ld,3553,Lc),this._curActTexIndex++,1},Lb._uniform_samplerCube=function(La,Lb){var Lc=Lb.source||Lb.defaulteTexture.source,Ld=LF.mainContext,Le=La.uploadedValue;if(null!=Le[0])return Ld.activeTexture(Lk._TEXTURES[Le[0]]),Lc?LG.bindTexture(Ld,34067,Lc):LG.bindTexture(Ld,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Le[0]=this._curActTexIndex,Ld.uniform1i(La.location,this._curActTexIndex),Ld.activeTexture(Lk._TEXTURES[this._curActTexIndex]),Lc?LG.bindTexture(Ld,34067,Lc):LG.bindTexture(Ld,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Lb._noSetValue=function(La){console.log("no....:"+La.name)},Lb.bind=function(){return Lc.activeShader=this,(Lc.bindShader=this).activeResource(),LG.UseProgram(this._program)},Lb.uploadAttributes=function(La,Lb){for(var Lc,Ld,Le=0,Lf=0,Lg=this._attributeParamsMap.length;Lf<Lg;Lf+=2)Ld=this._attributeParamsMap[Lf+1],null!=(Lc=La[this._attributeParamsMap[Lf]])&&(Lb&&Lb[Ld.name]&&Lb[Ld.name].bind(),Le+=Ld.fun.call(this,Ld,Lc));LA.shaderCall+=Le},Lb.uploadAttributesX=function(La,Lb){for(var Lc,Ld,Le=0,Lf=0,Lg=this._attributeParamsMap.length;Lf<Lg;Lf+=2)Ld=this._attributeParamsMap[Lf+1],null!=(Lc=La[this._attributeParamsMap[Lf]])&&(Lb._bind(),Le+=Ld.fun.call(this,Ld,Lc));LA.shaderCall+=Le},Lb.uploadSceneUniforms=function(La){for(var Lb,Lc,Ld=0,Le=0,Lf=this._sceneUniformParamsMap.length;Le<Lf;Le+=2)Lc=this._sceneUniformParamsMap[Le+1],null!=(Lb=La[this._sceneUniformParamsMap[Le]])&&(Ld+=Lc.fun.call(this,Lc,Lb));LA.shaderCall+=Ld},Lb.uploadCameraUniforms=function(La){for(var Lb,Lc,Ld=0,Le=0,Lf=this._cameraUniformParamsMap.length;Le<Lf;Le+=2)Lc=this._cameraUniformParamsMap[Le+1],null!=(Lb=La[this._cameraUniformParamsMap[Le]])&&(Ld+=Lc.fun.call(this,Lc,Lb));LA.shaderCall+=Ld},Lb.uploadSpriteUniforms=function(La){for(var Lb,Lc,Ld=0,Le=0,Lf=this._spriteUniformParamsMap.length;Le<Lf;Le+=2)Lc=this._spriteUniformParamsMap[Le+1],null!=(Lb=La[this._spriteUniformParamsMap[Le]])&&(Ld+=Lc.fun.call(this,Lc,Lb));LA.shaderCall+=Ld},Lb.uploadMaterialUniforms=function(La){for(var Lb,Lc,Ld=0,Le=0,Lf=this._materialUniformParamsMap.length;Le<Lf;Le+=2)Lc=this._materialUniformParamsMap[Le+1],null!=(Lb=La[this._materialUniformParamsMap[Le]])&&(Ld+=Lc.fun.call(this,Lc,Lb));LA.shaderCall+=Ld},Lb.uploadRenderElementUniforms=function(La){for(var Lb,Lc,Ld=0,Le=0,Lf=this._renderElementUniformParamsMap.length;Le<Lf;Le+=2)Lc=this._renderElementUniformParamsMap[Le+1],null!=(Lb=La[this._renderElementUniformParamsMap[Le]])&&(Ld+=Lc.fun.call(this,Lc,Lb));LA.shaderCall+=Ld},Lk.create=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return new Lk(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj)},Lk.addInclude=function(La,Lb){Lt.addInclude(La,Lb)},Lk._createShader=function(La,Lb,Lc){var Ld=La.createShader(Lc);if(La.shaderSource(Ld,Lb),La.compileShader(Ld),LAb.debugMode&&!La.getShaderParameter(Ld,35713))throw La.getShaderInfoLog(Ld);return Ld},Lk.PERIOD_RENDERELEMENT=0,Lk.PERIOD_MATERIAL=1,Lk.PERIOD_SPRITE=2,Lk.PERIOD_CAMERA=3,Lk.PERIOD_SCENE=4,Lk._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],Lk._count=0,Lk._preCompile=!1,Lk.extCompileFunc=null,Lk.extCompileObj=null,Ll(Lk,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new LB}]),Lk}(),LMb=function(Lh){function Li(){this._transformUV=null,Li.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new Lgb(.6,.6,.6)),this._setColor(10,new Lgb(1,1,1)),this._setColor(11,new Lhb(1,1,1,8)),this._setColor(12,new Lgb(1,1,1)),this._setColor(7,new Lhb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Lhb(1,1,0,0)),this.renderMode=1}Ln(Li,"laya.d3.core.material.StandardMaterial",Lh);var La=Li.prototype;return La.disableLight=function(){this._addDisablePublicShaderDefine(LAb.SHADERDEFINE_POINTLIGHT|LAb.SHADERDEFINE_SPOTLIGHT|LAb.SHADERDEFINE_DIRECTIONLIGHT)},La.disableFog=function(){this._addDisablePublicShaderDefine(LAb.SHADERDEFINE_FOG)},La.onAsynLoaded=function(La,Lb,Lc){var Ld=Lb[0];if(Ld.version)Lh.prototype.onAsynLoaded.call(this,La,Lb,Lc);else{var Le=Lb[1],Lf=Ld.props;for(var Lg in Lf)this[Lg]=Lf[Lg];Li._parseStandardMaterial(Le,this,Ld),this._endLoaded()}},La.cloneTo=function(La){Lh.prototype.cloneTo.call(this,La);var Lb=La;this._transformUV&&(Lb._transformUV=this._transformUV.clone())},Lo(0,La,"ambientColor",function(){return this._getColor(9)},function(La){this._setColor(9,La)}),Lo(0,La,"ambientTexture",function(){return this._getTexture(5)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,La)}),Lo(0,La,"renderMode",null,function(La){switch(La){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Li.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(La)}),Lo(0,La,"reflectColor",function(){return this._getColor(12)},function(La){this._setColor(12,La)}),Lo(0,La,"tilingOffset",function(){return this._getColor(15)},function(La){if(La){var Lb=La.elements;1!=Lb[0]||1!=Lb[1]||0!=Lb[2]||0!=Lb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,La)}),Lo(0,La,"albedo",function(){return this._getColor(7)},function(La){this._setColor(7,La)}),Lo(0,La,"diffuseColor",function(){return this._getColor(10)},function(La){this._setColor(10,La)}),Lo(0,La,"albedoColor",function(){return this._getColor(7)},function(La){this._setColor(7,La)}),Lo(0,La,"specularColor",function(){return this._getColor(11)},function(La){this._setColor(11,La)}),Lo(0,La,"diffuseTexture",function(){return this._getTexture(1)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,La)}),Lo(0,La,"normalTexture",function(){return this._getTexture(2)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,La)}),Lo(0,La,"specularTexture",function(){return this._getTexture(3)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,La)}),Lo(0,La,"emissiveTexture",function(){return this._getTexture(4)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,La)}),Lo(0,La,"reflectTexture",function(){return this._getTexture(6)},function(La){La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,La)}),Lo(0,La,"transformUV",function(){return this._transformUV},function(La){this._transformUV=La,this._setMatrix4x4(13,La.matrix),La?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,La.matrix.elements,0)}),Li.__init__=function(){Li.SHADERDEFINE_DIFFUSEMAP=Li.shaderDefines.registerDefine("DIFFUSEMAP"),Li.SHADERDEFINE_NORMALMAP=Li.shaderDefines.registerDefine("NORMALMAP"),Li.SHADERDEFINE_SPECULARMAP=Li.shaderDefines.registerDefine("SPECULARMAP"),Li.SHADERDEFINE_EMISSIVEMAP=Li.shaderDefines.registerDefine("EMISSIVEMAP"),Li.SHADERDEFINE_AMBIENTMAP=Li.shaderDefines.registerDefine("AMBIENTMAP"),Li.SHADERDEFINE_REFLECTMAP=Li.shaderDefines.registerDefine("REFLECTMAP"),Li.SHADERDEFINE_UVTRANSFORM=Li.shaderDefines.registerDefine("UVTRANSFORM"),Li.SHADERDEFINE_TILINGOFFSET=Li.shaderDefines.registerDefine("TILINGOFFSET"),Li.SHADERDEFINE_ADDTIVEFOG=Li.shaderDefines.registerDefine("ADDTIVEFOG")},Li.load=function(La){return Lv.loader.create(La,null,null,Li)},Li._parseStandardMaterial=function(La,Lb,Lc){var Ld=Lc.customProps,Le=Ld.ambientColor;Lb.ambientColor=new Lgb(Le[0],Le[1],Le[2]);var Lf=Ld.diffuseColor;Lb.diffuseColor=new Lgb(Lf[0],Lf[1],Lf[2]);var Lg=Ld.specularColor;Lb.specularColor=new Lhb(Lg[0],Lg[1],Lg[2],Lg[3]);var Lh=Ld.reflectColor;Lb.reflectColor=new Lgb(Lh[0],Lh[1],Lh[2]);var Li=Ld.albedoColor;Li&&(Lb.albedo=new Lhb(Li[0],Li[1],Li[2],Li[3]));var Lj=Ld.diffuseTexture.texture2D;Lj&&(Lb.diffuseTexture=Lr.getRes(La[Lj]));var Lk=Ld.normalTexture.texture2D;Lk&&(Lb.normalTexture=Lr.getRes(La[Lk]));var Ll=Ld.specularTexture.texture2D;Ll&&(Lb.specularTexture=Lr.getRes(La[Ll]));var Lm=Ld.emissiveTexture.texture2D;Lm&&(Lb.emissiveTexture=Lr.getRes(La[Lm]));var Ln=Ld.ambientTexture.texture2D;Ln&&(Lb.ambientTexture=Lr.getRes(La[Ln]));var Lo=Ld.reflectTexture.texture2D;Lo&&(Lb.reflectTexture=Lr.getRes(La[Lo]))},Li.RENDERMODE_OPAQUE=1,Li.RENDERMODE_OPAQUEDOUBLEFACE=2,Li.RENDERMODE_CUTOUT=3,Li.RENDERMODE_CUTOUTDOUBLEFACE=4,Li.RENDERMODE_TRANSPARENT=13,Li.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Li.RENDERMODE_ADDTIVE=15,Li.RENDERMODE_ADDTIVEDOUBLEFACE=16,Li.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Li.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Li.RENDERMODE_DEPTHREAD_ADDTIVE=7,Li.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Li.RENDERMODE_NONDEPTH_TRANSPARENT=9,Li.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Li.RENDERMODE_NONDEPTH_ADDTIVE=11,Li.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Li.SHADERDEFINE_DIFFUSEMAP=0,Li.SHADERDEFINE_NORMALMAP=0,Li.SHADERDEFINE_SPECULARMAP=0,Li.SHADERDEFINE_EMISSIVEMAP=0,Li.SHADERDEFINE_AMBIENTMAP=0,Li.SHADERDEFINE_REFLECTMAP=0,Li.SHADERDEFINE_UVTRANSFORM=0,Li.SHADERDEFINE_TILINGOFFSET=0,Li.SHADERDEFINE_ADDTIVEFOG=0,Li.DIFFUSETEXTURE=1,Li.NORMALTEXTURE=2,Li.SPECULARTEXTURE=3,Li.EMISSIVETEXTURE=4,Li.AMBIENTTEXTURE=5,Li.REFLECTTEXTURE=6,Li.ALBEDO=7,Li.UVANIAGE=8,Li.MATERIALAMBIENT=9,Li.MATERIALDIFFUSE=10,Li.MATERIALSPECULAR=11,Li.MATERIALREFLECT=12,Li.UVMATRIX=13,Li.UVAGE=14,Li.TILINGOFFSET=15,Ll(Li,["defaultMaterial",function(){var La=new Li;return La.lock=!0,this.defaultMaterial=La},"shaderDefines",function(){return this.shaderDefines=new Lkb(LEb.shaderDefines)}]),Li}(LEb),LNb=function(La){function Lg(La,Lb,Lc,Ld,Le){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===Lc&&(Lc=35044),void 0===Ld&&(Ld=!1),Lg.__super.call(this),this._indexType=La,this._indexCount=Lb,this._bufferUsage=Lc,this._bufferType=34963,this._canRead=Ld;var Lf;if("ushort"==La)this._indexTypeByteCount=2;else{if("ubyte"!=La)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Lf=this._indexTypeByteCount*Lb,this._byteLength=Lf,this._bind(),Lh._gl.bufferData(this._bufferType,Lf,this._bufferUsage),this.uri=Le,Ld?("ushort"==La?this._buffer=new Uint16Array(Lb):"ubyte"==La&&(this._buffer=new Uint8Array(Lb)),this.memorySize=2*Lf):this.memorySize=Lf}Ln(Lg,"laya.d3.graphics.IndexBuffer3D",La);var Lb=Lg.prototype;return Lb.setData=function(La,Lb,Lc,Ld){void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=4294967295);var Le=0;if("ushort"==this._indexType?(Le=2,0===Lc&&4294967295===Ld||(La=new Uint16Array(La.buffer,Lc*Le,Ld))):"ubyte"==this._indexType&&(Le=1,0===Lc&&4294967295===Ld||(La=new Uint8Array(La.buffer,Lc*Le,Ld))),this._bind(),Lh._gl.bufferSubData(this._bufferType,Lb*Le,La),this._canRead)if(0!==Lb||0!==Lc||4294967295!==Ld){var Lf=this._buffer.length-Lb;Lf<Ld&&(Ld=Lf);for(var Lg=0;Lg<Ld;Lg++)this._buffer[Lb+Lg]=La[Lg]}else this._buffer=La},Lb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Lb.disposeResource=function(){La.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},Lo(0,Lb,"indexType",function(){return this._indexType}),Lo(0,Lb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),Lo(0,Lb,"indexCount",function(){return this._indexCount}),Lo(0,Lb,"canRead",function(){return this._canRead}),Lg.INDEXTYPE_UBYTE="ubyte",Lg.INDEXTYPE_USHORT="ushort",Lg.create=function(La,Lb,Lc,Ld,Le){return void 0===Lc&&(Lc=35044),void 0===Ld&&(Ld=!1),new Lg(La,Lb,Lc,Ld,Le)},Lg}(Lh),LOb=function(Lf){function Lg(La,Lb,Lc,Ld,Le){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Ld&&(Ld=!1),Lg.__super.call(this),this._vertexDeclaration=La,this._vertexCount=Lb,this._bufferUsage=Lc,this._bufferType=34962,this._canRead=Ld,this.uri=Le,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Lb,this._bind(),Lh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Ld&&(this._buffer=new Float32Array(this._byteLength/4))}Ln(Lg,"laya.d3.graphics.VertexBuffer3D",Lf);var La=Lg.prototype;return La.bindWithIndexBuffer=function(La){La&&La._bind(),this._bind()},La.setData=function(La,Lb,Lc,Ld){if(void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=4294967295),0===Lc&&4294967295===Ld||(La=new Float32Array(La.buffer,4*Lc,Ld)),this._bind(),Lh._gl.bufferSubData(this._bufferType,4*Lb,La),this._canRead)if(0!==Lb||0!==Lc||4294967295!==Ld){var Le=this._buffer.length-Lb;Le<Ld&&(Ld=Le);for(var Lf=0;Lf<Ld;Lf++)this._buffer[Lb+Lf]=La[Lf]}else this._buffer=La},La.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},La.disposeResource=function(){for(var La=LF.mainContext,Lb=this._vertexDeclaration.getVertexElements(),Lc=Lh._enableAtributes,Ld=0,Le=Lb.length;Ld<Le;Ld++)Lc[Ld]===this._glBuffer&&(La.disableVertexAttribArray(Ld),Lc[Ld]=null);Lf.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},Lo(0,La,"vertexDeclaration",function(){return this._vertexDeclaration}),Lo(0,La,"vertexCount",function(){return this._vertexCount}),Lo(0,La,"canRead",function(){return this._canRead}),Lg.create=function(La,Lb,Lc,Ld,Le){return void 0===Lc&&(Lc=35044),void 0===Ld&&(Ld=!1),new Lg(La,Lb,Lc,Ld,Le)},Lg}(Lh),LPb=function(La){function Lt(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,Lt.__super.call(this),this._type=3553}Ln(Lt,"laya.d3.resource.DataTexture2D",LFb);var Lb=Lt.prototype;return Lb.genDebugMipmaps=function(){var La=[];return La.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),La.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),La.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),La.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),La.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),La.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),La.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),La.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),La.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),La.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),La},Lb._onTextureLoaded=function(La){},Lb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var La=LF.mainContext,Lb=this._source=La.createTexture(),Lc=this._width,Ld=this._height,Le=LG.curBindTexTarget,Lf=LG.curBindTexValue,Lg=!1;if(LG.bindTexture(La,this._type,Lb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var Lh=0;La.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Li=0;Li<this._mipmaps.length;Li++){if(this._mipmaps[Li].byteLength!=Lj*Lk*4)throw"mipmap size error  level:"+Li;La.texSubImage2D(this._type,0,Lt.simLodRect[Lh++],Lt.simLodRect[Lh++],Lt.simLodRect[Lh++],Lt.simLodRect[Lh++],6408,5121,new Uint8Array(this._mipmaps[Li]))}this.minFifter=9729,this.magFifter=9729}else{var Lj=this._width,Lk=this._height;for(Lh=0,La.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Li=0;Li<this._mipmaps.length;Li++){if(this._mipmaps[Li].byteLength!=Lj*Lk*4)throw"mipmap size error  level:"+Li;La.texImage2D(this._type,Li,6408,Lj,Lk,0,6408,5121,new Uint8Array(this._mipmaps[Li])),(Lj/=2)<1&&(Lj=1),(Lk/=2)<1&&(Lk=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&La.pixelStorei(La.UNPACK_ALIGNMENT,1),La.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var Ll=0,Lm=!1,Ln=!1;this._buffer.byteLength==4*Lc*Ld?(Ll=6408,Lm=!0):this._buffer.byteLength==3*Lc*Ld?(Ll=6407,Ln=!0):Ll=this._format,Lm||Ln?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Ln&&La.pixelStorei(La.UNPACK_ALIGNMENT,1),La.texImage2D(this._type,0,Ll,Lc,Ld,0,Ll,5121,this._buffer)):La&&Ll==La.ALPHA?(La.texImage2D(3553,0,Ll,Lc,Ld,0,Ll,La.UNSIGNED_BYTE,this._buffer),Lg=!0):0!=Ll&&(La.compressedTexImage2D(3553,0,Ll,Lc,Ld,0,this._buffer),Lg=!0)}var Lo=this._minFifter,Lp=this._magFifter,Lq=0==this._wrapModeU?10497:33071,Lr=0==this._wrapModeV?10497:33071,Ls=Lu.isPOT(Lc,Ld);Ls?(this._mipmap||this._mipmaps?-1!==Lo||(Lo=9987):-1!==Lo||(Lo=9729),-1!==Lp||(Lp=9729),La.texParameteri(this._type,10241,Lo),La.texParameteri(this._type,10240,Lp),La.texParameteri(this._type,10242,Lq),La.texParameteri(this._type,10243,Lr),this._mipmap&&La.generateMipmap(this._type)):(-1!==Lo||(Lo=9729),-1!==Lp||(Lp=9729),La.texParameteri(this._type,10241,Lo),La.texParameteri(this._type,10240,Lp),La.texParameteri(this._type,10242,33071),La.texParameteri(this._type,10243,33071)),Le&&Lf&&LG.bindTexture(La,Le,Lf),this.memorySize=Lg?this._buffer.length:Ls?Lc*Ld*4*(1+1/3):Lc*Ld*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Lb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Lb.onAsynLoaded=function(La,Lb,Lc){var Ld;Lc&&(Ld=Lc[0].call(this,Lb)),Ld&&(this._width=Ld.width,this._height=Ld.height,this._buffer=Ld.data),this._src=La,this._size=new Lpb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Lb.getPixels=function(){return new Uint8Array(this._buffer)},Lb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(LF.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},Lo(0,Lb,"src",function(){return this._src}),Lt.create=function(La,Lb,Lc,Ld,Le,Lf,Lg){if(void 0===Ld&&(Ld=9729),void 0===Le&&(Le=9729),void 0===Lf&&(Lf=!0),!La||La.byteLength<Lb*Lc*4)throw"DataTexture2D create error";var Lh=new Lt;return Lh.uri=Lg,Lh._buffer=La,Lh._width=Lb,Lh._height=Lc,Lh._mipmap=Lf,Lh._magFifter=Ld,Lh._minFifter=Le,Lh._size=new Lpb(Lh._width,Lh._height),Lh._conchTexture?alert("怎么给runtime传递datatexture数据"):Lh.activeResource(),Lh},Lt.load=function(La,Lb,Lc,Ld,Le){if(void 0===Lb&&(Lb=0),void 0===Lc&&(Lc=0),void 0===Ld&&(Ld=9729),void 0===Le&&(Le=9729),"mipmaps"===LC.getFileExtension(La)){var Lf=Lv.loader.create(La,null,null,Lt,[function(La){this._mipmaps=[];var Lb=new Uint32Array(La);this._width=Lb[0];var Lc=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,Lc=1024),this._width!=Lc)throw"现在只支持512x256的环境贴图。当前的是"+Lb[0];this._height=Lb[1];for(var Ld=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,Le=this._height,Lf=8;;){var Lg=Ld*Le*4;if(Lf+Lg>La.byteLength)throw"load mipmaps data size error ";var Lh=new Uint8Array(La,Lf,Lg);if(this._mipmaps.push(Lh),Lf+=Lg,1==Ld&&1==Le)break;(Ld/=2)<1&&(Ld=1),(Le/=2)<1&&(Le=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Lf.simLodInfo=new Float32Array(40);for(var Lg=0;Lg<Lf.simLodInfo.length;)Lf.simLodInfo[Lg]=(Lt.simLodRect[Lg]+.5)/1024,Lg++,Lf.simLodInfo[Lg]=(Lt.simLodRect[Lg]+.5)/256,Lg++,Lf.simLodInfo[Lg]=Math.max(Lt.simLodRect[Lg]-1,.1)/1024,Lg++,Lf.simLodInfo[Lg]=Math.max(Lt.simLodRect[Lg]-1.5,.1)/256,Lg++}return Lf}if("number"==typeof Lb)return Lv.loader.create(La,null,null,Lt,[function(La){return this._width=Lb,this._height=Lc,this._buffer=La,null}]);if("function"==typeof Lb)return Lv.loader.create(La,null,null,Lt,[Lb]);throw new Error("unknown params.")},Lt.lodasatlas=!1,Ll(Lt,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),Lt}(),LQb=function(La){function Lb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Lb.__super.call(this)}Ln(Lb,"laya.d3.resource.models.PrimitiveMesh",LGb);var Lc=Lb.prototype;return Lv.imps(Lc,{"laya.d3.core.render.IRenderable":!0}),Lc._getVertexBuffer=function(La){return void 0===La&&(La=0),0===La?this._vertexBuffer:null},Lc._getVertexBuffers=function(){return null},Lc._getIndexBuffer=function(){return this._indexBuffer},Lc._getPositions=function(){var La,Lb=[],Lc=this._vertexBuffer.vertexDeclaration.getVertexElements(),Ld=0;for(Ld=0;Ld<Lc.length;Ld++){var Le=Lc[Ld];if("vector3"===Le.elementFormat&&0===Le.elementUsage){La=Le;break}}var Lf=this._vertexBuffer.getData();for(Ld=0;Ld<Lf.length;Ld+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var Lg=Ld+La.offset/4,Lh=new Lgb(Lf[Lg+0],Lf[Lg+1],Lf[Lg+2]);Lb.push(Lh)}return Lb},Lc.getRenderElement=function(La){return this},Lc.getRenderElementsCount=function(){return 1},Lc.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},Lc._beforeRender=function(La){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Lc._render=function(La){LF.mainContext.drawElements(4,this._numberIndices,5123,0),LA.drawCall++,LA.trianglesFaces+=this._numberIndices/3},Lo(0,Lc,"_vertexBufferCount",function(){return 1}),Lo(0,Lc,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Lb}(),LRb=function(La){function Lb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Lb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Ln(Lb,"laya.d3.resource.models.Mesh",LGb);var Lc=Lb.prototype;return Lc._getPositions=function(){var La,Lb,Lc,Ld,Le,Lf=[],Lg=0,Lh=0,Li=0;if(0!==this._vertexBuffers.length){var Lj=this._vertexBuffers.length;for(Lg=0;Lg<Lj;Lg++){for(Lc=(La=this._vertexBuffers[Lg]).vertexDeclaration.getVertexElements(),Lh=0;Lh<Lc.length;Lh++)if("vector3"===(Ld=Lc[Lh]).elementFormat&&0===Ld.elementUsage){Lb=Ld;break}for(Le=La.getData(),Lh=0;Lh<Le.length;Lh+=La.vertexDeclaration.vertexStride/4)Li=Lh+Lb.offset/4,Lf.push(new Lgb(Le[Li+0],Le[Li+1],Le[Li+2]))}}else{var Lk=this._subMeshes.length;for(Lg=0;Lg<Lk;Lg++){for(Lc=(La=this._subMeshes[Lg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),Lh=0;Lh<Lc.length;Lh++)if("vector3"===(Ld=Lc[Lh]).elementFormat&&0===Ld.elementUsage){Lb=Ld;break}for(Le=La.getData(),Lh=0;Lh<Le.length;Lh+=La.vertexDeclaration.vertexStride/4)Li=Lh+Lb.offset/4,Lf.push(new Lgb(Le[Li+0],Le[Li+1],Le[Li+2]))}}return Lf},Lc._setSubMeshes=function(La){this._subMeshes=La,this._subMeshCount=La.length;for(var Lb=0;Lb<this._subMeshCount;Lb++)La[Lb]._indexInMesh=Lb;this._positions=this._getPositions(),this._generateBoundingObject()},Lc.onAsynLoaded=function(La,Lb,Lc){var Ld=Lb[0],Le=Lb[1];LYa.read(Ld,this,this._materials,this._subMeshes,Le),this.completeCreate(),this._endLoaded()},Lc.getSubMesh=function(La){return this._subMeshes[La]},Lc.getSubMeshCount=function(){return this._subMeshes.length},Lc.getRenderElementsCount=function(){return this._subMeshes.length},Lc.getRenderElement=function(La){return this._subMeshes[La]},Lc.disposeResource=function(){for(var La=0;La<this._subMeshes.length;La++)this._subMeshes[La].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},Lo(0,Lc,"materials",function(){return this._materials.slice()}),Lo(0,Lc,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Lb.load=function(La){return Lv.loader.create(La,null,null,Lb)},Lb}(),LSb=(function(La){function Lj(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===Lc&&(Lc=6408),void 0===Ld&&(Ld=5121),void 0===Le&&(Le=33189),void 0===Lf&&(Lf=!1),void 0===Lg&&(Lg=!1),void 0===Lh&&(Lh=-1),void 0===Li&&(Li=-1),Lj.__super.call(this),this._type=3553,this._width=La,this._height=Lb,this._size=new Lpb(La,Lb),this._surfaceFormat=Lc,this._surfaceType=Ld,this._depthStencilFormat=Le,Lp.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Lf,this._repeat=Lg,this._minFifter=Lh,this._magFifter=Li,this.activeResource(),this._alreadyResolved=!0}Ln(Lj,"laya.d3.resource.RenderTexture",LFb);var Lb=Lj.prototype;Lb.recreateResource=function(){var La=LF.mainContext;this._frameBuffer=La.createFramebuffer(),this._source=La.createTexture();var Lb=LG.curBindTexTarget,Lc=LG.curBindTexValue;LG.bindTexture(La,this._type,this._source),La.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Ld=this._minFifter,Le=this._magFifter,Lf=this._repeat?10497:33071;if(Lu.isPOT(this._width,this._height)?(this._mipmap?-1!==Ld||(Ld=9987):-1!==Ld||(Ld=9729),-1!==Le||(Le=9729),La.texParameteri(this._type,10241,Ld),La.texParameteri(this._type,10240,Le),La.texParameteri(this._type,10242,Lf),La.texParameteri(this._type,10243,Lf),this._mipmap&&La.generateMipmap(this._type)):(-1!==Ld||(Ld=9729),-1!==Le||(Le=9729),La.texParameteri(this._type,10241,Ld),La.texParameteri(this._type,10240,Le),La.texParameteri(this._type,10242,33071),La.texParameteri(this._type,10243,33071)),Lb&&Lc&&LG.bindTexture(La,Lb,Lc),La.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=La.createRenderbuffer(),La.bindRenderbuffer(36161,this._depthStencilBuffer),La.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),La.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:La.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:La.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:La.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}La.framebufferTexture2D(36160,36064,3553,this._source,0),La.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Lb.start=function(){LF.mainContext.bindFramebuffer(36160,this.frameBuffer),(Lj._currentRenderTarget=this)._alreadyResolved=!1},Lb.end=function(){LF.mainContext.bindFramebuffer(36160,null),Lj._currentRenderTarget=null,this._alreadyResolved=!0},Lb.getData=function(La,Lb,Lc,Ld){var Le=LF.mainContext;if(Le.bindFramebuffer(36160,this._frameBuffer),!(36053===Le.checkFramebufferStatus(36160)))return Le.bindFramebuffer(36160,null),null;var Lf=new Uint8Array(this._width*this._height*4);return Le.readPixels(La,Lb,Lc,Ld,this._surfaceFormat,this._surfaceType,Lf),Le.bindFramebuffer(36160,null),Lf},Lb.disposeResource=function(){if(this._frameBuffer){var La=LF.mainContext;La.deleteTexture(this._source),La.deleteFramebuffer(this._frameBuffer),La.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},Lo(0,Lb,"surfaceFormat",function(){return this._surfaceFormat}),Lo(0,Lb,"surfaceType",function(){return this._surfaceType}),Lo(0,Lb,"depthStencilFormat",function(){return this._depthStencilFormat}),Lo(0,Lb,"source",function(){return this._alreadyResolved?Lv.superGet(LFb,this,"source"):null}),Lo(0,Lb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Lo(0,Lb,"frameBuffer",function(){return this._frameBuffer}),Lj._currentRenderTarget=null}(),function(La){function Lb(La){this._color=null,this._pixels=null,Lb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Lpb(this.width,this.height),this._color=La,this._pixels=new Uint8Array([255*La.x,255*La.y,255*La.z,255*La.w]),this.uri="SolidColorTexture2D_"+this.id}Ln(Lb,"laya.d3.resource.SolidColorTexture2D",LFb);var Lc=Lb.prototype;return Lc._createWebGlTexture=function(){var La=LF.mainContext,Lb=this._source=La.createTexture(),Lc=this._width,Ld=this._height,Le=LG.curBindTexTarget,Lf=LG.curBindTexValue;LG.bindTexture(La,this._type,Lb),La.texImage2D(this._type,0,6408,Lc,Ld,0,6408,5121,this._pixels);var Lg=this._minFifter,Lh=this._magFifter,Li=this._repeat?10497:33071,Lj=Lu.isPOT(Lc,Ld);Lj?(this._mipmap?-1!==Lg||(Lg=9987):-1!==Lg||(Lg=9729),-1!==Lh||(Lh=9729),La.texParameteri(this._type,10241,Lg),La.texParameteri(this._type,10240,Lh),La.texParameteri(this._type,10242,Li),La.texParameteri(this._type,10243,Li),this._mipmap&&La.generateMipmap(this._type)):(-1!==Lg||(Lg=9729),-1!==Lh||(Lh=9729),La.texParameteri(this._type,10241,Lg),La.texParameteri(this._type,10240,Lh),La.texParameteri(this._type,10242,33071),La.texParameteri(this._type,10243,33071)),Le&&Lf&&LG.bindTexture(La,Le,Lf),this.memorySize=Lj?Lc*Ld*4*(1+1/3):Lc*Ld*4},Lc.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Lc.disposeResource=function(){this._source&&(LF.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Ll(Lb,["magentaTexture",function(){var La=new Lb(new Lhb(1,0,1,1));return La.lock=!0,this.magentaTexture=La},"grayTexture",function(){var La=new Lb(new Lhb(.5,.5,.5,1));return La.lock=!0,this.grayTexture=La}]),Lb}()),LTb=function(La){function Le(La,Lb,Lc,Ld){this._canRead=!1,this._image=null,this._pixels=null,void 0===La&&(La=!1),void 0===Lb&&(Lb=!0),void 0===Lc&&(Lc=6408),void 0===Ld&&(Ld=!0),Le.__super.call(this),this._type=3553,this._repeat=Lb,this._canRead=La,this._format=Lc,this._mipmap=Ld}Ln(Le,"laya.d3.resource.Texture2D",LFb);var Lb=Le.prototype;return Lb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var La=LF.mainContext,Lb=this._source=La.createTexture(),Lc=this._width,Ld=this._height,Le=LG.curBindTexTarget,Lf=LG.curBindTexValue;switch(LG.bindTexture(La,this._type,Lb),this._format){case 6407:case 6408:this._canRead?La.texImage2D(this._type,0,this._format,Lc,Ld,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?La.texImage2D(this._type,0,this._image._format,Lc,Ld,0,this._image._format,5121,this._image.atlasSource):La.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case LF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:La.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var Lg=this._minFifter,Lh=this._magFifter,Li=this._repeat?10497:33071,Lj=0==this._wrapModeU?10497:33071,Lk=0==this._wrapModeV?10497:33071,Ll=Lu.isPOT(Lc,Ld);Ll?(this._mipmap?-1!==Lg||(Lg=9987):-1!==Lg||(Lg=9729),-1!==Lh||(Lh=9729),La.texParameteri(this._type,10241,Lg),La.texParameteri(this._type,10240,Lh),La.texParameteri(this._type,10242,Li),La.texParameteri(this._type,10243,Li),La.texParameteri(this._type,10242,Lj),La.texParameteri(this._type,10243,Lk),this._mipmap&&La.generateMipmap(this._type)):(-1!==Lg||(Lg=9729),-1!==Lh||(Lh=9729),La.texParameteri(this._type,10241,Lg),La.texParameteri(this._type,10240,Lh),La.texParameteri(this._type,10242,33071),La.texParameteri(this._type,10243,33071)),Le&&Lf&&LG.bindTexture(La,Le,Lf),this._image.onload=null,this._image=null,this.memorySize=Ll?Lc*Ld*4*(1+1/3):Lc*Ld*4},Lb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Lb.onAsynLoaded=function(La,Lb,Lc){if(Lc){var Ld=Lc[0];void 0!==Ld&&(this._canRead=Ld);var Le=Lc[1];void 0!==Le&&(this._repeat=Le);var Lf=Lc[2];void 0!==Lf&&(this._format=Lf);var Lg=Lc[3];void 0!==Lg&&(this._mipmap=Lg);var Lh=Lc.wrapModeU;void 0!==Lh&&(this._wrapModeU=Lh);var Li=Lc.wrapModeV;void 0!==Li&&(this._wrapModeV=Li)}switch(this._format){case 6407:case 6408:var Lj=(this._image=Lb).width,Lk=Lb.height;this._width=Lj,this._height=Lk,this._size=new Lpb(Lj,Lk),this._canRead&&(Lp.isConchApp?Lb instanceof Lm.HTMLElement&&(this._pixels=new Uint8Array(Lb.getImageData(0,0,Lj,Lk))):(LH.canvas.size(Lj,Lk),LH.canvas.clear(),LH.context.drawImage(Lb,0,0,Lj,Lk),this._pixels=new Uint8Array(LH.context.getImageData(0,0,Lj,Lk).data.buffer)));break;case LF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var Ll=new Ly(Lb);Ll.readUTFBytes(4),Ll.readUTFBytes(2),Ll.getInt16();Ll.endian="bigEndian",this._width=Ll.getInt16(),this._height=Ll.getInt16(),this._size=new Lpb(this._width,this._height);Ll.getInt16(),Ll.getInt16();this._image=new Uint8Array(Lb,Ll.pos)}this.recreateResource(),this._endLoaded()},Lb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Lb.disposeResource=function(){this._source&&(LF.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},Lo(0,Lb,"_src",function(){return this.url}),Lo(0,Lb,"src",function(){return this.url}),Le.load=function(La){return Lv.loader.create(La,null,null,Le)},Le}(),LUb=function(Lb){function Lc(La,Lb){Lc.__super.call(this),void 0===La&&(La=.3),void 0===Lb&&(Lb=1e3),this._tempVector3=new Lgb,this._position=new Lgb,this._up=new Lgb,this._forward=new Lgb,this._right=new Lgb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Lpb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=La,this._farPlane=Lb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),Lv.stage.on("resize",this,this._onScreenSizeChanged)}Ln(Lc,"laya.d3.core.BaseCamera",Lb);var La=Lc.prototype;return La._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var La=this.scene._cameraPool,Lb=La.length-1,Lc=0;Lc<Lb;Lc++)if(La[Lc].renderingOrder>La[Lb].renderingOrder){var Ld=La[Lc];La[Lc]=La[Lb],La[Lb]=Ld}},La._calculateProjectionMatrix=function(){},La._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},La._prepareCameraToRender=function(){LI._currentCameraCullingMask=this.cullingMask;var La=this._shaderValues;La.setValue(0,this.transform.position.elements),La.setValue(5,this.forward.elements),La.setValue(6,this.up.elements)},La._prepareCameraViewProject=function(La,Lb){var Lc=this._shaderValues;Lc.setValue(1,La.elements),Lc.setValue(2,Lb.elements)},La._renderCamera=function(La,Lb,Lc){},La.addLayer=function(La){29!==La.number&&30!=La.number&&(this.cullingMask=this.cullingMask|La.mask)},La.removeLayer=function(La){29!==La.number&&30!=La.number&&(this.cullingMask=this.cullingMask&~La.mask)},La.addAllLayers=function(){this.cullingMask=2147483647},La.removeAllLayers=function(){this.cullingMask=0|LI.getLayerByNumber(29).mask|LI.getLayerByNumber(30).mask},La.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},La.moveForward=function(La){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=La,this.transform.translate(this._tempVector3)},La.moveRight=function(La){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=La,this.transform.translate(this._tempVector3)},La.moveVertical=function(La){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=La,this.transform.translate(this._tempVector3,!1)},La._addSelfRenderObjects=function(){var La=this.scene._cameraPool,Lb=La.length;if(0<Lb){for(var Lc=Lb-1;0<=Lc;Lc--)if(this.renderingOrder<=La[Lc].renderingOrder){La.splice(Lc+1,0,this);break}}else La.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},La._clearSelfRenderObjects=function(){var La=this.scene._cameraPool;La.splice(La.indexOf(this),1)},La.destroy=function(La){void 0===La&&(La=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,Lv.stage.off("resize",this,this._onScreenSizeChanged),Lb.prototype.destroy.call(this,La)},Lo(0,La,"sky",function(){return this._sky},function(La){(this._sky=La)._ownerCamera=this}),Lo(0,La,"forward",function(){var La=this.transform.worldMatrix.elements,Lb=this._forward.elements;return Lb[0]=-La[8],Lb[1]=-La[9],Lb[2]=-La[10],this._forward}),Lo(0,La,"position",function(){var La=this.transform.worldMatrix.elements,Lb=this._position.elements;return Lb[0]=La[12],Lb[1]=La[13],Lb[2]=La[14],this._position}),Lo(0,La,"renderTarget",function(){return this._renderTarget},function(La){null!=(this._renderTarget=La)&&(this._renderTargetSize=La.size)}),Lo(0,La,"up",function(){var La=this.transform.worldMatrix.elements,Lb=this._up.elements;return Lb[0]=La[4],Lb[1]=La[5],Lb[2]=La[6],this._up}),Lo(0,La,"right",function(){var La=this.transform.worldMatrix.elements,Lb=this._right.elements;return Lb[0]=La[0],Lb[1]=La[1],Lb[2]=La[2],this._right}),Lo(0,La,"renderTargetSize",function(){return this._renderTargetSize},function(La){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=La,this._calculateProjectionMatrix()}),Lo(0,La,"fieldOfView",function(){return this._fieldOfView},function(La){this._fieldOfView=La,this._calculateProjectionMatrix()}),Lo(0,La,"nearPlane",function(){return this._nearPlane},function(La){this._nearPlane=La,this._calculateProjectionMatrix()}),Lo(0,La,"farPlane",function(){return this._farPlane},function(La){this._farPlane=La,this._calculateProjectionMatrix()}),Lo(0,La,"orthographic",function(){return this._orthographic},function(La){this._orthographic=La,this._calculateProjectionMatrix()}),Lo(0,La,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(La){this._orthographicVerticalSize=La,this._calculateProjectionMatrix()}),Lo(0,La,"renderingOrder",function(){return this._renderingOrder},function(La){this._renderingOrder=La,this._sortCamerasByRenderingOrder()}),Lc.CAMERAPOS=0,Lc.VIEWMATRIX=1,Lc.PROJECTMATRIX=2,Lc.VPMATRIX=3,Lc.VPMATRIX_NO_TRANSLATE=4,Lc.CAMERADIRECTION=5,Lc.CAMERAUP=6,Lc.ENVIRONMENTDIFFUSE=7,Lc.ENVIRONMENTSPECULAR=8,Lc.SIMLODINFO=9,Lc.DIFFUSEIRRADMATR=10,Lc.DIFFUSEIRRADMATG=11,Lc.DIFFUSEIRRADMATB=12,Lc.HDREXPOSURE=13,Lc.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",Lc.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",Lc.CLEARFLAG_SOLIDCOLOR=0,Lc.CLEARFLAG_SKY=1,Lc.CLEARFLAG_DEPTHONLY=2,Lc.CLEARFLAG_NONE=3,Ll(Lc,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Lab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Lab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Lab}]),Lc}(LKb),LVb=function(Lc){function Lb(La){this._render=null,this._geometryFilter=null,Lb.__super.call(this,La)}Ln(Lb,"laya.d3.core.RenderableSprite3D",Lc);var La=Lb.prototype;return La._addToInitStaticBatchManager=function(){},La._setBelongScene=function(La){Lc.prototype._setBelongScene.call(this,La),La._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},La._setUnBelongScene=function(){var La=this._scene._renderableSprite3Ds,Lb=La.indexOf(this);La.splice(Lb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),Lc.prototype._setUnBelongScene.call(this)},La._update=function(La){(La.owner=this)._activeInHierarchy&&(this._updateComponents(La),this._render._updateOctreeNode(),this._lateUpdateComponents(La),LA.spriteCount++,this._childs.length&&this._updateChilds(La))},La.destroy=function(La){void 0===La&&(La=!0),Lc.prototype.destroy.call(this,La),this._render._destroy(),this._render=null},Lb.__init__=function(){Lb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Lb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Lb.SAHDERDEFINE_LIGHTMAP=Lb.shaderDefines.registerDefine("LIGHTMAP")},Lb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Lb.SAHDERDEFINE_LIGHTMAP=4,Lb.LIGHTMAPSCALEOFFSET=2,Lb.LIGHTMAP=3,Ll(Lb,["shaderDefines",function(){return this.shaderDefines=new Lkb}]),Lb}(LKb),LWb=(function(La){function Ld(La,Lb,Lc){this._long=NaN,this._width=NaN,this._height=NaN,void 0===La&&(La=1),void 0===Lb&&(Lb=1),void 0===Lc&&(Lc=1),Ld.__super.call(this),this._long=La,this._width=Lb,this._height=Lc,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Ln(Ld,"laya.d3.resource.models.BoxMesh",LQb);var Lb=Ld.prototype;Lb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var La=LFa.vertexDeclaration,Lb=(La.vertexStride,this._long/2),Lc=this._height/2,Ld=this._width/2,Le=new Float32Array([-Lb,Lc,-Ld,0,1,0,0,0,Lb,Lc,-Ld,0,1,0,1,0,Lb,Lc,Ld,0,1,0,1,1,-Lb,Lc,Ld,0,1,0,0,1,-Lb,-Lc,-Ld,0,-1,0,0,1,Lb,-Lc,-Ld,0,-1,0,1,1,Lb,-Lc,Ld,0,-1,0,1,0,-Lb,-Lc,Ld,0,-1,0,0,0,-Lb,Lc,-Ld,-1,0,0,0,0,-Lb,Lc,Ld,-1,0,0,1,0,-Lb,-Lc,Ld,-1,0,0,1,1,-Lb,-Lc,-Ld,-1,0,0,0,1,Lb,Lc,-Ld,1,0,0,1,0,Lb,Lc,Ld,1,0,0,0,0,Lb,-Lc,Ld,1,0,0,0,1,Lb,-Lc,-Ld,1,0,0,1,1,-Lb,Lc,Ld,0,0,1,0,0,Lb,Lc,Ld,0,0,1,1,0,Lb,-Lc,Ld,0,0,1,1,1,-Lb,-Lc,Ld,0,0,1,0,1,-Lb,Lc,-Ld,0,0,-1,1,0,Lb,Lc,-Ld,0,0,-1,0,0,Lb,-Lc,-Ld,0,0,-1,0,1,-Lb,-Lc,-Ld,0,0,-1,1,1]),Lf=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new LOb(La,this._numberVertices,35044,!0),this._indexBuffer=new LNb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(Le),this._indexBuffer.setData(Lf),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Lo(0,Lb,"long",function(){return this._long},function(La){this._long!==La&&(this._long=La,this.releaseResource(),this.activeResource())}),Lo(0,Lb,"width",function(){return this._width},function(La){this._width!==La&&(this._width=La,this.releaseResource(),this.activeResource())}),Lo(0,Lb,"height",function(){return this._height},function(La){this._height!==La&&(this._height=La,this.releaseResource(),this.activeResource())})}(),function(La){function Le(La,Lb,Lc,Ld){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===La&&(La=10),void 0===Lb&&(Lb=10),void 0===Lc&&(Lc=10),void 0===Ld&&(Ld=10),Le.__super.call(this),this._long=La,this._width=Lb,this._stacks=Lc,this._slices=Ld,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Ln(Le,"laya.d3.resource.models.PlaneMesh",LQb);var Lb=Le.prototype;Lb.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var La=new Uint16Array(this._numberIndices),Lb=LFa.vertexDeclaration,Lc=Lb.vertexStride/4,Ld=new Float32Array(this._numberVertices*Lc),Le=this._long/2,Lf=this._width/2,Lg=this._long/this._stacks,Lh=this._width/this._slices,Li=0,Lj=0;Lj<=this._slices;Lj++)for(var Lk=0;Lk<=this._stacks;Lk++)Ld[Li++]=Lk*Lg-Le,Ld[Li++]=0,Ld[Li++]=Lj*Lh-Lf,Ld[Li++]=0,Ld[Li++]=1,Ld[Li++]=0,Ld[Li++]=1*Lk/this._stacks,Ld[Li++]=1*Lj/this._slices;var Ll=0;for(Lj=0;Lj<this._slices;Lj++)for(Lk=0;Lk<this._stacks;Lk++)La[Ll++]=(Lj+1)*(this._stacks+1)+Lk,La[Ll++]=Lj*(this._stacks+1)+Lk,La[Ll++]=(Lj+1)*(this._stacks+1)+Lk+1,La[Ll++]=Lj*(this._stacks+1)+Lk,La[Ll++]=Lj*(this._stacks+1)+Lk+1,La[Ll++]=(Lj+1)*(this._stacks+1)+Lk+1;this._vertexBuffer=new LOb(Lb,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new LNb("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(Ld),this._indexBuffer.setData(La),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Lo(0,Lb,"long",function(){return this._long},function(La){this._long!==La&&(this._long=La,this.releaseResource(),this.activeResource())}),Lo(0,Lb,"width",function(){return this._width},function(La){this._width!==La&&(this._width=La,this.releaseResource(),this.activeResource())}),Lo(0,Lb,"stacks",function(){return this._stacks},function(La){this._stacks!==La&&(this._stacks=La,this.releaseResource(),this.activeResource())}),Lo(0,Lb,"slices",function(){return this._slices},function(La){this._slices!==La&&(this._slices=La,this.releaseResource(),this.activeResource())})}(),function(La){function Lg(La,Lb,Lc){void 0===La&&(La=0),void 0===Lb&&(Lb=.3),void 0===Lc&&(Lc=1e3),this._viewMatrix=new Lab,this._projectionMatrix=new Lab,this._projectionViewMatrix=new Lab,this._viewport=new Lib(0,0,0,0),this._normalizedViewport=new Lib(0,0,1,1),this._aspectRatio=La,this._boundFrustumUpdate=!0,this._boundFrustum=new L$a(Lab.DEFAULT),Lg.__super.call(this,Lb,Lc),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Ln(Lg,"laya.d3.core.Camera",LUb);var Lb=Lg.prototype;return Lb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Lb._parseCustomProps=function(La,Lb,Lc,Ld){var Le=Lc.clearColor;this.clearColor=new Lhb(Le[0],Le[1],Le[2],Le[3]);var Lf=Lc.viewport;this.normalizedViewport=new Lib(Lf[0],Lf[1],Lf[2],Lf[3])},Lb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var La=this.orthographicVerticalSize*this.aspectRatio*.5,Lb=.5*this.orthographicVerticalSize;Lab.createOrthoOffCenterRH(-La,La,-Lb,Lb,this.nearPlane,this.farPlane,this._projectionMatrix)}else Lab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Lb._update=function(La){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,La)},Lb._renderCamera=function(La,Lb,Lc){var Ld,Le;Lc.parallelSplitShadowMaps[0]&&Lc._renderShadowMap(La,Lb,this),(Lb.camera=this)._prepareCameraToRender(),Lc._preRenderUpdateComponents(Lb),Ld=Lb._viewMatrix=this.viewMatrix;var Lf=this._renderTarget;Lf?(Lf.start(),Lab.multiply(LUb._invertYScaleMatrix,this._projectionMatrix,LUb._invertYProjectionMatrix),Lab.multiply(LUb._invertYScaleMatrix,this.projectionViewMatrix,LUb._invertYProjectionViewMatrix),Le=Lb._projectionMatrix=LUb._invertYProjectionMatrix,Lb._projectionViewMatrix=LUb._invertYProjectionViewMatrix):(Le=Lb._projectionMatrix=this._projectionMatrix,Lb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Ld,Le),Lb._viewport=this.viewport,Lc._preRenderScene(La,Lb,this.boundFrustum),Lc._clear(La,Lb),Lc._renderScene(La,Lb),Lc._postRenderUpdateComponents(Lb),Lf&&Lf.end()},Lb.viewportPointToRay=function(La,Lb){Lob.calculateCursorRay(La,this.viewport,this._projectionMatrix,this.viewMatrix,null,Lb)},Lb.normalizedViewportPointToRay=function(La,Lb){var Lc=Lg._tempVector20,Ld=this.viewport,Le=La.elements,Lf=Lc.elements;Lf[0]=Le[0]*Ld.width,Lf[1]=Le[1]*Ld.height,Lob.calculateCursorRay(Lc,this.viewport,this._projectionMatrix,this.viewMatrix,null,Lb)},Lb.worldToViewportPoint=function(La,Lb){Lab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(La,this._projectionViewMatrix,Lb);var Lc=Lb.elements;Lc[0]=Lc[0]/Lv.stage.clientScaleX,Lc[1]=Lc[1]/Lv.stage.clientScaleY},Lb.worldToNormalizedViewportPoint=function(La,Lb){Lab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(La,this._projectionViewMatrix,Lb);var Lc=Lb.elements;Lc[0]=Lc[0]/Lv.stage.clientScaleX,Lc[1]=Lc[1]/Lv.stage.clientScaleY},Lb.convertScreenCoordToOrthographicCoord=function(La,Lb,Lc){if(void 0===Lc&&(Lc=!0),this._orthographic){var Ld=LY.clientWidth,Le=LY.clientHeight,Lf=this.orthographicVerticalSize*this.aspectRatio/Ld,Lg=this.orthographicVerticalSize/Le,Lh=La.elements,Li=Lb.elements;return Li[0]=(-Ld/2+Lh[0])*Lf,Li[1]=(Le/2-Lh[1])*Lg,Li[2]=(this.nearPlane-this.farPlane)*(Lh[2]+1)/2-this.nearPlane,Lc&&Lgb.transformCoordinate(Lb,this.transform.worldMatrix,Lb),!0}return!1},Lo(0,Lb,"projectionViewMatrix",function(){return Lab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),Lo(0,Lb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var La=this.viewport;return La.width/La.height},function(La){if(La<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=La,this._calculateProjectionMatrix()}),Lo(0,Lb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),Lo(0,Lb,"needViewport",function(){var La=this.normalizedViewport;return 0===La.x&&0===La.y&&1===La.width&&1===La.height}),Lo(0,Lb,"viewport",function(){if(this._viewportExpressedInClipSpace){var La=this._normalizedViewport,Lb=this.renderTargetSize,Lc=Lb.width,Ld=Lb.height;this._viewport.x=La.x*Lc,this._viewport.y=La.y*Ld,this._viewport.width=La.width*Lc,this._viewport.height=La.height*Ld}return this._viewport},function(La){if(null!=this.renderTarget&&(La.x<0||La.y<0||0==La.width||0==La.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=La,this._calculateProjectionMatrix()}),Lo(0,Lb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var La=this._viewport,Lb=this.renderTargetSize,Lc=Lb.width,Ld=Lb.height;this._normalizedViewport.x=La.x/Lc,this._normalizedViewport.y=La.y/Ld,this._normalizedViewport.width=La.width/Lc,this._normalizedViewport.height=La.height/Ld}return this._normalizedViewport},function(La){La.x<0&&(La.x=0,console.warn("Camera: viewport.x must large than 0.0.")),La.y<0&&(La.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<La.x+La.width&&(La.width=1-La.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<La.y+La.height&&(La.height=1-La.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=La,this._calculateProjectionMatrix()}),Lo(0,Lb,"projectionMatrix",function(){return this._projectionMatrix},function(La){this._projectionMatrix=La,this._useUserProjectionMatrix=!0}),Lo(0,Lb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),Ll(Lg,["_tempVector20",function(){return this._tempVector20=new Lfb}]),Lg}()),LXb=function(Lc){function Ld(La,Lb){Ld.__super.call(this,Lb),this._geometryFilter=new LHb(this),this._render=new LIb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),La&&(this._geometryFilter.sharedMesh=La)instanceof laya.d3.resource.models.Mesh&&(La.loaded?this._render.sharedMaterials=La.materials:La.once("loaded",this,this._applyMeshMaterials))}Ln(Ld,"laya.d3.core.MeshSprite3D",Lc);var La=Ld.prototype;return La._changeRenderObjectByMesh=function(La){var Lb=this._render._renderElements,Lc=Lb[La];Lc||(Lc=Lb[La]=new Lzb),Lc._render=this._render;var Ld=this._render.sharedMaterials[La];Ld||(Ld=LMb.defaultMaterial);var Le=this._geometryFilter.sharedMesh.getRenderElement(La);return Lc._mainSortID=this._getSortID(Le,Ld),Lc._sprite3D=this,Lc.renderObj=Le,Lc._material=Ld,Lc},La._changeRenderObjectByMaterial=function(La,Lb){var Lc=this._render._renderElements[La];Lb||(Lb=LMb.defaultMaterial);var Ld=this._geometryFilter.sharedMesh.getRenderElement(La);return Lc._mainSortID=this._getSortID(Ld,Lb),Lc._sprite3D=this,Lc.renderObj=Ld,Lc._material=Lb,Lc},La._changeRenderObjectsByMesh=function(){var La=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=La;for(var Lb=0;Lb<La;Lb++)this._changeRenderObjectByMesh(Lb)},La._onMeshChanged=function(La){var Lb=La.sharedMesh;Lb.loaded?this._changeRenderObjectsByMesh():Lb.once("loaded",this,this._onMeshLoaded)},La._onMeshLoaded=function(La){La===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},La._onMaterialChanged=function(La,Lb,Lc){Lb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Lb,Lc)},La._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},La._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},La._parseCustomProps=function(La,Lb,Lc,Ld){var Le=this.meshRender,Lf=Lc.lightmapIndex;null!=Lf&&(Le.lightmapIndex=Lf);var Lg,Lh,Li=Lc.lightmapScaleOffset;if(Li&&(Le.lightmapScaleOffset=new Lhb(Li[0],Li[1],Li[2],Li[3])),Ld.instanceParams)(Lg=Ld.instanceParams.loadPath)&&(Lh=Lr.getRes(Lb[Lg]),(this.meshFilter.sharedMesh=Lh).loaded?Le.sharedMaterials=Lh.materials:Lh.once("loaded",this,this._applyMeshMaterials));else{(Lg=Lc.meshPath)&&(Lh=Lr.getRes(Lb[Lg]),this.meshFilter.sharedMesh=Lh);var Lj=Lc.materials;if(Lj){var Lk=Le.sharedMaterials,Ll=Lj.length;Lk.length=Ll;for(var Lm=0;Lm<Ll;Lm++)Lk[Lm]=Lr.getRes(Lb[Lj[Lm].path]);Le.sharedMaterials=Lk}}},La._applyMeshMaterials=function(La){for(var Lb=this._render.sharedMaterials,Lc=La.materials,Ld=0,Le=Lc.length;Ld<Le;Ld++)Lb[Ld]||(Lb[Ld]=Lc[Ld]);this._render.sharedMaterials=Lb},La._addToInitStaticBatchManager=function(){Ld._staticBatchManager._addInitBatchSprite(this)},La.cloneTo=function(La){var Lb=La;Lb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var Lc=this._render,Ld=Lb._render;Ld.enable=Lc.enable,Ld.sharedMaterials=Lc.sharedMaterials,Ld.castShadow=Lc.castShadow;var Le=Lc.lightmapScaleOffset;Le&&(Ld.lightmapScaleOffset=Le.clone()),Ld.lightmapIndex=Lc.lightmapIndex,Ld.receiveShadow=Lc.receiveShadow,Ld.sortingFudge=Lc.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,La)},La.destroy=function(La){if(void 0===La&&(La=!0),!this.destroyed){var Lb=this.meshFilter.sharedMesh;null!=Lb&&(Lb.loaded||Lb.off("loaded",this,this._applyMeshMaterials)),Lc.prototype.destroy.call(this,La),this._geometryFilter._destroy()}},Lo(0,La,"meshFilter",function(){return this._geometryFilter}),Lo(0,La,"meshRender",function(){return this._render}),Ld.__init__=function(){Lda._staticBatchManagers.push(Ld._staticBatchManager)},Ld.load=function(La){return Lv.loader.create(La,null,null,Ld)},Ll(Ld,["_staticBatchManager",function(){return this._staticBatchManager=new LBb}]),Ld}(LVb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(La,Lb,Lea){Lea.un,Lea.uns;var Lc=Lea.static,Ld=Lea.class,Lf=Lea.getset,Lp=Lea.__newvec,Lh=laya.maths.Bezier,Ll=laya.utils.Browser,LFa=laya.utils.Byte,Le=(laya.events.Event,laya.events.EventDispatcher),Lg=laya.display.Graphics,Li=(laya.resource.HTMLCanvas,laya.utils.Handler),Lj=laya.net.Loader,Lm=laya.maths.MathUtil,LGa=laya.maths.Matrix,Lq=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),Lk=(laya.renders.RenderContext,laya.resource.Resource),Ln=laya.utils.RunDriver,Lfa=laya.display.Sprite,Lo=laya.utils.Stat,LHa=laya.resource.Texture,Lr=(laya.net.URL,laya.utils.Utils),LG=function(){function La(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Ld(La,"laya.ani.AnimationContent"),La}(),LH=function(){function La(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Ld(La,"laya.ani.AnimationNodeContent"),La}(),Lt=function(){function La(){}return Ld(La,"laya.ani.AnimationParser01"),La.parse=function(La,Lb){var Lc=Lb.__getBuffer(),Ld=0,Le=0,Lf=0,Lg=0,Lh=0,Li=0,Lj=0,Lk=Lb.readUTFString();La._aniClassName=Lk;var Ll,Lm=Lb.readUTFString().split("\n"),Ln=Lb.getUint8(),Lo=Lb.getUint32(),Lp=Lb.getUint32();0<Lo&&(Ll=Lc.slice(Lo,Lp));var Lq=new LFa(Ll);for(0<Lp&&(La._publicExtData=Lc.slice(Lp,Lc.byteLength)),La._useParent=!!Lb.getUint8(),La._anis.length=Ln,Ld=0;Ld<Ln;Ld++){var Lr=La._anis[Ld]=new LG;Lr.nodes=new Array;var Ls=Lr.name=Lm[Lb.getUint16()];La._aniMap[Ls]=Ld,Lr.bone3DMap={},Lr.playTime=Lb.getFloat32(),Lr.playTime<=0&&console.error("播放时间不能为0  url="+La.url+" name="+Lr.name);var Lt=Lr.nodes.length=Lb.getUint8();for(Le=Lr.totalKeyframeDatasLength=0;Le<Lt;Le++){var Lu=Lr.nodes[Le]=new LH;Lu.childs=[];var Lv=Lb.getInt16();0<=Lv&&(Lu.name=Lm[Lv],Lr.bone3DMap[Lu.name]=Le),Lu.keyFrame=new Array,Lu.parentIndex=Lb.getInt16(),-1==Lu.parentIndex?Lu.parent=null:Lu.parent=Lr.nodes[Lu.parentIndex],Lu.lerpType=Lb.getUint8();var Ly=Lb.getUint32();Lq.pos=Ly;var Lz=Lu.keyframeWidth=Lq.getUint16();if(Lr.totalKeyframeDatasLength+=Lz,0===Lu.lerpType||1===Lu.lerpType)for(Lu.interpolationMethod=[],Lu.interpolationMethod.length=Lz,Lf=0;Lf<Lz;Lf++)Lu.interpolationMethod[Lf]=LK.interpolation[Lq.getUint8()];null!=Lu.parent&&Lu.parent.childs.push(Lu);var LA=Lb.getUint16();0<LA&&(Lu.extenData=Lc.slice(Lb.pos,Lb.pos+LA),Lb.pos+=LA);var LB,LC=Lb.getUint16(),LD=0;for(Lf=0,Lg=Lu.keyFrame.length=LC;Lf<Lg;Lf++){if((LB=Lu.keyFrame[Lf]=new LI).duration=Lb.getFloat32(),LB.startTime=LD,2===Lu.lerpType){LB.interpolationData=[];var LE,LF=Lb.getUint8();switch(LE=Lb.getFloat32()){case 254:for(LB.interpolationData.length=Lz,Lj=0;Lj<Lz;Lj++)LB.interpolationData[Lj]=0;break;case 255:for(LB.interpolationData.length=Lz,Lj=0;Lj<Lz;Lj++)LB.interpolationData[Lj]=5;break;default:for(LB.interpolationData.push(LE),Li=1;Li<LF;Li++)LB.interpolationData.push(Lb.getFloat32())}}for(LB.data=new Float32Array(Lz),Lh=0;Lh<Lz;Lh++)LB.data[Lh]=Lb.getFloat32(),-1e-8<LB.data[Lh]&&LB.data[Lh]<1e-8&&(LB.data[Lh]=0);LD+=LB.duration}LB.startTime=Lr.playTime,Lu.playTime=Lr.playTime,La._calculateKeyFrame(Lu,LC,Lz)}}},La}(),Lu=function(){function Lv(){}return Ld(Lv,"laya.ani.AnimationParser02"),Lv.READ_DATA=function(){Lv._DATA.offset=Lv._reader.getUint32(),Lv._DATA.size=Lv._reader.getUint32()},Lv.READ_BLOCK=function(){for(var La=Lv._BLOCK.count=Lv._reader.getUint16(),Lb=Lv._BLOCK.blockStarts=[],Lc=Lv._BLOCK.blockLengths=[],Ld=0;Ld<La;Ld++)Lb.push(Lv._reader.getUint32()),Lc.push(Lv._reader.getUint32())},Lv.READ_STRINGS=function(){var La=Lv._reader.getUint32(),Lb=Lv._reader.getUint16(),Lc=Lv._reader.pos;Lv._reader.pos=La+Lv._DATA.offset;for(var Ld=0;Ld<Lb;Ld++)Lv._strings[Ld]=Lv._reader.readUTFString();Lv._reader.pos=Lc},Lv.parse=function(La,Lb){Lv._templet=La;(Lv._reader=Lb).__getBuffer();Lv.READ_DATA(),Lv.READ_BLOCK(),Lv.READ_STRINGS();for(var Lc=0,Ld=Lv._BLOCK.count;Lc<Ld;Lc++){var Le=Lb.getUint16(),Lf=Lv._strings[Le],Lg=Lv["READ_"+Lf];if(null==Lg)throw new Error("model file err,no this function:"+Le+" "+Lf);Lg.call()}},Lv.READ_ANIMATIONS=function(){var La=Lv._reader,Lb=La.__getBuffer(),Lc=0,Ld=0,Le=0,Lf=0,Lg=La.getUint16(),Lh=[];for(Lh.length=Lg,Lc=0;Lc<Lg;Lc++)Lh[Lc]=LK.interpolation[La.getByte()];var Li=La.getUint8();for(Lv._templet._anis.length=Li,Lc=0;Lc<Li;Lc++){var Lj=Lv._templet._anis[Lc]={};Lj.nodes=new Array;var Lk=Lj.name=Lv._strings[La.getUint16()];Lv._templet._aniMap[Lk]=Lc,Lj.bone3DMap={},Lj.playTime=La.getFloat32();var Ll=Lj.nodes.length=La.getInt16();for(Ld=Lj.totalKeyframeDatasLength=0;Ld<Ll;Ld++){var Lm=Lj.nodes[Ld]={};Lm.keyframeWidth=Lg,Lm.childs=[];var Ln=La.getUint16();0<=Ln&&(Lm.name=Lv._strings[Ln],Lj.bone3DMap[Lm.name]=Ld),Lm.keyFrame=new Array,Lm.parentIndex=La.getInt16(),-1==Lm.parentIndex?Lm.parent=null:Lm.parent=Lj.nodes[Lm.parentIndex],Lj.totalKeyframeDatasLength+=Lg,Lm.interpolationMethod=Lh,null!=Lm.parent&&Lm.parent.childs.push(Lm);var Lo=La.getUint16(),Lp=null,Lq=null;for(Le=0,Lf=Lm.keyFrame.length=Lo;Le<Lf;Le++){(Lp=Lm.keyFrame[Le]={}).startTime=La.getFloat32(),Lq&&(Lq.duration=Lp.startTime-Lq.startTime);var Lr=Lv._DATA.offset,Ls=La.getUint32(),Lt=4*Lg,Lu=Lb.slice(Lr+Ls,Lr+Ls+Lt);Lp.data=new Float32Array(Lu),Lq=Lp}Lp.duration=0,Lm.playTime=Lj.playTime,Lv._templet._calculateKeyFrame(Lm,Lo,Lg)}}},Lv._templet=null,Lv._reader=null,Lv._strings=[],Lc(Lv,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Lv}(),LIa=(function(){function La(){}Ld(La,"laya.ani.AnimationState"),La.stopped=0,La.paused=1,La.playing=2}(),function(){function Le(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new LVa,this.resultMatrix=new LGa,this._children=[]}Ld(Le,"laya.ani.bone.Bone");var La=Le.prototype;return La.setTempMatrix=function(La){this._tempMatrix=La;var Lb,Lc=0;for(Lc=0,Lb=this._children.length;Lc<Lb;Lc++)this._children[Lc].setTempMatrix(this._tempMatrix)},La.update=function(La){var Lb;if(this.rotation=this.transform.skX,La)Lb=this.resultTransform.getMatrix(),LGa.mul(Lb,La,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Lb=this.resultTransform.getMatrix(),LGa.mul(Lb,this.parentBone.resultMatrix,this.resultMatrix);else{var Lc=this.parentBone,Ld=NaN,Le=NaN,Lf=NaN,Lg=this.parentBone.resultMatrix;Lb=this.resultTransform.getMatrix();var Lh=Lg.a*Lb.tx+Lg.c*Lb.ty+Lg.tx,Li=Lg.b*Lb.tx+Lg.d*Lb.ty+Lg.ty,Lj=new LGa;this.inheritRotation?(Ld=Math.atan2(Lc.resultMatrix.b,Lc.resultMatrix.a),Le=Math.cos(Ld),Lf=Math.sin(Ld),Lj.setTo(Le,Lf,-Lf,Le,0,0),LGa.mul(this._tempMatrix,Lj,LGa.TEMP),LGa.TEMP.copyTo(Lj),Lb=this.resultTransform.getMatrix(),LGa.mul(Lb,Lj,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Lb=this.resultTransform.getMatrix(),LGa.TEMP.identity(),LGa.TEMP.d=this.d,LGa.mul(Lb,LGa.TEMP,this.resultMatrix)),this.resultMatrix.tx=Lh,this.resultMatrix.ty=Li}else(Lb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var Lk,Ll=0;for(Ll=0,Lk=this._children.length;Ll<Lk;Ll++)this._children[Ll].update()},La.updateChild=function(){var La,Lb=0;for(Lb=0,La=this._children.length;Lb<La;Lb++)this._children[Lb].update()},La.setRotation=function(La){this._sprite&&(this._sprite.rotation=180*La/Math.PI)},La.updateDraw=function(La,Lb){Le.ShowBones&&!Le.ShowBones[this.name]||(this._sprite||(this._sprite=new Lfa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),Lea.stage.addChild(this._sprite)),this._sprite.x=La+this.resultMatrix.tx,this._sprite.y=Lb+this.resultMatrix.ty);var Lc,Ld=0;for(Ld=0,Lc=this._children.length;Ld<Lc;Ld++)this._children[Ld].updateDraw(La,Lb)},La.addChild=function(La){this._children.push(La),La.parentBone=this},La.findBone=function(La){if(this.name==La)return this;var Lb,Lc,Ld=0;for(Ld=0,Lb=this._children.length;Ld<Lb;Ld++)if(Lc=this._children[Ld].findBone(La))return Lc;return null},La.localToWorld=function(La){var Lb=La[0],Lc=La[1];La[0]=Lb*this.resultMatrix.a+Lc*this.resultMatrix.c+this.resultMatrix.tx,La[1]=Lb*this.resultMatrix.b+Lc*this.resultMatrix.d+this.resultMatrix.ty},Le.ShowBones={},Le}()),LJa=function(){function Lp(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Ld(Lp,"laya.ani.bone.BoneSlot");var La=Lp.prototype;return La.showSlotData=function(La,Lb){void 0===Lb&&(Lb=!0),this.currSlotData=La,Lb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},La.showDisplayByName=function(La){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(La))},La.replaceDisplayByName=function(La,Lb){if(this.currSlotData){var Lc;Lc=this.currSlotData.getDisplayByName(La);var Ld;Ld=this.currSlotData.getDisplayByName(Lb),this.replaceDisplayByIndex(Lc,Ld)}},La.replaceDisplayByIndex=function(La,Lb){this.currSlotData&&(this._replaceDic[La]=Lb,this.displayIndex==La&&this.showDisplayByIndex(La))},La.showDisplayByIndex=function(La){if(null!=this._replaceDic[La]&&(La=this._replaceDic[La]),this.currSlotData&&-1<La&&La<this.currSlotData.displayArr.length){if(this.displayIndex=La,this.currDisplayData=this.currSlotData.displayArr[La],this.currDisplayData){var Lb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Lb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Lq.isConchApp||Lq.isConchApp&&"0.9.15"<Lfa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},La.replaceSkin=function(La){this._diyTexture=La,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},La.setParentMatrix=function(La){this._parentMatrix=La},La.draw=function(La,Lb,Lc,Ld){if(void 0===Lc&&(Lc=!1),void 0===Ld&&(Ld=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var Le,Lf=this.currTexture;switch(this._diyTexture&&(Lf=this._diyTexture),this.currDisplayData.type){case 0:if(La){var Lg=this.getDisplayMatrix();if(this._parentMatrix){var Lh=!1;if(Lg){var Li;if(LGa.mul(Lg,this._parentMatrix,LGa.TEMP),Li=Lc?(null==this._resultMatrix&&(this._resultMatrix=new LGa),this._resultMatrix):new LGa,!Lq.isWebGL&&this.currDisplayData.uvs||Lq.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var Lj=Lp._tempMatrix;Lj.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Lj.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Lh=!0,Lj.rotate(-Math.PI/2)),LGa.mul(Lj,LGa.TEMP,Li)}else LGa.TEMP.copyTo(Li);Lh?La.drawTexture(Lf,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Li):La.drawTexture(Lf,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Li)}}}break;case 1:if(null==(Le=Lc?(null==this._skinSprite&&(this._skinSprite=Lp.createSkinMesh()),this._skinSprite):Lp.createSkinMesh()))return;var Lk;if(null==this.currDisplayData.bones){var Ll,Lm=this.currDisplayData.weights;this.deformData&&(Lm=this.deformData),Ll=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Lz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Lz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Lm;this.currDisplayData.triangles.length;Lk=this.currDisplayData.triangles,Le.init2(Lf,null,Lk,this._mVerticleArr,Ll);var Ln,Lo=this.getDisplayMatrix();if(this._parentMatrix)if(Lo)LGa.mul(Lo,this._parentMatrix,LGa.TEMP),Ln=Lc?(null==this._resultMatrix&&(this._resultMatrix=new LGa),this._resultMatrix):new LGa,LGa.TEMP.copyTo(Ln),Le.transform=Ln}else this.skinMesh(Lb,Le,Ld);La.drawSkin(Le);break;case 2:if(null==(Le=Lc?(null==this._skinSprite&&(this._skinSprite=Lp.createSkinMesh()),this._skinSprite):Lp.createSkinMesh()))return;this.skinMesh(Lb,Le,Ld),La.drawSkin(Le)}}},La.skinMesh=function(La,Lb,Lc){var Ld,Le=this.currTexture,Lf=this.currDisplayData.bones;Ld=this._diyTexture?(Le=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Lz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Lz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var Lg,Lh,Li=this.currDisplayData.weights,Lj=this.currDisplayData.triangles,Lk=0,Ll=0,Lm=0,Ln=NaN,Lo=NaN,Lp=0,Lq=0,Lr=[],Ls=0,Lt=0;if(this.deformData&&0<this.deformData.length){var Lu=0;for(Ls=0,Lt=Lf.length;Ls<Lt;){for(Lm=Lf[Ls++]+Ls,Ll=Lk=0;Ls<Lm;Ls++)Lh=La[Lf[Ls]],Ln=Li[Lp]+this.deformData[Lu++],Lo=Li[Lp+1]+this.deformData[Lu++],Lq=Li[Lp+2],Lk+=(Ln*Lh.a+Lo*Lh.c+Lh.tx)*Lq,Ll+=(Ln*Lh.b+Lo*Lh.d+Lh.ty)*Lq,Lp+=3;Lr.push(Lk,Ll)}}else for(Ls=0,Lt=Lf.length;Ls<Lt;){for(Lm=Lf[Ls++]+Ls,Ll=Lk=0;Ls<Lm;Ls++)Lh=La[Lf[Ls]],Ln=Li[Lp],Lo=Li[Lp+1],Lq=Li[Lp+2],Lk+=(Ln*Lh.a+Lo*Lh.c+Lh.tx)*Lq,Ll+=(Ln*Lh.b+Lo*Lh.d+Lh.ty)*Lq,Lp+=3;Lr.push(Lk,Ll)}this._mVerticleArr=Lr,Lg=Lj,Lb.init2(Le,null,Lg,this._mVerticleArr,Ld)},La.drawBonePoint=function(La){La&&this._parentMatrix&&La.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},La.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},La.getMatrix=function(){return this._resultMatrix},La.copy=function(){var La=new Lp;return La.type="copy",La.name=this.name,La.attachmentName=this.attachmentName,La.srcDisplayIndex=this.srcDisplayIndex,La.parent=this.parent,La.displayIndex=this.displayIndex,La.templet=this.templet,La.currSlotData=this.currSlotData,La.currTexture=this.currTexture,La.currDisplayData=this.currDisplayData,La},Lp.createSkinMesh=function(){return Lq.isWebGL||Lq.isConchApp?Ln.skinAniSprite():(Lq.isWebGL,null)},Lc(Lp,["_tempMatrix",function(){return this._tempMatrix=new LGa}]),Lp}(),LKa=function(){function La(){this.skinName=null,this.deformSlotDataList=[]}return Ld(La,"laya.ani.bone.DeformAniData"),La}(),LLa=function(){function La(){this.deformSlotDisplayList=[]}return Ld(La,"laya.ani.bone.DeformSlotData"),La}(),LMa=function(){function La(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Ld(La,"laya.ani.bone.DeformSlotDisplayData");var Lb=La.prototype;return Lb.binarySearch1=function(La,Lb){var Lc=0,Ld=La.length-2;if(0==Ld)return 1;for(var Le=Ld>>>1;;){if(La[Math.floor(Le+1)]<=Lb?Lc=Le+1:Ld=Le,Lc==Ld)return Lc+1;Le=Lc+Ld>>>1}return 0},Lb.apply=function(La,Lb,Lc){if(void 0===Lc&&(Lc=1),La+=.05,!(this.timeList.length<=0)){var Ld=0;if(!(La<this.timeList[0])){var Le=this.vectices[0].length,Lf=[],Lg=this.binarySearch1(this.timeList,La);if(this.frameIndex=Lg,La>=this.timeList[this.timeList.length-1]){var Lh=this.vectices[this.vectices.length-1];if(Lc<1)for(Ld=0;Ld<Le;Ld++)Lf[Ld]+=(Lh[Ld]-Lf[Ld])*Lc;else for(Ld=0;Ld<Le;Ld++)Lf[Ld]=Lh[Ld];this.deformData=Lf}else{this.tweenKeyList[this.frameIndex];var Li=this.vectices[this.frameIndex-1],Lj=this.vectices[this.frameIndex],Lk=this.timeList[this.frameIndex-1],Ll=this.timeList[this.frameIndex];Lc=this.tweenKeyList[Lg-1]?(La-Lk)/(Ll-Lk):0;var Lm=NaN;for(Ld=0;Ld<Le;Ld++)Lm=Li[Ld],Lf[Ld]=Lm+(Lj[Ld]-Lm)*Lc;this.deformData=Lf}}}},La}(),LNa=function(){function La(){this.time=NaN,this.drawOrder=[]}return Ld(La,"laya.ani.bone.DrawOrderData"),La}(),LOa=function(){function La(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Ld(La,"laya.ani.bone.EventData"),La}(),Ls=function(){function Lda(La,Lb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=La,this._targetBone=Lb[La.targetBoneIndex],this.isSpine=La.isSpine,null==this._bones&&(this._bones=[]);for(var Lc=this._bones.length=0,Ld=La.boneIndexs.length;Lc<Ld;Lc++)this._bones.push(Lb[La.boneIndexs[Lc]]);this.name=La.name,this.mix=La.mix,this.bendDirection=La.bendDirection}Ld(Lda,"laya.ani.bone.IkConstraint");var La=Lda.prototype;return La.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},La._applyIk1=function(La,Lb,Lc,Ld){var Le=La.parentBone,Lf=1/(Le.resultMatrix.a*Le.resultMatrix.d-Le.resultMatrix.b*Le.resultMatrix.c),Lg=Lb-Le.resultMatrix.tx,Lh=Lc-Le.resultMatrix.ty,Li=(Lg*Le.resultMatrix.d-Lh*Le.resultMatrix.c)*Lf-La.transform.x,Lj=(Lh*Le.resultMatrix.a-Lg*Le.resultMatrix.b)*Lf-La.transform.y,Lk=Math.atan2(Lj,Li)*Lda.radDeg-0-La.transform.skX;La.transform.scX<0&&(Lk+=180),180<Lk?Lk-=360:Lk<-180&&(Lk+=360),La.transform.skX=La.transform.skY=La.transform.skX+Lk*Ld,La.update()},La.updatePos=function(La,Lb){this._sp&&this._sp.pos(La,Lb)},La._applyIk2=function(La,Lb,Lc,Ld,Le,Lf){if(0!=Lf){var Lg=La.resultTransform.x,Lh=La.resultTransform.y,Li=La.transform.scX,Lj=La.transform.scY,Lk=Lb.transform.scX,Ll=0,Lm=0,Ln=0;Ln=Li<0?(Li=-Li,Ll=180,-1):(Ll=0,1),Lj<0&&(Lj=-Lj,Ln=-Ln),Lm=Lk<0?(Lk=-Lk,180):0;var Lo=Lb.resultTransform.x,Lp=NaN,Lq=NaN,Lr=NaN,Ls=La.resultMatrix.a,Lt=La.resultMatrix.c,Lu=La.resultMatrix.b,Lv=La.resultMatrix.d,Ly=Math.abs(Li-Lj)<=1e-4;Lr=Ly?(Lq=Ls*Lo+Lt*(Lp=Lb.resultTransform.y)+La.resultMatrix.tx,Lu*Lo+Lv*Lp+La.resultMatrix.ty):(Lp=0,Lq=Ls*Lo+La.resultMatrix.tx,Lu*Lo+La.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Lfa,Lea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Lc,Ld,15,"#ffff00"),this._sp.graphics.drawCircle(Lq,Lr,15,"#ff00ff")),La.setRotation(Math.atan2(Lr-La.resultMatrix.ty,Lq-La.resultMatrix.tx));var Lz=La.parentBone;Ls=Lz.resultMatrix.a,Lt=Lz.resultMatrix.c,Lu=Lz.resultMatrix.b;var LA=1/(Ls*(Lv=Lz.resultMatrix.d)-Lt*Lu),LB=Lc-Lz.resultMatrix.tx,LC=Ld-Lz.resultMatrix.ty,LD=(LB*Lv-LC*Lt)*LA-Lg,LE=(LC*Ls-LB*Lu)*LA-Lh,LF=((LB=Lq-Lz.resultMatrix.tx)*Lv-(LC=Lr-Lz.resultMatrix.ty)*Lt)*LA-Lg,LG=(LC*Ls-LB*Lu)*LA-Lh,LH=Math.sqrt(LF*LF+LG*LG),LI=Lb.length*Lk,LJ=NaN,LK=NaN;if(Ly){var LL=(LD*LD+LE*LE-LH*LH-(LI*=Li)*LI)/(2*LH*LI);LL<-1?LL=-1:1<LL&&(LL=1),LK=Math.acos(LL)*Le,Ls=LH+LI*LL,Lt=LI*Math.sin(LK),LJ=Math.atan2(LE*Ls-LD*Lt,LD*Ls+LE*Lt)}else{var LM=(Ls=Li*LI)*Ls,LN=(Lt=Lj*LI)*Lt,LO=LD*LD+LE*LE,LP=Math.atan2(LE,LD),LQ=-2*LN*LH,LR=LN-LM;if(0<(Lv=LQ*LQ-4*LR*(Lu=LN*LH*LH+LM*LO-LM*LN))){var LS=Math.sqrt(Lv);LQ<0&&(LS=-LS);var LT=(LS=-(LQ+LS)/2)/LR,LU=Lu/LS,LV=Math.abs(LT)<Math.abs(LU)?LT:LU;LV*LV<=LO&&(LC=Math.sqrt(LO-LV*LV)*Le,LJ=LP-Math.atan2(LC,LV),LK=Math.atan2(LC/Lj,(LV-LH)/Li))}var LW=0,LX=Number.MAX_VALUE,LY=0,LZ=0,L$=0,L_=0,Lw=0,Lx=0;L_<(Lv=(LB=LH+Ls)*LB)&&(L$=0,L_=Lv,Lw=LB),(Lv=(LB=LH-Ls)*LB)<LX&&(LW=Math.PI,LX=Lv,LY=LB);var Laa=Math.acos(-Ls*LH/(LM-LN));(Lv=(LB=Ls*Math.cos(Laa)+LH)*LB+(LC=Lt*Math.sin(Laa))*LC)<LX&&(LW=Laa,LX=Lv,LY=LB,LZ=LC),L_<Lv&&(L$=Laa,L_=Lv,Lw=LB,Lx=LC),LK=LO<=(LX+L_)/2?(LJ=LP-Math.atan2(LZ*Le,LY),LW*Le):(LJ=LP-Math.atan2(Lx*Le,Lw),L$*Le)}var Lba=Math.atan2(Lp,Lo)*Ln,Lca=La.resultTransform.skX;180<(LJ=(LJ-Lba)*Lda.radDeg+Ll-Lca)?LJ-=360:LJ<-180&&(LJ+=360),La.resultTransform.x=Lg,La.resultTransform.y=Lh,La.resultTransform.skX=La.resultTransform.skY=Lca+LJ*Lf,Lca=Lb.resultTransform.skX,180<(LK=((LK+Lba)*Lda.radDeg-0)*Ln+Lm-(Lca%=360))?LK-=360:LK<-180&&(LK+=360),Lb.resultTransform.x=Lo,Lb.resultTransform.y=Lp,Lb.resultTransform.skX=Lb.resultTransform.skY=Lb.resultTransform.skY+LK*Lf,La.update()}},La._applyIk3=function(La,Lb,Lc,Ld,Le,Lf){if(0!=Lf){var Lg,Lh,Li=Lb.resultMatrix.a*Lb.length,Lj=Lb.resultMatrix.b*Lb.length,Lk=Li*Li+Lj*Lj,Ll=Math.sqrt(Lk),Lm=La.resultMatrix.tx,Ln=La.resultMatrix.ty,Lo=Lb.resultMatrix.tx,Lp=Lb.resultMatrix.ty,Lq=Lo-Lm,Lr=Lp-Ln,Ls=Lq*Lq+Lr*Lr,Lt=Math.sqrt(Ls),Lu=(Lq=Lc-La.resultMatrix.tx)*Lq+(Lr=Ld-La.resultMatrix.ty)*Lr,Lv=Math.sqrt(Lu);if(Ll+Lt<=Lv||Lv+Ll<=Lt||Lv+Lt<=Ll){var Ly=NaN;Lo=Lm+(Ly=Ll+Lt<=Lv?1:-1)*(Lc-Lm)*Lt/Lv,Lp=Ln+Ly*(Ld-Ln)*Lt/Lv}else{var Lz=(Ls-Lk+Lu)/(2*Lu),LA=Math.sqrt(Ls-Lz*Lz*Lu)/Lv,LB=Lm+Lq*Lz,LC=Ln+Lr*Lz,LD=-Lr*LA,LE=Lq*LA;Lp=0<Le?(Lo=LB-LD,LC-LE):(Lo=LB+LD,LC+LE)}Lg=Lo,Lh=Lp,this.isDebug&&(this._sp||(this._sp=new Lfa,Lea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Lm,Ln,15,"#ff00ff"),this._sp.graphics.drawCircle(Lc,Ld,15,"#ffff00"),this._sp.graphics.drawCircle(Lg,Lh,15,"#ff00ff"));var LF,LG;LF=Math.atan2(Lh-La.resultMatrix.ty,Lg-La.resultMatrix.tx),La.setRotation(LF),(LG=Lda._tempMatrix).identity(),LG.rotate(LF),LG.scale(La.resultMatrix.getScaleX(),La.resultMatrix.getScaleY()),LG.translate(La.resultMatrix.tx,La.resultMatrix.ty),LG.copyTo(La.resultMatrix),La.updateChild();var LH,LI;LH=Math.atan2(Ld-Lh,Lc-Lg),Lb.setRotation(LH),(LI=Lda._tempMatrix).identity(),LI.rotate(LH),LI.scale(Lb.resultMatrix.getScaleX(),Lb.resultMatrix.getScaleY()),LI.translate(Lg,Lh),LG.copyTo(Lb.resultMatrix),Lb.updateChild()}},Lc(Lda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new LGa}]),Lda}(),LPa=function(){function La(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Ld(La,"laya.ani.bone.IkConstraintData"),La}(),Lv=function(){function LI(La,Lb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=La,this.position=La.position,this.spacing=La.spacing,this.rotateMix=La.rotateMix,this.translateMix=La.translateMix,this.bones=[];for(var Lc=this.data.bones,Ld=0,Le=Lc.length;Ld<Le;Ld++)this.bones.push(Lb[Lc[Ld]])}Ld(LI,"laya.ani.bone.PathConstraint");var La=LI.prototype;return La.apply=function(La,Lb){if(this.target){var Lc=this.translateMix,Ld=this.translateMix,Le=0<Ld,Lf=this.data.spacingMode,Lg="length"==Lf,Lh=this.data.rotateMode,Li="tangent"==Lh,Lj="chainScale"==Lh,Lk=[],Ll=this.bones.length,Lm=Li?Ll:Ll+1,Ln=[];(this._spaces=Ln)[0]=this.position;var Lo=this.spacing;if(Lj||Lg)for(var Lp=0,Lq=Lm-1;Lp<Lq;){var Lr=this.bones[Lp],Ls=Lr.length,Lt=Ls*Lr.resultMatrix.a,Lu=Ls*Lr.resultMatrix.b;Ls=Math.sqrt(Lt*Lt+Lu*Lu),Lj&&(Lk[Lp]=Ls),Ln[++Lp]=Lg?Math.max(0,Ls+Lo):Lo}else for(Lp=1;Lp<Lm;Lp++)Ln[Lp]=Lo;var Lv=this.computeWorldPositions(this.target,La,Lb,Lm,Li,"percent"==this.data.positionMode,"percent"==Lf);if(this._debugKey){for(Lp=0;Lp<Lv.length;Lp++)Lb.drawCircle(Lv[Lp++],Lv[Lp++],5,"#00ff00");var Ly=[];for(Lp=0;Lp<Lv.length;Lp++)Ly.push(Lv[Lp++],Lv[Lp++]);Lb.drawLines(0,0,Ly,"#ff0000")}var Lz=Lv[0],LA=Lv[1],LB=this.data.offsetRotation,LC="chain"==Lh&&0==LB,LD=NaN;for(Lp=0,LD=3;Lp<Ll;Lp++,LD+=3){(Lr=this.bones[Lp]).resultMatrix.tx+=(Lz-Lr.resultMatrix.tx)*Lc,Lr.resultMatrix.ty+=(LA-Lr.resultMatrix.ty)*Lc;var LE=(Lt=Lv[LD])-Lz,LF=(Lu=Lv[LD+1])-LA;if(Lj&&0!=(Ls=Lk[Lp])){var LG=(Math.sqrt(LE*LE+LF*LF)/Ls-1)*Ld+1;Lr.resultMatrix.a*=LG,Lr.resultMatrix.c*=LG}if(Lz=Lt,LA=Lu,Le){var LH=Lr.resultMatrix.a,LI=Lr.resultMatrix.c,LJ=Lr.resultMatrix.b,LK=Lr.resultMatrix.d,LL=NaN,LM=NaN,LN=NaN;LL=Li?Lv[LD-1]:0==Ln[Lp+1]?Lv[LD+2]:Math.atan2(LF,LE),LL-=Math.atan2(LJ,LH)-LB/180*Math.PI,LC&&(LM=Math.cos(LL),LN=Math.sin(LL),Lz+=((Ls=Lr.length)*(LM*LH-LN*LJ)-LE)*Ld,LA+=(Ls*(LN*LH+LM*LJ)-LF)*Ld),LL>Math.PI?LL-=2*Math.PI:LL<-Math.PI&&(LL+=2*Math.PI),LL*=Ld,LM=Math.cos(LL),LN=Math.sin(LL),Lr.resultMatrix.a=LM*LH-LN*LJ,Lr.resultMatrix.c=LM*LI-LN*LK,Lr.resultMatrix.b=LN*LH+LM*LJ,Lr.resultMatrix.d=LN*LI+LM*LK}}}},La.computeWorldVertices2=function(La,Lb,Lc,Ld,Le,Lf){var Lg,Lh,Li=La.currDisplayData.bones,Lj=La.currDisplayData.weights,Lk=La.currDisplayData.triangles,Ll=0,Lm=0,Ln=0,Lo=0,Lp=0,Lq=0,Lr=0,Ls=0,Lt=0,Lu=0,Lv=0;if(null!=Li){for(Ll=0;Ll<Lc;Ll+=2)Lm+=(Lo=Li[Lm])+1,Ln+=Lo;var Ly=Lb;for(Lp=Lf,Lq=3*Ln;Lp<Ld;Lp+=2){for(Ls=Lr=0,Lo=Li[Lm++],Lo+=Lm;Lm<Lo;Lm++,Lq+=3){Lg=Ly[Li[Lm]].resultMatrix,Lt=Lj[Lq],Lu=Lj[Lq+1];var Lz=Lj[Lq+2];Lr+=(Lt*Lg.a+Lu*Lg.c+Lg.tx)*Lz,Ls+=(Lt*Lg.b+Lu*Lg.d+Lg.ty)*Lz}Le[Lp]=Lr,Le[Lp+1]=Ls}}else{var LA,LB;if(Lk||(Lk=Lj),La.deformData&&(Lk=La.deformData),LA=La.parent,Lb)for(Lv=Lb.length,Ll=0;Ll<Lv;Ll++)if(Lb[Ll].name==LA){Lh=Lb[Ll];break}Lh&&(LB=Lh.resultMatrix),LB||(LB=LI._tempMt);var LC=LB.tx,LD=LB.ty,LE=LB.a,LF=LB.b,LG=LB.c,LH=LB.d;for(Lh&&(LH*=Lh.d),Lm=Lc,Lp=Lf;Lp<Ld;Lm+=2,Lp+=2)Lt=Lk[Lm],Lu=Lk[Lm+1],Le[Lp]=Lt*LE+Lu*LF+LC,Le[Lp+1]=-(Lt*LG+Lu*LH+LD)}},La.computeWorldPositions=function(La,Lb,Lc,Ld,Le,Lf,Lg){La.currDisplayData.bones,La.currDisplayData.weights,La.currDisplayData.triangles;var Lh=[],Li=0,Lj=La.currDisplayData.verLen,Lk=this.position,Ll=this._spaces,Lm=[],Ln=[],Lo=Lj/6,Lp=-1,Lq=NaN,Lr=0,Ls=0,Lt=NaN,Lu=NaN,Lv=NaN,Ly=NaN;if(Lo--,Lj-=4,this.computeWorldVertices2(La,Lb,2,Lj,Lh,0),this._debugKey)for(Li=0;Li<Lh.length;)Lc.drawCircle(Lh[Li++],Lh[Li++],10,"#ff0000");Lm=Lh,this._curves.length=Lo;var Lz=this._curves,LA=Lm[Lq=0],LB=Lm[1],LC=0,LD=0,LE=0,LF=0,LG=0,LH=0,LI=NaN,LJ=NaN,LK=NaN,LL=NaN,LM=NaN,LN=NaN,LO=NaN,LP=NaN,LQ=0;for(Li=0,LQ=2;Li<Lo;Li++,LQ+=6)LC=Lm[LQ],LD=Lm[LQ+1],LE=Lm[LQ+2],LF=Lm[LQ+3],LM=2*(LI=.1875*(LA-2*LC+LE))+(LK=.09375*(3*(LC-LE)-LA+(LG=Lm[LQ+4]))),LN=2*(LJ=.1875*(LB-2*LD+LF))+(LL=.09375*(3*(LD-LF)-LB+(LH=Lm[LQ+5]))),LO=.75*(LC-LA)+LI+.16666667*LK,LP=.75*(LD-LB)+LJ+.16666667*LL,Lq+=Math.sqrt(LO*LO+LP*LP),LO+=LM,LP+=LN,LM+=LK,LN+=LL,Lq+=Math.sqrt(LO*LO+LP*LP),LO+=LM,LP+=LN,Lq+=Math.sqrt(LO*LO+LP*LP),LO+=LM+LK,LP+=LN+LL,Lq+=Math.sqrt(LO*LO+LP*LP),Lz[Li]=Lq,LA=LG,LB=LH;if(Lf&&(Lk*=Lq),Lg)for(Li=0;Li<Ld;Li++)Ll[Li]*=Lq;var LR=this._segments,LS=0,LT=0;for(LT=Ls=Lr=Li=0;Li<Ld;Li++,Lr+=3)if((Lt=Lk+=Lu=Ll[Li])<0)this.addBeforePosition(Lt,Lm,0,Ln,Lr);else if(Lq<Lt)this.addAfterPosition(Lt-Lq,Lm,Lj-4,Ln,Lr);else{for(;;Ls++)if(!((Ly=Lz[Ls])<Lt)){0==Ls?Lt/=Ly:Lt=(Lt-(Lv=Lz[Ls-1]))/(Ly-Lv);break}if(Ls!=Lp){var LU=6*(Lp=Ls);for(LA=Lm[LU],LB=Lm[LU+1],LC=Lm[LU+2],LD=Lm[LU+3],LE=Lm[LU+4],LF=Lm[LU+5],LM=2*(LI=.03*(LA-2*LC+LE))+(LK=.006*(3*(LC-LE)-LA+(LG=Lm[LU+6]))),LN=2*(LJ=.03*(LB-2*LD+LF))+(LL=.006*(3*(LD-LF)-LB+(LH=Lm[LU+7]))),LO=.3*(LC-LA)+LI+.16666667*LK,LP=.3*(LD-LB)+LJ+.16666667*LL,LS=Math.sqrt(LO*LO+LP*LP),LR[0]=LS,LU=1;LU<8;LU++)LO+=LM,LP+=LN,LM+=LK,LN+=LL,LS+=Math.sqrt(LO*LO+LP*LP),LR[LU]=LS;LO+=LM,LP+=LN,LS+=Math.sqrt(LO*LO+LP*LP),LR[8]=LS,LO+=LM+LK,LP+=LN+LL,LS+=Math.sqrt(LO*LO+LP*LP),LR[9]=LS,LT=0}for(Lt*=LS;;LT++)if(!((Ly=LR[LT])<Lt)){0==LT?Lt/=Ly:Lt=LT+(Lt-(Lv=LR[LT-1]))/(Ly-Lv);break}this.addCurvePosition(.1*Lt,LA,LB,LC,LD,LE,LF,LG,LH,Ln,Lr,Le||0<Li&&0==Lu)}return Ln},La.addBeforePosition=function(La,Lb,Lc,Ld,Le){var Lf=Lb[Lc],Lg=Lb[Lc+1],Lh=Lb[Lc+2]-Lf,Li=Lb[Lc+3]-Lg,Lj=Math.atan2(Li,Lh);Ld[Le]=Lf+La*Math.cos(Lj),Ld[Le+1]=Lg+La*Math.sin(Lj),Ld[Le+2]=Lj},La.addAfterPosition=function(La,Lb,Lc,Ld,Le){var Lf=Lb[Lc+2],Lg=Lb[Lc+3],Lh=Lf-Lb[Lc],Li=Lg-Lb[Lc+1],Lj=Math.atan2(Li,Lh);Ld[Le]=Lf+La*Math.cos(Lj),Ld[Le+1]=Lg+La*Math.sin(Lj),Ld[Le+2]=Lj},La.addCurvePosition=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll){0==La&&(La=1e-4);var Lm=La*La,Ln=Lm*La,Lo=1-La,Lp=Lo*Lo,Lq=Lp*Lo,Lr=Lo*La,Ls=3*Lr,Lt=Lo*Ls,Lu=Ls*La,Lv=Lb*Lq+Ld*Lt+Lf*Lu+Lh*Ln,Ly=Lc*Lq+Le*Lt+Lg*Lu+Li*Ln;Lj[Lk]=Lv,Lj[Lk+1]=Ly,Lj[Lk+2]=Ll?Math.atan2(Ly-(Lc*Lp+Le*Lr*2+Lg*Lm),Lv-(Lb*Lp+Ld*Lr*2+Lf*Lm)):0},LI.NONE=-1,LI.BEFORE=-2,LI.AFTER=-3,Lc(LI,["_tempMt",function(){return this._tempMt=new LGa}]),LI}(),LQa=function(){function La(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Ld(La,"laya.ani.bone.PathConstraintData"),La}(),LRa=function(){function La(){this.name=null,this.slotArr=[]}return Ld(La,"laya.ani.bone.SkinData"),La}(),LSa=function(){function La(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Ld(La,"laya.ani.bone.SkinSlotDisplayData");var Lb=La.prototype;return Lb.createTexture=function(La){return this.texture||(this.texture=new LHa(La.bitmap,this.uvs),La.bitmap.alphaTexture&&(this.texture.alphaTexture=new LHa(La.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=La.height,this.texture.height=La.width,this.texture.offsetX=-La.offsetX,this.texture.offsetY=-La.offsetY,this.texture.sourceWidth=La.sourceHeight,this.texture.sourceHeight=La.sourceWidth):(this.texture.width=La.width,this.texture.height=La.height,this.texture.offsetX=-La.offsetX,this.texture.offsetY=-La.offsetY,this.texture.sourceWidth=La.sourceWidth,this.texture.sourceHeight=La.sourceHeight),Lq.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Lb.destory=function(){this.texture&&this.texture.destroy()},La}(),LTa=function(){function La(){this.name=null,this.displayArr=[]}return Ld(La,"laya.ani.bone.SlotData"),La.prototype.getDisplayByName=function(La){for(var Lb=0,Lc=this.displayArr.length;Lb<Lc;Lb++)if(this.displayArr[Lb].attachmentName==La)return Lb;return-1},La}(),Ly=function(){function La(La,Lb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Lp(2,0),this._data=La,null==this._bones&&(this._bones=[]),this.target=Lb[La.targetIndex];var Lc,Ld=0;for(Ld=0,Lc=La.boneIndexs.length;Ld<Lc;Ld++)this._bones.push(Lb[La.boneIndexs[Ld]]);this.rotateMix=La.rotateMix,this.translateMix=La.translateMix,this.scaleMix=La.scaleMix,this.shearMix=La.shearMix}return Ld(La,"laya.ani.bone.TfConstraint"),La.prototype.apply=function(){for(var La,Lb=this.target.resultMatrix.a,Lc=this.target.resultMatrix.b,Ld=this.target.resultMatrix.c,Le=this.target.resultMatrix.d,Lf=0,Lg=this._bones.length;Lf<Lg;Lf++){if(La=this._bones[Lf],0<this.rotateMix){var Lh=La.resultMatrix.a,Li=La.resultMatrix.b,Lj=La.resultMatrix.c,Lk=La.resultMatrix.d,Ll=Math.atan2(Ld,Lb)-Math.atan2(Lj,Lh)+this._data.offsetRotation*Math.PI/180;Ll>Math.PI?Ll-=2*Math.PI:Ll<-Math.PI&&(Ll+=2*Math.PI),Ll*=this.rotateMix;var Lm=Math.cos(Ll),Ln=Math.sin(Ll);La.resultMatrix.a=Lm*Lh-Ln*Lj,La.resultMatrix.b=Lm*Li-Ln*Lk,La.resultMatrix.c=Ln*Lh+Lm*Lj,La.resultMatrix.d=Ln*Li+Lm*Lk}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),La.resultMatrix.tx+=(this._temp[0]-La.resultMatrix.tx)*this.translateMix,La.resultMatrix.ty+=(this._temp[1]-La.resultMatrix.ty)*this.translateMix,La.updateChild()),0<this.scaleMix){var Lo=Math.sqrt(La.resultMatrix.a*La.resultMatrix.a+La.resultMatrix.c*La.resultMatrix.c),Lp=Math.sqrt(Lb*Lb+Ld*Ld),Lq=1e-5<Lo?(Lo+(Lp-Lo+this._data.offsetScaleX)*this.scaleMix)/Lo:0;La.resultMatrix.a*=Lq,La.resultMatrix.c*=Lq,Lo=Math.sqrt(La.resultMatrix.b*La.resultMatrix.b+La.resultMatrix.d*La.resultMatrix.d),Lp=Math.sqrt(Lc*Lc+Le*Le),Lq=1e-5<Lo?(Lo+(Lp-Lo+this._data.offsetScaleY)*this.scaleMix)/Lo:0,La.resultMatrix.b*=Lq,La.resultMatrix.d*=Lq}if(0<this.shearMix){Li=La.resultMatrix.b,Lk=La.resultMatrix.d;var Lr=Math.atan2(Lk,Li);(Ll=Math.atan2(Le,Lc)-Math.atan2(Ld,Lb)-(Lr-Math.atan2(La.resultMatrix.c,La.resultMatrix.a)))>Math.PI?Ll-=2*Math.PI:Ll<-Math.PI&&(Ll+=2*Math.PI),Ll=Lr+(Ll+this._data.offsetShearY*Math.PI/180)*this.shearMix,Lq=Math.sqrt(Li*Li+Lk*Lk),La.resultMatrix.b=Math.cos(Ll)*Lq,La.resultMatrix.d=Math.sin(Ll)*Lq}}},La}(),LUa=function(){function La(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Ld(La,"laya.ani.bone.TfConstraintData"),La}(),LVa=function(){function La(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Ld(La,"laya.ani.bone.Transform");var Lb=La.prototype;return Lb.initData=function(La){null!=La.x&&(this.x=La.x),null!=La.y&&(this.y=La.y),null!=La.skX&&(this.skX=La.skX),null!=La.skY&&(this.skY=La.skY),null!=La.scX&&(this.scX=La.scX),null!=La.scY&&(this.scY=La.scY)},Lb.getMatrix=function(){var La;return(La=this.mMatrix?this.mMatrix:this.mMatrix=new LGa).identity(),La.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(La,this.skewX*Math.PI/180,this.skewY*Math.PI/180),La.rotate(this.skX*Math.PI/180),La.translate(this.x,this.y),La},Lb.skew=function(La,Lb,Lc){var Ld=Math.sin(Lc),Le=Math.cos(Lc),Lf=Math.sin(Lb),Lg=Math.cos(Lb);return La.setTo(La.a*Lg-La.b*Ld,La.a*Lf+La.b*Le,La.c*Lg-La.d*Ld,La.c*Lf+La.d*Le,La.tx*Lg-La.ty*Ld,La.tx*Lf+La.ty*Le),La},La}(),Lz=function(){function La(){}return Ld(La,"laya.ani.bone.UVTools"),La.getRelativeUV=function(La,Lb,Lc){var Ld=La[0],Le=La[2]-La[0],Lf=La[1],Lg=La[5]-La[1];Lc||(Lc=[]),Lc.length=Lb.length;var Lh,Li=0;Lh=Lc.length;var Lj=1/Le,Lk=1/Lg;for(Li=0;Li<Lh;Li+=2)Lc[Li]=(Lb[Li]-Ld)*Lj,Lc[Li+1]=(Lb[Li+1]-Lf)*Lk;return Lc},La.getAbsoluteUV=function(La,Lb,Lc){if(0==La[0]&&0==La[1]&&1==La[4]&&1==La[5])return Lc?(Lr.copyArray(Lc,Lb),Lc):Lb;var Ld=La[0],Le=La[2]-La[0],Lf=La[1],Lg=La[5]-La[1];Lc||(Lc=[]),Lc.length=Lb.length;var Lh,Li=0;for(Lh=Lc.length,Li=0;Li<Lh;Li+=2)Lc[Li]=Lb[Li]*Le+Ld,Lc[Li+1]=Lb[Li+1]*Lg+Lf;return Lc},La}(),LI=function(){function La(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Ld(La,"laya.ani.KeyFramesContent"),La}(),LA=function(){function Lk(){}return Ld(Lk,"laya.ani.math.BezierLerp"),Lk.getBezierRate=function(La,Lb,Lc,Ld,Le){var Lf=Lk._getBezierParamKey(Lb,Lc,Ld,Le),Lg=100*Lf+La;if(Lk._bezierResultCache[Lg])return Lk._bezierResultCache[Lg];var Lh,Li=Lk._getBezierPoints(Lb,Lc,Ld,Le,Lf),Lj=0;for(Lh=Li.length,Lj=0;Lj<Lh;Lj+=2)if(La<=Li[Lj])return Lk._bezierResultCache[Lg]=Li[Lj+1],Li[Lj+1];return Lk._bezierResultCache[Lg]=1},Lk._getBezierParamKey=function(La,Lb,Lc,Ld){return 100*(100*(100*(100*La+Lb)+Lc)+Ld)},Lk._getBezierPoints=function(La,Lb,Lc,Ld,Le){return Lk._bezierPointsCache[Le]?Lk._bezierPointsCache[Le]:(Lf=[0,0,La,Lb,Lc,Ld,1,1],Lg=(new Lh).getBezierPoints(Lf,100,3),Lk._bezierPointsCache[Le]=Lg);var Lf,Lg},Lk._bezierResultCache={},Lk._bezierPointsCache={},Lk}(),LB=function(La){function Lb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Lb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Ld(Lb,"laya.ani.AnimationPlayer",Le);var Lc=Lb.prototype;return Lea.imps(Lc,{"laya.resource.IDestroy":!0}),Lc._onTempletLoadedComputeFullKeyframeIndices=function(La,Lb,Lc){this._templet===Lc&&this._cachePlayRate===La&&this._cacheFrameRate===Lb&&this._computeFullKeyframeIndices()},Lc._computeFullKeyframeIndices=function(){for(var La=this._fullFrames=[],Lb=this._templet,Lc=this._cacheFrameRateInterval*this._cachePlayRate,Ld=0,Le=Lb.getAnimationCount();Ld<Le;Ld++){for(var Lf=[],Lg=0,Lh=Lb.getAnimation(Ld).nodes.length;Lg<Lh;Lg++){for(var Li=Lb.getAnimation(Ld).nodes[Lg],Lj=Math.floor(Li.playTime/Lc+.01),Lk=new Uint16Array(Lj+1),Ll=-1,Lm=0,Ln=Li.keyFrame.length;Lm<Ln;Lm++){var Lo=Li.keyFrame[Lm],Lp=Lo.startTime,Lq=Lp+Lo.duration+Lc;do{for(var Lr=Math.floor(Lp/Lc+.5),Ls=Ll+1;Ls<Lr;Ls++)Lk[Ls]=Lm;Lk[Ll=Lr]=Lm,Lp+=Lc}while(Lp<=Lq)}Lf.push(Lk)}La.push(Lf)}},Lc._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},Lc._calculatePlayDuration=function(){if(0!==this.state){var La=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=La),this._playEnd>La&&(this._playEnd=La),this._playDuration=this._playEnd-this._playStart}},Lc._setPlayParams=function(La,Lb){this._currentTime=La,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Lb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Lb},Lc._setPlayParamsWhenStop=function(La,Lb){this._currentTime=La,this._currentKeyframeIndex=Math.max(Math.floor(La/Lb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Lb,this._currentAnimationClipIndex=-1},Lc._update=function(La){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Lb=this._cacheFrameRateInterval*this._cachePlayRate,Lc=0;this._startUpdateLoopCount!==Lo.loopCount&&(Lc=La*this.playbackRate,this._elapsedPlaybackTime+=Lc);var Ld=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Ld)return this._setPlayParamsWhenStop(Ld,Lb),void this.event("stopped");if(Lc+=this._currentTime,0<Ld)if(Ld<=Lc)do{if(Lc-=Ld,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Ld,Lb),this._stopWhenCircleFinish=!1,void this.event("stopped");Lc<Ld&&(this._setPlayParams(Lc,Lb),this.event("complete"))}while(Ld<=Lc);else this._setPlayParams(Lc,Lb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Ld,Lb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},Lc._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},Lc.play=function(La,Lb,Lc,Ld,Le){if(void 0===La&&(La=0),void 0===Lb&&(Lb=1),void 0===Lc&&(Lc=2147483647),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(Lc<0||Ld<0||Le<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==Le&&Le<Ld)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Lb,this._overallDuration=Lc,this._playStart=Ld,this._playEnd=Le,this._paused=!1,this._currentAnimationClipIndex=La,this._currentKeyframeIndex=0,this._startUpdateLoopCount=Lo.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},Lc.playByFrame=function(La,Lb,Lc,Ld,Le,Lf){void 0===La&&(La=0),void 0===Lb&&(Lb=1),void 0===Lc&&(Lc=2147483647),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lf&&(Lf=30);var Lg=1e3/Lf;this.play(La,Lb,Lc,Ld*Lg,Le*Lg)},Lc.stop=function(La){void 0===La&&(La=!0),La?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Lf(0,Lc,"playEnd",function(){return this._playEnd}),Lf(0,Lc,"templet",function(){return this._templet},function(La){0===!this.state&&this.stop(!0),this._templet!==La&&((this._templet=La).loaded?this._computeFullKeyframeIndices():La.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Lf(0,Lc,"playStart",function(){return this._playStart}),Lf(0,Lc,"playDuration",function(){return this._playDuration}),Lf(0,Lc,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Lf(0,Lc,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Lf(0,Lc,"overallDuration",function(){return this._overallDuration}),Lf(0,Lc,"currentFrameTime",function(){return this._currentFrameTime}),Lf(0,Lc,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Lf(0,Lc,"currentPlayTime",function(){return this._currentTime+this._playStart}),Lf(0,Lc,"cachePlayRate",function(){return this._cachePlayRate},function(La){this._cachePlayRate!==La&&(this._cachePlayRate=La,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[La,this._cacheFrameRate])))}),Lf(0,Lc,"cacheFrameRate",function(){return this._cacheFrameRate},function(La){this._cacheFrameRate!==La&&(this._cacheFrameRate=La,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,La])))}),Lf(0,Lc,"currentTime",null,function(La){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(La<this._playStart||La>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=Lo.loopCount;var Lb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=La,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Lb),0),this._currentFrameTime=this._currentKeyframeIndex*Lb}}),Lf(0,Lc,"paused",function(){return this._paused},function(La){(this._paused=La)&&this.event("paused")}),Lf(0,Lc,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Lf(0,Lc,"destroyed",function(){return this._destroyed}),Lb}(),LJ=function(La){function Lb(){Lb.__super.call(this),Lq.isConchNode&&(this.drawSkin=function(La){La.transform||(La.transform=LGa.EMPTY),this._addCmd([La]),this.setSkinMesh&&this.setSkinMesh(La._ps,La.mVBData,La.mEleNum,0,La.mTexture,La.transform)})}return Ld(Lb,"laya.ani.GraphicsAni",Lg),Lb.prototype.drawSkin=function(La){var Lb=[La];this._saveToCmd(Lq._context._drawSkin,Lb)},Lb.create=function(){return Lb._caches.pop()||new Lb},Lb.recycle=function(La){La.clear(),Lb._caches.push(La)},Lb._caches=[],Lb}(),LK=function(La){function Ls(){this._aniMap={},this.unfixedLastAniIndex=-1,Ls.__super.call(this),this._anis=new Array}Ld(Ls,"laya.ani.AnimationTemplet",Lk);var Lb=Ls.prototype;return Lb.parse=function(La){var Lb=new LFa(La);this._aniVersion=Lb.readUTFString(),Lt.parse(this,Lb)},Lb._calculateKeyFrame=function(La,Lb,Lc){var Ld=La.keyFrame;Ld[Lb]=Ld[0];for(var Le=0;Le<Lb;Le++){var Lf=Ld[Le];Lf.nextData=0===Lf.duration?Lf.data:Ld[Le+1].data}Ld.length--},Lb.onAsynLoaded=function(La,Lb,Lc){var Ld=new LFa(Lb);switch(this._aniVersion=Ld.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":Lu.parse(this,Ld);break;default:Lt.parse(this,Ld)}this._endLoaded()},Lb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Lb.getAnimationCount=function(){return this._anis.length},Lb.getAnimation=function(La){return this._anis[La]},Lb.getAniDuration=function(La){return this._anis[La].playTime},Lb.getNodes=function(La){return this._anis[La].nodes},Lb.getNodeIndexWithName=function(La,Lb){return this._anis[La].bone3DMap[Lb]},Lb.getNodeCount=function(La){return this._anis[La].nodes.length},Lb.getTotalkeyframesLength=function(La){return this._anis[La].totalKeyframeDatasLength},Lb.getPublicExtData=function(){return this._publicExtData},Lb.getAnimationDataWithCache=function(La,Lb,Lc,Ld){var Le=Lb[Lc];if(Le){var Lf=Le[La];return Lf?Lf[Ld]:null}return null},Lb.setAnimationDataWithCache=function(La,Lb,Lc,Ld,Le){var Lf=Lb[Lc]||(Lb[Lc]={});(Lf[La]||(Lf[La]=[]))[Ld]=Le},Lb.getOriginalData=function(La,Lb,Lc,Ld,Le){for(var Lf=this._anis[La].nodes,Lg=0,Lh=0,Li=Lf.length,Lj=0;Lh<Li;Lh++){var Lk,Ll=Lf[Lh];Lk=Ll.keyFrame[Lc[Lh][Ld]],Ll.dataOffset=Lj;var Lm=Le-Lk.startTime,Ln=Ll.lerpType;if(Ln)switch(Ln){case 0:case 1:for(Lg=0;Lg<Ll.keyframeWidth;)Lg+=Ll.interpolationMethod[Lg](Ll,Lg,Lb,Lj+Lg,Lk.data,Lm,null,Lk.duration,Lk.nextData);break;case 2:var Lo=Lk.interpolationData,Lp=Lo.length,Lq=0;for(Lg=0;Lg<Lp;){var Lr=Lo[Lg];switch(Lr){case 6:case 7:Lg+=Ls.interpolation[Lr](Ll,Lq,Lb,Lj+Lq,Lk.data,Lm,null,Lk.duration,Lk.nextData,Lo,Lg+1);break;default:Lg+=Ls.interpolation[Lr](Ll,Lq,Lb,Lj+Lq,Lk.data,Lm,null,Lk.duration,Lk.nextData)}Lq++}}else for(Lg=0;Lg<Ll.keyframeWidth;)Lg+=Ll.interpolationMethod[Lg](Ll,Lg,Lb,Lj+Lg,Lk.data,Lm,null,Lk.duration,Lk.nextData);Lj+=Ll.keyframeWidth}},Lb.getNodesCurrentFrameIndex=function(La,Lb){var Lc=this._anis[La].nodes;La!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Lc.length),this.unfixedCurrentTimes=new Float32Array(Lc.length),this.unfixedLastAniIndex=La);for(var Ld=0,Le=Lc.length;Ld<Le;Ld++){var Lf=Lc[Ld];for(Lb<this.unfixedCurrentTimes[Ld]&&(this.unfixedCurrentFrameIndexes[Ld]=0),this.unfixedCurrentTimes[Ld]=Lb;this.unfixedCurrentFrameIndexes[Ld]<Lf.keyFrame.length&&!(Lf.keyFrame[this.unfixedCurrentFrameIndexes[Ld]].startTime>this.unfixedCurrentTimes[Ld]);)this.unfixedCurrentFrameIndexes[Ld]++;this.unfixedCurrentFrameIndexes[Ld]--}return this.unfixedCurrentFrameIndexes},Lb.getOriginalDataUnfixedRate=function(La,Lb,Lc){var Ld=this._anis[La].nodes;La!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Ld.length),this.unfixedCurrentTimes=new Float32Array(Ld.length),this.unfixedKeyframes=Lp(Ld.length),this.unfixedLastAniIndex=La);for(var Le=0,Lf=0,Lg=Ld.length,Lh=0;Lf<Lg;Lf++){var Li=Ld[Lf];for(Lc<this.unfixedCurrentTimes[Lf]&&(this.unfixedCurrentFrameIndexes[Lf]=0),this.unfixedCurrentTimes[Lf]=Lc;this.unfixedCurrentFrameIndexes[Lf]<Li.keyFrame.length&&!(Li.keyFrame[this.unfixedCurrentFrameIndexes[Lf]].startTime>this.unfixedCurrentTimes[Lf]);)this.unfixedKeyframes[Lf]=Li.keyFrame[this.unfixedCurrentFrameIndexes[Lf]],this.unfixedCurrentFrameIndexes[Lf]++;var Lj=this.unfixedKeyframes[Lf];Li.dataOffset=Lh;var Lk=Lc-Lj.startTime;if(Li.lerpType)switch(Li.lerpType){case 0:case 1:for(Le=0;Le<Li.keyframeWidth;)Le+=Li.interpolationMethod[Le](Li,Le,Lb,Lh+Le,Lj.data,Lk,null,Lj.duration,Lj.nextData);break;case 2:var Ll=Lj.interpolationData,Lm=Ll.length,Ln=0;for(Le=0;Le<Lm;){var Lo=Ll[Le];switch(Lo){case 6:case 7:Le+=Ls.interpolation[Lo](Li,Ln,Lb,Lh+Ln,Lj.data,Lk,null,Lj.duration,Lj.nextData,Ll,Le+1);break;default:Le+=Ls.interpolation[Lo](Li,Ln,Lb,Lh+Ln,Lj.data,Lk,null,Lj.duration,Lj.nextData)}Ln++}}else for(Le=0;Le<Li.keyframeWidth;)Le+=Li.interpolationMethod[Le](Li,Le,Lb,Lh+Le,Lj.data,Lk,null,Lj.duration,Lj.nextData);Lh+=Li.keyframeWidth}},Ls._LinearInterpolation_0=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){var Lk=0===Lh?0:Lf/Lh;return Lc[Ld]=(1-Lk)*Le[Lb]+Lk*Li[Lb],1},Ls._QuaternionInterpolation_1=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){var Lk=0===Lh?0:Lf/Lh;return Lm.slerpQuaternionArray(Le,Lb,Li,Lb,Lk,Lc,Ld),4},Ls._AngleInterpolation_2=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return 0},Ls._RadiansInterpolation_3=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return 0},Ls._Matrix4x4Interpolation_4=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){for(var Lk=0;Lk<16;Lk++,Lb++)Lc[Ld+Lk]=Le[Lb]+Lf*Lg[Lb];return 16},Ls._NoInterpolation_5=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){return Lc[Ld]=Le[Lb],1},Ls._BezierInterpolation_6=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk){return void 0===Lk&&(Lk=0),Lc[Ld]=Le[Lb]+(Li[Lb]-Le[Lb])*LA.getBezierRate(Lf/Lh,Lj[Lk],Lj[Lk+1],Lj[Lk+2],Lj[Lk+3]),5},Ls._BezierInterpolation_7=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk){return void 0===Lk&&(Lk=0),Lc[Ld]=Lj[Lk+4]+Lj[Lk+5]*LA.getBezierRate((.001*Lf+Lj[Lk+6])/Lj[Lk+7],Lj[Lk],Lj[Lk+1],Lj[Lk+2],Lj[Lk+3]),9},Ls.load=function(La){return Lea.loader.create(La,null,null,Ls)},Ls.interpolation=[Ls._LinearInterpolation_0,Ls._QuaternionInterpolation_1,Ls._AngleInterpolation_2,Ls._RadiansInterpolation_3,Ls._Matrix4x4Interpolation_4,Ls._NoInterpolation_5,Ls._BezierInterpolation_6,Ls._BezierInterpolation_7],Ls}(),LC=function(Lb){function Lc(La,Lb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,Lc.__super.call(this),void 0===Lb&&(Lb=0),La&&this.init(La,Lb)}Ld(Lc,"laya.ani.bone.Skeleton",Lb);var La=Lc.prototype;return La.init=function(La,Lb){void 0===Lb&&(Lb=0);var Lc,Ld,Le,Lf=0,Lg=0;if(1==Lb)for(this._graphicsCache=[],Lf=0,Lg=La.getAnimationCount();Lf<Lg;Lf++)this._graphicsCache.push([]);if(this._yReverseMatrix=La.yReverseMatrix,this._aniMode=Lb,this._templet=La,this._player=new LB,this._player.cacheFrameRate=La.rate,this._player.templet=La,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=La.mBoneArr,this._rootBone=La.mRootBone,this._aniSectionDic=La.aniSectionDic,0<La.ikArr.length)for(this._ikArr=[],Lf=0,Lg=La.ikArr.length;Lf<Lg;Lf++)this._ikArr.push(new Ls(La.ikArr[Lf],this._boneList));if(0<La.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Lf=0,Lg=La.pathArr.length;Lf<Lg;Lf++)Lc=La.pathArr[Lf],Ld=new Lv(Lc,this._boneList),(Le=this._boneSlotDic[Lc.name])&&((Ld=new Lv(Lc,this._boneList)).target=Le),this._pathDic[Lc.name]=Ld;if(0<La.tfArr.length)for(this._tfArr=[],Lf=0,Lg=La.tfArr.length;Lf<Lg;Lf++)this._tfArr.push(new Ly(La.tfArr[Lf],this._boneList));if(0<La.skinDataArray.length){var Lh=this._templet.skinDataArray[this._skinIndex];this._skinName=Lh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},La.load=function(La,Lb,Lc){},La._onLoaded=function(){},La._parseComplete=function(){var La=LD.TEMPLET_DICTIONARY[this._aniPath];La&&(this.init(La,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},La._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},La._onPlay=function(){this.event("played")},La._onStop=function(){var La,Lb=this._templet.eventAniArr[this._aniClipIndex];if(Lb&&this._eventIndex<Lb.length)for(;this._eventIndex<Lb.length;this._eventIndex++)(La=Lb[this._eventIndex]).time>=this._player.playStart&&La.time<=this._player.playEnd&&this.event("label",La);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},La._onPause=function(){this.event("paused")},La._parseSrcBoneMatrix=function(){var La=0,Lb=0;for(Lb=this._templet.srcBoneMatrixArr.length,La=0;La<Lb;La++)this._boneMatrixArray.push(new LGa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var Lc,Ld,Le=this._templet.boneSlotArray;for(La=0,Lb=Le.length;La<Lb;La++)Lc=Le[La],null==(Ld=this._bindBoneBoneSlotDic[Lc.parent])&&(this._bindBoneBoneSlotDic[Lc.parent]=Ld=[]),this._boneSlotDic[Lc.name]=Lc=Lc.copy(),Ld.push(Lc),this._boneSlotArray.push(Lc)}},La._emitMissedEvents=function(La,Lb,Lc){void 0===Lc&&(Lc=0);var Ld=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Ld){var Le,Lf,Lg=0;for(Le=Ld.length,Lg=Lc;Lg<Le;Lg++)(Lf=Ld[Lg]).time>=this._player.playStart&&Lf.time<=this._player.playEnd&&this.event("label",Lf)}},La._update=function(La){if(void 0===La&&(La=!0),!(this._pause||La&&this._indexControl)){var Lb=this.timer.currTimer,Lc=this._player.currentKeyframeIndex,Ld=Lb-this._lastTime;if(La?this._player._update(Ld):Lc=-1,this._lastTime=Lb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Ld&&this._clipIndex==Lc&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var Le;this._lastUpdateAniClipIndex=this._aniClipIndex,Lc>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Lf,Lg=this._templet.eventAniArr[this._aniClipIndex];if(Lg&&this._eventIndex<Lg.length&&((Le=Lg[this._eventIndex]).time>=this._player.playStart&&Le.time<=this._player.playEnd?this._player.currentPlayTime>=Le.time&&(this.event("label",Le),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Lf=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Lf&&(this.graphics=Lf));var Lh=0,Li=0;for(Li=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Li-1)&&0<Li;)Li--;if(Li<this._clipIndex)for(Lh=Li;Lh<this._clipIndex;Lh++)this._createGraphics(Lh)}else if(1==this._aniMode){if(Lf=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Lf&&(this.graphics=Lf));for(Li=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Li-1)&&0<Li;)Li--;if(Li<this._clipIndex)for(Lh=Li;Lh<this._clipIndex;Lh++)this._createGraphics(Lh)}this._createGraphics()}}},La._createGraphics=function(La){void 0===La&&(La=-1),-1==La&&(La=this._clipIndex);var Lb,Lc,Ld=La*this._player.cacheFrameRateInterval,Le=this._templet.drawOrderAniArr[this._aniClipIndex];if(Le&&0<Le.length)for(this._drawOrderIndex=0,Lb=Le[this._drawOrderIndex];Ld>=Lb.time&&(this._drawOrder=Lb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=Le.length));)Lb=Le[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=LJ.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=LJ.create(),Lc=this.graphics;var Lf=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],La,Ld);var Lg,Lh,Li,Lj,Lk=this._aniSectionDic[this._aniClipIndex],Ll=0,Lm=0,Ln=0,Lo=0,Lp=0,Lq=this._templet.srcBoneMatrixArr.length;for(Lp=Lk[Lm=0];Lm<Lq;Lm++)Lj=this._boneList[Lm],Li=this._templet.srcBoneMatrixArr[Lm],Lj.resultTransform.scX=Li.scX*this._curOriginalData[Ll++],Lj.resultTransform.skX=Li.skX+this._curOriginalData[Ll++],Lj.resultTransform.skY=Li.skY+this._curOriginalData[Ll++],Lj.resultTransform.scY=Li.scY*this._curOriginalData[Ll++],Lj.resultTransform.x=Li.x+this._curOriginalData[Ll++],Lj.resultTransform.y=Li.y+this._curOriginalData[Ll++],8===this._templet.tMatrixDataLen&&(Lj.resultTransform.skewX=Li.skewX+this._curOriginalData[Ll++],Lj.resultTransform.skewY=Li.skewY+this._curOriginalData[Ll++]);var Lr,Ls={},Lt={};for(Lp+=Lk[1];Lm<Lp;Lm++)Ls[(Lr=Lf[Lm]).name]=this._curOriginalData[Ll++],Lt[Lr.name]=this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++];var Lu,Lv,Ly={},Lz={};for(Lp+=Lk[2];Lm<Lp;Lm++)Ly[(Lr=Lf[Lm]).name]=this._curOriginalData[Ll++],Lz[Lr.name]=this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++],this._curOriginalData[Ll++];if(this._pathDic)for(Lp+=Lk[3];Lm<Lp;Lm++){if(Lr=Lf[Lm],Lu=this._pathDic[Lr.name])switch(new LFa(Lr.extenData).getByte()){case 1:Lu.position=this._curOriginalData[Ll++];break;case 2:Lu.spacing=this._curOriginalData[Ll++];break;case 3:Lu.rotateMix=this._curOriginalData[Ll++],Lu.translateMix=this._curOriginalData[Ll++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(LGa.TEMP.identity()),this._ikArr)for(Lm=0,Lp=this._ikArr.length;Lm<Lp;Lm++)Lv=this._ikArr[Lm],Ly.hasOwnProperty(Lv.name)&&(Lv.bendDirection=Ly[Lv.name]),Lz.hasOwnProperty(Lv.name)&&(Lv.mix=Lz[Lv.name]),Lv.apply();if(this._pathDic)for(var LA in this._pathDic)(Lu=this._pathDic[LA]).apply(this._boneList,Lc);if(this._tfArr)for(Lm=0,Lo=this._tfArr.length;Lm<Lo;Lm++)this._tfArr[Lm].apply();for(Lm=0,Lo=this._boneList.length;Lm<Lo;Lm++)if(Lj=this._boneList[Lm],Lh=this._bindBoneBoneSlotDic[Lj.name],Lj.resultMatrix.copyTo(this._boneMatrixArray[Lm]),Lh)for(Ln=0,Lp=Lh.length;Ln<Lp;Ln++)(Lg=Lh[Ln])&&Lg.setParentMatrix(Lj.resultMatrix);var LB,LC,LD,LE,LF={},LG=this._templet.deformAniArr;if(LG&&0<LG.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Lm=0,Lp=this._boneSlotArray.length;Lm<Lp;Lm++)(Lg=this._boneSlotArray[Lm]).deformData=null;var LH,LI=LG[this._aniClipIndex];for(LH in LB=LI.default,this._setDeform(LB,LF,this._boneSlotArray,Ld),LI)"default"!=LH&&LH!=this._skinName&&(LB=LI[LH],this._setDeform(LB,LF,this._boneSlotArray,Ld));LB=LI[this._skinName],this._setDeform(LB,LF,this._boneSlotArray,Ld)}if(this._drawOrder)for(Lm=0,Lp=this._drawOrder.length;Lm<Lp;Lm++)LC=Ls[(Lg=this._boneSlotArray[this._drawOrder[Lm]]).name],LD=Lt[Lg.name],isNaN(LD)||(Lc.save(),Lc.alpha(LD)),isNaN(LC)||-2==LC||(this._templet.attachmentNames?Lg.showDisplayByName(this._templet.attachmentNames[LC]):Lg.showDisplayByIndex(LC)),LF[this._drawOrder[Lm]]?(LE=LF[this._drawOrder[Lm]],Lg.currDisplayData&&LE[Lg.currDisplayData.attachmentName]?Lg.deformData=LE[Lg.currDisplayData.attachmentName]:Lg.deformData=null):Lg.deformData=null,isNaN(LD)?Lg.draw(Lc,this._boneMatrixArray,2==this._aniMode):Lg.draw(Lc,this._boneMatrixArray,2==this._aniMode,LD),isNaN(LD)||Lc.restore();else for(Lm=0,Lp=this._boneSlotArray.length;Lm<Lp;Lm++)LC=Ls[(Lg=this._boneSlotArray[Lm]).name],LD=Lt[Lg.name],isNaN(LD)||(Lc.save(),Lc.alpha(LD)),isNaN(LC)||-2==LC||(this._templet.attachmentNames?Lg.showDisplayByName(this._templet.attachmentNames[LC]):Lg.showDisplayByIndex(LC)),LF[Lm]?(LE=LF[Lm],Lg.currDisplayData&&LE[Lg.currDisplayData.attachmentName]?Lg.deformData=LE[Lg.currDisplayData.attachmentName]:Lg.deformData=null):Lg.deformData=null,isNaN(LD)?Lg.draw(Lc,this._boneMatrixArray,2==this._aniMode):Lg.draw(Lc,this._boneMatrixArray,2==this._aniMode,LD),isNaN(LD)||Lc.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,La,Lc):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,La,Lc)},La._setDeform=function(La,Lb,Lc,Ld){if(La){var Le,Lf,Lg,Lh=0,Li=0,Lj=0;if(La)for(Lh=0,Li=La.deformSlotDataList.length;Lh<Li;Lh++)for(Le=La.deformSlotDataList[Lh],Lj=0;Lj<Le.deformSlotDisplayList.length;Lj++)Lg=Lc[(Lf=Le.deformSlotDisplayList[Lj]).slotIndex],Lf.apply(Ld,Lg),Lb[Lf.slotIndex]||(Lb[Lf.slotIndex]={}),Lb[Lf.slotIndex][Lf.attachment]=Lf.deformData}},La.getAnimNum=function(){return this._templet.getAnimationCount()},La.getAniNameByIndex=function(La){return this._templet.getAniNameByIndex(La)},La.getSlotByName=function(La){return this._boneSlotDic[La]},La.showSkinByName=function(La,Lb){void 0===Lb&&(Lb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(La),Lb)},La.showSkinByIndex=function(La,Lb){void 0===Lb&&(Lb=!0);for(var Lc=0;Lc<this._boneSlotArray.length;Lc++)this._boneSlotArray[Lc].showSlotData(null,Lb);if(this._templet.showSkinByIndex(this._boneSlotDic,La,Lb)){var Ld=this._templet.skinDataArray[La];this._skinIndex=La,this._skinName=Ld.name}this._clearCache()},La.showSlotSkinByIndex=function(La,Lb){if(0!=this._aniMode){var Lc=this.getSlotByName(La);Lc&&Lc.showDisplayByIndex(Lb),this._clearCache()}},La.showSlotSkinByName=function(La,Lb){if(0!=this._aniMode){var Lc=this.getSlotByName(La);Lc&&Lc.showDisplayByName(Lb),this._clearCache()}},La.replaceSlotSkinName=function(La,Lb,Lc){if(0!=this._aniMode){var Ld=this.getSlotByName(La);Ld&&Ld.replaceDisplayByName(Lb,Lc),this._clearCache()}},La.replaceSlotSkinByIndex=function(La,Lb,Lc){if(0!=this._aniMode){var Ld=this.getSlotByName(La);Ld&&Ld.replaceDisplayByIndex(Lb,Lc),this._clearCache()}},La.setSlotSkin=function(La,Lb){if(0!=this._aniMode){var Lc=this.getSlotByName(La);Lc&&Lc.replaceSkin(Lb),this._clearCache()}},La._clearCache=function(){if(1==this._aniMode)for(var La=0,Lb=this._graphicsCache.length;La<Lb;La++){for(var Lc=0,Ld=this._graphicsCache[La].length;Lc<Ld;Lc++){var Le=this._graphicsCache[La][Lc];Le!=this.graphics&&LJ.recycle(Le)}this._graphicsCache[La].length=0}},La.play=function(La,Lb,Lc,Ld,Le,Lf){void 0===Lc&&(Lc=!0),void 0===Ld&&(Ld=0),void 0===Le&&(Le=0),void 0===Lf&&(Lf=!0),this._indexControl=!1;var Lg=-1,Lh=NaN;if(Lh=Lb?2147483647:0,"string"==typeof La)for(var Li=0,Lj=this._templet.getAnimationCount();Li<Lj;Li++){var Lk=this._templet.getAnimation(Li);if(Lk&&La==Lk.name){Lg=Li;break}}else Lg=La;-1<Lg&&Lg<this.getAnimNum()&&(this._aniClipIndex=Lg,(Lc||this._pause||this._currAniIndex!=Lg)&&(this._currAniIndex=Lg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(Lg)),this._drawOrder=null,this._eventIndex=0,this._player.play(Lg,this._player.playbackRate,Lh,Ld,Le),Lf&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=Ll.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},La.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},La.playbackRate=function(La){this._player&&(this._player.playbackRate=La)},La.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},La.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=Ll.now(),this.timer.frameLoop(1,this,this._update,null,!0))},La._getGrahicsDataWithCache=function(La,Lb){return this._graphicsCache[La][Lb]},La._setGrahicsDataWithCache=function(La,Lb,Lc){this._graphicsCache[La][Lb]=Lc},La.destroy=function(La){void 0===La&&(La=!0),Lb.prototype.destroy.call(this,La),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Lf(0,La,"url",function(){return this._aniPath},function(La){this.load(La)}),Lf(0,La,"index",function(){return this._index},function(La){this.player&&(this._index=La,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Lf(0,La,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Lf(0,La,"templet",function(){return this._templet}),Lf(0,La,"player",function(){return this._player}),Lc.useSimpleMeshInCanvas=!1,Lc}(Lfa),LD=function(Lb){function Le(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,Le.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Ld(Le,"laya.ani.bone.Templet",Lb);var La=Le.prototype;return La.getLoadList=function(){return this._loadList},La.loadAni=function(La){this._skBufferUrl=La,Lea.loader.load(La,Li.create(this,this.onComplete),null,"arraybuffer")},La.onComplete=function(La){if(this._isDestroyed)this.destroy();else{var Lb=Lj.getRes(this._skBufferUrl);Lb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Lb)):this.event("error","load failed:"+this._skBufferUrl)}},La.parseData=function(La,Lb,Lc){void 0===Lc&&(Lc=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=La,this._mainTexture&&Lq.isWebGL&&La.bitmap&&(La.bitmap.enableMerageInAtlas=!1),this._rate=Lc,this.parse(Lb)},La.buildArmature=function(La){return void 0===La&&(La=0),new LC(this,La)},La.parse=function(La){Lb.prototype.parse.call(this,La),this._endLoaded(),this._aniVersion!=Le.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+Le.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},La._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var La=0;this._loadList=[];var Lb,Lc=new LFa(this.getPublicExtData()),Ld=0,Le=0,Lf=0,Lg=Lc.getInt32(),Lh=Lc.readUTFString(),Li=Lh.split("\n");for(La=0;La<Lg;La++)Lb=this._path+Li[2*La],Lh=Li[2*La+1],Lc.getFloat32(),Lc.getFloat32(),Ld=Lc.getFloat32(),Le=Lc.getFloat32(),Lf=Lc.getFloat32(),isNaN(Lf)?0:Lf,Lf=Lc.getFloat32(),isNaN(Lf)?0:Lf,Lf=Lc.getFloat32(),isNaN(Lf)?Ld:Lf,Lf=Lc.getFloat32(),isNaN(Lf)?Le:Lf,-1==this._loadList.indexOf(Lb)&&this._loadList.push(Lb);this.event("inited",this)}},La._textureComplete=function(){for(var La,Lb,Lc=0,Ld=this._loadList.length;Lc<Ld;Lc++)Lb=this._loadList[Lc],La=this._textureDic[Lb]=Lj.getRes(Lb),Lq.isWebGL&&La&&La.bitmap&&(La.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},La._parsePublicExtData=function(){var La=0,Lb=0,Lc=0,Ld=0,Le=0;for(La=0,Le=this.getAnimationCount();La<Le;La++)this._graphicsCache.push([]);var Lf;Lf="Dragon"!=this._aniClassName;var Lg,Lh,Li=new LFa(this.getPublicExtData()),Lj=0,Lk=0,Ll=0,Lm=0,Ln=0,Lo=0,Lp=0,Lq=0,Lr=0,Ls=Li.getInt32(),Lt=Li.readUTFString(),Lu=Lt.split("\n");for(La=0;La<Ls;La++){if(Lg=this._mainTexture,Lh=this._path+Lu[2*La],Lt=Lu[2*La+1],null==this._mainTexture&&(Lg=this._textureDic[Lh]),!Lg)return this.event("error",this),void(this.isParseFail=!0);Lj=Li.getFloat32(),Lk=Li.getFloat32(),Ll=Li.getFloat32(),Lm=Li.getFloat32(),Lr=Li.getFloat32(),Ln=isNaN(Lr)?0:Lr,Lr=Li.getFloat32(),Lo=isNaN(Lr)?0:Lr,Lr=Li.getFloat32(),Lp=isNaN(Lr)?Ll:Lr,Lr=Li.getFloat32(),Lq=isNaN(Lr)?Lm:Lr,this.subTextureDic[Lt]=LHa.create(Lg,Lj,Lk,Ll,Lm,-Ln,-Lo,Lp,Lq),Lg.alphaTexture&&(this.subTextureDic[Lt].alphaTexture=LHa.create(Lg.alphaTexture,Lj,Lk,Ll,Lm,-Ln,-Lo,Lp,Lq))}this._mainTexture=Lg;var Lv,Ly,Lz,LA,LB,LC=Li.getUint16();for(La=0;La<LC;La++)(Lv=[]).push(Li.getUint16()),Lv.push(Li.getUint16()),Lv.push(Li.getUint16()),Lv.push(Li.getUint16()),this.aniSectionDic[La]=Lv;var LD,LE=Li.getInt16(),LF={};for(La=0;La<LE;La++)Ly=new LIa,0==La?LD=Ly:Ly.root=LD,Ly.d=Lf?-1:1,LA=Li.readUTFString(),LB=Li.readUTFString(),Ly.length=Li.getFloat32(),1==Li.getByte()&&(Ly.inheritRotation=!1),1==Li.getByte()&&(Ly.inheritScale=!1),Ly.name=LA,LB&&((Lz=LF[LB])?Lz.addChild(Ly):this.mRootBone=Ly),LF[LA]=Ly,this.mBoneArr.push(Ly);this.tMatrixDataLen=Li.getUint16();var LG,LH,LI=Li.getUint16(),LJ=Math.floor(LI/this.tMatrixDataLen),LK=this.srcBoneMatrixArr;for(La=0;La<LJ;La++)(LG=new LVa).scX=Li.getFloat32(),LG.skX=Li.getFloat32(),LG.skY=Li.getFloat32(),LG.scY=Li.getFloat32(),LG.x=Li.getFloat32(),LG.y=Li.getFloat32(),8===this.tMatrixDataLen&&(LG.skewX=Li.getFloat32(),LG.skewY=Li.getFloat32()),LK.push(LG),(Ly=this.mBoneArr[La]).transform=LG;var LL,LM=Li.getUint16(),LN=0;for(La=0;La<LM;La++){for(LH=new LPa,LN=Li.getUint16(),Lb=0;Lb<LN;Lb++)LH.boneNames.push(Li.readUTFString()),LH.boneIndexs.push(Li.getInt16());LH.name=Li.readUTFString(),LH.targetBoneName=Li.readUTFString(),LH.targetBoneIndex=Li.getInt16(),LH.bendDirection=Li.getFloat32(),LH.mix=Li.getFloat32(),LH.isSpine=Lf,this.ikArr.push(LH)}var LO,LP=Li.getUint16(),LQ=0;for(La=0;La<LP;La++){for(LL=new LUa,LQ=Li.getUint16(),Lb=0;Lb<LQ;Lb++)LL.boneIndexs.push(Li.getInt16());LL.name=Li.getUTFString(),LL.targetIndex=Li.getInt16(),LL.rotateMix=Li.getFloat32(),LL.translateMix=Li.getFloat32(),LL.scaleMix=Li.getFloat32(),LL.shearMix=Li.getFloat32(),LL.offsetRotation=Li.getFloat32(),LL.offsetX=Li.getFloat32(),LL.offsetY=Li.getFloat32(),LL.offsetScaleX=Li.getFloat32(),LL.offsetScaleY=Li.getFloat32(),LL.offsetShearY=Li.getFloat32(),this.tfArr.push(LL)}var LR=Li.getUint16(),LS=0;for(La=0;La<LR;La++){for((LO=new LQa).name=Li.readUTFString(),LS=Li.getUint16(),Lb=0;Lb<LS;Lb++)LO.bones.push(Li.getInt16());LO.target=Li.readUTFString(),LO.positionMode=Li.readUTFString(),LO.spacingMode=Li.readUTFString(),LO.rotateMode=Li.readUTFString(),LO.offsetRotation=Li.getFloat32(),LO.position=Li.getFloat32(),LO.spacing=Li.getFloat32(),LO.rotateMix=Li.getFloat32(),LO.translateMix=Li.getFloat32(),this.pathArr.push(LO)}var LT,LU,LV,LW,LX,LY=0,LZ=0,L$=0,L_=NaN,Lw=0,Lx=Li.getInt16();for(La=0;La<Lx;La++){var Laa=Li.getUint8(),Lba={};this.deformAniArr.push(Lba);for(var Lca=0;Lca<Laa;Lca++)for((LT=new LKa).skinName=Li.getUTFString(),Lba[LT.skinName]=LT,LY=Li.getInt16(),Lb=0;Lb<LY;Lb++)for(LU=new LLa,LT.deformSlotDataList.push(LU),LZ=Li.getInt16(),Lc=0;Lc<LZ;Lc++)for(LV=new LMa,LU.deformSlotDisplayList.push(LV),LV.slotIndex=Li.getInt16(),LV.attachment=Li.getUTFString(),L$=Li.getInt16(),Ld=0;Ld<L$;Ld++)for(1==Li.getByte()?LV.tweenKeyList.push(!0):LV.tweenKeyList.push(!1),L_=Li.getFloat32(),LV.timeList.push(L_),LW=[],LV.vectices.push(LW),Lw=Li.getInt16(),Le=0;Le<Lw;Le++)LW.push(Li.getFloat32())}var Lda,Lea,Lfa=Li.getInt16(),Lga=0,Lha=0;for(La=0;La<Lfa;La++){for(Lga=Li.getInt16(),LX=[],Lb=0;Lb<Lga;Lb++){for((Lda=new LNa).time=Li.getFloat32(),Lha=Li.getInt16(),Lc=0;Lc<Lha;Lc++)Lda.drawOrder.push(Li.getInt16());LX.push(Lda)}this.drawOrderAniArr.push(LX)}var Lia,Lja=Li.getInt16(),Lka=0;for(La=0;La<Lja;La++){for(Lka=Li.getInt16(),Lea=[],Lb=0;Lb<Lka;Lb++)(Lia=new LOa).name=Li.getUTFString(),Lia.intValue=Li.getInt32(),Lia.floatValue=Li.getFloat32(),Lia.stringValue=Li.getUTFString(),Lia.time=Li.getFloat32(),Lea.push(Lia);this.eventAniArr.push(Lea)}var Lla=Li.getInt16();if(0<Lla)for(this.attachmentNames=[],La=0;La<Lla;La++)this.attachmentNames.push(Li.getUTFString());var Lma,Lna,Loa=Li.getInt16();for(La=0;La<Loa;La++)(Lma=new LJa).name=Li.readUTFString(),Lma.parent=Li.readUTFString(),Lma.attachmentName=Li.readUTFString(),Lma.srcDisplayIndex=Lma.displayIndex=Li.getInt16(),(Lma.templet=this).boneSlotDic[Lma.name]=Lma,null==(Lna=this.bindBoneBoneSlotDic[Lma.parent])&&(this.bindBoneBoneSlotDic[Lma.parent]=Lna=[]),Lna.push(Lma),this.boneSlotArray.push(Lma);var Lpa,Lqa,Lra,Lsa=Li.readUTFString().split("\n"),Lta=0,Lua=Li.getUint8(),Lva=0,Lya=0,Lza=0,LAa=0,LBa=0,LCa=0,LDa=0;for(La=0;La<Lua;La++){for((Lpa=new LRa).name=Lsa[Lta++],Lva=Li.getUint8(),Lb=0;Lb<Lva;Lb++){for((Lqa=new LTa).name=Lsa[Lta++],Lma=this.boneSlotDic[Lqa.name],Lya=Li.getUint8(),Lc=0;Lc<Lya;Lc++){if(Lra=new LSa,this.skinSlotDisplayDataArr.push(Lra),Lra.name=Lsa[Lta++],Lra.attachmentName=Lsa[Lta++],Lra.transform=new LVa,Lra.transform.scX=Li.getFloat32(),Lra.transform.skX=Li.getFloat32(),Lra.transform.skY=Li.getFloat32(),Lra.transform.scY=Li.getFloat32(),Lra.transform.x=Li.getFloat32(),Lra.transform.y=Li.getFloat32(),Lqa.displayArr.push(Lra),Lra.width=Li.getFloat32(),Lra.height=Li.getFloat32(),Lra.type=Li.getUint8(),Lra.verLen=Li.getUint16(),0<(LE=Li.getUint16()))for(Lra.bones=[],Ld=0;Ld<LE;Ld++){var LEa=Li.getUint16();Lra.bones.push(LEa)}if(0<(Lza=Li.getUint16()))for(Lra.uvs=[],Ld=0;Ld<Lza;Ld++)Lra.uvs.push(Li.getFloat32());if(0<(LAa=Li.getUint16()))for(Lra.weights=[],Ld=0;Ld<LAa;Ld++)Lra.weights.push(Li.getFloat32());if(0<(LBa=Li.getUint16()))for(Lra.triangles=[],Ld=0;Ld<LBa;Ld++)Lra.triangles.push(Li.getUint16());if(0<(LCa=Li.getUint16()))for(Lra.vertices=[],Ld=0;Ld<LCa;Ld++)Lra.vertices.push(Li.getFloat32());if(0<(LDa=Li.getUint16()))for(Lra.lengths=[],Ld=0;Ld<LDa;Ld++)Lra.lengths.push(Li.getFloat32())}Lpa.slotArr.push(Lqa)}this.skinDic[Lpa.name]=Lpa,this.skinDataArray.push(Lpa)}1==Li.getUint8()?(this.yReverseMatrix=new LGa(1,0,0,-1,0,0),LD&&LD.setTempMatrix(this.yReverseMatrix)):LD&&LD.setTempMatrix(new LGa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},La.getTexture=function(La){var Lb=this.subTextureDic[La];return Lb||(Lb=this.subTextureDic[La.substr(0,La.length-1)]),null==Lb?this._mainTexture:Lb},La.showSkinByIndex=function(La,Lb,Lc){if(void 0===Lc&&(Lc=!0),Lb<0&&Lb>=this.skinDataArray.length)return!1;var Ld,Le,Lf=0,Lg=0,Lh=this.skinDataArray[Lb];if(Lh){for(Lf=0,Lg=Lh.slotArr.length;Lf<Lg;Lf++)(Le=Lh.slotArr[Lf])&&(Ld=La[Le.name])&&(Ld.showSlotData(Le,Lc),Lc&&"undefined"!=Ld.attachmentName&&"null"!=Ld.attachmentName?Ld.showDisplayByName(Ld.attachmentName):Ld.showDisplayByIndex(Ld.displayIndex));return!0}return!1},La.getSkinIndexByName=function(La){for(var Lb=0,Lc=this.skinDataArray.length;Lb<Lc;Lb++)if(this.skinDataArray[Lb].name==La)return Lb;return-1},La.getGrahicsDataWithCache=function(La,Lb){return this._graphicsCache[La][Lb]},La.setGrahicsDataWithCache=function(La,Lb,Lc){this._graphicsCache[La][Lb]=Lc},La.destroy=function(){var La;for(var Lb in this._isDestroyed=!0,this.subTextureDic)(La=this.subTextureDic[Lb])&&La.destroy();for(Lb in this._textureDic)(La=this._textureDic[Lb])&&La.destroy();for(var Lc=0,Ld=this.skinSlotDisplayDataArr.length;Lc<Ld;Lc++)this.skinSlotDisplayDataArr[Lc].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete Le.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},La.getAniNameByIndex=function(La){var Lb=this.getAnimation(La);return Lb?Lb.name:null},Lf(0,La,"rate",function(){return this._rate},function(La){this._rate=La}),Le.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",Le.TEMPLET_DICTIONARY=null,Le}(LK)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(La,Lb){"use strict";for(var Lc in Object.defineProperty(Lb,"__esModule",{value:!0}),Laya){var Ld=Laya[Lc];Ld&&Ld.__isclass&&(Lb[Lc]=Ld)}}),function(La,Lb){"object"==typeof exports&&"object"==typeof module?window?window.Matter=Lb():module.exports=Lb():"function"==typeof define&&define.amd?define("Matter",[],Lb):"object"==typeof exports?exports.Matter=Lb():La.Matter=Lb()}(this,function(){return function(Lc){var Ld={};function Le(La){if(Ld[La])return Ld[La].exports;var Lb=Ld[La]={i:La,l:!1,exports:{}};return Lc[La].call(Lb.exports,Lb,Lb.exports,Le),Lb.l=!0,Lb.exports}return Le.m=Lc,Le.c=Ld,Le.d=function(La,Lb,Lc){Le.o(La,Lb)||Object.defineProperty(La,Lb,{enumerable:!0,get:Lc})},Le.r=function(La){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(La,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(La,"__esModule",{value:!0})},Le.t=function(Lb,La){if(1&La&&(Lb=Le(Lb)),8&La)return Lb;if(4&La&&"object"==typeof Lb&&Lb&&Lb.__esModule)return Lb;var Lc=Object.create(null);if(Le.r(Lc),Object.defineProperty(Lc,"default",{enumerable:!0,value:Lb}),2&La&&"string"!=typeof Lb)for(var Ld in Lb)Le.d(Lc,Ld,function(La){return Lb[La]}.bind(null,Ld));return Lc},Le.n=function(La){var Lb=La&&La.__esModule?function(){return La.default}:function(){return La};return Le.d(Lb,"a",Lb),Lb},Le.o=function(La,Lb){return Object.prototype.hasOwnProperty.call(La,Lb)},Le.p="",Le(Le.s=21)}([function(La,Lb){var Li={};La.exports=Li,function(){Li._nextId=0,Li._seed=0,Li._nowStartTime=+new Date,Li._warnedOnce={},Li._decomp=null,Li.extend=function(La,Lb){var Lc,Ld;Ld="boolean"==typeof Lb?(Lc=2,Lb):(Lc=1,!0);for(var Le=Lc;Le<arguments.length;Le++){var Lf=arguments[Le];if(Lf)for(var Lg in Lf)Ld&&Lf[Lg]&&Lf[Lg].constructor===Object?La[Lg]&&La[Lg].constructor!==Object?La[Lg]=Lf[Lg]:(La[Lg]=La[Lg]||{},Li.extend(La[Lg],Ld,Lf[Lg])):La[Lg]=Lf[Lg]}return La},Li.clone=function(La,Lb){return Li.extend({},Lb,La)},Li.keys=function(La){if(Object.keys)return Object.keys(La);var Lb=[];for(var Lc in La)Lb.push(Lc);return Lb},Li.values=function(La){var Lb=[];if(Object.keys){for(var Lc=Object.keys(La),Ld=0;Ld<Lc.length;Ld++)Lb.push(La[Lc[Ld]]);return Lb}for(var Le in La)Lb.push(La[Le]);return Lb},Li.get=function(La,Lb,Lc,Ld){Lb=Lb.split(".").slice(Lc,Ld);for(var Le=0;Le<Lb.length;Le+=1)La=La[Lb[Le]];return La},Li.set=function(La,Lb,Lc,Ld,Le){var Lf=Lb.split(".").slice(Ld,Le);return Li.get(La,Lb,0,-1)[Lf[Lf.length-1]]=Lc},Li.shuffle=function(La){for(var Lb=La.length-1;0<Lb;Lb--){var Lc=Math.floor(Li.random()*(Lb+1)),Ld=La[Lb];La[Lb]=La[Lc],La[Lc]=Ld}return La},Li.choose=function(La){return La[Math.floor(Li.random()*La.length)]},Li.isElement=function(La){return"undefined"!=typeof HTMLElement?La instanceof HTMLElement:!!(La&&La.nodeType&&La.nodeName)},Li.isArray=function(La){return"[object Array]"===Object.prototype.toString.call(La)},Li.isFunction=function(La){return"function"==typeof La},Li.isPlainObject=function(La){return"object"==typeof La&&La.constructor===Object},Li.isString=function(La){return"[object String]"===toString.call(La)},Li.clamp=function(La,Lb,Lc){return La<Lb?Lb:Lc<La?Lc:La},Li.sign=function(La){return La<0?-1:1},Li.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-Li._nowStartTime},Li.random=function(La,Lb){return Lb=void 0!==Lb?Lb:1,(La=void 0!==La?La:0)+Lc()*(Lb-La)};var Lc=function(){return Li._seed=(9301*Li._seed+49297)%233280,Li._seed/233280};Li.colorToNumber=function(La){return 3==(La=La.replace("#","")).length&&(La=La.charAt(0)+La.charAt(0)+La.charAt(1)+La.charAt(1)+La.charAt(2)+La.charAt(2)),parseInt(La,16)},Li.logLevel=1,Li.log=function(){console&&0<Li.logLevel&&Li.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Li.info=function(){console&&0<Li.logLevel&&Li.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Li.warn=function(){console&&0<Li.logLevel&&Li.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},Li.warnOnce=function(){var La=Array.prototype.slice.call(arguments).join(" ");Li._warnedOnce[La]||(Li.warn(La),Li._warnedOnce[La]=!0)},Li.deprecated=function(La,Lb,Lc){La[Lb]=Li.chain(function(){Li.warnOnce("🔅 deprecated 🔅",Lc)},La[Lb])},Li.nextId=function(){return Li._nextId++},Li.indexOf=function(La,Lb){if(La.indexOf)return La.indexOf(Lb);for(var Lc=0;Lc<La.length;Lc++)if(La[Lc]===Lb)return Lc;return-1},Li.map=function(La,Lb){if(La.map)return La.map(Lb);for(var Lc=[],Ld=0;Ld<La.length;Ld+=1)Lc.push(Lb(La[Ld]));return Lc},Li.topologicalSort=function(La){var Lb=[],Lc=[],Ld=[];for(var Le in La)Lc[Le]||Ld[Le]||Li._topologicalSort(Le,Lc,Ld,La,Lb);return Lb},Li._topologicalSort=function(La,Lb,Lc,Ld,Le){var Lf=Ld[La]||[];Lc[La]=!0;for(var Lg=0;Lg<Lf.length;Lg+=1){var Lh=Lf[Lg];Lc[Lh]||(Lb[Lh]||Li._topologicalSort(Lh,Lb,Lc,Ld,Le))}Lc[La]=!1,Lb[La]=!0,Le.push(La)},Li.chain=function(){for(var Lf=[],La=0;La<arguments.length;La+=1){var Lb=arguments[La];Lb._chained?Lf.push.apply(Lf,Lb._chained):Lf.push(Lb)}function Lc(){for(var La,Lb=new Array(arguments.length),Lc=0,Ld=arguments.length;Lc<Ld;Lc++)Lb[Lc]=arguments[Lc];for(Lc=0;Lc<Lf.length;Lc+=1){var Le=Lf[Lc].apply(La,Lb);void 0!==Le&&(La=Le)}return La}return Lc._chained=Lf,Lc},Li.chainPathBefore=function(La,Lb,Lc){return Li.set(La,Lb,Li.chain(Lc,Li.get(La,Lb)))},Li.chainPathAfter=function(La,Lb,Lc){return Li.set(La,Lb,Li.chain(Li.get(La,Lb),Lc))},Li.setDecomp=function(La){Li._decomp=La},Li.getDecomp=function(){var Lb=Li._decomp;try{Lb||"undefined"==typeof window||(Lb=window.decomp),Lb||"undefined"==typeof global||(Lb=global.decomp)}catch(La){Lb=null}return Lb}}()},function(La,Lb){var Lc={};(La.exports=Lc).create=function(La){var Lb={min:{x:0,y:0},max:{x:0,y:0}};return La&&Lc.update(Lb,La),Lb},Lc.update=function(La,Lb,Lc){La.min.x=1/0,La.max.x=-1/0,La.min.y=1/0,La.max.y=-1/0;for(var Ld=0;Ld<Lb.length;Ld++){var Le=Lb[Ld];Le.x>La.max.x&&(La.max.x=Le.x),Le.x<La.min.x&&(La.min.x=Le.x),Le.y>La.max.y&&(La.max.y=Le.y),Le.y<La.min.y&&(La.min.y=Le.y)}Lc&&(0<Lc.x?La.max.x+=Lc.x:La.min.x+=Lc.x,0<Lc.y?La.max.y+=Lc.y:La.min.y+=Lc.y)},Lc.contains=function(La,Lb){return Lb.x>=La.min.x&&Lb.x<=La.max.x&&Lb.y>=La.min.y&&Lb.y<=La.max.y},Lc.overlaps=function(La,Lb){return La.min.x<=Lb.max.x&&La.max.x>=Lb.min.x&&La.max.y>=Lb.min.y&&La.min.y<=Lb.max.y},Lc.translate=function(La,Lb){La.min.x+=Lb.x,La.max.x+=Lb.x,La.min.y+=Lb.y,La.max.y+=Lb.y},Lc.shift=function(La,Lb){var Lc=La.max.x-La.min.x,Ld=La.max.y-La.min.y;La.min.x=Lb.x,La.max.x=Lb.x+Lc,La.min.y=Lb.y,La.max.y=Lb.y+Ld}},function(La,Lb){var Lc={};(La.exports=Lc).create=function(La,Lb){return{x:La||0,y:Lb||0}},Lc.clone=function(La){return{x:La.x,y:La.y}},Lc.magnitude=function(La){return Math.sqrt(La.x*La.x+La.y*La.y)},Lc.magnitudeSquared=function(La){return La.x*La.x+La.y*La.y},Lc.rotate=function(La,Lb,Lc){var Ld=Math.cos(Lb),Le=Math.sin(Lb);Lc||(Lc={});var Lf=La.x*Ld-La.y*Le;return Lc.y=La.x*Le+La.y*Ld,Lc.x=Lf,Lc},Lc.rotateAbout=function(La,Lb,Lc,Ld){var Le=Math.cos(Lb),Lf=Math.sin(Lb);Ld||(Ld={});var Lg=Lc.x+((La.x-Lc.x)*Le-(La.y-Lc.y)*Lf);return Ld.y=Lc.y+((La.x-Lc.x)*Lf+(La.y-Lc.y)*Le),Ld.x=Lg,Ld},Lc.normalise=function(La){var Lb=Lc.magnitude(La);return 0===Lb?{x:0,y:0}:{x:La.x/Lb,y:La.y/Lb}},Lc.dot=function(La,Lb){return La.x*Lb.x+La.y*Lb.y},Lc.cross=function(La,Lb){return La.x*Lb.y-La.y*Lb.x},Lc.cross3=function(La,Lb,Lc){return(Lb.x-La.x)*(Lc.y-La.y)-(Lb.y-La.y)*(Lc.x-La.x)},Lc.add=function(La,Lb,Lc){return Lc||(Lc={}),Lc.x=La.x+Lb.x,Lc.y=La.y+Lb.y,Lc},Lc.sub=function(La,Lb,Lc){return Lc||(Lc={}),Lc.x=La.x-Lb.x,Lc.y=La.y-Lb.y,Lc},Lc.mult=function(La,Lb){return{x:La.x*Lb,y:La.y*Lb}},Lc.div=function(La,Lb){return{x:La.x/Lb,y:La.y/Lb}},Lc.perp=function(La,Lb){return{x:(Lb=!0===Lb?-1:1)*-La.y,y:Lb*La.x}},Lc.neg=function(La){return{x:-La.x,y:-La.y}},Lc.angle=function(La,Lb){return Math.atan2(Lb.y-La.y,Lb.x-La.x)},Lc._temp=[Lc.create(),Lc.create(),Lc.create(),Lc.create(),Lc.create(),Lc.create()]},function(La,Lb,Lc){var Lh={};La.exports=Lh;var Lu=Lc(2),Lv=Lc(0);Lh.create=function(La,Lb){for(var Lc=[],Ld=0;Ld<La.length;Ld++){var Le=La[Ld],Lf={x:Le.x,y:Le.y,index:Ld,body:Lb,isInternal:!1};Lc.push(Lf)}return Lc},Lh.fromPath=function(La,Lb){var Ld=[];return La.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(La,Lb,Lc){Ld.push({x:parseFloat(Lb),y:parseFloat(Lc)})}),Lh.create(Ld,Lb)},Lh.centre=function(La){for(var Lb,Lc,Ld,Le=Lh.area(La,!0),Lf={x:0,y:0},Lg=0;Lg<La.length;Lg++)Ld=(Lg+1)%La.length,Lb=Lu.cross(La[Lg],La[Ld]),Lc=Lu.mult(Lu.add(La[Lg],La[Ld]),Lb),Lf=Lu.add(Lf,Lc);return Lu.div(Lf,6*Le)},Lh.mean=function(La){for(var Lb={x:0,y:0},Lc=0;Lc<La.length;Lc++)Lb.x+=La[Lc].x,Lb.y+=La[Lc].y;return Lu.div(Lb,La.length)},Lh.area=function(La,Lb){for(var Lc=0,Ld=La.length-1,Le=0;Le<La.length;Le++)Lc+=(La[Ld].x-La[Le].x)*(La[Ld].y+La[Le].y),Ld=Le;return Lb?Lc/2:Math.abs(Lc)/2},Lh.inertia=function(La,Lb){for(var Lc,Ld,Le=0,Lf=0,Lg=La,Lh=0;Lh<Lg.length;Lh++)Ld=(Lh+1)%Lg.length,Le+=(Lc=Math.abs(Lu.cross(Lg[Ld],Lg[Lh])))*(Lu.dot(Lg[Ld],Lg[Ld])+Lu.dot(Lg[Ld],Lg[Lh])+Lu.dot(Lg[Lh],Lg[Lh])),Lf+=Lc;return Lb/6*(Le/Lf)},Lh.translate=function(La,Lb,Lc){Lc=void 0!==Lc?Lc:1;var Ld,Le=La.length,Lf=Lb.x*Lc,Lg=Lb.y*Lc;for(Ld=0;Ld<Le;Ld++)La[Ld].x+=Lf,La[Ld].y+=Lg;return La},Lh.rotate=function(La,Lb,Lc){if(0!==Lb){var Ld,Le,Lf,Lg,Lh=Math.cos(Lb),Li=Math.sin(Lb),Lj=Lc.x,Lk=Lc.y,Ll=La.length;for(Lg=0;Lg<Ll;Lg++)Le=(Ld=La[Lg]).x-Lj,Lf=Ld.y-Lk,Ld.x=Lj+(Le*Lh-Lf*Li),Ld.y=Lk+(Le*Li+Lf*Lh);return La}},Lh.contains=function(La,Lb){for(var Lc,Ld=Lb.x,Le=Lb.y,Lf=La.length,Lg=La[Lf-1],Lh=0;Lh<Lf;Lh++){if(Lc=La[Lh],0<(Ld-Lg.x)*(Lc.y-Lg.y)+(Le-Lg.y)*(Lg.x-Lc.x))return!1;Lg=Lc}return!0},Lh.scale=function(La,Lb,Lc,Ld){if(1===Lb&&1===Lc)return La;var Le,Lf;Ld=Ld||Lh.centre(La);for(var Lg=0;Lg<La.length;Lg++)Le=La[Lg],Lf=Lu.sub(Le,Ld),La[Lg].x=Ld.x+Lf.x*Lb,La[Lg].y=Ld.y+Lf.y*Lc;return La},Lh.chamfer=function(La,Lb,Lc,Ld,Le){Lb="number"==typeof Lb?[Lb]:Lb||[8],Lc=void 0!==Lc?Lc:-1,Ld=Ld||2,Le=Le||14;for(var Lf=[],Lg=0;Lg<La.length;Lg++){var Lh=La[0<=Lg-1?Lg-1:La.length-1],Li=La[Lg],Lj=La[(Lg+1)%La.length],Lk=Lb[Lg<Lb.length?Lg:Lb.length-1];if(0!==Lk){var Ll=Lu.normalise({x:Li.y-Lh.y,y:Lh.x-Li.x}),Lm=Lu.normalise({x:Lj.y-Li.y,y:Li.x-Lj.x}),Ln=Math.sqrt(2*Math.pow(Lk,2)),Lo=Lu.mult(Lv.clone(Ll),Lk),Lp=Lu.normalise(Lu.mult(Lu.add(Ll,Lm),.5)),Lq=Lu.sub(Li,Lu.mult(Lp,Ln)),Lr=Lc;-1===Lc&&(Lr=1.75*Math.pow(Lk,.32)),(Lr=Lv.clamp(Lr,Ld,Le))%2==1&&(Lr+=1);for(var Ls=Math.acos(Lu.dot(Ll,Lm))/Lr,Lt=0;Lt<Lr;Lt++)Lf.push(Lu.add(Lu.rotate(Lo,Ls*Lt),Lq))}else Lf.push(Li)}return Lf},Lh.clockwiseSort=function(La){var Lc=Lh.mean(La);return La.sort(function(La,Lb){return Lu.angle(Lc,La)-Lu.angle(Lc,Lb)}),La},Lh.isConvex=function(La){var Lb,Lc,Ld,Le,Lf=0,Lg=La.length;if(Lg<3)return null;for(Lb=0;Lb<Lg;Lb++)if(Ld=(Lb+2)%Lg,Le=(La[Lc=(Lb+1)%Lg].x-La[Lb].x)*(La[Ld].y-La[Lc].y),(Le-=(La[Lc].y-La[Lb].y)*(La[Ld].x-La[Lc].x))<0?Lf|=1:0<Le&&(Lf|=2),3===Lf)return!1;return 0!==Lf||null},Lh.hull=function(La){var Lb,Lc,Ld=[],Le=[];for((La=La.slice(0)).sort(function(La,Lb){var Lc=La.x-Lb.x;return 0!=Lc?Lc:La.y-Lb.y}),Lc=0;Lc<La.length;Lc+=1){for(Lb=La[Lc];2<=Le.length&&Lu.cross3(Le[Le.length-2],Le[Le.length-1],Lb)<=0;)Le.pop();Le.push(Lb)}for(Lc=La.length-1;0<=Lc;Lc-=1){for(Lb=La[Lc];2<=Ld.length&&Lu.cross3(Ld[Ld.length-2],Ld[Ld.length-1],Lb)<=0;)Ld.pop();Ld.push(Lb)}return Ld.pop(),Le.pop(),Ld.concat(Le)}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Lk=Lc(0);Ld.on=function(La,Lb,Lc){for(var Ld,Le=Lb.split(" "),Lf=0;Lf<Le.length;Lf++)Ld=Le[Lf],La.events=La.events||{},La.events[Ld]=La.events[Ld]||[],La.events[Ld].push(Lc);return Lc},Ld.off=function(La,Lb,Lc){if(Lb){"function"==typeof Lb&&(Lc=Lb,Lb=Lk.keys(La.events).join(" "));for(var Ld=Lb.split(" "),Le=0;Le<Ld.length;Le++){var Lf=La.events[Ld[Le]],Lg=[];if(Lc&&Lf)for(var Lh=0;Lh<Lf.length;Lh++)Lf[Lh]!==Lc&&Lg.push(Lf[Lh]);La.events[Ld[Le]]=Lg}}else La.events={}},Ld.trigger=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=La.events;if(Lh&&0<Lk.keys(Lh).length){Lc||(Lc={}),Ld=Lb.split(" ");for(var Li=0;Li<Ld.length;Li++)if(Lf=Lh[Le=Ld[Li]]){(Lg=Lk.clone(Lc,!1)).name=Le,Lg.source=La;for(var Lj=0;Lj<Lf.length;Lj++)Lf[Lj].apply(La,[Lg])}}}},function(La,Lb,Lc){var Ll={};La.exports=Ll;var Lg=Lc(4),Lf=Lc(0),Lh=Lc(1),Lm=Lc(6);Ll.create=function(La){return Lf.extend({id:Lf.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},La)},Ll.setModified=function(La,Lb,Lc,Ld){if((La.isModified=Lb)&&La.cache&&(La.cache.allBodies=null,La.cache.allConstraints=null,La.cache.allComposites=null),Lc&&La.parent&&Ll.setModified(La.parent,Lb,Lc,Ld),Ld)for(var Le=0;Le<La.composites.length;Le++){var Lf=La.composites[Le];Ll.setModified(Lf,Lb,Lc,Ld)}},Ll.add=function(La,Lb){var Lc=[].concat(Lb);Lg.trigger(La,"beforeAdd",{object:Lb});for(var Ld=0;Ld<Lc.length;Ld++){var Le=Lc[Ld];switch(Le.type){case"body":if(Le.parent!==Le){Lf.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}Ll.addBody(La,Le);break;case"constraint":Ll.addConstraint(La,Le);break;case"composite":Ll.addComposite(La,Le);break;case"mouseConstraint":Ll.addConstraint(La,Le.constraint)}}return Lg.trigger(La,"afterAdd",{object:Lb}),La},Ll.remove=function(La,Lb,Lc){var Ld=[].concat(Lb);Lg.trigger(La,"beforeRemove",{object:Lb});for(var Le=0;Le<Ld.length;Le++){var Lf=Ld[Le];switch(Lf.type){case"body":Ll.removeBody(La,Lf,Lc);break;case"constraint":Ll.removeConstraint(La,Lf,Lc);break;case"composite":Ll.removeComposite(La,Lf,Lc);break;case"mouseConstraint":Ll.removeConstraint(La,Lf.constraint)}}return Lg.trigger(La,"afterRemove",{object:Lb}),La},Ll.addComposite=function(La,Lb){return La.composites.push(Lb),Lb.parent=La,Ll.setModified(La,!0,!0,!1),La},Ll.removeComposite=function(La,Lb,Lc){var Ld=Lf.indexOf(La.composites,Lb);if(-1!==Ld&&Ll.removeCompositeAt(La,Ld),Lc)for(var Le=0;Le<La.composites.length;Le++)Ll.removeComposite(La.composites[Le],Lb,!0);return La},Ll.removeCompositeAt=function(La,Lb){return La.composites.splice(Lb,1),Ll.setModified(La,!0,!0,!1),La},Ll.addBody=function(La,Lb){return La.bodies.push(Lb),Ll.setModified(La,!0,!0,!1),La},Ll.removeBody=function(La,Lb,Lc){var Ld=Lf.indexOf(La.bodies,Lb);if(-1!==Ld&&Ll.removeBodyAt(La,Ld),Lc)for(var Le=0;Le<La.composites.length;Le++)Ll.removeBody(La.composites[Le],Lb,!0);return La},Ll.removeBodyAt=function(La,Lb){return La.bodies.splice(Lb,1),Ll.setModified(La,!0,!0,!1),La},Ll.addConstraint=function(La,Lb){return La.constraints.push(Lb),Ll.setModified(La,!0,!0,!1),La},Ll.removeConstraint=function(La,Lb,Lc){var Ld=Lf.indexOf(La.constraints,Lb);if(-1!==Ld&&Ll.removeConstraintAt(La,Ld),Lc)for(var Le=0;Le<La.composites.length;Le++)Ll.removeConstraint(La.composites[Le],Lb,!0);return La},Ll.removeConstraintAt=function(La,Lb){return La.constraints.splice(Lb,1),Ll.setModified(La,!0,!0,!1),La},Ll.clear=function(La,Lb,Lc){if(Lc)for(var Ld=0;Ld<La.composites.length;Ld++)Ll.clear(La.composites[Ld],Lb,!0);return Lb?La.bodies=La.bodies.filter(function(La){return La.isStatic}):La.bodies.length=0,La.constraints.length=0,La.composites.length=0,Ll.setModified(La,!0,!0,!1),La},Ll.allBodies=function(La){if(La.cache&&La.cache.allBodies)return La.cache.allBodies;for(var Lb=[].concat(La.bodies),Lc=0;Lc<La.composites.length;Lc++)Lb=Lb.concat(Ll.allBodies(La.composites[Lc]));return La.cache&&(La.cache.allBodies=Lb),Lb},Ll.allConstraints=function(La){if(La.cache&&La.cache.allConstraints)return La.cache.allConstraints;for(var Lb=[].concat(La.constraints),Lc=0;Lc<La.composites.length;Lc++)Lb=Lb.concat(Ll.allConstraints(La.composites[Lc]));return La.cache&&(La.cache.allConstraints=Lb),Lb},Ll.allComposites=function(La){if(La.cache&&La.cache.allComposites)return La.cache.allComposites;for(var Lb=[].concat(La.composites),Lc=0;Lc<La.composites.length;Lc++)Lb=Lb.concat(Ll.allComposites(La.composites[Lc]));return La.cache&&(La.cache.allComposites=Lb),Lb},Ll.get=function(La,Lb,Lc){var Ld,Le;switch(Lc){case"body":Ld=Ll.allBodies(La);break;case"constraint":Ld=Ll.allConstraints(La);break;case"composite":Ld=Ll.allComposites(La).concat(La)}return Ld?0===(Le=Ld.filter(function(La){return La.id.toString()===Lb.toString()})).length?null:Le[0]:null},Ll.move=function(La,Lb,Lc){return Ll.remove(La,Lb),Ll.add(Lc,Lb),La},Ll.rebase=function(La){for(var Lb=Ll.allBodies(La).concat(Ll.allConstraints(La)).concat(Ll.allComposites(La)),Lc=0;Lc<Lb.length;Lc++)Lb[Lc].id=Lf.nextId();return La},Ll.translate=function(La,Lb,Lc){for(var Ld=Lc?Ll.allBodies(La):La.bodies,Le=0;Le<Ld.length;Le++)Lm.translate(Ld[Le],Lb);return La},Ll.rotate=function(La,Lb,Lc,Ld){for(var Le=Math.cos(Lb),Lf=Math.sin(Lb),Lg=Ld?Ll.allBodies(La):La.bodies,Lh=0;Lh<Lg.length;Lh++){var Li=Lg[Lh],Lj=Li.position.x-Lc.x,Lk=Li.position.y-Lc.y;Lm.setPosition(Li,{x:Lc.x+(Lj*Le-Lk*Lf),y:Lc.y+(Lj*Lf+Lk*Le)}),Lm.rotate(Li,Lb)}return La},Ll.scale=function(La,Lb,Lc,Ld,Le){for(var Lf=Le?Ll.allBodies(La):La.bodies,Lg=0;Lg<Lf.length;Lg++){var Lh=Lf[Lg],Li=Lh.position.x-Ld.x,Lj=Lh.position.y-Ld.y;Lm.setPosition(Lh,{x:Ld.x+Li*Lb,y:Ld.y+Lj*Lc}),Lm.scale(Lh,Lb,Lc)}return La},Ll.bounds=function(La){for(var Lb=Ll.allBodies(La),Lc=[],Ld=0;Ld<Lb.length;Ld+=1){var Le=Lb[Ld];Lc.push(Le.bounds.min,Le.bounds.max)}return Lh.create(Lc)}},function(La,Lb,Lc){var Lj={};La.exports=Lj;var Lk=Lc(3),Ll=Lc(2),Le=Lc(7),Lf=(Lc(16),Lc(0)),Lm=Lc(1),Ln=Lc(11);!function(){Lj._inertiaScale=4,Lj._nextCollidingGroupId=1,Lj._nextNonCollidingGroupId=-1,Lj._nextCategory=1,Lj.create=function(La){var Lb={id:Lf.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:Lk.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},Lc=Lf.extend(Lb,La);return Ld(Lc,La),Lc},Lj.nextGroup=function(La){return La?Lj._nextNonCollidingGroupId--:Lj._nextCollidingGroupId++},Lj.nextCategory=function(){return Lj._nextCategory=Lj._nextCategory<<1,Lj._nextCategory};var Ld=function(La,Lb){Lb=Lb||{},Lj.set(La,{bounds:La.bounds||Lm.create(La.vertices),positionPrev:La.positionPrev||Ll.clone(La.position),anglePrev:La.anglePrev||La.angle,vertices:La.vertices,parts:La.parts||[La],isStatic:La.isStatic,isSleeping:La.isSleeping,parent:La.parent||La}),Lk.rotate(La.vertices,La.angle,La.position),Ln.rotate(La.axes,La.angle),Lm.update(La.bounds,La.vertices,La.velocity),Lj.set(La,{axes:Lb.axes||La.axes,area:Lb.area||La.area,mass:Lb.mass||La.mass,inertia:Lb.inertia||La.inertia});var Lc=La.isStatic?"#14151f":Lf.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),Ld=La.isStatic?"#555":"#ccc",Le=La.isStatic&&null===La.render.fillStyle?1:0;La.render.fillStyle=La.render.fillStyle||Lc,La.render.strokeStyle=La.render.strokeStyle||Ld,La.render.lineWidth=La.render.lineWidth||Le,La.render.sprite.xOffset+=-(La.bounds.min.x-La.position.x)/(La.bounds.max.x-La.bounds.min.x),La.render.sprite.yOffset+=-(La.bounds.min.y-La.position.y)/(La.bounds.max.y-La.bounds.min.y)};Lj.set=function(La,Lb,Lc){var Ld;for(Ld in"string"==typeof Lb&&(Ld=Lb,(Lb={})[Ld]=Lc),Lb)if(Object.prototype.hasOwnProperty.call(Lb,Ld))switch(Lc=Lb[Ld],Ld){case"isStatic":Lj.setStatic(La,Lc);break;case"isSleeping":Le.set(La,Lc);break;case"mass":Lj.setMass(La,Lc);break;case"density":Lj.setDensity(La,Lc);break;case"inertia":Lj.setInertia(La,Lc);break;case"vertices":Lj.setVertices(La,Lc);break;case"position":Lj.setPosition(La,Lc);break;case"angle":Lj.setAngle(La,Lc);break;case"velocity":Lj.setVelocity(La,Lc);break;case"angularVelocity":Lj.setAngularVelocity(La,Lc);break;case"parts":Lj.setParts(La,Lc);break;case"centre":Lj.setCentre(La,Lc);break;default:La[Ld]=Lc}},Lj.setStatic=function(La,Lb){for(var Lc=0;Lc<La.parts.length;Lc++){var Ld=La.parts[Lc];(Ld.isStatic=Lb)?(Ld._original={restitution:Ld.restitution,friction:Ld.friction,mass:Ld.mass,inertia:Ld.inertia,density:Ld.density,inverseMass:Ld.inverseMass,inverseInertia:Ld.inverseInertia},Ld.restitution=0,Ld.friction=1,Ld.mass=Ld.inertia=Ld.density=1/0,Ld.inverseMass=Ld.inverseInertia=0,Ld.positionPrev.x=Ld.position.x,Ld.positionPrev.y=Ld.position.y,Ld.anglePrev=Ld.angle,Ld.angularVelocity=0,Ld.speed=0,Ld.angularSpeed=0,Ld.motion=0):Ld._original&&(Ld.restitution=Ld._original.restitution,Ld.friction=Ld._original.friction,Ld.mass=Ld._original.mass,Ld.inertia=Ld._original.inertia,Ld.density=Ld._original.density,Ld.inverseMass=Ld._original.inverseMass,Ld.inverseInertia=Ld._original.inverseInertia,Ld._original=null)}},Lj.setMass=function(La,Lb){var Lc=La.inertia/(La.mass/6);La.inertia=Lb/6*Lc,La.inverseInertia=1/La.inertia,La.mass=Lb,La.inverseMass=1/La.mass,La.density=La.mass/La.area},Lj.setDensity=function(La,Lb){Lj.setMass(La,Lb*La.area),La.density=Lb},Lj.setInertia=function(La,Lb){La.inertia=Lb,La.inverseInertia=1/La.inertia},Lj.setVertices=function(La,Lb){Lb[0].body===La?La.vertices=Lb:La.vertices=Lk.create(Lb,La),La.axes=Ln.fromVertices(La.vertices),La.area=Lk.area(La.vertices),Lj.setMass(La,La.density*La.area);var Lc=Lk.centre(La.vertices);Lk.translate(La.vertices,Lc,-1),Lj.setInertia(La,Lj._inertiaScale*Lk.inertia(La.vertices,La.mass)),Lk.translate(La.vertices,La.position),Lm.update(La.bounds,La.vertices,La.velocity)},Lj.setParts=function(La,Lb,Lc){var Ld;for(Lb=Lb.slice(0),La.parts.length=0,La.parts.push(La),La.parent=La,Ld=0;Ld<Lb.length;Ld++){var Le=Lb[Ld];Le!==La&&(Le.parent=La).parts.push(Le)}if(1!==La.parts.length){if(Lc=void 0===Lc||Lc){var Lf=[];for(Ld=0;Ld<Lb.length;Ld++)Lf=Lf.concat(Lb[Ld].vertices);Lk.clockwiseSort(Lf);var Lg=Lk.hull(Lf),Lh=Lk.centre(Lg);Lj.setVertices(La,Lg),Lk.translate(La.vertices,Lh)}var Li=Lj._totalProperties(La);La.area=Li.area,(La.parent=La).position.x=Li.centre.x,La.position.y=Li.centre.y,La.positionPrev.x=Li.centre.x,La.positionPrev.y=Li.centre.y,Lj.setMass(La,Li.mass),Lj.setInertia(La,Li.inertia),Lj.setPosition(La,Li.centre)}},Lj.setCentre=function(La,Lb,Lc){Lc?(La.positionPrev.x+=Lb.x,La.positionPrev.y+=Lb.y,La.position.x+=Lb.x,La.position.y+=Lb.y):(La.positionPrev.x=Lb.x-(La.position.x-La.positionPrev.x),La.positionPrev.y=Lb.y-(La.position.y-La.positionPrev.y),La.position.x=Lb.x,La.position.y=Lb.y)},Lj.setPosition=function(La,Lb){var Lc=Ll.sub(Lb,La.position);La.positionPrev.x+=Lc.x,La.positionPrev.y+=Lc.y;for(var Ld=0;Ld<La.parts.length;Ld++){var Le=La.parts[Ld];Le.position.x+=Lc.x,Le.position.y+=Lc.y,Lk.translate(Le.vertices,Lc),Lm.update(Le.bounds,Le.vertices,La.velocity)}},Lj.setAngle=function(La,Lb){var Lc=Lb-La.angle;La.anglePrev+=Lc;for(var Ld=0;Ld<La.parts.length;Ld++){var Le=La.parts[Ld];Le.angle+=Lc,Lk.rotate(Le.vertices,Lc,La.position),Ln.rotate(Le.axes,Lc),Lm.update(Le.bounds,Le.vertices,La.velocity),0<Ld&&Ll.rotateAbout(Le.position,Lc,La.position,Le.position)}},Lj.setVelocity=function(La,Lb){La.positionPrev.x=La.position.x-Lb.x,La.positionPrev.y=La.position.y-Lb.y,La.velocity.x=Lb.x,La.velocity.y=Lb.y,La.speed=Ll.magnitude(La.velocity)},Lj.setAngularVelocity=function(La,Lb){La.anglePrev=La.angle-Lb,La.angularVelocity=Lb,La.angularSpeed=Math.abs(La.angularVelocity)},Lj.translate=function(La,Lb){Lj.setPosition(La,Ll.add(La.position,Lb))},Lj.rotate=function(La,Lb,Lc){if(Lc){var Ld=Math.cos(Lb),Le=Math.sin(Lb),Lf=La.position.x-Lc.x,Lg=La.position.y-Lc.y;Lj.setPosition(La,{x:Lc.x+(Lf*Ld-Lg*Le),y:Lc.y+(Lf*Le+Lg*Ld)}),Lj.setAngle(La,La.angle+Lb)}else Lj.setAngle(La,La.angle+Lb)},Lj.scale=function(La,Lb,Lc,Ld){var Le=0,Lf=0;Ld=Ld||La.position;for(var Lg=0;Lg<La.parts.length;Lg++){var Lh=La.parts[Lg];Lk.scale(Lh.vertices,Lb,Lc,Ld),Lh.axes=Ln.fromVertices(Lh.vertices),Lh.area=Lk.area(Lh.vertices),Lj.setMass(Lh,La.density*Lh.area),Lk.translate(Lh.vertices,{x:-Lh.position.x,y:-Lh.position.y}),Lj.setInertia(Lh,Lj._inertiaScale*Lk.inertia(Lh.vertices,Lh.mass)),Lk.translate(Lh.vertices,{x:Lh.position.x,y:Lh.position.y}),0<Lg&&(Le+=Lh.area,Lf+=Lh.inertia),Lh.position.x=Ld.x+(Lh.position.x-Ld.x)*Lb,Lh.position.y=Ld.y+(Lh.position.y-Ld.y)*Lc,Lm.update(Lh.bounds,Lh.vertices,La.velocity)}1<La.parts.length&&(La.area=Le,La.isStatic||(Lj.setMass(La,La.density*Le),Lj.setInertia(La,Lf))),La.circleRadius&&(Lb===Lc?La.circleRadius*=Lb:La.circleRadius=null)},Lj.update=function(La,Lb,Lc,Ld){var Le=Math.pow(Lb*Lc*La.timeScale,2),Lf=1-La.frictionAir*Lc*La.timeScale,Lg=La.position.x-La.positionPrev.x,Lh=La.position.y-La.positionPrev.y;La.velocity.x=Lg*Lf*Ld+La.force.x/La.mass*Le,La.velocity.y=Lh*Lf*Ld+La.force.y/La.mass*Le,La.positionPrev.x=La.position.x,La.positionPrev.y=La.position.y,La.position.x+=La.velocity.x,La.position.y+=La.velocity.y,La.angularVelocity=(La.angle-La.anglePrev)*Lf*Ld+La.torque/La.inertia*Le,La.anglePrev=La.angle,La.angle+=La.angularVelocity,La.speed=Ll.magnitude(La.velocity),La.angularSpeed=Math.abs(La.angularVelocity);for(var Li=0;Li<La.parts.length;Li++){var Lj=La.parts[Li];Lk.translate(Lj.vertices,La.velocity),0<Li&&(Lj.position.x+=La.velocity.x,Lj.position.y+=La.velocity.y),0!==La.angularVelocity&&(Lk.rotate(Lj.vertices,La.angularVelocity,La.position),Ln.rotate(Lj.axes,La.angularVelocity),0<Li&&Ll.rotateAbout(Lj.position,La.angularVelocity,La.position,Lj.position)),Lm.update(Lj.bounds,Lj.vertices,La.velocity)}},Lj.applyForce=function(La,Lb,Lc){La.force.x+=Lc.x,La.force.y+=Lc.y;var Ld=Lb.x-La.position.x,Le=Lb.y-La.position.y;La.torque+=Ld*Lc.y-Le*Lc.x},Lj._totalProperties=function(La){for(var Lb={mass:0,area:0,inertia:0,centre:{x:0,y:0}},Lc=1===La.parts.length?0:1;Lc<La.parts.length;Lc++){var Ld=La.parts[Lc],Le=Ld.mass!==1/0?Ld.mass:1;Lb.mass+=Le,Lb.area+=Ld.area,Lb.inertia+=Ld.inertia,Lb.centre=Ll.add(Lb.centre,Ll.mult(Ld.position,Le))}return Lb.centre=Ll.div(Lb.centre,Lb.mass),Lb}}()},function(La,Lb,Lc){var Lk={};La.exports=Lk;var Ld=Lc(4);Lk._motionWakeThreshold=.18,Lk._motionSleepThreshold=.08,Lk._minBias=.9,Lk.update=function(La,Lb){for(var Lc=Lb*Lb*Lb,Ld=0;Ld<La.length;Ld++){var Le=La[Ld],Lf=Le.speed*Le.speed+Le.angularSpeed*Le.angularSpeed;if(0===Le.force.x&&0===Le.force.y){var Lg=Math.min(Le.motion,Lf),Lh=Math.max(Le.motion,Lf);Le.motion=Lk._minBias*Lg+(1-Lk._minBias)*Lh,0<Le.sleepThreshold&&Le.motion<Lk._motionSleepThreshold*Lc?(Le.sleepCounter+=1,Le.sleepCounter>=Le.sleepThreshold&&Lk.set(Le,!0)):0<Le.sleepCounter&&(Le.sleepCounter-=1)}else Lk.set(Le,!1)}},Lk.afterCollisions=function(La,Lb){for(var Lc=Lb*Lb*Lb,Ld=0;Ld<La.length;Ld++){var Le=La[Ld];if(Le.isActive){var Lf=Le.collision,Lg=Lf.bodyA.parent,Lh=Lf.bodyB.parent;if(!(Lg.isSleeping&&Lh.isSleeping||Lg.isStatic||Lh.isStatic)&&(Lg.isSleeping||Lh.isSleeping)){var Li=Lg.isSleeping&&!Lg.isStatic?Lg:Lh,Lj=Li===Lg?Lh:Lg;!Li.isStatic&&Lj.motion>Lk._motionWakeThreshold*Lc&&Lk.set(Li,!1)}}}},Lk.set=function(La,Lb){var Lc=La.isSleeping;Lb?(La.isSleeping=!0,La.sleepCounter=La.sleepThreshold,La.positionImpulse.x=0,La.positionImpulse.y=0,La.positionPrev.x=La.position.x,La.positionPrev.y=La.position.y,La.anglePrev=La.angle,La.speed=0,La.angularSpeed=0,La.motion=0,Lc||Ld.trigger(La,"sleepStart")):(La.isSleeping=!1,La.sleepCounter=0,Lc&&Ld.trigger(La,"sleepEnd"))}},function(La,Lb,Lc){var Lo={};La.exports=Lo;var Lq,Lp,Lr,Ls=Lc(3),Lt=Lc(9);Lq=[],Lp={overlap:0,axis:null},Lr={overlap:0,axis:null},Lo.create=function(La,Lb){return{pair:null,collided:!1,bodyA:La,bodyB:Lb,parentA:La.parent,parentB:Lb.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},Lo.collides=function(La,Lb,Lc){if(Lo._overlapAxes(Lp,La.vertices,Lb.vertices,La.axes),Lp.overlap<=0)return null;if(Lo._overlapAxes(Lr,Lb.vertices,La.vertices,Lb.axes),Lr.overlap<=0)return null;var Ld,Le,Lf=Lc&&Lc.table[Lt.id(La,Lb)];Lf?Ld=Lf.collision:((Ld=Lo.create(La,Lb)).collided=!0,Ld.bodyA=La.id<Lb.id?La:Lb,Ld.bodyB=La.id<Lb.id?Lb:La,Ld.parentA=Ld.bodyA.parent,Ld.parentB=Ld.bodyB.parent),La=Ld.bodyA,Lb=Ld.bodyB,Le=Lp.overlap<Lr.overlap?Lp:Lr;var Lg=Ld.normal,Lh=Ld.supports,Li=Le.axis,Lj=Li.x,Lk=Li.y;Lj*(Lb.position.x-La.position.x)+Lk*(Lb.position.y-La.position.y)<0?(Lg.x=Lj,Lg.y=Lk):(Lg.x=-Lj,Lg.y=-Lk),Ld.tangent.x=-Lg.y,Ld.tangent.y=Lg.x,Ld.depth=Le.overlap,Ld.penetration.x=Lg.x*Ld.depth,Ld.penetration.y=Lg.y*Ld.depth;var Ll=Lo._findSupports(La,Lb,Lg,1),Lm=0;if(Ls.contains(La.vertices,Ll[0])&&(Lh[Lm++]=Ll[0]),Ls.contains(La.vertices,Ll[1])&&(Lh[Lm++]=Ll[1]),Lm<2){var Ln=Lo._findSupports(Lb,La,Lg,-1);Ls.contains(Lb.vertices,Ln[0])&&(Lh[Lm++]=Ln[0]),Lm<2&&Ls.contains(Lb.vertices,Ln[1])&&(Lh[Lm++]=Ln[1])}return 0===Lm&&(Lh[Lm++]=Ll[0]),Lh.length=Lm,Ld},Lo._overlapAxes=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj,Lk=Lb.length,Ll=Lc.length,Lm=Lb[0].x,Ln=Lb[0].y,Lo=Lc[0].x,Lp=Lc[0].y,Lq=Ld.length,Lr=Number.MAX_VALUE,Ls=0;for(Li=0;Li<Lq;Li++){var Lt=Ld[Li],Lu=Lt.x,Lv=Lt.y,Ly=Lm*Lu+Ln*Lv,Lz=Lo*Lu+Lp*Lv,LA=Ly,LB=Lz;for(Lj=1;Lj<Lk;Lj+=1)LA<(Lh=Lb[Lj].x*Lu+Lb[Lj].y*Lv)?LA=Lh:Lh<Ly&&(Ly=Lh);for(Lj=1;Lj<Ll;Lj+=1)LB<(Lh=Lc[Lj].x*Lu+Lc[Lj].y*Lv)?LB=Lh:Lh<Lz&&(Lz=Lh);if((Le=(Lf=LA-Lz)<(Lg=LB-Ly)?Lf:Lg)<Lr&&(Ls=Li,(Lr=Le)<=0))break}La.axis=Ld[Ls],La.overlap=Lr},Lo._projectToAxis=function(La,Lb,Lc){for(var Ld=Lb[0].x*Lc.x+Lb[0].y*Lc.y,Le=Ld,Lf=1;Lf<Lb.length;Lf+=1){var Lg=Lb[Lf].x*Lc.x+Lb[Lf].y*Lc.y;Le<Lg?Le=Lg:Lg<Ld&&(Ld=Lg)}La.min=Ld,La.max=Le},Lo._findSupports=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj=Lb.vertices,Lk=Lj.length,Ll=La.position.x,Lm=La.position.y,Ln=Lc.x*Ld,Lo=Lc.y*Ld,Lp=Number.MAX_VALUE;for(Li=0;Li<Lk;Li+=1)(Lh=Ln*(Ll-(Lf=Lj[Li]).x)+Lo*(Lm-Lf.y))<Lp&&(Lp=Lh,Le=Lf);return Lp=Ln*(Ll-(Lg=Lj[(Lk+Le.index-1)%Lk]).x)+Lo*(Lm-Lg.y),Ln*(Ll-(Lf=Lj[(Le.index+1)%Lk]).x)+Lo*(Lm-Lf.y)<Lp?(Lq[0]=Le,Lq[1]=Lf):(Lq[0]=Le,Lq[1]=Lg),Lq}},function(La,Lb,Lc){var Lf={};La.exports=Lf;var Ln=Lc(17);Lf.create=function(La,Lb){var Lc=La.bodyA,Ld=La.bodyB,Le={id:Lf.id(Lc,Ld),bodyA:Lc,bodyB:Ld,collision:La,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:Lc.isSensor||Ld.isSensor,timeCreated:Lb,timeUpdated:Lb,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return Lf.update(Le,La,Lb),Le},Lf.update=function(La,Lb,Lc){var Ld=La.contacts,Le=Lb.supports,Lf=La.activeContacts,Lg=Lb.parentA,Lh=Lb.parentB,Li=Lg.vertices.length;La.isActive=!0,La.timeUpdated=Lc,La.collision=Lb,La.separation=Lb.depth,La.inverseMass=Lg.inverseMass+Lh.inverseMass,La.friction=Lg.friction<Lh.friction?Lg.friction:Lh.friction,La.frictionStatic=Lg.frictionStatic>Lh.frictionStatic?Lg.frictionStatic:Lh.frictionStatic,La.restitution=Lg.restitution>Lh.restitution?Lg.restitution:Lh.restitution,La.slop=Lg.slop>Lh.slop?Lg.slop:Lh.slop,Lb.pair=La;for(var Lj=Lf.length=0;Lj<Le.length;Lj++){var Lk=Le[Lj],Ll=Lk.body===Lg?Lk.index:Li+Lk.index,Lm=Ld[Ll];Lm?Lf.push(Lm):Lf.push(Ld[Ll]=Ln.create(Lk))}},Lf.setActive=function(La,Lb,Lc){Lb?(La.isActive=!0,La.timeUpdated=Lc):(La.isActive=!1,La.activeContacts.length=0)},Lf.id=function(La,Lb){return La.id<Lb.id?"A"+La.id+"B"+Lb.id:"A"+Lb.id+"B"+La.id}},function(La,Lb,Lc){var Lv={};La.exports=Lv;var Lg=Lc(3),Ly=Lc(2),Lh=Lc(7),Li=Lc(1),Lj=Lc(11),Lk=Lc(0);Lv._warming=.4,Lv._torqueDampen=1,Lv._minLength=1e-6,Lv.create=function(La){var Lb=La;Lb.bodyA&&!Lb.pointA&&(Lb.pointA={x:0,y:0}),Lb.bodyB&&!Lb.pointB&&(Lb.pointB={x:0,y:0});var Lc=Lb.bodyA?Ly.add(Lb.bodyA.position,Lb.pointA):Lb.pointA,Ld=Lb.bodyB?Ly.add(Lb.bodyB.position,Lb.pointB):Lb.pointB,Le=Ly.magnitude(Ly.sub(Lc,Ld));Lb.length=void 0!==Lb.length?Lb.length:Le,Lb.id=Lb.id||Lk.nextId(),Lb.label=Lb.label||"Constraint",Lb.type="constraint",Lb.stiffness=Lb.stiffness||(0<Lb.length?1:.7),Lb.damping=Lb.damping||0,Lb.angularStiffness=Lb.angularStiffness||0,Lb.angleA=Lb.bodyA?Lb.bodyA.angle:Lb.angleA,Lb.angleB=Lb.bodyB?Lb.bodyB.angle:Lb.angleB,Lb.plugin={};var Lf={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===Lb.length&&.1<Lb.stiffness?(Lf.type="pin",Lf.anchors=!1):Lb.stiffness<.9&&(Lf.type="spring"),Lb.render=Lk.extend(Lf,Lb.render),Lb},Lv.preSolveAll=function(La){for(var Lb=0;Lb<La.length;Lb+=1){var Lc=La[Lb],Ld=Lc.constraintImpulse;Lc.isStatic||0===Ld.x&&0===Ld.y&&0===Ld.angle||(Lc.position.x+=Ld.x,Lc.position.y+=Ld.y,Lc.angle+=Ld.angle)}},Lv.solveAll=function(La,Lb){for(var Lc=0;Lc<La.length;Lc+=1){var Ld=La[Lc],Le=!Ld.bodyA||Ld.bodyA&&Ld.bodyA.isStatic,Lf=!Ld.bodyB||Ld.bodyB&&Ld.bodyB.isStatic;(Le||Lf)&&Lv.solve(La[Lc],Lb)}for(Lc=0;Lc<La.length;Lc+=1)Le=!(Ld=La[Lc]).bodyA||Ld.bodyA&&Ld.bodyA.isStatic,Lf=!Ld.bodyB||Ld.bodyB&&Ld.bodyB.isStatic,Le||Lf||Lv.solve(La[Lc],Lb)},Lv.solve=function(La,Lb){var Lc=La.bodyA,Ld=La.bodyB,Le=La.pointA,Lf=La.pointB;if(Lc||Ld){Lc&&!Lc.isStatic&&(Ly.rotate(Le,Lc.angle-La.angleA,Le),La.angleA=Lc.angle),Ld&&!Ld.isStatic&&(Ly.rotate(Lf,Ld.angle-La.angleB,Lf),La.angleB=Ld.angle);var Lg=Le,Lh=Lf;if(Lc&&(Lg=Ly.add(Lc.position,Le)),Ld&&(Lh=Ly.add(Ld.position,Lf)),Lg&&Lh){var Li=Ly.sub(Lg,Lh),Lj=Ly.magnitude(Li);Lj<Lv._minLength&&(Lj=Lv._minLength);var Lk,Ll,Lm,Ln,Lo,Lp=(Lj-La.length)/Lj,Lq=La.stiffness<1?La.stiffness*Lb:La.stiffness,Lr=Ly.mult(Li,Lp*Lq),Ls=(Lc?Lc.inverseMass:0)+(Ld?Ld.inverseMass:0),Lt=Ls+((Lc?Lc.inverseInertia:0)+(Ld?Ld.inverseInertia:0));if(La.damping){var Lu=Ly.create();Lm=Ly.div(Li,Lj),Lo=Ly.sub(Ld&&Ly.sub(Ld.position,Ld.positionPrev)||Lu,Lc&&Ly.sub(Lc.position,Lc.positionPrev)||Lu),Ln=Ly.dot(Lm,Lo)}Lc&&!Lc.isStatic&&(Ll=Lc.inverseMass/Ls,Lc.constraintImpulse.x-=Lr.x*Ll,Lc.constraintImpulse.y-=Lr.y*Ll,Lc.position.x-=Lr.x*Ll,Lc.position.y-=Lr.y*Ll,La.damping&&(Lc.positionPrev.x-=La.damping*Lm.x*Ln*Ll,Lc.positionPrev.y-=La.damping*Lm.y*Ln*Ll),Lk=Ly.cross(Le,Lr)/Lt*Lv._torqueDampen*Lc.inverseInertia*(1-La.angularStiffness),Lc.constraintImpulse.angle-=Lk,Lc.angle-=Lk),Ld&&!Ld.isStatic&&(Ll=Ld.inverseMass/Ls,Ld.constraintImpulse.x+=Lr.x*Ll,Ld.constraintImpulse.y+=Lr.y*Ll,Ld.position.x+=Lr.x*Ll,Ld.position.y+=Lr.y*Ll,La.damping&&(Ld.positionPrev.x+=La.damping*Lm.x*Ln*Ll,Ld.positionPrev.y+=La.damping*Lm.y*Ln*Ll),Lk=Ly.cross(Lf,Lr)/Lt*Lv._torqueDampen*Ld.inverseInertia*(1-La.angularStiffness),Ld.constraintImpulse.angle+=Lk,Ld.angle+=Lk)}}},Lv.postSolveAll=function(La){for(var Lb=0;Lb<La.length;Lb++){var Lc=La[Lb],Ld=Lc.constraintImpulse;if(!(Lc.isStatic||0===Ld.x&&0===Ld.y&&0===Ld.angle)){Lh.set(Lc,!1);for(var Le=0;Le<Lc.parts.length;Le++){var Lf=Lc.parts[Le];Lg.translate(Lf.vertices,Ld),0<Le&&(Lf.position.x+=Ld.x,Lf.position.y+=Ld.y),0!==Ld.angle&&(Lg.rotate(Lf.vertices,Ld.angle,Lc.position),Lj.rotate(Lf.axes,Ld.angle),0<Le&&Ly.rotateAbout(Lf.position,Ld.angle,Lc.position,Lf.position)),Li.update(Lf.bounds,Lf.vertices,Lc.velocity)}Ld.angle*=Lv._warming,Ld.x*=Lv._warming,Ld.y*=Lv._warming}}},Lv.pointAWorld=function(La){return{x:(La.bodyA?La.bodyA.position.x:0)+La.pointA.x,y:(La.bodyA?La.bodyA.position.y:0)+La.pointA.y}},Lv.pointBWorld=function(La){return{x:(La.bodyB?La.bodyB.position.x:0)+La.pointB.x,y:(La.bodyB?La.bodyB.position.y:0)+La.pointB.y}}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Lg=Lc(2),Lh=Lc(0);Ld.fromVertices=function(La){for(var Lb={},Lc=0;Lc<La.length;Lc++){var Ld=(Lc+1)%La.length,Le=Lg.normalise({x:La[Ld].y-La[Lc].y,y:La[Lc].x-La[Ld].x}),Lf=0===Le.y?1/0:Le.x/Le.y;Lb[Lf=Lf.toFixed(3).toString()]=Le}return Lh.values(Lb)},Ld.rotate=function(La,Lb){if(0!==Lb)for(var Lc=Math.cos(Lb),Ld=Math.sin(Lb),Le=0;Le<La.length;Le++){var Lf,Lg=La[Le];Lf=Lg.x*Lc-Lg.y*Ld,Lg.y=Lg.x*Ld+Lg.y*Lc,Lg.x=Lf}}},function(La,Lb,Lc){var Lo={};La.exports=Lo;var LE=Lc(3),LF=Lc(0),LG=Lc(6),LH=Lc(1),LI=Lc(2);Lo.rectangle=function(La,Lb,Lc,Ld,Le){Le=Le||{};var Lf={label:"Rectangle Body",position:{x:La,y:Lb},vertices:LE.fromPath("L 0 0 L "+Lc+" 0 L "+Lc+" "+Ld+" L 0 "+Ld)};if(Le.chamfer){var Lg=Le.chamfer;Lf.vertices=LE.chamfer(Lf.vertices,Lg.radius,Lg.quality,Lg.qualityMin,Lg.qualityMax),delete Le.chamfer}return LG.create(LF.extend({},Lf,Le))},Lo.trapezoid=function(La,Lb,Lc,Ld,Le,Lf){Lf=Lf||{};var Lg,Lh=Lc*(Le*=.5),Li=Lh+(1-2*Le)*Lc,Lj=Li+Lh;Lg=Le<.5?"L 0 0 L "+Lh+" "+-Ld+" L "+Li+" "+-Ld+" L "+Lj+" 0":"L 0 0 L "+Li+" "+-Ld+" L "+Lj+" 0";var Lk={label:"Trapezoid Body",position:{x:La,y:Lb},vertices:LE.fromPath(Lg)};if(Lf.chamfer){var Ll=Lf.chamfer;Lk.vertices=LE.chamfer(Lk.vertices,Ll.radius,Ll.quality,Ll.qualityMin,Ll.qualityMax),delete Lf.chamfer}return LG.create(LF.extend({},Lk,Lf))},Lo.circle=function(La,Lb,Lc,Ld,Le){Ld=Ld||{};var Lf={label:"Circle Body",circleRadius:Lc};Le=Le||25;var Lg=Math.ceil(Math.max(10,Math.min(Le,Lc)));return Lg%2==1&&(Lg+=1),Lo.polygon(La,Lb,Lg,Lc,LF.extend({},Lf,Ld))},Lo.polygon=function(La,Lb,Lc,Ld,Le){if(Le=Le||{},Lc<3)return Lo.circle(La,Lb,Ld,Le);for(var Lf=2*Math.PI/Lc,Lg="",Lh=.5*Lf,Li=0;Li<Lc;Li+=1){var Lj=Lh+Li*Lf,Lk=Math.cos(Lj)*Ld,Ll=Math.sin(Lj)*Ld;Lg+="L "+Lk.toFixed(3)+" "+Ll.toFixed(3)+" "}var Lm={label:"Polygon Body",position:{x:La,y:Lb},vertices:LE.fromPath(Lg)};if(Le.chamfer){var Ln=Le.chamfer;Lm.vertices=LE.chamfer(Lm.vertices,Ln.radius,Ln.quality,Ln.qualityMin,Ln.qualityMax),delete Le.chamfer}return LG.create(LF.extend({},Lm,Le))},Lo.fromVertices=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh){var Li,Lj,Lk,Ll,Lm,Ln,Lo,Lp,Lq,Lr,Ls=LF.getDecomp();for(Li=Boolean(Ls&&Ls.quickDecomp),Ld=Ld||{},Lk=[],Le=void 0!==Le&&Le,Lf=void 0!==Lf?Lf:.01,Lg=void 0!==Lg?Lg:10,Lh=void 0!==Lh?Lh:.01,LF.isArray(Lc[0])||(Lc=[Lc]),Lq=0;Lq<Lc.length;Lq+=1)if(Lm=Lc[Lq],!(Ll=LE.isConvex(Lm))&&!Li&&LF.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),Ll||!Li)Lm=Ll?LE.clockwiseSort(Lm):LE.hull(Lm),Lk.push({position:{x:La,y:Lb},vertices:Lm});else{var Lt=Lm.map(function(La){return[La.x,La.y]});Ls.makeCCW(Lt),!1!==Lf&&Ls.removeCollinearPoints(Lt,Lf),!1!==Lh&&Ls.removeDuplicatePoints&&Ls.removeDuplicatePoints(Lt,Lh);var Lu=Ls.quickDecomp(Lt);for(Ln=0;Ln<Lu.length;Ln++){var Lv=Lu[Ln].map(function(La){return{x:La[0],y:La[1]}});0<Lg&&LE.area(Lv)<Lg||Lk.push({position:LE.centre(Lv),vertices:Lv})}}for(Ln=0;Ln<Lk.length;Ln++)Lk[Ln]=LG.create(LF.extend(Lk[Ln],Ld));if(Le)for(Ln=0;Ln<Lk.length;Ln++){var Ly=Lk[Ln];for(Lo=Ln+1;Lo<Lk.length;Lo++){var Lz=Lk[Lo];if(LH.overlaps(Ly.bounds,Lz.bounds)){var LA=Ly.vertices,LB=Lz.vertices;for(Lp=0;Lp<Ly.vertices.length;Lp++)for(Lr=0;Lr<Lz.vertices.length;Lr++){var LC=LI.magnitudeSquared(LI.sub(LA[(Lp+1)%LA.length],LB[Lr])),LD=LI.magnitudeSquared(LI.sub(LA[Lp],LB[(Lr+1)%LB.length]));LC<5&&LD<5&&(LA[Lp].isInternal=!0,LB[Lr].isInternal=!0)}}}}return 1<Lk.length?(Lj=LG.create(LF.extend({parts:Lk.slice(0)},Ld)),LG.setPosition(Lj,{x:La,y:Lb}),Lj):Lk[0]}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Le=Lc(0);Ld.create=function(La){var Lc={};return La||Le.log("Mouse.create: element was undefined, defaulting to document.body","warn"),Lc.element=La||document.body,Lc.absolute={x:0,y:0},Lc.position={x:0,y:0},Lc.mousedownPosition={x:0,y:0},Lc.mouseupPosition={x:0,y:0},Lc.mouseoutPosition={x:0,y:0},Lc.offset={x:0,y:0},Lc.scale={x:1,y:1},Lc.wheelDelta=0,Lc.button=-1,Lc.pixelRatio=parseInt(Lc.element.getAttribute("data-pixel-ratio"),10)||1,Lc.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mouseout:null,mousewheel:null},Lc.mousemove=function(La){var Lb=Ld._getRelativeMousePosition(La,Lc.element,Lc.pixelRatio);La.changedTouches&&(Lc.button=0,La.preventDefault()),Lc.absolute.x=Lb.x,Lc.absolute.y=Lb.y,Lc.position.x=Lc.absolute.x*Lc.scale.x+Lc.offset.x,Lc.position.y=Lc.absolute.y*Lc.scale.y+Lc.offset.y,Lc.sourceEvents.mousemove=La},Lc.mousedown=function(La){var Lb=Ld._getRelativeMousePosition(La,Lc.element,Lc.pixelRatio);La.changedTouches?(Lc.button=0,La.preventDefault()):Lc.button=La.button,Lc.absolute.x=Lb.x,Lc.absolute.y=Lb.y,Lc.position.x=Lc.absolute.x*Lc.scale.x+Lc.offset.x,Lc.position.y=Lc.absolute.y*Lc.scale.y+Lc.offset.y,Lc.mousedownPosition.x=Lc.position.x,Lc.mousedownPosition.y=Lc.position.y,Lc.sourceEvents.mousedown=La},Lc.mouseup=function(La){var Lb=Ld._getRelativeMousePosition(La,Lc.element,Lc.pixelRatio);La.changedTouches&&La.preventDefault(),Lc.button=-1,Lc.absolute.x=Lb.x,Lc.absolute.y=Lb.y,Lc.position.x=Lc.absolute.x*Lc.scale.x+Lc.offset.x,Lc.position.y=Lc.absolute.y*Lc.scale.y+Lc.offset.y,Lc.mouseupPosition.x=Lc.position.x,Lc.mouseupPosition.y=Lc.position.y,Lc.sourceEvents.mouseup=La},Lc.mouseout=function(La){var Lb=Ld._getRelativeMousePosition(La,Lc.element,Lc.pixelRatio);La.changedTouches&&La.preventDefault(),Lc.button=-1,Lc.absolute.x=Lb.x,Lc.absolute.y=Lb.y,Lc.position.x=Lc.absolute.x*Lc.scale.x+Lc.offset.x,Lc.position.y=Lc.absolute.y*Lc.scale.y+Lc.offset.y,Lc.mouseoutPosition.x=Lc.position.x,Lc.mouseoutPosition.y=Lc.position.y,Lc.sourceEvents.mouseout=La},Lc.mousewheel=function(La){Lc.wheelDelta=Math.max(-1,Math.min(1,La.wheelDelta||-La.detail)),La.preventDefault()},Ld.setElement(Lc,Lc.element),Lc},Ld.setElement=function(La,Lb){(La.element=Lb).addEventListener("mousemove",La.mousemove),Lb.addEventListener("mousedown",La.mousedown),Lb.addEventListener("mouseup",La.mouseup),Lb.addEventListener("mouseout",La.mouseout),Lb.addEventListener("mousewheel",La.mousewheel),Lb.addEventListener("DOMMouseScroll",La.mousewheel),Lb.addEventListener("touchmove",La.mousemove),Lb.addEventListener("touchstart",La.mousedown),Lb.addEventListener("touchend",La.mouseup),Lb.addEventListener("touchcancel",La.mouseup)},Ld.clearSourceEvents=function(La){La.sourceEvents.mousemove=null,La.sourceEvents.mousedown=null,La.sourceEvents.mouseup=null,La.sourceEvents.mouseout=null,La.sourceEvents.mousewheel=null,La.wheelDelta=0},Ld.setOffset=function(La,Lb){La.offset.x=Lb.x,La.offset.y=Lb.y,La.position.x=La.absolute.x*La.scale.x+La.offset.x,La.position.y=La.absolute.y*La.scale.y+La.offset.y},Ld.setScale=function(La,Lb){La.scale.x=Lb.x,La.scale.y=Lb.y,La.position.x=La.absolute.x*La.scale.x+La.offset.x,La.position.y=La.absolute.y*La.scale.y+La.offset.y},Ld._getRelativeMousePosition=function(La,Lb,Lc){var Ld,Le,Lf=Lb.getBoundingClientRect(),Lg=document.documentElement||document.body.parentNode||document.body,Lh=void 0!==window.pageXOffset?window.pageXOffset:Lg.scrollLeft,Li=void 0!==window.pageYOffset?window.pageYOffset:Lg.scrollTop,Lj=La.changedTouches;Lh=Lh||0,Li=Li||0,Le=Lj?(Ld=Lj[0].pageX-Lf.left-Lh,Lj[0].pageY-Lf.top-Li):(Ld=La.pageX-Lf.left-Lh,La.pageY-Lf.top-Li);var Lk=Lb.clientWidth||Lb.width,Ll=Lb.clientHeight||Lb.height;return{x:Ld/(Lk/(Lb.width||Lk)*Lc),y:Le/(Ll/(Lb.height||Ll)*Lc)}}},function(La,Lb,Lc){var LC={};La.exports=LC;var Ld=Lc(0),LD=Lc(8);LC.create=function(La){return Ld.extend({bodies:[],pairs:null},La)},LC.setBodies=function(La,Lb){La.bodies=Lb.slice(0)},LC.clear=function(La){La.bodies=[]},LC.collisions=function(La){var Lb,Lc,Ld=[],Le=La.pairs,Lf=La.bodies,Lg=Lf.length,Lh=LC.canCollide,Li=LD.collides;for(Lf.sort(LC._compareBoundsX),Lb=0;Lb<Lg;Lb++){var Lj=Lf[Lb],Lk=Lj.bounds,Ll=Lj.bounds.max.x,Lm=Lj.bounds.max.y,Ln=Lj.bounds.min.y,Lo=Lj.isStatic||Lj.isSleeping,Lp=Lj.parts.length,Lq=1===Lp;for(Lc=Lb+1;Lc<Lg;Lc++){var Lr=Lf[Lc];if((LB=Lr.bounds).min.x>Ll)break;if(!(Lm<LB.min.y||Ln>LB.max.y)&&(!Lo||!Lr.isStatic&&!Lr.isSleeping)&&Lh(Lj.collisionFilter,Lr.collisionFilter)){var Ls=Lr.parts.length;if(Lq&&1===Ls)(Lz=Li(Lj,Lr,Le))&&Ld.push(Lz);else for(var Lt=1<Ls?1:0,Lu=1<Lp?1:0;Lu<Lp;Lu++)for(var Lv=Lj.parts[Lu],Ly=(Lk=Lv.bounds,Lt);Ly<Ls;Ly++){var Lz,LA=Lr.parts[Ly],LB=LA.bounds;Lk.min.x>LB.max.x||Lk.max.x<LB.min.x||Lk.max.y<LB.min.y||Lk.min.y>LB.max.y||(Lz=Li(Lv,LA,Le))&&Ld.push(Lz)}}}}return Ld},LC.canCollide=function(La,Lb){return La.group===Lb.group&&0!==La.group?0<La.group:0!=(La.mask&Lb.category)&&0!=(Lb.mask&La.category)},LC._compareBoundsX=function(La,Lb){return La.bounds.min.x-Lb.bounds.min.x}},function(La,Lb,Lc){var Lh={};La.exports=Lh;var Li=Lc(0);Lh._registry={},Lh.register=function(La){if(Lh.isPlugin(La)||Li.warn("Plugin.register:",Lh.toString(La),"does not implement all required fields."),La.name in Lh._registry){var Lb=Lh._registry[La.name],Lc=Lh.versionParse(La.version).number,Ld=Lh.versionParse(Lb.version).number;Ld<Lc?(Li.warn("Plugin.register:",Lh.toString(Lb),"was upgraded to",Lh.toString(La)),Lh._registry[La.name]=La):Lc<Ld?Li.warn("Plugin.register:",Lh.toString(Lb),"can not be downgraded to",Lh.toString(La)):La!==Lb&&Li.warn("Plugin.register:",Lh.toString(La),"is already registered to different plugin object")}else Lh._registry[La.name]=La;return La},Lh.resolve=function(La){return Lh._registry[Lh.dependencyParse(La).name]},Lh.toString=function(La){return"string"==typeof La?La:(La.name||"anonymous")+"@"+(La.version||La.range||"0.0.0")},Lh.isPlugin=function(La){return La&&La.name&&La.version&&La.install},Lh.isUsed=function(La,Lb){return-1<La.used.indexOf(Lb)},Lh.isFor=function(La,Lb){var Lc=La.for&&Lh.dependencyParse(La.for);return!La.for||Lb.name===Lc.name&&Lh.versionSatisfies(Lb.version,Lc.range)},Lh.use=function(La,Lb){if(La.uses=(La.uses||[]).concat(Lb||[]),0!==La.uses.length){for(var Lc=Lh.dependencies(La),Ld=Li.topologicalSort(Lc),Le=[],Lf=0;Lf<Ld.length;Lf+=1)if(Ld[Lf]!==La.name){var Lg=Lh.resolve(Ld[Lf]);Lg?Lh.isUsed(La,Lg.name)||(Lh.isFor(Lg,La)||(Li.warn("Plugin.use:",Lh.toString(Lg),"is for",Lg.for,"but installed on",Lh.toString(La)+"."),Lg._warned=!0),Lg.install?Lg.install(La):(Li.warn("Plugin.use:",Lh.toString(Lg),"does not specify an install function."),Lg._warned=!0),Lg._warned?(Le.push("🔶 "+Lh.toString(Lg)),delete Lg._warned):Le.push("✅ "+Lh.toString(Lg)),La.used.push(Lg.name)):Le.push("❌ "+Ld[Lf])}0<Le.length&&Li.info(Le.join("  "))}else Li.warn("Plugin.use:",Lh.toString(La),"does not specify any dependencies to install.")},Lh.dependencies=function(Ld,La){var Le=Lh.dependencyParse(Ld),Lb=Le.name;if(!(Lb in(La=La||{}))){Ld=Lh.resolve(Ld)||Ld,La[Lb]=Li.map(Ld.uses||[],function(La){Lh.isPlugin(La)&&Lh.register(La);var Lb=Lh.dependencyParse(La),Lc=Lh.resolve(La);return Lc&&!Lh.versionSatisfies(Lc.version,Lb.range)?(Li.warn("Plugin.dependencies:",Lh.toString(Lc),"does not satisfy",Lh.toString(Lb),"used by",Lh.toString(Le)+"."),Lc._warned=!0,Ld._warned=!0):Lc||(Li.warn("Plugin.dependencies:",Lh.toString(La),"used by",Lh.toString(Le),"could not be resolved."),Ld._warned=!0),Lb.name});for(var Lc=0;Lc<La[Lb].length;Lc+=1)Lh.dependencies(La[Lb][Lc],La);return La}},Lh.dependencyParse=function(La){return Li.isString(La)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(La)||Li.warn("Plugin.dependencyParse:",La,"is not a valid dependency string."),{name:La.split("@")[0],range:La.split("@")[1]||"*"}):{name:La.name,range:La.range||La.version}},Lh.versionParse=function(La){var Lb=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;Lb.test(La)||Li.warn("Plugin.versionParse:",La,"is not a valid version or range.");var Lc=Lb.exec(La),Ld=Number(Lc[4]),Le=Number(Lc[5]),Lf=Number(Lc[6]);return{isRange:Boolean(Lc[1]||Lc[2]),version:Lc[3],range:La,operator:Lc[1]||Lc[2]||"",major:Ld,minor:Le,patch:Lf,parts:[Ld,Le,Lf],prerelease:Lc[7],number:1e8*Ld+1e4*Le+Lf}},Lh.versionSatisfies=function(La,Lb){Lb=Lb||"*";var Lc=Lh.versionParse(Lb),Ld=Lh.versionParse(La);if(Lc.isRange){if("*"===Lc.operator||"*"===La)return!0;if(">"===Lc.operator)return Ld.number>Lc.number;if(">="===Lc.operator)return Ld.number>=Lc.number;if("~"===Lc.operator)return Ld.major===Lc.major&&Ld.minor===Lc.minor&&Ld.patch>=Lc.patch;if("^"===Lc.operator)return 0<Lc.major?Ld.major===Lc.major&&Ld.number>=Lc.number:0<Lc.minor?Ld.minor===Lc.minor&&Ld.patch>=Lc.patch:Ld.patch===Lc.patch}return La===Lb||"*"===La}},function(La,Lb,Lc){var Lz={};La.exports=Lz;var LA=Lc(0),LB=Lc(5),LC=Lc(1),LD=Lc(4),LE=Lc(2),LF=Lc(13);!function(){Lz._goodFps=30,Lz._goodDelta=1e3/60,Lz.create=function(La){var Lb={controller:Lz,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!La.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},Lc=LA.extend(Lb,La);return Lc.canvas&&(Lc.canvas.width=Lc.options.width||Lc.canvas.width,Lc.canvas.height=Lc.options.height||Lc.canvas.height),Lc.mouse=La.mouse,Lc.engine=La.engine,Lc.canvas=Lc.canvas||Ld(Lc.options.width,Lc.options.height),Lc.context=Lc.canvas.getContext("2d"),Lc.textures={},Lc.bounds=Lc.bounds||{min:{x:0,y:0},max:{x:Lc.canvas.width,y:Lc.canvas.height}},Lc.options.showBroadphase=!1,1!==Lc.options.pixelRatio&&Lz.setPixelRatio(Lc,Lc.options.pixelRatio),LA.isElement(Lc.element)?Lc.element.appendChild(Lc.canvas):Lc.canvas.parentNode||LA.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),Lc},Lz.run=function(La){Laya.timer.clear(this,Lz.loop),Laya.timer.frameLoop(1,this,Lz.loop,[La])},Lz.loop=function(La){var Lb=LA.now();Lc(La,Lb),Lz.world(La,Lb),(La.options.showStats||La.options.showDebug)&&Lz.stats(La,La.context,Lb),(La.options.showPerformance||La.options.showDebug)&&Lz.performance(La,La.context,Lb)},Lz.stop=function(La){Laya.timer.clear(this,Lz.loop)},Lz.setPixelRatio=function(La,Lb){var Lc=La.options,Ld=La.canvas;"auto"===Lb&&(Lb=Le(Ld)),Lc.pixelRatio=Lb,Ld.setAttribute("data-pixel-ratio",Lb),Ld.width=Lc.width*Lb,Ld.height=Lc.height*Lb,Ld.style.width=Lc.width+"px",Ld.style.height=Lc.height+"px"},Lz.lookAt=function(La,Lb,Lc,Ld){Ld=void 0===Ld||Ld,Lb=LA.isArray(Lb)?Lb:[Lb],Lc=Lc||{x:0,y:0};for(var Le={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},Lf=0;Lf<Lb.length;Lf+=1){var Lg=Lb[Lf],Lh=Lg.bounds?Lg.bounds.min:Lg.min||Lg.position||Lg,Li=Lg.bounds?Lg.bounds.max:Lg.max||Lg.position||Lg;Lh&&Li&&(Lh.x<Le.min.x&&(Le.min.x=Lh.x),Li.x>Le.max.x&&(Le.max.x=Li.x),Lh.y<Le.min.y&&(Le.min.y=Lh.y),Li.y>Le.max.y&&(Le.max.y=Li.y))}var Lj=Le.max.x-Le.min.x+2*Lc.x,Lk=Le.max.y-Le.min.y+2*Lc.y,Ll=La.canvas.height,Lm=La.canvas.width/Ll,Ln=Lj/Lk,Lo=1,Lp=1;Lm<Ln?Lp=Ln/Lm:Lo=Lm/Ln,La.options.hasBounds=!0,La.bounds.min.x=Le.min.x,La.bounds.max.x=Le.min.x+Lj*Lo,La.bounds.min.y=Le.min.y,La.bounds.max.y=Le.min.y+Lk*Lp,Ld&&(La.bounds.min.x+=.5*Lj-Lj*Lo*.5,La.bounds.max.x+=.5*Lj-Lj*Lo*.5,La.bounds.min.y+=.5*Lk-Lk*Lp*.5,La.bounds.max.y+=.5*Lk-Lk*Lp*.5),La.bounds.min.x-=Lc.x,La.bounds.max.x-=Lc.x,La.bounds.min.y-=Lc.y,La.bounds.max.y-=Lc.y,La.mouse&&(LF.setScale(La.mouse,{x:(La.bounds.max.x-La.bounds.min.x)/La.canvas.width,y:(La.bounds.max.y-La.bounds.min.y)/La.canvas.height}),LF.setOffset(La.mouse,La.bounds.min))},Lz.startViewTransform=function(La){var Lb=La.bounds.max.x-La.bounds.min.x,Lc=La.bounds.max.y-La.bounds.min.y,Ld=Lb/La.options.width,Le=Lc/La.options.height;La.context.setTransform(La.options.pixelRatio/Ld,0,0,La.options.pixelRatio/Le,0,0),La.context.translate(-La.bounds.min.x,-La.bounds.min.y)},Lz.endViewTransform=function(La){La.context.setTransform(La.options.pixelRatio,0,0,La.options.pixelRatio,0,0)},Lz.world=function(La,Lb){var Lc,Ld=LA.now(),Le=La.engine,Lf=Le.world,Lg=La.canvas,Lh=La.context,Li=La.options,Lj=La.timing,Lk=LB.allBodies(Lf),Ll=LB.allConstraints(Lf),Lm=Li.wireframes?Li.wireframeBackground:Li.background,Ln=[],Lo=[],Lp={timestamp:Le.timing.timestamp};if(LD.trigger(La,"beforeRender",Lp),La.currentBackground!==Lm&&Ly(La,Lm),Lh.globalCompositeOperation="source-in",Lh.fillStyle="transparent",Lh.fillRect(0,0,Lg.width,Lg.height),Lh.globalCompositeOperation="source-over",Li.hasBounds){for(Lc=0;Lc<Lk.length;Lc++){var Lq=Lk[Lc];LC.overlaps(Lq.bounds,La.bounds)&&Ln.push(Lq)}for(Lc=0;Lc<Ll.length;Lc++){var Lr=Ll[Lc],Ls=Lr.bodyA,Lt=Lr.bodyB,Lu=Lr.pointA,Lv=Lr.pointB;Ls&&(Lu=LE.add(Ls.position,Lr.pointA)),Lt&&(Lv=LE.add(Lt.position,Lr.pointB)),Lu&&Lv&&((LC.contains(La.bounds,Lu)||LC.contains(La.bounds,Lv))&&Lo.push(Lr))}Lz.startViewTransform(La),La.mouse&&(LF.setScale(La.mouse,{x:(La.bounds.max.x-La.bounds.min.x)/La.options.width,y:(La.bounds.max.y-La.bounds.min.y)/La.options.height}),LF.setOffset(La.mouse,La.bounds.min))}else Lo=Ll,Ln=Lk,1!==La.options.pixelRatio&&La.context.setTransform(La.options.pixelRatio,0,0,La.options.pixelRatio,0,0);!Li.wireframes||Le.enableSleeping&&Li.showSleeping?Lz.bodies(La,Ln,Lh):(Li.showConvexHulls&&Lz.bodyConvexHulls(La,Ln,Lh),Lz.bodyWireframes(La,Ln,Lh)),Li.showBounds&&Lz.bodyBounds(La,Ln,Lh),(Li.showAxes||Li.showAngleIndicator)&&Lz.bodyAxes(La,Ln,Lh),Li.showPositions&&Lz.bodyPositions(La,Ln,Lh),Li.showVelocity&&Lz.bodyVelocity(La,Ln,Lh),Li.showIds&&Lz.bodyIds(La,Ln,Lh),Li.showSeparations&&Lz.separations(La,Le.pairs.list,Lh),Li.showCollisions&&Lz.collisions(La,Le.pairs.list,Lh),Li.showVertexNumbers&&Lz.vertexNumbers(La,Ln,Lh),Li.showMousePosition&&Lz.mousePosition(La,La.mouse,Lh),Lz.constraints(Lo,Lh),Li.hasBounds&&Lz.endViewTransform(La),LD.trigger(La,"afterRender",Lp),Lj.lastElapsed=LA.now()-Ld},Lz.stats=function(La,Lb,Lc){for(var Ld=La.engine,Le=Ld.world,Lf=LB.allBodies(Le),Lg=0,Lh=0,Li=0;Li<Lf.length;Li+=1)Lg+=Lf[Li].parts.length;var Lj={Part:Lg,Body:Lf.length,Cons:LB.allConstraints(Le).length,Comp:LB.allComposites(Le).length,Pair:Ld.pairs.list.length};for(var Lk in Lb.fillStyle="#0e0f19",Lb.fillRect(Lh,0,302.5,44),Lb.font="12px Arial",Lb.textBaseline="top",Lb.textAlign="right",Lj){var Ll=Lj[Lk];Lb.fillStyle="#aaa",Lb.fillText(Lk,Lh+55,8),Lb.fillStyle="#eee",Lb.fillText(Ll,Lh+55,26),Lh+=55}},Lz.performance=function(La,Lb){var Lc=La.engine,Ld=La.timing,Le=Ld.deltaHistory,Lf=Ld.elapsedHistory,Lg=Ld.timestampElapsedHistory,Lh=Ld.engineDeltaHistory,Li=Ld.engineElapsedHistory,Lj=Lc.timing.lastDelta,Lk=Lq(Le),Ll=Lq(Lf),Lm=Lq(Lh),Ln=Lq(Li),Lo=Lq(Lg)/Lk||0,Lp=1e3/Lk||0;Lb.fillStyle="#0e0f19",Lb.fillRect(0,50,370,34),Lz.status(Lb,10,69,60,4,Le.length,Math.round(Lp)+" fps",Lp/Lz._goodFps,function(La){return Le[La]/Lk-1}),Lz.status(Lb,82,69,60,4,Lh.length,Lj.toFixed(2)+" dt",Lz._goodDelta/Lj,function(La){return Lh[La]/Lm-1}),Lz.status(Lb,154,69,60,4,Li.length,Ln.toFixed(2)+" ut",1-Ln/Lz._goodFps,function(La){return Li[La]/Ln-1}),Lz.status(Lb,226,69,60,4,Lf.length,Ll.toFixed(2)+" rt",1-Ll/Lz._goodFps,function(La){return Lf[La]/Ll-1}),Lz.status(Lb,298,69,60,4,Lg.length,Lo.toFixed(2)+" x",Lo*Lo*Lo,function(La){return(Lg[La]/Le[La]/Lo||0)-1})},Lz.status=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li){La.strokeStyle="#888",La.fillStyle="#444",La.lineWidth=1,La.fillRect(Lb,Lc+7,Ld,1),La.beginPath(),La.moveTo(Lb,Lc+7-Le*LA.clamp(.4*Li(0),-2,2));for(var Lj=0;Lj<Ld;Lj+=1)La.lineTo(Lb+Lj,Lc+7-(Lj<Lf?Le*LA.clamp(.4*Li(Lj),-2,2):0));La.stroke(),La.fillStyle="hsl("+LA.clamp(25+95*Lh,0,120)+",100%,60%)",La.fillRect(Lb,Lc-7,4,4),La.font="12px Arial",La.textBaseline="middle",La.textAlign="right",La.fillStyle="#eee",La.fillText(Lg,Lb+Ld,Lc-5)},Lz.constraints=function(La,Lb){for(var Lc=Lb,Ld=0;Ld<La.length;Ld++){var Le=La[Ld];if(Le.render.visible&&Le.pointA&&Le.pointB){var Lf,Lg,Lh=Le.bodyA,Li=Le.bodyB;if(Lf=Lh?LE.add(Lh.position,Le.pointA):Le.pointA,"pin"===Le.render.type)Lc.beginPath(),Lc.arc(Lf.x,Lf.y,3,0,2*Math.PI),Lc.closePath();else{if(Lg=Li?LE.add(Li.position,Le.pointB):Le.pointB,Lc.beginPath(),Lc.moveTo(Lf.x,Lf.y),"spring"===Le.render.type)for(var Lj,Lk=LE.sub(Lg,Lf),Ll=LE.perp(LE.normalise(Lk)),Lm=Math.ceil(LA.clamp(Le.length/5,12,20)),Ln=1;Ln<Lm;Ln+=1)Lj=Ln%2==0?1:-1,Lc.lineTo(Lf.x+Lk.x*(Ln/Lm)+Ll.x*Lj*4,Lf.y+Lk.y*(Ln/Lm)+Ll.y*Lj*4);Lc.lineTo(Lg.x,Lg.y)}Le.render.lineWidth&&(Lc.lineWidth=Le.render.lineWidth,Lc.strokeStyle=Le.render.strokeStyle,Lc.stroke()),Le.render.anchors&&(Lc.fillStyle=Le.render.strokeStyle,Lc.beginPath(),Lc.arc(Lf.x,Lf.y,3,0,2*Math.PI),Lc.arc(Lg.x,Lg.y,3,0,2*Math.PI),Lc.closePath(),Lc.fill())}}},Lz.bodies=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=Lc,Li=(La.engine,La.options),Lj=Li.showInternalEdges||!Li.wireframes;for(Lf=0;Lf<Lb.length;Lf++)if((Ld=Lb[Lf]).render.visible)for(Lg=1<Ld.parts.length?1:0;Lg<Ld.parts.length;Lg++)if((Le=Ld.parts[Lg]).render.visible){if(Li.showSleeping&&Ld.isSleeping?Lh.globalAlpha=.5*Le.render.opacity:1!==Le.render.opacity&&(Lh.globalAlpha=Le.render.opacity),Le.render.sprite&&Le.render.sprite.texture&&!Li.wireframes){var Lk=Le.render.sprite,Ll=Ln(La,Lk.texture);Lh.translate(Le.position.x,Le.position.y),Lh.rotate(Le.angle),Lh.drawImage(Ll,Ll.width*-Lk.xOffset*Lk.xScale,Ll.height*-Lk.yOffset*Lk.yScale,Ll.width*Lk.xScale,Ll.height*Lk.yScale),Lh.rotate(-Le.angle),Lh.translate(-Le.position.x,-Le.position.y)}else{if(Le.circleRadius)Lh.beginPath(),Lh.arc(Le.position.x,Le.position.y,Le.circleRadius,0,2*Math.PI);else{Lh.beginPath(),Lh.moveTo(Le.vertices[0].x,Le.vertices[0].y);for(var Lm=1;Lm<Le.vertices.length;Lm++)!Le.vertices[Lm-1].isInternal||Lj?Lh.lineTo(Le.vertices[Lm].x,Le.vertices[Lm].y):Lh.moveTo(Le.vertices[Lm].x,Le.vertices[Lm].y),Le.vertices[Lm].isInternal&&!Lj&&Lh.moveTo(Le.vertices[(Lm+1)%Le.vertices.length].x,Le.vertices[(Lm+1)%Le.vertices.length].y);Lh.lineTo(Le.vertices[0].x,Le.vertices[0].y),Lh.closePath()}Li.wireframes?(Lh.lineWidth=1,Lh.strokeStyle="#bbb",Lh.stroke()):(Lh.fillStyle=Le.render.fillStyle,Le.render.lineWidth&&(Lh.lineWidth=Le.render.lineWidth,Lh.strokeStyle=Le.render.strokeStyle,Lh.stroke()),Lh.fill())}Lh.globalAlpha=1}},Lz.bodyWireframes=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh,Li=Lc,Lj=La.options.showInternalEdges;for(Li.beginPath(),Lf=0;Lf<Lb.length;Lf++)if((Ld=Lb[Lf]).render.visible)for(Lh=1<Ld.parts.length?1:0;Lh<Ld.parts.length;Lh++){for(Le=Ld.parts[Lh],Li.moveTo(Le.vertices[0].x,Le.vertices[0].y),Lg=1;Lg<Le.vertices.length;Lg++)!Le.vertices[Lg-1].isInternal||Lj?Li.lineTo(Le.vertices[Lg].x,Le.vertices[Lg].y):Li.moveTo(Le.vertices[Lg].x,Le.vertices[Lg].y),Le.vertices[Lg].isInternal&&!Lj&&Li.moveTo(Le.vertices[(Lg+1)%Le.vertices.length].x,Le.vertices[(Lg+1)%Le.vertices.length].y);Li.lineTo(Le.vertices[0].x,Le.vertices[0].y)}Li.lineWidth=1,Li.strokeStyle="#bbb",Li.stroke()},Lz.bodyConvexHulls=function(La,Lb,Lc){var Ld,Le,Lf,Lg=Lc;for(Lg.beginPath(),Le=0;Le<Lb.length;Le++)if((Ld=Lb[Le]).render.visible&&1!==Ld.parts.length){for(Lg.moveTo(Ld.vertices[0].x,Ld.vertices[0].y),Lf=1;Lf<Ld.vertices.length;Lf++)Lg.lineTo(Ld.vertices[Lf].x,Ld.vertices[Lf].y);Lg.lineTo(Ld.vertices[0].x,Ld.vertices[0].y)}Lg.lineWidth=1,Lg.strokeStyle="rgba(255,255,255,0.2)",Lg.stroke()},Lz.vertexNumbers=function(La,Lb,Lc){var Ld,Le,Lf,Lg=Lc;for(Ld=0;Ld<Lb.length;Ld++){var Lh=Lb[Ld].parts;for(Lf=1<Lh.length?1:0;Lf<Lh.length;Lf++){var Li=Lh[Lf];for(Le=0;Le<Li.vertices.length;Le++)Lg.fillStyle="rgba(255,255,255,0.2)",Lg.fillText(Ld+"_"+Le,Li.position.x+.8*(Li.vertices[Le].x-Li.position.x),Li.position.y+.8*(Li.vertices[Le].y-Li.position.y))}}},Lz.mousePosition=function(La,Lb,Lc){var Ld=Lc;Ld.fillStyle="rgba(255,255,255,0.8)",Ld.fillText(Lb.position.x+"  "+Lb.position.y,Lb.position.x+5,Lb.position.y-5)},Lz.bodyBounds=function(La,Lb,Lc){var Ld=Lc,Le=(La.engine,La.options);Ld.beginPath();for(var Lf=0;Lf<Lb.length;Lf++){if(Lb[Lf].render.visible)for(var Lg=Lb[Lf].parts,Lh=1<Lg.length?1:0;Lh<Lg.length;Lh++){var Li=Lg[Lh];Ld.rect(Li.bounds.min.x,Li.bounds.min.y,Li.bounds.max.x-Li.bounds.min.x,Li.bounds.max.y-Li.bounds.min.y)}}Le.wireframes?Ld.strokeStyle="rgba(255,255,255,0.08)":Ld.strokeStyle="rgba(0,0,0,0.1)",Ld.lineWidth=1,Ld.stroke()},Lz.bodyAxes=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=Lc,Li=(La.engine,La.options);for(Lh.beginPath(),Le=0;Le<Lb.length;Le++){var Lj=Lb[Le],Lk=Lj.parts;if(Lj.render.visible)if(Li.showAxes)for(Lf=1<Lk.length?1:0;Lf<Lk.length;Lf++)for(Ld=Lk[Lf],Lg=0;Lg<Ld.axes.length;Lg++){var Ll=Ld.axes[Lg];Lh.moveTo(Ld.position.x,Ld.position.y),Lh.lineTo(Ld.position.x+20*Ll.x,Ld.position.y+20*Ll.y)}else for(Lf=1<Lk.length?1:0;Lf<Lk.length;Lf++)for(Ld=Lk[Lf],Lg=0;Lg<Ld.axes.length;Lg++)Lh.moveTo(Ld.position.x,Ld.position.y),Lh.lineTo((Ld.vertices[0].x+Ld.vertices[Ld.vertices.length-1].x)/2,(Ld.vertices[0].y+Ld.vertices[Ld.vertices.length-1].y)/2)}Li.wireframes?(Lh.strokeStyle="indianred",Lh.lineWidth=1):(Lh.strokeStyle="rgba(255, 255, 255, 0.4)",Lh.globalCompositeOperation="overlay",Lh.lineWidth=2),Lh.stroke(),Lh.globalCompositeOperation="source-over"},Lz.bodyPositions=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=Lc,Li=(La.engine,La.options);for(Lh.beginPath(),Lf=0;Lf<Lb.length;Lf++)if((Ld=Lb[Lf]).render.visible)for(Lg=0;Lg<Ld.parts.length;Lg++)Le=Ld.parts[Lg],Lh.arc(Le.position.x,Le.position.y,3,0,2*Math.PI,!1),Lh.closePath();for(Li.wireframes?Lh.fillStyle="indianred":Lh.fillStyle="rgba(0,0,0,0.5)",Lh.fill(),Lh.beginPath(),Lf=0;Lf<Lb.length;Lf++)(Ld=Lb[Lf]).render.visible&&(Lh.arc(Ld.positionPrev.x,Ld.positionPrev.y,2,0,2*Math.PI,!1),Lh.closePath());Lh.fillStyle="rgba(255,165,0,0.8)",Lh.fill()},Lz.bodyVelocity=function(La,Lb,Lc){var Ld=Lc;Ld.beginPath();for(var Le=0;Le<Lb.length;Le++){var Lf=Lb[Le];Lf.render.visible&&(Ld.moveTo(Lf.position.x,Lf.position.y),Ld.lineTo(Lf.position.x+2*(Lf.position.x-Lf.positionPrev.x),Lf.position.y+2*(Lf.position.y-Lf.positionPrev.y)))}Ld.lineWidth=3,Ld.strokeStyle="cornflowerblue",Ld.stroke()},Lz.bodyIds=function(La,Lb,Lc){var Ld,Le,Lf=Lc;for(Ld=0;Ld<Lb.length;Ld++)if(Lb[Ld].render.visible){var Lg=Lb[Ld].parts;for(Le=1<Lg.length?1:0;Le<Lg.length;Le++){var Lh=Lg[Le];Lf.font="12px Arial",Lf.fillStyle="rgba(255,255,255,0.5)",Lf.fillText(Lh.id,Lh.position.x+10,Lh.position.y-10)}}},Lz.collisions=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=Lc,Li=La.options;for(Lh.beginPath(),Lf=0;Lf<Lb.length;Lf++)if((Ld=Lb[Lf]).isActive)for(Le=Ld.collision,Lg=0;Lg<Ld.activeContacts.length;Lg++){var Lj=Ld.activeContacts[Lg].vertex;Lh.rect(Lj.x-1.5,Lj.y-1.5,3.5,3.5)}for(Li.wireframes?Lh.fillStyle="rgba(255,255,255,0.7)":Lh.fillStyle="orange",Lh.fill(),Lh.beginPath(),Lf=0;Lf<Lb.length;Lf++)if((Ld=Lb[Lf]).isActive&&(Le=Ld.collision,0<Ld.activeContacts.length)){var Lk=Ld.activeContacts[0].vertex.x,Ll=Ld.activeContacts[0].vertex.y;2===Ld.activeContacts.length&&(Lk=(Ld.activeContacts[0].vertex.x+Ld.activeContacts[1].vertex.x)/2,Ll=(Ld.activeContacts[0].vertex.y+Ld.activeContacts[1].vertex.y)/2),Le.bodyB===Le.supports[0].body||!0===Le.bodyA.isStatic?Lh.moveTo(Lk-8*Le.normal.x,Ll-8*Le.normal.y):Lh.moveTo(Lk+8*Le.normal.x,Ll+8*Le.normal.y),Lh.lineTo(Lk,Ll)}Li.wireframes?Lh.strokeStyle="rgba(255,165,0,0.7)":Lh.strokeStyle="orange",Lh.lineWidth=1,Lh.stroke()},Lz.separations=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh,Li=Lc,Lj=La.options;for(Li.beginPath(),Lh=0;Lh<Lb.length;Lh++)if((Ld=Lb[Lh]).isActive){Lf=(Le=Ld.collision).bodyA;var Lk=1;(Lg=Le.bodyB).isStatic||Lf.isStatic||(Lk=.5),Lg.isStatic&&(Lk=0),Li.moveTo(Lg.position.x,Lg.position.y),Li.lineTo(Lg.position.x-Le.penetration.x*Lk,Lg.position.y-Le.penetration.y*Lk),Lk=1,Lg.isStatic||Lf.isStatic||(Lk=.5),Lf.isStatic&&(Lk=0),Li.moveTo(Lf.position.x,Lf.position.y),Li.lineTo(Lf.position.x+Le.penetration.x*Lk,Lf.position.y+Le.penetration.y*Lk)}Lj.wireframes?Li.strokeStyle="rgba(255,165,0,0.5)":Li.strokeStyle="orange",Li.stroke()},Lz.inspector=function(La,Lb){La.engine;var Lc,Ld=La.selected,Le=La.render,Lf=Le.options;if(Lf.hasBounds){var Lg=Le.bounds.max.x-Le.bounds.min.x,Lh=Le.bounds.max.y-Le.bounds.min.y,Li=Lg/Le.options.width,Lj=Lh/Le.options.height;Lb.scale(1/Li,1/Lj),Lb.translate(-Le.bounds.min.x,-Le.bounds.min.y)}for(var Lk=0;Lk<Ld.length;Lk++){var Ll=Ld[Lk].data;switch(Lb.translate(.5,.5),Lb.lineWidth=1,Lb.strokeStyle="rgba(255,165,0,0.9)",Lb.setLineDash([1,2]),Ll.type){case"body":Lc=Ll.bounds,Lb.beginPath(),Lb.rect(Math.floor(Lc.min.x-3),Math.floor(Lc.min.y-3),Math.floor(Lc.max.x-Lc.min.x+6),Math.floor(Lc.max.y-Lc.min.y+6)),Lb.closePath(),Lb.stroke();break;case"constraint":var Lm=Ll.pointA;Ll.bodyA&&(Lm=Ll.pointB),Lb.beginPath(),Lb.arc(Lm.x,Lm.y,10,0,2*Math.PI),Lb.closePath(),Lb.stroke()}Lb.setLineDash([]),Lb.translate(-.5,-.5)}null!==La.selectStart&&(Lb.translate(.5,.5),Lb.lineWidth=1,Lb.strokeStyle="rgba(255,165,0,0.6)",Lb.fillStyle="rgba(255,165,0,0.1)",Lc=La.selectBounds,Lb.beginPath(),Lb.rect(Math.floor(Lc.min.x),Math.floor(Lc.min.y),Math.floor(Lc.max.x-Lc.min.x),Math.floor(Lc.max.y-Lc.min.y)),Lb.closePath(),Lb.stroke(),Lb.fill(),Lb.translate(-.5,-.5)),Lf.hasBounds&&Lb.setTransform(1,0,0,1,0,0)};var Lc=function(La,Lb){var Lc=La.engine,Ld=La.timing,Le=Ld.historySize,Lf=Lc.timing.timestamp;Ld.delta=Lb-Ld.lastTime||Lz._goodDelta,Ld.lastTime=Lb,Ld.timestampElapsed=Lf-Ld.lastTimestamp||0,Ld.lastTimestamp=Lf,Ld.deltaHistory.unshift(Ld.delta),Ld.deltaHistory.length=Math.min(Ld.deltaHistory.length,Le),Ld.engineDeltaHistory.unshift(Lc.timing.lastDelta),Ld.engineDeltaHistory.length=Math.min(Ld.engineDeltaHistory.length,Le),Ld.timestampElapsedHistory.unshift(Ld.timestampElapsed),Ld.timestampElapsedHistory.length=Math.min(Ld.timestampElapsedHistory.length,Le),Ld.engineElapsedHistory.unshift(Lc.timing.lastElapsed),Ld.engineElapsedHistory.length=Math.min(Ld.engineElapsedHistory.length,Le),Ld.elapsedHistory.unshift(Ld.lastElapsed),Ld.elapsedHistory.length=Math.min(Ld.elapsedHistory.length,Le)},Lq=function(La){for(var Lb=0,Lc=0;Lc<La.length;Lc+=1)Lb+=La[Lc];return Lb/La.length||0},Ld=function(La,Lb){var Lc=document.createElement("canvas");return Lc.width=La,Lc.height=Lb,Lc.oncontextmenu=function(){return!1},Lc.onselectstart=function(){return!1},Lc},Le=function(La){var Lb=La.getContext("2d");return(window.devicePixelRatio||1)/(Lb.webkitBackingStorePixelRatio||Lb.mozBackingStorePixelRatio||Lb.msBackingStorePixelRatio||Lb.oBackingStorePixelRatio||Lb.backingStorePixelRatio||1)},Ln=function(La,Lb){var Lc=La.textures[Lb];return Lc||((Lc=La.textures[Lb]=new Image).src=Lb,Lc)},Ly=function(La,Lb){var Lc=Lb;/(jpg|gif|png)$/.test(Lb)&&(Lc="url("+Lb+")"),La.canvas.style.background=Lc,La.canvas.style.backgroundSize="contain",La.currentBackground=Lb}}()},function(La,Lb){var Lc={};(La.exports=Lc).create=function(La){return{vertex:La,normalImpulse:0,tangentImpulse:0}}},function(La,Lb,Lc){var Lo={};La.exports=Lo;var Lp=Lc(7),Lq=Lc(19),Lr=Lc(14),Ls=Lc(20),Lt=Lc(4),Lu=Lc(5),Lv=Lc(10),Ly=Lc(0),Lh=Lc(6);Lo.create=function(La){La=La||{};var Lb=Ly.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},La);return Lb.world=La.world||Lu.create({label:"World"}),Lb.pairs=La.pairs||Ls.create(),Lb.detector=La.detector||Lr.create(),Lb.grid={buckets:[]},Lb.world.gravity=Lb.gravity,Lb.broadphase=Lb.grid,Lb.metrics={},Lb},Lo.update=function(La,Lb,Lc){var Ld=Ly.now();Lb=Lb||1e3/60,Lc=Lc||1;var Le,Lf=La.world,Lg=La.detector,Lh=La.pairs,Li=La.timing,Lj=Li.timestamp;Li.timestamp+=Lb*Li.timeScale,Li.lastDelta=Lb*Li.timeScale;var Lk={timestamp:Li.timestamp};Lt.trigger(La,"beforeUpdate",Lk);var Ll=Lu.allBodies(Lf),Lm=Lu.allConstraints(Lf);for(Lf.isModified&&Lr.setBodies(Lg,Ll),Lf.isModified&&Lu.setModified(Lf,!1,!1,!0),La.enableSleeping&&Lp.update(Ll,Li.timeScale),Lo._bodiesApplyGravity(Ll,La.gravity),Lo._bodiesUpdate(Ll,Lb,Li.timeScale,Lc,Lf.bounds),Lv.preSolveAll(Ll),Le=0;Le<La.constraintIterations;Le++)Lv.solveAll(Lm,Li.timeScale);Lv.postSolveAll(Ll),Lg.pairs=La.pairs;var Ln=Lr.collisions(Lg);for(Ls.update(Lh,Ln,Lj),La.enableSleeping&&Lp.afterCollisions(Lh.list,Li.timeScale),0<Lh.collisionStart.length&&Lt.trigger(La,"collisionStart",{pairs:Lh.collisionStart}),Lq.preSolvePosition(Lh.list),Le=0;Le<La.positionIterations;Le++)Lq.solvePosition(Lh.list,Li.timeScale);for(Lq.postSolvePosition(Ll),Lv.preSolveAll(Ll),Le=0;Le<La.constraintIterations;Le++)Lv.solveAll(Lm,Li.timeScale);for(Lv.postSolveAll(Ll),Lq.preSolveVelocity(Lh.list),Le=0;Le<La.velocityIterations;Le++)Lq.solveVelocity(Lh.list,Li.timeScale);return 0<Lh.collisionActive.length&&Lt.trigger(La,"collisionActive",{pairs:Lh.collisionActive}),0<Lh.collisionEnd.length&&Lt.trigger(La,"collisionEnd",{pairs:Lh.collisionEnd}),Lo._bodiesClearForces(Ll),Lt.trigger(La,"afterUpdate",Lk),La.timing.lastElapsed=Ly.now()-Ld,La},Lo.merge=function(La,Lb){if(Ly.extend(La,Lb),Lb.world){La.world=Lb.world,Lo.clear(La);for(var Lc=Lu.allBodies(La.world),Ld=0;Ld<Lc.length;Ld++){var Le=Lc[Ld];Lp.set(Le,!1),Le.id=Ly.nextId()}}},Lo.clear=function(La){Ls.clear(La.pairs),Lr.clear(La.detector)},Lo._bodiesClearForces=function(La){for(var Lb=0;Lb<La.length;Lb++){var Lc=La[Lb];Lc.force.x=0,Lc.force.y=0,Lc.torque=0}},Lo._bodiesApplyGravity=function(La,Lb){var Lc=void 0!==Lb.scale?Lb.scale:.001;if((0!==Lb.x||0!==Lb.y)&&0!==Lc)for(var Ld=0;Ld<La.length;Ld++){var Le=La[Ld];Le.isStatic||Le.isSleeping||(Le.force.y+=Le.mass*Lb.y*Lc,Le.force.x+=Le.mass*Lb.x*Lc)}},Lo._bodiesUpdate=function(La,Lb,Lc,Ld,Le){for(var Lf=0;Lf<La.length;Lf++){var Lg=La[Lf];Lg.isStatic||Lg.isSleeping||Lh.update(Lg,Lb,Lc,Ld)}}},function(La,Lb,Lc){var L$={};La.exports=L$;var Ln=Lc(3),Lo=Lc(1);L$._restingThresh=4,L$._restingThreshTangent=6,L$._positionDampen=.9,L$._positionWarming=.8,L$._frictionNormalMultiplier=5,L$.preSolvePosition=function(La){var Lb,Lc,Ld,Le=La.length;for(Lb=0;Lb<Le;Lb++)(Lc=La[Lb]).isActive&&(Ld=Lc.activeContacts.length,Lc.collision.parentA.totalContacts+=Ld,Lc.collision.parentB.totalContacts+=Ld)},L$.solvePosition=function(La,Lb){var Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk=L$._positionDampen,Ll=La.length;for(Lc=0;Lc<Ll;Lc++)(Ld=La[Lc]).isActive&&!Ld.isSensor&&(Lf=(Le=Ld.collision).parentA,Lg=Le.parentB,Lh=Le.normal,Ld.separation=Lh.x*(Lg.positionImpulse.x+Le.penetration.x-Lf.positionImpulse.x)+Lh.y*(Lg.positionImpulse.y+Le.penetration.y-Lf.positionImpulse.y));for(Lc=0;Lc<Ll;Lc++)(Ld=La[Lc]).isActive&&!Ld.isSensor&&(Lf=(Le=Ld.collision).parentA,Lg=Le.parentB,Lh=Le.normal,Lj=(Ld.separation-Ld.slop)*Lb,(Lf.isStatic||Lg.isStatic)&&(Lj*=2),Lf.isStatic||Lf.isSleeping||(Li=Lk/Lf.totalContacts,Lf.positionImpulse.x+=Lh.x*Lj*Li,Lf.positionImpulse.y+=Lh.y*Lj*Li),Lg.isStatic||Lg.isSleeping||(Li=Lk/Lg.totalContacts,Lg.positionImpulse.x-=Lh.x*Lj*Li,Lg.positionImpulse.y-=Lh.y*Lj*Li))},L$.postSolvePosition=function(La){for(var Lb=L$._positionWarming,Lc=La.length,Ld=Ln.translate,Le=Lo.update,Lf=0;Lf<Lc;Lf++){var Lg=La[Lf],Lh=Lg.positionImpulse,Li=Lh.x,Lj=Lh.y,Lk=Lg.velocity;if((Lg.totalContacts=0)!==Li||0!==Lj){for(var Ll=0;Ll<Lg.parts.length;Ll++){var Lm=Lg.parts[Ll];Ld(Lm.vertices,Lh),Le(Lm.bounds,Lm.vertices,Lk),Lm.position.x+=Li,Lm.position.y+=Lj}Lg.positionPrev.x+=Li,Lg.positionPrev.y+=Lj,Li*Lk.x+Lj*Lk.y<0?(Lh.x=0,Lh.y=0):(Lh.x*=Lb,Lh.y*=Lb)}}},L$.preSolveVelocity=function(La){var Lb,Lc,Ld=La.length;for(Lb=0;Lb<Ld;Lb++){var Le=La[Lb];if(Le.isActive&&!Le.isSensor){var Lf=Le.activeContacts,Lg=Lf.length,Lh=Le.collision,Li=Lh.parentA,Lj=Lh.parentB,Lk=Lh.normal,Ll=Lh.tangent;for(Lc=0;Lc<Lg;Lc++){var Lm=Lf[Lc],Ln=Lm.vertex,Lo=Lm.normalImpulse,Lp=Lm.tangentImpulse;if(0!==Lo||0!==Lp){var Lq=Lk.x*Lo+Ll.x*Lp,Lr=Lk.y*Lo+Ll.y*Lp;Li.isStatic||Li.isSleeping||(Li.positionPrev.x+=Lq*Li.inverseMass,Li.positionPrev.y+=Lr*Li.inverseMass,Li.anglePrev+=Li.inverseInertia*((Ln.x-Li.position.x)*Lr-(Ln.y-Li.position.y)*Lq)),Lj.isStatic||Lj.isSleeping||(Lj.positionPrev.x-=Lq*Lj.inverseMass,Lj.positionPrev.y-=Lr*Lj.inverseMass,Lj.anglePrev-=Lj.inverseInertia*((Ln.x-Lj.position.x)*Lr-(Ln.y-Lj.position.y)*Lq))}}}}},L$.solveVelocity=function(La,Lb){var Lc,Ld,Le,Lf,Lg=Lb*Lb,Lh=L$._restingThresh*Lg,Li=L$._frictionNormalMultiplier,Lj=L$._restingThreshTangent*Lg,Lk=Number.MAX_VALUE,Ll=La.length;for(Le=0;Le<Ll;Le++){var Lm=La[Le];if(Lm.isActive&&!Lm.isSensor){var Ln=Lm.collision,Lo=Ln.parentA,Lp=Ln.parentB,Lq=Lo.velocity,Lr=Lp.velocity,Ls=Ln.normal.x,Lt=Ln.normal.y,Lu=Ln.tangent.x,Lv=Ln.tangent.y,Ly=Lm.activeContacts,Lz=Ly.length,LA=1/Lz,LB=Lo.inverseMass+Lp.inverseMass,LC=Lm.friction*Lm.frictionStatic*Li*Lg;for(Lq.x=Lo.position.x-Lo.positionPrev.x,Lq.y=Lo.position.y-Lo.positionPrev.y,Lr.x=Lp.position.x-Lp.positionPrev.x,Lr.y=Lp.position.y-Lp.positionPrev.y,Lo.angularVelocity=Lo.angle-Lo.anglePrev,Lp.angularVelocity=Lp.angle-Lp.anglePrev,Lf=0;Lf<Lz;Lf++){var LD=Ly[Lf],LE=LD.vertex,LF=LE.x-Lo.position.x,LG=LE.y-Lo.position.y,LH=LE.x-Lp.position.x,LI=LE.y-Lp.position.y,LJ=Lq.x-LG*Lo.angularVelocity,LK=Lq.y+LF*Lo.angularVelocity,LL=LJ-(Lr.x-LI*Lp.angularVelocity),LM=LK-(Lr.y+LH*Lp.angularVelocity),LN=Ls*LL+Lt*LM,LO=Lu*LL+Lv*LM,LP=Lm.separation+LN,LQ=Math.min(LP,1),LR=(LQ=LP<0?0:LQ)*LC;LR<LO||LR<-LO?(Ld=0<LO?LO:-LO,(Lc=Lm.friction*(0<LO?1:-1)*Lg)<-Ld?Lc=-Ld:Ld<Lc&&(Lc=Ld)):(Lc=LO,Ld=Lk);var LS=LF*Lt-LG*Ls,LT=LH*Lt-LI*Ls,LU=LA/(LB+Lo.inverseInertia*LS*LS+Lp.inverseInertia*LT*LT),LV=(1+Lm.restitution)*LN*LU;if(Lc*=LU,Lh<LN*LN&&LN<0)LD.normalImpulse=0;else{var LW=LD.normalImpulse;LD.normalImpulse+=LV,LD.normalImpulse=Math.min(LD.normalImpulse,0),LV=LD.normalImpulse-LW}if(Lj<LO*LO)LD.tangentImpulse=0;else{var LX=LD.tangentImpulse;LD.tangentImpulse+=Lc,LD.tangentImpulse<-Ld&&(LD.tangentImpulse=-Ld),LD.tangentImpulse>Ld&&(LD.tangentImpulse=Ld),Lc=LD.tangentImpulse-LX}var LY=Ls*LV+Lu*Lc,LZ=Lt*LV+Lv*Lc;Lo.isStatic||Lo.isSleeping||(Lo.positionPrev.x+=LY*Lo.inverseMass,Lo.positionPrev.y+=LZ*Lo.inverseMass,Lo.anglePrev+=(LF*LZ-LG*LY)*Lo.inverseInertia),Lp.isStatic||Lp.isSleeping||(Lp.positionPrev.x-=LY*Lp.inverseMass,Lp.positionPrev.y-=LZ*Lp.inverseMass,Lp.anglePrev-=(LH*LZ-LI*LY)*Lp.inverseInertia)}}}}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Lp=Lc(9),Le=Lc(0);Ld.create=function(La){return Le.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},La)},Ld.update=function(La,Lb,Lc){var Ld,Le,Lf,Lg,Lh=La.list,Li=Lh.length,Lj=La.table,Lk=Lb.length,Ll=La.collisionStart,Lm=La.collisionEnd,Ln=La.collisionActive;for(Ll.length=0,Lm.length=0,Lg=Ln.length=0;Lg<Li;Lg++)Lh[Lg].confirmedActive=!1;for(Lg=0;Lg<Lk;Lg++)(Lf=(Ld=Lb[Lg]).pair)?(Lf.isActive?Ln.push(Lf):Ll.push(Lf),Lp.update(Lf,Ld,Lc),Lf.confirmedActive=!0):(Lj[(Lf=Lp.create(Ld,Lc)).id]=Lf,Ll.push(Lf),Lh.push(Lf));var Lo=[];for(Li=Lh.length,Lg=0;Lg<Li;Lg++)(Lf=Lh[Lg]).confirmedActive||(Lp.setActive(Lf,!1,Lc),Lm.push(Lf),Lf.collision.bodyA.isSleeping||Lf.collision.bodyB.isSleeping||Lo.push(Lg));for(Lg=0;Lg<Lo.length;Lg++)Lf=Lh[Le=Lo[Lg]-Lg],Lh.splice(Le,1),delete Lj[Lf.id]},Ld.clear=function(La){return La.table={},La.list.length=0,La.collisionStart.length=0,La.collisionActive.length=0,La.collisionEnd.length=0,La}},function(La,Lb,Lc){var Ld=La.exports=Lc(22);Ld.Axes=Lc(11),Ld.Bodies=Lc(12),Ld.Body=Lc(6),Ld.Bounds=Lc(1),Ld.Collision=Lc(8),Ld.Common=Lc(0),Ld.Composite=Lc(5),Ld.Composites=Lc(23),Ld.Constraint=Lc(10),Ld.Contact=Lc(17),Ld.Detector=Lc(14),Ld.Engine=Lc(18),Ld.Events=Lc(4),Ld.Grid=Lc(24),Ld.Mouse=Lc(13),Ld.MouseConstraint=Lc(25),Ld.Pair=Lc(9),Ld.Pairs=Lc(20),Ld.Plugin=Lc(15),Ld.Query=Lc(26),Ld.Render=Lc(16),Ld.Resolver=Lc(19),Ld.Runner=Lc(27),Ld.SAT=Lc(28),Ld.Sleeping=Lc(7),Ld.Svg=Lc(29),Ld.Vector=Lc(2),Ld.Vertices=Lc(3),Ld.World=Lc(30),Ld.Engine.run=Ld.Runner.run,Ld.Common.deprecated(Ld.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Le=Lc(15),Lf=Lc(0);Ld.name="matter-js",Ld.version="0.18.0",Ld.uses=[],Ld.used=[],Ld.use=function(){Le.use(Ld,Array.prototype.slice.call(arguments))},Ld.before=function(La,Lb){return La=La.replace(/^Matter./,""),Lf.chainPathBefore(Ld,La,Lb)},Ld.after=function(La,Lb){return La=La.replace(/^Matter./,""),Lf.chainPathAfter(Ld,La,Lb)}},function(La,Lb,Lc){var Ln={};La.exports=Ln;var Ls=Lc(5),Lp=Lc(10),Lq=Lc(0),Lt=Lc(6),Lo=Lc(12),Ld=Lq.deprecated;Ln.stack=function(La,Lb,Lc,Ld,Le,Lf,Lg){for(var Lh,Li=Ls.create({label:"Stack"}),Lj=La,Lk=Lb,Ll=0,Lm=0;Lm<Ld;Lm++){for(var Ln=0,Lo=0;Lo<Lc;Lo++){var Lp=Lg(Lj,Lk,Lo,Lm,Lh,Ll);if(Lp){var Lq=Lp.bounds.max.y-Lp.bounds.min.y,Lr=Lp.bounds.max.x-Lp.bounds.min.x;Ln<Lq&&(Ln=Lq),Lt.translate(Lp,{x:.5*Lr,y:.5*Lq}),Lj=Lp.bounds.max.x+Le,Ls.addBody(Li,Lp),Lh=Lp,Ll+=1}else Lj+=Le}Lk+=Ln+Lf,Lj=La}return Li},Ln.chain=function(La,Lb,Lc,Ld,Le,Lf){for(var Lg=La.bodies,Lh=1;Lh<Lg.length;Lh++){var Li=Lg[Lh-1],Lj=Lg[Lh],Lk=Li.bounds.max.y-Li.bounds.min.y,Ll=Li.bounds.max.x-Li.bounds.min.x,Lm=Lj.bounds.max.y-Lj.bounds.min.y,Ln={bodyA:Li,pointA:{x:Ll*Lb,y:Lk*Lc},bodyB:Lj,pointB:{x:(Lj.bounds.max.x-Lj.bounds.min.x)*Ld,y:Lm*Le}},Lo=Lq.extend(Ln,Lf);Ls.addConstraint(La,Lp.create(Lo))}return La.label+=" Chain",La},Ln.mesh=function(La,Lb,Lc,Ld,Le){var Lf,Lg,Lh,Li,Lj,Lk=La.bodies;for(Lf=0;Lf<Lc;Lf++){for(Lg=1;Lg<Lb;Lg++)Lh=Lk[Lg-1+Lf*Lb],Li=Lk[Lg+Lf*Lb],Ls.addConstraint(La,Lp.create(Lq.extend({bodyA:Lh,bodyB:Li},Le)));if(0<Lf)for(Lg=0;Lg<Lb;Lg++)Lh=Lk[Lg+(Lf-1)*Lb],Li=Lk[Lg+Lf*Lb],Ls.addConstraint(La,Lp.create(Lq.extend({bodyA:Lh,bodyB:Li},Le))),Ld&&0<Lg&&(Lj=Lk[Lg-1+(Lf-1)*Lb],Ls.addConstraint(La,Lp.create(Lq.extend({bodyA:Lj,bodyB:Li},Le)))),Ld&&Lg<Lb-1&&(Lj=Lk[Lg+1+(Lf-1)*Lb],Ls.addConstraint(La,Lp.create(Lq.extend({bodyA:Lj,bodyB:Li},Le))))}return La.label+=" Mesh",La},Ln.pyramid=function(Li,La,Lj,Lk,Ll,Lb,Lm){return Ln.stack(Li,La,Lj,Lk,Ll,Lb,function(La,Lb,Lc,Ld,Le,Lf){var Lg=Math.min(Lk,Math.ceil(Lj/2)),Lh=Le?Le.bounds.max.x-Le.bounds.min.x:0;if(!(Lg<Ld||Lc<(Ld=Lg-Ld)||Lj-1-Ld<Lc))return 1===Lf&&Lt.translate(Le,{x:(Lc+(Lj%2==1?1:-1))*Lh,y:0}),Lm(Li+(Le?Lc*Lh:0)+Lc*Ll,Lb,Lc,Ld,Le,Lf)})},Ln.newtonsCradle=function(La,Lb,Lc,Ld,Le){for(var Lf=Ls.create({label:"Newtons Cradle"}),Lg=0;Lg<Lc;Lg++){var Lh=Lo.circle(La+Lg*(1.9*Ld),Lb+Le,Ld,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),Li=Lp.create({pointA:{x:La+Lg*(1.9*Ld),y:Lb},bodyB:Lh});Ls.addBody(Lf,Lh),Ls.addConstraint(Lf,Li)}return Lf},Ld(Ln,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),Ln.car=function(La,Lb,Lc,Ld,Le){var Lf=Lt.nextGroup(!0),Lg=.5*-Lc+20,Lh=.5*Lc-20,Li=Ls.create({label:"Car"}),Lj=Lo.rectangle(La,Lb,Lc,Ld,{collisionFilter:{group:Lf},chamfer:{radius:.5*Ld},density:2e-4}),Lk=Lo.circle(La+Lg,Lb+0,Le,{collisionFilter:{group:Lf},friction:.8}),Ll=Lo.circle(La+Lh,Lb+0,Le,{collisionFilter:{group:Lf},friction:.8}),Lm=Lp.create({bodyB:Lj,pointB:{x:Lg,y:0},bodyA:Lk,stiffness:1,length:0}),Ln=Lp.create({bodyB:Lj,pointB:{x:Lh,y:0},bodyA:Ll,stiffness:1,length:0});return Ls.addBody(Li,Lj),Ls.addBody(Li,Lk),Ls.addBody(Li,Ll),Ls.addConstraint(Li,Lm),Ls.addConstraint(Li,Ln),Li},Ld(Ln,"car","Composites.car ➤ moved to car example"),Ln.softBody=function(La,Lb,Lc,Ld,Le,Lf,Lg,Lh,Li,Lj){Li=Lq.extend({inertia:1/0},Li),Lj=Lq.extend({stiffness:.2,render:{type:"line",anchors:!1}},Lj);var Lk=Ln.stack(La,Lb,Lc,Ld,Le,Lf,function(La,Lb){return Lo.circle(La,Lb,Lh,Li)});return Ln.mesh(Lk,Lc,Ld,Lg,Lj),Lk.label="Soft Body",Lk},Ld(Ln,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(La,Lb,Lc){var Lr={};La.exports=Lr;var Lk=Lc(9),Li=Lc(0),Ld=Li.deprecated;Lr.create=function(La){return Li.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},La)},Lr.update=function(La,Lb,Lc,Ld){var Le,Lf,Lg,Lh,Li,Lj=Lc.world,Lk=La.buckets,Ll=!1;for(Le=0;Le<Lb.length;Le++){var Lm=Lb[Le];if((!Lm.isSleeping||Ld)&&(!Lj.bounds||!(Lm.bounds.max.x<Lj.bounds.min.x||Lm.bounds.min.x>Lj.bounds.max.x||Lm.bounds.max.y<Lj.bounds.min.y||Lm.bounds.min.y>Lj.bounds.max.y))){var Ln=Lr._getRegion(La,Lm);if(!Lm.region||Ln.id!==Lm.region.id||Ld){Lm.region&&!Ld||(Lm.region=Ln);var Lo=Lr._regionUnion(Ln,Lm.region);for(Lf=Lo.startCol;Lf<=Lo.endCol;Lf++)for(Lg=Lo.startRow;Lg<=Lo.endRow;Lg++){Lh=Lk[Li=Lr._getBucketId(Lf,Lg)];var Lp=Lf>=Ln.startCol&&Lf<=Ln.endCol&&Lg>=Ln.startRow&&Lg<=Ln.endRow,Lq=Lf>=Lm.region.startCol&&Lf<=Lm.region.endCol&&Lg>=Lm.region.startRow&&Lg<=Lm.region.endRow;!Lp&&Lq&&Lq&&Lh&&Lr._bucketRemoveBody(La,Lh,Lm),(Lm.region===Ln||Lp&&!Lq||Ld)&&(Lh||(Lh=Lr._createBucket(Lk,Li)),Lr._bucketAddBody(La,Lh,Lm))}Lm.region=Ln,Ll=!0}}}Ll&&(La.pairsList=Lr._createActivePairsList(La))},Ld(Lr,"update","Grid.update ➤ replaced by Matter.Detector"),Lr.clear=function(La){La.buckets={},La.pairs={},La.pairsList=[]},Ld(Lr,"clear","Grid.clear ➤ replaced by Matter.Detector"),Lr._regionUnion=function(La,Lb){var Lc=Math.min(La.startCol,Lb.startCol),Ld=Math.max(La.endCol,Lb.endCol),Le=Math.min(La.startRow,Lb.startRow),Lf=Math.max(La.endRow,Lb.endRow);return Lr._createRegion(Lc,Ld,Le,Lf)},Lr._getRegion=function(La,Lb){var Lc=Lb.bounds,Ld=Math.floor(Lc.min.x/La.bucketWidth),Le=Math.floor(Lc.max.x/La.bucketWidth),Lf=Math.floor(Lc.min.y/La.bucketHeight),Lg=Math.floor(Lc.max.y/La.bucketHeight);return Lr._createRegion(Ld,Le,Lf,Lg)},Lr._createRegion=function(La,Lb,Lc,Ld){return{id:La+","+Lb+","+Lc+","+Ld,startCol:La,endCol:Lb,startRow:Lc,endRow:Ld}},Lr._getBucketId=function(La,Lb){return"C"+La+"R"+Lb},Lr._createBucket=function(La,Lb){return La[Lb]=[]},Lr._bucketAddBody=function(La,Lb,Lc){var Ld,Le=La.pairs,Lf=Lk.id,Lg=Lb.length;for(Ld=0;Ld<Lg;Ld++){var Lh=Lb[Ld];if(!(Lc.id===Lh.id||Lc.isStatic&&Lh.isStatic)){var Li=Lf(Lc,Lh),Lj=Le[Li];Lj?Lj[2]+=1:Le[Li]=[Lc,Lh,1]}}Lb.push(Lc)},Lr._bucketRemoveBody=function(La,Lb,Lc){var Ld,Le=La.pairs,Lf=Lk.id;Lb.splice(Li.indexOf(Lb,Lc),1);var Lg=Lb.length;for(Ld=0;Ld<Lg;Ld++){var Lh=Le[Lf(Lc,Lb[Ld])];Lh&&(Lh[2]-=1)}},Lr._createActivePairsList=function(La){var Lb,Lc,Ld=La.pairs,Le=Li.keys(Ld),Lf=Le.length,Lg=[];for(Lc=0;Lc<Lf;Lc++)0<(Lb=Ld[Le[Lc]])[2]?Lg.push(Lb):delete Ld[Le[Lc]];return Lg}},function(La,Lb,Lc){var Lf={};La.exports=Lf;var Li=Lc(3),Lj=Lc(7),Lg=Lc(13),Lk=Lc(4),Ll=Lc(14),Lh=Lc(10),Lm=Lc(5),Ln=Lc(0),Lo=Lc(1);Lf.create=function(Lb,La){var Lc=(Lb?Lb.mouse:null)||(La?La.mouse:null);Lc||(Lb&&Lb.render&&Lb.render.canvas?Lc=Lg.create(Lb.render.canvas):La&&La.element?Lc=Lg.create(La.element):(Lc=Lg.create(),Ln.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var Ld={type:"mouseConstraint",mouse:Lc,element:null,body:null,constraint:Lh.create({label:"Mouse Constraint",pointA:Lc.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},Le=Ln.extend(Ld,La);return Lk.on(Lb,"beforeUpdate",function(){var La=Lm.allBodies(Lb.world);Lf.update(Le,La),Lf._triggerEvents(Le)}),Le},Lf.update=function(La,Lb){var Lc=La.mouse,Ld=La.constraint,Le=La.body;if(0===Lc.button){if(Ld.bodyB)Lj.set(Ld.bodyB,!1),Ld.pointA=Lc.position;else for(var Lf=0;Lf<Lb.length;Lf++)if(Le=Lb[Lf],Lo.contains(Le.bounds,Lc.position)&&Ll.canCollide(Le.collisionFilter,La.collisionFilter))for(var Lg=1<Le.parts.length?1:0;Lg<Le.parts.length;Lg++){var Lh=Le.parts[Lg];if(Li.contains(Lh.vertices,Lc.position)){Ld.pointA=Lc.position,Ld.bodyB=La.body=Le,Ld.pointB={x:Lc.position.x-Le.position.x,y:Lc.position.y-Le.position.y},Ld.angleB=Le.angle,Lj.set(Le,!1),Lk.trigger(La,"startdrag",{mouse:Lc,body:Le});break}}}else Ld.bodyB=La.body=null,Ld.pointB=null,Le&&Lk.trigger(La,"enddrag",{mouse:Lc,body:Le})},Lf._triggerEvents=function(La){var Lb=La.mouse,Lc=Lb.sourceEvents;Lc.mousemove&&Lk.trigger(La,"mousemove",{mouse:Lb}),Lc.mousedown&&Lk.trigger(La,"mousedown",{mouse:Lb}),Lc.mouseup&&Lk.trigger(La,"mouseup",{mouse:Lb}),Lc.mouseout&&Lk.trigger(La,"mouseout",{mouse:Lb}),Lg.clearSourceEvents(Lb)}},function(La,Lb,Lc){var Lm={};La.exports=Lm;var Ln=Lc(2),Lo=Lc(8),Lp=Lc(1),Lq=Lc(12),Lh=Lc(3);Lm.collides=function(La,Lb){for(var Lc=[],Ld=Lb.length,Le=La.bounds,Lf=Lo.collides,Lg=Lp.overlaps,Lh=0;Lh<Ld;Lh++){var Li=Lb[Lh],Lj=Li.parts.length,Lk=1===Lj?0:1;if(Lg(Li.bounds,Le))for(var Ll=Lk;Ll<Lj;Ll++){var Lm=Li.parts[Ll];if(Lg(Lm.bounds,Le)){var Ln=Lf(Lm,La);if(Ln){Lc.push(Ln);break}}}}return Lc},Lm.ray=function(La,Lb,Lc,Ld){Ld=Ld||1e-100;for(var Le=Ln.angle(Lb,Lc),Lf=Ln.magnitude(Ln.sub(Lb,Lc)),Lg=.5*(Lc.x+Lb.x),Lh=.5*(Lc.y+Lb.y),Li=Lq.rectangle(Lg,Lh,Lf,Ld,{angle:Le}),Lj=Lm.collides(Li,La),Lk=0;Lk<Lj.length;Lk+=1){var Ll=Lj[Lk];Ll.body=Ll.bodyB=Ll.bodyA}return Lj},Lm.region=function(La,Lb,Lc){for(var Ld=[],Le=0;Le<La.length;Le++){var Lf=La[Le],Lg=Lp.overlaps(Lf.bounds,Lb);(Lg&&!Lc||!Lg&&Lc)&&Ld.push(Lf)}return Ld},Lm.point=function(La,Lb){for(var Lc=[],Ld=0;Ld<La.length;Ld++){var Le=La[Ld];if(Lp.contains(Le.bounds,Lb))for(var Lf=1===Le.parts.length?0:1;Lf<Le.parts.length;Lf++){var Lg=Le.parts[Lf];if(Lp.contains(Lg.bounds,Lb)&&Lh.contains(Lg.vertices,Lb)){Lc.push(Le);break}}}return Lc}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Lh=Lc(4),Li=Lc(18),Le=Lc(0);Ld.create=function(La){var Lb=Le.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},La);return Lb.delta=Lb.delta||1e3/Lb.fps,Lb.deltaMin=Lb.deltaMin||1e3/Lb.fps,Lb.deltaMax=Lb.deltaMax||1e3/(.5*Lb.fps),Lb.fps=1e3/Lb.delta,Lb},Ld.run=function(La,Lb){return void 0!==La.positionIterations&&(Lb=La,La=Ld.create()),Laya.timer.clear(this,Ld.render),Laya.timer.frameLoop(1,this,Ld.render,[La,Lb]),La},Ld.render=function(La,Lb){La.enabled&&Ld.tick(La,Lb,Le.now())},Ld.tick=function(La,Lb,Lc){var Ld,Le=Lb.timing,Lf=1,Lg={timestamp:Le.timestamp};Lh.trigger(La,"beforeTick",Lg),La.isFixed?Ld=La.delta:(Ld=Lc-La.timePrev||La.delta,La.timePrev=Lc,La.deltaHistory.push(Ld),La.deltaHistory=La.deltaHistory.slice(-La.deltaSampleSize),Lf=(Ld=(Ld=(Ld=Math.min.apply(null,La.deltaHistory))<La.deltaMin?La.deltaMin:Ld)>La.deltaMax?La.deltaMax:Ld)/La.delta,La.delta=Ld),0!==La.timeScalePrev&&(Lf*=Le.timeScale/La.timeScalePrev),0===Le.timeScale&&(Lf=0),La.timeScalePrev=Le.timeScale,La.correction=Lf,La.frameCounter+=1,1e3<=Lc-La.counterTimestamp&&(La.fps=La.frameCounter*((Lc-La.counterTimestamp)/1e3),La.counterTimestamp=Lc,La.frameCounter=0),Lh.trigger(La,"tick",Lg),Lh.trigger(La,"beforeUpdate",Lg),Li.update(Lb,Ld,Lf),Lh.trigger(La,"afterUpdate",Lg),Lh.trigger(La,"afterTick",Lg)},Ld.stop=function(La){Laya.timer.clear(this,Ld.render)},Ld.start=function(La,Lb){Ld.run(La,Lb)}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Le=Lc(8),Lf=Lc(0).deprecated;Ld.collides=function(La,Lb){return Le.collides(La,Lb)},Lf(Ld,"collides","SAT.collides ➤ replaced by Collision.collides")},function(La,Lb,Lc){var Lt={};La.exports=Lt;Lc(1);var Lu=Lc(0);Lt.pathToVertices=function(La,Lb){"undefined"==typeof window||"SVGPathSeg"in window||Lu.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var Lc,Ld,Le,Lf,Lg,Lh,Li,Lj,Lk,Ll,Lm,Ln=[],Lo=0,Lp=0,Lq=0;function Lr(La,Lb,Lc){var Ld=Lc%2==1&&1<Lc;if(!Lk||La!=Lk.x||Lb!=Lk.y){Lm=Lk&&Ld?(Ll=Lk.x,Lk.y):Ll=0;var Le={x:Ll+La,y:Lm+Lb};!Ld&&Lk||(Lk=Le),Ln.push(Le),Lp=Ll+La,Lq=Lm+Lb}}function Ls(La){var Lb=La.pathSegTypeAsLetter.toUpperCase();if("Z"!==Lb){switch(Lb){case"M":case"L":case"T":case"C":case"S":case"Q":Lp=La.x,Lq=La.y;break;case"H":Lp=La.x;break;case"V":Lq=La.y}Lr(Lp,Lq,La.pathSegType)}}for(Lb=Lb||15,Lt._svgPathToAbsolute(La),Le=La.getTotalLength(),Lh=[],Lc=0;Lc<La.pathSegList.numberOfItems;Lc+=1)Lh.push(La.pathSegList.getItem(Lc));for(Li=Lh.concat();Lo<Le;){if((Lg=Lh[La.getPathSegAtLength(Lo)])!=Lj){for(;Li.length&&Li[0]!=Lg;)Ls(Li.shift());Lj=Lg}switch(Lg.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":Lf=La.getPointAtLength(Lo),Lr(Lf.x,Lf.y,0)}Lo+=Lb}for(Lc=0,Ld=Li.length;Lc<Ld;++Lc)Ls(Li[Lc]);return Ln},Lt._svgPathToAbsolute=function(La){for(var Lb,Lc,Ld,Le,Lf,Lg,Lh=La.pathSegList,Li=0,Lj=0,Lk=Lh.numberOfItems,Ll=0;Ll<Lk;++Ll){var Lm=Lh.getItem(Ll),Ln=Lm.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(Ln))"x"in Lm&&(Li=Lm.x),"y"in Lm&&(Lj=Lm.y);else switch("x1"in Lm&&(Ld=Li+Lm.x1),"x2"in Lm&&(Lf=Li+Lm.x2),"y1"in Lm&&(Le=Lj+Lm.y1),"y2"in Lm&&(Lg=Lj+Lm.y2),"x"in Lm&&(Li+=Lm.x),"y"in Lm&&(Lj+=Lm.y),Ln){case"m":Lh.replaceItem(La.createSVGPathSegMovetoAbs(Li,Lj),Ll);break;case"l":Lh.replaceItem(La.createSVGPathSegLinetoAbs(Li,Lj),Ll);break;case"h":Lh.replaceItem(La.createSVGPathSegLinetoHorizontalAbs(Li),Ll);break;case"v":Lh.replaceItem(La.createSVGPathSegLinetoVerticalAbs(Lj),Ll);break;case"c":Lh.replaceItem(La.createSVGPathSegCurvetoCubicAbs(Li,Lj,Ld,Le,Lf,Lg),Ll);break;case"s":Lh.replaceItem(La.createSVGPathSegCurvetoCubicSmoothAbs(Li,Lj,Lf,Lg),Ll);break;case"q":Lh.replaceItem(La.createSVGPathSegCurvetoQuadraticAbs(Li,Lj,Ld,Le),Ll);break;case"t":Lh.replaceItem(La.createSVGPathSegCurvetoQuadraticSmoothAbs(Li,Lj),Ll);break;case"a":Lh.replaceItem(La.createSVGPathSegArcAbs(Li,Lj,Lm.r1,Lm.r2,Lm.angle,Lm.largeArcFlag,Lm.sweepFlag),Ll);break;case"z":case"Z":Li=Lb,Lj=Lc}"M"!=Ln&&"m"!=Ln||(Lb=Li,Lc=Lj)}}},function(La,Lb,Lc){var Ld={};La.exports=Ld;var Le=Lc(5);Lc(0);Ld.create=Le.create,Ld.add=Le.add,Ld.remove=Le.remove,Ld.clear=Le.clear,Ld.addComposite=Le.addComposite,Ld.addBody=Le.addBody,Ld.addConstraint=Le.addConstraint}])}),function(La){if("object"==typeof exports&&"undefined"!=typeof module)window?window.decomp=La():module.exports=La();else if("function"==typeof define&&define.amd)define([],La);else{var Lb;"undefined"!=typeof window?Lb=window:"undefined"!=typeof global?Lb=global:"undefined"!=typeof self&&(Lb=self),Lb.decomp=La()}}(function(){return function Le(Lf,Lg,Lh){function Li(Lc,La){if(!Lg[Lc]){if(!Lf[Lc]){var Lb="function"==typeof require&&require;if(!La&&Lb)return Lb(Lc,!0);if(Lj)return Lj(Lc,!0);throw new Error("Cannot find module '"+Lc+"'")}var Ld=Lg[Lc]={exports:{}};Lf[Lc][0].call(Ld.exports,function(La){var Lb=Lf[Lc][1][La];return Li(Lb||La)},Ld,Ld.exports,Le,Lf,Lg,Lh)}return Lg[Lc].exports}for(var Lj="function"==typeof require&&require,La=0;La<Lh.length;La++)Li(Lh[La]);return Li}({1:[function(La,Lb,Lc){function Li(La,Lb,Lc){Lc=Lc||0;var Ld,Le,Lf,Lg,Lh,Li,Lj,Lk=[0,0];return Ld=La[1][1]-La[0][1],Le=La[0][0]-La[1][0],Lf=Ld*La[0][0]+Le*La[0][1],Lg=Lb[1][1]-Lb[0][1],Lh=Lb[0][0]-Lb[1][0],Li=Lg*Lb[0][0]+Lh*Lb[0][1],Lq(Lj=Ld*Lh-Lg*Le,0,Lc)||(Lk[0]=(Lh*Lf-Le*Li)/Lj,Lk[1]=(Ld*Li-Lg*Lf)/Lj),Lk}function Le(La,Lb,Lc,Ld){var Le=Lb[0]-La[0],Lf=Lb[1]-La[1],Lg=Ld[0]-Lc[0],Lh=Ld[1]-Lc[1];if(Lg*Lf-Lh*Le==0)return!1;var Li=(Le*(Lc[1]-La[1])+Lf*(La[0]-Lc[0]))/(Lg*Lf-Lh*Le),Lj=(Lg*(La[1]-Lc[1])+Lh*(Lc[0]-La[0]))/(Lh*Le-Lg*Lf);return 0<=Li&&Li<=1&&0<=Lj&&Lj<=1}function Lj(La,Lb,Lc){return(Lb[0]-La[0])*(Lc[1]-La[1])-(Lc[0]-La[0])*(Lb[1]-La[1])}function LA(La,Lb,Lc){return 0<Lj(La,Lb,Lc)}function LB(La,Lb,Lc){return 0<=Lj(La,Lb,Lc)}function LC(La,Lb,Lc){return Lj(La,Lb,Lc)<0}function LD(La,Lb,Lc){return Lj(La,Lb,Lc)<=0}Lb.exports={decomp:function(La){var Lb=function La(Lb){var Lc=[],Ld=[],Le=[],Lf=[];var Lg=Number.MAX_VALUE;for(var Lh=0;Lh<Lb.length;++Lh)if(LH(Lb,Lh))for(var Li=0;Li<Lb.length;++Li)if(Lo(Lb,Lh,Li)){Ld=La(Lp(Lb,Lh,Li,Lf)),Le=La(Lp(Lb,Li,Lh,Lf));for(var Lj=0;Lj<Le.length;Lj++)Ld.push(Le[Lj]);Ld.length<Lg&&(Lg=(Lc=Ld).length,Lc.push([LF(Lb,Lh),LF(Lb,Li)]))}return Lc}(La);return 0<Lb.length?function La(Lb,Lc){if(0===Lc.length)return[Lb];{if(Lc instanceof Array&&Lc.length&&Lc[0]instanceof Array&&2===Lc[0].length&&Lc[0][0]instanceof Array){for(var Ld=[Lb],Le=0;Le<Lc.length;Le++)for(var Lf=Lc[Le],Lg=0;Lg<Ld.length;Lg++){var Lh=Ld[Lg],Li=La(Lh,Lf);if(Li){Ld.splice(Lg,1),Ld.push(Li[0],Li[1]);break}}return Ld}var Lf=Lc,Le=Lb.indexOf(Lf[0]),Lg=Lb.indexOf(Lf[1]);return-1!==Le&&-1!==Lg&&[Lp(Lb,Le,Lg),Lp(Lb,Lg,Le)]}}(La,Lb):[La]},quickDecomp:function La(Lb,Lc,Ld,Le,Lf,Lg,Lh){Lg=Lg||100;Lh=Lh||0;Lf=Lf||25;Lc=void 0!==Lc?Lc:[];Ld=Ld||[];Le=Le||[];var Li=[0,0],Lj=[0,0],Lk=[0,0];var Ll=0,Lm=0,Ln=0,Lo=0;var Lp=0,Lq=0,Lr=0;var Ls=[],Lt=[];var Lu=Lb,Lv=Lb;if(Lv.length<3)return Lc;Lh++;if(Lg<Lh)return console.warn("quickDecomp: max level ("+Lg+") reached."),Lc;for(var Ly=0;Ly<Lb.length;++Ly)if(LH(Lu,Ly)){Ld.push(Lu[Ly]),Ll=Lm=Number.MAX_VALUE;for(var Lz=0;Lz<Lb.length;++Lz)LA(LF(Lu,Ly-1),LF(Lu,Ly),LF(Lu,Lz))&&LD(LF(Lu,Ly-1),LF(Lu,Ly),LF(Lu,Lz-1))&&(Lk=LJ(LF(Lu,Ly-1),LF(Lu,Ly),LF(Lu,Lz),LF(Lu,Lz-1)),LC(LF(Lu,Ly+1),LF(Lu,Ly),Lk)&&(Ln=LE(Lu[Ly],Lk))<Lm&&(Lm=Ln,Lj=Lk,Lq=Lz)),LA(LF(Lu,Ly+1),LF(Lu,Ly),LF(Lu,Lz+1))&&LD(LF(Lu,Ly+1),LF(Lu,Ly),LF(Lu,Lz))&&(Lk=LJ(LF(Lu,Ly+1),LF(Lu,Ly),LF(Lu,Lz),LF(Lu,Lz+1)),LA(LF(Lu,Ly-1),LF(Lu,Ly),Lk)&&(Ln=LE(Lu[Ly],Lk))<Ll&&(Ll=Ln,Li=Lk,Lp=Lz));if(Lq===(Lp+1)%Lb.length)Lk[0]=(Lj[0]+Li[0])/2,Lk[1]=(Lj[1]+Li[1])/2,Le.push(Lk),Ly<Lp?(LG(Ls,Lu,Ly,Lp+1),Ls.push(Lk),Lt.push(Lk),0!==Lq&&LG(Lt,Lu,Lq,Lu.length),LG(Lt,Lu,0,Ly+1)):(0!==Ly&&LG(Ls,Lu,Ly,Lu.length),LG(Ls,Lu,0,Lp+1),Ls.push(Lk),Lt.push(Lk),LG(Lt,Lu,Lq,Ly+1));else{if(Lp<Lq&&(Lp+=Lb.length),Lo=Number.MAX_VALUE,Lp<Lq)return Lc;for(var Lz=Lq;Lz<=Lp;++Lz)LB(LF(Lu,Ly-1),LF(Lu,Ly),LF(Lu,Lz))&&LD(LF(Lu,Ly+1),LF(Lu,Ly),LF(Lu,Lz))&&(Ln=LE(LF(Lu,Ly),LF(Lu,Lz)))<Lo&&LI(Lu,Ly,Lz)&&(Lo=Ln,Lr=Lz%Lb.length);Ly<Lr?(LG(Ls,Lu,Ly,Lr+1),0!==Lr&&LG(Lt,Lu,Lr,Lv.length),LG(Lt,Lu,0,Ly+1)):(0!==Ly&&LG(Ls,Lu,Ly,Lv.length),LG(Ls,Lu,0,Lr+1),LG(Lt,Lu,Lr,Ly+1))}return Ls.length<Lt.length?(La(Ls,Lc,Ld,Le,Lf,Lg,Lh),La(Lt,Lc,Ld,Le,Lf,Lg,Lh)):(La(Lt,Lc,Ld,Le,Lf,Lg,Lh),La(Ls,Lc,Ld,Le,Lf,Lg,Lh)),Lc}Lc.push(Lb);return Lc},isSimple:function(La){var Lb,Lc=La;for(Lb=0;Lb<Lc.length-1;Lb++)for(var Ld=0;Ld<Lb-1;Ld++)if(Le(Lc[Lb],Lc[Lb+1],Lc[Ld],Lc[Ld+1]))return!1;for(Lb=1;Lb<Lc.length-2;Lb++)if(Le(Lc[0],Lc[Lc.length-1],Lc[Lb],Lc[Lb+1]))return!1;return!0},removeCollinearPoints:function(La,Lb){for(var Lc=0,Ld=La.length-1;3<La.length&&0<=Ld;--Ld)Lf(LF(La,Ld-1),LF(La,Ld),LF(La,Ld+1),Lb)&&(La.splice(Ld%La.length,1),Lc++);return Lc},removeDuplicatePoints:function(La,Lb){for(var Lc=La.length-1;1<=Lc;--Lc)for(var Ld=La[Lc],Le=Lc-1;0<=Le;--Le)Lf=Ld,Lg=La[Le],Lh=Lb,Lq(Lf[0],Lg[0],Lh)&&Lq(Lf[1],Lg[1],Lh)&&La.splice(Lc,1);var Lf,Lg,Lh},makeCCW:function(La){for(var Lb=0,Lc=La,Ld=1;Ld<La.length;++Ld)(Lc[Ld][1]<Lc[Lb][1]||Lc[Ld][1]===Lc[Lb][1]&&Lc[Ld][0]>Lc[Lb][0])&&(Lb=Ld);return!LA(LF(La,Lb-1),LF(La,Lb),LF(La,Lb+1))&&(function(La){for(var Lb=[],Lc=La.length,Ld=0;Ld!==Lc;Ld++)Lb.push(La.pop());for(var Ld=0;Ld!==Lc;Ld++)La[Ld]=Lb[Ld]}(La),!0)}};var Lk=[],Ll=[];function Lf(La,Lb,Lc,Ld){if(Ld){var Le=Lk,Lf=Ll;Le[0]=Lb[0]-La[0],Le[1]=Lb[1]-La[1],Lf[0]=Lc[0]-Lb[0],Lf[1]=Lc[1]-Lb[1];var Lg=Le[0]*Lf[0]+Le[1]*Lf[1],Lh=Math.sqrt(Le[0]*Le[0]+Le[1]*Le[1]),Li=Math.sqrt(Lf[0]*Lf[0]+Lf[1]*Lf[1]);return Math.acos(Lg/(Lh*Li))<Ld}return 0===Lj(La,Lb,Lc)}function LE(La,Lb){var Lc=Lb[0]-La[0],Ld=Lb[1]-La[1];return Lc*Lc+Ld*Ld}function LF(La,Lb){var Lc=La.length;return La[Lb<0?Lb%Lc+Lc:Lb%Lc]}function LG(La,Lb,Lc,Ld){for(var Le=Lc;Le<Ld;Le++)La.push(Lb[Le])}function LH(La,Lb){return LC(LF(La,Lb-1),LF(La,Lb),LF(La,Lb+1))}var Lm=[],Ln=[];function Lo(La,Lb,Lc){var Ld,Le,Lf=Lm,Lg=Ln;if(LB(LF(La,Lb+1),LF(La,Lb),LF(La,Lc))&&LD(LF(La,Lb-1),LF(La,Lb),LF(La,Lc)))return!1;Le=LE(LF(La,Lb),LF(La,Lc));for(var Lh=0;Lh!==La.length;++Lh)if((Lh+1)%La.length!==Lb&&Lh!==Lb&&LB(LF(La,Lb),LF(La,Lc),LF(La,Lh+1))&&LD(LF(La,Lb),LF(La,Lc),LF(La,Lh))&&(Lf[0]=LF(La,Lb),Lf[1]=LF(La,Lc),Lg[0]=LF(La,Lh),Lg[1]=LF(La,Lh+1),Ld=Li(Lf,Lg),LE(LF(La,Lb),Ld)<Le))return!1;return!0}function LI(La,Lb,Lc){for(var Ld=0;Ld!==La.length;++Ld)if(Ld!==Lb&&Ld!==Lc&&(Ld+1)%La.length!==Lb&&(Ld+1)%La.length!==Lc&&Le(LF(La,Lb),LF(La,Lc),LF(La,Ld),LF(La,Ld+1)))return!1;return!0}function Lp(La,Lb,Lc,Ld){var Le=Ld||[];if(function(La){La.length=0}(Le),Lb<Lc)for(var Lf=Lb;Lf<=Lc;Lf++)Le.push(La[Lf]);else{for(Lf=0;Lf<=Lc;Lf++)Le.push(La[Lf]);for(Lf=Lb;Lf<La.length;Lf++)Le.push(La[Lf])}return Le}function LJ(La,Lb,Lc,Ld,Le){Le=Le||0;var Lf=Lb[1]-La[1],Lg=La[0]-Lb[0],Lh=Lf*La[0]+Lg*La[1],Li=Ld[1]-Lc[1],Lj=Lc[0]-Ld[0],Lk=Li*Lc[0]+Lj*Lc[1],Ll=Lf*Lj-Li*Lg;return Lq(Ll,0,Le)?[0,0]:[(Lj*Lh-Lg*Lk)/Ll,(Lf*Lk-Li*Lh)/Ll]}function Lq(La,Lb,Lc){return Lc=Lc||0,Math.abs(La-Lb)<=Lc}},{}]},{},[1])(1)}),function(){var Ls={},Ld=Matter.Common,Lt=Matter.Composite,Lu=Matter.Bounds,Lb=Matter.Events,Lv=(Matter.Grid,Matter.Vector);Ls.create=function(La){var Lb={controller:Ls,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#fafafa",wireframeBackground:"#222222",hasBounds:!!La.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},Lc=Ld.extend(Lb,La);return Lc.mouse=La.mouse,Lc.engine=La.engine,Lc.container=Lc.container||Laya.stage,Lc.bounds=Lc.bounds||{min:{x:0,y:0},max:{x:Lc.width,y:Lc.height}},Lc},Ls.run=function(La){Laya.timer.frameLoop(1,this,Ls.world,[La]),Lb.on(La.engine.world,"afterRemove",Ls.onRemoveSprite)},Ls.stop=function(La){Laya.timer.clear(this,Ls.world),Lb.off(La.engine.world,"afterRemove",Ls.onRemoveSprite)},Ls.onRemoveSprite=function(La){var Lb=La.object.layaSprite;Lb&&Lb.parent&&Lb.parent.removeChild(Lb)},Ls.world=function(La){var Lb,Lc=La.engine.world,Ld=(La.renderer,La.container),Le=La.options,Lf=Lt.allBodies(Lc),Lg=Lt.allConstraints(Lc),Lh=[];Le.wireframes?Ls.setBackground(La,Le.wireframeBackground):Ls.setBackground(La,Le.background);var Li=La.bounds.max.x-La.bounds.min.x,Lj=La.bounds.max.y-La.bounds.min.y,Lk=Li/La.options.width,Ll=Lj/La.options.height;if(Le.hasBounds){for(Lb=0;Lb<Lf.length;Lb++){var Lm=Lf[Lb];Lm.render.sprite.visible=Lu.overlaps(Lm.bounds,La.bounds)}for(Lb=0;Lb<Lg.length;Lb++){var Ln=Lg[Lb],Lo=Ln.bodyA,Lp=Ln.bodyB,Lq=Ln.pointA,Lr=Ln.pointB;Lo&&(Lq=Lv.add(Lo.position,Ln.pointA)),Lp&&(Lr=Lv.add(Lp.position,Ln.pointB)),Lq&&Lr&&((Lu.contains(La.bounds,Lq)||Lu.contains(La.bounds,Lr))&&Lh.push(Ln))}Ld.scale(1/Lk,1/Ll),Ld.pos(-La.bounds.min.x*(1/Lk),-La.bounds.min.y*(1/Ll))}else Lh=Lg;for(Lb=0;Lb<Lf.length;Lb++)Ls.body(La,Lf[Lb]);for(Lb=0;Lb<Lh.length;Lb++)Ls.constraint(La,Lh[Lb])},Ls.setBackground=function(La,Lb){if(La.currentBackground!==Lb){var Lc=Lb.indexOf&&-1!==Lb.indexOf("#");La.container.graphics.clear(),Lc?La.container.bgColor=Lb:(La.container.loadImage(Lb),La.container.bgColor="#FFFFFF"),La.currentBackground=Lb}},Ls.body=function(La,Lb){La.engine;var Lc=Lb.render;if(Lc.visible){if(Lc.sprite&&Lc.sprite.texture){Lb.id;var Ld=Lb.layaSprite,Le=La.container;Ld||(Ld=Lb.layaSprite=Li(La,Lb),Lb.effPendant&&!Lb.effPendant.parent&&Ld.addChild(Lb.effPendant)),Le.contains(Ld)||Le.addChild(Ld),Ld.x=Lb.position.x,Ld.y=Lb.position.y,Ld.rotation=180*Lb.angle/Math.PI,Ld.scaleX=Lc.sprite.xScale||1,Ld.scaleY=Lc.sprite.yScale||1,Ld.width=Lc.sprite.width,Ld.height=Lc.sprite.height,Lc.sprite.sizeGrid&&(Ld.sizeGrid=Lc.sprite.sizeGrid)}else{Lb.id,Ld=Lb.layaSprite,Le=La.container;Ld||((Ld=Lb.layaSprite=Lj(La,Lb)).initialAngle=Lb.angle,Lb.effPendant&&!Lb.effPendant.parent&&Ld.addChild(Lb.effPendant)),Le.contains(Ld)||Le.addChild(Ld),Ld.x=Lb.position.x,Ld.y=Lb.position.y,Ld.rotation=180*(Lb.angle-Ld.initialAngle)/Math.PI}var Lf=Lb.text;if(Lf){var Lg=Ld.lbl;Lg||((Lg=Ld.lbl=new Laya.Label).fontSize=30,Lg.anchorX=.5,Lg.anchorY=.5,Lg.color=Lb.textClr?Lb.textClr:"#ffffff",Lg.strokeColor="#000000",Lg.stroke=2,Lg.centerX=0,Lg.centerY=0,Ld.addChild(Lg),void 0!==Lb.shapeType&&(0===Lb.shapeType&&(Lg.centerX=-10),2===Lb.shapeType&&(Lg.rotation=-Ld.rotation)),Lg.text=Lf+"",Lb.lbl=Lg)}if(Lb.pendant&&!Ld.pendantSpr){var Lh=new Laya.Image;Lh.skin=Lb.pendant,Ld.addChild(Lh),Ld.pendantSpr=Lh}}};var Li=function(La,Lb){var Lc=Lb.render.sprite.texture,Ld=new Laya.Image;return Ld.skin=Lc,Ld.pivotX=Lb.render.sprite.xOffset,Ld.pivotY=Lb.render.sprite.yOffset,Ld},Lj=function(La,Lb){var Lc,Ld,Le,Lf,Lg=Lb.render,Lh=La.options,Li=new Laya.Sprite,Lj=Li.graphics;Lj.clear();for(var Lk=1<Lb.parts.length?1:0;Lk<Lb.parts.length;Lk++){Lf=Lb.parts[Lk];var Ll=[];Le=Lh.wireframes?(Lc=null,Ld="#bbbbbb",1):(Lc=Lg.fillStyle,Ld=Lg.strokeStyle,Lg.lineWidth),Ll.push(Lf.vertices[0].x-Lb.position.x,Lf.vertices[0].y-Lb.position.y);for(var Lm=1;Lm<Lf.vertices.length;Lm++)Ll.push(Lf.vertices[Lm].x-Lb.position.x,Lf.vertices[Lm].y-Lb.position.y);Ll.push(Lf.vertices[0].x-Lb.position.x,Lf.vertices[0].y-Lb.position.y),Lj.drawPoly(0,0,Ll,Lc,Ld,Le),(Lh.showAngleIndicator||Lh.showAxes)&&(Le=1,Ld=Lh.wireframes?"#CD5C5C":Lg.strokeStyle,Lj.drawLine(Lf.position.x-Lb.position.x,Lf.position.y-Lb.position.y,(Lf.vertices[0].x+Lf.vertices[Lf.vertices.length-1].x)/2-Lb.position.x,(Lf.vertices[0].y+Lf.vertices[Lf.vertices.length-1].y)/2-Lb.position.y))}return Li};Ls.constraint=function(La,Lb){La.engine;var Lc=Lb.bodyA,Ld=Lb.bodyB,Le=Lb.pointA,Lf=Lb.pointB,Lg=La.container,Lh=Lb.render,Li=(Lb.id,Lb.layaSprite);Li||(Li=Lb.layaSprite=new Laya.Sprite);var Lj,Lk,Ll,Lm,Ln=Li.graphics;Lh.visible&&Lb.pointA&&Lb.pointB?(Lg.contains(Li)||Lg.addChild(Li),Ln.clear(),Lk=Lc?(Lj=Lc.position.x+Le.x,Lc.position.y+Le.y):(Lj=Le.x,Le.y),Lm=Ld?(Ll=Ld.position.x+Lf.x,Ld.position.y+Lf.y):(Ll=Lf.x,Lf.y),Ln.drawLine(Lj,Lk,Ll,Lm,Lh.strokeStyle,Lh.lineWidth)):Ln.clear()},window.LayaRender=Ls}();