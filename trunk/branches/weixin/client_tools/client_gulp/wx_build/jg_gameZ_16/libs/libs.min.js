var Laya=window.Laya=function($TL,$Tt){var $Tp={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($Tt,$TM){return 1==arguments.length?$Tp.__presubstr.call(this,$Tt):$Tp.__presubstr.call(this,$Tt,0<$TM?$TM:this.length+$TM)},__init:function($Tt){$Tt.forEach(function($Tt){$Tt.__init$&&$Tt.__init$()})},__isClass:function($Tt){return $Tt&&($Tt.__isclass||$Tt==Object||$Tt==String||$Tt==Array)},__newvec:function($Tt,$TM){var $Tf=[];$Tf.length=$Tt;for(var $Tc=0;$Tc<$Tt;$Tc++)$Tf[$Tc]=$TM;return $Tf},__extend:function($Tt,$TM){for(var $Tf in $TM)if($TM.hasOwnProperty($Tf)){var $Tc=Object.getOwnPropertyDescriptor($TM,$Tf),$TD=$Tc.get,$To=$Tc.set;$TD||$To?$TD&&$To?Object.defineProperty($Tt,$Tf,$Tc):($TD&&Object.defineProperty($Tt,$Tf,$TD),$To&&Object.defineProperty($Tt,$Tf,$To)):$Tt[$Tf]=$TM[$Tf]}function $TJ(){$Tp.un(this,"constructor",$Tt)}$TJ.prototype=$TM.prototype,$Tt.prototype=new $TJ,$Tp.un($Tt.prototype,"__imps",$Tp.__copy({},$TM.prototype.__imps))},__copy:function($Tt,$TM){if(!$TM)return null;for(var $Tf in $Tt=$Tt||{},$TM)$Tt[$Tf]=$TM[$Tf];return $Tt},__package:function($Tt,$TM){if(!$Tp.__packages[$Tt]){$Tp.__packages[$Tt]=!0;var $Tf=$TL,$Tc=$Tt.split(".");if(1<$Tc.length)for(var $TD=0,$To=$Tc.length-1;$TD<$To;$TD++){var $TJ=$Tf[$Tc[$TD]];$Tf=$TJ||($Tf[$Tc[$TD]]={})}$Tf[$Tc[$Tc.length-1]]||($Tf[$Tc[$Tc.length-1]]=$TM||{})}},__hasOwnProperty:function($Tt,$TM){return $TM=$TM||this,Object.hasOwnProperty.call($TM,$Tt)||function $Tt($TM,$Tf){if(Object.hasOwnProperty.call($Tf.prototype,$TM))return!0;var $Tc=$Tf.prototype.__super;return null==$Tc?null:$Tt($TM,$Tc)}($Tt,$TM.__class)},__typeof:function($Tt,$TM){if(!$Tt||!$TM)return!1;if($TM===String)return"string"==typeof $Tt;if($TM===Number)return"number"==typeof $Tt;if($TM.__interface__)$TM=$TM.__interface__;else if("string"!=typeof $TM)return $Tt instanceof $TM;return $Tt.__imps&&$Tt.__imps[$TM]||$Tt.__class==$TM},__as:function($Tt,$TM){return this.__typeof($Tt,$TM)?$Tt:null},__int:function($Tt){return $Tt?parseInt($Tt):0},interface:function($Tt,$TM){$Tp.__package($Tt,{});var $Tf=$Tp.__internals,$Tc=$Tf[$Tt]=$Tf[$Tt]||{self:$Tt};if($TM){var $TD=$TM.split(",");$Tc.extend=[];for(var $To=0;$To<$TD.length;$To++){var $TJ=$TD[$To];$Tf[$TJ]=$Tf[$TJ]||{self:$TJ},$Tc.extend.push($Tf[$TJ])}}var $TZ=$TL,$TA=$Tt.split(".");for($To=0;$To<$TA.length-1;$To++)$TZ=$TZ[$TA[$To]];$TZ[$TA[$TA.length-1]]={__interface__:$Tt}},class:function($Tt,$TM,$Tf,$Tc){if($Tf&&$Tp.__extend($Tt,$Tf),$TM)if($Tp.__package($TM,$Tt),$Tp.__classmap[$TM]=$Tt,0<$TM.indexOf(".")){if(0==$TM.indexOf("laya.")){var $TD=$TM.split(".");$Tc=$Tc||$TD[$TD.length-1],$Tp[$Tc]&&console.log("Warning!,this class["+$Tc+"] already exist:",$Tp[$Tc]),$Tp[$Tc]=$Tt}}else"Main"==$TM?$TL.Main=$Tt:"MainWX"==$TM?$TL.MainWX=$Tt:($Tp[$TM]&&console.log("Error!,this class["+$TM+"] already exist:",$Tp[$TM]),$Tp[$TM]=$Tt);var $To=$Tp.un,$TJ=$Tt.prototype;$To($TJ,"hasOwnProperty",$Tp.__hasOwnProperty),$To($TJ,"__class",$Tt),$To($TJ,"__super",$Tf),$To($TJ,"__className",$TM),$To($Tt,"__super",$Tf),$To($Tt,"__className",$TM),$To($Tt,"__isclass",!0),$To($Tt,"super",function($Tt){this.__super.call($Tt)})},imps:function($Tt,$TM){if(!$TM)return null;var $TD=$Tt.__imps||$Tp.un($Tt,"__imps",{});function $To($Tt){var $TM,$Tf;if(($TM=$Tp.__internals[$Tt])&&($TD[$Tt]=!0,$Tf=$TM.extend))for(var $Tc=0;$Tc<$Tf.length;$Tc++)$To($Tf[$Tc].self)}for(var $Tf in $TM)$To($Tf)},superSet:function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.prototype["_$set_"+$Tf];$TD&&$TD.call($TM,$Tc)},superGet:function($Tt,$TM,$Tf){var $Tc=$Tt.prototype["_$get_"+$Tf];return $Tc?$Tc.call($TM):null},getset:function($Tt,$TM,$Tf,$Tc,$TD){$Tt?($Tc&&($TM["_$GET_"+$Tf]=$Tc),$TD&&($TM["_$SET_"+$Tf]=$TD)):($Tc&&$Tp.un($TM,"_$get_"+$Tf,$Tc),$TD&&$Tp.un($TM,"_$set_"+$Tf,$TD)),$Tc&&$TD?Object.defineProperty($TM,$Tf,{get:$Tc,set:$TD,enumerable:!1,configurable:!0}):($Tc&&Object.defineProperty($TM,$Tf,{get:$Tc,enumerable:!1,configurable:!0}),$TD&&Object.defineProperty($TM,$Tf,{set:$TD,enumerable:!1,configurable:!0}))},static:function($Tf,$Tc){for(var $TD=0,$Tt=$Tc.length;$TD<$Tt;$TD+=2)if("length"==$Tc[$TD])$Tf.length=$Tc[$TD+1].call($Tf);else{function $TM(){var $TM=$Tc[$TD],$Tt=$Tc[$TD+1];Object.defineProperty($Tf,$TM,{get:function(){return delete this[$TM],this[$TM]=$Tt.call(this)},set:function($Tt){delete this[$TM],this[$TM]=$Tt},enumerable:!0,configurable:!0})}$TM()}},un:function($Tt,$TM,$Tf){return $Tf||($Tf=$Tt[$TM]),$Tp.__propun.value=$Tf,Object.defineProperty($Tt,$TM,$Tp.__propun),$Tf},uns:function($TM,$Tt){$Tt.forEach(function($Tt){$Tp.un($TM,$Tt)})}};return $TL.console=$TL.console||{log:function(){}},$TL.trace=$TL.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$Tp}(window,document);!function($Tt,$TM,$Tf){$Tf.un,$Tf.uns,$Tf.static,$Tf.class,$Tf.getset,$Tf.__newvec}(window,document,Laya),function($TJ,$TM,$TT){$TT.un,$TT.uns;var $TA=$TT.static,$Tp=$TT.class,$Tq=$TT.getset;$TT.__newvec;$TT.interface("laya.runtime.IMarket"),$TT.interface("laya.filters.IFilter"),$TT.interface("laya.display.ILayout"),$TT.interface("laya.resource.IDispose"),$TT.interface("laya.runtime.IPlatform"),$TT.interface("laya.resource.IDestroy"),$TT.interface("laya.runtime.IConchNode"),$TT.interface("laya.filters.IFilterAction"),$TT.interface("laya.runtime.ICPlatformClass"),$TT.interface("laya.resource.ICreateResource"),$TT.interface("laya.runtime.IConchRenderObject"),$TT.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $TU=function(){function $To(){}return $Tp($To,"laya.utils.RunDriver"),$To.FILTER_ACTIONS=[],$To.pixelRatio=-1,$To._charSizeTestDiv=null,$To.now=function(){return Date.now()},$To.getWindow=function(){return $TJ},$To.getPixelRatio=function(){if($To.pixelRatio<0){var $Tt=$TK.context,$TM=$Tt.backingStorePixelRatio||$Tt.webkitBackingStorePixelRatio||$Tt.mozBackingStorePixelRatio||$Tt.msBackingStorePixelRatio||$Tt.oBackingStorePixelRatio||$Tt.backingStorePixelRatio||1;($To.pixelRatio=($TK.window.devicePixelRatio||1)/$TM)<1&&($To.pixelRatio=1)}return $To.pixelRatio},$To.getIncludeStr=function($Tt){return null},$To.createShaderCondition=function($Tt){var $TM="(function() {return "+$Tt+";})";return $TT._runScript($TM)},$To.fontMap=[],$To.measureText=function($Tt,$TM){var $Tf=$To.hanzi.test($Tt);if($Tf&&$To.fontMap[$TM])return $To.fontMap[$TM];var $Tc=$TK.context;$Tc.font=$TM;var $TD=$Tc.measureText($Tt);return $TD||($TD={width:16,height:16}),$Tf&&($To.fontMap[$TM]=$TD),$TD},$To.getWebGLContext=function($Tt){},$To.beginFlush=function(){},$To.endFinish=function(){},$To.addToAtlas=null,$To.flashFlushImage=function($Tt){},$To.drawToCanvas=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$TNt.create("2D"),$TZ=new $Tr($Tf,$Tc,$TJ);return $Tu.renders[$TM]._fun($Tt,$TZ,$TD,$To),$TJ},$To.createParticleTemplate2D=null,$To.createGLTextur=null,$To.createWebGLContext2D=null,$To.changeWebGLSize=function($Tt,$TM){},$To.createRenderSprite=function($Tt,$TM){return new $Tu($Tt,$TM)},$To.createFilterAction=function($Tt){return new $TN},$To.createGraphics=function(){return new $Tb},$To.clear=function($Tt){$Ts._context.ctx.clear()},$To.cancelLoadByUrl=function($Tt){},$To.clearAtlas=function($Tt){},$To.isAtlas=function($Tt){return!1},$To.addTextureToAtlas=function($Tt){},$To.getTexturePixels=function($Tt,$TM,$Tf,$Tc,$TD){return null},$To.skinAniSprite=function(){return null},$To.update3DLoop=function(){},$TA($To,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$To}(),$Tc=($Tq(1,$TT,"alertGlobalError",null,function($Tt){var $To=0;$TK.window.onerror=$Tt?function($Tt,$TM,$Tf,$Tc,$TD){$To++<5&&$TD&&alert($TD.stack||$TD)}:null}),$TT.init=function($Tt,$TM,$Tf){for(var $Tc=[],$TD=2,$To=arguments.length;$TD<$To;$TD++)$Tc.push(arguments[$TD]);if(!$TT._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$TT._arrayBufferSlice),$TT._isinit=!0,$TK.__init__(),$Tv.__init__(),$Tb.__init__(),$TT.timer=new $Tm,$TT.scaleTimer=new $Tm,$TT.loader=new $TAt,$Tw.__init__(),$TD=0;for(var $TJ=$Tc.length;$TD<$TJ;$TD++)$Tc[$TD].enable&&$Tc[$TD].enable();return $TI.__init__(),$TZ.__init__(),$Tk.__init__(),$Td.beginCheck(),$TT._currentStage=$TT.stage=new $TEt,$TT.stage.conchModel&&$TT.stage.conchModel.setRootNode(),$TT._getUrlPath(),$TT.render=new $Ts(0,0),$TT.stage.size($Tt,$TM),$Tu.__init__(),$TB.__init__(),$Tl.instance.__init__($TT.stage,$Ts.canvas),$Tyt.__init__(),$TC.autoStopMusic=!0,$Tx.__init__(),$Ts.canvas}},$TT._getUrlPath=function(){var $Tt=$TK.window.location,$TM=$Tt.pathname;$TM=$TM&&":"==$TM.charAt(2)?$TM.substring(1):$TM,$TH.rootPath=$TH.basePath=$TH.getPath("file:"==$Tt.protocol?$TM:$Tt.protocol+"//"+$Tt.host+$Tt.pathname)},$TT._arrayBufferSlice=function($Tt,$TM){var $Tf=new Uint8Array(this,$Tt,$TM-$Tt),$Tc=new Uint8Array($Tf.length);return $Tc.set($Tf),$Tc.buffer},$TT._runScript=function($Tt){return $TK.window[$TT._evcode]($Tt)},$TT.stage=null,$TT.timer=null,$TT.scaleTimer=null,$TT.loader=null,$TT.version="1.8.6",$TT.render=null,$TT._currentStage=null,$TT._isinit=!1,$TT.isDebug=!1,$TT.MiniAdpter={init:function(){$TJ.navigator&&$TJ.navigator.userAgent&&-1<$TJ.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$TA($TT,["conchMarket",function(){return this.conchMarket=$TJ.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$TJ.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $Tt(){}return $Tp($Tt,"Config"),$Tt.WebGLTextCacheCount=500,$Tt.atlasEnable=!1,$Tt.showCanvasMark=!1,$Tt.animationInterval=50,$Tt.isAntialias=!1,$Tt.isAlpha=!1,$Tt.premultipliedAlpha=!0,$Tt.isStencil=!0,$Tt.preserveDrawingBuffer=!1,$Tt}()),$TL=function(){function $TL(){this._events=null}$Tp($TL,"laya.events.EventDispatcher");var $Tt=$TL.prototype;return $Tt.hasListener=function($Tt){return!!(this._events&&this._events[$Tt])},$Tt.getListener=function($Tt){return this._events?this._events[$Tt]:null},$Tt.event=function($Tt,$TM){if(!this._events||!this._events[$Tt])return!1;var $Tf=this._events[$Tt];if($Tf.lock)$Tf.queue||($Tf.queue=[]),$Tf.queue.push($TM);else{var $Tc;for($Tf.lock=!0,$Tf.cursor=$Tf.head;$Tf.cursor;)($Tc=$Tf.cursor).recover?($Tf.head=$Tf.tail=$Tf.cursor=null,console.error("node is recover："+$Tc.id)):($Tf.cursor=$Tc.next,$Tc.once&&$TL.delNode($Tf,$Tc),$Tc.method&&(null!=$TM?$Tc.args?$Tc.method.apply($Tc.caller,$Tc.args.concat($TM)):$TM instanceof Array?$Tc.method.apply($Tc.caller,$TM):$Tc.caller?$Tc.method.call($Tc.caller,$TM):$TT.recordError("事件派发错误","node.caller:"+$Tc.caller+"node.method:"+$Tc.method+"data:"+$TM+"node.prev"+$Tc.prev):$Tc.method.apply($Tc.caller,$Tc.args)),$Tc.once&&$TL.recoverHandler($Tc));$Tf.lock=!1,!$Tf.head&&this._events&&this._events[$Tt]==$Tf&&delete this._events[$Tt],$Tf.queue&&$Tf.queue.length&&this.event($Tt,$Tf.queue.shift())}return!0},$Tt.on=function($Tt,$TM,$Tf,$Tc){return this._createListener($Tt,$TM,$Tf,$Tc,!1)},$Tt.once=function($Tt,$TM,$Tf,$Tc){return this._createListener($Tt,$TM,$Tf,$Tc,!0)},$Tt._createListener=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=!0),$To&&this.off($Tt,$TM,$Tf,$TD);var $TJ=$TL.createHandler($TM||this,$Tf,$Tc,$TD);this._events||(this._events={});var $TZ=this._events,$TA=$TZ[$Tt];return $TA?$TA.tail?($TJ.prev=$TA.tail,$TA.tail.next=$TJ,$TA.tail=$TJ):$TA.head=$TA.tail=$TJ:$TZ[$Tt]={head:$TJ,tail:$TJ,cursor:null,lock:!1},this},$Tt.off=function($Tt,$TM,$Tf,$Tc){if(void 0===$Tc&&($Tc=!1),!this._events||!this._events[$Tt])return this;for(var $TD=this._events[$Tt],$To=$TD.head;$To;){if((!$TM||$To.caller===$TM)&&$To.method===$Tf&&(!$Tc||$To.once)){$TL.delNode($TD,$To),$TD.cursor==$To&&($TD.cursor=$To.next),$TL.recoverHandler($To);break}$To=$To.next}return this},$Tt.offAll=function($Tt){var $TM=this._events;if(!$TM)return this;if($Tt)this._recoverHandlers($TM[$Tt]),delete $TM[$Tt];else{for(var $Tf in $TM)this._recoverHandlers($TM[$Tf]);this._events=null}return this},$Tt._recoverHandlers=function($Tt){if($Tt){for(var $TM=$Tt.head;$TM;){$TL.delNode($Tt,$TM);var $Tf=$TM.next;$TL.recoverHandler($TM),$TM=$Tf}$Tt.cursor=null}},$Tt.isMouseEvent=function($Tt){return $TL.MOUSE_EVENTS[$Tt]},$TL.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$TL.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$TL.delNode=function($Tt,$TM){$TM.prev?$TM.prev.next=$TM.next:$Tt.head=$TM.next,$TM.next?$TM.next.prev=$TM.prev:$Tt.tail=$TM.prev},$TL.createHandler=function($Tt,$TM,$Tf,$Tc){var $TD=500<$TL._freeHandler.length?$TL._freeHandler.shift():null;if($TD)if($TD.recover)$TD.recover=!1,$TD.caller=$Tt,$TD.method=$TM,$TD.args=$Tf,$TD.once=$Tc;else{var $To="";try{arguments.propertyIsEnumerable.caller}catch($Tt){$To=$Tt.stack}var $TJ=$TD.caller?($TD.caller.__proto__&&$TD.caller.__proto__.constructor&&$TD.caller.__proto__.constructor.name)+"|"+$TD.caller.__className+"|"+$TD.caller.name:"",$TZ=$TD.method?$TD.method.name:"";$TT.recordError("EventDispatcher重复创建","caller="+$TJ+"  method="+$TZ+"  stack="+$To),$TD={id:++$TL._nodeCount,caller:$Tt,method:$TM,args:$Tf,once:$Tc,recover:!1}}else $TD={id:++$TL._nodeCount,caller:$Tt,method:$TM,args:$Tf,once:$Tc,recover:!1};return $TD.prev=$TD.next=null,$TD},$TL.recoverHandler=function($Tt){if($Tt.recover){if($TL._errorCount<5){$TL._errorCount++;var $TM="";try{arguments.propertyIsEnumerable.caller}catch($Tt){$TM=$Tt.stack}var $Tf=$Tt.caller?($Tt.caller.__proto__&&$Tt.caller.__proto__.constructor&&$Tt.caller.__proto__.constructor.name)+"|"+$Tt.caller.__className+"|"+$Tt.caller.name:"",$Tc=$Tt.method?$Tt.method.name:"";$TT.recordError("EventDispatcher重复回收","id="+$Tt.id+"  caller="+$Tf+"  method="+$Tc+"  stack="+$TM)}$Tt.caller=$Tt.method=$Tt.args=$Tt.prev=null}else $Tt.recover=!0,$Tt.caller=$Tt.method=$Tt.args=$Tt.prev=$Tt.next=null,$TL._freeHandler&&$TL._freeHandler.length<3e3&&$TL._freeHandler.push($Tt)},$TL._freeHandler=[],$TL._nodeCount=0,$TL._errorCount=0,$TL}(),$Te=function(){function $TD($Tt,$TM,$Tf,$Tc){this.once=!1,void(this._id=0)===$Tc&&($Tc=!1),this.setTo($Tt,$TM,$Tf,$Tc)}$Tp($TD,"laya.utils.Handler");var $Tt=$TD.prototype;return $Tt.setTo=function($Tt,$TM,$Tf,$Tc){return this._id=$TD._gid++,this.caller=$Tt,this.method=$TM,this.args=$Tf,this.once=$Tc,this},$Tt.run=function(){if(null==this.method)return null;var $Tt=this._id,$TM=this.method.apply(this.caller,this.args);return this._id===$Tt&&this.once&&this.recover(),$TM},$Tt.runWith=function($Tt){if(null==this.method)return null;var $TM=this._id;if(null==$Tt)var $Tf=this.method.apply(this.caller,this.args);else $Tf=this.args||$Tt.unshift?this.args?this.method.apply(this.caller,this.args.concat($Tt)):this.method.apply(this.caller,$Tt):this.method.call(this.caller,$Tt);return this._id===$TM&&this.once&&this.recover(),$Tf},$Tt.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$Tt.recover=function(){0<this._id&&(this._id=0,this.clear())},$TD.create=function($Tt,$TM,$Tf,$Tc){return void 0===$Tc&&($Tc=!0),new $TD($Tt,$TM,$Tf,$Tc)},$TD._gid=1,$TD}(),$TO=function(){function $Tt(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$Tp($Tt,"laya.display.BitmapFont");var $TM=$Tt.prototype;return $TM.loadFont=function($Tt,$TM){this._path=$Tt,this._complete=$TM,$TT.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$Te.create(this,this.onLoaded))},$TM.onLoaded=function(){this.parseFont($TZt.getRes(this._path),$TZt.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$TM.parseFont=function($Tt,$TM){if(null!=$Tt&&null!=$TM){this._texture=$TM;var $Tf=$Tt.getElementsByTagName("info");if(!$Tf[0].getAttributeNode)return this.parseFont2($Tt,$TM);this.fontSize=parseInt($Tf[0].getAttributeNode("size").nodeValue);var $Tc,$TD=$Tf[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($TD[0]),parseInt($TD[1]),parseInt($TD[2]),parseInt($TD[3])],$Tc=$Tt.getElementsByTagName("char");var $To=0;for($To=0;$To<$Tc.length;$To++){var $TJ=$Tc[$To],$TZ=parseInt($TJ.getAttributeNode("id").nodeValue),$TA=parseInt($TJ.getAttributeNode("xoffset").nodeValue)/1,$TL=parseInt($TJ.getAttributeNode("yoffset").nodeValue)/1,$Tp=parseInt($TJ.getAttributeNode("xadvance").nodeValue)/1,$TB=new $TV;$TB.x=parseInt($TJ.getAttributeNode("x").nodeValue),$TB.y=parseInt($TJ.getAttributeNode("y").nodeValue),$TB.width=parseInt($TJ.getAttributeNode("width").nodeValue),$TB.height=parseInt($TJ.getAttributeNode("height").nodeValue);var $Tb=$Tpt.create($TM,$TB.x,$TB.y,$TB.width,$TB.height,$TA,$TL);this._maxWidth=Math.max(this._maxWidth,$Tp+this.letterSpacing),this._fontCharDic[$TZ]=$Tb,this._fontWidthMap[$TZ]=$Tp}}},$TM.parseFont2=function($Tt,$TM){if(null!=$Tt&&null!=$TM){this._texture=$TM;var $Tf=$Tt.getElementsByTagName("info");this.fontSize=parseInt($Tf[0].attributes.size.nodeValue);var $Tc=$Tf[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($Tc[0]),parseInt($Tc[1]),parseInt($Tc[2]),parseInt($Tc[3])];var $TD=$Tt.getElementsByTagName("char"),$To=0;for($To=0;$To<$TD.length;$To++){var $TJ=$TD[$To].attributes,$TZ=parseInt($TJ.id.nodeValue),$TA=parseInt($TJ.xoffset.nodeValue)/1,$TL=parseInt($TJ.yoffset.nodeValue)/1,$Tp=parseInt($TJ.xadvance.nodeValue)/1,$TB=new $TV;$TB.x=parseInt($TJ.x.nodeValue),$TB.y=parseInt($TJ.y.nodeValue),$TB.width=parseInt($TJ.width.nodeValue),$TB.height=parseInt($TJ.height.nodeValue);var $Tb=$Tpt.create($TM,$TB.x,$TB.y,$TB.width,$TB.height,$TA,$TL);this._maxWidth=Math.max(this._maxWidth,$Tp+this.letterSpacing),this._fontCharDic[$TZ]=$Tb,this._fontWidthMap[$TZ]=$Tp}}},$TM.getCharTexture=function($Tt){return this._fontCharDic[$Tt.charCodeAt(0)]},$TM.destroy=function(){if(this._texture){for(var $Tt in this._fontCharDic){var $TM=this._fontCharDic[$Tt];$TM&&$TM.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$TM.setSpaceWidth=function($Tt){this._spaceWidth=$Tt},$TM.getCharWidth=function($Tt){var $TM=$Tt.charCodeAt(0);return this._fontWidthMap[$TM]?this._fontWidthMap[$TM]+this.letterSpacing:" "==$Tt?this._spaceWidth+this.letterSpacing:0},$TM.getTextWidth=function($Tt){for(var $TM=0,$Tf=0,$Tc=$Tt.length;$Tf<$Tc;$Tf++)$TM+=this.getCharWidth($Tt.charAt($Tf));return $TM},$TM.getMaxWidth=function(){return this._maxWidth},$TM.getMaxHeight=function(){return this.fontSize},$TM.drawText=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ=this.getTextWidth($Tt),$TA=0;"center"===$TD&&($TA=($To-$TZ)/2),"right"===$TD&&($TA=$To-$TZ);for(var $TL=0,$Tp=0,$TB=$Tt.length;$Tp<$TB;$Tp++)($TJ=this.getCharTexture($Tt.charAt($Tp)))&&($TM.graphics.drawTexture($TJ,$Tf+$TL+$TA,$Tc),$TL+=this.getCharWidth($Tt.charAt($Tp)))},$Tt}(),$TZ=function(){function $Tf(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$Tf._TF_EMPTY}$Tp($Tf,"laya.display.css.Style");var $Tt=$Tf.prototype;return $Tt.getTransform=function(){return this._tf},$Tt.setTransform=function($Tt){this._tf="none"!==$Tt&&$Tt?$Tt:$Tf._TF_EMPTY},$Tt.setTranslateX=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.translateX=$Tt},$Tt.setTranslateY=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.translateY=$Tt},$Tt.setScaleX=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.scaleX=$Tt},$Tt.setScale=function($Tt,$TM){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.scaleX=$Tt,this._tf.scaleY=$TM},$Tt.setScaleY=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.scaleY=$Tt},$Tt.setRotate=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.rotate=$Tt},$Tt.setSkewX=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.skewX=$Tt},$Tt.setSkewY=function($Tt){this._tf===$Tf._TF_EMPTY&&(this._tf=new $TD),this._tf.skewY=$Tt},$Tt.destroy=function(){this.scrollRect=null},$Tt.render=function($Tt,$TM,$Tf,$Tc){},$Tt.getCSSStyle=function(){return $TMt.EMPTY},$Tt._enableLayout=function(){return!1},$Tq(0,$Tt,"scaleX",function(){return this._tf.scaleX},function($Tt){this.setScaleX($Tt)}),$Tq(0,$Tt,"transform",function(){return this.getTransform()},function($Tt){this.setTransform($Tt)}),$Tq(0,$Tt,"translateX",function(){return this._tf.translateX},function($Tt){this.setTranslateX($Tt)}),$Tq(0,$Tt,"translateY",function(){return this._tf.translateY},function($Tt){this.setTranslateY($Tt)}),$Tq(0,$Tt,"scaleY",function(){return this._tf.scaleY},function($Tt){this.setScaleY($Tt)}),$Tq(0,$Tt,"block",function(){return 0!=(1&this._type)}),$Tq(0,$Tt,"skewY",function(){return this._tf.skewY},function($Tt){this.setSkewY($Tt)}),$Tq(0,$Tt,"rotate",function(){return this._tf.rotate},function($Tt){this.setRotate($Tt)}),$Tq(0,$Tt,"skewX",function(){return this._tf.skewX},function($Tt){this.setSkewX($Tt)}),$Tq(0,$Tt,"paddingLeft",function(){return 0}),$Tq(0,$Tt,"paddingTop",function(){return 0}),$Tq(0,$Tt,"absolute",function(){return!0}),$Tf.__init__=function(){$Tf._TF_EMPTY=new $TD,$Tf.EMPTY=new $Tf},$Tf.EMPTY=null,$Tf._TF_EMPTY=null,$Tf}(),$TI=function(){function $TM($Tt){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$TP.create($TM.defaultColor),this.family=$TM.defaultFamily,this.stroke=$TM._STROKE,this.size=$TM.defaultSize,$Tt&&$Tt!==$TM.EMPTY&&$Tt.copyTo(this)}$Tp($TM,"laya.display.css.Font");var $Tt=$TM.prototype;return $Tt.set=function($Tt){this._text=null;for(var $TM=$Tt.split(" "),$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){var $TD=$TM[$Tf];switch($TD){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$TD.indexOf("px")&&(this.size=parseInt($TD),this.family=$TM[$Tf+1],$Tf++)}},$Tt.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$Tt.copyTo=function($Tt){$Tt._type=this._type,$Tt._text=this._text,$Tt._weight=this._weight,$Tt._color=this._color,$Tt.family=this.family,$Tt.stroke=this.stroke!=$TM._STROKE?this.stroke.slice():$TM._STROKE,$Tt.indent=this.indent,$Tt.size=this.size},$Tq(0,$Tt,"password",function(){return 0!=(1024&this._type)},function($Tt){$Tt?this._type|=1024:this._type&=-1025}),$Tq(0,$Tt,"color",function(){return this._color.strColor},function($Tt){this._color=$TP.create($Tt)}),$Tq(0,$Tt,"italic",function(){return 0!=(512&this._type)},function($Tt){$Tt?this._type|=512:this._type&=-513}),$Tq(0,$Tt,"bold",function(){return 0!=(2048&this._type)},function($Tt){$Tt?this._type|=2048:this._type&=-2049}),$Tq(0,$Tt,"weight",function(){return""+this._weight},function($Tt){var $TM=0;switch($Tt){case"normal":break;case"bold":this.bold=!0,$TM=700;break;case"bolder":$TM=800;break;case"lighter":$TM=100;break;default:$TM=parseInt($Tt)}this._weight=$TM,this._text=null}),$Tq(0,$Tt,"decoration",function(){return this._decoration?this._decoration.value:null},function($Tt){var $TM=$Tt.split(" ");switch(this._decoration||(this._decoration={}),$TM[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$TM[0]}$TM[1]&&(this._decoration.color=$TP.create($TM)),this._decoration.value=$Tt}),$TM.__init__=function(){$TM.EMPTY=new $TM(null)},$TM.EMPTY=null,$TM.defaultColor="#000000",$TM.defaultSize=12,$TM.defaultFamily="Arial",$TM.defaultFont="12px Arial",$TM._STROKE=[0,"#000000"],$TM._ITALIC=512,$TM._PASSWORD=1024,$TM._BOLD=2048,$TM}(),$TD=function(){function $Tt(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $Tp($Tt,"laya.display.css.TransformInfo"),$Tt}(),$Tb=function(){function $TB(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$Ts.isConchNode){this._nativeObj=new $TJ._conchGraphics,this.id=this._nativeObj.conchID}}$Tp($TB,"laya.display.Graphics");var $Tt=$TB.prototype;return $Tt.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$Tt.clear=function($Tt){void 0===$Tt&&($Tt=!1);var $TM=0,$Tf=0;if($Tt){var $Tc=this._one;if(this._cmds){for($Tf=this._cmds.length,$TM=0;$TM<$Tf;$TM++)!($Tc=this._cmds[$TM])||$Tc.callee!==$Ts._context._drawTexture&&$Tc.callee!==$Ts._context._drawTextureWithTransform||($Tc[0]=null,$TB._cache.push($Tc));this._cmds.length=0}else $Tc&&(!$Tc||$Tc.callee!==$Ts._context._drawTexture&&$Tc.callee!==$Ts._context._drawTextureWithTransform||($Tc[0]=null,$TB._cache.push($Tc)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($TM=0,$Tf=this._vectorgraphArray.length;$TM<$Tf;$TM++)$TQ.getInstance().deleteShape(this._vectorgraphArray[$TM]);this._vectorgraphArray.length=0}},$Tt._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$Tt._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $Tf,this._graphicBounds._graphics=this)},$Tt._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$Tt._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$Tt.getBounds=function($Tt){return void 0===$Tt&&($Tt=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($Tt)},$Tt.getBoundPoints=function($Tt){return void 0===$Tt&&($Tt=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($Tt)},$Tt._addCmd=function($Tt){this._cmds=this._cmds||[],$Tt.callee=$Tt.shift(),this._cmds.push($Tt)},$Tt.setFilters=function($Tt){this._saveToCmd($Ts._context._setFilters,$Tt)},$Tt.drawTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$TJ&&($TJ=1),!$Tt||$TJ<.01)return null;$Tc||($Tc=$Tt.sourceWidth),$TD||($TD=$Tt.sourceHeight),$TJ=$TJ<0?0:1<$TJ?1:$TJ;var $TZ,$TA=!$Ts.isWebGL&&($TK.onFirefox||$TK.onEdge||$TK.onIE||$TK.onSafari)?.5:0,$TL=$Tc/$Tt.sourceWidth,$Tp=$TD/$Tt.sourceHeight;return $Tc=$Tt.width*$TL,$TD=$Tt.height*$Tp,$Tt.loaded&&($Tc<=0||$TD<=0)?null:($TM+=$Tt.offsetX*$TL,$Tf+=$Tt.offsetY*$Tp,this._sp&&(this._sp._renderType|=512),$TM-=$TA,$Tf-=$TA,$Tc+=2*$TA,$TD+=2*$TA,$TB._cache.length?(($TZ=$TB._cache.pop())[0]=$Tt,$TZ[1]=$TM,$TZ[2]=$Tf,$TZ[3]=$Tc,$TZ[4]=$TD,$TZ[5]=$To,$TZ[6]=$TJ):$TZ=[$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ],$TZ.callee=$To||1!=$TJ?$Ts._context._drawTextureWithTransform:$Ts._context._drawTexture,null!=this._one||$To||1!=$TJ?this._saveToCmd($TZ.callee,$TZ):(this._one=$TZ,this._render=this._renderOneImg),$Tt.loaded||$Tt.once("loaded",this,this._textureLoaded,[$Tt,$TZ]),this._repaint(),$TZ)},$Tt.cleanByTexture=function($Tt,$TM,$Tf,$Tc,$TD){if(void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),!$Tt)return this.clear();if(this._one&&this._render===this._renderOneImg){$Tc||($Tc=$Tt.sourceWidth),$TD||($TD=$Tt.sourceHeight);var $To=$Tc/$Tt.sourceWidth,$TJ=$TD/$Tt.sourceHeight;$Tc=$Tt.width*$To,$TD=$Tt.height*$TJ,$TM+=$Tt.offsetX*$To,$Tf+=$Tt.offsetY*$TJ,this._one[0]=$Tt,this._one[1]=$TM,this._one[2]=$Tf,this._one[3]=$Tc,this._one[4]=$TD,this._repaint()}else this.clear(),$Tt&&this.drawTexture($Tt,$TM,$Tf,$Tc,$TD)},$Tt.drawTextures=function($Tt,$TM){$Tt&&this._saveToCmd($Ts._context._drawTextures,[$Tt,$TM])},$Tt.fillTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$To&&($To="repeat"),$Tt){var $TZ=[$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ||$Ti.EMPTY,{}];$Tt.loaded||$Tt.once("loaded",this,this._textureLoaded,[$Tt,$TZ]),this._saveToCmd($Ts._context._fillTexture,$TZ)}},$Tt._textureLoaded=function($Tt,$TM){$TM[3]=$TM[3]||$Tt.width,$TM[4]=$TM[4]||$Tt.height,this._repaint()},$Tt.fillCircle=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tf.bitmap.enableMerageInAtlas=!1;var $TZ=new Float32Array(2*($TJ+1)),$TA=new Float32Array(2*($TJ+1)),$TL=new Uint16Array(3*$TJ),$Tp=2*Math.PI/$TJ,$TB=0;$TZ[0]=$Tc,$TZ[1]=$TD,$TA[0]=$Tc/$Tf.width,$TA[1]=$TD/$Tf.height;for(var $Tb=2,$TI=0;$TI<$TJ;$TI++){var $Tq=$To*Math.cos($TB)+$Tc,$Tl=$To*Math.sin($TB)+$TD;$TZ[$Tb]=$Tq,$TZ[$Tb+1]=$Tl,$TA[$Tb]=$Tq/$Tf.width,$TA[$Tb+1]=$Tl/$Tf.height,$TB+=$Tp,$Tb+=2}for($TI=$Tb=0;$TI<$TJ;$TI++)$TL[$Tb++]=0,$TL[$Tb++]=$TI+1,$TL[$Tb++]=$TJ+1<=$TI+2?1:$TI+2;this.drawTriangles($Tf,$Tt,$TM,$TZ,$TA,$TL)},$Tt.drawTriangles=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){void 0===$TZ&&($TZ=1),this._saveToCmd($Ts._context.drawTriangles,[$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL])},$Tt._saveToCmd=function($Tt,$TM){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$TM,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($TM)),$TM.callee=$Tt,this._repaint(),$TM},$Tt.clipRect=function($Tt,$TM,$Tf,$Tc){this._saveToCmd($Ts._context._clipRect,[$Tt,$TM,$Tf,$Tc])},$Tt.fillText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){void 0===$TJ&&($TJ=0),this._saveToCmd($Ts._context._fillText,[$Tt,$TM,$Tf,$Tc||$TI.defaultFont,$TD,$To])},$Tt.fillBorderText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){this._saveToCmd($Ts._context._fillBorderText,[$Tt,$TM,$Tf,$Tc||$TI.defaultFont,$TD,$To,$TJ,$TZ])},$Tt.strokeText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._saveToCmd($Ts._context._strokeText,[$Tt,$TM,$Tf,$Tc||$TI.defaultFont,$TD,$To,$TJ])},$Tt.alpha=function($Tt){$Tt=$Tt<0?0:1<$Tt?1:$Tt,this._saveToCmd($Ts._context._alpha,[$Tt])},$Tt.setAlpha=function($Tt){$Tt=$Tt<0?0:1<$Tt?1:$Tt,this._saveToCmd($Ts._context._setAlpha,[$Tt])},$Tt.transform=function($Tt,$TM,$Tf){void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),this._saveToCmd($Ts._context._transform,[$Tt,$TM,$Tf])},$Tt.rotate=function($Tt,$TM,$Tf){void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),this._saveToCmd($Ts._context._rotate,[$Tt,$TM,$Tf])},$Tt.scale=function($Tt,$TM,$Tf,$Tc){void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),this._saveToCmd($Ts._context._scale,[$Tt,$TM,$Tf,$Tc])},$Tt.translate=function($Tt,$TM){this._saveToCmd($Ts._context._translate,[$Tt,$TM])},$Tt.save=function(){this._saveToCmd($Ts._context._save,[])},$Tt.restore=function(){this._saveToCmd($Ts._context._restore,[])},$Tt.replaceText=function($Tt){this._repaint();var $TM=this._cmds;if($TM){for(var $Tf=$TM.length-1;-1<$Tf;$Tf--)if(this._isTextCmd($TM[$Tf].callee))return $TM[$Tf][0].toUpperCase?$TM[$Tf][0]=$Tt:$TM[$Tf][0].setText($Tt),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$Tt:this._one[0].setText($Tt),!0;return!1},$Tt._isTextCmd=function($Tt){return $Tt===$Ts._context._fillText||$Tt===$Ts._context._fillBorderText||$Tt===$Ts._context._strokeText},$Tt.replaceTextColor=function($Tt){this._repaint();var $TM=this._cmds;if($TM)for(var $Tf=$TM.length-1;-1<$Tf;$Tf--)this._isTextCmd($TM[$Tf].callee)&&($TM[$Tf][4]=$Tt,$TM[$Tf][0].toUpperCase||($TM[$Tf][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$Tt,this._one[0].toUpperCase||(this._one[0].changed=!0))},$Tt.loadImage=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=this;void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0);var $TZ=$TZt.getRes($Tt);function $TA($Tt){$Tt&&($TJ.drawTexture($Tt,$TM,$Tf,$Tc,$TD),null!=$To&&$To.call($TJ._sp,$Tt))}$TZ?$TA($TZ):$TT.loader.load($Tt,$Te.create(null,$TA),null,"image")},$Tt._renderEmpty=function($Tt,$TM,$Tf,$Tc){},$Tt._renderAll=function($Tt,$TM,$Tf,$Tc){for(var $TD,$To=this._cmds,$TJ=0,$TZ=$To.length;$TJ<$TZ;$TJ++)($TD=$To[$TJ]).callee.call($TM,$Tf,$Tc,$TD)},$Tt._renderOne=function($Tt,$TM,$Tf,$Tc){this._one.callee.call($TM,$Tf,$Tc,this._one)},$Tt._renderOneImg=function($Tt,$TM,$Tf,$Tc){this._one.callee.call($TM,$Tf,$Tc,this._one),2305!==$Tt._renderType&&($Tt._renderType|=1)},$Tt.drawLine=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=1);var $TJ=0;$Ts.isWebGL&&($TJ=$TQ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($TJ));var $TZ=$To%2==0?0:.5,$TA=[$Tt+$TZ,$TM+$TZ,$Tf+$TZ,$Tc+$TZ,$TD,$To,$TJ];this._saveToCmd($Ts._context._drawLine,$TA)},$Tt.drawLines=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=1);var $To=0;if($Tf&&!($Tf.length<4)){$Ts.isWebGL&&($To=$TQ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($To));var $TJ=$TD%2==0?0:.5,$TZ=[$Tt+$TJ,$TM+$TJ,$Tf,$Tc,$TD,$To];this._saveToCmd($Ts._context._drawLines,$TZ)}},$Tt.drawCurves=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=1);var $To=[$Tt,$TM,$Tf,$Tc,$TD];this._saveToCmd($Ts._context._drawCurves,$To)},$Tt.drawRect=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){void 0===$TJ&&($TJ=1);var $TZ=$To?$TJ/2:0,$TA=$To?$TJ:0,$TL=[$Tt+$TZ,$TM+$TZ,$Tf-$TA,$Tc-$TA,$TD,$To,$TJ];this._saveToCmd($Ts._context._drawRect,$TL)},$Tt.drawCircle=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=1);var $TJ=$TD?$To/2:0,$TZ=0;$Ts.isWebGL&&($TZ=$TQ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($TZ));var $TA=[$Tt,$TM,$Tf-$TJ,$Tc,$TD,$To,$TZ];this._saveToCmd($Ts._context._drawCircle,$TA)},$Tt.drawPie=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){void 0===$TZ&&($TZ=1);var $TA=$TJ?$TZ/2:0,$TL=$TJ?$TZ:0,$Tp=0;$Ts.isWebGL&&($Tp=$TQ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($Tp));var $TB=[$Tt+$TA,$TM+$TA,$Tf-$TL,$Tc,$TD,$To,$TJ,$TZ,$Tp];$TB[3]=$Ta.toRadian($Tc),$TB[4]=$Ta.toRadian($TD),this._saveToCmd($Ts._context._drawPie,$TB)},$Tt.drawPoly=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=1);var $TJ=0,$TZ=!1;$Ts.isWebGL&&($TJ=$TQ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($TJ),$TZ=!(6<$Tf.length));var $TA=$TD?$To%2==0?0:.5:0,$TL=[$Tt+$TA,$TM+$TA,$Tf,$Tc,$TD,$To,$TJ,$TZ];this._saveToCmd($Ts._context._drawPoly,$TL)},$Tt.drawPath=function($Tt,$TM,$Tf,$Tc,$TD){var $To=[$Tt,$TM,$Tf,$Tc,$TD];this._saveToCmd($Ts._context._drawPath,$To)},$Tq(0,$Tt,"cmds",function(){return this._cmds},function($Tt){this._sp&&(this._sp._renderType|=512),this._cmds=$Tt,this._render=this._renderAll,this._repaint()}),$TB.__init__=function(){if($Ts.isConchNode){for(var $Tt=laya.display.Graphics.prototype,$TM=$TK.window.ConchGraphics.prototype,$Tf=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$Tc=0,$TD=$Tf.length;$Tc<=$TD;$Tc++){var $To=$Tf[$Tc];$Tt[$To]=$TM[$To]}$Tt._saveToCmd=null,$TM.drawImageS&&($Tt.drawTextures=function($Tt,$TM){if($Tt&&$Tt.loaded&&$Tt.bitmap&&$Tt.source){var $Tf=$Tt.uv,$Tc=$Tt.bitmap.width,$TD=$Tt.bitmap.height;this.drawImageS($Tt.bitmap.source,$Tf[0]*$Tc,$Tf[1]*$TD,($Tf[2]-$Tf[0])*$Tc,($Tf[5]-$Tf[3])*$TD,$Tt.offsetX,$Tt.offsetY,$Tt.width,$Tt.height,$TM)}}),$Tt.drawTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$TJ&&($TJ=1),$Tt)if($Tt.loaded){if($Tt.loaded&&$Tt.bitmap&&$Tt.source&&($Tc||($Tc=$Tt.sourceWidth),$TD||($TD=$Tt.sourceHeight),$TJ=$TJ<0?0:1<$TJ?1:$TJ,$Tc=$Tc-$Tt.sourceWidth+$Tt.width,$TD=$TD-$Tt.sourceHeight+$Tt.height,!($Tc<=0||$TD<=0))){$TM+=$Tt.offsetX,$Tf+=$Tt.offsetY;var $TZ=$Tt.uv,$TA=$Tt.bitmap.width,$TL=$Tt.bitmap.height;$TZ[4]<$TZ[0]&&$TZ[5]<$TZ[1]?this.drawImageM($Tt.bitmap.source,$TZ[4]*$TA,$TZ[5]*$TL,($TZ[0]-$TZ[4])*$TA,($TZ[1]-$TZ[5])*$TL,$TM,$Tf,$Tc,$TD,$To,$TJ):this.drawImageM($Tt.bitmap.source,$TZ[0]*$TA,$TZ[1]*$TL,($TZ[2]-$TZ[0])*$TA,($TZ[5]-$TZ[3])*$TL,$TM,$Tf,$Tc,$TD,$To,$TJ),this._repaint()}}else $Tt.once("loaded",this,function(){this.drawTexture($Tt,$TM,$Tf,$Tc,$TD,$To)})},$Tt.fillTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$To&&($To="repeat"),$Tt&&$Tt.loaded){var $TZ,$TA=$Ts._context.ctx,$TL=$Tt.bitmap.width,$Tp=$Tt.bitmap.height,$TB=$Tt.uv;$TZ=$Tt.uv!=$Tpt.DEF_UV?$TA.createPattern($Tt.bitmap.source,$To,$TB[0]*$TL,$TB[1]*$Tp,($TB[2]-$TB[0])*$TL,($TB[5]-$TB[3])*$Tp):$TA.createPattern($Tt.bitmap.source,$To);var $Tb=0,$TI=0;$TJ&&($TM+=$TJ.x%$Tt.width,$Tf+=$TJ.y%$Tt.height,$Tb-=$TJ.x%$Tt.width,$TI-=$TJ.y%$Tt.height),this._fillImage($TZ,$TM,$Tf,$Tb,$TI,$Tc,$TD)}}}},$TB._cache=[],$TB}(),$Tf=function(){function $TN(){this._cacheBoundsType=!1}$Tp($TN,"laya.display.GraphicsBounds");var $Tt=$TN.prototype;return $Tt.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$Tt.reset=function(){this._temp&&(this._temp.length=0)},$Tt.getBounds=function($Tt){return void 0===$Tt&&($Tt=!1),(!this._bounds||!this._temp||this._temp.length<1||$Tt!=this._cacheBoundsType)&&(this._bounds=$TV._getWrapRec(this.getBoundPoints($Tt),this._bounds)),this._cacheBoundsType=$Tt,this._bounds},$Tt.getBoundPoints=function($Tt){return void 0===$Tt&&($Tt=!1),(!this._temp||this._temp.length<1||$Tt!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($Tt)),this._cacheBoundsType=$Tt,this._rstBoundPoints=$Ta.copyArray(this._rstBoundPoints,this._temp)},$Tt._getCmdPoints=function($Tt){void 0===$Tt&&($Tt=!1);var $TM,$Tf,$Tc=$Ts._context,$TD=this._graphics.cmds;if(($TM=this._temp||(this._temp=[])).length=0,$TD||null==this._graphics._one||($TN._tempCmds.length=0,$TN._tempCmds.push(this._graphics._one),$TD=$TN._tempCmds),!$TD)return $TM;($Tf=$TN._tempMatrixArrays).length=0;var $To=$TN._initMatrix;$To.identity();for(var $TJ,$TZ,$TA=$TN._tempMatrix,$TL=NaN,$Tp=NaN,$TB=NaN,$Tb=NaN,$TI=NaN,$Tq=NaN,$Tl=0,$T_=$TD.length;$Tl<$T_;$Tl++)if(($TJ=$TD[$Tl]).callee)switch($TJ.callee){case $Tc._save:case 7:$Tf.push($To),$To=$To.clone();break;case $Tc._restore:case 8:$To=$Tf.pop();break;case $Tc._scale:case 5:$TA.identity(),$TA.translate(-$TJ[2],-$TJ[3]),$TA.scale($TJ[0],$TJ[1]),$TA.translate($TJ[2],$TJ[3]),this._switchMatrix($To,$TA);break;case $Tc._rotate:case 3:$TA.identity(),$TA.translate(-$TJ[1],-$TJ[2]),$TA.rotate($TJ[0]),$TA.translate($TJ[1],$TJ[2]),this._switchMatrix($To,$TA);break;case $Tc._translate:case 6:$TA.identity(),$TA.translate($TJ[0],$TJ[1]),this._switchMatrix($To,$TA);break;case $Tc._transform:case 4:$TA.identity(),$TA.translate(-$TJ[1],-$TJ[2]),$TA.concat($TJ[0]),$TA.translate($TJ[1],$TJ[2]),this._switchMatrix($To,$TA);break;case 16:case 24:$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[0],$TJ[1],$TJ[2],$TJ[3]),$To);break;case 17:$To.copyTo($TA),$TA.concat($TJ[4]),$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[0],$TJ[1],$TJ[2],$TJ[3]),$TA);break;case $Tc._drawTexture:$TZ=$TJ[0],$Tt?$TJ[3]&&$TJ[4]?$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TJ[3],$TJ[4]),$To):($TZ=$TJ[0],$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TZ.width,$TZ.height),$To)):($TL=($TJ[3]||$TZ.sourceWidth)/$TZ.width,$Tp=($TJ[4]||$TZ.sourceHeight)/$TZ.height,$TB=$TL*$TZ.sourceWidth,$Tb=$Tp*$TZ.sourceHeight,$TI=0<$TZ.offsetX?$TZ.offsetX:0,$Tq=0<$TZ.offsetY?$TZ.offsetY:0,$TI*=$TL,$Tq*=$Tp,$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1]-$TI,$TJ[2]-$Tq,$TB,$Tb),$To));break;case $Tc._fillTexture:$TJ[3]&&$TJ[4]?$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TJ[3],$TJ[4]),$To):($TZ=$TJ[0],$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TZ.width,$TZ.height),$To));break;case $Tc._drawTextureWithTransform:var $TE;$TE=$TJ[5]?($To.copyTo($TA),$TA.concat($TJ[5]),$TA):$To,$Tt?$TJ[3]&&$TJ[4]?$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TJ[3],$TJ[4]),$TE):($TZ=$TJ[0],$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1],$TJ[2],$TZ.width,$TZ.height),$TE)):($TZ=$TJ[0],$TL=($TJ[3]||$TZ.sourceWidth)/$TZ.width,$Tp=($TJ[4]||$TZ.sourceHeight)/$TZ.height,$TB=$TL*$TZ.sourceWidth,$Tb=$Tp*$TZ.sourceHeight,$TI=0<$TZ.offsetX?$TZ.offsetX:0,$Tq=0<$TZ.offsetY?$TZ.offsetY:0,$TI*=$TL,$Tq*=$Tp,$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[1]-$TI,$TJ[2]-$Tq,$TB,$Tb),$TE));break;case $Tc._drawRect:case 13:$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[0],$TJ[1],$TJ[2],$TJ[3]),$To);break;case $Tc._drawCircle:case $Tc._fillCircle:case 14:$TN._addPointArrToRst($TM,$TV._getBoundPointS($TJ[0]-$TJ[2],$TJ[1]-$TJ[2],$TJ[2]+$TJ[2],$TJ[2]+$TJ[2]),$To);break;case $Tc._drawLine:case 20:$TN._tempPoints.length=0;var $Te;$Te=.5*$TJ[5],$TJ[0]==$TJ[2]?$TN._tempPoints.push($TJ[0]+$Te,$TJ[1],$TJ[2]+$Te,$TJ[3],$TJ[0]-$Te,$TJ[1],$TJ[2]-$Te,$TJ[3]):$TJ[1]==$TJ[3]?$TN._tempPoints.push($TJ[0],$TJ[1]+$Te,$TJ[2],$TJ[3]+$Te,$TJ[0],$TJ[1]-$Te,$TJ[2],$TJ[3]-$Te):$TN._tempPoints.push($TJ[0],$TJ[1],$TJ[2],$TJ[3]),$TN._addPointArrToRst($TM,$TN._tempPoints,$To);break;case $Tc._drawCurves:case 22:$TN._addPointArrToRst($TM,$TX.I.getBezierPoints($TJ[2]),$To,$TJ[0],$TJ[1]);break;case $Tc._drawPoly:case $Tc._drawLines:case 18:$TN._addPointArrToRst($TM,$TJ[2],$To,$TJ[0],$TJ[1]);break;case $Tc._drawPath:case 19:$TN._addPointArrToRst($TM,this._getPathPoints($TJ[2]),$To,$TJ[0],$TJ[1]);break;case $Tc._drawPie:case 15:$TN._addPointArrToRst($TM,this._getPiePoints($TJ[0],$TJ[1],$TJ[2],$TJ[3],$TJ[4]),$To)}return 200<$TM.length?$TM=$Ta.copyArray($TM,$TV._getWrapRec($TM)._getBoundPoints()):8<$TM.length&&($TM=$Ty.scanPList($TM)),$TM},$Tt._switchMatrix=function($Tt,$TM){$TM.concat($Tt),$TM.copyTo($Tt)},$Tt._getPiePoints=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TN._tempPoints;$TN._tempPoints.length=0,$To.push($Tt,$TM);var $TJ=($TD-$Tc)%(2*Math.PI)/10,$TZ=NaN,$TA=$Tc;for($TZ=0;$TZ<=10;$TZ++)$To.push($Tt+$Tf*Math.cos($TA),$TM+$Tf*Math.sin($TA)),$TA+=$TJ;return $To},$Tt._getPathPoints=function($Tt){var $TM,$Tf,$Tc=0,$TD=$TN._tempPoints;for($TD.length=0,$TM=$Tt.length,$Tc=0;$Tc<$TM;$Tc++)1<($Tf=$Tt[$Tc]).length&&($TD.push($Tf[1],$Tf[2]),3<$Tf.length&&$TD.push($Tf[3],$Tf[4]));return $TD},$TN._addPointArrToRst=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0);var $To,$TJ=0;for($To=$TM.length,$TJ=0;$TJ<$To;$TJ+=2)$TN._addPointToRst($Tt,$TM[$TJ]+$Tc,$TM[$TJ+1]+$TD,$Tf)},$TN._addPointToRst=function($Tt,$TM,$Tf,$Tc){var $TD=$Ti.TEMP;$TD.setTo($TM||0,$Tf||0),$Tc.transformPoint($TD),$Tt.push($TD.x,$TD.y)},$TN._tempPoints=[],$TN._tempMatrixArrays=[],$TN._tempCmds=[],$TA($TN,["_tempMatrix",function(){return this._tempMatrix=new $TF},"_initMatrix",function(){return this._initMatrix=new $TF}]),$TN}(),$To=function(){function $Tt(){}$Tp($Tt,"laya.events.Event");var $TM=$Tt.prototype;return $TM.setTo=function($Tt,$TM,$Tf){return this.type=$Tt,this.currentTarget=$TM,this.target=$Tf,this},$TM.stopPropagation=function(){this._stoped=!0},$Tq(0,$TM,"stageY",function(){return $TT.stage.mouseY}),$Tq(0,$TM,"charCode",function(){return this.nativeEvent.charCode}),$Tq(0,$TM,"touches",function(){var $Tt=this.nativeEvent.touches;if($Tt)for(var $TM=$TT.stage,$Tf=0,$Tc=$Tt.length;$Tf<$Tc;$Tf++){var $TD=$Tt[$Tf],$To=$Ti.TEMP;$To.setTo($TD.clientX,$TD.clientY),$TM._canvasTransform.invertTransformPoint($To),$TM.transform.invertTransformPoint($To),$TD.stageX=$To.x,$TD.stageY=$To.y}return $Tt}),$Tq(0,$TM,"keyLocation",function(){return this.nativeEvent.keyLocation}),$Tq(0,$TM,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$Tq(0,$TM,"altKey",function(){return this.nativeEvent.altKey}),$Tq(0,$TM,"shiftKey",function(){return this.nativeEvent.shiftKey}),$Tq(0,$TM,"stageX",function(){return $TT.stage.mouseX}),$Tt.EMPTY=new $Tt,$Tt.MOUSE_DOWN="mousedown",$Tt.MOUSE_UP="mouseup",$Tt.CLICK="click",$Tt.RIGHT_MOUSE_DOWN="rightmousedown",$Tt.RIGHT_MOUSE_UP="rightmouseup",$Tt.RIGHT_CLICK="rightclick",$Tt.MOUSE_MOVE="mousemove",$Tt.MOUSE_OVER="mouseover",$Tt.MOUSE_OUT="mouseout",$Tt.MOUSE_WHEEL="mousewheel",$Tt.ROLL_OVER="mouseover",$Tt.ROLL_OUT="mouseout",$Tt.DOUBLE_CLICK="doubleclick",$Tt.CHANGE="change",$Tt.CHANGED="changed",$Tt.RESIZE="resize",$Tt.ADDED="added",$Tt.REMOVED="removed",$Tt.DISPLAY="display",$Tt.UNDISPLAY="undisplay",$Tt.ERROR="error",$Tt.COMPLETE="complete",$Tt.LOADED="loaded",$Tt.INITED="inited",$Tt.PROGRESS="progress",$Tt.INPUT="input",$Tt.RENDER="render",$Tt.OPEN="open",$Tt.MESSAGE="message",$Tt.CLOSE="close",$Tt.KEY_DOWN="keydown",$Tt.KEY_PRESS="keypress",$Tt.KEY_UP="keyup",$Tt.FRAME="enterframe",$Tt.DRAG_START="dragstart",$Tt.DRAG_MOVE="dragmove",$Tt.DRAG_END="dragend",$Tt.ENTER="enter",$Tt.SELECT="select",$Tt.BLUR="blur",$Tt.FOCUS="focus",$Tt.VISIBILITY_CHANGE="visibilitychange",$Tt.FOCUS_CHANGE="focuschange",$Tt.PLAYED="played",$Tt.PAUSED="paused",$Tt.STOPPED="stopped",$Tt.START="start",$Tt.END="end",$Tt.ENABLE_CHANGED="enablechanged",$Tt.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$Tt.COMPONENT_ADDED="componentadded",$Tt.COMPONENT_REMOVED="componentremoved",$Tt.LAYER_CHANGED="layerchanged",$Tt.HIERARCHY_LOADED="hierarchyloaded",$Tt.RECOVERED="recovered",$Tt.RELEASED="released",$Tt.LINK="link",$Tt.LABEL="label",$Tt.FULL_SCREEN_CHANGE="fullscreenchange",$Tt.DEVICE_LOST="devicelost",$Tt.MESH_CHANGED="meshchanged",$Tt.MATERIAL_CHANGED="materialchanged",$Tt.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$Tt.ANIMATION_CHANGED="animationchanged",$Tt.TRIGGER_ENTER="triggerenter",$Tt.TRIGGER_STAY="triggerstay",$Tt.TRIGGER_EXIT="triggerexit",$Tt.TRAIL_FILTER_CHANGE="trailfilterchange",$Tt.DOMINO_FILTER_CHANGE="dominofilterchange",$Tt}(),$TB=(function(){function $Tt(){}$Tp($Tt,"laya.events.Keyboard"),$Tt.NUMBER_0=48,$Tt.NUMBER_1=49,$Tt.NUMBER_2=50,$Tt.NUMBER_3=51,$Tt.NUMBER_4=52,$Tt.NUMBER_5=53,$Tt.NUMBER_6=54,$Tt.NUMBER_7=55,$Tt.NUMBER_8=56,$Tt.NUMBER_9=57,$Tt.A=65,$Tt.B=66,$Tt.C=67,$Tt.D=68,$Tt.E=69,$Tt.F=70,$Tt.G=71,$Tt.H=72,$Tt.I=73,$Tt.J=74,$Tt.K=75,$Tt.L=76,$Tt.M=77,$Tt.N=78,$Tt.O=79,$Tt.P=80,$Tt.Q=81,$Tt.R=82,$Tt.S=83,$Tt.T=84,$Tt.U=85,$Tt.V=86,$Tt.W=87,$Tt.X=88,$Tt.Y=89,$Tt.Z=90,$Tt.F1=112,$Tt.F2=113,$Tt.F3=114,$Tt.F4=115,$Tt.F5=116,$Tt.F6=117,$Tt.F7=118,$Tt.F8=119,$Tt.F9=120,$Tt.F10=121,$Tt.F11=122,$Tt.F12=123,$Tt.F13=124,$Tt.F14=125,$Tt.F15=126,$Tt.NUMPAD=21,$Tt.NUMPAD_0=96,$Tt.NUMPAD_1=97,$Tt.NUMPAD_2=98,$Tt.NUMPAD_3=99,$Tt.NUMPAD_4=100,$Tt.NUMPAD_5=101,$Tt.NUMPAD_6=102,$Tt.NUMPAD_7=103,$Tt.NUMPAD_8=104,$Tt.NUMPAD_9=105,$Tt.NUMPAD_ADD=107,$Tt.NUMPAD_DECIMAL=110,$Tt.NUMPAD_DIVIDE=111,$Tt.NUMPAD_ENTER=108,$Tt.NUMPAD_MULTIPLY=106,$Tt.NUMPAD_SUBTRACT=109,$Tt.SEMICOLON=186,$Tt.EQUAL=187,$Tt.COMMA=188,$Tt.MINUS=189,$Tt.PERIOD=190,$Tt.SLASH=191,$Tt.BACKQUOTE=192,$Tt.LEFTBRACKET=219,$Tt.BACKSLASH=220,$Tt.RIGHTBRACKET=221,$Tt.QUOTE=222,$Tt.ALTERNATE=18,$Tt.BACKSPACE=8,$Tt.CAPS_LOCK=20,$Tt.COMMAND=15,$Tt.CONTROL=17,$Tt.DELETE=46,$Tt.ENTER=13,$Tt.ESCAPE=27,$Tt.PAGE_UP=33,$Tt.PAGE_DOWN=34,$Tt.END=35,$Tt.HOME=36,$Tt.LEFT=37,$Tt.UP=38,$Tt.RIGHT=39,$Tt.DOWN=40,$Tt.SHIFT=16,$Tt.SPACE=32,$Tt.TAB=9,$Tt.INSERT=45}(),function(){function $TD(){}return $Tp($TD,"laya.events.KeyBoardManager"),$TD.__init__=function(){$TD._addEvent("keydown"),$TD._addEvent("keypress"),$TD._addEvent("keyup")},$TD._addEvent=function($TM){$TK.document.addEventListener($TM,function($Tt){laya.events.KeyBoardManager._dispatch($Tt,$TM)},!0)},$TD._dispatch=function($Tt,$TM){if($TD.enabled){$TD._event._stoped=!1,$TD._event.nativeEvent=$Tt,$TD._event.keyCode=$Tt.keyCode||$Tt.which||$Tt.charCode,"keydown"===$TM?$TD._pressKeys[$TD._event.keyCode]=!0:"keyup"===$TM&&($TD._pressKeys[$TD._event.keyCode]=null);for(var $Tf=$TT.stage.focus&&null!=$TT.stage.focus.event&&$TT.stage.focus.displayedInStage?$TT.stage.focus:$TT.stage,$Tc=$Tf;$Tc;)$Tc.event($TM,$TD._event.setTo($TM,$Tc,$Tf)),$Tc=$Tc.parent}},$TD.hasKeyDown=function($Tt){return $TD._pressKeys[$Tt]},$TD._pressKeys={},$TD.enabled=!0,$TA($TD,["_event",function(){return this._event=new $To}]),$TD}()),$Tl=(function(){function $Tt(){}$Tp($Tt,"laya.events.KeyLocation"),$Tt.STANDARD=0,$Tt.LEFT=1,$Tt.RIGHT=2,$Tt.NUM_PAD=3}(),function(){function $TL(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$TK.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $To,this._matrix=new $TF,this._point=new $Ti,this._rect=new $TV,this._prePoint=new $Ti,this._curTouchID=NaN}$Tp($TL,"laya.events.MouseManager");var $Tt=$TL.prototype;return $Tt.__init__=function($Tt,$TM){var $Tf=this;this._stage=$Tt;var $Tc=this,$TD=this._eventList;$TM.oncontextmenu=function($Tt){if($TL.enabled)return!1},$TM.addEventListener("mousedown",function($Tt){$TL.enabled&&($TK.onIE||$Tt.preventDefault(),$TD.push($Tt),$Tc.mouseDownTime=$TK.now())}),$TM.addEventListener("mouseup",function($Tt){$TL.enabled&&($Tt.preventDefault(),$TD.push($Tt),$Tc.mouseDownTime=-$TK.now())},!0),$TM.addEventListener("mousemove",function($Tt){if($TL.enabled){$Tt.preventDefault();var $TM=$TK.now();if($TM-$Tc._lastMoveTimer<10)return;$Tc._lastMoveTimer=$TM,$TD.push($Tt)}},!0),$TM.addEventListener("mouseout",function($Tt){$TL.enabled&&$TD.push($Tt)}),$TM.addEventListener("mouseover",function($Tt){$TL.enabled&&$TD.push($Tt)}),$TM.addEventListener("touchstart",function($Tt){$TL.enabled&&($TD.push($Tt),$TL._isFirstTouch||$Tyt.isInputting||$Tt.preventDefault(),$Tc.mouseDownTime=$TK.now())}),$TM.addEventListener("touchend",function($Tt){$TL.enabled?($TL._isFirstTouch||$Tyt.isInputting||$Tt.preventDefault(),$TL._isFirstTouch=!1,$TD.push($Tt),$Tc.mouseDownTime=-$TK.now()):$Tf._curTouchID=NaN},!0),$TM.addEventListener("touchmove",function($Tt){$TL.enabled&&($Tt.preventDefault(),$TD.push($Tt))},!0),$TM.addEventListener("touchcancel",function($Tt){$TL.enabled?($Tt.preventDefault(),$TD.push($Tt)):$Tf._curTouchID=NaN},!0),$TM.addEventListener("mousewheel",function($Tt){$TL.enabled&&$TD.push($Tt)}),$TM.addEventListener("DOMMouseScroll",function($Tt){$TL.enabled&&$TD.push($Tt)})},$Tt.initEvent=function($Tt,$TM){var $Tf;this._event._stoped=!1,this._event.nativeEvent=$TM||$Tt,this._target=null,this._point.setTo($Tt.pageX||$Tt.clientX,$Tt.pageY||$Tt.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$Tt.identifier||0,this._tTouchID=this._event.touchId,($Tf=$T_.I._event)._stoped=!1,$Tf.nativeEvent=this._event.nativeEvent,$Tf.touchId=this._event.touchId},$Tt.checkMouseWheel=function($Tt){this._event.delta=$Tt.wheelDelta?.025*$Tt.wheelDelta:-$Tt.detail;for(var $TM=$T_.I.getLastOvers(),$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){var $TD=$TM[$Tf];$TD.event("mousewheel",this._event.setTo("mousewheel",$TD,this._target))}},$Tt.onMouseMove=function($Tt){$T_.I.onMouseMove($Tt,this._tTouchID)},$Tt.onMouseDown=function($Tt){if($Tyt.isInputting&&$TT.stage.focus&&$TT.stage.focus.focus&&!$TT.stage.focus.contains(this._target)){var $TM=$TT.stage.focus._tf||$TT.stage.focus,$Tf=$Tt._tf||$Tt;$Tf instanceof laya.display.Input&&$Tf.multiline==$TM.multiline?$TM._focusOut():$TM.focus=!1}$T_.I.onMouseDown($Tt,this._tTouchID,this._isLeftMouse)},$Tt.onMouseUp=function($Tt){$T_.I.onMouseUp($Tt,this._tTouchID,this._isLeftMouse)},$Tt.check=function($Tt,$TM,$Tf,$Tc){this._point.setTo($TM,$Tf),$Tt.fromParentPoint(this._point),$TM=this._point.x,$Tf=this._point.y;var $TD=$Tt.scrollRect;if($TD&&(this._rect.setTo($TD.x,$TD.y,$TD.width,$TD.height),!this._rect.contains($TM,$Tf)))return!1;if(!this.disableMouseEvent){if($Tt.hitTestPrior&&!$Tt.mouseThrough&&!this.hitTest($Tt,$TM,$Tf))return!1;for(var $To=$Tt._childs.length-1;-1<$To;$To--){var $TJ=$Tt._childs[$To];if(!$TJ.destroyed&&$TJ.mouseEnabled&&$TJ.visible&&this.check($TJ,$TM,$Tf,$Tc))return!0}}var $TZ=!(!$Tt.hitTestPrior||$Tt.mouseThrough||this.disableMouseEvent)||this.hitTest($Tt,$TM,$Tf);return $TZ?(this._target=$Tt,$Tc.call(this,$Tt)):$Tc===this.onMouseUp&&$Tt===this._stage&&(this._target=this._stage,$Tc.call(this,this._target)),$TZ},$Tt.hitTest=function($Tt,$TM,$Tf){var $Tc=!1;if($Tt.scrollRect&&($TM-=$Tt.scrollRect.x,$Tf-=$Tt.scrollRect.y),$Tt.hitArea instanceof laya.utils.HitArea)return $Tt.hitArea.isHit($TM,$Tf);if(0<$Tt.width&&0<$Tt.height||$Tt.mouseThrough||$Tt.hitArea)if($Tt.mouseThrough)$Tc=$Tt.getGraphicBounds().contains($TM,$Tf);else{var $TD=this._rect;$Tt.hitArea?$TD=$Tt.hitArea:$TD.setTo(0,0,$Tt.width,$Tt.height),$Tc=$TD.contains($TM,$Tf)}return $Tc},$Tt.runEvent=function(){var $Tt=this._eventList.length;if($Tt){this.mouseEventTime=$TK.now();var $TM,$Tf=0,$Tc=0,$TD=0;try{for(;$Tf<$Tt;){var $To=this._eventList[$Tf];switch("mousemove"!==$To.type&&(this._prePoint.x=this._prePoint.y=-1e6),$To.type){case"mousedown":this._touchIDs[0]=this._id++,$TL._isTouchRespond?$TL._isTouchRespond=!1:(this._isLeftMouse=0===$To.button,this.initEvent($To),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===$To.button,this.initEvent($To),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$To.clientX)+Math.abs(this._prePoint.y-$To.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$To.clientX,this._prePoint.y=$To.clientY,this.initEvent($To),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":$TL._isTouchRespond=!0,this._isLeftMouse=!0;var $TJ=$To.changedTouches;for($Tc=0,$TD=$TJ.length;$Tc<$TD;$Tc++)$TM=$TJ[$Tc],($TL.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$TM.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$TM.identifier]=this._id++,this.initEvent($TM,$To),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":$TL._isTouchRespond=!0,this._isLeftMouse=!0;var $TZ=$To.changedTouches;for($Tc=0,$TD=$TZ.length;$Tc<$TD;$Tc++)if($TM=$TZ[$Tc],$TL.multiTouchEnabled||$TM.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent($TM,$To);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var $TA=$To.changedTouches;for($Tc=0,$TD=$TA.length;$Tc<$TD;$Tc++)$TM=$TA[$Tc],($TL.multiTouchEnabled||$TM.identifier==this._curTouchID)&&(this.initEvent($TM,$To),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel($To);break;case"mouseout":$T_.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}$Tf++}}catch($Tt){throw this._eventList.length=0,$Tt}this._eventList.length=0}},$TL.enabled=!0,$TL.multiTouchEnabled=!0,$TL._isTouchRespond=!1,$TL._isFirstTouch=!0,$TA($TL,["instance",function(){return this.instance=new $TL}]),$TL}()),$T_=function(){function $Tq(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $To}$Tp($Tq,"laya.events.TouchManager");var $Tt=$Tq.prototype;return $Tt._clearTempArrs=function(){$Tq._oldArr.length=0,$Tq._newArr.length=0,$Tq._tEleArr.length=0},$Tt.getTouchFromArr=function($Tt,$TM){var $Tf,$Tc,$TD=0;for($Tf=$TM.length,$TD=0;$TD<$Tf;$TD++)if(($Tc=$TM[$TD]).id==$Tt)return $Tc;return null},$Tt.removeTouchFromArr=function($Tt,$TM){var $Tf=0;for($Tf=$TM.length-1;0<=$Tf;$Tf--)$TM[$Tf].id==$Tt&&$TM.splice($Tf,1)},$Tt.createTouchO=function($Tt,$TM){var $Tf;return($Tf=$Tg.getItem("TouchData")||{}).id=$TM,$Tf.tar=$Tt,$Tf},$Tt.onMouseDown=function($Tt,$TM,$Tf){var $Tc,$TD,$To,$TJ;(void 0===$Tf&&($Tf=!1),this.enable)&&($Tc=this.getTouchFromArr($TM,this.preOvers),$To=this.getEles($Tt,null,$Tq._tEleArr),$Tc?$Tc.tar=$Tt:($TD=this.createTouchO($Tt,$TM),this.preOvers.push($TD)),$TK.onMobile&&this.sendEvents($To,"mouseover",$TM),$TJ=$Tf?this.preDowns:this.preRightDowns,($Tc=this.getTouchFromArr($TM,$TJ))?$Tc.tar=$Tt:($TD=this.createTouchO($Tt,$TM),$TJ.push($TD)),this.sendEvents($To,$Tf?"mousedown":"rightmousedown",$TM),this._clearTempArrs())},$Tt.sendEvents=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=0);var $Tc,$TD,$To,$TJ=0;for($Tc=$Tt.length,this._event._stoped=!1,$TD=$Tt[0],$TJ=0;$TJ<$Tc;$TJ++){if(($To=$Tt[$TJ]).destroyed)return;if($To.event($TM,this._event.setTo($TM,$To,$TD)),this._event._stoped)break}},$Tt.getEles=function($Tt,$TM,$Tf){for($Tf?$Tf.length=0:$Tf=[];$Tt&&$Tt!=$TM;)$Tf.push($Tt),$Tt=$Tt.parent;return $Tf},$Tt.checkMouseOutAndOverOfMove=function($Tt,$TM,$Tf){if(void 0===$Tf&&($Tf=0),$TM!=$Tt){var $Tc,$TD,$To=0,$TJ=0;if($TM.contains($Tt))$TD=this.getEles($Tt,$TM,$Tq._tEleArr),this.sendEvents($TD,"mouseover",$Tf);else if($Tt.contains($TM))$TD=this.getEles($TM,$Tt,$Tq._tEleArr),this.sendEvents($TD,"mouseout",$Tf);else{var $TZ,$TA;($TD=$Tq._tEleArr).length=0,$TZ=this.getEles($TM,null,$Tq._oldArr),$TA=this.getEles($Tt,null,$Tq._newArr),$TJ=$TZ.length;var $TL=0;for($To=0;$To<$TJ;$To++){if($Tc=$TZ[$To],0<=($TL=$TA.indexOf($Tc))){$TA.splice($TL,$TA.length-$TL);break}$TD.push($Tc)}0<$TD.length&&this.sendEvents($TD,"mouseout",$Tf),0<$TA.length&&this.sendEvents($TA,"mouseover",$Tf)}}},$Tt.onMouseMove=function($Tt,$TM){var $Tf,$Tc;this.enable&&(($Tf=this.getTouchFromArr($TM,this.preOvers))?(this.checkMouseOutAndOverOfMove($Tt,$Tf.tar),$Tf.tar=$Tt,$Tc=this.getEles($Tt,null,$Tq._tEleArr)):($Tc=this.getEles($Tt,null,$Tq._tEleArr),this.sendEvents($Tc,"mouseover",$TM),this.preOvers.push(this.createTouchO($Tt,$TM))),this.sendEvents($Tc,"mousemove",$TM),this._clearTempArrs())},$Tt.getLastOvers=function(){return($Tq._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$Tq._tEleArr):($Tq._tEleArr.push($TT.stage),$Tq._tEleArr)},$Tt.stageMouseOut=function(){var $Tt;$Tt=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($Tt,"mouseout",0)},$Tt.onMouseUp=function($Tt,$TM,$Tf){if(void 0===$Tf&&($Tf=!1),this.enable){var $Tc,$TD,$To,$TJ,$TZ,$TA,$TL=0,$Tp=0,$TB=$TK.onMobile;if($TD=this.getEles($Tt,null,$Tq._tEleArr),this.sendEvents($TD,$Tf?"mouseup":"rightmouseup",$TM),$TA=$Tf?this.preDowns:this.preRightDowns,$Tc=this.getTouchFromArr($TM,$TA)){var $Tb,$TI=$TK.now();if($Tb=$TI-this._lastClickTime<300,this._lastClickTime=$TI,$Tt==$Tc.tar)$TZ=$TD;else for($To=this.getEles($Tc.tar,null,$Tq._oldArr),($TZ=$Tq._newArr).length=0,$Tp=$To.length,$TL=0;$TL<$Tp;$TL++)$TJ=$To[$TL],0<=$TD.indexOf($TJ)&&$TZ.push($TJ);0<$TZ.length&&this.sendEvents($TZ,$Tf?"click":"rightclick",$TM),$Tf&&$Tb&&this.sendEvents($TZ,"doubleclick",$TM),this.removeTouchFromArr($TM,$TA),$Tc.tar=null,$Tg.recover("TouchData",$Tc)}else;($Tc=this.getTouchFromArr($TM,this.preOvers))&&$TB&&(($TZ=this.getEles($Tc.tar,null,$TZ))&&0<$TZ.length&&this.sendEvents($TZ,"mouseout",$TM),this.removeTouchFromArr($TM,this.preOvers),$Tc.tar=null,$Tg.recover("TouchData",$Tc)),this._clearTempArrs()}},$Tq._oldArr=[],$Tq._newArr=[],$Tq._tEleArr=[],$TA($Tq,["I",function(){return this.I=new $Tq}]),$Tq}(),$TE=function(){function $Tt(){this._action=null}$Tp($Tt,"laya.filters.Filter");var $TM=$Tt.prototype;return $TT.imps($TM,{"laya.filters.IFilter":!0}),$TM.callNative=function($Tt){},$Tq(0,$TM,"type",function(){return-1}),$Tq(0,$TM,"action",function(){return this._action}),$Tt.BLUR=16,$Tt.COLOR=32,$Tt.GLOW=8,$Tt._filterStart=null,$Tt._filterEnd=null,$Tt._EndTarget=null,$Tt._recycleScope=null,$Tt._filter=null,$Tt._useSrc=null,$Tt._endSrc=null,$Tt._useOut=null,$Tt._endOut=null,$Tt}(),$TN=function(){function $Tt(){this.data=null}$Tp($Tt,"laya.filters.ColorFilterAction");var $TM=$Tt.prototype;return $TT.imps($TM,{"laya.filters.IFilterAction":!0}),$TM.apply=function($Tt){var $TM=$Tt.ctx.ctx,$Tf=$Tt.ctx.ctx.canvas;if(0==$Tf.width||0==$Tf.height)return $Tf;for(var $Tc,$TD=$TM.getImageData(0,0,$Tf.width,$Tf.height),$To=$TD.data,$TJ=0,$TZ=$To.length;$TJ<$TZ;$TJ+=4)$Tc=this.getColor($To[$TJ],$To[$TJ+1],$To[$TJ+2],$To[$TJ+3]),0!=$To[$TJ+3]&&($To[$TJ]=$Tc[0],$To[$TJ+1]=$Tc[1],$To[$TJ+2]=$Tc[2],$To[$TJ+3]=$Tc[3]);return $TM.putImageData($TD,0,0),$Tt},$TM.getColor=function($Tt,$TM,$Tf,$Tc){var $TD=[];if(this.data._mat&&this.data._alpha){var $To=this.data._mat,$TJ=this.data._alpha;$TD[0]=$To[0]*$Tt+$To[1]*$TM+$To[2]*$Tf+$To[3]*$Tc+$TJ[0],$TD[1]=$To[4]*$Tt+$To[5]*$TM+$To[6]*$Tf+$To[7]*$Tc+$TJ[1],$TD[2]=$To[8]*$Tt+$To[9]*$TM+$To[10]*$Tf+$To[11]*$Tc+$TJ[2],$TD[3]=$To[12]*$Tt+$To[13]*$TM+$To[14]*$Tf+$To[15]*$Tc+$TJ[3]}return $TD},$Tt}(),$TX=(function(){function $Tt(){}$Tp($Tt,"laya.maths.Arith"),$Tt.formatR=function($Tt){return $Tt>Math.PI&&($Tt-=2*Math.PI),$Tt<-Math.PI&&($Tt+=2*Math.PI),$Tt},$Tt.isPOT=function($Tt,$TM){return 0<$Tt&&0==($Tt&$Tt-1)&&0<$TM&&0==($TM&$TM-1)},$Tt.setMatToArray=function($Tt,$TM){$Tt.a,$Tt.b,$Tt.c,$Tt.d,$Tt.tx,$Tt.ty,$TM[0]=$Tt.a,$TM[1]=$Tt.b,$TM[4]=$Tt.c,$TM[5]=$Tt.d,$TM[12]=$Tt.tx,$TM[13]=$Tt.ty}}(),function(){function $Tt(){this._controlPoints=[new $Ti,new $Ti,new $Ti],this._calFun=this.getPoint2}$Tp($Tt,"laya.maths.Bezier");var $TM=$Tt.prototype;return $TM._switchPoint=function($Tt,$TM){var $Tf=this._controlPoints.shift();$Tf.setTo($Tt,$TM),this._controlPoints.push($Tf)},$TM.getPoint2=function($Tt,$TM){var $Tf=this._controlPoints[0],$Tc=this._controlPoints[1],$TD=this._controlPoints[2],$To=Math.pow(1-$Tt,2)*$Tf.x+2*$Tt*(1-$Tt)*$Tc.x+Math.pow($Tt,2)*$TD.x,$TJ=Math.pow(1-$Tt,2)*$Tf.y+2*$Tt*(1-$Tt)*$Tc.y+Math.pow($Tt,2)*$TD.y;$TM.push($To,$TJ)},$TM.getPoint3=function($Tt,$TM){var $Tf=this._controlPoints[0],$Tc=this._controlPoints[1],$TD=this._controlPoints[2],$To=this._controlPoints[3],$TJ=Math.pow(1-$Tt,3)*$Tf.x+3*$Tc.x*$Tt*(1-$Tt)*(1-$Tt)+3*$TD.x*$Tt*$Tt*(1-$Tt)+$To.x*Math.pow($Tt,3),$TZ=Math.pow(1-$Tt,3)*$Tf.y+3*$Tc.y*$Tt*(1-$Tt)*(1-$Tt)+3*$TD.y*$Tt*$Tt*(1-$Tt)+$To.y*Math.pow($Tt,3);$TM.push($TJ,$TZ)},$TM.insertPoints=function($Tt,$TM){var $Tf,$Tc=NaN;for($Tf=1/($Tt=0<$Tt?$Tt:5),$Tc=0;$Tc<=1;$Tc+=$Tf)this._calFun($Tc,$TM)},$TM.getBezierPoints=function($Tt,$TM,$Tf){void 0===$TM&&($TM=5),void 0===$Tf&&($Tf=2);var $Tc,$TD,$To=0;if(($Tc=$Tt.length)<2*($Tf+1))return[];switch($TD=[],$Tf){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$Tf;)this._controlPoints.push(new $Ti);for($To=0;$To<2*$Tf;$To+=2)this._switchPoint($Tt[$To],$Tt[$To+1]);for($To=2*$Tf;$To<$Tc;$To+=2)this._switchPoint($Tt[$To],$Tt[$To+1]),$To/2%$Tf==0&&this.insertPoints($TM,$TD);return $TD},$TA($Tt,["I",function(){return this.I=new $Tt}]),$Tt}()),$Ty=function(){function $TL(){}return $Tp($TL,"laya.maths.GrahamScan"),$TL.multiply=function($Tt,$TM,$Tf){return($Tt.x-$Tf.x)*($TM.y-$Tf.y)-($TM.x-$Tf.x)*($Tt.y-$Tf.y)},$TL.dis=function($Tt,$TM){return($Tt.x-$TM.x)*($Tt.x-$TM.x)+($Tt.y-$TM.y)*($Tt.y-$TM.y)},$TL._getPoints=function($Tt,$TM,$Tf){for(void 0===$TM&&($TM=!1),$TL._mPointList||($TL._mPointList=[]);$TL._mPointList.length<$Tt;)$TL._mPointList.push(new $Ti);return $Tf||($Tf=[]),$Tf.length=0,$TM?$TL.getFrom($Tf,$TL._mPointList,$Tt):$TL.getFromR($Tf,$TL._mPointList,$Tt),$Tf},$TL.getFrom=function($Tt,$TM,$Tf){var $Tc=0;for($Tc=0;$Tc<$Tf;$Tc++)$Tt.push($TM[$Tc]);return $Tt},$TL.getFromR=function($Tt,$TM,$Tf){var $Tc=0;for($Tc=0;$Tc<$Tf;$Tc++)$Tt.push($TM.pop());return $Tt},$TL.pListToPointList=function($Tt,$TM){void 0===$TM&&($TM=!1);var $Tf=0,$Tc=$Tt.length/2,$TD=$TL._getPoints($Tc,$TM,$TL._tempPointList);for($Tf=0;$Tf<$Tc;$Tf++)$TD[$Tf].setTo($Tt[$Tf+$Tf],$Tt[$Tf+$Tf+1]);return $TD},$TL.pointListToPlist=function($Tt){var $TM,$Tf=0,$Tc=$Tt.length,$TD=$TL._temPList;for($Tf=$TD.length=0;$Tf<$Tc;$Tf++)$TM=$Tt[$Tf],$TD.push($TM.x,$TM.y);return $TD},$TL.scanPList=function($Tt){return $Ta.copyArray($Tt,$TL.pointListToPlist($TL.scan($TL.pListToPointList($Tt,!0))))},$TL.scan=function($Tt){var $TM,$Tf,$Tc,$TD=0,$To=0,$TJ=0,$TZ=$Tt.length,$TA={};for(($Tf=$TL._temArr).length=0,$TD=($TZ=$Tt.length)-1;0<=$TD;$TD--)$Tc=($TM=$Tt[$TD]).x+"_"+$TM.y,$TA.hasOwnProperty($Tc)||($TA[$Tc]=!0,$Tf.push($TM));for($TZ=$Tf.length,$Ta.copyArray($Tt,$Tf),$TD=1;$TD<$TZ;$TD++)($Tt[$TD].y<$Tt[$TJ].y||$Tt[$TD].y==$Tt[$TJ].y&&$Tt[$TD].x<$Tt[$TJ].x)&&($TJ=$TD);for($TM=$Tt[0],$Tt[0]=$Tt[$TJ],$Tt[$TJ]=$TM,$TD=1;$TD<$TZ-1;$TD++){for($To=($TJ=$TD)+1;$To<$TZ;$To++)(0<$TL.multiply($Tt[$To],$Tt[$TJ],$Tt[0])||0==$TL.multiply($Tt[$To],$Tt[$TJ],$Tt[0])&&$TL.dis($Tt[0],$Tt[$To])<$TL.dis($Tt[0],$Tt[$TJ]))&&($TJ=$To);$TM=$Tt[$TD],$Tt[$TD]=$Tt[$TJ],$Tt[$TJ]=$TM}if(($Tf=$TL._temArr).length=0,$Tt.length<3)return $Ta.copyArray($Tf,$Tt);for($Tf.push($Tt[0],$Tt[1],$Tt[2]),$TD=3;$TD<$TZ;$TD++){for(;2<=$Tf.length&&0<=$TL.multiply($Tt[$TD],$Tf[$Tf.length-1],$Tf[$Tf.length-2]);)$Tf.pop();$Tt[$TD]&&$Tf.push($Tt[$TD])}return $Tf},$TL._mPointList=null,$TL._tempPointList=[],$TL._temPList=[],$TL._temArr=[],$TL}(),$Th=function(){function $TD(){}return $Tp($TD,"laya.maths.MathUtil"),$TD.subtractVector3=function($Tt,$TM,$Tf){$Tf[0]=$Tt[0]-$TM[0],$Tf[1]=$Tt[1]-$TM[1],$Tf[2]=$Tt[2]-$TM[2]},$TD.lerp=function($Tt,$TM,$Tf){return $Tt*(1-$Tf)+$TM*$Tf},$TD.scaleVector3=function($Tt,$TM,$Tf){$Tf[0]=$Tt[0]*$TM,$Tf[1]=$Tt[1]*$TM,$Tf[2]=$Tt[2]*$TM},$TD.lerpVector3=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt[0],$To=$Tt[1],$TJ=$Tt[2];$Tc[0]=$TD+$Tf*($TM[0]-$TD),$Tc[1]=$To+$Tf*($TM[1]-$To),$Tc[2]=$TJ+$Tf*($TM[2]-$TJ)},$TD.lerpVector4=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt[0],$To=$Tt[1],$TJ=$Tt[2],$TZ=$Tt[3];$Tc[0]=$TD+$Tf*($TM[0]-$TD),$Tc[1]=$To+$Tf*($TM[1]-$To),$Tc[2]=$TJ+$Tf*($TM[2]-$TJ),$Tc[3]=$TZ+$Tf*($TM[3]-$TZ)},$TD.slerpQuaternionArray=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ,$TA,$TL,$Tp,$TB,$Tb=$Tt[$TM+0],$TI=$Tt[$TM+1],$Tq=$Tt[$TM+2],$Tl=$Tt[$TM+3],$T_=$Tf[$Tc+0],$TE=$Tf[$Tc+1],$Te=$Tf[$Tc+2],$TN=$Tf[$Tc+3];return($TA=$Tb*$T_+$TI*$TE+$Tq*$Te+$Tl*$TN)<0&&($TA=-$TA,$T_=-$T_,$TE=-$TE,$Te=-$Te,$TN=-$TN),$TB=1e-6<1-$TA?($TZ=Math.acos($TA),$TL=Math.sin($TZ),$Tp=Math.sin((1-$TD)*$TZ)/$TL,Math.sin($TD*$TZ)/$TL):($Tp=1-$TD,$TD),$To[$TJ+0]=$Tp*$Tb+$TB*$T_,$To[$TJ+1]=$Tp*$TI+$TB*$TE,$To[$TJ+2]=$Tp*$Tq+$TB*$Te,$To[$TJ+3]=$Tp*$Tl+$TB*$TN,$To},$TD.getRotation=function($Tt,$TM,$Tf,$Tc){return Math.atan2($Tc-$TM,$Tf-$Tt)/Math.PI*180},$TD.sortBigFirst=function($Tt,$TM){return $Tt==$TM?0:$Tt<$TM?1:-1},$TD.sortSmallFirst=function($Tt,$TM){return $Tt==$TM?0:$Tt<$TM?-1:1},$TD.sortNumBigFirst=function($Tt,$TM){return parseFloat($TM)-parseFloat($Tt)},$TD.sortNumSmallFirst=function($Tt,$TM){return parseFloat($Tt)-parseFloat($TM)},$TD.sortByKey=function($Tf,$Tt,$TM){var $Tc;return void 0===$Tt&&($Tt=!1),void 0===$TM&&($TM=!0),$Tc=$Tt?$TM?$TD.sortNumBigFirst:$TD.sortBigFirst:$TM?$TD.sortNumSmallFirst:$TD.sortSmallFirst,function($Tt,$TM){return $Tc($Tt[$Tf],$TM[$Tf])}},$TD}(),$TF=function(){function $Tf($Tt,$TM,$Tf,$Tc,$TD,$To){this.inPool=!1,this.bTransform=!1,void 0===$Tt&&($Tt=1),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=1),void 0===$TD&&($TD=0),void 0===$To&&($To=0),this.a=$Tt,this.b=$TM,this.c=$Tf,this.d=$Tc,this.tx=$TD,this.ty=$To,this._checkTransform()}$Tp($Tf,"laya.maths.Matrix");var $Tt=$Tf.prototype;return $Tt.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$Tt._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$Tt.setTranslate=function($Tt,$TM){return this.tx=$Tt,this.ty=$TM,this},$Tt.translate=function($Tt,$TM){return this.tx+=$Tt,this.ty+=$TM,this},$Tt.scale=function($Tt,$TM){this.a*=$Tt,this.d*=$TM,this.c*=$Tt,this.b*=$TM,this.tx*=$Tt,this.ty*=$TM,this.bTransform=!0},$Tt.rotate=function($Tt){var $TM=Math.cos($Tt),$Tf=Math.sin($Tt),$Tc=this.a,$TD=this.c,$To=this.tx;this.a=$Tc*$TM-this.b*$Tf,this.b=$Tc*$Tf+this.b*$TM,this.c=$TD*$TM-this.d*$Tf,this.d=$TD*$Tf+this.d*$TM,this.tx=$To*$TM-this.ty*$Tf,this.ty=$To*$Tf+this.ty*$TM,this.bTransform=!0},$Tt.skew=function($Tt,$TM){var $Tf=Math.tan($Tt),$Tc=Math.tan($TM),$TD=this.a,$To=this.b;return this.a+=$Tc*this.c,this.b+=$Tc*this.d,this.c+=$Tf*$TD,this.d+=$Tf*$To,this},$Tt.invertTransformPoint=function($Tt){var $TM=this.a,$Tf=this.b,$Tc=this.c,$TD=this.d,$To=this.tx,$TJ=$TM*$TD-$Tf*$Tc,$TZ=$TD/$TJ,$TA=-$Tf/$TJ,$TL=-$Tc/$TJ,$Tp=$TM/$TJ,$TB=($Tc*this.ty-$TD*$To)/$TJ,$Tb=-($TM*this.ty-$Tf*$To)/$TJ;return $Tt.setTo($TZ*$Tt.x+$TL*$Tt.y+$TB,$TA*$Tt.x+$Tp*$Tt.y+$Tb)},$Tt.transformPoint=function($Tt){return $Tt.setTo(this.a*$Tt.x+this.c*$Tt.y+this.tx,this.b*$Tt.x+this.d*$Tt.y+this.ty)},$Tt.transformPointN=function($Tt){return $Tt.setTo(this.a*$Tt.x+this.c*$Tt.y,this.b*$Tt.x+this.d*$Tt.y)},$Tt.transformPointArray=function($Tt,$TM){for(var $Tf=$Tt.length,$Tc=0;$Tc<$Tf;$Tc+=2){var $TD=$Tt[$Tc],$To=$Tt[$Tc+1];$TM[$Tc]=this.a*$TD+this.c*$To+this.tx,$TM[$Tc+1]=this.b*$TD+this.d*$To+this.ty}return $TM},$Tt.transformPointArrayScale=function($Tt,$TM){for(var $Tf=$Tt.length,$Tc=0;$Tc<$Tf;$Tc+=2){var $TD=$Tt[$Tc],$To=$Tt[$Tc+1];$TM[$Tc]=this.a*$TD+this.c*$To,$TM[$Tc+1]=this.b*$TD+this.d*$To}return $TM},$Tt.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$Tt.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$Tt.invert=function(){var $Tt=this.a,$TM=this.b,$Tf=this.c,$Tc=this.d,$TD=this.tx,$To=$Tt*$Tc-$TM*$Tf;return this.a=$Tc/$To,this.b=-$TM/$To,this.c=-$Tf/$To,this.d=$Tt/$To,this.tx=($Tf*this.ty-$Tc*$TD)/$To,this.ty=-($Tt*this.ty-$TM*$TD)/$To,this},$Tt.setTo=function($Tt,$TM,$Tf,$Tc,$TD,$To){return this.a=$Tt,this.b=$TM,this.c=$Tf,this.d=$Tc,this.tx=$TD,this.ty=$To,this},$Tt.concat=function($Tt){var $TM=this.a,$Tf=this.c,$Tc=this.tx;return this.a=$TM*$Tt.a+this.b*$Tt.c,this.b=$TM*$Tt.b+this.b*$Tt.d,this.c=$Tf*$Tt.a+this.d*$Tt.c,this.d=$Tf*$Tt.b+this.d*$Tt.d,this.tx=$Tc*$Tt.a+this.ty*$Tt.c+$Tt.tx,this.ty=$Tc*$Tt.b+this.ty*$Tt.d+$Tt.ty,this},$Tt.scaleEx=function($Tt,$TM){var $Tf=this.a,$Tc=this.b,$TD=this.c,$To=this.d;0!==$Tc||0!==$TD?(this.a=$Tt*$Tf,this.b=$Tt*$Tc,this.c=$TM*$TD):(this.a=$Tt*$Tf,this.b=0*$To,this.c=0*$Tf),this.d=$TM*$To,this.bTransform=!0},$Tt.rotateEx=function($Tt){var $TM=Math.cos($Tt),$Tf=Math.sin($Tt),$Tc=this.a,$TD=this.b,$To=this.c,$TJ=this.d;0!==$TD||0!==$To?(this.a=$TM*$Tc+$Tf*$To,this.b=$TM*$TD+$Tf*$TJ,this.c=-$Tf*$Tc+$TM*$To,this.d=-$Tf*$TD+$TM*$TJ):(this.a=$TM*$Tc,this.b=$Tf*$TJ,this.c=-$Tf*$Tc,this.d=$TM*$TJ),this.bTransform=!0},$Tt.clone=function(){var $Tt=$Tf.create();return $Tt.a=this.a,$Tt.b=this.b,$Tt.c=this.c,$Tt.d=this.d,$Tt.tx=this.tx,$Tt.ty=this.ty,$Tt.bTransform=this.bTransform,$Tt},$Tt.copyTo=function($Tt){return $Tt.a=this.a,$Tt.b=this.b,$Tt.c=this.c,$Tt.d=this.d,$Tt.tx=this.tx,$Tt.ty=this.ty,$Tt.bTransform=this.bTransform,$Tt},$Tt.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$Tt.destroy=function(){if(!this.inPool){var $Tt=$Tf._cache;this.inPool=!0,$Tt._length||($Tt._length=0),($Tt[$Tt._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$Tf.mul=function($Tt,$TM,$Tf){var $Tc=$Tt.a,$TD=$Tt.b,$To=$Tt.c,$TJ=$Tt.d,$TZ=$Tt.tx,$TA=$Tt.ty,$TL=$TM.a,$Tp=$TM.b,$TB=$TM.c,$Tb=$TM.d,$TI=$TM.tx,$Tq=$TM.ty;return 0!==$Tp||0!==$TB?($Tf.a=$Tc*$TL+$TD*$TB,$Tf.b=$Tc*$Tp+$TD*$Tb,$Tf.c=$To*$TL+$TJ*$TB,$Tf.d=$To*$Tp+$TJ*$Tb,$Tf.tx=$TL*$TZ+$TB*$TA+$TI,$Tf.ty=$Tp*$TZ+$Tb*$TA+$Tq):($Tf.a=$Tc*$TL,$Tf.b=$TD*$Tb,$Tf.c=$To*$TL,$Tf.d=$TJ*$Tb,$Tf.tx=$TL*$TZ+$TI,$Tf.ty=$Tb*$TA+$Tq),$Tf},$Tf.mul16=function($Tt,$TM,$Tf){var $Tc=$Tt.a,$TD=$Tt.b,$To=$Tt.c,$TJ=$Tt.d,$TZ=$Tt.tx,$TA=$Tt.ty,$TL=$TM.a,$Tp=$TM.b,$TB=$TM.c,$Tb=$TM.d,$TI=$TM.tx,$Tq=$TM.ty;return 0!==$Tp||0!==$TB?($Tf[0]=$Tc*$TL+$TD*$TB,$Tf[1]=$Tc*$Tp+$TD*$Tb,$Tf[4]=$To*$TL+$TJ*$TB,$Tf[5]=$To*$Tp+$TJ*$Tb,$Tf[12]=$TL*$TZ+$TB*$TA+$TI,$Tf[13]=$Tp*$TZ+$Tb*$TA+$Tq):($Tf[0]=$Tc*$TL,$Tf[1]=$TD*$Tb,$Tf[4]=$To*$TL,$Tf[5]=$TJ*$Tb,$Tf[12]=$TL*$TZ+$TI,$Tf[13]=$Tb*$TA+$Tq),$Tf},$Tf.mulPre=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=$Tt.a,$TL=$Tt.b,$Tp=$Tt.c,$TB=$Tt.d,$Tb=$Tt.tx,$TI=$Tt.ty;return 0!==$Tf||0!==$Tc?($TZ.a=$TA*$TM+$TL*$Tc,$TZ.b=$TA*$Tf+$TL*$TD,$TZ.c=$Tp*$TM+$TB*$Tc,$TZ.d=$Tp*$Tf+$TB*$TD,$TZ.tx=$TM*$Tb+$Tc*$TI+$To,$TZ.ty=$Tf*$Tb+$TD*$TI+$TJ):($TZ.a=$TA*$TM,$TZ.b=$TL*$TD,$TZ.c=$Tp*$TM,$TZ.d=$TB*$TD,$TZ.tx=$TM*$Tb+$To,$TZ.ty=$TD*$TI+$TJ),$TZ},$Tf.mulPos=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=$Tt.a,$TL=$Tt.b,$Tp=$Tt.c,$TB=$Tt.d,$Tb=$Tt.tx,$TI=$Tt.ty;return 0!==$TL||0!==$Tp?($TZ.a=$TM*$TA+$Tf*$Tp,$TZ.b=$TM*$TL+$Tf*$TB,$TZ.c=$Tc*$TA+$TD*$Tp,$TZ.d=$Tc*$TL+$TD*$TB,$TZ.tx=$TA*$To+$Tp*$TJ+$Tb,$TZ.ty=$TL*$To+$TB*$TJ+$TI):($TZ.a=$TM*$TA,$TZ.b=$Tf*$TB,$TZ.c=$Tc*$TA,$TZ.d=$TD*$TB,$TZ.tx=$TA*$To+$Tb,$TZ.ty=$TB*$TJ+$TI),$TZ},$Tf.preMul=function($Tt,$TM,$Tf){var $Tc=$Tt.a,$TD=$Tt.b,$To=$Tt.c,$TJ=$Tt.d,$TZ=$TM.a,$TA=$TM.b,$TL=$TM.c,$Tp=$TM.d,$TB=$TM.tx,$Tb=$TM.ty;return $Tf.a=$TZ*$Tc,$Tf.b=$Tf.c=0,$Tf.d=$Tp*$TJ,$Tf.tx=$TB*$Tc+$Tt.tx,$Tf.ty=$Tb*$TJ+$Tt.ty,0===$TA&&0===$TL&&0===$TD&&0===$To||($Tf.a+=$TA*$To,$Tf.d+=$TL*$TD,$Tf.b+=$TZ*$TD+$TA*$TJ,$Tf.c+=$TL*$Tc+$Tp*$To,$Tf.tx+=$Tb*$To,$Tf.ty+=$TB*$TD),$Tf},$Tf.preMulXY=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.a,$To=$Tt.b,$TJ=$Tt.c,$TZ=$Tt.d;return $Tc.a=$TD,$Tc.b=$To,$Tc.c=$TJ,$Tc.d=$TZ,$Tc.tx=$TM*$TD+$Tt.tx+$Tf*$TJ,$Tc.ty=$Tf*$TZ+$Tt.ty+$TM*$To,$Tc},$Tf.create=function(){var $Tt=$Tf._cache,$TM=$Tt._length?$Tt[--$Tt._length]:new $Tf;return $TM.inPool=!1,$TM},$Tf.EMPTY=new $Tf,$Tf.TEMP=new $Tf,$Tf._cache=[],$Tf}(),$Ti=function(){function $Tt($Tt,$TM){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),this.x=$Tt,this.y=$TM}$Tp($Tt,"laya.maths.Point");var $TM=$Tt.prototype;return $TM.setTo=function($Tt,$TM){return this.x=$Tt,this.y=$TM,this},$TM.distance=function($Tt,$TM){return Math.sqrt((this.x-$Tt)*(this.x-$Tt)+(this.y-$TM)*(this.y-$TM))},$TM.toString=function(){return this.x+","+this.y},$TM.normalize=function(){var $Tt=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$Tt){var $TM=1/$Tt;this.x*=$TM,this.y*=$TM}},$Tt.TEMP=new $Tt,$Tt.EMPTY=new $Tt,$Tt}(),$TV=function(){function $TL($Tt,$TM,$Tf,$Tc){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),this.x=$Tt,this.y=$TM,this.width=$Tf,this.height=$Tc}$Tp($TL,"laya.maths.Rectangle");var $Tt=$TL.prototype;return $Tt.setTo=function($Tt,$TM,$Tf,$Tc){return this.x=$Tt,this.y=$TM,this.width=$Tf,this.height=$Tc,this},$Tt.copyFrom=function($Tt){return this.x=$Tt.x,this.y=$Tt.y,this.width=$Tt.width,this.height=$Tt.height,this},$Tt.contains=function($Tt,$TM){return!(this.width<=0||this.height<=0)&&($Tt>=this.x&&$Tt<this.right&&$TM>=this.y&&$TM<this.bottom)},$Tt.intersects=function($Tt){return!($Tt.x>this.x+this.width||$Tt.x+$Tt.width<this.x||$Tt.y>this.y+this.height||$Tt.y+$Tt.height<this.y)},$Tt.intersection=function($Tt,$TM){return this.intersects($Tt)?($TM||($TM=new $TL),$TM.x=Math.max(this.x,$Tt.x),$TM.y=Math.max(this.y,$Tt.y),$TM.width=Math.min(this.right,$Tt.right)-$TM.x,$TM.height=Math.min(this.bottom,$Tt.bottom)-$TM.y,$TM):null},$Tt.union=function($Tt,$TM){return $TM||($TM=new $TL),this.clone($TM),$Tt.width<=0||$Tt.height<=0?$TM:($TM.addPoint($Tt.x,$Tt.y),$TM.addPoint($Tt.right,$Tt.bottom),this)},$Tt.clone=function($Tt){return $Tt||($Tt=new $TL),$Tt.x=this.x,$Tt.y=this.y,$Tt.width=this.width,$Tt.height=this.height,$Tt},$Tt.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$Tt.equals=function($Tt){return!(!$Tt||$Tt.x!==this.x||$Tt.y!==this.y||$Tt.width!==this.width||$Tt.height!==this.height)},$Tt.addPoint=function($Tt,$TM){return this.x>$Tt&&(this.width+=this.x-$Tt,this.x=$Tt),this.y>$TM&&(this.height+=this.y-$TM,this.y=$TM),this.width<$Tt-this.x&&(this.width=$Tt-this.x),this.height<$TM-this.y&&(this.height=$TM-this.y),this},$Tt._getBoundPoints=function(){var $Tt=$TL._temB;return($Tt.length=0)==this.width||0==this.height||$Tt.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$Tt},$Tt.isEmpty=function(){return this.width<=0||this.height<=0},$Tq(0,$Tt,"right",function(){return this.x+this.width}),$Tq(0,$Tt,"bottom",function(){return this.y+this.height}),$TL._getBoundPointS=function($Tt,$TM,$Tf,$Tc){var $TD=$TL._temA;return($TD.length=0)==$Tf||0==$Tc||$TD.push($Tt,$TM,$Tt+$Tf,$TM,$Tt,$TM+$Tc,$Tt+$Tf,$TM+$Tc),$TD},$TL._getWrapRec=function($Tt,$TM){if(!$Tt||$Tt.length<1)return $TM?$TM.setTo(0,0,0,0):$TL.TEMP.setTo(0,0,0,0);$TM=$TM||new $TL;var $Tf,$Tc,$TD,$To,$TJ,$TZ=$Tt.length,$TA=$Ti.TEMP;for($TD=$TJ=-($Tc=$To=99999),$Tf=0;$Tf<$TZ;$Tf+=2)$TA.x=$Tt[$Tf],$TA.y=$Tt[$Tf+1],$Tc=$Tc<$TA.x?$Tc:$TA.x,$To=$To<$TA.y?$To:$TA.y,$TD=$TD>$TA.x?$TD:$TA.x,$TJ=$TJ>$TA.y?$TJ:$TA.y;return $TM.setTo($Tc,$To,$TD-$Tc,$TJ-$To)},$TL.EMPTY=new $TL,$TL.TEMP=new $TL,$TL._temB=[],$TL._temA=[],$TL}(),$TC=function(){function $TA(){}return $Tp($TA,"laya.media.SoundManager"),$Tq(1,$TA,"useAudioMusic",function(){return $TA._useAudioMusic},function($Tt){$TA._useAudioMusic=$Tt,$TA._musicClass=$Tt?$Tft:null}),$Tq(1,$TA,"autoStopMusic",function(){return $TA._autoStopMusic},function($Tt){$TT.stage.off("blur",null,$TA._stageOnBlur),$TT.stage.off("focus",null,$TA._stageOnFocus),$TT.stage.off("visibilitychange",null,$TA._visibilityChange),($TA._autoStopMusic=$Tt)&&($TT.stage.on("blur",null,$TA._stageOnBlur),$TT.stage.on("focus",null,$TA._stageOnFocus),$TT.stage.on("visibilitychange",null,$TA._visibilityChange))}),$Tq(1,$TA,"muted",function(){return $TA._muted},function($Tt){$Tt!=$TA._muted&&($Tt&&$TA.stopAllSound(),$TA.musicMuted=$Tt,$TA._muted=$Tt)}),$Tq(1,$TA,"musicMuted",function(){return $TA._musicMuted},function($Tt){$Tt!=$TA._musicMuted&&($Tt?($TA._tMusic&&$TA._musicChannel&&!$TA._musicChannel.isStopped?$TA._musicChannel.pause():$TA._musicChannel=null,$TA._musicMuted=$Tt):($TA._musicMuted=$Tt,$TA._tMusic&&$TA._musicChannel&&$TA._musicChannel.resume()))}),$Tq(1,$TA,"soundMuted",function(){return $TA._soundMuted},function($Tt){$TA._soundMuted=$Tt}),$TA.addChannel=function($Tt){0<=$TA._channels.indexOf($Tt)||($TA._channels.push($Tt),$TA.autoReleaseSound&&0!=$TA._notUsedCount&&$TA._notUsedUrls[$Tt.url]&&(delete $TA._notUsedUrls[$Tt.url],0==--$TA._notUsedCount&&$TT.timer.clear($TA,$TA.disposeSoundIfNotUsed)))},$TA.removeChannel=function($Tt){var $TM=$TA._channels,$Tf=$TM.indexOf($Tt);if(-1!=$Tf&&($TM.splice($Tf,1),$TA.autoReleaseSound)){var $Tc=$Tt.url,$TD=$TA.defaultIntervals[$Tc]||2e4;if(0<$TD){var $To=!0;for($Tf=$TM.length-1;0<=$Tf;$Tf--)if($TM[$Tf].url==$Tc){$To=!1;break}$To&&($TA._notUsedUrls[$Tc]=Date.now()+$TD,0==$TA._notUsedCount++&&$TT.timer.loop(1e4,$TA,$TA.disposeSoundIfNotUsed))}}},$TA.disposeSoundIfNotUsed=function(){var $Tt=$TA._notUsedUrls;if(0!=$TA._notUsedCount){var $TM=Date.now();for(var $Tf in $Tt)$TM>=$Tt[$Tf]&&(delete $Tt[$Tf],--$TA._notUsedCount,$TA.destroySound($Tf));if(0!=$TA._notUsedCount)return}$TT.timer.clear($TA,$TA.disposeSoundIfNotUsed)},$TA._visibilityChange=function(){$TT.stage.isVisibility?$TA._stageOnFocus():$TA._stageOnBlur()},$TA._stageOnBlur=function(){$TA._isActive=!1,$TA._musicChannel&&($TA._musicChannel.isStopped||($TA._blurPaused=!0,$TA._musicChannel.pause())),$TA.stopAllSound(),$TT.stage.once("mousedown",null,$TA._stageOnFocus)},$TA._recoverWebAudio=function(){$Tot.ctx&&"running"!=$Tot.ctx.state&&$Tot.ctx.resume&&$Tot.ctx.resume()},$TA._stageOnFocus=function(){if($TA._isActive=!0,$TA._recoverWebAudio(),$TT.stage.off("mousedown",null,$TA._stageOnFocus),$TA._blurPaused){var $Tt=$TA._musicChannel;$Tt&&$TA._music&&$Tt.isStopped&&($TA._blurPaused=!1,$TA._music._disposed?$TA.playMusic($Tt.url,$Tt.loops,$Tt.startHandler,$Tt.completeHandler,$Tt.startTime):$Tt.audioBuffer?$Tt.resume():$TA._music.play($Tt.startTime,$Tt.loops,$Tt.startHandler,$Tt))}},$TA.playSound=function($Tt,$TM,$Tf,$Tc,$TD,$To){if(void 0===$TM&&($TM=1),void 0===$To&&($To=0),!$Tt)return null;if($TA._muted)return null;if($TA._recoverWebAudio(),$Tt==$TA._tMusic){if($TA._musicMuted)return null}else{if(!$TA._isActive)return null;if($TA._soundMuted)return null}var $TJ,$TZ=$TA._pool[$Tt];return $TD||($TD=$TA._soundClass),$TZ||(($TZ=new $TD).load($Tt),$TA._pool[$Tt]=$TZ),($TJ=$TZ.play($To,$TM,$Tf))?($Tt==$TA._tMusic&&($TA._music=$TZ,$TA._isActive||($TA._blurPaused=!0,$TJ.pause())),$TJ.url=$Tt,$TJ.volume=$Tt==$TA._tMusic?$TA.musicVolume:$TA.soundVolume,$TJ.completeHandler=$Tc,$TJ):null},$TA.destroySound=function($Tt){var $TM=$TA._pool[$Tt];$TM&&(delete $TA._pool[$Tt],$TM.dispose())},$TA.playMusic=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TM&&($TM=0),void 0===$TD&&($TD=0),$TA._tMusic=$Tt,$TA._musicChannel&&$TA._musicChannel.stop(),$TA._musicChannel=$TA.playSound($Tt,$TM,$Tf,$Tc,null,$TD)},$TA.stopSound=function($Tt){for(var $TM,$Tf=$TA._channels.length-1;0<=$Tf;$Tf--)($TM=$TA._channels[$Tf]).url==$Tt&&$TM.stop()},$TA.stopAll=function(){$TA._tMusic=null;var $Tt=0;for($Tt=$TA._channels.length-1;0<=$Tt;$Tt--)$TA._channels[$Tt].stop()},$TA.stopAllSound=function(){var $Tt,$TM=0;for($TM=$TA._channels.length-1;0<=$TM;$TM--)($Tt=$TA._channels[$TM]).url!=$TA._tMusic&&$Tt.stop()},$TA.stopMusic=function(){$TA._musicChannel&&$TA._musicChannel.stop(),$TA._tMusic=null},$TA.setSoundVolume=function($Tt,$TM){if($TM)$TA._setVolume($TM,$Tt);else{$TA.soundVolume=$Tt;var $Tf,$Tc=0;for($Tc=$TA._channels.length-1;0<=$Tc;$Tc--)($Tf=$TA._channels[$Tc]).url!=$TA._tMusic&&($Tf.volume=$Tt)}},$TA.setMusicVolume=function($Tt){$TA.musicVolume=$Tt,$TA._setVolume($TA._tMusic,$Tt)},$TA._setVolume=function($Tt,$TM){for(var $Tf,$Tc=$TA._channels.length-1;0<=$Tc;$Tc--)($Tf=$TA._channels[$Tc]).url==$Tt&&($Tf.volume=$TM)},$TA.musicVolume=1,$TA.soundVolume=1,$TA.playbackRate=1,$TA._useAudioMusic=!0,$TA._muted=!1,$TA._soundMuted=!1,$TA._musicMuted=!1,$TA._tMusic=null,$TA._musicChannel=null,$TA._music=null,$TA._channels=[],$TA._autoStopMusic=!1,$TA._blurPaused=!1,$TA._isActive=!0,$TA._soundClass=null,$TA._musicClass=null,$TA.autoReleaseSound=!0,$TA._pool={},$TA.defaultIntervals={},$TA._notUsedUrls={},$TA._notUsedCount=0,$TA}(),$Tx=function(){var $Tt;function $Tf(){}return $Tp($Tf,"laya.net.LocalStorage"),$Tf.__init__=function(){$Tf._baseClass||($Tf._baseClass=$Tt).init(),$Tf.items=$Tf._baseClass.items,$Tf.support=$Tf._baseClass.support},$Tf.setItem=function($Tt,$TM){$Tf._baseClass.setItem($Tt,$TM)},$Tf.getItem=function($Tt){return $Tf._baseClass.getItem($Tt)},$Tf.setJSON=function($Tt,$TM){$Tf._baseClass.setJSON($Tt,$TM)},$Tf.getJSON=function($Tt){return $Tf._baseClass.getJSON($Tt)},$Tf.removeItem=function($Tt){$Tf._baseClass.removeItem($Tt)},$Tf.clear=function(){$Tf._baseClass.clear()},$Tf._baseClass=null,$Tf.items=null,$Tf.support=!1,$Tf.__init$=function(){$Tt=function(){function $Tf(){}return $Tp($Tf,""),$Tf.init=function(){try{$Tf.support=!0,$Tf.items=$TJ.localStorage,$Tf.setItem("laya","1"),$Tf.removeItem("laya")}catch($Tt){$Tf.support=!1}$Tf.support||console.log("LocalStorage is not supprot or browser is private mode.")},$Tf.setItem=function($Tt,$TM){try{$Tf.support&&$Tf.items.setItem($Tt,$TM)}catch($Tt){console.warn("set localStorage failed",$Tt)}},$Tf.getItem=function($Tt){return $Tf.support?$Tf.items.getItem($Tt):null},$Tf.setJSON=function($Tt,$TM){try{$Tf.support&&$Tf.items.setItem($Tt,JSON.stringify($TM))}catch($Tt){console.warn("set localStorage failed",$Tt)}},$Tf.getJSON=function($Tt){return JSON.parse($Tf.support?$Tf.items.getItem($Tt):null)},$Tf.removeItem=function($Tt){$Tf.support&&$Tf.items.removeItem($Tt)},$Tf.clear=function(){$Tf.support&&$Tf.items.clear()},$Tf.items=null,$Tf.support=!1,$Tf}()},$Tf}(),$TS=(function(){function $Tc(){}$Tp($Tc,"laya.net.ResourceVersion"),$Tc.enable=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=2),laya.net.ResourceVersion.type=$Tf,$TT.loader.load($Tt,$Te.create(null,$Tc.onManifestLoaded,[$TM]),null,"json"),$TH.customFormat=$Tc.addVersionPrefix},$Tc.onManifestLoaded=function($Tt,$TM){$Tc.manifest=$TM,$Tt.run(),$TM||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$Tc.addVersionPrefix=function($Tt){return $Tc.manifest&&$Tc.manifest[$Tt]?2==$Tc.type?$Tc.manifest[$Tt]:$Tc.manifest[$Tt]+"/"+$Tt:$Tt},$Tc.FOLDER_VERSION=1,$Tc.FILENAME_VERSION=2,$Tc.manifest=null,$Tc.type=1}(),function(){function $Tt(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$Tp($Tt,"laya.net.TTFLoader");var $TM=$Tt.prototype;return $TM.load=function($Tt){var $TM=(this._url=$Tt).split(".ttf")[0].split("/");this.fontName=$TM[$TM.length-1],$TK.window.conch?this._loadConch():$TK.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$TM._loadConch=function(){this._http=new $TJt,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$TM._onHttpLoaded=function($Tt){$TK.window.conch.setFontFaceFromBuffer(this.fontName,$Tt),this._clearHttp(),this._complete()},$TM._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$TM._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$TM._complete=function(){$TT.timer.clear(this,this._complete),$TT.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$TM._checkComplete=function(){$TU.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$TM._loadWithFontFace=function(){var $Tt=new $TK.window.FontFace(this.fontName,"url('"+this._url+"')");$TK.window.document.fonts.add($Tt);var $TM=this;$Tt.loaded.then(function(){$TM._complete()}),$Tt.load()},$TM._createDiv=function(){this._div=$TK.createElement("div"),this._div.innerHTML="laya";var $Tt=this._div.style;$Tt.fontFamily=this.fontName,$Tt.position="absolute",$Tt.left="-100px",$Tt.top="-100px",$TK.document.body.appendChild(this._div)},$TM._loadWithCSS=function(){var $Tt=this,$TM=$TK.createElement("style");$TM.type="text/css",$TK.document.body.appendChild($TM),$TM.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$TU.measureText("LayaTTFFont",this._fontTxt).width;var $Tf=this;$TM.onload=function(){$TT.timer.once(1e4,$Tf,$Tt._complete)},$TT.timer.loop(20,this,this._checkComplete),this._createDiv()},$Tt._testString="LayaTTFFont",$Tt}()),$TH=function(){function $Tc($Tt){this._url=null,this._path=null,this._url=$Tc.formatURL($Tt),this._path=$Tc.getPath($Tt)}$Tp($Tc,"laya.net.URL");var $Tt=$Tc.prototype;return $Tq(0,$Tt,"path",function(){return this._path}),$Tq(0,$Tt,"url",function(){return this._url}),$Tc.formatURL=function($Tt,$TM){if(!$Tt)return"null path";if(0<$Tt.indexOf(":"))return $Tt;null!=$Tc.customFormat&&($Tt=$Tc.customFormat($Tt,$TM));var $Tf=$Tt.charAt(0);if("."===$Tf)return $Tc.formatRelativePath(($TM||$Tc.basePath)+$Tt);if("~"===$Tf)return $Tc.rootPath+$Tt.substring(1);if("d"===$Tf){if(0===$Tt.indexOf("data:image"))return $Tt}else if("/"===$Tf)return $Tt;return($TM||$Tc.basePath)+$Tt},$Tc.formatRelativePath=function($Tt){for(var $TM=$Tt.split("/"),$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)".."==$TM[$Tf]&&($TM.splice($Tf-1,2),$Tf-=2);return $TM.join("/")},$Tc.isAbsolute=function($Tt){return 0<$Tt.indexOf(":")||"/"==$Tt.charAt(0)},$Tc.getPath=function($Tt){var $TM=$Tt.lastIndexOf("/");return 0<$TM?$Tt.substr(0,$TM+1):""},$Tc.getFileName=function($Tt){var $TM=$Tt.lastIndexOf("/");return 0<$TM?$Tt.substr($TM+1):$Tt},$Tc.version={},$Tc.basePath="",$Tc.rootPath="",$Tc.customFormat=function($Tt){var $TM=$Tc.version[$Tt];return!$Ts.isConchApp&&$TM&&($Tt+="?v="+$TM),$Tt},$Tc}(),$Ts=function(){function $TD($Tt,$TM){this._timeId=0;var $Tf=$TD._mainCanvas.source.style;$Tf.position="absolute",$Tf.top=$Tf.left="0px",$Tf.background="#000000",$TD._mainCanvas.source.id="layaCanvas";var $Tc=laya.renders.Render.isWebGL;$TD._mainCanvas.source.width=$Tt,$TD._mainCanvas.source.height=$TM,$Tc&&$TD.WebGL.init($TD._mainCanvas,$Tt,$TM),$TK.container.appendChild($TD._mainCanvas.source),($TD._context=new $Tr($Tt,$TM,$Tc?null:$TD._mainCanvas)).ctx.setIsMainContext(),$TK.window.requestAnimationFrame(function $Tt($TM){$TK.window.requestAnimationFrame($Tt);$TT.stage._loop()}),$TT.stage.on("visibilitychange",this,this._onVisibilitychange)}$Tp($TD,"laya.renders.Render");var $Tt=$TD.prototype;return $Tt._onVisibilitychange=function(){$TT.stage.isVisibility?0!=this._timeId&&$TK.window.clearInterval(this._timeId):this._timeId=$TK.window.setInterval(this._enterFrame,1e3)},$Tt._enterFrame=function($Tt){$TT.stage._loop()},$Tq(1,$TD,"context",function(){return $TD._context}),$Tq(1,$TD,"canvas",function(){return $TD._mainCanvas.source}),$TD._context=null,$TD._mainCanvas=null,$TD.WebGL=null,$TD.isConchNode=!1,$TD.isConchApp=!1,$TD.isConchWebGL=!1,$TD.isWebGL=!1,$TD.is3DMode=!1,$TD.optimizeTextureMemory=function($Tt,$TM){return!0},$TD.__init$=function(){$TJ.ConchRenderType=$TJ.ConchRenderType||1,$TJ.ConchRenderType|=$TJ.conch?4:0,$TD.isConchNode=5==(5&$TJ.ConchRenderType),$TD.isConchApp=4==(4&$TJ.ConchRenderType),$TD.isConchWebGL=6==$TJ.ConchRenderType},$TD}(),$Tr=function(){function $TJ($Tt,$TM,$Tf){this.x=0,this.y=0,this._drawTexture=function($Tt,$TM,$Tf){$Tf[0].loaded&&this.ctx.drawTexture($Tf[0],$Tf[1],$Tf[2],$Tf[3],$Tf[4],$Tt,$TM)},this._fillTexture=function($Tt,$TM,$Tf){$Tf[0].loaded&&this.ctx.fillTexture($Tf[0],$Tf[1]+$Tt,$Tf[2]+$TM,$Tf[3],$Tf[4],$Tf[5],$Tf[6],$Tf[7])},this._drawTextureWithTransform=function($Tt,$TM,$Tf){$Tf[0].loaded&&this.ctx.drawTextureWithTransform($Tf[0],$Tf[1],$Tf[2],$Tf[3],$Tf[4],$Tf[5],$Tt,$TM,$Tf[6])},this._fillQuadrangle=function($Tt,$TM,$Tf){this.ctx.fillQuadrangle($Tf[0],$Tf[1],$Tf[2],$Tf[3],$Tf[4])},this._drawRect=function($Tt,$TM,$Tf){var $Tc=this.ctx;null!=$Tf[4]&&($Tc.fillStyle=$Tf[4],$Tc.fillRect($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3],null)),null!=$Tf[5]&&($Tc.strokeStyle=$Tf[5],$Tc.lineWidth=$Tf[6],$Tc.strokeRect($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3],$Tf[6]))},this._drawPie=function($Tt,$TM,$Tf){var $Tc=this.ctx;$Ts.isWebGL&&$Tc.setPathId($Tf[8]),$Tc.beginPath(),$Ts.isWebGL?($Tc.movePath($Tf[0]+$Tt,$Tf[1]+$TM),$Tc.moveTo(0,0)):$Tc.moveTo($Tt+$Tf[0],$TM+$Tf[1]),$Tc.arc($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3],$Tf[4]),$Tc.closePath(),this._fillAndStroke($Tf[5],$Tf[6],$Tf[7],!0)},this._clipRect=function($Tt,$TM,$Tf){this.ctx.clipRect($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3])},this._fillRect=function($Tt,$TM,$Tf){this.ctx.fillRect($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3],$Tf[4])},this._drawCircle=function($Tt,$TM,$Tf){var $Tc=this.ctx;$Ts.isWebGL&&$Tc.setPathId($Tf[6]),$Tz.drawCall++,$Tc.beginPath(),$Ts.isWebGL&&$Tc.movePath($Tf[0]+$Tt,$Tf[1]+$TM),$Tc.arc($Tf[0]+$Tt,$Tf[1]+$TM,$Tf[2],0,$TJ.PI2),$Tc.closePath(),this._fillAndStroke($Tf[3],$Tf[4],$Tf[5],!0)},this._fillCircle=function($Tt,$TM,$Tf){$Tz.drawCall++;var $Tc=this.ctx;$Tc.beginPath(),$Tc.fillStyle=$Tf[3],$Tc.arc($Tf[0]+$Tt,$Tf[1]+$TM,$Tf[2],0,$TJ.PI2),$Tc.fill()},this._setShader=function($Tt,$TM,$Tf){this.ctx.setShader($Tf[0])},this._drawLine=function($Tt,$TM,$Tf){var $Tc=this.ctx;$Ts.isWebGL&&$Tc.setPathId($Tf[6]),$Tc.beginPath(),$Tc.strokeStyle=$Tf[4],$Tc.lineWidth=$Tf[5],$Ts.isWebGL?($Tc.movePath($Tt,$TM),$Tc.moveTo($Tf[0],$Tf[1]),$Tc.lineTo($Tf[2],$Tf[3])):($Tc.moveTo($Tt+$Tf[0],$TM+$Tf[1]),$Tc.lineTo($Tt+$Tf[2],$TM+$Tf[3])),$Tc.stroke()},this._drawLines=function($Tt,$TM,$Tf){var $Tc=this.ctx;$Ts.isWebGL&&$Tc.setPathId($Tf[5]),$Tc.beginPath(),$Tt+=$Tf[0],$TM+=$Tf[1],$Ts.isWebGL&&$Tc.movePath($Tt,$TM),$Tc.strokeStyle=$Tf[3],$Tc.lineWidth=$Tf[4];var $TD=$Tf[2],$To=2,$TJ=$TD.length;if($Ts.isWebGL)for($Tc.moveTo($TD[0],$TD[1]);$To<$TJ;)$Tc.lineTo($TD[$To++],$TD[$To++]);else for($Tc.moveTo($Tt+$TD[0],$TM+$TD[1]);$To<$TJ;)$Tc.lineTo($Tt+$TD[$To++],$TM+$TD[$To++]);$Tc.stroke()},this._drawLinesWebGL=function($Tt,$TM,$Tf){this.ctx.drawLines($Tt+this.x+$Tf[0],$TM+this.y+$Tf[1],$Tf[2],$Tf[3],$Tf[4])},this._drawCurves=function($Tt,$TM,$Tf){this.ctx.drawCurves($Tt,$TM,$Tf)},this._draw=function($Tt,$TM,$Tf){$Tf[0].call(null,this,$Tt,$TM)},this._transformByMatrix=function($Tt,$TM,$Tf){this.ctx.transformByMatrix($Tf[0])},this._setTransform=function($Tt,$TM,$Tf){this.ctx.setTransform($Tf[0],$Tf[1],$Tf[2],$Tf[3],$Tf[4],$Tf[5])},this._setTransformByMatrix=function($Tt,$TM,$Tf){this.ctx.setTransformByMatrix($Tf[0])},this._save=function($Tt,$TM,$Tf){this.ctx.save()},this._restore=function($Tt,$TM,$Tf){this.ctx.restore()},this._translate=function($Tt,$TM,$Tf){this.ctx.translate($Tf[0],$Tf[1])},this._transform=function($Tt,$TM,$Tf){this.ctx.translate($Tf[1]+$Tt,$Tf[2]+$TM);var $Tc=$Tf[0];this.ctx.transform($Tc.a,$Tc.b,$Tc.c,$Tc.d,$Tc.tx,$Tc.ty),this.ctx.translate(-$Tt-$Tf[1],-$TM-$Tf[2])},this._rotate=function($Tt,$TM,$Tf){this.ctx.translate($Tf[1]+$Tt,$Tf[2]+$TM),this.ctx.rotate($Tf[0]),this.ctx.translate(-$Tt-$Tf[1],-$TM-$Tf[2])},this._scale=function($Tt,$TM,$Tf){this.ctx.translate($Tf[2]+$Tt,$Tf[3]+$TM),this.ctx.scale($Tf[0],$Tf[1]),this.ctx.translate(-$Tt-$Tf[2],-$TM-$Tf[3])},this._alpha=function($Tt,$TM,$Tf){this.ctx.globalAlpha*=$Tf[0]},this._setAlpha=function($Tt,$TM,$Tf){this.ctx.globalAlpha=$Tf[0]},this._fillText=function($Tt,$TM,$Tf){this.ctx.fillText($Tf[0],$Tf[1]+$Tt,$Tf[2]+$TM,$Tf[3],$Tf[4],$Tf[5])},this._strokeText=function($Tt,$TM,$Tf){this.ctx.strokeText($Tf[0],$Tf[1]+$Tt,$Tf[2]+$TM,$Tf[3],$Tf[4],$Tf[5],$Tf[6])},this._fillBorderText=function($Tt,$TM,$Tf){this.ctx.fillBorderText($Tf[0],$Tf[1]+$Tt,$Tf[2]+$TM,$Tf[3],$Tf[4],$Tf[5],$Tf[6],$Tf[7])},this._blendMode=function($Tt,$TM,$Tf){this.ctx.globalCompositeOperation=$Tf[0]},this._beginClip=function($Tt,$TM,$Tf){this.ctx.beginClip&&this.ctx.beginClip($Tt+$Tf[0],$TM+$Tf[1],$Tf[2],$Tf[3])},this._setIBVB=function($Tt,$TM,$Tf){this.ctx.setIBVB($Tf[0]+$Tt,$Tf[1]+$TM,$Tf[2],$Tf[3],$Tf[4],$Tf[5],$Tf[6],$Tf[7])},this._fillTrangles=function($Tt,$TM,$Tf){this.ctx.fillTrangles($Tf[0],$Tf[1]+$Tt,$Tf[2]+$TM,$Tf[3],$Tf[4])},this._drawPath=function($Tt,$TM,$Tf){var $Tc=this.ctx;$Ts.isWebGL&&$Tc.setPathId(-1),$Tc.beginPath(),$Tt+=$Tf[0],$TM+=$Tf[1],$Ts.isWebGL&&$Tc.movePath($Tt,$TM);for(var $TD=$Tf[2],$To=0,$TJ=$TD.length;$To<$TJ;$To++){var $TZ=$TD[$To];switch($TZ[0]){case"moveTo":$Ts.isWebGL?$Tc.moveTo($TZ[1],$TZ[2]):$Tc.moveTo($Tt+$TZ[1],$TM+$TZ[2]);break;case"lineTo":$Ts.isWebGL?$Tc.lineTo($TZ[1],$TZ[2]):$Tc.lineTo($Tt+$TZ[1],$TM+$TZ[2]);break;case"arcTo":$Ts.isWebGL?$Tc.arcTo($TZ[1],$TZ[2],$TZ[3],$TZ[4],$TZ[5]):$Tc.arcTo($Tt+$TZ[1],$TM+$TZ[2],$Tt+$TZ[3],$TM+$TZ[4],$TZ[5]);break;case"closePath":$Tc.closePath()}}var $TA=$Tf[3];null!=$TA&&($Tc.fillStyle=$TA.fillStyle,$Tc.fill());var $TL=$Tf[4];null!=$TL&&($Tc.strokeStyle=$TL.strokeStyle,$Tc.lineWidth=$TL.lineWidth||1,$Tc.lineJoin=$TL.lineJoin,$Tc.lineCap=$TL.lineCap,$Tc.miterLimit=$TL.miterLimit,$Tc.stroke())},this.drawPoly=function($Tt,$TM,$Tf){this.ctx.drawPoly($Tt+this.x+$Tf[0],$TM+this.y+$Tf[1],$Tf[2],$Tf[3],$Tf[4],$Tf[5],$Tf[6])},this._drawPoly=function($Tt,$TM,$Tf){var $Tc=this.ctx,$TD=$Tf[2],$To=2,$TJ=$TD.length;if($Ts.isWebGL)for($Tc.setPathId($Tf[6]),$Tc.beginPath(),$Tt+=$Tf[0],$TM+=$Tf[1],$Tc.movePath($Tt,$TM),$Tc.moveTo($TD[0],$TD[1]);$To<$TJ;)$Tc.lineTo($TD[$To++],$TD[$To++]);else for($Tc.beginPath(),$Tt+=$Tf[0],$TM+=$Tf[1],$Tc.moveTo($Tt+$TD[0],$TM+$TD[1]);$To<$TJ;)$Tc.lineTo($Tt+$TD[$To++],$TM+$TD[$To++]);$Tc.closePath(),this._fillAndStroke($Tf[3],$Tf[4],$Tf[5],$Tf[7])},this._drawSkin=function($Tt,$TM,$Tf){var $Tc=$Tf[0];if($Tc){var $TD=this.ctx;$Tc.render($TD,$Tt,$TM)}},this._drawParticle=function($Tt,$TM,$Tf){this.ctx.drawParticle($Tt+this.x,$TM+this.y,$Tf[0])},this._setFilters=function($Tt,$TM,$Tf){this.ctx.setFilters($Tf)},$Tf?this.ctx=$Tf.getContext("2d"):($Tf=$TNt.create("3D"),this.ctx=$TU.createWebGLContext2D($Tf),$Tf._setContext(this.ctx)),$Tf.size($Tt,$TM),this.canvas=$Tf}$Tp($TJ,"laya.renders.RenderContext");var $Tt=$TJ.prototype;return $Tt.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$Tt.drawTexture=function($Tt,$TM,$Tf,$Tc,$TD){$Tt.loaded&&this.ctx.drawTexture($Tt,$TM,$Tf,$Tc,$TD,this.x,this.y)},$Tt._drawTextures=function($Tt,$TM,$Tf){$Tf[0].loaded&&this.ctx.drawTextures($Tf[0],$Tf[1],$Tt+this.x,$TM+this.y)},$Tt.drawTextureWithTransform=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tt.loaded&&this.ctx.drawTextureWithTransform($Tt,$TM,$Tf,$Tc,$TD,$To,this.x,this.y,$TJ)},$Tt.fillQuadrangle=function($Tt,$TM,$Tf,$Tc,$TD){this.ctx.fillQuadrangle($Tt,$TM,$Tf,$Tc,$TD)},$Tt.drawCanvas=function($Tt,$TM,$Tf,$Tc,$TD){this.ctx.drawCanvas($Tt,$TM+this.x,$Tf+this.y,$Tc,$TD)},$Tt.drawRect=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=1);var $TJ=this.ctx;$TJ.strokeStyle=$TD,$TJ.lineWidth=$To,$TJ.strokeRect($Tt+this.x,$TM+this.y,$Tf,$Tc,$To)},$Tt._fillAndStroke=function($Tt,$TM,$Tf,$Tc){void 0===$Tc&&($Tc=!1);var $TD=this.ctx;null!=$Tt&&($TD.fillStyle=$Tt,$Ts.isWebGL?$TD.fill($Tc):$TD.fill()),null!=$TM&&0<$Tf&&($TD.strokeStyle=$TM,$TD.lineWidth=$Tf,$TD.stroke())},$Tt.clipRect=function($Tt,$TM,$Tf,$Tc){this.ctx.clipRect($Tt+this.x,$TM+this.y,$Tf,$Tc)},$Tt.fillRect=function($Tt,$TM,$Tf,$Tc,$TD){this.ctx.fillRect($Tt+this.x,$TM+this.y,$Tf,$Tc,$TD)},$Tt.drawCircle=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=1),$Tz.drawCall++;var $To=this.ctx;$To.beginPath(),$To.strokeStyle=$Tc,$To.lineWidth=$TD,$To.arc($Tt+this.x,$TM+this.y,$Tf,0,$TJ.PI2),$To.stroke()},$Tt.drawTriangles=function($Tt,$TM,$Tf){if($Ts.isWebGL)this.ctx.drawTriangles($Tf[0],$Tt+$Tf[1],$TM+$Tf[2],$Tf[3],$Tf[4],$Tf[5],$Tf[6],$Tf[7],$Tf[8],$Tf[9]);else{var $Tc=$Tf[5],$TD=0,$To=$Tc.length,$TJ=this.ctx;for($TD=0;$TD<$To;$TD+=3){var $TZ=2*$Tc[$TD],$TA=2*$Tc[$TD+1],$TL=2*$Tc[$TD+2];$TJ.drawTriangle($Tf[0],$Tf[3],$Tf[4],$TZ,$TA,$TL,$Tf[6],!0)}}},$Tt.fillCircle=function($Tt,$TM,$Tf,$Tc){$Tz.drawCall++;var $TD=this.ctx;$TD.beginPath(),$TD.fillStyle=$Tc,$TD.arc($Tt+this.x,$TM+this.y,$Tf,0,$TJ.PI2),$TD.fill()},$Tt.setShader=function($Tt){this.ctx.setShader($Tt)},$Tt.drawLine=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=1);var $TJ=this.ctx;$TJ.beginPath(),$TJ.strokeStyle=$TD,$TJ.lineWidth=$To,$TJ.moveTo(this.x+$Tt,this.y+$TM),$TJ.lineTo(this.x+$Tf,this.y+$Tc),$TJ.stroke()},$Tt.clear=function(){this.ctx.clear()},$Tt.transformByMatrix=function($Tt){this.ctx.transformByMatrix($Tt)},$Tt.setTransform=function($Tt,$TM,$Tf,$Tc,$TD,$To){this.ctx.setTransform($Tt,$TM,$Tf,$Tc,$TD,$To)},$Tt.setTransformByMatrix=function($Tt){this.ctx.setTransformByMatrix($Tt)},$Tt.save=function(){this.ctx.save()},$Tt.restore=function(){this.ctx.restore()},$Tt.translate=function($Tt,$TM){this.ctx.translate($Tt,$TM)},$Tt.transform=function($Tt,$TM,$Tf,$Tc,$TD,$To){this.ctx.transform($Tt,$TM,$Tf,$Tc,$TD,$To)},$Tt.rotate=function($Tt){this.ctx.rotate($Tt)},$Tt.scale=function($Tt,$TM){this.ctx.scale($Tt,$TM)},$Tt.alpha=function($Tt){this.ctx.globalAlpha*=$Tt},$Tt.setAlpha=function($Tt){this.ctx.globalAlpha=$Tt},$Tt.fillWords=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$To&&($To=0),this.ctx.fillWords($Tt,$TM,$Tf,$Tc,$TD,$To)},$Tt.fillBorderWords=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this.ctx.fillBorderWords($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ)},$Tt.fillText=function($Tt,$TM,$Tf,$Tc,$TD,$To){this.ctx.fillText($Tt,$TM+this.x,$Tf+this.y,$Tc,$TD,$To)},$Tt.strokeText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this.ctx.strokeText($Tt,$TM+this.x,$Tf+this.y,$Tc,$TD,$To,$TJ)},$Tt.blendMode=function($Tt){this.ctx.globalCompositeOperation=$Tt},$Tt.flush=function(){this.ctx.flush&&this.ctx.flush()},$Tt.addRenderObject=function($Tt){this.ctx.addRenderObject($Tt)},$Tt.beginClip=function($Tt,$TM,$Tf,$Tc){this.ctx.beginClip&&this.ctx.beginClip($Tt,$TM,$Tf,$Tc)},$Tt.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$Tt.fillTrangles=function($Tt,$TM,$Tf){this.ctx.fillTrangles($Tf[0],$Tf[1],$Tf[2],$Tf[3],4<$Tf.length?$Tf[4]:null)},$TJ.PI2=2*Math.PI,$TJ}(),$Tu=function(){function $TJ($Tt,$TM){switch(this._next=$TM||$TJ.NORENDER,$Tt){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$TE._filter);case 69905:return void(this._fun=$TJ._initRenderFun)}this.onCreate($Tt)}$Tp($TJ,"laya.renders.RenderSprite");var $Tt=$TJ.prototype;return $Tt.onCreate=function($Tt){},$Tt._style=function($Tt,$TM,$Tf,$Tc){$Tt._style.render($Tt,$TM,$Tf,$Tc);var $TD=this._next;$TD._fun.call($TD,$Tt,$TM,$Tf,$Tc)},$Tt._no=function($Tt,$TM,$Tf,$Tc){},$Tt._custom=function($Tt,$TM,$Tf,$Tc){$Tt.customRender($TM,$Tf,$Tc);var $TD=$Tt._style._tf;this._next._fun.call(this._next,$Tt,$TM,$Tf-$TD.translateX,$Tc-$TD.translateY)},$Tt._clip=function($Tt,$TM,$Tf,$Tc){var $TD=this._next;if($TD!=$TJ.NORENDER){var $To=$Tt._style.scrollRect;$TM.ctx.save(),$TM.ctx.clipRect($Tf,$Tc,$To.width,$To.height),$TD._fun.call($TD,$Tt,$TM,$Tf-$To.x,$Tc-$To.y),$TM.ctx.restore()}},$Tt._blend=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style;$TD.blendMode&&($TM.ctx.globalCompositeOperation=$TD.blendMode);var $To=this._next;$To._fun.call($To,$Tt,$TM,$Tf,$Tc),$TM.ctx.globalCompositeOperation="source-over"},$Tt._mask=function($Tt,$TM,$Tf,$Tc){var $TD=this._next;$TD._fun.call($TD,$Tt,$TM,$Tf,$Tc);var $To=$Tt.mask;$To&&($TM.ctx.globalCompositeOperation="destination-in",(0<$To.numChildren||!$To.graphics._isOnlyOne())&&($To.cacheAsBitmap=!0),$To.render($TM,$Tf-$Tt.pivotX,$Tc-$Tt.pivotY)),$TM.ctx.globalCompositeOperation="source-over"},$Tt._graphics=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style._tf;$Tt._graphics&&$Tt._graphics._render($Tt,$TM,$Tf-$TD.translateX,$Tc-$TD.translateY);var $To=this._next;$To._fun.call($To,$Tt,$TM,$Tf,$Tc)},$Tt._image=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style;$TM.ctx.drawTexture2($Tf,$Tc,$TD._tf.translateX,$TD._tf.translateY,$Tt.transform,$TD.alpha,$TD.blendMode,$Tt._graphics._one)},$Tt._image2=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style._tf;$TM.ctx.drawTexture2($Tf,$Tc,$TD.translateX,$TD.translateY,$Tt.transform,1,null,$Tt._graphics._one)},$Tt._alpha=function($Tt,$TM,$Tf,$Tc){var $TD;if(.01<($TD=$Tt._style.alpha)||$Tt._needRepaint()){var $To=$TM.ctx.globalAlpha;$TM.ctx.globalAlpha*=$TD;var $TJ=this._next;$TJ._fun.call($TJ,$Tt,$TM,$Tf,$Tc),$TM.ctx.globalAlpha=$To}},$Tt._transform=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.transform,$To=this._next;$TD&&$To!=$TJ.NORENDER?($TM.save(),$TM.transform($TD.a,$TD.b,$TD.c,$TD.d,$TD.tx+$Tf,$TD.ty+$Tc),$To._fun.call($To,$Tt,$TM,0,0),$TM.restore()):$To._fun.call($To,$Tt,$TM,$Tf,$Tc)},$Tt._childs=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style,$To=$TD._tf;if($Tf=$Tf-$To.translateX+$TD.paddingLeft,$Tc=$Tc-$To.translateY+$TD.paddingTop,$TD._calculation){var $TJ=$Tt._getWords();if($TJ){var $TZ=$TD;$TZ&&($TZ.stroke?$TM.fillBorderWords($TJ,$Tf,$Tc,$TZ.font,$TZ.color,$TZ.strokeColor,$TZ.stroke):$TM.fillWords($TJ,$Tf,$Tc,$TZ.font,$TZ.color,"none"!=$TZ.textDecoration&&$TZ.underLine?1:0))}}var $TA,$TL=$Tt._childs,$Tp=$TL.length;if($Tt.viewport||$Tt.optimizeScrollRect&&$Tt._style.scrollRect){var $TB=$Tt.viewport||$Tt._style.scrollRect,$Tb=$TB.x,$TI=$TB.y,$Tq=$TB.right,$Tl=$TB.bottom,$T_=NaN,$TE=NaN;for($Te=0;$Te<$Tp;++$Te)($TA=$TL[$Te]).visible&&($T_=$TA._x)<$Tq&&$T_+$TA.width>$Tb&&($TE=$TA._y)<$Tl&&$TE+$TA.height>$TI&&$TA.render($TM,$Tf,$Tc)}else for(var $Te=0;$Te<$Tp;++$Te)($TA=$TL[$Te])._style.visible&&$TA.render($TM,$Tf,$Tc)},$Tt._canvas=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._$P.cacheCanvas;if($TD){"bitmap"===$TD.type?$Tz.canvasBitmap++:$Tz.canvasNormal++;var $To=$TD.ctx;if($Tt._needRepaint()||!$To)this._canvas_repaint($Tt,$TM,$Tf,$Tc);else{var $TJ=$TD._cacheRec;$TM.drawCanvas($To.canvas,$Tf+$TJ.x,$Tc+$TJ.y,$TJ.width,$TJ.height)}}else this._next._fun.call(this._next,$Tt,$TM,$Tf,$Tc)},$Tt._canvas_repaint=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._$P.cacheCanvas,$To=this._next;if($TD){var $TJ,$TZ,$TA,$TL,$Tp=$TD.ctx,$TB=$Tt._needRepaint()||!$Tp,$Tb=$TD.type;if("bitmap"===$Tb?$Tz.canvasBitmap++:$Tz.canvasNormal++,$TB){var $TI,$Tq;$TD._cacheRec||($TD._cacheRec=new $TV),$Ts.isWebGL&&"bitmap"!==$Tb?$TD._cacheRec.setTo(-$Tt.pivotX,-$Tt.pivotY,1,1):(($TL=$Tt.getSelfBounds()).x=$TL.x-$Tt.pivotX,$TL.y=$TL.y-$Tt.pivotY,$TL.x=$TL.x-16,$TL.y=$TL.y-16,$TL.width=$TL.width+32,$TL.height=$TL.height+32,$TL.x=Math.floor($TL.x+$Tf)-$Tf,$TL.y=Math.floor($TL.y+$Tc)-$Tc,$TL.width=Math.floor($TL.width),$TL.height=Math.floor($TL.height),$TD._cacheRec.copyFrom($TL)),$TL=$TD._cacheRec;var $Tl,$T_=$Ts.isWebGL?1:$TK.pixelRatio*$TT.stage.clientScaleX,$TE=$Ts.isWebGL?1:$TK.pixelRatio*$TT.stage.clientScaleY;if(!$Ts.isWebGL){var $Te,$TN=1,$TX=1;for($Te=$Tt;$Te&&$Te!=$TT.stage;)$TN*=$Te.scaleX,$TX*=$Te.scaleY,$Te=$Te.parent;$Ts.isWebGL?($TN<1&&($T_*=$TN),$TX<1&&($TE*=$TX)):(1<$TN&&($T_*=$TN),1<$TX&&($TE*=$TX))}if($Tt.scrollRect){var $Ty=$Tt.scrollRect;$TL.x-=$Ty.x,$TL.y-=$Ty.y}if($TI=$TL.width*$T_,$Tq=$TL.height*$TE,$TZ=$TL.x,$TA=$TL.y,$Ts.isWebGL&&"bitmap"===$Tb&&(2048<$TI||2048<$Tq))return console.warn("cache bitmap size larger than 2048,cache ignored"),$TD.ctx&&($Tg.recover("RenderContext",$TD.ctx),$TD.ctx.canvas.size(0,0),$TD.ctx=null),void $To._fun.call($To,$Tt,$TM,$Tf,$Tc);if($Tp||($Tp=$TD.ctx=$Tg.getItem("RenderContext")||new $Tr($TI,$Tq,$TNt.create("AUTO"))),$Tp.ctx.sprite=$Tt,($TJ=$Tp.canvas).clear(),($TJ.width!=$TI||$TJ.height!=$Tq)&&$TJ.size($TI,$Tq),"bitmap"===$Tb?$TJ.context.asBitmap=!0:"normal"===$Tb&&($TJ.context.asBitmap=!1),1!=$T_||1!=$TE){var $Th=$Tp.ctx;$Th.save(),$Th.scale($T_,$TE),!$Ts.isConchWebGL&&$Ts.isConchApp&&($Tl=$Tt._$P.cf)&&$Th.setFilterMatrix&&$Th.setFilterMatrix($Tl._mat,$Tl._alpha),$To._fun.call($To,$Tt,$Tp,-$TZ,-$TA),$Th.restore(),$Ts.isConchApp&&!$Ts.isConchWebGL||$Tt._applyFilters()}else $Th=$Tp.ctx,!$Ts.isConchWebGL&&$Ts.isConchApp&&($Tl=$Tt._$P.cf)&&$Th.setFilterMatrix&&$Th.setFilterMatrix($Tl._mat,$Tl._alpha),$To._fun.call($To,$Tt,$Tp,-$TZ,-$TA),$Ts.isConchApp&&!$Ts.isConchWebGL||$Tt._applyFilters();$Tt._$P.staticCache&&($TD.reCache=!1),$Tz.canvasReCache++}else $TZ=($TL=$TD._cacheRec).x,$TA=$TL.y,$TJ=$Tp.canvas;$TM.drawCanvas($TJ,$Tf+$TZ,$Tc+$TA,$TL.width,$TL.height)}else $To._fun.call($To,$Tt,$Tp,$Tf,$Tc)},$TJ.__init__=function(){var $Tt,$TM,$Tf=0;for($TM=$TU.createRenderSprite(69905,null),$Tt=$TJ.renders.length=4096,$Tf=0;$Tf<$Tt;$Tf++)$TJ.renders[$Tf]=$TM;$TJ.renders[0]=$TU.createRenderSprite(0,null),function($Tt,$TM){for(var $Tf=0,$Tc=0;$Tc<$Tt.length;$Tc++)$Tf|=$Tt[$Tc],$TJ.renders[$Tf]=$TM}([1,512,4,2],new $TJ(1,null)),$TJ.renders[513]=$TU.createRenderSprite(513,null),$TJ.renders[517]=new $TJ(517,null)},$TJ._initRenderFun=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._renderType;($TJ.renders[$TD]=$TJ._getTypeRender($TD))._fun($Tt,$TM,$Tf,$Tc)},$TJ._getTypeRender=function($Tt){for(var $TM=null,$Tf=2048;1<$Tf;)$Tf&$Tt&&($TM=$TU.createRenderSprite($Tf,$TM)),$Tf>>=1;return $TM},$TJ.IMAGE=1,$TJ.ALPHA=2,$TJ.TRANSFORM=4,$TJ.BLEND=8,$TJ.CANVAS=16,$TJ.FILTERS=32,$TJ.MASK=64,$TJ.CLIP=128,$TJ.STYLE=256,$TJ.GRAPHICS=512,$TJ.CUSTOM=1024,$TJ.CHILDS=2048,$TJ.INIT=69905,$TJ.renders=[],$TJ.NORENDER=new $TJ(0,null),$TJ}(),$Tv=function(){function $TZ(){this._repaint=!1}$Tp($TZ,"laya.resource.Context");var $Tt=$TZ.prototype;return $Tt.replaceReset=function(){var $Tt,$TM,$Tf=0;for($Tt=$TZ.replaceKeys.length,$Tf=0;$Tf<$Tt;$Tf++)$TM=$TZ.replaceKeys[$Tf],this[$TZ.newKeys[$Tf]]=this[$TM]},$Tt.replaceResotre=function(){this.__restore(),this.__reset()},$Tt.setIsMainContext=function(){},$Tt.drawTextures=function($Tt,$TM,$Tf,$Tc){$Tz.drawCall+=$TM.length/2;for(var $TD=$Tt.width,$To=$Tt.height,$TJ=0,$TZ=$TM.length;$TJ<$TZ;$TJ+=2)this.drawTexture($Tt,$TM[$TJ],$TM[$TJ+1],$TD,$To,$Tf,$Tc)},$Tt.drawCanvas=function($Tt,$TM,$Tf,$Tc,$TD){$Tz.drawCall++,this.drawImage($Tt.source,$TM,$Tf,$Tc,$TD)},$Tt.fillRect=function($Tt,$TM,$Tf,$Tc,$TD){$Tz.drawCall++,$TD&&(this.fillStyle=$TD),this.__fillRect($Tt,$TM,$Tf,$Tc)},$Tt.fillText=function($Tt,$TM,$Tf,$Tc,$TD,$To){$Tz.drawCall++,3<arguments.length&&null!=$Tc&&(this.font=$Tc,this.fillStyle=$TD,this.textAlign=$To,this.textBaseline="top"),this.__fillText($Tt,$TM,$Tf)},$Tt.fillBorderText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){$Tz.drawCall++,this.font=$Tc,this.fillStyle=$TD,this.textBaseline="top",this.strokeStyle=$To,this.lineWidth=$TJ,this.textAlign=$TZ,this.__strokeText($Tt,$TM,$Tf),this.__fillText($Tt,$TM,$Tf)},$Tt.strokeText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tz.drawCall++,3<arguments.length&&null!=$Tc&&(this.font=$Tc,this.strokeStyle=$TD,this.lineWidth=$To,this.textAlign=$TJ,this.textBaseline="top"),this.__strokeText($Tt,$TM,$Tf)},$Tt.transformByMatrix=function($Tt){this.transform($Tt.a,$Tt.b,$Tt.c,$Tt.d,$Tt.tx,$Tt.ty)},$Tt.setTransformByMatrix=function($Tt){this.setTransform($Tt.a,$Tt.b,$Tt.c,$Tt.d,$Tt.tx,$Tt.ty)},$Tt.clipRect=function($Tt,$TM,$Tf,$Tc){$Tz.drawCall++,this.beginPath(),this.rect($Tt,$TM,$Tf,$Tc),this.clip()},$Tt.drawTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tz.drawCall++;var $TZ=$Tt.uv,$TA=$Tt.bitmap.width,$TL=$Tt.bitmap.height;this.drawImage($Tt.source,$TZ[0]*$TA,$TZ[1]*$TL,($TZ[2]-$TZ[0])*$TA,($TZ[5]-$TZ[3])*$TL,$TM+$To,$Tf+$TJ,$Tc,$TD)},$Tt.drawTextureWithTransform=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){$Tz.drawCall++;var $TL=$Tt.uv,$Tp=$Tt.bitmap.width,$TB=$Tt.bitmap.height;this.save(),1!=$TA&&(this.globalAlpha*=$TA),$To?(this.transform($To.a,$To.b,$To.c,$To.d,$To.tx+$TJ,$To.ty+$TZ),this.drawImage($Tt.source,$TL[0]*$Tp,$TL[1]*$TB,($TL[2]-$TL[0])*$Tp,($TL[5]-$TL[3])*$TB,$TM,$Tf,$Tc,$TD)):this.drawImage($Tt.source,$TL[0]*$Tp,$TL[1]*$TB,($TL[2]-$TL[0])*$Tp,($TL[5]-$TL[3])*$TB,$TM+$TJ,$Tf+$TZ,$Tc,$TD),this.restore()},$Tt.drawTexture2=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=$TZ[0];if($TA.loaded&&$TA.bitmap&&$TA.source){$Tz.drawCall++;var $TL=1!==$To;if($TL){var $Tp=this.globalAlpha;this.globalAlpha*=$To}var $TB=$TA.uv,$Tb=$TA.bitmap.width,$TI=$TA.bitmap.height;$TD?(this.save(),this.transform($TD.a,$TD.b,$TD.c,$TD.d,$TD.tx+$Tt,$TD.ty+$TM),this.drawImage($TA.source,$TB[0]*$Tb,$TB[1]*$TI,($TB[2]-$TB[0])*$Tb,($TB[5]-$TB[3])*$TI,$TZ[1]-$Tf,$TZ[2]-$Tc,$TZ[3],$TZ[4]),this.restore()):this.drawImage($TA.source,$TB[0]*$Tb,$TB[1]*$TI,($TB[2]-$TB[0])*$Tb,($TB[5]-$TB[3])*$TI,$TZ[1]-$Tf+$Tt,$TZ[2]-$Tc+$TM,$TZ[3],$TZ[4]),$TL&&(this.globalAlpha=$Tp)}},$Tt.fillTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){if(!$TZ.pat){if($Tt.uv!=$Tpt.DEF_UV){var $TA=new $TNt("2D");$TA.getContext("2d"),$TA.size($Tt.width,$Tt.height),$TA.context.drawTexture($Tt,0,0,$Tt.width,$Tt.height,0,0),$Tt=new $Tpt($TA)}$TZ.pat=this.createPattern($Tt.bitmap.source,$To)}var $TL=$TM,$Tp=$Tf,$TB=0,$Tb=0;$TJ&&($TL+=$TJ.x%$Tt.width,$Tp+=$TJ.y%$Tt.height,$TB-=$TJ.x%$Tt.width,$Tb-=$TJ.y%$Tt.height),this.translate($TL,$Tp),this.fillRect($TB,$Tb,$Tc,$TD,$TZ.pat),this.translate(-$TL,-$Tp)},$Tt.drawTriangle=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=$Tt.bitmap,$TL=$TA.source,$Tp=$Tt.width,$TB=$Tt.height,$Tb=$TA.width,$TI=$TA.height,$Tq=$Tf[$Tc]*$Tb,$Tl=$Tf[$TD]*$Tb,$T_=$Tf[$To]*$Tb,$TE=$Tf[$Tc+1]*$TI,$Te=$Tf[$TD+1]*$TI,$TN=$Tf[$To+1]*$TI,$TX=$TM[$Tc],$Ty=$TM[$TD],$Th=$TM[$To],$TT=$TM[$Tc+1],$Ti=$TM[$TD+1],$TV=$TM[$To+1];if($TZ){var $Tx=($TX+$Ty+$Th)/3,$TO=($TT+$Ti+$TV)/3,$TC=$TX-$Tx,$TU=$TT-$TO,$TF=Math.sqrt($TC*$TC+$TU*$TU);$TX=$Tx+$TC/$TF*($TF+1),$TT=$TO+$TU/$TF*($TF+1),$TU=$Ti-$TO,$Ty=$Tx+($TC=$Ty-$Tx)/($TF=Math.sqrt($TC*$TC+$TU*$TU))*($TF+1),$Ti=$TO+$TU/$TF*($TF+1),$TU=$TV-$TO,$Th=$Tx+($TC=$Th-$Tx)/($TF=Math.sqrt($TC*$TC+$TU*$TU))*($TF+1),$TV=$TO+$TU/$TF*($TF+1)}this.save(),$TJ&&this.transform($TJ.a,$TJ.b,$TJ.c,$TJ.d,$TJ.tx,$TJ.ty),this.beginPath(),this.moveTo($TX,$TT),this.lineTo($Ty,$Ti),this.lineTo($Th,$TV),this.closePath(),this.clip();var $TS=1/($Tq*$Te+$TE*$T_+$Tl*$TN-$Te*$T_-$TE*$Tl-$Tq*$TN),$TH=$TX*$Te+$TE*$Th+$Ty*$TN-$Te*$Th-$TE*$Ty-$TX*$TN,$Ts=$Tq*$Ty+$TX*$T_+$Tl*$Th-$Ty*$T_-$TX*$Tl-$Tq*$Th,$Tr=$Tq*$Te*$Th+$TE*$Ty*$T_+$TX*$Tl*$TN-$TX*$Te*$T_-$TE*$Tl*$Th-$Tq*$Ty*$TN,$Tu=$TT*$Te+$TE*$TV+$Ti*$TN-$Te*$TV-$TE*$Ti-$TT*$TN,$Tv=$Tq*$Ti+$TT*$T_+$Tl*$TV-$Ti*$T_-$TT*$Tl-$Tq*$TV,$Tk=$Tq*$Te*$TV+$TE*$Ti*$T_+$TT*$Tl*$TN-$TT*$Te*$T_-$TE*$Tl*$TV-$Tq*$Ti*$TN;this.transform($TH*$TS,$Tu*$TS,$Ts*$TS,$Tv*$TS,$Tr*$TS,$Tk*$TS),this.drawImage($TL,$Tt.uv[0]*$Tb,$Tt.uv[1]*$TI,$Tp,$TB,$Tt.uv[0]*$Tb,$Tt.uv[1]*$TI,$Tp,$TB),this.restore()},$Tt.flush=function(){return 0},$Tt.fillWords=function($Tt,$TM,$Tf,$Tc,$TD,$To){$Tc&&(this.font=$Tc),$TD&&(this.fillStyle=$TD);this.textBaseline="top",this.textAlign="left";for(var $TJ=0,$TZ=$Tt.length;$TJ<$TZ;$TJ++){var $TA=$Tt[$TJ];if(this.__fillText($TA.char,$TA.x+$TM,$TA.y+$Tf),1===$To){var $TL=$TA.height,$Tp=.5*$TA.style.letterSpacing;$Tp||($Tp=0),this.beginPath(),this.strokeStyle=$TD,this.lineWidth=1,this.moveTo($TM+$TA.x-$Tp+.5,$Tf+$TA.y+$TL+.5),this.lineTo($TM+$TA.x+$TA.width+$Tp+.5,$Tf+$TA.y+$TL+.5),this.stroke()}}},$Tt.fillBorderWords=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tc&&(this.font=$Tc),$TD&&(this.fillStyle=$TD),this.textBaseline="top",this.lineWidth=$TJ,this.textAlign="left",this.strokeStyle=$To;for(var $TZ=0,$TA=$Tt.length;$TZ<$TA;$TZ++){var $TL=$Tt[$TZ];this.__strokeText($TL.char,$TL.x+$TM,$TL.y+$Tf),this.__fillText($TL.char,$TL.x+$TM,$TL.y+$Tf)}},$Tt.destroy=function(){this.canvas.width=this.canvas.height=0},$Tt.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$Tt.drawCurves=function($Tt,$TM,$Tf){this.beginPath(),this.strokeStyle=$Tf[3],this.lineWidth=$Tf[4];var $Tc=$Tf[2];$Tt+=$Tf[0],$TM+=$Tf[1],this.moveTo($Tt+$Tc[0],$TM+$Tc[1]);for(var $TD=2,$To=$Tc.length;$TD<$To;)this.quadraticCurveTo($Tt+$Tc[$TD++],$TM+$Tc[$TD++],$Tt+$Tc[$TD++],$TM+$Tc[$TD++]);this.stroke()},$TZ.__init__=function($TM){var $Tf=laya.resource.Context.prototype;if(!($TM=$TM||CanvasRenderingContext2D.prototype).inited){$TM.inited=!0,$TM.__fillText=$TM.fillText,$TM.__fillRect=$TM.fillRect,$TM.__strokeText=$TM.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($Tt){$TM[$Tt]=$Tf[$Tt]})}},$TZ.replaceCanvasGetSet=function($Tt,$TM){var $Tf=Object.getOwnPropertyDescriptor($Tt,$TM);if(!$Tf||!$Tf.configurable)return!1;var $Tc,$TD={};for($Tc in $Tf)"set"!=$Tc&&($TD[$Tc]=$Tf[$Tc]);var $To=$Tf.set;return $TD.set=function($Tt){$To.call(this,$Tt);var $TM=this.getContext("2d");$TM&&"__reset"in $TM&&$TM.__reset()},Object.defineProperty($Tt,$TM,$TD),!0},$TZ.replaceGetSet=function($Tt,$TM){var $Tf=Object.getOwnPropertyDescriptor($Tt,$TM);if(!$Tf||!$Tf.configurable)return!1;var $Tc,$TD={};for($Tc in $Tf)"set"!=$Tc&&($TD[$Tc]=$Tf[$Tc]);var $To=$Tf.set,$TJ="___"+$TM+"__";return $TZ.newKeys.push($TJ),$TD.set=function($Tt){$Tt!=this[$TJ]&&(this[$TJ]=$Tt,$To.call(this,$Tt))},Object.defineProperty($Tt,$TM,$TD),!0},$TZ._default=new $TZ,$TZ.newKeys=[],$TA($TZ,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$TZ}(),$Tk=function(){function $To($Tt){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$To._uniqueIDCounter,this._name=$Tt||"Content Manager",$To._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$To._resourceManagers.push(this),this._resources=[],this._records={}}$Tp($To,"laya.resource.ResourceManager");var $Tt=$To.prototype;return $TT.imps($Tt,{"laya.resource.IDispose":!0}),$Tt.getResourceByIndex=function($Tt){return this._resources[$Tt]},$Tt.getResourcesLength=function(){return this._resources.length},$Tt.addResource=function($Tt){return $Tt.resourceManager&&$Tt.resourceManager.removeResource($Tt),-1===this._resources.indexOf($Tt)&&(($Tt._resourceManager=this)._resources.push($Tt),this.addRecord($Tt.uri,$Tt.__className,$Tt.memorySize),this.addSize($Tt.memorySize),!0)},$Tt.removeResource=function($Tt){var $TM=this._resources.indexOf($Tt);return-1!==$TM&&(this._resources.splice($TM,1),$Tt._resourceManager=null,this._memorySize-=$Tt.memorySize,this.addRecord($Tt.uri,$Tt.__className,-$Tt.memorySize),!0)},$Tt.unload=function(){for(var $Tt=this._resources.slice(0,this._resources.length),$TM=0;$TM<$Tt.length;$TM++){$Tt[$TM].destroy()}$Tt.length=0},$Tt.dispose=function(){if(this===$To._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$To._resourceManagers.splice($To._resourceManagers.indexOf(this),1),$To._isResourceManagersSorted=!1;for(var $Tt=this._resources.slice(0,this._resources.length),$TM=0;$TM<$Tt.length;$TM++){var $Tf=$Tt[$TM];$Tf.resourceManager.removeResource($Tf),$Tf.destroy()}$Tt.length=0},$Tt.addSize=function($Tt){$Tt&&(this.autoRelease&&0<$Tt&&this._memorySize+$Tt>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$Tt)},$Tt.addRecord=function($Tt,$TM,$Tf){DEBUG&&$Tf&&!$Tt&&console.error($Tt,$TM,$Tf)},$Tt.garbageCollection=function($Tt){var $TM=this._resources;($TM=$TM.slice()).sort(function($Tt,$TM){if(!$Tt||!$TM)throw new Error("a或b不能为空！");return $Tt.released&&$TM.released?0:$Tt.released?1:$TM.released?-1:$Tt._lastUseFrameCount-$TM._lastUseFrameCount});for(var $Tf=$Tz.loopCount,$Tc=0,$TD=$TM.length;$Tc<$TD;$Tc++){var $To=$TM[$Tc];if(!(1<$Tf-$To._lastUseFrameCount))return void(this._memorySize>=$Tt&&(this._isOverflow=!0));if($To.releaseResource(),this._memorySize<$Tt)return void(this._isOverflow=!1)}},$Tq(0,$Tt,"id",function(){return this._id}),$Tq(0,$Tt,"name",function(){return this._name},function($Tt){!$Tt&&""===$Tt||this._name===$Tt||(this._name=$Tt,$To._isResourceManagersSorted=!1)}),$Tq(0,$Tt,"memorySize",function(){return this._memorySize}),$Tq(0,$Tt,"records",function(){return this._records}),$Tq(1,$To,"systemResourceManager",function(){return $To._systemResourceManager}),$To.__init__=function(){$To.currentResourceManager=$To.systemResourceManager},$To.getLoadedResourceManagerByIndex=function($Tt){return $To._resourceManagers[$Tt]},$To.getLoadedResourceManagersCount=function(){return $To._resourceManagers.length},$To.recreateContentManagers=function($Tt){void 0===$Tt&&($Tt=!1);for(var $TM=$To.currentResourceManager,$Tf=0;$Tf<$To._resourceManagers.length;$Tf++){$To.currentResourceManager=$To._resourceManagers[$Tf];for(var $Tc=0;$Tc<$To.currentResourceManager._resources.length;$Tc++)$To.currentResourceManager._resources[$Tc].releaseResource($Tt),$To.currentResourceManager._resources[$Tc].activeResource($Tt)}$To.currentResourceManager=$TM},$To.releaseContentManagers=function($Tt){void 0===$Tt&&($Tt=!1);for(var $TM=$To.currentResourceManager,$Tf=0;$Tf<$To._resourceManagers.length;$Tf++){$To.currentResourceManager=$To._resourceManagers[$Tf];for(var $Tc=0;$Tc<$To.currentResourceManager._resources.length;$Tc++){var $TD=$To.currentResourceManager._resources[$Tc];!$TD.released&&$TD.releaseResource($Tt)}}$To.currentResourceManager=$TM},$To._uniqueIDCounter=0,$To._isResourceManagersSorted=!1,$To._resourceManagers=[],$TA($To,["_systemResourceManager",function(){return this._systemResourceManager=new $To("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$To._systemResourceManager}]),$To}(),$TK=(function(){function $Tt(){}$Tp($Tt,"laya.system.System"),$Tt.changeDefinition=function($Tt,$TM){$TT[$Tt]=$TM;var $Tf=$Tt+"=classObj";$TT._runScript($Tf)},$Tt.__init__=function(){$Ts.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $Tf(){}return $Tp($Tf,"laya.utils.Browser"),$Tq(1,$Tf,"pixelRatio",function(){return $Tf.__init__(),-1<$Tf.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$TU.getPixelRatio()}),$Tq(1,$Tf,"height",function(){return $Tf.__init__(),($TT.stage&&$TT.stage.canvasRotation?$Tf.clientWidth:$Tf.clientHeight)*$Tf.pixelRatio}),$Tq(1,$Tf,"clientWidth",function(){return $Tf.__init__(),$Tf.window.innerWidth||$Tf.document.body.clientWidth}),$Tq(1,$Tf,"window",function(){return $Tf.__init__(),$Tf._window}),$Tq(1,$Tf,"clientHeight",function(){return $Tf.__init__(),$Tf.window.innerHeight||$Tf.document.body.clientHeight||$Tf.document.documentElement.clientHeight}),$Tq(1,$Tf,"width",function(){return $Tf.__init__(),($TT.stage&&$TT.stage.canvasRotation?$Tf.clientHeight:$Tf.clientWidth)*$Tf.pixelRatio}),$Tq(1,$Tf,"container",function(){return $Tf.__init__(),$Tf._container||(($Tf._container=$Tf.createElement("div")).id="layaContainer",$Tf.document.body.appendChild($Tf._container)),$Tf._container},function($Tt){$Tf._container=$Tt}),$Tq(1,$Tf,"document",function(){return $Tf.__init__(),$Tf._document}),$Tf.__init__=function(){if(!$Tf._window){$Tf._window=$TU.getWindow(),$Tf._document=$Tf.window.document,$Tf._window.addEventListener("message",function($Tt){laya.utils.Browser._onMessage($Tt)},!1),$Tf.document.__createElement=$Tf.document.createElement,$TJ.requestAnimationFrame=$TJ.requestAnimationFrame||$TJ.webkitRequestAnimationFrame||$TJ.mozRequestAnimationFrame||$TJ.oRequestAnimationFrame||$TJ.msRequestAnimationFrame||function($Tt){return $TJ.setTimeout($Tt,1e3/60)};var $Tt=$TJ.document.body.style;$Tt["-webkit-user-select"]="none",$Tt["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$Tf.userAgent=$Tf.window.navigator.userAgent,$Tf.onIOS=!!($Tf.u=$Tf.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$Tf.onMobile=-1<$Tf.u.indexOf("Mobile"),$Tf.onIPhone=-1<$Tf.u.indexOf("iPhone"),$Tf.onMac=-1<$Tf.u.indexOf("Mac OS X"),$Tf.onIPad=-1<$Tf.u.indexOf("iPad"),$Tf.onAndroid=-1<$Tf.u.indexOf("Android")||-1<$Tf.u.indexOf("Adr"),$Tf.onWP=-1<$Tf.u.indexOf("Windows Phone"),$Tf.onQQBrowser=-1<$Tf.u.indexOf("QQBrowser"),$Tf.onMQQBrowser=-1<$Tf.u.indexOf("MQQBrowser")||-1<$Tf.u.indexOf("Mobile")&&-1<$Tf.u.indexOf("QQ"),$Tf.onIE=!!$Tf.window.ActiveXObject||"ActiveXObject"in $Tf.window,$Tf.onWeiXin=-1<$Tf.u.indexOf("MicroMessenger"),$Tf.onPC=!$Tf.onMobile,$Tf.onSafari=-1<$Tf.u.indexOf("Safari"),$Tf.onFirefox=-1<$Tf.u.indexOf("Firefox"),$Tf.onEdge=-1<$Tf.u.indexOf("Edge"),$Tf.onMiniGame=-1<$Tf.u.indexOf("MiniGame"),$Tf.onLimixiu=-1<$Tf.u.indexOf("limixiu"),$Tf.httpProtocol="http:"==$Tf.window.location.protocol,$Tf.onMiniGame&&null==$Tf.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$Tf.webAudioEnabled=!!($Tf.window.AudioContext||$Tf.window.webkitAudioContext||$Tf.window.mozAudioContext),$Tf.soundType=$Tf.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$TDt=$Tf.webAudioEnabled?$Tot:$Tft,$Tf.webAudioEnabled&&$Tot.initWebAudio(),$Tft._initMusicAudio(),$Tf.enableTouch="ontouchstart"in $TJ||$TJ.DocumentTouch&&$TM instanceof DocumentTouch,$TJ.focus(),$TC._soundClass=$TDt,$TC._musicClass=$Tft,$Ts._mainCanvas=$Ts._mainCanvas||$TNt.create("2D"),$Tf.canvas||($Tf.canvas=$TNt.create("2D"),$Tf.context=$Tf.canvas.getContext("2d"))}},$Tf._onMessage=function($Tt){if($Tt.data&&"size"==$Tt.data.name){if($Tf.window.innerWidth=$Tt.data.width,$Tf.window.innerHeight=$Tt.data.height,$Tf.window.__innerHeight=$Tt.data.clientHeight,!$Tf.document.createEvent)return void console.warn("no document.createEvent");var $TM=$Tf.document.createEvent("HTMLEvents");return $TM.initEvent("resize",!1,!1),void $Tf.window.dispatchEvent($TM)}},$Tf.createElement=function($Tt){return $Tf.__init__(),$Tf.document.__createElement($Tt)},$Tf.getElementById=function($Tt){return $Tf.__init__(),$Tf.document.getElementById($Tt)},$Tf.removeElement=function($Tt){$Tt&&$Tt.parentNode&&$Tt.parentNode.removeChild($Tt)},$Tf.now=function(){return $TU.now()},$Tf._window=null,$Tf._document=null,$Tf._container=null,$Tf.userAgent=null,$Tf.u=null,$Tf.onIOS=!1,$Tf.onMac=!1,$Tf.onMobile=!1,$Tf.onIPhone=!1,$Tf.onIPad=!1,$Tf.onAndroid=!1,$Tf.onWP=!1,$Tf.onQQBrowser=!1,$Tf.onMQQBrowser=!1,$Tf.onSafari=!1,$Tf.onFirefox=!1,$Tf.onEdge=!1,$Tf.onIE=!1,$Tf.onWeiXin=!1,$Tf.onMiniGame=!1,$Tf.onLimixiu=!1,$Tf.onPC=!1,$Tf.httpProtocol=!1,$Tf.webAudioEnabled=!1,$Tf.soundType=null,$Tf.enableTouch=!1,$Tf.canvas=null,$Tf.context=null,$Tf.__init$=function(){},$Tf}()),$Tj=function(){function $TM($Tt){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$Tt?(this._u8d_=new Uint8Array($Tt),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$Tp($TM,"laya.utils.Byte");var $Tt=$TM.prototype;return $Tt.___resizeBuffer=function($TM){try{var $Tt=new Uint8Array($TM);null!=this._u8d_&&(this._u8d_.length<=$TM?$Tt.set(this._u8d_):$Tt.set(this._u8d_.subarray(0,$TM))),this._u8d_=$Tt,this._d_=new DataView($Tt.buffer)}catch($Tt){throw"___resizeBuffer err:"+$TM}},$Tt.getString=function(){return this.rUTF(this.getUint16())},$Tt.getFloat32Array=function($Tt,$TM){var $Tf=$Tt+$TM;$Tf=$Tf>this._length?this._length:$Tf;var $Tc=new Float32Array(this._d_.buffer.slice($Tt,$Tf));return this._pos_=$Tf,$Tc},$Tt.getUint8Array=function($Tt,$TM){var $Tf=$Tt+$TM;$Tf=$Tf>this._length?this._length:$Tf;var $Tc=new Uint8Array(this._d_.buffer.slice($Tt,$Tf));return this._pos_=$Tf,$Tc},$Tt.getInt16Array=function($Tt,$TM){var $Tf=$Tt+$TM;$Tf=$Tf>this._length?this._length:$Tf;var $Tc=new Int16Array(this._d_.buffer.slice($Tt,$Tf));return this._pos_=$Tf,$Tc},$Tt.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $Tt=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$Tt},$Tt.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $Tt=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$Tt},$Tt.writeFloat32=function($Tt){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$Tt,this._xd_),this._pos_+=4},$Tt.writeFloat64=function($Tt){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$Tt,this._xd_),this._pos_+=8},$Tt.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $Tt=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$Tt},$Tt.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $Tt=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$Tt},$Tt.writeInt32=function($Tt){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$Tt,this._xd_),this._pos_+=4},$Tt.writeUint32=function($Tt){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$Tt,this._xd_),this._pos_+=4},$Tt.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $Tt=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$Tt},$Tt.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $Tt=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$Tt},$Tt.writeUint16=function($Tt){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$Tt,this._xd_),this._pos_+=2},$Tt.writeInt16=function($Tt){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$Tt,this._xd_),this._pos_+=2},$Tt.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$Tt.writeUint8=function($Tt){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$Tt),this._pos_++},$Tt._getUInt8=function($Tt){return this._d_.getUint8($Tt)},$Tt._getUint16=function($Tt){return this._d_.getUint16($Tt,this._xd_)},$Tt._getMatrix=function(){return new $TF(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$Tt.rUTF=function($Tt){for(var $TM=[],$Tf=this._pos_+$Tt,$Tc=0,$TD=0,$To=0,$TJ=String.fromCharCode,$TZ=this._u8d_;this._pos_<$Tf;)($Tc=$TZ[this._pos_++])<128?0!=$Tc&&$TM.push($TJ($Tc)):$Tc<224?$TM.push($TJ((63&$Tc)<<6|127&$TZ[this._pos_++])):$Tc<240?($TD=$TZ[this._pos_++],$TM.push($TJ((31&$Tc)<<12|(127&$TD)<<6|127&$TZ[this._pos_++]))):($TD=$TZ[this._pos_++],$To=$TZ[this._pos_++],$TM.push($TJ((15&$Tc)<<18|(127&$TD)<<12|$To<<6&127|127&$TZ[this._pos_++]))),0;return $TM.join("")},$Tt.getCustomString=function($Tt){for(var $TM=[],$Tf=0,$Tc=0,$TD=0,$To=String.fromCharCode,$TJ=this._u8d_;0<$Tt;)if(($Tc=$TJ[this._pos_])<128)$TM.push($To($Tc)),this._pos_++,$Tt--;else for($Tf=$Tc-128,this._pos_++,$Tt-=$Tf;0<$Tf;)$Tc=$TJ[this._pos_++],$TD=$TJ[this._pos_++],$TM.push($To($TD<<8|$Tc)),$Tf--;return $TM.join("")},$Tt.clear=function(){this._pos_=0,this.length=0},$Tt.__getBuffer=function(){return this._d_.buffer},$Tt.writeUTFBytes=function($Tt){for(var $TM=0,$Tf=($Tt+="").length;$TM<$Tf;$TM++){var $Tc=$Tt.charCodeAt($TM);$Tc<=127?this.writeByte($Tc):$Tc<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$Tc>>6,128|63&$Tc],this._pos_),this._pos_+=2):$Tc<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$Tc>>12,128|$Tc>>6&63,128|63&$Tc],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$Tc>>18,128|$Tc>>12&63,128|$Tc>>6&63,128|63&$Tc],this._pos_),this._pos_+=4)}},$Tt.writeUTFString=function($Tt){var $TM=this.pos;this.writeUint16(1),this.writeUTFBytes($Tt);var $Tf=this.pos-$TM-2;if(65536<=$Tf)throw"writeUTFString byte len more than 65536";this._d_.setUint16($TM,$Tf,this._xd_)},$Tt.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$Tt.getUTFString=function(){return this.readUTFString()},$Tt.readUTFBytes=function($Tt){if(void 0===$Tt&&($Tt=-1),0==$Tt)return"";var $TM=this.bytesAvailable;if($TM<$Tt)throw"readUTFBytes error - Out of bounds";return $Tt=0<$Tt?$Tt:$TM,this.rUTF($Tt)},$Tt.getUTFBytes=function($Tt){return void 0===$Tt&&($Tt=-1),this.readUTFBytes($Tt)},$Tt.writeByte=function($Tt){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$Tt),this._pos_+=1},$Tt.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$Tt.getByte=function(){return this.readByte()},$Tt.ensureWrite=function($Tt){this._length<$Tt&&(this._length=$Tt),this._allocated_<$Tt&&(this.length=$Tt)},$Tt.writeArrayBuffer=function($Tt,$TM,$Tf){if(void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),$TM<0||$Tf<0)throw"writeArrayBuffer error - Out of bounds";0==$Tf&&($Tf=$Tt.byteLength-$TM),this.ensureWrite(this._pos_+$Tf);var $Tc=new Uint8Array($Tt);this._u8d_.set($Tc.subarray($TM,$TM+$Tf),this._pos_),this._pos_+=$Tf},$Tq(0,$Tt,"buffer",function(){var $Tt=this._d_.buffer;return $Tt.byteLength==this.length?$Tt:$Tt.slice(0,this.length)}),$Tq(0,$Tt,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($Tt){this._xd_="littleEndian"==$Tt}),$Tq(0,$Tt,"length",function(){return this._length},function($Tt){this._allocated_<$Tt?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($Tt,2*this._allocated_))):this._allocated_>$Tt&&this.___resizeBuffer(this._allocated_=$Tt),this._length=$Tt}),$Tq(0,$Tt,"pos",function(){return this._pos_},function($Tt){this._pos_=$Tt}),$Tq(0,$Tt,"bytesAvailable",function(){return this._length-this._pos_}),$TM.getSystemEndian=function(){if(!$TM._sysEndian){var $Tt=new ArrayBuffer(2);new DataView($Tt).setInt16(0,256,!0),$TM._sysEndian=256===new Int16Array($Tt)[0]?"littleEndian":"bigEndian"}return $TM._sysEndian},$TM.BIG_ENDIAN="bigEndian",$TM.LITTLE_ENDIAN="littleEndian",$TM._sysEndian=null,$TM}(),$Td=function(){function $TD(){}return $Tp($TD,"laya.utils.CacheManager"),$TD.regCacheByFunction=function($Tt,$TM){var $Tf;$TD.unRegCacheByFunction($Tt,$TM),$Tf={tryDispose:$Tt,getCacheList:$TM},$TD._cacheList.push($Tf)},$TD.unRegCacheByFunction=function($Tt,$TM){var $Tf,$Tc=0;for($Tf=$TD._cacheList.length,$Tc=0;$Tc<$Tf;$Tc++)if($TD._cacheList[$Tc].tryDispose==$Tt&&$TD._cacheList[$Tc].getCacheList==$TM)return void $TD._cacheList.splice($Tc,1)},$TD.forceDispose=function(){var $Tt=0,$TM=$TD._cacheList.length;for($Tt=0;$Tt<$TM;$Tt++)$TD._cacheList[$Tt].tryDispose(!0)},$TD.beginCheck=function($Tt){void 0===$Tt&&($Tt=15e3),$TT.timer.loop($Tt,null,$TD._checkLoop)},$TD.stopCheck=function(){$TT.timer.clear(null,$TD._checkLoop)},$TD._checkLoop=function(){var $Tt=$TD._cacheList;if(!($Tt.length<1)){var $TM,$Tf=$TK.now(),$Tc=0;for($TM=$Tc=$Tt.length;0<$Tc&&($Tt[$TD._index=++$TD._index%$TM].tryDispose(!1),!($TK.now()-$Tf>$TD.loopTimeLimit));)$Tc--}},$TD.loopTimeLimit=2,$TD._cacheList=[],$TD._index=0,$TD}(),$T$=function(){function $TI(){}return $Tp($TI,"laya.utils.ClassUtils"),$TI.regClass=function($Tt,$TM){$TI._classMap[$Tt]=$TM},$TI.getRegClass=function($Tt){return $TI._classMap[$Tt]},$TI.getInstance=function($Tt){var $TM=$TI.getClass($Tt);return $TM?new $TM:(console.warn("[error] Undefined class:",$Tt),null)},$TI.createByJson=function($Tt,$TM,$Tf,$Tc,$TD){"string"==typeof $Tt&&($Tt=JSON.parse($Tt));var $To=$Tt.props;if(!$TM&&!($TM=$TD?$TD.runWith($Tt):$TI.getInstance($To.runtime||$Tt.type)))return null;var $TJ=$Tt.child;if($TJ)for(var $TZ=0,$TA=$TJ.length;$TZ<$TA;$TZ++){var $TL=$TJ[$TZ];if("render"!==$TL.props.name&&"render"!==$TL.props.renderType||!$TM._$set_itemRender)if("Graphic"==$TL.type)$TI.addGraphicsToSprite($TL,$TM);else if($TI.isDrawType($TL.type))$TI.addGraphicToSprite($TL,$TM,!0);else{var $Tp=$TI.createByJson($TL,null,$Tf,$Tc,$TD);"Script"==$TL.type?$Tp.hasOwnProperty("owner")?$Tp.owner=$TM:$Tp.hasOwnProperty("target")&&($Tp.target=$TM):"mask"==$TL.props.renderType?$TM.mask=$Tp:$TM.addChild($Tp)}else $TM.itemRender=$TL}if($To)for(var $TB in $To){var $Tb=$To[$TB];"var"===$TB&&$Tf?$Tf[$Tb]=$TM:$Tb instanceof Array&&"function"==typeof $TM[$TB]?$TM[$TB].apply($TM,$Tb):$TM[$TB]=$Tb}return $Tc&&$Tt.customProps&&$Tc.runWith([$TM,$Tt]),$TM.created&&$TM.created(),$TM},$TI.addGraphicsToSprite=function($Tt,$TM){var $Tf;if(($Tf=$Tt.child)&&!($Tf.length<1)){var $Tc;$Tc=$TI._getGraphicsFromSprite($Tt,$TM);var $TD=0,$To=0;$Tt.props&&($TD=$TI._getObjVar($Tt.props,"x",0),$To=$TI._getObjVar($Tt.props,"y",0)),0!=$TD&&0!=$To&&$Tc.translate($TD,$To);var $TJ,$TZ=0;for($TJ=$Tf.length,$TZ=0;$TZ<$TJ;$TZ++)$TI._addGraphicToGraphics($Tf[$TZ],$Tc);0!=$TD&&0!=$To&&$Tc.translate(-$TD,-$To)}},$TI.addGraphicToSprite=function($Tt,$TM,$Tf){var $Tc;void 0===$Tf&&($Tf=!1),$Tc=$Tf?$TI._getGraphicsFromSprite($Tt,$TM):$TM.graphics,$TI._addGraphicToGraphics($Tt,$Tc)},$TI._getGraphicsFromSprite=function($Tt,$TM){var $Tf,$Tc;if(!$Tt||!$Tt.props)return $TM.graphics;switch($Tc=$Tt.props.renderType){case"hit":case"unHit":var $TD;$TM.hitArea||($TM.hitArea=new $TR),($TD=$TM.hitArea)[$Tc]||($TD[$Tc]=new $Tb),$Tf=$TD[$Tc]}return $Tf||($Tf=$TM.graphics),$Tf},$TI._getTransformData=function($Tt){var $TM;($Tt.hasOwnProperty("pivotX")||$Tt.hasOwnProperty("pivotY"))&&($TM=$TM||new $TF).translate(-$TI._getObjVar($Tt,"pivotX",0),-$TI._getObjVar($Tt,"pivotY",0));var $Tf=$TI._getObjVar($Tt,"scaleX",1),$Tc=$TI._getObjVar($Tt,"scaleY",1),$TD=$TI._getObjVar($Tt,"rotation",0);$TI._getObjVar($Tt,"skewX",0),$TI._getObjVar($Tt,"skewY",0);return 1==$Tf&&1==$Tc&&0==$TD||(($TM=$TM||new $TF).scale($Tf,$Tc),$TM.rotate(.0174532922222222*$TD)),$TM},$TI._addGraphicToGraphics=function($Tt,$TM){var $Tf,$Tc;if(($Tf=$Tt.props)&&($Tc=$TI.DrawTypeDic[$Tt.type])){var $TD,$To;$TD=$TM;var $TJ=$TI._getParams($Tf,$Tc[1],$Tc[2],$Tc[3]);(($To=$TI._tM)||1!=$TI._alpha)&&($TD.save(),$To&&$TD.transform($To),1!=$TI._alpha&&$TD.alpha($TI._alpha)),$TD[$Tc[0]].apply($TD,$TJ),($To||1!=$TI._alpha)&&$TD.restore()}},$TI._adptLineData=function($Tt){return $Tt[2]=parseFloat($Tt[0])+parseFloat($Tt[2]),$Tt[3]=parseFloat($Tt[1])+parseFloat($Tt[3]),$Tt},$TI._adptTextureData=function($Tt){return $Tt[0]=$TZt.getRes($Tt[0]),$Tt},$TI._adptLinesData=function($Tt){return $Tt[2]=$TI._getPointListByStr($Tt[2]),$Tt},$TI.isDrawType=function($Tt){return"Image"!=$Tt&&$TI.DrawTypeDic.hasOwnProperty($Tt)},$TI._getParams=function($Tt,$TM,$Tf,$Tc){var $TD;void 0===$Tf&&($Tf=0),($TD=$TI._temParam).length=$TM.length;var $To,$TJ,$TZ=0;for($To=$TM.length,$TZ=0;$TZ<$To;$TZ++)$TD[$TZ]=$TI._getObjVar($Tt,$TM[$TZ][0],$TM[$TZ][1]);return $TI._alpha=$TI._getObjVar($Tt,"alpha",1),$TJ=$TI._getTransformData($Tt),$TI._tM=$TJ?($Tf||($Tf=0),$TJ.translate($TD[$Tf],$TD[$Tf+1]),$TD[$Tf]=$TD[$Tf+1]=0,$TJ):null,$Tc&&$TI[$Tc]&&($TD=$TI[$Tc]($TD)),$TD},$TI._getPointListByStr=function($Tt){var $TM,$Tf,$Tc=0;for($Tf=($TM=$Tt.split(",")).length,$Tc=0;$Tc<$Tf;$Tc++)$TM[$Tc]=parseFloat($TM[$Tc]);return $TM},$TI._getObjVar=function($Tt,$TM,$Tf){return $Tt.hasOwnProperty($TM)?$Tt[$TM]:$Tf},$TI._temParam=[],$TI._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$TI.getClass=function($Tt){var $TM=$TI._classMap[$Tt]||$Tt;return"string"==typeof $TM?$TT.__classmap[$TM]:$TM},$TI._tM=null,$TI._alpha=NaN,$TA($TI,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$TI}(),$TP=function(){function $To($Tt){if(this._color=[],"string"==typeof $Tt){null===(this.strColor=$Tt)&&($Tt="#000000"),"#"==$Tt.charAt(0)&&($Tt=$Tt.substr(1));var $TM=$Tt.length;if(3==$TM||4==$TM){for(var $Tf="",$Tc=0;$Tc<$TM;$Tc++)$Tf+=$Tt[$Tc]+$Tt[$Tc];$Tt=$Tf}var $TD=this.numColor=parseInt($Tt,16);if(8==$Tt.length)return void(this._color=[parseInt($Tt.substr(0,2),16)/255,((16711680&$TD)>>16)/255,((65280&$TD)>>8)/255,(255&$TD)/255])}else $TD=this.numColor=$Tt,this.strColor=$Ta.toHexColor($TD);this._color=[((16711680&$TD)>>16)/255,((65280&$TD)>>8)/255,(255&$TD)/255,1],this._color.__id=++$To._COLODID}return $Tp($To,"laya.utils.Color"),$To._initDefault=function(){for(var $Tt in $To._DEFAULT={},$To._COLOR_MAP)$To._SAVE[$Tt]=$To._DEFAULT[$Tt]=new $To($To._COLOR_MAP[$Tt]);return $To._DEFAULT},$To._initSaveMap=function(){for(var $Tt in $To._SAVE_SIZE=0,$To._SAVE={},$To._DEFAULT)$To._SAVE[$Tt]=$To._DEFAULT[$Tt]},$To.create=function($Tt){var $TM=$To._SAVE[$Tt+""];return null!=$TM?$TM:($To._SAVE_SIZE<1e3||$To._initSaveMap(),$To._SAVE[$Tt+""]=new $To($Tt))},$To._SAVE={},$To._SAVE_SIZE=0,$To._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$To._DEFAULT=$To._initDefault(),$To._COLODID=1,$To}(),$TY=(function(){function $Tt(){this._values=[],this._keys=[]}$Tp($Tt,"laya.utils.Dictionary");var $TM=$Tt.prototype;$TM.set=function($Tt,$TM){var $Tf=this.indexOf($Tt);0<=$Tf?this._values[$Tf]=$TM:(this._keys.push($Tt),this._values.push($TM))},$TM.indexOf=function($Tt){var $TM=this._keys.indexOf($Tt);return 0<=$TM?$TM:($Tt="string"==typeof $Tt?Number($Tt):"number"==typeof $Tt?$Tt.toString():$Tt,this._keys.indexOf($Tt))},$TM.get=function($Tt){var $TM=this.indexOf($Tt);return $TM<0?null:this._values[$TM]},$TM.remove=function($Tt){var $TM=this.indexOf($Tt);return 0<=$TM&&(this._keys.splice($TM,1),this._values.splice($TM,1),!0)},$TM.clear=function(){this._values.length=0,this._keys.length=0},$Tq(0,$TM,"values",function(){return this._values}),$Tq(0,$TM,"keys",function(){return this._keys})}(),function(){function $Tt(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$Tp($Tt,"laya.utils.Dragging");var $TM=$Tt.prototype;return $TM.start=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){void 0===$TZ&&($TZ=.92),this.clearTimer(),this.target=$Tt,this.area=$TM,this.hasInertia=$Tf,this.elasticDistance=$TM?$Tc:0,this.elasticBackTime=$TD,this.data=$To,this._disableMouseEvent=$TJ,this.ratio=$TZ,1!=$Tt.globalScaleX||1!=$Tt.globalScaleY?this._parent=$Tt.parent:this._parent=$TT.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$TT.stage.on("mouseup",this,this.onStageMouseUp),$TT.stage.on("mouseout",this,this.onStageMouseUp),$TT.timer.frameLoop(1,this,this.loop)},$TM.clearTimer=function(){$TT.timer.clear(this,this.loop),$TT.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$TM.stop=function(){this._dragging&&($Tl.instance.disableMouseEvent=!1,$TT.stage.off("mouseup",this,this.onStageMouseUp),$TT.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$TM.loop=function(){var $Tt=this._parent.getMousePoint(),$TM=$Tt.x,$Tf=$Tt.y,$Tc=$TM-this._lastX,$TD=$Tf-this._lastY;if(this._clickOnly){if(!(1<Math.abs($Tc*$TT.stage._canvasTransform.getScaleX())||1<Math.abs($TD*$TT.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$Tl.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($Tc,$TD);0==$Tc&&0==$TD||(this._lastX=$TM,this._lastY=$Tf,this.target.x+=$Tc*this._elasticRateX,this.target.y+=$TD*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$TM.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $Tt=this.area.x-this.target.x;else $Tt=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$Tt/this.elasticDistance),this.target.y<this.area.y)var $TM=this.area.y-this.target.y;else $TM=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$TM/this.elasticDistance)}},$TM.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$TM.onStageMouseUp=function($Tt){if($Tl.instance.disableMouseEvent=!1,$TT.stage.off("mouseup",this,this.onStageMouseUp),$TT.stage.off("mouseout",this,this.onStageMouseUp),$TT.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $TM=this._offsets.length,$Tf=Math.min($TM,6),$Tc=this._offsets.length-$Tf,$TD=$TM-1;$Tc<$TD;$TD--)this._offsetY+=this._offsets[$TD--],this._offsetX+=this._offsets[$TD];this._offsetX=this._offsetX/$Tf*2,this._offsetY=this._offsetY/$Tf*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$TT.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$TM.checkElastic=function(){var $Tt=NaN,$TM=NaN;if(this.target.x<this.area.x?$Tt=this.area.x:this.target.x>this.area.x+this.area.width&&($Tt=this.area.x+this.area.width),this.target.y<this.area.y?$TM=this.area.y:this.target.y>this.area.y+this.area.height&&($TM=this.area.y+this.area.height),isNaN($Tt)&&isNaN($TM))this.clear();else{var $Tf={};isNaN($Tt)||($Tf.x=$Tt),isNaN($TM)||($Tf.y=$TM),this._tween=$TG.to(this.target,$Tf,this.elasticBackTime,$Tn.sineOut,$Te.create(this,this.clear),0,!1,!1)}},$TM.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($TT.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$TM.clear=function(){if(this.target){this.clearTimer();var $Tt=this.target;this.target=null,this._parent=null,$Tt.event("dragend",this.data)}},$Tt}()),$Tn=function(){function $TZ(){}return $Tp($TZ,"laya.utils.Ease"),$TZ.linearNone=function($Tt,$TM,$Tf,$Tc){return $Tf*$Tt/$Tc+$TM},$TZ.linearIn=function($Tt,$TM,$Tf,$Tc){return $Tf*$Tt/$Tc+$TM},$TZ.linearInOut=function($Tt,$TM,$Tf,$Tc){return $Tf*$Tt/$Tc+$TM},$TZ.linearOut=function($Tt,$TM,$Tf,$Tc){return $Tf*$Tt/$Tc+$TM},$TZ.bounceIn=function($Tt,$TM,$Tf,$Tc){return $Tf-$TZ.bounceOut($Tc-$Tt,0,$Tf,$Tc)+$TM},$TZ.bounceInOut=function($Tt,$TM,$Tf,$Tc){return $Tt<.5*$Tc?.5*$TZ.bounceIn(2*$Tt,0,$Tf,$Tc)+$TM:.5*$TZ.bounceOut(2*$Tt-$Tc,0,$Tf,$Tc)+.5*$Tf+$TM},$TZ.bounceOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=$Tc)<1/2.75?$Tf*(7.5625*$Tt*$Tt)+$TM:$Tt<2/2.75?$Tf*(7.5625*($Tt-=1.5/2.75)*$Tt+.75)+$TM:$Tt<2.5/2.75?$Tf*(7.5625*($Tt-=2.25/2.75)*$Tt+.9375)+$TM:$Tf*(7.5625*($Tt-=2.625/2.75)*$Tt+.984375)+$TM},$TZ.backIn=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=1.70158),$Tf*($Tt/=$Tc)*$Tt*(($TD+1)*$Tt-$TD)+$TM},$TZ.backInOut=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=1.70158),($Tt/=.5*$Tc)<1?.5*$Tf*($Tt*$Tt*((1+($TD*=1.525))*$Tt-$TD))+$TM:$Tf/2*(($Tt-=2)*$Tt*((1+($TD*=1.525))*$Tt+$TD)+2)+$TM},$TZ.backOut=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=1.70158),$Tf*(($Tt=$Tt/$Tc-1)*$Tt*(($TD+1)*$Tt+$TD)+1)+$TM},$TZ.elasticIn=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ;return void 0===$TD&&($TD=0),void 0===$To&&($To=0),0==$Tt?$TM:1==($Tt/=$Tc)?$TM+$Tf:($To||($To=.3*$Tc),$TJ=!$TD||0<$Tf&&$TD<$Tf||$Tf<0&&$TD<-$Tf?($TD=$Tf,$To/4):$To/$TZ.PI2*Math.asin($Tf/$TD),-$TD*Math.pow(2,10*($Tt-=1))*Math.sin(($Tt*$Tc-$TJ)*$TZ.PI2/$To)+$TM)},$TZ.elasticInOut=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ;return void 0===$TD&&($TD=0),void 0===$To&&($To=0),0==$Tt?$TM:2==($Tt/=.5*$Tc)?$TM+$Tf:($To||($To=$Tc*(.3*1.5)),$TJ=!$TD||0<$Tf&&$TD<$Tf||$Tf<0&&$TD<-$Tf?($TD=$Tf,$To/4):$To/$TZ.PI2*Math.asin($Tf/$TD),$Tt<1?$TD*Math.pow(2,10*($Tt-=1))*Math.sin(($Tt*$Tc-$TJ)*$TZ.PI2/$To)*-.5+$TM:$TD*Math.pow(2,-10*($Tt-=1))*Math.sin(($Tt*$Tc-$TJ)*$TZ.PI2/$To)*.5+$Tf+$TM)},$TZ.elasticOut=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ;return void 0===$TD&&($TD=0),void 0===$To&&($To=0),0==$Tt?$TM:1==($Tt/=$Tc)?$TM+$Tf:($To||($To=.3*$Tc),$TJ=!$TD||0<$Tf&&$TD<$Tf||$Tf<0&&$TD<-$Tf?($TD=$Tf,$To/4):$To/$TZ.PI2*Math.asin($Tf/$TD),$TD*Math.pow(2,-10*$Tt)*Math.sin(($Tt*$Tc-$TJ)*$TZ.PI2/$To)+$Tf+$TM)},$TZ.strongIn=function($Tt,$TM,$Tf,$Tc){return $Tf*($Tt/=$Tc)*$Tt*$Tt*$Tt*$Tt+$TM},$TZ.strongInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*$Tf*$Tt*$Tt*$Tt*$Tt*$Tt+$TM:.5*$Tf*(($Tt-=2)*$Tt*$Tt*$Tt*$Tt+2)+$TM},$TZ.strongOut=function($Tt,$TM,$Tf,$Tc){return $Tf*(($Tt=$Tt/$Tc-1)*$Tt*$Tt*$Tt*$Tt+1)+$TM},$TZ.sineInOut=function($Tt,$TM,$Tf,$Tc){return.5*-$Tf*(Math.cos(Math.PI*$Tt/$Tc)-1)+$TM},$TZ.sineIn=function($Tt,$TM,$Tf,$Tc){return-$Tf*Math.cos($Tt/$Tc*$TZ.HALF_PI)+$Tf+$TM},$TZ.sineOut=function($Tt,$TM,$Tf,$Tc){return $Tf*Math.sin($Tt/$Tc*$TZ.HALF_PI)+$TM},$TZ.quintIn=function($Tt,$TM,$Tf,$Tc){return $Tf*($Tt/=$Tc)*$Tt*$Tt*$Tt*$Tt+$TM},$TZ.quintInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*$Tf*$Tt*$Tt*$Tt*$Tt*$Tt+$TM:.5*$Tf*(($Tt-=2)*$Tt*$Tt*$Tt*$Tt+2)+$TM},$TZ.quintOut=function($Tt,$TM,$Tf,$Tc){return $Tf*(($Tt=$Tt/$Tc-1)*$Tt*$Tt*$Tt*$Tt+1)+$TM},$TZ.quartIn=function($Tt,$TM,$Tf,$Tc){return $Tf*($Tt/=$Tc)*$Tt*$Tt*$Tt+$TM},$TZ.quartInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*$Tf*$Tt*$Tt*$Tt*$Tt+$TM:.5*-$Tf*(($Tt-=2)*$Tt*$Tt*$Tt-2)+$TM},$TZ.quartOut=function($Tt,$TM,$Tf,$Tc){return-$Tf*(($Tt=$Tt/$Tc-1)*$Tt*$Tt*$Tt-1)+$TM},$TZ.cubicIn=function($Tt,$TM,$Tf,$Tc){return $Tf*($Tt/=$Tc)*$Tt*$Tt+$TM},$TZ.cubicInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*$Tf*$Tt*$Tt*$Tt+$TM:.5*$Tf*(($Tt-=2)*$Tt*$Tt+2)+$TM},$TZ.cubicOut=function($Tt,$TM,$Tf,$Tc){return $Tf*(($Tt=$Tt/$Tc-1)*$Tt*$Tt+1)+$TM},$TZ.quadIn=function($Tt,$TM,$Tf,$Tc){return $Tf*($Tt/=$Tc)*$Tt+$TM},$TZ.quadInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*$Tf*$Tt*$Tt+$TM:.5*-$Tf*(--$Tt*($Tt-2)-1)+$TM},$TZ.quadOut=function($Tt,$TM,$Tf,$Tc){return-$Tf*($Tt/=$Tc)*($Tt-2)+$TM},$TZ.expoIn=function($Tt,$TM,$Tf,$Tc){return 0==$Tt?$TM:$Tf*Math.pow(2,10*($Tt/$Tc-1))+$TM-.001*$Tf},$TZ.expoInOut=function($Tt,$TM,$Tf,$Tc){return 0==$Tt?$TM:$Tt==$Tc?$TM+$Tf:($Tt/=.5*$Tc)<1?.5*$Tf*Math.pow(2,10*($Tt-1))+$TM:.5*$Tf*(2-Math.pow(2,-10*--$Tt))+$TM},$TZ.expoOut=function($Tt,$TM,$Tf,$Tc){return $Tt==$Tc?$TM+$Tf:$Tf*(1-Math.pow(2,-10*$Tt/$Tc))+$TM},$TZ.circIn=function($Tt,$TM,$Tf,$Tc){return-$Tf*(Math.sqrt(1-($Tt/=$Tc)*$Tt)-1)+$TM},$TZ.circInOut=function($Tt,$TM,$Tf,$Tc){return($Tt/=.5*$Tc)<1?.5*-$Tf*(Math.sqrt(1-$Tt*$Tt)-1)+$TM:.5*$Tf*(Math.sqrt(1-($Tt-=2)*$Tt)+1)+$TM},$TZ.circOut=function($Tt,$TM,$Tf,$Tc){return $Tf*Math.sqrt(1-($Tt=$Tt/$Tc-1)*$Tt)+$TM},$TZ.HALF_PI=.5*Math.PI,$TZ.PI2=2*Math.PI,$TZ}(),$TR=function(){function $TB(){this._hit=null,this._unHit=null}$Tp($TB,"laya.utils.HitArea");var $Tt=$TB.prototype;return $Tt.isHit=function($Tt,$TM){return!!$TB.isHitGraphic($Tt,$TM,this.hit)&&!$TB.isHitGraphic($Tt,$TM,this.unHit)},$Tt.contains=function($Tt,$TM){return this.isHit($Tt,$TM)},$Tq(0,$Tt,"hit",function(){return this._hit||(this._hit=new $Tb),this._hit},function($Tt){this._hit=$Tt}),$Tq(0,$Tt,"unHit",function(){return this._unHit||(this._unHit=new $Tb),this._unHit},function($Tt){this._unHit=$Tt}),$TB.isHitGraphic=function($Tt,$TM,$Tf){if(!$Tf)return!1;var $Tc;if(!($Tc=$Tf.cmds)&&$Tf._one&&(($Tc=$TB._cmds).length=1,$Tc[0]=$Tf._one),!$Tc)return!1;var $TD,$To,$TJ=0;for($TD=$Tc.length,$TJ=0;$TJ<$TD;$TJ++)if($To=$Tc[$TJ]){var $TZ=$Ts._context;switch($To.callee){case $TZ._translate:case 6:$Tt-=$To[0],$TM-=$To[1]}if($TB.isHitCmd($Tt,$TM,$To))return!0}return!1},$TB.isHitCmd=function($Tt,$TM,$Tf){if(!$Tf)return!1;var $Tc=$Ts._context,$TD=!1;switch($Tf.callee){case $Tc._drawRect:case 13:$TB._rec.setTo($Tf[0],$Tf[1],$Tf[2],$Tf[3]),$TD=$TB._rec.contains($Tt,$TM);break;case $Tc._drawCircle:case $Tc._fillCircle:case 14:$TD=($Tt-=$Tf[0])*$Tt+($TM-=$Tf[1])*$TM<$Tf[2]*$Tf[2];break;case $Tc._drawPoly:case 18:$Tt-=$Tf[0],$TM-=$Tf[1],$TD=$TB.ptInPolygon($Tt,$TM,$Tf[2])}return $TD},$TB.ptInPolygon=function($Tt,$TM,$Tf){var $Tc;($Tc=$TB._ptPoint).setTo($Tt,$TM);var $TD,$To=0,$TJ=NaN,$TZ=NaN,$TA=NaN,$TL=NaN;$TD=$Tf.length;for(var $Tp=0;$Tp<$TD;$Tp+=2){if($TJ=$Tf[$Tp],$TZ=$Tf[$Tp+1],$TA=$Tf[($Tp+2)%$TD],$TZ!=($TL=$Tf[($Tp+3)%$TD]))if(!($Tc.y<Math.min($TZ,$TL)))if(!($Tc.y>=Math.max($TZ,$TL)))($Tc.y-$TZ)*($TA-$TJ)/($TL-$TZ)+$TJ>$Tc.x&&$To++}return $To%2==1},$TB._cmds=[],$TA($TB,["_rec",function(){return this._rec=new $TV},"_ptPoint",function(){return this._ptPoint=new $Ti}]),$TB}(),$Tg=(function(){function $TD($Tt,$TM,$Tf,$Tc){this.char=$Tt,this.charNum=$Tt.charCodeAt(0),this._x=this._y=0,this.width=$TM,this.height=$Tf,this.style=$Tc,this.isWord=!$TD._isWordRegExp.test($Tt)}$Tp($TD,"laya.utils.HTMLChar");var $Tt=$TD.prototype;$TT.imps($Tt,{"laya.display.ILayout":!0}),$Tt.setSprite=function($Tt){this._sprite=$Tt},$Tt.getSprite=function(){return this._sprite},$Tt._isChar=function(){return!0},$Tt._getCSSStyle=function(){return this.style},$Tq(0,$Tt,"width",function(){return this._w},function($Tt){this._w=$Tt}),$Tq(0,$Tt,"x",function(){return this._x},function($Tt){this._sprite&&(this._sprite.x=$Tt),this._x=$Tt}),$Tq(0,$Tt,"y",function(){return this._y},function($Tt){this._sprite&&(this._sprite.y=$Tt),this._y=$Tt}),$Tq(0,$Tt,"height",function(){return this._h},function($Tt){this._h=$Tt}),$TD._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $TM(){}$Tp($TM,"laya.utils.Log"),$TM.enable=function(){$TM._logdiv||($TM._logdiv=$TK.window.document.createElement("div"),$TK.window.document.body.appendChild($TM._logdiv),$TM._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$TM.toggle=function(){var $Tt=$TM._logdiv.style;"1px"==$Tt.width?$Tt.width=$Tt.height="50%":$Tt.width=$Tt.height="1px"},$TM.print=function($Tt){$TM._logdiv&&($TM.maxCount<=$TM._count&&$TM.clear(),$TM._count++,$TM._logdiv.innerText+=$Tt+"\n",$TM._logdiv.scrollTop=$TM._logdiv.scrollHeight)},$TM.clear=function(){$TM._logdiv.innerText="",$TM._count=0},$TM._logdiv=null,$TM._count=0,$TM.maxCount=20}(),function(){function $TM(){}$Tp($TM,"laya.utils.Mouse"),$Tq(1,$TM,"cursor",function(){return $TM._style.cursor},function($Tt){$TM._style.cursor=$Tt}),$TM.hide=function(){"none"!=$TM.cursor&&($TM._preCursor=$TM.cursor,$TM.cursor="none")},$TM.show=function(){"none"==$TM.cursor&&($TM.cursor=$TM._preCursor?$TM._preCursor:"auto")},$TM._preCursor=null,$TA($TM,["_style",function(){return this._style=$TK.document.body.style}])}(),function(){function $To(){}return $Tp($To,"laya.utils.Pool"),$To.getPoolBySign=function($Tt){return $To._poolDic[$Tt]||($To._poolDic[$Tt]=[])},$To.clearBySign=function($Tt){$To._poolDic[$Tt]&&($To._poolDic[$Tt].length=0)},$To.recover=function($Tt,$TM){$TM.__InPool||($TM.__InPool=!0,$To.getPoolBySign($Tt).push($TM))},$To.getItemByClass=function($Tt,$TM){var $Tf=$To.getPoolBySign($Tt),$Tc=$Tf.length?$Tf.pop():new $TM;return $Tc.__InPool=!1,$Tc},$To.getItemByCreateFun=function($Tt,$TM,$Tf){var $Tc=$To.getPoolBySign($Tt),$TD=$Tc.length?$Tc.pop():$TM.call($Tf);return $TD.__InPool=!1,$TD},$To.getItem=function($Tt){var $TM=$To.getPoolBySign($Tt),$Tf=$TM.length?$TM.pop():null;return $Tf&&($Tf.__InPool=!1),$Tf},$To._poolDic={},$To.InPoolSign="__InPool",$To}()),$Tz=function(){function $TA(){}return $Tp($TA,"laya.utils.Stat"),$Tq(1,$TA,"onclick",null,function($Tt){$TA._sp&&$TA._sp.on("click",$TA._sp,$Tt),$TA._canvas&&($TA._canvas.source.onclick=$Tt,$TA._canvas.source.style.pointerEvents="")}),$TA.show=function($Tt,$TM,$Tf){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),!$Ts.isConchApp||$Ts.isConchWebGL){if($Ts.isConchWebGL||$TK.onMiniGame||$TK.onLimixiu||($TA._useCanvas=!0),$TA._show=!0,$TA._fpsData.length=60,$TA._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$TA._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$TA._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$TA._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$Ts.isWebGL)if($TA._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$Ts.is3DMode){if($TA._view[0].title="FPS(3D)",$TA._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$TA._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$TA._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$Tf){var $Tc=8;$TA._view[$Tc++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$TA._view[$Tc++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$TA._view[$Tc++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$Tf){$Tc=8;$TA._view[$Tc++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$TA._view[$Tc++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $TA._view[0].title="FPS(WebGL)",$TA._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $TA._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$TA._useCanvas?$TA.createUIPre($Tt,$TM):$TA.createUI($Tt,$TM),$TA.enable()}else $TK.window.conch.showFPS&&$TK.window.conch.showFPS($Tt,$TM)},$TA.createUIPre=function($Tt,$TM){var $Tf=$TK.pixelRatio;$TA._width=170*$Tf,$TA._vx=75*$Tf,$TA._height=$Tf*(12*$TA._view.length+3*$Tf)+4,$TA._fontSize=12*$Tf;for(var $Tc=0;$Tc<$TA._view.length;$Tc++)$TA._view[$Tc].x=4,$TA._view[$Tc].y=$Tc*$TA._fontSize+2*$Tf;$TA._canvas||(($TA._canvas=new $TNt("2D")).size($TA._width,$TA._height),($TA._ctx=$TA._canvas.getContext("2d")).textBaseline="top",$TA._ctx.font=$TA._fontSize+"px Sans-serif",$TA._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$Tt+"px;top:"+$TM+"px;width:"+$TA._width/$Tf+"px;height:"+$TA._height/$Tf+"px;"),$TA._first=!0,$TA.loop(),$TA._first=!1,$TK.container.appendChild($TA._canvas.source)},$TA.createUI=function($Tt,$TM){var $Tf=$TA._sp,$Tc=$TK.pixelRatio;$Tf||($Tf=new $TBt,($TA._leftText=new $T_t).pos(5,5),$TA._leftText.color="#ffffff",$Tf.addChild($TA._leftText),($TA._txt=new $T_t).pos(80*$Tc,5),$TA._txt.color="#ffffff",$Tf.addChild($TA._txt),$TA._sp=$Tf),$Tf.pos($Tt,$TM);for(var $TD="",$To=0;$To<$TA._view.length;$To++){$TD+=$TA._view[$To].title+"\n"}$TA._leftText.text=$TD;var $TJ=170*$Tc,$TZ=$Tc*(12*$TA._view.length+3*$Tc)+4;$TA._txt.fontSize=$TA._fontSize*$Tc,$TA._leftText.fontSize=$TA._fontSize*$Tc,$Tf.size($TJ,$TZ),$Tf.graphics.clear(),$Tf.graphics.setAlpha(.5),$Tf.graphics.drawRect(0,0,$TJ,$TZ,"#999999"),$Tf.graphics.setAlpha(1),$TA.loop()},$TA.enable=function(){$TT.timer.frameLoop(1,$TA,$TA.loop)},$TA.hide=function(){$TA._show=!1,$TT.timer.clear($TA,$TA.loop),$TA._canvas&&$TK.removeElement($TA._canvas.source)},$TA.clear=function(){$TA.trianglesFaces=$TA.drawCall=$TA.shaderCall=$TA.spriteCount=$TA.spriteRenderUseCacheCount=$TA.treeNodeCollision=$TA.treeSpriteCollision=$TA.canvasNormal=$TA.canvasBitmap=$TA.canvasReCache=0},$TA.loop=function(){$TA._count++;var $Tt=$TK.now();if(!($Tt-$TA._timer<1e3)){var $TM=$TA._count;if($TA.FPS=Math.round(1e3*$TM/($Tt-$TA._timer)),$TA._show){$TA.trianglesFaces=Math.round($TA.trianglesFaces/$TM),$TA.spriteCount=$TA._useCanvas?($TA.drawCall=Math.round($TA.drawCall/$TM)-2,$TA.shaderCall=Math.round($TA.shaderCall/$TM),Math.round($TA.spriteCount/$TM)-1):($TA.drawCall=Math.round($TA.drawCall/$TM)-2,$TA.shaderCall=Math.round($TA.shaderCall/$TM)-4,Math.round($TA.spriteCount/$TM)-4),$TA.spriteRenderUseCacheCount=Math.round($TA.spriteRenderUseCacheCount/$TM),$TA.canvasNormal=Math.round($TA.canvasNormal/$TM),$TA.canvasBitmap=Math.round($TA.canvasBitmap/$TM),$TA.canvasReCache=Math.ceil($TA.canvasReCache/$TM),$TA.treeNodeCollision=Math.round($TA.treeNodeCollision/$TM),$TA.treeSpriteCollision=Math.round($TA.treeSpriteCollision/$TM);var $Tf=0<$TA.FPS?Math.floor(1e3/$TA.FPS).toString():" ";$TA._fpsStr=$TA.FPS+($TA.renderSlow?" slow":"")+" "+$Tf,$TA._spriteStr=$TA.spriteCount+($TA.spriteRenderUseCacheCount?"/"+$TA.spriteRenderUseCacheCount:""),$TA._canvasStr=$TA.canvasReCache+"/"+$TA.canvasNormal+"/"+$TA.canvasBitmap,$TA.currentMemorySize=$Tk.systemResourceManager.memorySize,$TA._useCanvas?$TA.renderInfoPre():$TA.renderInfo(),$TA.clear()}$TA._count=0,$TA._timer=$Tt}},$TA.renderInfoPre=function(){if($TA._canvas){var $Tt=$TA._ctx;$Tt.clearRect($TA._first?0:$TA._vx,0,$TA._width,$TA._height);for(var $TM=$Ts.WebGL.mainContext,$Tf=0;$Tf<$TA._view.length;$Tf++){var $Tc=$TA._view[$Tf];$TA._first&&($Tt.fillStyle="white",$Tt.fillText($Tc.title,$Tc.x,$Tc.y,null,null,null)),$Tt.fillStyle=$Tc.color;var $TD=-1;if(($Tc=$TA._view[$Tf]).varying){if($TM)switch($Tc.varying){case 1:$TD=$TM.getParameter($TM[$Tc.value]);break;case 2:$TD=$TM.getExtension($Tc.value)}}else $TD=$TA[$Tc.value];"M"==$Tc.units&&($TD=Math.floor($TD/1048576*100)/100+" M"),"K"==$Tc.units&&($TD=Math.floor($TD/1024*100)/100+" K"),"string"==$Tc.units&&($TD=$TD.match(/\d+\.?\d/i)),$Tt.fillText($TD+"",$Tc.x+$TA._vx,$Tc.y,null,null,null)}}},$TA.renderInfo=function(){for(var $Tt="",$TM=$Ts.WebGL.mainContext,$Tf=0;$Tf<$TA._view.length;$Tf++){var $Tc=$TA._view[$Tf],$TD=-1;if($Tc.varying){if($TM)switch($Tc.varying){case 1:$TD=$TM.getParameter($TM[$Tc.value]);break;case 2:$TD=$TM.getExtension($Tc.value)}}else $TD=$TA[$Tc.value];"M"==$Tc.units&&($TD=Math.floor($TD/1048576*100)/100+" M"),"K"==$Tc.units&&($TD=Math.floor($TD/1024*100)/100+" K"),"string"==$Tc.units&&($TD=$TD.match(/\d+\.?\d/i)),$Tt+=$TD+"\n"}$TA._txt.text=$Tt},$TA.FPS=0,$TA.loopCount=0,$TA.shaderCall=0,$TA.drawCall=0,$TA.trianglesFaces=0,$TA.spriteCount=0,$TA.spriteRenderUseCacheCount=0,$TA.treeNodeCollision=0,$TA.treeSpriteCollision=0,$TA.canvasNormal=0,$TA.canvasBitmap=0,$TA.canvasReCache=0,$TA.renderSlow=!1,$TA.currentMemorySize=0,$TA._fpsStr=null,$TA._canvasStr=null,$TA._spriteStr=null,$TA._fpsData=[],$TA._timer=0,$TA._count=0,$TA._view=[],$TA._fontSize=12,$TA._txt=null,$TA._leftText=null,$TA._sp=null,$TA._show=!1,$TA._useCanvas=!1,$TA._canvas=null,$TA._ctx=null,$TA._first=!1,$TA._vx=NaN,$TA._width=0,$TA._height=100,$TA}(),$Tm=(function(){function $Tt(){this._strsToID={},this._idToStrs=[],this._length=0}$Tp($Tt,"laya.utils.StringKey");var $TM=$Tt.prototype;$TM.add=function($Tt){var $TM=this._strsToID[$Tt];return null!=$TM?$TM:(this._idToStrs[this._length]=$Tt,this._strsToID[$Tt]=this._length++)},$TM.getID=function($Tt){var $TM=this._strsToID[$Tt];return null==$TM?-1:$TM},$TM.getName=function($Tt){var $TM=this._idToStrs[$Tt];return null==$TM?void 0:$TM}}(),function(){var $TL;function $Tt(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$Tp($Tt,"laya.utils.Timer");var $TM=$Tt.prototype;return $TM._init=function(){$TT.timer&&$TT.timer.frameLoop(1,this,this._update)},$TM._now=function(){return Date.now()},$TM._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $Tt=this.currFrame=this.currFrame+this.scale,$TM=this._now();this._delta=($TM-this._lastTimer)*this.scale;var $Tf=this.currTimer=this.currTimer+this._delta;$TT.isDebug&&6e4<Math.abs($TM-this._lastTimer)&&console.error("系统时间错误！"+($TM-this._lastTimer)),this._lastTimer=$TM;var $Tc=this._handlers;for($TJ=this._count=0,$TZ=$Tc.length;$TJ<$TZ;$TJ++)if(null!==($TA=$Tc[$TJ]).method){var $TD=$TA.userFrame?$Tt:$Tf;if($TD>=$TA.exeTime)if($TA.repeat)if($TA.jumpFrame)for(;$TD>=$TA.exeTime;)$TA.exeTime+=$TA.delay,$TA.run(!1);else $TA.exeTime+=$TA.delay,$TA.run(!1),$TD>$TA.exeTime&&($TA.exeTime+=Math.ceil(($TD-$TA.exeTime)/$TA.delay)*$TA.delay);else $TA.run(!0)}else this._count++;(30<this._count||$Tt%200==0)&&this._clearHandlers();for(var $To=this._laters,$TJ=0,$TZ=$To.length-1;$TJ<=$TZ;$TJ++){var $TA=$To[$TJ];this._isIgnoreRecover($TA)||(null!==$TA.method&&(delete this._map[$TA.key],$TA.run(!1)),this._recoverHandler($TA)),$TJ===$TZ&&($TZ=$To.length-1)}$To.length=0}},$TM._clearHandlers=function(){for(var $Tt=this._handlers,$TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++){var $Tc=$Tt[$TM];null!==$Tc.method?this._temp.push($Tc):this._isIgnoreRecover($Tc)?this._temp.push($Tc):this._recoverHandler($Tc)}this._handlers=this._temp,this._temp=$Tt,this._temp.length=0},$TM._recoverHandler=function($Tt){this._map[$Tt.key]==$Tt&&delete this._map[$Tt.key],$Tt.recover()},$TM._create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){if(!$Tf)return $TD.apply($Tc,$To),null;if($TJ){var $TA=this._getHandler($Tc,$TD);if($TA)return $TA.repeat=$TM,$TA.userFrame=$Tt,$TA.delay=$Tf,$TA.ignoreRecover=$TZ,$TA.caller=$Tc,$TA.method=$TD,$TA.args=$To,$TA.exeTime=$Tf+($Tt?this.currFrame:this.currTimer+this._now()-this._lastTimer),$TA}return($TA=$TL.create()).repeat=$TM,$TA.userFrame=$Tt,$TA.delay=$Tf,$TA.ignoreRecover=$TZ,$TA.caller=$Tc,$TA.method=$TD,$TA.args=$To,$TA.exeTime=$Tf+($Tt?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($TA),this._handlers.push($TA),$TA},$TM._indexHandler=function($Tt){var $TM=$Tt.caller,$Tf=$Tt.method,$Tc=$TM?$TM.$_GID||($TM.$_GID=$Ta.getGID()):0,$TD=$Tf.$_TID||($Tf.$_TID=this._mid++);$Tt.key=$Tc+"_"+$TD,this._map[$Tt.key]=$Tt},$TM.once=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=!0),this._create(!1,!1,$Tt,$TM,$Tf,$Tc,$TD,!1)},$TM.loop=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){void 0===$TD&&($TD=!0),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!1);var $TZ=this._create(!1,!0,$Tt,$TM,$Tf,$Tc,$TD,$TJ);$TZ&&($TZ.jumpFrame=$To)},$TM.frameOnce=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=!0),this._create(!0,!1,$Tt,$TM,$Tf,$Tc,$TD,!1)},$TM.frameLoop=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$TD&&($TD=!0),void 0===$To&&($To=!1),this._create(!0,!0,$Tt,$TM,$Tf,$Tc,$TD,$To)},$TM.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$TL._freeCount},$TM.clear=function($Tt,$TM){var $Tf=this._getHandler($Tt,$TM);return!(!$Tf||this._isIgnoreRecover($Tf))&&(delete this._map[$Tf.key],$Tf.key=null,$Tf.clear(),!0)},$TM.clearAll=function($Tt){if($Tt)for(var $TM=0,$Tf=this._handlers.length;$TM<$Tf;$TM++){var $Tc=this._handlers[$TM];$Tc.caller===$Tt&&(this._isIgnoreRecover($Tc)||(delete this._map[$Tc.key],$Tc.key=null,$Tc.clear()))}},$TM._getHandler=function($Tt,$TM){var $Tf=$Tt?$Tt.$_GID||($Tt.$_GID=$Ta.getGID()):0,$Tc=$TM.$_TID||($TM.$_TID=this._mid++);return this._map[$Tf+"_"+$Tc]},$TM._isIgnoreRecover=function($Tt){if($Tt.ignoreRecover||$Tt.caller&&"IgnoreRecover"==$Tt.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $TM="";try{arguments.propertyIsEnumerable.caller}catch($Tt){$TM=$Tt.stack}$TT.recordError("报错：核心定时器销毁忽略  "+$TM)}return!0}return!1},$TM.hasHandler=function($Tt,$TM){return this._map[$Tt.$_GID+"_"+$TM.$_TID]},$TM.callLater=function($Tt,$TM,$Tf){if(null==this._getHandler($Tt,$TM)){var $Tc=$TL.create();$Tc.caller=$Tt,$Tc.method=$TM,$Tc.args=$Tf,this._indexHandler($Tc),this._laters.push($Tc)}},$TM.runCallLater=function($Tt,$TM){var $Tf=this._getHandler($Tt,$TM);$Tf&&null!=$Tf.method&&(this._isIgnoreRecover($Tf)||(delete this._map[$Tf.key],$Tf.run(!0)))},$TM.runTimer=function($Tt,$TM){this.runCallLater($Tt,$TM)},$Tq(0,$TM,"delta",function(){return this._delta}),$Tt.__init$=function(){$TL=function(){function $TM(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$Tp($TM,"");var $Tt=$TM.prototype;return $Tt.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$Tt.recover=function(){this.clear(),this.args=$TM._freeHandler,$TM._freeHandler=this,$TM._freeCount++},$Tt.run=function($Tt){var $TM=this.caller;if($TM&&$TM.destroyed)return this.clear();var $Tf=this.method,$Tc=this.args;$Tt&&this.clear(),null!=$Tf&&($Tc?$Tf.apply($TM,$Tc):$Tf.call($TM))},$TM._freeHandler=null,$TM._freeCount=0,$TM.create=function(){var $Tt=$TM._freeHandler;return $Tt?($TM._freeHandler=$Tt.args,--$TM._freeCount,$Tt.args=null,$Tt):new $TM},$TM}()},$Tt}()),$TG=function(){function $TB(){this.gid=0}$Tp($TB,"laya.utils.Tween");var $Tt=$TB.prototype;return $Tt.to=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){return void 0===$To&&($To=0),void 0===$TJ&&($TJ=!1),this._create($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,!0,!1,!0)},$Tt.from=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){return void 0===$To&&($To=0),void 0===$TJ&&($TJ=!1),this._create($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,!1,!1,!0)},$Tt._create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){if(!$Tt)throw new Error("Tween:target is null");this._target=$Tt,this._duration=$Tf,this._ease=$Tc||$TM.ease||$TB.easeNone,this._complete=$TD||$TM.complete,this._delay=$To,this._props=[],this._usedTimer=0,this._startTimer=$TK.now(),this._usedPool=$TA,this._delayParam=null,this.update=$TM.update;var $Tp=$Tt.$_GID||($Tt.$_GID=$Ta.getGID());return $TB.tweenMap[$Tp]?($TJ&&$TB.clearTween($Tt),$TB.tweenMap[$Tp].push(this)):$TB.tweenMap[$Tp]=[this],$TL?$To<=0?this.firstStart($Tt,$TM,$TZ):(this._delayParam=[$Tt,$TM,$TZ],$TT.scaleTimer.once($To,this,this.firstStart,this._delayParam)):this._initProps($Tt,$TM,$TZ),this},$Tt.firstStart=function($Tt,$TM,$Tf){this._delayParam=null,$Tt.destroyed?this.clear():(this._initProps($Tt,$TM,$Tf),this._beginLoop())},$Tt._initProps=function($Tt,$TM,$Tf){for(var $Tc in $TM)if("number"==typeof $Tt[$Tc]){var $TD=$Tf?$Tt[$Tc]:$TM[$Tc],$To=$Tf?$TM[$Tc]:$Tt[$Tc];this._props.push([$Tc,$TD,$To-$TD]),$Tf||($Tt[$Tc]=$TD)}},$Tt._beginLoop=function(){$TT.scaleTimer.frameLoop(1,this,this._doEase)},$Tt._doEase=function(){this._updateEase($TK.now())},$Tt._updateEase=function($Tt){var $TM=this._target;if($TM){if($TM.destroyed)return $TB.clearTween($TM);var $Tf=this._usedTimer=$Tt-this._startTimer-this._delay;if(!($Tf<0)){if($Tf>=this._duration)return this.complete();for(var $Tc=0<$Tf?this._ease($Tf,0,1,this._duration):0,$TD=this._props,$To=0,$TJ=$TD.length;$To<$TJ;$To++){var $TZ=$TD[$To];$TM[$TZ[0]]=$TZ[1]+$Tc*$TZ[2]}this.update&&this.update.run()}}},$Tt.complete=function(){if(this._target){$TT.scaleTimer.runTimer(this,this.firstStart);for(var $Tt=this._target,$TM=this._props,$Tf=this._complete,$Tc=0,$TD=$TM.length;$Tc<$TD;$Tc++){var $To=$TM[$Tc];$Tt[$To[0]]=$To[1]+$To[2]}this.update&&this.update.run(),this.clear(),$Tf&&$Tf.run()}},$Tt.pause=function(){$TT.scaleTimer.clear(this,this._beginLoop),$TT.scaleTimer.clear(this,this._doEase),$TT.scaleTimer.clear(this,this.firstStart);var $Tt;($Tt=$TK.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$Tt)},$Tt.setStartTime=function($Tt){this._startTimer=$Tt},$Tt.clear=function(){this._target&&(this._remove(),this._clear())},$Tt._clear=function(){this.pause(),$TT.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$Tg.recover("tween",this))},$Tt.recover=function(){this._usedPool=!0,this._clear()},$Tt._remove=function(){var $Tt=$TB.tweenMap[this._target.$_GID];if($Tt)for(var $TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++)if($Tt[$TM]===this){$Tt.splice($TM,1);break}},$Tt.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$TK.now(),this._delayParam)$TT.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $Tt=this._props,$TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++){var $Tc=$Tt[$TM];this._target[$Tc[0]]=$Tc[1]}$TT.scaleTimer.once(this._delay,this,this._beginLoop)}},$Tt.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$TK.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$TT.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$Tq(0,$Tt,"progress",null,function($Tt){var $TM=$Tt*this._duration;this._startTimer=$TK.now()-this._delay-$TM}),$TB.to=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){return void 0===$To&&($To=0),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=!0),$Tg.getItemByClass("tween",$TB)._create($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,!0,$TZ,!0)},$TB.from=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){return void 0===$To&&($To=0),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=!0),$Tg.getItemByClass("tween",$TB)._create($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,!1,$TZ,!0)},$TB.clearAll=function($Tt){if($Tt&&$Tt.$_GID){var $TM=$TB.tweenMap[$Tt.$_GID];if($TM){for(var $Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)$TM[$Tf]._clear();$TM.length=0}}},$TB.clear=function($Tt){$Tt.clear()},$TB.clearTween=function($Tt){$TB.clearAll($Tt)},$TB.easeNone=function($Tt,$TM,$Tf,$Tc){return $Tf*$Tt/$Tc+$TM},$TB.tweenMap={},$TB}(),$Ta=function(){function $TZ(){}return $Tp($TZ,"laya.utils.Utils"),$TZ.toRadian=function($Tt){return $Tt*$TZ._pi2},$TZ.toAngle=function($Tt){return $Tt*$TZ._pi},$TZ.toHexColor=function($Tt){if($Tt<0||isNaN($Tt))return null;for(var $TM=$Tt.toString(16);$TM.length<6;)$TM="0"+$TM;return"#"+$TM},$TZ.getGID=function(){return $TZ._gid++},$TZ.concatArray=function($Tt,$TM){if(!$TM)return $Tt;if(!$Tt)return $TM;var $Tf=0,$Tc=$TM.length;for($Tf=0;$Tf<$Tc;$Tf++)$Tt.push($TM[$Tf]);return $Tt},$TZ.clearArray=function($Tt){return $Tt&&($Tt.length=0),$Tt},$TZ.copyArray=function($Tt,$TM){if($Tt||($Tt=[]),!$TM)return $Tt;$Tt.length=$TM.length;var $Tf=0,$Tc=$TM.length;for($Tf=0;$Tf<$Tc;$Tf++)$Tt[$Tf]=$TM[$Tf];return $Tt},$TZ.getGlobalRecByPoints=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ;return $To=new $Ti($TM,$Tf),$To=$Tt.localToGlobal($To),$TJ=new $Ti($Tc,$TD),$TJ=$Tt.localToGlobal($TJ),$TV._getWrapRec([$To.x,$To.y,$TJ.x,$TJ.y])},$TZ.getGlobalPosAndScale=function($Tt){return $TZ.getGlobalRecByPoints($Tt,0,0,1,1)},$TZ.bind=function($Tt,$TM){return $Tt.bind($TM)},$TZ.measureText=function($Tt,$TM){return $TU.measureText($Tt,$TM)},$TZ.contextMeasureText=function($Tt){var $TM=$TK.context.measureText($Tt);return $TM||($TM={width:16,height:16}),$TM},$TZ.updateOrder=function($Tt){if(!$Tt||$Tt.length<2)return!1;for(var $TM,$Tf=1,$Tc=0,$TD=$Tt.length,$To=NaN;$Tf<$TD;){for($TM=$Tt[$Tc=$Tf],$To=$Tt[$Tc]._zOrder;-1<--$Tc&&$Tt[$Tc]._zOrder>$To;)$Tt[$Tc+1]=$Tt[$Tc];$Tt[$Tc+1]=$TM,$Tf++}var $TJ=$TM.parent.conchModel;if($TJ)if(null!=$TJ.updateZOrder)$TJ.updateZOrder();else{for($Tf=0;$Tf<$TD;$Tf++)$TJ.removeChild($Tt[$Tf].conchModel);for($Tf=0;$Tf<$TD;$Tf++)$TJ.addChildAt($Tt[$Tf].conchModel,$Tf)}return!0},$TZ.transPointList=function($Tt,$TM,$Tf){var $Tc=0,$TD=$Tt.length;for($Tc=0;$Tc<$TD;$Tc+=2)$Tt[$Tc]+=$TM,$Tt[$Tc+1]+=$Tf},$TZ.parseInt=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf=$TK.window.parseInt($Tt,$TM);return isNaN($Tf)?0:$Tf},$TZ.getFileExtension=function($Tt){$TZ._extReg.lastIndex=$Tt.lastIndexOf(".");var $TM=$TZ._extReg.exec($Tt);return $TM&&1<$TM.length?$TM[1].toLowerCase():null},$TZ.getTransformRelativeToWindow=function($Tt,$TM,$Tf){var $Tc=$TT.stage,$TD=laya.utils.Utils.getGlobalPosAndScale($Tt),$To=$Tc._canvasTransform.clone(),$TJ=$To.tx,$TZ=$To.ty;$To.rotate(-Math.PI/180*$TT.stage.canvasDegree),$To.scale($TT.stage.clientScaleX,$TT.stage.clientScaleY);var $TA=$TT.stage.canvasDegree%180!=0,$TL=NaN,$Tp=NaN;$TA?($TL=$Tf+$TD.y,$Tp=$TM+$TD.x,$TL*=$To.d,$Tp*=$To.a,90==$TT.stage.canvasDegree?($TL=$TJ-$TL,$Tp+=$TZ):($TL+=$TJ,$Tp=$TZ-$Tp)):($TL=$TM+$TD.x,$Tp=$Tf+$TD.y,$TL*=$To.a,$Tp*=$To.d,$TL+=$TJ,$Tp+=$TZ);var $TB=NaN,$Tb=NaN;return $Tb=$TA?($TB=$To.d*$TD.height,$To.a*$TD.width):($TB=$To.a*$TD.width,$To.d*$TD.height),{x:$TL,y:$Tp,scaleX:$TB,scaleY:$Tb}},$TZ.fitDOMElementInArea=function($Tt,$TM,$Tf,$Tc,$TD,$To){$Tt._fitLayaAirInitialized||($Tt._fitLayaAirInitialized=!0,$Tt.style.transformOrigin=$Tt.style.webKittransformOrigin="left top",$Tt.style.position="absolute");var $TJ=$TZ.getTransformRelativeToWindow($TM,$Tf,$Tc);$Tt.style.transform=$Tt.style.webkitTransform="scale("+$TJ.scaleX+","+$TJ.scaleY+") rotate("+$TT.stage.canvasDegree+"deg)",$Tt.style.width=$TD+"px",$Tt.style.height=$To+"px",$Tt.style.left=$TJ.x+"px",$Tt.style.top=$TJ.y+"px"},$TZ.isOkTextureList=function($Tt){if(!$Tt)return!1;var $TM,$Tf=0,$Tc=$Tt.length;for($Tf=0;$Tf<$Tc;$Tf++)if(!($TM=$Tt[$Tf])||!$TM.source)return!1;return!0},$TZ.isOKCmdList=function($Tt){if(!$Tt)return!1;var $TM,$Tf,$Tc=0,$TD=$Tt.length,$To=$Ts._context;for($Tc=0;$Tc<$TD;$Tc++)switch(($TM=$Tt[$Tc]).callee){case $To._drawTexture:case $To._fillTexture:case $To._drawTextureWithTransform:if(!($Tf=$TM[0])||!$Tf.source)return!1}return!0},$TZ._gid=1,$TZ._pi=180/Math.PI,$TZ._pi2=Math.PI/180,$TZ._extReg=/\.(\w+)\??/g,$TZ.parseXMLFromString=function($Tt){var $TM;if($Tt=$Tt.replace(/>\s+</g,"><"),-1<($TM=(new DOMParser).parseFromString($Tt,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($TM.firstChild.firstChild.textContent);return $TM},$TZ}(),$TQ=function(){function $Tt(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$Ts.isWebGL&&$Td.regCacheByFunction($Ta.bind(this.startDispose,this),$Ta.bind(this.getCacheList,this))}$Tp($Tt,"laya.utils.VectorGraphManager");var $TM=$Tt.prototype;return $TM.getId=function(){return this._id++},$TM.addShape=function($Tt,$TM){this.shapeDic[$Tt]=$TM,this.useDic[$Tt]||(this.useDic[$Tt]=!0)},$TM.addLine=function($Tt,$TM){this.shapeLineDic[$Tt]=$TM,this.shapeLineDic[$Tt]||(this.shapeLineDic[$Tt]=!0)},$TM.getShape=function($Tt){this._checkKey&&null!=this.useDic[$Tt]&&(this.useDic[$Tt]=!0)},$TM.deleteShape=function($Tt){this.shapeDic[$Tt]&&(this.shapeDic[$Tt]=null,delete this.shapeDic[$Tt]),this.shapeLineDic[$Tt]&&(this.shapeLineDic[$Tt]=null,delete this.shapeLineDic[$Tt]),null!=this.useDic[$Tt]&&delete this.useDic[$Tt]},$TM.getCacheList=function(){var $Tt,$TM=[];for($Tt in this.shapeDic)$TM.push(this.shapeDic[$Tt]);for($Tt in this.shapeLineDic)$TM.push(this.shapeLineDic[$Tt]);return $TM},$TM.startDispose=function($Tt){var $TM;for($TM in this.useDic)this.useDic[$TM]=!1;this._checkKey=!0},$TM.endDispose=function(){if(this._checkKey){var $Tt;for($Tt in this.useDic)this.useDic[$Tt]||this.deleteShape($Tt);this._checkKey=!1}},$Tt.getInstance=function(){return $Tt.instance=$Tt.instance||new $Tt},$Tt.instance=null,$Tt}(),$Tw=function(){function $Tc(){this._obj=null,this._obj=$Tc.supportWeakMap?new $TK.window.WeakMap:{},$Tc.supportWeakMap||$Tc._maps.push(this)}$Tp($Tc,"laya.utils.WeakObject");var $Tt=$Tc.prototype;return $Tt.set=function($Tt,$TM){if(null!=$Tt)if($Tc.supportWeakMap){var $Tf=$Tt;"string"!=typeof $Tt&&"number"!=typeof $Tt||($Tf=$Tc._keys[$Tt])||($Tf=$Tc._keys[$Tt]={k:$Tt}),this._obj.set($Tf,$TM)}else"string"==typeof $Tt||"number"==typeof $Tt?this._obj[$Tt]=$TM:($Tt.$_GID||($Tt.$_GID=$Ta.getGID()),this._obj[$Tt.$_GID]=$TM)},$Tt.get=function($Tt){if(null==$Tt)return null;if($Tc.supportWeakMap){var $TM="string"==typeof $Tt||"number"==typeof $Tt?$Tc._keys[$Tt]:$Tt;return $TM?this._obj.get($TM):null}return"string"==typeof $Tt||"number"==typeof $Tt?this._obj[$Tt]:this._obj[$Tt.$_GID]},$Tt.del=function($Tt){if(null!=$Tt)if($Tc.supportWeakMap){var $TM="string"==typeof $Tt||"number"==typeof $Tt?$Tc._keys[$Tt]:$Tt;if(!$TM)return;this._obj.delete($TM)}else"string"==typeof $Tt||"number"==typeof $Tt?delete this._obj[$Tt]:delete this._obj[this._obj.$_GID]},$Tt.has=function($Tt){if(null==$Tt)return!1;if($Tc.supportWeakMap){var $TM="string"==typeof $Tt||"number"==typeof $Tt?$Tc._keys[$Tt]:$Tt;return this._obj.has($TM)}return"string"==typeof $Tt||"number"==typeof $Tt?null!=this._obj[$Tt]:null!=this._obj[this._obj.$_GID]},$Tc.__init__=function(){($Tc.supportWeakMap=null!=$TK.window.WeakMap)||$TT.timer.loop($Tc.delInterval,null,$Tc.clearCache)},$Tc.clearCache=function(){for(var $Tt=0,$TM=$Tc._maps.length;$Tt<$TM;$Tt++){$Tc._maps[$Tt]._obj={}}},$Tc.supportWeakMap=!1,$Tc.delInterval=3e5,$Tc._keys={},$Tc._maps=[],$TA($Tc,["I",function(){return this.I=new $Tc}]),$Tc}(),$TW=function(){function $Tt(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$Tp($Tt,"laya.utils.WordText");var $TM=$Tt.prototype;return $TM.setText=function($Tt){this.changed=!0,this._text=$Tt},$TM.toString=function(){return this._text},$TM.charCodeAt=function($Tt){return this._text?this._text.charCodeAt($Tt):NaN},$TM.charAt=function($Tt){return this._text?this._text.charAt($Tt):null},$Tq(0,$TM,"length",function(){return this._text?this._text.length:0}),$Tt}(),$Ttt=function($Tt){function $TJ(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$TJ.__super.call(this),this._childs=$TJ.ARRAY_EMPTY,this._$P=$TJ.PROP_EMPTY,this.timer=$TT.scaleTimer,this.conchModel=$Ts.isConchNode?this.createConchModel():null}$Tp($TJ,"laya.display.Node",$TL);var $TM=$TJ.prototype;return $TM._setBit=function($Tt,$TM){1==$Tt&&(this._getBit($Tt)!=$TM&&this._updateDisplayedInstage());$TM?this._bits|=$Tt:this._bits&=~$Tt},$TM._getBit=function($Tt){return 0!=(this._bits&$Tt)},$TM._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$TM._setUpNoticeType=function($Tt){var $TM=this;for($TM._setBit($Tt,!0),$TM=$TM.parent;$TM;){if($TM._getBit($Tt))return;$TM._setBit($Tt,!0),$TM=$TM.parent}},$TM.on=function($Tt,$TM,$Tf,$Tc){return"display"!==$Tt&&"undisplay"!==$Tt||this._getBit(1)||this._setUpNoticeType(1),this._createListener($Tt,$TM,$Tf,$Tc,!1)},$TM.once=function($Tt,$TM,$Tf,$Tc){return"display"!==$Tt&&"undisplay"!==$Tt||this._getBit(1)||this._setUpNoticeType(1),this._createListener($Tt,$TM,$Tf,$Tc,!0)},$TM.createConchModel=function(){return null},$TM.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($Tt?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$TM.destroyChildren=function(){if(this._childs)for(var $Tt=this._childs.length-1;-1<$Tt;$Tt--)this._childs[$Tt].destroy(!0)},$TM.addChild=function($Tt){if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),$Tt._parent===this){var $TM=this.getChildIndex($Tt);$TM!==this._childs.length-1&&(this._childs.splice($TM,1),this._childs.push($Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1)),this._childChanged())}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TJ.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1),($Tt.parent=this)._childChanged();return $Tt},$TM.addChildren=function($Tt){for(var $TM=arguments,$Tf=0,$Tc=$TM.length;$Tf<$Tc;)this.addChild($TM[$Tf++])},$TM.addChildAt=function($Tt,$TM){if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),0<=$TM&&$TM<=this._childs.length){if($Tt._parent===this){var $Tf=this.getChildIndex($Tt);this._childs.splice($Tf,1),this._childs.splice($TM,0,$Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,$TM)),this._childChanged()}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TJ.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($TM,0,$Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,$TM),$Tt.parent=this;return $Tt}throw new Error("appendChildAt:The index is out of bounds")},$TM.getChildIndex=function($Tt){return this._childs.indexOf($Tt)},$TM.getChildByName=function($Tt){var $TM=this._childs;if($TM)for(var $Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){var $TD=$TM[$Tf];if($TD.name===$Tt)return $TD}return null},$TM._get$P=function($Tt){return this._$P[$Tt]},$TM._set$P=function($Tt,$TM){return this.destroyed||(this._$P===$TJ.PROP_EMPTY&&(this._$P={}),this._$P[$Tt]=$TM),$TM},$TM.getChildAt=function($Tt){return this._childs[$Tt]},$TM.setChildIndex=function($Tt,$TM){var $Tf=this._childs;if($TM<0||$TM>=$Tf.length)throw new Error("setChildIndex:The index is out of bounds.");var $Tc=this.getChildIndex($Tt);if($Tc<0)throw new Error("setChildIndex:node is must child of this object.");return $Tf.splice($Tc,1),$Tf.splice($TM,0,$Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,$TM)),this._childChanged(),$Tt},$TM._childChanged=function($Tt){},$TM.removeChild=function($Tt){if(!this._childs)return $Tt;var $TM=this._childs.indexOf($Tt);return this.removeChildAt($TM)},$TM.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$TM.removeChildByName=function($Tt){var $TM=this.getChildByName($Tt);return $TM&&this.removeChild($TM),$TM},$TM.removeChildAt=function($Tt){var $TM=this.getChildAt($Tt);if($TM){for(var $Tf=this._childs.length-1,$Tc=$Tt;$Tc<$Tf;++$Tc)this._childs[$Tc]=this._childs[$Tc+1];this._childs.length=$Tf,this.conchModel&&this.conchModel.removeChild($TM.conchModel),$TM.parent=null}return $TM},$TM.removeChildren=function($Tt,$TM){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=2147483647),this._childs&&0<this._childs.length){var $Tf=this._childs;if(0===$Tt&&$To<=$TM){var $Tc=$Tf;this._childs=$TJ.ARRAY_EMPTY}else $Tc=$Tf.splice($Tt,$TM-$Tt);for(var $TD=0,$To=$Tc.length;$TD<$To;$TD++)$Tc[$TD].parent=null,this.conchModel&&this.conchModel.removeChild($Tc[$TD].conchModel)}return this},$TM.replaceChild=function($Tt,$TM){var $Tf=this._childs.indexOf($TM);return-1<$Tf?(this._childs.splice($Tf,1,$Tt),this.conchModel&&(this.conchModel.removeChild($TM.conchModel),this.conchModel.addChildAt($Tt.conchModel,$Tf)),$TM.parent=null,$Tt.parent=this,$Tt):null},$TM._updateDisplayedInstage=function(){var $Tt;$Tt=this;var $TM=$TT.stage;for(this._displayedInStage=!1;$Tt;){if($Tt._getBit(1)){this._displayedInStage=$Tt._displayedInStage;break}if($Tt==$TM||$Tt._displayedInStage){this._displayedInStage=!0;break}$Tt=$Tt.parent}},$TM._setDisplay=function($Tt){this._displayedInStage!==$Tt&&((this._displayedInStage=$Tt)?this.event("display"):this.event("undisplay"))},$TM._displayChild=function($Tt,$TM){var $Tf=$Tt._childs;if($Tf)for(var $Tc=0;$Tc<$Tf.length;$Tc++){var $TD=$Tf[$Tc];$TD&&$TD._getBit(1)&&(0<$TD._childs.length?this._displayChild($TD,$TM):$TD._setDisplay($TM))}$Tt._setDisplay($TM)},$TM.contains=function($Tt){if($Tt===this)return!0;for(;$Tt;){if($Tt.parent===this)return!0;$Tt=$Tt.parent}return!1},$TM.timerLoop=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$TD&&($TD=!0),void 0===$To&&($To=!1),this.timer.loop($Tt,$TM,$Tf,$Tc,$TD,$To)},$TM.timerOnce=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=!0),this.timer._create(!1,!1,$Tt,$TM,$Tf,$Tc,$TD)},$TM.frameLoop=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=!0),this.timer._create(!0,!0,$Tt,$TM,$Tf,$Tc,$TD)},$TM.frameOnce=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=!0),this.timer._create(!0,!1,$Tt,$TM,$Tf,$Tc,$TD)},$TM.clearTimer=function($Tt,$TM){this.timer.clear($Tt,$TM)},$Tq(0,$TM,"numChildren",function(){return this._childs.length}),$Tq(0,$TM,"destroyed",function(){return this._destroyed}),$Tq(0,$TM,"parent",function(){return this._parent},function($Tt){this._parent!==$Tt&&($Tt?(this._parent=$Tt,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$Tt.displayedInStage&&this._displayChild(this,!0)),$Tt._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$Tt))}),$Tq(0,$TM,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$TJ.ARRAY_EMPTY=[],$TJ.PROP_EMPTY={},$TJ.NOTICE_DISPLAY=1,$TJ.MOUSEENABLE=2,$TJ}(),$TMt=function($Tt){function $Tb($Tt){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$Tb.__super.call(this),this._padding=$Tb._PADDING,this._spacing=$Tb._SPACING,this._aligns=$Tb._ALIGNS,this._font=$TI.EMPTY,this._ower=$Tt}$Tp($Tb,"laya.display.css.CSSStyle",$Tt);var $TM=$Tb.prototype;return $TM.destroy=function(){this._ower=null,this._font=null,this._rect=null},$TM.inherit=function($Tt){this._font=$Tt._font,this._spacing=$Tt._spacing===$Tb._SPACING?$Tb._SPACING:$Tt._spacing.slice(),this.lineHeight=$Tt.lineHeight},$TM._widthAuto=function(){return 0!=(262144&this._type)},$TM.widthed=function($Tt){return 0!=(8&this._type)},$TM._calculation=function($Tt,$TM){if($TM.indexOf("%")<0)return!1;var $Tc=this._ower,$TD=$Tc.parent,$To=this._rect;function $TJ($Tt,$TM,$Tf){return $Tt*$Tf[0]+$TM*$Tf[1]+$Tf[2]}function $Tf($Tt){var $TM=$TD.width,$Tf=$Tc.width;$To.width&&($Tc.width=$TJ($TM,$Tf,$To.width)),$To.height&&($Tc.height=$TJ($TM,$Tf,$To.height)),$To.left&&($Tc.x=$TJ($TM,$Tf,$To.left)),$To.top&&($Tc.y=$TJ($TM,$Tf,$To.top))}null===$To&&($TD._getCSSStyle()._type|=524288,$TD.on("resize",this,$Tf),this._rect=$To={input:{}});var $TZ=$TM.split(" ");return $TZ[0]=parseFloat($TZ[0])/100,1==$TZ.length?$TZ[1]=$TZ[2]=0:($TZ[1]=parseFloat($TZ[1])/100,$TZ[2]=parseFloat($TZ[2])),$To[$Tt]=$TZ,$To.input[$Tt]=$TM,$Tf(),!0},$TM.heighted=function($Tt){return 0!=(8192&this._type)},$TM.size=function($Tt,$TM){var $Tf=this._ower,$Tc=!1;-1!==$Tt&&$Tt!=this._ower.width&&(this._type|=8,this._ower.width=$Tt,$Tc=!0),-1!==$TM&&$TM!=this._ower.height&&(this._type|=8192,this._ower.height=$TM,$Tc=!0),$Tc&&($Tf._layoutLater(),524288&this._type&&$Tf.event("resize",this))},$TM._getAlign=function(){return this._aligns[0]},$TM._getValign=function(){return this._aligns[1]},$TM._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$TM._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $TI(this._font))},$TM.render=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.width,$To=$Tt.height;$Tf-=$Tt.pivotX,$Tc-=$Tt.pivotY,this._bgground&&null!=this._bgground.color&&$TM.ctx.fillRect($Tf,$Tc,$TD,$To,this._bgground.color),this._border&&this._border.color&&$TM.drawRect($Tf,$Tc,$TD,$To,this._border.color.strColor,this._border.size)},$TM.getCSSStyle=function(){return this},$TM.cssText=function($Tt){this.attrs($Tb.parseOneCSS($Tt,";"))},$TM.attrs=function($Tt){if($Tt)for(var $TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++){var $Tc=$Tt[$TM];this[$Tc[0]]=$Tc[1]}},$TM.setTransform=function($Tt){"none"===$Tt?this._tf=$TZ._TF_EMPTY:this.attrs($Tb.parseOneCSS($Tt,","))},$TM.translate=function($Tt,$TM){this._tf===$TZ._TF_EMPTY&&(this._tf=new $TD),this._tf.translateX=$Tt,this._tf.translateY=$TM},$TM.scale=function($Tt,$TM){this._tf===$TZ._TF_EMPTY&&(this._tf=new $TD),this._tf.scaleX=$Tt,this._tf.scaleY=$TM},$TM._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$Tq(0,$TM,"block",$Tt.prototype._$get_block,function($Tt){$Tt?this._type|=1:this._type&=-2}),$Tq(0,$TM,"valign",function(){return $Tb._valigndef[this._aligns[1]]},function($Tt){this._aligns===$Tb._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$Tb._valigndef[$Tt]}),$Tq(0,$TM,"height",null,function($Tt){if(this._type|=8192,"string"==typeof $Tt){if(this._calculation("height",$Tt))return;$Tt=parseInt($Tt)}this.size(-1,$Tt)}),$Tq(0,$TM,"width",null,function($Tt){if(this._type|=8,"string"==typeof $Tt){var $TM=$Tt.indexOf("auto");if(0<=$TM&&(this._type|=262144,$Tt=$Tt.substr(0,$TM)),this._calculation("width",$Tt))return;$Tt=parseInt($Tt)}this.size($Tt,-1)}),$Tq(0,$TM,"fontWeight",function(){return this._font.weight},function($Tt){this._createFont().weight=$Tt}),$Tq(0,$TM,"left",null,function($Tt){var $TM=this._ower;if("string"==typeof $Tt){if("center"===$Tt?$Tt="50% -50% 0":"right"===$Tt&&($Tt="100% -100% 0"),this._calculation("left",$Tt))return;$Tt=parseInt($Tt)}$TM.x=$Tt}),$Tq(0,$TM,"_translate",null,function($Tt){this.translate($Tt[0],$Tt[1])}),$Tq(0,$TM,"absolute",function(){return 0!=(4&this._type)}),$Tq(0,$TM,"top",null,function($Tt){var $TM=this._ower;if("string"==typeof $Tt){if("middle"===$Tt?$Tt="50% -50% 0":"bottom"===$Tt&&($Tt="100% -100% 0"),this._calculation("top",$Tt))return;$Tt=parseInt($Tt)}$TM.y=$Tt}),$Tq(0,$TM,"align",function(){return $Tb._aligndef[this._aligns[0]]},function($Tt){this._aligns===$Tb._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$Tb._aligndef[$Tt]}),$Tq(0,$TM,"bold",function(){return this._font.bold},function($Tt){this._createFont().bold=$Tt}),$Tq(0,$TM,"padding",function(){return this._padding},function($Tt){this._padding=$Tt}),$Tq(0,$TM,"leading",function(){return this._spacing[1]},function($Tt){"string"==typeof $Tt&&($Tt=parseInt($Tt+"")),this._spacing===$Tb._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$Tt}),$Tq(0,$TM,"lineElement",function(){return 0!=(65536&this._type)},function($Tt){$Tt?this._type|=65536:this._type&=-65537}),$Tq(0,$TM,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($Tt){this.lineElement=!1,"right"===$Tt?this._type|=32768:this._type&=-32769}),$Tq(0,$TM,"textDecoration",function(){return this._font.decoration},function($Tt){this._createFont().decoration=$Tt}),$Tq(0,$TM,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($Tt){"nowrap"===$Tt&&(this._type|=131072),"none"===$Tt&&(this._type&=-131073)}),$Tq(0,$TM,"background",null,function($Tt){$Tt?(this._bgground||(this._bgground={}),this._bgground.color=$Tt,this._ower.conchModel&&this._ower.conchModel.bgColor($Tt),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$Tq(0,$TM,"wordWrap",function(){return 0==(131072&this._type)},function($Tt){$Tt?this._type&=-131073:this._type|=131072}),$Tq(0,$TM,"color",function(){return this._font.color},function($Tt){this._createFont().color=$Tt}),$Tq(0,$TM,"password",function(){return this._font.password},function($Tt){this._createFont().password=$Tt}),$Tq(0,$TM,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($Tt){"none"===$Tt?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$Tt),this._ower.conchModel&&this._ower.conchModel.bgColor($Tt),this._ower._renderType|=256}),$Tq(0,$TM,"font",function(){return this._font.toString()},function($Tt){this._createFont().set($Tt)}),$Tq(0,$TM,"weight",null,function($Tt){this._createFont().weight=$Tt}),$Tq(0,$TM,"letterSpacing",function(){return this._spacing[0]},function($Tt){"string"==typeof $Tt&&($Tt=parseInt($Tt+"")),this._spacing===$Tb._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$Tt}),$Tq(0,$TM,"fontSize",function(){return this._font.size},function($Tt){this._createFont().size=$Tt}),$Tq(0,$TM,"italic",function(){return this._font.italic},function($Tt){this._createFont().italic=$Tt}),$Tq(0,$TM,"fontFamily",function(){return this._font.family},function($Tt){this._createFont().family=$Tt}),$Tq(0,$TM,"stroke",function(){return this._font.stroke[0]},function($Tt){this._createFont().stroke===$TI._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$Tt}),$Tq(0,$TM,"strokeColor",function(){return this._font.stroke[1]},function($Tt){this._createFont().stroke===$TI._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$Tt}),$Tq(0,$TM,"border",function(){return this._border?this._border.value:""},function($Tt){if("none"!=$Tt){this._border||(this._border={});var $TM=(this._border.value=$Tt).split(" ");if(this._border.color=$TP.create($TM[$TM.length-1]),1==$TM.length)return this._border.size=1,void(this._border.type="solid");var $Tf=0;0<$TM[0].indexOf("px")?(this._border.size=parseInt($TM[0]),$Tf++):this._border.size=1,this._border.type=$TM[$Tf],this._ower._renderType|=256}else this._border=null}),$Tq(0,$TM,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($Tt){$Tt?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$Tt?null:$TP.create($Tt),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$Tq(0,$TM,"position",function(){return 4&this._type?"absolute":""},function($Tt){"absolute"==$Tt?this._type|=4:this._type&=-5}),$Tq(0,$TM,"display",null,function($Tt){switch($Tt){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$Tq(0,$TM,"paddingLeft",function(){return this.padding[3]}),$Tq(0,$TM,"paddingTop",function(){return this.padding[0]}),$Tq(0,$TM,"_scale",null,function($Tt){this._ower.scale($Tt[0],$Tt[1])}),$Tq(0,$TM,"_rotate",null,function($Tt){this._ower.rotation=$Tt}),$Tb.parseOneCSS=function($Tt,$TM){for(var $Tf,$Tc=[],$TD=$Tt.split($TM),$To=0,$TJ=$TD.length;$To<$TJ;$To++){var $TZ=$TD[$To],$TA=$TZ.indexOf(":"),$TL=$TZ.substr(0,$TA).replace(/^\s+|\s+$/g,"");if(0!=$TL.length){var $Tp=$TZ.substr($TA+1).replace(/^\s+|\s+$/g,""),$TB=[$TL,$Tp];switch($TL){case"italic":case"bold":$TB[1]="true"==$Tp;break;case"line-height":$TB[0]="lineHeight",$TB[1]=parseInt($Tp);break;case"font-size":$TB[0]="fontSize",$TB[1]=parseInt($Tp);break;case"padding":1<($Tf=$Tp.split(" ")).length||($Tf[1]=$Tf[2]=$Tf[3]=$Tf[0]),$TB[1]=[parseInt($Tf[0]),parseInt($Tf[1]),parseInt($Tf[2]),parseInt($Tf[3])];break;case"rotate":$TB[0]="_rotate",$TB[1]=parseFloat($Tp);break;case"scale":$Tf=$Tp.split(" "),$TB[0]="_scale",$TB[1]=[parseFloat($Tf[0]),parseFloat($Tf[1])];break;case"translate":$Tf=$Tp.split(" "),$TB[0]="_translate",$TB[1]=[parseInt($Tf[0]),parseInt($Tf[1])];break;default:($TB[0]=$Tb._CSSTOVALUE[$TL])||($TB[0]=$TL)}$Tc.push($TB)}}return $Tc},$Tb.parseCSS=function($Tt,$TM){for(var $Tf;null!=($Tf=$Tb._parseCSSRegExp.exec($Tt));)$Tb.styleSheets[$Tf[1]]=$Tb.parseOneCSS($Tf[2],";")},$Tb.EMPTY=new $Tb(null),$Tb._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$Tb._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$Tb._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$Tb._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$Tb.styleSheets={},$Tb.ALIGN_CENTER=1,$Tb.ALIGN_RIGHT=2,$Tb.VALIGN_MIDDLE=1,$Tb.VALIGN_BOTTOM=2,$Tb._CSS_BLOCK=1,$Tb._DISPLAY_NONE=2,$Tb._ABSOLUTE=4,$Tb._WIDTH_SET=8,$Tb._PADDING=[0,0,0,0],$Tb._RECT=[-1,-1,-1,-1],$Tb._SPACING=[0,0],$Tb._ALIGNS=[0,0,0],$Tb.ADDLAYOUTED=512,$Tb._NEWFONT=4096,$Tb._HEIGHT_SET=8192,$Tb._BACKGROUND_SET=16384,$Tb._FLOAT_RIGHT=32768,$Tb._LINE_ELEMENT=65536,$Tb._NOWARP=131072,$Tb._WIDTHAUTO=262144,$Tb._LISTERRESZIE=524288,$Tb}($TZ),$Tft=function($Tt){function $TJ(){this.url=null,this.audio=null,this.loaded=!1,$TJ.__super.call(this)}$Tp($TJ,"laya.media.h5audio.AudioSound",$TL);var $TM=$TJ.prototype;return $TM.dispose=function(){var $Tt=$TJ._audioCache[this.url];$Tt&&($Tt.src="",delete $TJ._audioCache[this.url])},$TM.load=function($Tt){var $TM;if($Tt=$TH.formatURL($Tt),(this.url=$Tt)==$TC._tMusic?($TJ._initMusicAudio(),($TM=$TJ._musicAudio).src!=$Tt&&($TJ._audioCache[$TM.src]=null,$TM=null)):$TM=$TJ._audioCache[$Tt],$TM&&2<=$TM.readyState)this.event("complete");else{$TM||($TM=$Tt==$TC._tMusic?($TJ._initMusicAudio(),$TJ._musicAudio):$TK.createElement("audio"),($TJ._audioCache[$Tt]=$TM).src=$Tt),$TM.addEventListener("canplaythrough",$Tc),$TM.addEventListener("error",$TD);var $Tf=this;(this.audio=$TM).load?$TM.load():$TD()}function $Tc(){$To(),$Tf.loaded=!0,$Tf.event("complete")}function $TD(){$TM.load=null,$To(),$Tf.event("error")}function $To(){$TM.removeEventListener("canplaythrough",$Tc),$TM.removeEventListener("error",$TD)}},$TM.play=function($Tt,$TM,$Tf){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),!this.url)return null;var $Tc,$TD;if(!($Tc=this.url==$TC._tMusic?$TJ._musicAudio:$TJ._audioCache[this.url]))return null;$TD=$Tg.getItem("audio:"+this.url),$Ts.isConchApp?$TD||(($TD=$TK.createElement("audio")).src=this.url):this.url==$TC._tMusic?($TJ._initMusicAudio(),($TD=$TJ._musicAudio).src=this.url):$TD=$TD||$Tc.cloneNode(!0);var $To=new $Tbt($TD);return $To.url=this.url,$To.loops=$TM,$To.startTime=$Tt,$To.startHandler=$Tf,$To.play(!1),$TC.addChannel($To),$To},$Tq(0,$TM,"duration",function(){var $Tt;return($Tt=$TJ._audioCache[this.url])?$Tt.duration:0}),$TJ._initMusicAudio=function(){$TJ._musicAudio||($TJ._musicAudio||($TJ._musicAudio=$TK.createElement("audio")),$Ts.isConchApp||$TK.document.addEventListener("mousedown",$TJ._makeMusicOK))},$TJ._makeMusicOK=function(){$TK.document.removeEventListener("mousedown",$TJ._makeMusicOK),$TJ._musicAudio.src?$TJ._musicAudio.play():($TJ._musicAudio.src="",$TJ._musicAudio.load())},$TJ._audioCache={},$TJ._musicAudio=null,$TJ}(),$Tct=function($Tt){function $TM(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$TM.__super.call(this)}$Tp($TM,"laya.media.SoundChannel",$TL);var $Tf=$TM.prototype;return $Tf.play=function(){},$Tf.stop=function(){},$Tf.pause=function(){},$Tf.resume=function(){},$Tf.__runComplete=function($Tt){$Tt&&$Tt.run()},$Tq(0,$Tf,"volume",function(){return 1},function($Tt){}),$Tq(0,$Tf,"position",function(){return 0}),$Tq(0,$Tf,"duration",function(){return 0}),$TM}(),$TDt=function($Tt){function $TM(){$TM.__super.call(this)}$Tp($TM,"laya.media.Sound",$TL);var $Tf=$TM.prototype;return $Tf.load=function($Tt){},$Tf.play=function($Tt,$TM,$Tf){return void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),null},$Tf.dispose=function(){},$Tq(0,$Tf,"duration",function(){return 0}),$TM}(),$Tot=function($Tt){function $TD(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$TD.__super.call(this)}$Tp($TD,"laya.media.webaudio.WebAudioSound",$TL);var $TM=$TD.prototype;return $TM.load=function($Tt){this.url=$Tt,this.audioBuffer=$TD._dataCache[$Tt],this.audioBuffer?this._loaded(this.audioBuffer):($TD.e.on("loaded:"+$Tt,this,this._loaded),$TD.e.on("err:"+$Tt,this,this._err),$TD.__loadingSound[$Tt]||($TD.__loadingSound[$Tt]=!0,$TT.loader.load($Tt,$Te.create(this,this.onloaded),null,$TZt.BUFFER,4,!1,null,!0)))},$TM.onloaded=function($Tt){$Tt||this._err(),this._disposed?this._removeLoadEvents():(this.data=$Tt,$TD.buffs.push({buffer:this.data,url:this.url}),$TD.decode())},$TM._err=function(){if(this._removeLoadEvents(),$TD.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $Tt,$TM,$Tf,$Tc=0;for($Tt=($TM=this.__toPlays).length,$Tc=0;$Tc<$Tt;$Tc++)($Tf=$TM[$Tc])[3]&&!$Tf[3].isStopped&&$Tf[3].event("error");this.__toPlays.length=0}},$TM._loaded=function($Tt){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$Tt,this.loaded=!0,this.event("complete"))},$TM._removeLoadEvents=function(){$TD.e.off("loaded:"+this.url,this,this._loaded),$TD.e.off("err:"+this.url,this,this._err)},$TM.__playAfterLoaded=function(){if(this.__toPlays){var $Tt,$TM,$Tf,$Tc=0;for($Tt=($TM=this.__toPlays).length,$Tc=0;$Tc<$Tt;$Tc++)($Tf=$TM[$Tc])[3]&&!$Tf[3].isStopped&&this.play($Tf[0],$Tf[1],$Tf[2],$Tf[3]);this.__toPlays.length=0}},$TM.play=function($Tt,$TM,$Tf,$Tc){return void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),$Tc=$Tc||new $TIt,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$Tt,$TM,$Tf,$Tc]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$Tc.url=this.url,$Tc.loops=$TM,$Tc.audioBuffer=this.audioBuffer,$Tc.startTime=$Tt,$Tc.startHandler=$Tf,$Tc.play(!1),$TC.addChannel($Tc),$Tc},$TM.dispose=function(){this._disposed=!0,delete $TD._dataCache[this.url],delete $TD.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$Tq(0,$TM,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$TD.decode=function(){if(!($TD.buffs.length<=0||$TD.isDecoding))if($TD.isDecoding=!0,($TD.tInfo=$TD.buffs.shift())&&$TD.tInfo.buffer&&$TD.tInfo.buffer.byteLength)try{$TD.ctx.decodeAudioData($TD.tInfo.buffer,$TD._done,$TD._fail)}catch($Tt){console.error("decodeAudioData error  byteLength:"+$TD.tInfo.buffer.byteLength+"  url:"+$TD.tInfo.url)}else $TD._fail()},$TD._done=function($Tt){$TD.e.event("loaded:"+$TD.tInfo.url,$Tt),$TD._dataCache[$TD.tInfo.url]=$Tt,$TD.isDecoding=!1,$TD.decode()},$TD._fail=function(){$TD.e.event("err:"+$TD.tInfo.url,null),$TD.isDecoding=!1,$TD.decode()},$TD._playEmptySound=function(){if(null!=$TD.ctx){if($TD._emptySource&&($TD._emptySource.stop(),$TD._emptySource.disconnect(0),!$TIt._tryCleanFailed))try{$TD._emptySource.buffer=null}catch($Tt){$TIt._tryCleanFailed=!0}var $Tt=$TD.ctx.createBufferSource();$Tt.buffer=$TD._miniBuffer,$Tt.connect($TD.ctx.destination),$Tt.start(0,0,0),$TD._emptySource=$Tt}},$TD._unlock=function(){$TD._unlocked||($TD._playEmptySound(),"running"==$TD.ctx.state?($TK.document.removeEventListener("mousedown",$TD._unlock,!0),$TK.document.removeEventListener("touchend",$TD._unlock,!0),$TK.document.removeEventListener("touchstart",$TD._unlock,!0),$TD._unlocked=!0):"suspended"==$TD.ctx.state&&$TC._recoverWebAudio())},$TD.initWebAudio=function(){"running"!=$TD.ctx.state&&($TD._unlock(),$TK.document.addEventListener("mousedown",$TD._unlock,!0),$TK.document.addEventListener("touchend",$TD._unlock,!0),$TK.document.addEventListener("touchstart",$TD._unlock,!0))},$TD._emptySource=null,$TD._dataCache={},$TD.buffs=[],$TD.isDecoding=!1,$TD._unlocked=!1,$TD.tInfo=null,$TD.__loadingSound={},$TA($TD,["window",function(){return this.window=$TK.window},"webAudioEnabled",function(){return this.webAudioEnabled=$TD.window.AudioContext||$TD.window.webkitAudioContext||$TD.window.mozAudioContext},"ctx",function(){return this.ctx=$TD.webAudioEnabled?new($TD.window.AudioContext||$TD.window.webkitAudioContext||$TD.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$TD.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $TL}]),$TD}(),$TJt=function($Tt){function $TM(){this._responseType=null,this._data=null,$TM.__super.call(this),this._http=new $TK.window.XMLHttpRequest}$Tp($TM,"laya.net.HttpRequest",$TL);var $Tf=$TM.prototype;return $Tf.send=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$Tf&&($Tf="get"),void 0===$Tc&&($Tc="text"),this._responseType=$Tc,this._data=null;var $To=this,$TJ=this._http;if($TJ.open($Tf,$Tt,!0),$TD)for(var $TZ=0;$TZ<$TD.length;$TZ++)$TJ.setRequestHeader($TD[$TZ++],$TD[$TZ]);else $Ts.isConchApp||($TM&&"string"!=typeof $TM?$TJ.setRequestHeader("Content-Type","application/json"):$TJ.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$TJ.responseType="arraybuffer"!==$Tc?"text":"arraybuffer",$TJ.onerror=function($Tt){$To._onError($Tt)},$TJ.onabort=function($Tt){$To._onAbort($Tt)},$TJ.onprogress=function($Tt){$To._onProgress($Tt)},$TJ.onload=function($Tt){$To._onLoad($Tt)},$TJ.send($TM)},$Tf._onProgress=function($Tt){$Tt&&$Tt.lengthComputable&&this.event("progress",$Tt.loaded/$Tt.total)},$Tf._onAbort=function($Tt){this.error("Request was aborted by user")},$Tf._onError=function($Tt){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$Tf._onLoad=function($Tt){var $TM=this._http,$Tf=void 0!==$TM.status?$TM.status:200;200===$Tf||204===$Tf||0===$Tf?this.complete():this.error("["+$TM.status+"]"+$TM.statusText+":"+$TM.responseURL)},$Tf.error=function($Tt){this.clear(),this.event("error",$Tt)},$Tf.complete=function(){this.clear();var $TM=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$Ta.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($Tt){$TM=!1,this.error($Tt.message)}$TM&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$Tf.clear=function(){var $Tt=this._http;$Tt.onerror=$Tt.onabort=$Tt.onprogress=$Tt.onload=null},$Tq(0,$Tf,"url",function(){return this._http.responseURL}),$Tq(0,$Tf,"http",function(){return this._http}),$Tq(0,$Tf,"data",function(){return this._data}),$TM}(),$TZt=function($Tt){function $Tx(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$Tx.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$Tp($Tx,"laya.net.Loader",$TL);var $TM=$Tx.prototype;return $TM.load=function($Tt,$TM,$Tf,$Tc,$TD){if($Tt&&""!=$Tt||console.error("Loader 加载的url不合法 "+$Tt),void 0===$Tf&&($Tf=!0),void 0===$TD&&($TD=!1),0===(this._url=$Tt).indexOf("data:image")?this._type=$TM="image":this._type=$TM||($TM=this.getTypeFromUrl($Tt)),this._cache=$Tf,this._data=null,!$TD&&$Tx.loadedMap[$Tt])return this._data=$Tx.loadedMap[$Tt],this.event("progress",1),void this.event("complete",this._data);if($Tc&&$Tx.setGroup($Tt,$Tc),null!=$Tx.parserMap[$TM])return this._customParse=!0,void($Tx.parserMap[$TM]instanceof laya.utils.Handler?$Tx.parserMap[$TM].runWith(this):$Tx.parserMap[$TM].call(null,this));if("image"===$TM||"htmlimage"===$TM||"nativeimage"===$TM)return this._loadImage($Tt);if("ttf"===$TM)return this._loadTTF($Tt);switch($TM){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$TM}$Tx.preLoadedMap[$Tt]?this.onLoaded($Tx.preLoadedMap[$Tt]):$TJ.resMgrLoad($Tt,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$TM.getTypeFromUrl=function($Tt){var $TM=$Ta.getFileExtension($Tt);return $TM?$Tx.typeMap[$TM]:(console.warn("Not recognize the resources suffix",$Tt),"text")},$TM._loadTTF=function($Tt){$Tt=$TH.formatURL($Tt);var $TM=new $TS;$TM.complete=$Te.create(this,this.onLoaded),$TM.load($Tt)},$TM._loadImage=function($Tt){$TJ.imgMgrLoad($Tt,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$TM._loadImageComplete=function($Tt,$TM,$Tf){if(null!=$Tf)if($Tf instanceof ArrayBuffer){var $Tc=new DataView($Tf),$TD=new laya.webgl.resource.WebGLImage(new Uint8Array($Tf,8),$Tt,0,!1,$Tc.getUint32(0),$Tc.getUint32(4));this.onLoaded($TD)}else if($Tf instanceof $Tpt)$Tx.imgMgrSet[$Tt]=$TM,$TJ.imgMgrLock($Tt,$Tx.imgMgrSet[$Tt]),this._url=$Tt,this.complete($Tf);else{var $To=-1!=$Tt.indexOf(".png",$Tt.length-4)?6408:6407;$TD=new laya.webgl.resource.WebGLImage($Tf,$Tt,$To,!1,$Tf.width,$Tf.height);this.onLoaded($TD)}else this.event("error","Load image failed")},$TM.imageCancel=function($Tt,$TM,$Tf){$TJ.imgMgrCancel($Tt,this._onImageCallback)},$TM._loadSound=function($Tt){var $TM=new $TC._soundClass,$Tf=this;function $Tc(){$TM.offAll()}$TM.on("complete",this,function(){$Tc(),$Tf.onLoaded($TM)}),$TM.on("error",this,function(){$Tc(),$TM.dispose(),$Tf.event("error","Load sound failed")}),$TM.load($Tt)},$TM.onProgress=function($Tt){"atlas"===this._type?this.event("progress",.3*$Tt):this.event("progress",$Tt)},$TM.onError=function($Tt){this.event("error",$Tt)},$TM._loadedComplete=function($Tt,$TM,$Tf){if(null!=$Tf)switch(this._type){case"atlas":case"plf":case"json":var $Tc=new $Tj($Tf);this.onLoaded(JSON.parse($Tc.readUTFBytes()));break;case"font":$Tc=new $Tj($Tf);this.onLoaded($Ta.parseXMLFromString($Tc.readUTFBytes()));break;default:this.onLoaded($Tf)}else this.event("error",$Tt)},$TM.onLoaded=function($Tt){var $TM=this._type;if("plf"==$TM)this.parsePLFData($Tt),this.complete($Tt);else if("image"===$TM){var $Tf=new $Tpt($Tt);$Tf.url=this._url,this.complete($Tf)}else if("sound"===$TM||"htmlimage"===$TM||"nativeimage"===$TM)this.complete($Tt);else if("atlas"===$TM){if(!$Tt.src&&!$Tt._setContext){if(!this._data){if((this._data=$Tt).meta&&$Tt.meta.image)for(var $Tc=$Tt.meta.image.split(","),$TD=0<=this._url.indexOf("/")?"/":"\\",$To=this._url.lastIndexOf($TD),$TJ=0<=$To?this._url.substr(0,$To+1):"",$TZ=0,$TA=$Tc.length;$TZ<$TA;$TZ++)$Tc[$TZ]=$TJ+$Tc[$TZ];else $Tc=[this._url.replace(".json",".png")];$Tc.reverse(),$Tt.toLoads=$Tc,$Tt.pics=[]}return this.event("progress",.3+1/$Tc.length*.6),this._loadImage($Tc.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($Tt),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $TL=this._data.frames,$Tp=this._url.split("?")[0],$TB=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$Tp.substring(0,$Tp.lastIndexOf("."))+"/",$Tb=this._data.pics,$TI=$TH.formatURL(this._url),$Tq=$Tx.atlasMap[$TI]||($Tx.atlasMap[$TI]=[]);$Tq.dir=$TB;var $Tl=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $T_ in $Tl=parseFloat(this._data.meta.scale),$TL){var $TE,$Te=$TL[$T_],$TN=$Tb[$Te.frame.idx?$Te.frame.idx:0],$TX=$TH.formatURL($TB+$T_);$TN.scaleRate=$Tl,$TE=$Tpt.create($TN,$Te.frame.x,$Te.frame.y,$Te.frame.w,$Te.frame.h,$Te.spriteSourceSize.x,$Te.spriteSourceSize.y,$Te.sourceSize.w,$Te.sourceSize.h),$Tx.cacheRes($TX,$TE),$Tx.keepCache(this._url,$TB+$T_),$TE.url=$TX,$Tq.push($TX)}else for($T_ in $TL)$TN=$Tb[($Te=$TL[$T_]).frame.idx?$Te.frame.idx:0],$TX=$TH.formatURL($TB+$T_),$Tx.cacheRes($TX,$Tpt.create($TN,$Te.frame.x,$Te.frame.y,$Te.frame.w,$Te.frame.h,$Te.spriteSourceSize.x,$Te.spriteSourceSize.y,$Te.sourceSize.w,$Te.sourceSize.h)),$Tx.loadedMap[$TX].url=$TX,$Tx.keepCache(this._url,$TB+$T_),$Tq.push($TX);delete this._data.pics,this.complete(this._data)}else if("font"==$TM){if(!$Tt.src)return this._data=$Tt,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $Ty=new $TO;$Ty.parseFont(this._data,$Tt);var $Th=this._url.split(".fnt")[0].split("/"),$TT=$Th[$Th.length-1];$T_t.registerBitmapFont($TT,$Ty),this._data=$Ty,this.complete(this._data)}else if("pkm"==$TM){var $Ti=$Tht.create($Tt,this._url),$TV=new $Tpt($Ti);$TV.url=this._url,this.complete($TV)}else this.complete($Tt)},$TM.parsePLFData=function($Tt){var $TM,$Tf,$Tc;for($TM in $Tt)switch($Tc=$Tt[$TM],$TM){case"json":case"text":for($Tf in $Tc)$Tx.preLoadedMap[$TH.formatURL($Tf)]=$Tc[$Tf];break;default:for($Tf in $Tc)$Tx.preLoadedMap[$TH.formatURL($Tf)]=$Tc[$Tf]}},$TM.complete=function($Tt){this._data=$Tt,this._customParse?this.event("loaded",$Tt instanceof Array?[$Tt]:$Tt):($Tx._loaders.push(this),$Tx._isWorking||$Tx.checkNext())},$TM.endLoad=function($Tt){$Tt&&(this._data=$Tt),this._cache&&$Tx.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$Tq(0,$TM,"url",function(){return this._url}),$Tq(0,$TM,"data",function(){return this._data}),$Tq(0,$TM,"cache",function(){return this._cache}),$Tq(0,$TM,"type",function(){return this._type}),$Tx.checkNext=function(){$Tx._isWorking=!0;for(var $Tt=$TK.now();$Tx._startIndex<$Tx._loaders.length;)if($TK.now(),$Tx._loaders[$Tx._startIndex].endLoad(),$Tx._startIndex++,$TK.now()-$Tt>$Tx.maxTimeOut)return console.warn("loader callback cost a long time:"+($TK.now()-$Tt)+" url="+$Tx._loaders[$Tx._startIndex-1].url),void $TT.timer.frameOnce(1,null,$Tx.checkNext);$Tx._loaders.length=0,$Tx._startIndex=0,$Tx._isWorking=!1},$Tx.clearRes=function($Tt,$TM){if(null!=$Tt){void 0===$TM&&($TM=!1),$Tt=$TH.formatURL($Tt);var $Tf=$Tx.getAtlas($Tt);if($Tf){for(var $Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++){var $To=$Tf[$Tc],$TJ=$Tx.getRes($To);delete $Tx.loadedMap[$To],$Tx.clearCache($Tt.substring($TH.basePath.length),$To.substring($TH.basePath.length)),$TJ&&$TJ.destroy($TM)}$Tf.length=0,delete $Tx.atlasMap[$Tt],delete $Tx.loadedMap[$Tt]}else{var $TZ=$Tx.loadedMap[$Tt];$TZ&&(delete $Tx.loadedMap[$Tt],$TZ instanceof laya.resource.Texture&&$TZ.bitmap&&$TZ.destroy($TM))}}},$Tx.clearTextureRes=function($Tt){$Tt=$TH.formatURL($Tt);var $TM=laya.net.Loader.getAtlas($Tt),$Tf=$TM&&0<$TM.length?laya.net.Loader.getRes($TM[0]):laya.net.Loader.getRes($Tt);$Tf&&$Tf.bitmap&&($Ts.isConchApp&&!$Ts.isConchWebGL?$Tf.bitmap.source.releaseTexture&&$Tf.bitmap.source.releaseTexture():null==$Tf.bitmap._atlaser&&$Tf.bitmap.releaseResource(!0))},$Tx.getRes=function($Tt){return $Tx.loadedMap[$TH.formatURL($Tt)]},$Tx.getAtlas=function($Tt){return $Tx.atlasMap[$TH.formatURL($Tt)]},$Tx.cacheRes=function($Tt,$TM){$Tt=$TH.formatURL($Tt),null!=$Tx.loadedMap[$Tt]?console.warn("Resources already exist,is repeated loading:",$Tt):$Tx.loadedMap[$Tt]=$TM},$Tx.setGroup=function($Tt,$TM){$Tx.groupMap[$TM]||($Tx.groupMap[$TM]=[]),$Tx.groupMap[$TM].push($Tt)},$Tx.clearResByGroup=function($Tt){if($Tx.groupMap[$Tt]){var $TM=$Tx.groupMap[$Tt],$Tf=0,$Tc=$TM.length;for($Tf=0;$Tf<$Tc;$Tf++)$Tx.clearRes($TM[$Tf]);$TM.length=0}},$Tx.keepCache=function($Tt,$TM){if($Tt&&$TM){var $Tf=$Tx.cacheSet[$TM];$Tf?-1==$Tf.indexOf($Tt)&&$Tf.push($Tt):$Tx.cacheSet[$TM]=[$Tt]}},$Tx.clearCache=function($Tt,$TM){if($Tt&&$TM){var $Tf=$Tx.cacheSet[$TM];if($Tf){var $Tc=$Tf.indexOf($Tt);if(-1!==$Tc){var $TD=$Tf.length-1;0==$TD?(delete $Tx.cacheSet[$TM],0<$Tx.imgMgrSet[$TM]?$TJ.imgMgrFree($TM,$Tx.imgMgrSet[$TM]):$Tx.clearRes($TM,!0)):($Tf[$Tc]=$Tf[$TD],$Tf.length=$TD)}}}},$Tx.saveObject=function($Tt,$TM,$Tf){if($TM&&$Tt){var $Tc=$Tx.objectSet[$Tt];$Tc?(console.warn("Loader.saveObject: "+$Tt),$Tc[0]=$TM,$Tc[1]=$Tf):$Tx.objectSet[$Tt]=[$TM,$Tf,[]]}},$Tx.findObject=function($Tt){if($Tt){var $TM=$Tx.objectSet[$Tt];if($TM)return $TM[0]}return null},$Tx.keepObject=function($Tt,$TM){if($Tt&&$TM){var $Tf=$Tx.objectSet[$TM];$Tf&&-1===$Tf[2].indexOf($Tt)&&$Tf[2].push($Tt)}},$Tx.clearObject=function($Tt,$TM){if($Tt&&$TM){var $Tf=$Tx.objectSet[$TM];if($Tf){var $Tc=$Tf[2],$TD=$Tc.indexOf($Tt);if(-1!==$TD){var $To=$Tc.length-1;0==$To?(delete $Tx.objectSet[$TM],$Tf[1]&&$Tf[1].call(null,$Tf[0])):($Tc[$TD]=$Tc[$To],$Tc.length=$To)}}}},$Tx.TEXT="text",$Tx.JSON="json",$Tx.XML="xml",$Tx.BUFFER="arraybuffer",$Tx.IMAGE="image",$Tx.SOUND="sound",$Tx.ATLAS="atlas",$Tx.FONT="font",$Tx.TTF="ttf",$Tx.PLF="plf",$Tx.PKM="pkm",$Tx.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$Tx.parserMap={},$Tx.groupMap={},$Tx.maxTimeOut=100,$Tx.loadedMap={},$Tx.preLoadedMap={},$Tx.atlasMap={},$Tx._loaders=[],$Tx._isWorking=!1,$Tx._startIndex=0,$Tx.imgCache={},$Tx.cacheSet={},$Tx.objectSet={},$Tx.imgMgrSet={},$Tx}(),$TAt=function($Tt){var $Tb;function $TI(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$TI.__super.call(this);for(var $Tt=0;$Tt<this._maxPriority;$Tt++)this._resInfos[$Tt]=[]}$Tp($TI,"laya.net.LoaderManager",$TL);var $TM=$TI.prototype;return $TM.create=function($Tt,$Tf,$TM,$Tc,$TD,$To,$TJ,$TZ){if(null==$To&&($To=2),null==$TJ&&($TJ=!0),$Tt instanceof Array){var $TA=$Tt,$TL=$TA.length,$Tp=0;if($TM)var $TB=$Te.create($TM.caller,$TM.method,$TM.args,!1);for(var $Tb=0;$Tb<$TL;$Tb++){var $TI=$TA[$Tb];"string"==typeof $TI&&($TI=$TA[$Tb]={url:$TI}),$TI.progress=0}for($Tb=0;$Tb<$TL;$Tb++){$TI=$TA[$Tb];var $Tq=$TM?$Te.create(null,$TE,[$TI],!1):null,$Tl=$TM||$Tf?$Te.create(null,$T_,[$TI]):null;this._create($TI.url,$Tl,$Tq,$TI.clas||$Tc,$TI.params||$TD,null!=$TI.priority&&0<=$TI.priority?$TI.priority:$To,$TJ,$TI.group||$TZ)}function $T_($Tt,$TM){$Tp++,$Tt.progress=1,$Tp===$TL&&$Tf&&$Tf.run()}function $TE($Tt,$TM){$Tt.progress=$TM;for(var $Tf=0,$Tc=0;$Tc<$TL;$Tc++){$Tf+=$TA[$Tc].progress}var $TD=$Tf/$TL;$TB.runWith($TD)}return!0}return this._create($Tt,$Tf,$TM,$Tc,$TD,$To,$TJ,$TZ)},$TM._create=function($TM,$Tf,$Tt,$Tc,$TD,$To,$TJ,$TZ){$TM&&""!=$TM||console.error("加载的url不合法 "+$TM),null==$To&&($To=2),null==$TJ&&($TJ=!0);var $TA=$TH.formatURL($TM),$TL=this.getRes($TA);if($TL)!$TL.hasOwnProperty("loaded")||$TL.loaded?($Tt&&$Tt.runWith(1),$Tf&&$Tf.run()):$Tf&&$TT.loader._createListener($TM,$Tf.caller,$Tf.method,$Tf.args,!0,!1);else{var $Tp=$Ta.getFileExtension($TM),$TB=$TI.createMap[$Tp];if(!$TB)throw new Error("LoaderManager:unknown file("+$TM+") extension with: "+$Tp+".");$Tc||($Tc=$TB[0]);var $Tb=$TB[1];if("atlas"==$Tp)this.load($TM,$Tf,$Tt,$Tb,$To,$TJ);else{$Tc===$Tpt&&($Tb="htmlimage"),($TL=$Tc?new $Tc:null).hasOwnProperty("_loaded")&&($TL._loaded=!1),$TL._setUrl($TM),$TZ&&$TL._setGroup($TZ),this._createLoad($TL,$TM,$Te.create(null,function($Tt){$TL&&!$TL.destroyed&&$Tt&&$TL.onAsynLoaded.call($TL,$TM,$Tt,$TD),$Tf&&$Tf.run();$TT.loader.event($TM)}),$Tt,$Tb,$To,!1,$TZ,!0),$TJ&&this.cacheRes($TA,$TL)}}return $TL},$TM.load=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){$Tt&&""!=$Tt||console.error("加载的url不合法 "+$Tt);var $TA=this;if(null==$TD&&($TD=2),null==$To&&($To=!0),void 0===$TZ&&($TZ=!1),$Tt instanceof Array)return this._loadAssets($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ);var $TL=$TZt.getRes($Tt);if(null!=$TL)$TT.timer.frameOnce(1,null,function(){$Tf&&$Tf.runWith(1),$TM&&$TM.runWith($TL),$TA._loaderCount||$TA.event("complete")});else{var $Tp=$TI._resMap[$Tt];$Tp?($TM&&$Tp._createListener("complete",$TM.caller,$TM.method,$TM.args,!1,!1),$Tf&&$Tp._createListener("progress",$Tf.caller,$Tf.method,$Tf.args,!1,!1)):(($Tp=this._infoPool.length?this._infoPool.pop():new $Tb).url=$Tt,$Tp.clas=null,$Tp.type=$Tc,$Tp.cache=$To,$Tp.group=$TJ,$Tp.ignoreCache=$TZ,$Tp.priority=$TD,$TM&&$Tp.on("complete",$TM.caller,$TM.method,$TM.args),$Tf&&$Tp.on("progress",$Tf.caller,$Tf.method,$Tf.args),$TI._resMap[$Tt]=$Tp,$TD=$TD<this._maxPriority?0<=$TD?$TD:0:this._maxPriority-1,this._resInfos[$TD].push($Tp),this._next())}return this},$TM.cancel=function($Tt,$TM,$Tf){if($TL=$TI._resMap[$Tt]){$TM&&$TL.off("complete",$TM.caller,$TM.method,!1),$Tf&&$TL.off("progress",$Tf.caller,$Tf.method,!1);var $Tc=$TL.getListener("complete"),$TD=$TL.getListener("progress");if(!($Tc&&$Tc.head||$TD&&$TD.head)){if($TL.loader){var $To=$TL.loader;$To.imageCancel($Tt),$To.offAll(),$To._data=null,$To._customParse=!1,$To._url=null,$To._class=null,$To._type=null,this._loaders.push($To),this._loaderCount--,delete this._loaderMap[$TL.url]}for(var $TJ=0;$TJ<this._maxPriority;$TJ++)for(var $TZ=this._resInfos[$TJ],$TA=$TZ.length-1;-1<$TA;$TA--){var $TL;($TL=$TZ[$TA])&&$TL.url===$Tt&&($TZ[$TA]=null,$TL.destroy(),$TL.offAll(),this._infoPool.push($TL))}delete $TI._resMap[$Tt],this._next()}}},$TM._createLoad=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){var $TL=this;if(null==$To&&($To=2),null==$TJ&&($TJ=!0),void 0===$TA&&($TA=!1),$TM instanceof Array)return this._loadAssets($TM,$Tf,$Tc,$TD,$To,$TJ,$TZ);var $Tp=$TZt.getRes($TM);if(null!=$Tp)$TT.timer.frameOnce(1,null,function(){$Tc&&$Tc.runWith(1),$Tf&&$Tf.runWith($Tp),$TL._loaderCount||$TL.event("complete")});else{var $TB=$TI._resMap[$TM];$TB?($Tf&&$TB._createListener("complete",$Tf.caller,$Tf.method,$Tf.args,!1,!1),$Tc&&$TB._createListener("progress",$Tc.caller,$Tc.method,$Tc.args,!1,!1)):(($TB=this._infoPool.length?this._infoPool.pop():new $Tb).url=$TM,$TB.clas=$Tt,$TB.type=$TD,$TB.cache=$TJ,$TB.group=$TZ,$TB.ignoreCache=$TA,$TB.priority=$To,$Tf&&$TB.on("complete",$Tf.caller,$Tf.method,$Tf.args),$Tc&&$TB.on("progress",$Tc.caller,$Tc.method,$Tc.args),$TI._resMap[$TM]=$TB,$To=$To<this._maxPriority?0<=$To?$To:0:this._maxPriority-1,this._resInfos[$To].push($TB),this._next())}return this},$TM._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $Tt=0;$Tt<this._maxPriority;$Tt++)for(var $TM=this._resInfos[$Tt];0<$TM.length;){var $Tf=$TM.shift();if($Tf)return this._doLoad($Tf)}this._loaderCount||this.event("complete")}},$TM._doLoad=function($TM){var $Tf=this._loaders.length?this._loaders.pop():new $TZt;this._loaderCount++,(this._loaderMap[$TM.url]=$Tf).on("complete",null,$TD),$Tf.on("progress",null,function($Tt){$TM.event("progress",$Tt)}),$Tf.on("error",null,function($Tt){$TD(null)}),$TM.loader=$Tf;var $Tc=this;function $TD($Tt){$Tf.offAll(),$Tf._data=null,$Tf._customParse=!1,$Tf._url=null,$Tf._class=null,$Tf._type=null,$Tc._loaders.push($Tf),$Tc._loaderCount--,delete $Tc._loaderMap[$TM.url],$Tc._endLoad($TM,$Tt instanceof Array?[$Tt]:$Tt),$Tc._next()}$Tf._class=$TM.clas,1<=$TM.priority?($Tf.priority=$TM.priority,$Tf.realTime=!1):($Tf.priority=0,$Tf.realTime=!0),$Tf.load($TM.url,$TM.type,$TM.cache,$TM.group,$TM.ignoreCache)},$TM._endLoad=function($Tt,$TM){var $Tf=$Tt.url;if(null==$TM){var $Tc=this._failRes[$Tf]||0;if($Tc<this.retryNum)return console.warn("[warn]Retry to load:",$Tf),this._failRes[$Tf]=$Tc+1,void $TT.timer.once(this.retryDelay,this,this._addReTry,[$Tt],!1);console.warn("[error]Failed to load:",$Tf),this.event("error",$Tf)}this._failRes[$Tf]&&(this._failRes[$Tf]=0),delete $TI._resMap[$Tf],$Tt.event("complete",$TM),$Tt.destroy(),$Tt.offAll(),this._infoPool.push($Tt)},$TM._addReTry=function($Tt){this._resInfos[this._maxPriority-1].push($Tt),this._next()},$TM.clearRes=function($Tt,$TM){void 0===$TM&&($TM=!1),$TZt.clearRes($Tt,$TM)},$TM.getRes=function($Tt){return $TZt.getRes($Tt)},$TM.cacheRes=function($Tt,$TM){$TZt.cacheRes($Tt,$TM)},$TM.clearTextureRes=function($Tt){$TZt.clearTextureRes($Tt)},$TM.setGroup=function($Tt,$TM){$TZt.setGroup($Tt,$TM)},$TM.clearResByGroup=function($Tt){$TZt.clearResByGroup($Tt)},$TM.clearUnLoaded=function(){for(var $Tt=0;$Tt<this._maxPriority;$Tt++){for(var $TM=this._resInfos[$Tt],$Tf=$TM.length-1;-1<$Tf;$Tf--){var $Tc=$TM[$Tf];$Tc&&($Tc.destroy(),$Tc.offAll(),this._infoPool.push($Tc))}$TM.length=0}this._loaderCount=0,$TI._resMap={}},$TM.cancelLoadByUrls=function($Tt){if($Tt)for(var $TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++)this.cancelLoadByUrl($Tt[$TM])},$TM.cancelLoadByUrl=function($Tt){for(var $TM=0;$TM<this._maxPriority;$TM++)for(var $Tf=this._resInfos[$TM],$Tc=$Tf.length-1;-1<$Tc;$Tc--){var $TD=$Tf[$Tc];$TD&&$TD.url===$Tt&&($Tf[$Tc]=null,$TD.destroy(),$TD.offAll(),this._infoPool.push($TD))}$TI._resMap[$Tt]&&delete $TI._resMap[$Tt]},$TM._loadAssets=function($Tt,$Tf,$TJ,$TM,$Tc,$TD,$To){null==$Tc&&($Tc=2),null==$TD&&($TD=!0);for(var $TZ=$Tt.length,$TA=0,$TL=0,$Tp=[],$TB=!0,$Tb=0;$Tb<$TZ;$Tb++){var $TI=$Tt[$Tb];if(!$TI)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$Tt);"string"==typeof $TI&&($TI={url:$TI,type:$TM,size:1,priority:$Tc}),$TI.size||($TI.size=1),$TI.progress=0,$TL+=$TI.size,$Tp.push($TI);var $Tq=$TJ?$Te.create(null,$TE,[$TI],!1):null,$Tl=$Tf||$TJ?$Te.create(null,$T_,[$TI]):null;this.load($TI.url,$Tl,$Tq,$TI.type,null!=$TI.priority&&0<=$TI.priority?$TI.priority:2,$TD,$TI.group||$To)}function $T_($Tt,$TM){$TA++,$Tt.progress=1,$TM||($TB=!1),$TA===$TZ&&$Tf&&$Tf.runWith($TB)}function $TE($Tt,$TM){if(null!=$TJ){$Tt.progress=$TM;for(var $Tf=0,$Tc=0;$Tc<$Tp.length;$Tc++){var $TD=$Tp[$Tc];$Tf+=$TD.size*$TD.progress}var $To=$Tf/$TL;$TJ.runWith($To)}}return this},$TI.cacheRes=function($Tt,$TM){$TZt.cacheRes($Tt,$TM)},$TI._resMap={},$TA($TI,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$TI.__init$=function(){$Tb=function($Tt){function $TM(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$TM.__super.call(this)}return $Tp($TM,"",$TL),$TM.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$TM}()},$TI}(),$TLt=(function($Tt){function $TD($Tt){$TD.__super.call(this),$Tt||($Tt=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $TM=0,$Tf=0,$Tc=0;$Tc<20;$Tc++)$Tc%5!=4?this._mat[$TM++]=$Tt[$Tc]:this._alpha[$Tf++]=$Tt[$Tc];this._action=$TU.createFilterAction(32),this._action.data=this}$Tp($TD,"laya.filters.ColorFilter",$TE);var $TM=$TD.prototype;$TT.imps($TM,{"laya.filters.IFilter":!0}),$TM.callNative=function($Tt){$Tt._$P.cf=this;$Tt.conchModel&&$Tt.conchModel.setFilterMatrix&&$Tt.conchModel.setFilterMatrix(this._mat,this._alpha)},$Tq(0,$TM,"type",function(){return 32}),$Tq(0,$TM,"action",function(){return this._action})}(),function($Tt){function $Tc($Tt,$TM,$Tf){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$TM&&($TM=0),$Tc.__super.call(this),this._byteClass=$Tf||$Tj,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$Tt&&0<$TM&&$TM<65535&&this.connect($Tt,$TM)}$Tp($Tc,"laya.net.Socket",$TL);var $TM=$Tc.prototype;$TM.connect=function($Tt,$TM){var $Tf="ws://"+$Tt+":"+$TM;$Tf="https:"==$TK.window.location.protocol?"wss://"+$Tt+":"+$TM:"ws://"+$Tt+":"+$TM,this.connectByUrl($Tf)},$TM.connectByUrl=function($Tt){var $TM=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $TK.window.WebSocket($Tt,this.protocols):this._socket=new $TK.window.WebSocket($Tt),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($Tt){$TM._onOpen($Tt)},this._socket.onmessage=function($Tt){$TM._onMessage($Tt)},this._socket.onclose=function($Tt){$TM._onClose($Tt)},this._socket.onerror=function($Tt){$TM._onError($Tt)}},$TM.cleanSocket=function(){try{this._socket.close()}catch($Tt){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$TM.close=function(){if(null!=this._socket)try{this._socket.close()}catch($Tt){}},$TM._onOpen=function($Tt){this._connected=!0,this.event("open",$Tt)},$TM._onMessage=function($Tt){if($Tt&&$Tt.data){var $TM=$Tt.data;if(this.disableInput&&$TM)this.event("message",$TM);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $Tf=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$TM&&("string"==typeof $TM?this._input.writeUTFBytes($TM):this._input.writeArrayBuffer($TM),this._addInputPosition=this._input.pos,this._input.pos=$Tf),this.event("message",$TM)}}},$TM._onClose=function($Tt){this._connected=!1,this.event("close",$Tt)},$TM._onError=function($Tt){this.event("error",$Tt)},$TM.send=function($Tt){this._socket.send($Tt)},$TM.flush=function(){if(this._output&&0<this._output.length){var $TM;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($Tt){$TM=$Tt}this._output.endian=this.endian,this._output.clear(),$TM&&this.event("error",$TM)}},$Tq(0,$TM,"input",function(){return this._input}),$Tq(0,$TM,"output",function(){return this._output}),$Tq(0,$TM,"connected",function(){return this._connected}),$Tq(0,$TM,"endian",function(){return this._endian},function($Tt){this._endian=$Tt,null!=this._input&&(this._input.endian=$Tt),null!=this._output&&(this._output.endian=$Tt)}),$Tc.LITTLE_ENDIAN="littleEndian",$Tc.BIG_ENDIAN="bigEndian"}(),function($Tt){function $TZ(){$TZ.__super.call(this),this._$1__id=++$TZ._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($TZ._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$Tk.currentResourceManager&&$Tk.currentResourceManager.addResource(this)}$Tp($TZ,"laya.resource.Resource",$TL);var $TM=$TZ.prototype;return $TT.imps($TM,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$TM._setUrl=function($Tt){var $TM;this._url!==$Tt&&(this._url&&(($TM=$TZ._urlResourcesMap[this._url]).splice($TM.indexOf(this),1),0===$TM.length&&delete $TZ._urlResourcesMap[this._url]),$Tt&&(($TM=$TZ._urlResourcesMap[$Tt])||($TZ._urlResourcesMap[$Tt]=$TM=[]),$TM.push(this)),this._url=$Tt)},$TM._getGroup=function(){return this._group},$TM._setGroup=function($Tt){var $TM;this._group!==$Tt&&(this._group&&(($TM=$TZ._groupResourcesMap[this._group]).splice($TM.indexOf(this),1),0===$TM.length&&delete $TZ._groupResourcesMap[this._group]),$Tt&&(($TM=$TZ._groupResourcesMap[$Tt])||($TZ._groupResourcesMap[$Tt]=$TM=[]),$TM.push(this)),this._group=$Tt)},$TM._addReference=function(){this._referenceCount++},$TM._removeReference=function(){this._referenceCount--},$TM._clearReference=function(){this._referenceCount=0},$TM._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$TM.recreateResource=function(){this.completeCreate()},$TM.disposeResource=function(){},$TM.activeResource=function($Tt){void 0===$Tt&&($Tt=!1),this._lastUseFrameCount=$Tz.loopCount,!this._destroyed&&this.__loaded&&(this._released||$Tt)&&this.recreateResource()},$TM.releaseResource=function($Tt){return void 0===$Tt&&($Tt=!0),!(!$Tt&&this.lock)&&(!(this._released&&!$Tt)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$TM.onAsynLoaded=function($Tt,$TM,$Tf){throw new Error("Resource: must override this function!")},$TM.destroy=function(){var $Tt;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $TZ._idResourcesMap[this.id],this._url&&(($Tt=$TZ._urlResourcesMap[this._url])&&($Tt.splice($Tt.indexOf(this),1),0===$Tt.length&&delete $TZ._urlResourcesMap[this.url]),$TZt.clearRes(this._url),this.__loaded||$TU.cancelLoadByUrl(this._url)),this._group&&(($Tt=$TZ._groupResourcesMap[this._group]).splice($Tt.indexOf(this),1),0===$Tt.length&&delete $TZ._groupResourcesMap[this.url]))},$TM.completeCreate=function(){this._released=!1,this.event("recovered",this)},$TM.dispose=function(){this.destroy()},$Tq(0,$TM,"memorySize",function(){return this._memorySize},function($Tt){var $TM=$Tt-this._memorySize;this._memorySize=$Tt,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$TM),this.resourceManager&&this.resourceManager.addSize($TM)}),$Tq(0,$TM,"_loaded",null,function($Tt){this.__loaded=$Tt}),$Tq(0,$TM,"loaded",function(){return this.__loaded}),$Tq(0,$TM,"id",function(){return this._$1__id}),$Tq(0,$TM,"destroyed",function(){return this._destroyed}),$Tq(0,$TM,"group",function(){return this._getGroup()},function($Tt){this._setGroup($Tt)}),$Tq(0,$TM,"resourceManager",function(){return this._resourceManager}),$Tq(0,$TM,"url",function(){return this._url}),$Tq(0,$TM,"released",function(){return this._released}),$Tq(0,$TM,"referenceCount",function(){return this._referenceCount}),$TZ.getResourceByID=function($Tt){return $TZ._idResourcesMap[$Tt]},$TZ.getResourceByURL=function($Tt,$TM){return void 0===$TM&&($TM=0),null==$TZ._urlResourcesMap[$Tt]?null:$TZ._urlResourcesMap[$Tt][$TM]},$TZ.getResourceCountByURL=function($Tt){return $TZ._urlResourcesMap[$Tt].length},$TZ.destroyUnusedResources=function($Tt){var $TM;if($Tt){var $Tf=$TZ._groupResourcesMap[$Tt];if($Tf)for(var $Tc=$Tf.slice(),$TD=0,$To=$Tc.length;$TD<$To;$TD++)($TM=$Tc[$TD]).lock||0!==$TM._referenceCount||$TM.destroy()}else for(var $TJ in $TZ._idResourcesMap)($TM=$TZ._idResourcesMap[$TJ]).lock||0!==$TM._referenceCount||$TM.destroy()},$TZ._uniqueIDCounter=0,$TZ._idResourcesMap={},$TZ._urlResourcesMap={},$TZ._groupResourcesMap={},$TZ}()),$Tpt=function($Tt){function $Tx($Tt,$TM){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$Tx.__super.call(this),$Tt&&null!=$Tt._addReference&&$Tt._addReference(),this.setTo($Tt,$TM)}$Tp($Tx,"laya.resource.Texture",$TL);var $TM=$Tx.prototype;return $TM._setUrl=function($Tt){this.url=$Tt},$TM.setTo=function($Tt,$TM){if($Tt instanceof $TJ.HTMLElement){var $Tf=$TNt.create("2D",$Tt);this.bitmap=$Tf}else this.bitmap=$Tt;if(this.uv=$TM||$Tx.DEF_UV,$Tt){this._w=$Tt.width,this._h=$Tt.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $Tc=this;if(this._loaded)$TU.addToAtlas&&$TU.addToAtlas($Tc);else{var $TD=$Tt;$TD instanceof laya.resource.HTMLImage&&$TD.image&&$TD.image.addEventListener("load",function($Tt){$TU.addToAtlas&&$TU.addToAtlas($Tc)},!1)}}},$TM.active=function(){this.bitmap&&this.bitmap.activeResource()},$TM.destroy=function($Tt){if(void 0===$Tt&&($Tt=!1),this.alphaTexture&&(this.alphaTexture.destroy($Tt),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $TM=this.bitmap;$Tt?($Ts.isConchApp&&$TM.source&&$TM.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$TM.dispose(),$TM._clearReference()):($TM._removeReference(),0==$TM.referenceCount&&($Ts.isConchApp&&$TM.source&&$TM.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$TM.dispose())),this.url&&this===$TT.loader.getRes(this.url)&&$TT.loader.clearRes(this.url,$Tt),this._loaded=!1}},$TM.load=function($Tt){var $TM=this;this._loaded=!1,$Tt=$TH.customFormat($Tt);var $Tf=this.bitmap||(this.bitmap=$Tht.create($Tt));$Tf.uri=$Tt,$Tf&&$Tf._addReference();var $Tc=this;$Tf.onload=function(){$Tf.onload=null,$Tc._loaded=!0,$TM.sourceWidth=$TM._w=$Tf.width,$TM.sourceHeight=$TM._h=$Tf.height,$Tc.event("loaded",this),$TU.addToAtlas&&$TU.addToAtlas($Tc)}},$TM.addTextureToAtlas=function($Tt){$TU.addTextureToAtlas(this)},$TM.getPixels=function($Tt,$TM,$Tf,$Tc){if($Ts.isConchApp){var $TD=this.bitmap;if($TD.source&&$TD.source.getImageData){var $To=$TD.source.getImageData($Tt,$TM,$Tf,$Tc),$TJ=new Uint8Array($To);return Array.from($TJ)}return null}return $Ts.isWebGL?$TU.getTexturePixels(this,$Tt,$TM,$Tf,$Tc):($TK.canvas.size($Tf,$Tc),$TK.canvas.clear(),$TK.context.drawTexture(this,-$Tt,-$TM,this.width,this.height,0,0),$TK.context.getImageData(0,0,$Tf,$Tc).data)},$TM.onAsynLoaded=function($Tt,$TM){if($TM){if("function"!=typeof $TM._addReference)throw new Error("bitmap._addReference is not a function. "+$TM.className+" "+typeof $TM._addReference+" "+$TM.constructor);$TM._addReference()}this.setTo($TM,this.uv),this._loaded&&this.event("loaded",this)},$Tq(0,$TM,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$Tq(0,$TM,"loaded",function(){return this._loaded}),$Tq(0,$TM,"released",function(){return!this.bitmap||this.bitmap.released}),$Tq(0,$TM,"width",function(){return this._w?this._w:this.uv&&this.uv!==$Tx.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($Tt){this._w=$Tt,this.sourceWidth||(this.sourceWidth=$Tt)}),$Tq(0,$TM,"repeat",function(){return!$Ts.isWebGL||!this.bitmap||this.bitmap.repeat},function($Tt){$Tt&&$Ts.isWebGL&&this.bitmap&&(this.bitmap.repeat=$Tt)&&(this.bitmap.enableMerageInAtlas=!1)}),$Tq(0,$TM,"height",function(){return this._h?this._h:this.uv&&this.uv!==$Tx.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($Tt){this._h=$Tt,this.sourceHeight||(this.sourceHeight=$Tt)}),$Tq(0,$TM,"isLinearSampling",function(){return!$Ts.isWebGL||9728!=this.bitmap.minFifter},function($Tt){!$Tt&&$Ts.isWebGL&&($Tt||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$Tx.moveUV=function($Tt,$TM,$Tf){for(var $Tc=0;$Tc<8;$Tc+=2)$Tf[$Tc]+=$Tt,$Tf[$Tc+1]+=$TM;return $Tf},$Tx.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){void 0===$To&&($To=0),void 0===$TJ&&($TJ=0),void 0===$TZ&&($TZ=0),void 0===$TA&&($TA=0);var $TL=$Tt instanceof laya.resource.Texture,$Tp=$TL?$Tt.uv:$Tx.DEF_UV,$TB=$TL?$Tt.bitmap:$Tt,$Tb=$TU.isAtlas($TB);if($Tb){var $TI=$TB._atlaser,$Tq=$Tt._atlasID;if(-1==$Tq)throw new Error("create texture error");$TB=$TI._inAtlasTextureBitmapValue[$Tq],$Tp=$TI._inAtlasTextureOriUVValue[$Tq]}var $Tl=new $Tx($TB,null);$TB.width&&$TM+$Tc>$TB.width&&($Tc=$TB.width-$TM),$TB.height&&$Tf+$TD>$TB.height&&($TD=$TB.height-$Tf),$Tl.width=$Tc,$Tl.height=$TD,$Tl.offsetX=$To,$Tl.offsetY=$TJ,$Tl.sourceWidth=$TZ||$Tc,$Tl.sourceHeight=$TA||$TD;var $T_=1/$TB.width,$TE=1/$TB.height;$TM*=$T_,$Tf*=$TE,$Tc*=$T_,$TD*=$TE;var $Te=$Tl.uv[0],$TN=$Tl.uv[1],$TX=$Tl.uv[4],$Ty=$Tl.uv[5],$Th=$TX-$Te,$TT=$Ty-$TN,$Ti=$Tx.moveUV($Tp[0],$Tp[1],[$TM,$Tf,$TM+$Tc,$Tf,$TM+$Tc,$Tf+$TD,$TM,$Tf+$TD]);$Tl.uv=[$Te+$Ti[0]*$Th,$TN+$Ti[1]*$TT,$TX-(1-$Ti[2])*$Th,$TN+$Ti[3]*$TT,$TX-(1-$Ti[4])*$Th,$Ty-(1-$Ti[5])*$TT,$Te+$Ti[6]*$Th,$Ty-(1-$Ti[7])*$TT],$Tb&&$Tl.addTextureToAtlas();var $TV=$TB.scaleRate;return $TV&&1!=$TV?($Tl.sourceWidth/=$TV,$Tl.sourceHeight/=$TV,$Tl.width/=$TV,$Tl.height/=$TV,$Tl.scaleRate=$TV,$Tl.offsetX/=$TV,$Tl.offsetY/=$TV):$Tl.scaleRate=1,$Tl},$Tx.createFromTexture=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tt.scaleRate;1!=$To&&($TM*=$To,$Tf*=$To,$Tc*=$To,$TD*=$To);var $TJ=$TV.TEMP.setTo($TM-$Tt.offsetX,$Tf-$Tt.offsetY,$Tc,$TD),$TZ=$TJ.intersection($Tx._rect1.setTo(0,0,$Tt.width,$Tt.height),$Tx._rect2);if(!$TZ)return null;var $TA=$Tx.create($Tt,$TZ.x,$TZ.y,$TZ.width,$TZ.height,$TZ.x-$TJ.x,$TZ.y-$TJ.y,$Tc,$TD);if($TA.bitmap&&$TA.bitmap._removeReference)return $TA.bitmap._removeReference(),$TA;var $TL="bitmap:"+($TA.bitmap?$TA.bitmap.constructor?$TA.bitmap.constructor.name:$TA.bitmap.__className:"")+", url:"+($Tt.url+" | "+($TA.bitmap?$TA.bitmap.url:$Tt.url))+", x="+$TM+",y="+$Tf+",width="+$Tc+",height="+$TD+", result="+($TZ?$TZ.x+","+$TZ.y+","+$TZ.width+","+$TZ.height:"null")+", rect="+$TJ.x+","+$TJ.y+","+$TJ.width+","+$TJ.height;throw new Error("报错：bitmap._removeReference is not a function  "+$TL)},$Tx.DEF_UV=[0,0,1,0,1,1,0,1],$Tx.INV_UV=[0,1,1,1,1,0,0,0],$Tx._rect1=new $TV,$Tx._rect2=new $TV,$Tx}(),$Tt=function($Tt){var $TZ;function $To(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$To.__super.call(this)}$Tp($To,"laya.utils.TimeLine",$TL);var $TM=$To.prototype;return $TM.to=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=0),this._create($Tt,$TM,$Tf,$Tc,$TD,!0)},$TM.from=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=0),this._create($Tt,$TM,$Tf,$Tc,$TD,!1)},$TM._create=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$Tg.getItemByClass("tweenData",$TZ);return $TJ.isTo=$To,$TJ.type=0,$TJ.target=$Tt,$TJ.duration=$Tf,$TJ.data=$TM,$TJ.startTime=this._startTime+$TD,$TJ.endTime=$TJ.startTime+$TJ.duration,$TJ.ease=$Tc,this._startTime=Math.max($TJ.endTime,this._startTime),this._tweenDataList.push($TJ),this._startTimeSort=!0,this._endTimeSort=!0,this},$TM.addLabel=function($Tt,$TM){var $Tf=$Tg.getItemByClass("tweenData",$TZ);return $Tf.type=1,$Tf.data=$Tt,$Tf.endTime=$Tf.startTime=this._startTime+$TM,this._labelDic||(this._labelDic={}),this._labelDic[$Tt]=$Tf,this._tweenDataList.push($Tf),this},$TM.removeLabel=function($Tt){if(this._labelDic&&this._labelDic[$Tt]){var $TM=this._labelDic[$Tt];if($TM){var $Tf=this._tweenDataList.indexOf($TM);-1<$Tf&&this._tweenDataList.splice($Tf,1)}delete this._labelDic[$Tt]}},$TM.gotoTime=function($Tt){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $TM,$Tf,$Tc,$TD;for(var $To in this._firstTweenDic)if($Tf=this._firstTweenDic[$To])for(var $TJ in $Tf)$Tf.diyTarget.hasOwnProperty($TJ)&&($Tf.diyTarget[$TJ]=$Tf[$TJ]);for($To in this._tweenDic)($TM=this._tweenDic[$To]).clear(),delete this._tweenDic[$To];if(this._index=0,this._gidIndex=0,this._currTime=$Tt,this._lastTime=$TK.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$Tc=this._tweenDataList.concat(),$Tc.sort(function($Tt,$TM){return $Tt.endTime>$TM.endTime?1:$Tt.endTime<$TM.endTime?-1:0})}else $Tc=this._endTweenDataList;for(var $TZ=0,$TA=$Tc.length;$TZ<$TA;$TZ++)if(0==($TD=$Tc[$TZ]).type){if(!($Tt>=$TD.endTime))break;this._index=Math.max(this._index,$TZ+1);var $TL=$TD.data;if($TD.isTo)for(var $Tp in $TL)$TD.target[$Tp]=$TL[$Tp]}for($TZ=0,$TA=this._tweenDataList.length;$TZ<$TA;$TZ++)0==($TD=this._tweenDataList[$TZ]).type&&$Tt>=$TD.startTime&&$Tt<$TD.endTime&&(this._index=Math.max(this._index,$TZ+1),this._gidIndex++,($TM=$Tg.getItemByClass("tween",$TG))._create($TD.target,$TD.data,$TD.duration,$TD.ease,$Te.create(this,this._animComplete,[this._gidIndex]),0,!1,$TD.isTo,!0,!1),$TM.setStartTime(this._currTime-($Tt-$TD.startTime)),$TM._updateEase(this._currTime),$TM.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$TM)}},$TM.gotoLabel=function($Tt){if(null!=this._labelDic){var $TM=this._labelDic[$Tt];$TM&&this.gotoTime($TM.startTime)}},$TM.pause=function(){$TT.timer.clear(this,this._update)},$TM.resume=function(){this.play(this._currTime,this._loopKey)},$TM.play=function($Tt,$TM){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($Tt,$TM){return $Tt.startTime>$TM.startTime?1:$Tt.startTime<$TM.startTime?-1:0});for(var $Tf=0,$Tc=this._tweenDataList.length;$Tf<$Tc;$Tf++){var $TD=this._tweenDataList[$Tf];if(null!=$TD&&0==$TD.type){var $To=$TD.target,$TJ=$To.$_GID||($To.$_GID=$Ta.getGID()),$TZ=null;for(var $TA in null==this._firstTweenDic[$TJ]?(($TZ={}).diyTarget=$To,this._firstTweenDic[$TJ]=$TZ):$TZ=this._firstTweenDic[$TJ],$TD.data)null==$TZ[$TA]&&($TZ[$TA]=$To[$TA])}}}"string"==typeof $Tt?this.gotoLabel($Tt):this.gotoTime($Tt),this._loopKey=$TM,this._lastTime=$TK.now(),$TT.timer.frameLoop(1,this,this._update)}},$TM._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $Tt in this._tweenDic)($TM=this._tweenDic[$Tt]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $TM,$Tf=$TK.now(),$Tc=$Tf-this._lastTime,$TD=this._currTime+=$Tc*this.scale;for($Tt in this._lastTime=$Tf,this._tweenDic)($TM=this._tweenDic[$Tt])._updateEase($TD);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $To=this._tweenDataList[this._index];$TD>=$To.startTime&&(this._index++,0==$To.type?(this._gidIndex++,($TM=$Tg.getItemByClass("tween",$TG))._create($To.target,$To.data,$To.duration,$To.ease,$Te.create(this,this._animComplete,[this._gidIndex]),0,!1,$To.isTo,!0,!1),$TM.setStartTime($TD),$TM.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$TM)._updateEase($TD)):this.event("label",$To.data))}},$TM._animComplete=function($Tt){this._tweenDic[$Tt]&&delete this._tweenDic[$Tt]},$TM._complete=function(){this.event("complete")},$TM.reset=function(){var $Tt;if(this._labelDic)for($Tt in this._labelDic)delete this._labelDic[$Tt];for($Tt in this._tweenDic)this._tweenDic[$Tt].clear(),delete this._tweenDic[$Tt];for($Tt in this._firstTweenDic)delete this._firstTweenDic[$Tt];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $TM,$Tf=0;for($TM=this._tweenDataList.length,$Tf=0;$Tf<$TM;$Tf++)this._tweenDataList[$Tf]&&this._tweenDataList[$Tf].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$TT.timer.clear(this,this._update)},$TM.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$Tq(0,$TM,"index",function(){return this._frameIndex},function($Tt){this._frameIndex=$Tt,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$Tq(0,$TM,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$To.to=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=0),(new $To).to($Tt,$TM,$Tf,$Tc,$TD)},$To.from=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$TD&&($TD=0),(new $To).from($Tt,$TM,$Tf,$Tc,$TD)},$To.__init$=function(){$TZ=function(){function $Tt(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $Tp($Tt,""),$Tt.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$Tg.recover("tweenData",this)},$Tt}()},$To}(),$TBt=function($TD){function $Tf(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$Tf.__super.call(this),this._style=$TZ.EMPTY}$Tp($Tf,"laya.display.Sprite",$TD);var $Tt=$Tf.prototype;return $TT.imps($Tt,{"laya.display.ILayout":!0}),$Tt.createConchModel=function(){return new ConchNode},$Tt.destroy=function($Tt){if(void 0===$Tt&&($Tt=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $TM=this.mask;$TM&&(this.mask=null,$TM.destroy($Tt))}$TD.prototype.destroy.call(this,$Tt),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$Tt.updateZOrder=function(){$Ta.updateOrder(this._childs)&&this.repaint()},$Tt.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$Tt.setBounds=function($Tt){this._set$P("uBounds",$Tt)},$Tt.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $TV),$TV._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$Tt.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $TV),$TV._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$Tt._boundPointsToParent=function($Tt){void 0===$Tt&&($Tt=!1);var $TM=0,$Tf=0;this._style&&($TM=this._style._tf.translateX,$Tf=this._style._tf.translateY,$Tt=$Tt||0!==this._style._tf.rotate,this._style.scrollRect&&($TM+=this._style.scrollRect.x,$Tf+=this._style.scrollRect.y));var $Tc=this._getBoundPointsM($Tt);if(!$Tc||$Tc.length<1)return $Tc;if(8!=$Tc.length&&($Tc=$Tt?$Ty.scanPList($Tc):$TV._getWrapRec($Tc,$TV.TEMP)._getBoundPoints()),!this.transform)return $Ta.transPointList($Tc,this._x-$TM,this._y-$Tf),$Tc;var $TD=$Ti.TEMP,$To=0,$TJ=$Tc.length;for($To=0;$To<$TJ;$To+=2)$TD.x=$Tc[$To],$TD.y=$Tc[$To+1],this.toParentPoint($TD),$Tc[$To]=$TD.x,$Tc[$To+1]=$TD.y;return $Tc},$Tt.getGraphicBounds=function($Tt){return void 0===$Tt&&($Tt=!1),this._graphics?this._graphics.getBounds($Tt):$TV.TEMP.setTo(0,0,0,0)},$Tt._getBoundPointsM=function($Tt){if(void 0===$Tt&&($Tt=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $TM=$Ta.clearArray(this._$P.temBM),$Tf=$TV.TEMP;return $Tf.copyFrom(this.scrollRect),$Ta.concatArray($TM,$Tf._getBoundPoints()),$TM}for(var $Tc,$TD,$To,$TJ=this._graphics?this._graphics.getBoundPoints():$Ta.clearArray(this._$P.temBM),$TZ=0,$TA=($To=this._childs).length;$TZ<$TA;$TZ++)($Tc=$To[$TZ])instanceof laya.display.Sprite&&1==$Tc.visible&&($TD=$Tc._boundPointsToParent($Tt))&&($TJ=$TJ?$Ta.concatArray($TJ,$TD):$TD);return $TJ},$Tt.getStyle=function(){return this._style===$TZ.EMPTY&&(this._style=new $TZ),this._style},$Tt.setStyle=function($Tt){this._style=$Tt},$Tt._adjustTransform=function(){this._tfChanged=!1;var $Tt,$TM=this._style._tf,$Tf=$TM.scaleX,$Tc=$TM.scaleY;if($TM.rotate||1!==$Tf||1!==$Tc||$TM.skewX||$TM.skewY){($Tt=this._transform||(this._transform=$TF.create())).bTransform=!0;var $TD=.0174532922222222*($TM.rotate-$TM.skewX),$To=.0174532922222222*($TM.rotate+$TM.skewY),$TJ=Math.cos($To),$TZ=Math.sin($To),$TA=Math.sin($TD),$TL=Math.cos($TD);return $Tt.a=$Tf*$TJ,$Tt.b=$Tf*$TZ,$Tt.c=-$Tc*$TA,$Tt.d=$Tc*$TL,$Tt.tx=$Tt.ty=0,$Tt}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$Tt},$Tt.pos=function($Tt,$TM,$Tf){if(void 0===$Tf&&($Tf=!1),this._x!==$Tt||this._y!==$TM){if(this.destroyed)return this;if($Tf){this._x=$Tt,this._y=$TM,this.conchModel&&this.conchModel.pos(this._x,this._y);var $Tc=this._parent;$Tc&&0===$Tc._repaint&&($Tc._repaint=1,$Tc.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$Tt,this.y=$TM}return this},$Tt.pivot=function($Tt,$TM){return this.pivotX=$Tt,this.pivotY=$TM,this},$Tt.size=function($Tt,$TM){return this.width=$Tt,this.height=$TM,this},$Tt.scale=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=!1);var $Tc=this.getStyle(),$TD=$Tc._tf;if($TD.scaleX!=$Tt||$TD.scaleY!=$TM){if(this.destroyed)return this;if($Tf){$Tc.setScale($Tt,$TM),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Tt,$TM),this._renderType|=4;var $To=this._parent;$To&&0===$To._repaint&&($To._repaint=1,$To.parentRepaint())}else this.scaleX=$Tt,this.scaleY=$TM}return this},$Tt.skew=function($Tt,$TM){return this.skewX=$Tt,this.skewY=$TM,this},$Tt.render=function($Tt,$TM,$Tf){$Tz.spriteCount++,$Tu.renders[this._renderType]._fun(this,$Tt,$TM+this._x,$Tf+this._y),this._repaint=0},$Tt.drawToCanvas=function($Tt,$TM,$Tf,$Tc){if($Ts.isConchNode){var $TD=$TNt.create("2D");return new $Tr($Tt,$TM,$TD).ctx.setCanvasType(1),this.conchModel.drawToCanvas($TD.source,$Tf,$Tc),$TD}return $TU.drawToCanvas(this,this._renderType,$Tt,$TM,$Tf,$Tc)},$Tt.customRender=function($Tt,$TM,$Tf){this._renderType|=1024},$Tt._applyFilters=function(){var $Tt;if(!$Ts.isWebGL&&(($Tt=this._$P.filters)&&!($Tt.length<1)))for(var $TM=0,$Tf=$Tt.length;$TM<$Tf;$TM++)$Tt[$TM].action.apply(this._$P.cacheCanvas)},$Tt._isHaveGlowFilter=function(){var $Tt,$TM=0;if(this.filters)for($TM=0;$TM<this.filters.length;$TM++)if(8==this.filters[$TM].type)return!0;for($TM=0,$Tt=this._childs.length;$TM<$Tt;$TM++)if(this._childs[$TM]._isHaveGlowFilter())return!0;return!1},$Tt.localToGlobal=function($Tt,$TM){void 0===$TM&&($TM=!1),!0===$TM&&($Tt=new $Ti($Tt.x,$Tt.y));for(var $Tf=this;$Tf&&$Tf!=$TT.stage;)$Tt=$Tf.toParentPoint($Tt),$Tf=$Tf.parent;return $Tt},$Tt.globalToLocal=function($Tt,$TM){void 0===$TM&&($TM=!1),$TM&&($Tt=new $Ti($Tt.x,$Tt.y));for(var $Tf=this,$Tc=[];$Tf&&$Tf!=$TT.stage;)$Tc.push($Tf),$Tf=$Tf.parent;for(var $TD=$Tc.length-1;0<=$TD;)$Tt=($Tf=$Tc[$TD]).fromParentPoint($Tt),$TD--;return $Tt},$Tt.toParentPoint=function($Tt){if(!$Tt)return $Tt;$Tt.x-=this.pivotX,$Tt.y-=this.pivotY,this.transform&&this._transform.transformPoint($Tt),$Tt.x+=this._x,$Tt.y+=this._y;var $TM=this._style.scrollRect;return $TM&&($Tt.x-=$TM.x,$Tt.y-=$TM.y),$Tt},$Tt.fromParentPoint=function($Tt){if(!$Tt)return $Tt;$Tt.x-=this._x,$Tt.y-=this._y;var $TM=this._style.scrollRect;return $TM&&($Tt.x+=$TM.x,$Tt.y+=$TM.y),this.transform&&this._transform.invertTransformPoint($Tt),$Tt.x+=this.pivotX,$Tt.y+=this.pivotY,$Tt},$Tt.on=function($Tt,$TM,$Tf,$Tc){return 1!==this._mouseEnableState&&this.isMouseEvent($Tt)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($Tt,$TM,$Tf,$Tc,!1)):$TD.prototype.on.call(this,$Tt,$TM,$Tf,$Tc)},$Tt.once=function($Tt,$TM,$Tf,$Tc){return 1!==this._mouseEnableState&&this.isMouseEvent($Tt)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($Tt,$TM,$Tf,$Tc,!0)):$TD.prototype.once.call(this,$Tt,$TM,$Tf,$Tc)},$Tt._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $Tt=this;for($Tt=$Tt.parent;$Tt&&1!==$Tt._mouseEnableState&&!$Tt._getBit(2);)$Tt.mouseEnabled=!0,$Tt._setBit(2,!0),$Tt=$Tt.parent}},$Tt.loadImage=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=this;return void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),this.graphics.loadImage($Tt,$TM,$Tf,$Tc,$TD,function($Tt){$TJ.destroyed||($TJ.size($TM+($Tc||$Tt.width),$Tf+($TD||$Tt.height)),$TJ.repaint(),$To&&$To.runWith($Tt))}),this},$Tt.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$Tt._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$Tt._childChanged=function($Tt){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$Tt&&this._get$P("hasZorder")&&$TT.timer.callLater(this,this.updateZOrder),this.repaint()},$Tt.parentRepaint=function(){var $Tt=this._parent;$Tt&&0===$Tt._repaint&&($Tt._repaint=1,$Tt.parentRepaint())},$Tt.startDrag=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){void 0===$TM&&($TM=!1),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=300),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=.92),this._$P.dragging||this._set$P("dragging",new $TY),this._$P.dragging.start(this,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ)},$Tt.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$Tt._releaseMem=function(){if(this._$P){var $Tt=this._$P.cacheCanvas;$Tt&&$Tt.ctx&&($Tg.recover("RenderContext",$Tt.ctx),$Tt.ctx.canvas.size(0,0),$Tt.ctx=null);var $TM=this._$P._filterCache;$TM&&($TM.destroy(),$TM.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$Tt._setDisplay=function($Tt){$Tt||this._releaseMem(),$TD.prototype._setDisplay.call(this,$Tt)},$Tt.hitTestPoint=function($Tt,$TM){var $Tf=this.globalToLocal($Ti.TEMP.setTo($Tt,$TM));return $Tt=$Tf.x,$TM=$Tf.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$TV.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($Tt,$TM)},$Tt.getMousePoint=function(){return this.globalToLocal($Ti.TEMP.setTo($TT.stage.mouseX,$TT.stage.mouseY))},$Tt._getWords=function(){return null},$Tt._addChildsToLayout=function($Tt){var $TM=this._getWords();if(null==$TM&&0==this._childs.length)return!1;if($TM)for(var $Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)$Tt.push($TM[$Tf]);$Tf=0;for(var $TD=this._childs.length;$Tf<$TD;++$Tf){var $To=this._childs[$Tf];$To._style._enableLayout()&&$To._addToLayout($Tt)}return!0},$Tt._addToLayout=function($Tt){this._style.absolute||(this._style.block?$Tt.push(this):this._addChildsToLayout($Tt)&&(this.x=this.y=0))},$Tt._isChar=function(){return!1},$Tt._getCSSStyle=function(){return this._style.getCSSStyle()},$Tt._setAttributes=function($Tt,$TM){switch($Tt){case"x":this.x=parseFloat($TM);break;case"y":this.y=parseFloat($TM);break;case"width":this.width=parseFloat($TM);break;case"height":this.height=parseFloat($TM);break;default:this[$Tt]=$TM}},$Tt._layoutLater=function(){this.parent&&this.parent._layoutLater()},$Tq(0,$Tt,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($Tt){this._optimizeScrollRect!=$Tt&&(this._optimizeScrollRect=$Tt,this.conchModel&&this.conchModel.optimizeScrollRect($Tt))}),$Tq(0,$Tt,"customRenderEnable",null,function($Tt){if($Tt&&(this._renderType|=1024,$Ts.isConchNode)){$Tf.CustomList.push(this);var $TM=new $TNt("2d");$TM._setContext(new CanvasRenderingContext2D),this.customContext=new $Tr(0,0,$TM),$TM.context.setCanvasType&&$TM.context.setCanvasType(2),this.conchModel.custom($TM.context)}}),$Tq(0,$Tt,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($Tt){this.cacheAs=$Tt?this._$P.hasFilter?"none":"normal":"none"}),$Tq(0,$Tt,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($Tt){var $TM=this._$P.cacheCanvas;if($Tt!==($TM?$TM.type:"none")){if("none"!==$Tt)this._getBit(1)||this._setUpNoticeType(1),$TM||($TM=this._set$P("cacheCanvas",$Tg.getItemByClass("cacheCanvas",Object))),$TM.type=$Tt,$TM.reCache=!0,this._renderType|=16,"bitmap"==$Tt&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($TM){var $Tf=$TM;$Tf&&$Tf.ctx&&($Tg.recover("RenderContext",$Tf.ctx),$Tf.ctx.canvas.size(0,0),$Tf.ctx=null),$Tg.recover("cacheCanvas",$TM)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$Tq(0,$Tt,"zOrder",function(){return this._zOrder},function($Tt){this._zOrder!=$Tt&&(this._zOrder=$Tt,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($Tt),this._parent&&($Tt&&this._parent._set$P("hasZorder",!0),$TT.timer.callLater(this._parent,this.updateZOrder)))}),$Tq(0,$Tt,"rotation",function(){return this._style._tf.rotate},function($Tt){var $TM=this.getStyle();if($TM._tf.rotate!==$Tt){$TM.setRotate($Tt),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($Tt),this._renderType|=4;var $Tf=this._parent;$Tf&&0===$Tf._repaint&&($Tf._repaint=1,$Tf.parentRepaint())}}),$Tq(0,$Tt,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($Tt){this._width!==$Tt&&(this._width=$Tt,this.conchModel&&this.conchModel.size($Tt,this._height),this.repaint())}),$Tq(0,$Tt,"x",function(){return this._x},function($Tt){if(this._x!==$Tt){if(this.destroyed)return;this._x=$Tt,this.conchModel&&this.conchModel.pos($Tt,this._y);var $TM=this._parent;$TM&&0===$TM._repaint&&($TM._repaint=1,$TM.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$Tq(0,$Tt,"globalScaleY",function(){for(var $Tt=1,$TM=this;$TM&&$TM!==$TT.stage;)$Tt*=$TM.scaleY,$TM=$TM.parent;return $Tt}),$Tq(0,$Tt,"hitArea",function(){return this._$P.hitArea},function($Tt){this._set$P("hitArea",$Tt)}),$Tq(0,$Tt,"staticCache",function(){return this._$P.staticCache},function($Tt){this._set$P("staticCache",$Tt),$Tt||this.reCache()}),$Tq(0,$Tt,"texture",function(){return this._texture},function($Tt){this._texture!=$Tt&&(this._texture=$Tt,this.graphics.cleanByTexture($Tt,0,0))}),$Tq(0,$Tt,"y",function(){return this._y},function($Tt){if(this._y!==$Tt){if(this.destroyed)return;this._y=$Tt,this.conchModel&&this.conchModel.pos(this._x,$Tt);var $TM=this._parent;$TM&&0===$TM._repaint&&($TM._repaint=1,$TM.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$Tq(0,$Tt,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($Tt){this._height!==$Tt&&(this._height=$Tt,this.conchModel&&this.conchModel.size(this._width,$Tt),this.repaint())}),$Tq(0,$Tt,"blendMode",function(){return this._style.blendMode},function($Tt){this.getStyle().blendMode=$Tt,this.conchModel&&this.conchModel.blendMode($Tt),$Tt&&"source-over"!=$Tt?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$Tq(0,$Tt,"scaleX",function(){return this._style._tf.scaleX},function($Tt){var $TM=this.getStyle();if($TM._tf.scaleX!==$Tt){$TM.setScaleX($Tt),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Tt,$TM._tf.scaleY),this._renderType|=4;var $Tf=this._parent;$Tf&&0===$Tf._repaint&&($Tf._repaint=1,$Tf.parentRepaint())}}),$Tq(0,$Tt,"scaleY",function(){return this._style._tf.scaleY},function($Tt){var $TM=this.getStyle();if($TM._tf.scaleY!==$Tt){$TM.setScaleY($Tt),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($TM._tf.scaleX,$Tt),this._renderType|=4;var $Tf=this._parent;$Tf&&0===$Tf._repaint&&($Tf._repaint=1,$Tf.parentRepaint())}}),$Tq(0,$Tt,"stage",function(){return $TT.stage}),$Tq(0,$Tt,"skewX",function(){return this._style._tf.skewX},function($Tt){var $TM=this.getStyle();if($TM._tf.skewX!==$Tt){$TM.setSkewX($Tt),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($Tt,$TM._tf.skewY),this._renderType|=4;var $Tf=this._parent;$Tf&&0===$Tf._repaint&&($Tf._repaint=1,$Tf.parentRepaint())}}),$Tq(0,$Tt,"scrollRect",function(){return this._style.scrollRect},function($Tt){this.getStyle().scrollRect=$Tt,this.repaint(),$Tt?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($Tt.x,$Tt.y,$Tt.width,$Tt.height)):(this._renderType&=-129,this.conchModel&&($Tf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$Tq(0,$Tt,"skewY",function(){return this._style._tf.skewY},function($Tt){var $TM=this.getStyle();if($TM._tf.skewY!==$Tt){$TM.setSkewY($Tt),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($TM._tf.skewX,$Tt),this._renderType|=4;var $Tf=this._parent;$Tf&&0===$Tf._repaint&&($Tf._repaint=1,$Tf.parentRepaint())}}),$Tq(0,$Tt,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($Tt){this._tfChanged=!1,(this._transform=$Tt)&&(this._x=$Tt.tx,this._y=$Tt.ty,$Tt.tx=$Tt.ty=0,this.conchModel&&this.conchModel.transform($Tt.a,$Tt.b,$Tt.c,$Tt.d,this._x,this._y)),$Tt?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$Tq(0,$Tt,"pivotX",function(){return this._style._tf.translateX},function($Tt){this.getStyle().setTranslateX($Tt),this.conchModel&&this.conchModel.pivot($Tt,this._style._tf.translateY),this.repaint()}),$Tq(0,$Tt,"pivotY",function(){return this._style._tf.translateY},function($Tt){this.getStyle().setTranslateY($Tt),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$Tt),this.repaint()}),$Tq(0,$Tt,"alpha",function(){return this._style.alpha},function($Tt){this._style&&this._style.alpha!==$Tt&&($Tt=$Tt<0?0:1<$Tt?1:$Tt,this.getStyle().alpha=$Tt,this.conchModel&&this.conchModel.alpha($Tt),1!==$Tt?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$Tq(0,$Tt,"visible",function(){return this._style.visible},function($Tt){this._style&&this._style.visible!==$Tt&&(this.getStyle().visible=$Tt,this.conchModel&&this.conchModel.visible($Tt),this.parentRepaint())}),$Tq(0,$Tt,"graphics",function(){return this._graphics||(this.graphics=$TU.createGraphics())},function($Tt){this._graphics&&(this._graphics._sp=null),(this._graphics=$Tt)?(this._renderType&=-2,this._renderType|=512,($Tt._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($Tf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$Tq(0,$Tt,"filters",function(){return this._$P.filters},function($Tt){$Tt&&0===$Tt.length&&($Tt=null),this._$P.filters!=$Tt&&(this._set$P("filters",$Tt?$Tt.slice():null),$Ts.isConchApp&&(this.conchModel&&($Tf.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$Ts.isWebGL&&($Tt&&$Tt.length?this._renderType|=32:this._renderType&=-33),$Tt&&0<$Tt.length?(this._getBit(1)||this._setUpNoticeType(1),$Ts.isWebGL&&1==$Tt.length&&$Tt[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($Ts.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$Tq(0,$Tt,"parent",$TD.prototype._$get_parent,function($Tt){$TT.superSet($Ttt,this,"parent",$Tt),$Tt&&this._getBit(2)&&this._$2__onDisplay()}),$Tq(0,$Tt,"mask",function(){return this._$P._mask},function($Tt){$Tt&&this.mask&&this.mask._$P.maskParent||($Tt?(this.cacheAs="bitmap",this._set$P("_mask",$Tt),$Tt._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$Tt),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($Tt?$Tt.conchModel:null),this._renderType|=64,this.parentRepaint())}),$Tq(0,$Tt,"mouseEnabled",function(){return 1<this._mouseEnableState},function($Tt){this._mouseEnableState=$Tt?2:1}),$Tq(0,$Tt,"globalScaleX",function(){for(var $Tt=1,$TM=this;$TM&&$TM!==$TT.stage;)$Tt*=$TM.scaleX,$TM=$TM.parent;return $Tt}),$Tq(0,$Tt,"mouseX",function(){return this.getMousePoint().x}),$Tq(0,$Tt,"mouseY",function(){return this.getMousePoint().y}),$Tf.fromImage=function($Tt){return(new $Tf).loadImage($Tt)},$Tf._cachePool=[],$Tf.CustomList=[],$TA($Tf,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$TJ.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$Tf}($Ttt),$Tbt=function($Tt){function $TM($Tt){this._audio=null,this._onEnd=null,this._resumePlay=null,$TM.__super.call(this),this._onEnd=$Ta.bind(this.__onEnd,this),this._resumePlay=$Ta.bind(this.__resumePlay,this),$Tt.addEventListener("ended",this._onEnd),this._audio=$Tt}$Tp($TM,"laya.media.h5audio.AudioSoundChannel",$Tct);var $Tf=$TM.prototype;return $Tf.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($TT.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$Tf.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$TK.container.appendChild(this._audio),this._audio.play()}catch($Tt){this.event("error")}},$Tf.play=function($Tt){this.isStopped=!1;try{this._audio.playbackRate=$TC.playbackRate,this._audio.currentTime=this.startTime}catch($Tt){return void this._audio.addEventListener("canplay",this._resumePlay)}$TC.addChannel(this),$TK.container.appendChild(this._audio),!$Tt&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$Tf.stop=function(){this.isStopped=!0,$TC.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$Ts.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$TK.onIE||this._audio!=$Tft._musicAudio&&$Tg.recover("audio:"+this.url,this._audio),$TK.removeElement(this._audio),this._audio=null)},$Tf.pause=function(){this.isStopped=!0,$TC.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$Tf.resume=function(){this._audio&&(this.isStopped=!1,$TC.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$Tq(0,$Tf,"position",function(){return this._audio?this._audio.currentTime:0}),$Tq(0,$Tf,"duration",function(){return this._audio?this._audio.duration:0}),$Tq(0,$Tf,"volume",function(){return this._audio?this._audio.volume:1},function($Tt){this._audio&&(this._audio.volume=$Tt)}),$TM}(),$TIt=function($Tt){function $TM(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$Tot.ctx,$TM.__super.call(this),this._onPlayEnd=$Ta.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$Tp($TM,"laya.media.webaudio.WebAudioSoundChannel",$Tct);var $Tf=$TM.prototype;return $Tf.play=function($Tt){if($TC.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $TM=this.context,$Tf=this.gain,$Tc=$TM.createBufferSource();(this.bufferSource=$Tc).buffer=this.audioBuffer,$Tc.connect($Tf),$Tf&&$Tf.disconnect(),$Tf.connect($TM.destination),$Tc.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$TK.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($Tc.loop=!0),$Tc.playbackRate.setTargetAtTime?$Tc.playbackRate.setTargetAtTime($TC.playbackRate,this.context.currentTime,.1):$Tc.playbackRate.value=$TC.playbackRate,$Tc.start(0,this.startTime),!$Tt&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$Tf.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($TT.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$Tf._clearBufferSource=function(){if(this.bufferSource){var $Tt=this.bufferSource;$Tt.stop?$Tt.stop(0):$Tt.noteOff(0),$Tt.disconnect(0),$Tt.onended=null,$TM._tryCleanFailed||this._tryClearBuffer($Tt),this.bufferSource=null}},$Tf._tryClearBuffer=function($Tt){try{$Tt.buffer=null}catch($Tt){$TM._tryCleanFailed=!0}},$Tf.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$TC.removeChannel(this),this.startHandler=null,this.completeHandler=null},$Tf.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$TC.removeChannel(this)},$Tf.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$Tq(0,$Tf,"position",function(){return this.bufferSource?($TK.now()-this._startTime)/1e3+this.startTime:0}),$Tq(0,$Tf,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$Tq(0,$Tf,"volume",function(){return this._volume},function($Tt){this.isStopped||(this._volume=$Tt,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($Tt,this.context.currentTime,.1):this.gain.gain.value=$Tt)}),$TM._tryCleanFailed=!1,$TM}(),$Tqt=function($Tt){function $TM(){$TM.__super.call(this),this._w=0,this._h=0}$Tp($TM,"laya.resource.Bitmap",$TLt);var $Tf=$TM.prototype;return $Tq(0,$Tf,"width",function(){return this._w}),$Tq(0,$Tf,"height",function(){return this._h}),$Tq(0,$Tf,"source",function(){return this._source}),$TM}(),$Tlt=function($TM){function $Tt(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$Tt.__super.call(this),this._interval=$Tc.animationInterval,this._setUpNoticeType(1)}$Tp($Tt,"laya.display.AnimationPlayerBase",$TM);var $Tf=$Tt.prototype;return $Tf.play=function($Tt,$TM,$Tf,$Tc){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=!0),void 0===$Tf&&($Tf=""),void 0===$Tc&&($Tc=!0),this._isPlaying=!0,this.index="string"==typeof $Tt?this._getFrameByLabel($Tt):$Tt,this.loop=$TM,this._actionName=$Tf,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$Tf._getFrameByLabel=function($Tt){var $TM=0;for($TM=0;$TM<this._count;$TM++)if(this._labels[$TM]&&0<=this._labels[$TM].indexOf($Tt))return $TM;return 0},$Tf._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$Tf._setControlNode=function($Tt){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$Tt)&&$Tt!=this&&($Tt.on("display",this,this._checkResumePlaying),$Tt.on("undisplay",this,this._checkResumePlaying))},$Tf._setDisplay=function($Tt){$TM.prototype._setDisplay.call(this,$Tt),this._checkResumePlaying()},$Tf._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$Tf.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$Tf.addLabel=function($Tt,$TM){this._labels||(this._labels={}),this._labels[$TM]||(this._labels[$TM]=[]),this._labels[$TM].push($Tt)},$Tf.removeLabel=function($Tt){if($Tt){if(this._labels)for(var $TM in this._labels)this._removeLabelFromLabelList(this._labels[$TM],$Tt)}else this._labels=null},$Tf._removeLabelFromLabelList=function($Tt,$TM){if($Tt)for(var $Tf=$Tt.length-1;0<=$Tf;$Tf--)$Tt[$Tf]==$TM&&$Tt.splice($Tf,1)},$Tf.gotoAndStop=function($Tt){this.index="string"==typeof $Tt?this._getFrameByLabel($Tt):$Tt,this.stop()},$Tf._displayToIndex=function($Tt){},$Tf.clear=function(){this.stop(),this._labels=null},$Tq(0,$Tf,"interval",function(){return this._interval},function($Tt){this._interval!=$Tt&&(this._frameRateChanged=!0,this._interval=$Tt,this._isPlaying&&0<$Tt&&this.timerLoop($Tt,this,this._frameLoop,null,!0,!0))}),$Tq(0,$Tf,"isPlaying",function(){return this._isPlaying}),$Tq(0,$Tf,"index",function(){return this._index},function($Tt){if(this._index=$Tt,this._displayToIndex($Tt),this._labels&&this._labels[$Tt])for(var $TM=this._labels[$Tt],$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)this.event("label",$TM[$Tf])}),$Tq(0,$Tf,"count",function(){return this._count}),$Tt.WRAP_POSITIVE=0,$Tt.WRAP_REVERSE=1,$Tt.WRAP_PINGPONG=2,$Tt}($TBt),$T_t=function($TM){function $TI(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$TI.__super.call(this),this.overflow=$TI.VISIBLE,this._style=new $TMt(this),this._style.wordWrap=!1}$Tp($TI,"laya.display.Text",$TM);var $Tt=$TI.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$Tt._getBoundPointsM=function($Tt){void 0===$Tt&&($Tt=!1);var $TM=$TV.TEMP;return $TM.setTo(0,0,this.width,this.height),$TM._getBoundPoints()},$Tt.getGraphicBounds=function($Tt){void 0===$Tt&&($Tt=!1);var $TM=$TV.TEMP;return $TM.setTo(0,0,this.width,this.height),$TM},$Tt._getCSSStyle=function(){return this._style},$Tt.lang=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp){if($Tt=$TI.langPacks&&$TI.langPacks[$Tt]?$TI.langPacks[$Tt]:$Tt,arguments.length<2)this._text=$Tt;else{for(var $TB=0,$Tb=arguments.length;$TB<$Tb;$TB++)$Tt=$Tt.replace("{"+$TB+"}",arguments[$TB+1]);this._text=$Tt}},$Tt._isPassWordMode=function(){var $Tt=this._style.password;return"prompt"in this&&this.prompt==this._text&&($Tt=!1),$Tt},$Tt._getPassWordTxt=function($Tt){var $TM;$TM="";for(var $Tf=$Tt.length;0<$Tf;$Tf--)$TM+="●";return $TM},$Tt.renderText=function($Tt,$TM){var $Tf=this.graphics;$Tf.clear(!0);var $Tc=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($TK.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$TK.context.font=$Tc;var $TD=this.padding,$To=$TD[3],$TJ="left",$TZ=this._lines,$TA=this.leading+this._charSize.height,$TL=this._currBitmapFont;$TL&&($TA=this.leading+$TL.getMaxHeight());var $Tp=$TD[0];if(!$TL&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($TJ="right",$To=this._width-$TD[1]):"center"==this.align&&($TJ="center",$To=.5*this._width+$TD[3]-$TD[1])),0<this._height){var $TB=this._textHeight>this._height?"top":this.valign;"middle"===$TB?$Tp=.5*(this._height-$TM*$TA)+$TD[0]-$TD[2]:"bottom"===$TB&&($Tp=this._height-$TM*$TA-$TD[2])}var $Tb=this._style;if($TL&&$TL.autoScaleSize)var $TI=$TL.fontSize/this.fontSize;if(this._clipPoint)if($Tf.save(),$TL&&$TL.autoScaleSize){var $Tq=0,$Tl=0;$Tq=this._width?this._width-$TD[3]-$TD[1]:this._textWidth,$Tl=this._height?this._height-$TD[0]-$TD[2]:this._textHeight,$Tq*=$TI,$Tl*=$TI,$Tf.clipRect($TD[3],$TD[0],$Tq,$Tl)}else $Tf.clipRect($TD[3],$TD[0],this._width?this._width-$TD[3]-$TD[1]:this._textWidth,this._height?this._height-$TD[0]-$TD[2]:this._textHeight);var $T_=$Tb.password;"prompt"in this&&this.prompt==this._text&&($T_=!1);for(var $TE=0,$Te=0,$TN=Math.min(this._lines.length,$TM+$Tt)||1,$TX=$Tt;$TX<$TN;$TX++){var $Ty,$Th=$TZ[$TX];if($T_){var $TT=$Th.length;$Th="";for(var $Ti=$TT;0<$Ti;$Ti--)$Th+="●"}if($TE=$To-(this._clipPoint?this._clipPoint.x:0),$Te=$Tp+$TA*$TX-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($TJ,$TE,$Te,$TX),$TL){var $TV=this.width;$TL.autoScaleSize&&($TV=this.width*$TI),$TL.drawText($Th,this,$TE,$Te,this.align,$TV)}else $Ts.isWebGL?(this._words||(this._words=[]),($Ty=this._words.length>$TX-$Tt?this._words[$TX-$Tt]:new $TW).setText($Th)):$Ty=$Th,$Tb.stroke?$Tf.fillBorderText($Ty,$TE,$Te,$Tc,this.color,$Tb.strokeColor,$Tb.stroke,$TJ):$Tf.fillText($Ty,$TE,$Te,$Tc,this.color,$TJ)}if($TL&&$TL.autoScaleSize){var $Tx=1/$TI;this.scale($Tx,$Tx)}this._clipPoint&&$Tf.restore(),this._startX=$To,this._startY=$Tp},$Tt.drawUnderline=function($Tt,$TM,$Tf,$Tc){var $TD=this._lineWidths[$Tc];switch($Tt){case"center":$TM-=$TD/2;break;case"right":$TM-=$TD}$Tf+=this._charSize.height,this._graphics.drawLine($TM,$Tf,$TM+$TD,$Tf,this.underlineColor||this.color,1)},$Tt.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$TK.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $Ti(0,0)):this._clipPoint=null;var $Tt=this._lines.length;if(this.overflow!=$TI.VISIBLE){var $TM=this.overflow==$TI.HIDDEN?Math.floor:Math.ceil;$Tt=Math.min($Tt,$TM((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $Tf=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($Tf,$Tt),this.repaint()},$Tt.evalTextSize=function(){var $Tt,$TM=NaN;$Tt=Math.max.apply(this,this._lineWidths),$TM=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$Tt==this._textWidth&&$TM==this._textHeight||(this._textWidth=$Tt,this._textHeight=$TM,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$Tt.checkEnabledViewportOrNot=function(){return this.overflow==$TI.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$Tt.changeText=function($Tt){this._text!==$Tt&&(this.lang($Tt+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$Tt.parseLines=function($Tt){var $TM=this.wordWrap||this.overflow==$TI.HIDDEN;if($TM)var $Tf=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $Tc=$Ta.contextMeasureText($TI._testWord);$Ts.isConchApp&&0===$Tc.width&&0===$Tc.height&&($Tc=$Ta.contextMeasureText("W")),this._charSize.width=$Tc.width,this._charSize.height=$Tc.height||this.fontSize}for(var $TD=$Tt.replace(/\r\n/g,"\n").split("\n"),$To=0,$TJ=$TD.length;$To<$TJ;$To++){var $TZ=$TD[$To];$TM?this.parseLine($TZ,$Tf):(this._lineWidths.push(this.getTextWidth($TZ)),this._lines.push($TZ))}},$Tt.parseLine=function($Tt,$TM){$TK.context;var $Tf,$Tc=this._lines,$TD=0,$To=NaN,$TJ=NaN,$TZ=0;if(($To=this.getTextWidth($Tt))<=$TM)return $Tc.push($Tt),void this._lineWidths.push($To);$To=this._charSize.width,0==($TD=Math.floor($TM/$To))&&($TD=1),$TJ=$To=this.getTextWidth($Tt.substring(0,$TD));for(var $TA=$TD,$TL=$Tt.length;$TA<$TL;$TA++)if($TM<($TJ+=$To=this.getTextWidth($Tt.charAt($TA))))if(this.wordWrap){var $Tp=$Tt.substring($TZ,$TA);if($Tp.charCodeAt($Tp.length-1)<255?($Tf=/(?:\w|-)+$/.exec($Tp))&&($TA=$Tf.index+$TZ,0==$Tf.index?$TA+=$Tp.length:$Tp=$Tt.substring($TZ,$TA)):$TI.RightToLeft&&($Tf=/([\u0600-\u06FF])+$/.exec($Tp))&&($TA=$Tf.index+$TZ,0==$Tf.index?$TA+=$Tp.length:$Tp=$Tt.substring($TZ,$TA)),$Tc.push($Tp),this._lineWidths.push($TJ-$To),!(($TZ=$TA)+$TD<$TL)){$Tc.push($Tt.substring($TZ,$TL)),this._lineWidths.push(this.getTextWidth($Tc[$Tc.length-1])),$TZ=-1;break}$TA+=$TD,$TJ=$To=this.getTextWidth($Tt.substring($TZ,$TA)),$TA--}else if(this.overflow==$TI.HIDDEN)return $Tc.push($Tt.substring(0,$TA)),void this._lineWidths.push(this.getTextWidth($Tc[$Tc.length-1]));this.wordWrap&&-1!=$TZ&&($Tc.push($Tt.substring($TZ,$TL)),this._lineWidths.push(this.getTextWidth($Tc[$Tc.length-1])))},$Tt.getTextWidth=function($Tt){return this._currBitmapFont?this._currBitmapFont.getTextWidth($Tt):$Ta.contextMeasureText($Tt).width},$Tt.getWordWrapWidth=function(){var $Tt=this.padding,$TM=NaN;return($TM=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($TM=this.wordWrap?100:$TK.width),$TM<=0&&($TM=100),$TM-$Tt[3]-$Tt[1]},$Tt.getCharPoint=function($Tt,$TM){this._isChanged&&$TT.timer.runCallLater(this,this.typeset);for(var $Tf=0,$Tc=this._lines,$TD=0,$To=0,$TJ=$Tc.length;$To<$TJ;$To++){if($Tt<($Tf+=$Tc[$To].length)){var $TZ=$To;break}$TD=$Tf}var $TA=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$TK.context.font=$TA;var $TL=this.getTextWidth(this._text.substring($TD,$Tt));return($TM||new $Ti).setTo(this._startX+$TL-(this._clipPoint?this._clipPoint.x:0),this._startY+$TZ*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$Tq(0,$Tt,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($Tt){$Tt!=this._width&&($TT.superSet($TBt,this,"width",$Tt),this.isChanged=!0)}),$Tq(0,$Tt,"textWidth",function(){return this._isChanged&&$TT.timer.runCallLater(this,this.typeset),this._textWidth}),$Tq(0,$Tt,"height",function(){return this._height?this._height:this.textHeight},function($Tt){$Tt!=this._height&&($TT.superSet($TBt,this,"height",$Tt),this.isChanged=!0)}),$Tq(0,$Tt,"textHeight",function(){return this._isChanged&&$TT.timer.runCallLater(this,this.typeset),this._textHeight}),$Tq(0,$Tt,"padding",function(){return this._getCSSStyle().padding},function($Tt){this._getCSSStyle().padding=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"bold",function(){return this._getCSSStyle().bold},function($Tt){this._getCSSStyle().bold=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"text",function(){return this._text||""},function($Tt){this._text!==$Tt&&(this.lang($Tt+""),this.isChanged=!0,this.event("change"))}),$Tq(0,$Tt,"color",function(){return this._getCSSStyle().color},function($Tt){this._getCSSStyle().color!=$Tt&&(this._getCSSStyle().color=$Tt,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$Tq(0,$Tt,"font",function(){return this._getCSSStyle().fontFamily},function($Tt){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$TI._bitmapFonts&&$TI._bitmapFonts[$Tt]&&(this._currBitmapFont=$TI._bitmapFonts[$Tt]),this._getCSSStyle().fontFamily=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"fontSize",function(){return this._getCSSStyle().fontSize},function($Tt){this._getCSSStyle().fontSize=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"italic",function(){return this._getCSSStyle().italic},function($Tt){this._getCSSStyle().italic=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"align",function(){return this._getCSSStyle().align},function($Tt){this._getCSSStyle().align=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"valign",function(){return this._getCSSStyle().valign},function($Tt){this._getCSSStyle().valign=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($Tt){this._getCSSStyle().wordWrap=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"leading",function(){return this._getCSSStyle().leading},function($Tt){this._getCSSStyle().leading=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($Tt){this._getCSSStyle().backgroundColor=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"borderColor",function(){return this._getCSSStyle().borderColor},function($Tt){this._getCSSStyle().borderColor=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"stroke",function(){return this._getCSSStyle().stroke},function($Tt){this._getCSSStyle().stroke=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($Tt){this._getCSSStyle().strokeColor=$Tt,this.isChanged=!0}),$Tq(0,$Tt,"isChanged",null,function($Tt){this._isChanged!==$Tt&&(this._isChanged=$Tt)&&$TT.timer.callLater(this,this.typeset)}),$Tq(0,$Tt,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($Tt){if(!(this.overflow!=$TI.SCROLL||this.textWidth<this._width)&&this._clipPoint){$Tt=$Tt<this.padding[3]?this.padding[3]:$Tt;var $TM=this._textWidth-this._width;$Tt=$TM<$Tt?$TM:$Tt;var $Tf=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$Tt,this.renderText(this._lastVisibleLineIndex,$Tf)}}),$Tq(0,$Tt,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($Tt){if(!(this.overflow!=$TI.SCROLL||this.textHeight<this._height)&&this._clipPoint){$Tt=$Tt<this.padding[0]?this.padding[0]:$Tt;var $TM=this._textHeight-this._height,$Tf=($Tt=$TM<$Tt?$TM:$Tt)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$Tf;var $Tc=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$Tt,this.renderText($Tf,$Tc)}}),$Tq(0,$Tt,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$Tq(0,$Tt,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$Tq(0,$Tt,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$Tq(0,$Tt,"underlineColor",function(){return this._underlineColor},function($Tt){this._underlineColor=$Tt,this._isChanged=!0,this.typeset()}),$TI.registerBitmapFont=function($Tt,$TM){$TI._bitmapFonts||($TI._bitmapFonts={}),$TI._bitmapFonts[$Tt]=$TM},$TI.unregisterBitmapFont=function($Tt,$TM){if(void 0===$TM&&($TM=!0),$TI._bitmapFonts&&$TI._bitmapFonts[$Tt]){var $Tf=$TI._bitmapFonts[$Tt];$TM&&$Tf.destroy(),delete $TI._bitmapFonts[$Tt]}},$TI.setTextRightToLeft=function(){var $Tt;($Tt=$TK.canvas.source.style).display="none",$Tt.position="absolute",$Tt.direction="rtl",$Ts._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$TK.document.body.appendChild($TK.canvas.source)},$TI.supportFont=function($Tt){$TK.context.font="10px sans-serif";var $TM=$Ta.contextMeasureText("abcji").width;$TK.context.font="10px "+$Tt;var $Tf=$Ta.contextMeasureText("abcji").width;return console.log($TM,$Tf),$TM!==$Tf},$TI._testWord="游",$TI.langPacks=null,$TI.VISIBLE="visible",$TI.SCROLL="scroll",$TI.HIDDEN="hidden",$TI.CharacterCache=!0,$TI.RightToLeft=!1,$TI._bitmapFonts=null,$TA($TI,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$TI}($TBt),$TEt=function($TB){function $TJ(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$TJ.__super.call(this),this.offset=new $Ti,this._canvasTransform=new $TF,this._previousOrientation=$TK.window.orientation;var $TM=this;this.transform=$TF.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $Tt=$TK.window,$Tf=this;$Tt.addEventListener("focus",function(){$TM._isFocused=!0,$Tf.event("focus"),$Tf.event("focuschange")}),$Tt.addEventListener("blur",function(){$TM._isFocused=!1,$Tf.event("blur"),$Tf.event("focuschange"),$Tf._isInputting()&&($Tyt.inputElement.target.focus=!1)});var $Tc="visibilityState",$TD="visibilitychange",$To=$Tt.document;void 0!==$To.hidden?($TD="visibilitychange",$Tc="visibilityState"):void 0!==$To.mozHidden?($TD="mozvisibilitychange",$Tc="mozVisibilityState"):void 0!==$To.msHidden?($TD="msvisibilitychange",$Tc="msVisibilityState"):void 0!==$To.webkitHidden&&($TD="webkitvisibilitychange",$Tc="webkitVisibilityState"),$Tt.document.addEventListener($TD,function(){"hidden"==$TK.document[$Tc]?$Tf._setStageVisible(!1):$Tf._setStageVisible(!0)}),$Tt.document.addEventListener("qbrowserVisibilityChange",function($Tt){$Tf._setStageVisible(!$Tt.hidden)}),$Tt.addEventListener("resize",function(){var $Tt=$TK.window.orientation;null!=$Tt&&$Tt!=$TM._previousOrientation&&$Tf._isInputting()&&($Tyt.inputElement.target.focus=!1),$TM._previousOrientation=$Tt,$Tf._isInputting()||$Tf._resetCanvas()}),$Tt.addEventListener("orientationchange",function($Tt){$Tf._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$TK.onMobile&&this.on("mousedown",this,this._onmouseMove)}$Tp($TJ,"laya.display.Stage",$TB);var $Tt=$TJ.prototype;return $Tt._setStageVisible=function($Tt){this._isVisibility!=$Tt&&(this._isVisibility=$Tt,this._isVisibility||this._isInputting()&&($Tyt.inputElement.target.focus=!1),this.event("visibilitychange"))},$Tt._isInputting=function(){return $TK.onMobile&&$Tyt.isInputting},$Tt._changeCanvasSize=function(){this.setScreenSize($TK.clientWidth*$TK.pixelRatio,$TK.clientHeight*$TK.pixelRatio)},$Tt._resetCanvas=function(){if(this.screenAdaptationEnabled){var $Tt=$Ts._mainCanvas;$Tt.source.style;$Tt.size(1,1),$TT.timer.once(100,this,this._changeCanvasSize)}},$Tt.setScreenSize=function($Tt,$TM){var $Tf=!1;if("none"!==this._screenMode&&($Tf=($Tt/$TM<1?"vertical":"horizontal")!==this._screenMode)){var $Tc=$TM;$TM=$Tt,$Tt=$Tc}this.canvasRotation=$Tf;var $TD=$Ts._mainCanvas,$To=$TD.source.style,$TJ=this._canvasTransform.identity(),$TZ=this._scaleMode,$TA=$Tt/this.designWidth,$TL=$TM/this.designHeight,$Tp=this.designWidth,$TB=this.designHeight,$Tb=$Tt,$TI=$TM,$Tq=$TK.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$TZ){case"noscale":$TA=$TL=1,$Tb=this.designWidth,$TI=this.designHeight;break;case"showall":$TA=$TL=Math.min($TA,$TL),$Tp=$Tb=Math.round(this.designWidth*$TA),$TB=$TI=Math.round(this.designHeight*$TL);break;case"noborder":$TA=$TL=Math.max($TA,$TL),$Tb=Math.round(this.designWidth*$TA),$TI=Math.round(this.designHeight*$TL);break;case"full":$TA=$TL=1,this._width=$Tp=$Tt,this._height=$TB=$TM;break;case"fixedwidth":$TL=$TA,this._height=$TB=Math.round($TM/$TA);break;case"fixedheight":$TA=$TL,this._width=$Tp=Math.round($Tt/$TL);break;case"fixedauto":$Tt/$TM<this.designWidth/this.designHeight?($TL=$TA,this._height=$TB=Math.round($TM/$TA)):($TA=$TL,this._width=$Tp=Math.round($Tt/$TL))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$Tp=$Tp+1&2147483646,$TB=$TB+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$TA*=this.scaleX,$TL*=this.scaleY,1===$TA&&1===$TL?this.transform.identity():(this.transform.a=this._formatData($TA/($Tb/$Tp)),this.transform.d=this._formatData($TL/($TI/$TB)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$TD.size($Tp,$TB),$TU.changeWebGLSize($Tp,$TB),$TJ.scale($Tb/$Tp/$Tq,$TI/$TB/$Tq),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($Tt-$Tb)/$Tq:this.offset.x=.5*($Tt-$Tb)/$Tq,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($TM-$TI)/$Tq:this.offset.y=.5*($TM-$TI)/$Tq,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$TJ.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$Tf&&("horizontal"===this._screenMode?($TJ.rotate(Math.PI/2),$TJ.translate($TM/$Tq,0),this.canvasDegree=90):($TJ.rotate(-Math.PI/2),$TJ.translate(0,$Tt/$Tq),this.canvasDegree=-90)),$TJ.a=this._formatData($TJ.a),$TJ.d=this._formatData($TJ.d),$TJ.tx=this._formatData($TJ.tx),$TJ.ty=this._formatData($TJ.ty),$To.transformOrigin=$To.webkitTransformOrigin=$To.msTransformOrigin=$To.mozTransformOrigin=$To.oTransformOrigin="0px 0px 0px",$To.transform=$To.webkitTransform=$To.msTransform=$To.mozTransform=$To.oTransform="matrix("+$TJ.toString()+")",$TJ.translate(parseInt($To.left)||0,parseInt($To.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$Tt._formatData=function($Tt){return Math.abs($Tt)<1e-6?0:Math.abs(1-$Tt)<.001?0<$Tt?1:-1:$Tt},$Tt.getMousePoint=function(){return $Ti.TEMP.setTo(this.mouseX,this.mouseY)},$Tt.repaint=function(){this._repaint=1},$Tt.parentRepaint=function(){},$Tt._loop=function(){return this.render($Ts.context,0,0),!0},$Tt._onmouseMove=function($Tt){this._mouseMoveTime=$TK.now()},$Tt.getTimeFromFrameStart=function(){return $TK.now()-this._frameStartTime},$Tt.render=function($Tt,$TM,$Tf){if("sleep"===this._frameRate&&!$Ts.isConchApp){var $Tc=$TK.now();if(!(1e3<=$Tc-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($Tz.loopCount++,$Tl.instance.runEvent(),$TT.timer._update()));this._frameStartTime=$Tc}if(this._renderCount++,$Ts.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$TK.now();var $TD="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$To=this._renderCount%2==0;if($Tz.renderSlow=!$TD,$TD||$To||$Ts.isConchApp){var $TJ;$Tz.loopCount++,$Tl.instance.runEvent(),$TT.timer._update(),$TU.update3DLoop();var $TZ=0,$TA=0;if($Ts.isConchNode)for($TZ=0,$TA=this._scenes.length;$TZ<$TA;$TZ++)($TJ=this._scenes[$TZ])&&$TJ._updateSceneConch();else for($TZ=0,$TA=this._scenes.length;$TZ<$TA;$TZ++)($TJ=this._scenes[$TZ])&&$TJ._updateScene();if($Ts.isConchNode){var $TL=$TBt.CustomList;for($TZ=0,$TA=$TL.length;$TZ<$TA;$TZ++){var $Tp=$TL[$TZ];$Tp.customRender($Tp.customContext,0,0)}return}}$Ts.isConchNode||this.renderingEnabled&&($TD||!$To||$Ts.isConchWebGL)&&($Ts.isWebGL?$Ts.WebGL.mainContext&&!$Ts.WebGL.mainContext.isContextLost()&&($Tt.clear(),$TB.prototype.render.call(this,$Tt,$TM,$Tf),$Tz._show&&$Tz._sp&&$Tz._sp.render($Tt,$TM,$Tf),$TU.clear(this._bgColor),$TU.beginFlush(),$Tt.flush(),$TU.endFinish(),$TQ.instance&&$TQ.getInstance().endDispose()):($TU.clear(this._bgColor),$TB.prototype.render.call(this,$Tt,$TM,$Tf),$Tz._show&&$Tz._sp&&$Tz._sp.render($Tt,$TM,$Tf)))}else this._renderCount%5==0&&($Tz.loopCount++,$Tl.instance.runEvent(),$TT.timer._update())},$Tt._requestFullscreen=function(){var $Tt=$TK.document.documentElement;$Tt.requestFullscreen?$Tt.requestFullscreen():$Tt.mozRequestFullScreen?$Tt.mozRequestFullScreen():$Tt.webkitRequestFullscreen?$Tt.webkitRequestFullscreen():$Tt.msRequestFullscreen&&$Tt.msRequestFullscreen()},$Tt._fullScreenChanged=function(){$TT.stage.event("fullscreenchange")},$Tt.exitFullscreen=function(){var $Tt=$TK.document;$Tt.exitFullscreen?$Tt.exitFullscreen():$Tt.mozCancelFullScreen?$Tt.mozCancelFullScreen():$Tt.webkitExitFullscreen&&$Tt.webkitExitFullscreen()},$Tq(0,$Tt,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$Tq(0,$Tt,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$Tq(0,$Tt,"frameRate",function(){return this._frameRate},function($Tt){if(this._frameRate=$Tt,$Ts.isConchApp)switch(this._frameRate){case"slow":$TK.window.conch&&$TK.window.conchConfig.setSlowFrame&&$TK.window.conchConfig.setSlowFrame(!0);break;case"fast":$TK.window.conch&&$TK.window.conchConfig.setSlowFrame&&$TK.window.conchConfig.setSlowFrame(!1);break;case"mouse":$TK.window.conch&&$TK.window.conchConfig.setMouseFrame&&$TK.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$TK.window.conch&&$TK.window.conchConfig.setLimitFPS&&$TK.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$Tq(0,$Tt,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$Tq(0,$Tt,"width",$TB.prototype._$get_width,function($Tt){this.designWidth=$Tt,$TT.superSet($TBt,this,"width",$Tt),$TT.timer.callLater(this,this._changeCanvasSize)}),$Tq(0,$Tt,"alignH",function(){return this._alignH},function($Tt){this._alignH=$Tt,$TT.timer.callLater(this,this._changeCanvasSize)}),$Tq(0,$Tt,"isFocused",function(){return this._isFocused}),$Tq(0,$Tt,"height",$TB.prototype._$get_height,function($Tt){this.designHeight=$Tt,$TT.superSet($TBt,this,"height",$Tt),$TT.timer.callLater(this,this._changeCanvasSize)}),$Tq(0,$Tt,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$TF.create()},$TB.prototype._$set_transform),$Tq(0,$Tt,"isVisibility",function(){return this._isVisibility}),$Tq(0,$Tt,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$Tq(0,$Tt,"scaleMode",function(){return this._scaleMode},function($Tt){this._scaleMode=$Tt,$TT.timer.callLater(this,this._changeCanvasSize)}),$Tq(0,$Tt,"alignV",function(){return this._alignV},function($Tt){this._alignV=$Tt,$TT.timer.callLater(this,this._changeCanvasSize)}),$Tq(0,$Tt,"bgColor",function(){return this._bgColor},function($Tt){this._bgColor=$Tt,this.conchModel&&this.conchModel.bgColor($Tt),$Ts.isWebGL&&($Tt?$TJ._wgColor=$TP.create($Tt)._color:$TK.onMiniGame||($TJ._wgColor=null)),$TK.onLimixiu?$TJ._wgColor=$TP.create($Tt)._color:$Ts.canvas.style.background=$Tt||"none"}),$Tq(0,$Tt,"mouseX",function(){return Math.round($Tl.instance.mouseX/this.clientScaleX)}),$Tq(0,$Tt,"mouseY",function(){return Math.round($Tl.instance.mouseY/this.clientScaleY)}),$Tq(0,$Tt,"screenMode",function(){return this._screenMode},function($Tt){this._screenMode=$Tt}),$Tq(0,$Tt,"visible",$TB.prototype._$get_visible,function($Tt){this.visible!==$Tt&&($TT.superSet($TBt,this,"visible",$Tt),$Ts._mainCanvas.source.style.visibility=$Tt?"visible":"hidden")}),$Tq(0,$Tt,"fullScreenEnabled",null,function($Tt){var $TM=$TK.document,$Tf=$Ts.canvas;$Tt?($Tf.addEventListener("mousedown",this._requestFullscreen),$Tf.addEventListener("touchstart",this._requestFullscreen),$TM.addEventListener("fullscreenchange",this._fullScreenChanged),$TM.addEventListener("mozfullscreenchange",this._fullScreenChanged),$TM.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$TM.addEventListener("msfullscreenchange",this._fullScreenChanged)):($Tf.removeEventListener("mousedown",this._requestFullscreen),$Tf.removeEventListener("touchstart",this._requestFullscreen),$TM.removeEventListener("fullscreenchange",this._fullScreenChanged),$TM.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$TM.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$TM.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$TJ.SCALE_NOSCALE="noscale",$TJ.SCALE_EXACTFIT="exactfit",$TJ.SCALE_SHOWALL="showall",$TJ.SCALE_NOBORDER="noborder",$TJ.SCALE_FULL="full",$TJ.SCALE_FIXED_WIDTH="fixedwidth",$TJ.SCALE_FIXED_HEIGHT="fixedheight",$TJ.SCALE_FIXED_AUTO="fixedauto",$TJ.ALIGN_LEFT="left",$TJ.ALIGN_RIGHT="right",$TJ.ALIGN_CENTER="center",$TJ.ALIGN_TOP="top",$TJ.ALIGN_MIDDLE="middle",$TJ.ALIGN_BOTTOM="bottom",$TJ.SCREEN_NONE="none",$TJ.SCREEN_HORIZONTAL="horizontal",$TJ.SCREEN_VERTICAL="vertical",$TJ.FRAME_FAST="fast",$TJ.FRAME_SLOW="slow",$TJ.FRAME_MOUSE="mouse",$TJ.FRAME_SLEEP="sleep",$TJ.FRAME_MOUSE_THREDHOLD=2e3,$TA($TJ,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$TJ}($TBt),$Tet=(function($Tt){function $TM(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$TM.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$Tp($TM,"laya.media.SoundNode",$TBt);var $Tf=$TM.prototype;$Tf._onParentChange=function(){this.target=this.parent},$Tf.play=function($Tt,$TM){void 0===$Tt&&($Tt=1),isNaN($Tt)&&($Tt=1),this.url&&(this.stop(),this._channel=$TC.playSound(this.url,$Tt,null,$TM))},$Tf.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$Tf._setPlayAction=function($Tt,$TM,$Tf,$Tc){void 0===$Tc&&($Tc=!0),this[$Tf]&&$Tt&&($Tc?$Tt.on($TM,this,this[$Tf]):$Tt.off($TM,this,this[$Tf]))},$Tf._setPlayActions=function($Tt,$TM,$Tf,$Tc){if(void 0===$Tc&&($Tc=!0),$Tt&&$TM){var $TD,$To=$TM.split(","),$TJ=0;for($TD=$To.length,$TJ=0;$TJ<$TD;$TJ++)this._setPlayAction($Tt,$To[$TJ],$Tf,$Tc)}},$Tq(0,$Tf,"playEvent",null,function($Tt){(this._playEvents=$Tt)&&this._tar&&this._setPlayActions(this._tar,$Tt,"play")}),$Tq(0,$Tf,"target",null,function($Tt){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$Tt,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$Tq(0,$Tf,"stopEvent",null,function($Tt){(this._stopEvents=$Tt)&&this._tar&&this._setPlayActions(this._tar,$Tt,"stop")})}(),function($Tt){function $TM(){this._src=null,this._onload=null,this._onerror=null,$TM.__super.call(this)}$Tp($TM,"laya.resource.FileBitmap",$Tqt);var $Tf=$TM.prototype;return $Tq(0,$Tf,"src",function(){return this._src},function($Tt){this._src=$Tt}),$Tq(0,$Tf,"onload",null,function($Tt){}),$Tq(0,$Tf,"onerror",null,function($Tt){}),$TM}()),$TNt=function($Tt){function $Tf($Tt,$TM){this._is2D=!1,$Tf.__super.call(this);var $Tc=this;if(this._source=this,"2D"===$Tt||"AUTO"===$Tt&&!$Ts.isWebGL){this._is2D=!0,this._source=$TM||$TK.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $TD=this;$TD.getContext=function($Tt,$TM){if($Tc._ctx)return $Tc._ctx;var $Tf=$Tc._ctx=$Tc._source.getContext($Tt,$TM);return $Tf&&($Tf._canvas=$TD,$Ts.isFlash||$TK.onLimixiu||($Tf.size=function($Tt,$TM){})),$Tf}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$Tp($Tf,"laya.resource.HTMLCanvas",$Tqt);var $TM=$Tf.prototype;return $TM.clear=function(){this._ctx&&this._ctx.clear()},$TM.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$TM.release=function(){},$TM._setContext=function($Tt){this._ctx=$Tt},$TM.getContext=function($Tt,$TM){return this._ctx?this._ctx:this._ctx=$Tf._createContext(this)},$TM.getMemSize=function(){return 0},$TM.size=function($Tt,$TM){(this._w!=$Tt||this._h!=$TM||this._source&&(this._source.width!=$Tt||this._source.height!=$TM))&&(this._w=$Tt,this._h=$TM,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($Tt,$TM),this._source&&(this._source.height=$TM,this._source.width=$Tt))},$TM.getCanvas=function(){return this._source},$TM.toBase64=function($Tt,$TM,$Tf){if(this._source)if($Ts.isConchApp&&this._source.toBase64)this._source.toBase64($Tt,$TM,$Tf);else{var $Tc=this._source.toDataURL($Tt,$TM);$Tf.call(this,$Tc)}},$Tq(0,$TM,"context",function(){return this._ctx}),$Tq(0,$TM,"asBitmap",null,function($Tt){}),$Tf.create=function($Tt,$TM){return new $Tf($Tt,$TM)},$Tf.TYPE2D="2D",$Tf.TYPE3D="3D",$Tf.TYPEAUTO="AUTO",$Tf._createContext=null,$Tf}(),$TXt=(function($Tt){function $TA($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){throw $TA.__super.call(this),new Error("不允许new！")}$Tp($TA,"laya.resource.HTMLSubImage",$Tqt),$TA.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){return void 0===$TZ&&($TZ=!1),new $TA($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ)}}(),function($Tt){function $TB(){this._frames=null,this._url=null,$TB.__super.call(this),this._setControlNode(this)}$Tp($TB,"laya.display.Animation",$Tt);var $TM=$TB.prototype;$TM.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$Tt),this._frames=null,this._labels=null},$TM.play=function($Tt,$TM,$Tf,$Tc){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=!0),void 0===$Tf&&($Tf=""),void 0===$Tc&&($Tc=!0),$Tf&&this._setFramesFromCache($Tf,$Tc),this._isPlaying=!0,this.index="string"==typeof $Tt?this._getFrameByLabel($Tt):$Tt,this.loop=$TM,this._actionName=$Tf,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$TM._setFramesFromCache=function($Tt,$TM){var $Tf;return void 0===$TM&&($TM=!1),this._url&&($Tt=this._url+"#"+$Tt),$Tt&&$TB.framesMap[$Tt]?(($Tf=$TB.framesMap[$Tt])instanceof Array?(this._frames=$TB.framesMap[$Tt],this._count=this._frames.length):($Tf.nodeRoot&&($TB.framesMap[$Tt]=this._parseGraphicAnimationByData($Tf),$Tf=$TB.framesMap[$Tt]),this._frames=$Tf.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$Tf.interval),this._labels=this._copyLabels($Tf.labels)),!0):($TM&&console.log("ani not found:",$Tt),!1)},$TM._copyLabels=function($Tt){if(!$Tt)return null;var $TM,$Tf;for($Tf in $TM={},$Tt)$TM[$Tf]=$Ta.copyArray([],$Tt[$Tf]);return $TM},$TM._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$Tt.prototype._frameLoop.call(this)},$TM._displayToIndex=function($Tt){this._frames&&(this.graphics=this._frames[$Tt])},$TM.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$TM.loadImages=function($Tt,$TM){return void 0===$TM&&($TM=""),this._url="",this._setFramesFromCache($TM)||(this.frames=$TB.framesMap[$TM]?$TB.framesMap[$TM]:$TB.createFrames($Tt,$TM)),this},$TM.loadAtlas=function($TM,$Tf,$Tc){void 0===$Tc&&($Tc=""),this._url="";var $TD=this;function $Tt($Tt){$TM===$Tt&&($TD.frames=$TB.framesMap[$Tc]?$TB.framesMap[$Tc]:$TB.createFrames($TM,$Tc),$Tf&&$Tf.run())}return $TD._setFramesFromCache($Tc)||($TZt.getAtlas($TM)?$Tt($TM):$TT.loader.load($TM,$Te.create(null,$Tt,[$TM]),null,"atlas")),this},$TM.loadAnimation=function($Tt,$TM,$Tf){this._url=$Tt;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$TM&&$TM.run()):!$Tf||$TZt.getAtlas($Tf)?this._loadAnimationData($Tt,$TM,$Tf):$TT.loader.load($Tf,$Te.create(this,this._loadAnimationData,[$Tt,$TM,$Tf]),null,"atlas"),this},$TM._loadAnimationData=function($TZ,$TA,$Tt){var $TL=this;if(!$Tt||$TZt.getAtlas($Tt)){var $Tp=this;$TZt.getRes($TZ)?$TM($TZ):$TT.loader.load($TZ,$Te.create(null,$TM,[$TZ]),null,"json"),$TZt.clearRes($TZ)}else console.warn("atlas load fail:"+$Tt);function $TM($Tt){if($TZt.getRes($Tt)&&$TZ===$Tt){var $TM;if($TB.framesMap[$TZ+"#"])$Tp._setFramesFromCache($TL._actionName,!0),$TL.index=0,$TL._checkResumePlaying();else{var $Tf=$Tp._parseGraphicAnimation($TZt.getRes($TZ));if(!$Tf)return;var $Tc,$TD=$Tf.animationList,$To=0,$TJ=$TD.length;for($To=0;$To<$TJ;$To++)$TM=$TD[$To],$TB.framesMap[$TZ+"#"+$TM.name]=$TM,$Tc||($Tc=$TM);$Tc&&($TB.framesMap[$TZ+"#"]=$Tc,$Tp._setFramesFromCache($TL._actionName,!0),$TL.index=0),$TL._checkResumePlaying()}$TA&&$TA.run()}}},$TM._parseGraphicAnimation=function($Tt){return $TTt.parseAnimationData($Tt)},$TM._parseGraphicAnimationByData=function($Tt){return $TTt.parseAnimationByData($Tt)},$Tq(0,$TM,"frames",function(){return this._frames},function($Tt){(this._frames=$Tt)&&(this._count=$Tt.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$Tq(0,$TM,"autoPlay",null,function($Tt){$Tt?this.play():this.stop()}),$Tq(0,$TM,"source",null,function($Tt){-1<$Tt.indexOf(".ani")?this.loadAnimation($Tt):-1<$Tt.indexOf(".json")||-1<$Tt.indexOf("als")||-1<$Tt.indexOf("atlas")?this.loadAtlas($Tt):this.loadImages($Tt.split(","))}),$Tq(0,$TM,"autoAnimation",null,function($Tt){this.play(0,!0,$Tt,!1)}),$TB.createFrames=function($Tt,$TM){var $Tf,$Tc,$TD=0,$To=0;if("string"==typeof $Tt){var $TJ=$TZt.getAtlas($Tt);if($TJ&&$TJ.length)for($Tf=[],$TD=0,$To=$TJ.length;$TD<$To;$TD++)($Tc=new $TU.createGraphics).drawTexture($TZt.getRes($TJ[$TD]),0,0),$Tf.push($Tc)}else if($Tt instanceof Array)for($Tf=[],$TD=0,$To=$Tt.length;$TD<$To;$TD++)($Tc=new $TU.createGraphics).loadImage($Tt[$TD],0,0),$Tf.push($Tc);return $TM&&($TB.framesMap[$TM]=$Tf),$Tf},$TB.clearCache=function($Tt){var $TM,$Tf=$TB.framesMap,$Tc=$Tt+"#";for($TM in $Tf)$TM!==$Tt&&0!=$TM.indexOf($Tc)||delete $TB.framesMap[$TM]},$TB.framesMap={}}($Tlt),function($Tt){function $To(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$To.__super.call(this),null==$To._sortIndexFun&&($To._sortIndexFun=$Th.sortByKey("index",!1,!0))}$Tp($To,"laya.display.FrameAnimation",$Tt);var $TM=$To.prototype;return $TM._setUp=function($Tt,$TM){this._labels=null,this._animationNewFrames=null,this._targetDic=$Tt,this._animationData=$TM,this.interval=1e3/$TM.frameRate,$TM.parsed?(this._count=$TM.count,this._labels=$TM.labels,this._animationNewFrames=$TM.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$TM.parsed=!0,$TM.labels=this._labels,$TM.count=this._count,$TM.animationNewFrames=this._animationNewFrames},$TM.clear=function(){$Tt.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$TM._displayToIndex=function($Tt){if(this._animationData){$Tt<0&&($Tt=0),$Tt>this._count&&($Tt=this._count);var $TM=this._animationData.nodes,$Tf=0,$Tc=$TM.length;for($Tf=0;$Tf<$Tc;$Tf++)this._displayNodeToFrame($TM[$Tf],$Tt)}},$TM._displayNodeToFrame=function($Tt,$TM,$Tf){$Tf||($Tf=this._targetDic);var $Tc=$Tf[$Tt.target];if($Tc){var $TD,$To,$TJ,$TZ=$Tt.frames,$TA=$Tt.keys,$TL=0,$Tp=$TA.length;for($TL=0;$TL<$Tp;$TL++)$TJ=($To=$TZ[$TD=$TA[$TL]]).length>$TM?$To[$TM]:$To[$To.length-1],$Tc[$TD]=$TJ}},$TM._calculateDatas=function(){if(this._animationData){var $Tt,$TM=this._animationData.nodes,$Tf=0,$Tc=$TM.length;for($Tf=this._count=0;$Tf<$Tc;$Tf++)$Tt=$TM[$Tf],this._calculateNodeKeyFrames($Tt);this._count+=1}},$TM._calculateNodeKeyFrames=function($Tt){var $TM,$Tf,$Tc=$Tt.keyframes,$TD=$Tt.target;for($TM in $Tt.frames||($Tt.frames={}),$Tt.keys?$Tt.keys.length=0:$Tt.keys=[],$Tt.initValues||($Tt.initValues={}),$Tc)$Tf=$Tc[$TM],$Tt.frames[$TM]||($Tt.frames[$TM]=[]),this._targetDic&&this._targetDic[$TD]&&($Tt.initValues[$TM]=this._targetDic[$TD][$TM]),$Tf.sort($To._sortIndexFun),$Tt.keys.push($TM),this._calculateNodePropFrames($Tf,$Tt.frames[$TM],$TM,$TD)},$TM.resetToInitState=function(){if(this._targetDic&&this._animationData){var $Tt,$TM,$Tf=this._animationData.nodes,$Tc=0,$TD=$Tf.length;for($Tc=0;$Tc<$TD;$Tc++)if($TM=($Tt=$Tf[$Tc]).initValues){var $To,$TJ=this._targetDic[$Tt.target];if($TJ)for($To in $TM)$TJ[$To]=$TM[$To]}}},$TM._calculateNodePropFrames=function($Tt,$TM,$Tf,$Tc){var $TD=0,$To=$Tt.length-1;if(0<$To){for($TM.length=$Tt[$To].index+1,$TD=0;$TD<$To;$TD++)this._dealKeyFrame($Tt[$TD]),this._calculateFrameValues($Tt[$TD],$Tt[$TD+1],$TM);this._dealKeyFrame($Tt[$TD])}0==$To&&($TM[$Tt[0].index]=$Tt[0].value,this._animationNewFrames&&(this._animationNewFrames[$Tt[0].index]=!0))},$TM._dealKeyFrame=function($Tt){$Tt.label&&""!=$Tt.label&&this.addLabel($Tt.label,$Tt.index)},$TM._calculateFrameValues=function($Tt,$TM,$Tf){var $Tc,$TD=0,$To=$Tt.index,$TJ=$TM.index,$TZ=$Tt.value,$TA=$TM.value-$Tt.value,$TL=$TJ-$To;if($TJ>this._count&&(this._count=$TJ),$Tt.tween)for(null==($Tc=$Tn[$Tt.tweenMethod])&&($Tc=$Tn.linearNone),$TD=$To;$TD<$TJ;$TD++)$Tf[$TD]=$Tc($TD-$To,$TZ,$TA,$TL),this._animationNewFrames&&(this._animationNewFrames[$TD]=!0);else for($TD=$To;$TD<$TJ;$TD++)$Tf[$TD]=$TZ;this._animationNewFrames&&(this._animationNewFrames[$Tt.index]=!0,this._animationNewFrames[$TM.index]=!0),$Tf[$TM.index]=$TM.value},$To._sortIndexFun=null,$To}($Tlt)),$Tyt=function($TM){function $TD(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$TD.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$T_t.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$Tp($TD,"laya.display.Input",$TM);var $Tt=$TD.prototype;return $Tt.setSelection=function($Tt,$TM){this.focus=!0,laya.display.Input.inputElement.selectionStart=$Tt,laya.display.Input.inputElement.selectionEnd=$TM},$Tt._onUnDisplay=function($Tt){this.focus=!1},$Tt._onMouseDown=function($Tt){this.focus=!0},$Tt._syncInputTransform=function(){var $Tt=this.nativeInput,$TM=$Ta.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$Tf=this._width-this.padding[1]-this.padding[3],$Tc=this._height-this.padding[0]-this.padding[2];$Ts.isConchApp?($Tt.setScale($TM.scaleX,$TM.scaleY),$Tt.setSize($Tf,$Tc),$Tt.setPos($TM.x,$TM.y)):($TD.inputContainer.style.transform=$TD.inputContainer.style.webkitTransform="scale("+$TM.scaleX+","+$TM.scaleY+") rotate("+$TT.stage.canvasDegree+"deg)",$Tt.style.width=$Tf+"px",$Tt.style.height=$Tc+"px",$TD.inputContainer.style.left=$TM.x+"px",$TD.inputContainer.style.top=$TM.y+"px")},$Tt.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$Tt._setInputMethod=function(){$TD.input.parentElement&&$TD.inputContainer.removeChild($TD.input),$TD.area.parentElement&&$TD.inputContainer.removeChild($TD.area),$TD.inputElement=this._multiline?$TD.area:$TD.input,$TD.inputContainer.appendChild($TD.inputElement),$T_t.RightToLeft&&($TD.inputElement.style.direction="rtl")},$Tt._focusIn=function(){laya.display.Input.isInputting=!0;var $Tt=this.nativeInput;this._focus=!0;var $TM=$Tt.style;$TM.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$Tt.readOnly=!this._editable,$Ts.isConchApp&&($Tt.setType(this._type),$Tt.setForbidEdit(!this._editable)),$Tt.maxLength=this._maxChars;this.padding;if($Tt.type=this._type,$Tt.value=this._content,$Tt.placeholder=this._prompt,$TT.stage.off("keydown",this,this._onKeyDown),$TT.stage.on("keydown",this,this._onKeyDown),($TT.stage.focus=this).event("focus"),$TK.onPC&&$Tt.focus(),!$TK.onMiniGame){this._text;this._text=null}this.typeset(),$Tt.setColor(this._originColor),$Tt.setFontSize(this.fontSize),$Tt.setFontFace($TK.onIPhone&&$T_t._fontFamilyMap[this.font]||this.font),$Ts.isConchApp&&$Tt.setMultiAble&&$Tt.setMultiAble(this._multiline),$TM.lineHeight=this.leading+this.fontSize+"px",$TM.fontStyle=this.italic?"italic":"normal",$TM.fontWeight=this.bold?"bold":"normal",$TM.textAlign=this.align,$TM.padding="0 0",this._syncInputTransform(),!$Ts.isConchApp&&$TK.onPC&&$TT.timer.frameLoop(1,this,this._syncInputTransform)},$Tt._setPromptColor=function(){($TD.promptStyleDOM=$TK.getElementById("promptStyle"))||(($TD.promptStyleDOM=$TK.createElement("style")).setAttribute("id","promptStyle"),$TK.document.head.appendChild($TD.promptStyleDOM)),$TD.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$Tt._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($TT.superSet($T_t,this,"text",this._content),$TT.superSet($T_t,this,"color",this._originColor)):($TT.superSet($T_t,this,"text",this._prompt),$TT.superSet($T_t,this,"color",this._promptColor)),$TT.stage.off("keydown",this,this._onKeyDown),$TT.stage.focus=null,this.event("blur"),$Ts.isConchApp&&this.nativeInput.blur(),$TK.onPC&&$TT.timer.clear(this,this._syncInputTransform)},$Tt._onKeyDown=function($Tt){13===$Tt.keyCode&&($TK.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$Tt.changeText=function($Tt){this._content=$Tt,this._focus?(this.nativeInput.value=$Tt||"",this.event("change")):$TM.prototype.changeText.call(this,$Tt)},$Tq(0,$Tt,"color",$TM.prototype._$get_color,function($Tt){this._focus&&this.nativeInput.setColor($Tt),$TT.superSet($T_t,this,"color",this._content?$Tt:this._promptColor),this._originColor=$Tt}),$Tq(0,$Tt,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($Tt){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$Tq(0,$Tt,"multiline",function(){return this._multiline},function($Tt){this._multiline=$Tt,this.valign=$Tt?"top":"middle"}),$Tq(0,$Tt,"maxChars",function(){return this._maxChars},function($Tt){$Tt<=0&&($Tt=1e5),this._maxChars=$Tt}),$Tq(0,$Tt,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($Tt){$TT.superSet($T_t,this,"color",this._originColor),$Tt+="",this._focus?(this.nativeInput.value=$Tt||"",this.event("change")):(this._multiline||($Tt=$Tt.replace(/\r?\n/g,"")),(this._content=$Tt)?$TT.superSet($T_t,this,"text",$Tt):($TT.superSet($T_t,this,"text",this._prompt),$TT.superSet($T_t,this,"color",this.promptColor)))}),$Tq(0,$Tt,"nativeInput",function(){return this._multiline?$TD.area:$TD.input}),$Tq(0,$Tt,"prompt",function(){return this._prompt},function($Tt){!this._text&&$Tt&&$TT.superSet($T_t,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$TT.superSet($T_t,this,"text",this._text==this._prompt?$Tt:this._text):$TT.superSet($T_t,this,"text",$Tt),this._prompt=$T_t.langPacks&&$T_t.langPacks[$Tt]?$T_t.langPacks[$Tt]:$Tt}),$Tq(0,$Tt,"focus",function(){return this._focus},function($Tt){var $TM=this.nativeInput;this._focus!==$Tt&&($Tt?($TM.target?$TM.target._focusOut():this._setInputMethod(),($TM.target=this)._focusIn()):($TM.target=null,this._focusOut(),$TK.document.body.scrollTop=0,$TM.blur(),$Ts.isConchApp?$TM.setPos(-1e4,-1e4):$TD.inputContainer.contains($TM)&&$TD.inputContainer.removeChild($TM)))}),$Tq(0,$Tt,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($Tt){$Tt?(-1<($Tt="[^"+$Tt+"]").indexOf("^^")&&($Tt=$Tt.replace("^^","")),this._restrictPattern=new RegExp($Tt,"g")):this._restrictPattern=null}),$Tq(0,$Tt,"editable",function(){return this._editable},function($Tt){this._editable=$Tt,$Ts.isConchApp&&$TD.input.setForbidEdit(!$Tt)}),$Tq(0,$Tt,"promptColor",function(){return this._promptColor},function($Tt){this._promptColor=$Tt,this._content||$TT.superSet($T_t,this,"color",$Tt)}),$Tq(0,$Tt,"type",function(){return this._type},function($Tt){this._getCSSStyle().password="password"==$Tt,this._type=$Tt,$Ts.isConchApp&&this.nativeInput.setType($Tt)}),$Tq(0,$Tt,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($Tt){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$Tq(0,$Tt,"asPassword",function(){return this._getCSSStyle().password},function($Tt){this._getCSSStyle().password=$Tt,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$TD.__init__=function(){$TD._createInputElement(),$TK.onMobile&&$Ts.canvas.addEventListener($TD.IOS_IFRAME?$TK.onMiniGame?"touchend":"click":"touchend",$TD._popupInputMethod)},$TD._popupInputMethod=function($Tt){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$TD._createInputElement=function(){$TD._initInput($TD.area=$TK.createElement("textarea")),$TD._initInput($TD.input=$TK.createElement("input")),($TD.inputContainer=$TK.createElement("div")).style.position="absolute",$TD.inputContainer.style.zIndex=1e5,$TK.container.appendChild($TD.inputContainer),$TD.inputContainer.setPos=function($Tt,$TM){$TD.inputContainer.style.left=$Tt+"px",$TD.inputContainer.style.top=$TM+"px"}},$TD._initInput=function($TM){var $Tt=$TM.style;$Tt.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$Tt.resize="none",$Tt.backgroundColor="transparent",$Tt.border="none",$Tt.outline="none",$Tt.zIndex=1,$TM.addEventListener("input",$TD._processInputting),$TM.addEventListener("mousemove",$TD._stopEvent),$TM.addEventListener("mousedown",$TD._stopEvent),$TM.addEventListener("touchmove",$TD._stopEvent),$TM.setFontFace=function($Tt){$TM.style.fontFamily=$Tt},$Ts.isConchApp||($TM.setColor=function($Tt){$TM.style.color=$Tt},$TM.setFontSize=function($Tt){$TM.style.fontSize=$Tt+"px"})},$TD._processInputting=function($Tt){var $TM=laya.display.Input.inputElement.target;if($TM){var $Tf=laya.display.Input.inputElement.value;$TM._restrictPattern&&($Tf=$Tf.replace(/\u2006|\x27/g,""),$TM._restrictPattern.test($Tf)&&($Tf=$Tf.replace($TM._restrictPattern,""),laya.display.Input.inputElement.value=$Tf)),$TM._text=$Tf,$TM.event("input")}},$TD._stopEvent=function($Tt){"touchmove"==$Tt.type&&$Tt.preventDefault(),$Tt.stopPropagation&&$Tt.stopPropagation()},$TD.TYPE_TEXT="text",$TD.TYPE_PASSWORD="password",$TD.TYPE_EMAIL="email",$TD.TYPE_URL="url",$TD.TYPE_NUMBER="number",$TD.TYPE_RANGE="range",$TD.TYPE_DATE="date",$TD.TYPE_MONTH="month",$TD.TYPE_WEEK="week",$TD.TYPE_TIME="time",$TD.TYPE_DATE_TIME="datetime",$TD.TYPE_DATE_TIME_LOCAL="datetime-local",$TD.TYPE_SEARCH="search",$TD.input=null,$TD.area=null,$TD.inputElement=null,$TD.inputContainer=null,$TD.confirmButton=null,$TD.promptStyleDOM=null,$TD.inputHeight=45,$TD.isInputting=!1,$TD.stageMatrix=null,$TA($TD,["IOS_IFRAME",function(){return this.IOS_IFRAME=$TK.onIOS&&$TK.window.top!=$TK.window.self}]),$TD}($T_t),$Tht=function($Tt){function $Tf($Tt,$TM){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$Tf.__super.call(this),$Tt&&this._init_($Tt,$TM)}$Tp($Tf,"laya.resource.HTMLImage",$Tet);var $TM=$Tf.prototype;return $TM._init_=function($Tt,$TM){this._src=$Tt,this._source=new $TK.window.Image,$TM&&($TM.onload&&(this.onload=$TM.onload),$TM.onerror&&(this.onerror=$TM.onerror),$TM.onCreate&&$TM.onCreate(this)),0!=$Tt.indexOf("data:image")&&(this._source.crossOrigin=""),$Tt&&(this._source.src=$Tt)},$TM.recreateResource=function(){var $Tt=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $TM=this;this._source=new $TK.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($TM._needReleaseAgain)return $TM._needReleaseAgain=!1,$TM._source.onload=null,void($TM._source=null);$TM._source.onload=null,$TM.memorySize=$Tt._w*$Tt._h*4,$TM._recreateLock=!1,$TM.completeCreate()},this._source.src=this._src}},$TM.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$TM.onresize=function(){this._w=this._source.width,this._h=this._source.height},$Tq(0,$TM,"onload",null,function($Tt){var $TM=this;this._onload=$Tt,this._source&&(this._source.onload=null!=this._onload?function(){$TM.onresize(),$TM._onload()}:null)}),$Tq(0,$TM,"onerror",null,function($Tt){var $TM=this;this._onerror=$Tt,this._source&&(this._source.onerror=null!=this._onerror?function(){$TM._onerror()}:null)}),$Tq(0,$TM,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($Tt){this._enableMerageInAtlas=$Tt,$Ts.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$Tt)}),$Tf.create=function($Tt,$TM){return new $Tf($Tt,$TM)},$Tf}(),$TTt=(function($To){function $Tt(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$Tt.__super.call(this)}$Tp($Tt,"laya.display.EffectAnimation",$To);var $TM=$Tt.prototype;$TM._onOtherBegin=function($Tt){$Tt!=this&&this.stop()},$TM.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$TM._onPlayAction=function(){this.play(0,!1)},$TM.play=function($Tt,$TM,$Tf,$Tc){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=!0),void 0===$Tf&&($Tf=""),void 0===$Tc&&($Tc=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$Tt,$TM,$Tf,$Tc))},$TM._recordInitData=function(){if(this._aniKeys){var $Tt,$TM,$Tf=0;for($Tt=this._aniKeys.length,$Tf=0;$Tf<$Tt;$Tf++)$TM=this._aniKeys[$Tf],this._initData[$TM]=this._target[$TM]}},$TM._displayToIndex=function($Tt){if(this._animationData){$Tt<0&&($Tt=0),$Tt>this._count&&($Tt=this._count);var $TM=this._animationData.nodes,$Tf=0,$Tc=$TM.length;for($Tc=1<$Tc?1:$Tc,$Tf=0;$Tf<$Tc;$Tf++)this._displayNodeToFrame($TM[$Tf],$Tt)}},$TM._displayNodeToFrame=function($Tt,$TM,$Tf){if(this._target){var $Tc;$Tc=this._target;var $TD,$To,$TJ,$TZ,$TA=$Tt.frames,$TL=$Tt.keys,$Tp=0,$TB=$TL.length;$TZ=$Tt.secondFrames;var $Tb,$TI,$Tq,$Tl,$T_=0;for($Tp=0;$Tp<$TB;$Tp++)$To=$TA[$TD=$TL[$Tp]],$TJ=-1==($T_=$TZ[$TD])?this._initData[$TD]:$TM<$T_?($Tq=($TI=$Tt.keyframes[$TD])[0]).tween?(null==($Tb=$Tn[$Tq.tweenMethod])&&($Tb=$Tn.linearNone),$Tl=$TI[1],$Tb($TM,this._initData[$TD],$Tl.value-this._initData[$TD],$Tl.index)):this._initData[$TD]:$To.length>$TM?$To[$TM]:$To[$To.length-1],$Tc[$TD]=$TJ}},$TM._calculateNodeKeyFrames=function($Tt){$To.prototype._calculateNodeKeyFrames.call(this,$Tt);var $TM,$Tf,$Tc,$TD=$Tt.keyframes;$Tt.target;for($TM in $Tc={},$Tt.secondFrames=$Tc,$TD)($Tf=$TD[$TM]).length<=1?$Tc[$TM]=-1:$Tc[$TM]=$Tf[1].index},$Tq(0,$TM,"target",function(){return this._target},function($Tt){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$Tt,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$Tq(0,$TM,"playEvent",null,function($Tt){(this._playEvents=$Tt)&&this.addEvent()}),$Tq(0,$TM,"effectData",null,function($Tt){var $TM;$Tt&&(($TM=$Tt.animations)&&$TM[0]&&(this._setUp({},$TM[0]),$TM[0].nodes&&$TM[0].nodes[0]&&(this._aniKeys=$TM[0].nodes[0].keys)))}),$Tq(0,$TM,"effectClass",null,function($Tt){var $TM,$Tf;(this._effectClass=$T$.getClass($Tt),this._effectClass)&&(($TM=this._effectClass.uiView)&&($Tf=$TM.animations)&&$Tf[0]&&(this._setUp({},$Tf[0]),$Tf[0].nodes&&$Tf[0].nodes[0]&&(this._aniKeys=$Tf[0].nodes[0].keys)))}),$Tt.EffectAnimationBegin="effectanimationbegin"}($TXt),function($TM){var $TO;function $TC(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$TC.__super.call(this)}$Tp($TC,"laya.utils.GraphicAnimation",$TM);var $Tt=$TC.prototype;return $Tt._parseNodeList=function($Tt){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$Tt.compId]=$Tt.props,$Tt.compId&&this._nodeList.push($Tt.compId);var $TM=$Tt.child;if($TM){var $Tf=0,$Tc=$TM.length;for($Tf=0;$Tf<$Tc;$Tf++)this._parseNodeList($TM[$Tf])}},$Tt._calGraphicData=function($Tt){var $TM;if(this._setUp(null,$Tt),this._createGraphicData(),this._nodeIDAniDic)for($TM in this._nodeIDAniDic)this._nodeIDAniDic[$TM]=null},$Tt._createGraphicData=function(){var $Tt,$TM=[],$Tf=0,$Tc=this.count,$TD=this._animationNewFrames;for($TD||($TD=[]),$Tf=0;$Tf<$Tc;$Tf++)!$TD[$Tf]&&$Tt||($Tt=this._createFrameGraphic($Tf)),$TM.push($Tt);this._gList=$TM},$Tt._createFrameGraphic=function($Tt){var $TM=$TU.createGraphics();return $TC._rootMatrix||($TC._rootMatrix=new $TF),this._updateNodeGraphic(this._rootNode,$Tt,$TC._rootMatrix,$TM),$TM},$Tt._updateNodeGraphic=function($Tt,$TM,$Tf,$Tc,$TD){var $To;void 0===$TD&&($TD=1);var $TJ,$TZ,$TA,$TL=($To=this._nodeGDic[$Tt.compId]=this._getNodeGraphicData($Tt.compId,$TM,this._nodeGDic[$Tt.compId])).alpha*$TD;if(!($TL<.01)&&($To.resultTransform||($To.resultTransform=$TF.create()),$TJ=$To.resultTransform,$TF.mul($To.transform,$Tf,$TJ),$To.skin&&($TZ=this._getTextureByUrl($To.skin))&&($TJ._checkTransform()?($Tc.drawTexture($TZ,0,0,$To.width,$To.height,$TJ,$TL),$To.resultTransform=null):$Tc.drawTexture($TZ,$TJ.tx,$TJ.ty,$To.width,$To.height,null,$TL)),$TA=$Tt.child)){var $Tp,$TB=0;for($Tp=$TA.length,$TB=0;$TB<$Tp;$TB++)this._updateNodeGraphic($TA[$TB],$TM,$TJ,$Tc,$TL)}},$Tt._updateNoChilds=function($Tt,$TM){if($Tt.skin){var $Tf=this._getTextureByUrl($Tt.skin);if($Tf){var $Tc=$Tt.transform;$Tc._checkTransform();!$Tc.bTransform?$TM.drawTexture($Tf,$Tc.tx,$Tc.ty,$Tt.width,$Tt.height,null,$Tt.alpha):$TM.drawTexture($Tf,0,0,$Tt.width,$Tt.height,$Tc.clone(),$Tt.alpha)}}},$Tt._updateNodeGraphic2=function($Tt,$TM,$Tf){var $Tc;if($Tc=this._nodeGDic[$Tt.compId]=this._getNodeGraphicData($Tt.compId,$TM,this._nodeGDic[$Tt.compId]),$Tt.child){var $TD=$Tc.transform;$TD._checkTransform();var $To,$TJ;$TJ=($To=!$TD.bTransform)&&(0!=$TD.tx||0!=$TD.ty);var $TZ,$TA,$TL;if(($TZ=$TD.bTransform||1!=$Tc.alpha)&&$Tf.save(),1!=$Tc.alpha&&$Tf.alpha($Tc.alpha),$To?$TJ&&$Tf.translate($TD.tx,$TD.ty):$Tf.transform($TD.clone()),$TA=$Tt.child,$Tc.skin&&($TL=this._getTextureByUrl($Tc.skin))&&$Tf.drawTexture($TL,0,0,$Tc.width,$Tc.height),$TA){var $Tp,$TB=0;for($Tp=$TA.length,$TB=0;$TB<$Tp;$TB++)this._updateNodeGraphic2($TA[$TB],$TM,$Tf)}$TZ?$Tf.restore():$To?$TJ&&$Tf.translate(-$TD.tx,-$TD.ty):$Tf.transform($TD.clone().invert())}else this._updateNoChilds($Tc,$Tf)},$Tt._calculateNodeKeyFrames=function($Tt){$TM.prototype._calculateNodeKeyFrames.call(this,$Tt),this._nodeIDAniDic[$Tt.target]=$Tt},$Tt.getNodeDataByID=function($Tt){return this._nodeIDAniDic[$Tt]},$Tt._getParams=function($Tt,$TM,$Tf,$Tc){var $TD=$TC._temParam;$TD.length=$TM.length;var $To=0,$TJ=$TM.length;for($To=0;$To<$TJ;$To++)$TD[$To]=this._getObjVar($Tt,$TM[$To][0],$Tf,$TM[$To][1],$Tc);return $TD},$Tt._getObjVar=function($Tt,$TM,$Tf,$Tc,$TD){if($Tt.hasOwnProperty($TM)){var $To=$Tt[$TM];if($Tf>=$To.length&&($Tf=$To.length-1),null!=$Tt[$TM][$Tf])return $Tt[$TM][$Tf]}return $TD.hasOwnProperty($TM)?$TD[$TM]:$Tc},$Tt._getNodeGraphicData=function($Tt,$TM,$Tf){$Tf||($Tf=$TO.create()),$Tf.transform?$Tf.transform.identity():$Tf.transform=$TF.create();var $Tc=this.getNodeDataByID($Tt);if(!$Tc)return $Tf;var $TD,$To,$TJ=$Tc.frames,$TZ=this._getParams($TJ,$TC._drawTextureCmd,$TM,this._nodeDefaultProps[$Tt]),$TA=$TZ[0],$TL=NaN,$Tp=NaN,$TB=$TZ[5],$Tb=$TZ[6],$TI=$TZ[13],$Tq=$TZ[14],$Tl=$TZ[7],$T_=$TZ[8],$TE=$TZ[9],$Te=$TZ[11],$TN=$TZ[12];$TL=$TZ[3],$Tp=$TZ[4],0!=$TL&&0!=$Tp||($TA=null),-1==$TL&&($TL=0),-1==$Tp&&($Tp=0),$Tf.skin=$TA,$Tf.width=$TL,$Tf.height=$Tp,$TA&&(($TD=this._getTextureByUrl($TA))?($TL||($TL=$TD.sourceWidth),$Tp||($Tp=$TD.sourceHeight)):console.warn("lost skin:",$TA,",you may load pics first")),$Tf.alpha=$TZ[10],$To=$Tf.transform,0!=$TI&&($TB=$TI*$TL),0!=$Tq&&($Tb=$Tq*$Tp),0==$TB&&0==$Tb||$To.translate(-$TB,-$Tb);var $TX=null;if($TE||1!==$Tl||1!==$T_||$Te||$TN){($TX=$TC._tempMt).identity(),$TX.bTransform=!0;var $Ty=.0174532922222222*($TE-$Te),$Th=.0174532922222222*($TE+$TN),$TT=Math.cos($Th),$Ti=Math.sin($Th),$TV=Math.sin($Ty),$Tx=Math.cos($Ty);$TX.a=$Tl*$TT,$TX.b=$Tl*$Ti,$TX.c=-$T_*$TV,$TX.d=$T_*$Tx,$TX.tx=$TX.ty=0}return $TX&&($To=$TF.mul($To,$TX,$To)),$To.translate($TZ[1],$TZ[2]),$Tf},$Tt._getTextureByUrl=function($Tt){return $TZt.getRes($Tt)},$Tt.setAniData=function($Tt,$TM){if($Tt.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$Tt,this._parseNodeList($Tt);var $Tf,$Tc={},$TD=[],$To=$Tt.animations,$TJ=0,$TZ=$To.length;for($TJ=0;$TJ<$TZ;$TJ++)if($Tf=$To[$TJ],this._labels=null,(!$TM||$TM==$Tf.name)&&$Tf){try{this._calGraphicData($Tf)}catch($Tt){console.warn("parse animation fail:"+$Tf.name+",empty animation created"),this._gList=[]}var $TA={};$TA.interval=1e3/$Tf.frameRate,$TA.frames=this._gList,$TA.labels=this._labels,$TA.name=$Tf.name,$TD.push($TA),$Tc[$Tf.name]=$TA}this.animationList=$TD,this.animationDic=$Tc}$TC._temParam.length=0},$Tt.parseByData=function($Tt){var $TM,$Tf;$TM=$Tt.nodeRoot,$Tf=$Tt.aniO,delete $Tt.nodeRoot,delete $Tt.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$TM,this._parseNodeList($TM),this._labels=null;try{this._calGraphicData($Tf)}catch($Tt){console.warn("parse animation fail:"+$Tf.name+",empty animation created"),this._gList=[]}var $Tc=$Tt;return $Tc.interval=1e3/$Tf.frameRate,$Tc.frames=this._gList,$Tc.labels=this._labels,$Tc.name=$Tf.name,$Tc},$Tt.setUpAniData=function($Tt){if($Tt.animations){var $TM,$Tf={},$Tc=[],$TD=$Tt.animations,$To=0,$TJ=$TD.length;for($To=0;$To<$TJ;$To++)if($TM=$TD[$To]){var $TZ={};$TZ.name=$TM.name,$TZ.aniO=$TM,$TZ.nodeRoot=$Tt,$Tc.push($TZ),$Tf[$TM.name]=$TZ}this.animationList=$Tc,this.animationDic=$Tf}},$Tt._clear=function(){var $Tt,$TM;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($Tt in this._nodeGDic)($TM=this._nodeGDic[$Tt])&&$TM.recover();this._nodeGDic=null},$TC.parseAnimationByData=function($Tt){var $TM;return $TC._I||($TC._I=new $TC),$TM=$TC._I.parseByData($Tt),$TC._I._clear(),$TM},$TC.parseAnimationData=function($Tt){var $TM;return $TC._I||($TC._I=new $TC),$TC._I.setUpAniData($Tt),($TM={}).animationList=$TC._I.animationList,$TM.animationDic=$TC._I.animationDic,$TC._I._clear(),$TM},$TC._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$TC._temParam=[],$TC._I=null,$TC._rootMatrix=null,$TA($TC,["_tempMt",function(){return this._tempMt=new $TF}]),$TC.__init$=function(){$TO=function(){function $Tt(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $Tp($Tt,""),$Tt.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$Tg.recover("GraphicNode",this)},$Tt.create=function(){return $Tg.getItemByClass("GraphicNode",$Tt)},$Tt}()},$TC}($TXt));$TT.__init([$TL,$TAt,$Ts,$TK,$Tm,$Tx,$Tt,$TTt])}(window,document,Laya),function($Tt,$TM,$Tf){$Tf.un,$Tf.uns,$Tf.static;var $Tc=$Tf.class;$Tf.getset,$Tf.__newvec;new(function(){function $Tt(){}return $Tc($Tt,"LayaMain"),$Tt}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}}),function($Tt,$TM,$Th){$Th.un,$Th.uns;var $TJ=$Th.static,$Tb=$Th.class,$Tc=$Th.getset,$To=$Th.__newvec,$Tp=laya.maths.Arith,$TB=laya.maths.Bezier,$Tf=laya.resource.Bitmap,$TI=laya.utils.Browser,$TA=laya.utils.Byte,$Tq=laya.utils.Color,$TT=(laya.filters.ColorFilter,$Th.Config),$TD=laya.resource.Context,$Ti=(laya.events.Event,laya.filters.Filter),$TZ=laya.display.Graphics,$TL=laya.resource.HTMLCanvas,$Tl=(laya.utils.HTMLChar,laya.resource.HTMLImage),$T_=laya.resource.HTMLSubImage,$TV=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$Tx=laya.maths.Point,$TO=laya.maths.Rectangle,$TE=laya.renders.Render,$Te=(laya.renders.RenderContext,laya.renders.RenderSprite),$TN=laya.resource.Resource,$TX=laya.resource.ResourceManager,$Ty=laya.utils.RunDriver,$TC=laya.display.Sprite,$TU=laya.display.Stage,$TF=laya.utils.Stat,$TS=laya.utils.StringKey,$TH=(laya.display.css.Style,laya.system.System),$Ts=laya.display.Text,$Tr=laya.resource.Texture,$Tu=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$Tv=laya.utils.VectorGraphManager;laya.utils.WordText;$Th.interface("laya.webgl.shapes.IShape"),$Th.interface("laya.webgl.submit.ISubmit"),$Th.interface("laya.webgl.text.ICharSegment"),$Th.interface("laya.webgl.canvas.save.ISaveData"),$Th.interface("laya.webgl.resource.IMergeAtlasBitmap"),$Th.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $Tk=function(){function $Tt(){}$Tb($Tt,"laya.filters.webgl.FilterActionGL");var $TM=$Tt.prototype;return $Th.imps($TM,{"laya.filters.IFilterActionGL":!0}),$TM.setValue=function($Tt){},$TM.setValueMix=function($Tt){},$TM.apply3d=function($Tt,$TM,$Tf,$Tc,$TD){return null},$TM.apply=function($Tt){return null},$Tc(0,$TM,"typeMix",function(){return 0}),$Tt}(),$TK=function(){function $Tt(){}return $Tb($Tt,"laya.webgl.shader.ShaderValue"),$Tt}(),$Tj=function(){var $Tc,$TD;function $Tt($Tt,$TM,$Tf){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $TD,void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),this._cells=null,this._rowInfo=null,this._init($Tt,$TM),this._atlasID=$Tf}$Tb($Tt,"laya.webgl.atlas.AtlasGrid");var $TM=$Tt.prototype;return $TM.getAltasID=function(){return this._atlasID},$TM.setAltasID=function($Tt){0<=$Tt&&(this._atlasID=$Tt)},$TM.addTex=function($Tt,$TM,$Tf){var $Tc=this._get($TM,$Tf);return 0==$Tc.ret||(this._fill($Tc.x,$Tc.y,$TM,$Tf,$Tt),this._texCount++),$Tc},$TM._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$TM._init=function($Tt,$TM){if(this._width=$Tt,this._height=$TM,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$To(this._height);for(var $Tf=0;$Tf<this._height;$Tf++)this._rowInfo[$Tf]=new $Tc;return this._clear(),!0},$TM._get=function($Tt,$TM){var $Tf=new $T$;if($Tt>=this._failSize.width&&$TM>=this._failSize.height)return $Tf;for(var $Tc=-1,$TD=-1,$To=this._width,$TJ=this._height,$TZ=this._cells,$TA=0;$TA<$TJ;$TA++)if(!(this._rowInfo[$TA].spaceCount<$Tt))for(var $TL=0;$TL<$To;){var $Tp=3*($TA*$To+$TL);if(0!=$TZ[$Tp]||$TZ[1+$Tp]<$Tt||$TZ[2+$Tp]<$TM)$TL+=$TZ[1+$Tp];else{$Tc=$TL,$TD=$TA;for(var $TB=0;$TB<$Tt;$TB++)if($TZ[3*$TB+$Tp+2]<$TM){$Tc=-1;break}if(!($Tc<0))return $Tf.ret=!0,$Tf.x=$Tc,$Tf.y=$TD,$Tf;$TL+=$TZ[1+$Tp]}}return $Tf},$TM._fill=function($Tt,$TM,$Tf,$Tc,$TD){var $To=this._width,$TJ=this._height;this._check($Tt+$Tf<=$To&&$TM+$Tc<=$TJ);for(var $TZ=$TM;$TZ<$Tc+$TM;++$TZ){this._check(this._rowInfo[$TZ].spaceCount>=$Tf),this._rowInfo[$TZ].spaceCount-=$Tf;for(var $TA=0;$TA<$Tf;$TA++){var $TL=3*($Tt+$TZ*$To+$TA);this._check(0==this._cells[$TL]),this._cells[$TL]=$TD,this._cells[1+$TL]=$Tf,this._cells[2+$TL]=$Tc}}if(0<$Tt)for($TZ=0;$TZ<$Tc;++$TZ){var $Tp=0;for($TA=$Tt-1;0<=$TA&&0==this._cells[3*(($TM+$TZ)*$To+$TA)];--$TA,++$Tp);for($TA=$Tp;0<$TA;--$TA)this._cells[3*(($TM+$TZ)*$To+$Tt-$TA)+1]=$TA,this._check(0<$TA)}if(0<$TM)for($TA=$Tt;$TA<$Tt+$Tf;++$TA){for($Tp=0,$TZ=$TM-1;0<=$TZ&&0==this._cells[3*($TA+$TZ*$To)];--$TZ,$Tp++);for($TZ=$Tp;0<$TZ;--$TZ)this._cells[3*($TA+($TM-$TZ)*$To)+2]=$TZ,this._check(0<$TZ)}},$TM._check=function($Tt){0==$Tt&&console.log("xtexMerger 错误啦")},$TM._clear=function(){for(var $Tt=this._texCount=0;$Tt<this._height;$Tt++)this._rowInfo[$Tt].spaceCount=this._width;for(var $TM=0;$TM<this._height;$TM++)for(var $Tf=0;$Tf<this._width;$Tf++){var $Tc=3*($TM*this._width+$Tf);this._cells[$Tc]=0,this._cells[1+$Tc]=this._width-$Tf,this._cells[2+$Tc]=this._width-$TM}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$Tt.__init$=function(){$Tc=function(){function $Tt(){this.spaceCount=0}return $Tb($Tt,""),$Tt}(),$TD=function(){function $Tt(){this.width=0,this.height=0}return $Tb($Tt,""),$Tt}()},$Tt}(),$Td=function(){function $TE($Tt,$TM,$Tf,$Tc){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$Tt,this._height=$TM,this._gridSize=$Tf,this._maxAtlaserCount=$Tc,this._gridNumX=$Tt/$Tf,this._gridNumY=$TM/$Tf,this._curAtlasIndex=0,this._atlaserArray=[]}$Tb($TE,"laya.webgl.atlas.AtlasResourceManager");var $Tt=$TE.prototype;return $Tt.setAtlasParam=function($Tt,$TM,$Tf,$Tc){if(1==this._setAtlasParam)return $TE._sid_=0,this._width=$Tt,this._height=$TM,this._gridSize=$Tf,this._maxAtlaserCount=$Tc,this._gridNumX=$Tt/$Tf,this._gridNumY=$TM/$Tf,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$Tt.pushData=function($Tt){var $TM,$Tf=$Tt.bitmap,$Tc=-1,$TD=null,$To=0,$TJ=0;for($To=0,$TM=this._atlaserArray.length;$To<$TM&&($TJ=(this._curAtlasIndex+$To)%$TM,-1==($Tc=($TD=this._atlaserArray[$TJ]).findBitmapIsExist($Tf)));$To++);if(-1!=$Tc){var $TZ=$TD.InAtlasWebGLImagesOffsetValue[$Tc];return $Tq=$TZ[0],$Tl=$TZ[1],$TD.addToAtlas($Tt,$Tq,$Tl),!0}this._setAtlasParam=!1;for(var $TA=Math.ceil(($Tt.bitmap.width+2)/this._gridSize),$TL=Math.ceil(($Tt.bitmap.height+2)/this._gridSize),$Tp=!1,$TB=0;$TB<2;$TB++){var $Tb=this._maxAtlaserCount;for($To=0;$To<$Tb;$To++){$TJ=(this._curAtlasIndex+$To)%$Tb,this._atlaserArray.length-1>=$TJ||this._atlaserArray.push(new $TOt(this._gridNumX,this._gridNumY,this._width,this._height,$TE._sid_++));var $TI=this._atlaserArray[$TJ],$Tq=0,$Tl=0,$T_=$TI.addTex(1,$TA,$TL);if($T_.ret){$Tq=$T_.x*this._gridSize+1,$Tl=$T_.y*this._gridSize+1,$Tf.lock=!0,$TI.addToAtlasTexture($Tf,$Tq,$Tl),$TI.addToAtlas($Tt,$Tq,$Tl),$Tp=!0,this._curAtlasIndex=$TJ;break}}if($Tp)break;this._atlaserArray.push(new $TOt(this._gridNumX,this._gridNumY,this._width,this._height,$TE._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $Tp||console.log(">>>AtlasManager pushData error"),$Tp},$Tt.addToAtlas=function($Tt){laya.webgl.atlas.AtlasResourceManager.instance.pushData($Tt)},$Tt.garbageCollection=function(){if(!0===this._needGC){for(var $Tt=this._atlaserArray.length-this._maxAtlaserCount,$TM=0;$TM<$Tt;$TM++)this._atlaserArray[$TM].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$Tt),this._atlaserArray.splice(0,$Tt),this._needGC=!1}return!0},$Tt.freeAll=function(){for(var $Tt=0,$TM=this._atlaserArray.length;$Tt<$TM;$Tt++)this._atlaserArray[$Tt].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$Tt.getAtlaserCount=function(){return this._atlaserArray.length},$Tt.getAtlaserByIndex=function($Tt){return this._atlaserArray[$Tt]},$Tc(1,$TE,"instance",function(){return $TE._Instance||($TE._Instance=new $TE(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$TE._Instance}),$Tc(1,$TE,"enabled",function(){return $TT.atlasEnable}),$Tc(1,$TE,"atlasLimitWidth",function(){return $TE._atlasLimitWidth},function($Tt){$TE._atlasLimitWidth=$Tt}),$Tc(1,$TE,"atlasLimitHeight",function(){return $TE._atlasLimitHeight},function($Tt){$TE._atlasLimitHeight=$Tt}),$TE._enable=function(){$TT.atlasEnable=!0},$TE._disable=function(){$TT.atlasEnable=!1},$TE.__init__=function(){$TE.atlasTextureWidth=2048,$TE.atlasTextureHeight=2048,$TE.maxTextureCount=6,$TE.atlasLimitWidth=512,$TE.atlasLimitHeight=512},$TE._atlasLimitWidth=0,$TE._atlasLimitHeight=0,$TE.gridSize=16,$TE.atlasTextureWidth=0,$TE.atlasTextureHeight=0,$TE.maxTextureCount=0,$TE._atlasRestore=0,$TE.BOARDER_TYPE_NO=0,$TE.BOARDER_TYPE_RIGHT=1,$TE.BOARDER_TYPE_LEFT=2,$TE.BOARDER_TYPE_BOTTOM=4,$TE.BOARDER_TYPE_TOP=8,$TE.BOARDER_TYPE_ALL=15,$TE._sid_=0,$TE._Instance=null,$TE}(),$T$=function(){function $Tt(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $Tb($Tt,"laya.webgl.atlas.MergeFillInfo"),$Tt}(),$TP=function(){function $TM(){}return $Tb($TM,"laya.webgl.canvas.BlendMode"),$TM._init_=function($Tt){$TM.fns=[$TM.BlendNormal,$TM.BlendAdd,$TM.BlendMultiply,$TM.BlendScreen,$TM.BlendOverlay,$TM.BlendLight,$TM.BlendMask,$TM.BlendDestinationOut],$TM.targetFns=[$TM.BlendNormalTarget,$TM.BlendAddTarget,$TM.BlendMultiplyTarget,$TM.BlendScreenTarget,$TM.BlendOverlayTarget,$TM.BlendLightTarget,$TM.BlendMask,$TM.BlendDestinationOut]},$TM.BlendNormal=function($Tt){$Tt.blendFunc(1,771)},$TM.BlendAdd=function($Tt){$Tt.blendFunc(1,772)},$TM.BlendMultiply=function($Tt){$Tt.blendFunc(774,771)},$TM.BlendScreen=function($Tt){$Tt.blendFunc(1,1)},$TM.BlendOverlay=function($Tt){$Tt.blendFunc(1,769)},$TM.BlendLight=function($Tt){$Tt.blendFunc(1,1)},$TM.BlendNormalTarget=function($Tt){$Tt.blendFunc(1,771)},$TM.BlendAddTarget=function($Tt){$Tt.blendFunc(1,772)},$TM.BlendMultiplyTarget=function($Tt){$Tt.blendFunc(774,771)},$TM.BlendScreenTarget=function($Tt){$Tt.blendFunc(1,1)},$TM.BlendOverlayTarget=function($Tt){$Tt.blendFunc(1,769)},$TM.BlendLightTarget=function($Tt){$Tt.blendFunc(1,1)},$TM.BlendMask=function($Tt){$Tt.blendFunc(0,770)},$TM.BlendDestinationOut=function($Tt){$Tt.blendFunc(0,0)},$TM.activeBlendFunction=null,$TM.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$TM.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$TM.NORMAL="normal",$TM.ADD="add",$TM.MULTIPLY="multiply",$TM.SCREEN="screen",$TM.LIGHT="light",$TM.OVERLAY="overlay",$TM.DESTINATIONOUT="destination-out",$TM.fns=[],$TM.targetFns=[],$TM}(),$TY=function(){function $Tf($Tt){this._color=$Tq.create("black"),this.setValue($Tt)}$Tb($Tf,"laya.webgl.canvas.DrawStyle");var $Tt=$Tf.prototype;return $Tt.setValue=function($Tt){if($Tt){if("string"==typeof $Tt)return void(this._color=$Tq.create($Tt));if($Tt instanceof laya.utils.Color)return void(this._color=$Tt)}},$Tt.reset=function(){this._color=$Tq.create("black")},$Tt.equal=function($Tt){return"string"==typeof $Tt?this._color.strColor===$Tt:$Tt instanceof laya.utils.Color&&this._color.numColor===$Tt.numColor},$Tt.toColorStr=function(){return this._color.strColor},$Tf.create=function($Tt){var $TM;if($Tt&&("string"==typeof $Tt?$TM=$Tq.create($Tt):$Tt instanceof laya.utils.Color&&($TM=$Tt),$TM))return $TM._drawStyle||($TM._drawStyle=new $Tf($Tt));return laya.webgl.canvas.DrawStyle.DEFAULT},$TJ($Tf,["DEFAULT",function(){return this.DEFAULT=new $Tf("#000000")}]),$Tf}(),$Tn=function(){function $Tt(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$TXt.mainContext;this.ib=$Twt.create(35048),this.vb=$TWt.create(5)}$Tb($Tt,"laya.webgl.canvas.Path");var $TM=$Tt.prototype;return $TM.addPoint=function($Tt,$TM){this.tempArray.push($Tt,$TM)},$TM.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$TM.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$TM.polygon=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ;return this.geomatrys.push(this._curGeomatry=$TJ=new $TSt($Tt,$TM,$Tf,$Tc,$TD,$To)),$Tc||($TJ.fill=!1),null==$To&&($TJ.borderWidth=0),$TJ},$TM.setGeomtry=function($Tt){this.geomatrys.push(this._curGeomatry=$Tt)},$TM.drawLine=function($Tt,$TM,$Tf,$Tc,$TD){var $To;return this.closePath?this.geomatrys.push(this._curGeomatry=$To=new $TFt($Tt,$TM,$Tf,$Tc,$TD)):this.geomatrys.push(this._curGeomatry=$To=new $TUt($Tt,$TM,$Tf,$Tc,$TD)),$To.fill=!1,$To},$TM.update=function(){var $Tt=this.ib._byteLength,$TM=this.geomatrys.length;this.offset=$Tt;for(var $Tf=this.geoStart;$Tf<$TM;$Tf++)this.geomatrys[$Tf].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$TM,this.count=(this.ib._byteLength-$Tt)/$Tlt.BYTES_PIDX},$TM.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$TM.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$Tt}(),$TR=function(){function $TZ(){}$Tb($TZ,"laya.webgl.canvas.save.SaveBase");var $Tt=$TZ.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!1},$Tt.restore=function($Tt){this._dataObj[this._valueName]=this._value,($TZ._cache[$TZ._cache._length++]=this)._newSubmit&&($Tt._curSubmit=$Tot.RENDERBASE,$Tt._renderKey=0)},$TZ._createArray=function(){var $Tt=[];return $Tt._length=0,$Tt},$TZ._init=function(){var $Tt=$TZ._namemap={};return $Tt[1]="ALPHA",$Tt[2]="fillStyle",$Tt[8]="font",$Tt[256]="lineWidth",$Tt[512]="strokeStyle",$Tt[8192]="_mergeID",$Tt[1024]=$Tt[2048]=$Tt[4096]=[],$Tt[16384]="textBaseline",$Tt[32768]="textAlign",$Tt[65536]="_nBlendType",$Tt[1048576]="shader",$Tt[2097152]="filters",$Tt},$TZ.save=function($Tt,$TM,$Tf,$Tc){if(($Tt._saveMark._saveuse&$TM)!==$TM){$Tt._saveMark._saveuse|=$TM;var $TD=$TZ._cache,$To=0<$TD._length?$TD[--$TD._length]:new $TZ;$To._value=$Tf[$To._valueName=$TZ._namemap[$TM]],$To._dataObj=$Tf,$To._newSubmit=$Tc;var $TJ=$Tt._save;$TJ[$TJ._length++]=$To}},$TZ._cache=laya.webgl.canvas.save.SaveBase._createArray(),$TZ._namemap=$TZ._init(),$TZ}(),$Tg=function(){function $To(){this._clipRect=new $TO}$Tb($To,"laya.webgl.canvas.save.SaveClipRect");var $Tt=$To.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!1},$Tt.restore=function($Tt){$Tt._clipRect=this._clipSaveRect,($To._cache[$To._cache._length++]=this)._submitScissor.submitLength=$Tt._submits._length-this._submitScissor.submitIndex,$Tt._curSubmit=$Tot.RENDERBASE,$Tt._renderKey=0},$To.save=function($Tt,$TM){if(131072!=(131072&$Tt._saveMark._saveuse)){$Tt._saveMark._saveuse|=131072;var $Tf=$To._cache,$Tc=0<$Tf._length?$Tf[--$Tf._length]:new $To;$Tc._clipSaveRect=$Tt._clipRect,$Tt._clipRect=$Tc._clipRect.copyFrom($Tt._clipRect),$Tc._submitScissor=$TM;var $TD=$Tt._save;$TD[$TD._length++]=$Tc}},$TJ($To,["_cache",function(){return this._cache=$TR._createArray()}]),$To}(),$Tz=function(){function $TI(){this._contextX=0,this._contextY=0,this._clipRect=new $TO,this._rect=new $TO,this._matrix=new $TV}$Tb($TI,"laya.webgl.canvas.save.SaveClipRectStencil");var $Tt=$TI.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!1},$Tt.restore=function($Tt){$Tpt.restore($Tt,this._rect,this._saveMatrix,this._contextX,this._contextY),$Tt._clipRect=this._clipSaveRect,$Tt._curMat=this._saveMatrix,$Tt._x=this._contextX,$Tt._y=this._contextY,$TI._cache[$TI._cache._length++]=this,$Tt._curSubmit=$Tot.RENDERBASE},$TI.save=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){if(262144!=(262144&$Tt._saveMark._saveuse)){$Tt._saveMark._saveuse|=262144;var $Tp=$TI._cache,$TB=0<$Tp._length?$Tp[--$Tp._length]:new $TI;$TB._clipSaveRect=$Tt._clipRect,$TB._clipRect.setTo($TJ,$TZ,$TA,$TL),$Tt._clipRect=$TB._clipRect,$TB._rect.x=$Tf,$TB._rect.y=$Tc,$TB._rect.width=$TD,$TB._rect.height=$To,$TB._contextX=$Tt._x,$TB._contextY=$Tt._y,$TB._saveMatrix=$Tt._curMat,$Tt._curMat.copyTo($TB._matrix),$Tt._curMat=$TB._matrix,$TB._submitStencil=$TM;var $Tb=$Tt._save;$Tb[$Tb._length++]=$TB}},$TJ($TI,["_cache",function(){return this._cache=$TR._createArray()}]),$TI}(),$Tm=function(){function $Tc(){this._saveuse=0}$Tb($Tc,"laya.webgl.canvas.save.SaveMark");var $Tt=$Tc.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!0},$Tt.restore=function($Tt){$Tt._saveMark=this._preSaveMark,$Tc._no[$Tc._no._length++]=this},$Tc.Create=function($Tt){var $TM=$Tc._no,$Tf=0<$TM._length?$TM[--$TM._length]:new $Tc;return $Tf._saveuse=0,$Tf._preSaveMark=$Tt._saveMark,$Tt._saveMark=$Tf},$TJ($Tc,["_no",function(){return this._no=$TR._createArray()}]),$Tc}(),$TG=function(){function $To(){this._matrix=new $TV}$Tb($To,"laya.webgl.canvas.save.SaveTransform");var $Tt=$To.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!1},$Tt.restore=function($Tt){$Tt._curMat=this._savematrix,$To._no[$To._no._length++]=this},$To.save=function($Tt){var $TM=$Tt._saveMark;if(2048!=(2048&$TM._saveuse)){$TM._saveuse|=2048;var $Tf=$To._no,$Tc=0<$Tf._length?$Tf[--$Tf._length]:new $To;$Tc._savematrix=$Tt._curMat,$Tt._curMat=$Tt._curMat.copyTo($Tc._matrix);var $TD=$Tt._save;$TD[$TD._length++]=$Tc}},$TJ($To,["_no",function(){return this._no=$TR._createArray()}]),$To}(),$Ta=function(){function $TD(){}$Tb($TD,"laya.webgl.canvas.save.SaveTranslate");var $Tt=$TD.prototype;return $Th.imps($Tt,{"laya.webgl.canvas.save.ISaveData":!0}),$Tt.isSaveMark=function(){return!1},$Tt.restore=function($Tt){$Tt._curMat;$Tt._x=this._x,$Tt._y=this._y,$TD._no[$TD._no._length++]=this},$TD.save=function($Tt){var $TM=$TD._no,$Tf=0<$TM._length?$TM[--$TM._length]:new $TD;$Tf._x=$Tt._x,$Tf._y=$Tt._y;var $Tc=$Tt._save;$Tc[$Tc._length++]=$Tf},$TJ($TD,["_no",function(){return this._no=$TR._createArray()}]),$TD}(),$TQ=function(){function $Tt(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $TO}$Tb($Tt,"laya.webgl.resource.RenderTargetMAX");var $TM=$Tt.prototype;return $TM.setSP=function($Tt){this._sp=$Tt},$TM.size=function($Tt,$TM){var $Tf=this;this._width!==$Tt||this._height!==$TM?(this.repaint=!0,this._width=$Tt,this._height=$TM,this.target?this.target.size($Tt,$TM):this.target=$Tvt.create($Tt,$TM),this.target.hasListener("recovered")||this.target.on("recovered",this,function($Tt){$Th.timer.callLater($Tf._sp,$Tf._sp.repaint)})):this.target.size($Tt,$TM)},$TM._flushToTarget=function($Tt,$TM){if(!$TM._destroy){var $Tf=$Tet.worldScissorTest,$Tc=$Tet.worldClipRect;$Tet.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$Tet.worldScissorTest=!1,$TXt.mainContext.disable(3089);var $TD=$Tet.worldAlpha,$To=$Tet.worldMatrix4,$TJ=$Tet.worldMatrix,$TZ=$Tet.worldFilters,$TA=$Tet.worldShaderDefines;if($Tet.worldMatrix=$TV.EMPTY,$Tet.restoreTempArray(),$Tet.worldMatrix4=$Tet.TEMPMAT4_ARRAY,$Tet.worldAlpha=1,$Tet.worldFilters=null,$Tet.worldShaderDefines=null,$Tut.activeShader=null,$TM.start(),$TT.showCanvasMark?$TM.clear(0,1,0,.3):$TM.clear(0,0,0,0),$Tt.flush(),$TM.end(),$Tut.activeShader=null,$Tet.worldAlpha=$TD,$Tet.worldMatrix4=$To,$Tet.worldMatrix=$TJ,$Tet.worldFilters=$TZ,$Tet.worldShaderDefines=$TA,$Tet.worldScissorTest=$Tf){var $TL=$Tet.height-$Tc.y-$Tc.height;$TXt.mainContext.scissor($Tc.x,$TL,$Tc.width,$Tc.height),$TXt.mainContext.enable(3089)}$Tet.worldClipRect=$Tc}},$TM.flush=function($Tt){this.repaint&&(this._flushToTarget($Tt,this.target),this.repaint=!1)},$TM.drawTo=function($Tt,$TM,$Tf,$Tc,$TD){$Tt.drawTexture(this.target.getTexture(),$TM,$Tf,$Tc,$TD,0,0)},$TM.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$Tt}(),$Tw=function(){function $Tt(){this.ALPHA=1,this.shaderType=0,this.defines=new $TCt}return $Tb($Tt,"laya.webgl.shader.d2.Shader2D"),$Tt.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$Tt.__init__=function(){var $Tt,$TM;$Tmt.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$Tmt.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$Tmt.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$Tmt.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$Tmt.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$Tmt.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$Tmt.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$Tmt.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$Tt="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$TM='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$Tmt.preCompile2D(0,1,$Tt,$TM,null),$Tt="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$TM='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$Tmt.preCompile2D(0,2,$Tt,$TM,null),$Tt="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$TM="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$Tmt.preCompile2D(0,4,$Tt,$TM,null),$Tt="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$TM='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$Tmt.preCompile2D(0,256,$Tt,$TM,null),$Tt="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$TM="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$Tmt.preCompile2D(0,512,$Tt,$TM,null)},$Tt}(),$TW=function(){function $TM($Tt,$TM,$Tf){this._value=0,this._name2int=$Tt,this._int2name=$TM,this._int2nameMap=$Tf}$Tb($TM,"laya.webgl.shader.ShaderDefines");var $Tt=$TM.prototype;return $Tt.add=function($Tt){return"string"==typeof $Tt&&($Tt=this._name2int[$Tt]),this._value|=$Tt,this._value},$Tt.addInt=function($Tt){return this._value|=$Tt,this._value},$Tt.remove=function($Tt){return"string"==typeof $Tt&&($Tt=this._name2int[$Tt]),this._value&=~$Tt,this._value},$Tt.isDefine=function($Tt){return(this._value&$Tt)===$Tt},$Tt.getValue=function(){return this._value},$Tt.setValue=function($Tt){this._value=$Tt},$Tt.toNameDic=function(){var $Tt=this._int2nameMap[this._value];return $Tt||$TM._toText(this._value,this._int2name,this._int2nameMap)},$TM._reg=function($Tt,$TM,$Tf,$Tc){$Tc[$Tf[$Tt]=$TM]=$Tt},$TM._toText=function($Tt,$TM,$Tf){var $Tc=$Tf[$Tt];if($Tc)return $Tc;for(var $TD={},$To=1,$TJ=0;$TJ<32&&!($Tt<($To=1<<$TJ));$TJ++)if($Tt&$To){var $TZ=$TM[$To];$TZ&&($TD[$TZ]="")}return $Tf[$Tt]=$TD},$TM._toInt=function($Tt,$TM){for(var $Tf=$Tt.split("."),$Tc=0,$TD=0,$To=$Tf.length;$TD<$To;$TD++){var $TJ=$TM[$Tf[$TD]];if(!$TJ)throw new Error("Defines to int err:"+$Tt+"/"+$Tf[$TD]);$Tc|=$TJ}return $Tc},$TM}(),$Ttt=function(){function $TJ(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $TV}$Tb($TJ,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $Tt=$TJ.prototype;return $Tt.init=function($Tt,$TM,$Tf){if($TM)this._vs=$TM;else{this._vs=[];var $Tc=$Tt.width,$TD=$Tt.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($Tc,0,1,0,1,1,1,1),this._vs.push($Tc,$TD,1,1,1,1,1,1),this._vs.push(0,$TD,0,1,1,1,1,1)}$Tf?this._ps=$Tf:($TJ._defaultPS||($TJ._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$TJ._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$Tt},$Tt.init2=function($Tt,$TM,$Tf,$Tc,$TD){this.transform&&(this.transform=null),$Tf?this._ps=$Tf:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$Tc,this._uvs=$TD,this.mEleNum=this._ps.length,this.mTexture=$Tt,($TE.isConchNode||$TE.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$Tt._initMyData=function(){var $Tt=0,$TM=0,$Tf=4*this._verticles.length;this._vs=$TJ._tempVS;var $Tc=!1;if($TE.isConchNode||$TE.isConchApp?(this._vs.length=$Tf,$Tc=!0):this._vs.length<$Tf&&(this._vs.length=$Tf,$Tc=!0),$TJ._tVSLen=$Tf,$Tc)for(;$Tt<$Tf;)this._vs[$Tt]=this._verticles[$TM],this._vs[$Tt+1]=this._verticles[$TM+1],this._vs[$Tt+2]=this._uvs[$TM],this._vs[$Tt+3]=this._uvs[$TM+1],this._vs[$Tt+4]=1,this._vs[$Tt+5]=1,this._vs[$Tt+6]=1,this._vs[$Tt+7]=1,$Tt+=8,$TM+=2;else for(;$Tt<$Tf;)this._vs[$Tt]=this._verticles[$TM],this._vs[$Tt+1]=this._verticles[$TM+1],this._vs[$Tt+2]=this._uvs[$TM],this._vs[$Tt+3]=this._uvs[$TM+1],$Tt+=8,$TM+=2},$Tt.getData2=function($Tt,$TM,$Tf){var $Tc;this.mVBBuffer=$Tt,this.mIBBuffer=$TM,this._initMyData(),$Tt.appendEx2(this._vs,Float32Array,$TJ._tVSLen,4),this._indexStart=$TM._byteLength,($Tc=$TJ._tempIB).length<this._ps.length&&($Tc.length=this._ps.length);for(var $TD=0,$To=this._ps.length;$TD<$To;$TD++)$Tc[$TD]=this._ps[$TD]+$Tf;$TM.appendEx2($Tc,Uint16Array,this._ps.length,2)},$Tt.getData=function($Tt,$TM,$Tf){if(this.mVBBuffer=$Tt,this.mIBBuffer=$TM,$Tt.append(this.mVBData),this._indexStart=$TM._byteLength,this.mIBData.start!=$Tf){for(var $Tc=0,$TD=this._ps.length;$Tc<$TD;$Tc++)this.mIBData[$Tc]=this._ps[$Tc]+$Tf;this.mIBData.start=$Tf}$TM.append(this.mIBData)},$Tt.render=function($Tt,$TM,$Tf){if($TE.isWebGL&&this.mTexture){$Tt._renderKey=0,$Tt._shader2D.glTexture=null,$TMt.getInstance().addSkinMesh(this);var $Tc=$Tot.createShape($Tt,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$Tit.create(512,0));this.transform||(this.transform=$TV.EMPTY),this.transform.translate($TM,$Tf),$TV.mul(this.transform,$Tt._curMat,this._tempMatrix),this.transform.translate(-$TM,-$Tf);var $TD=$Tc.shaderValue,$To=$TD.u_mmat2||$Tet.getMatrArray();$Tet.mat2MatArray(this._tempMatrix,$To),$TD.textureHost=this.mTexture,$TD.offsetX=0,$TD.offsetY=0,$TD.u_mmat2=$To,$TD.ALPHA=$Tt._shader2D.ALPHA,$Tt._submits[$Tt._submits._length++]=$Tc}else $TE.isConchApp&&this.mTexture&&(this.transform||(this.transform=$TV.EMPTY),$Tt.setSkinMesh&&$Tt.setSkinMesh($TM,$Tf,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$TJ._tempVS=[],$TJ._tempIB=[],$TJ._defaultPS=null,$TJ._tVSLen=0,$TJ}(),$TMt=function(){function $Tt(){this.ib=null,this.vb=null;$TXt.mainContext;this.ib=$Twt.create(35048),this.vb=$TWt.create(8)}$Tb($Tt,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $TM=$Tt.prototype;return $TM.addSkinMesh=function($Tt){$Tt.getData2(this.vb,this.ib,this.vb._byteLength/32)},$TM.reset=function(){this.vb.clear(),this.ib.clear()},$Tt.getInstance=function(){return $Tt.instance=$Tt.instance||new $Tt},$Tt.instance=null,$Tt}(),$Tft=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$TA&&($TA=0),this.x=$Tt,this.y=$TM,this.width=$Tf,this.height=$Tc,this.edges=$TD,this.color=$To,this.borderWidth=$TJ,this.borderColor=$TZ}$Tb($Tt,"laya.webgl.shapes.BasePoly");var $TM=$Tt.prototype;return $Th.imps($TM,{"laya.webgl.shapes.IShape":!0}),$TM.getData=function($Tt,$TM,$Tf){},$TM.rebuild=function($Tt){},$TM.setMatrix=function($Tt){},$TM.needUpdate=function($Tt){return!0},$TM.sector=function($Tt,$TM,$Tf){var $Tc=this.x,$TD=this.y,$To=this.edges,$TJ=(this.r1-this.r0)/$To,$TZ=this.width,$TA=this.height,$TL=this.color,$Tp=($TL>>16&255)/255,$TB=($TL>>8&255)/255,$Tb=(255&$TL)/255;$Tt.push($Tc,$TD,$Tp,$TB,$Tb);for(var $TI=0;$TI<$To+1;$TI++)$Tt.push($Tc+Math.sin($TJ*$TI+this.r0)*$TZ,$TD+Math.cos($TJ*$TI+this.r0)*$TA),$Tt.push($Tp,$TB,$Tb);for($TI=0;$TI<$To;$TI++)$TM.push($Tf,$Tf+$TI+1,$Tf+$TI+2)},$TM.createLine2=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb,$TI,$Tq,$Tl,$T_,$TE,$Te,$TN,$TX,$Ty,$Th,$TT,$Ti,$TV,$Tx=$Tt.concat(),$TO=$TD,$TC=this.borderColor,$TU=($TC>>16&255)/255,$TF=($TC>>8&255)/255,$TS=(255&$TC)/255,$TH=$Tx.length/2,$Ts=$Tc,$Tr=$Tf/2;$TA=$Tx[0],$TL=$Tx[1],$Tl=$TA-($Tp=$Tx[2]),$Tq=($Tq=-($TL-($TB=$Tx[3])))/($TV=Math.sqrt($Tq*$Tq+$Tl*$Tl))*$Tr,$Tl=$Tl/$TV*$Tr,$TO.push($TA-$Tq+this.x,$TL-$Tl+this.y,$TU,$TF,$TS,$TA+$Tq+this.x,$TL+$Tl+this.y,$TU,$TF,$TS);for(var $Tu=1;$Tu<$TH-1;$Tu++)$TA=$Tx[2*($Tu-1)],$TL=$Tx[2*($Tu-1)+1],$Tp=$Tx[2*$Tu],$TB=$Tx[2*$Tu+1],$Tb=$Tx[2*($Tu+1)],$TI=$Tx[2*($Tu+1)+1],$Tl=$TA-$Tp,$TE=$Tp-$Tb,$TX=(-($Tq=($Tq=-($TL-$TB))/($TV=Math.sqrt($Tq*$Tq+$Tl*$Tl))*$Tr)+$TA)*(-($Tl=$Tl/$TV*$Tr)+$TB)-(-$Tq+$Tp)*(-$Tl+$TL),$TT=(-($T_=($T_=-($TB-$TI))/($TV=Math.sqrt($T_*$T_+$TE*$TE))*$Tr)+$Tb)*(-($TE=$TE/$TV*$Tr)+$TB)-(-$T_+$Tp)*(-$TE+$TI),$Ti=($Te=-$Tl+$TL-(-$Tl+$TB))*($Th=-$T_+$Tp-(-$T_+$Tb))-($Ty=-$TE+$TI-(-$TE+$TB))*($TN=-$Tq+$Tp-(-$Tq+$TA)),Math.abs($Ti)<.1?($Ti+=10.1,$TO.push($Tp-$Tq+this.x,$TB-$Tl+this.y,$TU,$TF,$TS,$Tp+$Tq+this.x,$TB+$Tl+this.y,$TU,$TF,$TS)):((($TJ=($TN*$TT-$Th*$TX)/$Ti)-$Tp)*($TJ-$Tp)+(($TZ=($Ty*$TX-$Te*$TT)/$Ti)-$TB)+($TZ-$TB),$TO.push($TJ+this.x,$TZ+this.y,$TU,$TF,$TS,$Tp-($TJ-$Tp)+this.x,$TB-($TZ-$TB)+this.y,$TU,$TF,$TS));$TA=$Tx[$Tx.length-4],$TL=$Tx[$Tx.length-3],$Tl=$TA-($Tp=$Tx[$Tx.length-2]),$Tq=($Tq=-($TL-($TB=$Tx[$Tx.length-1])))/($TV=Math.sqrt($Tq*$Tq+$Tl*$Tl))*$Tr,$Tl=$Tl/$TV*$Tr,$TO.push($Tp-$Tq+this.x,$TB-$Tl+this.y,$TU,$TF,$TS,$Tp+$Tq+this.x,$TB+$Tl+this.y,$TU,$TF,$TS);var $Tv=$To;for($Tu=1;$Tu<$Tv;$Tu++)$TM.push($Ts+2*($Tu-1),$Ts+2*($Tu-1)+1,$Ts+2*$Tu+1,$Ts+2*$Tu+1,$Ts+2*$Tu,$Ts+2*($Tu-1));return $TO},$TM.createLine=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.concat(),$To=$Tt,$TJ=this.borderColor,$TZ=($TJ>>16&255)/255,$TA=($TJ>>8&255)/255,$TL=(255&$TJ)/255;$TD.splice(0,5);var $Tp,$TB,$Tb,$TI,$Tq,$Tl,$T_,$TE,$Te,$TN,$TX,$Ty,$Th,$TT,$Ti,$TV,$Tx,$TO,$TC,$TU,$TF=$TD.length/5,$TS=$Tc,$TH=$Tf/2;$Tb=$TD[0],$TI=$TD[1],$TN=$Tb-($Tq=$TD[5]),$Te=($Te=-($TI-($Tl=$TD[6])))/($TU=Math.sqrt($Te*$Te+$TN*$TN))*$TH,$TN=$TN/$TU*$TH,$To.push($Tb-$Te,$TI-$TN,$TZ,$TA,$TL,$Tb+$Te,$TI+$TN,$TZ,$TA,$TL);for(var $Ts=1;$Ts<$TF-1;$Ts++)$Tb=$TD[5*($Ts-1)],$TI=$TD[5*($Ts-1)+1],$Tq=$TD[5*$Ts],$Tl=$TD[5*$Ts+1],$T_=$TD[5*($Ts+1)],$TE=$TD[5*($Ts+1)+1],$TN=$Tb-$Tq,$Ty=$Tq-$T_,$Ti=(-($Te=($Te=-($TI-$Tl))/($TU=Math.sqrt($Te*$Te+$TN*$TN))*$TH)+$Tb)*(-($TN=$TN/$TU*$TH)+$Tl)-(-$Te+$Tq)*(-$TN+$TI),$TO=(-($TX=($TX=-($Tl-$TE))/($TU=Math.sqrt($TX*$TX+$Ty*$Ty))*$TH)+$T_)*(-($Ty=$Ty/$TU*$TH)+$Tl)-(-$TX+$Tq)*(-$Ty+$TE),$TC=($Th=-$TN+$TI-(-$TN+$Tl))*($Tx=-$TX+$Tq-(-$TX+$T_))-($TV=-$Ty+$TE-(-$Ty+$Tl))*($TT=-$Te+$Tq-(-$Te+$Tb)),Math.abs($TC)<.1?($TC+=10.1,$To.push($Tq-$Te,$Tl-$TN,$TZ,$TA,$TL,$Tq+$Te,$Tl+$TN,$TZ,$TA,$TL)):((($Tp=($TT*$TO-$Tx*$Ti)/$TC)-$Tq)*($Tp-$Tq)+(($TB=($TV*$Ti-$Th*$TO)/$TC)-$Tl)+($TB-$Tl),$To.push($Tp,$TB,$TZ,$TA,$TL,$Tq-($Tp-$Tq),$Tl-($TB-$Tl),$TZ,$TA,$TL));$Tb=$TD[$TD.length-10],$TI=$TD[$TD.length-9],$TN=$Tb-($Tq=$TD[$TD.length-5]),$Te=($Te=-($TI-($Tl=$TD[$TD.length-4])))/($TU=Math.sqrt($Te*$Te+$TN*$TN))*$TH,$TN=$TN/$TU*$TH,$To.push($Tq-$Te,$Tl-$TN,$TZ,$TA,$TL,$Tq+$Te,$Tl+$TN,$TZ,$TA,$TL);var $Tr=this.edges+1;for($Ts=1;$Ts<$Tr;$Ts++)$TM.push($TS+2*($Ts-1),$TS+2*($Ts-1)+1,$TS+2*$Ts+1,$TS+2*$Ts+1,$TS+2*$Ts,$TS+2*($Ts-1));return $To},$TM.createLoopLine=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$Tt.concat(),$TZ=$TD||$Tt,$TA=this.borderColor,$TL=($TA>>16&255)/255,$Tp=($TA>>8&255)/255,$TB=(255&$TA)/255;$TJ.splice(0,5);var $Tb=[$TJ[0],$TJ[1]],$TI=[$TJ[$TJ.length-5],$TJ[$TJ.length-4]],$Tq=$TI[0]+.5*($Tb[0]-$TI[0]),$Tl=$TI[1]+.5*($Tb[1]-$TI[1]);$TJ.unshift($Tq,$Tl,0,0,0),$TJ.push($Tq,$Tl,0,0,0);var $T_,$TE,$Te,$TN,$TX,$Ty,$Th,$TT,$Ti,$TV,$Tx,$TO,$TC,$TU,$TF,$TS,$TH,$Ts,$Tr,$Tu,$Tv=$TJ.length/5,$Tk=$Tc,$TK=$Tf/2;$Te=$TJ[0],$TN=$TJ[1],$TV=$Te-($TX=$TJ[5]),$Ti=($Ti=-($TN-($Ty=$TJ[6])))/($Tu=Math.sqrt($Ti*$Ti+$TV*$TV))*$TK,$TV=$TV/$Tu*$TK,$TZ.push($Te-$Ti,$TN-$TV,$TL,$Tp,$TB,$Te+$Ti,$TN+$TV,$TL,$Tp,$TB);for(var $Tj=1;$Tj<$Tv-1;$Tj++)$Te=$TJ[5*($Tj-1)],$TN=$TJ[5*($Tj-1)+1],$TX=$TJ[5*$Tj],$Ty=$TJ[5*$Tj+1],$Th=$TJ[5*($Tj+1)],$TT=$TJ[5*($Tj+1)+1],$TV=$Te-$TX,$TO=$TX-$Th,$TF=(-($Ti=($Ti=-($TN-$Ty))/($Tu=Math.sqrt($Ti*$Ti+$TV*$TV))*$TK)+$Te)*(-($TV=$TV/$Tu*$TK)+$Ty)-(-$Ti+$TX)*(-$TV+$TN),$Ts=(-($Tx=($Tx=-($Ty-$TT))/($Tu=Math.sqrt($Tx*$Tx+$TO*$TO))*$TK)+$Th)*(-($TO=$TO/$Tu*$TK)+$Ty)-(-$Tx+$TX)*(-$TO+$TT),$Tr=($TC=-$TV+$TN-(-$TV+$Ty))*($TH=-$Tx+$TX-(-$Tx+$Th))-($TS=-$TO+$TT-(-$TO+$Ty))*($TU=-$Ti+$TX-(-$Ti+$Te)),Math.abs($Tr)<.1?($Tr+=10.1,$TZ.push($TX-$Ti,$Ty-$TV,$TL,$Tp,$TB,$TX+$Ti,$Ty+$TV,$TL,$Tp,$TB)):((($T_=($TU*$Ts-$TH*$TF)/$Tr)-$TX)*($T_-$TX)+(($TE=($TS*$TF-$TC*$Ts)/$Tr)-$Ty)+($TE-$Ty),$TZ.push($T_,$TE,$TL,$Tp,$TB,$TX-($T_-$TX),$Ty-($TE-$Ty),$TL,$Tp,$TB));$To&&($TM=$To);var $Td=this.edges+1;for($Tj=1;$Tj<$Td;$Tj++)$TM.push($Tk+2*($Tj-1),$Tk+2*($Tj-1)+1,$Tk+2*$Tj+1,$Tk+2*$Tj+1,$Tk+2*$Tj,$Tk+2*($Tj-1));return $TM.push($Tk+2*($Tj-1),$Tk+2*($Tj-1)+1,$Tk+1,$Tk+1,$Tk,$Tk+2*($Tj-1)),$TZ},$Tt}(),$Tct=function(){function $Tl(){}return $Tb($Tl,"laya.webgl.shapes.Earcut"),$Tl.earcut=function($Tt,$TM,$Tf){$Tf=$Tf||2;var $Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp=$TM&&$TM.length,$TB=$Tp?$TM[0]*$Tf:$Tt.length,$Tb=$Tl.linkedList($Tt,0,$TB,$Tf,!0),$TI=[];if(!$Tb)return $TI;if($Tp&&($Tb=$Tl.eliminateHoles($Tt,$TM,$Tb,$Tf)),$Tt.length>80*$Tf){$Tc=$To=$Tt[0],$TD=$TJ=$Tt[1];for(var $Tq=$Tf;$Tq<$TB;$Tq+=$Tf)($TZ=$Tt[$Tq])<$Tc&&($Tc=$TZ),($TA=$Tt[$Tq+1])<$TD&&($TD=$TA),$To<$TZ&&($To=$TZ),$TJ<$TA&&($TJ=$TA);$TL=0!==($TL=Math.max($To-$Tc,$TJ-$TD))?1/$TL:0}return $Tl.earcutLinked($Tb,$TI,$Tf,$Tc,$TD,$TL),$TI},$Tl.linkedList=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ;if($TD===0<$Tl.signedArea($Tt,$TM,$Tf,$Tc))for($To=$TM;$To<$Tf;$To+=$Tc)$TJ=$Tl.insertNode($To,$Tt[$To],$Tt[$To+1],$TJ);else for($To=$Tf-$Tc;$TM<=$To;$To-=$Tc)$TJ=$Tl.insertNode($To,$Tt[$To],$Tt[$To+1],$TJ);return $TJ&&$Tl.equals($TJ,$TJ.next)&&($Tl.removeNode($TJ),$TJ=$TJ.next),$TJ},$Tl.filterPoints=function($Tt,$TM){if(!$Tt)return $Tt;$TM||($TM=$Tt);var $Tf,$Tc=$Tt;do{if($Tf=!1,$Tc.steiner||!$Tl.equals($Tc,$Tc.next)&&0!==$Tl.area($Tc.prev,$Tc,$Tc.next))$Tc=$Tc.next;else{if($Tl.removeNode($Tc),($Tc=$TM=$Tc.prev)===$Tc.next)break;$Tf=!0}}while($Tf||$Tc!==$TM);return $TM},$Tl.earcutLinked=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if($Tt){!$TJ&&$To&&$Tl.indexCurve($Tt,$Tc,$TD,$To);for(var $TZ,$TA,$TL=$Tt;$Tt.prev!==$Tt.next;)if($TZ=$Tt.prev,$TA=$Tt.next,$To?$Tl.isEarHashed($Tt,$Tc,$TD,$To):$Tl.isEar($Tt))$TM.push($TZ.i/$Tf),$TM.push($Tt.i/$Tf),$TM.push($TA.i/$Tf),$Tl.removeNode($Tt),$Tt=$TA.next,$TL=$TA.next;else if(($Tt=$TA)===$TL){$TJ?1===$TJ?($Tt=$Tl.cureLocalIntersections($Tt,$TM,$Tf),$Tl.earcutLinked($Tt,$TM,$Tf,$Tc,$TD,$To,2)):2===$TJ&&$Tl.splitEarcut($Tt,$TM,$Tf,$Tc,$TD,$To):$Tl.earcutLinked($Tl.filterPoints($Tt,null),$TM,$Tf,$Tc,$TD,$To,1);break}}},$Tl.isEar=function($Tt){var $TM=$Tt.prev,$Tf=$Tt,$Tc=$Tt.next;if(0<=$Tl.area($TM,$Tf,$Tc))return!1;for(var $TD=$Tt.next.next;$TD!==$Tt.prev;){if($Tl.pointInTriangle($TM.x,$TM.y,$Tf.x,$Tf.y,$Tc.x,$Tc.y,$TD.x,$TD.y)&&0<=$Tl.area($TD.prev,$TD,$TD.next))return!1;$TD=$TD.next}return!0},$Tl.isEarHashed=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.prev,$To=$Tt,$TJ=$Tt.next;if(0<=$Tl.area($TD,$To,$TJ))return!1;for(var $TZ=$TD.x<$To.x?$TD.x<$TJ.x?$TD.x:$TJ.x:$To.x<$TJ.x?$To.x:$TJ.x,$TA=$TD.y<$To.y?$TD.y<$TJ.y?$TD.y:$TJ.y:$To.y<$TJ.y?$To.y:$TJ.y,$TL=$TD.x>$To.x?$TD.x>$TJ.x?$TD.x:$TJ.x:$To.x>$TJ.x?$To.x:$TJ.x,$Tp=$TD.y>$To.y?$TD.y>$TJ.y?$TD.y:$TJ.y:$To.y>$TJ.y?$To.y:$TJ.y,$TB=$Tl.zOrder($TZ,$TA,$TM,$Tf,$Tc),$Tb=$Tl.zOrder($TL,$Tp,$TM,$Tf,$Tc),$TI=$Tt.nextZ;$TI&&$TI.z<=$Tb;){if($TI!==$Tt.prev&&$TI!==$Tt.next&&$Tl.pointInTriangle($TD.x,$TD.y,$To.x,$To.y,$TJ.x,$TJ.y,$TI.x,$TI.y)&&0<=$Tl.area($TI.prev,$TI,$TI.next))return!1;$TI=$TI.nextZ}for($TI=$Tt.prevZ;$TI&&$TI.z>=$TB;){if($TI!==$Tt.prev&&$TI!==$Tt.next&&$Tl.pointInTriangle($TD.x,$TD.y,$To.x,$To.y,$TJ.x,$TJ.y,$TI.x,$TI.y)&&0<=$Tl.area($TI.prev,$TI,$TI.next))return!1;$TI=$TI.prevZ}return!0},$Tl.cureLocalIntersections=function($Tt,$TM,$Tf){var $Tc=$Tt;do{var $TD=$Tc.prev,$To=$Tc.next.next;!$Tl.equals($TD,$To)&&$Tl.intersects($TD,$Tc,$Tc.next,$To)&&$Tl.locallyInside($TD,$To)&&$Tl.locallyInside($To,$TD)&&($TM.push($TD.i/$Tf),$TM.push($Tc.i/$Tf),$TM.push($To.i/$Tf),$Tl.removeNode($Tc),$Tl.removeNode($Tc.next),$Tc=$Tt=$To),$Tc=$Tc.next}while($Tc!==$Tt);return $Tc},$Tl.splitEarcut=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$Tt;do{for(var $TZ=$TJ.next.next;$TZ!==$TJ.prev;){if($TJ.i!==$TZ.i&&$Tl.isValidDiagonal($TJ,$TZ)){var $TA=$Tl.splitPolygon($TJ,$TZ);return $TJ=$Tl.filterPoints($TJ,$TJ.next),$TA=$Tl.filterPoints($TA,$TA.next),$Tl.earcutLinked($TJ,$TM,$Tf,$Tc,$TD,$To),void $Tl.earcutLinked($TA,$TM,$Tf,$Tc,$TD,$To)}$TZ=$TZ.next}$TJ=$TJ.next}while($TJ!==$Tt)},$Tl.eliminateHoles=function($Tt,$TM,$Tf,$Tc){var $TD,$To,$TJ,$TZ,$TA,$TL=[];for($TD=0,$To=$TM.length;$TD<$To;$TD++)$TJ=$TM[$TD]*$Tc,$TZ=$TD<$To-1?$TM[$TD+1]*$Tc:$Tt.length,($TA=$Tl.linkedList($Tt,$TJ,$TZ,$Tc,!1))===$TA.next&&($TA.steiner=!0),$TL.push($Tl.getLeftmost($TA));for($TL.sort($Tl.compareX),$TD=0;$TD<$TL.length;$TD++)$Tl.eliminateHole($TL[$TD],$Tf),$Tf=$Tl.filterPoints($Tf,$Tf.next);return $Tf},$Tl.compareX=function($Tt,$TM){return $Tt.x-$TM.x},$Tl.eliminateHole=function($Tt,$TM){if($TM=$Tl.findHoleBridge($Tt,$TM)){var $Tf=$Tl.splitPolygon($TM,$Tt);$Tl.filterPoints($Tf,$Tf.next)}},$Tl.findHoleBridge=function($Tt,$TM){var $Tf,$Tc=$TM,$TD=$Tt.x,$To=$Tt.y,$TJ=-1/0;do{if($To<=$Tc.y&&$To>=$Tc.next.y&&$Tc.next.y!==$Tc.y){var $TZ=$Tc.x+($To-$Tc.y)*($Tc.next.x-$Tc.x)/($Tc.next.y-$Tc.y);if($TZ<=$TD&&$TJ<$TZ){if(($TJ=$TZ)===$TD){if($To===$Tc.y)return $Tc;if($To===$Tc.next.y)return $Tc.next}$Tf=$Tc.x<$Tc.next.x?$Tc:$Tc.next}}$Tc=$Tc.next}while($Tc!==$TM);if(!$Tf)return null;if($TD===$TJ)return $Tf.prev;var $TA,$TL=$Tf,$Tp=$Tf.x,$TB=$Tf.y,$Tb=1/0;for($Tc=$Tf.next;$Tc!==$TL;)$TD>=$Tc.x&&$Tc.x>=$Tp&&$TD!==$Tc.x&&$Tl.pointInTriangle($To<$TB?$TD:$TJ,$To,$Tp,$TB,$To<$TB?$TJ:$TD,$To,$Tc.x,$Tc.y)&&(($TA=Math.abs($To-$Tc.y)/($TD-$Tc.x))<$Tb||$TA===$Tb&&$Tc.x>$Tf.x)&&$Tl.locallyInside($Tc,$Tt)&&($Tf=$Tc,$Tb=$TA),$Tc=$Tc.next;return $Tf},$Tl.indexCurve=function($Tt,$TM,$Tf,$Tc){for(var $TD=$Tt;null===$TD.z&&($TD.z=$Tl.zOrder($TD.x,$TD.y,$TM,$Tf,$Tc)),$TD.prevZ=$TD.prev,$TD.nextZ=$TD.next,($TD=$TD.next)!==$Tt;);$TD.prevZ.nextZ=null,$TD.prevZ=null,$Tl.sortLinked($TD)},$Tl.sortLinked=function($Tt){var $TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL=1;do{for($Tf=$Tt,$To=$Tt=null,$TJ=0;$Tf;){for($TJ++,$Tc=$Tf,$TM=$TZ=0;$TM<$TL&&($TZ++,$Tc=$Tc.nextZ);$TM++);for($TA=$TL;0<$TZ||0<$TA&&$Tc;)0!==$TZ&&(0===$TA||!$Tc||$Tf.z<=$Tc.z)?($Tf=($TD=$Tf).nextZ,$TZ--):($Tc=($TD=$Tc).nextZ,$TA--),$To?$To.nextZ=$TD:$Tt=$TD,$TD.prevZ=$To,$To=$TD;$Tf=$Tc}$To.nextZ=null,$TL*=2}while(1<$TJ);return $Tt},$Tl.zOrder=function($Tt,$TM,$Tf,$Tc,$TD){return($Tt=1431655765&(($Tt=858993459&(($Tt=252645135&(($Tt=16711935&(($Tt=32767*($Tt-$Tf)*$TD)|$Tt<<8))|$Tt<<4))|$Tt<<2))|$Tt<<1))|($TM=1431655765&(($TM=858993459&(($TM=252645135&(($TM=16711935&(($TM=32767*($TM-$Tc)*$TD)|$TM<<8))|$TM<<4))|$TM<<2))|$TM<<1))<<1},$Tl.getLeftmost=function($Tt){for(var $TM=$Tt,$Tf=$Tt;$TM.x<$Tf.x&&($Tf=$TM),($TM=$TM.next)!==$Tt;);return $Tf},$Tl.pointInTriangle=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){return 0<=($TD-$TJ)*($TM-$TZ)-($Tt-$TJ)*($To-$TZ)&&0<=($Tt-$TJ)*($Tc-$TZ)-($Tf-$TJ)*($TM-$TZ)&&0<=($Tf-$TJ)*($To-$TZ)-($TD-$TJ)*($Tc-$TZ)},$Tl.isValidDiagonal=function($Tt,$TM){return $Tt.next.i!==$TM.i&&$Tt.prev.i!==$TM.i&&!$Tl.intersectsPolygon($Tt,$TM)&&$Tl.locallyInside($Tt,$TM)&&$Tl.locallyInside($TM,$Tt)&&$Tl.middleInside($Tt,$TM)},$Tl.area=function($Tt,$TM,$Tf){return($TM.y-$Tt.y)*($Tf.x-$TM.x)-($TM.x-$Tt.x)*($Tf.y-$TM.y)},$Tl.equals=function($Tt,$TM){return $Tt.x===$TM.x&&$Tt.y===$TM.y},$Tl.intersects=function($Tt,$TM,$Tf,$Tc){return!!($Tl.equals($Tt,$TM)&&$Tl.equals($Tf,$Tc)||$Tl.equals($Tt,$Tc)&&$Tl.equals($Tf,$TM))||0<$Tl.area($Tt,$TM,$Tf)!=0<$Tl.area($Tt,$TM,$Tc)&&0<$Tl.area($Tf,$Tc,$Tt)!=0<$Tl.area($Tf,$Tc,$TM)},$Tl.intersectsPolygon=function($Tt,$TM){var $Tf=$Tt;do{if($Tf.i!==$Tt.i&&$Tf.next.i!==$Tt.i&&$Tf.i!==$TM.i&&$Tf.next.i!==$TM.i&&$Tl.intersects($Tf,$Tf.next,$Tt,$TM))return!0;$Tf=$Tf.next}while($Tf!==$Tt);return!1},$Tl.locallyInside=function($Tt,$TM){return $Tl.area($Tt.prev,$Tt,$Tt.next)<0?0<=$Tl.area($Tt,$TM,$Tt.next)&&0<=$Tl.area($Tt,$Tt.prev,$TM):$Tl.area($Tt,$TM,$Tt.prev)<0||$Tl.area($Tt,$Tt.next,$TM)<0},$Tl.middleInside=function($Tt,$TM){for(var $Tf=$Tt,$Tc=!1,$TD=($Tt.x+$TM.x)/2,$To=($Tt.y+$TM.y)/2;$Tf.y>$To!=$Tf.next.y>$To&&$Tf.next.y!==$Tf.y&&$TD<($Tf.next.x-$Tf.x)*($To-$Tf.y)/($Tf.next.y-$Tf.y)+$Tf.x&&($Tc=!$Tc),($Tf=$Tf.next)!==$Tt;);return $Tc},$Tl.splitPolygon=function($Tt,$TM){var $Tf=new $TDt($Tt.i,$Tt.x,$Tt.y),$Tc=new $TDt($TM.i,$TM.x,$TM.y),$TD=$Tt.next,$To=$TM.prev;return($Tt.next=$TM).prev=$Tt,($Tf.next=$TD).prev=$Tf,($Tc.next=$Tf).prev=$Tc,($To.next=$Tc).prev=$To,$Tc},$Tl.insertNode=function($Tt,$TM,$Tf,$Tc){var $TD=new $TDt($Tt,$TM,$Tf);return $Tc?($TD.next=$Tc.next,($TD.prev=$Tc).next.prev=$TD,$Tc.next=$TD):($TD.prev=$TD).next=$TD,$TD},$Tl.removeNode=function($Tt){$Tt.next.prev=$Tt.prev,$Tt.prev.next=$Tt.next,$Tt.prevZ&&($Tt.prevZ.nextZ=$Tt.nextZ),$Tt.nextZ&&($Tt.nextZ.prevZ=$Tt.prevZ)},$Tl.signedArea=function($Tt,$TM,$Tf,$Tc){for(var $TD=0,$To=$TM,$TJ=$Tf-$Tc;$To<$Tf;$To+=$Tc)$TD+=($Tt[$TJ]-$Tt[$To])*($Tt[$To+1]+$Tt[$TJ+1]),$TJ=$To;return $TD},$Tl}(),$TDt=function(){function $Tt($Tt,$TM,$Tf){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$Tt,this.x=$TM,this.y=$Tf,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $Tb($Tt,"laya.webgl.shapes.EarcutNode"),$Tt}(),$Tot=(function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this.lineWidth=$Tt,this.lineColor=$TM,this.lineAlpha=$Tf,this.fillColor=$Tc,this.fillAlpha=$TD,this.shape=$TJ,this.fill=$To}$Tb($Tt,"laya.webgl.shapes.GeometryData");var $TM=$Tt.prototype;$TM.clone=function(){return new $Tt(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$TM.getIndexData=function(){return null},$TM.getVertexData=function(){return null},$TM.destroy=function(){this.shape=null}}(),function(){function $Tt($Tt){if($Tt instanceof Float32Array)this.points=$Tt;else if($Tt instanceof Array){$Tt.length;this.points=new Float32Array($Tt)}}$Tb($Tt,"laya.webgl.shapes.Vertex");var $TM=$Tt.prototype;$Th.imps($TM,{"laya.webgl.shapes.IShape":!0}),$TM.getData=function($Tt,$TM,$Tf){},$TM.needUpdate=function($Tt){return!1},$TM.rebuild=function($Tt){},$TM.setMatrix=function($Tt){}}(),function(){function $TA($Tt){void 0===$Tt&&($Tt=1e4),this._renderType=$Tt}$Tb($TA,"laya.webgl.submit.Submit");var $Tt=$TA.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt.releaseRender=function(){var $Tt=$TA._cache;($Tt[$Tt._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$Tt.getRenderType=function(){return this._renderType},$Tt.renderSubmit=function(){if(0===this._numEle)return 1;var $Tt=this.shaderValue.textureHost;if($Tt){var $TM=$Tt.source;if(!$Tt.bitmap||!$TM)return 1;this.shaderValue.texture=$TM,$Tt.alphaTexture&&$Tt.alphaTexture.source&&(this.shaderValue.texture1=$Tt.alphaTexture.source)}this._vb.bind_upload(this._ib);var $Tf=$TXt.mainContext;return this.shaderValue.upload(),$TP.activeBlendFunction!==this._blendFn&&($Tf.enable(3042),this._blendFn($Tf),$TP.activeBlendFunction=this._blendFn),$TF.drawCall++,$TF.trianglesFaces+=this._numEle/3,$Tf.drawElements(4,this._numEle,5123,this._startIdx),1},$TA.__init__=function(){var $Tt=$TA.RENDERBASE=new $TA(-1);$Tt.shaderValue=new $Tit(0,0),$Tt.shaderValue.ALPHA=-1234},$TA.createSubmit=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TA._cache._length?$TA._cache[--$TA._cache._length]:new $TA;null==$Tf&&(($Tf=$To._selfVb||($To._selfVb=$TWt.create(-1))).clear(),$Tc=0),$To._ib=$TM,$To._vb=$Tf,$To._startIdx=$Tc*$Tlt.BYTES_PIDX,$To._numEle=0;var $TJ=$Tt._nBlendType;$To._blendFn=$Tt._targets?$TP.targetFns[$TJ]:$TP.fns[$TJ],$To.shaderValue=$TD,$To.shaderValue.setValue($Tt._shader2D);var $TZ=$Tt._shader2D.filters;return $TZ&&$To.shaderValue.setFilters($TZ),$To},$TA.createShape=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$TA._cache._length?$TA._cache[--$TA._cache._length]:new $TA;$TJ._ib=$TM,$TJ._vb=$Tf,$TJ._numEle=$Tc,$TJ._startIdx=$TD,$TJ.shaderValue=$To,$TJ.shaderValue.setValue($Tt._shader2D);var $TZ=$Tt._nBlendType;return $TJ._blendFn=$Tt._targets?$TP.targetFns[$TZ]:$TP.fns[$TZ],$TJ},$TA.TYPE_2D=1e4,$TA.TYPE_CANVAS=10003,$TA.TYPE_CMDSETRT=10004,$TA.TYPE_CUSTOM=10005,$TA.TYPE_BLURRT=10006,$TA.TYPE_CMDDESTORYPRERT=10007,$TA.TYPE_DISABLESTENCIL=10008,$TA.TYPE_OTHERIBVB=10009,$TA.TYPE_PRIMITIVE=10010,$TA.TYPE_RT=10011,$TA.TYPE_BLUR_RT=10012,$TA.TYPE_TARGET=10013,$TA.TYPE_CHANGE_VALUE=10014,$TA.TYPE_SHAPE=10015,$TA.TYPE_TEXTURE=10016,$TA.TYPE_FILLTEXTURE=10017,$TA.RENDERBASE=null,$TA._cache=(($TA._cache=[])._length=0,$TA._cache),$TA}()),$TJt=function(){function $Tc(){this.fun=null,this.args=null}$Tb($Tc,"laya.webgl.submit.SubmitCMD");var $Tt=$Tc.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt.renderSubmit=function(){return this.fun.apply(null,this.args),1},$Tt.getRenderType=function(){return 0},$Tt.releaseRender=function(){var $Tt=$Tc._cache;$Tt[$Tt._length++]=this},$Tc.create=function($Tt,$TM){var $Tf=$Tc._cache._length?$Tc._cache[--$Tc._cache._length]:new $Tc;return $Tf.fun=$TM,$Tf.args=$Tt,$Tf},$Tc._cache=(($Tc._cache=[])._length=0,$Tc._cache),$Tc}(),$TZt=function(){function $TM(){this.variables={}}$Tb($TM,"laya.webgl.submit.SubmitCMDScope");var $Tt=$TM.prototype;return $Tt.getValue=function($Tt){return this.variables[$Tt]},$Tt.addValue=function($Tt,$TM){return this.variables[$Tt]=$TM},$Tt.setValue=function($Tt,$TM){return this.variables.hasOwnProperty($Tt)?this.variables[$Tt]=$TM:null},$Tt.clear=function(){for(var $Tt in this.variables)delete this.variables[$Tt]},$Tt.recycle=function(){this.clear(),$TM.POOL.push(this)},$TM.create=function(){var $Tt=$TM.POOL.pop();return $Tt||($Tt=new $TM),$Tt},$TM.POOL=[],$TM}(),$TAt=function(){function $TB(){this.offset=0,this.startIndex=0,this._mat=$TV.create()}$Tb($TB,"laya.webgl.submit.SubmitOtherIBVB");var $Tt=$TB.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt.releaseRender=function(){var $Tt=$TB._cache;($Tt[$Tt._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$Tt.getRenderType=function(){return 10009},$Tt.renderSubmit=function(){var $Tt=this._shaderValue.textureHost;if($Tt){var $TM=$Tt.source;if(!$Tt.bitmap||!$TM)return 1;this._shaderValue.texture=$TM}this._vb.bind_upload(this._ib);var $Tf=$Tet.worldMatrix4,$Tc=$TV.TEMP;$TV.mulPre(this._mat,$Tf[0],$Tf[1],$Tf[4],$Tf[5],$Tf[12],$Tf[13],$Tc);var $TD=$Tet.worldMatrix4=$TB.tempMatrix4;$TD[0]=$Tc.a,$TD[1]=$Tc.b,$TD[4]=$Tc.c,$TD[5]=$Tc.d,$TD[12]=$Tc.tx,$TD[13]=$Tc.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $To=$TXt.mainContext;return $TP.activeBlendFunction!==this._blendFn&&($To.enable(3042),this._blendFn($To),$TP.activeBlendFunction=this._blendFn),$TF.drawCall++,$TF.trianglesFaces+=this._numEle/3,$To.drawElements(4,this._numEle,5123,this.startIndex),$Tet.worldMatrix4=$Tf,$Tut.activeShader=null,1},$TB.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){void 0===$TA&&($TA=0);var $TL=$TB._cache._length?$TB._cache[--$TB._cache._length]:new $TB;$TL._ib=$Tf,$TL._vb=$TM,$TL._numEle=$Tc,$TL._shader=$TD,$TL._shaderValue=$To;var $Tp=$Tt._nBlendType;switch($TL._blendFn=$Tt._targets?$TP.targetFns[$Tp]:$TP.fns[$Tp],$TA){case 0:$TL.offset=0,$TL.startIndex=$TZ/($Tlt.BYTES_PE*$TM.vertexStride)*1.5,$TL.startIndex*=$Tlt.BYTES_PIDX;break;case 1:$TL.startIndex=$TJ,$TL.offset=$TZ}return $TL},$TB._cache=(($TB._cache=[])._length=0,$TB._cache),$TB.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$TB}(),$TLt=function(){function $Tf(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $TO,this.screenRect=new $TO}$Tb($Tf,"laya.webgl.submit.SubmitScissor");var $Tt=$Tf.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt._scissor=function($Tt,$TM,$Tf,$Tc){var $TD=$Tet.worldMatrix4,$To=$TD[0],$TJ=$TD[5],$TZ=$TD[12],$TA=$TD[13];if($Tc*=$TJ,($Tf*=$To)<1||$Tc<1)return!1;var $TL=($Tt=$Tt*$To+$TZ)+$Tf,$Tp=($TM=$TM*$TJ+$TA)+$Tc;$Tt<0&&($Tf=$TL-($Tt=0)),$TM<0&&($Tc=$Tp-($TM=0));var $TB=$Tet.worldClipRect;if($Tt=Math.max($Tt,$TB.x),$TM=Math.max($TM,$TB.y),$Tf=Math.min($TL,$TB.right)-$Tt,$Tc=Math.min($Tp,$TB.bottom)-$TM,$Tf<1||$Tc<1)return!1;var $Tb=$Tet.worldScissorTest;return this.screenRect.copyFrom($TB),$TB.x=$Tt,$TB.y=$TM,$TB.width=$Tf,$TB.height=$Tc,$Tet.worldScissorTest=!0,$TM=$Tet.height-$TM-$Tc,$TXt.mainContext.scissor($Tt,$TM,$Tf,$Tc),$TXt.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$Tb?($TM=$Tet.height-this.screenRect.y-this.screenRect.height,$TXt.mainContext.scissor(this.screenRect.x,$TM,this.screenRect.width,this.screenRect.height),$TXt.mainContext.enable(3089)):($TXt.mainContext.disable(3089),$Tet.worldScissorTest=!1),$TB.copyFrom(this.screenRect),!0},$Tt._scissorWithTagart=function($Tt,$TM,$Tf,$Tc){if($Tf<1||$Tc<1)return!1;var $TD=$Tt+$Tf,$To=$TM+$Tc;$Tt<0&&($Tf=$TD-($Tt=0)),$TM<0&&($Tc=$To-($TM=0));var $TJ=$Tet.worldClipRect;if($Tt=Math.max($Tt,$TJ.x),$TM=Math.max($TM,$TJ.y),$Tf=Math.min($TD,$TJ.right)-$Tt,$Tc=Math.min($To,$TJ.bottom)-$TM,$Tf<1||$Tc<1)return!1;var $TZ=$Tet.worldScissorTest;return this.screenRect.copyFrom($TJ),$Tet.worldScissorTest=!0,$TJ.x=$Tt,$TJ.y=$TM,$TJ.width=$Tf,$TJ.height=$Tc,$TM=$Tet.height-$TM-$Tc,$TXt.mainContext.scissor($Tt,$TM,$Tf,$Tc),$TXt.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$TZ?($TM=$Tet.height-this.screenRect.y-this.screenRect.height,$TXt.mainContext.scissor(this.screenRect.x,$TM,this.screenRect.width,this.screenRect.height),$TXt.mainContext.enable(3089)):($TXt.mainContext.disable(3089),$Tet.worldScissorTest=!1),$TJ.copyFrom(this.screenRect),!0},$Tt.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$Tt.getRenderType=function(){return 0},$Tt.releaseRender=function(){var $Tt=$Tf._cache;($Tt[$Tt._length++]=this).context=null},$Tf.create=function($Tt){var $TM=$Tf._cache._length?$Tf._cache[--$Tf._cache._length]:new $Tf;return $TM.context=$Tt,$TM},$Tf._cache=(($Tf._cache=[])._length=0,$Tf._cache),$Tf}(),$Tpt=function(){function $TA(){this.step=0,this.blendMode=null,this.level=0}$Tb($TA,"laya.webgl.submit.SubmitStencil");var $Tt=$TA.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$Tt.getRenderType=function(){return 0},$Tt.releaseRender=function(){var $Tt=$TA._cache;$Tt[$Tt._length++]=this},$Tt.do1=function(){var $Tt=$TXt.mainContext;$Tt.enable(2960),$Tt.clear(1024),$Tt.colorMask(!1,!1,!1,!1),$Tt.stencilFunc(514,this.level,255),$Tt.stencilOp(7680,7680,7682)},$Tt.do2=function(){var $Tt=$TXt.mainContext;$Tt.stencilFunc(514,this.level+1,255),$Tt.colorMask(!0,!0,!0,!0),$Tt.stencilOp(7680,7680,7680)},$Tt.do3=function(){var $Tt=$TXt.mainContext;$Tt.colorMask(!0,!0,!0,!0),$Tt.stencilOp(7680,7680,7680),$Tt.clear(1024),$Tt.disable(2960)},$Tt.do4=function(){var $Tt=$TXt.mainContext;0==this.level&&($Tt.enable(2960),$Tt.clear(1024)),$Tt.colorMask(!1,!1,!1,!1),$Tt.stencilFunc(519,0,255),$Tt.stencilOp(7680,7680,7682)},$Tt.do5=function(){var $Tt=$TXt.mainContext;$Tt.stencilFunc(514,this.level,255),$Tt.colorMask(!0,!0,!0,!0),$Tt.stencilOp(7680,7680,7680)},$Tt.do6=function(){var $Tt=$TXt.mainContext;$TP.targetFns[$TP.TOINT[this.blendMode]]($Tt)},$Tt.do7=function(){var $Tt=$TXt.mainContext;$Tt.colorMask(!1,!1,!1,!1),$Tt.stencilOp(7680,7680,7683)},$Tt.do8=function(){var $Tt=$TXt.mainContext;$Tt.colorMask(!0,!0,!0,!0),$Tt.stencilFunc(514,this.level,255),$Tt.stencilOp(7680,7680,7680)},$TA.restore=function($Tt,$TM,$Tf,$Tc,$TD){var $To;if(($Tt._renderKey=0)<$TA._mask&&$TA._mask--,0==$TA._mask)$To=laya.webgl.submit.SubmitStencil.create(3),$Tt.addRenderObject($To),$Tt._curSubmit=$Tot.RENDERBASE;else{$To=laya.webgl.submit.SubmitStencil.create(7),$Tt.addRenderObject($To);var $TJ=$Tt._vb;$TJ._byteLength;if($T_t.fillRectImgVb($TJ,null,$TM.x,$TM.y,$TM.width,$TM.height,$Tr.DEF_UV,$Tf,$Tc,$TD,0,0)){$Tt._shader2D.glTexture=null;var $TZ=$Tt._curSubmit=$Tot.createSubmit($Tt,$Tt._ib,$TJ,($TJ._byteLength-64)/32*3,$Tit.create(2,0));$TZ.shaderValue.ALPHA=1,$Tt._submits[$Tt._submits._length++]=$TZ,$Tt._curSubmit._numEle+=6,$Tt._curSubmit=$Tot.RENDERBASE}else alert("clipRect calc stencil rect error");$To=laya.webgl.submit.SubmitStencil.create(8),$Tt.addRenderObject($To)}},$TA.restore2=function($Tt,$TM){var $Tf;($Tt._renderKey=0)<$TA._mask&&$TA._mask--,0==$TA._mask?($Tf=laya.webgl.submit.SubmitStencil.create(3),$Tt.addRenderObject($Tf),$Tt._curSubmit=$Tot.RENDERBASE):($Tf=laya.webgl.submit.SubmitStencil.create(7),$Tt.addRenderObject($Tf),$Tt._submits[$Tt._submits._length++]=$TM,$Tf=laya.webgl.submit.SubmitStencil.create(8),$Tt.addRenderObject($Tf))},$TA.create=function($Tt){var $TM=$TA._cache._length?$TA._cache[--$TA._cache._length]:new $TA;return 5==($TM.step=$Tt)&&++$TA._mask,$TM.level=$TA._mask,$TM},$TA._cache=(($TA._cache=[])._length=0,$TA._cache),$TA._mask=0,$TA}(),$TBt=function(){function $TZ(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$Tb($TZ,"laya.webgl.submit.SubmitTarget");var $Tt=$TZ.prototype;return $Th.imps($Tt,{"laya.webgl.submit.ISubmit":!0}),$Tt.renderSubmit=function(){this._vb.bind_upload(this._ib);var $Tt=this.scope.getValue(this.proName);return $Tt&&(this.shaderValue.texture=$Tt.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$Tt.width,$Tt.height]),this.shaderValue.upload(),this.blend(),$TF.drawCall++,$TF.trianglesFaces+=this._numEle/3,$TXt.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$Tt.blend=function(){if($TP.activeBlendFunction!==$TP.fns[this.blendType]){var $Tt=$TXt.mainContext;$Tt.enable(3042),$TP.fns[this.blendType]($Tt),$TP.activeBlendFunction=$TP.fns[this.blendType]}},$Tt.getRenderType=function(){return 0},$Tt.releaseRender=function(){var $Tt=$TZ._cache;($Tt[$Tt._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$TZ.create=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$TZ._cache._length?$TZ._cache[--$TZ._cache._length]:new $TZ;return $TJ._ib=$TM,$TJ._vb=$Tf,$TJ.proName=$To,$TJ._startIdx=$Tc*$Tlt.BYTES_PIDX,$TJ._numEle=0,$TJ.blendType=$Tt._nBlendType,$TJ.shaderValue=$TD,$TJ.shaderValue.setValue($Tt._shader2D),$TJ},$TZ._cache=(($TZ._cache=[])._length=0,$TZ._cache),$TZ}(),$Tbt=function(){function $Tt(){this._sourceStr=null}$Tb($Tt,"laya.webgl.text.CharSegment");var $TM=$Tt.prototype;return $Th.imps($TM,{"laya.webgl.text.ICharSegment":!0}),$TM.textToSpit=function($Tt){this._sourceStr=$Tt},$TM.getChar=function($Tt){return this._sourceStr.charAt($Tt)},$TM.getCharCode=function($Tt){return this._sourceStr.charCodeAt($Tt)},$TM.length=function(){return this._sourceStr.length},$Tt}(),$TIt=function(){var $Tt;function $TF(){}return $Tb($TF,"laya.webgl.text.DrawText"),$TF.__init__=function(){$TF._charsTemp=new Array,$TF._drawValue=new $Tt,$TF._charSeg=new $Tbt},$TF.customCharSeg=function($Tt){$TF._charSeg=$Tt},$TF.getChar=function($Tt,$TM,$Tf){var $Tc=$TRt.createOneChar($Tt,$Tf);return-1!=$TM&&($TF._charsCache[$TM]=$Tc),$Tc},$TF._drawSlow=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb,$TI,$Tq){var $Tl,$T_,$TE=$TF._drawValue.value($To,$TZ,$TA,$TL,$Tb,$TI,$Tq),$Te=0,$TN=0,$TX=$TF._charsTemp,$Ty=0,$Th=NaN;if($Tc)for($TX.length=$Tc.length,$Te=0,$TN=$Tc.length;$Te<$TN;$Te++)($T_=$Tc[$Te])&&($Th=$T_.charNum+$TE.txtID,$TX[$Te]=$Tl=$TF._charsCache[$Th]||$TF.getChar($T_.char,$Th,$TE),$Tl.active());else{var $TT=$Tf instanceof laya.utils.WordText?$Tf.toString():$Tf;if($Ts.CharacterCache){$TF._charSeg.textToSpit($TT);var $Ti=$TF._charSeg.length();for($Te=0,$TN=$TX.length=$Ti;$Te<$TN;$Te++)$Th=$TF._charSeg.getCharCode($Te)+$TE.txtID,$TX[$Te]=$Tl=$TF._charsCache[$Th]||$TF.getChar($TF._charSeg.getChar($Te),$Th,$TE),$Tl.active(),$Ty+=$Tl.cw}else $TX.length=0,($Tl=$TF.getChar($TT,-1,$TE)).active(),$Ty+=$Tl.cw,$TX[0]=$Tl}var $TV=0;null!==$TJ&&"left"!==$TJ&&($TV=-("center"==$TJ?$Ty/2:$Ty));var $Tx,$TO,$TC=NaN,$TU=0;if($Tc)for($Te=0,$TN=$TX.length;$Te<$TN;$Te++)$Tl=$TX[$Te],$T_=$Tc[$Te],$Tl&&$T_&&!$Tl.isSpace&&($TC=$Tl.borderSize,$Tx=$Tl.texture,$TM._drawText($Tx,$Tp+$TV+$T_.x*$Tb-$TC,$TB+$T_.y*$TI-$TC,$Tx.width,$Tx.height,$TD,0,0,0,0));else{for($Te=0,$TN=$TX.length;$Te<$TN;$Te++)($Tl=$TX[$Te])&&!$Tl.isSpace&&($TC=$Tl.borderSize,$Tx=$Tl.texture,$TM._drawText($Tx,$Tp+$TV-$TC,$TB-$TC,$Tx.width,$Tx.height,$TD,0,0,0,0),$Tt&&(($TO=$Tt[$TU++])||($TO=$Tt[$TU-1]=[]),$TO[0]=$Tx,$TO[1]=$TV-$TC,$TO[2]=-$TC)),$TV+=$Tl.cw;$Tt&&($Tt.length=$TU)}},$TF._drawFast=function($Tt,$TM,$Tf,$Tc,$TD){for(var $To,$TJ,$TZ=0,$TA=$Tt.length;$TZ<$TA;$TZ++)($To=($TJ=$Tt[$TZ])[0]).active(),$TM._drawText($To,$Tc+$TJ[1],$TD+$TJ[2],$To.width,$To.height,$Tf,0,0,0,0)},$TF.drawText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB){if(void 0===$TB&&($TB=0),!($TM&&0===$TM.length||$Tf&&0===$Tf.length)){var $Tb=$Tc.a,$TI=$Tc.d;(0!==$Tc.b||0!==$Tc.c)&&($Tb=$TI=1);var $Tq=1!==$Tb||1!==$TI;if($Tq&&$Th.stage.transform){var $Tl=$Th.stage.transform;$Tq=$Tl.a===$Tb&&$Tl.d===$TI}else $Tq=!1;if($Tq){var $T_=($Tc=$Tc.copyTo($TTt._tmpMatrix)).tx,$TE=$Tc.ty;$Tc.scale(1/$Tb,1/$TI),$Tc._checkTransform(),$TL*=$Tb,$Tp*=$TI,$TL+=$T_-$Tc.tx,$Tp+=$TE-$Tc.ty}else $Tb=$TI=1;if($Tf)$TF._drawSlow(null,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$Tb,$TI,$TB);else{if(null===$TM.toUpperCase){var $Te=$Tb+1e5*$TI,$TN=$TM;return void($TN.changed||$TN.id!==$Te?($TN.id=$Te,$TN.changed=!1,$TF._drawSlow($TN.save,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$Tb,$TI,$TB)):$TF._drawFast($TN.save,$Tt,$Tc,$TL,$Tp))}var $TX=$TM+$TD.toString()+$TJ+$TZ+$TA+$Tb+$TI+$To,$Ty=$TF._textsCache[$TX];$Ts.CharacterCache?$Ty?$TF._drawFast($Ty,$Tt,$Tc,$TL,$Tp):($TF._textsCache.__length||($TF._textsCache.__length=0),$TF._textsCache.__length>$TT.WebGLTextCacheCount&&(($TF._textsCache={}).__length=0,$TF._curPoolIndex=0),$TF._textCachesPool[$TF._curPoolIndex]?($Ty=$TF._textsCache[$TX]=$TF._textCachesPool[$TF._curPoolIndex]).length=0:$TF._textCachesPool[$TF._curPoolIndex]=$Ty=$TF._textsCache[$TX]=[],$TF._textsCache.__length++,$TF._curPoolIndex++,$TF._drawSlow($Ty,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$Tb,$TI,$TB)):$TF._drawSlow($Ty,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$Tb,$TI,$TB)}}},$TF._charsTemp=null,$TF._textCachesPool=[],$TF._curPoolIndex=0,$TF._charsCache={},$TF._textsCache={},$TF._drawValue=null,$TF.d=[],$TF._charSeg=null,$TF.__init$=function(){$Tt=function(){function $TA(){}return $Tb($TA,""),$TA.prototype.value=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this.font=$Tt,this.fillColor=$TM,this.borderColor=$Tf,this.lineWidth=$Tc,this.scaleX=$TD,this.scaleY=$To,this.underLine=$TJ;var $TZ=$Tt.toString()+$TD+$To+$Tc+($TM?$TM.toLowerCase():" ")+($Tf?$Tf.toLowerCase():" ")+$TJ;return this.txtID=$TA._keymap[$TZ],this.txtID||(this.txtID=1e-7*++$TA._keymapCount,$TA._keymap[$TZ]=this.txtID),this},$TA.clear=function(){$TA._keymap={},$TA._keymapCount=1},$TA._keymap={},$TA._keymapCount=1,$TA}()},$TF}(),$Tqt=function(){function $TD($Tt){this._index=0,this._size=14,this._italic=-2,$TD._cache2=$TD._cache2||[],this.setFont($Tt||"14px Arial")}$Tb($TD,"laya.webgl.text.FontInContext");var $Tt=$TD.prototype;return $Tt.setFont=function($Tt){var $TM=$TD._cache2[$Tt];if($TM)this._words=$TM[0],this._size=$TM[1];else{this._words=$Tt.split(" ");for(var $Tf=0,$Tc=this._words.length;$Tf<$Tc;$Tf++)if(0<this._words[$Tf].indexOf("px")){this._index=$Tf;break}this._size=parseInt(this._words[this._index]),$TD._cache2[$Tt]=[this._words,this._size]}this._text=null,this._italic=-2},$Tt.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$Tt.hasType=function($Tt){for(var $TM=0,$Tf=this._words.length;$TM<$Tf;$TM++)if(this._words[$TM]===$Tt)return $TM;return-1},$Tt.removeType=function($Tt){for(var $TM=0,$Tf=this._words.length;$TM<$Tf;$TM++)if(this._words[$TM]===$Tt){this._words.splice($TM,1),this._index>$TM&&this._index--;break}this._text=null,this._italic=-2},$Tt.copyTo=function($Tt){return $Tt._text=this._text,$Tt._size=this._size,$Tt._index=this._index,$Tt._words=this._words.slice(),$Tt._italic=-2,$Tt},$Tt.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$Tc(0,$Tt,"size",function(){return this._size},function($Tt){this._size=$Tt,this._words[this._index]=$Tt+"px",this._text=null}),$TD.create=function($Tt){var $TM=$TD._cache[$Tt];return $TM||($TM=$TD._cache[$Tt]=new $TD($Tt))},$TD.EMPTY=new $TD,$TD._cache={},$TD._cache2=null,$TD}(),$Tlt=function(){function $Tt(){}return $Tb($Tt,"laya.webgl.utils.CONST3D2D"),$Tt.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Tt.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$Tt.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$Tt._TMPARRAY=[],$Tt._OFFSETX=0,$Tt._OFFSETY=0,$TJ($Tt,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$Tt}(),$T_t=function(){function $Tq(){}return $Tb($Tq,"laya.webgl.utils.GlUtils"),$Tq.make2DProjection=function($Tt,$TM,$Tf){return[2/$Tt,0,0,0,0,-2/$TM,0,0,0,0,2/$Tf,0,-1,1,0,1]},$Tq.fillIBQuadrangle=function($Tt,$TM){if(65535/4<$TM)throw Error("IBQuadrangle count:"+$TM+" must<:"+Math.floor(65535/4));$TM=Math.floor($TM),$Tt._resizeBuffer(6*($TM+1)*2,!1),$Tt.byteLength=$Tt.bufferLength;for(var $Tf=$Tt.getUint16Array(),$Tc=0,$TD=0;$TD<$TM;$TD++)$Tf[$Tc++]=4*$TD,$Tf[$Tc++]=4*$TD+2,$Tf[$Tc++]=4*$TD+1,$Tf[$Tc++]=4*$TD,$Tf[$Tc++]=4*$TD+3,$Tf[$Tc++]=4*$TD+2;return $Tt.setNeedUpload(),!0},$Tq.expandIBQuadrangle=function($Tt,$TM){$Tt.bufferLength>=6*$TM*2||$Tq.fillIBQuadrangle($Tt,$TM)},$Tq.mathCeilPowerOfTwo=function($Tt){return $Tt--,$Tt|=$Tt>>1,$Tt|=$Tt>>2,$Tt|=$Tt>>4,$Tt|=$Tt>>8,$Tt|=$Tt>>16,++$Tt},$Tq.fillQuadrangleImgVb=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=16+($Tt._byteLength>>2);$Tt.byteLength=$TA<<2;var $TL=$Tt.getFloat32Array();$TL[($TA-=16)+2]=$TD[0],$TL[$TA+3]=$TD[1],$TL[$TA+6]=$TD[2],$TL[$TA+7]=$TD[3],$TL[$TA+10]=$TD[4],$TL[$TA+11]=$TD[5],$TL[$TA+14]=$TD[6],$TL[$TA+15]=$TD[7];var $Tp=$To.a,$TB=$To.b,$Tb=$To.c,$TI=$To.d;if(1!==$Tp||0!==$TB||0!==$Tb||1!==$TI){$To.bTransform=!0;var $Tq=$To.tx+$TJ,$Tl=$To.ty+$TZ;$TL[$TA]=($Tc[0]+$TM)*$Tp+($Tc[1]+$Tf)*$Tb+$Tq,$TL[$TA+1]=($Tc[0]+$TM)*$TB+($Tc[1]+$Tf)*$TI+$Tl,$TL[$TA+4]=($Tc[2]+$TM)*$Tp+($Tc[3]+$Tf)*$Tb+$Tq,$TL[$TA+5]=($Tc[2]+$TM)*$TB+($Tc[3]+$Tf)*$TI+$Tl,$TL[$TA+8]=($Tc[4]+$TM)*$Tp+($Tc[5]+$Tf)*$Tb+$Tq,$TL[$TA+9]=($Tc[4]+$TM)*$TB+($Tc[5]+$Tf)*$TI+$Tl,$TL[$TA+12]=($Tc[6]+$TM)*$Tp+($Tc[7]+$Tf)*$Tb+$Tq,$TL[$TA+13]=($Tc[6]+$TM)*$TB+($Tc[7]+$Tf)*$TI+$Tl}else $To.bTransform=!1,$TM+=$To.tx+$TJ,$Tf+=$To.ty+$TZ,$TL[$TA]=$TM+$Tc[0],$TL[$TA+1]=$Tf+$Tc[1],$TL[$TA+4]=$TM+$Tc[2],$TL[$TA+5]=$Tf+$Tc[3],$TL[$TA+8]=$TM+$Tc[4],$TL[$TA+9]=$Tf+$Tc[5],$TL[$TA+12]=$TM+$Tc[6],$TL[$TA+13]=$Tf+$Tc[7];return $Tt._upload=!0},$Tq.fillTranglesVB=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ=($Tt._byteLength>>2)+$Tc.length;$Tt.byteLength=$TZ<<2;var $TA=$Tt.getFloat32Array();$TZ-=$Tc.length;for(var $TL=$Tc.length,$Tp=$TD.a,$TB=$TD.b,$Tb=$TD.c,$TI=$TD.d,$Tq=0;$Tq<$TL;$Tq+=4)if($TA[$TZ+$Tq+2]=$Tc[$Tq+2],$TA[$TZ+$Tq+3]=$Tc[$Tq+3],1!==$Tp||0!==$TB||0!==$Tb||1!==$TI){$TD.bTransform=!0;var $Tl=$TD.tx+$To,$T_=$TD.ty+$TJ;$TA[$TZ+$Tq]=($Tc[$Tq]+$TM)*$Tp+($Tc[$Tq+1]+$Tf)*$Tb+$Tl,$TA[$TZ+$Tq+1]=($Tc[$Tq]+$TM)*$TB+($Tc[$Tq+1]+$Tf)*$TI+$T_}else $TD.bTransform=!1,$TM+=$TD.tx+$To,$Tf+=$TD.ty+$TJ,$TA[$TZ+$Tq]=$TM+$Tc[$Tq],$TA[$TZ+$Tq+1]=$Tf+$Tc[$Tq+1];return $Tt._upload=!0},$Tq.copyPreImgVb=function($Tt,$TM,$Tf){var $Tc=$Tt._byteLength>>2;$Tt.byteLength=$Tc+16<<2;for(var $TD=$Tt.getFloat32Array(),$To=0,$TJ=$Tc-16;$To<4;$To++)$TD[$Tc]=$TD[$TJ]+$TM,++$TJ,$TD[++$Tc]=$TD[$TJ]+$Tf,++$TJ,$TD[++$Tc]=$TD[$TJ],++$TJ,$TD[++$Tc]=$TD[$TJ],++$Tc,++$TJ;$Tt._upload=!0},$Tq.fillRectImgVb=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb){void 0===$Tb&&($Tb=!1);var $TI,$Tq,$Tl,$T_,$TE,$Te,$TN,$TX,$Ty,$Th,$TT,$Ti,$TV,$Tx,$TO,$TC,$TU=1,$TF=$TZ.a,$TS=$TZ.b,$TH=$TZ.c,$Ts=$TZ.d,$Tr=$TM&&$TM.width<99999999;if(1!==$TF||0!==$TS||0!==$TH||1!==$Ts?($TZ.bTransform=!0,0===$TS&&0===$TH&&($TU=23,$Ty=$TD+$Tf,$Th=$To+$Tc,$TI=$TF*$Tf+($TT=$TZ.tx+$TA),$Tl=$TF*$Ty+$TT,$Tq=$Ts*$Tc+($Ti=$TZ.ty+$TL),$T_=$Ts*$Th+$Ti)):($TU=23,$TZ.bTransform=!1,$Tl=($TI=$Tf+$TZ.tx+$TA)+$TD,$T_=($Tq=$Tc+$TZ.ty+$TL)+$To),$Tr&&($TE=$TM.x,$Te=$TM.y,$TN=$TM.width+$TE,$TX=$TM.height+$Te),1!==$TU){if(Math.min($TI,$Tl)>=$TN)return!1;if(Math.min($Tq,$T_)>=$TX)return!1;if(Math.max($Tl,$TI)<=$TE)return!1;if(Math.max($T_,$Tq)<=$Te)return!1}var $Tu=$Tt._byteLength>>2;$Tt.byteLength=16+$Tu<<2;var $Tv=$Tt.getFloat32Array();switch($Tv[2+$Tu]=$TJ[0],$Tv[3+$Tu]=$TJ[1],$Tv[6+$Tu]=$TJ[2],$Tv[7+$Tu]=$TJ[3],$Tv[10+$Tu]=$TJ[4],$Tv[11+$Tu]=$TJ[5],$Tv[14+$Tu]=$TJ[6],$Tv[15+$Tu]=$TJ[7],$TU){case 1:$TT=$TZ.tx+$TA,$Ti=$TZ.ty+$TL;var $Tk=$TF*$Tf,$TK=$TH*$Tc,$Tj=$Ts*$Tc,$Td=$TS*$Tf,$T$=$TF*($Ty=$TD+$Tf),$TP=$TH*($Th=$To+$Tc),$TY=$Ts*$Th,$Tn=$TS*$Ty;$Tb?($TV=$Tk+$TK+$TT,$TO=Math.round($TV)-$TV,$Tx=$Tj+$Td+$Ti,$TC=Math.round($Tx)-$Tx,$Tv[$Tu]=$TV+$TO,$Tv[1+$Tu]=$Tx+$TC,$Tv[4+$Tu]=$T$+$TK+$TT+$TO,$Tv[5+$Tu]=$Tj+$Tn+$Ti+$TC,$Tv[8+$Tu]=$T$+$TP+$TT+$TO,$Tv[9+$Tu]=$TY+$Tn+$Ti+$TC,$Tv[12+$Tu]=$Tk+$TP+$TT+$TO,$Tv[13+$Tu]=$TY+$Td+$Ti+$TC):($Tv[$Tu]=$Tk+$TK+$TT,$Tv[1+$Tu]=$Tj+$Td+$Ti,$Tv[4+$Tu]=$T$+$TK+$TT,$Tv[5+$Tu]=$Tj+$Tn+$Ti,$Tv[8+$Tu]=$T$+$TP+$TT,$Tv[9+$Tu]=$TY+$Tn+$Ti,$Tv[12+$Tu]=$Tk+$TP+$TT,$Tv[13+$Tu]=$TY+$Td+$Ti);break;case 23:$Tb?($TV=$TI+$Tp,$TO=Math.round($TV)-$TV,$Tx=$Tq,$TC=Math.round($Tx)-$Tx,$Tv[$Tu]=$TV+$TO,$Tv[1+$Tu]=$Tx+$TC,$Tv[4+$Tu]=$Tl+$Tp+$TO,$Tv[5+$Tu]=$Tq+$TC,$Tv[8+$Tu]=$Tl+$TO,$Tv[9+$Tu]=$T_+$TC,$Tv[12+$Tu]=$TI+$TO,$Tv[13+$Tu]=$T_+$TC):($Tv[$Tu]=$TI+$Tp,$Tv[1+$Tu]=$Tq,$Tv[4+$Tu]=$Tl+$Tp,$Tv[5+$Tu]=$Tq,$Tv[8+$Tu]=$Tl,$Tv[9+$Tu]=$T_,$Tv[12+$Tu]=$TI,$Tv[13+$Tu]=$T_)}return $Tt._upload=!0},$Tq.fillLineVb=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=.5*$TJ,$TL=$Tq._fillLineArray,$Tp=-($Tc-$To),$TB=$Tf-$TD,$Tb=Math.sqrt($Tp*$Tp+$TB*$TB);$Tp/=$Tb,$TB/=$Tb,$Tp*=$TA,$TB*=$TA,$TL[0]=$Tf-$Tp,$TL[1]=$Tc-$TB,$TL[4]=$Tf+$Tp,$TL[5]=$Tc+$TB,$TL[8]=$TD+$Tp,$TL[9]=$To+$TB,$TL[12]=$TD-$Tp,$TL[13]=$To-$TB,$TZ&&$TZ.transformPointArray($TL,$TL);var $TI=16+($Tt._byteLength>>2);return $Tt.byteLength=$TI<<2,$Tt.insertData($TL,$TI-16),!0},$Tq._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$Tq}(),$TEt=(function(){function $TA(){}$Tb($TA,"laya.webgl.utils.MatirxArray"),$TA.ArrayMul=function($Tt,$TM,$Tf){if($Tt)if($TM)for(var $Tc=NaN,$TD=NaN,$To=NaN,$TJ=NaN,$TZ=0;$TZ<4;$TZ++)$Tc=$Tt[$TZ],$TD=$Tt[$TZ+4],$To=$Tt[$TZ+8],$TJ=$Tt[$TZ+12],$Tf[$TZ]=$Tc*$TM[0]+$TD*$TM[1]+$To*$TM[2]+$TJ*$TM[3],$Tf[$TZ+4]=$Tc*$TM[4]+$TD*$TM[5]+$To*$TM[6]+$TJ*$TM[7],$Tf[$TZ+8]=$Tc*$TM[8]+$TD*$TM[9]+$To*$TM[10]+$TJ*$TM[11],$Tf[$TZ+12]=$Tc*$TM[12]+$TD*$TM[13]+$To*$TM[14]+$TJ*$TM[15];else $TA.copyArray($Tt,$Tf);else $TA.copyArray($TM,$Tf)},$TA.copyArray=function($Tt,$TM){if($Tt&&$TM)for(var $Tf=0;$Tf<$Tt.length;$Tf++)$TM[$Tf]=$Tt[$Tf]}}(),function(){function $TM($Tt,$TM,$Tf){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$Tt,this._vb=new $TWt($Tt,35048),$TM&&this._vb._resizeBuffer($TM,!1),this._ib=new $Twt,$Tf&&this._ib._resizeBuffer($Tf,!1)}$Tb($TM,"laya.webgl.utils.Mesh2D");var $Tt=$TM.prototype;return $Tt.cloneWithNewVB=function(){var $Tt=new $TM(this._stride,0,0);return $Tt._ib=this._ib,$Tt._quadNum=this._quadNum,$Tt._attribInfo=this._attribInfo,$Tt},$Tt.cloneWithNewVBIB=function(){var $Tt=new $TM(this._stride,0,0);return $Tt._attribInfo=this._attribInfo,$Tt},$Tt.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$Tt.getVBR=function(){return this._vb},$Tt.getIBR=function(){return this._ib},$Tt.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$Tt.createQuadIB=function($Tt){this._quadNum=$Tt,this._ib._resizeBuffer(6*$Tt*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $TM=this._ib.getUint16Array(),$Tf=0,$Tc=0,$TD=0;$TD<$Tt;$TD++)$TM[$Tf++]=$Tc,$TM[$Tf++]=$Tc+2,$TM[$Tf++]=$Tc+1,$TM[$Tf++]=$Tc,$TM[$Tf++]=$Tc+3,$TM[$Tf++]=$Tc+2,$Tc+=4;this._ib.setNeedUpload()},$Tt.setAttributes=function($Tt){if(this._attribInfo=$Tt,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$Tt.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$Tt.releaseMesh=function(){},$Tt.destroy=function(){},$Tt.clearVB=function(){this._vb.clear()},$TM._gvaoid=0,$TM}()),$Tet=function(){function $TD(){}return $Tb($TD,"laya.webgl.utils.RenderState2D"),$TD.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$TD.mat2MatArray=function($Tt,$TM){var $Tf=$Tt,$Tc=$TM;return $Tc[0]=$Tf.a,$Tc[1]=$Tf.b,$Tc[2]=$TD.EMPTYMAT4_ARRAY[2],$Tc[3]=$TD.EMPTYMAT4_ARRAY[3],$Tc[4]=$Tf.c,$Tc[5]=$Tf.d,$Tc[6]=$TD.EMPTYMAT4_ARRAY[6],$Tc[7]=$TD.EMPTYMAT4_ARRAY[7],$Tc[8]=$TD.EMPTYMAT4_ARRAY[8],$Tc[9]=$TD.EMPTYMAT4_ARRAY[9],$Tc[10]=$TD.EMPTYMAT4_ARRAY[10],$Tc[11]=$TD.EMPTYMAT4_ARRAY[11],$Tc[12]=$Tf.tx,$Tc[13]=$Tf.ty,$Tc[14]=$TD.EMPTYMAT4_ARRAY[14],$Tc[15]=$TD.EMPTYMAT4_ARRAY[15],$TM},$TD.restoreTempArray=function(){$TD.TEMPMAT4_ARRAY[0]=1,$TD.TEMPMAT4_ARRAY[1]=0,$TD.TEMPMAT4_ARRAY[4]=0,$TD.TEMPMAT4_ARRAY[5]=1,$TD.TEMPMAT4_ARRAY[12]=0,$TD.TEMPMAT4_ARRAY[13]=0},$TD.clear=function(){$TD.worldScissorTest=!1,$TD.worldShaderDefines=null,$TD.worldFilters=null,$TD.worldAlpha=1,$TD.worldClipRect.x=$TD.worldClipRect.y=0,$TD.worldClipRect.width=$TD.width,$TD.worldClipRect.height=$TD.height,$TD.curRenderTarget=null},$TD._MAXSIZE=99999999,$TD.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$TD.worldMatrix4=$TD.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$TD.worldAlpha=1,$TD.worldScissorTest=!1,$TD.worldFilters=null,$TD.worldShaderDefines=null,$TD.curRenderTarget=null,$TD.width=0,$TD.height=0,$TJ($TD,["worldMatrix",function(){return this.worldMatrix=new $TV},"worldClipRect",function(){return this.worldClipRect=new $TO(0,0,99999999,99999999)}]),$TD}(),$TNt=function(){var $Te,$Tf;function $TN($Tt,$TM,$Tf,$Tc,$TD){var $To=this;function $TJ($Tt){var $TM=[],$Tf=new $Te($TM);return $To._compileToTree($Tf,$Tt.split("\n"),0,$TM,$TD),$Tf}var $TZ=$TI.now();this._VS=$TJ($TM),this._PS=$TJ($Tf),this._nameMap=$Tc,2<$TI.now()-$TZ&&console.log("ShaderCompile use time:"+($TI.now()-$TZ)+"  size:"+$TM.length+"/"+$Tf.length)}$Tb($TN,"laya.webgl.utils.ShaderCompile");var $Tt=$TN.prototype;return $Tt._compileToTree=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb=0,$TI=0,$Tq=0,$Tl=0;for($TI=$Tf;$TI<$TM.length;$TI++)if(!(($TZ=$TM[$TI]).length<1)&&0!==($Tb=$TZ.indexOf("//"))){if(0<=$Tb&&($TZ=$TZ.substr(0,$Tb)),$To=$TB||new $Te($Tc),$TB=null,$To.text=$TZ,$To.noCompile=!0,0<=($Tb=$TZ.indexOf("#"))){for($TA="#",$Tl=$Tb+1,$Tq=$TZ.length;$Tl<$Tq;$Tl++){var $T_=$TZ.charAt($Tl);if(" "===$T_||"\t"===$T_||"\r"===$T_||"\n"===$T_||"?"===$T_)break;$TA+=$T_}switch($To.name=$TA){case"#ifdef":case"#ifndef":if($To.src=$TZ,$To.noCompile=null!=$TZ.match(/[!&|()=<>]/),$To.noCompile?console.log("function():Boolean{return "+$TZ.substr($Tb+$To.name.length)+"}"):($Tp=$TZ.replace(/^\s*/,"").split(/\s+/),$To.setCondition($Tp[1],"#ifdef"===$TA?1:2),$To.text="//"+$To.text),$To.setParent($Tt),$Tt=$To,$TD)for($Tp=$TZ.substr($Tl).split($TN._splitToWordExps3),$Tl=0;$Tl<$Tp.length;$Tl++)($TZ=$Tp[$Tl]).length&&($TD[$TZ]=!0);continue;case"#if":if($To.src=$TZ,$To.noCompile=!0,$To.setParent($Tt),$Tt=$To,$TD)for($Tp=$TZ.substr($Tl).split($TN._splitToWordExps3),$Tl=0;$Tl<$Tp.length;$Tl++)($TZ=$Tp[$Tl]).length&&"defined"!=$TZ&&($TD[$TZ]=!0);continue;case"#else":$To.src=$TZ,$TJ=($Tt=$Tt.parent).childs[$Tt.childs.length-1],$To.noCompile=$TJ.noCompile,$To.noCompile||($To.condition=$TJ.condition,$To.conditionType=1==$TJ.conditionType?2:1,$To.text="//"+$To.text+" "+$TJ.text+" "+$To.conditionType),$To.setParent($Tt),$Tt=$To;continue;case"#endif":$TJ=($Tt=$Tt.parent).childs[$Tt.childs.length-1],$To.noCompile=$TJ.noCompile,$To.noCompile||($To.text="//"+$To.text),$To.setParent($Tt);continue;case"#include":$Tp=$TN.splitToWords($TZ,null);var $TE=$TN.includes[$Tp[1]];if(!$TE)throw"ShaderCompile error no this include file:"+$Tp[1];if(($Tb=$Tp[0].indexOf("?"))<0){$To.setParent($Tt),$TZ=$TE.getWith("with"==$Tp[2]?$Tp[3]:null),this._compileToTree($To,$TZ.split("\n"),0,$Tc,$TD),$To.text="";continue}$To.setCondition($Tp[0].substr($Tb+1),1),$To.text=$TE.getWith("with"==$Tp[2]?$Tp[3]:null);break;case"#import":$TL=($Tp=$TN.splitToWords($TZ,null))[1],$Tc.push({node:$To,file:$TN.includes[$TL],ofs:$To.text.length});continue}}else{if(($TJ=$Tt.childs[$Tt.childs.length-1])&&!$TJ.name){0<$Tc.length&&$TN.splitToWords($TZ,$TJ),$TB=$To,$TJ.text+="\n"+$TZ;continue}0<$Tc.length&&$TN.splitToWords($TZ,$To)}$To.setParent($Tt)}},$Tt.createShader=function($Tt,$TM,$Tf){var $Tc={},$TD="";if($Tt)for(var $To in $Tt)$TD+="#define "+$To+"\n",$Tc[$To]=!0;var $TJ=this._VS.toscript($Tc,[]),$TZ=this._PS.toscript($Tc,[]);return($Tf||$Tmt.create)($TD+$TJ.join("\n"),$TD+$TZ.join("\n"),$TM,this._nameMap)},$TN._parseOne=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ={type:$TN.shaderParamsMap[$Tf[$Tc+1]],name:$Tf[$Tc+2],size:isNaN(parseInt($Tf[$Tc+3]))?1:parseInt($Tf[$Tc+3])};return $To&&("attribute"==$TD?$Tt.push($TJ):$TM.push($TJ)),":"==$Tf[$Tc+3]&&($TJ.type=$Tf[$Tc+4],$Tc+=2),$Tc+=2},$TN.addInclude=function($Tt,$TM){if(!$TM||0===$TM.length)throw new Error("add shader include file err:"+$Tt);if($TN.includes[$Tt])throw new Error("add shader include file err, has add:"+$Tt);$TN.includes[$Tt]=new $Tf($TM)},$TN.preGetParams=function($Tt,$TM){var $Tf=[$Tt,$TM],$Tc={},$TD=[],$To=[],$TJ={},$TZ=[];$Tc.attributes=$TD,$Tc.uniforms=$To,$Tc.defines=$TJ;for(var $TA=0,$TL=0,$Tp=0;$Tp<2;$Tp++){$Tf[$Tp]=$Tf[$Tp].replace($TN._removeAnnotation,"");var $TB,$Tb=$Tf[$Tp].match($TN._reg);for($TA=0,$TL=$Tb.length;$TA<$TL;$TA++){var $TI=$Tb[$TA];if("attribute"==$TI||"uniform"==$TI)$TA=$TN._parseOne($TD,$To,$Tb,$TA,$TI,!0);else{if("#define"==$TI){$TZ[$TI=$Tb[++$TA]]=1;continue}if("#ifdef"==$TI){$TJ[$TB=$Tb[++$TA]]=$TJ[$TB]||[];for($TA++;$TA<$TL;$TA++)if("attribute"==($TI=$Tb[$TA])||"uniform"==$TI)$TA=$TN._parseOne($TD,$To,$Tb,$TA,$TI,$TZ[$TB]);else if("#else"==$TI)for($TA++;$TA<$TL;$TA++)if("attribute"==($TI=$Tb[$TA])||"uniform"==$TI)$TA=$TN._parseOne($TD,$To,$Tb,$TA,$TI,!$TZ[$TB]);else if("#endif"==$TI)break}}}}return $Tc},$TN.splitToWords=function($Tt,$TM){for(var $Tf,$Tc,$TD=[],$To=-1,$TJ=0,$TZ=$Tt.length;$TJ<$TZ;$TJ++)if($Tf=$Tt.charAt($TJ),0<=" \t=+-*/&%!<>()'\",;".indexOf($Tf)){if(0<=$To&&1<$TJ-$To&&($Tc=$Tt.substr($To,$TJ-$To),$TD.push($Tc)),'"'==$Tf||"'"==$Tf){var $TA=$Tt.indexOf($Tf,$TJ+1);if($TA<0)throw"Sharder err:"+$Tt;$TD.push($Tt.substr($TJ+1,$TA-$TJ-1)),$TJ=$TA,$To=-1;continue}"("==$Tf&&$TM&&0<$TD.length&&($Tc=$TD[$TD.length-1]+";","vec4;main;".indexOf($Tc)<0&&($TM.useFuns+=$Tc)),$To=-1}else $To<0&&($To=$TJ);return $To<$TZ&&1<$TZ-$To&&($Tc=$Tt.substr($To,$TZ-$To),$TD.push($Tc)),$TD},$TN.IFDEF_NO=0,$TN.IFDEF_YES=1,$TN.IFDEF_ELSE=2,$TN.IFDEF_PARENT=3,$TN._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$TN._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$TN._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$TN.includes={},$TJ($TN,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$TN.__init$=function(){$Te=function(){function $Tf($Tt){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$Tt}$Tb($Tf,"");var $Tt=$Tf.prototype;return $Tt.setParent=function($Tt){$Tt.childs.push(this),this.z=$Tt.z+1,this.parent=$Tt},$Tt.setCondition=function($Tt,$TM){$Tt&&(this.conditionType=$TM,$Tt=$Tt.replace(/(\s*$)/g,""),this.condition=function(){return this[$Tt]},this.condition.__condition=$Tt)},$Tt.toscript=function($Tt,$TM){return this._toscript($Tt,$TM,++$Tf.__id)},$Tt._toscript=function($Tc,$TD,$To){if(this.childs.length<1&&!this.text)return $TD;$TD.length;if(this.condition){var $Tt=!!this.condition.call($Tc);if(2===this.conditionType&&($Tt=!$Tt),!$Tt)return $TD}if(this.text&&$TD.push(this.text),0<this.childs.length&&this.childs.forEach(function($Tt,$TM,$Tf){$Tt._toscript($Tc,$TD,$To)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $TM,$Tf=0,$TJ=this.includefiles.length;$Tf<$TJ;$Tf++)this.includefiles[$Tf].curUseID!=$To&&0<($TM=this.includefiles[$Tf].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$Tf].curUseID=$To,$TD[0]=$TM+$TD[0]);return $TD},$Tf.__id=1,$Tf}(),$Tf=function(){function $Tt($Tt){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$Tt;for(var $TM=0,$Tf=0,$Tc=0;!(($TM=$Tt.indexOf("#begin",$TM))<0);){for($Tc=$TM+5;!(($Tc=$Tt.indexOf("#end",$Tc))<0)&&"i"===$Tt.charAt($Tc+4);)$Tc+=5;if($Tc<0)throw"add include err,no #end:"+$Tt;$Tf=$Tt.indexOf("\n",$TM);var $TD=$TN.splitToWords($Tt.substr($TM,$Tf-$TM),null);"code"==$TD[1]?this.codes[$TD[2]]=$Tt.substr($Tf+1,$Tc-$Tf-1):"function"==$TD[1]&&($Tf=$Tt.indexOf("function",$TM),$Tf+="function".length,this.funs[$TD[3]]=$Tt.substr($Tf+1,$Tc-$Tf-1),this.funnames+=$TD[3]+";"),$TM=$Tc+1}}$Tb($Tt,"");var $TM=$Tt.prototype;return $TM.getWith=function($Tt){var $TM=$Tt?this.codes[$Tt]:this.script;if(!$TM)throw"get with error:"+$Tt;return $TM},$TM.getFunsScript=function($Tt){var $TM="";for(var $Tf in this.funs)0<=$Tt.indexOf($Tf+";")&&($TM+=this.funs[$Tf]);return $TM},$Tt}()},$TN}(),$TXt=function(){function $TJ(){}return $Tb($TJ,"laya.webgl.WebGL"),$TJ._uint8ArraySlice=function(){for(var $Tt=this.length,$TM=new Uint8Array(this.length),$Tf=0;$Tf<$Tt;$Tf++)$TM[$Tf]=this[$Tf];return $TM},$TJ._float32ArraySlice=function(){for(var $Tt=this.length,$TM=new Float32Array(this.length),$Tf=0;$Tf<$Tt;$Tf++)$TM[$Tf]=this[$Tf];return $TM},$TJ._uint16ArraySlice=function($Tt){var $TM,$Tf=arguments,$Tc=0,$TD=0;if(0===$Tf.length)for($Tc=this.length,$TM=new Uint16Array($Tc),$TD=0;$TD<$Tc;$TD++)$TM[$TD]=this[$TD];else if(2===$Tf.length){var $To=$Tf[0],$TJ=$Tf[1];if($To<$TJ)for($Tc=$TJ-$To,$TM=new Uint16Array($Tc),$TD=$To;$TD<$TJ;$TD++)$TM[$TD-$To]=this[$TD];else $TM=new Uint16Array(0)}return $TM},$TJ.expandContext=function(){var $Tt=$TD.prototype,$TM=CanvasRenderingContext2D.prototype;$TM.fillTrangles=$Tt.fillTrangles,$TGt.__int__(null),$TM.setIBVB=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){void 0===$TA&&($TA=0),void 0===$TL&&($TL=0),null===$Tf&&(this._ib=this._ib||$Twt.QuadrangleIB,$Tf=this._ib,$T_t.expandIBQuadrangle($Tf,$Tc._byteLength/64+8)),this._setIBVB($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL)},$TM.fillTrangles=function($Tt,$TM,$Tf,$Tc,$TD){this._curMat=this._curMat||$TV.create(),this._vb=this._vb||$TWt.create(),this._ib||(this._ib=$Twt.create(),$T_t.fillIBQuadrangle(this._ib,$TJ/4));var $To=this._vb,$TJ=$Tc.length>>4;$T_t.fillTranglesVB($To,$TM,$Tf,$Tc,$TD||this._curMat,0,0),$T_t.expandIBQuadrangle(this._ib,$To._byteLength/64+8);var $TZ=new $Tit(1,0);$TZ.textureHost=$Tt;var $TA=new $TQt("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$To._vertType=3,this._setIBVB($TM,$Tf,this._ib,$To,6*$TJ,$TD,$TA,$TZ,0,0)}},$TJ.enable=function(){if($TI.__init__(),$TE.isConchApp&&!$TE.isConchWebGL)return $Ty.skinAniSprite=function(){return new $Ttt},$TJ.expandContext(),!1;if($Ty.getWebGLContext=function($Tt){for(var $TM,$Tf=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$Tc=0;$Tc<$Tf.length;$Tc++){try{$TM=$Tt.getContext($Tf[$Tc],{stencil:$TT.isStencil,alpha:$TT.isAlpha,antialias:$TT.isAntialias,premultipliedAlpha:$TT.premultipliedAlpha,preserveDrawingBuffer:$TT.preserveDrawingBuffer})}catch($Tt){}if($TM)return $TM}return null},null==($TJ.mainContext=$TJ.mainContext||$Ty.getWebGLContext($TE._mainCanvas)))return!1;if($TE.isWebGL)return!0;$Tl.create=function($Tt,$TM){return new $TtM($Tt,$TM)},$T_.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){return new $Tzt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ)},$TE.WebGL=$TJ,$TE.isWebGL=!0,$TIt.__init__(),$Ty.createRenderSprite=function($Tt,$TM){return new $TVt($Tt,$TM)},$Ty.createWebGLContext2D=function($Tt){return new $TTt($Tt)},$Ty.changeWebGLSize=function($Tt,$TM){laya.webgl.WebGL.onStageResize($Tt,$TM)},$Ty.createGraphics=function(){return new $Tht};var $Tt=$Ty.createFilterAction;return $Ty.createFilterAction=$Tt||function($Tt){return new $Txt},$Ty.clear=function($Tt){$Tet.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $TM=$TE.context.ctx,$Tf=0==$TM._submits._length||$TT.preserveDrawingBuffer?$Tq.create($Tt)._color:$TU._wgColor;$Tf&&$TM.clearBG($Tf[0],$Tf[1],$Tf[2],$Tf[3]),$Tet.clear()},$Ty.addToAtlas=function($Tt,$TM){void 0===$TM&&($TM=!1);var $Tf=$Tt.bitmap;$TE.optimizeTextureMemory($Tt.url,$Tt)?$Th.__typeof($Tf,"laya.webgl.resource.IMergeAtlasBitmap")&&$Tf.allowMerageInAtlas&&$Tf.on("recovered",$Tt,$Tt.addTextureToAtlas):$Tf.enableMerageInAtlas=!1},$Ty.isAtlas=function($Tt){return $Tt instanceof laya.webgl.atlas.AtlasWebGLCanvas},$Td._enable(),$Ty.beginFlush=function(){for(var $Tt=$Td.instance,$TM=$Tt.getAtlaserCount(),$Tf=0;$Tf<$TM;$Tf++){var $Tc=$Tt.getAtlaserByIndex($Tf).texture;$Tc._flashCacheImageNeedFlush&&$Ty.flashFlushImage($Tc)}},$Ty.drawToCanvas=function($Tt,$TM,$Tf,$Tc,$TD,$To){($Tf<=0||$Tc<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$Tf|=0,$Tc|=0,$TD|=0,$To|=0;var $TJ=$Tvt.create($Tf,$Tc,6408,5121,0,!1);$TJ.start(),$TJ.clear(0,0,0,0),$TE.context.clear(),$Te.renders[$TM]._fun($Tt,$TE.context,$TD,$Tet.height-$Tc+$To),$TE.context.flush(),$TJ.end();var $TZ=$TJ.getData(0,0,$Tf,$Tc);if($TJ.recycle(),$TZ.byteLength==$Tf*$Tc*4){var $TA=new $Tnt;$TA._canvas=$TI.createElement("canvas"),$TA.size($Tf,$Tc);var $TL=$TA._canvas.getContext("2d");$TI.canvas.size($Tf,$Tc);var $Tp=$TI.context,$TB=$Tp.createImageData($Tf,$Tc);return $TB.data.set(new Uint8ClampedArray($TZ.buffer)),$TA._imgData=$TB,$Tp.putImageData($TB,0,0),$TL.save(),$TL.translate(0,$Tc),$TL.scale(1,-1),$TL.drawImage($TI.canvas.source,0,0),$TL.restore(),$TA}console.log("drawToCanvas error: w:"+$Tf+",h:"+$Tc+",datalen:"+$TZ.byteLength)},$Ty.createFilterAction=function($Tt){var $TM;switch($Tt){case 32:$TM=new $Txt}return $TM},$Ty.addTextureToAtlas=function($Tt){$Tt._uvID++,$Td._atlasRestore++,$Tt.bitmap.enableMerageInAtlas&&$Td.instance.addToAtlas($Tt)},$Ty.getTexturePixels=function($Tt,$TM,$Tf,$Tc,$TD){$TE.context.ctx.clear();var $To=new $TC;$To.graphics.drawTexture($Tt,-$TM,-$Tf);var $TJ=$Tvt.create($Tc,$TD);$TJ.start(),$TJ.clear(0,0,0,0),$To.render($TE.context,0,0),$TE.context.ctx.flush(),$TJ.end();for(var $TZ=$TJ.getData(0,0,$Tc,$TD),$TA=[],$TL=0,$Tp=$TD-1;0<=$Tp;$Tp--)for(var $TB=0;$TB<$Tc;$TB++)$TL=4*($Tp*$Tc+$TB),$TA.push($TZ[$TL]),$TA.push($TZ[$TL+1]),$TA.push($TZ[$TL+2]),$TA.push($TZ[$TL+3]);return $TA},$Ty.skinAniSprite=function(){return new $Ttt},$TL.create=function($Tt,$TM){var $Tf=new $Tnt;return $Tf._imgData=$TM,$Tf.flipY=!1,$Tf},$Ti._filterStart=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tt.getValue("bounds"),$TJ=$Tvt.create($To.width,$To.height);if($TJ.start(),$TJ.clear(0,0,0,0),$Tt.addValue("src",$TJ),$Tt.addValue("ScissorTest",$Tet.worldScissorTest),$Tet.worldScissorTest){var $TZ=new $TO;$TZ.copyFrom($Tf.ctx._clipRect),$Tt.addValue("clipRect",$TZ),$Tet.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$Ti._filterEnd=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tt.getValue("bounds");$Tt.getValue("src").end();var $TJ=$Tvt.create($To.width,$To.height);$TJ.start(),$TJ.clear(0,0,0,0),$Tt.addValue("out",$TJ),$TM._set$P("_filterCache",$TJ),$TM._set$P("_isHaveGlowFilter",$Tt.getValue("_isHaveGlowFilter"))},$Ti._EndTarget=function($Tt,$TM){if($Tt.getValue("src").recycle(),$Tt.getValue("out").end(),$Tt.getValue("ScissorTest")){$Tet.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$TM.ctx.save();var $Tf=$Tt.getValue("clipRect");$TM.ctx.clipRect($Tf.x,$Tf.y,$Tf.width,$Tf.height)}},$Ti._useSrc=function($Tt){var $TM=$Tt.getValue("out");$TM.end(),($TM=$Tt.getValue("src")).start(),$TM.clear(0,0,0,0)},$Ti._endSrc=function($Tt){$Tt.getValue("src").end()},$Ti._useOut=function($Tt){var $TM=$Tt.getValue("src");$TM.end(),($TM=$Tt.getValue("out")).start(),$TM.clear(0,0,0,0)},$Ti._endOut=function($Tt){$Tt.getValue("out").end()},$Ti._recycleScope=function($Tt){$Tt.recycle()},$Ti._filter=function($Tt,$TM,$Tf,$Tc){var $TD=this._next;if($TD){var $To,$TJ,$TZ=$Tt.filters,$TA=$TZ.length;if(1==$TA&&32==$TZ[0].type)return $TM.ctx.save(),$TM.ctx.setFilters([$TZ[0]]),$TD._fun.call($TD,$Tt,$TM,$Tf,$Tc),void $TM.ctx.restore();var $TL=$TZt.create(),$Tp=$Tx.TEMP,$TB=$TM.ctx._getTransformMatrix(),$Tb=$TV.create();$TB.copyTo($Tb);var $TI=0,$Tq=0,$Tl=!1,$T_=$Tt._$P._filterCache?$Tt._$P._filterCache:null;if(!$T_||$Tt._repaint){$Tl=$Tt._isHaveGlowFilter(),$TL.addValue("_isHaveGlowFilter",$Tl),$Tl&&($TI=50,$Tq=25),($TJ=new $TO).copyFrom($Tt.getSelfBounds()),$TJ.x+=$Tt.x,$TJ.y+=$Tt.y,$TJ.x-=$Tt.pivotX+4,$TJ.y-=$Tt.pivotY+4;var $TE=$TJ.x,$Te=$TJ.y;if($TJ.width+=$TI+8,$TJ.height+=$TI+8,$Tp.x=$TJ.x*$Tb.a+$TJ.y*$Tb.c,$Tp.y=$TJ.y*$Tb.d+$TJ.x*$Tb.b,$TJ.x=$Tp.x,$TJ.y=$Tp.y,$Tp.x=$TJ.width*$Tb.a+$TJ.height*$Tb.c,$Tp.y=$TJ.height*$Tb.d+$TJ.width*$Tb.b,$TJ.width=$Tp.x,$TJ.height=$Tp.y,$TJ.width<=0||$TJ.height<=0)return;$T_&&$T_.recycle(),$TL.addValue("bounds",$TJ);var $TN=$TJt.create([$TL,$Tt,$TM,0,0],$Ti._filterStart);$TM.addRenderObject($TN),$TM.ctx._renderKey=0,$TM.ctx._shader2D.glTexture=null;var $TX=$Tt.x-$TE+$Tq,$Ty=$Tt.y-$Te+$Tq;$TD._fun.call($TD,$Tt,$TM,$TX,$Ty),$TN=$TJt.create([$TL,$Tt,$TM,0,0],$Ti._filterEnd),$TM.addRenderObject($TN);for(var $Th=0;$Th<$TA;$Th++){0!=$Th&&($TN=$TJt.create([$TL],$Ti._useSrc),$TM.addRenderObject($TN),$To=$Tit.create(1,0),$TV.TEMP.identity(),$TM.ctx.drawTarget($TL,0,0,$TJ.width,$TJ.height,$TV.TEMP,"out",$To,null,$TP.TOINT.overlay),$TN=$TJt.create([$TL],$Ti._useOut),$TM.addRenderObject($TN)),$TZ[$Th].action.apply3d($TL,$Tt,$TM,0,0)}$TN=$TJt.create([$TL,$TM],$Ti._EndTarget),$TM.addRenderObject($TN)}else{if(($Tl=!!$Tt._$P._isHaveGlowFilter&&$Tt._$P._isHaveGlowFilter)&&($TI=50,$Tq=25),($TJ=$Tt.getBounds()).width<=0||$TJ.height<=0)return;$TJ.width+=$TI,$TJ.height+=$TI,$Tp.x=$TJ.x*$Tb.a+$TJ.y*$Tb.c,$Tp.y=$TJ.y*$Tb.d+$TJ.x*$Tb.b,$TJ.x=$Tp.x,$TJ.y=$Tp.y,$Tp.x=$TJ.width*$Tb.a+$TJ.height*$Tb.c,$Tp.y=$TJ.height*$Tb.d+$TJ.width*$Tb.b,$TJ.width=$Tp.x,$TJ.height=$Tp.y,$TL.addValue("out",$T_)}$Tf=$Tf-$Tq-$Tt.x,$Tc=$Tc-$Tq-$Tt.y,$Tp.setTo($Tf,$Tc),$Tb.transformPoint($Tp),$Tf=$Tp.x+$TJ.x,$Tc=$Tp.y+$TJ.y,$To=$Tit.create(1,0),$TV.TEMP.identity(),$TM.ctx.drawTarget($TL,$Tf,$Tc,$TJ.width,$TJ.height,$TV.TEMP,"out",$To,null,$TP.TOINT.overlay),$TN=$TJt.create([$TL],$Ti._recycleScope),$TM.addRenderObject($TN),$Tb.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$TJ._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$TJ._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$TJ._uint8ArraySlice),!0},$TJ.onStageResize=function($Tt,$TM){null!=$TJ.mainContext&&($TJ.mainContext.viewport(0,0,$Tt,$TM),$Tet.width=$Tt,$Tet.height=$TM)},$TJ.onInvalidGLRes=function(){$Td.instance.freeAll(),$TX.releaseContentManagers(!0),$TJ.doNodeRepaint($Th.stage),$TJ.mainContext.viewport(0,0,$Tet.width,$Tet.height),$Th.stage.event("devicelost")},$TJ.doNodeRepaint=function($Tt){0==$Tt.numChildren&&$Tt.repaint();for(var $TM=0;$TM<$Tt.numChildren;$TM++)$TJ.doNodeRepaint($Tt.getChildAt($TM))},$TJ.init=function($Tt,$TM,$Tf){$TJ.mainCanvas=$Tt,$TL._createContext=function($Tt){return new $TTt($Tt)},$Tnt._createContext=function($Tt){return new $TTt($Tt)};var $Tc=laya.webgl.WebGL.mainContext;if(null!=$Tc.getShaderPrecisionFormat){var $TD=$Tc.getShaderPrecisionFormat(35633,36338),$To=$Tc.getShaderPrecisionFormat(35632,36338);$TJ.shaderHighPrecision=!(!$TD.precision||!$To.precision)}else $TJ.shaderHighPrecision=!1;if($TJ.compressAstc=$Tc.getExtension("WEBGL_compressed_texture_astc"),$TJ.compressAtc=$Tc.getExtension("WEBGL_compressed_texture_atc"),$TJ.compressEtc=$Tc.getExtension("WEBGL_compressed_texture_etc"),$TJ.compressEtc1=$Tc.getExtension("WEBGL_compressed_texture_etc1"),$TJ.compressPvrtc=$Tc.getExtension("WEBGL_compressed_texture_pvrtc"),$TJ.compressS3tc=$Tc.getExtension("WEBGL_compressed_texture_s3tc"),$TJ.compressS3tc_srgb=$Tc.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$TJ.compressAstc=$TJ.compressAstc?$TJ.compressAstc:{},$TJ.compressAtc=$TJ.compressAtc?$TJ.compressAtc:{},$TJ.compressEtc=$TJ.compressEtc?$TJ.compressEtc:{},$TJ.compressEtc1=$TJ.compressEtc1?$TJ.compressEtc1:{},$TJ.compressPvrtc=$TJ.compressPvrtc?$TJ.compressPvrtc:{},$TJ.compressS3tc=$TJ.compressS3tc?$TJ.compressS3tc:{},$TJ.compressS3tc_srgb=$TJ.compressS3tc_srgb?$TJ.compressS3tc_srgb:{},$Tc.deleteTexture1=$Tc.deleteTexture,$Tc.deleteTexture=function($Tt){$Tt==$Tyt.curBindTexValue&&($Tyt.curBindTexValue=null),$Tc.deleteTexture1($Tt)},$TJ.onStageResize($TM,$Tf),null==$TJ.mainContext)throw new Error("webGL getContext err!");$TH.__init__(),$Td.__init__(),$TCt.__init__(),$Tot.__init__(),$TTt.__init__(),$Tit.__init__(),$Tw.__init__(),$TGt.__int__($Tc),$TP._init_($Tc),$TE.isConchApp&&conch.setOnInvalidGLRes($TJ.onInvalidGLRes)},$TJ.mainCanvas=null,$TJ.antialias=!0,$TJ.shaderHighPrecision=!1,$TJ._bg_null=[0,0,0,0],$TJ}(),$Tyt=function(){function $Tc(){}return $Tb($Tc,"laya.webgl.WebGLContext"),$Tc.UseProgram=function($Tt){return $Tc._useProgram!==$Tt&&($TXt.mainContext.useProgram($Tt),$Tc._useProgram=$Tt,!0)},$Tc.setDepthTest=function($Tt,$TM){$TM!==$Tc._depthTest&&(($Tc._depthTest=$TM)?$Tt.enable(2929):$Tt.disable(2929))},$Tc.setDepthMask=function($Tt,$TM){$TM!==$Tc._depthMask&&($Tc._depthMask=$TM,$Tt.depthMask($TM))},$Tc.setDepthFunc=function($Tt,$TM){$TM!==$Tc._depthFunc&&($Tc._depthFunc=$TM,$Tt.depthFunc($TM))},$Tc.setBlend=function($Tt,$TM){$TM!==$Tc._blend&&(($Tc._blend=$TM)?$Tt.enable(3042):$Tt.disable(3042))},$Tc.setBlendFunc=function($Tt,$TM,$Tf){($TM!==$Tc._sFactor||$Tf!==$Tc._dFactor)&&($Tc._sFactor=$TM,$Tc._dFactor=$Tf,$Tt.blendFunc($TM,$Tf))},$Tc.setCullFace=function($Tt,$TM){$TM!==$Tc._cullFace&&(($Tc._cullFace=$TM)?$Tt.enable(2884):$Tt.disable(2884))},$Tc.setFrontFace=function($Tt,$TM){$TM!==$Tc._frontFace&&($Tc._frontFace=$TM,$Tt.frontFace($TM))},$Tc.bindTexture=function($Tt,$TM,$Tf){$Tt.bindTexture($TM,$Tf),$Tc.curBindTexTarget=$TM,$Tc.curBindTexValue=$Tf},$Tc.DEPTH_BUFFER_BIT=256,$Tc.STENCIL_BUFFER_BIT=1024,$Tc.COLOR_BUFFER_BIT=16384,$Tc.POINTS=0,$Tc.LINES=1,$Tc.LINE_LOOP=2,$Tc.LINE_STRIP=3,$Tc.TRIANGLES=4,$Tc.TRIANGLE_STRIP=5,$Tc.TRIANGLE_FAN=6,$Tc.ZERO=0,$Tc.ONE=1,$Tc.SRC_COLOR=768,$Tc.ONE_MINUS_SRC_COLOR=769,$Tc.SRC_ALPHA=770,$Tc.ONE_MINUS_SRC_ALPHA=771,$Tc.DST_ALPHA=772,$Tc.ONE_MINUS_DST_ALPHA=773,$Tc.DST_COLOR=774,$Tc.ONE_MINUS_DST_COLOR=775,$Tc.SRC_ALPHA_SATURATE=776,$Tc.FUNC_ADD=32774,$Tc.BLEND_EQUATION=32777,$Tc.BLEND_EQUATION_RGB=32777,$Tc.BLEND_EQUATION_ALPHA=34877,$Tc.FUNC_SUBTRACT=32778,$Tc.FUNC_REVERSE_SUBTRACT=32779,$Tc.BLEND_DST_RGB=32968,$Tc.BLEND_SRC_RGB=32969,$Tc.BLEND_DST_ALPHA=32970,$Tc.BLEND_SRC_ALPHA=32971,$Tc.CONSTANT_COLOR=32769,$Tc.ONE_MINUS_CONSTANT_COLOR=32770,$Tc.CONSTANT_ALPHA=32771,$Tc.ONE_MINUS_CONSTANT_ALPHA=32772,$Tc.BLEND_COLOR=32773,$Tc.ARRAY_BUFFER=34962,$Tc.ELEMENT_ARRAY_BUFFER=34963,$Tc.ARRAY_BUFFER_BINDING=34964,$Tc.ELEMENT_ARRAY_BUFFER_BINDING=34965,$Tc.STREAM_DRAW=35040,$Tc.STATIC_DRAW=35044,$Tc.DYNAMIC_DRAW=35048,$Tc.BUFFER_SIZE=34660,$Tc.BUFFER_USAGE=34661,$Tc.CURRENT_VERTEX_ATTRIB=34342,$Tc.FRONT=1028,$Tc.BACK=1029,$Tc.CULL_FACE=2884,$Tc.FRONT_AND_BACK=1032,$Tc.BLEND=3042,$Tc.DITHER=3024,$Tc.STENCIL_TEST=2960,$Tc.DEPTH_TEST=2929,$Tc.SCISSOR_TEST=3089,$Tc.POLYGON_OFFSET_FILL=32823,$Tc.SAMPLE_ALPHA_TO_COVERAGE=32926,$Tc.SAMPLE_COVERAGE=32928,$Tc.NO_ERROR=0,$Tc.INVALID_ENUM=1280,$Tc.INVALID_VALUE=1281,$Tc.INVALID_OPERATION=1282,$Tc.OUT_OF_MEMORY=1285,$Tc.CW=2304,$Tc.CCW=2305,$Tc.LINE_WIDTH=2849,$Tc.ALIASED_POINT_SIZE_RANGE=33901,$Tc.ALIASED_LINE_WIDTH_RANGE=33902,$Tc.CULL_FACE_MODE=2885,$Tc.FRONT_FACE=2886,$Tc.DEPTH_RANGE=2928,$Tc.DEPTH_WRITEMASK=2930,$Tc.DEPTH_CLEAR_VALUE=2931,$Tc.DEPTH_FUNC=2932,$Tc.STENCIL_CLEAR_VALUE=2961,$Tc.STENCIL_FUNC=2962,$Tc.STENCIL_FAIL=2964,$Tc.STENCIL_PASS_DEPTH_FAIL=2965,$Tc.STENCIL_PASS_DEPTH_PASS=2966,$Tc.STENCIL_REF=2967,$Tc.STENCIL_VALUE_MASK=2963,$Tc.STENCIL_WRITEMASK=2968,$Tc.STENCIL_BACK_FUNC=34816,$Tc.STENCIL_BACK_FAIL=34817,$Tc.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$Tc.STENCIL_BACK_PASS_DEPTH_PASS=34819,$Tc.STENCIL_BACK_REF=36003,$Tc.STENCIL_BACK_VALUE_MASK=36004,$Tc.STENCIL_BACK_WRITEMASK=36005,$Tc.VIEWPORT=2978,$Tc.SCISSOR_BOX=3088,$Tc.COLOR_CLEAR_VALUE=3106,$Tc.COLOR_WRITEMASK=3107,$Tc.UNPACK_ALIGNMENT=3317,$Tc.PACK_ALIGNMENT=3333,$Tc.MAX_TEXTURE_SIZE=3379,$Tc.MAX_VIEWPORT_DIMS=3386,$Tc.SUBPIXEL_BITS=3408,$Tc.RED_BITS=3410,$Tc.GREEN_BITS=3411,$Tc.BLUE_BITS=3412,$Tc.ALPHA_BITS=3413,$Tc.DEPTH_BITS=3414,$Tc.STENCIL_BITS=3415,$Tc.POLYGON_OFFSET_UNITS=10752,$Tc.POLYGON_OFFSET_FACTOR=32824,$Tc.TEXTURE_BINDING_2D=32873,$Tc.SAMPLE_BUFFERS=32936,$Tc.SAMPLES=32937,$Tc.SAMPLE_COVERAGE_VALUE=32938,$Tc.SAMPLE_COVERAGE_INVERT=32939,$Tc.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$Tc.COMPRESSED_TEXTURE_FORMATS=34467,$Tc.DONT_CARE=4352,$Tc.FASTEST=4353,$Tc.NICEST=4354,$Tc.GENERATE_MIPMAP_HINT=33170,$Tc.BYTE=5120,$Tc.UNSIGNED_BYTE=5121,$Tc.SHORT=5122,$Tc.UNSIGNED_SHORT=5123,$Tc.INT=5124,$Tc.UNSIGNED_INT=5125,$Tc.FLOAT=5126,$Tc.DEPTH_COMPONENT=6402,$Tc.ALPHA=6406,$Tc.RGB=6407,$Tc.RGBA=6408,$Tc.LUMINANCE=6409,$Tc.LUMINANCE_ALPHA=6410,$Tc.UNSIGNED_SHORT_4_4_4_4=32819,$Tc.UNSIGNED_SHORT_5_5_5_1=32820,$Tc.UNSIGNED_SHORT_5_6_5=33635,$Tc.FRAGMENT_SHADER=35632,$Tc.VERTEX_SHADER=35633,$Tc.MAX_VERTEX_ATTRIBS=34921,$Tc.MAX_VERTEX_UNIFORM_VECTORS=36347,$Tc.MAX_VARYING_VECTORS=36348,$Tc.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$Tc.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$Tc.MAX_TEXTURE_IMAGE_UNITS=34930,$Tc.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$Tc.SHADER_TYPE=35663,$Tc.DELETE_STATUS=35712,$Tc.LINK_STATUS=35714,$Tc.VALIDATE_STATUS=35715,$Tc.ATTACHED_SHADERS=35717,$Tc.ACTIVE_UNIFORMS=35718,$Tc.ACTIVE_ATTRIBUTES=35721,$Tc.SHADING_LANGUAGE_VERSION=35724,$Tc.CURRENT_PROGRAM=35725,$Tc.NEVER=512,$Tc.LESS=513,$Tc.EQUAL=514,$Tc.LEQUAL=515,$Tc.GREATER=516,$Tc.NOTEQUAL=517,$Tc.GEQUAL=518,$Tc.ALWAYS=519,$Tc.KEEP=7680,$Tc.REPLACE=7681,$Tc.INCR=7682,$Tc.DECR=7683,$Tc.INVERT=5386,$Tc.INCR_WRAP=34055,$Tc.DECR_WRAP=34056,$Tc.VENDOR=7936,$Tc.RENDERER=7937,$Tc.VERSION=7938,$Tc.NEAREST=9728,$Tc.LINEAR=9729,$Tc.NEAREST_MIPMAP_NEAREST=9984,$Tc.LINEAR_MIPMAP_NEAREST=9985,$Tc.NEAREST_MIPMAP_LINEAR=9986,$Tc.LINEAR_MIPMAP_LINEAR=9987,$Tc.TEXTURE_MAG_FILTER=10240,$Tc.TEXTURE_MIN_FILTER=10241,$Tc.TEXTURE_WRAP_S=10242,$Tc.TEXTURE_WRAP_T=10243,$Tc.TEXTURE_2D=3553,$Tc.TEXTURE=5890,$Tc.TEXTURE_CUBE_MAP=34067,$Tc.TEXTURE_BINDING_CUBE_MAP=34068,$Tc.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$Tc.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$Tc.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$Tc.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$Tc.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$Tc.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$Tc.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$Tc.TEXTURE0=33984,$Tc.TEXTURE1=33985,$Tc.TEXTURE2=33986,$Tc.TEXTURE3=33987,$Tc.TEXTURE4=33988,$Tc.TEXTURE5=33989,$Tc.TEXTURE6=33990,$Tc.TEXTURE7=33991,$Tc.TEXTURE8=33992,$Tc.TEXTURE9=33993,$Tc.TEXTURE10=33994,$Tc.TEXTURE11=33995,$Tc.TEXTURE12=33996,$Tc.TEXTURE13=33997,$Tc.TEXTURE14=33998,$Tc.TEXTURE15=33999,$Tc.TEXTURE16=34e3,$Tc.TEXTURE17=34001,$Tc.TEXTURE18=34002,$Tc.TEXTURE19=34003,$Tc.TEXTURE20=34004,$Tc.TEXTURE21=34005,$Tc.TEXTURE22=34006,$Tc.TEXTURE23=34007,$Tc.TEXTURE24=34008,$Tc.TEXTURE25=34009,$Tc.TEXTURE26=34010,$Tc.TEXTURE27=34011,$Tc.TEXTURE28=34012,$Tc.TEXTURE29=34013,$Tc.TEXTURE30=34014,$Tc.TEXTURE31=34015,$Tc.ACTIVE_TEXTURE=34016,$Tc.REPEAT=10497,$Tc.CLAMP_TO_EDGE=33071,$Tc.MIRRORED_REPEAT=33648,$Tc.FLOAT_VEC2=35664,$Tc.FLOAT_VEC3=35665,$Tc.FLOAT_VEC4=35666,$Tc.INT_VEC2=35667,$Tc.INT_VEC3=35668,$Tc.INT_VEC4=35669,$Tc.BOOL=35670,$Tc.BOOL_VEC2=35671,$Tc.BOOL_VEC3=35672,$Tc.BOOL_VEC4=35673,$Tc.FLOAT_MAT2=35674,$Tc.FLOAT_MAT3=35675,$Tc.FLOAT_MAT4=35676,$Tc.SAMPLER_2D=35678,$Tc.SAMPLER_CUBE=35680,$Tc.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$Tc.VERTEX_ATTRIB_ARRAY_SIZE=34339,$Tc.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$Tc.VERTEX_ATTRIB_ARRAY_TYPE=34341,$Tc.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$Tc.VERTEX_ATTRIB_ARRAY_POINTER=34373,$Tc.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$Tc.COMPILE_STATUS=35713,$Tc.LOW_FLOAT=36336,$Tc.MEDIUM_FLOAT=36337,$Tc.HIGH_FLOAT=36338,$Tc.LOW_INT=36339,$Tc.MEDIUM_INT=36340,$Tc.HIGH_INT=36341,$Tc.FRAMEBUFFER=36160,$Tc.RENDERBUFFER=36161,$Tc.RGBA4=32854,$Tc.RGB5_A1=32855,$Tc.RGB565=36194,$Tc.DEPTH_COMPONENT16=33189,$Tc.STENCIL_INDEX=6401,$Tc.STENCIL_INDEX8=36168,$Tc.DEPTH_STENCIL=34041,$Tc.RENDERBUFFER_WIDTH=36162,$Tc.RENDERBUFFER_HEIGHT=36163,$Tc.RENDERBUFFER_INTERNAL_FORMAT=36164,$Tc.RENDERBUFFER_RED_SIZE=36176,$Tc.RENDERBUFFER_GREEN_SIZE=36177,$Tc.RENDERBUFFER_BLUE_SIZE=36178,$Tc.RENDERBUFFER_ALPHA_SIZE=36179,$Tc.RENDERBUFFER_DEPTH_SIZE=36180,$Tc.RENDERBUFFER_STENCIL_SIZE=36181,$Tc.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$Tc.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$Tc.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$Tc.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$Tc.COLOR_ATTACHMENT0=36064,$Tc.DEPTH_ATTACHMENT=36096,$Tc.STENCIL_ATTACHMENT=36128,$Tc.DEPTH_STENCIL_ATTACHMENT=33306,$Tc.NONE=0,$Tc.FRAMEBUFFER_COMPLETE=36053,$Tc.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$Tc.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$Tc.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$Tc.FRAMEBUFFER_UNSUPPORTED=36061,$Tc.FRAMEBUFFER_BINDING=36006,$Tc.RENDERBUFFER_BINDING=36007,$Tc.MAX_RENDERBUFFER_SIZE=34024,$Tc.INVALID_FRAMEBUFFER_OPERATION=1286,$Tc.UNPACK_FLIP_Y_WEBGL=37440,$Tc.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$Tc.CONTEXT_LOST_WEBGL=37442,$Tc.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$Tc.BROWSER_DEFAULT_WEBGL=37444,$Tc._useProgram=null,$Tc._depthTest=!0,$Tc._depthMask=!0,$Tc._blend=!1,$Tc._cullFace=!1,$Tc.curBindTexTarget=null,$Tc.curBindTexValue=null,$TJ($Tc,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$Tc}(),$Tht=function($Tt){function $TM(){$TM.__super.call(this)}$Tb($TM,"laya.webgl.display.GraphicsGL",$TZ);var $Tf=$TM.prototype;return $Tf.setShader=function($Tt){this._saveToCmd($TE.context._setShader,[$Tt])},$Tf.setIBVB=function($Tt,$TM,$Tf,$Tc,$TD,$To){this._saveToCmd($TE.context._setIBVB,[$Tt,$TM,$Tf,$Tc,$TD,$To])},$Tf.drawParticle=function($Tt,$TM,$Tf){var $Tc=$Ty.createParticleTemplate2D($Tf);$Tc.x=$Tt,$Tc.y=$TM,this._saveToCmd($TE.context._drawParticle,[$Tc])},$TM}(),$TTt=function($Tt){var $Tf;function $Tj($Tt){this._x=0,this._y=0,this._id=++$Tj._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$Tj.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$Tj.MAXCLIPRECT,this.mOutPoint,this._canvas=$Tt,this._canvas._addReference(),$Tj._contextcount++,$TE.isFlash?(this._ib=$Twt.create(35044),$T_t.fillIBQuadrangle(this._ib,16)):this._ib=$Twt.QuadrangleIB,this.clear()}$Tb($Tj,"laya.webgl.canvas.WebGLContext2D",$TD);var $TM=$Tj.prototype;return $TM.setIsMainContext=function(){this._isMain=!0},$TM.clearBG=function($Tt,$TM,$Tf,$Tc){var $TD=$TXt.mainContext;$TD.clearColor($Tt,$TM,$Tf,$Tc),$TD.clear(16384)},$TM._getSubmits=function(){return this._submits},$TM._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $Tt=0,$TM=this._submits._length;$Tt<$TM;$Tt++)this._submits[$Tt].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$TM.destroy=function(){--$Tj._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$Twt.QuadrangleIB&&this._ib.releaseResource()},$TM.clear=function(){this._submits||(this._other=$Tf.DEFAULT,this._curMat=$TV.create(),this._vb=$TWt.create(-1),this._submits=[],this._save=[$Tm.Create(this)],this._save.length=10,this._shader2D=new $Tw,this._triangleMesh=$Trt.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$Tf.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$Tj.MAXCLIPRECT,this._curSubmit=$Tot.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$TY.DEFAULT;for(var $Tt=0,$TM=this._submits._length;$Tt<$TM;$Tt++)this._submits[$Tt].releaseRender(),this._submits[$Tt]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$TM.size=function($Tt,$TM){if(this._width!=$Tt||this._height!=$TM)if(0==$Tt||0==$TM){0!=this._vb._byteLength&&(this._width=$Tt,this._height=$TM,this._vb.clear(),this._vb.upload());for(var $Tf=0,$Tc=this._submits._length;$Tf<$Tc;$Tf++)this._submits[$Tf].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$Tt,this._height=$TM,this._targets&&this._targets.size($Tt,$TM),this._canvas.memorySize-=this._canvas.memorySize;0===$Tt&&0===$TM&&this._releaseMem()},$TM._getTransformMatrix=function(){return this._curMat},$TM.translate=function($Tt,$TM){0===$Tt&&0===$TM||($Ta.save(this),this._curMat.bTransform&&($TG.save(this),this._curMat.transformPointN($Tx.TEMP.setTo($Tt,$TM)),$Tt=$Tx.TEMP.x,$TM=$Tx.TEMP.y),this._x+=$Tt,this._y+=$TM)},$TM.save=function(){this._save[this._save._length++]=$Tm.Create(this)},$TM.restore=function(){var $Tt=this._save._length;if(!($Tt<1))for(var $TM=$Tt-1;0<=$TM;$TM--){var $Tf=this._save[$TM];if($Tf.restore(this),$Tf.isSaveMark())return void(this._save._length=$TM)}},$TM._fillText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){void 0===$TL&&($TL=0);var $Tp=this._shader2D,$TB=this._curSubmit.shaderValue,$Tb=$TD?$Tqt.create($TD):this._other.font;if($Td.enabled)$Tp.ALPHA!==$TB.ALPHA&&($Tp.glTexture=null),$TIt.drawText(this,$Tt,$TM,this._curMat,$Tb,$TA||this._other.textAlign,$To,$TJ,$TZ,$Tf,$Tc,$TL);else{this._shader2D.defines.getValue();var $TI=$To?$Tq.create($To)._color:$Tp.colorAdd;$Tp.ALPHA===$TB.ALPHA&&$TI===$Tp.colorAdd&&$TB.colorAdd===$Tp.colorAdd||($Tp.glTexture=null,$Tp.colorAdd=$TI),$TIt.drawText(this,$Tt,$TM,this._curMat,$Tb,$TA||this._other.textAlign,$To,$TJ,$TZ,$Tf,$Tc,$TL)}},$TM.fillWords=function($Tt,$TM,$Tf,$Tc,$TD,$To){this._fillText(null,$Tt,$TM,$Tf,$Tc,$TD,null,-1,null,$To)},$TM.fillBorderWords=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._fillBorderText(null,$Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,null)},$TM.fillText=function($Tt,$TM,$Tf,$Tc,$TD,$To){this._fillText($Tt,null,$TM,$Tf,$Tc,$TD,null,-1,$To)},$TM.strokeText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._fillText($Tt,null,$TM,$Tf,$Tc,null,$TD,$To||1,$TJ)},$TM.fillBorderText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){this._fillBorderText($Tt,null,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ)},$TM._fillBorderText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){if(!$Td.enabled)return this._fillText($Tt,$TM,$Tf,$Tc,$TD,null,$TJ,$TZ||1,$TA),void this._fillText($Tt,$TM,$Tf,$Tc,$TD,$To,null,-1,$TA);var $TL=this._shader2D,$Tp=this._curSubmit.shaderValue;$TL.ALPHA!==$Tp.ALPHA&&($TL.glTexture=null);var $TB=$TD?($Tj._fontTemp.setFont($TD),$Tj._fontTemp):this._other.font;$TIt.drawText(this,$Tt,$TM,this._curMat,$TB,$TA||this._other.textAlign,$To,$TJ,$TZ||1,$Tf,$Tc,0)},$TM.fillRect=function($Tt,$TM,$Tf,$Tc,$TD){var $To=this._vb;if($T_t.fillRectImgVb($To,this._clipRect,$Tt,$TM,$Tf,$Tc,$Tr.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $TJ=this._shader2D.fillStyle;$TD&&(this._shader2D.fillStyle=$TY.create($TD));var $TZ=this._shader2D,$TA=this._curSubmit.shaderValue;if($TZ.fillStyle!==$TA.fillStyle||$TZ.ALPHA!==$TA.ALPHA){$TZ.glTexture=null;var $TL=this._curSubmit=$Tot.createSubmit(this,this._ib,$To,($To._byteLength-64)/32*3,$Tit.create(2,0));$TL.shaderValue.color=$TZ.fillStyle._color._color,$TL.shaderValue.ALPHA=$TZ.ALPHA,this._submits[this._submits._length++]=$TL}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$TJ}},$TM.fillTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){if($Tt.loaded&&$Tt.bitmap&&$Tt.source){var $TA=this._vb,$TL=$Tt.bitmap.width,$Tp=$Tt.bitmap.height,$TB=$Tt.uv,$Tb=$TJ.x%$Tt.width,$TI=$TJ.y%$Tt.height;if($TL!=$TZ.w||$Tp!=$TZ.h){if(!$TZ.w&&!$TZ.h)switch($TZ.oy=$TZ.ox=0,$To){case"repeat":$TZ.width=$Tc,$TZ.height=$TD;break;case"repeat-x":$TZ.width=$Tc,$TI<0?$Tt.height+$TI>$TD?$TZ.height=$TD:$TZ.height=$Tt.height+$TI:($TZ.oy=$TI,$Tt.height+$TI>$TD?$TZ.height=$TD-$TI:$TZ.height=$Tt.height);break;case"repeat-y":$Tb<0?$Tt.width+$Tb>$Tc?$TZ.width=$Tc:$TZ.width=$Tt.width+$Tb:($TZ.ox=$Tb,$Tt.width+$Tb>$Tc?$TZ.width=$Tc-$Tb:$TZ.width=$Tt.width),$TZ.height=$TD;break;case"no-repeat":$Tb<0?$Tt.width+$Tb>$Tc?$TZ.width=$Tc:$TZ.width=$Tt.width+$Tb:($TZ.ox=$Tb,$Tt.width+$Tb>$Tc?$TZ.width=$Tc-$Tb:$TZ.width=$Tt.width),$TI<0?$Tt.height+$TI>$TD?$TZ.height=$TD:$TZ.height=$Tt.height+$TI:($TZ.oy=$TI,$Tt.height+$TI>$TD?$TZ.height=$TD-$TI:$TZ.height=$Tt.height);break;default:$TZ.width=$Tc,$TZ.height=$TD}$TZ.w=$TL,$TZ.h=$Tp,$TZ.uv=[0,0,$TZ.width/$TL,0,$TZ.width/$TL,$TZ.height/$Tp,0,$TZ.height/$Tp]}if($TM+=$TZ.ox,$Tf+=$TZ.oy,$Tb-=$TZ.ox,$TI-=$TZ.oy,$T_t.fillRectImgVb($TA,this._clipRect,$TM,$Tf,$TZ.width,$TZ.height,$TZ.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $Tq=$Tst.create(this,this._ib,$TA,($TA._byteLength-64)/32*3,$Tit.create(256,0)),$Tl=(this._submits[this._submits._length++]=$Tq).shaderValue;$Tl.textureHost=$Tt;var $T_=$TB[0]*$TL,$TE=$TB[1]*$Tp,$Te=($TB[2]-$TB[0])*$TL,$TN=($TB[5]-$TB[3])*$Tp,$TX=-$Tb/$TL,$Ty=-$TI/$Tp;$Tl.u_TexRange[0]=$T_/$TL,$Tl.u_TexRange[1]=$Te/$TL,$Tl.u_TexRange[2]=$TE/$Tp,$Tl.u_TexRange[3]=$TN/$Tp,$Tl.u_offset[0]=$TX,$Tl.u_offset[1]=$Ty,$Td.enabled&&!this._isMain&&$Tq.addTexture($Tt,($TA._byteLength>>2)-16),(this._curSubmit=$Tq)._renderType=10017,$Tq._numEle+=6}}else this.sprite&&$Th.timer.callLater(this,this._repaintSprite)},$TM.setShader=function($Tt){$TR.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$Tt},$TM.setFilters=function($Tt){$TR.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$Tt,this._curSubmit=$Tot.RENDERBASE,this._renderKey=0,this._drawCount++},$TM.drawTexture=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._drawTextureM($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,null,1)},$TM.addTextureVb=function($Tt,$TM,$Tf){var $Tc=this._curSubmit._vb||this._vb,$TD=$Tc._byteLength>>2;$Tc.byteLength=$TD+16<<2;for(var $To=$Tc.getFloat32Array(),$TJ=0;$TJ<16;$TJ+=4)$To[$TD++]=$Tt[$TJ]+$TM,$To[$TD++]=$Tt[$TJ+1]+$Tf,$To[$TD++]=$Tt[$TJ+2],$To[$TD++]=$Tt[$TJ+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$Tc._upload=!0},$TM.willDrawTexture=function($Tt,$TM){if(!($Tt.loaded&&$Tt.bitmap&&$Tt.source))return this.sprite&&$Th.timer.callLater(this,this._repaintSprite),0;var $Tf=$Tt.bitmap,$Tc=$Tf.id+this._shader2D.ALPHA*$TM+10016;if($Tc==this._renderKey)return $Tc;var $TD=this._shader2D,$To=$TD.ALPHA,$TJ=this._curSubmit.shaderValue;$TD.ALPHA*=$TM,this._renderKey=$Tc,this._drawCount++,$TD.glTexture=$Tf;var $TZ=this._vb,$TA=null,$TL=$TZ._byteLength/32*3,$Tp=$TJ.textureHost&&$TJ.textureHost==$Tt&&$TJ.textureHost.alphaTexture==$Tt.alphaTexture;return $TA=$Tst.create(this,this._ib,$TZ,$TL,$Tit.create(1,0)),(this._submits[this._submits._length++]=$TA).shaderValue.textureHost=$Tt,$TA._renderType=10016,$TA._preIsSameTextureShader=10016===this._curSubmit._renderType&&$TD.ALPHA===$TJ.ALPHA&&$Tp,this._curSubmit=$TA,$TD.ALPHA=$To,$Tc},$TM.drawTextures=function($Tt,$TM,$Tf,$Tc){if($Tt.loaded&&$Tt.bitmap&&$Tt.source){var $TD=this._clipRect;if(this._clipRect=$Tj.MAXCLIPRECT,this._drawTextureM($Tt,$TM[0],$TM[1],$Tt.width,$Tt.height,$Tf,$Tc,null,1)){if(this._clipRect=$TD,$TF.drawCall++,!($TM.length<4)){for(var $To=this._curSubmit._vb||this._vb,$TJ=this._curMat.a,$TZ=this._curMat.d,$TA=2,$TL=$TM.length;$TA<$TL;$TA+=2)$T_t.copyPreImgVb($To,($TM[$TA]-$TM[$TA-2])*$TJ,($TM[$TA+1]-$TM[$TA-1])*$TZ),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$Th.timer.callLater(this,this._repaintSprite)},$TM._drawTextureM=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){if(!$Tt.loaded||!$Tt.source)return this.sprite&&$Th.timer.callLater(this,this._repaintSprite),!1;var $TL=this._curSubmit._vb||this._vb,$Tp=$Tt.bitmap;$TM+=$To,$Tf+=$TJ,this._drawCount++;var $TB=$Tp.id+this._shader2D.ALPHA*$TA+10016;if($TB!=this._renderKey){this._renderKey=$TB;var $Tb=this._curSubmit.shaderValue,$TI=this._shader2D,$Tq=$TI.ALPHA;$TI.ALPHA*=$TA,$TI.glTexture=$Tp;var $Tl=this._vb,$T_=null,$TE=$Tl._byteLength/32*3,$Te=$Tb.textureHost&&$Tb.textureHost==$Tt&&$Tb.textureHost.alphaTexture==$Tt.alphaTexture;$T_=$Tst.create(this,this._ib,$Tl,$TE,$Tit.create(1,0)),(this._submits[this._submits._length++]=$T_).shaderValue.textureHost=$Tt,$T_._renderType=10016,$T_._preIsSameTextureShader=10016===this._curSubmit._renderType&&$TI.ALPHA===$Tb.ALPHA&&$Te,this._curSubmit=$T_,$TL=this._curSubmit._vb||this._vb,$TI.ALPHA=$Tq}return!!$T_t.fillRectImgVb($TL,this._clipRect,$TM,$Tf,$Tc||$Tt.width,$TD||$Tt.height,$Tt.uv,$TZ||this._curMat,this._x,this._y,0,0)&&($Td.enabled&&!this._isMain&&this._curSubmit.addTexture($Tt,($TL._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$TM._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$TM._drawText=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){var $Tp=$Tt.bitmap;this._drawCount++;var $TB=$Tp.id+this._shader2D.ALPHA+10016;if($TB!=this._renderKey){this._renderKey=$TB;var $Tb=this._curSubmit.shaderValue,$TI=this._shader2D;$TI.glTexture=$Tp;var $Tq=this._vb,$Tl=null,$T_=$Tq._byteLength/32*3,$TE=$Tb.textureHost&&$Tb.textureHost==$Tt&&$Tb.textureHost.alphaTexture==$Tt.alphaTexture;($Tl=$Td.enabled?$Tst.create(this,this._ib,$Tq,$T_,$Tit.create(1,0)):$Tst.create(this,this._ib,$Tq,$T_,$Tat.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$TI.ALPHA===$Tb.ALPHA&&$TE,(this._submits[this._submits._length++]=$Tl).shaderValue.textureHost=$Tt,$Tl._renderType=10016,this._curSubmit=$Tl}$Tt.active();var $Te=this._curSubmit._vb||this._vb;$T_t.fillRectImgVb($Te,this._clipRect,$TM+$TJ,$Tf+$TZ,$Tc||$Tt.width,$TD||$Tt.height,$Tt.uv,$To||this._curMat,this._x,this._y,$TA,$TL,!0)&&($Td.enabled&&!this._isMain&&this._curSubmit.addTexture($Tt,($Te._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$TM.drawTextureWithTransform=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){if($To){var $TL=this._curMat,$Tp=this._x,$TB=this._y;(0!==$TJ||0!==$TZ)&&(this._x=$TJ*$TL.a+$TZ*$TL.c,this._y=$TZ*$TL.d+$TJ*$TL.b),$To&&$TL.bTransform?($TV.mul($To,$TL,$Tj._tmpMatrix),($To=$Tj._tmpMatrix)._checkTransform()):(this._x+=$TL.tx,this._y+=$TL.ty),this._drawTextureM($Tt,$TM,$Tf,$Tc,$TD,0,0,$To,$TA),this._x=$Tp,this._y=$TB}else this._drawTextureM($Tt,$TM,$Tf,$Tc,$TD,$TJ,$TZ,null,$TA)},$TM.fillQuadrangle=function($Tt,$TM,$Tf,$Tc,$TD){var $To=this._curSubmit,$TJ=this._vb,$TZ=this._shader2D,$TA=$To.shaderValue;if(this._renderKey=0,$Tt.bitmap){var $TL=$Tt.bitmap;$TZ.glTexture==$TL&&$TZ.ALPHA===$TA.ALPHA||($TZ.glTexture=$TL,($To=this._curSubmit=$Tot.createSubmit(this,this._ib,$TJ,$TJ._byteLength/32*3,$Tit.create(1,0))).shaderValue.glTexture=$TL,this._submits[this._submits._length++]=$To),$T_t.fillQuadrangleImgVb($TJ,$TM,$Tf,$Tc,$Tt.uv,$TD||this._curMat,this._x,this._y)}else $To.shaderValue.fillStyle&&$To.shaderValue.fillStyle.equal($Tt)&&$TZ.ALPHA===$TA.ALPHA||($TZ.glTexture=null,($To=this._curSubmit=$Tot.createSubmit(this,this._ib,$TJ,$TJ._byteLength/32*3,$Tit.create(2,0))).shaderValue.defines.add(2),$To.shaderValue.fillStyle=$TY.create($Tt),this._submits[this._submits._length++]=$To),$T_t.fillQuadrangleImgVb($TJ,$TM,$Tf,$Tc,$Tr.DEF_UV,$TD||this._curMat,this._x,this._y);$To._numEle+=6},$TM.drawTexture2=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){if(0!=$To){var $TA=this._curMat;if(this._x=$Tt*$TA.a+$TM*$TA.c,this._y=$TM*$TA.d+$Tt*$TA.b,$TD&&($TD=$TA.bTransform||$TD.bTransform?($TV.mul($TD,$TA,$Tj._tmpMatrix),$Tj._tmpMatrix):(this._x+=$TD.tx+$TA.tx,this._y+=$TD.ty+$TA.ty,$TV.EMPTY)),1!==$To||$TJ){var $TL=this._shader2D.ALPHA,$Tp=this._nBlendType;this._shader2D.ALPHA=$To,$TJ&&(this._nBlendType=$TP.TOINT($TJ)),this._drawTextureM($TZ[0],$TZ[1]-$Tf,$TZ[2]-$Tc,$TZ[3],$TZ[4],0,0,$TD,1),this._shader2D.ALPHA=$TL,this._nBlendType=$Tp}else this._drawTextureM($TZ[0],$TZ[1]-$Tf,$TZ[2]-$Tc,$TZ[3],$TZ[4],0,0,$TD,1);this._x=this._y=0}},$TM.drawCanvas=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tt.context;if(this._renderKey=0,$To._targets)this._submits[this._submits._length++]=$THt.create($To,0,null),this._curSubmit=$Tot.RENDERBASE,$To._targets.drawTo(this,$TM,$Tf,$Tc,$TD);else{var $TJ=this._submits[this._submits._length++]=$THt.create($To,this._shader2D.ALPHA,this._shader2D.filters),$TZ=$Tc/$Tt.width,$TA=$TD/$Tt.height,$TL=$TJ._matrix;this._curMat.copyTo($TL),1!=$TZ&&1!=$TA&&$TL.scale($TZ,$TA);var $Tp=$TL.tx,$TB=$TL.ty;$TL.tx=$TL.ty=0,$TL.transformPoint($Tx.TEMP.setTo($TM,$Tf)),$TL.translate($Tx.TEMP.x+$Tp,$Tx.TEMP.y+$TB),this._curSubmit=$Tot.RENDERBASE}$TT.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$To._targets?"yellow":"green",this.strokeRect($TM-1,$Tf-1,$Tc+2,$TD+2,1),this.strokeRect($TM,$Tf,$Tc,$TD,1),this.restore())},$TM.drawTarget=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){void 0===$TL&&($TL=-1);var $Tp=this._vb;if($T_t.fillRectImgVb($Tp,this._clipRect,$TM,$Tf,$Tc,$TD,$TA||$Tr.DEF_UV,$To||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $TB=this._curSubmit=$TBt.create(this,this._ib,$Tp,($Tp._byteLength-64)/32*3,$TZ,$TJ);$TB.blendType=-1==$TL?this._nBlendType:$TL,$TB.scope=$Tt,this._submits[this._submits._length++]=$TB,this._curSubmit._numEle+=6}},$TM.mixRGBandAlpha=function($Tt){return this._mixRGBandAlpha($Tt,this._shader2D.ALPHA)},$TM._mixRGBandAlpha=function($Tt,$TM){var $Tf=(4278190080&$Tt)>>>24;return 0!=$Tf?$Tf*=$TM:$Tf=255*$TM,16777215&$Tt|$Tf<<24},$TM.drawTriangles=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){if(!$Tt.loaded||!$Tt.source)return this.sprite&&$Th.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$Tt.bitmap;var $Tp=this._mixRGBandAlpha(4294967295,$TZ),$TB=($Tc.length,$To.length);this._renderKey=-1;var $Tb=this._curSubmit=$Tst.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$Tit.create(1,0));return $Tb.shaderValue.textureHost=$Tt,$Tb._renderType=10016,this._submits[this._submits._length++]=$Tb,$TJ?($Tj._tmpMatrix.a=$TJ.a,$Tj._tmpMatrix.b=$TJ.b,$Tj._tmpMatrix.c=$TJ.c,$Tj._tmpMatrix.d=$TJ.d,$Tj._tmpMatrix.tx=$TJ.tx+$TM,$Tj._tmpMatrix.ty=$TJ.ty+$Tf,$TV.mul($Tj._tmpMatrix,this._curMat,$Tj._tmpMatrix)):($Tj._tmpMatrix.a=this._curMat.a,$Tj._tmpMatrix.b=this._curMat.b,$Tj._tmpMatrix.c=this._curMat.c,$Tj._tmpMatrix.d=this._curMat.d,$Tj._tmpMatrix.tx=this._curMat.tx+$TM,$Tj._tmpMatrix.ty=this._curMat.ty+$Tf),this._triangleMesh.addData($Tc,$TD,$To,$Tj._tmpMatrix,$Tp,this),this._curSubmit._numEle+=$TB,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$TM.transform=function($Tt,$TM,$Tf,$Tc,$TD,$To){$TG.save(this),$TV.mul($TV.TEMP.setTo($Tt,$TM,$Tf,$Tc,$TD,$To),this._curMat,this._curMat),this._curMat._checkTransform()},$TM.setTransformByMatrix=function($Tt){$Tt.copyTo(this._curMat)},$TM.transformByMatrix=function($Tt){$TG.save(this),$TV.mul($Tt,this._curMat,this._curMat),this._curMat._checkTransform()},$TM.rotate=function($Tt){$TG.save(this),this._curMat.rotateEx($Tt)},$TM.scale=function($Tt,$TM){$TG.save(this),this._curMat.scaleEx($Tt,$TM)},$TM.clipRect=function($Tt,$TM,$Tf,$Tc){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $TD=$Tpt.create(4);this.addRenderObject($TD);var $To=this._vb,$TJ=$To._byteLength>>2;if($T_t.fillRectImgVb($To,null,$Tt,$TM,$Tf,$Tc,$Tr.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $TZ=this._curSubmit=$Tot.createSubmit(this,this._ib,$To,($To._byteLength-64)/32*3,$Tit.create(2,0));$TZ.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$TZ,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $TA=$Tpt.create(5);this.addRenderObject($TA);var $TL=$To.getFloat32Array(),$Tp=Math.min(Math.min(Math.min($TL[0+$TJ],$TL[4+$TJ]),$TL[8+$TJ]),$TL[12+$TJ]),$TB=Math.max(Math.max(Math.max($TL[0+$TJ],$TL[4+$TJ]),$TL[8+$TJ]),$TL[12+$TJ]),$Tb=Math.min(Math.min(Math.min($TL[1+$TJ],$TL[5+$TJ]),$TL[9+$TJ]),$TL[13+$TJ]),$TI=Math.max(Math.max(Math.max($TL[1+$TJ],$TL[5+$TJ]),$TL[9+$TJ]),$TL[13+$TJ]);$Tz.save(this,$TA,$Tt,$TM,$Tf,$Tc,$Tp,$Tb,$TB-$Tp,$TI-$Tb),this._curSubmit=$Tot.RENDERBASE}else{$Tf*=this._curMat.a,$Tc*=this._curMat.d;var $Tq=$Tx.TEMP;this._curMat.transformPoint($Tq.setTo($Tt,$TM)),$Tf<0&&($Tq.x=$Tq.x+$Tf,$Tf=-$Tf),$Tc<0&&($Tq.y=$Tq.y+$Tc,$Tc=-$Tc),this._renderKey=0;var $Tl=this._curSubmit=$TLt.create(this);(this._submits[this._submits._length++]=$Tl).submitIndex=this._submits._length,$Tl.submitLength=9999999,$Tg.save(this,$Tl);var $T_=this._clipRect,$TE=$T_.x,$Te=$T_.y,$TN=$Tq.x+$Tf,$TX=$Tq.y+$Tc;$TE<$Tq.x&&($T_.x=$Tq.x),$Te<$Tq.y&&($T_.y=$Tq.y),$T_.width=Math.min($TN,$TE+$T_.width)-$T_.x,$T_.height=Math.min($TX,$Te+$T_.height)-$T_.y,this._shader2D.glTexture=null,$Tl.clipRect.copyFrom($T_),this._curSubmit=$Tot.RENDERBASE}},$TM.setIBVB=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp){if(void 0===$TA&&($TA=0),void 0===$TL&&($TL=0),void 0===$Tp&&($Tp=0),null===$Tf){if($TE.isFlash){var $TB=$Tc;$TB._selfIB||($TB._selfIB=$Twt.create(35044)),$TB._selfIB.clear(),$Tf=$TB._selfIB}else $Tf=this._ib;$T_t.expandIBQuadrangle($Tf,$Tc._byteLength/(4*$Tc.vertexStride*4))}if(!$TZ||!$TJ)throw Error("setIBVB must input:shader shaderValues");var $Tb=$TAt.create(this,$Tc,$Tf,$TD,$TJ,$TZ,$TA,$TL,$Tp);$To||($To=$TV.EMPTY),$To.translate($Tt,$TM),$TV.mul($To,this._curMat,$Tb._mat),$To.translate(-$Tt,-$TM),this._submits[this._submits._length++]=$Tb,this._curSubmit=$Tot.RENDERBASE,this._renderKey=0},$TM.addRenderObject=function($Tt){this._submits[this._submits._length++]=$Tt},$TM.fillTrangles=function($Tt,$TM,$Tf,$Tc,$TD){var $To=this._curSubmit,$TJ=this._vb,$TZ=this._shader2D,$TA=$To.shaderValue,$TL=$Tc.length>>4,$Tp=$Tt.bitmap;this._renderKey=0,$TZ.glTexture==$Tp&&$TZ.ALPHA===$TA.ALPHA||(($To=this._curSubmit=$Tot.createSubmit(this,this._ib,$TJ,$TJ._byteLength/32*3,$Tit.create(1,0))).shaderValue.textureHost=$Tt,this._submits[this._submits._length++]=$To),$T_t.fillTranglesVB($TJ,$TM,$Tf,$Tc,$TD||this._curMat,this._x,this._y),$To._numEle+=6*$TL},$TM.submitElement=function($Tt,$TM){var $Tf=this._submits;for($TM<0&&($TM=$Tf._length);$Tt<$TM;)$Tt+=$Tf[$Tt].renderSubmit()},$TM.finish=function(){$TXt.mainContext.finish()},$TM.flush=function(){var $Tt=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($Tt>this._ib.bufferLength/12&&$T_t.expandIBQuadrangle(this._ib,$Tt),!this._isMain&&$Td.enabled&&$Td._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$Td._atlasRestore;for(var $TM=this._submits,$Tf=0,$Tc=$TM._length;$Tf<$Tc;$Tf++){var $TD=$TM[$Tf];10016===$TD.getRenderType()&&$TD.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$TMt.instance&&$TMt.getInstance().reset();var $To;for($Tf=0,$To=this.meshlist.length;$Tf<$To;$Tf++){var $TJ=this.meshlist[$Tf];$TJ.canReuse?$TJ.releaseMesh():$TJ.destroy()}return this.meshlist.length=0,this._curSubmit=$Tot.RENDERBASE,this._renderKey=0,this._triangleMesh=$Trt.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$TM.setPathId=function($Tt){if(this.mId=$Tt,-1!=this.mId){this.mHaveKey=!1;var $TM=$Tv.getInstance();$TM.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$TM.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$TM.movePath=function($Tt,$TM){var $Tf=$Tt,$Tc=$TM;$Tt=this._curMat.a*$Tf+this._curMat.c*$Tc+this._curMat.tx,$TM=this._curMat.b*$Tf+this._curMat.d*$Tc+this._curMat.ty,this.mX+=$Tt,this.mY+=$TM},$TM.beginPath=function(){var $Tt=this._getPath();$Tt.tempArray.length=0,$Tt.closePath=!1,this.mX=0,this.mY=0},$TM.closePath=function(){this._path.closePath=!0},$TM.fill=function($Tt){void 0===$Tt&&($Tt=!1);var $TM=this._getPath();this.drawPoly(0,0,$TM.tempArray,this.fillStyle._color.numColor,0,0,$Tt)},$TM.stroke=function(){var $Tt=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$Tt.drawLine(0,0,$Tt.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $TM=$Tv.getInstance().shapeLineDic[this.mId];$TM.rebuild($Tt.tempArray),$Tt.setGeomtry($TM)}else $Tv.getInstance().addLine(this.mId,$Tt.drawLine(0,0,$Tt.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$Tt.update();var $Tf=[this.mX,this.mY],$Tc=$Tot.createShape(this,$Tt.ib,$Tt.vb,$Tt.count,$Tt.offset,$Tit.create(4,0));$Tc.shaderValue.ALPHA=this._shader2D.ALPHA,$Tc.shaderValue.u_pos=$Tf,$Tc.shaderValue.u_mmat2=$Tet.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$Tc,this._renderKey=-1}},$TM.line=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=this._curSubmit,$TZ=this._vb;if($T_t.fillLineVb($TZ,this._clipRect,$Tt,$TM,$Tf,$Tc,$TD,$To)){this._renderKey=0;var $TA=this._shader2D,$TL=$TJ.shaderValue;$TA.strokeStyle===$TL.strokeStyle&&$TA.ALPHA===$TL.ALPHA||($TA.glTexture=null,($TJ=this._curSubmit=$Tot.createSubmit(this,this._ib,$TZ,($TZ._byteLength-64)/32*3,$Tit.create(2,0))).shaderValue.strokeStyle=$TA.strokeStyle,$TJ.shaderValue.mainID=2,$TJ.shaderValue.ALPHA=$TA.ALPHA,this._submits[this._submits._length++]=$TJ),$TJ._numEle+=6}},$TM.moveTo=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=!0);var $Tc=this._getPath();if($Tf){var $TD=$Tt,$To=$TM;$Tt=this._curMat.a*$TD+this._curMat.c*$To,$TM=this._curMat.b*$TD+this._curMat.d*$To}$Tc.addPoint($Tt,$TM)},$TM.lineTo=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=!0);var $Tc=this._getPath();if($Tf){var $TD=$Tt,$To=$TM;$Tt=this._curMat.a*$TD+this._curMat.c*$To,$TM=this._curMat.b*$TD+this._curMat.d*$To}$Tc.addPoint($Tt,$TM)},$TM.drawCurves=function($Tt,$TM,$Tf){this.setPathId(-1),this.beginPath(),this.strokeStyle=$Tf[3],this.lineWidth=$Tf[4];var $Tc=$Tf[2];$Tt+=$Tf[0],$TM+=$Tf[1],this.movePath($Tt,$TM),this.moveTo($Tc[0],$Tc[1]);for(var $TD=2,$To=$Tc.length;$TD<$To;)this.quadraticCurveTo($Tc[$TD++],$Tc[$TD++],$Tc[$TD++],$Tc[$TD++]);this.stroke()},$TM.arcTo=function($Tt,$TM,$Tf,$Tc,$TD){if(-1==this.mId||!this.mHaveKey){var $To=0,$TJ=0,$TZ=0,$TA=this._getPath();this._curMat.copyTo($Tj._tmpMatrix),$Tj._tmpMatrix.tx=$Tj._tmpMatrix.ty=0,$Tj._tempPoint.setTo($TA.getEndPointX(),$TA.getEndPointY()),$Tj._tmpMatrix.invertTransformPoint($Tj._tempPoint);var $TL=$Tj._tempPoint.x-$Tt,$Tp=$Tj._tempPoint.y-$TM,$TB=Math.sqrt($TL*$TL+$Tp*$Tp);if(!($TB<=1e-6)){var $Tb=$TL/$TB,$TI=$Tp/$TB,$Tq=$Tf-$Tt,$Tl=$Tc-$TM,$T_=$Tq*$Tq+$Tl*$Tl,$TE=Math.sqrt($T_);if(!($TE<=1e-6)){var $Te=$Tq/$TE,$TN=$Tl/$TE,$TX=$Tb+$Te,$Ty=$TI+$TN,$Th=Math.sqrt($TX*$TX+$Ty*$Ty);if(!($Th<=1e-6)){var $TT=$TX/$Th,$Ti=$Ty/$Th,$TV=Math.acos($TT*$Tb+$Ti*$TI),$Tx=Math.PI/2-$TV,$TO=($TB=$TD/Math.tan($Tx))*$Tb+$Tt,$TC=$TB*$TI+$TM,$TU=Math.sqrt($TB*$TB+$TD*$TD),$TF=$Tt+$TT*$TU,$TS=$TM+$Ti*$TU,$TH=0,$Ts=0;if(0<=$Tb*$TN-$TI*$Te){var $Tr=2*$Tx/$Tj.SEGNUM;$TH=Math.sin($Tr),$Ts=Math.cos($Tr)}else $Tr=2*-$Tx/$Tj.SEGNUM,$TH=Math.sin($Tr),$Ts=Math.cos($Tr);$TJ=this._curMat.a*$TO+this._curMat.c*$TC,$TZ=this._curMat.b*$TO+this._curMat.d*$TC,$TJ==this._path.getEndPointX()&&$TZ==this._path.getEndPointY()||$TA.addPoint($TJ,$TZ);var $Tu=$TO-$TF,$Tv=$TC-$TS;for($To=0;$To<$Tj.SEGNUM;$To++){var $Tk=$Tu*$Ts+$Tv*$TH,$TK=-$Tu*$TH+$Tv*$Ts;$TJ=$Tk+$TF,$TZ=$TK+$TS,$Tt=this._curMat.a*$TJ+this._curMat.c*$TZ,$TZ=$TM=this._curMat.b*$TJ+this._curMat.d*$TZ,($TJ=$Tt)==this._path.getEndPointX()&&$TZ==this._path.getEndPointY()||$TA.addPoint($TJ,$TZ),$Tu=$Tk,$Tv=$TK}}}}}},$TM.arc=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!0),-1!=this.mId){var $TZ=$Tv.getInstance().shapeDic[this.mId];if($TZ&&this.mHaveKey&&!$TZ.needUpdate(this._curMat))return;$TM=$Tt=0}var $TA,$TL=0,$Tp=0,$TB=0,$Tb=0,$TI=0,$Tq=0,$Tl=0;if($Tp=$TD-$Tc,$To)if(Math.abs($Tp)>=2*Math.PI)$Tp=2*-Math.PI;else for(;0<$Tp;)$Tp-=2*Math.PI;else if(Math.abs($Tp)>=2*Math.PI)$Tp=2*Math.PI;else for(;$Tp<0;)$Tp+=2*Math.PI;$TA=$Tp/($Tl=$Tf<101?Math.max(10,$Tp*$Tf/5):$Tf<201?Math.max(10,$Tp*$Tf/20):Math.max(10,$Tp*$Tf/40))/2,$TB=Math.abs(4/3*(1-Math.cos($TA))/Math.sin($TA)),$To&&($TB=-$TB);var $T_=this._getPath(),$TE=NaN,$Te=NaN;for($Tq=0;$Tq<=$Tl;$Tq++)$TL=$Tc+$Tp*($Tq/$Tl),$Tb=$Tt+Math.cos($TL)*$Tf,$TI=$TM+Math.sin($TL)*$Tf,$TJ&&($TE=$Tb,$Te=$TI,$Tb=this._curMat.a*$TE+this._curMat.c*$Te,$TI=this._curMat.b*$TE+this._curMat.d*$Te),$Tb==this._path.getEndPointX()&&$TI==this._path.getEndPointY()||$T_.addPoint($Tb,$TI);$Tb=$Tt+Math.cos($TD)*$Tf,$TI=$TM+Math.sin($TD)*$Tf,$TJ&&($TE=$Tb,$Te=$TI,$Tb=this._curMat.a*$TE+this._curMat.c*$Te,$TI=this._curMat.b*$TE+this._curMat.d*$Te),$Tb==this._path.getEndPointX()&&$TI==this._path.getEndPointY()||$T_.addPoint($Tb,$TI)},$TM.quadraticCurveTo=function($Tt,$TM,$Tf,$Tc){var $TD=$TB.I,$To=$Tf,$TJ=$Tc;$Tf=this._curMat.a*$To+this._curMat.c*$TJ,$Tc=this._curMat.b*$To+this._curMat.d*$TJ,$To=$Tt,$TJ=$TM,$Tt=this._curMat.a*$To+this._curMat.c*$TJ,$TM=this._curMat.b*$To+this._curMat.d*$TJ;for(var $TZ=$TD.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$Tt,$TM,$Tf,$Tc],30,2),$TA=0,$TL=$TZ.length/2;$TA<$TL;$TA++)this.lineTo($TZ[2*$TA],$TZ[2*$TA+1],!1);this.lineTo($Tf,$Tc,!1)},$TM.rect=function($Tt,$TM,$Tf,$Tc){this._other=this._other.make(),this._other.path||(this._other.path=new $Tn),this._other.path.rect($Tt,$TM,$Tf,$Tc)},$TM.strokeRect=function($Tt,$TM,$Tf,$Tc,$TD){var $To=.5*$TD;this.line($Tt-$To,$TM,$Tt+$Tf+$To,$TM,$TD,this._curMat),this.line($Tt+$Tf,$TM,$Tt+$Tf,$TM+$Tc,$TD,this._curMat),this.line($Tt,$TM,$Tt,$TM+$Tc,$TD,this._curMat),this.line($Tt-$To,$TM+$Tc,$Tt+$Tf+$To,$TM+$Tc,$TD,this._curMat)},$TM.clip=function(){},$TM.drawPoly=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){void 0===$TJ&&($TJ=!1),this._renderKey=0,this._shader2D.glTexture=null;var $TZ=this._getPath();if(-1==this.mId)$TZ.polygon($Tt,$TM,$Tf,$Tc,$TD||1,$To);else if(this.mHaveKey){var $TA=$Tv.getInstance().shapeDic[this.mId];$TA.setMatrix(this._curMat),$TA.rebuild($TZ.tempArray),$TZ.setGeomtry($TA)}else{var $TL=$TZ.polygon($Tt,$TM,$Tf,$Tc,$TD||1,$To);$Tv.getInstance().addShape(this.mId,$TL),$TL.setMatrix(this._curMat)}$TZ.update();var $Tp,$TB=[this.mX,this.mY];if(($Tp=$Tot.createShape(this,$TZ.ib,$TZ.vb,$TZ.count,$TZ.offset,$Tit.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Tp.shaderValue.u_pos=$TB,$Tp.shaderValue.u_mmat2=$Tet.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Tp,0<$TD){if(this.mHaveLineKey){var $Tb=$Tv.getInstance().shapeLineDic[this.mId];$Tb.rebuild($TZ.tempArray),$TZ.setGeomtry($Tb)}else $Tv.getInstance().addShape(this.mId,$TZ.drawLine($Tt,$TM,$Tf,$TD,$To));$TZ.update(),($Tp=$Tot.createShape(this,$TZ.ib,$TZ.vb,$TZ.count,$TZ.offset,$Tit.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Tp.shaderValue.u_mmat2=$Tet.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Tp}},$TM.drawParticle=function($Tt,$TM,$Tf){$Tf.x=$Tt,$Tf.y=$TM,this._submits[this._submits._length++]=$Tf},$TM._getPath=function(){return this._path||(this._path=new $Tn)},$Tc(0,$TM,"globalCompositeOperation",function(){return $TP.NAMES[this._nBlendType]},function($Tt){var $TM=$TP.TOINT[$Tt];null==$TM||this._nBlendType===$TM||($TR.save(this,65536,this,!0),this._curSubmit=$Tot.RENDERBASE,this._renderKey=0,this._nBlendType=$TM)}),$Tc(0,$TM,"strokeStyle",function(){return this._shader2D.strokeStyle},function($Tt){this._shader2D.strokeStyle.equal($Tt)||($TR.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$TY.create($Tt))}),$Tc(0,$TM,"globalAlpha",function(){return this._shader2D.ALPHA},function($Tt){($Tt=Math.floor(1e3*$Tt)/1e3)!=this._shader2D.ALPHA&&($TR.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$Tt)}),$Tc(0,$TM,"asBitmap",null,function($Tt){if($Tt){if(this._targets||(this._targets=new $TQ),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$Tc(0,$TM,"fillStyle",function(){return this._shader2D.fillStyle},function($Tt){this._shader2D.fillStyle.equal($Tt)||($TR.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$TY.create($Tt))}),$Tc(0,$TM,"textAlign",function(){return this._other.textAlign},function($Tt){this._other.textAlign===$Tt||(this._other=this._other.make(),$TR.save(this,32768,this._other,!1),this._other.textAlign=$Tt)}),$Tc(0,$TM,"lineWidth",function(){return this._other.lineWidth},function($Tt){this._other.lineWidth===$Tt||(this._other=this._other.make(),$TR.save(this,256,this._other,!1),this._other.lineWidth=$Tt)}),$Tc(0,$TM,"textBaseline",function(){return this._other.textBaseline},function($Tt){this._other.textBaseline===$Tt||(this._other=this._other.make(),$TR.save(this,16384,this._other,!1),this._other.textBaseline=$Tt)}),$Tc(0,$TM,"font",null,function($Tt){$Tt!=this._other.font.toString()&&(this._other=this._other.make(),$TR.save(this,8,this._other,!1),this._other.font===$Tqt.EMPTY?this._other.font=new $Tqt($Tt):this._other.font.setFont($Tt))}),$Tj.__init__=function(){$Tf.DEFAULT=new $Tf},$Tj._tempPoint=new $Tx,$Tj._SUBMITVBSIZE=32e3,$Tj._MAXSIZE=99999999,$Tj._RECTVBSIZE=16,$Tj.MAXCLIPRECT=new $TO(0,0,99999999,99999999),$Tj._COUNT=0,$Tj._tmpMatrix=new $TV,$Tj.SEGNUM=32,$Tj._contextcount=0,$TJ($Tj,["_fontTemp",function(){return this._fontTemp=new $Tqt},"_drawStyleTemp",function(){return this._drawStyleTemp=new $TY(null)}]),$Tj.__init$=function(){$Tf=function(){function $Tt(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$Tqt.EMPTY}$Tb($Tt,"");var $TM=$Tt.prototype;return $TM.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$Tqt.EMPTY},$TM.make=function(){return this===$Tt.DEFAULT?new $Tt:this},$Tt.DEFAULT=null,$Tt}()},$Tj}(),$Tit=function($Tt){function $Tc($Tt,$TM){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$Tc.__super.call(this),this.defines=new $TCt,this.position=$Tc._POSITION,this.mainID=$Tt,this.subID=$TM,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$Tt|$TM,this._inClassCache=$Tc._cache[this._cacheID],0<$Tt&&!this._inClassCache&&(this._inClassCache=$Tc._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$Tb($Tc,"laya.webgl.shader.d2.value.Value2D",$TK);var $TM=$Tc.prototype;return $TM.setValue=function($Tt){},$TM.refresh=function(){var $Tt=this.size;return $Tt[0]=$Tet.width,$Tt[1]=$Tet.height,this.alpha=this.ALPHA*$Tet.worldAlpha,this.mmat=$Tet.worldMatrix4,this},$TM._ShaderWithCompile=function(){return $Tmt.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$TQt.create)},$TM._withWorldShaderDefines=function(){var $Tt=$Tet.worldShaderDefines,$TM=$Tmt.sharders[this.mainID|this.defines._value|$Tt.getValue()];if(!$TM){var $Tf,$Tc={};for($Tf in this.defines.toNameDic())$Tc[$Tf]="";for($Tf in $Tt.toNameDic())$Tc[$Tf]="";$TM=$Tmt.withCompile2D(0,this.mainID,$Tc,this.mainID|this.defines._value|$Tt.getValue(),$TQt.create)}var $TD=$Tet.worldFilters;if(!$TD)return $TM;for(var $To,$TJ=$TD.length,$TZ=0;$TZ<$TJ;$TZ++)($To=$TD[$TZ])&&$To.action.setValue(this);return $TM},$TM.upload=function(){var $Tt=$Tet;this.alpha=this.ALPHA*$Tt.worldAlpha,$Tet.worldMatrix4!==$Tet.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$TXt.shaderHighPrecision&&this.defines.add(1024);var $TM,$Tf=$Tt.worldShaderDefines?this._withWorldShaderDefines():$Tmt.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$Tt.width,this.size[1]=$Tt.height,this.mmat=$Tt.worldMatrix4,$Tut.activeShader!==$Tf?$Tf._shaderValueWidth!==$Tt.width||$Tf._shaderValueHeight!==$Tt.height?($Tf._shaderValueWidth=$Tt.width,$Tf._shaderValueHeight=$Tt.height):$TM=$Tf._params2dQuick2||$Tf._make2dQuick2():$Tf._shaderValueWidth!==$Tt.width||$Tf._shaderValueHeight!==$Tt.height?($Tf._shaderValueWidth=$Tt.width,$Tf._shaderValueHeight=$Tt.height):$TM=$Tf._params2dQuick1||$Tf._make2dQuick1(),$Tf.upload(this,$TM)},$TM.setFilters=function($Tt){if(this.filters=$Tt)for(var $TM,$Tf=$Tt.length,$Tc=0;$Tc<$Tf;$Tc++)($TM=$Tt[$Tc])&&(this.defines.add($TM.type),$TM.action.setValue(this))},$TM.clear=function(){this.defines.setValue(this.subID)},$TM.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$Tc._initone=function($Tt,$TM){$Tc._typeClass[$Tt]=$TM,$Tc._cache[$Tt]=[],$Tc._cache[$Tt]._length=0},$Tc.__init__=function(){$Tc._POSITION=[2,5126,!1,4*$Tlt.BYTES_PE,0],$Tc._TEXCOORD=[2,5126,!1,4*$Tlt.BYTES_PE,2*$Tlt.BYTES_PE],$Tc._initone(2,$Tjt),$Tc._initone(4,$TPt),$Tc._initone(256,$Tdt),$Tc._initone(512,$TKt),$Tc._initone(1,$T$t),$Tc._initone(65,$Tat),$Tc._initone(9,$T$t)},$Tc.create=function($Tt,$TM){var $Tf=$Tc._cache[$Tt|$TM];return $Tf._length?$Tf[--$Tf._length]:new $Tc._typeClass[$Tt|$TM]($TM)},$Tc._POSITION=null,$Tc._TEXCOORD=null,$Tc._cache=[],$Tc._typeClass=[],$Tc.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Tc}(),$TVt=function($Tt){function $T_($Tt,$TM){$T_.__super.call(this,$Tt,$TM)}$Tb($T_,"laya.webgl.utils.RenderSprite3D",$Te);var $TM=$T_.prototype;return $TM.onCreate=function($Tt){switch($Tt){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$TM._mask=function($Tt,$TM,$Tf,$Tc){var $TD,$To,$TJ=this._next,$TZ=$Tt.mask;if($TZ){$TM.ctx.save();var $TA=$TM.ctx.globalCompositeOperation,$TL=new $TO;if($TL.copyFrom($TZ.getBounds()),$TL.width=Math.round($TL.width),$TL.height=Math.round($TL.height),$TL.x=Math.round($TL.x),$TL.y=Math.round($TL.y),0<$TL.width&&0<$TL.height){var $Tp=$Tt._style._tf,$TB=$TZt.create();$TB.addValue("bounds",$TL),$TD=$TJt.create([$TB,$TM],laya.webgl.utils.RenderSprite3D.tmpTarget),$TM.addRenderObject($TD),$TZ.render($TM,-$TL.x,-$TL.y),$TD=$TJt.create([$TB],laya.webgl.utils.RenderSprite3D.endTmpTarget),$TM.addRenderObject($TD),$TM.ctx.save(),$TM.clipRect($Tf-$Tp.translateX+$TL.x,$Tc-$Tp.translateY+$TL.y,$TL.width,$TL.height),$TJ._fun.call($TJ,$Tt,$TM,$Tf,$Tc),$TM.ctx.restore(),$To=$Tpt.create(6),$TA=$TM.ctx.globalCompositeOperation,$To.blendMode="mask",$TM.addRenderObject($To),$TV.TEMP.identity();var $Tb=$Tit.create(1,0),$TI=$Tr.INV_UV,$Tq=$TL.width,$Tl=$TL.height;($TL.width<32||$TL.height<32)&&(($TI=$T_.tempUV)[0]=0,$TI[1]=0,$TI[2]=32<=$TL.width?1:$TL.width/32,$TI[3]=0,$TI[4]=32<=$TL.width?1:$TL.width/32,$TI[5]=32<=$TL.height?1:$TL.height/32,$TI[6]=0,$TI[7]=32<=$TL.height?1:$TL.height/32,$TL.width=32<=$TL.width?$TL.width:32,$TL.height=32<=$TL.height?$TL.height:32,$TI[1]*=-1,$TI[3]*=-1,$TI[5]*=-1,$TI[7]*=-1,$TI[1]+=1,$TI[3]+=1,$TI[5]+=1,$TI[7]+=1),$TM.ctx.drawTarget($TB,$Tf+$TL.x-$Tp.translateX,$Tc+$TL.y-$Tp.translateY,$Tq,$Tl,$TV.TEMP,"tmpTarget",$Tb,$TI,6),$TD=$TJt.create([$TB],laya.webgl.utils.RenderSprite3D.recycleTarget),$TM.addRenderObject($TD),($To=$Tpt.create(6)).blendMode=$TA,$TM.addRenderObject($To)}$TM.ctx.restore()}else $TJ._fun.call($TJ,$Tt,$TM,$Tf,$Tc)},$TM._blend=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt._style,$To=this._next;$TD.blendMode?($TM.ctx.save(),$TM.ctx.globalCompositeOperation=$TD.blendMode,$To._fun.call($To,$Tt,$TM,$Tf,$Tc),$TM.ctx.restore()):$To._fun.call($To,$Tt,$TM,$Tf,$Tc)},$TM._transform=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.transform,$To=this._next;if($TD&&$To!=$Te.NORENDER){var $TJ=$TM.ctx;$Tt._style;$TD.tx=$Tf,$TD.ty=$Tc;var $TZ=$TJ._getTransformMatrix(),$TA=$TZ.clone();$TV.mul($TD,$TZ,$TZ),$TZ._checkTransform(),$TD.tx=$TD.ty=0,$To._fun.call($To,$Tt,$TM,0,0),$TA.copyTo($TZ),$TA.destroy()}else $To._fun.call($To,$Tt,$TM,$Tf,$Tc)},$T_.tmpTarget=function($Tt,$TM){var $Tf=$Tt.getValue("bounds"),$Tc=$Tvt.create($Tf.width,$Tf.height);$Tc.start(),$Tc.clear(0,0,0,0),$Tt.addValue("tmpTarget",$Tc)},$T_.endTmpTarget=function($Tt){$Tt.getValue("tmpTarget").end()},$T_.recycleTarget=function($Tt){$Tt.getValue("tmpTarget").recycle(),$Tt.recycle()},$TJ($T_,["tempUV",function(){return this.tempUV=new Array(8)}]),$T_}(),$Txt=function($Tt){function $TM(){this.data=null,$TM.__super.call(this)}$Tb($TM,"laya.filters.webgl.ColorFilterActionGL",$Tk);var $Tf=$TM.prototype;return $Th.imps($Tf,{"laya.filters.IFilterActionGL":!0}),$Tf.setValue=function($Tt){$Tt.colorMat=this.data._mat,$Tt.colorAlpha=this.data._alpha},$Tf.apply3d=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tt.getValue("bounds"),$TJ=$Tit.create(1,0);$TJ.setFilters([this.data]);var $TZ=$TV.TEMP;$TZ.identity(),$Tf.ctx.drawTarget($Tt,0,0,$To.width,$To.height,$TZ,"src",$TJ)},$TM}(),$TOt=function($Tt){function $To($Tt,$TM,$Tf,$Tc,$TD){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$To.__super.call(this,$Tt,$TM,$TD),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $TYt,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$Tf,this._atlasCanvas.height=$Tc,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$Tb($To,"laya.webgl.atlas.Atlaser",$Tj);var $TM=$To.prototype;return $TM.computeUVinAtlasTexture=function($Tt,$TM,$Tf,$Tc){var $TD=$Td.atlasTextureWidth,$To=$Td.atlasTextureHeight,$TJ=$Tf/$TD,$TZ=$Tc/$To,$TA=($Tf+$Tt.bitmap.width)/$TD,$TL=($Tc+$Tt.bitmap.height)/$To,$Tp=$Tt.bitmap.width/$TD,$TB=$Tt.bitmap.height/$To;$Tt.uv=[$TJ+$TM[0]*$Tp,$TZ+$TM[1]*$TB,$TA-(1-$TM[2])*$Tp,$TZ+$TM[3]*$TB,$TA-(1-$TM[4])*$Tp,$TL-(1-$TM[5])*$TB,$TJ+$TM[6]*$Tp,$TL-(1-$TM[7])*$TB]},$TM.findBitmapIsExist=function($Tt){if($Tt instanceof laya.webgl.resource.WebGLImage){var $TM=$Tt,$Tf=$TM.url,$Tc=this._InAtlasWebGLImagesKey[$Tf||$TM.id];if($Tc)return $Tc.offsetInfoID}return-1},$TM.addToAtlasTexture=function($Tt,$TM,$Tf){if($Tt instanceof laya.webgl.resource.WebGLImage){var $Tc=$Tt,$TD=$Tc.url;this._InAtlasWebGLImagesKey[$TD||$Tc.id]={bitmap:$Tt,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$TM,$Tf])}this._atlasCanvas.texSubImage2D($TM,$Tf,$Tt.atlasSource),$Tt.clearAtlasSource()},$TM.addToAtlas=function($Tt,$TM,$Tf){$Tt._atlasID=this._inAtlasTextureKey.length;var $Tc=$Tt.uv.slice(),$TD=$Tt.bitmap;this._inAtlasTextureKey.push($Tt),this._inAtlasTextureOriUVValue.push($Tc),this._inAtlasTextureBitmapValue.push($TD),this.computeUVinAtlasTexture($Tt,$Tc,$TM,$Tf),$Tt.bitmap=this._atlasCanvas},$TM.clear=function(){for(var $Tt=0,$TM=this._inAtlasTextureKey.length;$Tt<$TM;$Tt++)this._inAtlasTextureKey[$Tt].bitmap=this._inAtlasTextureBitmapValue[$Tt],this._inAtlasTextureKey[$Tt].uv=this._inAtlasTextureOriUVValue[$Tt],this._inAtlasTextureKey[$Tt]._atlasID=-1,this._inAtlasTextureKey[$Tt].bitmap.lock=!1,this._inAtlasTextureKey[$Tt].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$TM.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$Tc(0,$TM,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$Tc(0,$TM,"texture",function(){return this._atlasCanvas}),$Tc(0,$TM,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$To}(),$TCt=function($Tt){function $Tf(){$Tf.__super.call(this,$Tf.__name2int,$Tf.__int2name,$Tf.__int2nameMap)}return $Tb($Tf,"laya.webgl.shader.d2.ShaderDefines2D",$TW),$Tf.__init__=function(){$Tf.reg("TEXTURE2D",1),$Tf.reg("COLOR2D",2),$Tf.reg("PRIMITIVE",4),$Tf.reg("GLOW_FILTER",8),$Tf.reg("BLUR_FILTER",16),$Tf.reg("COLOR_FILTER",32),$Tf.reg("COLOR_ADD",64),$Tf.reg("WORLDMAT",128),$Tf.reg("FILLTEXTURE",256),$Tf.reg("FSHIGHPRECISION",1024),$Tf.reg("TXTALPHA",2048),$Tf.reg("TXTCOMPRESS",4096)},$Tf.reg=function($Tt,$TM){$TW._reg($Tt,$TM,$Tf.__name2int,$Tf.__int2name)},$Tf.toText=function($Tt,$TM,$Tf){return $TW._toText($Tt,$TM,$Tf)},$Tf.toInt=function($Tt){return $TW._toInt($Tt,$Tf.__name2int)},$Tf.TEXTURE2D=1,$Tf.COLOR2D=2,$Tf.PRIMITIVE=4,$Tf.FILTERGLOW=8,$Tf.FILTERBLUR=16,$Tf.FILTERCOLOR=32,$Tf.COLORADD=64,$Tf.WORLDMAT=128,$Tf.FILLTEXTURE=256,$Tf.SKINMESH=512,$Tf.SHADERDEFINE_FSHIGHPRECISION=1024,$Tf.TXTALPHA=2048,$Tf.TXTCOMPRESS=4096,$Tf.__name2int={},$Tf.__int2name=[],$Tf.__int2nameMap=[],$Tf}(),$TUt=(function($Tt){function $TZ($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$TZ.__super.call(this,$Tt,$TM,$Tf,$Tc,40,$TD,$To,$TJ)}$Tb($TZ,"laya.webgl.shapes.Ellipse",$Tft)}(),function($Tt){function $To($Tt,$TM,$Tf,$Tc,$TD){this._points=[],this.rebuild($Tf),$To.__super.call(this,$Tt,$TM,0,0,0,$TD,$Tc,$TD,0)}$Tb($To,"laya.webgl.shapes.Line",$Tft);var $TM=$To.prototype;return $TM.rebuild=function($Tt){var $TM=$Tt.length;$TM!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($TM/2-1)),this.mFloat32Array=new Float32Array(5*$TM)),this._points.length=0;for(var $Tf=NaN,$Tc=NaN,$TD=-1,$To=-1,$TJ=$Tt.length/2,$TZ=0;$TZ<$TJ;$TZ++)$Tf=$Tt[2*$TZ],$Tc=$Tt[2*$TZ+1],(.01<Math.abs($TD-$Tf)||.01<Math.abs($To-$Tc))&&this._points.push($Tf,$Tc),$TD=$Tf,$To=$Tc},$TM.getData=function($Tt,$TM,$Tf){var $Tc=[],$TD=[];0<this.borderWidth&&this.createLine2(this._points,$Tc,this.borderWidth,$Tf,$TD,this._points.length/2),this.mUint16Array.set($Tc,0),this.mFloat32Array.set($TD,0),$Tt.append(this.mUint16Array),$TM.append(this.mFloat32Array)},$To}()),$TFt=function($Tt){function $TB($Tt,$TM,$Tf,$Tc,$TD){this._points=[];for(var $To=NaN,$TJ=NaN,$TZ=-1,$TA=-1,$TL=$Tf.length/2-1,$Tp=0;$Tp<$TL;$Tp++)$To=$Tf[2*$Tp],$TJ=$Tf[2*$Tp+1],(.01<Math.abs($TZ-$To)||.01<Math.abs($TA-$TJ))&&this._points.push($To,$TJ),$TZ=$To,$TA=$TJ;$To=$Tf[2*$TL],$TJ=$Tf[2*$TL+1],$TZ=this._points[0],$TA=this._points[1],(.01<Math.abs($TZ-$To)||.01<Math.abs($TA-$TJ))&&this._points.push($To,$TJ),$TB.__super.call(this,$Tt,$TM,0,0,this._points.length/2,0,$Tc,$TD)}$Tb($TB,"laya.webgl.shapes.LoopLine",$Tft);var $TM=$TB.prototype;return $TM.getData=function($Tt,$TM,$Tf){if(0<this.borderWidth){for(var $Tc=this.color,$TD=($Tc>>16&255)/255,$To=($Tc>>8&255)/255,$TJ=(255&$Tc)/255,$TZ=[],$TA=0,$TL=0,$Tp=[],$TB=Math.floor(this._points.length/2),$Tb=0;$Tb<$TB;$Tb++)$TA=this._points[2*$Tb],$TL=this._points[2*$Tb+1],$TZ.push(this.x+$TA,this.y+$TL,$TD,$To,$TJ);this.createLoopLine($TZ,$Tp,this.borderWidth,$Tf+$TZ.length/5),$Tt.append(new Uint16Array($Tp)),$TM.append(new Float32Array($TZ))}},$TM.createLoopLine=function($Tt,$TM,$Tf,$Tc,$TD,$To){$Tt.length;var $TJ=$Tt.concat(),$TZ=$TD||$Tt,$TA=this.borderColor,$TL=($TA>>16&255)/255,$Tp=($TA>>8&255)/255,$TB=(255&$TA)/255,$Tb=[$TJ[0],$TJ[1]],$TI=[$TJ[$TJ.length-5],$TJ[$TJ.length-4]],$Tq=$TI[0]+.5*($Tb[0]-$TI[0]),$Tl=$TI[1]+.5*($Tb[1]-$TI[1]);$TJ.unshift($Tq,$Tl,0,0,0),$TJ.push($Tq,$Tl,0,0,0);var $T_,$TE,$Te,$TN,$TX,$Ty,$Th,$TT,$Ti,$TV,$Tx,$TO,$TC,$TU,$TF,$TS,$TH,$Ts,$Tr,$Tu,$Tv=$TJ.length/5,$Tk=$Tc,$TK=$Tf/2;$Te=$TJ[0],$TN=$TJ[1],$TV=$Te-($TX=$TJ[5]),$Ti=($Ti=-($TN-($Ty=$TJ[6])))/($Tu=Math.sqrt($Ti*$Ti+$TV*$TV))*$TK,$TV=$TV/$Tu*$TK,$TZ.push($Te-$Ti,$TN-$TV,$TL,$Tp,$TB,$Te+$Ti,$TN+$TV,$TL,$Tp,$TB);for(var $Tj=1;$Tj<$Tv-1;$Tj++)$Te=$TJ[5*($Tj-1)],$TN=$TJ[5*($Tj-1)+1],$TX=$TJ[5*$Tj],$Ty=$TJ[5*$Tj+1],$Th=$TJ[5*($Tj+1)],$TT=$TJ[5*($Tj+1)+1],$TV=$Te-$TX,$TO=$TX-$Th,$TF=(-($Ti=($Ti=-($TN-$Ty))/($Tu=Math.sqrt($Ti*$Ti+$TV*$TV))*$TK)+$Te)*(-($TV=$TV/$Tu*$TK)+$Ty)-(-$Ti+$TX)*(-$TV+$TN),$Ts=(-($Tx=($Tx=-($Ty-$TT))/($Tu=Math.sqrt($Tx*$Tx+$TO*$TO))*$TK)+$Th)*(-($TO=$TO/$Tu*$TK)+$Ty)-(-$Tx+$TX)*(-$TO+$TT),$Tr=($TC=-$TV+$TN-(-$TV+$Ty))*($TH=-$Tx+$TX-(-$Tx+$Th))-($TS=-$TO+$TT-(-$TO+$Ty))*($TU=-$Ti+$TX-(-$Ti+$Te)),Math.abs($Tr)<.1?($Tr+=10.1,$TZ.push($TX-$Ti,$Ty-$TV,$TL,$Tp,$TB,$TX+$Ti,$Ty+$TV,$TL,$Tp,$TB)):((($T_=($TU*$Ts-$TH*$TF)/$Tr)-$TX)*($T_-$TX)+(($TE=($TS*$TF-$TC*$Ts)/$Tr)-$Ty)+($TE-$Ty),$TZ.push($T_,$TE,$TL,$Tp,$TB,$TX-($T_-$TX),$Ty-($TE-$Ty),$TL,$Tp,$TB));$To&&($TM=$To);var $Td=this.edges+1;for($Tj=1;$Tj<$Td;$Tj++)$TM.push($Tk+2*($Tj-1),$Tk+2*($Tj-1)+1,$Tk+2*$Tj+1,$Tk+2*$Tj+1,$Tk+2*$Tj,$Tk+2*($Tj-1));return $TM.push($Tk+2*($Tj-1),$Tk+2*($Tj-1)+1,$Tk+1,$Tk+1,$Tk,$Tk+2*($Tj-1)),$TZ},$TB}(),$TSt=function($Tt){function $TJ($Tt,$TM,$Tf,$Tc,$TD,$To){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$TV.create(),this._points=$Tf.slice(0,$Tf.length),$TJ.__super.call(this,$Tt,$TM,0,0,this._points.length/2,$Tc,$TD,$To)}$Tb($TJ,"laya.webgl.shapes.Polygon",$Tft);var $TM=$TJ.prototype;return $TM.rebuild=function($Tt){this._repaint||(this._points.length=0,this._points=this._points.concat($Tt))},$TM.setMatrix=function($Tt){$Tt.copyTo(this._mat)},$TM.needUpdate=function($Tt){return this._repaint=this._mat.a==$Tt.a&&this._mat.b==$Tt.b&&this._mat.c==$Tt.c&&this._mat.d==$Tt.d&&this._mat.tx==$Tt.tx&&this._mat.ty==$Tt.ty,!this._repaint},$TM.getData=function($Tt,$TM,$Tf){var $Tc,$TD=0,$To=this._points,$TJ=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$Tf){for(this._start=$Tf,$Tc=[],$TJ=this.earcutTriangles.length,$TD=0;$TD<$TJ;$TD++)$Tc.push(this.earcutTriangles[$TD]+$Tf);this.mUint16Array=new Uint16Array($Tc)}}else{this._start=$Tf,$Tc=[];var $TZ=[],$TA=[],$TL=this.color,$Tp=($TL>>16&255)/255,$TB=($TL>>8&255)/255,$Tb=(255&$TL)/255;for($TJ=Math.floor($To.length/2),$TD=0;$TD<$TJ;$TD++)$TZ.push(this.x+$To[2*$TD],this.y+$To[2*$TD+1],$Tp,$TB,$Tb),$TA.push(this.x+$To[2*$TD],this.y+$To[2*$TD+1]);for(this.earcutTriangles=$Tct.earcut($TA,null,2),$TJ=this.earcutTriangles.length,$TD=0;$TD<$TJ;$TD++)$Tc.push(this.earcutTriangles[$TD]+$Tf);this.mUint16Array=new Uint16Array($Tc),this.mFloat32Array=new Float32Array($TZ)}$Tt.append(this.mUint16Array),$TM.append(this.mFloat32Array)},$TJ}(),$THt=function($Tt){function $To(){this._matrix=new $TV,this._matrix4=$Tlt.defaultMatrix4.concat(),$To.__super.call(this,1e4),this.shaderValue=new $Tit(0,0)}$Tb($To,"laya.webgl.submit.SubmitCanvas",$Tot);var $TM=$To.prototype;return $TM.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $Tt=$Tet.worldAlpha,$TM=$Tet.worldMatrix4,$Tf=$Tet.worldMatrix,$Tc=$Tet.worldFilters,$TD=$Tet.worldShaderDefines,$To=this.shaderValue,$TJ=this._matrix,$TZ=this._matrix4,$TA=$TV.TEMP;return $TV.mul($TJ,$Tf,$TA),$TZ[0]=$TA.a,$TZ[1]=$TA.b,$TZ[4]=$TA.c,$TZ[5]=$TA.d,$TZ[12]=$TA.tx,$TZ[13]=$TA.ty,$Tet.worldMatrix=$TA.clone(),$Tet.worldMatrix4=$TZ,$Tet.worldAlpha=$Tet.worldAlpha*$To.alpha,$To.filters&&$To.filters.length&&($Tet.worldFilters=$To.filters,$Tet.worldShaderDefines=$To.defines),this._ctx_src.flush(),$Tet.worldAlpha=$Tt,$Tet.worldMatrix4=$TM,$Tet.worldMatrix.destroy(),$Tet.worldMatrix=$Tf,$Tet.worldFilters=$Tc,$Tet.worldShaderDefines=$TD,1},$TM.releaseRender=function(){var $Tt=$To._cache;this._ctx_src=null,$Tt[$Tt._length++]=this},$TM.getRenderType=function(){return 10003},$To.create=function($Tt,$TM,$Tf){var $Tc=$To._cache._length?$To._cache[--$To._cache._length]:new $To;$Tc._ctx_src=$Tt;var $TD=$Tc.shaderValue;return $TD.alpha=$TM,$TD.defines.setValue(0),$Tf&&$Tf.length&&$TD.setFilters($Tf),$Tc},$To._cache=(($To._cache=[])._length=0,$To._cache),$To}(),$Tst=function($Tt){function $TL($Tt){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$Tt&&($Tt=1e4),$TL.__super.call(this,$Tt)}$Tb($TL,"laya.webgl.submit.SubmitTexture",$Tot);var $TM=$TL.prototype;return $TM.releaseRender=function(){var $Tt=$TL._cache;($Tt[$Tt._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$TM.addTexture=function($Tt,$TM){this._texsID[this._texs.length]=$Tt._uvID,this._texs.push($Tt),this._vbPos.push($TM)},$TM.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $Tt=this.shaderValue.textureHost.bitmap;if(null!==$Tt)for(var $TM=this._vb.getFloat32Array(),$Tf=0,$Tc=this._texs.length;$Tf<$Tc;$Tf++){var $TD=this._texs[$Tf];$TD.active();var $To=$TD.uv;if(this._texsID[$Tf]!==$TD._uvID){this._texsID[$Tf]=$TD._uvID;var $TJ=this._vbPos[$Tf];$TM[$TJ+2]=$To[0],$TM[$TJ+3]=$To[1],$TM[$TJ+6]=$To[2],$TM[$TJ+7]=$To[3],$TM[$TJ+10]=$To[4],$TM[$TJ+11]=$To[5],$TM[$TJ+14]=$To[6],$TM[$TJ+15]=$To[7],this._vb.setNeedUpload()}$TD.bitmap!==$Tt&&(this._isSameTexture=!1)}}},$TM.renderSubmit=function(){if(0===this._numEle)return $TL._shaderSet=!1,1;var $Tt=this.shaderValue.textureHost;if($Tt){var $TM=$Tt.source;if(!$Tt.bitmap||!$TM)return $TL._shaderSet=!1,1;this.shaderValue.texture=$TM,$Tt.alphaTexture&&$Tt.alphaTexture.source&&(this.shaderValue.texture1=$Tt.alphaTexture.source)}this._vb.bind_upload(this._ib);var $Tf=$TXt.mainContext;if($TP.activeBlendFunction!==this._blendFn&&($Tf.enable(3042),this._blendFn($Tf),$TP.activeBlendFunction=this._blendFn),$TF.drawCall++,$TF.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$Tut.activeShader&&$TL._shaderSet?($Tut.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$Tut.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$TL._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $Tc=$Tt.bitmap,$TD=0,$To=$Tut.activeShader,$TJ=0,$TZ=this._texs.length;$TJ<$TZ;$TJ++){var $TA=this._texs[$TJ];$TA.bitmap===$Tc&&$TJ+1!==$TZ||($To.uploadTexture2D($TA.source),$Tf.drawElements(4,6*($TJ-$TD+1),5123,this._startIdx+6*$TD*$Tlt.BYTES_PIDX),$Tc=$TA.bitmap,$TD=$TJ)}else $Tf.drawElements(4,this._numEle,5123,this._startIdx);return 1},$TL.create=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TL._cache._length?$TL._cache[--$TL._cache._length]:new $TL;null==$Tf&&(($Tf=$To._selfVb||($To._selfVb=$TWt.create(-1))).clear(),$Tc=0),$To._ib=$TM,$To._vb=$Tf,$To._startIdx=$Tc*$Tlt.BYTES_PIDX,$To._numEle=0;var $TJ=$Tt._nBlendType;$To._blendFn=$Tt._targets?$TP.targetFns[$TJ]:$TP.fns[$TJ],$To.shaderValue=$TD,$To.shaderValue.setValue($Tt._shader2D);var $TZ=$Tt._shader2D.filters;return $TZ&&$To.shaderValue.setFilters($TZ),$To},$TL._cache=(($TL._cache=[])._length=0,$TL._cache),$TL._shaderSet=!0,$TL}(),$Trt=function($Tt){function $TE(){$TE.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$Tb($TE,"laya.webgl.utils.MeshTexture",$TEt);var $TM=$TE.prototype;return $TM.addData=function($Tt,$TM,$Tf,$Tc,$TD,$To){for(var $TJ=$Tt.length/2,$TZ=this._vb.needSize($TJ*$TE.const_stride)>>2,$TA=this._vb.getFloat32Array(),$TL=0,$Tp=0;$Tp<$TJ;$Tp++){var $TB=$Tt[$TL],$Tb=$Tt[$TL+1],$TI=$TB*$Tc.a+$Tb*$Tc.c+$Tc.tx,$Tq=$TB*$Tc.b+$Tb*$Tc.d+$Tc.ty;$TA[$TZ++]=$TI,$TA[$TZ++]=$Tq,$TA[$TZ++]=$TM[$TL],$TA[$TZ++]=$TM[$TL+1],$TL+=2}this._vb.setNeedUpload();var $Tl=this.vertNum;if(0<$Tl){($TJ=$Tf.length)>$TE.tmpIdx.length&&($TE.tmpIdx=new Uint16Array($TJ));for(var $T_=0;$T_<$TJ;$T_++)$TE.tmpIdx[$T_]=$Tf[$T_]+$Tl;this._ib.appendU16Array($TE.tmpIdx,$Tf.length)}else this._ib.append($Tf);this._ib.setNeedUpload(),this.vertNum+=$TJ,this.indexNum+=$Tf.length},$TM.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$TM.destroy=function(){this._ib.destroy(),this._vb.destroy()},$TE.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $TE},$TE.const_stride=16,$TE._POOL=[],$TJ($TE,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$TE}(),$Tut=function($Tt){function $TM(){$TM.__super.call(this),this.lock=!0}return $Tb($TM,"laya.webgl.shader.BaseShader",$TN),$TM.activeShader=null,$TM.bindShader=null,$TM}(),$Tvt=function($TM){function $Tp($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=5121),void 0===$TD&&($TD=34041),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=-1),void 0===$TA&&($TA=-1),this._type=1,this._w=$Tt,this._h=$TM,this._surfaceFormat=$Tf,this._surfaceType=$Tc,this._depthStencilFormat=$TD,$TE.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$To,this._repeat=$TJ,this._minFifter=$TZ,this._magFifter=$TA,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$Tp.__super.call(this,this.bitmap,$Tr.INV_UV)}$Tb($Tp,"laya.webgl.resource.RenderTarget2D",$TM);var $Tt=$Tp.prototype;return $Th.imps($Tt,{"laya.resource.IDispose":!0}),$Tt.getType=function(){return this._type},$Tt.getTexture=function(){return this},$Tt.size=function($Tt,$TM){this._w==$Tt&&this._h==$TM||(this._w=$Tt,this._h=$TM,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$Tt.release=function(){this.destroy()},$Tt.recycle=function(){$Tp.POOL.push(this)},$Tt.start=function(){var $Tt=$TXt.mainContext;return this._preRenderTarget=$Tet.curRenderTarget,$Tet.curRenderTarget=this,$Tt.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($Tt.viewport(0,0,this._w,this._h),this._svWidth=$Tet.width,this._svHeight=$Tet.height,$Tet.width=this._w,$Tet.height=this._h,$Tut.activeShader=null),this},$Tt.clear=function($Tt,$TM,$Tf,$Tc){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=1);var $TD=$TXt.mainContext;$TD.clearColor($Tt,$TM,$Tf,$Tc);var $To=16384;switch(this._depthStencilFormat){case 33189:$To|=256;break;case 36168:$To|=1024;break;case 34041:$To|=256,$To|=1024}$TD.clear($To)},$Tt.end=function(){var $Tt=$TXt.mainContext;$Tt.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$Tet.curRenderTarget=this._preRenderTarget,1==this._type?($Tt.viewport(0,0,this._svWidth,this._svHeight),$Tet.width=this._svWidth,$Tet.height=this._svHeight,$Tut.activeShader=null):$Tt.viewport(0,0,$Th.stage.width,$Th.stage.height)},$Tt.getData=function($Tt,$TM,$Tf,$Tc){var $TD=$TXt.mainContext;if($TD.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$TD.checkFramebufferStatus(36160)))return $TD.bindFramebuffer(36160,null),null;var $To=new Uint8Array(this._w*this._h*4);return $TD.readPixels($Tt,$TM,$Tf,$Tc,this._surfaceFormat,this._surfaceType,$To),$TD.bindFramebuffer(36160,null),$To},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$TM.prototype.destroy.call(this))},$Tt.dispose=function(){},$Tt._createWebGLRenderTarget=function(){this.bitmap=new $Tgt(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($Tt){this.event("recovered")})},$Tc(0,$Tt,"surfaceFormat",function(){return this._surfaceFormat}),$Tc(0,$Tt,"magFifter",function(){return this._magFifter}),$Tc(0,$Tt,"surfaceType",function(){return this._surfaceType}),$Tc(0,$Tt,"mipMap",function(){return this._mipMap}),$Tc(0,$Tt,"depthStencilFormat",function(){return this._depthStencilFormat}),$Tc(0,$Tt,"minFifter",function(){return this._minFifter}),$Tc(0,$Tt,"source",function(){return this._alreadyResolved?$Th.superGet($Tr,this,"source"):null}),$Tp.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){void 0===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=5121),void 0===$TD&&($TD=34041),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=-1),void 0===$TA&&($TA=-1);var $TL=$Tp.POOL.pop();return $TL||($TL=new $Tp($Tt,$TM)),$TL.bitmap&&$TL._w==$Tt&&$TL._h==$TM&&$TL._surfaceFormat==$Tf&&$TL._surfaceType==$Tc&&$TL._depthStencilFormat==$TD&&$TL._mipMap==$To&&$TL._repeat==$TJ&&$TL._minFifter==$TZ&&$TL._magFifter==$TA||($TL._w=$Tt,$TL._h=$TM,$TL._surfaceFormat=$Tf,$TL._surfaceType=$Tc,$TL._depthStencilFormat=$TD,$TE.isConchWebGL&&34041===$TL._depthStencilFormat&&($TL._depthStencilFormat=33189),$TL._mipMap=$To,$TL._repeat=$TJ,$TL._minFifter=$TZ,$TL._magFifter=$TA,$TL.release(),$TL._createWebGLRenderTarget()),$TL},$Tp.TYPE2D=1,$Tp.TYPE3D=2,$Tp.POOL=[],$Tp}($Tr),$Tkt=function($Tt){function $TM(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$TM.__super.call(this),$TM._gl=$TXt.mainContext}$Tb($TM,"laya.webgl.utils.Buffer",$TN);var $Tf=$TM.prototype;return $Tf._bind=function(){this.activeResource(),$TM._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($TM._bindVertexBuffer=this._glBuffer),$TM._gl.bindBuffer(this._bufferType,$TM._bindActive[this._bufferType]=this._glBuffer),$Tut.activeShader=null)},$Tf.recreateResource=function(){this._glBuffer||(this._glBuffer=$TM._gl.createBuffer()),this.completeCreate()},$Tf.disposeResource=function(){this._glBuffer&&($TXt.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$Tc(0,$Tf,"bufferUsage",function(){return this._bufferUsage}),$TM._gl=null,$TM._bindActive={},$TM._bindVertexBuffer=null,$TM._enableAtributes=[],$TM}(),$TKt=function($Tt){function $Tf($Tt){this.texcoord=null,this.offsetX=300,this.offsetY=0,$Tf.__super.call(this,512,0);var $TM=8*$Tlt.BYTES_PE;this.position=[2,5126,!1,$TM,0],this.texcoord=[2,5126,!1,$TM,2*$Tlt.BYTES_PE],this.color=[4,5126,!1,$TM,4*$Tlt.BYTES_PE]}return $Tb($Tf,"laya.webgl.shader.d2.skinAnishader.SkinSV",$Tit),$Tf}(),$Tjt=function($Tt){function $TM($Tt){$TM.__super.call(this,2,0),this.color=[]}return $Tb($TM,"laya.webgl.shader.d2.value.Color2dSV",$Tit),$TM.prototype.setValue=function($Tt){$Tt.fillStyle&&(this.color=$Tt.fillStyle._color._color),$Tt.strokeStyle&&(this.color=$Tt.strokeStyle._color._color)},$TM}(),$Tdt=function($Tt){function $TM($Tt){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$Tit._TEXCOORD,$TM.__super.call(this,256,0)}$Tb($TM,"laya.webgl.shader.d2.value.FillTextureSV",$Tit);var $Tf=$TM.prototype;return $Tf.setValue=function($Tt){this.ALPHA=$Tt.ALPHA,$Tt.filters&&this.setFilters($Tt.filters)},$Tf.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$TM}(),$T$t=function($Tt){function $TM($Tt){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$Tit._TEXCOORD,void 0===$Tt&&($Tt=0),$TM.__super.call(this,1,$Tt)}$Tb($TM,"laya.webgl.shader.d2.value.TextureSV",$Tit);var $Tf=$TM.prototype;return $Tf.setValue=function($Tt){this.ALPHA=$Tt.ALPHA,$Tt.filters&&this.setFilters($Tt.filters)},$Tf.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$TM}(),$TPt=function($Tt){function $TM($Tt){this.a_color=null,this.u_pos=[0,0],$TM.__super.call(this,4,0),this.position=[2,5126,!1,5*$Tlt.BYTES_PE,0],this.a_color=[3,5126,!1,5*$Tlt.BYTES_PE,2*$Tlt.BYTES_PE]}return $Tb($TM,"laya.webgl.shader.d2.value.PrimitiveSV",$Tit),$TM}(),$TYt=function($Tt){function $TM(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$TM.__super.call(this)}$Tb($TM,"laya.webgl.atlas.AtlasWebGLCanvas",$Tt);var $Tf=$TM.prototype;return $Tf.recreateResource=function(){var $Tt=$TXt.mainContext,$TM=this._source=$Tt.createTexture(),$Tf=$Tyt.curBindTexTarget,$Tc=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,$TM),$Tt.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$Tt.texParameteri(3553,10241,9729),$Tt.texParameteri(3553,10240,9729),$Tt.texParameteri(3553,10242,33071),$Tt.texParameteri(3553,10243,33071),$Tf&&$Tc&&$Tyt.bindTexture($Tt,$Tf,$Tc),this.memorySize=this._w*this._h*4,this.completeCreate()},$Tf.disposeResource=function(){this._source&&($TXt.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Tf.texSubImage2D=function($Tt,$TM,$Tf){if($TE.isFlash){this._flashCacheImage||(this._flashCacheImage=$Tl.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $Tc=$Tf.bitmapdata;this._flashCacheImage._image.copyPixels($Tc,0,0,$Tc.width,$Tc.height,$Tt,$TM),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $TD=$TXt.mainContext,$To=$Tyt.curBindTexTarget,$TJ=$Tyt.curBindTexValue;$Tyt.bindTexture($TD,3553,this._source),$TD.pixelStorei(37441,!0),0<=$Tt-1&&$TD.texSubImage2D(3553,0,$Tt-1,$TM,6408,5121,$Tf),$Tt+1<=this._w&&$TD.texSubImage2D(3553,0,$Tt+1,$TM,6408,5121,$Tf),0<=$TM-1&&$TD.texSubImage2D(3553,0,$Tt,$TM-1,6408,5121,$Tf),$TM+1<=this._h&&$TD.texSubImage2D(3553,0,$Tt,$TM+1,6408,5121,$Tf),$TD.texSubImage2D(3553,0,$Tt,$TM,6408,5121,$Tf),$TD.pixelStorei(37441,!1),$To&&$TJ&&$Tyt.bindTexture($TD,$To,$TJ)}},$Tf.texSubImage2DPixel=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TXt.mainContext,$TJ=$Tyt.curBindTexTarget,$TZ=$Tyt.curBindTexValue;$Tyt.bindTexture($To,3553,this._source);var $TA=new Uint8Array($TD.data);$To.pixelStorei(37441,!0),$To.texSubImage2D(3553,0,$Tt,$TM,$Tf,$Tc,6408,5121,$TA),$To.pixelStorei(37441,!1),$TJ&&$TZ&&$Tyt.bindTexture($To,$TJ,$TZ)},$Tc(0,$Tf,"width",$Tt.prototype._$get_width,function($Tt){this._w=$Tt}),$Tc(0,$Tf,"height",$Tt.prototype._$get_height,function($Tt){this._h=$Tt}),$TM}($Tf),$Tnt=function($Tt){function $TD(){this.flipY=!0,this.alwaysChange=!1,$TD.__super.call(this)}$Tb($TD,"laya.webgl.resource.WebGLCanvas",$Tf);var $TM=$TD.prototype;return $TM.getCanvas=function(){return this._canvas},$TM.clear=function(){this._ctx&&this._ctx.clear()},$TM.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$TM._setContext=function($Tt){this._ctx=$Tt},$TM.getContext=function($Tt,$TM){return this._ctx?this._ctx:this._ctx=$TD._createContext(this)},$TM.size=function($Tt,$TM){this._w==$Tt&&this._h==$TM||(this._w=$Tt,this._h=$TM,this._ctx&&this._ctx.size($Tt,$TM),this._canvas&&(this._canvas.height=$TM,this._canvas.width=$Tt))},$TM.activeResource=function($Tt){void 0===$Tt&&($Tt=!1),this._source||this.recreateResource()},$TM.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$TM.disposeResource=function(){this._source&&!this.iscpuSource&&($TXt.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$TM.createWebGlTexture=function(){var $Tt=$TXt.mainContext;this._canvas;var $TM=this._source=$Tt.createTexture();this.iscpuSource=!1;var $Tf=$Tyt.curBindTexTarget,$Tc=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,$TM),$Tt.pixelStorei(37440,this.flipY?1:0),$TD.premulAlpha&&$Tt.pixelStorei(37441,!0),$Tt.texImage2D(3553,0,6408,6408,5121,this._imgData),$TD.premulAlpha&&$Tt.pixelStorei(37441,!1),$Tt.texParameteri(3553,10240,9729),$Tt.texParameteri(3553,10241,9729),$Tt.texParameteri(3553,10242,33071),$Tt.texParameteri(3553,10243,33071),$Tt.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$Tf&&$Tc&&$Tyt.bindTexture($Tt,$Tf,$Tc)},$TM.reloadCanvasData=function(){var $Tt=$TXt.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $TM=$Tyt.curBindTexTarget,$Tf=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,this._source),$TD.premulAlpha&&$Tt.pixelStorei(37441,!0),$Tt.texImage2D(3553,0,6408,6408,5121,this._imgData),$TD.premulAlpha&&$Tt.pixelStorei(37441,!1),$Tt.pixelStorei(37440,0),$TM&&$Tf&&$Tyt.bindTexture($Tt,$TM,$Tf)},$TM.texSubImage2D=function($Tt,$TM,$Tf){var $Tc=$TXt.mainContext,$TD=$Tyt.curBindTexTarget,$To=$Tyt.curBindTexValue;$Tyt.bindTexture($Tc,3553,this._source),$Tc.pixelStorei(37441,!0),$Tc.texSubImage2D(3553,0,$TM,$Tf,6408,5121,$Tt._source),$Tc.pixelStorei(37441,!1),$TD&&$To&&$Tyt.bindTexture($Tc,$TD,$To)},$TM.toBase64=function($Tt,$TM,$Tf){var $Tc=null;this._canvas&&($Tc=this._canvas.toDataURL($Tt,$TM)),$Tf.call(this,$Tc)},$Tc(0,$TM,"context",function(){return this._ctx}),$Tc(0,$TM,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$Tc(0,$TM,"asBitmap",null,function($Tt){this._ctx&&(this._ctx.asBitmap=$Tt)}),$TD._createContext=null,$TD.premulAlpha=!1,$TD}(),$TRt=function($Tt){function $To($Tt,$TM){this.CborderSize=12,$To.__super.call(this),this.char=$Tt,this.isSpace=" "===$Tt,this.xs=$TM.scaleX,this.ys=$TM.scaleY,this.font=$TM.font.toString(),this.fontSize=$TM.font.size,this.fillColor=$TM.fillColor,this.borderColor=$TM.borderColor,this.lineWidth=$TM.lineWidth,this.underLine=$TM.underLine;var $Tf,$Tc=$TE.isConchApp;$Tc?(($Tf=ConchTextCanvas)._source=ConchTextCanvas,$Tf._source.canvas=ConchTextCanvas):$Tf=$TI.canvas.source,this.canvas=$Tf,this._enableMerageInAtlas=!0,this._ctx=$Tc?$Tf:this.canvas.getContext("2d",void 0);var $TD=$Tu.measureText(this.char,this.font);this.cw=$TD.width*this.xs,this.ch=($TD.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $Tr(this)}$Tb($To,"laya.webgl.resource.WebGLCharImage",$Tf);var $TM=$To.prototype;return $Th.imps($TM,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$TM.active=function(){this.texture.active()},$TM.recreateResource=function(){var $Tt=$TE.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$Tt){var $TM=this.fontSize;1==this.xs&&1==this.ys||($TM=parseInt($TM*(this.xs>this.ys?this.xs:this.ys)+""));var $Tf="normal 100 "+this.font;$Tf=$Tf.replace($To._fontSizeReg,$TM),this.borderColor&&($Tf+=" 1 "+this.borderColor),this._ctx.font=$Tf,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$Ts.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $Tc=this._ctx.measureText(this.char);$Tc||($Tc={width:16});var $TD=$Tc.width+1;this._ctx.lineTo($TD,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$TM.onresize=function($Tt,$TM){this._w=$Tt,this._h=$TM,this._allowMerageInAtlas=!0},$TM.clearAtlasSource=function(){},$Tc(0,$TM,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Tc(0,$TM,"atlasSource",function(){return this.canvas}),$Tc(0,$TM,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($Tt){this._enableMerageInAtlas=$Tt}),$To.createOneChar=function($Tt,$TM){return new $To($Tt,$TM)},$To._fontSizeReg=new RegExp("\\d+(?=px)","g"),$To}(),$Tgt=function($Tt){function $TL($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){void 0===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=5121),void 0===$TD&&($TD=34041),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=-1),void 0===$TA&&($TA=1),$TL.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$Tt,this._h=$TM,this._surfaceFormat=$Tf,this._surfaceType=$Tc,this._depthStencilFormat=$TD,this._mipMap=$To,this._repeat=$TJ,this._minFifter=$TZ,this._magFifter=$TA}$Tb($TL,"laya.webgl.resource.WebGLRenderTarget",$Tf);var $TM=$TL.prototype;return $TM.recreateResource=function(){var $Tt=$TXt.mainContext;this._frameBuffer||(this._frameBuffer=$Tt.createFramebuffer()),this._source||(this._source=$Tt.createTexture());var $TM=$Tyt.curBindTexTarget,$Tf=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,this._source),$Tt.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $Tc=this._minFifter,$TD=this._magFifter,$To=this._repeat?10497:33071,$TJ=$Tp.isPOT(this._w,this._h);if($TJ?(this._mipMap?-1!==$Tc||($Tc=9987):-1!==$Tc||($Tc=9729),-1!==$TD||($TD=9729),$Tt.texParameteri(3553,10241,$Tc),$Tt.texParameteri(3553,10240,$TD),$Tt.texParameteri(3553,10242,$To),$Tt.texParameteri(3553,10243,$To),this._mipMap&&$Tt.generateMipmap(3553)):(-1!==$Tc||($Tc=9729),-1!==$TD||($TD=9729),$Tt.texParameteri(3553,10241,$Tc),$Tt.texParameteri(3553,10240,$TD),$Tt.texParameteri(3553,10242,33071),$Tt.texParameteri(3553,10243,33071)),$Tt.bindFramebuffer(36160,this._frameBuffer),$Tt.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$Tt.createRenderbuffer()),$Tt.bindRenderbuffer(36161,this._depthStencilBuffer),$Tt.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$Tt.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$Tt.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$Tt.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$Tt.bindFramebuffer(36160,null),$TM&&$Tf&&$Tyt.bindTexture($Tt,$TM,$Tf),$Tt.bindRenderbuffer(36161,null),$TJ&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$TM.disposeResource=function(){this._frameBuffer&&($TXt.mainContext.deleteTexture(this._source),$TXt.mainContext.deleteFramebuffer(this._frameBuffer),$TXt.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$Tc(0,$TM,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$Tc(0,$TM,"frameBuffer",function(){return this._frameBuffer}),$TL}(),$Tzt=function($Tt){function $TZ($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this.offsetX=0,this.offsetY=0,$TZ.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$To,this.canvas=$Tt,this._ctx=$Tt.getContext("2d",void 0),this._w=$Tc,this._h=$TD,this.offsetX=$TM,this.offsetY=$Tf,this.src=$TJ,this._enableMerageInAtlas=!0,$Td.enabled&&this._w<$Td.atlasLimitWidth&&this._h<$Td.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$Tb($TZ,"laya.webgl.resource.WebGLSubImage",$Tf);var $TM=$TZ.prototype;return $Th.imps($TM,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$TM.size=function($Tt,$TM){this._w=$Tt,this._h=$TM,this._ctx&&this._ctx.size($Tt,$TM),this.canvas&&(this.canvas.height=$TM,this.canvas.width=$Tt)},$TM.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$TM.createWebGlTexture=function(){var $Tt=$TXt.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $TM=this._source=$Tt.createTexture(),$Tf=$Tyt.curBindTexTarget,$Tc=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,$TM),$Tt.pixelStorei(37441,!0),$Tt.texImage2D(3553,0,6408,6408,5121,this.canvas),$Tt.pixelStorei(37441,!1);var $TD=this.minFifter,$To=this.magFifter,$TJ=this.repeat?10497:33071,$TZ=$Tp.isPOT(this.width,this.height);$TZ?(this.mipmap?-1!==$TD||($TD=9987):-1!==$TD||($TD=9729),-1!==$To||($To=9729),$Tt.texParameteri(3553,10240,$To),$Tt.texParameteri(3553,10241,$TD),$Tt.texParameteri(3553,10242,$TJ),$Tt.texParameteri(3553,10243,$TJ),this.mipmap&&$Tt.generateMipmap(3553)):(-1!==$TD||($TD=9729),-1!==$To||($To=9729),$Tt.texParameteri(3553,10241,$TD),$Tt.texParameteri(3553,10240,$To),$Tt.texParameteri(3553,10242,33071),$Tt.texParameteri(3553,10243,33071)),$Tf&&$Tc&&$Tyt.bindTexture($Tt,$Tf,$Tc),this.canvas=null,$TZ&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$TM.disposeResource=function(){$Td.enabled&&this._allowMerageInAtlas||!this._source||($TXt.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$TM.clearAtlasSource=function(){},$Tc(0,$TM,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Tc(0,$TM,"atlasSource",function(){return this.canvas}),$Tc(0,$TM,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($Tt){this._allowMerageInAtlas=$Tt}),$TZ}(),$Tmt=function($Tt){function $TL($Tt,$TM,$Tf,$Tc){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$TL.__super.call(this),!$Tt||!$TM)throw"Shader Error";this._id=++$TL._count,this._vs=$Tt,this._ps=$TM,this._nameMap=$Tc||{},null!=$Tf&&($TL.sharders[$Tf]=this)}$Tb($TL,"laya.webgl.shader.Shader",$Tut);var $TM=$TL.prototype;return $TM.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$TM.disposeResource=function(){$TXt.mainContext.deleteShader(this._vshader),$TXt.mainContext.deleteShader(this._pshader),$TXt.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$TM._compile=function(){if(!$TXt.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $Tt=[this._vs,this._ps],$TM=$TXt.mainContext;if(this._program=$TM.createProgram(),this._vshader=$TL._createShader($TM,$Tt[0],35633),this._pshader=$TL._createShader($TM,$Tt[1],35632),$TM.attachShader(this._program,this._vshader),$TM.attachShader(this._program,this._pshader),$TM.linkProgram(this._program),!$TE.isConchApp&&!$TM.getProgramParameter(this._program,35714))throw $TM.getProgramInfoLog(this._program);var $Tf,$Tc,$TD=0,$To=0;for($To=$TE.isConchApp?$TM.getProgramParameterEx(this._vs,this._ps,"",35721):$TM.getProgramParameter(this._program,35721),$TD=0;$TD<$To;$TD++){var $TJ=null;$Tf={vartype:"attribute",glfun:null,ivartype:0,attrib:$TJ=$TE.isConchApp?$TM.getActiveAttribEx(this._vs,this._ps,"",$TD):$TM.getActiveAttrib(this._program,$TD),location:$TM.getAttribLocation(this._program,$TJ.name),name:$TJ.name,type:$TJ.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($Tf)}var $TZ=0;for($TZ=$TE.isConchApp?$TM.getProgramParameterEx(this._vs,this._ps,"",35718):$TM.getProgramParameter(this._program,35718),$TD=0;$TD<$TZ;$TD++){var $TA=null;$TA=$TE.isConchApp?$TM.getActiveUniformEx(this._vs,this._ps,"",$TD):$TM.getActiveUniform(this._program,$TD),0<($Tf={vartype:"uniform",glfun:null,ivartype:1,attrib:$TJ,location:$TM.getUniformLocation(this._program,$TA.name),name:$TA.name,type:$TA.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($Tf.name=$Tf.name.substr(0,$Tf.name.length-3),$Tf.isArray=!0,$Tf.location=$TM.getUniformLocation(this._program,$Tf.name)),this._params.push($Tf)}for($TD=0,$Tc=this._params.length;$TD<$Tc;$TD++)if(($Tf=this._params[$TD]).indexOfParams=$TD,$Tf.index=1,$Tf.value=[$Tf.location,null],$Tf.codename=$Tf.name,$Tf.name=this._nameMap[$Tf.codename]?this._nameMap[$Tf.codename]:$Tf.codename,(this._paramsMap[$Tf.name]=$Tf)._this=this,$Tf.uploadedValue=[],"attribute"!==$Tf.vartype)switch($Tf.type){case 5124:$Tf.fun=$Tf.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$Tf.fun=$Tf.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$Tf.fun=$Tf.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$Tf.fun=$Tf.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$Tf.fun=$Tf.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$Tf.fun=this._uniform_sampler2D;break;case 35680:$Tf.fun=this._uniform_samplerCube;break;case 35676:$Tf.glfun=$TM.uniformMatrix4fv,$Tf.fun=this._uniformMatrix4fv;break;case 35670:$Tf.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $Tf.fun=this._attribute}},$TM.getUniform=function($Tt){return this._paramsMap[$Tt]},$TM._attribute=function($Tt,$TM){var $Tf=$TXt.mainContext,$Tc=$Tkt._enableAtributes,$TD=$Tt.location;return $Tc[$TD]||$Tf.enableVertexAttribArray($TD),$Tf.vertexAttribPointer($TD,$TM[0],$TM[1],$TM[2],$TM[3],$TM[4]+this._offset),$Tc[$TD]=$Tkt._bindVertexBuffer,1},$TM._uniform1f=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM?($TXt.mainContext.uniform1f($Tt.location,$Tf[0]=$TM),1):0},$TM._uniform1fv=function($Tt,$TM){if($TM.length<4){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TXt.mainContext.uniform1fv($Tt.location,$TM),$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3],1):0}return $TXt.mainContext.uniform1fv($Tt.location,$TM),1},$TM._uniform_vec2=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]?($TXt.mainContext.uniform2f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1]),1):0},$TM._uniform_vec2v=function($Tt,$TM){if($TM.length<2){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TXt.mainContext.uniform2fv($Tt.location,$TM),$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3],1):0}return $TXt.mainContext.uniform2fv($Tt.location,$TM),1},$TM._uniform_vec3=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]?($TXt.mainContext.uniform3f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2]),1):0},$TM._uniform_vec3v=function($Tt,$TM){return $TXt.mainContext.uniform3fv($Tt.location,$TM),1},$TM._uniform_vec4=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TXt.mainContext.uniform4f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3]),1):0},$TM._uniform_vec4v=function($Tt,$TM){return $TXt.mainContext.uniform4fv($Tt.location,$TM),1},$TM._uniformMatrix2fv=function($Tt,$TM){return $TXt.mainContext.uniformMatrix2fv($Tt.location,!1,$TM),1},$TM._uniformMatrix3fv=function($Tt,$TM){return $TXt.mainContext.uniformMatrix3fv($Tt.location,!1,$TM),1},$TM._uniformMatrix4fv=function($Tt,$TM){return $TXt.mainContext.uniformMatrix4fv($Tt.location,!1,$TM),1},$TM._uniform1i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM?($TXt.mainContext.uniform1i($Tt.location,$Tf[0]=$TM),1):0},$TM._uniform1iv=function($Tt,$TM){return $TXt.mainContext.uniform1iv($Tt.location,$TM),1},$TM._uniform_ivec2=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]?($TXt.mainContext.uniform2i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1]),1):0},$TM._uniform_ivec2v=function($Tt,$TM){return $TXt.mainContext.uniform2iv($Tt.location,$TM),1},$TM._uniform_vec3i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]?($TXt.mainContext.uniform3i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2]),1):0},$TM._uniform_vec3vi=function($Tt,$TM){return $TXt.mainContext.uniform3iv($Tt.location,$TM),1},$TM._uniform_vec4i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TXt.mainContext.uniform4i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3]),1):0},$TM._uniform_vec4vi=function($Tt,$TM){return $TXt.mainContext.uniform4iv($Tt.location,$TM),1},$TM._uniform_sampler2D=function($Tt,$TM){var $Tf=$TXt.mainContext,$Tc=$Tt.uploadedValue;return null==$Tc[0]?($Tc[0]=this._curActTexIndex,$Tf.uniform1i($Tt.location,this._curActTexIndex),$Tf.activeTexture($TL._TEXTURES[this._curActTexIndex]),$Tyt.bindTexture($Tf,3553,$TM),this._curActTexIndex++,1):($Tf.activeTexture($TL._TEXTURES[$Tc[0]]),$Tyt.bindTexture($Tf,3553,$TM),0)},$TM._uniform_samplerCube=function($Tt,$TM){var $Tf=$TXt.mainContext,$Tc=$Tt.uploadedValue;return null==$Tc[0]?($Tc[0]=this._curActTexIndex,$Tf.uniform1i($Tt.location,this._curActTexIndex),$Tf.activeTexture($TL._TEXTURES[this._curActTexIndex]),$Tyt.bindTexture($Tf,34067,$TM),this._curActTexIndex++,1):($Tf.activeTexture($TL._TEXTURES[$Tc[0]]),$Tyt.bindTexture($Tf,34067,$TM),0)},$TM._noSetValue=function($Tt){console.log("no....:"+$Tt.name)},$TM.uploadOne=function($Tt,$TM){this.activeResource(),$Tyt.UseProgram(this._program);var $Tf=this._paramsMap[$Tt];$Tf.fun.call(this,$Tf,$TM)},$TM.uploadTexture2D=function($Tt){$TF.shaderCall++;var $TM=$TXt.mainContext;$TM.activeTexture(33984),$Tyt.bindTexture($TM,3553,$Tt)},$TM.uploadTexture2D1=function($Tt){$TF.shaderCall++;var $TM=$TXt.mainContext;$TM.activeTexture(33985),$Tyt.bindTexture($TM,3553,$Tt)},$TM.upload=function($Tt,$TM){$Tut.activeShader=$Tut.bindShader=this,this._lastUseFrameCount===$TF.loopCount||this.activeResource(),$Tyt.UseProgram(this._program),this._reCompile?($TM=this._params,this._reCompile=!1):$TM=$TM||this._params;$TXt.mainContext;for(var $Tf,$Tc,$TD=$TM.length,$To=0,$TJ=0;$TJ<$TD;$TJ++)null!==($Tc=$Tt[($Tf=$TM[$TJ]).name])&&($To+=$Tf.fun.call(this,$Tf,$Tc));$TF.shaderCall+=$To},$TM.uploadArray=function($Tt,$TM,$Tf){$Tut.activeShader=this,($Tut.bindShader=this).activeResource(),$Tyt.UseProgram(this._program);this._params;for(var $Tc,$TD,$To=0,$TJ=$TM-2;0<=$TJ;$TJ-=2)($TD=this._paramsMap[$Tt[$TJ]])&&null!=($Tc=$Tt[$TJ+1])&&($Tf&&$Tf[$TD.name]&&$Tf[$TD.name].bind(),$To+=$TD.fun.call(this,$TD,$Tc));$TF.shaderCall+=$To},$TM.getParams=function(){return this._params},$TL.getShader=function($Tt){return $TL.sharders[$Tt]},$TL.create=function($Tt,$TM,$Tf,$Tc){return new $TL($Tt,$TM,$Tf,$Tc)},$TL.withCompile=function($Tt,$TM,$Tf,$Tc){if($Tf&&$TL.sharders[$Tf])return $TL.sharders[$Tf];var $TD=$TL._preCompileShader[2e-4*$Tt];if(!$TD)throw new Error("withCompile shader err!"+$Tt);return $TD.createShader($TM,$Tf,$Tc)},$TL.withCompile2D=function($Tt,$TM,$Tf,$Tc,$TD){if($Tc&&$TL.sharders[$Tc])return $TL.sharders[$Tc];var $To=$TL._preCompileShader[2e-4*$Tt+$TM];if(!$To)throw new Error("withCompile shader err!"+$Tt+" "+$TM);return $To.createShader($Tf,$Tc,$TD)},$TL.addInclude=function($Tt,$TM){$TNt.addInclude($Tt,$TM)},$TL.preCompile=function($Tt,$TM,$Tf,$Tc){var $TD=2e-4*$Tt;$TL._preCompileShader[$TD]=new $TNt($TD,$TM,$Tf,$Tc)},$TL.preCompile2D=function($Tt,$TM,$Tf,$Tc,$TD){var $To=2e-4*$Tt+$TM;$TL._preCompileShader[$To]=new $TNt($To,$Tf,$Tc,$TD)},$TL._createShader=function($Tt,$TM,$Tf){var $Tc=$Tt.createShader($Tf);return $Tt.shaderSource($Tc,$TM),$Tt.compileShader($Tc),$Tc},$TL._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$TL._count=0,$TL._preCompileShader={},$TL.SHADERNAME2ID=2e-4,$TL.sharders=(($TL.sharders=[]).length=32,$TL.sharders),$TJ($TL,["nameKey",function(){return this.nameKey=new $TS}]),$TL}(),$TGt=function($Tt){function $TM(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$TM.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$Tb($TM,"laya.webgl.utils.Buffer2D",$Tt);var $Tf=$TM.prototype;return $Tf.needSize=function($Tt){var $TM=this._byteLength;if($Tt){var $Tf=this._byteLength+$Tt;$Tf<=this._buffer.byteLength||this._resizeBuffer($Tf<<1,!0),this._byteLength=$Tf}return $TM},$Tf._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$TF.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Tkt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$Tkt._gl.bufferSubData(this._bufferType,0,this._buffer)},$Tf._bufferSubData=function($Tt,$TM,$Tf){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$TF.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Tkt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$TM||$Tf){var $Tc=this._buffer.slice($TM,$Tf);$Tkt._gl.bufferSubData(this._bufferType,$Tt,$Tc)}else $Tkt._gl.bufferSubData(this._bufferType,$Tt,this._buffer)},$Tf._checkArrayUse=function(){},$Tf._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$Tf._bind_subUpload=function($Tt,$TM,$Tf){return void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($Tt,$TM,$Tf),!0)},$Tf._resizeBuffer=function($Tt,$TM){if($Tt<this._buffer.byteLength)return this;if(this.memorySize=$Tt,$TM&&this._buffer&&0<this._buffer.byteLength){var $Tf=new ArrayBuffer($Tt);new Uint8Array($Tf).set(new Uint8Array(this._buffer),0),this._buffer=$Tf}else this._buffer=new ArrayBuffer($Tt);return this._checkArrayUse(),this._upload=!0,this},$Tf.append=function($Tt){this._upload=!0;var $TM,$Tf;$TM=$Tt.byteLength,$Tt instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$TM,!0),$Tf=new Uint8Array(this._buffer,this._byteLength)):$Tt instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$TM,!0),$Tf=new Uint16Array(this._buffer,this._byteLength)):$Tt instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$TM,!0),$Tf=new Float32Array(this._buffer,this._byteLength)),$Tf.set($Tt,0),this._byteLength+=$TM,this._checkArrayUse()},$Tf.appendU16Array=function($Tt,$TM){this._resizeBuffer(this._byteLength+2*$TM,!0);for(var $Tf=new Uint16Array(this._buffer,this._byteLength,$TM),$Tc=0;$Tc<$TM;$Tc++)$Tf[$Tc]=$Tt[$Tc];this._byteLength+=2*$TM,this._checkArrayUse()},$Tf.appendEx=function($Tt,$TM){this._upload=!0;var $Tf;$Tf=$Tt.byteLength,this._resizeBuffer(this._byteLength+$Tf,!0),new $TM(this._buffer,this._byteLength).set($Tt,0),this._byteLength+=$Tf,this._checkArrayUse()},$Tf.appendEx2=function($Tt,$TM,$Tf,$Tc){void 0===$Tc&&($Tc=1),this._upload=!0;var $TD,$To;$TD=$Tf*$Tc,this._resizeBuffer(this._byteLength+$TD,!0),$To=new $TM(this._buffer,this._byteLength);var $TJ=0;for($TJ=0;$TJ<$Tf;$TJ++)$To[$TJ]=$Tt[$TJ];this._byteLength+=$TD,this._checkArrayUse()},$Tf.getBuffer=function(){return this._buffer},$Tf.setNeedUpload=function(){this._upload=!0},$Tf.getNeedUpload=function(){return this._upload},$Tf.upload=function(){var $Tt=this._bind_upload();return $Tkt._gl.bindBuffer(this._bufferType,null),$Tkt._bindActive[this._bufferType]=null,$Tut.activeShader=null,$Tt},$Tf.subUpload=function($Tt,$TM,$Tf){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0);var $Tc=this._bind_subUpload();return $Tkt._gl.bindBuffer(this._bufferType,null),$Tkt._bindActive[this._bufferType]=null,$Tut.activeShader=null,$Tc},$Tf.disposeResource=function(){$Tt.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$Tf.clear=function(){this._byteLength=0,this._upload=!0},$Tc(0,$Tf,"bufferLength",function(){return this._buffer.byteLength}),$Tc(0,$Tf,"byteLength",null,function($Tt){this._byteLength!==$Tt&&($Tt<=this._buffer.byteLength||this._resizeBuffer(2*$Tt+256,!0),this._byteLength=$Tt)}),$TM.__int__=function($Tt){$Twt.QuadrangleIB=$Twt.create(35044),$T_t.fillIBQuadrangle($Twt.QuadrangleIB,16)},$TM.FLOAT32=4,$TM.SHORT=2,$TM}($Tkt),$Tat=(function($TM){function $Tf($Tt){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$Tf.__super.call(this,9)}$Tb($Tf,"laya.webgl.shader.d2.value.GlowSV",$TM);var $Tt=$Tf.prototype;$Tt.setValue=function($Tt){$TM.prototype.setValue.call(this,$Tt)},$Tt.clear=function(){$TM.prototype.clear.call(this)}}($T$t),function($Tt){function $TM($Tt){$TM.__super.call(this,64),this.defines.add(64)}$Tb($TM,"laya.webgl.shader.d2.value.TextSV",$Tt);var $Tf=$TM.prototype;return $Tf.release=function(){($TM.pool[$TM._length++]=this).clear()},$Tf.clear=function(){$Tt.prototype.clear.call(this)},$TM.create=function(){return $TM._length?$TM.pool[--$TM._length]:new $TM(null)},$TM.pool=[],$TM._length=0,$TM}($T$t)),$TQt=function($Tt){function $TD($Tt,$TM,$Tf,$Tc){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$TD.__super.call(this,$Tt,$TM,$Tf,$Tc)}$Tb($TD,"laya.webgl.shader.d2.Shader2X",$Tt);var $TM=$TD.prototype;return $TM.upload2dQuick1=function($Tt){this.upload($Tt,this._params2dQuick1||this._make2dQuick1())},$TM._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $Tt,$TM=this._params,$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)$Tt=$TM[$Tf],($TE.isFlash||"size"!==$Tt.name&&"position"!==$Tt.name&&"texcoord"!==$Tt.name)&&this._params2dQuick1.push($Tt)}return this._params2dQuick1},$TM.disposeResource=function(){$Tt.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$TM.upload2dQuick2=function($Tt){this.upload($Tt,this._params2dQuick2||this._make2dQuick2())},$TM._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $Tt,$TM=this._params,$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)$Tt=$TM[$Tf],($TE.isFlash||"size"!==$Tt.name)&&this._params2dQuick2.push($Tt)}return this._params2dQuick2},$TD.create=function($Tt,$TM,$Tf,$Tc){return new $TD($Tt,$TM,$Tf,$Tc)},$TD}($Tmt),$Twt=function($Tt){function $TM($Tt){this._uint8Array=null,this._uint16Array=null,void 0===$Tt&&($Tt=35044),$TM.__super.call(this),this._bufferUsage=$Tt,this._bufferType=34963,$TE.isFlash||(this._buffer=new ArrayBuffer(8))}$Tb($TM,"laya.webgl.utils.IndexBuffer2D",$TGt);var $Tf=$TM.prototype;return $Tf._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$Tf.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$Tf.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$Tf.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$TM.QuadrangleIB=null,$TM.create=function($Tt){return void 0===$Tt&&($Tt=35044),new $TM($Tt)},$TM}(),$TWt=function($Tt){function $Tf($Tt,$TM){this._floatArray32=null,this._vertexStride=0,$Tf.__super.call(this),this._vertexStride=$Tt,this._bufferUsage=$TM,this._bufferType=34962,$TE.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$Tb($Tf,"laya.webgl.utils.VertexBuffer2D",$Tt);var $TM=$Tf.prototype;return $TM.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$TM.bind=function($Tt){$Tt&&$Tt._bind(),this._bind()},$TM.insertData=function($Tt,$TM){this.getFloat32Array().set($Tt,$TM),this._upload=!0},$TM.bind_upload=function($Tt){$Tt._bind_upload()||$Tt._bind(),this._bind_upload()||this._bind()},$TM._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$TM.disposeResource=function(){$Tt.prototype.disposeResource.call(this)},$TM.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$Tc(0,$TM,"vertexStride",function(){return this._vertexStride}),$Tf.create=function($Tt,$TM){return void 0===$TM&&($TM=35048),new $Tf($Tt,$TM)},$Tf}($TGt),$TtM=function($Tt){function $TZ($Tt,$TM,$Tf,$Tc,$TD,$To){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=!0),$TZ.__super.call(this,$Tt,$TM),$Tt){if(this._format=$Tf,this._mipmap=$Tc,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $Tt)this._url=$Tt,this._src=$Tt,this._image=new $TI.window.Image,$TM&&($TM.onload&&(this.onload=$TM.onload),$TM.onerror&&(this.onerror=$TM.onerror),$TM.onCreate&&$TM.onCreate(this)),this._image.crossOrigin=$Tt&&0==$Tt.indexOf("data:")?null:"",$Tt&&(this._image.src=$Tt);else if($Tt instanceof ArrayBuffer){this._src=$TM,this._url=this._src;var $TJ=new $TA($Tt);$TJ.readUTFBytes(4),$TJ.readUTFBytes(2),$TJ.getInt16();$TJ.endian="bigEndian",this._w=$TJ.getInt16(),this._h=$TJ.getInt16();$TJ.getInt16(),$TJ.getInt16();this._image=new Uint8Array($Tt,$TJ.pos),this._format=$TXt.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$Td.enabled&&this._w<$Td.atlasLimitWidth&&this._h<$Td.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($Tt instanceof Uint8Array))return this._src=$TM,this._url=this._src,this._image=$Tt.source||$Tt,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$TM,this._url=this._src,this._w=$TD,this._h=$To,this._image=$Tt,this._format=0===$Tf?$Tt.byteLength/($TD*$To)==4?6408:6407:$Tf}this._$5__enableMerageInAtlas=!0}}$Tb($TZ,"laya.webgl.resource.WebGLImage",$Tl);var $TM=$TZ.prototype;return $Th.imps($TM,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$TM._init_=function($Tt,$TM){},$TM._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $Tt=$TXt.mainContext,$TM=this._source=$Tt.createTexture(),$Tf=$Tyt.curBindTexTarget,$Tc=$Tyt.curBindTexValue;$Tyt.bindTexture($Tt,3553,$TM);var $TD=this.minFifter,$To=this.magFifter,$TJ=this.repeat?10497:33071,$TZ=$Tp.isPOT(this._w,this._h),$TA=!1;switch($TZ?(this.mipmap?-1!==$TD||($TD=9987):-1!==$TD||($TD=9729),-1!==$To||($To=9729),$Tt.texParameteri(3553,10241,$TD),$Tt.texParameteri(3553,10240,$To),$Tt.texParameteri(3553,10242,$TJ),$Tt.texParameteri(3553,10243,$TJ),this.mipmap&&$Tt.generateMipmap(3553)):(-1!==$TD||($TD=9729),-1!==$To||($To=9729),$Tt.texParameteri(3553,10241,$TD),$Tt.texParameteri(3553,10240,$To),$Tt.texParameteri(3553,10242,33071),$Tt.texParameteri(3553,10243,33071)),$Tt.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$Tt.pixelStorei($Tt.UNPACK_ALIGNMENT,1),$Tt.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$Tt.pixelStorei($Tt.UNPACK_ALIGNMENT,1),$Tt.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$TA=!0,$Tt.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $TXt.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$TA=!0,$Tt.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$Tt.pixelStorei(37441,!1),$Tf&&$Tc&&$Tyt.bindTexture($Tt,$Tf,$Tc),this.uri||(this.uri=this._url),$TA?this.memorySize=this._image.length:$TZ&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$TM.recreateResource=function(){var $Tt=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $TM=this;this._image=new $TI.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($TM._needReleaseAgain)return $TM._needReleaseAgain=!1,$TM._image.onload=null,void($TM._image=null);$TM._allowMerageInAtlas&&$TM._enableMerageInAtlas?($Tt.memorySize=0,$Tt._recreateLock=!1):$TM._createWebGlTexture(),$TM.completeCreate()},this._image.src=this._src}},$TM.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$TXt.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$TM.onresize=function(){this._w=this._image.width,this._h=this._image.height,$Td.enabled&&this._w<$Td.atlasLimitWidth&&this._h<$Td.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$TM.clearAtlasSource=function(){this._image=null},$Tc(0,$TM,"format",function(){return this._format}),$Tc(0,$TM,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($Tt){this._$5__enableMerageInAtlas=$Tt}),$Tc(0,$TM,"mipmap",function(){return this._mipmap}),$Tc(0,$TM,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Tc(0,$TM,"atlasSource",function(){return this._image}),$Tc(0,$TM,"onload",null,function($Tt){var $TM=this;this._onload=$Tt,this._image&&(this._image.onload=null!=this._onload?function(){$TM.onresize(),$TM._onload()}:null)}),$Tc(0,$TM,"onerror",null,function($Tt){var $TM=this;this._onerror=$Tt,this._image&&(this._image.onerror=null!=this._onerror?function(){$TM._onerror()}:null)}),$TZ}();$Th.__init([$TIt,$Tj,$TTt,$TNt])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}}),function($To,$Tt,$Tc){$Tc.un,$Tc.uns;var $TD=$Tc.static,$TJ=$Tc.class,$TZ=$Tc.getset,$TA=($Tc.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$Tq=laya.utils.ClassUtils,$TB=(laya.events.Event,laya.utils.HTMLChar),$TL=laya.net.Loader,$Tp=(laya.display.Node,laya.maths.Rectangle),$Tb=laya.renders.Render,$TI=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$Tl=laya.utils.Stat,$Tu=laya.display.Text,$T_=laya.resource.Texture,$TE=laya.net.URL,$Te=laya.utils.Utils,$TN=function(){function $TI(){}return $TJ($TI,"laya.html.utils.HTMLParse"),$TI.parse=function($Tt,$TM,$Tf){$TM=($TM="<root>"+($TM=$TM.replace(/<br>/g,"<br/>"))+"</root>").replace($TI.spacePattern,$TI.char255);var $Tc=$Te.parseXMLFromString($TM);$TI._parseXML($Tt,$Tc.childNodes[0].childNodes,$Tf)},$TI._parseXML=function($Tt,$TM,$Tf,$Tc){var $TD=0,$To=0;if($TM.join||$TM.item)for($TD=0,$To=$TM.length;$TD<$To;++$TD)$TI._parseXML($Tt,$TM[$TD],$Tf,$Tc);else{var $TJ,$TZ,$TA;if(3==$TM.nodeType)return void($Tt instanceof laya.html.dom.HTMLDivElement?(null==$TM.nodeName&&($TM.nodeName="#text"),$TZ=$TM.nodeName.toLowerCase(),0<($TA=$TM.textContent.replace(/^\s+|\s+$/g,"")).length&&($TJ=$Tq.getInstance($TZ))&&($Tt.addChild($TJ),$TJ.innerTEXT=$TA.replace($TI.char255AndOneSpacePattern," "))):0<($TA=$TM.textContent.replace(/^\s+|\s+$/g,"")).length&&($Tt.innerTEXT=$TA.replace($TI.char255AndOneSpacePattern," ")));if("#comment"==($TZ=$TM.nodeName.toLowerCase()))return;if($TJ=$Tq.getInstance($TZ)){($TJ=$Tt.addChild($TJ)).URI=$Tf,$TJ.href=$Tc;var $TL=$TM.attributes;if($TL&&0<$TL.length)for($TD=0,$To=$TL.length;$TD<$To;++$TD){var $Tp=$TL[$TD],$TB=$Tp.nodeName,$Tb=$Tp.value;$TJ._setAttributes($TB,$Tb)}$TI._parseXML($TJ,$TM.childNodes,$Tf,$TJ.href)}else $TI._parseXML($Tt,$TM.childNodes,$Tf,$Tc)}},$TI.char255=String.fromCharCode(255),$TI.spacePattern=/&nbsp;|&#160;/g,$TI.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$TI}(),$TX=function(){function $Tr(){}return $TJ($Tr,"laya.html.utils.Layout"),$Tr.later=function($Tt){null==$Tr._will&&($Tr._will=[],$Tc.stage.frameLoop(1,null,function(){if(!($Tr._will.length<1)){for(var $Tt=0;$Tt<$Tr._will.length;$Tt++)laya.html.utils.Layout.layout($Tr._will[$Tt]);$Tr._will.length=0}})),$Tr._will.push($Tt)},$Tr.layout=function($Tt){if(!$Tt||!$Tt._style)return null;if(0==(512&$Tt._style._type))return null;$Tt.getStyle()._type&=-513;var $TM=$Tr._multiLineLayout($Tt);return $Tb.isConchApp&&$Tt.layaoutCallNative&&$Tt.layaoutCallNative(),$TM},$Tr._multiLineLayout=function($Tt){if($Tu.RightToLeft)return $Tr._multiLineLayout2($Tt);var $TM=new Array;$Tt._addChildsToLayout($TM);var $Tf,$Tc,$TD,$To,$TJ,$TZ=0,$TA=$TM.length,$TL=$Tt._getCSSStyle(),$Tp=$TL.letterSpacing,$TB=$TL.leading,$Tb=$TL.lineHeight,$TI=$TL._widthAuto()||!$TL.wordWrap,$Tq=$TI?999999:$Tt.width,$Tl=($Tt.height,0),$T_=$TL.italic?$TL.fontSize/3:0,$TE=$TL._getAlign(),$Te=$TL._getValign(),$TN=0!==$Te||0!==$TE||0!=$Tb,$TX=0,$Ty=0,$Th=0,$TT=0,$Ti=new Array,$TV=$Ti[0]=new $Tv,$Tx=!1,$TO=!1;$TV.h=0,$TL.italic&&($Tq-=$TL.fontSize/3);var $TC=0,$TU=!0;function $TF(){$TV.y=$Ty,$Ty+=$TV.h+$TB,0==$TV.h&&($Ty+=$Tb),$TV.mWidth=$TC,$TC=0,$TV=new $Tv,$Ti.push($TV),$TV.h=0,$Tx=!($TU=!($TX=0))}for($TZ=0;$TZ<$TA;$TZ++)if(null!=($Tf=$TM[$TZ]))if($TU=!1,$Tf instanceof laya.html.dom.HTMLBrElement)$TF(),$TV.y=$Ty;else{if($Tf._isChar()){if(($To=$Tf).isWord)$Tx=$TO||"\n"===$To.char,$TV.wordStartIndex=$TV.elements.length;else{if($Th=$To.width+$To.style.letterSpacin,0<$Ti.length&&$Tq<$TX+$Th&&0<$TV.wordStartIndex){var $TS;$TS=$TV.elements.length-$TV.wordStartIndex+1,$TV.elements.length=$TV.wordStartIndex,$TZ-=$TS,$TF();continue}$Tx=!1,$TC+=$To.width}$Th=$To.width+$Tp,$TT=$To.height,$TO=!1,($Tx=$Tx||$Tq<$TX+$Th)&&$TF(),$TV.minTextHeight=Math.min($TV.minTextHeight,$Tf.height)}else $Tc=$Tf._getCSSStyle(),$TJ=$Tf,$TD=$Tc.padding,0===$Tc._getCssFloat()||($TN=!0),$Tx=$TO||$Tc.lineElement,$Th=$TJ.width*$TJ._style._tf.scaleX+$TD[1]+$TD[3]+$Tp,$TT=$TJ.height*$TJ._style._tf.scaleY+$TD[0]+$TD[2],$TO=$Tc.lineElement,($Tx=$Tx||$Tq<$TX+$Th&&$Tc.wordWrap)&&$TF();$TV.elements.push($Tf),$TV.h=Math.max($TV.h,$TT),$Tf.x=$TX,$Tf.y=$Ty,$TX+=$Th,$TV.w=$TX-$Tp,$TV.y=$Ty,$Tl=Math.max($TX+$T_,$Tl)}else $TU||($TX+=$Tr.DIV_ELEMENT_PADDING),$TV.wordStartIndex=$TV.elements.length;if($Ty=$TV.y+$TV.h,$TN){var $TH=0,$Ts=$Tq;for($TI&&0<$Tt.width&&($Ts=$Tt.width),$TZ=0,$TA=$Ti.length;$TZ<$TA;$TZ++)$Ti[$TZ].updatePos(0,$Ts,$TZ,$TH,$TE,$Te,$Tb),$TH+=Math.max($Tb,$Ti[$TZ].h+$TB);$Ty=$TH}return $TI&&($Tt.width=$Tl),$Ty>$Tt.height&&($Tt.height=$Ty),[$Tl,$Ty]},$Tr._multiLineLayout2=function($Tt){var $TM=new Array;$Tt._addChildsToLayout($TM);var $Tf,$Tc,$TD,$To,$TJ,$TZ=0,$TA=$TM.length,$TL=$Tt._getCSSStyle(),$Tp=$TL.letterSpacing,$TB=$TL.leading,$Tb=$TL.lineHeight,$TI=$TL._widthAuto()||!$TL.wordWrap,$Tq=$TI?999999:$Tt.width,$Tl=($Tt.height,0),$T_=$TL.italic?$TL.fontSize/3:0,$TE=2-$TL._getAlign(),$Te=$TL._getValign(),$TN=0!==$Te||0!=$TE||0!=$Tb,$TX=0,$Ty=0,$Th=0,$TT=0,$Ti=new Array,$TV=$Ti[0]=new $Tv,$Tx=!1,$TO=!1;$TV.h=0,$TL.italic&&($Tq-=$TL.fontSize/3);var $TC=0,$TU=!0;function $TF(){$TV.y=$Ty,$Ty+=$TV.h+$TB,0==$TV.h&&($Ty+=$Tb),$TV.mWidth=$TC,$TC=0,$TV=new $Tv,$Ti.push($TV),$TV.h=0,$Tx=!($TU=!($TX=0))}for($TZ=0;$TZ<$TA;$TZ++)if(null!=($Tf=$TM[$TZ]))if($TU=!1,$Tf instanceof laya.html.dom.HTMLBrElement)$TF(),$TV.y=$Ty;else{if($Tf._isChar()){if(($To=$Tf).isWord)$Tx=$TO||"\n"===$To.char,$TV.wordStartIndex=$TV.elements.length;else{if(0<$Ti.length&&$Tq<$TX+$Th&&0<$TV.wordStartIndex){var $TS;$TS=$TV.elements.length-$TV.wordStartIndex+1,$TV.elements.length=$TV.wordStartIndex,$TZ-=$TS,$TF();continue}$Tx=!1,$TC+=$To.width}$Th=$To.width+$Tp,$TT=$To.height,$TO=!1,($Tx=$Tx||$Tq<$TX+$Th)&&$TF(),$TV.minTextHeight=Math.min($TV.minTextHeight,$Tf.height)}else $Tc=$Tf._getCSSStyle(),$TJ=$Tf,$TD=$Tc.padding,0===$Tc._getCssFloat()||($TN=!0),$Tx=$TO||$Tc.lineElement,$Th=$TJ.width*$TJ._style._tf.scaleX+$TD[1]+$TD[3]+$Tp,$TT=$TJ.height*$TJ._style._tf.scaleY+$TD[0]+$TD[2],$TO=$Tc.lineElement,($Tx=$Tx||$Tq<$TX+$Th&&$Tc.wordWrap)&&$TF();$TV.elements.push($Tf),$TV.h=Math.max($TV.h,$TT),$Tf.x=$TX,$Tf.y=$Ty,$TX+=$Th,$TV.w=$TX-$Tp,$TV.y=$Ty,$Tl=Math.max($TX+$T_,$Tl)}else $TU||($TX+=$Tr.DIV_ELEMENT_PADDING),$TV.wordStartIndex=$TV.elements.length;if($Ty=$TV.y+$TV.h,$TN){var $TH=0,$Ts=$Tq;for($TZ=0,$TA=$Ti.length;$TZ<$TA;$TZ++)$Ti[$TZ].updatePos(0,$Ts,$TZ,$TH,$TE,$Te,$Tb),$TH+=Math.max($Tb,$Ti[$TZ].h+$TB);$Ty=$TH}for($TI&&($Tt.width=$Tl),$Ty>$Tt.height&&($Tt.height=$Ty),$TZ=0,$TA=$Ti.length;$TZ<$TA;$TZ++)$Ti[$TZ].revertOrder($Tq);return[$Tl,$Ty]},$Tr._will=null,$Tr.DIV_ELEMENT_PADDING=0,$Tr}(),$Tv=function(){function $Tt(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$TJ($Tt,"laya.html.utils.LayoutLine");var $TM=$Tt.prototype;return $TM.updatePos=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ,$TA=0;0<this.elements.length&&($TA=($TZ=this.elements[this.elements.length-1]).x+$TZ.width-this.elements[0].x);var $TL=0,$Tp=NaN;1===$TD&&($TL=($TM-$TA)/2),2===$TD&&($TL=$TM-$TA),0===$TJ||0!=$To||($To=1);for(var $TB=0,$Tb=this.elements.length;$TB<$Tb;$TB++){var $TI=($TZ=this.elements[$TB])._getCSSStyle();switch(0!==$TL&&($TZ.x+=$TL),$TI._getValign()){case 0:$TZ.y=$Tc;break;case 1:var $Tq=0;99999!=this.minTextHeight&&($Tq=this.minTextHeight);var $Tl=($Tq+$TJ)/2;$Tl=Math.max($Tl,this.h),$Tp=(laya.html.dom.HTMLImageElement,$Tc+$Tl-$TZ.height),$TZ.y=$Tp;break;case 2:$TZ.y=$Tc+($TJ-$TZ.height)}}},$TM.revertOrder=function($Tt){var $TM;if(0<this.elements.length){var $Tf,$Tc=0;for($Tf=this.elements.length,$Tc=0;$Tc<$Tf;$Tc++)($TM=this.elements[$Tc]).x=$Tt-$TM.x-$TM.width}},$Tt}(),$Ty=function($Tf){function $TM(){this.URI=null,this._href=null,$TM.__super.call(this),this._text=$TM._EMPTYTEXT,this.setStyle(new $TA(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$TJ($TM,"laya.html.dom.HTMLElement",$Tf);var $Tt=$TM.prototype;return $Tt.layaoutCallNative=function(){var $Tt=0;if(this._childs&&0<($Tt=this._childs.length))for(var $TM=0;$TM<$Tt;$TM++)this._childs[$TM].layaoutCallNative&&this._childs[$TM].layaoutCallNative();var $Tf=this._getWords();$Tf?laya.html.dom.HTMLElement.fillWords(this,$Tf,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$Tt.appendChild=function($Tt){return this.addChild($Tt)},$Tt._getWords2=function(){var $Tt=this._text.text;if(!$Tt||0===$Tt.length)return null;var $TM,$Tf,$Tc=0,$TD=0;if(this._text.drawWords)$Tf=this._text.drawWords;else{for($TD=($TM=$Tt.split(" ")).length-1,$Tf=[],$Tc=0;$Tc<$TD;$Tc++)$Tf.push($TM[$Tc]," ");0<=$TD&&$Tf.push($TM[$TD]),this._text.drawWords=$Tf}var $To,$TJ=this._text.words;if($TJ&&$TJ.length===$Tf.length)return $TJ;null===$TJ&&(this._text.words=$TJ=[]),$TJ.length=$Tf.length;var $TZ=this.style,$TA=$TZ.font;for($Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++){$To=$Te.measureText($Tf[$Tc],$TA);var $TL=$TJ[$Tc]=new $TB($Tf[$Tc],$To.width,$To.height||$TZ.fontSize,$TZ);if(1<$TL.char.length&&($TL.charNum=$TL.char),this.href){var $Tp=new $TI;this.addChild($Tp),$TL.setSprite($Tp)}}return $TJ},$Tt._getWords=function(){if(!$Tu.CharacterCache)return this._getWords2();var $Tt=this._text.text;if(!$Tt||0===$Tt.length)return null;var $TM,$Tf=this._text.words;if($Tf&&$Tf.length===$Tt.length)return $Tf;null===$Tf&&(this._text.words=$Tf=[]),$Tf.length=$Tt.length;for(var $Tc=this.style,$TD=$Tc.font,$To=0,$TJ=$Tt.length;$To<$TJ;$To++)if($TM=$Te.measureText($Tt.charAt($To),$TD)){var $TZ=$Tf[$To]=new $TB($Tt.charAt($To),$TM.width,$TM.height||$Tc.fontSize,$Tc);if(this.href){var $TA=new $TI;this.addChild($TA),$TZ.setSprite($TA)}}else console.warn("_getWords size is null"+$Tt.charAt($To),$TD);return $Tf},$Tt.showLinkSprite=function(){var $Tt=this._text.words;if($Tt)for(var $TM,$Tf,$Tc=[],$TD=0;$TD<$Tt.length;$TD++)$Tf=$Tt[$TD],($TM=new $TI).graphics.drawRect(0,0,$Tf.width,$Tf.height,"#ff0000"),$TM.width=$Tf.width,$TM.height=$Tf.height,this.addChild($TM),$Tc.push($TM)},$Tt._layoutLater=function(){var $Tt=this.style;512&$Tt._type||($Tt.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$Tt.block?($TX.later(this),$Tt._type|=512):this.parent&&this.parent._layoutLater())},$Tt._setAttributes=function($Tt,$TM){switch($Tt){case"style":return void this.style.cssText($TM);case"class":return void(this.className=$TM)}$Tf.prototype._setAttributes.call(this,$Tt,$TM)},$Tt.updateHref=function(){if(null!=this._href){var $Tt=this._getWords();if($Tt)for(var $TM,$Tf,$Tc=0;$Tc<$Tt.length;$Tc++)($Tf=($TM=$Tt[$Tc]).getSprite())&&($Tf.size($TM.width,$TM.height),$Tf.on("click",this,this.onLinkHandler))}},$Tt.onLinkHandler=function($Tt){switch($Tt.type){case"click":for(var $TM=this;$TM;)$TM.event("link",[this.href]),$TM=$TM.parent}},$Tt.formatURL=function($Tt){return this.URI?$TE.formatURL($Tt,this.URI?this.URI.path:null):$Tt},$TZ(0,$Tt,"href",function(){return this._href},function($Tt){null!=(this._href=$Tt)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$TZ(0,$Tt,"color",null,function($Tt){this.style.color=$Tt}),$TZ(0,$Tt,"onClick",null,function($Tt){$Tc._runScript("fn=function(event){"+$Tt+";}"),this.on("click",this,void 0)}),$TZ(0,$Tt,"id",null,function($Tt){$Th.document.setElementById($Tt,this)}),$TZ(0,$Tt,"innerTEXT",function(){return this._text.text},function($Tt){this.text=$Tt}),$TZ(0,$Tt,"style",function(){return this._style}),$TZ(0,$Tt,"text",function(){return this._text.text},function($Tt){this._text==$TM._EMPTYTEXT?this._text={text:$Tt,words:null}:(this._text.text=$Tt,this._text.words&&(this._text.words.length=0)),$Tb.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$TZ(0,$Tt,"parent",$Tf.prototype._$get_parent,function($Tt){if($Tt instanceof laya.html.dom.HTMLElement){var $TM=$Tt;this.URI||(this.URI=$TM.URI),this.style.inherit($TM.style)}$Tc.superSet($TI,this,"parent",$Tt)}),$TZ(0,$Tt,"className",null,function($Tt){this.style.attrs($Th.document.styleSheets["."+$Tt])}),$TM.fillWords=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tt.graphics.clear();for(var $TZ=0,$TA=$TM.length;$TZ<$TA;$TZ++){var $TL=$TM[$TZ];$Tt.graphics.fillText($TL.char,$TL.x+$Tf,$TL.y+$Tc,$TD,$To,"left",$TJ)}},$TM._EMPTYTEXT={text:null,words:null},$TM}($TI),$TM=(function($Tt){function $TM(){$TM.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$TJ($TM,"laya.html.dom.HTMLBrElement",$Ty)}(),function($Tt){function $TM(){this.contextHeight=NaN,this.contextWidth=NaN,$TM.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$TJ($TM,"laya.html.dom.HTMLDivElement",$Tt);var $Tf=$TM.prototype;return $Tf.appendHTML=function($Tt){$TN.parse(this,$Tt,this.URI),this.layout()},$Tf._addChildsToLayout=function($TM){var $Tt=this._getWords();if(null==$Tt&&0==this._childs.length)return!1;$Tt&&$Tt.forEach(function($Tt){$TM.push($Tt)});for(var $Tf=!0,$Tc=0,$TD=this._childs.length;$Tc<$TD;$Tc++){var $To=this._childs[$Tc];$Tf?$Tf=!1:$TM.push(null),$To._addToLayout($TM)}return!0},$Tf._addToLayout=function($Tt){this.layout()},$Tf.layout=function(){if(this.style){this.style._type|=512;var $Tt=$TX.layout(this);if($Tt){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $Tp);var $TM=this._$P.mHtmlBounds;$TM.x=$TM.y=0,$TM.width=this.contextWidth=$Tt[0],$TM.height=this.contextHeight=$Tt[1],this.setBounds($TM)}}},$TZ(0,$Tf,"height",function(){return this._height?this._height:this.contextHeight},$Tt.prototype._$set_height),$TZ(0,$Tf,"innerHTML",null,function($Tt){this.destroyChildren(),this.appendHTML($Tt)}),$TZ(0,$Tf,"width",function(){return this._width?this._width:this.contextWidth},function($Tt){var $TM=!1;$TM=0===$Tt?$Tt!=this._width:$Tt!=this.width,$Tc.superSet($Ty,this,"width",$Tt),$TM&&this.layout()}),$TM}($Ty)),$Th=function($Tt){function $TM(){this.all=new Array,this.styleSheets=$TA.styleSheets,$TM.__super.call(this)}$TJ($TM,"laya.html.dom.HTMLDocument",$Ty);var $Tf=$TM.prototype;return $Tf.getElementById=function($Tt){return this.all[$Tt]},$Tf.setElementById=function($Tt,$TM){this.all[$Tt]=$TM},$TD($TM,["document",function(){return this.document=new $TM}]),$TM}();(function($Tt){function $TM(){this._tex=null,this._url=null,this._renderArgs=[],$TM.__super.call(this),this.style.block=!0}$TJ($TM,"laya.html.dom.HTMLImageElement",$Ty);var $Tf=$TM.prototype;$Tf._addToLayout=function($Tt){!this._style.absolute&&$Tt.push(this)},$Tf.render=function($Tt,$TM,$Tf){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($Tl.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$Tt.ctx.drawTexture2($TM,$Tf,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$Tf.layaoutCallNative=function(){var $Tt=0;if(this._childs&&0<($Tt=this._childs.length))for(var $TM=0;$TM<$Tt;$TM++)this._childs[$TM].layaoutCallNative&&this._childs[$TM].layaoutCallNative()},$TZ(0,$Tf,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($Tt){this._width!==$Tt&&(this._width=$Tt,this._style.width=$Tt,this.repaint())}),$TZ(0,$Tf,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($Tt){this._height!==$Tt&&(this._height=$Tt,this._style.height=$Tt,this.repaint())}),$Tf.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$TL.clearCache(this,this._url),this._tex=null),$Ty.prototype.destroy.call(this)},$Tf.onloaded=function(){var $Tt=this._style;$Tt&&!$Tt.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$Tt&&!$Tt.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$Tb.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$Tf._loadImageComplete=function($Tt,$TM,$Tf){if(!this._destroyed)if(null!=$Tf)if($Tf instanceof ArrayBuffer){var $Tc=new DataView($Tf);new laya.webgl.resource.WebGLImage(new Uint8Array($Tf,8),$Tt,0,!1,$Tc.getUint32(0),$Tc.getUint32(4));this.onloaded()}else if($Tf instanceof $T_)$TL.imgMgrSet[$Tt]=$TM,$To.imgMgrLock($Tt,$TL.imgMgrSet[$Tt]),this._url=$Tt,this._tex=$Tf,$TL.keepCache(this,$Tt),$TL.cacheRes($Tt,this._tex),this.onloaded();else{var $TD=-1!=$Tt.indexOf(".png",$Tt.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($Tf,$Tt,$TD,!1,$Tf.width,$Tf.height);this.onloaded()}else this.event("error","Load image failed")},$TZ(0,$Tf,"src",null,function($Tt){($Tt=this.formatURL($Tt),this._url!=$Tt)&&(null!=this._tex&&($TL.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$Tt,(this._tex=$TL.getRes($Tt))?($TL.keepCache(this,$Tt),this.onloaded()):$To.imgMgrLoad($Tt,this._loadImageComplete.bind(this),2,!1))})})(),function($Tt){function $TM(){this.type=null,$TM.__super.call(this),this.visible=!1}$TJ($TM,"laya.html.dom.HTMLLinkElement",$Tt);var $Tf=$TM.prototype;$Tf._onload=function($Tt){switch(this.type){case"text/css":$TA.parseCSS($Tt,this.URI)}},$TZ(0,$Tf,"href",$Tt.prototype._$get_href,function($Tt){var $TM=this;$Tt=this.formatURL($Tt),this.URI=new $TE($Tt);var $Tf=new $TL;$Tf.once("complete",null,function($Tt){$TM._onload($Tt)}),$Tf.load($Tt,"text")}),$TM._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($Ty),function($Tt){function $TM(){$TM.__super.call(this),this.visible=!1}$TJ($TM,"laya.html.dom.HTMLStyleElement",$Tt),$TZ(0,$TM.prototype,"text",$Tt.prototype._$get_text,function($Tt){$TA.parseCSS($Tt,null)})}($Ty),function($Tt){function $TM(){$TM.__super.call(this),this._getCSSStyle().valign="middle"}$TJ($TM,"laya.html.dom.HTMLIframeElement",$Tt),$TZ(0,$TM.prototype,"href",$Tt.prototype._$get_href,function($Tf){var $Tc=this;$Tf=this.formatURL($Tf);var $Tt=new $TL;$Tt.once("complete",null,function($Tt){var $TM=$Tc.URI;$Tc.URI=new $TE($Tf),$Tc.innerHTML=$Tt,!$TM||($Tc.URI=$TM)}),$Tt.load($Tf,"text")})}($TM)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}}),function($TD,$Tt,$Tl){$Tl.un,$Tl.uns;var $Tc=$Tl.static,$To=$Tl.class,$TJ=$Tl.getset,$Tf=($Tl.__newvec,laya.display.Animation),$T_=(laya.utils.Browser,laya.utils.ClassUtils),$TZ=laya.filters.ColorFilter,$TA=laya.utils.Ease,$TL=laya.events.Event,$Tp=(laya.events.EventDispatcher,laya.display.css.Font),$TB=laya.display.FrameAnimation,$TM=laya.display.Graphics,$Tb=laya.utils.Handler,$TI=laya.display.Input,$Te=laya.net.Loader,$Tq=(laya.display.Node,laya.maths.Point),$TE=laya.maths.Rectangle,$TN=laya.renders.Render,$TX=laya.display.Sprite,$Ty=laya.display.Text,$Th=laya.resource.Texture,$TT=laya.utils.Tween,$Ti=laya.utils.Utils,$TV=laya.utils.WeakObject;$Tl.interface("laya.ui.IItem"),$Tl.interface("laya.ui.ISelect"),$Tl.interface("laya.ui.IRender"),$Tl.interface("laya.ui.IComponent"),$Tl.interface("laya.ui.IBox","IComponent");var $Tx=function(){function $Tt(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $To($Tt,"laya.ui.LayoutStyle"),$Tc($Tt,["EMPTY",function(){return this.EMPTY=new $Tt}]),$Tt}(),$TO=function(){function $Tt(){}return $To($Tt,"laya.ui.Styles"),$Tt.labelColor="#000000",$Tt.buttonStateNum=3,$Tt.scrollBarMinNum=15,$Tt.scrollBarDelayTime=500,$Tc($Tt,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$Tt}(),$TC=function(){function $TD(){}return $To($TD,"laya.ui.UIUtils"),$TD.fillArray=function($Tt,$TM,$Tf){var $Tc=$Tt.concat();if($TM)for(var $TD=$TM.split(","),$To=0,$TJ=Math.min($Tc.length,$TD.length);$To<$TJ;$To++){var $TZ=$TD[$To];$Tc[$To]="true"==$TZ||"false"!=$TZ&&$TZ,null!=$Tf&&($Tc[$To]=$Tf($TZ))}return $Tc},$TD.toColor=function($Tt){return $Ti.toHexColor($Tt)},$TD.gray=function($Tt,$TM){void 0===$TM&&($TM=!0),$TM?$TD.addFilter($Tt,$TD.grayFilter):$TD.clearFilter($Tt,$TZ)},$TD.addFilter=function($Tt,$TM){var $Tf=$Tt.filters||[];$Tf.push($TM),$Tt.filters=$Tf},$TD.clearFilter=function($Tt,$TM){var $Tf=$Tt.filters;if(null!=$Tf&&0<$Tf.length){for(var $Tc=$Tf.length-1;-1<$Tc;$Tc--){var $TD=$Tf[$Tc];$Tl.__typeof($TD,$TM)&&$Tf.splice($Tc,1)}$Tt.filters=$Tf}},$TD._getReplaceStr=function($Tt){return $TD.escapeSequence[$Tt]},$TD.adptString=function($Tt){return $Tt.replace(/\\(\w)/g,$TD._getReplaceStr)},$TD.getBindFun=function($Tt){var $TM=$TD._funMap.get($Tt);if(null==$TM){var $Tf='"'+$Tt+'"',$Tc="(function(data){if(data==null)return;with(data){try{\nreturn "+($Tf=$Tf.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$TM=$Tl._runScript($Tc),$TD._funMap.set($Tt,$TM)}return $TM},$Tc($TD,["grayFilter",function(){return this.grayFilter=new $TZ([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $TV}]),$TD}(),$TU=function(){function $Tt(){}return $To($Tt,"UIConfig"),$Tt.touchScrollEnable=!0,$Tt.mouseWheelEnable=!0,$Tt.showButtons=!0,$Tt.popupBgColor="#000000",$Tt.popupBgAlpha=.5,$Tt.closeDialogOnSide=!0,$Tt}(),$TF=function($Tf){function $TE(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$TE.__super.call(this),this._weakKeys=[]}$To($TE,"laya.ui.AutoBitmap",$Tf);var $Tt=$TE.prototype;return $Tt.destroy=function(){if($Te.clearObject(this,this._weakKey),this._weakKeys){for(var $Tt=0,$TM=this._weakKeys.length;$Tt<$TM;++$Tt)$Te.clearObject(this,this._weakKeys[$Tt]);this._weakKeys=null}$Tf.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$Tt._setChanged=function(){this._isChanged||(this._isChanged=!0,$Tl.timer.callLater(this,this.changeSource))},$Tt.changeSource=function(){this._isChanged=!1;var $Tt=this._source;if($Tt&&$Tt.bitmap){var $TM=this.width,$Tf=this.height,$Tc=this._sizeGrid,$TD=$Tt.sourceWidth,$To=$Tt.sourceHeight;if(!$Tc||$TD===$TM&&$To===$Tf)this.cleanByTexture($Tt,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$TM,$Tf);else{$Te.clearObject(this,this._weakKey),$Tt.$_GID||($Tt.$_GID=$Ti.getGID());var $TJ=$Tt.$_GID+"."+$TM+"."+$Tf+"."+$Tc.join("."),$TZ=$Te.findObject($TJ);if($Ti.isOKCmdList($TZ))return this._weakKey=$TJ,$Te.keepObject(this,this._weakKey),void(this.cmds=$TZ);this.clear();var $TA,$TL,$Tp=$Tc[0],$TB=$Tc[1],$Tb=$Tc[2],$TI=$Tc[3],$Tq=$Tc[4],$Tl=!1;if($TM==$TD&&($TI=$TB=0),$Tf==$To&&($Tp=$Tb=0),$TM<$TI+$TB){var $T_=$TM;$Tl=!0,$TM=$TI+$TB,this.save(),this.clipRect(0,0,$T_,$Tf)}$TI&&$Tp&&($TA=$TE.getTexture($Tt,0,0,$TI,$Tp),$TL=this._weakKeys[0],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[0]=$TA.weakKey),this.drawTexture($TA,0,0,$TI,$Tp)):($Te.clearObject(this,$TL),this._weakKeys[0]="")),$TB&&$Tp&&($TA=$TE.getTexture($Tt,$TD-$TB,0,$TB,$Tp),$TL=this._weakKeys[1],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[1]=$TA.weakKey),this.drawTexture($TA,$TM-$TB,0,$TB,$Tp)):($Te.clearObject(this,$TL),this._weakKeys[1]="")),$TI&&$Tb&&($TA=$TE.getTexture($Tt,0,$To-$Tb,$TI,$Tb),$TL=this._weakKeys[2],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[2]=$TA.weakKey),this.drawTexture($TA,0,$Tf-$Tb,$TI,$Tb)):($Te.clearObject(this,$TL),this._weakKeys[2]="")),$TB&&$Tb&&($TA=$TE.getTexture($Tt,$TD-$TB,$To-$Tb,$TB,$Tb),$TL=this._weakKeys[3],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[3]=$TA.weakKey),this.drawTexture($TA,$TM-$TB,$Tf-$Tb,$TB,$Tb)):($Te.clearObject(this,$TL),this._weakKeys[3]="")),$Tp&&($TA=$TE.getTexture($Tt,$TI,0,$TD-$TI-$TB,$Tp),$TL=this._weakKeys[4],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[4]=$TA.weakKey),this.drawBitmap($Tq,$TA,$TI,0,$TM-$TI-$TB,$Tp)):($Te.clearObject(this,$TL),this._weakKeys[4]="")),$Tb&&($TA=$TE.getTexture($Tt,$TI,$To-$Tb,$TD-$TI-$TB,$Tb),$TL=this._weakKeys[5],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[5]=$TA.weakKey),this.drawBitmap($Tq,$TA,$TI,$Tf-$Tb,$TM-$TI-$TB,$Tb)):($Te.clearObject(this,$TL),this._weakKeys[5]="")),$TI&&($TA=$TE.getTexture($Tt,0,$Tp,$TI,$To-$Tp-$Tb),$TL=this._weakKeys[6],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[6]=$TA.weakKey),this.drawBitmap($Tq,$TA,0,$Tp,$TI,$Tf-$Tp-$Tb)):($Te.clearObject(this,$TL),this._weakKeys[6]="")),$TB&&($TA=$TE.getTexture($Tt,$TD-$TB,$Tp,$TB,$To-$Tp-$Tb),$TL=this._weakKeys[7],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[7]=$TA.weakKey),this.drawBitmap($Tq,$TA,$TM-$TB,$Tp,$TB,$Tf-$Tp-$Tb)):($Te.clearObject(this,$TL),this._weakKeys[7]="")),$TA=$TE.getTexture($Tt,$TI,$Tp,$TD-$TI-$TB,$To-$Tp-$Tb),$TL=this._weakKeys[8],$TA?($TL!=$TA.weakKey&&($Te.clearObject(this,$TL),$Te.keepObject(this,$TA.weakKey),this._weakKeys[8]=$TA.weakKey),this.drawBitmap($Tq,$TA,$TI,$Tp,$TM-$TI-$TB,$Tf-$Tp-$Tb)):($Te.clearObject(this,$TL),this._weakKeys[8]=""),$Tl&&this.restore(),this.autoCacheCmd&&!$TN.isConchApp&&($Te.saveObject($TJ,this.cmds,null),this._weakKey=$TJ,$Te.keepObject(this,this._weakKey))}this._repaint()}},$Tt.drawBitmap=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$TD&&($TD=0),void 0===$To&&($To=0),$TD<.1||$To<.1||(!$Tt||$TM.width==$TD&&$TM.height==$To?this.drawTexture($TM,$Tf,$Tc,$TD,$To):this.fillTexture($TM,$Tf,$Tc,$TD,$To))},$Tt.clear=function($Tt){void 0===$Tt&&($Tt=!0),$Tf.prototype.clear.call(this,!1)},$TJ(0,$Tt,"sizeGrid",function(){return this._sizeGrid},function($Tt){this._sizeGrid=$Tt,this._setChanged()}),$TJ(0,$Tt,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($Tt){this._width!=$Tt&&(this._width=$Tt,this._setChanged())}),$TJ(0,$Tt,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($Tt){this._height!=$Tt&&(this._height=$Tt,this._setChanged())}),$TJ(0,$Tt,"source",function(){return this._source},function($Tt){$Tt?(this._source=$Tt,this._setChanged()):(this._source=null,this.clear())}),$TE.getTexture=function($Tt,$TM,$Tf,$Tc,$TD){$Tc<=0&&($Tc=1),$TD<=0&&($TD=1),$Tt.$_GID||($Tt.$_GID=$Ti.getGID());var $To=$Tt.$_GID+"."+$TM+"."+$Tf+"."+$Tc+"."+$TD,$TJ=$Te.findObject($To);if((!$TJ||!$TJ.source)&&($TJ=$Th.createFromTexture($Tt,$TM,$Tf,$Tc,$TD))){if($Tt.alphaTexture){var $TZ=$Tt.width/$Tt.alphaTexture.width;$TJ.alphaTexture=$Th.createFromTexture($Tt.alphaTexture,$TM/$TZ,$Tf/$TZ,$Tc/$TZ,$TD/$TZ)}$Te.saveObject($To,$TJ),$TJ.weakKey=$To}return $TJ},$TE}($TM),$TS=(function($Tt){function $TM(){$TM.__super.call(this)}$To($TM,"laya.ui.UIEvent",$TL),$TM.SHOW_TIP="showtip",$TM.HIDE_TIP="hidetip"}(),function($TM){function $Tt(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$Tt.__super.call(this),this._layout=$Tx.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$To($Tt,"laya.ui.Component",$TM);var $Tf=$Tt.prototype;return $Tl.imps($Tf,{"laya.ui.IComponent":!0}),$Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$Tf.preinitialize=function(){},$Tf.createChildren=function(){},$Tf.initialize=function(){},$Tf.callLater=function($Tt,$TM){$Tl.timer.callLater(this,$Tt,$TM)},$Tf.runCallLater=function($Tt){$Tl.timer.runCallLater(this,$Tt)},$Tf.commitMeasure=function(){},$Tf.changeSize=function(){this.event("resize")},$Tf.getLayout=function(){return this._layout===$Tx.EMPTY&&(this._layout=new $Tx),this._layout},$Tf._setLayoutEnabled=function($Tt){this._layout&&this._layout.enable!=$Tt&&(this._layout.enable=$Tt,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$Tf.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$Tf.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$Tf.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$Tf.resetLayoutX=function(){var $Tt=this._layout;if(isNaN($Tt.anchorX)||(this.pivotX=$Tt.anchorX*this.width),this.layoutEnabled){var $TM=this.parent;$TM&&(isNaN($Tt.centerX)?isNaN($Tt.left)?isNaN($Tt.right)||(this.x=Math.round($TM.width-this.displayWidth-$Tt.right+this.pivotX*this.scaleX)):(this.x=Math.round($Tt.left+this.pivotX*this.scaleX),isNaN($Tt.right)||(this.width=($TM._width-$Tt.left-$Tt.right)/(this.scaleX||.01))):this.x=Math.round(.5*($TM.width-this.displayWidth)+$Tt.centerX+this.pivotX*this.scaleX))}},$Tf.resetLayoutY=function(){var $Tt=this._layout;if(isNaN($Tt.anchorY)||(this.pivotY=$Tt.anchorY*this.height),this.layoutEnabled){var $TM=this.parent;$TM&&(isNaN($Tt.centerY)?isNaN($Tt.top)?isNaN($Tt.bottom)||(this.y=Math.round($TM.height-this.displayHeight-$Tt.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($Tt.top+this.pivotY*this.scaleY),isNaN($Tt.bottom)||(this.height=($TM._height-$Tt.top-$Tt.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($TM.height-this.displayHeight)+$Tt.centerY+this.pivotY*this.scaleY))}},$Tf.onMouseOver=function($Tt){$Tl.stage.event("showtip",this._toolTip)},$Tf.onMouseOut=function($Tt){$Tl.stage.event("hidetip",this._toolTip)},$TJ(0,$Tf,"displayWidth",function(){return this.width*this.scaleX}),$TJ(0,$Tf,"width",function(){return this._width?this._width:this.measureWidth},function($Tt){this._width!=$Tt&&(this._width=$Tt,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$TJ(0,$Tf,"measureWidth",function(){var $Tt=0;this.commitMeasure();for(var $TM=this.numChildren-1;-1<$TM;$TM--){var $Tf=this.getChildAt($TM);$Tf.visible&&($Tt=Math.max($Tf.x+$Tf.width*$Tf.scaleX,$Tt))}return $Tt}),$TJ(0,$Tf,"displayHeight",function(){return this.height*this.scaleY}),$TJ(0,$Tf,"height",function(){return this._height?this._height:this.measureHeight},function($Tt){this._height!=$Tt&&(this._height=$Tt,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$TJ(0,$Tf,"dataSource",function(){return this._dataSource},function($Tt){for(var $TM in this._dataSource=$Tt,this._dataSource)this.hasOwnProperty($TM)&&"function"!=typeof this[$TM]&&(this[$TM]=this._dataSource[$TM])}),$TJ(0,$Tf,"scaleY",$TM.prototype._$get_scaleY,function($Tt){$Tl.superGet($TX,this,"scaleY")!=$Tt&&($Tl.superSet($TX,this,"scaleY",$Tt),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$TJ(0,$Tf,"measureHeight",function(){var $Tt=0;this.commitMeasure();for(var $TM=this.numChildren-1;-1<$TM;$TM--){var $Tf=this.getChildAt($TM);$Tf.visible&&($Tt=Math.max($Tf.y+$Tf.height*$Tf.scaleY,$Tt))}return $Tt}),$TJ(0,$Tf,"scaleX",$TM.prototype._$get_scaleX,function($Tt){$Tl.superGet($TX,this,"scaleX")!=$Tt&&($Tl.superSet($TX,this,"scaleX",$Tt),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$TJ(0,$Tf,"top",function(){return this._layout.top},function($Tt){$Tt!=this._layout.top&&(this.getLayout().top=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$TJ(0,$Tf,"bottom",function(){return this._layout.bottom},function($Tt){$Tt!=this._layout.bottom&&(this.getLayout().bottom=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$TJ(0,$Tf,"left",function(){return this._layout.left},function($Tt){$Tt!=this._layout.left&&(this.getLayout().left=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$TJ(0,$Tf,"right",function(){return this._layout.right},function($Tt){$Tt!=this._layout.right&&(this.getLayout().right=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$TJ(0,$Tf,"centerX",function(){return this._layout.centerX},function($Tt){$Tt!=this._layout.centerX&&(this.getLayout().centerX=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$TJ(0,$Tf,"centerY",function(){return this._layout.centerY},function($Tt){$Tt!=this._layout.centerY&&(this.getLayout().centerY=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$TJ(0,$Tf,"anchorX",function(){return this._layout.anchorX},function($Tt){$Tt!=this._layout.anchorX&&(this.getLayout().anchorX=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$TJ(0,$Tf,"anchorY",function(){return this._layout.anchorY},function($Tt){$Tt!=this._layout.anchorY&&(this.getLayout().anchorY=$Tt,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$TJ(0,$Tf,"tag",function(){return this._tag},function($Tt){this._tag=$Tt}),$TJ(0,$Tf,"toolTip",function(){return this._toolTip},function($Tt){this._toolTip!=$Tt&&(null!=(this._toolTip=$Tt)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$TJ(0,$Tf,"comXml",function(){return this._comXml},function($Tt){this._comXml=$Tt}),$TJ(0,$Tf,"gray",function(){return this._gray},function($Tt){$Tt!==this._gray&&(this._gray=$Tt,$TC.gray(this,$Tt))}),$TJ(0,$Tf,"disabled",function(){return this._disabled},function($Tt){$Tt!==this._disabled&&(this.gray=this._disabled=$Tt,this.mouseEnabled=!$Tt)}),$Tt}($TX)),$TH=function($Tt){function $TM(){this.lockLayer=null,this.popupEffect=function($Tt){$Tt.scale(1,1),$TT.from($Tt,{x:$Tl.stage.width/2,y:$Tl.stage.height/2,scaleX:0,scaleY:0},300,$TA.backOut,$Tb.create(this,this.doOpen,[$Tt]))},this.closeEffect=function($Tt,$TM){$TT.to($Tt,{x:$Tl.stage.width/2,y:$Tl.stage.height/2,scaleX:0,scaleY:0},300,$TA.strongOut,$Tb.create(this,this.doClose,[$Tt,$TM]))},$TM.__super.call(this),this.maskLayer=new $TX,this.popupEffectHandler=$Tb.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$Tb.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$Tl.stage.addChild(this),$Tl.stage.on("resize",this,this._onResize),$TU.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$To($TM,"laya.ui.DialogManager",$TX);var $Tf=$TM.prototype;return $Tf._closeOnSide=function(){var $Tt=this.getChildAt(this.numChildren-1);$Tt instanceof laya.ui.Dialog&&$Tt.close("side")},$Tf.setLockView=function($Tt){this.lockLayer||(this.lockLayer=new $Ts,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($Tl.stage.width,$Tl.stage.height)),this.lockLayer.removeChildren(),$Tt&&($Tt.centerX=$Tt.centerY=0,this.lockLayer.addChild($Tt))},$Tf._onResize=function($Tt){var $TM=this.maskLayer.width=$Tl.stage.width,$Tf=this.maskLayer.height=$Tl.stage.height;this.lockLayer&&this.lockLayer.size($TM,$Tf),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$TM,$Tf,$TU.popupBgColor),this.maskLayer.alpha=$TU.popupBgAlpha;for(var $Tc=this.numChildren-1;-1<$Tc;$Tc--){var $TD=this.getChildAt($Tc);$TD.popupCenter&&this._centerDialog($TD)}},$Tf._centerDialog=function($Tt){$Tt.x=Math.round(($Tl.stage.width-$Tt.width>>1)+$Tt.pivotX),$Tt.y=Math.round(($Tl.stage.height-$Tt.height>>1)+$Tt.pivotY)},$Tf.open=function($Tt,$TM,$Tf){void 0===$TM&&($TM=!1),void 0===$Tf&&($Tf=!1),$TM&&this._closeAll(),$Tt.popupCenter&&this._centerDialog($Tt),this.addChild($Tt),($Tt.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$Tf&&null!=$Tt.popupEffect?$Tt.popupEffect.runWith($Tt):this.doOpen($Tt),this.event("open")},$Tf.doOpen=function($Tt){$Tt.onOpened()},$Tf.lock=function($Tt){this.lockLayer&&($Tt?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$Tf.close=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=!1),$Tf&&null!=$Tt.closeEffect?$Tt.closeEffect.runWith([$Tt,$TM]):this.doClose($Tt,$TM),this.event("close")},$Tf.doClose=function($Tt,$TM){$Tt.removeSelf(),$Tt.isModal&&this._checkMask(),$Tt.closeHandler&&$Tt.closeHandler.runWith($TM),$Tt.onClosed($TM)},$Tf.closeAll=function(){this._closeAll(),this.event("close")},$Tf._closeAll=function(){for(var $Tt=this.numChildren-1;-1<$Tt;$Tt--){var $TM=this.getChildAt($Tt);$TM&&null!=$TM.close&&this.doClose($TM)}},$Tf.getDialogsByGroup=function($Tt){for(var $TM=[],$Tf=this.numChildren-1;-1<$Tf;$Tf--){var $Tc=this.getChildAt($Tf);$Tc&&$Tc.group===$Tt&&$TM.push($Tc)}return $TM},$Tf.closeByGroup=function($Tt){for(var $TM=[],$Tf=this.numChildren-1;-1<$Tf;$Tf--){var $Tc=this.getChildAt($Tf);$Tc&&$Tc.group===$Tt&&($Tc.close(),$TM.push($Tc))}return $TM},$Tf._checkMask=function(){this.maskLayer.removeSelf();for(var $Tt=this.numChildren-1;-1<$Tt;$Tt--){var $TM=this.getChildAt($Tt);if($TM&&$TM.isModal)return void this.addChildAt(this.maskLayer,$Tt)}},$TM}(),$Ts=function($Tt){function $TM(){$TM.__super.call(this)}$To($TM,"laya.ui.Box",$Tt);var $Tf=$TM.prototype;return $Tl.imps($Tf,{"laya.ui.IBox":!0}),$TJ(0,$Tf,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){for(var $TM in this._dataSource=$Tt){var $Tf=this.getChildByName($TM);$Tf?$Tf.dataSource=$Tt[$TM]:this.hasOwnProperty($TM)&&"function"!=typeof this[$TM]&&(this[$TM]=$Tt[$TM])}}),$TM}($TS),$Tr=function($TM){function $Tf($Tt,$TM){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$Tf.__super.call(this),this._labelColors=$TO.buttonLabelColors,this._stateNum=$TO.buttonStateNum,void 0===$TM&&($TM=""),this.skin=$Tt,this.label=$TM}$To($Tf,"laya.ui.Button",$TM);var $Tt=$Tf.prototype;return $Tl.imps($Tt,{"laya.ui.ISelect":!0}),$Tt.destroy=function($Tt){this.clearEvent(),$Te.clearCache(this,this._skin),$Te.clearObject(this,this._weakKey),void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($Tt),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$Tt.clearEvent=function(){this._skin&&$TD.atalsNotify&&$TD.atalsNotify.off(this._skin,this,this._setBtnSource)},$Tt.createChildren=function(){this.graphics=this._bitmap=new $TF},$Tt.createText=function(){this._text||(this._text=new $Ty,this._text.overflow=$Ty.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$Tt.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$Tt.onMouse=function($Tt){if(!1!==this.toggle||!this._selected)return"click"===$Tt.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$Tf.stateMap[$Tt.type]))},$Tt.changeClips=function(){var $Tt=$Te.getRes(this._skin);if($Tt)if(this._skin&&""!=this._skin){$Te.clearObject(this,this._weakKey);var $TM=$Tt.sourceWidth,$Tf=$Tt.sourceHeight/this._stateNum;$Tt.$_GID||($Tt.$_GID=$Ti.getGID());var $Tc=$Tt.$_GID+"-"+this._stateNum,$TD=$Te.findObject($Tc);if($Ti.isOkTextureList($TD)||($TD=null),$TD)this._weakKey=$Tc,$Te.keepObject(this,this._weakKey),this._sources=$TD;else{if(this._sources=[],1===this._stateNum)this._sources.push($Tt);else for(var $To=0;$To<this._stateNum;$To++){var $TJ=$Th.createFromTexture($Tt,0,$Tf*$To,$TM,$Tf);if($Tt.alphaTexture){var $TZ=$Tt.width/$Tt.alphaTexture.width;$TJ.alphaTexture=$Th.createFromTexture($Tt.alphaTexture,0/$TZ,$Tf*$To/$TZ,$TM/$TZ,$Tf/$TZ)}this._sources.push($TJ)}$Te.saveObject($Tc,this._sources),this._weakKey=$Tc,$Te.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$TM,this._bitmap.height=this._height||$Tf,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$TM)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$Tt.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $Tt=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$Tt]),this.label&&(this._text.color=this._labelColors[$Tt],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$Tt]))},$Tt._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$TJ(0,$Tt,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($Tt){this.createText(),this._text.strokeColor=$Tt}),$TJ(0,$Tt,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){if(this._skin!=$Tt)if(this.clearEvent(),$Te.clearCache(this,this._skin),this._skin=$Tt,$Te.keepCache(this,this._skin),$Te.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $TM=$TD.resAtalsObj&&$TD.resAtalsObj[this._skin];$TM?($TD.atalsNotify&&$TD.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$TM.sourceW),0==this.height&&(this.height=$TM.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$Tt._setBtnSource=function($Tt,$TM){$Tt===this._skin&&$TM&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$TJ(0,$Tt,"state",function(){return this._state},function($Tt){this._state!=$Tt&&(this._state=$Tt,this._setStateChanged())}),$TJ(0,$Tt,"text",function(){return this.createText(),this._text}),$TJ(0,$Tt,"stateNum",function(){return this._stateNum},function($Tt){"string"==typeof $Tt&&($Tt=parseInt($Tt)),this._stateNum!=$Tt&&(this._stateNum=$Tt<1?1:3<$Tt?3:$Tt,this.callLater(this.changeClips))}),$TJ(0,$Tt,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($Tt){this._strokeColors=$TC.fillArray($TO.buttonLabelColors,$Tt,String),this._setStateChanged()}),$TJ(0,$Tt,"labelColors",function(){return this._labelColors.join(",")},function($Tt){this._labelColors=$TC.fillArray($TO.buttonLabelColors,$Tt,String),this._setStateChanged()}),$TJ(0,$Tt,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$TJ(0,$Tt,"label",function(){return this._text?this._text.text:null},function($Tt){(this._text||$Tt)&&(this.createText(),this._text.text!=$Tt&&($Tt&&!this._text.parent&&this.addChild(this._text),this._text.text=($Tt+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$TJ(0,$Tt,"selected",function(){return this._selected},function($Tt){this._selected!=$Tt&&(this._selected=$Tt,this.state=this._selected?2:0,this.event("change"))}),$TJ(0,$Tt,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($Tt){this.createText(),this._text.padding=$TC.fillArray($TO.labelPadding,$Tt,Number)}),$TJ(0,$Tt,"labelSize",function(){return this.createText(),this._text.fontSize},function($Tt){this.createText(),this._text.fontSize=$Tt}),$TJ(0,$Tt,"labelStroke",function(){return this.createText(),this._text.stroke},function($Tt){this.createText(),this._text.stroke=$Tt}),$TJ(0,$Tt,"labelBold",function(){return this.createText(),this._text.bold},function($Tt){this.createText(),this._text.bold=$Tt}),$TJ(0,$Tt,"labelFont",function(){return this.createText(),this._text.font},function($Tt){this.createText(),this._text.font=$Tt}),$TJ(0,$Tt,"labelAlign",function(){return this.createText(),this._text.align},function($Tt){this.createText(),this._text.align=$Tt}),$TJ(0,$Tt,"clickHandler",function(){return this._clickHandler},function($Tt){this._clickHandler=$Tt}),$TJ(0,$Tt,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Tt){this._bitmap.sizeGrid=$TC.fillArray($TO.defaultSizeGrid,$Tt,Number)}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._autoSize&&(this._bitmap.width=$Tt,this._text&&(this._text.width=$Tt))}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._autoSize&&(this._bitmap.height=$Tt,this._text&&(this._text.height=$Tt))}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)||"string"==typeof $Tt?this.label=$Tt+"":$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($Tt){this._bitmap._offset=$Tt?$TC.fillArray([1,1],$Tt,Number):[]}),$Tc($Tf,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$Tf}($TS),$Tu=function($TM){function $Tc($Tt,$TM,$Tf){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$Tc.__super.call(this),void 0===$TM&&($TM=1),void 0===$Tf&&($Tf=1),this._clipX=$TM,this._clipY=$Tf,this.skin=$Tt}$To($Tc,"laya.ui.Clip",$TM);var $Tt=$Tc.prototype;return $Tt.destroy=function($Tt){this.clearEvent(),this.clearLoad(),$Te.clearCache(this,this._skin),$Te.clearObject(this,this._weakKey),void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$Tt.dispose=function(){this.destroy(!0),$Tl.loader.clearRes(this._skin)},$Tt.createChildren=function(){this.graphics=this._bitmap=new $TF},$Tt._onDisplay=function($Tt){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$Tt.changeClip=function(){if(this._clipChanged=!1,this._skin){var $Tt=$Te.getRes(this._skin);if($Tt)this.loadComplete(this._skin,$Tt);else{if($TD.resAtalsObj&&$TD.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$Tb.create(this,this.loadComplete,[this._skin]),this._progress=null,$Tl.loader.load(this._skin,this._complete,this._progress)}}},$Tt.loadComplete=function($Tt,$TM){if($Tt===this._skin&&$TM){$Te.clearObject(this,this._weakKey);var $Tf=this._clipWidth||Math.ceil($TM.sourceWidth/this._clipX),$Tc=this._clipHeight||Math.ceil($TM.sourceHeight/this._clipY),$TD=this._skin+$Tf+$Tc,$To=$Te.findObject($TD);if($Ti.isOkTextureList($To)||($To=null),$To)this._weakKey=$TD,$Te.keepObject(this,this._weakKey),this._sources=$To;else{this._sources=[];for(var $TJ=0;$TJ<this._clipY;$TJ++)for(var $TZ=0;$TZ<this._clipX;$TZ++){var $TA=$Th.createFromTexture($TM,$Tf*$TZ,$Tc*$TJ,$Tf,$Tc);if($TM.alphaTexture){var $TL=$TM.width/$TM.alphaTexture.width;$TA.alphaTexture=$Th.createFromTexture($TM.alphaTexture,$Tf*$TZ/$TL,$Tc*$TJ/$TL,$Tf/$TL,$Tc/$TL)}this._sources.push($TA)}$Te.saveObject($TD,this._sources),this._weakKey=$TD,$Te.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$Tt.play=function($Tt,$TM){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=-1),this._isPlaying=!0,this.index=$Tt,this._toIndex=$TM,this._index++,$Tl.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$Tt._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$Tt.stop=function(){this._isPlaying=!1,$Tl.timer.clear(this,this._loop),this.event("complete")},$Tt._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$TJ(0,$Tt,"interval",function(){return this._interval},function($Tt){this._interval!=$Tt&&(this._interval=$Tt,this._isPlaying&&this.play())}),$Tt.clearEvent=function(){this._skin&&$TD.atalsNotify&&$TD.atalsNotify.off(this._skin,this,this._setBtnSource)},$Tt.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Tl.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){if(this._skin!=$Tt)if(this.clearLoad(),this.clearEvent(),$Te.clearCache(this,this._skin),this._skin=$Tt){$Te.keepCache(this,this._skin);var $TM=$Te.getRes($Tt),$Tf=$TD.resAtalsObj&&$TD.resAtalsObj[this._skin];!$TM&&$Tf?$TD.atalsNotify&&$TD.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$Tt._setBtnSource=function($Tt,$TM){$Tt===this._skin&&$TM&&(this.loadComplete($Tt,$TM),this.clearEvent())},$TJ(0,$Tt,"sources",function(){return this._sources},function($Tt){this._sources=$Tt,this.index=this._index,this.event("loaded")}),$TJ(0,$Tt,"clipX",function(){return this._clipX},function($Tt){this._clipX=$Tt||1,this._setClipChanged()}),$TJ(0,$Tt,"clipY",function(){return this._clipY},function($Tt){this._clipY=$Tt||1,this._setClipChanged()}),$TJ(0,$Tt,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$TJ(0,$Tt,"clipWidth",function(){return this._clipWidth},function($Tt){this._clipWidth=$Tt,this._setClipChanged()}),$TJ(0,$Tt,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Tt){this._bitmap.sizeGrid=$TC.fillArray($TO.defaultSizeGrid,$Tt,Number)}),$TJ(0,$Tt,"group",function(){return this._group},function($Tt){$Tt&&this._skin&&$Te.setGroup(this._skin,$Tt),this._group=$Tt}),$TJ(0,$Tt,"clipHeight",function(){return this._clipHeight},function($Tt){this._clipHeight=$Tt,this._setClipChanged()}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._bitmap.width=$Tt}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._bitmap.height=$Tt}),$TJ(0,$Tt,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$TJ(0,$Tt,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$TJ(0,$Tt,"index",function(){return this._index},function($Tt){this._index=$Tt,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$Tt]),this.event("change")}),$TJ(0,$Tt,"autoPlay",function(){return this._autoPlay},function($Tt){this._autoPlay!=$Tt&&((this._autoPlay=$Tt)?this.play():this.stop())}),$TJ(0,$Tt,"isPlaying",function(){return this._isPlaying},function($Tt){this._isPlaying=$Tt}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)&&Math.floor($Tt)==$Tt||"string"==typeof $Tt?this.index=parseInt($Tt):$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"bitmap",function(){return this._bitmap}),$Tc}($TS),$Tv=function($TM){function $Tt(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$Tt.__super.call(this)}$To($Tt,"laya.ui.ColorPicker",$TM);var $Tf=$Tt.prototype;return $Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._colorPanel&&this._colorPanel.destroy($Tt),this._colorButton&&this._colorButton.destroy($Tt),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$Tf.createChildren=function(){this.addChild(this._colorButton=new $Tr),this._colorPanel=new $Ts,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $TX),this._colorPanel.addChild(this._colorBlock=new $TX),this._colorPanel.addChild(this._colorInput=new $TI)},$Tf.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$Tf.onPanelMouseDown=function($Tt){$Tt.stopPropagation()},$Tf.changePanel=function(){this._panelChanged=!1;var $Tt=this._colorPanel.graphics;$Tt.clear(),$Tt.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($Tt=this._colorTiles.graphics).clear();for(var $TM=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$Tf=0;$Tf<12;$Tf++)for(var $Tc=0;$Tc<20;$Tc++){var $TD=0;$TD=0===$Tc?$TM[$Tf]:1===$Tc?0:51*(((3*$Tf+$Tc/6)%3<<0)+3*($Tf/6<<0))<<16|$Tc%6*51<<8|($Tf<<0)%6*51;var $To=$TC.toColor($TD);this._colors.push($To);var $TJ=$Tc*this._gridSize,$TZ=$Tf*this._gridSize;$Tt.drawRect($TJ,$TZ,this._gridSize,this._gridSize,$To,"#000000")}},$Tf.onColorButtonClick=function($Tt){this._colorPanel.parent?this.close():this.open()},$Tf.open=function(){var $Tt=this.localToGlobal(new $Tq),$TM=$Tt.x+this._colorPanel.width<=$Tl.stage.width?$Tt.x:$Tl.stage.width-this._colorPanel.width,$Tf=$Tt.y+this._colorButton.height;$Tf=$Tf+this._colorPanel.height<=$Tl.stage.height?$Tf:$Tt.y-this._colorPanel.height,this._colorPanel.pos($TM,$Tf),this._colorPanel.zOrder=1001,$Tl._currentStage.addChild(this._colorPanel),$Tl.stage.on("mousedown",this,this.removeColorBox)},$Tf.close=function(){$Tl.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$Tf.removeColorBox=function($Tt){this.close()},$Tf.onColorFieldKeyDown=function($Tt){13==$Tt.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$Tt.stopPropagation())},$Tf.onColorInputChange=function($Tt){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$Tf.onColorTilesClick=function($Tt){this.selectedColor=this.getColorByMouse(),this.close()},$Tf.onColorTilesMouseMove=function($Tt){this._colorInput.focus=!1;var $TM=this.getColorByMouse();this._colorInput.text=$TM,this.drawBlock($TM)},$Tf.getColorByMouse=function(){var $Tt=this._colorTiles.getMousePoint(),$TM=Math.floor($Tt.x/this._gridSize),$Tf=Math.floor($Tt.y/this._gridSize);return this._colors[20*$Tf+$TM]},$Tf.drawBlock=function($Tt){var $TM=this._colorBlock.graphics;$TM.clear();var $Tf=$Tt||"#ffffff";$TM.drawRect(0,0,50,20,$Tf,this._borderColor),$Tt||$TM.drawLine(0,0,50,20,"#ff0000")},$Tf.changeColor=function(){var $Tt=this.graphics;$Tt.clear();var $TM=this._selectedColor||"#000000";$Tt.drawRect(0,0,this._colorButton.width,this._colorButton.height,$TM)},$Tf._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$TJ(0,$Tf,"inputBgColor",function(){return this._inputBgColor},function($Tt){this._inputBgColor=$Tt,this._setPanelChanged()}),$TJ(0,$Tf,"selectedColor",function(){return this._selectedColor},function($Tt){this._selectedColor!=$Tt&&(this._selectedColor=this._colorInput.text=$Tt,this.drawBlock($Tt),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$TL.EMPTY.setTo("change",this,this)))}),$TJ(0,$Tf,"skin",function(){return this._colorButton.skin},function($Tt){this._colorButton.skin=$Tt,this.changeColor()}),$TJ(0,$Tf,"bgColor",function(){return this._bgColor},function($Tt){this._bgColor=$Tt,this._setPanelChanged()}),$TJ(0,$Tf,"borderColor",function(){return this._borderColor},function($Tt){this._borderColor=$Tt,this._setPanelChanged()}),$TJ(0,$Tf,"inputColor",function(){return this._inputColor},function($Tt){this._inputColor=$Tt,this._setPanelChanged()}),$Tt}($TS),$Tk=function($TM){function $Tf($Tt,$TM){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$Tf.__super.call(this),this._itemColors=$TO.comboBoxItemColors,this.skin=$Tt,this.labels=$TM}$To($Tf,"laya.ui.ComboBox",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._button&&this._button.destroy($Tt),this._list&&this._list.destroy($Tt),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$Tt.createChildren=function(){this.addChild(this._button=new $Tr),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$Tt._createList=function(){this._list=new $Tz,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$Tt._setListEvent=function($Tt){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$Tb.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$Tt.onListDown=function($Tt){$Tt.stopPropagation()},$Tt.onScrollBarDown=function($Tt){$Tt.stopPropagation()},$Tt.onButtonMouseDown=function($Tt){this.callLater(this.switchTo,[!this._isOpen])},$Tt.changeList=function(){this._listChanged=!1;var $Tt=this.width-2,$TM=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$Tt,height:this._itemHeight,fontSize:this._itemSize,color:$TM}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$Tt.onlistItemMouse=function($Tt,$TM){var $Tf=$Tt.type;if("mouseover"===$Tf||"mouseout"===$Tf){if(this._isCustomList)return;var $Tc=this._list.getCell($TM);if(!$Tc)return;var $TD=$Tc.getChildByName("label");$TD&&("mouseover"===$Tf?($TD.bgColor=this._itemColors[0],$TD.color=this._itemColors[1]):($TD.bgColor=null,$TD.color=this._itemColors[2]))}else"click"===$Tf&&(this.selectedIndex=$TM,this.isOpen=!1)},$Tt.switchTo=function($Tt){this.isOpen=$Tt},$Tt.changeOpen=function(){this.isOpen=!this._isOpen},$Tt.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $Tt=this._list.graphics;$Tt.clear(),$Tt.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $TM=this._list.array||[],$Tf=$TM.length=0,$Tc=this._labels.length;$Tf<$Tc;$Tf++)$TM.push({label:this._labels[$Tf]});this._list.height=this._listHeight,this._list.array=$TM},$Tt.changeSelected=function(){this._button.label=this.selectedLabel},$Tt._onStageMouseWheel=function($Tt){this._list&&!this._list.contains($Tt.target)&&this.removeList(null)},$Tt.removeList=function($Tt){$Tl.stage.off("mousedown",this,this.removeList),$Tl.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$TJ(0,$Tt,"selectedIndex",function(){return this._selectedIndex},function($Tt){this._selectedIndex!=$Tt&&(this._selectedIndex=$Tt,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$TL.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$TJ(0,$Tt,"measureHeight",function(){return this._button.height}),$TJ(0,$Tt,"skin",function(){return this._button.skin},function($Tt){this._button.skin!=$Tt&&(this._button.skin=$Tt,this._listChanged=!0)}),$TJ(0,$Tt,"measureWidth",function(){return this._button.width}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$TJ(0,$Tt,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($Tt){this.selectedIndex=this._labels.indexOf($Tt)}),$TJ(0,$Tt,"labels",function(){return this._labels.join(",")},function($Tt){0<this._labels.length&&(this.selectedIndex=-1),$Tt?this._labels=$Tt.split(","):this._labels.length=0,this._itemChanged=!0}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._button.height=this._height}),$TJ(0,$Tt,"selectHandler",function(){return this._selectHandler},function($Tt){this._selectHandler=$Tt}),$TJ(0,$Tt,"visibleNum",function(){return this._visibleNum},function($Tt){this._visibleNum=$Tt,this._listChanged=!0}),$TJ(0,$Tt,"labelBold",function(){return this._button.text.bold},function($Tt){this._button.text.bold=$Tt}),$TJ(0,$Tt,"itemColors",function(){return String(this._itemColors)},function($Tt){this._itemColors=$TC.fillArray(this._itemColors,$Tt,String),this._listChanged=!0}),$TJ(0,$Tt,"itemSize",function(){return this._itemSize},function($Tt){this._itemSize=$Tt,this._listChanged=!0}),$TJ(0,$Tt,"scrollBar",function(){return this.list.scrollBar}),$TJ(0,$Tt,"isOpen",function(){return this._isOpen},function($Tt){if(this._isOpen!=$Tt)if(this._isOpen=$Tt,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $TM=this.localToGlobal($Tq.TEMP.setTo(0,0)),$Tf=$TM.y+this._button.height;$Tf=$Tf+this._listHeight<=$Tl.stage.height?$Tf:$TM.y-this._listHeight,this._list.pos($TM.x,$Tf),this._list.zOrder=1001,$Tl._currentStage.addChild(this._list),$Tl.stage.once("mousedown",this,this.removeList),$Tl.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$TJ(0,$Tt,"scrollBarSkin",function(){return this._scrollBarSkin},function($Tt){this._scrollBarSkin=$Tt}),$TJ(0,$Tt,"sizeGrid",function(){return this._button.sizeGrid},function($Tt){this._button.sizeGrid=$Tt}),$TJ(0,$Tt,"button",function(){return this._button}),$TJ(0,$Tt,"list",function(){return this._list||this._createList(),this._list},function($Tt){$Tt&&($Tt.removeSelf(),this._isCustomList=!0,this._list=$Tt,this._setListEvent($Tt),this._itemHeight=$Tt.getCell(0).height+$Tt.spaceY)}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)&&Math.floor($Tt)==$Tt||"string"==typeof $Tt?this.selectedIndex=parseInt($Tt):$Tt instanceof Array?this.labels=$Tt.join(","):$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"labelColors",function(){return this._button.labelColors},function($Tt){this._button.labelColors!=$Tt&&(this._button.labelColors=$Tt)}),$TJ(0,$Tt,"labelPadding",function(){return this._button.text.padding.join(",")},function($Tt){this._button.text.padding=$TC.fillArray($TO.labelPadding,$Tt,Number)}),$TJ(0,$Tt,"labelSize",function(){return this._button.text.fontSize},function($Tt){this._button.text.fontSize=$Tt}),$TJ(0,$Tt,"labelFont",function(){return this._button.text.font},function($Tt){this._button.text.font=$Tt}),$TJ(0,$Tt,"stateNum",function(){return this._button.stateNum},function($Tt){this._button.stateNum=$Tt}),$Tf}($TS),$TK=function($TM){function $Tf($Tt){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$Tf.__super.call(this),this._showButtons=$TU.showButtons,this._touchScrollEnable=$TU.touchScrollEnable,this._mouseWheelEnable=$TU.mouseWheelEnable,this.skin=$Tt,this.max=1}$To($Tf,"laya.ui.ScrollBar",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this.stopScroll(),this.target=null,$TM.prototype.destroy.call(this,$Tt),this.upButton&&this.upButton.destroy($Tt),this.downButton&&this.downButton.destroy($Tt),this.slider&&this.slider.destroy($Tt),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$Tt.createChildren=function(){this.addChild(this.slider=new $Tj),this.addChild(this.upButton=new $Tr),this.addChild(this.downButton=new $Tr)},$Tt.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$Tt.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$Tt.onButtonMouseDown=function($Tt){var $TM=$Tt.currentTarget===this.upButton;this.slide($TM),$Tl.timer.once($TO.scrollBarDelayTime,this,this.startLoop,[$TM]),$Tl.stage.once("mouseup",this,this.onStageMouseUp)},$Tt.startLoop=function($Tt){$Tl.timer.frameLoop(1,this,this.slide,[$Tt])},$Tt.slide=function($Tt){$Tt?this.value-=this._scrollSize:this.value+=this._scrollSize},$Tt.onStageMouseUp=function($Tt){$Tl.timer.clear(this,this.startLoop),$Tl.timer.clear(this,this.slide)},$Tt.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$Tt.changeSize=function(){$TM.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$Tt.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$Tt.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$Tt.setScroll=function($Tt,$TM,$Tf){this.runCallLater(this.changeSize),this.slider.setSlider($Tt,$TM,$Tf),this.slider.bar.visible=0<$TM,!this._hide&&this.autoHide&&(this.visible=!1)},$Tt.onTargetMouseWheel=function($Tt){this.value-=$Tt.delta*this._scrollSize,this.target=this._target},$Tt.onTargetMouseDown=function($Tt){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $Tq),this._lastPoint.setTo($Tl.stage.mouseX,$Tl.stage.mouseY),$Tl.timer.clear(this,this.tweenMove),$TT.clearTween(this),$Tl.stage.once("mouseup",this,this.onStageMouseUp2),$Tl.stage.once("mouseout",this,this.onStageMouseUp2),$Tl.timer.frameLoop(1,this,this.loop)},$Tt.loop=function(){var $Tt=$Tl.stage.mouseY,$TM=$Tl.stage.mouseX;if(this._lastOffset=this.isVertical?$Tt-this._lastPoint.y:$TM-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$Tl.stage._canvasTransform.getScaleY():$Tl.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$TM,this._lastPoint.y=$Tt,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$Tt.onStageMouseUp2=function($Tt){if($Tl.stage.off("mouseup",this,this.onStageMouseUp2),$Tl.stage.off("mouseout",this,this.onStageMouseUp2),$Tl.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$TT.to(this,{value:this.min},this.elasticBackTime,$TA.sineOut,$Tb.create(this,this.elasticOver)):this._value>this.max&&$TT.to(this,{value:this.max},this.elasticBackTime,$TA.sineOut,$Tb.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$Tl.stage.mouseY-this._lastPoint.y:$Tl.stage.mouseX-this._lastPoint.x);for(var $TM=0,$Tf=Math.min(this._offsets.length,3),$Tc=0;$Tc<$Tf;$Tc++)$TM+=this._offsets[this._offsets.length-1-$Tc];if(this._lastOffset=$TM/$Tf,($TM=Math.abs(this._lastOffset))<2)return void this.event("end");60<$TM&&(this._lastOffset=0<this._lastOffset?60:-60);var $TD=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$Tl.timer.frameLoop(1,this,this.tweenMove,[$TD])}},$Tt.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$TT.to(this,{alpha:0},500),this.event("end")},$Tt.tweenMove=function($Tt){this._lastOffset*=this.rollRatio;var $TM=NaN;if(0<$Tt&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$TM=.5*-(this.min-$Tt-this.value),this._lastOffset>$TM&&(this._lastOffset=$TM)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$TM=.5*-(this.max+$Tt-this.value),this._lastOffset<$TM&&(this._lastOffset=$TM))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($Tl.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$TT.to(this,{value:this.min},this.elasticBackTime,$TA.sineOut,$Tb.create(this,this.elasticOver)):this._value>this.max?$TT.to(this,{value:this.max},this.elasticBackTime,$TA.sineOut,$Tb.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$TT.to(this,{alpha:0},500)}},$Tt.stopScroll=function(){this.onStageMouseUp2(null),$Tl.timer.clear(this,this.tweenMove),$TT.clearTween(this)},$TJ(0,$Tt,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){this._skin!=$Tt&&(this._skin=$Tt,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$TJ(0,$Tt,"max",function(){return this.slider.max},function($Tt){this.slider.max=$Tt}),$TJ(0,$Tt,"showButtons",function(){return this._showButtons},function($Tt){this._showButtons=$Tt,this.callLater(this.changeScrollBar)}),$TJ(0,$Tt,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$TJ(0,$Tt,"min",function(){return this.slider.min},function($Tt){this.slider.min=$Tt}),$TJ(0,$Tt,"value",function(){return this._value},function($Tt){$Tt!==this._value&&(this._value=$Tt,this._isElastic||(this.slider._value!=$Tt&&(this.slider._value=$Tt,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$TJ(0,$Tt,"isVertical",function(){return this.slider.isVertical},function($Tt){this.slider.isVertical=$Tt}),$TJ(0,$Tt,"sizeGrid",function(){return this.slider.sizeGrid},function($Tt){this.slider.sizeGrid=$Tt}),$TJ(0,$Tt,"scrollSize",function(){return this._scrollSize},function($Tt){this._scrollSize=$Tt}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)||"string"==typeof $Tt?this.value=Number($Tt):$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"thumbPercent",function(){return this._thumbPercent},function($Tt){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$Tt=1<=$Tt?.99:$Tt,this._thumbPercent=$Tt,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$Tt,$TO.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$Tt,$TO.scrollBarMinNum))}),$TJ(0,$Tt,"target",function(){return this._target},function($Tt){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$Tt)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$TJ(0,$Tt,"hide",function(){return this._hide},function($Tt){this._hide=$Tt,this.visible=!$Tt}),$TJ(0,$Tt,"touchScrollEnable",function(){return this._touchScrollEnable},function($Tt){this._touchScrollEnable=$Tt,this.target=this._target}),$TJ(0,$Tt,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($Tt){this._mouseWheelEnable=$Tt,this.target=this._target}),$TJ(0,$Tt,"tick",function(){return this.slider.tick},function($Tt){this.slider.tick=$Tt}),$Tf}($TS),$Tj=function($TM){function $Tf($Tt){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$Tf.__super.call(this),this.skin=$Tt}$To($Tf,"laya.ui.Slider",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._bg&&this._bg.destroy($Tt),this._bar&&this._bar.destroy($Tt),this._progress&&this._progress.destroy($Tt),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$Tt.createChildren=function(){this.addChild(this._bg=new $Td),this.addChild(this._bar=new $Tr)},$Tt.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$Tt.onBarMouseDown=function($Tt){this._globalSacle||(this._globalSacle=new $Tq),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$Tl.stage.mouseX,this._ty=$Tl.stage.mouseY,$Tl.stage.on("mousemove",this,this.mouseMove),$Tl.stage.once("mouseup",this,this.mouseUp),$Tl.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$Tt.showValueText=function(){if(this.showLabel){var $Tt=laya.ui.Slider.label;this.addChild($Tt),$Tt.textField.changeText(this._value+""),this.isVertical?($Tt.x=this._bar.x+20,$Tt.y=.5*(this._bar.height-$Tt.height)+this._bar.y):($Tt.y=this._bar.y-20,$Tt.x=.5*(this._bar.width-$Tt.width)+this._bar.x)}},$Tt.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$Tt.mouseUp=function($Tt){$Tl.stage.off("mousemove",this,this.mouseMove),$Tl.stage.off("mouseup",this,this.mouseUp),$Tl.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$Tt.mouseMove=function($Tt){var $TM=this._value;this.isVertical?(this._bar.y+=($Tl.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($Tl.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$Tl.stage.mouseX,this._ty=$Tl.stage.mouseY;var $Tf=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$Tf)/$Tf,this._value!=$TM&&this.sendChangeEvent(),this.showValueText()},$Tt.sendChangeEvent=function($Tt){void 0===$Tt&&($Tt="change"),this.event($Tt),this.changeHandler&&this.changeHandler.runWith(this._value)},$Tt.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$Tt.changeSize=function(){$TM.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$Tt.setSlider=function($Tt,$TM,$Tf){this._value=-1,this._min=$Tt,this._max=$Tt<$TM?$TM:$Tt,this.value=$Tf<$Tt?$Tt:$TM<$Tf?$TM:$Tf},$Tt.changeValue=function(){var $Tt=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$Tt)/$Tt,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $TM=this._max-this._min;0===$TM&&($TM=1),this.isVertical?(this._bar.y=(this._value-this._min)/$TM*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$TM*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$Tt.onBgMouseDown=function($Tt){var $TM=this._bg.getMousePoint();this.isVertical?this.value=$TM.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$TM.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$TJ(0,$Tt,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){if(this._skin!=$Tt){this._skin=$Tt,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $TM=this._skin.replace(".png","$progress.png");$Te.getRes($TM)&&(this._progress||(this.addChild(this._progress=new $Td),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$TM),this.setBarPoint(),this.callLater(this.changeValue)}}),$TJ(0,$Tt,"allowClickBack",function(){return this._allowClickBack},function($Tt){this._allowClickBack!=$Tt&&((this._allowClickBack=$Tt)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$TJ(0,$Tt,"max",function(){return this._max},function($Tt){this._max!=$Tt&&(this._max=$Tt,this.callLater(this.changeValue))}),$TJ(0,$Tt,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$TJ(0,$Tt,"tick",function(){return this._tick},function($Tt){this._tick!=$Tt&&(this._tick=$Tt,this.callLater(this.changeValue))}),$TJ(0,$Tt,"sizeGrid",function(){return this._bg.sizeGrid},function($Tt){this._bg.sizeGrid=$Tt,this._bar.sizeGrid=$Tt,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$TJ(0,$Tt,"min",function(){return this._min},function($Tt){this._min!=$Tt&&(this._min=$Tt,this.callLater(this.changeValue))}),$TJ(0,$Tt,"value",function(){return this._value},function($Tt){if(this._value!=$Tt){var $TM=this._value;this._value=$Tt,this.changeValue(),this._value!=$TM&&this.sendChangeEvent()}}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)||"string"==typeof $Tt?this.value=Number($Tt):$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"bar",function(){return this._bar}),$Tc($Tf,["label",function(){return this.label=new $T$}]),$Tf}($TS),$Td=function($TM){function $Tf($Tt){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$Tf.__super.call(this),this.skin=$Tt}$To($Tf,"laya.ui.Image",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$Te.clearCache(this,this._skin)},$Tt.dispose=function(){this.destroy(!0),$Te.clearCache(this,this._skin),this.clearEvent()},$Tt.createChildren=function(){this.graphics=this._bitmap=new $TF},$Tt.setSource=function($Tt,$TM){this.destroyed||$Tt===this._skin&&$TM&&(this.source=$TM,this.onCompResize(),this.clearEvent())},$Tt.clearEvent=function(){this._skin&&$TD.atalsNotify&&$TD.atalsNotify.off(this._skin,this,this.setSource)},$Tt.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Tl.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$TJ(0,$Tt,"source",function(){return this._bitmap.source},function($Tt){this._bitmap&&(this._bitmap.source=$Tt,this.event("loaded"),this.repaint())}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"string"==typeof(this._dataSource=$Tt)?this.skin=$Tt:$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"measureHeight",function(){return this._bitmap.height}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){if(this._skin!=$Tt)if($Te.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$Tt){$Te.keepCache(this,this._skin);var $TM=$Te.getRes($Tt),$Tf=$TD.resAtalsObj&&$TD.resAtalsObj[this._skin];$TM?(this.source=$TM,this.onCompResize()):$Tf?($TD.atalsNotify&&$TD.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$Tf.sourceW),0==this.height&&(this.height=$Tf.sourceH)):(this._complete=$Tb.create(this,this.setSource,[this._skin]),this._progress=null,$Tl.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$TJ(0,$Tt,"group",function(){return this._group},function($Tt){$Tt&&this._skin&&$Te.setGroup(this._skin,$Tt),this._group=$Tt}),$TJ(0,$Tt,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Tt){this._bitmap.sizeGrid=$TC.fillArray($TO.defaultSizeGrid,$Tt,Number)}),$TJ(0,$Tt,"measureWidth",function(){return this._bitmap.width}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._bitmap.width=0==$Tt?1e-7:$Tt}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._bitmap.height=0==$Tt?1e-7:$Tt}),$Tf}($TS),$T$=function($TM){function $Tf($Tt){this._tf=null,$Tf.__super.call(this),void 0===$Tt&&($Tt=""),$Tp.defaultColor=$TO.labelColor,this.text=$Tt}$To($Tf,"laya.ui.Label",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._tf=null},$Tt.createChildren=function(){this.addChild(this._tf=new $Ty)},$Tt.changeText=function($Tt){this._tf.changeText($Tt)},$TJ(0,$Tt,"padding",function(){return this._tf.padding.join(",")},function($Tt){this._tf.padding=$TC.fillArray($TO.labelPadding,$Tt,Number)}),$TJ(0,$Tt,"bold",function(){return this._tf.bold},function($Tt){this._tf.bold=$Tt}),$TJ(0,$Tt,"align",function(){return this._tf.align},function($Tt){this._tf.align=$Tt}),$TJ(0,$Tt,"text",function(){return this._tf.text},function($Tt){this._tf.text!=$Tt&&($Tt&&($Tt=$TC.adptString($Tt+"")),this._tf.text=$Tt,this.event("change"),this._width&&this._height||this.onCompResize())}),$TJ(0,$Tt,"italic",function(){return this._tf.italic},function($Tt){this._tf.italic=$Tt}),$TJ(0,$Tt,"wordWrap",function(){return this._tf.wordWrap},function($Tt){this._tf.wordWrap=$Tt}),$TJ(0,$Tt,"font",function(){return this._tf.font},function($Tt){this._tf.font=$Tt}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)||"string"==typeof $Tt?this.text=$Tt+"":$Tl.superSet($TS,this,"dataSource",$Tt)}),$TJ(0,$Tt,"color",function(){return this._tf.color},function($Tt){this._tf.color=$Tt}),$TJ(0,$Tt,"valign",function(){return this._tf.valign},function($Tt){this._tf.valign=$Tt}),$TJ(0,$Tt,"leading",function(){return this._tf.leading},function($Tt){this._tf.leading=$Tt}),$TJ(0,$Tt,"fontSize",function(){return this._tf.fontSize},function($Tt){this._tf.fontSize=$Tt}),$TJ(0,$Tt,"bgColor",function(){return this._tf.bgColor},function($Tt){this._tf.bgColor=$Tt}),$TJ(0,$Tt,"borderColor",function(){return this._tf.borderColor},function($Tt){this._tf.borderColor=$Tt}),$TJ(0,$Tt,"stroke",function(){return this._tf.stroke},function($Tt){this._tf.stroke=$Tt}),$TJ(0,$Tt,"strokeColor",function(){return this._tf.strokeColor},function($Tt){this._tf.strokeColor=$Tt}),$TJ(0,$Tt,"textField",function(){return this._tf}),$TJ(0,$Tt,"measureWidth",function(){return this._tf.width}),$TJ(0,$Tt,"measureHeight",function(){return this._tf.height}),$TJ(0,$Tt,"width",function(){return this._width||this._tf.text?$Tl.superGet($TS,this,"width"):0},function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._tf.width=$Tt}),$TJ(0,$Tt,"height",function(){return this._height||this._tf.text?$Tl.superGet($TS,this,"height"):0},function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._tf.height=$Tt}),$TJ(0,$Tt,"overflow",function(){return this._tf.overflow},function($Tt){this._tf.overflow=$Tt}),$TJ(0,$Tt,"underline",function(){return this._tf.underline},function($Tt){this._tf.underline=$Tt}),$TJ(0,$Tt,"underlineColor",function(){return this._tf.underlineColor},function($Tt){this._tf.underlineColor=$Tt}),$Tf}($TS),$TP=function($TM){function $Tf($Tt){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$Tf.__super.call(this),this.skin=$Tt}$To($Tf,"laya.ui.ProgressBar",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._bg&&this._bg.destroy($Tt),this._bar&&this._bar.destroy($Tt),this._bg=this._bar=null,this.changeHandler=null},$Tt.createChildren=function(){this.addChild(this._bg=new $Td),this.addChild(this._bar=new $Td)},$Tt.changeValue=function(){if(this.sizeGrid){var $Tt=this.sizeGrid.split(","),$TM=Number($Tt[3]),$Tf=Number($Tt[1]),$Tc=(this.width-$TM-$Tf)*this._value;this._bar.width=$TM+$Tf+$Tc,this._bar.visible=this._bar.width>$TM+$Tf}else this._bar.width=this.width*this._value},$TJ(0,$Tt,"measureHeight",function(){return this._bg.height}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){this._skin!=$Tt&&(this._skin=$Tt,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$TJ(0,$Tt,"measureWidth",function(){return this._bg.width}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($TS,this,"height",$Tt),this._bg.height=this._height,this._bar.height=this._height}),$TJ(0,$Tt,"bar",function(){return this._bar}),$TJ(0,$Tt,"value",function(){return this._value},function($Tt){this._value!=$Tt&&($Tt=1<$Tt?1:$Tt<0?0:$Tt,this._value=$Tt,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($Tt))}),$TJ(0,$Tt,"bg",function(){return this._bg}),$TJ(0,$Tt,"sizeGrid",function(){return this._bg.sizeGrid},function($Tt){this._bg.sizeGrid=this._bar.sizeGrid=$Tt}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($TS,this,"width",$Tt),this._bg.width=this._width,this.callLater(this.changeValue)}),$TJ(0,$Tt,"dataSource",$TM.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)||"string"==typeof $Tt?this.value=Number($Tt):$Tl.superSet($TS,this,"dataSource",$Tt)}),$Tf}($TS),$TY=(function($Tt){function $Tf(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$Tf.__super.call(this),this._tipBox=new $TS,this._tipBox.addChild(this._tipText=new $Ty),this._tipText.x=this._tipText.y=5,this._tipText.color=$Tf.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$Tl.stage.on("showtip",this,this._onStageShowTip),$Tl.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$To($Tf,"laya.ui.TipManager",$TS);var $TM=$Tf.prototype;$TM._onStageHideTip=function($Tt){$Tl.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$TM._onStageShowTip=function($Tt){$Tl.timer.once($Tf.tipDelay,this,this._showTip,[$Tt],!0)},$TM._showTip=function($Tt){if("string"==typeof $Tt){var $TM=String($Tt);Boolean($TM)&&this._defaultTipHandler($TM)}else $Tt instanceof laya.utils.Handler?$Tt.run():"function"==typeof $Tt&&$Tt.apply();$Tl.stage.on("mousemove",this,this._onStageMouseMove),$Tl.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$TM._onStageMouseDown=function($Tt){this.closeAll()},$TM._onStageMouseMove=function($Tt){this._showToStage(this,$Tf.offsetX,$Tf.offsetY)},$TM._showToStage=function($Tt,$TM,$Tf){void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0);var $Tc=$Tt.getBounds();$Tt.x=$Tl.stage.mouseX+$TM,$Tt.y=$Tl.stage.mouseY+$Tf,$Tt.x+$Tc.width>$Tl.stage.width&&($Tt.x-=$Tc.width+$TM),$Tt.y+$Tc.height>$Tl.stage.height&&($Tt.y-=$Tc.height+$Tf)},$TM.closeAll=function(){$Tl.timer.clear(this,this._showTip),$Tl.stage.off("mousemove",this,this._onStageMouseMove),$Tl.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$TM.showDislayTip=function($Tt){this.addChild($Tt),this._showToStage(this),$Tl._currentStage.addChild(this)},$TM._showDefaultTip=function($Tt){this._tipText.text=$Tt;var $TM=this._tipBox.graphics;$TM.clear(),$TM.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$Tf.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$Tl._currentStage.addChild(this)},$TJ(0,$TM,"defaultTipHandler",function(){return this._defaultTipHandler},function($Tt){this._defaultTipHandler=$Tt}),$Tf.offsetX=10,$Tf.offsetY=15,$Tf.tipTextColor="#ffffff",$Tf.tipBackColor="#111111",$Tf.tipDelay=200}(),function($Tt){var $TI;function $Tq(){this._idMap=null,this._aniList=null,this._watchMap={},$Tq.__super.call(this)}$To($Tq,"laya.ui.View",$Ts);var $TM=$Tq.prototype;return $TM.createView=function($Tt){if($Tt.animations&&!this._idMap&&(this._idMap={}),$Tq.createComp($Tt,this,this),$Tt.animations){var $TM,$Tf,$Tc=[],$TD=$Tt.animations,$To=0,$TJ=$TD.length;for($To=0;$To<$TJ;$To++){switch($TM=new $TB,$Tf=$TD[$To],$TM._setUp(this._idMap,$Tf),(this[$Tf.name]=$TM)._setControlNode(this),$Tf.action){case 1:$TM.play(0,!1);break;case 2:$TM.play(0,!0)}$Tc.push($TM)}this._aniList=$Tc}0<this._width&&null==$Tt.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$TM.onEvent=function($Tt,$TM){},$TM.loadUI=function($Tt){var $TM=$Tq.uiMap[$Tt];$TM&&this.createView($TM)},$TM.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$Tt)},$TM.changeData=function($Tt){var $TM=this._watchMap[$Tt];if($TM){console.log("change",$Tt);for(var $Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){$TM[$Tf].exe(this)}}},$Tq._regs=function(){for(var $Tt in $Tq.uiClassMap)$T_.regClass($Tt,$Tq.uiClassMap[$Tt])},$Tq.createComp=function($Tt,$TM,$Tf,$Tc){if(!($TM=$TM||$Tq.getCompInstance($Tt)))return console.warn("can not create:"+$Tt.type),null;var $TD=$Tt.child;if($TD)for(var $To=$TM instanceof laya.ui.List,$TJ=0,$TZ=$TD.length;$TJ<$TZ;$TJ++){var $TA=$TD[$TJ];if(!$TM.hasOwnProperty("itemRender")||"render"!=$TA.props.name&&"render"!==$TA.props.renderType)if("Graphic"==$TA.type)$T_.addGraphicsToSprite($TA,$TM);else if($T_.isDrawType($TA.type))$T_.addGraphicToSprite($TA,$TM,!0);else{if($To){var $TL=[],$Tp=$Tq.createComp($TA,null,$Tf,$TL);$TL.length&&($Tp._$bindData=$TL)}else $Tp=$Tq.createComp($TA,null,$Tf,$Tc);"Script"==$TA.type?"owner"in $Tp?$Tp.owner=$TM:"target"in $Tp&&($Tp.target=$TM):"mask"==$TA.props.renderType||"mask"==$TA.props.name?$TM.mask=$Tp:$Tp instanceof laya.display.Sprite&&$TM.addChild($Tp)}else $TM.itemRender=$TA}var $TB=$Tt.props;for(var $Tb in $TB){var $TI=$TB[$Tb];$Tq.eventDic[$Tb]?$TI&&$Tf&&$TM.on($Tb,$Tf,$Tf.onEvent,[$TI]):$Tq.setCompValue($TM,$Tb,$TI,$Tf,$Tc)}return $Tl.__typeof($TM,"laya.ui.IItem")&&$TM.initItems(),$Tt.compId&&$Tf&&$Tf._idMap&&($Tf._idMap[$Tt.compId]=$TM),$TM},$Tq.setCompValue=function($Tt,$TM,$Tf,$Tc,$TD){if("string"==typeof $Tf&&-1<$Tf.indexOf("${")){if($Tq._sheet||($Tq._sheet=$T_.getClass("laya.data.Table")),!$Tq._sheet)return void console.warn("Can not find class Sheet");if($TD)$TD.push($Tt,$TM,$Tf);else if($Tc){-1==$Tf.indexOf("].")&&($Tf=$Tf.replace(".","[0]."));var $To,$TJ,$TZ=new $TI($Tt,$TM,$Tf);$TZ.exe($Tc);for(var $TA=$Tf.replace(/\[.*?\]\./g,".");null!=($To=$Tq._parseWatchData.exec($TA));){for(var $TL=$To[1];null!=($TJ=$Tq._parseKeyWord.exec($TL));){var $Tp=$TJ[0],$TB=$Tc._watchMap[$Tp]||($Tc._watchMap[$Tp]=[]);$TB.push($TZ),$Tq._sheet.I.notifer.on($Tp,$Tc,$Tc.changeData,[$Tp])}($TB=$Tc._watchMap[$TL]||($Tc._watchMap[$TL]=[])).push($TZ),$Tq._sheet.I.notifer.on($TL,$Tc,$Tc.changeData,[$TL])}}}else if("var"===$TM&&$Tc)$Tc[$Tf]=$Tt;else if("onClick"==$TM){var $Tb=$Tl._runScript("(function(){"+$Tf+"})");$Tt.on("click",$Tc,$Tb)}else $Tt[$TM]="true"===$Tf||"false"!==$Tf&&$Tf},$Tq.getCompInstance=function($Tt){var $TM,$Tf=$Tt.props?$Tt.props.runtime:null;return $TM=$Tf?$Tq.viewClassMap[$Tf]||$Tq.uiClassMap[$Tf]||$Tl.__classmap[$Tf]:$Tq.uiClassMap[$Tt.type],$Tt.props&&$Tt.props.hasOwnProperty("renderType")&&"instance"==$Tt.props.renderType?$TM.instance:$TM?new $TM:null},$Tq.regComponent=function($Tt,$TM){$Tq.uiClassMap[$Tt]=$TM,$T_.regClass($Tt,$TM)},$Tq.regViewRuntime=function($Tt,$TM){$Tq.viewClassMap[$Tt]=$TM},$Tq.uiMap={},$Tq.viewClassMap={},$Tq._sheet=null,$Tc($Tq,["uiClassMap",function(){return this.uiClassMap={ViewStack:$Ttt,LinkButton:$Tr,TextArea:$TLt,ColorPicker:$Tv,Box:$Ts,Button:$Tr,CheckBox:$Tn,Clip:$Tu,ComboBox:$Tk,Component:$TS,HScrollBar:$Tm,HSlider:$Ta,Image:$Td,Label:$T$,List:$Tz,Panel:$TG,ProgressBar:$TP,Radio:$Tw,RadioGroup:$TZt,ScrollBar:$TK,Slider:$Tj,Tab:$TAt,TextInput:$Tft,View:$Tq,VScrollBar:$TMt,VSlider:$Tct,Tree:$TW,HBox:$Tot,VBox:$TJt,Sprite:$TX,Animation:$Tf,Text:$Ty,FontClip:$Tg}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$Tq.__init$=function(){$Tq._regs(),$TI=function(){function $Tt($Tt,$TM,$Tf){this.comp=null,this.prop=null,this.value=null,this.comp=$Tt,this.prop=$TM,this.value=$Tf}return $To($Tt,""),$Tt.prototype.exe=function($Tt){var $TM=$TC.getBindFun(this.value);this.comp[this.prop]=$TM.call(this,$Tt)},$Tt}()},$Tq}()),$Tn=function($Tt){function $Tf($Tt,$TM){void 0===$TM&&($TM=""),$Tf.__super.call(this,$Tt,$TM)}$To($Tf,"laya.ui.CheckBox",$Tt);var $TM=$Tf.prototype;return $TM.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$TM.initialize=function(){$Tt.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$TJ(0,$TM,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){"boolean"==typeof(this._dataSource=$Tt)?this.selected=$Tt:"string"==typeof $Tt?this.selected="true"===$Tt:$Tl.superSet($Tr,this,"dataSource",$Tt)}),$Tf}($Tr),$TR=function($Tt){function $TM(){this._space=0,this._align="none",this._itemChanged=!1,$TM.__super.call(this)}$To($TM,"laya.ui.LayoutBox",$Ts);var $Tf=$TM.prototype;return $Tf.addChild=function($Tt){return $Tt.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$Tt)},$Tf.onResize=function($Tt){this._setItemChanged()},$Tf.addChildAt=function($Tt,$TM){return $Tt.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$Tt,$TM)},$Tf.removeChild=function($Tt){return $Tt.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$Tt)},$Tf.removeChildAt=function($Tt){return this.getChildAt($Tt).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$Tt)},$Tf.refresh=function(){this._setItemChanged()},$Tf.changeItems=function(){this._itemChanged=!1},$Tf.sortItem=function($Tt){$Tt&&$Tt.sort(function($Tt,$TM){return $Tt.y-$TM.y})},$Tf._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$TJ(0,$Tf,"space",function(){return this._space},function($Tt){this._space=$Tt,this._setItemChanged()}),$TJ(0,$Tf,"align",function(){return this._align},function($Tt){this._align=$Tt,this._setItemChanged()}),$TM}(),$Tg=function($TM){function $Tf($Tt,$TM){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$Tf.__super.call(this),$Tt&&(this.skin=$Tt),$TM&&(this.sheet=$TM)}$To($Tf,"laya.ui.FontClip",$TM);var $Tt=$Tf.prototype;return $Tt.createChildren=function(){this._bitmap=new $TF,this.on("loaded",this,this._onClipLoaded)},$Tt._onClipLoaded=function(){this.callLater(this.changeValue)},$Tt.changeValue=function(){var $Tt;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$Tt=this._sources[0]))){var $TM="horizontal"===this._direction;$TM?(this._wordsW=this._valueArr.length*($Tt.sourceWidth+this.spaceX),this._wordsH=$Tt.sourceHeight):(this._wordsW=$Tt.sourceWidth,this._wordsH=($Tt.sourceHeight+this.spaceY)*this._valueArr.length);var $Tf=0;if(this._width)switch(this._align){case"center":$Tf=.5*(this._width-this._wordsW);break;case"right":$Tf=this._width-this._wordsW;break;default:$Tf=0}for(var $Tc=0,$TD=this._valueArr.length;$Tc<$TD;$Tc++){var $To=this._indexMap[this._valueArr.charAt($Tc)];this.sources[$To]&&($Tt=this.sources[$To],$TM?this.graphics.drawTexture($Tt,$Tf+$Tc*($Tt.sourceWidth+this.spaceX),0,$Tt.sourceWidth,$Tt.sourceHeight):this.graphics.drawTexture($Tt,0+$Tf,$Tc*($Tt.sourceHeight+this.spaceY),$Tt.sourceWidth,$Tt.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$TM.prototype.destroy.call(this,$Tt)},$TJ(0,$Tt,"sheet",function(){return this._sheet},function($Tt){$Tt+="";var $TM=(this._sheet=$Tt).split(" ");this._clipX=String($TM[0]).length,this.clipY=$TM.length,this._indexMap={};for(var $Tf=0;$Tf<this._clipY;$Tf++)for(var $Tc=$TM[$Tf].split(""),$TD=0,$To=$Tc.length;$TD<$To;$TD++)this._indexMap[$Tc[$TD]]=$Tf*this._clipX+$TD}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($Tu,this,"height",$Tt),this.callLater(this.changeValue)}),$TJ(0,$Tt,"direction",function(){return this._direction},function($Tt){this._direction=$Tt,this.callLater(this.changeValue)}),$TJ(0,$Tt,"value",function(){return this._valueArr?this._valueArr:""},function($Tt){$Tt+="",this._valueArr=$Tt,this.callLater(this.changeValue)}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($Tu,this,"width",$Tt),this.callLater(this.changeValue)}),$TJ(0,$Tt,"spaceX",function(){return this._spaceX},function($Tt){this._spaceX=$Tt,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$TJ(0,$Tt,"spaceY",function(){return this._spaceY},function($Tt){this._spaceY=$Tt,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$TJ(0,$Tt,"align",function(){return this._align},function($Tt){this._align=$Tt,this.callLater(this.changeValue)}),$TJ(0,$Tt,"measureWidth",function(){return this._wordsW}),$TJ(0,$Tt,"measureHeight",function(){return this._wordsH}),$Tf}($Tu),$Tz=function($Tt){function $TM(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $Tq,$TM.__super.call(this)}$To($TM,"laya.ui.List",$Tt);var $Tf=$TM.prototype;return $Tl.imps($Tf,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this._content&&this._content.destroy($Tt),this._scrollBar&&this._scrollBar.destroy($Tt),laya.ui.Component.prototype.destroy.call(this,$Tt),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},$Tf.createChildren=function(){this.addChild(this._content=new $Ts)},$Tf.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Tl.superGet($Ts,this,"cacheAs")),$Tl.superSet($Ts,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$Tf.onScrollEnd=function(){$Tl.superSet($Ts,this,"cacheAs",this._$P.cacheAs)},$Tf._removePreScrollBar=function(){var $Tt=this.removeChildByName("scrollBar");$Tt&&$Tt.destroy(!0)},$Tf.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $Tt=this._getOneCell(),$TM=$Tt.width+this._spaceX||1,$Tf=$Tt.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$TM):Math.ceil(this._width/$TM)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$Tf):Math.round(this._height/$Tf));var $Tc=this._width?this._width:$TM*this.repeatX-this._spaceX,$TD=this._height?this._height:$Tf*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$Tf:$TM,this._cellOffset=this._isVertical?$Tf*Math.max(this._repeatY2,this._repeatY)-$TD-this._spaceY:$TM*Math.max(this._repeatX2,this._repeatX)-$Tc-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$TD:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$Tc),this.setContentSize($Tc,$TD);var $To=this._isVertical?this.repeatX:this.repeatY,$TJ=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$To,$TJ),this._createdLine=$TJ,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$Tf._getOneCell=function(){if(0===this._cells.length){var $Tt=this.createItem();if(this._offset.setTo($Tt.x,$Tt.y),this.cacheContent)return $Tt;this._cells.push($Tt)}return this._cells[0]},$Tf._createItems=function($Tt,$TM,$Tf){var $Tc=this._content,$TD=this._getOneCell(),$To=$TD.width+this._spaceX,$TJ=$TD.height+this._spaceY;if(this.cacheContent){var $TZ=new $Ts;$TZ.cacheAsBitmap=!0,$TZ.pos((this._isVertical?0:$Tt)*$To,(this._isVertical?$Tt:0)*$TJ),this._content.addChild($TZ),this._content.optimizeScrollRect=!0,$Tc=$TZ}else{for(var $TA=[],$TL=this._cells.length-1;-1<$TL;$TL--){var $Tp=this._cells[$TL];$Tp.removeSelf(),$TA.push($Tp)}this._cells.length=0}for(var $TB=$Tt;$TB<$Tf;$TB++)for(var $Tb=0;$Tb<$TM;$Tb++)($TD=$TA&&$TA.length?$TA.pop():this.createItem()).x=(this._isVertical?$Tb:$TB)*$To-$Tc.x,$TD.y=(this._isVertical?$TB:$Tb)*$TJ-$Tc.y,$TD.name="item"+($TB*$TM+$Tb),$Tc.addChild($TD),this.addCell($TD)},$Tf.createItem=function(){var $Tt=[];if("function"==typeof this._itemRender)var $TM=new this._itemRender;else $TM=$TY.createComp(this._itemRender,null,null,$Tt);if(0==$Tt.length&&$TM._watchMap){var $Tf=$TM._watchMap;for(var $Tc in $Tf)for(var $TD=$Tf[$Tc],$To=0;$To<$TD.length;$To++){var $TJ=$TD[$To];$Tt.push($TJ.comp,$TJ.prop,$TJ.value)}}return $Tt.length&&($TM._$bindData=$Tt),$TM},$Tf.addCell=function($Tt){$Tt.on("click",this,this.onCellMouse),$Tt.on("rightclick",this,this.onCellMouse),$Tt.on("mouseover",this,this.onCellMouse),$Tt.on("mouseout",this,this.onCellMouse),$Tt.on("mousedown",this,this.onCellMouse),$Tt.on("mouseup",this,this.onCellMouse),this._cells.push($Tt)},$Tf.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $Tt=0,$TM=$Tt=0;$TM<1e4;$TM++){var $Tf=this.getChildByName("item"+$TM);if(!$Tf)break;this.addCell($Tf),$Tt++}this.repeatY=$Tt}},$Tf.setContentSize=function($Tt,$TM){this._content.width=$Tt,this._content.height=$TM,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $TE),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$Tt,$TM),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$Tf.onCellMouse=function($Tt){"mousedown"===$Tt.type&&(this._isMoved=!1);var $TM=$Tt.currentTarget,$Tf=this._startIndex+this._cells.indexOf($TM);$Tf<0||("click"===$Tt.type||"rightclick"===$Tt.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$Tf:this.changeCellState($TM,!0,0):"mouseover"!==$Tt.type&&"mouseout"!==$Tt.type||this._selectedIndex===$Tf||this.changeCellState($TM,"mouseover"===$Tt.type,0),this.mouseHandler&&this.mouseHandler.runWith([$Tt,$Tf]))},$Tf.changeCellState=function($Tt,$TM,$Tf){var $Tc=$Tt.getChildByName("selectBox");$Tc&&(this.selectEnable=!0,$Tc.visible=$TM,$Tc.index=$Tf)},$Tf.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$Tf.onScrollBarChange=function($Tt){this.runCallLater(this.changeCells);var $TM=this._scrollBar.value,$Tf=this._isVertical?this.repeatX:this.repeatY,$Tc=this._isVertical?this.repeatY:this.repeatX,$TD=Math.floor($TM/this._cellSize);if(this.cacheContent)$TJ=$Tc+1,this._createdLine-$TD<$TJ&&(this._createItems(this._createdLine,$Tf,this._createdLine+$TJ),this.renderItems(this._createdLine*$Tf,0),this._createdLine+=$TJ);else{var $To=$TD*$Tf,$TJ=0;if($To>this._startIndex){$TJ=$To-this._startIndex;var $TZ=!0,$TA=this._startIndex+$Tf*($Tc+1);this._isMoved=!0}else $To<this._startIndex&&($TJ=this._startIndex-$To,$TZ=!1,$TA=this._startIndex-1,this._isMoved=!0);for(var $TL=0;$TL<$TJ;$TL++){if($TZ){var $Tp=this._cells.shift();this._cells[this._cells.length]=$Tp;var $TB=$TA+$TL}else $Tp=this._cells.pop(),this._cells.unshift($Tp),$TB=$TA-$TL;var $Tb=Math.floor($TB/$Tf)*this._cellSize;this._isVertical?$Tp.y=$Tb:$Tp.x=$Tb,this.renderItem($Tp,$TB)}this._startIndex=$To,this.changeSelectStatus()}var $TI=this._content.scrollRect;this._isVertical?($TI.y=$TM-this._offset.y,$TI.x=-this._offset.x):($TI.y=-this._offset.y,$TI.x=$TM-this._offset.x),this._content.scrollRect=$TI},$Tf.posCell=function($Tt,$TM){if(this._scrollBar){var $Tf=this._isVertical?this.repeatX:this.repeatY,$Tc=(this._isVertical?this.repeatY:this.repeatX,Math.floor($TM/$Tf)*this._cellSize);this._isVertical?$Tt.y=$Tc:$Tt.x=$Tc}},$Tf.changeSelectStatus=function(){for(var $Tt=0,$TM=this._cells.length;$Tt<$TM;$Tt++)this.changeCellState(this._cells[$Tt],this._selectedIndex===this._startIndex+$Tt,1)},$Tf.renderItems=function($Tt,$TM){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0);for(var $Tf=$Tt,$Tc=$TM||this._cells.length;$Tf<$Tc;$Tf++)this.renderItem(this._cells[$Tf],this._startIndex+$Tf);this.changeSelectStatus(),this._twDone=!0},$Tf.renderItem=function($Tt,$TM){this._array&&0<=$TM&&$TM<this._array.length?($Tt.visible=!0,$Tt._$bindData?($Tt._dataSource=this._array[$TM],this._bindData($Tt,this._array[$TM])):$Tt.dataSource=this._array[$TM],this.cacheContent||this.posCell($Tt,$TM),this.hasListener("render")&&this.event("render",[$Tt,$TM]),this.renderHandler&&this.renderHandler.runWith([$Tt,$TM]),this.renderTwHandler&&this.renderTwHandler.runWith([$Tt,$TM])):($Tt.visible=!1,$Tt.dataSource=null)},$Tf._bindData=function($Tt,$TM){for(var $Tf=$Tt._$bindData,$Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++){var $To=$Tf[$Tc++],$TJ=$Tf[$Tc++],$TZ=$Tf[$Tc],$TA=$TC.getBindFun($TZ);$To[$TJ]=$TA.call(this,$TM)}},$Tf.refresh=function(){this.array=this._array},$Tf.getItem=function($Tt){return-1<$Tt&&$Tt<this._array.length?this._array[$Tt]:null},$Tf.changeItem=function($Tt,$TM){-1<$Tt&&$Tt<this._array.length&&(this._array[$Tt]=$TM,$Tt>=this._startIndex&&$Tt<this._startIndex+this._cells.length&&this.renderItem(this.getCell($Tt),$Tt))},$Tf.setItem=function($Tt,$TM){this.changeItem($Tt,$TM)},$Tf.addItem=function($Tt){this._array.push($Tt),this.array=this._array},$Tf.addItemAt=function($Tt,$TM){this._array.splice($TM,0,$Tt),this.array=this._array},$Tf.deleteItem=function($Tt){this._array.splice($Tt,1),this.array=this._array},$Tf.getCell=function($Tt){return this.runCallLater(this.changeCells),-1<$Tt&&this._cells?this._cells[($Tt-this._startIndex)%this._cells.length]:null},$Tf.scrollTo=function($Tt){if(this._scrollBar){var $TM=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($Tt/$TM)*this._cellSize}else this.startIndex=$Tt},$Tf.tweenTo=function($Tt,$TM,$Tf){if(void 0===$TM&&($TM=200),this._scrollBar){var $Tc=this._isVertical?this.repeatX:this.repeatY;$TT.to(this._scrollBar,{value:Math.floor($Tt/$Tc)*this._cellSize},$TM,null,$Tf,0,!0)}else this.startIndex=$Tt,$Tf&&$Tf.run()},$Tf._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$Tf.commitMeasure=function(){this.runCallLater(this.changeCells)},$TJ(0,$Tf,"cacheAs",$Tt.prototype._$get_cacheAs,function($Tt){$Tl.superSet($Ts,this,"cacheAs",$Tt),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$Tt?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$TJ(0,$Tf,"content",function(){return this._content}),$TJ(0,$Tf,"height",$Tt.prototype._$get_height,function($Tt){$Tt!=this._height&&($Tl.superSet($Ts,this,"height",$Tt),this._setCellChanged())}),$TJ(0,$Tf,"itemRender",function(){return this._itemRender},function($Tt){if(this._itemRender!=$Tt){this._itemRender=$Tt;for(var $TM=this._cells.length-1;-1<$TM;$TM--)this._cells[$TM].destroy();this._cells.length=0,this._setCellChanged()}}),$TJ(0,$Tf,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($Tt){this._removePreScrollBar();var $TM=new $TMt;$TM.name="scrollBar",$TM.right=0,$Tt&&" "!=$Tt&&($TM.skin=$Tt),this.scrollBar=$TM,this.addChild($TM),this._setCellChanged()}),$TJ(0,$Tf,"page",function(){return this._page},function($Tt){this._page=$Tt,this._array&&(this._page=0<$Tt?$Tt:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$TJ(0,$Tf,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($Tt){this._removePreScrollBar();var $TM=new $Tm;$TM.name="scrollBar",$TM.bottom=0,$Tt&&" "!=$Tt&&($TM.skin=$Tt),this.scrollBar=$TM,this.addChild($TM),this._setCellChanged()}),$TJ(0,$Tf,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($Tt){this._repeatX=$Tt,this._setCellChanged()}),$TJ(0,$Tf,"scrollBar",function(){return this._scrollBar},function($Tt){this._scrollBar!=$Tt&&(this._scrollBar=$Tt)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$TJ(0,$Tf,"width",$Tt.prototype._$get_width,function($Tt){$Tt!=this._width&&($Tl.superSet($Ts,this,"width",$Tt),this._setCellChanged())}),$TJ(0,$Tf,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($Tt){this._repeatY=$Tt,this._setCellChanged()}),$TJ(0,$Tf,"spaceX",function(){return this._spaceX},function($Tt){this._spaceX=$Tt,this._setCellChanged()}),$TJ(0,$Tf,"spaceY",function(){return this._spaceY},function($Tt){this._spaceY=$Tt,this._setCellChanged()}),$TJ(0,$Tf,"selectedIndex",function(){return this._selectedIndex},function($Tt){this._selectedIndex!=$Tt&&(this._selectedIndex=$Tt,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($Tt),this.startIndex=this._startIndex)}),$TJ(0,$Tf,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($Tt){this.selectedIndex=this._array.indexOf($Tt)}),$TJ(0,$Tf,"length",function(){return this._array?this._array.length:0}),$TJ(0,$Tf,"selection",function(){return this.getCell(this._selectedIndex)},function($Tt){this.selectedIndex=this._startIndex+this._cells.indexOf($Tt)}),$TJ(0,$Tf,"startIndex",function(){return this._startIndex},function($Tt){this._startIndex=0<$Tt?$Tt:0,this.callLater(this.renderItems)}),$TJ(0,$Tf,"twSwitch",function(){return this._twSwitch},function($Tt){this._twSwitch=$Tt}),$TJ(0,$Tf,"twDone",function(){return this._twDone},function($Tt){this._twDone=$Tt}),$TJ(0,$Tf,"array",function(){return this._array},function($Tt){this.runCallLater(this.changeCells),this._array=$Tt||[];var $TM=this._array.length;if(this.totalPage=Math.ceil($TM/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$TM?this._selectedIndex:$TM-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $Tf=this._isVertical?this.repeatX:this.repeatY,$Tc=this._isVertical?this.repeatY:this.repeatX,$TD=Math.ceil($TM/$Tf);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$Tc/$TD,this._scrollBar.setScroll(0,($TD-$Tc)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$TJ(0,$Tf,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)&&Math.floor($Tt)==$Tt||"string"==typeof $Tt?this.selectedIndex=parseInt($Tt):$Tt instanceof Array?this.array=$Tt:$Tl.superSet($Ts,this,"dataSource",$Tt)}),$TJ(0,$Tf,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$TM}($Ts),$Tm=function($Tt){function $TM(){$TM.__super.call(this)}return $To($TM,"laya.ui.HScrollBar",$Tt),$TM.prototype.initialize=function(){$Tt.prototype.initialize.call(this),this.slider.isVertical=!1},$TM}($TK),$TG=function($Tt){function $TM(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$TM.__super.call(this),this.width=this.height=100}$To($TM,"laya.ui.Panel",$Tt);var $Tf=$TM.prototype;return $Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),laya.ui.Component.prototype.destroy.call(this,$Tt),this._content&&this._content.destroy($Tt),this._vScrollBar&&this._vScrollBar.destroy($Tt),this._hScrollBar&&this._hScrollBar.destroy($Tt),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$Tf.destroyChildren=function(){this._content.destroyChildren()},$Tf.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $Ts)},$Tf.addChild=function($Tt){return $Tt.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($Tt)},$Tf.onResize=function(){this._setScrollChanged()},$Tf.addChildAt=function($Tt,$TM){return $Tt.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($Tt,$TM)},$Tf.removeChild=function($Tt){return $Tt.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($Tt)},$Tf.removeChildAt=function($Tt){return this.getChildAt($Tt).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($Tt)},$Tf.removeChildren=function($Tt,$TM){return void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=2147483647),this._content.removeChildren($Tt,$TM),this._setScrollChanged(),this},$Tf.getChildAt=function($Tt){return this._content.getChildAt($Tt)},$Tf.getChildByName=function($Tt){return this._content.getChildByName($Tt)},$Tf.getChildIndex=function($Tt){return this._content.getChildIndex($Tt)},$Tf.changeScroll=function(){this._scrollChanged=!1;var $Tt=this.contentWidth||1,$TM=this.contentHeight||1,$Tf=this._vScrollBar,$Tc=this._hScrollBar,$TD=$Tf&&$TM>this._height,$To=$Tc&&$Tt>this._width,$TJ=$TD?this._width-$Tf.width:this._width,$TZ=$To?this._height-$Tc.height:this._height;$Tf&&($Tf.x=this._width-$Tf.width,$Tf.y=0,$Tf.height=this._height-($To?$Tc.height:0),$Tf.scrollSize=Math.max(.033*this._height,1),$Tf.thumbPercent=$TZ/$TM,$Tf.setScroll(0,$TM-$TZ,$Tf.value)),$Tc&&($Tc.x=0,$Tc.y=this._height-$Tc.height,$Tc.width=this._width-($TD?$Tf.width:0),$Tc.scrollSize=Math.max(.033*this._width,1),$Tc.thumbPercent=$TJ/$Tt,$Tc.setScroll(0,$Tt-$TJ,$Tc.value))},$Tf.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$Tf.setContentSize=function($Tt,$TM){var $Tf=this._content;$Tf.width=$Tt,$Tf.height=$TM,$Tf.scrollRect||($Tf.scrollRect=new $TE),$Tf.scrollRect.setTo(0,0,$Tt,$TM),$Tf.scrollRect=$Tf.scrollRect},$Tf.onScrollBarChange=function($Tt){var $TM=this._content.scrollRect;if($TM){var $Tf=Math.round($Tt.value);$Tt.isVertical?$TM.y=$Tf:$TM.x=$Tf,this._content.scrollRect=$TM}},$Tf.scrollTo=function($Tt,$TM){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),this.vScrollBar&&(this.vScrollBar.value=$TM),this.hScrollBar&&(this.hScrollBar.value=$Tt)},$Tf.refresh=function(){this.changeScroll()},$Tf.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Tl.superGet($Ts,this,"cacheAs")),$Tl.superSet($Ts,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$Tf.onScrollEnd=function(){$Tl.superSet($Ts,this,"cacheAs",this._$P.cacheAs)},$Tf._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$TJ(0,$Tf,"numChildren",function(){return this._content.numChildren}),$TJ(0,$Tf,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($Tt){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $Tm),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$Tt}),$TJ(0,$Tf,"contentWidth",function(){for(var $Tt=0,$TM=this._content.numChildren-1;-1<$TM;$TM--){var $Tf=this._content.getChildAt($TM);$Tt=Math.max($Tf.x+$Tf.width*$Tf.scaleX,$Tt)}return $Tt}),$TJ(0,$Tf,"contentHeight",function(){for(var $Tt=0,$TM=this._content.numChildren-1;-1<$TM;$TM--){var $Tf=this._content.getChildAt($TM);$Tt=Math.max($Tf.y+$Tf.height*$Tf.scaleY,$Tt)}return $Tt}),$TJ(0,$Tf,"width",$Tt.prototype._$get_width,function($Tt){$Tl.superSet($Ts,this,"width",$Tt),this._setScrollChanged()}),$TJ(0,$Tf,"hScrollBar",function(){return this._hScrollBar}),$TJ(0,$Tf,"content",function(){return this._content}),$TJ(0,$Tf,"height",$Tt.prototype._$get_height,function($Tt){$Tl.superSet($Ts,this,"height",$Tt),this._setScrollChanged()}),$TJ(0,$Tf,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($Tt){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $TMt),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$Tt}),$TJ(0,$Tf,"vScrollBar",function(){return this._vScrollBar}),$TJ(0,$Tf,"cacheAs",$Tt.prototype._$get_cacheAs,function($Tt){$Tl.superSet($Ts,this,"cacheAs",$Tt),this._$P.cacheAs=null,"none"!==$Tt?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$TM}($Ts),$Ta=function($Tt){function $TM($Tt){$TM.__super.call(this,$Tt),this.isVertical=!1}return $To($TM,"laya.ui.HSlider",$Tj),$TM}(),$TQ=function($Tt){function $Tf($Tt,$TM){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$Tf.__super.call(this),this.skin=$TM,this.labels=$Tt}$To($Tf,"laya.ui.UIGroup",$Tt);var $TM=$Tf.prototype;return $Tl.imps($TM,{"laya.ui.IItem":!0}),$TM.preinitialize=function(){this.mouseEnabled=!0},$TM.destroy=function($Tt){void 0===$Tt&&($Tt=!0),laya.ui.Component.prototype.destroy.call(this,$Tt),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$TM.addItem=function($Tt,$TM){void 0===$TM&&($TM=!0);var $Tf=$Tt,$Tc=this._items.length;if($Tf.name="item"+$Tc,this.addChild($Tf),this.initItems(),$TM&&0<$Tc){var $TD=this._items[$Tc-1];"horizontal"==this._direction?$Tf.x=$TD.x+$TD.width+this._space:$Tf.y=$TD.y+$TD.height+this._space}else $TM&&($Tf.x=0,$Tf.y=0);return $Tc},$TM.delItem=function($Tt,$TM){void 0===$TM&&($TM=!0);var $Tf=this._items.indexOf($Tt);if(-1!=$Tf){var $Tc=$Tt;this.removeChild($Tc);for(var $TD=$Tf+1,$To=this._items.length;$TD<$To;$TD++){var $TJ=this._items[$TD];$TJ.name="item"+($TD-1),$TM&&("horizontal"==this._direction?$TJ.x-=$Tc.width+this._space:$TJ.y-=$Tc.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $TZ;$TZ=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$TZ}}},$TM.initItems=function(){this._items||(this._items=[]);for(var $Tt=this._items.length=0;$Tt<1e4;$Tt++){var $TM=this.getChildByName("item"+$Tt);if(null==$TM)break;this._items.push($TM),$TM.selected=$Tt===this._selectedIndex,$TM.clickHandler=$Tb.create(this,this.itemClick,[$Tt],!1)}},$TM.itemClick=function($Tt){this.selectedIndex=$Tt},$TM.setSelect=function($Tt,$TM){this._items&&-1<$Tt&&$Tt<this._items.length&&(this._items[$Tt].selected=$TM)},$TM.createItem=function($Tt,$TM){return null},$TM.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $Tt=0,$TM=0,$Tf=this._items.length;$TM<$Tf;$TM++){var $Tc=this._items[$TM];this._skin&&($Tc.skin=this._skin),this._labelColors&&($Tc.labelColors=this._labelColors),this._labelSize&&($Tc.labelSize=this._labelSize),this._labelStroke&&($Tc.labelStroke=this._labelStroke),this._labelStrokeColor&&($Tc.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($Tc.strokeColors=this._strokeColors),this._labelBold&&($Tc.labelBold=this._labelBold),this._labelPadding&&($Tc.labelPadding=this._labelPadding),this._labelAlign&&($Tc.labelAlign=this._labelAlign),this._stateNum&&($Tc.stateNum=this._stateNum),this._labelFont&&($Tc.labelFont=this._labelFont),"horizontal"===this._direction?($Tc.y=0,$Tc.x=$Tt,$Tt+=$Tc.width+this._space):($Tc.x=0,$Tc.y=$Tt,$Tt+=$Tc.height+this._space)}this.changeSize()},$TM.commitMeasure=function(){this.runCallLater(this.changeLabels)},$TM._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$TJ(0,$TM,"labelStrokeColor",function(){return this._labelStrokeColor},function($Tt){this._labelStrokeColor!=$Tt&&(this._labelStrokeColor=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"skin",function(){return this._skin},function($Tt){this._skin!=$Tt&&(this._skin=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"selectedIndex",function(){return this._selectedIndex},function($Tt){this._selectedIndex!=$Tt&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$Tt,this.setSelect($Tt,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$TJ(0,$TM,"labels",function(){return this._labels},function($Tt){if(this._labels!=$Tt){if(this._labels=$Tt,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $TM=this._labels.split(","),$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){var $TD=this.createItem(this._skin,$TM[$Tf]);$TD.name="item"+$Tf,this.addChild($TD)}this.initItems()}}),$TJ(0,$TM,"strokeColors",function(){return this._strokeColors},function($Tt){this._strokeColors!=$Tt&&(this._strokeColors=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelColors",function(){return this._labelColors},function($Tt){this._labelColors!=$Tt&&(this._labelColors=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelStroke",function(){return this._labelStroke},function($Tt){this._labelStroke!=$Tt&&(this._labelStroke=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelSize",function(){return this._labelSize},function($Tt){this._labelSize!=$Tt&&(this._labelSize=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"stateNum",function(){return this._stateNum},function($Tt){this._stateNum!=$Tt&&(this._stateNum=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelBold",function(){return this._labelBold},function($Tt){this._labelBold!=$Tt&&(this._labelBold=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelFont",function(){return this._labelFont},function($Tt){this._labelFont!=$Tt&&(this._labelFont=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"labelPadding",function(){return this._labelPadding},function($Tt){this._labelPadding!=$Tt&&(this._labelPadding=$Tt,this._setLabelChanged())}),$TJ(0,$TM,"direction",function(){return this._direction},function($Tt){this._direction=$Tt,this._setLabelChanged()}),$TJ(0,$TM,"space",function(){return this._space},function($Tt){this._space=$Tt,this._setLabelChanged()}),$TJ(0,$TM,"items",function(){return this._items}),$TJ(0,$TM,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($Tt){this.selectedIndex=this._items.indexOf($Tt)}),$TJ(0,$TM,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){"number"==typeof(this._dataSource=$Tt)&&Math.floor($Tt)==$Tt||"string"==typeof $Tt?this.selectedIndex=parseInt($Tt):$Tt instanceof Array?this.labels=$Tt.join(","):$Tl.superSet($Ts,this,"dataSource",$Tt)}),$Tf}($Ts),$Tw=function($TM){function $Tf($Tt,$TM){this._value=null,void 0===$TM&&($TM=""),$Tf.__super.call(this,$Tt,$TM)}$To($Tf,"laya.ui.Radio",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._value=null},$Tt.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$Tt.initialize=function(){$TM.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$Tt.onClick=function($Tt){this.selected=!0},$TJ(0,$Tt,"value",function(){return null!=this._value?this._value:this.label},function($Tt){this._value=$Tt}),$Tf}($Tr),$TW=function($Tt){function $TM(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$TM.__super.call(this),this.width=this.height=200}$To($TM,"laya.ui.Tree",$Tt);var $Tf=$TM.prototype;return $Tl.imps($Tf,{"laya.ui.IRender":!0}),$Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),laya.ui.Component.prototype.destroy.call(this,$Tt),this._list&&this._list.destroy($Tt),this._list=null,this._source=null,this._renderHandler=null},$Tf.createChildren=function(){this.addChild(this._list=new $Tz),this._list.renderHandler=$Tb.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$Tf.onListChange=function($Tt){this.event("change")},$Tf.getArray=function(){var $Tt,$TM=[];for(var $Tf in this._source)$Tt=this._source[$Tf],this.getParentOpenStatus($Tt)&&($Tt.x=this._spaceLeft*this.getDepth($Tt),$TM.push($Tt));return $TM},$Tf.getDepth=function($Tt,$TM){return void 0===$TM&&($TM=0),null==$Tt.nodeParent?$TM:this.getDepth($Tt.nodeParent,$TM+1)},$Tf.getParentOpenStatus=function($Tt){var $TM=$Tt.nodeParent;return null==$TM||!!$TM.isOpen&&(null==$TM.nodeParent||this.getParentOpenStatus($TM))},$Tf.renderItem=function($Tt,$TM){var $Tf=$Tt.dataSource;if($Tf){$Tt.left=$Tf.x;var $Tc=$Tt.getChildByName("arrow");$Tc&&($Tf.hasChild?($Tc.visible=!0,$Tc.index=$Tf.isOpen?1:0,$Tc.tag=$TM,$Tc.off("click",this,this.onArrowClick),$Tc.on("click",this,this.onArrowClick)):$Tc.visible=!1);var $TD=$Tt.getChildByName("folder");$TD&&(2==$TD.clipY?$TD.index=$Tf.isDirectory?0:1:$TD.index=$Tf.isDirectory?$Tf.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$Tt,$TM])}},$Tf.onArrowClick=function($Tt){var $TM=$Tt.currentTarget.tag;this._list.array[$TM].isOpen=!this._list.array[$TM].isOpen,this.event("open"),this._list.array=this.getArray()},$Tf.setItemState=function($Tt,$TM){this._list.array[$Tt]&&(this._list.array[$Tt].isOpen=$TM,this._list.array=this.getArray())},$Tf.fresh=function(){this._list.array=this.getArray(),this.repaint()},$Tf.parseXml=function($Tt,$TM,$Tf,$Tc){var $TD,$To=$Tt.childNodes,$TJ=$To.length;if(!$Tc){$TD={};var $TZ,$TA=$Tt.attributes;for(var $TL in $TA){var $Tp=($TZ=$TA[$TL]).nodeName,$TB=$TZ.nodeValue;$TD[$Tp]="true"==$TB||"false"!=$TB&&$TB}$TD.nodeParent=$Tf,0<$TJ&&($TD.isDirectory=!0),$TD.hasChild=0<$TJ,$TM.push($TD)}for(var $Tb=0;$Tb<$TJ;$Tb++){var $TI=$To[$Tb];this.parseXml($TI,$TM,$TD,!1)}},$Tf.parseOpenStatus=function($Tt,$TM){for(var $Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++){var $TD=$TM[$Tf];if($TD.isDirectory)for(var $To=0,$TJ=$Tt.length;$To<$TJ;$To++){var $TZ=$Tt[$To];if($TZ.isDirectory&&this.isSameParent($TZ,$TD)&&$TD.label==$TZ.label){$TD.isOpen=$TZ.isOpen;break}}}},$Tf.isSameParent=function($Tt,$TM){return null==$Tt.nodeParent&&null==$TM.nodeParent||null!=$Tt.nodeParent&&null!=$TM.nodeParent&&($Tt.nodeParent.label==$TM.nodeParent.label&&this.isSameParent($Tt.nodeParent,$TM.nodeParent))},$Tf.filter=function($Tt){if(Boolean($Tt)){var $TM=[];this.getFilterSource(this._source,$TM,$Tt),this._list.array=$TM}else this._list.array=this.getArray()},$Tf.getFilterSource=function($Tt,$TM,$Tf){var $Tc;for(var $TD in $Tf=$Tf.toLocaleLowerCase(),$Tt)!($Tc=$Tt[$TD]).isDirectory&&-1<String($Tc.label).toLowerCase().indexOf($Tf)&&($Tc.x=0,$TM.push($Tc)),$Tc.child&&0<$Tc.child.length&&this.getFilterSource($Tc.child,$TM,$Tf)},$TJ(0,$Tf,"spaceBottom",function(){return this._list.spaceY},function($Tt){this._list.spaceY=$Tt}),$TJ(0,$Tf,"keepStatus",function(){return this._keepStatus},function($Tt){this._keepStatus=$Tt}),$TJ(0,$Tf,"itemRender",function(){return this._list.itemRender},function($Tt){this._list.itemRender=$Tt}),$TJ(0,$Tf,"array",function(){return this._list.array},function($Tt){this._keepStatus&&this._list.array&&$Tt&&this.parseOpenStatus(this._list.array,$Tt),this._source=$Tt,this._list.array=this.getArray()}),$TJ(0,$Tf,"mouseHandler",function(){return this._list.mouseHandler},function($Tt){this._list.mouseHandler=$Tt}),$TJ(0,$Tf,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){this._dataSource=$Tt,$Tl.superSet($Ts,this,"dataSource",$Tt)}),$TJ(0,$Tf,"source",function(){return this._source}),$TJ(0,$Tf,"scrollBar",function(){return this._list.scrollBar}),$TJ(0,$Tf,"list",function(){return this._list}),$TJ(0,$Tf,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($Tt){this._list.vScrollBarSkin=$Tt}),$TJ(0,$Tf,"renderHandler",function(){return this._renderHandler},function($Tt){this._renderHandler=$Tt}),$TJ(0,$Tf,"selectedIndex",function(){return this._list.selectedIndex},function($Tt){this._list.selectedIndex=$Tt}),$TJ(0,$Tf,"spaceLeft",function(){return this._spaceLeft},function($Tt){this._spaceLeft=$Tt}),$TJ(0,$Tf,"selectedItem",function(){return this._list.selectedItem},function($Tt){this._list.selectedItem=$Tt}),$TJ(0,$Tf,"width",$Tt.prototype._$get_width,function($Tt){$Tl.superSet($Ts,this,"width",$Tt),this._list.width=$Tt}),$TJ(0,$Tf,"height",$Tt.prototype._$get_height,function($Tt){$Tl.superSet($Ts,this,"height",$Tt),this._list.height=$Tt}),$TJ(0,$Tf,"xml",null,function($Tt){var $TM=[];this.parseXml($Tt.childNodes[0],$TM,null,!0),this.array=$TM}),$TJ(0,$Tf,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$TM}($Ts),$Ttt=function($Tt){function $TM(){this._items=null,this._selectedIndex=0,$TM.__super.call(this),this._setIndexHandler=$Tb.create(this,this.setIndex,null,!1)}$To($TM,"laya.ui.ViewStack",$Tt);var $Tf=$TM.prototype;return $Tl.imps($Tf,{"laya.ui.IItem":!0}),$Tf.setItems=function($Tt){this.removeChildren();for(var $TM=0,$Tf=0,$Tc=$Tt.length;$Tf<$Tc;$Tf++){var $TD=$Tt[$Tf];$TD&&($TD.name="item"+$TM,this.addChild($TD),$TM++)}this.initItems()},$Tf.addItem=function($Tt){$Tt.name="item"+this._items.length,this.addChild($Tt),this.initItems()},$Tf.initItems=function(){this._items=[];for(var $Tt=0;$Tt<1e4;$Tt++){var $TM=this.getChildByName("item"+$Tt);if(null==$TM)break;this._items.push($TM),$TM.visible=$Tt==this._selectedIndex}},$Tf.setSelect=function($Tt,$TM){this._items&&-1<$Tt&&$Tt<this._items.length&&(this._items[$Tt].visible=$TM)},$Tf.setIndex=function($Tt){this.selectedIndex=$Tt},$TJ(0,$Tf,"dataSource",$Tt.prototype._$get_dataSource,function($Tt){if("number"==typeof(this._dataSource=$Tt)&&Math.floor($Tt)==$Tt||"string"==typeof $Tt)this.selectedIndex=parseInt($Tt);else for(var $TM in this._dataSource)this.hasOwnProperty($TM)&&(this[$TM]=this._dataSource[$TM])}),$TJ(0,$Tf,"selectedIndex",function(){return this._selectedIndex},function($Tt){this._selectedIndex!=$Tt&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$Tt,this.setSelect(this._selectedIndex,!0))}),$TJ(0,$Tf,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($Tt){this.selectedIndex=this._items.indexOf($Tt)}),$TJ(0,$Tf,"items",function(){return this._items}),$TJ(0,$Tf,"setIndexHandler",function(){return this._setIndexHandler},function($Tt){this._setIndexHandler=$Tt}),$TM}($Ts),$TMt=function($Tt){function $TM(){$TM.__super.call(this)}return $To($TM,"laya.ui.VScrollBar",$TK),$TM}(),$Tft=function($TM){function $Tf($Tt){this._bg=null,this._skin=null,$Tf.__super.call(this),void 0===$Tt&&($Tt=""),this.text=$Tt,this.skin=this.skin}$To($Tf,"laya.ui.TextInput",$TM);var $Tt=$Tf.prototype;return $Tt.preinitialize=function(){this.mouseEnabled=!0},$Tt.destroy=function($Tt){$Te.clearCache(this,this._skin),void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._bg&&this._bg.destroy(),this._bg=null},$Tt.createChildren=function(){this.addChild(this._tf=new $TI),this._tf.padding=$TO.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$Tt._onFocus=function(){this.event("focus",this)},$Tt._onBlur=function(){this.event("blur",this)},$Tt._onInput=function(){this.event("input",this)},$Tt._onEnter=function(){this.event("enter",this)},$Tt.initialize=function(){this.width=128,this.height=22},$Tt.select=function(){this._tf.select()},$Tt.setSelection=function($Tt,$TM){this._tf.setSelection($Tt,$TM)},$TJ(0,$Tt,"text",$TM.prototype._$get_text,function($Tt){this._tf.text!=$Tt&&($Tt+="",this._tf.text=$Tt,this.event("change"))}),$TJ(0,$Tt,"bg",function(){return this._bg},function($Tt){this.graphics=this._bg=$Tt}),$TJ(0,$Tt,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($Tt){this._tf.inputElementYAdjuster=$Tt}),$TJ(0,$Tt,"multiline",function(){return this._tf.multiline},function($Tt){this._tf.multiline=$Tt}),$TJ(0,$Tt,"skin",function(){return this._skin},function($Tt){this._skin!=$Tt&&($Te.clearCache(this,this._skin),this._skin=$Tt,this._bg||(this.graphics=this._bg=new $TF),$Te.keepCache(this,this._skin),this._bg.source=$Te.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$TJ(0,$Tt,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($Tt){this._bg||(this.graphics=this._bg=new $TF),this._bg.sizeGrid=$TC.fillArray($TO.defaultSizeGrid,$Tt,Number)}),$TJ(0,$Tt,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($Tt){this._tf.inputElementXAdjuster=$Tt}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($T$,this,"width",$Tt),this._bg&&(this._bg.width=$Tt)}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($T$,this,"height",$Tt),this._bg&&(this._bg.height=$Tt)}),$TJ(0,$Tt,"editable",function(){return this._tf.editable},function($Tt){this._tf.editable=$Tt}),$TJ(0,$Tt,"restrict",function(){return this._tf.restrict},function($Tt){this._tf.restrict=$Tt}),$TJ(0,$Tt,"prompt",function(){return this._tf.prompt},function($Tt){this._tf.prompt=$Tt}),$TJ(0,$Tt,"promptColor",function(){return this._tf.promptColor},function($Tt){this._tf.promptColor=$Tt}),$TJ(0,$Tt,"maxChars",function(){return this._tf.maxChars},function($Tt){this._tf.maxChars=$Tt}),$TJ(0,$Tt,"focus",function(){return this._tf.focus},function($Tt){this._tf.focus=$Tt}),$TJ(0,$Tt,"type",function(){return this._tf.type},function($Tt){this._tf.type=$Tt}),$TJ(0,$Tt,"asPassword",function(){return this._tf.asPassword},function($Tt){this._tf.asPassword=$Tt}),$Tf}($T$),$Tct=function($Tt){function $TM(){$TM.__super.call(this)}return $To($TM,"laya.ui.VSlider",$Tj),$TM}(),$TDt=function($Tt){function $Tc(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$Tc.__super.call(this)}$To($Tc,"laya.ui.Dialog",$Tt);var $TM=$Tc.prototype;return $TM.initialize=function(){this.popupEffect=$Tc.manager.popupEffectHandler,this.closeEffect=$Tc.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$TM._dealDragArea=function(){var $Tt=this.getChildByName("drag");$Tt&&(this.dragArea=$Tt.x+","+$Tt.y+","+$Tt.width+","+$Tt.height,$Tt.removeSelf())},$TM._onClick=function($Tt){var $TM=$Tt.target;if($TM)switch($TM.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($TM.name)}},$TM.show=function($Tt,$TM){void 0===$Tt&&($Tt=!1),void 0===$TM&&($TM=!0),this._open(!1,$Tt,$TM)},$TM.popup=function($Tt,$TM){void 0===$Tt&&($Tt=!1),void 0===$TM&&($TM=!0),this._open(!0,$Tt,$TM)},$TM._open=function($Tt,$TM,$Tf){$Tc.manager.lock(!1),this.isModal=$Tt,$Tc.manager.open(this,$TM,$Tf)},$TM.onOpened=function(){},$TM.close=function($Tt,$TM){void 0===$TM&&($TM=!0),$Tc.manager.close(this,$Tt,$TM)},$TM.onClosed=function($Tt){},$TM._onMouseDown=function($Tt){var $TM=this.getMousePoint();this._dragArea.contains($TM.x,$TM.y)?this.startDrag():this.stopDrag()},$TJ(0,$TM,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($Tt){if($Tt){var $TM=$TC.fillArray([0,0,0,0],$Tt,Number);this._dragArea=new $TE($TM[0],$TM[1],$TM[2],$TM[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$TJ(0,$TM,"isPopup",function(){return null!=this.parent}),$TJ(0,$TM,"zOrder",$Tt.prototype._$get_zOrder,function($Tt){$Tl.superSet($TY,this,"zOrder",$Tt),$Tc.manager._checkMask()}),$TJ(1,$Tc,"manager",function(){return $Tc._manager=$Tc._manager||new $TH},function($Tt){$Tc._manager=$Tt}),$Tc.setLockView=function($Tt){$Tc.manager.setLockView($Tt)},$Tc.lock=function($Tt){$Tc.manager.lock($Tt)},$Tc.closeAll=function(){$Tc.manager.closeAll()},$Tc.getDialogsByGroup=function($Tt){return $Tc.manager.getDialogsByGroup($Tt)},$Tc.closeByGroup=function($Tt){return $Tc.manager.closeByGroup($Tt)},$Tc.CLOSE="close",$Tc.CANCEL="cancel",$Tc.SURE="sure",$Tc.NO="no",$Tc.OK="ok",$Tc.YES="yes",$Tc._manager=null,$Tc}($TY),$Tot=function($Tt){function $TM(){$TM.__super.call(this)}$To($TM,"laya.ui.HBox",$Tt);var $Tf=$TM.prototype;return $Tf.sortItem=function($Tt){$Tt&&$Tt.sort(function($Tt,$TM){return $Tt.x-$TM.x})},$Tf.changeItems=function(){this._itemChanged=!1;for(var $Tt=[],$TM=0,$Tf=0,$Tc=this.numChildren;$Tf<$Tc;$Tf++){var $TD=this.getChildAt($Tf);$TD&&$TD.layoutEnabled&&($Tt.push($TD),$TM=this._height?this._height:Math.max($TM,$TD.height*$TD.scaleY))}this.sortItem($Tt);var $To=0;for($Tf=0,$Tc=$Tt.length;$Tf<$Tc;$Tf++)($TD=$Tt[$Tf]).x=$To,$To+=$TD.width*$TD.scaleX+this._space,"top"==this._align?$TD.y=0:"middle"==this._align?$TD.y=.5*($TM-$TD.height*$TD.scaleY):"bottom"==this._align&&($TD.y=$TM-$TD.height*$TD.scaleY);this.changeSize()},$TJ(0,$Tf,"height",$Tt.prototype._$get_height,function($Tt){this._height!=$Tt&&($Tl.superSet($TR,this,"height",$Tt),this.callLater(this.changeItems))}),$TM.NONE="none",$TM.TOP="top",$TM.MIDDLE="middle",$TM.BOTTOM="bottom",$TM}($TR),$TJt=function($Tt){function $TM(){$TM.__super.call(this)}$To($TM,"laya.ui.VBox",$Tt);var $Tf=$TM.prototype;return $Tf.changeItems=function(){this._itemChanged=!1;for(var $Tt=[],$TM=0,$Tf=0,$Tc=this.numChildren;$Tf<$Tc;$Tf++){var $TD=this.getChildAt($Tf);$TD&&$TD.layoutEnabled&&($Tt.push($TD),$TM=this._width?this._width:Math.max($TM,$TD.width*$TD.scaleX))}this.sortItem($Tt);var $To=0;for($Tf=0,$Tc=$Tt.length;$Tf<$Tc;$Tf++)($TD=$Tt[$Tf]).y=$To,$To+=$TD.height*$TD.scaleY+this._space,"left"==this._align?$TD.x=0:"center"==this._align?$TD.x=.5*($TM-$TD.width*$TD.scaleX):"right"==this._align&&($TD.x=$TM-$TD.width*$TD.scaleX);this.changeSize()},$TJ(0,$Tf,"width",$Tt.prototype._$get_width,function($Tt){this._width!=$Tt&&($Tl.superSet($TR,this,"width",$Tt),this.callLater(this.changeItems))}),$TM.NONE="none",$TM.LEFT="left",$TM.CENTER="center",$TM.RIGHT="right",$TM}($TR),$TZt=function($Tt){function $TM(){$TM.__super.call(this)}return $To($TM,"laya.ui.RadioGroup",$TQ),$TM.prototype.createItem=function($Tt,$TM){return new $Tw($Tt,$TM)},$TM}(),$TAt=function($Tt){function $TM(){$TM.__super.call(this)}return $To($TM,"laya.ui.Tab",$TQ),$TM.prototype.createItem=function($Tt,$TM){return new $Tr($Tt,$TM)},$TM}(),$TLt=function($TM){function $Tf($Tt){this._vScrollBar=null,this._hScrollBar=null,void 0===$Tt&&($Tt=""),$Tf.__super.call(this,$Tt)}$To($Tf,"laya.ui.TextArea",$TM);var $Tt=$Tf.prototype;return $Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$Tt.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$Tt.onVBarChanged=function($Tt){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$Tt.onHBarChanged=function($Tt){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$Tt.changeScroll=function(){var $Tt=this._vScrollBar&&0<this._tf.maxScrollY,$TM=this._hScrollBar&&0<this._tf.maxScrollX,$Tf=$Tt?this._width-this._vScrollBar.width:this._width,$Tc=$TM?this._height-this._hScrollBar.height:this._height,$TD=this._tf.padding||$TO.labelPadding;this._tf.width=$Tf,this._tf.height=$Tc,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$TD[2],this._vScrollBar.y=$TD[1],this._vScrollBar.height=this._height-($TM?this._hScrollBar.height:0)-$TD[1]-$TD[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$Tc/Math.max(this._tf.textHeight,$Tc),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$Tt),this._hScrollBar&&(this._hScrollBar.x=$TD[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$TD[3],this._hScrollBar.width=this._width-($Tt?this._vScrollBar.width:0)-$TD[0]-$TD[2],this._hScrollBar.scrollSize=Math.max(.033*$Tf,1),this._hScrollBar.thumbPercent=$Tf/Math.max(this._tf.textWidth,$Tf),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$TM)},$Tt.scrollTo=function($Tt){this.commitMeasure(),this._tf.scrollY=$Tt},$TJ(0,$Tt,"scrollY",function(){return this._tf.scrollY}),$TJ(0,$Tt,"width",$TM.prototype._$get_width,function($Tt){$Tl.superSet($Tft,this,"width",$Tt),this.callLater(this.changeScroll)}),$TJ(0,$Tt,"hScrollBar",function(){return this._hScrollBar}),$TJ(0,$Tt,"height",$TM.prototype._$get_height,function($Tt){$Tl.superSet($Tft,this,"height",$Tt),this.callLater(this.changeScroll)}),$TJ(0,$Tt,"maxScrollX",function(){return this._tf.maxScrollX}),$TJ(0,$Tt,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($Tt){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $TMt),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$Tt}),$TJ(0,$Tt,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($Tt){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $Tm),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$Tt}),$TJ(0,$Tt,"vScrollBar",function(){return this._vScrollBar}),$TJ(0,$Tt,"maxScrollY",function(){return this._tf.maxScrollY}),$TJ(0,$Tt,"scrollX",function(){return this._tf.scrollX}),$Tf}($Tft);!function($Tt){function $TM(){this._uiView=null,this.isCloseOther=!1,$TM.__super.call(this)}$To($TM,"laya.ui.AsynDialog",$TDt);var $Tf=$TM.prototype;$Tf.createView=function($Tt){this._uiView=$Tt},$Tf._open=function($Tt,$TM,$Tf){this.isModal=$Tt,this.isCloseOther=$TM,$TDt.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$Tf.onCreated=function(){this.createUI(),this.onOpen()},$Tf.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$Tf.onOpen=function(){$TDt.manager.open(this,this.isCloseOther),$TDt.manager.lock(!1)},$Tf.close=function($Tt,$TM){void 0===$TM&&($TM=!0),$TDt.manager.close(this),this.onClose()},$Tf.onClose=function(){},$Tf.destroy=function($Tt){void 0===$Tt&&($Tt=!0),laya.ui.View.prototype.destroy.call(this,$Tt),this._uiView=null,this.onDestroy()},$Tf.onDestroy=function(){}}();$Tl.__init([$TY])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}}),function($Tb,$Tt,$Ty){$Ty.un,$Ty.uns;var $TB=$Ty.static,$TI=$Ty.class,$Tq=$Ty.getset,$Tc=$Ty.__newvec,$TX=laya.maths.Arith,$TJ=laya.webgl.atlas.AtlasResourceManager,$Tf=laya.webgl.shader.BaseShader,$TS=laya.utils.Browser,$TZ=laya.webgl.utils.Buffer,$Th=laya.utils.Byte,$TD=laya.utils.ClassUtils,$TA=$Ty.Config,$To=(laya.events.Event,laya.events.EventDispatcher),$TO=laya.utils.Handler,$TE=laya.net.Loader,$TM=laya.net.LoaderManager,$TL=(laya.maths.MathUtil,laya.display.Node),$Tl=laya.renders.Render,$Tp=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$T_=laya.resource.Resource,$Te=laya.utils.RunDriver,$TN=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$TT=laya.display.Sprite,$Ti=laya.utils.Stat,$TV=laya.utils.StringKey,$TC=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$Tx=laya.utils.Utils,$TU=laya.webgl.WebGL,$TF=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$Ty.interface("laya.d3.core.IClone"),$Ty.interface("laya.d3.graphics.IVertex"),$Ty.interface("laya.d3.core.render.IUpdate"),$Ty.interface("laya.d3.core.scene.ITreeNode"),$Ty.interface("laya.d3.core.render.IRenderable");(function(){function $Tr(){}$TI($Tr,"laya.d3.animation.AnimationClipParser01"),$Tr.READ_DATA=function(){$Tr._DATA.offset=$Tr._reader.getUint32(),$Tr._DATA.size=$Tr._reader.getUint32()},$Tr.READ_BLOCK=function(){for(var $Tt=$Tr._BLOCK.count=$Tr._reader.getUint16(),$TM=$Tr._BLOCK.blockStarts=[],$Tf=$Tr._BLOCK.blockLengths=[],$Tc=0;$Tc<$Tt;$Tc++)$TM.push($Tr._reader.getUint32()),$Tf.push($Tr._reader.getUint32())},$Tr.READ_STRINGS=function(){var $Tt=$Tr._reader.getUint32(),$TM=$Tr._reader.getUint16(),$Tf=$Tr._reader.pos;$Tr._reader.pos=$Tt+$Tr._DATA.offset;for(var $Tc=0;$Tc<$TM;$Tc++)$Tr._strings[$Tc]=$Tr._reader.readUTFString();$Tr._reader.pos=$Tf},$Tr.parse=function($Tt,$TM){$Tr._animationClip=$Tt;($Tr._reader=$TM).__getBuffer();$Tr.READ_DATA(),$Tr.READ_BLOCK(),$Tr.READ_STRINGS();for(var $Tf=0,$Tc=$Tr._BLOCK.count;$Tf<$Tc;$Tf++){var $TD=$TM.getUint16(),$To=$Tr._strings[$TD],$TJ=$Tr["READ_"+$To];if(null==$TJ)throw new Error("model file err,no this function:"+$TD+" "+$To);$TJ.call()}},$Tr.READ_ANIMATIONS=function(){var $Tt,$TM=0,$Tf=0,$Tc=$Tr._reader,$TD=$Tc.__getBuffer(),$To=[],$TJ=$Tc.getUint8();for($To.length=$TJ,$TM=0;$TM<$TJ;$TM++)$To[$TM]=$Tc.getUint16();var $TZ=[],$TA=$Tc.getUint16();for($TZ.length=$TA,$TM=0;$TM<$TA;$TM++)$TZ[$TM]=$Tc.getFloat32();var $TL=$Tr._animationClip;$TL.name=$Tr._strings[$Tc.getUint16()];var $Tp=$TL._duration=$Tc.getFloat32();$TL.islooping=!!$Tc.getByte(),$TL._frameRate=$Tc.getInt16();var $TB=$Tc.getInt16(),$Tb=$TL._nodes=new Array;$Tb.length=$TB,($TL._publicClipDatas=[]).length=$TB;var $TI=$TL._nodesMap={},$Tq=0,$Tl=0;for($TM=0;$TM<$TB;$TM++){$Tt=$Tb[$TM]=new $TP;var $T_=$Tc.getUint16(),$TE=$Tt.path=[];for($TE.length=$T_,$Tf=0;$Tf<$T_;$Tf++)$TE[$Tf]=$Tr._strings[$Tc.getUint16()];var $Te=$TE.join("/"),$TN=$TI[$Te];$TN||($TI[$Te]=$TN=[]),$TN.push($Tt);var $TX=$Tc.getInt16();-1!==$TX&&($Tt.componentType=$Tr._strings[$TX]);var $Ty=$Td._propertyIndexDic[$Tr._strings[$Tc.getUint16()]];if(null==$Ty)throw new Error("AnimationClipParser01:unknown property name.");var $Th=$Ty<4,$TT=!$Th||$Th&&""===$TE[0];($Tt._cacheProperty=$TT)?$Tq++:$Tl++,$Tt.propertyNameID=$Ty;var $Ti=$To[$Tc.getUint8()];$Tt.keyFrameWidth=$Ti/4;var $TV=$Tt.keyFrames=[],$Tx=$TV.length=$Tc.getUint16(),$TO=null,$TC=NaN;for($Tf=0;$Tf<$Tx;$Tf++){var $TU=$TV[$Tf]=new $T$;$TC=$TU.startTime=$TZ[$Tc.getUint16()];var $TF=$Tc.pos;$TU.inTangent=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TF=$Tc.pos,$TU.outTangent=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TF=$Tc.pos,$TU.data=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TO&&($TO.next=$TU,$TO.duration=$TC-$TO.startTime),$TO=$TU}$TU.next=null,$TU.duration=$Tp-$TC}var $TS=$TL._nodeToCachePropertyMap=new Int32Array($TB),$TH=$TL._cachePropertyMap=new Int32Array($Tq),$Ts=$TL._unCachePropertyMap=new Int32Array($Tl);for($Tq=$Tl=0,$TM=0;$TM<$TB;$TM++)($Tt=$Tb[$TM])._cacheProperty?($TS[$TM]=$Tq,$TH[$Tq++]=$TM):$Ts[$Tl++]=$TM},$Tr._animationClip=null,$Tr._reader=null,$Tr._strings=[],$TB($Tr,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $TK(){}$TI($TK,"laya.d3.animation.AnimationClipParser02"),$TK.READ_DATA=function(){$TK._DATA.offset=$TK._reader.getUint32(),$TK._DATA.size=$TK._reader.getUint32()},$TK.READ_BLOCK=function(){for(var $Tt=$TK._BLOCK.count=$TK._reader.getUint16(),$TM=$TK._BLOCK.blockStarts=[],$Tf=$TK._BLOCK.blockLengths=[],$Tc=0;$Tc<$Tt;$Tc++)$TM.push($TK._reader.getUint32()),$Tf.push($TK._reader.getUint32())},$TK.READ_STRINGS=function(){var $Tt=$TK._reader.getUint32(),$TM=$TK._reader.getUint16(),$Tf=$TK._reader.pos;$TK._reader.pos=$Tt+$TK._DATA.offset;for(var $Tc=0;$Tc<$TM;$Tc++)$TK._strings[$Tc]=$TK._reader.readUTFString();$TK._reader.pos=$Tf},$TK.parse=function($Tt,$TM){$TK._animationClip=$Tt;($TK._reader=$TM).__getBuffer();$TK.READ_DATA(),$TK.READ_BLOCK(),$TK.READ_STRINGS();for(var $Tf=0,$Tc=$TK._BLOCK.count;$Tf<$Tc;$Tf++){var $TD=$TM.getUint16(),$To=$TK._strings[$TD],$TJ=$TK["READ_"+$To];if(null==$TJ)throw new Error("model file err,no this function:"+$TD+" "+$To);$TJ.call()}},$TK.READ_ANIMATIONS=function(){var $Tt,$TM=0,$Tf=0,$Tc=$TK._reader,$TD=$Tc.__getBuffer(),$To=[],$TJ=$Tc.getUint8();for($To.length=$TJ,$TM=0;$TM<$TJ;$TM++)$To[$TM]=$Tc.getUint16();var $TZ=[],$TA=$Tc.getUint16();for($TZ.length=$TA,$TM=0;$TM<$TA;$TM++)$TZ[$TM]=$Tc.getFloat32();var $TL=$TK._animationClip;$TL.name=$TK._strings[$Tc.getUint16()];var $Tp=$TL._duration=$Tc.getFloat32();$TL.islooping=!!$Tc.getByte(),$TL._frameRate=$Tc.getInt16();var $TB=$Tc.getInt16(),$Tb=$TL._nodes=new Array;$Tb.length=$TB,($TL._publicClipDatas=[]).length=$TB;var $TI=$TL._nodesMap={},$Tq=0,$Tl=0;for($TM=0;$TM<$TB;$TM++){$Tt=$Tb[$TM]=new $TP;var $T_=$Tc.getUint16(),$TE=$Tt.path=[];for($TE.length=$T_,$Tf=0;$Tf<$T_;$Tf++)$TE[$Tf]=$TK._strings[$Tc.getUint16()];var $Te=$TE.join("/"),$TN=$TI[$Te];$TN||($TI[$Te]=$TN=[]),$TN.push($Tt);var $TX=$Tc.getInt16();-1!==$TX&&($Tt.componentType=$TK._strings[$TX]);var $Ty=$Td._propertyIndexDic[$TK._strings[$Tc.getUint16()]];if(null==$Ty)throw new Error("AnimationClipParser02:unknown property name.");var $Th=$Ty<4,$TT=!$Th||$Th&&""===$TE[0];($Tt._cacheProperty=$TT)?$Tq++:$Tl++,$Tt.propertyNameID=$Ty;var $Ti=$To[$Tc.getUint8()];$Tt.keyFrameWidth=$Ti/4;var $TV=$Tt.keyFrames=[],$Tx=$TV.length=$Tc.getUint16(),$TO=null,$TC=NaN;for($Tf=0;$Tf<$Tx;$Tf++){var $TU=$TV[$Tf]=new $T$;$TC=$TU.startTime=$TZ[$Tc.getUint16()];var $TF=$Tc.pos;$TU.inTangent=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TF=$Tc.pos,$TU.outTangent=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TF=$Tc.pos,$TU.data=new Float32Array($TD.slice($TF,$TF+$Ti)),$Tc.pos+=$Ti,$TO&&($TO.next=$TU,$TO.duration=$TC-$TO.startTime),$TO=$TU}$TU.next=null,$TU.duration=$Tp-$TC}var $TS=$Tc.getUint16();for($TM=0;$TM<$TS;$TM++){var $TH,$Ts=new $Tj;$Ts.time=$Tc.getFloat32(),$Ts.eventName=$TK._strings[$Tc.getUint16()];var $Tr=$Tc.getUint16();for(0<$Tr&&($Ts.params=$TH=[]),$Tf=0;$Tf<$Tr;$Tf++){switch($Tc.getByte()){case 0:$TH.push(!!$Tc.getByte());break;case 1:$TH.push($Tc.getInt32());break;case 2:$TH.push($Tc.getFloat32());break;case 3:$TH.push($TK._strings[$Tc.getUint16()]);break;default:throw new Error("unknown type.")}}$TL.addEvent($Ts)}var $Tu=$TL._nodeToCachePropertyMap=new Int32Array($TB),$Tv=$TL._cachePropertyMap=new Int32Array($Tq),$Tk=$TL._unCachePropertyMap=new Int32Array($Tl);for($Tq=$Tl=0,$TM=0;$TM<$TB;$TM++)($Tt=$Tb[$TM])._cacheProperty?($Tu[$TM]=$Tq,$Tv[$Tq++]=$TM):$Tk[$Tl++]=$TM},$TK._animationClip=null,$TK._reader=null,$TK._strings=[],$TB($TK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $Tj=function(){function $Tt(){this.time=NaN,this.eventName=null,this.params=null}return $TI($Tt,"laya.d3.animation.AnimationEvent"),$Tt}(),$Td=function(){function $Tc(){this._childs=[],this.transform=new $TeM(this)}$TI($Tc,"laya.d3.animation.AnimationNode");var $Tt=$Tc.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.addChild=function($Tt){$Tt._parent=this,$Tt.transform.setParent(this.transform),this._childs.push($Tt)},$Tt.removeChild=function($Tt){var $TM=this._childs.indexOf($Tt);-1!==$TM&&this._childs.splice($TM,1)},$Tt.getChildByName=function($Tt){for(var $TM=0,$Tf=this._childs.length;$TM<$Tf;$TM++){var $Tc=this._childs[$TM];if($Tc.name===$Tt)return $Tc}return null},$Tt.getChildByIndex=function($Tt){return this._childs[$Tt]},$Tt.getChildCount=function(){return this._childs.length},$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM.name=this.name;for(var $Tf=0,$Tc=this._childs.length;$Tf<$Tc;$Tf++){var $TD=this._childs[$Tf],$To=$TD.clone();$TM.addChild($To);var $TJ=$TD.transform,$TZ=$To.transform;$TZ.setLocalPosition($TJ.getLocalPosition()),$TZ.setLocalRotation($TJ.getLocalRotation()),$TZ.setLocalScale($TJ.getLocalScale()),$TZ._localRotationEuler=$TJ._localRotationEuler,$TZ._setWorldMatrixIgnoreUpdate($TJ.getWorldMatrix())}},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tc.__init__=function(){$Tc.registerAnimationNodeProperty("localPosition",$Tc._getLocalPosition,$Tc._setLocalPosition),$Tc.registerAnimationNodeProperty("localRotation",$Tc._getLocalRotation,$Tc._setLocalRotation),$Tc.registerAnimationNodeProperty("localScale",$Tc._getLocalScale,$Tc._setLocalScale),$Tc.registerAnimationNodeProperty("localRotationEuler",$Tc._getLocalRotationEuler,$Tc._setLocalRotationEuler),$Tc.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$Tc._getParticleRenderSharedMaterialTintColor,$Tc._setParticleRenderSharedMaterialTintColor),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$Tc._getMeshRenderSharedMaterialTilingOffset,$Tc._setMeshRenderSharedMaterialTilingOffset),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$Tc._getMeshRenderSharedMaterialAlbedo,$Tc._setMeshRenderSharedMaterialAlbedo),$Tc.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$Tc._getSkinnedMeshRenderSharedMaterialTilingOffset,$Tc._setSkinnedMeshRenderSharedMaterialTilingOffset),$Tc.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$Tc._getSkinnedMeshRenderSharedMaterialAlbedo,$Tc._setSkinnedMeshRenderSharedMaterialAlbedo),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$Tc._getMeshRenderSharedMaterialAlbedo,$Tc._setMeshRenderSharedMaterialAlbedo),$Tc.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$Tc._getSkinnedMeshRenderSharedMaterialAlbedo,$Tc._setSkinnedMeshRenderSharedMaterialAlbedo),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$Tc._getMeshRenderSharedMaterialIntensity,$Tc._setMeshRenderSharedMaterialIntensity),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$Tc._getMeshRenderSharedMaterialAlpha,$Tc._setMeshRenderSharedMaterialAlpha),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$Tc._getMeshRenderSharedMaterialAlphaColor,$Tc._setMeshRenderSharedMaterialAlphaColor),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$Tc._getMeshRenderSharedMaterialBaseColor,$Tc._setMeshRenderSharedMaterialBaseColor),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$Tc._getMeshRenderSharedMaterialDissolve,$Tc._setMeshRenderSharedMaterialDissolve),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$Tc._getMeshRenderSharedMaterialDissolveSpeed,$Tc._setMeshRenderSharedMaterialDissolveSpeed),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$Tc._getMeshRenderSharedMaterialMMultiplier,$Tc._setMeshRenderSharedMaterialMMultiplier),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$Tc._getMeshRenderSharedMaterialBaseScrollSpeedX,$Tc._setMeshRenderSharedMaterialBaseScrollSpeedX),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$Tc._getMeshRenderSharedMaterialBaseScrollSpeedY,$Tc._setMeshRenderSharedMaterialBaseScrollSpeedY),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$Tc._getMeshRenderSharedMaterialSecondScrollSpeedX,$Tc._setMeshRenderSharedMaterialSecondScrollSpeedX),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$Tc._getMeshRenderSharedMaterialSecondScrollSpeedY,$Tc._setMeshRenderSharedMaterialSecondScrollSpeedY),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$Tc._getMeshRenderSharedMaterialDetailTilingOffset,$Tc._setMeshRenderSharedMaterialDetailTilingOffset),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$Tc._getMeshRenderSharedMaterialDissolveTilingOffset,$Tc._setMeshRenderSharedMaterialDissolveTilingOffset),$Tc.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$Tc._getMeshRenderSharedMaterialMaskTilingOffset,$Tc._setMeshRenderSharedMaterialMaskTilingOffset)},$Tc.registerAnimationNodeProperty=function($Tt,$TM,$Tf){if($Tc._propertyIndexDic[$Tt])throw new Error("AnimationNode: this propertyName has registered.");$Tc._propertyIndexDic[$Tt]=$Tc._propertyIDCounter,$Tc._propertyGetFuncs[$Tc._propertyIDCounter]=$TM,$Tc._propertySetFuncs[$Tc._propertyIDCounter]=$Tf,$Tc._propertyIDCounter++},$Tc._getLocalPosition=function($Tt,$TM){return $Tt?$Tt.transform.getLocalPosition():$TM._transform.localPosition.elements},$Tc._setLocalPosition=function($Tt,$TM,$Tf){if($Tt)$Tt.transform.setLocalPosition($Tf);else{var $Tc=$TM._transform,$TD=$Tc.localPosition;$TD.elements=$Tf,$Tc.localPosition=$TD}},$Tc._getLocalRotation=function($Tt,$TM){return $Tt?$Tt.transform.getLocalRotation():$TM._transform.localRotation.elements},$Tc._setLocalRotation=function($Tt,$TM,$Tf){if($Tt)$Tt.transform.setLocalRotation($Tf);else{var $Tc=$TM._transform,$TD=$Tc.localRotation;$TD.elements=$Tf,$Tc.localRotation=$TD}},$Tc._getLocalScale=function($Tt,$TM){return $Tt?$Tt.transform.getLocalScale():$TM._transform.localScale.elements},$Tc._setLocalScale=function($Tt,$TM,$Tf){if($Tt)$Tt.transform.setLocalScale($Tf);else{var $Tc=$TM._transform,$TD=$Tc.localScale;$TD.elements=$Tf,$Tc.localScale=$TD}},$Tc._getLocalRotationEuler=function($Tt,$TM){return $Tt?$Tt.transform.getLocalRotationEuler():$TM._transform.localRotationEuler.elements},$Tc._setLocalRotationEuler=function($Tt,$TM,$Tf){if($Tt)$Tt.transform.setLocalRotationEuler($Tf);else{var $Tc=$TM._transform,$TD=$Tc.localRotationEuler;$TD.elements=$Tf,$Tc.localRotationEuler=$TD}},$Tc._getMeshRenderSharedMaterialTilingOffset=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $TM.meshRender.sharedMaterial.tilingOffset.elements},$Tc._setMeshRenderSharedMaterialTilingOffset=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).tilingOffset).elements=$Tf,$Tc.tilingOffset=$TD)}else($TD=($Tc=$TM.meshRender.material).tilingOffset).elements=$Tf,$Tc.tilingOffset=$TD},$Tc._getMeshRenderSharedMaterialAlbedo=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $TM.meshRender.sharedMaterial.albedoColor.elements},$Tc._setMeshRenderSharedMaterialAlbedo=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).albedoColor).elements=$Tf,$Tc.albedoColor=$TD)}else($TD=($Tc=$TM.meshRender.material).albedoColor).elements=$Tf,$Tc.albedoColor=$TD},$Tc._getSkinnedMeshRenderSharedMaterialTilingOffset=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $TM.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$Tc._setSkinnedMeshRenderSharedMaterialTilingOffset=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.skinnedMeshRender.material).tilingOffset).elements=$Tf,$Tc.tilingOffset=$TD)}else($TD=($Tc=$TM.skinnedMeshRender.material).tilingOffset).elements=$Tf,$Tc.tilingOffset=$TD},$Tc._getSkinnedMeshRenderSharedMaterialAlbedo=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $TM.skinnedMeshRender.sharedMaterial.albedoColor.elements},$Tc._setSkinnedMeshRenderSharedMaterialAlbedo=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.skinnedMeshRender.material).albedoColor).elements=$Tf,$Tc.albedoColor=$TD)}else($TD=($Tc=$TM.skinnedMeshRender.material).albedoColor).elements=$Tf,$Tc.albedoColor=$TD},$Tc._getParticleRenderSharedMaterialTintColor=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.particleRender.sharedMaterial.tintColor.elements:null}return $TM.particleRender.sharedMaterial.tintColor.elements},$Tc._setParticleRenderSharedMaterialTintColor=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.particleRender.material).tintColor).elements=$Tf,$Tc.tintColor=$TD)}else($TD=($Tc=$TM.particleRender.material).tintColor).elements=$Tf,$Tc.tintColor=$TD},$Tc._getMeshRenderSharedMaterialAlphaColor=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $TM.meshRender.sharedMaterial.alphaColor.elements},$Tc._setMeshRenderSharedMaterialAlphaColor=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).alphaColor).elements=$Tf,$Tc.alphaColor=$TD)}else($TD=($Tc=$TM.meshRender.material).alphaColor).elements=$Tf,$Tc.alphaColor=$TD},$Tc._getMeshRenderSharedMaterialBaseColor=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.baseColor.elements:null}return $TM.meshRender.sharedMaterial.baseColor.elements},$Tc._setMeshRenderSharedMaterialBaseColor=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).baseColor).elements=$Tf,$Tc.baseColor=$TD)}else($TD=($Tc=$TM.meshRender.material).baseColor).elements=$Tf,$Tc.baseColor=$TD},$Tc._getMeshRenderSharedMaterialDissolve=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.dissolve:0}return $TM.meshRender.sharedMaterial.dissolve},$Tc._setMeshRenderSharedMaterialDissolve=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.dissolve=$Tf[0])}else $TM.meshRender.material.dissolve=$Tf[0]},$Tc._getMeshRenderSharedMaterialDissolveSpeed=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $TM.meshRender.sharedMaterial.dissolveSpeed},$Tc._setMeshRenderSharedMaterialDissolveSpeed=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.dissolveSpeed=$Tf[0])}else $TM.meshRender.material.dissolveSpeed=$Tf[0]},$Tc._getMeshRenderSharedMaterialMMultiplier=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.mMultiplier:0}return $TM.meshRender.sharedMaterial.mMultiplier},$Tc._setMeshRenderSharedMaterialMMultiplier=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.mMultiplier=$Tf[0])}else $TM.meshRender.material.mMultiplier=$Tf[0]},$Tc._getMeshRenderSharedMaterialBaseScrollSpeedX=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $TM.meshRender.sharedMaterial.baseScrollSpeedX},$Tc._setMeshRenderSharedMaterialBaseScrollSpeedX=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.baseScrollSpeedX=$Tf[0])}else $TM.meshRender.material.baseScrollSpeedX=$Tf[0]},$Tc._getMeshRenderSharedMaterialBaseScrollSpeedY=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $TM.meshRender.sharedMaterial.baseScrollSpeedY},$Tc._setMeshRenderSharedMaterialBaseScrollSpeedY=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.baseScrollSpeedY=$Tf[0])}else $TM.meshRender.material.baseScrollSpeedY=$Tf[0]},$Tc._getMeshRenderSharedMaterialSecondScrollSpeedX=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $TM.meshRender.sharedMaterial.secondScrollSpeedX},$Tc._setMeshRenderSharedMaterialSecondScrollSpeedX=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.secondScrollSpeedX=$Tf[0])}else $TM.meshRender.material.secondScrollSpeedX=$Tf[0]},$Tc._getMeshRenderSharedMaterialSecondScrollSpeedY=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $TM.meshRender.sharedMaterial.secondScrollSpeedY},$Tc._setMeshRenderSharedMaterialSecondScrollSpeedY=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.secondScrollSpeedY=$Tf[0])}else $TM.meshRender.material.secondScrollSpeedY=$Tf[0]},$Tc._getMeshRenderSharedMaterialAlpha=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.alpha:0}return $TM.meshRender.sharedMaterial.alpha},$Tc._setMeshRenderSharedMaterialAlpha=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.alpha=$Tf[0])}else $TM.meshRender.material.alpha=$Tf[0]},$Tc._getMeshRenderSharedMaterialIntensity=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.intensity:0}return $TM.meshRender.sharedMaterial.intensity},$Tc._setMeshRenderSharedMaterialIntensity=function($Tt,$TM,$Tf){if($Tt){var $Tc=$Tt.transform._entity;$Tc&&($Tc.owner.meshRender.material.intensity=$Tf[0])}else $TM.meshRender.material.intensity=$Tf[0]},$Tc._getMeshRenderSharedMaterialDetailTilingOffset=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $TM.meshRender.sharedMaterial.detailTilingOffset.elements},$Tc._setMeshRenderSharedMaterialDetailTilingOffset=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).detailTilingOffset).elements=$Tf,$Tc.detailTilingOffset=$TD)}else($TD=($Tc=$TM.meshRender.material).detailTilingOffset).elements=$Tf,$Tc.detailTilingOffset=$TD},$Tc._getMeshRenderSharedMaterialDissolveTilingOffset=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $TM.meshRender.sharedMaterial.dissolveTilingOffset.elements},$Tc._setMeshRenderSharedMaterialDissolveTilingOffset=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).dissolveTilingOffset).elements=$Tf,$Tc.dissolveTilingOffset=$TD)}else($TD=($Tc=$TM.meshRender.material).dissolveTilingOffset).elements=$Tf,$Tc.dissolveTilingOffset=$TD},$Tc._getMeshRenderSharedMaterialMaskTilingOffset=function($Tt,$TM){if($Tt){var $Tf=$Tt.transform._entity;return $Tf?$Tf.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $TM.meshRender.sharedMaterial.maskTilingOffset.elements},$Tc._setMeshRenderSharedMaterialMaskTilingOffset=function($Tt,$TM,$Tf){var $Tc,$TD;if($Tt){var $To=$Tt.transform._entity;$To&&(($TD=($Tc=$To.owner.meshRender.material).maskTilingOffset).elements=$Tf,$Tc.maskTilingOffset=$TD)}else($TD=($Tc=$TM.meshRender.material).maskTilingOffset).elements=$Tf,$Tc.maskTilingOffset=$TD},$Tc._propertyIDCounter=0,$Tc._propertyIndexDic={},$Tc._propertySetFuncs=[],$Tc._propertyGetFuncs=[],$Tc}(),$T$=function(){function $Tt(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $TI($Tt,"laya.d3.animation.Keyframe"),$Tt}(),$TP=function(){function $Tt(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $TI($Tt,"laya.d3.animation.KeyframeNode"),$Tt}(),$TH=(function(){function $Tt(){this._tempVector30=new $TJM,this._tempVector31=new $TJM,this._tempVector32=new $TJM,this._a=new $TJM,this._b=new $TJM,this._c=new $TJM,this._d=new $TJM}$TI($Tt,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $TM=$Tt.prototype;$TM.Init=function($Tt,$TM,$Tf,$Tc){$Tt.cloneTo(this._d),$TM.cloneTo(this._c),$TJM.scale($Tt,2,this._a),$TJM.scale($Tf,2,this._tempVector30),$TJM.subtract(this._a,this._tempVector30,this._a),$TJM.add(this._a,$TM,this._a),$TJM.add(this._a,$Tc,this._a),$TJM.scale($Tf,3,this._b),$TJM.scale($Tt,3,this._tempVector30),$TJM.subtract(this._b,this._tempVector30,this._b),$TJM.subtract(this._b,$Tc,this._b),$TJM.scale($TM,2,this._tempVector30),$TJM.subtract(this._b,this._tempVector30,this._b)},$TM.Slerp=function($Tt,$TM){$TJM.scale(this._a,$Tt*$Tt*$Tt,this._tempVector30),$TJM.scale(this._b,$Tt*$Tt,this._tempVector31),$TJM.scale(this._c,$Tt,this._tempVector32),$TJM.add(this._tempVector30,this._tempVector31,$TM),$TJM.add($TM,this._tempVector32,$TM),$TJM.add($TM,this._d,$TM)}}(),function(){function $Tv($Tt,$TM,$Tf,$Tc){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$Tt,this._h=$TM,this._minHeight=$Tf,this._maxHeight=$Tc}$TI($Tv,"laya.d3.core.HeightMap");var $Tt=$Tv.prototype;$Tt._inBounds=function($Tt,$TM){return 0<=$Tt&&$Tt<this._h&&0<=$TM&&$TM<this._w},$Tt.getHeight=function($Tt,$TM){return this._inBounds($Tt,$TM)?this._datas[$Tt][$TM]:NaN},$Tq(0,$Tt,"width",function(){return this._w}),$Tq(0,$Tt,"height",function(){return this._h}),$Tq(0,$Tt,"maxHeight",function(){return this._maxHeight}),$Tq(0,$Tt,"minHeight",function(){return this._minHeight}),$Tv.creatFromMesh=function($Tt,$TM,$Tf,$Tc){for(var $TD=[],$To=[],$TJ=$Tt.getSubMeshCount(),$TZ=0;$TZ<$TJ;$TZ++){for(var $TA=$Tt.getSubMesh($TZ),$TL=$TA._getVertexBuffer(),$Tp=$TL.getData(),$TB=[],$Tb=0;$Tb<$Tp.length;$Tb+=$TL.vertexDeclaration.vertexStride/4){var $TI=new $TJM($Tp[$Tb+0],$Tp[$Tb+1],$Tp[$Tb+2]);$TB.push($TI)}$TD.push($TB);var $Tq=$TA._getIndexBuffer();$To.push($Tq.getData())}var $Tl=$Tt.boundingBox,$T_=$Tl.min.x,$TE=$Tl.min.z,$Te=$Tl.max.x,$TN=$Tl.max.z,$TX=$Tl.min.y,$Ty=$Tl.max.y,$Th=$Te-$T_,$TT=$TN-$TE,$Ti=$Tc.elements[0]=$Th/($TM-1),$TV=$Tc.elements[1]=$TT/($Tf-1),$Tx=new $Tv($TM,$Tf,$TX,$Ty),$TO=$Tv._tempRay,$TC=$TO.direction.elements;$TC[0]=0,$TC[1]=-1,$TC[2]=0;var $TU=$Ty+.1;$TO.origin.elements[1]=$TU;for(var $TF=0;$TF<$Tf;$TF++){var $TS=$TE+$TF*$TV;$Tx._datas[$TF]=[];for(var $TH=0;$TH<$TM;$TH++){var $Ts=$T_+$TH*$Ti,$Tr=$TO.origin.elements;$Tr[0]=$Ts,$Tr[2]=$TS;var $Tu=$Tv._getPosition($TO,$TD,$To);$Tx._datas[$TF][$TH]=$Tu===Number.MAX_VALUE?NaN:$TU-$Tu}}return $Tx},$Tv.createFromImage=function($Tt,$TM,$Tf){for(var $Tc=$Tt.width,$TD=$Tt.height,$To=new $Tv($Tc,$TD,$TM,$Tf),$TJ=($Tf-$TM)/254,$TZ=$Tt.getPixels(),$TA=0,$TL=0;$TL<$TD;$TL++)for(var $Tp=$To._datas[$TL]=[],$TB=0;$TB<$Tc;$TB++){var $Tb=$TZ[$TA++],$TI=$TZ[$TA++],$Tq=$TZ[$TA++],$Tl=$TZ[$TA++];$Tp[$TB]=255==$Tb&&255==$TI&&255==$Tq&&255==$Tl?NaN:($Tb+$TI+$Tq)/3*$TJ+$TM}return $To},$Tv._getPosition=function($Tt,$TM,$Tf){for(var $Tc=Number.MAX_VALUE,$TD=0;$TD<$TM.length;$TD++)for(var $To=$TM[$TD],$TJ=$Tf[$TD],$TZ=0;$TZ<$TJ.length;$TZ+=3){var $TA=$To[$TJ[$TZ+0]],$TL=$To[$TJ[$TZ+1]],$Tp=$To[$TJ[$TZ+2]],$TB=$TqM.rayIntersectsTriangle($Tt,$TA,$TL,$Tp);!isNaN($TB)&&$TB<$Tc&&($Tc=$TB)}return $Tc},$TB($Tv,["_tempRay",function(){return this._tempRay=new $TDM(new $TJM,new $TJM)}])}(),function(){function $TD(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$TI($TD,"laya.d3.core.Layer");var $Tt=$TD.prototype;return $Tt._binarySearchIndex=function(){for(var $Tt=0,$TM=$TD._collsionTestList.length-1,$Tf=0;$Tt<=$TM;){$Tf=Math.floor(($Tt+$TM)/2);var $Tc=$TD._collsionTestList[$Tf];if($Tc==this._number)return $Tf;$Tc>this._number?$TM=$Tf-1:$Tt=$Tf+1}return $Tt},$Tt._addCollider=function($Tt){0===this._colliders.length&&$TD._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$Tt._isRigidbody?(this._colliders.unshift($Tt),this._nonRigidbodyOffset++):this._colliders.push($Tt)},$Tt._removeCollider=function($Tt){var $TM=this._colliders.indexOf($Tt);$TM<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($TM,1),0===this._colliders.length&&$TD._collsionTestList.splice($TD._collsionTestList.indexOf(this._number),1)},$Tq(0,$Tt,"number",function(){return this._number}),$Tq(0,$Tt,"visible",function(){return this._visible},function($Tt){this._visible=$Tt,$TD._visibleLayers=$Tt?$TD._visibleLayers|this.mask:$TD._visibleLayers&~this.mask}),$Tq(0,$Tt,"mask",function(){return this._mask}),$Tq(1,$TD,"visibleLayers",function(){return $TD._visibleLayers},function($Tt){$TD._visibleLayers=$Tt;for(var $TM=0,$Tf=$TD._layerList.length;$TM<$Tf;$TM++){var $Tc=$TD._layerList[$TM];$Tc._visible=0!=($Tc._mask&$TD._visibleLayers)}}),$TD.__init__=function(){$TD._layerList.length=31;for(var $Tt=0;$Tt<31;$Tt++){var $TM=new $TD;$TD._layerList[$Tt]=$TM,0===$Tt?($TM.name="Default Layer",$TM.visible=!0):($TM.name="Layer-"+$Tt,$TM.visible=!1),$TM._number=$Tt,$TM._mask=Math.pow(2,$Tt)}$TD.currentCreationLayer=$TD._layerList[0]},$TD.getLayerByNumber=function($Tt){if($Tt<0||30<$Tt)throw new Error("无法返回指定Layer，该number超出范围！");return $TD._layerList[$Tt]},$TD.getLayerByName=function($Tt){for(var $TM=0;$TM<31;$TM++)if($TD._layerList[$TM].name===$Tt)return $TD._layerList[$TM];throw new Error("无法返回指定Layer,该name不存在")},$TD.isVisible=function($Tt){return 0!=($Tt&$TD._currentCameraCullingMask&$TD._visibleLayers)},$TD._layerList=[],$TD._visibleLayers=2147483647,$TD._collsionTestList=[],$TD._currentCameraCullingMask=2147483647,$TD.maxCount=31,$TD.currentCreationLayer=null,$TD}()),$Ts=(function(){function $Tt($Tt,$TM,$Tf){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$Tt,this._minCount=$TM,this._maxCount=$Tf}$TI($Tt,"laya.d3.core.particleShuriKen.module.Burst");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.cloneTo=function($Tt){var $TM=$Tt;$TM._time=this._time,$TM._minCount=this._minCount,$TM._maxCount=this._maxCount},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"time",function(){return this._time}),$Tq(0,$TM,"minCount",function(){return this._minCount}),$Tq(0,$TM,"maxCount",function(){return this._maxCount})}(),function(){function $Tt($Tt){this._color=null,this.enbale=!1,this._color=$Tt}$TI($Tt,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $TM=$Tt.prototype;$TM.cloneTo=function($Tt){var $TM=$Tt;this._color.cloneTo($TM._color),$TM.enbale=this.enbale},$TM.clone=function(){var $Tt;switch(this._color.type){case 0:$Tt=$Tu.createByConstant(this._color.constant.clone());break;case 1:$Tt=$Tu.createByGradient(this._color.gradient.clone());break;case 2:$Tt=$Tu.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$Tt=$Tu.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $TM=new this.constructor($Tt);return $TM.enbale=this.enbale,$TM},$Tq(0,$TM,"color",function(){return this._color})}(),function(){function $Tt(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$TI($Tt,"laya.d3.core.particleShuriKen.module.Emission");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$TM._destroy=function(){this._bursts=null,this._destroyed=!0},$TM.getBurstsCount=function(){return this._bursts.length},$TM.getBurstByIndex=function($Tt){return this._bursts[$Tt]},$TM.addBurst=function($Tt){var $TM=this._bursts.length;if(0<$TM)for(var $Tf=0;$Tf<$TM;$Tf++)this._bursts[$Tf].time>$Tt.time&&this._bursts.splice($Tf,0,$Tt);this._bursts.push($Tt)},$TM.removeBurst=function($Tt){var $TM=this._bursts.indexOf($Tt);-1!==$TM&&this._bursts.splice($TM,1)},$TM.removeBurstByIndex=function($Tt){this._bursts.splice($Tt,1)},$TM.clearBurst=function(){this._bursts.length=0},$TM.cloneTo=function($Tt){var $TM=$Tt,$Tf=$TM._bursts;$Tf.length=this._bursts.length;for(var $Tc=0,$TD=this._bursts.length;$Tc<$TD;$Tc++){var $To=$Tf[$Tc];$To?this._bursts[$Tc].cloneTo($To):$Tf[$Tc]=this._bursts[$Tc].clone()}$TM._emissionRate=this._emissionRate,$TM.enbale=this.enbale},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"destroyed",function(){return this._destroyed}),$Tq(0,$TM,"emissionRate",function(){return this._emissionRate},function($Tt){if($Tt<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$Tt})}(),function(){function $Tc(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$TI($Tc,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $Tt=$Tc.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,$TM._constant=this._constant,this._overTime.cloneTo($TM._overTime),$TM._constantMin=this._constantMin,$TM._constantMax=this._constantMax,this._overTimeMin.cloneTo($TM._overTimeMin),this._overTimeMax.cloneTo($TM._overTimeMax)},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"frameOverTimeData",function(){return this._overTime}),$Tq(0,$Tt,"constant",function(){return this._constant}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"frameOverTimeDataMin",function(){return this._overTimeMin}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"frameOverTimeDataMax",function(){return this._overTimeMax}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tc.createByConstant=function($Tt){var $TM=new $Tc;return $TM._type=0,$TM._constant=$Tt,$TM},$Tc.createByOverTime=function($Tt){var $TM=new $Tc;return $TM._type=1,$TM._overTime=$Tt,$TM},$Tc.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $Tc;return $Tf._type=2,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$Tc.createByRandomTwoOverTime=function($Tt,$TM){var $Tf=new $Tc;return $Tf._type=3,$Tf._overTimeMin=$Tt,$Tf._overTimeMax=$TM,$Tf},$Tc}()),$Tr=function(){function $TL(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$TI($TL,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $Tt=$TL.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,$TM._separateAxes=this._separateAxes,$TM._constant=this._constant,this._constantSeparate.cloneTo($TM._constantSeparate),this._gradient.cloneTo($TM._gradient),this._gradientX.cloneTo($TM._gradientX),this._gradientY.cloneTo($TM._gradientY),this._gradientZ.cloneTo($TM._gradientZ),$TM._constantMin=this._constantMin,$TM._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($TM._constantMinSeparate),this._constantMaxSeparate.cloneTo($TM._constantMaxSeparate),this._gradientMin.cloneTo($TM._gradientMin),this._gradientMax.cloneTo($TM._gradientMax),this._gradientXMin.cloneTo($TM._gradientXMin),this._gradientXMax.cloneTo($TM._gradientXMax),this._gradientYMin.cloneTo($TM._gradientYMin),this._gradientYMax.cloneTo($TM._gradientYMax),this._gradientZMin.cloneTo($TM._gradientZMin),this._gradientZMax.cloneTo($TM._gradientZMax)},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"gradientZ",function(){return this._gradientZ}),$Tq(0,$Tt,"constant",function(){return this._constant}),$Tq(0,$Tt,"gradient",function(){return this._gradient}),$Tq(0,$Tt,"separateAxes",function(){return this._separateAxes}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"constantSeparate",function(){return this._constantSeparate}),$Tq(0,$Tt,"gradientX",function(){return this._gradientX}),$Tq(0,$Tt,"gradientY",function(){return this._gradientY}),$Tq(0,$Tt,"gradientW",function(){return this._gradientW}),$Tq(0,$Tt,"gradientMin",function(){return this._gradientMin}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"gradientMax",function(){return this._gradientMax}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tq(0,$Tt,"gradientWMin",function(){return this._gradientWMin}),$Tq(0,$Tt,"constantMinSeparate",function(){return this._constantMinSeparate}),$Tq(0,$Tt,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$Tq(0,$Tt,"gradientXMin",function(){return this._gradientXMin}),$Tq(0,$Tt,"gradientXMax",function(){return this._gradientXMax}),$Tq(0,$Tt,"gradientWMax",function(){return this._gradientWMax}),$Tq(0,$Tt,"gradientYMin",function(){return this._gradientYMin}),$Tq(0,$Tt,"gradientYMax",function(){return this._gradientYMax}),$Tq(0,$Tt,"gradientZMin",function(){return this._gradientZMin}),$Tq(0,$Tt,"gradientZMax",function(){return this._gradientZMax}),$TL.createByConstant=function($Tt){var $TM=new $TL;return $TM._type=0,$TM._separateAxes=!1,$TM._constant=$Tt,$TM},$TL.createByConstantSeparate=function($Tt){var $TM=new $TL;return $TM._type=0,$TM._separateAxes=!0,$TM._constantSeparate=$Tt,$TM},$TL.createByGradient=function($Tt){var $TM=new $TL;return $TM._type=1,$TM._separateAxes=!1,$TM._gradient=$Tt,$TM},$TL.createByGradientSeparate=function($Tt,$TM,$Tf,$Tc){var $TD=new $TL;return $TD._type=1,$TD._separateAxes=!0,$TD._gradientX=$Tt,$TD._gradientY=$TM,$TD._gradientZ=$Tf,$TD._gradientW=$Tc,$TD},$TL.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $TL;return $Tf._type=2,$Tf._separateAxes=!1,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$TL.createByRandomTwoConstantSeparate=function($Tt,$TM){var $Tf=new $TL;return $Tf._type=2,$Tf._separateAxes=!0,$Tf._constantMinSeparate=$Tt,$Tf._constantMaxSeparate=$TM,$Tf},$TL.createByRandomTwoGradient=function($Tt,$TM){var $Tf=new $TL;return $Tf._type=3,$Tf._separateAxes=!1,$Tf._gradientMin=$Tt,$Tf._gradientMax=$TM,$Tf},$TL.createByRandomTwoGradientSeparate=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){var $TA=new $TL;return $TA._type=3,$TA._separateAxes=!0,$TA._gradientXMin=$Tt,$TA._gradientXMax=$TM,$TA._gradientYMin=$Tf,$TA._gradientYMax=$Tc,$TA._gradientZMin=$TD,$TA._gradientZMax=$To,$TA._gradientWMin=$TJ,$TA._gradientWMax=$TZ,$TA},$TL}(),$Tu=function(){function $Tc(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$TI($Tc,"laya.d3.core.particleShuriKen.module.GradientColor");var $Tt=$Tc.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,this._constant.cloneTo($TM._constant),this._constantMin.cloneTo($TM._constantMin),this._constantMax.cloneTo($TM._constantMax),this._gradient.cloneTo($TM._gradient),this._gradientMin.cloneTo($TM._gradientMin),this._gradientMax.cloneTo($TM._gradientMax)},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"gradient",function(){return this._gradient}),$Tq(0,$Tt,"constant",function(){return this._constant}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"gradientMin",function(){return this._gradientMin}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"gradientMax",function(){return this._gradientMax}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tc.createByConstant=function($Tt){var $TM=new $Tc;return $TM._type=0,$TM._constant=$Tt,$TM},$Tc.createByGradient=function($Tt){var $TM=new $Tc;return $TM._type=1,$TM._gradient=$Tt,$TM},$Tc.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $Tc;return $Tf._type=2,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$Tc.createByRandomTwoGradient=function($Tt,$TM){var $Tf=new $Tc;return $Tf._type=3,$Tf._gradientMin=$Tt,$Tf._gradientMax=$TM,$Tf},$Tc}(),$Tv=(function(){function $Tt(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$TI($Tt,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.addAlpha=function($Tt,$TM){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$Tt&&($Tt=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$Tt,this._alphaElements[this._alphaCurrentLength++]=$TM):DEBUG},$TM.addRGB=function($Tt,$TM){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$Tt&&($Tt=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$Tt,this._rgbElements[this._rgbCurrentLength++]=$TM.x,this._rgbElements[this._rgbCurrentLength++]=$TM.y,this._rgbElements[this._rgbCurrentLength++]=$TM.z):DEBUG},$TM.cloneTo=function($Tt){var $TM=$Tt,$Tf=0,$Tc=0;$TM._alphaCurrentLength=this._alphaCurrentLength;var $TD=$TM._alphaElements;for($TD.length=this._alphaElements.length,$Tf=0,$Tc=this._alphaElements.length;$Tf<$Tc;$Tf++)$TD[$Tf]=this._alphaElements[$Tf];$TM._rgbCurrentLength=this._rgbCurrentLength;var $To=$TM._rgbElements;for($To.length=this._rgbElements.length,$Tf=0,$Tc=this._rgbElements.length;$Tf<$Tc;$Tf++)$To[$Tf]=this._rgbElements[$Tf]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$Tq(0,$TM,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $Tt(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$TI($Tt,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.add=function($Tt,$TM){this._currentLength<8?(6===this._currentLength&&1!==$Tt&&($Tt=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$Tt,this._elements[this._currentLength++]=$TM):console.log("Warning:data count must lessEqual than 4")},$TM.cloneTo=function($Tt){var $TM=$Tt;$TM._currentLength=this._currentLength;var $Tf=$TM._elements;$Tf.length=this._elements.length;for(var $Tc=0,$TD=this._elements.length;$Tc<$TD;$Tc++)$Tf[$Tc]=this._elements[$Tc]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"gradientCount",function(){return this._currentLength/2})}(),function(){function $Tt(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$TI($Tt,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.add=function($Tt,$TM){this._currentLength<8?(6===this._currentLength&&1!==$Tt&&($Tt=1,DEBUG),this._elements[this._currentLength++]=$Tt,this._elements[this._currentLength++]=$TM):DEBUG},$TM.getKeyByIndex=function($Tt){return this._elements[2*$Tt]},$TM.getValueByIndex=function($Tt){return this._elements[2*$Tt+1]},$TM.getAverageValue=function(){for(var $Tt=0,$TM=this._currentLength-2;$Tt<$TM;$Tt+=2){this._elements[$Tt+1];this._elements[$Tt+3],this._elements[$Tt+2]-this._elements[$Tt]}return 0},$TM.cloneTo=function($Tt){var $TM=$Tt;$TM._currentLength=this._currentLength;var $Tf=$TM._elements;$Tf.length=this._elements.length;for(var $Tc=0,$TD=this._elements.length;$Tc<$TD;$Tc++)$Tf[$Tc]=this._elements[$Tc]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"gradientCount",function(){return this._currentLength/2})}(),function(){function $Tt(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$TI($Tt,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.add=function($Tt,$TM){this._currentLength<8?(6===this._currentLength&&1!==$Tt&&($Tt=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$Tt,this._elements[this._currentLength++]=$TM.x,this._elements[this._currentLength++]=$TM.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$TM.cloneTo=function($Tt){var $TM=$Tt;$TM._currentLength=this._currentLength;var $Tf=$TM._elements;$Tf.length=this._elements.length;for(var $Tc=0,$TD=this._elements.length;$Tc<$TD;$Tc++)$Tf[$Tc]=this._elements[$Tc]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"gradientCount",function(){return this._currentLength/3})}(),function(){function $TZ(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$TI($TZ,"laya.d3.core.particleShuriKen.module.GradientSize");var $Tt=$TZ.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.getMaxSizeInGradient=function(){var $Tt=0,$TM=0,$Tf=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($Tt=0,$TM=this._gradientX.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientX.getValueByIndex($Tt));for($Tt=0,$TM=this._gradientY.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientY.getValueByIndex($Tt))}else for($Tt=0,$TM=this._gradient.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradient.getValueByIndex($Tt));break;case 1:$Tf=this._separateAxes?($Tf=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$Tf=Math.max($Tf,this._constantMinSeparate.y),Math.max($Tf,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($Tt=0,$TM=this._gradientXMin.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientXMin.getValueByIndex($Tt));for($Tt=0,$TM=this._gradientXMax.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientXMax.getValueByIndex($Tt));for($Tt=0,$TM=this._gradientYMin.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientYMin.getValueByIndex($Tt));for($Tt=0,$TM=this._gradientZMax.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientZMax.getValueByIndex($Tt))}else{for($Tt=0,$TM=this._gradientMin.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientMin.getValueByIndex($Tt));for($Tt=0,$TM=this._gradientMax.gradientCount;$Tt<$TM;$Tt++)$Tf=Math.max($Tf,this._gradientMax.getValueByIndex($Tt))}}return $Tf},$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,$TM._separateAxes=this._separateAxes,this._gradient.cloneTo($TM._gradient),this._gradientX.cloneTo($TM._gradientX),this._gradientY.cloneTo($TM._gradientY),this._gradientZ.cloneTo($TM._gradientZ),$TM._constantMin=this._constantMin,$TM._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($TM._constantMinSeparate),this._constantMaxSeparate.cloneTo($TM._constantMaxSeparate),this._gradientMin.cloneTo($TM._gradientMin),this._gradientMax.cloneTo($TM._gradientMax),this._gradientXMin.cloneTo($TM._gradientXMin),this._gradientXMax.cloneTo($TM._gradientXMax),this._gradientYMin.cloneTo($TM._gradientYMin),this._gradientYMax.cloneTo($TM._gradientYMax),this._gradientZMin.cloneTo($TM._gradientZMin),this._gradientZMax.cloneTo($TM._gradientZMax)},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"gradientZ",function(){return this._gradientZ}),$Tq(0,$Tt,"gradient",function(){return this._gradient}),$Tq(0,$Tt,"separateAxes",function(){return this._separateAxes}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"gradientMin",function(){return this._gradientMin}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"gradientX",function(){return this._gradientX}),$Tq(0,$Tt,"gradientY",function(){return this._gradientY}),$Tq(0,$Tt,"gradientMax",function(){return this._gradientMax}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tq(0,$Tt,"constantMinSeparate",function(){return this._constantMinSeparate}),$Tq(0,$Tt,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$Tq(0,$Tt,"gradientXMin",function(){return this._gradientXMin}),$Tq(0,$Tt,"gradientXMax",function(){return this._gradientXMax}),$Tq(0,$Tt,"gradientYMin",function(){return this._gradientYMin}),$Tq(0,$Tt,"gradientYMax",function(){return this._gradientYMax}),$Tq(0,$Tt,"gradientZMin",function(){return this._gradientZMin}),$Tq(0,$Tt,"gradientZMax",function(){return this._gradientZMax}),$TZ.createByGradient=function($Tt){var $TM=new $TZ;return $TM._type=0,$TM._separateAxes=!1,$TM._gradient=$Tt,$TM},$TZ.createByGradientSeparate=function($Tt,$TM,$Tf){var $Tc=new $TZ;return $Tc._type=0,$Tc._separateAxes=!0,$Tc._gradientX=$Tt,$Tc._gradientY=$TM,$Tc._gradientZ=$Tf,$Tc},$TZ.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $TZ;return $Tf._type=1,$Tf._separateAxes=!1,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$TZ.createByRandomTwoConstantSeparate=function($Tt,$TM){var $Tf=new $TZ;return $Tf._type=1,$Tf._separateAxes=!0,$Tf._constantMinSeparate=$Tt,$Tf._constantMaxSeparate=$TM,$Tf},$TZ.createByRandomTwoGradient=function($Tt,$TM){var $Tf=new $TZ;return $Tf._type=2,$Tf._separateAxes=!1,$Tf._gradientMin=$Tt,$Tf._gradientMax=$TM,$Tf},$TZ.createByRandomTwoGradientSeparate=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=new $TZ;return $TJ._type=2,$TJ._separateAxes=!0,$TJ._gradientXMin=$Tt,$TJ._gradientXMax=$TM,$TJ._gradientYMin=$Tf,$TJ._gradientYMax=$Tc,$TJ._gradientZMin=$TD,$TJ._gradientZMax=$To,$TJ},$TZ}()),$Tk=function(){function $TZ(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$TI($TZ,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $Tt=$TZ.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,this._constant.cloneTo($TM._constant),this._gradientX.cloneTo($TM._gradientX),this._gradientY.cloneTo($TM._gradientY),this._gradientZ.cloneTo($TM._gradientZ),this._constantMin.cloneTo($TM._constantMin),this._constantMax.cloneTo($TM._constantMax),this._gradientXMin.cloneTo($TM._gradientXMin),this._gradientXMax.cloneTo($TM._gradientXMax),this._gradientYMin.cloneTo($TM._gradientYMin),this._gradientYMax.cloneTo($TM._gradientYMax),this._gradientZMin.cloneTo($TM._gradientZMin),this._gradientZMax.cloneTo($TM._gradientZMax)},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"gradientZ",function(){return this._gradientZ}),$Tq(0,$Tt,"constant",function(){return this._constant}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"gradientXMax",function(){return this._gradientXMax}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"gradientX",function(){return this._gradientX}),$Tq(0,$Tt,"gradientY",function(){return this._gradientY}),$Tq(0,$Tt,"gradientXMin",function(){return this._gradientXMin}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tq(0,$Tt,"gradientYMin",function(){return this._gradientYMin}),$Tq(0,$Tt,"gradientYMax",function(){return this._gradientYMax}),$Tq(0,$Tt,"gradientZMin",function(){return this._gradientZMin}),$Tq(0,$Tt,"gradientZMax",function(){return this._gradientZMax}),$TZ.createByConstant=function($Tt){var $TM=new $TZ;return $TM._type=0,$TM._constant=$Tt,$TM},$TZ.createByGradient=function($Tt,$TM,$Tf){var $Tc=new $TZ;return $Tc._type=1,$Tc._gradientX=$Tt,$Tc._gradientY=$TM,$Tc._gradientZ=$Tf,$Tc},$TZ.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $TZ;return $Tf._type=2,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$TZ.createByRandomTwoGradient=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=new $TZ;return $TJ._type=3,$TJ._gradientXMin=$Tt,$TJ._gradientXMax=$TM,$TJ._gradientYMin=$Tf,$TJ._gradientYMax=$Tc,$TJ._gradientZMin=$TD,$TJ._gradientZMax=$To,$TJ},$TZ}(),$TK=(function(){function $Tt($Tt){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$Tt}$TI($Tt,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.cloneTo=function($Tt){var $TM=$Tt;this._angularVelocity.cloneTo($TM._angularVelocity),$TM.enbale=this.enbale},$TM.clone=function(){var $Tt;switch(this._angularVelocity.type){case 0:$Tt=this._angularVelocity.separateAxes?$Tr.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$Tr.createByConstant(this._angularVelocity.constant);break;case 1:$Tt=this._angularVelocity.separateAxes?$Tr.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$Tr.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$Tt=this._angularVelocity.separateAxes?$Tr.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$Tr.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$Tt=this._angularVelocity.separateAxes?$Tr.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$Tr.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $TM=new this.constructor($Tt);return $TM.enbale=this.enbale,$TM},$Tq(0,$TM,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $Tt(){this.enable=!1,this.randomDirection=!1}$TI($Tt,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM._getShapeBoundBox=function($Tt){throw new Error("BaseShape: must override it.")},$TM._getSpeedBoundBox=function($Tt){throw new Error("BaseShape: must override it.")},$TM.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){throw new Error("BaseShape: must override it.")},$TM._calculateProceduralBounds=function($Tt,$TM,$Tf){this._getShapeBoundBox($Tt);var $Tc=$Tt.min,$TD=$Tt.max;$TJM.multiply($Tc,$TM,$Tc),$TJM.multiply($TD,$TM,$TD);var $To=new $TGt(new $TJM,new $TJM);this.randomDirection?($To.min=new $TJM(-1,-1,-1),$To.max=new $TJM(1,1,1)):this._getSpeedBoundBox($To);var $TJ=new $TGt(new $TJM,new $TJM),$TZ=$TJ.min,$TA=$TJ.max;$TJM.scale($To.min,$Tf.y,$TZ),$TJM.scale($To.max,$Tf.y,$TA),$TJM.add($Tt.min,$TZ,$TZ),$TJM.add($Tt.max,$TA,$TA),$TJM.min($Tt.min,$TZ,$Tt.min),$TJM.max($Tt.max,$TZ,$Tt.max);var $TL=new $TGt(new $TJM,new $TJM),$Tp=$TL.min,$TB=$TL.max;$TJM.scale($To.min,$Tf.x,$Tp),$TJM.scale($To.max,$Tf.x,$TB),$TJM.min($TL.min,$TB,$TZ),$TJM.max($TL.min,$TB,$TA),$TJM.min($Tt.min,$TZ,$Tt.min),$TJM.max($Tt.max,$TZ,$Tt.max)},$TM.cloneTo=function($Tt){$Tt.enable=this.enable},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tt}()),$TY=function(){function $To(){}return $TI($To,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$To._randomPointUnitArcCircle=function($Tt,$TM,$Tf){var $Tc=$TM.elements,$TD=NaN;$TD=$Tf?$Tf.getFloat()*$Tt:Math.random()*$Tt,$Tc[0]=Math.cos($TD),$Tc[1]=Math.sin($TD)},$To._randomPointInsideUnitArcCircle=function($Tt,$TM,$Tf){var $Tc=$TM.elements;$To._randomPointUnitArcCircle($Tt,$TM,$Tf);var $TD=NaN;$TD=$Tf?Math.pow($Tf.getFloat(),.5):Math.pow(Math.random(),.5),$Tc[0]=$Tc[0]*$TD,$Tc[1]=$Tc[1]*$TD},$To._randomPointUnitCircle=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=NaN;$Tc=$TM?$TM.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$Tf[0]=Math.cos($Tc),$Tf[1]=Math.sin($Tc)},$To._randomPointInsideUnitCircle=function($Tt,$TM){var $Tf=$Tt.elements;$To._randomPointUnitCircle($Tt);var $Tc=NaN;$Tc=$TM?Math.pow($TM.getFloat(),.5):Math.pow(Math.random(),.5),$Tf[0]=$Tf[0]*$Tc,$Tf[1]=$Tf[1]*$Tc},$To._randomPointUnitSphere=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=NaN,$TD=NaN;$TD=$TM?($Tc=$Tf[2]=2*$TM.getFloat()-1,$TM.getFloat()*Math.PI*2):($Tc=$Tf[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $To=Math.sqrt(1-$Tc*$Tc);$Tf[0]=$To*Math.cos($TD),$Tf[1]=$To*Math.sin($TD)},$To._randomPointInsideUnitSphere=function($Tt,$TM){var $Tf=$Tt.elements;$To._randomPointUnitSphere($Tt);var $Tc=NaN;$Tc=$TM?Math.pow($TM.getFloat(),1/3):Math.pow(Math.random(),1/3),$Tf[0]=$Tf[0]*$Tc,$Tf[1]=$Tf[1]*$Tc,$Tf[2]=$Tf[2]*$Tc},$To._randomPointInsideHalfUnitBox=function($Tt,$TM){var $Tf=$Tt.elements;$TM?($Tf[0]=$TM.getFloat()-.5,$Tf[1]=$TM.getFloat()-.5,$Tf[2]=$TM.getFloat()-.5):($Tf[0]=Math.random()-.5,$Tf[1]=Math.random()-.5,$Tf[2]=Math.random()-.5)},$To}(),$Tn=(function(){function $Tt($Tt){this._size=null,this.enbale=!1,this._size=$Tt}$TI($Tt,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.cloneTo=function($Tt){var $TM=$Tt;this._size.cloneTo($TM._size),$TM.enbale=this.enbale},$TM.clone=function(){var $Tt;switch(this._size.type){case 0:$Tt=this._size.separateAxes?$Tv.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$Tv.createByGradient(this._size.gradient.clone());break;case 1:$Tt=this._size.separateAxes?$Tv.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$Tv.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$Tt=this._size.separateAxes?$Tv.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$Tv.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $TM=new this.constructor($Tt);return $TM.enbale=this.enbale,$TM},$Tq(0,$TM,"size",function(){return this._size})}(),function(){function $Tc(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$TI($Tc,"laya.d3.core.particleShuriKen.module.StartFrame");var $Tt=$Tc.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._type=this._type,$TM._constant=this._constant,$TM._constantMin=this._constantMin,$TM._constantMax=this._constantMax},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tt,"constant",function(){return this._constant}),$Tq(0,$Tt,"type",function(){return this._type}),$Tq(0,$Tt,"constantMin",function(){return this._constantMin}),$Tq(0,$Tt,"constantMax",function(){return this._constantMax}),$Tc.createByConstant=function($Tt){var $TM=new $Tc;return $TM._type=0,$TM._constant=$Tt,$TM},$Tc.createByRandomTwoConstant=function($Tt,$TM){var $Tf=new $Tc;return $Tf._type=1,$Tf._constantMin=$Tt,$Tf._constantMax=$TM,$Tf},$Tc}()),$TR=(function(){function $Tt($Tt,$TM){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $ToM(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$Tt,this._startFrame=$TM}$TI($Tt,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.cloneTo=function($Tt){var $TM=$Tt;this.tiles.cloneTo($TM.tiles),$TM.type=this.type,$TM.randomRow=this.randomRow,this._frame.cloneTo($TM._frame),this._startFrame.cloneTo($TM._startFrame),$TM.cycles=this.cycles,$TM.enableUVChannels=this.enableUVChannels,$TM.enable=this.enable},$TM.clone=function(){var $Tt,$TM;switch(this._frame.type){case 0:$Tt=$Ts.createByConstant(this._frame.constant);break;case 1:$Tt=$Ts.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$Tt=$Ts.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$Tt=$Ts.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$TM=$Tn.createByConstant(this._startFrame.constant);break;case 1:$TM=$Tn.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $Tf=new this.constructor($Tt,$TM);return this.tiles.cloneTo($Tf.tiles),$Tf.type=this.type,$Tf.randomRow=this.randomRow,$Tf.cycles=this.cycles,$Tf.enableUVChannels=this.enableUVChannels,$Tf.enable=this.enable,$Tf},$Tq(0,$TM,"frame",function(){return this._frame}),$Tq(0,$TM,"startFrame",function(){return this._startFrame})}(),function(){function $Tt($Tt){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$Tt}$TI($Tt,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.cloneTo=function($Tt){var $TM=$Tt;this._velocity.cloneTo($TM._velocity),$TM.enbale=this.enbale,$TM.space=this.space},$TM.clone=function(){var $Tt;switch(this._velocity.type){case 0:$Tt=$Tk.createByConstant(this._velocity.constant.clone());break;case 1:$Tt=$Tk.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$Tt=$Tk.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$Tt=$Tk.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $TM=new this.constructor($Tt);return $TM.enbale=this.enbale,$TM.space=this.space,$TM},$Tq(0,$TM,"velocity",function(){return this._velocity})}(),function(){function $Tt(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $TbM,this._vb=$TKM.create($Tt._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$TkM.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$TuM.nameKey.getID("LINE"),this._shaderCompile=$TiM._preCompileShader[this._sharderNameID]}$TI($Tt,"laya.d3.core.PhasorSpriter3D");var $TM=$Tt.prototype;return $TM.line=function($Tt,$TM,$Tf,$Tc){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Tt.x,$Tt.y,$Tt.z,$TM.x,$TM.y,$TM.z,$TM.w),this.addVertex($Tf.x,$Tf.y,$Tf.z,$Tc.x,$Tc.y,$Tc.z,$Tc.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$TM.circle=function($Tt,$TM,$Tf,$Tc,$TD,$To){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$TM,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$TM,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$Tt,Math.cos(this._tempNumver0)*$Tt,0,$Tf,$Tc,$TD,$To),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$TM.plane=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$Tc/2,this._tempNumver1=$TD/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Tt-this._tempNumver0,$TM+this._tempNumver1,$Tf,$To,$TJ,$TZ,$TA),this.addVertex($Tt+this._tempNumver0,$TM+this._tempNumver1,$Tf,$To,$TJ,$TZ,$TA),this.addVertex($Tt-this._tempNumver0,$TM-this._tempNumver1,$Tf,$To,$TJ,$TZ,$TA),this.addVertex($Tt+this._tempNumver0,$TM-this._tempNumver1,$Tf,$To,$TJ,$TZ,$TA),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$TM.box=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$Tc/2,this._tempNumver1=$TD/2,this._tempNumver2=$To/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Tt-this._tempNumver0,$TM+this._tempNumver1,$Tf+this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt+this._tempNumver0,$TM+this._tempNumver1,$Tf+this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt-this._tempNumver0,$TM-this._tempNumver1,$Tf+this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt+this._tempNumver0,$TM-this._tempNumver1,$Tf+this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt+this._tempNumver0,$TM+this._tempNumver1,$Tf-this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt-this._tempNumver0,$TM+this._tempNumver1,$Tf-this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt+this._tempNumver0,$TM-this._tempNumver1,$Tf-this._tempNumver2,$TJ,$TZ,$TA,$TL),this.addVertex($Tt-this._tempNumver0,$TM-this._tempNumver1,$Tf-this._tempNumver2,$TJ,$TZ,$TA,$TL),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$TM.cone=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$Tf+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$Tf>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$Tf,this.addVertexIndex(0,$TM,0,$Tc,$TD,$To,$TJ,this._tempUint0),this.addVertexIndex(0,0,0,$Tc,$TD,$To,$TJ,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$Tf;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($Tt*this._tempNumver2,0,$Tt*this._tempNumver3,$Tc,$TD,$To,$TJ,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$Tf-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($Tt*this._tempNumver2,0,$Tt*this._tempNumver3,$Tc,$TD,$To,$TJ,this._tempUint0+(this._tempInt0+$Tf)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$Tf-1?this.addIndexes(this._tempUint1+$Tf+2):this.addIndexes(this._tempUint1+this._tempInt0+$Tf+1),this.addIndexes(this._tempUint1+this._tempInt0+$Tf),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$TM.boundingBoxLine=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Tt,$TD,$To,$TJ,$TZ,$TA,$TL),this.addVertex($Tc,$TD,$To,$TJ,$TZ,$TA,$TL),this.addVertex($Tt,$TM,$To,$TJ,$TZ,$TA,$TL),this.addVertex($Tc,$TM,$To,$TJ,$TZ,$TA,$TL),this.addVertex($Tc,$TD,$Tf,$TJ,$TZ,$TA,$TL),this.addVertex($Tt,$TD,$Tf,$TJ,$TZ,$TA,$TL),this.addVertex($Tc,$TM,$Tf,$TJ,$TZ,$TA,$TL),this.addVertex($Tt,$TM,$Tf,$TJ,$TZ,$TA,$TL),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$TM.addVertex=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$Tt,this._vbData[this._posInVBData+1]=$TM,this._vbData[this._posInVBData+2]=$Tf,this._vbData[this._posInVBData+3]=$Tc,this._vbData[this._posInVBData+4]=$TD,this._vbData[this._posInVBData+5]=$To,this._vbData[this._posInVBData+6]=$TJ,this._posInVBData+=this._floatSizePerVer,this},$TM.addVertexIndex=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){return this._hasBegun||this.addVertexIndexException(),this._vbData[$TZ]=$Tt,this._vbData[$TZ+1]=$TM,this._vbData[$TZ+2]=$Tf,this._vbData[$TZ+3]=$Tc,this._vbData[$TZ+4]=$TD,this._vbData[$TZ+5]=$To,this._vbData[$TZ+6]=$TJ,($TZ+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$TZ),this},$TM.addIndexes=function($Tt){var $TM=arguments;this._hasBegun||this.addVertexIndexException();for(var $Tf=0;$Tf<$TM.length;$Tf++)this._ibData[this._posInIBData]=$TM[$Tf],this._posInIBData++;return this},$TM.begin=function($Tt,$TM){return this._hasBegun&&this.beginException0(),1!==$Tt&&4!==$Tt&&this.beginException1(),this._primitiveType=$Tt,this._camera=$TM,this._hasBegun=!0,this},$TM.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$TM.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($Tt._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$Ti.drawCall++,$TU.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$TM.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$TM.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$TM.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$TM.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$TM.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$TM.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(28,[new $TJt(0,"vector3",0),new $TJt(12,"vector4",1)])}]),$Tt}()),$Tg=function(){function $Tt(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$Tt._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $TbM}$TI($Tt,"laya.d3.core.render.RenderElement");var $TM=$Tt.prototype;return $TM.getDynamicBatchBakedVertexs=function($Tt){for(var $TM=this._renderObj._getVertexBuffer($Tt),$Tf=$TM.getData().slice(),$Tc=$TM.vertexDeclaration,$TD=$Tc.getVertexElementByUsage(0).offset/4,$To=$Tc.getVertexElementByUsage(3).offset/4,$TJ=this._sprite3D.transform,$TZ=$TJ.worldMatrix,$TA=$TJ.rotation,$TL=$Tc.vertexStride/4,$Tp=0,$TB=$Tf.length;$Tp<$TB;$Tp+=$TL){var $Tb=$Tp+$TD,$TI=$Tp+$To;$T_M.transformVector3ArrayToVector3ArrayCoordinate($Tf,$Tb,$TZ,$Tf,$Tb),$T_M.transformVector3ArrayByQuat($Tf,$TI,$TA,$Tf,$TI)}return $Tf},$TM.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$TM._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$Tq(0,$TM,"id",function(){return this._id}),$Tq(0,$TM,"renderObj",function(){return this._renderObj},function($Tt){this._renderObj!==$Tt&&(this._renderObj=$Tt)}),$Tt._uniqueIDCounter=0,$Tt}(),$Tz=function(){function $TM($Tt){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$TM._uniqueIDCounter,this._needSort=!1,this._scene=$Tt,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$TI($TM,"laya.d3.core.render.RenderQueue");var $Tt=$TM.prototype;return $Tt._sortOpaqueFunc=function($Tt,$TM){if($Tt._render&&$TM._render){var $Tf=$Tt._material.renderQueue-$TM._material.renderQueue;return 0==$Tf?$Tt._render._distanceForSort-$TM._render._distanceForSort:$Tf}return 0},$Tt._sortAlphaFunc=function($Tt,$TM){if($Tt._render&&$TM._render){var $Tf=$Tt._material.renderQueue-$TM._material.renderQueue;return 0==$Tf?$TM._render._distanceForSort-$Tt._render._distanceForSort:$Tf}return 0},$Tt._begainRenderElement=function($Tt,$TM,$Tf){return!!$TM._beforeRender($Tt)},$Tt._sortAlpha=function($Tt){$TM._cameraPosition=$Tt,this._finalElements.sort(this._sortAlphaFunc)},$Tt._sortOpaque=function($Tt){$TM._cameraPosition=$Tt,this._finalElements.sort(this._sortOpaqueFunc)},$Tt._preRender=function($Tt){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$Tt._render=function($Tt,$TM){for(var $Tf,$Tc,$TD,$To,$TJ,$TZ,$TA=$Ti.loopCount,$TL=this._scene,$Tp=$Tt.camera,$TB=($Tp.id,!1),$Tb=0,$TI=this._finalElements.length;$Tb<$TI;$Tb++){var $Tq,$Tl,$T_,$TE=this._finalElements[$Tb];if(null!=$TE._onPreRenderFunction&&$TE._onPreRenderFunction.call($TE._sprite3D,$Tt),0===$TE._type){if($Tt.owner=$T_=$TE._sprite3D,$Tt.renderElement=$TE,$T_._preRenderUpdateComponents($Tt),$Tq=$TE.renderObj,$Tl=$TE._material,this._begainRenderElement($Tt,$Tq,$Tl)){if($Tf=$Tq._getVertexBuffers(),!($TD=($Tc=$Tq._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$Tc.id]){this._errorRecord[$Tc.id]=1;var $Te="vertexBuffer:"+("("+$Tc._destroyed+","+$Tc._released+","+$Tc._referenceCount+","+$Tc._buffer+")")+", material:"+($Tl?$Tl.__className+"("+$Tl._destroyed+","+$Tl._released+")":"null")+", owner:"+($T_?$T_.__className+"("+$T_._destroyed+","+$T_._activeInHierarchy+","+$T_._displayedInStage+")":"null")+", renderObj:"+($Tq?$Tq.__className+"("+$Tq._destroyed+","+$Tq._released+","+$Tq._referenceCount+")":"")+", parent:, url:"+($T_?$T_.url:"")+", disposeStack:"+$Tc.disposeStack;$Ty.recordError("报错：unknown vertexDeclaration  "+$Te)}continue}if($TB=($To=$Tt._shader=$Tl._getShader($TL._shaderDefineValue,$TD.shaderDefineValue,$T_._shaderDefineValue)).bind()||$TA!==$To._uploadLoopCount,$Tf){if($To._uploadVertexBuffer!==$Tf||$TB){for(var $TN=0;$TN<$Tf.length;$TN++){var $TX=$Tf[$TN];$To.uploadAttributesX($TX.vertexDeclaration.shaderValues.data,$TX)}$To._uploadVertexBuffer=$Tf}}else($To._uploadVertexBuffer!==$Tc||$TB)&&($To.uploadAttributes($TD.shaderValues.data,null),$To._uploadVertexBuffer=$Tc);($To._uploadScene!==$TL||$TB)&&($To.uploadSceneUniforms($TL._shaderValues.data),$To._uploadScene=$TL),($Tp!==$To._uploadCamera||$To._uploadSprite3D!==$T_||$TB)&&($To.uploadSpriteUniforms($T_._shaderValues.data),$To._uploadSprite3D=$T_),($Tp!==$To._uploadCamera||$TB)&&($To.uploadCameraUniforms($Tp._shaderValues.data),$To._uploadCamera=$Tp),($To._uploadMaterial!==$Tl||$TB)&&($Tl._upload(),$To._uploadMaterial=$Tl),$TJ!==$Tl?($Tl._setRenderStateBlendDepth(),$Tl._setRenderStateFrontFace($TM,$T_.transform),$TJ=$Tl,$TZ=$T_):$TZ!==$T_&&($Tl._setRenderStateFrontFace($TM,$T_.transform),$TZ=$T_),$Tq._render($Tt),$To._uploadLoopCount=$TA}$T_._postRenderUpdateComponents($Tt)}else if(2===$TE._type){$TE.renderObj;$Tt.owner=$T_=$TE._sprite3D,$Tt.renderElement=$TE,$Tt._batchIndexStart=$TE._tempBatchIndexStart,$Tt._batchIndexEnd=$TE._tempBatchIndexEnd,$Tq=$TE.renderObj,$Tl=$TE._material,this._begainRenderElement($Tt,$Tq,$Tl)&&($TD=($Tc=$Tq._getVertexBuffer(0)).vertexDeclaration,$TB=($To=$Tt._shader=$Tl._getShader($TL._shaderDefineValue,$TD.shaderDefineValue,$T_._shaderDefineValue)).bind()||$TA!==$To._uploadLoopCount,($To._uploadVertexBuffer!==$Tc||$TB)&&($To.uploadAttributes($TD.shaderValues.data,null),$To._uploadVertexBuffer=$Tc),($To._uploadScene!==$TL||$TB)&&($To.uploadSceneUniforms($TL._shaderValues.data),$To._uploadScene=$TL),($Tp!==$To._uploadCamera||$To._uploadSprite3D!==$T_||$TB)&&($To.uploadSpriteUniforms($T_._shaderValues.data),$To._uploadSprite3D=$T_),($Tp!==$To._uploadCamera||$TB)&&($To.uploadCameraUniforms($Tp._shaderValues.data),$To._uploadCamera=$Tp),($To._uploadMaterial!==$Tl||$TB)&&($Tl._upload(),$To._uploadMaterial=$Tl),$TJ!==$Tl?($Tl._setRenderStateBlendDepth(),$Tl._setRenderStateFrontFace($TM,$T_.transform),$TJ=$Tl,$TZ=$T_):$TZ!==$T_&&($Tl._setRenderStateFrontFace($TM,$T_.transform),$TZ=$T_),$Tq._render($Tt),$To._uploadLoopCount=$TA)}}},$Tt._renderShadow=function($Tt,$TM){for(var $Tf,$Tc,$TD,$To,$TJ,$TZ=$Ti.loopCount,$TA=this._scene,$TL=$Tt.camera,$Tp=!1,$TB=0,$Tb=this._finalElements.length;$TB<$Tb;$TB++){var $TI,$Tq,$Tl,$T_=this._finalElements[$TB];0===$T_._type&&($Tt.owner=$Tl=$T_._sprite3D,$TM||$Tl._projectionViewWorldUpdateCamera===$TL&&$Tl._projectionViewWorldUpdateLoopCount===$Ti.loopCount||($Tl._render._renderUpdate($Tt._projectionViewMatrix),$Tl._projectionViewWorldUpdateLoopCount=$Ti.loopCount,$Tl._projectionViewWorldUpdateCamera=$TL),$Tt.renderElement=$T_,$Tl._preRenderUpdateComponents($Tt),$TI=$T_.renderObj,$Tq=$T_._material,this._begainRenderElement($Tt,$TI,null)&&($Tc=($Tf=$TI._getVertexBuffer(0)).vertexDeclaration,$Tp=($TD=$Tt._shader=$Tq._getShader($TA._shaderDefineValue,$Tc.shaderDefineValue,$Tl._shaderDefineValue)).bind()||$TZ!==$TD._uploadLoopCount,($TD._uploadVertexBuffer!==$Tf||$Tp)&&($TD.uploadAttributes($Tc.shaderValues.data,null),$TD._uploadVertexBuffer=$Tf),($TL!==$TD._uploadCamera||$TD._uploadSprite3D!==$Tl||$Tp)&&($TD.uploadSpriteUniforms($Tl._shaderValues.data),$TD._uploadSprite3D=$Tl),($TL!==$TD._uploadCamera||$Tp)&&($TD.uploadCameraUniforms($TL._shaderValues.data),$TD._uploadCamera=$TL),($TD._uploadMaterial!==$Tq||$Tp)&&($Tq._upload(),$TD._uploadMaterial=$Tq),$TD._uploadRenderElement,$To!==$Tq?($Tq._setRenderStateFrontFace(!1,$Tl.transform),$To=$Tq,$TJ=$Tl):$TJ!==$Tl&&($Tq._setRenderStateFrontFace(!1,$Tl.transform),$TJ=$Tl),$TI._render($Tt),$TD._uploadLoopCount=$TZ),$Tl._postRenderUpdateComponents($Tt))}},$Tt._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$Tt._addRenderElement=function($Tt){this._renderElements.push($Tt),this._needSort=!0},$Tt._addDynamicBatchElement=function($Tt){this._dynamicBatchCombineRenderElements.push($Tt)},$Tq(0,$Tt,"id",function(){return this._id}),$TM._uniqueIDCounter=0,$TM._cameraPosition=null,$TM}(),$Tm=function(){function $Tt(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $TI($Tt,"laya.d3.core.render.RenderState"),$Tt.clientWidth=0,$Tt.clientHeight=0,$Tt}(),$TG=function(){function $TJ($Tt,$TM){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $TQt(new $TJM,0),this._corners=[new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM],this._boundingBoxCenter=new $TJM,this._children=$Tc(8),this._objects=[],this._tempBoundBoxCorners=[new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM],this._scene=$Tt,this._currentDepth=$TM}$TI($TJ,"laya.d3.core.scene.OctreeNode");var $Tt=$TJ.prototype;return $Ty.imps($Tt,{"laya.d3.core.scene.ITreeNode":!0}),$Tt.init=function($Tt,$TM){var $Tf=new $TJM,$Tc=new $TJM;$TJM.scale($TM,-.5,$Tf),$TJM.scale($TM,.5,$Tc),$TJM.add($Tf,$Tt,$Tf),$TJM.add($Tc,$Tt,$Tc),this.exactBox=new $TGt($Tf,$Tc),this.relaxBox=new $TGt($Tf,$Tc)},$Tt.addTreeNode=function($Tt){1===Collision.boxContainsBox(this._relaxBox,$Tt.boundingBox)?this.addNodeDown($Tt,0):this.addObject($Tt)},$Tt.addChild=function($Tt){var $TM=this._children[$Tt];if(null==$TM){$TM=new $TJ(this._scene,this._currentDepth+1),(this._children[$Tt]=$TM)._parent=this,$TJM.subtract(this._exactBox.max,this._exactBox.min,$TJ.tempSize),$TJM.multiply($TJ.tempSize,$TJ._octreeSplit[$Tt],$TJ.tempCenter),$TJM.add(this._exactBox.min,$TJ.tempCenter,$TJ.tempCenter),$TJM.scale($TJ.tempSize,.25,$TJ.tempSize);var $Tf=new $TJM,$Tc=new $TJM;$TJM.subtract($TJ.tempCenter,$TJ.tempSize,$Tf),$TJM.add($TJ.tempCenter,$TJ.tempSize,$Tc),$TM.exactBox=new $TGt($Tf,$Tc),$TJM.scale($TJ.tempSize,$TJ.relax,$TJ.tempSize);var $TD=new $TJM,$To=new $TJM;$TJM.subtract($TJ.tempCenter,$TJ.tempSize,$TD),$TJM.add($TJ.tempCenter,$TJ.tempSize,$To),$TM.relaxBox=new $TGt($TD,$To)}return $TM},$Tt.addObject=function($Tt){($Tt._treeNode=this)._objects.push($Tt)},$Tt.removeObject=function($Tt){if($Tt._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $TM=this._objects.indexOf($Tt);return-1!==$TM&&(this._objects.splice($TM,1),!0)},$Tt.clearObject=function(){this._objects.length=0},$Tt.addNodeUp=function($Tt,$TM){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$Tt.boundingBox)?this._parent.addNodeUp($Tt,$TM-1):this.addNodeDown($Tt,$TM)},$Tt.addNodeDown=function($Tt,$TM){if($TM<this._scene.treeLevel){var $Tf=this.inChildIndex($Tt.boundingBoxCenter),$Tc=this.addChild($Tf);1===Collision.boxContainsBox($Tc._relaxBox,$Tt.boundingBox)?$Tc.addNodeDown($Tt,++$TM):this.addObject($Tt)}else this.addObject($Tt)},$Tt.inChildIndex=function($Tt){return 4*($Tt.z<this._boundingBoxCenter.z?0:1)+2*($Tt.y<this._boundingBoxCenter.y?0:1)+($Tt.x<this._boundingBoxCenter.x?0:1)},$Tt.updateObject=function($Tt){1===Collision.boxContainsBox(this._relaxBox,$Tt.boundingBox)?(this.removeObject($Tt),$Tt._treeNode=null,this.addNodeDown($Tt,this._currentDepth)):this._parent&&(this.removeObject($Tt),$Tt._treeNode=null,this._parent.addNodeUp($Tt,this._currentDepth-1))},$Tt.cullingObjects=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ=0,$TZ=0,$TA=0,$TL=this._scene._dynamicBatchManager;for($TJ=0,$To=this._objects.length;$TJ<$To;$TJ++){var $Tp=this._objects[$TJ];if($TH.isVisible($Tp._owner.layer.mask)&&$Tp.enable){if($TM&&($Ti.treeSpriteCollision+=1,0===$Tt.containsBoundSphere($Tp.boundingSphere)))continue;$Tp._renderUpdate($TD),$Tp._distanceForSort=$TJM.distance($Tp.boundingSphere.center,$Tc)+$Tp.sortingFudge;var $TB=$Tp._renderElements;for($TZ=0,$TA=$TB.length;$TZ<$TA;$TZ++){var $Tb=$TB[$TZ],$TI=$Tb._staticBatch;if($TI&&$TI._material===$Tb._material)$TI._addBatchRenderElement($Tb);else{var $Tq=$Tb.renderObj;$Tq.triangleCount<10&&1===$Tq._vertexBufferCount&&$Tq._getIndexBuffer()&&$Tb._material.renderQueue<2&&$Tb._canDynamicBatch&&!$Tp._owner.isStatic?$TL._addPrepareRenderElement($Tb):this._scene.getRenderQueue($Tb._material.renderQueue)._addRenderElement($Tb)}}}}for($TJ=0;$TJ<8;$TJ++){var $Tl=this._children[$TJ];if(null!=$Tl){var $T_=$TM;if($TM){var $TE=$Tt.containsBoundBox($Tl._relaxBox);if($Ti.treeNodeCollision+=1,0===$TE)continue;$T_=2===$TE}$Tl.cullingObjects($Tt,$T_,$Tf,$Tc,$TD)}}},$Tt.cullingShadowObjects=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ=0,$TZ=0,$TA=0;this._scene._dynamicBatchManager;for($TJ=0,$To=this._objects.length;$TJ<$To;$TJ++){var $TL=this._objects[$TJ];if($TL.castShadow&&$TH.isVisible($TL._owner.layer.mask)&&$TL.enable){if($Tf&&0===$Tt[0].containsBoundSphere($TL.boundingSphere))continue;for(var $Tp=1,$TB=$Tt.length;$Tp<$TB;$Tp++){var $Tb=$TM[$Tp-1];if(0!==$Tt[$Tp].containsBoundSphere($TL.boundingSphere)){var $TI=$TL._renderElements;for($TZ=0,$TA=$TI.length;$TZ<$TA;$TZ++)$Tb._addRenderElement($TI[$TZ])}}}}for($TJ=0;$TJ<8;$TJ++){var $Tq=this._children[$TJ];if(null!=$Tq){var $Tl=$Tf;if($Tf){var $T_=$Tt[0].containsBoundBox($Tq._relaxBox);if(0===$T_)continue;$Tl=2===$T_}$Tq.cullingShadowObjects($Tt,$TM,$Tl,$Tc,$TD)}}},$Tt.cullingShadowObjectsOnePSSM=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ=$TM[0],$TA=0,$TL=0,$Tp=0;for($TA=0,$TJ=this._objects.length;$TA<$TJ;$TA++){var $TB=this._objects[$TA];if($TB.castShadow&&$TH.isVisible($TB._owner.layer.mask)&&$TB.enable){if($Tc&&0===$Tt.containsBoundSphere($TB.boundingSphere))continue;$TB._renderUpdate($Tf);var $Tb=$TB._renderElements;for($TL=0,$Tp=$Tb.length;$TL<$Tp;$TL++)$TZ._addRenderElement($Tb[$TL])}}for($TA=0;$TA<8;$TA++){var $TI=this._children[$TA];if(null!=$TI){var $Tq=$Tc;if($Tc){var $Tl=$Tt.containsBoundBox($TI._relaxBox);if(0===$Tl)continue;$Tq=2===$Tl}$TI.cullingShadowObjectsOnePSSM($Tt,$TM,$Tf,$Tq,$TD,$To)}}},$Tt.renderBoudingBox=function($Tt){this._renderBoudingBox($Tt);for(var $TM=0;$TM<8;++$TM){var $Tf=this._children[$TM];$Tf&&$Tf.renderBoudingBox($Tt)}},$Tt.buildAllChild=function($Tt){if($Tt<this._scene.treeLevel)for(var $TM=0;$TM<8;$TM++){this.addChild($TM).buildAllChild($Tt+1)}},$Tt._renderBoudingBox=function($Tt){},$Tq(0,$Tt,"exactBox",function(){return this._exactBox},function($Tt){this._exactBox=$Tt,$TJM.add($Tt.min,$Tt.max,this._boundingBoxCenter),$TJM.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$Tq(0,$Tt,"relaxBox",function(){return this._relaxBox},function($Tt){(this._relaxBox=$Tt).getCorners(this._corners),$TQt.createfromPoints(this._corners,this._boundingSphere)}),$TJ.debugMode=!1,$TJ.relax=1.15,$TJ.CHILDNUM=8,$TB($TJ,["tempVector0",function(){return this.tempVector0=new $TJM},"tempSize",function(){return this.tempSize=new $TJM},"tempCenter",function(){return this.tempCenter=new $TJM},"_octreeSplit",function(){return this._octreeSplit=[new $TJM(.25,.25,.25),new $TJM(.75,.25,.25),new $TJM(.25,.75,.25),new $TJM(.75,.75,.25),new $TJM(.25,.25,.75),new $TJM(.75,.25,.75),new $TJM(.25,.75,.75),new $TJM(.75,.75,.75)]}]),$TJ}(),$Ta=(function(){function $Tt(){}$TI($Tt,"laya.d3.core.scene.SceneManager")}(),function(){function $Tt($Tt,$TM,$Tf,$Tc){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$Tt&&($Tt=1),void 0===$TM&&($TM=1),void 0===$Tf&&($Tf=1),void 0===$Tc&&($Tc=1),this._r=$Tt,this._g=$TM,this._b=$Tf,this._a=$Tc}return $TI($Tt,"laya.d3.core.trail.module.Color",null,"Color$1"),$Tt.prototype.cloneTo=function($Tt){$Tt._r=this._r,$Tt._g=this._g,$Tt._b=this._b,$Tt._a=this._a},$TB($Tt,["RED",function(){return this.RED=new $Tt(1,0,0,1)},"GREEN",function(){return this.GREEN=new $Tt(0,1,0,1)},"BLUE",function(){return this.BLUE=new $Tt(0,0,1,1)},"CYAN",function(){return this.CYAN=new $Tt(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $Tt(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $Tt(1,0,1,1)},"GRAY",function(){return this.GRAY=new $Tt(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $Tt(1,1,1,1)},"BLACK",function(){return this.BLACK=new $Tt(0,0,0,1)}]),$Tt}()),$TQ=(function(){function $Tt(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$TI($Tt,"laya.d3.core.trail.module.Gradient");var $TM=$Tt.prototype;$TM.setKeys=function($Tt,$TM){var $Tf,$Tc;this._colorKeys=$Tt;for(var $TD=this.index=0;$TD<$Tt.length;$TD++){var $To=($Tf=$Tt[$TD]).color;this._colorKeyData[this.index++]=$To._r,this._colorKeyData[this.index++]=$To._g,this._colorKeyData[this.index++]=$To._b,this._colorKeyData[this.index++]=$Tf.time}this._alphaKeys=$TM;for(var $TJ=this.index=0;$TJ<$TM.length;$TJ++)$Tc=$TM[$TJ],this._alphaKeyData[this.index++]=$Tc.alpha,this._alphaKeyData[this.index++]=$Tc.time},$TM.cloneTo=function($Tt){var $TM=0,$Tf=0,$Tc=this.colorKeys,$TD=[];for($TM=0,$Tf=$Tc.length;$TM<$Tf;$TM++){var $To=new $Tw;$Tc[$TM].cloneTo($To),$TD.push($To)}var $TJ=this.alphaKeys,$TZ=[];for($TM=0,$Tf=$TJ.length;$TM<$Tf;$TM++){var $TA=new $TQ;$TJ[$TM].cloneTo($TA),$TZ.push($TA)}$Tt.setKeys($TD,$TZ)},$Tq(0,$TM,"mode",function(){return this._mode},function($Tt){this._mode=$Tt}),$Tq(0,$TM,"colorKeys",function(){return this._colorKeys},function($Tt){this._colorKeys=$Tt;for(var $TM=this.index=0;$TM<$Tt.length;$TM++){var $Tf=$Tt[$TM],$Tc=$Tf.color;this._colorKeyData[this.index++]=$Tc._r,this._colorKeyData[this.index++]=$Tc._g,this._colorKeyData[this.index++]=$Tc._b,this._colorKeyData[this.index++]=$Tf.time}}),$Tq(0,$TM,"alphaKeys",function(){return this._alphaKeys},function($Tt){this._alphaKeys=$Tt;for(var $TM=this.index=0;$TM<$Tt.length;$TM++){var $Tf=$Tt[$TM];this._alphaKeyData[this.index++]=$Tf.alpha,this._alphaKeyData[this.index++]=$Tf.time}})}(),function(){function $Tt($Tt,$TM){this._alpha=NaN,this._time=NaN,void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),this._alpha=$Tt,this._time=$TM}$TI($Tt,"laya.d3.core.trail.module.GradientAlphaKey");var $TM=$Tt.prototype;return $TM.cloneTo=function($Tt){$Tt.alpha=this.alpha,$Tt.time=this.time},$Tq(0,$TM,"alpha",function(){return this._alpha},function($Tt){this._alpha=$Tt}),$Tq(0,$TM,"time",function(){return this._time},function($Tt){this._time=$Tt}),$Tt}()),$Tw=function(){function $Tt($Tt,$TM){this._color=null,this._time=NaN,void 0===$TM&&($TM=0),this._color=$Tt||new $Ta,this._time=$TM}$TI($Tt,"laya.d3.core.trail.module.GradientColorKey");var $TM=$Tt.prototype;return $TM.cloneTo=function($Tt){this.color.cloneTo($Tt.color),$Tt.time=this.time},$Tq(0,$TM,"color",function(){return this._color},function($Tt){this._color=$Tt}),$Tq(0,$TM,"time",function(){return this._time},function($Tt){this._time=$Tt}),$Tt}(),$TW=(function(){function $Tt(){}$TI($Tt,"laya.d3.core.trail.module.GradientMode"),$Tt.Blend=0,$Tt.Fixed=1}(),function(){function $Tt(){}$TI($Tt,"laya.d3.core.trail.module.TextureMode"),$Tt.Stretch=0,$Tt.Tile=1}(),function(){function $Tt(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$TI($Tt,"laya.d3.core.trail.module.TrailKeyFrame"),$Tt.prototype.cloneTo=function($Tt){$Tt.time=this.time,$Tt.inTangent=this.inTangent,$Tt.outTangent=this.outTangent,$Tt.value=this.value}}(),function(){function $TM($Tt){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $TJM,this._curPosition=new $TJM,this._delVector3=new $TJM,this._lastFixedVertexPosition=new $TJM,this._pointAtoBVector3=new $TJM,this._pointA=new $TJM,this._pointB=new $TJM,this._owner=$Tt,this._id=$TM.renderElementCount++,0==this._id?$Tt._owner.transform.position.cloneTo(this._lastPosition):$Tt._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $TKM($TW.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $TKM($TW.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$TI($TM,"laya.d3.core.trail.TrailRenderElement");var $Tt=$TM.prototype;$Ty.imps($Tt,{"laya.d3.core.render.IRenderable":!0}),$Tt._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$Tt._addTrailByFirstPosition=function($Tt,$TM){$TJM.subtract($TM,$Tt,this._delVector3),$TJM.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$TJM.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$TJM.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($Tt),$Tt.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$Tt._addTrailByNextPosition=function($Tt){$TJM.subtract($Tt,this._lastFixedVertexPosition,this._delVector3),$TJM.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$TJM.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$TJM.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$TJM.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$Twt.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($Tt),$Tt.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($Tt),this._virtualVerticesCount=2)},$Tt._updateVerticesByPosition=function($Tt){this._pointe=$Tt.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$Tt._updateVertexBuffer2=function(){var $Tt,$TM=0,$Tf=0,$Tc=0;for($Tc=0,$Tt=(this._verticesCount+this._virtualVerticesCount)/2;$Tc<$Tt;$Tc++)$Tf=0==this._owner.textureMode?(this._VerticesToTailLength[$Tc]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$Tc],this._vertices2[$TM++]=1-$Tf,this._vertices2[$TM++]=1-$Tf;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$Tt._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$Tt._updateDisappear=function(){var $Tt,$TM=0;for($TM=this._curDisappearIndex,$Tt=(this._verticesCount+this._virtualVerticesCount)/2;$TM<$Tt;$TM++)this._owner._curtime-this._everyGroupVertexBirthTime[$TM]>=this._owner.time+$Twt.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$Tt._beforeRender=function($Tt){return this._camera=$Tt.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$TJM.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$Tt._render=function($Tt){this._isDead||($TU.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$Ti.drawCall++,$Ti.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$Tt._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),0===$Tt?this._vertexBuffer1:1===$Tt?this._vertexBuffer2:null},$Tt._getVertexBuffers=function(){return this._vertexBuffers},$Tt._getIndexBuffer=function(){return null},$Tt.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$Tt._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$Tq(0,$Tt,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$Tq(0,$Tt,"triangleCount",function(){return 0}),$TM.renderElementCount=0}(),function(){function $Tt(){}$TI($Tt,"laya.d3.core.trail.VertexTrail");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration1}),$Tq(1,$Tt,"vertexDeclaration1",function(){return $Tt._vertexDeclaration1}),$Tq(1,$Tt,"vertexDeclaration2",function(){return $Tt._vertexDeclaration2}),$TB($Tt,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $Tot(32,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",41),new $TJt(24,"single",33),new $TJt(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $Tot(4,[new $TJt(0,"single",38)])}]),$Tt}()),$Ttt=function(){function $TX($Tt){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$Tt}$TI($TX,"laya.d3.graphics.DynamicBatch");var $Tt=$TX.prototype;return $Ty.imps($Tt,{"laya.d3.core.render.IRenderable":!0}),$Tt._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),0===$Tt?this._vertexBuffer:null},$Tt._getIndexBuffer=function(){return this._indexBuffer},$Tt._getCombineRenderElementFromPool=function($Tt,$TM,$Tf){var $Tc=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $Tc||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$Tc=new $Tg,$Tc._sprite3D=new $TzM),$Tc._sprite3D._render._renderUpdate($Tf),$Tc},$Tt._getRenderElement=function($Tt,$TM,$Tf){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$TX.maxVertexCount),this._indexDatas=new Uint16Array($TX.maxIndexCount),this._vertexBuffer=$TKM.create(this._vertexDeclaration,$TX.maxVertexCount,35048),this._indexBuffer=$TkM.create("ushort",$TX.maxIndexCount,35048));for(var $Tc=this._merageElements.length=0,$TD=0,$To=0,$TJ=this._combineRenderElements.length;$To<$TJ;$To++){var $TZ=this._combineRenderElements[$To],$TA=$TZ.getDynamicBatchBakedVertexs(0),$TL=$TZ.getBakedIndices(),$Tp=$TZ._sprite3D.transform._isFrontFaceInvert,$TB=$Tc/(this._vertexDeclaration.vertexStride/4),$Tb=$TD,$TI=$Tb+$TL.length;$TZ._tempBatchIndexStart=$Tb,$TZ._tempBatchIndexEnd=$TI,this._indexDatas.set($TL,$TD);var $Tq=0;if($Tp)for($Tq=$Tb;$Tq<$TI;$Tq+=3){this._indexDatas[$Tq]=$TB+this._indexDatas[$Tq];var $Tl=this._indexDatas[$Tq+1],$T_=this._indexDatas[$Tq+2];this._indexDatas[$Tq+1]=$TB+$T_,this._indexDatas[$Tq+2]=$TB+$Tl}else for($Tq=$Tb;$Tq<$TI;$Tq+=3)this._indexDatas[$Tq]=$TB+this._indexDatas[$Tq],this._indexDatas[$Tq+1]=$TB+this._indexDatas[$Tq+1],this._indexDatas[$Tq+2]=$TB+this._indexDatas[$Tq+2];$TD+=$TL.length,this._vertexDatas.set($TA,$Tc),$Tc+=$TA.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$To=this._combineRenderElementPoolIndex=0,$TJ=this._materials.length;$To<$TJ;$To++){var $TE=this._getCombineRenderElementFromPool($Tt,$TM,$Tf);$TE._type=2,$TE._staticBatch=null;var $Te=($TE.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$To]]._tempBatchIndexStart,$TN=$To+1===this._materialToRenderElementsOffsets.length?$TD:this._combineRenderElements[this._materialToRenderElementsOffsets[$To+1]]._tempBatchIndexStart;$TE._tempBatchIndexStart=$Te,$TE._tempBatchIndexEnd=$TN,$TE._material=this._materials[$To],this._merageElements.push($TE)}},$Tt._addCombineRenderObjTest=function($Tt){var $TM=$Tt.renderObj,$Tf=this._currentCombineIndexCount+$TM._getIndexBuffer().indexCount,$Tc=this._currentCombineVertexCount+$TM._getVertexBuffer().vertexCount;return!($TX.maxVertexCount<$Tc||$TX.maxIndexCount<$Tf)},$Tt._addCombineRenderObj=function($Tt){var $TM=$Tt.renderObj;this._combineRenderElements.push($Tt),this._currentCombineIndexCount=this._currentCombineIndexCount+$TM._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$TM._getVertexBuffer().vertexCount},$Tt._addCombineMaterial=function($Tt){this._materials.push($Tt)},$Tt._addMaterialToRenderElementOffset=function($Tt){this._materialToRenderElementsOffsets.push($Tt)},$Tt._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$Tt._addToRenderQueue=function($Tt,$TM,$Tf,$Tc){this._getRenderElement($TM,$Tf,$Tc);for(var $TD=0,$To=this._materials.length;$TD<$To;$TD++)$Tt.getRenderQueue(this._materials[$TD].renderQueue)._addDynamicBatchElement(this._merageElements[$TD])},$Tt._beforeRender=function($Tt){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Tt._render=function($Tt){var $TM=$Tt._batchIndexEnd-$Tt._batchIndexStart;$TU.mainContext.drawElements(4,$TM,5123,2*$Tt._batchIndexStart),$Ti.drawCall++,$Ti.trianglesFaces+=$TM/3},$Tt._getVertexBuffers=function(){return null},$Tq(0,$Tt,"_vertexBufferCount",function(){return 1}),$Tq(0,$Tt,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$Tq(0,$Tt,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$TX.maxVertexCount=2e4,$TX.maxIndexCount=4e4,$TX.maxCombineTriangleCount=10,$TX}(),$TMt=function(){function $TX(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$TI($TX,"laya.d3.graphics.DynamicBatchManager");var $Tt=$TX.prototype;return $Tt.getDynamicBatch=function($Tt,$TM){var $Tf,$Tc=$Tt.id.toString()+$TM;return this._dynamicBatches[$Tc]?$Tf=this._dynamicBatches[$Tc]:this._dynamicBatches[$Tc]=$Tf=new $Ttt($Tt),$Tf},$Tt._garbageCollection=function(){for(var $Tt in this._dynamicBatches)0===this._dynamicBatches[$Tt].combineRenderElementsCount&&delete this._dynamicBatches[$Tt]},$Tt._addPrepareRenderElement=function($Tt){this._prepareDynamicBatchCombineElements.push($Tt)},$Tt._finishCombineDynamicBatch=function($Tt){var $TM,$Tf,$Tc;this._prepareDynamicBatchCombineElements.sort($TX._sortPrepareDynamicBatch);for(var $TD,$To,$TJ,$TZ,$TA,$TL=-1,$Tp=!0,$TB=0,$Tb=-1,$TI=0,$Tq=this._prepareDynamicBatchCombineElements.length;$TI<$Tq;$TI++){var $Tl=($To=this._prepareDynamicBatchCombineElements[$TI]).renderObj._getVertexBuffer(0).vertexDeclaration,$T_=$Tf!==$Tl;$T_&&($TB=0,$Tf=$Tl);var $TE=$TB!==$TL;if($TE&&($TL=$TB),($T_||$TE)&&($TJ=this.getDynamicBatch($Tl,$TB),$TM=null),$Tp)if($TJ._addCombineRenderObjTest($To)){if($TM!==($TD=$To._material))$TZ&&($Tt.getRenderQueue($TA._material.renderQueue)._addRenderElement($TA),$TA=$TZ=null,$Tb=-1),$TZ=$TD,$Tb=$TJ.combineRenderElementsCount,$TA=$To,$TM=$TD;else if($TZ){var $Te=$TA.renderObj,$TN=$To.renderObj;$Te._getVertexBuffer().vertexCount+$TN._getVertexBuffer().vertexCount>$Ttt.maxVertexCount||$Te._getIndexBuffer().indexCount+$TN._getIndexBuffer().indexCount>$Ttt.maxIndexCount?($Tt.getRenderQueue($TA._material.renderQueue)._addRenderElement($TA),$TZ=$TD,$Tb=$TJ.combineRenderElementsCount,$TA=$To):($TJ._addCombineMaterial($TZ),$TJ._addMaterialToRenderElementOffset($Tb),$TJ._addCombineRenderObj($TA),$TA=$TZ=null,$Tb=-1,$TJ._addCombineRenderObj($To))}else $TJ._addCombineRenderObj($To);$Tp=!0}else $TZ&&($Tt.getRenderQueue($TA._material.renderQueue)._addRenderElement($TA),$TA=$TZ=null,$Tb=-1),$TB++,$Tp=!1;else $Tc=this._prepareDynamicBatchCombineElements[$TI-1],$TJ._addMaterialToRenderElementOffset($TJ.combineRenderElementsCount),$TM=$Tc._material,$TJ._addCombineMaterial($TM),$TJ._addCombineRenderObj($Tc),$Tp=!0,$TM!==($TD=$To._material)?($TZ=$TD,$Tb=$TJ.combineRenderElementsCount,$TA=$To):$TJ._addCombineRenderObj($To),$TM=$TD}$TZ&&($Tt.getRenderQueue($TA._material.renderQueue)._addRenderElement($TA),$TA=$TZ=null,$Tb=-1),this._prepareDynamicBatchCombineElements.length=0},$Tt._clearRenderElements=function(){for(var $Tt in this._dynamicBatches)this._dynamicBatches[$Tt]._clearRenderElements()},$Tt._addToRenderQueue=function($Tt,$TM,$Tf,$Tc){for(var $TD in this._dynamicBatches){var $To=this._dynamicBatches[$TD];0<$To.combineRenderElementsCount&&$To._addToRenderQueue($Tt,$TM,$Tf,$Tc)}},$Tt.dispose=function(){this._dynamicBatches=null},$TX._sortPrepareDynamicBatch=function($Tt,$TM){return $Tt._mainSortID-$TM._mainSortID},$TX}(),$Tft=function(){function $Tt(){}return $TI($Tt,"laya.d3.graphics.FrustumCulling"),$Tt.renderShadowObjectCulling=function($Tt,$TM,$Tf,$Tc,$TD){var $To=0,$TJ=0,$TZ=0,$TA=0;for($To=0,$TZ=$Tf.length;$To<$TZ;$To++){var $TL=$Tf[$To];$TL&&$TL._clearRenderElements()}var $Tp,$TB,$Tb,$TI=$Tt._cullingRenders;if(1<$TD){for($To=0,$TZ=$Tt._cullingRendersLength;$To<$TZ;$To++)if(($Tp=$TI[$To]).castShadow&&$TH.isVisible($Tp._owner.layer.mask)&&$Tp.enable)for(var $Tq=1,$Tl=$TM.length;$Tq<$Tl;$Tq++)if($TB=$Tf[$Tq-1],0!==$TM[$Tq].containsBoundSphere($Tp.boundingSphere))for($TJ=0,$TA=($Tb=$Tp._renderElements).length;$TJ<$TA;$TJ++)$TB._addRenderElement($Tb[$TJ])}else for($To=0,$TZ=$Tt._cullingRendersLength;$To<$TZ;$To++)if(($Tp=$TI[$To]).castShadow&&$TH.isVisible($Tp._owner.layer.mask)&&$Tp.enable&&0!==$TM[0].containsBoundSphere($Tp.boundingSphere))for($Tp._renderUpdate($Tc),$TB=$Tf[0],$TJ=0,$TA=($Tb=$Tp._renderElements).length;$TJ<$TA;$TJ++)$TB._addRenderElement($Tb[$TJ])},$Tt.renderShadowObjectCullingOctree=function($Tt,$TM,$Tf,$Tc,$TD){for(var $To=0,$TJ=$Tf.length;$To<$TJ;$To++){var $TZ=$Tf[$To];$TZ&&$TZ._clearRenderElements()}1<$TD?$Tt.treeRoot.cullingShadowObjects($TM,$Tf,!0,0,$Tt):$Tt.treeRoot.cullingShadowObjectsOnePSSM($TM[0],$Tf,$Tc,!0,0,$Tt)},$Tt.renderObjectCulling=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=0,$TZ=0,$TA=0,$TL=0,$Tp=$TM._quenes,$TB=$TM._dynamicBatchManager,$Tb=$TM._cullingRenders;for($TJ=0,$TZ=$Tp.length;$TJ<$TZ;$TJ++){var $TI=$Tp[$TJ];$TI&&$TI._clearRenderElements()}var $Tq=$Tct._staticBatchManagers;for($TJ=0,$TZ=$Tq.length;$TJ<$TZ;$TJ++)$Tq[$TJ]._clearRenderElements();$TB._clearRenderElements();var $Tl=$Tf.transform.position;for($TJ=0,$TZ=$TM._cullingRendersLength;$TJ<$TZ;$TJ++){var $T_=$Tb[$TJ];if($TH.isVisible($T_._owner.layer.mask)&&$T_.enable&&0!==$Tt.containsBoundSphere($T_.boundingSphere)&&$T_._renderUpdate($To)){$T_._distanceForSort=$TJM.distance($T_.boundingSphere.center,$Tl)+$T_.sortingFudge;var $TE=$T_._renderElements;for($TA=0,$TL=$TE.length;$TA<$TL;$TA++){var $Te=$TE[$TA],$TN=$Te._staticBatch;if($TN&&$TN._material===$Te._material)$TN._addBatchRenderElement($Te);else{var $TX=$Te.renderObj;$TX.triangleCount<10&&1===$TX._vertexBufferCount&&$TX._getIndexBuffer()&&$Te._material.renderQueue<2&&$Te._canDynamicBatch&&!$T_._owner.isStatic?$TB._addPrepareRenderElement($Te):$TM.getRenderQueue($Te._material.renderQueue)._addRenderElement($Te)}}}}for($TJ=0,$TZ=$Tq.length;$TJ<$TZ;$TJ++)$Tq[$TJ]._addToRenderQueue($TM,$Tc,$TD,$To);$TB._finishCombineDynamicBatch($TM),$TB._addToRenderQueue($TM,$Tc,$TD,$To)},$Tt.renderObjectCullingOctree=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=0,$TZ=0,$TA=$TM._quenes,$TL=$TM._dynamicBatchManager;for($TJ=0,$TZ=$TA.length;$TJ<$TZ;$TJ++){var $Tp=$TA[$TJ];$Tp&&$Tp._clearRenderElements()}var $TB=$Tct._staticBatchManagers;for($TJ=0,$TZ=$TB.length;$TJ<$TZ;$TJ++)$TB[$TJ]._clearRenderElements();for($TL._clearRenderElements(),$TM._cullingRenders.length=0,$TM.treeRoot.cullingObjects($Tt,!0,0,$Tf.transform.position,$To),$TJ=0,$TZ=$TB.length;$TJ<$TZ;$TJ++)$TB[$TJ]._addToRenderQueue($TM,$Tc,$TD,$To);$TL._finishCombineDynamicBatch($TM),$TL._addToRenderQueue($TM,$Tc,$TD,$To)},$Tt.renderObjectCullingNoBoundFrustum=function($Tt,$TM,$Tf,$Tc,$TD){var $To=0,$TJ=0,$TZ=0,$TA=0,$TL=$Tt._quenes,$Tp=$Tt._dynamicBatchManager,$TB=$Tt._cullingRenders;for($To=0,$TJ=$TL.length;$To<$TJ;$To++){var $Tb=$TL[$To];$Tb&&$Tb._clearRenderElements()}var $TI=$Tct._staticBatchManagers;for($To=0,$TJ=$TI.length;$To<$TJ;$To++)$TI[$To]._clearRenderElements();$Tp._clearRenderElements();var $Tq=$TM.transform.position;for($To=0,$TJ=$Tt._cullingRendersLength;$To<$TJ;$To++){var $Tl=$TB[$To];if($TH.isVisible($Tl._owner.layer.mask)&&$Tl.enable){$Tl._renderUpdate($TD),$Tl._distanceForSort=$TJM.distance($Tl.boundingSphere.center,$Tq)+$Tl.sortingFudge;var $T_=$Tl._renderElements;for($TZ=0,$TA=$T_.length;$TZ<$TA;$TZ++){var $TE=$T_[$TZ],$Te=$TE._staticBatch;if($Te&&$Te._material===$TE._material)$Te._addBatchRenderElement($TE);else{var $TN=$TE.renderObj;$TN.triangleCount<10&&1===$TN._vertexBufferCount&&$TN._getIndexBuffer()&&$TE._material.renderQueue<2&&$TE._canDynamicBatch&&!$Tl._owner.isStatic?$Tp._addPrepareRenderElement($TE):$Tt.getRenderQueue($TE._material.renderQueue)._addRenderElement($TE)}}}}for($To=0,$TJ=$TI.length;$To<$TJ;$To++)$TI[$To]._addToRenderQueue($Tt,$Tf,$Tc,$TD);$Tp._finishCombineDynamicBatch($Tt),$Tp._addToRenderQueue($Tt,$Tf,$Tc,$TD)},$Tt}(),$Tct=function(){function $To(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$TI($To,"laya.d3.graphics.StaticBatchManager");var $Tt=$To.prototype;return $Tt._finishInit=function(){for(var $Tt in this._staticBatches)this._staticBatches[$Tt]._finishInit();this._initBatchRenderElements.length=0},$Tt._initStaticBatchs=function($Tt){throw new Error("StaticBatchManager:must override this function.")},$Tt._addInitBatchSprite=function($Tt){for(var $TM=$Tt._render._renderElements,$Tf=0,$Tc=$TM.length;$Tf<$Tc;$Tf++)this._initBatchRenderElements.push($TM[$Tf])},$Tt._clearRenderElements=function(){for(var $Tt in this._staticBatches)this._staticBatches[$Tt]._clearRenderElements()},$Tt._garbageCollection=function($Tt){var $TM=$Tt._staticBatch,$Tf=$TM._initBatchRenderElements,$Tc=$Tf.indexOf($Tt);$Tf.splice($Tc,1),0===$Tf.length&&($TM.dispose(),delete this._staticBatches[$TM._key])},$Tt._addToRenderQueue=function($Tt,$TM,$Tf,$Tc){for(var $TD in this._staticBatches){var $To=this._staticBatches[$TD];0<$To._batchRenderElements.length&&$To._updateToRenderQueue($Tt,$Tc)}},$Tt.dispose=function(){this._staticBatches=null},$To._addToStaticBatchQueue=function($Tt){$Tt instanceof laya.d3.core.RenderableSprite3D&&$Tt._addToInitStaticBatchManager();for(var $TM=0,$Tf=$Tt.numChildren;$TM<$Tf;$TM++)$To._addToStaticBatchQueue($Tt._childs[$TM])},$To.combine=function($Tt,$TM){var $Tf,$Tc=0,$TD=0;if($TM)for($Tc=0,$TD=$TM.length;$Tc<$TD;$Tc++){$TM[$Tc]._addToInitStaticBatchManager()}else $Tt&&$To._addToStaticBatchQueue($Tt);for($Tc=0,$TD=$To._staticBatchManagers.length;$Tc<$TD;$Tc++)($Tf=$To._staticBatchManagers[$Tc])._initStaticBatchs($Tt),$Tf._finishInit()},$To._staticBatchManagers=[],$To}(),$TDt=function(){function $Tt($Tt,$TM,$Tf){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$Tt,this._manager=$TM,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$Tf}$TI($Tt,"laya.d3.graphics.StaticBatch");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$TM._binarySearch=function($Tt){for(var $TM=0,$Tf=this._batchRenderElements.length-1,$Tc=0;$TM<=$Tf;)$Tc=Math.floor(($TM+$Tf)/2),this._compareBatchRenderElement(this._batchRenderElements[$Tc],$Tt)?$Tf=$Tc-1:$TM=$Tc+1;return $TM},$TM._compareBatchRenderElement=function($Tt,$TM){throw new Error("StaticBatch:must override this function.")},$TM._getVertexDecLightMap=function($Tt){return $Tt===$Tkt.vertexDeclaration?$THt.vertexDeclaration:$Tt===$Tvt.vertexDeclaration?$TSt.vertexDeclaration:$Tt===$TVt.vertexDeclaration?$TXt.vertexDeclaration:$Tt===$T$t.vertexDeclaration?null:$Tt===$Tlt.vertexDeclaration?$T_t.vertexDeclaration:$Tt===$Tjt.vertexDeclaration?$Trt.vertexDeclaration:$Tt===$TUt.vertexDeclaration?$TFt.vertexDeclaration:$Tt===$TKt.vertexDeclaration?$Tst.vertexDeclaration:$Tt===$Tvt.vertexDeclaration?$TSt.vertexDeclaration:$Tt===$Txt.vertexDeclaration?$Tyt.vertexDeclaration:$Tt===$T$t.vertexDeclaration?null:$Tt===$Tlt.vertexDeclaration?$T_t.vertexDeclaration:$Tt===$Tdt.vertexDeclaration?$Tut.vertexDeclaration:$Tt===$TUt.vertexDeclaration?$TFt.vertexDeclaration:$Tt},$TM._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$TM._addBatchRenderElement=function($Tt){this._batchRenderElements.splice(this._binarySearch($Tt),0,$Tt)},$TM._updateToRenderQueue=function($Tt,$TM){this._combineRenderElementPoolIndex=0,this._getRenderElement($Tt.getRenderQueue(this._material.renderQueue)._renderElements,$Tt,$TM)},$TM._getRenderElement=function($Tt,$TM,$Tf){throw new Error("StaticBatch:must override this function.")},$TM._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$TM._clearRenderElements=function(){this._batchRenderElements.length=0},$TM.dispose=function(){},$TM._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),null},$TM._getIndexBuffer=function(){return null},$TM._beforeRender=function($Tt){return!0},$TM._render=function($Tt){},$TM._getVertexBuffers=function(){return null},$Tq(0,$TM,"_vertexBufferCount",function(){return 1}),$Tq(0,$TM,"triangleCount",function(){return 0}),$Tt.combine=function($Tt){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$Tct.combine($Tt)},$Tt.maxBatchVertexCount=65535,$Tt}(),$Tot=function(){function $TJ($Tt,$TM){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$TJ._uniqueIDCounter,this._id>$TJ.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$TJ.maxVertexDeclaration);this._shaderValues=new $TbM,this._vertexElementsDic={},this._vertexStride=$Tt,this._vertexElements=$TM;for(var $Tf=0;$Tf<$TM.length;$Tf++){var $Tc=$TM[$Tf],$TD=$Tc.elementUsage;this._vertexElementsDic[$TD]=$Tc;var $To=[$TJ._getTypeSize($Tc.elementFormat)/4,5126,!1,this._vertexStride,$Tc.offset];switch(this._shaderValues.setValue($TD,$To),$TD){case 1:this._addShaderDefine($TiM.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($TiM.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($TiM.SHADERDEFINE_UV1)}}}$TI($TJ,"laya.d3.graphics.VertexDeclaration");var $Tt=$TJ.prototype;return $Tt._addShaderDefine=function($Tt){this._shaderDefineValue|=$Tt},$Tt._removeShaderDefine=function($Tt){this._shaderDefineValue&=~$Tt},$Tt.getVertexElements=function(){return this._vertexElements.slice()},$Tt.getVertexElementByUsage=function($Tt){return this._vertexElementsDic[$Tt]},$Tt.unBinding=function(){},$Tq(0,$Tt,"shaderDefineValue",function(){return this._shaderDefineValue}),$Tq(0,$Tt,"id",function(){return this._id}),$Tq(0,$Tt,"vertexStride",function(){return this._vertexStride}),$Tq(0,$Tt,"shaderValues",function(){return this._shaderValues}),$TJ._getTypeSize=function($Tt){switch($Tt){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$TJ.getVertexStride=function($Tt){for(var $TM=0,$Tf=0;$Tf<$Tt.Length;$Tf++){var $Tc=$Tt[$Tf],$TD=$Tc.offset+$TJ._getTypeSize($Tc.elementFormat);$TM<$TD&&($TM=$TD)}return $TM},$TJ._maxVertexDeclarationBit=1e3,$TJ._uniqueIDCounter=1,$TB($TJ,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$TJ}(),$TJt=function(){function $Tt($Tt,$TM,$Tf){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$Tt,this.elementFormat=$TM,this.elementUsage=$Tf}return $TI($Tt,"laya.d3.graphics.VertexElement"),$Tt}(),$TZt=(function(){function $Tt(){}$TI($Tt,"laya.d3.graphics.VertexElementFormat"),$Tt.Single="single",$Tt.Vector2="vector2",$Tt.Vector3="vector3",$Tt.Vector4="vector4",$Tt.Color="color",$Tt.Byte4="byte4",$Tt.Short2="short2",$Tt.Short4="short4",$Tt.NormalizedShort2="normalizedshort2",$Tt.NormalizedShort4="normalizedshort4",$Tt.HalfVector2="halfvector2",$Tt.HalfVector4="halfvector4"}(),function(){function $Tt(){}$TI($Tt,"laya.d3.graphics.VertexElementUsage"),$Tt.POSITION0=0,$Tt.COLOR0=1,$Tt.TEXTURECOORDINATE0=2,$Tt.NORMAL0=3,$Tt.BINORMAL0=4,$Tt.TANGENT0=5,$Tt.BLENDINDICES0=6,$Tt.BLENDWEIGHT0=7,$Tt.DEPTH0=8,$Tt.FOG0=9,$Tt.POINTSIZE0=10,$Tt.SAMPLE0=11,$Tt.TESSELLATEFACTOR0=12,$Tt.COLOR1=13,$Tt.NEXTTEXTURECOORDINATE0=14,$Tt.TEXTURECOORDINATE1=15,$Tt.NEXTTEXTURECOORDINATE1=16,$Tt.CORNERTEXTURECOORDINATE0=17,$Tt.VELOCITY0=18,$Tt.STARTCOLOR0=19,$Tt.STARTSIZE=20,$Tt.AGEADDSCALE0=21,$Tt.STARTROTATION=22,$Tt.ENDCOLOR0=23,$Tt.STARTLIFETIME=24,$Tt.TIME0=33,$Tt.SHAPEPOSITIONSTARTLIFETIME=30,$Tt.DIRECTIONTIME=32,$Tt.SIZEROTATION0=27,$Tt.RADIUS0=28,$Tt.RADIAN0=29,$Tt.STARTSPEED=31,$Tt.RANDOM0=34,$Tt.RANDOM1=35,$Tt.SIMULATIONWORLDPOSTION=36,$Tt.SIMULATIONWORLDROTATION=37,$Tt.TEXTURECOORDINATE0X=38,$Tt.TEXTURECOORDINATE0X1=39,$Tt.TEXTURECOORDINATE0Y=40,$Tt.OFFSETVECTOR=41}(),function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$Tt,this._textureCoordinate0=$TM,this._time=$Tf}$TI($Tt,"laya.d3.graphics.VertexGlitter");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate0}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"time",function(){return this._time}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(24,[new $TJt(0,"vector3",0),new $TJt(12,"vector2",2),new $TJt(20,"single",33)])}])}(),function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$Tt,this._position=$TM,this._velocity=$Tf,this._startColor=$Tc,this._endColor=$TD,this._sizeRotation=$To,this._radius=$TJ,this._radian=$TZ,this._ageAddScale=$TA,this._time=$TL}$TI($Tt,"laya.d3.graphics.VertexParticle");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"endColor",function(){return this._endColor}),$Tq(0,$TM,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Tq(0,$TM,"sizeRotation",function(){return this._sizeRotation}),$Tq(0,$TM,"velocity",function(){return this._velocity}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"startColor",function(){return this._startColor}),$Tq(0,$TM,"radius",function(){return this._radius}),$Tq(0,$TM,"radian",function(){return this._radian}),$Tq(0,$TM,"ageAddScale",function(){return this._ageAddScale}),$Tq(0,$TM,"time",function(){return this._time}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(116,[new $TJt(0,"vector4",17),new $TJt(16,"vector3",0),new $TJt(28,"vector3",18),new $TJt(40,"vector4",19),new $TJt(56,"vector4",23),new $TJt(72,"vector3",27),new $TJt(84,"vector2",28),new $TJt(92,"vector4",29),new $TJt(108,"single",24),new $TJt(112,"single",33)])}])}(),function(){function $Tt($Tt){this._position=null,this._position=$Tt}$TI($Tt,"laya.d3.graphics.VertexPosition");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(12,[new $TJt(0,"vector3",0)])}]),$Tt}()),$TAt=function(){function $Tt($Tt,$TM){this._position=null,this._normal=null,this._position=$Tt,this._normal=$TM}$TI($Tt,"laya.d3.graphics.VertexPositionNormal");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(24,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3)])}]),$Tt}(),$TLt=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._color=null,this._position=$Tt,this._normal=$TM,this._color=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColor");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(40,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1)])}]),$Tt}(),$Tpt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._blendIndex=$Tc,this._blendWeight=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorSkin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(72,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6)])}]),$Tt}(),$TBt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._tangent=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(88,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6),new $TJt(72,"vector4",5)])}]),$Tt}(),$Tbt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._tangent=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(84,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6),new $TJt(72,"vector3",5)])}]),$Tt}(),$TIt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._tangent=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(56,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector4",5)])}]),$Tt}(),$Tqt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._tangent=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(52,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector3",5)])}]),$Tt}(),$Tlt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(48,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2)])}]),$Tt}(),$T_t=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(56,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15)])}]),$Tt}(),$TEt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._blendIndex=$To,this._blendWeight=$TJ}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(88,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15),new $TJt(56,"vector4",7),new $TJt(72,"vector4",6)])}]),$Tt}(),$Tet=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._tangent=$To,this._blendIndex=$TJ,this._blendWeight=$TZ}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(104,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15),new $TJt(56,"vector4",7),new $TJt(72,"vector4",6),new $TJt(88,"vector4",5)])}]),$Tt}(),$TNt=function(){function $Tt(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$TM.VertexPositionNormalColorTexture0SkinTangent=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._tangent=$To,this._blendIndex=$TJ,this._blendWeight=$TZ},$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(100,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15),new $TJt(56,"vector4",7),new $TJt(72,"vector4",6),new $TJt(88,"vector3",5)])}]),$Tt}(),$TXt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._tangent=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(72,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15),new $TJt(56,"vector4",5)])}]),$Tt}(),$Tyt=function(){function $Tt(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$TM.VertexPositionNormalColorTexture0Tangent=function($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._tangent=$To},$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(68,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector2",15),new $TJt(56,"vector3",5)])}]),$Tt}(),$Tht=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(80,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector4",7),new $TJt(64,"vector4",6)])}]),$Tt}(),$TTt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc,this._tangent=$TD,this._blendIndex=$To,this._blendWeight=$TJ}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(96,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector4",7),new $TJt(64,"vector4",6),new $TJt(80,"vector4",5)])}]),$Tt}(),$Tit=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc,this._tangent=$TD,this._blendIndex=$To,this._blendWeight=$TJ}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(92,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector4",7),new $TJt(64,"vector4",6),new $TJt(80,"vector3",5)])}]),$Tt}(),$TVt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc,this._tangent=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(64,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector4",5)])}]),$Tt}(),$Txt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._color=$Tf,this._textureCoordinate=$Tc,this._tangent=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"color",function(){return this._color}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(60,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",1),new $TJt(40,"vector2",2),new $TJt(48,"vector3",5)])}]),$Tt}(),$TOt=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._tangent=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNormalSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(40,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector4",5)])}]),$Tt}(),$TCt=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._tangent=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(36,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector3",5)])}]),$Tt}(),$TUt=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(32,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2)])}]),$Tt}(),$TFt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(40,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15)])}]),$Tt}(),$TSt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(72,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6)])}]),$Tt}(),$THt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc,this._tangent=$TD,this._blendIndex=$To,this._blendWeight=$TJ}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(88,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6),new $TJt(72,"vector4",5)])}]),$Tt}(),$Tst=function(){function $Tt(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$TM.VertexPositionNormalTexture0SkinTangent=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc,this._tangent=$TD,this._blendIndex=$To,this._blendWeight=$TJ},$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(84,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15),new $TJt(40,"vector4",7),new $TJt(56,"vector4",6),new $TJt(72,"vector3",5)])}]),$Tt}(),$Trt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc,this._tangent=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(56,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15),new $TJt(40,"vector4",5)])}]),$Tt}(),$Tut=function(){function $Tt(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$TM.VertexPositionNormalTexture0Tangent=function($Tt,$TM,$Tf,$Tc,$TD){this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tf,this._textureCoordinate1=$Tc,this._tangent=$TD},$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(52,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15),new $TJt(40,"vector3",5)])}]),$Tt}(),$Tvt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf,this._blendIndex=$Tc,this._blendWeight=$TD}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(64,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector4",7),new $TJt(48,"vector4",6)])}]),$Tt}(),$Tkt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf,this._tangent=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(80,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector4",7),new $TJt(48,"vector4",6),new $TJt(64,"vector4",5)])}]),$Tt}(),$TKt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf,this._tangent=$Tc,this._blendIndex=$TD,this._blendWeight=$To}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(76,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector4",7),new $TJt(48,"vector4",6),new $TJt(64,"vector3",5)])}]),$Tt}(),$Tjt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf,this._tangent=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(48,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector4",5)])}]),$Tt}(),$Tdt=function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf,this._tangent=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(44,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector3",5)])}]),$Tt}(),$T$t=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNTBTexture");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(56,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector3",5),new $TJt(36,"vector3",4),new $TJt(48,"vector2",2)])}]),$Tt}(),$TPt=function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate0=$Tc,this._textureCoordinate1=$TD,this._tangent=$To,$Tf=$Tf,this._blendIndex=$TJ,this._blendWeight=$TZ}$TI($Tt,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"tangent",function(){return this._tangent}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(0,$TM,"textureCoordinate1",function(){return this._textureCoordinate1}),$Tq(0,$TM,"blendIndex",function(){return this._blendIndex}),$Tq(0,$TM,"blendWeight",function(){return this._blendWeight}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(96,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector3",5),new $TJt(36,"vector3",4),new $TJt(48,"vector2",2),new $TJt(56,"vector2",15),new $TJt(64,"vector4",7),new $TJt(80,"vector4",6)])}]),$Tt}(),$TYt=function(){function $Tt($Tt,$TM,$Tf){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Tt,this._normal=$TM,this._textureCoordinate=$Tf}$TI($Tt,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"textureCoordinate",function(){return this._textureCoordinate}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(88,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector3",5),new $TJt(36,"vector3",4),new $TJt(48,"vector2",2),new $TJt(56,"vector4",7),new $TJt(72,"vector4",6)])}]),$Tt}(),$Tnt=(function(){function $Tt($Tt,$TM,$Tf,$Tc){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$Tt,this._normal=$TM,this._textureCoord0=$Tf,this._textureCoord1=$Tc}$TI($Tt,"laya.d3.graphics.VertexPositionTerrain");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"normal",function(){return this._normal}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoord0",function(){return this._textureCoord0}),$Tq(0,$TM,"textureCoord1",function(){return this._textureCoord1}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(40,[new $TJt(0,"vector3",0),new $TJt(12,"vector3",3),new $TJt(24,"vector2",2),new $TJt(32,"vector2",15)])}])}(),function(){function $Tt($Tt,$TM){this._position=null,this._textureCoordinate0=null,this._position=$Tt,this._textureCoordinate0=$TM}$TI($Tt,"laya.d3.graphics.VertexPositionTexture0");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"position",function(){return this._position}),$Tq(0,$TM,"textureCoordinate0",function(){return this._textureCoordinate0}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(20,[new $TJt(0,"vector3",0),new $TJt(12,"vector2",2)])}]),$Tt}()),$TRt=(function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb,$TI){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$Tt,this._positionStartLifeTime=$TM,this._velocity=$Tf,this._startColor=$Tc,this._startSize=$TD,this._startRotation0=$To,this._startRotation1=$TJ,this._startRotation2=$TZ,this._startLifeTime=$TA,this._time=$TL,this._startSpeed=$Tp,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$TI}$TI($Tt,"laya.d3.graphics.VertexShurikenParticleBillboard");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Tq(0,$TM,"random1",function(){return this._randoms1}),$Tq(0,$TM,"startRotation2",function(){return this._startRotation2}),$Tq(0,$TM,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$Tq(0,$TM,"velocity",function(){return this._velocity}),$Tq(0,$TM,"random0",function(){return this._randoms0}),$Tq(0,$TM,"startSize",function(){return this._startSize}),$Tq(0,$TM,"startColor",function(){return this._startColor}),$Tq(0,$TM,"startRotation0",function(){return this._startRotation0}),$Tq(0,$TM,"startRotation1",function(){return this._startRotation1}),$Tq(0,$TM,"startLifeTime",function(){return this._startLifeTime}),$Tq(0,$TM,"time",function(){return this._time}),$Tq(0,$TM,"startSpeed",function(){return this._startSpeed}),$Tq(0,$TM,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(152,[new $TJt(0,"vector4",17),new $TJt(16,"vector4",30),new $TJt(32,"vector4",32),new $TJt(48,"vector4",19),new $TJt(64,"vector3",20),new $TJt(76,"vector3",22),new $TJt(88,"single",31),new $TJt(92,"vector4",34),new $TJt(108,"vector4",35),new $TJt(124,"vector3",36),new $TJt(136,"vector4",37)])}])}(),function(){function $Tt($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb,$TI){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$Tt,this._positionStartLifeTime=$TM,this._velocity=$Tf,this._startColor=$Tc,this._startSize=$TD,this._startRotation0=$To,this._startRotation1=$TJ,this._startRotation2=$TZ,this._startLifeTime=$TA,this._time=$TL,this._startSpeed=$Tp,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$TI}$TI($Tt,"laya.d3.graphics.VertexShurikenParticleMesh");var $TM=$Tt.prototype;$Ty.imps($TM,{"laya.d3.graphics.IVertex":!0}),$Tq(0,$TM,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$Tq(0,$TM,"velocity",function(){return this._velocity}),$Tq(0,$TM,"position",function(){return this._positionStartLifeTime}),$Tq(0,$TM,"random0",function(){return this._randoms0}),$Tq(0,$TM,"startSize",function(){return this._startSize}),$Tq(0,$TM,"startColor",function(){return this._startColor}),$Tq(0,$TM,"startRotation0",function(){return this._startRotation0}),$Tq(0,$TM,"startRotation1",function(){return this._startRotation1}),$Tq(0,$TM,"random1",function(){return this._randoms1}),$Tq(0,$TM,"startRotation2",function(){return this._startRotation2}),$Tq(0,$TM,"startLifeTime",function(){return this._startLifeTime}),$Tq(0,$TM,"time",function(){return this._time}),$Tq(0,$TM,"startSpeed",function(){return this._startSpeed}),$Tq(0,$TM,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$Tq(0,$TM,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$Tq(1,$Tt,"vertexDeclaration",function(){return $Tt._vertexDeclaration}),$TB($Tt,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Tot(172,[new $TJt(0,"vector3",0),new $TJt(12,"vector4",1),new $TJt(28,"vector2",2),new $TJt(36,"vector4",30),new $TJt(52,"vector4",32),new $TJt(68,"vector4",19),new $TJt(84,"vector3",20),new $TJt(96,"vector3",22),new $TJt(108,"single",31),new $TJt(112,"vector4",34),new $TJt(128,"vector4",35),new $TJt(144,"vector3",36),new $TJt(156,"vector4",37)])}])}(),function(){function $TN($Tt,$TM,$Tf,$Tc,$TD,$To){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$Tf,this._materials=$Tc,this._subMeshes=$TD,this._materialMap=$To,this._version=$TM,this._onLoaded($Tt)}$TI($TN,"laya.d3.loaders.LoadModelV01");var $Tt=$TN.prototype;return $Tt._onLoaded=function($Tt){this._readData=$Tt,this.READ_BLOCK();for(var $TM=0;$TM<this._BLOCK.count;$TM++){var $Tf=this._readData.getUint16(),$Tc=this._strings[$Tf],$TD=this["READ_"+$Tc];if(null==$TD)throw new Error("model file err,no this function:"+$Tf+" "+$Tc);if(!$TD.call(this))break}return this._mesh},$Tt.onError=function(){},$Tt._readString=function(){return this._strings[this._readData.getUint16()]},$Tt.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$Tt.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$Tt.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $Tt=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $TM=0;$TM<this._STRINGS.size;$TM++)this._strings[$TM]=this._readData.readUTFString();return this._readData.pos=$Tt,!0},$Tt.READ_MATERIAL=function(){var $Tt=this._readData.getUint16(),$TM=(this._readString(),this._readString());return this._materials[$Tt]="null"!==$TM?$TE.getRes(this._materialMap[$TM]):new $TCM,!0},$Tt.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $Tt,$TM=this._readData.__getBuffer(),$Tf=0,$Tc=this._readData.getUint32(),$TD=this._readData.getUint32(),$To=(new Float32Array($TM.slice($Tc+this._DATA.offset,$Tc+this._DATA.offset+$TD)),this._readData.getUint32()),$TJ=this._readData.getUint32(),$TZ=new Float32Array($TM.slice($To+this._DATA.offset,$To+this._DATA.offset+$TJ));for(this.mesh._inverseBindPoses=[],$Tf=0,$Tt=$TZ.length;$Tf<$Tt;$Tf+=16){var $TA=new $TtM($TZ[$Tf+0],$TZ[$Tf+1],$TZ[$Tf+2],$TZ[$Tf+3],$TZ[$Tf+4],$TZ[$Tf+5],$TZ[$Tf+6],$TZ[$Tf+7],$TZ[$Tf+8],$TZ[$Tf+9],$TZ[$Tf+10],$TZ[$Tf+11],$TZ[$Tf+12],$TZ[$Tf+13],$TZ[$Tf+14],$TZ[$Tf+15]);this.mesh._inverseBindPoses.push($TA)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$Tt.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $Tt=this._readString();this._shaderAttributes=$Tt.match($TN._attrReg);var $TM=this._readData.getUint32(),$Tf=this._readData.getUint32(),$Tc=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$TD=this._readData.getUint32(),$To=this._readData.getUint32(),$TJ=this._readData.getUint32(),$TZ=this._readData.__getBuffer(),$TA=new $TLM(this._mesh),$TL=this._getVertexDeclaration(),$Tp=$TKM.create($TL,$TD/$TL.vertexStride,35044,!0),$TB=$Tc+this._DATA.offset,$Tb=$TZ.slice($TB,$TB+$TD);$Tp.setData(new Float32Array($Tb));for(var $TI=($TA._vertexBuffer=$Tp).vertexDeclaration.getVertexElements(),$Tq=0;$Tq<$TI.length;$Tq++)$TA._bufferUsage[$TI[$Tq].elementUsage]=$Tp;var $Tl=$TkM.create("ushort",$Tf/2,35044,!0),$T_=$TM+this._DATA.offset,$TE=$TZ.slice($T_,$T_+$Tf);$Tl.setData(new Uint16Array($TE)),$TA._indexBuffer=$Tl;var $Te=$TZ.slice($To+this._DATA.offset,$To+this._DATA.offset+$TJ);return $TA._boneIndicesList[0]=new Uint8Array($Te),this._subMeshes.push($TA),!0},$Tt.READ_DATAAREA=function(){return!1},$Tt._getVertexDeclaration=function(){for(var $Tt,$TM=!1,$Tf=!1,$Tc=!1,$TD=!1,$To=!1,$TJ=!1,$TZ=!1,$TA=!1,$TL=!1,$Tp=0;$Tp<this._shaderAttributes.length;$Tp+=8)switch(this._shaderAttributes[$Tp]){case"POSITION":$TM=!0;break;case"NORMAL":$Tf=!0;break;case"COLOR":$Tc=!0;break;case"UV":$TD=!0;break;case"UV1":$To=!0;break;case"BLENDWEIGHT":$TZ=!0;break;case"BLENDINDICES":$TA=!0;break;case"TANGENT":$TJ=!0;break;case"BINORMAL":$TL=!0}return $TM&&$Tf&&$Tc&&$TD&&$To&&$TZ&&$TA&&$TJ?$Tt=$TNt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$To&&$TZ&&$TA?$Tt=$TEt.vertexDeclaration:$TM&&$Tf&&$TD&&$To&&$TZ&&$TA&&$TJ?$Tt=$Tst.vertexDeclaration:$TM&&$Tf&&$TD&&$To&&$TZ&&$TA?$Tt=$TSt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$TZ&&$TA&&$TJ?$Tt=$Tit.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$TZ&&$TA?$Tt=$Tht.vertexDeclaration:$TM&&$Tf&&$TJ&&$TL&&$TD&&$TZ&&$TA?$Tt=$TYt.vertexDeclaration:$TM&&$Tf&&$TD&&$TZ&&$TA&&$TJ?$Tt=$TKt.vertexDeclaration:$TM&&$Tf&&$TD&&$TZ&&$TA?$Tt=$Tvt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TZ&&$TA&&$TJ?$Tt=$Tbt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TZ&&$TA?$Tt=$Tpt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$To&&$TJ?$Tt=$Tyt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$To?$Tt=$T_t.vertexDeclaration:$TM&&$Tf&&$TD&&$To&&$TJ?$Tt=$Tut.vertexDeclaration:$TM&&$Tf&&$TD&&$To?$Tt=$TFt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD&&$TJ?$Tt=$Txt.vertexDeclaration:$TM&&$Tf&&$TD&&$TJ&&$TL?$Tt=$T$t.vertexDeclaration:$TM&&$Tf&&$Tc&&$TD?$Tt=$Tlt.vertexDeclaration:$TM&&$Tf&&$TD&&$TJ?$Tt=$Tdt.vertexDeclaration:$TM&&$Tf&&$TD?$Tt=$TUt.vertexDeclaration:$TM&&$Tf&&$Tc&&$TJ?$Tt=$Tqt.vertexDeclaration:$TM&&$Tf&&$Tc&&($Tt=$TLt.vertexDeclaration),$Tt},$Tq(0,$Tt,"mesh",function(){return this._mesh}),$TN._attrReg=new RegExp("(\\w+)|([:,;])","g"),$TN}()),$Tgt=function(){function $TT(){}return $TI($TT,"laya.d3.loaders.LoadModelV02"),$TT.parse=function($Tt,$TM,$Tf,$Tc,$TD,$To){$TT._mesh=$Tf,$TT._materials=$Tc,$TT._subMeshes=$TD,$TT._materialMap=$To,$TT._version=$TM,$TT._readData=$Tt,$TT.READ_DATA(),$TT.READ_BLOCK(),$TT.READ_STRINGS();for(var $TJ=0,$TZ=$TT._BLOCK.count;$TJ<$TZ;$TJ++){$TT._readData.pos=$TT._BLOCK.blockStarts[$TJ];var $TA=$TT._readData.getUint16(),$TL=$TT._strings[$TA],$Tp=$TT["READ_"+$TL];if(null==$Tp)throw new Error("model file err,no this function:"+$TA+" "+$TL);$Tp.call()}$TT._strings.length=0,$TT._readData=null,$TT._version=null,$TT._mesh=null,$TT._materials=null,$TT._subMeshes=null,$TT._materialMap=null},$TT._readString=function(){return $TT._strings[$TT._readData.getUint16()]},$TT.READ_DATA=function(){$TT._DATA.offset=$TT._readData.getUint32(),$TT._DATA.size=$TT._readData.getUint32()},$TT.READ_BLOCK=function(){for(var $Tt=$TT._BLOCK.count=$TT._readData.getUint16(),$TM=$TT._BLOCK.blockStarts=[],$Tf=$TT._BLOCK.blockLengths=[],$Tc=0;$Tc<$Tt;$Tc++)$TM.push($TT._readData.getUint32()),$Tf.push($TT._readData.getUint32())},$TT.READ_STRINGS=function(){var $Tt=$TT._readData.getUint32(),$TM=$TT._readData.getUint16(),$Tf=$TT._readData.pos;$TT._readData.pos=$Tt+$TT._DATA.offset;for(var $Tc=0;$Tc<$TM;$Tc++)$TT._strings[$Tc]=$TT._readData.readUTFString();$TT._readData.pos=$Tf},$TT.READ_MATERIAL=function(){$TT._readString(),$TT._readString();var $Tt=$TT._readString();return""!==$Tt&&$TT._materials.push($TE.getRes($TT._materialMap[$Tt])),!0},$TT.READ_MESH=function(){$TT._readString();var $Tt,$TM=$TT._readData.__getBuffer(),$Tf=0,$Tc=$TT._readData.getInt16(),$TD=$TT._DATA.offset;for($Tf=0;$Tf<$Tc;$Tf++){var $To=$TD+$TT._readData.getUint32(),$TJ=$TT._readData.getUint32(),$TZ=new Float32Array($TM.slice($To,$To+$TJ)),$TA=$TT._readString().match($TT._attrReg),$TL=$TT._getVertexDeclaration($TA),$Tp=$TKM.create($TL,4*$TZ.length/$TL.vertexStride,35044,!0);$Tp.setData($TZ),$TT._mesh._vertexBuffers.push($Tp)}var $TB=$TD+$TT._readData.getUint32(),$Tb=$TT._readData.getUint32(),$TI=new Uint16Array($TM.slice($TB,$TB+$Tb)),$Tq=$TkM.create("ushort",$Tb/2,35044,!0);$Tq.setData($TI),$TT._mesh._indexBuffer=$Tq;var $Tl=$TT._mesh._boneNames=[],$T_=$TT._readData.getUint16();for($Tl.length=$T_,$Tf=0;$Tf<$T_;$Tf++)$Tl[$Tf]=$TT._strings[$TT._readData.getUint16()];var $TE=$TT._readData.getUint32(),$Te=$TT._readData.getUint32(),$TN=(new Float32Array($TM.slice($TD+$TE,$TD+$TE+$Te)),$TT._readData.getUint32()),$TX=$TT._readData.getUint32(),$Ty=new Float32Array($TM.slice($TD+$TN,$TD+$TN+$TX));for($TT._mesh._inverseBindPoses=[],$Tf=0,$Tt=$Ty.length;$Tf<$Tt;$Tf+=16){var $Th=new $TtM($Ty[$Tf+0],$Ty[$Tf+1],$Ty[$Tf+2],$Ty[$Tf+3],$Ty[$Tf+4],$Ty[$Tf+5],$Ty[$Tf+6],$Ty[$Tf+7],$Ty[$Tf+8],$Ty[$Tf+9],$Ty[$Tf+10],$Ty[$Tf+11],$Ty[$Tf+12],$Ty[$Tf+13],$Ty[$Tf+14],$Ty[$Tf+15]);$TT._mesh._inverseBindPoses.push($Th)}return $TT._mesh._skinnedDatas=new Float32Array(16*$Ty.length),!0},$TT.READ_SUBMESH=function(){var $Tt=$TT._readData.__getBuffer(),$TM=new $TLM($TT._mesh),$Tf=$TT._readData.getInt16(),$Tc=$TT._readData.getUint32(),$TD=$TT._readData.getUint32();$TM._vertexBuffer=$TT._mesh._vertexBuffers[$Tf],$TM._vertexStart=$Tc,$TM._vertexCount=$TD;var $To=$TT._readData.getUint32(),$TJ=$TT._readData.getUint32(),$TZ=$TT._mesh._indexBuffer;$TM._indexBuffer=$TZ,$TM._indexStart=$To,$TM._indexCount=$TJ,$TM._indices=new Uint16Array($TZ.getData().buffer,2*$To,$TJ);var $TA=$TT._DATA.offset,$TL=$TM._subIndexBufferStart,$Tp=$TM._subIndexBufferCount,$TB=$TM._boneIndicesList,$Tb=$TT._readData.getUint16();$TL.length=$Tb,$Tp.length=$Tb,$TB.length=$Tb;for(var $TI=0;$TI<$Tb;$TI++){$TL[$TI]=$TT._readData.getUint32(),$Tp[$TI]=$TT._readData.getUint32();var $Tq=$TT._readData.getUint32(),$Tl=$TT._readData.getUint32();$TM._boneIndicesList[$TI]=new Uint8Array($Tt.slice($TA+$Tq,$TA+$Tq+$Tl))}return $TT._subMeshes.push($TM),!0},$TT._getVertexDeclaration=function($Tt){for(var $TM,$Tf=!1,$Tc=!1,$TD=!1,$To=!1,$TJ=!1,$TZ=!1,$TA=!1,$TL=!1,$Tp=!1,$TB=0;$TB<$Tt.length;$TB++)switch($Tt[$TB]){case"POSITION":$Tf=!0;break;case"NORMAL":$Tc=!0;break;case"COLOR":$TD=!0;break;case"UV":$To=!0;break;case"UV1":$TJ=!0;break;case"BLENDWEIGHT":$TA=!0;break;case"BLENDINDICES":$TL=!0;break;case"TANGENT":$TZ=!0;break;case"BINORMAL":$Tp=!0}return $Tf&&$Tc&&$TD&&$To&&$TJ&&$TA&&$TL&&$TZ?$TM=$TNt.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TJ&&$TA&&$TL?$TM=$TEt.vertexDeclaration:$Tf&&$Tc&&$To&&$TJ&&$TA&&$TL&&$TZ?$TM=$Tst.vertexDeclaration:$Tf&&$Tc&&$To&&$TJ&&$TA&&$TL?$TM=$TSt.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TA&&$TL&&$TZ?$TM=$Tit.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TA&&$TL?$TM=$Tht.vertexDeclaration:$Tf&&$Tc&&$To&&$TA&&$TL&&$TZ?$TM=$TKt.vertexDeclaration:$Tf&&$Tc&&$To&&$TA&&$TL?$TM=$Tvt.vertexDeclaration:$Tf&&$Tc&&$TD&&$TA&&$TL&&$TZ?$TM=$Tbt.vertexDeclaration:$Tf&&$Tc&&$TD&&$TA&&$TL?$TM=$Tpt.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TJ&&$TZ?$TM=$Tyt.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TJ?$TM=$T_t.vertexDeclaration:$Tf&&$Tc&&$To&&$TJ&&$TZ?$TM=$Tut.vertexDeclaration:$Tf&&$Tc&&$To&&$TJ?$TM=$TFt.vertexDeclaration:$Tf&&$Tc&&$TD&&$To&&$TZ?$TM=$Txt.vertexDeclaration:$Tf&&$Tc&&$To&&$TZ&&$Tp?$TM=$T$t.vertexDeclaration:$Tf&&$Tc&&$TD&&$To?$TM=$Tlt.vertexDeclaration:$Tf&&$Tc&&$To&&$TZ?$TM=$Tdt.vertexDeclaration:$Tf&&$Tc&&$To?$TM=$TUt.vertexDeclaration:$Tf&&$Tc&&$TD&&$TZ?$TM=$Tqt.vertexDeclaration:$Tf&&$Tc&&$TD&&($TM=$TLt.vertexDeclaration),$TM},$TT._attrReg=new RegExp("(\\w+)|([:,;])","g"),$TT._strings=[],$TT._readData=null,$TT._version=null,$TT._mesh=null,$TT._materials=null,$TT._subMeshes=null,$TT._materialMap=null,$TB($TT,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$TT}(),$Tzt=function(){function $Th(){}return $TI($Th,"laya.d3.loaders.LoadModelV03"),$Th.parse=function($Tt,$TM,$Tf,$Tc,$TD){$Th._mesh=$Tf,$Th._subMeshes=$Tc,$Th._materialMap=$TD,$Th._version=$TM,$Th._readData=$Tt,$Th.READ_DATA(),$Th.READ_BLOCK(),$Th.READ_STRINGS();for(var $To=0,$TJ=$Th._BLOCK.count;$To<$TJ;$To++){$Th._readData.pos=$Th._BLOCK.blockStarts[$To];var $TZ=$Th._readData.getUint16(),$TA=$Th._strings[$TZ],$TL=$Th["READ_"+$TA];if(null==$TL)throw new Error("model file err,no this function:"+$TZ+" "+$TA);$TL.call()}$Th._strings.length=0,$Th._readData=null,$Th._version=null,$Th._mesh=null,$Th._subMeshes=null,$Th._materialMap=null},$Th._readString=function(){return $Th._strings[$Th._readData.getUint16()]},$Th.READ_DATA=function(){$Th._DATA.offset=$Th._readData.getUint32(),$Th._DATA.size=$Th._readData.getUint32()},$Th.READ_BLOCK=function(){for(var $Tt=$Th._BLOCK.count=$Th._readData.getUint16(),$TM=$Th._BLOCK.blockStarts=[],$Tf=$Th._BLOCK.blockLengths=[],$Tc=0;$Tc<$Tt;$Tc++)$TM.push($Th._readData.getUint32()),$Tf.push($Th._readData.getUint32())},$Th.READ_STRINGS=function(){var $Tt=$Th._readData.getUint32(),$TM=$Th._readData.getUint16(),$Tf=$Th._readData.pos;$Th._readData.pos=$Tt+$Th._DATA.offset;for(var $Tc=0;$Tc<$TM;$Tc++)$Th._strings[$Tc]=$Th._readData.readUTFString();$Th._readData.pos=$Tf},$Th.READ_MESH=function(){var $Tt,$TM=$Th._readString(),$Tf=$Th._readData.__getBuffer(),$Tc=0,$TD=$Th._readData.getInt16(),$To=$Th._DATA.offset;for($Tc=0;$Tc<$TD;$Tc++){var $TJ,$TZ=$To+$Th._readData.getUint32(),$TA=$Th._readData.getUint32(),$TL=new Float32Array($Tf.slice($TZ,$TZ+$TA)),$Tp=$Th._readString();switch($Th._version){case"LAYAMODEL:03":$TJ=$Th._vertexDeclarationMap_Discard[$Tp];break;case"LAYAMODEL:0301":$TJ=$Th._vertexDeclarationMap[$Tp];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$TJ)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$Th._version+"  bufferAttribute="+$Tp+"  name="+$TM+"  url="+($Th._mesh?$Th._mesh.url:"null"));var $TB=$TKM.create($TJ,4*$TL.length/$TJ.vertexStride,35044,!0,$Th._mesh._url+"_"+$Tc);$TB.setData($TL),$Th._mesh._vertexBuffers.push($TB)}var $Tb=$To+$Th._readData.getUint32(),$TI=$Th._readData.getUint32(),$Tq=new Uint16Array($Tf.slice($Tb,$Tb+$TI)),$Tl=$TkM.create("ushort",$TI/2,35044,!0,$Th._mesh._url);$Tl.setData($Tq),$Th._mesh._indexBuffer=$Tl;var $T_=$Th._mesh._boneNames=[],$TE=$Th._readData.getUint16();for($T_.length=$TE,$Tc=0;$Tc<$TE;$Tc++)$T_[$Tc]=$Th._strings[$Th._readData.getUint16()];$Th._readData.pos+=8;var $Te=$Th._readData.getUint32(),$TN=$Th._readData.getUint32(),$TX=new Float32Array($Tf.slice($To+$Te,$To+$Te+$TN));for($Th._mesh._inverseBindPoses=[],$Tc=0,$Tt=$TX.length;$Tc<$Tt;$Tc+=16){var $Ty=new $TtM($TX[$Tc+0],$TX[$Tc+1],$TX[$Tc+2],$TX[$Tc+3],$TX[$Tc+4],$TX[$Tc+5],$TX[$Tc+6],$TX[$Tc+7],$TX[$Tc+8],$TX[$Tc+9],$TX[$Tc+10],$TX[$Tc+11],$TX[$Tc+12],$TX[$Tc+13],$TX[$Tc+14],$TX[$Tc+15]);$Th._mesh._inverseBindPoses.push($Ty)}return $Th._mesh._skinnedDatas=new Float32Array(16*$TX.length),!0},$Th.READ_SUBMESH=function(){var $Tt=$Th._readData.__getBuffer(),$TM=new $TLM($Th._mesh),$Tf=$Th._readData.getInt16(),$Tc=$Th._readData.getUint32(),$TD=$Th._readData.getUint32();$TM._vertexBuffer=$Th._mesh._vertexBuffers[$Tf],$TM._vertexStart=$Tc,$TM._vertexCount=$TD;var $To=$Th._readData.getUint32(),$TJ=$Th._readData.getUint32(),$TZ=$Th._mesh._indexBuffer;$TM._indexBuffer=$TZ,$TM._indexStart=$To,$TM._indexCount=$TJ,$TM._indices=new Uint16Array($TZ.getData().buffer,2*$To,$TJ);var $TA=$Th._DATA.offset,$TL=$TM._subIndexBufferStart,$Tp=$TM._subIndexBufferCount,$TB=$TM._boneIndicesList,$Tb=$Th._readData.getUint16();$TL.length=$Tb,$Tp.length=$Tb,$TB.length=$Tb;for(var $TI=0;$TI<$Tb;$TI++){$TL[$TI]=$Th._readData.getUint32(),$Tp[$TI]=$Th._readData.getUint32();var $Tq=$Th._readData.getUint32(),$Tl=$Th._readData.getUint32();$TB[$TI]=new Uint8Array($Tt.slice($TA+$Tq,$TA+$Tq+$Tl))}return $Th._subMeshes.push($TM),!0},$Th._strings=[],$Th._readData=null,$Th._version=null,$Th._mesh=null,$Th._subMeshes=null,$Th._materialMap=null,$TB($Th,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$TNt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$TEt.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$TPt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tst.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$TSt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tit.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Tht.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$TKt.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Tvt.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tbt.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Tpt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$Tyt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$T_t.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Tut.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$TFt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Txt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$T$t.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$Tlt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Tdt.vertexDeclaration,"POSITION,NORMAL,UV":$TUt.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$Tqt.vertexDeclaration,"POSITION,NORMAL,COLOR":$TLt.vertexDeclaration,"POSITION,NORMAL,TANGENT":$TCt.vertexDeclaration,"POSITION,NORMAL":$TAt.vertexDeclaration,"POSITION,UV":$Tnt.vertexDeclaration,POSITION:$TZt.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tet.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$TEt.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$TPt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$THt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$TSt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$TTt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Tht.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Tkt.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Tvt.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$TBt.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Tpt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$TXt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$T_t.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Trt.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$TFt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$TVt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$T$t.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$Tlt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Tjt.vertexDeclaration,"POSITION,NORMAL,UV":$TUt.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$TIt.vertexDeclaration,"POSITION,NORMAL,COLOR":$TLt.vertexDeclaration,"POSITION,NORMAL,TANGENT":$TOt.vertexDeclaration,"POSITION,NORMAL":$TAt.vertexDeclaration,"POSITION,UV":$Tnt.vertexDeclaration,POSITION:$TZt.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Th}(),$Tmt=function(){function $TZ(){}return $TI($TZ,"laya.d3.loaders.MeshReader"),$TZ.read=function($Tt,$TM,$Tf,$Tc,$TD){var $To=new $Th($Tt);$To.pos=0;var $TJ=$To.readUTFString();switch($TJ){case"LAYAMODEL:01":case"LAYASKINANI:01":$TZ._readVersion01($To,$TJ,$TM,$Tf,$Tc,$TD);break;case"LAYAMODEL:02":$Tgt.parse($To,$TJ,$TM,$Tf,$Tc,$TD);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$Tzt.parse($To,$TJ,$TM,$Tc,$TD);break;default:throw new Error("MeshReader: unknown mesh version.")}$TM._setSubMeshes($Tc)},$TZ._readVersion01=function($Tt,$TM,$Tf,$Tc,$TD,$To){new $TRt($Tt,$TM,$Tf,$Tc,$TD,$To)},$TZ}(),$TGt=function(){function $Tt($Tt,$TM){this.min=null,this.max=null,this.min=$Tt,this.max=$TM}$TI($Tt,"laya.d3.math.BoundBox");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.getCorners=function($Tt){$Tt.length=8;var $TM=this.min.elements,$Tf=this.max.elements,$Tc=$TM[0],$TD=$TM[1],$To=$TM[2],$TJ=$Tf[0],$TZ=$Tf[1],$TA=$Tf[2];$Tt[0]=new $TJM($Tc,$TZ,$TA),$Tt[1]=new $TJM($TJ,$TZ,$TA),$Tt[2]=new $TJM($TJ,$TD,$TA),$Tt[3]=new $TJM($Tc,$TD,$TA),$Tt[4]=new $TJM($Tc,$TZ,$To),$Tt[5]=new $TJM($TJ,$TZ,$To),$Tt[6]=new $TJM($TJ,$TD,$To),$Tt[7]=new $TJM($Tc,$TD,$To)},$TM.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$TM.cloneTo=function($Tt){var $TM=$Tt;this.min.cloneTo($TM.min),this.max.cloneTo($TM.max)},$TM.clone=function(){var $Tt=new this.constructor(new $TJM,new $TJM);return this.cloneTo($Tt),$Tt},$Tt.createfromPoints=function($Tt,$TM){if(null==$Tt)throw new Error("points");var $Tf=$TM.min,$Tc=$TM.max,$TD=$Tf.elements;$TD[0]=Number.MAX_VALUE,$TD[1]=Number.MAX_VALUE,$TD[2]=Number.MAX_VALUE;var $To=$Tc.elements;$To[0]=-Number.MAX_VALUE,$To[1]=-Number.MAX_VALUE,$To[2]=-Number.MAX_VALUE;for(var $TJ=0,$TZ=$Tt.length;$TJ<$TZ;++$TJ)$TJM.min($Tf,$Tt[$TJ],$Tf),$TJM.max($Tc,$Tt[$TJ],$Tc)},$Tt.merge=function($Tt,$TM,$Tf){$TJM.min($Tt.min,$TM.min,$Tf.min),$TJM.max($Tt.max,$TM.max,$Tf.max)},$Tt}(),$Tat=function(){function $TL($Tt){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$Tt,this._near=new $TMM(new $TJM),this._far=new $TMM(new $TJM),this._left=new $TMM(new $TJM),this._right=new $TMM(new $TJM),this._top=new $TMM(new $TJM),this._bottom=new $TMM(new $TJM),$TL._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$TI($TL,"laya.d3.math.BoundFrustum");var $Tt=$TL.prototype;return $Tt.equalsBoundFrustum=function($Tt){return this._matrix.equalsOtherMatrix($Tt.matrix)},$Tt.equalsObj=function($Tt){if($Tt instanceof laya.d3.math.BoundFrustum){var $TM=$Tt;return this.equalsBoundFrustum($TM)}return!1},$Tt.getPlane=function($Tt){switch($Tt){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$Tt.getCorners=function($Tt){$TL._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($Tt[0]),$TL._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($Tt[1]),$TL._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($Tt[2]),$TL._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($Tt[3]),$TL._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($Tt[4]),$TL._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($Tt[5]),$TL._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($Tt[6]),$TL._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($Tt[7])},$Tt.containsPoint=function($Tt){for(var $TM=$TMM.PlaneIntersectionType_Front,$Tf=$TMM.PlaneIntersectionType_Front,$Tc=0;$Tc<6;$Tc++){switch($Tc){case 0:$Tf=Collision.intersectsPlaneAndPoint(this._near,$Tt);break;case 1:$Tf=Collision.intersectsPlaneAndPoint(this._far,$Tt);break;case 2:$Tf=Collision.intersectsPlaneAndPoint(this._left,$Tt);break;case 3:$Tf=Collision.intersectsPlaneAndPoint(this._right,$Tt);break;case 4:$Tf=Collision.intersectsPlaneAndPoint(this._top,$Tt);break;case 5:$Tf=Collision.intersectsPlaneAndPoint(this._bottom,$Tt)}switch($Tf){case $TMM.PlaneIntersectionType_Back:return 0;case $TMM.PlaneIntersectionType_Intersecting:$TM=$TMM.PlaneIntersectionType_Intersecting}}switch($TM){case $TMM.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$Tt.containsBoundBox=function($Tt){for(var $TM,$Tf=$TL._tempV30,$Tc=$TL._tempV31,$TD=1,$To=0;$To<6;$To++){if($TM=this.getPlane($To),this._getBoxToPlanePVertexNVertex($Tt,$TM.normal,$Tf,$Tc),Collision.intersectsPlaneAndPoint($TM,$Tf)===$TMM.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($TM,$Tc)===$TMM.PlaneIntersectionType_Back&&($TD=2)}return $TD},$Tt.containsBoundSphere=function($Tt){for(var $TM=$TMM.PlaneIntersectionType_Front,$Tf=$TMM.PlaneIntersectionType_Front,$Tc=0;$Tc<6;$Tc++){switch($Tc){case 0:$Tf=Collision.intersectsPlaneAndSphere(this._near,$Tt);break;case 1:$Tf=Collision.intersectsPlaneAndSphere(this._far,$Tt);break;case 2:$Tf=Collision.intersectsPlaneAndSphere(this._left,$Tt);break;case 3:$Tf=Collision.intersectsPlaneAndSphere(this._right,$Tt);break;case 4:$Tf=Collision.intersectsPlaneAndSphere(this._top,$Tt);break;case 5:$Tf=Collision.intersectsPlaneAndSphere(this._bottom,$Tt)}switch($Tf){case $TMM.PlaneIntersectionType_Back:return 0;case $TMM.PlaneIntersectionType_Intersecting:$TM=$TMM.PlaneIntersectionType_Intersecting}}switch($TM){case $TMM.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$Tt._getBoxToPlanePVertexNVertex=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.min,$To=$TD.elements,$TJ=$Tt.max,$TZ=$TJ.elements,$TA=$TM.elements,$TL=$TA[0],$Tp=$TA[1],$TB=$TA[2];$TD.cloneTo($Tf);var $Tb=$Tf.elements;0<=$TL&&($Tb[0]=$TZ[0]),0<=$Tp&&($Tb[1]=$TZ[1]),0<=$TB&&($Tb[2]=$TZ[2]),$TJ.cloneTo($Tc);var $TI=$Tc.elements;0<=$TL&&($TI[0]=$To[0]),0<=$Tp&&($TI[1]=$To[1]),0<=$TB&&($TI[2]=$To[2])},$Tq(0,$Tt,"top",function(){return this._top}),$Tq(0,$Tt,"matrix",function(){return this._matrix},function($Tt){this._matrix=$Tt,$TL._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$Tq(0,$Tt,"near",function(){return this._near}),$Tq(0,$Tt,"far",function(){return this._far}),$Tq(0,$Tt,"left",function(){return this._left}),$Tq(0,$Tt,"right",function(){return this._right}),$Tq(0,$Tt,"bottom",function(){return this._bottom}),$TL._getPlanesFromMatrix=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ=$Tt.elements,$TA=$TZ[0],$TL=$TZ[1],$Tp=$TZ[2],$TB=$TZ[3],$Tb=$TZ[4],$TI=$TZ[5],$Tq=$TZ[6],$Tl=$TZ[7],$T_=$TZ[8],$TE=$TZ[9],$Te=$TZ[10],$TN=$TZ[11],$TX=$TZ[12],$Ty=$TZ[13],$Th=$TZ[14],$TT=$TZ[15],$Ti=$TM.normal.elements;$Ti[0]=$TB+$Tp,$Ti[1]=$Tl+$Tq,$Ti[2]=$TN+$Te,$TM.distance=$TT+$Th,$TM.normalize();var $TV=$Tf.normal.elements;$TV[0]=$TB-$Tp,$TV[1]=$Tl-$Tq,$TV[2]=$TN-$Te,$Tf.distance=$TT-$Th,$Tf.normalize();var $Tx=$Tc.normal.elements;$Tx[0]=$TB+$TA,$Tx[1]=$Tl+$Tb,$Tx[2]=$TN+$T_,$Tc.distance=$TT+$TX,$Tc.normalize();var $TO=$TD.normal.elements;$TO[0]=$TB-$TA,$TO[1]=$Tl-$Tb,$TO[2]=$TN-$T_,$TD.distance=$TT-$TX,$TD.normalize();var $TC=$To.normal.elements;$TC[0]=$TB-$TL,$TC[1]=$Tl-$TI,$TC[2]=$TN-$TE,$To.distance=$TT-$Ty,$To.normalize();var $TU=$TJ.normal.elements;$TU[0]=$TB+$TL,$TU[1]=$Tl+$TI,$TU[2]=$TN+$TE,$TJ.distance=$TT+$Ty,$TJ.normalize()},$TL._get3PlaneInterPoint=function($Tt,$TM,$Tf){var $Tc=$Tt.normal,$TD=$TM.normal,$To=$Tf.normal;$TJM.cross($TD,$To,$TL._tempV30),$TJM.cross($To,$Tc,$TL._tempV31),$TJM.cross($Tc,$TD,$TL._tempV32);var $TJ=$TJM.dot($Tc,$TL._tempV30),$TZ=$TJM.dot($TD,$TL._tempV31),$TA=$TJM.dot($To,$TL._tempV32);return $TJM.scale($TL._tempV30,-$Tt.distance/$TJ,$TL._tempV33),$TJM.scale($TL._tempV31,-$TM.distance/$TZ,$TL._tempV34),$TJM.scale($TL._tempV32,-$Tf.distance/$TA,$TL._tempV35),$TJM.add($TL._tempV33,$TL._tempV34,$TL._tempV36),$TJM.add($TL._tempV35,$TL._tempV36,$TL._tempV37),$TL._tempV37},$TB($TL,["_tempV30",function(){return this._tempV30=new $TJM},"_tempV31",function(){return this._tempV31=new $TJM},"_tempV32",function(){return this._tempV32=new $TJM},"_tempV33",function(){return this._tempV33=new $TJM},"_tempV34",function(){return this._tempV34=new $TJM},"_tempV35",function(){return this._tempV35=new $TJM},"_tempV36",function(){return this._tempV36=new $TJM},"_tempV37",function(){return this._tempV37=new $TJM}]),$TL}(),$TQt=function(){function $Tp($Tt,$TM){this.center=null,this.radius=NaN,this.center=$Tt,this.radius=$TM}$TI($Tp,"laya.d3.math.BoundSphere");var $Tt=$Tp.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.toDefault=function(){this.center.toDefault(),this.radius=0},$Tt.intersectsRayDistance=function($Tt){return Collision.intersectsRayAndSphereRD($Tt,this)},$Tt.intersectsRayPoint=function($Tt,$TM){return Collision.intersectsRayAndSphereRP($Tt,this,$TM)},$Tt.cloneTo=function($Tt){var $TM=$Tt;this.center.cloneTo($TM.center),$TM.radius=this.radius},$Tt.clone=function(){var $Tt=new this.constructor(new $TJM,new $TJM);return this.cloneTo($Tt),$Tt},$Tp.createFromSubPoints=function($Tt,$TM,$Tf,$Tc){if(null==$Tt)throw new Error("points");if($TM<0||$TM>=$Tt.length)throw new Error("start"+$TM+"Must be in the range [0, "+($Tt.length-1)+"]");if($Tf<0||$TM+$Tf>$Tt.length)throw new Error("count"+$Tf+"Must be in the range <= "+$Tt.length+"}");var $TD=$TM+$Tf,$To=$Tp._tempVector3;$To.elements[0]=0,$To.elements[1]=0,$To.elements[2]=0;for(var $TJ=$TM;$TJ<$TD;++$TJ)$TJM.add($Tt[$TJ],$To,$To);var $TZ=$Tc.center;$TJM.scale($To,1/$Tf,$TZ);var $TA=0;for($TJ=$TM;$TJ<$TD;++$TJ){var $TL=$TJM.distanceSquared($TZ,$Tt[$TJ]);$TA<$TL&&($TA=$TL)}$Tc.radius=Math.sqrt($TA)},$Tp.createfromPoints=function($Tt,$TM){if(null==$Tt)throw new Error("points");$Tp.createFromSubPoints($Tt,0,$Tt.length,$TM)},$TB($Tp,["_tempVector3",function(){return this._tempVector3=new $TJM}]),$Tp}(),$Twt=(function(){function $Tt(){}$TI($Tt,"laya.d3.math.ContainmentType"),$Tt.Disjoint=0,$Tt.Contains=1,$Tt.Intersects=2}(),function(){function $Tf(){}return $TI($Tf,"laya.d3.math.MathUtils3D"),$Tf.isZero=function($Tt){return Math.abs($Tt)<$Tf.zeroTolerance},$Tf.nearEqual=function($Tt,$TM){return!!$Tf.isZero($Tt-$TM)},$Tf.fastInvSqrt=function($Tt){return $Tf.isZero($Tt)?$Tt:1/Math.sqrt($Tt)},$TB($Tf,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$Tf}()),$TWt=function(){function $TA(){var $Tt=this.elements=new Float32Array(9);$Tt[0]=1,$Tt[1]=0,$Tt[2]=0,$Tt[3]=0,$Tt[4]=1,$Tt[5]=0,$Tt[6]=0,$Tt[7]=0,$Tt[8]=1}$TI($TA,"laya.d3.math.Matrix3x3");var $Tt=$TA.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.determinant=function(){var $Tt=this.elements,$TM=$Tt[0],$Tf=$Tt[1],$Tc=$Tt[2],$TD=$Tt[3],$To=$Tt[4],$TJ=$Tt[5],$TZ=$Tt[6],$TA=$Tt[7],$TL=$Tt[8];return $TM*($TL*$To-$TJ*$TA)+$Tf*(-$TL*$TD+$TJ*$TZ)+$Tc*($TA*$TD-$To*$TZ)},$Tt.translate=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements,$TD=$Tt.elements,$To=$Tc[0],$TJ=$Tc[1],$TZ=$Tc[2],$TA=$Tc[3],$TL=$Tc[4],$Tp=$Tc[5],$TB=$Tc[6],$Tb=$Tc[7],$TI=$Tc[8],$Tq=$TD[0],$Tl=$TD[1];$Tf[0]=$To,$Tf[1]=$TJ,$Tf[2]=$TZ,$Tf[3]=$TA,$Tf[4]=$TL,$Tf[5]=$Tp,$Tf[6]=$Tq*$To+$Tl*$TA+$TB,$Tf[7]=$Tq*$TJ+$Tl*$TL+$Tb,$Tf[8]=$Tq*$TZ+$Tl*$Tp+$TI},$Tt.rotate=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=$Tc[4],$TL=$Tc[5],$Tp=$Tc[6],$TB=$Tc[7],$Tb=$Tc[8],$TI=Math.sin($Tt),$Tq=Math.cos($Tt);$Tf[0]=$Tq*$TD+$TI*$TZ,$Tf[1]=$Tq*$To+$TI*$TA,$Tf[2]=$Tq*$TJ+$TI*$TL,$Tf[3]=$Tq*$TZ-$TI*$TD,$Tf[4]=$Tq*$TA-$TI*$To,$Tf[5]=$Tq*$TL-$TI*$TJ,$Tf[6]=$Tp,$Tf[7]=$TB,$Tf[8]=$Tb},$Tt.scale=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements,$TD=$Tt.elements,$To=$TD[0],$TJ=$TD[1];$Tf[0]=$To*$Tc[0],$Tf[1]=$To*$Tc[1],$Tf[2]=$To*$Tc[2],$Tf[3]=$TJ*$Tc[3],$Tf[4]=$TJ*$Tc[4],$Tf[5]=$TJ*$Tc[5],$Tf[6]=$Tc[6],$Tf[7]=$Tc[7],$Tf[8]=$Tc[8]},$Tt.invert=function($Tt){var $TM=$Tt.elements,$Tf=this.elements,$Tc=$Tf[0],$TD=$Tf[1],$To=$Tf[2],$TJ=$Tf[3],$TZ=$Tf[4],$TA=$Tf[5],$TL=$Tf[6],$Tp=$Tf[7],$TB=$Tf[8],$Tb=$TB*$TZ-$TA*$Tp,$TI=-$TB*$TJ+$TA*$TL,$Tq=$Tp*$TJ-$TZ*$TL,$Tl=$Tc*$Tb+$TD*$TI+$To*$Tq;$Tl||($Tt=null),$Tl=1/$Tl,$TM[0]=$Tb*$Tl,$TM[1]=(-$TB*$TD+$To*$Tp)*$Tl,$TM[2]=($TA*$TD-$To*$TZ)*$Tl,$TM[3]=$TI*$Tl,$TM[4]=($TB*$Tc-$To*$TL)*$Tl,$TM[5]=(-$TA*$Tc+$To*$TJ)*$Tl,$TM[6]=$Tq*$Tl,$TM[7]=(-$Tp*$Tc+$TD*$TL)*$Tl,$TM[8]=($TZ*$Tc-$TD*$TJ)*$Tl},$Tt.transpose=function($Tt){var $TM=$Tt.elements,$Tf=this.elements;if($Tt===this){var $Tc=$Tf[1],$TD=$Tf[2],$To=$Tf[5];$TM[1]=$Tf[3],$TM[2]=$Tf[6],$TM[3]=$Tc,$TM[5]=$Tf[7],$TM[6]=$TD,$TM[7]=$To}else $TM[0]=$Tf[0],$TM[1]=$Tf[3],$TM[2]=$Tf[6],$TM[3]=$Tf[1],$TM[4]=$Tf[4],$TM[5]=$Tf[7],$TM[6]=$Tf[2],$TM[7]=$Tf[5],$TM[8]=$Tf[8]},$Tt.identity=function(){var $Tt=this.elements;$Tt[0]=1,$Tt[1]=0,$Tt[2]=0,$Tt[3]=0,$Tt[4]=1,$Tt[5]=0,$Tt[6]=0,$Tt[7]=0,$Tt[8]=1},$Tt.cloneTo=function($Tt){var $TM,$Tf,$Tc;if(($Tf=this.elements)!==($Tc=$Tt.elements))for($TM=0;$TM<9;++$TM)$Tc[$TM]=$Tf[$TM]},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$TA.createFromTranslation=function($Tt,$TM){$TM.elements;var $Tf=$Tt.elements;$TM[0]=1,$TM[1]=0,$TM[2]=0,$TM[3]=0,$TM[4]=1,$TM[5]=0,$TM[6]=$Tf[0],$TM[7]=$Tf[1],$TM[8]=1},$TA.createFromRotation=function($Tt,$TM){var $Tf=$TM.elements,$Tc=Math.sin($Tt),$TD=Math.cos($Tt);$Tf[0]=$TD,$Tf[1]=$Tc,$Tf[2]=0,$Tf[3]=-$Tc,$Tf[4]=$TD,$Tf[5]=0,$Tf[6]=0,$Tf[7]=0,$Tf[8]=1},$TA.createFromScaling=function($Tt,$TM){var $Tf=$TM.elements,$Tc=$Tt.elements;$Tf[0]=$Tc[0],$Tf[1]=0,$Tf[2]=0,$Tf[3]=0,$Tf[4]=$Tc[1],$Tf[5]=0,$Tf[6]=0,$Tf[7]=0,$Tf[8]=1},$TA.createFromMatrix4x4=function($Tt,$TM){$TM[0]=$Tt[0],$TM[1]=$Tt[1],$TM[2]=$Tt[2],$TM[3]=$Tt[4],$TM[4]=$Tt[5],$TM[5]=$Tt[6],$TM[6]=$Tt[8],$TM[7]=$Tt[9],$TM[8]=$Tt[10]},$TA.multiply=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements,$TJ=$TD[0],$TZ=$TD[1],$TA=$TD[2],$TL=$TD[3],$Tp=$TD[4],$TB=$TD[5],$Tb=$TD[6],$TI=$TD[7],$Tq=$TD[8],$Tl=$To[0],$T_=$To[1],$TE=$To[2],$Te=$To[3],$TN=$To[4],$TX=$To[5],$Ty=$To[6],$Th=$To[7],$TT=$To[8];$Tc[0]=$Tl*$TJ+$T_*$TL+$TE*$Tb,$Tc[1]=$Tl*$TZ+$T_*$Tp+$TE*$TI,$Tc[2]=$Tl*$TA+$T_*$TB+$TE*$Tq,$Tc[3]=$Te*$TJ+$TN*$TL+$TX*$Tb,$Tc[4]=$Te*$TZ+$TN*$Tp+$TX*$TI,$Tc[5]=$Te*$TA+$TN*$TB+$TX*$Tq,$Tc[6]=$Ty*$TJ+$Th*$TL+$TT*$Tb,$Tc[7]=$Ty*$TZ+$Th*$Tp+$TT*$TI,$Tc[8]=$Ty*$TA+$Th*$TB+$TT*$Tq},$TA.lookAt=function($Tt,$TM,$Tf,$Tc){$TJM.subtract($Tt,$TM,$TA._tempV30),$TJM.normalize($TA._tempV30,$TA._tempV30),$TJM.cross($Tf,$TA._tempV30,$TA._tempV31),$TJM.normalize($TA._tempV31,$TA._tempV31),$TJM.cross($TA._tempV30,$TA._tempV31,$TA._tempV32);var $TD=$TA._tempV30.elements,$To=$TA._tempV31.elements,$TJ=$TA._tempV32.elements,$TZ=$Tc.elements;$TZ[0]=$To[0],$TZ[3]=$To[1],$TZ[6]=$To[2],$TZ[1]=$TJ[0],$TZ[4]=$TJ[1],$TZ[7]=$TJ[2],$TZ[2]=$TD[0],$TZ[5]=$TD[1],$TZ[8]=$TD[2]},$TA.DEFAULT=new $TA,$TB($TA,["_tempV30",function(){return this._tempV30=new $TJM},"_tempV31",function(){return this._tempV31=new $TJM},"_tempV32",function(){return this._tempV32=new $TJM}]),$TA}(),$TtM=function(){function $TV($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB,$Tb,$TI,$Tq,$Tl){void 0===$Tt&&($Tt=1),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$To&&($To=1),void 0===$TJ&&($TJ=0),void 0===$TZ&&($TZ=0),void 0===$TA&&($TA=0),void 0===$TL&&($TL=0),void 0===$Tp&&($Tp=1),void 0===$TB&&($TB=0),void 0===$Tb&&($Tb=0),void 0===$TI&&($TI=0),void 0===$Tq&&($Tq=0),void 0===$Tl&&($Tl=1);var $T_=this.elements=new Float32Array(16);$T_[0]=$Tt,$T_[1]=$TM,$T_[2]=$Tf,$T_[3]=$Tc,$T_[4]=$TD,$T_[5]=$To,$T_[6]=$TJ,$T_[7]=$TZ,$T_[8]=$TA,$T_[9]=$TL,$T_[10]=$Tp,$T_[11]=$TB,$T_[12]=$Tb,$T_[13]=$TI,$T_[14]=$Tq,$T_[15]=$Tl}$TI($TV,"laya.d3.math.Matrix4x4");var $Tt=$TV.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.getElementByRowColumn=function($Tt,$TM){if($Tt<0||3<$Tt)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($TM<0||3<$TM)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$Tt+$TM]},$Tt.setElementByRowColumn=function($Tt,$TM,$Tf){if($Tt<0||3<$Tt)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($TM<0||3<$TM)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$Tt+$TM]=$Tf},$Tt.equalsOtherMatrix=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;return $Twt.nearEqual($TM[0],$Tf[0])&&$Twt.nearEqual($TM[1],$Tf[1])&&$Twt.nearEqual($TM[2],$Tf[2])&&$Twt.nearEqual($TM[3],$Tf[3])&&$Twt.nearEqual($TM[4],$Tf[4])&&$Twt.nearEqual($TM[5],$Tf[5])&&$Twt.nearEqual($TM[6],$Tf[6])&&$Twt.nearEqual($TM[7],$Tf[7])&&$Twt.nearEqual($TM[8],$Tf[8])&&$Twt.nearEqual($TM[9],$Tf[9])&&$Twt.nearEqual($TM[10],$Tf[10])&&$Twt.nearEqual($TM[11],$Tf[11])&&$Twt.nearEqual($TM[12],$Tf[12])&&$Twt.nearEqual($TM[13],$Tf[13])&&$Twt.nearEqual($TM[14],$Tf[14])&&$Twt.nearEqual($TM[15],$Tf[15])},$Tt.decomposeTransRotScale=function($Tt,$TM,$Tf){var $Tc=$TV._tempMatrix4x4;return this.decomposeTransRotMatScale($Tt,$Tc,$Tf)?($TfM.createFromMatrix4x4($Tc,$TM),!0):($TM.identity(),!1)},$Tt.decomposeTransRotMatScale=function($Tt,$TM,$Tf){var $Tc=this.elements,$TD=$Tt.elements,$To=$TM.elements,$TJ=$Tf.elements;$TD[0]=$Tc[12],$TD[1]=$Tc[13],$TD[2]=$Tc[14];var $TZ=$Tc[0],$TA=$Tc[1],$TL=$Tc[2],$Tp=$Tc[4],$TB=$Tc[5],$Tb=$Tc[6],$TI=$Tc[8],$Tq=$Tc[9],$Tl=$Tc[10],$T_=$TJ[0]=Math.sqrt($TZ*$TZ+$TA*$TA+$TL*$TL),$TE=$TJ[1]=Math.sqrt($Tp*$Tp+$TB*$TB+$Tb*$Tb),$Te=$TJ[2]=Math.sqrt($TI*$TI+$Tq*$Tq+$Tl*$Tl);if($Twt.isZero($T_)||$Twt.isZero($TE)||$Twt.isZero($Te))return $To[1]=$To[2]=$To[3]=$To[4]=$To[6]=$To[7]=$To[8]=$To[9]=$To[11]=$To[12]=$To[13]=$To[14]=0,$To[0]=$To[5]=$To[10]=$To[15]=1,!1;var $TN=$TV._tempVector0,$TX=$TN.elements;$TX[0]=$TI/$Te,$TX[1]=$Tq/$Te,$TX[2]=$Tl/$Te;var $Ty=$TV._tempVector1,$Th=$Ty.elements;$Th[0]=$TZ/$T_,$Th[1]=$TA/$T_,$Th[2]=$TL/$T_;var $TT=$TV._tempVector2;$TJM.cross($TN,$Ty,$TT);var $Ti=$TV._tempVector1;return $TJM.cross($TT,$TN,$Ti),$To[3]=$To[7]=$To[11]=$To[12]=$To[13]=$To[14]=0,$To[15]=1,$To[0]=$Ti.x,$To[1]=$Ti.y,$To[2]=$Ti.z,$To[4]=$TT.x,$To[5]=$TT.y,$To[6]=$TT.z,$To[8]=$TN.x,$To[9]=$TN.y,$To[10]=$TN.z,$To[0]*$TZ+$To[1]*$TA+$To[2]*$TL<0&&($TJ[0]=-$T_),$To[4]*$Tp+$To[5]*$TB+$To[6]*$Tb<0&&($TJ[1]=-$TE),$To[8]*$TI+$To[9]*$Tq+$To[10]*$Tl<0&&($TJ[2]=-$Te),!0},$Tt.decomposeYawPitchRoll=function($Tt){var $TM=$Tt.elements,$Tf=Math.asin(-this.elements[9]);$TM[1]=$Tf,Math.cos($Tf)>$Twt.zeroTolerance?($TM[2]=Math.atan2(this.elements[1],this.elements[5]),$TM[0]=Math.atan2(this.elements[8],this.elements[10])):($TM[2]=Math.atan2(-this.elements[4],this.elements[0]),$TM[0]=0)},$Tt.normalize=function(){var $Tt=this.elements,$TM=$Tt[0],$Tf=$Tt[1],$Tc=$Tt[2],$TD=Math.sqrt($TM*$TM+$Tf*$Tf+$Tc*$Tc);if(!$TD)return $Tt[0]=0,$Tt[1]=0,void($Tt[2]=0);1!=$TD&&($TD=1/$TD,$Tt[0]=$TM*$TD,$Tt[1]=$Tf*$TD,$Tt[2]=$Tc*$TD)},$Tt.transpose=function(){var $Tt,$TM;return $TM=($Tt=this.elements)[1],$Tt[1]=$Tt[4],$Tt[4]=$TM,$TM=$Tt[2],$Tt[2]=$Tt[8],$Tt[8]=$TM,$TM=$Tt[3],$Tt[3]=$Tt[12],$Tt[12]=$TM,$TM=$Tt[6],$Tt[6]=$Tt[9],$Tt[9]=$TM,$TM=$Tt[7],$Tt[7]=$Tt[13],$Tt[13]=$TM,$TM=$Tt[11],$Tt[11]=$Tt[14],$Tt[14]=$TM,this},$Tt.invert=function($Tt){var $TM=this.elements,$Tf=$Tt.elements,$Tc=$TM[0],$TD=$TM[1],$To=$TM[2],$TJ=$TM[3],$TZ=$TM[4],$TA=$TM[5],$TL=$TM[6],$Tp=$TM[7],$TB=$TM[8],$Tb=$TM[9],$TI=$TM[10],$Tq=$TM[11],$Tl=$TM[12],$T_=$TM[13],$TE=$TM[14],$Te=$TM[15],$TN=$Tc*$TA-$TD*$TZ,$TX=$Tc*$TL-$To*$TZ,$Ty=$Tc*$Tp-$TJ*$TZ,$Th=$TD*$TL-$To*$TA,$TT=$TD*$Tp-$TJ*$TA,$Ti=$To*$Tp-$TJ*$TL,$TV=$TB*$T_-$Tb*$Tl,$Tx=$TB*$TE-$TI*$Tl,$TO=$TB*$Te-$Tq*$Tl,$TC=$Tb*$TE-$TI*$T_,$TU=$Tb*$Te-$Tq*$T_,$TF=$TI*$Te-$Tq*$TE,$TS=$TN*$TF-$TX*$TU+$Ty*$TC+$Th*$TO-$TT*$Tx+$Ti*$TV;0!==Math.abs($TS)&&($TS=1/$TS,$Tf[0]=($TA*$TF-$TL*$TU+$Tp*$TC)*$TS,$Tf[1]=($To*$TU-$TD*$TF-$TJ*$TC)*$TS,$Tf[2]=($T_*$Ti-$TE*$TT+$Te*$Th)*$TS,$Tf[3]=($TI*$TT-$Tb*$Ti-$Tq*$Th)*$TS,$Tf[4]=($TL*$TO-$TZ*$TF-$Tp*$Tx)*$TS,$Tf[5]=($Tc*$TF-$To*$TO+$TJ*$Tx)*$TS,$Tf[6]=($TE*$Ty-$Tl*$Ti-$Te*$TX)*$TS,$Tf[7]=($TB*$Ti-$TI*$Ty+$Tq*$TX)*$TS,$Tf[8]=($TZ*$TU-$TA*$TO+$Tp*$TV)*$TS,$Tf[9]=($TD*$TO-$Tc*$TU-$TJ*$TV)*$TS,$Tf[10]=($Tl*$TT-$T_*$Ty+$Te*$TN)*$TS,$Tf[11]=($Tb*$Ty-$TB*$TT-$Tq*$TN)*$TS,$Tf[12]=($TA*$Tx-$TZ*$TC-$TL*$TV)*$TS,$Tf[13]=($Tc*$TC-$TD*$Tx+$To*$TV)*$TS,$Tf[14]=($T_*$TX-$Tl*$Th-$TE*$TN)*$TS,$Tf[15]=($TB*$Th-$Tb*$TX+$TI*$TN)*$TS)},$Tt.identity=function(){var $Tt=this.elements;$Tt[1]=$Tt[2]=$Tt[3]=$Tt[4]=$Tt[6]=$Tt[7]=$Tt[8]=$Tt[9]=$Tt[11]=$Tt[12]=$Tt[13]=$Tt[14]=0,$Tt[0]=$Tt[5]=$Tt[10]=$Tt[15]=1},$Tt.cloneTo=function($Tt){var $TM,$Tf,$Tc;if(($Tf=this.elements)!==($Tc=$Tt.elements))for($TM=0;$TM<16;++$TM)$Tc[$TM]=$Tf[$TM]},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tt.getTranslationVector=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;$Tf[0]=$TM[12],$Tf[1]=$TM[13],$Tf[2]=$TM[14]},$Tt.setTranslationVector=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;$TM[12]=$Tf[0],$TM[13]=$Tf[1],$TM[14]=$Tf[2]},$Tt.getForward=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;$Tf[0]=-$TM[8],$Tf[1]=-$TM[9],$Tf[2]=-$TM[10]},$Tt.setForward=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;$TM[8]=-$Tf[0],$TM[9]=-$Tf[1],$TM[10]=-$Tf[2]},$TV.createRotationX=function($Tt,$TM){var $Tf=$TM.elements,$Tc=Math.sin($Tt),$TD=Math.cos($Tt);$Tf[1]=$Tf[2]=$Tf[3]=$Tf[4]=$Tf[7]=$Tf[8]=$Tf[11]=$Tf[12]=$Tf[13]=$Tf[14]=0,$Tf[0]=$Tf[15]=1,$Tf[5]=$Tf[10]=$TD,$Tf[6]=$Tc,$Tf[9]=-$Tc},$TV.createRotationY=function($Tt,$TM){var $Tf=$TM.elements,$Tc=Math.sin($Tt),$TD=Math.cos($Tt);$Tf[1]=$Tf[3]=$Tf[4]=$Tf[6]=$Tf[7]=$Tf[9]=$Tf[11]=$Tf[12]=$Tf[13]=$Tf[14]=0,$Tf[5]=$Tf[15]=1,$Tf[0]=$Tf[10]=$TD,$Tf[2]=-$Tc,$Tf[8]=$Tc},$TV.createRotationZ=function($Tt,$TM){var $Tf=$TM.elements,$Tc=Math.sin($Tt),$TD=Math.cos($Tt);$Tf[2]=$Tf[3]=$Tf[6]=$Tf[7]=$Tf[8]=$Tf[9]=$Tf[11]=$Tf[12]=$Tf[13]=$Tf[14]=0,$Tf[10]=$Tf[15]=1,$Tf[0]=$Tf[5]=$TD,$Tf[1]=$Tc,$Tf[4]=-$Tc},$TV.createRotationYawPitchRoll=function($Tt,$TM,$Tf,$Tc){$TfM.createFromYawPitchRoll($Tt,$TM,$Tf,$TV._tempQuaternion),$TV.createRotationQuaternion($TV._tempQuaternion,$Tc)},$TV.createRotationAxis=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=Math.cos($TM),$TA=Math.sin($TM),$TL=$TD*$TD,$Tp=$To*$To,$TB=$TJ*$TJ,$Tb=$TD*$To,$TI=$TD*$TJ,$Tq=$To*$TJ,$Tl=$Tf.elements;$Tl[3]=$Tl[7]=$Tl[11]=$Tl[12]=$Tl[13]=$Tl[14]=0,$Tl[15]=1,$Tl[0]=$TL+$TZ*(1-$TL),$Tl[1]=$Tb-$TZ*$Tb+$TA*$TJ,$Tl[2]=$TI-$TZ*$TI-$TA*$To,$Tl[4]=$Tb-$TZ*$Tb-$TA*$TJ,$Tl[5]=$Tp+$TZ*(1-$Tp),$Tl[6]=$Tq-$TZ*$Tq+$TA*$TD,$Tl[8]=$TI-$TZ*$TI+$TA*$To,$Tl[9]=$Tq-$TZ*$Tq-$TA*$TD,$Tl[10]=$TB+$TZ*(1-$TB)},$TV.createRotationQuaternion=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0],$To=$Tf[1],$TJ=$Tf[2],$TZ=$Tf[3],$TA=$TD*$TD,$TL=$To*$To,$Tp=$TJ*$TJ,$TB=$TD*$To,$Tb=$TJ*$TZ,$TI=$TJ*$TD,$Tq=$To*$TZ,$Tl=$To*$TJ,$T_=$TD*$TZ;$Tc[3]=$Tc[7]=$Tc[11]=$Tc[12]=$Tc[13]=$Tc[14]=0,$Tc[15]=1,$Tc[0]=1-2*($TL+$Tp),$Tc[1]=2*($TB+$Tb),$Tc[2]=2*($TI-$Tq),$Tc[4]=2*($TB-$Tb),$Tc[5]=1-2*($Tp+$TA),$Tc[6]=2*($Tl+$T_),$Tc[8]=2*($TI+$Tq),$Tc[9]=2*($Tl-$T_),$Tc[10]=1-2*($TL+$TA)},$TV.createTranslate=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;$Tc[4]=$Tc[8]=$Tc[1]=$Tc[9]=$Tc[2]=$Tc[6]=$Tc[3]=$Tc[7]=$Tc[11]=0,$Tc[0]=$Tc[5]=$Tc[10]=$Tc[15]=1,$Tc[12]=$Tf[0],$Tc[13]=$Tf[1],$Tc[14]=$Tf[2]},$TV.createScaling=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;$Tc[0]=$Tf[0],$Tc[5]=$Tf[1],$Tc[10]=$Tf[2],$Tc[1]=$Tc[4]=$Tc[8]=$Tc[12]=$Tc[9]=$Tc[13]=$Tc[2]=$Tc[6]=$Tc[14]=$Tc[3]=$Tc[7]=$Tc[11]=0,$Tc[15]=1},$TV.multiply=function($Tt,$TM,$Tf){var $Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp;for($TD=$Tf.elements,$To=$Tt.elements,$TD===($TJ=$TM.elements)&&($TJ=$TJ.slice()),$Tc=0;$Tc<4;$Tc++)$TZ=$To[$Tc],$TA=$To[$Tc+4],$TL=$To[$Tc+8],$Tp=$To[$Tc+12],$TD[$Tc]=$TZ*$TJ[0]+$TA*$TJ[1]+$TL*$TJ[2]+$Tp*$TJ[3],$TD[$Tc+4]=$TZ*$TJ[4]+$TA*$TJ[5]+$TL*$TJ[6]+$Tp*$TJ[7],$TD[$Tc+8]=$TZ*$TJ[8]+$TA*$TJ[9]+$TL*$TJ[10]+$Tp*$TJ[11],$TD[$Tc+12]=$TZ*$TJ[12]+$TA*$TJ[13]+$TL*$TJ[14]+$Tp*$TJ[15]},$TV.createFromQuaternion=function($Tt,$TM){var $Tf=$TM.elements,$Tc=$Tt.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=$TD+$TD,$TL=$To+$To,$Tp=$TJ+$TJ,$TB=$TD*$TA,$Tb=$To*$TA,$TI=$To*$TL,$Tq=$TJ*$TA,$Tl=$TJ*$TL,$T_=$TJ*$Tp,$TE=$TZ*$TA,$Te=$TZ*$TL,$TN=$TZ*$Tp;$Tf[0]=1-$TI-$T_,$Tf[1]=$Tb+$TN,$Tf[2]=$Tq-$Te,$Tf[3]=0,$Tf[4]=$Tb-$TN,$Tf[5]=1-$TB-$T_,$Tf[6]=$Tl+$TE,$Tf[7]=0,$Tf[8]=$Tq+$Te,$Tf[9]=$Tl-$TE,$Tf[10]=1-$TB-$TI,$Tf[11]=0,$Tf[12]=0,$Tf[13]=0,$Tf[14]=0,$Tf[15]=1},$TV.createAffineTransformation=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements,$To=$TM.elements,$TJ=$Tf.elements,$TZ=$Tc.elements,$TA=$To[0],$TL=$To[1],$Tp=$To[2],$TB=$To[3],$Tb=$TA+$TA,$TI=$TL+$TL,$Tq=$Tp+$Tp,$Tl=$TA*$Tb,$T_=$TA*$TI,$TE=$TA*$Tq,$Te=$TL*$TI,$TN=$TL*$Tq,$TX=$Tp*$Tq,$Ty=$TB*$Tb,$Th=$TB*$TI,$TT=$TB*$Tq,$Ti=$TJ[0],$TV=$TJ[1],$Tx=$TJ[2];$TZ[0]=(1-($Te+$TX))*$Ti,$TZ[1]=($T_+$TT)*$Ti,$TZ[2]=($TE-$Th)*$Ti,$TZ[3]=0,$TZ[4]=($T_-$TT)*$TV,$TZ[5]=(1-($Tl+$TX))*$TV,$TZ[6]=($TN+$Ty)*$TV,$TZ[7]=0,$TZ[8]=($TE+$Th)*$Tx,$TZ[9]=($TN-$Ty)*$Tx,$TZ[10]=(1-($Tl+$Te))*$Tx,$TZ[11]=0,$TZ[12]=$TD[0],$TZ[13]=$TD[1],$TZ[14]=$TD[2],$TZ[15]=1},$TV.createLookAt=function($Tt,$TM,$Tf,$Tc){var $TD=$Tc.elements,$To=$TV._tempVector0,$TJ=$TV._tempVector1,$TZ=$TV._tempVector2;$TJM.subtract($Tt,$TM,$TZ),$TJM.normalize($TZ,$TZ),$TJM.cross($Tf,$TZ,$To),$TJM.normalize($To,$To),$TJM.cross($TZ,$To,$TJ),$Tc.identity(),$TD[0]=$To.x,$TD[4]=$To.y,$TD[8]=$To.z,$TD[1]=$TJ.x,$TD[5]=$TJ.y,$TD[9]=$TJ.z,$TD[2]=$TZ.x,$TD[6]=$TZ.y,$TD[10]=$TZ.z,$TD[12]=-$TJM.dot($To,$Tt),$TD[13]=-$TJM.dot($TJ,$Tt),$TD[14]=-$TJM.dot($TZ,$Tt)},$TV.createPerspective=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TD.elements,$TJ=1/Math.tan($Tt/2),$TZ=1/($Tf-$Tc);$To[0]=$TJ/$TM,$To[5]=$TJ,$To[10]=($Tc+$Tf)*$TZ,$To[11]=-1,$To[14]=2*$Tc*$Tf*$TZ,$To[1]=$To[2]=$To[3]=$To[4]=$To[6]=$To[7]=$To[8]=$To[9]=$To[12]=$To[13]=$To[15]=0},$TV.createOrthoOffCenterRH=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ=$TJ.elements,$TA=1/($Tt-$TM),$TL=1/($Tf-$Tc),$Tp=1/($TD-$To);$TZ[1]=$TZ[2]=$TZ[3]=$TZ[4]=$TZ[6]=$TZ[7]=$TZ[8]=$TZ[9]=$TZ[11]=0,$TZ[15]=1,$TZ[0]=-2*$TA,$TZ[5]=-2*$TL,$TZ[10]=2*$Tp,$TZ[12]=($Tt+$TM)*$TA,$TZ[13]=($Tc+$Tf)*$TL,$TZ[14]=($To+$TD)*$Tp},$TV.translation=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;$Tc[0]=$Tc[5]=$Tc[10]=$Tc[15]=1,$Tc[12]=$Tf[0],$Tc[13]=$Tf[1],$Tc[14]=$Tf[2]},$TB($TV,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $TV},"_tempVector0",function(){return this._tempVector0=new $TJM},"_tempVector1",function(){return this._tempVector1=new $TJM},"_tempVector2",function(){return this._tempVector2=new $TJM},"_tempQuaternion",function(){return this._tempQuaternion=new $TfM},"DEFAULT",function(){return this.DEFAULT=new $TV},"ZERO",function(){return this.ZERO=new $TV(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$TV}(),$TMM=(function(){function $TN($Tt,$TM){this.extents=null,this.transformation=null,this.extents=$Tt,this.transformation=$TM}$TI($TN,"laya.d3.math.OrientedBoundBox");var $Tt=$TN.prototype;$Tt.getCorners=function($Tt){var $TM=$TN._tempV30.elements,$Tf=$TN._tempV31.elements,$Tc=$TN._tempV32.elements,$TD=this.extents.elements;$TM[0]=$TD[0],$TM[1]=$TM[2]=0,$Tf[1]=$TD[1],$Tf[0]=$Tf[2]=0,$Tc[2]=$TD[2],$Tc[0]=$Tc[1]=0,$TJM.TransformNormal($TN._tempV30,this.transformation,$TN._tempV30),$TJM.TransformNormal($TN._tempV31,this.transformation,$TN._tempV31),$TJM.TransformNormal($TN._tempV32,this.transformation,$TN._tempV32);var $To=$TN._tempV33;this.transformation.getTranslationVector($To),$Tt.length=8,$TJM.add($To,$TN._tempV30,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV32,$Tt[0]),$TJM.add($To,$TN._tempV30,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV32,$Tt[1]),$TJM.subtract($To,$TN._tempV30,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV32,$Tt[2]),$TJM.subtract($To,$TN._tempV30,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV32,$Tt[3]),$TJM.add($To,$TN._tempV30,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV32,$Tt[4]),$TJM.add($To,$TN._tempV30,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV32,$Tt[5]),$TJM.subtract($To,$TN._tempV30,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV32,$Tt[6]),$TJM.subtract($To,$TN._tempV30,$TN._tempV34),$TJM.subtract($TN._tempV34,$TN._tempV31,$TN._tempV34),$TJM.add($TN._tempV34,$TN._tempV32,$Tt[7])},$Tt.transform=function($Tt){$TtM.multiply(this.transformation,$Tt,this.transformation)},$Tt.scale=function($Tt){$TJM.multiply(this.extents,$Tt,this.extents)},$Tt.translate=function($Tt){this.transformation.getTranslationVector($TN._tempV30),$TJM.add($TN._tempV30,$Tt,$TN._tempV31),this.transformation.setTranslationVector($TN._tempV31)},$Tt.Size=function($Tt){$TJM.scale(this.extents,2,$Tt)},$Tt.getSize=function($Tt){var $TM=this.extents.elements;$TN._tempV30.x=$TM[0],$TN._tempV31.y=$TM[1],$TN._tempV32.z=$TM[2],$TJM.TransformNormal($TN._tempV30,this.transformation,$TN._tempV30),$TJM.TransformNormal($TN._tempV31,this.transformation,$TN._tempV31),$TJM.TransformNormal($TN._tempV31,this.transformation,$TN._tempV32);var $Tf=$Tt.elements;$Tf[0]=$TJM.scalarLength($TN._tempV30),$Tf[1]=$TJM.scalarLength($TN._tempV31),$Tf[2]=$TJM.scalarLength($TN._tempV32)},$Tt.getSizeSquared=function($Tt){var $TM=this.extents.elements;$TN._tempV30.x=$TM[0],$TN._tempV31.y=$TM[1],$TN._tempV32.z=$TM[2],$TJM.TransformNormal($TN._tempV30,this.transformation,$TN._tempV30),$TJM.TransformNormal($TN._tempV31,this.transformation,$TN._tempV31),$TJM.TransformNormal($TN._tempV31,this.transformation,$TN._tempV32);var $Tf=$Tt.elements;$Tf[0]=$TJM.scalarLengthSquared($TN._tempV30),$Tf[1]=$TJM.scalarLengthSquared($TN._tempV31),$Tf[2]=$TJM.scalarLengthSquared($TN._tempV32)},$Tt.getCenter=function($Tt){this.transformation.getTranslationVector($Tt)},$Tt.containsPoint=function($Tt){var $TM=this.extents.elements,$Tf=$TM[0],$Tc=$TM[1],$TD=$TM[2];this.transformation.invert($TN._tempM0),$TJM.transformCoordinate($Tt,$TN._tempM0,$TN._tempV30);var $To=$TN._tempV30.elements,$TJ=Math.abs($To[0]),$TZ=Math.abs($To[1]),$TA=Math.abs($To[2]);return $Twt.nearEqual($TJ,$Tf)&&$Twt.nearEqual($TZ,$Tc)&&$Twt.nearEqual($TA,$TD)?2:$TJ<$Tf&&$TZ<$Tc&&$TA<$TD?1:0},$Tt.containsPoints=function($Tt){var $TM=this.extents.elements,$Tf=$TM[0],$Tc=$TM[1],$TD=$TM[2];this.transformation.invert($TN._tempM0);for(var $To=!0,$TJ=!1,$TZ=0;$TZ<$Tt.length;$TZ++){$TJM.transformCoordinate($Tt[$TZ],$TN._tempM0,$TN._tempV30);var $TA=$TN._tempV30.elements,$TL=Math.abs($TA[0]),$Tp=Math.abs($TA[1]),$TB=Math.abs($TA[2]);$Twt.nearEqual($TL,$Tf)&&$Twt.nearEqual($Tp,$Tc)&&$Twt.nearEqual($TB,$TD)&&($TJ=!0),$TL<$Tf&&$Tp<$Tc&&$TB<$TD?$TJ=!0:$To=!1}return $To?1:$TJ?2:0},$Tt.containsSphere=function($Tt,$TM){void 0===$TM&&($TM=!1);var $Tf=this.extents.elements,$Tc=$Tf[0],$TD=$Tf[1],$To=$Tf[2],$TJ=$Tt.radius;this.transformation.invert($TN._tempM0),$TJM.transformCoordinate($Tt.center,$TN._tempM0,$TN._tempV30);var $TZ=NaN;if($TZ=$TM?$TJ:($TJM.scale($TJM.UnitX,$TJ,$TN._tempV31),$TJM.TransformNormal($TN._tempV31,$TN._tempM0,$TN._tempV31),$TJM.scalarLength($TN._tempV31)),$TJM.scale(this.extents,-1,$TN._tempV32),$TJM.Clamp($TN._tempV30,$TN._tempV32,this.extents,$TN._tempV33),$TZ*$TZ<$TJM.distanceSquared($TN._tempV30,$TN._tempV33))return 0;var $TA=$TN._tempV30.elements,$TL=$TA[0],$Tp=$TA[1],$TB=$TA[2],$Tb=$TN._tempV32.elements,$TI=$Tb[0],$Tq=$Tb[1],$Tl=$Tb[2];return $TI+$TZ<=$TL&&$TL<=$Tc-$TZ&&$TZ<$Tc-$TI&&$Tq+$TZ<=$Tp&&$Tp<=$TD-$TZ&&$TZ<$TD-$Tq&&$Tl+$TZ<=$TB&&$TB<=$To-$TZ&&$TZ<$To-$Tl?1:2},$Tt.containsOrientedBoundBox=function($Tt){var $TM=0,$Tf=0;$Tt.getCorners($TN._corners);var $Tc=this.containsPoints($TN._corners);if(0!=$Tc)return $Tc;var $TD=this.extents.elements;$Tt.extents.cloneTo($TN._tempV35);var $To=$TN._tempV35.elements;$TN._getRows(this.transformation,$TN._rows1),$TN._getRows($Tt.transformation,$TN._rows2);var $TJ=NaN;for($TM=0;$TM<4;$TM++)for($Tf=0;$Tf<4;$Tf++)3==$TM||3==$Tf?($TN._tempM0.setElementByRowColumn($TM,$Tf,0),$TN._tempM1.setElementByRowColumn($TM,$Tf,0)):($TJ=$TJM.dot($TN._rows1[$TM],$TN._rows2[$Tf]),$TN._tempM0.setElementByRowColumn($TM,$Tf,$TJ),$TN._tempM1.setElementByRowColumn($TM,$Tf,Math.abs($TJ)));$Tt.getCenter($TN._tempV34),this.getCenter($TN._tempV36),$TJM.subtract($TN._tempV34,$TN._tempV36,$TN._tempV30);var $TZ=$TN._tempV31.elements;$TZ[0]=$TJM.dot($TN._tempV30,$TN._rows1[0]),$TZ[1]=$TJM.dot($TN._tempV30,$TN._rows1[1]),$TZ[2]=$TJM.dot($TN._tempV30,$TN._rows1[2]);var $TA=$TN._tempV32.elements,$TL=$TN._tempV33.elements;for($TM=0;$TM<3;$TM++)if($TA[0]=$TN._tempM1.getElementByRowColumn($TM,0),$TA[1]=$TN._tempM1.getElementByRowColumn($TM,1),$TA[2]=$TN._tempM1.getElementByRowColumn($TM,2),$TD[$TM]+$TJM.dot($TN._tempV35,$TN._tempV32)<Math.abs($TZ[$TM]))return 0;for($Tf=0;$Tf<3;$Tf++)if($TA[0]=$TN._tempM1.getElementByRowColumn(0,$Tf),$TA[1]=$TN._tempM1.getElementByRowColumn(1,$Tf),$TA[2]=$TN._tempM1.getElementByRowColumn(2,$Tf),$TL[0]=$TN._tempM0.getElementByRowColumn(0,$Tf),$TL[1]=$TN._tempM0.getElementByRowColumn(1,$Tf),$TL[2]=$TN._tempM0.getElementByRowColumn(2,$Tf),$TJM.dot(this.extents,$TN._tempV32)+$To[$Tf]<Math.abs($TJM.dot($TN._tempV31,$TN._tempV33)))return 0;for($TM=0;$TM<3;$TM++)for($Tf=0;$Tf<3;$Tf++){var $Tp=($TM+1)%3,$TB=($TM+2)%3,$Tb=($Tf+1)%3,$TI=($Tf+2)%3;if($TD[$Tp]*$TN._tempM1.getElementByRowColumn($TB,$Tf)+$TD[$TB]*$TN._tempM1.getElementByRowColumn($Tp,$Tf)+($To[$Tb]*$TN._tempM1.getElementByRowColumn($TM,$TI)+$To[$TI]*$TN._tempM1.getElementByRowColumn($TM,$Tb))<Math.abs($TZ[$TB]*$TN._tempM0.getElementByRowColumn($Tp,$Tf)-$TZ[$Tp]*$TN._tempM0.getElementByRowColumn($TB,$Tf)))return 0}return 2},$Tt.containsLine=function($Tt,$TM){$TN._corners[0]=$Tt,$TN._corners[1]=$TM;var $Tf=this.containsPoints($TN._corners);if(0!=$Tf)return $Tf;var $Tc=this.extents.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2];this.transformation.invert($TN._tempM0),$TJM.transformCoordinate($Tt,$TN._tempM0,$TN._tempV30),$TJM.transformCoordinate($TM,$TN._tempM0,$TN._tempV31),$TJM.add($TN._tempV30,$TN._tempV31,$TN._tempV32),$TJM.scale($TN._tempV32,.5,$TN._tempV32),$TJM.subtract($TN._tempV30,$TN._tempV32,$TN._tempV33);var $TZ=$TN._tempV33.elements,$TA=$TZ[0],$TL=$TZ[1],$Tp=$TZ[2],$TB=$TN._tempV34.elements,$Tb=$TB[0]=Math.abs($TZ[0]),$TI=$TB[1]=Math.abs($TZ[1]),$Tq=$TB[2]=Math.abs($TZ[2]),$Tl=$TN._tempV32.elements,$T_=$Tl[0],$TE=$Tl[1],$Te=$Tl[2];return Math.abs($T_)>$TD+$Tb?0:Math.abs($TE)>$To+$TI?0:Math.abs($Te)>$TJ+$Tq?0:Math.abs($TE*$Tp-$Te*$TL)>$To*$Tq+$TJ*$TI?0:Math.abs($T_*$Tp-$Te*$TA)>$TD*$Tq+$TJ*$Tb?0:Math.abs($T_*$TL-$TE*$TA)>$TD*$TI+$To*$Tb?0:2},$Tt.containsBoundBox=function($Tt){var $TM=0,$Tf=0,$Tc=$Tt.min,$TD=$Tt.max;$Tt.getCorners($TN._corners);var $To=this.containsPoints($TN._corners);if(0!=$To)return $To;$TJM.subtract($TD,$Tc,$TN._tempV30),$TJM.scale($TN._tempV30,.5,$TN._tempV30),$TJM.add($Tc,$TN._tempV30,$TN._tempV30),$TJM.subtract($TD,$TN._tempV30,$TN._tempV31);var $TJ=this.extents.elements,$TZ=$TN._tempV31.elements;$TN._getRows(this.transformation,$TN._rows1),this.transformation.invert($TN._tempM0);for($TM=0;$TM<3;$TM++)for($Tf=0;$Tf<3;$Tf++)$TN._tempM1.setElementByRowColumn($TM,$Tf,Math.abs($TN._tempM0.getElementByRowColumn($TM,$Tf)));this.getCenter($TN._tempV35),$TJM.subtract($TN._tempV30,$TN._tempV35,$TN._tempV32);var $TA=$TN._tempV31.elements;$TA[0]=$TJM.dot($TN._tempV32,$TN._rows1[0]),$TA[1]=$TJM.dot($TN._tempV32,$TN._rows1[1]),$TA[2]=$TJM.dot($TN._tempV32,$TN._rows1[2]);var $TL=$TN._tempV33.elements,$Tp=$TN._tempV34.elements;for($TM=0;$TM<3;$TM++)if($TL[0]=$TN._tempM1.getElementByRowColumn($TM,0),$TL[1]=$TN._tempM1.getElementByRowColumn($TM,1),$TL[2]=$TN._tempM1.getElementByRowColumn($TM,2),$TJ[$TM]+$TJM.dot($TN._tempV31,$TN._tempV33)<Math.abs($TA[$TM]))return 0;for($Tf=0;$Tf<3;$Tf++)if($TL[0]=$TN._tempM1.getElementByRowColumn(0,$Tf),$TL[1]=$TN._tempM1.getElementByRowColumn(1,$Tf),$TL[2]=$TN._tempM1.getElementByRowColumn(2,$Tf),$Tp[0]=$TN._tempM0.getElementByRowColumn(0,$Tf),$Tp[1]=$TN._tempM0.getElementByRowColumn(1,$Tf),$Tp[2]=$TN._tempM0.getElementByRowColumn(2,$Tf),$TJM.dot(this.extents,$TN._tempV33)+$TZ[$Tf]<Math.abs($TJM.dot($TN._tempV31,$TN._tempV34)))return 0;for($TM=0;$TM<3;$TM++)for($Tf=0;$Tf<3;$Tf++){var $TB=($TM+1)%3,$Tb=($TM+2)%3,$TI=($Tf+1)%3,$Tq=($Tf+2)%3;if($TJ[$TB]*$TN._tempM1.getElementByRowColumn($Tb,$Tf)+$TJ[$Tb]*$TN._tempM1.getElementByRowColumn($TB,$Tf)+($TZ[$TI]*$TN._tempM1.getElementByRowColumn($TM,$Tq)+$TZ[$Tq]*$TN._tempM1.getElementByRowColumn($TM,$TI))<Math.abs($TA[$Tb]*$TN._tempM0.getElementByRowColumn($TB,$Tf)-$TA[$TB]*$TN._tempM0.getElementByRowColumn($Tb,$Tf)))return 0}return 2},$Tt.intersectsRay=function($Tt,$TM){$TJM.scale(this.extents,-1,$TN._tempV30),this.transformation.invert($TN._tempM0),$TJM.TransformNormal($Tt.direction,$TN._tempM0,$TN._ray.direction),$TJM.transformCoordinate($Tt.origin,$TN._tempM0,$TN._ray.origin),$TN._boxBound1.min=$TN._tempV30,$TN._boxBound1.max=this.extents;var $Tf=Collision.intersectsRayAndBoxRP($TN._ray,$TN._boxBound1,$TM);return-1!==$Tf&&$TJM.transformCoordinate($TM,this.transformation,$TM),$Tf},$Tt._getLocalCorners=function($Tt){$Tt.length=8;var $TM=this.extents.elements;$TN._tempV30.x=$TM[0],$TN._tempV31.y=$TM[1],$TN._tempV32.z=$TM[2],$TJM.add($TN._tempV30,$TN._tempV31,$TN._tempV33),$TJM.add($TN._tempV33,$TN._tempV32,$Tt[0]),$TJM.add($TN._tempV30,$TN._tempV31,$TN._tempV33),$TJM.subtract($TN._tempV33,$TN._tempV32,$Tt[1]),$TJM.subtract($TN._tempV31,$TN._tempV30,$TN._tempV33),$TJM.subtract($TN._tempV33,$TN._tempV30,$Tt[2]),$TJM.subtract($TN._tempV31,$TN._tempV30,$TN._tempV33),$TJM.add($TN._tempV33,$TN._tempV32,$Tt[3]),$TJM.subtract($TN._tempV30,$TN._tempV31,$TN._tempV33),$TJM.add($TN._tempV33,$TN._tempV32,$Tt[4]),$TJM.subtract($TN._tempV30,$TN._tempV31,$TN._tempV33),$TJM.subtract($TN._tempV33,$TN._tempV32,$Tt[5]),$TJM.scale($Tt[0],-1,$Tt[6]),$TJM.subtract($TN._tempV32,$TN._tempV30,$TN._tempV33),$TJM.subtract($TN._tempV33,$TN._tempV31,$Tt[7])},$Tt.equals=function($Tt){return this.extents==$Tt.extents&&this.transformation==$Tt.transformation},$Tt.cloneTo=function($Tt){var $TM=$Tt;this.extents.cloneTo($TM.extents),this.transformation.cloneTo($TM.transformation)},$TN.createByBoundBox=function($Tt,$TM){var $Tf=$Tt.min,$Tc=$Tt.max;$TJM.subtract($Tc,$Tf,$TN._tempV30),$TJM.scale($TN._tempV30,.5,$TN._tempV30),$TJM.add($Tf,$TN._tempV30,$TN._tempV31),$TJM.subtract($Tc,$TN._tempV31,$TN._tempV32),$TtM.translation($TN._tempV31,$TN._tempM0);var $TD=$TN._tempV32.clone(),$To=$TN._tempM0.clone();$TM.extents=$TD,$TM.transformation=$To},$TN.createByMinAndMaxVertex=function($Tt,$TM){return $TJM.subtract($TM,$Tt,$TN._tempV30),$TJM.scale($TN._tempV30,.5,$TN._tempV30),$TJM.add($Tt,$TN._tempV30,$TN._tempV31),$TJM.subtract($TM,$TN._tempV31,$TN._tempV32),$TtM.translation($TN._tempV31,$TN._tempM0),new $TN($TN._tempV32,$TN._tempM0)},$TN._getRows=function($Tt,$TM){$TM.length=3;var $Tf=$Tt.elements,$Tc=$TM[0].elements;$Tc[0]=$Tf[0],$Tc[1]=$Tf[1],$Tc[2]=$Tf[2];var $TD=$TM[1].elements;$TD[0]=$Tf[4],$TD[1]=$Tf[5],$TD[2]=$Tf[6];var $To=$TM[2].elements;$To[0]=$Tf[8],$To[1]=$Tf[9],$To[2]=$Tf[10]},$TN.getObbtoObbMatrix4x4=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.transformation,$To=$TM.transformation;if($Tf){$TN._getRows($TD,$TN._rows1),$TN._getRows($To,$TN._rows2);for(var $TJ=0;$TJ<3;$TJ++)for(var $TZ=0;$TZ<3;$TZ++)$Tc.setElementByRowColumn($TJ,$TZ,$TJM.dot($TN._rows2[$TJ],$TN._rows1[$TZ]));$TM.getCenter($TN._tempV30),$Tt.getCenter($TN._tempV31),$TJM.subtract($TN._tempV30,$TN._tempV31,$TN._tempV32);var $TA=$Tc.elements;$TA[12]=$TJM.dot($TN._tempV32,$TN._rows1[0]),$TA[13]=$TJM.dot($TN._tempV32,$TN._rows1[1]),$TA[14]=$TJM.dot($TN._tempV32,$TN._rows1[2]),$TA[15]=1}else $TD.invert($TN._tempM0),$TtM.multiply($To,$TN._tempM0,$Tc)},$TN.merge=function($Tt,$TM,$Tf){var $Tc=$Tt.extents,$TD=$Tt.transformation;$TN.getObbtoObbMatrix4x4($Tt,$TM,$Tf,$TN._tempM0),$TM._getLocalCorners($TN._corners),$TJM.transformCoordinate($TN._corners[0],$TN._tempM0,$TN._corners[0]),$TJM.transformCoordinate($TN._corners[1],$TN._tempM0,$TN._corners[1]),$TJM.transformCoordinate($TN._corners[2],$TN._tempM0,$TN._corners[2]),$TJM.transformCoordinate($TN._corners[3],$TN._tempM0,$TN._corners[3]),$TJM.transformCoordinate($TN._corners[4],$TN._tempM0,$TN._corners[4]),$TJM.transformCoordinate($TN._corners[5],$TN._tempM0,$TN._corners[5]),$TJM.transformCoordinate($TN._corners[6],$TN._tempM0,$TN._corners[6]),$TJM.transformCoordinate($TN._corners[7],$TN._tempM0,$TN._corners[7]),$TJM.scale($Tc,-1,$TN._boxBound1.min),$Tc.cloneTo($TN._boxBound1.max),$TGt.createfromPoints($TN._corners,$TN._boxBound2),$TGt.merge($TN._boxBound2,$TN._boxBound1,$TN._boxBound3);var $To=$TN._boxBound3.min,$TJ=$TN._boxBound3.max;$TJM.subtract($TJ,$To,$TN._tempV30),$TJM.scale($TN._tempV30,.5,$TN._tempV30),$TJM.add($To,$TN._tempV30,$TN._tempV32),$TJM.subtract($TJ,$TN._tempV32,$Tc),$TJM.transformCoordinate($TN._tempV32,$TD,$TN._tempV33)},$TB($TN,["_tempV30",function(){return this._tempV30=new $TJM},"_tempV31",function(){return this._tempV31=new $TJM},"_tempV32",function(){return this._tempV32=new $TJM},"_tempV33",function(){return this._tempV33=new $TJM},"_tempV34",function(){return this._tempV34=new $TJM},"_tempV35",function(){return this._tempV35=new $TJM},"_tempV36",function(){return this._tempV36=new $TJM},"_tempM0",function(){return this._tempM0=new $TtM},"_tempM1",function(){return this._tempM1=new $TtM},"_corners",function(){return this._corners=[new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM]},"_rows1",function(){return this._rows1=[new $TJM,new $TJM,new $TJM]},"_rows2",function(){return this._rows2=[new $TJM,new $TJM,new $TJM]},"_ray",function(){return this._ray=new $TDM(new $TJM,new $TJM)},"_boxBound1",function(){return this._boxBound1=new $TGt(new $TJM,new $TJM)},"_boxBound2",function(){return this._boxBound2=new $TGt(new $TJM,new $TJM)},"_boxBound3",function(){return this._boxBound3=new $TGt(new $TJM,new $TJM)}])}(),function(){function $Ty($Tt,$TM){this.normal=null,this.distance=NaN,void 0===$TM&&($TM=0),this.normal=$Tt,this.distance=$TM}return $TI($Ty,"laya.d3.math.Plane"),$Ty.prototype.normalize=function(){var $Tt=this.normal.elements,$TM=$Tt[0],$Tf=$Tt[1],$Tc=$Tt[2],$TD=1/Math.sqrt($TM*$TM+$Tf*$Tf+$Tc*$Tc);$Tt[0]=$TM*$TD,$Tt[1]=$Tf*$TD,$Tt[2]=$Tc*$TD,this.distance*=$TD},$Ty.createPlaneBy3P=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$TM.elements,$To=$Tf.elements,$TJ=$TD[0]-$Tc[0],$TZ=$TD[1]-$Tc[1],$TA=$TD[2]-$Tc[2],$TL=$To[0]-$Tc[0],$Tp=$To[1]-$Tc[1],$TB=$To[2]-$Tc[2],$Tb=$TZ*$TB-$TA*$Tp,$TI=$TA*$TL-$TJ*$TB,$Tq=$TJ*$Tp-$TZ*$TL,$Tl=1/Math.sqrt($Tb*$Tb+$TI*$TI+$Tq*$Tq),$T_=$Tb*$Tl,$TE=$TI*$Tl,$Te=$Tq*$Tl,$TN=$Ty._TEMPVec3.elements;$TN[0]=$T_,$TN[1]=$TE,$TN[2]=$Te;var $TX=-($T_*$Tc[0]+$TE*$Tc[1]+$Te*$Tc[2]);return new $Ty($Ty._TEMPVec3,$TX)},$Ty.PlaneIntersectionType_Back=0,$Ty.PlaneIntersectionType_Front=1,$Ty.PlaneIntersectionType_Intersecting=2,$TB($Ty,["_TEMPVec3",function(){return this._TEMPVec3=new $TJM}]),$Ty}()),$TfM=function(){function $TD($Tt,$TM,$Tf,$Tc){this.elements=new Float32Array(4),void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=1),this.elements[0]=$Tt,this.elements[1]=$TM,this.elements[2]=$Tf,this.elements[3]=$Tc}$TI($TD,"laya.d3.math.Quaternion");var $Tt=$TD.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.scaling=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements;$Tf[0]=$Tc[0]*$Tt,$Tf[1]=$Tc[1]*$Tt,$Tf[2]=$Tc[2]*$Tt,$Tf[3]=$Tc[3]*$Tt},$Tt.normalize=function($Tt){var $TM=$Tt.elements,$Tf=this.elements,$Tc=$Tf[0],$TD=$Tf[1],$To=$Tf[2],$TJ=$Tf[3],$TZ=$Tc*$Tc+$TD*$TD+$To*$To+$TJ*$TJ;0<$TZ&&($TZ=1/Math.sqrt($TZ),$TM[0]=$Tc*$TZ,$TM[1]=$TD*$TZ,$TM[2]=$To*$TZ,$TM[3]=$TJ*$TZ)},$Tt.length=function(){var $Tt=this.elements,$TM=$Tt[0],$Tf=$Tt[1],$Tc=$Tt[2],$TD=$Tt[3];return Math.sqrt($TM*$TM+$Tf*$Tf+$Tc*$Tc+$TD*$TD)},$Tt.rotateX=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements;$Tt*=.5;var $TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=Math.sin($Tt),$TL=Math.cos($Tt);$Tf[0]=$TD*$TL+$TZ*$TA,$Tf[1]=$To*$TL+$TJ*$TA,$Tf[2]=$TJ*$TL-$To*$TA,$Tf[3]=$TZ*$TL-$TD*$TA},$Tt.rotateY=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements;$Tt*=.5;var $TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=Math.sin($Tt),$TL=Math.cos($Tt);$Tf[0]=$TD*$TL-$TJ*$TA,$Tf[1]=$To*$TL+$TZ*$TA,$Tf[2]=$TJ*$TL+$TD*$TA,$Tf[3]=$TZ*$TL-$To*$TA},$Tt.rotateZ=function($Tt,$TM){var $Tf=$TM.elements,$Tc=this.elements;$Tt*=.5;var $TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=Math.sin($Tt),$TL=Math.cos($Tt);$Tf[0]=$TD*$TL+$To*$TA,$Tf[1]=$To*$TL-$TD*$TA,$Tf[2]=$TJ*$TL+$TZ*$TA,$Tf[3]=$TZ*$TL-$TJ*$TA},$Tt.getYawPitchRoll=function($Tt){$TJM.transformQuat($TJM.ForwardRH,this,$TD.TEMPVector31),$TJM.transformQuat($TJM.Up,this,$TD.TEMPVector32);var $TM=$TD.TEMPVector32.elements;$TD.angleTo($TJM.ZERO,$TD.TEMPVector31,$TD.TEMPVector33);var $Tf=$TD.TEMPVector33.elements;$Tf[0]==Math.PI/2?($Tf[1]=$TD.arcTanAngle($TM[2],$TM[0]),$Tf[2]=0):$Tf[0]==-Math.PI/2?($Tf[1]=$TD.arcTanAngle(-$TM[2],-$TM[0]),$Tf[2]=0):($TtM.createRotationY(-$Tf[1],$TD.TEMPMatrix0),$TtM.createRotationX(-$Tf[0],$TD.TEMPMatrix1),$TJM.transformCoordinate($TD.TEMPVector32,$TD.TEMPMatrix0,$TD.TEMPVector32),$TJM.transformCoordinate($TD.TEMPVector32,$TD.TEMPMatrix1,$TD.TEMPVector32),$Tf[2]=$TD.arcTanAngle($TM[1],-$TM[0])),$Tf[1]<=-Math.PI&&($Tf[1]=Math.PI),$Tf[2]<=-Math.PI&&($Tf[2]=Math.PI),$Tf[1]>=Math.PI&&$Tf[2]>=Math.PI&&($Tf[1]=0,$Tf[2]=0,$Tf[0]=Math.PI-$Tf[0]);var $Tc=$Tt.elements;$Tc[0]=$Tf[1],$Tc[1]=$Tf[0],$Tc[2]=$Tf[2]},$Tt.invert=function($Tt){var $TM=$Tt.elements,$Tf=this.elements,$Tc=$Tf[0],$TD=$Tf[1],$To=$Tf[2],$TJ=$Tf[3],$TZ=$Tc*$Tc+$TD*$TD+$To*$To+$TJ*$TJ,$TA=$TZ?1/$TZ:0;$TM[0]=-$Tc*$TA,$TM[1]=-$TD*$TA,$TM[2]=-$To*$TA,$TM[3]=$TJ*$TA},$Tt.identity=function(){var $Tt=this.elements;$Tt[0]=0,$Tt[1]=0,$Tt[2]=0,$Tt[3]=1},$Tt.fromArray=function($Tt,$TM){void 0===$TM&&($TM=0),this.elements[0]=$Tt[$TM+0],this.elements[1]=$Tt[$TM+1],this.elements[2]=$Tt[$TM+2],this.elements[3]=$Tt[$TM+3]},$Tt.cloneTo=function($Tt){var $TM,$Tf,$Tc;if(($Tf=this.elements)!==($Tc=$Tt.elements))for($TM=0;$TM<4;++$TM)$Tc[$TM]=$Tf[$TM]},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tt.equals=function($Tt){var $TM=this.elements,$Tf=$Tt.elements;return $Twt.nearEqual($TM[0],$Tf[0])&&$Twt.nearEqual($TM[1],$Tf[1])&&$Twt.nearEqual($TM[2],$Tf[2])&&$Twt.nearEqual($TM[3],$Tf[3])},$Tt.lengthSquared=function(){var $Tt=this.elements[0],$TM=this.elements[1],$Tf=this.elements[2],$Tc=this.elements[3];return $Tt*$Tt+$TM*$TM+$Tf*$Tf+$Tc*$Tc},$Tq(0,$Tt,"x",function(){return this.elements[0]}),$Tq(0,$Tt,"y",function(){return this.elements[1]}),$Tq(0,$Tt,"z",function(){return this.elements[2]}),$Tq(0,$Tt,"w",function(){return this.elements[3]}),$TD.createFromYawPitchRoll=function($Tt,$TM,$Tf,$Tc){var $TD=.5*$Tf,$To=.5*$TM,$TJ=.5*$Tt,$TZ=Math.sin($TD),$TA=Math.cos($TD),$TL=Math.sin($To),$Tp=Math.cos($To),$TB=Math.sin($TJ),$Tb=Math.cos($TJ),$TI=$Tc.elements;$TI[0]=$Tb*$TL*$TA+$TB*$Tp*$TZ,$TI[1]=$TB*$Tp*$TA-$Tb*$TL*$TZ,$TI[2]=$Tb*$Tp*$TZ-$TB*$TL*$TA,$TI[3]=$Tb*$Tp*$TA+$TB*$TL*$TZ},$TD.multiply=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$TM.elements,$To=$Tf.elements,$TJ=$Tc[0],$TZ=$Tc[1],$TA=$Tc[2],$TL=$Tc[3],$Tp=$TD[0],$TB=$TD[1],$Tb=$TD[2],$TI=$TD[3],$Tq=$TZ*$Tb-$TA*$TB,$Tl=$TA*$Tp-$TJ*$Tb,$T_=$TJ*$TB-$TZ*$Tp,$TE=$TJ*$Tp+$TZ*$TB+$TA*$Tb;$To[0]=$TJ*$TI+$Tp*$TL+$Tq,$To[1]=$TZ*$TI+$TB*$TL+$Tl,$To[2]=$TA*$TI+$Tb*$TL+$T_,$To[3]=$TL*$TI-$TE},$TD.arcTanAngle=function($Tt,$TM){return 0==$Tt?1==$TM?Math.PI/2:-Math.PI/2:0<$Tt?Math.atan($TM/$Tt):$Tt<0?0<$TM?Math.atan($TM/$Tt)+Math.PI:Math.atan($TM/$Tt)-Math.PI:0},$TD.angleTo=function($Tt,$TM,$Tf){$TJM.subtract($TM,$Tt,$TD.TEMPVector30),$TJM.normalize($TD.TEMPVector30,$TD.TEMPVector30),$Tf.elements[0]=Math.asin($TD.TEMPVector30.y),$Tf.elements[1]=$TD.arcTanAngle(-$TD.TEMPVector30.z,-$TD.TEMPVector30.x)},$TD.createFromAxisAngle=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements;$TM*=.5;var $To=Math.sin($TM);$Tc[0]=$To*$TD[0],$Tc[1]=$To*$TD[1],$Tc[2]=$To*$TD[2],$Tc[3]=Math.cos($TM)},$TD.createFromMatrix3x3=function($Tt,$TM){var $Tf,$Tc=$TM.elements,$TD=$Tt.elements,$To=$TD[0]+$TD[4]+$TD[8];if(0<$To)$Tf=Math.sqrt($To+1),$Tc[3]=.5*$Tf,$Tf=.5/$Tf,$Tc[0]=($TD[5]-$TD[7])*$Tf,$Tc[1]=($TD[6]-$TD[2])*$Tf,$Tc[2]=($TD[1]-$TD[3])*$Tf;else{var $TJ=0;$TD[4]>$TD[0]&&($TJ=1),$TD[8]>$TD[3*$TJ+$TJ]&&($TJ=2);var $TZ=($TJ+1)%3,$TA=($TJ+2)%3;$Tf=Math.sqrt($TD[3*$TJ+$TJ]-$TD[3*$TZ+$TZ]-$TD[3*$TA+$TA]+1),$Tc[$TJ]=.5*$Tf,$Tf=.5/$Tf,$Tc[3]=($TD[3*$TZ+$TA]-$TD[3*$TA+$TZ])*$Tf,$Tc[$TZ]=($TD[3*$TZ+$TJ]+$TD[3*$TJ+$TZ])*$Tf,$Tc[$TA]=($TD[3*$TA+$TJ]+$TD[3*$TJ+$TA])*$Tf}},$TD.createFromMatrix4x4=function($Tt,$TM){var $Tf,$Tc,$TD=$Tt.elements,$To=$TM.elements,$TJ=$TD[0]+$TD[5]+$TD[10];0<$TJ?($Tf=Math.sqrt($TJ+1),$To[3]=.5*$Tf,$Tf=.5/$Tf,$To[0]=($TD[6]-$TD[9])*$Tf,$To[1]=($TD[8]-$TD[2])*$Tf,$To[2]=($TD[1]-$TD[4])*$Tf):$TD[0]>=$TD[5]&&$TD[0]>=$TD[10]?($Tc=.5/($Tf=Math.sqrt(1+$TD[0]-$TD[5]-$TD[10])),$To[0]=.5*$Tf,$To[1]=($TD[1]+$TD[4])*$Tc,$To[2]=($TD[2]+$TD[8])*$Tc,$To[3]=($TD[6]-$TD[9])*$Tc):$TD[5]>$TD[10]?($Tc=.5/($Tf=Math.sqrt(1+$TD[5]-$TD[0]-$TD[10])),$To[0]=($TD[4]+$TD[1])*$Tc,$To[1]=.5*$Tf,$To[2]=($TD[9]+$TD[6])*$Tc,$To[3]=($TD[8]-$TD[2])*$Tc):($Tc=.5/($Tf=Math.sqrt(1+$TD[10]-$TD[0]-$TD[5])),$To[0]=($TD[8]+$TD[2])*$Tc,$To[1]=($TD[9]+$TD[6])*$Tc,$To[2]=.5*$Tf,$To[3]=($TD[1]-$TD[4])*$Tc)},$TD.slerp=function($Tt,$TM,$Tf,$Tc){var $TD,$To,$TJ,$TZ,$TA,$TL=$Tt.elements,$Tp=$TM.elements,$TB=$Tc.elements,$Tb=$TL[0],$TI=$TL[1],$Tq=$TL[2],$Tl=$TL[3],$T_=$Tp[0],$TE=$Tp[1],$Te=$Tp[2],$TN=$Tp[3];return($To=$Tb*$T_+$TI*$TE+$Tq*$Te+$Tl*$TN)<0&&($To=-$To,$T_=-$T_,$TE=-$TE,$Te=-$Te,$TN=-$TN),$TA=1e-6<1-$To?($TD=Math.acos($To),$TJ=Math.sin($TD),$TZ=Math.sin((1-$Tf)*$TD)/$TJ,Math.sin($Tf*$TD)/$TJ):($TZ=1-$Tf,$Tf),$TB[0]=$TZ*$Tb+$TA*$T_,$TB[1]=$TZ*$TI+$TA*$TE,$TB[2]=$TZ*$Tq+$TA*$Te,$TB[3]=$TZ*$Tl+$TA*$TN,$TB},$TD.lerp=function($Tt,$TM,$Tf,$Tc){var $TD=$Tc.elements,$To=$Tt.elements,$TJ=$TM.elements,$TZ=$To[0],$TA=$To[1],$TL=$To[2],$Tp=$To[3];$TD[0]=$TZ+$Tf*($TJ[0]-$TZ),$TD[1]=$TA+$Tf*($TJ[1]-$TA),$TD[2]=$TL+$Tf*($TJ[2]-$TL),$TD[3]=$Tp+$Tf*($TJ[3]-$Tp)},$TD.add=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]+$To[0],$Tc[1]=$TD[1]+$To[1],$Tc[2]=$TD[2]+$To[2],$Tc[3]=$TD[3]+$To[3]},$TD.dot=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;return $Tf[0]*$Tc[0]+$Tf[1]*$Tc[1]+$Tf[2]*$Tc[2]+$Tf[3]*$Tc[3]},$TD.rotationLookAt=function($Tt,$TM,$Tf){$TD.lookAt($TJM.ZERO,$Tt,$TM,$Tf)},$TD.lookAt=function($Tt,$TM,$Tf,$Tc){$TWt.lookAt($Tt,$TM,$Tf,$TD._tempMatrix3x3),$TD.rotationMatrix($TD._tempMatrix3x3,$Tc)},$TD.invert=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tt.lengthSquared();$Twt.isZero($TD)||($TD=1/$TD,$Tc[0]=-$Tf[0]*$TD,$Tc[1]=-$Tf[1]*$TD,$Tc[2]=-$Tf[2]*$TD,$Tc[3]=$Tf[3]*$TD)},$TD.rotationMatrix=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$Tf[0],$TD=$Tf[1],$To=$Tf[2],$TJ=$Tf[3],$TZ=$Tf[4],$TA=$Tf[5],$TL=$Tf[6],$Tp=$Tf[7],$TB=$Tf[8],$Tb=$TM.elements,$TI=NaN,$Tq=NaN,$Tl=$Tc+$TZ+$TB;0<$Tl?($TI=Math.sqrt($Tl+1),$Tb[3]=.5*$TI,$TI=.5/$TI,$Tb[0]=($TA-$Tp)*$TI,$Tb[1]=($TL-$To)*$TI,$Tb[2]=($TD-$TJ)*$TI):$TZ<=$Tc&&$TB<=$Tc?($Tq=.5/($TI=Math.sqrt(1+$Tc-$TZ-$TB)),$Tb[0]=.5*$TI,$Tb[1]=($TD+$TJ)*$Tq,$Tb[2]=($To+$TL)*$Tq,$Tb[3]=($TA-$Tp)*$Tq):$TB<$TZ?($Tq=.5/($TI=Math.sqrt(1+$TZ-$Tc-$TB)),$Tb[0]=($TJ+$TD)*$Tq,$Tb[1]=.5*$TI,$Tb[2]=($Tp+$TA)*$Tq,$Tb[3]=($TL-$To)*$Tq):($Tq=.5/($TI=Math.sqrt(1+$TB-$Tc-$TZ)),$Tb[0]=($TL+$To)*$Tq,$Tb[1]=($Tp+$TA)*$Tq,$Tb[2]=.5*$TI,$Tb[3]=($TD-$TJ)*$Tq)},$TD.DEFAULT=new $TD,$TB($TD,["TEMPVector30",function(){return this.TEMPVector30=new $TJM},"TEMPVector31",function(){return this.TEMPVector31=new $TJM},"TEMPVector32",function(){return this.TEMPVector32=new $TJM},"TEMPVector33",function(){return this.TEMPVector33=new $TJM},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $TtM},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $TtM},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $TWt},"NAN",function(){return this.NAN=new $TD(NaN,NaN,NaN,NaN)}]),$TD}(),$TcM=function(){function $Tt($Tt){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$Tt,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$TI($Tt,"laya.d3.math.Rand");var $TM=$Tt.prototype;return $TM.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$TM.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$TM.getSignedFloat=function(){return 2*this.getFloat()-1},$Tq(0,$TM,"seed",function(){return this.seeds[0]},function($Tt){this.seeds[0]=$Tt,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$Tt.getFloatFromInt=function($Tt){return 1/8388607*(8388607&$Tt)},$Tt.getByteFromInt=function($Tt){return(8388607&$Tt)>>>15},$Tt}(),$TDM=(function(){function $TD($Tt){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($Tt instanceof Array)||4!==$Tt.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$Tt[0],this._state0L=0|$Tt[1],this._state1U=0|$Tt[2],this._state1L=0|$Tt[3]}$TI($TD,"laya.d3.math.RandX");var $Tt=$TD.prototype;$Tt.randomint=function(){var $Tt=this._state0U,$TM=this._state0L,$Tf=this._state1U,$Tc=this._state1L,$TD=($Tc>>>0)+($TM>>>0),$To=$Tf+$Tt+($TD/2>>>31)>>>0,$TJ=$TD>>>0,$TZ=0,$TA=0;$TZ=($Tt^=$TZ=$Tt<<23|(-512&$TM)>>>9)^(this._state0U=$Tf),$TA=($TM^=$TA=$TM<<23)^(this._state0L=$Tc);$TZ^=$Tt>>>18,$TA^=$TM>>>18|(262143&$Tt)<<14;return $TZ^=$Tf>>>5,$TA^=$Tc>>>5|(31&$Tf)<<27,this._state1U=$TZ,this._state1L=$TA,[$To,$TJ]},$Tt.random=function(){var $Tt=this.randomint(),$TM=$Tt[0],$Tf=1023<<20|$TM>>>12,$Tc=0|($Tt[1]>>>12|(4095&$TM)<<20);return $TD._CONVERTION_BUFFER.setUint32(0,$Tf,!1),$TD._CONVERTION_BUFFER.setUint32(4,$Tc,!1),$TcM._CONVERTION_BUFFER.getFloat64(0,!1)-1},$TB($TD,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $TcM([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $Tt($Tt,$TM){this.origin=null,this.direction=null,this.origin=$Tt,this.direction=$TM}return $TI($Tt,"laya.d3.math.Ray"),$Tt}()),$ToM=function(){function $Tt($Tt,$TM){this.elements=new Float32Array(2),void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0);var $Tf=this.elements;$Tf[0]=$Tt,$Tf[1]=$TM}$TI($Tt,"laya.d3.math.Vector2");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.fromArray=function($Tt,$TM){void 0===$TM&&($TM=0),this.elements[0]=$Tt[$TM+0],this.elements[1]=$Tt[$TM+1]},$TM.cloneTo=function($Tt){var $TM=$Tt.elements,$Tf=this.elements;$TM[0]=$Tf[0],$TM[1]=$Tf[1]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"x",function(){return this.elements[0]},function($Tt){this.elements[0]=$Tt}),$Tq(0,$TM,"y",function(){return this.elements[1]},function($Tt){this.elements[1]=$Tt}),$Tt.scale=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements;$Tc[0]=$TD[0]*$TM,$Tc[1]=$TD[1]*$TM},$TB($Tt,["ZERO",function(){return this.ZERO=new $Tt(0,0)},"ONE",function(){return this.ONE=new $Tt(1,1)}]),$Tt}(),$TJM=function(){function $Tp($Tt,$TM,$Tf){this.elements=new Float32Array(3),void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0);var $Tc=this.elements;$Tc[0]=$Tt,$Tc[1]=$TM,$Tc[2]=$Tf}$TI($Tp,"laya.d3.math.Vector3");var $Tt=$Tp.prototype;return $Ty.imps($Tt,{"laya.d3.core.IClone":!0}),$Tt.fromArray=function($Tt,$TM){void 0===$TM&&($TM=0),this.elements[0]=$Tt[$TM+0],this.elements[1]=$Tt[$TM+1],this.elements[2]=$Tt[$TM+2]},$Tt.cloneTo=function($Tt){var $TM=$Tt.elements,$Tf=this.elements;$TM[0]=$Tf[0],$TM[1]=$Tf[1],$TM[2]=$Tf[2]},$Tt.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tt.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$Tt.reset=function($Tt,$TM,$Tf){this.elements[0]=$Tt,this.elements[1]=$TM,this.elements[2]=$Tf},$Tq(0,$Tt,"x",function(){return this.elements[0]},function($Tt){this.elements[0]=$Tt}),$Tq(0,$Tt,"y",function(){return this.elements[1]},function($Tt){this.elements[1]=$Tt}),$Tq(0,$Tt,"z",function(){return this.elements[2]},function($Tt){this.elements[2]=$Tt}),$Tp.distanceSquared=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0]-$Tc[0],$To=$Tf[1]-$Tc[1],$TJ=$Tf[2]-$Tc[2];return $TD*$TD+$To*$To+$TJ*$TJ},$Tp.distance=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0]-$Tc[0],$To=$Tf[1]-$Tc[1],$TJ=$Tf[2]-$Tc[2];return Math.sqrt($TD*$TD+$To*$To+$TJ*$TJ)},$Tp.min=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=Math.min($TD[0],$To[0]),$Tc[1]=Math.min($TD[1],$To[1]),$Tc[2]=Math.min($TD[2],$To[2])},$Tp.max=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=Math.max($TD[0],$To[0]),$Tc[1]=Math.max($TD[1],$To[1]),$Tc[2]=Math.max($TD[2],$To[2])},$Tp.transformQuat=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements,$TJ=$TD[0],$TZ=$TD[1],$TA=$TD[2],$TL=$To[0],$Tp=$To[1],$TB=$To[2],$Tb=$To[3],$TI=$Tb*$TJ+$Tp*$TA-$TB*$TZ,$Tq=$Tb*$TZ+$TB*$TJ-$TL*$TA,$Tl=$Tb*$TA+$TL*$TZ-$Tp*$TJ,$T_=-$TL*$TJ-$Tp*$TZ-$TB*$TA;$Tc[0]=$TI*$Tb+$T_*-$TL+$Tq*-$TB-$Tl*-$Tp,$Tc[1]=$Tq*$Tb+$T_*-$Tp+$Tl*-$TL-$TI*-$TB,$Tc[2]=$Tl*$Tb+$T_*-$TB+$TI*-$Tp-$Tq*-$TL},$Tp.scalarLength=function($Tt){var $TM=$Tt.elements,$Tf=$TM[0],$Tc=$TM[1],$TD=$TM[2];return Math.sqrt($Tf*$Tf+$Tc*$Tc+$TD*$TD)},$Tp.scalarLengthSquared=function($Tt){var $TM=$Tt.elements,$Tf=$TM[0],$Tc=$TM[1],$TD=$TM[2];return $Tf*$Tf+$Tc*$Tc+$TD*$TD},$Tp.normalize=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0],$To=$Tf[1],$TJ=$Tf[2],$TZ=$TD*$TD+$To*$To+$TJ*$TJ;0<$TZ&&($TZ=1/Math.sqrt($TZ),$Tc[0]=$Tf[0]*$TZ,$Tc[1]=$Tf[1]*$TZ,$Tc[2]=$Tf[2]*$TZ)},$Tp.multiply=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]*$To[0],$Tc[1]=$TD[1]*$To[1],$Tc[2]=$TD[2]*$To[2]},$Tp.scale=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements;$Tc[0]=$TD[0]*$TM,$Tc[1]=$TD[1]*$TM,$Tc[2]=$TD[2]*$TM},$Tp.lerp=function($Tt,$TM,$Tf,$Tc){var $TD=$Tc.elements,$To=$Tt.elements,$TJ=$TM.elements,$TZ=$To[0],$TA=$To[1],$TL=$To[2];$TD[0]=$TZ+$Tf*($TJ[0]-$TZ),$TD[1]=$TA+$Tf*($TJ[1]-$TA),$TD[2]=$TL+$Tf*($TJ[2]-$TL)},$Tp.transformV3ToV3=function($Tt,$TM,$Tf){var $Tc=$Tp._tempVector4;$Tp.transformV3ToV4($Tt,$TM,$Tc);var $TD=$Tc.elements,$To=$Tf.elements;$To[0]=$TD[0],$To[1]=$TD[1],$To[2]=$TD[2]},$Tp.transformV3ToV4=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$TM.elements,$TA=$Tf.elements;$TA[0]=$TD*$TZ[0]+$To*$TZ[4]+$TJ*$TZ[8]+$TZ[12],$TA[1]=$TD*$TZ[1]+$To*$TZ[5]+$TJ*$TZ[9]+$TZ[13],$TA[2]=$TD*$TZ[2]+$To*$TZ[6]+$TJ*$TZ[10]+$TZ[14],$TA[3]=$TD*$TZ[3]+$To*$TZ[7]+$TJ*$TZ[11]+$TZ[15]},$Tp.TransformNormal=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$TM.elements,$TA=$Tf.elements;$TA[0]=$TD*$TZ[0]+$To*$TZ[4]+$TJ*$TZ[8],$TA[1]=$TD*$TZ[1]+$To*$TZ[5]+$TJ*$TZ[9],$TA[2]=$TD*$TZ[2]+$To*$TZ[6]+$TJ*$TZ[10]},$Tp.transformCoordinate=function($Tt,$TM,$Tf){var $Tc=$Tp._tempVector4.elements,$TD=$Tt.elements,$To=$TD[0],$TJ=$TD[1],$TZ=$TD[2],$TA=$TM.elements;$Tc[0]=$To*$TA[0]+$TJ*$TA[4]+$TZ*$TA[8]+$TA[12],$Tc[1]=$To*$TA[1]+$TJ*$TA[5]+$TZ*$TA[9]+$TA[13],$Tc[2]=$To*$TA[2]+$TJ*$TA[6]+$TZ*$TA[10]+$TA[14],$Tc[3]=1/($To*$TA[3]+$TJ*$TA[7]+$TZ*$TA[11]+$TA[15]);var $TL=$Tf.elements;$TL[0]=$Tc[0]*$Tc[3],$TL[1]=$Tc[1]*$Tc[3],$TL[2]=$Tc[2]*$Tc[3]},$Tp.Clamp=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements,$To=$TD[0],$TJ=$TD[1],$TZ=$TD[2],$TA=$TM.elements,$TL=$TA[0],$Tp=$TA[1],$TB=$TA[2],$Tb=$Tf.elements,$TI=$Tb[0],$Tq=$Tb[1],$Tl=$Tb[2],$T_=$Tc.elements;$To=($To=$TI<$To?$TI:$To)<$TL?$TL:$To,$TJ=($TJ=$Tq<$TJ?$Tq:$TJ)<$Tp?$Tp:$TJ,$TZ=($TZ=$Tl<$TZ?$Tl:$TZ)<$TB?$TB:$TZ,$T_[0]=$To,$T_[1]=$TJ,$T_[2]=$TZ},$Tp.add=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]+$To[0],$Tc[1]=$TD[1]+$To[1],$Tc[2]=$TD[2]+$To[2]},$Tp.subtract=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]-$To[0],$Tc[1]=$TD[1]-$To[1],$Tc[2]=$TD[2]-$To[2]},$Tp.cross=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$TM.elements,$To=$Tf.elements,$TJ=$Tc[0],$TZ=$Tc[1],$TA=$Tc[2],$TL=$TD[0],$Tp=$TD[1],$TB=$TD[2];$To[0]=$TZ*$TB-$TA*$Tp,$To[1]=$TA*$TL-$TJ*$TB,$To[2]=$TJ*$Tp-$TZ*$TL},$Tp.dot=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;return $Tf[0]*$Tc[0]+$Tf[1]*$Tc[1]+$Tf[2]*$Tc[2]},$Tp.equals=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;return $Twt.nearEqual(Math.abs($Tf[0]),Math.abs($Tc[0]))&&$Twt.nearEqual(Math.abs($Tf[1]),Math.abs($Tc[1]))&&$Twt.nearEqual(Math.abs($Tf[2]),Math.abs($Tc[2]))},$Tp.ZERO=new $Tp(0,0,0),$Tp.ONE=new $Tp(1,1,1),$Tp.NegativeUnitX=new $Tp(-1,0,0),$Tp.UnitX=new $Tp(1,0,0),$Tp.UnitY=new $Tp(0,1,0),$Tp.UnitZ=new $Tp(0,0,1),$Tp.ForwardRH=new $Tp(0,0,-1),$Tp.ForwardLH=new $Tp(0,0,1),$Tp.Up=new $Tp(0,1,0),$Tp.NAN=new $Tp(NaN,NaN,NaN),$TB($Tp,["_tempVector4",function(){return this._tempVector4=new $TZM}]),$Tp}(),$TZM=function(){function $Tt($Tt,$TM,$Tf,$Tc){this.elements=new Float32Array(4),void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=0);var $TD=this.elements;$TD[0]=$Tt,$TD[1]=$TM,$TD[2]=$Tf,$TD[3]=$Tc}$TI($Tt,"laya.d3.math.Vector4");var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM.fromArray=function($Tt,$TM){void 0===$TM&&($TM=0),this.elements[0]=$Tt[$TM+0],this.elements[1]=$Tt[$TM+1],this.elements[2]=$Tt[$TM+2],this.elements[3]=$Tt[$TM+3]},$TM.cloneTo=function($Tt){var $TM=$Tt.elements,$Tf=this.elements;$TM[0]=$Tf[0],$TM[1]=$Tf[1],$TM[2]=$Tf[2],$TM[3]=$Tf[3]},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$TM.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$TM.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$Tq(0,$TM,"x",function(){return this.elements[0]},function($Tt){this.elements[0]=$Tt}),$Tq(0,$TM,"y",function(){return this.elements[1]},function($Tt){this.elements[1]=$Tt}),$Tq(0,$TM,"z",function(){return this.elements[2]},function($Tt){this.elements[2]=$Tt}),$Tq(0,$TM,"w",function(){return this.elements[3]},function($Tt){this.elements[3]=$Tt}),$Tt.lerp=function($Tt,$TM,$Tf,$Tc){var $TD=$Tc.elements,$To=$Tt.elements,$TJ=$TM.elements,$TZ=$To[0],$TA=$To[1],$TL=$To[2],$Tp=$To[3];$TD[0]=$TZ+$Tf*($TJ[0]-$TZ),$TD[1]=$TA+$Tf*($TJ[1]-$TA),$TD[2]=$TL+$Tf*($TJ[2]-$TL),$TD[3]=$Tp+$Tf*($TJ[3]-$Tp)},$Tt.transformByM4x4=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$Tc[0],$To=$Tc[1],$TJ=$Tc[2],$TZ=$Tc[3],$TA=$TM.elements,$TL=$Tf.elements;$TL[0]=$TD*$TA[0]+$To*$TA[4]+$TJ*$TA[8]+$TZ*$TA[12],$TL[1]=$TD*$TA[1]+$To*$TA[5]+$TJ*$TA[9]+$TZ*$TA[13],$TL[2]=$TD*$TA[2]+$To*$TA[6]+$TJ*$TA[10]+$TZ*$TA[14],$TL[3]=$TD*$TA[3]+$To*$TA[7]+$TJ*$TA[11]+$TZ*$TA[15]},$Tt.equals=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;return $Twt.nearEqual(Math.abs($Tf[0]),Math.abs($Tc[0]))&&$Twt.nearEqual(Math.abs($Tf[1]),Math.abs($Tc[1]))&&$Twt.nearEqual(Math.abs($Tf[2]),Math.abs($Tc[2]))&&$Twt.nearEqual(Math.abs($Tf[3]),Math.abs($Tc[3]))},$Tt.normalize=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tt.length();0<$TD&&($Tc[0]=$Tf[0]*$TD,$Tc[1]=$Tf[1]*$TD,$Tc[2]=$Tf[2]*$TD,$Tc[3]=$Tf[3]*$TD)},$Tt.add=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]+$To[0],$Tc[1]=$TD[1]+$To[1],$Tc[2]=$TD[2]+$To[2],$Tc[3]=$TD[3]+$To[3]},$Tt.subtract=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]-$To[0],$Tc[1]=$TD[1]-$To[1],$Tc[2]=$TD[2]-$To[2],$Tc[3]=$TD[3]-$To[3]},$Tt.multiply=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=$TD[0]*$To[0],$Tc[1]=$TD[1]*$To[1],$Tc[2]=$TD[2]*$To[2],$Tc[3]=$TD[3]*$To[3]},$Tt.scale=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements;$Tc[0]=$TD[0]*$TM,$Tc[1]=$TD[1]*$TM,$Tc[2]=$TD[2]*$TM,$Tc[3]=$TD[3]*$TM},$Tt.Clamp=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements,$To=$TD[0],$TJ=$TD[1],$TZ=$TD[2],$TA=$TD[3],$TL=$TM.elements,$Tp=$TL[0],$TB=$TL[1],$Tb=$TL[2],$TI=$TL[3],$Tq=$Tf.elements,$Tl=$Tq[0],$T_=$Tq[1],$TE=$Tq[2],$Te=$Tq[3],$TN=$Tc.elements;$To=($To=$Tl<$To?$Tl:$To)<$Tp?$Tp:$To,$TJ=($TJ=$T_<$TJ?$T_:$TJ)<$TB?$TB:$TJ,$TZ=($TZ=$TE<$TZ?$TE:$TZ)<$Tb?$Tb:$TZ,$TA=($TA=$Te<$TA?$Te:$TA)<$TI?$TI:$TA,$TN[0]=$To,$TN[1]=$TJ,$TN[2]=$TZ,$TN[3]=$TA},$Tt.distanceSquared=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0]-$Tc[0],$To=$Tf[1]-$Tc[1],$TJ=$Tf[2]-$Tc[2],$TZ=$Tf[3]-$Tc[3];return $TD*$TD+$To*$To+$TJ*$TJ+$TZ*$TZ},$Tt.distance=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements,$TD=$Tf[0]-$Tc[0],$To=$Tf[1]-$Tc[1],$TJ=$Tf[2]-$Tc[2],$TZ=$Tf[3]-$Tc[3];return Math.sqrt($TD*$TD+$To*$To+$TJ*$TJ+$TZ*$TZ)},$Tt.dot=function($Tt,$TM){var $Tf=$Tt.elements,$Tc=$TM.elements;return $Tf[0]*$Tc[0]+$Tf[1]*$Tc[1]+$Tf[2]*$Tc[2]+$Tf[3]*$Tc[3]},$Tt.min=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=Math.min($TD[0],$To[0]),$Tc[1]=Math.min($TD[1],$To[1]),$Tc[2]=Math.min($TD[2],$To[2]),$Tc[3]=Math.min($TD[3],$To[3])},$Tt.max=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM.elements;$Tc[0]=Math.max($TD[0],$To[0]),$Tc[1]=Math.max($TD[1],$To[1]),$Tc[2]=Math.max($TD[2],$To[2]),$Tc[3]=Math.max($TD[3],$To[3])},$TB($Tt,["ZERO",function(){return this.ZERO=new $Tt},"ONE",function(){return this.ONE=new $Tt(1,1,1,1)},"UnitX",function(){return this.UnitX=new $Tt(1,0,0,0)},"UnitY",function(){return this.UnitY=new $Tt(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $Tt(0,0,1,0)},"UnitW",function(){return this.UnitW=new $Tt(0,0,0,1)}]),$Tt}(),$TAM=function(){function $To($Tt,$TM,$Tf,$Tc){this.minDepth=0,this.maxDepth=1,this.x=$Tt,this.y=$TM,this.width=$Tf,this.height=$Tc}$TI($To,"laya.d3.math.Viewport");var $Tt=$To.prototype;return $Tt.project=function($Tt,$TM,$Tf){$TJM.transformV3ToV3($Tt,$TM,$Tf);var $Tc=$Tt.elements,$TD=$TM.elements,$To=$Tf.elements,$TJ=$Tc[0]*$TD[3]+$Tc[1]*$TD[7]+$Tc[2]*$TD[11]+$TD[15];1!==$TJ&&($To[0]=$To[0]/$TJ,$To[1]=$To[1]/$TJ,$To[2]=$To[2]/$TJ),$To[0]=.5*($To[0]+1)*this.width+this.x,$To[1]=.5*(1-$To[1])*this.height+this.y,$To[2]=$To[2]*(this.maxDepth-this.minDepth)+this.minDepth},$Tt.unprojectFromMat=function($Tt,$TM,$Tf){var $Tc=$Tt.elements,$TD=$TM.elements,$To=$Tf.elements;$To[0]=($Tc[0]-this.x)/this.width*2-1,$To[1]=-(($Tc[1]-this.y)/this.height*2-1);var $TJ=(this.maxDepth-this.minDepth)/2;$To[2]=($Tc[2]-this.minDepth-$TJ)/$TJ;var $TZ=$To[0]*$TD[3]+$To[1]*$TD[7]+$To[2]*$TD[11]+$TD[15];$TJM.transformV3ToV3($Tf,$TM,$Tf),1!==$TZ&&($To[0]=$To[0]/$TZ,$To[1]=$To[1]/$TZ,$To[2]=$To[2]/$TZ)},$Tt.unprojectFromWVP=function($Tt,$TM,$Tf,$Tc,$TD){$TtM.multiply($TM,$Tf,$To._tempMatrix4x4),$Tc&&$TtM.multiply($To._tempMatrix4x4,$Tc,$To._tempMatrix4x4),$To._tempMatrix4x4.invert($To._tempMatrix4x4),this.unprojectFromMat($Tt,$To._tempMatrix4x4,$TD)},$TB($To,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $TtM}]),$To}(),$TLM=function(){function $TC($Tt){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$Tt,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$TI($TC,"laya.d3.resource.models.SubMesh");var $Tt=$TC.prototype;return $Ty.imps($Tt,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$Tt._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),0===$Tt?this._vertexBuffer:null},$Tt._getIndexBuffer=function(){return this._indexBuffer},$Tt._getStaticBatchBakedVertexs=function($Tt,$TM){var $Tf,$Tc,$TD=this._vertexBuffer,$To=$TD.vertexDeclaration,$TJ=$To.getVertexElementByUsage(0).offset/4,$TZ=$To.getVertexElementByUsage(3).offset/4,$TA=$TM.meshRender.lightmapScaleOffset,$TL=0,$Tp=0,$TB=0,$Tb=0,$TI=0,$Tq=0;if($TA)if($Tc=$To.getVertexElementByUsage(15))$TB=$To.vertexStride/4,$Tf=0<this._vertexCount?$TD.getData().slice(this._vertexStart*$TB,(this._vertexStart+this._vertexCount)*$TB):$TD.getData().slice(),$Tb=$Tc.offset/4;else{$TB=($Tq=$To.vertexStride/4)+2,$Tf=this._vertexCount?new Float32Array(this._vertexCount*($TD.vertexDeclaration.vertexStride/4+2)):new Float32Array($TD.vertexCount*($TD.vertexDeclaration.vertexStride/4+2)),$Tb=($TI=$To.getVertexElementByUsage(2).offset/4)+2;var $Tl=$TD.getData();for($TL=0,$Tp=$Tl.length/$Tq;$TL<$Tp;$TL++){var $T_=0;$T_=0<this._vertexCount?(this._vertexStart+$TL)*$Tq:$TL*$Tq;var $TE=$TL*$TB,$Te=0;for($Te=0;$Te<$Tb;$Te++)$Tf[$TE+$Te]=$Tl[$T_+$Te];for($Te=$Tb;$Te<$Tq;$Te++)$Tf[$TE+$Te+2]=$Tl[$T_+$Te]}}else $TB=$To.vertexStride/4,$Tf=this._vertexCount?$TD.getData().slice(this._vertexStart*$TB,(this._vertexStart+this._vertexCount)*$TB):$TD.getData().slice();if($Tt){var $TN=$Tt.worldMatrix,$TX=$TC._tempMatrix4x40;$TN.invert($TX);var $Ty=$TC._tempMatrix4x41,$Th=$TM.transform.worldMatrix;$TtM.multiply($TX,$Th,$Ty)}else $Ty=$TM.transform.worldMatrix;var $TT=$TC._tempQuaternion0;for($Ty.decomposeTransRotScale($TC._tempVector30,$TT,$TC._tempVector31),$TL=0,$Tp=$Tf.length/$TB;$TL<$Tp;$TL++){var $Ti=$TL*$TB+$TJ,$TV=$TL*$TB+$TZ;if($T_M.transformVector3ArrayToVector3ArrayCoordinate($Tf,$Ti,$Ty,$Tf,$Ti),$T_M.transformVector3ArrayByQuat($Tf,$TV,$TT,$Tf,$TV),$TA){var $Tx=$TL*$TB+$Tb;if($Tc)$T_M.transformLightingMapTexcoordByUV1Array($Tf,$Tx,$TA,$Tf,$Tx);else{var $TO=$TL*$Tq+$TI;$T_M.transformLightingMapTexcoordByUV0Array($Tl,$TO,$TA,$Tf,$Tx)}}}return $Tf},$Tt._getVertexBuffers=function(){return null},$Tt._beforeRender=function($Tt){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Tt._render=function($Tt){var $TM,$Tf=0,$Tc=$Tt.renderElement;if(1<this._indexCount){var $TD=this._boneIndicesList.length;if(1<$TD){for(var $To=0;$To<$TD;$To++)($TM=$Tc._skinAnimationDatas||this._skinAnimationDatas)&&($Tc._shaderValue.setValue(0,$TM[$To]),$Tt._shader.uploadRenderElementUniforms($Tc._shaderValue.data)),$TU.mainContext.drawElements(4,this._subIndexBufferCount[$To],5123,2*this._subIndexBufferStart[$To]);$Ti.drawCall+=$TD}else($TM=$Tc._skinAnimationDatas||this._skinAnimationDatas)&&($Tc._shaderValue.setValue(0,$TM[0]),$Tt._shader.uploadRenderElementUniforms($Tc._shaderValue.data)),$TU.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$Ti.drawCall++;$Tf=this._indexCount}else $Tf=this._indexBuffer.indexCount,($TM=$Tc._skinAnimationDatas||this._skinAnimationDatas)&&($Tc._shaderValue.setValue(0,$TM[0]),$Tt._shader.uploadRenderElementUniforms($Tc._shaderValue.data)),$TU.mainContext.drawElements(4,$Tf,5123,0),$Ti.drawCall++;$Ti.trianglesFaces+=$Tf/3},$Tt.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$Tt.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$Tq(0,$Tt,"_vertexBufferCount",function(){return 1}),$Tq(0,$Tt,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$TB($TC,["_tempVector30",function(){return this._tempVector30=new $TJM},"_tempVector31",function(){return this._tempVector31=new $TJM},"_tempQuaternion0",function(){return this._tempQuaternion0=new $TfM},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $TtM},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $TtM}]),$TC}(),$TpM=function(){function $Tt($Tt){this.defineCounter=0,this.defines=null,$Tt?(this.defineCounter=$Tt.defineCounter,this.defines=$Tt.defines.slice()):(this.defineCounter=0,this.defines=[])}return $TI($Tt,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$Tt.prototype.registerDefine=function($Tt){var $TM=Math.pow(2,this.defineCounter++);return this.defines[$TM]=$Tt,$TM},$Tt}(),$TBM=function(){function $Tt(){}return $TI($Tt,"laya.d3.shader.ShaderInit3D"),$Tt.__init__=function(){var $Tt,$TM;$TiM._globalRegDefine("HIGHPRECISION",$TiM.SHADERDEFINE_HIGHPRECISION),$TiM._globalRegDefine("FOG",$TiM.SHADERDEFINE_FOG),$TiM._globalRegDefine("DIRECTIONLIGHT",$TiM.SHADERDEFINE_DIRECTIONLIGHT),$TiM._globalRegDefine("POINTLIGHT",$TiM.SHADERDEFINE_POINTLIGHT),$TiM._globalRegDefine("SPOTLIGHT",$TiM.SHADERDEFINE_SPOTLIGHT),$TiM._globalRegDefine("UV",$TiM.SHADERDEFINE_UV0),$TiM._globalRegDefine("COLOR",$TiM.SHADERDEFINE_COLOR),$TiM._globalRegDefine("UV1",$TiM.SHADERDEFINE_UV1),$TiM._globalRegDefine("CASTSHADOW",$TIM.SHADERDEFINE_CAST_SHADOW),$TiM._globalRegDefine("SHADOWMAP_PSSM1",$TIM.SHADERDEFINE_SHADOW_PSSM1),$TiM._globalRegDefine("SHADOWMAP_PSSM2",$TIM.SHADERDEFINE_SHADOW_PSSM2),$TiM._globalRegDefine("SHADOWMAP_PSSM3",$TIM.SHADERDEFINE_SHADOW_PSSM3),$TiM._globalRegDefine("SHADOWMAP_PCF_NO",$TIM.SHADERDEFINE_SHADOW_PCF_NO),$TiM._globalRegDefine("SHADOWMAP_PCF1",$TIM.SHADERDEFINE_SHADOW_PCF1),$TiM._globalRegDefine("SHADOWMAP_PCF2",$TIM.SHADERDEFINE_SHADOW_PCF2),$TiM._globalRegDefine("SHADOWMAP_PCF3",$TIM.SHADERDEFINE_SHADOW_PCF3),$TiM._globalRegDefine("DEPTHFOG",$TiM.SAHDERDEFINE_DEPTHFOG),$TuM.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$TuM.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$Tt={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$TM={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $Tf=$TuM.nameKey.add("SIMPLE");shaderCompile=$TiM.add($Tf,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$Tt,$TM),$TvM.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$TvM.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$TvM.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$TvM.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$TvM.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$TvM.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$TvM.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$TvM.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$TvM.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$Tt}(),$TbM=function(){function $Tt(){this._data=null,this._data=[]}$TI($Tt,"laya.d3.shader.ValusArray");var $TM=$Tt.prototype;return $TM.setValue=function($Tt,$TM){this._data[$Tt]=$TM},$Tq(0,$TM,"data",function(){return this._data}),$Tt}(),$TIM=function(){function $Tt(){}return $Tt.SHADERDEFINE_RECEIVE_SHADOW=1,$Tt.SHADERDEFINE_CAST_SHADOW=512,$Tt.SHADERDEFINE_SHADOW_PSSM1=1024,$Tt.SHADERDEFINE_SHADOW_PSSM2=2048,$Tt.SHADERDEFINE_SHADOW_PSSM3=4096,$Tt.SHADERDEFINE_SHADOW_PCF_NO=8192,$Tt.SHADERDEFINE_SHADOW_PCF1=16384,$Tt.SHADERDEFINE_SHADOW_PCF2=32768,$Tt.SHADERDEFINE_SHADOW_PCF3=65536,$Tt.MAX_PSSM_COUNT=3,$Tt}(),$TqM=function(){function $Tz(){}return $TI($Tz,"laya.d3.utils.Picker"),$Tz.calculateCursorRay=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$Tt.elements[0],$TZ=$Tt.elements[1],$TA=$Tz._tempVector30,$TL=$TA.elements;$TL[0]=$TJ,$TL[1]=$TZ,$TL[2]=$TM.minDepth;var $Tp=$Tz._tempVector31,$TB=$Tp.elements;$TB[0]=$TJ,$TB[1]=$TZ,$TB[2]=$TM.maxDepth;var $Tb=$To.origin,$TI=$Tz._tempVector32;$TM.unprojectFromWVP($TA,$Tf,$Tc,$TD,$Tb),$TM.unprojectFromWVP($Tp,$Tf,$Tc,$TD,$TI);var $Tq=$To.direction.elements;$Tq[0]=$TI.x-$Tb.x,$Tq[1]=$TI.y-$Tb.y,$Tq[2]=$TI.z-$Tb.z,$TJM.normalize($To.direction,$To.direction)},$Tz.rayIntersectsPositionsAndIndices=function($Tt,$TM,$Tf,$Tc,$TD){for(var $To=$Tf.vertexStride/4,$TJ=$Tf.getVertexElementByUsage(0).offset/4,$TZ=Number.MAX_VALUE,$TA=-1,$TL=-1,$Tp=-1,$TB=0;$TB<$Tc.length;$TB+=3){var $Tb=$Tz._tempVector35,$TI=$Tb.elements,$Tq=$Tc[$TB]*$To,$Tl=$Tq+$TJ;$TI[0]=$TM[$Tl],$TI[1]=$TM[1+$Tl],$TI[2]=$TM[2+$Tl];var $T_=$Tz._tempVector36,$TE=$T_.elements,$Te=$Tc[$TB+1]*$To,$TN=$Te+$TJ;$TE[0]=$TM[$TN],$TE[1]=$TM[1+$TN],$TE[2]=$TM[2+$TN];var $TX=$Tz._tempVector37,$Ty=$TX.elements,$Th=$Tc[$TB+2]*$To,$TT=$Th+$TJ;$Ty[0]=$TM[$TT],$Ty[1]=$TM[1+$TT],$Ty[2]=$TM[2+$TT];var $Ti=laya.d3.utils.Picker.rayIntersectsTriangle($Tt,$Tb,$T_,$TX);!isNaN($Ti)&&$Ti<$TZ&&($TZ=$Ti,$TA=$Tq,$TL=$Te,$Tp=$Th)}if($TZ===Number.MAX_VALUE)return $TD.position.toDefault(),$TD.distance=Number.MAX_VALUE,$TD.trianglePositions[0].toDefault(),$TD.trianglePositions[1].toDefault(),$TD.trianglePositions[2].toDefault(),$TD.triangleNormals[0].toDefault(),$TD.triangleNormals[1].toDefault(),$TD.triangleNormals[2].toDefault(),!1;$TD.distance=$TZ,$TJM.scale($Tt.direction,$TZ,$TD.position),$TJM.add($Tt.origin,$TD.position,$TD.position);var $TV=$TD.trianglePositions,$Tx=$TV[0],$TO=$TV[1],$TC=$TV[2],$TU=$Tx.elements,$TF=$TO.elements,$TS=$TC.elements,$TH=$TA+$TJ;$TU[0]=$TM[$TH],$TU[1]=$TM[$TH+1],$TU[2]=$TM[$TH+2];var $Ts=$TL+$TJ;$TF[0]=$TM[$Ts],$TF[1]=$TM[$Ts+1],$TF[2]=$TM[$Ts+2];var $Tr=$Tp+$TJ;$TS[0]=$TM[$Tr],$TS[1]=$TM[$Tr+1],$TS[2]=$TM[$Tr+2];var $Tu=$Tf.getVertexElementByUsage(3);if($Tu){var $Tv=$Tu.offset/4,$Tk=$TD.triangleNormals,$TK=$Tk[0],$Tj=$Tk[1],$Td=$Tk[2],$T$=$TK.elements,$TP=$Tj.elements,$TY=$Td.elements,$Tn=$TA+$Tv;$T$[0]=$TM[$Tn],$T$[1]=$TM[$Tn+1],$T$[2]=$TM[$Tn+2];var $TR=$TL+$Tv;$TP[0]=$TM[$TR],$TP[1]=$TM[$TR+1],$TP[2]=$TM[$TR+2];var $Tg=$Tp+$Tv;$TY[0]=$TM[$Tg],$TY[1]=$TM[$Tg+1],$TY[2]=$TM[$Tg+2]}return!0},$Tz.rayIntersectsTriangle=function($Tt,$TM,$Tf,$Tc){var $TD=$Tz._tempVector30,$To=$Tz._tempVector31;$TJM.subtract($Tf,$TM,$TD),$TJM.subtract($Tc,$TM,$To);var $TJ,$TZ=$Tz._tempVector32;if($TJM.cross($Tt.direction,$To,$TZ),($TJ=$TJM.dot($TD,$TZ))>-Number.MIN_VALUE&&$TJ<Number.MIN_VALUE)return Number.NaN;var $TA,$TL=1/$TJ,$Tp=$Tz._tempVector33;if($TJM.subtract($Tt.origin,$TM,$Tp),$TA=$TJM.dot($Tp,$TZ),($TA*=$TL)<0||1<$TA)return Number.NaN;var $TB,$Tb,$TI=$Tz._tempVector34;return $TJM.cross($Tp,$TD,$TI),$TB=$TJM.dot($Tt.direction,$TI),($TB*=$TL)<0||1<$TA+$TB?Number.NaN:($Tb=$TJM.dot($To,$TI),($Tb*=$TL)<0?Number.NaN:$Tb)},$TB($Tz,["_tempVector30",function(){return this._tempVector30=new $TJM},"_tempVector31",function(){return this._tempVector31=new $TJM},"_tempVector32",function(){return this._tempVector32=new $TJM},"_tempVector33",function(){return this._tempVector33=new $TJM},"_tempVector34",function(){return this._tempVector34=new $TJM},"_tempVector35",function(){return this._tempVector35=new $TJM},"_tempVector36",function(){return this._tempVector36=new $TJM},"_tempVector37",function(){return this._tempVector37=new $TJM}]),$Tz}(),$TlM=(function(){function $Tt(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $TJM,new $TJM,new $TJM],this.trianglePositions.length=3,this.triangleNormals=[new $TJM,new $TJM,new $TJM],this.triangleNormals.length=3,this.position=new $TJM}$TI($Tt,"laya.d3.utils.RaycastHit"),$Tt.prototype.cloneTo=function($Tt){$Tt.distance=this.distance,this.trianglePositions[0].cloneTo($Tt.trianglePositions[0]),this.trianglePositions[1].cloneTo($Tt.trianglePositions[1]),this.trianglePositions[2].cloneTo($Tt.trianglePositions[2]),this.triangleNormals[0].cloneTo($Tt.triangleNormals[0]),this.triangleNormals[1].cloneTo($Tt.triangleNormals[1]),this.triangleNormals[2].cloneTo($Tt.triangleNormals[2]),this.position.cloneTo($Tt.position),$Tt.sprite3D=this.sprite3D}}(),function(){function $Tt($Tt,$TM){this._width=0,this._height=0,this._width=$Tt,this._height=$TM}$TI($Tt,"laya.d3.utils.Size");var $TM=$Tt.prototype;return $Tq(0,$TM,"width",function(){return-1===this._width?$Tm.clientWidth:this._width}),$Tq(0,$TM,"height",function(){return-1===this._height?$Tm.clientHeight:this._height}),$Tq(1,$Tt,"fullScreen",function(){return new $Tt(-1,-1)}),$Tt}()),$T_M=function(){function $TH(){}return $TI($TH,"laya.d3.utils.Utils3D"),$TH._rotationTransformScaleSkinAnimation=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB){var $Tb,$TI,$Tq,$Tl,$T_,$TE=$TH._tempArray16_0,$Te=$TH._tempArray16_1,$TN=$TH._tempArray16_2,$TX=$Tc+$Tc,$Ty=$TD+$TD,$Th=$To+$To,$TT=$Tc*$TX,$Ti=$TD*$TX,$TV=$TD*$Ty,$Tx=$To*$TX,$TO=$To*$Ty,$TC=$To*$Th,$TU=$TJ*$TX,$TF=$TJ*$Ty,$TS=$TJ*$Th;for($TE[15]=1,$TE[0]=1-$TV-$TC,$TE[1]=$Ti+$TS,$TE[2]=$Tx-$TF,$TE[4]=$Ti-$TS,$TE[5]=1-$TT-$TC,$TE[6]=$TO+$TU,$TE[8]=$Tx+$TF,$TE[9]=$TO-$TU,$TE[10]=1-$TT-$TV,$Te[15]=1,$Te[0]=$TZ,$Te[5]=$TA,$Te[10]=$TL,$Tb=0;$Tb<4;$Tb++)$TI=$TE[$Tb],$Tq=$TE[$Tb+4],$Tl=$TE[$Tb+8],$T_=$TE[$Tb+12],$TN[$Tb]=$TI,$TN[$Tb+4]=$Tq,$TN[$Tb+8]=$Tl,$TN[$Tb+12]=$TI*$Tt+$Tq*$TM+$Tl*$Tf+$T_;for($Tb=0;$Tb<4;$Tb++)$TI=$TN[$Tb],$Tq=$TN[$Tb+4],$Tl=$TN[$Tb+8],$T_=$TN[$Tb+12],$Tp[$Tb+$TB]=$TI*$Te[0]+$Tq*$Te[1]+$Tl*$Te[2]+$T_*$Te[3],$Tp[$Tb+$TB+4]=$TI*$Te[4]+$Tq*$Te[5]+$Tl*$Te[6]+$T_*$Te[7],$Tp[$Tb+$TB+8]=$TI*$Te[8]+$Tq*$Te[9]+$Tl*$Te[10]+$T_*$Te[11],$Tp[$Tb+$TB+12]=$TI*$Te[12]+$Tq*$Te[13]+$Tl*$Te[14]+$T_*$Te[15]},$TH._createNodeByJson=function($Tt,$TM,$Tf,$Tc){if(!$Tf)switch($TM.type){case"Sprite3D":$Tf=new $TrM;break;case"MeshSprite3D":$Tf=new $TzM;break;case"SkinnedMeshSprite3D":$Tf=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$Tf=new ShuriKenParticle3D;break;case"TrailSprite3D":$Tf=new TrailSprite3D;break;case"Terrain":$Tf=new Terrain;break;case"Camera":$Tf=new $TgM;break;case"DirectionLight":$Tf=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $TD=$TM.props;if($TD)for(var $To in $TD)$Tf[$To]=$TD[$To];var $TJ=$TM.customProps;$TJ&&($Tf instanceof laya.d3.core.Sprite3D?($Tf._parseBaseCustomProps($TJ),$Tf._parseCustomProps($Tt,$Tc,$TJ,$TM),$Tf._parseCustomComponent($Tt,$Tc,$TM.components)):$Tf._parseCustomProps($Tt,$Tc,$TJ,$TM));var $TZ=$TM.child;if($TZ)for(var $TA=0,$TL=$TZ.length;$TA<$TL;$TA++){var $Tp=$TH._createNodeByJson($Tt,$TZ[$TA],null,$Tc);$Tf.addChild($Tp)}return $Tf},$TH._computeBoneAndAnimationDatasByBindPoseMatrxix=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ,$TA=0,$TL=0,$Tp=$Tt.length;for($TJ=0;$TJ<$Tp;$TA+=$Tt[$TJ].keyframeWidth,$TL+=16,$TJ++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($TM[$TA+0],$TM[$TA+1],$TM[$TA+2],$TM[$TA+3],$TM[$TA+4],$TM[$TA+5],$TM[$TA+6],$TM[$TA+7],$TM[$TA+8],$TM[$TA+9],$Tc,$TL),0!=$TJ&&($TZ=16*$Tt[$TJ].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Tc,$TZ,$Tc,$TL,$Tc,$TL));var $TB=$Tf.length;for($TJ=0;$TJ<$TB;$TJ++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Tc,16*$To[$TJ],$Tf[$TJ],$TD,16*$TJ)},$TH._computeAnimationDatasByArrayAndMatrixFast=function($Tt,$TM,$Tf,$Tc){for(var $TD=0,$To=$Tt.length;$TD<$To;$TD++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($TM,16*$Tc[$TD],$Tt[$TD],$Tf,16*$TD)},$TH._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ,$TZ=0,$TA=0,$TL=$Tt.length;for($To=0;$To<$TL;$TZ+=$Tt[$To].keyframeWidth,$TA+=16,$To++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($TM[$TZ+7],$TM[$TZ+8],$TM[$TZ+9],$TM[$TZ+3],$TM[$TZ+4],$TM[$TZ+5],$TM[$TZ+6],$TM[$TZ+0],$TM[$TZ+1],$TM[$TZ+2],$Tc,$TA),0!=$To&&($TJ=16*$Tt[$To].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Tc,$TJ,$Tc,$TA,$Tc,$TA));var $Tp=$Tf.length;for($To=0;$To<$Tp;$To++){var $TB=16*$To;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Tc,$TB,$Tf[$To],$TD,$TB)}},$TH._computeAnimationDatasByArrayAndMatrixFastOld=function($Tt,$TM,$Tf){for(var $Tc=$Tt.length,$TD=0;$TD<$Tc;$TD++){var $To=16*$TD;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($TM,$To,$Tt[$TD],$Tf,$To)}},$TH._computeRootAnimationData=function($Tt,$TM,$Tf){for(var $Tc=0,$TD=0,$To=0,$TJ=$Tt.length;$Tc<$TJ;$TD+=$Tt[$Tc].keyframeWidth,$To+=16,$Tc++)laya.d3.utils.Utils3D.createAffineTransformationArray($TM[$TD+0],$TM[$TD+1],$TM[$TD+2],$TM[$TD+3],$TM[$TD+4],$TM[$TD+5],$TM[$TD+6],$TM[$TD+7],$TM[$TD+8],$TM[$TD+9],$Tf,$To)},$TH.transformVector3ArrayByQuat=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tf.elements,$TJ=$Tt[$TM],$TZ=$Tt[$TM+1],$TA=$Tt[$TM+2],$TL=$To[0],$Tp=$To[1],$TB=$To[2],$Tb=$To[3],$TI=$Tb*$TJ+$Tp*$TA-$TB*$TZ,$Tq=$Tb*$TZ+$TB*$TJ-$TL*$TA,$Tl=$Tb*$TA+$TL*$TZ-$Tp*$TJ,$T_=-$TL*$TJ-$Tp*$TZ-$TB*$TA;$Tc[$TD]=$TI*$Tb+$T_*-$TL+$Tq*-$TB-$Tl*-$Tp,$Tc[$TD+1]=$Tq*$Tb+$T_*-$Tp+$Tl*-$TL-$TI*-$TB,$Tc[$TD+2]=$Tl*$Tb+$T_*-$TB+$TI*-$Tp-$Tq*-$TL},$TH.mulMatrixByArray=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ,$TA,$TL,$Tp;if($TD===$Tf){for($Tf=$TH._tempArray16_3,$TJ=0;$TJ<16;++$TJ)$Tf[$TJ]=$TD[$To+$TJ];$Tc=0}for($TJ=0;$TJ<4;$TJ++)$TZ=$Tt[$TM+$TJ],$TA=$Tt[$TM+$TJ+4],$TL=$Tt[$TM+$TJ+8],$Tp=$Tt[$TM+$TJ+12],$TD[$To+$TJ]=$TZ*$Tf[$Tc+0]+$TA*$Tf[$Tc+1]+$TL*$Tf[$Tc+2]+$Tp*$Tf[$Tc+3],$TD[$To+$TJ+4]=$TZ*$Tf[$Tc+4]+$TA*$Tf[$Tc+5]+$TL*$Tf[$Tc+6]+$Tp*$Tf[$Tc+7],$TD[$To+$TJ+8]=$TZ*$Tf[$Tc+8]+$TA*$Tf[$Tc+9]+$TL*$Tf[$Tc+10]+$Tp*$Tf[$Tc+11],$TD[$To+$TJ+12]=$TZ*$Tf[$Tc+12]+$TA*$Tf[$Tc+13]+$TL*$Tf[$Tc+14]+$Tp*$Tf[$Tc+15]},$TH.mulMatrixByArrayFast=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ,$TA,$TL,$Tp;for($TJ=0;$TJ<4;$TJ++)$TZ=$Tt[$TM+$TJ],$TA=$Tt[$TM+$TJ+4],$TL=$Tt[$TM+$TJ+8],$Tp=$Tt[$TM+$TJ+12],$TD[$To+$TJ]=$TZ*$Tf[$Tc+0]+$TA*$Tf[$Tc+1]+$TL*$Tf[$Tc+2]+$Tp*$Tf[$Tc+3],$TD[$To+$TJ+4]=$TZ*$Tf[$Tc+4]+$TA*$Tf[$Tc+5]+$TL*$Tf[$Tc+6]+$Tp*$Tf[$Tc+7],$TD[$To+$TJ+8]=$TZ*$Tf[$Tc+8]+$TA*$Tf[$Tc+9]+$TL*$Tf[$Tc+10]+$Tp*$Tf[$Tc+11],$TD[$To+$TJ+12]=$TZ*$Tf[$Tc+12]+$TA*$Tf[$Tc+13]+$TL*$Tf[$Tc+14]+$Tp*$Tf[$Tc+15]},$TH.mulMatrixByArrayAndMatrixFast=function($Tt,$TM,$Tf,$Tc,$TD){var $To,$TJ,$TZ,$TA,$TL,$Tp=$Tf.elements,$TB=$Tp[0],$Tb=$Tp[1],$TI=$Tp[2],$Tq=$Tp[3],$Tl=$Tp[4],$T_=$Tp[5],$TE=$Tp[6],$Te=$Tp[7],$TN=$Tp[8],$TX=$Tp[9],$Ty=$Tp[10],$Th=$Tp[11],$TT=$Tp[12],$Ti=$Tp[13],$TV=$Tp[14],$Tx=$Tp[15],$TO=$TM,$TC=$TM+4,$TU=$TM+8,$TF=$TM+12,$TS=$TD,$TH=$TD+4,$Ts=$TD+8,$Tr=$TD+12;for($To=0;$To<4;$To++)$TJ=$Tt[$TO+$To],$TZ=$Tt[$TC+$To],$TA=$Tt[$TU+$To],$TL=$Tt[$TF+$To],$Tc[$TS+$To]=$TJ*$TB+$TZ*$Tb+$TA*$TI+$TL*$Tq,$Tc[$TH+$To]=$TJ*$Tl+$TZ*$T_+$TA*$TE+$TL*$Te,$Tc[$Ts+$To]=$TJ*$TN+$TZ*$TX+$TA*$Ty+$TL*$Th,$Tc[$Tr+$To]=$TJ*$TT+$TZ*$Ti+$TA*$TV+$TL*$Tx},$TH.createAffineTransformationArray=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB){var $Tb=$Tc+$Tc,$TI=$TD+$TD,$Tq=$To+$To,$Tl=$Tc*$Tb,$T_=$Tc*$TI,$TE=$Tc*$Tq,$Te=$TD*$TI,$TN=$TD*$Tq,$TX=$To*$Tq,$Ty=$TJ*$Tb,$Th=$TJ*$TI,$TT=$TJ*$Tq;$Tp[$TB+0]=(1-($Te+$TX))*$TZ,$Tp[$TB+1]=($T_+$TT)*$TZ,$Tp[$TB+2]=($TE-$Th)*$TZ,$Tp[$TB+3]=0,$Tp[$TB+4]=($T_-$TT)*$TA,$Tp[$TB+5]=(1-($Tl+$TX))*$TA,$Tp[$TB+6]=($TN+$Ty)*$TA,$Tp[$TB+7]=0,$Tp[$TB+8]=($TE+$Th)*$TL,$Tp[$TB+9]=($TN-$Ty)*$TL,$Tp[$TB+10]=(1-($Tl+$Te))*$TL,$Tp[$TB+11]=0,$Tp[$TB+12]=$Tt,$Tp[$TB+13]=$TM,$Tp[$TB+14]=$Tf,$Tp[$TB+15]=1},$TH.transformVector3ArrayToVector3ArrayCoordinate=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TH._tempArray4_0,$TJ=$Tt[$TM+0],$TZ=$Tt[$TM+1],$TA=$Tt[$TM+2],$TL=$Tf.elements;$To[0]=$TJ*$TL[0]+$TZ*$TL[4]+$TA*$TL[8]+$TL[12],$To[1]=$TJ*$TL[1]+$TZ*$TL[5]+$TA*$TL[9]+$TL[13],$To[2]=$TJ*$TL[2]+$TZ*$TL[6]+$TA*$TL[10]+$TL[14],$To[3]=1/($TJ*$TL[3]+$TZ*$TL[7]+$TA*$TL[11]+$TL[15]),$Tc[$TD+0]=$To[0]*$To[3],$Tc[$TD+1]=$To[1]*$To[3],$Tc[$TD+2]=$To[2]*$To[3]},$TH.transformLightingMapTexcoordByUV0Array=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tf.elements;$Tc[$TD+0]=$Tt[$TM+0]*$To[0]+$To[2],$Tc[$TD+1]=($Tt[$TM+1]-1)*$To[1]+$To[3]},$TH.transformLightingMapTexcoordByUV1Array=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tf.elements;$Tc[$TD+0]=$Tt[$TM+0]*$To[0]+$To[2],$Tc[$TD+1]=1+$Tt[$TM+1]*$To[1]+$To[3]},$TH.getURLVerion=function($Tt){var $TM=$Tt.indexOf("?");return 0<=$TM?$Tt.substr($TM):null},$TH._quaternionCreateFromYawPitchRollArray=function($Tt,$TM,$Tf,$Tc){var $TD=.5*$Tf,$To=.5*$TM,$TJ=.5*$Tt,$TZ=Math.sin($TD),$TA=Math.cos($TD),$TL=Math.sin($To),$Tp=Math.cos($To),$TB=Math.sin($TJ),$Tb=Math.cos($TJ);$Tc[0]=$Tb*$TL*$TA+$TB*$Tp*$TZ,$Tc[1]=$TB*$Tp*$TA-$Tb*$TL*$TZ,$Tc[2]=$Tb*$Tp*$TZ-$TB*$TL*$TA,$Tc[3]=$Tb*$Tp*$TA+$TB*$TL*$TZ},$TH._createAffineTransformationArray=function($Tt,$TM,$Tf,$Tc){var $TD=$TM[0],$To=$TM[1],$TJ=$TM[2],$TZ=$TM[3],$TA=$TD+$TD,$TL=$To+$To,$Tp=$TJ+$TJ,$TB=$TD*$TA,$Tb=$TD*$TL,$TI=$TD*$Tp,$Tq=$To*$TL,$Tl=$To*$Tp,$T_=$TJ*$Tp,$TE=$TZ*$TA,$Te=$TZ*$TL,$TN=$TZ*$Tp,$TX=$Tf[0],$Ty=$Tf[1],$Th=$Tf[2];$Tc[0]=(1-($Tq+$T_))*$TX,$Tc[1]=($Tb+$TN)*$TX,$Tc[2]=($TI-$Te)*$TX,$Tc[3]=0,$Tc[4]=($Tb-$TN)*$Ty,$Tc[5]=(1-($TB+$T_))*$Ty,$Tc[6]=($Tl+$TE)*$Ty,$Tc[7]=0,$Tc[8]=($TI+$Te)*$Th,$Tc[9]=($Tl-$TE)*$Th,$Tc[10]=(1-($TB+$Tq))*$Th,$Tc[11]=0,$Tc[12]=$Tt[0],$Tc[13]=$Tt[1],$Tc[14]=$Tt[2],$Tc[15]=1},$TH._mulMatrixArray=function($Tt,$TM,$Tf,$Tc){var $TD,$To,$TJ,$TZ,$TA,$TL=$TM.elements,$Tp=$TL[0],$TB=$TL[1],$Tb=$TL[2],$TI=$TL[3],$Tq=$TL[4],$Tl=$TL[5],$T_=$TL[6],$TE=$TL[7],$Te=$TL[8],$TN=$TL[9],$TX=$TL[10],$Ty=$TL[11],$Th=$TL[12],$TT=$TL[13],$Ti=$TL[14],$TV=$TL[15],$Tx=$Tc,$TO=$Tc+4,$TC=$Tc+8,$TU=$Tc+12;for($TD=0;$TD<4;$TD++)$To=$Tt[$TD],$TJ=$Tt[$TD+4],$TZ=$Tt[$TD+8],$TA=$Tt[$TD+12],$Tf[$Tx+$TD]=$To*$Tp+$TJ*$TB+$TZ*$Tb+$TA*$TI,$Tf[$TO+$TD]=$To*$Tq+$TJ*$Tl+$TZ*$T_+$TA*$TE,$Tf[$TC+$TD]=$To*$Te+$TJ*$TN+$TZ*$TX+$TA*$Ty,$Tf[$TU+$TD]=$To*$Th+$TJ*$TT+$TZ*$Ti+$TA*$TV},$TH.getYawPitchRoll=function($Tt,$TM){$TH.transformQuat($TJM.ForwardRH,$Tt,$TfM.TEMPVector31),$TH.transformQuat($TJM.Up,$Tt,$TfM.TEMPVector32);var $Tf=$TfM.TEMPVector32.elements;$TH.angleTo($TJM.ZERO,$TfM.TEMPVector31,$TfM.TEMPVector33);var $Tc=$TfM.TEMPVector33.elements;$Tc[0]==Math.PI/2?($Tc[1]=$TH.arcTanAngle($Tf[2],$Tf[0]),$Tc[2]=0):$Tc[0]==-Math.PI/2?($Tc[1]=$TH.arcTanAngle(-$Tf[2],-$Tf[0]),$Tc[2]=0):($TtM.createRotationY(-$Tc[1],$TfM.TEMPMatrix0),$TtM.createRotationX(-$Tc[0],$TfM.TEMPMatrix1),$TJM.transformCoordinate($TfM.TEMPVector32,$TfM.TEMPMatrix0,$TfM.TEMPVector32),$TJM.transformCoordinate($TfM.TEMPVector32,$TfM.TEMPMatrix1,$TfM.TEMPVector32),$Tc[2]=$TH.arcTanAngle($Tf[1],-$Tf[0])),$Tc[1]<=-Math.PI&&($Tc[1]=Math.PI),$Tc[2]<=-Math.PI&&($Tc[2]=Math.PI),$Tc[1]>=Math.PI&&$Tc[2]>=Math.PI&&($Tc[1]=0,$Tc[2]=0,$Tc[0]=Math.PI-$Tc[0]),$TM[0]=$Tc[1],$TM[1]=$Tc[0],$TM[2]=$Tc[2]},$TH.arcTanAngle=function($Tt,$TM){return 0==$Tt?1==$TM?Math.PI/2:-Math.PI/2:0<$Tt?Math.atan($TM/$Tt):$Tt<0?0<$TM?Math.atan($TM/$Tt)+Math.PI:Math.atan($TM/$Tt)-Math.PI:0},$TH.angleTo=function($Tt,$TM,$Tf){$TJM.subtract($TM,$Tt,$TfM.TEMPVector30),$TJM.normalize($TfM.TEMPVector30,$TfM.TEMPVector30),$Tf.elements[0]=Math.asin($TfM.TEMPVector30.y),$Tf.elements[1]=$TH.arcTanAngle(-$TfM.TEMPVector30.z,-$TfM.TEMPVector30.x)},$TH.transformQuat=function($Tt,$TM,$Tf){var $Tc=$Tf.elements,$TD=$Tt.elements,$To=$TM,$TJ=$TD[0],$TZ=$TD[1],$TA=$TD[2],$TL=$To[0],$Tp=$To[1],$TB=$To[2],$Tb=$To[3],$TI=$Tb*$TJ+$Tp*$TA-$TB*$TZ,$Tq=$Tb*$TZ+$TB*$TJ-$TL*$TA,$Tl=$Tb*$TA+$TL*$TZ-$Tp*$TJ,$T_=-$TL*$TJ-$Tp*$TZ-$TB*$TA;$Tc[0]=$TI*$Tb+$T_*-$TL+$Tq*-$TB-$Tl*-$Tp,$Tc[1]=$Tq*$Tb+$T_*-$Tp+$Tl*-$TL-$TI*-$TB,$Tc[2]=$Tl*$Tb+$T_*-$TB+$TI*-$Tp-$Tq*-$TL},$TH.quaterionNormalize=function($Tt,$TM){var $Tf=$Tt[0],$Tc=$Tt[1],$TD=$Tt[2],$To=$Tt[3],$TJ=$Tf*$Tf+$Tc*$Tc+$TD*$TD+$To*$To;0<$TJ&&($TJ=1/Math.sqrt($TJ),$TM[0]=$Tf*$TJ,$TM[1]=$Tc*$TJ,$TM[2]=$TD*$TJ,$TM[3]=$To*$TJ)},$TH.matrix4x4MultiplyFFF=function($Tt,$TM,$Tf){var $Tc,$TD,$To,$TJ,$TZ;if($Tf===$TM)for($TM=new Float32Array(16),$Tc=0;$Tc<16;++$Tc)$TM[$Tc]=$Tf[$Tc];for($Tc=0;$Tc<4;$Tc++)$TD=$Tt[$Tc],$To=$Tt[$Tc+4],$TJ=$Tt[$Tc+8],$TZ=$Tt[$Tc+12],$Tf[$Tc]=$TD*$TM[0]+$To*$TM[1]+$TJ*$TM[2]+$TZ*$TM[3],$Tf[$Tc+4]=$TD*$TM[4]+$To*$TM[5]+$TJ*$TM[6]+$TZ*$TM[7],$Tf[$Tc+8]=$TD*$TM[8]+$To*$TM[9]+$TJ*$TM[10]+$TZ*$TM[11],$Tf[$Tc+12]=$TD*$TM[12]+$To*$TM[13]+$TJ*$TM[14]+$TZ*$TM[15]},$TH.matrix4x4MultiplyMFM=function($Tt,$TM,$Tf){$TH.matrix4x4MultiplyFFF($Tt.elements,$TM,$Tf.elements)},$TB($TH,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $TJM},"_tempVector3_1",function(){return this._tempVector3_1=new $TJM},"_tempVector3_2",function(){return this._tempVector3_2=new $TJM},"_tempVector3_3",function(){return this._tempVector3_3=new $TJM},"_tempVector3_4",function(){return this._tempVector3_4=new $TJM},"_tempVector3_5",function(){return this._tempVector3_5=new $TJM},"_tempVector3_6",function(){return this._tempVector3_6=new $TJM},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$TH}(),$TEM=function(){function $TF(){}return $TI($TF,"Laya3D"),$TF._cancelLoadByUrl=function($Tt){$Ty.loader.cancelLoadByUrl($Tt),$TF._innerFirstLevelLoaderManager.cancelLoadByUrl($Tt),$TF._innerSecondLevelLoaderManager.cancelLoadByUrl($Tt),$TF._innerThirdLevelLoaderManager.cancelLoadByUrl($Tt),$TF._innerFourthLevelLoaderManager.cancelLoadByUrl($Tt)},$TF._changeWebGLSize=function($Tt,$TM){$TU.onStageResize($Tt,$TM),$Tm.clientWidth=$Tt,$Tm.clientHeight=$TM},$TF.__init__=function(){var $Tt=$TM.createMap;$Tt.lh=[$TrM,"SPRITE3DHIERARCHY"],$Tt.ls=[$TsM,"SPRITE3DHIERARCHY"],$Tt.lm=[$T$M,"MESH"],$Tt.lmat=[$TvM,"MATERIAL"],$Tt.jpg=[$TYM,"nativeimage"],$Tt.jpeg=[$TYM,"nativeimage"],$Tt.png=[$TYM,"nativeimage"],$Tt.pkm=[$TYM,"arraybuffer"],$Tt.raw=[$TjM,"arraybuffer"],$Tt.mipmaps=[$TjM,"arraybuffer"],$TE.parserMap.SPRITE3DHIERARCHY=$TF._loadHierarchy,$TE.parserMap.MESH=$TF._loadMesh,$TE.parserMap.MATERIAL=$TF._loadMaterial,$TE.parserMap.TEXTURECUBE=$TF._loadTextureCube,$TE.parserMap.TERRAIN=$TF._loadTerrain,$TF._innerFirstLevelLoaderManager.on("error",null,$TF._eventLoadManagerError),$TF._innerSecondLevelLoaderManager.on("error",null,$TF._eventLoadManagerError),$TF._innerThirdLevelLoaderManager.on("error",null,$TF._eventLoadManagerError),$TF._innerFourthLevelLoaderManager.on("error",null,$TF._eventLoadManagerError)},$TF.READ_BLOCK=function(){return $TF._readData.pos+=4,!0},$TF.READ_DATA=function(){return $TF._DATA.offset=$TF._readData.getUint32(),$TF._DATA.size=$TF._readData.getUint32(),!0},$TF.READ_STRINGS=function(){var $Tt=[],$TM={offset:0,size:0};$TM.offset=$TF._readData.getUint16(),$TM.size=$TF._readData.getUint16();$TF._readData.pos;$TF._readData.pos=$TM.offset+$TF._DATA.offset;for(var $Tf=0;$Tf<$TM.size;$Tf++){var $Tc=$TF._readData.readUTFString();-1===$Tc.lastIndexOf(".lmat")&&-1===$Tc.lastIndexOf(".lpbr")||$Tt.push($Tc)}return $Tt},$TF.formatRelativePath=function($Tt,$TM){var $Tf;if("."===$TM.charAt(0)){for(var $Tc=($Tt+$TM).split("/"),$TD=0,$To=$Tc.length;$TD<$To;$TD++)if(".."==$Tc[$TD]){var $TJ=$TD-1;0<$TJ&&".."!==$Tc[$TJ]&&($Tc.splice($TJ,2),$TD-=2)}$Tf=$Tc.join("/")}else $Tf=$Tt+$TM;return null!=$TC.customFormat&&($Tf=$TC.customFormat($Tf,null)),$Tf},$TF._eventLoadManagerError=function($Tt){$Ty.loader.event("error",$Tt)},$TF._addHierarchyInnerUrls=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ=$TF.formatRelativePath($Tc,$TD);$Tf&&($TJ+=$Tf),$Tt.push({url:$TJ,clas:$To}),$TM[$TD]=$TJ},$TF._getSprite3DHierarchyInnerUrls=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){var $TZ,$TA=0,$TL=0;switch($Tt.type){case"Scene":var $Tp=$Tt.customProps.lightmaps;for($TA=0,$TL=$Tp.length;$TA<$TL;$TA++){var $TB=$Tp[$TA].replace(".exr",".png");$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$TB,$TYM)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $Tb;if($Tt.instanceParams)($Tb=$Tt.instanceParams.loadPath)&&$TF._addHierarchyInnerUrls($TM,$TD,$To,$TJ,$Tb,$T$M);else{($Tb=($TZ=$Tt.customProps).meshPath)&&$TF._addHierarchyInnerUrls($TM,$TD,$To,$TJ,$Tb,$T$M);var $TI=$TZ.materials;if($TI)for($TA=0,$TL=$TI.length;$TA<$TL;$TA++){for(var $Tq=$TI[$TA],$Tl=$Tq.type.split("."),$T_=$TS.window,$TE=0,$Te=$Tl.length;$TE<$Te;++$TE){$T_=$T_[this.clasPaths[$TE]]}if("function"!=typeof $T_)throw"_getSprite3DHierarchyInnerUrls 错误: "+$Tq.type+" 不是类";$TF._addHierarchyInnerUrls($Tf,$TD,$To,$TJ,$Tq.path,$T_)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $TN=($TZ=$Tt.customProps).meshPath;$TN&&$TF._addHierarchyInnerUrls($TM,$TD,$To,$TJ,$TN,$T$M);var $TX=$TZ.material;if($TX){$Tl=$TX.type.split("."),$T_=$TS.window;for($TE=0,$Te=$Tl.length;$TE<$Te;++$TE){$T_=$T_[this.clasPaths[$TE]]}$TF._addHierarchyInnerUrls($Tf,$TD,$To,$TJ,$TX.path,$T_)}else{var $Ty=$TZ.materialPath;if($Ty)$TF._addHierarchyInnerUrls($Tf,$TD,$To,$TJ,$Ty,ShurikenParticleMaterial);else{var $Th=$TZ.texturePath;$Th&&$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$Th,$TYM)}}break;case"Terrain":$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$Tt.customProps.dataPath,TerrainRes)}var $TT=$Tt.components;for(var $Ti in $TT){var $TV=$TT[$Ti];switch($Ti){case"Animator":var $Tx=$TV.avatarPath;if($Tx)$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$Tx,Avatar);else{var $TO=$TV.avatar;$TO&&$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$TO.path,Avatar)}var $TC=$TV.clipPaths;for($TA=0,$TL=$TC.length;$TA<$TL;$TA++)$TF._addHierarchyInnerUrls($Tc,$TD,$To,$TJ,$TC[$TA],AnimationClip)}}var $TU=$Tt.child;for($TA=0,$TL=$TU.length;$TA<$TL;$TA++)$TF._getSprite3DHierarchyInnerUrls($TU[$TA],$TM,$Tf,$Tc,$TD,$To,$TJ)},$TF._loadHierarchy=function($Tt){$Tt.on("loaded",null,$TF._onHierarchylhLoaded,[$Tt,$Tt._class._getGroup()]),$Tt.load($Tt.url,"json",!1,null,!0)},$TF._onHierarchylhLoaded=function($Tt,$TM,$Tf){if($Tt._class.destroyed)$Tt.endLoad();else{var $Tc=$Tt.url,$TD=$T_M.getURLVerion($Tc),$To=$TC.getPath($Tc),$TJ=[],$TZ=[],$TA=[],$TL={};$TF._getSprite3DHierarchyInnerUrls($Tf,$TJ,$TZ,$TA,$TL,$TD,$To);var $Tp=$TJ.length+$TZ.length+$TA.length,$TB=$Tp+1,$Tb=1/$TB;if($TF._onProcessChange($Tt,0,$Tb,1),0<$TA.length){var $TI=$Tp/$TB,$Tq=$TO.create(null,$TF._onProcessChange,[$Tt,$Tb,$TI],!1);$TF._innerFourthLevelLoaderManager.create($TA,$TO.create(null,$TF._onHierarchyInnerForthLevResouLoaded,[$Tt,$TM,$Tq,$Tf,$TL,$TJ,$TZ,$Tb+$TI*$TA.length,$TI]),$Tq,null,null,1,!0,$TM)}else $TF._onHierarchyInnerForthLevResouLoaded($Tt,$TM,null,$Tf,$TL,$TJ,$TZ,$Tb,$TI)}},$TF._onHierarchyInnerForthLevResouLoaded=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){if($Tt._class.destroyed)$Tt.endLoad();else if($Tf&&$Tf.recover(),0<$TJ.length){var $TL=$TO.create(null,$TF._onProcessChange,[$Tt,$TZ,$TA],!1);$TF._innerSecondLevelLoaderManager.create($TJ,$TO.create(null,$TF._onHierarchyInnerSecondLevResouLoaded,[$Tt,$TM,$TL,$Tc,$TD,$To,$TZ+$TA*$TJ.length,$TA]),$Tf,null,null,1,!0,$TM)}else $TF._onHierarchyInnerSecondLevResouLoaded($Tt,$TM,null,$Tc,$TD,$To,$TZ,$TA)},$TF._onHierarchyInnerSecondLevResouLoaded=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ){if($Tt._class.destroyed)$Tt.endLoad();else if($Tf&&$Tf.recover(),0<$To.length){var $TA=$TO.create(null,$TF._onProcessChange,[$Tt,$TJ,$TZ],!1);$TF._innerFirstLevelLoaderManager.create($To,$TO.create(null,$TF._onHierarchyInnerFirstLevResouLoaded,[$Tt,$TA,$Tc,$TD]),$Tf,null,null,1,!0,$TM)}else $TF._onHierarchyInnerFirstLevResouLoaded($Tt,null,$Tc,$TD)},$TF._onHierarchyInnerFirstLevResouLoaded=function($Tt,$TM,$Tf,$Tc){$TM&&$TM.recover(),$Tt.endLoad([$Tf,$Tc])},$TF._loadTerrain=function($Tt){$Tt.on("loaded",null,$TF._onTerrainLtLoaded,[$Tt,$Tt._class._getGroup()]),$Tt.load($Tt.url,"json",!1,null,!0)},$TF._onTerrainLtLoaded=function($Tt,$TM,$Tf){if($Tt._class.destroyed)$Tt.endLoad();else{var $Tc,$TD,$To=$Tt.url,$TJ=$T_M.getURLVerion($To),$TZ=$TC.getPath($To),$TA=[],$TL={},$Tp=0,$TB=0,$Tb=$Tf.heightData;$Tc=$Tb.url,$TD=$TF.formatRelativePath($TZ,$Tc),$TJ&&($TD+=$TJ),$Tc=$TL[$Tc]=$TD;var $TI=$Tf.detailTexture;for($Tp=0,$TB=$TI.length;$Tp<$TB;$Tp++)$TA.push({url:$TI[$Tp].diffuse});var $Tq=$Tf.normalMap;for($Tp=0,$TB=$Tq.length;$Tp<$TB;$Tp++)$TA.push({url:$Tq[$Tp]});var $Tl=$Tf.alphaMap;for($Tp=0,$TB=$Tl.length;$Tp<$TB;$Tp++)$TA.push({url:$Tl[$Tp],params:[!1,!1,6408,!0]});for($Tp=0,$TB=$TA.length;$Tp<$TB;$Tp++){var $T_=$TA[$Tp].url;$TD=$TF.formatRelativePath($TZ,$T_),$TJ&&($TD+=$TJ),$TA[$Tp].url=$TD,$TL[$T_]=$TD}var $TE=$TA.length,$Te=$TE+2,$TN=1/$Te;$TF._onProcessChange($Tt,0,$TN,1);var $TX={heightMapLoaded:!1,texturesLoaded:!1},$Ty=$TO.create(null,$TF._onProcessChange,[$Tt,$TN,$TN],!1);$TF._innerFourthLevelLoaderManager.create($Tc,$TO.create(null,$TF._onTerrainHeightMapLoaded,[$Tt,$Ty,$Tf,$TL,$TX]),$Ty,null,[$Tb.numX,$Tb.numZ,$Tb.bitType,$Tb.value],1,!0,$TM);var $Th=$TO.create(null,$TF._onProcessChange,[$Tt,2*$TN,$TE/$Te],!1);$TF._innerFourthLevelLoaderManager.create($TA,$TO.create(null,$TF._onTerrainTexturesLoaded,[$Tt,$Th,$Tf,$TL,$TX]),$Th,null,null,1,!0,$TM)}},$TF._onTerrainHeightMapLoaded=function($Tt,$TM,$Tf,$Tc,$TD){$TD.heightMapLoaded=!0,$TD.texturesLoaded&&($Tt.endLoad([$Tf,$Tc]),$TM.recover())},$TF._onTerrainTexturesLoaded=function($Tt,$TM,$Tf,$Tc,$TD){$TD.texturesLoaded=!0,$TD.heightMapLoaded&&($Tt.endLoad([$Tf,$Tc]),$TM.recover())},$TF._loadMesh=function($Tt){$Tt.on("loaded",null,$TF._onMeshLmLoaded,[$Tt,$Tt._class._getGroup()]),$Tt.load($Tt.url,"arraybuffer",!1,null,!0)},$TF._onMeshLmLoaded=function($Tt,$TM,$Tf){if($Tt._class.destroyed)$Tt.endLoad();else{var $Tc,$TD,$To,$TJ=$Tt.url,$TZ=$T_M.getURLVerion($TJ),$TA=$TC.getPath($TJ),$TL={},$Tp=0,$TB=0;switch(($TF._readData=new $Th($Tf)).pos=0,$TF._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $Tb=$TF._readData.getUint32();$TF._readData.pos=$TF._readData.pos+4,$TB=$TF._readData.getUint16(),$TF._readData.pos=$TF._readData.pos+8*$TB;var $TI=$TF._readData.getUint32();for($TB=$TF._readData.getUint16(),$TF._readData.pos=$Tb+$TI,$Tc=[],$Tp=0;$Tp<$TB;$Tp++){var $Tq=$TF._readData.readUTFString();-1!==$Tq.lastIndexOf(".lmat")&&$Tc.push($Tq)}break;default:for($TF.READ_BLOCK(),$Tp=0;$Tp<2;$Tp++){var $Tl=$TF._readData.getUint16(),$T_=$TF._strings[$Tl],$TE=$TF["READ_"+$T_];if(null==$TE)throw new Error("model file err,no this function:"+$Tl+" "+$T_);1===$Tp?$Tc=$TE.call():$TE.call()}}for($Tp=0,$To=$Tc.length;$Tp<$To;$Tp++){var $Te=$Tc[$Tp];$TD=$TF.formatRelativePath($TA,$Te),$TZ&&($TD+=$TZ),$Tc[$Tp]=$TD,$TL[$Te]=$TD}if(0<$Tc.length){$TF._onProcessChange($Tt,0,.5,1);var $TN=$TO.create(null,$TF._onProcessChange,[$Tt,.5,.5],!1);$TF._innerSecondLevelLoaderManager.create($Tc,$TO.create(null,$TF._onMeshMateialLoaded,[$Tt,$TN,$Tf,$TL]),$TN,null,null,1,!0,$TM)}else $Tt.endLoad([$Tf,$TL])}},$TF._onMeshMateialLoaded=function($Tt,$TM,$Tf,$Tc){$Tt.endLoad([$Tf,$Tc]),$TM.recover()},$TF._getMaterialTexturePath=function($Tt,$TM,$Tf){var $Tc=$Tt.length-4;return $Tt.indexOf(".dds")!=$Tc&&$Tt.indexOf(".tga")!=$Tc&&$Tt.indexOf(".exr")!=$Tc&&$Tt.indexOf(".DDS")!=$Tc&&$Tt.indexOf(".TGA")!=$Tc&&$Tt.indexOf(".EXR")!=$Tc||($Tt=$Tt.substr(0,$Tc)+".png"),$Tt=$TF.formatRelativePath($Tf,$Tt),$TM&&($Tt+=$TM),$Tt},$TF._loadMaterial=function($Tt){$Tt.on("loaded",null,$TF._onMaterilLmatLoaded,[$Tt,$Tt._class._getGroup()]),$Tt.load($Tt.url,"json",!1,null,!0)},$TF._onMaterilLmatLoaded=function($Tt,$TM,$Tf){if($Tt._class.destroyed)$Tt.endLoad();else{var $Tc,$TD=$Tt.url,$To=$T_M.getURLVerion($TD),$TJ=$TC.getPath($TD),$TZ=[],$TA={},$TL=$Tf.customProps,$Tp=$Tf.version;if($Tp)switch($Tp){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $TB=$Tf.props.textures,$Tb=0,$TI=$TB.length;$Tb<$TI;$Tb++){var $Tq=$TB[$Tb],$Tl=$Tq.path;if($Tl){var $T_=$Tl.length-4;$Tl.indexOf(".exr")!=$T_&&$Tl.indexOf(".EXR")!=$T_||($Tl=$Tl.substr(0,$T_)+".png"),$Tc=$TF.formatRelativePath($TJ,$Tl),$To&&($Tc+=$To),$TZ.push({url:$Tc,params:$Tq.params}),$TA[$Tl]=$Tc}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $TE=$TL.diffuseTexture.texture2D;if($TE&&($Tc=$TF._getMaterialTexturePath($TE,$To,$TJ),$TZ.push($Tc),$TA[$TE]=$Tc),$TL.normalTexture){var $Te=$TL.normalTexture.texture2D;$Te&&($Tc=$TF._getMaterialTexturePath($Te,$To,$TJ),$TZ.push($Tc),$TA[$Te]=$Tc)}if($TL.specularTexture){var $TN=$TL.specularTexture.texture2D;$TN&&($Tc=$TF._getMaterialTexturePath($TN,$To,$TJ),$TZ.push($Tc),$TA[$TN]=$Tc)}if($TL.emissiveTexture){var $TX=$TL.emissiveTexture.texture2D;$TX&&($Tc=$TF._getMaterialTexturePath($TX,$To,$TJ),$TZ.push($Tc),$TA[$TX]=$Tc)}if($TL.ambientTexture){var $Ty=$TL.ambientTexture.texture2D;$Ty&&($Tc=$TF._getMaterialTexturePath($Ty,$To,$TJ),$TZ.push($Tc),$TA[$Ty]=$Tc)}if($TL.reflectTexture){var $Th=$TL.reflectTexture.texture2D;$Th&&($Tc=$TF._getMaterialTexturePath($Th,$To,$TJ),$TZ.push($Tc),$TA[$Th]=$Tc)}}var $TT=$TZ.length,$Ti=$TT+1,$TV=1/$Ti;if($TF._onProcessChange($Tt,0,$TV,1),0<$TT){var $Tx=$TO.create(null,$TF._onProcessChange,[$Tt,$TV,$TT/$Ti],!1);$TF._innerFourthLevelLoaderManager.create($TZ,$TO.create(null,$TF._onMateialTexturesLoaded,[$Tt,$Tx,$Tf,$TA]),$Tx,$TYM,null,1,!0,$TM)}else $TF._onMateialTexturesLoaded($Tt,null,$Tf,null)}},$TF._onMateialTexturesLoaded=function($Tt,$TM,$Tf,$Tc){$Tt.endLoad([$Tf,$Tc]),$TM&&$TM.recover()},$TF._loadTextureCube=function($Tt){$Tt.on("loaded",null,$TF._onTextureCubeLtcLoaded,[$Tt]),$Tt.load($Tt.url,"json",!1,null,!0)},$TF._onTextureCubeLtcLoaded=function($Tt,$TM){if($Tt._class.destroyed)$Tt.endLoad();else{var $Tf=$TC.getPath($Tt.url),$Tc=[$TF.formatRelativePath($Tf,$TM.px),$TF.formatRelativePath($Tf,$TM.nx),$TF.formatRelativePath($Tf,$TM.py),$TF.formatRelativePath($Tf,$TM.ny),$TF.formatRelativePath($Tf,$TM.pz),$TF.formatRelativePath($Tf,$TM.nz)];$TF._onProcessChange($Tt,0,1/7,1);var $TD=$TO.create(null,$TF._onProcessChange,[$Tt,1/7,6/7],!1);$TF._innerFourthLevelLoaderManager.load($Tc,$TO.create(null,$TF._onTextureCubeImagesLoaded,[$Tt,$Tc,$TD]),$TD,"nativeimage")}},$TF._onTextureCubeImagesLoaded=function($Tt,$TM,$Tf){var $Tc=[];$Tc.length=6;for(var $TD=0;$TD<6;$TD++){var $To=$TM[$TD];$Tc[$TD]=$TE.getRes($To),$TE.clearRes($To)}$Tt.endLoad($Tc),$Tf.recover()},$TF._onProcessChange=function($Tt,$TM,$Tf,$Tc){($Tc=$TM+$Tc*$Tf)<1&&$Tt.event("progress",$Tc)},$TF.init=function($Tt,$TM,$Tf,$Tc,$TD,$To){if(void 0===$Tf&&($Tf=!1),void 0===$Tc&&($Tc=!1),void 0===$TD&&($TD=!0),void 0===$To&&($To=!0),$Te.update3DLoop=function(){},$Te.cancelLoadByUrl=function($Tt){$TF._cancelLoadByUrl($Tt)},$TA.isAntialias=$Tf,$TA.isAlpha=$Tc,$TA.premultipliedAlpha=$TD,$TA.isStencil=$To,!$TU.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$Te.changeWebGLSize=$TF._changeWebGLSize,$Tl.is3DMode=!0,$Ty.init($Tt,$TM),$TH.__init__(),$TBM.__init__(),$TzM.__init__(),$Td.__init__(),$TF.__init__(),$TJ.maxTextureCount=2,($TF.debugMode||$TG.debugMode)&&($TF._debugPhasorSprite=new $TR)},$TF.HIERARCHY="SPRITE3DHIERARCHY",$TF.MESH="MESH",$TF.MATERIAL="MATERIAL",$TF.PBRMATERIAL="PBRMTL",$TF.TEXTURECUBE="TEXTURECUBE",$TF.TERRAIN="TERRAIN",$TF._readData=null,$TF._debugPhasorSprite=null,$TF.debugMode=!1,$TB($TF,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $TM},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $TM},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $TM},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $TM}]),$TF}(),$TeM=function($Tt){function $TD($Tt){$TD.__super.call(this),this._owner=$Tt,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$TI($TD,"laya.d3.animation.AnimationTransform3D",$To);var $TM=$TD.prototype;return $TM._getlocalMatrix=function(){return this._localUpdate&&($T_M._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$TM._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldTransform()}},$TM._setWorldMatrixAndUpdate=function($Tt){if(this._worldMatrix=$Tt,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $TM=this._getlocalMatrix(),$Tf=0;$Tf<16;++$Tf)this._worldMatrix[$Tf]=$TM[$Tf];else $T_M.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$TM._setWorldMatrixNoUpdate=function($Tt){this._worldMatrix=$Tt},$TM._setWorldMatrixIgnoreUpdate=function($Tt){this._worldMatrix=$Tt,this._worldUpdate=!1},$TM.getLocalPosition=function(){return this._localPosition},$TM.setLocalPosition=function($Tt){if(this._parent)this._localPosition=$Tt,this._localUpdate=!0,this._onWorldTransform();else{var $TM=this._entity.owner._transform,$Tf=this._entity.localPosition,$Tc=$Tf.elements;$Tc[0]=$Tt[0],$Tc[1]=$Tt[1],$Tc[2]=$Tt[2],$TM.localPosition=$Tf}},$TM.getLocalRotation=function(){if(this._localQuaternionUpdate){var $Tt=this._localRotationEuler;$T_M._quaternionCreateFromYawPitchRollArray($Tt[1]/$TD._angleToRandin,$Tt[0]/$TD._angleToRandin,$Tt[2]/$TD._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$TM.setLocalRotation=function($Tt){if(this._parent)this._localRotation=$Tt,$T_M.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $TM=this._entity.owner._transform,$Tf=this._entity.localRotation,$Tc=$Tf.elements;$Tc[0]=$Tt[0],$Tc[1]=$Tt[1],$Tc[2]=$Tt[2],$Tc[3]=$Tt[3],$TM.localRotation=$Tf}},$TM.getLocalScale=function(){return this._localScale},$TM.setLocalScale=function($Tt){if(this._parent)this._localScale=$Tt,this._localUpdate=!0,this._onWorldTransform();else{var $TM=this._entity.owner._transform,$Tf=this._entity.localScale,$Tc=$Tf.elements;$Tc[0]=$Tt[0],$Tc[1]=$Tt[1],$Tc[2]=$Tt[2],$TM.localScale=$Tf}},$TM.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$T_M.getYawPitchRoll(this._localRotation,$TD._tempVector3);var $Tt=$TD._tempVector3,$TM=this._localRotationEuler;$TM[0]=$Tt[1]*$TD._angleToRandin,$TM[1]=$Tt[0]*$TD._angleToRandin,$TM[2]=$Tt[2]*$TD._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$TM.setLocalRotationEuler=function($Tt){if(this._parent)$T_M._quaternionCreateFromYawPitchRollArray($Tt[1]/$TD._angleToRandin,$Tt[0]/$TD._angleToRandin,$Tt[2]/$TD._angleToRandin,this._localRotation),this._localRotationEuler=$Tt,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $TM=this._entity.owner._transform,$Tf=this._entity.localRotationEuler,$Tc=$Tf.elements;$Tc[0]=$Tt[0],$Tc[1]=$Tt[1],$Tc[2]=$Tt[2],$TM.localRotationEuler=$Tf}},$TM.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$T_M.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $Tt=this._getlocalMatrix(),$TM=0;$TM<16;++$TM)this._worldMatrix[$TM]=$Tt[$TM];this._worldUpdate=!1}return this._worldMatrix},$TM.setParent=function($Tt){if(this._parent!==$Tt){if(this._parent){var $TM=this._parent._childs,$Tf=$TM.indexOf(this);$TM.splice($Tf,1)}$Tt&&($Tt._childs.push(this),$Tt&&this._onWorldTransform()),this._parent=$Tt}},$TB($TD,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$TD}(),$TNM=function($Tt){function $TM(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$TM.__super.call(this),this._destroyed=!1,this._id=$TM._uniqueIDCounter,$TM._uniqueIDCounter++}$TI($TM,"laya.d3.component.Component3D",$To);var $Tf=$TM.prototype;return $Ty.imps($Tf,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$Tf._initialize=function($Tt){this._owner=$Tt,this._enable=!0,this.started=!1,this._load($Tt)},$Tf._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$Tf._load=function($Tt){},$Tf._start=function($Tt){},$Tf._update=function($Tt){},$Tf._lateUpdate=function($Tt){},$Tf._preRenderUpdate=function($Tt){},$Tf._postRenderUpdate=function($Tt){},$Tf._unload=function($Tt){this.offAll()},$Tf._cloneTo=function($Tt){},$Tq(0,$Tf,"id",function(){return this._id}),$Tq(0,$Tf,"destroyed",function(){return this._destroyed}),$Tq(0,$Tf,"owner",function(){return this._owner}),$Tq(0,$Tf,"enable",function(){return this._enable},function($Tt){this._enable!==$Tt&&(this._enable=$Tt,this.event("enablechanged",this._enable))}),$Tq(0,$Tf,"isSingleton",function(){return $TM._isSingleton}),$TM._isSingleton=!0,$TM._uniqueIDCounter=1,$TM}(),$TXM=function($Tt){function $TM(){this._destroyed=!1,$TM.__super.call(this),this._destroyed=!1}$TI($TM,"laya.d3.core.GeometryFilter",$To);var $Tf=$TM.prototype;return $Ty.imps($Tf,{"laya.resource.IDestroy":!0}),$Tf._destroy=function(){this.offAll(),this._destroyed=!0},$Tq(0,$Tf,"_isAsyncLoaded",function(){return!0}),$Tq(0,$Tf,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$Tq(0,$Tf,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$Tq(0,$Tf,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$Tq(0,$Tf,"destroyed",function(){return this._destroyed}),$TM}(),$TyM=function($Tt){function $Tc($Tt){$Tc.__super.call(this),this._id=++$Tc._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $TGt(new $TJM,new $TJM),this._boundingBoxCenter=new $TJM,this._boundingSphere=new $TQt(new $TJM,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$Tt,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$TI($Tc,"laya.d3.core.render.BaseRender",$To);var $TM=$Tc.prototype;return $Ty.imps($TM,{"laya.resource.IDestroy":!0}),$TM._changeMaterialReference=function($Tt,$TM){$Tt&&$Tt._removeReference(),$TM._addReference()},$TM._getInstanceMaterial=function($Tt,$TM){var $Tf=new $Tt.constructor;return $Tt.cloneTo($Tf),$Tf.name=$Tf.name+"(Instance)",this._materialsInstance[$TM]=!0,this._changeMaterialReference(this._materials[$TM],$Tf),this._materials[$TM]=$Tf},$TM._setShaderValuelightMap=function($Tt){this._setShaderValueTexture(3,$Tt)},$TM._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$TM._renderRenderableBoundBox=function(){var $Tt=$TEM._debugPhasorSprite,$TM=this.boundingBox,$Tf=$Tc._tempBoundBoxCorners;$TM.getCorners($Tf),$Tt.line($Tf[0],$Tc._greenColor,$Tf[1],$Tc._greenColor),$Tt.line($Tf[2],$Tc._greenColor,$Tf[3],$Tc._greenColor),$Tt.line($Tf[4],$Tc._greenColor,$Tf[5],$Tc._greenColor),$Tt.line($Tf[6],$Tc._greenColor,$Tf[7],$Tc._greenColor),$Tt.line($Tf[0],$Tc._greenColor,$Tf[3],$Tc._greenColor),$Tt.line($Tf[1],$Tc._greenColor,$Tf[2],$Tc._greenColor),$Tt.line($Tf[2],$Tc._greenColor,$Tf[6],$Tc._greenColor),$Tt.line($Tf[3],$Tc._greenColor,$Tf[7],$Tc._greenColor),$Tt.line($Tf[0],$Tc._greenColor,$Tf[4],$Tc._greenColor),$Tt.line($Tf[1],$Tc._greenColor,$Tf[5],$Tc._greenColor),$Tt.line($Tf[4],$Tc._greenColor,$Tf[7],$Tc._greenColor),$Tt.line($Tf[5],$Tc._greenColor,$Tf[6],$Tc._greenColor)},$TM._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$TM._calculateBoundingBox=function(){throw"BaseRender: must override it."},$TM._setShaderValueTexture=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM)},$TM._setShaderValueMatrix4x4=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM?$TM.elements:null)},$TM._setShaderValueColor=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM?$TM.elements:null)},$TM._setShaderValueBuffer=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM)},$TM._setShaderValueInt=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM)},$TM._setShaderValueBool=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM)},$TM._setShaderValueNumber=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM)},$TM._setShaderValueVector2=function($Tt,$TM){this._owner._shaderValues.setValue($Tt,$TM?$TM.elements:null)},$TM._addShaderDefine=function($Tt){this._owner._shaderDefineValue|=$Tt},$TM._removeShaderDefine=function($Tt){this._owner._shaderDefineValue&=~$Tt},$TM._renderUpdate=function($Tt){return!0},$TM._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $Tt=this._owner.scene;if($Tt){var $TM=$Tt.getlightmaps()[this._lightmapIndex];$TM?(this._addShaderDefine($TRM.SAHDERDEFINE_LIGHTMAP),$TM.loaded?this._setShaderValuelightMap($TM):$TM.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($TRM.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($TRM.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($TRM.SAHDERDEFINE_LIGHTMAP)},$TM._updateOctreeNode=function(){var $Tt=this._treeNode;$Tt&&this._octreeNodeNeedChange&&($Tt.updateObject(this),this._octreeNodeNeedChange=!1)},$TM._destroy=function(){this.offAll();var $Tt=0,$TM=0;for($Tt=0,$TM=this._renderElements.length;$Tt<$TM;$Tt++)this._renderElements[$Tt]._destroy();for($Tt=0,$TM=this._materials.length;$Tt<$TM;$Tt++)this._materials[$Tt]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$Tq(0,$TM,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$Tq(0,$TM,"id",function(){return this._id}),$Tq(0,$TM,"material",function(){var $Tt=this._materials[0];if($Tt&&!this._materialsInstance[0]){var $TM=this._getInstanceMaterial($Tt,0);this.event("materialchanged",[this,0,$TM])}return this._materials[0]},function($Tt){this.sharedMaterial=$Tt}),$Tq(0,$TM,"sharedMaterial",function(){return this._materials[0]},function($Tt){var $TM=this._materials[0];$TM!==$Tt&&(this._materials[0]=$Tt,this._materialsInstance[0]=!1,this._changeMaterialReference($TM,$Tt),this.event("materialchanged",[this,0,$Tt]))}),$Tq(0,$TM,"lightmapIndex",function(){return this._lightmapIndex},function($Tt){this._lightmapIndex=$Tt,this._applyLightMapParams()}),$Tq(0,$TM,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($Tt){this._lightmapScaleOffset=$Tt,this._setShaderValueColor(2,$Tt),this._addShaderDefine($TRM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$Tq(0,$TM,"enable",function(){return this._enable},function($Tt){this._enable=$Tt,this.event("enablechanged",[this,$Tt])}),$Tq(0,$TM,"materials",function(){for(var $Tt=0,$TM=this._materials.length;$Tt<$TM;$Tt++)if(!this._materialsInstance[$Tt]){var $Tf=this._getInstanceMaterial(this._materials[$Tt],$Tt);this.event("materialchanged",[this,$Tt,$Tf])}return this._materials.slice()},function($Tt){this.sharedMaterials=$Tt}),$Tq(0,$TM,"sharedMaterials",function(){return this._materials.slice()},function($Tt){if(!$Tt)throw new Error("MeshRender: shadredMaterials value can't be null.");var $TM=$Tt.length;this._materialsInstance.length=$TM;for(var $Tf=0;$Tf<$TM;$Tf++){var $Tc=this._materials[$Tf];$Tc!==$Tt[$Tf]&&(this._materialsInstance[$Tf]=!1,this._changeMaterialReference($Tc,$Tt[$Tf]),this.event("materialchanged",[this,$Tf,$Tt[$Tf]]))}this._materials=$Tt}),$Tq(0,$TM,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$Tq(0,$TM,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $Tt=this.boundingBox;$TJM.add($Tt.min,$Tt.max,this._boundingBoxCenter),$TJM.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$Tq(0,$TM,"receiveShadow",function(){return this._receiveShadow},function($Tt){this._receiveShadow!==$Tt&&((this._receiveShadow=$Tt)?this._addShaderDefine($TIM.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($TIM.SHADERDEFINE_RECEIVE_SHADOW))}),$Tq(0,$TM,"destroyed",function(){return this._destroyed}),$Tc._uniqueIDCounter=0,$TB($Tc,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM,new $TJM]},"_greenColor",function(){return this._greenColor=new $TZM(0,1,0,1)}]),$Tc}(),$ThM=function($Tt){function $TZ($Tt){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$TZ.__super.call(this),this._localPosition=new $TJM,this._localRotation=new $TfM(0,0,0,1),this._localScale=new $TJM(1,1,1),this._localRotationEuler=new $TJM,this._localMatrix=new $TtM,this._position=new $TJM,this._rotation=new $TfM(0,0,0,1),this._scale=new $TJM(1,1,1),this._worldMatrix=new $TtM,this._forward=new $TJM,this._up=new $TJM,this._right=new $TJM,this._owner=$Tt,this._childs=[]}$TI($TZ,"laya.d3.core.Transform3D",$To);var $TM=$TZ.prototype;return $TM._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$TtM.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $Tt=$TZ._tempVector30;$TJM.multiply(this.pivot,this._localScale,$Tt);var $TM=$TZ._tempVector31;$TJM.subtract($Tt,this.pivot,$TM);var $Tf=$TZ._tempVector32,$Tc=this.localRotation;$TJM.transformQuat($Tt,$Tc,$Tf),$TJM.subtract($Tf,$Tt,$Tf);var $TD=$TZ._tempVector33;$TJM.subtract(this._localPosition,$TM,$TD),$TJM.subtract($TD,$Tf,$TD),$TtM.createAffineTransformation($TD,$Tc,this._localScale,this._localMatrix)}},$TM._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldPositionRotationTransform()}},$TM._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldPositionScaleTransform()}},$TM._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldPositionTransform()}},$TM._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldPositionRotationTransform()}},$TM._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldPositionScaleTransform()}},$TM._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._onWorldTransform()}},$TM.translate=function($Tt,$TM){void 0===$TM&&($TM=!0),$TM?($TtM.createFromQuaternion(this.localRotation,$TZ._tempMatrix0),$TJM.transformCoordinate($Tt,$TZ._tempMatrix0,$TZ._tempVector30),$TJM.add(this.localPosition,$TZ._tempVector30,this._localPosition),this.localPosition=this._localPosition):($TJM.add(this.position,$Tt,this._position),this.position=this._position)},$TM.rotate=function($Tt,$TM,$Tf){var $Tc;void 0===$TM&&($TM=!0),void 0===$Tf&&($Tf=!0),$Tc=$Tf?$Tt:($TJM.scale($Tt,Math.PI/180,$TZ._tempVector30),$TZ._tempVector30),$TfM.createFromYawPitchRoll($Tc.y,$Tc.x,$Tc.z,$TZ._tempQuaternion0),$TM?($TfM.multiply(this._localRotation,$TZ._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($TfM.multiply($TZ._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$TM.lookAt=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=!1);var $Tc,$TD=$Tt.elements;if($Tf){if($Tc=this._localPosition.elements,Math.abs($Tc[0]-$TD[0])<$Twt.zeroTolerance&&Math.abs($Tc[1]-$TD[1])<$Twt.zeroTolerance&&Math.abs($Tc[2]-$TD[2])<$Twt.zeroTolerance)return;$TfM.lookAt(this._localPosition,$Tt,$TM,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $To=this.position;if($Tc=$To.elements,Math.abs($Tc[0]-$TD[0])<$Twt.zeroTolerance&&Math.abs($Tc[1]-$TD[1])<$Twt.zeroTolerance&&Math.abs($Tc[2]-$TD[2])<$Twt.zeroTolerance)return;$TfM.lookAt($To,$Tt,$TM,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$Tq(0,$TM,"_isFrontFaceInvert",function(){var $Tt=this.scale,$TM=$Tt.x<0;return $Tt.y<0&&($TM=!$TM),$Tt.z<0&&($TM=!$TM),$TM}),$Tq(0,$TM,"owner",function(){return this._owner}),$Tq(0,$TM,"localRotation",function(){if(this._localQuaternionUpdate){var $Tt=this._localRotationEuler.elements;$TfM.createFromYawPitchRoll($Tt[1]/$TZ._angleToRandin,$Tt[0]/$TZ._angleToRandin,$Tt[2]/$TZ._angleToRandin,this._localRotation)}return this._localRotation},function($Tt){this._localRotation=$Tt,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$Tq(0,$TM,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$TtM.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($Tt){null===this._parent?$Tt.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$TtM.multiply(this._localMatrix,$Tt,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$Tt,this._worldUpdate=!1}),$Tq(0,$TM,"worldNeedUpdate",function(){return this._worldUpdate}),$Tq(0,$TM,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($Tt){this._localMatrix=$Tt,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$Tq(0,$TM,"dummy",function(){return this._dummy},function($Tt){this._dummy!==$Tt&&(this._dummy&&(this._dummy._entity=null),$Tt&&($Tt._entity=this),this._dummy=$Tt)}),$Tq(0,$TM,"localPosition",function(){return this._localPosition},function($Tt){this._localPosition=$Tt,this._localUpdate=!0,this._onWorldPositionTransform()}),$Tq(0,$TM,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $Tt=this._parent.position;$TJM.multiply(this._localPosition,this._parent.scale,$TZ._tempVector30),$TJM.transformQuat($TZ._tempVector30,this._parent.rotation,$TZ._tempVector30),$TJM.add($Tt,$TZ._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($Tt){if(null!=this._parent){$TJM.subtract($Tt,this._parent.position,this._localPosition);var $TM=this._parent.scale.elements,$Tf=$TM[0],$Tc=$TM[1],$TD=$TM[2];if(1!==$Tf||1!==$Tc||1!==$TD){var $To=$TZ._tempVector30,$TJ=$To.elements;$TJ[0]=1/$Tf,$TJ[1]=1/$Tc,$TJ[2]=1/$TD,$TJM.multiply(this._localPosition,$To,this._localPosition)}this._parent.rotation.invert($TZ._tempQuaternion0),$TJM.transformQuat(this._localPosition,$TZ._tempQuaternion0,this._localPosition)}else $Tt.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$Tt,this._positionUpdate=!1}),$Tq(0,$TM,"localScale",function(){return this._localScale},function($Tt){this._localScale=$Tt,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$Tq(0,$TM,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($TZ._tempVector30);var $Tt=$TZ._tempVector30.elements,$TM=this._localRotationEuler.elements;$TM[0]=$Tt[1]*$TZ._angleToRandin,$TM[1]=$Tt[0]*$TZ._angleToRandin,$TM[2]=$Tt[2]*$TZ._angleToRandin}return this._localRotationEuler},function($Tt){this._localRotationEuler=$Tt,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$Tq(0,$TM,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$TfM.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($Tt){null!=this._parent?(this._parent.rotation.invert($TZ._tempQuaternion0),$TfM.multiply($Tt,$TZ._tempQuaternion0,this._localRotation)):$Tt.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$Tt,this._rotationUpdate=!1}),$Tq(0,$TM,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$TJM.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($Tt){if(null!==this._parent){var $TM=this._parent.scale.elements,$Tf=$TZ._tempVector30.elements;$Tf[0]=1/$TM[0],$Tf[1]=1/$TM[1],$Tf[2]=1/$TM[2],$TJM.multiply($Tt,$TZ._tempVector30,this._localScale)}else $Tt.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$Tt,this._scaleUpdate=!1}),$Tq(0,$TM,"rotationEuler",null,function($Tt){$TfM.createFromYawPitchRoll($Tt.y,$Tt.x,$Tt.z,this._rotation),this.rotation=this._rotation}),$Tq(0,$TM,"forward",function(){var $Tt=this.worldMatrix.elements;return this._forward.elements[0]=-$Tt[8],this._forward.elements[1]=-$Tt[9],this._forward.elements[2]=-$Tt[10],this._forward}),$Tq(0,$TM,"up",function(){var $Tt=this.worldMatrix.elements;return this._up.elements[0]=$Tt[4],this._up.elements[1]=$Tt[5],this._up.elements[2]=$Tt[6],this._up}),$Tq(0,$TM,"right",function(){var $Tt=this.worldMatrix.elements;return this._right.elements[0]=$Tt[0],this._right.elements[1]=$Tt[1],this._right.elements[2]=$Tt[2],this._right}),$Tq(0,$TM,"parent",function(){return this._parent},function($Tt){if(this._parent!==$Tt){if(this._parent){var $TM=this._parent._childs,$Tf=$TM.indexOf(this);$TM.splice($Tf,1)}$Tt&&($Tt._childs.push(this),$Tt&&this._onWorldTransform()),this._parent=$Tt}}),$TB($TZ,["_tempVector30",function(){return this._tempVector30=new $TJM},"_tempVector31",function(){return this._tempVector31=new $TJM},"_tempVector32",function(){return this._tempVector32=new $TJM},"_tempVector33",function(){return this._tempVector33=new $TJM},"_tempQuaternion0",function(){return this._tempQuaternion0=new $TfM},"_tempMatrix0",function(){return this._tempMatrix0=new $TtM},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$TZ}(),$TTM=(function($Tt){function $TM(){this._rotation=0,this._matNeedUpdte=!1,$TM.__super.call(this),this._matrix=new $TtM,this._offset=new $ToM,this._tiling=new $ToM(1,1)}$TI($TM,"laya.d3.core.TransformUV",$To);var $Tf=$TM.prototype;$Ty.imps($Tf,{"laya.d3.core.IClone":!0}),$Tf._updateMatrix=function(){$TM._tempOffsetV3.elements[0]=this._offset.x,$TM._tempOffsetV3.elements[1]=this._offset.y,$TfM.createFromYawPitchRoll(0,0,this._rotation,$TM._tempRotationQua),$TM._tempTitlingV3.elements[0]=this._tiling.x,$TM._tempTitlingV3.elements[1]=this._tiling.y,$TtM.createAffineTransformation($TM._tempOffsetV3,$TM._tempRotationQua,$TM._tempTitlingV3,this._matrix)},$Tf.cloneTo=function($Tt){$Tt._matrix=this._matrix.clone(),$Tt._offset=this._offset.clone(),$Tt._rotation=this._rotation,$Tt._tiling=this._tiling.clone()},$Tf.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$Tf,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$Tq(0,$Tf,"tiling",function(){return this._tiling},function($Tt){this._tiling=$Tt,this._matNeedUpdte=!0}),$Tq(0,$Tf,"offset",function(){return this._offset},function($Tt){this._offset=$Tt,this._matNeedUpdte=!0}),$Tq(0,$Tf,"rotation",function(){return this._rotation},function($Tt){this._rotation=$Tt,this._matNeedUpdte=!0}),$TB($TM,["_tempOffsetV3",function(){return this._tempOffsetV3=new $TJM(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $TfM},"_tempTitlingV3",function(){return this._tempTitlingV3=new $TJM(1,1,1)}])}(),function($Tf){function $Tt(){this.x=NaN,this.y=NaN,this.z=NaN,$Tt.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$TI($Tt,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$Tf);var $TM=$Tt.prototype;$TM._getShapeBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=.5*-this.x,$TM[1]=.5*-this.y,$TM[2]=.5*-this.z;var $Tf=$Tt.max.elements;$Tf[0]=.5*this.x,$Tf[1]=.5*this.y,$Tf[2]=.5*this.z},$TM._getSpeedBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=0,$TM[1]=0,$TM[2]=0;var $Tf=$Tt.max.elements;$Tf[0]=0,$Tf[1]=1,$Tf[2]=0},$TM.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements,$To=$TM.elements;$Tf?($Tf.seed=$Tc[16],$TY._randomPointInsideHalfUnitBox($Tt,$Tf),$Tc[16]=$Tf.seed):$TY._randomPointInsideHalfUnitBox($Tt),$TD[0]=this.x*$TD[0],$TD[1]=this.y*$TD[1],$TD[2]=this.z*$TD[2],this.randomDirection?$Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM):($To[0]=0,$To[1]=0,$To[2]=1)},$TM.cloneTo=function($Tt){$Tf.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;$TM.x=this.x,$TM.y=this.y,$TM.z=this.z,$TM.randomDirection=this.randomDirection}}($TK),function($Tf){function $TJ(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$TJ.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$TI($TJ,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$Tf);var $Tt=$TJ.prototype;$Tt._getShapeBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[2]=-this.radius,$TM[1]=0;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[2]=this.radius,$Tf[1]=0},$Tt._getSpeedBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[1]=-1,$TM[2]=0;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[1]=1,$Tf[2]=0},$Tt.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements,$To=$TJ._tempPositionPoint.elements;$Tf?($Tf.seed=$Tc[16],this.emitFromEdge?$TY._randomPointUnitArcCircle(this.arc,$TJ._tempPositionPoint,$Tf):$TY._randomPointInsideUnitArcCircle(this.arc,$TJ._tempPositionPoint,$Tf),$Tc[16]=$Tf.seed):this.emitFromEdge?$TY._randomPointUnitArcCircle(this.arc,$TJ._tempPositionPoint):$TY._randomPointInsideUnitArcCircle(this.arc,$TJ._tempPositionPoint),$TD[0]=-$To[0],$TD[1]=$To[1],$TD[2]=0,$TJM.scale($Tt,this.radius,$Tt),this.randomDirection?$Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM):$Tt.cloneTo($TM)},$Tt.cloneTo=function($Tt){$Tf.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;$TM.radius=this.radius,$TM.arc=this.arc,$TM.emitFromEdge=this.emitFromEdge,$TM.randomDirection=this.randomDirection},$TB($TJ,["_tempPositionPoint",function(){return this._tempPositionPoint=new $ToM}])}($TK),function($Tf){function $Tb(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$Tb.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$TI($Tb,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$Tf);var $Tt=$Tb.prototype;$Tt._getShapeBoundBox=function($Tt){var $TM=this.radius+this.length*Math.sin(this.angle),$Tf=this.length*Math.cos(this.angle),$Tc=$Tt.min.elements;$Tc[0]=$Tc[1]=-$TM,$Tc[2]=0;var $TD=$Tt.max.elements;$TD[0]=$TD[1]=$TM,$TD[2]=$Tf},$Tt._getSpeedBoundBox=function($Tt){var $TM=Math.sin(this.angle),$Tf=$Tt.min.elements;$Tf[0]=$Tf[1]=-$TM,$Tf[2]=0;var $Tc=$Tt.max.elements;$Tc[0]=$Tf[1]=$TM,$Tc[2]=1},$Tt.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){var $TD,$To=$Tt.elements,$TJ=$TM.elements,$TZ=$Tb._tempPositionPoint.elements,$TA=NaN,$TL=NaN,$Tp=Math.cos(this.angle),$TB=Math.sin(this.angle);switch(this.emitType){case 0:$Tf?($Tf.seed=$Tc[16],$TY._randomPointInsideUnitCircle($Tb._tempPositionPoint,$Tf),$Tc[16]=$Tf.seed):$TY._randomPointInsideUnitCircle($Tb._tempPositionPoint),$TA=$TZ[0],$TL=$TZ[1],$To[0]=$TA*this.radius,$To[1]=$TL*this.radius,$To[2]=0,this.randomDirection?($Tf?($Tf.seed=$Tc[17],$TY._randomPointInsideUnitCircle($Tb._tempDirectionPoint,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointInsideUnitCircle($Tb._tempDirectionPoint),$TD=$Tb._tempDirectionPoint.elements,$TJ[0]=$TD[0]*$TB,$TJ[1]=$TD[1]*$TB):($TJ[0]=$TA*$TB,$TJ[1]=$TL*$TB),$TJ[2]=$Tp;break;case 1:$Tf?($Tf.seed=$Tc[16],$TY._randomPointUnitCircle($Tb._tempPositionPoint,$Tf),$Tc[16]=$Tf.seed):$TY._randomPointUnitCircle($Tb._tempPositionPoint),$TA=$TZ[0],$TL=$TZ[1],$To[0]=$TA*this.radius,$To[1]=$TL*this.radius,$To[2]=0,this.randomDirection?($Tf?($Tf.seed=$Tc[17],$TY._randomPointInsideUnitCircle($Tb._tempDirectionPoint,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointInsideUnitCircle($Tb._tempDirectionPoint),$TD=$Tb._tempDirectionPoint.elements,$TJ[0]=$TD[0]*$TB,$TJ[1]=$TD[1]*$TB):($TJ[0]=$TA*$TB,$TJ[1]=$TL*$TB),$TJ[2]=$Tp;break;case 2:$Tf?($Tf.seed=$Tc[16],$TY._randomPointInsideUnitCircle($Tb._tempPositionPoint,$Tf)):$TY._randomPointInsideUnitCircle($Tb._tempPositionPoint),$TA=$TZ[0],$TL=$TZ[1],$To[0]=$TA*this.radius,$To[1]=$TL*this.radius,$TJ[$To[2]=0]=$TA*$TB,$TJ[1]=$TL*$TB,$TJ[2]=$Tp,$TJM.normalize($TM,$TM),$Tf?($TJM.scale($TM,this.length*$Tf.getFloat(),$TM),$Tc[16]=$Tf.seed):$TJM.scale($TM,this.length*Math.random(),$TM),$TJM.add($Tt,$TM,$Tt),this.randomDirection&&($Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM));break;case 3:$Tf?($Tf.seed=$Tc[16],$TY._randomPointUnitCircle($Tb._tempPositionPoint,$Tf)):$TY._randomPointUnitCircle($Tb._tempPositionPoint),$TA=$TZ[0],$TL=$TZ[1],$To[0]=$TA*this.radius,$To[1]=$TL*this.radius,$TJ[$To[2]=0]=$TA*$TB,$TJ[1]=$TL*$TB,$TJ[2]=$Tp,$TJM.normalize($TM,$TM),$Tf?($TJM.scale($TM,this.length*$Tf.getFloat(),$TM),$Tc[16]=$Tf.seed):$TJM.scale($TM,this.length*Math.random(),$TM),$TJM.add($Tt,$TM,$Tt),this.randomDirection&&($Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM));break;default:throw new Error("ConeShape:emitType is invalid.")}},$Tt.cloneTo=function($Tt){$Tf.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;$TM.angle=this.angle,$TM.radius=this.radius,$TM.length=this.length,$TM.emitType=this.emitType,$TM.randomDirection=this.randomDirection},$TB($Tb,["_tempPositionPoint",function(){return this._tempPositionPoint=new $ToM},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $ToM}])}($TK),function($Tf){function $Tt(){this.radius=NaN,this.emitFromShell=!1,$Tt.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$TI($Tt,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$Tf);var $TM=$Tt.prototype;$TM._getShapeBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[1]=$TM[2]=-this.radius;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[1]=this.radius,$Tf[2]=0},$TM._getSpeedBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[1]=-1,$TM[2]=0;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[1]=$Tf[2]=1},$TM.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.elements;$Tf?($Tf.seed=$Tc[16],this.emitFromShell?$TY._randomPointUnitSphere($Tt,$Tf):$TY._randomPointInsideUnitSphere($Tt,$Tf),$Tc[16]=$Tf.seed):this.emitFromShell?$TY._randomPointUnitSphere($Tt):$TY._randomPointInsideUnitSphere($Tt),$TJM.scale($Tt,this.radius,$Tt);var $To=$TD[2];$To<0&&($TD[2]=-1*$To),this.randomDirection?$Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM):$Tt.cloneTo($TM)},$TM.cloneTo=function($Tt){$Tf.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;$TM.radius=this.radius,$TM.emitFromShell=this.emitFromShell,$TM.randomDirection=this.randomDirection}}($TK),function($Tf){function $Tt(){this.radius=NaN,this.emitFromShell=!1,$Tt.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$TI($Tt,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$Tf);var $TM=$Tt.prototype;$TM._getShapeBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[1]=$TM[2]=-this.radius;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[1]=$Tf[2]=this.radius},$TM._getSpeedBoundBox=function($Tt){var $TM=$Tt.min.elements;$TM[0]=$TM[1]=$TM[2]=-1;var $Tf=$Tt.max.elements;$Tf[0]=$Tf[1]=$Tf[2]=1},$TM.generatePositionAndDirection=function($Tt,$TM,$Tf,$Tc){$Tf?($Tf.seed=$Tc[16],this.emitFromShell?$TY._randomPointUnitSphere($Tt,$Tf):$TY._randomPointInsideUnitSphere($Tt,$Tf),$Tc[16]=$Tf.seed):this.emitFromShell?$TY._randomPointUnitSphere($Tt):$TY._randomPointInsideUnitSphere($Tt),$TJM.scale($Tt,this.radius,$Tt),this.randomDirection?$Tf?($Tf.seed=$Tc[17],$TY._randomPointUnitSphere($TM,$Tf),$Tc[17]=$Tf.seed):$TY._randomPointUnitSphere($TM):$Tt.cloneTo($TM)},$TM.cloneTo=function($Tt){$Tf.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;$TM.radius=this.radius,$TM.emitFromShell=this.emitFromShell,$TM.randomDirection=this.randomDirection}}($TK),function($Tt){function $TM(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$TM.__super.call(this)}return $TI($TM,"laya.d3.core.render.SubMeshRenderElement",$Tg),$TM}()),$TiM=function($Tt){function $T_($Tt,$TM,$Tf,$Tc,$TD,$To){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$Tt,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$TIM.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$TRM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$TRM.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$TCM.SHADERDEFINE_ALPHATEST]="ALPHATEST";$T_.__super.call(this,$Tt,$TM,$Tf,null,{}),this._attributeMap=$Tc;var $TJ;for($TJ in $TD){var $TZ=$TD[$TJ];switch($TZ[1]){case 0:this._renderElementUniformMap[$TJ]=$TZ[0];break;case 1:this._materialUniformMap[$TJ]=$TZ[0];break;case 2:this._spriteUniformMap[$TJ]=$TZ[0];break;case 3:this._cameraUniformMap[$TJ]=$TZ[0];break;case 4:this._sceneUniformMap[$TJ]=$TZ[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$TI($T_,"laya.d3.shader.ShaderCompile3D",$TN);var $TM=$T_.prototype;return $TM._definesToNameDic=function($Tt,$TM){for(var $Tf={},$Tc=1,$TD=0;$TD<32&&!($Tt<($Tc=1<<$TD));$TD++)if($Tt&$Tc){var $To=$TM[$Tc];$To&&($Tf[$To]="")}return $Tf},$TM.withCompile=function($Tt,$TM,$Tf,$Tc){var $TD,$To,$TJ;if($To=this.sharders[$Tt])if($TJ=$To[$TM]){if($TD=$TJ[$Tf])return $TD}else $TJ=$To[$TM]=[];else $TJ=($To=this.sharders[$Tt]=[])[$TM]=[];var $TZ,$TA=this._definesToNameDic($Tt,$T_._globalInt2name),$TL=this._definesToNameDic($TM,this._spriteInt2name),$Tp=this._definesToNameDic($Tf,this._materialInt2name),$TB={},$Tb="";if($TA)for($TZ in $TA)$Tb+="#define "+$TZ+"\n",$TB[$TZ]=!0;if($TL)for($TZ in $TL)$Tb+="#define "+$TZ+"\n",$TB[$TZ]=!0;if($Tp)for($TZ in $Tp)$Tb+="#define "+$TZ+"\n",$TB[$TZ]=!0;var $TI=$TuM.nameKey.getName(this._name)+" compile ("+$Tt+","+$TM+","+$Tf+")",$Tq=this._VS.toscript($TB,[]),$Tl=this._PS.toscript($TB,[]);$TS.now();if($TD=$TuM.create($Tb+$Tq.join("\n"),$Tb+$Tl.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$Tc,$TI),$TJ[$Tf]=$TD,laya.d3.shader.ShaderCompile3D.debugMode)$TS.now();return $TD},$TM.precompileShaderWithShaderDefine=function($Tt,$TM,$Tf){this.withCompile($Tt,$TM,$Tf,!0)},$TM.addMaterialDefines=function($Tt){var $TM=$Tt.defines;for(var $Tf in $TM){var $Tc=$TM[$Tf],$TD=parseInt($Tf);this._materialInt2name[$TD]=$Tc,this._materialName2Int[$Tc]=$TD}},$TM.addSpriteDefines=function($Tt){var $TM=$Tt.defines;for(var $Tf in $TM){var $Tc=$TM[$Tf],$TD=parseInt($Tf);this._spriteInt2name[$TD]=$Tc,this._spriteName2Int[$Tc]=$TD}},$TM.getMaterialDefineByName=function($Tt){return this._materialName2Int[$Tt]},$TM.registerMaterialDefine=function($Tt){var $TM=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$TM]=$Tt,this._materialName2Int[$Tt]=$TM},$TM.registerSpriteDefine=function($Tt){var $TM=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$TM]=$Tt,this._spriteName2Int[$Tt]=$TM},$T_._globalRegDefine=function($Tt,$TM){$T_._globalInt2name[$TM]=$Tt},$T_.add=function($Tt,$TM,$Tf,$Tc,$TD){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Tt]=new $T_($Tt,$TM,$Tf,$Tc,$TD,$TN.includes)},$T_.get=function($Tt){return laya.d3.shader.ShaderCompile3D._preCompileShader[$TuM.nameKey.getID($Tt)]},$T_._preCompileShader={},$T_._globalInt2name=[],$T_.debugMode=!1,$T_.SHADERDEFINE_HIGHPRECISION=1,$T_.SHADERDEFINE_FOG=4,$T_.SHADERDEFINE_DIRECTIONLIGHT=8,$T_.SHADERDEFINE_POINTLIGHT=16,$T_.SHADERDEFINE_SPOTLIGHT=32,$T_.SHADERDEFINE_UV0=64,$T_.SHADERDEFINE_COLOR=128,$T_.SHADERDEFINE_UV1=256,$T_.SAHDERDEFINE_DEPTHFOG=131072,$T_}(),$TVM=function($Tt){function $Tq(){$Tq.__super.call(this)}$TI($Tq,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$Tct);var $TM=$Tq.prototype;return $TM._getStaticBatch=function($Tt,$TM,$Tf,$Tc){var $TD,$To;return $To=$Tt?$Tt.id.toString()+$Tf.id.toString()+$TM.id.toString()+$Tc.toString():$Tf.id.toString()+$TM.id.toString()+$Tc.toString(),this._staticBatches[$To]?$TD=this._staticBatches[$To]:this._staticBatches[$To]=$TD=new $TxM($To,this,$Tt,$TM,$Tf),$TD},$TM._initStaticBatchs=function($Tt){var $TM,$Tf;this._initBatchRenderElements.sort($Tq._sortPrepareStaticBatch);for(var $Tc,$TD=!1,$To=0,$TJ=0,$TZ=this._initBatchRenderElements.length;$TJ<$TZ;$TJ++){var $TA,$TL=this._initBatchRenderElements[$TJ],$Tp=$TL.renderObj._getVertexBuffer(0);$TL._sprite3D;if($Tf===$Tp.vertexDeclaration&&$TM===$TL._material)if($TD)$Tc._addCombineBatchRenderObjTest($TL)?($TA=$TL._staticBatch)!==$Tc&&($TA&&$TA._deleteCombineBatchRenderObj($TL),$Tc._addCombineBatchRenderObj($TL)):($TD=!1,$To++);else{var $TB=this._initBatchRenderElements[$TJ-1],$Tb=$TB.renderObj,$TI=$TL.renderObj;$TD=!(65535<$Tb._getVertexBuffer().vertexCount+$TI._getVertexBuffer().vertexCount)&&($Tc=this._getStaticBatch($Tt,$Tf,$TM,$To),($TA=$TB._staticBatch)!==$Tc&&($TA&&$TA._deleteCombineBatchRenderObj($TB),$Tc._addCombineBatchRenderObj($TB)),($TA=$TL._staticBatch)!==$Tc&&($TA&&$TA._deleteCombineBatchRenderObj($TL),$Tc._addCombineBatchRenderObj($TL)),!0)}else $TD=!1,$To=0;$TM=$TL._material,$Tf=$Tp.vertexDeclaration}},$Tq._sortPrepareStaticBatch=function($Tt,$TM){var $Tf=$Tt._render,$Tc=$TM._render,$TD=$Tf.lightmapIndex-$Tc.lightmapIndex;if(0!=$TD)return $TD;var $To=$Tf.receiveShadow-$Tc.receiveShadow;if(0!=$To)return $To;var $TJ=$Tt._mainSortID-$TM._mainSortID;return 0==$TJ?$Tt.renderObj.triangleCount-$TM.renderObj.triangleCount:$TJ},$Tq}(),$TxM=function($Tt){function $To($Tt,$TM,$Tf,$Tc,$TD){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$To.__super.call(this,$Tt,$TM,$Tf),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$Tc,this._material=$TD}$TI($To,"laya.d3.graphics.SubMeshStaticBatch",$TDt);var $TM=$To.prototype;return $TM._compareBatchRenderElement=function($Tt,$TM){return $Tt._batchIndexStart>$TM._batchIndexStart},$TM._addCombineBatchRenderObjTest=function($Tt){var $TM=$Tt.renderObj._vertexCount;return!(65535<(0<$TM?this._currentCombineVertexCount+$TM:this._currentCombineVertexCount+$Tt.renderObj._getVertexBuffer().vertexCount))},$TM._addCombineBatchRenderObj=function($Tt){var $TM=$Tt.renderObj,$Tf=$TM._vertexCount;this._initBatchRenderElements.push($Tt),$Tt._staticBatch=this,0<$Tf?(this._currentCombineIndexCount+=$TM._indexCount,this._currentCombineVertexCount+=$Tf):(this._currentCombineIndexCount=this._currentCombineIndexCount+$TM._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$TM._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$TM._deleteCombineBatchRenderObj=function($Tt){var $TM=$Tt.renderObj,$Tf=this._initBatchRenderElements.indexOf($Tt);if(-1!==$Tf){this._initBatchRenderElements.splice($Tf,1),$Tt._staticBatch=null;var $Tc=$TM._vertexCount;0<$Tc?(this._currentCombineIndexCount=this._currentCombineIndexCount-$TM._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$Tc):(this._currentCombineIndexCount=this._currentCombineIndexCount-$TM._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$TM._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$TM._finishInit=function(){if(this._needFinishCombine){var $Tt=0,$TM=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $Tf=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$Tc=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$TKM.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$TkM.create("ushort",this._currentCombineIndexCount,35044);for(var $TD=0,$To=this._initBatchRenderElements.length;$TD<$To;$TD++){var $TJ=this._initBatchRenderElements[$TD],$TZ=$TJ.renderObj,$TA=$TZ._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$TJ._sprite3D),$TL=$TZ.getIndices(),$Tp=$TJ._sprite3D.transform._isFrontFaceInvert,$TB=$Tt/(this._vertexDeclaration.vertexStride/4)-$TZ._vertexStart,$Tb=$TM,$TI=$Tb+$TL.length;$TJ._batchIndexStart=$Tb,$TJ._batchIndexEnd=$TI,$Tc.set($TL,$TM);var $Tq=0;if($Tp)for($Tq=$Tb;$Tq<$TI;$Tq+=3){$Tc[$Tq]=$TB+$Tc[$Tq];var $Tl=$Tc[$Tq+1],$T_=$Tc[$Tq+2];$Tc[$Tq+1]=$TB+$T_,$Tc[$Tq+2]=$TB+$Tl}else for($Tq=$Tb;$Tq<$TI;$Tq+=3)$Tc[$Tq]=$TB+$Tc[$Tq],$Tc[$Tq+1]=$TB+$Tc[$Tq+1],$Tc[$Tq+2]=$TB+$Tc[$Tq+2];$TM+=$TL.length,$Tf.set($TA,$Tt),$Tt+=$TA.length}this._vertexBuffer.setData($Tf),this._indexBuffer.setData($Tc),this._needFinishCombine=!1}},$TM._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $TTM)},$TM._getRenderElement=function($Tt,$TM,$Tf){for(var $Tc,$TD,$To=this._batchRenderElements.length,$TJ=!0,$TZ=0;$TZ<$To;$TZ++){var $TA,$TL,$Tp=($TD=this._batchRenderElements[$TZ])._sprite3D._render;if(0!==$TZ&&($TJ=($TA=($Tc=this._batchRenderElements[$TZ-1])._sprite3D._render).lightmapIndex!==$Tp.lightmapIndex||$TA.receiveShadow!==$Tp.receiveShadow||$Tc._batchIndexEnd!==$TD._batchIndexStart),$TJ){($TL=this._getCombineRenderElementFromPool()).renderObj=this,$TL._material=this._material,$TL._batchIndexStart=$TD._batchIndexStart,$TL._batchIndexEnd=$TD._batchIndexEnd;var $TB=$Tp.lightmapIndex,$Tb=$TB+1,$TI=this._batchOwnerIndices[$Tb];$TI||($TI=this._batchOwnerIndices[$Tb]=[]);var $Tq,$Tl=$TI[$TD._render.receiveShadow?1:0];void 0===$Tl?($TI[$Tp.receiveShadow?1:0]=this._batchOwners.length,($Tq=new $TzM(null,"StaticBatchMeshSprite3D"))._scene=$TM,$Tq._transform=this._rootOwner?this._rootOwner._transform:null,$Tq._render.lightmapIndex=$TB,$Tq._render.receiveShadow=$TD._render.receiveShadow,this._batchOwners.push($Tq)):$Tq=this._batchOwners[$Tl],$Tq._render._renderUpdate($Tf),$TL._sprite3D=$Tq,$Tt.push($TL)}else $TL._batchIndexEnd=$TD._batchIndexEnd}},$TM._beforeRender=function($Tt){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$TM._render=function($Tt){var $TM=$Tt.renderElement,$Tf=$TM._batchIndexStart,$Tc=$TM._batchIndexEnd-$Tf;$TU.mainContext.drawElements(4,$Tc,5123,2*$Tf),$Ti.drawCall++,$Ti.trianglesFaces+=$Tc/3},$TM.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$TM._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),this._vertexBuffer},$To}(),$TOM=function($Tt){function $TM(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$TM.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$TI($TM,"laya.d3.core.ComponentNode",$TL);var $Tf=$TM.prototype;return $Tf.addComponent=function($Tt){var $TM,$Tf=this._componentsMap.indexOf($Tt);if(-1===$Tf)$TM=[],this._componentsMap.push($Tt),this._typeComponentsIndices.push($TM);else if($TM=this._typeComponentsIndices[$Tf],this._components[$TM[0]].isSingleton)throw new Error("无法单实例创建"+$Tt+"组件，"+$Tt+"组件已存在！");var $Tc=$TD.getInstance($Tt);return $TM.push(this._components.length),this._components.push($Tc),$Tc instanceof laya.d3.component.Script&&this._scripts.push($Tc),$Tc._initialize(this),$Tc},$Tf._removeComponent=function($Tt,$TM){var $Tf=this._typeComponentsIndices[$Tt],$Tc=$Tf[$TM],$TD=this._components[$Tc];this._components.splice($Tc,1),$TD instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($TD),1),$Tf.splice($TM,1),0===$Tf.length&&(this._typeComponentsIndices.splice($Tt,1),this._componentsMap.splice($Tt,1));for(var $To=0,$TJ=this._componentsMap.length;$To<$TJ;$To++)for(var $TZ=($Tf=this._typeComponentsIndices[$To]).length-1;0<=$TZ;$TZ--){var $TA=$Tf[$TZ];if(!($Tc<$TA))break;$Tf[$TZ]=--$TA}$TD._destroy()},$Tf.getComponentByType=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf=this._componentsMap.indexOf($Tt);return-1===$Tf?null:this._components[this._typeComponentsIndices[$Tf][$TM]]},$Tf.getComponentsByType=function($Tt,$TM){var $Tf=this._componentsMap.indexOf($Tt);if(-1!==$Tf){var $Tc=this._typeComponentsIndices[$Tf],$TD=$Tc.length;$TM.length=$TD;for(var $To=0;$To<$TD;$To++)$TM[$To]=this._components[$Tc[$To]]}else $TM.length=0},$Tf.getComponentByIndex=function($Tt){return this._components[$Tt]},$Tf.removeComponentByType=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf=this._componentsMap.indexOf($Tt);-1!==$Tf&&this._removeComponent($Tf,$TM)},$Tf.removeComponentsByType=function($Tt){var $TM=this._componentsMap.indexOf($Tt);if(-1!==$TM)for(var $Tf=this._typeComponentsIndices[$TM],$Tc=0,$TD=$Tf.length;$Tc<$TD;$Tf.length<$TD?$TD--:$Tc++)this._removeComponent($TM,$Tc)},$Tf.removeAllComponent=function(){for(var $Tt=0,$TM=this._componentsMap.length;$Tt<$TM;this._componentsMap.length<$TM?$TM--:$Tt++)this.removeComponentsByType(this._componentsMap[$Tt])},$Tf._updateComponents=function($Tt){for(var $TM=0,$Tf=this._components.length;$TM<$Tf;$TM++){var $Tc=this._components[$TM];!$Tc.started&&($Tc._start($Tt),$Tc.started=!0),$Tc.enable&&$Tc._update($Tt)}},$Tf._lateUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._lateUpdate($Tt)}},$Tf._preRenderUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._preRenderUpdate($Tt)}},$Tf._postRenderUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._postRenderUpdate($Tt)}},$TM}(),$TCM=function($Tc){function $Tt(){$Tt.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $TbM,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $TZM(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$TI($Tt,"laya.d3.core.material.BaseMaterial",$Tc);var $TM=$Tt.prototype;return $Ty.imps($TM,{"laya.d3.core.IClone":!0}),$TM._addShaderDefine=function($Tt){this._shaderDefineValue|=$Tt},$TM._removeShaderDefine=function($Tt){this._shaderDefineValue&=~$Tt},$TM._addDisablePublicShaderDefine=function($Tt){this._disablePublicShaderDefine|=$Tt},$TM._removeDisablePublicShaderDefine=function($Tt){this._disablePublicShaderDefine&=~$Tt},$TM._setBuffer=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM),this._values[$Tt]=$TM},$TM._getBuffer=function($Tt){return this._values[$Tt]},$TM._setMatrix4x4=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM?$TM.elements:null),this._values[$Tt]=$TM},$TM._getMatrix4x4=function($Tt){return this._values[$Tt]},$TM._setInt=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM),this._values[$Tt]=$TM},$TM._getInt=function($Tt){return this._values[$Tt]},$TM._setNumber=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM),this._values[$Tt]=$TM},$TM._getNumber=function($Tt){return this._values[$Tt]},$TM._setBool=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM),this._values[$Tt]=$TM},$TM._getBool=function($Tt){return this._values[$Tt]},$TM._setVector2=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM?$TM.elements:null),this._values[$Tt]=$TM},$TM._getVector2=function($Tt){return this._values[$Tt]},$TM._setColor=function($Tt,$TM){this._shaderValues.setValue($Tt,$TM?$TM.elements:null),this._values[$Tt]=$TM},$TM._getColor=function($Tt){return this._values[$Tt]},$TM._setTexture=function($Tt,$TM){var $Tf=this._values[$Tt];this._values[$Tt]=$TM,this._shaderValues.setValue($Tt,$TM),0<this.referenceCount&&($Tf&&$Tf._removeReference(),$TM&&$TM._addReference())},$TM._getTexture=function($Tt){return this._values[$Tt]},$TM._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$TM._getShader=function($Tt,$TM,$Tf){var $Tc=($Tt|$TM)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($Tc,$Tf,this._shaderDefineValue),this._shader},$TM._setRenderStateBlendDepth=function(){var $Tt=$TU.mainContext;switch($TF.setDepthMask($Tt,this.depthWrite),0===this.depthTest?$TF.setDepthTest($Tt,!1):($TF.setDepthTest($Tt,!0),$TF.setDepthFunc($Tt,this.depthTest)),this.blend){case 0:$TF.setBlend($Tt,!1);break;case 1:$TF.setBlend($Tt,!0),$TF.setBlendFunc($Tt,this.srcBlend,this.dstBlend);break;case 2:$TF.setBlend($Tt,!0)}},$TM._setRenderStateFrontFace=function($Tt,$TM){var $Tf=$TU.mainContext,$Tc=0;switch(this.cull){case 0:$TF.setCullFace($Tf,!1);break;case 1:$TF.setCullFace($Tf,!0),$Tc=$Tt?$TM&&$TM._isFrontFaceInvert?2305:2304:$TM&&$TM._isFrontFaceInvert?2304:2305,$TF.setFrontFace($Tf,$Tc);break;case 2:$TF.setCullFace($Tf,!0),$Tc=$Tt?$TM&&$TM._isFrontFaceInvert?2304:2305:$TM&&$TM._isFrontFaceInvert?2305:2304,$TF.setFrontFace($Tf,$Tc)}},$TM.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=$TM[0],$TD=$TM[1];switch($Tc.version){case"LAYAMATERIAL:01":var $To=0,$TJ=0,$TZ=$Tc.props;for(var $TA in $TZ)switch($TA){case"vectors":var $TL=$TZ[$TA];for($To=0,$TJ=$TL.length;$To<$TJ;$To++){var $Tp=$TL[$To],$TB=$Tp.value;switch($TB.length){case 2:this[$Tp.name]=new $ToM($TB[0],$TB[1]);break;case 3:this[$Tp.name]=new $TJM($TB[0],$TB[1],$TB[2]);break;case 4:this[$Tp.name]=new $TZM($TB[0],$TB[1],$TB[2],$TB[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $Tb=$TZ[$TA];for($To=0,$TJ=$Tb.length;$To<$TJ;$To++){var $TI=$Tb[$To],$Tq=$TI.path;$Tq&&(this[$TI.name]=$TE.getRes($TD[$Tq]))}break;case"defines":var $Tl=$TZ[$TA];for($To=0,$TJ=$Tl.length;$To<$TJ;$To++){var $T_=this._shaderCompile.getMaterialDefineByName($Tl[$To]);this._addShaderDefine($T_)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$TA]=$TZ[$TA];break;case"renderQueue":switch($TZ[$TA]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$TA]=$TZ[$TA]}break;case"LAYAMATERIAL:02":for($TA in $TZ=$Tc.props)switch($TA){case"vectors":for($To=0,$TJ=($TL=$TZ[$TA]).length;$To<$TJ;$To++)switch(($TB=($Tp=$TL[$To]).value).length){case 2:this[$Tp.name]=new $ToM($TB[0],$TB[1]);break;case 3:this[$Tp.name]=new $TJM($TB[0],$TB[1],$TB[2]);break;case 4:this[$Tp.name]=new $TZM($TB[0],$TB[1],$TB[2],$TB[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($To=0,$TJ=($Tb=$TZ[$TA]).length;$To<$TJ;$To++)($Tq=($TI=$Tb[$To]).path)&&(this[$TI.name]=$TE.getRes($TD[$Tq]));break;case"defines":for($To=0,$TJ=($Tl=$TZ[$TA]).length;$To<$TJ;$To++)$T_=this._shaderCompile.getMaterialDefineByName($Tl[$To]),this._addShaderDefine($T_);break;default:this[$TA]=$TZ[$TA]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$TM._addReference=function(){$Tc.prototype._addReference.call(this);for(var $Tt=0,$TM=this._values.length;$Tt<$TM;$Tt++){var $Tf=this._values[$Tt];$Tf&&$Tf instanceof laya.d3.resource.BaseTexture&&$Tf._addReference()}},$TM._removeReference=function(){$Tc.prototype._removeReference.call(this);for(var $Tt=0,$TM=this._values.length;$Tt<$TM;$Tt++){var $Tf=this._values[$Tt];$Tf&&$Tf instanceof laya.d3.resource.BaseTexture&&$Tf._removeReference()}},$TM.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$TM.setShaderName=function($Tt){var $TM=$TuM.nameKey.getID($Tt);if(-1===$TM)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$TiM._preCompileShader[$TM]},$TM.cloneTo=function($Tt){var $TM=$Tt;$TM.name=this.name,$TM.cull=this.cull,$TM.blend=this.blend,$TM.srcBlend=this.srcBlend,$TM.dstBlend=this.dstBlend,$TM.srcBlendRGB=this.srcBlendRGB,$TM.dstBlendRGB=this.dstBlendRGB,$TM.srcBlendAlpha=this.srcBlendAlpha,$TM.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($TM.blendConstColor),$TM.blendEquation=this.blendEquation,$TM.blendEquationRGB=this.blendEquationRGB,$TM.blendEquationAlpha=this.blendEquationAlpha,$TM.depthTest=this.depthTest,$TM.depthWrite=this.depthWrite,$TM.renderQueue=this.renderQueue,$TM._shader=this._shader,$TM._disablePublicShaderDefine=this._disablePublicShaderDefine,$TM._shaderDefineValue=this._shaderDefineValue;var $Tf,$Tc=0,$TD=$TM._shaderValues;$TM._shaderValues.data.length=this._shaderValues.data.length;var $To=this._values.length,$TJ=$TM._values;for($Tc=0,$Tf=$TJ.length=$To;$Tc<$Tf;$Tc++){var $TZ=this._values[$Tc];if($TZ)if("number"==typeof $TZ)$TJ[$Tc]=$TZ,$TD.data[$Tc]=$TZ;else if("number"==typeof $TZ&&Math.floor($TZ)==$TZ)$TJ[$Tc]=$TZ,$TD.data[$Tc]=$TZ;else if("boolean"==typeof $TZ)$TJ[$Tc]=$TZ,$TD.data[$Tc]=$TZ;else if($TZ instanceof laya.d3.math.Vector2){var $TA=$TJ[$Tc]||($TJ[$Tc]=new $ToM);$TZ.cloneTo($TA),$TD.data[$Tc]=$TA.elements}else if($TZ instanceof laya.d3.math.Vector3){var $TL=$TJ[$Tc]||($TJ[$Tc]=new $TJM);$TZ.cloneTo($TL),$TD.data[$Tc]=$TL.elements}else if($TZ instanceof laya.d3.math.Vector4){var $Tp=$TJ[$Tc]||($TJ[$Tc]=new $TZM);$TZ.cloneTo($Tp),$TD.data[$Tc]=$Tp.elements}else if($TZ instanceof laya.d3.math.Matrix4x4){var $TB=$TJ[$Tc]||($TJ[$Tc]=new $TtM);$TZ.cloneTo($TB),$TD.data[$Tc]=$TB.elements}else $TZ instanceof laya.d3.resource.BaseTexture&&($TJ[$Tc]=$TZ,$TD.data[$Tc]=$TZ)}},$TM.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tq(0,$TM,"alphaTestValue",function(){return this._getNumber(0)},function($Tt){this._setNumber(0,$Tt)}),$Tq(0,$TM,"alphaTest",function(){return this._alphaTest},function($Tt){(this._alphaTest=$Tt)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$Tt.__init__=function(){$Tt.SHADERDEFINE_ALPHATEST=$Tt.shaderDefines.registerDefine("ALPHATEST")},$Tt.RENDERQUEUE_OPAQUE=2e3,$Tt.RENDERQUEUE_ALPHATEST=2450,$Tt.RENDERQUEUE_TRANSPARENT=3e3,$Tt.CULL_NONE=0,$Tt.CULL_FRONT=1,$Tt.CULL_BACK=2,$Tt.BLEND_DISABLE=0,$Tt.BLEND_ENABLE_ALL=1,$Tt.BLEND_ENABLE_SEPERATE=2,$Tt.BLENDPARAM_ZERO=0,$Tt.BLENDPARAM_ONE=1,$Tt.BLENDPARAM_SRC_COLOR=768,$Tt.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$Tt.BLENDPARAM_DST_COLOR=774,$Tt.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$Tt.BLENDPARAM_SRC_ALPHA=770,$Tt.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$Tt.BLENDPARAM_DST_ALPHA=772,$Tt.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$Tt.BLENDPARAM_SRC_ALPHA_SATURATE=776,$Tt.BLENDEQUATION_ADD=0,$Tt.BLENDEQUATION_SUBTRACT=1,$Tt.BLENDEQUATION_REVERSE_SUBTRACT=2,$Tt.DEPTHTEST_OFF=0,$Tt.DEPTHTEST_NEVER=512,$Tt.DEPTHTEST_LESS=513,$Tt.DEPTHTEST_EQUAL=514,$Tt.DEPTHTEST_LEQUAL=515,$Tt.DEPTHTEST_GREATER=516,$Tt.DEPTHTEST_NOTEQUAL=517,$Tt.DEPTHTEST_GEQUAL=518,$Tt.DEPTHTEST_ALWAYS=519,$Tt.SHADERDEFINE_ALPHATEST=1,$Tt.ALPHATESTVALUE=0,$TB($Tt,["shaderDefines",function(){return this.shaderDefines=new $TpM}]),$Tt}($T_),$TUM=function($Tt){function $TM(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$TM.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$TI($TM,"laya.d3.resource.BaseTexture",$T_);var $Tf=$TM.prototype;return $Tq(0,$Tf,"width",function(){return this._width}),$Tq(0,$Tf,"repeat",function(){return this._repeat},function($Tt){if(this._repeat!==$Tt&&(this._repeat=$Tt,this._source)){var $TM=$TU.mainContext;$TF.bindTexture($TM,this._type,this._source),$TX.isPOT(this._width,this._height)&&this._repeat?($TM.texParameteri(this._type,10242,10497),$TM.texParameteri(this._type,10243,10497)):($TM.texParameteri(this._type,10242,33071),$TM.texParameteri(this._type,10243,33071))}}),$Tq(0,$Tf,"height",function(){return this._height}),$Tq(0,$Tf,"magFifter",function(){return this._magFifter},function($Tt){(this._magFifter=$Tt)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($Tt)}),$Tq(0,$Tf,"wrapModeV",function(){return this._wrapModeV}),$Tq(0,$Tf,"size",function(){return this._size}),$Tq(0,$Tf,"wrapModeU",function(){return this._wrapModeU}),$Tq(0,$Tf,"mipmap",function(){return this._mipmap},function($Tt){this._mipmap=$Tt,this._mipmap!=$Tt&&this._conchTexture&&this._conchTexture.setMipMap($Tt)}),$Tq(0,$Tf,"minFifter",function(){return this._minFifter},function($Tt){this._minFifter=$Tt,this._minFifter!=$Tt&&this._conchTexture&&this._conchTexture.setMinFifter($Tt)}),$Tq(0,$Tf,"format",function(){return this._format}),$Tq(0,$Tf,"source",function(){return this.activeResource(),this._source}),$Tq(0,$Tf,"defaulteTexture",function(){return $TPM.grayTexture}),$TM.WARPMODE_REPEAT=0,$TM.WARPMODE_CLAMP=1,$TM}(),$TFM=function($Tt){function $TM(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$TM.__super.call(this),this._boundingBoxCorners=$Tc(8,null)}$TI($TM,"laya.d3.resource.models.BaseMesh",$T_);var $Tf=$TM.prototype;return $Tf._getPositions=function(){throw new Error("未Override,请重载该属性！")},$Tf._generateBoundingObject=function(){this._boundingSphere=new $TQt(new $TJM,0),$TQt.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $TGt(new $TJM,new $TJM),$TGt.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$Tf.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$Tf.getRenderElement=function($Tt){throw new Error("未Override,请重载该属性！")},$Tq(0,$Tf,"subMeshCount",function(){return this._subMeshCount}),$Tq(0,$Tf,"boundingBox",function(){return this._boundingBox}),$Tq(0,$Tf,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$Tq(0,$Tf,"boundingSphere",function(){return this._boundingSphere}),$TM}(),$TSM=(function($Tt){function $TM(){$TM.__super.call(this)}$TI($TM,"laya.d3.component.Script",$TNM);var $Tf=$TM.prototype;$Tf.onTriggerEnter=function($Tt){},$Tf.onTriggerExit=function($Tt){},$Tf.onTriggerStay=function($Tt){},$Tq(0,$Tf,"isSingleton",function(){return $TM._isSingleton}),$TM._isSingleton=!1}(),function($Tt){function $TM($Tt){this._owner=null,this._sharedMesh=null,$TM.__super.call(this),this._owner=$Tt}$TI($TM,"laya.d3.core.MeshFilter",$Tt);var $Tf=$TM.prototype;return $Tf._sharedMeshLoaded=function(){this.event("loaded")},$Tf._destroy=function(){$Tt.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$Tq(0,$Tf,"sharedMesh",function(){return this._sharedMesh},function($Tt){var $TM=this._sharedMesh;$TM&&$TM._removeReference(),(this._sharedMesh=$Tt)._addReference(),this.event("meshchanged",[this,$TM,$Tt]),$Tt.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$Tq(0,$Tf,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$Tq(0,$Tf,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$Tq(0,$Tf,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$Tq(0,$Tf,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$TM}($TXM)),$THM=function($Tt){function $TM($Tt){$TM.__super.call(this,$Tt),$Tt.meshFilter.on("meshchanged",this,this._onMeshChanged)}$TI($TM,"laya.d3.core.MeshRender",$TyM);var $Tf=$TM.prototype;return $Tf._onMeshChanged=function($Tt,$TM,$Tf){$Tf.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$Tf.once("loaded",this,this._onMeshLoaed)},$Tf._onMeshLoaed=function($Tt,$TM){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$Tf._calculateBoundingSphereByInitSphere=function($Tt){var $TM=NaN,$Tf=this._owner.transform,$Tc=$Tf.scale.elements,$TD=Math.abs($Tc[0]),$To=Math.abs($Tc[1]),$TJ=Math.abs($Tc[2]);$TM=$To<=$TD&&$TJ<=$TD?$TD:$TJ<=$To?$To:$TJ,$TJM.transformCoordinate($Tt.center,$Tf.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$Tt.radius*$TM},$Tf._calculateBoundBoxByInitCorners=function($Tt){for(var $TM=this._owner.transform.worldMatrix,$Tf=0;$Tf<8;$Tf++)$TJM.transformCoordinate($Tt[$Tf],$TM,$TyM._tempBoundBoxCorners[$Tf]);$TGt.createfromPoints($TyM._tempBoundBoxCorners,this._boundingBox)},$Tf._calculateBoundingSphere=function(){var $Tt=this._owner.meshFilter.sharedMesh;null==$Tt||null==$Tt.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($Tt.boundingSphere)},$Tf._calculateBoundingBox=function(){var $Tt=this._owner.meshFilter.sharedMesh;null==$Tt||null==$Tt.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($Tt.boundingBoxCorners)},$Tf._renderUpdate=function($Tt){var $TM=this._owner.transform;if($TM){this._setShaderValueMatrix4x4(0,$TM.worldMatrix);var $Tf=this._owner.getProjectionViewWorldMatrix($Tt);this._setShaderValueMatrix4x4(1,$Tf)}else this._setShaderValueMatrix4x4(0,$TtM.DEFAULT),this._setShaderValueMatrix4x4(1,$Tt);return $TEM.debugMode&&this._renderRenderableBoundBox(),!0},$TM}(),$TsM=function($TM){function $Tc(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$Tc.__super.call(this),this._renderState=new $Tm,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $TbM,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $TMt,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $TJM(.7,.7,.7),this.ambientColor=new $TJM(.212,.227,.259),$TU.shaderHighPrecision&&this.addShaderDefine($TiM.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$TI($Tc,"laya.d3.core.scene.Scene",$TM);var $Tt=$Tc.prototype;return $Ty.imps($Tt,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$Tt._setUrl=function($Tt){this._url=$Tt},$Tt._getGroup=function(){return this._group},$Tt._setGroup=function($Tt){this._group=$Tt},$Tt._display=function(){$Ty.stage._scenes.push(this),$Ty.stage._scenes.sort($Tc._sortScenes);for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++){var $Tf=this._childs[$Tt];$Tf.active&&$Tf._activeHierarchy()}},$Tt._unDisplay=function(){var $Tt=$Ty.stage._scenes;$Tt.splice($Tt.indexOf(this),1);for(var $TM=0,$Tf=this._childs.length;$TM<$Tf;$TM++){var $Tc=this._childs[$TM];$Tc.active&&$Tc._inActiveHierarchy()}},$Tt._addChild3D=function($Tt){$Tt.transform._onWorldTransform(),$Tt._setBelongScene(this),this.displayedInStage&&$Tt.active&&$Tt._activeHierarchy()},$Tt._removeChild3D=function($Tt){$Tt.transform.parent=null,this.displayedInStage&&$Tt.active&&$Tt._inActiveHierarchy(),$Tt._setUnBelongScene()},$Tt.initOctree=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$TD&&($TD=6),this.treeSize=new $TJM($Tt,$TM,$Tf),this.treeLevel=$TD,this.treeRoot=new $TG(this,0),this.treeRoot.init($Tc,this.treeSize)},$Tt._prepareUpdateToRenderState=function($Tt,$TM){$TM.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$TM.scene=this},$Tt._prepareSceneToRender=function($Tt){var $TM=this._lights.length;if(0<$TM)for(var $Tf=0,$Tc=0;$Tc<$TM&&!(this._lights[$Tc]._prepareToScene($Tt)&&++$Tf>=this._enableLightCount);$Tc++);},$Tt._updateChilds=function($Tt){for(var $TM=0,$Tf=this._childs.length;$TM<$Tf;++$TM)this._childs[$TM]._update($Tt)},$Tt._preRenderScene=function($Tt,$TM,$Tf){var $Tc,$TD=$TM._viewMatrix,$To=$TM._projectionMatrix,$TJ=$TM._projectionViewMatrix,$TZ=0,$TA=$TM.camera;for($TA.useOcclusionCulling?this.treeRoot?$Tft.renderObjectCullingOctree($Tf,this,$TA,$TD,$To,$TJ):$Tft.renderObjectCulling($Tf,this,$TA,$TD,$To,$TJ):$Tft.renderObjectCullingNoBoundFrustum(this,$TA,$TD,$To,$TJ),$TZ=0,$Tc=this._quenes.length;$TZ<$Tc;$TZ++)this._quenes[$TZ]&&this._quenes[$TZ]._preRender($TM)},$Tt._clear=function($Tt,$TM){var $Tf=$TM._viewport,$Tc=$TM.camera,$TD=$Tf.x,$To=$Tc.renderTargetSize.height-$Tf.y-$Tf.height,$TJ=$Tf.width,$TZ=$Tf.height;$Tt.viewport($TD,$To,$TJ,$TZ);var $TA=256,$TL=$Tc.renderTarget;switch($Tc.clearFlag){case 0:var $Tp=$Tc.clearColor;if($Tp){$Tt.enable(3089),$Tt.scissor($TD,$To,$TJ,$TZ);var $TB=$Tp.elements;$Tt.clearColor($TB[0],$TB[1],$TB[2],$TB[3]),$TA|=16384}if($TL)switch($Tp||($TA=16384),$TL.depthStencilFormat){case 33189:$TA|=256;break;case 36168:$TA|=1024;break;case 34041:$TA|=256,$TA|=1024}$Tt.clear($TA),$Tp&&$Tt.disable(3089);break;case 1:case 2:if($TL)switch($TA=16384,$TL.depthStencilFormat){case 33189:$TA|=256;break;case 36168:$TA|=1024;break;case 34041:$TA|=256,$TA|=1024}$Tt.clear($TA);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$Tt._renderScene=function($Tt,$TM){var $Tf,$Tc,$TD=$TM.camera,$To=0;for($To=0;$To<2;$To++)($Tc=this._quenes[$To])&&($TD.renderTarget?$Tc._render($TM,!0):$Tc._render($TM,!1));if(1===$TD.clearFlag){var $TJ=$TD.sky;$TJ&&($TF.setCullFace($Tt,!1),$TF.setDepthFunc($Tt,515),$TF.setDepthMask($Tt,!1),$TJ._render($TM),$TF.setDepthFunc($Tt,513),$TF.setDepthMask($Tt,!0))}for($To=2,$Tf=this._quenes.length;$To<$Tf;$To++)($Tc=this._quenes[$To])&&($Tc._sortAlpha($TM.camera.transform.position),$TD.renderTarget?$Tc._render($TM,!0):$Tc._render($TM,!1))},$Tt._set3DRenderConfig=function($Tt){$Tt.disable(3042),$TF._blend=!1,$Tt.blendFunc(770,771),$TF._sFactor=770,$TF._dFactor=771,$Tt.disable(2929),$TF._depthTest=!1,$Tt.enable(2884),$TF._cullFace=!0,$Tt.depthMask(1),$TF._depthMask=!0,$Tt.frontFace(2304),$TF._frontFace=2304},$Tt._set2DRenderConfig=function($Tt){$TF.setBlend($Tt,!0),$TF.setBlendFunc($Tt,1,771),$TF.setDepthTest($Tt,!1),$TF.setCullFace($Tt,!1),$TF.setDepthMask($Tt,!0),$TF.setFrontFace($Tt,2305),$Tt.viewport(0,0,$Tp.width,$Tp.height)},$Tt._parseCustomProps=function($Tt,$TM,$Tf,$Tc){var $TD=$Tc.customProps.lightmaps,$To=$TD.length,$TJ=this._lightmaps;$TJ.length=$To;for(var $TZ=0;$TZ<$To;$TZ++)$TJ[$TZ]=$TE.getRes($TM[$TD[$TZ].replace(".exr",".png")]);this.setlightmaps($TJ);var $TA=$Tc.customProps.ambientColor;$TA&&(this.ambientColor=new $TJM($TA[0],$TA[1],$TA[2]));var $TL=$Tc.customProps.fogColor;$TL&&(this.fogColor=new $TJM($TL[0],$TL[1],$TL[2]))},$Tt._addLight=function($Tt){this._lights.indexOf($Tt)<0&&this._lights.push($Tt)},$Tt._removeLight=function($Tt){var $TM=this._lights.indexOf($Tt);0<=$TM&&this._lights.splice($TM,1)},$Tt._updateScene=function(){var $Tt=this._renderState;this._prepareUpdateToRenderState($TU.mainContext,$Tt),this._updateComponents($Tt),this._updateChilds($Tt),this._lateUpdateComponents($Tt),this._time+=$Tt.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$Tt._updateSceneConch=function(){var $Tt=this._renderState;this._prepareUpdateToRenderState($TU.mainContext,$Tt),this._updateComponents($Tt),this._lateUpdateComponents($Tt),this._prepareSceneToRender($Tt);for(var $TM=0,$Tf=this._cameraPool.length;$TM<$Tf;$TM++){var $Tc=this._cameraPool[$TM];($Tt.camera=$Tc)._prepareCameraToRender()}},$Tt._preRenderShadow=function($Tt,$TM,$Tf,$Tc,$TD){this.treeRoot?$Tft.renderShadowObjectCullingOctree(this,$TM,$Tf,$Tc,$TD):$Tft.renderShadowObjectCulling(this,$TM,$Tf,$Tc,$TD);for(var $To=0,$TJ=$Tf.length;$To<$TJ;$To++)$Tf[$To]&&$Tf[$To]._preRender($Tt)},$Tt._renderShadowMap=function($Tt,$TM,$Tf){var $Tc=this.parallelSplitShadowMaps[0];$Tc._calcAllLightCameraInfo($Tf);var $TD,$To,$TJ,$TZ=$Tc.PSSMNum;if(this._preRenderShadow($TM,$Tc._lightCulling,$Tc._shadowQuenes,$Tc._lightVPMatrix[0],$TZ),this.addShaderDefine($TIM.SHADERDEFINE_CAST_SHADOW),1<$TZ)for(var $TA=0;$TA<$TZ;$TA++)$TD=$Tc.getRenderTarget($TA+1),$Tc.beginRenderTarget($TA+1),$Tt.clearColor(1,1,1,1),$Tt.clear(16640),$Tt.viewport(0,0,$TD.width,$TD.height),$TM.camera=$TJ=$Tc.getLightCamera($TA),$TJ._prepareCameraToRender(),$TJ._prepareCameraViewProject($TJ.viewMatrix,$TJ.projectionMatrix),$TM._projectionViewMatrix=$Tc._lightVPMatrix[$TA+1],($To=$Tc._shadowQuenes[$TA])._preRender($TM),$To._renderShadow($TM,!1),$Tc.endRenderTarget($TA+1);else $TD=$Tc.getRenderTarget(1),$Tc.beginRenderTarget(1),$Tt.clearColor(1,1,1,1),$Tt.clear(16640),$Tt.viewport(0,0,$TD.width,$TD.height),$TM.camera=$TJ=$Tc.getLightCamera(0),$TJ._prepareCameraToRender(),$TJ._prepareCameraViewProject($TJ.viewMatrix,$TJ.projectionMatrix),$TM._projectionViewMatrix=$Tc._lightVPMatrix[0],($To=$Tc._shadowQuenes[0])._preRender($TM),$To._renderShadow($TM,!0),$Tc.endRenderTarget(1);this.removeShaderDefine($TIM.SHADERDEFINE_CAST_SHADOW)},$Tt.addTreeNode=function($Tt){this.treeRoot.addTreeNode($Tt)},$Tt.removeTreeNode=function($Tt){this.treeSize&&$Tt._treeNode&&$Tt._treeNode.removeObject($Tt)},$Tt.setlightmaps=function($Tt){this._lightmaps=$Tt;for(var $TM=0,$Tf=this._renderableSprite3Ds.length;$TM<$Tf;$TM++)this._renderableSprite3Ds[$TM]._render._applyLightMapParams()},$Tt.getlightmaps=function(){return this._lightmaps},$Tt.addChildAt=function($Tt,$TM){if(!($Tt instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($Tt&&$Tt.__className));if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),0<=$TM&&$TM<=this._childs.length){if($Tt._parent===this){var $Tf=this.getChildIndex($Tt);this._childs.splice($Tf,1),this._childs.splice($TM,0,$Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,$TM)),this._childChanged()}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TL.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($TM,0,$Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,$TM),($Tt.parent=this)._addChild3D($Tt);return $Tt}throw new Error("appendChildAt:The index is out of bounds")},$Tt.addChild=function($Tt){if(!($Tt instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),$Tt._parent===this){var $TM=this.getChildIndex($Tt);$TM!==this._childs.length-1&&(this._childs.splice($TM,1),this._childs.push($Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1)),this._childChanged())}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TL.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1),($Tt.parent=this)._childChanged(),this._addChild3D($Tt);return $Tt},$Tt.removeChildAt=function($Tt){var $TM=this.getChildAt($Tt);return $TM&&(this._removeChild3D($TM),this._childs.splice($Tt,1),this.conchModel&&this.conchModel.removeChild($TM.conchModel),$TM.parent=null),$TM},$Tt.removeChildren=function($Tt,$TM){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=2147483647),this._childs&&0<this._childs.length){var $Tf=this._childs;if(0===$Tt&&$To<=$TM){var $Tc=$Tf;this._childs=$TL.ARRAY_EMPTY}else $Tc=$Tf.splice($Tt,$TM-$Tt);for(var $TD=0,$To=$Tc.length;$TD<$To;$TD++)this._removeChild3D($Tc[$TD]),$Tc[$TD].parent=null,this.conchModel&&this.conchModel.removeChild($Tc[$TD].conchModel)}return this},$Tt.addFrustumCullingObject=function($Tt){this.treeRoot?this.addTreeNode($Tt):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($Tt):this._cullingRenders[this._cullingRendersLength]=$Tt,$Tt._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$Tt.removeFrustumCullingObject=function($Tt){if(this.treeRoot)this.removeTreeNode($Tt);else{this._cullingRendersLength--;var $TM=$Tt._indexInSceneFrustumCullingObjects;if($TM!==this._cullingRendersLength){var $Tf=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$TM]=$Tf)._indexInSceneFrustumCullingObjects=$TM,$Tt._indexInSceneFrustumCullingObjects=-1}}},$Tt.getRenderQueue=function($Tt){return $Tt<3e3?this._quenes[1]||(this._quenes[1]=new $Tz(this)):this._quenes[2]||(this._quenes[2]=new $Tz(this))},$Tt.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $Tz(this)},$Tt.addShaderDefine=function($Tt){this._shaderDefineValue|=$Tt},$Tt.removeShaderDefine=function($Tt){this._shaderDefineValue&=~$Tt},$Tt.addScript=function($Tt){return this._addComponent($Tt)},$Tt.getScriptByType=function($Tt,$TM){return void 0===$TM&&($TM=0),this._getComponentByType($Tt,$TM)},$Tt.getScriptsByType=function($Tt,$TM){this._getComponentsByType($Tt,$TM)},$Tt.getScriptByIndex=function($Tt){return this._getComponentByIndex($Tt)},$Tt.removeScriptByType=function($Tt,$TM){void 0===$TM&&($TM=0),this._removeComponentByType($Tt,$TM)},$Tt.removeScriptsByType=function($Tt){this._removeComponentByType($Tt)},$Tt.removeAllScript=function(){this._removeAllComponent()},$Tt.render=function($Tt,$TM,$Tf){($Tl._context.ctx._renderKey=0)<this._childs.length&&$Tt.addRenderObject(this)},$Tt.renderSubmit=function(){var $Tt=$TU.mainContext,$TM=this._renderState;this._set3DRenderConfig($Tt),this._prepareSceneToRender(this._renderState);var $Tf,$Tc=0,$TD=0;if($TEM.debugMode||$TG.debugMode)for($Tc=0,$TD=this._cameraPool.length;$Tc<$TD;$Tc++)$Tf=this._cameraPool[$Tc],$TEM._debugPhasorSprite.begin(1,$Tf),$Tf.activeInHierarchy&&$Tf._renderCamera($Tt,$TM,this),$TEM._debugPhasorSprite.end();else for($Tc=0,$TD=this._cameraPool.length;$Tc<$TD;$Tc++)($Tf=this._cameraPool[$Tc]).activeInHierarchy&&$Tf._renderCamera($Tt,$TM,this);return this._set2DRenderConfig($Tt),1},$Tt.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=$TM[0];if("Scene"!==$Tc.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $TD=$TM[1];$T_M._createNodeByJson(this,$Tc,this,$TD),this.event("hierarchyloaded",[this]),this.__loaded=!0},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this.destroyed||($TM.prototype.destroy.call(this,$Tt),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$TE.clearRes(this.url),this.loaded||$TEM._cancelLoadByUrl(this.url))},$Tt.getRenderType=function(){return 0},$Tt.releaseRender=function(){},$Tt._addComponent=function($Tt){var $TM,$Tf=this._componentsMap.indexOf($Tt);if(-1===$Tf)$TM=[],this._componentsMap.push($Tt),this._typeComponentsIndices.push($TM);else if($TM=this._typeComponentsIndices[$Tf],this._components[$TM[0]].isSingleton)throw new Error("无法单实例创建"+$Tt+"组件，"+$Tt+"组件已存在！");var $Tc=$TD.getInstance($Tt);$TM.push(this._components.length),this._components.push($Tc);return $Tc._initialize(this),$Tc},$Tt._removeComponent=function($Tt,$TM){var $Tf=this._typeComponentsIndices[$Tt],$Tc=$Tf[$TM],$TD=this._components[$Tc];this._components.splice($Tc,1),$Tf.splice($TM,1),0===$Tf.length&&(this._typeComponentsIndices.splice($Tt,1),this._componentsMap.splice($Tt,1));for(var $To=0,$TJ=this._componentsMap.length;$To<$TJ;$To++)for(var $TZ=($Tf=this._typeComponentsIndices[$To]).length-1;0<=$TZ;$TZ--){var $TA=$Tf[$TZ];if(!($Tc<$TA))break;$Tf[$TZ]=--$TA}$TD._destroy()},$Tt._getComponentByType=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf=this._componentsMap.indexOf($Tt);return-1===$Tf?null:this._components[this._typeComponentsIndices[$Tf][$TM]]},$Tt._getComponentsByType=function($Tt,$TM){var $Tf=this._componentsMap.indexOf($Tt);if(-1!==$Tf){var $Tc=this._typeComponentsIndices[$Tf],$TD=$Tc.length;$TM.length=$TD;for(var $To=0;$To<$TD;$To++)$TM[$To]=this._components[$Tc[$To]]}else $TM.length=0},$Tt._getComponentByIndex=function($Tt){return this._components[$Tt]},$Tt._removeComponentByType=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf=this._componentsMap.indexOf($Tt);-1!==$Tf&&this._removeComponent($Tf,$TM)},$Tt._removeComponentsByType=function($Tt){var $TM=this._componentsMap.indexOf($Tt);if(-1!==$TM)for(var $Tf=this._typeComponentsIndices[$TM],$Tc=0,$TD=$Tf.length;$Tc<$TD;$Tf.length<$TD?$TD--:$Tc++)this._removeComponent($TM,$Tc)},$Tt._removeAllComponent=function(){for(var $Tt=0,$TM=this._componentsMap.length;$Tt<$TM;this._componentsMap.length<$TM?$TM--:$Tt++)this._removeComponentsByType(this._componentsMap[$Tt])},$Tt._updateComponents=function($Tt){for(var $TM=0,$Tf=this._components.length;$TM<$Tf;$TM++){var $Tc=this._components[$TM];!$Tc.started&&($Tc._start($Tt),$Tc.started=!0),$Tc.enable&&$Tc._update($Tt)}},$Tt._lateUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._lateUpdate($Tt)}},$Tt._preRenderUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._preRenderUpdate($Tt)}},$Tt._postRenderUpdateComponents=function($Tt){for(var $TM=0;$TM<this._components.length;$TM++){var $Tf=this._components[$TM];!$Tf.started&&($Tf._start($Tt),$Tf.started=!0),$Tf.enable&&$Tf._postRenderUpdate($Tt)}},$Tq(0,$Tt,"_loaded",null,function($Tt){this.__loaded=$Tt}),$Tq(0,$Tt,"fogColor",function(){return this._fogColor},function($Tt){this._fogColor=$Tt,this._shaderValues.setValue(0,$Tt.elements)}),$Tq(0,$Tt,"enableFog",function(){return this._enableFog},function($Tt){this._enableFog!==$Tt&&((this._enableFog=$Tt)?(this.addShaderDefine($TiM.SHADERDEFINE_FOG),this.removeShaderDefine($TiM.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($TiM.SHADERDEFINE_FOG))}),$Tq(0,$Tt,"url",function(){return this._url}),$Tq(0,$Tt,"loaded",function(){return this.__loaded}),$Tq(0,$Tt,"enableDepthFog",function(){return this._enableDepthFog},function($Tt){this._enableDepthFog!=$Tt&&((this._enableDepthFog=$Tt)?(this.addShaderDefine($TiM.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($TiM.SHADERDEFINE_FOG)):this.removeShaderDefine($TiM.SAHDERDEFINE_DEPTHFOG))}),$Tq(0,$Tt,"fogStart",function(){return this._fogStart},function($Tt){this._fogStart=$Tt,this._shaderValues.setValue(1,$Tt)}),$Tq(0,$Tt,"fogRange",function(){return this._fogRange},function($Tt){this._fogRange=$Tt,this._shaderValues.setValue(2,$Tt)}),$Tq(0,$Tt,"ambientColor",function(){return this._ambientColor},function($Tt){this._ambientColor=$Tt,this._shaderValues.setValue(21,$Tt.elements)}),$Tq(0,$Tt,"scene",function(){return this}),$Tq(0,$Tt,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$Tc._sortScenes=function($Tt,$TM){if($Tt.parent!==$Ty.stage||$TM.parent!==$Ty.stage)return $Tt.parent!==$Ty.stage&&$TM.parent!==$Ty.stage?$Tc._sortScenes($Tt.parent,$TM.parent):$Tt.parent===$Ty.stage?-1:1;var $Tf=$Ty.stage._childs;return $Tf.indexOf($Tt)-$Tf.indexOf($TM)},$Tc.load=function($Tt){return $Ty.loader.create($Tt,null,null,$Tc)},$Tc.FOGCOLOR=0,$Tc.FOGSTART=1,$Tc.FOGRANGE=2,$Tc.LIGHTDIRECTION=3,$Tc.LIGHTDIRCOLOR=4,$Tc.POINTLIGHTPOS=5,$Tc.POINTLIGHTRANGE=6,$Tc.POINTLIGHTATTENUATION=7,$Tc.POINTLIGHTCOLOR=8,$Tc.SPOTLIGHTPOS=9,$Tc.SPOTLIGHTDIRECTION=10,$Tc.SPOTLIGHTSPOT=11,$Tc.SPOTLIGHTRANGE=12,$Tc.SPOTLIGHTATTENUATION=13,$Tc.SPOTLIGHTCOLOR=14,$Tc.SHADOWDISTANCE=15,$Tc.SHADOWLIGHTVIEWPROJECT=16,$Tc.SHADOWMAPPCFOFFSET=17,$Tc.SHADOWMAPTEXTURE1=18,$Tc.SHADOWMAPTEXTURE2=19,$Tc.SHADOWMAPTEXTURE3=20,$Tc.AMBIENTCOLOR=21,$Tc.TIME=22,$Tc}($TT),$TrM=function($Tt){function $TM($Tt){$TM.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $TtM,this._shaderValues=new $TbM,this._colliders=[],this._id=++$TM._uniqueIDCounter,this._transform=new $ThM(this),this.name=$Tt||"Sprite3D-"+$TM._nameNumberCounter++,this.layer=$TH.currentCreationLayer,this.active=!0}$TI($TM,"laya.d3.core.Sprite3D",$TOM);var $Tf=$TM.prototype;return $Ty.imps($Tf,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$Tf._setUrl=function($Tt){this._url=$Tt},$Tf._getGroup=function(){return this._group},$Tf._setGroup=function($Tt){this._group=$Tt},$Tf._addChild3D=function($Tt){$Tt.transform.parent=this.transform,this._hierarchyAnimator&&(!$Tt._hierarchyAnimator&&$Tt._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($Tt,!0,[$Tt.name])),this._scene&&($Tt._setBelongScene(this._scene),this._activeInHierarchy&&$Tt._active&&$Tt._activeHierarchy())},$Tf._removeChild3D=function($Tt){$Tt.transform.parent=null,this._scene&&(this._activeInHierarchy&&$Tt._active&&$Tt._inActiveHierarchy(),$Tt._setUnBelongScene()),this._hierarchyAnimator&&($Tt._hierarchyAnimator==this._hierarchyAnimator&&$Tt._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($Tt,!1,[$Tt.name]))},$Tf._parseBaseCustomProps=function($Tt){var $TM=this.transform.localPosition;$Tt.translate?($TM.fromArray($Tt.translate),$TM.x*=100,$TM.y*=100,$TM.z*=100):$TM.elements.fill(0),this.transform.localPosition=$TM;var $Tf=this.transform.localRotation;$Tt.rotation?$Tf.fromArray($Tt.rotation):$Tf.fromArray([0,0,0,-1]),this.transform.localRotation=$Tf;var $Tc=this.transform.localScale;$Tt.scale?$Tc.fromArray($Tt.scale):$Tc.elements.fill(1),this.transform.localScale=$Tc;var $TD=$Tt.layer;null!=$TD&&(this.layer=$TH.getLayerByNumber($TD))},$Tf._parseCustomComponent=function($Tt,$TM,$Tf){for(var $Tc in $Tf){var $TD=$Tf[$Tc];switch($Tc){case"Animator":var $To=this.addComponent(Animator);if($TD.avatarPath)$To.avatar=$TE.getRes($TM[$TD.avatarPath]);else{var $TJ=$TD.avatar;if($TJ){$To.avatar=$TE.getRes($TM[$TJ.path]);var $TZ=$TJ.linkSprites;$TZ&&$Tt.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$To,$TZ])}}for(var $TA=$TD.clipPaths,$TL=$TA.length,$Tp=0;$Tp<$TL;$Tp++)$To.addClip($TE.getRes($TM[$TA[$Tp]]));$To.clip=$TE.getRes($TM[$TA[0]]);var $TB=$TD.playOnWake;void 0!==$TB&&($To.playOnWake=$TB);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $Tb=this.addComponent(SphereCollider);$Tb.isTrigger=$TD.isTrigger;var $TI=$Tb.center;$TI.fromArray($TD.center),$Tb.center=$TI,$Tb.radius=$TD.radius;break;case"BoxCollider":var $Tq=this.addComponent(BoxCollider);$Tq.isTrigger=$TD.isTrigger,$Tq.center.fromArray($TD.center);var $Tl=$Tq.size;$Tl.fromArray($TD.size),$Tq.size=$Tl;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$Tf._onRootNodeHierarchyLoaded=function($Tt,$TM){for(var $Tf in $TM){for(var $Tc=this,$TD=$TM[$Tf],$To=0,$TJ=$TD.length;$To<$TJ;$To++){var $TZ=$TD[$To];if(""===$TZ)break;if(!($Tc=$Tc.getChildByName($TZ)))break}$Tc&&$Tt.linkSprite3DToAvatarNode($Tf,$Tc)}},$Tf._setHierarchyAnimator=function($Tt,$TM){this._changeHierarchyAnimator($Tt);for(var $Tf=0,$Tc=this._childs.length;$Tf<$Tc;$Tf++){var $TD=this._childs[$Tf];$TD._hierarchyAnimator==$TM&&$TD._setHierarchyAnimator($Tt,$TM)}},$Tf._clearHierarchyAnimator=function($Tt,$TM){this._changeHierarchyAnimator($TM);for(var $Tf=0,$Tc=this._childs.length;$Tf<$Tc;$Tf++){var $TD=this._childs[$Tf];$TD._hierarchyAnimator==$Tt&&$TD._clearHierarchyAnimator($Tt,$TM)}},$Tf._getAnimatorToLinkSprite3D=function($Tt,$TM,$Tf){var $Tc=this.getComponentByType(Animator);if($Tc&&($Tc.avatar?$Tc.avatar._version||$Tt._setAnimatorToLinkAvatar($Tc,$TM):$Tt._setAnimatorToLinkSprite3DNoAvatar($Tc,$TM,$Tf)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$Tf.unshift(this._parent.name);var $TD=this._parent;$TD._hierarchyAnimator&&$TD._getAnimatorToLinkSprite3D($Tt,$TM,$Tf)}},$Tf._setAnimatorToLinkSprite3DNoAvatar=function($Tt,$TM,$Tf){var $Tc=0,$TD=0;for($Tc=0,$TD=$Tt.getClipCount();$Tc<$TD;$Tc++)$Tt._handleSpriteOwnersBySprite($Tc,$TM,$Tf,this);for($Tc=0,$TD=this._childs.length;$Tc<$TD;$Tc++){var $To=this._childs[$Tc],$TJ=$Tf.length;$Tf.push($To.name),$To._setAnimatorToLinkSprite3DNoAvatar($Tt,$TM,$Tf),$Tf.splice($TJ,1)}},$Tf._changeHierarchyAnimator=function($Tt){this._hierarchyAnimator=$Tt},$Tf._isLinkSpriteToAnimationNode=function($Tt,$TM,$Tf){var $Tc=$Tt._avatarNodes.indexOf($TM),$TD=$Tt._cacheSpriteToNodesMap;if($Tf)this._transform.dummy=$TM.transform,$Tt._cacheNodesToSpriteMap[$Tc]=$TD.length,$TD.push($Tc);else{this._transform.dummy=null;var $To=$Tt._cacheNodesToSpriteMap[$Tc];$Tt._cacheNodesToSpriteMap[$Tc]=null,$TD.splice($To,1)}},$Tf._setBelongScene=function($Tt){this._scene=$Tt;for(var $TM=0,$Tf=this._childs.length;$TM<$Tf;$TM++)this._childs[$TM]._setBelongScene($Tt)},$Tf._setUnBelongScene=function(){this._scene=null;for(var $Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++)this._childs[$Tt]._setUnBelongScene()},$Tf._activeHierarchy=function(){var $Tt=0,$TM=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$Tt=0,$TM=this._colliders.length;$Tt<$TM;$Tt++)this._layer._addCollider(this._colliders[$Tt]);for(this.event("activeinhierarchychanged",!0),$Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++){var $Tf=this._childs[$Tt];$Tf._active&&$Tf._activeHierarchy()}},$Tf._inActiveHierarchy=function(){var $Tt=0,$TM=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$Tt=0,$TM=this._colliders.length;$Tt<$TM;$Tt++){var $Tf=this._colliders[$Tt];$Tf._clearCollsionMap(),this._layer._removeCollider($Tf)}for(this.event("activeinhierarchychanged",!1),$Tt=0,$TM=this._childs.length;$Tt<$TM;$Tt++){var $Tc=this._childs[$Tt];$Tc._active&&$Tc._inActiveHierarchy()}},$Tf.addComponent=function($Tt){var $TM,$Tf=this._componentsMap.indexOf($Tt);if(-1===$Tf)$TM=[],this._componentsMap.push($Tt),this._typeComponentsIndices.push($TM);else if($TM=this._typeComponentsIndices[$Tf],this._components[$TM[0]].isSingleton)throw new Error("无法单实例创建"+$Tt+"组件，"+$Tt+"组件已存在！");var $Tc=$TD.getInstance($Tt);return $TM.push(this._components.length),this._components.push($Tc),$Tc instanceof laya.d3.component.Script&&this._scripts.push($Tc),$Tc._initialize(this),$Tc},$Tf._removeComponent=function($Tt,$TM){var $Tf,$Tc=0,$TD=this._typeComponentsIndices[$Tt],$To=$TD[$TM],$TJ=this._components[$To];for($TJ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($TJ),1),$TD.splice($TM,1),0===$TD.length&&(this._typeComponentsIndices.splice($Tt,1),this._componentsMap.splice($Tt,1)),$Tc=0,$Tf=this._componentsMap.length;$Tc<$Tf;$Tc++)for(var $TZ=($TD=this._typeComponentsIndices[$Tc]).length-1;0<=$TZ;$TZ--){var $TA=$TD[$TZ];if(!($To<$TA))break;$TD[$TZ]=--$TA}$TJ._destroy()},$Tf._clearSelfRenderObjects=function(){},$Tf._addSelfRenderObjects=function(){},$Tf._parseCustomProps=function($Tt,$TM,$Tf,$Tc){},$Tf._updateChilds=function($Tt){var $TM=this._childs.length;if(0!==$TM)for(var $Tf=0;$Tf<$TM;++$Tf)this._childs[$Tf]._update($Tt)},$Tf._getSortID=function($Tt,$TM){return 1e3*$TM.id+$Tt._getVertexBuffer().vertexDeclaration.id},$Tf._update=function($Tt){($Tt.owner=this)._activeInHierarchy&&(this._updateComponents($Tt),this._lateUpdateComponents($Tt),$Ti.spriteCount++,this._childs.length&&this._updateChilds($Tt))},$Tf.getProjectionViewWorldMatrix=function($Tt){return $TtM.multiply($Tt,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$Tf.loadHierarchy=function($Tt){this.addChild(laya.d3.core.Sprite3D.load($Tt))},$Tf.addChildAt=function($Tt,$TM){if(!($Tt instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),0<=$TM&&$TM<=this._childs.length){if($Tt._parent===this){var $Tf=this.getChildIndex($Tt);this._childs.splice($Tf,1),this._childs.splice($TM,0,$Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,$TM)),this._childChanged()}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TL.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($TM,0,$Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,$TM),($Tt.parent=this)._addChild3D($Tt);return $Tt}throw new Error("appendChildAt:The index is out of bounds")},$Tf.addChild=function($Tt){if(!($Tt instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Tt||this.destroyed||$Tt===this)return $Tt;if($Tt.zOrder&&this._set$P("hasZorder",!0),$Tt._parent===this){var $TM=this.getChildIndex($Tt);$TM!==this._childs.length-1&&(this._childs.splice($TM,1),this._childs.push($Tt),this.conchModel&&(this.conchModel.removeChild($Tt.conchModel),this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1)),this._childChanged())}else $Tt.parent&&$Tt.parent.removeChild($Tt),this._childs===$TL.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Tt),this.conchModel&&this.conchModel.addChildAt($Tt.conchModel,this._childs.length-1),($Tt.parent=this)._childChanged(),this._addChild3D($Tt);return $Tt},$Tf.removeChildAt=function($Tt){var $TM=this.getChildAt($Tt);return $TM&&(this._removeChild3D($TM),this._childs.splice($Tt,1),this.conchModel&&this.conchModel.removeChild($TM.conchModel),$TM.parent=null),$TM},$Tf.removeChildren=function($Tt,$TM){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=2147483647),this._childs&&0<this._childs.length){var $Tf=this._childs;if(0===$Tt&&$To<=$TM){var $Tc=$Tf;this._childs=$TL.ARRAY_EMPTY}else $Tc=$Tf.splice($Tt,$TM-$Tt);for(var $TD=0,$To=$Tc.length;$TD<$To;$TD++)this._removeChild3D($Tc[$TD]),$Tc[$TD].parent=null,this.conchModel&&this.conchModel.removeChild($Tc[$TD].conchModel)}return this},$Tf.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=$TM[0];if("Sprite3D"!==$Tc.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $TD=$TM[1];$T_M._createNodeByJson(this,$Tc,this,$TD),this.event("hierarchyloaded",[this]),this.__loaded=!0},$Tf.cloneTo=function($Tt){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $TM=$Tt;$TM.name=this.name,$TM._destroyed=this._destroyed,$TM.timer=this.timer,$TM._$P=this._$P,$TM.active=this._active;var $Tf=$TM.transform.localPosition;this.transform.localPosition.cloneTo($Tf),$TM.transform.localPosition=$Tf;var $Tc=$TM.transform.localRotation;this.transform.localRotation.cloneTo($Tc),$TM.transform.localRotation=$Tc;var $TD=$TM.transform.localScale;this.transform.localScale.cloneTo($TD),$TM.transform.localScale=$TD,$TM.isStatic=this.isStatic;var $To=0,$TJ=0;for($To=0,$TJ=this._componentsMap.length;$To<$TJ;$To++){var $TZ=$TM.addComponent(this._componentsMap[$To]);this._components[$To]._cloneTo($TZ)}for($To=0,$TJ=this._childs.length;$To<$TJ;$To++)$TM.addChild(this._childs[$To].clone());var $TA=$TM.getComponentByType(Animator);if($TA){var $TL=$TA._linkSpritesData;if($TL)for(var $Tp in $TL){for(var $TB=$TL[$Tp],$Tb=$TM,$TI=0,$Tq=$TB.length;$TI<$Tq&&($Tb=$Tb.getChildByName($TB[$TI]));$TI++);if($Tb){var $Tl=$TA._avatarNodeMap[$Tp];$Tb._isLinkSpriteToAnimationNode($TA,$Tl,!0)}}}},$Tf.clone=function(){var $Tt=new this.constructor;return this.cloneTo($Tt),$Tt},$Tf.destroy=function($Tt){if(void 0===$Tt&&($Tt=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$Tt);var $TM,$Tf=0;for($Tf=0,$TM=this._components.length;$Tf<$TM;$Tf++)this._components[$Tf]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$TE.clearRes(this.url),this.loaded||$TEM._cancelLoadByUrl(this.url)}},$Tf._handleSpriteToAvatar=function($Tt,$TM){$Tt._avatarNodes;var $Tf=$Tt._avatarNodeMap[this.name];$Tf&&$Tf.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($Tt,$Tf,$TM)},$Tf._setAnimatorToLinkAvatar=function($Tt,$TM){this._handleSpriteToAvatar($Tt,$TM);for(var $Tf=0,$Tc=this._childs.length;$Tf<$Tc;$Tf++){this._childs[$Tf]._setAnimatorToLinkAvatar($Tt,$TM)}},$Tq(0,$Tf,"activeInHierarchy",function(){return this._activeInHierarchy}),$Tq(0,$Tf,"_loaded",null,function($Tt){this.__loaded=$Tt}),$Tq(0,$Tf,"active",function(){return this._active},function($Tt){this._active!==$Tt&&(this._active=$Tt,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($Tt?this._activeHierarchy():this._inActiveHierarchy()))}),$Tq(0,$Tf,"componentsCount",function(){return this._components.length}),$Tq(0,$Tf,"loaded",function(){return this.__loaded}),$Tq(0,$Tf,"id",function(){return this._id}),$Tq(0,$Tf,"url",function(){return this._url}),$Tq(0,$Tf,"layer",function(){return this._layer},function($Tt){if(this._layer!==$Tt){if(!$Tt)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $TM=0,$Tf=this._colliders.length;if(this._layer)for($TM=0;$TM<$Tf;$TM++)this._layer._removeCollider(this._colliders[$TM]);for($TM=0;$TM<$Tf;$TM++)$Tt._addCollider(this._colliders[$TM])}this._layer=$Tt,this.event("layerchanged",$Tt)}}),$Tq(0,$Tf,"scene",function(){return this._scene}),$Tq(0,$Tf,"transform",function(){return this._transform}),$TM.instantiate=function($Tt,$TM,$Tf,$Tc,$TD){void 0===$Tf&&($Tf=!0);var $To=$Tt.clone();$TM&&$TM.addChild($To);var $TJ=$To.transform;if($Tf){var $TZ=$TJ.worldMatrix;$Tt.transform.worldMatrix.cloneTo($TZ),$TJ.worldMatrix=$TZ}else $Tc&&($TJ.position=$Tc),$TD&&($TJ.rotation=$TD);return $To},$TM.load=function($Tt){return $Ty.loader.create($Tt,null,null,$TM)},$TM.WORLDMATRIX=0,$TM.MVPMATRIX=1,$TM._uniqueIDCounter=0,$TM._nameNumberCounter=0,$TM}(),$TuM=function($Tt){function $Tp($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$Tp.__super.call(this),!$Tt||!$TM)throw"Shader Error";this._id=++$Tp._count,this._vs=$Tt,this._ps=$TM,this._attributeMap=$Tf,this._sceneUniformMap=$Tc,this._cameraUniformMap=$TD,this._spriteUniformMap=$To,this._materialUniformMap=$TJ,this._renderElementUniformMap=$TZ,this._precompile=$TA,this._define=$TL,this._precompile&&$Tp.extCompileObj&&$Tp.extCompileFunc?$Tp.extCompileFunc.call($Tp.extCompileObj,$Tt,$TM,$TL):this.recreateResource()}$TI($Tp,"laya.d3.shader.Shader3D",$Tf);var $TM=$Tp.prototype;return $TM.recreateResource=function(){$TS.now();this._compile(),this.completeCreate(),this.memorySize=0},$TM.disposeResource=function(){$TU.mainContext.deleteShader(this._vshader),$TU.mainContext.deleteShader(this._pshader),$TU.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$TM._compile=function(){if(!$TU.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $Tt=[this._vs,this._ps],$TM=$TU.mainContext;if(this._program=$TM.createProgram(),this._vshader=$Tp._createShader($TM,$Tt[0],35633),this._pshader=$Tp._createShader($TM,$Tt[1],35632),$TM.attachShader(this._program,this._vshader),$TM.attachShader(this._program,this._pshader),$TM.linkProgram(this._program),!$Tl.isConchApp&&$TiM.debugMode&&!$TM.getProgramParameter(this._program,35714))throw $TM.getProgramInfoLog(this._program);var $Tf,$Tc=0,$TD=0,$To=0;for($To=$Tl.isConchApp?$TM.getProgramParameterEx(this._vs,this._ps,"",35721):$TM.getProgramParameter(this._program,35721),$Tc=0;$Tc<$To;$Tc++){var $TJ=null;$Tf={vartype:"attribute",ivartype:0,attrib:$TJ=$Tl.isConchApp?$TM.getActiveAttribEx(this._vs,this._ps,"",$Tc):$TM.getActiveAttrib(this._program,$Tc),location:$TM.getAttribLocation(this._program,$TJ.name),name:$TJ.name,type:$TJ.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($Tf)}var $TZ=0;for($TZ=$Tl.isConchApp?$TM.getProgramParameterEx(this._vs,this._ps,"",35718):$TM.getProgramParameter(this._program,35718),$Tc=0;$Tc<$TZ;$Tc++){var $TA=null;$TA=$Tl.isConchApp?$TM.getActiveUniformEx(this._vs,this._ps,"",$Tc):$TM.getActiveUniform(this._program,$Tc),0<($Tf={vartype:"uniform",ivartype:1,attrib:$TJ,location:$TM.getUniformLocation(this._program,$TA.name),name:$TA.name,type:$TA.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($Tf.name=$Tf.name.substr(0,$Tf.name.length-3),$Tf.isArray=!0,$Tf.location=$TM.getUniformLocation(this._program,$Tf.name)),this._uniformParams.push($Tf)}for($Tc=0,$TD=this._attributeParams.length;$Tc<$TD;$Tc++)($Tf=this._attributeParams[$Tc]).indexOfParams=$Tc,$Tf.index=1,$Tf.value=[$Tf.location,null],$Tf.codename=$Tf.name,$Tf.name=null!=this._attributeMap[$Tf.codename]?this._attributeMap[$Tf.codename]:$Tf.codename,this._attributeParamsMap.push($Tf.name),this._attributeParamsMap.push($Tf),$Tf._this=this,$Tf.uploadedValue=[],$Tf.fun=this._attribute;for($Tc=0,$TD=this._uniformParams.length;$Tc<$TD;$Tc++)switch(($Tf=this._uniformParams[$Tc]).indexOfParams=$Tc,$Tf.index=1,$Tf.value=[$Tf.location,null],$Tf.codename=$Tf.name,null!=this._sceneUniformMap[$Tf.codename]?($Tf.name=this._sceneUniformMap[$Tf.codename],this._sceneUniformParamsMap.push($Tf.name),this._sceneUniformParamsMap.push($Tf)):null!=this._cameraUniformMap[$Tf.codename]?($Tf.name=this._cameraUniformMap[$Tf.codename],this._cameraUniformParamsMap.push($Tf.name),this._cameraUniformParamsMap.push($Tf)):null!=this._spriteUniformMap[$Tf.codename]?($Tf.name=this._spriteUniformMap[$Tf.codename],this._spriteUniformParamsMap.push($Tf.name),this._spriteUniformParamsMap.push($Tf)):null!=this._materialUniformMap[$Tf.codename]?($Tf.name=this._materialUniformMap[$Tf.codename],this._materialUniformParamsMap.push($Tf.name),this._materialUniformParamsMap.push($Tf)):null!=this._renderElementUniformMap[$Tf.codename]?($Tf.name=this._renderElementUniformMap[$Tf.codename],this._renderElementUniformParamsMap.push($Tf.name),this._renderElementUniformParamsMap.push($Tf)):console.log("Shader:can't find uinform name:"+$Tf.codename+" in shader file."),$Tf._this=this,$Tf.uploadedValue=[],$Tf.type){case 5124:$Tf.fun=$Tf.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$Tf.fun=$Tf.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$Tf.fun=$Tf.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$Tf.fun=$Tf.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$Tf.fun=$Tf.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$Tf.fun=this._uniform_sampler2D;break;case 35680:$Tf.fun=this._uniform_samplerCube;break;case 35676:$Tf.fun=this._uniformMatrix4fv;break;case 35670:$Tf.fun=this._uniform1i;break;case 35674:$Tf.fun=this._uinformMatrix2fv;break;case 35675:$Tf.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$TM._attribute=function($Tt,$TM){var $Tf=$TU.mainContext,$Tc=$TZ._enableAtributes,$TD=$Tt.location;return $Tc[$TD]||$Tf.enableVertexAttribArray($TD),$Tf.vertexAttribPointer($TD,$TM[0],$TM[1],$TM[2],$TM[3],$TM[4]),$Tc[$TD]=$TZ._bindVertexBuffer,1},$TM._uniform1f=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM?($TU.mainContext.uniform1f($Tt.location,$Tf[0]=$TM),1):0},$TM._uniform1fv=function($Tt,$TM){if($TM.length<4){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TU.mainContext.uniform1fv($Tt.location,$TM),$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3],1):0}return $TU.mainContext.uniform1fv($Tt.location,$TM),1},$TM._uniform_vec2=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]?($TU.mainContext.uniform2f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1]),1):0},$TM._uniform_vec2v=function($Tt,$TM){if($TM.length<2){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TU.mainContext.uniform2fv($Tt.location,$TM),$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3],1):0}return $TU.mainContext.uniform2fv($Tt.location,$TM),1},$TM._uniform_vec3=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]?($TU.mainContext.uniform3f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2]),1):0},$TM._uniform_vec3v=function($Tt,$TM){return $TU.mainContext.uniform3fv($Tt.location,$TM),1},$TM._uniform_vec4=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TU.mainContext.uniform4f($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3]),1):0},$TM._uniform_vec4v=function($Tt,$TM){return $TU.mainContext.uniform4fv($Tt.location,$TM),1},$TM._uniformMatrix2fv=function($Tt,$TM){return $TU.mainContext.uniformMatrix2fv($Tt.location,!1,$TM),1},$TM._uniformMatrix3fv=function($Tt,$TM){return $TU.mainContext.uniformMatrix3fv($Tt.location,!1,$TM),1},$TM._uniformMatrix4fv=function($Tt,$TM){return $TU.mainContext.uniformMatrix4fv($Tt.location,!1,$TM),1},$TM._uinformMatrix2fv=function($Tt,$TM){return $TU.mainContext.uniformMatrix2fv($Tt.location,!1,$TM),1},$TM._uinformMatrix3fv=function($Tt,$TM){return $TU.mainContext.uniformMatrix3fv($Tt.location,!1,$TM),1},$TM._uniform1i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM?($TU.mainContext.uniform1i($Tt.location,$Tf[0]=$TM),1):0},$TM._uniform1iv=function($Tt,$TM){return $TU.mainContext.uniform1iv($Tt.location,$TM),1},$TM._uniform_ivec2=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]?($TU.mainContext.uniform2i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1]),1):0},$TM._uniform_ivec2v=function($Tt,$TM){return $TU.mainContext.uniform2iv($Tt.location,$TM),1},$TM._uniform_vec3i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]?($TU.mainContext.uniform3i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2]),1):0},$TM._uniform_vec3vi=function($Tt,$TM){return $TU.mainContext.uniform3iv($Tt.location,$TM),1},$TM._uniform_vec4i=function($Tt,$TM){var $Tf=$Tt.uploadedValue;return $Tf[0]!==$TM[0]||$Tf[1]!==$TM[1]||$Tf[2]!==$TM[2]||$Tf[3]!==$TM[3]?($TU.mainContext.uniform4i($Tt.location,$Tf[0]=$TM[0],$Tf[1]=$TM[1],$Tf[2]=$TM[2],$Tf[3]=$TM[3]),1):0},$TM._uniform_vec4vi=function($Tt,$TM){return $TU.mainContext.uniform4iv($Tt.location,$TM),1},$TM._uniform_sampler2D=function($Tt,$TM){var $Tf=$TM.source||$TM.defaulteTexture.source,$Tc=$TU.mainContext,$TD=$Tt.uploadedValue;if(null!=$TD[0])return $Tc.activeTexture($Tp._TEXTURES[$TD[0]]),$Tf&&$TF.bindTexture($Tc,3553,$Tf),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $TD[0]=this._curActTexIndex,$Tc.uniform1i($Tt.location,this._curActTexIndex),$Tc.activeTexture($Tp._TEXTURES[this._curActTexIndex]),$Tf&&$TF.bindTexture($Tc,3553,$Tf),this._curActTexIndex++,1},$TM._uniform_samplerCube=function($Tt,$TM){var $Tf=$TM.source||$TM.defaulteTexture.source,$Tc=$TU.mainContext,$TD=$Tt.uploadedValue;if(null!=$TD[0])return $Tc.activeTexture($Tp._TEXTURES[$TD[0]]),$Tf?$TF.bindTexture($Tc,34067,$Tf):$TF.bindTexture($Tc,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $TD[0]=this._curActTexIndex,$Tc.uniform1i($Tt.location,this._curActTexIndex),$Tc.activeTexture($Tp._TEXTURES[this._curActTexIndex]),$Tf?$TF.bindTexture($Tc,34067,$Tf):$TF.bindTexture($Tc,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$TM._noSetValue=function($Tt){console.log("no....:"+$Tt.name)},$TM.bind=function(){return $Tf.activeShader=this,($Tf.bindShader=this).activeResource(),$TF.UseProgram(this._program)},$TM.uploadAttributes=function($Tt,$TM){for(var $Tf,$Tc,$TD=0,$To=0,$TJ=this._attributeParamsMap.length;$To<$TJ;$To+=2)$Tc=this._attributeParamsMap[$To+1],null!=($Tf=$Tt[this._attributeParamsMap[$To]])&&($TM&&$TM[$Tc.name]&&$TM[$Tc.name].bind(),$TD+=$Tc.fun.call(this,$Tc,$Tf));$Ti.shaderCall+=$TD},$TM.uploadAttributesX=function($Tt,$TM){for(var $Tf,$Tc,$TD=0,$To=0,$TJ=this._attributeParamsMap.length;$To<$TJ;$To+=2)$Tc=this._attributeParamsMap[$To+1],null!=($Tf=$Tt[this._attributeParamsMap[$To]])&&($TM._bind(),$TD+=$Tc.fun.call(this,$Tc,$Tf));$Ti.shaderCall+=$TD},$TM.uploadSceneUniforms=function($Tt){for(var $TM,$Tf,$Tc=0,$TD=0,$To=this._sceneUniformParamsMap.length;$TD<$To;$TD+=2)$Tf=this._sceneUniformParamsMap[$TD+1],null!=($TM=$Tt[this._sceneUniformParamsMap[$TD]])&&($Tc+=$Tf.fun.call(this,$Tf,$TM));$Ti.shaderCall+=$Tc},$TM.uploadCameraUniforms=function($Tt){for(var $TM,$Tf,$Tc=0,$TD=0,$To=this._cameraUniformParamsMap.length;$TD<$To;$TD+=2)$Tf=this._cameraUniformParamsMap[$TD+1],null!=($TM=$Tt[this._cameraUniformParamsMap[$TD]])&&($Tc+=$Tf.fun.call(this,$Tf,$TM));$Ti.shaderCall+=$Tc},$TM.uploadSpriteUniforms=function($Tt){for(var $TM,$Tf,$Tc=0,$TD=0,$To=this._spriteUniformParamsMap.length;$TD<$To;$TD+=2)$Tf=this._spriteUniformParamsMap[$TD+1],null!=($TM=$Tt[this._spriteUniformParamsMap[$TD]])&&($Tc+=$Tf.fun.call(this,$Tf,$TM));$Ti.shaderCall+=$Tc},$TM.uploadMaterialUniforms=function($Tt){for(var $TM,$Tf,$Tc=0,$TD=0,$To=this._materialUniformParamsMap.length;$TD<$To;$TD+=2)$Tf=this._materialUniformParamsMap[$TD+1],null!=($TM=$Tt[this._materialUniformParamsMap[$TD]])&&($Tc+=$Tf.fun.call(this,$Tf,$TM));$Ti.shaderCall+=$Tc},$TM.uploadRenderElementUniforms=function($Tt){for(var $TM,$Tf,$Tc=0,$TD=0,$To=this._renderElementUniformParamsMap.length;$TD<$To;$TD+=2)$Tf=this._renderElementUniformParamsMap[$TD+1],null!=($TM=$Tt[this._renderElementUniformParamsMap[$TD]])&&($Tc+=$Tf.fun.call(this,$Tf,$TM));$Ti.shaderCall+=$Tc},$Tp.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return new $Tp($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL)},$Tp.addInclude=function($Tt,$TM){$TN.addInclude($Tt,$TM)},$Tp._createShader=function($Tt,$TM,$Tf){var $Tc=$Tt.createShader($Tf);if($Tt.shaderSource($Tc,$TM),$Tt.compileShader($Tc),$TiM.debugMode&&!$Tt.getShaderParameter($Tc,35713))throw $Tt.getShaderInfoLog($Tc);return $Tc},$Tp.PERIOD_RENDERELEMENT=0,$Tp.PERIOD_MATERIAL=1,$Tp.PERIOD_SPRITE=2,$Tp.PERIOD_CAMERA=3,$Tp.PERIOD_SCENE=4,$Tp._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$Tp._count=0,$Tp._preCompile=!1,$Tp.extCompileFunc=null,$Tp.extCompileObj=null,$TB($Tp,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $TV}]),$Tp}(),$TvM=function($TZ){function $TA(){this._transformUV=null,$TA.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $TJM(.6,.6,.6)),this._setColor(10,new $TJM(1,1,1)),this._setColor(11,new $TZM(1,1,1,8)),this._setColor(12,new $TJM(1,1,1)),this._setColor(7,new $TZM(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $TZM(1,1,0,0)),this.renderMode=1}$TI($TA,"laya.d3.core.material.StandardMaterial",$TZ);var $Tt=$TA.prototype;return $Tt.disableLight=function(){this._addDisablePublicShaderDefine($TiM.SHADERDEFINE_POINTLIGHT|$TiM.SHADERDEFINE_SPOTLIGHT|$TiM.SHADERDEFINE_DIRECTIONLIGHT)},$Tt.disableFog=function(){this._addDisablePublicShaderDefine($TiM.SHADERDEFINE_FOG)},$Tt.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=$TM[0];if($Tc.version)$TZ.prototype.onAsynLoaded.call(this,$Tt,$TM,$Tf);else{var $TD=$TM[1],$To=$Tc.props;for(var $TJ in $To)this[$TJ]=$To[$TJ];$TA._parseStandardMaterial($TD,this,$Tc),this._endLoaded()}},$Tt.cloneTo=function($Tt){$TZ.prototype.cloneTo.call(this,$Tt);var $TM=$Tt;this._transformUV&&($TM._transformUV=this._transformUV.clone())},$Tq(0,$Tt,"ambientColor",function(){return this._getColor(9)},function($Tt){this._setColor(9,$Tt)}),$Tq(0,$Tt,"ambientTexture",function(){return this._getTexture(5)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$Tt)}),$Tq(0,$Tt,"renderMode",null,function($Tt){switch($Tt){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($TA.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($Tt)}),$Tq(0,$Tt,"reflectColor",function(){return this._getColor(12)},function($Tt){this._setColor(12,$Tt)}),$Tq(0,$Tt,"tilingOffset",function(){return this._getColor(15)},function($Tt){if($Tt){var $TM=$Tt.elements;1!=$TM[0]||1!=$TM[1]||0!=$TM[2]||0!=$TM[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$Tt)}),$Tq(0,$Tt,"albedo",function(){return this._getColor(7)},function($Tt){this._setColor(7,$Tt)}),$Tq(0,$Tt,"diffuseColor",function(){return this._getColor(10)},function($Tt){this._setColor(10,$Tt)}),$Tq(0,$Tt,"albedoColor",function(){return this._getColor(7)},function($Tt){this._setColor(7,$Tt)}),$Tq(0,$Tt,"specularColor",function(){return this._getColor(11)},function($Tt){this._setColor(11,$Tt)}),$Tq(0,$Tt,"diffuseTexture",function(){return this._getTexture(1)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$Tt)}),$Tq(0,$Tt,"normalTexture",function(){return this._getTexture(2)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$Tt)}),$Tq(0,$Tt,"specularTexture",function(){return this._getTexture(3)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$Tt)}),$Tq(0,$Tt,"emissiveTexture",function(){return this._getTexture(4)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$Tt)}),$Tq(0,$Tt,"reflectTexture",function(){return this._getTexture(6)},function($Tt){$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$Tt)}),$Tq(0,$Tt,"transformUV",function(){return this._transformUV},function($Tt){this._transformUV=$Tt,this._setMatrix4x4(13,$Tt.matrix),$Tt?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$Tt.matrix.elements,0)}),$TA.__init__=function(){$TA.SHADERDEFINE_DIFFUSEMAP=$TA.shaderDefines.registerDefine("DIFFUSEMAP"),$TA.SHADERDEFINE_NORMALMAP=$TA.shaderDefines.registerDefine("NORMALMAP"),$TA.SHADERDEFINE_SPECULARMAP=$TA.shaderDefines.registerDefine("SPECULARMAP"),$TA.SHADERDEFINE_EMISSIVEMAP=$TA.shaderDefines.registerDefine("EMISSIVEMAP"),$TA.SHADERDEFINE_AMBIENTMAP=$TA.shaderDefines.registerDefine("AMBIENTMAP"),$TA.SHADERDEFINE_REFLECTMAP=$TA.shaderDefines.registerDefine("REFLECTMAP"),$TA.SHADERDEFINE_UVTRANSFORM=$TA.shaderDefines.registerDefine("UVTRANSFORM"),$TA.SHADERDEFINE_TILINGOFFSET=$TA.shaderDefines.registerDefine("TILINGOFFSET"),$TA.SHADERDEFINE_ADDTIVEFOG=$TA.shaderDefines.registerDefine("ADDTIVEFOG")},$TA.load=function($Tt){return $Ty.loader.create($Tt,null,null,$TA)},$TA._parseStandardMaterial=function($Tt,$TM,$Tf){var $Tc=$Tf.customProps,$TD=$Tc.ambientColor;$TM.ambientColor=new $TJM($TD[0],$TD[1],$TD[2]);var $To=$Tc.diffuseColor;$TM.diffuseColor=new $TJM($To[0],$To[1],$To[2]);var $TJ=$Tc.specularColor;$TM.specularColor=new $TZM($TJ[0],$TJ[1],$TJ[2],$TJ[3]);var $TZ=$Tc.reflectColor;$TM.reflectColor=new $TJM($TZ[0],$TZ[1],$TZ[2]);var $TA=$Tc.albedoColor;$TA&&($TM.albedo=new $TZM($TA[0],$TA[1],$TA[2],$TA[3]));var $TL=$Tc.diffuseTexture.texture2D;$TL&&($TM.diffuseTexture=$TE.getRes($Tt[$TL]));var $Tp=$Tc.normalTexture.texture2D;$Tp&&($TM.normalTexture=$TE.getRes($Tt[$Tp]));var $TB=$Tc.specularTexture.texture2D;$TB&&($TM.specularTexture=$TE.getRes($Tt[$TB]));var $Tb=$Tc.emissiveTexture.texture2D;$Tb&&($TM.emissiveTexture=$TE.getRes($Tt[$Tb]));var $TI=$Tc.ambientTexture.texture2D;$TI&&($TM.ambientTexture=$TE.getRes($Tt[$TI]));var $Tq=$Tc.reflectTexture.texture2D;$Tq&&($TM.reflectTexture=$TE.getRes($Tt[$Tq]))},$TA.RENDERMODE_OPAQUE=1,$TA.RENDERMODE_OPAQUEDOUBLEFACE=2,$TA.RENDERMODE_CUTOUT=3,$TA.RENDERMODE_CUTOUTDOUBLEFACE=4,$TA.RENDERMODE_TRANSPARENT=13,$TA.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$TA.RENDERMODE_ADDTIVE=15,$TA.RENDERMODE_ADDTIVEDOUBLEFACE=16,$TA.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$TA.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$TA.RENDERMODE_DEPTHREAD_ADDTIVE=7,$TA.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$TA.RENDERMODE_NONDEPTH_TRANSPARENT=9,$TA.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$TA.RENDERMODE_NONDEPTH_ADDTIVE=11,$TA.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$TA.SHADERDEFINE_DIFFUSEMAP=0,$TA.SHADERDEFINE_NORMALMAP=0,$TA.SHADERDEFINE_SPECULARMAP=0,$TA.SHADERDEFINE_EMISSIVEMAP=0,$TA.SHADERDEFINE_AMBIENTMAP=0,$TA.SHADERDEFINE_REFLECTMAP=0,$TA.SHADERDEFINE_UVTRANSFORM=0,$TA.SHADERDEFINE_TILINGOFFSET=0,$TA.SHADERDEFINE_ADDTIVEFOG=0,$TA.DIFFUSETEXTURE=1,$TA.NORMALTEXTURE=2,$TA.SPECULARTEXTURE=3,$TA.EMISSIVETEXTURE=4,$TA.AMBIENTTEXTURE=5,$TA.REFLECTTEXTURE=6,$TA.ALBEDO=7,$TA.UVANIAGE=8,$TA.MATERIALAMBIENT=9,$TA.MATERIALDIFFUSE=10,$TA.MATERIALSPECULAR=11,$TA.MATERIALREFLECT=12,$TA.UVMATRIX=13,$TA.UVAGE=14,$TA.TILINGOFFSET=15,$TB($TA,["defaultMaterial",function(){var $Tt=new $TA;return $Tt.lock=!0,this.defaultMaterial=$Tt},"shaderDefines",function(){return this.shaderDefines=new $TpM($TCM.shaderDefines)}]),$TA}($TCM),$TkM=function($Tt){function $TJ($Tt,$TM,$Tf,$Tc,$TD){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$Tf&&($Tf=35044),void 0===$Tc&&($Tc=!1),$TJ.__super.call(this),this._indexType=$Tt,this._indexCount=$TM,this._bufferUsage=$Tf,this._bufferType=34963,this._canRead=$Tc;var $To;if("ushort"==$Tt)this._indexTypeByteCount=2;else{if("ubyte"!=$Tt)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$To=this._indexTypeByteCount*$TM,this._byteLength=$To,this._bind(),$TZ._gl.bufferData(this._bufferType,$To,this._bufferUsage),this.uri=$TD,$Tc?("ushort"==$Tt?this._buffer=new Uint16Array($TM):"ubyte"==$Tt&&(this._buffer=new Uint8Array($TM)),this.memorySize=2*$To):this.memorySize=$To}$TI($TJ,"laya.d3.graphics.IndexBuffer3D",$Tt);var $TM=$TJ.prototype;return $TM.setData=function($Tt,$TM,$Tf,$Tc){void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=4294967295);var $TD=0;if("ushort"==this._indexType?($TD=2,0===$Tf&&4294967295===$Tc||($Tt=new Uint16Array($Tt.buffer,$Tf*$TD,$Tc))):"ubyte"==this._indexType&&($TD=1,0===$Tf&&4294967295===$Tc||($Tt=new Uint8Array($Tt.buffer,$Tf*$TD,$Tc))),this._bind(),$TZ._gl.bufferSubData(this._bufferType,$TM*$TD,$Tt),this._canRead)if(0!==$TM||0!==$Tf||4294967295!==$Tc){var $To=this._buffer.length-$TM;$To<$Tc&&($Tc=$To);for(var $TJ=0;$TJ<$Tc;$TJ++)this._buffer[$TM+$TJ]=$Tt[$TJ]}else this._buffer=$Tt},$TM.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$TM.disposeResource=function(){$Tt.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$Tq(0,$TM,"indexType",function(){return this._indexType}),$Tq(0,$TM,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$Tq(0,$TM,"indexCount",function(){return this._indexCount}),$Tq(0,$TM,"canRead",function(){return this._canRead}),$TJ.INDEXTYPE_UBYTE="ubyte",$TJ.INDEXTYPE_USHORT="ushort",$TJ.create=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$Tf&&($Tf=35044),void 0===$Tc&&($Tc=!1),new $TJ($Tt,$TM,$Tf,$Tc,$TD)},$TJ}($TZ),$TKM=function($To){function $TJ($Tt,$TM,$Tf,$Tc,$TD){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$Tc&&($Tc=!1),$TJ.__super.call(this),this._vertexDeclaration=$Tt,this._vertexCount=$TM,this._bufferUsage=$Tf,this._bufferType=34962,this._canRead=$Tc,this.uri=$TD,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$TM,this._bind(),$TZ._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$Tc&&(this._buffer=new Float32Array(this._byteLength/4))}$TI($TJ,"laya.d3.graphics.VertexBuffer3D",$To);var $Tt=$TJ.prototype;return $Tt.bindWithIndexBuffer=function($Tt){$Tt&&$Tt._bind(),this._bind()},$Tt.setData=function($Tt,$TM,$Tf,$Tc){if(void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=4294967295),0===$Tf&&4294967295===$Tc||($Tt=new Float32Array($Tt.buffer,4*$Tf,$Tc)),this._bind(),$TZ._gl.bufferSubData(this._bufferType,4*$TM,$Tt),this._canRead)if(0!==$TM||0!==$Tf||4294967295!==$Tc){var $TD=this._buffer.length-$TM;$TD<$Tc&&($Tc=$TD);for(var $To=0;$To<$Tc;$To++)this._buffer[$TM+$To]=$Tt[$To]}else this._buffer=$Tt},$Tt.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$Tt.disposeResource=function(){for(var $Tt=$TU.mainContext,$TM=this._vertexDeclaration.getVertexElements(),$Tf=$TZ._enableAtributes,$Tc=0,$TD=$TM.length;$Tc<$TD;$Tc++)$Tf[$Tc]===this._glBuffer&&($Tt.disableVertexAttribArray($Tc),$Tf[$Tc]=null);$To.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$Tq(0,$Tt,"vertexDeclaration",function(){return this._vertexDeclaration}),$Tq(0,$Tt,"vertexCount",function(){return this._vertexCount}),$Tq(0,$Tt,"canRead",function(){return this._canRead}),$TJ.create=function($Tt,$TM,$Tf,$Tc,$TD){return void 0===$Tf&&($Tf=35044),void 0===$Tc&&($Tc=!1),new $TJ($Tt,$TM,$Tf,$Tc,$TD)},$TJ}($TZ),$TjM=function($Tt){function $TN(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$TN.__super.call(this),this._type=3553}$TI($TN,"laya.d3.resource.DataTexture2D",$TUM);var $TM=$TN.prototype;return $TM.genDebugMipmaps=function(){var $Tt=[];return $Tt.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$Tt.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$Tt.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$Tt.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$Tt.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$Tt.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$Tt.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$Tt.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$Tt.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$Tt.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$Tt},$TM._onTextureLoaded=function($Tt){},$TM._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $Tt=$TU.mainContext,$TM=this._source=$Tt.createTexture(),$Tf=this._width,$Tc=this._height,$TD=$TF.curBindTexTarget,$To=$TF.curBindTexValue,$TJ=!1;if($TF.bindTexture($Tt,this._type,$TM),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $TZ=0;$Tt.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $TA=0;$TA<this._mipmaps.length;$TA++){if(this._mipmaps[$TA].byteLength!=$TL*$Tp*4)throw"mipmap size error  level:"+$TA;$Tt.texSubImage2D(this._type,0,$TN.simLodRect[$TZ++],$TN.simLodRect[$TZ++],$TN.simLodRect[$TZ++],$TN.simLodRect[$TZ++],6408,5121,new Uint8Array(this._mipmaps[$TA]))}this.minFifter=9729,this.magFifter=9729}else{var $TL=this._width,$Tp=this._height;for($TZ=0,$Tt.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$TA=0;$TA<this._mipmaps.length;$TA++){if(this._mipmaps[$TA].byteLength!=$TL*$Tp*4)throw"mipmap size error  level:"+$TA;$Tt.texImage2D(this._type,$TA,6408,$TL,$Tp,0,6408,5121,new Uint8Array(this._mipmaps[$TA])),($TL/=2)<1&&($TL=1),($Tp/=2)<1&&($Tp=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$Tt.pixelStorei($Tt.UNPACK_ALIGNMENT,1),$Tt.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $TB=0,$Tb=!1,$TI=!1;this._buffer.byteLength==4*$Tf*$Tc?($TB=6408,$Tb=!0):this._buffer.byteLength==3*$Tf*$Tc?($TB=6407,$TI=!0):$TB=this._format,$Tb||$TI?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$TI&&$Tt.pixelStorei($Tt.UNPACK_ALIGNMENT,1),$Tt.texImage2D(this._type,0,$TB,$Tf,$Tc,0,$TB,5121,this._buffer)):$Tt&&$TB==$Tt.ALPHA?($Tt.texImage2D(3553,0,$TB,$Tf,$Tc,0,$TB,$Tt.UNSIGNED_BYTE,this._buffer),$TJ=!0):0!=$TB&&($Tt.compressedTexImage2D(3553,0,$TB,$Tf,$Tc,0,this._buffer),$TJ=!0)}var $Tq=this._minFifter,$Tl=this._magFifter,$T_=0==this._wrapModeU?10497:33071,$TE=0==this._wrapModeV?10497:33071,$Te=$TX.isPOT($Tf,$Tc);$Te?(this._mipmap||this._mipmaps?-1!==$Tq||($Tq=9987):-1!==$Tq||($Tq=9729),-1!==$Tl||($Tl=9729),$Tt.texParameteri(this._type,10241,$Tq),$Tt.texParameteri(this._type,10240,$Tl),$Tt.texParameteri(this._type,10242,$T_),$Tt.texParameteri(this._type,10243,$TE),this._mipmap&&$Tt.generateMipmap(this._type)):(-1!==$Tq||($Tq=9729),-1!==$Tl||($Tl=9729),$Tt.texParameteri(this._type,10241,$Tq),$Tt.texParameteri(this._type,10240,$Tl),$Tt.texParameteri(this._type,10242,33071),$Tt.texParameteri(this._type,10243,33071)),$TD&&$To&&$TF.bindTexture($Tt,$TD,$To),this.memorySize=$TJ?this._buffer.length:$Te?$Tf*$Tc*4*(1+1/3):$Tf*$Tc*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$TM.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$TM.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc;$Tf&&($Tc=$Tf[0].call(this,$TM)),$Tc&&(this._width=$Tc.width,this._height=$Tc.height,this._buffer=$Tc.data),this._src=$Tt,this._size=new $TlM(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$TM.getPixels=function(){return new Uint8Array(this._buffer)},$TM.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($TU.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$Tq(0,$TM,"src",function(){return this._src}),$TN.create=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){if(void 0===$Tc&&($Tc=9729),void 0===$TD&&($TD=9729),void 0===$To&&($To=!0),!$Tt||$Tt.byteLength<$TM*$Tf*4)throw"DataTexture2D create error";var $TZ=new $TN;return $TZ.uri=$TJ,$TZ._buffer=$Tt,$TZ._width=$TM,$TZ._height=$Tf,$TZ._mipmap=$To,$TZ._magFifter=$Tc,$TZ._minFifter=$TD,$TZ._size=new $TlM($TZ._width,$TZ._height),$TZ._conchTexture?alert("怎么给runtime传递datatexture数据"):$TZ.activeResource(),$TZ},$TN.load=function($Tt,$TM,$Tf,$Tc,$TD){if(void 0===$TM&&($TM=0),void 0===$Tf&&($Tf=0),void 0===$Tc&&($Tc=9729),void 0===$TD&&($TD=9729),"mipmaps"===$Tx.getFileExtension($Tt)){var $To=$Ty.loader.create($Tt,null,null,$TN,[function($Tt){this._mipmaps=[];var $TM=new Uint32Array($Tt);this._width=$TM[0];var $Tf=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$Tf=1024),this._width!=$Tf)throw"现在只支持512x256的环境贴图。当前的是"+$TM[0];this._height=$TM[1];for(var $Tc=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$TD=this._height,$To=8;;){var $TJ=$Tc*$TD*4;if($To+$TJ>$Tt.byteLength)throw"load mipmaps data size error ";var $TZ=new Uint8Array($Tt,$To,$TJ);if(this._mipmaps.push($TZ),$To+=$TJ,1==$Tc&&1==$TD)break;($Tc/=2)<1&&($Tc=1),($TD/=2)<1&&($TD=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$To.simLodInfo=new Float32Array(40);for(var $TJ=0;$TJ<$To.simLodInfo.length;)$To.simLodInfo[$TJ]=($TN.simLodRect[$TJ]+.5)/1024,$TJ++,$To.simLodInfo[$TJ]=($TN.simLodRect[$TJ]+.5)/256,$TJ++,$To.simLodInfo[$TJ]=Math.max($TN.simLodRect[$TJ]-1,.1)/1024,$TJ++,$To.simLodInfo[$TJ]=Math.max($TN.simLodRect[$TJ]-1.5,.1)/256,$TJ++}return $To}if("number"==typeof $TM)return $Ty.loader.create($Tt,null,null,$TN,[function($Tt){return this._width=$TM,this._height=$Tf,this._buffer=$Tt,null}]);if("function"==typeof $TM)return $Ty.loader.create($Tt,null,null,$TN,[$TM]);throw new Error("unknown params.")},$TN.lodasatlas=!1,$TB($TN,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$TN}(),$TdM=function($Tt){function $TM(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$TM.__super.call(this)}$TI($TM,"laya.d3.resource.models.PrimitiveMesh",$TFM);var $Tf=$TM.prototype;return $Ty.imps($Tf,{"laya.d3.core.render.IRenderable":!0}),$Tf._getVertexBuffer=function($Tt){return void 0===$Tt&&($Tt=0),0===$Tt?this._vertexBuffer:null},$Tf._getVertexBuffers=function(){return null},$Tf._getIndexBuffer=function(){return this._indexBuffer},$Tf._getPositions=function(){var $Tt,$TM=[],$Tf=this._vertexBuffer.vertexDeclaration.getVertexElements(),$Tc=0;for($Tc=0;$Tc<$Tf.length;$Tc++){var $TD=$Tf[$Tc];if("vector3"===$TD.elementFormat&&0===$TD.elementUsage){$Tt=$TD;break}}var $To=this._vertexBuffer.getData();for($Tc=0;$Tc<$To.length;$Tc+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $TJ=$Tc+$Tt.offset/4,$TZ=new $TJM($To[$TJ+0],$To[$TJ+1],$To[$TJ+2]);$TM.push($TZ)}return $TM},$Tf.getRenderElement=function($Tt){return this},$Tf.getRenderElementsCount=function(){return 1},$Tf.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$Tf._beforeRender=function($Tt){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Tf._render=function($Tt){$TU.mainContext.drawElements(4,this._numberIndices,5123,0),$Ti.drawCall++,$Ti.trianglesFaces+=this._numberIndices/3},$Tq(0,$Tf,"_vertexBufferCount",function(){return 1}),$Tq(0,$Tf,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$TM}(),$T$M=function($Tt){function $TM(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$TM.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$TI($TM,"laya.d3.resource.models.Mesh",$TFM);var $Tf=$TM.prototype;return $Tf._getPositions=function(){var $Tt,$TM,$Tf,$Tc,$TD,$To=[],$TJ=0,$TZ=0,$TA=0;if(0!==this._vertexBuffers.length){var $TL=this._vertexBuffers.length;for($TJ=0;$TJ<$TL;$TJ++){for($Tf=($Tt=this._vertexBuffers[$TJ]).vertexDeclaration.getVertexElements(),$TZ=0;$TZ<$Tf.length;$TZ++)if("vector3"===($Tc=$Tf[$TZ]).elementFormat&&0===$Tc.elementUsage){$TM=$Tc;break}for($TD=$Tt.getData(),$TZ=0;$TZ<$TD.length;$TZ+=$Tt.vertexDeclaration.vertexStride/4)$TA=$TZ+$TM.offset/4,$To.push(new $TJM($TD[$TA+0],$TD[$TA+1],$TD[$TA+2]))}}else{var $Tp=this._subMeshes.length;for($TJ=0;$TJ<$Tp;$TJ++){for($Tf=($Tt=this._subMeshes[$TJ]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$TZ=0;$TZ<$Tf.length;$TZ++)if("vector3"===($Tc=$Tf[$TZ]).elementFormat&&0===$Tc.elementUsage){$TM=$Tc;break}for($TD=$Tt.getData(),$TZ=0;$TZ<$TD.length;$TZ+=$Tt.vertexDeclaration.vertexStride/4)$TA=$TZ+$TM.offset/4,$To.push(new $TJM($TD[$TA+0],$TD[$TA+1],$TD[$TA+2]))}}return $To},$Tf._setSubMeshes=function($Tt){this._subMeshes=$Tt,this._subMeshCount=$Tt.length;for(var $TM=0;$TM<this._subMeshCount;$TM++)$Tt[$TM]._indexInMesh=$TM;this._positions=this._getPositions(),this._generateBoundingObject()},$Tf.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=$TM[0],$TD=$TM[1];$Tmt.read($Tc,this,this._materials,this._subMeshes,$TD),this.completeCreate(),this._endLoaded()},$Tf.getSubMesh=function($Tt){return this._subMeshes[$Tt]},$Tf.getSubMeshCount=function(){return this._subMeshes.length},$Tf.getRenderElementsCount=function(){return this._subMeshes.length},$Tf.getRenderElement=function($Tt){return this._subMeshes[$Tt]},$Tf.disposeResource=function(){for(var $Tt=0;$Tt<this._subMeshes.length;$Tt++)this._subMeshes[$Tt].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$Tq(0,$Tf,"materials",function(){return this._materials.slice()}),$Tq(0,$Tf,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$TM.load=function($Tt){return $Ty.loader.create($Tt,null,null,$TM)},$TM}(),$TPM=(function($Tt){function $TL($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=5121),void 0===$TD&&($TD=33189),void 0===$To&&($To=!1),void 0===$TJ&&($TJ=!1),void 0===$TZ&&($TZ=-1),void 0===$TA&&($TA=-1),$TL.__super.call(this),this._type=3553,this._width=$Tt,this._height=$TM,this._size=new $TlM($Tt,$TM),this._surfaceFormat=$Tf,this._surfaceType=$Tc,this._depthStencilFormat=$TD,$Tl.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$To,this._repeat=$TJ,this._minFifter=$TZ,this._magFifter=$TA,this.activeResource(),this._alreadyResolved=!0}$TI($TL,"laya.d3.resource.RenderTexture",$TUM);var $TM=$TL.prototype;$TM.recreateResource=function(){var $Tt=$TU.mainContext;this._frameBuffer=$Tt.createFramebuffer(),this._source=$Tt.createTexture();var $TM=$TF.curBindTexTarget,$Tf=$TF.curBindTexValue;$TF.bindTexture($Tt,this._type,this._source),$Tt.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $Tc=this._minFifter,$TD=this._magFifter,$To=this._repeat?10497:33071;if($TX.isPOT(this._width,this._height)?(this._mipmap?-1!==$Tc||($Tc=9987):-1!==$Tc||($Tc=9729),-1!==$TD||($TD=9729),$Tt.texParameteri(this._type,10241,$Tc),$Tt.texParameteri(this._type,10240,$TD),$Tt.texParameteri(this._type,10242,$To),$Tt.texParameteri(this._type,10243,$To),this._mipmap&&$Tt.generateMipmap(this._type)):(-1!==$Tc||($Tc=9729),-1!==$TD||($TD=9729),$Tt.texParameteri(this._type,10241,$Tc),$Tt.texParameteri(this._type,10240,$TD),$Tt.texParameteri(this._type,10242,33071),$Tt.texParameteri(this._type,10243,33071)),$TM&&$Tf&&$TF.bindTexture($Tt,$TM,$Tf),$Tt.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$Tt.createRenderbuffer(),$Tt.bindRenderbuffer(36161,this._depthStencilBuffer),$Tt.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$Tt.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$Tt.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$Tt.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$Tt.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$Tt.framebufferTexture2D(36160,36064,3553,this._source,0),$Tt.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$TM.start=function(){$TU.mainContext.bindFramebuffer(36160,this.frameBuffer),($TL._currentRenderTarget=this)._alreadyResolved=!1},$TM.end=function(){$TU.mainContext.bindFramebuffer(36160,null),$TL._currentRenderTarget=null,this._alreadyResolved=!0},$TM.getData=function($Tt,$TM,$Tf,$Tc){var $TD=$TU.mainContext;if($TD.bindFramebuffer(36160,this._frameBuffer),!(36053===$TD.checkFramebufferStatus(36160)))return $TD.bindFramebuffer(36160,null),null;var $To=new Uint8Array(this._width*this._height*4);return $TD.readPixels($Tt,$TM,$Tf,$Tc,this._surfaceFormat,this._surfaceType,$To),$TD.bindFramebuffer(36160,null),$To},$TM.disposeResource=function(){if(this._frameBuffer){var $Tt=$TU.mainContext;$Tt.deleteTexture(this._source),$Tt.deleteFramebuffer(this._frameBuffer),$Tt.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$Tq(0,$TM,"surfaceFormat",function(){return this._surfaceFormat}),$Tq(0,$TM,"surfaceType",function(){return this._surfaceType}),$Tq(0,$TM,"depthStencilFormat",function(){return this._depthStencilFormat}),$Tq(0,$TM,"source",function(){return this._alreadyResolved?$Ty.superGet($TUM,this,"source"):null}),$Tq(0,$TM,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$Tq(0,$TM,"frameBuffer",function(){return this._frameBuffer}),$TL._currentRenderTarget=null}(),function($Tt){function $TM($Tt){this._color=null,this._pixels=null,$TM.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $TlM(this.width,this.height),this._color=$Tt,this._pixels=new Uint8Array([255*$Tt.x,255*$Tt.y,255*$Tt.z,255*$Tt.w]),this.uri="SolidColorTexture2D_"+this.id}$TI($TM,"laya.d3.resource.SolidColorTexture2D",$TUM);var $Tf=$TM.prototype;return $Tf._createWebGlTexture=function(){var $Tt=$TU.mainContext,$TM=this._source=$Tt.createTexture(),$Tf=this._width,$Tc=this._height,$TD=$TF.curBindTexTarget,$To=$TF.curBindTexValue;$TF.bindTexture($Tt,this._type,$TM),$Tt.texImage2D(this._type,0,6408,$Tf,$Tc,0,6408,5121,this._pixels);var $TJ=this._minFifter,$TZ=this._magFifter,$TA=this._repeat?10497:33071,$TL=$TX.isPOT($Tf,$Tc);$TL?(this._mipmap?-1!==$TJ||($TJ=9987):-1!==$TJ||($TJ=9729),-1!==$TZ||($TZ=9729),$Tt.texParameteri(this._type,10241,$TJ),$Tt.texParameteri(this._type,10240,$TZ),$Tt.texParameteri(this._type,10242,$TA),$Tt.texParameteri(this._type,10243,$TA),this._mipmap&&$Tt.generateMipmap(this._type)):(-1!==$TJ||($TJ=9729),-1!==$TZ||($TZ=9729),$Tt.texParameteri(this._type,10241,$TJ),$Tt.texParameteri(this._type,10240,$TZ),$Tt.texParameteri(this._type,10242,33071),$Tt.texParameteri(this._type,10243,33071)),$TD&&$To&&$TF.bindTexture($Tt,$TD,$To),this.memorySize=$TL?$Tf*$Tc*4*(1+1/3):$Tf*$Tc*4},$Tf.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$Tf.disposeResource=function(){this._source&&($TU.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$TB($TM,["magentaTexture",function(){var $Tt=new $TM(new $TZM(1,0,1,1));return $Tt.lock=!0,this.magentaTexture=$Tt},"grayTexture",function(){var $Tt=new $TM(new $TZM(.5,.5,.5,1));return $Tt.lock=!0,this.grayTexture=$Tt}]),$TM}()),$TYM=function($Tt){function $TD($Tt,$TM,$Tf,$Tc){this._canRead=!1,this._image=null,this._pixels=null,void 0===$Tt&&($Tt=!1),void 0===$TM&&($TM=!0),void 0===$Tf&&($Tf=6408),void 0===$Tc&&($Tc=!0),$TD.__super.call(this),this._type=3553,this._repeat=$TM,this._canRead=$Tt,this._format=$Tf,this._mipmap=$Tc}$TI($TD,"laya.d3.resource.Texture2D",$TUM);var $TM=$TD.prototype;return $TM._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $Tt=$TU.mainContext,$TM=this._source=$Tt.createTexture(),$Tf=this._width,$Tc=this._height,$TD=$TF.curBindTexTarget,$To=$TF.curBindTexValue;switch($TF.bindTexture($Tt,this._type,$TM),this._format){case 6407:case 6408:this._canRead?$Tt.texImage2D(this._type,0,this._format,$Tf,$Tc,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$Tt.texImage2D(this._type,0,this._image._format,$Tf,$Tc,0,this._image._format,5121,this._image.atlasSource):$Tt.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $TU.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$Tt.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $TJ=this._minFifter,$TZ=this._magFifter,$TA=this._repeat?10497:33071,$TL=0==this._wrapModeU?10497:33071,$Tp=0==this._wrapModeV?10497:33071,$TB=$TX.isPOT($Tf,$Tc);$TB?(this._mipmap?-1!==$TJ||($TJ=9987):-1!==$TJ||($TJ=9729),-1!==$TZ||($TZ=9729),$Tt.texParameteri(this._type,10241,$TJ),$Tt.texParameteri(this._type,10240,$TZ),$Tt.texParameteri(this._type,10242,$TA),$Tt.texParameteri(this._type,10243,$TA),$Tt.texParameteri(this._type,10242,$TL),$Tt.texParameteri(this._type,10243,$Tp),this._mipmap&&$Tt.generateMipmap(this._type)):(-1!==$TJ||($TJ=9729),-1!==$TZ||($TZ=9729),$Tt.texParameteri(this._type,10241,$TJ),$Tt.texParameteri(this._type,10240,$TZ),$Tt.texParameteri(this._type,10242,33071),$Tt.texParameteri(this._type,10243,33071)),$TD&&$To&&$TF.bindTexture($Tt,$TD,$To),this._image.onload=null,this._image=null,this.memorySize=$TB?$Tf*$Tc*4*(1+1/3):$Tf*$Tc*4},$TM.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$TM.onAsynLoaded=function($Tt,$TM,$Tf){if($Tf){var $Tc=$Tf[0];void 0!==$Tc&&(this._canRead=$Tc);var $TD=$Tf[1];void 0!==$TD&&(this._repeat=$TD);var $To=$Tf[2];void 0!==$To&&(this._format=$To);var $TJ=$Tf[3];void 0!==$TJ&&(this._mipmap=$TJ);var $TZ=$Tf.wrapModeU;void 0!==$TZ&&(this._wrapModeU=$TZ);var $TA=$Tf.wrapModeV;void 0!==$TA&&(this._wrapModeV=$TA)}switch(this._format){case 6407:case 6408:var $TL=(this._image=$TM).width,$Tp=$TM.height;this._width=$TL,this._height=$Tp,this._size=new $TlM($TL,$Tp),this._canRead&&($Tl.isConchApp?$TM instanceof $Tb.HTMLElement&&(this._pixels=new Uint8Array($TM.getImageData(0,0,$TL,$Tp))):($TS.canvas.size($TL,$Tp),$TS.canvas.clear(),$TS.context.drawImage($TM,0,0,$TL,$Tp),this._pixels=new Uint8Array($TS.context.getImageData(0,0,$TL,$Tp).data.buffer)));break;case $TU.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $TB=new $Th($TM);$TB.readUTFBytes(4),$TB.readUTFBytes(2),$TB.getInt16();$TB.endian="bigEndian",this._width=$TB.getInt16(),this._height=$TB.getInt16(),this._size=new $TlM(this._width,this._height);$TB.getInt16(),$TB.getInt16();this._image=new Uint8Array($TM,$TB.pos)}this.recreateResource(),this._endLoaded()},$TM.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$TM.disposeResource=function(){this._source&&($TU.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$Tq(0,$TM,"_src",function(){return this.url}),$Tq(0,$TM,"src",function(){return this.url}),$TD.load=function($Tt){return $Ty.loader.create($Tt,null,null,$TD)},$TD}(),$TnM=function($TM){function $Tf($Tt,$TM){$Tf.__super.call(this),void 0===$Tt&&($Tt=.3),void 0===$TM&&($TM=1e3),this._tempVector3=new $TJM,this._position=new $TJM,this._up=new $TJM,this._forward=new $TJM,this._right=new $TJM,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$TlM.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$Tt,this._farPlane=$TM,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$Ty.stage.on("resize",this,this._onScreenSizeChanged)}$TI($Tf,"laya.d3.core.BaseCamera",$TM);var $Tt=$Tf.prototype;return $Tt._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $Tt=this.scene._cameraPool,$TM=$Tt.length-1,$Tf=0;$Tf<$TM;$Tf++)if($Tt[$Tf].renderingOrder>$Tt[$TM].renderingOrder){var $Tc=$Tt[$Tf];$Tt[$Tf]=$Tt[$TM],$Tt[$TM]=$Tc}},$Tt._calculateProjectionMatrix=function(){},$Tt._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$Tt._prepareCameraToRender=function(){$TH._currentCameraCullingMask=this.cullingMask;var $Tt=this._shaderValues;$Tt.setValue(0,this.transform.position.elements),$Tt.setValue(5,this.forward.elements),$Tt.setValue(6,this.up.elements)},$Tt._prepareCameraViewProject=function($Tt,$TM){var $Tf=this._shaderValues;$Tf.setValue(1,$Tt.elements),$Tf.setValue(2,$TM.elements)},$Tt._renderCamera=function($Tt,$TM,$Tf){},$Tt.addLayer=function($Tt){29!==$Tt.number&&30!=$Tt.number&&(this.cullingMask=this.cullingMask|$Tt.mask)},$Tt.removeLayer=function($Tt){29!==$Tt.number&&30!=$Tt.number&&(this.cullingMask=this.cullingMask&~$Tt.mask)},$Tt.addAllLayers=function(){this.cullingMask=2147483647},$Tt.removeAllLayers=function(){this.cullingMask=0|$TH.getLayerByNumber(29).mask|$TH.getLayerByNumber(30).mask},$Tt.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$Tt.moveForward=function($Tt){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$Tt,this.transform.translate(this._tempVector3)},$Tt.moveRight=function($Tt){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$Tt,this.transform.translate(this._tempVector3)},$Tt.moveVertical=function($Tt){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$Tt,this.transform.translate(this._tempVector3,!1)},$Tt._addSelfRenderObjects=function(){var $Tt=this.scene._cameraPool,$TM=$Tt.length;if(0<$TM){for(var $Tf=$TM-1;0<=$Tf;$Tf--)if(this.renderingOrder<=$Tt[$Tf].renderingOrder){$Tt.splice($Tf+1,0,this);break}}else $Tt.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$Tt._clearSelfRenderObjects=function(){var $Tt=this.scene._cameraPool;$Tt.splice($Tt.indexOf(this),1)},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$Ty.stage.off("resize",this,this._onScreenSizeChanged),$TM.prototype.destroy.call(this,$Tt)},$Tq(0,$Tt,"sky",function(){return this._sky},function($Tt){(this._sky=$Tt)._ownerCamera=this}),$Tq(0,$Tt,"forward",function(){var $Tt=this.transform.worldMatrix.elements,$TM=this._forward.elements;return $TM[0]=-$Tt[8],$TM[1]=-$Tt[9],$TM[2]=-$Tt[10],this._forward}),$Tq(0,$Tt,"position",function(){var $Tt=this.transform.worldMatrix.elements,$TM=this._position.elements;return $TM[0]=$Tt[12],$TM[1]=$Tt[13],$TM[2]=$Tt[14],this._position}),$Tq(0,$Tt,"renderTarget",function(){return this._renderTarget},function($Tt){null!=(this._renderTarget=$Tt)&&(this._renderTargetSize=$Tt.size)}),$Tq(0,$Tt,"up",function(){var $Tt=this.transform.worldMatrix.elements,$TM=this._up.elements;return $TM[0]=$Tt[4],$TM[1]=$Tt[5],$TM[2]=$Tt[6],this._up}),$Tq(0,$Tt,"right",function(){var $Tt=this.transform.worldMatrix.elements,$TM=this._right.elements;return $TM[0]=$Tt[0],$TM[1]=$Tt[1],$TM[2]=$Tt[2],this._right}),$Tq(0,$Tt,"renderTargetSize",function(){return this._renderTargetSize},function($Tt){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"fieldOfView",function(){return this._fieldOfView},function($Tt){this._fieldOfView=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"nearPlane",function(){return this._nearPlane},function($Tt){this._nearPlane=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"farPlane",function(){return this._farPlane},function($Tt){this._farPlane=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"orthographic",function(){return this._orthographic},function($Tt){this._orthographic=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($Tt){this._orthographicVerticalSize=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$Tt,"renderingOrder",function(){return this._renderingOrder},function($Tt){this._renderingOrder=$Tt,this._sortCamerasByRenderingOrder()}),$Tf.CAMERAPOS=0,$Tf.VIEWMATRIX=1,$Tf.PROJECTMATRIX=2,$Tf.VPMATRIX=3,$Tf.VPMATRIX_NO_TRANSLATE=4,$Tf.CAMERADIRECTION=5,$Tf.CAMERAUP=6,$Tf.ENVIRONMENTDIFFUSE=7,$Tf.ENVIRONMENTSPECULAR=8,$Tf.SIMLODINFO=9,$Tf.DIFFUSEIRRADMATR=10,$Tf.DIFFUSEIRRADMATG=11,$Tf.DIFFUSEIRRADMATB=12,$Tf.HDREXPOSURE=13,$Tf.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$Tf.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$Tf.CLEARFLAG_SOLIDCOLOR=0,$Tf.CLEARFLAG_SKY=1,$Tf.CLEARFLAG_DEPTHONLY=2,$Tf.CLEARFLAG_NONE=3,$TB($Tf,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $TtM(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $TtM},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $TtM}]),$Tf}($TrM),$TRM=function($Tf){function $TM($Tt){this._render=null,this._geometryFilter=null,$TM.__super.call(this,$Tt)}$TI($TM,"laya.d3.core.RenderableSprite3D",$Tf);var $Tt=$TM.prototype;return $Tt._addToInitStaticBatchManager=function(){},$Tt._setBelongScene=function($Tt){$Tf.prototype._setBelongScene.call(this,$Tt),$Tt._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$Tt._setUnBelongScene=function(){var $Tt=this._scene._renderableSprite3Ds,$TM=$Tt.indexOf(this);$Tt.splice($TM,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$Tf.prototype._setUnBelongScene.call(this)},$Tt._update=function($Tt){($Tt.owner=this)._activeInHierarchy&&(this._updateComponents($Tt),this._render._updateOctreeNode(),this._lateUpdateComponents($Tt),$Ti.spriteCount++,this._childs.length&&this._updateChilds($Tt))},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$Tf.prototype.destroy.call(this,$Tt),this._render._destroy(),this._render=null},$TM.__init__=function(){$TM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$TM.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$TM.SAHDERDEFINE_LIGHTMAP=$TM.shaderDefines.registerDefine("LIGHTMAP")},$TM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$TM.SAHDERDEFINE_LIGHTMAP=4,$TM.LIGHTMAPSCALEOFFSET=2,$TM.LIGHTMAP=3,$TB($TM,["shaderDefines",function(){return this.shaderDefines=new $TpM}]),$TM}($TrM),$TgM=(function($Tt){function $Tc($Tt,$TM,$Tf){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$Tt&&($Tt=1),void 0===$TM&&($TM=1),void 0===$Tf&&($Tf=1),$Tc.__super.call(this),this._long=$Tt,this._width=$TM,this._height=$Tf,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$TI($Tc,"laya.d3.resource.models.BoxMesh",$TdM);var $TM=$Tc.prototype;$TM.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $Tt=$TUt.vertexDeclaration,$TM=($Tt.vertexStride,this._long/2),$Tf=this._height/2,$Tc=this._width/2,$TD=new Float32Array([-$TM,$Tf,-$Tc,0,1,0,0,0,$TM,$Tf,-$Tc,0,1,0,1,0,$TM,$Tf,$Tc,0,1,0,1,1,-$TM,$Tf,$Tc,0,1,0,0,1,-$TM,-$Tf,-$Tc,0,-1,0,0,1,$TM,-$Tf,-$Tc,0,-1,0,1,1,$TM,-$Tf,$Tc,0,-1,0,1,0,-$TM,-$Tf,$Tc,0,-1,0,0,0,-$TM,$Tf,-$Tc,-1,0,0,0,0,-$TM,$Tf,$Tc,-1,0,0,1,0,-$TM,-$Tf,$Tc,-1,0,0,1,1,-$TM,-$Tf,-$Tc,-1,0,0,0,1,$TM,$Tf,-$Tc,1,0,0,1,0,$TM,$Tf,$Tc,1,0,0,0,0,$TM,-$Tf,$Tc,1,0,0,0,1,$TM,-$Tf,-$Tc,1,0,0,1,1,-$TM,$Tf,$Tc,0,0,1,0,0,$TM,$Tf,$Tc,0,0,1,1,0,$TM,-$Tf,$Tc,0,0,1,1,1,-$TM,-$Tf,$Tc,0,0,1,0,1,-$TM,$Tf,-$Tc,0,0,-1,1,0,$TM,$Tf,-$Tc,0,0,-1,0,0,$TM,-$Tf,-$Tc,0,0,-1,0,1,-$TM,-$Tf,-$Tc,0,0,-1,1,1]),$To=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $TKM($Tt,this._numberVertices,35044,!0),this._indexBuffer=new $TkM("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($TD),this._indexBuffer.setData($To),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$Tq(0,$TM,"long",function(){return this._long},function($Tt){this._long!==$Tt&&(this._long=$Tt,this.releaseResource(),this.activeResource())}),$Tq(0,$TM,"width",function(){return this._width},function($Tt){this._width!==$Tt&&(this._width=$Tt,this.releaseResource(),this.activeResource())}),$Tq(0,$TM,"height",function(){return this._height},function($Tt){this._height!==$Tt&&(this._height=$Tt,this.releaseResource(),this.activeResource())})}(),function($Tt){function $TD($Tt,$TM,$Tf,$Tc){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$Tt&&($Tt=10),void 0===$TM&&($TM=10),void 0===$Tf&&($Tf=10),void 0===$Tc&&($Tc=10),$TD.__super.call(this),this._long=$Tt,this._width=$TM,this._stacks=$Tf,this._slices=$Tc,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$TI($TD,"laya.d3.resource.models.PlaneMesh",$TdM);var $TM=$TD.prototype;$TM.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $Tt=new Uint16Array(this._numberIndices),$TM=$TUt.vertexDeclaration,$Tf=$TM.vertexStride/4,$Tc=new Float32Array(this._numberVertices*$Tf),$TD=this._long/2,$To=this._width/2,$TJ=this._long/this._stacks,$TZ=this._width/this._slices,$TA=0,$TL=0;$TL<=this._slices;$TL++)for(var $Tp=0;$Tp<=this._stacks;$Tp++)$Tc[$TA++]=$Tp*$TJ-$TD,$Tc[$TA++]=0,$Tc[$TA++]=$TL*$TZ-$To,$Tc[$TA++]=0,$Tc[$TA++]=1,$Tc[$TA++]=0,$Tc[$TA++]=1*$Tp/this._stacks,$Tc[$TA++]=1*$TL/this._slices;var $TB=0;for($TL=0;$TL<this._slices;$TL++)for($Tp=0;$Tp<this._stacks;$Tp++)$Tt[$TB++]=($TL+1)*(this._stacks+1)+$Tp,$Tt[$TB++]=$TL*(this._stacks+1)+$Tp,$Tt[$TB++]=($TL+1)*(this._stacks+1)+$Tp+1,$Tt[$TB++]=$TL*(this._stacks+1)+$Tp,$Tt[$TB++]=$TL*(this._stacks+1)+$Tp+1,$Tt[$TB++]=($TL+1)*(this._stacks+1)+$Tp+1;this._vertexBuffer=new $TKM($TM,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $TkM("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($Tc),this._indexBuffer.setData($Tt),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$Tq(0,$TM,"long",function(){return this._long},function($Tt){this._long!==$Tt&&(this._long=$Tt,this.releaseResource(),this.activeResource())}),$Tq(0,$TM,"width",function(){return this._width},function($Tt){this._width!==$Tt&&(this._width=$Tt,this.releaseResource(),this.activeResource())}),$Tq(0,$TM,"stacks",function(){return this._stacks},function($Tt){this._stacks!==$Tt&&(this._stacks=$Tt,this.releaseResource(),this.activeResource())}),$Tq(0,$TM,"slices",function(){return this._slices},function($Tt){this._slices!==$Tt&&(this._slices=$Tt,this.releaseResource(),this.activeResource())})}(),function($Tt){function $TJ($Tt,$TM,$Tf){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=.3),void 0===$Tf&&($Tf=1e3),this._viewMatrix=new $TtM,this._projectionMatrix=new $TtM,this._projectionViewMatrix=new $TtM,this._viewport=new $TAM(0,0,0,0),this._normalizedViewport=new $TAM(0,0,1,1),this._aspectRatio=$Tt,this._boundFrustumUpdate=!0,this._boundFrustum=new $Tat($TtM.DEFAULT),$TJ.__super.call(this,$TM,$Tf),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$TI($TJ,"laya.d3.core.Camera",$TnM);var $TM=$TJ.prototype;return $TM._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$TM._parseCustomProps=function($Tt,$TM,$Tf,$Tc){var $TD=$Tf.clearColor;this.clearColor=new $TZM($TD[0],$TD[1],$TD[2],$TD[3]);var $To=$Tf.viewport;this.normalizedViewport=new $TAM($To[0],$To[1],$To[2],$To[3])},$TM._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $Tt=this.orthographicVerticalSize*this.aspectRatio*.5,$TM=.5*this.orthographicVerticalSize;$TtM.createOrthoOffCenterRH(-$Tt,$Tt,-$TM,$TM,this.nearPlane,this.farPlane,this._projectionMatrix)}else $TtM.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$TM._update=function($Tt){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$Tt)},$TM._renderCamera=function($Tt,$TM,$Tf){var $Tc,$TD;$Tf.parallelSplitShadowMaps[0]&&$Tf._renderShadowMap($Tt,$TM,this),($TM.camera=this)._prepareCameraToRender(),$Tf._preRenderUpdateComponents($TM),$Tc=$TM._viewMatrix=this.viewMatrix;var $To=this._renderTarget;$To?($To.start(),$TtM.multiply($TnM._invertYScaleMatrix,this._projectionMatrix,$TnM._invertYProjectionMatrix),$TtM.multiply($TnM._invertYScaleMatrix,this.projectionViewMatrix,$TnM._invertYProjectionViewMatrix),$TD=$TM._projectionMatrix=$TnM._invertYProjectionMatrix,$TM._projectionViewMatrix=$TnM._invertYProjectionViewMatrix):($TD=$TM._projectionMatrix=this._projectionMatrix,$TM._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($Tc,$TD),$TM._viewport=this.viewport,$Tf._preRenderScene($Tt,$TM,this.boundFrustum),$Tf._clear($Tt,$TM),$Tf._renderScene($Tt,$TM),$Tf._postRenderUpdateComponents($TM),$To&&$To.end()},$TM.viewportPointToRay=function($Tt,$TM){$TqM.calculateCursorRay($Tt,this.viewport,this._projectionMatrix,this.viewMatrix,null,$TM)},$TM.normalizedViewportPointToRay=function($Tt,$TM){var $Tf=$TJ._tempVector20,$Tc=this.viewport,$TD=$Tt.elements,$To=$Tf.elements;$To[0]=$TD[0]*$Tc.width,$To[1]=$TD[1]*$Tc.height,$TqM.calculateCursorRay($Tf,this.viewport,this._projectionMatrix,this.viewMatrix,null,$TM)},$TM.worldToViewportPoint=function($Tt,$TM){$TtM.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($Tt,this._projectionViewMatrix,$TM);var $Tf=$TM.elements;$Tf[0]=$Tf[0]/$Ty.stage.clientScaleX,$Tf[1]=$Tf[1]/$Ty.stage.clientScaleY},$TM.worldToNormalizedViewportPoint=function($Tt,$TM){$TtM.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($Tt,this._projectionViewMatrix,$TM);var $Tf=$TM.elements;$Tf[0]=$Tf[0]/$Ty.stage.clientScaleX,$Tf[1]=$Tf[1]/$Ty.stage.clientScaleY},$TM.convertScreenCoordToOrthographicCoord=function($Tt,$TM){if(this._orthographic){var $Tf=$Tm.clientWidth,$Tc=$Tm.clientHeight,$TD=this.orthographicVerticalSize*this.aspectRatio/$Tf,$To=this.orthographicVerticalSize/$Tc,$TJ=$Tt.elements,$TZ=$TM.elements;return $TZ[0]=(-$Tf/2+$TJ[0])*$TD,$TZ[1]=($Tc/2-$TJ[1])*$To,$TZ[2]=(this.nearPlane-this.farPlane)*($TJ[2]+1)/2-this.nearPlane,$TJM.transformCoordinate($TM,this.transform.worldMatrix,$TM),!0}return!1},$Tq(0,$TM,"projectionViewMatrix",function(){return $TtM.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$Tq(0,$TM,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $Tt=this.viewport;return $Tt.width/$Tt.height},function($Tt){if($Tt<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$TM,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$Tq(0,$TM,"needViewport",function(){var $Tt=this.normalizedViewport;return 0===$Tt.x&&0===$Tt.y&&1===$Tt.width&&1===$Tt.height}),$Tq(0,$TM,"viewport",function(){if(this._viewportExpressedInClipSpace){var $Tt=this._normalizedViewport,$TM=this.renderTargetSize,$Tf=$TM.width,$Tc=$TM.height;this._viewport.x=$Tt.x*$Tf,this._viewport.y=$Tt.y*$Tc,this._viewport.width=$Tt.width*$Tf,this._viewport.height=$Tt.height*$Tc}return this._viewport},function($Tt){if(null!=this.renderTarget&&($Tt.x<0||$Tt.y<0||0==$Tt.width||0==$Tt.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$TM,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $Tt=this._viewport,$TM=this.renderTargetSize,$Tf=$TM.width,$Tc=$TM.height;this._normalizedViewport.x=$Tt.x/$Tf,this._normalizedViewport.y=$Tt.y/$Tc,this._normalizedViewport.width=$Tt.width/$Tf,this._normalizedViewport.height=$Tt.height/$Tc}return this._normalizedViewport},function($Tt){$Tt.x<0&&($Tt.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$Tt.y<0&&($Tt.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$Tt.x+$Tt.width&&($Tt.width=1-$Tt.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$Tt.y+$Tt.height&&($Tt.height=1-$Tt.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$Tt,this._calculateProjectionMatrix()}),$Tq(0,$TM,"projectionMatrix",function(){return this._projectionMatrix},function($Tt){this._projectionMatrix=$Tt,this._useUserProjectionMatrix=!0}),$Tq(0,$TM,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$TB($TJ,["_tempVector20",function(){return this._tempVector20=new $ToM}]),$TJ}()),$TzM=function($Tf){function $Tc($Tt,$TM){$Tc.__super.call(this,$TM),this._geometryFilter=new $TSM(this),this._render=new $THM(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$Tt&&(this._geometryFilter.sharedMesh=$Tt)instanceof laya.d3.resource.models.Mesh&&($Tt.loaded?this._render.sharedMaterials=$Tt.materials:$Tt.once("loaded",this,this._applyMeshMaterials))}$TI($Tc,"laya.d3.core.MeshSprite3D",$Tf);var $Tt=$Tc.prototype;return $Tt._changeRenderObjectByMesh=function($Tt){var $TM=this._render._renderElements,$Tf=$TM[$Tt];$Tf||($Tf=$TM[$Tt]=new $TTM),$Tf._render=this._render;var $Tc=this._render.sharedMaterials[$Tt];$Tc||($Tc=$TvM.defaultMaterial);var $TD=this._geometryFilter.sharedMesh.getRenderElement($Tt);return $Tf._mainSortID=this._getSortID($TD,$Tc),$Tf._sprite3D=this,$Tf.renderObj=$TD,$Tf._material=$Tc,$Tf},$Tt._changeRenderObjectByMaterial=function($Tt,$TM){var $Tf=this._render._renderElements[$Tt];$TM||($TM=$TvM.defaultMaterial);var $Tc=this._geometryFilter.sharedMesh.getRenderElement($Tt);return $Tf._mainSortID=this._getSortID($Tc,$TM),$Tf._sprite3D=this,$Tf.renderObj=$Tc,$Tf._material=$TM,$Tf},$Tt._changeRenderObjectsByMesh=function(){var $Tt=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$Tt;for(var $TM=0;$TM<$Tt;$TM++)this._changeRenderObjectByMesh($TM)},$Tt._onMeshChanged=function($Tt){var $TM=$Tt.sharedMesh;$TM.loaded?this._changeRenderObjectsByMesh():$TM.once("loaded",this,this._onMeshLoaded)},$Tt._onMeshLoaded=function($Tt){$Tt===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$Tt._onMaterialChanged=function($Tt,$TM,$Tf){$TM<this._render._renderElements.length&&this._changeRenderObjectByMaterial($TM,$Tf)},$Tt._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$Tt._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$Tt._parseCustomProps=function($Tt,$TM,$Tf,$Tc){var $TD=this.meshRender,$To=$Tf.lightmapIndex;null!=$To&&($TD.lightmapIndex=$To);var $TJ,$TZ,$TA=$Tf.lightmapScaleOffset;if($TA&&($TD.lightmapScaleOffset=new $TZM($TA[0],$TA[1],$TA[2],$TA[3])),$Tc.instanceParams)($TJ=$Tc.instanceParams.loadPath)&&($TZ=$TE.getRes($TM[$TJ]),(this.meshFilter.sharedMesh=$TZ).loaded?$TD.sharedMaterials=$TZ.materials:$TZ.once("loaded",this,this._applyMeshMaterials));else{($TJ=$Tf.meshPath)&&($TZ=$TE.getRes($TM[$TJ]),this.meshFilter.sharedMesh=$TZ);var $TL=$Tf.materials;if($TL){var $Tp=$TD.sharedMaterials,$TB=$TL.length;$Tp.length=$TB;for(var $Tb=0;$Tb<$TB;$Tb++)$Tp[$Tb]=$TE.getRes($TM[$TL[$Tb].path]);$TD.sharedMaterials=$Tp}}},$Tt._applyMeshMaterials=function($Tt){for(var $TM=this._render.sharedMaterials,$Tf=$Tt.materials,$Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++)$TM[$Tc]||($TM[$Tc]=$Tf[$Tc]);this._render.sharedMaterials=$TM},$Tt._addToInitStaticBatchManager=function(){$Tc._staticBatchManager._addInitBatchSprite(this)},$Tt.cloneTo=function($Tt){var $TM=$Tt;$TM._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $Tf=this._render,$Tc=$TM._render;$Tc.enable=$Tf.enable,$Tc.sharedMaterials=$Tf.sharedMaterials,$Tc.castShadow=$Tf.castShadow;var $TD=$Tf.lightmapScaleOffset;$TD&&($Tc.lightmapScaleOffset=$TD.clone()),$Tc.lightmapIndex=$Tf.lightmapIndex,$Tc.receiveShadow=$Tf.receiveShadow,$Tc.sortingFudge=$Tf.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$Tt)},$Tt.destroy=function($Tt){if(void 0===$Tt&&($Tt=!0),!this.destroyed){var $TM=this.meshFilter.sharedMesh;null!=$TM&&($TM.loaded||$TM.off("loaded",this,this._applyMeshMaterials)),$Tf.prototype.destroy.call(this,$Tt),this._geometryFilter._destroy()}},$Tq(0,$Tt,"meshFilter",function(){return this._geometryFilter}),$Tq(0,$Tt,"meshRender",function(){return this._render}),$Tc.__init__=function(){$Tct._staticBatchManagers.push($Tc._staticBatchManager)},$Tc.load=function($Tt){return $Ty.loader.create($Tt,null,null,$Tc)},$TB($Tc,["_staticBatchManager",function(){return this._staticBatchManager=new $TVM}]),$Tc}($TRM)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}}),function($Tt,$TM,$TDt){$TDt.un,$TDt.uns;var $Tf=$TDt.static,$Tc=$TDt.class,$To=$TDt.getset,$Tl=$TDt.__newvec,$TZ=laya.maths.Bezier,$TB=laya.utils.Browser,$TUt=laya.utils.Byte,$TD=(laya.events.Event,laya.events.EventDispatcher),$TJ=laya.display.Graphics,$TA=(laya.resource.HTMLCanvas,laya.utils.Handler),$TL=laya.net.Loader,$Tb=laya.maths.MathUtil,$TFt=laya.maths.Matrix,$T_=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$Tp=(laya.renders.RenderContext,laya.resource.Resource),$TI=laya.utils.RunDriver,$Tot=laya.display.Sprite,$Tq=laya.utils.Stat,$TSt=laya.resource.Texture,$TE=(laya.net.URL,laya.utils.Utils),$TF=function(){function $Tt(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $Tc($Tt,"laya.ani.AnimationContent"),$Tt}(),$TS=function(){function $Tt(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $Tc($Tt,"laya.ani.AnimationNodeContent"),$Tt}(),$TN=function(){function $Tt(){}return $Tc($Tt,"laya.ani.AnimationParser01"),$Tt.parse=function($Tt,$TM){var $Tf=$TM.__getBuffer(),$Tc=0,$TD=0,$To=0,$TJ=0,$TZ=0,$TA=0,$TL=0,$Tp=$TM.readUTFString();$Tt._aniClassName=$Tp;var $TB,$Tb=$TM.readUTFString().split("\n"),$TI=$TM.getUint8(),$Tq=$TM.getUint32(),$Tl=$TM.getUint32();0<$Tq&&($TB=$Tf.slice($Tq,$Tl));var $T_=new $TUt($TB);for(0<$Tl&&($Tt._publicExtData=$Tf.slice($Tl,$Tf.byteLength)),$Tt._useParent=!!$TM.getUint8(),$Tt._anis.length=$TI,$Tc=0;$Tc<$TI;$Tc++){var $TE=$Tt._anis[$Tc]=new $TF;$TE.nodes=new Array;var $Te=$TE.name=$Tb[$TM.getUint16()];$Tt._aniMap[$Te]=$Tc,$TE.bone3DMap={},$TE.playTime=$TM.getFloat32(),$TE.playTime<=0&&console.error("播放时间不能为0  url="+$Tt.url+" name="+$TE.name);var $TN=$TE.nodes.length=$TM.getUint8();for($TD=$TE.totalKeyframeDatasLength=0;$TD<$TN;$TD++){var $TX=$TE.nodes[$TD]=new $TS;$TX.childs=[];var $Ty=$TM.getInt16();0<=$Ty&&($TX.name=$Tb[$Ty],$TE.bone3DMap[$TX.name]=$TD),$TX.keyFrame=new Array,$TX.parentIndex=$TM.getInt16(),-1==$TX.parentIndex?$TX.parent=null:$TX.parent=$TE.nodes[$TX.parentIndex],$TX.lerpType=$TM.getUint8();var $Th=$TM.getUint32();$T_.pos=$Th;var $TT=$TX.keyframeWidth=$T_.getUint16();if($TE.totalKeyframeDatasLength+=$TT,0===$TX.lerpType||1===$TX.lerpType)for($TX.interpolationMethod=[],$TX.interpolationMethod.length=$TT,$To=0;$To<$TT;$To++)$TX.interpolationMethod[$To]=$Tr.interpolation[$T_.getUint8()];null!=$TX.parent&&$TX.parent.childs.push($TX);var $Ti=$TM.getUint16();0<$Ti&&($TX.extenData=$Tf.slice($TM.pos,$TM.pos+$Ti),$TM.pos+=$Ti);var $TV,$Tx=$TM.getUint16(),$TO=0;for($To=0,$TJ=$TX.keyFrame.length=$Tx;$To<$TJ;$To++){if(($TV=$TX.keyFrame[$To]=new $TH).duration=$TM.getFloat32(),$TV.startTime=$TO,2===$TX.lerpType){$TV.interpolationData=[];var $TC,$TU=$TM.getUint8();switch($TC=$TM.getFloat32()){case 254:for($TV.interpolationData.length=$TT,$TL=0;$TL<$TT;$TL++)$TV.interpolationData[$TL]=0;break;case 255:for($TV.interpolationData.length=$TT,$TL=0;$TL<$TT;$TL++)$TV.interpolationData[$TL]=5;break;default:for($TV.interpolationData.push($TC),$TA=1;$TA<$TU;$TA++)$TV.interpolationData.push($TM.getFloat32())}}for($TV.data=new Float32Array($TT),$TZ=0;$TZ<$TT;$TZ++)$TV.data[$TZ]=$TM.getFloat32(),-1e-8<$TV.data[$TZ]&&$TV.data[$TZ]<1e-8&&($TV.data[$TZ]=0);$TO+=$TV.duration}$TV.startTime=$TE.playTime,$TX.playTime=$TE.playTime,$Tt._calculateKeyFrame($TX,$Tx,$TT)}}},$Tt}(),$TX=function(){function $Ty(){}return $Tc($Ty,"laya.ani.AnimationParser02"),$Ty.READ_DATA=function(){$Ty._DATA.offset=$Ty._reader.getUint32(),$Ty._DATA.size=$Ty._reader.getUint32()},$Ty.READ_BLOCK=function(){for(var $Tt=$Ty._BLOCK.count=$Ty._reader.getUint16(),$TM=$Ty._BLOCK.blockStarts=[],$Tf=$Ty._BLOCK.blockLengths=[],$Tc=0;$Tc<$Tt;$Tc++)$TM.push($Ty._reader.getUint32()),$Tf.push($Ty._reader.getUint32())},$Ty.READ_STRINGS=function(){var $Tt=$Ty._reader.getUint32(),$TM=$Ty._reader.getUint16(),$Tf=$Ty._reader.pos;$Ty._reader.pos=$Tt+$Ty._DATA.offset;for(var $Tc=0;$Tc<$TM;$Tc++)$Ty._strings[$Tc]=$Ty._reader.readUTFString();$Ty._reader.pos=$Tf},$Ty.parse=function($Tt,$TM){$Ty._templet=$Tt;($Ty._reader=$TM).__getBuffer();$Ty.READ_DATA(),$Ty.READ_BLOCK(),$Ty.READ_STRINGS();for(var $Tf=0,$Tc=$Ty._BLOCK.count;$Tf<$Tc;$Tf++){var $TD=$TM.getUint16(),$To=$Ty._strings[$TD],$TJ=$Ty["READ_"+$To];if(null==$TJ)throw new Error("model file err,no this function:"+$TD+" "+$To);$TJ.call()}},$Ty.READ_ANIMATIONS=function(){var $Tt=$Ty._reader,$TM=$Tt.__getBuffer(),$Tf=0,$Tc=0,$TD=0,$To=0,$TJ=$Tt.getUint16(),$TZ=[];for($TZ.length=$TJ,$Tf=0;$Tf<$TJ;$Tf++)$TZ[$Tf]=$Tr.interpolation[$Tt.getByte()];var $TA=$Tt.getUint8();for($Ty._templet._anis.length=$TA,$Tf=0;$Tf<$TA;$Tf++){var $TL=$Ty._templet._anis[$Tf]={};$TL.nodes=new Array;var $Tp=$TL.name=$Ty._strings[$Tt.getUint16()];$Ty._templet._aniMap[$Tp]=$Tf,$TL.bone3DMap={},$TL.playTime=$Tt.getFloat32();var $TB=$TL.nodes.length=$Tt.getInt16();for($Tc=$TL.totalKeyframeDatasLength=0;$Tc<$TB;$Tc++){var $Tb=$TL.nodes[$Tc]={};$Tb.keyframeWidth=$TJ,$Tb.childs=[];var $TI=$Tt.getUint16();0<=$TI&&($Tb.name=$Ty._strings[$TI],$TL.bone3DMap[$Tb.name]=$Tc),$Tb.keyFrame=new Array,$Tb.parentIndex=$Tt.getInt16(),-1==$Tb.parentIndex?$Tb.parent=null:$Tb.parent=$TL.nodes[$Tb.parentIndex],$TL.totalKeyframeDatasLength+=$TJ,$Tb.interpolationMethod=$TZ,null!=$Tb.parent&&$Tb.parent.childs.push($Tb);var $Tq=$Tt.getUint16(),$Tl=null,$T_=null;for($TD=0,$To=$Tb.keyFrame.length=$Tq;$TD<$To;$TD++){($Tl=$Tb.keyFrame[$TD]={}).startTime=$Tt.getFloat32(),$T_&&($T_.duration=$Tl.startTime-$T_.startTime);var $TE=$Ty._DATA.offset,$Te=$Tt.getUint32(),$TN=4*$TJ,$TX=$TM.slice($TE+$Te,$TE+$Te+$TN);$Tl.data=new Float32Array($TX),$T_=$Tl}$Tl.duration=0,$Tb.playTime=$TL.playTime,$Ty._templet._calculateKeyFrame($Tb,$Tq,$TJ)}}},$Ty._templet=null,$Ty._reader=null,$Ty._strings=[],$Tf($Ty,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Ty}(),$THt=(function(){function $Tt(){}$Tc($Tt,"laya.ani.AnimationState"),$Tt.stopped=0,$Tt.paused=1,$Tt.playing=2}(),function(){function $TD(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $TRt,this.resultMatrix=new $TFt,this._children=[]}$Tc($TD,"laya.ani.bone.Bone");var $Tt=$TD.prototype;return $Tt.setTempMatrix=function($Tt){this._tempMatrix=$Tt;var $TM,$Tf=0;for($Tf=0,$TM=this._children.length;$Tf<$TM;$Tf++)this._children[$Tf].setTempMatrix(this._tempMatrix)},$Tt.update=function($Tt){var $TM;if(this.rotation=this.transform.skX,$Tt)$TM=this.resultTransform.getMatrix(),$TFt.mul($TM,$Tt,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$TM=this.resultTransform.getMatrix(),$TFt.mul($TM,this.parentBone.resultMatrix,this.resultMatrix);else{var $Tf=this.parentBone,$Tc=NaN,$TD=NaN,$To=NaN,$TJ=this.parentBone.resultMatrix;$TM=this.resultTransform.getMatrix();var $TZ=$TJ.a*$TM.tx+$TJ.c*$TM.ty+$TJ.tx,$TA=$TJ.b*$TM.tx+$TJ.d*$TM.ty+$TJ.ty,$TL=new $TFt;this.inheritRotation?($Tc=Math.atan2($Tf.resultMatrix.b,$Tf.resultMatrix.a),$TD=Math.cos($Tc),$To=Math.sin($Tc),$TL.setTo($TD,$To,-$To,$TD,0,0),$TFt.mul(this._tempMatrix,$TL,$TFt.TEMP),$TFt.TEMP.copyTo($TL),$TM=this.resultTransform.getMatrix(),$TFt.mul($TM,$TL,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$TM=this.resultTransform.getMatrix(),$TFt.TEMP.identity(),$TFt.TEMP.d=this.d,$TFt.mul($TM,$TFt.TEMP,this.resultMatrix)),this.resultMatrix.tx=$TZ,this.resultMatrix.ty=$TA}else($TM=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $Tp,$TB=0;for($TB=0,$Tp=this._children.length;$TB<$Tp;$TB++)this._children[$TB].update()},$Tt.updateChild=function(){var $Tt,$TM=0;for($TM=0,$Tt=this._children.length;$TM<$Tt;$TM++)this._children[$TM].update()},$Tt.setRotation=function($Tt){this._sprite&&(this._sprite.rotation=180*$Tt/Math.PI)},$Tt.updateDraw=function($Tt,$TM){$TD.ShowBones&&!$TD.ShowBones[this.name]||(this._sprite||(this._sprite=new $Tot,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$TDt.stage.addChild(this._sprite)),this._sprite.x=$Tt+this.resultMatrix.tx,this._sprite.y=$TM+this.resultMatrix.ty);var $Tf,$Tc=0;for($Tc=0,$Tf=this._children.length;$Tc<$Tf;$Tc++)this._children[$Tc].updateDraw($Tt,$TM)},$Tt.addChild=function($Tt){this._children.push($Tt),$Tt.parentBone=this},$Tt.findBone=function($Tt){if(this.name==$Tt)return this;var $TM,$Tf,$Tc=0;for($Tc=0,$TM=this._children.length;$Tc<$TM;$Tc++)if($Tf=this._children[$Tc].findBone($Tt))return $Tf;return null},$Tt.localToWorld=function($Tt){var $TM=$Tt[0],$Tf=$Tt[1];$Tt[0]=$TM*this.resultMatrix.a+$Tf*this.resultMatrix.c+this.resultMatrix.tx,$Tt[1]=$TM*this.resultMatrix.b+$Tf*this.resultMatrix.d+this.resultMatrix.ty},$TD.ShowBones={},$TD}()),$Tst=function(){function $Tl(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$Tc($Tl,"laya.ani.bone.BoneSlot");var $Tt=$Tl.prototype;return $Tt.showSlotData=function($Tt,$TM){void 0===$TM&&($TM=!0),this.currSlotData=$Tt,$TM&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$Tt.showDisplayByName=function($Tt){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($Tt))},$Tt.replaceDisplayByName=function($Tt,$TM){if(this.currSlotData){var $Tf;$Tf=this.currSlotData.getDisplayByName($Tt);var $Tc;$Tc=this.currSlotData.getDisplayByName($TM),this.replaceDisplayByIndex($Tf,$Tc)}},$Tt.replaceDisplayByIndex=function($Tt,$TM){this.currSlotData&&(this._replaceDic[$Tt]=$TM,this.displayIndex==$Tt&&this.showDisplayByIndex($Tt))},$Tt.showDisplayByIndex=function($Tt){if(null!=this._replaceDic[$Tt]&&($Tt=this._replaceDic[$Tt]),this.currSlotData&&-1<$Tt&&$Tt<this.currSlotData.displayArr.length){if(this.displayIndex=$Tt,this.currDisplayData=this.currSlotData.displayArr[$Tt],this.currDisplayData){var $TM=this.currDisplayData.name;this.currTexture=this.templet.getTexture($TM),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$T_.isConchApp||$T_.isConchApp&&"0.9.15"<$Tot.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$Tt.replaceSkin=function($Tt){this._diyTexture=$Tt,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$Tt.setParentMatrix=function($Tt){this._parentMatrix=$Tt},$Tt.draw=function($Tt,$TM,$Tf,$Tc){if(void 0===$Tf&&($Tf=!1),void 0===$Tc&&($Tc=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $TD,$To=this.currTexture;switch(this._diyTexture&&($To=this._diyTexture),this.currDisplayData.type){case 0:if($Tt){var $TJ=this.getDisplayMatrix();if(this._parentMatrix){var $TZ=!1;if($TJ){var $TA;if($TFt.mul($TJ,this._parentMatrix,$TFt.TEMP),$TA=$Tf?(null==this._resultMatrix&&(this._resultMatrix=new $TFt),this._resultMatrix):new $TFt,!$T_.isWebGL&&this.currDisplayData.uvs||$T_.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $TL=$Tl._tempMatrix;$TL.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($TL.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($TZ=!0,$TL.rotate(-Math.PI/2)),$TFt.mul($TL,$TFt.TEMP,$TA)}else $TFt.TEMP.copyTo($TA);$TZ?$Tt.drawTexture($To,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$TA):$Tt.drawTexture($To,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$TA)}}}break;case 1:if(null==($TD=$Tf?(null==this._skinSprite&&(this._skinSprite=$Tl.createSkinMesh()),this._skinSprite):$Tl.createSkinMesh()))return;var $Tp;if(null==this.currDisplayData.bones){var $TB,$Tb=this.currDisplayData.weights;this.deformData&&($Tb=this.deformData),$TB=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$TT.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$TT.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$Tb;this.currDisplayData.triangles.length;$Tp=this.currDisplayData.triangles,$TD.init2($To,null,$Tp,this._mVerticleArr,$TB);var $TI,$Tq=this.getDisplayMatrix();if(this._parentMatrix)if($Tq)$TFt.mul($Tq,this._parentMatrix,$TFt.TEMP),$TI=$Tf?(null==this._resultMatrix&&(this._resultMatrix=new $TFt),this._resultMatrix):new $TFt,$TFt.TEMP.copyTo($TI),$TD.transform=$TI}else this.skinMesh($TM,$TD,$Tc);$Tt.drawSkin($TD);break;case 2:if(null==($TD=$Tf?(null==this._skinSprite&&(this._skinSprite=$Tl.createSkinMesh()),this._skinSprite):$Tl.createSkinMesh()))return;this.skinMesh($TM,$TD,$Tc),$Tt.drawSkin($TD)}}},$Tt.skinMesh=function($Tt,$TM,$Tf){var $Tc,$TD=this.currTexture,$To=this.currDisplayData.bones;$Tc=this._diyTexture?($TD=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$TT.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$TT.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $TJ,$TZ,$TA=this.currDisplayData.weights,$TL=this.currDisplayData.triangles,$Tp=0,$TB=0,$Tb=0,$TI=NaN,$Tq=NaN,$Tl=0,$T_=0,$TE=[],$Te=0,$TN=0;if(this.deformData&&0<this.deformData.length){var $TX=0;for($Te=0,$TN=$To.length;$Te<$TN;){for($Tb=$To[$Te++]+$Te,$TB=$Tp=0;$Te<$Tb;$Te++)$TZ=$Tt[$To[$Te]],$TI=$TA[$Tl]+this.deformData[$TX++],$Tq=$TA[$Tl+1]+this.deformData[$TX++],$T_=$TA[$Tl+2],$Tp+=($TI*$TZ.a+$Tq*$TZ.c+$TZ.tx)*$T_,$TB+=($TI*$TZ.b+$Tq*$TZ.d+$TZ.ty)*$T_,$Tl+=3;$TE.push($Tp,$TB)}}else for($Te=0,$TN=$To.length;$Te<$TN;){for($Tb=$To[$Te++]+$Te,$TB=$Tp=0;$Te<$Tb;$Te++)$TZ=$Tt[$To[$Te]],$TI=$TA[$Tl],$Tq=$TA[$Tl+1],$T_=$TA[$Tl+2],$Tp+=($TI*$TZ.a+$Tq*$TZ.c+$TZ.tx)*$T_,$TB+=($TI*$TZ.b+$Tq*$TZ.d+$TZ.ty)*$T_,$Tl+=3;$TE.push($Tp,$TB)}this._mVerticleArr=$TE,$TJ=$TL,$TM.init2($TD,null,$TJ,this._mVerticleArr,$Tc)},$Tt.drawBonePoint=function($Tt){$Tt&&this._parentMatrix&&$Tt.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$Tt.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$Tt.getMatrix=function(){return this._resultMatrix},$Tt.copy=function(){var $Tt=new $Tl;return $Tt.type="copy",$Tt.name=this.name,$Tt.attachmentName=this.attachmentName,$Tt.srcDisplayIndex=this.srcDisplayIndex,$Tt.parent=this.parent,$Tt.displayIndex=this.displayIndex,$Tt.templet=this.templet,$Tt.currSlotData=this.currSlotData,$Tt.currTexture=this.currTexture,$Tt.currDisplayData=this.currDisplayData,$Tt},$Tl.createSkinMesh=function(){return $T_.isWebGL||$T_.isConchApp?$TI.skinAniSprite():($T_.isWebGL,null)},$Tf($Tl,["_tempMatrix",function(){return this._tempMatrix=new $TFt}]),$Tl}(),$Trt=function(){function $Tt(){this.skinName=null,this.deformSlotDataList=[]}return $Tc($Tt,"laya.ani.bone.DeformAniData"),$Tt}(),$Tut=function(){function $Tt(){this.deformSlotDisplayList=[]}return $Tc($Tt,"laya.ani.bone.DeformSlotData"),$Tt}(),$Tvt=function(){function $Tt(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$Tc($Tt,"laya.ani.bone.DeformSlotDisplayData");var $TM=$Tt.prototype;return $TM.binarySearch1=function($Tt,$TM){var $Tf=0,$Tc=$Tt.length-2;if(0==$Tc)return 1;for(var $TD=$Tc>>>1;;){if($Tt[Math.floor($TD+1)]<=$TM?$Tf=$TD+1:$Tc=$TD,$Tf==$Tc)return $Tf+1;$TD=$Tf+$Tc>>>1}return 0},$TM.apply=function($Tt,$TM,$Tf){if(void 0===$Tf&&($Tf=1),$Tt+=.05,!(this.timeList.length<=0)){var $Tc=0;if(!($Tt<this.timeList[0])){var $TD=this.vectices[0].length,$To=[],$TJ=this.binarySearch1(this.timeList,$Tt);if(this.frameIndex=$TJ,$Tt>=this.timeList[this.timeList.length-1]){var $TZ=this.vectices[this.vectices.length-1];if($Tf<1)for($Tc=0;$Tc<$TD;$Tc++)$To[$Tc]+=($TZ[$Tc]-$To[$Tc])*$Tf;else for($Tc=0;$Tc<$TD;$Tc++)$To[$Tc]=$TZ[$Tc];this.deformData=$To}else{this.tweenKeyList[this.frameIndex];var $TA=this.vectices[this.frameIndex-1],$TL=this.vectices[this.frameIndex],$Tp=this.timeList[this.frameIndex-1],$TB=this.timeList[this.frameIndex];$Tf=this.tweenKeyList[$TJ-1]?($Tt-$Tp)/($TB-$Tp):0;var $Tb=NaN;for($Tc=0;$Tc<$TD;$Tc++)$Tb=$TA[$Tc],$To[$Tc]=$Tb+($TL[$Tc]-$Tb)*$Tf;this.deformData=$To}}}},$Tt}(),$Tkt=function(){function $Tt(){this.time=NaN,this.drawOrder=[]}return $Tc($Tt,"laya.ani.bone.DrawOrderData"),$Tt}(),$TKt=function(){function $Tt(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $Tc($Tt,"laya.ani.bone.EventData"),$Tt}(),$Te=function(){function $Tct($Tt,$TM){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$Tt,this._targetBone=$TM[$Tt.targetBoneIndex],this.isSpine=$Tt.isSpine,null==this._bones&&(this._bones=[]);for(var $Tf=this._bones.length=0,$Tc=$Tt.boneIndexs.length;$Tf<$Tc;$Tf++)this._bones.push($TM[$Tt.boneIndexs[$Tf]]);this.name=$Tt.name,this.mix=$Tt.mix,this.bendDirection=$Tt.bendDirection}$Tc($Tct,"laya.ani.bone.IkConstraint");var $Tt=$Tct.prototype;return $Tt.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$Tt._applyIk1=function($Tt,$TM,$Tf,$Tc){var $TD=$Tt.parentBone,$To=1/($TD.resultMatrix.a*$TD.resultMatrix.d-$TD.resultMatrix.b*$TD.resultMatrix.c),$TJ=$TM-$TD.resultMatrix.tx,$TZ=$Tf-$TD.resultMatrix.ty,$TA=($TJ*$TD.resultMatrix.d-$TZ*$TD.resultMatrix.c)*$To-$Tt.transform.x,$TL=($TZ*$TD.resultMatrix.a-$TJ*$TD.resultMatrix.b)*$To-$Tt.transform.y,$Tp=Math.atan2($TL,$TA)*$Tct.radDeg-0-$Tt.transform.skX;$Tt.transform.scX<0&&($Tp+=180),180<$Tp?$Tp-=360:$Tp<-180&&($Tp+=360),$Tt.transform.skX=$Tt.transform.skY=$Tt.transform.skX+$Tp*$Tc,$Tt.update()},$Tt.updatePos=function($Tt,$TM){this._sp&&this._sp.pos($Tt,$TM)},$Tt._applyIk2=function($Tt,$TM,$Tf,$Tc,$TD,$To){if(0!=$To){var $TJ=$Tt.resultTransform.x,$TZ=$Tt.resultTransform.y,$TA=$Tt.transform.scX,$TL=$Tt.transform.scY,$Tp=$TM.transform.scX,$TB=0,$Tb=0,$TI=0;$TI=$TA<0?($TA=-$TA,$TB=180,-1):($TB=0,1),$TL<0&&($TL=-$TL,$TI=-$TI),$Tb=$Tp<0?($Tp=-$Tp,180):0;var $Tq=$TM.resultTransform.x,$Tl=NaN,$T_=NaN,$TE=NaN,$Te=$Tt.resultMatrix.a,$TN=$Tt.resultMatrix.c,$TX=$Tt.resultMatrix.b,$Ty=$Tt.resultMatrix.d,$Th=Math.abs($TA-$TL)<=1e-4;$TE=$Th?($T_=$Te*$Tq+$TN*($Tl=$TM.resultTransform.y)+$Tt.resultMatrix.tx,$TX*$Tq+$Ty*$Tl+$Tt.resultMatrix.ty):($Tl=0,$T_=$Te*$Tq+$Tt.resultMatrix.tx,$TX*$Tq+$Tt.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $Tot,$TDt.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($Tf,$Tc,15,"#ffff00"),this._sp.graphics.drawCircle($T_,$TE,15,"#ff00ff")),$Tt.setRotation(Math.atan2($TE-$Tt.resultMatrix.ty,$T_-$Tt.resultMatrix.tx));var $TT=$Tt.parentBone;$Te=$TT.resultMatrix.a,$TN=$TT.resultMatrix.c,$TX=$TT.resultMatrix.b;var $Ti=1/($Te*($Ty=$TT.resultMatrix.d)-$TN*$TX),$TV=$Tf-$TT.resultMatrix.tx,$Tx=$Tc-$TT.resultMatrix.ty,$TO=($TV*$Ty-$Tx*$TN)*$Ti-$TJ,$TC=($Tx*$Te-$TV*$TX)*$Ti-$TZ,$TU=(($TV=$T_-$TT.resultMatrix.tx)*$Ty-($Tx=$TE-$TT.resultMatrix.ty)*$TN)*$Ti-$TJ,$TF=($Tx*$Te-$TV*$TX)*$Ti-$TZ,$TS=Math.sqrt($TU*$TU+$TF*$TF),$TH=$TM.length*$Tp,$Ts=NaN,$Tr=NaN;if($Th){var $Tu=($TO*$TO+$TC*$TC-$TS*$TS-($TH*=$TA)*$TH)/(2*$TS*$TH);$Tu<-1?$Tu=-1:1<$Tu&&($Tu=1),$Tr=Math.acos($Tu)*$TD,$Te=$TS+$TH*$Tu,$TN=$TH*Math.sin($Tr),$Ts=Math.atan2($TC*$Te-$TO*$TN,$TO*$Te+$TC*$TN)}else{var $Tv=($Te=$TA*$TH)*$Te,$Tk=($TN=$TL*$TH)*$TN,$TK=$TO*$TO+$TC*$TC,$Tj=Math.atan2($TC,$TO),$Td=-2*$Tk*$TS,$T$=$Tk-$Tv;if(0<($Ty=$Td*$Td-4*$T$*($TX=$Tk*$TS*$TS+$Tv*$TK-$Tv*$Tk))){var $TP=Math.sqrt($Ty);$Td<0&&($TP=-$TP);var $TY=($TP=-($Td+$TP)/2)/$T$,$Tn=$TX/$TP,$TR=Math.abs($TY)<Math.abs($Tn)?$TY:$Tn;$TR*$TR<=$TK&&($Tx=Math.sqrt($TK-$TR*$TR)*$TD,$Ts=$Tj-Math.atan2($Tx,$TR),$Tr=Math.atan2($Tx/$TL,($TR-$TS)/$TA))}var $Tg=0,$Tz=Number.MAX_VALUE,$Tm=0,$TG=0,$Ta=0,$TQ=0,$Tw=0,$TW=0;$TQ<($Ty=($TV=$TS+$Te)*$TV)&&($Ta=0,$TQ=$Ty,$Tw=$TV),($Ty=($TV=$TS-$Te)*$TV)<$Tz&&($Tg=Math.PI,$Tz=$Ty,$Tm=$TV);var $Ttt=Math.acos(-$Te*$TS/($Tv-$Tk));($Ty=($TV=$Te*Math.cos($Ttt)+$TS)*$TV+($Tx=$TN*Math.sin($Ttt))*$Tx)<$Tz&&($Tg=$Ttt,$Tz=$Ty,$Tm=$TV,$TG=$Tx),$TQ<$Ty&&($Ta=$Ttt,$TQ=$Ty,$Tw=$TV,$TW=$Tx),$Tr=$TK<=($Tz+$TQ)/2?($Ts=$Tj-Math.atan2($TG*$TD,$Tm),$Tg*$TD):($Ts=$Tj-Math.atan2($TW*$TD,$Tw),$Ta*$TD)}var $TMt=Math.atan2($Tl,$Tq)*$TI,$Tft=$Tt.resultTransform.skX;180<($Ts=($Ts-$TMt)*$Tct.radDeg+$TB-$Tft)?$Ts-=360:$Ts<-180&&($Ts+=360),$Tt.resultTransform.x=$TJ,$Tt.resultTransform.y=$TZ,$Tt.resultTransform.skX=$Tt.resultTransform.skY=$Tft+$Ts*$To,$Tft=$TM.resultTransform.skX,180<($Tr=(($Tr+$TMt)*$Tct.radDeg-0)*$TI+$Tb-($Tft%=360))?$Tr-=360:$Tr<-180&&($Tr+=360),$TM.resultTransform.x=$Tq,$TM.resultTransform.y=$Tl,$TM.resultTransform.skX=$TM.resultTransform.skY=$TM.resultTransform.skY+$Tr*$To,$Tt.update()}},$Tt._applyIk3=function($Tt,$TM,$Tf,$Tc,$TD,$To){if(0!=$To){var $TJ,$TZ,$TA=$TM.resultMatrix.a*$TM.length,$TL=$TM.resultMatrix.b*$TM.length,$Tp=$TA*$TA+$TL*$TL,$TB=Math.sqrt($Tp),$Tb=$Tt.resultMatrix.tx,$TI=$Tt.resultMatrix.ty,$Tq=$TM.resultMatrix.tx,$Tl=$TM.resultMatrix.ty,$T_=$Tq-$Tb,$TE=$Tl-$TI,$Te=$T_*$T_+$TE*$TE,$TN=Math.sqrt($Te),$TX=($T_=$Tf-$Tt.resultMatrix.tx)*$T_+($TE=$Tc-$Tt.resultMatrix.ty)*$TE,$Ty=Math.sqrt($TX);if($TB+$TN<=$Ty||$Ty+$TB<=$TN||$Ty+$TN<=$TB){var $Th=NaN;$Tq=$Tb+($Th=$TB+$TN<=$Ty?1:-1)*($Tf-$Tb)*$TN/$Ty,$Tl=$TI+$Th*($Tc-$TI)*$TN/$Ty}else{var $TT=($Te-$Tp+$TX)/(2*$TX),$Ti=Math.sqrt($Te-$TT*$TT*$TX)/$Ty,$TV=$Tb+$T_*$TT,$Tx=$TI+$TE*$TT,$TO=-$TE*$Ti,$TC=$T_*$Ti;$Tl=0<$TD?($Tq=$TV-$TO,$Tx-$TC):($Tq=$TV+$TO,$Tx+$TC)}$TJ=$Tq,$TZ=$Tl,this.isDebug&&(this._sp||(this._sp=new $Tot,$TDt.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($Tb,$TI,15,"#ff00ff"),this._sp.graphics.drawCircle($Tf,$Tc,15,"#ffff00"),this._sp.graphics.drawCircle($TJ,$TZ,15,"#ff00ff"));var $TU,$TF;$TU=Math.atan2($TZ-$Tt.resultMatrix.ty,$TJ-$Tt.resultMatrix.tx),$Tt.setRotation($TU),($TF=$Tct._tempMatrix).identity(),$TF.rotate($TU),$TF.scale($Tt.resultMatrix.getScaleX(),$Tt.resultMatrix.getScaleY()),$TF.translate($Tt.resultMatrix.tx,$Tt.resultMatrix.ty),$TF.copyTo($Tt.resultMatrix),$Tt.updateChild();var $TS,$TH;$TS=Math.atan2($Tc-$TZ,$Tf-$TJ),$TM.setRotation($TS),($TH=$Tct._tempMatrix).identity(),$TH.rotate($TS),$TH.scale($TM.resultMatrix.getScaleX(),$TM.resultMatrix.getScaleY()),$TH.translate($TJ,$TZ),$TF.copyTo($TM.resultMatrix),$TM.updateChild()}},$Tf($Tct,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $TFt}]),$Tct}(),$Tjt=function(){function $Tt(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $Tc($Tt,"laya.ani.bone.IkConstraintData"),$Tt}(),$Ty=function(){function $TH($Tt,$TM){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$Tt,this.position=$Tt.position,this.spacing=$Tt.spacing,this.rotateMix=$Tt.rotateMix,this.translateMix=$Tt.translateMix,this.bones=[];for(var $Tf=this.data.bones,$Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++)this.bones.push($TM[$Tf[$Tc]])}$Tc($TH,"laya.ani.bone.PathConstraint");var $Tt=$TH.prototype;return $Tt.apply=function($Tt,$TM){if(this.target){var $Tf=this.translateMix,$Tc=this.translateMix,$TD=0<$Tc,$To=this.data.spacingMode,$TJ="length"==$To,$TZ=this.data.rotateMode,$TA="tangent"==$TZ,$TL="chainScale"==$TZ,$Tp=[],$TB=this.bones.length,$Tb=$TA?$TB:$TB+1,$TI=[];(this._spaces=$TI)[0]=this.position;var $Tq=this.spacing;if($TL||$TJ)for(var $Tl=0,$T_=$Tb-1;$Tl<$T_;){var $TE=this.bones[$Tl],$Te=$TE.length,$TN=$Te*$TE.resultMatrix.a,$TX=$Te*$TE.resultMatrix.b;$Te=Math.sqrt($TN*$TN+$TX*$TX),$TL&&($Tp[$Tl]=$Te),$TI[++$Tl]=$TJ?Math.max(0,$Te+$Tq):$Tq}else for($Tl=1;$Tl<$Tb;$Tl++)$TI[$Tl]=$Tq;var $Ty=this.computeWorldPositions(this.target,$Tt,$TM,$Tb,$TA,"percent"==this.data.positionMode,"percent"==$To);if(this._debugKey){for($Tl=0;$Tl<$Ty.length;$Tl++)$TM.drawCircle($Ty[$Tl++],$Ty[$Tl++],5,"#00ff00");var $Th=[];for($Tl=0;$Tl<$Ty.length;$Tl++)$Th.push($Ty[$Tl++],$Ty[$Tl++]);$TM.drawLines(0,0,$Th,"#ff0000")}var $TT=$Ty[0],$Ti=$Ty[1],$TV=this.data.offsetRotation,$Tx="chain"==$TZ&&0==$TV,$TO=NaN;for($Tl=0,$TO=3;$Tl<$TB;$Tl++,$TO+=3){($TE=this.bones[$Tl]).resultMatrix.tx+=($TT-$TE.resultMatrix.tx)*$Tf,$TE.resultMatrix.ty+=($Ti-$TE.resultMatrix.ty)*$Tf;var $TC=($TN=$Ty[$TO])-$TT,$TU=($TX=$Ty[$TO+1])-$Ti;if($TL&&0!=($Te=$Tp[$Tl])){var $TF=(Math.sqrt($TC*$TC+$TU*$TU)/$Te-1)*$Tc+1;$TE.resultMatrix.a*=$TF,$TE.resultMatrix.c*=$TF}if($TT=$TN,$Ti=$TX,$TD){var $TS=$TE.resultMatrix.a,$TH=$TE.resultMatrix.c,$Ts=$TE.resultMatrix.b,$Tr=$TE.resultMatrix.d,$Tu=NaN,$Tv=NaN,$Tk=NaN;$Tu=$TA?$Ty[$TO-1]:0==$TI[$Tl+1]?$Ty[$TO+2]:Math.atan2($TU,$TC),$Tu-=Math.atan2($Ts,$TS)-$TV/180*Math.PI,$Tx&&($Tv=Math.cos($Tu),$Tk=Math.sin($Tu),$TT+=(($Te=$TE.length)*($Tv*$TS-$Tk*$Ts)-$TC)*$Tc,$Ti+=($Te*($Tk*$TS+$Tv*$Ts)-$TU)*$Tc),$Tu>Math.PI?$Tu-=2*Math.PI:$Tu<-Math.PI&&($Tu+=2*Math.PI),$Tu*=$Tc,$Tv=Math.cos($Tu),$Tk=Math.sin($Tu),$TE.resultMatrix.a=$Tv*$TS-$Tk*$Ts,$TE.resultMatrix.c=$Tv*$TH-$Tk*$Tr,$TE.resultMatrix.b=$Tk*$TS+$Tv*$Ts,$TE.resultMatrix.d=$Tk*$TH+$Tv*$Tr}}}},$Tt.computeWorldVertices2=function($Tt,$TM,$Tf,$Tc,$TD,$To){var $TJ,$TZ,$TA=$Tt.currDisplayData.bones,$TL=$Tt.currDisplayData.weights,$Tp=$Tt.currDisplayData.triangles,$TB=0,$Tb=0,$TI=0,$Tq=0,$Tl=0,$T_=0,$TE=0,$Te=0,$TN=0,$TX=0,$Ty=0;if(null!=$TA){for($TB=0;$TB<$Tf;$TB+=2)$Tb+=($Tq=$TA[$Tb])+1,$TI+=$Tq;var $Th=$TM;for($Tl=$To,$T_=3*$TI;$Tl<$Tc;$Tl+=2){for($Te=$TE=0,$Tq=$TA[$Tb++],$Tq+=$Tb;$Tb<$Tq;$Tb++,$T_+=3){$TJ=$Th[$TA[$Tb]].resultMatrix,$TN=$TL[$T_],$TX=$TL[$T_+1];var $TT=$TL[$T_+2];$TE+=($TN*$TJ.a+$TX*$TJ.c+$TJ.tx)*$TT,$Te+=($TN*$TJ.b+$TX*$TJ.d+$TJ.ty)*$TT}$TD[$Tl]=$TE,$TD[$Tl+1]=$Te}}else{var $Ti,$TV;if($Tp||($Tp=$TL),$Tt.deformData&&($Tp=$Tt.deformData),$Ti=$Tt.parent,$TM)for($Ty=$TM.length,$TB=0;$TB<$Ty;$TB++)if($TM[$TB].name==$Ti){$TZ=$TM[$TB];break}$TZ&&($TV=$TZ.resultMatrix),$TV||($TV=$TH._tempMt);var $Tx=$TV.tx,$TO=$TV.ty,$TC=$TV.a,$TU=$TV.b,$TF=$TV.c,$TS=$TV.d;for($TZ&&($TS*=$TZ.d),$Tb=$Tf,$Tl=$To;$Tl<$Tc;$Tb+=2,$Tl+=2)$TN=$Tp[$Tb],$TX=$Tp[$Tb+1],$TD[$Tl]=$TN*$TC+$TX*$TU+$Tx,$TD[$Tl+1]=-($TN*$TF+$TX*$TS+$TO)}},$Tt.computeWorldPositions=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ){$Tt.currDisplayData.bones,$Tt.currDisplayData.weights,$Tt.currDisplayData.triangles;var $TZ=[],$TA=0,$TL=$Tt.currDisplayData.verLen,$Tp=this.position,$TB=this._spaces,$Tb=[],$TI=[],$Tq=$TL/6,$Tl=-1,$T_=NaN,$TE=0,$Te=0,$TN=NaN,$TX=NaN,$Ty=NaN,$Th=NaN;if($Tq--,$TL-=4,this.computeWorldVertices2($Tt,$TM,2,$TL,$TZ,0),this._debugKey)for($TA=0;$TA<$TZ.length;)$Tf.drawCircle($TZ[$TA++],$TZ[$TA++],10,"#ff0000");$Tb=$TZ,this._curves.length=$Tq;var $TT=this._curves,$Ti=$Tb[$T_=0],$TV=$Tb[1],$Tx=0,$TO=0,$TC=0,$TU=0,$TF=0,$TS=0,$TH=NaN,$Ts=NaN,$Tr=NaN,$Tu=NaN,$Tv=NaN,$Tk=NaN,$TK=NaN,$Tj=NaN,$Td=0;for($TA=0,$Td=2;$TA<$Tq;$TA++,$Td+=6)$Tx=$Tb[$Td],$TO=$Tb[$Td+1],$TC=$Tb[$Td+2],$TU=$Tb[$Td+3],$Tv=2*($TH=.1875*($Ti-2*$Tx+$TC))+($Tr=.09375*(3*($Tx-$TC)-$Ti+($TF=$Tb[$Td+4]))),$Tk=2*($Ts=.1875*($TV-2*$TO+$TU))+($Tu=.09375*(3*($TO-$TU)-$TV+($TS=$Tb[$Td+5]))),$TK=.75*($Tx-$Ti)+$TH+.16666667*$Tr,$Tj=.75*($TO-$TV)+$Ts+.16666667*$Tu,$T_+=Math.sqrt($TK*$TK+$Tj*$Tj),$TK+=$Tv,$Tj+=$Tk,$Tv+=$Tr,$Tk+=$Tu,$T_+=Math.sqrt($TK*$TK+$Tj*$Tj),$TK+=$Tv,$Tj+=$Tk,$T_+=Math.sqrt($TK*$TK+$Tj*$Tj),$TK+=$Tv+$Tr,$Tj+=$Tk+$Tu,$T_+=Math.sqrt($TK*$TK+$Tj*$Tj),$TT[$TA]=$T_,$Ti=$TF,$TV=$TS;if($To&&($Tp*=$T_),$TJ)for($TA=0;$TA<$Tc;$TA++)$TB[$TA]*=$T_;var $T$=this._segments,$TP=0,$TY=0;for($TY=$Te=$TE=$TA=0;$TA<$Tc;$TA++,$TE+=3)if(($TN=$Tp+=$TX=$TB[$TA])<0)this.addBeforePosition($TN,$Tb,0,$TI,$TE);else if($T_<$TN)this.addAfterPosition($TN-$T_,$Tb,$TL-4,$TI,$TE);else{for(;;$Te++)if(!(($Th=$TT[$Te])<$TN)){0==$Te?$TN/=$Th:$TN=($TN-($Ty=$TT[$Te-1]))/($Th-$Ty);break}if($Te!=$Tl){var $Tn=6*($Tl=$Te);for($Ti=$Tb[$Tn],$TV=$Tb[$Tn+1],$Tx=$Tb[$Tn+2],$TO=$Tb[$Tn+3],$TC=$Tb[$Tn+4],$TU=$Tb[$Tn+5],$Tv=2*($TH=.03*($Ti-2*$Tx+$TC))+($Tr=.006*(3*($Tx-$TC)-$Ti+($TF=$Tb[$Tn+6]))),$Tk=2*($Ts=.03*($TV-2*$TO+$TU))+($Tu=.006*(3*($TO-$TU)-$TV+($TS=$Tb[$Tn+7]))),$TK=.3*($Tx-$Ti)+$TH+.16666667*$Tr,$Tj=.3*($TO-$TV)+$Ts+.16666667*$Tu,$TP=Math.sqrt($TK*$TK+$Tj*$Tj),$T$[0]=$TP,$Tn=1;$Tn<8;$Tn++)$TK+=$Tv,$Tj+=$Tk,$Tv+=$Tr,$Tk+=$Tu,$TP+=Math.sqrt($TK*$TK+$Tj*$Tj),$T$[$Tn]=$TP;$TK+=$Tv,$Tj+=$Tk,$TP+=Math.sqrt($TK*$TK+$Tj*$Tj),$T$[8]=$TP,$TK+=$Tv+$Tr,$Tj+=$Tk+$Tu,$TP+=Math.sqrt($TK*$TK+$Tj*$Tj),$T$[9]=$TP,$TY=0}for($TN*=$TP;;$TY++)if(!(($Th=$T$[$TY])<$TN)){0==$TY?$TN/=$Th:$TN=$TY+($TN-($Ty=$T$[$TY-1]))/($Th-$Ty);break}this.addCurvePosition(.1*$TN,$Ti,$TV,$Tx,$TO,$TC,$TU,$TF,$TS,$TI,$TE,$TD||0<$TA&&0==$TX)}return $TI},$Tt.addBeforePosition=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TM[$Tf],$TJ=$TM[$Tf+1],$TZ=$TM[$Tf+2]-$To,$TA=$TM[$Tf+3]-$TJ,$TL=Math.atan2($TA,$TZ);$Tc[$TD]=$To+$Tt*Math.cos($TL),$Tc[$TD+1]=$TJ+$Tt*Math.sin($TL),$Tc[$TD+2]=$TL},$Tt.addAfterPosition=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TM[$Tf+2],$TJ=$TM[$Tf+3],$TZ=$To-$TM[$Tf],$TA=$TJ-$TM[$Tf+1],$TL=Math.atan2($TA,$TZ);$Tc[$TD]=$To+$Tt*Math.cos($TL),$Tc[$TD+1]=$TJ+$Tt*Math.sin($TL),$Tc[$TD+2]=$TL},$Tt.addCurvePosition=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp,$TB){0==$Tt&&($Tt=1e-4);var $Tb=$Tt*$Tt,$TI=$Tb*$Tt,$Tq=1-$Tt,$Tl=$Tq*$Tq,$T_=$Tl*$Tq,$TE=$Tq*$Tt,$Te=3*$TE,$TN=$Tq*$Te,$TX=$Te*$Tt,$Ty=$TM*$T_+$Tc*$TN+$To*$TX+$TZ*$TI,$Th=$Tf*$T_+$TD*$TN+$TJ*$TX+$TA*$TI;$TL[$Tp]=$Ty,$TL[$Tp+1]=$Th,$TL[$Tp+2]=$TB?Math.atan2($Th-($Tf*$Tl+$TD*$TE*2+$TJ*$Tb),$Ty-($TM*$Tl+$Tc*$TE*2+$To*$Tb)):0},$TH.NONE=-1,$TH.BEFORE=-2,$TH.AFTER=-3,$Tf($TH,["_tempMt",function(){return this._tempMt=new $TFt}]),$TH}(),$Tdt=function(){function $Tt(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $Tc($Tt,"laya.ani.bone.PathConstraintData"),$Tt}(),$T$t=function(){function $Tt(){this.name=null,this.slotArr=[]}return $Tc($Tt,"laya.ani.bone.SkinData"),$Tt}(),$TPt=function(){function $Tt(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$Tc($Tt,"laya.ani.bone.SkinSlotDisplayData");var $TM=$Tt.prototype;return $TM.createTexture=function($Tt){return this.texture||(this.texture=new $TSt($Tt.bitmap,this.uvs),$Tt.bitmap.alphaTexture&&(this.texture.alphaTexture=new $TSt($Tt.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$Tt.height,this.texture.height=$Tt.width,this.texture.offsetX=-$Tt.offsetX,this.texture.offsetY=-$Tt.offsetY,this.texture.sourceWidth=$Tt.sourceHeight,this.texture.sourceHeight=$Tt.sourceWidth):(this.texture.width=$Tt.width,this.texture.height=$Tt.height,this.texture.offsetX=-$Tt.offsetX,this.texture.offsetY=-$Tt.offsetY,this.texture.sourceWidth=$Tt.sourceWidth,this.texture.sourceHeight=$Tt.sourceHeight),$T_.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$TM.destory=function(){this.texture&&this.texture.destroy()},$Tt}(),$TYt=function(){function $Tt(){this.name=null,this.displayArr=[]}return $Tc($Tt,"laya.ani.bone.SlotData"),$Tt.prototype.getDisplayByName=function($Tt){for(var $TM=0,$Tf=this.displayArr.length;$TM<$Tf;$TM++)if(this.displayArr[$TM].attachmentName==$Tt)return $TM;return-1},$Tt}(),$Th=function(){function $Tt($Tt,$TM){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$Tl(2,0),this._data=$Tt,null==this._bones&&(this._bones=[]),this.target=$TM[$Tt.targetIndex];var $Tf,$Tc=0;for($Tc=0,$Tf=$Tt.boneIndexs.length;$Tc<$Tf;$Tc++)this._bones.push($TM[$Tt.boneIndexs[$Tc]]);this.rotateMix=$Tt.rotateMix,this.translateMix=$Tt.translateMix,this.scaleMix=$Tt.scaleMix,this.shearMix=$Tt.shearMix}return $Tc($Tt,"laya.ani.bone.TfConstraint"),$Tt.prototype.apply=function(){for(var $Tt,$TM=this.target.resultMatrix.a,$Tf=this.target.resultMatrix.b,$Tc=this.target.resultMatrix.c,$TD=this.target.resultMatrix.d,$To=0,$TJ=this._bones.length;$To<$TJ;$To++){if($Tt=this._bones[$To],0<this.rotateMix){var $TZ=$Tt.resultMatrix.a,$TA=$Tt.resultMatrix.b,$TL=$Tt.resultMatrix.c,$Tp=$Tt.resultMatrix.d,$TB=Math.atan2($Tc,$TM)-Math.atan2($TL,$TZ)+this._data.offsetRotation*Math.PI/180;$TB>Math.PI?$TB-=2*Math.PI:$TB<-Math.PI&&($TB+=2*Math.PI),$TB*=this.rotateMix;var $Tb=Math.cos($TB),$TI=Math.sin($TB);$Tt.resultMatrix.a=$Tb*$TZ-$TI*$TL,$Tt.resultMatrix.b=$Tb*$TA-$TI*$Tp,$Tt.resultMatrix.c=$TI*$TZ+$Tb*$TL,$Tt.resultMatrix.d=$TI*$TA+$Tb*$Tp}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$Tt.resultMatrix.tx+=(this._temp[0]-$Tt.resultMatrix.tx)*this.translateMix,$Tt.resultMatrix.ty+=(this._temp[1]-$Tt.resultMatrix.ty)*this.translateMix,$Tt.updateChild()),0<this.scaleMix){var $Tq=Math.sqrt($Tt.resultMatrix.a*$Tt.resultMatrix.a+$Tt.resultMatrix.c*$Tt.resultMatrix.c),$Tl=Math.sqrt($TM*$TM+$Tc*$Tc),$T_=1e-5<$Tq?($Tq+($Tl-$Tq+this._data.offsetScaleX)*this.scaleMix)/$Tq:0;$Tt.resultMatrix.a*=$T_,$Tt.resultMatrix.c*=$T_,$Tq=Math.sqrt($Tt.resultMatrix.b*$Tt.resultMatrix.b+$Tt.resultMatrix.d*$Tt.resultMatrix.d),$Tl=Math.sqrt($Tf*$Tf+$TD*$TD),$T_=1e-5<$Tq?($Tq+($Tl-$Tq+this._data.offsetScaleY)*this.scaleMix)/$Tq:0,$Tt.resultMatrix.b*=$T_,$Tt.resultMatrix.d*=$T_}if(0<this.shearMix){$TA=$Tt.resultMatrix.b,$Tp=$Tt.resultMatrix.d;var $TE=Math.atan2($Tp,$TA);($TB=Math.atan2($TD,$Tf)-Math.atan2($Tc,$TM)-($TE-Math.atan2($Tt.resultMatrix.c,$Tt.resultMatrix.a)))>Math.PI?$TB-=2*Math.PI:$TB<-Math.PI&&($TB+=2*Math.PI),$TB=$TE+($TB+this._data.offsetShearY*Math.PI/180)*this.shearMix,$T_=Math.sqrt($TA*$TA+$Tp*$Tp),$Tt.resultMatrix.b=Math.cos($TB)*$T_,$Tt.resultMatrix.d=Math.sin($TB)*$T_}}},$Tt}(),$Tnt=function(){function $Tt(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $Tc($Tt,"laya.ani.bone.TfConstraintData"),$Tt}(),$TRt=function(){function $Tt(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$Tc($Tt,"laya.ani.bone.Transform");var $TM=$Tt.prototype;return $TM.initData=function($Tt){null!=$Tt.x&&(this.x=$Tt.x),null!=$Tt.y&&(this.y=$Tt.y),null!=$Tt.skX&&(this.skX=$Tt.skX),null!=$Tt.skY&&(this.skY=$Tt.skY),null!=$Tt.scX&&(this.scX=$Tt.scX),null!=$Tt.scY&&(this.scY=$Tt.scY)},$TM.getMatrix=function(){var $Tt;return($Tt=this.mMatrix?this.mMatrix:this.mMatrix=new $TFt).identity(),$Tt.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($Tt,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$Tt.rotate(this.skX*Math.PI/180),$Tt.translate(this.x,this.y),$Tt},$TM.skew=function($Tt,$TM,$Tf){var $Tc=Math.sin($Tf),$TD=Math.cos($Tf),$To=Math.sin($TM),$TJ=Math.cos($TM);return $Tt.setTo($Tt.a*$TJ-$Tt.b*$Tc,$Tt.a*$To+$Tt.b*$TD,$Tt.c*$TJ-$Tt.d*$Tc,$Tt.c*$To+$Tt.d*$TD,$Tt.tx*$TJ-$Tt.ty*$Tc,$Tt.tx*$To+$Tt.ty*$TD),$Tt},$Tt}(),$TT=function(){function $Tt(){}return $Tc($Tt,"laya.ani.bone.UVTools"),$Tt.getRelativeUV=function($Tt,$TM,$Tf){var $Tc=$Tt[0],$TD=$Tt[2]-$Tt[0],$To=$Tt[1],$TJ=$Tt[5]-$Tt[1];$Tf||($Tf=[]),$Tf.length=$TM.length;var $TZ,$TA=0;$TZ=$Tf.length;var $TL=1/$TD,$Tp=1/$TJ;for($TA=0;$TA<$TZ;$TA+=2)$Tf[$TA]=($TM[$TA]-$Tc)*$TL,$Tf[$TA+1]=($TM[$TA+1]-$To)*$Tp;return $Tf},$Tt.getAbsoluteUV=function($Tt,$TM,$Tf){if(0==$Tt[0]&&0==$Tt[1]&&1==$Tt[4]&&1==$Tt[5])return $Tf?($TE.copyArray($Tf,$TM),$Tf):$TM;var $Tc=$Tt[0],$TD=$Tt[2]-$Tt[0],$To=$Tt[1],$TJ=$Tt[5]-$Tt[1];$Tf||($Tf=[]),$Tf.length=$TM.length;var $TZ,$TA=0;for($TZ=$Tf.length,$TA=0;$TA<$TZ;$TA+=2)$Tf[$TA]=$TM[$TA]*$TD+$Tc,$Tf[$TA+1]=$TM[$TA+1]*$TJ+$To;return $Tf},$Tt}(),$TH=function(){function $Tt(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $Tc($Tt,"laya.ani.KeyFramesContent"),$Tt}(),$Ti=function(){function $Tp(){}return $Tc($Tp,"laya.ani.math.BezierLerp"),$Tp.getBezierRate=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$Tp._getBezierParamKey($TM,$Tf,$Tc,$TD),$TJ=100*$To+$Tt;if($Tp._bezierResultCache[$TJ])return $Tp._bezierResultCache[$TJ];var $TZ,$TA=$Tp._getBezierPoints($TM,$Tf,$Tc,$TD,$To),$TL=0;for($TZ=$TA.length,$TL=0;$TL<$TZ;$TL+=2)if($Tt<=$TA[$TL])return $Tp._bezierResultCache[$TJ]=$TA[$TL+1],$TA[$TL+1];return $Tp._bezierResultCache[$TJ]=1},$Tp._getBezierParamKey=function($Tt,$TM,$Tf,$Tc){return 100*(100*(100*(100*$Tt+$TM)+$Tf)+$Tc)},$Tp._getBezierPoints=function($Tt,$TM,$Tf,$Tc,$TD){return $Tp._bezierPointsCache[$TD]?$Tp._bezierPointsCache[$TD]:($To=[0,0,$Tt,$TM,$Tf,$Tc,1,1],$TJ=(new $TZ).getBezierPoints($To,100,3),$Tp._bezierPointsCache[$TD]=$TJ);var $To,$TJ},$Tp._bezierResultCache={},$Tp._bezierPointsCache={},$Tp}(),$TV=function($Tt){function $TM(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$TM.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$Tc($TM,"laya.ani.AnimationPlayer",$TD);var $Tf=$TM.prototype;return $TDt.imps($Tf,{"laya.resource.IDestroy":!0}),$Tf._onTempletLoadedComputeFullKeyframeIndices=function($Tt,$TM,$Tf){this._templet===$Tf&&this._cachePlayRate===$Tt&&this._cacheFrameRate===$TM&&this._computeFullKeyframeIndices()},$Tf._computeFullKeyframeIndices=function(){for(var $Tt=this._fullFrames=[],$TM=this._templet,$Tf=this._cacheFrameRateInterval*this._cachePlayRate,$Tc=0,$TD=$TM.getAnimationCount();$Tc<$TD;$Tc++){for(var $To=[],$TJ=0,$TZ=$TM.getAnimation($Tc).nodes.length;$TJ<$TZ;$TJ++){for(var $TA=$TM.getAnimation($Tc).nodes[$TJ],$TL=Math.floor($TA.playTime/$Tf+.01),$Tp=new Uint16Array($TL+1),$TB=-1,$Tb=0,$TI=$TA.keyFrame.length;$Tb<$TI;$Tb++){var $Tq=$TA.keyFrame[$Tb],$Tl=$Tq.startTime,$T_=$Tl+$Tq.duration+$Tf;do{for(var $TE=Math.floor($Tl/$Tf+.5),$Te=$TB+1;$Te<$TE;$Te++)$Tp[$Te]=$Tb;$Tp[$TB=$TE]=$Tb,$Tl+=$Tf}while($Tl<=$T_)}$To.push($Tp)}$Tt.push($To)}},$Tf._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$Tf._calculatePlayDuration=function(){if(0!==this.state){var $Tt=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$Tt),this._playEnd>$Tt&&(this._playEnd=$Tt),this._playDuration=this._playEnd-this._playStart}},$Tf._setPlayParams=function($Tt,$TM){this._currentTime=$Tt,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$TM+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$TM},$Tf._setPlayParamsWhenStop=function($Tt,$TM){this._currentTime=$Tt,this._currentKeyframeIndex=Math.max(Math.floor($Tt/$TM+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$TM,this._currentAnimationClipIndex=-1},$Tf._update=function($Tt){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $TM=this._cacheFrameRateInterval*this._cachePlayRate,$Tf=0;this._startUpdateLoopCount!==$Tq.loopCount&&($Tf=$Tt*this.playbackRate,this._elapsedPlaybackTime+=$Tf);var $Tc=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$Tc)return this._setPlayParamsWhenStop($Tc,$TM),void this.event("stopped");if($Tf+=this._currentTime,0<$Tc)if($Tc<=$Tf)do{if($Tf-=$Tc,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Tc,$TM),this._stopWhenCircleFinish=!1,void this.event("stopped");$Tf<$Tc&&(this._setPlayParams($Tf,$TM),this.event("complete"))}while($Tc<=$Tf);else this._setPlayParams($Tf,$TM);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Tc,$TM),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$Tf._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$Tf.play=function($Tt,$TM,$Tf,$Tc,$TD){if(void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=1),void 0===$Tf&&($Tf=2147483647),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($Tf<0||$Tc<0||$TD<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$TD&&$TD<$Tc)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$TM,this._overallDuration=$Tf,this._playStart=$Tc,this._playEnd=$TD,this._paused=!1,this._currentAnimationClipIndex=$Tt,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$Tq.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$Tf.playByFrame=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$Tt&&($Tt=0),void 0===$TM&&($TM=1),void 0===$Tf&&($Tf=2147483647),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$To&&($To=30);var $TJ=1e3/$To;this.play($Tt,$TM,$Tf,$Tc*$TJ,$TD*$TJ)},$Tf.stop=function($Tt){void 0===$Tt&&($Tt=!0),$Tt?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$To(0,$Tf,"playEnd",function(){return this._playEnd}),$To(0,$Tf,"templet",function(){return this._templet},function($Tt){0===!this.state&&this.stop(!0),this._templet!==$Tt&&((this._templet=$Tt).loaded?this._computeFullKeyframeIndices():$Tt.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$To(0,$Tf,"playStart",function(){return this._playStart}),$To(0,$Tf,"playDuration",function(){return this._playDuration}),$To(0,$Tf,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$To(0,$Tf,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$To(0,$Tf,"overallDuration",function(){return this._overallDuration}),$To(0,$Tf,"currentFrameTime",function(){return this._currentFrameTime}),$To(0,$Tf,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$To(0,$Tf,"currentPlayTime",function(){return this._currentTime+this._playStart}),$To(0,$Tf,"cachePlayRate",function(){return this._cachePlayRate},function($Tt){this._cachePlayRate!==$Tt&&(this._cachePlayRate=$Tt,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$Tt,this._cacheFrameRate])))}),$To(0,$Tf,"cacheFrameRate",function(){return this._cacheFrameRate},function($Tt){this._cacheFrameRate!==$Tt&&(this._cacheFrameRate=$Tt,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$Tt])))}),$To(0,$Tf,"currentTime",null,function($Tt){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($Tt<this._playStart||$Tt>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$Tq.loopCount;var $TM=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$Tt,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$TM),0),this._currentFrameTime=this._currentKeyframeIndex*$TM}}),$To(0,$Tf,"paused",function(){return this._paused},function($Tt){(this._paused=$Tt)&&this.event("paused")}),$To(0,$Tf,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$To(0,$Tf,"destroyed",function(){return this._destroyed}),$TM}(),$Ts=function($Tt){function $TM(){$TM.__super.call(this),$T_.isConchNode&&(this.drawSkin=function($Tt){$Tt.transform||($Tt.transform=$TFt.EMPTY),this._addCmd([$Tt]),this.setSkinMesh&&this.setSkinMesh($Tt._ps,$Tt.mVBData,$Tt.mEleNum,0,$Tt.mTexture,$Tt.transform)})}return $Tc($TM,"laya.ani.GraphicsAni",$TJ),$TM.prototype.drawSkin=function($Tt){var $TM=[$Tt];this._saveToCmd($T_._context._drawSkin,$TM)},$TM.create=function(){return $TM._caches.pop()||new $TM},$TM.recycle=function($Tt){$Tt.clear(),$TM._caches.push($Tt)},$TM._caches=[],$TM}(),$Tr=function($Tt){function $Te(){this._aniMap={},this.unfixedLastAniIndex=-1,$Te.__super.call(this),this._anis=new Array}$Tc($Te,"laya.ani.AnimationTemplet",$Tp);var $TM=$Te.prototype;return $TM.parse=function($Tt){var $TM=new $TUt($Tt);this._aniVersion=$TM.readUTFString(),$TN.parse(this,$TM)},$TM._calculateKeyFrame=function($Tt,$TM,$Tf){var $Tc=$Tt.keyFrame;$Tc[$TM]=$Tc[0];for(var $TD=0;$TD<$TM;$TD++){var $To=$Tc[$TD];$To.nextData=0===$To.duration?$To.data:$Tc[$TD+1].data}$Tc.length--},$TM.onAsynLoaded=function($Tt,$TM,$Tf){var $Tc=new $TUt($TM);switch(this._aniVersion=$Tc.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$TX.parse(this,$Tc);break;default:$TN.parse(this,$Tc)}this._endLoaded()},$TM.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$TM.getAnimationCount=function(){return this._anis.length},$TM.getAnimation=function($Tt){return this._anis[$Tt]},$TM.getAniDuration=function($Tt){return this._anis[$Tt].playTime},$TM.getNodes=function($Tt){return this._anis[$Tt].nodes},$TM.getNodeIndexWithName=function($Tt,$TM){return this._anis[$Tt].bone3DMap[$TM]},$TM.getNodeCount=function($Tt){return this._anis[$Tt].nodes.length},$TM.getTotalkeyframesLength=function($Tt){return this._anis[$Tt].totalKeyframeDatasLength},$TM.getPublicExtData=function(){return this._publicExtData},$TM.getAnimationDataWithCache=function($Tt,$TM,$Tf,$Tc){var $TD=$TM[$Tf];if($TD){var $To=$TD[$Tt];return $To?$To[$Tc]:null}return null},$TM.setAnimationDataWithCache=function($Tt,$TM,$Tf,$Tc,$TD){var $To=$TM[$Tf]||($TM[$Tf]={});($To[$Tt]||($To[$Tt]=[]))[$Tc]=$TD},$TM.getOriginalData=function($Tt,$TM,$Tf,$Tc,$TD){for(var $To=this._anis[$Tt].nodes,$TJ=0,$TZ=0,$TA=$To.length,$TL=0;$TZ<$TA;$TZ++){var $Tp,$TB=$To[$TZ];$Tp=$TB.keyFrame[$Tf[$TZ][$Tc]],$TB.dataOffset=$TL;var $Tb=$TD-$Tp.startTime,$TI=$TB.lerpType;if($TI)switch($TI){case 0:case 1:for($TJ=0;$TJ<$TB.keyframeWidth;)$TJ+=$TB.interpolationMethod[$TJ]($TB,$TJ,$TM,$TL+$TJ,$Tp.data,$Tb,null,$Tp.duration,$Tp.nextData);break;case 2:var $Tq=$Tp.interpolationData,$Tl=$Tq.length,$T_=0;for($TJ=0;$TJ<$Tl;){var $TE=$Tq[$TJ];switch($TE){case 6:case 7:$TJ+=$Te.interpolation[$TE]($TB,$T_,$TM,$TL+$T_,$Tp.data,$Tb,null,$Tp.duration,$Tp.nextData,$Tq,$TJ+1);break;default:$TJ+=$Te.interpolation[$TE]($TB,$T_,$TM,$TL+$T_,$Tp.data,$Tb,null,$Tp.duration,$Tp.nextData)}$T_++}}else for($TJ=0;$TJ<$TB.keyframeWidth;)$TJ+=$TB.interpolationMethod[$TJ]($TB,$TJ,$TM,$TL+$TJ,$Tp.data,$Tb,null,$Tp.duration,$Tp.nextData);$TL+=$TB.keyframeWidth}},$TM.getNodesCurrentFrameIndex=function($Tt,$TM){var $Tf=this._anis[$Tt].nodes;$Tt!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($Tf.length),this.unfixedCurrentTimes=new Float32Array($Tf.length),this.unfixedLastAniIndex=$Tt);for(var $Tc=0,$TD=$Tf.length;$Tc<$TD;$Tc++){var $To=$Tf[$Tc];for($TM<this.unfixedCurrentTimes[$Tc]&&(this.unfixedCurrentFrameIndexes[$Tc]=0),this.unfixedCurrentTimes[$Tc]=$TM;this.unfixedCurrentFrameIndexes[$Tc]<$To.keyFrame.length&&!($To.keyFrame[this.unfixedCurrentFrameIndexes[$Tc]].startTime>this.unfixedCurrentTimes[$Tc]);)this.unfixedCurrentFrameIndexes[$Tc]++;this.unfixedCurrentFrameIndexes[$Tc]--}return this.unfixedCurrentFrameIndexes},$TM.getOriginalDataUnfixedRate=function($Tt,$TM,$Tf){var $Tc=this._anis[$Tt].nodes;$Tt!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($Tc.length),this.unfixedCurrentTimes=new Float32Array($Tc.length),this.unfixedKeyframes=$Tl($Tc.length),this.unfixedLastAniIndex=$Tt);for(var $TD=0,$To=0,$TJ=$Tc.length,$TZ=0;$To<$TJ;$To++){var $TA=$Tc[$To];for($Tf<this.unfixedCurrentTimes[$To]&&(this.unfixedCurrentFrameIndexes[$To]=0),this.unfixedCurrentTimes[$To]=$Tf;this.unfixedCurrentFrameIndexes[$To]<$TA.keyFrame.length&&!($TA.keyFrame[this.unfixedCurrentFrameIndexes[$To]].startTime>this.unfixedCurrentTimes[$To]);)this.unfixedKeyframes[$To]=$TA.keyFrame[this.unfixedCurrentFrameIndexes[$To]],this.unfixedCurrentFrameIndexes[$To]++;var $TL=this.unfixedKeyframes[$To];$TA.dataOffset=$TZ;var $Tp=$Tf-$TL.startTime;if($TA.lerpType)switch($TA.lerpType){case 0:case 1:for($TD=0;$TD<$TA.keyframeWidth;)$TD+=$TA.interpolationMethod[$TD]($TA,$TD,$TM,$TZ+$TD,$TL.data,$Tp,null,$TL.duration,$TL.nextData);break;case 2:var $TB=$TL.interpolationData,$Tb=$TB.length,$TI=0;for($TD=0;$TD<$Tb;){var $Tq=$TB[$TD];switch($Tq){case 6:case 7:$TD+=$Te.interpolation[$Tq]($TA,$TI,$TM,$TZ+$TI,$TL.data,$Tp,null,$TL.duration,$TL.nextData,$TB,$TD+1);break;default:$TD+=$Te.interpolation[$Tq]($TA,$TI,$TM,$TZ+$TI,$TL.data,$Tp,null,$TL.duration,$TL.nextData)}$TI++}}else for($TD=0;$TD<$TA.keyframeWidth;)$TD+=$TA.interpolationMethod[$TD]($TA,$TD,$TM,$TZ+$TD,$TL.data,$Tp,null,$TL.duration,$TL.nextData);$TZ+=$TA.keyframeWidth}},$Te._LinearInterpolation_0=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){var $Tp=0===$TZ?0:$To/$TZ;return $Tf[$Tc]=(1-$Tp)*$TD[$TM]+$Tp*$TA[$TM],1},$Te._QuaternionInterpolation_1=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){var $Tp=0===$TZ?0:$To/$TZ;return $Tb.slerpQuaternionArray($TD,$TM,$TA,$TM,$Tp,$Tf,$Tc),4},$Te._AngleInterpolation_2=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return 0},$Te._RadiansInterpolation_3=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return 0},$Te._Matrix4x4Interpolation_4=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){for(var $Tp=0;$Tp<16;$Tp++,$TM++)$Tf[$Tc+$Tp]=$TD[$TM]+$To*$TJ[$TM];return 16},$Te._NoInterpolation_5=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL){return $Tf[$Tc]=$TD[$TM],1},$Te._BezierInterpolation_6=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp){return void 0===$Tp&&($Tp=0),$Tf[$Tc]=$TD[$TM]+($TA[$TM]-$TD[$TM])*$Ti.getBezierRate($To/$TZ,$TL[$Tp],$TL[$Tp+1],$TL[$Tp+2],$TL[$Tp+3]),5},$Te._BezierInterpolation_7=function($Tt,$TM,$Tf,$Tc,$TD,$To,$TJ,$TZ,$TA,$TL,$Tp){return void 0===$Tp&&($Tp=0),$Tf[$Tc]=$TL[$Tp+4]+$TL[$Tp+5]*$Ti.getBezierRate((.001*$To+$TL[$Tp+6])/$TL[$Tp+7],$TL[$Tp],$TL[$Tp+1],$TL[$Tp+2],$TL[$Tp+3]),9},$Te.load=function($Tt){return $TDt.loader.create($Tt,null,null,$Te)},$Te.interpolation=[$Te._LinearInterpolation_0,$Te._QuaternionInterpolation_1,$Te._AngleInterpolation_2,$Te._RadiansInterpolation_3,$Te._Matrix4x4Interpolation_4,$Te._NoInterpolation_5,$Te._BezierInterpolation_6,$Te._BezierInterpolation_7],$Te}(),$Tx=function($TM){function $Tf($Tt,$TM){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$Tf.__super.call(this),void 0===$TM&&($TM=0),$Tt&&this.init($Tt,$TM)}$Tc($Tf,"laya.ani.bone.Skeleton",$TM);var $Tt=$Tf.prototype;return $Tt.init=function($Tt,$TM){void 0===$TM&&($TM=0);var $Tf,$Tc,$TD,$To=0,$TJ=0;if(1==$TM)for(this._graphicsCache=[],$To=0,$TJ=$Tt.getAnimationCount();$To<$TJ;$To++)this._graphicsCache.push([]);if(this._yReverseMatrix=$Tt.yReverseMatrix,this._aniMode=$TM,this._templet=$Tt,this._player=new $TV,this._player.cacheFrameRate=$Tt.rate,this._player.templet=$Tt,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$Tt.mBoneArr,this._rootBone=$Tt.mRootBone,this._aniSectionDic=$Tt.aniSectionDic,0<$Tt.ikArr.length)for(this._ikArr=[],$To=0,$TJ=$Tt.ikArr.length;$To<$TJ;$To++)this._ikArr.push(new $Te($Tt.ikArr[$To],this._boneList));if(0<$Tt.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$To=0,$TJ=$Tt.pathArr.length;$To<$TJ;$To++)$Tf=$Tt.pathArr[$To],$Tc=new $Ty($Tf,this._boneList),($TD=this._boneSlotDic[$Tf.name])&&(($Tc=new $Ty($Tf,this._boneList)).target=$TD),this._pathDic[$Tf.name]=$Tc;if(0<$Tt.tfArr.length)for(this._tfArr=[],$To=0,$TJ=$Tt.tfArr.length;$To<$TJ;$To++)this._tfArr.push(new $Th($Tt.tfArr[$To],this._boneList));if(0<$Tt.skinDataArray.length){var $TZ=this._templet.skinDataArray[this._skinIndex];this._skinName=$TZ.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$Tt.load=function($Tt,$TM,$Tf){},$Tt._onLoaded=function(){},$Tt._parseComplete=function(){var $Tt=$TO.TEMPLET_DICTIONARY[this._aniPath];$Tt&&(this.init($Tt,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$Tt._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$Tt._onPlay=function(){this.event("played")},$Tt._onStop=function(){var $Tt,$TM=this._templet.eventAniArr[this._aniClipIndex];if($TM&&this._eventIndex<$TM.length)for(;this._eventIndex<$TM.length;this._eventIndex++)($Tt=$TM[this._eventIndex]).time>=this._player.playStart&&$Tt.time<=this._player.playEnd&&this.event("label",$Tt);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$Tt._onPause=function(){this.event("paused")},$Tt._parseSrcBoneMatrix=function(){var $Tt=0,$TM=0;for($TM=this._templet.srcBoneMatrixArr.length,$Tt=0;$Tt<$TM;$Tt++)this._boneMatrixArray.push(new $TFt);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $Tf,$Tc,$TD=this._templet.boneSlotArray;for($Tt=0,$TM=$TD.length;$Tt<$TM;$Tt++)$Tf=$TD[$Tt],null==($Tc=this._bindBoneBoneSlotDic[$Tf.parent])&&(this._bindBoneBoneSlotDic[$Tf.parent]=$Tc=[]),this._boneSlotDic[$Tf.name]=$Tf=$Tf.copy(),$Tc.push($Tf),this._boneSlotArray.push($Tf)}},$Tt._emitMissedEvents=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=0);var $Tc=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($Tc){var $TD,$To,$TJ=0;for($TD=$Tc.length,$TJ=$Tf;$TJ<$TD;$TJ++)($To=$Tc[$TJ]).time>=this._player.playStart&&$To.time<=this._player.playEnd&&this.event("label",$To)}},$Tt._update=function($Tt){if(void 0===$Tt&&($Tt=!0),!(this._pause||$Tt&&this._indexControl)){var $TM=this.timer.currTimer,$Tf=this._player.currentKeyframeIndex,$Tc=$TM-this._lastTime;if($Tt?this._player._update($Tc):$Tf=-1,this._lastTime=$TM,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$Tc&&this._clipIndex==$Tf&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $TD;this._lastUpdateAniClipIndex=this._aniClipIndex,$Tf>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $To,$TJ=this._templet.eventAniArr[this._aniClipIndex];if($TJ&&this._eventIndex<$TJ.length&&(($TD=$TJ[this._eventIndex]).time>=this._player.playStart&&$TD.time<=this._player.playEnd?this._player.currentPlayTime>=$TD.time&&(this.event("label",$TD),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($To=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$To&&(this.graphics=$To));var $TZ=0,$TA=0;for($TA=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$TA-1)&&0<$TA;)$TA--;if($TA<this._clipIndex)for($TZ=$TA;$TZ<this._clipIndex;$TZ++)this._createGraphics($TZ)}else if(1==this._aniMode){if($To=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$To&&(this.graphics=$To));for($TA=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$TA-1)&&0<$TA;)$TA--;if($TA<this._clipIndex)for($TZ=$TA;$TZ<this._clipIndex;$TZ++)this._createGraphics($TZ)}this._createGraphics()}}},$Tt._createGraphics=function($Tt){void 0===$Tt&&($Tt=-1),-1==$Tt&&($Tt=this._clipIndex);var $TM,$Tf,$Tc=$Tt*this._player.cacheFrameRateInterval,$TD=this._templet.drawOrderAniArr[this._aniClipIndex];if($TD&&0<$TD.length)for(this._drawOrderIndex=0,$TM=$TD[this._drawOrderIndex];$Tc>=$TM.time&&(this._drawOrder=$TM.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$TD.length));)$TM=$TD[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$Ts.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$Ts.create(),$Tf=this.graphics;var $To=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$Tt,$Tc);var $TJ,$TZ,$TA,$TL,$Tp=this._aniSectionDic[this._aniClipIndex],$TB=0,$Tb=0,$TI=0,$Tq=0,$Tl=0,$T_=this._templet.srcBoneMatrixArr.length;for($Tl=$Tp[$Tb=0];$Tb<$T_;$Tb++)$TL=this._boneList[$Tb],$TA=this._templet.srcBoneMatrixArr[$Tb],$TL.resultTransform.scX=$TA.scX*this._curOriginalData[$TB++],$TL.resultTransform.skX=$TA.skX+this._curOriginalData[$TB++],$TL.resultTransform.skY=$TA.skY+this._curOriginalData[$TB++],$TL.resultTransform.scY=$TA.scY*this._curOriginalData[$TB++],$TL.resultTransform.x=$TA.x+this._curOriginalData[$TB++],$TL.resultTransform.y=$TA.y+this._curOriginalData[$TB++],8===this._templet.tMatrixDataLen&&($TL.resultTransform.skewX=$TA.skewX+this._curOriginalData[$TB++],$TL.resultTransform.skewY=$TA.skewY+this._curOriginalData[$TB++]);var $TE,$Te={},$TN={};for($Tl+=$Tp[1];$Tb<$Tl;$Tb++)$Te[($TE=$To[$Tb]).name]=this._curOriginalData[$TB++],$TN[$TE.name]=this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++];var $TX,$Ty,$Th={},$TT={};for($Tl+=$Tp[2];$Tb<$Tl;$Tb++)$Th[($TE=$To[$Tb]).name]=this._curOriginalData[$TB++],$TT[$TE.name]=this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++],this._curOriginalData[$TB++];if(this._pathDic)for($Tl+=$Tp[3];$Tb<$Tl;$Tb++){if($TE=$To[$Tb],$TX=this._pathDic[$TE.name])switch(new $TUt($TE.extenData).getByte()){case 1:$TX.position=this._curOriginalData[$TB++];break;case 2:$TX.spacing=this._curOriginalData[$TB++];break;case 3:$TX.rotateMix=this._curOriginalData[$TB++],$TX.translateMix=this._curOriginalData[$TB++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($TFt.TEMP.identity()),this._ikArr)for($Tb=0,$Tl=this._ikArr.length;$Tb<$Tl;$Tb++)$Ty=this._ikArr[$Tb],$Th.hasOwnProperty($Ty.name)&&($Ty.bendDirection=$Th[$Ty.name]),$TT.hasOwnProperty($Ty.name)&&($Ty.mix=$TT[$Ty.name]),$Ty.apply();if(this._pathDic)for(var $Ti in this._pathDic)($TX=this._pathDic[$Ti]).apply(this._boneList,$Tf);if(this._tfArr)for($Tb=0,$Tq=this._tfArr.length;$Tb<$Tq;$Tb++)this._tfArr[$Tb].apply();for($Tb=0,$Tq=this._boneList.length;$Tb<$Tq;$Tb++)if($TL=this._boneList[$Tb],$TZ=this._bindBoneBoneSlotDic[$TL.name],$TL.resultMatrix.copyTo(this._boneMatrixArray[$Tb]),$TZ)for($TI=0,$Tl=$TZ.length;$TI<$Tl;$TI++)($TJ=$TZ[$TI])&&$TJ.setParentMatrix($TL.resultMatrix);var $TV,$Tx,$TO,$TC,$TU={},$TF=this._templet.deformAniArr;if($TF&&0<$TF.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$Tb=0,$Tl=this._boneSlotArray.length;$Tb<$Tl;$Tb++)($TJ=this._boneSlotArray[$Tb]).deformData=null;var $TS,$TH=$TF[this._aniClipIndex];for($TS in $TV=$TH.default,this._setDeform($TV,$TU,this._boneSlotArray,$Tc),$TH)"default"!=$TS&&$TS!=this._skinName&&($TV=$TH[$TS],this._setDeform($TV,$TU,this._boneSlotArray,$Tc));$TV=$TH[this._skinName],this._setDeform($TV,$TU,this._boneSlotArray,$Tc)}if(this._drawOrder)for($Tb=0,$Tl=this._drawOrder.length;$Tb<$Tl;$Tb++)$Tx=$Te[($TJ=this._boneSlotArray[this._drawOrder[$Tb]]).name],$TO=$TN[$TJ.name],isNaN($TO)||($Tf.save(),$Tf.alpha($TO)),isNaN($Tx)||-2==$Tx||(this._templet.attachmentNames?$TJ.showDisplayByName(this._templet.attachmentNames[$Tx]):$TJ.showDisplayByIndex($Tx)),$TU[this._drawOrder[$Tb]]?($TC=$TU[this._drawOrder[$Tb]],$TJ.currDisplayData&&$TC[$TJ.currDisplayData.attachmentName]?$TJ.deformData=$TC[$TJ.currDisplayData.attachmentName]:$TJ.deformData=null):$TJ.deformData=null,isNaN($TO)?$TJ.draw($Tf,this._boneMatrixArray,2==this._aniMode):$TJ.draw($Tf,this._boneMatrixArray,2==this._aniMode,$TO),isNaN($TO)||$Tf.restore();else for($Tb=0,$Tl=this._boneSlotArray.length;$Tb<$Tl;$Tb++)$Tx=$Te[($TJ=this._boneSlotArray[$Tb]).name],$TO=$TN[$TJ.name],isNaN($TO)||($Tf.save(),$Tf.alpha($TO)),isNaN($Tx)||-2==$Tx||(this._templet.attachmentNames?$TJ.showDisplayByName(this._templet.attachmentNames[$Tx]):$TJ.showDisplayByIndex($Tx)),$TU[$Tb]?($TC=$TU[$Tb],$TJ.currDisplayData&&$TC[$TJ.currDisplayData.attachmentName]?$TJ.deformData=$TC[$TJ.currDisplayData.attachmentName]:$TJ.deformData=null):$TJ.deformData=null,isNaN($TO)?$TJ.draw($Tf,this._boneMatrixArray,2==this._aniMode):$TJ.draw($Tf,this._boneMatrixArray,2==this._aniMode,$TO),isNaN($TO)||$Tf.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$Tt,$Tf):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$Tt,$Tf)},$Tt._setDeform=function($Tt,$TM,$Tf,$Tc){if($Tt){var $TD,$To,$TJ,$TZ=0,$TA=0,$TL=0;if($Tt)for($TZ=0,$TA=$Tt.deformSlotDataList.length;$TZ<$TA;$TZ++)for($TD=$Tt.deformSlotDataList[$TZ],$TL=0;$TL<$TD.deformSlotDisplayList.length;$TL++)$TJ=$Tf[($To=$TD.deformSlotDisplayList[$TL]).slotIndex],$To.apply($Tc,$TJ),$TM[$To.slotIndex]||($TM[$To.slotIndex]={}),$TM[$To.slotIndex][$To.attachment]=$To.deformData}},$Tt.getAnimNum=function(){return this._templet.getAnimationCount()},$Tt.getAniNameByIndex=function($Tt){return this._templet.getAniNameByIndex($Tt)},$Tt.getSlotByName=function($Tt){return this._boneSlotDic[$Tt]},$Tt.showSkinByName=function($Tt,$TM){void 0===$TM&&($TM=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($Tt),$TM)},$Tt.showSkinByIndex=function($Tt,$TM){void 0===$TM&&($TM=!0);for(var $Tf=0;$Tf<this._boneSlotArray.length;$Tf++)this._boneSlotArray[$Tf].showSlotData(null,$TM);if(this._templet.showSkinByIndex(this._boneSlotDic,$Tt,$TM)){var $Tc=this._templet.skinDataArray[$Tt];this._skinIndex=$Tt,this._skinName=$Tc.name}this._clearCache()},$Tt.showSlotSkinByIndex=function($Tt,$TM){if(0!=this._aniMode){var $Tf=this.getSlotByName($Tt);$Tf&&$Tf.showDisplayByIndex($TM),this._clearCache()}},$Tt.showSlotSkinByName=function($Tt,$TM){if(0!=this._aniMode){var $Tf=this.getSlotByName($Tt);$Tf&&$Tf.showDisplayByName($TM),this._clearCache()}},$Tt.replaceSlotSkinName=function($Tt,$TM,$Tf){if(0!=this._aniMode){var $Tc=this.getSlotByName($Tt);$Tc&&$Tc.replaceDisplayByName($TM,$Tf),this._clearCache()}},$Tt.replaceSlotSkinByIndex=function($Tt,$TM,$Tf){if(0!=this._aniMode){var $Tc=this.getSlotByName($Tt);$Tc&&$Tc.replaceDisplayByIndex($TM,$Tf),this._clearCache()}},$Tt.setSlotSkin=function($Tt,$TM){if(0!=this._aniMode){var $Tf=this.getSlotByName($Tt);$Tf&&$Tf.replaceSkin($TM),this._clearCache()}},$Tt._clearCache=function(){if(1==this._aniMode)for(var $Tt=0,$TM=this._graphicsCache.length;$Tt<$TM;$Tt++){for(var $Tf=0,$Tc=this._graphicsCache[$Tt].length;$Tf<$Tc;$Tf++){var $TD=this._graphicsCache[$Tt][$Tf];$TD!=this.graphics&&$Ts.recycle($TD)}this._graphicsCache[$Tt].length=0}},$Tt.play=function($Tt,$TM,$Tf,$Tc,$TD,$To){void 0===$Tf&&($Tf=!0),void 0===$Tc&&($Tc=0),void 0===$TD&&($TD=0),void 0===$To&&($To=!0),this._indexControl=!1;var $TJ=-1,$TZ=NaN;if($TZ=$TM?2147483647:0,"string"==typeof $Tt)for(var $TA=0,$TL=this._templet.getAnimationCount();$TA<$TL;$TA++){var $Tp=this._templet.getAnimation($TA);if($Tp&&$Tt==$Tp.name){$TJ=$TA;break}}else $TJ=$Tt;-1<$TJ&&$TJ<this.getAnimNum()&&(this._aniClipIndex=$TJ,($Tf||this._pause||this._currAniIndex!=$TJ)&&(this._currAniIndex=$TJ,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($TJ)),this._drawOrder=null,this._eventIndex=0,this._player.play($TJ,this._player.playbackRate,$TZ,$Tc,$TD),$To&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$TB.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$Tt.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$Tt.playbackRate=function($Tt){this._player&&(this._player.playbackRate=$Tt)},$Tt.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$Tt.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$TB.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$Tt._getGrahicsDataWithCache=function($Tt,$TM){return this._graphicsCache[$Tt][$TM]},$Tt._setGrahicsDataWithCache=function($Tt,$TM,$Tf){this._graphicsCache[$Tt][$TM]=$Tf},$Tt.destroy=function($Tt){void 0===$Tt&&($Tt=!0),$TM.prototype.destroy.call(this,$Tt),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$To(0,$Tt,"url",function(){return this._aniPath},function($Tt){this.load($Tt)}),$To(0,$Tt,"index",function(){return this._index},function($Tt){this.player&&(this._index=$Tt,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$To(0,$Tt,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$To(0,$Tt,"templet",function(){return this._templet}),$To(0,$Tt,"player",function(){return this._player}),$Tf.useSimpleMeshInCanvas=!1,$Tf}($Tot),$TO=function($TM){function $TD(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$TD.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$Tc($TD,"laya.ani.bone.Templet",$TM);var $Tt=$TD.prototype;return $Tt.getLoadList=function(){return this._loadList},$Tt.loadAni=function($Tt){this._skBufferUrl=$Tt,$TDt.loader.load($Tt,$TA.create(this,this.onComplete),null,"arraybuffer")},$Tt.onComplete=function($Tt){if(this._isDestroyed)this.destroy();else{var $TM=$TL.getRes(this._skBufferUrl);$TM?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$TM)):this.event("error","load failed:"+this._skBufferUrl)}},$Tt.parseData=function($Tt,$TM,$Tf){void 0===$Tf&&($Tf=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$Tt,this._mainTexture&&$T_.isWebGL&&$Tt.bitmap&&($Tt.bitmap.enableMerageInAtlas=!1),this._rate=$Tf,this.parse($TM)},$Tt.buildArmature=function($Tt){return void 0===$Tt&&($Tt=0),new $Tx(this,$Tt)},$Tt.parse=function($Tt){$TM.prototype.parse.call(this,$Tt),this._endLoaded(),this._aniVersion!=$TD.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$TD.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$Tt._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $Tt=0;this._loadList=[];var $TM,$Tf=new $TUt(this.getPublicExtData()),$Tc=0,$TD=0,$To=0,$TJ=$Tf.getInt32(),$TZ=$Tf.readUTFString(),$TA=$TZ.split("\n");for($Tt=0;$Tt<$TJ;$Tt++)$TM=this._path+$TA[2*$Tt],$TZ=$TA[2*$Tt+1],$Tf.getFloat32(),$Tf.getFloat32(),$Tc=$Tf.getFloat32(),$TD=$Tf.getFloat32(),$To=$Tf.getFloat32(),isNaN($To)?0:$To,$To=$Tf.getFloat32(),isNaN($To)?0:$To,$To=$Tf.getFloat32(),isNaN($To)?$Tc:$To,$To=$Tf.getFloat32(),isNaN($To)?$TD:$To,-1==this._loadList.indexOf($TM)&&this._loadList.push($TM);this.event("inited",this)}},$Tt._textureComplete=function(){for(var $Tt,$TM,$Tf=0,$Tc=this._loadList.length;$Tf<$Tc;$Tf++)$TM=this._loadList[$Tf],$Tt=this._textureDic[$TM]=$TL.getRes($TM),$T_.isWebGL&&$Tt&&$Tt.bitmap&&($Tt.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$Tt._parsePublicExtData=function(){var $Tt=0,$TM=0,$Tf=0,$Tc=0,$TD=0;for($Tt=0,$TD=this.getAnimationCount();$Tt<$TD;$Tt++)this._graphicsCache.push([]);var $To;$To="Dragon"!=this._aniClassName;var $TJ,$TZ,$TA=new $TUt(this.getPublicExtData()),$TL=0,$Tp=0,$TB=0,$Tb=0,$TI=0,$Tq=0,$Tl=0,$T_=0,$TE=0,$Te=$TA.getInt32(),$TN=$TA.readUTFString(),$TX=$TN.split("\n");for($Tt=0;$Tt<$Te;$Tt++){if($TJ=this._mainTexture,$TZ=this._path+$TX[2*$Tt],$TN=$TX[2*$Tt+1],null==this._mainTexture&&($TJ=this._textureDic[$TZ]),!$TJ)return this.event("error",this),void(this.isParseFail=!0);$TL=$TA.getFloat32(),$Tp=$TA.getFloat32(),$TB=$TA.getFloat32(),$Tb=$TA.getFloat32(),$TE=$TA.getFloat32(),$TI=isNaN($TE)?0:$TE,$TE=$TA.getFloat32(),$Tq=isNaN($TE)?0:$TE,$TE=$TA.getFloat32(),$Tl=isNaN($TE)?$TB:$TE,$TE=$TA.getFloat32(),$T_=isNaN($TE)?$Tb:$TE,this.subTextureDic[$TN]=$TSt.create($TJ,$TL,$Tp,$TB,$Tb,-$TI,-$Tq,$Tl,$T_),$TJ.alphaTexture&&(this.subTextureDic[$TN].alphaTexture=$TSt.create($TJ.alphaTexture,$TL,$Tp,$TB,$Tb,-$TI,-$Tq,$Tl,$T_))}this._mainTexture=$TJ;var $Ty,$Th,$TT,$Ti,$TV,$Tx=$TA.getUint16();for($Tt=0;$Tt<$Tx;$Tt++)($Ty=[]).push($TA.getUint16()),$Ty.push($TA.getUint16()),$Ty.push($TA.getUint16()),$Ty.push($TA.getUint16()),this.aniSectionDic[$Tt]=$Ty;var $TO,$TC=$TA.getInt16(),$TU={};for($Tt=0;$Tt<$TC;$Tt++)$Th=new $THt,0==$Tt?$TO=$Th:$Th.root=$TO,$Th.d=$To?-1:1,$Ti=$TA.readUTFString(),$TV=$TA.readUTFString(),$Th.length=$TA.getFloat32(),1==$TA.getByte()&&($Th.inheritRotation=!1),1==$TA.getByte()&&($Th.inheritScale=!1),$Th.name=$Ti,$TV&&(($TT=$TU[$TV])?$TT.addChild($Th):this.mRootBone=$Th),$TU[$Ti]=$Th,this.mBoneArr.push($Th);this.tMatrixDataLen=$TA.getUint16();var $TF,$TS,$TH=$TA.getUint16(),$Ts=Math.floor($TH/this.tMatrixDataLen),$Tr=this.srcBoneMatrixArr;for($Tt=0;$Tt<$Ts;$Tt++)($TF=new $TRt).scX=$TA.getFloat32(),$TF.skX=$TA.getFloat32(),$TF.skY=$TA.getFloat32(),$TF.scY=$TA.getFloat32(),$TF.x=$TA.getFloat32(),$TF.y=$TA.getFloat32(),8===this.tMatrixDataLen&&($TF.skewX=$TA.getFloat32(),$TF.skewY=$TA.getFloat32()),$Tr.push($TF),($Th=this.mBoneArr[$Tt]).transform=$TF;var $Tu,$Tv=$TA.getUint16(),$Tk=0;for($Tt=0;$Tt<$Tv;$Tt++){for($TS=new $Tjt,$Tk=$TA.getUint16(),$TM=0;$TM<$Tk;$TM++)$TS.boneNames.push($TA.readUTFString()),$TS.boneIndexs.push($TA.getInt16());$TS.name=$TA.readUTFString(),$TS.targetBoneName=$TA.readUTFString(),$TS.targetBoneIndex=$TA.getInt16(),$TS.bendDirection=$TA.getFloat32(),$TS.mix=$TA.getFloat32(),$TS.isSpine=$To,this.ikArr.push($TS)}var $TK,$Tj=$TA.getUint16(),$Td=0;for($Tt=0;$Tt<$Tj;$Tt++){for($Tu=new $Tnt,$Td=$TA.getUint16(),$TM=0;$TM<$Td;$TM++)$Tu.boneIndexs.push($TA.getInt16());$Tu.name=$TA.getUTFString(),$Tu.targetIndex=$TA.getInt16(),$Tu.rotateMix=$TA.getFloat32(),$Tu.translateMix=$TA.getFloat32(),$Tu.scaleMix=$TA.getFloat32(),$Tu.shearMix=$TA.getFloat32(),$Tu.offsetRotation=$TA.getFloat32(),$Tu.offsetX=$TA.getFloat32(),$Tu.offsetY=$TA.getFloat32(),$Tu.offsetScaleX=$TA.getFloat32(),$Tu.offsetScaleY=$TA.getFloat32(),$Tu.offsetShearY=$TA.getFloat32(),this.tfArr.push($Tu)}var $T$=$TA.getUint16(),$TP=0;for($Tt=0;$Tt<$T$;$Tt++){for(($TK=new $Tdt).name=$TA.readUTFString(),$TP=$TA.getUint16(),$TM=0;$TM<$TP;$TM++)$TK.bones.push($TA.getInt16());$TK.target=$TA.readUTFString(),$TK.positionMode=$TA.readUTFString(),$TK.spacingMode=$TA.readUTFString(),$TK.rotateMode=$TA.readUTFString(),$TK.offsetRotation=$TA.getFloat32(),$TK.position=$TA.getFloat32(),$TK.spacing=$TA.getFloat32(),$TK.rotateMix=$TA.getFloat32(),$TK.translateMix=$TA.getFloat32(),this.pathArr.push($TK)}var $TY,$Tn,$TR,$Tg,$Tz,$Tm=0,$TG=0,$Ta=0,$TQ=NaN,$Tw=0,$TW=$TA.getInt16();for($Tt=0;$Tt<$TW;$Tt++){var $Ttt=$TA.getUint8(),$TMt={};this.deformAniArr.push($TMt);for(var $Tft=0;$Tft<$Ttt;$Tft++)for(($TY=new $Trt).skinName=$TA.getUTFString(),$TMt[$TY.skinName]=$TY,$Tm=$TA.getInt16(),$TM=0;$TM<$Tm;$TM++)for($Tn=new $Tut,$TY.deformSlotDataList.push($Tn),$TG=$TA.getInt16(),$Tf=0;$Tf<$TG;$Tf++)for($TR=new $Tvt,$Tn.deformSlotDisplayList.push($TR),$TR.slotIndex=$TA.getInt16(),$TR.attachment=$TA.getUTFString(),$Ta=$TA.getInt16(),$Tc=0;$Tc<$Ta;$Tc++)for(1==$TA.getByte()?$TR.tweenKeyList.push(!0):$TR.tweenKeyList.push(!1),$TQ=$TA.getFloat32(),$TR.timeList.push($TQ),$Tg=[],$TR.vectices.push($Tg),$Tw=$TA.getInt16(),$TD=0;$TD<$Tw;$TD++)$Tg.push($TA.getFloat32())}var $Tct,$TDt,$Tot=$TA.getInt16(),$TJt=0,$TZt=0;for($Tt=0;$Tt<$Tot;$Tt++){for($TJt=$TA.getInt16(),$Tz=[],$TM=0;$TM<$TJt;$TM++){for(($Tct=new $Tkt).time=$TA.getFloat32(),$TZt=$TA.getInt16(),$Tf=0;$Tf<$TZt;$Tf++)$Tct.drawOrder.push($TA.getInt16());$Tz.push($Tct)}this.drawOrderAniArr.push($Tz)}var $TAt,$TLt=$TA.getInt16(),$Tpt=0;for($Tt=0;$Tt<$TLt;$Tt++){for($Tpt=$TA.getInt16(),$TDt=[],$TM=0;$TM<$Tpt;$TM++)($TAt=new $TKt).name=$TA.getUTFString(),$TAt.intValue=$TA.getInt32(),$TAt.floatValue=$TA.getFloat32(),$TAt.stringValue=$TA.getUTFString(),$TAt.time=$TA.getFloat32(),$TDt.push($TAt);this.eventAniArr.push($TDt)}var $TBt=$TA.getInt16();if(0<$TBt)for(this.attachmentNames=[],$Tt=0;$Tt<$TBt;$Tt++)this.attachmentNames.push($TA.getUTFString());var $Tbt,$TIt,$Tqt=$TA.getInt16();for($Tt=0;$Tt<$Tqt;$Tt++)($Tbt=new $Tst).name=$TA.readUTFString(),$Tbt.parent=$TA.readUTFString(),$Tbt.attachmentName=$TA.readUTFString(),$Tbt.srcDisplayIndex=$Tbt.displayIndex=$TA.getInt16(),($Tbt.templet=this).boneSlotDic[$Tbt.name]=$Tbt,null==($TIt=this.bindBoneBoneSlotDic[$Tbt.parent])&&(this.bindBoneBoneSlotDic[$Tbt.parent]=$TIt=[]),$TIt.push($Tbt),this.boneSlotArray.push($Tbt);var $Tlt,$T_t,$TEt,$Tet=$TA.readUTFString().split("\n"),$TNt=0,$TXt=$TA.getUint8(),$Tyt=0,$Tht=0,$TTt=0,$Tit=0,$TVt=0,$Txt=0,$TOt=0;for($Tt=0;$Tt<$TXt;$Tt++){for(($Tlt=new $T$t).name=$Tet[$TNt++],$Tyt=$TA.getUint8(),$TM=0;$TM<$Tyt;$TM++){for(($T_t=new $TYt).name=$Tet[$TNt++],$Tbt=this.boneSlotDic[$T_t.name],$Tht=$TA.getUint8(),$Tf=0;$Tf<$Tht;$Tf++){if($TEt=new $TPt,this.skinSlotDisplayDataArr.push($TEt),$TEt.name=$Tet[$TNt++],$TEt.attachmentName=$Tet[$TNt++],$TEt.transform=new $TRt,$TEt.transform.scX=$TA.getFloat32(),$TEt.transform.skX=$TA.getFloat32(),$TEt.transform.skY=$TA.getFloat32(),$TEt.transform.scY=$TA.getFloat32(),$TEt.transform.x=$TA.getFloat32(),$TEt.transform.y=$TA.getFloat32(),$T_t.displayArr.push($TEt),$TEt.width=$TA.getFloat32(),$TEt.height=$TA.getFloat32(),$TEt.type=$TA.getUint8(),$TEt.verLen=$TA.getUint16(),0<($TC=$TA.getUint16()))for($TEt.bones=[],$Tc=0;$Tc<$TC;$Tc++){var $TCt=$TA.getUint16();$TEt.bones.push($TCt)}if(0<($TTt=$TA.getUint16()))for($TEt.uvs=[],$Tc=0;$Tc<$TTt;$Tc++)$TEt.uvs.push($TA.getFloat32());if(0<($Tit=$TA.getUint16()))for($TEt.weights=[],$Tc=0;$Tc<$Tit;$Tc++)$TEt.weights.push($TA.getFloat32());if(0<($TVt=$TA.getUint16()))for($TEt.triangles=[],$Tc=0;$Tc<$TVt;$Tc++)$TEt.triangles.push($TA.getUint16());if(0<($Txt=$TA.getUint16()))for($TEt.vertices=[],$Tc=0;$Tc<$Txt;$Tc++)$TEt.vertices.push($TA.getFloat32());if(0<($TOt=$TA.getUint16()))for($TEt.lengths=[],$Tc=0;$Tc<$TOt;$Tc++)$TEt.lengths.push($TA.getFloat32())}$Tlt.slotArr.push($T_t)}this.skinDic[$Tlt.name]=$Tlt,this.skinDataArray.push($Tlt)}1==$TA.getUint8()?(this.yReverseMatrix=new $TFt(1,0,0,-1,0,0),$TO&&$TO.setTempMatrix(this.yReverseMatrix)):$TO&&$TO.setTempMatrix(new $TFt),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$Tt.getTexture=function($Tt){var $TM=this.subTextureDic[$Tt];return $TM||($TM=this.subTextureDic[$Tt.substr(0,$Tt.length-1)]),null==$TM?this._mainTexture:$TM},$Tt.showSkinByIndex=function($Tt,$TM,$Tf){if(void 0===$Tf&&($Tf=!0),$TM<0&&$TM>=this.skinDataArray.length)return!1;var $Tc,$TD,$To=0,$TJ=0,$TZ=this.skinDataArray[$TM];if($TZ){for($To=0,$TJ=$TZ.slotArr.length;$To<$TJ;$To++)($TD=$TZ.slotArr[$To])&&($Tc=$Tt[$TD.name])&&($Tc.showSlotData($TD,$Tf),$Tf&&"undefined"!=$Tc.attachmentName&&"null"!=$Tc.attachmentName?$Tc.showDisplayByName($Tc.attachmentName):$Tc.showDisplayByIndex($Tc.displayIndex));return!0}return!1},$Tt.getSkinIndexByName=function($Tt){for(var $TM=0,$Tf=this.skinDataArray.length;$TM<$Tf;$TM++)if(this.skinDataArray[$TM].name==$Tt)return $TM;return-1},$Tt.getGrahicsDataWithCache=function($Tt,$TM){return this._graphicsCache[$Tt][$TM]},$Tt.setGrahicsDataWithCache=function($Tt,$TM,$Tf){this._graphicsCache[$Tt][$TM]=$Tf},$Tt.destroy=function(){var $Tt;for(var $TM in this._isDestroyed=!0,this.subTextureDic)($Tt=this.subTextureDic[$TM])&&$Tt.destroy();for($TM in this._textureDic)($Tt=this._textureDic[$TM])&&$Tt.destroy();for(var $Tf=0,$Tc=this.skinSlotDisplayDataArr.length;$Tf<$Tc;$Tf++)this.skinSlotDisplayDataArr[$Tf].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $TD.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$Tt.getAniNameByIndex=function($Tt){var $TM=this.getAnimation($Tt);return $TM?$TM.name:null},$To(0,$Tt,"rate",function(){return this._rate},function($Tt){this._rate=$Tt}),$TD.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$TD.TEMPLET_DICTIONARY=null,$TD}($Tr)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Tt,$TM){"use strict";for(var $Tf in Object.defineProperty($TM,"__esModule",{value:!0}),Laya){var $Tc=Laya[$Tf];$Tc&&$Tc.__isclass&&($TM[$Tf]=$Tc)}});